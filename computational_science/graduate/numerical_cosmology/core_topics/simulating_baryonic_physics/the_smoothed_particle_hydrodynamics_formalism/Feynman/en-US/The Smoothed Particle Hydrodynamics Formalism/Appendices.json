{
    "hands_on_practices": [
        {
            "introduction": "The smoothing kernel is the heart of the SPH formalism, defining how information is averaged over a local particle distribution. For the method to be physically meaningful, it must at least conserve mass, which mathematically translates to a normalization condition on the kernel. This foundational exercise guides you through the derivation of the normalization constant for a general, spherically symmetric kernel in arbitrary dimensions, reinforcing the mathematical underpinnings of SPH and the importance of integral properties. ",
            "id": "3534761",
            "problem": "In Smoothed Particle Hydrodynamics (SPH), the smoothing kernel must be normalized so that it conserves mass in $ \\nu $-dimensional Euclidean space. Consider a spherically symmetric kernel of the form $ W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h) $ with compact support $ 0 \\le r  \\kappa h $, where $ \\kappa  0 $ is a finite support parameter, $ h  0 $ is the smoothing length, and $ f:[0,\\kappa) \\to \\mathbb{R}_{\\ge 0} $ is a dimensionless shape function satisfying $ f(q) = 0 $ for $ q \\ge \\kappa $. Enforce the normalization requirement $ \\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1 $ and derive a closed-form analytic expression for the normalization constant $ \\sigma_{\\nu} $ in terms of $ \\nu $, $ \\kappa $, and $ f $. You may use the standard fact that the surface area of the unit sphere in $ \\nu $ dimensions is $ S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)} $. Provide your final answer as a single analytic expression for $ \\sigma_{\\nu} $. No numerical approximation is required, and no units are needed in the final answer.",
            "solution": "The problem requires the derivation of a closed-form analytic expression for the normalization constant $\\sigma_{\\nu}$ of a spherically symmetric smoothing kernel $W(r,h)$ in $\\nu$-dimensional Euclidean space.\n\nFirst, we perform a validation of the problem statement.\n\n**Step 1: Extract Givens**\n- The smoothing kernel is given by $W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)$.\n- The space is $\\nu$-dimensional Euclidean space, $\\mathbb{R}^{\\nu}$.\n- $r = |\\boldsymbol{x}|$ is the radial distance.\n- $h  0$ is the smoothing length.\n- $\\sigma_{\\nu}$ is the normalization constant to be determined.\n- $f(q)$ is a dimensionless shape function where $q = r/h$.\n- The kernel has compact support for $0 \\le r  \\kappa h$, where $\\kappa  0$ is a finite support parameter. This implies $f(q) = 0$ for $q \\ge \\kappa$.\n- The normalization requirement is $\\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1$.\n- The surface area of a unit sphere in $\\nu$ dimensions is provided as $S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard and fundamental derivation in the theory of Smoothed Particle Hydrodynamics (SPH), a well-established method in computational physics. The concepts of kernel normalization, compact support, and the use of hyperspherical coordinates are all standard and sound.\n- **Well-Posed:** The problem provides a clear objective (find $\\sigma_{\\nu}$) with all necessary constraints and definitions. A unique, meaningful solution is expected.\n- **Objective:** The problem is stated in precise, mathematical language, free of ambiguity or subjectivity.\n- **Conclusion:** The problem is valid as it is scientifically sound, well-posed, objective, and does not violate any of the invalidity criteria.\n\nWe now proceed with the solution.\n\nThe starting point is the normalization condition:\n$$\n\\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1\n$$\nWe substitute the given form of the kernel $W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)$, where $r = |\\boldsymbol{x}|$:\n$$\n\\int_{\\mathbb{R}^{\\nu}} \\sigma_{\\nu}\\, h^{-\\nu}\\, f(|\\boldsymbol{x}|/h)\\, \\mathrm{d}^{\\nu} x = 1\n$$\nSince the integrand is spherically symmetric (it depends only on the magnitude $r=|\\boldsymbol{x}|$), it is advantageous to switch from Cartesian coordinates to $\\nu$-dimensional hyperspherical coordinates. The volume element $\\mathrm{d}^{\\nu} x$ in hyperspherical coordinates is given by $\\mathrm{d}^{\\nu} x = r^{\\nu-1} \\mathrm{d}r\\, \\mathrm{d}\\Omega_{\\nu-1}$, where $\\mathrm{d}\\Omega_{\\nu-1}$ is the infinitesimal solid angle element on the $(\\nu-1)$-dimensional unit sphere.\n\nThe integral can be rewritten as:\n$$\n\\int_0^\\infty \\int_{S_{\\nu-1}} \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)\\, r^{\\nu-1} \\mathrm{d}\\Omega_{\\nu-1} \\mathrm{d}r = 1\n$$\nThe integrand does not depend on the angular variables. Therefore, the integration over the solid angle $\\mathrm{d}\\Omega_{\\nu-1}$ yields the total surface area of the $(\\nu-1)$-dimensional unit sphere, which is $S_{\\nu-1}$.\n$$\nS_{\\nu-1} \\int_0^\\infty \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\nThe constants $\\sigma_{\\nu}$ and $h^{-\\nu}$ can be moved outside the integral:\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\int_0^\\infty f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\nThe kernel has compact support, meaning $f(r/h) = 0$ for $r \\ge \\kappa h$. This modifies the upper limit of the radial integral from $\\infty$ to $\\kappa h$.\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\int_0^{\\kappa h} f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\nTo evaluate the remaining integral, we perform a change of variables. Let $q = r/h$. Then $r = qh$ and $\\mathrm{d}r = h\\, \\mathrm{d}q$. The limits of integration for the new variable $q$ are from $r=0 \\implies q=0$ to $r=\\kappa h \\implies q=\\kappa$. Substituting these into the integral:\n$$\n\\int_0^{\\kappa h} f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = \\int_0^{\\kappa} f(q)\\, (qh)^{\\nu-1} (h\\, \\mathrm{d}q)\n$$\n$$\n= \\int_0^{\\kappa} f(q)\\, q^{\\nu-1}\\, h^{\\nu-1}\\, h\\, \\mathrm{d}q = h^{\\nu} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q\n$$\nNow we substitute this result back into the normalization equation:\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\left( h^{\\nu} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q \\right) = 1\n$$\nThe terms $h^{-\\nu}$ and $h^{\\nu}$ cancel each other out, which confirms that the normalization constant $\\sigma_{\\nu}$ is independent of the specific choice of the smoothing length $h$.\n$$\n\\sigma_{\\nu}\\, S_{\\nu-1} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q = 1\n$$\nWe can now solve for $\\sigma_{\\nu}$:\n$$\n\\sigma_{\\nu} = \\frac{1}{S_{\\nu-1} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\nFinally, we substitute the provided expression for the surface area of the $(\\nu-1)$-sphere, $S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)}$:\n$$\n\\sigma_{\\nu} = \\frac{1}{\\left( \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)} \\right) \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\nThis simplifies to the final closed-form analytic expression for the normalization constant $\\sigma_{\\nu}$:\n$$\n\\sigma_{\\nu} = \\frac{\\Gamma(\\nu/2)}{2 \\pi^{\\nu/2} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\nThis expression for $\\sigma_{\\nu}$ depends on the dimensionality $\\nu$, the support parameter $\\kappa$ (as the upper limit of the integral), and the form of the shape function $f$, as required.",
            "answer": "$$\\boxed{\\frac{\\Gamma(\\frac{\\nu}{2})}{2 \\pi^{\\frac{\\nu}{2}} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}}$$"
        },
        {
            "introduction": "While SPH excels at modeling smooth flows, capturing sharp discontinuities like shock waves presents a significant challenge that requires specialized techniques. This practice delves into two dominant paradigms for shock capturing: the classical artificial viscosity method and the more modern Godunov-type approach based on Riemann solvers. By deriving the characteristic signal speeds for each method, you will gain a deeper understanding of how they introduce dissipation to handle shocks and why they differ in their ability to produce sharp, oscillation-free shock profiles. ",
            "id": "3498269",
            "problem": "Consider a one-dimensional compressible ideal gas with adiabatic index $\\gamma$ described by the Euler equations in conservative form. In Smoothed Particle Hydrodynamics (SPH), fluid quantities are represented by particles with positions $\\mathbf{r}_i$, velocities $\\mathbf{v}_i$, masses $m_i$, densities $\\rho_i$, and pressures $P_i$, and interact through kernel-weighted pairwise operators with a smoothing length $h$. In shock-capturing SPH, two broad approaches exist: (i) adding an artificial viscosity dissipation controlled by a pairwise \"signal speed\" between particles and (ii) solving an inter-particle Riemann problem (Godunov SPH) using approximate wave speeds.\n\nStarting from the characteristic analysis of the one-dimensional Euler equations for states on either side of an interface with velocities $u_L$, $u_R$ and sound speeds $c_L$, $c_R$ (where $c \\equiv \\sqrt{\\gamma P/\\rho}$), the fastest left- and right-propagating characteristics are $u_L - c_L$ and $u_R + c_R$, respectively. In SPH, the relevant interface is the line of centers between a pair $(i,j)$ with unit vector $\\hat{\\mathbf{r}}_{ij} \\equiv (\\mathbf{r}_i - \\mathbf{r}_j)/|\\mathbf{r}_i - \\mathbf{r}_j|$ and relative velocity component along the line of centers $s_{ij} \\equiv -\\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{r}}_{ij}$, where $\\mathbf{v}_{ij} \\equiv \\mathbf{v}_i - \\mathbf{v}_j$. A compressive interaction has $s_{ij}  0$.\n\nUsing only these first principles and definitions, derive two signal speed choices:\n\n- For artificial viscosity SPH, derive a conservative pairwise signal speed $v_{\\mathrm{sig},ij}$ that bounds the pairwise propagation of acoustic information and applies dissipation only for compressive pairs. Discuss how the resulting numerical diffusion scales with $h$ and the consequence for shock thickness in units of $h$, as well as the tendency for post-shock oscillations.\n\n- For a Riemann-solver-based SPH (Godunov SPH) using an approximate Harten-Lax-van Leer (HLL) solver, derive the left and right signal speeds $S_L$ and $S_R$ along $\\hat{\\mathbf{r}}_{ij}$ from the extreme characteristic speeds of the Euler equations. Discuss how these choices affect the shock width relative to $h$ and their impact on post-shock oscillations, including the role of contact discontinuity capturing.\n\nAnswer the following multiple-choice question based on your derivations and discussion. Which statement best reflects the correct comparative behavior of artificial-viscosity SPH versus Godunov SPH for shock capturing, including the appropriate signal speed constructions, shock width, and post-shock oscillations?\n\nA. In artificial viscosity SPH, a conservative choice is $v_{\\mathrm{sig},ij} = \\max(c_i, c_j) + \\max(0, s_{ij})$, which applies only for $s_{ij}  0$; this produces shocks with thickness of order a few smoothing lengths $h$ (depending on dissipation coefficients), and residual post-shock oscillations persist due to imperfect contact handling and particle disorder. In Godunov SPH with the HLL solver, using $S_L = \\min(u_L - c_L, u_R - c_R)$ and $S_R = \\max(u_L + c_L, u_R + c_R)$ confines the shock to order $h$ and substantially suppresses post-shock oscillations by better resolving waves, especially when contact waves are included.\n\nB. In artificial viscosity SPH, choosing $v_{\\mathrm{sig},ij} = s_{ij}$ (excluding any sound speed) collapses the shock width to nearly zero and eliminates post-shock oscillations. In Godunov SPH, HLL speeds broaden shocks relative to artificial viscosity because they average characteristics.\n\nC. In Godunov SPH with an exact Riemann solver, contact discontinuities are exactly resolved independent of kernel choice and smoothing length $h$, and shocks become thinner than any fraction of $h$ even on coarse particle spacings; artificial viscosity SPH cannot ever produce shocks thinner than $10 h$.\n\nD. Artificial viscosity with time-dependent coefficients tuned to vanish away from compression can match Godunov SPH both in shock width (down to $h/10$) and in eliminating post-shock oscillations, provided $v_{\\mathrm{sig},ij}$ excludes sound speed to prevent overdissipation; HLL speeds are not necessary for accurate shock capturing in SPH.",
            "solution": "The user has requested a meticulous validation and solution of a problem concerning shock-capturing methods in Smoothed Particle Hydrodynamics (SPH).\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n-   System: One-dimensional compressible ideal gas.\n-   Adiabatic index: $\\gamma$.\n-   Governing equations: Euler equations in conservative form.\n-   SPH representation: particles with positions $\\mathbf{r}_i$, velocities $\\mathbf{v}_i$, masses $m_i$, densities $\\rho_i$, and pressures $P_i$.\n-   Interaction: Kernel-weighted pairwise operators with smoothing length $h$.\n-   Shock-capturing approaches: (i) artificial viscosity (AV) dissipation controlled by a pairwise \"signal speed\"; (ii) inter-particle Riemann problem (Godunov SPH) using approximate wave speeds.\n-   Characteristic analysis (1D Euler): States $(u_L, c_L)$ and $(u_R, c_R)$ with sound speed $c \\equiv \\sqrt{\\gamma P/\\rho}$. Fastest characteristics are $u_L - c_L$ and $u_R + c_R$.\n-   SPH interface definitions: Unit vector $\\hat{\\mathbf{r}}_{ij} \\equiv (\\mathbf{r}_i - \\mathbf{r}_j)/|\\mathbf{r}_i - \\mathbf{r}_j|$. Relative velocity component $s_{ij} \\equiv -\\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{r}}_{ij}$, where $\\mathbf{v}_{ij} \\equiv \\mathbf{v}_i - \\mathbf{v}_j$.\n-   Condition for compression: $s_{ij}  0$.\n-   Task 1 (Derivation): Derive a conservative pairwise signal speed $v_{\\mathrm{sig},ij}$ for AV SPH, applicable only for compressive pairs.\n-   Task 2 (Discussion): Discuss AV's numerical diffusion scaling with $h$, shock thickness, and post-shock oscillations.\n-   Task 3 (Derivation): Derive left and right signal speeds $S_L$ and $S_R$ for an HLL-based Godunov SPH.\n-   Task 4 (Discussion): Discuss Godunov SPH's shock width relative to $h$ and its impact on post-shock oscillations.\n-   Task 5 (Question): Answer a multiple-choice question comparing the two methods.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem statement is evaluated against the validation criteria:\n\n-   **Scientifically Grounded:** The problem is firmly rooted in the established principles of computational fluid dynamics, specifically the SPH method for solving the Euler equations. The concepts of artificial viscosity, Godunov methods, Riemann problems (HLL variant), characteristic speeds, and shock capturing are standard and correctly described. The definitions provided, such as that for sound speed $c$ and relative velocity $s_{ij}$, are accurate.\n-   **Well-Posed:** The problem requests the derivation of standard numerical constructs (signal speeds for AV and HLL methods) and a discussion of their well-known properties (shock width, oscillations). These tasks are clearly defined and lead to a specific, unique comparison that can be used to answer the multiple-choice question.\n-   **Objective:** The language is technical, precise, and free of subjective or ambiguous terminology.\n-   **Flaw Checklist:** The problem does not violate any of the specified flaw conditions. It is scientifically sound, formalizable, complete, feasible, well-posed, non-trivial, and scientifically verifiable.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **VALID**. The solution will now proceed.\n\n### Derivations and Discussion\n\n#### Artificial Viscosity (AV) SPH\n\n**Derivation of Signal Speed $v_{\\mathrm{sig},ij}$**\nThe purpose of artificial viscosity is to introduce dissipation in regions of strong compression (shocks) to prevent particle inter-penetration and capture the entropy increase across the shock. This dissipation must be causal, meaning the numerical effect must propagate faster than any physical signal between the interacting particles. The physical signals are acoustic waves propagating with speed $c$ relative to the fluid flow.\n\nFor a pair of particles $(i,j)$, we consider the interaction along the line of centers $\\hat{\\mathbf{r}}_{ij}$. The relevant physical speeds are the sound speeds $c_i$ and $c_j$, and the bulk velocity of approach, $s_{ij} = -\\mathbf{v}_{ij}\\cdot\\hat{\\mathbf{r}}_{ij}  0$. A conservative signal speed, $v_{\\mathrm{sig},ij}$, must bound the maximum speed of information exchange between the particles. This speed is a combination of the acoustic propagation and the bulk motion.\n\nA robust and conservative choice for the signal speed would be the sum of the maximum sound speed of the pair and their velocity of approach. This ensures that the dissipative signal outruns any physical wave traveling between the particles. Thus, a valid choice for the signal speed is:\n$$\nv_{\\mathrm{sig},ij} \\approx \\bar{c}_{ij} + s_{ij}\n$$\nwhere $\\bar{c}_{ij}$ is an average sound speed, e.g., $(\\ c_i + c_j)/2$. To be maximally conservative, one can use $\\max(c_i, c_j)$.\n\nThe problem states that dissipation should apply only for compressive pairs ($s_{ij}  0$). This is typically implemented by multiplying the entire AV term in the momentum equation by a switch, such as the Heaviside function $\\Theta(s_{ij})$ or by a factor proportional to $\\max(0, s_{ij})$. If we were to construct a single signal-speed variable that reflects this, as hinted at in the options, a possible form would be $v_{\\mathrm{sig},ij}' = \\max(c_i, c_j) + \\max(0, s_{ij})$. However, it is the entire viscous force, not just the signal speed, that must vanish for non-compressive interactions. The core derived principle is that the signal speed must combine sound speed and compression speed.\n\n**Discussion of AV SPH Properties**\n-   **Numerical Diffusion and Shock Thickness:** The AV term adds a viscous pressure $\\Pi_{ij}$ to the SPH momentum equation. A common form for the linear viscosity term is $\\Pi_{ij} \\propto \\alpha \\bar{c}_{ij} \\mu_{ij}$, where $\\alpha$ is a dissipation coefficient and $\\mu_{ij} \\propto s_{ij}$. This results in a viscous force that acts like a numerical diffusion on velocity. The effective diffusion coefficient is $\\nu \\propto \\alpha \\bar{c} h$. Balancing the convective and diffusive terms across a shock of width $\\Delta x$ shows that $\\Delta x \\propto \\alpha h$. Therefore, the shock is smeared over a few smoothing lengths, with the precise width being tunable via the parameter $\\alpha$. The shock width is of order $\\mathcal{O}(h)$.\n-   **Post-Shock Oscillations:** The AV term is a scalar pressure added isotropically (in the SPH formulation, it acts along the line of centers). It does not distinguish between the different wave families of the Euler equations (acoustic, entropy, contact). Its primary function is to dissipate kinetic energy into thermal energy. This \"brute-force\" approach is not tailored to the specific wave structure of a hydrodynamical discontinuity. This lack of specificity, combined with the discrete nature of SPH particles which can overshoot their equilibrium post-shock state, leads to spurious, unphysical oscillations in pressure and density behind the shock front.\n\n#### Godunov SPH (HLL Solver)\n\n**Derivation of Signal Speeds $S_L$ and $S_R$**\nGodunov SPH replaces the simple pressure averaging and AV of standard SPH with a more sophisticated approach: solving an approximate Riemann problem between each interacting particle pair. The interface is the plane midway between particles $i$ and $j$. The \"left\" state (L) can be taken as $(\\rho_i, \\mathbf{v}_i, P_i)$ and the \"right\" state (R) as $(\\rho_j, \\mathbf{v}_j, P_j)$. We project these states onto the line of centers $\\hat{\\mathbf{r}}_{ij}$. Let the projected velocities be $u_i = \\mathbf{v}_i \\cdot \\hat{\\mathbf{r}}_{ij}$ and $u_j = \\mathbf{v}_j \\cdot \\hat{\\mathbf{r}}_{ij}$. The problem becomes a $1$D Riemann problem with states $(L) \\equiv (\\rho_i, u_i, P_i)$ and $(R) \\equiv (\\rho_j, u_j, P_j)$.\n\nThe Harten-Lax-van Leer (HLL) solver approximates the solution of the Riemann problem by assuming it consists of two waves with speeds $S_L$ and $S_R$ that bound the entire wave fan (left-going wave, contact, right-going wave). To ensure all physical waves are captured, $S_L$ must be less than or equal to the minimum wave speed emerging from the interface, and $S_R$ must be greater than or equal to the maximum wave speed. The characteristic speeds of the Euler equations are $u-c$, $u$, and $u+c$. The full set of possible wave speeds from the two initial states (L and R) is $\\{u_i-c_i, u_i, u_i+c_i\\}$ and $\\{u_j-c_j, u_j, u_j+c_j\\}$.\n\nA conservative estimate for $S_L$ and $S_R$ requires bounding the extremal speeds from this set:\n-   The leftmost-propagating wave from the interface will have a speed given by the minimum of the $u-c$ speeds from both sides.\n    $$S_L = \\min(u_i - c_i, u_j - c_j)$$\n-   The rightmost-propagating wave will have a speed given by the maximum of the $u+c$ speeds from both sides.\n    $$S_R = \\max(u_i + c_i, u_j + c_j)$$\nThese are the standard, robust signal speed estimates for the HLL solver, consistent with the problem's notation ($L/R$ for $i/j$).\n\n**Discussion of Godunov SPH Properties**\n-   **Shock Width:** By solving a Riemann problem, the flux calculation inherently accounts for the direction of information flow (upwinding). This automatically applies the correct amount of dissipation needed to capture the wave structure between the particles. As a result, shocks are typically captured very sharply, with the transition occurring over the inter-particle separation distance, which is of order $h$. Godunov SPH generally produces sharper shocks than AV SPH for the same resolution.\n-   **Post-Shock Oscillations:** The HLL method provides a much better physical model for the discontinuity than a simple scalar viscosity. By approximately resolving the wave fan, it significantly suppresses the spurious post-shock oscillations seen in AV SPH. The primary limitation of the HLL solver is that it does not explicitly resolve the contact discontinuity, lumping it into the region between $S_L$ and $S_R$. This can be a source of minor errors. However, the overall performance is a substantial improvement, leading to much cleaner shock profiles. More advanced solvers like HLLC (which adds the contact wave) can eliminate these oscillations almost entirely.\n\n### Evaluation of Options\n\n**A. In artificial viscosity SPH, a conservative choice is $v_{\\mathrm{sig},ij} = \\max(c_i, c_j) + \\max(0, s_{ij})$, which applies only for $s_{ij}  0$; this produces shocks with thickness of order a few smoothing lengths $h$ (depending on dissipation coefficients), and residual post-shock oscillations persist due to imperfect contact handling and particle disorder. In Godunov SPH with the HLL solver, using $S_L = \\min(u_L - c_L, u_R - c_R)$ and $S_R = \\max(u_L + c_L, u_R + c_R)$ confines the shock to order $h$ and substantially suppresses post-shock oscillations by better resolving waves, especially when contact waves are included.**\n-   **AV Part:** The signal speed is a plausible, conservative construction derived from first principles (bounding sound and compression speeds). The description of shock width ($\\sim$ few $h$) and post-shock oscillations is accurate. The phrase \"which applies only for $s_{ij}0$\" correctly identifies the condition for applying viscosity, even if the formulation of $v_{\\mathrm{sig},ij}$ itself is slightly non-standard.\n-   **Godunov Part:** The formulae for $S_L$ and $S_R$ are correct based on the derivation from extremal characteristic speeds. The description of shock width ($\\sim h$) and the substantial suppression of oscillations is also correct. The reference to including contact waves points to the general superiority of Riemann-based methods.\n-   **Verdict:** **Correct**. This option provides an accurate and internally consistent comparison of the two methods, aligned with the derivations.\n\n**B. In artificial viscosity SPH, choosing $v_{\\mathrm{sig},ij} = s_{ij}$ (excluding any sound speed) collapses the shock width to nearly zero and eliminates post-shock oscillations. In Godunov SPH, HLL speeds broaden shocks relative to artificial viscosity because they average characteristics.**\n-   **AV Part:** Excluding the sound speed from the signal speed is physically incorrect. It violates causality for subsonic compressions and would lead to severe numerical instabilities, not clean shocks.\n-   **Godunov Part:** Godunov methods, including HLL, are known to produce *sharper* shocks than standard AV, not broader ones.\n-   **Verdict:** **Incorrect**. Both claims are factually wrong.\n\n**C. In Godunov SPH with an exact Riemann solver, contact discontinuities are exactly resolved independent of kernel choice and smoothing length $h$, and shocks become thinner than any fraction of $h$ even on coarse particle spacings; artificial viscosity SPH cannot ever produce shocks thinner than $10 h$.**\n-   **Godunov Part:** The resolution of any feature in SPH is fundamentally limited by the smoothing length $h$. No numerical method can resolve features \"independent of... $h$\" or to a scale \"thinner than any fraction of $h$\".\n-   **AV Part:** The claim \"cannot ever produce shocks thinner than $10h$\" is an exaggeration. The width is proportional to $\\alpha h$, and while very small $\\alpha$ is problematic, a width of several $h$ is typical, not necessarily $10h$.\n-   **Verdict:** **Incorrect**. The claims about resolution are physically impossible for a particle-based method.\n\n**D. Artificial viscosity with time-dependent coefficients tuned to vanish away from compression can match Godunov SPH both in shock width (down to $h/10$) and in eliminating post-shock oscillations, provided $v_{\\mathrm{sig},ij}$ excludes sound speed to prevent overdissipation; HLL speeds are not necessary for accurate shock capturing in SPH.**\n-   This option contains multiple errors seen in other options. It claims sub-h resolution ($h/10$), which is impossible. It incorrectly advocates for excluding the sound speed from the signal speed, which is dangerous. While modern AV switches improve performance, claiming they can fully match and eliminate all oscillations as well as Godunov methods is an overstatement.\n-   **Verdict:** **Incorrect**. The claims are physically and numerically unsound.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Beyond shocks, correctly modeling contact discontinuities and the fluid instabilities that grow on them is a crucial test for any hydrodynamic code. Certain formulations of SPH can introduce unphysical, spurious surface tension at density jumps, which can artificially suppress the growth of instabilities like the Kelvin-Helmholtz instability. This hands-on problem challenges you to connect analytical linear theory with a numerical model to quantify this artifact, demonstrating how formulation choices, such as a pressure-entropy approach, can mitigate these issues and improve the physical fidelity of simulations. ",
            "id": "3498213",
            "problem": "You are asked to construct, analyze, and implement a simplified linear-theory diagnostic for the impact of formulation choice in the Smoothed Particle Hydrodynamics (SPH) formalism on spurious surface tension at contact discontinuities in the context of the Kelvin–Helmholtz Instability (KHI). Starting from the Euler equations for two inviscid, immiscible, compressible fluids in the subsonic, small-perturbation limit, specialize to the classical incompressible, irrotational linear analysis of a planar shear layer separating two semi-infinite fluids with densities $\\rho_{1}$ and $\\rho_{2}$, uniform horizontal velocities $U_{1}$ and $U_{2}$, equal equilibrium pressure $P_{0}$, and a single-mode interfacial perturbation with wavenumber $k$ and infinitesimal amplitude. Impose the kinematic boundary condition at the interface and the dynamic boundary condition with a capillary-like restoring force due to an effective surface tension $S$ concentrated at the contact discontinuity.\n\nUnder these assumptions, derive the dispersion relation for normal-mode perturbations proportional to $\\exp\\!\\left[i k x - \\omega t\\right]$ and obtain an explicit formula for the linear growth rate $\\gamma \\equiv \\operatorname{Im}\\,\\omega \\ge 0$ as a function of $\\rho_{1}$, $\\rho_{2}$, $\\Delta U \\equiv U_{1}-U_{2}$, $k$, and $S$. Then, given a time $t$, define the amplitude gain factor $G \\equiv \\exp\\!\\left(\\gamma t\\right)$.\n\nModel the effect of spurious surface tension in SPH as an effective interfacial tension\n$$\nS_{\\mathrm{eff}} = C\\, P_{0}\\, h,\n$$\nwhere $C$ is a dimensionless formulation-dependent coefficient, $P_{0}$ is the equilibrium pressure at the interface, and $h$ is the smoothing length. Use this to represent two SPH formulations on identical initial conditions (matched fields across runs, not across phases): the density–energy formulation (set $C = C_{\\mathrm{DE}}$) and the pressure–entropy formulation (set $C = C_{\\mathrm{PE}}$). Assume an ideal-gas equation of state so that a contact discontinuity with $\\rho_{1} \\ne \\rho_{2}$ and equal $P_{0}$ implies different entropic functions across the interface, which is the source of the spurious-tension effect in the density–energy formulation; the pressure–entropy formulation suppresses this effect by construction.\n\nImplement a program that, for each test case below, computes three dimensionless amplitude gain factors at time $t$: the analytic no-surface-tension gain $G_{\\mathrm{an}}$ with $S=0$, the density–energy SPH model gain $G_{\\mathrm{DE}}$ with $S=S_{\\mathrm{eff}}$ and $C=C_{\\mathrm{DE}}$, and the pressure–entropy SPH model gain $G_{\\mathrm{PE}}$ with $S=S_{\\mathrm{eff}}$ and $C=C_{\\mathrm{PE}}$. If the derived dispersion relation predicts linear stability for given parameters (i.e., non-growing modes), set the growth rate $\\gamma$ to $0$ so that $G=1$. All quantities are to be treated as dimensionless code units; report all outputs as dimensionless numbers with no units.\n\nTest suite parameters (each tuple is $(\\rho_{1}, \\rho_{2}, U_{1}, U_{2}, k, P_{0}, h, C_{\\mathrm{DE}}, C_{\\mathrm{PE}}, t)$):\n- Case A (happy path, moderate contrast, unstable in all models): $(1.0, 2.0, +0.5, -0.5, 2\\pi, 1.0, 0.02, 0.25, 0.0, 2.0)$.\n- Case B (boundary where density–energy model is stabilized by spurious tension while analytic and pressure–entropy grow): $(1.0, 2.0, +0.25, -0.25, 4\\pi, 1.0, 0.2, 0.25, 0.0, 2.0)$.\n- Case C (equal densities, checks symmetry): $(1.0, 1.0, +0.5, -0.5, 2\\pi, 1.0, 0.05, 0.25, 0.0, 2.0)$.\n- Case D (near-threshold behavior for density–energy model): $(1.0, 2.0, +0.15, -0.15, 3\\pi, 1.0, 0.02, 0.25, 0.0, 3.0)$.\n\nYour program must:\n- Derive and use the linear growth rate $\\gamma$ you obtained from first principles with the effective $S_{\\mathrm{eff}}$ model above.\n- For each case, compute and collect the triplet $\\left(G_{\\mathrm{an}}, G_{\\mathrm{DE}}, G_{\\mathrm{PE}}\\right)$ in that order.\n- Produce a single line of output containing all results, in case order, as a comma-separated list enclosed in square brackets. The list must be flattened in the order $\\left[G_{\\mathrm{an}}^{(A)}, G_{\\mathrm{DE}}^{(A)}, G_{\\mathrm{PE}}^{(A)}, G_{\\mathrm{an}}^{(B)}, G_{\\mathrm{DE}}^{(B)}, G_{\\mathrm{PE}}^{(B)}, G_{\\mathrm{an}}^{(C)}, G_{\\mathrm{DE}}^{(C)}, G_{\\mathrm{PE}}^{(C)}, G_{\\mathrm{an}}^{(D)}, G_{\\mathrm{DE}}^{(D)}, G_{\\mathrm{PE}}^{(D)}\\right]$. Express each floating-point number with at most $6$ decimal places.\n\nDesign coverage:\n- Case A exercises the general unstable regime with modest spurious-tension suppression.\n- Case B probes the stabilization boundary induced by spurious tension in the density–energy formulation.\n- Case C tests the equal-density limit where the growth rate simplifies.\n- Case D probes near-threshold sensitivity to parameters, ensuring correct handling of small positive growth rates.\n\nThe final answer must be a complete, runnable program as specified below.",
            "solution": "The problem requires the derivation and application of the linear growth rate for the Kelvin-Helmholtz Instability (KHI) at a planar interface between two inviscid, irrotational, incompressible fluids, including the effect of surface tension. This provides a diagnostic tool to understand spurious numerical artifacts in Smoothed Particle Hydrodynamics (SPH) simulations.\n\nThe starting point is the dispersion relation for normal-mode perturbations of the form $\\exp[i(kx - \\omega t)]$ at the interface between two semi-infinite fluids. Fluid 1 (density $\\rho_1$, velocity $U_1$) occupies the upper half-space ($y0$), and Fluid 2 (density $\\rho_2$, velocity $U_2$) occupies the lower half-space ($y0$). This is a classical result from fluid dynamics, typically derived by linearizing the Euler equations and applying kinematic and dynamic boundary conditions at the perturbed interface. The problem neglects gravity. The resulting dispersion relation, including a surface tension $S$ at the interface, is:\n$$\n\\rho_1 (\\omega - k U_1)^2 + \\rho_2 (\\omega - k U_2)^2 = S k^3\n$$\nHere, $k$ is the wavenumber of the perturbation, and $\\omega$ is its complex frequency. The real part of $\\omega$ corresponds to the phase velocity, and the imaginary part, $\\gamma \\equiv \\operatorname{Im}(\\omega)$, corresponds to the growth rate of the instability.\n\nThis equation is a quadratic in $\\omega$:\n$$\n(\\rho_1 + \\rho_2)\\omega^2 - 2k(\\rho_1 U_1 + \\rho_2 U_2)\\omega + [k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - S k^3] = 0\n$$\nWe solve for $\\omega$ using the quadratic formula, $\\omega = (-b \\pm \\sqrt{b^2-4ac})/(2a)$, with:\n$a = \\rho_1 + \\rho_2$\n$b = -2k(\\rho_1 U_1 + \\rho_2 U_2)$\n$c = k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - S k^3$\n\nThe solution for $\\omega$ is:\n$$\n\\omega = \\frac{2k(\\rho_1 U_1 + \\rho_2 U_2) \\pm \\sqrt{4k^2(\\rho_1 U_1 + \\rho_2 U_2)^2 - 4(\\rho_1+\\rho_2)(k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - Sk^3)}}{2(\\rho_1+\\rho_2)}\n$$\nThe instability is present when the discriminant is negative, leading to complex conjugate roots for $\\omega$. The growth rate $\\gamma$ is the imaginary part of $\\omega$.\nLet's analyze the discriminant, $\\Delta = b^2 - 4ac$:\n$$\n\\Delta = 4k^2(\\rho_1 U_1 + \\rho_2 U_2)^2 - 4(\\rho_1+\\rho_2)(k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - Sk^3)\n$$\nThe velocity-dependent part of the term within the square root simplifies as:\n$$\n(\\rho_1 U_1 + \\rho_2 U_2)^2 - (\\rho_1+\\rho_2)(\\rho_1 U_1^2 + \\rho_2 U_2^2) \\\\\n= (\\rho_1^2 U_1^2 + \\rho_2^2 U_2^2 + 2\\rho_1\\rho_2 U_1 U_2) - (\\rho_1^2 U_1^2 + \\rho_1\\rho_2 U_2^2 + \\rho_2\\rho_1 U_1^2 + \\rho_2^2 U_2^2) \\\\\n= -\\rho_1\\rho_2(U_1^2 - 2U_1U_2 + U_2^2) = -\\rho_1\\rho_2(U_1 - U_2)^2 = -\\rho_1\\rho_2 (\\Delta U)^2\n$$\nwhere $\\Delta U \\equiv U_1 - U_2$.\nSubstituting this back into the expression for $\\Delta$:\n$$\n\\Delta = 4k^2 [-\\rho_1\\rho_2 (\\Delta U)^2] + 4k^3 S (\\rho_1+\\rho_2) = 4k^2 [kS(\\rho_1+\\rho_2) - \\rho_1\\rho_2(\\Delta U)^2]\n$$\nInstability occurs when $\\Delta  0$, which requires the term in the square brackets to be negative. The solution for $\\omega$ becomes:\n$$\n\\omega = k\\frac{\\rho_1 U_1 + \\rho_2 U_2}{\\rho_1+\\rho_2} \\pm i \\frac{\\sqrt{-\\Delta}}{2(\\rho_1+\\rho_2)}\n$$\nThe growth rate $\\gamma = \\operatorname{Im}(\\omega)$ is the positive imaginary part:\n$$\n\\gamma = \\frac{\\sqrt{-\\Delta}}{2(\\rho_1+\\rho_2)} = \\frac{\\sqrt{4k^2[\\rho_1\\rho_2(\\Delta U)^2 - kS(\\rho_1+\\rho_2)]}}{2(\\rho_1+\\rho_2)}\n$$\n$$\n\\gamma = \\frac{k}{\\rho_1+\\rho_2} \\sqrt{\\rho_1\\rho_2(\\Delta U)^2 - kS(\\rho_1+\\rho_2)}\n$$\nThis expression is valid only if the term under the square root is non-negative, which is the condition for instability: $\\rho_1\\rho_2(\\Delta U)^2  kS(\\rho_1+\\rho_2)$. If this condition is not met, the modes are stable or neutrally stable, and the growth rate is zero. Therefore, we define $\\gamma$ as:\n$$\n\\gamma = \\frac{k}{\\rho_1+\\rho_2} \\sqrt{\\max\\left(0, \\rho_1\\rho_2(\\Delta U)^2 - kS(\\rho_1+\\rho_2)\\right)}\n$$\nThe problem models the spurious surface tension in SPH simulations as an effective surface tension $S_{\\mathrm{eff}} = C P_0 h$. We compute the growth rate for three scenarios:\n1.  Analytic ($S=0$): $\\gamma_{\\mathrm{an}}$ is calculated with $S=0$.\n2.  Density-Energy SPH ($S=S_{\\mathrm{DE}}$): $\\gamma_{\\mathrm{DE}}$ is calculated with $S = S_{\\mathrm{DE}} = C_{\\mathrm{DE}} P_0 h$.\n3.  Pressure-Entropy SPH ($S=S_{\\mathrm{PE}}$): $\\gamma_{\\mathrm{PE}}$ is calculated with $S = S_{\\mathrm{PE}} = C_{\\mathrm{PE}} P_0 h$.\n\nFinally, the amplitude gain factor at a given time $t$ is defined as $G = \\exp(\\gamma t)$.\n\nThe algorithm for each test case is as follows:\n1.  Extract parameters: $(\\rho_1, \\rho_2, U_1, U_2, k, P_0, h, C_{\\mathrm{DE}}, C_{\\mathrm{PE}}, t)$.\n2.  Calculate $\\Delta U = U_1 - U_2$.\n3.  Calculate $S_{\\mathrm{DE}} = C_{\\mathrm{DE}} P_0 h$ and $S_{\\mathrm{PE}} = C_{\\mathrm{PE}} P_0 h$.\n4.  Calculate $\\gamma_{\\mathrm{an}}$, $\\gamma_{\\mathrm{DE}}$, and $\\gamma_{\\mathrm{PE}}$ using the derived formula for $\\gamma$ with $S=0$, $S=S_{\\mathrm{DE}}$, and $S=S_{\\mathrm{PE}}$, respectively.\n5.  Calculate the corresponding gain factors $G_{\\mathrm{an}} = \\exp(\\gamma_{\\mathrm{an}} t)$, $G_{\\mathrm{DE}} = \\exp(\\gamma_{\\mathrm{DE}} t)$, and $G_{\\mathrm{PE}} = \\exp(\\gamma_{\\mathrm{PE}} t)$.\n6.  Collect the triplet $(G_{\\mathrm{an}}, G_{\\mathrm{DE}}, G_{\\mathrm{PE}})$.\nThe final output is a flattened list of these triplets for all test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the amplitude gain factors for Kelvin-Helmholtz instability\n    under different SPH formulation models.\n    \"\"\"\n    \n    # Test suite parameters:\n    # (rho1, rho2, U1, U2, k, P0, h, C_DE, C_PE, t)\n    test_cases = [\n        (1.0, 2.0, 0.5, -0.5, 2 * np.pi, 1.0, 0.02, 0.25, 0.0, 2.0),\n        (1.0, 2.0, 0.25, -0.25, 4 * np.pi, 1.0, 0.2, 0.25, 0.0, 2.0),\n        (1.0, 1.0, 0.5, -0.5, 2 * np.pi, 1.0, 0.05, 0.25, 0.0, 2.0),\n        (1.0, 2.0, 0.15, -0.15, 3 * np.pi, 1.0, 0.02, 0.25, 0.0, 3.0),\n    ]\n\n    results = []\n\n    def calculate_growth_rate(rho1, rho2, delta_U, k, S):\n        \"\"\"\n        Calculates the KHI linear growth rate gamma.\n        \n        Args:\n            rho1 (float): Density of fluid 1.\n            rho2 (float): Density of fluid 2.\n            delta_U (float): Velocity difference U1 - U2.\n            k (float): Wavenumber.\n            S (float): Surface tension.\n            \n        Returns:\n            float: The growth rate gamma.\n        \"\"\"\n        shear_term = rho1 * rho2 * delta_U**2\n        tension_term = k * S * (rho1 + rho2)\n        \n        # Argument of the square root\n        instability_criterion = shear_term - tension_term\n        \n        if instability_criterion = 0:\n            return 0.0\n        \n        gamma = (k / (rho1 + rho2)) * np.sqrt(instability_criterion)\n        return gamma\n\n    for case in test_cases:\n        rho1, rho2, U1, U2, k, P0, h, C_DE, C_PE, t = case\n        \n        delta_U = U1 - U2\n        \n        # Case 1: Analytic (no surface tension)\n        S_an = 0.0\n        gamma_an = calculate_growth_rate(rho1, rho2, delta_U, k, S_an)\n        G_an = np.exp(gamma_an * t)\n        \n        # Case 2: Density-Energy SPH model\n        S_DE = C_DE * P0 * h\n        gamma_DE = calculate_growth_rate(rho1, rho2, delta_U, k, S_DE)\n        G_DE = np.exp(gamma_DE * t)\n        \n        # Case 3: Pressure-Entropy SPH model\n        S_PE = C_PE * P0 * h\n        gamma_PE = calculate_growth_rate(rho1, rho2, delta_U, k, S_PE)\n        G_PE = np.exp(gamma_PE * t)\n        \n        results.extend([G_an, G_DE, G_PE])\n\n    # Format the output as specified: a comma-separated list of floats\n    # with at most 6 decimal places, enclosed in square brackets.\n    # The 'g' format specifier handles this representation correctly.\n    formatted_results = [f\"{res:.6f}\".rstrip('0').rstrip('.') if '.' in f\"{res:.6f}\" else f\"{res:.1f}\" for res in results]\n    # The problem asks for up to 6 decimal places. Let's use a cleaner formatter that doesn't add trailing zeros.\n    # `f-string` with general format 'g' can be tricky. Let's be explicit to match the example format.\n    formatted_results = []\n    for r in results:\n        if r == 1.0:\n            formatted_results.append(\"1.0\")\n        else:\n            # {:f} gives 6 decimal places by default\n            formatted_results.append(f\"{r:.6f}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}