{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of semi-analytic modeling is connecting the properties of dark matter halos, which are predictable from cosmological simulations, to the observable characteristics of the galaxies that form within them. This first practice guides you through the foundational steps of this process, starting from a halo's mass and angular momentum (parameterized by its spin, $\\lambda$) to predict the size of the galactic disk it hosts . You will then apply the classic Toomre stability criterion to assess whether this gaseous disk is stable against its own self-gravity, providing a first look at the physical conditions that might lead to the formation of spiral arms and star-forming clumps.",
            "id": "3486109",
            "problem": "You are tasked with implementing a simplified, yet scientifically consistent, semi-analytic model of disk galaxy formation inside a dark matter halo within the domain of numerical cosmology. Starting from fundamental physical relations and core definitions, you must derive and compute the disk scale radius, the Toomre stability parameter, and the expected unstable disk mass fraction for a gaseous exponential disk embedded in a halo characterized by a mass and a spin parameter. All computations must adhere to the modeling and unit specifications provided.\n\nModeling assumptions and physical setup:\n- The halo is at redshift $z = 0$, has total mass $M$ in solar masses, and follows a spherical top-hat virialization with overdensity $\\Delta = 200$ with respect to the critical density. The Hubble constant is $H_0 = 70$ in units of $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, which must be converted into $\\mathrm{km\\,s^{-1}\\,kpc^{-1}}$ for all computations.\n- The gravitational constant is $G = 4.3009 \\times 10^{-6}$ in units $\\mathrm{kpc\\,km^2\\,s^{-2}\\,M_\\odot^{-1}}$.\n- The halo has spin parameter $\\lambda$ and specific angular momentum is assumed to be conserved in the formation of a rotationally supported exponential disk, with a flat circular velocity profile $V_c(R) \\approx V_{\\mathrm{vir}}$.\n- The disk mass fraction is $m_d$ such that the baryonic disk mass is $M_d = m_d M$. The gas fraction within the disk is $f_g$, yielding the gas mass $M_{\\mathrm{gas}} = f_g M_d = f_g m_d M$.\n- The gas disk has an exponential surface density profile $\\Sigma_g(R) = \\Sigma_0 \\exp(-R/R_d)$, where $R_d$ is the disk scale radius and $\\Sigma_0$ is determined by mass conservation.\n- The gas velocity dispersion is approximated by a sound speed $c_s$ in $\\mathrm{km\\,s^{-1}}$.\n- The Toomre stability parameter for a thin gaseous disk (Toomre $Q$) is defined as $Q(R) = \\kappa(R) c_s / (\\pi G \\Sigma_g(R))$, where the epicyclic frequency is $\\kappa(R) = \\sqrt{2} V_c(R)/R$ for a flat rotation curve.\n\nDerivation requirements (provide no shortcuts or target formulas in the implementation; your code must apply the derived relations):\n1. Use the definition of the critical density in terms of the Hubble constant, $\\rho_c = 3 H_0^2 / (8 \\pi G)$, to compute the virial radius $R_{\\mathrm{vir}}$ from the halo mass $M$ using $M = (4/3) \\pi \\Delta \\rho_c R_{\\mathrm{vir}}^3$. Then compute the virial circular velocity $V_{\\mathrm{vir}} = \\sqrt{G M / R_{\\mathrm{vir}}}$.\n2. Starting from the definition of the dimensionless spin parameter $\\lambda = J |E|^{1/2} / (G M^{5/2})$, with total energy $E$ for a virialized isothermal halo approximated by $E \\approx - \\tfrac{1}{2} G M^2 / R_{\\mathrm{vir}}$, derive the halo specific angular momentum $j_h = J/M$ and use conservation of specific angular momentum $j_d \\approx j_h$ for a disk with flat rotation curve where $j_d = 2 R_d V_c$. Conclude an expression for $R_d$ in terms of $\\lambda$ and $R_{\\mathrm{vir}}$ under these assumptions, and use it to compute $R_d$.\n3. Use mass conservation for the exponential disk ($M_{\\mathrm{gas}} = 2 \\pi \\Sigma_0 R_d^2$) to compute $\\Sigma_0$ from $M_{\\mathrm{gas}}$ and $R_d$.\n4. Compute $Q(R)$ evaluated at $R = R_d$ to obtain the characteristic minimum stability value $Q_d \\equiv Q(R_d)$ for the exponential disk with a flat rotation curve.\n5. Determine the unstable radial region where $Q(R) < 1$. Show that, with $V_c(R) \\approx V_{\\mathrm{vir}}$, $Q(R)$ can be written in the form $Q(R) = A \\exp(R/R_d) / R$ for a constant $A$, that $Q(R)$ attains its minimum at $R = R_d$, and that the inequality $Q(R) < 1$ yields two real roots $R_1$ and $R_2$ when $Q_d < 1$. Solve for the boundaries using the Lambert $W$ function to obtain $R_1$ and $R_2$, and compute the unstable gas mass fraction by integrating the exponential disk mass between $R_1$ and $R_2$ divided by the total gas mass. Express the final unstable mass fraction only in terms of dimensionless radii $u_i = R_i / R_d$.\n\nImplementation tasks:\n- Implement the above derivation in a complete program that accepts no input and uses the provided test suite.\n- For each test case, compute and output the triplet $[R_d, Q_d, f_{\\mathrm{unstable}}]$, where $R_d$ must be expressed in $\\mathrm{kpc}$, $Q_d$ is dimensionless, and $f_{\\mathrm{unstable}}$ is a decimal fraction of the gas mass in the unstable region.\n\nTest suite:\nUse the following parameter sets, each given as $(M, \\lambda, m_d, f_g, c_s)$, with $M$ in $M_\\odot$ and $c_s$ in $\\mathrm{km\\,s^{-1}}$.\n- Case $1$ (general Milky Way-like, expected stable): $(1.0 \\times 10^{12}, 0.04, 0.05, 0.20, 10.0)$.\n- Case $2$ (low spin, gas-rich, expected strongly unstable): $(1.0 \\times 10^{12}, 0.01, 0.08, 0.80, 6.0)$.\n- Case $3$ (intermediate mass, high spin, expected stable): $(3.0 \\times 10^{11}, 0.08, 0.03, 0.15, 12.0)$.\n- Case $4$ (low mass, near-threshold stability): $(1.0 \\times 10^{10}, 0.03, 0.06, 0.50, 6.0)$.\n- Case $5$ (boundary condition for Case $1$, near $Q_d \\approx 1$): $(1.0 \\times 10^{12}, 0.04, 0.05, 0.20, 6.64)$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a list of three floats representing $[R_d, Q_d, f_{\\mathrm{unstable}}]$ in the order of the test suite, for example, $\\left[ [r_{d,1}, q_{d,1}, f_{1}], [r_{d,2}, q_{d,2}, f_{2}], \\ldots \\right]$.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, objective, and internally consistent. It presents a simplified but standard model of disk galaxy formation, suitable for a computational implementation based on first principles. The tasks and derivations required are logical and follow established astrophysical formalisms. We may therefore proceed with a complete solution.\n\nThe solution is structured by deriving the necessary physical quantities in a step-by-step manner, as specified in the problem description. All mathematical symbols, variables, and numerical values are rendered in LaTeX as per the formatting requirements.\n\n**Unit Conversions and Constants**\n\nThe problem is defined with a specific set of physical constants and units. We begin by establishing these for the calculation.\nThe gravitational constant is $G = 4.3009 \\times 10^{-6} \\, \\mathrm{kpc\\,km^2\\,s^{-2}\\,M_\\odot^{-1}}$.\nThe Hubble constant is given as $H_0 = 70 \\, \\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$. For consistency with the units of $G$, we convert this to per-kiloparsec units. Since $1 \\, \\mathrm{Mpc} = 10^3 \\, \\mathrm{kpc}$, we have:\n$$H_0 = 70 \\, \\frac{\\mathrm{km}}{\\mathrm{s} \\cdot \\mathrm{Mpc}} \\times \\frac{1 \\, \\mathrm{Mpc}}{1000 \\, \\mathrm{kpc}} = 0.07 \\, \\mathrm{km\\,s^{-1}\\,kpc^{-1}}$$\nThe halo virialization overdensity is $\\Delta = 200$ with respect to the critical density $\\rho_c$ at redshift $z=0$.\n\n**Step 1. Derivation of Virial Properties**\n\nThe first step is to characterize the dark matter halo by its virial radius $R_{\\mathrm{vir}}$ and virial circular velocity $V_{\\mathrm{vir}}$.\nThe critical density of the universe is defined as $\\rho_c = \\frac{3 H_0^2}{8 \\pi G}$.\nThe mass of the halo $M$ is defined within the virial radius $R_{\\mathrm{vir}}$ where the mean density is $\\Delta \\rho_c$. For a spherical halo:\n$$M = \\frac{4}{3} \\pi R_{\\mathrm{vir}}^3 (\\Delta \\rho_c)$$\nSubstituting the expression for $\\rho_c$:\n$$M = \\frac{4}{3} \\pi R_{\\mathrm{vir}}^3 \\left( \\Delta \\frac{3 H_0^2}{8 \\pi G} \\right) = \\frac{\\Delta H_0^2}{2G} R_{\\mathrm{vir}}^3$$\nSolving for the virial radius $R_{\\mathrm{vir}}$ yields:\n$$R_{\\mathrm{vir}} = \\left( \\frac{2 G M}{\\Delta H_0^2} \\right)^{1/3}$$\nThe circular velocity at the virial radius, $V_{\\mathrm{vir}}$, is given by the standard formula for a spherical mass distribution:\n$$V_{\\mathrm{vir}} = \\sqrt{\\frac{G M}{R_{\\mathrm{vir}}}}$$\nThese two equations allow us to calculate the fundamental scale and velocity of the halo from its mass $M$.\n\n**Step 2. Derivation of the Disk Scale Radius**\n\nThe disk scale radius $R_d$ is determined by assuming that the specific angular momentum of the disk-forming material is conserved. The halo's specific angular momentum is related to its dimensionless spin parameter $\\lambda$:\n$$\\lambda = \\frac{J |E|^{1/2}}{G M^{5/2}}$$\nwhere $J$ is the total angular momentum and $E$ is the total energy of the halo. For a virialized isothermal sphere, the energy is approximately $E \\approx - \\frac{1}{2} \\frac{G M^2}{R_{\\mathrm{vir}}}$. The absolute value is $|E| = \\frac{G M^2}{2 R_{\\mathrm{vir}}}$.\nSubstituting $|E|$ into the definition of $\\lambda$:\n$$\\lambda = \\frac{J}{G M^{5/2}} \\left( \\frac{G M^2}{2 R_{\\mathrm{vir}}} \\right)^{1/2} = \\frac{J}{G M^{5/2}} \\frac{G^{1/2} M}{\\sqrt{2} R_{\\mathrm{vir}}^{1/2}} = \\frac{J}{\\sqrt{2} G^{1/2} M^{3/2} R_{\\mathrm{vir}}^{1/2}}$$\nThe specific angular momentum of the halo is $j_h = J/M$. Solving for $j_h$:\n$$j_h = \\sqrt{2} \\lambda G^{1/2} M^{1/2} R_{\\mathrm{vir}}^{1/2}$$\nUsing the relation $V_{\\mathrm{vir}}^2 = GM/R_{\\mathrm{vir}}$, we can write $G^{1/2}M^{1/2} = V_{\\mathrm{vir}} R_{\\mathrm{vir}}^{1/2}$. Substituting this into the expression for $j_h$:\n$$j_h = \\sqrt{2} \\lambda (V_{\\mathrm{vir}} R_{\\mathrm{vir}}^{1/2}) R_{\\mathrm{vir}}^{1/2} = \\sqrt{2} \\lambda V_{\\mathrm{vir}} R_{\\mathrm{vir}}$$\nThe specific angular momentum of an exponential disk with surface density $\\Sigma(R) \\propto \\exp(-R/R_d)$ and a flat rotation curve $V_c$ is $j_d = 2 R_d V_c$. The model assumes conservation of specific angular momentum, $j_d \\approx j_h$, and a flat rotation curve for the disk fixed by the halo's potential, $V_c \\approx V_{\\mathrm{vir}}$.\n$$2 R_d V_{\\mathrm{vir}} = \\sqrt{2} \\lambda V_{\\mathrm{vir}} R_{\\mathrm{vir}}$$\nSolving for the disk scale radius $R_d$ gives our working formula:\n$$R_d = \\frac{\\lambda}{\\sqrt{2}} R_{\\mathrm{vir}}$$\n\n**Step 3. Derivation of the Central Gas Surface Density**\n\nThe gas disk has an exponential surface density profile $\\Sigma_g(R) = \\Sigma_0 \\exp(-R/R_d)$, where $\\Sigma_0$ is the central surface density. The total gas mass $M_{\\mathrm{gas}}$ is obtained by integrating this profile over the entire disk:\n$$M_{\\mathrm{gas}} = \\int_0^\\infty \\Sigma_g(R) \\, 2 \\pi R \\, dR = 2 \\pi \\Sigma_0 \\int_0^\\infty R e^{-R/R_d} \\, dR$$\nThe integral evaluates to $R_d^2$. Thus, $M_{\\mathrm{gas}} = 2 \\pi \\Sigma_0 R_d^2$.\nThe gas mass is given as a fraction $f_g$ of the disk mass $M_d$, which itself is a fraction $m_d$ of the total halo mass $M$, so $M_{\\mathrm{gas}} = f_g m_d M$.\nBy equating the two expressions for $M_{\\mathrm{gas}}$, we can solve for $\\Sigma_0$:\n$$\\Sigma_0 = \\frac{M_{\\mathrm{gas}}}{2 \\pi R_d^2} = \\frac{f_g m_d M}{2 \\pi R_d^2}$$\n\n**Step 4. Derivation of the Toomre Stability Parameter**\n\nThe Toomre stability of a thin gaseous disk is quantified by the parameter $Q(R)$:\n$$Q(R) = \\frac{\\kappa(R) c_s}{\\pi G \\Sigma_g(R)}$$\nwhere $c_s$ is the gas velocity dispersion (sound speed). The epicyclic frequency $\\kappa(R)$ for a flat rotation curve $V_c(R) \\approx V_{\\mathrm{vir}}$ is $\\kappa(R) = \\sqrt{2} V_c / R \\approx \\sqrt{2} V_{\\mathrm{vir}}/R$.\nSubstituting the expressions for $\\kappa(R)$ and $\\Sigma_g(R)$:\n$$Q(R) = \\frac{(\\sqrt{2} V_{\\mathrm{vir}}/R) c_s}{\\pi G (\\Sigma_0 e^{-R/R_d})} = \\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s}{\\pi G \\Sigma_0} \\frac{e^{R/R_d}}{R}$$\nThis shows that $Q(R)$ has the form $A \\exp(R/R_d) / R$, which has a unique minimum. The minimum of the function $f(R) = e^{R/R_d}/R$ occurs when $f'(R)=0$, which solves to $R=R_d$.\nThus, the minimum value of the Toomre parameter, $Q_d$, occurs at $R=R_d$:\n$$Q_d \\equiv Q(R_d) = \\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s}{\\pi G \\Sigma_0} \\frac{e}{R_d}$$\nSubstituting the expression for $\\Sigma_0$:\n$$Q_d = \\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s e}{\\pi G R_d} \\left( \\frac{2 \\pi R_d^2}{M_{\\mathrm{gas}}} \\right) = \\frac{2 \\sqrt{2} e V_{\\mathrm{vir}} c_s R_d}{G M_{\\mathrm{gas}}}$$\nThis provides a direct way to calculate the characteristic stability of the disk.\n\n**Step 5. Derivation of the Unstable Region and Mass Fraction**\n\nThe disk is locally unstable to gravitational collapse where $Q(R) < 1$. We can express $Q(R)$ in terms of its minimum value $Q_d$ and the dimensionless radius $u=R/R_d$:\n$$Q(R) = Q(u R_d) = \\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s}{\\pi G \\Sigma_0} \\frac{e^{u}}{u R_d} = \\left(\\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s e}{\\pi G \\Sigma_0 R_d}\\right) \\frac{e^{u-1}}{u} = Q_d \\frac{e^{u-1}}{u}$$\nThe instability condition is $Q_d \\frac{e^{u-1}}{u} < 1$. If $Q_d \\ge 1$, the condition is never met, and the disk is stable everywhere, making the unstable mass fraction $f_{\\mathrm{unstable}} = 0$.\nIf $Q_d < 1$, we solve for the boundary radii where $Q(u)=1$:\n$$Q_d \\frac{e^{u-1}}{u} = 1 \\implies u e^{-u} = \\frac{Q_d}{e}$$\nThis is a transcendental equation that can be solved using the Lambert W function, which is defined by $W(z) e^{W(z)} = z$. We set $x=-u$, so $u=-x$:\n$$(-x) e^x = \\frac{Q_d}{e} \\implies x e^x = -\\frac{Q_d}{e}$$\nFor $0 < Q_d < 1$, the argument $z = -Q_d/e$ is in the range $(-1/e, 0)$, for which the Lambert W function has two real branches, $W_0(z)$ and $W_{-1}(z)$. The solutions for $x$ are $x_1 = W_{-1}(-Q_d/e)$ and $x_2 = W_0(-Q_d/e)$.\nThe corresponding dimensionless radii are $u_1 = -x_2 = -W_0(-Q_d/e)$ and $u_2 = -x_1 = -W_{-1}(-Q_d/e)$, defining the unstable region $[R_1, R_2] = [u_1 R_d, u_2 R_d]$.\nThe mass of the unstable gas is found by integrating the surface density profile between these radii:\n$$M_{\\mathrm{unstable}} = \\int_{R_1}^{R_2} 2\\pi R \\Sigma_g(R) \\, dR = 2\\pi \\Sigma_0 \\int_{R_1}^{R_2} R e^{-R/R_d} \\, dR$$\nThe indefinite integral is $\\int R e^{-R/R_d} dR = -R_d(R+R_d)e^{-R/R_d}$. Evaluating the definite integral gives:\n$$M_{\\mathrm{unstable}} = 2\\pi \\Sigma_0 R_d^2 \\left[ (1+u_1)e^{-u_1} - (1+u_2)e^{-u_2} \\right]$$\nThe unstable mass fraction, $f_{\\mathrm{unstable}} = M_{\\mathrm{unstable}} / M_{\\mathrm{gas}}$, where $M_{\\mathrm{gas}} = 2\\pi\\Sigma_0 R_d^2$, simplifies to:\n$$f_{\\mathrm{unstable}} = (1+u_1)e^{-u_1} - (1+u_2)e^{-u_2}$$\nIf $Q_d \\ge 1$, then $f_{\\mathrm{unstable}}=0$. This completes the derivation of all required quantities.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import lambertw\n\ndef solve():\n    \"\"\"\n    Main function to run the semi-analytic galaxy formation model for the provided test suite.\n    \"\"\"\n    \n    # Global constants\n    G = 4.3009e-6  # kpc*km^2/s^2/M_sun\n    H0 = 0.07      # km/s/kpc\n    DELTA = 200.0  # Virial overdensity\n\n    test_cases = [\n        # (M [M_sun], lambda, m_d, f_g, c_s [km/s])\n        (1.0e12, 0.04, 0.05, 0.20, 10.0),  # Case 1\n        (1.0e12, 0.01, 0.08, 0.80, 6.0),   # Case 2\n        (3.0e11, 0.08, 0.03, 0.15, 12.0),  # Case 3\n        (1.0e10, 0.03, 0.06, 0.50, 6.0),   # Case 4\n        (1.0e12, 0.04, 0.05, 0.20, 6.64)   # Case 5\n    ]\n    \n    def calculate_disk_properties(M, lam, m_d, f_g, c_s):\n        \"\"\"\n        Calculates Rd, Qd, and f_unstable based on the derived model.\n        \n        Args:\n            M (float): Total halo mass in solar masses.\n            lam (float): Halo spin parameter (dimensionless).\n            m_d (float): Disk mass fraction (dimensionless).\n            f_g (float): Gas fraction of the disk (dimensionless).\n            c_s (float): Gas velocity dispersion in km/s.\n            \n        Returns:\n            list: A list containing [Rd, Qd, f_unstable].\n        \"\"\"\n        \n        # Step 1: Virial Properties\n        # R_vir = (2 * G * M / (DELTA * H0^2))^(1/3)\n        R_vir = (2.0 * G * M / (DELTA * H0**2))**(1.0/3.0)\n        \n        # V_vir = sqrt(G * M / R_vir)\n        V_vir = np.sqrt(G * M / R_vir)\n        \n        # Step 2: Disk Scale Radius\n        # R_d = lambda * R_vir / sqrt(2)\n        R_d = lam * R_vir / np.sqrt(2.0)\n        \n        # Gas mass\n        M_gas = f_g * m_d * M\n        \n        # Step 3 (Implicit in Step 4): Central Surface Density\n        # Sigma_0 = M_gas / (2 * pi * R_d^2)\n        \n        # Step 4: Toomre Q at R_d\n        # Qd = (2 * sqrt(2) * e * V_vir * c_s * R_d) / (G * M_gas)\n        if M_gas == 0 or R_d == 0:\n            return [R_d, float('inf'), 0.0]\n            \n        Q_d = (2.0 * np.sqrt(2.0) * np.e * V_vir * c_s * R_d) / (G * M_gas)\n        \n        # Step 5: Unstable Mass Fraction\n        f_unstable = 0.0\n        if 0 < Q_d < 1.0:\n            # Solve u * exp(-u) = Q_d / e using the Lambert W function.\n            # Let x = -u, then x * exp(x) = -Q_d / e.\n            arg = -Q_d / np.e\n            \n            # The two solutions u1, u2 are given by the two real branches of W.\n            # u1 = -W_0(arg), u2 = -W_-1(arg)\n            # lambertw returns complex numbers, so we take the real part.\n            u1 = -lambertw(arg, k=0).real\n            u2 = -lambertw(arg, k=-1).real\n            \n            # f_unstable = (1+u1)e^(-u1) - (1+u2)e^(-u2)\n            f_unstable = (1.0 + u1) * np.exp(-u1) - (1.0 + u2) * np.exp(-u2)\n\n        return [R_d, Q_d, f_unstable]\n\n    results = []\n    for case in test_cases:\n        M, lam, m_d, f_g, c_s = case\n        result = calculate_disk_properties(M, lam, m_d, f_g, c_s)\n        results.append(result)\n\n    # The final print statement must match the format [[r1,q1,f1], [r2,q2,f2], ...] exactly.\n    # The default str() representation of a list of lists matches this.\n    print(str(results).replace(\"'\", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond structure, the evolution of a galaxy is governed by the continuous interplay of gas accretion, star formation, and feedback-driven outflows—a system often called the \"baryon cycle.\" This exercise delves into the engine of this cycle by asking you to implement and contrast two different prescriptions for the star formation rate: the empirical Kennicutt-Schmidt law and a more physically-motivated model based on the abundance of molecular hydrogen ($H_2$) . By determining the feedback strength ($\\epsilon_{\\rm fb}$) required by each law to match the observed galaxy main sequence, you will gain first-hand experience with the crucial concept of model degeneracy and the methods used to constrain subgrid physics.",
            "id": "3486103",
            "problem": "Consider a semi-analytic galaxy formation modeling exercise centered on the gas regulator picture and star formation surface density laws. You will construct a program that cross-calibrates feedback normalization by contrasting the Kennicutt–Schmidt law with a molecular hydrogen (H$_2$) partition-based law (Blitz–Rosolowsky), under a physically motivated surface density cap. The objective is to quantify how the required feedback normalization changes between these star formation prescriptions when attempting to match the star-forming main sequence. You must frame the modeling and the algorithm from first principles of mass continuity and observationally-tested star formation relations. All symbols must be interpreted in their specified units, and all numerical outputs must be unitless floats. The final output format must be a single line containing a comma-separated list enclosed in square brackets.\n\nFundamental base and core definitions:\n- The galaxy gas regulator continuity is $\\,\\mathrm{d}M_{\\rm gas}/\\mathrm{d}t = \\dot{M}_{\\rm in} - (1-R)\\,\\mathrm{SFR} - \\eta\\,\\mathrm{SFR}\\,$, where $M_{\\rm gas}$ is the gas mass, $\\dot{M}_{\\rm in}$ is the inflow rate, $R$ is the instantaneous return fraction from stellar evolution, and $\\eta$ is the outflow mass-loading factor. In a quasi-steady state, set $\\,\\mathrm{d}M_{\\rm gas}/\\mathrm{d}t = 0\\,$ to obtain $\\,\\mathrm{SFR}_{\\rm eq} = \\dot{M}_{\\rm in}/\\left(1-R+\\eta\\right)\\,$.\n- The mass-loading factor normalization is parameterized as $\\,\\eta = \\epsilon_{\\rm fb}\\left(V_{\\rm ref}/V_c\\right)^\\gamma\\,$, where $\\epsilon_{\\rm fb}$ is the dimensionless feedback normalization at reference circular velocity $V_{\\rm ref}$, $V_c$ is the galaxy circular velocity, and $\\gamma$ is a power-law index.\n- The Kennicutt–Schmidt relation is $\\,\\Sigma_{\\rm SFR} = A_{\\rm KS}\\,\\Sigma_{\\rm gas}^n\\,$, with $A_{\\rm KS}$ and $n$ constants calibrated to nearby galaxies.\n- The H$_2$-based law adopts $\\Sigma_{\\rm SFR} = A_{\\rm H_2}\\,f_{\\rm H_2}\\,\\Sigma_{\\rm gas}$, where the molecular fraction $\\,f_{\\rm H_2}\\,$ is set by the Blitz–Rosolowsky pressure partition: $R_{\\rm mol} = (P_{\\rm ext}/P_0)^\\alpha$, $f_{\\rm H_2} = R_{\\rm mol}/(1+R_{\\rm mol})$. The external midplane pressure ratio to the normalization is modeled as $\\,P_{\\rm ext}/P_0 = C_P\\,\\Sigma_{\\rm gas}\\,\\left(\\Sigma_{\\rm gas}+\\xi\\,\\Sigma_\\star\\right)\\,$, with $C_P$ a dimensionless constant encoding unit conversion and geometric prefactors, $\\,\\Sigma_\\star\\,$ the stellar surface density, and $\\,\\xi = \\sigma_g/\\sigma_\\star\\,$ the ratio of gas to stellar velocity dispersions.\n- The star-forming main sequence is represented as $\\,\\mathrm{SFR}_{\\rm MS} = k_{\\rm MS}\\,M_\\star^\\beta\\,$.\n\nAlgorithmic task:\n1. For each test case, compute the star formation rate cap for each law at the gas surface density cap $\\,\\Sigma_{\\rm gas,max}\\,$ over disk area $\\,A\\,$:\n   - $\\,\\mathrm{SFR}_{\\rm cap,KS} = A\\,A_{\\rm KS}\\,\\Sigma_{\\rm gas,max}^n\\,$.\n   - $\\,\\mathrm{SFR}_{\\rm cap,H_2} = A\\,A_{\\rm H_2}\\,f_{\\rm H_2}(\\Sigma_{\\rm gas,max})\\,\\Sigma_{\\rm gas,max}\\,$, with $\\,f_{\\rm H_2} = \\frac{(C_P\\,\\Sigma_{\\rm gas,max}\\,(\\Sigma_{\\rm gas,max}+\\xi\\Sigma_\\star))^\\alpha}{1+(C_P\\,\\Sigma_{\\rm gas,max}\\,(\\Sigma_{\\rm gas,max}+\\xi\\Sigma_\\star))^\\alpha}\\,$.\n   Here $\\,A\\,$ is measured in $\\mathrm{kpc}^2$, $\\,\\Sigma_{\\rm gas,max}\\,$ and $\\,\\Sigma_\\star\\,$ in $\\,M_\\odot/\\mathrm{pc}^2$, $\\,\\Sigma_{\\rm SFR}\\,$ in $\\,M_\\odot\\,\\mathrm{yr}^{-1}\\,\\mathrm{kpc}^{-2}$, and all $\\mathrm{SFR}$ are in $\\,M_\\odot/\\mathrm{yr}$.\n2. Define the required star formation rate for each law as $\\,\\mathrm{SFR}_{\\rm req,law} = \\min\\!\\left(\\mathrm{SFR}_{\\rm MS},\\,\\mathrm{SFR}_{\\rm cap,law}\\right)\\,$. This enforces a physically plausible upper limit from the star formation law under the surface density cap.\n3. Solve for the feedback normalization that yields the required star formation rate, using the quasi-steady equilibrium relation:\n   $$\\epsilon_{\\rm fb,law} = \\max\\left\\{0,\\; \\frac{\\dot{M}_{\\rm in}/\\mathrm{SFR}_{\\rm req,law} - (1-R)}{(V_{\\rm ref}/V_c)^\\gamma}\\right\\}.$$\n   The $\\max$ enforces the physical constraint $\\,\\epsilon_{\\rm fb}\\ge 0\\,$. Express $\\,\\epsilon_{\\rm fb,law}\\,$ as a unitless float.\n4. Report the absolute difference $\\,\\Delta\\epsilon_{\\rm fb} = \\left|\\epsilon_{\\rm fb,KS} - \\epsilon_{\\rm fb,H_2}\\right|\\,$ for each test case. The output must be a single line containing the results as a comma-separated list enclosed in square brackets, for example $\\left[\\delta_1, \\delta_2, \\delta_3\\right]$.\n\nUse the following fixed parameter values, consistent with observations and widely used semi-analytic practice:\n- $\\,A_{\\rm KS} = 2.5\\times 10^{-4}\\,$ in $\\,M_\\odot\\,\\mathrm{yr}^{-1}\\,\\mathrm{kpc}^{-2}\\, (M_\\odot\\,\\mathrm{pc}^{-2})^{-n}\\,$.\n- $\\,n = 1.4\\,$.\n- $\\,t_{\\rm dep} = 2.0\\times 10^9\\,$ years for molecular gas, implying $A_{\\rm H_2} = 10^6/t_{\\rm dep} = 5.0\\times 10^{-4}\\,$ in $\\,M_\\odot\\,\\mathrm{yr}^{-1}\\,\\mathrm{kpc}^{-2}\\,(M_\\odot\\,\\mathrm{pc}^{-2})^{-1}\\,$.\n- Blitz–Rosolowsky parameters: $\\,\\alpha = 0.92\\,$, $\\,C_P = 5.0\\times 10^{-4}\\,$ as a dimensionless prefactor mapping $\\,\\Sigma\\,$ pairs in $M_\\odot/\\mathrm{pc}^2$ to $\\,P_{\\rm ext}/P_0\\,$.\n- Feedback and stellar evolution: $\\,R = 0.4\\,$, $\\,V_{\\rm ref} = 200\\,\\mathrm{km}\\,\\mathrm{s}^{-1}\\,$, $\\,\\gamma = 2\\,$.\n- Main sequence: $\\,k_{\\rm MS} = 1.0\\times 10^{-10}\\,$ in $\\,\\mathrm{yr}^{-1}\\,$, $\\,\\beta = 1.0\\,$.\n\nScientific realism and unit specification:\n- $\\,\\dot{M}_{\\rm in}\\,$ must be in $\\,M_\\odot/\\mathrm{yr}\\,$, $\\,V_c\\,$ and $\\,V_{\\rm ref}\\,$ must be in $\\,\\mathrm{km}\\,\\mathrm{s}^{-1}\\,$, $\\,A\\,$ must be in $\\,\\mathrm{kpc}^2\\,$, and $\\,\\Sigma\\,$-type quantities must be in $\\,M_\\odot/\\mathrm{pc}^2\\,$. The computed $\\,\\epsilon_{\\rm fb}\\,$ is dimensionless.\n\nTest suite:\nProvide the following five parameter sets to exercise diverse regimes:\n- Case $\\,1\\,$ (happy path): $\\dot{M}_{\\rm in} = 20.0$, $V_c = 200.0$, $A = 200.0$, $\\Sigma_\\star = 500.0$, $\\xi = 0.1$, $\\Sigma_{\\rm gas,max} = 100.0$, $M_\\star = 5.0\\times 10^{10}$.\n- Case $\\,2\\,$ (H$_2$ cap limiting, Kennicutt–Schmidt not): $\\dot{M}_{\\rm in} = 15.0$, $V_c = 200.0$, $A = 200.0$, $\\Sigma_\\star = 200.0$, $\\xi = 0.1$, $\\Sigma_{\\rm gas,max} = 30.0$, $M_\\star = 5.0\\times 10^{10}$.\n- Case $\\,3\\,$ (both caps limiting): $\\dot{M}_{\\rm in} = 12.0$, $V_c = 220.0$, $A = 50.0$, $\\Sigma_\\star = 200.0$, $\\xi = 0.1$, $\\Sigma_{\\rm gas,max} = 30.0$, $M_\\star = 1.0\\times 10^{11}$.\n- Case $\\,4\\,$ (high circular velocity boundary): $\\dot{M}_{\\rm in} = 30.0$, $V_c = 300.0$, $A = 200.0$, $\\Sigma_\\star = 500.0$, $\\xi = 0.1$, $\\Sigma_{\\rm gas,max} = 100.0$, $M_\\star = 5.0\\times 10^{10}$.\n- Case $\\,5\\,$ (low inflow leading to clipping at zero feedback): $\\dot{M}_{\\rm in} = 1.0$, $V_c = 200.0$, $A = 200.0$, $\\Sigma_\\star = 500.0$, $\\xi = 0.1$, $\\Sigma_{\\rm gas,max} = 100.0$, $M_\\star = 5.0\\times 10^{10}$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5]$), where each $\\,\\delta_i\\,$ is the absolute difference $\\,\\Delta\\epsilon_{\\rm fb}\\,$ for the corresponding test case expressed as a float.",
            "solution": "We begin with the gas regulator continuity equation $\\,\\mathrm{d}M_{\\rm gas}/\\mathrm{d}t = \\dot{M}_{\\rm in} - (1-R)\\mathrm{SFR} - \\eta \\mathrm{SFR}\\,$. In a quasi-steady state, setting the left-hand side to zero gives $\\,\\mathrm{SFR}_{\\rm eq} = \\dot{M}_{\\rm in}/(1-R+\\eta)\\,$. This is the standard equilibrium solution in semi-analytic galaxy formation models and follows from mass conservation under the assumption of slow variation of reservoirs compared to sink/source terms.\n\nThe outflow mass-loading factor is parameterized as $\\,\\eta = \\epsilon_{\\rm fb}(V_{\\rm ref}/V_c)^\\gamma\\,$. Here $\\,\\epsilon_{\\rm fb}\\,$ is the normalization at the reference circular velocity $\\,V_{\\rm ref}\\,$, and $\\,\\gamma\\,$ is a power-law index capturing how feedback strength changes with potential depth. This parameterization is widely used and empirically motivated by wind models.\n\nStar formation laws:\n- Kennicutt–Schmidt (KS): $\\,\\Sigma_{\\rm SFR} = A_{\\rm KS}\\,\\Sigma_{\\rm gas}^n\\,$. The constants $\\,A_{\\rm KS} = 2.5\\times 10^{-4}\\,$ in $\\,M_\\odot\\,\\mathrm{yr}^{-1}\\,\\mathrm{kpc}^{-2}\\, (M_\\odot\\,\\mathrm{pc}^{-2})^{-n}\\,$ and $\\,n = 1.4\\,$ reflect the observed scaling in nearby galaxies.\n- H$_2$-based law: $\\,\\Sigma_{\\rm SFR} = A_{\\rm H_2}\\,f_{\\rm H_2}\\,\\Sigma_{\\rm gas}\\,$. We adopt a molecular gas depletion time $\\,t_{\\rm dep} = 2.0\\times 10^9\\,$ years, so $\\,A_{\\rm H_2} = 10^6/t_{\\rm dep} = 5.0\\times 10^{-4}\\,$ in $\\,M_\\odot\\,\\mathrm{yr}^{-1}\\,\\mathrm{kpc}^{-2}\\,(M_\\odot\\,\\mathrm{pc}^{-2})^{-1}\\,$. The Blitz–Rosolowsky partition uses $\\,R_{\\rm mol} = (P_{\\rm ext}/P_0)^\\alpha\\,$ with $\\,\\alpha = 0.92\\,$, and $\\,f_{\\rm H_2} = R_{\\rm mol}/(1+R_{\\rm mol})\\,$. To compute $\\,P_{\\rm ext}/P_0\\,$, we employ a dimensionless pressure mapping consistent with hydrostatic expectations: $\\,P_{\\rm ext}/P_0 = C_P\\,\\Sigma_{\\rm gas}\\,(\\Sigma_{\\rm gas}+\\xi\\Sigma_\\star)\\,$ with $\\,C_P = 5.0\\times 10^{-4}\\,$ and $\\,\\xi = \\sigma_g/\\sigma_\\star\\,$.\n\nGiven a maximum gas surface density $\\,\\Sigma_{\\rm gas,max}\\,$ and disk area $\\,A\\,$, the global star formation rate cannot exceed the cap implied by each law:\n- $\\,\\mathrm{SFR}_{\\rm cap,KS} = A\\,A_{\\rm KS}\\,\\Sigma_{\\rm gas,max}^n\\,$.\n- For the H$_2$ law, compute $\\,P_{\\rm ext}/P_0 = C_P\\,\\Sigma_{\\rm gas,max}\\,(\\Sigma_{\\rm gas,max}+\\xi\\Sigma_\\star)\\,$, $\\,R_{\\rm mol} = (P_{\\rm ext}/P_0)^\\alpha\\,$, $\\,f_{\\rm H_2} = R_{\\rm mol}/(1+R_{\\rm mol})\\,$, and $\\,\\mathrm{SFR}_{\\rm cap,H_2} = A\\,A_{\\rm H_2}\\,f_{\\rm H_2}\\,\\Sigma_{\\rm gas,max}\\,$.\n\nThe star-forming main sequence is $\\,\\mathrm{SFR}_{\\rm MS} = k_{\\rm MS}\\,M_\\star^\\beta\\,$, with $\\,k_{\\rm MS} = 1.0\\times 10^{-10}\\,$ in $\\,\\mathrm{yr}^{-1}\\,$ and $\\,\\beta = 1.0\\,$. This places a target star formation rate at the stellar mass scale.\n\nTo cross-calibrate feedback normalization with star formation laws while disentangling degeneracy, we impose that the achievable star formation is limited by the cap and thus define $\\,\\mathrm{SFR}_{\\rm req,law} = \\min(\\mathrm{SFR}_{\\rm MS},\\mathrm{SFR}_{\\rm cap,law})\\,$. This operationalizes the physical constraint that feedback cannot force the star formation to exceed the maximum permitted by the star formation law at the allowed surface density. Plugging $\\,\\mathrm{SFR}_{\\rm req,law}\\,$ into the equilibrium relation solves for $\\,\\epsilon_{\\rm fb}$:\n$$\\epsilon_{\\rm fb,law} = \\max\\left\\{0,\\; \\frac{\\dot{M}_{\\rm in}/\\mathrm{SFR}_{\\rm req,law} - (1-R)}{(V_{\\rm ref}/V_c)^\\gamma}\\right\\}.$$\nThe $\\,\\max\\,$ reflects that negative feedback normalization is non-physical and therefore clipped to zero in low inflow regimes.\n\nFinally, the quantity of interest is the absolute difference $\\,\\Delta\\epsilon_{\\rm fb} = |\\epsilon_{\\rm fb,KS} - \\epsilon_{\\rm fb,H_2}|\\,$, which measures how sensitive the inferred feedback normalization is to the assumed star formation law under identical inflow, structural, and cap conditions. When both caps comfortably exceed the main sequence target, the degeneracy is maximal and $\\,\\Delta\\epsilon_{\\rm fb}\\,$ tends to zero because $\\,\\epsilon_{\\rm fb}\\,$ depends only on the required equilibrium star formation rate. When one or both caps are binding, the two laws imply different $\\,\\mathrm{SFR}_{\\rm req}\\,$ and therefore different $\\,\\epsilon_{\\rm fb}\\,$, quantifying the degeneracy-breaking power of the cap and molecular partition physics.\n\nAlgorithmic steps for the program:\n1. For each test case, compute $\\,\\mathrm{SFR}_{\\rm MS} = k_{\\rm MS} M_\\star^\\beta\\,$.\n2. Compute $\\,\\mathrm{SFR}_{\\rm cap,KS}\\,$ via the Kennicutt–Schmidt law at $\\,\\Sigma_{\\rm gas,max}\\,$.\n3. Compute $\\,\\mathrm{SFR}_{\\rm cap,H_2}\\,$ via the Blitz–Rosolowsky partition evaluated at $\\,\\Sigma_{\\rm gas,max}\\,$ and the H$_2$ star formation law.\n4. Set $\\,\\mathrm{SFR}_{\\rm req,KS} = \\min(\\mathrm{SFR}_{\\rm MS},\\mathrm{SFR}_{\\rm cap,KS})\\,$ and $\\,\\mathrm{SFR}_{\\rm req,H_2} = \\min(\\mathrm{SFR}_{\\rm MS},\\mathrm{SFR}_{\\rm cap,H_2})\\,$.\n5. Compute $\\,\\epsilon_{\\rm fb,KS}\\,$ and $\\,\\epsilon_{\\rm fb,H_2}\\,$ using the equilibrium formula with clipping at zero. All inputs are in specified units; the resulting $\\,\\epsilon_{\\rm fb}\\,$ values are dimensionless.\n6. Output $\\,\\Delta\\epsilon_{\\rm fb}\\,$ as a float for each test case on a single line as a comma-separated list enclosed in square brackets.\n\nThis procedure tests a happy path where both laws permit the main sequence, a case where molecular partitioning caps the star formation but the Kennicutt–Schmidt law does not, a case where both caps are limiting, a case probing sensitivity to $\\,V_c\\,$, and a low inflow case where clipping occurs. The output values are unitless floats suitable for automated verification.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Fixed global parameters as specified in the problem statement.\nA_KS = 2.5e-4            # Kennicutt-Schmidt normalization [Msun yr^-1 kpc^-2 (Msun pc^-2)^-n]\nn_KS = 1.4               # Kennicutt-Schmidt slope\nt_dep = 2.0e9            # Molecular gas depletion time [yr]\nA_H2 = 1.0e6 / t_dep     # H2 law normalization [Msun yr^-1 kpc^-2 (Msun pc^-2)^-1]\nalpha_BR = 0.92          # Blitz-Rosolowsky exponent\nC_P = 5.0e-4             # Dimensionless prefactor mapping to P_ext/P0\nR_return = 0.4           # Instantaneous return fraction\nV_ref = 200.0            # Reference circular velocity [km/s]\ngamma = 2.0              # Feedback velocity scaling index\nk_MS = 1.0e-10           # Main sequence normalization [yr^-1]\nbeta_MS = 1.0            # Main sequence slope\n\ndef f_H2_blitz_rosolowsky(sigma_gas, sigma_star, xi):\n    \"\"\"\n    Compute molecular fraction f_H2 using Blitz–Rosolowsky pressure partition.\n    Inputs:\n        sigma_gas  : gas surface density [Msun/pc^2]\n        sigma_star : stellar surface density [Msun/pc^2]\n        xi         : velocity dispersion ratio sigma_g / sigma_*\n    Returns:\n        f_H2       : molecular fraction (unitless)\n    \"\"\"\n    # External pressure ratio P_ext/P0 using dimensionless mapping\n    p_ratio = C_P * sigma_gas * (sigma_gas + xi * sigma_star)\n    # Molecular-to-atomic ratio\n    R_mol = p_ratio ** alpha_BR\n    # Molecular fraction\n    f_h2 = R_mol / (1.0 + R_mol)\n    return f_h2\n\ndef sfr_cap_ks(area_kpc2, sigma_gas_max):\n    \"\"\"\n    SFR cap under Kennicutt-Schmidt law at given maximum gas surface density.\n    \"\"\"\n    sigma_sfr = A_KS * (sigma_gas_max ** n_KS)\n    return area_kpc2 * sigma_sfr  # [Msun/yr]\n\ndef sfr_cap_h2(area_kpc2, sigma_gas_max, sigma_star, xi):\n    \"\"\"\n    SFR cap under H2-based law at given maximum gas surface density.\n    \"\"\"\n    f_h2 = f_H2_blitz_rosolowsky(sigma_gas_max, sigma_star, xi)\n    sigma_sfr = A_H2 * f_h2 * sigma_gas_max\n    return area_kpc2 * sigma_sfr  # [Msun/yr]\n\ndef epsilon_fb_required(mdot_in, sfr_req, Vc):\n    \"\"\"\n    Compute required feedback normalization epsilon_fb given required SFR,\n    inflow rate, and circular velocity, with non-negativity clipping.\n    \"\"\"\n    # Avoid division by zero in pathological cases\n    if sfr_req <= 0.0:\n        return 0.0\n    factor = (V_ref / Vc) ** gamma\n    eps = (mdot_in / sfr_req) - (1.0 - R_return)\n    eps /= factor\n    # Non-negative clipping\n    eps = max(0.0, eps)\n    return eps\n\ndef main():\n    # Define the test cases as specified: (mdot_in, Vc, A_kpc2, Sigma_star, xi, Sigma_gas_max, M_star)\n    test_cases = [\n        (20.0, 200.0, 200.0, 500.0, 0.1, 100.0, 5.0e10),   # Case 1\n        (15.0, 200.0, 200.0, 200.0, 0.1, 30.0, 5.0e10),    # Case 2\n        (12.0, 220.0, 50.0, 200.0, 0.1, 30.0, 1.0e11),     # Case 3\n        (30.0, 300.0, 200.0, 500.0, 0.1, 100.0, 5.0e10),   # Case 4\n        (1.0, 200.0, 200.0, 500.0, 0.1, 100.0, 5.0e10),    # Case 5\n    ]\n\n    results = []\n    for (mdot_in, Vc, area_kpc2, sigma_star, xi, sigma_gas_max, M_star) in test_cases:\n        # Main sequence target SFR\n        sfr_ms = k_MS * (M_star ** beta_MS)\n\n        # Caps from both laws\n        cap_ks = sfr_cap_ks(area_kpc2, sigma_gas_max)\n        cap_h2 = sfr_cap_h2(area_kpc2, sigma_gas_max, sigma_star, xi)\n\n        # Required SFRs under each law\n        sfr_req_ks = min(sfr_ms, cap_ks)\n        sfr_req_h2 = min(sfr_ms, cap_h2)\n\n        # Required feedback normalizations\n        eps_ks = epsilon_fb_required(mdot_in, sfr_req_ks, Vc)\n        eps_h2 = epsilon_fb_required(mdot_in, sfr_req_h2, Vc)\n\n        # Absolute difference\n        diff = abs(eps_ks - eps_h2)\n        results.append(diff)\n\n    # Final print in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    main()\n```"
        },
        {
            "introduction": "Galaxies do not evolve in isolation; their growth is profoundly influenced by interactions and mergers with other galaxies. A key challenge in numerical cosmology is tracking satellite galaxies after their host dark matter subhalos are tidally stripped and fall below the resolution of a simulation, becoming so-called \"orphan\" galaxies. This practice addresses this challenge by having you model the subsequent orbital decay of an orphan satellite due to dynamical friction, a fundamental gravitational process . By calculating the merging timescale and assessing the satellite's ability to survive tidal forces, you will implement a critical component of semi-analytic models responsible for building the merger history of galaxies.",
            "id": "3486152",
            "problem": "In a semi-analytic galaxy formation model within numerical cosmology, a satellite galaxy becomes an “orphan” at time $t_0$ when its resolved dark matter subhalo is disrupted in a host halo. To continue tracking the orphan, you must specify physically motivated rules for its position evolution, merging time with the central galaxy, and survival versus tidal disruption. Consider a host halo that is well approximated by a Singular Isothermal Sphere (SIS), which has constant circular velocity $V_c$ and a velocity dispersion $\\sigma$ related by $\\sigma = V_c / \\sqrt{2}$. Assume the background phase-space distribution is approximately Maxwellian and that the drag force is governed by the Chandrasekhar dynamical friction mechanism. The satellite has stellar and gas mass $m_{\\mathrm{sat}}$ and structural half-mass radius $r_\\star$; disruption will occur if the instantaneous tidal radius $r_t$ at pericenter is smaller than a multiple of the structural scale, i.e., if $r_t < \\kappa r_\\star$ for some $\\kappa > 1$. For orbital decay, take the orbit to be initially circular at the last-resolved radius $r_0$ with speed $v_0 \\simeq V_c$; treat the Coulomb logarithm as a constant $\\ln \\Lambda$.\n\nWork in the following specific setup:\n- Host halo circular velocity $V_c = 200 \\, \\mathrm{km \\, s^{-1}}$ and isothermal profile.\n- Satellite mass $m_{\\mathrm{sat}} = 10^{10} \\, M_\\odot$, structural half-mass radius $r_\\star = 2 \\, \\mathrm{kpc}$, and last-resolved radius $r_0 = 50 \\, \\mathrm{kpc}$ with $v_0 = V_c$ at $t_0$.\n- Coulomb logarithm $\\ln \\Lambda = 3$, and use $\\kappa = 2$ in the survival criterion.\n- Take the error-function combination in the Chandrasekhar drag coefficient for $X \\equiv v/(\\sqrt{2}\\sigma) = 1$ as the dimensionless factor $B \\equiv \\mathrm{erf}(1) - \\frac{2}{\\sqrt{\\pi}} e^{-1}$.\n- Use the enclosed mass of the SIS within radius $r$ given by $M_{\\mathrm{enc}}(r)$ implied by the SIS and $V_c$.\n\nUsing these physical bases, determine which orphan tracking scheme is self-consistent and quantitatively correct for the above setup. Your choice must specify:\n- A position evolution rule yielding the radius $r(t)$ after time $\\Delta t = 2 \\, \\mathrm{Gyr}$.\n- A merging time $t_{\\mathrm{merge}}$ implied by the same frictional decay.\n- A survival versus disruption classification at $t_0$ and at $t_0 + 2 \\, \\mathrm{Gyr}$, based on the tidal radius $r_t$ computed at the instantaneous circular radius and the criterion $r_t < \\kappa r_\\star$.\n\nSelect the single best option.\n\nA. Position is frozen at $r(t) = r_0$ for all $t$, with merging enforced at a fixed timescale $t_{\\mathrm{merge}} \\simeq r_0 / V_c \\approx 0.25 \\, \\mathrm{Gyr}$; survival is determined by comparing $r_t$ computed using the virial mass of the host rather than $M_{\\mathrm{enc}}(r)$, yielding $r_t \\approx 2 \\, \\mathrm{kpc}$ and immediate disruption at $t_0$ and at $t_0 + 2 \\, \\mathrm{Gyr}$.\n\nB. Position decays due to dynamical friction consistent with the Chandrasekhar prescription in an SIS, giving $r(2 \\, \\mathrm{Gyr}) \\approx 37 \\, \\mathrm{kpc}$; the corresponding merging time is $t_{\\mathrm{merge}} \\approx 4.4 \\, \\mathrm{Gyr}$; survival is assessed with $r_t(r) = r \\left[ m_{\\mathrm{sat}} / \\left( 3 M_{\\mathrm{enc}}(r) \\right) \\right]^{1/3}$, yielding $r_t(t_0) \\approx 9.6 \\, \\mathrm{kpc}$ and $r_t(t_0 + 2 \\, \\mathrm{Gyr}) \\approx 8.0 \\, \\mathrm{kpc}$, both exceeding $\\kappa r_\\star = 4 \\, \\mathrm{kpc}$, so the orphan survives at both epochs.\n\nC. Position decays exponentially, $r(t) = r_0 \\exp\\!\\left( - t / t_0 \\right)$ with a constant timescale $t_0$ chosen to match the host dynamical time, yielding $r(2 \\, \\mathrm{Gyr}) \\approx 41 \\, \\mathrm{kpc}$ and $t_{\\mathrm{merge}} \\approx 11 \\, \\mathrm{Gyr}$; survival is determined by comparing $r_t$ to $r_\\star$ (without the factor $\\kappa$), giving $r_t(t_0) \\approx 5 \\, \\mathrm{kpc}$ and $r_t(t_0 + 2 \\, \\mathrm{Gyr}) \\approx 4 \\, \\mathrm{kpc}$, interpreted as disruption at both epochs.\n\nD. Position decays linearly, $r(t) = r_0 - \\alpha t$ with a constant $\\alpha$ chosen such that $t_{\\mathrm{merge}} \\propto r_0$ and numerically $t_{\\mathrm{merge}} \\approx 1.1 \\, \\mathrm{Gyr}$; the radius after $2 \\, \\mathrm{Gyr}$ is $r(2 \\, \\mathrm{Gyr}) \\approx 31 \\, \\mathrm{kpc}$; survival is assessed using $r_t(r) = r \\left[ m_{\\mathrm{sat}} / M_{\\mathrm{enc}}(r) \\right]^{1/3}$ (omitting the factor of $3$), yielding survival at $t_0$ and at $t_0 + 2 \\, \\mathrm{Gyr}$.\n\nAssume $G = 4.302 \\times 10^{-6} \\, \\mathrm{kpc} \\, (\\mathrm{km/s})^2 \\, M_\\odot^{-1}$ and $1 \\, \\mathrm{km/s} = 1.0227 \\, \\mathrm{kpc/Gyr}$ when converting units if needed. Answer by choosing the option that is physically consistent with the specified bases and parameters and yields correct quantitative outcomes.",
            "solution": "The problem requires a critical validation of its premises before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Host Halo Model**: Singular Isothermal Sphere (SIS) with constant circular velocity $V_c$ and velocity dispersion $\\sigma = V_c / \\sqrt{2}$.\n- **Background Physics**: Maxwellian phase-space distribution, drag governed by Chandrasekhar dynamical friction.\n- **Initial Satellite State (at $t_0$)**: Initial orbit is circular at radius $r_0$ with velocity $v_0 \\simeq V_c$.\n- **Disruption Criterion**: Disruption occurs if the tidal radius $r_t$ is less than $\\kappa r_\\star$.\n- **Host Halo Parameter**: $V_c = 200 \\, \\mathrm{km \\, s^{-1}}$.\n- **Satellite Parameters**:\n  - Mass: $m_{\\mathrm{sat}} = 10^{10} \\, M_\\odot$.\n  - Structural half-mass radius: $r_\\star = 2 \\, \\mathrm{kpc}$.\n  - Last-resolved (initial) radius: $r_0 = 50 \\, \\mathrm{kpc}$.\n  - Initial velocity: $v_0 = V_c$.\n- **Dynamical Friction Parameters**:\n  - Coulomb logarithm: $\\ln \\Lambda = 3$.\n  - Dimensionless factor for $X=1$: $B \\equiv \\mathrm{erf}(1) - \\frac{2}{\\sqrt{\\pi}} e^{-1}$.\n- **Disruption Parameter**: $\\kappa = 2$.\n- **Enclosed Mass**: $M_{\\mathrm{enc}}(r)$ is the mass enclosed within radius $r$ for an SIS profile with the given $V_c$.\n- **Evaluation Time**: $\\Delta t = 2 \\, \\mathrm{Gyr}$ after $t_0$.\n- **Constants**:\n  - $G = 4.302 \\times 10^{-6} \\, \\mathrm{kpc} \\, (\\mathrm{km/s})^2 \\, M_\\odot^{-1}$.\n  - $1 \\, \\mathrm{km/s} = 1.0227 \\, \\mathrm{kpc/Gyr}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is well-grounded in standard galactic and extragalactic dynamics. The concepts of a Singular Isothermal Sphere, Chandrasekhar dynamical friction, and tidal disruption are textbook topics in astrophysics. The setup describes a common problem in semi-analytic models of galaxy formation.\n2.  **Well-Posedness**: The problem provides a complete set of initial conditions, physical laws, and parameter values to determine the evolution of the satellite's orbit and its structural integrity. A unique solution for the specified quantities ($r(t)$, $t_{\\mathrm{merge}}$, $r_t$) can be derived.\n3.  **Objectivity**: The problem is stated in precise, quantitative language, free of subjective or ambiguous terminology.\n4.  **Consistency and Completeness**: The parameters are consistent with each other. For an SIS, a circular orbit at any radius has speed $V_c$, so $v_0 = V_c$ is consistent. The relationship $\\sigma = V_c / \\sqrt{2}$ is correct for an isotropic SIS. The problem is self-contained.\n5.  **Realism**: The numerical values for the host halo ($V_c=200 \\, \\mathrm{km/s}$) and satellite ($m_{\\mathrm{sat}}=10^{10} M_\\odot$, $r_0=50 \\text{ kpc}$) are representative of a Milky Way-like galaxy and a massive satellite. The scenario is physically plausible.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. The premises are scientifically sound, consistent, complete, and well-posed. I will proceed to derive the solution.\n\n### Derivation from First Principles\n\n**1. Orbital Decay due to Dynamical Friction**\nThe Chandrasekhar dynamical friction force is given by\n$$ \\vec{F}_{\\mathrm{df}} = -4\\pi G^2 m_{\\mathrm{sat}}^2 \\rho(r) (\\ln \\Lambda) \\left[ \\mathrm{erf}(X) - \\frac{2X}{\\sqrt{\\pi}} e^{-X^2} \\right] \\frac{\\vec{v}}{v^3} $$\nwhere $X = v/(\\sqrt{2}\\sigma)$. For the given SIS, $v = V_c$ and $\\sigma = V_c/\\sqrt{2}$, which gives $X = V_c / (\\sqrt{2} \\cdot V_c/\\sqrt{2}) = 1$. The term in brackets is the given constant $B$.\nThe density profile of an SIS is $\\rho(r) = \\frac{V_c^2}{4\\pi G r^2}$.\nSubstituting these into the force magnitude equation, with $v=V_c$:\n$$ F_{\\mathrm{df}} = 4\\pi G^2 m_{\\mathrm{sat}}^2 \\left(\\frac{V_c^2}{4\\pi G r^2}\\right) (\\ln \\Lambda) B \\frac{1}{V_c^2} = \\frac{G m_{\\mathrm{sat}}^2 (\\ln \\Lambda) B}{r^2} $$\nFor a circular orbit, the rate of change of angular momentum $L = m_{\\mathrm{sat}} r V_c$ is equal to the torque $\\tau = -r F_{\\mathrm{df}}$.\n$$ \\frac{dL}{dt} = \\frac{d}{dt}(m_{\\mathrm{sat}} r V_c) = m_{\\mathrm{sat}} V_c \\frac{dr}{dt} = -r F_{\\mathrm{df}} = -r \\left(\\frac{G m_{\\mathrm{sat}}^2 (\\ln \\Lambda) B}{r^2}\\right) $$\n$$ m_{\\mathrm{sat}} V_c \\frac{dr}{dt} = -\\frac{G m_{\\mathrm{sat}}^2 (\\ln \\Lambda) B}{r} \\implies r \\frac{dr}{dt} = -\\frac{G m_{\\mathrm{sat}} (\\ln \\Lambda) B}{V_c} $$\nThis is a separable differential equation. Integrating from $r(0)=r_0$ to $r(t)$:\n$$ \\int_{r_0}^{r(t)} r' dr' = -\\int_0^t \\frac{G m_{\\mathrm{sat}} (\\ln \\Lambda) B}{V_c} dt' $$\n$$ \\frac{1}{2} (r(t)^2 - r_0^2) = -\\frac{G m_{\\mathrm{sat}} (\\ln \\Lambda) B}{V_c} t $$\n$$ r(t)^2 = r_0^2 - \\frac{2 G m_{\\mathrm{sat}} (\\ln \\Lambda) B}{V_c} t $$\nThe merging time $t_{\\mathrm{merge}}$ is the time when $r(t)=0$:\n$$ t_{\\mathrm{merge}} = \\frac{r_0^2 V_c}{2 G m_{\\mathrm{sat}} (\\ln \\Lambda) B} $$\n\n**2. Numerical Calculation of Merging Time and Position**\nFirst, we calculate the dimensionless factor $B$:\n$B = \\mathrm{erf}(1) - \\frac{2}{\\sqrt{\\pi}} e^{-1} \\approx 0.84270 - \\frac{2}{1.77245} e^{-1} \\approx 0.84270 - 1.12838 \\times 0.36788 \\approx 0.84270 - 0.41511 = 0.42759$.\n\nNow we calculate $t_{\\mathrm{merge}}$ using the given constants:\n$r_0 = 50 \\, \\mathrm{kpc}$\n$V_c = 200 \\, \\mathrm{km \\, s^{-1}}$\n$m_{\\mathrm{sat}} = 10^{10} \\, M_\\odot$\n$G = 4.302 \\times 10^{-6} \\, \\mathrm{kpc} \\, (\\mathrm{km/s})^2 \\, M_\\odot^{-1}$\n$\\ln \\Lambda = 3$\n$B \\approx 0.4276$\n\n$$ t_{\\mathrm{merge}} = \\frac{(50 \\, \\mathrm{kpc})^2 (200 \\, \\mathrm{km/s})}{2 (4.302 \\times 10^{-6}) (10^{10}) (3) (0.4276)} \\, \\frac{M_\\odot}{\\mathrm{kpc} \\, (\\mathrm{km/s})^2} $$\n$$ t_{\\mathrm{merge}} = \\frac{2500 \\times 200}{2 \\times 4.302 \\times 10^4 \\times 3 \\times 0.4276} \\, \\frac{\\mathrm{kpc}}{\\mathrm{km/s}} = \\frac{5 \\times 10^5}{110214} \\, \\frac{\\mathrm{kpc}}{\\mathrm{km/s}} \\approx 4.5366 \\, \\frac{\\mathrm{kpc}}{\\mathrm{km/s}} $$\nUsing the conversion $1 \\, \\mathrm{km/s} = 1.0227 \\, \\mathrm{kpc/Gyr}$, we have $1 \\, \\mathrm{kpc/(km/s)} = 1/1.0227 \\, \\mathrm{Gyr} \\approx 0.9778 \\, \\mathrm{Gyr}$.\n$$ t_{\\mathrm{merge}} \\approx 4.5366 \\times 0.9778 \\, \\mathrm{Gyr} \\approx 4.436 \\, \\mathrm{Gyr} $$\nThe orbital radius at $t = \\Delta t = 2 \\, \\mathrm{Gyr}$ is given by:\n$$ r(t)^2 = r_0^2 \\left(1 - \\frac{t}{t_{\\mathrm{merge}}}\\right) $$\n$$ r(2 \\, \\mathrm{Gyr})^2 = (50 \\, \\mathrm{kpc})^2 \\left(1 - \\frac{2}{4.436}\\right) = 2500 \\left(1 - 0.4508\\right) = 2500 \\times 0.5492 = 1373 \\, \\mathrm{kpc}^2 $$\n$$ r(2 \\, \\mathrm{Gyr}) = \\sqrt{1373} \\approx 37.05 \\, \\mathrm{kpc} $$\n\n**3. Tidal Radius and Survival**\nThe problem asks to evaluate the survival based on the formula specified in option B: $r_t(r) = r \\left[ m_{\\mathrm{sat}} / \\left( 3 M_{\\mathrm{enc}}(r) \\right) \\right]^{1/3}$.\nFirst, we find the enclosed mass for an SIS: $V_c^2 = G M_{\\mathrm{enc}}(r) / r \\implies M_{\\mathrm{enc}}(r) = V_c^2 r / G$.\n$$ M_{\\mathrm{enc}}(r) = \\frac{(200 \\, \\mathrm{km/s})^2 r}{4.302 \\times 10^{-6} \\, \\mathrm{kpc} \\, (\\mathrm{km/s})^2 \\, M_\\odot^{-1}} \\approx (9.298 \\times 10^9 \\, M_\\odot/\\mathrm{kpc}) \\cdot r $$\nNow we calculate the tidal radius:\n$$ r_t(r) = r \\left( \\frac{10^{10} \\, M_\\odot}{3 \\cdot (9.298 \\times 10^9 \\, M_\\odot/\\mathrm{kpc}) \\cdot r} \\right)^{1/3} = r \\left( \\frac{10}{27.894} \\frac{\\mathrm{kpc}}{r} \\right)^{1/3} = r \\left( \\frac{0.3585}{r/\\mathrm{kpc}} \\right)^{1/3} $$\n$$ r_t(r) \\approx 0.7104 \\cdot r^{2/3} \\, \\mathrm{kpc} $$\nThe disruption condition is $r_t < \\kappa r_\\star$. With $\\kappa=2$ and $r_\\star=2 \\, \\mathrm{kpc}$, the threshold is $4 \\, \\mathrm{kpc}$.\n\n- At time $t_0$, $r=r_0=50 \\, \\mathrm{kpc}$:\n$r_t(t_0) \\approx 0.7104 \\cdot (50)^{2/3} \\approx 0.7104 \\cdot (13.572) \\approx 9.64 \\, \\mathrm{kpc}$.\nSince $9.64 \\, \\mathrm{kpc} > 4 \\, \\mathrm{kpc}$, the satellite survives at $t_0$.\n\n- At time $t_0 + 2 \\, \\mathrm{Gyr}$, $r(2 \\, \\mathrm{Gyr}) \\approx 37.05 \\, \\mathrm{kpc}$:\n$r_t(2 \\, \\mathrm{Gyr}) \\approx 0.7104 \\cdot (37.05)^{2/3} \\approx 0.7104 \\cdot (11.096) \\approx 7.88 \\, \\mathrm{kpc}$.\nSince $7.88 \\, \\mathrm{kpc} > 4 \\, \\mathrm{kpc}$, the satellite survives at $t_0 + 2 \\, \\mathrm{Gyr}$.\n\nOur derived values are: $r(2\\,\\mathrm{Gyr}) \\approx 37.1 \\, \\mathrm{kpc}$, $t_{\\mathrm{merge}} \\approx 4.4 \\, \\mathrm{Gyr}$, $r_t(t_0) \\approx 9.6 \\, \\mathrm{kpc}$, and $r_t(t_0+2\\,\\mathrm{Gyr}) \\approx 7.9 \\, \\mathrm{kpc}$. The satellite survives at both epochs.\n\n### Option-by-Option Analysis\n\n**A. Position is frozen at $r(t) = r_0$ for all $t$, with merging enforced at a fixed timescale $t_{\\mathrm{merge}} \\simeq r_0 / V_c \\approx 0.25 \\, \\mathrm{Gyr}$; survival is determined by comparing $r_t$ computed using the virial mass of the host rather than $M_{\\mathrm{enc}}(r)$, yielding $r_t \\approx 2 \\, \\mathrm{kpc}$ and immediate disruption at $t_0$ and at $t_0 + 2 \\, \\mathrm{Gyr}$.**\n- The position evolution model (frozen position) contradicts the specified dynamical friction mechanism.\n- The merging timescale $r_0/V_c$ is the dynamical time, not the friction time, which is incorrect for orbital decay. Our calculated friction time is $\\approx 4.4 \\, \\mathrm{Gyr}$.\n- The prescription for $r_t$ is incorrect; tidal forces are local and depend on $M_{\\mathrm{enc}}(r)$.\n**Verdict: Incorrect.**\n\n**B. Position decays due to dynamical friction consistent with the Chandrasekhar prescription in an SIS, giving $r(2 \\, \\mathrm{Gyr}) \\approx 37 \\, \\mathrm{kpc}$; the corresponding merging time is $t_{\\mathrm{merge}} \\approx 4.4 \\, \\mathrm{Gyr}$; survival is assessed with $r_t(r) = r \\left[ m_{\\mathrm{sat}} / \\left( 3 M_{\\mathrm{enc}}(r) \\right) \\right]^{1/3}$, yielding $r_t(t_0) \\approx 9.6 \\, \\mathrm{kpc}$ and $r_t(t_0 + 2 \\, \\mathrm{Gyr}) \\approx 8.0 \\, \\mathrm{kpc}$, both exceeding $\\kappa r_\\star = 4 \\, \\mathrm{kpc}$, so the orphan survives at both epochs.**\n- The position decay model is consistent with the Chandrasekhar prescription for an SIS.\n- The calculated radius $r(2\\,\\mathrm{Gyr}) \\approx 37 \\, \\mathrm{kpc}$ matches our derivation ($37.1 \\, \\mathrm{kpc}$).\n- The calculated merging time $t_{\\mathrm{merge}} \\approx 4.4 \\, \\mathrm{Gyr}$ matches our derivation ($4.44 \\, \\mathrm{Gyr}$).\n- The tidal radius calculation is self-consistent with the formula provided in the option. The values $r_t(t_0) \\approx 9.6 \\, \\mathrm{kpc}$ and $r_t(t_0+2\\,\\mathrm{Gyr}) \\approx 8.0 \\, \\mathrm{kpc}$ match our calculations ($9.64 \\, \\mathrm{kpc}$ and $7.88 \\, \\mathrm{kpc}$, respectively).\n- The survival conclusion is correct based on these values and the given criterion ($\\kappa r_\\star = 4 \\, \\mathrm{kpc}$).\n**Verdict: Correct.**\n\n**C. Position decays exponentially, $r(t) = r_0 \\exp\\!\\left( - t / t_0 \\right)$ with a constant timescale $t_0$ chosen to match the host dynamical time, yielding $r(2 \\, \\mathrm{Gyr}) \\approx 41 \\, \\mathrm{kpc}$ and $t_{\\mathrm{merge}} \\approx 11 \\, \\mathrm{Gyr}$; survival is determined by comparing $r_t$ to $r_\\star$ (without the factor $\\kappa$), giving $r_t(t_0) \\approx 5 \\, \\mathrm{kpc}$ and $r_t(t_0 + 2 \\, \\mathrm{Gyr}) \\approx 4 \\, \\mathrm{kpc}$, interpreted as disruption at both epochs.**\n- The exponential decay model is physically incorrect for dynamical friction in an SIS; the correct form is $r \\propto (t_{\\mathrm{merge}}-t)^{1/2}$.\n- Using the wrong disruption criterion (omitting $\\kappa=2$) violates the problem statement.\n- The numbers are internally inconsistent. An exponential decay with a timescale matching the host dynamical time ($\\approx 0.25 \\, \\mathrm{Gyr}$) would cause the satellite to merge almost instantly, not be at $41 \\, \\mathrm{kpc}$ after $2 \\, \\mathrm{Gyr}$.\n**Verdict: Incorrect.**\n\n**D. Position decays linearly, $r(t) = r_0 - \\alpha t$ with a constant $\\alpha$ chosen such that $t_{\\mathrm{merge}} \\propto r_0$ and numerically $t_{\\mathrm{merge}} \\approx 1.1 \\, \\mathrm{Gyr}$; the radius after $2 \\, \\mathrm{Gyr}$ is $r(2 \\, \\mathrm{Gyr}) \\approx 31 \\, \\mathrm{kpc}$; survival is assessed using $r_t(r) = r \\left[ m_{\\mathrm{sat}} / M_{\\mathrm{enc}}(r) \\right]^{1/3}$ (omitting the factor of $3$), yielding survival at $t_0$ and at $t_0 + 2 \\, \\mathrm{Gyr}$.**\n- The linear decay model is physically incorrect.\n- The scaling $t_{\\mathrm{merge}} \\propto r_0$ is incorrect for an SIS, for which $t_{\\mathrm{merge}} \\propto r_0^2$.\n- The numerical value $t_{\\mathrm{merge}} \\approx 1.1 \\, \\mathrm{Gyr}$ is incorrect.\n- A linear decay with $t_{\\mathrm{merge}} = 1.1 \\, \\mathrm{Gyr}$ would imply $r(2 \\, \\mathrm{Gyr}) < 0$, contradicting the stated $31 \\, \\mathrm{kpc}$. The option is numerically inconsistent.\n- The formula for tidal radius is a non-standard variant.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}