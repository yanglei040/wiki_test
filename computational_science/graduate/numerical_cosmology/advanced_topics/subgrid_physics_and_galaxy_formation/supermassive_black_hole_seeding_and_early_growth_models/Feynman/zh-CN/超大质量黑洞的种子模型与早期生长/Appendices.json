{
    "hands_on_practices": [
        {
            "introduction": "“直接坍縮”模型是解释超大质量黑洞种子起源的主流理论之一，但它要求气体几乎不含金属。这项练习  将让你通过一个简化计算，来量化评估早期宇宙中金属污染的强大影响。你将探索仅一颗超新星爆发就足以使气体金属丰度超过“临界阈值”，从而揭示直接坍缩黑洞（DCBH）形成条件的严苛性。",
            "id": "3492861",
            "problem": "考虑一个高红移原子冷却暗物质晕，其总质量为 $M_{\\mathrm{h}} = 10^{7}\\,\\mathrm{M}_{\\odot}$，宇宙重子分数为 $f_{\\mathrm{b}} = 0.16$。一颗(电子)对不稳定超新星 (PISN) 使该晕富集了总质量为 $M_{Z} = 50\\,\\mathrm{M}_{\\odot}$ 的重元素（金属）。假设抛射物瞬时、空间均匀地混合到晕的全部重子物质中，并忽略晕的任何质量损失。使用质量金属丰度的定义，即金属质量分数 $Z \\equiv M_{Z}/M_{\\mathrm{gas}}$，其中 $M_{\\mathrm{gas}} = f_{\\mathrm{b}} M_{\\mathrm{h}}$ 是气体质量。\n\n采用太阳金属质量分数为 $Z_{\\odot} = 0.0134$，并将平均金属丰度以太阳单位表示为 $\\tilde{Z} \\equiv Z/Z_{\\odot}$。为了评估对直接坍缩黑洞 (DCBH) 形成的抑制作用，采用临界金属丰度阈值 $Z_{\\mathrm{crit}} = 10^{-4} Z_{\\odot}$。定义一个指示符 $I$，使得当 $\\tilde{Z} \\geq 10^{-4}$ 时（即 DCBH 的形成因富集超过阈值而被阻止），$I = 1$；否则 $I = 0$。\n\n计算 $\\tilde{Z}$ 和 $I$。将你的最终答案以行矩阵 $\\begin{pmatrix} \\tilde{Z} & I \\end{pmatrix}$ 的形式报告，将 $\\tilde{Z}$ 四舍五入到三位有效数字。最终答案中不需要单位。",
            "solution": "该问题被认为是有效的，因为它科学上基于宇宙学结构形成和化学富集的原理，是良定的，提供了所有必要信息，并且客观表达且无歧义。因此，我们可以继续进行求解。\n\n目标是计算暗物质晕以太阳单位表示的平均金属丰度 $\\tilde{Z}$，以及基于一个临界金属丰度阈值的指示变量 $I$。\n\n该问题提供了以下量：\n- 暗物质晕的总质量：$M_{\\mathrm{h}} = 10^{7}\\,\\mathrm{M}_{\\odot}$\n- 宇宙重子分数：$f_{\\mathrm{b}} = 0.16$\n- 超新星抛射的重元素（金属）的总质量：$M_{Z} = 50\\,\\mathrm{M}_{\\odot}$\n- 太阳金属质量分数：$Z_{\\odot} = 0.0134$\n- 以太阳单位表示的临界金属丰度阈值：$Z_{\\mathrm{crit}} = 10^{-4}\\,Z_{\\odot}$，这对应于 $\\tilde{Z}$ 的阈值为 $10^{-4}$。\n\n该问题定义了几个关键关系：\n- 晕中的总气体质量由 $M_{\\mathrm{gas}} = f_{\\mathrm{b}} M_{\\mathrm{h}}$ 给出。\n- 质量金属丰度定义为 $Z \\equiv M_{Z}/M_{\\mathrm{gas}}$。\n- 以太阳单位表示的金属丰度定义为 $\\tilde{Z} \\equiv Z/Z_{\\odot}$。\n- 指示符 $I$ 定义为当 $\\tilde{Z} \\geq 10^{-4}$ 时 $I = 1$，否则 $I = 0$。\n\n假设是超新星抛射物瞬时均匀地混合到晕的全部重子物质中，并且晕没有质量损失。\n\n首先，我们计算晕内气体（重子物质）的总质量。\n$$\nM_{\\mathrm{gas}} = f_{\\mathrm{b}} M_{\\mathrm{h}}\n$$\n代入给定值：\n$$\nM_{\\mathrm{gas}} = 0.16 \\times 10^{7}\\,\\mathrm{M}_{\\odot} = 1.6 \\times 10^{6}\\,\\mathrm{M}_{\\odot}\n$$\n\n接下来，我们计算富集后该气体的平均金属丰度 $Z$。这是金属质量 $M_{Z}$ 与总气体质量 $M_{\\mathrm{gas}}$ 的比值。\n$$\nZ = \\frac{M_{Z}}{M_{\\mathrm{gas}}}\n$$\n代入 $M_{Z}$ 的值和计算出的 $M_{\\mathrm{gas}}$ 的值：\n$$\nZ = \\frac{50\\,\\mathrm{M}_{\\odot}}{1.6 \\times 10^{6}\\,\\mathrm{M}_{\\odot}} = \\frac{50}{1.6} \\times 10^{-6} = 31.25 \\times 10^{-6} = 3.125 \\times 10^{-5}\n$$\n这是晕的气体中金属的 absolute 质量分数。\n\n现在，我们通过将 $Z$ 除以太阳金属丰度 $Z_{\\odot}$，将此金属丰度以太阳单位 $\\tilde{Z}$ 表示。\n$$\n\\tilde{Z} = \\frac{Z}{Z_{\\odot}}\n$$\n代入 $Z$ 和 $Z_{\\odot}$ 的值：\n$$\n\\tilde{Z} = \\frac{3.125 \\times 10^{-5}}{0.0134} = \\frac{3.125 \\times 10^{-5}}{1.34 \\times 10^{-2}} \\approx 2.332089... \\times 10^{-3}\n$$\n问题要求将 $\\tilde{Z}$ 四舍五入到三位有效数字。\n$$\n\\tilde{Z} \\approx 2.33 \\times 10^{-3}\n$$\n\n最后，我们确定指示符 $I$ 的值。条件是当 $\\tilde{Z} \\geq 10^{-4}$ 时 $I = 1$，否则 $I = 0$。我们必须将我们计算出的 $\\tilde{Z}$ 值与 $10^{-4}$ 的阈值进行比较。\n我们的值是 $\\tilde{Z} \\approx 2.33 \\times 10^{-3}$。\n阈值是 $10^{-4} = 0.1 \\times 10^{-3}$。\n比较如下：\n$$\n2.33 \\times 10^{-3} \\geq 0.1 \\times 10^{-3}\n$$\n这个不等式成立。因此，晕的平均金属丰度超过了抑制直接坍缩黑洞 (DCBH) 形成的临界阈值。根据所提供的定义，指示符 $I$ 必须等于 $1$。\n$$\nI = 1\n$$\n\n所要求的最终答案是一个行矩阵，包含计算出的 $\\tilde{Z}$（四舍五入到三位有效数字）和 $I$ 的值。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.33 \\times 10^{-3} & 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "黑洞种子一旦形成，其增长便受到自身辐射的强烈制约，这是一个关键的负反馈过程。本练习  聚焦于吸积物理的核心，即辐射反馈如何抑制邦迪（Bondi）吸积。通过推导吸积率与气体声速的关系，你将定量地理解为何吸积流的加热效应是数值模拟中必须精确建模的关键物理机制。",
            "id": "3492748",
            "problem": "考虑一个超大质量黑洞（SMBH）前身天体周围的一个孤立种子，它正在经历从一个质量密度为 $\\rho_{\\infty}$ 且在无穷远处整体速度可忽略不计的均匀周围介质，到一个点质量 $M$ 的稳态、球对称、非相对论性流入。假设气体可以很好地用等温状态方程 $p=\\rho c_{s}^{2}$ 来描述，其中声速 $c_{s}$ 等于其在无穷远处的渐近值。在没有反馈的情况下，周围气体的温度大约处于原子冷却温度，声速为 $c_{s,0}=10\\,\\mathrm{km}\\,\\mathrm{s}^{-1}$。新生的吸积流产生的光致电离加热使气体温度升高到 $T \\sim 10^{5}\\,\\mathrm{K}$，从而将渐近声速增加到 $c_{s,1}=50\\,\\mathrm{km}\\,\\mathrm{s}^{-1}$。在整个过渡过程中，假设黑洞质量和周围密度保持不变，即 $M=\\mathrm{const}$ 和 $\\rho_{\\infty}=\\mathrm{const}$。\n\n从稳态球形连续性方程和径向欧拉方程出发，并如上所述假设一个等温闭合关系，推导在固定绝热行为（有效等温指数 $\\gamma=1$）下，跨声速吸积率如何依赖于问题的参数。利用这种依赖关系，计算无量纲抑制因子\n$$\nS \\equiv \\frac{\\dot{M}_{1}}{\\dot{M}_{0}},\n$$\n其中 $\\dot{M}_{0}$ 是加热前（声速为 $c_{s,0}$）的稳态跨声速吸积率，而 $\\dot{M}_{1}$ 是光致电离加热后（声速为 $c_{s,1}$）的稳态跨声速吸积率，两者都在相同的 $\\rho_{\\infty}$ 和 $M$ 下计算。\n\n将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算当周围气体的温度因光致电离加热而升高时，对超大质量黑洞（SMBH）前身天体的稳态跨声速吸积率的抑制因子。问题的核心在于推导对于等温状态方程，邦迪吸积率对气体声速的依赖关系。\n\n我们从引力势 $\\Phi(r) = -GM/r$ 中稳态、球对称、非相对论性流体流动的基本方程开始。设 $\\rho$ 为流体的质量密度，$v$ 为径向流入速度的大小。\n\n连续性方程为：\n$$\n\\frac{1}{r^2}\\frac{d}{dr}(r^2 \\rho v) = 0\n$$\n这意味着质量吸积率 $\\dot{M}$ 不随半径变化，是一个常数：\n$$\n\\dot{M} = 4\\pi r^2 \\rho v = \\text{const}\n$$\n\n动量守恒的径向欧拉方程为：\n$$\nv\\frac{dv}{dr} = -\\frac{1}{\\rho}\\frac{dp}{dr} - \\frac{GM}{r^2}\n$$\n问题指定了等温状态方程：\n$$\np = \\rho c_s^2\n$$\n其中声速 $c_s$ 在整个流场中为常数，等于其在无穷远处的值。因此，压力梯度为 $\\frac{dp}{dr} = c_s^2 \\frac{d\\rho}{dr}$。\n\n将压力梯度代入欧拉方程，得到：\n$$\nv\\frac{dv}{dr} = -\\frac{c_s^2}{\\rho}\\frac{d\\rho}{dr} - \\frac{GM}{r^2}\n$$\n为了消去密度导数，我们使用连续性方程。对 $\\dot{M} = 4\\pi r^2 \\rho v$ 取对数，然后对 $r$ 求导，得到：\n$$\n\\frac{d}{dr}(\\ln\\rho + \\ln v + 2\\ln r) = 0 \\implies \\frac{1}{\\rho}\\frac{d\\rho}{dr} + \\frac{1}{v}\\frac{dv}{dr} + \\frac{2}{r} = 0\n$$\n$$\n\\frac{1}{\\rho}\\frac{d\\rho}{dr} = -\\left(\\frac{1}{v}\\frac{dv}{dr} + \\frac{2}{r}\\right)\n$$\n将此密度梯度项的表达式代入欧拉方程：\n$$\nv\\frac{dv}{dr} = -c_s^2 \\left(-\\frac{1}{v}\\frac{dv}{dr} - \\frac{2}{r}\\right) - \\frac{GM}{r^2}\n$$\n$$\nv\\frac{dv}{dr} = \\frac{c_s^2}{v}\\frac{dv}{dr} + \\frac{2c_s^2}{r} - \\frac{GM}{r^2}\n$$\n重新整理各项以解出 $\\frac{dv}{dr}$：\n$$\n\\left(v - \\frac{c_s^2}{v}\\right)\\frac{dv}{dr} = \\frac{2c_s^2}{r} - \\frac{GM}{r^2}\n$$\n$$\n\\frac{dv}{dr} = \\frac{v}{r} \\frac{2c_s^2 - GM/r}{v^2 - c_s^2}\n$$\n这就是等温球状吸积的“风方程”。\n\n对于一个物理上有效的跨声速解，吸积流必须在大半径处（$r \\to \\infty$）是亚声速的（$v  c_s$），并加速到在小半径处变为超声速（$v > c_s$）。因此，流必须平滑地通过一个临界点，即声速点 $r_s$，在该点速度等于声速，$v(r_s) = c_s$。此时，$\\frac{dv}{dr}$ 表达式的分母变为零。为了避免出现奇点（即无穷大的速度梯度），分子在同一半径处也必须为零。\n\n因此，在声速点 $r=r_s$ 处：\n1. $v(r_s) = c_s$\n2. $2c_s^2 - \\frac{GM}{r_s} = 0$\n\n从第二个条件，我们求出声速半径，通常称为邦迪半径：\n$$\nr_s = \\frac{GM}{2c_s^2}\n$$\n质量吸积率 $\\dot{M}$ 对所有 $r$ 都是常数，因此我们可以在声速半径 $r_s$ 处计算其值：\n$$\n\\dot{M} = 4\\pi r_s^2 \\rho_s v_s\n$$\n其中 $\\rho_s = \\rho(r_s)$ 且 $v_s = v(r_s) = c_s$。\n为了求出 $\\rho_s$，我们对欧拉方程积分以获得伯努利积分。\n$$\n\\int v dv + c_s^2 \\int \\frac{d\\rho}{\\rho} + GM \\int \\frac{dr}{r^2} = \\text{const}\n$$\n$$\n\\frac{1}{2}v^2 + c_s^2 \\ln\\rho - \\frac{GM}{r} = \\text{const}\n$$\n我们使用无穷远处（$r \\to \\infty$）的边界条件来计算常数，此处 $v \\to 0$ 且 $\\rho \\to \\rho_{\\infty}$。\n$$\n\\text{const} = \\frac{1}{2}(0)^2 + c_s^2 \\ln\\rho_{\\infty} - \\frac{GM}{\\infty} = c_s^2 \\ln\\rho_{\\infty}\n$$\n所以，伯努利方程是：\n$$\n\\frac{1}{2}v^2 + c_s^2 \\ln\\left(\\frac{\\rho}{\\rho_{\\infty}}\\right) - \\frac{GM}{r} = 0\n$$\n现在我们在声速点（$r=r_s$, $v=c_s$）计算此方程：\n$$\n\\frac{1}{2}c_s^2 + c_s^2 \\ln\\left(\\frac{\\rho_s}{\\rho_{\\infty}}\\right) - \\frac{GM}{r_s} = 0\n$$\n代入 $r_s = GM/(2c_s^2)$，这意味着 $GM/r_s = 2c_s^2$：\n$$\n\\frac{1}{2}c_s^2 + c_s^2 \\ln\\left(\\frac{\\rho_s}{\\rho_{\\infty}}\\right) - 2c_s^2 = 0\n$$\n$$\nc_s^2 \\ln\\left(\\frac{\\rho_s}{\\rho_{\\infty}}\\right) = \\frac{3}{2}c_s^2 \\implies \\ln\\left(\\frac{\\rho_s}{\\rho_{\\infty}}\\right) = \\frac{3}{2} \\implies \\rho_s = \\rho_{\\infty} \\exp\\left(\\frac{3}{2}\\right)\n$$\n现在我们组装吸积率 $\\dot{M}$ 的表达式：\n$$\n\\dot{M} = 4\\pi r_s^2 \\rho_s c_s = 4\\pi \\left(\\frac{GM}{2c_s^2}\\right)^2 \\left(\\rho_{\\infty} \\exp\\left(\\frac{3}{2}\\right)\\right) c_s\n$$\n$$\n\\dot{M} = 4\\pi \\frac{G^2 M^2}{4c_s^4} \\rho_{\\infty} \\exp\\left(\\frac{3}{2}\\right) c_s = \\pi \\exp\\left(\\frac{3}{2}\\right) \\frac{G^2 M^2 \\rho_{\\infty}}{c_s^3}\n$$\n这个表达式显示了跨声速等温吸积率对参数 $M$、$\\rho_{\\infty}$ 和 $c_s$ 的依赖关系。我们可以将其写为 $\\dot{M} = C \\cdot \\frac{M^2 \\rho_{\\infty}}{c_s^3}$，其中 $C = \\pi e^{3/2} G^2$ 是一个常数。\n\n问题要求我们计算抑制因子 $S \\equiv \\dot{M}_1 / \\dot{M}_0$。质量 $M$ 和周围密度 $\\rho_{\\infty}$ 保持不变。\n$\\dot{M}_0$ 是声速为 $c_{s,0}$ 时的吸积率。\n$\\dot{M}_1$ 是声速为 $c_{s,1}$ 时的吸积率。\n$$\n\\dot{M}_0 \\propto \\frac{1}{c_{s,0}^3} \\quad \\text{and} \\quad \\dot{M}_1 \\propto \\frac{1}{c_{s,1}^3}\n$$\n无量纲抑制因子是这两个速率的比值：\n$$\nS = \\frac{\\dot{M}_1}{\\dot{M}_0} = \\frac{C \\cdot M^2 \\rho_{\\infty}/c_{s,1}^3}{C \\cdot M^2 \\rho_{\\infty}/c_{s,0}^3} = \\frac{c_{s,0}^3}{c_{s,1}^3} = \\left(\\frac{c_{s,0}}{c_{s,1}}\\right)^3\n$$\n给定值为：\n$c_{s,0} = 10\\,\\mathrm{km}\\,\\mathrm{s}^{-1}$\n$c_{s,1} = 50\\,\\mathrm{km}\\,\\mathrm{s}^{-1}$\n\n将这些值代入 $S$ 的表达式中：\n$$\nS = \\left(\\frac{10\\,\\mathrm{km}\\,\\mathrm{s}^{-1}}{50\\,\\mathrm{km}\\,\\mathrm{s}^{-1}}\\right)^3 = \\left(\\frac{1}{5}\\right)^3 = \\frac{1}{125}\n$$\n将其表示为小数并四舍五入到四位有效数字：\n$$\nS = \\frac{1}{125} = 0.008\n$$\n将 $0.008$ 写成四位有效数字得到 $0.008000$。",
            "answer": "$$\\boxed{0.008000}$$"
        },
        {
            "introduction": "将物理理论转化为可靠的模拟结果，其间的桥梁是严格的数值验证。这项综合练习  要求你从理论转向实践，为黑洞吸积与反馈的子网格模型设计一套验证标准。你将学习如何利用已知的解析解来检验代码的准确性，这是确保数值宇宙学研究可信度的基石。",
            "id": "3492802",
            "problem": "一个计算天体物理学小组正在验证用于均匀介质中超大质量黑洞（SMBH）吸积和反馈的亚网格模块。流体动力学求解器是一种有限体积Godunov格式，在光滑区域形式上是二阶的，但在穿过激波时会退化为一阶。黑洞引力通过一个静态、软化的点质量势来施加，软化长度等于一个网格单元，使用一阶算子分裂源项更新。光致电离化学和加热通过一种算子分裂、光子守恒的方法进行更新，其中电离分数采用一阶隐式更新。时间步进遵循流体动力学中的Courant–Friedrichs–Lewy条件，化学部分则进行子循环以解析电离时间尺度。\n\n该团队希望设计一个验证套件，用于将数值结果与三个与SMBH吸积和反馈相关的典型问题的解析自相似解或平衡解进行定量比较：点质量上的稳态球对称入流、稳定源周围经典电离区的增长以及能量驱动的冲击波。该套件必须在给定数值方法的条件下是现实的，并应指定误差度量、评估时间以及依赖于分辨率的容差，这些容差应由预期的精度阶数和底层解析解的结构来证明其合理性。\n\n考虑以下常见的设置选项，您可以在您提出的套件中根据需要使用：一个边长为 $L = 512\\,\\mathrm{pc}$ 的立方体区域，带有流出边界；均匀的纯氢气体，数密度为 $n_{\\mathrm{H}} = 1\\,\\mathrm{cm}^{-3}$，温度为 $T = 10^{4}\\,\\mathrm{K}$；一个固定质量为 $M_{\\bullet} = 10^{6}\\,M_{\\odot}$ 的黑洞；一个单色电离光子发射率 $\\dot{N}_{\\gamma} = 5 \\times 10^{49}\\,\\mathrm{s}^{-1}$；B情况复合系数 $\\alpha_{B} = 2.6 \\times 10^{-13}\\,\\mathrm{cm}^{3}\\,\\mathrm{s}^{-1}$；以及在区域中心点状注入的热能 $E_{0} = 10^{51}\\,\\mathrm{erg}$。采用三种均匀网格分辨率，网格单元尺寸为 $\\Delta x \\in \\{4\\,\\mathrm{pc}, 2\\,\\mathrm{pc}, 1\\,\\mathrm{pc}\\}$。根据给定的 $T$ 使用理想气体关系定义环境气体的声速 $c_{s}$，Bondi半径定义为 $r_{B} = G M_{\\bullet}/c_{s}^{2}$，Bondi时间定义为 $t_{B} = r_{B}/c_{s}$，B情况复合时间定义为 $t_{\\mathrm{rec}} = 1/(\\alpha_{B} n_{\\mathrm{H}})$。\n\n下面哪个选项提供了一个科学上合理且自洽的验证套件，包括测试定义以及与相关解析解相比较的定量误差容差，并且该套件适用于所述的数值方法和分辨率？\n\nA. \n- 稳态入流（类Bondi流）：初始化一个均匀介质和一个固定的中心势，演化到 $t = 5\\,t_{B}$，并将穿过半径为 $r = 2\\,\\Delta x$ 球面的球平均质量吸积率 $\\dot{M}$ 与解析的稳态球对称入流率进行比较。使用 $\\dot{M}$ 的 $L_{1}$ 相对误差，并要求在 $\\Delta x = 4\\,\\mathrm{pc}$ 时容差 $\\le 0.20$，在 $\\Delta x = 2\\,\\mathrm{pc}$ 时容差 $\\le 0.10$，在 $\\Delta x = 1\\,\\mathrm{pc}$ 时容差 $\\le 0.05$，要求单调收敛且观测到的收敛阶数在 $[1, 2]$ 范围内。\n- 电离区增长（经典电离前沿）：在中心放置一个稳定的电离源，至少演化到 $t = 5\\,t_{\\mathrm{rec}}$，并将球平均的电离前沿半径 $R(t)$ 在 $t/t_{\\mathrm{rec}} \\in \\{0.1, 1, 5\\}$ 时与静态介质的解析光子平衡解进行比较。使用 $R(t)$ 的相对误差，并要求在每个时间点，在 $\\Delta x = 4\\,\\mathrm{pc}$ 时容差 $\\le 0.12$，在 $\\Delta x = 2\\,\\mathrm{pc}$ 时容差 $\\le 0.06$，在 $\\Delta x = 1\\,\\mathrm{pc}$ 时容差 $\\le 0.03$，并且到 $t = 5\\,t_{\\mathrm{rec}}$ 时全局光子数不守恒的分数小于 $0.01$。\n- 能量驱动的冲击波（Sedov–Taylor）：瞬时注入 $E_{0}$，演化到 $t \\in \\{0.05\\,\\mathrm{Myr}, 0.10\\,\\mathrm{Myr}\\}$，并将球平均的激波半径 $R(t)$ 与自相似律进行比较。要求 $R(t)$ 的相对误差在 $\\Delta x = 4\\,\\mathrm{pc}$ 时 $\\le 0.08$，在 $\\Delta x = 2\\,\\mathrm{pc}$ 时 $\\le 0.04$，在 $\\Delta x = 1\\,\\mathrm{pc}$ 时 $\\le 0.02$，并且激波后密度剖面的 $L_{1}$ 误差分别 $\\le 0.20$、$\\le 0.12$ 和 $\\le 0.08$。对于激波敏感的度量，接受一阶收敛。\n  \nB.\n- 稳态入流：与A中相同，但要求在所有三种分辨率下，整个径向密度剖面的 $L_{2}$ 相对误差 $\\le 0.01$，并证明尽管存在软化的点质量势，$\\dot{M}$ 相对于 $\\Delta x$ 仍具有二阶收敛性（斜率 $\\approx 2$）。\n- 电离区：仅在 $t = t_{\\mathrm{rec}}$ 时测量电离前沿半径，并要求在所有分辨率下绝对误差 $\\le 0.01\\,\\mathrm{pc}$；证明 $R(t)$ 的二阶收敛性，并且在没有化学更新子循环的情况下，全局光子数守恒优于 $ 10^{-4}$。\n- 能量驱动的冲击波：要求在所有分辨率下激波半径误差 $\\le 0.005$，并且激波位置和激波后密度峰值都具有二阶收敛性。\n\nC.\n- 稳态入流：选择 $T$ 使得在所有分辨率下都有 $r_{B} \\ll \\Delta x$，演化到 $t = t_{B}$，并将 $\\dot{M}$ 与解析入流率进行比较。要求在所有分辨率下 $\\dot{M}$ 的 $L_{\\infty}$ 相对误差 $\\le 0.05$；接受非单调收敛，因为Bondi半径未被解析。\n- 电离区：使用周期性边界条件，并在 $t = 10\\,t_{\\mathrm{rec}}$ 时测量体积平均的电离分数，目标是不论分辨率如何，符合度在 $1\\%$ 以内；不比较半径。\n- 能量驱动的冲击波：将激波内的热能与解析的总能量进行比较，并要求在所有分辨率下相对误差 $\\le 0.01$，对激波位置没有明确约束。\n\nD.\n- 稳态入流：在 $r = \\Delta x$ 处测量 $\\dot{M}$，并要求在 $t = 2\\,t_{B}$ 时，与解析入流率的符合度在所有三种分辨率下都在 $1\\%$ 以内；强制 $\\dot{M}$ 相对于 $\\Delta x$ 具有二阶收敛性。\n- 电离区：使用一个大的流体动力学时间步 $\\Delta t \\approx t_{\\mathrm{rec}}$ 进行演化，不进行化学子循环，并要求在 $t = 0.1\\,t_{\\mathrm{rec}}$ 和 $t = t_{\\mathrm{rec}}$ 时的 $R(t)$ 与静态介质解析解的符合度在所有分辨率下都在 $2\\%$ 以内；允许使用反射边界。\n- 能量驱动的冲击波：对激波位置使用 $L_{2}$ 范数，并要求在三种分辨率下的收敛阶数在 $1.8$ 和 $2.2$ 之间，且在 $\\Delta x = 4\\,\\mathrm{pc}$ 时绝对激波半径误差 $\\le 0.5\\,\\mathrm{pc}$。\n\n只选择一个选项。",
            "solution": "任务是评估为计算天体物理学代码提出的四个验证套件（选项A、B、C、D）。评估必须基于科学合理性、自洽性以及对所描述的数值方法和物理参数的适用性。\n\n首先，我们来验证问题陈述，并根据提供的数据计算关键的物理尺度。\n\n**问题验证和尺度计算**\n\n问题陈述描述了数值天体物理学模拟的标准设置。所用的数值方法——用于流体动力学的二阶Godunov格式（在激波处降为一阶）、用于引力和化学的一阶算子分裂更新以及软化的引力势——在领域内都很常见。三个验证问题（类Bondi入流、I-front膨胀、Sedov-Taylor冲击波）是典型的测试。所提供的物理参数是现实的。该问题具有科学依据、适定且客观。这是一个有效的问题。\n\n我们现在计算相关的物理尺度：\n\n1.  **环境介质声速 ($c_s$)**: 气体是温度为 $T = 10^4\\,\\mathrm{K}$ 的纯氢。在此温度下，氢几乎完全电离。压力为 $P = n_{\\text{tot}} k_B T = (n_p + n_e) k_B T \\approx 2n_{\\mathrm{H}} k_B T$。质量密度为 $\\rho = n_{\\mathrm{H}} m_p$。绝热声速的平方为 $c_s^2 = \\gamma P / \\rho = \\gamma (2 n_{\\mathrm{H}} k_B T) / (n_{\\mathrm{H}} m_p) = 2 \\gamma k_B T / m_p$。对于单原子气体，$\\gamma = 5/3$。\n    $c_s = \\sqrt{\\frac{2 \\gamma k_B T}{m_p}} = \\sqrt{\\frac{2 \\cdot (5/3) \\cdot (1.38 \\times 10^{-16}\\,\\mathrm{erg\\,K^{-1}}) \\cdot (10^4\\,\\mathrm{K})}{1.67 \\times 10^{-24}\\,\\mathrm{g}}} \\approx 1.65 \\times 10^6\\,\\mathrm{cm\\,s^{-1}} \\approx 16.5\\,\\mathrm{km\\,s^{-1}}$。\n\n2.  **Bondi半径 ($r_B$) 和时间 ($t_B$)**:\n    $r_B = \\frac{G M_{\\bullet}}{c_s^2} = \\frac{(6.674 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}})(10^6 \\times 1.989 \\times 10^{33}\\,\\mathrm{g})}{(1.65 \\times 10^6\\,\\mathrm{cm\\,s^{-1}})^2} \\approx 4.88 \\times 10^{19}\\,\\mathrm{cm}$。\n    换算成秒差距（parsec）（$1\\,\\mathrm{pc} \\approx 3.086 \\times 10^{18}\\,\\mathrm{cm}$）：\n    $r_B \\approx \\frac{4.88 \\times 10^{19}\\,\\mathrm{cm}}{3.086 \\times 10^{18}\\,\\mathrm{cm/pc}} \\approx 15.8\\,\\mathrm{pc}$。\n    所有网格分辨率（$\\Delta x = \\{4, 2, 1\\}\\,\\mathrm{pc}$）都能解析Bondi半径。\n    $t_B = \\frac{r_B}{c_s} = \\frac{4.88 \\times 10^{19}\\,\\mathrm{cm}}{1.65 \\times 10^6\\,\\mathrm{cm\\,s^{-1}}} \\approx 2.96 \\times 10^{13}\\,\\mathrm{s} \\approx 0.94\\,\\mathrm{Myr}$。\n\n3.  **复合时间 ($t_{\\mathrm{rec}}$) 和 Strömgren 半径 ($R_S$)**:\n    $t_{\\mathrm{rec}} = \\frac{1}{\\alpha_B n_{\\mathrm{H}}} = \\frac{1}{(2.6 \\times 10^{-13}\\,\\mathrm{cm^3\\,s^{-1}})(1\\,\\mathrm{cm^{-3}})} \\approx 3.85 \\times 10^{12}\\,\\mathrm{s} \\approx 0.12\\,\\mathrm{Myr}$。\n    平衡Strömgren半径 $R_S$ 由电离和复合之间的平衡给出：$\\dot{N}_{\\gamma} = \\frac{4\\pi}{3} R_S^3 n_{\\mathrm{H}}^2 \\alpha_B$。\n    $R_S = \\left(\\frac{3 \\dot{N}_{\\gamma}}{4 \\pi n_{\\mathrm{H}}^2 \\alpha_B}\\right)^{1/3} = \\left(\\frac{3 \\cdot (5 \\times 10^{49}\\,\\mathrm{s^{-1}})}{4 \\pi \\cdot (1\\,\\mathrm{cm^{-3}})^2 \\cdot (2.6 \\times 10^{-13}\\,\\mathrm{cm^3\\,s^{-1}})}\\right)^{1/3} \\approx (4.59 \\times 10^{62}\\,\\mathrm{cm^3})^{1/3} \\approx 1.66 \\times 10^{21}\\,\\mathrm{cm}$。\n    $R_S \\approx \\frac{1.66 \\times 10^{21}\\,\\mathrm{cm}}{3.086 \\times 10^{18}\\,\\mathrm{cm/pc}} \\approx 538\\,\\mathrm{pc}$。\n    计算区域的半边长为 $L/2 = 256\\,\\mathrm{pc}$。因此，$R_S > L/2$，这意味着电离区在达到其平衡半径之前就会突破计算区域的边界。\n\n4.  **Sedov-Taylor冲击波半径 ($R(t)$)**: 自相似解为 $R(t) = \\xi_0 (E_0 t^2 / \\rho_0)^{1/5}$。对于 $\\gamma=5/3$，常数 $\\xi_0 \\approx 1.12$。环境密度为 $\\rho_0 = n_{\\mathrm{H}} m_p = 1.67 \\times 10^{-24}\\,\\mathrm{g\\,cm^{-3}}$。\n    在 $t = 0.1\\,\\mathrm{Myr} \\approx 3.15 \\times 10^{12}\\,\\mathrm{s}$:\n    $R(0.1\\,\\mathrm{Myr}) = 1.12 \\left(\\frac{(10^{51}\\,\\mathrm{erg}) (3.15 \\times 10^{12}\\,\\mathrm{s})^2}{1.67 \\times 10^{-24}\\,\\mathrm{g\\,cm^{-3}}}\\right)^{1/5} \\approx 1.12 \\cdot (5.93 \\times 10^{99})^{1/5} \\,\\mathrm{cm} \\approx 4.6 \\times 10^{19}\\,\\mathrm{cm} \\approx 14.9\\,\\mathrm{pc}$。\n    这个半径可以被所有网格分辨率很好地解析。\n\n有了这些尺度，我们现在可以分析每个选项。\n\n**逐项分析**\n\n**A. 评估**\n- **稳态入流**: 该测试建议演化到 $t = 5\\,t_{B} \\approx 4.7\\,\\mathrm{Myr}$，这足以接近稳态。吸积率 $\\dot{M}$ 在 $r=2\\Delta x$ 处测量，该位置恰好在软化引力区域 ($r\\Delta x$) 之外。$L_1$ 误差度量是标准的。关键在于容差和收敛性。对于分辨率 $\\{\\Delta x, \\Delta x/2, \\Delta x/4\\}$，容差 $\\{0.20, 0.10, 0.05\\}$ 意味着误差与 $\\Delta x$ 成正比，即一阶收敛。这是一个现实的期望，因为该方法对引力源项使用一阶算子分裂更新，这很可能在这个引力驱动的问题中主导误差。要求观测到的收敛阶数在 $[1, 2]$ 范围内，对于一个真实世界的代码来说，是一个合理的、略带灵活性的目标。这个测试构思得很好。\n- **电离区增长**: 该测试正确地提出将I-front半径 $R(t)$ 与解析解 $R(t) = R_S (1 - e^{-t/t_{\\mathrm{rec}}})^{1/3}$ 进行比较。它在多个时间点进行检查，这是一个好做法。如前计算，I-front在达到 $R_S$ 之前会冲出计算盒子。在 $t=0.1\\,t_{\\mathrm{rec}}$ 时，$R(t) \\approx (1-e^{-0.1})^{1/3} R_S \\approx 0.457 R_S \\approx 246\\,\\mathrm{pc}$。这恰好在 $r=256\\,\\mathrm{pc}$ 的边界之内，所以这个检查是有效的。在 $t=t_{\\mathrm{rec}}$ 和 $t=5\\,t_{\\mathrm{rec}}$ 时的检查将会与一个因有限盒子尺寸而形式上无效的解析解进行比较。然而，这是验证中常见的问题，而测试早期行为是最关键的部分。误差容差 $\\{0.12, 0.06, 0.03\\}$ 同样对应于一阶收敛。这是预料之中的，因为电离前沿是一个尖锐的不连续面，并且化学求解器是一阶的。光子守恒的要求是必不可少的。尽管存在突破问题，这个测试在很大程度上是合理的。\n- **能量驱动的冲击波**: 该测试在能够很好解析的时间点，将激波半径 $R(t)$ 和激波后密度剖面都与Sedov-Taylor解进行比较。$R(t)$ 的误差容差 $\\{0.08, 0.04, 0.02\\}$ 意味着一阶收敛。这对于一个由Godunov类型格式捕捉的激波是正确的，该格式在不连续处是一阶的。密度剖面的 $L_1$ 误差容差也是合理的，并且显示出近似一阶的缩放关系。对激波敏感的度量明确接受一阶收敛，表明对数值方法的局限性有正确的理解。\n- **结论**: 选项A提供了一个科学上合理、内部自洽且对于指定的数值方法来说是现实的验证套件。它正确地预见了对于由不连续性或一阶源项更新主导的问题，其收敛阶数为一阶，并相应地设定了依赖于分辨率的误差容差。\n\n**正确**\n\n**B. 评估**\n- **稳态入流**: 此选项要求在所有分辨率下，整个密度剖面的 $L_2$ 误差 $\\le 0.01$。一个与分辨率无关的误差与一个收敛的数值方法从根本上是不一致的。此外，它要求 $\\dot{M}$ 具有二阶收敛性，考虑到引力求解器是一阶的，这是不现实的。\n- **电离区**: 此选项要求在所有分辨率下，I-front半径的绝对误差 $\\le 0.01\\,\\mathrm{pc}$。这既与分辨率无关，又小得不可能（它只是最精细网格单元尺寸 $\\Delta x=1\\,\\mathrm{pc}$ 的一小部分）。它还要求二阶收敛，这对于一个使用一阶求解器的尖锐前沿来说是不正确的。最后，它要求在*没有*子循环的情况下达到高精度，这与问题描述和良好的数值实践相矛盾。\n- **能量驱动的冲击波**: 此选项要求激波位置和激波后密度具有二阶收敛性。这是不正确的；激波捕捉在不连续处是一个一阶过程。\n- **结论**: 选项B基于对数值收敛和所描述的特定方法的误解，设定了不可能的标准。它在一阶是理论极限的地方要求二阶精度。\n\n**不正确**\n\n**C. 评估**\n- **稳态入流**: 此选项建议使Bondi半径未被解析 ($r_B \\ll \\Delta x$)。这使得测试的前提无效，因为流动将不再是连续的Bondi流，而是网格分辨率和亚网格模型的产物。将其与解析的Bondi解进行比较是毫无意义的。\n- **电离区**: 此选项建议对中心源使用周期性边界条件。这是不符合物理实际的，会导致光子重新进入计算域，从而将问题从预期的无限介质中的I-front膨胀完全改变。仅在后期测量体积平均的电离分数，无法测试关键的前沿传播动力学。\n- **能量驱动的冲击波**: 此选项建议将气泡内的热能与注入的总能量 $E_0$ 进行比较。这在物理上是不正确的。Sedov-Taylor解将总能量分配给热能和动能部分（对于 $\\gamma=5/3$，比例大约是 $72\\%$ 的热能和 $28\\%$ 的动能）。这个测试基于一个错误的前提。\n- **结论**: 选项C提出的测试设计不佳、物理上不正确，或使其与预期解析解的比较无效。\n\n**不正确**\n\n**D. 评估**\n- **稳态入流**: 此选项建议在软化半径 $r=\\Delta x$ 处测量 $\\dot{M}$。这是数值解受人工引力软化污染最严重的区域；测量应该在更远的地方进行。它还不正确地要求二阶收敛和与分辨率无关的 $1\\%$ 误差。\n- **电离区**: 此选项建议一个数值上不稳定的方案（时间步长 $\\Delta t \\approx t_{\\mathrm{rec}}$ 且没有子循环）。它还允许使用反射边界，这将通过使膨胀的HII区与其自身的反射相撞而破坏解。\n- **能量驱动的冲击波**: 此选项不正确地要求激波位置的收敛阶数在 $1.8$ 和 $2.2$ 之间（二阶），而这在代码中是一个一阶特征。\n- **结论**: 选项D和B一样，基于对数值方法的根本误解，要求不可能的收敛阶数并建议不稳定或不恰当的设置。\n\n**结论**\n\n选项A是唯一一个提出了科学上合理且专业设计的验证套件的选择。它正确地识别了数值格式的预期收敛特性——对于涉及激波、不连续性和一阶源项的给定问题，主要是[收敛阶数为]一阶——并指定了现实的、依赖于分辨率的误差容差。其他选项在数值分析原理、测试设计以及解析解的物理方面都包含多个根本性缺陷。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}