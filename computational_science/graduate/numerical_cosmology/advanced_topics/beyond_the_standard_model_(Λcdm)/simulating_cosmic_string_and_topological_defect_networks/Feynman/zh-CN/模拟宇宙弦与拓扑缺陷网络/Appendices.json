{
    "hands_on_practices": [
        {
            "introduction": "在任何显式时间演化数值模拟中，首要的挑战是确保算法的稳定性。Courant–Friedrichs–Lewy (CFL) 条件为这一挑战提供了理论基础，它将时间步长与空间步长联系起来，以防止非物理的指数增长。通过完成这项练习 ，您将通过第一性原理推导一个三维波动方程离散格式的CFL条件，这是在宇宙学模拟中保证数值解稳定的关键一步。",
            "id": "3487032",
            "problem": "在宇宙弦和拓扑缺陷网络的数值宇宙学模拟中，阿贝尔-希格斯模型使用显式时间积分在三维立方晶格上演化。考虑在自然单位制中线性化场动力学的主要（双曲）部分，其中相对论信号速度等于 $c=1$。在时间规范下，为了分析离散化的传播和稳定性，标量（希格斯）场或空间规范分量的微小涨落均由形式为 $u_{tt} = \\nabla^{2} u$ 的线性波动型方程控制。演化采用时间上的交错蛙跳格式实现：场 $u$ 存储在整数时间层 $t^{n} = n\\,\\Delta t$ 上，其共轭动量（或速度）存储在半整数时间层 $t^{n+1/2} = \\left(n+\\frac{1}{2}\\right)\\Delta t$ 上，空间上则是在所有三个方向间距均为 $\\Delta x$ 的均匀立方晶格上。空间算子由二阶中心有限差分拉普拉斯算子离散化\n$$\n\\nabla^{2}_{d} u_{i,j,k} = \\frac{u_{i+1,j,k} - 2 u_{i,j,k} + u_{i-1,j,k}}{\\Delta x^{2}} + \\frac{u_{i,j+1,k} - 2 u_{i,j,k} + u_{i,j-1,k}}{\\Delta x^{2}} + \\frac{u_{i,j,k+1} - 2 u_{i,j,k} + u_{i,j,k-1}}{\\Delta x^{2}} \\, ,\n$$\n并且时间更新（当仅用 $u$ 表示时）具有标准的二阶中心形式\n$$\nu^{n+1}_{i,j,k} - 2\\,u^{n}_{i,j,k} + u^{n-1}_{i,j,k} = \\Delta t^{2}\\,\\nabla^{2}_{d} u^{n}_{i,j,k} \\, .\n$$\n使用应用于上述三维空间离散格式的冯·诺依曼（傅里叶）稳定性分析，在 $c=1$ 的假设下，推导出 Courant–Friedrichs–Lewy (CFL) 条件，并用比值 $\\sigma \\equiv \\Delta t / \\Delta x$ 表示。取确保所有晶格傅里葉模式稳定的最严格界限。然后，假设安全因子 $s = \\frac{1}{2}$ 以减轻缺陷核心和高曲率区域附近的数值病态，提供：\n1) 该三维格式的 CFL 条件所蕴含的容许比值 $\\Delta t / \\Delta x$ 的精确上确界，以及\n2) 相应的保守安全选择 $s \\times (\\Delta t / \\Delta x)_{\\text{max}}$。\n将这两者都报告为精确的解析表达式。无需四舍五入，且这些量是无量綱的。你的最终答案必须以不带单位的精确表达式给出。",
            "solution": "问题要求推导应用于三维线性波动方程 $u_{tt} = \\nabla^{2} u$ 的二阶有限差分格式的 Courant–Friedrichs–Lewy (CFL) 稳定性条件。指定的方法是冯·诺依曼（或傅里叶）稳定性分析。\n\n离散格式由下式给出：\n$$\n\\frac{u^{n+1}_{i,j,k} - 2\\,u^{n}_{i,j,k} + u^{n-1}_{i,j,k}}{\\Delta t^{2}} = \\nabla^{2}_{d} u^{n}_{i,j,k}\n$$\n其中 $\\Delta t$ 是时间步长，$u^{n}_{i,j,k}$ 表示场 $u$ 在时间 $t^n = n\\,\\Delta t$ 和空间晶格点 $(i\\,\\Delta x, j\\,\\Delta x, k\\,\\Delta x)$ 处的值。离散拉普拉斯算子 $\\nabla^{2}_{d}$ 定义为：\n$$\n\\nabla^{2}_{d} u_{i,j,k} = \\frac{u_{i+1,j,k} - 2 u_{i,j,k} + u_{i-1,j,k}}{\\Delta x^{2}} + \\frac{u_{i,j+1,k} - 2 u_{i,j,k} + u_{i,j-1,k}}{\\Delta x^{2}} + \\frac{u_{i,j,k+1} - 2 u_{i,j,k} + u_{i,j,k-1}}{\\Delta x^{2}}\n$$\n在冯·诺依曼分析中，我们检验晶格上单个傅里葉模式的行为。我们假设一个形式如下的解：\n$$\nu^{n}_{i,j,k} = G^{n}(\\vec{k}) \\exp\\left[i(k_x i \\Delta x + k_y j \\Delta x + k_z k \\Delta x)\\right]\n$$\n其中 $\\vec{k} = (k_x, k_y, k_z)$ 是模式的波矢，$i$ 是虚数单位，$G(\\vec{k})$ 是每个时间步长的增长因子。为使格式稳定，对于所有可能的波矢 $\\vec{k}$，增长因子的模必须满足 $|G(\\vec{k})| \\le 1$。\n\n首先，我们将离散拉普拉斯算子 $\\nabla^{2}_{d}$ 应用于此傅里葉模式。考虑 $x$ 方向的项：\n\\begin{align*}\n\\frac{u^{n}_{i+1,j,k} - 2 u^{n}_{i,j,k} + u^{n}_{i-1,j,k}}{\\Delta x^{2}} = \\frac{G^n}{\\Delta x^2} \\left( \\exp[i(k_x(i+1)\\Delta x + \\dots)] - 2\\exp[i(k_x i\\Delta x + \\dots)] + \\exp[i(k_x(i-1)\\Delta x + \\dots)] \\right) \\\\\n= \\frac{u^{n}_{i,j,k}}{\\Delta x^2} \\left( \\exp[i k_x \\Delta x] - 2 + \\exp[-i k_x \\Delta x] \\right) \\\\\n= \\frac{u^{n}_{i,j,k}}{\\Delta x^2} \\left( 2 \\cos(k_x \\Delta x) - 2 \\right) \\\\\n= -\\frac{2 u^{n}_{i,j,k}}{\\Delta x^2} \\left( 1 - \\cos(k_x \\Delta x) \\right)\n\\end{align*}\n使用半角恒等式 $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$，上式变为：\n$$\n-\\frac{4 u^{n}_{i,j,k}}{\\Delta x^2} \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right)\n$$\n将此应用于所有三个空间方向，完整的离散拉普拉斯算子作用于傅里葉模式的结果是：\n$$\n\\nabla^{2}_{d} u^{n}_{i,j,k} = -\\frac{4 u^{n}_{i,j,k}}{\\Delta x^2} \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta x}{2}\\right) \\right]\n$$\n现在，我们将傅里叶模式的拟设代入完整的离散波动方程：\n$$\n\\frac{G^{n+1} - 2G^n + G^{n-1}}{G^n} \\frac{u^{n}_{i,j,k}}{\\Delta t^2} = \\frac{\\nabla^{2}_{d} u^{n}_{i,j,k}}{u^{n}_{i,j,k}} u^{n}_{i,j,k}\n$$\n两边同除以 $u^{n}_{i,j,k}$ 并乘以 $\\Delta t^2$ 和 $G^n$，我们得到：\n$$\nG^{n+1} - 2G^n + G^{n-1} = \\Delta t^2 \\left( -\\frac{4 G^n}{\\Delta x^2} \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta x}{2}\\right) \\right] \\right)\n$$\n两边同除以 $G^{n-1}$，得到增长因子 $G$ 的特征方程：\n$$\nG^2 - 2G + 1 = -4 G \\frac{\\Delta t^2}{\\Delta x^2} \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta x}{2}\\right) \\right]\n$$\n令 $\\sigma = \\Delta t / \\Delta x$ 为柯朗数，并定义项 $S_k$：\n$$\nS_k = \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_z \\Delta x}{2}\\right)\n$$\n该特征方程是关于 $G$ 的一个一元二次方程：\n$$\nG^2 - 2(1 - 2\\sigma^2 S_k)G + 1 = 0\n$$\n其根由 $G = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 给出：\n$$\nG = (1 - 2\\sigma^2 S_k) \\pm \\sqrt{(1 - 2\\sigma^2 S_k)^2 - 1}\n$$\n为了稳定性，我们要求 $|G| \\le 1$。如果判别式为正，即 $(1 - 2\\sigma^2 S_k)^2 > 1$，则根为实数，且其中一根的模将大于 $1$，导致不稳定。因此，为了稳定性，判别式必须为非正：\n$$\n(1 - 2\\sigma^2 S_k)^2 - 1 \\le 0 \\implies (1 - 2\\sigma^2 S_k)^2 \\le 1\n$$\n这等价于：\n$$\n-1 \\le 1 - 2\\sigma^2 S_k \\le 1\n$$\n右侧不等式 $1 - 2\\sigma^2 S_k \\le 1$ 意味着 $-2\\sigma^2 S_k \\le 0$，因为 $\\sigma^2 \\ge 0$ 和 $S_k \\ge 0$，所以这个不等式总是成立的。左侧不等式给出了稳定性条件：\n$$\n-1 \\le 1 - 2\\sigma^2 S_k \\implies 2\\sigma^2 S_k \\le 2 \\implies \\sigma^2 S_k \\le 1\n$$\n当此条件成立时，根是形式为 $G = A \\pm i B$ 的共轭复数，其模的平方为 $|G|^2 = A^2+B^2 = (1 - 2\\sigma^2 S_k)^2 + (1-(1 - 2\\sigma^2 S_k)^2) = 1$。因此， $|G|=1$，这对应于一个稳定的、非耗散的格式。\n\n为确保对所有可能的模式都稳定，该条件必须对 $S_k$ 的最大可能值成立。晶格波矢 $k_x, k_y, k_z$ 定义在第一布里渊区内，通常为 $-\\frac{\\pi}{\\Delta x} \\le k_{x,y,z} \\le \\frac{\\pi}{\\Delta x}$。因此，平方正弦函数的自变量，例如 $\\frac{k_x \\Delta x}{2}$，范围是从 $-\\frac{\\pi}{2}$ 到 $\\frac{\\pi}{2}$。函数 $\\sin^2(\\theta)$ 在 $\\theta = \\pm \\frac{\\pi}{2}$ 时取得最大值 $1$。$S_k$ 的最大值在每一项都取最大值时达到，这对应于最高频率的“棋盘”模式（例如，$k_x = k_y = k_z = \\pi/\\Delta x$）：\n$$\nS_{k, \\text{max}} = \\sin^2\\left(\\frac{\\pi}{2}\\right) + \\sin^2\\left(\\frac{\\pi}{2}\\right) + \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1 + 1 + 1 = 3\n$$\n将此最大值代入稳定性条件，得到对 $\\sigma$ 的最严格约束：\n$$\n\\sigma^2 S_{k, \\text{max}} \\le 1 \\implies 3\\sigma^2 \\le 1 \\implies \\sigma^2 \\le \\frac{1}{3}\n$$\n因为 $\\sigma = \\Delta t/\\Delta x \\ge 0$，我们有：\n$$\n\\sigma \\le \\frac{1}{\\sqrt{3}}\n$$\n这就是该格式在三维空间中的 CFL 条件。\n\n1) 容许比值 $\\Delta t / \\Delta x$ 的精确上确界是此不等式允许的最大值：\n$$\n\\left(\\frac{\\Delta t}{\\Delta x}\\right)_{\\text{max}} = \\frac{1}{\\sqrt{3}}\n$$\n2) 保守的安全选择是通过将此上确界乘以给定的安全因子 $s = \\frac{1}{2}$ 来计算的：\n$$\ns \\times \\left(\\frac{\\Delta t}{\\Delta x}\\right)_{\\text{max}} = \\frac{1}{2} \\times \\frac{1}{\\sqrt{3}} = \\frac{1}{2\\sqrt{3}}\n$$\n根据要求，这两个量都是无量纲的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{\\sqrt{3}} & \\frac{1}{2\\sqrt{3}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "代码的稳定性是第一步，但正确性同样至关重要。一个成功的数值模拟必须能证明其解在离散化步长趋于零时，会收敛到真实的连续解。本练习  旨在通过一个被称为“收敛性测试”的核心验证技术，来实践这一过程，确保您的模拟代码能够以预期的精度求解物理方程。",
            "id": "3486951",
            "problem": "在共形规范下，设计并实现一个针对 Nambu–Goto 系统中直弦运动解的自包含数值收敛性测试，使用一维线性波动方程作为其简化后的世界面动力学。其目标是通过将观测到的收敛率与一个解析行波解进行比较，来验证一个标准二阶显式有限差分格式的形式精度阶数。所有角度必须以弧度解释，所有量均为无量纲。\n\n从以下已建立的基础开始。对于张力为 $\\mu$ 的弦，其 Nambu–Goto 作用量由 $S = -\\mu \\int d^{2}\\xi \\, \\sqrt{-\\gamma}$ 给出，其中 $\\gamma$ 是诱导世界面度规的行列式。在共形规范下，直弦的横向自由度满足线性波动方程\n$$\n\\partial_{tt} x(\\sigma, t) - \\partial_{\\sigma \\sigma} x(\\sigma, t) = 0,\n$$\n其中波以单位速度传播。在周期性定义域 $\\sigma \\in [0, 2\\pi)$ 上的一个左行模的精确解为\n$$\nx(\\sigma, t) = A \\sin\\!\\big(k(\\sigma - t)\\big),\n$$\n其中 $A$ 为振幅，$k$ 为整数波数。在 $t=0$ 时的初始条件为 $x(\\sigma, 0) = A \\sin(k \\sigma)$ 和 $\\partial_t x(\\sigma, 0) = -A k \\cos(k \\sigma)$。\n\n实现以下数值方法和收敛性评估：\n- 在周期性边界条件下，用 $N$ 个均匀点将空间域离散化，网格间距为 $\\Delta \\sigma = 2\\pi/N$。\n- 使用 Courant–Friedrichs–Lewy (CFL) 数 $\\mathcal{C} = \\Delta t/\\Delta \\sigma$，要求 $\\mathcal{C} \\le 1$，并设置 $\\Delta t = \\mathcal{C} \\Delta \\sigma$。\n- 在时间上使用空间二阶中心有限差分和波动方程的显式蛙跳格式进行演化：\n  - 使用运动方程 $\\partial_{tt} x = \\partial_{\\sigma \\sigma} x$ 和二阶精度的 Taylor 展开构建第一个时间层：\n    $$\n    x^{1} = x^{0} + \\Delta t \\, v^{0} + \\tfrac{1}{2}\\Delta t^{2} \\, \\partial_{\\sigma \\sigma} x^{0},\n    $$\n    其中 $x^{0}$ 是初始场，$v^{0} = \\partial_t x(\\sigma,0)$。\n  - 对于后续步骤，使用\n    $$\n    x^{n+1}_i = 2 x^{n}_i - x^{n-1}_i + \\mathcal{C}^{2} \\left(x^{n}_{i+1} - 2 x^{n}_i + x^{n}_{i-1}\\right),\n    $$\n    并采用周期性索引。\n- 演化至最终时间 $T$。如果 $T / \\Delta t$ 不是整数，则取整数步数 $n_{\\mathrm{steps}} = \\mathrm{round}(T/\\Delta t)$，并在 $t_{\\mathrm{final}} = n_{\\mathrm{steps}} \\Delta t$ 时与解析解进行比较。\n- 在最终时间测量相对 $\\ell^{2}$ 误差，\n  $$\n  E(N) = \\frac{\\left(\\sum_{i=0}^{N-1} \\left[x^{\\mathrm{num}}(\\sigma_i,t_{\\mathrm{final}}) - x^{\\mathrm{exact}}(\\sigma_i,t_{\\mathrm{final}})\\right]^{2} \\Delta \\sigma \\right)^{1/2}}{\\left(\\sum_{i=0}^{N-1} \\left[x^{\\mathrm{exact}}(\\sigma_i,t_{\\mathrm{final}})\\right]^{2} \\Delta \\sigma \\right)^{1/2}},\n  $$\n  其中 $\\sigma_i = i \\, \\Delta \\sigma$。\n- 对于固定的 $\\mathcal{C}$ 和三组分辨率 $N, 2N, 4N$，通过以下公式估计观测到的精度阶数：\n  $$\n  p_{12} = \\frac{\\log\\!\\big(E(N)/E(2N)\\big)}{\\log(2)}, \\quad\n  p_{23} = \\frac{\\log\\!\\big(E(2N)/E(4N)\\big)}{\\log(2)}, \\quad\n  p = \\tfrac{1}{2}\\left(p_{12} + p_{23}\\right).\n  $$\n\n实现一个程序，执行上述过程，并为以下测试套件返回测得的精度阶数 $p$。每个测试用例指定一组分辨率和参数 $(\\mathcal{C}, A, k, T)$：\n- 测试用例 1 (理想情况)：$N \\in \\{64, 128, 256\\}$，$\\mathcal{C} = 0.90$，$A = 0.10$，$k = 3$，$T = 1.00$。\n- 测试用例 2 (短波长边缘情况)：$N \\in \\{128, 256, 512\\}$，$\\mathcal{C} = 0.90$，$A = 0.10$，$k = 16$，$T = 1.00$。\n- 测试用例 3 (接近 CFL 边界情况)：$N \\in \\{32, 64, 128\\}$，$\\mathcal{C} = 0.99$，$A = 0.10$，$k = 3$，$T = 1.00$。\n\n您的程序必须：\n- 为每个测试用例计算如上定义的观测阶数 $p$。\n- 生成单行输出，其中包含三个结果，形式为方括号括起来的逗号分隔列表，例如 $[p_{1},p_{2},p_{3}]$。每个值必须是十进制表示的浮点数。\n\n角度必须以弧度为单位。所有输出均为无量纲实数。最终的数值输出必须是浮点数。程序不得要求任何用户输入或外部文件。",
            "solution": "该问题是适定的，是计算物理中数值分析应用的一个标准练习。它要求对一维线性波动方程的二阶有限差分格式进行收敛性测试，该方程在共形规范下的 Nambu-Goto 形式主义中可作为直宇宙弦动力学的模型。\n\n横向位移 $x(\\sigma, t)$ 的控制偏微分方程 (PDE) 是线性波动方程：\n$$\n\\frac{\\partial^2 x}{\\partial t^2} - \\frac{\\partial^2 x}{\\partial \\sigma^2} = 0\n$$\n空间坐标 $\\sigma$ 上的定义域是周期性的，$\\sigma \\in [0, 2\\pi)$。问题指定了一个精确的行波解，即一个振幅为 $A$、整数波数为 $k$ 的左行模：\n$$\nx_{\\mathrm{exact}}(\\sigma, t) = A \\sin(k(\\sigma - t))\n$$\n由此，我们导出在时间 $t=0$ 时的初始条件：\n$$\nx(\\sigma, 0) = x^0(\\sigma) = A \\sin(k \\sigma)\n$$\n$$\n\\frac{\\partial x}{\\partial t}(\\sigma, 0) = v^0(\\sigma) = -A k \\cos(k \\sigma)\n$$\n\n为了数值求解该系统，我们将时空域离散化。空间域 $[0, 2\\pi)$ 被离散化为 $N$ 个均匀网格点 $\\sigma_i = i \\Delta \\sigma$，$i=0, 1, \\dots, N-1$，其中网格间距为 $\\Delta \\sigma = 2\\pi/N$。时间以 $\\Delta t$ 为步长离散化，即 $t^n = n \\Delta t$。时间步长通过 Courant–Friedrichs–Lewy (CFL) 数 $\\mathcal{C} = \\Delta t / \\Delta \\sigma$ 与空间步长相关联。为保证显式格式的稳定性，我们要求 $\\mathcal{C} \\le 1$。在网格点 $(\\sigma_i, t^n)$ 处的数值解记为 $x_i^n$。\n\n指定的数值方法是显式二阶蛙跳格式。二阶偏导数使用中心有限差分进行近似：\n$$\n\\frac{\\partial^2 x}{\\partial t^2}\\bigg|_i^n \\approx \\frac{x_i^{n+1} - 2x_i^n + x_i^{n-1}}{(\\Delta t)^2}\n$$\n$$\n\\frac{\\partial^2 x}{\\partial \\sigma^2}\\bigg|_i^n \\approx \\frac{x_{i+1}^n - 2x_i^n + x_{i-1}^n}{(\\Delta \\sigma)^2}\n$$\n将这些代入波动方程并整理得到 $x_i^{n+1}$，得出 $n \\ge 1$ 时的更新规则：\n$$\nx_i^{n+1} = 2x_i^n - x_i^{n-1} + \\left(\\frac{\\Delta t}{\\Delta \\sigma}\\right)^2 (x_{i+1}^n - 2x_i^n + x_{i-1}^n)\n$$\n$$\nx_i^{n+1} = 2x_i^n - x_i^{n-1} + \\mathcal{C}^2 (x_{i+1}^n - 2x_i^n + x_{i-1}^n)\n$$\n索引 $i+1$ 和 $i-1$ 按周期性处理，例如 $x_{N}^n = x_0^n$ 和 $x_{-1}^n = x_{N-1}^n$。\n\n该格式是一种三层方法，需要前两个时间步（$n$ 和 $n-1$）的数据来计算下一步（$n+1$）。这对第一个时间步造成了问题，因为我们只有 $t=0$（第 $n=0$ 层）的初始数据。我们必须使用另一种至少为二阶精度的方法来构造 $t^1 = \\Delta t$ 时的解，以保持格式的整体精度。使用关于 $t=0$ 的二阶时间 Taylor 展开：\n$$\nx(\\sigma, \\Delta t) \\approx x(\\sigma, 0) + \\Delta t \\frac{\\partial x}{\\partial t}(\\sigma, 0) + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 x}{\\partial t^2}(\\sigma, 0)\n$$\n使用运动方程本身 $\\partial_{tt}x = \\partial_{\\sigma\\sigma}x$，我们可以将时间导数替换为空间导数：\n$$\nx_i^1 \\approx x_i^0 + \\Delta t \\, v_i^0 + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 x}{\\partial \\sigma^2}\\bigg|_i^0\n$$\n将空间导数离散化，得到第一个时间步的公式：\n$$\nx_i^1 = x_i^0 + \\Delta t \\, v_i^0 + \\frac{(\\Delta t)^2}{2} \\left( \\frac{x_{i+1}^0 - 2x_i^0 + x_{i-1}^0}{(\\Delta \\sigma)^2} \\right) = x_i^0 + \\Delta t \\, v_i^0 + \\frac{\\mathcal{C}^2}{2} (x_{i+1}^0 - 2x_i^0 + x_{i-1}^0)\n$$\n模拟过程是：设置 $x^0$ 和 $v^0$，使用上述公式计算 $x^1$，然后迭代主蛙跳更新规则，直至达到所需的步数 $n_{\\mathrm{steps}} = \\mathrm{round}(T/\\Delta t)$。\n\n为评估精度，我们将最终时间 $t_{\\mathrm{final}} = n_{\\mathrm{steps}} \\Delta t$ 时的最终数值解 $x^{\\mathrm{num}}(\\sigma_i, t_{\\mathrm{final}})$ 与精确解 $x^{\\mathrm{exact}}(\\sigma_i, t_{\\mathrm{final}})$ 进行比较。误差由离散相对 $\\ell^2$ 范数来量化：\n$$\nE(N) = \\frac{\\|\\boldsymbol{x}^{\\mathrm{num}} - \\boldsymbol{x}^{\\mathrm{exact}}\\|_{\\ell^2}}{\\|\\boldsymbol{x}^{\\mathrm{exact}}\\|_{\\ell^2}} = \\frac{\\left(\\sum_{i=0}^{N-1} (x_i^{\\mathrm{num}} - x_i^{\\mathrm{exact}})^2 \\Delta \\sigma \\right)^{1/2}}{\\left(\\sum_{i=0}^{N-1} (x_i^{\\mathrm{exact}})^2 \\Delta \\sigma \\right)^{1/2}}\n$$\n对于一个 $p$ 阶数值方法，误差预计与网格间距成比例关系，即 $E \\propto (\\Delta \\sigma)^p$。由于 $\\Delta \\sigma \\propto 1/N$，我们有 $E(N) \\propto N^{-p}$。如果我们在两种分辨率 $N_1$ 和 $N_2$ 下运行模拟，其误差之比为：\n$$\n\\frac{E(N_1)}{E(N_2)} \\approx \\frac{C N_1^{-p}}{C N_2^{-p}} = \\left(\\frac{N_2}{N_1}\\right)^p\n$$\n解出 $p$ 可得 $p \\approx \\log(E(N_1)/E(N_2))/\\log(N_2/N_1)$。对于 $N_2 = 2N_1$ 的特殊情况，这简化为：\n$$\np \\approx \\frac{\\log(E(N)/E(2N))}{\\log(2)}\n$$\n问题要求为两对分辨率 $(N, 2N)$ 和 $(2N, 4N)$ 计算这个量，然后对结果求平均，以获得对观测精度阶数 $p$ 的更稳健的估计。由于有限差分格式在空间和时间上都是二阶的，我们预计观测到的阶数 $p$ 会接近 2。\n\n具体实现将包含一个主函数，该函数为每个测试用例组织三次模拟，分辨率分别为 $N$, $2N$ 和 $4N$。它将收集相应的误差 $E(N)$, $E(2N)$ 和 $E(4N)$，然后计算最终的平均精度阶数 $p$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(N, C, A, k, T):\n    \"\"\"\n    Performs a single simulation of the 1D wave equation and returns the relative l2 error.\n\n    Args:\n        N (int): Number of spatial grid points.\n        C (float): Courant-Friedrichs-Lewy (CFL) number.\n        A (float): Amplitude of the initial wave.\n        k (int): Wavenumber of the initial wave.\n        T (float): Target final time.\n\n    Returns:\n        float: The relative l2 error at the final time.\n    \"\"\"\n    # 1. Setup Grid and Parameters\n    ds = 2.0 * np.pi / N\n    dt = C * ds\n    \n    # Calculate number of steps and the final time\n    n_steps = int(round(T / dt))\n    t_final = n_steps * dt\n\n    sigma = np.linspace(0, 2 * np.pi, N, endpoint=False)\n\n    # 2. Initial Conditions\n    x0 = A * np.sin(k * sigma)\n    v0 = -A * k * np.cos(k * sigma)\n\n    # 3. First Time Step (using Taylor expansion)\n    # The term d2x/ds2 is approximated with a centered finite difference.\n    # np.roll is used for periodic boundary conditions.\n    d2x_ds2_0 = (np.roll(x0, -1) - 2 * x0 + np.roll(x0, 1)) / (ds**2)\n    x1 = x0 + dt * v0 + 0.5 * dt**2 * d2x_ds2_0\n\n    # 4. Time Evolution (Leapfrog)\n    x_prev = x0\n    x_curr = x1\n    C_squared = C**2\n    for _ in range(1, n_steps):\n        # The stencil for the second spatial derivative\n        laplacian_curr = np.roll(x_curr, -1) - 2 * x_curr + np.roll(x_curr, 1)\n        \n        # Leapfrog update rule\n        x_next = 2 * x_curr - x_prev + C_squared * laplacian_curr\n        \n        # Update for next iteration\n        x_prev = x_curr\n        x_curr = x_next\n    \n    # x_curr is now the numerical solution at t_final\n    x_num = x_curr\n\n    # 5. Error Calculation\n    x_exact = A * np.sin(k * (sigma - t_final))\n\n    # Calculate numerator of the relative l2 error\n    error_norm = np.sqrt(np.sum((x_num - x_exact)**2 * ds))\n    \n    # Calculate denominator of the relative l2 error\n    exact_norm = np.sqrt(np.sum(x_exact**2 * ds))\n\n    # Avoid division by zero if the exact solution is zero everywhere\n    if exact_norm == 0.0:\n        return 0.0 if error_norm == 0.0 else np.inf\n\n    return error_norm / exact_norm\n\ndef calculate_convergence_order(N_tuple, C, A, k, T):\n    \"\"\"\n    Calculates the observed order of accuracy for a given set of parameters.\n\n    Args:\n        N_tuple (tuple): A triplet of resolutions (N, 2N, 4N).\n        C (float): CFL number.\n        A (float): Amplitude.\n        k (int): Wavenumber.\n        T (float): Final time.\n\n    Returns:\n        float: The averaged observed order of accuracy p.\n    \"\"\"\n    N1, N2, N3 = N_tuple\n\n    # Run simulations for the three resolutions\n    E1 = run_simulation(N1, C, A, k, T)\n    E2 = run_simulation(N2, C, A, k, T)\n    E3 = run_simulation(N3, C, A, k, T)\n\n    # Prevent log(0) or division by zero errors\n    if E1 == 0 or E2 == 0 or E3 == 0:\n        return np.nan\n\n    # Calculate convergence orders\n    p12 = np.log(E1 / E2) / np.log(2)\n    p23 = np.log(E2 / E3) / np.log(2)\n\n    # Average the two estimates\n    p_avg = 0.5 * (p12 + p23)\n    \n    return p_avg\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # ((Resolutions), (C, A, k, T))\n        ((64, 128, 256), (0.90, 0.10, 3, 1.00)),   # Test case 1\n        ((128, 256, 512), (0.90, 0.10, 16, 1.00)),  # Test case 2\n        ((32, 64, 128), (0.99, 0.10, 3, 1.00)),    # Test case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        N_tuple, params = case\n        C, A, k, T = params\n        \n        # Main logic to calculate the result for one case goes here.\n        p = calculate_convergence_order(N_tuple, C, A, k, T)\n        results.append(p)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "宇宙学模拟在有限的计算区域内进行，而我们试图理解的物理宇宙是广阔的。边界条件的选择是连接这两者的桥梁，它深刻地影响着模拟的物理结果，尤其是在大尺度上。这项练习  将引导您深入探讨不同边界条件（如周期性、固定或吸收性边界）的优缺点，以及它们如何影响网络演化和关键的可观测量。",
            "id": "3486991",
            "problem": "在一个旨在捕捉宇宙弦和拓扑缺陷网络动力学的场论模拟中，考虑一个代表缺陷周围长波辐射和曲率模的实标量自由度。在大尺度上，辐射分量可以由线性波动方程精确建模，该方程源于局域洛伦兹不变性和正则动力学：线性化场涨落 $\\varphi$ 遵循 $\\,\\partial_t^2 \\varphi - c^2 \\nabla^2 \\varphi = 0\\,$，其中波速 $\\,c\\,$ 由微观理论设定。模拟在一个边长为 $\\,L\\,$ 的有限立方共动区域中进行。通常使用三种边界条件策略：\n- 周期性边界，将立方体的相对面等同起来，从而模拟一个空间 $3$-环面。\n- 固定边界，例如将场在边界面上钉扎在某个选定的真空值的 Dirichlet 边界，或是在边界面上设置法向导数为零的 Neumann 边界，这会引入反射。\n- 吸收边界，在区域边缘附近增加耗散项（例如海绵层或完美匹配层(PML)），以最小化反射并模拟开放空间。\n关注的网络可观测量包括能量密度 $\\,\\rho\\,$、一个有效的单标度关联长度 $\\,\\xi\\,$、均方根速度 $\\,v\\,$、圈或缺陷尺寸分布 $\\,n(\\ell)\\,$，以及缺陷应力-能量的傅里叶空间不等时关联函数 (UETC) $\\,C_{ab}(k,\\tau,\\tau') \\equiv \\langle T_{ab}(\\mathbf{k},\\tau)\\,T_{ab}^*(\\mathbf{k},\\tau')\\rangle\\,$，其中 $\\,\\tau\\,$ 是共形时间，$\\,k \\equiv |\\mathbf{k}|\\,$。红外行为由区域所能支持的最长波长以及长波辐射是被反射、透射还是通过环绕效应重新引入所控制。\n关于边界条件如何影响红外模和网络可观测量，以下哪些陈述是正确的？选择所有适用项。\n\nA. 在边长为 $\\,L\\,$ 的周期性立方区域中，平面波模可及的最小非零波数为 $\\,k_{\\min} = 2\\pi/L\\,$。波数小于 $\\,k  2\\pi/L\\,$ 的模式不存在，这直接限制了对最大尺度涨落的表示，并可能给 $\\,C_{ab}(k,\\tau,\\tau')\\,$ 的低 $k$ 尾部带来偏差。\n\nB. 将场在边界面上钉扎于真空值的固定 Dirichlet 边界允许具有离散波数 $\\,k_n = n\\pi/L\\,$ 的驻波简正模，并反射出射辐射。这种构造移除了全局零模，并可能通过驻波将功率堆积到最低分辨的区间，从而给诸如 $\\,\\xi\\,$ 和 $\\,v\\,$ 等大尺度估计量带来偏差，除非将边界区域排除在外。\n\nC. 吸收边界层在任何时候都严格保守计算区域内的哈密顿能量，从而确保对标度能量密度 $\\,\\rho\\,$ 和圈产生率的无偏估计，且该估计独立于吸收体所占体积的比例。\n\nD. 对于估计应力-能量的傅里叶空间不等时关联函数，周期性边界是有利的，因为它们保持了离散平移不变性和动量守恒，但如果光穿越时间 $\\,L/c\\,$ 短于关联函数的时间延迟，它们可能会污染红外区间，允许辐射环绕并重新进入测量。\n\nE. 在具有固定或吸收边界的模拟中，将测量限制在边长为 $\\,\\left(1-2\\epsilon\\right)L\\,$ 的内部掩蔽子体积内，并应用窗函数反卷积，可以减少谱和关联函数中由边界引起的红外偏差，但代价是估计量方差的增加。\n\nF. 从周期性边界更改为固定边界会使红外截断保持在 $\\,k_{\\min} = 2\\pi/L\\,$ 不变，因此在测量的红外谱中观察到的任何差异都必定仅仅源于非线性缺陷动力学，而非边界条件本身。",
            "solution": "问题陈述描述了宇宙缺陷网络数值模拟的标准设置，并要求评估关于不同边界条件对物理可观测量（特别是与大尺度（红外）物理相关的可观测量）影响的几个陈述的正确性。\n\n### 问题陈述的验证\n\n**步骤1：提取已知条件**\n-   **系统**：在宇宙缺陷网络的模拟中，一个代表长波辐射的实标量场 `$\\varphi$`。\n-   **运动方程**：线性波动方程 `$\\partial_t^2 \\varphi - c^2 \\nabla^2 \\varphi = 0$`。\n-   **模拟区域**：一个边长为 `$L$` 的有限立方共动区域。\n-   **边界条件 (BCs)**：\n    1.  周期性边界（空间 `$3$-环面）。\n    2.  固定边界 (Dirichlet 或 Neumann)。\n    3.  吸收边界（例如，PML 或海绵层）。\n-   **可观测量**：能量密度 `$\\rho$`、关联长度 `$\\xi$`、均方根速度 `$v$`、圈分布 `$n(\\ell)$`，以及傅里叶空间不等时关联函数 `$C_{ab}(k,\\tau,\\tau') \\equiv \\langle T_{ab}(\\mathbf{k},\\tau)\\,T_{ab}^*(\\mathbf{k},\\tau')\\rangle$`。\n-   **关键概念**：模拟的红外行为受边界条件如何处理最长波长模式的影响。\n\n**步骤2：使用提取的已知条件进行验证**\n问题陈述在科学上基于数值场论和宇宙学的既定原则。物理系统、控制方程、边界条件和可观测量都是该领域现代研究的标准组成部分。语言精确客观。问题是适定的，因为它要求对成熟的数值技术进行概念性评估，而不是解决一个未充分定义的数学问题。设置是自洽且一致的；不存在科学或事实上的不健全、模糊或不可行性。\n\n**步骤3：结论与行动**\n问题陈述是有效的。我将继续分析每个选项。\n\n### 推导与逐项分析\n\n**A. 在边长为 `$\\,L\\,`\" 的周期性立方区域中，平面波模可及的最小非零波数为 `$\\,k_{\\min} = 2\\pi/L\\,`\"。波数小于 `$\\,k  2\\pi/L\\,`\" 的模式不存在，这直接限制了对最大尺度涨落的表示，并可能给 `$\\,C_{ab}(k,\\tau,\\tau')\\,`\" 的低 $k$ 尾部带来偏差。**\n\n对于边长为 `$L$` 的立方区域中具有周期性边界条件的场 `$\\varphi(\\mathbf{x})$`，所允许的平面波模 `$\\exp(i\\mathbf{k}\\cdot\\mathbf{x})$` 必须满足 `$\\varphi(\\mathbf{x} + L\\mathbf{\\hat{e}}_i) = \\varphi(\\mathbf{x})$`（对于 `$i \\in \\{x,y,z\\}$`）。这将波矢 `$\\mathbf{k}$` 的分量量子化为 `$k_i = 2\\pi n_i/L$`，其中 `$n_i$` 是整数。因此波矢为 `$\\mathbf{k} = (2\\pi/L)(n_x, n_y, n_z)$`。波数（模长）为 `$k = |\\mathbf{k}| = (2\\pi/L)\\sqrt{n_x^2 + n_y^2 + n_z^2}$`。\n`$(n_x, n_y, n_z) = (0,0,0)$` 的模式对应于 `$k=0$`（零模或直流分量）。最小*非零*波数 `$k_{\\min}$` 对应于 `$\\sqrt{n_x^2 + n_y^2 + n_z^2}$` 的最小非零整数值，即 `$1$`。这发生在像 `$(1,0,0)$` 这样的构型中。因此，`$k_{\\min} = (2\\pi/L) \\cdot 1 = 2\\pi/L$`。相应的最大波长是 `$\\lambda_{\\max} = 2\\pi/k_{\\min} = L$`。\n因此，模拟无法表示任何波长大于 `$L$` 的涨落，即波数 `$k  2\\pi/L$`。这是由有限周期性体积施加的一个基本的红外截断。任何对这些大尺度敏感的可观测量，例如像 `$C_{ab}(k,\\tau,\\tau')`$ 这样的谱和关联函数的低 `$k$` 行为，都会受到这种硬截断的偏差影响。\n\n**结论：正确。**\n\n**B. 将场在边界面上钉扎于真空值的固定 Dirichlet 边界允许具有离散波数 `$\\,k_n = n\\pi/L\\,$` 的驻波简正模，并反射出射辐射。这种构造移除了全局零模，并可能通过驻波将功率堆积到最低分辨的区间，从而给诸如 `$\\,\\xi\\,$` 和 `$\\,v\\,$` 等大尺度估计量带来偏差，除非将边界区域排除在外。**\n\n对于固定的 Dirichlet 边界（在立方体的所有面上 `$\\varphi=0$`），简正模是驻波。为了可分离性，解的形式为 `$\\varphi(\\mathbf{x}) \\propto \\sin(k_x x) \\sin(k_y y) \\sin(k_z z)$`。在 `$x=L, y=L, z=L$` 处的边界条件 `$\\varphi=0$` 要求 `$k_i L = n_i \\pi$`，其中正整数 `$n_i \\geq 1$`。允许的波矢分量为 `$k_i = n_i \\pi/L$`。陈述中的公式 `$k_n = n\\pi/L$` 是一个一维简化，但正确地指出了基本离散标度为 `$\\pi/L$`，这与周期性情况不同。\n固定边界是完全反射的，因此出射辐射确实被反射回区域内。这会导致干涉和驻波的形成，俘获了本应逸出的能量。这会在允许模式的离散波数上“堆积”功率。由于最低允许波数（例如，`$k = (\\pi/L)\\sqrt{1^2+1^2+1^2} = \\sqrt{3}\\pi/L$`）通常小于周期性情况的 `$k_{\\min}$`，这会影响谱的红外部分。非平凡零模（`$\\varphi = \\text{const} \\neq 0$`）与 `$\\varphi=0$` 边界不相容，因此被移除。大尺度上功率的人为增强会使像关联长度 `$\\xi$`（使其看起来更大）和均方根速度 `$v$` 这样的估计量产生偏差。从测量中排除边界区域是减轻此类偏差的标准技术。\n\n**结论：正确。**\n\n**C. 吸收边界层在任何时候都严格保守计算区域内的哈密顿能量，从而确保对标度能量密度 `$\\,\\rho\\,$` 和圈产生率的无偏估计，且该估计独立于吸收体所占体积的比例。**\n\n吸收边界层的定义性目的是耗散出射波的能量以防止反射，从而模拟一个开放的无限空间。这是通过在边界层区域的运动方程中添加明确的耗散（非哈密顿）项来实现的。例如，波动方程中的一个阻尼项 `$+\\gamma \\partial_t \\varphi$` 会导致系统的总能量随时间减少。因此，哈密顿能量明确地*不*守恒。能量严格守恒的陈述根本上是错误的。因此，这能确保对 `$\\rho$` 的无偏估计的结论也是错误的；模拟区域的总能量被系统性地耗尽。其效果也必然*依赖于*吸收层的属性和体积。\n\n**结论：不正确。**\n\n**D. 对于估计应力-能量的傅里叶空间不等时关联函数，周期性边界是有利的，因为它们保持了离散平移不变性和动量守恒，但如果光穿越时间 `$\\,L/c\\,$` 短于关联函数的时间延迟，它们可能会污染红外区间，允许辐射环绕并重新进入测量。**\n\n周期性边界条件施加了离散平移不变性，这在连续极限下导致动量守恒。这对于傅里叶空间分析非常有利。然而，周期性引入了一种非物理的拓扑结构。一个以速度 `$c$` 传播的信号（如一个辐射波包）可以在时间 `$\\Delta t = L/c$` 内穿过整个边长为 `$L$` 的盒子。在周期性区域中，这意味着信号会重新出现在相对的一侧，可能影响其起源点。当计算一个双时关联函数 `$\\langle A(t) A(t+\\Delta t) \\rangle$` 时，如果时间延迟 `$\\Delta t$` 超过光穿越时间 `$L/c$`，一个物理信号可以环绕盒子一周并产生一个虚假的自相关。这种人为的因果关系违反了无限空间的物理学。这些环绕信号会污染测量，引入虚假的功率，特别是在与盒子尺寸相称的最大尺度上（对应于 `$k \\approx 2\\pi/L$` 的红外模）。\n\n**结论：正确。**\n\n**E. 在具有固定或吸收边界的模拟中，将测量限制在边长为 `$\\,\\left(1-2\\epsilon\\right)L\\,$` 的内部掩蔽子体积内，并应用窗函数反卷积，可以减少谱和关联函数中由边界引起的红外偏差，但代价是估计量方差的增加。**\n\n像固定或吸收这样的边界条件会引入人为产物（反射、耗散），这些产物在边界附近最为显著。为了获得更接近无限体积的结果，一种标准做法是定义一个“基准体积”或“内部掩蔽子体积”（例如，对于 `$\\epsilon \\ll 1$`，一个边长为 `$(1-2\\epsilon)L`$ 的立方体），并仅对该区域内的数据进行所有测量。这减少了由边界效应引起的系统偏差。然而，这个过程有两个主要后果。首先，在实空间应用一个尖锐掩模（一个窗函数）对应于在傅里叶空间中的卷积，这会混合不同 `$k$` 模式之间的功率。这种效应可以被校正，这个过程被称为“窗函数反卷积”。其次，通过丢弃体积外壳中的数据，任何估计量的统计样本量都会减少。较小的样本量会导致较大的统计不确定性，即估计量方差增加。该陈述正确地指出了在减少系统偏差和增加统计方差之间的这种权衡。\n\n**结论：正确。**\n\n**F. 从周期性边界更改为固定边界会使红外截断保持在 `$\\,k_{\\min} = 2\\pi/L\\,`\" 不变，因此在测量的红外谱中观察到的任何差异都必定仅仅源于非线性缺陷动力学，而非边界条件本身。**\n\n这个陈述在事实上是不正确的。如选项 A 的分析所确立，周期性边界条件 (BCs) 的红外截断是 `$k_{\\min} = 2\\pi/L$`。如选项 B 的分析所确立，对于固定的 Dirichlet 边界条件，波数的基本标度是 `$\\pi/L$`，且最小允许波数是 `$k_{\\min} = \\sqrt{3}\\pi/L \\approx 1.732 \\pi/L$`。对于固定的 Neumann 边界条件（`$\\partial_n \\varphi = 0$`），简正模是余弦函数，最小非零波数是 `$k_{\\min} = \\pi/L$`。无论哪种情况，从周期性边界切换到固定边界时，红外截断 `$k_{\\min}$` 都会改变。该陈述的前提是错误的。允许的线性模式结构的差异是导致所测量红外谱差异的直接和主要原因，这与任何非线性动力学无关。\n\n**结论：不正确。**",
            "answer": "$$\\boxed{ABDE}$$"
        }
    ]
}