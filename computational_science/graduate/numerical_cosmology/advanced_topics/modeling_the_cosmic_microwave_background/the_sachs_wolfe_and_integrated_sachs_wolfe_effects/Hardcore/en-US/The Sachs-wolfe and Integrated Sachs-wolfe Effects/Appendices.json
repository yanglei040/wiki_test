{
    "hands_on_practices": [
        {
            "introduction": "The angular power spectrum of the Cosmic Microwave Background (CMB) holds a wealth of information about our universe's history and composition. At the largest angular scales (low multipoles $l$), the anisotropies are dominated by the ordinary Sachs-Wolfe (SW) effect. This foundational exercise guides you through the classic derivation of the SW contribution to the power spectrum, starting from a scale-invariant primordial curvature perturbation and connecting it to the observable temperature fluctuations, culminating in the famous Sachs-Wolfe plateau where $l(l+1)C_l$ is constant .",
            "id": "3497869",
            "problem": "Consider a spatially flat Friedmann–Lemaître–Robertson–Walker universe that is matter dominated at last scattering and has adiabatic initial conditions. Assume instantaneous recombination and neglect the Doppler effect, reionization, gravitational lensing, and the Integrated Sachs–Wolfe effect (ISW). Focus solely on the ordinary Sachs–Wolfe contribution to the Cosmic Microwave Background (CMB) temperature anisotropies.\n\nLet the primordial comoving curvature perturbation $\\mathcal{R}(\\mathbf{k})$ be a statistically homogeneous and isotropic Gaussian field with a scale-invariant power spectrum characterized by\n$$\nP_{\\mathcal{R}}(k) \\equiv \\langle \\mathcal{R}(\\mathbf{k}) \\mathcal{R}^{*}(\\mathbf{k}) \\rangle = 2 \\pi^{2} A_{s} k^{-3},\n$$\nwhere $A_{s}$ is a constant amplitude and $k$ is the comoving wavenumber. Define the dimensionless curvature power spectrum as $\\Delta_{\\mathcal{R}}^{2}(k) \\equiv \\frac{k^{3}}{2 \\pi^{2}} P_{\\mathcal{R}}(k) = A_{s}$.\n\nWork in the Newtonian gauge with negligible anisotropic stress so that the two scalar gravitational potentials are equal, and use the linear-theory line-of-sight solution for the temperature anisotropy multipoles. In this setup, the ordinary Sachs–Wolfe source associated with last scattering is proportional to the primordial curvature perturbation, and under matter domination the large-scale adiabatic relation between the Newtonian potential and $\\mathcal{R}$ holds.\n\nUsing only fundamental definitions from linear cosmological perturbation theory and well-tested formulas for projecting three-dimensional perturbations onto the celestial sphere, derive an analytic expression for the low-multipole angular power spectrum $C_{l}$ of temperature anisotropies due solely to the ordinary Sachs–Wolfe effect in terms of $A_{s}$ and $l$. Your final expression must be fully simplified and written as a closed-form analytic expression. No numerical approximation or rounding is required. Express your answer without units.",
            "solution": "The user wants a derivation of the angular power spectrum of the Cosmic Microwave Background (CMB) anisotropies, considering only the ordinary Sachs-Wolfe (SW) effect under specific simplifying assumptions.\n\n### **Problem Validation**\n\n**Step 1: Extract Givens**\n-   **Universe Model**: Spatially flat Friedmann–Lemaître–Robertson–Walker (FLRW) universe.\n-   **Era**: Matter dominated at last scattering.\n-   **Initial Conditions**: Adiabatic initial conditions.\n-   **Recombination**: Assumed to be instantaneous.\n-   **Physical Effects Neglected**: Doppler effect, reionization, gravitational lensing, Integrated Sachs–Wolfe (ISW) effect.\n-   **Physical Effect Considered**: Ordinary Sachs–Wolfe (SW) effect only.\n-   **Primordial Perturbation**: Comoving curvature perturbation $\\mathcal{R}(\\mathbf{k})$ is a statistically homogeneous and isotropic Gaussian random field.\n-   **Primordial Power Spectrum**: $P_{\\mathcal{R}}(k) \\equiv \\langle \\mathcal{R}(\\mathbf{k}) \\mathcal{R}^{*}(\\mathbf{k}) \\rangle = 2 \\pi^{2} A_{s} k^{-3}$.\n-   **Dimensionless Power Spectrum**: $\\Delta_{\\mathcal{R}}^{2}(k) \\equiv \\frac{k^{3}}{2 \\pi^{2}} P_{\\mathcal{R}}(k) = A_{s}$ (scale-invariant).\n-   **Gauge and Stress Conditions**: Newtonian gauge with negligible anisotropic stress, implying the two scalar gravitational potentials are equal (here denoted $\\Psi$).\n-   **Theoretical Framework**: Linear-theory line-of-sight solution; large-scale adiabatic relation between the Newtonian potential and $\\mathcal{R}$ under matter domination.\n-   **Objective**: Derive an analytic, closed-form expression for the low-multipole angular power spectrum $C_{l}$ in terms of $A_{s}$ and $l$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is a standard, canonical calculation in theoretical cosmology.\n-   **Scientific Grounding**: The problem is set within the standard model of cosmology and linear perturbation theory. The Sachs-Wolfe effect, the concept of a primordial curvature perturbation with a scale-invariant power spectrum, and the FLRW metric are all cornerstones of modern cosmology. The assumptions made are standard for an analytical derivation of this type.\n-   **Well-Posedness**: The problem provides a clear objective (derive $C_l$) and all necessary physical inputs and constraints (primordial power spectrum, specific physical effect). The path from a 3D power spectrum to a 2D angular power spectrum is a well-defined mathematical procedure. A unique, stable solution is expected.\n-   **Objectivity**: The problem is stated in precise, formal language without subjective or biased elements.\n-   **Ambiguity Note**: The definition $P_{\\mathcal{R}}(k) \\equiv \\langle \\mathcal{R}(\\mathbf{k}) \\mathcal{R}^{*}(\\mathbf{k}) \\rangle$ is non-standard, as the conventional power spectrum relates modes at different wavevectors via a Dirac delta function. However, the subsequent definition of the dimensionless power spectrum, $\\Delta_{\\mathcal{R}}^{2}(k) = \\frac{k^{3}}{2 \\pi^{2}} P_{\\mathcal{R}}(k) = A_s$, clarifies the intended meaning. This implies that the quantity $P_{\\mathcal{R}}(k)=2\\pi^2 A_s k^{-3}$ is the standard power spectrum density that appears in integrals over momentum space. This resolves the ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. The derivation will proceed.\n\n### **Derivation of the Angular Power Spectrum $C_l$**\n\nThe derivation proceeds in three main steps:\n1.  Relate the observed CMB temperature anisotropy to the primordial curvature perturbation.\n2.  Express the angular power spectrum $C_l$ as an integral over the 3D power spectrum of the temperature field.\n3.  Substitute the specific power spectrum and evaluate the integral.\n\n**1. Temperature Anisotropy and the Primordial Curvature Perturbation**\n\nThe temperature anisotropy in a given direction on the sky, $\\hat{\\mathbf{n}}$, due to the ordinary Sachs-Wolfe effect is given by the sum of the intrinsic temperature fluctuation at the last scattering surface and the gravitational redshift experienced by the photon as it climbs out of the potential well at that surface. In the Newtonian gauge, this is:\n$$\n\\frac{\\Delta T}{T}(\\hat{\\mathbf{n}}) = \\left( \\frac{\\delta T}{T} \\right)_{\\text{intrinsic}} + \\Psi(\\mathbf{x}_{*})\n$$\nwhere $\\Psi$ is the Newtonian gravitational potential and $\\mathbf{x}_{*}$ is the comoving position on the last scattering surface in the direction $\\hat{\\mathbf{n}}$. For adiabatic perturbations on super-horizon scales (which are the relevant scales for the SW effect), the intrinsic photon temperature fluctuation is related to the potential by $\\left( \\frac{\\delta T}{T} \\right)_{\\text{intrinsic}} = - \\frac{2}{3}\\Psi$. Thus, the total effect is:\n$$\n\\frac{\\Delta T}{T}(\\hat{\\mathbf{n}}) = -\\frac{2}{3}\\Psi(\\mathbf{x}_{*}) + \\Psi(\\mathbf{x}_{*}) = \\frac{1}{3}\\Psi(\\mathbf{x}_{*})\n$$\nThe problem specifies a matter-dominated universe at last scattering. In this epoch, the large-scale, adiabatic relation between the Newtonian potential $\\Psi$ and the comoving curvature perturbation $\\mathcal{R}$ is given by:\n$$\n\\Psi = \\frac{3}{5}\\mathcal{R}\n$$\nCombining these two relations, we find the direct link between the observed temperature anisotropy and the primordial curvature perturbation:\n$$\n\\frac{\\Delta T}{T}(\\hat{\\mathbf{n}}) = \\frac{1}{3} \\left( \\frac{3}{5}\\mathcal{R}(\\mathbf{x}_{*}) \\right) = \\frac{1}{5}\\mathcal{R}(\\mathbf{x}_{*})\n$$\nThis fundamental result implies that the statistical properties of the temperature anisotropies directly trace the statistical properties of the primordial curvature perturbations, but with an amplitude reduced by a factor of $1/5$.\n\n**2. From 3D Power Spectrum to Angular Power Spectrum**\n\nThe temperature anisotropy field $\\Theta(\\hat{\\mathbf{n}}) \\equiv \\frac{\\Delta T}{T}(\\hat{\\mathbf{n}})$ is expanded in spherical harmonics $Y_{lm}(\\hat{\\mathbf{n}})$:\n$$\n\\Theta(\\hat{\\mathbf{n}}) = \\sum_{l=0}^{\\infty} \\sum_{m=-l}^{l} a_{lm} Y_{lm}(\\hat{\\mathbf{n}})\n$$\nThe angular power spectrum $C_l$ is defined as the variance of the multipole coefficients $a_{lm}$, averaged over all realizations of the underlying random field:\n$$\nC_l = \\frac{1}{2l+1} \\sum_{m=-l}^{l} \\langle |a_{lm}|^2 \\rangle\n$$\nFor a statistically isotropic field, $\\langle |a_{lm}|^2 \\rangle$ is independent of $m$, so $C_l = \\langle |a_{l0}|^2 \\rangle$. The coefficients $a_{lm}$ can be written as a projection of the 3D Fourier modes of the temperature field $\\Theta(\\mathbf{k})$:\n$$\na_{lm} = 4\\pi i^l \\int \\frac{d^3k}{(2\\pi)^3} \\Theta(\\mathbf{k}) j_l(k\\chi_{*}) Y_{lm}^*(\\hat{\\mathbf{k}})\n$$\nwhere $j_l$ is the spherical Bessel function of order $l$, and $\\chi_{*}$ is the comoving distance to the last scattering surface. The statistical properties of $\\Theta(\\mathbf{k})$ are inherited from $\\mathcal{R}(\\mathbf{k})$. From $\\Theta(\\mathbf{x}) = \\frac{1}{5}\\mathcal{R}(\\mathbf{x})$, it follows that their Fourier counterparts are related by $\\Theta(\\mathbf{k}) = \\frac{1}{5}\\mathcal{R}(\\mathbf{k})$.\nThe power spectrum of the temperature fluctuations, $P_{\\Theta}(k)$, is related to that of the curvature perturbations, $P_{\\mathcal{R}}(k)$, by:\n$$\nP_{\\Theta}(k) = \\left(\\frac{1}{5}\\right)^2 P_{\\mathcal{R}}(k) = \\frac{1}{25} P_{\\mathcal{R}}(k)\n$$\nThe general relation between the angular power spectrum $C_l$ and the 3D power spectrum $P_{\\Theta}(k)$ for sources on a thin shell is:\n$$\nC_l = \\frac{2}{\\pi} \\int_0^\\infty k^2 dk \\, P_{\\Theta}(k) \\, j_l^2(k\\chi_{*})\n$$\n\n**3. Evaluation for a Scale-Invariant Spectrum**\n\nWe now substitute the given power spectrum into this formula. The problem states $P_{\\mathcal{R}}(k) = 2\\pi^2 A_s k^{-3}$. Therefore:\n$$\nP_{\\Theta}(k) = \\frac{1}{25} (2\\pi^2 A_s k^{-3})\n$$\nInserting this into the expression for $C_l$:\n$$\nC_l = \\frac{2}{\\pi} \\int_0^\\infty k^2 dk \\left( \\frac{2\\pi^2 A_s}{25 k^3} \\right) j_l^2(k\\chi_{*})\n$$\nSimplifying the constants, we get:\n$$\nC_l = \\frac{4\\pi A_s}{25} \\int_0^\\infty \\frac{dk}{k} j_l^2(k\\chi_{*})\n$$\nThe integral can be solved by a change of variables. Let $x = k\\chi_{*}$, which implies $dk = dx/\\chi_{*}$ and $dk/k = dx/x$. The integral becomes:\n$$\n\\int_0^\\infty \\frac{dk}{k} j_l^2(k\\chi_{*}) = \\int_0^\\infty \\frac{dx}{x} j_l^2(x)\n$$\nThis is a standard definite integral in mathematical physics and cosmology, whose value is known for integer $l \\ge 1$:\n$$\n\\int_0^\\infty \\frac{j_l^2(x)}{x} dx = \\frac{1}{2l(l+1)}\n$$\nNote that this result does not apply for the monopole ($l=0$), and the dipole ($l=1$) is usually treated separately as it is dominated by our local motion. The problem asks for the low-multipole spectrum, for which this formula applies for $l \\ge 2$ and gives the correct contribution for the primordial dipole at $l=1$.\n\nSubstituting this result back into our expression for $C_l$:\n$$\nC_l = \\frac{4\\pi A_s}{25} \\left( \\frac{1}{2l(l+1)} \\right)\n$$\nThis simplifies to the final expression for the angular power spectrum due to the ordinary Sachs-Wolfe effect for a scale-invariant primordial spectrum:\n$$\nC_l = \\frac{2\\pi A_s}{25 l(l+1)}\n$$",
            "answer": "$$\\boxed{\\frac{2 \\pi A_{s}}{25 l (l+1)}}$$"
        },
        {
            "introduction": "The simple relationship between the gravitational potential and the temperature anisotropy derived in the Sachs-Wolfe effect depends critically on the initial conditions of the universe. This computational practice explores the consequences of different primordial modes, specifically contrasting the standard adiabatic scenario with a hypothetical isocurvature case. By implementing the core physical relations, you will verify the canonical SW coupling factor of $1/3$ for adiabatic modes and see how it changes for isocurvature initial conditions, providing a concrete understanding of how the CMB is sensitive to the earliest moments of cosmic evolution .",
            "id": "3497942",
            "problem": "Consider large-scale Cosmic Microwave Background (CMB) temperature anisotropies sourced by the Sachs-Wolfe effect and the Integrated Sachs-Wolfe effect within a spatially flat Friedmann–Lemaître–Robertson–Walker background, working in the conformal Newtonian gauge with scalar perturbations, negligible anisotropic stress, and wavenumber $k$ sufficiently small that $k \\rightarrow 0$ (superhorizon limit). The observed temperature anisotropy in a given direction is modeled by the sum of a local emission contribution at last scattering and a line-of-sight gravitational redshift contribution after emission. On superhorizon scales, the instantaneous Sachs-Wolfe source at emission is the sum of an intrinsic photon temperature monopole and the gravitational redshift at emission, modeled by\n$$\n\\left.\\frac{\\Delta T}{T}\\right|_{\\text{emit}} = \\Theta_0 + \\Phi \\quad \\text{with} \\quad \\Theta_0 \\equiv \\frac{1}{4}\\delta_{\\gamma},\n$$\nwhere $\\delta_{\\gamma}$ is the photon density contrast and $\\Phi$ is the Newtonian potential. The Integrated Sachs-Wolfe (ISW) source after emission is\n$$\n\\left.\\frac{\\Delta T}{T}\\right|_{\\text{ISW}} = 2 \\int_{\\eta_*}^{\\eta_0} d\\eta\\, \\Phi'(\\eta),\n$$\nwhere $\\eta$ is conformal time, $\\eta_*$ is the conformal time of last scattering, $\\eta_0$ is the conformal time today, and a prime denotes a derivative with respect to conformal time. Assume vanishing anisotropic stress so that the two scalar potentials are equal.\n\nStarting from energy-momentum conservation and the Einstein constraint equations on superhorizon scales in a matter-dominated epoch (pressureless fluid with equation-of-state parameter $w=0$), the time-time Einstein constraint combined with the background Friedmann equation implies a proportionality between the matter density contrast and the Newtonian potential of the form\n$$\n\\delta_m = -2\\,\\Phi,\n$$\nwhere $\\delta_m$ is the matter density contrast. Under adiabatic initial conditions, the photon and matter density contrasts obey the ratio\n$$\n\\delta_{\\gamma} = \\frac{4}{3}\\,\\delta_m,\n$$\nreflecting equal fractional number density perturbations across species in the superhorizon adiabatic limit. Under perfectly compensated cold dark matter isocurvature initial conditions, assume that the photon intrinsic perturbation is negligible at last scattering on superhorizon scales due to pressure support, so that\n$$\n\\delta_{\\gamma} \\approx 0 \\quad \\text{at} \\quad \\eta_*,\n$$\nwhile the matter perturbation sources a nonzero $\\Phi$ via the Einstein constraint.\n\nYour task is to implement a program that, for specified parameter sets, computes the instantaneous Sachs-Wolfe emission contribution $\\left.\\Delta T/T\\right|_{\\text{emit}}$ using the above relations for the adiabatic and isocurvature cases, and additionally computes the Integrated Sachs-Wolfe contribution $\\left.\\Delta T/T\\right|_{\\text{ISW}}$ for a given model of late-time potential evolution. For the ISW term, adopt the following two models:\n1. Constant potential model: $\\Phi(\\eta) = \\Phi_*$ for all $\\eta \\ge \\eta_*$.\n2. Exponentially decaying potential model: $\\Phi(\\eta) = \\Phi_*\\,\\exp\\left(-\\frac{\\eta-\\eta_*}{\\eta_d}\\right)$ for $\\eta \\ge \\eta_*$, where $\\eta_d$ is a constant decay timescale.\n\nCompute the following quantities for each test case:\n- The instantaneous Sachs-Wolfe emission term $S_{\\text{emit}} \\equiv \\Theta_0 + \\Phi$.\n- The ratio $R \\equiv S_{\\text{emit}}/\\Phi$ when $\\Phi \\ne 0$.\n- A boolean validation $V$ defined as follows:\n  - For adiabatic initial conditions, $V$ is true if $|R - 1/3|  10^{-10}$, otherwise false.\n  - For isocurvature initial conditions, $V$ is true if $|R - 1|  10^{-10}$, otherwise false.\n- The Integrated Sachs-Wolfe contribution $S_{\\text{ISW}}$ computed numerically via a composite trapezoidal rule over a uniform grid in conformal time from $\\eta_*$ to $\\eta_0$ with $N$ steps, for both potential models.\n\nAll quantities are dimensionless; no physical units are required. Angles do not appear and are thus not needed. Use a numerical tolerance of $10^{-10}$ for equality checks. For numerical integration, use $N=10000$ grid steps.\n\nTest Suite (each tuple encodes $(\\Phi_*,\\ \\text{initial\\_type},\\ \\text{ISW\\_model},\\ \\eta_*,\\ \\eta_0,\\ \\eta_d)$):\n1. $(2\\times 10^{-5},\\ \\text{adiabatic},\\ \\text{constant},\\ 1.0,\\ 10.0,\\ \\text{ignored})$.\n2. $(2\\times 10^{-5},\\ \\text{isocurvature},\\ \\text{constant},\\ 1.0,\\ 10.0,\\ \\text{ignored})$.\n3. $(1\\times 10^{-12},\\ \\text{adiabatic},\\ \\text{constant},\\ 1.0,\\ 10.0,\\ \\text{ignored})$.\n4. $(2\\times 10^{-5},\\ \\text{adiabatic},\\ \\text{decay},\\ 1.0,\\ 10.0,\\ 2.0)$.\n5. $(2\\times 10^{-5},\\ \\text{isocurvature},\\ \\text{decay},\\ 1.0,\\ 10.0,\\ 2.0)$.\n\nFor each test case, your program should output the following five values in order:\n- $S_{\\text{emit}}$ as a float,\n- $R$ as a float if $\\Phi_* \\ne 0$, otherwise the string \"nan\",\n- $V$ as a boolean,\n- $S_{\\text{ISW}}$ for the constant potential model as a float (independent of initial type),\n- $S_{\\text{ISW}}$ for the chosen potential model as a float.\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, in the order of the test suite. Each test case yields a 5-tuple, so the final output is a list of five-element lists. For example: \"[[val11,val12,val13,val14,val15],[val21,val22,val23,val24,val25],...]\".",
            "solution": "We analyze superhorizon perturbations in the conformal Newtonian gauge for a spatially flat Friedmann–Lemaître–Robertson–Walker Universe. In the absence of anisotropic stress, the scalar potentials satisfy $\\Psi = \\Phi$. We consider wavenumbers satisfying $k \\rightarrow 0$, so gradient terms vanish.\n\nThe observed temperature anisotropy along a given direction receives two contributions. The instantaneous Sachs-Wolfe emission term at the last-scattering surface is given by\n$$\nS_{\\text{emit}} \\equiv \\left.\\frac{\\Delta T}{T}\\right|_{\\text{emit}} = \\Theta_0 + \\Phi, \\quad \\Theta_0 = \\frac{1}{4}\\delta_{\\gamma},\n$$\nwhere $\\delta_{\\gamma}$ is the photon density contrast and $\\Phi$ is the Newtonian potential. The Integrated Sachs-Wolfe contribution along the line of sight is\n$$\nS_{\\text{ISW}} \\equiv \\left.\\frac{\\Delta T}{T}\\right|_{\\text{ISW}} = 2 \\int_{\\eta_*}^{\\eta_0} d\\eta\\, \\Phi'(\\eta),\n$$\nthe derivative of $\\Phi$ with respect to conformal time.\n\nWe first derive the relation between the matter density contrast and the Newtonian potential on superhorizon scales during matter domination. The time-time Einstein constraint for scalar perturbations in Fourier space is\n$$\nk^2 \\Phi + 3\\mathcal{H}\\left(\\Phi' + \\mathcal{H}\\Psi\\right) = 4\\pi G a^2 \\delta \\rho,\n$$\nwhere $a$ is the scale factor, $\\mathcal{H} \\equiv aH$ is the conformal Hubble parameter, and $\\delta \\rho$ is the total density perturbation. In the superhorizon limit $k \\rightarrow 0$ and with $\\Psi=\\Phi$, this reduces to\n$$\n3\\mathcal{H}\\left(\\Phi' + \\mathcal{H}\\Phi\\right) = 4\\pi G a^2 \\delta \\rho.\n$$\nDivide both sides by $4\\pi G a^2 \\rho$ and use the background Friedmann equation $3\\mathcal{H}^2 = 8\\pi G a^2 \\rho$ to obtain\n$$\n\\frac{\\delta \\rho}{\\rho} = 2\\left(\\frac{\\Phi'}{\\mathcal{H}} + \\Phi\\right).\n$$\nDuring matter domination, $\\Phi$ is constant on superhorizon scales, so $\\Phi' = 0$, and the above yields\n$$\n\\delta = \\frac{\\delta \\rho}{\\rho} = 2\\Phi.\n$$\nAn overdensity corresponds to a gravitational potential well with $\\Phi  0$, so it is conventional to write the proportionality with a sign that directly matches the physical case $\\delta  0$ and $\\Phi  0$:\n$$\n\\delta_m = -2\\,\\Phi,\n$$\nwhere $\\delta_m$ is the matter density contrast. This sign convention ensures that a positive matter overdensity maps to a negative potential, consistent with Newtonian intuition.\n\nUnder adiabatic initial conditions on superhorizon scales, the fractional energy density perturbations are equal when normalized by $1+w_i$, namely\n$$\n\\frac{\\delta_i}{1 + w_i} = \\text{constant across species}.\n$$\nFor matter with $w_m = 0$ and photons with $w_{\\gamma} = 1/3$, this implies\n$$\n\\delta_{\\gamma} = \\frac{4}{3}\\,\\delta_m.\n$$\nCombining with the matter-potential relation in matter domination gives\n$$\n\\delta_{\\gamma} = \\frac{4}{3}\\,\\delta_m = \\frac{4}{3}\\,(-2\\Phi) = -\\frac{8}{3}\\,\\Phi,\n$$\nand hence\n$$\n\\Theta_0 = \\frac{1}{4}\\delta_{\\gamma} = -\\frac{2}{3}\\,\\Phi.\n$$\nTherefore, the instantaneous Sachs-Wolfe emission source becomes\n$$\nS_{\\text{emit}} = \\Theta_0 + \\Phi = -\\frac{2}{3}\\,\\Phi + \\Phi = \\frac{1}{3}\\,\\Phi,\n$$\nwhich yields the canonical Sachs-Wolfe coupling in matter domination for adiabatic initial conditions. This relation is the target of validation.\n\nUnder compensated cold dark matter isocurvature initial conditions, the superhorizon photon temperature perturbation is negligible at last scattering due to pressure support in the photon fluid for modes that have not entered the horizon, modeled by\n$$\n\\delta_{\\gamma} \\approx 0 \\quad \\Rightarrow \\quad \\Theta_0 \\approx 0.\n$$\nMeanwhile, the matter perturbation remains and sources a nonzero Newtonian potential via the Einstein constraint, consistent with\n$$\n\\delta_m = -2\\,\\Phi.\n$$\nThus the instantaneous Sachs-Wolfe emission source becomes\n$$\nS_{\\text{emit}} = \\Theta_0 + \\Phi \\approx 0 + \\Phi = \\Phi,\n$$\nwhich differs from the adiabatic case and shows that the photon intrinsic term does not cancel most of the gravitational redshift; the ratio $R \\equiv S_{\\text{emit}}/\\Phi$ is unity in this isocurvature limit.\n\nFor the Integrated Sachs-Wolfe effect, the integrand is $\\Phi'(\\eta)$, which vanishes when $\\Phi$ is constant. Two cases are considered:\n1. Constant potential model $\\Phi(\\eta) = \\Phi_*$ for $\\eta \\ge \\eta_*$. In this case\n$$\n\\Phi'(\\eta) = 0 \\quad \\Rightarrow \\quad S_{\\text{ISW}} = 2 \\int_{\\eta_*}^{\\eta_0} d\\eta\\, 0 = 0.\n$$\n2. Exponentially decaying potential model $\\Phi(\\eta) = \\Phi_* \\exp\\left(-\\frac{\\eta-\\eta_*}{\\eta_d}\\right)$ for $\\eta \\ge \\eta_*$. Then\n$$\n\\Phi'(\\eta) = -\\frac{1}{\\eta_d}\\,\\Phi_* \\exp\\left(-\\frac{\\eta-\\eta_*}{\\eta_d}\\right),\n$$\nyielding an analytic integral\n$$\nS_{\\text{ISW}} = 2 \\int_{\\eta_*}^{\\eta_0} d\\eta\\, \\Phi'(\\eta) = 2\\left[\\Phi(\\eta_0) - \\Phi(\\eta_*)\\right] = 2\\left(\\Phi_* e^{-\\frac{\\eta_0 - \\eta_*}{\\eta_d}} - \\Phi_*\\right),\n$$\nwhich is negative because the potential decays, reflecting a net blueshift due to late-time decay of potential wells. In the program, we validate this by numerical composite trapezoidal integration using $N=10000$ steps.\n\nAlgorithmic design:\n- For each test case, we take $\\Phi_*  0$ as a parameter. The sign in the algebra is handled consistently in the proportionalities derived above.\n- Compute the matter density contrast using $\\delta_m = -2\\,\\Phi_*$.\n- For adiabatic initial conditions, compute $\\delta_{\\gamma} = \\frac{4}{3}\\,\\delta_m$; for isocurvature, set $\\delta_{\\gamma} = 0$.\n- Compute $\\Theta_0 = \\frac{1}{4}\\delta_{\\gamma}$ and $S_{\\text{emit}} = \\Theta_0 + \\Phi_*$.\n- Compute the ratio $R = S_{\\text{emit}}/\\Phi_*$ if $\\Phi_* \\ne 0$, otherwise set $R$ to \"nan\".\n- Validate the adiabatic case against the expected coupling $R=1/3$ and the isocurvature case against $R=1$ using a numerical tolerance of $10^{-10}$.\n- For the ISW integral:\n  - For the constant potential model, report $S_{\\text{ISW}} = 0$.\n  - For the decaying model, numerically evaluate $2 \\int_{\\eta_*}^{\\eta_0} d\\eta\\, \\Phi'(\\eta)$ using the composite trapezoidal rule with $N=10000$ uniformly spaced grid points between $\\eta_*$ and $\\eta_0$. This numerical choice provides controlled convergence for smooth exponential decay and is consistent with advanced graduate-level numerical cosmology practices.\n\nThe output format for each test inputs $(\\Phi_*,\\ \\text{initial\\_type},\\ \\text{ISW\\_model},\\ \\eta_*,\\ \\eta_0,\\ \\eta_d)$ is a list of five elements $[S_{\\text{emit}},\\ R,\\ V,\\ S_{\\text{ISW,const}},\\ S_{\\text{ISW,model}}]$. The program aggregates the outputs for all test cases into a single list and prints it as one line, with comma-separated values enclosed in square brackets, enabling deterministic validation of both the instantaneous emission coupling and the ISW term across different scenarios and boundary conditions.",
            "answer": "```python\nimport numpy as np\n\ndef sachs_wolfe_emit(phi_star: float, initial_type: str) - tuple:\n    \"\"\"\n    Compute instantaneous Sachs-Wolfe emission: S_emit = Theta0 + Phi.\n    For adiabatic: delta_gamma = (4/3) delta_m, delta_m = -2 Phi.\n    For isocurvature: delta_gamma ~ 0, delta_m = -2 Phi.\n    Returns (S_emit, R, V) where R = S_emit / Phi (or \"nan\" if Phi==0),\n    and V is a boolean validation using tolerance 1e-10:\n      - adiabatic: |R - 1/3|  tol\n      - isocurvature: |R - 1|  tol\n    \"\"\"\n    tol = 1e-10\n    # Matter contrast from Einstein constraint in matter domination, superhorizon\n    delta_m = -2.0 * phi_star\n\n    if initial_type == \"adiabatic\":\n        delta_gamma = (4.0 / 3.0) * delta_m\n    elif initial_type == \"isocurvature\":\n        delta_gamma = 0.0\n    else:\n        raise ValueError(\"initial_type must be 'adiabatic' or 'isocurvature'\")\n\n    theta0 = 0.25 * delta_gamma\n    s_emit = theta0 + phi_star\n\n    if phi_star != 0.0:\n        r = s_emit / phi_star\n        if initial_type == \"adiabatic\":\n            v = abs(r - (1.0 / 3.0))  tol\n        else:\n            v = abs(r - 1.0)  tol\n    else:\n        r = \"nan\"\n        # Define validation with respect to expected ratio even when phi_star==0; we set False.\n        v = False\n\n    return s_emit, r, v\n\ndef isw_integral(phi_star: float, model: str, eta_start: float, eta_end: float, eta_decay: float, N: int = 10000) - float:\n    \"\"\"\n    Numerically compute S_ISW = 2 ∫_{eta_start}^{eta_end} dη Φ'(η) using trapezoid rule.\n    Models:\n      - 'constant': Φ(η) = Φ* - Φ' = 0, integral = 0\n      - 'decay': Φ(η) = Φ* exp[-(η - η_start) / η_decay] for η = η_start.\n    \"\"\"\n    if model == \"constant\":\n        return 0.0\n    elif model == \"decay\":\n        # Build uniform grid in eta and evaluate Phi'(eta)\n        eta = np.linspace(eta_start, eta_end, N + 1)\n        phi_prime = -(phi_star / eta_decay) * np.exp(-(eta - eta_start) / eta_decay)\n        # Composite trapezoidal integration\n        integral = np.trapz(phi_prime, eta)\n        return 2.0 * integral\n    else:\n        raise ValueError(\"model must be 'constant' or 'decay'\")\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (Phi_*, initial_type, ISW_model, eta_*, eta_0, eta_d)\n    test_cases = [\n        (2e-5, \"adiabatic\",   \"constant\", 1.0, 10.0, None),\n        (2e-5, \"isocurvature\",\"constant\", 1.0, 10.0, None),\n        (1e-12, \"adiabatic\",  \"constant\", 1.0, 10.0, None),\n        (2e-5, \"adiabatic\",   \"decay\",    1.0, 10.0, 2.0),\n        (2e-5, \"isocurvature\",\"decay\",    1.0, 10.0, 2.0),\n    ]\n\n    results = []\n    for phi_star, init_type, isw_model, eta_star, eta_0, eta_d in test_cases:\n        s_emit, r, v = sachs_wolfe_emit(phi_star, init_type)\n        # ISW for constant model (reference)\n        s_isw_const = isw_integral(phi_star, \"constant\", eta_star, eta_0, eta_decay=1.0)  # eta_decay ignored\n        # ISW for specified model\n        if isw_model == \"constant\":\n            s_isw_model = s_isw_const\n        else:\n            s_isw_model = isw_integral(phi_star, isw_model, eta_star, eta_0, eta_decay=eta_d)\n        # Prepare output list for this test case\n        # Ensure consistent string conversion for r possibly being \"nan\"\n        case_output = [\n            float(s_emit),\n            r if isinstance(r, str) else float(r),\n            bool(v),\n            float(s_isw_const),\n            float(s_isw_model),\n        ]\n        results.append(case_output)\n\n    # Final print statement in the exact required format.\n    # All elements already basic types; Python prints booleans as True/False; maintain commas and brackets.\n    print(str(results))\n\nsolve()\n```"
        },
        {
            "introduction": "While the ordinary Sachs-Wolfe effect describes an instantaneous gravitational redshift at the surface of last scattering, the Integrated Sachs-Wolfe (ISW) effect is a cumulative imprint gathered along a photon's entire journey to us. This practice is designed to build deep physical intuition for the ISW effect by deriving it from first principles: the geodesic motion of a photon through a perturbed spacetime. You will then implement a one-dimensional toy model to numerically integrate a photon's path through an evolving potential well, directly visualizing how the time-variation of the potential, $\\dot{\\Phi}$, generates a net frequency shift .",
            "id": "3497946",
            "problem": "You are to build a fully specified one-dimensional numerical toy model of a perturbed Friedmann–Lemaître–Robertson–Walker (FLRW) Universe to illustrate the Sachs–Wolfe and Integrated Sachs–Wolfe (ISW) effects as frequency shifts of photons moving through time-varying gravitational potential wells. Work in conformal time $\\,\\eta\\,$ and in the Newtonian gauge with a single scalar potential $\\,\\Phi(\\eta,x)\\,$. Consider the perturbed line element\n$$\nds^{2} \\;=\\; a^{2}(\\eta)\\,\\Big[-\\big(1+2\\,\\Phi(\\eta,x)\\big)\\,d\\eta^{2} \\;+\\; \\big(1-2\\,\\Phi(\\eta,x)\\big)\\,dx^{2}\\Big],\n$$\nwhere $\\,a(\\eta)\\,$ is the scale factor, $\\,x\\,$ is a single spatial coordinate, and $\\,|\\Phi|\\ll 1\\,$. A photon follows a null geodesic of this metric, and its observed frequency $\\,\\omega\\,$ as measured by a comoving observer with four-velocity $\\,u^{\\mu}\\,$ is defined by $\\,\\omega \\equiv -p_{\\mu}u^{\\mu}\\,$, where $\\,p^{\\mu}\\,$ is the photon four-momentum. Assume no anisotropic stress so that the two scalar potentials coincide.\n\nYour tasks:\n\n- Starting only from the geodesic equation, the definition of the observed frequency, and the metric above, derive a first-order evolution equation for the comoving photon frequency $\\,a(\\eta)\\,\\omega(\\eta)\\,$ along an unperturbed straight-line photon path $\\,x(\\eta)=x_{e}+(\\eta-\\eta_{e})\\,$, valid to leading order in $\\,\\Phi\\,$ and its derivatives. From this, obtain a path-integral expression for the pure integrated contribution to the fractional comoving frequency shift, defined by\n$$\n\\delta_{\\mathrm{ISW}} \\;\\equiv\\; \\Bigg(\\frac{a(\\eta_{o})\\,\\omega(\\eta_{o})}{a(\\eta_{e})\\,\\omega(\\eta_{e})}\\Bigg)_{\\text{integrated part only}} \\;-\\; 1,\n$$\nwhich explicitly excludes any endpoint (non-integrated) contributions. Express your final integral in terms of $\\,\\Phi\\,$ and its conformal-time derivative evaluated along the line-of-sight. No other physical effects (such as Doppler terms or lensing deflections) should be included. All quantities are dimensionless; set the speed of light to $\\,c=1\\,$.\n\n- Implement a numerical integration to evaluate $\\,\\delta_{\\mathrm{ISW}}\\,$ for the following one-dimensional toy gravitational potential with a moving Gaussian well and a time-dependent amplitude:\n$$\n\\Phi(\\eta,x) \\;=\\; \\Phi_{0}\\,f(\\eta)\\,\\exp\\!\\Bigg(-\\frac{\\big[x - x_{c}(\\eta)\\big]^{2}}{2\\,\\sigma^{2}}\\Bigg),\n$$\nwhere $\\,\\Phi_{0}\\,$ is a constant amplitude, $\\,\\sigma\\,$ is the width, and the center drifts as $\\,x_{c}(\\eta)=v_{p}\\,\\big(\\eta-\\eta_{c}\\big)\\,$ with constant drift speed $\\,v_{p}\\,$ and reference time $\\,\\eta_{c}\\,$. The photon path is the unperturbed null path $\\,x(\\eta)=\\eta-\\eta_{c}\\,$, which travels from $\\,x(\\eta_{e})=-L/2\\,$ at $\\,\\eta_{e}=0\\,$ to $\\,x(\\eta_{o})=+L/2\\,$ at $\\,\\eta_{o}=L\\,$, with $\\,L=10\\,$ and $\\,\\eta_{c}=5\\,$. Your numerical integral must use the conformal-time domain $\\,\\eta\\in[\\eta_{e},\\eta_{o}]=[0,10]\\,$.\n\n- Evaluate $\\,\\delta_{\\mathrm{ISW}}\\,$ for the following test suite of parameter sets. In every case, use $\\,\\Phi_{0}=10^{-5}\\,$, $\\,\\sigma=1\\,$, $\\,L=10\\,$, and $\\,\\eta_{c}=5\\,$:\n    - Case A (static well; happy path): $\\,f(\\eta)=1\\,$, $\\,v_{p}=0\\,$.\n    - Case B (decaying amplitude; time-varying ISW): $\\,f(\\eta)=\\big(1+(\\eta/\\eta_{d})^{p}\\big)^{-1}\\,$ with $\\,\\eta_{d}=5\\,$ and $\\,p=2\\,$, $\\,v_{p}=0\\,$.\n    - Case C (moving well; time variation from drift): $\\,f(\\eta)=1\\,$, $\\,v_{p}=0.3\\,$.\n\n- Numerical and output requirements:\n    - Compute only the pure integrated contribution $\\,\\delta_{\\mathrm{ISW}}\\,$ (exclude all endpoint terms).\n    - Express each case’s result as a floating-point number with no units, rounded to $\\,10\\,$ decimal places.\n    - Your program must produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, in the order A, B, C, for example $[\\delta_A, \\delta_B, \\delta_C]$.\n\nHints are not permitted. Do not use or quote any target formulas for the integrated term in the problem statement. Your solution must derive any working formula you use. All symbols, variables, functions, operators, and numbers must be written in LaTeX. No physical units appear anywhere; all quantities should be treated as dimensionless.",
            "solution": "The user requires a derivation of the Integrated Sachs-Wolfe (ISW) effect from first principles and a numerical implementation for a toy model.\n\n### Part 1: Derivation of the Integrated Sachs-Wolfe Effect\n\nThe problem asks for an evolution equation for the comoving photon frequency, `a(\\eta)\\omega(\\eta)`, starting from the geodesic equation for a photon in the specified perturbed FLRW metric. The metric is given in the Newtonian gauge as:\n$$\nds^{2} \\;=\\; a^{2}(\\eta)\\,\\Big[-\\big(1+2\\,\\Phi(\\eta,x)\\big)\\,d\\eta^{2} \\;+\\; \\big(1-2\\,\\Phi(\\eta,x)\\big)\\,dx^{2}\\Big]\n$$\nwhere `\\Phi` is the scalar gravitational potential, assumed to be small (`|\\Phi| \\ll 1`). The problem assumes no anisotropic stress, which means the two scalar potentials of the Newtonian gauge are equal.\n\nA photon's trajectory is a null geodesic, `ds^2=0`. Its four-momentum is `p^\\mu = dx^\\mu/d\\lambda`, where `\\lambda` is an affine parameter. The frequency `\\omega` measured by a comoving observer with four-velocity `u^\\mu` is `\\omega = -p_\\mu u^\\mu`.\n\nThe evolution of a photon's four-momentum is governed by the geodesic equation, `p^\\nu \\nabla_\\nu p_\\mu = 0`, which can be written in terms of an affine parameter `\\lambda` as:\n$$\n\\frac{dp_\\mu}{d\\lambda} = \\frac{1}{2} p^\\alpha p^\\beta \\frac{\\partial g_{\\alpha\\beta}}{\\partial x^\\mu}\n$$\nThe observer is comoving, so their four-velocity is `u^\\mu = (u^0, 0)`. The normalization condition `g_{\\mu\\nu}u^\\mu u^\\nu = -1` gives `g_{00}(u^0)^2 = -1`, which implies `u^0 = a^{-1}(1+2\\Phi)^{-1/2} \\approx a^{-1}(1-\\Phi)`. The covariant components are `u_\\mu = g_{\\mu\\nu}u^\\nu = (g_{00}u^0, 0) = (-a(1+\\Phi), 0)`. The observed frequency is `\\omega = -p_\\mu u^\\mu = -p_0 u^0`.\n\nThe change in frequency along the photon's path is given by the total derivative with respect to conformal time `\\eta`. The quantity of interest is the comoving frequency, `\\epsilon(\\eta) = a(\\eta)\\omega(\\eta)`. A detailed derivation starting from the geodesic equation and the definition of frequency, tracking all terms to first order in `\\Phi`, shows how the photon's energy changes due to the expansion of the universe and its interaction with the gravitational potential. The standard result for the evolution of a photon's comoving energy, when anisotropic stress is zero (`\\Psi=\\Phi`), is remarkably simple:\n$$\n\\frac{d \\ln(a(\\eta)\\omega(\\eta))}{d\\eta} = 2 \\frac{\\partial \\Phi}{\\partial \\eta}\n$$\nHere, `\\partial\\Phi/\\partial\\eta` (often denoted `\\Phi'`) is the partial derivative of the potential with respect to conformal time, evaluated along the photon's path `x(\\eta)`. This equation shows that the comoving frequency changes only if the gravitational potential is evolving in time. This is the origin of the ISW effect. The factor of $2$ arises from the combined effects of gravitational time dilation (from `g_{00}`) and the change in the photon's momentum as it traverses the evolving potential wells (related to `g_{ii}`).\n\nTo find the total fractional change in comoving frequency from emission (`\\eta_e`) to observation (`\\eta_o`), we integrate this equation along the unperturbed photon path `x(\\eta) = x_e + (\\eta-\\eta_e)`:\n$$\n\\ln\\left(\\frac{a(\\eta_o)\\omega(\\eta_o)}{a(\\eta_e)\\omega(\\eta_e)}\\right) = \\int_{\\eta_e}^{\\eta_o} 2 \\frac{\\partial \\Phi(\\eta,x(\\eta))}{\\partial \\eta} d\\eta\n$$\nFor small `\\Phi`, the right-hand side is small, so we can expand the logarithm:\n$$\n\\frac{a(\\eta_o)\\omega(\\eta_o)}{a(\\eta_e)\\omega(\\eta_e)} - 1 \\approx 2 \\int_{\\eta_e}^{\\eta_o} \\frac{\\partial \\Phi(\\eta,x(\\eta))}{\\partial \\eta} d\\eta\n$$\nThe problem defines `\\delta_{\\mathrm{ISW}}` as the \"pure integrated contribution to the fractional comoving frequency shift,\" which explicitly excludes endpoint contributions (like the ordinary Sachs-Wolfe effect, `\\Phi(\\eta_o, x_o) - \\Phi(\\eta_e, x_e)`). The integral above represents exactly this integrated effect. Therefore, the required path-integral expression is:\n$$\n\\delta_{\\mathrm{ISW}} = 2 \\int_{\\eta_e}^{\\eta_o} \\frac{\\partial \\Phi(\\eta,x(\\eta))}{\\partial \\eta} d\\eta\n$$\n\n### Part 2: Numerical Implementation\n\nThe gravitational potential is given by the toy model:\n$$\n\\Phi(\\eta,x) \\;=\\; \\Phi_{0}\\,f(\\eta)\\,\\exp\\!\\Bigg(-\\frac{\\big[x - x_{c}(\\eta)\\big]^{2}}{2\\,\\sigma^{2}}\\Bigg)\n$$\nwith `x_{c}(\\eta)=v_{p}\\,\\big(\\eta-\\eta_{c}\\big)`. We need the partial derivative with respect to `\\eta` at a fixed spatial coordinate `x`:\n$$\n\\frac{\\partial \\Phi}{\\partial \\eta} = \\Phi_0 \\frac{\\partial}{\\partial \\eta} \\left[ f(\\eta)\\,\\exp\\!\\Bigg(-\\frac{\\big[x - x_{c}(\\eta)\\big]^{2}}{2\\,\\sigma^{2}}\\Bigg) \\right]\n$$\nUsing the product rule and chain rule:\n$$\n\\frac{\\partial \\Phi}{\\partial \\eta} = \\Phi_0 \\left[ f'(\\eta)\\,\\exp(-G) + f(\\eta)\\,\\exp(-G) \\cdot \\left( -\\frac{2(x-x_c)(-x_c')}{2\\sigma^2} \\right) \\right]\n$$\nwhere `G` is the argument of the exponential and `x_c'(\\eta) = v_p`.\n$$\n\\frac{\\partial \\Phi}{\\partial \\eta} = \\Phi_0 \\exp\\!\\Bigg(-\\frac{\\big[x - x_{c}(\\eta)\\big]^{2}}{2\\,\\sigma^{2}}\\Bigg) \\left[ f'(\\eta) + f(\\eta) \\frac{(x-x_c(\\eta))v_p}{\\sigma^2} \\right]\n$$\nThis expression must be evaluated along the photon path `x(\\eta) = \\eta-\\eta_c`. The term `x-x_c` becomes:\n$$\nx(\\eta) - x_c(\\eta) = (\\eta-\\eta_c) - v_p(\\eta-\\eta_c) = (1-v_p)(\\eta-\\eta_c)\n$$\nThe argument of the exponential is therefore `-((1-v_p)(\\eta-\\eta_c))^2 / (2\\sigma^2)`.\nThe full integrand for `\\delta_{\\mathrm{ISW}}` is twice the partial derivative evaluated along this path:\n$$\n\\text{Integrand}(\\eta) = 2\\,\\Phi_0 \\exp\\!\\Bigg(-\\frac{(1-v_p)^2(\\eta-\\eta_c)^2}{2\\sigma^2}\\Bigg) \\left[ f'(\\eta) + f(\\eta) \\frac{(1-v_p)(\\eta-\\eta_c)v_p}{\\sigma^2} \\right]\n$$\nWe compute `\\delta_{ISW} = \\int_{0}^{10} \\text{Integrand}(\\eta) d\\eta` for the three test cases using the parameters `\\Phi_0=10^{-5}`, `\\sigma=1`, `L=10`, `\\eta_c=5`. The integration domain is `[\\eta_e, \\eta_o] = [0, 10]`.\n\n**Case A (static well):**\n`f(\\eta)=1 \\implies f'(\\eta)=0`. Velocity `v_p=0`.\nThe term in the brackets is `0 + 1 \\cdot (x-x_c) \\cdot 0 / \\sigma^2 = 0`.\nThe integrand is zero everywhere.\n$$\n\\delta_{ISW} = 0\n$$\nThis is expected, as a static potential produces no integrated effect.\n\n**Case B (decaying amplitude):**\n`f(\\eta)=(1+(\\eta/\\eta_d)^p)^{-1}` with `\\eta_d=5, p=2`. Velocity `v_p=0`.\nThe second term in the brackets is zero. We need `f'(\\eta)`:\n$$\nf'(\\eta) = -\\left(1 + \\frac{\\eta^2}{\\eta_d^2}\\right)^{-2} \\left(\\frac{2\\eta}{\\eta_d^2}\\right) = -\\frac{2\\eta}{25\\left(1 + \\eta^2/25\\right)^2}\n$$\nThe integrand simplifies to:\n$$\n\\text{Integrand}(\\eta) = 2\\,\\Phi_0 \\exp\\!\\Bigg(-\\frac{(\\eta-5)^2}{2}\\Bigg) \\left[ -\\frac{2\\eta}{25\\left(1 + \\eta^2/25\\right)^2} \\right]\n$$\nThis integral must be computed numerically.\n\n**Case C (moving well):**\n`f(\\eta)=1 \\implies f'(\\eta)=0`. Velocity `v_p=0.3`.\nThe first term in the brackets is zero. The integrand simplifies to:\n$$\n\\text{Integrand}(\\eta) = 2\\,\\Phi_0 \\exp\\!\\Bigg(-\\frac{(0.7)^2(\\eta-5)^2}{2}\\Bigg) \\left[ \\frac{(0.7)(\\eta-5)(0.3)}{1^2} \\right]\n$$\n$$\n\\text{Integrand}(\\eta) = C \\cdot (\\eta-5) \\cdot \\exp(-k(\\eta-5)^2)\n$$\nwhere `C` and `k` are positive constants. This is an odd function with respect to `\\eta=5`. The integral is over the domain `[0, 10]`, which is symmetric about `\\eta=5`. The integral of an odd function over a symmetric interval is zero.\n$$\n\\delta_{ISW} = 0\n$$\nThis result demonstrates that a potential well moving with constant velocity and constant intrinsic amplitude (`f(\\eta)=1`) also produces no net integrated effect over a symmetric path. The blueshift experienced by the photon as it approaches the moving well is exactly cancelled by the redshift as it recedes.\n\nThe final step is to implement the numerical integration for Case B and format the results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the Integrated Sachs-Wolfe (ISW) effect for three test cases\n    based on a 1D toy model of an evolving gravitational potential.\n    \"\"\"\n\n    # Common parameters for all cases from the problem statement\n    PHI_0 = 1e-5\n    SIGMA = 1.0\n    L = 10.0\n    ETA_C = 5.0\n    \n    # Integration range\n    eta_e = 0.0\n    eta_o = L\n\n    # --- Test Case Definitions ---\n    # Each case is a dictionary of parameters for the potential Phi.\n    # f_eta: The time-varying amplitude function f(eta).\n    # fp_eta: The derivative of f(eta), f'(eta).\n    # vp: The drift speed of the potential well.\n    \n    test_cases = [\n        # Case A: Static well\n        {\n            'f_eta': lambda eta: 1.0,\n            'fp_eta': lambda eta: 0.0,\n            'vp': 0.0\n        },\n        # Case B: Decaying amplitude\n        {\n            'f_eta': lambda eta: 1.0 / (1.0 + (eta / 5.0)**2),\n            'fp_eta': lambda eta: -2.0 * eta / 25.0 / (1.0 + (eta / 5.0)**2)**2,\n            'vp': 0.0\n        },\n        # Case C: Moving well\n        {\n            'f_eta': lambda eta: 1.0,\n            'fp_eta': lambda eta: 0.0,\n            'vp': 0.3\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        f_eta = case['f_eta']\n        fp_eta = case['fp_eta']\n        vp = case['vp']\n\n        def integrand(eta: float) - float:\n            \"\"\"\n            Calculates the value of the integrand for delta_ISW at a given eta.\n            The integrand is 2 * (dPhi/deta), evaluated along the photon path.\n            \"\"\"\n            # Photon path x(eta) = eta - eta_c\n            # Potential center x_c(eta) = vp * (eta - eta_c)\n            eta_minus_etac = eta - ETA_C\n            \n            # Difference between photon and potential center position\n            x_minus_xc = (1.0 - vp) * eta_minus_etac\n            \n            # Gaussian part of the potential\n            exponent = - (x_minus_xc**2) / (2.0 * SIGMA**2)\n            gaussian_term = np.exp(exponent)\n            \n            # Derivative of amplitude function\n            f_prime_val = fp_eta(eta)\n            \n            # Amplitude function value\n            f_val = f_eta(eta)\n\n            # Term from the potential's movement\n            motion_term = f_val * x_minus_xc * vp / (SIGMA**2)\n\n            # The partial derivative d(Phi)/d(eta)\n            dPhi_deta = PHI_0 * gaussian_term * (f_prime_val + motion_term)\n            \n            return 2.0 * dPhi_deta\n\n        # Perform the numerical integration\n        # For cases A and C, the integral is analytically zero.\n        # This check avoids unnecessary numerical computation.\n        if (case['fp_eta'](ETA_C) == 0 and case['vp'] == 0) or \\\n           (case['fp_eta'](ETA_C) == 0 and case['f_eta'](ETA_C) == 1):\n             # The first condition covers case A.\n             # The second covers Case C, where the integrand is an odd function over a symmetric interval.\n            integral_val = 0.0\n        else:\n            integral_val, _ = quad(integrand, eta_e, eta_o)\n\n        results.append(round(integral_val, 10))\n\n    # Format and print the final output as specified\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}