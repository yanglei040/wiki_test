## 引言
在分子尺度上，物质的宏观性质——无论是液体的流动性、固体的刚性，还是溶液的混合行为——都根植于其组成粒子（原子、分子或离子）间的空间排布方式。仅仅知道粒子的平均密度是远远不够的；理解它们如何相互关联、形成有序或无序的结构，才是揭示物质行为之谜的关键。[径向分布函数](@entry_id:171547)（Radial Distribution Function, RDF或$g(r)$）及其衍生的配位数（Coordination Number）正是为解决这一核心问题而生的最强大、最基本的统计工具。它们为我们提供了一扇窗，通过这扇窗可以窥见微观世界的结构景观，并将这些结构信息与可测量的宏观性质联系起来。

本文旨在为研究生及相关领域的研究人员提供一份关于径向分布函数与配位数的全面指南。我们将系统性地解决从理论基础到应用实践的一系列问题。
*   在“原理与机制”一章中，我们将从[统计力](@entry_id:194984)学的第一性原理出发，建立$g(r)$的严格定义，阐明其与[平均力势](@entry_id:137947)的深刻联系，并探讨在模拟中计算它时必须注意的理论细节与伪影。
*   “应用与跨学科联系”一章将展示$g(r)$如何作为一种多功能探针，被应用于区分物相、表征复杂材料（如玻璃和合金）、连接结构与动力学，以及验证和开发分[子模](@entry_id:148922)型。
*   最后，“动手实践”部分将通过具体的计算问题，引导读者将理论知识转化为实际的编程和数据分析技能，从而巩固对核心概念的理解。

通过这三个层面的学习，读者将不仅掌握$g(r)$的计算方法，更能深刻理解其物理内涵，并有能力将其灵活运用于自己的研究课题中。

## 原理与机制

在理解[凝聚态物质](@entry_id:747660)的微观结构时，我们不仅需要知道粒子在空间中的平均[分布](@entry_id:182848)，更关键的是要量化它们之间的相对位置关系。这种位置上的相关性决定了物质的宏观物理性质。本章将深入探讨描述这种相关性的核心工具——[径向分布函数](@entry_id:171547)（Radial Distribution Function, RDF），以及由其衍生的[配位数](@entry_id:143221)（Coordination Number）。我们将从其[统计力](@entry_id:194984)学的第一性原理定义出发，阐明其物理意义，并探讨其在不同物态、多组分系统中的应用，最后详细分析在分子动力学（MD）模拟中计算和解释这些量时必须注意的原理和伪影。

### 从粒子密度到[对相关函数](@entry_id:145140)

为了描述一个由 $N$ 个粒子组成的系统，最基础的量是**单粒子密度** $\rho^{(1)}(\mathbf{r})$。它描述了在空间位置 $\mathbf{r}$ 处找到一个粒子的概率密度。对于一个宏观均匀的流体，任何位置找到粒子的概率都是相同的，因此单粒子密度是一个常数，即体系的平均[数密度](@entry_id:268986) $\rho = N/V$，其中 $V$ 是体系的体积。

然而，单粒子密度无法告诉我们粒子间的相对排布信息。为此，我们需要引入**二粒子密度** $\rho^{(2)}(\mathbf{r}_1, \mathbf{r}_2)$。$\rho^{(2)}(\mathbf{r}_1, \mathbf{r}_2) d\mathbf{r}_1 d\mathbf{r}_2$ 给出了在 $\mathbf{r}_1$ 附近无穷小[体积元](@entry_id:267802) $d\mathbf{r}_1$ 内找到一个粒子，*同时*在 $\mathbf{r}_2$ 附近 $d\mathbf{r}_2$ 内找到另一个粒子的[联合概率](@entry_id:266356)。

如果粒子间的位置完全不相关（例如在[理想气体](@entry_id:200096)中），那么这种[联合概率](@entry_id:266356)将简单地是两个[独立事件](@entry_id:275822)概率的乘积，即 $\rho^{(2)}(\mathbf{r}_1, \mathbf{r}_2) = \rho^{(1)}(\mathbf{r}_1) \rho^{(1)}(\mathbf{r}_2)$。然而，在真实流体中，粒子间存在相互作用力，导致它们的位置是相关的。例如，由于[泡利不相容原理](@entry_id:141850)和[原子核](@entry_id:167902)间的排斥作用，两个粒子不可能占据同一空间。

为了量化这种偏离不相关情况的程度，我们定义了**[对相关函数](@entry_id:145140)**（pair distribution function） $g^{(2)}(\mathbf{r}_1, \mathbf{r}_2)$ ：

$$
g^{(2)}(\mathbf{r}_1, \mathbf{r}_2) = \frac{\rho^{(2)}(\mathbf{r}_1, \mathbf{r}_2)}{\rho^{(1)}(\mathbf{r}_1) \rho^{(1)}(\mathbf{r}_2)}
$$

这个无量纲的函数直接反映了粒子间的结构相关性。当 $g^{(2)} > 1$ 时，意味着在 $\mathbf{r}_1$ 处有一个粒子的前提下，在 $\mathbf{r}_2$ 处找到另一个粒子的概率比随机[分布](@entry_id:182848)时要高，这通常由吸引作用或有序堆积引起。反之，当 $g^{(2)}  1$ 时，表示概率降低，通常由排斥作用引起。在粒子间距非常大时，它们的相关性消失，此时 $g^{(2)}$ 趋近于 $1$。

### 均匀各向同性体系中的[径向分布函数](@entry_id:171547) $g(r)$

对于分子动力学模拟中常见的均匀、各向同性的流体（如液体和气体），系统的统计性质具有平移和[旋转不变性](@entry_id:137644)。
**均匀性**（Homogeneity）意味着 $\rho^{(1)}(\mathbf{r})$ 是一个常数 $\rho$，并且二粒子密度和[对相关函数](@entry_id:145140)仅依赖于粒子间的相对[位移矢量](@entry_id:262782) $\mathbf{r} = \mathbf{r}_2 - \mathbf{r}_1$，而与绝对位置无关。
**各向同性**（Isotropy）意味着这些函数不依赖于[位移矢量](@entry_id:262782)的方向，仅依赖于其大小，即标量距离 $r = |\mathbf{r}_2 - \mathbf{r}_1|$。

在这些对称性条件下，复杂的[对相关函数](@entry_id:145140) $g^{(2)}(\mathbf{r}_1, \mathbf{r}_2)$ 被简化为一个仅依赖于距离 $r$ 的函数，这便是我们熟知的**[径向分布函数](@entry_id:171547)**（Radial Distribution Function），记为 $g(r)$ 。其定义简化为：

$$
g(r) = \frac{\rho^{(2)}(r)}{\rho^2}
$$

$g(r)$ 具有极其重要的物理意义。我们可以推导出，给定一个粒子位于原点，在距离它为 $r$ 的地方，其他粒子的平均局部数密度为 $\rho_{\text{local}}(r) = \rho g(r)$。因此，$g(r)$ 是一个修正因子，描述了局部密度相对于平均密度 $\rho$ 的偏离程度。

利用这一关系，我们可以计算一个[中心粒](@entry_id:173117)子周围特定范围内的平均邻居数量。在一个以[中心粒](@entry_id:173117)子为球心，半径为 $r$、厚度为 $dr$ 的薄球壳内，体积为 $4\pi r^2 dr$，邻居粒子的期望数目为 $dN(r) = \rho_{\text{local}}(r) \cdot 4\pi r^2 dr = 4\pi\rho g(r) r^2 dr$。对该式从 $0$ 积分到半径 $R$，我们便得到了**配位数**（coordination number） $N_c(R)$，它表示在一个半径为 $R$ 的球体内，一个粒子平均拥有的邻居数量：

$$
N_c(R) = 4\pi\rho \int_{0}^{R} g(r) r^2 dr
$$

配位数是量化局部化学环境和[溶剂化](@entry_id:146105)结构的关键物理量。

### 通过 $g(r)$ 解读物质结构

径向分布函数 $g(r)$ 的定性特征是区分物质不同相态的有力指纹 。

*   **气体**：在低密度、高温的稀薄气体中，粒子间平均距离远，相互作用弱。除了在短距离（$r$ 小于粒子[有效直径](@entry_id:748809)）由于强排斥作用导致 $g(r) \approx 0$ 外，在其他大部分区域，粒子位置基本不相关，因此 $g(r) \approx 1$。其曲线平滑，几乎没有[振荡](@entry_id:267781)结构。在这种情况下，没有明确的峰和谷来定义[配位层](@entry_id:151929)，因此配位数的概念变得模糊不清。

*   **液体**：液体兼具一定的流动性和局部有序性。其 $g(r)$ 曲线的典型特征是：在短程表现出明显的[振荡](@entry_id:267781)结构，而在长程则衰减至 $1$。第一个尖锐的峰对应于最邻近的粒子层（第一[配位层](@entry_id:151929)），反映了粒子因排斥作用而不能无限靠近，又因吸引作用和空间限制而倾向于聚集。随后的峰对应于第二、第三[配位层](@entry_id:151929)等。由于液体缺乏长程有序，这些峰随着 $r$ 的增大而逐渐变宽、峰值降低，最终完全消失，体现了所谓的“[短程有序](@entry_id:158915)，长程无序”。$g(r)$ 的第一个极小值点通常被用来定义第一[配位层](@entry_id:151929)的边界，通过积分到此半径可以得到第一配位数。

*   **晶体**：与液体不同，晶体具有严格的长程周期性结构。其 $g(r)$ 表现为一系列离散、尖锐且在长程上不会衰减的峰。每个峰的位置对应于[晶格](@entry_id:196752)中从一个参考粒子到其各级邻居的精确距离。峰的尖锐程度与温度有关：在零温完美晶体中，它们是狄拉克 $\delta$ 函数；在有限温度下，热[振动](@entry_id:267781)使得[峰展宽](@entry_id:183067)，但其长程周期性依然存在。这种长程有序的 $g(r)$ 与其在倒空间的对应物——[静态结构因子](@entry_id:141682) $S(\mathbf{k})$ 中的[布拉格衍射](@entry_id:148063)峰（Bragg peaks）的存在是等价的。

### 能量基础：[平均力势](@entry_id:137947)

$g(r)$ 不仅描述了空间结构，还与粒子间的有效相互作用能密切相关。在[统计力](@entry_id:194984)学中，**[平均力势](@entry_id:137947)**（Potential of Mean Force, PMF）$w(r)$ 被定义为在流体中将两个粒子从无限远处移动到相距为 $r$ 时所需要做的可逆功。它代表了这两个粒子在溶剂（即体系中所有其他粒子）的平均效应作用下的有效相互作用势。

$g(r)$ 和 $w(r)$ 通过一个类似[玻尔兹曼分布](@entry_id:142765)的基本关系联系在一起 ：

$$
g(r) = \exp\left(-\frac{w(r)}{k_B T}\right) \quad \text{或} \quad w(r) = -k_B T \ln(g(r))
$$

其中 $k_B$ 是[玻尔兹曼常数](@entry_id:142384)，$T$ 是温度。这个关系意味着 $g(r)$ 的峰（$g(r)>1$）对应于 $w(r)$ 的谷（有效吸引），而 $g(r)$ 的谷（$g(r)1$）对应于 $w(r)$ 的峰（有效排斥）。

一个关键问题是 $w(r)$ 与粒子间直接的、真空中的**[对势](@entry_id:753090)** $u(r)$ 有何区别。$w(r)$ 可以被分解为直接相互作用和间接相互作用两部分：$w(r) = u(r) + w_{\text{ind}}(r)$。$w_{\text{ind}}(r)$ 来自周围溶剂粒子的平均作用。

*   在**稀薄极限**（$\rho \to 0$）下，体系中几乎没有其他粒子，因此间接作用消失（$w_{\text{ind}}(r) \to 0$），此时[平均力势](@entry_id:137947)等于裸[对势](@entry_id:753090)，即 $w(r) = u(r)$ 。这也意味着在该极限下，$g(r) \approx \exp(-\beta u(r))$，其中 $\beta=1/(k_B T)$。

*   在**有限密度**下，$w(r) \neq u(r)$。溶剂粒子的存在会“屏蔽”或“增强”原始相互作用，并产生熵效应（例如[溶剂化壳层](@entry_id:170646)的形成），导致 $w(r)$ 出现裸对势 $u(r)$ 中所没有的[振荡](@entry_id:267781)结构。

利用Mayer[集团展开](@entry_id:154285)理论，可以系统地展开 $g(r)$。其零阶项即为稀薄极限的结果。而密度 $\rho$ 的[一阶修正](@entry_id:155896)项，清晰地展示了间接作用的来源：它涉及到第三个粒子与原始粒子对的相互作用 。对于硬球流体，其[对势](@entry_id:753090)在 $r\sigma$ 时为无穷大，在 $r\ge\sigma$ 时为零。其 $g(r)$ 的低密度展开为：

$$
g(r) \approx e^{-\beta u(r)} \left( 1 + \rho \int d\mathbf{r}_3 f(|\mathbf{r}_1 - \mathbf{r}_3|) f(|\mathbf{r}_2 - \mathbf{r}_3|) \right)
$$

其中 $f(r) = e^{-\beta u(r)} - 1$ 是[Mayer f-函数](@entry_id:151894)。对于硬球，当 $r \ge \sigma$ 时，$e^{-\beta u(r)}=1$。积分项计算的是两个半径为 $\sigma$、球心相距为 $r$ 的球体的交集体积，这正是一个由第三个粒子介导的间接关联的几何体现。例如，对于硬球系统，当 $\sigma = 0.3\,\mathrm{nm}, r = 0.45\,\mathrm{nm}, \rho = 0.5\,\mathrm{nm}^{-3}$ 时，计算出的 $g(r) \approx 1.00486$，这个微小但非零的偏离正源于一阶[密度修正](@entry_id:198312)。

### 复杂体系的应用：混合物

上述概念可以自然地推广到多组分混合物中。对于一个由 $\alpha$ 和 $\beta$ 物种组成的[二元混合物](@entry_id:168452)，我们可以定义三种**偏径向分布函数**（partial RDFs）：$g_{\alpha\alpha}(r)$, $g_{\beta\beta}(r)$ 和 $g_{\alpha\beta}(r)$。

$g_{\alpha\beta}(r)$ 的物理意义是：给定一个 $\alpha$ 粒子位于原点，在其周围距离 $r$ 处，$\beta$ 物种的局部[数密度](@entry_id:268986)为 $\rho_\beta g_{\alpha\beta}(r)$ 。这里，$\rho_\beta = N_\beta / V$ 是物种 $\beta$ 的平均[数密度](@entry_id:268986)。因此，计算 $\alpha$ 粒子周围半径 $R$ 内 $\beta$ 粒子的平均[配位数](@entry_id:143221)，公式为：

$$
N_{\alpha\beta}(R) = 4\pi \rho_{\beta} \int_{0}^{R} g_{\alpha\beta}(r) r^2 dr
$$

在分析混合物时，区分基于数密度的定义和基于摩尔分数的加权平均非常重要 。上述基于 $\rho_\beta$ 的公式是计算物理[配位数](@entry_id:143221)（即真实的邻居粒子数）的唯一正确方法。有时，为了得到一个代表整个混合物平均结构的单一函数，会定义一个**摩尔分数加权**的 $g_{\text{mix}}(r) = \sum_i \sum_j x_i x_j g_{ij}(r)$，其中 $x_i$ 是物种 $i$ 的[摩尔分数](@entry_id:145460)。这个函数适用于与散射实验等宏观平均量进行比较，但不能用于计算特定物种周围的物理[配位数](@entry_id:143221)，否则会产生量纲错误和无物理意义的结果。

### 计算实践与伪影

在分子动力学模拟中，径向分布函数并非直接可得，而是通过对大量构型进行统计平均来估计。这个过程引入了一些需要仔细处理的实际问题和系统性误差。

#### [直方图](@entry_id:178776)估计

最常见的计算方法是**直方图法** 。我们将距离范围 $r$ 划分为一系列宽度为 $\Delta r$ 的小区间（bins）。在每个模拟构型（frame）中，我们计算出所有粒子对之间的距离，并统计落入每个区间 $[r, r+\Delta r)$ 的粒子对数目，记为 $C(r; \Delta r)$。对所有构型取平均，得到 $\langle C(r; \Delta r) \rangle$。
$g(r)$ 的估计值 $\widehat{g}(r)$ 可通过将理论关系式反解得到：
$\langle \text{球壳内粒子数} \rangle = N_{\text{ref}} \cdot \rho_{\text{neighbor}} g(r) \cdot V_{\text{shell}}$

在一个包含 $N$ 个相同粒子的体系中，我们可以将每个粒子都视作参考粒子（$N_{\text{ref}}=N$）。球壳体积 $V_{\text{shell}} = 4\pi r^2 \Delta r$。邻居的平均密度是 $\rho$。总的粒子对计数 $C(r; \Delta r)$ 是对无序对 $(i,j)$ 的求和，而理论推导中的计数是针对每个参考粒子 $i$ 的邻居 $j$，因此需要一个因子 $2$ 来修正双重计数。综合考虑所有归一化因子，我们得到 $g(r)$ 的估计量：

$$
\widehat{g}(r) = \frac{\langle \sum_{k=1}^{K} C_{k}(r; \Delta r) \rangle / K}{\frac{1}{2} N (N-1) \cdot \frac{4\pi r^2 \Delta r}{V}} \approx \frac{\langle C(r; \Delta r) \rangle_{\text{total}}}{2 \pi K N \rho r^2 \Delta r}
$$

其中 $K$ 是构型总数，$\langle C(r; \Delta r) \rangle_{\text{total}} = \sum_k C_k$ 是在所有构型中统计到的总对数。每个因子都至关重要：$K$ 用于[时间平均](@entry_id:267915)，$\frac{1}{2}N(N-1)$ 是总对数（[热力学极限](@entry_id:143061)下近似为 $\frac{1}{2}N^2$），$V$ (或 $\rho$) 用于密度归一化，$4\pi r^2 \Delta r$ 用于球壳体积归一化。

#### 周期性边界条件与伪影

为了模拟宏观体系，MD模拟通常在有限尺寸的模拟盒子中采用**[周期性边界条件](@entry_id:147809)**（Periodic Boundary Conditions, PBC）。这意味着盒子在三个维度上被无限复制。计算粒子间距离时，必须采用**[最小镜像约定](@entry_id:142070)**（Minimum Image Convention, MIC），即粒子 $i$ 与粒子 $j$ 的所有周期性镜像之间的距离中，只取最短的一个 。

*   **截断伪影 (Cutoff Artifact)**：MIC 的一个直接后果是，能够被无偏测量的最大距离受限于模拟盒子的尺寸。对于一个边长为 $L_x, L_y, L_z$ 的正交盒子，任何两个粒子间的最大可信距离不能超过 $\frac{1}{2}\min(L_x, L_y, L_z)$。这是因为一个半径大于此值的球体将与自身的周期性镜像相交。当 $r$ 超过这个“半盒子”准则时，一些本应计入大距离的粒子对，其距离会被MIC“折叠”成一个较小的值。这会导致在大 $r$ 处的 $g(r)$ 被系统性地低估（趋向于0），而在某些小 $r$ 处被相应地高估。例如，在一个 $L_x = 3.0\,\mathrm{nm}, L_y = 2.5\,\mathrm{nm}, L_z = 2.0\,\mathrm{nm}$ 的盒子中，只有当 $r  1.0\,\mathrm{nm}$ 时，$g(r)$ 的计算才是可靠的。

*   **各向异性伪影 (Anisotropy Artifact)**：对于非立方体（如三斜）的模拟盒子，上述截断效应是各向异性的。此时，可靠计算 $g(r)$ 的最大半径 $r_{\text{iso}}$ 由能内切于维格纳-赛兹（Wigner-Seitz）原胞的最大球体的半径决定。该半径等于最短[晶格矢量](@entry_id:161583)长度的一半 。例如，对于一个由[晶格矢量](@entry_id:161583) $\mathbf{a} = (3.2, 0.0, 0.0)$, $\mathbf{b} = (0.5, 2.8, 0.0)$, $\mathbf{c} = (0.2, 0.4, 3.0)$ （单位nm）定义的[三斜盒](@entry_id:756170)子，最短的[晶格矢量](@entry_id:161583)是 $\mathbf{b}$，其长度为 $\sqrt{8.09} \approx 2.844\,\mathrm{nm}$。因此，该体系中 $g(r)$ 的各向同性估计的可靠范围为 $r_{\text{iso}} = \frac{1}{2}|\mathbf{b}| \approx 1.422\,\mathrm{nm}$。

*   **系综伪影 (Ensemble Artifact)**：在正则系综（NVT）中模拟小尺寸体系时，粒子数 $N$ 的严格守恒会抑制长波长的[密度涨落](@entry_id:143540)。这导致在[NVT系综](@entry_id:142391)中计算的[静态结构因子](@entry_id:141682)在零[波矢](@entry_id:178620)处为零，即 $S_{NVT}(k=0) = 0$。然而，根据[热力学涨落理论](@entry_id:143595)（压缩性定理），[巨正则系综](@entry_id:141562)（$\mu VT$）中的结构因子在零波矢处应等于 $S_{GC}(0) = \rho k_B T \kappa_T$，其中 $\kappa_T$ 是等温[压缩系数](@entry_id:272630)。这种不一致性表现为[NVT模拟](@entry_id:752846)得到的 $g(r)$ 在大 $r$ 处会有一个微小的负偏移，以满足 $\rho \int (g(r)-1)d\mathbf{r} = -1$ 的积分约束。为了修正这一[有限尺寸效应](@entry_id:155681)，使其与宏观[热力学性质](@entry_id:146047)一致，可以给测得的 $g_{NVT}(r)$ 加上一个小的常数修正 $\delta$ 。该修正值被证明为：

$$
\delta = \frac{\rho k_B T \kappa_T}{N}
$$

例如，对于一个包含 $N=512$ 个水分子的模拟体系，在室温（$T=298$ K）下，其密度 $\rho \approx 3.34 \times 10^{28}\,\mathrm{m}^{-3}$，等温[压缩系数](@entry_id:272630) $\kappa_T \approx 4.5 \times 10^{-10}\,\mathrm{Pa}^{-1}$，计算出的修正值 $\delta \approx 1.21 \times 10^{-4}$。尽管这个值很小，但在需要高精度连接结构与[热力学性质](@entry_id:146047)的研究中，这个修正是不可或缺的。

综上所述，[径向分布函数](@entry_id:171547)是连接微观模拟与宏观物质结构和性质的核心桥梁。对其进行精确的计算和正确的解读，要求我们不仅要掌握其深刻的[统计力](@entry_id:194984)学内涵，还必须对模拟实践中可能出现的各种系统性伪影有清醒的认识和处理能力。