{
    "hands_on_practices": [
        {
            "introduction": "埃瓦尔德求和法的核心在于将长程静电相互作用分解为实空间和倒易空间两部分。本练习将深入探讨倒易空间求和的基石——结构因子 $S(\\mathbf{k})$。通过对一个经典的离子晶体（岩盐结构）进行具体计算，您将亲手推导出哪些倒易格点矢量对静电能有贡献，从而建立起关于原子排布如何决定倒易空间“选择定则”的物理直觉。",
            "id": "3422408",
            "problem": "在周期性分子动力学模拟的 Ewald 求和的倒易空间部分中，一组点电荷的倒易空间结构因子定义为 $S(\\mathbf{k})=\\sum_{j=1}^{N} q_{j}\\exp\\!\\left(i\\,\\mathbf{k}\\cdot\\mathbf{r}_{j}\\right)$，其中 $q_{j}$ 是电荷，$\\mathbf{r}_{j}$ 是它们在边长为 $a$ 的晶胞中的位置。考虑一个如下构造的常规岩盐结构晶胞：一个底层的面心立方晶格，其四个格点的分数坐标（以 $a$ 为单位）为 $(0,0,0)$、$(0,\\tfrac{1}{2},\\tfrac{1}{2})$、$(\\tfrac{1}{2},0,\\tfrac{1}{2})$、$(\\tfrac{1}{2},\\tfrac{1}{2},0)$，被电荷 $+q$ 占据；以及第二个相互贯穿的面心立方晶格，它是通过基矢平移 $\\mathbf{d}=(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$（以 $a$ 为单位）得到的，被电荷 $-q$ 占据。因此，晶胞在位置 $\\mathbf{R}_{\\alpha}$（其中 $\\alpha=1,\\dots,8$）处包含8个电荷，四个电荷为 $+q$，位于 $\\mathbf{R}_{1}=(0,0,0)$、$\\mathbf{R}_{2}=(0,\\tfrac{1}{2},\\tfrac{1}{2})$、$\\mathbf{R}_{3}=(\\tfrac{1}{2},0,\\tfrac{1}{2})$、$\\mathbf{R}_{4}=(\\tfrac{1}{2},\\tfrac{1}{2},0)$；四个电荷为 $-q$，位于 $\\mathbf{R}_{5}=\\mathbf{R}_{1}+\\mathbf{d}$、$\\mathbf{R}_{6}=\\mathbf{R}_{2}+\\mathbf{d}$、$\\mathbf{R}_{7}=\\mathbf{R}_{3}+\\mathbf{d}$、$\\mathbf{R}_{8}=\\mathbf{R}_{4}+\\mathbf{d}$。周期性模拟盒子的倒易晶格矢量为 $\\mathbf{k}=\\frac{2\\pi}{a}(h,k,l)$，其中 $h,k,l$ 为整数。\n\n仅使用 $S(\\mathbf{k})$ 的定义，显式计算立方倒易晶格的六个最小非零倒易矢量的 $S(\\mathbf{k})$，即 $\\mathbf{k}=\\frac{2\\pi}{a}(1,0,0)$、$\\mathbf{k}=\\frac{2\\pi}{a}(-1,0,0)$、$\\mathbf{k}=\\frac{2\\pi}{a}(0,1,0)$、$\\mathbf{k}=\\frac{2\\pi}{a}(0,-1,0)$、$\\mathbf{k}=\\frac{2\\pi}{a}(0,0,1)$ 和 $\\mathbf{k}=\\frac{2\\pi}{a}(0,0,-1)$，并根据这些结果推断使 $S(\\mathbf{k})\\neq 0$ 的最小非零模长 $|\\mathbf{k}|$。\n\n答案格式要求：将最终答案报告为等于 $|\\mathbf{k}_{\\min}|/(2\\pi/a)$ 的单个无量纲数。不要包含任何单位。无需四舍五入；请提供精确值。",
            "solution": "该问题要求计算特定晶体结构和给定一组倒易晶格矢量的倒易空间结构因子 $S(\\mathbf{k})$，然后推断使 $S(\\mathbf{k})$ 不为零的最小非零模长 $|\\mathbf{k}|$。\n\n首先，我们验证问题陈述。\n\n### 步骤1：提取已知条件\n-   结构因子定义为 $S(\\mathbf{k})=\\sum_{j=1}^{N} q_{j}\\exp(i\\,\\mathbf{k}\\cdot\\mathbf{r}_{j})$。\n-   系统是边长为 $a$ 的岩盐结构晶胞。\n-   晶胞中有 $N=8$ 个点电荷。\n-   四个电荷 $+q$ 位于对应于面心立方晶格的位置：$\\mathbf{R}_{1}=a(0,0,0)$、$\\mathbf{R}_{2}=a(0,\\tfrac{1}{2},\\tfrac{1}{2})$、$\\mathbf{R}_{3}=a(\\tfrac{1}{2},0,\\tfrac{1}{2})$ 和 $\\mathbf{R}_{4}=a(\\tfrac{1}{2},\\tfrac{1}{2},0)$。\n-   四个电荷 $-q$ 位于从第一组位置平移一个基矢 $\\mathbf{d}=a(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$ 的位置：$\\mathbf{R}_{j+4} = \\mathbf{R}_j + \\mathbf{d}$，对于 $j=1,2,3,4$。\n-   倒易晶格矢量由 $\\mathbf{k}=\\frac{2\\pi}{a}(h,k,l)$ 给出，其中 $h, k, l$ 是整数。\n-   具体任务是计算六个矢量的 $S(\\mathbf{k})$：$\\mathbf{k}=\\frac{2\\pi}{a}(\\pm 1,0,0)$、$\\mathbf{k}=\\frac{2\\pi}{a}(0,\\pm 1,0)$ 和 $\\mathbf{k}=\\frac{2\\pi}{a}(0,0,\\pm 1)$。\n-   根据这些结果，我们必须推断使 $S(\\mathbf{k})\\neq 0$ 的最小非零模长 $|\\mathbf{k}|$。\n-   最终答案应为无量纲值 $|\\mathbf{k}_{\\min}|/(2\\pi/a)$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，提法适定且客观。它描述了固态物理学中一个经典离子晶体（岩盐结构）的结构因子的标准计算。定义、位置和晶格矢量都是标准的和自洽的。晶胞的总电荷为 $4(+q) + 4(-q) = 0$，这是周期性离子系统稳定性的一个必要条件。没有矛盾、歧义或缺失的信息。该问题是有效的。\n\n### 解题推导\n\n我们首先写出晶胞中 $N=8$ 个电荷的结构因子 $S(\\mathbf{k})$ 的完整表达式。我们可以将求和分为两部分：一部分是四个正电荷（位置记为 $\\mathbf{c}_j$），另一部分是四个负电荷（位置记为 $\\mathbf{a}_j$）。\n$$S(\\mathbf{k}) = \\sum_{j=1}^{4} (+q) \\exp(i\\mathbf{k}\\cdot\\mathbf{c}_j) + \\sum_{j=1}^{4} (-q) \\exp(i\\mathbf{k}\\cdot\\mathbf{a}_j)$$\n其中 $\\mathbf{c}_j$是位置 $\\mathbf{R}_1, \\dots, \\mathbf{R}_4$，而 $\\mathbf{a}_j = \\mathbf{c}_j + \\mathbf{d}$。代入这个关系得到：\n$$S(\\mathbf{k}) = q \\sum_{j=1}^{4} \\exp(i\\mathbf{k}\\cdot\\mathbf{c}_j) - q \\sum_{j=1}^{4} \\exp(i\\mathbf{k}\\cdot(\\mathbf{c}_j + \\mathbf{d}))$$\n我们可以从第二项求和中提出包含 $\\mathbf{d}$ 的项：\n$$S(\\mathbf{k}) = q \\sum_{j=1}^{4} \\exp(i\\mathbf{k}\\cdot\\mathbf{c}_j) - q \\exp(i\\mathbf{k}\\cdot\\mathbf{d}) \\sum_{j=1}^{4} \\exp(i\\mathbf{k}\\cdot\\mathbf{c}_j)$$\n提出公共的求和项得到：\n$$S(\\mathbf{k}) = q \\left( 1 - \\exp(i\\mathbf{k}\\cdot\\mathbf{d}) \\right) \\left( \\sum_{j=1}^{4} \\exp(i\\mathbf{k}\\cdot\\mathbf{c}_j) \\right)$$\n这个表达式将结构因子分为两个部分：\n1.  一个“基元”因子，$S_{basis}(\\mathbf{k}) = 1 - \\exp(i\\mathbf{k}\\cdot\\mathbf{d})$。\n2.  一个底层面心立方晶格的“几何”结构因子，$S_{FCC}(\\mathbf{k}) = \\sum_{j=1}^{4} \\exp(i\\mathbf{k}\\cdot\\mathbf{c}_j)$。\n\n让我们根据倒易晶格矢量 $\\mathbf{k}=\\frac{2\\pi}{a}(h,k,l)$ 的米勒指数 $(h,k,l)$ 来分析每个因子。\n\n首先，几何结构因子 $S_{FCC}(\\mathbf{k})$。位置是 $\\mathbf{c}_1=a(0,0,0)$、$\\mathbf{c}_2=a(0,1/2,1/2)$、$\\mathbf{c}_3=a(1/2,0,1/2)$、$\\mathbf{c}_4=a(1/2,1/2,0)$。点积 $\\mathbf{k}\\cdot\\mathbf{c}_j$ 为：\n$\\mathbf{k}\\cdot\\mathbf{c}_1 = 0$\n$\\mathbf{k}\\cdot\\mathbf{c}_2 = \\frac{2\\pi}{a}(h,k,l) \\cdot a(0,1/2,1/2) = \\pi(k+l)$\n$\\mathbf{k}\\cdot\\mathbf{c}_3 = \\frac{2\\pi}{a}(h,k,l) \\cdot a(1/2,0,1/2) = \\pi(h+l)$\n$\\mathbf{k}\\cdot\\mathbf{c}_4 = \\frac{2\\pi}{a}(h,k,l) \\cdot a(1/2,1/2,0) = \\pi(h+k)$\n\n因此，几何结构因子是：\n$$S_{FCC}(\\mathbf{k}) = \\exp(i \\cdot 0) + \\exp(i\\pi(k+l)) + \\exp(i\\pi(h+l)) + \\exp(i\\pi(h+k))$$\n$$S_{FCC}(\\mathbf{k}) = 1 + (-1)^{k+l} + (-1)^{h+l} + (-1)^{h+k}$$\n这个和仅在指数 $(h,k,l)$ 具有一致的奇偶性（即它们全为偶数或全为奇数）时才不为零。在这种情况下，$S_{FCC}(\\mathbf{k}) = 1+1+1+1 = 4$。如果奇偶性混合，则和为 $0$。\n\n接下来，我们分析基元因子 $S_{basis}(\\mathbf{k})$。对于 $\\mathbf{d} = a(1/2,1/2,1/2)$，点积是：\n$$\\mathbf{k}\\cdot\\mathbf{d} = \\frac{2\\pi}{a}(h,k,l) \\cdot a(1/2,1/2,1/2) = \\pi(h+k+l)$$\n所以，基元因子是：\n$$S_{basis}(\\mathbf{k}) = 1 - \\exp(i\\pi(h+k+l)) = 1 - (-1)^{h+k+l}$$\n这个因子仅在 $h+k+l$ 是奇数时才不为零。在这种情况下，$S_{basis}(\\mathbf{k}) = 1 - (-1) = 2$。如果 $h+k+l$ 是偶数，则 $S_{basis}(\\mathbf{k}) = 1-1=0$。\n\n要使总结构因子 $S(\\mathbf{k}) = q \\cdot S_{basis}(\\mathbf{k}) \\cdot S_{FCC}(\\mathbf{k})$ 不为零，两个因子都必须不为零。让我们组合这些条件：\n1.  $S_{FCC}(\\mathbf{k}) \\neq 0$：指数 $(h,k,l)$ 必须全为偶数或全为奇数。\n2.  $S_{basis}(\\mathbf{k}) \\neq 0$：和 $h+k+l$ 必须是奇数。\n\n-   如果 $(h,k,l)$ 全为偶数，它们的和 $h+k+l$ 也是偶数。这使得 $S_{basis}(\\mathbf{k}) = 0$，所以 $S(\\mathbf{k})=0$。\n-   如果 $(h,k,l)$ 全为奇数，它们的和 $h+k+l = (2n_h+1) + (2n_k+1) + (2n_l+1) = 2(n_h+n_k+n_l)+3$ 是奇数。在这种情况下，$S_{FCC}(\\mathbf{k})=4$ 且 $S_{basis}(\\mathbf{k})=2$。两个条件都满足，且 $S(\\mathbf{k}) = q(2)(4) = 8q \\neq 0$。\n-   如果 $(h,k,l)$ 的奇偶性混合，$S_{FCC}(\\mathbf{k})=0$，所以 $S(\\mathbf{k})=0$。\n\n因此，岩盐晶格的结构因子 $S(\\mathbf{k})$ 不为零的条件是米勒指数 $(h,k,l)$ 必须全部是奇数。\n\n现在，我们计算六个指定的倒易矢量的 $S(\\mathbf{k})$。这些矢量对应于米勒指数 $(\\pm 1,0,0)$、$(0,\\pm 1,0)$ 和 $(0,0,\\pm 1)$。对于 $\\mathbf{k}=\\frac{2\\pi}{a}(1,0,0)$，指数为 $(h,k,l)=(1,0,0)$。这些指数具有混合的奇偶性（一个奇数，两个偶数）。根据我们推导出的选择定则，$S(\\mathbf{k})$ 必须为 $0$。同样的逻辑适用于所有六个矢量，因为每个矢量都有一个指数等于 $\\pm 1$ 和两个指数等于 $0$。因此，对于所有六个指定的矢量，$S(\\mathbf{k})=0$。\n\n问题接着要求我们推断使 $S(\\mathbf{k})\\neq 0$ 的最小非零模长 $|\\mathbf{k}|$。这需要找到使 $\\mathbf{k}$ 的模长最小化的全奇数整数集合 $(h,k,l)$。模长的平方由下式给出：\n$$|\\mathbf{k}|^2 = \\left(\\frac{2\\pi}{a}\\right)^2 (h^2+k^2+l^2)$$\n为了最小化 $|\\mathbf{k}|$，我们必须在 $h, k, l$ 都是非零奇数的约束下，最小化平方和 $h^2+k^2+l^2$。模长最小的奇数是 $\\pm 1$。从集合 $\\{\\pm 1\\}$ 中选择 $h, k, l$ 会得到最小可能的非零平方和。\n例如，对于 $(h,k,l)=(1,1,1)$，和为 $1^2+1^2+1^2=3$。任何其他全奇数整数的组合（例如，包含 $\\pm 3$）都会导致更大的和（例如，$1^2+1^2+3^2 = 11$）。\n在该条件下，$h^2+k^2+l^2$ 的最小值为 $3$。\n\n因此，最小的非零模长 $|\\mathbf{k}_{\\min}|$ 是：\n$$|\\mathbf{k}_{\\min}| = \\sqrt{\\left(\\frac{2\\pi}{a}\\right)^2 \\cdot 3} = \\frac{2\\pi}{a}\\sqrt{3}$$\n所要求的最终答案是无量纲数 $|\\mathbf{k}_{\\min}|/(2\\pi/a)$：\n$$\\frac{|\\mathbf{k}_{\\min}|}{2\\pi/a} = \\frac{\\frac{2\\pi}{a}\\sqrt{3}}{\\frac{2\\pi}{a}} = \\sqrt{3}$$",
            "answer": "$$\\boxed{\\sqrt{3}}$$"
        },
        {
            "introduction": "掌握了埃瓦尔德求和法的构成部分后，我们进而探讨其物理后果。通过埃瓦尔德方法计算出的系统总能量会直接影响压力、自由能等所有热力学性质。本练习聚焦于一个关键问题：如何从总偶极矩相关的表面能项中推导出压力校正，这对于理解真空边界条件下的模拟至关重要，并清晰地展示了从微观静电公式到宏观可观测量（如压力）的联系。",
            "id": "3422423",
            "problem": "一个包含$N$个点电荷$\\{q_i\\}_{i=1}^{N}$的系统，在一个体积为$V$的立方模拟单元中，使用Ewald求和方法在真空边界条件下进行模拟。真空边界条件对应于将周期性重复的系统嵌入一个介电常数为$\\epsilon=1$的介质中。众所周知，对于这种边界条件，依赖于形状的表面项会贡献一个能量偏移，该偏移取决于总偶极矩$\\mathbf{M}=\\sum_{i=1}^{N} q_i \\mathbf{r}_i$。在库仑前置因子为1的约化静电单位下，一个被广泛使用且与实验一致的结果是，该表面项的能量贡献形式为与$|\\mathbf{M}|^{2}$成正比，与$V$成反比。\n\n从各向同性压力的热力学定义（即在分数坐标和粒子身份固定的情况下，势能对体积的负导数）出发，并假设在均匀各向同性膨胀期间，粒子位置$\\mathbf{r}_i$进行仿射缩放，使得$\\mathbf{r}_i \\mapsto \\lambda \\mathbf{r}_i$ 且 $\\lambda \\propto V^{1/3}$，请推导仅与上述真空表面项相关的压力修正项 $\\Delta P$ 的闭式解析表达式，该表达式用瞬时偶极矩大小 $M=|\\mathbf{M}|$ 和单元体积 $V$ 表示。\n\n使用以下经过充分检验的输入，您可以将其视为已知条件：在真空边界条件下，表面项能量偏移的形式为 $\\Delta E = \\frac{2\\pi}{3V} M^{2}$。请明确展示在各向同性膨胀下，$M$随$V$的缩放关系如何影响其对$V$的导数，并以约化静电单位给出$\\Delta P$的最终结果。您的最终答案必须是单个用$M$和$V$表示的闭式解析表达式。在最终的方框答案中不要包含单位。",
            "solution": "所陈述的问题在科学上是合理的、适定的和完整的。它描述了分子模拟中的一个标准场景，涉及计算在真空边界条件下由长程静电相互作用引起的压力修正。所提供的能量项和压力的热力学定义是正确且充分的，足以进行严格的推导。因此，我们可以开始解题。\n\n与势能项 $\\Delta E$ 相关联的压力修正项 $\\Delta P$，由各向同性压力的热力学关系定义。在粒子数及其分数坐标保持不变的情况下，压力是能量对体积的负导数。\n$$\n\\Delta P = -\\frac{d(\\Delta E)}{dV}\n$$\n问题指明了由真空边界Ewald求和中的表面效应引起的能量修正项为：\n$$\n\\Delta E = \\frac{2\\pi}{3V} M^{2}\n$$\n其中 $M=|\\mathbf{M}|$ 是模拟单元总偶极矩 $\\mathbf{M} = \\sum_{i=1}^{N} q_i \\mathbf{r}_i$ 的大小，而 $V$ 是单元体积。\n\n关键的是，在均匀各向同性膨胀下，粒子位置 $\\mathbf{r}_i$ 不是恒定的。问题陈述它们以一个与 $V^{1/3}$ 成正比的因子 $\\lambda$ 进行仿射缩放。我们可以将此缩放关系表示为 $\\mathbf{r}_i \\propto V^{1/3}$。这意味着总偶极矩矢量 $\\mathbf{M}$ 也随体积缩放：\n$$\n\\mathbf{M} = \\sum_{i=1}^{N} q_i \\mathbf{r}_i \\propto V^{1/3}\n$$\n因此，偶极矩的大小 $M = |\\mathbf{M}|$ 必须表现出相同的缩放行为：\n$$\nM \\propto V^{1/3}\n$$\n这可以写成方程 $M(V) = C V^{1/3}$，其中 $C$ 是一个常数，它依赖于电荷 $q_i$ 和粒子的固定分数坐标，但不依赖于体积 $V$。\n\n为了计算压力，我们必须对 $\\Delta E$ 求关于 $V$ 的导数。由于 $\\Delta E$ 同时是 $V$ 的显式函数和 $M(V)$ 的隐式函数，我们必须使用乘法法则和链式法则进行求导。\n$$\n\\Delta P = -\\frac{d}{dV} \\left( \\frac{2\\pi}{3} V^{-1} M(V)^{2} \\right)\n$$\n应用乘法法则 $(fg)' = f'g + fg'$，其中 $f(V) = V^{-1}$ 且 $g(V) = M(V)^2$：\n$$\n\\Delta P = -\\frac{2\\pi}{3} \\left[ \\left(\\frac{d(V^{-1})}{dV}\\right) M^{2} + V^{-1} \\left(\\frac{d(M^{2})}{dV}\\right) \\right]\n$$\n导数分别为：\n$$\n\\frac{d(V^{-1})}{dV} = -V^{-2}\n$$\n并对 $\\frac{d(M^2)}{dV}$ 使用链式法则：\n$$\n\\frac{d(M^{2})}{dV} = 2M \\frac{dM}{dV}\n$$\n将这些代入 $\\Delta P$ 的表达式中：\n$$\n\\Delta P = -\\frac{2\\pi}{3} \\left[ -V^{-2} M^{2} + V^{-1} \\left(2M \\frac{dM}{dV}\\right) \\right]\n$$\n$$\n\\Delta P = \\frac{2\\pi M^{2}}{3V^{2}} - \\frac{4\\pi M}{3V} \\frac{dM}{dV}\n$$\n为了继续计算，我们必须计算导数 $\\frac{dM}{dV}$。使用缩放关系 $M(V) = C V^{1/3}$：\n$$\n\\frac{dM}{dV} = \\frac{d}{dV}(C V^{1/3}) = C \\left(\\frac{1}{3} V^{-2/3}\\right)\n$$\n我们可以用 $M$ 和 $V$ 的瞬时值来表示常数 $C$。由 $M = C V^{1/3}$，我们得到 $C = M V^{-1/3}$。将此代回导数表达式中：\n$$\n\\frac{dM}{dV} = (M V^{-1/3}) \\left(\\frac{1}{3} V^{-2/3}\\right) = \\frac{M}{3} V^{-1/3 - 2/3} = \\frac{M}{3} V^{-1} = \\frac{M}{3V}\n$$\n现在，将这个关于 $\\frac{dM}{dV}$ 的表达式代入我们关于 $\\Delta P$ 的方程中：\n$$\n\\Delta P = \\frac{2\\pi M^{2}}{3V^{2}} - \\frac{4\\pi M}{3V} \\left(\\frac{M}{3V}\\right)\n$$\n$$\n\\Delta P = \\frac{2\\pi M^{2}}{3V^{2}} - \\frac{4\\pi M^{2}}{9V^{2}}\n$$\n为了合并这些项，我们进行通分：\n$$\n\\Delta P = \\left(\\frac{3}{3}\\right) \\frac{2\\pi M^{2}}{3V^{2}} - \\frac{4\\pi M^{2}}{9V^{2}} = \\frac{6\\pi M^{2}}{9V^{2}} - \\frac{4\\pi M^{2}}{9V^{2}}\n$$\n$$\n\\Delta P = \\frac{(6-4)\\pi M^{2}}{9V^{2}} = \\frac{2\\pi M^{2}}{9V^{2}}\n$$\n\n另一种方法是，我们可以先将 $M$ 的缩放关系代入能量表达式。\n$$\n\\Delta E(V) = \\frac{2\\pi}{3V} (C V^{1/3})^{2} = \\frac{2\\pi}{3V} C^{2} V^{2/3} = \\frac{2\\pi C^{2}}{3} V^{-1/3}\n$$\n现在，我们对这个简化的 $\\Delta E$ 表达式求关于 $V$ 的导数：\n$$\n\\frac{d(\\Delta E)}{dV} = \\frac{2\\pi C^{2}}{3} \\frac{d}{dV}(V^{-1/3}) = \\frac{2\\pi C^{2}}{3} \\left(-\\frac{1}{3} V^{-4/3}\\right) = -\\frac{2\\pi C^{2}}{9} V^{-4/3}\n$$\n压力修正项为 $\\Delta P = - \\frac{d(\\Delta E)}{dV}$：\n$$\n\\Delta P = - \\left(-\\frac{2\\pi C^{2}}{9} V^{-4/3}\\right) = \\frac{2\\pi C^{2}}{9} V^{-4/3}\n$$\n最后，我们代回 $C^{2} = (M V^{-1/3})^{2} = M^{2} V^{-2/3}$：\n$$\n\\Delta P = \\frac{2\\pi}{9} (M^{2} V^{-2/3}) V^{-4/3} = \\frac{2\\pi M^{2}}{9} V^{-2/3 - 4/3} = \\frac{2\\pi M^{2}}{9} V^{-6/3} = \\frac{2\\pi M^{2}}{9V^{2}}\n$$\n两种方法得到相同且一致的结果。压力修正项与偶极矩大小的平方成正比，与体积的平方成反比。",
            "answer": "$$\n\\boxed{\\frac{2\\pi M^{2}}{9 V^{2}}}\n$$"
        },
        {
            "introduction": "本练习将引导您解决一个在实践中至关重要的高阶问题：周期性体系中静电势参考点的模糊性，即 $k=0$ 项的处理。这个问题在模拟非各向同性体系（如真空中的水-表面界面）时尤为突出。通过结合理论推导与基于快速傅里叶变换 (FFT) 的数值编程实践，您将阐明不同的宏观边界条件（“锡箔”与“真空”）如何影响计算出的表面电势，这是表面科学研究中的一个核心物理量。",
            "id": "3422400",
            "problem": "考虑一个一维平面平均静电问题，该问题代表了在周期性边界条件（PBC）下一个分子动力学水板模型。设沿 $z$ 轴长度为 $L$ 的晶胞包含一个电荷密度分布 $\\rho(z)$，该分布以 $L$ 为周期，在一个周期内呈电中性，并且是局域化的，以至于存在可被解释为“体相水”和“真空层”的子区域。静电势 $\\phi(z)$ 由泊松方程定义\n$$\n\\frac{d^2 \\phi(z)}{dz^2} = -\\frac{\\rho(z)}{\\varepsilon_0},\n$$\n其中 $\\varepsilon_0$ 是国际单位制（SI）中的真空介电常数。在 PBC 条件下，可以用傅里叶级数表示 $\\phi(z)$ 和 $\\rho(z)$。在埃瓦尔德求和中，$\\phi(z)$ 的倒易空间解涉及除零波矢项 $k=0$ 之外的所有波矢。$k=0$ 项的处理设定了电势的参考点，并在物理上与宏观边界条件（例如，导电“锡箔”边界与真空边界）相关联。\n\n您的任务是，从第一性原理出发，推导 $k=0$ 处理方式的选择与电势空间平均值 $\\langle \\phi \\rangle$ 之间的关系，并数值上演示该选择如何改变所报告的“水的表面电势”——此处定义为相对于所选参考点的体相水电势。具体而言：\n\n1. 从 PBC 下泊松方程的傅里叶表示出发，证明 $k=0$ 处的傅里叶分量对应于 $\\phi(z)$ 中的一个恒定偏移量，并且将 $k=0$ 分量设为零会强制 $\\langle \\phi \\rangle = 0$。此选择对应于埃瓦尔德求和中的标准“锡箔”约定。\n\n2. 证明对 $k=0$ 分量的任何其他选择都会给 $\\phi(z)$ 增加一个常数 $c$，使得 $\\langle \\phi \\rangle = c$，并且相对于所选参考点的报告体相水电势会偏移 $c$。对于带有真空层的板模型，在真空参考约定中，通过选择 $c = -\\phi_\\text{tin}(z_\\text{vac})$，可以在真空子区域 $z \\in \\mathcal{V}$ 中设定 $\\phi(z_\\text{vac}) = 0$，其中 $\\phi_\\text{tin}(z)$ 是在 $k=0$ 设为零的情况下计算出的电势。\n\n3. 实现一个一维周期性泊松方程的数值求解器，使用快速傅里叶变换（FFT）从 $\\rho(z)$ 计算 $\\phi(z)$，并排除 $k=0$ 模式（锡箔处理）。然后，通过添加一个常数来形成真空参考电势，该常数被选择为使指定真空窗口内的平均电势为零。您的求解器必须计算两种参考下的报告体相水电势，并输出它们之间的偏移，该偏移等于参考常数 $c$。\n\n使用以下物理上合理的电荷密度测试套件，所有测试用例在晶胞内均为电中性：\n\n- 测试用例 1（平衡双电层，近对称）：$L = 5.0 \\times 10^{-9}\\ \\text{m}$，$N = 2048$ 个格点，$\\sigma = 0.2 \\times 10^{-9}\\ \\text{m}$，振幅 $A = 1.0 \\times 10^{6}\\ \\text{C/m}^3$，以及\n$$\n\\rho(z) = A \\left[ \\exp\\!\\left(-\\frac{(z - z_1)^2}{2\\sigma^2}\\right) - \\exp\\!\\left(-\\frac{(z - z_2)^2}{2\\sigma^2}\\right) \\right],\n$$\n其中 $z_1 = 2.0 \\times 10^{-9}\\ \\text{m}$ 且 $z_2 = 3.0 \\times 10^{-9}\\ \\text{m}$。将真空窗口 $\\mathcal{V}$ 定义为 $z \\in [0.0, 0.5] \\times 10^{-9}\\ \\text{m}$，体相水窗口 $\\mathcal{B}$ 定义为 $z \\in [2.4, 2.6] \\times 10^{-9}\\ \\text{m}$。\n\n- 测试用例 2（非对称类偶极子板）：$L$、$N$ 和 $\\sigma$ 相同，振幅 $A = 1.5 \\times 10^{6}\\ \\text{C/m}^3$，其中 $z_1 = 1.8 \\times 10^{-9}\\ \\text{m}$ 且 $z_2 = 3.2 \\times 10^{-9}\\ \\text{m}$。使用 $\\mathcal{V}$ 为 $z \\in [0.0, 0.5] \\times 10^{-9}\\ \\text{m}$，$\\mathcal{B}$ 为 $z \\in [2.45, 2.55] \\times 10^{-9}\\ \\text{m}$。\n\n- 测试用例 3（无电荷，边界情况）：$L$、$N$ 和 $\\sigma$ 相同，振幅 $A = 0\\ \\text{C/m}^3$，其中 $z_1$ 和 $z_2$ 可任意取值（不影响结果）。使用与测试用例 1 相同的 $\\mathcal{V}$ 和 $\\mathcal{B}$ 窗口。\n\n算法要求：\n\n- 使用快速傅里叶变换（FFT）计算单位晶胞上 $\\rho(z)$ 的离散傅里叶变换，并通过以下公式在傅里叶空间中求解 $\\phi(k)$：\n$$\n\\phi(k) = \\frac{\\rho(k)}{\\varepsilon_0 k^2},\\quad k \\neq 0,\n$$\n对于锡箔处理，$\\phi(k=0) = 0$。然后通过逆 FFT 获得 $\\phi(z)$。使用 $\\varepsilon_0 = 8.854187817 \\times 10^{-12}\\ \\text{F/m}$。\n\n- 通过添加一个常数 $c$ 来构建真空参考电势，使得真空窗口 $\\mathcal{V}$ 上的平均电势等于零。锡箔参考下的报告体相水电势是 $\\phi_\\text{tin}(z)$ 在 $\\mathcal{B}$ 上的平均值，而真空参考下的是 $\\phi_\\text{tin}(z) + c$ 在 $\\mathcal{B}$ 上的平均值。\n\n- 您的程序必须为每个测试用例计算一个浮点数，该浮点数等于真空参考下的报告体相水电势与锡箔参考下的报告体相水电势之差。这个差值等于常数 $c$，并且是由 $k=0$ 处理引起的偏移。\n\n输出规范：\n\n- 所有电势以伏特（V）表示，输出三个偏移量，为浮点数并四舍五入到六位小数。\n\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”）。\n\n科学真实性和推导约束：\n\n- 从泊松方程和 PBC 下傅里叶级数的定义开始推导。\n\n- 不要提供答案的快捷公式；推导应在逻辑上将 $k=0$ 处理与空间平均值 $\\langle \\phi \\rangle$ 以及报告的表面电势偏移联系起来。\n\n- 确保推导中的所有实体在上述物理和数学框架内都有明确定义。\n\n您最终提交的答案必须是一个完整的、可运行的 Python 程序，该程序实现求解器并生成指定的输出格式，无需任何用户输入。",
            "solution": "该问题要求推导一维周期性泊松问题中 $k=0$ 傅里叶模式的处理方式与所得静电势空间平均值之间的关系。此外，它还需要一个数值实现来计算水板模型在不同参考约定下的电势偏移。\n\n**从第一性原理推导**\n\n我们从一维泊松方程开始，该方程描述了在长度为 $L$ 的周期性边界条件系统内，由电荷密度 $\\rho(z)$ 产生的静电势 $\\phi(z)$：\n$$\n\\frac{d^2 \\phi(z)}{dz^2} = -\\frac{\\rho(z)}{\\varepsilon_0}\n$$\n其中 $\\varepsilon_0$ 是真空介电常数。由于 $\\phi(z)$ 和 $\\rho(z)$ 的周期为 $L$，它们可以表示为傅里叶级数：\n$$\n\\phi(z) = \\sum_{n=-\\infty}^{\\infty} \\phi_n e^{i k_n z} \\quad \\text{和} \\quad \\rho(z) = \\sum_{n=-\\infty}^{\\infty} \\rho_n e^{i k_n z}\n$$\n波矢由 $k_n = \\frac{2\\pi n}{L}$ 给出，其中 $n$ 为整数。傅里叶系数 $\\phi_n$ 和 $\\rho_n$ 定义为：\n$$\n\\phi_n = \\frac{1}{L} \\int_0^L \\phi(z) e^{-i k_n z} dz \\quad \\text{和} \\quad \\rho_n = \\frac{1}{L} \\int_0^L \\rho(z) e^{-i k_n z} dz\n$$\n为了将泊松方程变换到傅里叶空间，我们求出 $\\phi(z)$ 二阶导数的级数表示：\n$$\n\\frac{d^2 \\phi(z)}{dz^2} = \\frac{d^2}{dz^2} \\left( \\sum_{n=-\\infty}^{\\infty} \\phi_n e^{i k_n z} \\right) = \\sum_{n=-\\infty}^{\\infty} (i k_n)^2 \\phi_n e^{i k_n z} = \\sum_{n=-\\infty}^{\\infty} -k_n^2 \\phi_n e^{i k_n z}\n$$\n将 $\\phi(z)$ 和 $\\rho(z)$ 的级数代入泊松方程，我们得到：\n$$\n\\sum_{n=-\\infty}^{\\infty} -k_n^2 \\phi_n e^{i k_n z} = -\\frac{1}{\\varepsilon_0} \\sum_{n=-\\infty}^{\\infty} \\rho_n e^{i k_n z}\n$$\n根据傅里叶系数的唯一性，我们可以对每个 $n$ 值的项进行等同：\n$$\n-k_n^2 \\phi_n = -\\frac{\\rho_n}{\\varepsilon_0}\n$$\n对于所有非零波矢，即 $k_n \\neq 0$ ($n \\neq 0$)，我们可以解出电势系数 $\\phi_n$：\n$$\n\\phi_n = \\frac{\\rho_n}{\\varepsilon_0 k_n^2} \\quad (n \\neq 0)\n$$\n\n**$k=0$ 模式的作用**\n\n现在，我们必须考虑 $k=0$ 模式（即 $n=0$）的特殊情况。对于 $n=0$，波矢为 $k_0 = 0$。方程变为：\n$$\n-0^2 \\cdot \\phi_0 = -\\frac{\\rho_0}{\\varepsilon_0} \\implies 0 = \\rho_0\n$$\n这意味着泊松方程仅在电荷密度的 $n=0$ 傅里叶分量 $\\rho_0$ 为零时才是一致的。$\\rho_0$ 系数代表单位晶胞内的平均电荷密度：\n$$\n\\rho_0 = \\frac{1}{L} \\int_0^L \\rho(z) e^{-i (0) z} dz = \\frac{1}{L} \\int_0^L \\rho(z) dz = \\langle \\rho \\rangle\n$$\n问题陈述系统是电中性的，即 $\\int_0^L \\rho(z) dz = 0$，这通过使 $\\rho_0 = 0$ 确保了一致性。然而，虽然一致，但方程 $0=0$ 并未提供确定 $\\phi_0$ 值的信息。\n\n电势的 $n=0$ 系数 $\\phi_0$ 是其在单位晶胞内的空间平均值：\n$$\n\\phi_0 = \\frac{1}{L} \\int_0^L \\phi(z) e^{-i (0) z} dz = \\frac{1}{L} \\int_0^L \\phi(z) dz = \\langle \\phi \\rangle\n$$\n$\\phi_0$ 的不确定性反映了静电势的定义只到一个任意常数的精度。$\\phi_0$ 的选择设定了这个常数，从而固定了电势参考。\n\n**1. “锡箔”约定与 $\\langle \\phi \\rangle = 0$**\n\n周期性系统的标准埃瓦尔德求和约定，通常称为“锡箔”边界条件，通过将电势的 $k=0$ 分量设为零来解决这种不确定性：\n$$\n\\phi_0 = 0\n$$\n由于 $\\phi_0 = \\langle \\phi \\rangle$，这个选择等同于强制整个周期性晶胞内的平均电势为零：\n$$\n\\langle \\phi \\rangle = 0\n$$\n这个选择定义了一个唯一的电势分布，我们将其表示为 $\\phi_\\text{tin}(z)$。这完成了所需论证的第一部分。\n\n**2. 通用电势参考与偏移常数**\n\n对电势参考的任何其他选择都对应于为 $\\phi_0$ 选择一个非零值。让我们设 $\\phi_0 = c$，其中 $c$ 是一个常数。电势 $\\phi(z)$ 可以通过从其傅里叶级数中分离出 $n=0$ 项来书写：\n$$\n\\phi(z) = \\phi_0 e^{i(0)z} + \\sum_{n \\neq 0} \\phi_n e^{i k_n z} = c + \\sum_{n \\neq 0} \\frac{\\rho_n}{\\varepsilon_0 k_n^2} e^{i k_n z}\n$$\n右侧的求和项正是锡箔约定下的电势定义，即 $\\phi_\\text{tin}(z)$（其中 $\\phi_0=0$）。因此，任何通用解都通过一个常数偏移与锡箔解相关联：\n$$\n\\phi(z) = \\phi_\\text{tin}(z) + c\n$$\n此电势的空间平均值为 $\\langle \\phi \\rangle = \\langle \\phi_\\text{tin}(z) + c \\rangle = \\langle \\phi_\\text{tin}(z) \\rangle + \\langle c \\rangle = 0 + c = c$。\n\n对于包含真空区域的板模型模拟，一个物理上直观的参考是将在真空区域的电势设为零。这就是“真空参考”约定。为实现这一点，我们选择常数 $c$，使得在指定的真空窗口 $\\mathcal{V}$ 上的平均电势为零。设 $\\phi_\\text{vac}(z)$ 为该电势。\n$$\n\\langle \\phi_\\text{vac}(z) \\rangle_{\\mathcal{V}} = 0\n$$\n利用关系式 $\\phi_\\text{vac}(z) = \\phi_\\text{tin}(z) + c$，我们发现：\n$$\n\\langle \\phi_\\text{tin}(z) + c \\rangle_{\\mathcal{V}} = \\langle \\phi_\\text{tin}(z) \\rangle_{\\mathcal{V}} + c = 0\n$$\n这唯一地确定了偏移常数 $c$：\n$$\nc = - \\langle \\phi_\\text{tin}(z) \\rangle_{\\mathcal{V}}\n$$\n“表面电势”是相对于所选参考报告的体相水电势。当从锡箔参考转换到真空参考时，这个报告值的偏移为：\n$$\n\\text{Shift} = \\langle \\phi_\\text{vac} \\rangle_{\\mathcal{B}} - \\langle \\phi_\\text{tin} \\rangle_{\\mathcal{B}} = \\langle \\phi_\\text{tin} + c \\rangle_{\\mathcal{B}} - \\langle \\phi_\\text{tin} \\rangle_{\\mathcal{B}} = (\\langle \\phi_\\text{tin} \\rangle_{\\mathcal{B}} + c) - \\langle \\phi_\\text{tin} \\rangle_{\\mathcal{B}} = c\n$$\n因此，该偏移等于所确定的常数 $c$。这完成了所需论证的第二部分。\n\n**3. 通过快速傅里叶变换（FFT）的数值实现**\n\n数值解使用 FFT 来实现所推导的傅里叶空间解。算法步骤如下：\n1. 将域 $[0, L)$ 离散化为 $N$ 个点 $z_j$。\n2. 在此网格上计算电荷密度 $\\rho(z_j)$。\n3. 使用 FFT 算法计算电荷密度的离散傅里叶变换（DFT），$R_n = \\mathcal{F}[\\rho(z_j)]$。\n4. 确定与 DFT 频率对应的离散波矢 $k_n$。\n5. 在傅里叶空间中，计算电势的 DFT，$\\Phi_n = \\mathcal{F}[\\phi(z_j)]$。根据 DFT 和连续傅里叶级数系数之间的对应关系推导，该关系为 $\\Phi_n = R_n / (\\varepsilon_0 k_n^2)$。\n6. 通过设置 $k=0$ 分量为零来应用锡箔条件，即 $\\Phi_0 = 0$。对于所有其他 $k_n \\neq 0$ 的分量，计算 $\\Phi_n = R_n / (\\varepsilon_0 k_n^2)$。\n7. 通过应用逆 FFT 获得实空间的锡箔电势 $\\phi_\\text{tin}(z_j) = \\mathcal{F}^{-1}[\\Phi_n]$。舍弃由数值噪声引起的微小虚部。\n8. 识别真空窗口 $\\mathcal{V}$ 内的格点，并计算平均电势 $\\langle \\phi_\\text{tin} \\rangle_{\\mathcal{V}}$。\n9. 所需的电势偏移为 $c = - \\langle \\phi_\\text{tin} \\rangle_{\\mathcal{V}}$。为每个测试用例计算此值。\n对于 $\\rho(z)=0$ 的测试用例，我们预期 $\\phi_\\text{tin}(z)=0$，从而导致偏移 $c=0$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It computes the potential shift between 'tin-foil' and 'vacuum'\n    references for a 1D periodic charge distribution.\n    \"\"\"\n    \n    # Use the exact value for vacuum permittivity as specified in the problem.\n    epsilon_0 = 8.854187817e-12  # F/m\n\n    test_cases = [\n        {\n            \"L\": 5.0e-9, \"N\": 2048, \"sigma\": 0.2e-9, \"A\": 1.0e6,\n            \"z1\": 2.0e-9, \"z2\": 3.0e-9,\n            \"vac_win\": (0.0e-9, 0.5e-9),\n        },\n        {\n            \"L\": 5.0e-9, \"N\": 2048, \"sigma\": 0.2e-9, \"A\": 1.5e6,\n            \"z1\": 1.8e-9, \"z2\": 3.2e-9,\n            \"vac_win\": (0.0e-9, 0.5e-9),\n        },\n        {\n            \"L\": 5.0e-9, \"N\": 2048, \"sigma\": 0.2e-9, \"A\": 0.0,\n            \"z1\": 2.0e-9, \"z2\": 3.0e-9,\n            \"vac_win\": (0.0e-9, 0.5e-9),\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        shift = calculate_potential_shift(params, epsilon_0)\n        results.append(f\"{shift:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_potential_shift(params, epsilon_0):\n    \"\"\"\n    Calculates the potential shift for a single test case.\n\n    Args:\n        params (dict): A dictionary containing the parameters for the test case.\n        epsilon_0 (float): The vacuum permittivity.\n\n    Returns:\n        float: The calculated potential shift 'c'.\n    \"\"\"\n    L = params[\"L\"]\n    N = params[\"N\"]\n    sigma = params[\"sigma\"]\n    A = params[\"A\"]\n    z1 = params[\"z1\"]\n    z2 = params[\"z2\"]\n    vac_win = params[\"vac_win\"]\n\n    # 1. Define the spatial grid and charge density profile\n    z_grid = np.linspace(0, L, N, endpoint=False)\n    rho_z = A * (np.exp(-(z_grid - z1)**2 / (2 * sigma**2)) - \n                   np.exp(-(z_grid - z2)**2 / (2 * sigma**2)))\n\n    # 2. Solve for the 'tin-foil' potential using an FFT-based Poisson solver\n    phi_tin_z = solve_poisson_1d_pbc(rho_z, L, epsilon_0)\n\n    # 3. Identify indices for the vacuum window\n    vac_indices = np.where((z_grid >= vac_win[0]) & (z_grid < vac_win[1]))\n\n    if vac_indices[0].size == 0:\n        # This case should not occur with the problem's parameters\n        return np.nan\n\n    # 4. Calculate the average tin-foil potential in the vacuum window\n    mean_phi_in_vac = np.mean(phi_tin_z[vac_indices])\n\n    # 5. The shift 'c' is the negative of this average\n    c = -mean_phi_in_vac\n\n    return c\n\ndef solve_poisson_1d_pbc(rho_z, L, epsilon_0):\n    \"\"\"\n    Solves the 1D periodic Poisson equation d^2(phi)/dz^2 = -rho/epsilon_0\n    using FFTs, under the 'tin-foil' convention (k=0 mode of potential is zero).\n\n    Args:\n        rho_z (np.ndarray): The charge density on a uniform grid.\n        L (float): The length of the periodic cell.\n        epsilon_0 (float): The vacuum permittivity.\n\n    Returns:\n        np.ndarray: The electrostatic potential phi(z) on the grid.\n    \"\"\"\n    N = len(rho_z)\n    dz = L / N\n\n    # DFT of the charge density\n    rho_k = np.fft.fft(rho_z)\n    \n    # Wavevectors corresponding to the DFT frequencies\n    k = np.fft.fftfreq(N, d=dz) * 2 * np.pi\n    \n    # The DFT of the potential, phi_k, will be stored here.\n    # Initialize with zeros. The k=0 component remains zero ('tin-foil' convention).\n    phi_k = np.zeros_like(rho_k)\n    \n    # Find indices of non-zero wavevectors to avoid division by zero\n    nonzero_k_indices = np.where(k != 0)\n    \n    # Solve for phi_k for all k != 0\n    k_squared = k[nonzero_k_indices]**2\n    phi_k[nonzero_k_indices] = rho_k[nonzero_k_indices] / (epsilon_0 * k_squared)\n    \n    # Inverse DFT to get the potential in real space\n    phi_z = np.fft.ifft(phi_k)\n    \n    # The potential must be real; discard small imaginary parts from numerical error.\n    return phi_z.real\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}