{
    "hands_on_practices": [
        {
            "introduction": "任何分子力学模拟的核心是力场，它将系统的势能描述为原子坐标的函数。这个基础练习将复杂的能量函数分解为其组成部分。通过为一个简单的二肽计算来自键长伸缩、键角弯曲、二面角扭转和非键相互作用的能量贡献，您将对这些项如何共同定义分子的能量图景获得一个具体的理解。",
            "id": "3438948",
            "problem": "一个经典的分子力学参数化方案将生物分子系统的总势能 $U$ 建模为键合与非键合贡献之和。在此框架中，键的伸缩和角的弯曲由围绕平衡值的泰勒展开导出的谐波函数表示，扭转旋转由捕捉旋转异构现象的周期函数表示，而非键合相互作用则由范德华力（用Lennard–Jones势模拟）和静电作用（用库仑定律模拟）来解释。考虑一个带端基的二肽乙酰-丙氨酸-N-甲基酰胺 (Ace–Ala–Nme)，并仅关注以下单个相互作用：一个键、一个角、一个二面角和一个非键合原子对。使用以下势能定义\n$$\nU \\;=\\; \\frac{1}{2} k_{r} (r - r_{0})^{2} \\;+\\; \\frac{1}{2} k_{\\theta} (\\theta - \\theta_{0})^{2} \\;+\\; k_{\\phi}\\left[1 + \\cos(n \\phi - \\delta)\\right] \\;+\\; 4 \\epsilon_{ij} \\left[\\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{6}\\right] \\;+\\; k_{e} \\frac{q_{i} q_{j}}{r_{ij}} \\, ,\n$$\n其中所有角度均以弧度为单位，$\\cos(\\cdot)$ 使用弧度，并且 $U$ 以千焦/摩尔表示。单个相互作用和参数如下：\n\n- 羰基碳 $C$ 和肽氮 $N$ 之间的肽键的键伸缩：$r = 0.136\\,\\text{nm}$，$r_{0} = 0.133\\,\\text{nm}$，以及 $k_{r} = 3.10 \\times 10^{5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}^{-2}$。\n\n- $C$–$N$–$C_{\\alpha}$ 角的角弯曲：$\\theta = 2.10\\,\\text{rad}$，$\\theta_{0} = 2.05\\,\\text{rad}$，以及 $k_{\\theta} = 5.20 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{rad}^{-2}$。\n\n- 由 $C$–$N$–$C_{\\alpha}$–$C$ 定义的 Ramachandran $\\phi$ 角的二面角扭转：$\\phi = -\\frac{\\pi}{3}\\,\\text{rad}$，$k_{\\phi} = 3.00\\,\\text{kJ}\\,\\text{mol}^{-1}$，多重性 $n = 1$，相位 $\\delta = \\pi$。\n\n- 乙酰基甲基碳 $i$ 和 N-甲基氢 $j$ 之间的非键合对：$r_{ij} = 0.38\\,\\text{nm}$，$\\epsilon_{ij} = 0.20\\,\\text{kJ}\\,\\text{mol}^{-1}$，$\\sigma_{ij} = 0.34\\,\\text{nm}$，部分电荷 $q_{i} = -0.02\\,e$ 和 $q_{j} = +0.02\\,e$，以及静电转换常数 $k_{e} = 1.38935456 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}\\,e^{-2}$。\n\n使用上述定义计算这四种相互作用的总势能 $U$。以 $\\text{kJ}\\,\\text{mol}^{-1}$ 表示您的最终能量，并将答案四舍五入到四位有效数字。此外，定性地解释在此周期性扭转模型下，改变 $k_{\\phi}$ 如何影响与 $\\phi$ 相关的构象偏好。",
            "solution": "该问题陈述经证实具有科学依据、问题明确、客观且完整。它代表了在计算化学领域中使用分子力学力场进行的标准计算。所有必需的参数都已提供，任务定义清晰。\n\n总势能 $U$ 是所提供方程中定义的五个分量项之和：\n$$\nU \\;=\\; \\underbrace{\\frac{1}{2} k_{r} (r - r_{0})^{2}}_{U_{bond}} \\;+\\; \\underbrace{\\frac{1}{2} k_{\\theta} (\\theta - \\theta_{0})^{2}}_{U_{angle}} \\;+\\; \\underbrace{k_{\\phi}\\left[1 + \\cos(n \\phi - \\delta)\\right]}_{U_{dihedral}} \\;+\\; \\underbrace{4 \\epsilon_{ij} \\left[\\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{6}\\right]}_{U_{LJ}} \\;+\\; \\underbrace{k_{e} \\frac{q_{i} q_{j}}{r_{ij}}}_{U_{elec}}\n$$\n我们将分别计算这五个项中的每一项，然后将它们相加得到总势能 $U$。\n\n1.  **键伸缩势能 ($U_{bond}$)**\n    肽键伸缩的参数为 $k_{r} = 3.10 \\times 10^{5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}^{-2}$，$r = 0.136\\,\\text{nm}$ 和 $r_{0} = 0.133\\,\\text{nm}$。偏离平衡位置的位移为 $(r - r_{0}) = 0.136\\,\\text{nm} - 0.133\\,\\text{nm} = 0.003\\,\\text{nm}$。\n    $$\n    U_{bond} = \\frac{1}{2} (3.10 \\times 10^{5}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}^{-2}) (0.003\\,\\text{nm})^{2} = \\frac{1}{2} (3.10 \\times 10^{5}) (9.0 \\times 10^{-6})\\,\\text{kJ}\\,\\text{mol}^{-1} = 1.395\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\n2.  **角弯曲势能 ($U_{angle}$)**\n    $C$–$N$–$C_{\\alpha}$ 角弯曲的参数为 $k_{\\theta} = 5.20 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{rad}^{-2}$，$\\theta = 2.10\\,\\text{rad}$ 和 $\\theta_{0} = 2.05\\,\\text{rad}$。偏离平衡位置的位移为 $(\\theta - \\theta_{0}) = 2.10\\,\\text{rad} - 2.05\\,\\text{rad} = 0.05\\,\\text{rad}$。\n    $$\n    U_{angle} = \\frac{1}{2} (5.20 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{rad}^{-2}) (0.05\\,\\text{rad})^{2} = \\frac{1}{2} (520) (0.0025)\\,\\text{kJ}\\,\\text{mol}^{-1} = 0.65\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\n3.  **二面角扭转势能 ($U_{dihedral}$)**\n    Ramachandran $\\phi$ 角扭转的参数为 $k_{\\phi} = 3.00\\,\\text{kJ}\\,\\text{mol}^{-1}$，多重性 $n = 1$，相位 $\\delta = \\pi$，角度本身为 $\\phi = -\\frac{\\pi}{3}\\,\\text{rad}$。\n    余弦项的参数为 $n\\phi - \\delta = (1)(-\\frac{\\pi}{3}) - \\pi = -\\frac{4\\pi}{3}\\,\\text{rad}$。余弦值为 $\\cos(-\\frac{4\\pi}{3}) = \\cos(\\frac{4\\pi}{3}) = -\\frac{1}{2}$。\n    $$\n    U_{dihedral} = (3.00\\,\\text{kJ}\\,\\text{mol}^{-1}) \\left[1 + \\cos\\left(-\\frac{4\\pi}{3}\\right)\\right] = (3.00) \\left[1 - \\frac{1}{2}\\right]\\,\\text{kJ}\\,\\text{mol}^{-1} = 1.50\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\n4.  **非键合Lennard-Jones势能 ($U_{LJ}$)**\n    非键合对的参数为 $\\epsilon_{ij} = 0.20\\,\\text{kJ}\\,\\text{mol}^{-1}$，$\\sigma_{ij} = 0.34\\,\\text{nm}$，原子间距离为 $r_{ij} = 0.38\\,\\text{nm}$。\n    比值 $\\frac{\\sigma_{ij}}{r_{ij}} = \\frac{0.34\\,\\text{nm}}{0.38\\,\\text{nm}} = \\frac{17}{19}$。\n    我们来计算这个比值的必要幂次：\n    $(\\frac{17}{19})^{6} \\approx 0.496541$\n    $(\\frac{17}{19})^{12} = \\left((\\frac{17}{19})^{6}\\right)^{2} \\approx (0.496541)^{2} \\approx 0.246553$\n    $$\n    U_{LJ} = 4 (0.20\\,\\text{kJ}\\,\\text{mol}^{-1}) (0.246553 - 0.496541) = (0.80)(-0.249988)\\,\\text{kJ}\\,\\text{mol}^{-1} \\approx -0.19999\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\n5.  **非键合静电势能 ($U_{elec}$)**\n    参数为部分电荷 $q_{i} = -0.02\\,e$ 和 $q_{j} = +0.02\\,e$，距离 $r_{ij} = 0.38\\,\\text{nm}$，以及静电常数 $k_{e} = 1.38935456 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}\\,e^{-2}$。\n    电荷的乘积为 $q_{i}q_{j} = (-0.02\\,e)(+0.02\\,e) = -0.0004\\,e^{2} = -4 \\times 10^{-4}\\,e^{2}$。\n    $$\n    U_{elec} = (1.38935456 \\times 10^{2}\\,\\text{kJ}\\,\\text{mol}^{-1}\\,\\text{nm}\\,e^{-2}) \\frac{-4 \\times 10^{-4}\\,e^{2}}{0.38\\,\\text{nm}} \\approx -0.146248\\,\\text{kJ}\\,\\text{mol}^{-1}\n    $$\n\n总势能 $U$ 是这些分量的总和：\n$$\nU = U_{bond} + U_{angle} + U_{dihedral} + U_{LJ} + U_{elec}\n$$\n$$\nU \\approx (1.395 + 0.65 + 1.50 - 0.19999 - 0.146248)\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\nU \\approx (3.545 - 0.346238)\\,\\text{kJ}\\,\\text{mol}^{-1} = 3.198762\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n将最终结果四舍五入到四位有效数字，我们得到 $U = 3.199\\,\\text{kJ}\\,\\text{mol}^{-1}$。\n\n关于改变 $k_{\\phi}$ 的定性效应，该参数是二面角项的力常数，并定义了周期性势的振幅。围绕与角度 $\\phi$ 相关联的键旋转的能垒与 $k_{\\phi}$ 成正比。具体来说，该项的最高能量构象（势能最大值）和最低能量构象（势能最小值）之间的能量差为 $\\Delta U_{dihedral} = U_{max} - U_{min} = k_{\\phi}[1+1] - k_{\\phi}[1-1] = 2k_{\\phi}$。\n$k_{\\phi}$ 值的增加会导致更高的旋转能垒。这限制了分子的构象灵活性，使得二面角在能量上更难偏离其最小能量值。因此，对特定旋转异构体的构象偏好被加强了。相反，$k_{\\phi}$ 的减小会降低旋转能垒，这允许更大的构象自由度，并使更宽范围的二面角在热力学上是可及的。因此，$k_{\\phi}$ 有效地控制了扭转角的“刚度”并调节了构象偏好的强度。",
            "answer": "$$\n\\boxed{3.199}\n$$"
        },
        {
            "introduction": "虽然能量函数的形式是标准化的，但不同原子类型之间非键相互作用的具体参数并非总是直截了当的。本练习深入探讨 Lennard-Jones 势，重点关注“组合规则”在确定交叉相互作用参数中的关键作用。通过比较 Lorentz-Berthelot 和几何组合规则，您将量化这些细微的协议选择如何显著影响计算出的相互作用能，特别是对于重要的 1-4 内部接触。",
            "id": "3438972",
            "problem": "在用于分子动力学 (MD) 的分子力学参数化中，两个原子之间的非键范德华相互作用通过 Lennard-Jones (LJ) 势进行建模。该势源于短程泡利排斥和长程伦敦色散，并由原子类型参数 $\\sigma$（距离尺度）和 $\\epsilon$（势阱深度）表征。对于不同种类的原子，交叉相互作用参数 $(\\sigma_{ij}, \\epsilon_{ij})$ 通过组合规则获得，其选择是力场开发中的一个方案决策。考虑一个羰基氧和一个甲基氢之间的分子内 1-4 接触，它们相距 $r=2.5\\,\\mathrm{\\AA}$。羰基氧的 LJ 参数为 $\\sigma_{\\mathrm{O}}=3.00\\,\\mathrm{\\AA}$ 和 $\\epsilon_{\\mathrm{O}}=0.120\\,\\mathrm{kcal\\,mol^{-1}}$，甲基氢的 LJ 参数为 $\\sigma_{\\mathrm{H}}=2.50\\,\\mathrm{\\AA}$ 和 $\\epsilon_{\\mathrm{H}}=0.020\\,\\mathrm{kcal\\,mol^{-1}}$。将应用两种不同的组合规则：\n- Lorentz–Berthelot (LB) 组合规则：$\\sigma_{ij}=(\\sigma_{i}+\\sigma_{j})/2$ 和 $\\epsilon_{ij}=\\sqrt{\\epsilon_{i}\\epsilon_{j}}$。\n- 纯几何组合规则：$\\sigma_{ij}=\\sqrt{\\sigma_{i}\\sigma_{j}}$ 和 $\\epsilon_{ij}=\\sqrt{\\epsilon_{i}\\epsilon_{j}}$。\n\n从导致 LJ $12$–$6$ 形式的排斥和色散贡献的物理解释出发，推导在指定分离距离下每种组合规则的 LJ 相互作用能 $U_{ij}(r)$，以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位评估这两种能量，然后当 LJ 1-4 相互作用按 $U_{ij}^{(1\\text{–}4)}(r)=S_{14}\\,U_{ij}(r)$ 线性缩放时，分析 1-4 接触能对 1-4 缩放因子 $S_{14}$ 的敏感性。确定使经过 LB 缩放的 1-4 能量等于使用几何组合规则计算的未缩放能量的唯一 $S_{14}$ 值。将此 $S_{14}$ 表示为无量纲数，并将最终答案四舍五入至三位有效数字。对于在此过程中计算的任何能量值，请使用 $1\\,\\mathrm{kcal\\,mol^{-1}}=4.184\\,\\mathrm{kJ\\,mol^{-1}}$ 将其表示为 $\\mathrm{kJ\\,mol^{-1}}$。",
            "solution": "### 步骤 1：提取给定信息\n- 相互作用类型：羰基氧和甲基氢之间的非键范德华相互作用，具体为分子内 1-4 接触。\n- 势能形式：Lennard-Jones (LJ) $12$–$6$ 势，$U_{ij}(r)$。\n- 分离距离：$r=2.5\\,\\mathrm{\\AA}$。\n- 羰基氧参数：$\\sigma_{\\mathrm{O}}=3.00\\,\\mathrm{\\AA}$，$\\epsilon_{\\mathrm{O}}=0.120\\,\\mathrm{kcal\\,mol^{-1}}$。\n- 甲基氢参数：$\\sigma_{\\mathrm{H}}=2.50\\,\\mathrm{\\AA}$，$\\epsilon_{\\mathrm{H}}=0.020\\,\\mathrm{kcal\\,mol^{-1}}$。\n- Lorentz–Berthelot (LB) 组合规则：$\\sigma_{ij}=(\\sigma_{i}+\\sigma_{j})/2$ 和 $\\epsilon_{ij}=\\sqrt{\\epsilon_{i}\\epsilon_{j}}$。\n- 几何组合规则：$\\sigma_{ij}=\\sqrt{\\sigma_{i}\\sigma_{j}}$ 和 $\\epsilon_{ij}=\\sqrt{\\epsilon_{i}\\epsilon_{j}}$。\n- 1-4 缩放关系：$U_{ij}^{(1\\text{–}4)}(r)=S_{14}\\,U_{ij}(r)$。\n- $S_{14}$ 的条件：经 LB 缩放的 1-4 能量等于使用几何组合规则计算的未缩放能量。\n- 换算因子：$1\\,\\mathrm{kcal\\,mol^{-1}}=4.184\\,\\mathrm{kJ\\,mol^{-1}}$。\n- 所需精度：$S_{14}$ 的最终答案必须四舍五入到三位有效数字。\n\n### 步骤 2：使用提取的给定信息进行验证\n根据验证标准评估问题：\n- **科学依据**：该问题牢固地植根于分子力学和力场参数化的原理，这是计算化学和物理学中的一个标准课题。Lennard-Jones 势、组合规则和 1-4 缩放都是既定概念。\n- **问题明确**：问题提供了所有必要的参数、方程和明确的目标。该问题导向一个唯一的、可确定的数值答案。\n- **客观性**：语言精确且定量。没有主观或含糊的陈述。\n- 问题是自洽且内部一致的。它没有违反任何物理定律或数学原理。所有数据在量纲上都是一致的。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\nLennard-Jones (LJ) $12$–$6$ 势模拟了两个非键合原子 $i$ 和 $j$ 之间的范德华相互作用能，作为它们分离距离 $r$ 的函数。其一般形式为：\n$$U_{ij}(r) = 4\\epsilon_{ij}\\left[ \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6} \\right]$$\n这种函数形式具有物理动机。与 $r^{-12}$ 成正比的排斥项模拟了当电子云重叠时由泡利不相容原理引起的强短程排斥。与 $r^{-6}$ 成正比的吸引项模拟了由伦敦色散力（诱导偶极-诱导偶极相互作用）引起的较弱的长程吸引。参数 $\\epsilon_{ij}$ 和 $\\sigma_{ij}$ 分别代表势阱的深度和粒子间势能为零时的有限距离。\n\n对于不同种原子之间的相互作用（异原子相互作用），参数 $\\epsilon_{ij}$ 和 $\\sigma_{ij}$ 通常由同种原子的参数（$\\epsilon_i, \\sigma_i$ 和 $\\epsilon_j, \\sigma_j$）通过组合规则推导得出。我们现在将应用两种指定的规则。\n\n相互作用的原子是羰基氧（$\\mathrm{O}$）和甲基氢（$\\mathrm{H}$）。给定的参数是：\n$\\sigma_{\\mathrm{O}}=3.00\\,\\mathrm{\\AA}$，$\\epsilon_{\\mathrm{O}}=0.120\\,\\mathrm{kcal\\,mol^{-1}}$\n$\\sigma_{\\mathrm{H}}=2.50\\,\\mathrm{\\AA}$，$\\epsilon_{\\mathrm{H}}=0.020\\,\\mathrm{kcal\\,mol^{-1}}$\n\n首先，我们为每种组合规则计算交叉相互作用参数（$\\sigma_{\\mathrm{OH}}$，$\\epsilon_{\\mathrm{OH}}$）。\n\n**1. Lorentz–Berthelot (LB) 组合规则**\n对 $\\sigma$ 使用算术平均，对 $\\epsilon$ 使用几何平均。\n$$\\sigma_{\\mathrm{OH, LB}} = \\frac{\\sigma_{\\mathrm{O}} + \\sigma_{\\mathrm{H}}}{2} = \\frac{3.00\\,\\mathrm{\\AA} + 2.50\\,\\mathrm{\\AA}}{2} = 2.75\\,\\mathrm{\\AA}$$\n$$\\epsilon_{\\mathrm{OH, LB}} = \\sqrt{\\epsilon_{\\mathrm{O}}\\epsilon_{\\mathrm{H}}} = \\sqrt{(0.120\\,\\mathrm{kcal\\,mol^{-1}})(0.020\\,\\mathrm{kcal\\,mol^{-1}})} = \\sqrt{0.0024}\\,\\mathrm{kcal\\,mol^{-1}}$$\n\n**2. 几何组合规则**\n对 $\\sigma$ 和 $\\epsilon$ 均使用几何平均。\n$$\\sigma_{\\mathrm{OH, G}} = \\sqrt{\\sigma_{\\mathrm{O}}\\sigma_{\\mathrm{H}}} = \\sqrt{(3.00\\,\\mathrm{\\AA})(2.50\\,\\mathrm{\\AA})} = \\sqrt{7.5}\\,\\mathrm{\\AA}$$\n$$\\epsilon_{\\mathrm{OH, G}} = \\sqrt{\\epsilon_{\\mathrm{O}}\\epsilon_{\\mathrm{H}}} = \\sqrt{(0.120\\,\\mathrm{kcal\\,mol^{-1}})(0.020\\,\\mathrm{kcal\\,mol^{-1}})} = \\sqrt{0.0024}\\,\\mathrm{kcal\\,mol^{-1}}$$\n注意，两种方案的 $\\epsilon_{\\mathrm{OH}}$ 值相同，这简化了后续的比较。我们记 $\\epsilon_{\\mathrm{OH}} = \\sqrt{0.0024}\\,\\mathrm{kcal\\,mol^{-1}}$。\n\n接下来，我们在指定的分离距离 $r=2.5\\,\\mathrm{\\AA}$ 处，为每组参数计算 LJ 相互作用能。\n\n**使用 Lorentz–Berthelot 参数的能量 ($U_{\\mathrm{LB}}$):**\n$$U_{\\mathrm{LB}}(r) = 4\\epsilon_{\\mathrm{OH}}\\left[ \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{6} \\right]$$\n比值 $\\frac{\\sigma_{\\mathrm{OH, LB}}}{r} = \\frac{2.75\\,\\mathrm{\\AA}}{2.5\\,\\mathrm{\\AA}} = 1.1$。\n$$U_{\\mathrm{LB}} = 4\\sqrt{0.0024}\\left[ (1.1)^{12} - (1.1)^{6} \\right]\\,\\mathrm{kcal\\,mol^{-1}}$$\n$$U_{\\mathrm{LB}} \\approx 4(0.048990)\\left[ 3.1384 - 1.7716 \\right]\\,\\mathrm{kcal\\,mol^{-1}} \\approx 0.2679\\,\\mathrm{kcal\\,mol^{-1}}$$\n换算为 $\\mathrm{kJ\\,mol^{-1}}$：\n$$U_{\\mathrm{LB}} \\approx 0.2679\\,\\mathrm{kcal\\,mol^{-1}} \\times 4.184\\,\\mathrm{kJ\\,(kcal\\,mol^{-1})^{-1}} \\approx 1.121\\,\\mathrm{kJ\\,mol^{-1}}$$\n\n**使用几何参数的能量 ($U_{\\mathrm{G}}$):**\n$$U_{\\mathrm{G}}(r) = 4\\epsilon_{\\mathrm{OH}}\\left[ \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{6} \\right]$$\n比值 $\\frac{\\sigma_{\\mathrm{OH, G}}}{r} = \\frac{\\sqrt{7.5}\\,\\mathrm{\\AA}}{2.5\\,\\mathrm{\\AA}} = \\frac{\\sqrt{7.5}}{\\sqrt{6.25}} = \\sqrt{\\frac{7.5}{6.25}} = \\sqrt{1.2}$。\n$$U_{\\mathrm{G}} = 4\\sqrt{0.0024}\\left[ (\\sqrt{1.2})^{12} - (\\sqrt{1.2})^{6} \\right]\\,\\mathrm{kcal\\,mol^{-1}} = 4\\sqrt{0.0024}\\left[ (1.2)^{6} - (1.2)^{3} \\right]\\,\\mathrm{kcal\\,mol^{-1}}$$\n$$U_{\\mathrm{G}} \\approx 4(0.048990)\\left[ 2.9860 - 1.728 \\right]\\,\\mathrm{kcal\\,mol^{-1}} \\approx 0.2465\\,\\mathrm{kcal\\,mol^{-1}}$$\n换算为 $\\mathrm{kJ\\,mol^{-1}}$：\n$$U_{\\mathrm{G}} \\approx 0.2465\\,\\mathrm{kcal\\,mol^{-1}} \\times 4.184\\,\\mathrm{kJ\\,(kcal\\,mol^{-1})^{-1}} \\approx 1.031\\,\\mathrm{kJ\\,mol^{-1}}$$\n两种能量均为正值，表明存在净排斥相互作用，正如预期的那样，因为对于两套参数，距离 $r=2.5\\,\\mathrm{\\AA}$ 均处于势能的排斥区域。\n\n最后的任务是找到 1-4 缩放因子 $S_{14}$，使得经缩放的 LB 能量等于未缩放的几何能量。条件是：\n$$U_{\\mathrm{LB}}^{(1\\text{–}4)}(r) = U_{\\mathrm{G}}(r)$$\n使用缩放相互作用的定义，$U_{\\mathrm{LB}}^{(1\\text{–}4)}(r) = S_{14} \\, U_{\\mathrm{LB}}(r)$，我们有：\n$$S_{14} \\, U_{\\mathrm{LB}}(r) = U_{\\mathrm{G}}(r)$$\n解出 $S_{14}$：\n$$S_{14} = \\frac{U_{\\mathrm{G}}(r)}{U_{\\mathrm{LB}}(r)}$$\n我们可以代入能量的表达式：\n$$S_{14} = \\frac{4\\epsilon_{\\mathrm{OH}}\\left[ \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{6} \\right]}{4\\epsilon_{\\mathrm{OH}}\\left[ \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{6} \\right]}$$\n项 $4\\epsilon_{\\mathrm{OH}}$ 消去，突显出在这种情况下 $S_{14}$ 仅取决于 $\\sigma$ 参数和距离 $r$。\n$$S_{14} = \\frac{\\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, G}}}{r}\\right)^{6}}{\\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{\\mathrm{OH, LB}}}{r}\\right)^{6}}$$\n代入先前计算的比值：\n$$S_{14} = \\frac{(\\sqrt{1.2})^{12} - (\\sqrt{1.2})^{6}}{(1.1)^{12} - (1.1)^{6}} = \\frac{(1.2)^{6} - (1.2)^{3}}{(1.1)^{12} - (1.1)^{6}}$$\n现在，我们计算数值：\n$(1.2)^{3} = 1.728$\n$(1.2)^{6} = (1.2^3)^2 = (1.728)^2 = 2.985984$\n$(1.1)^{6} \\approx 1.771561$\n$(1.1)^{12} = ((1.1)^6)^2 \\approx (1.771561)^2 \\approx 3.138428$\n$$S_{14} = \\frac{2.985984 - 1.728}{3.138428 - 1.771561} = \\frac{1.257984}{1.366867} \\approx 0.92034$$\n此分析表明相互作用能对 $\\sigma$ 组合规则的选择很敏感。由于 $\\sigma_{\\mathrm{OH,LB}} > \\sigma_{\\mathrm{OH,G}}$，Lorentz-Berthelot 规则预测了“更大”的相互作用直径，导致在此短距离下产生更强的排斥相互作用。需要缩放因子 $S_{14}  1$ 来将更具排斥性的 LB 能量降低，以匹配来自几何规则的较弱排斥性的能量。\n\n将结果四舍五入到三位有效数字，得到 $0.920$。",
            "answer": "$$\\boxed{0.920}$$"
        },
        {
            "introduction": "现代力场参数化是一个复杂的优化挑战，需要在多个（通常是相互竞争的）目标之间权衡准确性。这个高级练习模拟了这一过程，要求您开发一个多目标损失函数，以同时拟合分子力学（MM）参数与量子力学（QM）能量及 QM 推导的系综性质。通过评估一组候选参数并识别帕累托最优前沿（Pareto-optimal front），您将探索在创建一个在不同物理标准下都表现良好的稳健力场时所固有的权衡。",
            "id": "3439000",
            "problem": "您的任务是形式化并计算一个用于肽二面角势的分子力学（MM）参数化的多目标损失，该参数化以一个合成的量子力学（QM）参考为基准，并在一组固定的候选参数向量中探索帕累托最优性。其背景是分子动力学中的蛋白质和肽参数化，目标是同时最小化 MM 和 QM 能量之间的差异，以及在指定热力学状态下 MM 和 QM 系综可观测量之间的差异。您必须生成一个单一、可运行的程序，执行所需的计算，并按指定格式输出结果。\n\n从基本原理开始：牛顿第二定律和势能的定义是力和平衡结构的基础，而来自统计力学的玻尔兹曼分布则决定了在特定温度下的平衡系综权重。在温度为 $T$ 的正则系综中，具有能量 $E_i$ 的离散微观状态 $i$ 的概率为 $p_i = \\exp(-\\beta E_i)/Z$，其中 $\\beta$ 是逆热能，配分函数为 $Z = \\sum_i \\exp(-\\beta E_i)$。\n\n假设一个用于肽骨架的粗粒化双二面角模型，其二面角为 $\\phi$ 和 $\\psi$。让微观状态由以弧度为单位的角度网格定义：\n$$\n\\phi \\in \\{-\\pi, -\\pi/2, 0, \\pi/2\\}, \\quad \\psi \\in \\{-\\pi, -\\pi/2, 0, \\pi/2\\},\n$$\n形成 $16$ 个离散的微观状态。所有角度均以弧度为单位。\n\n将合成的量子力学（QM）参考能量（单位为千焦/摩尔）定义为：\n$$\nE_{\\text{QM}}(\\phi,\\psi) = a_\\phi \\left(1 - \\cos(3\\phi)\\right) + a_\\psi \\left(1 - \\cos(3\\psi)\\right) + a_c \\left(1 - \\cos(\\phi - \\psi)\\right),\n$$\n其中系数是固定常数 $a_\\phi = 1.25\\,\\mathrm{kJ/mol}$，$a_\\psi = 0.95\\,\\mathrm{kJ/mol}$，以及 $a_c = 0.35\\,\\mathrm{kJ/mol}$。\n\n假设由 $\\boldsymbol{\\theta} = (k_\\phi, \\delta_\\phi, k_\\psi, \\delta_\\psi, c)$ 参数化的分子力学（MM）能量泛函为：\n$$\nE_{\\text{MM}}(\\phi,\\psi; \\boldsymbol{\\theta}) = k_\\phi \\left(1 - \\cos(3\\phi - \\delta_\\phi)\\right) + k_\\psi \\left(1 - \\cos(3\\psi - \\delta_\\psi)\\right) + c \\left(1 - \\cos(\\phi - \\psi)\\right),\n$$\n所有参数都具有物理意义的单位：$k_\\phi$、$k_\\psi$ 和 $c$ 的单位是 $\\mathrm{kJ/mol}$，相移 $\\delta_\\phi$ 和 $\\delta_\\psi$ 的单位是弧度。考虑以下六个候选参数向量 $\\boldsymbol{\\theta}^{(m)}$，其中 $m=1,\\dots,6$：\n$$\n\\boldsymbol{\\theta}^{(1)} = (1.00,\\, 0.00,\\, 1.00,\\, 0.00,\\, 0.30),\n$$\n$$\n\\boldsymbol{\\theta}^{(2)} = (0.80,\\, 0.30,\\, 1.20,\\, -0.20,\\, 0.25),\n$$\n$$\n\\boldsymbol{\\theta}^{(3)} = (1.40,\\, 0.50,\\, 0.90,\\, 0.40,\\, 0.40),\n$$\n$$\n\\boldsymbol{\\theta}^{(4)} = (0.60,\\, 1.00,\\, 1.50,\\, -0.50,\\, 0.20),\n$$\n$$\n\\boldsymbol{\\theta}^{(5)} = (1.10,\\, -0.30,\\, 1.10,\\, 0.30,\\, 0.35),\n$$\n$$\n\\boldsymbol{\\theta}^{(6)} = (0.90,\\, -0.70,\\, 0.70,\\, 0.70,\\, 0.50).\n$$\n\n将系综可观测量定义为“α-螺旋占有率” $O_{\\alpha}$，使用一组二面角位于典型 α 区域的微观状态，在温度 $T$ 下根据玻尔兹曼分布计算得出：\n$$\n\\mathcal{A} = \\{(\\phi, \\psi) \\mid \\phi \\in [-1.6, -0.6], \\ \\psi \\in [-1.2, 0.0]\\}.\n$$\n令 $p_i^{\\text{MM}}(\\boldsymbol{\\theta}; T)$ 和 $p_i^{\\text{QM}}(T)$ 分别表示使用 $E_{\\text{MM}}$ 和 $E_{\\text{QM}}$ 在 $16$ 个微观状态上的玻尔兹曼概率。使用气体常数 $R = 0.008314462618\\,\\mathrm{kJ/(mol\\cdot K)}$ 来确保单位一致性，因此逆热能为 $\\beta = 1/(R T)$。该可观测量为：\n$$\nO_{\\alpha}^{\\text{MM}}(\\boldsymbol{\\theta}; T) = \\sum_{i \\in \\mathcal{A}} p_i^{\\text{MM}}(\\boldsymbol{\\theta}; T), \\quad\nO_{\\alpha}^{\\text{QM}}(T) = \\sum_{i \\in \\mathcal{A}} p_i^{\\text{QM}}(T).\n$$\n\n令每个 $\\boldsymbol{\\theta}$ 的两个目标分量为：\n$$\nf_1(\\boldsymbol{\\theta}) = \\left(\\frac{1}{N}\\sum_{i=1}^{N} \\left[E_{\\text{MM},i}(\\boldsymbol{\\theta}) - E_{\\text{QM},i}\\right]^2\\right)^{1/2}\n$$\n其中 $N=16$ 是微观状态的数量，$E_{\\text{MM},i}, E_{\\text{QM},i}$ 表示在微观状态 $i$ 的能量，单位为 $\\mathrm{kJ/mol}$，以及\n$$\nf_2(\\boldsymbol{\\theta}; T) = \\left|O_{\\alpha}^{\\text{MM}}(\\boldsymbol{\\theta}; T) - O_{\\alpha}^{\\text{QM}}(T)\\right|.\n$$\n\n定义多目标标量化损失：\n$$\nL(\\boldsymbol{\\theta}; \\lambda_1, \\lambda_2, T) = \\lambda_1 \\, f_1(\\boldsymbol{\\theta}) + \\lambda_2 \\, f_2(\\boldsymbol{\\theta}; T),\n$$\n并如下定义帕累托支配：如果 $f_1(\\boldsymbol{\\theta}^{(a)}) \\le f_1(\\boldsymbol{\\theta}^{(b)})$ 并且 $f_2(\\boldsymbol{\\theta}^{(a)}; T) \\le f_2(\\boldsymbol{\\theta}^{(b)}; T)$，且至少有一个不等式是严格的，则参数向量 $\\boldsymbol{\\theta}^{(a)}$ 支配 $\\boldsymbol{\\theta}^{(b)}$；如果一个参数向量没有被任何其他候选向量支配，则它是帕累托最优的。\n\n角度单位规范：所有角度必须以弧度为单位。物理单位规范：能量单位为 $\\mathrm{kJ/mol}$，温度单位为 $\\mathrm{K}$。\n\n您的程序必须为以下每个测试用例计算最小化 $L(\\boldsymbol{\\theta}; \\lambda_1, \\lambda_2, T)$ 的参数向量的索引（使用基于 1 的索引）以及在给定 $T$ 下，目标 $(f_1, f_2)$ 下的帕累托最优参数向量的基于 1 的索引的排序列表：\n\n- 测试用例 1：$T = 300\\,\\mathrm{K}$，$\\lambda_1 = 1.0$，$\\lambda_2 = 1.0$。\n- 测试用例 2：$T = 100\\,\\mathrm{K}$，$\\lambda_1 = 1.0$，$\\lambda_2 = 0.5$。\n- 测试用例 3：$T = 600\\,\\mathrm{K}$，$\\lambda_1 = 0.5$，$\\lambda_2 = 2.0$。\n- 测试用例 4：$T = 300\\,\\mathrm{K}$，$\\lambda_1 = 0.0$，$\\lambda_2 = 1.0$。\n- 测试用例 5：$T = 1000\\,\\mathrm{K}$，$\\lambda_1 = 1.0$，$\\lambda_2 = 0.1$。\n\n所需的最终输出格式是一行，包含所有测试用例结果的逗号分隔列表，并用方括号括起来，其中每个测试用例的结果是一个双元素列表，包含最佳索引和帕累托最优索引列表。例如，格式必须是：\n`[ [i_1, [p_{1,1}, p_{1,2}, \\dots]], [i_2, [p_{2,1}, \\dots]], \\dots ]`\n不含任何额外文本。索引集必须是整数；最终程序输出行中不允许出现其他单位、符号或文本。确保所有计算都严格遵循上述定义，并且在整个过程中角度以弧度为单位，能量以 $\\mathrm{kJ/mol}$ 为单位，温度以 $\\mathrm{K}$ 为单位。该测试套件涵盖了平衡情况、低温和高温极限，以及通过权重 $\\lambda_1$ 和 $\\lambda_2$ 强调能量匹配或系综匹配目标的情况。",
            "solution": "该任务是为一个简化的肽模型参数化形式化并计算多目标损失。这涉及到将一个分子力学（MM）能量函数与一个合成的量子力学（QM）参考进行比较。评估既考虑了直接的能量差异，也考虑了在给定温度下系综平均可观测量的差异。问题要求基于一个标量化的损失函数，从给定的离散候选列表中识别最优的参数集，并确定非支配的，即帕累托最优的参数集。\n\n### 1. 理论框架\n\n#### 1.1. 物理模型与能量函数\n该系统是一个简化的肽骨架模型，由两个二面角 $\\phi$ 和 $\\psi$ 描述。构象空间被离散化为 $N=16$ 个微观状态，由一个角度网格定义：\n$$\n\\phi \\in \\{-\\pi, -\\pi/2, 0, \\pi/2\\} \\quad \\text{和} \\quad \\psi \\in \\{-\\pi, -\\pi/2, 0, \\pi/2\\}\n$$\n所有角度均以弧度为单位。\n\n对于给定的构象 $(\\phi, \\psi)$，参考的量子力学（QM）能量由以下公式给出：\n$$\nE_{\\text{QM}}(\\phi,\\psi) = a_\\phi (1 - \\cos(3\\phi)) + a_\\psi (1 - \\cos(3\\psi)) + a_c (1 - \\cos(\\phi - \\psi))\n$$\n其中系数是固定的：$a_\\phi = 1.25\\,\\mathrm{kJ/mol}$，$a_\\psi = 0.95\\,\\mathrm{kJ/mol}$，以及 $a_c = 0.35\\,\\mathrm{kJ/mol}$。\n\n相应的分子力学（MM）能量函数由向量 $\\boldsymbol{\\theta} = (k_\\phi, \\delta_\\phi, k_\\psi, \\delta_\\psi, c)$ 参数化：\n$$\nE_{\\text{MM}}(\\phi,\\psi; \\boldsymbol{\\theta}) = k_\\phi (1 - \\cos(3\\phi - \\delta_\\phi)) + k_\\psi (1 - \\cos(3\\psi - \\delta_\\psi)) + c (1 - \\cos(\\phi - \\psi))\n$$\n参数 $k_\\phi, k_\\psi, c$ 是力常数，单位为 $\\mathrm{kJ/mol}$，而 $\\delta_\\phi, \\delta_\\psi$ 是相移，单位为弧度。我们得到了六个候选参数向量 $\\boldsymbol{\\theta}^{(1)}, \\dots, \\boldsymbol{\\theta}^{(6)}$。\n\n#### 1.2. 统计力学与系综可观测量\n根据统计力学，在给定温度 $T$ 的正则系综中，系统占据能量为 $E_i$ 的微观状态 $i$ 的概率 $p_i$ 由玻尔兹曼分布给出：\n$$\np_i = \\frac{\\exp(-\\beta E_i)}{Z}\n$$\n其中 $\\beta = 1/(RT)$ 是逆热能，$R = 0.008314462618\\,\\mathrm{kJ/(mol\\cdot K)}$ 是气体常数，$Z = \\sum_j \\exp(-\\beta E_j)$ 是配分函数，用于归一化概率。为了防止当指数很大时出现数值溢出问题，在计算上审慎的做法是通过减去最小能量 $E_{\\min}$ 来计算概率：\n$$\np_i = \\frac{\\exp(-\\beta (E_i - E_{\\min}))}{\\sum_j \\exp(-\\beta (E_j - E_{\\min}))}\n$$\n问题定义了一个特定的系综可观测量，即“α-螺旋占有率” $O_{\\alpha}$，它是所有位于 α-螺旋区域 $\\mathcal{A}$ 内的微观状态 $(\\phi_i, \\psi_i)$ 的概率之和：\n$$\n\\mathcal{A} = \\{(\\phi, \\psi) \\mid \\phi \\in [-1.6, -0.6], \\ \\psi \\in [-1.2, 0.0]\\}\n$$\n$$\nO_{\\alpha} = \\sum_{i \\mid (\\phi_i, \\psi_i) \\in \\mathcal{A}} p_i\n$$\n从离散的角度网格来看，唯一满足这些条件的微观状态是 $(\\phi, \\psi) = (-\\pi/2, 0)$，因为 $-\\pi/2 \\approx -1.5708 \\in [-1.6, -0.6]$ 且 $0 \\in [-1.2, 0.0]$。因此，对于这个问题，$O_{\\alpha}$ 就是这个单一微观状态的玻尔兹曼概率。\n\n### 2. 多目标优化\n目标是找到能够同时满足两个目标的 MM 参数 $\\boldsymbol{\\theta}$：\n1.  **能量匹配**：在所有微观状态上，MM 能量应接近 QM 能量。这通过能量的均方根误差（RMSE）来量化，记为 $f_1(\\boldsymbol{\\theta})$：\n    $$\n    f_1(\\boldsymbol{\\theta}) = \\left(\\frac{1}{N}\\sum_{i=1}^{N} \\left[E_{\\text{MM},i}(\\boldsymbol{\\theta}) - E_{\\text{QM},i}\\right]^2\\right)^{1/2}\n    $$\n2.  **可观测量匹配**：由 MM 推导的系综可观测量应与由 QM 推导的相匹配。这通过 α-螺旋占有率的绝对差来量化，记为 $f_2(\\boldsymbol{\\theta}; T)$:\n    $$\n    f_2(\\boldsymbol{\\theta}; T) = \\left|O_{\\alpha}^{\\text{MM}}(\\boldsymbol{\\theta}; T) - O_{\\alpha}^{\\text{QM}}(T)\\right|\n    $$\n注意 $f_1$ 与温度无关，而 $f_2$ 通过玻尔兹曼概率依赖于温度。\n\n解决多目标问题的一个常用方法是标量化，即将多个目标组合成一个单一的标量损失函数 $L$。这里使用加权和：\n$$\nL(\\boldsymbol{\\theta}; \\lambda_1, \\lambda_2, T) = \\lambda_1 \\, f_1(\\boldsymbol{\\theta}) + \\lambda_2 \\, f_2(\\boldsymbol{\\theta}; T)\n$$\n对于给定的权重 $\\lambda_1, \\lambda_2$ 和温度 $T$，最小化 $L$ 的参数集被认为是最佳的。\n\n另一个重要概念是帕累托最优性。如果一个参数向量 $\\boldsymbol{\\theta}^{(a)}$ 在所有目标上都优于或等于另一个向量 $\\boldsymbol{\\theta}^{(b)}$，并且至少在一个目标上严格更优，那么它就**支配** $\\boldsymbol{\\theta}^{(b)}$。形式上：\n$$\nf_1(\\boldsymbol{\\theta}^{(a)}) \\le f_1(\\boldsymbol{\\theta}^{(b)}) \\quad \\text{并且} \\quad f_2(\\boldsymbol{\\theta}^{(a)}; T) \\le f_2(\\boldsymbol{\\theta}^{(b)}; T)\n$$\n其中至少有一个不等式是严格的。\n如果一个参数向量没有被集合中任何其他候选向量支配，则它是**帕累托最优的**。所有这些向量的集合构成了帕累托前沿，代表了相互竞争的目标之间的最佳权衡。\n\n### 3. 计算流程\n该问题通过为每个测试用例系统地评估六个候选参数向量 $\\boldsymbol{\\theta}^{(m)}$ 中的每一个来解决。\n\n1.  **初始化**：定义常数（$a_\\phi, a_\\psi, a_c, R$）、$16$ 个微观状态 $(\\phi_i, \\psi_i)$ 的网格，以及六个候选参数向量 $\\boldsymbol{\\theta}^{(m)}$。\n2.  **参考计算**：计算所有 $16$ 个微观状态的 QM 能量 $E_{\\text{QM},i}$。这些对于所有测试用例都是恒定的。识别对应于 α-螺旋区域 $\\mathcal{A}$ 的索引。\n3.  **遍历测试用例**：对于每个指定的测试用例 $(T, \\lambda_1, \\lambda_2)$:\n    a. 计算逆热能 $\\beta = 1/(RT)$。\n    b. 计算 QM 玻尔兹曼概率 $p_i^{\\text{QM}}(T)$ 和参考可观测量 $O_{\\alpha}^{\\text{QM}}(T)$。\n    c. **遍历候选参数**：对于每个 $\\boldsymbol{\\theta}^{(m)}$ ($m=1, \\dots, 6$):\n        i.  计算所有微观状态的 MM 能量 $E_{\\text{MM},i}(\\boldsymbol{\\theta}^{(m)})$。\n        ii. 计算能量目标 $f_1(\\boldsymbol{\\theta}^{(m)})$。该值与温度无关，可以为每个 $\\boldsymbol{\\theta}^{(m)}$ 预先计算。\n        iii. 计算 MM 玻尔兹曼概率 $p_i^{\\text{MM}}(\\boldsymbol{\\theta}^{(m)}; T)$ 和可观测量 $O_{\\alpha}^{\\text{MM}}(\\boldsymbol{\\theta}^{(m)}; T)$。\n        iv. 计算可观测量目标 $f_2(\\boldsymbol{\\theta}^{(m)}; T)$。\n        v.  计算标量化损失 $L(\\boldsymbol{\\theta}^{(m)}; \\lambda_1, \\lambda_2, T)$。\n    d. **对当前测试用例进行分析**：\n        i.  从计算出的 $L$ 值数组中，找到对应于最小值的索引 $m$。这是标量化下的最佳参数集的索引。\n        ii. 从目标对 $(f_1^{(m)}, f_2^{(m)})$ 的数组中，通过执行成对支配检查来识别帕累托最优索引集。如果不存在其他索引 $j$ 使得 $\\boldsymbol{\\theta}^{(j)}$ 支配 $\\boldsymbol{\\theta}^{(m)}$，则索引 $m$ 是帕累托最优的。\n    e. **存储结果**：存储 $L$ 的最佳索引和帕累托最优索引的排序列表。\n4.  **最终输出**：将所有测试用例收集的结果格式化为指定的单行字符串格式。所有报告的索引均使用基于 1 的索引。\n\n此流程在以下程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes multiobjective loss and Pareto-optimal sets for peptide parameterization.\n    \"\"\"\n    # Define physical constants and model parameters\n    R = 0.008314462618  # Gas constant in kJ/(mol*K)\n    A_PHI, A_PSI, A_C = 1.25, 0.95, 0.35  # QM energy coefficients\n\n    # Define the discrete microstate grid\n    phi_vals = np.array([-np.pi, -np.pi / 2.0, 0.0, np.pi / 2.0])\n    psi_vals = np.array([-np.pi, -np.pi / 2.0, 0.0, np.pi / 2.0])\n    phi_grid, psi_grid = np.meshgrid(phi_vals, psi_vals)\n    phi_flat = phi_grid.flatten()\n    psi_flat = psi_grid.flatten()\n\n    # Define the six candidate MM parameter vectors theta\n    thetas = [\n        (1.00, 0.00, 1.00, 0.00, 0.30),\n        (0.80, 0.30, 1.20, -0.20, 0.25),\n        (1.40, 0.50, 0.90, 0.40, 0.40),\n        (0.60, 1.00, 1.50, -0.50, 0.20),\n        (1.10, -0.30, 1.10, 0.30, 0.35),\n        (0.90, -0.70, 0.70, 0.70, 0.50),\n    ]\n\n    # Define the test cases\n    test_cases = [\n        (300.0, 1.0, 1.0),\n        (100.0, 1.0, 0.5),\n        (600.0, 0.5, 2.0),\n        (300.0, 0.0, 1.0),\n        (1000.0, 1.0, 0.1),\n    ]\n\n    # Helper functions for energy calculation\n    def e_qm_func(phi, psi):\n        return A_PHI * (1.0 - np.cos(3.0 * phi)) + \\\n               A_PSI * (1.0 - np.cos(3.0 * psi)) + \\\n               A_C * (1.0 - np.cos(phi - psi))\n\n    def e_mm_func(phi, psi, theta):\n        k_phi, d_phi, k_psi, d_psi, c = theta\n        return k_phi * (1.0 - np.cos(3.0 * phi - d_phi)) + \\\n               k_psi * (1.0 - np.cos(3.0 * psi - d_psi)) + \\\n               c * (1.0 - np.cos(phi - psi))\n\n    def calculate_boltzmann_probs(energies, beta):\n        # Numerically stable calculation of Boltzmann probabilities\n        min_e = np.min(energies)\n        rel_e = energies - min_e\n        exp_e = np.exp(-beta * rel_e)\n        z = np.sum(exp_e)\n        return exp_e / z\n\n    # Pre-compute QM energies (temperature-independent)\n    e_qm_values = e_qm_func(phi_flat, psi_flat)\n\n    # Pre-identify microstates in the alpha-helix region\n    alpha_indices = np.where(\n        (phi_flat = -1.6)  (phi_flat = -0.6)  \n        (psi_flat = -1.2)  (psi_flat = 0.0)\n    )[0]\n\n    # Pre-compute f1 objective values (temperature-independent)\n    f1_all_thetas = []\n    e_mm_all_thetas = []\n    for theta in thetas:\n        e_mm_values = e_mm_func(phi_flat, psi_flat, theta)\n        e_mm_all_thetas.append(e_mm_values)\n        f1 = np.sqrt(np.mean((e_mm_values - e_qm_values)**2))\n        f1_all_thetas.append(f1)\n    \n    e_mm_all_thetas = np.array(e_mm_all_thetas)\n\n    # --- Main computation loop ---\n    all_results = []\n    for T, lambda1, lambda2 in test_cases:\n        beta = 1.0 / (R * T)\n\n        # Calculate QM properties for the given temperature\n        p_qm = calculate_boltzmann_probs(e_qm_values, beta)\n        o_alpha_qm = np.sum(p_qm[alpha_indices])\n\n        f2_vals, L_vals = [], []\n\n        # Calculate MM properties for each theta at the given temperature\n        for i, theta in enumerate(thetas):\n            e_mm_values = e_mm_all_thetas[i]\n            \n            # f2 calculation\n            p_mm = calculate_boltzmann_probs(e_mm_values, beta)\n            o_alpha_mm = np.sum(p_mm[alpha_indices])\n            f2 = np.abs(o_alpha_mm - o_alpha_qm)\n            f2_vals.append(f2)\n\n            # L (scalarized loss) calculation\n            L = lambda1 * f1_all_thetas[i] + lambda2 * f2\n            L_vals.append(L)\n\n        # Find the index of the parameter vector that minimizes L\n        best_L_index = np.argmin(L_vals) + 1  # 1-based indexing\n\n        # Find the set of Pareto-optimal parameter vectors\n        objectives = np.array([f1_all_thetas, f2_vals]).T\n        pareto_indices = []\n        for i in range(len(thetas)):\n            is_dominated = False\n            for j in range(len(thetas)):\n                if i == j:\n                    continue\n                # Check if theta_j dominates theta_i\n                if (objectives[j, 0] = objectives[i, 0] and\n                    objectives[j, 1] = objectives[i, 1]) and \\\n                   (objectives[j, 0]  objectives[i, 0] or\n                    objectives[j, 1]  objectives[i, 1]):\n                    is_dominated = True\n                    break\n            if not is_dominated:\n                pareto_indices.append(i + 1)  # 1-based indexing\n        \n        pareto_indices.sort()\n\n        all_results.append([best_L_index, pareto_indices])\n\n    # Format the final output string exactly as required\n    result_str = str(all_results).replace(\" \", \"\")\n    print(result_str)\n\nsolve()\n```"
        }
    ]
}