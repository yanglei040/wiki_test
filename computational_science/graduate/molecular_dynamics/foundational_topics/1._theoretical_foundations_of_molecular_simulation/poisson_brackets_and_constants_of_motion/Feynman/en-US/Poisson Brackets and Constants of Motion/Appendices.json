{
    "hands_on_practices": [
        {
            "introduction": "Mastering the algebraic structure of physical observables is a cornerstone of advanced mechanics. This first exercise provides essential practice in manipulating Poisson brackets, focusing on the components of total angular momentum, $\\mathbf{L}$. By deriving the fundamental Poisson bracket relation between these components from first principles, you will solidify your understanding of how these quantities form a closed algebra, a concept that is central to the theory of symmetries and is the direct classical analogue of commutation relations in quantum mechanics.",
            "id": "3435750",
            "problem": "Consider a classical Molecular Dynamics (MD) system of $N$ point particles in three spatial dimensions, with particle labels $a \\in \\{1,\\dots,N\\}$. Let the canonical coordinates be the positions $\\mathbf{r}_{a} \\in \\mathbb{R}^{3}$ and canonical momenta $\\mathbf{p}_{a} \\in \\mathbb{R}^{3}$, with the fundamental Poisson bracket definition\n$$\n\\{A,B\\} \\equiv \\sum_{a=1}^{N} \\sum_{i=1}^{3} \\left( \\frac{\\partial A}{\\partial r_{a,i}} \\frac{\\partial B}{\\partial p_{a,i}} - \\frac{\\partial A}{\\partial p_{a,i}} \\frac{\\partial B}{\\partial r_{a,i}} \\right),\n$$\nwhere $r_{a,i}$ and $p_{a,i}$ are the Cartesian components of $\\mathbf{r}_{a}$ and $\\mathbf{p}_{a}$, respectively. The Hamiltonian is\n$$\nH(\\{\\mathbf{r}_{a},\\mathbf{p}_{a}\\}) \\equiv \\sum_{a=1}^{N} \\frac{|\\mathbf{p}_{a}|^{2}}{2 m_{a}} + \\sum_{1 \\le a  b \\le N} V\\!\\left(|\\mathbf{r}_{a}-\\mathbf{r}_{b}|\\right),\n$$\nwhere $m_{a}0$ are particle masses and $V$ is a smooth pair potential that depends only on interparticle distances. Define the total angular momentum\n$$\n\\mathbf{L} \\equiv \\sum_{a=1}^{N} \\mathbf{r}_{a} \\times \\mathbf{p}_{a},\n$$\nand denote by $\\varepsilon_{ijk}$ the Levi-Civita symbol with $\\varepsilon_{123}=+1$. Let $\\mathbf{a}, \\mathbf{b} \\in \\mathbb{R}^{3}$ be fixed, time-independent vectors.\n\nUsing only the fundamental definition of the Poisson bracket above and the canonical structure implied by it, compute the Poisson bracket $\\{ \\mathbf{L} \\cdot \\mathbf{a}, \\mathbf{L} \\cdot \\mathbf{b} \\}$ and express your final answer solely as a compact analytic expression involving only $\\mathbf{L}$, $\\mathbf{a}$, and $\\mathbf{b}$ (and standard vector operations on them). Do not introduce any additional variables or assumptions beyond those stated here. Your answer must be a single closed-form expression. No numerical approximation is required and no units are to be reported.",
            "solution": "Let the quantities of interest be $A \\equiv \\mathbf{L} \\cdot \\mathbf{a}$ and $B \\equiv \\mathbf{L} \\cdot \\mathbf{b}$. We wish to compute $\\{A, B\\}$.\nIn terms of Cartesian components, we can write:\n$$\nA = \\sum_{j=1}^{3} L_j a_j \\quad \\text{and} \\quad B = \\sum_{k=1}^{3} L_k b_k\n$$\nwhere $L_j$, $a_j$, and $b_k$ are the $j$-th and $k$-th components of the vectors $\\mathbf{L}$, $\\mathbf{a}$, and $\\mathbf{b}$, respectively.\n\nThe Poisson bracket is a bilinear operator. Since the components $a_j$ and $b_k$ of the vectors $\\mathbf{a}$ and $\\mathbf{b}$ are fixed constants, they do not depend on the canonical coordinates $(\\mathbf{r}_a, \\mathbf{p}_a)$. Therefore, their partial derivatives are zero, and they can be factored out of the Poisson bracket:\n$$\n\\{A, B\\} = \\left\\{ \\sum_{j=1}^{3} L_j a_j, \\sum_{k=1}^{3} L_k b_k \\right\\} = \\sum_{j,k=1}^{3} a_j b_k \\{L_j, L_k\\}\n$$\nThe core of the problem reduces to calculating the Poisson bracket between the components of the total angular momentum, $\\{L_j, L_k\\}$.\n\nThe $j$-th component of the total angular momentum $\\mathbf{L}$ is given by:\n$$\nL_j = \\sum_{a=1}^{N} (\\mathbf{r}_a \\times \\mathbf{p}_a)_j = \\sum_{a=1}^{N} \\sum_{l,m=1}^{3} \\varepsilon_{jlm} r_{a,l} p_{a,m}\n$$\nTo compute $\\{L_j, L_k\\}$, we use the fundamental definition of the Poisson bracket. First, we find the partial derivatives of $L_j$ with respect to the canonical coordinates $r_{c,s}$ and $p_{c,s}$ for a particle $c$:\n$$\n\\frac{\\partial L_j}{\\partial r_{c,s}} = \\frac{\\partial}{\\partial r_{c,s}} \\left( \\sum_{a=1}^{N} \\sum_{l,m=1}^{3} \\varepsilon_{jlm} r_{a,l} p_{a,m} \\right) = \\sum_{a=1}^{N} \\sum_{l,m=1}^{3} \\varepsilon_{jlm} \\delta_{ac} \\delta_{ls} p_{a,m} = \\sum_{m=1}^{3} \\varepsilon_{jsm} p_{c,m}\n$$\n$$\n\\frac{\\partial L_j}{\\partial p_{c,s}} = \\frac{\\partial}{\\partial p_{c,s}} \\left( \\sum_{a=1}^{N} \\sum_{l,m=1}^{3} \\varepsilon_{jlm} r_{a,l} p_{a,m} \\right) = \\sum_{a=1}^{N} \\sum_{l,m=1}^{3} \\varepsilon_{jlm} r_{a,l} \\delta_{ac} \\delta_{ms} = \\sum_{l=1}^{3} \\varepsilon_{jls} r_{c,l}\n$$\nNow, we substitute these into the definition of the Poisson bracket:\n$$\n\\{L_j, L_k\\} = \\sum_{c=1}^{N} \\sum_{s=1}^{3} \\left( \\frac{\\partial L_j}{\\partial r_{c,s}} \\frac{\\partial L_k}{\\partial p_{c,s}} - \\frac{\\partial L_j}{\\partial p_{c,s}} \\frac{\\partial L_k}{\\partial r_{c,s}} \\right)\n$$\n$$\n\\{L_j, L_k\\} = \\sum_{c=1}^{N} \\sum_{s=1}^{3} \\left[ \\left(\\sum_{m=1}^{3} \\varepsilon_{jsm} p_{c,m}\\right) \\left(\\sum_{l=1}^{3} \\varepsilon_{kls} r_{c,l}\\right) - \\left(\\sum_{l=1}^{3} \\varepsilon_{jls} r_{c,l}\\right) \\left(\\sum_{m=1}^{3} \\varepsilon_{ksm} p_{c,m}\\right) \\right]\n$$\nWe can rearrange the sums and group the terms:\n$$\n\\{L_j, L_k\\} = \\sum_{c=1}^{N} \\sum_{l,m=1}^{3} \\left[ \\sum_{s=1}^{3} \\left( \\varepsilon_{jsm} \\varepsilon_{kls} - \\varepsilon_{jls} \\varepsilon_{ksm} \\right) \\right] r_{c,l} p_{c,m}\n$$\nWe use the Levi-Civita tensor contraction identity, $\\sum_{s=1}^{3} \\varepsilon_{suv} \\varepsilon_{sxy} = \\delta_{ux}\\delta_{vy} - \\delta_{uy}\\delta_{vx}$.\nThe term in the square brackets becomes:\n$$\n\\sum_{s=1}^{3} \\left( \\varepsilon_{jsm} \\varepsilon_{kls} - \\varepsilon_{jls} \\varepsilon_{ksm} \\right) = (\\delta_{ml}\\delta_{jk} - \\delta_{mk}\\delta_{jl}) - (\\delta_{lm}\\delta_{jk} - \\delta_{lk}\\delta_{jm}) = \\delta_{lk}\\delta_{jm} - \\delta_{mk}\\delta_{jl}\n$$\nNow we substitute this back into the expression for $\\{L_j, L_k\\}$:\n$$\n\\{L_j, L_k\\} = \\sum_{c=1}^{N} \\sum_{l,m=1}^{3} (\\delta_{lk}\\delta_{jm} - \\delta_{mk}\\delta_{jl}) r_{c,l} p_{c,m}\n$$\nThe Kronecker deltas contract the sums:\n$$\n\\{L_j, L_k\\} = \\sum_{c=1}^{N} (r_{c,k} p_{c,j} - r_{c,j} p_{c,k})\n$$\nWe recognize that $\\sum_{c=1}^{N} (r_{c,j} p_{c,k} - r_{c,k} p_{c,j})$ is related to the components of angular momentum. Let's show this relationship explicitly. The $s$-th component of angular momentum is $L_s = \\sum_c \\sum_{u,v} \\varepsilon_{suv} r_{c,u} p_{c,v}$. We can write:\n$$\n\\sum_{s=1}^{3} \\varepsilon_{jks} L_s = \\sum_{s=1}^{3} \\varepsilon_{jks} \\sum_{c=1}^{N} \\sum_{u,v=1}^{3} \\varepsilon_{suv} r_{c,u} p_{c,v}\n$$\nRearranging and using the contraction identity $\\sum_s \\varepsilon_{jks} \\varepsilon_{suv} = \\sum_s \\varepsilon_{sjk} \\varepsilon_{suv} = \\delta_{ju}\\delta_{kv} - \\delta_{jv}\\delta_{ku}$:\n$$\n\\sum_{s=1}^{3} \\varepsilon_{jks} L_s = \\sum_{c=1}^{N} \\sum_{u,v=1}^{3} (\\delta_{ju}\\delta_{kv} - \\delta_{jv}\\delta_{ku}) r_{c,u} p_{c,v} = \\sum_{c=1}^{N} (r_{c,j} p_{c,k} - r_{c,k} p_{c,j})\n$$\nCombining this with our result for $\\{L_j, L_k\\}$:\n$$\n\\{L_j, L_k\\} = \\sum_{c=1}^{N} (r_{c,k} p_{c,j} - r_{c,j} p_{c,k}) = - \\sum_{c=1}^{N} (r_{c,j} p_{c,k} - r_{c,k} p_{c,j}) = - \\sum_{s=1}^{3} \\varepsilon_{jks} L_s\n$$\nThis is the fundamental angular momentum algebra relation. Note the cyclic permutation is $\\varepsilon_{jks} = -\\varepsilon_{kjs}$, so we can also write this as $\\{L_j, L_k\\} = \\sum_s \\varepsilon_{kjs} L_s$. This correctly yields $\\{L_j, L_k\\} = -\\{L_k, L_j\\}$.\n\nFinally, we substitute this result back into our expression for $\\{A,B\\}$:\n$$\n\\{ \\mathbf{L} \\cdot \\mathbf{a}, \\mathbf{L} \\cdot \\mathbf{b} \\} = \\sum_{j,k=1}^{3} a_j b_k \\{L_j, L_k\\} = \\sum_{j,k=1}^{3} a_j b_k \\left( - \\sum_{s=1}^{3} \\varepsilon_{jks} L_s \\right)\n$$\nWe can rearrange the summations:\n$$\n\\{ \\mathbf{L} \\cdot \\mathbf{a}, \\mathbf{L} \\cdot \\mathbf{b} \\} = - \\sum_{s=1}^{3} L_s \\left( \\sum_{j,k=1}^{3} \\varepsilon_{jks} a_j b_k \\right)\n$$\nRecognizing that $\\varepsilon_{jks} = \\varepsilon_{sjk}$:\n$$\n\\{ \\mathbf{L} \\cdot \\mathbf{a}, \\mathbf{L} \\cdot \\mathbf{b} \\} = - \\sum_{s=1}^{3} L_s \\left( \\sum_{j,k=1}^{3} \\varepsilon_{sjk} a_j b_k \\right)\n$$\nThe term in the parenthesis is the $s$-th component of the cross product $\\mathbf{a} \\times \\mathbf{b}$:\n$$\n(\\mathbf{a} \\times \\mathbf{b})_s = \\sum_{j,k=1}^{3} \\varepsilon_{sjk} a_j b_k\n$$\nTherefore, the expression becomes a dot product:\n$$\n\\{ \\mathbf{L} \\cdot \\mathbf{a}, \\mathbf{L} \\cdot \\mathbf{b} \\} = - \\sum_{s=1}^{3} L_s (\\mathbf{a} \\times \\mathbf{b})_s = -\\mathbf{L} \\cdot (\\mathbf{a} \\times \\mathbf{b})\n$$\nThis is the final compact analytical expression.",
            "answer": "$$\n\\boxed{-\\mathbf{L} \\cdot (\\mathbf{a} \\times \\mathbf{b})}\n$$"
        },
        {
            "introduction": "Having explored the algebra of angular momentum components, we now turn to its dynamics. This practice bridges the gap between abstract theory and computational experiment by tasking you with verifying the fundamental relationship $\\frac{d\\mathbf{L}}{dt} = \\{\\mathbf{L}, H\\} = \\boldsymbol{\\tau}_{\\text{total}}$, where $\\boldsymbol{\\tau}_{\\text{total}}$ is the total torque on the system. Through a combination of analytical reasoning and numerical implementation, you will investigate how physical symmetries in a system lead to conservation laws, and conversely, how introducing anisotropic potentials breaks these symmetries and leads to non-conservation.",
            "id": "3435765",
            "problem": "Consider a system of $N$ classical point particles with positions $\\mathbf{r}_i \\in \\mathbb{R}^3$ and momenta $\\mathbf{p}_i \\in \\mathbb{R}^3$, for $i = 1, \\dots, N$. The Hamiltonian is\n$$\nH(\\{\\mathbf{r}_i\\}, \\{\\mathbf{p}_i\\}) = \\sum_{i=1}^N \\frac{\\mathbf{p}_i^2}{2 m_i} + \\sum_{1 \\le ij \\le N} V\\!\\left(\\left\\|\\mathbf{r}_i - \\mathbf{r}_j\\right\\|\\right) + \\sum_{i=1}^N U_{\\text{ext}}(\\mathbf{r}_i),\n$$\nwhere $m_i$ are masses, $V(r)$ is a central pair potential depending only on the scalar separation $r = \\|\\mathbf{r}_i - \\mathbf{r}_j\\|$, and $U_{\\text{ext}}$ is an external single-particle potential. Define the total angular momentum\n$$\n\\mathbf{L} = \\sum_{i=1}^N \\mathbf{r}_i \\times \\mathbf{p}_i.\n$$\nThe Poisson bracket of two scalar functions $A(\\{\\mathbf{r}_i\\}, \\{\\mathbf{p}_i\\})$ and $B(\\{\\mathbf{r}_i\\}, \\{\\mathbf{p}_i\\})$ is\n$$\n\\{A, B\\} = \\sum_{i=1}^N \\left( \\frac{\\partial A}{\\partial \\mathbf{r}_i} \\cdot \\frac{\\partial B}{\\partial \\mathbf{p}_i} - \\frac{\\partial A}{\\partial \\mathbf{p}_i} \\cdot \\frac{\\partial B}{\\partial \\mathbf{r}_i} \\right),\n$$\nwhere $\\partial/\\partial \\mathbf{r}_i$ and $\\partial/\\partial \\mathbf{p}_i$ denote gradients with respect to $\\mathbf{r}_i$ and $\\mathbf{p}_i$. The goal is to reason from first principles to determine when components of $\\mathbf{L}$ are constants of motion, quantify the failure of conservation under anisotropic perturbations, and implement a program that computes the vector Poisson bracket $\\{\\mathbf{L}, H\\}$ for specified configurations.\n\nStart from the fundamental laws and core definitions of Hamiltonian mechanics: the Hamiltonian flow, the definition of Poisson brackets, and the definition of angular momentum. Do not assume any shortcut identities not derivable from these bases. Use well-tested formulas such as the Lennard–Jones pair potential\n$$\nV_{\\text{LJ}}(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\nand its derivative with respect to $r$. Consider external potentials that model anisotropic walls and uniform field gradients:\n- Anisotropic quadratic confinement,\n$$\nU_{\\text{quad}}(\\mathbf{r}) = \\frac{1}{2}\\left(k_x x^2 + k_y y^2 + k_z z^2\\right),\n$$\n- Uniform field gradient,\n$$\nU_{\\text{lin}}(\\mathbf{r}) = -\\mathbf{g}\\cdot\\mathbf{r}.\n$$\n\nYou must:\n- Derive, in purely mathematical terms, how $\\{\\mathbf{L}, H\\}$ reduces to a torque-like sum involving gradients of the potential.\n- Explain, using symmetry arguments grounded in the definitions, why central pair potentials imply $\\{\\mathbf{L}, H\\}=\\mathbf{0}$, and identify perturbations where specific components (e.g., $L_z$) remain conserved or fail to be conserved.\n- Implement a program that computes $\\{\\mathbf{L}, H\\}$ numerically for given particle configurations by evaluating the gradients entering the Poisson bracket. The computation must be done in reduced Lennard–Jones units, with distances measured in units of $\\sigma$, energy in units of $\\epsilon$, masses $m_i$ in units where $m_i = 1$, momenta in units of $\\sqrt{m\\epsilon}$, and time in units of $\\sigma\\sqrt{m/\\epsilon}$. All outputs must be expressed in these dimensionless units.\n\nTest Suite:\nProvide a program that evaluates the following five test cases. In each case, compute the vector Poisson bracket $\\{\\mathbf{L}, H\\}$ and report conservation booleans as specified below. Use $\\epsilon = 1$ and $\\sigma = 1$.\n\n- Test case $1$ (central pair potential, no external field): Two particles with pairwise $V_{\\text{LJ}}$ only.\n  - Parameters: $N=2$, $m_1=m_2=1$,\n    $\\mathbf{r}_1 = (0.45,-0.30,0.50)$, $\\mathbf{r}_2 = (-0.15,0.80,0.10)$,\n    $\\mathbf{p}_1 = (0.20,0.15,-0.10)$, $\\mathbf{p}_2 = (-0.25,0.05,0.30)$,\n    $U_{\\text{ext}} \\equiv 0$.\n  - Expected: full rotational symmetry implies all components conserved. Report booleans for $(L_x,L_y,L_z)$.\n\n- Test case $2$ (axis-symmetric anisotropic walls): One particle with $U_{\\text{quad}}$ having $k_x=k_y\\ne k_z$ (cylindrical symmetry about the $z$-axis).\n  - Parameters: $N=1$, $m_1=1$,\n    $\\mathbf{r}_1 = (0.60,-0.40,0.30)$, $\\mathbf{p}_1 = (0.10,0.20,-0.15)$,\n    $(k_x,k_y,k_z) = (30.0,30.0,50.0)$,\n    no pair potential.\n  - Expected: $L_z$ conserved, $L_x$ and $L_y$ not conserved. Report booleans for $(L_x,L_y,L_z)$.\n\n- Test case $3$ (fully anisotropic walls): One particle with $U_{\\text{quad}}$ having $k_x \\ne k_y \\ne k_z$ (no rotational symmetry).\n  - Parameters: $N=1$, $m_1=1$,\n    $\\mathbf{r}_1 = (0.60,0.50,-0.25)$, $\\mathbf{p}_1 = (-0.30,0.40,0.10)$,\n    $(k_x,k_y,k_z) = (20.0,30.0,40.0)$,\n    no pair potential.\n  - Expected: no component conserved. Report booleans for $(L_x,L_y,L_z)$.\n\n- Test case $4$ (central pair plus uniform field along $z$): Two particles with pairwise $V_{\\text{LJ}}$ and $U_{\\text{lin}}$ with $\\mathbf{g} = (0,0,2.0)$.\n  - Parameters: $N=2$, $m_1=m_2=1$,\n    $\\mathbf{r}_1 = (0.25,-0.35,0.45)$, $\\mathbf{r}_2 = (-0.40,0.15,0.20)$,\n    $\\mathbf{p}_1 = (0.35,-0.10,0.25)$, $\\mathbf{p}_2 = (-0.15,0.30,-0.20)$,\n    $\\mathbf{g}=(0,0,2.0)$.\n  - Expected: cylindrical symmetry about $z$ implies $L_z$ conserved. Report booleans for $(L_x,L_y,L_z)$.\n\n- Test case $5$ (central pair plus uniform field along a general direction): Two particles with pairwise $V_{\\text{LJ}}$ and $U_{\\text{lin}}$ with $\\mathbf{g} = (1.0,2.0,3.0)$.\n  - Parameters: $N=2$, $m_1=m_2=1$,\n    $\\mathbf{r}_1 = (0.10,0.20,0.30)$, $\\mathbf{r}_2 = (-0.25,0.05,0.15)$,\n    $\\mathbf{p}_1 = (0.05,-0.10,0.20)$, $\\mathbf{p}_2 = (-0.30,0.25,-0.05)$,\n    $\\mathbf{g}=(1.0,2.0,3.0)$.\n  - Expected: rotational symmetry about the $\\mathbf{g}$-axis implies conservation of the component $L_{\\parallel} = \\mathbf{L}\\cdot \\hat{\\mathbf{g}}$ (equivalently, $\\{ \\mathbf{L}\\cdot \\mathbf{g}, H\\}=0$). Report a single boolean for this conserved quantity.\n\nNumerical evaluation details:\n- Compute $\\{\\mathbf{L}, H\\}$ using the definition of the Poisson bracket and gradients of $H$ with respect to positions and momenta; do not assume any hidden identities beyond those derivable from the core definitions.\n- For the Lennard–Jones potential with $\\epsilon=1$ and $\\sigma=1$, use its radial derivative $\\mathrm{d}V_{\\text{LJ}}/\\mathrm{d}r$ to assemble $\\nabla_{\\mathbf{r}_i} H$.\n- Use an absolute tolerance $\\tau = 10^{-12}$ in reduced units to decide conservation booleans: a component is considered conserved if the absolute value of the corresponding component of $\\{\\mathbf{L}, H\\}$ is less than or equal to $\\tau$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case. For test cases $1$–$4$, each element must be a list of length $6$ in the order $[\\{\\mathbf{L},H\\}_x, \\{\\mathbf{L},H\\}_y, \\{\\mathbf{L},H\\}_z, \\text{cons}_x, \\text{cons}_y, \\text{cons}_z]$. For test case $5$, the element must be a list of length $4$ in the order $[\\{\\mathbf{L},H\\}_x, \\{\\mathbf{L},H\\}_y, \\{\\mathbf{L},H\\}_z, \\text{cons}_{\\mathbf{g}}]$. All floats must be expressed in reduced Lennard–Jones units as specified above, and booleans must be either $\\text{True}$ or $\\text{False}$.",
            "solution": "The problem is to analyze the conservation of the total angular momentum, $\\mathbf{L}$, of a system of $N$ particles described by a given Hamiltonian, $H$. A quantity is a constant of motion if its Poisson bracket with the Hamiltonian is zero. We must first formally derive the expression for the vector Poisson bracket $\\{\\mathbf{L}, H\\}$, then use this result to discuss conservation under various potentials, and finally implement a numerical calculation for specific test cases.\n\n### Step 1: Derivation of $\\{\\mathbf{L}, H\\}$\n\nThe Hamiltonian for the system is given by:\n$$\nH(\\{\\mathbf{r}_i\\}, \\{\\mathbf{p}_i\\}) = \\sum_{i=1}^N \\frac{\\mathbf{p}_i^2}{2 m_i} + \\sum_{1 \\le ij \\le N} V\\!\\left(\\left\\|\\mathbf{r}_i - \\mathbf{r}_j\\right\\|\\right) + \\sum_{i=1}^N U_{\\text{ext}}(\\mathbf{r}_i) = T + V_{\\text{pair}} + U_{\\text{pot}}\n$$\nThe total angular momentum is:\n$$\n\\mathbf{L} = \\sum_{i=1}^N \\mathbf{r}_i \\times \\mathbf{p}_i\n$$\nThe Poisson bracket of two functions $A$ and $B$ is:\n$$\n\\{A, B\\} = \\sum_{k=1}^N \\left( \\frac{\\partial A}{\\partial \\mathbf{r}_k} \\cdot \\frac{\\partial B}{\\partial \\mathbf{p}_k} - \\frac{\\partial A}{\\partial \\mathbf{p}_k} \\cdot \\frac{\\partial B}{\\partial \\mathbf{r}_k} \\right)\n$$\nWe wish to compute the vector Poisson bracket $\\{\\mathbf{L}, H\\}$, which is a vector whose components are the scalar Poisson brackets $\\{L_x, H\\}$, $\\{L_y, H\\}$, and $\\{L_z, H\\}$. Let us compute the bracket for an arbitrary component $L_a$, where $a \\in \\{x, y, z\\}$.\n\nFirst, we compute the necessary gradients of $L_a$ and $H$. The partial derivatives are taken with respect to the coordinates of a single particle, say particle $k$.\n\nGradients of $L_a$:\nThe $a$-th component of $\\mathbf{L}$ is $L_a = \\sum_{i=1}^N (\\mathbf{r}_i \\times \\mathbf{p}_i)_a$. The derivatives with respect to particle $k$'s coordinates only act on the $i=k$ term.\nFor the position gradient $\\frac{\\partial L_a}{\\partial \\mathbf{r}_k}$:\n$$\n\\frac{\\partial L_a}{\\partial \\mathbf{r}_k} = \\frac{\\partial}{\\partial \\mathbf{r}_k} (\\mathbf{r}_k \\times \\mathbf{p}_k)_a\n$$\nLet's take $a=x$ as an example: $L_x = \\sum_i (y_i p_{z_i} - z_i p_{y_i})$.\n$$\n\\frac{\\partial L_x}{\\partial \\mathbf{r}_k} = \\frac{\\partial}{\\partial \\mathbf{r}_k} (y_k p_{z_k} - z_k p_{y_k}) = p_{z_k} \\hat{\\mathbf{y}}_k - p_{y_k} \\hat{\\mathbf{z}}_k = (0, p_{z_k}, -p_{y_k})\n$$\nFor the momentum gradient $\\frac{\\partial L_a}{\\partial \\mathbf{p}_k}$:\n$$\n\\frac{\\partial L_x}{\\partial \\mathbf{p}_k} = \\frac{\\partial}{\\partial \\mathbf{p}_k} (y_k p_{z_k} - z_k p_{y_k}) = y_k \\hat{\\mathbf{p}}_{z_k} - z_k \\hat{\\mathbf{p}}_{y_k} = (0, -z_k, y_k) = \\hat{\\mathbf{x}} \\times \\mathbf{r}_k\n$$\nIn general, for any component $a$, we find: $\\frac{\\partial L_a}{\\partial \\mathbf{p}_k} = \\hat{\\mathbf{e}}_a \\times \\mathbf{r}_k$.\n\nGradients of $H$:\n$$\n\\frac{\\partial H}{\\partial \\mathbf{p}_k} = \\frac{\\partial}{\\partial \\mathbf{p}_k} \\left(\\frac{\\mathbf{p}_k^2}{2m_k}\\right) = \\frac{\\mathbf{p}_k}{m_k} = \\mathbf{v}_k\n$$\n$$\n\\frac{\\partial H}{\\partial \\mathbf{r}_k} = \\frac{\\partial V_{\\text{pair}}}{\\partial \\mathbf{r}_k} + \\frac{\\partial U_{\\text{pot}}}{\\partial \\mathbf{r}_k} = -\\mathbf{F}_k^{\\text{int}} - \\mathbf{F}_k^{\\text{ext}} = -\\mathbf{F}_k\n$$\nwhere $\\mathbf{F}_k$ is the total force on particle $k$.\n\nNow, we assemble the Poisson bracket for $L_a$:\n$$\n\\{L_a, H\\} = \\sum_{k=1}^N \\left( \\frac{\\partial L_a}{\\partial \\mathbf{r}_k} \\cdot \\frac{\\mathbf{p}_k}{m_k} - \\left(\\frac{\\partial L_a}{\\partial \\mathbf{p}_k}\\right) \\cdot \\frac{\\partial H}{\\partial \\mathbf{r}_k} \\right)\n$$\nThe first term is:\n$$\n\\sum_{k=1}^N \\frac{\\partial L_a}{\\partial \\mathbf{r}_k} \\cdot \\frac{\\mathbf{p}_k}{m_k} = \\sum_{k=1}^N \\frac{1}{m_k} (p_{z_k} \\hat{\\mathbf{y}}_k - p_{y_k} \\hat{\\mathbf{z}}_k) \\cdot (p_{x_k}, p_{y_k}, p_{z_k}) \\quad (\\text{for } a=x)\n$$\n$$\n= \\sum_{k=1}^N \\frac{1}{m_k} (p_{z_k} p_{y_k} - p_{y_k} p_{z_k}) = 0\n$$\nThis term is zero for all components of $\\mathbf{L}$. Thus, the Poisson bracket simplifies to the second term:\n$$\n\\{L_a, H\\} = - \\sum_{k=1}^N \\left(\\frac{\\partial L_a}{\\partial \\mathbf{p}_k}\\right) \\cdot \\frac{\\partial H}{\\partial \\mathbf{r}_k} = - \\sum_{k=1}^N (\\hat{\\mathbf{e}}_a \\times \\mathbf{r}_k) \\cdot (-\\mathbf{F}_k) = \\sum_{k=1}^N (\\hat{\\mathbf{e}}_a \\times \\mathbf{r}_k) \\cdot \\mathbf{F}_k\n$$\nUsing the scalar triple product identity $\\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{C}) = (\\mathbf{A} \\times \\mathbf{B}) \\cdot \\mathbf{C}$, we can write $(\\hat{\\mathbf{e}}_a \\times \\mathbf{r}_k) \\cdot \\mathbf{F}_k = \\hat{\\mathbf{e}}_a \\cdot (\\mathbf{r}_k \\times \\mathbf{F}_k)$.\nLet $\\boldsymbol{\\tau}_k = \\mathbf{r}_k \\times \\mathbf{F}_k$ be the torque on particle $k$. Then:\n$$\n\\{L_a, H\\} = \\sum_{k=1}^N \\hat{\\mathbf{e}}_a \\cdot \\boldsymbol{\\tau}_k = \\hat{\\mathbf{e}}_a \\cdot \\left(\\sum_{k=1}^N \\boldsymbol{\\tau}_k\\right) = (\\boldsymbol{\\tau}_{\\text{total}})_a\n$$\nThis is true for any component $a$. Therefore, we arrive at the vector relation:\n$$\n\\{\\mathbf{L}, H\\} = \\sum_{k=1}^N \\mathbf{r}_k \\times \\mathbf{F}_k = \\boldsymbol{\\tau}_{\\text{total}}\n$$\nThis is a fundamental result from Hamiltonian mechanics, stating that the time evolution of the angular momentum is given by the total torque on the system. Since $\\frac{d\\mathbf{L}}{dt} = \\{\\mathbf{L}, H\\}$, this is the analogue of Newton's second law for rotation. Angular momentum is conserved if and only if the total torque is zero.\n\n### Step 2: Symmetry Arguments and Conservation\n\nThe total torque $\\boldsymbol{\\tau}_{\\text{total}}$ can be split into contributions from internal pair forces and external forces:\n$$\n\\boldsymbol{\\tau}_{\\text{total}} = \\boldsymbol{\\tau}_{\\text{int}} + \\boldsymbol{\\tau}_{\\text{ext}} = \\sum_{k=1}^N \\mathbf{r}_k \\times \\mathbf{F}_k^{\\text{int}} + \\sum_{k=1}^N \\mathbf{r}_k \\times \\mathbf{F}_k^{\\text{ext}}\n$$\n\n**Contribution from Central Pair Potentials:**\nThe internal force on particle $i$ is $\\mathbf{F}_i^{\\text{int}} = \\sum_{j \\ne i} \\mathbf{F}_{ij}$, where $\\mathbf{F}_{ij}$ is the force on $i$ due to $j$. For a central potential $V(r_{ij})$, the force is $\\mathbf{F}_{ij} = -V'(r_{ij}) \\frac{\\mathbf{r}_{ij}}{r_{ij}}$, where $\\mathbf{r}_{ij} = \\mathbf{r}_i - \\mathbf{r}_j$. The internal torque is:\n$$\n\\boldsymbol{\\tau}_{\\text{int}} = \\sum_{i} \\mathbf{r}_i \\times \\left(\\sum_{j \\ne i} \\mathbf{F}_{ij}\\right) = \\sum_{ij} (\\mathbf{r}_i \\times \\mathbf{F}_{ij} + \\mathbf{r}_j \\times \\mathbf{F}_{ji})\n$$\nBy Newton's third law, $\\mathbf{F}_{ji} = -\\mathbf{F}_{ij}$.\n$$\n\\boldsymbol{\\tau}_{\\text{int}} = \\sum_{ij} (\\mathbf{r}_i \\times \\mathbf{F}_{ij} - \\mathbf{r}_j \\times \\mathbf{F}_{ij}) = \\sum_{ij} (\\mathbf{r}_i - \\mathbf{r}_j) \\times \\mathbf{F}_{ij}\n$$\nSince $\\mathbf{F}_{ij}$ is parallel to the separation vector $\\mathbf{r}_i - \\mathbf{r}_j$, their cross product is identically zero. Thus, $\\boldsymbol{\\tau}_{\\text{int}} = \\mathbf{0}$.\nThis confirms that any system with only central pair potentials conserves total angular momentum, as the internal forces produce no net torque. This is why for Test Case 1, with only a Lennard-Jones potential, $\\{\\mathbf{L}, H\\} = \\mathbf{0}$ and all components of $\\mathbf{L}$ are conserved. The system possesses full rotational symmetry.\n\n**Contribution from External Potentials:**\nConservation of $\\mathbf{L}$ or its components depends entirely on the external potential $U_{\\text{ext}}$.\n$$\n\\{\\mathbf{L}, H\\} = \\boldsymbol{\\tau}_{\\text{ext}} = \\sum_i \\mathbf{r}_i \\times \\mathbf{F}_i^{\\text{ext}} = -\\sum_i \\mathbf{r}_i \\times \\nabla_{\\mathbf{r}_i} U_{\\text{ext}}(\\mathbf{r}_i)\n$$\n- **Anisotropic quadratic confinement ($U_{\\text{quad}}$):** For a single particle, $\\mathbf{F}^{\\text{ext}} = -(k_x x, k_y y, k_z z)$. The torque is:\n$$\n\\boldsymbol{\\tau}_{\\text{ext}} = -\\mathbf{r} \\times (k_x x, k_y y, k_z z) = (y z(k_y - k_z), z x(k_z - k_x), x y(k_x - k_y))\n$$\n  - In Test Case 2, $k_x = k_y \\ne k_z$. The potential $U_{\\text{quad}} = \\frac{1}{2} k_x(x^2+y^2) + \\frac{1}{2} k_z z^2$ is symmetric under rotations about the $z$-axis. The torque's $z$-component is $\\tau_z = xy(k_x - k_y) = 0$. Hence, $\\{L_z, H\\} = 0$ and $L_z$ is conserved, while $L_x$ and $L_y$ are not.\n  - In Test Case 3, $k_x \\ne k_y \\ne k_z$. The potential has no continuous rotational symmetry. In general, all components of the torque are non-zero, so no component of $\\mathbf{L}$ is conserved.\n\n- **Uniform field gradient ($U_{\\text{lin}}$):** $U_{\\text{lin}}(\\mathbf{r}) = -\\mathbf{g}\\cdot\\mathbf{r}$. The external force on each particle $i$ is $\\mathbf{F}_i^{\\text{ext}} = -\\nabla_{\\mathbf{r}_i} (-\\mathbf{g}\\cdot\\mathbf{r}_i) = \\mathbf{g}$. The total external torque is:\n$$\n\\boldsymbol{\\tau}_{\\text{ext}} = \\sum_i \\mathbf{r}_i \\times \\mathbf{g} = \\left(\\sum_i \\mathbf{r}_i\\right) \\times \\mathbf{g}\n$$\n  - In Test Case 4, $\\mathbf{g}$ is along the $z$-axis, $\\mathbf{g} = (0, 0, g_z)$. The potential is symmetric under rotations about the $z$-axis. The torque is $\\boldsymbol{\\tau}_{\\text{ext}} = (\\sum_i \\mathbf{r}_i) \\times (0, 0, g_z)$, whose $z$-component is zero. Thus, $\\{L_z, H\\} = 0$ and $L_z$ is conserved.\n  - In Test Case 5, $\\mathbf{g}$ is a general vector. The potential $U_{\\text{pot}} = -\\mathbf{g} \\cdot (\\sum_i \\mathbf{r}_i)$ is symmetric under rotations about the axis defined by $\\mathbf{g}$. The conserved quantity is the component of angular momentum along this axis, $L_\\parallel = \\mathbf{L} \\cdot \\hat{\\mathbf{g}}$. To verify this, we compute its Poisson bracket with $H$:\n  $$\n  \\{L_\\parallel, H\\} = \\{\\mathbf{L} \\cdot \\hat{\\mathbf{g}}, H\\} = \\hat{\\mathbf{g}} \\cdot \\{\\mathbf{L}, H\\} = \\hat{\\mathbf{g}} \\cdot \\boldsymbol{\\tau}_{\\text{ext}}\n  $$\n  $$\n  = \\hat{\\mathbf{g}} \\cdot \\left(\\left(\\sum_i \\mathbf{r}_i\\right) \\times \\mathbf{g}\\right) = \\frac{1}{\\|\\mathbf{g}\\|} \\mathbf{g} \\cdot \\left(\\left(\\sum_i \\mathbf{r}_i\\right) \\times \\mathbf{g}\\right)\n  $$\n  The scalar triple product $\\mathbf{a} \\cdot (\\mathbf{b} \\times \\mathbf{a})$ is always zero because $\\mathbf{b} \\times \\mathbf{a}$ is a vector orthogonal to $\\mathbf{a}$. Thus, $\\{L_\\parallel, H\\} = 0$, and the component of $\\mathbf{L}$ along $\\mathbf{g}$ is always conserved.\n\n### Step 3: Numerical Implementation\n\nThe program will implement the derived formula $\\{\\mathbf{L}, H\\} = \\boldsymbol{\\tau}_{\\text{total}}$. For each particle, it will compute the total force $\\mathbf{F}_k$ (sum of internal and external forces) and then the torque $\\boldsymbol{\\tau}_k = \\mathbf{r}_k \\times \\mathbf{F}_k$. The sum of these torques gives the final vector. This is mathematically equivalent to the definition of the Poisson bracket but is computationally more direct.\n\n- For the Lennard-Jones potential $V_{\\text{LJ}}(r) = 4\\epsilon\\left[(\\sigma/r)^{12} - (\\sigma/r)^6\\right]$, with $\\epsilon=1, \\sigma=1$, the radial derivative is $V'_{\\text{LJ}}(r) = 4(-12r^{-13} + 6r^{-7}) = 24(r^{-7} - 2r^{-13})$. The force is $\\mathbf{F}_{ij} = -V'_{\\text{LJ}}(r_{ij}) \\frac{\\mathbf{r}_{ij}}{r_{ij}}$.\n- For the external potentials, forces are computed as $\\mathbf{F}^{\\text{ext}} = -\\nabla U_{\\text{ext}}$.\n- Conservation is checked by comparing the absolute value of the computed Poisson bracket component against the tolerance $\\tau = 10^{-12}$.\n\nThe following program calculates $\\{\\mathbf{L}, H\\}$ and the corresponding conservation booleans for the five test cases specified.",
            "answer": "```python\nimport numpy as np\n\ndef v_lj_derivative(r):\n    \"\"\"\n    Computes the derivative of the Lennard-Jones potential dV/dr in reduced units.\n    V(r) = 4 * (r^-12 - r^-6)\n    dV/dr = 4 * (-12*r^-13 - (-6)*r^-7) = 24 * (r^-7 - 2*r^-13)\n    \"\"\"\n    if r == 0:\n        return np.inf\n    r_inv = 1.0 / r\n    r7_inv = r_inv**7\n    r13_inv = r_inv**13\n    return 24.0 * (r7_inv - 2.0 * r13_inv)\n\ndef compute_poisson_bracket(N, masses, positions, pair_potential, ext_potential_params):\n    \"\"\"\n    Computes the vector Poisson bracket {L, H} which equals the total torque.\n    \n    Args:\n        N (int): Number of particles.\n        masses (list): List of particle masses.\n        positions (np.ndarray): (N, 3) array of particle positions.\n        pair_potential (str or None): Type of pair potential ('LJ' or None).\n        ext_potential_params (dict): Parameters for the external potential.\n\n    Returns:\n        np.ndarray: The 3D vector {L, H}.\n    \"\"\"\n    total_torque = np.zeros(3, dtype=float)\n    \n    for i in range(N):\n        force_i = np.zeros(3, dtype=float)\n        \n        # Internal forces (from pair potential)\n        if pair_potential == 'LJ':\n            for j in range(N):\n                if i == j:\n                    continue\n                r_ij_vec = positions[i] - positions[j]\n                r_ij_mag = np.linalg.norm(r_ij_vec)\n                \n                if r_ij_mag > 0:\n                    dv_dr = v_lj_derivative(r_ij_mag)\n                    force_ij = -dv_dr * (r_ij_vec / r_ij_mag)\n                    force_i += force_ij\n\n        # External forces\n        if 'type' in ext_potential_params:\n            if ext_potential_params['type'] == 'quad':\n                k_vec = ext_potential_params['k']\n                force_ext = -k_vec * positions[i]\n                force_i += force_ext\n            \n            elif ext_potential_params['type'] == 'lin':\n                g_vec = ext_potential_params['g']\n                force_ext = g_vec\n                force_i += force_ext\n\n        torque_i = np.cross(positions[i], force_i)\n        total_torque += torque_i\n        \n    return total_torque\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1: Two-particle Lennard-Jones system\n        {\n            \"N\": 2, \"masses\": [1.0, 1.0],\n            \"positions\": np.array([[0.45, -0.30, 0.50], [-0.15, 0.80, 0.10]]),\n            \"pair_potential\": \"LJ\",\n            \"ext_potential_params\": {},\n            \"case_type\": \"components\"\n        },\n        # Case 2: Axis-symmetric quadratic potential\n        {\n            \"N\": 1, \"masses\": [1.0],\n            \"positions\": np.array([[0.60, -0.40, 0.30]]),\n            \"pair_potential\": None,\n            \"ext_potential_params\": {\"type\": \"quad\", \"k\": np.array([30.0, 30.0, 50.0])},\n            \"case_type\": \"components\"\n        },\n        # Case 3: Fully anisotropic quadratic potential\n        {\n            \"N\": 1, \"masses\": [1.0],\n            \"positions\": np.array([[0.60, 0.50, -0.25]]),\n            \"pair_potential\": None,\n            \"ext_potential_params\": {\"type\": \"quad\", \"k\": np.array([20.0, 30.0, 40.0])},\n            \"case_type\": \"components\"\n        },\n        # Case 4: Two-particle LJ with a linear field along z\n        {\n            \"N\": 2, \"masses\": [1.0, 1.0],\n            \"positions\": np.array([[0.25, -0.35, 0.45], [-0.40, 0.15, 0.20]]),\n            \"pair_potential\": \"LJ\",\n            \"ext_potential_params\": {\"type\": \"lin\", \"g\": np.array([0.0, 0.0, 2.0])},\n            \"case_type\": \"components\"\n        },\n        # Case 5: Two-particle LJ with a general linear field\n        {\n            \"N\": 2, \"masses\": [1.0, 1.0],\n            \"positions\": np.array([[0.10, 0.20, 0.30], [-0.25, 0.05, 0.15]]),\n            \"pair_potential\": \"LJ\",\n            \"ext_potential_params\": {\"type\": \"lin\", \"g\": np.array([1.0, 2.0, 3.0])},\n            \"case_type\": \"projection\"\n        }\n    ]\n\n    TOLERANCE = 1e-12\n    results = []\n\n    for case in test_cases:\n        poisson_bracket_L_H = compute_poisson_bracket(\n            case[\"N\"],\n            case[\"masses\"],\n            case[\"positions\"],\n            case[\"pair_potential\"],\n            case[\"ext_potential_params\"]\n        )\n        \n        pb_x, pb_y, pb_z = poisson_bracket_L_H\n\n        if case[\"case_type\"] == \"components\":\n            cons_x = abs(pb_x) = TOLERANCE\n            cons_y = abs(pb_y) = TOLERANCE\n            cons_z = abs(pb_z) = TOLERANCE\n            case_result = [pb_x, pb_y, pb_z, cons_x, cons_y, cons_z]\n            results.append(f\"[{','.join(map(str, case_result))}]\")\n\n        elif case[\"case_type\"] == \"projection\":\n            g_vec = case[\"ext_potential_params\"]['g']\n            # {L.g, H} = g . {L, H}\n            pb_L_dot_g_H = np.dot(g_vec, poisson_bracket_L_H)\n            cons_g = abs(pb_L_dot_g_H) = TOLERANCE\n            case_result = [pb_x, pb_y, pb_z, cons_g]\n            results.append(f\"[{','.join(map(str, case_result))}]\")\n    \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Real-world molecular dynamics simulations often employ periodic boundary conditions (PBC) to approximate an infinite system. This final practice challenges you to apply the concept of Poisson brackets to this crucial, non-trivial context. You will rigorously determine whether total linear momentum remains a constant of motion when interactions are calculated using the minimum-image convention (MIC), a process that requires careful handling of the potential's derivatives at the cell boundaries. This exercise demonstrates the formal proof of translational invariance in periodic systems, a vital property for correct simulation methodologies.",
            "id": "3435764",
            "problem": "Consider a $d$-dimensional molecular system of $N$ particles in a cubic box of side length $L$ with periodic boundary conditions (PBC). Each particle has canonical position $\\mathbf{r}_{i} \\in \\mathbb{R}^{d}$ and canonical momentum $\\mathbf{p}_{i} \\in \\mathbb{R}^{d}$, and the Hamiltonian is\n$$\nH(\\{\\mathbf{r}_{i}\\}, \\{\\mathbf{p}_{i}\\}) \\;=\\; \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_{i}|^{2}}{2 m_{i}} \\;+\\; \\frac{1}{2} \\sum_{\\substack{i,j=1 \\\\ i \\neq j}}^{N} \\varphi\\!\\left(\\mathbf{s}_{ij}\\right),\n$$\nwhere $\\varphi$ is a differentiable pair potential and $\\mathbf{s}_{ij}$ is the minimum-image separation vector defined by the minimum-image convention (MIC):\n$$\n\\mathbf{s}_{ij} \\;=\\; \\mathbf{r}_{i} - \\mathbf{r}_{j} - L\\,\\mathbf{n}_{ij}(\\mathbf{r}_{i} - \\mathbf{r}_{j}),\n$$\nwith $\\mathbf{n}_{ij}(\\cdot)$ a lattice index valued in $\\mathbb{Z}^{d}$ chosen so that each component of $\\mathbf{s}_{ij}$ lies in the interval $\\left(-\\frac{L}{2}, \\frac{L}{2}\\right]$. Assume $\\varphi(\\mathbf{s})$ depends only on the separation (for example, $\\varphi(\\mathbf{s}) = \\phi(|\\mathbf{s}|)$ for some scalar function $\\phi$) and is sufficiently smooth wherever it is nonzero; optionally, you may assume a finite interaction range $r_{c}  \\frac{L}{2}$ so that $\\varphi(\\mathbf{s}) = 0$ whenever $|\\mathbf{s}| \\ge r_{c}$.\n\nLet the total momentum be $\\mathbf{P} = \\sum_{i=1}^{N} \\mathbf{p}_{i}$. Using only fundamental principles from Hamiltonian mechanics and the definition of the Poisson bracket, determine whether the Poisson bracket $\\{\\mathbf{P}, H\\}$ vanishes for this system when the pair potential is computed under MIC. Your derivation must start from the canonical Poisson bracket definition and the given Hamiltonian structure, and it must carefully address any subtleties introduced by position wrapping and the piecewise constant lattice index $\\mathbf{n}_{ij}(\\cdot)$.\n\nProvide the final value of $\\{\\mathbf{P}, H\\}$ as a single closed-form symbolic expression. No numerical evaluation is required. If any conditional assumptions are needed to ensure differentiability or well-posedness, state them clearly in your reasoning, but the final answer must remain a single expression.",
            "solution": "The problem asks for the evaluation of the Poisson bracket of the total momentum $\\mathbf{P}$ and the Hamiltonian $H$ for a system of $N$ particles in $d$ dimensions with periodic boundary conditions (PBC) and a pair potential evaluated under the minimum-image convention (MIC).\n\nThe total momentum is given by $\\mathbf{P} = \\sum_{j=1}^{N} \\mathbf{p}_{j}$. The Hamiltonian is $H = K + U$, where the kinetic energy is $K = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_{i}|^{2}}{2 m_{i}}$ and the potential energy is $U = \\frac{1}{2} \\sum_{\\substack{i,j=1 \\\\ i \\neq j}}^{N} \\varphi(\\mathbf{s}_{ij})$.\n\nThe Poisson bracket of two phase space functions $A(\\{\\mathbf{r}_i, \\mathbf{p}_i\\})$ and $B(\\{\\mathbf{r}_i, \\mathbf{p}_i\\})$ is defined in vector notation as:\n$$\n\\{A, B\\} = \\sum_{k=1}^{N} \\left( \\frac{\\partial A}{\\partial \\mathbf{r}_k} \\cdot \\frac{\\partial B}{\\partial \\mathbf{p}_k} - \\frac{\\partial A}{\\partial \\mathbf{p}_k} \\cdot \\frac{\\partial B}{\\partial \\mathbf{r}_k} \\right)\n$$\nWe need to compute $\\{\\mathbf{P}, H\\}$. Since $\\mathbf{P}$ is a vector and $H$ is a scalar, the result will be a vector. Let's compute the $\\beta$-th component of this vector, $\\{(\\mathbf{P})_\\beta, H\\}$, where $(\\mathbf{P})_\\beta = \\sum_{j=1}^{N} (\\mathbf{p}_j)_\\beta$.\n\nThe general formula for a component is:\n$$\n\\{A_\\beta, B\\} = \\sum_{k=1}^{N} \\left( \\nabla_{\\mathbf{r}_k} A_\\beta \\cdot \\nabla_{\\mathbf{p}_k} B - \\nabla_{\\mathbf{p}_k} A_\\beta \\cdot \\nabla_{\\mathbf{r}_k} B \\right)\n$$\nHere, $A_\\beta = (\\mathbf{P})_\\beta$ and $B = H$. We require the partial derivatives of $(\\mathbf{P})_\\beta$ and $H$.\n\nFirst, let's find the derivatives of $(\\mathbf{P})_\\beta$:\nThe total momentum $\\mathbf{P}$ is a function of momenta only. Thus, its derivative with respect to any position vector $\\mathbf{r}_k$ is zero:\n$$\n\\nabla_{\\mathbf{r}_k} (\\mathbf{P})_\\beta = \\frac{\\partial}{\\partial \\mathbf{r}_k} \\sum_{j=1}^{N} (\\mathbf{p}_j)_\\beta = \\mathbf{0}\n$$\nThe derivative with respect to a momentum vector $\\mathbf{p}_k$ is:\n$$\n\\nabla_{\\mathbf{p}_k} (\\mathbf{P})_\\beta = \\nabla_{\\mathbf{p}_k} \\sum_{j=1}^{N} (\\mathbf{p}_j)_\\beta = \\nabla_{\\mathbf{p}_k} (\\mathbf{p}_k)_\\beta = \\hat{\\mathbf{e}}_\\beta\n$$\nwhere $\\hat{\\mathbf{e}}_\\beta$ is the unit vector in the $\\beta$ direction.\n\nNext, we find the derivatives of the Hamiltonian $H$:\nThe derivative with respect to momentum $\\mathbf{p}_k$ only acts on the kinetic energy term:\n$$\n\\nabla_{\\mathbf{p}_k} H = \\nabla_{\\mathbf{p}_k} \\left( \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_{i}|^{2}}{2 m_{i}} \\right) = \\frac{\\mathbf{p}_k}{m_k}\n$$\nThe derivative with respect to position $\\mathbf{r}_k$ only acts on the potential energy term $U$:\n$$\n\\nabla_{\\mathbf{r}_k} H = \\nabla_{\\mathbf{r}_k} U = \\nabla_{\\mathbf{r}_k} \\left( \\frac{1}{2} \\sum_{\\substack{i,j=1 \\\\ i \\neq j}}^{N} \\varphi(\\mathbf{s}_{ij}) \\right)\n$$\nThe derivative is non-zero only for terms where $i=k$ or $j=k$. We can split the sum accordingly:\n$$\n\\nabla_{\\mathbf{r}_k} H = \\frac{1}{2} \\sum_{j \\neq k} \\nabla_{\\mathbf{r}_k} \\varphi(\\mathbf{s}_{kj}) + \\frac{1}{2} \\sum_{i \\neq k} \\nabla_{\\mathbf{r}_k} \\varphi(\\mathbf{s}_{ik})\n$$\nWe apply the chain rule for vector functions: $\\nabla_{\\mathbf{r}_k} \\varphi(\\mathbf{s}_{ij}) = (\\frac{\\partial \\mathbf{s}_{ij}}{\\partial \\mathbf{r}_k})^T \\nabla_{\\mathbf{s}} \\varphi(\\mathbf{s}_{ij})$, where $\\frac{\\partial \\mathbf{s}_{ij}}{\\partial \\mathbf{r}_k}$ is the Jacobian matrix.\nThe separation vector is $\\mathbf{s}_{ij} = \\mathbf{r}_i - \\mathbf{r}_j - L\\mathbf{n}_{ij}(\\mathbf{r}_i - \\mathbf{r}_j)$. The function $\\mathbf{n}_{ij}$ is piecewise constant, jumping at the boundaries of the periodic cell. Its derivative is zero almost everywhere, with Dirac delta-like singularities at the jump discontinuities. However, the problem specifies a potential with a finite cutoff $r_c  L/2$. The jumps in $\\mathbf{n}_{ij}$ occur when a component of $\\mathbf{r}_i - \\mathbf{r}_j$ crosses a value of $(q+1/2)L$ for some integer $q$. At these crossing points, the corresponding component of $\\mathbf{s}_{ij}$ is $\\pm L/2$. The magnitude of the separation vector, $|\\mathbf{s}_{ij}|$, is therefore at least $L/2$. Since $r_c  L/2$, the potential $\\varphi(\\mathbf{s}_{ij})$ and its gradient $\\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{ij})$ are zero at and beyond the points of discontinuity. Consequently, the product of the gradient of $\\varphi$ and the singular derivative of $\\mathbf{n}_{ij}$ is zero. We can thus proceed by treating $\\mathbf{n}_{ij}$ as locally constant, so $\\nabla_{\\mathbf{r}_k} \\mathbf{n}_{ij} = \\mathbf{0}$.\n\nWith this justification, we compute the Jacobians:\n$$\n\\frac{\\partial \\mathbf{s}_{kj}}{\\partial \\mathbf{r}_k} = \\frac{\\partial}{\\partial \\mathbf{r}_k} (\\mathbf{r}_k - \\mathbf{r}_j - L\\mathbf{n}_{kj}) = \\mathbf{I}\n$$\n$$\n\\frac{\\partial \\mathbf{s}_{ik}}{\\partial \\mathbf{r}_k} = \\frac{\\partial}{\\partial \\mathbf{r}_k} (\\mathbf{r}_i - \\mathbf{r}_k - L\\mathbf{n}_{ik}) = -\\mathbf{I}\n$$\nwhere $\\mathbf{I}$ is the $d \\times d$ identity matrix.\n\nSubstituting these into the expression for $\\nabla_{\\mathbf{r}_k} H$:\n$$\n\\nabla_{\\mathbf{r}_k} H = \\frac{1}{2} \\sum_{j \\neq k} (\\mathbf{I})^T \\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj}) + \\frac{1}{2} \\sum_{i \\neq k} (-\\mathbf{I})^T \\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{ik}) = \\frac{1}{2} \\sum_{j \\neq k} \\left(\\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj}) - \\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{jk})\\right)\n$$\nwhere we have relabeled the dummy index $i$ to $j$ in the second sum.\n\nA fundamental property of physical pair potentials is invariance under parity, meaning $\\varphi(\\mathbf{s}) = \\varphi(-\\mathbf{s})$. This is explicitly supported by the example $\\varphi(\\mathbf{s}) = \\phi(|\\mathbf{s}|)$. This evenness of $\\varphi$ implies that its gradient, $\\nabla_{\\mathbf{s}}\\varphi$, is an odd function: $\\nabla_{\\mathbf{s}}\\varphi(-\\mathbf{s}) = -\\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s})$. The MIC definition ensures that $\\mathbf{s}_{jk} = -\\mathbf{s}_{kj}$ (almost everywhere). Therefore:\n$$\n\\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{jk}) = \\nabla_{\\mathbf{s}}\\varphi(-\\mathbf{s}_{kj}) = -\\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj})\n$$\nThis is the mathematical statement of Newton's third law for this system: the force exerted by $j$ on $k$ is equal and opposite to the force exerted by $k$ on $j$.\n\nSubstituting this into the expression for $\\nabla_{\\mathbf{r}_k} H$:\n$$\n\\nabla_{\\mathbf{r}_k} H = \\frac{1}{2} \\sum_{j \\neq k} \\left(\\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj}) - (-\\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj}))\\right) = \\sum_{j \\neq k} \\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj})\n$$\nThis result is simply $-\\mathbf{F}_k$, the negative of the total force on particle $k$.\n\nNow we assemble the Poisson bracket $\\{(\\mathbf{P})_\\beta, H\\}$:\n$$\n\\{(\\mathbf{P})_\\beta, H\\} = \\sum_{k=1}^{N} \\left( \\mathbf{0} \\cdot \\frac{\\mathbf{p}_k}{m_k} - \\hat{\\mathbf{e}}_\\beta \\cdot \\nabla_{\\mathbf{r}_k} H \\right) = - \\sum_{k=1}^{N} \\hat{\\mathbf{e}}_\\beta \\cdot \\nabla_{\\mathbf{r}_k} H = - \\sum_{k=1}^{N} (\\nabla_{\\mathbf{r}_k} H)_\\beta\n$$\nThis means the vector Poisson bracket is $\\{\\mathbf{P}, H\\} = - \\sum_{k=1}^{N} \\nabla_{\\mathbf{r}_k} H$.\nSubstituting our result for $\\nabla_{\\mathbf{r}_k} H$:\n$$\n\\{\\mathbf{P}, H\\} = - \\sum_{k=1}^{N} \\sum_{j \\neq k} \\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj})\n$$\nThis is a double summation over all ordered pairs of distinct-particle indices $(k,j)$. Let $\\mathbf{G}_{kj} = \\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj})$. The sum is $-\\sum_{k \\neq j} \\mathbf{G}_{kj}$. We can group the terms pairwise:\n$$\n\\sum_{k \\neq j} \\mathbf{G}_{kj} = \\sum_{k  j} (\\mathbf{G}_{kj} + \\mathbf{G}_{jk})\n$$\nAs previously shown, $\\mathbf{G}_{jk} = \\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{jk}) = -\\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj}) = -\\mathbf{G}_{kj}$.\nThus, each term in the sum is $\\mathbf{G}_{kj} + \\mathbf{G}_{jk} = \\mathbf{G}_{kj} - \\mathbf{G}_{kj} = \\mathbf{0}$.\nThe entire sum is therefore zero:\n$$\n\\sum_{k \\neq j} \\nabla_{\\mathbf{s}}\\varphi(\\mathbf{s}_{kj}) = \\mathbf{0}\n$$\nThis leads to the final result:\n$$\n\\{\\mathbf{P}, H\\} = \\mathbf{0}\n$$\nThe Poisson bracket of the total momentum with the Hamiltonian is the zero vector. This confirms that the total momentum $\\mathbf{P}$ is a constant of motion for a system with periodic boundary conditions and a centrosymmetric pair potential, provided the potential and its derivatives vanish at the boundary of the minimum-image cell.",
            "answer": "$$\n\\boxed{\\mathbf{0}}\n$$"
        }
    ]
}