{
    "hands_on_practices": [
        {
            "introduction": "将时间滞后独立成分分析（tICA）的抽象数学公式与一个具体物理系统的参数联系起来，是建立深刻理解的第一步。本练习将引导您为一个在二次势中运动的过阻尼粒子（一个可解析求解的物理模型）推导tICA特征值。通过从系统的运动方程直接求解，您将从根本上理解tICA是如何捕捉动力学过程的时间尺度的。",
            "id": "3407091",
            "problem": "考虑一个粒子在二次势中的二维空间过阻尼朗之万动力学。状态向量为 $x(t) \\in \\mathbb{R}^{2}$，其演化遵循\n$$\n\\mathrm{d}x(t) \\;=\\; - D \\, \\beta \\, K \\, x(t)\\, \\mathrm{d}t \\;+\\; \\sqrt{2D}\\, \\mathrm{d}W(t),\n$$\n其中 $D$ 是标量扩散系数，$\\beta = 1/(k_{B}T)$ 是在恒定温度 $T$ 下的逆热能，$K \\in \\mathbb{R}^{2\\times 2}$ 是一个定义了二次势 $U(x) = \\tfrac{1}{2} x^{\\top} K x$ 的对称正定刚度矩阵，$W(t)$ 是一个标准二维维纳过程。假设该过程在玻尔兹曼分布 $\\pi(x) \\propto \\exp(-\\beta U(x))$ 下是平稳且遍历的。\n\n定义滞后时间 $\\tau > 0$ 时的时间滞后协方差矩阵为\n$$\nC(\\tau) \\;=\\; \\mathbb{E}_{\\mathrm{stat}}\\!\\left[\\, x(t) \\, x(t+\\tau)^{\\top} \\,\\right],\n$$\n以及瞬时协方差为 $C(0) = \\mathbb{E}_{\\mathrm{stat}}\\!\\left[\\, x(t)\\, x(t)^{\\top} \\,\\right]$。对于以时间间隔 $\\Delta t$ 采样的长离散时间轨迹 $\\{x_{n}\\}_{n=0}^{N}$，在 $\\tau = m \\Delta t$ 处 $C(\\tau)$ 的标准遍历估计量为\n$$\n\\widehat{C}(\\tau) \\;=\\; \\frac{1}{N-m} \\sum_{n=0}^{N-m-1} x_{n} \\, x_{n+m}^{\\top},\n$$\n类似地，$\\widehat{C}(0) = \\frac{1}{N} \\sum_{n=0}^{N-1} x_{n} x_{n}^{\\top}$。假设 $N$ 足够大，使得 $\\widehat{C}(\\tau)$ 和 $\\widehat{C}(0)$ 分别收敛于 $C(\\tau)$ 和 $C(0)$。\n\n时间滞后独立成分分析 (tICA) 通过求解广义特征值问题来定义反应坐标\n$$\nC(\\tau)\\, v \\;=\\; \\lambda(\\tau)\\, C(0)\\, v,\n$$\n其中 $\\lambda(\\tau)$ 为特征值，$v \\neq 0$ 为广义特征向量。设物理参数为\n$$\nK = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} \\;\\;\\text{，单位为}\\;\\; k_{B}T/\\text{nm}^{2}, \\qquad D = 0.5 \\;\\;\\text{，单位为}\\;\\; \\text{nm}^{2}/\\text{ps}.\n$$\n\n仅从上述定义以及线性随机微分方程和平衡统计力学的基本性质出发，推导 tICA 的领先（最大）广义特征值 $\\lambda_{\\max}(\\tau)$ 关于 $D$、$\\beta$、$K$ 的谱和 $\\tau$ 的解析表达式。然后计算在滞后时间 $\\tau = 1.5$（单位为 ps）时 $\\lambda_{\\max}(\\tau)$ 的值。您的答案必须是一个实数。将答案四舍五入至四位有效数字。该特征值是无量纲的，因此请报告一个不带单位的纯数。",
            "solution": "我们从求解该线性随机微分方程出发。方程的正式解为：\n$$\nx(t+\\tau) = e^{-D\\beta K \\tau} x(t) + \\int_t^{t+\\tau} e^{-D\\beta K (t+\\tau-s)} \\sqrt{2D} \\mathrm{d}W(s)\n$$\n接下来，我们计算时间滞后协方差矩阵 $C(\\tau)$：\n$$\nC(\\tau) = \\mathbb{E}[x(t) x(t+\\tau)^\\top] = \\mathbb{E}\\left[x(t) \\left(e^{-D\\beta K \\tau} x(t) + \\text{noise}\\right)^\\top\\right]\n$$\n由于 $x(t)$ 与未来的维纳过程增量不相关，噪声项的期望为零。因此：\n$$\nC(\\tau) = \\mathbb{E}[x(t) x(t)^\\top (e^{-D\\beta K \\tau})^\\top] = C(0) (e^{-D\\beta K \\tau})^\\top\n$$\n因为 $K$ 是对称的，所以 $(e^{-D\\beta K \\tau})^\\top = e^{-D\\beta K^\\top \\tau} = e^{-D\\beta K \\tau}$。所以，我们得到关系 $C(\\tau) = C(0) e^{-D\\beta K \\tau}$。\n\n将此关系代入 tICA 的广义特征值问题：\n$$\nC(0) e^{-D\\beta K \\tau} v = \\lambda(\\tau) C(0) v\n$$\n由于系统处于平衡态且势能是正定的，瞬时协方差矩阵 $C(0)$ 是可逆的。我们可以从左侧乘以 $C(0)^{-1}$，得到一个标准的特征值问题：\n$$\ne^{-D\\beta K \\tau} v = \\lambda(\\tau) v\n$$\n这表明 tICA 的特征值 $\\lambda_i(\\tau)$ 就是矩阵 $e^{-D\\beta K \\tau}$ 的特征值。\n\n一个矩阵指数 $e^A$ 的特征值是 $e^{a_i}$，其中 $a_i$ 是矩阵 $A$ 的特征值。在这里，$A = -D\\beta K$。$A$ 的特征值是 $-D\\beta k_i$，其中 $k_i$ 是矩阵 $K$ 的特征值。因此，tICA 特征值可以表示为：\n$$\n\\lambda_i(\\tau) = e^{-D\\beta k_i \\tau}\n$$\n要找到最大的 tICA 特征值 $\\lambda_{\\max}(\\tau)$，我们必须找到 $K$ 的最小特征值 $k_{\\min}$，因为指数函数的参数是负的。\n\n现在，我们计算矩阵 $K = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}$ 的特征值。特征方程为 $\\det(K - kI) = 0$：\n$$\n(3-k)(2-k) - (1)(1) = 0 \\\\\nk^2 - 5k + 6 - 1 = 0 \\\\\nk^2 - 5k + 5 = 0\n$$\n使用二次求根公式，我们得到特征值为：\n$$\nk = \\frac{-(-5) \\pm \\sqrt{(-5)^2 - 4(1)(5)}}{2(1)} = \\frac{5 \\pm \\sqrt{25 - 20}}{2} = \\frac{5 \\pm \\sqrt{5}}{2}\n$$\n最小的特征值是 $k_{\\min} = \\frac{5 - \\sqrt{5}}{2}$。\n\n最后，我们代入给定的数值：$D = 0.5 \\, \\text{nm}^2/\\text{ps}$，$\\tau = 1.5 \\, \\text{ps}$。单位是相容的，$\\beta$ 的数值为 $1$（以 $1/k_B T$ 为单位）。\n$$\n\\lambda_{\\max}(\\tau=1.5) = \\exp\\left(-D \\beta k_{\\min} \\tau\\right) = \\exp\\left(-0.5 \\cdot \\left(\\frac{5 - \\sqrt{5}}{2}\\right) \\cdot 1.5\\right)\n$$\n$$\n\\lambda_{\\max}(1.5) = \\exp\\left(-0.375 (5 - \\sqrt{5})\\right) \\approx \\exp(-0.375 \\times 2.763932) \\approx \\exp(-1.0364745)\n$$\n$$\n\\lambda_{\\max}(1.5) \\approx 0.35471\n$$\n四舍五入到四位有效数字，结果为 $0.3547$。",
            "answer": "$$\\boxed{0.3547}$$"
        },
        {
            "introduction": "虽然分子动力学是连续的，但我们常常通过将其粗粒化为离散的亚稳态来分析它。本练习将展示，对于这样一个离散模型，tICA特征值恰好就是状态间转移矩阵的特征值，从而揭示系统最慢的弛豫过程和“谱隙”这一关键概念。这项实践将巩固tICA与离散态动力学模型（如马尔可夫态模型）之间的重要联系。",
            "id": "3407097",
            "problem": "将一个稳态、遍历的分子动力学轨迹粗粒化为三个不相交的亚稳态区域，在延迟时间 $\\tau$ 处产生一个可逆离散时间马尔可夫链，其稳态分布为 $\\boldsymbol{\\pi} = (\\pi_1,\\pi_2,\\pi_3)^{\\top}$，转移矩阵为行随机矩阵 $P$。可逆性条件（细致平衡）表明，对于所有的 $i,j$，都有 $\\pi_i P_{ij} = \\pi_j P_{ji}$。考虑通过时间延迟独立成分分析 (tICA) 进行数据驱动的慢反应坐标发现。tICA 由一个广义特征问题定义，该问题由基于亚稳态区域指示函数构建的零均值特征向量的零延迟和时间延迟协方差矩阵构成。\n\n给定稳态分布和转移矩阵\n$$\n\\boldsymbol{\\pi} = \\begin{pmatrix} 0.5 \\\\ 0.4 \\\\ 0.1 \\end{pmatrix}, \\qquad\nP = \\begin{pmatrix}\n0.83   0.16   0.01 \\\\\n0.20   0.79   0.01 \\\\\n0.05   0.04   0.91\n\\end{pmatrix}.\n$$\n从作用于状态空间上函数的马尔可夫转移算子的基本定义，以及由稳态时间相关性构建的 tICA 广义特征问题出发，推导在细致平衡假设下，其谱编码了慢动力学的算子，并从 $P$ 计算其非平凡谱。然后，将亚稳态谱隙 $g$ 定义为该算子第二大和第三大特征值之差，并精确计算 $g$ 的值。\n\n将最终答案表示为一个无量纲实数。不要四舍五入，请提供精确值。",
            "solution": "问题陈述已经过验证，是自洽的、有科学依据且良定的。所提供的稳态分布 $\\boldsymbol{\\pi}$ 和转移矩阵 $P$ 与可逆马尔可夫链的定义一致。具体而言，$P$ 是行随机的，$\\boldsymbol{\\pi}^\\top P = \\boldsymbol{\\pi}^\\top$，并且对于所有 $i, j$，细致平衡条件 $\\pi_i P_{ij} = \\pi_j P_{ji}$ 均成立。\n\n问题要求推导其谱编码了系统慢动力学的算子，并计算其非平凡谱。在可逆马尔可夫状态模型 (MSM) 的背景下，慢动力学由转移算子的特征值描述，该算子由矩阵 $P$ 表示。虽然 $P$ 本身通常不是对称的，但细致平衡条件意味着它对于加权内积 $\\langle \\mathbf{f}, \\mathbf{g} \\rangle_{\\pi} = \\sum_i \\pi_i f_i g_i$ 是自伴的，其中 $\\mathbf{f}$ 和 $\\mathbf{g}$ 是表示为向量的状态空间上的函数。\n\n令 $\\Pi = \\text{diag}(\\boldsymbol{\\pi})$ 为对角线上元素为稳态概率的对角矩阵。细致平衡条件可以写成矩阵形式 $\\Pi P = (\\Pi P)^\\top$。此性质确保 $P$ 与一个对称矩阵相似。考虑矩阵 $T = \\Pi^{1/2} P \\Pi^{-1/2}$。相似变换保持特征值不变。$T$ 是对称的，因为\n$$\nT^\\top = (\\Pi^{1/2} P \\Pi^{-1/2})^\\top = (\\Pi^{-1/2})^\\top P^\\top (\\Pi^{1/2})^\\top = \\Pi^{-1/2} P^\\top \\Pi^{1/2}.\n$$\n在左右两边乘以 $\\Pi^{1/2}$，我们得到 $\\Pi^{1/2} T^\\top \\Pi^{1/2} = P^\\top \\Pi$。由于 $\\Pi P = (\\Pi P)^\\top = P^\\top \\Pi$，我们得到 $\\Pi^{1/2} T^\\top \\Pi^{1/2} = \\Pi P$。这导致 $T^\\top = \\Pi^{-1/2} (\\Pi P) \\Pi^{-1/2} = \\Pi^{1/2} P \\Pi^{-1/2} = T$。\n因为 $T$ 是一个对称矩阵，其特征值是实数。由于 $T$ 和 $P$ 相似，它们共享相同的谱。这个算子 $T$（或等价地，在适当内积空间中的 $P$）就是其谱描述动力学的算子。$P$ 的特征值通过 $\\tau_k = -\\tau / \\ln(|\\lambda_k|)$ 对应于系统的弛豫时间尺度，其中 $\\lambda_k$ 是特征值。\n\n问题进一步将其与时间延迟独立成分分析 (tICA) 联系起来。tICA 方法求解广义特征问题 $C(\\tau) \\mathbf{v} = \\lambda^{\\text{tICA}} C(0) \\mathbf{v}$，其中 $C(0)$ 和 $C(\\tau)$ 是所选特征向量的零延迟和时间延迟协方差矩阵。对于离散状态上的指示函数 $\\boldsymbol{\\chi}(x)$ 构成的特征向量，并将其处理成零均值，协方差矩阵为 $C(0) = \\Pi - \\boldsymbol{\\pi}\\boldsymbol{\\pi}^\\top$ 和 $C(\\tau) = \\Pi P - \\boldsymbol{\\pi}\\boldsymbol{\\pi}^\\top$。\n\n设 $\\mathbf{w}_k$ 是 $P$ 的一个右特征向量，其特征值为 $\\lambda_k$。对于一个随机矩阵，总存在一个特征值 $\\lambda_1 = 1$，其特征向量为 $\\mathbf{w}_1 = \\mathbf{1}$（全一向量）。对于任何其他特征值 $\\lambda_k \\neq 1$，对应的特征向量与稳态分布正交，即 $\\boldsymbol{\\pi}^\\top \\mathbf{w}_k = 0$。对于这样的特征向量，我们可以评估协方差矩阵对其的作用：\n$$\nC(0) \\mathbf{w}_k = (\\Pi - \\boldsymbol{\\pi}\\boldsymbol{\\pi}^\\top) \\mathbf{w}_k = \\Pi \\mathbf{w}_k - \\boldsymbol{\\pi}(\\boldsymbol{\\pi}^\\top \\mathbf{w}_k) = \\Pi \\mathbf{w}_k\n$$\n$$\nC(\\tau) \\mathbf{w}_k = (\\Pi P - \\boldsymbol{\\pi}\\boldsymbol{\\pi}^\\top) \\mathbf{w}_k = \\Pi P \\mathbf{w}_k - \\boldsymbol{\\pi}(\\boldsymbol{\\pi}^\\top \\mathbf{w}_k) = \\Pi (P \\mathbf{w}_k) = \\Pi (\\lambda_k \\mathbf{w}_k) = \\lambda_k (\\Pi \\mathbf{w}_k)\n$$\n将这些代入 tICA 特征问题，我们得到：\n$$\n\\lambda_k (\\Pi \\mathbf{w}_k) = \\lambda^{\\text{tICA}}_k (\\Pi \\mathbf{w}_k)\n$$\n这证明了 tICA 特征值 $\\lambda^{\\text{tICA}}_k$ 与转移矩阵 $P$ 的特征值 $\\lambda_k$ 相同。因此，任务简化为计算给定矩阵 $P$ 的特征值。\n\n转移矩阵为：\n$$\nP = \\begin{pmatrix}\n0.83   0.16   0.01 \\\\\n0.20   0.79   0.01 \\\\\n0.05   0.04   0.91\n\\end{pmatrix}\n$$\n特征值 $\\lambda$ 是特征方程 $\\det(P - \\lambda I) = 0$ 的根。由于 $P$ 是一个行随机矩阵，其中一个特征值为 $\\lambda_1 = 1$。构成非平凡谱的其他特征值可以使用矩阵的迹和行列式求得。\n特征值之和等于矩阵的迹：\n$$\n\\text{Tr}(P) = \\lambda_1 + \\lambda_2 + \\lambda_3 = 0.83 + 0.79 + 0.91 = 2.53\n$$\n由于 $\\lambda_1 = 1$，我们有 $1 + \\lambda_2 + \\lambda_3 = 2.53$，可简化为 $\\lambda_2 + \\lambda_3 = 1.53$。\n\n特征值之积等于矩阵的行列式：\n$$\n\\det(P) = \\lambda_1 \\lambda_2 \\lambda_3 = \\lambda_2 \\lambda_3\n$$\n$$\n\\det(P) = 0.83(0.79 \\cdot 0.91 - 0.01 \\cdot 0.04) - 0.16(0.20 \\cdot 0.91 - 0.01 \\cdot 0.05) + 0.01(0.20 \\cdot 0.04 - 0.79 \\cdot 0.05)\n$$\n$$\n\\det(P) = 0.83(0.7189 - 0.0004) - 0.16(0.182 - 0.0005) + 0.01(0.008 - 0.0395)\n$$\n$$\n\\det(P) = 0.83(0.7185) - 0.16(0.1815) + 0.01(-0.0315)\n$$\n$$\n\\det(P) = 0.596355 - 0.02904 - 0.000315 = 0.567\n$$\n因此，我们得到一个关于非平凡特征值 $\\lambda_2$ 和 $\\lambda_3$ 的二元方程组：\n$$\n\\lambda_2 + \\lambda_3 = 1.53\n$$\n$$\n\\lambda_2 \\lambda_3 = 0.567\n$$\n它们是一元二次方程 $x^2 - (\\lambda_2 + \\lambda_3)x + \\lambda_2 \\lambda_3 = 0$ 的根：\n$$\nx^2 - 1.53x + 0.567 = 0\n$$\n使用求根公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$\nx = \\frac{1.53 \\pm \\sqrt{(-1.53)^2 - 4(1)(0.567)}}{2} = \\frac{1.53 \\pm \\sqrt{2.3409 - 2.268}}{2}\n$$\n$$\nx = \\frac{1.53 \\pm \\sqrt{0.0729}}{2} = \\frac{1.53 \\pm 0.27}{2}\n$$\n两个根是：\n$$\n\\lambda_2 = \\frac{1.53 + 0.27}{2} = \\frac{1.80}{2} = 0.90\n$$\n$$\n\\lambda_3 = \\frac{1.53 - 0.27}{2} = \\frac{1.26}{2} = 0.63\n$$\n按照惯例，特征值按大小排序 $\\lambda_1  \\lambda_2 \\ge \\lambda_3 \\ge \\dots$。所以，$\\lambda_2 = 0.90$ 且 $\\lambda_3 = 0.63$。非平凡谱为 $\\{0.90, 0.63\\}$。\n\n亚稳态谱隙 $g$ 定义为第二大和第三大特征值之差：\n$$\ng = \\lambda_2 - \\lambda_3\n$$\n$$\ng = 0.90 - 0.63 = 0.27\n$$\n这个值是精确的，因为所有中间计算都涉及有限小数。",
            "answer": "$$\\boxed{0.27}$$"
        },
        {
            "introduction": "从理论走向实际数据分析，需要稳健的方法来避免过拟合并确保我们的模型具有预测能力。本练习将挑战您设计一个交叉验证方案，以正确处理分子动力学数据中固有的时间相关性。这是一项对于任何数据驱动建模都至关重要的技能，它能帮助我们合理地选择tICA的超参数，如延迟时间 $\\tau$ 和成分数量。",
            "id": "3407111",
            "problem": "给定$M$条独立的分子动力学轨迹$\\{\\mathbf{x}^{(m)}_t\\}_{t=0}^{T_m}$，这些轨迹由一个时间齐次马尔可夫过程生成，该过程在一个特征相关时间$t_{\\mathrm{corr}}$上混合。你提取一个特征映射$\\boldsymbol{\\chi}:\\mathbb{R}^{3N}\\to\\mathbb{R}^p$以获得时间序列$\\mathbf{z}^{(m)}_t=\\boldsymbol{\\chi}(\\mathbf{x}^{(m)}_t)$。你希望使用$K$折交叉验证为时间滞后独立成分分析(tICA)选择超参数，特别是滞后时间$\\tau$和成分数量$d$。目标是为每个候选对$(\\tau,d)$获得马尔可夫过程变分法(VAMP)-2分数的一个近似无偏的样本外估计，同时最小化训练数据和测试数据之间的统计依赖性。假设数据长度足以将时间序列划分为比$t_{\\mathrm{corr}}$更长的块，并且$\\tau \\ll \\min_m T_m$。\n\n下列哪种交叉验证协议能够最可靠地实现所述目标？\n\nA. 对于每条轨迹和一个固定的$\\tau$，将时间索引划分为$K$个长度相等的连续、不重叠的块$L$，选择$L$使得$L \\gg t_{\\mathrm{corr}}$且$L  \\tau$。在每一折中，从每条轨迹中保留一个块作为测试集，并仅使用剩余的块作为训练集。仅在训练块上估计所有预处理（特征中心化、缩放）、协方差和tICA模型。在为测试分数构建滞后对时，仅使用完全位于保留块内的对$(t,t+\\tau)$，丢弃任何会跨越块边界的对。仅使用从训练集确定的白化或投影，在保留的数据上计算VAMP-2分数。对每折的测试分数进行加权平均（权重为每折中有效测试对的数量），以在不同候选$(\\tau,d)$之间进行比较。\n\nB. 不考虑时间顺序，将所有轨迹中的单个时间索引随机分配到$K$个折中，使得每折具有大致相同数量的帧。在每一折中，在$K-1$个折上训练tICA，并在剩余的一折上计算VAMP-2分数，使用任何可用的相邻时间$(t,t+\\tau)$构建滞后对，即使$t$和$t+\\tau$位于不同的折中。为了数值稳定性，使用从测试折本身估计的统计数据对测试折进行中心化和白化。\n\nC. 将每条轨迹划分为$K$个连续的块，但为了稳定估计，汇集所有块（包括训练块和保留块）来估计均值、协方差、白化和tICA成分。在每一折中，使用这些汇集的变换在保留块上计算VAMP-2分数，然后对各折的分数进行平均。\n\nD. 将每条轨迹划分为连续的块，并在每折中保留一个块。在每折的训练块上拟合tICA并计算VAMP-2分数。通过在各折中最大化这个样本内训练分数来选择$(\\tau,d)$，最后通过在完整数据集上使用选定的$(\\tau,d)$重新拟合tICA，并在同一完整数据集上评估分数来报告VAMP-2分数。\n\n选择最能描述一个统计上健全的$K$折交叉验证协议的选项，该协议通过将轨迹分割成统计上独立的块并在保留数据上评估VAMP-2分数来进行tICA模型选择。可能有一个或多个正确选项；请选择所有适用的选项。",
            "solution": "问题要求找到最可靠的$K$折交叉验证协议，用于为时间滞后独立成分分析(tICA)选择超参数$(\\tau, d)$。选择标准是VAMP-2分数。该协议必须提供该分数的一个近似无偏的样本外估计，同时最小化训练集和测试集之间的统计依赖性。数据由分子动力学轨迹组成，这些轨迹是具有特征相关时间$t_{\\mathrm{corr}}$的时间序列。\n\n交叉验证的基本原则是估计模型在未见过的数据上的性能。这要求严格分离用于训练模型的数据（训练集）和用于评估其性能的数据（测试集）。对于时间序列数据，标准的数据点随机分割是无效的，因为它忽略了时间相关性。测试集中的一个点$\\mathbf{z}_t$可能与其在训练集中的邻近点$\\mathbf{z}_{t-1}$和$\\mathbf{z}_{t+1}$高度相关。这种“信息泄露”会导致对模型样本外性能的估计过于乐观、有向上偏差。\n\n对于时间序列，正确的方法是分块交叉验证。将时间序列划分为长度为$L$的连续块，其中$L$的选择要远大于过程的相关时间（$L \\gg t_{\\mathrm{corr}}$）。通过将整个块分配给训练折或测试折，可以确保训练集和测试集近似统计独立。\n\n此外，真正的样本外评估要求模型构建过程的每一步，包括任何数据预处理，如减去均值或白化，都*仅*从训练数据中学习。然后将这些学到的变换应用于测试数据，并在测试数据上计算性能指标（VAMP-2分数）。\n\n让我们根据这些原则分析每个选项。\n\n**A. 对于每条轨迹和一个固定的$\\tau$，将时间索引划分为$K$个长度相等的连续、不重叠的块$L$，选择$L$使得$L \\gg t_{\\mathrm{corr}}$且$L  \\tau$。在每一折中，从每条轨迹中保留一个块作为测试集，并仅使用剩余的块作为训练集。仅在训练块上估计所有预处理（特征中心化、缩放）、协方差和tICA模型。在为测试分数构建滞后对时，仅使用完全位于保留块内的对$(t,t+\\tau)$，丢弃任何会跨越块边界的对。仅使用从训练集确定的白化或投影，在保留的数据上计算VAMP-2分数。对每折的测试分数进行加权平均（权重为每折中有效测试对的数量），以在不同候选$(\\tau,d)$之间进行比较。**\n\n这个选项描述了一个统计上严谨的、用于时间序列数据的分块交叉验证协议。\n1.  **划分为$L \\gg t_{\\mathrm{corr}}$的连续块**：这是划分时间序列数据以确保训练集和测试集之间近似独立的正确方法。\n2.  **严格分离训练和测试**：该协议正确地规定了所有模型参数——预处理（中心化、缩放）、协方差矩阵和tICA成分本身——都*完全*从训练数据中估计。\n3.  **正确的样本外评估**：VAMP-2分数是在保留的测试数据上计算的，使用的是从训练集学到的变换（白化、投影）。这是样本外评估的定义。\n4.  **处理滞后对**：仅使用完全位于块内的滞后对$(t, t+\\tau)$的指令可以防止在训练和测试段之间的边界处发生信息泄露。\n\n该协议遵守了估计时间序列模型泛化性能的所有最佳实践，并直接解决了问题陈述的目标。\n**结论：正确。**\n\n**B. 不考虑时间顺序，将所有轨迹中的单个时间索引随机分配到$K$个折中，使得每折具有大致相同数量的帧。在每一折中，在$K-1$个折上训练tICA，并在剩余的一折上计算VAMP-2分数，使用任何可用的相邻时间$(t,t+\\tau)$构建滞后对，即使$t$和$t+\\tau$位于不同的折中。为了数值稳定性，使用从测试折本身估计的统计数据对测试折进行中心化和白化。**\n\n这个协议有多个严重缺陷。\n1.  **随机分配时间索引**：如上所述，这违反了时间序列数据的独立性假设，并导致训练集和测试集之间出现严重的信息泄露，从而得到一个高度乐观且有偏的性能估计。\n2.  **跨折边界的滞后对**：这进一步加剧了信息泄露问题。\n3.  **用自身统计数据预处理测试集**：这是交叉验证方法论中的一个关键错误。测试集旨在模拟真正未见过的数据。在进行预测或评估性能之前，不能对整个未见过的数据集计算统计数据。必须使用*仅*从训练数据导出的参数来转换测试数据。\n\n该协议无法提供可靠的样本外性能估计。\n**结论：不正确。**\n\n**C. 将每条轨迹划分为$K$个连续的块，但为了稳定估计，汇集所有块（包括训练块和保留块）来估计均值、协方差、白化和tICA成分。在每一折中，使用这些汇集的变换在保留块上计算VAMP-2分数，然后对各折的分数进行平均。**\n\n这个协议违反了交叉验证的核心原则。\n1.  **汇集所有数据进行估计**：通过使用保留的（测试）块来估计模型参数（均值、协方差、tICA成分），模型在训练期间“看到”了测试数据。这用来自测试集的信息污染了训练过程。\n2.  **有偏的评估**：得到的VAMP-2分数不是一个样本外估计，而是一个部分样本内的估计。它将是乐观偏倚的，不能反映模型在未见过的数据上的真实性能。虽然划分为块是正确的，但随后汇集数据使分离的好处化为乌有。\n\n该协议构成了一种数据泄露形式，不是一个有效的交叉验证程序。\n**结论：不正确。**\n\n**D. 将每条轨迹划分为连续的块，并在每折中保留一个块。在每折的训练块上拟合tICA并计算VAMP-2分数。通过在各折中最大化这个样本内训练分数来选择$(\\tau,d)$，最后通过在完整数据集上使用选定的$(\\tau,d)$重新拟合tICA，并在同一完整数据集上评估分数来报告VAMP-2分数。**\n\n这个协议从根本上误解了交叉验证的目的。\n1.  **在训练数据上评估**：该程序在训练模型所用的相同数据上评估模型（“样本内训练分数”）。测试集的目的是在*不同*的数据上评估性能。最大化训练分数是导致过拟合的直接途径；一个更复杂的模型（例如，更大的$d$）几乎总是在其训练数据上产生更好的分数。\n2.  **没有样本外评估**：该协议从未使用保留的块来评估在其他块上训练的模型。它完全没有估计泛化误差。\n3.  **报告样本内分数**：最后一步，在完整数据集上训练后报告该数据集上的分数，也是一种样本内度量，这已知是有偏的。\n\n这个过程没有执行交叉验证；它只是计算并最大化训练分数。\n**结论：不正确。**\n\n总而言之，只有选项A描述了一个健全且严谨的交叉验证过程，用于在时间序列数据上选择tICA的超参数，并实现了获得无偏样本外性能估计的既定目标。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}