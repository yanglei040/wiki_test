{
    "hands_on_practices": [
        {
            "introduction": "任何粗粒度模拟的第一步都是决定如何以较低的分辨率表示原子系统。这种“映射”是一个关键选择，它在计算效率和化学准确性之间取得平衡。本练习将指导您完成为一个简单但重要的分子——乙醇——创建化学上合理的映射的思考过程，并强调如何保留其关键的化学特性，如两亲性。",
            "id": "3453034",
            "problem": "像乙醇这样的小分子两亲物，在粗粒化力场中必须以一种保留其主要化学功能的方式来表示。在MARTINI粗粒化力场中，原子团被合并为称为“珠子”(beads)的相互作用位点。典型的映射规则将大约$2$–$4$个重原子集总到一个珠子中，并分配珠子类型以编码极性、氢键能力和非极性特征，从而控制有效的非键相互作用强度。辛醇-水分配系数，记作$K_{\\mathrm{ow}}$，定义为平衡状态下的$K_{\\mathrm{ow}} = c_{\\mathrm{o}}/c_{\\mathrm{w}}$，其中$c_{\\mathrm{o}}$和$c_{\\mathrm{w}}$分别是溶质在正辛醇相和水相中的浓度。从水到辛醇的转移热力学自由能与$K_{\\mathrm{ow}}$的关系为$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} = - R T \\ln K_{\\mathrm{ow}}$，其中$R$是气体常数，$T$是温度。一个化学上合理的粗粒化映射应该能产生遵循主要化学相互作用的溶剂化和分配行为：羟基与水的氢键作用，以及烷基与非极性环境的色散相互作用。\n\n考虑原子连接性为$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$的乙醇。选择与MARTINI理念以及物理上真实的溶剂化和辛醇-水分配行为最一致的映射和珠子类型分配。每个选项都指定了原子团到珠子的映射，并预测了对水溶剂化和$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}$符号的定性影响。\n\nA. 将乙醇映射为两个珠子：将$\\mathrm{CH}_2{-}\\mathrm{OH}$基团合并为一个极性氢键珠子（记为P类，既能作为氢键供体又能作为受体），将末端的$\\mathrm{CH}_3$基团合并为一个非极性珠子（记为C类）。预测极性珠子有利于水溶剂化，非极性珠子有利于辛醇溶剂化，并且净辛醇-水转移自由能满足$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$（即$K_{\\mathrm{ow}}  1$），反映出对水的轻微偏好。\n\nB. 将乙醇映射为一个珠子：将所有原子$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$合并为一个强极性珠子（记为P类，具有非常高的极性，有效地模拟一个完全形成氢键的溶质）。预测非常强的水溶剂化和对辛醇的强烈不利转移，$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$（即$K_{\\mathrm{ow}} \\ll 1$）。\n\nC. 将乙醇映射为两个珠子：将$\\mathrm{CH}_3$和$\\mathrm{CH}_2{-}\\mathrm{OH}$基团都分配为非极性珠子（记为C类），从而忽略了氢键能力。预测弱水溶剂化、强辛醇溶剂化，以及$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}  0$（即$K_{\\mathrm{ow}} > 1$）。\n\nD. 将乙醇映射为两个珠子：将$\\mathrm{CH}_2{-}\\mathrm{OH}$基团分配为一个带电珠子（记为Q类，带净电荷以模拟离子行为），将$\\mathrm{CH}_3$基团分配为一个非极性珠子（C类）。预测由长程静电驱动的非常强的水溶剂化，在水溶液中表现出类似盐的行为，以及$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$（即$K_{\\mathrm{ow}} \\ll 1$）。\n\n根据上述定义以及关于氢键、色散和关系式$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} = - R T \\ln K_{\\mathrm{ow}}$的第一性原理推理，哪个选项最接近于化学上合理的MARTINI映射，并能为乙醇产生定性正确的溶剂化和分配行为？",
            "solution": "用户要求分析一个关于使用MARTINI力场对乙醇进行粗粒化建模的问题。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **分子**：乙醇，原子连接性为$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$。\n*   **力场**：MARTINI粗粒化力场。\n*   **MARTINI原理**：\n    *   原子团被合并为相互作用位点（珠子）。\n    *   映射规则：“大约$2$–$4$个重原子”集总到一个珠子中。\n    *   珠子类型编码极性、氢键能力和非极性特征。\n    *   目标：保留主要的化学功能（例如，对于两亲物，羟基的氢键作用和烷基的色散相互作用）。\n*   **定义**：\n    *   辛醇-水分配系数：$K_{\\mathrm{ow}} = c_{\\mathrm{o}}/c_{\\mathrm{w}}$，其中$c_{\\mathrm{o}}$和$c_{\\mathrm{w}}$分别是溶质在正辛醇和水中的浓度。\n    *   从水到辛醇的转移自由能：$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} = - R T \\ln K_{\\mathrm{ow}}$，其中$R$是气体常数，$T$是温度。\n*   **问题**：确定哪个选项提供了与MARTINI理念和乙醇的物理现实溶剂化/分配行为最一致的映射和珠子类型分配。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题在物理化学和计算生物物理学的原理上有很好的基础。MARTINI力场是一种广泛使用且成熟的方法。$K_{\\mathrm{ow}}$的定义及其与转移自由能$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}$的关系是基本的热力学概念。对乙醇化学性质的描述是准确的。\n*   **问题明确性**：问题提得很明确。它要求根据一组明确陈述的原则（MARTINI理念）和已知的物理现实（乙醇的溶剂化性质）对给定选项进行比较分析。预期会有一个唯一的最佳答案。\n*   **客观性**：问题以客观、技术性的语言陈述，没有歧义或主观论断。\n\n**步骤3：结论和行动**\n\n问题陈述科学合理、自成体系且定义明确。它是有效的。可以进行求解过程。\n\n### 求解推导\n\n该分析需要将MARTINI力场的原理与已知的乙醇物理化学性质相结合。\n\n**1. 分析乙醇的性质**\n乙醇（$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$）是一种小的两亲分子。它拥有一个极性的、能形成氢键的羟基（$\\mathrm{-OH}$），这使其在水中有高溶解度；以及一个短的、非极性的乙基（$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}$），它与像辛醇这样的非极性环境有良好的相互作用。实验上，乙醇与水可以任意比例混溶。其辛醇-水分配系数$\\log_{10} K_{\\mathrm{ow}}$约为$-0.31$，这得出$K_{\\mathrm{ow}} = 10^{-0.31} \\approx 0.49$。\n使用给定的热力学关系式，$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} = - R T \\ln K_{\\mathrm{ow}}$：\n由于$K_{\\mathrm{ow}} \\approx 0.49  1$，其自然对数$\\ln K_{\\mathrm{ow}}$是负数。\n因此，转移自由能是正的：$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$。这表明乙醇在热力学上对水相有轻微的偏好，胜过辛醇相，尽管它在两者中都可溶。一个化学上合理的模型必须能够复现这种定性行为。\n\n**2. 分析MARTINI映射理念**\n问题陈述了两个关键原则：\n*   每个珠子映射大约$2$–$4$个重原子。乙醇有$3$个重原子（两个碳，一个氧）。这意味着$1$珠子或$2$珠子的表示方法都可能是合理的。\n*   映射必须“保留其主要的化学功能”。对于像乙醇这样的两亲物，这意味着要捕捉极性头部（-OH）和非极性尾部（$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}$）的不同特性。双珠子模型在这项任务中天生更优越，因为单个珠子会平均掉这些不同的属性。\n\n**3. 评估每个选项**\n\n**A. 将乙醇映射为两个珠子：将$\\mathrm{CH}_2{-}\\mathrm{OH}$基团合并为一个极性氢键珠子（记为P类，既能作为氢键供体又能作为受体），将末端的$\\mathrm{CH}_3$基团合并为一个非极性珠子（记为C类）。预测极性珠子有利于水溶剂化，非极性珠子有利于辛醇溶剂化，并且净辛醇-水转移自由能满足$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$（即$K_{\\mathrm{ow}}  1$），反映出对水的轻微偏好。**\n\n*   **映射一致性**：这种双珠子映射（$\\mathrm{CH}_3$和$\\mathrm{CH}_2{-}\\mathrm{OH}$）有效地将分子分成了更非极性的部分和更极性的部分。$\\mathrm{CH}_2{-}\\mathrm{OH}$珠子包含了关键的官能团。这明确地保留了两亲性，这是MARTINI理念的一个关键目标。珠子大小（$\\mathrm{CH}_3$为1个重原子，$\\mathrm{CH}_2{-}\\mathrm{OH}$为2个）对于一个珠子来说略微超出了“2-4”规则的范围，但对于小分子，为了更好地表示化学性质，这个规则经常被放宽。将含羟基的基团分配为极性（P）类型，将甲基分配为非极性（C）类型在化学上是正确的。\n*   **预测一致性**：预测极性珠子偏好水而非极性珠子偏好辛醇是正确的。关键是，预测的结果$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$（$K_{\\mathrm{ow}}  1$）与已知的乙醇实验行为完全匹配，包括“对水的轻微偏好”。\n*   **结论**：**正确**。该选项提出了一个化学上合理的映射策略，与所述的MARTINI理念一致，并能产生物理上准确的定性预测。\n\n**B. 将乙醇映射为一个珠子：将所有原子$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$合并为一个强极性珠子（记为P类，具有非常高的极性，有效地模拟一个完全形成氢键的溶质）。预测非常强的水溶剂化和对辛醇的强烈不利转移，$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$（即$K_{\\mathrm{ow}} \\ll 1$）。**\n\n*   **映射一致性**：将乙醇的3个重原子映射为单个珠子，符合$2$–$4$原子规则。然而，通过将其归类为“强极性”，它忽略了乙基的非极性特征，因此未能“保留其主要的化学功能”（即两亲性）。\n*   **预测一致性**：“非常强的水溶剂化”的预测是合理的，但“对辛醇的强烈不利转移”（$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$, $K_{\\mathrm{ow}} \\ll 1$）的预测在事实上是错误的。乙醇在辛醇中高度可溶，其对水的偏好仅是轻微的，其$K_{\\mathrm{ow}} \\approx 0.5$。这个模型描述的会是像甘油这样的分子，而不是乙醇。\n*   **结论**：**错误**。该模型错误地表述了乙醇平衡的两亲特性，并做出了与实验现实不符的预测。\n\n**C. 将乙醇映射为两个珠子：将$\\mathrm{CH}_3$和$\\mathrm{CH}_2{-}\\mathrm{OH}$基团都分配为非极性珠子（记为C类），从而忽略了氢键能力。预测弱水溶剂化、强辛醇溶剂化，以及$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}  0$（即$K_{\\mathrm{ow}} > 1$）。**\n\n*   **映射一致性**：这种映射在化学上是荒谬的。包含高极性和氢键羟基的$\\mathrm{CH}_2{-}\\mathrm{OH}$基团被错误地分配给一个非极性（C）珠子。这违反了基本的化学原理和保留功能的目标。\n*   **预测一致性**：弱水溶剂化和$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}  0$的预测与乙醇的已知行为相反。这描述的是一个小分子烷烃，而不是醇。\n*   **结论**：**错误**。珠子类型的分配存在根本性缺陷，导致了事实错误的预测。\n\n**D. 将乙醇映射为两个珠子：将$\\mathrm{CH}_2{-}\\mathrm{OH}$基团分配为一个带电珠子（记为Q类，带净电荷以模拟离子行为），将$\\mathrm{CH}_3$基团分配为一个非极性珠子（C类）。预测由长程静电驱动的非常强的水溶剂化，在水溶液中表现出类似盐的行为，以及$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$（即$K_{\\mathrm{ow}} \\ll 1$）。**\n\n*   **映射一致性**：这种映射在化学上是不正确的。乙醇是一个中性分子。羟基是极性的，但它不是离子的，不带净形式电荷。将其分配给一个带电（Q）珠子类型是对其化学性质的严重误表述。\n*   **预测一致性**：类似盐行为的预测是不正确的。一个带电物质确实会有非常大的正$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}$，并且在辛醇中几乎不溶，但乙醇不是离子。\n*   **结论**：**错误**。珠子类型的分配在化学上是无效的，导致了描述离子物质而非乙醇的预测。\n\n### 总结\n\n比较各个选项，选项A是唯一一个提出了化学上合理的映射来表示乙醇的两亲性，并做出了与实验事实定性一致的预测（$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$，对水有轻微偏好）。其他选项要么在化学表示上存在缺陷，要么在物理预测上存在缺陷。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一旦分子被映射，就必须定义新的粗粒度珠子之间的相互作用。本练习展示了力场开发中的一项基本任务：参数化相互作用以重现已知的实验或高保真模拟数据，例如溶剂化自由能。您将通过一个简化但强大的方法来调整Lennard-Jones参数，将微观相互作用与宏观热力学性质联系起来。",
            "id": "3453093",
            "problem": "要求您设计一个程序，该程序针对使用 MARTINI 粗粒化力场的粗粒化分子动力学模型，计算一个 Lennard-Jones 交叉相互作用势阱深度参数。该参数应能再现一个溶质珠粒在两种不同溶剂中插入时产生的预设溶剂化自由能差。\n\n您必须从第一性原理推导出一个易于处理的表达式，将交叉相互作用参数与插入的过剩化学势联系起来，然后实现计算和一个离散化步骤，该步骤需体现 MARTINI 力场中使用一小组相互作用强度的理念。\n\n使用以下符合上下文的基本原理：\n- 牛顿第二运动定律和势能的定义。\n- Lennard-Jones 势 $u_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\left(\\dfrac{\\sigma}{r}\\right)^{12} - \\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right]$, 其中 $\\epsilon$ 是势阱深度，$\\sigma$ 是尺寸参数。\n- 溶剂中溶质珠粒的过剩化学势的 Widom 插入公式 $\\mu_{\\mathrm{ex}} = -k_{\\mathrm{B}} T \\ln \\left\\langle \\exp\\left(-\\dfrac{\\Delta U}{k_{\\mathrm{B}} T}\\right)\\right\\rangle$，以及在平均场、低密度涨落条件下的近似，即主要贡献来自于对势的吸引尾部对溶剂数密度和对相关函数进行积分。\n- 在没有基质特异性校准的情况下，交叉相互作用势阱深度的 Lorentz-Berthelot 混合法则基线为 $\\epsilon_{ij}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{jj}}$。\n\n假设溶剂是均匀的，数密度为 $\\rho$，并且对相关函数 $g(r)$ 在排斥核心最小值之外近似为 $1$。对于 $r \\ge r_{\\mathrm{m}}$（其中 $r_{\\mathrm{m}} = 2^{1/6}\\sigma$），用其吸引尾部 $u_{\\mathrm{attr}}(r)$ 替换全势，并积分至截断半径 $r_{\\mathrm{c}}$，以获得将珠粒 $i$ 插入溶剂 $j$ 的过剩化学势 $\\mu_{\\mathrm{ex}}^{i\\in j}$ 与交叉相互作用势阱深度 $\\epsilon_{ij}$ 之间的近似线性关系。使用此线性关系，将目标溶剂化自由能差 $\\Delta\\Delta G = \\mu_{\\mathrm{ex}}^{i\\in B} - \\mu_{\\mathrm{ex}}^{i\\in A}$ 用已知量表示，并求解所需的 $\\epsilon_{iB}$。\n\n在根据平均场表达式构建出连续的 $\\epsilon_{iB}$ 后，论证并应用以下任一方法：\n- 基于混合法则的缩放：将 $\\epsilon_{iB}$ 与 Lorentz-Berthelot 基线 $\\epsilon_{iB}^{\\mathrm{LB}}$ 进行比较，并报告缩放因子 $s = \\epsilon_{iB}/\\epsilon_{iB}^{\\mathrm{LB}}$，或\n- 矩阵查找：将 $\\epsilon_{iB}$ 取整到代表 MARTINI 粗粒化水平的离散集合中的最接近值，此处选择为 $\\{2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5\\}$，单位为 $\\mathrm{kJ/mol}$。\n\n您的程序必须：\n1. 计算溶质在溶剂 $A$ 中的 Lorentz-Berthelot 基线交叉相互作用 $\\epsilon_{iA}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{AA}}$，然后使用推导出的平均场表达式计算所需的连续 $\\epsilon_{iB}$，以匹配指定的 $\\Delta\\Delta G$。\n2. 计算溶剂 $B$ 的 Lorentz-Berthelot 基线 $\\epsilon_{iB}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{BB}}$ 和缩放因子 $s = \\epsilon_{iB}/\\epsilon_{iB}^{\\mathrm{LB}}$。\n3. 将 $\\epsilon_{iB}$ 离散化到集合 $\\{2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5\\}$（单位为 $\\mathrm{kJ/mol}$）中的最接近值，以获得 $\\epsilon_{iB}^{\\mathrm{disc}}$。\n4. 对于每个测试用例，输出一个包含三个浮点数 $[\\epsilon_{iB}, \\epsilon_{iB}^{\\mathrm{disc}}, s]$ 的列表，每个浮点数都四舍五入到三位小数，并使用指定的单位。\n\n所有能量以 $\\mathrm{kJ/mol}$ 表示，所有距离以 $\\mathrm{nm}$ 表示，所有数密度以 $\\mathrm{nm}^{-3}$ 表示。不使用角度。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，`[[x_1,y_1,z_1],[x_2,y_2,z_2]]`）。\n\n使用以下测试套件，它涵盖了正常路径、溶剂化自由能相等的情况、对珠粒身份和约束的敏感性、尺寸参数的影响，以及一个指示目标不一致并产生负连续势阱深度的边界情况：\n- 测试 $1$：($\\epsilon_{ii}=5.0, \\epsilon_{AA}=5.0, \\epsilon_{BB}=3.5, \\rho_A=8.5, \\rho_B=6.8, \\sigma=0.47, r_c=1.2, \\Delta\\Delta G=10.0$)。\n- 测试 $2$：($\\epsilon_{ii}=5.0, \\epsilon_{AA}=5.0, \\epsilon_{BB}=5.0, \\rho_A=8.0, \\rho_B=8.0, \\sigma=0.47, r_c=1.2, \\Delta\\Delta G=0.0$)。\n- 测试 $3$：($\\epsilon_{ii}=4.5, \\epsilon_{AA}=5.5, \\epsilon_{BB}=4.5, \\rho_A=8.5, \\rho_B=7.5, \\sigma=0.47, r_c=1.2, \\Delta\\Delta G=5.0$)。\n- 测试 $4$：($\\epsilon_{ii}=3.5, \\epsilon_{AA}=4.5, \\epsilon_{BB}=3.5, \\rho_A=7.0, \\rho_B=5.0, \\sigma=0.43, r_c=1.2, \\Delta\\Delta G=8.0$)。\n- 测试 $5$：($\\epsilon_{ii}=3.5, \\epsilon_{AA}=3.5, \\epsilon_{BB}=3.5, \\rho_A=3.0, \\rho_B=6.0, \\sigma=0.47, r_c=1.2, \\Delta\\Delta G=12.0$)。",
            "solution": "问题陈述具有科学依据、自洽且良定，可以进行严格的求解。它要求推导并实现一种方法，以确定溶剂 $B$ 中溶质珠粒 $i$ 的 Lennard-Jones (LJ) 相互作用参数 $\\epsilon_{iB}$，从而再现相对于参考溶剂 $A$ 的目标溶剂化自由能差 $\\Delta\\Delta G$。这是对像 MARTINI 这样的粗粒化力场进行参数化时的常见任务。其推导过程始于平均场近似下的 Widom 插入公式。\n\n问题陈述中关于参考溶剂中溶质的相互作用参数 $\\epsilon_{iA}$ 的值存在一个轻微的模糊之处。问题指示“计算溶质在溶剂 A 中的 Lorentz-Berthelot 基线交叉相互作用 $\\epsilon_{iA}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{AA}}$”，但并未明确说明在后续计算中应将此值用作 $\\epsilon_{iA}$。然而，在这类参数化过程中，建立基线相互作用是一个标准且必要的步骤。因此，最合乎逻辑且物理上合理的解释是假设 $\\epsilon_{iA} = \\epsilon_{iA}^{\\mathrm{LB}}$。有了这个假设，问题就完全确定了，可以按如下方式求解。\n\n将单个溶质粒子插入溶剂的过剩化学势 $\\mu_{\\mathrm{ex}}$ 由 Widom 插入公式给出：\n$$\n\\mu_{\\mathrm{ex}} = -k_{\\mathrm{B}} T \\ln \\left\\langle \\exp\\left(-\\dfrac{\\Delta U}{k_{\\mathrm{B}} T}\\right)\\right\\rangle\n$$\n其中 $\\Delta U$ 是溶质与所有溶剂粒子之间的相互作用能，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，尖括号表示对溶剂构型的系综平均。\n\n问题指定了一个平均场近似，其中 $\\mu_{\\mathrm{ex}}$ 的主要贡献来自于对溶剂积分的势能的吸引部分。这个近似等价于高温或弱耦合极限，此时 $\\mu_{\\mathrm{ex}} \\approx \\langle \\Delta U \\rangle$。对于数密度为 $\\rho_j$ 的溶剂 $j$ 中的溶质珠粒 $i$，其平均相互作用能 $\\langle \\Delta U \\rangle$ 为：\n$$\n\\langle \\Delta U \\rangle = \\int_V \\rho_j g_{ij}(r) u_{ij}(r) dV\n$$\n这里，$u_{ij}(r)$ 是对势，$g_{ij}(r)$ 是径向分布函数。问题提供了几个简化假设：\n1. 对相关函数 $g_{ij}(r) \\approx 1$，对于 $r$ 超出排斥核心的区域。\n2. 只考虑 Lennard-Jones 势的吸引部分：$u_{\\mathrm{attr}}(r) = -4\\epsilon_{ij}\\left(\\dfrac{\\sigma}{r}\\right)^{6}$。\n3. 积分从 LJ 势能最小值位置 $r_{\\mathrm{m}} = 2^{1/6}\\sigma$ 开始，直到截断距离 $r_{\\mathrm{c}}$。\n4. 假设所有相互作用的尺寸参数 $\\sigma$ 相同。\n\n基于这些假设，并使用球坐标系（其中 $dV = 4\\pi r^2 dr$），将溶质 $i$ 插入溶剂 $j$ 的过剩化学势变为：\n$$\n\\mu_{\\mathrm{ex}}^{i \\in j} \\approx \\int_{r_{\\mathrm{m}}}^{r_{\\mathrm{c}}} \\rho_j (1) \\left(-4\\epsilon_{ij}\\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right) 4\\pi r^2 dr\n$$\n$$\n\\mu_{\\mathrm{ex}}^{i \\in j} \\approx -16\\pi \\rho_j \\epsilon_{ij} \\sigma^6 \\int_{r_{\\mathrm{m}}}^{r_{\\mathrm{c}}} r^{-4} dr\n$$\n积分计算结果为：\n$$\n\\int_{r_{\\mathrm{m}}}^{r_{\\mathrm{c}}} r^{-4} dr = \\left[ \\frac{r^{-3}}{-3} \\right]_{r_{\\mathrm{m}}}^{r_{\\mathrm{c}}} = -\\frac{1}{3}\\left(\\frac{1}{r_{\\mathrm{c}}^3} - \\frac{1}{r_{\\mathrm{m}}^3}\\right) = \\frac{1}{3}\\left(\\frac{1}{r_{\\mathrmm}}^3} - \\frac{1}{r_{\\mathrm{c}}^3}\\right)\n$$\n代入 $r_{\\mathrm{m}}^3 = (2^{1/6}\\sigma)^3 = \\sqrt{2}\\sigma^3$：\n$$\n\\mu_{\\mathrm{ex}}^{i \\in j} \\approx -16\\pi \\rho_j \\epsilon_{ij} \\sigma^6 \\left[ \\frac{1}{3}\\left(\\frac{1}{\\sqrt{2}\\sigma^3} - \\frac{1}{r_{\\mathrm{c}}^3}\\right) \\right] = -\\frac{16\\pi}{3} \\rho_j \\epsilon_{ij} \\sigma^3 \\left(\\frac{1}{\\sqrt{2}} - \\frac{\\sigma^3}{r_{\\mathrm{c}}^3}\\right)\n$$\n这就建立了所需的线性关系 $\\mu_{\\mathrm{ex}}^{i \\in j} = K_j \\epsilon_{ij}$，其中系数 $K_j$ 取决于溶剂密度 $\\rho_j$ 和几何参数。我们定义一个仅依赖于几何形状的常数 $C$：\n$$\nC(\\sigma, r_{\\mathrm{c}}) = -\\frac{16\\pi}{3} \\sigma^3 \\left(\\frac{1}{\\sqrt{2}} - \\frac{\\sigma^3}{r_{\\mathrm{c}}^3}\\right)\n$$\n于是，$\\mu_{\\mathrm{ex}}^{i \\in j} = C(\\sigma, r_{\\mathrm{c}}) \\rho_j \\epsilon_{ij}$。\n\n目标量是溶剂化自由能差 $\\Delta\\Delta G = \\mu_{\\mathrm{ex}}^{i\\in B} - \\mu_{\\mathrm{ex}}^{i\\in A}$。代入线性表达式：\n$$\n\\Delta\\Delta G = C(\\sigma, r_{\\mathrm{c}}) \\rho_B \\epsilon_{iB} - C(\\sigma, r_{\\mathrm{c}}) \\rho_A \\epsilon_{iA}\n$$\n我们求解未知的势阱深度 $\\epsilon_{iB}$：\n$$\nC(\\sigma, r_{\\mathrm{c}}) \\rho_B \\epsilon_{iB} = \\Delta\\Delta G + C(\\sigma, r_{\\mathrm{c}}) \\rho_A \\epsilon_{iA}\n$$\n$$\n\\epsilon_{iB} = \\frac{\\Delta\\Delta G}{C(\\sigma, r_{\\mathrm{c}}) \\rho_B} + \\frac{\\rho_A}{\\rho_B} \\epsilon_{iA}\n$$\n根据我们的假设，即参考相互作用由 Lorentz-Berthelot 混合法则给出，我们设定 $\\epsilon_{iA} = \\epsilon_{iA}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{AA}}$。连续势阱深度的最终表达式为：\n$$\n\\epsilon_{iB} = \\frac{\\Delta\\Delta G}{C(\\sigma, r_{\\mathrm{c}}) \\rho_B} + \\frac{\\rho_A}{\\rho_B} \\sqrt{\\epsilon_{ii}\\epsilon_{AA}}\n$$\n\n得到 $\\epsilon_{iB}$ 的这个连续值后，我们执行剩余的计算步骤：\n1. 计算溶质-溶剂 B 相互作用的 Lorentz-Berthelot 基线：$\\epsilon_{iB}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{BB}}$。\n2. 计算缩放因子 $s = \\epsilon_{iB} / \\epsilon_{iB}^{\\mathrm{LB}}$。该因子量化了为匹配目标 $\\Delta\\Delta G$ 而需对简单混合法则进行的偏离程度。\n3. 将 $\\epsilon_{iB}$ 离散化，找到所提供的 MARTINI 风格相互作用能级集合 $S = \\{2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5\\}$ $\\mathrm{kJ/mol}$ 中的最接近值。这是通过找到集合 $S$ 中使绝对差 $|\\epsilon_{iB} - s_k|$ 最小化的值 $s_k$ 来完成的。此步骤反映了使用有限的相互作用强度组合以保持模型简洁性的粗粒化理念。\n\n最终的程序为每个提供的测试用例实现了这一系列计算。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a Lennard-Jones cross-interaction parameter for the MARTINI\n    coarse-grained force field to reproduce a given solvation free energy\n    difference, based on a mean-field approximation.\n    \"\"\"\n\n    # Test suite: (eps_ii, eps_AA, eps_BB, rho_A, rho_B, sigma, rc, delta_delta_G)\n    # Units: energy in kJ/mol, distance in nm, density in nm^-3.\n    test_cases = [\n        # Test 1: Happy path\n        (5.0, 5.0, 3.5, 8.5, 6.8, 0.47, 1.2, 10.0),\n        # Test 2: Zero dG, symmetric system\n        (5.0, 5.0, 5.0, 8.0, 8.0, 0.47, 1.2, 0.0),\n        # Test 3: Sensitivity to bead identity and dG target\n        (4.5, 5.5, 4.5, 8.5, 7.5, 0.47, 1.2, 5.0),\n        # Test 4: Influence of size parameter\n        (3.5, 4.5, 3.5, 7.0, 5.0, 0.43, 1.2, 8.0),\n        # Test 5: Edge case leading to unphysical (negative) epsilon\n        (3.5, 3.5, 3.5, 3.0, 6.0, 0.47, 1.2, 12.0),\n    ]\n\n    discretization_set = np.array([2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5])\n    \n    all_results = []\n    \n    for case in test_cases:\n        eps_ii, eps_AA, eps_BB, rho_A, rho_B, sigma, rc, delta_delta_G = case\n\n        # 1. Calculate the geometry-dependent constant C(sigma, rc)\n        sigma_3 = sigma**3\n        sigma_6 = sigma_3**2\n        rc_3 = rc**3\n        \n        # C(sigma, r_c) from the derived formula:\n        # C = -(16*pi/3) * sigma^3 * (1/sqrt(2) - sigma^3/rc^3)\n        C_const = -(16.0 * np.pi / 3.0) * sigma_3 * (1.0 / np.sqrt(2) - sigma_3 / rc_3)\n\n        # 2. Calculate eps_iA using the Lorentz-Berthelot rule (assumption)\n        eps_iA = np.sqrt(eps_ii * eps_AA)\n        \n        # 3. Compute the continuous value for eps_iB\n        # eps_iB = (delta_delta_G / (C * rho_B)) + (rho_A / rho_B) * eps_iA\n        \n        # Handle potential division by zero if rho_B is 0\n        if rho_B == 0:\n            # This case is physically unusual and not in tests, but good practice.\n            # If rho_B is 0, eps_iB would diverge unless delta_delta_G = -C*rho_A*eps_iA,\n            # which means mu_ex(B)=0 and mu_ex(A)=delta_delta_G.\n            # We'll treat this as an invalid scenario for this problem.\n            # For the given problem, rho_B is never zero.\n            pass\n\n        term1 = delta_delta_G / (C_const * rho_B)\n        term2 = (rho_A / rho_B) * eps_iA\n        eps_iB = term1 + term2\n\n        # 4. Compute Lorentz-Berthelot baseline for solvent B and scaling factor\n        eps_iB_LB = np.sqrt(eps_ii * eps_BB)\n        \n        # Handle division by zero for the scaling factor if eps_iB_LB is zero\n        scaling_factor = eps_iB / eps_iB_LB if eps_iB_LB != 0 else np.inf\n\n        # 5. Discretize eps_iB to the nearest value in the set\n        # Find the index of the value in discretization_set closest to eps_iB\n        idx = np.abs(discretization_set - eps_iB).argmin()\n        eps_iB_disc = discretization_set[idx]\n\n        # 6. Store the results for this case\n        all_results.append([eps_iB, eps_iB_disc, scaling_factor])\n\n    # 7. Format the output string as per requirements\n    # [[val1,val2,val3],[val4,val5,val6],...] with 3 decimal places\n    formatted_results = []\n    for res in all_results:\n        # res[0]=eps_iB, res[1]=eps_iB_disc, res[2]=scaling_factor\n        formatted_str = f\"[{res[0]:.3f},{res[1]:.3f},{res[2]:.3f}]\"\n        formatted_results.append(formatted_str)\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "粗粒度模型中平滑的能量势导致了被人为加速的动力学，这是其一个关键的后果。最后的这个练习将探讨如何将“粗粒度时间”与真实的物理时间对应起来。通过比较粗粒度和原子尺度模拟中的扩散系数，您将推导并应用一个时间换算因子，这是解释使用MARTINI研究的过程动力学的关键步骤。",
            "id": "3453040",
            "problem": "考虑一个溶质在分子动力学（MD）模拟的均相溶剂中扩散。在原子级别的模拟中，溶质的长时间扩散行为由随机动力学主导，该动力学可用 Langevin 方程的过阻尼极限来建模。其中，扩散系数 $D$ 通过爱因斯坦关系式与热能和有效摩擦系数 $\\zeta$ 相关联。MARTINI 粗粒化力场减少了自由度数量，并采用软化的相互作用势，这通常导致其测得的扩散系数与原子模拟相比有所不同。\n\n从第一性原理出发，即三维空间扩散的 Einstein–Smoluchowski 关系式以及扩散系数由摩擦系数和温度定义的公式，推导出一个启发式映射关系。该关系用于关联粗粒化 MARTINI 模拟中的时间 $t_{\\mathrm{CG}}$ 与相同溶质在相同温度 $T$ 下对应的物理（原子级别）时间 $t_{\\mathrm{AT}}$。该映射必须表示为一个无量纲的时间缩放因子 $s_t$，使得 $t_{\\mathrm{AT}} = s_t \\, t_{\\mathrm{CG}}$。你的推导必须：\n\n- 从三维空间中的均方位移（MSD）的定义，以及连接 MSD 与扩散系数的爱因斯坦关系式开始。\n- 使用广为接受的关系式 $D = k_B T / \\zeta$，该关系式在 Langevin 方程的过阻尼极限下，将扩散系数 $D$ 与热能 $k_B T$ 和有效摩擦系数 $\\zeta$ 联系起来。\n- 明确论证为何在相同温度下，将同一溶质在原子级别和粗粒化表示中的 MSD 相等，可以导出一个关于 $s_t$ 的公式。\n\n然后，实现一个程序，根据给定的相同溶质在相同温度下的原子级别和粗粒化扩散系数值，计算所提供测试集中每个案例的 $s_t$。在所有案例中，扩散系数的单位为 $\\mathrm{nm^2/ns}$，时间的单位为 $\\mathrm{ns}$，$s_t$ 是无量纲的。输出必须四舍五入到 $6$ 位小数。程序不应读取任何输入，且必须将测试集硬编码在代码中。\n\n除了计算 $s_t$ 之外，你的推导还必须讨论原子级别和 MARTINI 扩散系数之间差异的来源，包括但不限于有效摩擦的减小（溶剂自由度减少和流体动力学耦合的改变）和相互作用势的软化（更低的能垒和更平滑的能量形貌）。你的解释必须证明为什么这些效应会导致 $D$ 的差异，从而需要进行时间缩放。\n\n使用以下测试集，其中每个案例指定了在相同温度 $T$ 下的 $(D_{\\mathrm{AT}}, D_{\\mathrm{CG}})$，单位为 $\\mathrm{nm^2/ns}$：\n\n- 案例 $1$：$D_{\\mathrm{AT}} = 0.25\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 1.00\\, \\mathrm{nm^2/ns}$。\n- 案例 $2$：$D_{\\mathrm{AT}} = 0.05\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 0.15\\, \\mathrm{nm^2/ns}$。\n- 案例 $3$：$D_{\\mathrm{AT}} = 0.01\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 0.012\\, \\mathrm{nm^2/ns}$。\n- 案例 $4$：$D_{\\mathrm{AT}} = 0.20\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 0.20\\, \\mathrm{nm^2/ns}$。\n- 案例 $5$：$D_{\\mathrm{AT}} = 0.30\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 0.24\\, \\mathrm{nm^2/ns}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4,result_5]$），其中每个 $result_i$ 是为案例 $i$ 计算的 $s_t$，四舍五入到 $6$ 位小数，并表示为无量纲浮点数。",
            "solution": "所陈述的问题具有科学依据、提法明确，并包含了完整解答所需的所有信息。因此，我将进行推导和实现。\n\n主要目标是推导一个启发式的时间缩放因子 $s_t$，该因子将粗粒化（CG）模拟的时间演化 $t_{\\mathrm{CG}}$ 映射到其对应的物理时间 $t_{\\mathrm{AT}}$，后者由全原子（AT）模拟表示。该关系式为 $t_{\\mathrm{AT}} = s_t \\, t_{\\mathrm{CG}}$。此映射至关重要，因为在像 MARTINI 这样的粗粒化模型中，平滑的相互作用和减少的自由度通常会相对于物理现实加速系统动力学。\n\n推导始于 Einstein–Smoluchowski 关系式，该关系式描述了粒子的扩散运动。在三维空间（$d=3$）中，粒子的均方位移（MSD）与时间间隔 $t$ 和扩散系数 $D$ 成线性比例：\n$$\n\\mathrm{MSD}(t) = \\langle |\\mathbf{r}(t) - \\mathbf{r}(0)|^2 \\rangle = 6Dt\n$$\n此处，$\\mathbf{r}(t)$ 是粒子在时间 $t$ 的位置矢量，尖括号 $\\langle \\cdot \\rangle$ 表示系综平均。\n\n该关系对原子级别和粗粒化表示均成立。我们将原子模拟中的扩散系数和时间分别表示为 $D_{\\mathrm{AT}}$ 和 $t_{\\mathrm{AT}}$。则 MSD 为：\n$$\n\\mathrm{MSD}_{\\mathrm{AT}}(t_{\\mathrm{AT}}) = 6 D_{\\mathrm{AT}} t_{\\mathrm{AT}}\n$$\n同样地，对于粗粒化模拟，其扩散系数为 $D_{\\mathrm{CG}}$，模拟时间为 $t_{\\mathrm{CG}}$，则 MSD 为：\n$$\n\\mathrm{MSD}_{\\mathrm{CG}}(t_{\\mathrm{CG}}) = 6 D_{\\mathrm{CG}} t_{\\mathrm{CG}}\n$$\n建立时间映射的基本假设是，无论使用何种模拟方法建模，溶质的物理位移必须相同。这意味着我们必须将溶质在原子级别表示中经过物理时间 $t_{\\mathrm{AT}}$ 的 MSD 与其在粗粒化表示中经过相应模拟时间 $t_{\\mathrm{CG}}$ 的 MSD 相等。这确保了长时间扩散行为在这两种理论层次之间是守恒的。\n$$\n\\mathrm{MSD}_{\\mathrm{AT}}(t_{\\mathrm{AT}}) = \\mathrm{MSD}_{\\mathrm{CG}}(t_{\\mathrm{CG}})\n$$\n代入 MSD 的表达式，我们得到：\n$$\n6 D_{\\mathrm{AT}} t_{\\mathrm{AT}} = 6 D_{\\mathrm{CG}} t_{\\mathrm{CG}}\n$$\n$6$ 这个因子被消掉，从而得到时间与扩散系数之间的直接关系：\n$$\nD_{\\mathrm{AT}} t_{\\mathrm{AT}} = D_{\\mathrm{CG}} t_{\\mathrm{CG}}\n$$\n求解 $t_{\\mathrm{AT}}$ 得到从粗粒化时间到原子时间的映射：\n$$\nt_{\\mathrm{AT}} = \\left( \\frac{D_{\\mathrm{CG}}}{D_{\\mathrm{AT}}} \\right) t_{\\mathrm{CG}}\n$$\n通过将此结果与给定定义 $t_{\\mathrm{AT}} = s_t \\, t_{\\mathrm{CG}}$ 进行比较，我们可以确定无量纲时间缩放因子 $s_t$ 为：\n$$\ns_t = \\frac{D_{\\mathrm{CG}}}{D_{\\mathrm{AT}}}\n$$\n这个推导出的公式允许我们根据实验或计算测得的相同溶质在相同温度 $T$ 下的扩散系数直接计算 $s_t$。\n\n这种时间缩放的必要性源于原子级别模型和粗粒化模型之间的根本差异。问题陈述了扩散系数 $D$、热能 $k_B T$ 和有效摩擦系数 $\\zeta$ 之间的关系为 $D = k_B T / \\zeta$。由于在不同模拟中温度 $T$ 保持恒定，扩散系数之比与摩擦系数之比成反比：\n$$\ns_t = \\frac{D_{\\mathrm{CG}}}{D_{\\mathrm{AT}}} = \\frac{k_B T / \\zeta_{\\mathrm{CG}}}{k_B T / \\zeta_{\\mathrm{AT}}} = \\frac{\\zeta_{\\mathrm{AT}}}{\\zeta_{\\mathrm{CG}}}\n$$\n在 MARTINI 模拟中，$D_{\\mathrm{CG}}$ 通常大于 $D_{\\mathrm{AT}}$，这意味着 $s_t > 1$。这反过来又说明，在粗粒化模型中溶质所经历的有效摩擦 $\\zeta_{\\mathrm{CG}}$ 低于原子模型中的有效摩擦 $\\zeta_{\\mathrm{AT}}$。这种摩擦减小的主要来源是：\n\n1.  **自由度减少和更平滑的能量形貌**：MARTINI 将多个原子（通常是 4 个重原子）平均化，形成一个粗粒化珠子。这个过程消除了键振动和角弯曲等高频运动。此外，与原子力场中尖锐的势相比，粗粒化珠子之间的相互作用由软化势（例如，平移的 Lennard-Jones 势）描述。这创造了一个更平滑的势能面。在分子水平上，摩擦源于粒子在穿过由其邻居构成的“崎岖”能量形貌时所感受到的阻力。一个更平滑的形貌提供了更低的运动能垒，从而导致更小的阻力，因此有效摩擦系数 $\\zeta_{\\mathrm{CG}}$ 也更低。\n\n2.  **溶剂摩擦减小和流体动力学改变**：摩擦的一个重要来源是与溶剂分子的碰撞。在 MARTINI 模型中，溶剂（例如水）也是粗粒化的，一个粗粒化珠子代表四个水分子。溶剂粒子数量的急剧减少导致单位时间内溶质-溶剂碰撞次数减少，直接降低了摩擦的碰撞分量。这种简化也改变了溶剂的集体行为，导致粗粒化溶剂的粘度远低于真实水。较低的粘度意味着流体动力学阻力减小，进一步导致了 $\\zeta_{\\mathrm{CG}}  \\zeta_{\\mathrm{AT}}$。\n\n总而言之，MARTINI 中人为的快速动力学（$D_{\\mathrm{CG}} > D_{\\mathrm{AT}}$）是粗粒化过程中固有的更平滑的能量面和减小的摩擦的直接结果。时间缩放因子 $s_t$ 作为一个关键的修正，将加速的模拟时间映射回具有物理意义的时间尺度。\n\n下面的程序将为提供的测试案例计算 $s_t = D_{\\mathrm{CG}} / D_{\\mathrm{AT}}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless time scaling factor s_t for coarse-grained simulations\n    based on atomistic and coarse-grained diffusion coefficients.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains (D_AT, D_CG) in nm^2/ns.\n    test_cases = [\n        (0.25, 1.00),  # Case 1\n        (0.05, 0.15),  # Case 2\n        (0.01, 0.012), # Case 3\n        (0.20, 0.20),  # Case 4\n        (0.30, 0.24),  # Case 5\n    ]\n\n    results = []\n    for D_AT, D_CG in test_cases:\n        # The derivation shows that the time scaling factor s_t is the ratio\n        # of the coarse-grained diffusion coefficient to the atomistic one.\n        # s_t = D_CG / D_AT\n        \n        # Ensure D_AT is not zero to prevent division by zero errors,\n        # which is a physically sound check.\n        if D_AT == 0:\n            # A zero atomistic diffusion coefficient is physically unrealistic\n            # for a diffusing solute and would imply an infinite scaling factor.\n            # We can represent this as NaN or handle it as an error.\n            # For this problem, we assume D_AT > 0.\n            s_t = np.nan\n        else:\n            s_t = D_CG / D_AT\n        \n        results.append(s_t)\n\n    # Format the results to 6 decimal places and create the final output string.\n    # The map(lambda r: f\"{r:.6f}\", results) ensures each number is a string\n    # with the required precision.\n    output_string = f\"[{','.join(map(lambda r: f'{r:.6f}', results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}