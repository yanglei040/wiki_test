{
    "hands_on_practices": [
        {
            "introduction": "要掌握恒定pH值分子动力学技术，我们首先必须理解其底层的统计力学原理。这项实践是该技术理论基石的推导，它将用于描述可交换粒子的开放系统的半巨正则系综与质子化状态变化的模拟联系起来。通过完成这个推导练习，您将深刻理解外部pH环境如何直接影响可滴定残基的自由能形貌和平衡概率，这是恒定pH值模拟方法的核心机制。",
            "id": "3404536",
            "problem": "溶质中的单个可滴定基团发生单分子去质子化反应 $\\mathrm{AH} \\rightleftharpoons \\mathrm{A}^{-} + \\mathrm{H}^{+}$。在恒定氢离子电势 (pH) 的分子动力学 (MD) 模拟中，质子与一个储备池的交换使用半巨正则 (SGC) 系综进行建模，在该系综中，对于因结合的质子数不同而异的状态，其相应的热力学势是半巨势。假设质子为理想溶液，因此氢离子活度为 $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}}$。储备池中质子的化学势为 $\\mu_{\\mathrm{H}^{+}} = \\mu_{\\mathrm{H}^{+}}^{\\circ} + R T \\ln a_{\\mathrm{H}^{+}}$，其中 $R$ 是摩尔气体常数， $T$ 是绝对温度。标准去质子化自由能 $\\Delta G^{\\circ}$ 定义为单位氢离子活度 ($a_{\\mathrm{H}^{+}} = 1$) 下的反应自由能。\n\n仅从上述定义（化学势、玻尔兹曼权重和理想活度）出发，且不假设任何目标公式，完成以下任务：\n\n1. 推导去质子化态 $\\mathrm{A}^{-}$ 和质子化态 $\\mathrm{AH}$ 之间的半巨势差 $\\Delta G_{\\mathrm{sg}}$，作为 $\\Delta G^{\\circ}$、$R$、$T$ 和 $\\mathrm{pH}$ 的显式函数。清晰地说明你使用的任何系综或统计假设。使用摩尔逆热能 $\\beta \\equiv \\frac{1}{R T}$。\n\n2. 使用第1部分的结果，推导在温度 $T$ 下由 SGC 玻尔兹曼权重所隐含的概率比 $\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})}$，并展示该比率如何依赖于 $\\Delta G^{\\circ}$ 和 $\\mathrm{pH}$。\n\n最后，对以下具体情况进行数值计算该比率：\n- $T = 298.15 \\,\\mathrm{K}$,\n- $\\mathrm{pH} = 7.000$,\n- $\\Delta G^{\\circ} = 6.000\\, R T \\ln 10$。\n\n将最终的概率比 $\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})}$ 以无单位的纯数形式报告，并四舍五入到三位有效数字。不要报告任何中间量作为你的最终答案。",
            "solution": "该问题已经过验证，被认为是物理化学和统计力学中一个定义明确且科学合理的问题。\n\n此问题要求推导恒定 pH 分子动力学模拟中可滴定基团的热力学和统计力学性质。推导将按要求分三部分进行。\n\n**第1部分：半巨势差 $\\Delta G_{\\mathrm{sg}}$ 的推导**\n\n该系统由一个具有单个可滴定基团的溶质组成，该基团可以以质子化态 $\\mathrm{AH}$ 或去质子化态 $\\mathrm{A}^{-}$ 存在。模拟在恒定温度 $T$ 和压力 $P$ 的半巨正则 (SGC) 系综中进行，其中系统可以与一个具有固定化学势 $\\mu_{\\mathrm{H}^{+}}$ 的储备池交换质子。\n\n在此系综中，状态 $i$ 的热力学势是半巨势 $G_{\\mathrm{sg},i}$，定义为：\n$$G_{\\mathrm{sg},i} = G_i - N_i \\mu_{\\mathrm{H}^{+}}$$\n其中 $G_i$ 是系统在状态 $i$ 下的吉布斯自由能，$N_i$ 是在该状态下与可滴定基团结合的质子数。\n\n让我们定义系统的两个状态：\n1.  质子化态 $\\mathrm{AH}$。溶质处于此状态时，系统的吉布斯自由能为 $G_{\\mathrm{AH}}$。结合的质子数为 $N_{\\mathrm{AH}} = 1$。\n2.  去质子化态 $\\mathrm{A}^{-}$。溶质处于此状态时，系统的吉布斯自由能为 $G_{\\mathrm{A}^{-}}$。结合的质子数为 $N_{\\mathrm{A}^{-}} = 0$。\n\n这两个状态的半巨势为：\n$$G_{\\mathrm{sg}}(\\mathrm{AH}) = G_{\\mathrm{AH}} - (1) \\mu_{\\mathrm{H}^{+}} = G_{\\mathrm{AH}} - \\mu_{\\mathrm{H}^{+}}$$\n$$G_{\\mathrm{sg}}(\\mathrm{A}^{-}) = G_{\\mathrm{A}^{-}} - (0) \\mu_{\\mathrm{H}^{+}} = G_{\\mathrm{A}^{-}}$$\n\n问题要求去质子化态 $\\mathrm{A}^{-}$ 和质子化态 $\\mathrm{AH}$ 之间的半巨势差 $\\Delta G_{\\mathrm{sg}}$：\n$$\\Delta G_{\\mathrm{sg}} = G_{\\mathrm{sg}}(\\mathrm{A}^{-}) - G_{\\mathrm{sg}}(\\mathrm{AH}) = G_{\\mathrm{A}^{-}} - (G_{\\mathrm{AH}} - \\mu_{\\mathrm{H}^{+}}) = (G_{\\mathrm{A}^{-}} - G_{\\mathrm{AH}}) + \\mu_{\\mathrm{H}^{+}}$$\n\n项 $(G_{\\mathrm{A}^{-}} - G_{\\mathrm{AH}})$ 代表在溶液中使该基团去质子化的内禀吉布斯自由能变化，我们可将其表示为 $\\Delta G_{\\mathrm{deprot, intrinsic}}$。因此，\n$$\\Delta G_{\\mathrm{sg}} = \\Delta G_{\\mathrm{deprot, intrinsic}} + \\mu_{\\mathrm{H}^{+}}$$\n\n接下来，我们必须将 $\\Delta G_{\\mathrm{deprot, intrinsic}}$ 与标准去质子化自由能 $\\Delta G^{\\circ}$ 联系起来。问题指出，$\\Delta G^{\\circ}$ 是在单位氢离子活度 ($a_{\\mathrm{H}^{+}} = 1$) 下反应 $\\mathrm{AH} \\rightleftharpoons \\mathrm{A}^{-} + \\mathrm{H}^{+}$ 的反应自由能。在任何条件下，反应自由能是产物的自由能之和减去反应物的自由能。对于这个非均相反应（溶质去质子化，质子进入储备池），这恰好是 $\\Delta G_{\\mathrm{sg}}$。\n\n一个更正式的方法是基于标准化学势来定义 $\\Delta G^{\\circ}$。反应自由能为：\n$$\\Delta G_{\\mathrm{rxn}} = (\\mu_{\\mathrm{A}^{-}} + \\mu_{\\mathrm{H}^{+}}) - \\mu_{\\mathrm{AH}}$$\n标准自由能变化 $\\Delta G^{\\circ}$ 为：\n$$\\Delta G^{\\circ} = (\\mu_{\\mathrm{A}^{-}}^{\\circ} + \\mu_{\\mathrm{H}^{+}}^{\\circ}) - \\mu_{\\mathrm{AH}}^{\\circ}$$\n其中 $\\mu^{\\circ}$ 表示标准化学势。内禀自由能差 $(G_{\\mathrm{A}^{-}} - G_{\\mathrm{AH}})$ 对应于两种溶质形式的标准化学势之差 $(\\mu_{\\mathrm{A}^{-}}^{\\circ} - \\mu_{\\mathrm{AH}}^{\\circ})$。\n从 $\\Delta G^{\\circ}$ 的定义，我们可以写出：\n$$\\mu_{\\mathrm{A}^{-}}^{\\circ} - \\mu_{\\mathrm{AH}}^{\\circ} = \\Delta G^{\\circ} - \\mu_{\\mathrm{H}^{+}}^{\\circ}$$\n所以，$\\Delta G_{\\mathrm{deprot, intrinsic}} = G_{\\mathrm{A}^{-}} - G_{\\mathrm{AH}} = \\Delta G^{\\circ} - \\mu_{\\mathrm{H}^{+}}^{\\circ}$。\n\n将此代入我们关于 $\\Delta G_{\\mathrm{sg}}$ 的表达式中：\n$$\\Delta G_{\\mathrm{sg}} = (\\Delta G^{\\circ} - \\mu_{\\mathrm{H}^{+}}^{\\circ}) + \\mu_{\\mathrm{H}^{+}} = \\Delta G^{\\circ} + (\\mu_{\\mathrm{H}^{+}} - \\mu_{\\mathrm{H}^{+}}^{\\circ})$$\n问题提供了储备池中质子化学势的表达式：\n$$\\mu_{\\mathrm{H}^{+}} = \\mu_{\\mathrm{H}^{+}}^{\\circ} + R T \\ln a_{\\mathrm{H}^{+}}$$\n因此，差值 $(\\mu_{\\mathrm{H}^{+}} - \\mu_{\\mathrm{H}^{+}}^{\\circ})$ 是 $R T \\ln a_{\\mathrm{H}^{+}}$。\n代入后得到：\n$$\\Delta G_{\\mathrm{sg}} = \\Delta G^{\\circ} + R T \\ln a_{\\mathrm{H}^{+}}$$\n我们已知 $a_{\\mathrm{H}^{+}} = 10^{-\\mathrm{pH}}$。利用对数性质 $\\ln(x^y) = y \\ln x$：\n$$\\ln a_{\\mathrm{H}^{+}} = \\ln(10^{-\\mathrm{pH}}) = -\\mathrm{pH} \\ln 10$$\n将此代入 $\\Delta G_{\\mathrm{sg}}$ 的表达式，得到第1部分的最终结果：\n$$\\Delta G_{\\mathrm{sg}} = \\Delta G^{\\circ} - R T \\cdot \\mathrm{pH} \\ln 10$$\n使用摩尔逆热能 $\\beta \\equiv \\frac{1}{R T}$，这可以写成：\n$$\\Delta G_{\\mathrm{sg}} = \\Delta G^{\\circ} - \\frac{1}{\\beta} \\mathrm{pH} \\ln 10$$\n\n**第2部分：概率比 $\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})}$ 的推导**\n\n在 SGC 系综中，系统处于具有半巨势 $G_{\\mathrm{sg},i}$ 的状态 $i$ 的概率 $P_i$ 由玻尔兹曼权重给出：\n$$P_i \\propto \\exp(-\\beta G_{\\mathrm{sg},i})$$\n其中 $\\beta = \\frac{1}{R T}$ 是摩尔逆热能。\n\n去质子化态和质子化态的概率分别为：\n$$P(\\mathrm{A}^{-}) \\propto \\exp(-\\beta G_{\\mathrm{sg}}(\\mathrm{A}^{-}))$$\n$$P(\\mathrm{AH}) \\propto \\exp(-\\beta G_{\\mathrm{sg}}(\\mathrm{AH}))$$\n\n这些概率的比值为：\n$$\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})} = \\frac{\\exp(-\\beta G_{\\mathrm{sg}}(\\mathrm{A}^{-}))}{\\exp(-\\beta G_{\\mathrm{sg}}(\\mathrm{AH}))} = \\exp[-\\beta (G_{\\mathrm{sg}}(\\mathrm{A}^{-}) - G_{\\mathrm{sg}}(\\mathrm{AH}))]$$\n指数中的项是在第1部分中推导出的半巨势差 $\\Delta G_{\\mathrm{sg}}$。\n$$\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})} = \\exp(-\\beta \\Delta G_{\\mathrm{sg}})$$\n代入 $\\Delta G_{\\mathrm{sg}}$ 的表达式：\n$$\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})} = \\exp(-\\beta (\\Delta G^{\\circ} - R T \\cdot \\mathrm{pH} \\ln 10))$$\n展开指数：\n$$\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})} = \\exp(-\\beta \\Delta G^{\\circ} + \\beta R T \\cdot \\mathrm{pH} \\ln 10)$$\n因为 $\\beta R T = (\\frac{1}{R T}) R T = 1$，表达式简化为：\n$$\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})} = \\exp(-\\beta \\Delta G^{\\circ} + \\mathrm{pH} \\ln 10)$$\n此表达式给出了概率比作为 $\\Delta G^{\\circ}$ 和 $\\mathrm{pH}$ 的函数，符合要求。\n\n**第3部分：数值计算**\n\n我们被要求对以下具体情况计算概率比：\n- $T = 298.15 \\,\\mathrm{K}$\n- $\\mathrm{pH} = 7.000$\n- $\\Delta G^{\\circ} = 6.000\\, R T \\ln 10$\n\n我们使用在第2部分推导的公式：\n$$\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})} = \\exp(-\\beta \\Delta G^{\\circ} + \\mathrm{pH} \\ln 10)$$\n首先，让我们计算项 $-\\beta \\Delta G^{\\circ}$：\n$$-\\beta \\Delta G^{\\circ} = -\\frac{1}{R T} (6.000\\, R T \\ln 10) = -6.000 \\ln 10$$\n现在，将此结果和 $\\mathrm{pH}$ 的值代入指数中：\n$$\\text{Exponent} = -6.000 \\ln 10 + 7.000 \\ln 10$$\n$$\\text{Exponent} = (7.000 - 6.000) \\ln 10 = 1.000 \\ln 10$$\n现在我们计算这个比率：\n$$\\frac{P(\\mathrm{A}^{-})}{P(\\mathrm{AH})} = \\exp(1.000 \\ln 10) = \\exp(\\ln(10^{1.000})) = 10^{1.000} = 10.00$$\n问题要求最终答案四舍五入到三位有效数字。值 $10.00$ 有四位有效数字。将其四舍五入到三位有效数字得到 $10.0$。\n这个结果与Henderson-Hasselbalch方程一致。给定的 $\\Delta G^{\\circ}$ 对应一个 $\\mathrm{p}K_{\\mathrm{a}}$ 值，因为 $\\Delta G^{\\circ} = -R T \\ln K_a = R T \\ln(10) \\cdot \\mathrm{p}K_a$。将其与 $\\Delta G^{\\circ} = 6.000 R T \\ln 10$ 比较，我们发现 $\\mathrm{p}K_a = 6.000$。那么该比率由 $10^{\\mathrm{pH}-\\mathrm{p}K_a} = 10^{7.000 - 6.000} = 10^{1.000} = 10.00$ 给出。四舍五入到三位有效数字，结果是 $10.0$。",
            "answer": "$$\n\\boxed{10.0}\n$$"
        },
        {
            "introduction": "从理想理论转向实际模拟后，我们必须考虑计算方法本身引入的人为效应。这项练习探讨了在周期性边界条件下，当系统净电荷发生变化时产生的一个重要问题：有限尺寸效应。计算这种人为效应的量级及其对$pK_a$等关键可观测量造成的影响，为我们提供了关于模拟设置和数据解读的重要一课，强调了理解并校正系统误差的必要性。",
            "id": "3404560",
            "problem": "在一次使用粒子网格埃瓦尔德（PME; Particle Mesh Ewald）静电学方法和导电边界条件的恒定pH分子动力学（MD）模拟中，考虑一个去质子化/质子化步骤。此步骤在一个边长为 $L = 6\\,\\mathrm{nm}$、温度为 $T = 298\\,\\mathrm{K}$ 的周期性复制、含显式水分子的立方模拟单元中，使溶质的净电荷改变了 $\\Delta q = +1\\,e$。假设计算得到的充电自由能中的主要有限尺寸效应源于净电荷与其周期性镜像以及均匀中和背景之间的相互作用，并且可以忽略更高阶的多极矩贡献。周期性格林函数表明，在点电荷位置由其周期性镜像和中和背景产生的静电势，与 $1/L$ 成正比，比例系数为一个与几何形状相关的无量纲常数。对于简单立方晶格，此常数为 $\\xi = 2.837297$。将溶剂视为均匀电介质，其相对介电常数为 $\\varepsilon_{r} = 78.5$（液态水在 $T=298\\,\\mathrm{K}$ 时的值）。使用分子动力学单位制下的库仑常数 $k_{\\mathrm{e}} = 138.935456\\,\\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$、普适气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 以及 $\\ln 10 = 2.302585093$。\n\n仅从基本静电学和热力学出发，即在线性介质中将电荷从 $0$ 充到 $q$ 所做的功为 $W = \\int_{0}^{q} \\phi(q^{\\prime})\\,\\mathrm{d}q^{\\prime}$（其中 $\\phi$ 是充电位置的静电势），且标准反应自由能满足 $\\Delta G = - R T \\ln K$（其中 $pK = -\\log_{10} K$），完成以下任务：\n\n1. 推导镜像相互作用对充电自由能误差贡献的标度形式，并用其估算在给定 $\\Delta q$ 和 $L$ 条件下，有限尺寸修正的大小 $\\lvert \\Delta G_{\\mathrm{fs}} \\rvert$。\n2. 将此 $\\lvert \\Delta G_{\\mathrm{fs}} \\rvert$ 转换为在 $T=298\\,\\mathrm{K}$ 时，推断出的酸解离常数的相应绝对偏移 $\\lvert \\Delta \\mathrm{p}K_{\\mathrm{a}} \\rvert$。\n\n按顺序报告两个值：首先是自由能修正的大小 $\\lvert \\Delta G_{\\mathrm{fs}} \\rvert$（单位为 $\\mathrm{kJ\\,mol^{-1}}$），其次是偏移的大小 $\\lvert \\Delta \\mathrm{p}K_{\\mathrm{a}} \\rvert$（无量纲）。将两个值都四舍五入到两位有效数字。最终能量以 $\\mathrm{kJ\\,mol^{-1}}$ 单位表示，最终的 $\\mathrm{p}K_{\\mathrm{a}}$ 偏移以纯数表示。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 第1步：提取已知条件\n- **模拟方法：** 在导电边界条件下，使用粒子网格埃瓦尔德 (PME) 静电学方法的恒定pH分子动力学 (MD) 模拟。\n- **系统：** 周期性复制的、显式水分子的立方模拟单元。\n- **单元尺寸：** 边长 $L = 6\\,\\mathrm{nm}$。\n- **热力学状态：** 温度 $T = 298\\,\\mathrm{K}$。\n- **过程：** 一个去质子化/质子化步骤。\n- **电荷变化：** $\\Delta q = +1\\,e$。\n- **误差来源：** 由净电荷与其周期性镜像和均匀中和背景相互作用引起的有限尺寸效应。\n- **近似：** 忽略更高阶的多极矩贡献。\n- **静电势标度关系：** 在点电荷位置，由其周期性镜像和背景产生的电势形式包含一个适用于简单立方晶格的无量纲常数 $\\xi = 2.837297$。\n- **溶剂介电性质：** 相对介电常数 $\\varepsilon_{r} = 78.5$。\n- **常数：**\n    - 库仑常数：$k_{\\mathrm{e}} = 138.935456\\,\\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$。\n    - 普适气体常数：$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n    - 对数底数转换：$\\ln 10 = 2.302585093$。\n- **控制方程：**\n    - 充电功：$W = \\int_{0}^{q} \\phi(q^{\\prime})\\,\\mathrm{d}q^{\\prime}$。\n    - 反应自由能：$\\Delta G = - R T \\ln K$。\n    - 酸解离常数定义：$\\mathrm{p}K = -\\log_{10} K$。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于应用于分子模拟的既定统计力学和静电学原理。周期性边界条件下带电体系的有限尺寸修正是计算化学和生物物理学中一个被充分研究的课题。所提到的修正的具体形式与 Makov-Payne 修正相关，这是该领域的标准结果。所有物理原理和常数都是标准的。\n- **适定性：** 该问题提供了计算所求量所需的所有必要数据和关系。关于分子初始电荷状态的模糊性，可以通过在最常见和最简单的情况（从中性态开始或滴定至中性态）的背景下解释该问题来解决，所提供的充电功公式和对唯一答案的需求强烈暗示了这一点。\n- **客观性：** 该问题以精确、客观和定量的方式陈述。\n\n### 第3步：结论与行动\n在合理和标准的解释下，该问题在科学上是合理的、自洽的且适定的。它被判定为**有效**。将提供解答。\n\n### 解答推导\n\n该问题需要进行两部分的计算：首先是有限尺寸自由能效应的大小 $\\lvert \\Delta G_{\\mathrm{fs}} \\rvert$，其次是酸解离常数的相应偏移 $\\lvert \\Delta \\mathrm{p}K_{\\mathrm{a}} \\rvert$。\n\n**第1部分：有限尺寸自由能修正 $\\lvert \\Delta G_{\\mathrm{fs}} \\rvert$**\n\n对于一个在边长为 $L$、介电常数为 $\\varepsilon_{r}$、且具有导电边界条件的周期性立方单元中的单个点电荷 $q$，其静电能中的有限尺寸效应等于将该粒子从 $0$ 充电到 $q$ 时，抵抗由其自身的周期性镜像和中和背景所产生的电势而做的功。\n\n在一个电荷 $q'$ 的位置，由其镜像和背景产生的电势记为 $\\phi_{\\mathrm{img}}(q')$。根据所提供的标度定律和基本静电学，该电势为：\n$$\n\\phi_{\\mathrm{img}}(q') = \\frac{k_{\\mathrm{e}} \\xi q'}{\\varepsilon_{r} L}\n$$\n这里，电荷 $q'$ 的单位是基本电荷 $e$。\n\n创建电荷 $q$ 所做的功，即对应于周期性设置下其静电自能的贡献 $G_{\\mathrm{fs}}(q)$，可以通过对电势进行积分得到，根据给定的公式：\n$$\nG_{\\mathrm{fs}}(q) = W(q) = \\int_{0}^{q} \\phi_{\\mathrm{img}}(q') \\, \\mathrm{d}q' = \\int_{0}^{q} \\frac{k_{\\mathrm{e}} \\xi q'}{\\varepsilon_{r} L} \\, \\mathrm{d}q' = \\frac{k_{\\mathrm{e}} \\xi}{2 \\varepsilon_{r} L} q^2\n$$\n化学反应（例如质子化/去质子化事件）会使溶质的电荷从初始状态 $q_{\\mathrm{i}}$ 变为最终状态 $q_{\\mathrm{f}}$。自由能效应的变化是最终状态和初始状态自能之差：\n$$\n\\Delta G_{\\mathrm{fs}} = G_{\\mathrm{fs}}(q_{\\mathrm{f}}) - G_{\\mathrm{fs}}(q_{\\mathrm{i}}) = \\frac{k_{\\mathrm{e}} \\xi}{2 \\varepsilon_{r} L} (q_{\\mathrm{f}}^2 - q_{\\mathrm{i}}^2)\n$$\n问题指明电荷变化为 $\\Delta q = q_{\\mathrm{f}} - q_{\\mathrm{i}} = +1\\,e$。$\\Delta G_{\\mathrm{fs}}$ 的表达式可以改写为：\n$$\n\\Delta G_{\\mathrm{fs}} = \\frac{k_{\\mathrm{e}} \\xi}{2 \\varepsilon_{r} L} (q_{\\mathrm{f}} - q_{\\mathrm{i}})(q_{\\mathrm{f}} + q_{\\mathrm{i}}) = \\frac{k_{\\mathrm{e}} \\xi}{2 \\varepsilon_{r} L} \\Delta q (2q_{\\mathrm{i}} + \\Delta q)\n$$\n该表达式依赖于初始电荷 $q_{\\mathrm{i}}$。为了使问题有唯一解，必须假设一个特定的反应。最常见的质子化/去质子化事件涉及中性物种，即 $q_{\\mathrm{i}}=0$ 或 $q_{\\mathrm{f}}=0$。\n情况1：中性物种的质子化。$q_{\\mathrm{i}}=0$，$q_{\\mathrm{f}}=+1\\,e$。$\\Delta q = +1\\,e$。\n$$\n\\Delta G_{\\mathrm{fs}} = \\frac{k_{\\mathrm{e}} \\xi}{2 \\varepsilon_{r} L} ((+1)^2 - 0^2) = \\frac{k_{\\mathrm{e}} \\xi}{2 \\varepsilon_{r} L}\n$$\n情况2：去质子化为中性物种。$q_{\\mathrm{i}}=-1\\,e$，$q_{\\mathrm{f}}=0$。$\\Delta q = +1\\,e$。\n$$\n\\Delta G_{\\mathrm{fs}} = \\frac{k_{\\mathrm{e}} \\xi}{2 \\varepsilon_{r} L} (0^2 - (-1)^2) = -\\frac{k_{\\mathrm{e}} \\xi}{2 \\varepsilon_{r} L}\n$$\n在这两种与 $\\Delta q = +1\\,e$ 一致的基本情况下，自由能修正的大小是相同的。因此我们用这个大小继续计算。\n$$\n\\lvert \\Delta G_{\\mathrm{fs}} \\rvert = \\frac{k_{\\mathrm{e}} \\xi}{2 \\varepsilon_{r} L} (\\Delta q)^2\n$$\n代入给定值，其中以 $e$ 为单位的 $\\Delta q = 1$：\n$k_{\\mathrm{e}} = 138.935456\\,\\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$，$\\xi = 2.837297$，$\\varepsilon_{r} = 78.5$，$L = 6\\,\\mathrm{nm}$。\n$$\n\\lvert \\Delta G_{\\mathrm{fs}} \\rvert = \\frac{(138.935456\\,\\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}) \\times (2.837297)}{2 \\times 78.5 \\times (6\\,\\mathrm{nm})} \\times (1\\,e)^2\n$$\n$$\n\\lvert \\Delta G_{\\mathrm{fs}} \\rvert = \\frac{394.2150...}{942} \\,\\mathrm{kJ\\,mol^{-1}} \\approx 0.418487\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n四舍五入到两位有效数字，我们得到 $\\lvert \\Delta G_{\\mathrm{fs}} \\rvert = 0.42\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n**第2部分：酸解离常数的偏移 $\\lvert \\Delta \\mathrm{p}K_{\\mathrm{a}} \\rvert$**\n\n标准反应自由能 $\\Delta G$ 和平衡常数 $K$ 之间的关系由 $\\Delta G = -RT \\ln K$ 给出。$\\mathrm{p}K_{\\mathrm{a}}$ 定义为 $\\mathrm{p}K_{\\mathrm{a}} = -\\log_{10} K_{\\mathrm{a}}$。\n我们可以使用对数换底公式将这两个表达式关联起来：$\\ln K = (\\ln 10)(\\log_{10} K)$。\n$$\n\\Delta G = -RT (\\ln 10)(\\log_{10} K) = RT (\\ln 10)(-\\log_{10} K) = RT (\\ln 10) \\mathrm{p}K\n$$\n因此，$\\mathrm{p}K_{\\mathrm{a}}$ 可以从自由能计算得出：\n$$\n\\mathrm{p}K_{\\mathrm{a}} = \\frac{\\Delta G}{RT \\ln 10}\n$$\n有限尺寸效应 $\\Delta G_{\\mathrm{fs}}$ 代表了计算自由能中的一个误差，$\\Delta G_{\\mathrm{computed}} = \\Delta G_{\\mathrm{true}} + \\Delta G_{\\mathrm{fs}}$。这个误差直接传播到计算的 $\\mathrm{p}K_{\\mathrm{a}}$ 中：\n$$\n\\mathrm{p}K_{\\mathrm{a, computed}} = \\frac{\\Delta G_{\\mathrm{true}} + \\Delta G_{\\mathrm{fs}}}{RT \\ln 10} = \\mathrm{p}K_{\\mathrm{a, true}} + \\frac{\\Delta G_{\\mathrm{fs}}}{RT \\ln 10}\n$$\n$\\mathrm{p}K_{\\mathrm{a}}$ 的偏移，记作 $\\Delta \\mathrm{p}K_{\\mathrm{a}}$，即是误差项：\n$$\n\\Delta \\mathrm{p}K_{\\mathrm{a}} = \\frac{\\Delta G_{\\mathrm{fs}}}{RT \\ln 10}\n$$\n我们需要计算这个偏移的大小，$\\lvert \\Delta \\mathrm{p}K_{\\mathrm{a}} \\rvert$：\n$$\n\\lvert \\Delta \\mathrm{p}K_{\\mathrm{a}} \\rvert = \\frac{\\lvert \\Delta G_{\\mathrm{fs}} \\rvert}{RT \\ln 10}\n$$\n首先，让我们计算分母 $RT \\ln 10$。使用一致的单位至关重要。由于 $\\lvert \\Delta G_{\\mathrm{fs}} \\rvert$ 是以 $\\mathrm{kJ\\,mol^{-1}}$ 计算的，我们必须将其转换为 $\\mathrm{J\\,mol^{-1}}$ 以匹配 $R$ 的单位。\n$\\lvert \\Delta G_{\\mathrm{fs}} \\rvert = 0.418487\\,\\mathrm{kJ\\,mol^{-1}} = 418.487\\,\\mathrm{J\\,mol^{-1}}$。\n给定的常数是 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，$T = 298\\,\\mathrm{K}$，以及 $\\ln 10 = 2.302585093$。\n$$\nRT \\ln 10 = (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (298\\,\\mathrm{K}) \\times (2.302585093)\n$$\n$$\nRT \\ln 10 \\approx 5705.8\\,\\mathrm{J\\,mol^{-1}}\n$$\n现在我们可以计算偏移的大小：\n$$\n\\lvert \\Delta \\mathrm{p}K_{\\mathrm{a}} \\rvert = \\frac{418.487... \\,\\mathrm{J\\,mol^{-1}}}{5705.8... \\,\\mathrm{J\\,mol^{-1}}} \\approx 0.07334\n$$\n四舍五入到两位有效数字，我们得到 $\\lvert \\Delta \\mathrm{p}K_{\\mathrm{a}} \\rvert = 0.073$。\n\n最终结果是自由能修正的大小 $0.42\\,\\mathrm{kJ\\,mol^{-1}}$，以及 p$K_{\\mathrm{a}}$ 偏移的大小 $0.073$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.42  0.073 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在完成模拟并收集数据后，下一个关键步骤是从中提取有意义的物理量并评估采样的质量。本练习应用了稳健的统计方法——最大似然估计和剖面似然置信区间——来分析模拟的滴定计数，从而确定一个位点的$pK_a$。这项实践不仅仅是曲线拟合，它还引入了“过度离散”作为一种诊断工具，帮助您批判性地评估您的简单模型是否足够，或者是否有更复杂的现象（如隐藏的构象状态或相关的采样）正在影响结果，是计算化学中严谨数据分析的实践指南。",
            "id": "3404590",
            "problem": "给定来自恒定pH分子动力学的独立滴定观测值，其形式为在几个溶液酸度值下质子化与去质子化状态的计数。假设存在一个遵循与Henderson–Hasselbalch等温线一致的酸碱平衡的单一可滴定位点。将酸度值为 $pH_i$ 时的每个观测值建模为 $N_i$ 次试验中的 $y_i$ 次质子化计数，其中 $y_i$ 服从成功概率为 $p_i$ 的二项式随机变量分布。对于一个酸性位点，其质子化分数由平衡占据率给出\n$$\np_i = \\frac{1}{1 + 10^{\\,pH_i - pK_a}},\n$$\n其中 $pK_a$ 是对数标度下的酸解离常数。假设在给定 $pK_a$ 的条件下，不同 $pH_i$ 处的观测值是独立的。\n\n任务：\n1. 使用二项式似然和独立性假设，通过最大化关于 $pK_a$ 的对数似然函数，根据所提供的数据确定最大似然估计 (MLE) $\\widehat{pK_a}$。\n2. 通过剖面似然法为 $pK_a$ 构建一个双侧 $95\\%$ 置信区间。具体来说，定义负对数似然 $-\\ell(pK_a)$ (允许相差一个加性常数)，并找到满足以下条件的 $pK_a$ 值集合：\n$$\n2\\left(\\ell(\\widehat{pK_a}) - \\ell(pK_a)\\right) \\le \\chi^2_{1,0.95},\n$$\n其中 $\\chi^2_{1,0.95}$ 是自由度为1的卡方分布的 $0.95$ 分位数。如果区间超出了物理上合理的酸度常数范围，则将其截断至 $[0, 14]$ 范围内。\n3. 通过计算Pearson离势统计量来评估过度离势：\n$$\n\\phi = \\frac{1}{K - 1} \\sum_{i=1}^{K} \\frac{\\left(y_i - N_i \\widehat{p}_i\\right)^2}{N_i \\widehat{p}_i \\left(1 - \\widehat{p}_i\\right)},\n$$\n其中 $K$ 是酸度点的数量，$\\widehat{p}_i$ 是使用 $\\widehat{pK_a}$ 在 $pH_i$ 处拟合的质子化概率。在二项式模型下，Pearson卡方统计量\n$$\nX^2 = \\sum_{i=1}^{K} \\frac{\\left(y_i - N_i \\widehat{p}_i\\right)^2}{N_i \\widehat{p}_i \\left(1 - \\widehat{p}_i\\right)}\n$$\n近似服从自由度为 $K - 1$ 的 $\\chi^2$ 分布。使用此特性计算一个 $p$-值。如果 $\\phi  1$ 且 $p$-值低于显著性水平 $\\alpha = 0.01$，则判定数据存在过度离势。将过度离势解释为暗示存在超出单一位点模型的时间相关性或隐藏亚态。\n\n您的程序必须为以下测试用例集实现这种估计和诊断。每个用例提供 $pH$ 值、总计数 $N_i$ 和质子化计数 $y_i$：\n\n- A例 (表现良好的二项式抽样，中等样本量)：\n  - $pH$: $[4.0, 5.5, 6.0, 6.5, 7.0, 8.0, 9.0]$\n  - $N$: $[500, 500, 500, 500, 500, 500, 500]$\n  - $y$: $[498, 455, 374, 250, 125, 12, 1]$\n\n- B例 (在大多数$pH$值下表现出明显的过度离势)：\n  - $pH$: $[4.0, 5.5, 6.0, 6.5, 7.0, 8.0, 9.0]$\n  - $N$: $[500, 500, 500, 500, 500, 500, 500]$\n  - $y$: $[485, 420, 340, 280, 160, 30, 6]$\n\n- C例 (边缘权重抽样，小样本量)：\n  - $pH$: $[3.0, 4.0, 6.0, 9.0, 10.0]$\n  - $N$: $[50, 50, 50, 50, 50]$\n  - $y$: $[50, 49, 25, 2, 0]$\n\n- D例 (类似隐藏状态的形状，暗示混合物)：\n  - $pH$: $[5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0]$\n  - $N$: $[400, 400, 400, 400, 400, 400, 400]$\n  - $y$: $[372, 352, 300, 170, 140, 70, 45]$\n\n要求：\n- 对于每个用例，计算并报告一个包含四项的列表：$\\widehat{pK_a}$、置信下限、置信上限和一个布尔型过度离势标志。将所有三个与 $pK_a$ 相关的数值四舍五入到3位小数。该布尔值必须报告为语言原生的布尔值。\n- 最终输出必须是单行，包含一个结果列表，每个用例一个结果，其中每个用例的结果本身就是按上述顺序排列的列表。该行必须格式化为用方括号括起来的逗号分隔列表，且不含空格，例如：$[[x_1,y_1,z_1,b_1],[x_2,y_2,z_2,b_2],\\dots]$。\n- 所有酸度值和 $pK_a$ 值都是无量纲的，因此不需要单位。在整个计算过程中，对 $pK_a$ 使用物理合理范围 $[0, 14]$。",
            "solution": "我们将每个观测值建模如下。对于每个酸度点 $pH_i$，试验 $j$ 的质子化状态指示符 $X_{ij}$ 是一个成功概率为 $p_i$ 的伯努利随机变量，在给定 $pK_a$ 的条件下，其在 $j$ 和 $i$ 上是独立的。该点的二项式计数为 $Y_i = \\sum_{j=1}^{N_i} X_{ij}$，因此 $Y_i \\sim \\mathrm{Binomial}(N_i, p_i)$。对于处于平衡状态的酸性位点，其质子化分数为\n$$\np_i = \\frac{1}{1 + 10^{\\,pH_i - pK_a}},\n$$\n这可由质量作用定律和Henderson–Hasselbalch关系式的定义推导出。独立性假设意味着跨越 $K$ 个酸度值的联合似然为\n$$\nL(pK_a) = \\prod_{i=1}^{K} \\binom{N_i}{y_i} p_i^{y_i} (1 - p_i)^{N_i - y_i}.\n$$\n相应的对数似然为\n$$\n\\ell(pK_a) = \\sum_{i=1}^{K} \\left[ \\log \\binom{N_i}{y_i} + y_i \\log p_i + (N_i - y_i) \\log(1 - p_i) \\right].\n$$\n组合项不依赖于 $pK_a$，因此最大化 $\\ell(pK_a)$ 等价于最小化不含这些常数的负对数似然：\n$$\n-\\tilde{\\ell}(pK_a) = -\\sum_{i=1}^{K} \\left[ y_i \\log p_i + (N_i - y_i) \\log(1 - p_i) \\right].\n$$\n我们通过在物理合理范围 $[0, 14]$ 内最小化 $-\\tilde{\\ell}(pK_a)$ 来计算最大似然估计 $\\widehat{pK_a}$。在数值上，我们使用 $p_i = 1/(1 + 10^{\\,pH_i - pK_a})$ 从 $pK_a$ 计算 $p_i$，将 $p_i$ 裁剪到 $[10^{-12}, 1 - 10^{-12}]$ 以避免对零取对数，并使用一个有界一维优化器。\n\n对于置信区间，我们引用渐近剖面似然的结果：在正则性条件下，似然比统计量\n$$\n\\Lambda(pK_a) = 2\\left(\\ell(\\widehat{pK_a}) - \\ell(pK_a)\\right)\n$$\n依分布收敛于一个自由度为1的卡方分布。因此，95%剖面似然置信集是所有满足\n$$\n\\Lambda(pK_a) \\le \\chi^2_{1, 0.95}.\n$$\n的 $pK_a$。用负对数似然表示，这等价于\n$$\n-\\tilde{\\ell}(pK_a) \\le -\\tilde{\\ell}(\\widehat{pK_a}) + \\frac{1}{2} \\chi^2_{1, 0.95}.\n$$\n我们计算阈值 $-\\tilde{\\ell}(\\widehat{pK_a}) + \\frac{1}{2} \\chi^2_{1,0.95}$，然后数值求解 $-\\tilde{\\ell}(pK_a)$ 与该水平的左右交点。我们首先在 $[0, 14]$ 上扫描一个网格以界定交叉点，然后使用局部求根器来精化每个边界。如果在 $[0, 14]$ 范围内的一侧未找到交叉点，我们相应地将该边界截断为0或14。\n\n为了评估过度离势，我们使用在MLE处的Pearson卡方统计量：\n$$\nX^2 = \\sum_{i=1}^{K} \\frac{\\left(y_i - N_i \\widehat{p}_i\\right)^2}{N_i \\widehat{p}_i \\left(1 - \\widehat{p}_i\\right)},\n$$\n其中 $\\widehat{p}_i = \\frac{1}{1 + 10^{\\,pH_i - \\widehat{pK_a}}}$。在带有一个拟合参数 $pK_a$ 的二项式模型下，$X^2$ 近似服从自由度为 $K - 1$ 的卡方分布。离势估计为\n$$\n\\phi = \\frac{X^2}{K - 1}.\n$$\n我们从卡方生存函数计算 $p$-值，然后在 $\\phi  1$ 且 $p$-值低于 $\\alpha = 0.01$ 时判定存在过度离势。这种过度离势可能源于样本中的时间相关性或隐藏的亚态，它们违反了单一位点、独立抽样的二项式假设，而当动力学缓慢或多个微观态起作用时，这些正是恒定pH分子动力学中我们感兴趣的现象。\n\n程序为每个用例实现的算法步骤：\n1. 解析数组 $\\{pH_i\\}_{i=1}^{K}$、$\\{N_i\\}_{i=1}^{K}$、$\\{y_i\\}_{i=1}^{K}$。\n2. 使用有界优化器在 $[0, 14]$ 范围内最小化 $-\\tilde{\\ell}(pK_a)$ 来计算 $\\widehat{pK_a}$。\n3. 使用 $\\chi^2_{1, 0.95}$ 计算剖面似然阈值，在网格上界定交叉点，并用求根器精化以获得下限和上限；根据需要截断到 $[0, 14]$。\n4. 计算自由度为 $K - 1$ 的 $\\phi$ 和卡方 $p$-值；使用 $\\alpha = 0.01$ 设置过度离势标志。\n5. 将 $\\widehat{pK_a}$ 及两个边界四舍五入到3位小数，并返回一个列表 $[\\widehat{pK_a}, \\mathrm{lower}, \\mathrm{upper}, \\mathrm{flag}]$。\n\n程序将四个用例的结果聚合到一个列表中，并以指定的无空格格式单行打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize, stats\n\ndef occupancy_fraction(pH, pKa):\n    # Acid-site protonated fraction under Henderson–Hasselbalch\n    return 1.0 / (1.0 + np.power(10.0, pH - pKa))\n\ndef neg_log_likelihood(pKa, pH, N, y):\n    p = occupancy_fraction(pH, pKa)\n    # Numerical stability clipping\n    p = np.clip(p, 1e-12, 1.0 - 1e-12)\n    # Binomial log-likelihood up to additive constants\n    ll = y * np.log(p) + (N - y) * np.log(1.0 - p)\n    return -np.sum(ll)\n\ndef mle_pKa(pH, N, y):\n    res = optimize.minimize_scalar(\n        neg_log_likelihood,\n        bounds=(0.0, 14.0),\n        args=(pH, N, y),\n        method=\"bounded\",\n        options={\"xatol\": 1e-9, \"maxiter\": 500}\n    )\n    return res.x, res.fun\n\ndef profile_ci(pH, N, y, pKa_hat, nll_min, alpha=0.05):\n    # Compute threshold for NLL increase using likelihood ratio\n    chi2crit = stats.chi2.ppf(1.0 - alpha, df=1)\n    target = nll_min + 0.5 * chi2crit\n\n    def g(x):\n        return neg_log_likelihood(x, pH, N, y) - target\n\n    # Grid to bracket crossings\n    grid = np.linspace(0.0, 14.0, 7001)\n    nll_vals = np.array([neg_log_likelihood(x, pH, N, y) for x in grid])\n    g_vals = nll_vals - target\n    i_min = int(np.argmin(nll_vals))\n\n    # Find left crossing index (g crosses from 0 to =0 when moving right)\n    left_idx = None\n    for i in range(i_min, 0, -1):\n        if g_vals[i] = 0 and g_vals[i - 1]  0:\n            left_idx = i - 1\n            break\n    # Find right crossing index (g crosses from =0 to 0 when moving right)\n    right_idx = None\n    for i in range(i_min, len(grid) - 1):\n        if g_vals[i] = 0 and g_vals[i + 1]  0:\n            right_idx = i\n            break\n\n    # Refine with brentq where possible; else truncate to bounds\n    # Left bound\n    if left_idx is not None:\n        a = grid[left_idx]\n        b = grid[left_idx + 1]\n        fa = g_vals[left_idx]\n        fb = g_vals[left_idx + 1]\n        if fa == 0.0:\n            left_bound = a\n        elif fb == 0.0:\n            left_bound = b\n        elif fa * fb  0:\n            left_bound = optimize.brentq(lambda x: g(x), a, b, maxiter=100, xtol=1e-10)\n        else:\n            left_bound = a  # fallback to bracket edge\n    else:\n        left_bound = 0.0\n\n    # Right bound\n    if right_idx is not None:\n        a = grid[right_idx]\n        b = grid[right_idx + 1]\n        fa = g_vals[right_idx]\n        fb = g_vals[right_idx + 1]\n        if fa == 0.0:\n            right_bound = a\n        elif fb == 0.0:\n            right_bound = b\n        elif fa * fb  0:\n            right_bound = optimize.brentq(lambda x: g(x), a, b, maxiter=100, xtol=1e-10)\n        else:\n            right_bound = b  # fallback to bracket edge\n    else:\n        right_bound = 14.0\n\n    # Ensure within [0,14]\n    left_bound = max(0.0, min(14.0, left_bound))\n    right_bound = max(0.0, min(14.0, right_bound))\n\n    # Order check\n    if right_bound  left_bound:\n        left_bound, right_bound = right_bound, left_bound\n\n    return left_bound, right_bound\n\ndef pearson_overdispersion(pH, N, y, pKa_hat):\n    p = occupancy_fraction(pH, pKa_hat)\n    # Avoid division by zero in variance terms\n    p = np.clip(p, 1e-12, 1.0 - 1e-12)\n    var = N * p * (1.0 - p)\n    resid = y - N * p\n    chi2 = np.sum((resid ** 2) / var)\n    df = len(pH) - 1  # one fitted parameter\n    phi = chi2 / df\n    p_value = stats.chi2.sf(chi2, df)\n    return phi, p_value\n\ndef round_float(x, digits=3):\n    return float(f\"{x:.{digits}f}\")\n\ndef format_nested_list_no_spaces(nested):\n    # Formats nested list of simple types into a no-space string like JSON arrays\n    def format_value(v):\n        if isinstance(v, bool):\n            # Use capitalized boolean to match Python's default\n            return \"True\" if v else \"False\"\n        elif isinstance(v, float):\n            # Already rounded floats should be passed; ensure standard formatting\n            s = f\"{v:.3f}\"\n            # Remove trailing zeros and dot? Problem requires 3 decimals explicitly, so keep them\n            return s\n        elif isinstance(v, int):\n            return str(v)\n        elif isinstance(v, list):\n            return \"[\" + \",\".join(format_value(vi) for vi in v) + \"]\"\n        else:\n            # Fallback: convert to string directly\n            return str(v)\n    return \"[\" + \",\".join(format_value(item) for item in nested) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (pH array, N array, y array)\n    test_cases = [\n        # Case A\n        (np.array([4.0, 5.5, 6.0, 6.5, 7.0, 8.0, 9.0]),\n         np.array([500, 500, 500, 500, 500, 500, 500], dtype=float),\n         np.array([498, 455, 374, 250, 125, 12, 1], dtype=float)),\n        # Case B\n        (np.array([4.0, 5.5, 6.0, 6.5, 7.0, 8.0, 9.0]),\n         np.array([500, 500, 500, 500, 500, 500, 500], dtype=float),\n         np.array([485, 420, 340, 280, 160, 30, 6], dtype=float)),\n        # Case C\n        (np.array([3.0, 4.0, 6.0, 9.0, 10.0]),\n         np.array([50, 50, 50, 50, 50], dtype=float),\n         np.array([50, 49, 25, 2, 0], dtype=float)),\n        # Case D\n        (np.array([5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0]),\n         np.array([400, 400, 400, 400, 400, 400, 400], dtype=float),\n         np.array([372, 352, 300, 170, 140, 70, 45], dtype=float)),\n    ]\n\n    alpha_overdispersion = 0.01  # significance level for overdispersion decision\n    results = []\n    for pH, N, y in test_cases:\n        # MLE\n        pKa_hat, nll_min = mle_pKa(pH, N, y)\n        # Profile likelihood 95% CI\n        ci_low, ci_high = profile_ci(pH, N, y, pKa_hat, nll_min, alpha=0.05)\n        # Overdispersion\n        phi, p_value = pearson_overdispersion(pH, N, y, pKa_hat)\n        overdispersed = (phi  1.0) and (p_value  alpha_overdispersion)\n\n        # Round outputs\n        pKa_hat_r = round_float(pKa_hat, 3)\n        ci_low_r = round_float(ci_low, 3)\n        ci_high_r = round_float(ci_high, 3)\n\n        results.append([pKa_hat_r, ci_low_r, ci_high_r, overdispersed])\n\n    # Final print statement in the exact required format (no spaces).\n    print(format_nested_list_no_spaces(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}