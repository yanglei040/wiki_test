## 引言
[扩散](@entry_id:141445)是自然界中最普遍的[输运现象](@entry_id:147655)之一，从墨水在清水中散开，到细胞内营养物质的输运，再到[半导体](@entry_id:141536)中掺杂原子的迁移，其背后都遵循着相同的物理规律。[扩散](@entry_id:141445)系数（$D$）是量化这一过程速率的核心物理参数，它直接关联着物质的微观动力学与宏观性质。因此，在分子层面精确地预测和理解[扩散](@entry_id:141445)系数，对于众多科学与工程领域的发展至关重要。分子动力学（MD）模拟作为一种强大的“[计算显微镜](@entry_id:747627)”，为我们从第一性原理出发研究[扩散](@entry_id:141445)提供了无与伦比的工具。然而，从模拟轨迹中可靠地提取[扩散](@entry_id:141445)系数并非易事，它要求研究者不仅要掌握其理论基础，还要能处理有限模拟时间、有限体系尺寸等带来的复杂问题和系统误差。

本文旨在为研究生及相关领域的研究人员提供一个关于使用MD模拟估算[扩散](@entry_id:141445)系数的全面指南。我们将分三个章节，系统地构建从理论到实践的知识体系：
在“原理与机制”一章中，我们将深入探讨支撑[扩散](@entry_id:141445)系数计算的两大理论支柱——爱因斯坦关系和[格林-久保关系](@entry_id:144763)，阐明它们的物理内涵和等价性。同时，我们将分析粒子运动的[特征时间尺度](@entry_id:276738)，并讨论如何处理[有限尺寸效应](@entry_id:155681)等关键的模拟修[正问题](@entry_id:749532)。
随后的“应用与跨学科连接”一章将展示这些理论和方法在解决实际问题中的强大威力，通过横跨[材料科学](@entry_id:152226)、生物物理、[化学物理](@entry_id:199585)乃至天体物理学的案例，揭示[扩散](@entry_id:141445)研究的广泛性和深刻影响。
最后，在“动手实践”部分，我们将通过具体的编程练习，指导读者如何处理模拟数据、移除计算伪影、应用高级修正技术，从而将理论知识转化为可靠的科研技能。

## 原理与机制

在上一章引言的基础上，本章旨在深入剖析估算[扩散](@entry_id:141445)系数所依据的核心物理原理及其在分子动力学（MD）模拟中的具体机制。我们将从[扩散](@entry_id:141445)现象的两种等价的微观[统计力](@entry_id:194984)学定义出发，探讨实际计算中遇到的各种动态行为，并最终讨论在有限体系模拟中必须考虑的高等修正议题。本章的目标是为读者构建一个从第一性原理到实践应用的完整知识框架。

### [扩散](@entry_id:141445)的宏观与微观描述

[扩散](@entry_id:141445)，作为一种基本的输运现象，描述了粒子因随机热运动而从高浓度区域向低浓度区域的净迁移过程。在统计物理层面，这一宏观现象根植于单个粒子微观运动的统计规律。有两种等价的理论框架，即爱因斯坦关系和[格林-久保关系](@entry_id:144763)，它们将宏观的[扩散](@entry_id:141445)系数 $D$ 与微观的[粒子轨迹](@entry_id:204827)关联起来。

#### 爱因斯坦关系与[均方位移](@entry_id:159665)

描述[扩散](@entry_id:141445)最直观的方式是通过追踪粒子位置随时间的变化。我们定义**[均方位移](@entry_id:159665)**（Mean Squared Displacement, MSD）为粒子在时间间隔 $t$ 内[位移矢量](@entry_id:262782) $\Delta \mathbf{r}(t) = \mathbf{r}(t) - \mathbf{r}(0)$ 的模方在系综上的平均值，记作 $\langle |\Delta \mathbf{r}(t)|^2 \rangle$。对于一个处于平衡态的流体，在足够长的时间尺度上，粒子的运动可以看作是[随机游走](@entry_id:142620)。其结果是，MSD与时间 $t$ 呈线性关系。这便是著名的**爱因斯坦关系**（Einstein relation）。

在 $d$ 维[欧几里得空间](@entry_id:138052)中，[扩散](@entry_id:141445)系数 $D$ 被严格定义为：

$$
D = \lim_{t\to\infty} \frac{\langle |\Delta \mathbf{r}(t)|^2 \rangle}{2dt}
$$

这个表达式中的系数 $1/(2d)$ 具有深刻的物理根源。在一个各向同性的系统中，沿任何方向的运动都是等价的。因此，我们可以将 $d$ 维的位移分解到 $d$ 个正交的笛卡尔坐标轴上：$|\Delta \mathbf{r}(t)|^2 = \sum_{i=1}^d \Delta x_i(t)^2$。由于各向同性，不同方向上的位移分量是不相关的，即对于 $i \neq j$，$\langle \Delta x_i(t) \Delta x_j(t) \rangle = 0$。因此，总的MSD是各个分量MSD之和：

$$
\langle |\Delta \mathbf{r}(t)|^2 \rangle = \sum_{i=1}^d \langle \Delta x_i(t)^2 \rangle
$$

每个一维分量的运动本身就是一个[扩散过程](@entry_id:170696)，其均方位移服从[一维扩散方程](@entry_id:746146)，结果为 $\langle \Delta x_i(t)^2 \rangle = 2Dt$。将这 $d$ 个相同的贡献相加，我们得到总的MSD为 $\langle |\Delta \mathbf{r}(t)|^2 \rangle = d \times (2Dt) = 2dDt$。为了从MSD的长时间增长率中求解出 $D$，我们必须除以系数 $2d$ 。这个推导不仅阐明了公式的来源，也强调了各向同性是该关系成立的关键前提。

#### [格林-久保关系](@entry_id:144763)与速度自关联函数

另一种描述[扩散](@entry_id:141445)的等价方法源于[线性响应理论](@entry_id:145737)，它将[输运系数](@entry_id:136790)与平衡态下的微观涨落联系起来。对于[扩散](@entry_id:141445)而言，相关的微观量是粒子的速度。**速度自关联函数**（Velocity Autocorrelation Function, VACF）$C_v(t) = \langle \mathbf{v}(0) \cdot \mathbf{v}(t) \rangle$ 描述了粒子在时间 $t$ 的速度与其在初始时刻 $t=0$ 速度之间的关联程度。

物理上，VACF 量化了粒子速度的“记忆”或“持续性”。在 $t=0$ 时，VACF的值为 $\langle |\mathbf{v}(0)|^2 \rangle$，即均方速率，其大小由系统的温度通过[能量均分定理](@entry_id:136972)决定。随着时间的推移，粒子与周围粒子发生碰撞，其速度的方向和大小逐渐变得随机，与初始速度的关联性减弱。因此，在流体中，$C_v(t)$ 会随时间衰减至零。

[扩散](@entry_id:141445)系数 $D$ 与 VACF 的关系可以通过以下推导得出。首先，位移是速度的[时间积分](@entry_id:267413) $\Delta \mathbf{r}(t) = \int_0^t \mathbf{v}(\tau) d\tau$。将其代入MSD的定义中，得到：

$$
\langle |\Delta \mathbf{r}(t)|^2 \rangle = \left\langle \int_0^t d\tau \int_0^t d\tau' \, \mathbf{v}(\tau) \cdot \mathbf{v}(\tau') \right\rangle = \int_0^t d\tau \int_0^t d\tau' \, \langle \mathbf{v}(\tau) \cdot \mathbf{v}(\tau') \rangle
$$

对于处于平衡态的定常系统，时间关联函数仅依赖于时间差，即 $\langle \mathbf{v}(\tau) \cdot \mathbf{v}(\tau') \rangle = \langle \mathbf{v}(0) \cdot \mathbf{v}(\tau' - \tau) \rangle = C_v(\tau'-\tau)$。经过数学变换，可以证明MSD的长时间增长斜率与VACF的[时间积分](@entry_id:267413)成正比。在 $d$ 维空间中，最终得到**[格林-久保关系](@entry_id:144763)**（Green-Kubo relation）：

$$
D = \frac{1}{d} \int_0^\infty \langle \mathbf{v}(0) \cdot \mathbf{v}(t) \rangle dt
$$

此关系式表明，[扩散](@entry_id:141445)系数是粒子速度记忆的累积效应。一个衰减缓慢的VACF（即速度记忆持续时间长）对应着一个较大的[扩散](@entry_id:141445)系数，反之亦然。爱因斯坦关系和[格林-久保关系](@entry_id:144763)是等价的，它们从[位形空间](@entry_id:149531)和[动量空间](@entry_id:148936)两个不同角度描述了同一个物理过程，为从MD模拟中计算[扩散](@entry_id:141445)系数提供了两条基本途径 。

### 粒子运动的时间尺度与[扩散](@entry_id:141445)行为

在典型的液体或气体中，一个粒子的运动会经历几个特征性的时间尺度，这在MSD和VACF中留下了清晰的印记。理解这些动态行为对于正确地应用爱因斯坦关系或[格林-久保关系](@entry_id:144763)至关重要。

#### 从弹道运动到[扩散](@entry_id:141445)运动

我们可以通过一个简化的模型——郎之万动力学（Langevin dynamics）来精确描述这些行为。在此模型中，一个质量为 $m$ 的粒子受到来自周围流体的黏性[摩擦力](@entry_id:171772) $-\gamma \mathbf{v}(t)$ 和随机[热噪声](@entry_id:139193)力 $\boldsymbol{\xi}(t)$ 的共同作用。

1.  **弹道运动区（Ballistic Regime, $t \to 0$）**：在极短的时间尺度内，粒子尚未与周围的流体分子发生显著碰撞。其运动近似于匀速[直线运动](@entry_id:165142)，位移为 $\Delta \mathbf{r}(t) \approx \mathbf{v}(0)t$。因此，MSD与时间呈二次方关系：$\langle |\Delta \mathbf{r}(t)|^2 \rangle \approx \langle |\mathbf{v}(0)|^2 \rangle t^2 = \langle v^2 \rangle t^2$。在此区间，VACF几乎保持其初始值 $\langle v^2 \rangle$ 不变。这个区域被称为**弹道运动区**，因为粒子的运动轨迹如同发射出的炮弹。

2.  **[扩散](@entry_id:141445)运动区（Diffusive Regime, $t \to \infty$）**：在经历了大量碰撞后，粒子的速度已经完全随机化，其运动轨迹变为无规行走。此时，MSD与时间恢复线性关系：$\langle |\Delta \mathbf{r}(t)|^2 \rangle \approx 2dDt$。相应的，VACF已经衰减到接近于零。

从弹道运动到[扩散](@entry_id:141445)运动的**[交叉](@entry_id:147634)时间**（crossover time）$t_c$ 可以通过令两种[渐近行为](@entry_id:160836)的MSD相等来估算。对于郎之万模型，这给出了 $t_c = 2m/\gamma$ 。这个时间尺度大致对应于粒子动量的弛豫时间。

3.  **笼蔽区（Caged Regime）**：在致密液体或[过冷液体](@entry_id:158222)中，弹道运动和[扩散](@entry_id:141445)运动之间还存在一个重要的中间区域。粒子被其近邻粒子形成的瞬时“笼子”所束缚。在逃离这个笼子之前，它会在笼内来回[振动](@entry_id:267781)和碰撞。这种“回弹”或**背散射**（backscattering）效应导致其速度方向反转，使得VACF在经过短暂的正值后，会出现一个明显的**负值区**。在MSD曲线上，这一阶[段表](@entry_id:754634)现为生长速率显著减缓，呈现出所谓的**[亚扩散](@entry_id:149298)**（sub-diffusive）行为，即MSD的斜率暂时性地小于1 。

#### [扩散](@entry_id:141445)系数的[稳健估计](@entry_id:261282)

鉴于粒子运动的复杂性，从有限时间的MD模拟数据中准确提取[扩散](@entry_id:141445)系数 $D$ 是一项挑战。关键在于如何可靠地识别出真正的[扩散](@entry_id:141445)区。

一种有效的方法是分析MSD在对数-对数[坐标图](@entry_id:156506)中的**局部斜率** $\alpha(t) = \frac{d \ln \mathrm{MSD}(t)}{d \ln t}$。
- 在弹道区，$\mathrm{MSD} \propto t^2$，所以 $\alpha(t) = 2$。
- 在[扩散](@entry_id:141445)区，$\mathrm{MSD} \propto t$，所以 $\alpha(t) = 1$。
- 在[亚扩散](@entry_id:149298)的笼蔽区，$\alpha(t)  1$。

因此，一个稳健的策略是寻找一个时间窗口，在此窗口内 $\alpha(t)$ 稳定地维持在1附近。对该时间窗口内的MSD数据进行线性拟合，其斜率即为 $2dD$。

更进一步，为了确保结果的可靠性，我们必须进行**一致性检验**。这可以通过计算[格林-久保关系](@entry_id:144763)的“运行积分”来实现：$D_{GK}(t) = \frac{1}{d} \int_0^t C_v(s) ds$。只有当系统完全进入[扩散](@entry_id:141445)区，粒子的速度记忆完全消失后，$D_{GK}(t)$ 才会收敛到一个稳定的平台值。这个平台值必须与从MSD斜率得到的 $D$ 相一致。实践中，选取MSD的拟合窗口时，应确保该窗口的起始时间晚于VACF负值区的结束，并且 $D_{GK}(t)$ 已经进入平台期 。

#### [反常扩散](@entry_id:141592)：当线性关系不再成立

在许多复杂系统中，例如玻璃态物质、拥挤的生物细胞环境或多孔介质中，粒子可能永远不会进入一个清晰的线性[扩散](@entry_id:141445)区。这种行为被称为**[反常扩散](@entry_id:141592)**。其中一种常见的形式是**[亚扩散](@entry_id:149298)**（subdiffusion），其MSD表现为[幂律](@entry_id:143404)形式：

$$
\langle|\Delta r(t)|^2\rangle \propto t^\alpha \quad \text{其中 } 0  \alpha  1
$$

在这种情况下，标准的爱因斯坦关系不再适用。如果我们形式上地计算时间依赖的爱因斯坦估计量 $D_E(t) = \frac{\langle|\Delta r(t)|^2\rangle}{2dt}$，会发现它并不收敛到一个常数，而是随时间衰减：$D_E(t) \propto t^{\alpha-1}$。随着 $t \to \infty$，该估计值将趋于零，这显然是误导性的。此时，描述系统动态的不再是一个简单的[扩散](@entry_id:141445)常数，而是[反常扩散](@entry_id:141592)指数 $\alpha$ 和一个广义的[输运系数](@entry_id:136790)。

之前为正常[扩散](@entry_id:141445)建立的诊断工具，如对数-对数图的斜率分析，在这里变得至关重要。通过对 $\ln(\mathrm{MSD})$ vs. $\ln(t)$ 进行线性拟合，我们可以直接估算反常指数 $\hat{\alpha}$。同时，检查 $\ln(D_E(t))$ vs. $\ln(t)$ 在长时间段的斜率 $s_D$，若其收敛到一个显著的负值（理论上应为 $\alpha-1$），则可确认为[亚扩散](@entry_id:149298)行为 。

### [自扩散](@entry_id:754665)与[集体扩散](@entry_id:204354)

到目前为止，我们的讨论都集中在单个粒子（或称“示踪粒子”）的运动上，这被称为**[自扩散](@entry_id:754665)**（self-diffusion），其[输运系数](@entry_id:136790)记为 $D_s$。然而，在多组分混合物中，我们常常更关心不同组分之间相对运动的宏观过程，这由**[集体扩散](@entry_id:204354)**（collective diffusion）来描述。

#### [自扩散](@entry_id:754665)与[互扩散](@entry_id:186107)

考虑一个由A和B两种组分构成的[二元混合物](@entry_id:168452)。
- **[自扩散系数](@entry_id:754666)** $D_{s,A}$ 描述了在[均匀混合物](@entry_id:146483)中，一个A粒子因热运动而发生的随机迁移速率。它是在没有宏观[浓度梯度](@entry_id:136633)时，单个粒子行为的度量。
- **[互扩散](@entry_id:186107)系数**（mutual diffusion coefficient），例如**麦克斯韦-斯特凡（Maxwell-Stefan）[扩散](@entry_id:141445)系数** $D_{AB}$，描述的是当存在[化学势梯度](@entry_id:142294)时，A、B两组分发生[相对运动](@entry_id:169798)以消除浓度不均匀性的速率。它是一个集体的、响应外部驱动力的非平衡输运性质。

从物理上看，$D_{s}$ 反映了粒子与周围所有粒子（包括同种和异种）相互作用的平均效果，而 $D_{AB}$ 则更直接地反映了A、B两种不同分子间的[摩擦阻力](@entry_id:270342)。

在[线性不可逆热力学](@entry_id:155993)框架下，可以推导出联系宏观[扩散通量](@entry_id:748422)与[热力学](@entry_id:141121)驱动力的[本构关系](@entry_id:186508)。对于一个[二元混合物](@entry_id:168452)，在恒温恒压下，物种A的净[扩散通量](@entry_id:748422) $\mathbf{j}$（单位：$\mathrm{mol\,m^{-2}\,s^{-1}}$）与[化学势梯度](@entry_id:142294) $\nabla(\mu_A - \mu_B)$ 之间的关系由[麦克斯韦-斯特凡方程](@entry_id:153894)给出：

$$
\mathbf{j} = - \frac{c x_A x_B D_{AB}}{RT} \nabla(\mu_A - \mu_B)
$$

其中 $c$ 是总[摩尔浓度](@entry_id:139283)，$x_A$ 和 $x_B$ 是摩尔分数，$R$ 是气体常数，$T$ 是温度。这个关系式清晰地表明，$D_{AB}$ 是连接宏观通量和微观[热力学](@entry_id:141121)驱动力的比例系数 。

#### [范霍夫关联函数](@entry_id:155849)

一个更形式化地区分[自扩散](@entry_id:754665)和[集体扩散](@entry_id:204354)的工具是**[范霍夫关联函数](@entry_id:155849)**（Van Hove correlation function），$G(\mathbf{r}, t)$。它给出了在 $t=0$ 时一个粒子位于原点，在时间 $t$ 时在距离原点 $\mathbf{r}$ 处找到任意一个粒子的概率密度。它可以被精确地分解为两部分：

1.  **自部分（Self part）$G_s(\mathbf{r}, t)$**：这部分只考虑 $t=0$ 和 $t$ 时是同一个粒子的情况。它描述的是示踪粒子的运动，与我们之前讨论的[自扩散](@entry_id:754665)完全对应。在长时间极限下，$G_s(\mathbf{r}, t)$ 趋向一个均值为零、[方差](@entry_id:200758)为 $2dD_s t$ 的[高斯分布](@entry_id:154414)。

2.  **异部分（Distinct part）$G_d(\mathbf{r}, t)$**：这部分考虑 $t$ 时刻在 $\mathbf{r}$ 处找到的粒子与 $t=0$ 时原点的粒子是不同粒子的情况。它描述了粒子相对于其邻居的运动，包含了所有集[体效应](@entry_id:261475)和结构信息。在长时间极限下，任何两个不同粒子间的位置关联都将消失，因此 $G_d(\mathbf{r}, t)$ 将趋于系统的平均数密度 $\rho$。

[集体动力学](@entry_id:204455)性质，如[集体扩散](@entry_id:204354)，是从总的范霍夫函数 $G(\mathbf{r},t)$ 或其异部分 $G_d(\mathbf{r},t)$ 中提取的。在实验上（如[中子散射](@entry_id:142835)），人们测量的是这些函数的[空间傅里叶变换](@entry_id:176346)——**[中间散射函数](@entry_id:159928)** $F(\mathbf{k}, t)$。[集体扩散](@entry_id:204354)系数 $D_c$ 可以从 $F(\mathbf{k}, t)$ 在小波矢 $\mathbf{k}$ 极限下的衰减速率中得到。一般而言，$D_c$ 和 $D_s$ 并不相等。它们的差异由[静态结构因子](@entry_id:141682) $S(\mathbf{k})$ 决定，后者反映了系统中的静态位置关联。只有在理想气体这种没有粒子间相互作用的体系中，$S(\mathbf{k})=1$，才会有 $D_c = D_s$ 。

### 模拟中的高等议题与修正

在实际的MD模拟中，一些看似技术性的细节可能会对[扩散](@entry_id:141445)系数的计算产生深远影响。本节讨论其中最关键的几个问题。

#### 摩擦、涨落与[扩散](@entry_id:141445)

郎之万方程提供了一个将[扩散](@entry_id:141445)与**摩擦**（friction）联系起来的视角。[扩散](@entry_id:141445)系数 $D$ 和[摩擦系数](@entry_id:150354) $\zeta$ 之间存在一个普适关系，即**爱因斯坦-斯摩罗霍夫斯基关系**（Einstein-Smoluchowski relation）：

$$
D = \frac{k_B T}{\zeta}
$$

其中 $k_B$ 是[玻尔兹曼常数](@entry_id:142384)。这个关系表明，[扩散](@entry_id:141445)的快慢与粒子在流体中感受到的阻力成反比。

更深一层，摩擦系数本身也可以通过一个类似于[格林-久保关系](@entry_id:144763)的公式，与作用在粒子上的总力 $\mathbf{F}(t)$ 的自关联函数（Force Autocorrelation Function, FACF）联系起来。这是涨落-耗散定理的又一个体现：

$$
\zeta = \frac{1}{d k_B T} \int_0^\infty \langle \mathbf{F}(0) \cdot \mathbf{F}(t) \rangle dt
$$

这揭示了耗散（摩擦 $\zeta$）起源于[平衡态](@entry_id:168134)下力的快速涨落。因此，我们获得了计算[扩散](@entry_id:141445)系数的第三条途径：通过计算力的自关联函数得到[摩擦系数](@entry_id:150354)，再通过爱因斯坦-斯摩罗霍夫斯基关系得到[扩散](@entry_id:141445)系数。这三种方法（MSD、VACF、FACF）在理论上是等价的，可以相互印证，为模拟结果的准确性提供了强有力的检验 。

#### 系综与恒温器效应

MD模拟可以在不同的[热力学](@entry_id:141121)系综中进行，如[微正则系综](@entry_id:141513)（NVE）或[正则系综](@entry_id:142391)（NVT）。一个自然的问题是：[扩散](@entry_id:141445)系数的计算是否依赖于所选的系综？

根据[统计力](@entry_id:194984)学原理，在[热力学极限](@entry_id:143061)下（$N \to \infty$），不同系综是等价的。因此，输运系数 $D$ 应该是一个不依赖于系综的物性。然而，在有限尺寸的模拟中，情况有所不同。在[NVT系综](@entry_id:142391)中，为了维持恒定的温度，需要引入**恒温器**（thermostat），它会修改粒子的[运动方程](@entry_id:170720)。

[恒温器](@entry_id:169186)的选择和参数设置对动态性质（如[扩散](@entry_id:141445)系数）的计算至关重要。一个理想的[恒温器](@entry_id:169186)应该在不干扰系统自然动力学的前提下维持温度。这意味着恒温器的作用时间尺度应该远长于我们关心的物理过程的时间尺度（例如VACF的衰减时间）。因此，使用**[弱耦合](@entry_id:140994)**的恒温器（如[Nosé-Hoover链](@entry_id:752682)）通常是计算[输运性质](@entry_id:203130)的首选。相反，如果使用**强耦合**的恒温器，或者某些[随机恒温器](@entry_id:755473)（如[Langevin恒温器](@entry_id:142944)），它们会频繁地改变粒子动量，这会人为地加速速度去关联过程，从而可能导致计算出的[扩散](@entry_id:141445)系数偏高或偏低 。

#### [有限尺寸效应](@entry_id:155681)

在MD模拟中，最普遍采用的边界条件是[周期性边界条件](@entry_id:147809)（PBC）。这虽然避免了表面效应，但引入了另一种被称为**[有限尺寸效应](@entry_id:155681)**（finite-size effect）的系统性误差，这对[扩散](@entry_id:141445)系数的计算影响尤为显著。

其物理根源在于**[动量守恒](@entry_id:149964)**和**[流体力学](@entry_id:136788)相互作用**。当一个示踪粒子在流体中运动时，它会推开周围的流体，产生一个流场。由于[动量守恒](@entry_id:149964)，这个流场会向外传播。在无限大的系统中，这个扰动会无限散开。但在一个具有PBC的有限尺寸盒子中，[粒子产生](@entry_id:158755)的流场会“绕回来”并作用在粒子自身上（或者说，粒子与其自身的周期性“镜像”发生了[流体力学](@entry_id:136788)相互作用）。这种[自相互作用](@entry_id:201333)总是倾向于阻碍粒子的运动，相当于增加了有效的[摩擦力](@entry_id:171772)。

结果是，在有限尺寸的模拟盒子中计算得到的[扩散](@entry_id:141445)系数 $D(L)$ 会系统性地低于其在宏观系统中的真实值 $D(\infty)$。对于一个边长为 $L$ 的立方体盒子，理论和模拟都已证实，这个偏差的主要贡献与盒子尺寸成反比：

$$
D(L) \approx D(\infty) - \frac{\xi k_B T}{6 \pi \eta L}
$$

其中 $\eta$ 是流体的剪切黏度，$\xi$ 是一个取决于盒子几何形状的常数（对于立方体约为2.837）。这个修正的推导可以通过对周期性[排列](@entry_id:136432)的[斯托克斯流](@entry_id:138636)（Stokeslet）进行埃瓦尔德求和，或者从有限尺寸对VACF的[流体力学](@entry_id:136788)[长时尾](@entry_id:139791)（$t^{-d/2}$）的截断效应来理解 。

这一效应意味着，为了得到高精度的[扩散](@entry_id:141445)系数值，必须进行一系列不同尺寸 $L$ 的模拟，然后将得到的 $D(L)$ 对 $1/L$ 作图并外推到 $1/L \to 0$ 的极限，才能消除这种系统误差，获得真正的体相[扩散](@entry_id:141445)系数。