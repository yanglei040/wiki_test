{
    "hands_on_practices": [
        {
            "introduction": "第一个实践练习是我们学习的基石，它将引导你完成从原始原子坐标到最终介电常数的完整计算过程。你将掌握两项基本技能：首先，在周期性边界条件下，正确计算分子的总偶极矩 $\\mathbf{M}$，这需要对边界条件进行细致处理。其次，你将推导并应用连接 $\\mathbf{M}$ 的涨落与宏观介电常数 $\\varepsilon_r$ 的基本涨落公式 。",
            "id": "3407722",
            "problem": "一个边长为 $L = 2.0 \\ \\mathrm{nm}$ 的立方模拟单元包含两个刚性、中性的双原子分子，并采用周期性边界条件 (PBC)。每个分子由两个点电荷 $+q$ 和 $-q$ 组成，其中 $q = 0.5 \\, e$，由长度为 $0.20 \\ \\mathrm{nm}$ 的键连接。提供了三个统计独立的快照。在每个快照中，电荷坐标以折叠坐标的形式给出，即在每个笛卡尔方向上都位于区间 $[0,L)$ 内。体系整体呈电中性。温度为 $T = 300 \\ \\mathrm{K}$。使用以下常数：元电荷 $e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$，真空介电常数 $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F} \\, \\mathrm{m}^{-1}$，玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J} \\, \\mathrm{K}^{-1}$。在计算偶极矩之前，将所有长度单位转换为 $\\mathrm{m}$。\n\n快照（坐标单位为 $\\mathrm{nm}$，电荷单位为 $e$）：\n- 快照 1：\n  - 分子 1：$A_{1}$ 位于 $(0.10, \\ 0.10, \\ 0.10)$，带电荷 $+0.5 \\, e$；$B_{1}$ 位于 $(0.30, \\ 0.10, \\ 0.10)$，带电荷 $-0.5 \\, e$。\n  - 分子 2：$A_{2}$ 位于 $(1.90, \\ 1.90, \\ 0.05)$，带电荷 $+0.5 \\, e$；$B_{2}$ 位于 $(0.10, \\ 1.90, \\ 0.05)$，带电荷 $-0.5 \\, e$。\n- 快照 2：\n  - 分子 1：$A_{1}$ 位于 $(0.30, \\ 0.50, \\ 0.70)$，带电荷 $+0.5 \\, e$；$B_{1}$ 位于 $(0.10, \\ 0.50, \\ 0.70)$，带电荷 $-0.5 \\, e$。\n  - 分子 2：$A_{2}$ 位于 $(0.90, \\ 1.90, \\ 1.95)$，带电荷 $+0.5 \\, e$；$B_{2}$ 位于 $(0.90, \\ 0.10, \\ 1.95)$，带电荷 $-0.5 \\, e$。\n- 快照 3：\n  - 分子 1：$A_{1}$ 位于 $(1.90, \\ 0.20, \\ 1.95)$，带电荷 $+0.5 \\, e$；$B_{1}$ 位于 $(0.10, \\ 0.20, \\ 1.95)$，带电荷 $-0.5 \\, e$。\n  - 分子 2：$A_{2}$ 位于 $(0.50, \\ 0.50, \\ 1.90)$，带电荷 $+0.5 \\, e$；$B_{2}$ 位于 $(0.50, \\ 0.50, \\ 0.10)$，带电荷 $-0.5 \\, e$。\n\n任务：\n1.  对于每个快照，使用基于分子的展开规则计算模拟单元的总偶极矩矢量 $\\mathbf{M}$：对每个双原子分子，选择第二个原子的镜像，使其与成键伙伴的键距最小（等效地，重构分子，使其键是周期性边界条件下最短的镜像）。然后计算分子偶极矩为 $\\sum_{i \\in \\mathrm{mol}} q_{i} \\, \\mathbf{r}_{i}$，并对所有分子求和以获得 $\\mathbf{M}$。\n2.  将这三个快照作为一个等权重系综，计算样本平均值 $\\langle \\mathbf{M} \\rangle$ 和 $\\langle |\\mathbf{M}|^{2} \\rangle$。\n3.  从一个处于均匀、弱、静态电场 $\\mathbf{E}$ 中的体系的正则系综出发（其耦合项为 $-\\mathbf{M} \\cdot \\mathbf{E}$），应用线性响应和旋转各向同性，推导一个表达式，将静态相对介电常数 $\\varepsilon_{r}$ 与零场中总偶极矩 $\\mathbf{M}$ 的平衡涨落联系起来。\n4.  使用你推导的表达式、给定的常数以及步骤2中得到的平均值，数值计算该体系的 $\\varepsilon_{r}$。将最终的 $\\varepsilon_{r}$ 表示为一个无量纲数，并保留四位有效数字。\n5.  简要解释使用基于每个原子的折叠坐标（不使用基于分子的展开）会如何改变计算出的 $\\mathbf{M}$，从而改变步骤4中的结果，并说明在涨落公式中，哪种定义在物理上是合适的。\n\n你最终报告的答案必须是 $\\varepsilon_{r}$ 的单个数值，无单位，并保留四位有效数字。",
            "solution": "该问题要求从一组分子动力学快照中，计算一个由两个刚性双原子分子组成的体系的静态相对介电常数 $\\varepsilon_r$。这涉及几个步骤：使用特定的周期性边界条件展开规则计算每个快照的总偶极矩，计算偶极矩及其模方值的系综平均值，推导关联 $\\varepsilon_r$ 与偶极矩涨落的涨落公式，最后数值计算 $\\varepsilon_r$。此外，还将讨论偶极矩定义的物理有效性。\n\n首先，为了最终计算，将必要的常数和参数转换为国际单位制（SI）单位。\n立方单元的边长：$L = 2.0 \\times 10^{-9} \\ \\mathrm{m}$。\n单元的体积：$V = L^3 = (2.0 \\times 10^{-9} \\ \\mathrm{m})^3 = 8.0 \\times 10^{-27} \\ \\mathrm{m}^3$。\n电荷大小：$q = 0.5 \\, e = 0.5 \\times (1.602176634 \\times 10^{-19} \\ \\mathrm{C}) = 8.01088317 \\times 10^{-20} \\ \\mathrm{C}$。\n温度：$T = 300 \\ \\mathrm{K}$。\n真空介电常数：$\\varepsilon_{0} = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F} \\, \\mathrm{m}^{-1}$。\n玻尔兹曼常数：$k_{B} = 1.380649 \\times 10^{-23} \\ \\mathrm{J} \\, \\mathrm{K}^{-1}$。\n\n为方便起见，偶极矩的计算将以 $e \\cdot \\mathrm{nm}$ 为单位进行，并在最后阶段转换为国际单位制。偶极矩平方的转换因子是 $(1 \\ e \\cdot \\mathrm{nm})^2 = ((1.602176634 \\times 10^{-19} \\ \\mathrm{C}) \\times (10^{-9} \\ \\mathrm{m}))^2 = 2.5669699 \\times 10^{-56} \\ (\\mathrm{C} \\cdot \\mathrm{m})^2$。\n\n任务1：计算每个快照的总偶极矩矢量 $\\mathbf{M}$。\n一个在 $\\mathbf{r}_{+}$ 处带电荷 $+q$ 和在 $\\mathbf{r}_{-}$ 处带电荷 $-q$ 的双原子分子的偶极矩为 $\\boldsymbol{\\mu} = q(\\mathbf{r}_{+} - \\mathbf{r}_{-})$。矢量 $\\mathbf{d} = \\mathbf{r}_{+} - \\mathbf{r}_{-}$ 是键矢量，必须在周期性边界条件（PBC）下使用最小镜像约定进行重构。模拟单元的总偶极矩 $\\mathbf{M}$ 是各个分子偶极矩的矢量和，$\\mathbf{M} = \\sum_j \\boldsymbol{\\mu}_j$。我们把带电荷 $+q$ 的位置记为 $\\mathbf{r}_A$，带电荷 $-q$ 的位置记为 $\\mathbf{r}_B$。电荷大小为 $q=0.5 \\, e$。\n\n快照1：\n分子1：$\\mathbf{r}_{A1} = (0.10, 0.10, 0.10) \\ \\mathrm{nm}$，$\\mathbf{r}_{B1} = (0.30, 0.10, 0.10) \\ \\mathrm{nm}$。\n键矢量 $\\mathbf{d}_1 = \\mathbf{r}_{A1} - \\mathbf{r}_{B1} = (-0.20, 0, 0) \\ \\mathrm{nm}$。该矢量的模为 $0.20 \\ \\mathrm{nm}$，因此不需要PBC校正。\n$\\boldsymbol{\\mu}_1 = q \\mathbf{d}_1 = 0.5 \\, e \\times (-0.20, 0, 0) \\ \\mathrm{nm} = (-0.10, 0, 0) \\ e \\cdot \\mathrm{nm}$。\n分子2：$\\mathbf{r}_{A2} = (1.90, 1.90, 0.05) \\ \\mathrm{nm}$，$\\mathbf{r}_{B2} = (0.10, 1.90, 0.05) \\ \\mathrm{nm}$。\n折叠的键矢量为 $\\mathbf{r}_{A2} - \\mathbf{r}_{B2} = (1.80, 0, 0) \\ \\mathrm{nm}$。\n对于 $L=2.0 \\ \\mathrm{nm}$，应用最小镜像约定，我们从x分量中减去L：$1.80 - 2.0 = -0.20$。\n展开的键矢量 $\\mathbf{d}_2 = (-0.20, 0, 0) \\ \\mathrm{nm}$。\n$\\boldsymbol{\\mu}_2 = q \\mathbf{d}_2 = 0.5 \\, e \\times (-0.20, 0, 0) \\ \\mathrm{nm} = (-0.10, 0, 0) \\ e \\cdot \\mathrm{nm}$。\n总偶极矩 $\\mathbf{M}_1 = \\boldsymbol{\\mu}_1 + \\boldsymbol{\\mu}_2 = (-0.20, 0, 0) \\ e \\cdot \\mathrm{nm}$。\n$|\\mathbf{M}_1|^2 = (-0.20)^2 = 0.040 \\ (e \\cdot \\mathrm{nm})^2$。\n\n快照2：\n分子1：$\\mathbf{r}_{A1} = (0.30, 0.50, 0.70) \\ \\mathrm{nm}$，$\\mathbf{r}_{B1} = (0.10, 0.50, 0.70) \\ \\mathrm{nm}$。\n键矢量 $\\mathbf{d}_1 = \\mathbf{r}_{A1} - \\mathbf{r}_{B1} = (0.20, 0, 0) \\ \\mathrm{nm}$。\n$\\boldsymbol{\\mu}_1 = q \\mathbf{d}_1 = 0.5 \\, e \\times (0.20, 0, 0) \\ \\mathrm{nm} = (0.10, 0, 0) \\ e \\cdot \\mathrm{nm}$。\n分子2：$\\mathbf{r}_{A2} = (0.90, 1.90, 1.95) \\ \\mathrm{nm}$，$\\mathbf{r}_{B2} = (0.90, 0.10, 1.95) \\ \\mathrm{nm}$。\n折叠的键矢量为 $\\mathbf{r}_{A2} - \\mathbf{r}_{B2} = (0, 1.80, 0) \\ \\mathrm{nm}$。y分量的最小镜像是 $1.80 - 2.0 = -0.20$。\n展开的键矢量 $\\mathbf{d}_2 = (0, -0.20, 0) \\ \\mathrm{nm}$。\n$\\boldsymbol{\\mu}_2 = q \\mathbf{d}_2 = 0.5 \\, e \\times (0, -0.20, 0) \\ \\mathrm{nm} = (0, -0.10, 0) \\ e \\cdot \\mathrm{nm}$。\n总偶极矩 $\\mathbf{M}_2 = \\boldsymbol{\\mu}_1 + \\boldsymbol{\\mu}_2 = (0.10, -0.10, 0) \\ e \\cdot \\mathrm{nm}$。\n$|\\mathbf{M}_2|^2 = (0.10)^2 + (-0.10)^2 = 0.010 + 0.010 = 0.020 \\ (e \\cdot \\mathrm{nm})^2$。\n\n快照3：\n分子1：$\\mathbf{r}_{A1} = (1.90, 0.20, 1.95) \\ \\mathrm{nm}$，$\\mathbf{r}_{B1} = (0.10, 0.20, 1.95) \\ \\mathrm{nm}$。\n折叠的键矢量为 $\\mathbf{r}_{A1} - \\mathbf{r}_{B1} = (1.80, 0, 0) \\ \\mathrm{nm}$。x分量的最小镜像是 $1.80 - 2.0 = -0.20$。\n展开的键矢量 $\\mathbf{d}_1 = (-0.20, 0, 0) \\ \\mathrm{nm}$。\n$\\boldsymbol{\\mu}_1 = q \\mathbf{d}_1 = 0.5 \\, e \\times (-0.20, 0, 0) \\ \\mathrm{nm} = (-0.10, 0, 0) \\ e \\cdot \\mathrm{nm}$。\n分子2：$\\mathbf{r}_{A2} = (0.50, 0.50, 1.90) \\ \\mathrm{nm}$，$\\mathbf{r}_{B2} = (0.50, 0.50, 0.10) \\ \\mathrm{nm}$。\n折叠的键矢量为 $\\mathbf{r}_{A2} - \\mathbf{r}_{B2} = (0, 0, 1.80) \\ \\mathrm{nm}$。z分量的最小镜像是 $1.80 - 2.0 = -0.20$。\n展开的键矢量 $\\mathbf{d}_2 = (0, 0, -0.20) \\ \\mathrm{nm}$。\n$\\boldsymbol{\\mu}_2 = q \\mathbf{d}_2 = 0.5 \\, e \\times (0, 0, -0.20) \\ \\mathrm{nm} = (0, 0, -0.10) \\ e \\cdot \\mathrm{nm}$。\n总偶极矩 $\\mathbf{M}_3 = \\boldsymbol{\\mu}_1 + \\boldsymbol{\\mu}_2 = (-0.10, 0, -0.10) \\ e \\cdot \\mathrm{nm}$。\n$|\\mathbf{M}_3|^2 = (-0.10)^2 + (-0.10)^2 = 0.010 + 0.010 = 0.020 \\ (e \\cdot \\mathrm{nm})^2$。\n\n任务2：计算样本平均值 $\\langle \\mathbf{M} \\rangle$ 和 $\\langle |\\mathbf{M}|^2 \\rangle$。\n该系综由3个快照组成，每个快照的权重相等，为1/3。\n$\\langle \\mathbf{M} \\rangle = \\frac{1}{3} (\\mathbf{M}_1 + \\mathbf{M}_2 + \\mathbf{M}_3) = \\frac{1}{3} ((-0.20, 0, 0) + (0.10, -0.10, 0) + (-0.10, 0, -0.10))$。\n$\\langle \\mathbf{M} \\rangle = \\frac{1}{3} (-0.20 + 0.10 - 0.10, \\, 0 - 0.10 + 0, \\, 0 + 0 - 0.10) = \\frac{1}{3} (-0.20, -0.10, -0.10) \\ e \\cdot \\mathrm{nm}$。\n$|\\langle \\mathbf{M} \\rangle|^2 = \\left( \\frac{-0.20}{3} \\right)^2 + \\left( \\frac{-0.10}{3} \\right)^2 + \\left( \\frac{-0.10}{3} \\right)^2 = \\frac{0.040 + 0.010 + 0.010}{9} = \\frac{0.060}{9} = \\frac{0.020}{3} \\ (e \\cdot \\mathrm{nm})^2$。\n$\\langle |\\mathbf{M}|^2 \\rangle = \\frac{1}{3} (|\\mathbf{M}_1|^2 + |\\mathbf{M}_2|^2 + |\\mathbf{M}_3|^2) = \\frac{1}{3} (0.040 + 0.020 + 0.020) = \\frac{0.080}{3} \\ (e \\cdot \\mathrm{nm})^2$。\n\n任务3：推导关联 $\\varepsilon_r$ 与 $\\mathbf{M}$ 涨落的表达式。\n考虑一个哈密顿量为 $H_0$ 的体系，置于一个弱的、静态的、均匀的电场 $\\mathbf{E}$ 中。相互作用能为 $H_{int} = - \\mathbf{M} \\cdot \\mathbf{E}$。配分函数为 $Z(\\mathbf{E}) = \\int \\exp\\left(-\\frac{H_0 - \\mathbf{M} \\cdot \\mathbf{E}}{k_B T}\\right) d\\Gamma$。总偶极矩的系综平均值为 $\\langle \\mathbf{M} \\rangle_{\\mathbf{E}} = k_B T \\frac{\\partial \\ln Z}{\\partial \\mathbf{E}}$。\n线性电极化率张量定义为 $\\langle M_\\alpha \\rangle_{\\mathbf{E}} - \\langle M_\\alpha \\rangle_0 = \\sum_\\beta \\chi_{\\alpha\\beta} V E_\\beta$，其中 $\\langle \\cdot \\rangle_0$ 表示在零场下的平均值，$\\chi_{\\alpha\\beta}$ 是单位体积的电极化率。对于各向同性介质，宏观静电学将极化强度 $\\mathbf{P} = (\\langle \\mathbf{M} \\rangle_{\\mathbf{E}} - \\langle \\mathbf{M} \\rangle_0)/V$ 与电场通过 $\\mathbf{P} = \\varepsilon_0 (\\varepsilon_r - 1) \\mathbf{E}$ 联系起来，因此 $\\chi_{\\alpha\\beta}=\\varepsilon_0 (\\varepsilon_r - 1) \\delta_{\\alpha\\beta}$。\n电极化率也可以从线性响应理论得到：$\\frac{\\partial \\langle M_\\alpha \\rangle_{\\mathbf{E}}}{\\partial E_\\beta}|_{\\mathbf{E}=0} = \\frac{1}{k_B T} (\\langle M_\\alpha M_\\beta \\rangle_0 - \\langle M_\\alpha \\rangle_0 \\langle M_\\beta \\rangle_0)$。\n因此，$\\chi_{\\alpha\\beta} V = \\frac{1}{k_B T} (\\langle M_\\alpha M_\\beta \\rangle_0 - \\langle M_\\alpha \\rangle_0 \\langle M_\\beta \\rangle_0)$。\n对于各向同性体系，我们可以对对角元素进行平均：$\\frac{1}{3}\\sum_\\alpha \\chi_{\\alpha\\alpha} V = \\varepsilon_0 (\\varepsilon_r - 1) V = \\frac{1}{3 k_B T} \\sum_\\alpha (\\langle M_\\alpha^2 \\rangle_0 - \\langle M_\\alpha \\rangle_0^2)$。\n这可以简化为 $\\varepsilon_0 (\\varepsilon_r - 1) V = \\frac{1}{3 k_B T} (\\langle |\\mathbf{M}|^2 \\rangle_0 - |\\langle \\mathbf{M} \\rangle_0|^2)$。\n重新整理得到所需的涨落公式：\n$$ \\varepsilon_r - 1 = \\frac{\\langle |\\mathbf{M}|^2 \\rangle_0 - |\\langle \\mathbf{M} \\rangle_0|^2}{3 \\varepsilon_0 V k_B T} $$\n这将介电常数与零场系综中总偶极矩的方差联系起来。\n\n任务4：对此体系数值计算 $\\varepsilon_r$。\n我们使用任务2中计算的样本平均值作为真实系综平均值的估计。\n分子中的涨落项是 $\\langle |\\mathbf{M}|^2 \\rangle - |\\langle \\mathbf{M} \\rangle|^2 = \\frac{0.080}{3} - \\frac{0.020}{3} = \\frac{0.060}{3} = 0.020 \\ (e \\cdot \\mathrm{nm})^2$。\n将其转换为国际单位制：\n分子 $= 0.020 \\times (2.5669699 \\times 10^{-56} \\ (\\mathrm{C} \\cdot \\mathrm{m})^2) = 5.1339398 \\times 10^{-58} \\ (\\mathrm{C} \\cdot \\mathrm{m})^2$。\n现在，计算分母 $3 \\varepsilon_0 V k_B T$：\n分母 $= 3 \\times (8.8541878128 \\times 10^{-12} \\ \\mathrm{F} \\, \\mathrm{m}^{-1}) \\times (8.0 \\times 10^{-27} \\ \\mathrm{m}^3) \\times (1.380649 \\times 10^{-23} \\ \\mathrm{J} \\, \\mathrm{K}^{-1}) \\times (300 \\ \\mathrm{K})$。\n分母 $= 8.798917 \\times 10^{-58} \\ \\mathrm{C}^2 \\cdot \\mathrm{m}^2 \\cdot \\mathrm{J}^{-1}$。（注：$F \\cdot J = (C/V) \\cdot (CV) = C^2$，单位匹配）。\n现在，计算 $\\varepsilon_r$：\n$\\varepsilon_r - 1 = \\frac{5.1339398 \\times 10^{-58}}{8.798917 \\times 10^{-58}} = 0.58348...$\n$\\varepsilon_r = 1 + 0.58348... = 1.58348...$\n保留四位有效数字，$\\varepsilon_r \\approx 1.583$。\n\n任务5：关于使用折叠坐标与展开坐标的解释。\n使用基于每个原子的折叠坐标 $\\mathbf{r}'_i \\in [0,L)$ 来计算总偶极矩 $\\mathbf{M}_{\\text{wrapped}} = \\sum_i q_i \\mathbf{r}'_i$ 将导致物理上不正确的结果。$\\mathbf{M}_{\\text{wrapped}}$ 的值取决于分子在模拟盒子中的绝对位置，而不仅仅是它们的相对取向。对于跨越周期性边界的分子，这一定义会产生任意大的、非物理的偶极矩。例如，在快照1中，分子2靠近 $x=L$ 边界。其两个原子的折叠坐标相距很远，沿x轴产生了一个很大的偶极矩贡献，这是盒子约定的产物。对于周期性体系，这个量不是良定义的，因为它依赖于原点的选择。\n用于计算 $\\varepsilon_r$ 的涨落公式旨在捕捉体材料对电场的响应。这种响应是由于分子偶极矩的取向排列。物理上合适的量是各个分子偶极矩的总和，$\\mathbf{M} = \\sum_j \\boldsymbol{\\mu}_j$，其中每个 $\\boldsymbol{\\mu}_j$ 都是根据展开的键矢量计算的。这个量 $\\mathbf{M}$ 正确地表示了包含在模拟体积内的材料的总偶极矩，其涨落与分子间的取向相关性有关。使用 $\\mathbf{M}_{\\text{wrapped}}$ 会引入大的、虚假的涨落，这些涨落取决于分子穿越盒子的任意移动，从而得出一个被严重高估且不正确的介电常数。因此，基于分子的展开程序对于进行有物理意义的计算至关重要。",
            "answer": "$$\n\\boxed{1.583}\n$$"
        },
        {
            "introduction": "任何数值估算若没有不确定性的衡量都是不完整的。最后一个实践练习将深入探讨从有限长度的模拟中报告可靠介电常数所需的严格统计分析 。你将探索由积分自相关时间 ($\\tau_{\\mathrm{int}}$) 量化的数据点之间的时间相关性如何影响统计误差，并学习应用强大的块平均法为你的估算构建一个有效的置信区间。",
            "id": "3407731",
            "problem": "您正在使用分子动力学研究一种处于平衡态的、各向同性的极性液体，并试图通过总偶极矩矢量的涨落来估计其静态相对介电常数（也称为介电常数）。您模拟了一个平稳的总偶极矩矢量时间序列 $\\mathbf{M}(t) = \\left(M_x(t), M_y(t), M_z(t)\\right)$，以均匀的时间间隔 $\\Delta t$ 采样了 $N$ 个样本。假设以下符合物理实际的建模假设全程成立：(i) 分量 $M_x(t)$、$M_y(t)$ 和 $M_z(t)$ 是联合高斯分布、零均值、同分布且在相等时间点不相关的，每个分量的方差为 $\\sigma_M^2$；(ii) 动力学过程是平稳且混合的（mixing）；(iii) 每个笛卡尔分量的归一化自相关函数在一个由积分自相关时间（Integrated Autocorrelation Time, IAT）$\\tau_{\\mathrm{int}}$ 捕捉的单一主导时间尺度上衰减，其定义为 $\\tau_{\\mathrm{int}} \\equiv \\int_0^\\infty \\rho_M(t) \\, dt$，其中 $\\rho_M(t)$ 是 $M_x(t)$ 的归一化自相关函数，并且相同的 $\\tau_{\\mathrm{int}}$ 也表征了控制 $Q(t) \\equiv \\|\\mathbf{M}(t)\\|^2$ 相关性的最慢模式。\n\n在国际单位制（SI）下进行计算，并假设各向同性，因此待估计的介电常数可由线性响应和涨落-耗散理论应用于体积为 $V$、绝对温度为 $T$ 的有限周期性盒子中的极化涨落得到。真空介电常数为 $\\varepsilon_0$，玻尔兹曼常数为 $k_{\\mathrm{B}}$。\n\n您的任务如下：\n\n1) 从各向同性体系统的相对介电常数基于平衡极化涨落的定义出发，并利用热力学涨落-响应关系，推导估计量 $\\widehat{\\varepsilon}_r$ 的表达式，该表达式应使用 $Q(t) \\equiv \\|\\mathbf{M}(t)\\|^2$ 的时间平均值、体积 $V$、绝对温度 $T$、真空介电常数 $\\varepsilon_0$ 和玻尔兹曼常数 $k_{\\mathrm{B}}$ 来表示。然后，利用上述假设，将此表达式简化为仅依赖于单分量方差 $\\sigma_M^2$ 的形式。\n\n2) 在高斯和各向同性假设下，计算瞬时标量可观测量 $Q(t) = \\|\\mathbf{M}(t)\\|^2$ 的方差，并用 $\\sigma_M^2$ 表示。\n\n3) 利用积分自相关时间（IAT）的定义和针对相关平稳过程的中心极限定理，推导在总时间 $T_{\\mathrm{tot}} \\equiv N \\Delta t$ 固定且 $N$ 很大的极限下，从间距为 $\\Delta t$ 的 $N$ 个样本得到的 $Q(t)$ 的时间平均值的方差的主导阶表达式。然后，通过误差传递，得到 $\\widehat{\\varepsilon}_r$ 的主导阶渐近标准误差。\n\n4) 设计一种分块平均策略，基于 $Q(t)$ 的 $B$ 个块均值来构建 $\\widehat{\\varepsilon}_r$ 的 $95\\%$ 置信区间（CI）。其中每个块的时长为 $L$，块的数量为 $B \\equiv \\left\\lfloor T_{\\mathrm{tot}} / L \\right\\rfloor$。施加两个设计约束以确保统计有效性和估计器稳定性：(a) 独立性代理：$L \\ge m \\, \\tau_{\\mathrm{int}}$，其中 $m$ 是用户指定的乘数；(b) 最小块数：$B \\ge B_{\\min}$，其中 $B_{\\min}$ 是用户指定的最小块数。使用自由度为 $B-1$ 的 Student-$t$ 临界值来近似 $95\\%$ CI 半宽 $H(L)$，展示 $H(L)$ 如何依赖于第 2) 和 3) 部分推导出的量，并解释仅通过 $t$ 乘子保留的定性 $L$ 依赖关系。\n\n5) 算法设计：给定数值 $N$、$\\Delta t$、$\\tau_{\\mathrm{int}}$、$\\sigma_M^2$、$T$、$V$、目标半宽 $\\delta_{\\mathrm{target}}$（无量纲，用于相对介电常数）、块独立性乘数 $m$ 和最小块数 $B_{\\min}$，设计一个算法，该算法能够：\n- 计算以时间步为单位的最小块长度 $L_{\\mathrm{steps}}^\\star$，其定义为满足 $L \\ge m \\, \\tau_{\\mathrm{int}}$ 和 $B \\ge B_{\\min}$ 的最小块长（以时间步数为单位）。\n- 使用自由度为 $B-1$ 的 Student-$t$ 临界值以及第 2) 和 3) 部分得到的主导阶方差公式，计算与 $L_{\\mathrm{steps}}^\\star$ 对应的 $\\widehat{\\varepsilon}_r$ 的 $95\\%$ CI 半宽 $H^\\star$。\n- 判断目标是否达成，即返回一个布尔标志，指示 $H^\\star \\le \\delta_{\\mathrm{target}}$ 是否成立。如果不存在同时满足两个约束的 $L$，则声明对于给定的轨迹和约束，目标无法实现。\n\n6) 实现：编写一个完整、可运行的程序，实现上述算法，并在一组测试集上对其进行评估。对于每个测试，程序必须输出一个条目，包含：\n- 一个布尔值，指示在约束条件下目标半宽是否可实现，\n- 以时间步为单位的最小块长度 $L_{\\mathrm{steps}}^\\star$（如果不可实现，则使用 $-1$），\n- 计算出的 $95\\%$ CI 半宽 $H^\\star$（如果不可实现，则使用 $-1.0$），\n- 模型参数所蕴含的点估计值 $\\widehat{\\varepsilon}_r$。\n\n在程序中使用以下 SI 单位的物理常数：\n- $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\ \\mathrm{J} \\ \\mathrm{K}^{-1}$，\n- $\\varepsilon_0 = 8.8541878128 \\times 10^{-12} \\ \\mathrm{F} \\ \\mathrm{m}^{-1}$。\n\n对于所有测试，使用相同的体积和温度，以及与类水液体一致的相同的单分量方差：\n- $V = 2.7 \\times 10^{-26} \\ \\mathrm{m}^3$，\n- $T = 300 \\ \\mathrm{K}$，\n- $\\sigma_M^2 = 3.70 \\times 10^{-56} \\ (\\mathrm{C} \\cdot \\mathrm{m})^2$。\n\n硬编码在程序中的测试集参数：\n\n- 测试 1 (理想情况，类水，快速退相关):\n  - $N = 100000000$，\n  - $\\Delta t = 2.0 \\times 10^{-15} \\ \\mathrm{s}$，\n  - $\\tau_{\\mathrm{int}} = 5.0 \\times 10^{-12} \\ \\mathrm{s}$，\n  - $\\delta_{\\mathrm{target}} = 0.5$，\n  - $m = 10$，\n  - $B_{\\min} = 20$。\n\n- 测试 2 (对于相同目标，轨迹过短):\n  - $N = 10000000$，\n  - $\\Delta t = 2.0 \\times 10^{-15} \\ \\mathrm{s}$，\n  - $\\tau_{\\mathrm{int}} = 5.0 \\times 10^{-12} \\ \\mathrm{s}$，\n  - $\\delta_{\\mathrm{target}} = 0.5$，\n  - $m = 10$，\n  - $B_{\\min} = 20$。\n\n- 测试 3 (对于相同目标，近乎不相关的采样):\n  - $N = 100000$，\n  - $\\Delta t = 2.0 \\times 10^{-15} \\ \\mathrm{s}$，\n  - $\\tau_{\\mathrm{int}} = 2.0 \\times 10^{-15} \\ \\mathrm{s}$，\n  - $\\delta_{\\mathrm{target}} = 0.3$，\n  - $m = 10$，\n  - $B_{\\min} = 20$。\n\n- 测试 4 (慢速退相关，放宽的目标):\n  - $N = 100000000$，\n  - $\\Delta t = 2.0 \\times 10^{-15} \\ \\mathrm{s}$，\n  - $\\tau_{\\mathrm{int}} = 5.0 \\times 10^{-11} \\ \\mathrm{s}$，\n  - $\\delta_{\\mathrm{target}} = 1.5$，\n  - $m = 10$，\n  - $B_{\\min} = 20$。\n\n本问题不涉及角度单位。所有与介电常数或其不确定性相关的输出都是无量纲的。块长度必须以时间步数报告。\n\n最终输出格式要求：您的程序应生成单行输出，其中包含四个测试的结果。结果是一个用方括号括起来的逗号分隔列表，其中每个测试结果本身都是 $[\\text{achievable}, L_{\\mathrm{steps}}^\\star, H^\\star, \\widehat{\\varepsilon}_r]$ 形式的列表。布尔值必须打印为字面量 $True$ 或 $False$，整数必须打印为十进制数字，浮点数必须精确到小数点后六位。例如，包含两个假设结果的输出应如下所示：$[[True,123,0.123456,42.000000],[False,-1,-1.000000,42.000000]]$。",
            "solution": "我们首先建立基于涨落的相对介电常数估计量，然后量化其在时间相关性下的统计不确定性，最后开发一种分块平均设计，以提供一个实用的置信区间（CI）。\n\n首先，对于国际单位制（SI）中的各向同性体系统，在没有外部电场的情况下，涨落-响应关系将静态电极化率与总偶极矩的平衡涨落联系起来。对于体积为 $V$、绝对温度为 $T$ 的立方周期性盒子，各向同性的相对介电常数 $\\varepsilon_r$ 可以用偶极矩模平方的平衡矩来表示。令 $Q(t) \\equiv \\|\\mathbf{M}(t)\\|^2 = M_x(t)^2 + M_y(t)^2 + M_z(t)^2$。在各向同性和平稳性条件下，平衡系综平均满足\n$$\n\\varepsilon_r \\;=\\; 1 \\;+\\; \\frac{\\langle Q \\rangle - \\|\\langle \\mathbf{M} \\rangle\\|^2}{3 \\, \\varepsilon_0 \\, V \\, k_{\\mathrm{B}} \\, T} \\, .\n$$\n对于零均值的平稳液体，$\\langle \\mathbf{M} \\rangle = \\mathbf{0}$，因此通过将系综平均替换为长轨迹上的时间平均所获得的估计量为\n$$\n\\widehat{\\varepsilon}_r \\;=\\; 1 \\;+\\; \\frac{\\overline{Q}}{3 \\, \\varepsilon_0 \\, V \\, k_{\\mathrm{B}} \\, T} \\, ,\n$$\n其中 $\\overline{Q}$ 是 $Q(t)$ 的时间平均值。在零均值的各向同性高斯假设下，单分量方差为 $\\sigma_M^2 = \\langle M_x^2 \\rangle = \\langle M_y^2 \\rangle = \\langle M_z^2 \\rangle$，因此\n$$\n\\langle Q \\rangle \\;=\\; \\langle M_x^2 + M_y^2 + M_z^2 \\rangle \\;=\\; 3 \\, \\sigma_M^2 \\, .\n$$\n因此，点估计简化为\n$$\n\\widehat{\\varepsilon}_r \\;=\\; 1 \\;+\\; \\frac{\\sigma_M^2}{\\varepsilon_0 \\, V \\, k_{\\mathrm{B}} \\, T} \\, .\n$$\n\n其次，我们在高斯各向同性模型下计算 $Q$ 的瞬时方差。如果 $X \\sim \\mathcal{N}(0,\\sigma^2)$，那么 $X^2$ 的均值为 $\\sigma^2$，方差为 $2 \\sigma^4$。对于具有相同方差 $\\sigma_M^2$ 的独立分量 $M_x$、$M_y$、$M_z$，我们有\n$$\nQ \\;=\\; M_x^2 + M_y^2 + M_z^2 \\, ,\n$$\n其中\n$$\n\\mathbb{E}[Q] \\;=\\; 3 \\, \\sigma_M^2 \\, , \\qquad \\mathrm{Var}(Q) \\;=\\; \\mathrm{Var}(M_x^2) + \\mathrm{Var}(M_y^2) + \\mathrm{Var}(M_z^2) \\;=\\; 3 \\cdot 2 \\, \\sigma_M^4 \\;=\\; 6 \\, \\sigma_M^4 \\, .\n$$\n\n第三，我们量化相关采样下的统计不确定性。设 $Q(t)$ 是平稳的，其自协方差为 $C_Q(\\tau)$，归一化自相关为 $\\rho_Q(\\tau) = C_Q(\\tau)/C_Q(0)$。在标准的混合条件下，在总时间 $T_{\\mathrm{tot}} = N \\Delta t$ 内的时间平均值 $\\overline{Q}$ 的方差具有以下主导阶形式\n$$\n\\mathrm{Var}(\\overline{Q}) \\;\\approx\\; \\frac{\\mathrm{Var}(Q)}{T_{\\mathrm{tot}}} \\, 2 \\, \\tau_{\\mathrm{int}} \\, ,\n$$\n其中 $\\tau_{\\mathrm{int}} = \\int_0^\\infty \\rho_Q(\\tau) \\, d\\tau$ 是 $Q$ 的积分自相关时间（IAT）。根据假设，控制 $Q$ 退相关的最慢模式由与 $M_x$ 相同的 $\\tau_{\\mathrm{int}}$ 捕捉，因此我们使用相同的符号。将此不确定性通过 $\\widehat{\\varepsilon}_r$ 的线性估计器进行传播，得到\n$$\n\\mathrm{Var}(\\widehat{\\varepsilon}_r) \\;\\approx\\; \\frac{\\mathrm{Var}(\\overline{Q})}{\\left(3 \\, \\varepsilon_0 \\, V \\, k_{\\mathrm{B}} \\, T\\right)^2}\n\\;=\\; \\frac{2 \\, \\tau_{\\mathrm{int}}}{T_{\\mathrm{tot}}} \\cdot \\frac{\\mathrm{Var}(Q)}{\\left(3 \\, \\varepsilon_0 \\, V \\, k_{\\mathrm{B}} \\, T\\right)^2} \\, .\n$$\n使用 $\\mathrm{Var}(Q) = 6 \\, \\sigma_M^4$，渐近标准误差为\n$$\n\\mathrm{SE}_\\infty(\\widehat{\\varepsilon}_r) \\;\\approx\\; \\frac{\\sqrt{6 \\, \\sigma_M^4 \\cdot 2 \\, \\tau_{\\mathrm{int}} / T_{\\mathrm{tot}}}}{3 \\, \\varepsilon_0 \\, V \\, k_{\\mathrm{B}} \\, T} \\, .\n$$\n\n第四，我们构建一个分块平均置信区间（CI）。将轨迹划分为 $B = \\left\\lfloor T_{\\mathrm{tot}}/L \\right\\rfloor$ 个时长为 $L$ 的不重叠块。令 $\\overline{Q}^{(b)}$ 为块 $b$ 内 $Q$ 的均值。如果 $L \\gg \\tau_{\\mathrm{int}}$，则块均值近似独立同分布，且\n$$\n\\mathrm{Var}\\!\\left(\\overline{Q}^{(b)}\\right) \\;\\approx\\; \\frac{2 \\, \\tau_{\\mathrm{int}}}{L} \\, \\mathrm{Var}(Q) \\, .\n$$\n块均值的总平均值等于完整轨迹的平均值 $\\overline{Q}$，其方差为\n$$\n\\mathrm{Var}(\\overline{Q}) \\;\\approx\\; \\frac{1}{B} \\, \\mathrm{Var}\\!\\left(\\overline{Q}^{(b)}\\right) \\;\\approx\\; \\frac{2 \\, \\tau_{\\mathrm{int}}}{L B} \\, \\mathrm{Var}(Q) \\;=\\; \\frac{2 \\, \\tau_{\\mathrm{int}}}{T_{\\mathrm{tot}}} \\, \\mathrm{Var}(Q) \\, ,\n$$\n这与大样本公式一致，表明在使用有限数量的块时，CI 半宽的残余 $L$ 依赖性仅通过 Student-$t$ 乘子进入。具体来说，如果 $\\widehat{s}_{\\mathrm{blk}}^2$ 是 $B$ 个块均值的样本方差，而 $t_{0.975,\\nu}$ 是自由度为 $\\nu = B-1$ 的 Student-$t$ 分布的 $0.975$ 分位数，那么 $\\overline{Q}$ 的 $95\\%$ CI 半宽近似为\n$$\nH_Q(L) \\;\\approx\\; t_{0.975,B-1} \\, \\sqrt{\\frac{\\widehat{s}_{\\mathrm{blk}}^2}{B}} \\;\\approx\\; t_{0.975,B-1} \\, \\sqrt{\\frac{2 \\, \\tau_{\\mathrm{int}}}{T_{\\mathrm{tot}}} \\, \\mathrm{Var}(Q)} \\, .\n$$\n传播到 $\\widehat{\\varepsilon}_r$ 上得到\n$$\nH(L) \\;\\approx\\; \\frac{t_{0.975,B-1}}{3 \\, \\varepsilon_0 \\, V \\, k_{\\mathrm{B}} \\, T} \\, \\sqrt{\\frac{2 \\, \\tau_{\\mathrm{int}}}{T_{\\mathrm{tot}}} \\, \\mathrm{Var}(Q)} \\;=\\; \\frac{t_{0.975,B-1}}{3 \\, \\varepsilon_0 \\, V \\, k_{\\mathrm{B}} \\, T} \\, \\sqrt{\\frac{2 \\, \\tau_{\\mathrm{int}}}{T_{\\mathrm{tot}}} \\cdot 6 \\, \\sigma_M^4} \\, .\n$$\n因此，主导的 $L$ 依赖性完全通过 $t_{0.975,B-1}$ 体现，该值随着 $B$ 的减小而温和增长，而核心方差则与 $T_{\\mathrm{tot}}$ 和 $\\tau_{\\mathrm{int}}$ 成比例。\n\n第五，我们设计算法以在约束条件下实现目标 CI 半宽。令 $T_{\\mathrm{tot}} = N \\Delta t$。通过要求 $L \\ge m \\, \\tau_{\\mathrm{int}}$ 来强制执行独立性代理，其中 $m$ 是一个乘数；在满足此条件的 $L$ 中，选择最小的以最大化块数。同时要求最小块数 $B \\ge B_{\\min}$ 以保证方差估计的稳定性。定义以时间步为单位的最小允许块大小为\n$$\nL_{\\mathrm{steps}}^\\star \\;=\\; \\left\\lceil \\frac{m \\, \\tau_{\\mathrm{int}}}{\\Delta t} \\right\\rceil \\, .\n$$\n计算 $B = \\left\\lfloor \\frac{N}{L_{\\mathrm{steps}}^\\star} \\right\\rfloor$。如果 $B  B_{\\min}$，则没有块大小能同时满足两个约束，因为进一步增加 $L$ 只会减少 $B$。在这种情况下，声明目标不可实现。否则，在 $B \\ge B_{\\min}$ 的情况下，计算 $t_{0.975,B-1}$ 并评估\n$$\nH^\\star \\;=\\; \\frac{t_{0.975,B-1}}{3 \\, \\varepsilon_0 \\, V \\, k_{\\mathrm{B}} \\, T} \\, \\sqrt{\\frac{2 \\, \\tau_{\\mathrm{int}}}{T_{\\mathrm{tot}}} \\cdot 6 \\, \\sigma_M^4} \\, .\n$$\n将 $H^\\star$ 与目标 $\\delta_{\\mathrm{target}}$ 进行比较；如果 $H^\\star \\le \\delta_{\\mathrm{target}}$，则声明可实现。否则，注意到增加 $L$ 只会减少 $B$ 并增加 $t_{0.975,B-1}$，因此半宽不会减小；因此，在给定的 $T_{\\mathrm{tot}}$ 和约束下，目标是不可实现的。\n\n最后，我们实现程序。对于每个测试，我们计算 $\\widehat{\\varepsilon}_r = 1 + \\sigma_M^2 / (\\varepsilon_0 V k_{\\mathrm{B}} T)$，然后计算最小允许的 $L_{\\mathrm{steps}}^\\star$、相应的 $B$，以及半宽 $H^\\star$ 或不可实现的占位符。输出为单行：一个包含四个项目（每个测试一个）的列表，每个项目本身是 $[\\text{achievable}, L_{\\mathrm{steps}}^\\star, H^\\star, \\widehat{\\varepsilon}_r]$ 形式的列表，其中浮点数打印到小数点后六位，块长度（以步数计）为整数。\n\n定性地，结果将表明：\n- 对于固定的 $T_{\\mathrm{tot}}$，较大的 $\\tau_{\\mathrm{int}}$ 会使 CI 膨胀因子 $\\sqrt{\\tau_{\\mathrm{int}}}$。\n- 对于固定的 $\\tau_{\\mathrm{int}}$，增加 $T_{\\mathrm{tot}}$ 会使 CI 按 $1/\\sqrt{T_{\\mathrm{tot}}}$ 的比例缩小。\n- 块大小主要影响有限样本的 $t$ 乘子；选择最小允许块大小可以在独立性代理约束下最大化 $B$ 并最小化半宽。",
            "answer": "[[True,25000,0.133799,38.379105],[True,25000,0.424380,38.379105],[True,10,0.084605,38.379105],[True,250000,0.424380,38.379105]]"
        }
    ]
}