{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在解决在设置恒速牵引分子动力学模拟时一个基本而实际的问题：如何为谐振子约束选择一个合适的弹簧常数。过强的弹簧会引入数值不稳定性并阻碍系统弛豫，而过弱的弹簧则可能无法有效控制反应坐标。通过本练习，你将根据第一性原理进行推导，确定为将平均力势的系统误差控制在预设阈值以下所需的最小刚度$k_{\\min}$，从而在精确控制和物理真实性之间取得平衡。",
            "id": "3449599",
            "problem": "在恒速导向分子动力学中，反应坐标 $z$ 通常通过一个谐波导向势 $U_{\\text{bias}}(z,t)=\\tfrac{1}{2}k\\big(z-z_{0}(t)\\big)^{2}$ 被约束到一个随时间变化的目标位置 $z_{0}(t)$。在温度为 $T$ 的准平衡状态下，坐标 $z$ 会围绕 $z_{0}(t)$ 发生热涨落，其均方根涨落取决于刚度 $k$。假设沿着 $z$ 的真实平均力势 $G(z)$ 在拉伸区间上是二阶连续可微的，并且其曲率的大小受常数 $M$ 的限制，即对于拉伸过程中遇到的所有 $z$，都有 $|G''(z)|\\le M$。你的目标是选择最小的刚度 $k$，使得由于这些有限涨落而在局部逼近 $G(z)$ 时产生的系统误差保持在容差 $\\epsilon$ 之内。\n\n仅从以下基本事实出发：\n- 一维谐波自由度的能量均分定理意味着在温度 $T$ 下，均方涨落 $\\langle (\\Delta z)^{2}\\rangle$ 与刚度 $k$ 之间存在一种关系。\n- 带余项的泰勒定理以及曲率界 $|G''(z)|\\le M$ 意味着，由围绕参考点的位移大小 $\\Delta z$ 引起的 $G$ 的误差大小有一个界限。\n\n请使用摩尔单位进行计算，因此能量单位为每摩尔，弹簧常数单位为 $\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$；在这些单位下，使用摩尔气体常数 $R$ 代替玻尔兹曼常数。推导出保证误差不超过 $\\epsilon$ 的最小刚度 $k_{\\min}$，然后使用以下参数对其进行数值计算：\n- 温度 $T=300\\,\\mathrm{K}$，\n- 曲率界 $M=500\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$，\n- 误差容差 $\\epsilon=0.50\\,\\mathrm{kJ\\,mol^{-1}}$，\n- 摩尔气体常数 $R=8.314462618\\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n\n将你最终的 $k_{\\min}$ 以 $\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导在恒速导向分子动力学模拟中，谐波导向势的最小弹簧刚度 $k_{\\min}$。该刚度必须足以确保由热涨落引起的平均力势 $G(z)$ 局部近似中的系统误差不超过指定的容差 $\\epsilon$。推导将从所提供的两个基本原理出发：能量均分定理和泰勒定理。\n\n首先，我们建立反应坐标 $z$ 的热涨落与导向势刚度 $k$ 之间的关系。系统被描述为处于温度为 $T$ 的准平衡状态。偏置势为 $U_{\\text{bias}}(z,t)=\\frac{1}{2}k(z-z_{0}(t))^{2}$。令 $\\Delta z = z - z_{0}(t)$ 为坐标与其随时间变化的目标位置之间的位移。在导向势提供的谐波近似下，与此位移相关的能量为 $U_{\\text{bias}} = \\frac{1}{2}k(\\Delta z)^{2}$。\n\n根据热平衡中单个二次自由度的能量均分定理，平均势能与温度相关。按规定使用摩尔单位，此关系式为：\n$$\n\\langle U_{\\text{bias}} \\rangle = \\frac{1}{2}RT\n$$\n其中 $R$ 是摩尔气体常数，$T$ 是绝对温度。代入平均势能的表达式：\n$$\n\\left\\langle \\frac{1}{2}k(\\Delta z)^{2} \\right\\rangle = \\frac{1}{2}k \\langle (\\Delta z)^{2} \\rangle = \\frac{1}{2}RT\n$$\n解出均方涨落 $\\langle (\\Delta z)^{2} \\rangle$，我们得到：\n$$\n\\langle (\\Delta z)^{2} \\rangle = \\frac{RT}{k}\n$$\n该方程表明，热涨落的大小与约束势的刚度成反比。\n\n接下来，我们量化在探测平均力势 $G(z)$ 时由这些涨落引入的系统误差。$G(z)$ 的值不是在精确的目标点 $z_{0}$ 处采样，而是由于热运动，在一个位置分布 $z = z_{0} + \\Delta z$ 上采样。系统误差可以定义为系统经历的平均力势的平均值 $\\langle G(z) \\rangle$ 与在指定参考点处的平均力势值 $G(z_{0})$ 之差。\n$$\n\\text{Error} = \\langle G(z_{0} + \\Delta z) \\rangle - G(z_{0})\n$$\n为了估计这个误差，我们使用泰勒定理将 $G(z)$ 在 $z_{0}$ 附近展开。已知 $G(z)$ 是二阶连续可微的，我们有：\n$$\nG(z_{0} + \\Delta z) = G(z_{0}) + G'(z_{0})\\Delta z + \\frac{1}{2}G''(z_{0})(\\Delta z)^{2} + \\mathcal{O}((\\Delta z)^3)\n$$\n对此展开式取热平均，我们得到：\n$$\n\\langle G(z_{0} + \\Delta z) \\rangle = \\langle G(z_{0}) \\rangle + \\langle G'(z_{0})\\Delta z \\rangle + \\left\\langle \\frac{1}{2}G''(z_{0})(\\Delta z)^{2} \\right\\rangle + \\langle \\mathcal{O}((\\Delta z)^3) \\rangle\n$$\n在准平衡状态下，涨落围绕均值对称，因此平均位移 $\\langle \\Delta z \\rangle = 0$。假设高阶奇数矩也为零，并且对于小涨落，我们可以截断级数。那么误差可以近似为：\n$$\n\\text{Error} \\approx \\frac{1}{2}G''(z_{0})\\langle (\\Delta z)^{2} \\rangle\n$$\n问题指定了平均力势曲率大小的界限，即 $|G''(z)| \\le M$。因此，误差的大小界限如下：\n$$\n|\\text{Error}| \\le \\frac{1}{2}|G''(z_{0})|\\langle (\\Delta z)^{2} \\rangle \\le \\frac{1}{2}M\\langle (\\Delta z)^{2} \\rangle\n$$\n为保证误差不超过容差 $\\epsilon$，我们必须确保误差的这个上界小于或等于 $\\epsilon$：\n$$\n\\frac{1}{2}M\\langle (\\Delta z)^{2} \\rangle \\le \\epsilon\n$$\n现在，我们将均方涨落的表达式 $\\langle (\\Delta z)^{2} \\rangle = \\frac{RT}{k}$ 代入误差不等式，从而结合我们的两个主要结果：\n$$\n\\frac{1}{2}M\\left(\\frac{RT}{k}\\right) \\le \\epsilon\n$$\n题目要求我们找到满足此条件的最小刚度 $k$，该条件对所有可能的 $z$（以及因此在界限 $M$ 内所有可能的 $G''(z)$ 值）都成立。为确保不等式成立，我们必须解出 $k$：\n$$\n\\frac{MRT}{2k} \\le \\epsilon \\implies MRT \\le 2k\\epsilon \\implies k \\ge \\frac{MRT}{2\\epsilon}\n$$\n因此，保证满足误差容差的最小刚度 $k_{\\min}$ 为：\n$$\nk_{\\min} = \\frac{MRT}{2\\epsilon}\n$$\n最后，我们使用提供的数值参数计算 $k_{\\min}$：\n- 曲率界 $M = 500\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$\n- 温度 $T = 300\\,\\mathrm{K}$\n- 误差容差 $\\epsilon = 0.50\\,\\mathrm{kJ\\,mol^{-1}}$\n- 摩尔气体常数 $R = 8.314462618 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$\n\n将这些值代入 $k_{\\min}$ 的表达式：\n$$\nk_{\\min} = \\frac{(500\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}) \\times (8.314462618 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}) \\times (300\\,\\mathrm{K})}{2 \\times (0.50\\,\\mathrm{kJ\\,mol^{-1}})}\n$$\n$$\nk_{\\min} = \\frac{500 \\times 8.314462618 \\times 10^{-3} \\times 300}{1.00}\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}\n$$\n$$\nk_{\\min} = 150000 \\times 8.314462618 \\times 10^{-3}\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}\n$$\n$$\nk_{\\min} = 1247.1693927\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\nk_{\\min} \\approx 1247\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}\n$$",
            "answer": "$$\n\\boxed{1247}\n$$"
        },
        {
            "introduction": "牵引分子动力学本质上是一个非平衡过程，这意味着对系统所做的功不等于自由能的变化，其差值以热量的形式耗散掉。理解这种能量耗散是解读SMD结果的关键。本练习题使用一个可解析求解的模型——一个位于谐振子势阱中的粒子被另一个移动的谐振子势阱牵引——来推导在长时间稳态下的平均耗散功率，从而让你深刻理解能量耗散如何依赖于牵引速度以及系统和约束的刚度。",
            "id": "3449590",
            "problem": "在过阻尼导向分子动力学 (SMD) 中，考虑一个一维坐标 $z(t)$ 在一个势场中演化，该势场是一个平均力谐波势（PMF，刚度为 $k_{0}$，中心在 $z_{*}$）与一个谐波拉伸陷阱（刚度为 $k$，中心在 $z_{c}(t)$）之和。其动力学由过阻尼朗之万方程决定：\n$$\n\\gamma \\dot z(t) \\;=\\; -\\frac{\\partial U(z,t)}{\\partial z} + \\eta(t),\n$$\n其中总势能为\n$$\nU(z,t) \\;=\\; \\frac{k_{0}}{2}\\bigl(z-z_{*}\\bigr)^{2} \\;+\\; \\frac{k}{2}\\bigl(z-z_{c}(t)\\bigr)^{2},\n$$\n$\\gamma$ 是摩擦系数，$\\eta(t)$ 是高斯白噪声，满足 $\\langle \\eta(t)\\rangle = 0$ 和 $\\langle \\eta(t)\\eta(t')\\rangle = 2\\gamma k_{B}T\\,\\delta(t-t')$，其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。陷阱中心以恒定速度 $v>0$ 移动，因此对于 $t\\ge 0$ 有 $z_{c}(t)=z_{0}+vt$。假设初始条件为 $t=0$ 时系统处于平衡态，且陷阱位于 $z_{0}$。\n\n1. 使用第一性原理（牛顿过阻尼动力学以及含时势的功和自由能的定义），推导在恒速拉伸下的长时间平均耗散功率。定义由控制参数注入的瞬时功率为\n$$\n\\dot W(t) \\;=\\; \\frac{\\partial U(z,t)}{\\partial t} \\;=\\; \\frac{\\partial U}{\\partial z_{c}}\\,\\dot z_{c}(t),\n$$\n以及瞬时可逆功率为在瞬时 $z_{c}(t)$ 处的平衡自由能 $F(z_{c})$ 的时间导数，即：\n$$\n\\frac{dF}{dt} \\;=\\; \\frac{\\partial F}{\\partial z_{c}}\\,\\dot z_{c}(t), \\qquad \\frac{\\partial F}{\\partial z_{c}} \\;=\\; \\left\\langle \\frac{\\partial U}{\\partial z_{c}} \\right\\rangle_{\\text{eq at fixed }z_{c}}.\n$$\n渐近耗散功率定义为\n$$\n\\left\\langle \\dot W_{\\text{diss}} \\right\\rangle \\;=\\; \\lim_{t\\to\\infty} \\left( \\left\\langle \\dot W(t) \\right\\rangle \\;-\\; \\frac{dF}{dt} \\right).\n$$\n\n2. 通过求解平均轨迹 $\\langle z(t)\\rangle$ 并计算上述极限来显式地计算这个量。将你的最终答案表示为一个只包含 $\\gamma$、$k$、$k_{0}$ 和 $v$ 的单个闭合形式的解析表达式。不需要数值。最终方框内的答案不应包含单位。无需四舍五入。",
            "solution": "该问题要求计算在恒速拉伸下，导向分子动力学模拟中的长时间平均耗散功率。我们首先验证问题陈述的有效性。该问题提供了一个基于过阻尼朗之万方程的明确定义的物理模型，这是统计力学中一个标准且科学上合理的框架。所有参数、初始条件和定义都已给出且自洽。该问题是适定的、客观的且可形式化的。因此，该问题被认为是有效的，我们可以继续进行求解。\n\n系统由一维坐标 $z(t)$ 描述，其动力学由过阻尼朗之万方程决定：\n$$\n\\gamma \\dot z(t) = -\\frac{\\partial U(z,t)}{\\partial z} + \\eta(t)\n$$\n总势能 $U(z,t)$ 是一个谐波势和一个移动的谐波陷阱之和：\n$$\nU(z,t) = \\frac{k_{0}}{2}(z-z_{*})^{2} + \\frac{k}{2}(z-z_{c}(t))^{2}\n$$\n其中陷阱中心以恒定速度 $v$ 移动，因此 $z_{c}(t) = z_{0}+vt$。项 $\\eta(t)$ 是高斯白噪声，满足 $\\langle \\eta(t)\\rangle = 0$。\n\n首先，我们推导平均轨迹 $\\langle z(t) \\rangle$ 的运动方程。我们对朗之万方程取系综平均。由于 $\\langle \\eta(t) \\rangle = 0$ 且势能是 $z$ 的二次函数，因此平均过程是精确的。\n$$\n\\gamma \\langle \\dot z(t) \\rangle = \\left\\langle -\\frac{\\partial U(z,t)}{\\partial z} \\right\\rangle\n$$\n力项为：\n$$\n-\\frac{\\partial U(z,t)}{\\partial z} = -k_{0}(z-z_{*}) - k(z-z_{c}(t)) = -(k_{0}+k)z + k_{0}z_{*} + k z_{c}(t)\n$$\n取平均后，我们得到一个关于 $\\mu(t) = \\langle z(t) \\rangle$ 的封闭的一阶线性常微分方程：\n$$\n\\gamma \\frac{d\\mu}{dt} = -(k_{0}+k)\\mu + k_{0}z_{*} + k z_{c}(t)\n$$\n令 $K = k_{0}+k$。代入 $z_{c}(t) = z_{0}+vt$，方程变为：\n$$\n\\gamma \\frac{d\\mu}{dt} + K\\mu = k_{0}z_{*} + k z_{0} + kvt\n$$\n\n接下来，我们确定 $\\mu(t)$ 的初始条件。系统在 $t=0$ 时处于热平衡状态，陷阱中心位于 $z_{c}(0)=z_{0}$。在平衡态下，平均力为零，因此 $\\langle -\\frac{\\partial U(z,0)}{\\partial z} \\rangle = 0$。\n$$\n-k_{0}(\\mu(0)-z_{*}) - k(\\mu(0)-z_{0}) = 0\n$$\n$$\n-K\\mu(0) + k_{0}z_{*} + k z_{0} = 0 \\implies \\mu(0) = \\frac{k_{0}z_{*} + k z_{0}}{K}\n$$\n\n我们现在求解关于 $\\mu(t)$ 的微分方程。该方程的形式为 $\\dot{\\mu} + \\frac{K}{\\gamma}\\mu = f(t)$。我们寻找一个形式为 $\\mu_p(t) = At+B$ 的特解。\n代入方程中：\n$$\n\\gamma A + K(At+B) = k_{0}z_{*} + k z_{0} + kvt\n$$\n令 $t$ 的系数相等：$KA = kv \\implies A = \\frac{kv}{K}$。\n令常数项相等：$\\gamma A + KB = k_{0}z_{*} + k z_{0} \\implies B = \\frac{k_{0}z_{*} + k z_{0}}{K} - \\frac{\\gamma A}{K} = \\frac{k_{0}z_{*} + k z_{0}}{K} - \\frac{\\gamma k v}{K^2}$。\n通解为 $\\mu(t) = \\mu_h(t) + \\mu_p(t) = C\\exp(-\\frac{K}{\\gamma}t) + At + B$。\n使用初始条件 $\\mu(0) = C+B = \\frac{k_{0}z_{*} + k z_{0}}{K}$，我们求出常数 $C$：\n$$\nC + \\frac{k_{0}z_{*} + k z_{0}}{K} - \\frac{\\gamma k v}{K^2} = \\frac{k_{0}z_{*} + k z_{0}}{K} \\implies C = \\frac{\\gamma k v}{K^2}\n$$\n因此，平均轨迹为：\n$$\n\\langle z(t) \\rangle = \\frac{\\gamma k v}{K^2} \\exp\\left(-\\frac{K}{\\gamma}t\\right) + \\frac{kv}{K}t + \\frac{k_{0}z_{*} + k z_{0}}{K} - \\frac{\\gamma k v}{K^2}\n$$\n\n渐近耗散功率定义为 $\\langle \\dot W_{\\text{diss}} \\rangle = \\lim_{t\\to\\infty} \\left( \\langle \\dot W(t) \\rangle - \\frac{dF}{dt} \\right)$。\n平均注入功率为 $\\langle \\dot W(t) \\rangle = \\left\\langle \\frac{\\partial U}{\\partial z_{c}} \\dot z_{c} \\right\\rangle$。\n$$\n\\frac{\\partial U}{\\partial z_{c}} = -k(z-z_{c}(t)), \\quad \\dot z_{c} = v\n$$\n$$\n\\langle \\dot W(t) \\rangle = -kv(\\langle z(t) \\rangle - z_{c}(t))\n$$\n可逆功率为 $\\frac{dF}{dt} = \\frac{\\partial F}{\\partial z_{c}}\\dot z_{c}(t)$，其中 $\\frac{\\partial F}{\\partial z_{c}} = \\left\\langle \\frac{\\partial U}{\\partial z_{c}} \\right\\rangle_{\\text{eq at fixed } z_c}$。\n首先，我们求出当陷阱固定在 $z_c$ 时的平衡平均位置 $\\langle z \\rangle_{\\text{eq}}$。如同为初始条件所推导的那样：\n$$\n\\langle z \\rangle_{\\text{eq}} = \\frac{k_{0}z_{*} + k z_c}{K}\n$$\n那么，$\\frac{\\partial F}{\\partial z_{c}} = \\langle -k(z-z_c) \\rangle_{\\text{eq}} = -k(\\langle z \\rangle_{\\text{eq}} - z_c)$。\n$$\n\\frac{\\partial F}{\\partial z_{c}} = -k\\left(\\frac{k_{0}z_{*} + k z_c}{K} - z_c\\right) = -k\\left(\\frac{k_{0}z_{*} - k_{0}z_c}{K}\\right) = -\\frac{k k_{0}}{K}(z_{*}-z_c)\n$$\n可逆功率在瞬时位置 $z_c(t)=z_0+vt$ 处计算：\n$$\n\\frac{dF}{dt} = \\left(-\\frac{k k_{0}}{K}(z_{*}-z_c(t))\\right) v = -\\frac{k k_{0}v}{K}(z_{*}-(z_{0}+vt)) = \\frac{k k_{0}v^{2}}{K}t - \\frac{k k_{0}v}{K}(z_*-z_0)\n$$\n\n现在我们计算瞬时耗散功率 $\\langle \\dot W(t) \\rangle - \\frac{dF}{dt}$。一个更直接的方法是注意到\n$$\n\\langle \\dot W(t) \\rangle - \\frac{dF}{dt} = -kv(\\langle z(t) \\rangle - z_c(t)) - (-kv(\\langle z \\rangle_{\\text{eq}} - z_c(t))) = -kv(\\langle z(t) \\rangle - \\langle z \\rangle_{\\text{eq}})\n$$\n其中 $\\langle z \\rangle_{\\text{eq}}$ 是在 $z_c(t)$ 处计算的。让我们计算差值 $\\langle z(t) \\rangle - \\langle z \\rangle_{\\text{eq}}$：\n$$\n\\langle z \\rangle_{\\text{eq}} = \\frac{k_{0}z_{*} + k z_c(t)}{K} = \\frac{k_{0}z_{*} + k(z_0+vt)}{K} = \\frac{k_0 z_* + kz_0}{K} + \\frac{kv}{K}t\n$$\n从 $\\langle z(t) \\rangle$ 的解中减去此项：\n$$\n\\langle z(t) \\rangle - \\langle z \\rangle_{\\text{eq}} = \\left(\\frac{\\gamma k v}{K^2} \\exp\\left(-\\frac{K}{\\gamma}t\\right) + \\frac{kv}{K}t + \\frac{k_{0}z_{*} + k z_{0}}{K} - \\frac{\\gamma k v}{K^2}\\right) - \\left(\\frac{k_0 z_* + kz_0}{K} + \\frac{kv}{K}t\\right)\n$$\n$$\n\\langle z(t) \\rangle - \\langle z \\rangle_{\\text{eq}} = \\frac{\\gamma k v}{K^2} \\exp\\left(-\\frac{K}{\\gamma}t\\right) - \\frac{\\gamma k v}{K^2}\n$$\n这表示系统平均位置相对于移动的平衡位置的滞后。\n于是，瞬时耗散功率为：\n$$\n\\langle \\dot W(t) \\rangle - \\frac{dF}{dt} = -kv \\left( \\frac{\\gamma k v}{K^2} \\exp\\left(-\\frac{K}{\\gamma}t\\right) - \\frac{\\gamma k v}{K^2} \\right) = \\frac{\\gamma k^2 v^2}{K^2} - \\frac{\\gamma k^2 v^2}{K^2} \\exp\\left(-\\frac{K}{\\gamma}t\\right)\n$$\n最后，我们取 $t \\to \\infty$ 的极限来求得渐近耗散功率：\n$$\n\\langle \\dot W_{\\text{diss}} \\rangle = \\lim_{t\\to\\infty} \\left( \\frac{\\gamma k^2 v^2}{K^2} - \\frac{\\gamma k^2 v^2}{K^2} \\exp\\left(-\\frac{K}{\\gamma}t\\right) \\right)\n$$\n由于 $K=k_0+k>0$ 且 $\\gamma>0$，指数项衰减为零。\n$$\n\\langle \\dot W_{\\text{diss}} \\rangle = \\frac{\\gamma k^2 v^2}{K^2}\n$$\n代入 $K = k_0+k$ 得到以指定参数表示的最终表达式：\n$$\n\\langle \\dot W_{\\text{diss}} \\rangle = \\frac{\\gamma k^2 v^2}{(k_0+k)^2}\n$$\n该结果表示在恒速拉伸下达到的非平衡稳态中，能量以热量形式耗散到环境中的恒定速率。",
            "answer": "$$\\boxed{\\frac{\\gamma k^{2} v^{2}}{(k_{0}+k)^{2}}}$$"
        },
        {
            "introduction": "Jarzynski等式为从非平衡功的测量中计算平衡态自由能差提供了一种强有力的方法，但其在实际应用中需要周密的规划。一个关键问题是：要达到自由能估计的特定精度，需要多少次牵引轨迹？本练习将要求你从第一性原理出发，推导所需样本量的公式，将功分布的方差与最终结果的统计误差联系起来，从而将抽象的误差传播理论具体化，并应用于真实的模拟设计中。",
            "id": "3449641",
            "problem": "一个分子通过导向分子动力学 (SMD; steered molecular dynamics) 方法，在一个中心以恒定速度移动的谐波偏置作用下，沿着一维集体变量 (CV; collective variable) 被拉动。设沿一条轨迹累积的非平衡功为 $W$，自由能差为 $\\Delta G$。Jarzynski 等式指出，$\\Delta G$ 可以通过一个非平衡轨迹系综，由关系式 $\\Delta G = -\\beta^{-1} \\ln \\langle \\exp(-\\beta W) \\rangle$ 计算得出，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$T$ 是绝对温度，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。在以每摩尔为单位的能量单位中，取 $\\beta = 1/(R T)$，$R$ 为摩尔气体常数。\n\n假设以下科学上真实的条件：\n- 从 $N$ 条在温度 $T$ 下的恒速拉动轨迹中，获得了独立同分布的功值 $W_{1}, W_{2}, \\dots, W_{N}$。由于线性响应行为和弱协议诱导耗散，以每摩尔为单位的功 $W$ 的分布近似为高斯分布。\n- 对预备轨迹的初步分析给出了适用于每摩尔能量单位的功方差 $\\sigma_{W}^{2}$ 的估计值，其尾部行为与高斯分布的 $W$（因此 $\\exp(-\\beta W)$ 为对数正态分布）一致，确保了有限方差以及中心极限定理对 $\\exp(-\\beta W)$ 样本均值的适用性。\n\n基于 $N$ 条轨迹定义 Jarzynski 估计量为\n$$\n\\widehat{\\Delta G}_{N} = -\\beta^{-1} \\ln \\left( \\frac{1}{N} \\sum_{i=1}^{N} \\exp(-\\beta W_{i}) \\right).\n$$\n\n从 Jarzynski 等式和上述假设出发，推导一个公式，用于计算所需的最小样本量 $N$，以使 $\\widehat{\\Delta G}_{N}$ 的双边 $95\\%$ 置信区间具有指定的半宽 $\\varepsilon$（以每摩尔能量为单位）。您的推导必须从基本原理开始，通过适当的极限定理和变换进行，不得引用任何预先推导出的样本量法则。\n\n然后，将您推导的公式应用于以下科学上合理的数值：\n- 温度 $T = 300~\\mathrm{K}$，\n- 以千焦为单位的摩尔气体常数 $R = 0.008314462618~\\mathrm{kJ}~\\mathrm{mol}^{-1}~\\mathrm{K}^{-1}$，\n- 估计的功标准差 $\\sigma_{W} = 2.0~\\mathrm{kJ}~\\mathrm{mol}^{-1}$，\n- 目标双边 $95\\%$ 置信区间半宽 $\\varepsilon = 1.0~\\mathrm{kJ}~\\mathrm{mol}^{-1}$。\n\n将所需轨迹数 $N$ 表示为一个整数（无单位）。选择满足您公式所隐含界限的最小整数 $N$。由于 $N$ 是一个计数，不需要对有效数字进行四舍五入。",
            "solution": "用户希望推导并应用一个公式，用于计算在使用 Jarzynski 等式的导向分子动力学 (SMD) 模拟中所需的样本量。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **系统**：通过 SMD 方法，在一个以恒定速度移动的谐波偏置作用下，一个分子沿着一维集体变量 (CV) 被拉动。\n- **量**：\n    - 非平衡功：$W$\n    - 自由能差：$\\Delta G$\n    - 逆温度（每摩尔）：$\\beta = 1/(R T)$，$R$ 为摩尔气体常数，$T$ 为绝对温度。\n- **Jarzynski 等式**：$\\Delta G = -\\beta^{-1} \\ln \\langle \\exp(-\\beta W) \\rangle$。\n- **假设**：\n    1. 来自 $N$ 条轨迹的独立同分布 (i.i.d.) 功值 $W_{1}, W_{2}, \\dots, W_{N}$。\n    2. 每摩尔功的分布近似为高斯分布，$W \\sim \\mathcal{N}(\\mu_{W}, \\sigma_{W}^{2})$。\n    3. $\\exp(-\\beta W)$ 的分布具有有限方差，且中心极限定理 (CLT) 对其样本均值适用。\n- **估计量**：Jarzynski 估计量为 $\\widehat{\\Delta G}_{N} = -\\beta^{-1} \\ln \\left( \\frac{1}{N} \\sum_{i=1}^{N} \\exp(-\\beta W_{i}) \\right)$。\n- **目标**：\n    1. 推导最小样本量 $N$ 的公式，使得 $\\widehat{\\Delta G}_{N}$ 的双边 $95\\%$ 置信区间具有指定的半宽 $\\varepsilon$。\n    2. 使用以下数值应用该公式：\n        - $T = 300~\\mathrm{K}$\n        - $R = 0.008314462618~\\mathrm{kJ}~\\mathrm{mol}^{-1}~\\mathrm{K}^{-1}$\n        - $\\sigma_{W} = 2.0~\\mathrm{kJ}~\\mathrm{mol}^{-1}$\n        - $\\varepsilon = 1.0~\\mathrm{kJ}~\\mathrm{mol}^{-1}$\n- **输出要求**：$N$ 必须是满足所推导界限的最小整数。\n\n**步骤 2：使用提取的已知条件进行验证**\n1.  **科学依据**：该问题在非平衡统计力学中有无可挑剔的依据。Jarzynski 等式是该领域的基石。SMD 是一种标准的计算方法。如问题所述，高斯功分布的假设是在近平衡或线性响应区域中一个众所周知且物理上合理的近似。所有概念都是标准且有效的。\n2.  **适定性**：该问题是适定的。它提供了一个明确的目标（推导并应用 $N$ 的公式）、一套完整的假设（高斯功、独立同分布样本）、所有必要的参数（$T, R, \\sigma_W, \\varepsilon$）以及一个确定的置信水平（$95\\%$）。该结构允许一个唯一且有意义的解。\n3.  **客观性**：语言精确、正式，没有任何主观或模棱两可的术语。\n4.  **完整性**：问题提供了所有必需的信息。尽管没有给出 $95\\%$ 置信区间的 z-score，但它的值是一个通用的统计常数，其使用是标准做法。这不构成会使问题无效的遗漏。\n5.  **一致性**：数据在量纲上和物理上是一致的。能量单位是“每摩尔”，与摩尔气体常数 $R$ 正确配对。这些参数对于分子解离或去折叠过程是科学上合理的。\n\n**步骤 3：结论与行动**\n该问题有效。这是一个应用于分子模拟的统计误差分析中的标准练习，尽管不简单。我现在将进行推导和求解。\n\n### 样本量公式的推导\n\n目标是确定在 $95\\%$ 的置信水平下，以指定的精度 $\\varepsilon$ 估计自由能差 $\\Delta G$ 所需的样本量 $N$。$\\Delta G$ 的估计量由下式给出\n$$\n\\widehat{\\Delta G}_{N} = -\\beta^{-1} \\ln \\left( \\frac{1}{N} \\sum_{i=1}^{N} \\exp(-\\beta W_{i}) \\right)\n$$\n其中 $W_i$ 是从高斯分布 $W \\sim \\mathcal{N}(\\mu_{W}, \\sigma_{W}^{2})$ 中抽取的独立同分布随机变量。我们定义一个新的随机变量 $Y_i = \\exp(-\\beta W_i)$。那么估计量可以写成 $\\widehat{\\Delta G}_{N} = -\\beta^{-1} \\ln(\\bar{Y}_N)$，其中 $\\bar{Y}_N = \\frac{1}{N} \\sum_{i=1}^{N} Y_i$ 是 $Y_i$ 的样本均值。\n\nJarzynski 等式表明 $\\Delta G = -\\beta^{-1} \\ln(\\langle Y \\rangle)$，其中 $\\langle Y \\rangle = \\mu_Y$ 是 $Y$ 的真实总体均值。为了找到 $\\widehat{\\Delta G}_{N}$ 的统计特性，我们首先分析 $\\bar{Y}_N$ 的分布。根据中心极限定理，对于足够大的样本量 $N$，样本均值 $\\bar{Y}_N$ 的分布近似为高斯分布：\n$$\n\\bar{Y}_N \\approx \\mathcal{N}\\left(\\mu_Y, \\frac{\\sigma_Y^2}{N}\\right)\n$$\n其中 $\\mu_Y = \\langle Y \\rangle$ 且 $\\sigma_Y^2 = \\text{Var}(Y) = \\langle Y^2 \\rangle - \\mu_Y^2$。\n\n我们必须计算 $\\mu_Y$ 和 $\\sigma_Y^2$。由于 $W \\sim \\mathcal{N}(\\mu_W, \\sigma_W^2)$，变量 $X = -\\beta W$ 也服从正态分布，其均值为 $\\mu_X = -\\beta \\mu_W$，方差为 $\\sigma_X^2 = \\beta^2 \\sigma_W^2$。因此，变量 $Y = \\exp(X)$ 服从对数正态分布。$Y$ 的矩可以使用正态分布的矩生成函数计算。\n$Y$ 的 $k$ 阶矩为：\n$$\n\\langle Y^k \\rangle = \\langle \\exp(kX) \\rangle = \\exp(k \\mu_X + \\frac{1}{2} k^2 \\sigma_X^2)\n$$\n所以，对于 $k=1$：\n$$\n\\mu_Y = \\langle Y \\rangle = \\exp(\\mu_X + \\frac{1}{2}\\sigma_X^2) = \\exp(-\\beta \\mu_W + \\frac{1}{2}\\beta^2 \\sigma_W^2)\n$$\n对于 $k=2$：\n$$\n\\langle Y^2 \\rangle = \\exp(2\\mu_X + \\frac{1}{2}(2^2)\\sigma_X^2) = \\exp(-2\\beta \\mu_W + 2\\beta^2 \\sigma_W^2)\n$$\n因此 $Y$ 的方差为：\n$$\n\\sigma_Y^2 = \\langle Y^2 \\rangle - \\mu_Y^2 = \\exp(-2\\beta \\mu_W + 2\\beta^2 \\sigma_W^2) - \\left(\\exp(-\\beta \\mu_W + \\frac{1}{2}\\beta^2 \\sigma_W^2)\\right)^2\n$$\n$$\n\\sigma_Y^2 = \\exp(-2\\beta \\mu_W + 2\\beta^2 \\sigma_W^2) - \\exp(-2\\beta \\mu_W + \\beta^2 \\sigma_W^2)\n$$\n提出因子 $\\mu_Y^2 = \\exp(-2\\beta \\mu_W + \\beta^2 \\sigma_W^2)$，我们得到：\n$$\n\\sigma_Y^2 = \\exp(-2\\beta \\mu_W + \\beta^2 \\sigma_W^2) \\left(\\exp(\\beta^2 \\sigma_W^2) - 1\\right) = \\mu_Y^2 \\left(\\exp(\\beta^2 \\sigma_W^2) - 1\\right)\n$$\n现在我们使用 delta 方法将 $\\bar{Y}_N$ 的方差与估计量 $\\widehat{\\Delta G}_{N}$ 的方差联系起来。对于函数 $f(x)$，$f(X)$ 的方差近似为 $\\text{Var}(f(X)) \\approx [f'(\\mu_X)]^2 \\text{Var}(X)$。在这里，我们的随机变量是 $\\bar{Y}_N$，函数是 $f(y) = -\\beta^{-1} \\ln(y)$。其导数为 $f'(y) = -1/(\\beta y)$。我们在 $\\bar{Y}_N$ 的均值 $\\mu_Y$ 处计算该导数。\n$$\n\\text{Var}(\\widehat{\\Delta G}_{N}) \\approx \\left[f'(\\mu_Y)\\right]^2 \\text{Var}(\\bar{Y}_N) = \\left(-\\frac{1}{\\beta \\mu_Y}\\right)^2 \\left(\\frac{\\sigma_Y^2}{N}\\right) = \\frac{\\sigma_Y^2}{\\beta^2 \\mu_Y^2 N}\n$$\n代入 $\\sigma_Y^2$ 的表达式：\n$$\n\\text{Var}(\\widehat{\\Delta G}_{N}) \\approx \\frac{\\mu_Y^2 (\\exp(\\beta^2 \\sigma_W^2) - 1)}{\\beta^2 \\mu_Y^2 N} = \\frac{\\exp(\\beta^2 \\sigma_W^2) - 1}{\\beta^2 N}\n$$\n值得注意的是，这个估计量方差的表达式只依赖于功分布的方差 $\\sigma_W^2$，而与其均值 $\\mu_W$ 无关。估计量的标准误差 (SE) 是其方差的平方根：\n$$\n\\text{SE}(\\widehat{\\Delta G}_{N}) = \\sqrt{\\text{Var}(\\widehat{\\Delta G}_{N})} \\approx \\frac{\\sqrt{\\exp(\\beta^2 \\sigma_W^2) - 1}}{\\beta \\sqrt{N}}\n$$\n$\\Delta G$ 的双边 $95\\%$ 置信区间构建为 $\\widehat{\\Delta G}_{N} \\pm \\varepsilon$，其中半宽 $\\varepsilon$ 由下式给出：\n$$\n\\varepsilon = z_{\\alpha/2} \\times \\text{SE}(\\widehat{\\Delta G}_{N})\n$$\n对于 $95\\%$ 的置信水平，$\\alpha = 0.05$，因此 $\\alpha/2 = 0.025$。来自标准正态分布的相应临界值为 $z_{0.025} \\approx 1.96$。\n$$\n\\varepsilon = z_{0.025} \\frac{\\sqrt{\\exp(\\beta^2 \\sigma_W^2) - 1}}{\\beta \\sqrt{N}}\n$$\n我们现在求解最小样本量 $N$：\n$$\n\\sqrt{N} = \\frac{z_{0.025}}{\\beta \\varepsilon} \\sqrt{\\exp(\\beta^2 \\sigma_W^2) - 1}\n$$\n$$\nN = \\left(\\frac{z_{0.025}}{\\beta \\varepsilon}\\right)^2 \\left(\\exp(\\beta^2 \\sigma_W^2) - 1\\right)\n$$\n这就是所需的样本量 $N$ 的公式。\n\n### 公式的应用\n\n我们现在将提供的数值代入推导出的公式中。\n- $T = 300~\\mathrm{K}$\n- $R = 0.008314462618~\\mathrm{kJ}~\\mathrm{mol}^{-1}~\\mathrm{K}^{-1}$\n- $\\sigma_W = 2.0~\\mathrm{kJ}~\\mathrm{mol}^{-1}$\n- $\\varepsilon = 1.0~\\mathrm{kJ}~\\mathrm{mol}^{-1}$\n- $z_{0.025} \\approx 1.959964$（$95\\%$ 置信度的标准值）\n\n首先，我们计算逆温度 $\\beta$：\n$$\n\\beta = \\frac{1}{R T} = \\frac{1}{(0.008314462618~\\mathrm{kJ}~\\mathrm{mol}^{-1}~\\mathrm{K}^{-1}) \\times (300~\\mathrm{K})} = \\frac{1}{2.4943387854}~\\mathrm{kJ}^{-1}~\\mathrm{mol}\n$$\n$$\n\\beta \\approx 0.400908103~\\mathrm{kJ}^{-1}~\\mathrm{mol}\n$$\n接下来，我们计算无量纲量 $\\beta^2 \\sigma_W^2$：\n$$\n\\beta^2 \\sigma_W^2 = \\left(\\frac{1}{2.4943387854}~\\mathrm{kJ}^{-1}~\\mathrm{mol}\\right)^2 \\times (2.0~\\mathrm{kJ}~\\mathrm{mol}^{-1})^2 = \\frac{4.0}{2.4943387854^2} \\approx 0.6429033\n$$\n现在我们计算 $\\exp(\\beta^2 \\sigma_W^2) - 1$ 这一项：\n$$\n\\exp(\\beta^2 \\sigma_W^2) - 1 = \\exp(0.6429033) - 1 \\approx 1.902008 - 1 = 0.902008\n$$\n最后，我们组合成 $N$ 的公式：\n$$\nN = \\left(\\frac{1.959964}{(0.400908103~\\mathrm{kJ}^{-1}~\\mathrm{mol}) \\times (1.0~\\mathrm{kJ}~\\mathrm{mol}^{-1})}\\right)^2 \\times (0.902008)\n$$\n$$\nN = \\left(\\frac{1.959964}{0.400908103}\\right)^2 \\times 0.902008 \\approx (4.88891)^2 \\times 0.902008\n$$\n$$\nN \\approx (23.90146) \\times (0.902008) \\approx 21.5595\n$$\n问题要求满足由置信区间规范推导出的不等式的最小整数 $N$。因此，我们必须将结果向上取整到下一个整数，以确保置信区间半宽不大于 $\\varepsilon$。\n$$\nN = \\lceil 21.5595 \\rceil = 22\n$$\n因此，最少需要 22 条轨迹。",
            "answer": "$$\\boxed{22}$$"
        }
    ]
}