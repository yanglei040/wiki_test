{
    "hands_on_practices": [
        {
            "introduction": "The connection between microscopic dynamics and macroscopic thermodynamic quantities is a cornerstone of statistical mechanics. This first exercise provides a foundational workout, asking you to derive the statistical properties of work for one of the simplest, yet most insightful, non-equilibrium models: a Brownian particle in a harmonically moving potential . By solving this problem, you will gain a concrete understanding of how external driving and thermal fluctuations jointly determine the work distribution.",
            "id": "317561",
            "problem": "Consider an overdamped Brownian particle in one dimension, confined by a harmonic potential $V(x, \\lambda) = \\frac{1}{2} k (x - \\lambda)^2$. The particle is in contact with a thermal reservoir at a constant temperature $T$. The system is initially in thermal equilibrium at time $t=0$, with the center of the potential located at $\\lambda(0) = 0$.\n\nStarting from $t=0$, the center of the harmonic trap is dragged with a constant velocity $u$ for a duration $\\tau$. The position of the trap center at time $t$ is thus given by $\\lambda(t) = ut$ for $0 \\le t \\le \\tau$. The dynamics of the particle's position $x(t)$ are described by the overdamped Langevin equation:\n$$\n\\gamma \\frac{dx}{dt} = -\\frac{\\partial V(x, \\lambda(t))}{\\partial x} + \\xi(t)\n$$\nwhere $\\gamma$ is the friction coefficient, $k$ is the trap stiffness, and $\\xi(t)$ is a Gaussian white noise term with zero mean, $\\langle \\xi(t) \\rangle = 0$, and correlation $\\langle \\xi(t) \\xi(t') \\rangle = 2 \\gamma k_B T \\delta(t-t')$, with $k_B$ being the Boltzmann constant.\n\nThe work $W$ performed on the system during this process is given by the integral of the force applied to the control parameter $\\lambda$ multiplied by its displacement:\n$$\nW = \\int_0^\\tau \\frac{\\partial V(x(t), \\lambda(t))}{\\partial \\lambda} \\frac{d\\lambda}{dt} dt\n$$\n\nDerive a closed-form analytical expression for the variance of the work distribution, $\\sigma_W^2 = \\langle W^2 \\rangle - \\langle W \\rangle^2$, as a function of the parameters $\\gamma, k, T, u,$ and $\\tau$.",
            "solution": "1. **Langevin equation and work expression**\nThe Langevin equation for the particle position $x(t)$ and the protocol for the trap center $\\lambda(t)$ are:\n$$ \\gamma\\dot{x} = -k[x-\\lambda(t)] + \\xi(t), \\quad \\lambda(t)=ut $$\nThe work is given by:\n$$ W = \\int_0^\\tau \\frac{\\partial V}{\\partial\\lambda}\\dot\\lambda\\,dt = \\int_0^\\tau k[x(t)-\\lambda(t)]\\,u\\,dt $$\n\n2. **Shifted Coordinate System**\nDefine a shifted coordinate $y(t) = x(t) - ut$. Its equation of motion is:\n$$ \\dot y = \\dot x - u = -\\frac{k}{\\gamma}y - u + \\frac{\\xi(t)}{\\gamma} $$\nThe initial condition $y(0)=x(0)$ is sampled from the equilibrium distribution at $\\lambda=0$, so $\\langle y(0)\\rangle=0$ and $\\text{Var}[y(0)]=k_B T/k$.\n\n3. **Mean Work**\nThe mean work is $\\langle W\\rangle=k u\\int_0^\\tau\\langle y(t)\\rangle dt$. With $\\alpha=k/\\gamma$, the equation for the mean is $\\langle\\dot{y}\\rangle = -\\alpha\\langle y \\rangle - u$. The solution is:\n$$ \\langle y(t)\\rangle = -\\frac{u}{\\alpha}(1-e^{-\\alpha t}) $$\nIntegrating this gives the mean work:\n$$ \\langle W\\rangle = \\frac{k u^2}{\\alpha}\\int_0^\\tau(1-e^{-\\alpha t})dt = \\gamma u^2\\left(\\tau-\\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\right) $$\n\n4. **Variance of Work**\nLet $y(t)=\\langle y(t)\\rangle+z(t)$, where $z(t)$ is an Ornstein-Uhlenbeck process with covariance $\\langle z(t_1)z(t_2)\\rangle=\\frac{k_B T}{k}e^{-\\alpha|t_1-t_2|}$. The variance of work is:\n$$ \\sigma_W^2 = \\text{Var}\\left[k u \\int_0^\\tau y(t) dt\\right] = k^2 u^2 \\text{Var}\\left[\\int_0^\\tau z(t) dt\\right] = k^2 u^2 \\iint_0^\\tau\\langle z(t_1)z(t_2)\\rangle dt_1dt_2 $$\nLet's evaluate the double integral $I = \\iint_0^\\tau e^{-\\alpha|t_1-t_2|}dt_1dt_2$.\n$$ I = 2\\int_0^\\tau dt_1 \\int_0^{t_1} e^{-\\alpha(t_1-t_2)}dt_2 = 2\\int_0^\\tau dt_1 \\left[ \\frac{e^{-\\alpha(t_1-t_2)}}{\\alpha} \\right]_0^{t_1} = \\frac{2}{\\alpha}\\int_0^\\tau (1-e^{-\\alpha t_1})dt_1 $$\n$$ I = \\frac{2}{\\alpha}\\left(\\tau-\\frac{1-e^{-\\alpha\\tau}}{\\alpha}\\right) $$\nThe variance is then:\n$$ \\sigma_W^2 = k^2 u^2 \\frac{k_B T}{k} I = k k_B T u^2 \\frac{2}{\\alpha}\\left(\\tau-\\frac{1-e^{-\\alpha\\tau}}{\\alpha}\\right) $$\nSubstituting $\\alpha = k/\\gamma$:\n$$ \\sigma_W^2 = 2\\gamma u^2 k_B T\\left(\\tau-\\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\right) $$",
            "answer": "$$\\boxed{2\\gamma\\,k_B T\\,u^2\\Bigl(\\tau-\\frac{\\gamma}{k}\\bigl(1-e^{-k\\tau/\\gamma}\\bigr)\\Bigr)}$$"
        },
        {
            "introduction": "The central promise of non-equilibrium work theorems is the ability to extract equilibrium free energy differences from irreversible processes. This practice moves from abstract theory to practical application, challenging you to compute the free energy difference, $\\Delta F$, from a given work distribution using the Jarzynski equality . You will see how, under the common assumption of Gaussian work distributions, the theorem provides a direct path to $\\Delta F$ and reveals a beautiful consistency with the more detailed Crooks fluctuation theorem.",
            "id": "3428948",
            "problem": "A one-dimensional overdamped particle is simulated with Molecular Dynamics (MD) in a harmonic potential whose stiffness parameter $\\lambda(t)$ is driven from an initial value $\\lambda_{0}$ to a final value $\\lambda_{1}$ over a finite protocol duration $\\tau$ at constant temperature $T$. The microscopic dynamics are time-reversal invariant, and the system is initially equilibrated at $\\lambda_{0}$ in the canonical ensemble with probability density $\\rho_{0}(x) = Z_{0}^{-1} \\exp(-\\beta H(x;\\lambda_{0}))$, where $H(x;\\lambda)$ is the Hamiltonian, $Z_{0}$ is the partition function, and $\\beta = 1/(R T)$ with $R$ the molar gas constant. Along any single realization of the protocol, the work is defined by the generalized force-displacement functional $W = \\int_{0}^{\\tau} (\\partial H/\\partial \\lambda)\\, \\dot{\\lambda}(t)\\, dt$.\n\nFrom a large ensemble of forward realizations (driving $\\lambda_{0} \\to \\lambda_{1}$), the measured distribution of work values $W$ is well-described by a Gaussian with mean $\\mu_{F}$ and standard deviation $\\sigma_{F}$. Independently, an ensemble of reverse realizations (driving $\\lambda_{1} \\to \\lambda_{0}$) produces a Gaussian distribution of work values with mean $\\mu_{R}$ and standard deviation $\\sigma_{R}$. For the protocol studied here, the following empirical characterizations are obtained:\n- Forward: $\\mu_{F} = 7.50\\,\\text{kJ/mol}$, $\\sigma_{F} = 2.50\\,\\text{kJ/mol}$.\n- Reverse: $\\mu_{R} = -4.994\\,\\text{kJ/mol}$, $\\sigma_{R} = 2.50\\,\\text{kJ/mol}$.\nThe temperature is $T = 300\\,\\text{K}$, and the molar gas constant is $R = 8.314462618\\,\\text{J}\\,(\\text{mol}\\,\\text{K})^{-1}$.\n\nStarting from the canonical ensemble definition of equilibrium, the microscopic work functional, and microreversibility of the dynamics, reason about the constraints that relate the forward and reverse work distributions to the equilibrium free energy difference $\\Delta F = F(\\lambda_{1}) - F(\\lambda_{0})$. Then, using only these foundations and the given Gaussian characterization for the forward work ensemble, compute the equilibrium free energy difference from exponential averaging of the forward work ensemble and express your final result in $\\text{kJ/mol}$. Round your answer to four significant figures. In addition, establish analytically, based on the same foundations, that the value you obtain is equal to the unique crossing point $W_{c}$ where the forward work density equals the reverse density evaluated at $-W$, i.e., $p_{F}(W_{c}) = p_{R}(-W_{c})$.",
            "solution": "The problem requires the computation of the equilibrium free energy difference, $\\Delta F$, from the statistics of work performed during a non-equilibrium process, and an analytical proof relating this quantity to the crossing point of the forward and reverse work distributions. The foundational principle connecting non-equilibrium work to equilibrium free energies is the Jarzynski equality.\n\nThe Jarzynski equality is derived from the premises of a system starting in canonical equilibrium and evolving under dynamics that are microscopically reversible. It states that the exponential average of the work, $W$, performed on the system is related to the free energy difference, $\\Delta F = F(\\lambda_{1}) - F(\\lambda_{0})$, between the final and initial equilibrium states:\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\exp(-\\beta \\Delta F)\n$$\nHere, $\\beta = (RT)^{-1}$, and the angle brackets denote an average over an ensemble of realizations of the forward process.\n\nThe problem states that the distribution of work values for the forward process, $p_{F}(W)$, is a Gaussian with mean $\\mu_{F}$ and standard deviation $\\sigma_{F}$:\n$$\np_{F}(W) = \\frac{1}{\\sigma_{F} \\sqrt{2\\pi}} \\exp\\left(-\\frac{(W-\\mu_{F})^2}{2\\sigma_{F}^2}\\right)\n$$\nTo apply the Jarzynski equality, we must compute the ensemble average $\\langle \\exp(-\\beta W) \\rangle$:\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\int_{-\\infty}^{\\infty} \\exp(-\\beta W) p_{F}(W) \\, dW\n$$\nWe can solve this integral by using the standard result for the moment-generating function of a Gaussian variable. The expectation of $\\exp(kW)$ for a Gaussian variable with mean $\\mu$ and variance $\\sigma^2$ is $\\langle \\exp(kW) \\rangle = \\exp(k\\mu + k^2\\sigma^2/2)$. In our case, $k=-\\beta$, $\\mu=\\mu_F$, and $\\sigma^2=\\sigma_F^2$. Therefore:\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\exp\\left(-\\beta\\mu_{F} + \\frac{(-\\beta)^2\\sigma_{F}^2}{2}\\right) = \\exp\\left(-\\beta\\mu_{F} + \\frac{\\beta^2\\sigma_{F}^2}{2}\\right)\n$$\nEquating this result with the Jarzynski equality:\n$$\n\\exp(-\\beta \\Delta F) = \\exp\\left(-\\beta\\mu_{F} + \\frac{\\beta^2\\sigma_{F}^2}{2}\\right)\n$$\nTaking the natural logarithm of both sides gives:\n$$\n-\\beta \\Delta F = -\\beta\\mu_{F} + \\frac{\\beta^2\\sigma_{F}^2}{2}\n$$\nSolving for $\\Delta F$ by dividing by $-\\beta$:\n$$\n\\Delta F = \\mu_{F} - \\frac{\\beta\\sigma_{F}^2}{2}\n$$\nNow, we substitute the provided numerical values:\n$\\mu_{F} = 7.50\\,\\text{kJ/mol}$\n$\\sigma_{F} = 2.50\\,\\text{kJ/mol}$\n$T = 300\\,\\text{K}$\n$R = 8.314462618\\,\\text{J}\\,(\\text{mol}\\,\\text{K})^{-1}$\n\nFirst, we calculate the product $RT$ and express it in $\\text{kJ/mol}$:\n$$\nRT = (8.314462618\\,\\text{J}\\,(\\text{mol}\\,\\text{K})^{-1})(300\\,\\text{K}) = 2494.3387854\\,\\text{J/mol} = 2.4943387854\\,\\text{kJ/mol}\n$$\nThe term $\\beta\\sigma_{F}^2/2$ is:\n$$\n\\frac{\\beta\\sigma_{F}^2}{2} = \\frac{\\sigma_{F}^2}{2RT} = \\frac{(2.50\\,\\text{kJ/mol})^2}{2 \\times 2.4943387854\\,\\text{kJ/mol}} = \\frac{6.25\\,(\\text{kJ/mol})^2}{4.9886775708\\,\\text{kJ/mol}} \\approx 1.252839\\,\\text{kJ/mol}\n$$\nFinally, we compute $\\Delta F$:\n$$\n\\Delta F = 7.50\\,\\text{kJ/mol} - 1.252839\\,\\text{kJ/mol} = 6.247161\\,\\text{kJ/mol}\n$$\nRounding to four significant figures as requested, we obtain $\\Delta F = 6.247\\,\\text{kJ/mol}$.\n\nThe second part of the task is to show that this value of $\\Delta F$ is equal to the crossing point $W_{c}$, defined by $p_{F}(W_{c}) = p_{R}(-W_{c})$. This equality is a direct consequence of the Crooks Fluctuation Theorem, which relates the probability distributions of work for the forward ($p_{F}(W)$) and reverse ($p_{R}(W)$) processes:\n$$\n\\frac{p_{F}(W)}{p_{R}(-W)} = \\exp(\\beta (W - \\Delta F))\n$$\nBy definition, the crossing point $W_{c}$ is the value of $W$ for which $p_{F}(W_{c}) = p_{R}(-W_{c})$. At this point, the ratio on the left-hand side of the Crooks theorem is unity:\n$$\n1 = \\exp(\\beta (W_{c} - \\Delta F))\n$$\nTaking the natural logarithm of both sides implies that the exponent must be zero, which gives $W_c = \\Delta F$. This general result confirms that the free energy difference corresponds to the work value at which the forward and reverse work distributions cross.\n\nTo further verify this using the given Gaussian forms, we explicitly solve for $W_c$. The reverse work distribution is a Gaussian with mean $\\mu_{R}$ and standard deviation $\\sigma_{R}$, so the distribution for $-W$ (from the reverse process) is a Gaussian with mean $-\\mu_{R}$ and standard deviation $\\sigma_{R}$. For the Crooks theorem to hold, it is necessary that $\\sigma_{F} = \\sigma_{R}$. The given data, $\\sigma_F = \\sigma_R = 2.50\\,\\text{kJ/mol}$, satisfies this. Let $\\sigma = \\sigma_F = \\sigma_R$. The condition $p_{F}(W_{c}) = p_{R}(-W_{c})$ simplifies to:\n$$\n(W_{c}-\\mu_{F})^2 = (W_{c}+\\mu_{R})^2\n$$\n$$\nW_{c}^2 - 2W_{c}\\mu_{F} + \\mu_{F}^2 = W_{c}^2 + 2W_{c}\\mu_{R} + \\mu_{R}^2\n$$\n$$\n\\mu_{F}^2 - \\mu_{R}^2 = 2W_{c}(\\mu_{F} + \\mu_{R})\n$$\n$$\n(\\mu_{F} - \\mu_{R})(\\mu_{F} + \\mu_{R}) = 2W_{c}(\\mu_{F} + \\mu_{R})\n$$\nSince $\\mu_{F} + \\mu_{R} \\neq 0$, we can divide by this term to find $W_c$:\n$$\nW_{c} = \\frac{\\mu_{F} - \\mu_{R}}{2}\n$$\nFurthermore, a necessary condition derived from applying the Crooks theorem to Gaussian work distributions is $\\mu_{F} + \\mu_{R} = \\beta\\sigma^2$. Using this, we can show that our two expressions for $\\Delta F$ and $W_c$ are identical. From the Jarzynski calculation, we had:\n$$\n\\Delta F = \\mu_{F} - \\frac{\\beta\\sigma^2}{2}\n$$\nSubstituting $\\beta\\sigma^2 = \\mu_{F} + \\mu_{R}$:\n$$\n\\Delta F = \\mu_{F} - \\frac{\\mu_{F} + \\mu_{R}}{2} = \\frac{2\\mu_{F} - \\mu_{F} - \\mu_{R}}{2} = \\frac{\\mu_{F} - \\mu_{R}}{2}\n$$\nThis is precisely the expression for $W_c$, thus proving that $\\Delta F = W_c$ for Gaussian work distributions. Both derivations yield the same numerical result:\n$$\n\\Delta F = W_c = \\frac{7.50\\,\\text{kJ/mol} - (-4.994\\,\\text{kJ/mol})}{2} = \\frac{12.494\\,\\text{kJ/mol}}{2} = 6.247\\,\\text{kJ/mol}\n$$\nThis confirms the consistency of the problem data with the fluctuation theorems and provides the same final answer.",
            "answer": "$$\n\\boxed{6.247}\n$$"
        },
        {
            "introduction": "Beyond analysis, non-equilibrium theorems provide a powerful framework for *designing* more efficient molecular simulations. This advanced practice explores the frontier of optimal control, where the goal is to minimize dissipated work—and thus statistical error—for a fixed simulation time . By deriving the generalized friction and applying the calculus of variations, you will construct an adaptive protocol that \"slows down\" in regions of high resistance, demonstrating a sophisticated application of thermodynamic principles to computational methodology.",
            "id": "3428941",
            "problem": "Consider a one-dimensional overdamped Brownian particle with position $x(t)$ evolving in a harmonic potential $U(x;\\lambda) = \\tfrac{1}{2}\\,k\\,x^{2}$, where the control parameter is the stiffness $\\lambda \\equiv k$. The dynamics obey the overdamped Langevin equation with linear restoring force and thermal noise that satisfies the fluctuation–dissipation relation. Assume reduced units in which Boltzmann’s constant is absorbed into the inverse temperature, so that $\\beta \\equiv 1/(k_{\\mathrm{B}}T)$ is dimensionless, and the friction coefficient $\\gamma$ and the protocol time $T$ are also expressed in reduced units. The system is initially equilibrated at inverse temperature $\\beta$ and stiffness $k$.\n\nUsing the Green–Kubo definition of generalized friction for a control parameter, namely\n$$\n\\zeta(\\lambda) \\equiv \\beta \\int_{0}^{\\infty} \\langle \\delta F(0)\\,\\delta F(t)\\rangle_{\\lambda}\\,\\mathrm{d}t,\n$$\nwith generalized force $F \\equiv -\\partial U/\\partial \\lambda$ and $\\delta F \\equiv F - \\langle F\\rangle_{\\lambda}$ computed in equilibrium at fixed $\\lambda$, perform the following tasks from first principles:\n\n1. Derive, in closed form, the function $\\zeta(k)$ for the model above by evaluating the equilibrium time autocorrelation function under the harmonic dynamics and integrating it over time. You must start from the overdamped equation of motion, use the fluctuation–dissipation relation for the noise strength, determine the two-time correlation function of $x(t)$ at equilibrium, and then construct the needed correlation of the generalized force.\n\n2. Consider driving the system from an initial stiffness $k_{0}$ at time $t=0$ to a final stiffness $k_{1}$ at time $t=T$ via a differentiable protocol $k(t)$ with fixed endpoints and fixed total duration $T$. In the near-equilibrium slow-driving regime, the mean dissipated work functional is\n$$\n\\langle W_{\\mathrm{diss}}\\rangle \\approx \\int_{0}^{T} \\zeta(k(t)) \\left(\\frac{\\mathrm{d}k}{\\mathrm{d}t}\\right)^{2}\\,\\mathrm{d}t.\n$$\nUsing calculus of variations, derive the protocol $k(t)$ that minimizes this functional under the stated constraints, and obtain the corresponding minimal value of $\\langle W_{\\mathrm{diss}}\\rangle$ in terms of an integral depending only on $\\zeta(k)$, the endpoints $(k_{0},k_{1})$, and the duration $T$. Your derivation must proceed from the functional and the Euler–Lagrange condition for this class of functionals.\n\n3. For comparison, define the uniform-in-parameter protocol as $k_{\\mathrm{uni}}(t) = k_{0} + (k_{1}-k_{0})\\,t/T$, and compute its associated $\\langle W_{\\mathrm{diss}}\\rangle$ by evaluating the integral above.\n\n4. For each parameter tuple $(\\beta,\\gamma,T,k_{0},k_{1})$ in the following test suite, compute the ratio $r \\equiv \\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{adapt}}/\\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{uni}}$, where $\\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{adapt}}$ is the minimal value obtained from your optimal protocol in item 2 and $\\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{uni}}$ is the value for the uniform-in-parameter protocol in item 3. Report each ratio as a float rounded to six decimal places.\n\nTest suite (each tuple is $(\\beta,\\gamma,T,k_{0},k_{1})$):\n- $(1.0,\\,1.0,\\,1.0,\\,0.5,\\,4.0)$\n- $(0.5,\\,2.0,\\,1.0,\\,0.25,\\,3.0)$\n- $(1.0,\\,1.0,\\,10.0,\\,0.2,\\,2.0)$\n- $(1.0,\\,0.1,\\,0.5,\\,3.0,\\,0.4)$\n- $(2.0,\\,5.0,\\,3.0,\\,0.8,\\,1.2)$\n\nYour program should produce a single line of output containing the five results as a comma-separated list enclosed in square brackets (for example, \"[r1,r2,r3,r4,r5]\"), with no spaces.",
            "solution": "**Task 1: Derivation of the Generalized Friction $\\zeta(k)$**\n\nThe problem considers a one-dimensional overdamped Brownian particle in a harmonic potential $U(x; k) = \\frac{1}{2} k x^2$. The dynamics are governed by the overdamped Langevin equation:\n$$ \\gamma \\frac{dx}{dt} = - \\frac{\\partial U}{\\partial x} + \\eta(t) = -k x + \\eta(t) $$\nwhere $\\gamma$ is the friction coefficient and $\\eta(t)$ is a white noise term with zero mean, $\\langle \\eta(t) \\rangle = 0$, and a correlation given by the fluctuation-dissipation theorem:\n$$ \\langle \\eta(t)\\eta(t') \\rangle = 2 \\gamma k_{\\mathrm{B}} T \\delta(t-t') = \\frac{2\\gamma}{\\beta} \\delta(t-t') $$\nHere, we use the reduced unit definition $\\beta = 1/(k_{\\mathrm{B}}T)$.\n\nThe Langevin equation can be written as an Ornstein-Uhlenbeck process:\n$$ \\frac{dx}{dt} = -\\frac{k}{\\gamma} x(t) + \\frac{1}{\\gamma}\\eta(t) $$\nThe equilibrium time autocorrelation function of the position $x(t)$, for a system at fixed stiffness $k$, can be found by solving this equation. For $t \\ge 0$, the correlation is:\n$$ \\langle x(0)x(t) \\rangle_k = \\langle x^2 \\rangle_k e^{-(k/\\gamma)t} $$\nThe mean-square displacement $\\langle x^2 \\rangle_k$ at equilibrium is determined by the Boltzmann distribution $p(x) \\propto e^{-\\beta U(x)} = e^{-\\beta k x^2/2}$. This is a Gaussian distribution with variance $\\sigma^2 = \\langle x^2 \\rangle_k = (\\beta k)^{-1}$.\nThus, the position autocorrelation function for $t \\ge 0$ is:\n$$ \\langle x(0)x(t) \\rangle_k = \\frac{1}{\\beta k} e^{-k t/\\gamma} $$\nThe generalized force $F$ is defined with respect to the control parameter $\\lambda=k$:\n$$ F \\equiv -\\frac{\\partial U}{\\partial k} = -\\frac{\\partial}{\\partial k} \\left( \\frac{1}{2} k x^2 \\right) = -\\frac{1}{2} x^2 $$\nIts equilibrium average is:\n$$ \\langle F \\rangle_k = \\left\\langle -\\frac{1}{2} x^2 \\right\\rangle_k = -\\frac{1}{2} \\langle x^2 \\rangle_k = -\\frac{1}{2\\beta k} $$\nThe fluctuation of the generalized force is $\\delta F(t) = F(t) - \\langle F \\rangle_k = -\\frac{1}{2}(x(t)^2 - \\langle x^2 \\rangle_k)$. We need its time autocorrelation function, $\\langle \\delta F(0)\\delta F(t) \\rangle_k$.\n$$ \\langle \\delta F(0)\\delta F(t) \\rangle_k = \\left\\langle \\left(-\\frac{1}{2}(x(0)^2 - \\langle x^2 \\rangle_k)\\right) \\left(-\\frac{1}{2}(x(t)^2 - \\langle x^2 \\rangle_k)\\right) \\right\\rangle_k $$\n$$ = \\frac{1}{4} \\left( \\langle x(0)^2 x(t)^2 \\rangle_k - \\langle x^2 \\rangle_k^2 \\right) $$\nSince $x(t)$ is a Gaussian process with zero mean, we can use Wick's theorem (or Isserlis' theorem) for the four-point correlation function:\n$$ \\langle x(0)^2 x(t)^2 \\rangle_k = \\langle x(0)x(0)x(t)x(t) \\rangle_k = \\langle x(0)^2 \\rangle_k \\langle x(t)^2 \\rangle_k + 2 \\langle x(0)x(t) \\rangle_k^2 $$\n$$ = (\\langle x^2 \\rangle_k)^2 + 2 \\left( \\frac{1}{\\beta k} e^{-k t/\\gamma} \\right)^2 $$\nSubstituting this back, we get:\n$$ \\langle \\delta F(0)\\delta F(t) \\rangle_k = \\frac{1}{4} \\left( (\\langle x^2 \\rangle_k)^2 + 2\\frac{e^{-2kt/\\gamma}}{(\\beta k)^2} - (\\langle x^2 \\rangle_k)^2 \\right) = \\frac{1}{2(\\beta k)^2} e^{-2kt/\\gamma} $$\nThe generalized friction $\\zeta(k)$ is defined as:\n$$ \\zeta(k) = \\beta \\int_{0}^{\\infty} \\langle \\delta F(0)\\delta F(t) \\rangle_k dt = \\beta \\int_{0}^{\\infty} \\frac{1}{2(\\beta k)^2} e^{-2kt/\\gamma} dt $$\n$$ = \\frac{1}{2\\beta k^2} \\int_{0}^{\\infty} e^{-2kt/\\gamma} dt = \\frac{1}{2\\beta k^2} \\left[ -\\frac{\\gamma}{2k} e^{-2kt/\\gamma} \\right]_0^\\infty = \\frac{1}{2\\beta k^2} \\left( \\frac{\\gamma}{2k} \\right) $$\nThis yields the closed-form expression for the generalized friction:\n$$ \\zeta(k) = \\frac{\\gamma}{4\\beta k^3} $$\n\n**Task 2: Optimal Protocol and Minimal Dissipated Work**\n\nWe aim to find the protocol $k(t)$ that minimizes the dissipated work functional:\n$$ \\langle W_{\\mathrm{diss}}\\rangle[k] = \\int_{0}^{T} \\zeta(k(t)) \\left(\\frac{dk}{dt}\\right)^{2} dt $$\nThe Lagrangian for this variational problem is $L(k, \\dot{k}) = \\zeta(k) \\dot{k}^2$. Since $L$ does not explicitly depend on time $t$, we can use the Beltrami identity, which states that $L - \\dot{k} \\frac{\\partial L}{\\partial \\dot{k}}$ is a constant.\n$$ \\frac{\\partial L}{\\partial \\dot{k}} = 2 \\zeta(k) \\dot{k} $$\n$$ L - \\dot{k} \\frac{\\partial L}{\\partial \\dot{k}} = \\zeta(k) \\dot{k}^2 - \\dot{k} (2 \\zeta(k) \\dot{k}) = -\\zeta(k) \\dot{k}^2 = \\text{constant} $$\nTherefore, for the optimal protocol, $\\zeta(k(t)) \\dot{k}(t)^2 = C_1$, where $C_1$ is a non-negative constant. This can be written as $\\sqrt{\\zeta(k)} \\dot{k} = C_2$, where $C_2 = \\sqrt{C_1}$.\nSeparating variables, we have $\\sqrt{\\zeta(k)} dk = C_2 dt$. Integrating from $t=0$ to $t=T$ with boundary conditions $k(0)=k_0$ and $k(T)=k_1$:\n$$ \\int_{k_0}^{k_1} \\sqrt{\\zeta(k')} dk' = \\int_0^T C_2 dt = C_2 T $$\nThis determines the constant $C_2 = \\frac{1}{T} \\int_{k_0}^{k_1} \\sqrt{\\zeta(k')} dk'$.\nThe minimal dissipated work, $\\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{adapt}}$, is the value of the functional evaluated along this optimal path:\n$$ \\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{adapt}} = \\int_0^T \\zeta(k(t)) \\dot{k}(t)^2 dt = \\int_0^T C_1 dt = C_1 T $$\nSince $C_1 = C_2^2$, we have:\n$$ \\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{adapt}} = C_2^2 T = \\left( \\frac{1}{T} \\int_{k_0}^{k_1} \\sqrt{\\zeta(k')} dk' \\right)^2 T = \\frac{1}{T} \\left( \\int_{k_0}^{k_1} \\sqrt{\\zeta(k')} dk' \\right)^2 $$\nNow we substitute our derived $\\zeta(k) = \\frac{\\gamma}{4\\beta k^3}$:\n$$ \\sqrt{\\zeta(k)} = \\sqrt{\\frac{\\gamma}{4\\beta k^3}} = \\frac{\\sqrt{\\gamma}}{2\\sqrt{\\beta}} k^{-3/2} $$\nThe integral becomes:\n$$ \\int_{k_0}^{k_1} \\frac{\\sqrt{\\gamma}}{2\\sqrt{\\beta}} (k')^{-3/2} dk' = \\frac{\\sqrt{\\gamma}}{2\\sqrt{\\beta}} \\left[ \\frac{(k')^{-1/2}}{-1/2} \\right]_{k_0}^{k_1} = \\frac{\\sqrt{\\gamma}}{\\sqrt{\\beta}} \\left( k_0^{-1/2} - k_1^{-1/2} \\right) $$\nThe minimal dissipated work is therefore:\n$$ \\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{adapt}} = \\frac{1}{T} \\left[ \\frac{\\sqrt{\\gamma}}{\\sqrt{\\beta}} (k_0^{-1/2} - k_1^{-1/2}) \\right]^2 = \\frac{\\gamma}{\\beta T} (k_0^{-1/2} - k_1^{-1/2})^2 $$\n\n**Task 3: Dissipated Work for Uniform Protocol**\n\nFor the uniform-in-parameter protocol, $k_{\\mathrm{uni}}(t) = k_0 + (k_1-k_0)t/T$. The rate of change is a constant:\n$$ \\frac{dk_{\\mathrm{uni}}}{dt} = \\frac{k_1-k_0}{T} $$\nThe dissipated work is calculated by direct integration:\n$$ \\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{uni}} = \\int_0^T \\zeta(k_{\\mathrm{uni}}(t)) \\left(\\frac{dk_{\\mathrm{uni}}}{dt}\\right)^2 dt = \\int_0^T \\frac{\\gamma}{4\\beta (k_{\\mathrm{uni}}(t))^3} \\left(\\frac{k_1-k_0}{T}\\right)^2 dt $$\n$$ = \\frac{\\gamma(k_1-k_0)^2}{4\\beta T^2} \\int_0^T \\frac{1}{(k_0 + (k_1-k_0)t/T)^3} dt $$\nTo evaluate the integral, we change variables to $k = k_{\\mathrm{uni}}(t)$. Then $dk = (k_1-k_0)/T dt$, so $dt = T/(k_1-k_0) dk$. The integration limits change from $(0,T)$ for $t$ to $(k_0,k_1)$ for $k$.\n$$ \\int_0^T \\frac{dt}{(k_{\\mathrm{uni}}(t))^3} = \\int_{k_0}^{k_1} \\frac{1}{k^3} \\frac{T}{k_1-k_0} dk = \\frac{T}{k_1-k_0} \\left[ \\frac{k^{-2}}{-2} \\right]_{k_0}^{k_1} $$\n$$ = \\frac{T}{2(k_1-k_0)} (k_0^{-2} - k_1^{-2}) = \\frac{T}{2(k_1-k_0)} \\frac{k_1^2 - k_0^2}{k_0^2 k_1^2} = \\frac{T(k_1+k_0)}{2k_0^2 k_1^2} $$\nSubstituting this result back into the expression for work:\n$$ \\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{uni}} = \\frac{\\gamma(k_1-k_0)^2}{4\\beta T^2} \\left(\\frac{T(k_1+k_0)}{2k_0^2 k_1^2}\\right) = \\frac{\\gamma}{8\\beta T} \\frac{(k_1-k_0)^2(k_1+k_0)}{k_0^2 k_1^2} $$\n\n**Task 4: Ratio of Dissipated Works**\n\nWe compute the ratio $r = \\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{adapt}} / \\langle W_{\\mathrm{diss}}\\rangle_{\\mathrm{uni}}$. The common prefactor $\\gamma/(\\beta T)$ cancels.\n$$ r = \\frac{(k_0^{-1/2} - k_1^{-1/2})^2}{\\frac{(k_1-k_0)^2(k_1+k_0)}{8k_0^2 k_1^2}} $$\nLet's simplify the expression. The numerator is $(k_0^{-1/2} - k_1^{-1/2})^2 = \\left(\\frac{\\sqrt{k_1}-\\sqrt{k_0}}{\\sqrt{k_0k_1}}\\right)^2 = \\frac{(\\sqrt{k_1}-\\sqrt{k_0})^2}{k_0k_1}$.\nThe ratio becomes:\n$$ r = \\frac{(\\sqrt{k_1}-\\sqrt{k_0})^2}{k_0k_1} \\cdot \\frac{8k_0^2 k_1^2}{(k_1-k_0)^2(k_1+k_0)} = \\frac{8k_0k_1(\\sqrt{k_1}-\\sqrt{k_0})^2}{(k_1-k_0)^2(k_1+k_0)} $$\nUsing the identity $k_1-k_0 = (\\sqrt{k_1}-\\sqrt{k_0})(\\sqrt{k_1}+\\sqrt{k_0})$, the denominator contains $(k_1-k_0)^2 = (\\sqrt{k_1}-\\sqrt{k_0})^2(\\sqrt{k_1}+\\sqrt{k_0})^2$.\n$$ r = \\frac{8k_0k_1(\\sqrt{k_1}-\\sqrt{k_0})^2}{(\\sqrt{k_1}-\\sqrt{k_0})^2(\\sqrt{k_1}+\\sqrt{k_0})^2(k_1+k_0)} $$\nCanceling the common term $(\\sqrt{k_1}-\\sqrt{k_0})^2$ (since $k_1 \\ne k_0$ for all test cases), we get the final expression for the ratio, which is independent of $\\beta$, $\\gamma$, and $T$:\n$$ r = \\frac{8k_0k_1}{(k_1+k_0)(\\sqrt{k_0}+\\sqrt{k_1})^2} $$\nThis expression will be used for the numerical computation. It is symmetric with respect to swapping $k_0$ and $k_1$, so it is valid whether $k$ is increasing or decreasing.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding the ratio of dissipated work for optimal\n    and uniform protocols for a driven overdamped Brownian particle in a\n    harmonic potential.\n    \"\"\"\n    # The derived ratio of dissipated work (adaptive vs. uniform) is:\n    # r = (8 * k0 * k1) / ((k1 + k0) * (sqrt(k0) + sqrt(k1))^2)\n    # This ratio is independent of beta, gamma, and T.\n\n    def calculate_ratio(k0, k1):\n        \"\"\"\n        Calculates the ratio r based on the derived formula.\n        \n        Args:\n            k0 (float): Initial stiffness.\n            k1 (float): Final stiffness.\n        \n        Returns:\n            float: The ratio r.\n        \"\"\"\n        if k0 = 0 or k1 = 0:\n            raise ValueError(\"Stiffness parameters k0 and k1 must be positive.\")\n        \n        # Use np.sqrt for vectorized square root operation\n        sqrt_k0 = np.sqrt(k0)\n        sqrt_k1 = np.sqrt(k1)\n        \n        numerator = 8.0 * k0 * k1\n        denominator = (k1 + k0) * (sqrt_k0 + sqrt_k1)**2\n        \n        # The case k0 == k1 would lead to a 0/0-like situation in the derivation,\n        # but the functional would be zero for both protocols (since dk/dt=0),\n        # making the ratio undefined. The problem cases avoid this.\n        if abs(denominator)  1e-12:\n             # This case should not be reached with the given test_cases\n            return 1.0 if abs(numerator)  1e-12 else np.inf\n\n        return numerator / denominator\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (beta, gamma, T, k0, k1)\n    test_cases = [\n        (1.0, 1.0, 1.0, 0.5, 4.0),\n        (0.5, 2.0, 1.0, 0.25, 3.0),\n        (1.0, 1.0, 10.0, 0.2, 2.0),\n        (1.0, 0.1, 0.5, 3.0, 0.4),\n        (2.0, 5.0, 3.0, 0.8, 1.2)\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the parameters. Only k0 and k1 are needed for the ratio.\n        _beta, _gamma, _T, k0, k1 = case\n        \n        # Calculate the ratio for the current case\n        ratio = calculate_ratio(k0, k1)\n        \n        # Format the result to six decimal places\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}