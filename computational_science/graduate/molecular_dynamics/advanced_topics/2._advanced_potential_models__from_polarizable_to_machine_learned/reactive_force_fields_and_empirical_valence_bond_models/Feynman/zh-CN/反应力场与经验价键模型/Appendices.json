{
    "hands_on_practices": [
        {
            "introduction": "经验价键（EVB）模型是模拟化学反应的强大工具，它通过混合代表反应物和产物的两个或多个“非绝热”态来描述反应过程。本练习  提供了亲手推导 EVB 势能面关键特征的机会，即从非绝热态及其耦合的基本性质出发，确定过渡态的位置和能垒的高度。",
            "id": "3441390",
            "problem": "考虑在经验价键 (EVB) 框架内建模的一维反应事件，其中势能面由一个两态非绝热哈密顿量表示。每个非绝热态由一个具有相同曲率的谐振势描述，其中心位于反应坐标上的不同位置。具体来说，设非绝热能量由 $E_{i}(x)=\\frac{1}{2}k\\left(x-x_{i}\\right)^{2}+E_{i}^{0}$ 给出，其中 $i\\in\\{1,2\\}$，$k0$ 是曲率（力常数），$x$ 是反应坐标，$x_{i}$ 是非绝热势能极小点位置且 $x_{1}\\neq x_{2}$，$E_{i}^{0}$ 是恒定的能量偏移。在非绝热基下，EVB 哈密顿量是一个 $2\\times 2$ 的对称矩阵，其对角元为 $E_{1}(x)$ 和 $E_{2}(x)$，非对角耦合为常数 $H_{12}$（假定为实数），因此 $$H(x)=\\begin{pmatrix}E_{1}(x)  H_{12} \\\\ H_{12}  E_{2}(x)\\end{pmatrix}$$。从非绝热态与绝热态的基本定义以及绝热能量通过对角化哈密顿矩阵获得的要求出发，推导：\n1. 反应坐标上非绝热面交叉的位置 $x_{c}$，其定义为 $E_{1}(x_{c})=E_{2}(x_{c})$。\n2. 由非零 $H_{12}$ 引起的绝热面之间的最小能量分裂（避免交叉间隙），并用模型参数表示。\n\n请用符号 $k$、$x_{1}$、$x_{2}$、$E_{1}^{0}$、$E_{2}^{0}$ 和 $H_{12}$ 表示您的最终表达式。位置以纳米为单位，能量以千焦/摩尔为单位。不需代入数值，也无需四舍五入。您的最终答案必须是单个解析表达式或包含两个结果的行矩阵。",
            "solution": "该问题经评估有效。它在科学上基于经验价键 (EVB) 模型的标准理论框架，在数学上是适定的，并且可以根据所提供的信息推导出客观的解。关于以特定单位表示最终结果的指令，在给定无单位的符号参数的情况下，被解释为对结果物理诠释的上下文指导，而非对符号表达式的字面约束。推导出的符号表达式将在量纲上保持一致。\n\n该问题要求推导两个量：非绝热交叉点的位置 $x_c$，以及两个绝热势能面之间的最小能量分裂。\n\n**1. 推导非绝热交叉点位置 $x_c$**\n\n非绝热势能面的交叉点定义为反应坐标 $x$ 上的点 $x_c$，在该点两个非绝热态的能量相等。该条件表示为 $E_1(x_c) = E_2(x_c)$。\n非绝热能量由以下表达式给出：\n$$E_1(x) = \\frac{1}{2}k(x-x_1)^2 + E_1^0$$\n$$E_2(x) = \\frac{1}{2}k(x-x_2)^2 + E_2^0$$\n在 $x = x_c$ 处令二者相等：\n$$\\frac{1}{2}k(x_c-x_1)^2 + E_1^0 = \\frac{1}{2}k(x_c-x_2)^2 + E_2^0$$\n为了求解 $x_c$，我们首先展开平方二项式：\n$$\\frac{1}{2}k(x_c^2 - 2x_c x_1 + x_1^2) + E_1^0 = \\frac{1}{2}k(x_c^2 - 2x_c x_2 + x_2^2) + E_2^0$$\n两边同乘以 $2$ 并展开含常数 $k$ 的项，得到：\n$$k x_c^2 - 2k x_c x_1 + k x_1^2 + 2E_1^0 = k x_c^2 - 2k x_c x_2 + k x_2^2 + 2E_2^0$$\n$k x_c^2$ 项在等式两边都出现，可以消去。然后我们重新整理方程，以分离出含 $x_c$ 的项：\n$$2k x_c x_2 - 2k x_c x_1 = k x_2^2 - k x_1^2 + 2E_2^0 - 2E_1^0$$\n在左边提取公因式 $2k x_c$，在右边提取 $k$ 和 $2$：\n$$2k x_c (x_2 - x_1) = k (x_2^2 - x_1^2) + 2(E_2^0 - E_1^0)$$\n利用平方差公式 $x_2^2 - x_1^2 = (x_2 - x_1)(x_2 + x_1)$，我们将其代入方程：\n$$2k x_c (x_2 - x_1) = k (x_2 - x_1)(x_2 + x_1) + 2(E_2^0 - E_1^0)$$\n问题指定 $x_1 \\neq x_2$ 且 $k0$，因此可以用 $2k(x_2-x_1)$ 来除。这样就分离出了 $x_c$：\n$$x_c = \\frac{k(x_2 - x_1)(x_2 + x_1)}{2k(x_2 - x_1)} + \\frac{2(E_2^0 - E_1^0)}{2k(x_2 - x_1)}$$\n简化表达式得到非绝热交叉点的位置：\n$$x_c = \\frac{1}{2}(x_1 + x_2) + \\frac{E_2^0 - E_1^0}{k(x_2 - x_1)}$$\n\n**2. 推导最小绝热能量分裂**\n\n绝热势能面，记作 $E_{\\pm}(x)$，是 EVB 哈密顿矩阵 $H(x)$ 的本征值。本征值 $\\lambda$ 通过求解特征方程 $\\det(H(x) - \\lambda I) = 0$ 得到，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$H(x) = \\begin{pmatrix} E_1(x)  H_{12} \\\\ H_{12}  E_2(x) \\end{pmatrix}$$\n特征方程为：\n$$\\det \\begin{pmatrix} E_1(x) - \\lambda  H_{12} \\\\ H_{12}  E_2(x) - \\lambda \\end{pmatrix} = 0$$\n$$(E_1(x) - \\lambda)(E_2(x) - \\lambda) - H_{12}^2 = 0$$\n这是一个关于 $\\lambda$ 的二次方程：\n$$\\lambda^2 - (E_1(x) + E_2(x))\\lambda + E_1(x)E_2(x) - H_{12}^2 = 0$$\n$\\lambda$ 的解，即绝热能量 $E_{\\pm}(x)$，可以通过二次方程求根公式找到：\n$$E_{\\pm}(x) = \\frac{(E_1(x) + E_2(x)) \\pm \\sqrt{(E_1(x) + E_2(x))^2 - 4(E_1(x)E_2(x) - H_{12}^2)}}{2}$$\n我们来简化判别式：\n$$(E_1(x) + E_2(x))^2 - 4E_1(x)E_2(x) + 4H_{12}^2 = E_1(x)^2 + 2E_1(x)E_2(x) + E_2(x)^2 - 4E_1(x)E_2(x) + 4H_{12}^2$$\n$$= E_1(x)^2 - 2E_1(x)E_2(x) + E_2(x)^2 + 4H_{12}^2 = (E_1(x) - E_2(x))^2 + 4H_{12}^2$$\n将此结果代回本征值的表达式中，得到绝热能量：\n$$E_{\\pm}(x) = \\frac{1}{2}(E_1(x) + E_2(x)) \\pm \\frac{1}{2}\\sqrt{(E_1(x) - E_2(x))^2 + 4H_{12}^2}$$\n在任意位置 $x$ 处，两个绝热面之间的能量分裂或间隙为 $\\Delta E(x) = E_+(x) - E_-(x)$：\n$$\\Delta E(x) = \\sqrt{(E_1(x) - E_2(x))^2 + 4H_{12}^2}$$\n为了找到最小能量分裂，我们必须找到 $\\Delta E(x)$ 的最小值。$4H_{12}^2$ 项是一个正常数（因为 $H_{12}$ 是实数）。$(E_1(x) - E_2(x))^2$ 项是一个关于 $x$ 的非负函数。$\\Delta E(x)$ 的最小值将出现在使 $(E_1(x) - E_2(x))^2$ 最小化的位置 $x$。一个实数平方的最小可能值为 $0$，这发生在 $E_1(x) = E_2(x)$ 时。\n这个条件 $E_1(x) = E_2(x)$ 正是非绝热交叉点 $x_c$ 的定义。因此，最小能量分裂发生在 $x=x_c$ 处。\n在该点，最小分裂 $\\Delta E_{min}$ 为：\n$$\\Delta E_{min} = \\Delta E(x_c) = \\sqrt{(E_1(x_c) - E_2(x_c))^2 + 4H_{12}^2} = \\sqrt{0^2 + 4H_{12}^2} = \\sqrt{4H_{12}^2}$$\n由于能量分裂必须是一个非负量，我们取正根：\n$$\\Delta E_{min} = 2|H_{12}|$$\n这表明非对角耦合 $H_{12}$ 直接决定了避免交叉间隙的大小。如果 $H_{12}=0$，则间隙为零，绝热面在 $x_c$ 处交叉。如果 $H_{12} \\neq 0$，则简并被解除，势能面表现出避免交叉，其最小间距为 $2|H_{12}|$。\n\n因此，所要求的两个量是交叉位置 $x_c$ 和最小能量分裂 $\\Delta E_{min}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2}(x_1 + x_2) + \\frac{E_2^0 - E_1^0}{k(x_2 - x_1)}  2|H_{12}| \\end{pmatrix} } $$"
        },
        {
            "introduction": "像 ReaxFF 这样的反应力场必须能够平滑地描述化学键的形成和断裂。这是通过使所有能量项（如键角）都依赖于键级来实现的，而键级会随着化学键的解离平滑地趋近于零。通过这个练习 ，您将推导角作用力的解析形式，并从数学上证明该力如何在化学键断裂时正确地消失，这是基于键级的势函数的一个基石。",
            "id": "3441417",
            "problem": "考虑一个三原子系统，其中原子 $A$、$B$ 和 $C$ 的位置分别为 $\\mathbf{r}_{A}$、$\\mathbf{r}_{B}$ 和 $\\mathbf{r}_{C}$，位于 $\\mathbb{R}^{3}$ 中。定义键矢量 $\\mathbf{a} \\equiv \\mathbf{r}_{A} - \\mathbf{r}_{B}$ 和 $\\mathbf{c} \\equiv \\mathbf{r}_{C} - \\mathbf{r}_{B}$，键长分别为 $r_{AB} \\equiv \\|\\mathbf{a}\\|$ 和 $r_{BC} \\equiv \\|\\mathbf{c}\\|$。设 $B$ 处的夹角为 $\\theta \\in (0,\\pi)$，其定义为 $\\cos \\theta \\equiv \\dfrac{\\mathbf{a} \\cdot \\mathbf{c}}{r_{AB}\\, r_{BC}}$。在反应力场 (ReaxFF) 风格的角度相互作用中，角能量由平滑依赖于键长的键级进行调制。考虑以下角能量\n$$\nE_{\\theta}(\\mathbf{r}_{A},\\mathbf{r}_{B},\\mathbf{r}_{C}) \\equiv \\frac{1}{2}\\,k_{\\theta}\\,b_{AB}(r_{AB})\\,b_{BC}(r_{BC})\\,\\big(\\theta - \\theta_{0}\\big)^{2},\n$$\n其中 $k_{\\theta}  0$ 是角度刚度，$\\theta_{0} \\in (0,\\pi)$ 是参考角度，键级由以下平滑衰减函数给出\n$$\nb_{AB}(r_{AB}) \\equiv \\exp\\!\\big(-\\alpha\\,(r_{AB} - r_{0})\\big),\\qquad\nb_{BC}(r_{BC}) \\equiv \\exp\\!\\big(-\\alpha\\,(r_{BC} - r_{0})\\big),\n$$\n其中参数 $\\alpha  0$ 且 $r_{0}  0$。这种形式是反应力场 (ReaxFF) 和经验价键 (EVB) 启发模型中使用的平滑消失的键级权重的简化替代形式。\n\n仅从上述定义、牛顿第二定律和多变量微积分（链式法则和梯度）出发，完成以下任务：\n\n1. 推导由角度项产生的原子 $B$ 上的力 $\\mathbf{F}_{B}^{(\\theta)} \\equiv -\\nabla_{\\mathbf{r}_{B}} E_{\\theta}$，用 $k_{\\theta}$、$b_{AB}$、$b_{BC}$、它们关于 $\\mathbf{r}_{B}$ 的梯度以及 $\\nabla_{\\mathbf{r}_{B}}\\theta$ 来表示你的结果。\n2. 当 $A$–$B$ 键级趋于零时（即当 $r_{AB} \\to \\infty$ 使得 $b_{AB}(r_{AB}) \\to 0$ 时），计算 $\\mathbf{F}_{B}^{(\\theta)}$ 的极限。明确证明在此极限下，$B$ 上的角力贡献平滑地消失，并给出 $\\mathbf{F}_{B}^{(\\theta)}$ 的极限表达式。\n\n以牛顿（Newtons）为单位表示最终的力。不需要数值。最终答案必须是因角度项作用于原子 $B$ 上的极限力的单个符号表达式。",
            "solution": "问题陈述具有科学依据、问题明确且客观。它在反应性分子动力学力场的框架内描述了一个简化的、但概念上标准的角势。所有定义在数学上都是精确的，任务是明确定义的微积分问题。因此，该问题被认为是有效的。\n\n解答按要求分为两部分呈现。\n\n### 第一部分：原子 B 上力的推导\n\n由角势 $E_{\\theta}$ 引起的原子 $B$ 上的力由牛顿第二定律以保守力的形式给出，即 $\\mathbf{F}_{B}^{(\\theta)} \\equiv -\\nabla_{\\mathbf{r}_{B}} E_{\\theta}$。势能由以下公式给出：\n$$\nE_{\\theta} = \\frac{1}{2}\\,k_{\\theta}\\,b_{AB}(r_{AB})\\,b_{BC}(r_{BC})\\,\\big(\\theta - \\theta_{0}\\big)^{2}\n$$\n为了计算关于位置矢量 $\\mathbf{r}_{B}$ 的梯度，我们对依赖于 $\\mathbf{r}_{B}$ 的三个因子应用乘法法则进行微分：$b_{AB}(r_{AB})$、$b_{BC}(r_{BC})$ 和 $(\\theta - \\theta_{0})^{2}$。注意 $r_{AB} = \\|\\mathbf{r}_A - \\mathbf{r}_B\\|$、$r_{BC} = \\|\\mathbf{r}_C - \\mathbf{r}_B\\|$ 和 $\\theta$ 都依赖于 $\\mathbf{r}_{B}$。\n\n$$\n\\nabla_{\\mathbf{r}_{B}} E_{\\theta} = \\frac{1}{2}\\,k_{\\theta} \\left[ \\left(\\nabla_{\\mathbf{r}_{B}} b_{AB}\\right) b_{BC} (\\theta - \\theta_{0})^{2} + b_{AB} \\left(\\nabla_{\\mathbf{r}_{B}} b_{BC}\\right) (\\theta - \\theta_{0})^{2} + b_{AB} b_{BC} \\nabla_{\\mathbf{r}_{B}} \\left( (\\theta - \\theta_{0})^{2} \\right) \\right]\n$$\n\n对最后一项使用链式法则，并注意参考角 $\\theta_{0}$ 是一个常数，我们有：\n$$\n\\nabla_{\\mathbf{r}_{B}} \\left( (\\theta - \\theta_{0})^{2} \\right) = 2 (\\theta - \\theta_{0}) \\nabla_{\\mathbf{r}_{B}} (\\theta - \\theta_{0}) = 2 (\\theta - \\theta_{0}) \\nabla_{\\mathbf{r}_{B}}\\theta\n$$\n\n将此代入能量梯度的表达式中，得到：\n$$\n\\nabla_{\\mathbf{r}_{B}} E_{\\theta} = \\frac{1}{2}\\,k_{\\theta}(\\theta - \\theta_{0})^{2} \\left[ (\\nabla_{\\mathbf{r}_{B}}b_{AB}) b_{BC} + b_{AB} (\\nabla_{\\mathbf{r}_{B}}b_{BC}) \\right] + k_{\\theta}\\,b_{AB}\\,b_{BC}\\,(\\theta - \\theta_{0})\\,\\nabla_{\\mathbf{r}_{B}}\\theta\n$$\n\n原子 $B$ 上的力是该梯度的负值：\n$$\n\\mathbf{F}_{B}^{(\\theta)} = -\\frac{1}{2}\\,k_{\\theta}\\,(\\theta - \\theta_{0})^{2} \\left[ b_{BC} \\nabla_{\\mathbf{r}_{B}}b_{AB} + b_{AB} \\nabla_{\\mathbf{r}_{B}}b_{BC} \\right] - k_{\\theta}\\,b_{AB}\\,b_{BC}\\,(\\theta - \\theta_{0})\\,\\nabla_{\\mathbf{r}_{B}}\\theta\n$$\n\n该表达式以 $k_{\\theta}$、$b_{AB}$、$b_{BC}$、它们关于 $\\mathbf{r}_{B}$ 的梯度以及角度的梯度 $\\nabla_{\\mathbf{r}_{B}}\\theta$ 来表示原子 $B$ 上的力，正如问题第一部分所要求的那样。\n\n### 第二部分：力的极限行为\n\n为了计算当键级 $b_{AB}(r_{AB})$ 趋于零时（即 $r_{AB} \\to \\infty$ 时）$\\mathbf{F}_{B}^{(\\theta)}$ 的极限，我们必须分析力表达式中每一项的行为。为此，我们首先需要梯度的显式表达式。\n\n键级函数为 $b_{AB}(r_{AB}) = \\exp(-\\alpha(r_{AB} - r_{0}))$ 和 $b_{BC}(r_{BC}) = \\exp(-\\alpha(r_{BC} - r_{0}))$。它们关于 $\\mathbf{r}_{B}$ 的梯度通过链式法则求得：\n$\\nabla_{\\mathbf{r}_{B}} b_{AB} = \\frac{db_{AB}}{dr_{AB}} \\nabla_{\\mathbf{r}_{B}} r_{AB}$。\n关于键长的导数是 $\\frac{db_{AB}}{dr_{AB}} = -\\alpha \\exp(-\\alpha(r_{AB} - r_{0})) = -\\alpha b_{AB}$。\n键长 $r_{AB} = \\|\\mathbf{r}_{A} - \\mathbf{r}_{B}\\|$ 的梯度是 $\\nabla_{\\mathbf{r}_{B}} r_{AB} = \\frac{\\mathbf{r}_{B} - \\mathbf{r}_{A}}{r_{AB}} = -\\frac{\\mathbf{a}}{r_{AB}} = -\\hat{\\mathbf{a}}$，其中 $\\hat{\\mathbf{a}}$ 是沿 $B$ 到 $A$ 的键方向的单位矢量。\n所以，$\\nabla_{\\mathbf{r}_{B}}b_{AB} = (-\\alpha b_{AB})(-\\hat{\\mathbf{a}}) = \\alpha b_{AB} \\hat{\\mathbf{a}}$。\n通过相同的论证，$\\nabla_{\\mathbf{r}_{B}}b_{BC} = \\alpha b_{BC} \\hat{\\mathbf{c}}$，其中 $\\hat{\\mathbf{c}}$ 是从 $B$ 到 $C$ 的单位矢量。\n\n角度 $\\theta$ 关于 $\\mathbf{r}_{B}$ 的梯度是分子力学中的一个标准结果：\n$$\n\\nabla_{\\mathbf{r}_{B}}\\theta = \\frac{1}{\\sin\\theta} \\left[ \\frac{\\hat{\\mathbf{c}} - (\\hat{\\mathbf{a}} \\cdot \\hat{\\mathbf{c}})\\hat{\\mathbf{a}}}{r_{AB}} + \\frac{\\hat{\\mathbf{a}} - (\\hat{\\mathbf{a}} \\cdot \\hat{\\mathbf{c}})\\hat{\\mathbf{c}}}{r_{BC}} \\right] = \\frac{1}{\\sin\\theta} \\left[ \\frac{\\hat{\\mathbf{c}} - \\cos(\\theta)\\hat{\\mathbf{a}}}{r_{AB}} + \\frac{\\hat{\\mathbf{a}} - \\cos(\\theta)\\hat{\\mathbf{c}}}{r_{BC}} \\right]\n$$\n\n现在我们分析当 $r_{AB} \\to \\infty$ 时 $\\mathbf{F}_{B}^{(\\theta)}$ 的极限：\n$$\n\\mathbf{F}_{B}^{(\\theta)} = \\underbrace{-\\frac{1}{2}\\,k_{\\theta}\\,(\\theta - \\theta_{0})^{2} b_{BC} (\\nabla_{\\mathbf{r}_{B}}b_{AB})}_{\\text{第一项}} \\underbrace{-\\frac{1}{2}\\,k_{\\theta}\\,(\\theta - \\theta_{0})^{2} b_{AB} (\\nabla_{\\mathbf{r}_{B}}b_{BC})}_{\\text{第二项}} \\underbrace{-k_{\\theta}\\,b_{AB}\\,b_{BC}\\,(\\theta - \\theta_{0})\\,(\\nabla_{\\mathbf{r}_{B}}\\theta)}_{\\text{第三项}}\n$$\n\n1.  **核心分量的行为**：\n    -   当 $r_{AB} \\to \\infty$ 时，由于 $\\alpha  0$，键级 $b_{AB} = \\exp(-\\alpha(r_{AB} - r_{0}))$ 衰减至 $0$。\n    -   梯度 $\\nabla_{\\mathbf{r}_{B}}b_{AB} = \\alpha b_{AB} \\hat{\\mathbf{a}}$ 也趋近于 $\\mathbf{0}$，因为它与 $b_{AB}$ 成正比，而 $\\hat{\\mathbf{a}}$ 是一个单位矢量。\n    -   与 $B$-$C$ 键相关的量，$r_{BC}$ 和 $b_{BC}$，与 $\\mathbf{r}_{A}$ 无关，保持不变。梯度 $\\nabla_{\\mathbf{r}_{B}}b_{BC}$ 相对于 $r_{AB}$ 也是常数。\n    -   角度 $\\theta$ 趋近于一个极限值 $\\theta_{\\infty}$，其定义为 $\\cos\\theta_{\\infty} = \\lim_{r_{AB}\\to\\infty} \\frac{\\hat{\\mathbf{a}}\\cdot\\mathbf{c}}{r_{BC}}$。这个极限是良定义的，因此 $\\theta_{\\infty}$ 是一个有限的角度。\n    -   角度的梯度 $\\nabla_{\\mathbf{r}_{B}}\\theta$ 趋近于一个有限的矢量极限。当 $r_{AB} \\to \\infty$ 时，项 $\\frac{\\hat{\\mathbf{c}} - \\cos(\\theta)\\hat{\\mathbf{a}}}{r_{AB}}$ 消失。剩余部分趋近于一个常数矢量，而前置因子 $1/\\sin\\theta$ 不是奇异的（在共线极限的情况下，其分子也会消失，使得分数是良态的）。因此，$\\nabla_{\\mathbf{r}_{B}}\\theta$ 是有界的。\n\n2.  **各项的极限**：\n    -   **第一项**：该项包含因子 $\\nabla_{\\mathbf{r}_{B}}b_{AB}$。由于 $\\lim_{r_{AB}\\to\\infty} \\nabla_{\\mathbf{r}_{B}}b_{AB} = \\mathbf{0}$ 且第一项中的所有其他因子都趋于有限极限，我们有 $\\lim_{r_{AB}\\to\\infty} \\text{第一项} = \\mathbf{0}$。\n    -   **第二项**：该项包含因子 $b_{AB}$。由于 $\\lim_{r_{AB}\\to\\infty} b_{AB} = 0$ 且所有其他因子都有界，我们有 $\\lim_{r_{AB}\\to\\infty} \\text{第二项} = \\mathbf{0}$。\n    -   **第三项**：该项也包含因子 $b_{AB}$。由于 $\\lim_{r_{AB}\\to\\infty} b_{AB} = 0$ 且所有其他因子都有界，我们有 $\\lim_{r_{AB}\\to\\infty} \\text{第三项} = \\mathbf{0}$。\n\n3.  **结论**：\n    和的极限是极限的和。因此，原子 $B$ 上的总力消失：\n    $$\n    \\lim_{r_{AB} \\to \\infty} \\mathbf{F}_{B}^{(\\theta)} = \\mathbf{0} + \\mathbf{0} + \\mathbf{0} = \\mathbf{0}\n    $$\n    这一结果展示了反应力场的一个关键特征。角度相互作用由键级调制，这样当其中一个构成键断裂时（即其长度趋于无穷大），相应的键级消失。这导致整个能量项及其导出的所有力都平滑地消失。键级函数 $b_{AB}(r_{AB})$ 的指数衰减确保了力及其关于 $r_{AB}$ 的所有导数也都趋于零，从而证实了这种截断机制的平滑性。\n\n力 $\\mathbf{F}_{B}^{(\\theta)}$ 的极限表达式是零矢量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在反应模拟中，通过电荷平衡（QEq）等方法精确计算电荷至关重要，但这些计算是在每个时间步长迭代执行的。不完全的数值收敛会引入原子电荷的误差，进而产生虚假的作用力，并在长时间模拟中导致能量不守恒。这个高级练习  将数值容差的抽象概念与一个具体的物理可观测量——总能量漂移——联系起来，挑战您推导出一个确保模拟稳定性和准确性的实用标准。",
            "id": "3441416",
            "problem": "考虑一个采用电荷均衡 (QEq) 方法在每个时间步确定原子部分电荷的反应力场分子动力学模拟。设 QEq 能量写为关于电荷的凸二次型，\n$$\nE_{\\mathrm{QEq}}(q;R)=\\frac{1}{2}\\,q^{\\mathsf{T}} H(R)\\,q - b(R)^{\\mathsf{T}} q + \\mathrm{const},\n$$\n其中 $q \\in \\mathbb{R}^{N}$ 是电荷矢量，$R \\in \\mathbb{R}^{3N}$ 是原子位置，$H(R)$ 是对称正定硬度矩阵，$b(R)$ 依赖于电负性和屏蔽库仑项。终止时的 QEq 残差定义为 $E_{\\mathrm{QEq}}$ 相对于 $q$ 的梯度，\n$$\nr(R,q)=\\nabla_{q} E_{\\mathrm{QEq}}(q;R)=H(R)\\,q - b(R).\n$$\n假设在整个轨迹上一致满足以下条件：\n1. 逆硬度矩阵的谱范数有界，为 $\\|H(R)^{-1}\\|_{2} \\leq 0.1~\\mathrm{eV}^{-1}$。\n2. 算子 $J(R)=\\frac{\\partial^{2} E_{\\mathrm{QEq}}(q;R)}{\\partial R\\,\\partial q}$ 的谱范数有界，为 $\\|J(R)\\|_{2} \\leq 4.0~\\mathrm{eV}/\\mathrm{\\AA}$。\n\n系统包含 $N=100$ 个原子：$60$ 个碳原子（质量为 $12~\\mathrm{amu}$）和 $40$ 个氢原子（质量为 $1~\\mathrm{amu}$）。模拟在温度 $T=300~\\mathrm{K}$ 的正则系综中进行，持续时间为 $1~\\mathrm{ns}$。使用速度的能量均分定理以及转换关系 $1~\\mathrm{amu} = 1.0364 \\times 10^{-4}~\\mathrm{eV}\\cdot\\mathrm{ps}^{2}/\\mathrm{\\AA}^{2}$ 和 $k_{B}=8.617333262145\\times 10^{-5}~\\mathrm{eV/K}$。\n\n从第一性原理出发，分析非零 QEq 残差 $r$ 如何扰动瞬时力，并通过机械功率输入，累积为物理能量的长期漂移。推导在 $1~\\mathrm{ns}$ 轨迹上总能量漂移的一个严格界限（以 $\\|r\\|_{2}$ 表示），然后确定 QEq 残差的欧几里得范数的数值容差，以确保在整个轨迹上总漂移不超过 $10~\\mathrm{kJ/mol}$。\n\n将 $\\|r\\|_{2}$ 的最终容差以电子伏特 (eV) 表示，并将答案四舍五入到三位有效数字。",
            "solution": "该问题要求推导电荷均衡 (QEq) 残差的欧几里得范数 $\\|r\\|_{2}$ 的一个容差，使得在分子动力学轨迹上的累积能量漂移保持在指定阈值以下。推导过程从第一性原理出发，通过量化由不精确电荷解引起的原子力的误差，计算该力误差所做的功，并利用统计力学和给定的参数界限对该功进行限定。\n\n设系统的总势能为 $U(R, q)$，其中与电荷相关的部分由 QEq 能量表达式 $E_{\\mathrm{QEq}}(q; R)$ 给出。作用在原子上的力是总能量相对于原子位置 $R$ 的负梯度。在精确模拟中，电荷 $q_0(R)$ 将在每个构型 $R$ 处通过完美最小化 $E_{\\mathrm{QEq}}$ 来确定，满足条件 $\\nabla_{q} E_{\\mathrm{QEq}}(q_0;R) = 0$。真实的物理力是全导数 $F_0 = -\\frac{d}{dR}U(R,q_0(R))$。使用链式法则，可得 $F_0 = -\\frac{\\partial U}{\\partial R}\\big|_{q_0} - \\left(\\frac{\\partial q_0}{\\partial R}\\right)^{\\mathsf{T}}\\frac{\\partial U}{\\partial q}\\big|_{q_0}$。由于 $\\frac{\\partial U}{\\partial q} = \\nabla_q E_{\\mathrm{QEq}}$，且在最小值点 $q_0$ 处为零，第二项（Pulay 力）消失。因此，真实的力为 $F_0 = -\\frac{\\partial U}{\\partial R}\\big|_{q_0}$。\n\n在实际模拟中，QEq 方程是迭代求解的，得到一个近似电荷矢量 $q$ 和一个非零残差 $r = \\nabla_{q} E_{\\mathrm{QEq}}(q;R)$。大多数模拟代码计算力时采用 $F = -\\frac{\\partial U}{\\partial R}\\big|_{q}$，忽略了对于未收敛电荷而言非零的 Pulay 修正。因此，瞬时力的误差为：\n$$\n\\delta F = F - F_0 = -\\left(\\frac{\\partial U(R,q)}{\\partial R} - \\frac{\\partial U(R,q_0)}{\\partial R}\\right)\n$$\n我们可以通过力表达式在 $q_0$ 附近的一阶泰勒展开，将力误差 $\\delta F$ 与电荷误差 $\\delta q = q - q_0$ 联系起来：\n$$\n\\delta F \\approx - \\frac{\\partial^2 U(R,q_0)}{\\partial R \\partial q} \\delta q\n$$\n问题给出了混合偏导数算子 $J(R) = \\frac{\\partial^2 E_{\\mathrm{QEq}}}{\\partial R \\partial q}$。我们假设 $U$ 对电荷的依赖性完全包含在 $E_{\\mathrm{QEq}}$ 中，因此 $\\frac{\\partial^2 U}{\\partial R \\partial q} = J(R)$。因此，$\\delta F \\approx -J(R)\\,\\delta q$。\n\n接下来，我们将电荷误差 $\\delta q$ 与残差 $r$ 联系起来。残差定义为 $r = \\nabla_q E_{\\mathrm{QEq}}(q;R) = H(R)q - b(R)$。精确解 $q_0$ 满足 $0 = H(R)q_0 - b(R)$。这两个方程相减得到 $H(R)(q-q_0) = r$，这意味着电荷误差为 $\\delta q = H(R)^{-1}r$。\n将此代入力误差表达式可得：\n$$\n\\delta F(R) \\approx -J(R) H(R)^{-1} r\n$$\n这个虚假的力误差对系统做功，导致总能量发生漂移。由此误差引起的瞬时功率输入为 $P_{\\mathrm{err}} = (\\delta F)^{\\mathsf{T}} v$，其中 $v = \\dot{R}$ 是原子速度矢量。在模拟时间 $\\tau$ 内的总能量漂移是该功率的时间积分：\n$$\n\\Delta E_{\\mathrm{drift}} = \\int_0^{\\tau} P_{\\mathrm{err}}(t) \\, dt = -\\int_0^{\\tau} \\left(J(R(t)) H(R(t))^{-1} r(t)\\right)^{\\mathsf{T}} v(t) \\, dt\n$$\n为了找到一个严格的界限，我们使用矢量和矩阵范数的性质。漂移的绝对值有界，如下所示：\n$$\n|\\Delta E_{\\mathrm{drift}}| \\leq \\int_0^{\\tau} \\left| \\left(J H^{-1} r\\right)^{\\mathsf{T}} v \\right| dt\n$$\n根据柯西-施瓦茨不等式，$|x^{\\mathsf{T}}y| \\le \\|x\\|_2 \\|y\\|_2$：\n$$\n|\\Delta E_{\\mathrm{drift}}| \\leq \\int_0^{\\tau} \\|J H^{-1} r\\|_2 \\|v(t)\\|_2 \\, dt\n$$\n使用矩阵的诱导 $L_2$-范数性质 $\\|Ax\\|_2 \\le \\|A\\|_2 \\|x\\|_2$，我们有 $\\|J H^{-1} r\\|_2 \\leq \\|J\\|_2 \\|H^{-1}\\|_2 \\|r\\|_2$。问题给出了统一的界限 $\\|H(R)^{-1}\\|_{2} \\leq C_H = 0.1~\\mathrm{eV}^{-1}$ 和 $\\|J(R)\\|_{2} \\leq C_J = 4.0~\\mathrm{eV}/\\mathrm{\\AA}$。我们寻求一个容差 $r_{\\mathrm{tol}}$，使得在所有时间里 $\\|r\\|_2 \\leq r_{\\mathrm{tol}}$。界限变为：\n$$\n|\\Delta E_{\\mathrm{drift}}| \\leq C_J C_H r_{\\mathrm{tol}} \\int_0^{\\tau} \\|v(t)\\|_2 \\, dt\n$$\n积分项表示所有原子走过的总路径长度。我们可以用统计力学来估计它。根据正则系综系统的遍历性假设，时间平均等于系综平均：$\\int_0^{\\tau} \\|v(t)\\|_2 dt = \\tau \\langle \\|v\\|_2 \\rangle$。根据琴生不等式，$\\langle \\|v\\|_2 \\rangle \\le \\sqrt{\\langle \\|v\\|_2^2 \\rangle}$。项 $\\langle \\|v\\|_2^2 \\rangle$ 是速度矢量范数的均方值。\n$$\n\\langle \\|v\\|_2^2 \\rangle = \\left\\langle \\sum_{j=1}^{N} |v_j|^2 \\right\\rangle = \\left\\langle \\sum_{j=1}^{N} (v_{j,x}^2 + v_{j,y}^2 + v_{j,z}^2) \\right\\rangle = \\sum_{j=1}^{N} \\sum_{\\alpha \\in \\{x,y,z\\}} \\langle v_{j,\\alpha}^2 \\rangle\n$$\n根据能量均分定理，每个自由度的平均动能是 $\\frac{1}{2} k_B T$，所以 $\\langle \\frac{1}{2}m_j v_{j,\\alpha}^2 \\rangle = \\frac{1}{2}k_B T$，这意味着 $\\langle v_{j,\\alpha}^2 \\rangle = \\frac{k_B T}{m_j}$。\n因此，$\\langle \\|v\\|_2^2 \\rangle = \\sum_{j=1}^{N} 3 \\frac{k_B T}{m_j} = 3 k_B T \\sum_{j=1}^{N} \\frac{1}{m_j}$。\n求和是针对所有 $N=100$ 个原子，其中包括 $N_C=60$ 个碳原子和 $N_H=40$ 个氢原子。\n$$\n\\sum_{j=1}^{N} \\frac{1}{m_j} = \\frac{N_C}{m_C} + \\frac{N_H}{m_H}\n$$\n综合这些结果，能量漂移的界限为：\n$$\n|\\Delta E_{\\mathrm{drift}}| \\leq C_J C_H r_{\\mathrm{tol}} \\tau \\sqrt{3 k_B T \\left(\\frac{N_C}{m_C} + \\frac{N_H}{m_H}\\right)}\n$$\n现在我们代入给定的数值，确保单位一致 (eV, Å, ps)。\n$C_J = 4.0~\\mathrm{eV}/\\mathrm{\\AA}$\n$C_H = 0.1~\\mathrm{eV}^{-1}$\n$\\tau = 1~\\mathrm{ns} = 1000~\\mathrm{ps}$\n$T = 300~\\mathrm{K}$\n$k_B = 8.617333 \\times 10^{-5}~\\mathrm{eV/K} \\implies k_B T = 0.025852~\\mathrm{eV}$\n质量：$m_C = 12~\\mathrm{amu}$，$m_H = 1~\\mathrm{amu}$。\n质量转换：$1~\\mathrm{amu} = 1.0364 \\times 10^{-4}~\\mathrm{eV}\\cdot\\mathrm{ps}^2/\\mathrm{\\AA}^2$。\n$m_C = 12 \\times 1.0364 \\times 10^{-4} = 1.24368 \\times 10^{-3}~\\mathrm{eV}\\cdot\\mathrm{ps}^2/\\mathrm{\\AA}^2$\n$m_H = 1 \\times 1.0364 \\times 10^{-4} = 1.0364 \\times 10^{-4}~\\mathrm{eV}\\cdot\\mathrm{ps}^2/\\mathrm{\\AA}^2$\n\n现在我们计算逆质量之和：\n$$\n\\frac{N_C}{m_C} + \\frac{N_H}{m_H} = \\frac{60}{1.24368 \\times 10^{-3}} + \\frac{40}{1.0364 \\times 10^{-4}} \\approx 48243.5 + 385951.4 = 434194.9~\\frac{\\mathrm{\\AA}^2}{\\mathrm{eV}\\cdot\\mathrm{ps}^2}\n$$\n接下来，我们计算估计的速度项：\n$$\n\\tau \\sqrt{3 k_B T \\left(\\frac{N_C}{m_C} + \\frac{N_H}{m_H}\\right)} = 1000~\\mathrm{ps} \\times \\sqrt{3 \\times 0.025852~\\mathrm{eV} \\times 434194.9~\\frac{\\mathrm{\\AA}^2}{\\mathrm{eV}\\cdot\\mathrm{ps}^2}}\n$$\n$$\n= 1000~\\mathrm{ps} \\times \\sqrt{33674.8}~\\mathrm{\\AA}/\\mathrm{ps} \\approx 1000 \\times 183.507~\\mathrm{\\AA} = 1.83507 \\times 10^5~\\mathrm{\\AA}\n$$\n$r_{\\mathrm{tol}}$ 的总无量纲乘数为：\n$$\nK = C_J C_H \\times 1.83507 \\times 10^5~\\mathrm{\\AA} = (4.0~\\mathrm{eV}/\\mathrm{\\AA}) \\times (0.1~\\mathrm{eV}^{-1}) \\times (1.83507 \\times 10^5~\\mathrm{\\AA}) \\approx 73403\n$$\n能量漂移的界限为 $|\\Delta E_{\\mathrm{drift}}| \\leq K \\cdot r_{\\mathrm{tol}} \\approx 73403 \\cdot r_{\\mathrm{tol}}$。注意 $r_{\\mathrm{tol}}$ 的单位是能量 (eV)。\n\n最后，我们应用约束条件，即漂移不得超过 $\\Delta E_{\\mathrm{max}} = 10~\\mathrm{kJ/mol}$。我们将其转换为每个系统的 eV。转换因子为 $1~\\mathrm{eV} \\approx 96.485~\\mathrm{kJ/mol}$。\n$$\n\\Delta E_{\\mathrm{max}} = 10~\\mathrm{kJ/mol} \\times \\frac{1~\\mathrm{eV}}{96.485~\\mathrm{kJ/mol}} \\approx 0.10364~\\mathrm{eV}\n$$\n我们求解容差 $r_{\\mathrm{tol}}$：\n$$\n73403 \\cdot r_{\\mathrm{tol}} \\leq 0.10364~\\mathrm{eV}\n$$\n$$\nr_{\\mathrm{tol}} \\leq \\frac{0.10364}{73403}~\\mathrm{eV} \\approx 1.4119 \\times 10^{-6}~\\mathrm{eV}\n$$\n四舍五入到三位有效数字，QEq 残差的欧几里得范数所需的容差为 $1.41 \\times 10^{-6}~\\mathrm{eV}$。",
            "answer": "$$\\boxed{1.41 \\times 10^{-6}}$$"
        }
    ]
}