{
    "hands_on_practices": [
        {
            "introduction": "实践交叉耦合项的第一步是理解其基本构成。本练习通过量纲分析，帮助你确定一个常见的拉伸-弯曲耦合常数 $k_{r\\theta}$ 的物理量纲，这对于确保力场参数化过程中的单位一致性和正确性至关重要。掌握这项技能可以让你在处理不同单位系统（例如，角度使用弧度或度）时充满信心。",
            "id": "3406760",
            "problem": "考虑一个分子力学力场，其中势能包含一个三原子片段的键长和键角之间的交叉项耦合。设键长用 $r$ 表示，键角用 $\\theta$ 表示，它们各自的平衡值分别为 $r_{0}$ 和 $\\theta_{0}$。该交叉项对势能的贡献模型为\n$$\nE_{r\\theta} = k_{r\\theta}\\,(r - r_{0})\\,(\\theta - \\theta_{0}) \\, ,\n$$\n其中 $k_{r\\theta}$ 是一个耦合参数，需要为保证单位一致性而确定。你可以假设 $E_{r\\theta}$ 是物理势能的一部分，因此它必须具有能量的物理量纲。在量纲记录中，将角度视为以弧度为单位，并将弧度作为平面角的一个独立量纲，以确保度和弧度之间单位转换的一致性。从能量与功具有相同量纲、功等于力乘以位移、力等于质量乘以加速度这些基本定义出发，进行量纲分析，以质量、长度、时间和平面角这些基本量纲来确定 $k_{r\\theta}$ 的量纲。\n\n此外，验证如果 $\\theta$ 的数值用度而不是弧度表示，则 $k_{r\\theta}$ 的数值必须乘以适当的转换因子以保持 $E_{r\\theta}$ 不变，并根据你引入的角度量纲来解释这种不变性。\n\n使用能量 $E$、长度 $L$ 和平面角 $\\Theta$（弧度）的量纲符号，将你的最终答案表示为一个闭合形式的解析表达式。最终答案中不应包含任何物理单位。",
            "solution": "所述问题具有科学依据、良定且客观。它提出了一个应用于分子力学力场中常见函数形式的量纲分析标准问题。所有必要信息都已提供，问题没有矛盾或含糊之处。因此，可以推导出解决方案。\n\n问题要求解出键角交叉项势能表达式中耦合参数 $k_{r\\theta}$ 的量纲：\n$$\nE_{r\\theta} = k_{r\\theta}\\,(r - r_{0})\\,(\\theta - \\theta_{0})\n$$\n任何物理量 $X$ 的量纲将用 $[X]$ 表示。问题指定能量、长度和平面角的量纲应分别用符号 $E$、$L$ 和 $\\Theta$ 表示。\n\n项 $E_{r\\theta}$ 代表能量，因此其量纲为 $[E_{r\\theta}] = E$。\n项 $(r - r_{0})$ 代表键长的差值。由于 $r$ 和 $r_0$ 都具有长度的量纲，它们的差值也具有长度的量纲。因此，$[r - r_0] = L$。\n项 $(\\theta - \\theta_{0})$ 代表键角的差值。问题明确指出，平面角应被视为一个独立的量纲 $\\Theta$。因此，$[\\theta - \\theta_0] = \\Theta$。\n\n量纲齐次性原理要求方程两边的量纲必须相等。我们可以写出量纲方程如下：\n$$\n[E_{r\\theta}] = [k_{r\\theta}] [r - r_0] [\\theta - \\theta_0]\n$$\n代入已知的量纲：\n$$\nE = [k_{r\\theta}] \\cdot L \\cdot \\Theta\n$$\n解出耦合参数的量纲 $[k_{r\\theta}]$，我们得到：\n$$\n[k_{r\\theta}] = \\frac{E}{L \\cdot \\Theta} = E L^{-1} \\Theta^{-1}\n$$\n这就是用能量、长度和平面角的量纲表示的 $k_{r\\theta}$ 的量纲，符合最终答案的要求。\n\n为了完整起见，我们可以用质量（$M$）、长度（$L$）、时间（$T$）和平面角（$\\Theta$）这些基本量纲来表示这个结果。能量的量纲与功相同，功是力乘以位移。力是质量乘以加速度。\n加速度的量纲是 $[a] = L T^{-2}$。\n力的量纲是 $[F] = [m][a] = M L T^{-2}$。\n能量的量纲是 $[E] = [F][\\text{位移}] = (M L T^{-2}) L = M L^2 T^{-2}$。\n将这个 $E$ 的表达式代入我们关于 $[k_{r\\theta}]$ 的结果中：\n$$\n[k_{r\\theta}] = (M L^2 T^{-2}) L^{-1} \\Theta^{-1} = M L T^{-2} \\Theta^{-1}\n$$\n\n接下来，我们验证将角度单位从弧度改为度的影响。物理量能量 $E_{r\\theta}$ 必须与单位的选择无关。设 $\\{X\\}$ 表示物理量 $X$ 的数值。势能公式是使用数值来实现的：\n$$\n\\{E_{r\\theta}\\} = \\{k_{r\\theta}\\} \\{r - r_0\\} \\{\\theta - \\theta_0\\}\n$$\n让我们考虑角度以弧度（rad）和度（deg）表示的情况。能量 $\\{E_{r\\theta}\\}$ 和长度差 $\\{r-r_0\\}$ 不受角度单位选择的影响。因此，乘积 $\\{k_{r\\theta}\\} \\{\\theta - \\theta_0\\}$ 必须是不变的。\n$$\n\\{k_{r\\theta}\\}_{\\text{rad}} \\{\\theta - \\theta_0\\}_{\\text{rad}} = \\{k_{r\\theta}\\}_{\\text{deg}} \\{\\theta - \\theta_0\\}_{\\text{deg}}\n$$\n角度的数值在度和弧度之间的转换关系是：\n$$\n\\{\\theta\\}_{\\text{deg}} = \\{\\theta\\}_{\\text{rad}} \\cdot \\frac{180}{\\pi}\n$$\n这个关系对差值 $(\\theta - \\theta_0)$ 也成立。将此代入不变性方程中：\n$$\n\\{k_{r\\theta}\\}_{\\text{rad}} \\{\\theta - \\theta_0\\}_{\\text{rad}} = \\{k_{r\\theta}\\}_{\\text{deg}} \\left( \\{\\theta - \\theta_0\\}_{\\text{rad}} \\cdot \\frac{180}{\\pi} \\right)\n$$\n假设 $\\{\\theta - \\theta_0\\}_{\\text{rad}} \\neq 0$，我们可以从两边消去这一项，从而得到耦合参数数值之间的关系：\n$$\n\\{k_{r\\theta}\\}_{\\text{rad}} = \\{k_{r\\theta}\\}_{\\text{deg}} \\cdot \\frac{180}{\\pi}\n$$\n或者等价地，\n$$\n\\{k_{r\\theta}\\}_{\\text{deg}} = \\{k_{r\\theta}\\}_{\\text{rad}} \\cdot \\frac{\\pi}{180}\n$$\n这表明，如果角度以度而不是弧度提供，耦合常数 $k_{r\\theta}$ 的数值必须乘以一个因子 $\\frac{\\pi}{180}$，以确保计算出的能量保持不变。\n\n这种行为是 $k_{r\\theta}$ 的量纲为 $E L^{-1} \\Theta^{-1}$ 的直接结果。对角量纲 $\\Theta^{-1}$ 的反比依赖性意味着 $k_{r\\theta}$ 的单位形式为（能量）/（长度 × 角度）。为使物理量 $k_{r\\theta}$ 保持恒定，其数值必须与角度单位大小的任何变化成反比。由于 1 弧度是比 1 度更大的角度单位（$1 \\text{ rad} \\approx 57.3 \\text{ deg}$），当 $k_{r\\theta}$ 的单位是“每度”时，其数值必须比单位是“每弧度”时小，其比例恰好是转换因子 $\\frac{\\pi}{180}$。将角度视为一个基本量纲为这种单位处理程序提供了形式化的基础。",
            "answer": "$$\n\\boxed{E L^{-1} \\Theta^{-1}}\n$$"
        },
        {
            "introduction": "接下来，我们将探讨一个经典且物理意义明确的交叉项——Urey-Bradley (UB) 项。UB项通过对1,3-原子之间的距离施加谐波势来巧妙地耦合键长和键角。在本练习中，你将从其势能表达式推导出力，从而直观地理解这种交叉项如何影响原子动力学，并为分子几何提供比简单谐波项更精细的描述。",
            "id": "3406812",
            "problem": "考虑一个分子力学力场中的三原子片段，其中标记为 $1$、$2$ 和 $3$ 的原子通过键 $1\\text{-}2$ 和 $2\\text{-}3$ 顺序连接，并在原子 $2$ 处形成一个角。设键长为 $r_{12} = |\\mathbf{r}_{2} - \\mathbf{r}_{1}|$ 和 $r_{23} = |\\mathbf{r}_{3} - \\mathbf{r}_{2}|$，原子 $2$ 处的角为 $\\theta_{123}$，它由键矢量 $\\mathbf{b}_{12} = \\mathbf{r}_{1} - \\mathbf{r}_{2}$ 和 $\\mathbf{b}_{23} = \\mathbf{r}_{3} - \\mathbf{r}_{2}$ 通过 $\\cos\\theta_{123} = \\dfrac{\\mathbf{b}_{12} \\cdot \\mathbf{b}_{23}}{r_{12}\\,r_{23}}$ 定义。定义 $1\\text{-}3$ 间距为 $R_{13} = |\\mathbf{r}_{1} - \\mathbf{r}_{3}|$，以及相应的单位矢量 $\\hat{\\mathbf{e}}_{13} = \\dfrac{\\mathbf{r}_{1} - \\mathbf{r}_{3}}{R_{13}}$，该矢量从原子 $3$ 指向原子 $1$。引入 Urey–Bradley (UB) 交叉项能量，通过 $1\\text{-}3$ 间距耦合键的伸缩和角的弯曲：\n$$\nE_{\\mathrm{UB}} = \\frac{1}{2}\\,k_{\\mathrm{UB}}\\left(R_{13} - R_{13,0}\\right)^{2},\n$$\n其中 $k_{\\mathrm{UB}}$ 是 UB 刚度，$R_{13,0}$ 是 UB 参考 $1\\text{-}3$ 距离。\n\n仅从机械力是势能负梯度的定义，以及 $R_{13}$ 以 $r_{12}$、$r_{23}$ 和 $\\theta_{123}$ 表示的几何关系出发，推导仅由 $E_{\\mathrm{UB}}$ 产生的、作用在原子 $1$ 和 $3$ 上的力 $\\mathbf{F}_{1}$ 和 $\\mathbf{F}_{3}$，并完全用 $k_{\\mathrm{UB}}$、$r_{12}$、$r_{23}$、$\\theta_{123}$、$R_{13,0}$ 和 $\\hat{\\mathbf{e}}_{13}$ 表示（不应出现坐标）。在适当之处使用余弦定理消去 $R_{13}$，代之以 $r_{12}$、$r_{23}$ 和 $\\theta_{123}$，并取角 $\\theta_{123}$ 的单位为弧度。\n\n然后，通过分析在固定的 $r_{12}$ 和 $r_{23}$ 下 $E_{\\mathrm{UB}}$ 的小角度变化，解释这些 UB 力如何补充常规的键角弯曲力，并确定 UB 项在平衡位置附近贡献的有效附加角向刚度。\n\n以单一闭合形式表达式给出最终答案，即力对 $\\left(\\mathbf{F}_{1},\\,\\mathbf{F}_{3}\\right)$。无需数值计算。角度必须以弧度表示。最终方框内的答案不应包含单位。",
            "solution": "在进行解答之前，需对问题进行验证。\n\n### 第一步：提取已知条件\n-   **系统**：一个三原子片段，其中原子 $1$、$2$ 和 $3$ 以 $1\\text{-}2\\text{-}3$ 的方式连接。\n-   **坐标与矢量**：\n    -   键长：$r_{12} = |\\mathbf{r}_{2} - \\mathbf{r}_{1}|$ 和 $r_{23} = |\\mathbf{r}_{3} - \\mathbf{r}_{2}|$。\n    -   用于定义角度的键矢量：$\\mathbf{b}_{12} = \\mathbf{r}_{1} - \\mathbf{r}_{2}$ 和 $\\mathbf{b}_{23} = \\mathbf{r}_{3} - \\mathbf{r}_{2}$。\n    -   角度：$\\cos\\theta_{123} = \\dfrac{\\mathbf{b}_{12} \\cdot \\mathbf{b}_{23}}{r_{12}\\,r_{23}}$。\n    -   $1\\text{-}3$ 距离：$R_{13} = |\\mathbf{r}_{1} - \\mathbf{r}_{3}|$。\n    -   $1\\text{-}3$ 单位矢量：$\\hat{\\mathbf{e}}_{13} = \\dfrac{\\mathbf{r}_{1} - \\mathbf{r}_{3}}{R_{13}}$。\n-   **势能**：\n    -   Urey–Bradley (UB) 项：$E_{\\mathrm{UB}} = \\frac{1}{2}\\,k_{\\mathrm{UB}}\\left(R_{13} - R_{13,0}\\right)^{2}$。\n    -   常数：$k_{\\mathrm{UB}}$ (刚度) 和 $R_{13,0}$ (参考距离)。\n-   **任务**：\n    1.  推导由 $E_{\\mathrm{UB}}$ 产生的力 $\\mathbf{F}_{1}$ 和 $\\mathbf{F}_{3}$，并用 $k_{\\mathrm{UB}}$、$r_{12}$、$r_{23}$、$\\theta_{123}$、$R_{13,0}$ 和 $\\hat{\\mathbf{e}}_{13}$ 表示。\n    2.  使用余弦定理替换 $R_{13}$。\n    3.  通过分析 $E_{\\mathrm{UB}}$ 的小角度变化来解释 UB 力如何补充键角弯曲力。\n    4.  确定有效的附加角向刚度。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了 Urey–Bradley 势，这是经典分子力学力场（例如 CHARMM、CFF）中一个成熟的交叉项。力是势能负梯度的定义（$\\mathbf{F} = -\\nabla E$）是经典力学的基本原理。所有几何定义都是标准的。该问题在科学上是合理的。\n-   **适定性**：该问题要求基于给定的定义和原理进行具体推导。所需的输出已明确定义，并且预期通过应用矢量微积分可以得到唯一解。\n-   **客观性**：该问题使用精确、正式且无偏见的科学语言陈述。\n-   **完整性与一致性**：所有必要的信息（势能函数、几何定义、力与能量关系的原理）都已提供。设定中没有矛盾之处。\n-   **现实性与可行性**：该模型是计算化学中的标准表示，所要求的推导是该领域中一个标准（尽管不简单）的练习。\n\n### 第三步：结论与行动\n问题有效。将提供完整解答。\n\n### 力 $\\mathbf{F}_{1}$ 和 $\\mathbf{F}_{3}$ 的推导\n\n作用在原子 $i$ 上的力 $\\mathbf{F}_i$ 由势能对该原子坐标 $\\mathbf{r}_i$ 的负梯度给出。\n$$\n\\mathbf{F}_i = -\\nabla_i E_{\\mathrm{UB}} = -\\nabla_i \\left[\\frac{1}{2}\\,k_{\\mathrm{UB}}\\left(R_{13} - R_{13,0}\\right)^{2}\\right]\n$$\n我们应用链式法则进行微分。能量 $E_{\\mathrm{UB}}$ 仅通过距离 $R_{13}$ 依赖于原子坐标。\n$$\n\\mathbf{F}_i = -\\frac{\\partial E_{\\mathrm{UB}}}{\\partial R_{13}} \\nabla_i R_{13}\n$$\n首先，我们计算 $E_{\\mathrm{UB}}$ 对 $R_{13}$ 的导数：\n$$\n\\frac{\\partial E_{\\mathrm{UB}}}{\\partial R_{13}} = k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right)\n$$\n接下来，我们计算 $R_{13}$ 对位置 $\\mathbf{r}_1$ 和 $\\mathbf{r}_3$ 的梯度。距离 $R_{13}$ 定义为 $R_{13} = |\\mathbf{r}_1 - \\mathbf{r}_3| = \\sqrt{(\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (\\mathbf{r}_1 - \\mathbf{r}_3)}$。\n\n对原子 $1$，梯度为：\n$$\n\\nabla_1 R_{13} = \\nabla_1 \\sqrt{(\\mathbf{r}_1 - \\mathbf{r}_3)^2} = \\frac{1}{2 R_{13}} \\nabla_1 \\left((\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (\\mathbf{r}_1 - \\mathbf{r}_3)\\right) = \\frac{2(\\mathbf{r}_1 - \\mathbf{r}_3)}{2 R_{13}} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_3}{R_{13}}\n$$\n根据定义，这就是单位矢量 $\\hat{\\mathbf{e}}_{13}$。\n$$\n\\nabla_1 R_{13} = \\hat{\\mathbf{e}}_{13}\n$$\n将这些结果代入原子 $1$ 的力方程：\n$$\n\\mathbf{F}_1 = -k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right) \\hat{\\mathbf{e}}_{13}\n$$\n对原子 $3$，梯度为：\n$$\n\\nabla_3 R_{13} = \\nabla_3 \\sqrt{(\\mathbf{r}_1 - \\mathbf{r}_3)^2} = \\frac{1}{2 R_{13}} \\nabla_3 \\left((\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (\\mathbf{r}_1 - \\mathbf{r}_3)\\right) = \\frac{2(\\mathbf{r}_1 - \\mathbf{r}_3) \\cdot (-1)}{2 R_{13}} = -\\frac{\\mathbf{r}_1 - \\mathbf{r}_3}{R_{13}}\n$$\n$$\n\\nabla_3 R_{13} = -\\hat{\\mathbf{e}}_{13}\n$$\n将这些结果代入原子 $3$ 的力方程：\n$$\n\\mathbf{F}_3 = -k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right) (-\\hat{\\mathbf{e}}_{13}) = k_{\\mathrm{UB}} \\left(R_{13} - R_{13,0}\\right) \\hat{\\mathbf{e}}_{13}\n$$\n不出所料，$\\mathbf{F}_1 = -\\mathbf{F}_3$，这满足了该相互作用对的牛顿第三定律。该势对原子 $2$ 的作用力为零，因为 $E_{\\mathrm{UB}}$ 不依赖于 $\\mathbf{r}_2$。\n\n最后一步是用内坐标 $r_{12}$、$r_{23}$ 和 $\\theta_{123}$ 来表示 $R_{13}$。原子 $1$、$2$ 和 $3$ 构成一个边长为 $r_{12}$、$r_{23}$ 和 $R_{13}$ 的三角形。顶点 $2$ 处的角为 $\\theta_{123}$。使用余弦定理：\n$$\nR_{13}^2 = r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}\n$$\n因此，距离 $R_{13}$ 是：\n$$\nR_{13} = \\sqrt{r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}}\n$$\n将这个 $R_{13}$ 的表达式代入力方程，得到最终表达式：\n$$\n\\mathbf{F}_1 = -k_{\\mathrm{UB}} \\left( \\sqrt{r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}} - R_{13,0} \\right) \\hat{\\mathbf{e}}_{13}\n$$\n$$\n\\mathbf{F}_3 = k_{\\mathrm{UB}} \\left( \\sqrt{r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta_{123}} - R_{13,0} \\right) \\hat{\\mathbf{e}}_{13}\n$$\n这些表达式完全以指定的变量给出了力。\n\n### 与键角弯曲力的互补性\n\n为了理解 Urey-Bradley 项如何补充常规的键角弯曲势，我们分析其在键长 $r_{12}$ 和 $r_{23}$ 保持不变时，角度 $\\theta_{123}$ 发生微小变化时的行为。一个典型的谐振键角弯曲势的形式为 $E_{\\text{angle}} = \\frac{1}{2} k_{\\text{angle}}(\\theta_{123} - \\theta_{\\text{eq}})^2$。我们将证明，UB 项在很好的近似下，也为该角度提供了一个谐振恢复势。\n\n让我们对 $E_{\\mathrm{UB}}$ 作为 $\\theta \\equiv \\theta_{123}$ 的函数，在平衡角 $\\theta_0$ 附近进行泰勒级数展开。我们定义 $\\theta_0$ 为使得 $1\\text{-}3$ 距离等于参考距离的角度，即 $R_{13}(\\theta_0) = R_{13,0}$。\n$$\nE_{\\mathrm{UB}}(\\theta) \\approx E_{\\mathrm{UB}}(\\theta_0) + \\left. \\frac{dE_{\\mathrm{UB}}}{d\\theta} \\right|_{\\theta_0} (\\theta - \\theta_0) + \\frac{1}{2} \\left. \\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} \\right|_{\\theta_0} (\\theta - \\theta_0)^2\n$$\n$E_{\\mathrm{UB}}$ 对 $\\theta$ 的一阶导数可用链式法则求得：\n$$\n\\frac{dE_{\\mathrm{UB}}}{d\\theta} = \\frac{dE_{\\mathrm{UB}}}{dR_{13}} \\frac{dR_{13}}{d\\theta} = k_{\\mathrm{UB}}(R_{13} - R_{13,0}) \\frac{d}{d\\theta}\\left(r_{12}^2 + r_{23}^2 - 2r_{12}r_{23}\\cos\\theta\\right)^{1/2}\n$$\n$$\n\\frac{dE_{\\mathrm{UB}}}{d\\theta} = k_{\\mathrm{UB}}(R_{13} - R_{13,0}) \\left[\\frac{1}{2 R_{13}}(2r_{12}r_{23}\\sin\\theta)\\right] = k_{\\mathrm{UB}}(R_{13} - R_{13,0}) \\frac{r_{12}r_{23}\\sin\\theta}{R_{13}}\n$$\n在平衡角 $\\theta_0$ 处，我们有 $R_{13}(\\theta_0) = R_{13,0}$，所以项 $(R_{13} - R_{13,0})$ 为零。因此，一阶导数消失：\n$$\n\\left. \\frac{dE_{\\mathrm{UB}}}{d\\theta} \\right|_{\\theta_0} = 0\n$$\n这证实了 $\\theta_0$ 对应于势能面上的一个极小值（假设二阶导数为正）。同时，$E_{\\mathrm{UB}}(\\theta_0) = 0$。\n\n接下来，我们计算在 $\\theta_0$ 处的二阶导数：\n$$\n\\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} = k_{\\mathrm{UB}} \\frac{d}{d\\theta} \\left[ \\left(1 - \\frac{R_{13,0}}{R_{13}}\\right) r_{12}r_{23}\\sin\\theta \\right]\n$$\n$$\n= k_{\\mathrm{UB}} \\left[ \\left(\\frac{R_{13,0}}{R_{13}^2}\\frac{dR_{13}}{d\\theta}\\right) r_{12}r_{23}\\sin\\theta + \\left(1 - \\frac{R_{13,0}}{R_{13}}\\right) r_{12}r_{23}\\cos\\theta \\right]\n$$\n在 $\\theta=\\theta_0$ 处求值，此时 $R_{13}=R_{13,0}$：\n$$\n\\left. \\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} \\right|_{\\theta_0} = k_{\\mathrm{UB}} \\left[ \\frac{1}{R_{13,0}} \\left(\\left. \\frac{dR_{13}}{d\\theta}\\right|_{\\theta_0} \\right) r_{12}r_{23}\\sin\\theta_0 + 0 \\right]\n$$\n我们需要 $R_{13}$ 在 $\\theta_0$ 处的导数：$\\left. \\frac{dR_{13}}{d\\theta}\\right|_{\\theta_0} = \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}}$。\n$$\n\\left. \\frac{d^2E_{\\mathrm{UB}}}{d\\theta^2} \\right|_{\\theta_0} = k_{\\mathrm{UB}} \\left[ \\frac{1}{R_{13,0}} \\left(\\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}}\\right) r_{12}r_{23}\\sin\\theta_0 \\right] = k_{\\mathrm{UB}} \\left( \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}} \\right)^2\n$$\n因此，$E_{\\mathrm{UB}}$ 在 $\\theta_0$ 附近的泰勒展开为：\n$$\nE_{\\mathrm{UB}}(\\theta) \\approx \\frac{1}{2} \\left[ k_{\\mathrm{UB}} \\left( \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}} \\right)^2 \\right] (\\theta - \\theta_0)^2\n$$\n这表明对于小的角位移，Urey-Bradley 势等效于一个谐振键角弯曲势。UB 项贡献的有效角向刚度为：\n$$\nk_{\\text{eff, UB}} = k_{\\mathrm{UB}} \\left( \\frac{r_{12}r_{23}\\sin\\theta_0}{R_{13,0}} \\right)^2\n$$\n在一个完整的力场中，键角弯曲的总势能将是传统的谐振角项和 UB 项之和。因此，键角弯曲的总有效刚度是显式角刚度与 $k_{\\text{eff, UB}}$ 之和。通过 $1\\text{-}3$ 距离实现的键伸缩和角弯曲之间的这种耦合，提供了一个更为物理真实的势能面，尤其适用于精确模拟张力环或空间拥挤分子的振动频率和结构。",
            "answer": "$$\n\\boxed{\nk_{\\mathrm{UB}} \\left( \\sqrt{r_{12}^2 + r_{23}^2 - 2 r_{12} r_{23} \\cos\\theta_{123}} - R_{13,0} \\right) \\begin{pmatrix} -\\hat{\\mathbf{e}}_{13}  \\hat{\\mathbf{e}}_{13} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在力场中引入交叉项虽然能提高模型的准确性，但也带来了风险：不当的参数可能导致势能面不稳定，使模拟失败。本高级练习聚焦于力场开发中的一个核心实际问题：参数稳定性。通过推导势能面稳定的数学条件并编写一个数值诊断程序，你将学会如何验证参数集的有效性，确保你的分子动力学模拟是物理上合理的。",
            "id": "3406831",
            "problem": "考虑一个用于分子动力学力场的二维内坐标谐波模型，该模型描述了单个键长及其相邻键角。令内坐标为键伸展位移 $\\,\\Delta r\\,$ (单位为 $\\mathrm{nm}$) 和角度偏差 $\\,\\Delta \\theta\\,$ (单位为弧度)。在平衡点附近，势能可近似为二次型\n$$\nU(\\Delta r,\\Delta \\theta) \\;=\\; \\tfrac{1}{2}\n\\begin{bmatrix}\n\\Delta r  \\Delta \\theta\n\\end{bmatrix}\n\\begin{bmatrix}\nk_r  k_{r\\theta} \\\\\nk_{r\\theta}  k_\\theta\n\\end{bmatrix}\n\\begin{bmatrix}\n\\Delta r \\\\\n\\Delta \\theta\n\\end{bmatrix},\n$$\n其中 $\\,k_r\\,$ 的单位为 $\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$，$\\,k_\\theta\\,$ 的单位为 $\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$，而 $\\,k_{r\\theta}\\,$ 的单位为 $\\mathrm{kJ\\,mol^{-1}\\,(nm\\cdot rad)^{-1}}$。局部二次近似的稳定性要求 Hessian 矩阵\n$$\n\\mathbf{K} \\;=\\; \\begin{bmatrix}\nk_r  k_{r\\theta} \\\\\nk_{r\\theta}  k_\\theta\n\\end{bmatrix}\n$$\n是对称正定的。从稳定平衡在所有方向上都要求正曲率的基本原理（具有谐波恢复力的 Newtonian 动力学）出发，并应用 Sylvester 准则判断对称矩阵的正定性，推导出确保 $\\,\\mathbf{K}\\,$ 是正定矩阵时 $\\,k_r$、$\\,k_\\theta\\,$ 和 $\\,k_{r\\theta}\\,$ 之间必须满足的充要不等式。特别地，确定严格界限 $\\,k_{r\\theta}^2  k_r\\,k_\\theta\\,$ 以及对 $\\,k_r\\,$ 和 $\\,k_\\theta\\,$ 的符号要求。\n\n基于 $\\,\\mathbf{K}\\,$ 的谱和热采样，设计一个用于平衡的数值诊断程序，该程序能够标记不稳定或接近不稳定的交叉项参数化方案。使用基于均分的内坐标协方差，\n$$\n\\boldsymbol{\\Sigma} \\;=\\; k_\\mathrm{B} T\\,\\mathbf{K}^{-1},\n$$\n其中 $\\,k_\\mathrm{B} T\\,$ 以每摩尔表示，即使用摩尔气体常数 $\\,R\\,$（单位为 $\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$）代替 $\\,k_\\mathrm{B}$，因此有 $\\,k_\\mathrm{B} N_\\mathrm{A} = R$。对于 $\\mathrm{kJ\\,mol^{-1}}$ 能量单位，取 $\\,R = 0.008314462618\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。你的诊断程序必须：\n- 计算 $\\,\\mathbf{K}\\,$ 的特征值 $\\,\\lambda_{\\min}\\,$ 和 $\\,\\lambda_{\\max}\\,$。\n- 当且仅当推导出的不等式成立时，才将矩阵声明为正定矩阵。\n- 如果矩阵不是严格正定的，或者条件数很差（由给定的阈值 $\\,\\tau  0\\,$ 量化为 $\\,\\lambda_{\\min}/\\lambda_{\\max}  \\tau\\,$），则在平衡过程中将该参数集标记为不稳定。此外，当 $\\,\\mathbf{K}\\,$ 是正定且条件良好的，从 $\\,\\mathcal{N}(\\mathbf{0},\\boldsymbol{\\Sigma})\\,$ 中抽取样本 $\\,(\\Delta r, \\Delta \\theta)\\,$，并对所有样本进行数值验证，确保 $\\,U(\\Delta r,\\Delta \\theta) \\ge 0\\,$ 成立；如果任何采样能量为负，则将该参数集标记为不稳定。\n\n实现一个完整的、可运行的程序，该程序针对以下测试套件，为每个案例计算：\n- 一个布尔值，指示 $\\,\\mathbf{K}\\,$ 是否为正定矩阵。\n- 一个布尔诊断标志，根据上述规则指示平衡过程中的不稳定性。\n- $\\,\\mathbf{K}\\,$ 的最小特征值 $\\,\\lambda_{\\min}\\,$，以 $\\mathrm{kJ\\,mol^{-1}}$ 每平方内坐标为单位报告，并四舍五入到六位小数。\n\n使用弧度作为角度单位。对所有常数使用指定的单位，并以 $\\mathrm{kJ\\,mol^{-1}}$ 每平方内坐标为单位报告 $\\,\\lambda_{\\min}\\,$。对于热采样，使用 $\\,T\\,$（单位为 K）。测试套件包含七个参数集，每个参数集以 $\\,(k_r, k_\\theta, k_{r\\theta}, T, n_\\mathrm{samples}, \\tau)\\,$ 的形式给出：\n- 案例 $\\,1$: $(500.0, 200.0, 100.0, 300.0, 5000, 10^{-4})$。\n- 案例 $\\,2$: $(1.0, 1.0, 1.0, 300.0, 5000, 10^{-4})$。\n- 案例 $\\,3$: $(2.0, 2.0, 2.1, 300.0, 5000, 10^{-4})$。\n- 案例 $\\,4$: $(-10.0, 50.0, 0.0, 300.0, 5000, 10^{-4})$。\n- 案例 $\\,5$: $(10^{-3}, 10^{-3}, 0.999\\times 10^{-3}, 300.0, 5000, 10^{-3})$。\n- 案例 $\\,6$: $(300.0, 100.0, 0.0, 300.0, 5000, 10^{-4})$。\n- 案例 $\\,7$: $(500.0, 200.0, -100.0, 300.0, 5000, 10^{-4})$。\n\n你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素本身都是 $[\\,\\text{pd},\\,\\text{flag},\\,\\lambda_{\\min}\\,]$ 形式的列表。例如，输出格式必须类似于\n$$\n[\\,[\\text{True},\\text{False},0.123456],[\\text{False},\\text{True},-0.010000],\\dots]\n$$\n且行内任何地方都不能有额外的空格。",
            "solution": "所述问题具有科学依据，内容自洽且定义明确。它涉及分子力学中的基本概念，即势能最小值的稳定性及其与 Hessian 矩阵数学性质的关系。所提出的数值诊断是一个有效的多步骤过程，它结合了解析判据、矩阵条件数和统计采样，以评估力场参数化的稳定性。所有必需的常数和参数均已提供。因此，我将提供一个完整的解决方案。\n\n该问题需要一个由两部分组成的解决方案：首先，推导二次势的稳定性条件；其次，基于这些条件实现一个数值诊断程序。\n\n### 第 1 部分：稳定性条件的推导\n\n平衡点附近的势能由以下二次型给出：\n$$\nU(\\Delta r,\\Delta \\theta) \\;=\\; \\tfrac{1}{2}\n\\begin{bmatrix}\n\\Delta r  \\Delta \\theta\n\\end{bmatrix}\n\\mathbf{K}\n\\begin{bmatrix}\n\\Delta r \\\\\n\\Delta \\theta\n\\end{bmatrix}\n$$\n其中 $\\mathbf{x} = [\\Delta r, \\Delta \\theta]^T$ 是内坐标位移向量，$\\mathbf{K}$ 是势能关于这些坐标的二阶导数 Hessian 矩阵。\n$$\n\\mathbf{K} \\;=\\; \\begin{bmatrix}\nk_r  k_{r\\theta} \\\\\nk_{r\\theta}  k_\\theta\n\\end{bmatrix}\n$$\n为了使平衡稳定，势能 $U$ 必须是局部最小值。这要求对于任何微小位移 $\\mathbf{x} \\ne \\mathbf{0}$，势能都增加，即 $U(\\mathbf{x})  0$。这个条件当且仅当 Hessian 矩阵 $\\mathbf{K}$ 是正定时才满足。\n\n我们使用 Sylvester 准则来确定对称矩阵为正定的条件。该准则指出，一个对称矩阵是正定的，当且仅当其所有主子式都严格为正。\n\n对于 $2 \\times 2$ 矩阵 $\\mathbf{K}$，有两个主子式。\n\n1.  **第一个主子式** 是左上角 $1 \\times 1$ 子矩阵的行列式，即 $[k_r]$。\n    $$\n    \\det([k_r]) \\;=\\; k_r\n    $$\n    为了保证正定性，它必须严格为正：\n    $$\n    k_r  0\n    $$\n\n2.  **第二个主子式** 是整个 $2 \\times 2$ 矩阵 $\\mathbf{K}$ 的行列式。\n    $$\n    \\det(\\mathbf{K}) \\;=\\; \\det \\begin{pmatrix}\n    k_r  k_{r\\theta} \\\\\n    k_{r\\theta}  k_\\theta\n    \\end{pmatrix} \\;=\\; k_r k_\\theta - k_{r\\theta}^2\n    $$\n    为了保证正定性，它也必须严格为正：\n    $$\n    k_r k_\\theta - k_{r\\theta}^2  0\n    $$\n    这个不等式可以重排为 $k_{r\\theta}^2  k_r k_\\theta$。\n\n从两个必要条件 $k_r  0$ 和 $k_r k_\\theta  k_{r\\theta}^2$ 中，我们还可以推断出 $k_\\theta$ 的符号。由于 $k_{r\\theta}^2 \\ge 0$，第二个不等式意味着 $k_r k_\\theta$ 必须为正。既然我们已经确定 $k_r  0$，逻辑上可以得出 $k_\\theta$ 也必须为正，即 $k_\\theta  0$。\n\n因此，矩阵 $\\mathbf{K}$ 为正定（从而平衡点稳定）的充要条件是：\n1.  $k_r  0$\n2.  $k_\\theta  0$\n3.  $k_r k_\\theta - k_{r\\theta}^2  0$\n\n这些不等式将用于数值诊断的第一步。\n\n### 第 2 部分：数值诊断算法的设计\n\n对于每个参数集 $(k_r, k_\\theta, k_{r\\theta}, T, n_\\mathrm{samples}, \\tau)$，实现以下算法。\n\n1.  **构建 Hessian 矩阵**：形成数值矩阵 $\\mathbf{K} = \\begin{bmatrix} k_r  k_{r\\theta} \\\\ k_{r\\theta}  k_\\theta \\end{bmatrix}$。关于单位的简要说明：$\\mathbf{K}$ 的元素具有不同的物理单位（$\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$、$\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$ 等），这意味着特征值没有单一、简单的物理单位。然而，为解决此问题，我们将 $\\mathbf{K}$ 视为纯数值矩阵，并将特征值视为表示系统简正模力常数的数值，使用所要求的通用单位标签进行报告。\n\n2.  **正定性检查 (`pd`)**：解析地验证推导出的稳定性条件：当且仅当满足 $k_r > 0$、$k_\\theta > 0$ 和 $k_r k_\\theta > k_{r\\theta}^2$ 三个条件时，矩阵被声明为正定 (`pd = True`)。否则，`pd = False`。\n\n3.  **特征值计算**：计算对称矩阵 $\\mathbf{K}$ 的特征值，记为 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$。最小特征值 $\\lambda_{\\min}$ 被存储以供输出，并四舍五入到六位小数。\n\n4.  **不稳定性标志 (`flag`)**：基于一系列检查确定稳定性标志。\n    a.  **初始检查**：如果矩阵不是正定的 (`pd = False`)，则系统根本上是不稳定的。设置 `flag = True`。\n    b.  **条件数检查**：如果矩阵是正定的 (`pd = True`)，则评估其条件数。如果最小与最大特征值的比率低于给定的阈值 $\\tau$，则系统被标记为“接近不稳定”。如果 $\\lambda_{\\min} / \\lambda_{\\max}  \\tau$，则设置 `flag = True`。请注意，如果 $\\mathbf{K}$ 是正定的，两个特征值都严格为正，从而确保 $\\lambda_{\\max}  0$。\n    c.  **热采样检查**：如果矩阵是正定且条件良好的（即 `flag` 仍然是 `False`），则执行数值不稳定性的最终检查。\n        i.  计算协方差矩阵 $\\boldsymbol{\\Sigma} = (R \\cdot T) \\cdot \\mathbf{K}^{-1}$，其中 $R = 0.008314462618\\,\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n        ii. 从二元正态分布 $\\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma})$ 中抽取 $n_\\mathrm{samples}$ 个随机位移向量 $\\mathbf{x} = [\\Delta r, \\Delta \\theta]^T$。\n        iii. 对于每个采样向量 $\\mathbf{x}$，计算势能 $U = \\tfrac{1}{2} \\mathbf{x}^T \\mathbf{K} \\mathbf{x}$。\n        iv. 如果由于有限精度算术，任何计算出的能量 $U$ 为负，则该参数化方案被标记为数值不稳定。设置 `flag = True` 并终止当前案例的采样。\n\n5.  **输出生成**：对于每个测试案例，收集三个计算值：布尔值 `pd`、布尔值 `flag` 和浮点数 `lambda_min`。按照问题规范将它们格式化为单个字符串行。\n\n这个综合程序正确地验证了给定参数的稳定性，从纯粹的解析检查过渡到数值条件数评估，最后到热波动下数值稳定性的实际测试。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing the stability of a 2D harmonic potential\n    for a series of molecular dynamics force field parameter sets.\n    \"\"\"\n    R_KJ_MOL_K = 0.008314462618  # Molar gas constant in kJ/(mol*K)\n\n    # Test suite: (k_r, k_theta, k_rtheta, T, n_samples, tau)\n    test_cases = [\n        (500.0, 200.0, 100.0, 300.0, 5000, 1e-4),\n        (1.0, 1.0, 1.0, 300.0, 5000, 1e-4),\n        (2.0, 2.0, 2.1, 300.0, 5000, 1e-4),\n        (-10.0, 50.0, 0.0, 300.0, 5000, 1e-4),\n        (1e-3, 1e-3, 0.999 * 1e-3, 300.0, 5000, 1e-3),\n        (300.0, 100.0, 0.0, 300.0, 5000, 1e-4),\n        (500.0, 200.0, -100.0, 300.0, 5000, 1e-4),\n    ]\n\n    results_str_list = []\n\n    for case in test_cases:\n        k_r, k_theta, k_rtheta, T, n_samples, tau = case\n\n        # 1. Construct the Hessian Matrix K\n        K = np.array([[k_r, k_rtheta], [k_rtheta, k_theta]])\n\n        # 2. Positive-Definiteness Check (pd)\n        # Apply Sylvester's criterion: k_r  0 and det(K)  0\n        is_pd = (k_r  0) and (k_theta  0) and (k_r * k_theta  k_rtheta**2)\n\n        # 3. Eigenvalue Calculation\n        # Use eigvalsh for symmetric matrices; it returns sorted eigenvalues.\n        try:\n            eigs = np.linalg.eigvalsh(K)\n            lambda_min, lambda_max = eigs[0], eigs[1]\n        except np.linalg.LinAlgError:\n            # This should not happen for a 2x2 matrix unless entries are non-finite\n            lambda_min, lambda_max = np.nan, np.nan\n            is_pd = False # Mark as not PD if eigenvalues cannot be computed\n\n        # 4. Instability Flag (flag)\n        is_unstable = False\n\n        # a. Initial check based on positive-definiteness\n        if not is_pd:\n            is_unstable = True\n        else:\n            # b. Conditioning check\n            # Avoid division by zero if lambda_max is zero or negative (though impossible if PD)\n            if lambda_max  0:\n                condition_ratio = lambda_min / lambda_max\n                if condition_ratio  tau:\n                    is_unstable = True\n            else: # Should be unreachable if is_pd is True\n                is_unstable = True\n\n            # c. Thermal sampling check (only if not already flagged as unstable)\n            if not is_unstable:\n                RT = R_KJ_MOL_K * T\n                # Covariance matrix Sigma = RT * K^-1\n                try:\n                    K_inv = np.linalg.inv(K)\n                    Sigma = RT * K_inv\n                    \n                    # Check if covariance matrix is valid for sampling\n                    # (must be symmetric positive-semidefinite)\n                    # For a PD K, K_inv is PD, so Sigma is PD.\n                    \n                    # Draw samples from N(0, Sigma)\n                    mean = np.array([0.0, 0.0])\n                    samples = np.random.multivariate_normal(mean, Sigma, size=n_samples)\n\n                    # Check for negative potential energy\n                    for x in samples:\n                        # U = 0.5 * x.T @ K @ x\n                        U = 0.5 * np.dot(x, K @ x)\n                        if U  0:\n                            is_unstable = True\n                            break\n                except np.linalg.LinAlgError:\n                    # K is singular or near-singular, which should be caught by\n                    # is_pd or conditioning check, but this is a safeguard.\n                    is_unstable = True\n        \n        # Round lambda_min to 6 decimal places and format for output\n        formatted_lambda_min = f\"{round(lambda_min, 6):.6f}\"\n\n        # Compile the result string for this case\n        result_str = f\"[{'True' if is_pd else 'False'},{'True' if is_unstable else 'False'},{formatted_lambda_min}]\"\n        results_str_list.append(result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results_str_list)}]\")\n\n\nsolve()\n```"
        }
    ]
}