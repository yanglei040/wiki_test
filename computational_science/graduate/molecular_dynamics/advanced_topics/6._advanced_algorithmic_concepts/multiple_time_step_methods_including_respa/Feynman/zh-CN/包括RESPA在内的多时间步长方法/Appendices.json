{
    "hands_on_practices": [
        {
            "introduction": "使用像RESPA这样的多时间步方法的首要动机是降低计算成本，尤其是在处理昂贵的长程相互作用时。第一个练习为此提供了量化基础。通过将昂贵的粒子网格埃瓦尔德（PME）方法计算的次数作为子循环比率$M$的函数，你将具体理解分离快慢力时可能实现的显著效率提升。",
            "id": "3427660",
            "problem": "考虑一个分子动力学（MD）模拟，其中总力被分解为一个快速的短程分量和一个慢速的长程分量。慢速分量使用粒子网格埃瓦尔德（PME）方法进行评估，该方法采用三维快速傅里叶变换（3D FFT）。MD 积分器是通过参考系统传播算法（RESPA）实现时间尺度分离来构建的，其具有一个内部（快速）时间步长 $\\delta t$ 和一个外部（慢速）时间步长 $\\Delta t$，它们遵循关系 $\\Delta t = M \\, \\delta t$，其中 $M \\in \\mathbb{N}$ 是子循环比率。慢速 PME 分量在每个外部步长中评估一次。假设每次 PME 评估恰好执行两次 3D FFT。取一个典型的约束 MD 内部时间步长为 $\\delta t = 2 \\,\\mathrm{fs}$，并定义 $\\delta t_{\\mathrm{fs}}$ 为 $\\delta t$ 以飞秒表示的数值，因此 $\\delta t_{\\mathrm{fs}} = 2$。\n\n从时间离散动力学的第一性原理和 RESPA 子循环的定义出发，推导在 RESPA 下每纳秒执行的 3D FFT 次数，作为子循环比率 $M$ 和给定的典型时间步长的函数。作为一个参考基准，考虑一个单时间步长积分器，其中 PME 在每个内部步长 $\\delta t$ 处都被评估。利用 $1 \\,\\mathrm{ns} = 10^{6} \\,\\mathrm{fs}$ 这一事实。\n\n你的最终答案必须是一个单一的封闭形式解析表达式，给出在 RESPA 下每纳秒的 3D FFT 次数，仅写成 $M$ 的函数（并隐式使用给定的典型时间步长）。将答案表示为一个无单位的无量纲计数。不需要四舍五入。",
            "solution": "该问题要求推导在使用参考系统传播算法（RESPA）的分子动力学（MD）模拟中，每纳秒执行的三维快速傅里叶变换（3D FFT）的次数。推导必须从第一性原理开始。\n\n让我们定义问题陈述中提供的相关量。\n粒子上的总力被划分为一个快速变化的分量 $F_{\\text{fast}}$ 和一个慢速变化的分量 $F_{\\text{slow}}$。\n模拟采用两个时间步长：一个内部的快速时间步长 $\\delta t$，和一个外部的慢速时间步长 $\\Delta t$。\n这些时间步长通过子循环比率 $M \\in \\mathbb{N}$ 相关联，由以下方程给出：\n$$\n\\Delta t = M \\delta t\n$$\n使用粒子网格埃瓦尔德（PME）方法计算的慢力分量，在每个外部时间步长 $\\Delta t$ 评估一次。\n每次 PME 评估需要恰好执行两次 3D FFT。\n内部时间步长的值给定为 $\\delta t = 2 \\, \\mathrm{fs}$。问题还定义了 $\\delta t_{\\mathrm{fs}}$ 作为 $\\delta t$ 以飞秒为单位的数值，所以 $\\delta t_{\\mathrm{fs}} = 2$。\n我们被要求找出每纳秒执行的 3D FFT 次数，此处表示为 $\\mathcal{N}_{\\text{FFT/ns}}$。纳秒和飞秒之间的转换因子是 $1 \\, \\mathrm{ns} = 10^6 \\, \\mathrm{fs}$。\n\n事件发生的频率是连续事件之间时间周期的倒数。PME 计算在每个外部时间步长 $\\Delta t$ 执行。因此，PME 评估的频率 $f_{\\text{PME}}$ 为：\n$$\nf_{\\text{PME}} = \\frac{1}{\\Delta t}\n$$\n问题陈述，每次 PME 评估执行 $n_{\\text{FFT}} = 2$ 次 FFT。因此，FFT 执行的速率 $R_{\\text{FFT}}$ 是 PME 评估频率的两倍：\n$$\nR_{\\text{FFT}} = n_{\\text{FFT}} \\times f_{\\text{PME}} = \\frac{2}{\\Delta t}\n$$\n这个速率的单位是每单位时间的事件数，其中时间单位由 $\\Delta t$ 的单位决定。由于 $\\delta t$ 是以飞秒为单位给出的，我们也将以飞秒为单位表示 $\\Delta t$。\n使用关系式 $\\Delta t = M \\delta t$，我们可以将速率写为：\n$$\nR_{\\text{FFT}} = \\frac{2}{M \\delta t}\n$$\n为了以“每纳秒的 FFT 次数”这一特定单位表示该速率，我们必须在速率的时间单位（飞秒）和所需的时间单位（纳秒）之间建立关系。\n每纳秒的事件数是事件的速率（以每飞秒的事件数计）乘以一纳秒中的飞秒数。\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = R_{\\text{FFT}} \\times \\left( \\frac{10^6 \\, \\mathrm{fs}}{1 \\, \\mathrm{ns}} \\right)\n$$\n代入 $R_{\\text{FFT}}$ 的表达式，我们得到：\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\left( \\frac{2}{M \\delta t} \\right) \\times 10^6 \\, \\mathrm{ns}^{-1}\n$$\n在这里，为了量纲一致性，$\\delta t$ 必须以飞秒为单位表示。设 $\\delta t = \\delta t_{\\mathrm{fs}} \\, \\mathrm{fs}$，其中 $\\delta t_{\\mathrm{fs}}$ 是数值。表达式变为：\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\frac{2}{M (\\delta t_{\\mathrm{fs}} \\, \\mathrm{fs})} \\times 10^6 \\, \\mathrm{fs}\n$$\n飞秒（$\\mathrm{fs}$）的单位被抵消，留下一个无量纲的计数，正如预期。\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\frac{2 \\times 10^6}{M \\delta t_{\\mathrm{fs}}}\n$$\n问题指定了内部时间步长的典型值，即 $\\delta t = 2 \\, \\mathrm{fs}$。这对应于 $\\delta t_{\\mathrm{fs}} = 2$。将这个值代入方程，得到最终表达式作为 $M$ 的函数：\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\frac{2 \\times 10^6}{M \\times 2}\n$$\n通过消去因子 $2$ 来简化表达式：\n$$\n\\mathcal{N}_{\\text{FFT/ns}} = \\frac{10^6}{M}\n$$\n这是在 RESPA 方案下，每纳秒模拟时间内执行的 3D FFT 次数，作为子循环比率 $M$ 的函数。\n\n作为一致性检查，我们可以考虑问题中提到的参考基准情况，即在每个内部步长 $\\delta t$ 处都评估 PME。这对应于慢力没有子循环的 RESPA 方案，即 $M=1$。对于 $M=1$，我们推导的公式给出 $\\mathcal{N}_{\\text{FFT/ns}} = \\frac{10^6}{1} = 10^6$。\n让我们从第一性原理为基准情况验证这一点。每纳秒的内部步数是 $\\frac{1 \\, \\mathrm{ns}}{\\delta t} = \\frac{10^6 \\, \\mathrm{fs}}{2 \\, \\mathrm{fs}} = 5 \\times 10^5$。由于 PME 在每一步都被调用，所以每纳秒有 $5 \\times 10^5$ 次 PME 调用。每次 PME 调用有 $2$ 次 FFT，因此每纳秒的总 FFT 次数是 $(5 \\times 10^5) \\times 2 = 10^6$。这与我们对 $M=1$ 的公式相匹配，证实了推导的正确性。",
            "answer": "$$\\boxed{\\frac{10^6}{M}}$$"
        },
        {
            "introduction": "稳定而精确的模拟需要审慎选择积分时间步长。本练习深入探讨RESPA的核心原则：将时间步长与系统的特征频率对齐。你将学习如何从第一性原理出发，为系统的最快和最慢运动模式确定内外时间步长的约束条件，从而确保数值积分的稳定性。",
            "id": "3427664",
            "problem": "您正在基于可逆参考系传播算法（RESPA）设计一个可逆多时间步积分器，用于一个经典分子动力学哈密顿量。该哈密顿量分裂为 $H = T(\\mathbf{p}) + V_{\\mathrm{fast}}(\\mathbf{q}) + V_{\\mathrm{slow}}(\\mathbf{q})$，其中 $V_{\\mathrm{fast}}$ 包含由最快振动主导的成键项和短程项，而 $V_{\\mathrm{slow}}$ 包含缓慢变化的长程项。内子循环以时间步长 $\\Delta t_{\\mathrm{inner}}$ 对快力进行积分，外循环每隔 $\\Delta t_{\\mathrm{outer}} = L \\, \\Delta t_{\\mathrm{inner}}$ 更新一次慢力，其中 $L \\in \\mathbb{N}$。\n\n假设为 $V_{\\mathrm{fast}}$ 测得的最快简正模频率为 $\\omega_{\\max} = 3.0 \\times 10^{14} \\ \\mathrm{s}^{-1}$，而 $V_{\\mathrm{slow}}$ 中的主要慢涨落频率为 $\\Omega = 6.0 \\times 10^{13} \\ \\mathrm{s}^{-1}$。您对快的内层更新采用保守的安全因子 $c = 0.2$，对慢的外层更新采用 $C = 0.5$，这些安全因子量化了在每个层级上解析的最快和最慢模式每一步允许的最大无量纲相位推进。\n\n从牛顿方程和每个简正模的谐振子模型出发，论证对 $\\Delta t_{\\mathrm{inner}}$ 和 $\\Delta t_{\\mathrm{outer}}$ 的约束是如何通过限制相应角频率的每步相位推进得出的，然后确定当 $\\Delta t_{\\mathrm{inner}}$ 取为其约束条件允许的最大值时，能够确保内层快模和外层慢模的约束同时得到满足的最大的整数外-内子循环因子 $L$。\n\n只报告整数 $L$。最终答案不需要单位。",
            "solution": "该问题要求在给定系统最快和最慢模式的相位推进约束条件下，确定一个 RESPA 多时间步积分方案的最大整数子循环因子 $L$。分析始于谐振子模型，该模型是分子动力学中振荡运动的原型。\n\n对于频率为 $\\omega_i$ 的单个简正模坐标 $q_i$，其牛顿运动方程是一个简谐振子方程：\n$$ \\ddot{q}_i(t) = -\\omega_i^2 q_i(t) $$\n该方程的解是正弦形式的，$q_i(t) = A_i \\cos(\\omega_i t + \\phi_i)$，其中项 $\\omega_i t + \\phi_i$ 是相位。在时间步长为 $\\Delta t$ 的数值积分方案中，每一步相位推进的量为 $\\omega_i \\Delta t$。为了使积分稳定并精确地捕捉振荡行为，这个相位推进必须保持很小。问题通过安全因子 $c$ 和 $C$ 来定义这个稳定性准则。\n\n首先，我们考虑内层时间步长 $\\Delta t_{\\mathrm{inner}}$，它用于对快力 $V_{\\mathrm{fast}}$ 进行积分。这个积分的稳定性受系统中最快频率 $\\omega_{\\max}$ 的限制。在单个内层步骤中，该模式的无量纲相位推进为 $\\omega_{\\max} \\Delta t_{\\mathrm{inner}}$。问题陈述这必须小于或等于安全因子 $c$：\n$$ \\omega_{\\max} \\Delta t_{\\mathrm{inner}} \\le c $$\n问题指定 $\\Delta t_{\\mathrm{inner}}$ 应选择为与此约束一致的最大值。这意味着我们将不等式设为等式：\n$$ \\omega_{\\max} \\Delta t_{\\mathrm{inner}} = c $$\n这使我们可以将内层时间步长表示为：\n$$ \\Delta t_{\\mathrm{inner}} = \\frac{c}{\\omega_{\\max}} $$\n\n其次，我们考虑外层时间步长 $\\Delta t_{\\mathrm{outer}}$，它用于更新慢力 $V_{\\mathrm{slow}}$。这一步的稳定性准则由主要的慢涨落频率 $\\Omega$ 确定。该模式每外层步的相位推进为 $\\Omega \\Delta t_{\\mathrm{outer}}$。这受安全因子 $C$ 的约束：\n$$ \\Omega \\Delta t_{\\mathrm{outer}} \\le C $$\n\n外层和内层时间步长通过整数子循环因子 $L$ 相关联，其中 $\\Delta t_{\\mathrm{outer}} = L \\Delta t_{\\mathrm{inner}}$。我们可以将此关系代入到外层步的约束中：\n$$ \\Omega (L \\Delta t_{\\mathrm{inner}}) \\le C $$\n\n现在我们有一个包含两个条件的系统。我们将第一个约束中最大的 $\\Delta t_{\\mathrm{inner}}$ 的表达式代入第二个约束中：\n$$ \\Omega L \\left(\\frac{c}{\\omega_{\\max}}\\right) \\le C $$\n\n我们被要求找到满足这个不等式的最大整数 $L$。我们可以重新整理不等式以求解 $L$：\n$$ L \\le \\frac{C}{c} \\frac{\\omega_{\\max}}{\\Omega} $$\n\n现在，我们将给定的数值代入这个表达式：\n- 快模安全因子, $c = 0.2$\n- 慢模安全因子, $C = 0.5$\n- 最快频率, $\\omega_{\\max} = 3.0 \\times 10^{14} \\ \\mathrm{s}^{-1}$\n- 主要慢频率, $\\Omega = 6.0 \\times 10^{13} \\ \\mathrm{s}^{-1}$\n\n$$ L \\le \\frac{0.5}{0.2} \\frac{3.0 \\times 10^{14}}{6.0 \\times 10^{13}} $$\n$$ L \\le 2.5 \\times \\frac{3.0}{0.6} $$\n$$ L \\le 2.5 \\times 5 $$\n$$ L \\le 12.5 $$\n\n因为 $L$ 必须是整数 ($L \\in \\mathbb{N}$)，满足此条件的最大整数值 $L$ 是 $12.5$ 的向下取整。\n$$ L_{\\max} = \\lfloor 12.5 \\rfloor = 12 $$\n因此，最大的整数外-内子循环因子是 $12$。",
            "answer": "$$\n\\boxed{12}\n$$"
        },
        {
            "introduction": "在基本稳定性的基础上，优化RESPA模拟涉及到计算成本与长期精度之间的微妙权衡。这个高级练习模拟了一个真实世界中的优化问题。你需要在遵守严格的能量守恒标准（以能量漂移率衡量）的同时，最小化模拟的计算成本，最终推导出一种有原则的方法来选择最佳的子循环比率$M$。",
            "id": "3427621",
            "problem": "一位分子动力学从业者希望通过使用参考系统传播算法（Reference System Propagator Algorithm, RESPA）类型的可逆多时间步方案，来加速溶剂化蛋白质的模拟。总作用力被分解为一个快的、短程部分和一个慢的、长程部分，前者的特征频率远高于后者。快作用力部分使用内时间步长 $\\Delta t$ 进行积分，慢作用力部分则在每个外时间步长 $H = M \\,\\Delta t$ 更新一次，其中 $M$ 是一个正整数的子循环比率。快、慢力分量的单次评估计算成本分别为 $c_{f}$ 和 $c_{s}$。已知代码在线性上是稳定的，只要满足 $\\Delta t \\le \\Delta t_{\\max}^{(f)}$ 和 $H \\le H_{\\max}^{(s)}$；这些限制分别来自于最高的快速振动频率和避免在外层更新中与快速谱发生共振。\n\n该科学家将在没有完整约束自由度的情况下运行长的平衡轨迹，并从验证研究中估算出每纳秒可接受的均方根（RMS）能量漂移率，记为 $\\mathcal{E}_{\\mathrm{rms}}^{\\max}$。对于可逆、辛、二阶算子分裂积分器，一个经过充分检验的事实是，在稳定域内足够小的步长下，主要的均方根能量漂移率与相关步长的平方成正比。当使用力分解时，主要的贡献来自于内部的快速更新和慢-快分裂误差。对于给定的分子系统和力场，相应的比例系数可以通过短时间的校准运行获得；将它们记为 $\\alpha$ 和 $\\beta$，因此均方根漂移率表现出小步长标度关系\n$$\n\\mathcal{E}_{\\mathrm{rms}} \\;\\lesssim\\; \\alpha \\, \\Delta t^{2} \\;+\\; \\beta \\, H^{2}\n\\quad\\text{for}\\quad \\Delta t \\le \\Delta t_{\\max}^{(f)},\\; H \\le H_{\\max}^{(s)}.\n$$\n假设这个界限足够紧，可以作为一个设计约束。\n\n对于固定的1纳秒模拟时间间隔，预期的计算成本与内步数乘以 $c_{f}$ 加上外层慢力评估次数乘以 $c_{s}$ 的和成正比。\n\n在均方根能量漂移界限 $\\mathcal{E}_{\\mathrm{rms}} \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$ 和稳定性约束下，以下哪个标准是选择子循环比率 $M$ 以最小化每纳秒计算成本的正确且有原则的方法？\n\nA. 选择 $M$ 以最小化\n$$\n\\mathcal{C}(M) \\;=\\; \\frac{c_{f} + c_{s}/M}{\\Delta t_{\\mathrm{eff}}(M)} \\,,\n\\quad\n\\Delta t_{\\mathrm{eff}}(M) \\;=\\; \\min\\!\\left\\{ \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^{2}}}\\,,\\; \\Delta t_{\\max}^{(f)}\\,,\\; \\frac{H_{\\max}^{(s)}}{M} \\right\\},\n$$\n并且，在漂移约束起作用的区域（即 $\\Delta t_{\\mathrm{eff}}(M) = \\sqrt{\\mathcal{E}_{\\mathrm{rms}}^{\\max}/(\\alpha + \\beta M^{2})}$），选择最接近\n$$\nM^{\\star} \\;=\\; \\left(\\frac{c_{s}\\,\\alpha}{\\beta\\,c_{f}}\\right)^{\\!1/3}\n$$\n的整数 $M$，前提是满足稳定性约束。\n\nB. 通过选择 $M$ 使得 $c_{s}/M = c_{f}$（即 $M^{\\star} = c_{s}/c_{f}$）来平衡每内步的快力和慢力计算成本，然后将 $\\Delta t$ 设置为稳定性允许的最大值。\n\nC. 通过设置 $M^{\\star} = \\left\\lfloor H_{\\max}^{(s)}/\\Delta t_{\\max}^{(f)} \\right\\rfloor$ 在慢力稳定性限制内最大化 $M$，以便尽可能不频繁地评估慢力。\n\nD. 通过选择 $M$ 使得 $\\alpha \\Delta t^{2} = \\beta H^{2}$（即 $M^{\\star} = \\sqrt{\\alpha/\\beta}$）来均衡均方根漂移界限的快分量和慢分量，然后选择 $\\Delta t$ 使漂移约束饱和。",
            "solution": "用户请求对一个关于多时间步分子动力学模拟优化的问题进行批判性评估。该过程始于对问题陈述的严格验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **积分方案**：可逆多时间步参考系统传播算法（RESPA）。\n*   **力分解**：总作用力被分解为快作用力部分和慢作用力部分。\n*   **时间步长**：\n    *   内时间步长（快作用力）：$\\Delta t$。\n    *   外时间步长（慢作用力）：$H = M \\Delta t$，其中 $M$ 是一个正整数的子循环比率。\n*   **计算成本**：\n    *   快作用力单次评估成本：$c_{f}$。\n    *   慢作用力单次评估成本：$c_{s}$。\n*   **稳定性约束**：\n    *   $\\Delta t \\le \\Delta t_{\\max}^{(f)}$。\n    *   $H \\le H_{\\max}^{(s)}$。\n*   **精度约束（能量守恒）**：\n    *   每纳秒可接受的最大均方根（RMS）能量漂移率：$\\mathcal{E}_{\\mathrm{rms}}^{\\max}$。\n    *   RMS漂移率的标度关系：$\\mathcal{E}_{\\mathrm{rms}} \\approx \\alpha \\, \\Delta t^{2} + \\beta \\, H^{2}$。\n    *   需强制执行的约束：$\\alpha \\, \\Delta t^{2} + \\beta \\, H^{2} \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$。\n*   **优化目标**：最小化每纳秒的计算成本。\n*   **成本函数定义**：对于固定的模拟时间间隔 $T = 1$ ns，成本与快作用力评估总次数加上慢作用力评估总次数成正比。\n    *   快作用力评估次数：$N_f = T / \\Delta t$。\n    *   慢作用力评估次数：$N_s = T / H = T / (M \\Delta t)$。\n    *   总成本与 $N_f c_f + N_s c_s = \\frac{T}{\\Delta t} c_f + \\frac{T}{M \\Delta t} c_s$ 成正比。要最小化单位时间的成本，我们最小化函数 $\\mathcal{C}(\\Delta t, M) = \\frac{1}{\\Delta t} \\left(c_f + \\frac{c_s}{M}\\right)$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学依据充分**：该问题牢固地植根于分子动力学数值积分的既定理论和实践。RESPA的使用、基于特征时间尺度对力进行分解、数值积分器（如Verlet类型）的稳定性极限概念，以及将能量漂移作为精度度量进行分析，这些都是计算统计力学中的标准概念。对于二阶辛积分器，能量漂移误差与时间步长的二次方标度关系是一个众所周知的结果。该问题在科学上是合理的。\n*   **适定性**：该问题是一个约束优化问题。它要求在关于变量 $\\Delta t$ 和 $M$ 的一组不等式约束下，最小化一个明确定义的成本函数 $\\mathcal{C}(\\Delta t, M)$。这样的问题在数学上是适定的，并且有有意义的解。\n*   **客观性**：该问题使用精确的数学语言和客观的物理量（$c_f$、$c_s$、$\\alpha$、$\\beta$等）来表述。没有主观或模糊的陈述。\n*   **完整性与一致性**：该问题提供了所有必要的信息：目标函数、待优化的变量（$\\Delta t$ 和 $M$），以及所有相关的约束（稳定性和精度）。定义是自洽的。\n\n**步骤3：结论与行动**\n\n问题陈述是有效的。它在科学上合理、适定、客观且自洽。因此，我将继续推导解决方案。\n\n### 求解推导\n\n目标是在一组约束条件下，最小化每纳秒的计算成本，该成本由函数 $\\mathcal{C}(\\Delta t, M) = \\frac{1}{\\Delta t} \\left(c_f + \\frac{c_s}{M}\\right)$ 给出。\n\n积分参数 $\\Delta t$ 和 $M$ 的约束条件是：\n1.  **快速稳定性**：$\\Delta t \\le \\Delta t_{\\max}^{(f)}$。\n2.  **慢速稳定性**：$H \\le H_{\\max}^{(s)}$，即 $M \\Delta t \\le H_{\\max}^{(s)}$，或 $\\Delta t \\le \\frac{H_{\\max}^{(s)}}{M}$。\n3.  **精度（能量漂移）**：$\\mathcal{E}_{\\mathrm{rms}} \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$。使用提供的标度关系，即 $\\alpha \\Delta t^2 + \\beta H^2 \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$。代入 $H = M \\Delta t$，我们得到 $\\alpha \\Delta t^2 + \\beta (M \\Delta t)^2 \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$，简化为 $(\\alpha + \\beta M^2) \\Delta t^2 \\le \\mathcal{E}_{\\mathrm{rms}}^{\\max}$。这给出了对 $\\Delta t$ 的第三个上界：$\\Delta t \\le \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^2}}$。\n\n为了最小化与 $\\Delta t$ 成反比的成本函数 $\\mathcal{C}(\\Delta t, M)$，对于任何给定的子循环比率 $M$，必须选择可能的最大 $\\Delta t$ 值。允许的最大 $\\Delta t$ 是从约束中导出的三个上界中的最小值：\n$$\n\\Delta t_{\\text{opt}}(M) = \\min\\left\\{ \\Delta t_{\\max}^{(f)}, \\; \\frac{H_{\\max}^{(s)}}{M}, \\; \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^2}} \\right\\}\n$$\n这个表达式与选项A中定义的 $\\Delta t_{\\mathrm{eff}}(M)$ 相同。\n\n问题现在简化为一个一维优化问题：找到使成本函数最小化的正整数 $M$，其中 $\\Delta t$ 被设置为该 $M$ 的最优值：\n$$\n\\mathcal{C}(M) = \\frac{c_f + c_s/M}{\\Delta t_{\\text{opt}}(M)}\n$$\n\n这是一个通用公式。在许多实际场景中，模拟在精度而非线性稳定性是限制因素的区域中运行。这对应于`min`函数中第三项最小的情况，即漂移约束是“活动的”。让我们分析选项A中建议的这个特定但常见的情形。\n\n假设漂移约束是活动的，我们有：\n$$\n\\Delta t = \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^2}}\n$$\n将此代入成本函数得到：\n$$\n\\mathcal{C}(M) = \\frac{c_f + c_s/M}{\\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^2}}} = \\frac{1}{\\sqrt{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}} \\left(c_f + \\frac{c_s}{M}\\right) \\sqrt{\\alpha + \\beta M^2}\n$$\n为了找到最小化 $\\mathcal{C}(M)$ 的最优 $M$，我们可以将 $M$ 视为连续变量，通过求导找到极值，然后选择最接近这个最优实数值的整数。我们可以忽略常数前因子 $1/\\sqrt{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}$，并最小化函数 $f(M) = (c_f + c_s/M) \\sqrt{\\alpha + \\beta M^2}$。最小化函数的平方 $f(M)^2$ 通常更简单，因为这可以消除平方根，并且对于正函数会得到相同的极值点。\n设 $g(M) = f(M)^2 = (c_f + c_s/M)^2 (\\alpha + \\beta M^2)$。为了找到最小值，我们将其对 $M$ 的导数设为零。\n$$\n\\frac{dg}{dM} = \\frac{d}{dM} \\left[ \\left(c_f + \\frac{c_s}{M}\\right)^2 (\\alpha + \\beta M^2) \\right] = 0\n$$\n使用乘积法则：\n$$\n2\\left(c_f + \\frac{c_s}{M}\\right)\\left(-\\frac{c_s}{M^2}\\right)(\\alpha + \\beta M^2) + \\left(c_f + \\frac{c_s}{M}\\right)^2(2\\beta M) = 0\n$$\n因为 $c_f + c_s/M > 0$，我们可以除以因子 $2(c_f + c_s/M)$:\n$$\n-\\frac{c_s}{M^2}(\\alpha + \\beta M^2) + \\left(c_f + \\frac{c_s}{M}\\right)(\\beta M) = 0\n$$\n$$\n-\\frac{c_s \\alpha}{M^2} - c_s \\beta + c_f \\beta M + c_s \\beta = 0\n$$\n$$\nc_f \\beta M = \\frac{c_s \\alpha}{M^2}\n$$\n$$\nM^3 = \\frac{c_s \\alpha}{c_f \\beta}\n$$\n$$\nM^{\\star} = \\left(\\frac{c_s \\alpha}{\\beta c_f}\\right)^{1/3}\n$$\n这个结果给出了当精度约束占主导地位时的最优子循环比率 $M$。完整且有原则的程序包括首先在所有可能的情形（稳定性限制或精度限制）下定义成本函数 $\\mathcal{C}(M)$，然后找到使其最小化的整数 $M$。$M^{\\star}$ 的表达式是精度限制情形下的特定解。\n\n### 逐项分析\n\n**A. 选择 $M$ 以最小化 $\\mathcal{C}(M) = \\frac{c_{f} + c_{s}/M}{\\Delta t_{\\mathrm{eff}}(M)}$，其中 $\\Delta t_{\\mathrm{eff}}(M) = \\min\\!\\left\\{ \\sqrt{\\frac{\\mathcal{E}_{\\mathrm{rms}}^{\\max}}{\\alpha + \\beta M^{2}}}\\,,\\; \\Delta t_{\\max}^{(f)}\\,,\\; \\frac{H_{\\max}^{(s)}}{M} \\right\\}$，并且，在漂移约束起作用的区域，选择最接近 $M^{\\star} = \\left(\\frac{c_{s}\\,\\alpha}{\\beta\\,c_{f}}\\right)^{\\!1/3}$ 的整数 $M$，前提是满足稳定性约束。**\n\n该选项首先通过将成本定义为 $M$ 的函数，正确地构建了完整的优化问题，其中 $\\Delta t$ 根据所有约束被最大化。然后，它为性能受所需精度（能量漂移）而非数值稳定性限制的常见且重要的情形，提供了正确的最优 $M$ 的解析解。选择接近此解析最优值的整数 $M$，同时检查该选择是否与初始假设一致（即不违反稳定性约束）的程序是正确的方法。\n**结论：正确。**\n\n**B. 通过选择 $M$ 使得 $c_{s}/M = c_{f}$（即 $M^{\\star} = c_{s}/c_{f}$）来平衡每内步的快力和慢力计算成本，然后将 $\\Delta t$ 设置为稳定性允许的最大值。**\n\n这是一种试图平衡计算工作负载的特定启发式方法。慢作用力在一个内步上平均的成本是 $c_s/M$。将其等同于一次快作用力评估的成本 $c_f$，得到 $M = c_s/c_f$。这种方法完全忽略了由参数 $\\alpha$ 和 $\\beta$ 代表的误差累积物理学。成本和精度之间的最优权衡必须涉及这些参数，正如推导所示。这种启发式方法不能保证是最优的。\n**结论：不正确。**\n\n**C. 通过设置 $M^{\\star} = \\left\\lfloor H_{\\max}^{(s)}/\\Delta t_{\\max}^{(f)} \\right\\rfloor$ 在慢力稳定性限制内最大化 $M$，以便尽可能不频繁地评估慢力。**\n\n该策略对应于同时将内时间步长和外时间步长推到它们各自的稳定性极限：$\\Delta t = \\Delta t_{\\max}^{(f)}$ 和 $H = M \\Delta t = H_{\\max}^{(s)}$。虽然这相对于稳定性最大化了时间步长，但它完全忽略了精度约束 $\\mathcal{E}_{\\mathrm{rms}}^{\\max}$。如果由此产生的能量漂移高得无法接受，那么这种参数选择是无效的。即使漂移可以接受，这种选择通常也不是最优的，因为 $M$ 和 $\\Delta t$ 的不同组合可能以更低的计算成本达到相同的精度。\n**结论：不正确。**\n\n**D. 通过选择 $M$ 使得 $\\alpha \\Delta t^{2} = \\beta H^{2}$（即 $M^{\\star} = \\sqrt{\\alpha/\\beta}$）来均衡均方根漂移界限的快分量和慢分量，然后选择 $\\Delta t$ 使漂移约束饱和。**\n\n这种被称为“误差均分”的启发式方法建议平衡两个主要的误差来源。从 $\\alpha \\Delta t^2 = \\beta (M\\Delta t)^2$ 可得 $M^2 = \\alpha/\\beta$，或 $M = \\sqrt{\\alpha/\\beta}$。这种方法忽略了与控制每个误差分量相关的计算成本 $c_f$ 和 $c_s$。真正的最优解必须平衡降低每个来源误差的边际成本。推导出的最优条件 $M^3 = (c_s \\alpha)/(c_f \\beta)$ 清楚地表明，成本 $c_f$ 和 $c_s$ 起着至关重要的作用。均分误差仅在管理每个误差源的有效成本相等这一特殊情况下才是最优的，而这在一般情况下并不成立。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}