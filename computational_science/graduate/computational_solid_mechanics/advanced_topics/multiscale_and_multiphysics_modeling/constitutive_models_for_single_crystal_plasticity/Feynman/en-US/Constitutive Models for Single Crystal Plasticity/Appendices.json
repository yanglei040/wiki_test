{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex numerical implementations, it is crucial to build physical intuition about the constitutive models themselves. A powerful way to do this is through dimensional analysis, which helps validate the structure of equations and reveal the inherent scales of a problem. This first practice focuses on deriving a characteristic time scale for plastic slip from fundamental dislocation-based relations, providing a tangible link between microstructural parameters and the macroscopic response .",
            "id": "3552438",
            "problem": "A single crystal with one active slip system is subjected to a Cauchy stress tensor $\\boldsymbol{\\sigma}$ such that the resolved shear stress on the slip system is $\\tau = \\boldsymbol{s} \\cdot \\boldsymbol{\\sigma} \\, \\boldsymbol{m}$, where $\\boldsymbol{s}$ is the unit vector in the slip direction and $\\boldsymbol{m}$ is the unit normal to the slip plane. The plastic slip rate on this system is postulated to follow the dislocation-based Orowan relation $\\dot{\\gamma} = \\rho \\, b \\, v$, where $\\rho$ is the total mobile dislocation line density, $b$ is the magnitude of the Burgers vector, and $v$ is the average dislocation velocity along the slip direction. Assume a stress-controlled mobility law $v(\\tau,g) = M \\, g \\, \\varphi(\\tau/g)$, where $g$ is a current slip resistance (with the same physical dimension as shear stress), $M$ is a constant mobility coefficient, and $\\varphi$ is a dimensionless function satisfying $\\varphi(1)=1$ and depending only on the ratio $\\tau/g$.\n\nUsing only unit consistency and scaling arguments starting from these statements, construct a characteristic time scale $t_{\\star}$ such that the dimensionless slip-rate $\\widehat{\\dot{\\gamma}} = \\dot{\\gamma} \\, t_{\\star}$ reduces to $\\widehat{\\dot{\\gamma}} = \\varphi(\\widehat{\\tau})$ with $\\widehat{\\tau} = \\tau/g$. Derive an explicit expression for $t_{\\star}$ in terms of $\\rho$, $b$, $M$, and $g$. Express any time scale in seconds. The final answer must be a single closed-form analytic expression for $t_{\\star}$.",
            "solution": "The problem requires the derivation of a characteristic time scale, $t_{\\star}$, for a single crystal plasticity model. The derivation is to be based on unit consistency and scaling arguments, starting from the provided constitutive relations.\n\nFirst, let us state the given physical laws. The plastic slip rate, $\\dot{\\gamma}$, on a given slip system is described by the Orowan relation:\n$$\n\\dot{\\gamma} = \\rho \\, b \\, v\n$$\nwhere $\\rho$ is the mobile dislocation density, $b$ is the magnitude of the Burgers vector, and $v$ is the average dislocation velocity.\n\nThe dislocation velocity, $v$, is itself a function of the resolved shear stress, $\\tau$, and a slip resistance, $g$. The given mobility law is:\n$$\nv(\\tau, g) = M \\, g \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\nHere, $M$ is a mobility coefficient and $\\varphi$ is a dimensionless function of the normalized stress $\\tau/g$.\n\nThe objective is to find a characteristic time scale $t_{\\star}$ such that the dimensionless slip rate, defined as $\\widehat{\\dot{\\gamma}} = \\dot{\\gamma} \\, t_{\\star}$, can be expressed purely as a function of the dimensionless stress $\\widehat{\\tau} = \\tau/g$. Specifically, the target relationship is:\n$$\n\\widehat{\\dot{\\gamma}} = \\varphi(\\widehat{\\tau})\n$$\nwhich can be written as:\n$$\n\\dot{\\gamma} \\, t_{\\star} = \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n\nTo find the expression for $t_{\\star}$, we can substitute the given laws into one another. We start by substituting the expression for the dislocation velocity $v$ into the Orowan relation for $\\dot{\\gamma}$:\n$$\n\\dot{\\gamma} = \\rho \\, b \\, \\left(M \\, g \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\\right)\n$$\nThis equation can be rearranged by grouping the terms:\n$$\n\\dot{\\gamma} = (\\rho \\, b \\, M \\, g) \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n\nNow, we compare this derived expression for $\\dot{\\gamma}$ with the target dimensionless form. The target form can be rearranged to express $\\dot{\\gamma}$ as:\n$$\n\\dot{\\gamma} = \\frac{1}{t_{\\star}} \\, \\varphi\\left(\\frac{\\tau}{g}\\right)\n$$\n\nFor these two expressions for $\\dot{\\gamma}$ to be equivalent for any non-trivial function $\\varphi$, the coefficients multiplying the function $\\varphi(\\tau/g)$ must be equal. Therefore, we can equate the corresponding terms:\n$$\n\\rho \\, b \\, M \\, g = \\frac{1}{t_{\\star}}\n$$\n\nSolving this equation for the characteristic time scale $t_{\\star}$ yields the desired expression:\n$$\nt_{\\star} = \\frac{1}{\\rho \\, b \\, M \\, g}\n$$\n\nTo ensure the correctness of this result, we perform a dimensional analysis to confirm that $t_{\\star}$ indeed has units of time. Let $[X]$ denote the physical dimension of a quantity $X$ in terms of fundamental dimensions of mass ($M_{\\text{dim}}$), length ($L$), and time ($T$).\n\n*   The slip rate $\\dot{\\gamma}$ is a rate of shear strain, which is dimensionless. Thus, $[\\dot{\\gamma}] = T^{-1}$.\n*   The dislocation density $\\rho$ is length of dislocation line per unit volume. Thus, $[\\rho] = L/L^3 = L^{-2}$.\n*   The Burgers vector magnitude $b$ is a length. Thus, $[b] = L$.\n*   The dislocation velocity $v$ is length per unit time. Thus, $[v] = L T^{-1}$.\n*   The Orowan relation is dimensionally consistent: $[\\dot{\\gamma}] = [\\rho][b][v] \\implies T^{-1} = (L^{-2})(L)(L T^{-1}) = T^{-1}$.\n*   The resolved shear stress $\\tau$ and slip resistance $g$ have dimensions of stress (Force/Area). Force has dimensions $M_{\\text{dim}} L T^{-2}$, so stress has dimensions $M_{\\text{dim}} L^{-1} T^{-2}$. Hence, $[\\tau] = [g] = M_{\\text{dim}} L^{-1} T^{-2}$.\n*   The function $\\varphi$ and its argument $\\tau/g$ are dimensionless.\n*   From the mobility law $v = M g \\varphi(\\tau/g)$, we can find the dimensions of the mobility coefficient $M$:\n    $$[M] = \\frac{[v]}{[g]} = \\frac{L T^{-1}}{M_{\\text{dim}} L^{-1} T^{-2}} = M_{\\text{dim}}^{-1} L^2 T$$\n*   Now, we check the dimensions of our expression for $t_{\\star}$:\n    $$[t_{\\star}] = \\frac{1}{[\\rho][b][M][g]} = \\frac{1}{(L^{-2})(L)(M_{\\text{dim}}^{-1} L^{2} T)(M_{\\text{dim}} L^{-1} T^{-2})}$$\n    Combining the exponents for each fundamental dimension in the denominator:\n    *   Mass ($M_{\\text{dim}}$): $-1 + 1 = 0$\n    *   Length ($L$): $-2 + 1 + 2 - 1 = 0$\n    *   Time ($T$): $1 - 2 = -1$\n    So, the dimensions of the denominator are $[ \\rho \\, b \\, M \\, g ] = T^{-1}$.\n*   Therefore, the dimension of $t_{\\star}$ is:\n    $$[t_{\\star}] = \\frac{1}{T^{-1}} = T$$\nThis confirms that the derived expression for $t_{\\star}$ has the physical dimension of time. In the SI system, its unit is seconds. The problem statement asked to \"Express any time scale in seconds,\" which is fulfilled by deriving an expression that is dimensionally correct for time.\n\nThe provided condition $\\varphi(1)=1$ can serve as an additional check. When $\\tau=g$, we have $\\widehat{\\tau} = 1$. The target form gives $\\widehat{\\dot{\\gamma}} = \\varphi(1) = 1$, which means $\\dot{\\gamma} t_{\\star} = 1$, or $\\dot{\\gamma} = 1/t_{\\star}$. From the constitutive laws, when $\\tau=g$, the velocity is $v = M g \\varphi(1) = M g$. The slip rate is then $\\dot{\\gamma} = \\rho b v = \\rho b M g$. Equating the two results for $\\dot{\\gamma}$ gives $1/t_{\\star} = \\rho b M g$, which once again yields $t_{\\star} = 1/(\\rho b M g)$. This reinforces the validity of the result.\n\nThe final expression depends only on the material parameters $\\rho$, $b$, $M$, and the internal state variable $g$, as required.",
            "answer": "$$\n\\boxed{\\frac{1}{\\rho \\, b \\, M \\, g}}\n$$"
        },
        {
            "introduction": "A cornerstone of developing reliable computational models is verification: ensuring the code correctly solves the intended mathematical equations. A standard verification procedure involves testing the implementation against a known analytical solution for a simplified scenario. This exercise guides you through deriving and implementing the exact stress-strain response for a crystal with a single active slip system under small strains, a foundational building block for any crystal plasticity solver .",
            "id": "3552456",
            "problem": "Consider a small-strain, rate-independent, single slip constitutive model for a single crystal subjected to simple shear. The goal is to verify a computational implementation against an analytical closed-form solution under monotonic loading. The material response is restricted to small strains, and the stress is the Cauchy stress. Use the following base principles and definitions.\n\n1. Kinematics and elasticity: Under engineering simple shear of magnitude $\\gamma$, the small strain tensor has the nonzero component $e_{xy} = \\gamma/2$. For isotropic linear elasticity with shear modulus $G$, the shear stress is $\\sigma_{xy} = 2 G e^{e}_{xy}$, where $e^{e}_{xy}$ is the elastic shear strain. In purely shear loading, this reduces to $\\sigma_{xy} = G \\gamma - 2 G e^{p}_{xy}$, since $e_{xy} = e^{e}_{xy} + e^{p}_{xy}$.\n\n2. Slip-induced plastic strain: For a single slip system with unit slip direction $m$ and unit slip plane normal $n$ (with $m \\perp n$), the plastic strain tensor is $e^{p} = \\gamma_{p} \\operatorname{sym}(m \\otimes n)$, where $\\gamma_{p}$ is the plastic slip and $\\operatorname{sym}(m \\otimes n) = \\frac{1}{2} \\left(m \\otimes n + n \\otimes m\\right)$. Consequently, the plastic shear strain component is $e^{p}_{xy} = \\gamma_{p} S_{xy}$ with $S_{xy} = \\frac{m_{x} n_{y} + m_{y} n_{x}}{2}$.\n\n3. Resolved shear stress: The resolved shear stress on the slip system is $\\tau = m \\cdot \\sigma \\cdot n = m_{i} \\sigma_{ij} n_{j}$. For pure shear $\\sigma_{xy}$, this simplifies to $\\tau = 2 S_{xy} \\sigma_{xy}$.\n\n4. Flow rule and hardening: The rate-independent flow rule with linear isotropic hardening is $|\\tau| = \\tau_{0} + h \\, \\gamma_{p}^{\\mathrm{eq}}$, where $\\tau_{0}$ is the initial critical resolved shear stress, $h$ is the hardening modulus, and $\\gamma_{p}^{\\mathrm{eq}} = |\\gamma_{p}|$ for single slip. Under monotonic loading, the sign of $\\gamma_{p}$ matches the sign of $\\tau$, and the active slip condition is enforced when the yield criterion is met.\n\nTask: Starting from the above base, derive and implement the analytical, piecewise solution for $\\sigma_{xy}$ as a function of the applied engineering shear $\\gamma$, the shear modulus $G$, the slip orientation $(m, n)$, the initial critical resolved shear stress $\\tau_{0}$, and the hardening modulus $h$.\n\nRequirements:\n- Derive the yield shear $\\gamma_{y}$ and the plastic slip $\\gamma_{p}$ as functions of the input parameters by enforcing equilibrium of the resolved shear stress with the flow rule.\n- For loading where the slip system does not carry resolved shear under the applied stress ($S_{xy} = 0$), ensure the analytical solution reduces to purely elastic response.\n- Implement the derived piecewise formula in a program that computes $\\sigma_{xy}$ for each test case below.\n\nPhysical and numerical units:\n- All stresses must be expressed in Pascals.\n- Engineering shear $\\gamma$ is dimensionless.\n- The final outputs must be expressed in Pascals, as floating-point numbers.\n\nTest suite:\nUse the following parameter sets, expressed in the International System of Units (SI). In all cases, the material shear modulus is $G = 25 \\times 10^{9}$ Pa and the initial critical resolved shear stress is $\\tau_{0} = 50 \\times 10^{6}$ Pa. Slip direction and normal are given as unit vectors in $\\mathbb{R}^{3}$, and $h$ is in Pascals.\n1. Case A (post-yield, positive shear): $h = 200 \\times 10^{6}$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = 0.01$.\n2. Case B (pre-yield): $h = 200 \\times 10^{6}$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = 0.001$.\n3. Case C (perfect plasticity, post-yield): $h = 0$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = 0.05$.\n4. Case D (inactive slip orientation in this loading state): $h = 200 \\times 10^{6}$ Pa, $m = \\left(\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, 0\\right)$, $n = \\left(\\frac{\\sqrt{2}}{2}, -\\frac{\\sqrt{2}}{2}, 0\\right)$, $\\gamma = 0.01$.\n5. Case E (post-yield, negative shear): $h = 200 \\times 10^{6}$ Pa, $m = (1, 0, 0)$, $n = (0, 1, 0)$, $\\gamma = -0.01$.\n\nProgram output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$\\text{result1}$,$\\text{result2}$,$\\text{result3}$]\").\n- The list must contain the computed values of $\\sigma_{xy}$ in Pascals for the five cases in the order A, B, C, D, E.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of continuum mechanics and crystal plasticity, well-posed with a clear objective and sufficient data, and formulated using objective, formal language. The provided parameters and conditions are self-consistent and physically plausible. We may therefore proceed with the derivation and solution.\n\nThe objective is to derive an analytical, piecewise expression for the shear stress $\\sigma_{xy}$ as a function of the applied engineering shear strain $\\gamma$. The derivation is based on the provided set of constitutive equations for a rate-independent, single-slip model under small-strain conditions.\n\nThe governing equations are:\n1.  Decomposition of total strain $e_{xy}$ into elastic $e^e_{xy}$ and plastic $e^p_{xy}$ parts: $e_{xy} = e^e_{xy} + e^p_{xy}$. The total shear strain is given by $e_{xy} = \\gamma / 2$.\n2.  Elastic stress-strain relation (Hooke's Law for shear): $\\sigma_{xy} = 2 G e^e_{xy}$, where $G$ is the shear modulus. Combining with the strain decomposition, we get $\\sigma_{xy} = 2 G (e_{xy} - e^p_{xy}) = G \\gamma - 2 G e^p_{xy}$.\n3.  Plastic strain from slip: The plastic shear strain component $e^p_{xy}$ is related to the plastic slip magnitude $\\gamma_p$ on a specific slip system via $e^p_{xy} = \\gamma_p S_{xy}$, where $S_{xy} = \\frac{1}{2}(m_x n_y + m_y n_x)$ is the geometric factor for simple shear, derived from the slip direction vector $m$ and slip plane normal vector $n$.\n4.  Resolved shear stress: The stress driving slip is the resolved shear stress $\\tau$, given by $\\tau = 2 S_{xy} \\sigma_{xy}$ for a pure shear stress state $\\sigma_{xy}$.\n5.  Yield criterion and flow rule (Kuhn-Tucker conditions): Plastic slip occurs only when the resolved shear stress reaches a critical value. For linear isotropic hardening, this is given by $|\\tau| = \\tau_0 + h \\gamma_p^{\\mathrm{eq}}$, where $\\tau_0$ is the initial critical resolved shear stress, $h$ is the hardening modulus, and $\\gamma_p^{\\mathrm{eq}} = |\\gamma_p|$ for single slip. Slip is inactive ($\\gamma_p=0$) if $|\\tau| < \\tau_0 + h |\\gamma_p|$. For monotonic loading, the sign of plastic slip follows the sign of the resolved shear stress: $\\operatorname{sgn}(\\gamma_p) = \\operatorname{sgn}(\\tau)$.\n\nWe can now derive the piecewise solution by considering the elastic and plastic regimes.\n\n**1. Elastic Regime**\nIn the elastic regime, there is no plastic slip, so $\\gamma_p = 0$.\n- From equation (3), the plastic strain is zero: $e^p_{xy} = 0$.\n- From equation (2), the stress-strain relation is linear: $\\sigma_{xy} = G \\gamma$.\n- The resolved shear stress is then $\\tau = 2 S_{xy} \\sigma_{xy} = 2 S_{xy} G \\gamma$.\nThis regime holds as long as the yield criterion is not met, i.e., $|\\tau| \\le \\tau_0$. Substituting the expression for $\\tau$:\n$$|2 S_{xy} G \\gamma| \\le \\tau_0$$\n$$|\\gamma| \\le \\frac{\\tau_0}{2 G |S_{xy}|}$$\nThis defines the yield shear strain, $\\gamma_y$:\n$$\\gamma_y = \\frac{\\tau_0}{2 G |S_{xy}|}$$\nThus, for an applied shear $|\\gamma| \\le \\gamma_y$, the material response is purely elastic, and $\\sigma_{xy} = G \\gamma$.\n\nA special case arises if $S_{xy}=0$. In this situation, the resolved shear stress $\\tau = 2 S_{xy} \\sigma_{xy} = 0$ for any applied stress. Since $\\tau_0 > 0$, the yield criterion $|\\tau| \\ge \\tau_0$ can never be satisfied. Consequently, $\\gamma_p$ is always zero, and the response is purely elastic for all values of $\\gamma$: $\\sigma_{xy} = G \\gamma$.\n\n**2. Plastic Regime**\nWhen $|\\gamma| > \\gamma_y$ (and $S_{xy} \\neq 0$), plastic slip occurs. The system of equations must be solved simultaneously. For monotonic loading, the yield condition is active:\n$$|\\tau| = \\tau_0 + h |\\gamma_p|$$\nLet's establish the sign conventions. For monotonic loading starting from a zero-stress state, we can assume $\\operatorname{sgn}(\\sigma_{xy}) = \\operatorname{sgn}(\\gamma)$. The sign of the resolved shear stress is $\\operatorname{sgn}(\\tau) = \\operatorname{sgn}(2 S_{xy} \\sigma_{xy}) = \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\sigma_{xy}) = \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)$. The flow rule requires $\\operatorname{sgn}(\\gamma_p) = \\operatorname{sgn}(\\tau)$.\nThus, $\\gamma_p = |\\gamma_p| \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)$.\n\nThe stress expression (equation 2) can be expanded using equation (3):\n$$\\sigma_{xy} = G \\gamma - 2 G S_{xy} \\gamma_p = G \\gamma - 2 G S_{xy} \\left( |\\gamma_p| \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma) \\right)$$\n$$\\sigma_{xy} = G \\gamma - 2 G |S_{xy}| \\operatorname{sgn}(\\gamma) |\\gamma_p|$$\nThe active yield criterion can be written as $\\tau = (\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(\\tau)$. Substituting $\\tau = 2 S_{xy} \\sigma_{xy}$ and $\\operatorname{sgn}(\\tau)$:\n$$2 S_{xy} \\sigma_{xy} = (\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)$$\nDividing by $2S_{xy}$ gives a second expression for $\\sigma_{xy}$:\n$$\\sigma_{xy} = \\frac{(\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(S_{xy}) \\operatorname{sgn}(\\gamma)}{2 S_{xy}} = \\frac{(\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(\\gamma)}{2 |S_{xy}|}$$\nEquating the two expressions for $\\sigma_{xy}$:\n$$G \\gamma - 2 G |S_{xy}| \\operatorname{sgn}(\\gamma) |\\gamma_p| = \\frac{(\\tau_0 + h |\\gamma_p|) \\operatorname{sgn}(\\gamma)}{2 |S_{xy}|}$$\nTo solve for $|\\gamma_p|$, we can multiply the entire equation by $\\operatorname{sgn}(\\gamma)$ (since $|\\operatorname{sgn}(\\gamma)|=1$):\n$$G |\\gamma| - 2 G |S_{xy}| |\\gamma_p| = \\frac{\\tau_0 + h |\\gamma_p|}{2 |S_{xy}|}$$\n$$2 G |S_{xy}| |\\gamma| - 4 G S_{xy}^2 |\\gamma_p| = \\tau_0 + h |\\gamma_p|$$\n$$|\\gamma_p| (h + 4 G S_{xy}^2) = 2 G |S_{xy}| |\\gamma| - \\tau_0$$\n$$|\\gamma_p| = \\frac{2 G |S_{xy}| |\\gamma| - \\tau_0}{h + 4 G S_{xy}^2}$$\nThis expression for $|\\gamma_p|$ is valid for $|\\gamma| > \\gamma_y$. Note that at the yield point, $|\\gamma|=\\gamma_y=\\tau_0/(2G|S_{xy}|)$, the numerator becomes zero, correctly giving $|\\gamma_p|=0$.\n\nFinally, we substitute $|\\gamma_p|$ back into the simpler expression for $\\sigma_{xy}$:\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\tau_0 + h \\left( \\frac{2 G |S_{xy}| |\\gamma| - \\tau_0}{h + 4 G S_{xy}^2} \\right) \\right]$$\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{\\tau_0 (h + 4 G S_{xy}^2) + h (2 G |S_{xy}| |\\gamma| - \\tau_0)}{h + 4 G S_{xy}^2} \\right]$$\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{\\tau_0 h + 4 G S_{xy}^2 \\tau_0 + 2 G h |S_{xy}| |\\gamma| - h \\tau_0}{h + 4 G S_{xy}^2} \\right]$$\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{4 G S_{xy}^2 \\tau_0 + 2 G h |S_{xy}| |\\gamma|}{h + 4 G S_{xy}^2} \\right]$$\nFactoring out $2G|S_{xy}|$ from the numerator within the brackets:\n$$\\sigma_{xy} = \\frac{\\operatorname{sgn}(\\gamma)}{2 |S_{xy}|} \\left[ \\frac{2 G |S_{xy}| (2 |S_{xy}| \\tau_0 + h |\\gamma|)}{h + 4 G S_{xy}^2} \\right]$$\n$$\\sigma_{xy} = \\operatorname{sgn}(\\gamma) \\frac{G (2 |S_{xy}| \\tau_0 + h |\\gamma|)}{h + 4 G S_{xy}^2}$$\nUsing $\\gamma = |\\gamma| \\operatorname{sgn}(\\gamma)$, we arrive at the final expression for the plastic regime:\n$$\\sigma_{xy} = \\frac{G (2 |S_{xy}| \\tau_0 \\operatorname{sgn}(\\gamma) + h \\gamma)}{h + 4 G S_{xy}^2}$$\n\n**Summary of the Piecewise Solution**\n\n1.  Calculate the geometric factor $S_{xy} = \\frac{1}{2}(m_x n_y + m_y n_x)$.\n2.  If $S_{xy} = 0$, the response is always elastic:\n    $$\\sigma_{xy} = G \\gamma$$\n3.  If $S_{xy} \\neq 0$, calculate the yield shear strain $\\gamma_y = \\frac{\\tau_0}{2 G |S_{xy}|}$.\n    a.  If $|\\gamma| \\le \\gamma_y$ (elastic regime):\n        $$\\sigma_{xy} = G \\gamma$$\n    b.  If $|\\gamma| > \\gamma_y$ (plastic regime):\n        $$\\sigma_{xy} = \\frac{G (2 |S_{xy}| \\tau_0 \\operatorname{sgn}(\\gamma) + h \\gamma)}{h + 4 G S_{xy}^2}$$\n\nThe implementation will follow this logic for each test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the shear stress for a single crystal under simple shear\n    based on an analytical single-slip constitutive model.\n    \"\"\"\n    G = 25.0e9  # Shear modulus in Pa\n    tau0 = 50.0e6  # Initial critical resolved shear stress in Pa\n\n    # Test cases: (h, m, n, gamma)\n    test_cases = [\n        # Case A: Post-yield, positive shear\n        (200.0e6, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), 0.01),\n        # Case B: Pre-yield\n        (200.0e6, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), 0.001),\n        # Case C: Perfect plasticity, post-yield\n        (0.0, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), 0.05),\n        # Case D: Inactive slip orientation\n        (200.0e6, np.array([np.sqrt(2)/2, np.sqrt(2)/2, 0.0]), np.array([np.sqrt(2)/2, -np.sqrt(2)/2, 0.0]), 0.01),\n        # Case E: Post-yield, negative shear\n        (200.0e6, np.array([1.0, 0.0, 0.0]), np.array([0.0, 1.0, 0.0]), -0.01)\n    ]\n\n    results = []\n\n    for h, m, n, gamma in test_cases:\n        # 1. Calculate the geometric factor S_xy\n        # S_xy = (m_x * n_y + m_y * n_x) / 2\n        S_xy = 0.5 * (m[0] * n[1] + m[1] * n[0])\n\n        sigma_xy = 0.0\n\n        # 2. Check if the slip system is active for this loading\n        # np.isclose is used for robust floating-point comparison\n        if np.isclose(S_xy, 0.0):\n            # Purely elastic response if the resolved shear stress is always zero\n            sigma_xy = G * gamma\n        else:\n            # 3. Calculate yield shear strain\n            abs_S_xy = np.abs(S_xy)\n            gamma_y = tau0 / (2.0 * G * abs_S_xy)\n\n            # 4. Determine if loading is elastic or plastic\n            if np.abs(gamma) <= gamma_y:\n                # a. Elastic regime\n                sigma_xy = G * gamma\n            else:\n                # b. Plastic regime\n                sign_gamma = np.sign(gamma)\n                \n                # Numerator of the analytical solution for the plastic regime\n                numerator = G * (2.0 * abs_S_xy * tau0 * sign_gamma + h * gamma)\n                \n                # Denominator of the analytical solution for the plastic regime\n                denominator = h + 4.0 * G * S_xy**2\n                \n                sigma_xy = numerator / denominator\n\n        results.append(sigma_xy)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Constitutive models are built upon physical hypotheses about a material's behavior, and the choice of which mechanisms to include can significantly impact predictive accuracy. This advanced practice explores the sensitivity of model predictions to the set of active slip systems, a key physical assumption in crystal plasticity. By comparing the behavior of a model with only primary octahedral slip to one including secondary cubic slip systems, you will quantify the resulting differences in the predicted anisotropic yield surface and lattice rotation, gaining insight into the practical consequences of modeling choices .",
            "id": "3552467",
            "problem": "You are asked to quantify the sensitivity of predictions in single crystal plasticity to the choice of slip system set by measuring changes in the anisotropic yield locus and the lattice rotation under a specified loading path. The crystal is Face-Centered Cubic (FCC) and two slip sets are compared: (i) the primary set of $12$ octahedral $\\{111\\}\\langle 110\\rangle$ slip systems, and (ii) an extended set that augments the primary set with $6$ cube $\\{100\\}\\langle 110\\rangle$ slip systems.\n\nStarting from the following fundamental bases and core definitions:\n- Small strain kinematics with additive decomposition of the velocity gradient: $\\mathbf{L} = \\dot{\\mathbf{F}} \\mathbf{F}^{-1} = \\mathbf{D} + \\mathbf{W}$, where $\\mathbf{D}$ is the rate of deformation tensor and $\\mathbf{W}$ is the spin tensor.\n- Additive split of elastic and plastic parts in small strain: $\\mathbf{D} = \\mathbf{D}^{e} + \\mathbf{D}^{p}$, with the plastic part defined by slip on systems $s = 1,\\dots,N$ as $\\mathbf{L}^{p} = \\sum_{s=1}^{N} \\dot{\\gamma}_{s} \\,\\mathbf{s}_{s} \\otimes \\mathbf{n}_{s}$, hence $\\mathbf{D}^{p} = \\mathrm{sym}(\\mathbf{L}^{p}) = \\dfrac{1}{2}\\sum_{s=1}^{N} \\dot{\\gamma}_{s}\\left(\\mathbf{s}_{s} \\otimes \\mathbf{n}_{s} + \\mathbf{n}_{s} \\otimes \\mathbf{s}_{s}\\right)$ and plastic spin $\\mathbf{W}^{p} = \\mathrm{skw}(\\mathbf{L}^{p}) = \\dfrac{1}{2}\\sum_{s=1}^{N} \\dot{\\gamma}_{s}\\left(\\mathbf{s}_{s} \\otimes \\mathbf{n}_{s} - \\mathbf{n}_{s} \\otimes \\mathbf{s}_{s}\\right)$.\n- Hooke’s law for isotropic linear elasticity: $\\dot{\\boldsymbol{\\sigma}} = \\mathbb{C} : (\\mathbf{D} - \\mathbf{D}^{p})$ with $\\mathbb{C}$ constructed from Young’s modulus $E$ and Poisson’s ratio $\\nu$ as $\\dot{\\boldsymbol{\\sigma}} = 2\\mu(\\mathbf{D} - \\mathbf{D}^{p}) + \\lambda \\,\\mathrm{tr}(\\mathbf{D} - \\mathbf{D}^{p})\\,\\mathbf{I}$, where $\\mu = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$.\n- Resolved shear stress on slip system $s$: $\\tau_{s} = \\mathbf{s}_{s}\\cdot\\boldsymbol{\\sigma}\\,\\mathbf{n}_{s} = \\mathbf{s}_{s}^{\\mathsf{T}}\\boldsymbol{\\sigma}\\,\\mathbf{n}_{s}$.\n- A viscoplastic flow rule of power-law type: $\\dot{\\gamma}_{s} = \\dot{\\gamma}_{0}\\,\\mathrm{sign}(\\tau_{s})\\left(\\dfrac{|\\tau_{s}|}{g_{s}}\\right)^{n}$, where $g_{s}$ is the critical resolved shear stress for system $s$, $\\dot{\\gamma}_{0}$ is a reference shear rate, and $n$ is the rate-sensitivity exponent.\n- Under macroscopic loading with zero imposed rigid-body spin ($\\mathbf{W}=\\mathbf{0}$), the lattice spin equals the negative plastic spin: $\\mathbf{W}^{e} = \\mathbf{W} - \\mathbf{W}^{p} = -\\mathbf{W}^{p}$, and the lattice orientation $\\mathbf{R}$ obeys $\\dot{\\mathbf{R}} = \\mathbf{W}^{e}\\,\\mathbf{R}$.\n\nTasks:\n1) Anisotropic yield locus radii. For a given orientation $\\mathbf{R}$ and a given stress direction tensor $\\mathbf{D}_{\\theta}$ (not a rate, but a stress direction template), define the yield function $\\phi(\\boldsymbol{\\sigma}) = \\max_{s}\\left(\\dfrac{|\\mathbf{s}_{s}^{\\mathsf{T}}\\boldsymbol{\\sigma}\\,\\mathbf{n}_{s}|}{g_{s}}\\right)$. The yield surface is defined by $\\phi(\\boldsymbol{\\sigma})=1$. For a direction $\\mathbf{D}_{\\theta}$, the yield locus radius $A(\\theta)$ is the smallest positive scalar such that $\\phi(A(\\theta)\\mathbf{D}_{\\theta})=1$, which reduces to\n$$\nA(\\theta) = \\dfrac{1}{\\max_{s}\\left(\\dfrac{|\\mathbf{s}_{s}^{\\mathsf{T}}\\mathbf{D}_{\\theta}\\,\\mathbf{n}_{s}|}{g_{s}}\\right)}.\n$$\nUse the following family of plane-stress, deviatoric direction tensors parameterized by an angle $\\theta$ (in radians):\n$$\n\\mathbf{D}_{\\theta} = \\begin{bmatrix} \\cos\\theta & \\sin\\theta & 0 \\\\ \\sin\\theta & -\\cos\\theta & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}.\n$$\nCompute $A(\\theta)$ for $\\theta \\in \\{0, \\tfrac{\\pi}{8}, \\tfrac{\\pi}{4}, \\tfrac{3\\pi}{8}, \\tfrac{\\pi}{2}\\}$ for both slip sets. Quantify the difference between the two yield loci by the average relative absolute difference:\n$$\n\\Delta_{\\mathrm{YL}} = \\dfrac{1}{5}\\sum_{\\theta}\\dfrac{|A_{12}(\\theta) - A_{18}(\\theta)|}{\\dfrac{1}{2}\\left(A_{12}(\\theta) + A_{18}(\\theta)\\right)}.\n$$\nReport $\\Delta_{\\mathrm{YL}}$ as a dimensionless float.\n\n2) Lattice rotation under uniaxial strain. Impose a uniaxial engineering strain path along the laboratory $\\mathbf{e}_{1}$ direction with total engineering strain of $0.01$ reached in $T=1\\,\\mathrm{s}$ by prescribing a constant rate of deformation $\\mathbf{D} = \\mathrm{diag}(0.01,0,0)\\,\\mathrm{s}^{-1}$. Take zero macroscopic spin $\\mathbf{W} = \\mathbf{0}$, and initial Cauchy stress $\\boldsymbol{\\sigma}(t=0)=\\mathbf{0}$. Evolve the stress and the lattice orientation $\\mathbf{R}(t)$ using explicit time stepping with $N=1000$ uniform steps of size $\\Delta t = 0.001\\,\\mathrm{s}$. At each step:\n- Transform the crystal slip directions $\\mathbf{s}_{s}^{c}$ and normals $\\mathbf{n}_{s}^{c}$ from crystal to laboratory frame using the current lattice orientation: $\\mathbf{s}_{s} = \\mathbf{R}\\,\\mathbf{s}_{s}^{c}$ and $\\mathbf{n}_{s} = \\mathbf{R}\\,\\mathbf{n}_{s}^{c}$.\n- Compute $\\dot{\\gamma}_{s}$ from the current $\\boldsymbol{\\sigma}$ and update $\\mathbf{D}^{p}$ and $\\mathbf{W}^{p}$.\n- Update $\\boldsymbol{\\sigma}$ by $\\boldsymbol{\\sigma} \\leftarrow \\boldsymbol{\\sigma} + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}$ with Hooke’s law.\n- Update $\\mathbf{R}$ by $\\mathbf{R} \\leftarrow \\mathrm{qorth}\\left(\\mathbf{R} + \\Delta t\\,\\mathbf{W}^{e}\\mathbf{R}\\right)$, where $\\mathrm{qorth}$ projects to the nearest proper orthonormal matrix (to enforce $\\mathbf{R}\\in\\mathrm{SO}(3)$).\nLet the final lattice rotation angle be the angle of $\\mathbf{R}_{\\mathrm{final}}\\mathbf{R}_{0}^{\\mathsf{T}}$, computed from the principal angle formula $\\theta_{\\mathrm{lat}} = \\arccos\\left(\\dfrac{\\mathrm{tr}(\\mathbf{R}_{\\mathrm{final}}\\mathbf{R}_{0}^{\\mathsf{T}})-1}{2}\\right)$, reported in degrees. Compute $\\theta_{\\mathrm{lat}}$ for both slip sets and report the absolute difference $\\Delta_{\\mathrm{ROT}} = |\\theta_{\\mathrm{lat}}^{(12)} - \\theta_{\\mathrm{lat}}^{(18)}|$ in degrees.\n\nSlip systems and parameters:\n- The primary $12$ systems are the FCC octahedral $\\{111\\}\\langle 110\\rangle$ sets with unit normals and slip directions constructed such that $\\mathbf{s}_{s}^{c}\\perp \\mathbf{n}_{s}^{c}$, with both in crystal coordinates.\n- The extended $18$-system set augments the above with $6$ cube $\\{100\\}\\langle 110\\rangle$ systems, again with unit vectors and $\\mathbf{s}_{s}^{c}\\perp \\mathbf{n}_{s}^{c}$.\n- Material constants: use Young’s modulus $E = 210000\\,\\mathrm{MPa}$, Poisson’s ratio $\\nu = 0.30$.\n- Viscoplastic constants: reference shear rate $\\dot{\\gamma}_{0} = 0.001\\,\\mathrm{s}^{-1}$, rate-sensitivity exponent $n = 20$.\n- Critical resolved shear stress $g_{s}$: for the primary $12$ systems use $g_{\\mathrm{pri}}$; for the added $6$ cube systems use $g_{\\mathrm{sec}}$.\n\nCrystal orientation:\n- Let the initial lattice orientation $\\mathbf{R}_{0}$ be constructed from Z-Y-X Euler angles $(\\psi_{Z},\\psi_{Y},\\psi_{X})$ (in degrees) as $\\mathbf{R}_{0} = \\mathbf{R}_{Z}(\\psi_{Z})\\,\\mathbf{R}_{Y}(\\psi_{Y})\\,\\mathbf{R}_{X}(\\psi_{X})$, where each $\\mathbf{R}_{\\cdot}(\\cdot)$ is the standard right-handed rotation about that axis.\n\nTest suite:\nProvide results for the following three parameter sets, each defining one test case:\n- Case $1$: Euler angles $(35,20,15)$ degrees, $g_{\\mathrm{pri}} = 60\\,\\mathrm{MPa}$, $g_{\\mathrm{sec}} = 40\\,\\mathrm{MPa}$.\n- Case $2$: Euler angles $(20,70,10)$ degrees, $g_{\\mathrm{pri}} = 60\\,\\mathrm{MPa}$, $g_{\\mathrm{sec}} = 58\\,\\mathrm{MPa}$.\n- Case $3$: Euler angles $(60,25,75)$ degrees, $g_{\\mathrm{pri}} = 70\\,\\mathrm{MPa}$, $g_{\\mathrm{sec}} = 45\\,\\mathrm{MPa}$.\n\nAngle units and stress units:\n- All angles in the input are in degrees; the reported lattice rotation difference $\\Delta_{\\mathrm{ROT}}$ must also be in degrees, rounded to six decimal places.\n- All stresses are in megapascals (MPa). The yield locus radii $A(\\theta)$ are in MPa, but the requested anisotropic yield locus difference $\\Delta_{\\mathrm{YL}}$ is dimensionless; report it rounded to six decimal places.\n\nFinal output format:\nYour program should produce a single line of output containing the six results as a comma-separated Python-style list in the following order:\n$[\\Delta_{\\mathrm{YL}}^{(1)}, \\Delta_{\\mathrm{ROT}}^{(1)}, \\Delta_{\\mathrm{YL}}^{(2)}, \\Delta_{\\mathrm{ROT}}^{(2)}, \\Delta_{\\mathrm{YL}}^{(3)}, \\Delta_{\\mathrm{ROT}}^{(3)}]$,\nwith each float rounded to six decimal places. No other text should be printed.",
            "solution": "The problem is validated as scientifically sound, well-posed, and complete. All necessary physical laws, constitutive models, parameters, and numerical procedures are provided. The problem is a standard exercise in computational crystal plasticity. We will proceed with the solution.\n\nThe solution requires implementing a single crystal plasticity model to quantify the sensitivity of material response predictions to the set of active slip systems. The comparison is made between a primary set of $12$ octahedral $\\{111\\}\\langle 110\\rangle$ systems and an extended set of $18$ systems, which includes an additional $6$ cubic $\\{100\\}\\langle 110\\rangle$ systems for a Face-Centered Cubic (FCC) crystal. The analysis consists of two parts for three distinct test cases.\n\nFirst, the slip systems must be defined in the crystal reference frame. A slip system is defined by a pair of unit vectors: the slip plane normal $\\mathbf{n}_{s}^{c}$ and the slip direction $\\mathbf{s}_{s}^{c}$, where $\\mathbf{s}_{s}^{c} \\perp \\mathbf{n}_{s}^{c}$.\n- The $12$ primary octahedral systems are generated by identifying all unique pairs from the $\\{111\\}$ family of normals and $\\langle 110 \\rangle$ family of directions that are mutually orthogonal. For example, for the plane normal $\\mathbf{n}^{c} = \\frac{1}{\\sqrt{3}}[1,1,1]^{\\mathsf{T}}$, three orthogonal slip directions from the $\\langle 110 \\rangle$ family are $\\frac{1}{\\sqrt{2}}[1,-1,0]^{\\mathsf{T}}$, $\\frac{1}{\\sqrt{2}}[0,1,-1]^{\\mathsf{T}}$, and $\\frac{1}{\\sqrt{2}}[-1,0,1]^{\\mathsf{T}}$. Repeating this for the four unique $\\{111\\}$ planes yields $12$ systems.\n- The $6$ secondary cubic systems are generated similarly from $\\{100\\}$ normals and $\\langle 110\\rangle$ directions. For instance, for $\\mathbf{n}^{c} = [1,0,0]^{\\mathsf{T}}$, the two orthogonal slip directions are $\\frac{1}{\\sqrt{2}}[0,1,1]^{\\mathsf{T}}$ and $\\frac{1}{\\sqrt{2}}[0,1,-1]^{\\mathsf{T}}$. Repeating for the three $\\{100\\}$ planes yields $6$ systems.\n\nThe initial orientation of the crystal lattice with respect to the laboratory frame is given by a rotation matrix $\\mathbf{R}_0$, constructed from Z-Y-X Euler angles $(\\psi_Z, \\psi_Y, \\psi_X)$ in degrees: $\\mathbf{R}_0 = \\mathbf{R}_Z(\\psi_Z)\\mathbf{R}_Y(\\psi_Y)\\mathbf{R}_X(\\psi_X)$.\n\n**Part 1: Anisotropic Yield Locus**\n\nThe yield locus represents the boundary of elastic behavior in stress space. For rate-dependent crystal plasticity, it is defined by a constant level of plastic dissipation or, as here, by a critical value of the resolved shear stress. The yield locus radius $A(\\theta)$ in a specific stress direction $\\mathbf{D}_{\\theta}$ is calculated as:\n$$\nA(\\theta) = \\dfrac{1}{\\max_{s}\\left(\\dfrac{|\\mathbf{s}_{s}^{\\mathsf{T}}\\mathbf{D}_{\\theta}\\,\\mathbf{n}_{s}|}{g_{s}}\\right)}\n$$\nwhere $g_s$ is the critical resolved shear stress (CRSS) for slip system $s$. The slip vectors $\\mathbf{s}_s$ and $\\mathbf{n}_s$ are the crystal frame vectors transformed into the laboratory frame using the initial orientation: $\\mathbf{s}_s = \\mathbf{R}_0 \\mathbf{s}_s^c$ and $\\mathbf{n}_s = \\mathbf{R}_0 \\mathbf{n}_s^c$. The stress direction tensor $\\mathbf{D}_{\\theta}$ is given by:\n$$\n\\mathbf{D}_{\\theta} = \\begin{bmatrix} \\cos\\theta & \\sin\\theta & 0 \\\\ \\sin\\theta & -\\cos\\theta & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\n$$\n$A(\\theta)$ is computed for $\\theta \\in \\{0, \\tfrac{\\pi}{8}, \\tfrac{\\pi}{4}, \\tfrac{3\\pi}{8}, \\tfrac{\\pi}{2}\\}$ for both the $12$-system set ($A_{12}$) and the $18$-system set ($A_{18}$). The difference between the two resulting yield loci is quantified by the average relative absolute difference, $\\Delta_{\\mathrm{YL}}$:\n$$\n\\Delta_{\\mathrm{YL}} = \\dfrac{1}{5}\\sum_{\\theta}\\dfrac{|A_{12}(\\theta) - A_{18}(\\theta)|}{\\frac{1}{2}(A_{12}(\\theta) + A_{18}(\\theta))}\n$$\n\n**Part 2: Lattice Rotation under Uniaxial Strain**\n\nThis task involves a numerical time integration of the constitutive equations to simulate the crystal's response to a prescribed deformation path. A constant rate of deformation $\\mathbf{D} = \\mathrm{diag}(0.01, 0, 0)\\,\\mathrm{s}^{-1}$ with zero macroscopic spin $(\\mathbf{W}=\\mathbf{0})$ is applied for a total time of $T=1\\,\\mathrm{s}$. The simulation starts from a stress-free state $\\boldsymbol{\\sigma}(0)=\\mathbf{0}$ with initial orientation $\\mathbf{R}(0)=\\mathbf{R}_0$.\n\nAn explicit forward Euler scheme with $N=1000$ steps of size $\\Delta t = 0.001\\,\\mathrm{s}$ is used to evolve the Cauchy stress $\\boldsymbol{\\sigma}$ and the lattice orientation $\\mathbf{R}$. At each time step $t_i$:\n1.  The current slip systems in the lab frame are obtained: $\\mathbf{s}_{s}(t_i) = \\mathbf{R}(t_i)\\mathbf{s}_{s}^{c}$ and $\\mathbf{n}_{s}(t_i) = \\mathbf{R}(t_i)\\mathbf{n}_{s}^{c}$.\n2.  The resolved shear stress on each system is calculated: $\\tau_{s}(t_i) = \\mathbf{s}_{s}(t_i)^{\\mathsf{T}}\\boldsymbol{\\sigma}(t_i)\\mathbf{n}_{s}(t_i)$.\n3.  The slip rate $\\dot{\\gamma}_s$ is computed using the power-law viscoplastic flow rule: $\\dot{\\gamma}_{s} = \\dot{\\gamma}_{0}\\,\\mathrm{sign}(\\tau_{s})\\left(\\frac{|\\tau_{s}|}{g_{s}}\\right)^{n}$.\n4.  The plastic velocity gradient $\\mathbf{L}^p = \\sum_{s} \\dot{\\gamma}_{s} (\\mathbf{s}_{s} \\otimes \\mathbf{n}_{s})$ is assembled. Its symmetric and skew-symmetric parts yield the plastic rate of deformation $\\mathbf{D}^p$ and the plastic spin $\\mathbf{W}^p$, respectively.\n5.  The stress rate $\\dot{\\boldsymbol{\\sigma}}$ is found using Hooke's law: $\\dot{\\boldsymbol{\\sigma}} = 2\\mu(\\mathbf{D} - \\mathbf{D}^{p}) + \\lambda \\,\\mathrm{tr}(\\mathbf{D} - \\mathbf{D}^{p})\\,\\mathbf{I}$, where $\\mu$ and $\\lambda$ are the Lamé parameters derived from Young's modulus $E$ and Poisson's ratio $\\nu$.\n6.  The lattice spin is $\\mathbf{W}^{e} = \\mathbf{W} - \\mathbf{W}^{p} = -\\mathbf{W}^{p}$.\n7.  The state variables are updated:\n    $$\n    \\boldsymbol{\\sigma}(t_{i+1}) = \\boldsymbol{\\sigma}(t_i) + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}(t_i)\n    $$\n    $$\n    \\mathbf{R}(t_{i+1}) = \\mathrm{qorth}\\left(\\mathbf{R}(t_i) + \\Delta t\\,\\mathbf{W}^{e}(t_i)\\mathbf{R}(t_i)\\right)\n    $$\nThe function $\\mathrm{qorth}(\\mathbf{A})$ finds the nearest proper orthogonal matrix to $\\mathbf{A}$, which is essential to preserve the properties of the rotation matrix $\\mathbf{R}$. This is reliably implemented using Singular Value Decomposition (SVD). If $\\mathbf{A} = \\mathbf{U}\\Sigma\\mathbf{V}^\\mathsf{T}$, the nearest rotation matrix is $\\mathbf{R} = \\mathbf{U} \\mathrm{diag}(1, 1, \\det(\\mathbf{U}\\mathbf{V}^\\mathsf{T})) \\mathbf{V}^\\mathsf{T}$.\n\nAfter $N$ steps, the total rotation of the lattice is captured by the matrix $\\mathbf{R}_{\\mathrm{rel}} = \\mathbf{R}_{\\mathrm{final}}\\mathbf{R}_{0}^{\\mathsf{T}}$. The angle of this rotation, $\\theta_{\\mathrm{lat}}$, is calculated in degrees using the trace formula:\n$$\n\\theta_{\\mathrm{lat}} = \\arccos\\left(\\frac{\\mathrm{tr}(\\mathbf{R}_{\\mathrm{rel}})-1}{2}\\right) \\times \\frac{180}{\\pi}\n$$\nThis procedure is performed for both the $12$-system and $18$-system sets, yielding $\\theta_{\\mathrm{lat}}^{(12)}$ and $\\theta_{\\mathrm{lat}}^{(18)}$. The final metric is the absolute difference $\\Delta_{\\mathrm{ROT}} = |\\theta_{\\mathrm{lat}}^{(12)} - \\theta_{\\mathrm{lat}}^{(18)}|$.\n\nThese calculations are repeated for each of the three test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import svd\n\n# Due to version constraints, matrix_power is not used to ensure compatibility.\n# For numpy<1.9.0, scipy.linalg.expm can be an alternative, but not needed here.\n\ndef get_slip_systems():\n    \"\"\"Generates FCC slip systems.\"\"\"\n    # 12 primary {111}<110> octahedral systems\n    oct_normals = [[1, 1, 1], [1, -1, 1], [-1, 1, 1], [1, 1, -1]]\n    oct_slips = [[1, -1, 0], [1, 0, -1], [0, 1, -1], [1, 1, 0], [1, 0, 1], [0, 1, 1]]\n    \n    systems_12 = []\n    for n in oct_normals:\n        for s in oct_slips:\n            if np.dot(n, s) == 0:\n                n_norm = np.array(n) / np.linalg.norm(n)\n                s_norm = np.array(s) / np.linalg.norm(s)\n                systems_12.append((s_norm, n_norm))\n\n    # 6 secondary {100}<110> cubic systems\n    cube_normals = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]\n    cube_slips = [[0, 1, 1], [0, 1, -1], [1, 0, 1], [1, 0, -1], [1, 1, 0], [1, -1, 0]]\n    \n    systems_6 = []\n    for n in cube_normals:\n        for s in cube_slips:\n            if np.dot(n, s) == 0:\n                n_norm = np.array(n) / np.linalg.norm(n)\n                s_norm = np.array(s) / np.linalg.norm(s)\n                systems_6.append((s_norm, n_norm))\n    \n    return systems_12, systems_6\n\ndef euler_to_rotation_matrix(psi_z, psi_y, psi_x):\n    \"\"\"Computes rotation matrix from Z-Y-X Euler angles (in degrees).\"\"\"\n    psi_z_rad, psi_y_rad, psi_x_rad = np.deg2rad([psi_z, psi_y, psi_x])\n    \n    cos_z, sin_z = np.cos(psi_z_rad), np.sin(psi_z_rad)\n    cos_y, sin_y = np.cos(psi_y_rad), np.sin(psi_y_rad)\n    cos_x, sin_x = np.cos(psi_x_rad), np.sin(psi_x_rad)\n    \n    Rz = np.array([[cos_z, -sin_z, 0], [sin_z, cos_z, 0], [0, 0, 1]])\n    Ry = np.array([[cos_y, 0, sin_y], [0, 1, 0], [-sin_y, 0, cos_y]])\n    Rx = np.array([[1, 0, 0], [0, cos_x, -sin_x], [0, sin_x, cos_x]])\n    \n    return Rz @ Ry @ Rx\n\ndef qorth(A):\n    \"\"\"Projects matrix A to the nearest proper orthogonal matrix in SO(3).\"\"\"\n    U, _, Vh = svd(A)\n    R = U @ Vh\n    if np.linalg.det(R) < 0:\n        U[:, -1] *= -1\n        R = U @ Vh\n    return R\n\ndef solve_case(params):\n    \"\"\"Solves one test case for both metrics.\"\"\"\n    euler_angles, g_pri, g_sec = params\n    \n    # Material and model parameters\n    E = 210000.0  # MPa\n    nu = 0.30\n    gamma0_dot = 0.001  # s^-1\n    n_exp = 20.0\n    mu = E / (2 * (1 + nu))\n    lambda_lame = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n\n    systems_12, systems_6 = get_slip_systems()\n    systems_18 = systems_12 + systems_6\n    \n    g_12 = np.full(12, g_pri)\n    g_18 = np.concatenate([np.full(12, g_pri), np.full(6, g_sec)])\n\n    R0 = euler_to_rotation_matrix(*euler_angles)\n\n    # --- Part 1: Yield Locus Difference ---\n    thetas = [0, np.pi/8, np.pi/4, 3*np.pi/8, np.pi/2]\n    A_12 = []\n    A_18 = []\n\n    for slip_systems, g_s, A_list in [(systems_12, g_12, A_12), (systems_18, g_18, A_18)]:\n        lab_systems = [(R0 @ s_c, R0 @ n_c) for s_c, n_c in slip_systems]\n        for theta in thetas:\n            D_theta = np.array([[np.cos(theta), np.sin(theta), 0],\n                                [np.sin(theta), -np.cos(theta), 0],\n                                [0, 0, 0]])\n            \n            max_val = 0.0\n            for i, (s, n) in enumerate(lab_systems):\n                tau_norm = np.abs(s.T @ D_theta @ n)\n                val = tau_norm / g_s[i]\n                if val > max_val:\n                    max_val = val\n            \n            A_list.append(1.0 / max_val if max_val > 1e-12 else 0)\n\n    delta_yl_sum = 0.0\n    for i in range(len(thetas)):\n        a12, a18 = A_12[i], A_18[i]\n        delta_yl_sum += np.abs(a12 - a18) / (0.5 * (a12 + a18))\n    delta_yl = delta_yl_sum / len(thetas)\n\n    # --- Part 2: Lattice Rotation Difference ---\n    D = np.array([[0.01, 0, 0], [0, 0, 0], [0, 0, 0]])\n    dt = 0.001\n    N_steps = 1000\n    \n    theta_lat_vals = []\n    for slip_systems, g_s in [(systems_12, g_12), (systems_18, g_18)]:\n        sigma = np.zeros((3, 3))\n        R = R0.copy()\n        \n        slip_systems_c = [(s_c, n_c) for s_c, n_c in slip_systems]\n\n        for _ in range(N_steps):\n            lab_systems = [(R @ s_c, R @ n_c) for s_c, n_c in slip_systems_c]\n            \n            Lp = np.zeros((3, 3))\n            for i, (s, n) in enumerate(lab_systems):\n                tau = s.T @ sigma @ n\n                if np.abs(tau) > 1e-12:\n                    gamma_dot = gamma0_dot * np.sign(tau) * (np.abs(tau) / g_s[i])**n_exp\n                    Lp += gamma_dot * np.outer(s, n)\n            \n            Dp = 0.5 * (Lp + Lp.T)\n            Wp = 0.5 * (Lp - Lp.T)\n            \n            D_elastic_rate = D - Dp\n            sigma_dot = (lambda_lame * np.trace(D_elastic_rate)) * np.eye(3) + 2 * mu * D_elastic_rate\n            \n            We = -Wp\n            \n            sigma += sigma_dot * dt\n            R = qorth(R + (We @ R) * dt)\n\n        R_final = R\n        R_rel = R_final @ R0.T\n        \n        trace_val = np.clip((np.trace(R_rel) - 1.0) / 2.0, -1.0, 1.0)\n        theta_lat = np.rad2deg(np.arccos(trace_val))\n        theta_lat_vals.append(theta_lat)\n\n    delta_rot = np.abs(theta_lat_vals[0] - theta_lat_vals[1])\n    \n    return delta_yl, delta_rot\n\ndef solve():\n    test_cases = [\n        ((35, 20, 15), 60.0, 40.0),\n        ((20, 70, 10), 60.0, 58.0),\n        ((60, 25, 75), 70.0, 45.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        delta_yl, delta_rot = solve_case(case)\n        all_results.extend([delta_yl, delta_rot])\n\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n```"
        }
    ]
}