## 引言
在[计算固体力学](@entry_id:169583)领域，精确模拟复杂结构和材料的力学行为至关重要。传统的连续有限元方法（FEM）虽然强大，但在处理复杂几何、[材料界面](@entry_id:751731)和断裂等不连续现象时面临着固有挑战。不连续伽辽金（Discontinuous Galerkin, DG）方法作为一种强大而灵活的替代方案应运而生，它通过允许单元之间的[不连续性](@entry_id:144108)，为解决这些棘手问题开辟了新的道路。

传统方法对网格连续性的严格要求，使得模拟[裂纹扩展](@entry_id:749562)或耦合不同物理域变得异常复杂。[DG方法](@entry_id:748369)打破了这一束缚，以一种数学上严谨且物理上直观的方式，在“破碎”的离散世界中重建物理守恒律。

本文将带领读者深入探索弹性力学中的DG方法。在“原理与机制”一章中，我们将揭示其核心思想，包括如何使用[数值通量](@entry_id:752791)和罚项来连接独立的单元。随后的“应用与跨学科连接”章节将展示DG方法如何应用于断裂力学、[复合材料](@entry_id:139856)、[等几何分析](@entry_id:752839)以及多物理场耦合等前沿领域。最后，“动手实践”部分提供了具体的练习，帮助读者将理论知识转化为实践技能。

通过这次旅程，您将理解DG方法为何不仅仅是一种数值技术，更是一种解决复杂科学与工程问题的强大思维框架。让我们首先深入其内部，探寻其运行的精妙原理与机制。

## 原理与机制

在上一章中，我们领略了不[连续伽辽金方法](@entry_id:747805)（Discontinuous Galerkin, DG）的迷人之处——它仿佛赋予了我们打破常规、自由剖分复杂世界的魔力。现在，让我们像物理学家一样，深入其内部，探寻其运行的精妙原理与机制。这不仅是一趟数学之旅，更是一次关于如何在“破碎”的世界中重建物理法则的探索。

### 打破连续性的枷锁

传统的有限元方法（FEM）建立在一个非常优雅的假设之上：整个物体的位移场是连续的。这意味着，在我们的数学模型中，物体被撕裂成的小单元（单元）在边界上完美地拼接在一起，不允许有任何缝隙或重叠。这种连续性假设使得理论分析简洁明了，但在实践中却像一副“黄金枷锁”。它要求我们使用复杂的[网格生成技术](@entry_id:751906)来处理复杂的几何形状，并且在处理本身就不连续的物理现象（如[裂纹扩展](@entry_id:749562)）时显得力不从心。

不[连续伽辽金方法](@entry_id:747805)（DG）的革命性思想就是：**让我们打破这副枷锁！** 为什么我们不能允许每个单元都是一个独立的“王国”，内部遵循物理定律，而单元之间可以存在“不连续”——即[位移场](@entry_id:141476)在边界上可以有“跳跃”？

这个想法初听起来有些疯狂。物理世界是连续的，我们怎么能用一个不连续的模型来描述它呢？这就像用一堆独立的砖块来砌墙，却不使用砂浆。这些砖块要如何协同工作，共同抵御外力？这里的“砂浆”是什么？这正是DG方法的核心与魅力所在。

### 新的工具箱：迹、跳跃与平均

为了在不连续的世界里建立秩序，我们首先需要一套新的数学语言来描述单元边界上的行为。想象一条一维的杆，我们将其切成两段。在切口处，左边那段的位移可以是 $u^-$，右边那段的位移是 $u^+$。

- **迹 (Trace)**：$u^-$ 和 $u^+$ 就是位移场在切口处的**迹**。它们是从两个不同单元“内部”看向边界所看到的值。

- **跳跃 (Jump)**：位移的**跳跃** $\llbracket u \rrbracket$ 定义为两个迹的差，例如 $\llbracket u \rrbracket = u^+ - u^-$。如果跳跃为零，说明此处是连续的。

- **平均 (Average)**：位移的**平均** $\{u\}$ 定义为两个迹的算术平均值，即 $\{u\} = \frac{1}{2}(u^+ + u^-)$。它代表了边界上一种“折衷”的或“中间”的状态。

对于弹性力学中的向量位移 $\boldsymbol{u}$ 和张量应力 $\boldsymbol{\sigma}$，这些概念可以被自然地推广。例如，在二维或三维空间中，一个内部界面 $F$ 分隔了两个单元 $K^+$ 和 $K^-$。我们定义一个固定的[法向量](@entry_id:264185) $\boldsymbol{n}$，比如说从 $K^+$ 指向 $K^-$。那么，位移的跳跃就是一个向量 $\llbracket \boldsymbol{u} \rrbracket = \boldsymbol{u}^+ - \boldsymbol{u}^-$，而应力的平均则是一个张量 $\{\boldsymbol{\sigma}\} = \frac{1}{2}(\boldsymbol{\sigma}^+ + \boldsymbol{\sigma}^-)$ 。这些简单的定义构成了我们构建[DG方法](@entry_id:748369)的基石。它们是量化“[不连续性](@entry_id:144108)”的标尺。

### 在界面处重构物理：[数值通量](@entry_id:752791)的角色

现在我们有了描述不连续性的工具，但关键问题仍然存在：如何让这些独立的单元协同工作？答案在于物理学的基本守恒律。

让我们回到弹性力学的基本出发点：**动量守恒定律**。它的[微分形式](@entry_id:146747)是 $-\nabla \cdot \boldsymbol{\sigma} = \boldsymbol{f}$，其中 $\boldsymbol{\sigma}$ 是应力张量，$\boldsymbol{f}$ 是体力 。为了得到适用于计算的**[弱形式](@entry_id:142897)**，我们通常将其与一个任意的测试函数 $\boldsymbol{v}$ 做[内积](@entry_id:158127)，并在整个区域上积分。通过[分部积分](@entry_id:136350)（即高维度的[格林公式](@entry_id:173118)），我们会得到：
$$
\int_{\Omega} \boldsymbol{\sigma}(\boldsymbol{u}) : \boldsymbol{\varepsilon}(\boldsymbol{v}) \, dV - \int_{\partial\Omega} (\boldsymbol{\sigma}(\boldsymbol{u})\boldsymbol{n}) \cdot \boldsymbol{v} \, dS = \int_{\Omega} \boldsymbol{f} \cdot \boldsymbol{v} \, dV
$$
这里的 $\boldsymbol{\varepsilon}(\cdot)$ 是[应变张量](@entry_id:193332)，而 $\boldsymbol{\sigma}(\boldsymbol{u})\boldsymbol{n}$ 正是物体表面上的**面力 (traction)**，代表了外界施加的力。

在[DG方法](@entry_id:748369)中，我们对每个独立的单元 $K$ 都执行这个操作。[分部积分](@entry_id:136350)后，每个单元的边界上都会出现面力项 $\int_{\partial K} (\boldsymbol{\sigma}(\boldsymbol{u})\boldsymbol{n}_K) \cdot \boldsymbol{v} \, dS$。对于一个内部界面 $F$，它同时是 $K^+$ 和 $K^-$ 的边界，因此它会贡献两项：一项来自 $K^+$，一项来自 $K^-$。由于我们允许 $\boldsymbol{u}$ 和 $\boldsymbol{v}$ 不连续，这些面力项不再像标准FEM中那样自动抵消。

这正是[DG方法](@entry_id:748369)施展其“魔法”的地方。物理上的面力在界面两侧应该是大小相等、方向相反的（[牛顿第三定律](@entry_id:166652)）。但在我们这个不连续的数学模型中，$\boldsymbol{\sigma}(\boldsymbol{u}^+)\boldsymbol{n}$ 和 $\boldsymbol{\sigma}(\boldsymbol{u}^-)\boldsymbol{n}$ 可能完全不同！我们必须**人为地定义一个“规则”**，来替代真实的物理面力，这个规则就是**[数值通量](@entry_id:752791) (numerical flux)** 。

[数值通量](@entry_id:752791)就像是两个相邻单元之间签订的一份“合同”。这份合同规定了它们之间应如何相互作用，如何传递力。一个好的[数值通量](@entry_id:752791)必须满足一个基本要求：**一致性 (consistency)**。这意味着，如果我们把一个真正的、光滑的解代入到我们的DG公式中，这个[数值通量](@entry_id:752791)必须自动变回那个界面上真实的物理面力。这保证了我们的方法在求解“正确”的问题。

### 设计一份好“合同”：[内部罚方法](@entry_id:177497)

在众多设计数值通量的方案中，**[内部罚方法](@entry_id:177497) (Interior Penalty method)** 是最经典和最受欢迎的一种。特别是**[对称内部罚](@entry_id:755719)伽辽金方法 (Symmetric Interior Penalty Galerkin, SIPG)**，它的设计思想充满了物理直觉。

[SIPG方法](@entry_id:754927)在每个内部界面 $F$ 上引入的“合同条款”主要有两部分  ：

1.  **对称的耦合项**：这部分模仿了[牛顿第三定律](@entry_id:166652)。它规定，作用在测试函数跳跃 $\llbracket \boldsymbol{v} \rrbracket$ 上的“力”，是[应力张量](@entry_id:148973)的**平均值** $\{\boldsymbol{\sigma}(\boldsymbol{u})\}$ 产生的面力。同时，为了保证数学上的对称性（这会带来计算上的巨大好处，比如对称的[刚度矩阵](@entry_id:178659)），它也包含了反过来的一项：作用在[试探函数](@entry_id:756165)跳跃 $\llbracket \boldsymbol{u} \rrbracket$ 上的力，是来自测试函数的应力平均值 $\{\boldsymbol{\sigma}(\boldsymbol{v})\}$ 产生的面力。写成公式，就是：
    $$
    -\int_F \left( \{\boldsymbol{\sigma}(\boldsymbol{u})\boldsymbol{n}\} \cdot \llbracket \boldsymbol{v} \rrbracket + \{\boldsymbol{\sigma}(\boldsymbol{v})\boldsymbol{n}\} \cdot \llbracket \boldsymbol{u} \rrbracket \right) \, dS
    $$
    这种对称的结构优雅地处理了不连续场之间的相互作用。

2.  **“惩罚”项**：这是[SIPG方法](@entry_id:754927)名字的由来，也是其稳定性的关键。我们不希望相邻的单元完全“脱节”，我们希望它们的位移跳跃 $\llbracket \boldsymbol{u} \rrbracket$ 尽可能小。怎么办呢？SIPG的方法非常直接：**施加惩罚！** 它在界面上增加了一个正比于位移跳跃平方的能量项：
    $$
    +\int_F \eta_F \llbracket \boldsymbol{u} \rrbracket \cdot \llbracket \boldsymbol{v} \rrbracket \, dS
    $$
    这可以被想象成在相邻单元的界面之间加入了许多微小的“弹簧”。如果两个单元试图分离或错动（即 $\llbracket \boldsymbol{u} \rrbracket \neq \boldsymbol{0}$），这些弹簧就会产生一个恢复力，将它们“拉”回来。参数 $\eta_F$ 就是“弹簧刚度”，我们称之为**罚参数 (penalty parameter)**。

这个罚参数 $\eta_F$ 必须小心选择。如果太小，弹簧太软，就不足以约束不连续性，计算可能不稳定。如果太大，弹簧太硬，就会过度惩罚任何跳跃，使DG方法退化成一种行为不良的连续方法。理论分析告诉我们，罚参数的“最佳”选择与材料的刚度（如[剪切模量](@entry_id:167228) $\mu$）、单元的尺寸 $h$ 以及我们选用的多项式次数 $p$ 都有关系。一个典型的缩放关系是 $\eta_F \propto \mu \frac{p^2}{h}$ 。这很直观：材料越硬、单元越小、或者我们试图用更高阶的函数去拟合解，我们就需要更强的“弹簧”来维持稳定。

当然，SIPG并非唯一的选择。通过调整耦合项的符号或舍弃其中一项，我们可以得到**非对称(NIPG)**或**不完全(IIPG)**的[内部罚方法](@entry_id:177497)，它们在对称性和计算简便性之间做出了不同的权衡 。这揭示了DG世界的一个迷人特征：它不是一种单一的方法，而是一个充满设计可能性的广阔框架。

### 框架之美：优雅地解决难题

付出了这么多努力来构建这个看似复杂的框架，我们得到了什么回报呢？回报是巨大的。这个框架不仅灵活，而且在根本上与物理学结合得非常深刻，使它能优雅地处理一些传统方法难以应对的挑战。

#### [角动量守恒](@entry_id:156798)的自然体现

在连续介质力学中，一个基本结论是：在没有体力矩的情况下，角动量守恒要求应力张量 $\boldsymbol{\sigma}$ 必须是对称的。这个对称性进一步导致了应变能只与[位移梯度](@entry_id:165352)的对称部分——即**应变张量** $\boldsymbol{\varepsilon}(\boldsymbol{u}) = \frac{1}{2}(\nabla \boldsymbol{u} + (\nabla \boldsymbol{u})^{\top})$——有关 。这意味着，一个纯粹的[刚体转动](@entry_id:191086)（其[位移梯度](@entry_id:165352)是反对称的）不会产生任何应变，因而不会产生内能。

DG方法完美地继承了这一点。在每个单元的积分中，我们计算的是 $\boldsymbol{\sigma}(\boldsymbol{u}) : \boldsymbol{\varepsilon}(\boldsymbol{v})$。由于[刚体转动](@entry_id:191086)时 $\boldsymbol{\varepsilon}(\boldsymbol{v}) = \boldsymbol{0}$，所以单元内部不会产生任何[虚功](@entry_id:176403)。而在界面上，由于[刚体转动](@entry_id:191086)是连续的，位移的跳跃 $\llbracket \boldsymbol{v} \rrbracket$ 为零，因此所有与跳跃相关的界面项也都为零。最终，[DG方法](@entry_id:748369)天生就能精确地满足[角动量守恒](@entry_id:156798)，不会因为离散化而产生虚假的内部力矩 。这是其物理一致性的深刻体现。

#### 驯服“[体积锁定](@entry_id:172606)”

在工程实践中，我们经常遇到**[近不可压缩材料](@entry_id:752388)**，如橡胶或某些生物组织。它们的体积几乎不可改变，这在数学上对应于拉梅参数 $\lambda \to \infty$。对于传统的、基于位移的有限元方法，这是一个噩梦。数值解会变得异常“僵硬”，完全无法捕捉真实的变形，这种现象被称为**[体积锁定](@entry_id:172606) (volumetric locking)**。

DG方法为解决这个问题提供了强有力的工具。锁定的根源在于，离散的位移场很难精确满足“体积不变”（即 $\nabla \cdot \boldsymbol{u} = 0$）这一严苛的约束。DG方法的灵活性在于，我们可以**区别对待**变形的不同模式。通过巧妙地设计罚参数，我们可以对导致体积变化的法向跳跃和只改变形状的切向跳跃施加不同大小的“惩罚”。例如，我们可以让法向跳跃的罚参数与 $\lambda$ 相关，而切向跳跃的罚参数只与 $\mu$ 相关 。这样，我们既能强力约束体积变化，又不会过度限制[剪切变形](@entry_id:170920)，从而有效地避免了[体积锁定](@entry_id:172606) 。

更进一步，我们甚至可以在DG框架内引入一个独立的压力变量，构建一个所谓的**混合DG方法**，从根本上将位移和压力解耦，彻底消除锁定。

### 地平线上的远方：更高级的DG方法

[DG方法](@entry_id:748369)的思想还在不断演进。一个激动人心的发展是**可杂交不[连续伽辽金方法](@entry_id:747805) (Hybridizable DG, HDG)**。HDG的妙处在于，它引入了一个只定义在所有单元边界上的新未知量——“杂交”位移 $\hat{\boldsymbol{u}}_h$。然后，每个单元内部的求解可以完全独立地进行，它们只通过这个边界未知量与外界沟通。最后，我们通过求解一个只涉及边界未知量的、规模小得多的全局[方程组](@entry_id:193238)，来“缝合”整个系统 。这种方法极大地减少了全局耦合的自由度数量，非常适合[大规模并行计算](@entry_id:268183)，代表了[DG方法](@entry_id:748369)发展的前沿方向。

### 混乱中的信心：误差估计与自适应

面对一个由不连续碎片构成的解，我们如何能相信它的准确性？DG方法对此也给出了优雅的答案。

理论分析（即**[先验误差估计](@entry_id:170366)**）可以为我们提供保证：只要真实解足够光滑，随着网格的加密，DG解将以可预测的速率收敛到真实解。对于$p$次多项式，能量误差通常以 $h^p$ 的速率减小，而 $L^2$ 误差甚至可以达到更快的 $h^{p+1}$ 。

更具实用价值的是**[后验误差估计](@entry_id:167288)**。在得到一个DG解之后，我们可以检查那些我们允许存在的“跳跃”。直观上，如果某个地方的位移或面力跳跃特别大，那很可能意味着真实解在该区域变化剧烈，而我们当前的网格分辨率不足。这些跳跃值因此成为了天然的**[误差指示子](@entry_id:173250)**。我们可以利用这些信息，自动地、有针对性地加密那些误差大的区域，而保持误差小区域的网格不变。这个过程被称为**[自适应网格细化](@entry_id:143852)**。它使得DG方法像一位聪明的艺术家，总能将最多的笔墨（计算资源）用在最需要精雕细琢的地方。

综上所述，不[连续伽辽金方法](@entry_id:747805)通过一套精巧的机制，在“破碎”的离散世界中重建了物理法则。它用精心设计的“数值通量”取代了单元间的物理联系，用“惩罚”项来温柔地约束[不连续性](@entry_id:144108)。这种看似复杂的构造，换来的是无与伦比的灵活性、深刻的物理一致性以及解决棘手问题的强大能力，使其成为现代计算科学与工程中一门充满活力与前景的艺术。