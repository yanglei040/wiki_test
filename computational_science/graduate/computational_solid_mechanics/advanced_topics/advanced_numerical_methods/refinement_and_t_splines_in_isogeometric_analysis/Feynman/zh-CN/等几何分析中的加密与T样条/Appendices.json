{
    "hands_on_practices": [
        {
            "introduction": "在等几何分析（IGA）中，刚度矩阵的组装等核心计算步骤均依赖于基函数的精确求导。本练习旨在通过从基本原理出发，推导非均匀有理B样条（NURBS）基函数的导数，从而加深您对IGA计算核心的理解。通过应用Cox-de Boor递推公式和有理函数的商法则，您将能够掌握将抽象数学定义转化为具体计算实现的关键技能，为后续更复杂的分析奠定坚实基础。",
            "id": "3594419",
            "problem": "在计算固体力学的等几何分析（IGA）背景下，考虑一条定义在参数 $u \\in [0,1]$ 上的单变量非均匀有理B样条（NURBS）曲线，其开节点矢量为 $\\Xi = [0,0,0,1,1,1]$，多项式次数为 $p=2$。相关的B样条基函数 $N_{i,2}(u)$, $i \\in \\{1,2,3\\}$，由 Cox–de Boor 递归公式从分段常数函数和给定的节点矢量递归定义。NURBS 基函数定义为\n$$\nR_i(u) = \\frac{w_i N_{i,2}(u)}{\\sum_{j=1}^{3} w_j N_{j,2}(u)},\n$$\n其中 $w_i$ 是正权重。此类有理基在T样条中经过局部加密简化为单个张量积单元后，也作为局部混合函数出现，并且其导数在刚度矩阵组装中是必需的。\n\n任务：\n1) 从 Cox–de Boor 递归公式和给定的节点矢量出发，推导二次B样条基函数 $N_{i,2}(u)$ 及其一阶导数 $\\partial_u N_{i,2}(u)$ 在 $u \\in (0,1)$ 上的显式表达式。\n2) 仅使用应用于上述 $R_i(u)$ 定义的商法则（且不使用任何预先记忆的NURBS导数公式），推导 $\\partial_u R_i(u)$ 关于 $N_{i,2}(u)$、$\\partial_u N_{i,2}(u)$ 和权重 $\\{w_i\\}_{i=1}^{3}$ 的通用表达式。\n3) 对于权重 $w = [1,2,1]$，计算三个一阶导数 $\\partial_u R_i(u)$ 在 $u = \\tfrac{1}{2}$ 处的值。\n\n答案规格：\n- 以包含三个值 $\\partial_u R_1(\\tfrac{1}{2})$、$\\partial_u R_2(\\tfrac{1}{2})$、$\\partial_u R_3(\\tfrac{1}{2})$ 的单个 $1 \\times 3$ 行矩阵的形式报告你的最终答案，并使用精确形式。\n- 不包括单位，不要四舍五入；提供精确的有理数。",
            "solution": "我们从基本原理出发。B样条基函数 $N_{i,p}(u)$ 由 Cox–de Boor 递归公式定义。对于 $p=0$，\n$$\nN_{i,0}(u) =\n\\begin{cases}\n1,  \\xi_i \\le u  \\xi_{i+1}, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n其中开节点矢量为 $\\Xi = [\\xi_1,\\ldots,\\xi_6] = [0,0,0,1,1,1]$。对于更高的次数 $p \\ge 1$，\n$$\nN_{i,p}(u) = \\frac{u - \\xi_i}{\\xi_{i+p} - \\xi_i} N_{i,p-1}(u) + \\frac{\\xi_{i+p+1} - u}{\\xi_{i+p+1} - \\xi_{i+1}} N_{i+1,p-1}(u),\n$$\n并约定分母为零的项被解释为零。\n\n步骤1：确定 $N_{i,2}(u)$ 在 $u \\in (0,1)$ 上的表达式。\n- 对于 $p=0$ 和给定的 $\\Xi$，唯一的非退化区间是 $[\\xi_3,\\xi_4) = [0,1)$，因此在 $u \\in [0,1)$ 上有 $N_{3,0}(u) = 1$，而在 $u \\in (0,1)$ 上有 $N_{1,0}(u) = N_{2,0}(u) = 0$。\n- 对于 $p=1$，使用递归公式：\n  - 对于 $i=2$，\n  $$\n  N_{2,1}(u) = \\frac{u - \\xi_2}{\\xi_{2+1} - \\xi_2} N_{2,0}(u) + \\frac{\\xi_{2+2} - u}{\\xi_{2+2} - \\xi_{2+1}} N_{3,0}(u)\n  = \\frac{u - 0}{0 - 0} \\cdot 0 + \\frac{1 - u}{1 - 0} \\cdot 1 = 1 - u.\n  $$\n  - 对于 $i=3$，\n  $$\n  N_{3,1}(u) = \\frac{u - \\xi_3}{\\xi_{3+1} - \\xi_3} N_{3,0}(u) + \\frac{\\xi_{3+2} - u}{\\xi_{3+2} - \\xi_{3+1}} N_{4,0}(u)\n  = \\frac{u - 0}{1 - 0} \\cdot 1 + \\frac{1 - u}{1 - 1} \\cdot 0 = u.\n  $$\n  所有其他的 $N_{i,1}(u)$ 在 $u \\in (0,1)$ 上都为零。\n- 对于 $p=2$：\n  - 对于 $i=1$，\n  $$\n  N_{1,2}(u) = \\frac{u - \\xi_1}{\\xi_{1+2} - \\xi_1} N_{1,1}(u) + \\frac{\\xi_{1+2+1} - u}{\\xi_{1+2+1} - \\xi_{1+1}} N_{2,1}(u)\n  = 0 + \\frac{1 - u}{1 - 0} (1 - u) = (1 - u)^{2}.\n  $$\n  - 对于 $i=2$，\n  $$\n  N_{2,2}(u) = \\frac{u - \\xi_2}{\\xi_{2+2} - \\xi_2} N_{2,1}(u) + \\frac{\\xi_{2+2+1} - u}{\\xi_{2+2+1} - \\xi_{2+1}} N_{3,1}(u)\n  = \\frac{u - 0}{1 - 0} (1 - u) + \\frac{1 - u}{1 - 0} u = 2u(1 - u).\n  $$\n  - 对于 $i=3$，\n  $$\n  N_{3,2}(u) = \\frac{u - \\xi_3}{\\xi_{3+2} - \\xi_3} N_{3,1}(u) + \\frac{\\xi_{3+2+1} - u}{\\xi_{3+2+1} - \\xi_{3+1}} N_{4,1}(u)\n  = \\frac{u - 0}{1 - 0} u + 0 = u^{2}.\n  $$\n因此，在 $u \\in (0,1)$ 上，\n$$\nN_{1,2}(u) = (1 - u)^{2}, \\quad N_{2,2}(u) = 2u(1 - u), \\quad N_{3,2}(u) = u^{2}.\n$$\n它们的一阶导数是\n$$\n\\partial_u N_{1,2}(u) = -2(1 - u) = 2(u - 1), \\quad \\partial_u N_{2,2}(u) = 2(1 - 2u), \\quad \\partial_u N_{3,2}(u) = 2u.\n$$\n\n步骤2：通过商法则推导 $\\partial_u R_i(u)$。\n根据定义，\n$$\nR_i(u) = \\frac{w_i N_{i,2}(u)}{\\sum_{j=1}^{3} w_j N_{j,2}(u)}.\n$$\n定义分母（NURBS 权重函数）\n$$\nW(u) = \\sum_{j=1}^{3} w_j N_{j,2}(u),\n$$\n及其导数\n$$\n\\partial_u W(u) = \\sum_{j=1}^{3} w_j \\partial_u N_{j,2}(u).\n$$\n对 $R_i(u) = \\frac{w_i N_{i,2}(u)}{W(u)}$ 应用商法则，得出\n$$\n\\partial_u R_i(u) = \\frac{w_i \\partial_u N_{i,2}(u) \\, W(u) - w_i N_{i,2}(u) \\, \\partial_u W(u)}{[W(u)]^{2}}.\n$$\n\n步骤3：在 $u = \\tfrac{1}{2}$ 处，当 $w = [1,2,1]$ 时进行求值。\n首先计算基函数的值和导数在 $u = \\tfrac{1}{2}$ 处的值：\n$$\nN_{1,2}\\!\\left(\\tfrac{1}{2}\\right) = \\left(1 - \\tfrac{1}{2}\\right)^{2} = \\tfrac{1}{4}, \\quad\nN_{2,2}\\!\\left(\\tfrac{1}{2}\\right) = 2 \\cdot \\tfrac{1}{2} \\cdot \\left(1 - \\tfrac{1}{2}\\right) = \\tfrac{1}{2}, \\quad\nN_{3,2}\\!\\left(\\tfrac{1}{2}\\right) = \\left(\\tfrac{1}{2}\\right)^{2} = \\tfrac{1}{4}.\n$$\n$$\n\\partial_u N_{1,2}\\!\\left(\\tfrac{1}{2}\\right) = 2\\left(\\tfrac{1}{2} - 1\\right) = -1, \\quad\n\\partial_u N_{2,2}\\!\\left(\\tfrac{1}{2}\\right) = 2\\left(1 - 2 \\cdot \\tfrac{1}{2}\\right) = 0, \\quad\n\\partial_u N_{3,2}\\!\\left(\\tfrac{1}{2}\\right) = 2 \\cdot \\tfrac{1}{2} = 1.\n$$\n当 $w_1 = 1$, $w_2 = 2$, $w_3 = 1$ 时，\n$$\nW\\!\\left(\\tfrac{1}{2}\\right) = 1 \\cdot \\tfrac{1}{4} + 2 \\cdot \\tfrac{1}{2} + 1 \\cdot \\tfrac{1}{4} = \\tfrac{1}{4} + 1 + \\tfrac{1}{4} = \\tfrac{3}{2},\n$$\n并且\n$$\n\\partial_u W\\!\\left(\\tfrac{1}{2}\\right) = 1 \\cdot (-1) + 2 \\cdot 0 + 1 \\cdot 1 = 0.\n$$\n因此，对于每个 $i \\in \\{1,2,3\\}$，\n$$\n\\partial_u R_i\\!\\left(\\tfrac{1}{2}\\right) = \\frac{w_i \\, \\partial_u N_{i,2}\\!\\left(\\tfrac{1}{2}\\right) \\, W\\!\\left(\\tfrac{1}{2}\\right) - w_i \\, N_{i,2}\\!\\left(\\tfrac{1}{2}\\right) \\, \\partial_u W\\!\\left(\\tfrac{1}{2}\\right)}{\\left[W\\!\\left(\\tfrac{1}{2}\\right)\\right]^{2}}\n= \\frac{w_i \\, \\partial_u N_{i,2}\\!\\left(\\tfrac{1}{2}\\right) \\, \\tfrac{3}{2}}{\\left(\\tfrac{3}{2}\\right)^{2}}\n= \\frac{2}{3} \\, w_i \\, \\partial_u N_{i,2}\\!\\left(\\tfrac{1}{2}\\right).\n$$\n因此，\n$$\n\\partial_u R_1\\!\\left(\\tfrac{1}{2}\\right) = \\frac{2}{3} \\cdot 1 \\cdot (-1) = -\\frac{2}{3}, \\quad\n\\partial_u R_2\\!\\left(\\tfrac{1}{2}\\right) = \\frac{2}{3} \\cdot 2 \\cdot 0 = 0, \\quad\n\\partial_u R_3\\!\\left(\\tfrac{1}{2}\\right) = \\frac{2}{3} \\cdot 1 \\cdot 1 = \\frac{2}{3}.\n$$\n将这三个值收集到一个 $1 \\times 3$ 的行矩阵中，得到所要求的精确有理数形式的最终结果。",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{2}{3}   0   \\frac{2}{3}\\end{pmatrix}}$$"
        },
        {
            "introduction": "网格细化是有限元方法中提高计算精度的关键技术，而在等几何分析中，这通常通过节点插入来实现。本练习将引导您探索经典的Boehm算法，揭示如何通过构造新控制点作为旧控制点的凸组合来实现保持几何不变的细化。通过逐步构建全局细化矩阵，您将具体理解IGA中的`h`-细化是如何运作的，并验证其为何能保持单位分解性等重要性质，这对保证数值格式的稳定性至关重要。",
            "id": "3594387",
            "problem": "考虑一条用于计算固体力学的等几何分析（IGA）中的次数为 $p=2$ 的单变量开放非均匀有理B样条（NURBS）曲线，其初始开放节点矢量为 $\\Xi^{(0)} = [0,0,0, \\tfrac{1}{2}, 1,1,1]$，对应的控制向量为 $\\mathbf{C}^{(0)} \\in \\mathbb{R}^{4}$。在 $\\xi=\\tfrac{1}{4}$ 和 $\\xi=\\tfrac{3}{4}$ 处依次插入两个重数为1的节点，生成加细后的节点矢量 $\\Xi^{(2)} = [0,0,0, \\tfrac{1}{4}, \\tfrac{1}{2}, \\tfrac{3}{4}, 1,1,1]$ 和加细后的控制向量 $\\mathbf{C}^{(2)} \\in \\mathbb{R}^{6}$。令 $\\mathbf{T} \\in \\mathbb{R}^{6 \\times 4}$ 表示全局加细矩阵，使得 $\\mathbf{C}^{(2)} = \\mathbf{T}\\,\\mathbf{C}^{(0)}$，该矩阵在加细过程中保持几何形状不变。\n\n从B样条基函数的 Cox–de Boor 递归定义和节点插入下的曲线不变性原理出发，推导在每个单节点插入步骤中更新控制点的局部凸组合关系。使用这些关系显式地构造两个连续的局部加细算子，其映射关系为 $\\mathbf{C}^{(0)} \\mapsto \\mathbf{C}^{(1)}$（插入 $\\xi=\\tfrac{1}{4}$ 后）和 $\\mathbf{C}^{(1)} \\mapsto \\mathbf{C}^{(2)}$（插入 $\\xi=\\tfrac{3}{4}$ 后），并将全局加细矩阵 $\\mathbf{T}$ 构造为它们的乘积。\n\n然后，从第一性原理验证 $\\mathbf{T}$ 的每个元素都是非负的，且 $\\mathbf{T}$ 的每行之和为1，从而证明控制多边形的凸性保持性质以及加细后基函数的单位分解性继承。最后，计算标量\n$$\nS \\;=\\; \\sum_{i=1}^{6} \\sum_{j=1}^{4} T_{ij}.\n$$\n将 $S$ 报告为一个不带单位的实数。无需四舍五入。",
            "solution": "该问题要求在顺序节点插入下，构造并分析B样条曲线的加细矩阵。我们将按要求从第一性原理出发进行推导。问题提到了非均匀有理B样条（NURBS），但提供了一个 $\\mathbb{R}^4$ 中的控制向量，这对应于四个标量控制点。此设置描述了一个B样条函数，它是所有权重都为1的NURBS曲线的特例。标准的节点插入算法（Boehm算法）在此情况下直接适用于控制点。\n\n一个次数为 $p$ 的B样条曲线由一组控制点 $\\mathbf{P}_i$ 和一个节点矢量 $\\Xi$ 定义。如果在节点插入过程中，控制点根据特定的局部凸组合规则进行更新，则曲线的几何形状保证不变。设初始曲线为 $\\mathbf{C}(\\xi) = \\sum_{i=1}^{n} N_{i,p}(\\xi) \\mathbf{P}_i$，其节点矢量为 $\\Xi = \\{\\xi_1, \\dots, \\xi_{n+p+1}\\}$。当插入一个新节点 $\\bar{\\xi}$，使得 $\\xi_k \\le \\bar{\\xi}  \\xi_{k+1}$ 时，会生成一组新的 $n+1$ 个控制点 $\\bar{\\mathbf{P}}_i$ 和一个新的节点矢量 $\\bar{\\Xi}$。曲线不变性原理与B样条基函数的 Cox-de Boor 递归相结合，得出以下控制点更新规则，即 Boehm 算法：\n$$\n\\bar{\\mathbf{P}}_i = \\begin{cases}\n\\mathbf{P}_i  \\text{for } 1 \\le i \\le k-p \\\\\n(1 - \\alpha_i) \\mathbf{P}_{i-1} + \\alpha_i \\mathbf{P}_i  \\text{for } k-p+1 \\le i \\le k \\\\\n\\mathbf{P}_{i-1}  \\text{for } k+1 \\le i \\le n+1\n\\end{cases}\n$$\n其中系数 $\\alpha_i$ 由下式给出：\n$$\n\\alpha_i = \\frac{\\bar{\\xi} - \\xi_i}{\\xi_{i+p} - \\xi_i}\n$$\n这些公式定义了局部凸组合关系。对于 $k-p+1 \\le i \\le k$，新的控制点 $\\bar{\\mathbf{P}}_i$ 是两个相邻旧控制点 $\\mathbf{P}_{i-1}$ 和 $\\mathbf{P}_i$ 的凸组合，因为对于在开区间 $(\\xi_k, \\xi_{k+1})$ 内以重数1插入的节点 $\\bar{\\xi}$，有 $0  \\alpha_i  1$。\n\n我们现在将此过程应用于指定的两个节点插入。\n\n**步骤1：在 $\\xi = \\frac{1}{4}$ 处进行第一次节点插入**\n初始设置为一个次数 $p=2$ 的曲线，有 $n^{(0)}=4$ 个控制点 $\\mathbf{C}^{(0)} = [\\mathbf{P}_1^{(0)}, \\mathbf{P}_2^{(0)}, \\mathbf{P}_3^{(0)}, \\mathbf{P}_4^{(0)}]^T$ 和节点矢量 $\\Xi^{(0)} = [\\xi_1, \\dots, \\xi_7] = [0,0,0, \\frac{1}{2}, 1,1,1]$。我们插入节点 $\\bar{\\xi} = \\frac{1}{4}$。我们必须找到一个索引 $k$，使得 $\\xi_k \\le \\bar{\\xi}  \\xi_{k+1}$。从 $\\Xi^{(0)}$ 中，我们看到 $\\xi_3=0 \\le \\frac{1}{4}  \\frac{1}{2} = \\xi_4$，所以 $k=3$。\n\n新的控制点集合将有 $n^{(1)}=4+1=5$ 个控制点，记作 $\\mathbf{C}^{(1)} = [\\mathbf{P}_1^{(1)}, \\dots, \\mathbf{P}_5^{(1)}]^T$。旧控制点受影响的索引范围为 $[k-p, k] = [3-2, 3] = [1, 3]$。更新规则如下生成新的控制点：\n- 对于 $i \\le k-p = 1$：$\\mathbf{P}_1^{(1)} = \\mathbf{P}_1^{(0)}$。\n- 对于 $i \\in [k-p+1, k] = [2, 3]$：\n  - 对于 $i=2$：$\\alpha_2 = \\frac{\\bar{\\xi} - \\xi_2}{\\xi_{2+p} - \\xi_2} = \\frac{\\frac{1}{4} - \\xi_2}{\\xi_4 - \\xi_2} = \\frac{\\frac{1}{4} - 0}{\\frac{1}{2} - 0} = \\frac{1}{2}$。\n    $\\mathbf{P}_2^{(1)} = (1-\\alpha_2)\\mathbf{P}_1^{(0)} + \\alpha_2 \\mathbf{P}_2^{(0)} = \\frac{1}{2}\\mathbf{P}_1^{(0)} + \\frac{1}{2}\\mathbf{P}_2^{(0)}$。\n  - 对于 $i=3$：$\\alpha_3 = \\frac{\\bar{\\xi} - \\xi_3}{\\xi_{3+p} - \\xi_3} = \\frac{\\frac{1}{4} - \\xi_3}{\\xi_5 - \\xi_3} = \\frac{\\frac{1}{4} - 0}{1 - 0} = \\frac{1}{4}$。\n    $\\mathbf{P}_3^{(1)} = (1-\\alpha_3)\\mathbf{P}_2^{(0)} + \\alpha_3 \\mathbf{P}_3^{(0)} = \\frac{3}{4}\\mathbf{P}_2^{(0)} + \\frac{1}{4}\\mathbf{P}_3^{(0)}$。\n- 对于 $i \\ge k+1 = 4$：\n  - 对于 $i=4$：$\\mathbf{P}_4^{(1)} = \\mathbf{P}_{4-1}^{(0)} = \\mathbf{P}_3^{(0)}$。\n  - 对于 $i=5$：$\\mathbf{P}_5^{(1)} = \\mathbf{P}_{5-1}^{(0)} = \\mathbf{P}_4^{(0)}$。\n\n关系 $\\mathbf{C}^{(1)} = \\mathbf{T}^{(1)} \\mathbf{C}^{(0)}$ 由 $5 \\times 4$ 的局部加细矩阵 $\\mathbf{T}^{(1)}$ 描述：\n$$\n\\mathbf{T}^{(1)} = \\begin{pmatrix}\n1  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0 \\\\\n0  \\frac{3}{4}  \\frac{1}{4}  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n新的节点矢量为 $\\Xi^{(1)} = [0,0,0, \\frac{1}{4}, \\frac{1}{2}, 1,1,1]$。\n\n**步骤2：在 $\\xi = \\frac{3}{4}$ 处进行第二次节点插入**\n我们现在对由 $n^{(1)}=5$ 个控制点 $\\mathbf{C}^{(1)}$ 和节点矢量 $\\Xi^{(1)}$ 定义的曲线进行加细。设 $\\Xi^{(1)}$ 中的节点为 $\\eta_i$。我们有 $\\Xi^{(1)} = [\\eta_1, \\dots, \\eta_8] = [0,0,0, \\frac{1}{4}, \\frac{1}{2}, 1,1,1]$。我们插入节点 $\\bar{\\xi} = \\frac{3}{4}$。我们找到 $k$ 使得 $\\eta_k \\le \\bar{\\xi}  \\eta_{k+1}$。从 $\\Xi^{(1)}$ 中，我们看到 $\\eta_5 = \\frac{1}{2} \\le \\frac{3}{4}  1 = \\eta_6$，所以 $k=5$。\n\n新的控制点集合将有 $n^{(2)}=5+1=6$ 个控制点，$\\mathbf{C}^{(2)} = [\\mathbf{P}_1^{(2)}, \\dots, \\mathbf{P}_6^{(2)}]^T$。更新规则如下：\n- 对于 $i \\le k-p = 3$：$\\mathbf{P}_1^{(2)} = \\mathbf{P}_1^{(1)}$，$\\mathbf{P}_2^{(2)} = \\mathbf{P}_2^{(1)}$，$\\mathbf{P}_3^{(2)} = \\mathbf{P}_3^{(1)}$。\n- 对于 $i \\in [k-p+1, k] = [4, 5]$：\n  - 对于 $i=4$：$\\alpha_4 = \\frac{\\bar{\\xi} - \\eta_4}{\\eta_{4+p} - \\eta_4} = \\frac{\\frac{3}{4} - \\eta_4}{\\eta_6 - \\eta_4} = \\frac{\\frac{3}{4} - \\frac{1}{4}}{1 - \\frac{1}{4}} = \\frac{\\frac{1}{2}}{\\frac{3}{4}} = \\frac{2}{3}$。\n    $\\mathbf{P}_4^{(2)} = (1-\\alpha_4)\\mathbf{P}_3^{(1)} + \\alpha_4 \\mathbf{P}_4^{(1)} = \\frac{1}{3}\\mathbf{P}_3^{(1)} + \\frac{2}{3}\\mathbf{P}_4^{(1)}$。\n  - 对于 $i=5$：$\\alpha_5 = \\frac{\\bar{\\xi} - \\eta_5}{\\eta_{5+p} - \\eta_5} = \\frac{\\frac{3}{4} - \\eta_5}{\\eta_7 - \\eta_5} = \\frac{\\frac{3}{4} - \\frac{1}{2}}{1 - \\frac{1}{2}} = \\frac{\\frac{1}{4}}{\\frac{1}{2}} = \\frac{1}{2}$。\n    $\\mathbf{P}_5^{(2)} = (1-\\alpha_5)\\mathbf{P}_4^{(1)} + \\alpha_5 \\mathbf{P}_5^{(1)} = \\frac{1}{2}\\mathbf{P}_4^{(1)} + \\frac{1}{2}\\mathbf{P}_5^{(1)}$。\n- 对于 $i \\ge k+1 = 6$：\n  - 对于 $i=6$：$\\mathbf{P}_6^{(2)} = \\mathbf{P}_{6-1}^{(1)} = \\mathbf{P}_5^{(1)}$。\n\n关系 $\\mathbf{C}^{(2)} = \\mathbf{T}^{(2)} \\mathbf{C}^{(1)}$ 由 $6 \\times 5$ 的局部加细矩阵 $\\mathbf{T}^{(2)}$ 定义：\n$$\n\\mathbf{T}^{(2)} = \\begin{pmatrix}\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  \\frac{1}{3}  \\frac{2}{3}  0 \\\\\n0  0  0  \\frac{1}{2}  \\frac{1}{2} \\\\\n0  0  0  0  1\n\\end{pmatrix}\n$$\n最终加细后的节点矢量为 $\\Xi^{(2)} = [0,0,0, \\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}, 1,1,1]$，与问题陈述一致。\n\n**全局加细矩阵 $\\mathbf{T}$**\n全局加细矩阵 $\\mathbf{T}$ 将初始控制向量 $\\mathbf{C}^{(0)}$ 直接变换为最终控制向量 $\\mathbf{C}^{(2)}$。它是两个连续局部加细算子的乘积：\n$\\mathbf{C}^{(2)} = \\mathbf{T}^{(2)}\\mathbf{C}^{(1)} = \\mathbf{T}^{(2)}(\\mathbf{T}^{(1)}\\mathbf{C}^{(0)}) = (\\mathbf{T}^{(2)}\\mathbf{T}^{(1)})\\mathbf{C}^{(0)}$。\n因此，$\\mathbf{T} = \\mathbf{T}^{(2)}\\mathbf{T}^{(1)}$。我们计算这个 $6 \\times 4$ 矩阵的乘积：\n$$\n\\mathbf{T} = \\begin{pmatrix}\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  \\frac{1}{3}  \\frac{2}{3}  0 \\\\\n0  0  0  \\frac{1}{2}  \\frac{1}{2} \\\\\n0  0  0  0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0 \\\\\n0  \\frac{3}{4}  \\frac{1}{4}  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n逐行进行矩阵乘法：\n第1行：$[1,0,0,0]$\n第2行：$[\\frac{1}{2}, \\frac{1}{2}, 0, 0]$\n第3行：$[0, \\frac{3}{4}, \\frac{1}{4}, 0]$\n第4行：$\\frac{1}{3}[0, \\frac{3}{4}, \\frac{1}{4}, 0] + \\frac{2}{3}[0, 0, 1, 0] = [0, \\frac{1}{4}, \\frac{1}{12}, 0] + [0, 0, \\frac{2}{3}, 0] = [0, \\frac{1}{4}, \\frac{1+8}{12}, 0] = [0, \\frac{1}{4}, \\frac{3}{4}, 0]$\n第5行：$\\frac{1}{2}[0, 0, 1, 0] + \\frac{1}{2}[0, 0, 0, 1] = [0, 0, \\frac{1}{2}, \\frac{1}{2}]$\n第6行：$[0, 0, 0, 1]$\n\n所以，全局加细矩阵为：\n$$\n\\mathbf{T} = \\begin{pmatrix}\n1  0  0  0 \\\\\n\\frac{1}{2}  \\frac{1}{2}  0  0 \\\\\n0  \\frac{3}{4}  \\frac{1}{4}  0 \\\\\n0  \\frac{1}{4}  \\frac{3}{4}  0 \\\\\n0  0  \\frac{1}{2}  \\frac{1}{2} \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n\n**$\\mathbf{T}$ 的性质验证**\n我们从第一性原理验证两个性质。\n1.  **非负性 ($T_{ij} \\ge 0$)：** 局部加细矩阵的元素是非负的。对于与未改变的控制点相对应的行，其元素为 $0$ 或 $1$。对于与新控制点相对应的行，其系数为 $1-\\alpha_i$ 和 $\\alpha_i$。由于 $\\xi_k \\le \\bar{\\xi}  \\xi_{k+1}$，并且对于受影响的控制点有 $\\xi_i \\le \\bar{\\xi}$ 和 $\\xi_{i+p}  \\bar{\\xi}$，因此我们有 $0 \\le \\alpha_i  1$。所以，$\\mathbf{T}^{(1)}$ 和 $\\mathbf{T}^{(2)}$ 中的所有元素都是非负的。两个非负矩阵的乘积也是一个非负矩阵，因为它的元素是非负数的乘积之和：$T_{ij} = \\sum_k T^{(2)}_{ik} T^{(1)}_{kj} \\ge 0$。直接检查计算出的 $\\mathbf{T}$ 矩阵可以证实其所有元素都是非负的。\n2.  **行和为一 ($\\sum_j T_{ij} = 1$)：** 此性质确保基函数构成单位分解，这是通过加细继承的一个基本性质。对于任何局部加细矩阵，例如 $\\mathbf{A}$，其各行之和为 $1$。这是因为每个新的控制点要么是旧控制点的复制（行中只有一个 $1$），要么是凸组合 $(1-\\alpha)\\mathbf{P}_{j-1} + \\alpha\\mathbf{P}_j$（行元素为 $(1-\\alpha)$ 和 $\\alpha$，其和为 $1$）。每行之和为 $1$ 的矩阵称为行随机矩阵。令 $\\mathbf{e}_k$ 是一个包含 $k$ 个1的列向量。行和性质等价于 $\\mathbf{A}\\mathbf{e}_{n} = \\mathbf{e}_{m}$。对于我们的加细矩阵，有 $\\mathbf{T}^{(1)}\\mathbf{e}_{4} = \\mathbf{e}_{5}$ 和 $\\mathbf{T}^{(2)}\\mathbf{e}_{5} = \\mathbf{e}_{6}$。两个行随机矩阵的乘积也是行随机矩阵：\n    $(\\mathbf{T}^{(2)}\\mathbf{T}^{(1)})\\mathbf{e}_4 = \\mathbf{T}^{(2)}(\\mathbf{T}^{(1)}\\mathbf{e}_4) = \\mathbf{T}^{(2)}\\mathbf{e}_5 = \\mathbf{e}_6$。\n    因此，$\\mathbf{T} = \\mathbf{T}^{(2)}\\mathbf{T}^{(1)}$ 的每行之和必须为 $1$。我们可以对计算出的 $\\mathbf{T}$ 进行显式验证：\n    第1行：$1+0+0+0=1$\n    第2行：$\\frac{1}{2}+\\frac{1}{2}+0+0=1$\n    第3行：$0+\\frac{3}{4}+\\frac{1}{4}+0=1$\n    第4行：$0+\\frac{1}{4}+\\frac{3}{4}+0=1$\n    第5行：$0+0+\\frac{1}{2}+\\frac{1}{2}=1$\n    第6行：$0+0+0+1=1$\n    验证成功。\n\n**$S$ 的最终计算**\n标量 $S$ 是矩阵 $\\mathbf{T}$ 中所有元素的总和：\n$$\nS = \\sum_{i=1}^{6} \\sum_{j=1}^{4} T_{ij}\n$$\n这可以计算为各行和的总和：\n$$\nS = \\sum_{i=1}^{6} \\left( \\sum_{j=1}^{4} T_{ij} \\right)\n$$\n正如我们刚刚证明和验证的，每行的和为 $1$。因此：\n$$\nS = \\sum_{i=1}^{6} 1 = 6\n$$\n$S$ 的值是最终加细矩阵 $\\mathbf{T}$ 的行数。",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "标准NURBS的细化操作具有全局效应，这在仅需局部提高精度的场景中效率低下，而T样条正是为实现真正的局部细化而生。本练习将带您深入T样条的核心机制，探究插入一个T型节点如何改变T网格拓扑，并进而影响基函数的定义。通过对分析适用性T样条（ASTS）的细化过程进行动手分析，您将清晰地看到T样条如何仅在细化区域附近修改基函数，从而实现其优于传统方法的局部控制能力。",
            "id": "3594368",
            "problem": "考虑参数域 $\\Omega$ 上的一个二次分析适用T样条 (ASTS) 基，其初始T网格是均匀的，由位于 $u=0,1,2,3$ 的垂直线和位于 $v=0,1,2,3$ 的水平线定义。因此，该网格包含由这些线界定的 $3\\times 3$ 个面。对于二次情况 ($p=q=2$)，锚点与面中心相关联，基函数的数量等于面的数量。使用标识符映射 $I(i,j)=(j-1)\\cdot 3+i$ 对锚点按行主序进行索引，其中列 $i\\in\\{1,2,3\\}$，行 $j\\in\\{1,2,3\\}$。因此，中心面 $(i=2,j=2)$ 的标识符为 $I(2,2)=5$。\n\n一次局部加密通过在中心面 $(i=2,j=2)$ 内部添加一条位于 $u=1.5$ 的垂直网格段来插入一个T型节点。该网格段从上边缘 $v=2$ 处开始，终止于下边缘 $v=1$ 的中点，从而在 $(u=1.5,v=1)$ 处创建一个T型节点。这将中心面分割成两个面：一个左子面 $(2\\mathrm{L},2)$，其 $u\\in[1,1.5]$；以及一个右子面 $(2\\mathrm{R},2)$，其 $u\\in[1.5,2]$。为这些新增的锚点分配新的标识符，即 $I(2\\mathrm{L},2)=10$ 和 $I(2\\mathrm{R},2)=11$。假设针对 $p=q=2$ 的分析适用T样条延伸规则完全在行 $j=2$ 内执行，因此没有创建额外的面，也没有T型节点延伸相交；位于 $u=1.5$ 的新垂直段成为行 $j=2$ 中与中心面在 $u$ 方向上相邻的锚点的局部索引选择的一部分。\n\n仅使用偶次 ($p=2$) 分析适用T样条的定义属性以及根据相邻网格线构造局部索引向量的方法，确定：\n- 加密后基函数总数的变化量 $\\Delta N$。\n- 加密所添加的锚点的标识符。\n- 因插入 $u=1.5$ 处的垂直段而导致其局部索引向量被改变的锚点（这些锚点仍然存在）的标识符，特别是在行 $j=2$ 内。\n\n将您的最终答案表示为一个单行矩阵，其中包含按以下顺序排列的五个条目：$\\Delta N$、$I_{\\text{add},1}$、$I_{\\text{add},2}$、$I_{\\text{alt},1}$、$I_{\\text{alt},2}$。无需四舍五入。",
            "solution": "该问题要求分析对二次分析适用T样条 (ASTS) 基进行的局部加密步骤。我们必须确定基函数数量的变化，识别新添加的基函数（通过其锚点标识符），并识别因加密而定义被改变的现有基函数。\n\n首先，我们确定初始状态。问题定义了一个在参数域 $\\Omega$ 上的均匀 $3 \\times 3$ T网格，其节点线位于 $u \\in \\{0, 1, 2, 3\\}$ 和 $v \\in \\{0, 1, 2, 3\\}$。这产生了 $9$ 个面。对于二次 ASTS ($p=q=2$)，面、锚点和基函数之间存在一一对应关系。因此，初始基函数的数量为 $N_0 = 9$。锚点使用映射 $I(i,j) = (j-1) \\cdot 3 + i$ 进行索引，其中 $i$ 为列，$j$ 为行。中心行 ($j=2$) 的锚点是：\n- $I(1,2) = (2-1) \\cdot 3 + 1 = 4$\n- $I(2,2) = (2-1) \\cdot 3 + 2 = 5$\n- $I(3,2) = (2-1) \\cdot 3 + 3 = 6$\n\n局部加密操作包括插入一条位于 $u=1.5$ 的垂直网格段，该段从 $v=2$ 延伸到 $v=1$。该段平分了对应于锚点 $I(2,2) = 5$ 的中心面。由 $u \\in [1,2]$ 和 $v \\in [1,2]$ 定义的原始面被两个新面替换：一个位于 $u \\in [1,1.5]$ 的左子面和一个位于 $u \\in [1.5,2]$ 的右子面，两者都在 $v \\in [1,2]$ 上。\n\n1.  **基函数数量的变化 ($\\Delta N$)**\n    基函数的数量等于面（和锚点）的数量。所描述的加密移除了一个面（原始的中心面），并在其位置上添加了两个新面。\n    - 初始面/基函数数量：$N_0 = 9$。\n    - 最终面/基函数数量：$N_f = N_0 - 1 + 2 = 10$。\n    基函数总数的变化为：\n    $$ \\Delta N = N_f - N_0 = 10 - 9 = 1 $$\n\n2.  **新增锚点的标识符 ($I_{\\text{add}}$)**\n    加密将原始中心面 $I(2,2)=5$ 的锚点替换为与两个新子面对应的两个新锚点。问题陈述明确地为这些新锚点分配了标识符：\n    - 左子面 $(2\\mathrm{L},2)$ 的锚点：$I(2\\mathrm{L},2) = 10$。\n    - 右子面 $(2\\mathrm{R},2)$ 的锚点：$I(2\\mathrm{R},2) = 11$。\n    因此，新增锚点的标识符是 $10$ 和 $11$。\n\n3.  **被改变锚点的标识符 ($I_{\\text{alt}}$)**\n    与锚点 $a$ 关联的T样条基函数 $N_a$ 的定义由其局部节点向量确定。对于二次 ($p=2$) T样条，给定参数方向（例如 $u$ 方向）的局部节点向量是通过收集从锚点沿正方向和负方向发出的射线所穿过的头 $p/2+1 = 2/2+1 = 2$ 条不同网格线的节点值来构造的。如果一个现有基函数的局部节点向量发生变化，那么该基函数就被改变了。如果它“看到”的网格线集合发生变化，就会出现这种情况。\n\n    加密仅在区间 $v \\in [1,2]$ 上引入了一条位于 $u=1.5$ 的新垂直段。这意味着只有那些其射线在位于此区间内的 $v$ 坐标处发出的锚点才会受到影响。锚点位于其各自面的中心。\n    - 行 $j=1$ 中的锚点（例如，$I(1,1)=1$，$I(2,1)=2$，$I(3,1)=3$）：这些锚点的中心位于 $v=0.5$。从这些锚点发出的射线不穿过 $v$ 区间 $[1,2]$，因此“看不到”位于 $u=1.5$ 的新线。它们的局部索引向量保持不变。\n    - 行 $j=3$ 中的锚点（例如，$I(1,3)=7$，$I(2,3)=8$，$I(3,3)=9$）：这些锚点的中心位于 $v=2.5$。出于同样的原因，它们的局部索引向量也保持不变。\n    - 行 $j=2$ 中的锚点（例如，$I(1,2)=4$，$I(3,2)=6$）：这些锚点的中心位于 $v=1.5$，该值位于区间 $v \\in [1,2]$ 内。它们在 $u$ 方向的局部索引向量可能会被改变。让我们来分析它们。\n\n    **锚点 $I(1,2)=4$**：此锚点位于面 $[0,1] \\times [1,2]$ 的中心，坐标为 $(0.5, 1.5)$。\n    - 我们检查从 $u=0.5$ 沿正 $u$ 方向发出的射线。\n    - **加密前**：垂直网格线的集合是 $\\{0, 1, 2, 3\\}$。射线首先穿过 $u=1$，然后是 $u=2$。收集到的线是 $\\{1, 2\\}$。\n    - **加密后**：从 $v=1.5$ 可见的垂直网格线集合是 $\\{0, 1, 1.5, 2, 3\\}$。射线首先穿过 $u=1$，然后是 $u=1.5$。收集到的线是 $\\{1, 1.5\\}$。\n    - 由于用于构造局部节点向量的线集合发生了变化，与锚点 $4$ 关联的基函数被改变了。\n\n    **锚点 $I(3,2)=6$**：此锚点位于面 $[2,3] \\times [1,2]$ 的中心，坐标为 $(2.5, 1.5)$。\n    - 我们检查从 $u=2.5$ 沿负 $u$ 方向发出的射线。\n    - **加密前**：垂直网格线的集合是 $\\{0, 1, 2, 3\\}$。射线首先穿过 $u=2$，然后是 $u=1$。收集到的线是 $\\{2, 1\\}$。\n    - **加密后**：从 $v=1.5$ 可见的垂直网格线集合是 $\\{0, 1, 1.5, 2, 3\\}$。射线首先穿过 $u=2$，然后是 $u=1.5$。收集到的线是 $\\{2, 1.5\\}$。\n    - 锚点 $6$ 的局部节点向量也被改变了。\n\n    问题通过特别询问“在行 $j=2$ 内”被改变的锚点，确认了我们的分析范围。锚点 $I(2,2)=5$ 被移除了，而不是被改变。因此，其基函数被改变的锚点的标识符是 $4$ 和 $6$。\n\n    **结果摘要：**\n    - 基函数数量的变化：$\\Delta N = 1$。\n    - 新增锚点的标识符：$10$ 和 $11$。\n    - 行 j=2 中被改变的锚点的标识符：$4$ 和 $6$。\n\n    最终答案是一个行矩阵，按指定顺序包含这五个值：$(\\Delta N, I_{\\text{add},1}, I_{\\text{add},2}, I_{\\text{alt},1}, I_{\\text{alt},2})$。我们将按升序排列新增和被改变的标识符。\n\n    最终的值集是 $(1, 10, 11, 4, 6)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1   10   11   4   6 \\end{pmatrix} } $$"
        }
    ]
}