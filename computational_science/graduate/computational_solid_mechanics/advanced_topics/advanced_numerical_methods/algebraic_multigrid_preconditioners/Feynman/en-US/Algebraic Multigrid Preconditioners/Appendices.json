{
    "hands_on_practices": [
        {
            "introduction": "The heart of the algebraic multigrid method is the construction of a coarse-grid operator that effectively represents the fine-grid problem on a smaller scale. This is achieved through the Galerlin projection, $A_c = R A P$, where $P$ is the prolongation (interpolation) operator and $R$ is the restriction operator. This exercise  provides a concrete, hands-on opportunity to build these matrices for a minimal 1D system and verify a key theoretical result: the interlacing of coarse- and fine-grid eigenvalues, which ensures the stability and relevance of the coarse-grid problem.",
            "id": "3290960",
            "problem": "Consider the one-dimensional pressure Poisson equation in Computational Fluid Dynamics (CFD) given by $- \\partial_{x}^{2} p = f$ on a unit interval with homogeneous Dirichlet boundary conditions at both ends. Discretize this equation on a uniform fine grid with $3$ interior unknowns and nondimensional spacing $h = 1$ using the second-order central difference approximation. This yields a symmetric positive definite (SPD) fine-grid operator $A \\in \\mathbb{R}^{3 \\times 3}$ that is the canonical tridiagonal discrete Laplacian. In the context of Algebraic Multigrid (AMG), define a coarse grid consisting of $2$ coarse points aligned with fine points $1$ and $3$, and construct a prolongation operator $P \\in \\mathbb{R}^{3 \\times 2}$ by linear interpolation that maps coarse-grid unknowns $\\begin{pmatrix} u_{C}^{1} \\\\ u_{C}^{2} \\end{pmatrix}$ to fine-grid unknowns $\\begin{pmatrix} u_{f}^{1} \\\\ u_{f}^{2} \\\\ u_{f}^{3} \\end{pmatrix}$ via $u_{f}^{1} = u_{C}^{1}$, $u_{f}^{2} = \\frac{1}{2} u_{C}^{1} + \\frac{1}{2} u_{C}^{2}$, and $u_{f}^{3} = u_{C}^{2}$. Use the symmetric Galerkin choice of restriction $R = P^{\\top}$. Starting from the finite-difference discretization and the SPD property of the discrete Laplacian, explicitly construct $R$ and $P$, compute the coarse-grid operator $A_{c} = R A P$, and determine the spectra (sets of eigenvalues) of both $A$ and $A_{c}$. Then verify, using first principles for Ritz values of SPD matrices, that the coarse-grid eigenvalues interlace the fine-grid eigenvalues. For your final reported result, provide the two coarse-grid eigenvalues of $A_{c}$ as exact values. No rounding is needed; the answer is dimensionless because $h = 1$.",
            "solution": "The one-dimensional pressure Poisson equation is $- \\partial_{x}^{2} p = f$ with homogeneous Dirichlet boundary conditions. Discretizing this on a uniform grid with $N=3$ interior points and grid spacing $h=1$ using a second-order central difference scheme, $\\frac{-p_{i-1} + 2p_i - p_{i+1}}{h^2}$, results in a linear system $A\\mathbf{p} = \\mathbf{f}$. The matrix $A$ is the $3 \\times 3$ discrete Laplacian. Given boundary conditions $p_0=0$ and $p_4=0$, the fine-grid operator $A$ is:\n$$\nA = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}\n$$\nThe problem defines a prolongation (interpolation) operator $P \\in \\mathbb{R}^{3 \\times 2}$ that maps a coarse-grid vector of $2$ unknowns, $\\mathbf{u}_C$, to a fine-grid vector of $3$ unknowns, $\\mathbf{u}_f$. The mapping is defined as:\n$u_f^1 = u_C^1$\n$u_f^2 = \\frac{1}{2} u_C^1 + \\frac{1}{2} u_C^2$\n$u_f^3 = u_C^2$\nIn matrix form, $\\mathbf{u}_f = P \\mathbf{u}_C$, the prolongation operator is:\n$$\nP = \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe restriction operator $R$ is constructed using the symmetric Galerkin choice, $R = P^{\\top}$. Therefore, $R \\in \\mathbb{R}^{2 \\times 3}$ is:\n$$\nR = \\begin{pmatrix} 1 & \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} & 1 \\end{pmatrix}\n$$\nThe coarse-grid operator $A_c$ is formed by the Galerkin projection $A_c = R A P = P^{\\top} A P$. We compute this product. First, $A P$:\n$$\nA P = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ \\frac{1}{2} & \\frac{1}{2} \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ 0 & 0 \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix}\n$$\nNext, we pre-multiply by $R$ to find $A_c$:\n$$\nA_c = R (A P) = \\begin{pmatrix} 1 & \\frac{1}{2} & 0 \\\\ 0 & \\frac{1}{2} & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ 0 & 0 \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2} \\end{pmatrix}\n$$\nNow, we determine the spectra of $A$ and $A_c$.\nThe eigenvalues of the fine-grid operator $A$, denoted $\\lambda_A$, are the roots of the characteristic equation $\\det(A - \\lambda_A I) = 0$:\n$$\n\\det \\begin{pmatrix} 2-\\lambda_A & -1 & 0 \\\\ -1 & 2-\\lambda_A & -1 \\\\ 0 & -1 & 2-\\lambda_A \\end{pmatrix} = (2-\\lambda_A)((2-\\lambda_A)^2 - 1) - (-1)(-(2-\\lambda_A)) = (2-\\lambda_A)((2-\\lambda_A)^2 - 2) = 0\n$$\nThis gives one eigenvalue $\\lambda_A = 2$, and two others from $(2-\\lambda_A)^2 = 2$, which means $2-\\lambda_A = \\pm\\sqrt{2}$, or $\\lambda_A = 2 \\mp \\sqrt{2}$. The sorted eigenvalues of $A$ are:\n$\\lambda_1(A) = 2 - \\sqrt{2}$\n$\\lambda_2(A) = 2$\n$\\lambda_3(A) = 2 + \\sqrt{2}$\nAll eigenvalues are positive, confirming that $A$ is positive definite.\n\nThe eigenvalues of the coarse-grid operator $A_c$, denoted $\\lambda_c$, are the roots of $\\det(A_c - \\lambda_c I) = 0$:\n$$\n\\det \\begin{pmatrix} \\frac{3}{2}-\\lambda_c & -\\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{3}{2}-\\lambda_c \\end{pmatrix} = \\left(\\frac{3}{2}-\\lambda_c\\right)^2 - \\left(-\\frac{1}{2}\\right)^2 = \\left(\\frac{3}{2}-\\lambda_c\\right)^2 - \\frac{1}{4} = 0\n$$\nThis implies $\\left(\\frac{3}{2}-\\lambda_c\\right)^2 = \\frac{1}{4}$, so $\\frac{3}{2}-\\lambda_c = \\pm\\frac{1}{2}$. This yields the eigenvalues $\\lambda_c = \\frac{3}{2} \\mp \\frac{1}{2}$. The sorted eigenvalues of $A_c$ are:\n$\\lambda_1(A_c) = \\frac{3}{2} - \\frac{1}{2} = 1$\n$\\lambda_2(A_c) = \\frac{3}{2} + \\frac{1}{2} = 2$\n\nFinally, we verify the eigenvalue interlacing property. The Courant-Fischer min-max principle establishes that the eigenvalues of a Galerkin-projected system interlace the eigenvalues of the original system. For an $n \\times n$ SPD matrix $A$ and an $n \\times m$ full-rank prolongation matrix $P$ ($m  n$), the eigenvalues $\\mu_k$ of the generalized eigenvalue problem $P^{\\top}AP y = \\mu (P^{\\top}P) y$ interlace the eigenvalues $\\lambda_k$ of $A$. That is, $\\lambda_k(A) \\le \\mu_k \\le \\lambda_{k+n-m}(A)$ for $k=1, \\dots, m$. These $\\mu_k$ are the true Ritz values. The problem asks to verify this property for the standard eigenvalues $\\lambda_k(A_c)$. We check this directly.\nHere, $n=3$, $m=2$. We must verify that $\\lambda_k(A) \\le \\lambda_k(A_c) \\le \\lambda_{k+1}(A)$ for $k=1, 2$.\nFor $k=1$:\n$$\n\\lambda_1(A) \\le \\lambda_1(A_c) \\le \\lambda_2(A) \\implies 2 - \\sqrt{2} \\le 1 \\le 2\n$$\nSince $1  \\sqrt{2}  2$, we have $0  2-\\sqrt{2}  1$. Thus, $2 - \\sqrt{2} \\le 1$ holds. Also, $1 \\le 2$ holds. The first interlacing condition is satisfied.\nFor $k=2$:\n$$\n\\lambda_2(A) \\le \\lambda_2(A_c) \\le \\lambda_3(A) \\implies 2 \\le 2 \\le 2 + \\sqrt{2}\n$$\nThis condition is also satisfied. Thus, the interlacing property holds for the standard eigenvalues of $A_c$ for this specific problem.\n\nThe two coarse-grid eigenvalues of $A_c$ are $1$ and $2$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While coarse-grid correction handles smooth error components, it is ineffective against high-frequency, oscillatory errors. This is the critical role of the smoother, a simple iterative method like weighted Jacobi that efficiently damps these oscillatory modes. In this practice , you will use local Fourier analysis—a cornerstone of multigrid theory—to derive the exact smoothing factor for the 2D Laplacian. This will allow you to determine the optimal relaxation parameter $\\omega$ that maximizes the damping of high-frequency error, providing insight into how AMG components are tuned for peak performance.",
            "id": "3290894",
            "problem": "Consider the pressure Poisson equation arising in a projection method for incompressible flow in Computational Fluid Dynamics (CFD), discretized on a uniform two-dimensional periodic grid with spacing $h$ using the standard five-point finite difference stencil for the negative Laplacian $-\\Delta$. Let the resulting linear system be $A \\mathbf{p} = \\mathbf{g}$, where $A$ is the discrete operator with diagonal entries $4/h^{2}$ and nearest-neighbor off-diagonal entries $-1/h^{2}$. In an Algebraic Multigrid (AMG) preconditioner, the weighted Jacobi (WJ) method is used as a smoothing (relaxation) scheme: the error iteration is $e^{k+1} = (I - \\omega D^{-1} A) e^{k}$, where $D$ is the diagonal of $A$ and $\\omega \\in (0,2)$ is the relaxation parameter.\n\nUsing local Fourier analysis on the periodic grid, analyze the action of the smoother on Fourier error modes $e^{\\mathrm{i}(\\theta_{x} i + \\theta_{y} j)}$ with $(\\theta_{x}, \\theta_{y}) \\in [-\\pi, \\pi]^{2}$. Define the high-frequency set relative to standard full coarsening by a factor of $2$ in each coordinate as those modes with $|\\theta_{x}| \\in [\\pi/2, \\pi]$ and $|\\theta_{y}| \\in [\\pi/2, \\pi]$. The smoothing factor is the supremum, over this high-frequency set, of the magnitude of the one-step error amplification factor induced by the weighted Jacobi iteration.\n\nStarting from the discrete operator stencil and the definition of the error iteration, derive the Fourier symbol of the smoother and the expression for the high-frequency amplification factor. Then, determine the value of $\\omega$ that minimizes the smoothing factor, and compute the corresponding minimal smoothing factor. Express both the optimal relaxation parameter and the minimal smoothing factor as exact values. Provide your final answer as a row vector using the LaTeX $\\mathrm{pmatrix}$ environment.",
            "solution": "The problem asks for the optimal relaxation parameter $\\omega$ and the minimal smoothing factor $\\mu$ for a weighted Jacobi smoother applied to the 2D discrete Laplacian. We use Local Fourier Analysis (LFA).\n\n1.  **Fourier Symbol of the Operator**: The discrete negative Laplacian operator $A$ has a five-point stencil $[[-1], [-1, 4, -1], [-1]]/h^2$. Applying this to a Fourier mode $v_{i,j} = e^{\\mathrm{i}(\\theta_{x} i + \\theta_{y} j)}$ yields the operator's eigenvalue, or symbol, $\\hat{A}(\\theta_x, \\theta_y)$:\n    $$ \\hat{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\left(4 - e^{\\mathrm{i}\\theta_x} - e^{-\\mathrm{i}\\theta_x} - e^{\\mathrm{i}\\theta_y} - e^{-\\mathrm{i}\\theta_y}\\right) = \\frac{2}{h^2} (2 - \\cos\\theta_x - \\cos\\theta_y) $$\n    Using the half-angle identity $1-\\cos\\theta = 2\\sin^2(\\theta/2)$, we get:\n    $$ \\hat{A}(\\theta_x, \\theta_y) = \\frac{4}{h^2} \\left(\\sin^2\\frac{\\theta_x}{2} + \\sin^2\\frac{\\theta_y}{2}\\right) $$\n\n2.  **Fourier Symbol of the Smoother**: The weighted Jacobi iteration matrix is $S = I - \\omega D^{-1} A$. The diagonal of $A$ is $D = (4/h^2)I$. The symbol of the smoother, $\\hat{S}(\\theta_x, \\theta_y)$, is the amplification factor for the corresponding Fourier mode:\n    $$ \\hat{S}(\\theta_x, \\theta_y) = 1 - \\omega \\left(\\frac{h^2}{4}\\right) \\hat{A}(\\theta_x, \\theta_y) = 1 - \\omega \\left(\\sin^2\\frac{\\theta_x}{2} + \\sin^2\\frac{\\theta_y}{2}\\right) $$\n\n3.  **High-Frequency Analysis**: The problem defines the high-frequency set as modes where $|\\theta_x| \\in [\\pi/2, \\pi]$ and $|\\theta_y| \\in [\\pi/2, \\pi]$. For this range, $|\\theta_x/2| \\in [\\pi/4, \\pi/2]$, so $\\sin^2(\\theta_x/2) \\in [1/2, 1]$. The same applies to the $y$-component. Let $\\lambda = \\sin^2(\\theta_x/2) + \\sin^2(\\theta_y/2)$. The range of $\\lambda$ over the high-frequency set is $[\\frac{1}{2}+\\frac{1}{2}, 1+1] = [1, 2]$.\n\n4.  **Minimizing the Smoothing Factor**: The smoothing factor $\\mu(\\omega)$ is the supremum of the amplification factor's magnitude over the high-frequency eigenvalues $\\lambda$:\n    $$ \\mu(\\omega) = \\sup_{\\lambda \\in [1, 2]} |1 - \\omega \\lambda| $$\n    Since $1-\\omega\\lambda$ is linear in $\\lambda$, its maximum magnitude on the interval $[1, 2]$ must occur at the endpoints:\n    $$ \\mu(\\omega) = \\max(|1 - \\omega \\cdot 1|, |1 - \\omega \\cdot 2|) = \\max(|1-\\omega|, |1-2\\omega|) $$\n    The minimum of this expression is found when the two terms are equal in magnitude: $|1-\\omega| = |1-2\\omega|$. As $\\omega \\in (0,1)$, we must have $1-\\omega = -(1-2\\omega) = 2\\omega-1$. Solving for $\\omega$ gives $3\\omega = 2$, so the optimal relaxation parameter is:\n    $$ \\omega_{\\text{opt}} = \\frac{2}{3} $$\n    The corresponding minimal smoothing factor is found by substituting this value back:\n    $$ \\mu_{\\min} = \\left|1 - \\frac{2}{3}\\right| = \\frac{1}{3} $$\nThe optimal relaxation parameter is $2/3$, and the minimal smoothing factor is $1/3$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{3}  \\frac{1}{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The remarkable efficiency of multigrid stems from the complementary action of smoothing and coarse-grid correction. A full analysis requires understanding how these two components interact within a complete cycle. This comprehensive exercise  integrates the concepts from the previous practices into a single, powerful framework. By performing a two-grid local Fourier analysis, you will predict the method's convergence factor, connecting the smoother's performance and the interpolation's approximation quality to the overall speed of the solver, showcasing the predictive power of multigrid theory.",
            "id": "3543424",
            "problem": "Consider small-strain, one-dimensional linear elasticity on the interval $[0,1]$ with homogeneous Dirichlet boundary conditions, constant Young’s modulus $E0$ and cross-sectional area $A0$. Let $u(x)$ denote the axial displacement and let the weak form be discretized by linear finite elements on a uniform mesh with mesh size $h$. The resulting stiffness matrix on the fine grid is the symmetric positive definite tridiagonal matrix $A_h \\in \\mathbb{R}^{n \\times n}$ whose stencil is proportional to $\\{-1,2,-1\\}$, i.e., $A_h = \\frac{EA}{h}\\,\\mathrm{tridiag}(-1,2,-1)$. This setting is a canonical scalar model for solid mechanics operators used in Algebraic Multigrid (AMG) preconditioning.\n\nAssume a two-level AMG method that, for this constant-coefficient, scalar, $M$-matrix problem, reduces to the classical geometric ingredients: one coarse grid with spacing $2h$, full-weighting restriction with stencil $\\{\\tfrac{1}{4},\\tfrac{1}{2},\\tfrac{1}{4}\\}$, linear interpolation (piecewise linear prolongation), and a Galerkin coarse operator $A_{2h} = R A_h P$. The smoother is damped Jacobi with weight $\\omega \\in (0,1)$, and one pre- and one post-smoothing step are used.\n\nProceed as follows, starting only from core definitions and Fourier symbols of shift-invariant operators:\n\n1) Define the Fourier symbol of $A_h$ and of the damped Jacobi smoother $S_h = I - \\omega D^{-1} A_h$, where $D = \\mathrm{diag}(A_h)$. Define the smoothing factor $\\mu(\\omega)$ as the supremum over the “high-frequency” set $\\theta \\in [\\pi/2,\\pi]$ of the magnitude of the Jacobi error-amplification symbol, and determine the optimal damping $\\omega^{\\star}$ that minimizes $\\mu(\\omega)$. Report the minimal smoothing factor $\\mu_{\\min}$.\n\n2) Define the weak approximation property constant $C_A$ for linear interpolation $P$ with respect to the diagonal-norm $D$, namely the smallest constant $C_A$ such that\n$$\n\\min_{v_{2h}} \\| v_h - P v_{2h} \\|_{D}^{2} \\le C_A \\, v_h^{\\top} A_h v_h\n$$\nfor all fine-grid vectors $v_h$. Using Fourier analysis on the uniform grid, compute $C_A$ exactly.\n\n3) Using Local Fourier Analysis for two-grid with one pre- and one post-Jacobi step at $\\omega=\\omega^{\\star}$, linear interpolation, full-weighting restriction, and the Galerkin coarse operator, form the $2\\times 2$ error-amplification matrix on the two-frequency subspace spanned by $\\theta \\in (0,\\pi/2]$ and its $2h$-alias $\\pi-\\theta$. Determine the worst-case spectral radius over $\\theta\\in (0,\\pi/2]$ to predict the two-grid convergence factor $\\rho_{\\mathrm{TG}}$.\n\nExpress your final answer as the exact value of $\\rho_{\\mathrm{TG}}$ (dimensionless). Do not round.",
            "solution": "The problem is well-posed and scientifically grounded, representing a canonical case study in the Local Fourier Analysis (LFA) of multigrid methods. We proceed with the three parts of the problem.\n\nThroughout the analysis, we use the following notations for a frequency $\\theta \\in (0, \\pi/2]$: $s = \\sin(\\theta/2)$ and $c = \\cos(\\theta/2)$. Note that $s^2+c^2=1$.\n\n**Part 1: Smoothing Analysis**\n\nThe stiffness matrix $A_h$ is given by the stencil $\\frac{EA}{h}\\{-1, 2, -1\\}$. To find its Fourier symbol, $\\tilde{A}_h(\\theta)$, we apply the operator to a Fourier mode $v_j = \\exp(ij\\theta)$, where $j$ is the grid point index.\n$$\n(A_h v)_j = \\frac{EA}{h}(-v_{j-1} + 2v_j - v_{j+1}) = \\frac{EA}{h}(-\\exp(i(j-1)\\theta) + 2\\exp(ij\\theta) - \\exp(i(j+1)\\theta))\n$$\nFactoring out $\\exp(ij\\theta)$, we get the symbol:\n$$\n\\tilde{A}_h(\\theta) = \\frac{EA}{h}(-\\exp(-i\\theta) + 2 - \\exp(i\\theta)) = \\frac{EA}{h}(2 - 2\\cos(\\theta))\n$$\nUsing the half-angle identity $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$, we have:\n$$\n\\tilde{A}_h(\\theta) = \\frac{4EA}{h}\\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\nThe smoother is the damped Jacobi method, with iteration operator $S_h = I - \\omega D^{-1} A_h$. The matrix $D = \\mathrm{diag}(A_h)$ is constant along the diagonal for interior grid points, with value $D_{jj} = \\frac{2EA}{h}$. In LFA, which assumes an infinite grid, $D$ is treated as $\\frac{2EA}{h}I$. Its symbol is the constant $\\tilde{D} = \\frac{2EA}{h}$.\n\nThe symbol of the smoother, which is the error amplification factor of the smoothing process, is:\n$$\n\\tilde{S}_h(\\theta) = 1 - \\omega \\tilde{D}^{-1} \\tilde{A}_h(\\theta) = 1 - \\omega \\left(\\frac{h}{2EA}\\right) \\left(\\frac{4EA}{h}\\sin^2\\left(\\frac{\\theta}{2}\\right)\\right) = 1 - 2\\omega\\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\nThe smoothing factor $\\mu(\\omega)$ is the supremum of the magnitude of the error amplification factor over the high-frequency range, defined as $\\theta \\in [\\pi/2, \\pi]$.\n$$\n\\mu(\\omega) = \\sup_{\\theta \\in [\\pi/2, \\pi]} \\left| 1 - 2\\omega\\sin^2\\left(\\frac{\\theta}{2}\\right) \\right|\n$$\nLet $x = \\sin^2(\\theta/2)$. For $\\theta \\in [\\pi/2, \\pi]$, we have $\\theta/2 \\in [\\pi/4, \\pi/2]$, and thus $x \\in [\\sin^2(\\pi/4), \\sin^2(\\pi/2)] = [1/2, 1]$. The problem reduces to finding:\n$$\n\\mu(\\omega) = \\max_{x \\in [1/2, 1]} |1 - 2\\omega x|\n$$\nThe function $f(x)=1-2\\omega x$ is linear. For $\\omega \\in (0,1)$, its slope is negative. Thus, the maximum of $|f(x)|$ on the interval $[1/2, 1]$ must occur at one of the endpoints, $x=1/2$ or $x=1$.\n$$\n\\mu(\\omega) = \\max\\left(\\left|1 - 2\\omega\\left(\\frac{1}{2}\\right)\\right|, |1 - 2\\omega(1)|\\right) = \\max(|1-\\omega|, |1-2\\omega|)\n$$\nThe optimal damping $\\omega^{\\star}$ minimizes this quantity. This occurs when the two arguments of the max function are equal in magnitude:\n$$\n|1-\\omega^{\\star}| = |1-2\\omega^{\\star}|\n$$\nSince $\\omega^{\\star} \\in (0,1)$, $1-\\omega^{\\star}$ is positive. We solve $1-\\omega^{\\star} = \\pm(1-2\\omega^{\\star})$.\nThe $+$ case gives $1-\\omega^{\\star} = 1-2\\omega^{\\star}$, which implies $\\omega^{\\star}=0$, an invalid solution.\nThe $-$ case gives $1-\\omega^{\\star} = -(1-2\\omega^{\\star}) = 2\\omega^{\\star}-1$, which leads to $3\\omega^{\\star}=2$, so $\\omega^{\\star}=2/3$.\nThe optimal damping factor is $\\omega^{\\star}=2/3$.\nThe minimal smoothing factor is $\\mu_{\\min} = \\mu(2/3) = |1-2/3| = 1/3$.\n\n**Part 2: Weak Approximation Property**\n\nWe are asked to find the smallest constant $C_A$ such that for all fine-grid vectors $v_h$:\n$$\n\\min_{v_{2h}} \\| v_h - P v_{2h} \\|_{D}^{2} \\le C_A \\, v_h^{\\top} A_h v_h\n$$\nThe term $\\min_{v_{2h}} \\| v_h - P v_{2h} \\|_{D}^{2}$ represents the squared $D$-norm of the error of the best approximation of $v_h$ from the range of $P$. Since $D = \\frac{2EA}{h}I$ is a scalar multiple of the identity, the $D$-norm is equivalent to the Euclidean $L_2$-norm, and the best approximation is given by the orthogonal projection. For linear interpolation $P$, the best coarse-grid representation $v_{2h}$ of a fine-grid function $v_h$ is typically chosen by injection, i.e., $v_{2h}(J) = v_h(2J)$, where $J$ denotes a coarse-grid index.\nThe approximation error is zero at even-indexed points. At odd-indexed points $j=2J+1$, the error is:\n$$\ne_{2J+1} = v_h(2J+1) - \\frac{1}{2}(v_h(2J) + v_h(2J+2)) = -\\frac{1}{2}\\left(v_h(2J) - 2v_h(2J+1) + v_h(2J+2)\\right)\n$$\nWe analyze the inequality in Fourier space. Let $v_h$ be a Fourier mode $v_j=\\exp(ij\\theta)$.\nThe right-hand side, the energy norm, becomes $v_h^{\\top} A_h v_h \\to \\tilde{A}_h(\\theta) = \\frac{4EA}{h}\\sin^2(\\theta/2)$.\nFor the left-hand side, we compute the error mode. The error at an odd point $j$ is:\n$$\ne_j = \\exp(ij\\theta) - \\frac{1}{2}(\\exp(i(j-1)\\theta) + \\exp(i(j+1)\\theta)) = \\exp(ij\\theta) \\left(1 - \\frac{\\exp(-i\\theta)+\\exp(i\\theta)}{2}\\right) = \\exp(ij\\theta)(1-\\cos\\theta)\n$$\nThe squared $D$-norm of the error, per mode, is computed by averaging over the grid. Since the error is non-zero only at half the points (the odd ones), we have:\n$$\n\\|e_h\\|_D^2 \\to \\frac{1}{2} D_{jj} |e_j|^2 = \\frac{1}{2} \\left(\\frac{2EA}{h}\\right) \\left|1-\\cos\\theta\\right|^2 = \\frac{EA}{h} \\left(2\\sin^2(\\theta/2)\\right)^2 = \\frac{4EA}{h}\\sin^4(\\theta/2)\n$$\nThe ratio $Q(\\theta)$ of the LHS to the RHS for the mode $\\theta$ is:\n$$\nQ(\\theta) = \\frac{\\frac{4EA}{h}\\sin^4(\\theta/2)}{\\frac{4EA}{h}\\sin^2(\\theta/2)} = \\sin^2(\\theta/2)\n$$\nThe constant $C_A$ is the supremum of this quantity over all possible modes, i.e., $\\theta \\in [0, \\pi]$.\n$$\nC_A = \\sup_{\\theta \\in [0, \\pi]} \\sin^2(\\theta/2) = \\sin^2(\\pi/2) = 1\n$$\n\n**Part 3: Two-Grid Convergence Factor**\n\nThe two-grid error propagation operator for a cycle with one pre- and one post-smoothing step is $M_{TG} = S_h (I - P A_{2h}^{-1} R A_h) S_h$, where $A_{2h} = R A_h P$. We use LFA to find its symbol $\\tilde{M}_{TG}(\\theta)$, a $2\\times 2$ matrix for each $\\theta \\in (0, \\pi/2]$. The symbols for the operators are:\n- Smoother $\\tilde{S}_h(\\theta)$: With $\\omega^{\\star}=2/3$, the amplification factors for low ($\\theta$) and high ($\\pi-\\theta$) frequencies are $\\mu_s = 1-4s^2/3$ and $\\mu_c = 1-4c^2/3$. The matrix symbol is $\\tilde{S}_h(\\theta) = \\mathrm{diag}(\\mu_s, \\mu_c)$.\n- Operator $\\tilde{A}_h(\\theta)$: Let $C_0 = \\frac{4EA}{h}$. Then $\\tilde{A}_h(\\theta) = C_0 \\cdot \\mathrm{diag}(s^2, c^2)$.\n- Transfer operators: The symbols for linear interpolation ($P$) and full-weighting ($R$) are given by $\\tilde{P}(\\theta)=2(c^2,s^2)^T$ and $\\tilde{R}(\\theta)=(c^2,s^2)$, a standard scaling in LFA.\n- Coarse operator $\\tilde{A}_{2h}(\\theta) = \\tilde{R}(\\theta) \\tilde{A}_h(\\theta) \\tilde{P}(\\theta) = (c^2, s^2) C_0 \\begin{pmatrix} s^2  0 \\\\ 0  c^2 \\end{pmatrix} 2 \\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix} = 2C_0s^2c^2(c^2+s^2) = 2C_0s^2c^2$.\n- The coarse-grid correction operator symbol is $\\tilde{CGC}(\\theta) = I - \\tilde{P}(\\theta)\\tilde{A}_{2h}(\\theta)^{-1}\\tilde{R}(\\theta)\\tilde{A}_h(\\theta)$. The projection term is:\n$$\n\\tilde{P}\\tilde{A}_{2h}^{-1}\\tilde{R}\\tilde{A}_h = 2\\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix} \\frac{1}{2C_0s^2c^2} (c^2,s^2) C_0\\begin{pmatrix} s^2  0 \\\\ 0  c^2 \\end{pmatrix} = \\frac{1}{s^2c^2}\\begin{pmatrix} c^2 \\\\ s^2 \\end{pmatrix}(c^2s^2, s^2c^2) = \\begin{pmatrix} c^2  c^2 \\\\ s^2  s^2 \\end{pmatrix}\n$$\nSo, $\\tilde{CGC}(\\theta) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} c^2  c^2 \\\\ s^2  s^2 \\end{pmatrix} = \\begin{pmatrix} s^2  -c^2 \\\\ -s^2  c^2 \\end{pmatrix}$.\nThe symbol for the full two-grid cycle is $\\tilde{M}_{TG}(\\theta) = \\tilde{S}_h \\tilde{CGC} \\tilde{S}_h$:\n$$\n\\tilde{M}_{TG}(\\theta) = \\begin{pmatrix} \\mu_s  0 \\\\ 0  \\mu_c \\end{pmatrix} \\begin{pmatrix} s^2  -c^2 \\\\ -s^2  c^2 \\end{pmatrix} \\begin{pmatrix} \\mu_s  0 \\\\ 0  \\mu_c \\end{pmatrix} = \\begin{pmatrix} \\mu_s^2 s^2  -\\mu_s \\mu_c c^2 \\\\ -\\mu_s \\mu_c s^2  \\mu_c^2 c^2 \\end{pmatrix}\n$$\nTo find the spectral radius $\\rho(\\tilde{M}_{TG}(\\theta))$, we find its eigenvalues. The determinant is $\\det(\\tilde{M}_{TG}(\\theta)) = 0$, so one eigenvalue is $0$. The other is the trace of the matrix.\n$\\lambda_1=0$, $\\lambda_2 = \\mathrm{tr}(\\tilde{M}_{TG}(\\theta)) = \\mu_s^2 s^2 + \\mu_c^2 c^2$.\nThe spectral radius is $\\rho(\\theta) = |\\mu_s^2 s^2 + \\mu_c^2 c^2|$. Let $x=s^2=\\sin^2(\\theta/2)$. Then $1-x=c^2$.\n$$\n\\rho(x) = \\left(1-\\frac{4}{3}x\\right)^2 x + \\left(1-\\frac{4}{3}(1-x)\\right)^2(1-x) = \\left(\\frac{3-4x}{3}\\right)^2 x + \\left(\\frac{4x-1}{3}\\right)^2(1-x)\n$$\n$$\n\\rho(x) = \\frac{1}{9} \\left[ (9-24x+16x^2)x + (16x^2-8x+1)(1-x) \\right]\n$$\n$$\n\\rho(x) = \\frac{1}{9} \\left[ (9x - 24x^2 + 16x^3) + (16x^2 - 8x + 1 - 16x^3 + 8x^2 - x) \\right]\n$$\n$$\n\\rho(x) = \\frac{1}{9} \\left[ (9x - 24x^2 + 16x^3) + (-9x + 24x^2 + 1 - 16x^3) \\right] = \\frac{1}{9}\n$$\nThe spectral radius is constant for all $\\theta \\in (0, \\pi/2]$. The worst-case two-grid convergence factor is therefore this constant value.\n$$\n\\rho_{\\mathrm{TG}} = \\sup_{\\theta \\in (0, \\pi/2]} \\rho(\\theta) = \\frac{1}{9}\n$$",
            "answer": "$$\\boxed{\\frac{1}{9}}$$"
        }
    ]
}