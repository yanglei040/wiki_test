{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握基于残差的误差估计，最好的方法莫过于亲自动手计算。本练习  提供了一个绝佳的起点，它要求我们为一种常用的非线性材料模型（可压缩Neo-Hookean模型）在一个简单的双单元网格上计算残差。通过这个实践，您将直接体验如何从一个给定的近似解（分片常数变形梯度）出发，计算单元内部残差（衡量动量方程的不满足程度）和单元边界上的跳跃残差（衡量牵引力连续条件的违背程度），这是构建任何残差型误差指示器的核心步骤。",
            "id": "3595950",
            "problem": "考虑一个由单位正方形给出的二维参考构型，其坐标 $(X,Y) \\in [0,1] \\times [0,1]$。该正方形被从 $(0,0)$ 到 $(1,1)$ 的对角边划分为两个三角形有限元：\n- 单元 $K_{1}$ 的顶点为 $(0,0)$、$(1,0)$、$(1,1)$。\n- 单元 $K_{2}$ 的顶点为 $(0,0)$、$(0,1)$、$(1,1)$。\n令 $E_{0}$ 表示 $K_{1}$ 和 $K_{2}$ 从 $(0,0)$ 到 $(1,1)$ 共享的内部边。\n\n该材料是一种可压缩 Neo-Hookean 固体，其储存能量密度为\n$$\nW(F) = \\frac{\\mu}{2}\\big(\\mathrm{tr}(C)-3\\big) - \\mu \\ln J + \\frac{\\lambda}{2}(\\ln J)^{2},\n$$\n其中 $F$ 是变形梯度，$C = F^{\\top}F$ 是右 Cauchy-Green 张量，$J = \\det(F)$，$\\mu, \\lambda$ 是 Lamé 参数。假设为平面应变运动学。第一 Piola–Kirchhoff 应力（FPK 应力）$P(F)$ 定义为 $P(F) = \\partial W/\\partial F$。\n\n假设一个分片仿射有限元位移场，其梯度是分片常数并等于以下值：\n$$\nF_{h}\\big|_{K_{1}} = \\begin{pmatrix} 1.1  0 \\\\ 0  1.0 \\end{pmatrix}, \\qquad\nF_{h}\\big|_{K_{2}} = \\begin{pmatrix} 0.9  0 \\\\ 0  1.0 \\end{pmatrix}.\n$$\n取材料参数 $\\mu = 80\\,\\mathrm{kPa}$ 和 $\\lambda = 120\\,\\mathrm{kPa}$。设参考构型中的体力为常数 $b = (0.4,-0.2)\\,\\mathrm{kN/m}^{3}$，并设外部边界上的给定面力为齐次的，即在所有 Neumann 边界段上 $t = (0,0)$。\n\n从参考构型中动量平衡的强形式出发，\n$$\n\\mathrm{Div}\\,P(F) + b = 0 \\quad \\text{在域内},\n$$\n以及 Neumann 边界上的面力边界条件，\n$$\nP(F)\\,n = t \\quad \\text{在边界上},\n$$\n推导计算单元残差和边跳跃所需的表达式，这些表达式定义了分片常数 $F_{h}$ 的基于残差的误差指示子：\n- 单元 $K$ 上的单元残差是矢量场 $R_{K} = \\mathrm{Div}\\,P(F_{h}) + b$。\n- 跨越由单元 $K^{+}$ 和 $K^{-}$ 共享的内部边 $E$ 的跳跃是矢量场 $J_{E} = P(F_{h}^{+})\\,n^{+} + P(F_{h}^{-})\\,n^{-}$，其中 $n^{\\pm}$ 是 $K^{\\pm}$ 在 $E$ 上的单位外法线。\n\n使用以下尺寸度量：\n- 对于每个单元，$h_{K}$ 是单元直径（$K$ 中任意两点之间的最长距离）。\n- 对于内部边 $E_{0}$，$h_{E_{0}}$ 是边长。\n\n将基于残差的指示子定义为\n$$\nr_{K} = h_{K}\\,\\|R_{K}\\|_{L^{2}(K)}, \\qquad\nj_{E_{0}} = h_{E_{0}}^{1/2}\\,\\|J_{E_{0}}\\|_{L^{2}(E_{0})},\n$$\n其中 $\\|\\cdot\\|_{L^{2}}$ 表示在指定集合上的 $L^{2}$-范数。对于此构型，使用在 $E_{0}$ 上从 $K_{1}$ 向外指向的单位法线 $n^{+} = \\frac{1}{\\sqrt{2}}(-1,\\,1)$，因此从 $K_{2}$ 向外指向的法线为 $n^{-} = -n^{+}$。\n\n使用这些定义，计算总指示子\n$$\n\\eta = \\Big(r_{K_{1}}^{2} + r_{K_{2}}^{2} + j_{E_{0}}^{2}\\Big)^{1/2}.\n$$\n将 $\\eta$ 的最终值以 $\\mathrm{kN/m}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "用户提供了一个在计算固体力学领域中定义明确的问题。该问题具有科学依据，内容完整，且所有提供的数据均一致。因此，该问题被认为是有效的，可以提供完整的解答。\n\n目标是计算总的基于残差的误差指示子 $\\eta = \\Big(r_{K_{1}}^{2} + r_{K_{2}}^{2} + j_{E_{0}}^{2}\\Big)^{1/2}$。这需要计算单元指示子 $r_{K}$ 和边指示子 $j_{E_{0}}$。\n\n第一 Piola-Kirchhoff (FPK) 应力 $P$ 是从储存能量密度 $W(F)$ 推导出来的，即 $P(F) = \\partial W/\\partial F$。对于给定的可压缩 Neo-Hookean 模型，\n$$\nW(F) = \\frac{\\mu}{2}\\big(\\mathrm{tr}(C)-3\\big) - \\mu \\ln J + \\frac{\\lambda}{2}(\\ln J)^{2}\n$$\nFPK 应力由以下标准公式给出：\n$$\nP(F) = \\mu F + (\\lambda \\ln J - \\mu) F^{-T}\n$$\n其中 $F$ 是变形梯度，$J = \\det(F)$，$\\mu, \\lambda$ 是 Lamé 参数。\n\n首先，我们计算单元残差指示子 $r_{K_1}$ 和 $r_{K_2}$。单元残差定义为 $R_{K} = \\mathrm{Div}\\,P(F_{h}) + b$。问题指定了分片常数的变形梯度 $F_h$。因此，应力张量 $P(F_h)$ 在每个单元内也是分片常数。常数张量的散度为零，即在每个单元 $K$ 的内部 $\\mathrm{Div}\\,P(F_{h}) = 0$。因此，单元残差简化为体力：\n$$\nR_{K_1} = b \\quad \\text{和} \\quad R_{K_2} = b\n$$\n体力给定为 $b = (0.4, -0.2)\\,\\mathrm{kN/m}^{3}$。因此，其大小的平方为：\n$$\n|b|^2 = (0.4)^2 + (-0.2)^2 = 0.16 + 0.04 = 0.20 \\, (\\mathrm{kN/m}^3)^2\n$$\n单元指示子为 $r_{K} = h_{K}\\,\\|R_{K}\\|_{L^{2}(K)}$，其平方为 $r_{K}^2 = h_{K}^2 \\|R_K\\|_{L^2(K)}^2$。由于 $R_K=b$ 在单元上是常数，其 $L^2$-范数平方为 $\\|R_K\\|_{L^2(K)}^2 = |b|^2 \\text{Area}(K)$。\n单元 $K_1$ 和 $K_2$ 分别是顶点为 $(0,0), (1,0), (1,1)$ 和 $(0,0), (0,1), (1,1)$ 的直角三角形。它们的面积都为 $1/2$。\n$$\n\\text{Area}(K_1) = \\text{Area}(K_2) = \\frac{1}{2} \\cdot 1 \\cdot 1 = \\frac{1}{2} \\, \\mathrm{m}^2\n$$\n直角三角形的直径 $h_K$ 是其斜边的长度。对于 $K_1$（顶点为 $(0,0)$、$(1,0)$、$(1,1)$），边长分别为 $1$、$1$ 和 $\\sqrt{(1-0)^2 + (1-0)^2} = \\sqrt{2}$。其直径为 $h_{K_1}=\\sqrt{2}\\,\\mathrm{m}$。类似地，对于 $K_2$（顶点为 $(0,0)$、$(0,1)$、$(1,1)$），其直径也是 $h_{K_2}=\\sqrt{2}\\,\\mathrm{m}$。\n现在我们可以计算单元指示子的平方：\n$$\nr_{K}^2 = h_K^2 |b|^2 \\text{Area}(K)\n$$\n对于单元 $K_1$ 和 $K_2$：\n$$\nr_{K_1}^2 = r_{K_2}^2 = (\\sqrt{2})^2 \\cdot 0.20 \\cdot \\frac{1}{2} = 2 \\cdot 0.20 \\cdot 0.5 = 0.20 \\, (\\mathrm{kN/m})^2\n$$\n\n接下来，我们计算内部边指示子 $j_{E_0}$。跳跃为 $J_{E_{0}} = P(F_{h}^{+})\\,n^{+} + P(F_{h}^{-})\\,n^{-}$。令 $K_1=K^+$，$K_2=K^-$，$F_1=F_h^+$，$F_2=F_h^-$，以及 $n^- = -n^+$，这变为：\n$$\nJ_{E_0} = (P(F_1) - P(F_2))n^+\n$$\n让我们使用 $\\mu = 80\\,\\mathrm{kPa}$ 和 $\\lambda = 120\\,\\mathrm{kPa}$ 计算应力张量 $P_1 = P(F_1)$ 和 $P_2 = P(F_2)$。\n\n对于单元 $K_1$：\n$F_1 = \\begin{pmatrix} 1.1  0 \\\\ 0  1.0 \\end{pmatrix}$。因此，$J_1 = \\det(F_1) = 1.1$ 且 $F_1^{-T} = \\begin{pmatrix} 1/1.1  0 \\\\ 0  1 \\end{pmatrix}$。\n$$\nP_1 = 80 \\begin{pmatrix} 1.1  0 \\\\ 0  1 \\end{pmatrix} + (120 \\ln(1.1) - 80) \\begin{pmatrix} 1/1.1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 88 + \\frac{120\\ln(1.1)-80}{1.1}  0 \\\\ 0  120\\ln(1.1) \\end{pmatrix}\n$$\n\n对于单元 $K_2$：\n$F_2 = \\begin{pmatrix} 0.9  0 \\\\ 0  1.0 \\end{pmatrix}$。因此，$J_2 = \\det(F_2) = 0.9$ 且 $F_2^{-T} = \\begin{pmatrix} 1/0.9  0 \\\\ 0  1 \\end{pmatrix}$。\n$$\nP_2 = 80 \\begin{pmatrix} 0.9  0 \\\\ 0  1 \\end{pmatrix} + (120 \\ln(0.9) - 80) \\begin{pmatrix} 1/0.9  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 72 + \\frac{120\\ln(0.9)-80}{0.9}  0 \\\\ 0  120\\ln(0.9) \\end{pmatrix}\n$$\n应力差为 $\\Delta P = P_1 - P_2 = \\text{diag}(\\Delta P_{11}, \\Delta P_{22})$：\n$$\n\\Delta P_{11} = \\left(88 + \\frac{120\\ln(1.1)-80}{1.1}\\right) - \\left(72 + \\frac{120\\ln(0.9)-80}{0.9}\\right) \\approx 56.60716\\,\\mathrm{kPa}\n$$\n$$\n\\Delta P_{22} = 120\\ln(1.1) - 120\\ln(0.9) = 120\\ln\\left(\\frac{1.1}{0.9}\\right) \\approx 24.08048\\,\\mathrm{kPa}\n$$\n法向量为 $n^+ = \\frac{1}{\\sqrt{2}}(-1, 1)^T$。跳跃向量沿边是常数：\n$$\nJ_{E_0} = \\Delta P n^+ = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -\\Delta P_{11} \\\\ \\Delta P_{22} \\end{pmatrix}\n$$\n跳跃向量大小的平方为：\n$$\n|J_{E_0}|^2 = \\frac{1}{2}(\\Delta P_{11}^2 + \\Delta P_{22}^2) \\approx \\frac{1}{2}((56.60716)^2 + (24.08048)^2) \\approx 1892.122 \\, (\\mathrm{kPa})^2\n$$\n内部边指示子 $j_{E_0}$ 的平方为 $j_{E_0}^2 = h_{E_0} \\|J_{E_0}\\|_{L^2(E_0)}^2$。由于 $J_{E_0}$ 是常数，$\\|J_{E_0}\\|_{L^2(E_0)}^2 = |J_{E_0}|^2 h_{E_0}$。因此：\n$$\nj_{E_0}^2 = h_{E_0} (|J_{E_0}|^2 h_{E_0}) = h_{E_0}^2 |J_{E_0}|^2\n$$\n边 $E_0$ 的长度为 $h_{E_0} = \\sqrt{2}\\,\\mathrm{m}$，所以 $h_{E_0}^2 = 2\\,\\mathrm{m}^2$。\n$$\nj_{E_0}^2 = (2 \\, \\mathrm{m}^2) \\cdot (1892.122 \\, (\\mathrm{kPa})^2) = (2 \\, \\mathrm{m}^2) \\cdot (1892.122 \\, (\\mathrm{kN/m^2})^2) \\approx 3784.245 \\, (\\mathrm{kN/m})^2\n$$\n\n最后，计算总指示子 $\\eta$：\n$$\n\\eta^2 = r_{K_1}^2 + r_{K_2}^2 + j_{E_0}^2 \\approx 0.20 + 0.20 + 3784.245 = 3784.645 \\, (\\mathrm{kN/m})^2\n$$\n$$\n\\eta = \\sqrt{3784.645} \\approx 61.519468 \\, \\mathrm{kN/m}\n$$\n四舍五入到四位有效数字，我们得到 $\\eta = 61.52\\,\\mathrm{kN/m}$。",
            "answer": "$$\n\\boxed{61.52}\n$$"
        },
        {
            "introduction": "残差指示器不仅能估计全局误差，更能作为强大的诊断工具，揭示有限元解中隐藏的数值病态问题。本练习  聚焦于近不可压缩材料模拟中一个典型难题：体积锁定与伪压力振荡。我们将分析一个使用不稳定的单元配对（等阶插值）得到的、带有棋盘格压力模式的假想解，并利用体积本构残差来识别和量化这种非物理行为，从而深刻理解为何选择满足Ladyzhenskaya–Babuška–Brezzi (LBB) 条件的单元至关重要。",
            "id": "3595875",
            "problem": "考虑小应变、平面应变、线性弹性固体，其位移场为 $u$，类压力场为 $p$，$p$ 是通过柯西应力的体积-偏应力分解引入的。应力分解为 $\\sigma = -p I + 2 \\mu \\varepsilon^{\\mathrm{dev}}(u)$，其中 $\\varepsilon(u) = \\frac{1}{2} \\left( \\nabla u + \\nabla u^{\\top} \\right)$ 是小应变张量，在二维情况下 $\\varepsilon^{\\mathrm{dev}}(u) = \\varepsilon(u) - \\frac{1}{2} \\operatorname{tr} \\varepsilon(u) I$，$\\mu$ 是剪切模量，$I$ 是单位张量。在用于近不可压缩弹性问题的位移-压力混合格式中，体积本构关系为 $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$，其中 $\\kappa$ 是体积模量。平衡方程的强形式为 $\\nabla \\cdot \\sigma + b = 0$，在域 $\\Omega$ 内成立，其中 $b$ 是体力，并带有适当的边界条件。\n\n可以从强形式和本构关系构建一个基于残差的误差指示子。特别地，单元体积残差定义为每个单元 $K$ 上的 $r_{p,K} := p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$，其中 $(u_h, p_h)$ 是有限元近似解。\n\n体积闭锁指的是在纯位移格式中，当 $\\kappa \\to \\infty$ 时发生的伪刚化和体积应变被抑制的现象。在不满足 Ladyzhenskaya–Babuška–Brezzi (LBB) 稳定条件的混合格式中（例如，对 $(u_h, p_h)$ 使用等阶双线性 $Q_1$–$Q_1$ 单元），可能会出现伪压力振荡，如棋盘格模式。\n\n考虑单位正方形域 $\\Omega = (0,1) \\times (0,1)$，其边界 $\\partial \\Omega$ 上承受均匀静水压力，面力为 $t = -p_{\\mathrm{ext}} n$，且无体力。材料参数为 $\\mu = 1$ 和 $\\kappa = 1000$（为简单起见已无量纲化）。在一个 $2 \\times 2$ 的结构化网格上，假设一个计算出的等阶混合解表现出以下单元场：\n- 体积应变近乎均匀：在每个单元中 $\\operatorname{tr} \\varepsilon(u_h) \\approx s$，其中 $s = 0.002$。\n- 压力场呈现棋盘格振荡：在左上和右下单元上 $p_h = +5$，在右上和左下单元上 $p_h = -5$。\n\n为这四个单元中的每一个定义 $r_{p,K}$，并从控制方程和本构关系出发，推理 $r_{p,K}$ 的大小和模式如何用于诊断伪压力振荡及其与体积闭锁的相互作用。\n\n下列哪个陈述是正确的？\n\nA. 在此场景中，$p_h$ 的符号交替将导致 $2 \\times 2$ 网格上 $r_{p,K}$ 的符号也发生大幅值交替，而这种交替模式是因违反 Ladyzhenskaya–Babuška–Brezzi 条件而引起的伪压力模式的标志；此外，$r_{p,K}$ 对此类振荡的敏感度随 $\\kappa$ 的增大而增加。\n\nB. 如果离散解恰好在单元内满足平衡方程 $\\nabla \\cdot \\sigma + b = 0$，那么 $r_{p,K}$ 必然在每个单元中都为零，因此基于残差的估计器无法检测到压力振荡。\n\nC. 对于近不可压缩区域的等阶 $Q_1$–$Q_1$ 插值，仅减小网格尺寸就能确保 $p_h$ 中的棋盘格模式消失，并且当 $h \\to 0$ 时 $r_{p,K} \\to 0$ 一致收敛。\n\nD. 如果 $r_{p,K}$ 在所有单元上都是一个正常数，这表明压力场是光滑的，并证明了混合格式已经消除了体积闭锁。\n\nE. 在相同的载荷和可比的网格分辨率下，将等阶单元对替换为 LBB 稳定的混合单元对（例如，Taylor–Hood），会得到单元上的 $p_h \\approx -\\kappa \\operatorname{tr} \\varepsilon(u_h)$，从而使 $r_{p,K}$ 趋近于零并消除交替模式。\n\n选择所有适用项。",
            "solution": "首先验证问题陈述，以确保其科学上合理、适定且客观。\n\n### 步骤 1：提取已知条件\n- **模型**：小应变、平面应变、线性弹性固体。\n- **格式**：位移-压力混合格式，场变量为 $u$ (位移) 和 $p$ (类压力)。\n- **应力-应变关系**：柯西应力 $\\sigma = -p I + 2 \\mu \\varepsilon^{\\mathrm{dev}}(u)$。\n- **应变张量**：$\\varepsilon(u) = \\frac{1}{2} \\left( \\nabla u + \\nabla u^{\\top} \\right)$。\n- **偏应变 (二维)**：$\\varepsilon^{\\mathrm{dev}}(u) = \\varepsilon(u) - \\frac{1}{2} \\operatorname{tr} \\varepsilon(u) I$。\n- **体积本构关系**：$p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$。\n- **常数**：$\\mu$ 是剪切模量，$\\kappa$ 是体积模量。\n- **平衡方程**：$\\nabla \\cdot \\sigma + b = 0$，在域 $\\Omega$ 内。\n- **误差指示子定义**：单元体积残差 $r_{p,K} := p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$，针对有限元近似解 $(u_h, p_h)$ 在单元 $K$ 上。\n- **场景**：\n    - 域：$\\Omega = (0,1) \\times (0,1)$。\n    - 载荷：均匀静水压力，面力 $t = -p_{\\mathrm{ext}} n$ 施加于 $\\partial \\Omega$。体力 $b=0$。\n    - 材料参数：$\\mu = 1$，$\\kappa = 1000$。\n    - 网格：$2 \\times 2$ 结构化网格。\n    - 有限元方法：等阶 ($Q_1$–$Q_1$) 混合格式。\n    - 计算解场：\n        - 体积应变：在每个单元中 $\\operatorname{tr} \\varepsilon(u_h) \\approx s = 0.002$。\n        - 压力：在左上和右下单元上 $p_h = +5$；在右上和左下单元上 $p_h = -5$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础**：该问题基于连续介质力学和近不可压缩弹性问题有限元法的标准、公认的原理。位移-压力($u-p$)混合格式、体积-偏应力分解、Ladyzhenskaya–Babuška–Brezzi (LBB) 条件以及基于残差的误差估计都是计算力学的核心概念。控制方程陈述正确。\n- **适定性**：该问题呈现了一个使用 LBB 不稳定单元对 ($Q_1$–$Q_1$) 求解近不可压缩问题的数值模拟的假设但现实的结果。所呈现的棋盘格压力场是这种不稳定性的经典表现。问题要求使用一个已定义的残差来分析这个给定的结果，这是一个适定的诊断任务。\n- **一致性和完整性**：该问题提供了计算残差并评估其行为所需的所有必要数据和定义。存在一个潜在的不一致之处：“静水压力”在物理上应导致负的体积应变 ($\\operatorname{tr} \\varepsilon(u)  0$)，而给定的计算解却具有正的体积应变 ($\\operatorname{tr} \\varepsilon(u_h) \\approx 0.002 > 0$)。然而，问题要求分析一个给定的“计算出的...解”，这个解可以是，并且在本例中确实是，物理上不正确的。任务是使用残差来诊断这种不正确性。这种不一致性是待分析的病态解的一部分，而不是问题陈述本身的缺陷。对于诊断目的而言，这是一个有效的“假设”情景。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。它描述了计算力学中的一个经典场景，并提出了一个关于误差分析的相关问题。现在可以进行求解过程。\n\n### 求解推导\n主要任务是分析体积残差 $r_{p,K}$，它被定义为在满足体积本构关系方面的单元误差。\n定义如下：\n$$r_{p,K} = p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$$\n我们获得了关于一个用等阶四边形单元 ($Q_1-Q_1$) 离散化的域的 $2 \\times 2$ 网格的以下信息：\n- 体积模量：$\\kappa = 1000$。\n- 体积应变近似恒定：$\\operatorname{tr} \\varepsilon(u_h) \\approx s = 0.002$。\n- 离散压力场 $p_h$ 呈现棋盘格模式。我们标记这些单元：\n    - $K_{TL}$ (左上) 和 $K_{BR}$ (右下)：$p_h = +5$。\n    - $K_{TR}$ (右上) 和 $K_{BL}$ (左下)：$p_h = -5$。\n\n我们现在可以计算每个单元的残差 $r_{p,K}$。\n\n对于 $p_h = +5$ 的单元 ($K_{TL}$ 和 $K_{BR}$):\n$$r_{p,K} \\approx 5 + (1000)(0.002) = 5 + 2 = 7$$\n\n对于 $p_h = -5$ 的单元 ($K_{TR}$ 和 $K_{BL}$):\n$$r_{p,K} \\approx -5 + (1000)(0.002) = -5 + 2 = -3$$\n\n均匀静水压力问题的理论解应该具有恒定的压力 $p = p_{\\mathrm{ext}}$ 和恒定的负体积应变 $\\operatorname{tr} \\varepsilon(u) = -p_{\\mathrm{ext}}/\\kappa$。对于精确解，体积本构关系 $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$ 是精确满足的，这意味着真实残差处处为零。\n\n我们基于给定的有限元解的计算表明，压力场 $p_h$ 中的棋盘格模式直接导致了残差场 $r_{p,K}$ 中出现大幅值的振荡模式。其值在约 $7$ 和 $-3$ 之间交替。这种非零的振荡残差表明数值解未能满足本构定律，并且这种失效与伪压力模式有关。这证明了残差 $r_{p,K}$ 的诊断能力。\n\n### 逐项分析\n\n**A. 在此场景中，$p_h$ 的符号交替将导致 $2 \\times 2$ 网格上 $r_{p,K}$ 的符号也发生大幅值交替，而这种交替模式是因违反 Ladyzhenskaya–Babuška–Brezzi 条件而引起的伪压力模式的标志；此外，$r_{p,K}$ 对此类振荡的敏感度随 $\\kappa$ 的增大而增加。**\n\n- 我们的计算显示 $r_{p,K}$ 在 $\\approx 7$ 和 $\\approx -3$ 之间交替。这是一种符号交替，且幅值很大。\n- 棋盘格压力模式是 $Q_1$–$Q_1$ 单元对的典型伪模式，已知该单元对违反 LBB 稳定条件。残差 $r_{p,K}$ 继承了这种模式，使其成为一个有效的指示子。\n- 残差为 $r_{p,K} = p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$。当 $\\kappa \\to \\infty$（不可压缩极限）时，近似条件 $\\operatorname{tr} \\varepsilon(u_h) = 0$ 的任何误差都会被大因子 $\\kappa$ 放大。这使得残差在近不可压缩区域成为体积误差的一个高度敏感的度量。\n因此，该陈述是对情况的正确而完整的描述。\n**结论：正确**\n\n**B. 如果离散解恰好在单元内满足平衡方程 $\\nabla \\cdot \\sigma + b = 0$，那么 $r_{p,K}$ 必然在每个单元中都为零，因此基于残差的估计器无法检测到压力振荡。**\n\n- 这个陈述混淆了两种不同的残差误差来源。平衡方程的残差是 $r_{\\sigma} := \\nabla \\cdot \\sigma_h + b$。体积残差是 $r_{p,K} := p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$。它们对应于问题强形式中的两个独立方程。\n- 一个数值解可以很好地满足一个方程，却不能满足另一个。具体来说，棋盘格压力模式之所以有问题，是因为它（几乎）位于离散梯度算子的零空间中，这意味着即使 $p_h$ 很大且振荡，$\\nabla \\cdot (-p_h I)$ 也可能很小。因此，平衡残差 $r_{\\sigma}$ 可能很小，而由于振荡的 $p_h$，本构残差 $r_{p,K}$ 却很大。\n- 前提并不导出结论。这两种残差是不同类型误差的独立指示子。\n**结论：不正确**\n\n**C. 对于近不可压缩区域的等阶 $Q_1$–$Q_1$ 插值，仅减小网格尺寸就能确保 $p_h$ 中的棋盘格模式消失，并且当 $h \\to 0$ 时 $r_{p,K} \\to 0$ 一致收敛。**\n\n- 这个陈述是错误的。LBB 条件是所选位移和压力有限元空间的一个属性，与网格尺寸 $h$ 无关（尽管 LBB 常数可能依赖于 $h$）。\n- 对于像 $Q_1$–$Q_1$ 这样的 LBB 不稳定单元对，当网格细化时，压力近似解不保证收敛到正确解。伪振荡通常会持续存在，并不会随着网格细化 ($h \\to 0$) 而消失。\n- 要消除棋盘格模式，必须切换到 LBB 稳定的单元对（例如 Taylor-Hood $Q_2-P_1$）或在变分格式中引入一个稳定项（例如 GLS 或 PSPG 方法）。仅靠网格细化不是一个补救措施。\n**结论：不正确**\n\n**D. 如果 $r_{p,K}$ 在所有单元上都是一个正常数，这表明压力场是光滑的，并证明了混合格式已经消除了体积闭锁。**\n\n- 一个非零残差 ($r_{p,K} = C  0$) 意味着数值解违反了体积本构定律，即 $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$。这表明解中存在误差，而不是成功。\n- 虽然一个恒定的残差可以排除特定的交替棋盘格模式，但它不能保证压力场是“光滑”或正确的。\n- 更重要的是，它并未证明体积闭锁被消除。体积闭锁是体积应变的伪抑制。如果发生闭锁，$\\operatorname{tr} \\varepsilon(u_h)$ 可能会被驱动到一个虚假的小值（例如 $\\approx 0$）。在这种情况下，$r_{p,K} \\approx p_h$。如果 $p_h$ 是常数，残差也将是常数，但这将是闭锁解的一个症状，而不是其不存在的证明。一个恒定的、非零的残差指向一个系统误差，而不是一个性态良好的解。\n**结论：不正确**\n\n**E. 在相同的载荷和可比的网格分辨率下，将等阶单元对替换为 LBB 稳定的混合单元对（例如，Taylor–Hood），会得到单元上的 $p_h \\approx -\\kappa \\operatorname{tr} \\varepsilon(u_h)$，从而使 $r_{p,K}$ 趋近于零并消除交替模式。**\n\n- 这描述了修复使用 $Q_1$–$Q_1$ 单元对时观察到的不稳定性的标准且正确的方法。\n- 一个 LBB 稳定的单元对，例如 Taylor-Hood（位移用 $Q_2$，压力用 $P_1$），为压力近似提供了必要的控制，防止了像棋盘格模式这样的伪、非物理模式。\n- 因此，使用稳定单元对的收敛数值方法将产生一个解 $(u_h, p_h)$，它是真解 $(u, p)$ 的一个良好近似。对于真解，$p = -\\kappa \\operatorname{tr} \\varepsilon(u)$。因此，计算出的解将满足 $p_h \\approx -\\kappa \\operatorname{tr} \\varepsilon(u_h)$。\n- 这直接意味着体积残差 $r_{p,K} = p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$ 将接近于零，而作为不稳定性症状的交替模式将会消失。\n**结论：正确**",
            "answer": "$$\\boxed{AE}$$"
        },
        {
            "introduction": "误差指示器的最终价值在于指导自适应网格加密，以最少的计算成本达到期望的精度。本综合练习  将带领您从误差估计理论迈向算法实践，设计一个基于残差衰减率的 $hp$ 自适应策略。您将学习如何利用多项式阶次 ($p$) 增加后局部残差的收敛速度来判断解的局部光滑性，并据此制定决策规则：对于光滑区域采用 $p$ 加密，而对于奇异性或陡峭梯度区域则采用 $h$ 加密，最终实现一个智能、高效的自适应求解流程。",
            "id": "3595939",
            "problem": "考虑一个占据域 $[0,L]$ 的杆的一维小应变线性弹性问题，其杨氏模量为 $E(x)$，横截面积为 $A(x)$，体力密度为 $b(x)$，在 $x=0$ 处有给定/规定位移 $u=0$，在 $x=L$ 处有给定/规定牵引力 $t(L)$。在忽略惯性项时，线性动量守恒的强形式为\n$$\n-\\frac{d}{dx}\\big(E(x)A(x)\\frac{du}{dx}\\big)=b(x) \\quad \\text{for } x\\in(0,L),\n$$\n其牵引力边界条件为\n$$\nE(L)A(L)\\frac{du}{dx}(L)=t(L).\n$$\n令 $u_{h,p}$ 表示在尺寸为 $h$ 的网格上，$p$ 阶多项式空间中的有限元近似解，令 $u_{h,p+1}$ 表示在同一网格上、给定单元的多项式次数增加1后的相应近似解。作用于检验函数 $v$ 的残差泛函 $R(u_{h,p})$ 可通过对强形式逐单元分部积分写为\n$$\nR(u_{h,p};v)=\\sum_{K}\\int_{K}\\left(b(x)+\\frac{d}{dx}\\big(E(x)A(x)\\frac{du_{h,p}}{dx}\\big)\\right)v(x)\\,dx+\\sum_{e\\in\\mathcal{E}_h}\\int_{e}\\big(\\llbracket E(x)A(x)\\frac{du_{h,p}}{dx} \\rrbracket - t(x)\\big)v(x)\\,ds,\n$$\n其中 $\\mathcal{E}_h$ 表示单元面的集合，$\\llbracket \\cdot \\rrbracket$ 是内部面上的跳跃项，$t(x)$ 是在诺伊曼(Neumann)边界上施加的牵引力。基于残差的后验误差指示子使用此残差的范数来估计离散误差。对每个单元 $K$，定义残差范数 $\\|R_K(u_{h,p})\\|$ 的一个可计算的代理量（例如，体积平衡残差的 $L^2$-范数加上面跳跃项的贡献，并由局部网格尺寸进行缩放），对 $\\|R_K(u_{h,p+1})\\|$ 也类似定义。\n\n从残差的定义以及弱形式中残差范数与能量误差之间的基本联系出发，推导出一个决策准则。该准则利用多项式加密下残差范数的局部衰减作为光滑度指示子。具体而言，从基本原理出发，论证为何对于单元 $K$ 上足够光滑的精确解，比率\n$$\n\\rho_K=\\frac{\\|R_K(u_{h,p+1})\\|}{\\|R_K(u_{h,p})\\|}\n$$\n在多项式加密下倾向于远小于1，而对于低正则性的解（例如，奇异点或在 $K$ 上未被良好解析的陡峭梯度），$\\rho_K$ 衰减缓慢并保持接近于1。利用这一点，为每个单元 $K$ 构建一个鲁棒的 $hp$-自适应决策策略，该策略有三种结果：\n- 当 $\\rho_K$ 表明衰减足够快时，选择 $p$-加密（增加多项式阶数）。\n- 当 $\\rho_K$ 表明衰减缓慢时，选择 $h$-加密（网格细分）。\n- 当单元已足够收敛，无需进一步加密时，选择不加密。\n\n你的算法必须仅使用作为输入的局部标量代理量 $\\|R_K(u_{h,p})\\|$ 和 $\\|R_K(u_{h,p+1})\\|$ 来实现，而无需访问完整的场变量。为使决策定量化，你必须引入：\n- 一个衰减阈值参数 $\\theta_p\\in(0,1)$，它规定了表示足够光滑性的最小相对衰减。\n- 一个残差下限 $\\varepsilon_{\\min}0$，使得如果 $\\|R_K(u_{h,p})\\|\\le \\varepsilon_{\\min}$，则该单元被视为已收敛，不应再加密。\n\n你的任务是：\n1. 从弱形式和基于残差的误差估计原理出发，论证决策规则的结构，不使用任何预设最终规则的简化公式。\n2. 实现一个程序，给定逐单元的残差范数对 $(\\|R_K(u_{h,p})\\|,\\|R_K(u_{h,p+1})\\|)$ 以及 $\\theta_p$ 和 $\\varepsilon_{\\min}$，输出以整数编码的逐单元决策：输出 $1$ 代表 $p$-加密， $0$ 代表 $h$-加密， $2$ 代表不加密。\n\n使用以下测试套件，其设计旨在探查光滑度检测、奇异行为、接近收敛和边界情况：\n- 测试用例1（两个单元，类光滑衰减）：$\\theta_p=0.6$, $\\varepsilon_{\\min}=10^{-7}$, $\\|R_K(u_{h,p})\\|=[10^{-1},2\\cdot 10^{-1}]$, $\\|R_K(u_{h,p+1})\\|=[2\\cdot 10^{-2},5\\cdot 10^{-2}]$。\n- 测试用例2（两个单元，表明非光滑性的缓慢衰减）：$\\theta_p=0.6$, $\\varepsilon_{\\min}=10^{-7}$, $\\|R_K(u_{h,p})\\|=[1,5\\cdot 10^{-1}]$, $\\|R_K(u_{h,p+1})\\|=[9\\cdot 10^{-1},4.5\\cdot 10^{-1}]$。\n- 测试用例3（两个单元，接近收敛）：$\\theta_p=0.6$, $\\varepsilon_{\\min}=10^{-7}$, $\\|R_K(u_{h,p})\\|=[10^{-8},5\\cdot 10^{-9}]$, $\\|R_K(u_{h,p+1})\\|=[10^{-9},2\\cdot 10^{-9}]$。\n- 测试用例4（三个单元，包含零残差和混合行为）：$\\theta_p=0.6$, $\\varepsilon_{\\min}=10^{-6}$, $\\|R_K(u_{h,p})\\|=[0,10^{-4},10^{-2}]$, $\\|R_K(u_{h,p+1})\\|=[0,5\\cdot 10^{-5},9\\cdot 10^{-3}]$。\n\n对每个测试用例，按顺序计算每个单元的决策，并将从测试用例1到测试用例4的所有决策连接成一个单一列表。最终的程序输出必须是包含这个连接后整数列表的单行文本，以逗号分隔、无空格且用方括号括起（例如，$[\\dots]$）。输出中没有物理单位；输出是按规定格式的整数列表。",
            "solution": "本任务是基于残差范数代理量的局部衰减，为 $hp$-自适应有限元分析推导并实现一个决策算法。对每个单元 $K$ 的决策可以是 $h$-加密（细分）、$p$-加密（多项式加密）或不加密。该决策基于所提供的局部残差范数代理量 $\\|R_K(u_{h,p})\\|$ 和 $\\|R_K(u_{h,p+1})\\|$，以及两个参数：衰减阈值 $\\theta_p$ 和残差下限 $\\varepsilon_{\\min}$。\n\n推导过程从有限元法（FEM）和后验误差估计的基本原理出发。\n\n**1. 残差在误差估计中的作用**\n\n出发点是控制一维弹性问题的弱形式。精确解 $u$ 满足变分方程：\n$$\na(u,v) = L(v) \\quad \\forall v \\in V\n$$\n其中 $V$ 是一个合适的无穷维检验函数空间，$a(\\cdot, \\cdot)$ 是代表内虚功的能量双线性形式，$L(\\cdot)$ 是代表外虚功的线性泛函。对于本问题，\n$$\na(w,z) = \\int_{0}^{L} E(x)A(x)\\frac{dw}{dx}\\frac{dz}{dx}\\,dx\n$$\n且\n$$\nL(v) = \\int_{0}^{L} b(x)v(x)\\,dx + t(L)v(L)\n$$\n有限元近似解 $u_{h,p}$ 在有限维子空间 $V_{h,p} \\subset V$ 中求解，并由伽辽金(Galerkin)方程定义：\n$$\na(u_{h,p}, v_h) = L(v_h) \\quad \\forall v_h \\in V_{h,p}\n$$\n离散误差定义为 $e = u - u_{h,p}$。将伽辽金方程从精确弱形式（其中 $v=v_h$）中减去，我们得到伽辽金正交性：\n$$\na(e, v_h) = a(u-u_{h,p}, v_h) = 0 \\quad \\forall v_h \\in V_{h,p}\n$$\n现在，考虑用空间 $V$ 中的任意函数 $v$ 来检验误差 $e$。我们有：\n$$\na(e,v) = a(u,v) - a(u_{h,p}, v) = L(v) - a(u_{h,p}, v)\n$$\n右端项 $L(v) - a(u_{h,p}, v)$ 定义了残差泛函 $R(u_{h,p};v)$ 在检验函数 $v$ 上的作用。对每个单元 $K$ 上的 $a(u_{h,p}, v)$ 进行分部积分，可以恢复问题描述中给出的残差表达式。这就得到了精确误差方程：\n$$\na(e,v) = R(u_{h,p};v) \\quad \\forall v \\in V\n$$\n这个基本方程表明误差 $e$ 是由残差 $R(u_{h,p})$ 驱动的。后验误差分析中的一个关键结果是，误差的能量范数 $\\|e\\|_{E} = \\sqrt{a(e,e)}$ 与残差泛函的某个适当范数是等价的。这种等价性使我们能够使用一个可计算的残差范数作为真实误差的估计（一个指示子）。问题提供了 $\\|R_K(u_{h,p})\\|$ 作为每个单元 $K$ 上此范数的可计算的局部代理量。全局误差则通过对局部贡献求和来估计：$\\|e\\|_{E}^2 \\approx \\sum_{K} \\|R_K(u_{h,p})\\|^2$。\n\n**2. 误差收敛性与解的正则性**\n\n$hp$-自适应的核心思想是选择局部最高效的加密类型（$h$ 或 $p$）。这个选择取决于精确解 $u$ 的局部正则性（光滑性）。\n\n-   **光滑解（高正则性）：** 如果精确解 $u$ 在单元 $K$ 上是解析的（无穷次可微），那么增加近似解的多项式阶数 $p$ 会导致误差的指数收敛。单元 $K$ 上的能量范数误差表现为：\n    $$\n    \\|e\\|_{E,K} \\sim \\exp(-\\gamma p)\n    $$\n    其中常数 $\\gamma  0$ 取决于 $u$ 的解析性质。这被称为谱收敛，速度极快。因此，作为误差估计的残差范数代理量 $\\|R_K(u_{h,p})\\|$ 预期会随 $p$ 呈指数衰减。\n\n-   **非光滑解（低正则性）：** 如果解 $u$ 在单元 $K$ 上具有奇异性（例如，由于尖角、材料属性突变或点荷载，尽管这些并未明确出现在此一维问题中，但可作为一般性动机），其正则性较低。对此类解，$p$-加密仅能产生缓慢且会饱和的代数收敛率。更有效的策略是 $h$-加密，它通过细分单元来隔离奇异点。这使得在新生成的较小单元上，解的光滑部分可以用多项式有效逼近，从而恢复相对于网格尺寸 $h$ 的最佳代数收敛率。\n\n**3. 决策准则**\n\n局部衰减比 $\\rho_K$ 就是为探查这种收敛行为而设计的。\n$$\n\\rho_K = \\frac{\\|R_K(u_{h,p+1})\\|}{\\|R_K(u_{h,p})\\|}\n$$\n该比率量化了将多项式阶数从 $p$ 增加到 $p+1$ 时，局部残差（也即误差）减小的程度。\n\n-   如果解是局部光滑的，我们预期指数收敛。连续残差的比值将近似为常数且远小于1：\n    $$\n    \\rho_K \\approx \\frac{C \\exp(-\\gamma(p+1))}{C \\exp(-\\gamma p)} = \\exp(-\\gamma) \\ll 1\n    $$\n    较小的 $\\rho_K$ 值表明 $p$-加密非常有效。\n\n-   如果解是局部非光滑的，$p$-加密是低效的。残差将缓慢衰减，比率 $\\rho_K$ 会接近于1。较大的 $\\rho_K$ 值表明 $p$-加密不是最优选择，通过排除法，应首选 $h$-加密。\n\n这一推理直接导出了决策算法的结构。\n\n**算法：**\n每个单元 $K$ 的决策是使用一个两步分层逻辑做出的。\n\n**步骤 1：检查收敛性**\n自适应算法必须有一个停止准则，以避免对误差已经足够小的单元进行加密。残差下限 $\\varepsilon_{\\min}$ 正是为此目的而设。第一步检查总是：\n-   如果 $\\|R_K(u_{h,p})\\| \\le \\varepsilon_{\\min}$，该单元对总误差的贡献可以忽略不计。无需进一步加密。\n    -   决策：**不加密**（编码为 $2$）。\n\n**步骤 2：选择加密类型**\n如果单元尚未收敛（即 $\\|R_K(u_{h,p})\\|  \\varepsilon_{\\min}$），我们必须在 $h$-加密和 $p$-加密之间做出选择。此时便需要使用光滑度指示子 $\\rho_K$ 和衰减阈值 $\\theta_p$。\n-   我们计算比率 $\\rho_K$。注意，由于 $\\|R_K(u_{h,p})\\|  \\varepsilon_{\\min}$ 且问题给定 $\\varepsilon_{\\min}  0$，分母 $\\|R_K(u_{h,p})\\|$ 保证不为零。\n-   我们将 $\\rho_K$ 与阈值 $\\theta_p \\in (0,1)$进行比较：\n    -   如果 $\\rho_K  \\theta_p$：观测到的衰减是“快速的”，表明解是局部光滑的，并且能从多项式加密中受益。\n        -   决策：**$p$-加密**（编码为 $1$）。\n    -   如果 $\\rho_K \\ge \\theta_p$：观测到的衰减是“缓慢的”，表明解具有低正则性，$p$-加密在此处效率低下。\n        -   决策：**$h$-加密**（编码为 $0$）。\n\n这种逻辑顺序——首先检查收敛性，然后对未收敛的单元评估光滑性——为 $hp$-自适应加密提供了一个鲁棒且有物理动机的策略。$\\|R_K(u_{h,p})\\|=0$ 的特殊情况被第一步正确处理，因为对于任何 $\\varepsilon_{\\min}0$ 都有 $0 \\le \\varepsilon_{\\min}$，从而导致“不加密”的决策，这对于初始残差为零的单元是合适的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements an hp-adaptive decision policy for finite element analysis.\n\n    The function processes a series of test cases, each containing element-wise\n    residual norm proxies for polynomial degrees p and p+1. Based on a decay\n    threshold (theta_p) and a residual floor (eps_min), it decides for each\n    element whether to perform p-refinement, h-refinement, or no refinement.\n\n    Decision Logic:\n    - 2 (No Refinement): If the initial residual norm ||R_K(u_h,p)|| is below eps_min.\n    - 1 (p-refinement): If not converged and the decay ratio rho_K is less than theta_p.\n    - 0 (h-refinement): If not converged and the decay ratio rho_K is not less than theta_p.\n\n    The decay ratio is rho_K = ||R_K(u_h,p+1)|| / ||R_K(u_h,p)||.\n    \"\"\"\n    test_cases = [\n        {\n            \"theta_p\": 0.6,\n            \"eps_min\": 1e-7,\n            \"R_p\": [1e-1, 2e-1],\n            \"R_p1\": [2e-2, 5e-2]\n        },\n        {\n            \"theta_p\": 0.6,\n            \"eps_min\": 1e-7,\n            \"R_p\": [1.0, 5e-1],\n            \"R_p1\": [9e-1, 4.5e-1]\n        },\n        {\n            \"theta_p\": 0.6,\n            \"eps_min\": 1e-7,\n            \"R_p\": [1e-8, 5e-9],\n            \"R_p1\": [1e-9, 2e-9]\n        },\n        {\n            \"theta_p\": 0.6,\n            \"eps_min\": 1e-6,\n            \"R_p\": [0.0, 1e-4, 1e-2],\n            \"R_p1\": [0.0, 5e-5, 9e-3]\n        }\n    ]\n\n    all_decisions = []\n    for case in test_cases:\n        theta_p = case[\"theta_p\"]\n        eps_min = case[\"eps_min\"]\n        R_p_list = case[\"R_p\"]\n        R_p1_list = case[\"R_p1\"]\n\n        for R_p, R_p1 in zip(R_p_list, R_p1_list):\n            # Step 1: Check for convergence. If the residual is already below the\n            # tolerance floor, no refinement is needed.\n            if R_p = eps_min:\n                decision = 2  # No refinement\n            else:\n                # Step 2: Since not converged, decide between h- and p-refinement.\n                # The condition R_p > eps_min > 0 ensures R_p is not zero.\n                rho_K = R_p1 / R_p\n                \n                # Compare the decay ratio to the smoothness threshold.\n                if rho_K  theta_p:\n                    decision = 1  # p-refinement (fast decay)\n                else:\n                    decision = 0  # h-refinement (slow decay)\n            \n            all_decisions.append(decision)\n\n    # The final output must be a single string representing the list of integers.\n    print(f\"[{','.join(map(str, all_decisions))}]\")\n\n# The code above produces the final answer when run.\n# Final Answer: [1,1,0,0,2,2,2,1,0]\n# Replacing the code with the answer as per instructions.\n```\n$$\\boxed{[1,1,0,0,2,2,2,1,0]}$$"
        }
    ]
}