{
    "hands_on_practices": [
        {
            "introduction": "理解分层基函数的最佳方式莫过于亲手使用它们进行计算。这个练习将引导你使用一个p-版本分层基函数，对一个已知的二次函数场进行插值。通过这个过程，你将具体地体验到分层基的核心特性：低阶系数（如顶点值）被首先确定，并且在引入高阶模态（如边模态）时，这些低阶系数保持不变，这正是“分层”思想的精髓所在。",
            "id": "3570981",
            "problem": "考虑参考三角形 $\\hat{T}=\\{(x,y)\\in\\mathbb{R}^2:\\, x\\ge 0,\\, y\\ge 0,\\, x+y\\le 1\\}$，其重心坐标为 $\\lambda_1=1-x-y$, $\\lambda_2=x$, $\\lambda_3=y$。一个最高为 $p=2$ 次多项式阶的分层 $p$ 型三角形基由以下模式定义：\n- 顶点模式：$\\psi_1=\\lambda_1$, $\\psi_2=\\lambda_2$, $\\psi_3=\\lambda_3$。\n- 2阶边模式：在边 $(1,2)$ 上为 $\\psi_4=4\\,\\lambda_1\\lambda_2$，在边 $(2,3)$ 上为 $\\psi_5=4\\,\\lambda_2\\lambda_3$，在边 $(3,1)$ 上为 $\\psi_6=4\\,\\lambda_3\\lambda_1$。\n\n使用一个分层节点插值算子，并按顺序应用以下自由度：\n- 在顶点 $V_1=(0,0)$、$V_2=(1,0)$ 和 $V_3=(0,1)$ 处的值。\n- 在边中点 $M_{12}=\\left(\\frac{1}{2},0\\right)$、$M_{23}=\\left(\\frac{1}{2},\\frac{1}{2}\\right)$ 和 $M_{31}=\\left(0,\\frac{1}{2}\\right)$ 处的值。\n\n对于二次场 $u(x,y)=x^2-xy+y^2$，通过在上述自由度上按分层顺序强制插值，确定分层展开式\n$$\nI_2 u(x,y)=\\sum_{i=1}^{6} c_i\\,\\psi_i(x,y)\n$$\n中的系数 $c_1,\\dots,c_6$。以 $1\\times 6$ 行向量 $\\left(c_1, c_2, c_3, c_4, c_5, c_6\\right)$ 的形式报告你的答案，使用精确值。无需四舍五入，且不涉及单位。",
            "solution": "该问题有效。这是一个计算固体力学领域中的适定问题，特别涉及有限元法。所有定义、数据和条件在科学上都是合理的、一致的和完整的，允许得到唯一解。\n\n目标是找到二次场 $u(x,y)=x^2-xy+y^2$ 在参考三角形上分层 $p$ 型展开式的系数 $c_1, \\dots, c_6$。展开式由下式给出\n$$\nI_2 u(x,y)=\\sum_{i=1}^{6} c_i\\,\\psi_i(x,y)\n$$\n其中系数是通过在一组分层节点上强制插值来确定的。该方法依赖于从最低多项式阶开始，顺序确定系数。\n\n首先，我们确定插值节点以及函数 $u(x,y)$ 和重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 的相应值。重心坐标定义为 $\\lambda_1=1-x-y$, $\\lambda_2=x$, $\\lambda_3=y$。\n\n插值点（自由度）是：\n- 顶点：$V_1=(0,0)$, $V_2=(1,0)$, $V_3=(0,1)$。\n- 边中点：$M_{12}=\\left(\\frac{1}{2},0\\right)$, $M_{23}=\\left(\\frac{1}{2},\\frac{1}{2}\\right)$, $M_{31}=\\left(0,\\frac{1}{2}\\right)$。\n\n让我们计算函数 $u(x,y) = x^2-xy+y^2$ 在这些节点处的值：\n- $u(V_1) = u(0,0) = 0^2 - (0)(0) + 0^2 = 0$。\n- $u(V_2) = u(1,0) = 1^2 - (1)(0) + 0^2 = 1$。\n- $u(V_3) = u(0,1) = 0^2 - (0)(1) + 1^2 = 1$。\n- $u(M_{12}) = u\\left(\\frac{1}{2},0\\right) = \\left(\\frac{1}{2}\\right)^2 - \\left(\\frac{1}{2}\\right)(0) + 0^2 = \\frac{1}{4}$。\n- $u(M_{23}) = u\\left(\\frac{1}{2},\\frac{1}{2}\\right) = \\left(\\frac{1}{2}\\right)^2 - \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4} - \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{4}$。\n- $u(M_{31}) = u\\left(0,\\frac{1}{2}\\right) = 0^2 - (0)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4}$。\n\n接下来，我们计算这些节点处的重心坐标：\n- $V_1=(0,0) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = (1,0,0)$。\n- $V_2=(1,0) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = (0,1,0)$。\n- $V_3=(0,1) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = (0,0,1)$。\n- $M_{12}=\\left(\\frac{1}{2},0\\right) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = \\left(\\frac{1}{2},\\frac{1}{2},0\\right)$。\n- $M_{23}=\\left(\\frac{1}{2},\\frac{1}{2}\\right) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = \\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$。\n- $M_{31}=\\left(0,\\frac{1}{2}\\right) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = \\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$。\n\n分层插值分阶段进行。\n\n**阶段1：确定顶点系数 ($c_1, c_2, c_3$)**\n我们首先考虑线性插值函数 $I_1 u(x,y) = c_1\\psi_1 + c_2\\psi_2 + c_3\\psi_3$，并在顶点处强制插值。\n基函数为 $\\psi_1=\\lambda_1$, $\\psi_2=\\lambda_2$, $\\psi_3=\\lambda_3$。这些是标准的线性形函数，它们具有性质 $\\psi_i(V_j) = \\delta_{ij}$ (克罗内克 delta)。\n- 在 $V_1$ 处：$I_1 u(V_1) = c_1\\psi_1(V_1) + c_2\\psi_2(V_1) + c_3\\psi_3(V_1) = c_1(1) + c_2(0) + c_3(0) = c_1$。\n  强制 $I_1 u(V_1) = u(V_1)$，我们得到 $c_1 = 0$。\n- 在 $V_2$ 处：$I_1 u(V_2) = c_1\\psi_1(V_2) + c_2\\psi_2(V_2) + c_3\\psi_3(V_2) = c_1(0) + c_2(1) + c_3(0) = c_2$。\n  强制 $I_1 u(V_2) = u(V_2)$，我们得到 $c_2 = 1$。\n- 在 $V_3$ 处：$I_1 u(V_3) = c_1\\psi_1(V_3) + c_2\\psi_2(V_3) + c_3\\psi_3(V_3) = c_1(0) + c_2(0) + c_3(1) = c_3$。\n  强制 $I_1 u(V_3) = u(V_3)$，我们得到 $c_3 = 1$。\n\n因此，顶点系数为 $c_1=0$, $c_2=1$, $c_3=1$。插值函数的线性部分是 $I_1 u = (0)\\lambda_1 + (1)\\lambda_2 + (1)\\lambda_3 = \\lambda_2+\\lambda_3 = x+y$。\n\n**阶段2：确定边系数 ($c_4, c_5, c_6$)**\n现在我们考虑完整的二次插值函数 $I_2 u = I_1 u + c_4\\psi_4 + c_5\\psi_5 + c_6\\psi_6$。\n分层基的关键性质是，高阶模式（边模式 $\\psi_4, \\psi_5, \\psi_6$）在低阶近似的节点（顶点 $V_1, V_2, V_3$）处为零。例如，$\\psi_4=4\\lambda_1\\lambda_2$ 在 $V_1$（其中 $\\lambda_2=0$）、$V_2$（其中 $\\lambda_1=0$）和 $V_3$（其中两者都为零）处为零。这确保了确定 $c_4, c_5, c_6$ 不会改变在顶点处已经强制执行的插值条件。\n我们通过在边中点强制插值来确定边系数。\n\n- 对于 $c_4$（边 1-2）：我们使用中点 $M_{12}$。插值条件是 $I_2 u(M_{12}) = u(M_{12})$。\n  $I_1 u(M_{12}) + c_4\\psi_4(M_{12}) + c_5\\psi_5(M_{12}) + c_6\\psi_6(M_{12}) = u(M_{12})$。\n  在 $M_{12}$ 处，重心坐标为 $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2},\\frac{1}{2},0)$。\n  边模式 $\\psi_5=4\\lambda_2\\lambda_3$ 和 $\\psi_6=4\\lambda_3\\lambda_1$ 为零，因为 $\\lambda_3=0$。\n  模式 $\\psi_4(M_{12}) = 4\\lambda_1\\lambda_2 = 4\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1$。\n  线性插值函数的值为 $I_1 u(M_{12}) = \\lambda_2(M_{12}) + \\lambda_3(M_{12}) = \\frac{1}{2} + 0 = \\frac{1}{2}$。\n  方程变为：$\\frac{1}{2} + c_4(1) = u(M_{12}) = \\frac{1}{4}$。\n  解出 $c_4$：$c_4 = \\frac{1}{4} - \\frac{1}{2} = -\\frac{1}{4}$。\n\n- 对于 $c_5$（边 2-3）：我们使用中点 $M_{23}$。条件是 $I_2 u(M_{23}) = u(M_{23})$。\n  $I_1 u(M_{23}) + c_4\\psi_4(M_{23}) + c_5\\psi_5(M_{23}) + c_6\\psi_6(M_{23}) = u(M_{23})$。\n  在 $M_{23}$ 处，$(\\lambda_1, \\lambda_2, \\lambda_3) = (0,\\frac{1}{2},\\frac{1}{2})$。\n  边模式 $\\psi_4$ 和 $\\psi_6$ 为零，因为 $\\lambda_1=0$。\n  模式 $\\psi_5(M_{23}) = 4\\lambda_2\\lambda_3 = 4\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1$。\n  线性插值函数的值为 $I_1 u(M_{23}) = \\lambda_2(M_{23}) + \\lambda_3(M_{23}) = \\frac{1}{2} + \\frac{1}{2} = 1$。\n  方程变为：$1 + c_5(1) = u(M_{23}) = \\frac{1}{4}$。\n  解出 $c_5$：$c_5 = \\frac{1}{4} - 1 = -\\frac{3}{4}$。\n\n- 对于 $c_6$（边 3-1）：我们使用中点 $M_{31}$。条件是 $I_2 u(M_{31}) = u(M_{31})$。\n  $I_1 u(M_{31}) + c_4\\psi_4(M_{31}) + c_5\\psi_5(M_{31}) + c_6\\psi_6(M_{31}) = u(M_{31})$。\n  在 $M_{31}$ 处，$(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2},0,\\frac{1}{2})$。\n  边模式 $\\psi_4$ 和 $\\psi_5$ 为零，因为 $\\lambda_2=0$。\n  模式 $\\psi_6(M_{31}) = 4\\lambda_3\\lambda_1 = 4\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1$。\n  线性插值函数的值为 $I_1 u(M_{31}) = \\lambda_2(M_{31}) + \\lambda_3(M_{31}) = 0 + \\frac{1}{2} = \\frac{1}{2}$。\n  方程变为：$\\frac{1}{2} + c_6(1) = u(M_{31}) = \\frac{1}{4}$。\n  解出 $c_6$：$c_6 = \\frac{1}{4} - \\frac{1}{2} = -\\frac{1}{4}$。\n\n分层系数集为：$c_1=0$, $c_2=1$, $c_3=1$, $c_4=-\\frac{1}{4}$, $c_5=-\\frac{3}{4}$, $c_6=-\\frac{1}{4}$。\n\n验证：由六个基函数 $\\{\\psi_i\\}_{i=1}^6$ 张成的空间是三角形上所有二次多项式的空间 $P_2(\\hat{T})$。由于给定函数 $u(x,y)=x^2-xy+y^2$ 是一个二次多项式，其在该空间中的插值必须是精确的。让我们通过重构多项式来确认。\n$I_2 u = c_1\\lambda_1 + c_2\\lambda_2 + c_3\\lambda_3 + c_4(4\\lambda_1\\lambda_2) + c_5(4\\lambda_2\\lambda_3) + c_6(4\\lambda_3\\lambda_1)$\n$I_2 u = (1)\\lambda_2 + (1)\\lambda_3 - \\frac{1}{4}(4\\lambda_1\\lambda_2) - \\frac{3}{4}(4\\lambda_2\\lambda_3) - \\frac{1}{4}(4\\lambda_3\\lambda_1)$\n$I_2 u = \\lambda_2 + \\lambda_3 - \\lambda_1\\lambda_2 - 3\\lambda_2\\lambda_3 - \\lambda_3\\lambda_1$\n代入 $\\lambda_1=1-x-y$, $\\lambda_2=x$, $\\lambda_3=y$：\n$I_2 u(x,y) = x + y - (1-x-y)x - 3xy - y(1-x-y)$\n$I_2 u(x,y) = x + y - (x-x^2-xy) - 3xy - (y-xy-y^2)$\n$I_2 u(x,y) = x + y - x + x^2 + xy - 3xy - y + xy + y^2$\n$I_2 u(x,y) = x^2 + y^2 + (1-3+1)xy = x^2 - xy + y^2 = u(x,y)$。\n重构是精确的，这验证了计算出的系数。\n\n最终答案是系数行向量 $(c_1, c_2, c_3, c_4, c_5, c_6)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1  1  -\\frac{1}{4}  -\\frac{3}{4}  -\\frac{1}{4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了分层插值的基本机制后，我们将探讨这些基函数在有限元方法中的核心应用：构建单元矩阵。这个实践揭示了采用分层基函数最显著的优势之一。我们将看到，如何通过将基函数依据其几何支集（顶点、边、内部）进行分类，并利用它们的正交性质，从而在刚度矩阵中自然地产生一种特定的块稀疏结构。 这种结构对于发展如静态凝聚等高效求解策略至关重要。",
            "id": "3570949",
            "problem": "考虑单个等参四边形有限元，其参考域为方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$，通过仿射映射到物理单元，因此雅可比矩阵为常数且缩放因子是可分离的。采用一阶索伯列夫空间($H^1$)中的标量场 $u$ 作为小应变线性弹性中位移分量的代理，并将刚度和质量的局部双线性形式定义为\n$$\na(u,v) = \\int_{\\hat{\\Omega}} \\kappa \\, \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta, \n\\qquad \nm(u,v) = \\int_{\\hat{\\Omega}} \\rho \\, u \\, v \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta,\n$$\n其中 $\\kappa > 0$ 是一个类扩散模量的常数，$\\rho > 0$ 是一个类密度系数的常数。设分层p-型张量积基由区间 $[-1,1]$ 上的一维分层模式构造而成：\n- 顶点模式 $l_{1}(\\xi) = \\frac{1 - \\xi}{2}$ 和 $l_{2}(\\xi) = \\frac{1 + \\xi}{2}$ 产生四个角点函数 $L_{i}(\\xi,\\eta) = l_{\\alpha}(\\xi) \\, l_{\\beta}(\\eta)$，其中 $\\alpha,\\beta \\in \\{1,2\\}$。\n- 每个一维边上的边模式为 $\\psi_{k}(\\xi)$，$k = 2,3,\\dots,p$，其定义为在 $\\xi = \\pm 1$ 处为零，并分层地张成次数递增的多项式；在 $\\eta$ 方向上同样如此。一个具体的选择可以是勒让德多项式的差分 $\\psi_{k}(\\xi) = c_{k}\\left(P_{k}(\\xi)-P_{k-2}(\\xi)\\right)$，其中 $c_{k}>0$ 是归一化常数，$P_{n}$ 是n阶勒让德多项式，不过下面的推导对于任何在端点处为零的分层 $\\psi_{k}$ 都成立。\n- 内部模式是张量积 $\\Psi_{r,s}(\\xi,\\eta) = \\psi_{r}(\\xi)\\,\\psi_{s}(\\eta)$，其中 $r,s \\in \\{2,3,\\dots,p\\}$。\n\n根据模式的几何支撑对其进行分类：顶点模式 $V$，边模式 $E$（按边和阶数组织）和内部模式 $I$。利用上述基本弱形式和张量积基的可分离性，推导局部单元刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$，用分层基及其导数的一维内积表示，并揭示其克罗内克积/和结构。然后，当按 $V$–$E$–$I$ 分类排序时，识别并解释 $\\mathbf{K}$ 和 $\\mathbf{M}$ 的块结构，说明哪些块是对角的，哪些因构造而为零，以及哪些块包含由张量积可分离性和边界值为零的性质引起的非零耦合。\n\n最后，对于多项式阶数 $p \\geq 2$，给出在该分类下此四边形单元的分层自由度总数 $N(p)$ 的一个闭式解析表达式。将 $N(p)$ 表示为 $p$ 的简化函数。",
            "solution": "该问题陈述是p-型有限元法中的一个有效练习。它在计算固体力学方面有科学依据，数学上是适定的、客观且自洽的。所有定义和条件都是标准的，并允许一个唯一、可推导的解。我们将按要求进行推导和分析。\n\n解答分为三个部分：\n1. 用一维内积和克罗内克积/和推导局部刚度与质量矩阵。\n2. 在基函数按顶点-边-内部 (V-E-I) 排序下，分析这些矩阵的块结构。\n3. 推导自由度总数 $N(p)$。\n\n**第一部分：单元矩阵的推导**\n\n设 $[-1,1]$ 上的完备一维分层基表示为 $\\{\\phi_i(\\xi)\\}_{i=0}^{p}$，其中 $\\phi_0(\\xi) = l_1(\\xi)$，$\\phi_1(\\xi) = l_2(\\xi)$，且 $\\{\\phi_i(\\xi)\\}_{i=2}^{p} = \\{\\psi_i(\\xi)\\}_{i=2}^{p}$。一维基函数的总数为 $p+1$。$\\hat{\\Omega}$ 上的二维基是这些一维基的张量积：$\\{ N_k(\\xi, \\eta) \\} = \\{ \\phi_i(\\xi) \\phi_j(\\eta) \\}_{i,j=0}^{p}$。\n\n我们定义参考区间 $[-1,1]$ 上关于基 $\\{\\phi_i\\}$ 的一维质量矩阵和刚度矩阵。设这些一维矩阵的分量为：\n$$\nM^1_{ij} = \\int_{-1}^{1} \\phi_i(x) \\phi_j(x) \\, \\mathrm{d}x\n$$\n$$\nK^1_{ij} = \\int_{-1}^{1} \\phi'_i(x) \\phi'_j(x) \\, \\mathrm{d}x\n$$\n其中 ' 表示对自变量求导，例如 $\\phi'_i(x) = \\frac{\\mathrm{d}\\phi_i}{\\mathrm{d}x}(x)$。\n\n标量场 $u$ 近似为二维基函数的线性组合：\n$$\nu(\\xi, \\eta) = \\sum_{k} u_k N_k(\\xi, \\eta) = \\sum_{i=0}^{p} \\sum_{j=0}^{p} u_{ij} \\phi_i(\\xi) \\phi_j(\\eta)\n$$\n单元质量矩阵 $\\mathbf{M}$ 和刚度矩阵 $\\mathbf{K}$ 的分量分别由 $M_{kl} = m(N_k, N_l)$ 和 $K_{kl} = a(N_k, N_l)$ 给出。设第 $k$ 个基函数对应于索引对 $(i,j)$，第 $l$ 个基函数对应于 $(p,q)$。因此，$N_k(\\xi, \\eta) = \\phi_i(\\xi) \\phi_j(\\eta)$ 且 $N_l(\\xi, \\eta) = \\phi_p(\\xi) \\phi_q(\\eta)$。\n\n对于质量矩阵的元素，我们有：\n$$\nM_{(i,j),(p,q)} = m(\\phi_i(\\xi)\\phi_j(\\eta), \\phi_p(\\xi)\\phi_q(\\eta)) = \\int_{-1}^{1}\\int_{-1}^{1} \\rho (\\phi_i(\\xi)\\phi_j(\\eta)) (\\phi_p(\\xi)\\phi_q(\\eta)) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\n由于 $\\rho$ 是常数且积分是可分离的：\n$$\nM_{(i,j),(p,q)} = \\rho \\left( \\int_{-1}^{1} \\phi_i(\\xi)\\phi_p(\\xi) \\, \\mathrm{d}\\xi \\right) \\left( \\int_{-1}^{1} \\phi_j(\\eta)\\phi_q(\\eta) \\, \\mathrm{d}\\eta \\right) = \\rho \\, M^1_{ip} \\, M^1_{jq}\n$$\n这个结构正是克罗内克积 ($\\otimes$) 的定义。如果我们按 $\\eta$ 索引变化最快的顺序排列基函数，则完整的质量矩阵为：\n$$\n\\mathbf{M} = \\rho (\\mathbf{M}^1 \\otimes \\mathbf{M}^1)\n$$\n\n对于刚度矩阵的元素，我们首先计算梯度：\n$$\n\\nabla N_k = \\nabla(\\phi_i(\\xi)\\phi_j(\\eta)) = \\begin{pmatrix} \\phi'_i(\\xi)\\phi_j(\\eta) \\\\ \\phi_i(\\xi)\\phi'_j(\\eta) \\end{pmatrix}, \\quad \\nabla N_l = \\begin{pmatrix} \\phi'_p(\\xi)\\phi_q(\\eta) \\\\ \\phi_p(\\xi)\\phi'_q(\\eta) \\end{pmatrix}\n$$\n刚度双线性形式的被积函数是 $\\nabla N_k \\cdot \\nabla N_l = \\phi'_i\\phi'_p\\phi_j\\phi_q + \\phi_i\\phi_p\\phi'_j\\phi'_q$。\n$$\nK_{(i,j),(p,q)} = a(N_k, N_l) = \\kappa \\int_{-1}^{1}\\int_{-1}^{1} (\\phi'_i(\\xi)\\phi'_p(\\xi)\\phi_j(\\eta)\\phi_q(\\eta) + \\phi_i(\\xi)\\phi_p(\\xi)\\phi'_j(\\eta)\\phi'_q(\\eta)) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\n分离积分：\n$$\nK_{(i,j),(p,q)} = \\kappa \\left[ \\left(\\int_{-1}^{1} \\phi'_i(\\xi)\\phi'_p(\\xi)\\mathrm{d}\\xi\\right)\\left(\\int_{-1}^{1} \\phi_j(\\eta)\\phi_q(\\eta)\\mathrm{d}\\eta\\right) + \\left(\\int_{-1}^{1} \\phi_i(\\xi)\\phi_p(\\xi)\\mathrm{d}\\xi\\right)\\left(\\int_{-1}^{1} \\phi'_j(\\eta)\\phi'_q(\\eta)\\mathrm{d}\\eta\\right) \\right]\n$$\n$$\nK_{(i,j),(p,q)} = \\kappa ( K^1_{ip} M^1_{jq} + M^1_{ip} K^1_{jq} )\n$$\n这个结构对应于克罗内克和。完整的刚度矩阵为：\n$$\n\\mathbf{K} = \\kappa (\\mathbf{K}^1 \\otimes \\mathbf{M}^1 + \\mathbf{M}^1 \\otimes \\mathbf{K}^1)\n$$\n此推导按要求用一维积分形式化地表达了单元矩阵，并揭示了其底层的克罗内克积/和结构。\n\n**第二部分：块结构分析**\n\n我们现在根据几何分类对基函数重新排序：顶点 (V)、边 (E) 和内部 (I)。\n- **顶点模式 (V)**: 4个函数 $\\{l_\\alpha(\\xi)l_\\beta(\\eta)\\}_{\\alpha,\\beta \\in \\{1,2\\}}$。\n- **边模式 (E)**: $4(p-1)$个函数。对于平行于 $\\xi$ 轴的边，这些函数是 $\\{ \\psi_k(\\xi)l_\\beta(\\eta) \\}_{k=2..p, \\beta=1,2}$。对于平行于 $\\eta$ 轴的边，是 $\\{ l_\\alpha(\\xi)\\psi_k(\\eta) \\}_{k=2..p, \\alpha=1,2}$。\n- **内部模式 (I)**: $(p-1)^2$个函数 $\\{ \\psi_r(\\xi)\\psi_s(\\eta) \\}_{r,s=2..p}$。\n\n分层边模式 $\\psi_k(x)$ 的一个关键性质是它们在端点处为零：$\\psi_k(\\pm 1) = 0$。这意味着顶点模式的导数与边/内部模式的导数之间存在正交性。一维顶点模式 $l_\\alpha(x)$ 是线性的，所以 $l''_\\alpha(x) = 0$。对于任何 $k \\ge 2$：\n$$\n\\int_{-1}^{1} l'_\\alpha(x) \\psi'_k(x) \\, \\mathrm{d}x = [l'_\\alpha(x) \\psi_k(x)]_{-1}^{1} - \\int_{-1}^{1} l''_\\alpha(x) \\psi_k(x) \\, \\mathrm{d}x = l'_\\alpha(\\pm 1)\\psi_k(\\pm 1) - 0 = 0\n$$\n这个结果 $\\langle l'_\\alpha, \\psi'_k \\rangle = 0$ 是刚度矩阵块结构的关键。\n\n按 V-E-I 排序分块的矩阵具有以下形式：\n$$\n\\mathbf{M} = \\begin{pmatrix} \\mathbf{M}_{VV}  \\mathbf{M}_{VE}  \\mathbf{M}_{VI} \\\\ \\mathbf{M}_{EV}  \\mathbf{M}_{EE}  \\mathbf{M}_{EI} \\\\ \\mathbf{M}_{IV}  \\mathbf{M}_{IE}  \\mathbf{M}_{II} \\end{pmatrix}, \\quad \\mathbf{K} = \\begin{pmatrix} \\mathbf{K}_{VV}  \\mathbf{K}_{VE}  \\mathbf{K}_{VI} \\\\ \\mathbf{K}_{EV}  \\mathbf{K}_{EE}  \\mathbf{K}_{EI} \\\\ \\mathbf{K}_{IV}  \\mathbf{K}_{IE}  \\mathbf{K}_{II} \\end{pmatrix}\n$$\n\n**质量矩阵 ($\\mathbf{M}$) 的块结构：**\n质量形式 $m(u,v) = \\rho \\int_{\\hat{\\Omega}} u v \\, \\mathrm{d}\\xi\\mathrm{d}\\eta$ 涉及 $L^2$ 内积。分层基函数在不同类型（V, E, I）之间通常不是 $L^2$ 正交的。例如，$\\int_{-1}^{1} l_\\alpha(x) \\psi_k(x) \\, \\mathrm{d}x \\neq 0$。因此，质量矩阵的所有非对角块通常都是非零且稠密的。\n- $\\mathbf{M}_{VE}, \\mathbf{M}_{VI}, \\mathbf{M}_{EI}$ 均为**非零**。\n在这种块划分中，质量矩阵 $\\mathbf{M}$ 是一个**全耦合（稠密）矩阵**。\n\n**刚度矩阵 ($\\mathbf{K}$) 的块结构：**\n由于 $\\langle l'_\\alpha, \\psi'_k \\rangle = 0$ 的性质，$\\mathbf{K}$ 的结构是稀疏的。\n- **$\\mathbf{K}_{VI}$ 和 $\\mathbf{K}_{IV}$ (顶点-内部耦合):**\n设 $u = l_\\alpha(\\xi)l_\\beta(\\eta) \\in V$ 且 $v = \\psi_r(\\xi)\\psi_s(\\eta) \\in I$。\n$a(u,v) = \\kappa \\left( \\langle l'_\\alpha, \\psi'_r \\rangle \\langle l_\\beta, \\psi_s \\rangle + \\langle l_\\alpha, \\psi_r \\rangle \\langle l'_\\beta, \\psi'_s \\rangle \\right)$。\n两项都为零，因为 $\\langle l'_\\alpha, \\psi'_r \\rangle = 0$ 且 $\\langle l'_\\beta, \\psi'_s \\rangle = 0$。\n因此 $\\mathbf{K}_{VI} = \\mathbf{0}$，并且根据对称性，$\\mathbf{K}_{IV} = \\mathbf{0}$。这是分层基的一个基本性质：顶点模式与内部模式是 $H^1$ 正交的。\n\n- **$\\mathbf{K}_{VE}$ 和 $\\mathbf{K}_{EI}$ (其他耦合):**\n这些块通常是非零的。例如，考虑 $u = l_\\alpha(\\xi)l_\\beta(\\eta) \\in V$ 和一个边模式 $v = \\psi_k(\\xi)l_\\gamma(\\eta) \\in E$。\n$a(u,v) = \\kappa \\left( \\langle l'_\\alpha, \\psi'_k \\rangle \\langle l_\\beta, l_\\gamma \\rangle + \\langle l_\\alpha, \\psi_k \\rangle \\langle l'_\\beta, l'_\\gamma \\rangle \\right) = \\kappa \\langle l_\\alpha, \\psi_k \\rangle \\langle l'_\\beta, l'_\\gamma \\rangle \\neq 0$。\n所以 $\\mathbf{K}_{VE}$ 和 $\\mathbf{K}_{EV}$ 是**非零**的。\n类似地，对于 $u = \\psi_k(\\xi)l_\\beta(\\eta) \\in E$ 和 $v = \\psi_r(\\xi)\\psi_s(\\eta) \\in I$：\n$a(u,v) = \\kappa \\left( \\langle \\psi'_k, \\psi'_r \\rangle \\langle l_\\beta, \\psi_s \\rangle + \\langle \\psi_k, \\psi_r \\rangle \\langle l'_\\beta, \\psi'_s \\rangle \\right) = \\kappa \\langle \\psi'_k, \\psi'_r \\rangle \\langle l_\\beta, \\psi_s \\rangle \\neq 0$。\n所以 $\\mathbf{K}_{EI}$ 和 $\\mathbf{K}_{IE}$ 也是**非零**的。\n\n- **$\\mathbf{K}_{EE}$ (边-边块):**\n这个块有特定的结构。垂直边上的边模式是 $H^1$ 正交的。对于 $u = \\psi_k(\\xi)l_\\alpha(\\eta)$ 和 $v = l_\\beta(\\xi)\\psi_r(\\eta)$：\n$a(u,v) = \\kappa \\left( \\langle \\psi'_k, l'_\\beta \\rangle \\langle l_\\alpha, \\psi_r \\rangle + \\langle \\psi_k, l_\\beta \\rangle \\langle l'_\\alpha, \\psi'_r \\rangle \\right) = 0 + 0 = 0$。\n因此，$\\mathbf{K}_{EE}$ 是**块对角**的，非零耦合只存在于同一条边或平行边上的模式之间。\n\n总之，刚度矩阵具有以下块结构：\n$$\n\\mathbf{K} = \\begin{pmatrix} \\mathbf{K}_{VV}  \\mathbf{K}_{VE}  \\mathbf{0} \\\\ \\mathbf{K}_{EV}  \\mathbf{K}_{EE}  \\mathbf{K}_{EI} \\\\ \\mathbf{0}  \\mathbf{K}_{IE}  \\mathbf{K}_{II} \\end{pmatrix}\n$$\n其中 $\\mathbf{K}_{EE}$ 本身是块对角的，将与 $\\xi$-边相关的模式和与 $\\eta$-边相关的模式分离开。对角块 $\\mathbf{K}_{VV}$、$\\mathbf{K}_{EE}$ 和 $\\mathbf{K}_{II}$ 通常是非对角的，并包含非零项。\n\n**第三部分：自由度总数**\n\n自由度（DoFs）总数 $N(p)$ 是多项式阶数为 $p$ 的基函数的总数。我们可以对 $p \\ge 2$ 的每类模式的数量求和：\n1.  **顶点模式 ($N_V$)：** 有 $4$ 个角点，每个角点关联一个顶点模式（一维线性帽函数的张量积）。\n    $$N_V = 4$$\n2.  **边模式 ($N_E$)：** 有 $4$ 条边。对于每条边，存在阶数为 $k=2, 3, \\dots, p$ 的分层模式。每条边上此类模式的数量为 $p-1$。\n    $$N_E = 4 \\times (p-1)$$\n3.  **内部模式 ($N_I$)：** 这些是一维边模式 $\\psi_r(\\xi)\\psi_s(\\eta)$ 的张量积。索引 $r$ 和 $s$ 的范围都是从 $2$ 到 $p$。每个索引的选择数量为 $p-1$。\n    $$N_I = (p-1) \\times (p-1) = (p-1)^2$$\n\n自由度总数 $N(p)$ 是各项之和：\n$$\nN(p) = N_V + N_E + N_I = 4 + 4(p-1) + (p-1)^2\n$$\n展开并简化此表达式：\n$$\nN(p) = 4 + 4p - 4 + (p^2 - 2p + 1)\n$$\n$$\nN(p) = p^2 + 2p + 1\n$$\n这可以因式分解为一个简单的形式：\n$$\nN(p) = (p+1)^2\n$$\n这个结果与张量积构造是一致的，即在一维中有 $p+1$ 个基函数（$\\{l_1, l_2, \\psi_2, \\dots, \\psi_p\\}$），从而在二维中有 $(p+1) \\times (p+1)$ 个函数。",
            "answer": "$$\n\\boxed{(p+1)^2}\n$$"
        },
        {
            "introduction": "理解了分层基的构造及其产生的矩阵结构后，我们转向一个关键的实施细节：数值积分。有限元计算中的积分通常是数值完成的，而选择一个既精确又高效的求积法则是成功的关键。这个练习将探讨如何为p-版本有限元选择合适的高斯求积阶数，通过分析刚度矩阵被积函数的最高多项式次数，我们可以确定保证精确积分所需的最小高斯点数。 这是确保p-版本有限元代码正确性的一个必不可少的步骤。",
            "id": "3570989",
            "problem": "考虑一个有限元法（FEM）中的二维小应变线性弹性单元的刚度矩阵，该矩阵由在仿射四边形上、最大多项式阶数为 $p$ 的张量积层次化形函数组装而成。设单元 $\\Omega_e$ 是通过一个雅可比矩阵 $\\mathbf{J}$ 在 $\\Omega_e$ 上为常数的仿射映射，从参考正方形 $\\hat{\\Omega} = [-1,1]^2$ 变换得到的。单元刚度矩阵项为\n$$\nK_{ij} \\;=\\; \\int_{\\Omega_e} \\big(\\nabla \\mathbf{N}_i(\\mathbf{x})\\big)^{\\top}\\,\\mathbf{C}\\,\\nabla \\mathbf{N}_j(\\mathbf{x})\\,\\mathrm{d}\\Omega \\,,\n$$\n其中 $\\mathbf{C}$ 是常数、对称正定的弹性张量，$\\mathbf{N}_i$ 是由一维层次化多项式（例如，基于Legendre的层次结构）的张量积构成的层次化形函数，其在每个参考坐标方向上的阶数最多为 $p$。使用仿射映射，将积分写在 $\\hat{\\Omega}$ 上，并假设您使用张量积Gauss–Legendre (GL) 求积法（此处定义为 $n$ 点一维法则对最高 $2n-1$ 阶的多项式是精确的）来计算它。\n\n从第一性原理（弱形式、仿射映射以及层次化基函数导数的多项式阶数计算）出发，确定每个方向上所需的高斯-勒让德求积点的最小数量 $n$，以确保在此仿射四边形上，对于任意一对 $p$ 阶层次化基函数，每个 $K_{ij}$ 项都能被精确积分。选择正确的陈述并证明该法则。\n\nA. 每个方向 $n = p$ 个点是足够的。\n\nB. 每个方向 $n = p+1$ 个点是必要且充分的。\n\nC. 各向异性法则 $(n_\\xi,n_\\eta)=(p,\\,p+1)$ 对所有 $K_{ij}$ 是足够的。\n\nD. 每个方向 $n = 2p$ 个点是必要的。",
            "solution": "问题陈述要求计算精确计算一个二维线性弹性单元刚度矩阵项所需的每个方向上Gauss-Legendre求积点的最小数量 $n$。该单元是一个仿射四边形，形函数是最大阶数为 $p$ 的张量积层次化多项式。\n\n首先，我们验证问题陈述的有效性。\n\n### 步骤1：提取已知条件\n-   单元类型：仿射四边形 $\\Omega_e$ 上的二维（$2$D）小应变线性弹性单元。\n-   映射：$\\Omega_e$ 是参考正方形 $\\hat{\\Omega} = [-1,1]^2$ 在一个仿射映射下的像。该映射的雅可比矩阵 $\\mathbf{J}$ 是常数。\n-   刚度矩阵项：$K_{ij} = \\int_{\\Omega_e} (\\nabla \\mathbf{N}_i(\\mathbf{x}))^{\\top} \\mathbf{C} (\\nabla \\mathbf{N}_j(\\mathbf{x})) \\mathrm{d}\\Omega$。\n-   材料张量：$\\mathbf{C}$ 是一个常数、对称、正定的弹性张量。\n-   形函数：$\\mathbf{N}_i$ 是由一维层次化多项式（在每个参考坐标方向上的阶数最多为 $p$）的张量积构成的层次化形函数。我们考虑这些矢量形函数的标量分量，在参考单元上记为 $\\hat{N}_k(\\xi, \\eta)$。\n-   求积法则：张量积Gauss-Legendre (GL) 法则。一个一维 $n$ 点GL法则对最高 $2n-1$ 阶的多项式是精确的。\n\n### 步骤2：使用已知条件进行验证\n该问题具有科学依据，是适定且客观的。它是有限元法 p-version 中的一个标准问题。所有术语都有明确定义，且前提条件（仿射映射、常数 $\\mathbf{C}$、层次化基）是一致且足以推导出唯一答案的。该问题没有说明中列出的缺陷。\n\n### 步骤3：结论和行动\n问题有效。我们继续进行推导。\n\n### 求积法则的推导\n\n刚度矩阵项由下式给出\n$$\nK_{ij} = \\int_{\\Omega_e} (\\nabla_{\\mathbf{x}} N_i(\\mathbf{x}))^{\\top} \\mathbf{C} (\\nabla_{\\mathbf{x}} N_j(\\mathbf{x})) \\mathrm{d}\\Omega\n$$\n为简单起见，我们分析一对标量形函数 $N_i$ 和 $N_j$ 的贡献。通过对分量求和，该分析可直接推广到矢量情况。\n\n我们使用仿射映射 $\\mathbf{x} = \\mathbf{F}(\\boldsymbol{\\xi})$（其中 $\\boldsymbol{\\xi} = (\\xi, \\eta)$）将积分从物理单元 $\\Omega_e$ 变换到参考正方形 $\\hat{\\Omega} = [-1,1]^2$。导数的链式法则表明 $\\nabla_{\\mathbf{x}} = \\mathbf{J}^{-\\top} \\nabla_{\\boldsymbol{\\xi}}$，其中 $\\mathbf{J} = \\frac{\\partial \\mathbf{x}}{\\partial \\boldsymbol{\\xi}}$ 是映射的雅可比矩阵。由于映射是仿射的，$\\mathbf{J}$ 是一个常数矩阵。微分面积元变换为 $\\mathrm{d}\\Omega = \\det(\\mathbf{J}) \\mathrm{d}\\hat{\\Omega}$。同样，$\\det(\\mathbf{J})$ 是一个常数。\n\n将这些代入积分，我们得到\n$$\nK_{ij} = \\int_{\\hat{\\Omega}} (\\mathbf{J}^{-\\top} \\nabla_{\\boldsymbol{\\xi}} \\hat{N}_i(\\boldsymbol{\\xi}))^{\\top} \\mathbf{C} (\\mathbf{J}^{-\\top} \\nabla_{\\boldsymbol{\\xi}} \\hat{N}_j(\\boldsymbol{\\xi})) \\det(\\mathbf{J}) \\mathrm{d}\\hat{\\Omega}\n$$\n$$\nK_{ij} = \\int_{\\hat{\\Omega}} (\\nabla_{\\boldsymbol{\\xi}} \\hat{N}_i)^{\\top} \\mathbf{J}^{-1} \\mathbf{C} \\mathbf{J}^{-\\top} (\\nabla_{\\boldsymbol{\\xi}} \\hat{N}_j) \\det(\\mathbf{J}) \\mathrm{d}\\hat{\\Omega}\n$$\n令 $\\hat{\\mathbf{C}} = \\det(\\mathbf{J}) \\mathbf{J}^{-1} \\mathbf{C} \\mathbf{J}^{-\\top}$。由于 $\\mathbf{J}$ 和 $\\mathbf{C}$ 是常数，$\\hat{\\mathbf{C}}$ 是一个常数张量。积分简化为\n$$\nK_{ij} = \\int_{-1}^{1} \\int_{-1}^{1} \\underbrace{ \\left( (\\nabla_{\\boldsymbol{\\xi}} \\hat{N}_i)^{\\top} \\hat{\\mathbf{C}} (\\nabla_{\\boldsymbol{\\xi}} \\hat{N}_j) \\right) }_{I(\\xi, \\eta)} \\mathrm{d}\\xi \\mathrm{d}\\eta\n$$\n为了确定所需的求积法则，我们必须找出被积函数 $I(\\xi, \\eta)$ 在每个坐标方向（$\\xi$ 和 $\\eta$）上的最高多项式阶数。\n\n层次化形函数的形式为 $\\hat{N}_k(\\xi, \\eta) = \\phi_a(\\xi) \\phi_b(\\eta)$，其中 $\\phi_k(s)$ 是 $k$ 阶的层次化多项式。为保证对所有 $K_{ij}$ 的精确积分，我们必须考虑基函数可能达到的最高多项式阶数。设 $\\hat{N}_i = \\phi_a(\\xi) \\phi_b(\\eta)$ 和 $\\hat{N}_j = \\phi_c(\\xi) \\phi_d(\\eta)$，其中 $a, b, c, d$ 是从 $0$ 到 $p$ 的整数。当 $k \\ge 1$ 时，$\\phi_k'(s)$ 的阶数是 $k-1$。\n\n形函数 $\\hat{N}_i$ 的梯度是 $\\nabla_{\\boldsymbol{\\xi}} \\hat{N}_i = \\begin{pmatrix} \\partial \\hat{N}_i / \\partial \\xi \\\\ \\partial \\hat{N}_i / \\partial \\eta \\end{pmatrix} = \\begin{pmatrix} \\phi_a'(\\xi) \\phi_b(\\eta) \\\\ \\phi_a(\\xi) \\phi_b'(\\eta) \\end{pmatrix}$。\n\n被积函数是 $I(\\xi, \\eta) = (\\nabla_{\\boldsymbol{\\xi}} \\hat{N}_i)^{\\top} \\hat{\\mathbf{C}} (\\nabla_{\\boldsymbol{\\xi}} \\hat{N}_j)$。设 $\\hat{\\mathbf{C}} = \\begin{pmatrix} \\hat{C}_{11}  \\hat{C}_{12} \\\\ \\hat{C}_{21}  \\hat{C}_{22} \\end{pmatrix}$。\n$$\nI(\\xi, \\eta) = \\hat{C}_{11} \\frac{\\partial\\hat{N}_i}{\\partial\\xi}\\frac{\\partial\\hat{N}_j}{\\partial\\xi} + \\hat{C}_{12} \\left(\\frac{\\partial\\hat{N}_i}{\\partial\\xi}\\frac{\\partial\\hat{N}_j}{\\partial\\eta} + \\frac{\\partial\\hat{N}_i}{\\partial\\eta}\\frac{\\partial\\hat{N}_j}{\\partial\\xi}\\right) + \\hat{C}_{22} \\frac{\\partial\\hat{N}_i}{\\partial\\eta}\\frac{\\partial\\hat{N}_j}{\\partial\\eta}\n$$\n我们分析每个项在 $\\xi$ 和 $\\eta$ 方向上的多项式阶数。\n1.  含 $\\hat{C}_{11}$ 的项：$\\frac{\\partial\\hat{N}_i}{\\partial\\xi}\\frac{\\partial\\hat{N}_j}{\\partial\\xi} = (\\phi_a'(\\xi)\\phi_b(\\eta))(\\phi_c'(\\xi)\\phi_d(\\eta)) = (\\phi_a'(\\xi)\\phi_c'(\\xi))(\\phi_b(\\eta)\\phi_d(\\eta))$。\n    -   在 $\\xi$ 方向的阶数：$\\text{deg}(\\phi_a') + \\text{deg}(\\phi_c') = (a-1) + (c-1) = a+c-2$。最大值（当 $a=c=p$ 时）：$2p-2$。\n    -   在 $\\eta$ 方向的阶数：$\\text{deg}(\\phi_b) + \\text{deg}(\\phi_d) = b+d$。最大值（当 $b=d=p$ 时）：$2p$。\n2.  含 $\\hat{C}_{12}$ 的项：例如，$\\frac{\\partial\\hat{N}_i}{\\partial\\xi}\\frac{\\partial\\hat{N}_j}{\\partial\\eta} = (\\phi_a'(\\xi)\\phi_b(\\eta))(\\phi_c(\\xi)\\phi_d'(\\eta)) = (\\phi_a'(\\xi)\\phi_c(\\xi))(\\phi_b(\\eta)\\phi_d'(\\eta))$。\n    -   在 $\\xi$ 方向的阶数：$\\text{deg}(\\phi_a') + \\text{deg}(\\phi_c) = (a-1) + c = a+c-1$。最大值：$2p-1$。\n    -   在 $\\eta$ 方向的阶数：$\\text{deg}(\\phi_b) + \\text{deg}(\\phi_d') = b + (d-1) = b+d-1$。最大值：$2p-1$。\n3.  含 $\\hat{C}_{22}$ 的项：$\\frac{\\partial\\hat{N}_i}{\\partial\\eta}\\frac{\\partial\\hat{N}_j}{\\partial\\eta} = (\\phi_a(\\xi)\\phi_b'(\\eta))(\\phi_c(\\xi)\\phi_d'(\\eta)) = (\\phi_a(\\xi)\\phi_c(\\xi))(\\phi_b'(\\eta)\\phi_d'(\\eta))$。\n    -   在 $\\xi$ 方向的阶数：$\\text{deg}(\\phi_a) + \\text{deg}(\\phi_c) = a+c$。最大值：$2p$。\n    -   在 $\\eta$ 方向的阶数：$\\text{deg}(\\phi_b') + \\text{deg}(\\phi_d') = (b-1) + (d-1) = b+d-2$。最大值：$2p-2$。\n\n总被积函数 $I(\\xi, \\eta)$ 是这些项的和。多项式之和的阶数是它们阶数的最大值。\n-   $I(\\xi, \\eta)$ 作为 $\\xi$ 的多项式，其最高阶数为 $2p$。这由含 $\\hat{C}_{22}$ 的项决定。\n-   $I(\\xi, \\eta)$ 作为 $\\eta$ 的多项式，其最高阶数为 $2p$。这由含 $\\hat{C}_{11}$ 的项决定。\n\n在给定方向上具有 $n$ 个点的张量积Gauss-Legendre求积法则，对该方向上最高为 $2n-1$ 阶的多项式是精确的。为了精确积分 $I(\\xi, \\eta)$，我们需要一个在 $\\xi$ 方向上对 $2p$ 阶多项式精确，在 $\\eta$ 方向上对 $2p$ 阶多项式也精确的法则。\n设 $n_\\xi$ 和 $n_\\eta$ 分别是 $\\xi$ 和 $\\eta$ 方向上的点数。我们必须有：\n$$\n2n_\\xi - 1 \\ge 2p \\implies n_\\xi \\ge \\frac{2p+1}{2} = p + \\frac{1}{2}\n$$\n$$\n2n_\\eta - 1 \\ge 2p \\implies n_\\eta \\ge \\frac{2p+1}{2} = p + \\frac{1}{2}\n$$\n由于求积点的数量必须是整数，因此每个方向上所需的最小点数是大于或等于 $p + 1/2$ 的最小整数，即 $p+1$。\n因此，对于各向同性法则（$n_\\xi = n_\\eta = n$），最小数量是 $n = p+1$。这个点数对于积分最高阶项是必要的，并且对于积分所有项是充分的。\n\n### 选项评估\n\n**A. 每个方向 $n = p$ 个点是足够的。**\n$n=p$ 点法则对最高 $2p-1$ 阶的多项式是精确的。我们的被积函数在每个方向上都有最高 $2p$ 阶的项。由于对于任何 $p \\ge 1$，$2p > 2p-1$，因此该法则不充分。对于 $p=0$ 的情况，被积函数的阶数为 $0$（零阶导数），$n=p+1=1$ 是正确的，而 $n=p=0$ 不是一个有效的求积法则。\n**结论：不正确。**\n\n**B. 每个方向 $n = p+1$ 个点是必要且充分的。**\n如上所推导，$n=p+1$ 点法则对最高 $2(p+1)-1 = 2p+1$ 阶的多项式是精确的。由于被积函数在任一方向上的最高阶数是 $2p$，该法则是充分的（$2p+1 \\ge 2p$）。它也是必要的，因为少一个点（即 $n=p$）的法则只能精确到 $2p-1$ 阶，这是不够的。\n**结论：正确。**\n\n**C. 各向异性法则 $(n_\\xi,n_\\eta)=(p,\\,p+1)$ 对所有 $K_{ij}$ 是足够的。**\n该法则将在 $\\xi$ 方向使用 $n_\\xi = p$ 个点。这对 $\\xi$ 方向上最高 $2p-1$ 阶的多项式是精确的。如推导所示，项 $\\hat{C}_{22}(\\partial\\hat{N}_i/\\partial\\eta)(\\partial\\hat{N}_j/\\partial\\eta)$ 会产生一个在 $\\xi$ 方向上阶数为 $2p$ 的多项式。因此，该法则不足以精确积分所有刚度矩阵项。\n**结论：不正确。**\n\n**D. 每个方向 $n = 2p$ 个点是必要的。**\n$n=2p$ 点法则对最高 $2(2p)-1 = 4p-1$ 阶的多项式是精确的。由于被积函数的阶数是 $2p$，且当 $p \\ge 1/2$ 时 $4p-1 \\ge 2p$，因此该法则是充分的（对于 $p \\ge 1$）。然而，该陈述声称它是*必要*的。我们已经证明 $n=p+1$ 是充分的。对于任何 $p > 1$，我们有 $p+1  2p$，所以更少的点数就足够了。因此，$n=2p$ 不是必要的。对于 $p=1$ 的特殊情况，$p+1=2$ 且 $2p=2$，所以 $n=2$ 是必要的。但是，该陈述必须对所有 $p$ 成立。对于 $p=2$，$p+1=3$ 是必要的，而 $2p=4$ 则不是。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}