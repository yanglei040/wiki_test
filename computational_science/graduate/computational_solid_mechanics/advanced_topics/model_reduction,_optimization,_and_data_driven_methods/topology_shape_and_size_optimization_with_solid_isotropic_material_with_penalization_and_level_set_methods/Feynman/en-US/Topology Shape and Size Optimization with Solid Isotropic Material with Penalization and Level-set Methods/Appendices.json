{
    "hands_on_practices": [
        {
            "introduction": "Before we can optimize a structure, we must first be able to predict its performance. This foundational practice walks you through the core of any topology optimization workflow: analyzing a design's response to applied loads. By calculating the compliance of a single finite element using the Solid Isotropic Material with Penalization (SIMP) model , you will gain direct experience in how the material layout, represented by density $\\rho$, influences the overall stiffness of a structure. This exercise solidifies the connection between the design variables and the physical objective function we aim to minimize.",
            "id": "3607228",
            "problem": "Consider a cantilever configuration in linear elasticity under plane stress, discretized by a single bilinear quadrilateral (four-node) finite element. The cantilever occupies the rectangle with nodes at $(0,0)$, $(L,0)$, $(L,H)$, and $(0,H)$, where $L=2\\,\\text{m}$ and $H=2\\,\\text{m}$. The left edge nodes at $(0,0)$ and $(0,H)$ are clamped so that both their horizontal and vertical displacements vanish. A vertical point load of magnitude $F=1000\\,\\text{N}$ is applied downward at the top-right node $(L,H)$, with no other external loads. Use plane stress with thickness $t=0.01\\,\\text{m}$, Poisson’s ratio $\\nu=0$, and the Solid Isotropic Material with Penalization (SIMP) model for isotropic stiffness, where the Young’s modulus is $E(\\rho)=E_{\\min}+\\rho^{p}(E_{0}-E_{\\min})$. Take $E_{0}=2\\times 10^{9}\\,\\text{Pa}$, $E_{\\min}=0\\,\\text{Pa}$, $p=2$, and element density $\\rho=\\frac{1}{2}$. The bilinear quadrilateral element is mapped from the reference square $[-1,1]\\times[-1,1]$ via the standard isoparametric map; for this rectangular geometry, the Jacobian determinant is constant and equal to $\\det(J)=\\frac{LH}{4}=1\\,\\text{m}^{2}$. Use $2\\times 2$ Gauss quadrature with points $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$, each with unit weight, to assemble the element stiffness. Starting from the definitions of the constitutive law, strain-displacement relations, and isoparametric finite element formulation, assemble the discrete compliance \n$$J(\\rho)=\\sum_{e} u_{e}^{T} k_{e}(\\rho)\\,u_{e}$$ \nfor the single element under the given loads and boundary conditions, where $u_{e}$ are the nodal displacements of the element and $k_{e}(\\rho)$ is the element stiffness under SIMP. Compute the numerical value of $J(\\rho)$ for the given data. Express the final energy in Joules and round your answer to four significant figures.",
            "solution": "The problem is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Configuration:** Cantilever beam, single bilinear quadrilateral (four-node) finite element.\n- **Geometry:** Rectangle with nodes at $(0,0)$, $(L,0)$, $(L,H)$, $(0,H)$.\n- **Dimensions:** $L=2\\,\\text{m}$, $H=2\\,\\text{m}$.\n- **Boundary Conditions (BCs):** Nodes at $(0,0)$ and $(0,H)$ are clamped (zero horizontal and vertical displacements).\n- **Loading:** Vertical point load $F=1000\\,\\text{N}$ applied downward at node $(L,H)$. No other external loads.\n- **Mechanical Model:** Linear elasticity, plane stress.\n- **Element Thickness:** $t=0.01\\,\\text{m}$.\n- **Poisson's Ratio:** $\\nu=0$.\n- **Material Model:** Solid Isotropic Material with Penalization (SIMP).\n- **SIMP Parameters:** $E_{0}=2\\times 10^{9}\\,\\text{Pa}$, $E_{\\min}=0\\,\\text{Pa}$, $p=2$, $\\rho=\\frac{1}{2}$.\n- **Finite Element (FE) Formulation:**\n  - Isoparametric mapping from reference square $[-1,1]\\times[-1,1]$.\n  - Jacobian determinant $\\det(J)=\\frac{LH}{4}=1\\,\\text{m}^{2}$.\n  - $2\\times 2$ Gauss quadrature with points $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\} \\times \\{\\pm 1/\\sqrt{3}\\}$ and unit weights.\n- **Objective:** Compute the numerical value of the compliance $J(\\rho)=\\sum_{e} u_{e}^{T} k_{e}(\\rho)\\,u_{e}$ in Joules, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is a standard application of the Finite Element Method to a linear elasticity problem, incorporating the well-established SIMP model. All concepts are fundamental to computational solid mechanics. The problem is scientifically sound.\n2.  **Well-Posed:** The problem provides all necessary data, boundary conditions, and material properties to uniquely determine the displacement field and, consequently, the compliance. The setup is self-contained and consistent.\n3.  **Objective:** The problem is stated using precise, unambiguous technical language. There are no subjective or opinion-based elements.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution\nThe problem requires the calculation of the compliance, $J(\\rho)$, for a single-element model of a cantilever beam. The compliance is defined as $J(\\rho) = \\mathbf{U}^T \\mathbf{K} \\mathbf{U}$, where $\\mathbf{U}$ is the global nodal displacement vector and $\\mathbf{K}$ is the global stiffness matrix. For a linear elastic system in equilibrium, $\\mathbf{K}\\mathbf{U}=\\mathbf{F}$, where $\\mathbf{F}$ is the global force vector. Thus, the compliance is also equal to the work done by the external forces, $J(\\rho) = \\mathbf{U}^T \\mathbf{F}$.\n\nFirst, we define the nodal ordering and degrees of freedom (DoFs). Let the nodes be numbered as:\n- Node $1$: $(0,0)$ with DoFs $(u_1, u_2)$\n- Node $2$: $(L,0)$ with DoFs $(u_3, u_4)$\n- Node $3$: $(L,H)$ with DoFs $(u_5, u_6)$\n- Node $4$: $(0,H)$ with DoFs $(u_7, u_8)$\n\nThe global displacement vector is $\\mathbf{U} = [u_1, u_2, u_3, u_4, u_5, u_6, u_7, u_8]^T$.\n\nThe boundary conditions state that nodes $1$ and $4$ are clamped:\n$u_1 = u_2 = 0$\n$u_7 = u_8 = 0$\n\nThe external load is a downward force $F$ at node $3$. The global force vector is:\n$\\mathbf{F} = [F_1, F_2, 0, 0, 0, -F, F_7, F_8]^T$, where $F_1, F_2, F_7, F_8$ are unknown reaction forces.\n\nThe system of equations $\\mathbf{K}\\mathbf{U}=\\mathbf{F}$ can be reduced to the free DoFs, which are $(u_3, u_4, u_5, u_6)$. We define the reduced displacement and force vectors:\n$\\mathbf{U}_{\\text{free}} = [u_3, u_4, u_5, u_6]^T$\n$\\mathbf{F}_{\\text{free}} = [0, 0, 0, -F]^T$\n\nThe system to solve is $\\mathbf{K}_{\\text{free}} \\mathbf{U}_{\\text{free}} = \\mathbf{F}_{\\text{free}}$, where $\\mathbf{K}_{\\text{free}}$ is the $4\\times4$ submatrix of $\\mathbf{K}$ corresponding to the free DoFs.\n\nNext, we calculate the material properties. The penalized Young's modulus $E$ is:\n$$E(\\rho) = E_{\\min}+\\rho^{p}(E_{0}-E_{\\min}) = 0 + \\left(\\frac{1}{2}\\right)^{2}(2 \\times 10^9 - 0) = \\frac{1}{4} E_0 = 0.5 \\times 10^9\\,\\text{Pa}$$\n\nFor plane stress with $\\nu=0$, the constitutive matrix $\\mathbf{D}$ is:\n$$\\mathbf{D} = \\frac{E}{1-\\nu^2} \\begin{pmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{pmatrix} = E \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}$$\n\nThe element stiffness matrix $\\mathbf{K}$ (here, $\\mathbf{k}_e$) is given by the integral over the element volume:\n$$\\mathbf{K} = \\int_{\\Omega_e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, dV = t \\int_{A_e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, dA$$\nUsing isoparametric mapping to the reference element $[-1,1]\\times[-1,1]$, this becomes:\n$$\\mathbf{K} = t \\int_{-1}^1\\int_{-1}^1 \\mathbf{B}(\\xi,\\eta)^T \\mathbf{D} \\mathbf{B}(\\xi,\\eta) \\det(\\mathbf{J}) \\, d\\xi d\\eta$$\nThe strain-displacement matrix $\\mathbf{B}$ relates strains to nodal displacements. For the rectangular element with $L=2$ and $H=2$, the mapping is $x(\\xi) = \\frac{L}{2}(1+\\xi) = 1+\\xi$ and $y(\\eta) = \\frac{H}{2}(1+\\eta) = 1+\\eta$. The Jacobian matrix is $\\mathbf{J} = \\mathrm{diag}(L/2, H/2) = \\mathrm{diag}(1,1)$, so $\\det(\\mathbf{J})=1$.\n\nThe integral is evaluated numerically using $2\\times2$ Gauss quadrature. The reduced stiffness matrix $\\mathbf{K}_{\\text{free}}$ consists of the sub-blocks corresponding to the free DoFs (nodes 2 and 3). After performing the standard but lengthy calculations for the matrix blocks $\\mathbf{K}_{22}$, $\\mathbf{K}_{23}$, $\\mathbf{K}_{32}$, and $\\mathbf{K}_{33}$, and assembling them, the reduced stiffness matrix is found to be:\n$$\\mathbf{K}_{\\text{free}} = tE \\begin{pmatrix}\n1/2  -1/8  0  -1/8 \\\\\n-1/8  1/2  1/8  -1/4 \\\\\n0  1/8  1/2  1/8 \\\\\n-1/8  -1/4  1/8  1/2\n\\end{pmatrix}$$\nFor the subsequent inversion, it is convenient to factor out a common term:\n$$\\mathbf{K}_{\\text{free}} = \\frac{tE}{8} \\begin{pmatrix} 4  -1  0  -1 \\\\ -1  4  1  -2 \\\\ 0  1  4  1 \\\\ -1  -2  1  4 \\end{pmatrix}$$\nLet $\\mathbf{A}$ be the matrix part: $\\mathbf{A} = \\begin{pmatrix} 4  -1  0  -1 \\\\ -1  4  1  -2 \\\\ 0  1  4  1 \\\\ -1  -2  1  4 \\end{pmatrix}$. We need to solve $\\frac{tE}{8}\\mathbf{A}\\mathbf{U}_{\\text{free}} = \\mathbf{F}_{\\text{free}}$, so $\\mathbf{U}_{\\text{free}} = \\frac{8}{tE}\\mathbf{A}^{-1}\\mathbf{F}_{\\text{free}}$. The determinant of $\\mathbf{A}$ is required. After careful calculation via cofactor expansion, $\\det(\\mathbf{A}) = 96$.\nThe inverse matrix is $\\mathbf{A}^{-1} = \\frac{1}{\\det(\\mathbf{A})} \\text{adj}(\\mathbf{A})$. We need to compute the displacements $\\mathbf{U}_{\\text{free}} = \\mathbf{K}_{\\text{free}}^{-1} \\mathbf{F}_{\\text{free}}$. As $\\mathbf{F}_{\\text{free}} = [0,0,0,-F]^T$, the displacement vector is the last column of $\\mathbf{K}_{\\text{free}}^{-1}$ multiplied by $-F$.\n$$(\\mathbf{K}_{\\text{free}}^{-1})_{i4} = \\left(\\frac{8}{tE}\\mathbf{A}^{-1}\\right)_{i4} = \\frac{8}{tE} \\frac{C_{4i}}{\\det(\\mathbf{A})}$$\nwhere $C_{ji}$ is the cofactor of the entry $A_{ji}$. The last column of $\\mathbf{A}^{-1}$ involves cofactors $C_{14}, C_{24}, C_{34}, C_{44}$.\n$C_{14} = 24$, $C_{24} = 40$, $C_{34} = -24$, $C_{44} = 56$.\nThe last column of $\\mathbf{A}^{-1}$ is $\\frac{1}{96}[24, 40, -24, 56]^T$.\nThus, $\\mathbf{U}_{\\text{free}}$ is:\n$$\\mathbf{U}_{\\text{free}} = \\frac{8}{tE} \\frac{-F}{96} \\begin{pmatrix} 24 \\\\ 40 \\\\ -24 \\\\ 56 \\end{pmatrix} = \\frac{-F}{12tE} \\begin{pmatrix} 24 \\\\ 40 \\\\ -24 \\\\ 56 \\end{pmatrix}$$\nThe displacement of interest is $u_6$, which is the fourth component:\n$$u_6 = \\frac{-56F}{12tE} = \\frac{-14F}{3tE}$$\nThe compliance is $J(\\rho) = \\mathbf{U}^T\\mathbf{F}$. Since only the 6th component of force on the free DoFs is non-zero, this is:\n$$J(\\rho) = u_6 F_6 = u_6 (-F) = \\left(\\frac{-14F}{3tE}\\right) (-F) = \\frac{14F^2}{3tE}$$\nNow, we substitute the numerical values:\n$F = 1000\\,\\text{N}$\n$t = 0.01\\,\\text{m}$\n$E = E(\\rho) = 0.5 \\times 10^9\\,\\text{Pa}$\n$$tE = (0.01\\,\\text{m})(0.5 \\times 10^9\\,\\text{N/m}^2) = 5 \\times 10^6\\,\\text{N/m}$$\n$$J = \\frac{14 \\times (1000)^2}{3 \\times (5 \\times 10^6)} = \\frac{14 \\times 10^6}{15 \\times 10^6} = \\frac{14}{15}\\,\\text{J}$$\nThe numerical value is:\n$$J = \\frac{14}{15} \\approx 0.933333... \\,\\text{J}$$\nRounding to four significant figures, we get $0.9333\\,\\text{J}$.",
            "answer": "$$\\boxed{0.9333}$$"
        },
        {
            "introduction": "With a method to evaluate a design's performance, the next step is to systematically improve it. This exercise introduces the engine of many topology optimization codes: the Optimality Criteria (OC) method. Starting from the necessary conditions for an optimal design, you will derive and apply the iterative update scheme that redistributes material to where it is most effective at increasing stiffness . This practice provides crucial insight into how algorithms navigate the design space to find efficient structures that satisfy constraints like a limited material budget.",
            "id": "3607239",
            "problem": "Consider compliance minimization with Solid Isotropic Material with Penalization (SIMP) for a linear elastic cantilever discretized into $4$ equal-volume finite elements. The design variables are the element densities $\\{\\rho_i\\}_{i=1}^{4}$ with lower and upper bounds $0  \\rho_{\\min} \\le \\rho_i \\le 1$, and the objective is to minimize the compliance $C(\\boldsymbol{\\rho})$ subject to a global volume fraction constraint. Assume plane stress, small strains, and linear elasticity. The SIMP material interpolation is $E(\\rho_i) = \\rho_i^{p} E_0$ with penalization exponent $p \\ge 1$, and the compliance sensitivities at the current iterate $\\boldsymbol{\\rho}^{k}$ are given by the adjoint method. The volume constraint is $\\sum_{i=1}^{4} v_i \\rho_i \\le V^{\\star}$ with equal element volumes $v_i = 1$.\n\nStarting from the Karush–Kuhn–Tucker (KKT) conditions for the constrained optimization problem and using the classical reciprocal local approximation of the compliance about $\\boldsymbol{\\rho}^{k}$, derive the Optimality Criteria (OC) update form for a single iteration. Then, for the specific data below, perform one OC update, enforcing both move limits and bound constraints, and determine the Lagrange multiplier by satisfying the volume constraint after the update.\n\nUse the following data:\n- Current densities: $\\boldsymbol{\\rho}^{k} = [\\,0.7,\\,0.4,\\,0.3,\\,0.6\\,]$.\n- Compliance sensitivities evaluated at $\\boldsymbol{\\rho}^{k}$: $\\left[\\frac{\\partial C}{\\partial \\rho_1},\\,\\frac{\\partial C}{\\partial \\rho_2},\\,\\frac{\\partial C}{\\partial \\rho_3},\\,\\frac{\\partial C}{\\partial \\rho_4}\\right] = [\\,-4.0,\\,-0.5,\\,-0.2,\\,-3.0\\,]$.\n- Penalization exponent: $p = 3$ (already accounted for in the given sensitivities).\n- Volume fraction target: $v_f^{\\star} = 0.5$, so the target volume is $V^{\\star} = v_f^{\\star} \\times 4$.\n- Move limit: $m = 0.1$, so each updated density must satisfy $\\rho_i^{k} - m \\le \\rho_i^{k+1} \\le \\rho_i^{k} + m$.\n- Bounds: $\\rho_{\\min} = 0.001$ and $\\rho_{\\max} = 1$.\n- Element volumes: $v_i = 1$ for all $i$.\n\nState clearly the derived OC update formula from first principles, then compute the updated densities $\\boldsymbol{\\rho}^{k+1}$ by determining the Lagrange multiplier that enforces $\\sum_{i=1}^{4} \\rho_i^{k+1} = V^{\\star}$ after applying the move limits and bound constraints. Round each updated density to four significant figures. Report the final updated densities as a single row vector.",
            "solution": "The problem is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Configuration:** Compliance minimization with SIMP, 4 elements.\n- **Design Variables:** Densities $\\boldsymbol{\\rho}^{k} = [\\,0.7,\\,0.4,\\,0.3,\\,0.6\\,]$.\n- **Sensitivities:** $\\partial C/\\partial \\boldsymbol{\\rho} = [\\,-4.0,\\,-0.5,\\,-0.2,\\,-3.0\\,]$.\n- **SIMP exponent:** $p=3$.\n- **Volume Constraint:** $V^{\\star} = 0.5 \\times 4 = 2.0$.\n- **Element volumes:** $v_i=1$.\n- **Update Constraints:** Move limit $m=0.1$, bounds $\\rho_{\\min}=0.001, \\rho_{\\max}=1$.\n- **Objective:** Perform one OC update to find $\\boldsymbol{\\rho}^{k+1}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is a standard application of the Optimality Criteria (OC) method, a cornerstone algorithm in topology optimization. All concepts are fundamental.\n2.  **Well-Posed:** The problem provides all necessary data (current state, sensitivities, constraints) to perform a single, unique update step. The objective is clear.\n3.  **Objective:** The problem is stated using precise, unambiguous technical language.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution\nThe optimization problem is one of compliance minimization for a linear elastic structure, which can be stated as:\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  C(\\boldsymbol{\\rho}) = \\mathbf{F}^T \\mathbf{U} \\\\\n\\text{subject to} \\quad  \\mathbf{K}(\\boldsymbol{\\rho}) \\mathbf{U} = \\mathbf{F} \\\\\n G(\\boldsymbol{\\rho}) = \\sum_{i=1}^{N} v_i \\rho_i - V^{\\star} \\le 0 \\\\\n \\boldsymbol{\\rho}_{\\min} \\le \\boldsymbol{\\rho} \\le \\boldsymbol{\\rho}_{\\max}\n\\end{aligned}\n$$\nwhere $C$ is the compliance, $\\boldsymbol{\\rho}$ is the vector of element densities, $\\mathbf{U}$ is the global displacement vector, $\\mathbf{F}$ is the global force vector, $\\mathbf{K}$ is the global stiffness matrix, $v_i$ is the volume of element $i$, and $V^{\\star}$ is the maximum allowed total material volume. The vectors $\\boldsymbol{\\rho}_{\\min}$ and $\\boldsymbol{\\rho}_{\\max}$ contain the lower and upper bounds for the densities respectively.\n\nThe Lagrangian for this problem, considering only the volume constraint, is:\n$$\n\\mathcal{L}(\\boldsymbol{\\rho}, \\lambda) = C(\\boldsymbol{\\rho}) + \\lambda \\left( \\sum_{i=1}^{N} v_i \\rho_i - V^{\\star} \\right)\n$$\nwhere $\\lambda \\ge 0$ is the Lagrange multiplier for the volume constraint. The Karush-Kuhn-Tucker (KKT) conditions for optimality state that at the optimal solution $\\boldsymbol{\\rho}^*$:\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\rho_i} = \\frac{\\partial C}{\\partial \\rho_i} + \\lambda v_i = 0\n$$\nfor all design variables $\\rho_i$ that are not at their bounds. This can be rearranged to define the sensitivity number $B_i$:\n$$\nB_i \\equiv -\\frac{1}{v_i} \\frac{\\partial C}{\\partial \\rho_i} = \\lambda\n$$\nThis condition implies that, at the optimum, the change in compliance per unit of material volume is constant for all elements that are not at their lower or upper bounds. The OC method is an iterative procedure designed to drive the design variables to satisfy this condition.\n\nDirectly solving this system is difficult as the sensitivities $\\frac{\\partial C}{\\partial \\rho_i}$ are complex, non-linear functions of all $\\rho_j$. Instead, we formulate a subproblem at each iteration $k$ based on an approximation of the objective function. The problem specifies the use of a classical reciprocal approximation of the compliance. This involves a first-order Taylor series expansion of the compliance $C$ in terms of the reciprocal variables $x_i = 1/\\rho_i$ around the current design point $\\boldsymbol{\\rho}^k$:\n$$\nC(\\boldsymbol{x}) \\approx \\tilde{C}(\\boldsymbol{x}) = C(\\boldsymbol{x}^k) + \\sum_{i=1}^N \\frac{\\partial C}{\\partial x_i}\\bigg|_{\\boldsymbol{x}^k} (x_i - x_i^k)\n$$\nUsing the chain rule, $\\frac{\\partial C}{\\partial x_i} = \\frac{\\partial C}{\\partial \\rho_i} \\frac{d\\rho_i}{dx_i} = \\frac{\\partial C}{\\partial \\rho_i} (-\\rho_i^2)$. Substituting this into the expansion and reverting to $\\rho_i$ variables, we get:\n$$\n\\tilde{C}(\\boldsymbol{\\rho}) = C(\\boldsymbol{\\rho}^k) + \\sum_{i=1}^N \\left( -(\\rho_i^k)^2 \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) \\left( \\frac{1}{\\rho_i} - \\frac{1}{\\rho_i^k} \\right)\n$$\nThe optimization subproblem for iteration $k+1$ is to minimize this approximate compliance $\\tilde{C}(\\boldsymbol{\\rho})$ subject to the volume constraint, which is assumed to be active, i.e., $\\sum_i v_i \\rho_i = V^{\\star}$.\nDropping the constant terms, the subproblem is:\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  \\sum_{i=1}^N \\left( -(\\rho_i^k)^2 \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) \\frac{1}{\\rho_i} \\\\\n\\text{subject to} \\quad  \\sum_{i=1}^N v_i \\rho_i - V^{\\star} = 0\n\\end{aligned}\n$$\nThe Lagrangian for this subproblem is:\n$$\n\\mathcal{L}_{\\text{sub}}(\\boldsymbol{\\rho}, \\lambda) = \\sum_{i=1}^N \\left( -(\\rho_i^k)^2 \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) \\frac{1}{\\rho_i} + \\lambda \\left(\\sum_{i=1}^N v_i \\rho_i - V^{\\star}\\right)\n$$\nThe KKT condition for this subproblem is $\\frac{\\partial \\mathcal{L}_{\\text{sub}}}{\\partial \\rho_i} = 0$:\n$$\n\\left( -(\\rho_i^k)^2 \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) \\left(-\\frac{1}{\\rho_i^2}\\right) + \\lambda v_i = 0\n$$\n$$\n\\frac{(\\rho_i^k)^2}{\\rho_i^2} \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} + \\lambda v_i = 0 \\implies \\frac{(\\rho_i^k)^2}{\\rho_i^2} \\left( -\\frac{1}{v_i} \\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} \\right) = \\lambda\n$$\nSubstituting the sensitivity number $B_i^k = -\\frac{1}{v_i} \\frac{\\partial C}{\\partial \\rho_i}\\big|_{\\boldsymbol{\\rho}^k}$, we get:\n$$\nB_i^k \\frac{(\\rho_i^k)^2}{\\rho_i^2} = \\lambda\n$$\nSolving for the new density $\\rho_i^{k+1}$ gives the OC update formula:\n$$\n\\rho_i^{k+1} = \\rho_i^k \\sqrt{\\frac{B_i^k}{\\lambda}}\n$$\nThis is the derived OC update formula. Now, we apply this to the specific problem data.\n\nThe given data are:\n- Current densities: $\\boldsymbol{\\rho}^{k} = [\\,0.7,\\,0.4,\\,0.3,\\,0.6\\,]$\n- Compliance sensitivities: $\\frac{\\partial \\mathbf{C}}{\\partial \\boldsymbol{\\rho}}\\big|_{\\boldsymbol{\\rho}^k} = [\\,-4.0,\\,-0.5,\\,-0.2,\\,-3.0\\,]$\n- Element volumes: $v_i = 1$ for $i \\in \\{1, 2, 3, 4\\}$\n- Target volume: $V^{\\star} = v_f^{\\star} \\times N = 0.5 \\times 4 = 2.0$\n- Move limit: $m = 0.1$\n- Density bounds: $\\rho_{\\min} = 0.001$, $\\rho_{\\max} = 1$\n\nFirst, compute the sensitivity numbers $B_i^k$:\n$$\nB_i^k = -\\frac{1}{v_i}\\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k} = -\\frac{\\partial C}{\\partial \\rho_i}\\bigg|_{\\boldsymbol{\\rho}^k}\n$$\n$B_1^k = -(-4.0) = 4.0$\n$B_2^k = -(-0.5) = 0.5$\n$B_3^k = -(-0.2) = 0.2$\n$B_4^k = -(-3.0) = 3.0$\n\nThe raw update, denoted $\\rho_i^{\\text{new}}$, is:\n$$\n\\rho_i^{\\text{new}} = \\rho_i^k \\sqrt{\\frac{B_i^k}{\\lambda}}\n$$\nThis update must be constrained by move limits and physical bounds. For each element, the new density $\\rho_i^{k+1}$ must lie within $[\\rho_i^{\\text{lower}}, \\rho_i^{\\text{upper}}]$, where:\n$\\rho_i^{\\text{lower}} = \\max(\\rho_i^k - m, \\rho_{\\min})$\n$\\rho_i^{\\text{upper}} = \\min(\\rho_i^k + m, \\rho_{\\max})$\n\nCalculating these bounds for each element:\n- $\\rho_1$: $[\\max(0.7-0.1, 0.001), \\min(0.7+0.1, 1)] = [\\max(0.6, 0.001), \\min(0.8, 1)] = [0.6, 0.8]$\n- $\\rho_2$: $[\\max(0.4-0.1, 0.001), \\min(0.4+0.1, 1)] = [\\max(0.3, 0.001), \\min(0.5, 1)] = [0.3, 0.5]$\n- $\\rho_3$: $[\\max(0.3-0.1, 0.001), \\min(0.3+0.1, 1)] = [\\max(0.2, 0.001), \\min(0.4, 1)] = [0.2, 0.4]$\n- $\\rho_4$: $[\\max(0.6-0.1, 0.001), \\min(0.6+0.1, 1)] = [\\max(0.5, 0.001), \\min(0.7, 1)] = [0.5, 0.7]$\n\nThe complete update rule is:\n$$\n\\rho_i^{k+1}(\\lambda) = \\max\\left(\\rho_i^{\\text{lower}}, \\min\\left(\\rho_i^{\\text{upper}}, \\rho_i^k \\sqrt{\\frac{B_i^k}{\\lambda}}\\right)\\right)\n$$\nThe Lagrange multiplier $\\lambda$ must be determined such that the volume constraint is satisfied:\n$$\n\\sum_{i=1}^4 v_i \\rho_i^{k+1}(\\lambda) = \\sum_{i=1}^4 \\rho_i^{k+1}(\\lambda) = V^{\\star} = 2.0\n$$\nThis is a non-linear equation in $\\lambda$ which is typically solved using a numerical root-finding method, such as bisection. The total volume is a monotonically decreasing function of $\\lambda$.\n\nLet us test a value for $\\lambda$. A common initial guess can be based on the average sensitivity, but here, given the discrete nature of the problem, we can analyze the conditions. Let's make an educated guess of $\\lambda=1.0$.\nWe compute the raw updated values $\\rho_i^{\\text{new}}$ for $\\lambda=1.0$:\n- $\\rho_1^{\\text{new}} = 0.7 \\sqrt{4.0 / 1.0} = 0.7 \\times 2.0 = 1.4$\n- $\\rho_2^{\\text{new}} = 0.4 \\sqrt{0.5 / 1.0} \\approx 0.4 \\times 0.7071 = 0.2828$\n- $\\rho_3^{\\text{new}} = 0.3 \\sqrt{0.2 / 1.0} \\approx 0.3 \\times 0.4472 = 0.1342$\n- $\\rho_4^{\\text{new}} = 0.6 \\sqrt{3.0 / 1.0} \\approx 0.6 \\times 1.7321 = 1.0392$\n\nNow, we apply the lower and upper bounds for the current iteration:\n- $\\rho_1^{k+1}$: $\\rho_1^{\\text{new}} = 1.4 > \\rho_1^{\\text{upper}} = 0.8$. So, $\\rho_1^{k+1} = 0.8$.\n- $\\rho_2^{k+1}$: $\\rho_2^{\\text{new}} = 0.2828  \\rho_2^{\\text{lower}} = 0.3$. So, $\\rho_2^{k+1} = 0.3$.\n- $\\rho_3^{k+1}$: $\\rho_3^{\\text{new}} = 0.1342  \\rho_3^{\\text{lower}} = 0.2$. So, $\\rho_3^{k+1} = 0.2$.\n- $\\rho_4^{k+1}$: $\\rho_4^{\\text{new}} = 1.0392 > \\rho_4^{\\text{upper}} = 0.7$. So, $\\rho_4^{k+1} = 0.7$.\n\nWith this choice of $\\lambda=1.0$, all elements saturate at their respective move limits. We check if the volume constraint is satisfied with these updated densities:\n$$\nV^{k+1} = \\sum_{i=1}^4 \\rho_i^{k+1} = 0.8 + 0.3 + 0.2 + 0.7 = 2.0\n$$\nThis is exactly the target volume $V^{\\star}$. Since the volume function is monotonic, this solution for $\\lambda$ is unique. Thus, the Lagrange multiplier is $\\lambda = 1.0$, and the calculated densities are the final updated densities for this iteration.\n\nThe updated densities, rounded to four significant figures as requested, are:\n$\\rho_1^{k+1} = 0.8000$\n$\\rho_2^{k+1} = 0.3000$\n$\\rho_3^{k+1} = 0.2000$\n$\\rho_4^{k+1} = 0.7000$\n\nThe final updated density vector is $\\boldsymbol{\\rho}^{k+1} = [\\,0.8000,\\,0.3000,\\,0.2000,\\,0.7000\\,]$.\nThis result aligns with physical intuition: elements $1$ and $4$, having the most negative compliance sensitivities (i.e., contributing most to stiffness per unit density), are increased. Elements $2$ and $3$, being less sensitive, have their densities decreased to satisfy the volume constraint.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8000  0.3000  0.2000  0.7000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Standard optimization algorithms can sometimes produce designs with fine, intricate details or non-physical \"checkerboard\" patterns that are difficult or impossible to manufacture. This final practice addresses this issue by introducing the concept of regularization, a powerful technique for controlling the complexity of the resulting topology. You will explore how adding a penalty term based on the design's total variation can steer the optimization towards smoother, more practical solutions . This exercise demonstrates how we can augment the mathematical formulation to enforce desirable physical characteristics on the final design.",
            "id": "3607259",
            "problem": "A one-dimensional bar used in topology optimization is modeled with the Solid Isotropic Material with Penalization (SIMP) approach. The design field is the element-wise density vector $\\boldsymbol{\\rho} = (\\rho_{1}, \\rho_{2}, \\dots, \\rho_{N})$ with $0 \\le \\rho_{i} \\le 1$. To discourage oscillatory designs, the compliance objective is augmented with a smoothed total variation term. For a uniform grid in one dimension, the smoothed total variation functional is discretized as\n$$\nR_{\\varepsilon}(\\boldsymbol{\\rho}) = \\sum_{i=1}^{N-1} \\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}},\n$$\nwhere $\\varepsilon > 0$ is a differentiability parameter. The augmented objective is $J(\\boldsymbol{\\rho}) = C(\\boldsymbol{\\rho}) + \\beta \\, R_{\\varepsilon}(\\boldsymbol{\\rho})$, where $C(\\boldsymbol{\\rho})$ is the compliance and $\\beta > 0$ is a penalty weight.\n\nStarting from the definition of $R_{\\varepsilon}(\\boldsymbol{\\rho})$ and using first principles (finite-difference modeling of $\\partial \\rho/\\partial x$, the chain rule, and the linearity of the first variation), derive the expression for the partial derivative $\\partial R_{\\varepsilon}/\\partial \\rho_{i}$ for an interior index $i \\in \\{2, \\dots, N-1\\}$ in terms of the neighboring densities $\\rho_{i-1}$, $\\rho_{i}$, and $\\rho_{i+1}$ and the parameter $\\varepsilon$. Then, for a particular interior element $i$, evaluate the additive change in the gradient due solely to the regularization, \n$$\n\\Delta g_{i} \\equiv \\beta \\, \\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}},\n$$\ngiven the data\n- $\\rho_{i-1} = 0.15$, $\\rho_{i} = 0.40$, $\\rho_{i+1} = 0.55$,\n- $\\varepsilon = 0.05$,\n- $\\beta = 2.0$.\n\nRound your answer for $\\Delta g_{i}$ to four significant figures. Express the final value in joules.",
            "solution": "The problem is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Configuration:** 1D bar with SIMP and total variation regularization.\n- **Regularization Functional:** $R_{\\varepsilon}(\\boldsymbol{\\rho}) = \\sum_{i=1}^{N-1} \\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}}$.\n- **Augmented Objective:** $J(\\boldsymbol{\\rho}) = C(\\boldsymbol{\\rho}) + \\beta \\, R_{\\varepsilon}(\\boldsymbol{\\rho})$.\n- **Data for element i:** $\\rho_{i-1} = 0.15$, $\\rho_{i} = 0.40$, $\\rho_{i+1} = 0.55$.\n- **Parameters:** $\\varepsilon = 0.05$, $\\beta = 2.0$.\n- **Objective:** Derive $\\partial R_{\\varepsilon}/\\partial \\rho_{i}$ for an interior element and compute the gradient change $\\Delta g_{i} = \\beta \\, \\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem deals with total variation regularization, a well-established technique in image processing and computational optimization to promote smooth or piecewise-constant solutions. Its application to topology optimization is a valid and modern approach.\n2.  **Well-Posed:** The problem provides a clear definition of the functional and all necessary numerical data to compute the derivative. The objective is precise.\n3.  **Objective:** The problem is stated using precise, unambiguous technical language.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution\nThe problem requires the derivation of the partial derivative of a smoothed total variation functional, followed by a numerical evaluation. The process is divided into two parts: the symbolic derivation and the numerical calculation.\n\nThe smoothed total variation functional $R_{\\varepsilon}(\\boldsymbol{\\rho})$ is given as a sum over the elements of a one-dimensional grid:\n$$\nR_{\\varepsilon}(\\boldsymbol{\\rho}) = \\sum_{j=1}^{N-1} \\sqrt{(\\rho_{j+1} - \\rho_{j})^{2} + \\varepsilon^{2}}\n$$\nThis expression represents a finite-difference discretization of the continuous functional $\\int \\sqrt{(\\frac{\\partial \\rho}{\\partial x})^2 + \\varepsilon^2} dx$, where the difference $\\rho_{j+1} - \\rho_{j}$ approximates the spatial derivative $\\frac{\\partial \\rho}{\\partial x}$.\n\nWe are asked to find the partial derivative $\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}}$ for an interior index $i$, where $i \\in \\{2, \\dots, N-1\\}$. The derivative operator is linear, so we can take the derivative of the sum term by term:\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = \\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sum_{j=1}^{N-1} \\sqrt{(\\rho_{j+1} - \\rho_{j})^{2} + \\varepsilon^{2}} \\right) = \\sum_{j=1}^{N-1} \\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{j+1} - \\rho_{j})^{2} + \\varepsilon^{2}} \\right)\n$$\nFor an interior index $i$, the design variable $\\rho_i$ only appears in two terms of the summation: the term where $j=i-1$ and the term where $j=i$. All other terms have a partial derivative of zero with respect to $\\rho_i$. The two relevant terms are:\n\\begin{enumerate}\n    \\item For $j=i-1$: $\\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}}$\n    \\item For $j=i$: $\\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}}$\n\\end{enumerate}\n\nThus, the partial derivative simplifies to:\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = \\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}} \\right) + \\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}} \\right)\n$$\nWe apply the chain rule to each term. For a function of the form $\\sqrt{u(x)}$, its derivative is $\\frac{1}{2\\sqrt{u(x)}} \\frac{du}{dx}$.\n\nFor the first term, let $u(\\rho_i) = (\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}$. The derivative with respect to $\\rho_i$ is $\\frac{\\partial u}{\\partial \\rho_i} = 2(\\rho_i - \\rho_{i-1}) \\cdot 1 = 2(\\rho_i - \\rho_{i-1})$.\nSo, the derivative of the first term is:\n$$\n\\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}} \\right) = \\frac{1}{2\\sqrt{(\\rho_{i} - \\rho_{i-1})^{2} + \\varepsilon^{2}}} \\cdot 2(\\rho_i - \\rho_{i-1}) = \\frac{\\rho_i - \\rho_{i-1}}{\\sqrt{(\\rho_i - \\rho_{i-1})^{2} + \\varepsilon^{2}}}\n$$\n\nFor the second term, let $v(\\rho_i) = (\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}$. The derivative with respect to $\\rho_i$ is $\\frac{\\partial v}{\\partial \\rho_i} = 2(\\rho_{i+1} - \\rho_i) \\cdot (-1) = -2(\\rho_{i+1} - \\rho_i)$.\nSo, the derivative of the second term is:\n$$\n\\frac{\\partial}{\\partial \\rho_{i}} \\left( \\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}} \\right) = \\frac{1}{2\\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}}} \\cdot [-2(\\rho_{i+1} - \\rho_i)] = -\\frac{\\rho_{i+1} - \\rho_i}{\\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}}}\n$$\n\nCombining the two results gives the final expression for the partial derivative:\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = \\frac{\\rho_i - \\rho_{i-1}}{\\sqrt{(\\rho_i - \\rho_{i-1})^{2} + \\varepsilon^{2}}} - \\frac{\\rho_{i+1} - \\rho_i}{\\sqrt{(\\rho_{i+1} - \\rho_{i})^{2} + \\varepsilon^{2}}}\n$$\nThis expression represents the sensitivity of the regularization term with respect to a change in the density of an interior element $i$.\n\nNext, we evaluate the additive change in the gradient, $\\Delta g_i$, using the provided numerical data:\n- $\\rho_{i-1} = 0.15$\n- $\\rho_{i} = 0.40$\n- $\\rho_{i+1} = 0.55$\n- $\\varepsilon = 0.05$\n- $\\beta = 2.0$\n\nThe quantity to compute is $\\Delta g_{i} = \\beta \\, \\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}}$. First, we calculate the differences in density:\n- $\\rho_i - \\rho_{i-1} = 0.40 - 0.15 = 0.25$\n- $\\rho_{i+1} - \\rho_i = 0.55 - 0.40 = 0.15$\n\nNow, we substitute these values into the expression for $\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}}$:\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = \\frac{0.25}{\\sqrt{(0.25)^{2} + (0.05)^{2}}} - \\frac{0.15}{\\sqrt{(0.15)^{2} + (0.05)^{2}}}\n$$\nLet's evaluate the terms in the denominators:\n- $(0.25)^{2} + (0.05)^{2} = 0.0625 + 0.0025 = 0.065$\n- $(0.15)^{2} + (0.05)^{2} = 0.0225 + 0.0025 = 0.025$\n\nSubstituting these back into the expression:\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = \\frac{0.25}{\\sqrt{0.065}} - \\frac{0.15}{\\sqrt{0.025}}\n$$\nNumerically evaluating the terms:\n$$\n\\frac{0.25}{\\sqrt{0.065}} \\approx \\frac{0.25}{0.25495098} \\approx 0.98058068\n$$\n$$\n\\frac{0.15}{\\sqrt{0.025}} \\approx \\frac{0.15}{0.15811388} \\approx 0.94868330\n$$\n$$\n\\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} \\approx 0.98058068 - 0.94868330 = 0.03189738\n$$\nNow, we calculate $\\Delta g_i$:\n$$\n\\Delta g_{i} = \\beta \\cdot \\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}} = 2.0 \\times 0.03189738 \\approx 0.06379476\n$$\nThe problem requires the answer to be rounded to four significant figures. The first four significant figures of $0.06379476$ are $6$, $3$, $7$, and $9$. The fifth significant figure is $4$, which is less than $5$, so we round down (truncate).\n$$\n\\Delta g_{i} \\approx 0.06379\n$$\nIn the context of structural optimization, compliance $C(\\boldsymbol{\\rho})$ has units of energy, typically Joules (J). For the objective function $J(\\boldsymbol{\\rho}) = C(\\boldsymbol{\\rho}) + \\beta R_{\\varepsilon}(\\boldsymbol{\\rho})$ to be dimensionally consistent, and since $\\rho_i$ and hence $R_{\\varepsilon}$ are dimensionless, the parameter $\\beta$ must have units of energy (J). Consequently, the gradient contribution $\\Delta g_i = \\beta \\frac{\\partial R_{\\varepsilon}}{\\partial \\rho_{i}}$ also has units of energy (J). The calculated numerical value corresponds to this quantity in Joules.",
            "answer": "$$\n\\boxed{0.06379}\n$$"
        }
    ]
}