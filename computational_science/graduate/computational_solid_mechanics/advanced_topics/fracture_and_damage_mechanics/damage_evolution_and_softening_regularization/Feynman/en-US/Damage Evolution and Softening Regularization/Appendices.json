{
    "hands_on_practices": [
        {
            "introduction": "Understanding material degradation begins with identifying its thermodynamic driving force. This exercise provides a concrete look at the damage energy release rate, $Y$, which quantifies how much strain energy is released as damage progresses. By deriving and calculating $Y$ for a specific strain state, you will connect the abstract concept of a free energy potential to a tangible quantity that governs damage evolution in continuum models .",
            "id": "3556796",
            "problem": "Consider a three-dimensional small-strain state in an isotropic scalar damage model with volumetric-deviatoric split and tension-compression separation. The symmetric strain tensor at a material point is\n$$\n\\boldsymbol{\\varepsilon}\n=\n\\begin{pmatrix}\n0.0020  0.0006  0 \\\\\n0.0006  -0.0008  0 \\\\\n0  0  0.0004\n\\end{pmatrix}.\n$$\nLet the bulk modulus be $\\,\\kappa = 60 \\times 10^{9}\\,$ and the shear modulus be $\\,\\mu = 30 \\times 10^{9}\\,$ in pascals. The damage variable at the point is $\\,d = 0.2\\,$.\n\nUse the following physically motivated and widely adopted base in computational damage mechanics:\n- The small-strain isotropic elastic free energy splits into volumetric and deviatoric parts, with tension-compression separation implemented through the positive and negative parts of the trace, defined by $\\,\\langle x \\rangle_{+} = \\max(x,0)\\,$ and $\\,\\langle x \\rangle_{-} = \\min(x,0)\\,$.\n- The free energy per unit volume is\n$$\n\\psi(\\boldsymbol{\\varepsilon}, d) = g(d)\\left(\\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'\\right) + \\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{-}^{2},\n$$\nwhere $\\,\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})\\mathbf{I}\\,$ is the deviatoric strain, $\\,\\mathbf{I}\\,$ is the identity tensor, and $\\,g(d) = (1 - d)^{2}\\,$ is the degradation function.\n- The damage energy release rate is defined thermodynamically by $\\,Y = -\\frac{\\partial \\psi}{\\partial d}\\,$ at fixed $\\,\\boldsymbol{\\varepsilon}\\,$.\n\nTasks:\n1. Starting from the above base, derive an explicit expression for $\\,Y\\,$ and rewrite it in terms of the spectral decomposition of $\\,\\boldsymbol{\\varepsilon}\\,$, that is, in terms of its principal strains $\\,\\lambda_{i}\\,$ and associated orthonormal eigenvectors $\\,\\mathbf{n}_{i}\\,$, where $\\,\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{3}\\lambda_{i}\\,\\mathbf{n}_{i}\\otimes\\mathbf{n}_{i}\\,$.\n2. Compute $\\,Y\\,$ for the given $\\,\\boldsymbol{\\varepsilon}, \\kappa, \\mu\\,$ and $\\,d\\,$. Express the final numerical value of $\\,Y\\,$ in megapascals (MPa). Round your answer to four significant figures.\n\nYou may assume standard small-strain kinematics and that softening regularization (e.g., through an internal length in a nonlocal or gradient-enhanced formulation) affects the evolution law but not the local thermodynamic definition of $\\,Y\\,$ used here.",
            "solution": "The problem asks for two tasks: first, to derive an expression for the damage energy release rate $Y$ and express it in terms of principal strains, and second, to compute its numerical value for a given strain state and material properties.\n\n### Task 1: Derivation of the Damage Energy Release Rate, $Y$\n\nThe damage energy release rate, $Y$, is defined as the negative partial derivative of the Helmholtz free energy density, $\\psi$, with respect to the damage variable, $d$, holding the strain tensor, $\\boldsymbol{\\varepsilon}$, constant:\n$$\nY = -\\frac{\\partial \\psi(\\boldsymbol{\\varepsilon}, d)}{\\partial d}\n$$\nThe given free energy density is:\n$$\n\\psi(\\boldsymbol{\\varepsilon}, d) = g(d)\\left(\\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'\\right) + \\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{-}^{2}\n$$\nwhere $g(d) = (1-d)^2$, $\\kappa$ is the bulk modulus, $\\mu$ is the shear modulus, $\\boldsymbol{\\varepsilon}'$ is the deviatoric strain tensor, $\\langle x \\rangle_{+} = \\max(x,0)$, and $\\langle x \\rangle_{-} = \\min(x,0)$.\n\nThe second term in the expression for $\\psi$, $\\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{-}^{2}$, does not depend on the damage variable $d$. Therefore, its derivative with respect to $d$ is zero. We compute the derivative of the first term:\n$$\n\\frac{\\partial \\psi}{\\partial d} = \\frac{\\partial}{\\partial d} \\left[ g(d)\\left(\\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'\\right) \\right]\n$$\nHolding $\\boldsymbol{\\varepsilon}$ constant, this becomes:\n$$\n\\frac{\\partial \\psi}{\\partial d} = \\frac{dg(d)}{dd} \\left(\\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'\\right)\n$$\nThe derivative of the degradation function $g(d) = (1-d)^2$ is:\n$$\n\\frac{dg}{dd} = \\frac{d}{dd}(1 - 2d + d^2) = -2 + 2d = -2(1-d)\n$$\nSubstituting this into the expression for $Y$:\n$$\nY = - \\left[ -2(1-d) \\right] \\left(\\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'\\right)\n$$\nThis gives the explicit expression for $Y$:\n$$\nY = 2(1-d) \\left(\\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'\\right)\n$$\nThis part of the free energy, $\\psi_0^+(\\boldsymbol{\\varepsilon}) = \\frac{\\kappa}{2}\\,\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{+}^{2} + \\mu\\,\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'$, is the portion of the strain energy that drives damage evolution. It corresponds to the tensile volumetric response and the entire deviatoric (shear) response.\n\nNext, we rewrite this expression in terms of the principal strains, $\\lambda_i$, of $\\boldsymbol{\\varepsilon}$. The spectral decomposition of the strain tensor is $\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{3}\\lambda_{i}\\,\\mathbf{n}_{i}\\otimes\\mathbf{n}_{i}$.\n\nThe trace of the strain tensor is the sum of its principal strains:\n$$\n\\operatorname{tr}\\boldsymbol{\\varepsilon} = \\sum_{i=1}^{3} \\lambda_i\n$$\nThe deviatoric strain tensor, $\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})\\mathbf{I}$, has principal values $\\lambda'_i = \\lambda_i - \\frac{1}{3}\\operatorname{tr}\\boldsymbol{\\varepsilon}$. The double dot product $\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'$ is the sum of the squares of the components of $\\boldsymbol{\\varepsilon}'$ in an orthonormal basis. In the basis of eigenvectors $\\{\\mathbf{n}_i\\}$, this is the sum of the squares of its principal values:\n$$\n\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}' = \\sum_{i=1}^{3} (\\lambda'_i)^2 = \\sum_{i=1}^{3} \\left(\\lambda_i - \\frac{1}{3}\\operatorname{tr}\\boldsymbol{\\varepsilon}\\right)^2\n$$\nExpanding this expression gives:\n$$\n\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}' = \\sum_{i=1}^{3} \\left(\\lambda_i^2 - \\frac{2}{3}\\lambda_i \\operatorname{tr}\\boldsymbol{\\varepsilon} + \\frac{1}{9}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^2\\right) = \\left(\\sum_{i=1}^{3} \\lambda_i^2\\right) - \\frac{2}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})\\left(\\sum_{i=1}^{3} \\lambda_i\\right) + 3 \\cdot \\frac{1}{9}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^2\n$$\nSince $\\sum_{i=1}^{3} \\lambda_i = \\operatorname{tr}\\boldsymbol{\\varepsilon}$, this simplifies to:\n$$\n\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}' = \\left(\\sum_{i=1}^{3} \\lambda_i^2\\right) - \\frac{2}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^2 + \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^2 = \\left(\\sum_{i=1}^{3} \\lambda_i^2\\right) - \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^2\n$$\nSubstituting the spectral forms of $\\operatorname{tr}\\boldsymbol{\\varepsilon}$ and $\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'$ into the expression for $Y$, we obtain:\n$$\nY = 2(1-d) \\left[ \\frac{\\kappa}{2} \\left\\langle \\sum_{i=1}^{3} \\lambda_i \\right\\rangle_{+}^{2} + \\mu \\left( \\left(\\sum_{i=1}^{3} \\lambda_i^2\\right) - \\frac{1}{3}\\left(\\sum_{i=1}^{3} \\lambda_i\\right)^2 \\right) \\right]\n$$\nThis completes the first task.\n\n### Task 2: Computation of $Y$\n\nWe are given the following:\n- Strain tensor: $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 0.0020  0.0006  0 \\\\ 0.0006  -0.0008  0 \\\\ 0  0  0.0004 \\end{pmatrix}$\n- Bulk modulus: $\\kappa = 60 \\times 10^{9}$ Pa\n- Shear modulus: $\\mu = 30 \\times 10^{9}$ Pa\n- Damage variable: $d = 0.2$\n\nTo compute $Y$, we need to evaluate $\\operatorname{tr}\\boldsymbol{\\varepsilon}$ and $\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'$.\n\nFirst, we compute the trace of the strain tensor:\n$$\n\\operatorname{tr}\\boldsymbol{\\varepsilon} = \\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33} = 0.0020 + (-0.0008) + 0.0004 = 0.0016\n$$\nSince $\\operatorname{tr}\\boldsymbol{\\varepsilon} = 0.0016  0$, we have:\n$$\n\\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{+} = 0.0016 \\quad \\text{and} \\quad \\langle \\operatorname{tr}\\boldsymbol{\\varepsilon} \\rangle_{-} = 0\n$$\nThe second term in the free energy expression is zero, which is consistent with our derivation for $Y$.\n\nNext, we compute the invariant $\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'$. We can use the identity $\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}' = \\operatorname{tr}(\\boldsymbol{\\varepsilon}^2) - \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^2$. This avoids explicitly calculating the principal strains. First, we compute $\\boldsymbol{\\varepsilon}^2$:\n$$\n\\boldsymbol{\\varepsilon}^2 = \\boldsymbol{\\varepsilon}\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 0.0020  0.0006  0 \\\\ 0.0006  -0.0008  0 \\\\ 0  0  0.0004 \\end{pmatrix} \\begin{pmatrix} 0.0020  0.0006  0 \\\\ 0.0006  -0.0008  0 \\\\ 0  0  0.0004 \\end{pmatrix}\n$$\nThe diagonal components of $\\boldsymbol{\\varepsilon}^2$ are:\n$$\n(\\varepsilon^2)_{11} = (0.0020)^2 + (0.0006)^2 = 0.000004 + 0.00000036 = 0.00000436\n$$\n$$\n(\\varepsilon^2)_{22} = (0.0006)^2 + (-0.0008)^2 = 0.00000036 + 0.00000064 = 0.000001\n$$\n$$\n(\\varepsilon^2)_{33} = (0.0004)^2 = 0.00000016\n$$\nThe trace of $\\boldsymbol{\\varepsilon}^2$ is the sum of these diagonal components:\n$$\n\\operatorname{tr}(\\boldsymbol{\\varepsilon}^2) = 0.00000436 + 0.000001 + 0.00000016 = 0.00000552 = 5.52 \\times 10^{-6}\n$$\nNow we compute $\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}'$:\n$$\n\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}' = \\operatorname{tr}(\\boldsymbol{\\varepsilon}^2) - \\frac{1}{3}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^2 = 5.52 \\times 10^{-6} - \\frac{1}{3}(0.0016)^2\n$$\n$$\n\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}' = 5.52 \\times 10^{-6} - \\frac{1}{3}(2.56 \\times 10^{-6}) = (5.52 - \\frac{2.56}{3}) \\times 10^{-6} = \\left(\\frac{16.56 - 2.56}{3}\\right) \\times 10^{-6} = \\frac{14}{3} \\times 10^{-6}\n$$\nSo, $\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}' = \\frac{14}{3} \\times 10^{-6}$.\n\nNow we can compute the value of $Y$. Since $\\operatorname{tr}\\boldsymbol{\\varepsilon}  0$, the expression for $Y$ simplifies to:\n$$\nY = 2(1-d) \\left(\\frac{\\kappa}{2}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^{2} + \\mu(\\boldsymbol{\\varepsilon}' : \\boldsymbol{\\varepsilon}')\\right)\n$$\nSubstitute the numerical values:\n$$\nY = 2(1-0.2) \\left(\\frac{60 \\times 10^9}{2}(0.0016)^2 + (30 \\times 10^9)\\left(\\frac{14}{3} \\times 10^{-6}\\right)\\right)\n$$\n$$\nY = 2(0.8) \\left( (30 \\times 10^9)(2.56 \\times 10^{-6}) + (10 \\times 10^9)(14 \\times 10^{-6}) \\right)\n$$\n$$\nY = 1.6 \\left( (30 \\times 2.56) \\times 10^3 + 140 \\times 10^3 \\right)\n$$\n$$\nY = 1.6 \\left( 76.8 \\times 10^3 + 140 \\times 10^3 \\right) = 1.6 \\left( (76.8 + 140) \\times 10^3 \\right)\n$$\n$$\nY = 1.6 \\left( 216.8 \\times 10^3 \\right) = 346.88 \\times 10^3 \\text{ Pa}\n$$\nThe result is $Y = 346880$ Pa. The problem asks for the answer in megapascals (MPa), where $1 \\text{ MPa} = 10^6 \\text{ Pa}$.\n$$\nY = \\frac{346880}{10^6} \\text{ MPa} = 0.34688 \\text{ MPa}\n$$\nFinally, rounding the result to four significant figures gives:\n$$\nY \\approx 0.3469 \\text{ MPa}\n$$",
            "answer": "$$\n\\boxed{0.3469}\n$$"
        },
        {
            "introduction": "While local damage models are conceptually simple, they suffer from a critical flaw when simulating strain softening: pathological mesh dependency. This practice explores this fundamental challenge by analyzing a one-dimensional bar, demonstrating how naive models predict that a structure's energy dissipation vanishes upon mesh refinement. You will derive the classic 'crack band' regularization, a foundational technique that ensures the dissipated energy matches the material's fracture energy, $G_f$, rendering the simulation results objective .",
            "id": "3556745",
            "problem": "Consider a one-dimensional bar discretized by the Finite Element Method (FEM) into elements of length $h$. The material exhibits a tensile strength $f_t$ and, after reaching this peak, undergoes strain-softening that is localized within a single element. Adopt a smeared-crack representation in which the post-peak response is described by a stress versus inelastic strain law $\\sigma(\\varepsilon)$, where $\\varepsilon$ is the inelastic strain that accumulates within the localization band. The fracture energy per unit crack area $G_f$ is defined as the work of the traction-separation law associated with a physical crack. Assume that the traction transmitted across the localization band in the smeared model equals the nominal stress $\\sigma(\\varepsilon)$, and that the crack opening displacement is the product of the inelastic strain and the localization bandwidth.\n\nStarting from the definition of fracture energy and the equivalence of work between a discrete cohesive crack and its smeared representation, derive the mesh-objective condition that links $h$, $\\sigma(\\varepsilon)$, and $G_f$. Then, for a linear softening law\n$$\n\\sigma(\\varepsilon) = f_t\\left(1 - \\frac{\\varepsilon}{\\varepsilon_f}\\right), \\quad 0 \\le \\varepsilon \\le \\varepsilon_f,\n$$\nwhere $\\varepsilon_f$ is the terminal inelastic strain at which the stress vanishes, compute the closed-form expression for $\\varepsilon_f$ that enforces mesh-objectivity.\n\nYour final answer must be a single analytical expression for $\\varepsilon_f$. No numerical values are required. Because strain is dimensionless, no units need be reported in the final answer.",
            "solution": "The problem statement will first be validated for scientific correctness, consistency, and completeness.\n\n**Step 1: Extract Givens**\n- Discretization: One-dimensional bar discretized by Finite Element Method (FEM) into elements of length $h$.\n- Material Properties: Tensile strength $f_t$, fracture energy per unit crack area $G_f$.\n- Constitutive Behavior: Strain-softening is localized within a single element. A smeared-crack model is used with a stress versus inelastic strain law $\\sigma(\\varepsilon)$.\n- Softening Law: A specific linear softening law is provided: $\\sigma(\\varepsilon) = f_t\\left(1 - \\frac{\\varepsilon}{\\varepsilon_f}\\right)$ for $0 \\le \\varepsilon \\le \\varepsilon_f$.\n- Definitions and Assumptions:\n    - $\\varepsilon$ is the inelastic strain within the localization band.\n    - $G_f$ is the work of the traction-separation law for a discrete physical crack.\n    - Traction across localization band equals nominal stress $\\sigma(\\varepsilon)$.\n    - Crack opening displacement is the product of inelastic strain and localization bandwidth.\n    - $\\varepsilon_f$ is the terminal inelastic strain where stress vanishes.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is firmly rooted in the theory of computational fracture mechanics, specifically addressing the well-known issue of mesh-dependency in strain-softening models. The concepts of fracture energy ($G_f$), smeared cracks, and energy-based regularization are standard and scientifically sound.\n- **Well-Posed:** The problem is well-posed. It provides a clear objective (derive a mesh-objective condition and then find $\\varepsilon_f$), sufficient data, and the necessary assumptions to link the smeared continuum model to the discrete fracture concept. A unique solution is attainable.\n- **Objective:** The language is formal, precise, and free of any subjective or ambiguous terminology.\n- **Completeness and Consistency:** The problem is self-contained. The provided definitions and assumptions are consistent and sufficient for the derivation. The localization of softening into a single element of size $h$ implies that the localization bandwidth, a characteristic length, should be taken as $h$. This is a standard assumption in the crack band model, which this problem describes.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Derivation and Solution**\n\nThe core of the problem is to establish an equivalence between the energy dissipated in forming a discrete crack and the energy dissipated within the volume of a finite element that represents the smeared crack.\n\nThe fracture energy, $G_f$, is defined as the energy dissipated per unit area of crack formation. For a discrete crack, this is the integral of the traction, $T$, over the crack opening displacement, $w$:\n$$\nG_f = \\int T(w) \\, dw\n$$\nIn the smeared crack model, the energy dissipation occurs within a material volume. The energy dissipated per unit volume, $g_f$, is the integral of the stress, $\\sigma$, over the inelastic strain, $\\varepsilon$:\n$$\ng_f = \\int \\sigma(\\varepsilon) \\, d\\varepsilon\n$$\nThe problem states that the total energy dissipated in creating a crack of area $A$ must be the same in both models. In the discrete model, this energy is $W_{discrete} = G_f A$. In the smeared model, the energy is dissipated over the volume of the localization band, which is the volume of the finite element where softening occurs. This volume is $V = A l_c$, where $A$ is the cross-sectional area and $l_c$ is the localization bandwidth. The total energy dissipated in the smeared model is $W_{smeared} = g_f V = g_f A l_c$.\n\nEquating the dissipated energies:\n$$\nW_{discrete} = W_{smeared}\n$$\n$$\nG_f A = g_f A l_c\n$$\nCanceling the area $A$, we get the fundamental relationship between the fracture energy per unit area ($G_f$) and the dissipated energy per unit volume ($g_f$):\n$$\nG_f = g_f l_c\n$$\nThe problem specifies that localization occurs within a single finite element of length $h$. In the context of the crack band model, the localization bandwidth $l_c$ is set equal to a characteristic length of the element, which in this one-dimensional case is its length $h$. Thus, $l_c = h$. Substituting this and the integral form of $g_f$ gives the mesh-objective condition:\n$$\nG_f = h \\int \\sigma(\\varepsilon) \\, d\\varepsilon\n$$\nThe integration is performed over the entire softening process, from the onset of inelastic strain ($\\varepsilon=0$) to the point of complete stress degradation ($\\varepsilon=\\varepsilon_f$).\n$$\nG_f = h \\int_{0}^{\\varepsilon_f} \\sigma(\\varepsilon) \\, d\\varepsilon\n$$\nThis equation ensures that the total dissipated energy remains constant and equal to the material property $G_f$, regardless of the mesh size $h$, thereby achieving mesh objectivity. To do so, the constitutive law $\\sigma(\\varepsilon)$ must be adjusted depending on $h$.\n\nNext, we apply this condition to the given linear softening law:\n$$\n\\sigma(\\varepsilon) = f_t\\left(1 - \\frac{\\varepsilon}{\\varepsilon_f}\\right)\n$$\nWe substitute this expression into the integral:\n$$\nG_f = h \\int_{0}^{\\varepsilon_f} f_t\\left(1 - \\frac{\\varepsilon}{\\varepsilon_f}\\right) \\, d\\varepsilon\n$$\nSince $f_t$ is a constant, it can be moved outside the integral:\n$$\nG_f = h f_t \\int_{0}^{\\varepsilon_f} \\left(1 - \\frac{\\varepsilon}{\\varepsilon_f}\\right) \\, d\\varepsilon\n$$\nThe integral represents the area under the linear $\\sigma$-$\\varepsilon$ curve, which is a triangle with height $f_t$ and base $\\varepsilon_f$. Evaluating the integral formally:\n$$\nG_f = h f_t \\left[ \\varepsilon - \\frac{\\varepsilon^2}{2 \\varepsilon_f} \\right]_{0}^{\\varepsilon_f}\n$$\n$$\nG_f = h f_t \\left( \\left(\\varepsilon_f - \\frac{\\varepsilon_f^2}{2 \\varepsilon_f}\\right) - (0 - 0) \\right)\n$$\n$$\nG_f = h f_t \\left( \\varepsilon_f - \\frac{\\varepsilon_f}{2} \\right)\n$$\n$$\nG_f = h f_t \\left( \\frac{\\varepsilon_f}{2} \\right) = \\frac{1}{2} h f_t \\varepsilon_f\n$$\nThe final step is to solve this equation for the terminal inelastic strain, $\\varepsilon_f$, which enforces mesh-objectivity for the given linear softening law.\n$$\n\\varepsilon_f = \\frac{2 G_f}{h f_t}\n$$\nThis result shows that to maintain a constant fracture energy $G_f$, the terminal strain $\\varepsilon_f$ in the constitutive law must be scaled inversely with the element size $h$ and the material's tensile strength $f_t$.",
            "answer": "$$\n\\boxed{\\frac{2 G_f}{h f_t}}\n$$"
        },
        {
            "introduction": "Modern damage models often use gradient-enhancements to regularize the softening response, leading to a set of coupled partial differential equations. Ensuring your numerical code correctly solves these equations is a non-trivial but essential task. This advanced practice introduces the Method of Manufactured Solutions (MMS), a powerful technique for code verification, where you will derive the necessary source terms to make a chosen analytical function an exact solution to the governing equations of a phase-field damage model .",
            "id": "3556807",
            "problem": "Consider a one-dimensional small-strain quasi-static damage model on the unit interval with spatial coordinate $x \\in [0,1]$. Let the displacement field be $u(x)$ and the scalar damage field be $d(x) \\in [0,1]$. Adopt the following standard total free energy density per unit reference length as the fundamental starting point:\n$$\n\\psi(u,d,d') \\;=\\; g(d)\\,\\frac{1}{2}\\,E\\,\\big(u'(x)\\big)^2 \\;+\\; G_c\\left(\\frac{w(d)}{2\\,\\ell} + \\frac{\\ell}{2}\\,(d'(x))^2\\right),\n$$\nwhere $E0$ is the Young’s modulus, $G_c0$ is the fracture energy, $\\ell0$ is the internal length scale, $g(d)$ is the degradation function, and $w(d)$ is the crack geometric function. Assume the degradation function is\n$$\ng(d) \\;=\\; (1-d)^2 + \\kappa,\n$$\nwith a small regularization parameter $\\kappa \\in (0,1)$, and the crack function is\n$$\nw(d) \\;=\\; d^2.\n$$\nBy first principles, the Euler–Lagrange equations associated with stationarity of the total potential energy, including external sources, are the mechanical equilibrium\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big( E\\,g(d)\\,u'(x)\\Big) \\;=\\; b(x),\n$$\nand the damage microforce balance\n$$\nG_c\\left(\\frac{w'(d)}{2\\,\\ell} - \\ell\\,d''(x)\\right) \\;+\\; g'(d)\\,\\frac{1}{2}\\,E\\,\\big(u'(x)\\big)^2 \\;=\\; s(x),\n$$\nwhere $b(x)$ is the prescribed body force density and $s(x)$ is the prescribed damage microforce source.\n\nYou are to use the method of manufactured solutions. Let the target exact fields be\n$$\nu(x) \\;=\\; A\\,x\\,(1-x), \\qquad d(x) \\;=\\; \\sin(\\pi x),\n$$\nwith a given scalar amplitude $A \\in \\mathbb{R}$. Your tasks are:\n1. Starting only from the fundamental definitions above and the specified $g(d)$ and $w(d)$, derive explicit closed-form expressions for the body force $b(x)$ and the microforce source $s(x)$ that make the above Euler–Lagrange equations hold pointwise for the manufactured fields $u(x)$ and $d(x)$ on the open interval $(0,1)$.\n2. Implement a numerical verification by evaluating the residuals of both Euler–Lagrange equations using second-order centered finite differences on a uniform grid on $[0,1]$. Use analytic formulas for $b(x)$ and $s(x)$ obtained in item 1, but approximate the derivatives $u'(x)$, $d''(x)$, and $\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(E g(d) u'(x)\\big)$ numerically. Exclude the two boundary points from the residual evaluation to avoid boundary closure effects.\n3. For each parameter set below (test suite), compute a dimensionless combined verification metric defined as the maximum of the two normalized infinity norms:\n$$\n\\mathcal{R} \\;=\\; \\max\\!\\left(\\frac{\\|-\\big(E g(d) u'(x)\\big)' - b(x)\\|_{\\infty}}{\\max\\{1,\\ \\|b(x)\\|_{\\infty}\\}},\\ \\frac{\\big\\|G_c\\big(\\tfrac{w'(d)}{2\\ell} - \\ell d''(x)\\big) + g'(d)\\tfrac{1}{2}E\\big(u'(x)\\big)^2 - s(x)\\big\\|_{\\infty}}{\\max\\{1,\\ \\|s(x)\\|_{\\infty}\\}}\\right),\n$$\nevaluated over the interior grid points only. Report one scalar $\\mathcal{R}$ per parameter set. This quantity must be reported as a unitless real number.\n\nUse the following test suite, where each case is the tuple $(E,\\ G_c,\\ \\ell,\\ A,\\ \\kappa)$:\n- Case 1: $(2.10\\times 10^{11},\\ 2.7\\times 10^{3},\\ 2.0\\times 10^{-2},\\ 5.0\\times 10^{-2},\\ 1.0\\times 10^{-6})$\n- Case 2: $(3.0\\times 10^{7},\\ 1.5\\times 10^{3},\\ 1.0\\times 10^{-1},\\ 5.0\\times 10^{-1},\\ 1.0\\times 10^{-8})$\n- Case 3: $(1.0\\times 10^{9},\\ 1.0\\times 10^{3},\\ 1.0\\times 10^{-2},\\ 0.0,\\ 1.0\\times 10^{-6})$\n- Case 4: $(7.0\\times 10^{10},\\ 3.0\\times 10^{3},\\ 5.0\\times 10^{-3},\\ 2.0\\times 10^{-2},\\ 1.0\\times 10^{-6})$\n\nNumerical details to enforce:\n- Use a uniform grid with at least $N=5001$ points on $[0,1]$.\n- Use second-order accurate finite differences. For first derivatives at the two boundary points, use standard second-order one-sided approximations. For second derivatives and for the residual evaluation, use interior centered formulas and exclude the two endpoints from the infinity norms.\n- Compute $b(x)$ and $s(x)$ exactly from the derived closed forms at the grid points.\n- All reported residual metrics $\\mathcal{R}$ must be computed as unitless quantities as defined above.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases given above, for example, something like \"[r1,r2,r3,r4]\". Each entry must be a real number in decimal or scientific notation with no units attached.",
            "solution": "The problem is valid as it is scientifically grounded in the theory of continuum damage mechanics, mathematically well-posed, objective, and provides a complete and consistent set of definitions and parameters for a code verification task using the method of manufactured solutions.\n\nThe solution proceeds in two stages. First, we derive the analytical expressions for the source terms $b(x)$ and $s(x)$. Second, we describe the numerical procedure to verify these expressions by computing the residuals of the governing equations.\n\n### Part 1: Analytical Derivation of Source Terms\n\nThe method of manufactured solutions requires us to find the source terms $b(x)$ and $s(x)$ such that the given fields $u(x)$ and $d(x)$ are exact solutions to the Euler-Lagrange equations.\n\nThe manufactured solutions are:\n$$\nu(x) = A\\,x\\,(1-x)\n$$\n$$\nd(x) = \\sin(\\pi x)\n$$\nWe first compute their necessary derivatives:\n$$\nu'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left(A(x-x^2)\\right) = A(1-2x)\n$$\n$$\nd'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\sin(\\pi x) = \\pi \\cos(\\pi x)\n$$\n$$\nd''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} (\\pi \\cos(\\pi x)) = -\\pi^2 \\sin(\\pi x)\n$$\nNext, we evaluate the given constitutive functions and their derivatives for the manufactured damage field $d(x)$:\n$$\ng(d(x)) = (1-\\sin(\\pi x))^2 + \\kappa\n$$\n$$\ng'(d(x)) = -2(1-d(x)) = -2(1-\\sin(\\pi x))\n$$\n$$\nw'(d(x)) = 2 d(x) = 2\\sin(\\pi x)\n$$\n\n**Derivation of the body force $b(x)$:**\nThe body force $b(x)$ is defined by the mechanical equilibrium equation:\n$$\nb(x) = -\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big( E\\,g(d)\\,u'(x)\\Big)\n$$\nLet the term inside the derivative be $\\sigma(x) = E\\,g(d(x))\\,u'(x)$. Substituting the expressions for $g(d(x))$ and $u'(x)$:\n$$\n\\sigma(x) = E \\Big( (1-\\sin(\\pi x))^2 + \\kappa \\Big) A(1-2x)\n$$\nWe differentiate $\\sigma(x)$ with respect to $x$ using the product rule:\n$$\n\\sigma'(x) = E A \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left[ \\Big( (1-\\sin(\\pi x))^2 + \\kappa \\Big) (1-2x) \\right]\n$$\n$$\n\\sigma'(x) = E A \\left[ \\Big( 2(1-\\sin(\\pi x))(-\\pi\\cos(\\pi x)) \\Big) (1-2x) + \\Big( (1-\\sin(\\pi x))^2 + \\kappa \\Big) (-2) \\right]\n$$\n$$\n\\sigma'(x) = -2AE\\pi(1-2x)(1-\\sin(\\pi x))\\cos(\\pi x) - 2AE\\Big((1-\\sin(\\pi x))^2 + \\kappa\\Big)\n$$\nSince $b(x) = -\\sigma'(x)$, the final expression for the body force is:\n$$\nb(x) = 2AE\\pi(1-2x)(1-\\sin(\\pi x))\\cos(\\pi x) + 2AE\\Big((1-\\sin(\\pi x))^2 + \\kappa\\Big)\n$$\n\n**Derivation of the microforce source $s(x)$:**\nThe microforce source $s(x)$ is defined by the damage microforce balance equation:\n$$\ns(x) = G_c\\left(\\frac{w'(d)}{2\\,\\ell} - \\ell\\,d''(x)\\right) + g'(d)\\,\\frac{1}{2}\\,E\\,\\big(u'(x)\\big)^2\n$$\nWe substitute the derived expressions for $w'(d)$, $d''(x)$, $g'(d)$, and $u'(x)$:\n$$\ns(x) = G_c\\left(\\frac{2\\sin(\\pi x)}{2\\,\\ell} - \\ell(-\\pi^2 \\sin(\\pi x))\\right) + \\Big(-2(1-\\sin(\\pi x))\\Big)\\,\\frac{1}{2}\\,E\\,\\Big(A(1-2x)\\Big)^2\n$$\nSimplifying this expression yields:\n$$\ns(x) = G_c\\left(\\frac{\\sin(\\pi x)}{\\ell} + \\ell\\pi^2 \\sin(\\pi x)\\right) - E A^2 (1-\\sin(\\pi x))(1-2x)^2\n$$\nThis can be further factored as:\n$$\ns(x) = G_c \\sin(\\pi x) \\left(\\frac{1}{\\ell} + \\ell\\pi^2\\right) - E A^2 (1-\\sin(\\pi x))(1-2x)^2\n$$\n\n### Part 2: Numerical Verification Procedure\n\nTo verify these derivations, we compute the residuals of the two governing equations on a discrete grid. The problem states that the source terms $b(x)$ and $s(x)$ are to be computed using the exact analytical formulas derived above, while all derivative terms in the Euler-Lagrange equations are to be approximated using finite differences. The verification metric $\\mathcal{R}$ measures the discrepancy, which should be close to the machine precision or limited by the truncation error of the numerical scheme.\n\nLet the domain $[0,1]$ be discretized into a uniform grid of $N$ points $x_i = i h$ for $i=0, 1, \\dots, N-1$, where $h=1/(N-1)$ is the grid spacing. We use $N=5001$.\n\n**Numerical derivatives:**\nWe use second-order accurate finite difference formulas.\nFor a function $f(x)$ on the grid, $f_i = f(x_i)$:\n- First derivative (central): $f'(x_i) \\approx \\frac{f_{i+1} - f_{i-1}}{2h}$ for $i \\in [1, N-2]$.\n- First derivative (forward, boundary): $f'(x_0) \\approx \\frac{-3f_0 + 4f_1 - f_2}{2h}$.\n- First derivative (backward, boundary): $f'(x_{N-1}) \\approx \\frac{3f_{N-1} - 4f_{N-2} + f_{N-3}}{2h}$.\n- Second derivative (central): $f''(x_i) \\approx \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2}$ for $i \\in [1, N-2]$.\n\n**Residuals:**\nThe residuals are evaluated only on the interior grid points $i=1, \\dots, N-2$.\n\n- **Mechanical Residual ($R_{\\text{mech}}$):**\n  The residual is $R_{\\text{mech}, i} = -\\left[\\frac{\\mathrm{d}}{\\mathrm{d}x}\\Big( E\\,g(d)\\,u'\\Big)\\right]_{x_i}^{\\text{num}} - b(x_i)$.\n  1. Compute the numerical derivative of displacement, $u'_{\\text{num}, i}$, for all points $i=0, \\dots, N-1$.\n  2. Compute the numerical flux $q_i = E\\,g(d(x_i))\\,u'_{\\text{num}, i}$ for all points $i=0, \\dots, N-1$.\n  3. Compute the numerical derivative of the flux, $q'_{i} = \\frac{q_{i+1}-q_{i-1}}{2h}$, for interior points $i=1, \\dots, N-2$.\n  4. The residual is $R_{\\text{mech}, i} = -q'_{i} - b(x_i)$ for $i=1, \\dots, N-2$.\n\n- **Damage Residual ($R_{\\text{dam}}$):**\n  The residual is $R_{\\text{dam}, i} = \\left[G_c\\left(\\frac{w'(d)}{2\\,\\ell} - \\ell\\,d''\\right) + g'(d)\\frac{1}{2}E(u')^2\\right]_{x_i}^{\\text{num}} - s(x_i)$.\n  1. Compute the numerical second derivative of damage, $d''_{\\text{num}, i}$, for interior points $i=1, \\dots, N-2$.\n  2. Use the numerical first derivative of displacement, $u'_{\\text{num}, i}$, for interior points.\n  3. The residual is computed as:\n  $R_{\\text{dam}, i} = G_c\\left(\\frac{w'(d(x_i))}{2\\,\\ell} - \\ell\\,d''_{\\text{num}, i}\\right) + g'(d(x_i))\\frac{1}{2}E(u'_{\\text{num}, i})^2 - s(x_i)$ for $i=1, \\dots, N-2$.\n\nFinally, the verification metric $\\mathcal{R}$ is computed as the maximum of the normalized infinity norms of the two residual vectors, evaluated over the interior points:\n$$\n\\mathcal{R} = \\max\\left(\\frac{\\|R_{\\text{mech}}\\|_{\\infty}}{\\max(1, \\|b\\|_{\\infty})}, \\frac{\\|R_{\\text{dam}}\\|_{\\infty}}{\\max(1, \\|s\\|_{\\infty})}\\right)\n$$\nwhere $\\| \\cdot \\|_{\\infty}$ denotes the maximum absolute value of the vector components. The normalization by $\\max(1, \\|\\cdot\\|_{\\infty})$ ensures a meaningful measure even when a source term is zero. This process is repeated for each parameter set in the test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the verification metric for the given damage mechanics problem\n    using the method of manufactured solutions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (2.10e11, 2.7e3, 2.0e-2, 5.0e-2, 1.0e-6),\n        (3.0e7, 1.5e3, 1.0e-1, 5.0e-1, 1.0e-8),\n        (1.0e9, 1.0e3, 1.0e-2, 0.0, 1.0e-6),\n        (7.0e10, 3.0e3, 5.0e-3, 2.0e-2, 1.0e-6),\n    ]\n\n    results = []\n    \n    # Numerical parameters\n    N = 5001\n    h = 1.0 / (N - 1)\n    x = np.linspace(0, 1, N)\n\n    for case in test_cases:\n        E, Gc, ell, A, kappa = case\n\n        # --- Part 1: Analytical and Manufactured Fields ---\n\n        # Manufactured solutions and their analytical derivatives\n        u = A * x * (1 - x)\n        d = np.sin(np.pi * x)\n\n        # Constitutive functions evaluated on the manufactured damage field\n        g_d = (1 - d)**2 + kappa\n        g_prime_d = -2 * (1 - d)\n        w_prime_d = 2 * d\n\n        # Analytical source terms b(x) and s(x)\n        # b(x) = 2*A*E*pi*(1-2x)*(1-sin(pi*x))*cos(pi*x) + 2*A*E*((1-sin(pi*x))^2 + kappa)\n        term_b1 = 2 * A * E * np.pi * (1 - 2 * x) * (1 - np.sin(np.pi * x)) * np.cos(np.pi * x)\n        term_b2 = 2 * A * E * ((1 - np.sin(np.pi * x))**2 + kappa)\n        b_analytic = term_b1 + term_b2\n\n        # s(x) = Gc*sin(pi*x)*(1/l + l*pi^2) - E*A^2*(1-sin(pi*x))*(1-2x)^2\n        term_s1 = Gc * np.sin(np.pi * x) * (1/ell + ell * np.pi**2)\n        term_s2 = - E * A**2 * (1 - np.sin(np.pi * x)) * (1 - 2*x)**2\n        s_analytic = term_s1 + term_s2\n\n        # --- Part 2: Numerical Verification ---\n\n        # Compute numerical derivatives using second-order finite differences\n        # u'(x)\n        u_prime_num = np.zeros_like(x)\n        u_prime_num[1:-1] = (u[2:] - u[:-2]) / (2 * h) # Central difference\n        u_prime_num[0] = (-3*u[0] + 4*u[1] - u[2]) / (2 * h) # Forward difference\n        u_prime_num[-1] = (3*u[-1] - 4*u[-2] + u[-3]) / (2 * h) # Backward difference\n        \n        # d''(x)\n        d_double_prime_num = (d[2:] - 2*d[1:-1] + d[:-2]) / (h**2) # Central difference for interior points\n\n        # --- Part 3: Residual Calculation for Interior Points ---\n\n        # Mechanical residual: res_mech = - (E g(d) u')' - b\n        # 1. Compute flux term q = E * g(d) * u'\n        q_num = E * g_d * u_prime_num\n        # 2. Compute derivative of flux q'\n        q_prime_num = (q_num[2:] - q_num[:-2]) / (2 * h)\n        # 3. Compute residual\n        res_mech = -q_prime_num - b_analytic[1:-1]\n\n        # Damage residual: res_dam = Gc(w'/2l - l*d'') + g'*E*(u')^2/2 - s\n        u_prime_num_interior_sq = u_prime_num[1:-1]**2\n        \n        term1_dam = Gc * (w_prime_d[1:-1] / (2 * ell) - ell * d_double_prime_num)\n        term2_dam = g_prime_d[1:-1] * 0.5 * E * u_prime_num_interior_sq\n        res_dam = term1_dam + term2_dam - s_analytic[1:-1]\n\n        # --- Final Verification Metric R ---\n        \n        # Infinity norms of residuals\n        norm_res_mech = np.max(np.abs(res_mech))\n        norm_res_dam = np.max(np.abs(res_dam))\n\n        # Infinity norms of source terms (on interior points) for normalization\n        norm_b = np.max(np.abs(b_analytic[1:-1]))\n        norm_s = np.max(np.abs(s_analytic[1:-1]))\n        \n        # Normalized norms\n        norm_mech_normalized = norm_res_mech / np.max([1.0, norm_b])\n        norm_dam_normalized = norm_res_dam / np.max([1.0, norm_s])\n        \n        # Combined verification metric R\n        R = np.max([norm_mech_normalized, norm_dam_normalized])\n        results.append(R)\n        \n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}