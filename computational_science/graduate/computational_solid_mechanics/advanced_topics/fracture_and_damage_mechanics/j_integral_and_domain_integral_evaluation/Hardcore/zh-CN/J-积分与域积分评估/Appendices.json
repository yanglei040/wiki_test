{
    "hands_on_practices": [
        {
            "introduction": "域积分法是计算J积分的一种强大数值技术。本练习旨在通过一个明确定义的场景，将理论与实践相结合。你将从基本原理出发推导J积分的域积分形式，并利用给定的应变能密度和功率密度场，在平面应力与平面应变两种情况下进行具体计算，从而加深对该方法以及不同二维假设下断裂行为差异的理解 。",
            "id": "3576843",
            "problem": "在二维平面应力和平面应变条件下，对一个有裂纹的、均匀的、线性弹性的、横观各向同性固体进行建模。横观各向同性轴垂直于该平面，因此面内响应是各向同性的，而面外耦合则区分了平面应力与平面应变。考虑一条沿负 $x$ 轴分布的直裂纹，其尖端位于坐标原点。在尖端周围，使用一个矩形计算域进行域积分评估：$\\Omega = \\{(x,y)\\,|\\,0 \\le x \\le L,\\,-b \\le y \\le b\\}$，其中 $L = 0.02\\,\\mathrm{m}$，$b = 0.01\\,\\mathrm{m}$。指定一个标量权重函数 $q(x,y) = 1 - x/L$，该函数在靠近尖端的内表面上满足 $q=1$，在远端边界 $x=L$ 上满足 $q=0$。\n\n在每种二维设置下，有限元 (FE) 后处理提供了在 $\\Omega$ 上的以下场量：\n- 应变能密度 $W(x,y)$ (单位 $\\mathrm{J/m^3}$)。\n- 收缩机械功率密度 $P(x,y) = \\sum_{i=1}^{2} \\sigma_{i1}(x,y)\\,\\frac{\\partial u_i}{\\partial x_1}(x,y)$ (单位 $\\mathrm{J/m^3}$)，其中 $u_i$ 是位移分量，$\\sigma_{ij}$ 是柯西 (Cauchy) 应力分量。\n\n对于平面应力情况，有限元计算的场为\n$$\nW_{\\mathrm{ps}}(x,y) = \\alpha_{\\mathrm{ps}} + \\beta_{\\mathrm{ps}}\\,x + \\gamma_{\\mathrm{ps}}\\,y^{2}, \\quad\nP_{\\mathrm{ps}}(x,y) = \\delta_{\\mathrm{ps}} + \\varepsilon_{\\mathrm{ps}}\\,x + \\zeta_{\\mathrm{ps}}\\,y^{2},\n$$\n常数为\n$$\n\\alpha_{\\mathrm{ps}} = 3.40 \\times 10^{6},\\quad\n\\beta_{\\mathrm{ps}} = 1.20 \\times 10^{8},\\quad\n\\gamma_{\\mathrm{ps}} = 4.00 \\times 10^{9},\\quad\n\\delta_{\\mathrm{ps}} = 4.50 \\times 10^{6},\\quad\n\\varepsilon_{\\mathrm{ps}} = 1.10 \\times 10^{8},\\quad\n\\zeta_{\\mathrm{ps}} = 3.70 \\times 10^{9}.\n$$\n\n对于平面应变情况，有限元计算的场为\n$$\nW_{\\mathrm{pe}}(x,y) = \\alpha_{\\mathrm{pe}} + \\beta_{\\mathrm{pe}}\\,x + \\gamma_{\\mathrm{pe}}\\,y^{2}, \\quad\nP_{\\mathrm{pe}}(x,y) = \\delta_{\\mathrm{pe}} + \\varepsilon_{\\mathrm{pe}}\\,x + \\zeta_{\\mathrm{pe}}\\,y^{2},\n$$\n常数为\n$$\n\\alpha_{\\mathrm{pe}} = 3.90 \\times 10^{6},\\quad\n\\beta_{\\mathrm{pe}} = 1.00 \\times 10^{8},\\quad\n\\gamma_{\\mathrm{pe}} = 3.80 \\times 10^{9},\\quad\n\\delta_{\\mathrm{pe}} = 4.90 \\times 10^{6},\\quad\n\\varepsilon_{\\mathrm{pe}} = 1.05 \\times 10^{8},\\quad\n\\zeta_{\\mathrm{pe}} = 3.90 \\times 10^{9}.\n$$\n\n从机械能守恒和 Eshelby 能量动量张量的定义出发，推导 $J$ 积分在 $x$ 方向分量的域积分表示，并利用该表示和给定的权重函数 $q(x,y)$，评估平面应力和平面应变下的 $J$ 值：\n$$\nJ_{\\mathrm{ps}} \\quad \\text{和} \\quad J_{\\mathrm{pe}},\n$$\n分别在域 $\\Omega$ 上计算。然后，计算比率\n$$\nR = \\frac{J_{\\mathrm{pe}}}{J_{\\mathrm{ps}}}.\n$$\n\n报告 $R$ 的单个数值，四舍五入到四位有效数字。该比率为无量纲。不要报告中间的 $J$ 值；仅按要求报告 $R$。",
            "solution": "问题验证如下。\n\n**步骤 1：提取已知条件**\n\n- **材料与几何**：二维情况下一个有裂纹的、均匀的、线性弹性的、横观各向同性固体。横观各向同性轴垂直于该平面，导致面内响应是各向同性的。一条直裂纹沿负 $x$ 轴分布，其尖端位于原点。\n- **计算域**：一个矩形 $\\Omega = \\{(x,y)\\,|\\,0 \\le x \\le L,\\,-b \\le y \\le b\\}$，其中 $L = 0.02\\,\\mathrm{m}$，$b = 0.01\\,\\mathrm{m}$。\n- **权重函数**：$q(x,y) = 1 - x/L$。\n- **场量**：\n    - 应变能密度：$W(x,y)$\n    - 收缩机械功率密度：$P(x,y) = \\sum_{i=1}^{2} \\sigma_{i1}(x,y)\\,\\frac{\\partial u_i}{\\partial x_1}(x,y)$\n- **平面应力 (ps) 场**：\n    - $W_{\\mathrm{ps}}(x,y) = \\alpha_{\\mathrm{ps}} + \\beta_{\\mathrm{ps}}\\,x + \\gamma_{\\mathrm{ps}}\\,y^{2}$\n    - $P_{\\mathrm{ps}}(x,y) = \\delta_{\\mathrm{ps}} + \\varepsilon_{\\mathrm{ps}}\\,x + \\zeta_{\\mathrm{ps}}\\,y^{2}$\n    - 常数：$\\alpha_{\\mathrm{ps}} = 3.40 \\times 10^{6}$, $\\beta_{\\mathrm{ps}} = 1.20 \\times 10^{8}$, $\\gamma_{\\mathrm{ps}} = 4.00 \\times 10^{9}$, $\\delta_{\\mathrm{ps}} = 4.50 \\times 10^{6}$, $\\varepsilon_{\\mathrm{ps}} = 1.10 \\times 10^{8}$, $\\zeta_{\\mathrm{ps}} = 3.70 \\times 10^{9}$。\n- **平面应变 (pe) 场**：\n    - $W_{\\mathrm{pe}}(x,y) = \\alpha_{\\mathrm{pe}} + \\beta_{\\mathrm{pe}}\\,x + \\gamma_{\\mathrm{pe}}\\,y^{2}$\n    - $P_{\\mathrm{pe}}(x,y) = \\delta_{\\mathrm{pe}} + \\varepsilon_{\\mathrm{pe}}\\,x + \\zeta_{\\mathrm{pe}}\\,y^{2}$\n    - 常数：$\\alpha_{\\mathrm{pe}} = 3.90 \\times 10^{6}$, $\\beta_{\\mathrm{pe}} = 1.00 \\times 10^{8}$, $\\gamma_{\\mathrm{pe}} = 3.80 \\times 10^{9}$, $\\delta_{\\mathrm{pe}} = 4.90 \\times 10^{6}$, $\\varepsilon_{\\mathrm{pe}} = 1.05 \\times 10^{8}$, $\\zeta_{\\mathrm{pe}} = 3.90 \\times 10^{9}$。\n- **任务**：推导 $J$ 积分在 $x$ 方向分量（$J_1$，下文记作 $J$）的域积分表示。用它来评估在 $\\Omega$ 上的 $J_{\\mathrm{ps}}$ 和 $J_{\\mathrm{pe}}$。最后，计算比率 $R = J_{\\mathrm{pe}} / J_{\\mathrm{ps}}$，并四舍五入到四位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题设置在线性弹性断裂力学的既定框架内。$J$ 积分、Eshelby 张量、域积分评估、平面应力和平面应变等概念是该领域的基础。材料属性（横观各向同性）在物理上是现实的。提供的场函数是简单的多项式，这是有限元后处理结果的常见表示形式。\n- **适定性**：问题定义明确。所有必要的数据、函数和常数均已提供。目标清晰：基于这些输入计算一个特定的比率。其结构保证了唯一解。$W$ 和 $P$ 的函数形式（依赖于 $x$ 和 $y^2$）与 I 型裂纹问题的物理对称性一致，对于这类问题，域积分方法非常适用。\n- **客观性**：问题以精确、定量的术语陈述。没有主观或含糊的陈述。\n\n**步骤 3：结论与行动**\n\n该问题具有科学性、适定性和客观性。这是计算断裂力学中的一个标准问题。该问题被判定为**有效**。\n\n**解题过程**\n\n$J$ 积分被定义为围绕裂纹尖端的路径无关环路积分。对于沿负 $x_1$ 轴的裂纹，其 $x_1$ 分量由下式给出：\n$$ J = \\int_{\\Gamma} (W n_1 - T_i \\frac{\\partial u_i}{\\partial x_1}) d\\Gamma $$\n其中 $\\Gamma$ 是包围尖端的逆时针轮廓线，$W$ 是应变能密度，$u_i$ 是位移，$T_i = \\sigma_{ij}n_j$ 是面力，$n_j$ 是 $\\Gamma$ 的外法线分量。\n\nEshelby 能量动量张量的定义为：\n$$ \\Sigma_{jk} = W \\delta_{jk} - \\sigma_{ij} \\frac{\\partial u_i}{\\partial x_k} $$\n$J$ 积分可以表示为 $J = \\int_{\\Gamma} \\Sigma_{j1} n_j d\\Gamma$。对于处于静态平衡且无体力作用的均匀弹性材料，能量守恒导致 Eshelby 张量的散度为零：$\\frac{\\partial \\Sigma_{jk}}{\\partial x_j} = 0$。\n\n此性质允许使用一个在裂纹尖端为 1、在区域 $A$ 的外边界上为 0 的光滑权重函数 $q$，将环路积分转换为围绕裂纹尖端的区域 $A$ 上的域积分。通用的域积分形式为：\n$$ J = \\int_{A} \\left( \\sigma_{ij} \\frac{\\partial u_i}{\\partial x_1} - W \\frac{\\partial q}{\\partial x_1} \\right) \\frac{\\partial q}{\\partial x_j} dA $$\n问题指定了权重函数 $q(x,y) = 1 - x/L$，其中 $x_1=x$。$q$ 的偏导数为：\n$$ \\frac{\\partial q}{\\partial x_1} = \\frac{\\partial q}{\\partial x} = -\\frac{1}{L} $$\n$$ \\frac{\\partial q}{\\partial x_2} = \\frac{\\partial q}{\\partial y} = 0 $$\n将这些代入 $J$ 的域积分表达式中：\n$$ J = \\int_{A} \\left( \\sigma_{i1} \\frac{\\partial u_i}{\\partial x_1} \\left(-\\frac{1}{L}\\right) - W \\left(-\\frac{1}{L}\\right) \\right) dA $$\n$$ J = \\frac{1}{L} \\int_{A} \\left( W - \\sum_{i=1}^{2} \\sigma_{i1} \\frac{\\partial u_i}{\\partial x_1} \\right) dA $$\n问题定义了量 $P(x,y) = \\sum_{i=1}^{2} \\sigma_{i1}(x,y)\\,\\frac{\\partial u_i}{\\partial x_1}(x,y)$。因此，$J$ 的表达式简化为：\n$$ J = \\frac{1}{L} \\int_{A} (W(x,y) - P(x,y)) dA $$\n此推导在边界项因散度定理而抵消的假设下是有效的，这对于 I 型裂纹构型是成立的。给定的 $W$ 和 $P$ 的函数形式（$y$ 的偶函数）与 I 型对称性一致。\n\n该积分将在域 $\\Omega = \\{(x,y)\\,|\\,0 \\le x \\le L,\\,-b \\le y \\le b\\}$ 上进行评估。\n我们首先以符号方式计算积分。令 $W(x,y) - P(x,y) = (\\alpha-\\delta) + (\\beta-\\varepsilon)x + (\\gamma-\\zeta)y^2$。\n$$ J = \\frac{1}{L} \\int_0^L \\int_{-b}^b \\left[ (\\alpha-\\delta) + (\\beta-\\varepsilon)x + (\\gamma-\\zeta)y^2 \\right] dy dx $$\n对 $y$ 积分：\n$$ \\int_{-b}^b \\left[ ((\\alpha-\\delta) + (\\beta-\\varepsilon)x) + (\\gamma-\\zeta)y^2 \\right] dy = \\left[ ((\\alpha-\\delta) + (\\beta-\\varepsilon)x)y + (\\gamma-\\zeta)\\frac{y^3}{3} \\right]_{-b}^b $$\n$$ = 2b ((\\alpha-\\delta) + (\\beta-\\varepsilon)x) + \\frac{2b^3}{3}(\\gamma-\\zeta) $$\n现在，对 $x$ 积分：\n$$ \\int_0^L \\left[ 2b ((\\alpha-\\delta) + (\\beta-\\varepsilon)x) + \\frac{2b^3}{3}(\\gamma-\\zeta) \\right] dx $$\n$$ = \\left[ 2b \\left( (\\alpha-\\delta)x + (\\beta-\\varepsilon)\\frac{x^2}{2} \\right) + \\frac{2b^3}{3}(\\gamma-\\zeta)x \\right]_0^L $$\n$$ = 2b \\left( (\\alpha-\\delta)L + (\\beta-\\varepsilon)\\frac{L^2}{2} \\right) + \\frac{2b^3}{3}(\\gamma-\\zeta)L $$\n最后，除以 $L$：\n$$ J = \\frac{1}{L} \\left[ 2b \\left( (\\alpha-\\delta)L + (\\beta-\\varepsilon)\\frac{L^2}{2} \\right) + \\frac{2b^3}{3}(\\gamma-\\zeta)L \\right] $$\n$$ J = 2b \\left( (\\alpha-\\delta) + (\\beta-\\varepsilon)\\frac{L}{2} \\right) + \\frac{2b^3}{3}(\\gamma-\\zeta) $$\n\n现在，我们为平面应力和平面应变情况评估 $J$。\n给定值：$L = 0.02\\,\\mathrm{m}$，$b = 0.01\\,\\mathrm{m}$。\n\n**平面应力情况 ($J_{\\mathrm{ps}}$)**\n系数的差值为：\n$\\alpha_{\\mathrm{ps}} - \\delta_{\\mathrm{ps}} = (3.40 - 4.50) \\times 10^{6} = -1.10 \\times 10^{6}$\n$\\beta_{\\mathrm{ps}} - \\varepsilon_{\\mathrm{ps}} = (1.20 - 1.10) \\times 10^{8} = 0.10 \\times 10^{8} = 1.0 \\times 10^{7}$\n$\\gamma_{\\mathrm{ps}} - \\zeta_{\\mathrm{ps}} = (4.00 - 3.70) \\times 10^{9} = 0.30 \\times 10^{9} = 3.0 \\times 10^{8}$\n\n将这些代入 $J$ 的公式中：\n$$ J_{\\mathrm{ps}} = 2(0.01) \\left( (-1.10 \\times 10^6) + (1.0 \\times 10^7)\\frac{0.02}{2} \\right) + \\frac{2(0.01)^3}{3}(3.0 \\times 10^8) $$\n$$ J_{\\mathrm{ps}} = 0.02 \\left( -1.10 \\times 10^6 + (1.0 \\times 10^7)(0.01) \\right) + \\frac{2 \\times 10^{-6}}{3}(3.0 \\times 10^8) $$\n$$ J_{\\mathrm{ps}} = 0.02 \\left( -1.10 \\times 10^6 + 1.0 \\times 10^5 \\right) + \\frac{6.0 \\times 10^2}{3} $$\n$$ J_{\\mathrm{ps}} = 0.02 (-1.0 \\times 10^6) + 200 $$\n$$ J_{\\mathrm{ps}} = -20000 + 200 = -19800 $$\n\n**平面应变情况 ($J_{\\mathrm{pe}}$)**\n系数的差值为：\n$\\alpha_{\\mathrm{pe}} - \\delta_{\\mathrm{pe}} = (3.90 - 4.90) \\times 10^{6} = -1.00 \\times 10^{6}$\n$\\beta_{\\mathrm{pe}} - \\varepsilon_{\\mathrm{pe}} = (1.00 - 1.05) \\times 10^{8} = -0.05 \\times 10^{8} = -5.0 \\times 10^{6}$\n$\\gamma_{\\mathrm{pe}} - \\zeta_{\\mathrm{pe}} = (3.80 - 3.90) \\times 10^{9} = -0.10 \\times 10^{9} = -1.0 \\times 10^{8}$\n\n将这些代入 $J$ 的公式中：\n$$ J_{\\mathrm{pe}} = 2(0.01) \\left( (-1.00 \\times 10^6) + (-5.0 \\times 10^6)\\frac{0.02}{2} \\right) + \\frac{2(0.01)^3}{3}(-1.0 \\times 10^8) $$\n$$ J_{\\mathrm{pe}} = 0.02 \\left( -1.00 \\times 10^6 - (5.0 \\times 10^6)(0.01) \\right) - \\frac{2 \\times 10^{-6}}{3}(1.0 \\times 10^8) $$\n$$ J_{\\mathrm{pe}} = 0.02 \\left( -1.00 \\times 10^6 - 5.0 \\times 10^4 \\right) - \\frac{2.0 \\times 10^2}{3} $$\n$$ J_{\\mathrm{pe}} = 0.02 (-1.05 \\times 10^6) - \\frac{200}{3} $$\n$$ J_{\\mathrm{pe}} = -21000 - \\frac{200}{3} = -\\frac{63000}{3} - \\frac{200}{3} = -\\frac{63200}{3} $$\n\n**比率计算**\n最后，我们计算比率 $R = J_{\\mathrm{pe}} / J_{\\mathrm{ps}}$：\n$$ R = \\frac{-63200/3}{-19800} = \\frac{63200}{3 \\times 19800} = \\frac{632}{3 \\times 198} = \\frac{632}{594} $$\n$$ R \\approx 1.06397306... $$\n四舍五入到四位有效数字，我们得到：\n$$ R \\approx 1.064 $$",
            "answer": "$$\n\\boxed{1.064}\n$$"
        },
        {
            "introduction": "在掌握了线性弹性断裂力学（LEFM）中J积分的计算之后，我们转向更真实的断裂模型。内聚区模型（CZM）通过描述裂纹尖端的断裂过程区，为我们提供了超越LEFM的分析能力。本练习要求你将J积分的概念扩展到包含内聚区能量耗散的情况，并通过数值编程来验证一个关键思想：在小范围屈服极限下，内聚区模型会收敛于LEFM的解 。",
            "id": "3576859",
            "problem": "考虑一个在 I 型加载下的二维线性弹性各向同性体，其内部有一条沿 $x$ 轴的直裂纹。裂纹尖端位于原点，尖端前方的裂纹平面上存在一个有限范围的内聚区。材料遵循小应变运动学和平面应力条件。内聚区内的裂纹面承受一种牵引力，该牵引力通过牵引-分离法则 $T(\\delta)$ 依赖于局部张开位移。任务是建立并评估存在内聚区时 $J$ 积分（通常称为流入裂纹尖端的能量通量）的域形式，并验证当内聚区尺寸趋于零时，其收敛于线性弹性断裂力学（LEFM, Linear Elastic Fracture Mechanics）值。\n\n从基本力学原理和核心定义出发：\n\n- 应变能密度为 $W = \\tfrac{1}{2} \\sigma_{ij} \\varepsilon_{ij}$，其中 $\\sigma_{ij}$ 和 $\\varepsilon_{ij}$ 分别是 Cauchy 应力张量和小应变张量。\n- Eshelby 能量动量张量为 $T_{jk}^{\\mathrm{E}} = W \\delta_{jk} - \\sigma_{ij} \\dfrac{\\partial u_i}{\\partial x_k}$，其中 $u_i$ 是位移分量，$\\delta_{jk}$ 是 Kronecker delta。\n- $J$ 积分是单位厚度流入裂纹尖端的能量通量，在保守弹性环境中定义为一个路径无关积分，并可以使用一个在尖端处等于 $1$、在远离尖端处衰减至 $0$ 的光滑权函数 $q(\\mathbf{x})$ 以域形式表示。\n\n您必须推导出一个一致的 $J$ 积分域形式，该形式包含内聚牵引力的能量贡献。假设裂纹是静止的，并沿 $x$ 轴分布，内聚区从 $x = 0$ 延伸到 $x = \\ell_c$。设权函数为 $q(x) = \\max\\!\\left(1 - \\left(\\dfrac{x}{R}\\right)^m, 0\\right)$ (对于 $x \\ge 0$)，其中 $R > 0$ 是一个选定的半径，用于局部化域积分，$m \\ge 1$ 控制衰减。对于 I 型张开模式下沿裂纹路径的一维简化，设内聚区内的裂纹面张开轮廓为 $\\delta(x) = \\delta_c \\left(1 - \\left(\\dfrac{x}{\\ell_c}\\right)^p\\right)$ (对于 $x \\in [0,\\ell_c]$)，其中 $p \\ge 1$，尖端张开位移 $\\delta(0) = \\delta_c$。对于软化法则，牵引-分离法则 $T(\\delta)$ 在 $[0,\\delta_c]$ 上是严格单调不增的，并在 $\\delta = \\delta_c$ 时消失。\n\n任务：\n\n1. 使用 Eshelby 张量和散度定理，从定义 $J = \\int_\\Gamma T_{1k}^{\\mathrm{E}} n_k \\,\\mathrm{d}\\Gamma$（在一个包围裂纹尖端的围线 $\\Gamma$ 上）出发，推导包含内聚贡献的 $J$ 积分的域积分表达式，并将其转换为在一个邻域 $\\Omega$ 上使用权函数 $q(\\mathbf{x})$ 的域形式。在您的推导中，明确展示内聚裂纹面上的内力如何贡献一个附加项。将您的表达式特化为 I 型加载下的一维裂纹路径简化情况，并论证在假设的设定下，内聚贡献可简化为\n$$\nJ_{\\text{coh}}(q) \\;=\\; \\int_0^{\\ell_c} T(\\delta(x))\\, q(x)\\, \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| \\,\\mathrm{d}x \\, .\n$$\n2. 解释为什么在位移控制的平衡条件下，裂纹开始扩展时，LEFM 能量释放率（单位厚度）为 $J_{\\text{LEFM}} = \\dfrac{K_I^2}{E'}$，其中 $K_I$ 是 I 型应力强度因子，$E'$ 是有效模量，以及为什么选择远场应力以满足 $J_{\\text{LEFM}} = \\Gamma$ 意味着 $J_{\\text{LEFM}}$ 等于断裂能 $\\Gamma = \\int_0^{\\delta_c} T(\\delta)\\,\\mathrm{d}\\delta$。此处使用平面应力条件，因此 $E' = E$。\n3. 提供一个数值程序，该程序能针对给定的 $q(x)$、$T(\\delta)$ 和 $\\delta(x)$ 计算加权内聚域积分 $J_{\\text{coh}}(q)$，并将其与一组指定测试用例的 LEFM 值 $J_{\\text{LEFM}}$ 进行比较。沿 $x \\in [0, \\min(\\ell_c,R)]$ 使用数值积分，并计算绝对差 $\\left|J_{\\text{LEFM}} - J_{\\text{coh}}(q)\\right|$。\n4. 在固定 $R$ 和光滑 $q(x)$（其中 $q(0)=1$）的条件下，数值验证并讨论当 $\\ell_c \\to 0$ 时收敛性 $\\left|J_{\\text{LEFM}} - J_{\\text{coh}}(q)\\right| \\to 0$。输出必须以指定格式呈现。\n\n物理和数值单位：\n\n- 使用国际单位制 (SI)。$J$ 和绝对差以 $\\mathrm{N/m}$ 为单位报告，应力以 $\\mathrm{Pa}$ (帕斯卡) 为单位，长度以 $\\mathrm{m}$ (米) 为单位。\n- 如果出现角度，请以弧度表示，尽管此一维简化不需要角度。\n- 不要使用百分比；需要比率时，请使用小数。\n\n测试套件和参数：\n\n- 情况 1（常规情况，线性软化）：$T(\\delta) = \\sigma_0 \\left(1 - \\dfrac{\\delta}{\\delta_c}\\right)$ 对于 $\\delta \\in [0,\\delta_c]$，其中 $\\sigma_0 = 3.0 \\times 10^6\\,\\mathrm{Pa}$，$\\delta_c = 5.0 \\times 10^{-5}\\,\\mathrm{m}$，$\\ell_c = 5.0 \\times 10^{-4}\\,\\mathrm{m}$，$p = 1$，$R = 1.0 \\times 10^{-3}\\,\\mathrm{m}$，$m = 2$，弹性模量 $E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$，裂纹半长 $a = 1.0 \\times 10^{-1}\\,\\mathrm{m}$。\n- 情况 2（边界条件，极小内聚区）：与情况 1 相同的线性软化，但 $\\ell_c = 1.0 \\times 10^{-6}\\,\\mathrm{m}$。\n- 情况 3（边缘情况，指数法则和较大内聚区）：$T(\\delta) = \\sigma_0 \\exp\\!\\left(-\\dfrac{\\delta}{\\delta_c}\\right)$ 对于 $\\delta \\in [0,\\delta_c]$，其中 $\\sigma_0 = 5.0 \\times 10^6\\,\\mathrm{Pa}$，$\\delta_c = 2.0 \\times 10^{-5}\\,\\mathrm{m}$，$\\ell_c = 1.0 \\times 10^{-2}\\,\\mathrm{m}$，$p = 1$，$R = 1.0 \\times 10^{-2}\\,\\mathrm{m}$，$m = 2$，弹性模量 $E = 7.0 \\times 10^{10}\\,\\mathrm{Pa}$，裂纹半长 $a = 1.0 \\times 10^{-1}\\,\\mathrm{m}$。\n- 情况 4（收敛性检查，指数法则和极小内聚区）：与情况 3 相同的指数法则，但 $\\ell_c = 1.0 \\times 10^{-6}\\,\\mathrm{m}$，$R = 1.0 \\times 10^{-3}\\,\\mathrm{m}$。\n\n对于每种情况，设置远场均匀应力 $\\sigma_\\infty$ 以满足 $J_{\\text{LEFM}} = \\Gamma$，即选择 $\\sigma_\\infty = \\sqrt{\\dfrac{E\\, \\Gamma}{\\pi a}}$ 并计算 $J_{\\text{LEFM}} = \\dfrac{(\\sigma_\\infty \\sqrt{\\pi a})^2}{E}$，从而得到 $J_{\\text{LEFM}} = \\Gamma$。\n\n最终输出格式：\n\n您的程序应生成一行输出，其中包含情况 1 到情况 4 的绝对差 $\\left|J_{\\text{LEFM}} - J_{\\text{coh}}(q)\\right|$，以逗号分隔的列表形式包含在方括号中，单位为 $\\mathrm{N/m}$。例如，$\\left[ d_1, d_2, d_3, d_4 \\right]$，其中每个 $d_i$ 是一个表示绝对差（单位 $\\mathrm{N/m}$）的浮点数。",
            "solution": "该问题是有效的，因为它基于断裂力学原理，具有科学依据，其提法是适定的，具有充分且一致的数据，并且在表述上是客观的。因此，我们可以进行完整的解答。\n\n该问题要求在存在内聚区的情况下，对 $J$ 积分的域积分形式进行公式化和数值评估。这需要一个涉及理论推导、概念解释和数值实现的多步骤过程。\n\n**1. $J$ 积分的内聚贡献推导**\n\n$J$ 积分从根本上定义为与虚拟裂纹扩展相关的能量释放率。在一个纯弹性体中，其值可以通过围绕裂纹尖端的围线积分计算，$J = \\int_\\Gamma (W n_1 - t_k u_{k,1}) d\\Gamma$，其中 $W$ 是应变能密度，$\\mathbf{n}$ 是围线 $\\Gamma$ 的外法线，$t_k = \\sigma_{kj}n_j$ 是 $\\Gamma$ 上的牵引力分量，$u_{k,1} = \\partial u_k / \\partial x_1$（假设裂纹沿 $x_1$ 轴）。对于均质弹性材料，该积分是路径无关的。\n\n通过结合使用散度定理和一个光滑的权函数 $q(\\mathbf{x})$（在裂纹尖端 $q=1$，在积分域 $\\Omega$ 的外边界上 $q=0$），围线积分可以转换成域积分。对于纯弹性材料，其形式为：\n$$\nJ = \\int_\\Omega \\left( \\sigma_{ij}\\frac{\\partial u_i}{\\partial x_1} - W \\delta_{1j} \\right) \\frac{\\partial q}{\\partial x_j} d\\Omega\n$$\n当存在内聚区时，材料区域包含一个不连续面，能量通过脱聚过程在该面上耗散。总能量释放率必须考虑这种耗散。从第一性原理进行的完整推导是复杂的，但我们可以按照要求，为内聚贡献的形式提供一个物理论证。\n\n完全分离两个裂纹面所耗散的单位面积总能量是断裂能 $\\Gamma$。它由内聚牵引力 $T$ 在整个分离范围 $\\delta$ 上所做的功定义：\n$$\n\\Gamma = \\int_0^{\\delta_c} T(\\delta) \\,d\\delta\n$$\n其中 $\\delta_c$ 是牵引力消失时的临界分离位移。通过使用裂纹张开轮廓 $\\delta(x)$ 进行变量替换，我们可以将此积分表示为对内聚区长度 $\\ell_c$ 的积分。鉴于张开位移 $\\delta(x)$ 从尖端（$x=0$）的 $\\delta_c$ 减小到内聚区末端（$x=\\ell_c$）的 $0$，我们有 $d\\delta = (\\mathrm{d}\\delta/\\mathrm{d}x) dx$。由于 $\\mathrm{d}\\delta/\\mathrm{d}x$ 为负，因此 $|\\mathrm{d}\\delta/\\mathrm{d}x| = -\\mathrm{d}\\delta/\\mathrm{d}x$。该积分变为：\n$$\n\\Gamma = \\int_{\\delta_c}^0 T(\\delta) \\,d\\delta = \\int_0^{\\ell_c} T(\\delta(x)) \\frac{\\mathrm{d}\\delta}{\\mathrm{d}x} \\,dx = - \\int_0^{\\ell_c} T(\\delta(x)) \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| \\,dx\n$$\n负号表示能量被耗散。能量释放率必须为正，所以我们考虑其大小。量 $T(\\delta(x)) |\\mathrm{d}\\delta/\\mathrm{d}x|$ 表示沿内聚区的能量耗散空间密度。\n\n$J$ 的域积分方法使用权函数 $q(x)$ 将能量计算局部化到裂纹尖端区域。函数 $q(x)$可以解释为一个虚拟裂纹扩展场。因此，内聚区对总域积分的贡献，我们记为 $J_{\\text{coh}}(q)$，是空间能量耗散率乘以这个虚拟扩展场 $q(x)$ 的积分。这为给定表达式提供了一个有说服力的物理解释：\n$$\nJ_{\\text{coh}}(q) = \\int_0^{\\ell_c} T(\\delta(x))\\, q(x)\\, \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| \\,\\mathrm{d}x\n$$\n该表达式表示内聚区内的分离功，由 $q$ 函数加权。在极小内聚区（$\\ell_c \\to 0$）的极限情况下，积分在 $x \\approx 0$ 的区域内进行。由于 $q(x)$ 是光滑的且 $q(0)=1$，因此在积分域上 $q(x) \\approx 1$。在这种情况下，$J_{\\text{coh}}(q)$ 收敛于总断裂能 $\\Gamma$：\n$$\n\\lim_{\\ell_c \\to 0} J_{\\text{coh}}(q) = \\int_0^{\\ell_c} T(\\delta(x)) \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| \\,dx = \\Gamma\n$$\n\n**2. $J_{\\text{LEFM}}$ 与断裂能 $\\Gamma$ 之间的关系**\n\n在线性弹性断裂力学（LEFM）中，裂纹尖端附近的应力应变状态由应力强度因子 $K$ 表征。对于 I 型加载，这是 $K_I$。能量释放率 $J$ 与 $K_I$ 的关系为：\n$$\nJ_{\\text{LEFM}} = \\frac{K_I^2}{E'}\n$$\n其中 $E'$ 是有效弹性模量。对于指定的平面应力条件，$E' = E$。\n\n对于大板中半长为 $a$ 的裂纹，在远场均匀拉伸应力 $\\sigma_\\infty$ 作用下，应力强度因子由 $K_I = \\sigma_\\infty \\sqrt{\\pi a}$ 给出。将此代入 $J_{\\text{LEFM}}$ 的表达式中可得：\n$$\nJ_{\\text{LEFM}} = \\frac{(\\sigma_\\infty \\sqrt{\\pi a})^2}{E} = \\frac{\\sigma_\\infty^2 \\pi a}{E}\n$$\nLEFM 中断裂的基本准则是，当能量释放率 $J$ 达到临界值，即材料的断裂韧性（记为 $J_c$ 或 $G_c$）时，裂纹发生扩展。在内聚区模型的背景下，这种宏观断裂韧性由微观分离功决定，即断裂能 $\\Gamma = \\int_0^{\\delta_c} T(\\delta) d\\delta$。因此，在裂纹开始扩展时，LEFM 条件为 $J_{\\text{LEFM}} = \\Gamma$。\n\n问题指定应选择远场应力 $\\sigma_\\infty$ 来满足此条件。通过设置 $J_{\\text{LEFM}} = \\Gamma$，我们实质上是根据内聚模型的能量准则所预测的初始破坏点来校准远场载荷。\n$$\n\\frac{\\sigma_\\infty^2 \\pi a}{E} = \\Gamma \\quad \\implies \\quad \\sigma_\\infty = \\sqrt{\\frac{E \\Gamma}{\\pi a}}\n$$\n通过使用这个 $\\sigma_\\infty$ 值来计算 $J_{\\text{LEFM}}$，根据定义可以确保 $J_{\\text{LEFM}} = \\Gamma$。此过程将远场 LEFM 描述与由内聚法则定义的局部失效准则联系起来。\n\n**3. 数值评估策略**\n\n数值任务是计算四个测试用例的绝对差 $|\\Delta J| = |J_{\\text{LEFM}} - J_{\\text{coh}}(q)|$。步骤如下：\n\n首先，我们确定 $J_{\\text{LEFM}}$。如前所述，我们设定 $J_{\\text{LEFM}} = \\Gamma$。$\\Gamma$ 的值通过解析地积分给定的牵引-分离法则 $T(\\delta)$ 来计算：\n- 对于线性法则 $T(\\delta) = \\sigma_0(1 - \\delta/\\delta_c)$:\n  $$\n  \\Gamma = \\int_0^{\\delta_c} \\sigma_0 \\left(1 - \\frac{\\delta}{\\delta_c}\\right) d\\delta = \\sigma_0 \\left[\\delta - \\frac{\\delta^2}{2\\delta_c}\\right]_0^{\\delta_c} = \\frac{1}{2}\\sigma_0\\delta_c\n  $$\n- 对于指数法则 $T(\\delta) = \\sigma_0 \\exp(-\\delta/\\delta_c)$:\n  $$\n  \\Gamma = \\int_0^{\\delta_c} \\sigma_0 \\exp\\left(-\\frac{\\delta}{\\delta_c}\\right) d\\delta = \\sigma_0 \\left[-\\delta_c \\exp\\left(-\\frac{\\delta}{\\delta_c}\\right)\\right]_0^{\\delta_c} = \\sigma_0 \\delta_c \\left(1 - e^{-1}\\right)\n  $$\n\n其次，我们通过数值积分评估 $J_{\\text{coh}}(q)$。被积函数是 $x$ 的函数：\n$$\nf(x) = T(\\delta(x)) \\, q(x) \\, \\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right|\n$$\n被积函数的组成部分是：\n- $\\delta(x) = \\delta_c \\left(1 - \\left(\\frac{x}{\\ell_c}\\right)^p\\right)$\n- $\\left|\\frac{\\mathrm{d}\\delta}{\\mathrm{d}x}\\right| = \\left|-p\\frac{\\delta_c}{\\ell_c}\\left(\\frac{x}{\\ell_c}\\right)^{p-1}\\right| = p\\frac{\\delta_c}{\\ell_c^p}x^{p-1}$\n- $q(x) = \\max\\left(1 - \\left(\\frac{x}{R}\\right)^m, 0\\right)$\n- $T(\\delta(x))$ 取决于具体法则。\n\n$J_{\\text{coh}}(q)$ 的积分在 $x \\in [0, \\min(\\ell_c, R)]$ 上计算，因为当 $x > R$ 时，$q(x)=0$ 且被积函数为零。我们将为此使用标准的数值积分程序。\n\n**4. 数值收敛性验证**\n\n通过比较情况 1 和情况 2，以及情况 3 和情况 4，我们研究了当内聚区长度 $\\ell_c$ 变得非常小时的行为。如第 1 部分所述，我们预期 $J_{\\text{coh}}(q)$ 会收敛到 $\\Gamma$。因此，差值 $|\\Delta J| = |\\Gamma - J_{\\text{coh}}(q)|$ 应趋近于 $0$。数值结果将用于验证这种理论收敛性。具有非常小的 $\\ell_c$ 的情况 2 和情况 4，预计将分别产生比情况 1 和情况 3 小得多的差值。这种收敛性验证了在小尺度屈服极限下，当过程区尺寸相对于其他特征长度可忽略不计时，内聚区模型能正确地简化为 LEFM。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves for the absolute difference between the LEFM J-integral and its\n    cohesive domain integral counterpart for the four specified test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (case_name, T_law_type, params, geom_params)\n    # T_law_type: 'linear' or 'exponential'\n    # params: (sigma0, delta_c)\n    # geom_params: (lc, p, R, m, E, a)\n    test_cases = [\n        (\n            \"Case 1 (linear, large lc)\",\n            'linear',\n            (3.0e6, 5.0e-5),\n            (5.0e-4, 1, 1.0e-3, 2, 2.10e11, 1.0e-1)\n        ),\n        (\n            \"Case 2 (linear, small lc)\",\n            'linear',\n            (3.0e6, 5.0e-5),\n            (1.0e-6, 1, 1.0e-3, 2, 2.10e11, 1.0e-1)\n        ),\n        (\n            \"Case 3 (exponential, large lc)\",\n            'exponential',\n            (5.0e6, 2.0e-5),\n            (1.0e-2, 1, 1.0e-2, 2, 7.0e10, 1.0e-1)\n        ),\n        (\n            \"Case 4 (exponential, small lc)\",\n            'exponential',\n            (5.0e6, 2.0e-5),\n            (1.0e-6, 1, 1.0e-3, 2, 7.0e10, 1.0e-1)\n        ),\n    ]\n\n    results = []\n    \n    for case_name, t_law, params, geom_params in test_cases:\n        sigma0, delta_c = params\n        lc, p, R, m, _, _ = geom_params\n\n        # 1. Define Traction-Separation Law (TSL) and calculate Gamma (fracture energy)\n        if t_law == 'linear':\n            T_func = lambda delta: sigma0 * (1 - delta / delta_c) if 0 = delta = delta_c else 0\n            # Gamma = integral of T(delta) from 0 to delta_c\n            gamma = 0.5 * sigma0 * delta_c\n        elif t_law == 'exponential':\n            T_func = lambda delta: sigma0 * np.exp(-delta / delta_c) if delta >= 0 else 0\n            # Gamma = integral of T(delta) from 0 to delta_c\n            gamma = sigma0 * delta_c * (1 - np.exp(-1))\n        \n        # J_LEFM is set to be equal to Gamma\n        j_lefm = gamma\n\n        # 2. Define the integrand for the cohesive domain integral J_coh(q)\n        # delta(x) = delta_c * (1 - (x/lc)^p)\n        delta_x_func = lambda x: delta_c * (1 - (x / lc)**p)\n        \n        # |d(delta)/dx| = p * delta_c / lc^p * x^(p-1)\n        abs_d_delta_dx_func = lambda x: p * delta_c / (lc**p) * x**(p-1) if x > 0 else 0\n        \n        # q(x) = max(0, 1 - (x/R)^m)\n        q_func = lambda x: max(0, 1 - (x / R)**m)\n\n        # The full integrand f(x) = T(delta(x)) * q(x) * |d(delta)/dx|\n        def integrand(x):\n            if x  0 or x > lc:\n                return 0.0\n            \n            delta_val = delta_x_func(x)\n            T_val = T_func(delta_val)\n            q_val = q_func(x)\n            abs_d_delta_dx_val = abs_d_delta_dx_func(x)\n            \n            return T_val * q_val * abs_d_delta_dx_val\n\n        # 3. Numerically integrate to find J_coh(q)\n        # The integration limit is from 0 to min(lc, R) because q(x)=0 for x>R\n        upper_limit = min(lc, R)\n        j_coh_q, _ = quad(integrand, 0, upper_limit)\n\n        # 4. Compute the absolute difference and store the result\n        abs_diff = abs(j_lefm - j_coh_q)\n        results.append(abs_diff)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在模拟裂纹扩展时，一个核心的计算挑战是如何在裂纹前进和网格重划分时保持计算的准确性。本练习聚焦于这一实际问题，采用“人造解”方法来精确量化场传递操作引入的数值误差。你将实现并比较两种不同的网格间场传递算子，并研究它们在多次裂纹扩展步骤中对J积分计算精度累积误差的影响，这对于开发稳健的断裂模拟程序至关重要 。",
            "id": "3576818",
            "problem": "您的任务是研究在裂纹扩展过程中，网格重划分条件下由$J$积分描述的能量释放率的连续性，并为$J$的域积分形式提出一种网格间传递算子。从计算固体力学的基本原理出发：能量守恒、线性动量平衡以及应变能密度的定义。使用散度定理将围线积分与面积（域）积分联系起来，并阐明由平移不变性产生的能量-动量平衡张量。不要使用任何关于$J$积分的简化公式；从最基本的基础上推导其域积分形式。\n\n为了能够在每一步都无需求解完整的弹性边界值问题，从而进行受控的数值研究，请考虑裂纹尖端周围的一个环形域。设裂纹尖端初始位于原点，并沿 $x$ 轴正方向扩展。为消除裂纹核心处的非物理奇异性，排除一个半径为 $r_1$ 的圆形内部区域，并考虑一个环形权函数，该函数在内圆内部为1，并在外半径 $r_2$ 处线性减小至零。\n\n为分析定义以下人工构造场：\n\n- 使用平面应变条件下的各向同性线弹性理论。给定弹性模量 $E$ 和泊松比 $\\nu$，定义有效模量 $E' := E/(1-\\nu^2)$。\n\n- 对于指定的应力强度因子 $K_I$（单位为 $\\mathrm{Pa}\\sqrt{\\mathrm{m}}$），精确能量释放率为 $J_{\\mathrm{exact}} := K_I^2 / E'$（单位为 $\\mathrm{N}/\\mathrm{m}$）。\n\n- 在当前裂纹尖端周围的极坐标 $(r,\\theta)$ 中，定义一个人造的能量-动量通量密度矢量场 $F:\\mathbb{R}^2 \\to \\mathbb{R}^2$ 如下\n$$\nF(r,\\theta) := J_0\\, r^{-p} \\begin{bmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\sin\\left(\\frac{\\theta}{2}\\right) \\end{bmatrix},\n$$\n其中 $p$ 为满足 $0  p  1$ 的固定指数，$J_0$ 为一个标量振幅，其取值应使得在使用指定权函数对环形域进行连续积分时，精确域积分等于 $J_{\\mathrm{exact}}$。角度必须以弧度为单位。\n\n- 定义标量权函数 $q(r)$ 如下\n$$\nq(r) = \\begin{cases}\n1,  r \\le r_1,\\\\\n\\frac{r_2 - r}{r_2 - r_1},  r_1  r  r_2,\\\\\n0,  r \\ge r_2,\n\\end{cases}\n$$\n使得其梯度满足 $ \\nabla q(r) = q'(r)\\, \\mathbf{e}_r $，其中当 $r\\in(r_1,r_2)$ 时 $q'(r)=-\\frac{1}{r_2 - r_1}$，其他情况下 $q'(r)=0$，并且 $\\mathbf{e}_r = [\\cos\\theta,\\sin\\theta]^T$。\n\n设域积分通过在 $r_1$ 和 $r_2$ 之间的一个结构化环形网格上进行中点求积来数值计算，该网格具有 $N_r$ 个径向划分和 $N_\\theta$ 个角向划分，覆盖 $\\theta \\in [-\\pi,\\pi]$。在每个网格重划分步骤中，裂纹尖端沿 $x$ 轴前进 $\\Delta a$，并生成一个以新尖端为中心的新环形网格。\n\n提出两种网格间传递算子，将前一个网格中点上采样的离散通量 $F$ 映射到新网格的中点上：\n\n- 最近邻算子 $T_{\\mathrm{nn}}$：对于每个新中点位置，从欧几里得距离最近的前一个中点复制 $F$ 的值。\n\n- 最小二乘 $L^2$ 投影算子 $T_{\\mathrm{ls}}$：对于每个通量分量，通过求解正规方程以最小化平方误差和，在前一个中点样本上拟合一个笛卡尔坐标 $[1,x,y]$ 下的线性模型，并在新中点位置上评估此模型以获得传递后的通量。\n\n使用这些算子，通过执行一系列的网格重划分和传递，来量化在多个扩展步骤中 $J$ 的域积分评估中的误差累积。在每个步骤中，您应使用传递后的 $F$ 来评估域积分，而不依赖于精确的人工构造场 $F$。需要报告的误差度量是在指定数量的扩展步骤后，以 $\\mathrm{N}/\\mathrm{m}$ 为单位的绝对差 $|J_{\\mathrm{num}} - J_{\\mathrm{exact}}|$。\n\n物理单位必须保持一致，最终误差必须以 $\\mathrm{N}/\\mathrm{m}$ 表示。\n\n您的程序必须实现上述设置，计算 $J_0$ 以使人工构造场 $F$ 与指定权函数 $q(r)$ 的连续域积分等于 $J_{\\mathrm{exact}}$，然后运行以下测试套件。对于每种情况，输出两个数字：使用 $T_{\\mathrm{nn}}$ 的最终绝对误差和使用 $T_{\\mathrm{ls}}$ 的最终绝对误差，均以 $\\mathrm{N}/\\mathrm{m}$ 为单位。\n\n测试套件：\n\n- 情况1（基准分辨率和小步长）：\n  - $E = 210\\times 10^{9}\\,\\mathrm{Pa}$,\n  - $\\nu = 0.3$,\n  - $K_I = 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$,\n  - $r_1 = 5\\times 10^{-3}\\,\\mathrm{m}$,\n  - $r_2 = 2\\times 10^{-2}\\,\\mathrm{m}$,\n  - $p = 0.5$,\n  - $N_r = 20$,\n  - $N_\\theta = 64$,\n  - $\\Delta a = 1\\times 10^{-3}\\,\\mathrm{m}$,\n  - 扩展步数 $S = 50$.\n\n- 情况2（粗分辨率和中等步长）：\n  - $E = 210\\times 10^{9}\\,\\mathrm{Pa}$,\n  - $\\nu = 0.3$,\n  - $K_I = 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$,\n  - $r_1 = 5\\times 10^{-3}\\,\\mathrm{m}$,\n  - $r_2 = 2\\times 10^{-2}\\,\\mathrm{m}$,\n  - $p = 0.5$,\n  - $N_r = 8$,\n  - $N_\\theta = 16$,\n  - $\\Delta a = 1.5\\times 10^{-3}\\,\\mathrm{m}$,\n  - 扩展步数 $S = 50$.\n\n- 情况3（基准分辨率和大步长）：\n  - $E = 210\\times 10^{9}\\,\\mathrm{Pa}$,\n  - $\\nu = 0.3$,\n  - $K_I = 10^{6}\\,\\mathrm{Pa}\\sqrt{\\mathrm{m}}$,\n  - $r_1 = 5\\times 10^{-3}\\,\\mathrm{m}$,\n  - $r_2 = 2\\times 10^{-2}\\,\\mathrm{m}$,\n  - $p = 0.5$,\n  - $N_r = 20$,\n  - $N_\\theta = 64$,\n  - $\\Delta a = 5\\times 10^{-3}\\,\\mathrm{m}$,\n  - 扩展步数 $S = 25$.\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，顺序为 $[\\text{情况1使用}T_{\\mathrm{nn}}\\text{的误差}, \\text{情况1使用}T_{\\mathrm{ls}}\\text{的误差}, \\text{情况2使用}T_{\\mathrm{nn}}\\text{的误差}, \\text{情况2使用}T_{\\mathrm{ls}}\\text{的误差}, \\text{情况3使用}T_{\\mathrm{nn}}\\text{的误差}, \\text{情况3使用}T_{\\mathrm{ls}}\\text{的误差}]$，每个数字的单位均为 $\\mathrm{N}/\\mathrm{m}$。",
            "solution": "在线弹性理论中，能量释放率 $J$ 积分源于裂纹尖端附近与路径无关的能量平衡。从能量守恒和线性动量平衡的基本原理出发，考虑应变能密度 $W := \\tfrac{1}{2} \\sigma_{ij} \\varepsilon_{ij}$，其中 $\\sigma_{ij}$ 是 Cauchy 应力，$\\varepsilon_{ij}$ 是小应变张量，由位移场 $u_i$ 定义为 $\\varepsilon_{ij} := \\tfrac{1}{2}(\\partial u_i/\\partial x_j + \\partial u_j/\\partial x_i)$。对于沿 $x_1$ 方向的平移，与 $J$ 积分相关的能量-动量张量缩并为\n$$\n\\mathcal{F}_j := \\sigma_{ij}\\, \\frac{\\partial u_i}{\\partial x_1} - W\\, \\delta_{1j},\n$$\n其中 $\\delta_{1j}$ 是克罗内克δ函数。经典的 $J$ 围线积分形式是通过在环绕裂纹尖端的围线 $\\Gamma$ 上平衡面力虚功和能量密度得到的。通过应用散度定理将围线积分转换为在内围线和外围线所界定的环形域 $A$ 上的域积分，可以得到域积分形式\n$$\nJ = \\int_A \\mathcal{F}_j\\, \\frac{\\partial q}{\\partial x_j}\\, \\mathrm{d}A,\n$$\n其中 $q$ 是一个标量权函数，它在内边界上等于1，在外边界上衰减至0，并且在 $A$ 中具有紧支集。这种形式源于能量增量在平移下的不变性以及应用于能量-动量张量的散度定理。\n\n为了在受控设置中数值评估 $J$ 并分离网格重划分和传递的影响，我们引入一个人造通量场 $F:\\mathbb{R}^2\\to \\mathbb{R}^2$ 来扮演 $\\mathcal{F}$ 的角色，该场被构造成与一个简单的径向权函数 $q(r)$ 配对时，能够产生一个已知的精确域积分值。设 $(r,\\theta)$ 为当前裂纹尖端的极坐标。定义\n$$\nF(r,\\theta) := J_0\\, r^{-p}\\, \\begin{bmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\sin\\left(\\frac{\\theta}{2}\\right) \\end{bmatrix},\n$$\n其中 $p\\in(0,1)$ 确保了当与面积元 $r\\,\\mathrm{d}r\\,\\mathrm{d}\\theta$ 结合时，在 $(r_1,r_2)$ 上的可积性。选择径向权函数\n$$\nq(r) = \\begin{cases}\n1,  r \\le r_1,\\\\\n\\dfrac{r_2 - r}{r_2 - r_1},  r_1  r  r_2,\\\\\n0,  r \\ge r_2,\n\\end{cases}\n\\quad\\Rightarrow\\quad\n\\nabla q(r) = q'(r)\\, \\mathbf{e}_r = \\begin{cases}\n-\\dfrac{1}{r_2-r_1}\\, \\mathbf{e}_r,  r_1  r  r_2,\\\\\n\\mathbf{0},  \\text{otherwise},\n\\end{cases}\n$$\n其中 $\\mathbf{e}_r := [\\cos\\theta,\\sin\\theta]^T$。人工构造的积分于是变为\n$$\nJ_{\\mathrm{manu}} = \\int_{r_1}^{r_2} \\int_{-\\pi}^{\\pi} F(r,\\theta) \\cdot \\nabla q(r)\\; r\\, \\mathrm{d}\\theta\\, \\mathrm{d}r\n= \\int_{r_1}^{r_2} \\int_{-\\pi}^{\\pi} J_0 r^{-p} \\begin{bmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\sin\\left(\\frac{\\theta}{2}\\right) \\end{bmatrix} \\cdot \\left( -\\frac{1}{r_2-r_1} \\begin{bmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{bmatrix} \\right) r\\, \\mathrm{d}\\theta\\, \\mathrm{d}r.\n$$\n使用三角恒等式 $\\cos\\theta\\cos(\\theta/2) + \\sin\\theta\\sin(\\theta/2) = \\cos(\\theta/2)$，被积函数简化为：\n$$\nF(r,\\theta)\\cdot \\nabla q(r) = -\\frac{J_0}{r_2 - r_1} r^{-p} \\cos\\left(\\frac{\\theta}{2}\\right).\n$$\n因此，\n$$\nJ_{\\mathrm{manu}} = -\\frac{J_0}{r_2 - r_1} \\int_{r_1}^{r_2} r^{1-p} \\,\\mathrm{d}r \\int_{-\\pi}^{\\pi} \\cos\\left(\\frac{\\theta}{2}\\right)\\, \\mathrm{d}\\theta\n= -\\frac{J_0}{r_2 - r_1} \\left[ \\frac{r^{2-p}}{2-p} \\right]_{r_1}^{r_2} \\cdot \\left[ 2 \\sin\\left(\\frac{\\theta}{2}\\right) \\right]_{-\\pi}^{\\pi}.\n$$\n由于 $\\sin(\\pi/2)=1$ 和 $\\sin(-\\pi/2)=-1$，角向积分等于 $4$，得出\n$$\nJ_{\\mathrm{manu}} = -\\frac{4 J_0}{r_2 - r_1} \\cdot \\frac{r_2^{2-p} - r_1^{2-p}}{2-p}.\n$$\n我们通过选择以下值来强制 $J_{\\mathrm{manu}} = J_{\\mathrm{exact}}$\n$$\nJ_0 := -\\, \\frac{J_{\\mathrm{exact}}\\, (r_2 - r_1)\\, (2-p)}{4\\,\\left(r_2^{2-p} - r_1^{2-p}\\right)}.\n$$\n通过这种选择，对于人工构造场和权函数，其连续域积分等于精确的 $J$ 值。\n\n数值评估使用结构化环形网格上的中点求积法。设 $N_r$ 为径向划分数，得到 $\\Delta r := (r_2 - r_1)/N_r$；设 $N_\\theta$ 为 $\\theta\\in[-\\pi,\\pi]$ 范围内的角向划分数，得到 $\\Delta\\theta := 2\\pi/N_\\theta$。求积点为中点 $(r_m,\\theta_n)$，其中 $r_m := r_1 + (m+\\tfrac{1}{2})\\Delta r$ ($m\\in\\{0,\\dots,N_r-1\\}$) 且 $\\theta_n := -\\pi + (n+\\tfrac{1}{2})\\Delta\\theta$ ($n\\in\\{0,\\dots,N_\\theta-1\\}$)。与一个中点相关的面积权重为 $r_m \\Delta r \\Delta \\theta$。在给定裂纹尖端位置的数值域积分为\n$$\nJ_{\\mathrm{num}} \\approx \\sum_{m=0}^{N_r-1} \\sum_{n=0}^{N_\\theta-1} \\left( F(r_m,\\theta_n)\\cdot \\nabla q(r_m) \\right) \\, r_m \\Delta r \\Delta \\theta,\n$$\n其中 $\\nabla q(r_m) = -\\frac{1}{r_2-r_1} \\mathbf{e}_r(\\theta_n)$ 并且 $F$ 在相应的求积点处进行评估。\n\n在裂纹前进 $\\Delta a$ 过程中的网格重划分会生成一个以新尖端 $(x_{\\mathrm{tip}}, y_{\\mathrm{tip}})$ 为中心的新环形网格。为了量化由传递引起的误差累积，我们考虑两种将离散化的 $F$ 从前一个网格映射到新网格的网格间传递算子：\n\n- 最近邻算子 $T_{\\mathrm{nn}}$：给定具有通量值 $\\{ F_i^{\\mathrm{old}} \\}$ 的前一中点坐标集 $\\{ \\mathbf{x}_i^{\\mathrm{old}} \\}_{i=1}^M$ 和新中点集 $\\{ \\mathbf{x}_j^{\\mathrm{new}} \\}_{j=1}^N$，令 $F_j^{\\mathrm{new}} := F_i^{\\mathrm{old}}$，其中 $i$ 使得 $\\|\\mathbf{x}_i^{\\mathrm{old}} - \\mathbf{x}_j^{\\mathrm{new}}\\|_2$ 最小。\n\n- 最小二乘 $L^2$ 投影算子 $T_{\\mathrm{ls}}$：将前一中点上的 $F$ 的每个分量用笛卡尔坐标 $(x,y)$ 中的一个线性模型表示，\n$$\nF_x(x,y) \\approx c_{x,0} + c_{x,1} x + c_{x,2} y, \\quad F_y(x,y) \\approx c_{y,0} + c_{y,1} x + c_{y,2} y,\n$$\n并通过最小化前一中点样本上的残差平方和来确定系数向量 $\\mathbf{c}_x$ 和 $\\mathbf{c}_y$。在矩阵形式中，设计矩阵 $\\Phi \\in \\mathbb{R}^{M\\times 3}$ 的行为 $[1, x_i, y_i]$，则正规方程为\n$$\n\\Phi^\\top \\Phi\\, \\mathbf{c}_x = \\Phi^\\top \\mathbf{f}_x, \\quad \\Phi^\\top \\Phi\\, \\mathbf{c}_y = \\Phi^\\top \\mathbf{f}_y,\n$$\n其中 $\\mathbf{f}_x$ 和 $\\mathbf{f}_y$ 收集了之前的 $F_x$ 和 $F_y$ 样本。在新中点处评估这些线性模型以获得 $F^{\\mathrm{new}}$。\n\n在每个扩展步骤中，我们使用其中一个算子将先前采样的 $F$ 传递到新网格，而无需重新计算精确的人工构造场 $F$，然后通过域求积法评估 $J_{\\mathrm{num}}$。这模拟了在实际场景中，场量在网格重划分期间被传递，而不是每一步都从基本原理重新计算。误差累积由指定步数后的最终绝对误差 $|J_{\\mathrm{num}} - J_{\\mathrm{exact}}|$ 来表征。\n\n算法概述：\n\n- 计算 $E' := E/(1-\\nu^2)$ 和 $J_{\\mathrm{exact}} := K_I^2 / E'$。\n\n- 使用上面推导的公式计算 $J_0$，以使连续积分等于 $J_{\\mathrm{exact}}$。\n\n- 将裂纹尖端初始化于 $(x_{\\mathrm{tip}}, y_{\\mathrm{tip}}) = (0,0)$，并构建初始的环形中点集和面积权重。在这些中点上评估人工构造场 $F$，以初始化两个算子的离散场。\n\n- 对于每个步骤 $s \\in \\{1,\\dots,S\\}$：\n  - 将尖端沿 $x$ 方向推进 $\\Delta a$：$(x_{\\mathrm{tip}}, y_{\\mathrm{tip}}) \\leftarrow (x_{\\mathrm{tip}} + \\Delta a, y_{\\mathrm{tip}})$。\n  - 构建以新尖端为中心的新环形中点集。\n  - 使用 $T_{\\mathrm{nn}}$ 和 $T_{\\mathrm{ls}}$ 将 $F$ 从前一中点传递到新中点，以获得两组传递后的场。\n  - 对每个传递后的场使用中点求积法评估数值域积分 $J_{\\mathrm{num}}$。\n\n- 按照测试套件规定的顺序，报告每个算子的最终绝对误差（单位为 $\\mathrm{N}/\\mathrm{m}$）。\n\n科学真实性通过以下方式得到保证：推导基于能量-动量张量和散度定理，使用一致的物理单位，并通过排除内半径 $r_1$ 来避免裂纹核心奇异性。选择人工构造场 $F$ 是为了在指定权函数 $q(r)$ 下产生一个已知的精确域积分值，这使得能够在没有每一步都求解完整弹性问题的混淆因素的情况下，分离并量化网格重划分和场传递的影响。最小二乘投影提供了一个可复现的 $L^2$ 传递算子，而最近邻映射提供了一个简单的基线。通过遍历不同的网格分辨率和步长，该测试套件覆盖了典型场景：一个通用情况、一个粗网格情况和一个大步长情况，从而突显了不同的误差机制。\n\n程序将所有情况的结果汇总到单行中，格式为方括号括起来的逗号分隔列表，其中每个条目都是一个单位为 $\\mathrm{N}/\\mathrm{m}$ 的浮点数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef annulus_midpoints(tip, r1, r2, Nr, Nth):\n    \"\"\"\n    Build midpoint quadrature points for an annulus centered at tip.\n    Returns positions (x,y), polar coords (r,theta), and area weights.\n    \"\"\"\n    x_tip, y_tip = tip\n    dr = (r2 - r1) / Nr\n    dth = 2.0 * np.pi / Nth\n    # Midpoints in radial and angular directions\n    r_mid = r1 + (np.arange(Nr) + 0.5) * dr\n    th_mid = -np.pi + (np.arange(Nth) + 0.5) * dth\n    # Create grid\n    R, TH = np.meshgrid(r_mid, th_mid, indexing='ij')\n    # Coordinates in global frame\n    X = x_tip + R * np.cos(TH)\n    Y = y_tip + R * np.sin(TH)\n    # Area weights per midpoint\n    area = R * dr * dth\n    return X, Y, R, TH, area\n\ndef manufactured_F(R, TH, J0, p):\n    \"\"\"\n    Manufactured energy-momentum flux density:\n    F = J0 * R^{-p} * [cos(theta/2), sin(theta/2)].\n    \"\"\"\n    scale = J0 * np.power(R, -p)\n    Fx = scale * np.cos(TH / 2.0)\n    Fy = scale * np.sin(TH / 2.0)\n    return Fx, Fy\n\ndef grad_q(R, r1, r2):\n    \"\"\"\n    Gradient of the radial weight function q(r):\n    For r in (r1, r2): grad q = -(1/(r2-r1)) * e_r; else zero.\n    e_r = [cos(theta), sin(theta)] is accounted by caller via angle.\n    Returns radial derivative coefficient dqdr = -1/(r2-r1) where applicable,\n    else zero.\n    \"\"\"\n    dqdr = np.zeros_like(R)\n    mask = (R > r1)  (R  r2)\n    if np.any(mask):\n        dqdr[mask] = -1.0 / (r2 - r1)\n    return dqdr\n\ndef domain_integral(Fx, Fy, dqdr, TH, area):\n    \"\"\"\n    Evaluate J_num ≈ sum (F · grad q) * area, with grad q = dqdr * e_r.\n    e_r = [cos(theta), sin(theta)].\n    \"\"\"\n    ex = np.cos(TH)\n    ey = np.sin(TH)\n    integrand = (Fx * ex + Fy * ey) * dqdr\n    J_num = np.sum(integrand * area)\n    return J_num\n\ndef compute_J0(J_exact, r1, r2, p):\n    \"\"\"\n    From continuous manufactured integral:\n    J_exact = -(4 J0 / (r2 - r1)) * (r2^{2-p} - r1^{2-p}) / (2 - p)\n    Solve for J0.\n    \"\"\"\n    numerator = -J_exact * (r2 - r1) * (2.0 - p)\n    denom = 4.0 * (np.power(r2, 2.0 - p) - np.power(r1, 2.0 - p))\n    return numerator / denom\n\ndef nearest_neighbor_transfer(X_old, Y_old, Fx_old, Fy_old, X_new, Y_new):\n    \"\"\"\n    Transfer field via nearest neighbor from old midpoints to new midpoints.\n    Brute-force using broadcasting; acceptable for moderate sizes.\n    \"\"\"\n    # Flatten arrays\n    xo = X_old.ravel(); yo = Y_old.ravel()\n    fx_o = Fx_old.ravel(); fy_o = Fy_old.ravel()\n    xn = X_new.ravel()[:, None]; yn = Y_new.ravel()[:, None]\n    # Compute squared distances to all old points\n    dx = xn - xo[None, :]\n    dy = yn - yo[None, :]\n    dist2 = dx*dx + dy*dy\n    idx = np.argmin(dist2, axis=1)\n    fx_n = fx_o[idx].reshape(X_new.shape)\n    fy_n = fy_o[idx].reshape(Y_new.shape)\n    return fx_n, fy_n\n\ndef ls_transfer(X_old, Y_old, Fx_old, Fy_old, X_new, Y_new):\n    \"\"\"\n    Transfer field via least-squares linear fit in [1, x, y].\n    Fits Fx and Fy separately.\n    \"\"\"\n    # Design matrix for old points\n    Phi = np.stack([np.ones_like(X_old), X_old, Y_old], axis=-1).reshape(-1, 3)\n    fx_vec = Fx_old.ravel()\n    fy_vec = Fy_old.ravel()\n    # Solve normal equations using lstsq\n    cx, *_ = np.linalg.lstsq(Phi, fx_vec, rcond=None)\n    cy, *_ = np.linalg.lstsq(Phi, fy_vec, rcond=None)\n    # Evaluate on new points\n    Phi_new = np.stack([np.ones_like(X_new), X_new, Y_new], axis=-1).reshape(-1, 3)\n    fx_new = (Phi_new @ cx).reshape(X_new.shape)\n    fy_new = (Phi_new @ cy).reshape(X_new.shape)\n    return fx_new, fy_new\n\ndef run_case(E, nu, KI, r1, r2, p, Nr, Nth, da, steps):\n    \"\"\"\n    Run a test case; return final absolute errors for NN and LS operators.\n    \"\"\"\n    # Effective modulus and exact J\n    E_eff = E / (1.0 - nu**2)\n    J_exact = (KI**2) / E_eff\n    # Manufactured amplitude\n    J0 = compute_J0(J_exact, r1, r2, p)\n    # Initialize tip and mesh\n    tip = (0.0, 0.0)\n    X_old, Y_old, R_old, TH_old, area_old = annulus_midpoints(tip, r1, r2, Nr, Nth)\n    Fx_exact, Fy_exact = manufactured_F(R_old, TH_old, J0, p)\n    # Initialize fields for both operators with exact manufactured field\n    Fx_nn = Fx_exact.copy(); Fy_nn = Fy_exact.copy()\n    Fx_ls = Fx_exact.copy(); Fy_ls = Fy_exact.copy()\n    # Simulate propagation steps\n    J_nn = None; J_ls = None\n    for _ in range(steps):\n        tip = (tip[0] + da, tip[1])\n        X_new, Y_new, R_new, TH_new, area_new = annulus_midpoints(tip, r1, r2, Nr, Nth)\n        # Transfer nearest neighbor\n        Fx_nn_new, Fy_nn_new = nearest_neighbor_transfer(X_old, Y_old, Fx_nn, Fy_nn, X_new, Y_new)\n        # Transfer least squares\n        Fx_ls_new, Fy_ls_new = ls_transfer(X_old, Y_old, Fx_ls, Fy_ls, X_new, Y_new)\n        # Evaluate domain integrals\n        dqdr_new = grad_q(R_new, r1, r2)\n        J_nn = domain_integral(Fx_nn_new, Fy_nn_new, dqdr_new, TH_new, area_new)\n        J_ls = domain_integral(Fx_ls_new, Fy_ls_new, dqdr_new, TH_new, area_new)\n        # Update for next step\n        X_old, Y_old = X_new, Y_new\n        Fx_nn, Fy_nn = Fx_nn_new, Fy_nn_new\n        Fx_ls, Fy_ls = Fx_ls_new, Fy_ls_new\n    # Final absolute errors in N/m\n    err_nn = abs(J_nn - J_exact)\n    err_ls = abs(J_ls - J_exact)\n    return err_nn, err_ls\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: baseline resolution and small step\n        {\n            \"E\": 210e9, \"nu\": 0.3, \"KI\": 1e6,\n            \"r1\": 5e-3, \"r2\": 2e-2, \"p\": 0.5,\n            \"Nr\": 20, \"Nth\": 64, \"da\": 1e-3, \"steps\": 50\n        },\n        # Case 2: coarse resolution and moderate step\n        {\n            \"E\": 210e9, \"nu\": 0.3, \"KI\": 1e6,\n            \"r1\": 5e-3, \"r2\": 2e-2, \"p\": 0.5,\n            \"Nr\": 8, \"Nth\": 16, \"da\": 1.5e-3, \"steps\": 50\n        },\n        # Case 3: baseline resolution and large step\n        {\n            \"E\": 210e9, \"nu\": 0.3, \"KI\": 1e6,\n            \"r1\": 5e-3, \"r2\": 2e-2, \"p\": 0.5,\n            \"Nr\": 20, \"Nth\": 64, \"da\": 5e-3, \"steps\": 25\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        err_nn, err_ls = run_case(**case)\n        results.append(err_nn)\n        results.append(err_ls)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}