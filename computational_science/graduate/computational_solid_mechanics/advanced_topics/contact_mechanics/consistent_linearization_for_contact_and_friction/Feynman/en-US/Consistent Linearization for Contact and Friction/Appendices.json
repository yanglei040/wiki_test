{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a foundational experience in consistent linearization. You will derive the tangent stiffness for a classic penalty-based Coulomb friction model and implement a Newton solver to observe the results firsthand. By verifying the quadratic convergence that a consistent tangent enables, you will gain a concrete appreciation for why this concept is a cornerstone of modern computational contact mechanics .",
            "id": "3555393",
            "problem": "Consider a quasi-static, planar, single-node tangential contact problem between a deformable body and a rigid foundation with Coulomb friction. The deformable body is modeled by a linear elastic tangential spring of stiffness $k_{s} > 0$ attached to a point mass constrained in the plane, and the contact interface is modeled by a tangential penalty stiffness $k_{t} > 0$ with Coulomb friction limit $\\tau = \\mu p > 0$, where $\\mu$ is the coefficient of friction and $p$ is the (constant) contact pressure. Let the unknown tangential displacement be the vector $u \\in \\mathbb{R}^{2}$, and let the externally applied load be $F \\in \\mathbb{R}^{2}$.\n\nThe governing equilibrium equation at the node is the balance of forces\n$$\nK u + t(u) = F,\n$$\nwhere $K = k_{s} I$ is the structural stiffness with $I \\in \\mathbb{R}^{2 \\times 2}$ the identity, and $t(u) \\in \\mathbb{R}^{2}$ is the frictional traction supplied by the interface. The Coulomb friction model with a tangential penalty for sticking is defined by the following active-set characterization:\n\n- Define the trial traction\n$$\nt_{\\mathrm{tr}}(u) = k_{t}\\,u.\n$$\n\n- Stick set: if $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$, the state is sticking and the traction is\n$$\nt(u) = t_{\\mathrm{tr}}(u).\n$$\n\n- Slip set: if $\\|t_{\\mathrm{tr}}(u)\\| > \\tau$, the state is slipping and the traction is radial-returned to the Coulomb disc,\n$$\nt(u) = \\tau \\,\\frac{t_{\\mathrm{tr}}(u)}{\\|t_{\\mathrm{tr}}(u)\\|} = \\tau \\,\\frac{u}{\\|u\\|}.\n$$\n\nYou are to derive a fully consistent linearization of the residual for use in a monolithic Newton method with active-set updates within each iteration. Specifically:\n\n1. Starting only from the balance equation, the stick/slip definitions above, and calculus rules, derive the Newton residual\n$$\nr(u) = K u + t(u) - F,\n$$\nand the consistent Jacobian\n$$\nJ(u) = \\frac{\\partial r(u)}{\\partial u} = K + \\frac{\\partial t(u)}{\\partial u},\n$$\nfor both the stick and slip sets. Your derivation must show how the active-set updates enter the algorithm and why the linearization remains consistent once the set is identified.\n\n2. Implement a Newton solver for the nonlinear system $r(u) = 0$ with active-set updates at each iteration according to the stick/slip criteria above, using the derived consistent Jacobian for the current set. At each iteration $k$, compute the residual norm $\\|r(u^{(k)})\\|_{2}$, update $u^{(k+1)}$ by solving\n$$\nJ(u^{(k)})\\,\\Delta u^{(k)} = -r(u^{(k)}), \\quad u^{(k+1)} = u^{(k)} + \\Delta u^{(k)},\n$$\nand record the active set label (stick or slip). Terminate when $\\|r(u^{(k)})\\|_{2} \\le \\varepsilon$ for a prescribed tolerance $\\varepsilon > 0$.\n\n3. Quantitatively verify sustained quadratic convergence through repeated stick–slip transitions by checking the observed convergence order near the end of the iteration sequence for each load step. Define the local observed order using residual norms as\n$$\np_{k} = \\frac{\\ln\\left(\\dfrac{\\|r(u^{(k+1)})\\|_{2}}{\\|r(u^{(k)})\\|_{2}}\\right)}{\\ln\\left(\\dfrac{\\|r(u^{(k)})\\|_{2}}{\\|r(u^{(k-1)})\\|_{2}}\\right)},\n$$\nwhenever the denominators are defined and all residual norms are strictly positive. To avoid pre-asymptotic pollution, only assess $p_{k}$ once $\\|r(u^{(k)})\\|_{2} \\le \\rho$ for a prescribed threshold $\\rho > 0$.\n\nFor each load step in a sequence, identify the last iteration index at which the active set label changes; then, using only iterations after that index, require that the last two computed observed orders $p_{k}$ are each greater than or equal to $1.8$ to declare sustained quadratic convergence for that load step. If the Newton method converges in at most two iterations for a load step, declare sustained quadratic convergence by default for that step.\n\nImplement the algorithm and apply it to the following test suite. All forces must be expressed in Newtons (N), stiffnesses in Newtons per meter (N/m), displacements in meters (m), and angles in radians.\n\nCommon parameters for all tests:\n- $k_{s} = 10 \\,\\text{N/m}$,\n- $k_{t} = 100 \\,\\text{N/m}$,\n- $\\tau = 1 \\,\\text{N}$,\n- Newton tolerance $\\varepsilon = 10^{-12} \\,\\text{N}$,\n- Asymptotic threshold $\\rho = 10^{-6} \\,\\text{N}$,\n- Maximum iterations per load step $50$.\n\nTest cases:\n\n- Case 1 (stick–slip–stick–slip along a straight line): A sequence of four loads $F \\in \\mathbb{R}^{2}$ along the $x$-axis,\n  1. $F = (0.5, 0.0)$,\n  2. $F = (1.2, 0.0)$,\n  3. $F = (0.8, 0.0)$,\n  4. $F = (1.5, 0.0)$,\n  applied sequentially, using the converged displacement from the previous step as the initial guess for the next step.\n\n- Case 2 (directional rotation under persistent slip): A sequence of three loads of magnitude $2.0 \\,\\text{N}$ at angles $0$, $\\pi/4$, and $\\pi/2$ radians,\n  1. $F = 2.0 \\,(\\cos(0), \\sin(0))$,\n  2. $F = 2.0 \\,(\\cos(\\pi/4), \\sin(\\pi/4))$,\n  3. $F = 2.0 \\,(\\cos(\\pi/2), \\sin(\\pi/2))$,\n  applied sequentially, using the converged displacement from the previous step as the initial guess for the next step.\n\n- Case 3 (near-threshold toggling): A sequence of four loads near the stick–slip threshold along the $x$-axis,\n  1. $F = (1.08, 0.0)$,\n  2. $F = (1.12, 0.0)$,\n  3. $F = (1.09, 0.0)$,\n  4. $F = (1.11, 0.0)$,\n  applied sequentially, using the converged displacement from the previous step as the initial guess for the next step.\n\nFor each case, return a boolean indicating whether sustained quadratic convergence, in the precise sense defined above, is observed for every load step in that case. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[true,false,true]\" but using your language's boolean literals). Angles must be interpreted in radians, and all physical units must be respected as specified above. The final outputs for each case must be booleans.",
            "solution": "The user has provided a well-posed problem in computational solid mechanics concerning a single-node contact model with Coulomb friction. The task is to derive the consistent Jacobian for an active-set Newton method, implement the solver, and verify its quadratic convergence properties on a suite of test cases.\n\n### Problem Validation\nThe provided problem is a standard, albeit simplified, representation of frictional contact within computational mechanics.\n\n- **Givens**:\n    - Governing Equation: $K u + t(u) = F$\n    - Structural Stiffness: $K = k_{s} I$, with $I \\in \\mathbb{R}^{2 \\times 2}$ being the identity matrix.\n    - Frictional Traction $t(u)$:\n        - Trial Traction: $t_{\\mathrm{tr}}(u) = k_{t}\\,u$.\n        - Stick: If $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$, then $t(u) = t_{\\mathrm{tr}}(u)$.\n        - Slip: If $\\|t_{\\mathrm{tr}}(u)\\| > \\tau$, then $t(u) = \\tau \\frac{u}{\\|u\\|}$.\n    - Newton Method:\n        - Residual: $r(u) = K u + t(u) - F$.\n        - Jacobian: $J(u) = \\frac{\\partial r(u)}{\\partial u}$.\n        - Update: Solve $J(u^{(k)})\\,\\Delta u^{(k)} = -r(u^{(k)})$ for $\\Delta u^{(k)}$, then $u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$.\n    - Convergence Criteria:\n        - Termination: $\\|r(u^{(k)})\\|_{2} \\le \\varepsilon$.\n        - Observed Order: $p_{k} = \\frac{\\ln\\left(\\|r(u^{(k+1)})\\|_{2}/\\|r(u^{(k)})\\|_{2}\\right)}{\\ln\\left(\\|r(u^{(k)})\\|_{2}/\\|r(u^{(k-1)})\\|_{2}\\right)}$.\n        - Quadratic Convergence Check: For each load step, sustained quadratic convergence is declared if the last two valid computed orders $p_k$ (after the final active-set change and with $\\|r(u^{(k)})\\|_{2} \\le \\rho$) are both $\\ge 1.8$, or if the solver converges in $\\le 2$ iterations.\n    - Parameters: $k_{s} = 10 \\,\\text{N/m}$, $k_{t} = 100 \\,\\text{N/m}$, $\\tau = 1 \\,\\text{N}$, $\\varepsilon = 10^{-12} \\,\\text{N}$, $\\rho = 10^{-6} \\,\\text{N}$, max iterations $50$.\n    - Test Cases: Three sequences of applied loads $F$.\n\n- **Validation Verdict**: The problem is **valid**. It is scientifically grounded in established principles of contact mechanics, mathematically well-posed, objective, and self-contained. All necessary equations, parameters, and criteria are explicitly provided. The task requires a rigorous derivation and a careful implementation, which is a standard exercise in the field.\n\n### Part 1: Derivation of the Consistent Jacobian\n\nThe Newton's method for solving the nonlinear system $r(u) = 0$ requires the Jacobian matrix $J(u)$, which is the derivative of the residual $r(u)$ with respect to the displacement vector $u$.\n$$\nr(u) = k_s u + t(u) - F\n$$\nThe derivative of the residual is:\n$$\nJ(u) = \\frac{\\partial r(u)}{\\partial u} = \\frac{\\partial}{\\partial u} (k_s u + t(u) - F) = k_s \\frac{\\partial u}{\\partial u} + \\frac{\\partial t(u)}{\\partial u} - \\frac{\\partial F}{\\partial u}\n$$\nSince $F$ is an externally applied load, it is independent of $u$, so $\\frac{\\partial F}{\\partial u} = 0$. The term $\\frac{\\partial u}{\\partial u}$ is the identity matrix $I \\in \\mathbb{R}^{2 \\times 2}$. The structural stiffness is $K=k_s I$. Thus, the Jacobian simplifies to:\n$$\nJ(u) = K + \\frac{\\partial t(u)}{\\partial u}\n$$\nThe crucial part is the derivation of the traction derivative, $\\frac{\\partial t(u)}{\\partial u}$, which depends on the active set (stick or slip) at displacement $u$.\n\n**1. Stick Set Derivation**\n- **Condition**: The stick condition is $\\|t_{\\mathrm{tr}}(u)\\| \\le \\tau$, which, using the definition $t_{\\mathrm{tr}}(u) = k_t u$, simplifies to $k_t \\|u\\| \\le \\tau$.\n- **Traction**: In the stick set, the traction is linear in displacement:\n$$\nt(u) = k_t u\n$$\n- **Jacobian**: The derivative of this linear function is a constant tensor:\n$$\n\\frac{\\partial t(u)}{\\partial u} = \\frac{\\partial}{\\partial u} (k_t u) = k_t I\n$$\nSubstituting this into the general expression for $J(u)$, the consistent Jacobian for the stick set is:\n$$\nJ_{\\mathrm{stick}}(u) = K + k_t I = k_s I + k_t I = (k_s + k_t)I\n$$\nThis is a simple diagonal matrix, representing the combined stiffness of the structural spring and the contact penalty spring.\n\n**2. Slip Set Derivation**\n- **Condition**: The slip condition is $\\|t_{\\mathrm{tr}}(u)\\| > \\tau$, which simplifies to $k_t \\|u\\| > \\tau$. In this regime, $\\|u\\|$ cannot be zero.\n- **Traction**: In the slip set, the traction vector has a constant magnitude $\\tau$ and is directed opposite to the slip. Here, it is aligned with the displacement $u$:\n$$\nt(u) = \\tau \\frac{u}{\\|u\\|} = \\tau \\hat{n}(u)\n$$\nwhere $\\hat{n}(u) = u/\\|u\\|$ is the normalized displacement vector.\n- **Jacobian**: We must differentiate $t(u)$ with respect to $u \\in \\mathbb{R}^2$. This requires the chain rule. The derivative of the normalized vector $\\hat{n}(u)$ is a known result from tensor calculus:\n$$\n\\frac{\\partial \\hat{n}(u)}{\\partial u} = \\frac{\\partial}{\\partial u} \\left( \\frac{u}{\\|u\\|} \\right) = \\frac{1}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right)\n$$\nwhere $\\otimes$ denotes the outer product. The term $(I - \\hat{n} \\otimes \\hat{n})$ is a projection operator that projects onto the space orthogonal to $\\hat{n}$.\nUsing this, the derivative of the slip traction is:\n$$\n\\frac{\\partial t(u)}{\\partial u} = \\tau \\frac{\\partial \\hat{n}(u)}{\\partial u} = \\frac{\\tau}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right)\n$$\nSubstituting this into the general expression for $J(u)$, the consistent Jacobian for the slip set is:\n$$\nJ_{\\mathrm{slip}}(u) = K + \\frac{\\tau}{\\|u\\|} \\left( I - \\frac{u \\otimes u}{\\|u\\|^2} \\right) = k_s I + \\frac{\\tau}{\\|u\\|}I - \\frac{\\tau}{\\|u\\|^3}(u \\otimes u)\n$$\nThis Jacobian is rank-deficient in the radial direction (it has a zero eigenvalue corresponding to the eigenvector $u$), which reflects the fact that in the slip state, resistance to motion along the direction of $u$ is governed by the structural stiffness $k_s$ alone, while resistance to motion orthogonal to $u$ involves both $k_s$ and a geometric stiffness term $\\tau/\\|u\\|$.\n\n### Part 2: Algorithmic Design and Convergence\n\nThe Newton method is implemented with an active-set strategy. Within each iteration $k$ for a given displacement guess $u^{(k)}$:\n1.  The trial traction $t_{\\mathrm{tr}}(u^{(k)}) = k_t u^{(k)}$ is computed.\n2.  The active set is determined by comparing $\\|t_{\\mathrm{tr}}(u^{(k)})\\|$ with $\\tau$.\n3.  Based on the active set ('stick' or 'slip'), the appropriate expressions for the traction $t(u^{(k)})$ and Jacobian $J(u^{(k)})$ are selected from the derivations above.\n4.  The residual $r(u^{(k)}) = k_s u^{(k)} + t(u^{(k)}) - F$ is computed.\n5.  The linear system $J(u^{(k)}) \\Delta u^{(k)} = -r(u^{(k)})$ is solved for the displacement increment $\\Delta u^{(k)}$.\n6.  The displacement is updated: $u^{(k+1)} = u^{(k)} + \\Delta u^{(k)}$.\n7.  The process repeats until the residual norm $\\|r(u^{(k+1)})\\|_2$ falls below the tolerance $\\varepsilon$.\n\nThis procedure uses a *consistent linearization* because the Jacobian $J(u^{(k)})$ is the exact derivative of the residual function $r(u)$ for the specific active-set branch chosen at iteration $k$. Once the iterations converge to a point where the active set no longer changes, the method behaves as a standard Newton-Raphson solver for a smooth nonlinear system, which is known to exhibit quadratic convergence.\n\nThe quantitative verification of convergence is performed as specified. After a load step converges, the history of residual norms and active sets is analyzed. The \"sustained quadratic convergence\" criterion, which requires the last two computed asymptotic convergence orders $p_k$ to be $\\ge 1.8$, is a rigorous check that the method indeed achieves the theoretically expected performance after any initial non-smoothness due to active-set toggling is resolved.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the contact mechanics problem and verifies convergence.\n    \"\"\"\n\n    # Common parameters\n    ks = 10.0  # N/m\n    kt = 100.0 # N/m\n    tau = 1.0  # N\n    eps = 1e-12 # N\n    rho = 1e-6  # N\n    max_iter = 50\n\n    # Test cases\n    test_cases_loads = [\n        # Case 1: stick-slip-stick-slip along a straight line\n        [\n            np.array([0.5, 0.0]),\n            np.array([1.2, 0.0]),\n            np.array([0.8, 0.0]),\n            np.array([1.5, 0.0]),\n        ],\n        # Case 2: directional rotation under persistent slip\n        [\n            2.0 * np.array([math.cos(0.0), math.sin(0.0)]),\n            2.0 * np.array([math.cos(math.pi / 4.0), math.sin(math.pi / 4.0)]),\n            2.0 * np.array([math.cos(math.pi / 2.0), math.sin(math.pi / 2.0)]),\n        ],\n        # Case 3: near-threshold toggling\n        [\n            np.array([1.08, 0.0]),\n            np.array([1.12, 0.0]),\n            np.array([1.09, 0.0]),\n            np.array([1.11, 0.0]),\n        ],\n    ]\n\n    overall_results = []\n\n    for case_loads in test_cases_loads:\n        u_initial = np.zeros(2)\n        case_passed = True\n        for F_load in case_loads:\n            u_converged, history = newton_solver(F_load, u_initial, ks, kt, tau, eps, max_iter)\n            \n            load_step_passed = analyze_convergence(history['residual_norms'], history['active_sets'], rho)\n\n            if not load_step_passed:\n                case_passed = False\n                break\n            \n            u_initial = u_converged\n        \n        overall_results.append(case_passed)\n\n    print(f\"[{','.join(map(str, overall_results))}]\".lower())\n\ndef newton_solver(F, u_initial, ks, kt, tau, eps, max_iter):\n    \"\"\"\n    Performs the active-set Newton method for a single load step.\n    \"\"\"\n    u = np.copy(u_initial)\n    I = np.identity(2)\n    K = ks * I\n\n    history = {'residual_norms': [], 'active_sets': []}\n    \n    for k in range(max_iter + 1):\n        # Determine active set and compute traction t and its derivative dt_du\n        t_tr = kt * u\n        norm_t_tr = np.linalg.norm(t_tr)\n\n        if norm_t_tr <= tau:\n            # Stick state\n            active_set = 'stick'\n            t = t_tr\n            dt_du = kt * I\n        else:\n            # Slip state\n            active_set = 'slip'\n            norm_u = np.linalg.norm(u)\n            # norm_u will not be zero in slip, as kt*||u|| > tau > 0\n            t = tau * u / norm_u\n            \n            u_outer_u = np.outer(u, u)\n            dt_du = (tau / norm_u) * (I - u_outer_u / (norm_u**2))\n            \n        # Compute residual r and Jacobian J\n        r = K @ u + t - F\n        J = K + dt_du\n        \n        norm_r = np.linalg.norm(r)\n        \n        history['residual_norms'].append(norm_r)\n        history['active_sets'].append(active_set)\n        \n        if norm_r <= eps:\n            break\n            \n        if k == max_iter:\n            # Failed to converge\n            break\n\n        # Solve for increment and update\n        delta_u = np.linalg.solve(J, -r)\n        u = u + delta_u\n        \n    return u, history\n\ndef analyze_convergence(residual_norms, active_sets, rho):\n    \"\"\"\n    Verifies sustained quadratic convergence for a single load step.\n    \"\"\"\n    num_iterations = len(residual_norms) - 1\n    \n    # Pass by default if converged in <= 2 iterations\n    if num_iterations <= 2:\n        return True\n\n    # Find the index of the last iteration where the active set changed\n    last_change_idx = 0\n    for i in range(1, len(active_sets)):\n        if active_sets[i] != active_sets[i-1]:\n            last_change_idx = i\n\n    valid_p_orders = []\n    # k is the index into the residual_norms list, corresponding to u^(k)\n    # We can compute p_k for k from 1 to len-2.\n    # We only consider k > last_change_idx.\n    for k in range(last_change_idx + 1, len(residual_norms) - 1):\n        if k == 0:\n             continue # Cannot compute p_k if k=0\n        \n        norm_rk_m1 = residual_norms[k-1]\n        norm_rk = residual_norms[k]\n        norm_rk_p1 = residual_norms[k+1]\n\n        # Check conditions for computing p_k\n        if norm_rk > rho:\n            continue\n            \n        # Denominators must be defined and norms strictly positive\n        if norm_rk_m1 <= 0 or norm_rk <= 0:\n            continue\n        \n        # Avoid division by zero if norms are equal\n        if abs(norm_rk - norm_rk_m1) < 1e-15:\n            continue\n\n        denominator = np.log(norm_rk / norm_rk_m1)\n        if abs(denominator) < 1e-15:\n            continue\n\n        numerator = np.log(norm_rk_p1 / norm_rk)\n        \n        pk = numerator / denominator\n        valid_p_orders.append(pk)\n        \n    # Check if the last two valid computed orders are >= 1.8\n    if len(valid_p_orders) >= 2:\n        if valid_p_orders[-1] >= 1.8 and valid_p_orders[-2] >= 1.8:\n            return True\n    \n    return False\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "Building on the penalty method, we now explore the powerful augmented Lagrangian formulation, a highly effective and widely used alternative for enforcing contact constraints. This practice focuses on linearizing the contact residuals within this framework, which reveals a crucial and distinct feature of Coulomb friction: a non-symmetric tangent stiffness matrix during slip. Understanding and correctly implementing this non-symmetric Jacobian is essential for creating robust and efficient solvers for frictional problems .",
            "id": "2550855",
            "problem": "Consider a two-dimensional node-to-node frictional contact interface at a single quadrature point within a finite element mesh. Let the unit normal and tangent at the interface be $n = (0,1)^\\top$ and $t = (1,0)^\\top$, respectively. The relative displacement between the slave and master nodes is $d = u_{s} - u_{m}$, with $u_{s} = (u_{s,x}, u_{s,y})^\\top$ and $u_{m} = (u_{m,x}, u_{m,y})^\\top$. Define the normal gap and tangential gap by $g_{n} = -n^\\top d$ (positive in penetration) and $g_{t} = t^\\top d$, respectively. Let $\\varepsilon_{n} > 0$ and $\\varepsilon_{t} > 0$ be the augmented Lagrangian parameters and $\\lambda_{n}$, $\\lambda_{t}$ the current Lagrange multipliers, which are held fixed during linearization. Define the normal and tangential predictors by $y_{n} = \\lambda_{n} + \\varepsilon_{n} g_{n}$ and $y_{t} = \\lambda_{t} + \\varepsilon_{t} g_{t}$. The compressive normal traction magnitude is $t_{n} = \\langle y_{n} \\rangle_{+} = \\max(0, y_{n})$. With a Coulomb friction coefficient $\\mu > 0$, the friction bound is $b = \\mu t_{n}$, and the tangential traction is given by the projection (clamp) $\\tau = \\operatorname{clamp}(y_{t}, -b, b)$. The interface traction vector acting on the slave side is $\\mathbf{t} = t_{n} n + \\tau t$, and the residual contribution to the slave node is $r_{s} = -\\mathbf{t}$.\n\nStarting from the definitions above and the complementarity structure implied by unilateral contact and Coulomb friction, derive the consistent linearization $\\partial r_{s} / \\partial u$ that is suitable for a Newton method. Your derivation must explicitly account for the dependence of the active set on the trial state, namely: (i) open versus closed contact determined by the sign of $y_{n}$, and (ii) stick versus slip determined by comparing $|y_{t}|$ with $b = \\mu t_{n}$. Clearly state the expressions for the directional derivatives with respect to $u$ in each active-set branch.\n\nThen, for the specific data\n$\\varepsilon_{n} = 2.5 \\times 10^{6}$, $\\varepsilon_{t} = 1.0 \\times 10^{6}$, $\\mu = 0.3$, $\\lambda_{n} = 150$, $\\lambda_{t} = 50$, $u_{s} = (4.0 \\times 10^{-4}, -3.0 \\times 10^{-4})^\\top$, and $u_{m} = (5.0 \\times 10^{-5}, -1.0 \\times 10^{-4})^\\top$, evaluate the scalar Jacobian entry $\\partial r_{s,y} / \\partial u_{s,y}$ at this trial state. Round your answer to four significant figures and express it in $\\mathrm{N/m}$.",
            "solution": "The problem statement is scientifically grounded, well-posed, and complete. It describes a standard augmented Lagrangian formulation for frictional contact, a common and valid approach in computational mechanics. I will now proceed with the derivation and evaluation.\n\nThe objective is to compute the consistent linearization of the slave node residual, $r_s$, with respect to the nodal displacements, $u$. The residual is given by $r_s = -\\mathbf{t}$, where $\\mathbf{t} = t_n n + \\tau t$. We are interested in the Jacobian matrix, whose components are the directional derivatives of $r_s$. The total displacement vector is $u = (u_s^\\top, u_m^\\top)^\\top$. The dependency of all quantities is on the relative displacement $d = u_s - u_m$. From the chain rule, it is clear that $\\frac{\\partial r_s}{\\partial u_m} = \\frac{\\partial r_s}{\\partial d} \\frac{\\partial d}{\\partial u_m} = \\frac{\\partial r_s}{\\partial d} (-I) = -\\frac{\\partial r_s}{\\partial u_s}$. Therefore, we only need to derive the Jacobian block $K_{ss} = \\frac{\\partial r_s}{\\partial u_s}$.\n\nThe directional derivative of $r_s$ with respect to a change in $u_s$ in the direction $\\Delta u_s$ is:\n$$\nD_{u_s}r_s[\\Delta u_s] = -D_{u_s}\\mathbf{t}[\\Delta u_s] = -\\left( (D_{u_s}t_n[\\Delta u_s]) n + (D_{u_s}\\tau[\\Delta u_s]) t \\right)\n$$\nWe must find the directional derivatives of the normal traction, $t_n$, and the tangential traction, $\\tau$. These depend on the trial state, which is determined by the predictors $y_n$ and $y_t$.\n\nFirst, we establish the variation of the kinematic quantities and predictors.\nThe variations of the normal and tangential gaps, $g_n$ and $g_t$, with respect to a variation $\\Delta u_s$ are:\n$$\n\\Delta g_n = D_{u_s}g_n[\\Delta u_s] = D_{u_s}(-n^\\top (u_s - u_m))[\\Delta u_s] = -n^\\top \\Delta u_s\n$$\n$$\n\\Delta g_t = D_{u_s}g_t[\\Delta u_s] = D_{u_s}(t^\\top (u_s - u_m))[\\Delta u_s] = t^\\top \\Delta u_s\n$$\nThe Lagrange multipliers $\\lambda_n$ and $\\lambda_t$ are held fixed. Thus, the variations of the predictors $y_n$ and $y_t$ are:\n$$\n\\Delta y_n = \\varepsilon_n \\Delta g_n = -\\varepsilon_n n^\\top \\Delta u_s\n$$\n$$\n\\Delta y_t = \\varepsilon_t \\Delta g_t = \\varepsilon_t t^\\top \\Delta u_s\n$$\nThe derivatives of $t_n$ and $\\tau$ are non-smooth and depend on the active set. We analyze each case.\n\nCase 1: Open Contact ($y_n \\leq 0$)\nIn this state, $t_n = \\langle y_n \\rangle_+ = 0$. The friction bound is $b = \\mu t_n = 0$. The tangential traction is $\\tau = \\operatorname{clamp}(y_t, -b, b) = 0$. The total traction is $\\mathbf{t} = 0$, so the residual $r_s = 0$. As a result, the tangent stiffness is a null matrix:\n$$\nK_{ss} = \\frac{\\partial r_s}{\\partial u_s} = 0\n$$\n\nCase 2: Closed Contact ($y_n > 0$)\nHere, $t_n = y_n$. The directional derivative is:\n$$\nD_{u_s}t_n[\\Delta u_s] = \\Delta y_n = -\\varepsilon_n n^\\top \\Delta u_s \\implies \\frac{\\partial t_n}{\\partial u_s} = -\\varepsilon_n n^\\top\n$$\nThe variation of the friction bound $b = \\mu t_n$ is:\n$$\n\\Delta b = \\mu \\Delta t_n = -\\mu \\varepsilon_n n^\\top \\Delta u_s\n$$\nThe derivative of the tangential traction $\\tau = \\operatorname{clamp}(y_t, -b, b)$ depends on the stick/slip state.\n\nSubcase 2a: Stick ($|y_t| < b$)\nIn the stick state, $\\tau = y_t$. The directional derivative is:\n$$\nD_{u_s}\\tau[\\Delta u_s] = \\Delta y_t = \\varepsilon_t t^\\top \\Delta u_s \\implies \\frac{\\partial \\tau}{\\partial u_s} = \\varepsilon_t t^\\top\n$$\nSubstituting into the expression for the residual variation:\n$$\nD_{u_s}r_s[\\Delta u_s] = -\\left( (-\\varepsilon_n n^\\top \\Delta u_s) n + (\\varepsilon_t t^\\top \\Delta u_s) t \\right) = \\left( \\varepsilon_n n n^\\top + \\varepsilon_t t t^\\top \\right) \\Delta u_s\n$$\nThe tangent stiffness matrix is symmetric:\n$$\nK_{ss} = \\varepsilon_n n n^\\top + \\varepsilon_t t t^\\top\n$$\n\nSubcase 2b: Forward Slip ($y_t \\geq b$)\nIn forward slip, $\\tau = b = \\mu t_n$. The directional derivative is:\n$$\nD_{u_s}\\tau[\\Delta u_s] = \\Delta b = -\\mu \\varepsilon_n n^\\top \\Delta u_s \\implies \\frac{\\partial \\tau}{\\partial u_s} = -\\mu \\varepsilon_n n^\\top\n$$\nThe residual variation is:\n$$\nD_{u_s}r_s[\\Delta u_s] = -\\left( (-\\varepsilon_n n^\\top \\Delta u_s) n + (-\\mu \\varepsilon_n n^\\top \\Delta u_s) t \\right) = \\left( \\varepsilon_n n n^\\top + \\mu \\varepsilon_n t n^\\top \\right) \\Delta u_s\n$$\nThe tangent stiffness matrix is non-symmetric:\n$$\nK_{ss} = \\varepsilon_n (n n^\\top + \\mu t n^\\top) = \\varepsilon_n(n + \\mu t)n^\\top\n$$\n\nSubcase 2c: Backward Slip ($y_t \\leq -b$)\nIn backward slip, $\\tau = -b = -\\mu t_n$. The directional derivative is:\n$$\nD_{u_s}\\tau[\\Delta u_s] = -\\Delta b = -(-\\mu \\varepsilon_n n^\\top \\Delta u_s) = \\mu \\varepsilon_n n^\\top \\Delta u_s \\implies \\frac{\\partial \\tau}{\\partial u_s} = \\mu \\varepsilon_n n^\\top\n$$\nThe residual variation is:\n$$\nD_{u_s}r_s[\\Delta u_s] = -\\left( (-\\varepsilon_n n^\\top \\Delta u_s) n + (\\mu \\varepsilon_n n^\\top \\Delta u_s) t \\right) = \\left( \\varepsilon_n n n^\\top - \\mu \\varepsilon_n t n^\\top \\right) \\Delta u_s\n$$\nThe tangent stiffness matrix is also non-symmetric:\n$$\nK_{ss} = \\varepsilon_n (n n^\\top - \\mu t n^\\top) = \\varepsilon_n(n - \\mu t)n^\\top\n$$\n\nNow, we evaluate the specific case with the provided data.\nGiven: $\\varepsilon_{n} = 2.5 \\times 10^{6}$, $\\varepsilon_{t} = 1.0 \\times 10^{6}$, $\\mu = 0.3$, $\\lambda_{n} = 150$, $\\lambda_{t} = 50$.\nSlave displacement $u_{s} = (4.0 \\times 10^{-4}, -3.0 \\times 10^{-4})^\\top$.\nMaster displacement $u_{m} = (5.0 \\times 10^{-5}, -1.0 \\times 10^{-4})^\\top$.\nVectors $n = (0,1)^\\top$, $t = (1,0)^\\top$.\n\n1.  Calculate the relative displacement $d$:\n    $$\n    d = u_s - u_m = \\begin{pmatrix} 4.0 \\times 10^{-4} - 5.0 \\times 10^{-5} \\\\ -3.0 \\times 10^{-4} - (-1.0 \\times 10^{-4}) \\end{pmatrix} = \\begin{pmatrix} 3.5 \\times 10^{-4} \\\\ -2.0 \\times 10^{-4} \\end{pmatrix}\n    $$\n2.  Calculate the gaps $g_n$ and $g_t$:\n    $$\n    g_n = -n^\\top d = - \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} 3.5 \\times 10^{-4} \\\\ -2.0 \\times 10^{-4} \\end{pmatrix} = 2.0 \\times 10^{-4}\n    $$\n    $$\n    g_t = t^\\top d = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} 3.5 \\times 10^{-4} \\\\ -2.0 \\times 10^{-4} \\end{pmatrix} = 3.5 \\times 10^{-4}\n    $$\n3.  Calculate the predictors $y_n$ and $y_t$:\n    $$\n    y_n = \\lambda_n + \\varepsilon_n g_n = 150 + (2.5 \\times 10^6)(2.0 \\times 10^{-4}) = 150 + 500 = 650\n    $$\n    $$\n    y_t = \\lambda_t + \\varepsilon_t g_t = 50 + (1.0 \\times 10^6)(3.5 \\times 10^{-4}) = 50 + 350 = 400\n    $$\n4.  Determine the contact and friction state:\n    -   Contact state: Since $y_n = 650 > 0$, the contact is closed.\n    -   Normal traction: $t_n = \\langle y_n \\rangle_+ = 650$.\n    -   Friction bound: $b = \\mu t_n = 0.3 \\times 650 = 195$.\n    -   Friction state: Since $y_t = 400 > b = 195$, the state is **forward slip**.\n\n5.  Select the corresponding tangent stiffness matrix $K_{ss}$:\n    For forward slip, $K_{ss} = \\varepsilon_n(n + \\mu t)n^\\top$. We expand this using the given vectors:\n    $$\n    K_{ss} = (2.5 \\times 10^{6}) \\left( \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 0.3 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right) \\begin{pmatrix} 0 & 1 \\end{pmatrix} = (2.5 \\times 10^{6}) \\begin{pmatrix} 0.3 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\end{pmatrix}\n    $$\n    $$\n    K_{ss} = (2.5 \\times 10^{6}) \\begin{pmatrix} 0 & 0.3 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0.75 \\times 10^{6} \\\\ 0 & 2.5 \\times 10^{6} \\end{pmatrix}\n    $$\n    The matrix $K_{ss}$ has components:\n    $$\n    K_{ss} = \\begin{pmatrix} \\frac{\\partial r_{s,x}}{\\partial u_{s,x}} & \\frac{\\partial r_{s,x}}{\\partial u_{s,y}} \\\\ \\frac{\\partial r_{s,y}}{\\partial u_{s,x}} & \\frac{\\partial r_{s,y}}{\\partial u_{s,y}} \\end{pmatrix}\n    $$\n    The requested scalar Jacobian entry is the $(2,2)$ component of this matrix:\n    $$\n    \\frac{\\partial r_{s,y}}{\\partial u_{s,y}} = 2.5 \\times 10^{6}\n    $$\n    Rounding to four significant figures gives $2.500 \\times 10^{6}$. The implicit units are $\\mathrm{N/m}$.",
            "answer": "$$\\boxed{2.500 \\times 10^{6}}$$"
        },
        {
            "introduction": "Our final practice moves from point-based contact to a more realistic segment-to-segment model, introducing the challenge of geometric nonlinearity. Here, consistent linearization must account not only for the frictional law but also for the changing orientation of the contact surface itself as the bodies deform. This exercise guides you through the derivation of the 'geometric stiffness' terms, demonstrating how normal pressure acting on a rotating surface contributes non-trivially to the tangent stiffness and is critical for achieving convergence in complex simulations .",
            "id": "3584746",
            "problem": "Consider a two-dimensional segment-to-segment contact discretization in the context of the Finite Element Method (FEM) with a penalty enforcement of normal and tangential constraints and classical Coulomb friction. A straight master segment with nodes $A$ and $B$ has initial coordinates $(-L/2,0)$ and $(+L/2,0)$, respectively, and a single slave particle $S$ is located at $(0,-\\delta)$ in the reference configuration. The contact integration point is fixed at the master segment midpoint (so the master shape functions evaluate to $N_{A}=N_{B}=1/2$ at the integration point), and the segment frame $\\{\\boldsymbol{t},\\boldsymbol{n}\\}$ is defined by the deformed segment, with $\\boldsymbol{t}$ the unit tangent and $\\boldsymbol{n}$ the unit outward normal, both updated co-rotationally from the current configuration.\n\nAssume small-strain, small-rotation kinematics. The rotation of the master segment is parameterized by the small angle $\\phi=(u_{y}^{B}-u_{y}^{A})/L$ so that, to first order at the undeformed horizontal configuration, the frame variations satisfy\n$$\n\\frac{\\partial \\boldsymbol{t}}{\\partial \\phi}=\\begin{bmatrix}0\\\\1\\end{bmatrix},\\qquad \\frac{\\partial \\boldsymbol{n}}{\\partial \\phi}=\\begin{bmatrix}-1\\\\0\\end{bmatrix},\n$$\nand thus\n$$\n\\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}}=\\frac{1}{L}\\begin{bmatrix}0\\\\1\\end{bmatrix},\\qquad \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}}=\\frac{1}{L}\\begin{bmatrix}-1\\\\0\\end{bmatrix},\n$$\nevaluated at $u_{y}^{A}=u_{y}^{B}=0$.\n\nLet the penalty parameters be $k_{n}$ for the normal response and $k_{t}$ for the tangential (stick) response. Let the Coulomb friction coefficient be $\\mu$, with sliding direction scalar $s=+1$ (i.e., the frictional traction, when active, opposes positive tangential slip). Define the contact traction vector acting on the slave as\n$$\n\\boldsymbol{f}=-p_{n}\\,\\boldsymbol{n}+t_{t}\\,\\boldsymbol{t},\n$$\nwhere the normal pressure magnitude is $p_{n}=k_{n}(-g_{n})$ for $g_{n}<0$, with normal gap $g_{n}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{n}$, and the tangential traction magnitude $t_{t}$ is given by the stick law $t_{t}=k_{t}\\,g_{t}$ with tangential gap $g_{t}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{t}$ in stick, and by the slip law $t_{t}=-\\mu\\,p_{n}\\,s$ in slip. Take the master midpoint position as $\\boldsymbol{x}_{m}=(\\boldsymbol{x}_{A}+\\boldsymbol{x}_{B})/2$.\n\nAt the linearization point, let $u_{y}^{A}=u_{y}^{B}=0$, so that $\\boldsymbol{t}=[1,0]^{\\top}$, $\\boldsymbol{n}=[0,1]^{\\top}$, and the slave lies at a constant normal penetration $g_{n}=-\\delta<0$ with $\\delta>0$ and zero tangential gap $g_{t}=0$.\n\nFocus on the single scalar Jacobian entry that linearly relates the change in the global $x$-component of the contact force at the slave,\n$$\nF_{x}=\\boldsymbol{f}\\cdot \\boldsymbol{e}_{x},\n$$\nto the perturbation of the master node $B$ vertical displacement $u_{y}^{B}$, i.e.,\n$$\nK:=\\frac{\\partial F_{x}}{\\partial u_{y}^{B}}.\n$$\n\n1) Starting from the principle of virtual work for contact and the above definitions, perform a consistent linearization to derive $K$ that explicitly retains the contributions from $\\partial \\boldsymbol{t}/\\partial u_{y}^{B}$ and $\\partial \\boldsymbol{n}/\\partial u_{y}^{B}$. Do this for both the stick regime and the slip regime at the same linearization point. You must treat $g_{n}$ and $g_{t}$ as functions of the relative position and the frame, i.e., $g_{n}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{n}$ and $g_{t}=(\\boldsymbol{x}_{s}-\\boldsymbol{x}_{m})\\cdot \\boldsymbol{t}$, with the contact integration point fixed at the master midpoint.\n\n2) Using your symbolic expressions, compute the change in the tangent stiffness entry when transitioning from stick to slip,\n$$\n\\Delta K:=K_{\\text{slip}}-K_{\\text{stick}},\n$$\nfor the following data: $L=2\\,\\mathrm{m}$, $\\delta=1.0\\times 10^{-3}\\,\\mathrm{m}$, $k_{n}=1.0\\times 10^{6}\\,\\mathrm{N/m}$, $k_{t}=1.0\\times 10^{5}\\,\\mathrm{N/m}$, $\\mu=0.3$, and $s=1$. Assume unit thickness so that force and stiffness are per unit out-of-plane thickness, and the contact quadrature weight is unity.\n\nExpress your final numerical answer for $\\Delta K$ in $\\mathrm{N/m}$ and round your answer to four significant figures.",
            "solution": "The problem asks for the derivation of a specific tangent stiffness matrix entry, $K = \\frac{\\partial F_{x}}{\\partial u_{y}^{B}}$, for a segment-to-segment contact element under both stick and slip conditions, and then to compute the change in this stiffness, $\\Delta K = K_{\\text{slip}} - K_{\\text{stick}}$.\n\nThe quantity to be differentiated is the $x$-component of the contact force vector $\\boldsymbol{f}$ acting on the slave particle. The force vector is defined as $\\boldsymbol{f} = -p_{n}\\,\\boldsymbol{n}+t_{t}\\,\\boldsymbol{t}$. Its $x$-component is $F_{x} = \\boldsymbol{f} \\cdot \\boldsymbol{e}_{x}$, where $\\boldsymbol{e}_{x} = [1, 0]^\\top$.\n$$\nF_{x} = (-p_{n}\\,\\boldsymbol{n}+t_{t}\\,\\boldsymbol{t}) \\cdot \\boldsymbol{e}_{x} = -p_{n}(\\boldsymbol{n} \\cdot \\boldsymbol{e}_{x}) + t_{t}(\\boldsymbol{t} \\cdot \\boldsymbol{e}_{x})\n$$\nLet's denote $n_x = \\boldsymbol{n} \\cdot \\boldsymbol{e}_{x}$ and $t_x = \\boldsymbol{t} \\cdot \\boldsymbol{e}_{x}$. So, $F_{x} = -p_{n} n_x + t_{t} t_x$.\n\nThe stiffness entry $K$ is the partial derivative of $F_x$ with respect to the vertical displacement of master node $B$, $u_{y}^{B}$. Applying the product rule for differentiation yields:\n$$\nK = \\frac{\\partial F_{x}}{\\partial u_{y}^{B}} = -\\frac{\\partial p_{n}}{\\partial u_{y}^{B}} n_x - p_{n} \\frac{\\partial n_x}{\\partial u_{y}^{B}} + \\frac{\\partial t_{t}}{\\partial u_{y}^{B}} t_x + t_{t} \\frac{\\partial t_x}{\\partial u_{y}^{B}}\n$$\nThis expression must be evaluated at the specified linearization point, where $u_{y}^{A} = u_{y}^{B} = 0$. At this point, the master segment is horizontal.\nThe tangent and normal vectors are:\n$\\boldsymbol{t} = [1, 0]^\\top$, so $t_x = 1$.\n$\\boldsymbol{n} = [0, 1]^\\top$, so $n_x = 0$.\n\nThe slave particle is at a normal penetration $g_n = -\\delta$ with $\\delta > 0$, and zero tangential gap, $g_t = 0$.\nThe normal pressure magnitude is $p_n = k_n(-g_n) = k_n \\delta$.\nIn the stick case, the tangential traction is $t_t = k_t g_t = k_t(0) = 0$.\nIn the slip case, the tangential traction is $t_t = -\\mu p_n s = -\\mu (k_n \\delta) s$.\n\nSubstituting the values of $n_x$ and $t_x$ at the linearization point into the expression for $K$:\n$$\nK = -\\frac{\\partial p_{n}}{\\partial u_{y}^{B}} (0) - p_{n} \\frac{\\partial n_x}{\\partial u_{y}^{B}} + \\frac{\\partial t_{t}}{\\partial u_{y}^{B}} (1) + t_{t} \\frac{\\partial t_x}{\\partial u_{y}^{B}} = -p_{n} \\frac{\\partial n_x}{\\partial u_{y}^{B}} + \\frac{\\partial t_{t}}{\\partial u_{y}^{B}} + t_{t} \\frac{\\partial t_x}{\\partial u_{y}^{B}}\n$$\nWe need to find the derivatives of the frame components, $\\frac{\\partial n_x}{\\partial u_{y}^{B}}$ and $\\frac{\\partial t_x}{\\partial u_{y}^{B}}$.\nUsing the provided frame derivatives:\n$$\n\\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}} = \\frac{1}{L}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\qquad \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}} = \\frac{1}{L}\\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix}\n$$\nThe derivatives of the components are:\n$$\n\\frac{\\partial t_x}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{t} \\cdot \\boldsymbol{e}_x)}{\\partial u_{y}^{B}} = \\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{e}_x = \\frac{1}{L}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = 0\n$$\n$$\n\\frac{\\partial n_x}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{n} \\cdot \\boldsymbol{e}_x)}{\\partial u_{y}^{B}} = \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{e}_x = \\frac{1}{L}\\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix} \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = -\\frac{1}{L}\n$$\nSubstituting these into the expression for $K$:\n$$\nK = -p_n \\left(-\\frac{1}{L}\\right) + \\frac{\\partial t_t}{\\partial u_{y}^{B}} + t_t(0) = \\frac{p_n}{L} + \\frac{\\partial t_t}{\\partial u_{y}^{B}}\n$$\nSubstituting $p_n=k_n \\delta$:\n$$\nK = \\frac{k_n \\delta}{L} + \\frac{\\partial t_t}{\\partial u_{y}^{B}}\n$$\nThis general form is valid for both stick and slip regimes. The difference lies in the term $\\frac{\\partial t_t}{\\partial u_{y}^{B}}$. This term is often called the 'material' contribution, while $\\frac{p_n}{L}$ is the 'geometric' or 'pressure' contribution to the stiffness.\n\n### 1. Stick Regime ($K_{\\text{stick}}$)\nIn the stick regime, $t_t = k_t g_t$. We need to compute its derivative:\n$$\n\\frac{\\partial t_t}{\\partial u_{y}^{B}} = k_t \\frac{\\partial g_t}{\\partial u_{y}^{B}}\n$$\nThe tangential gap is $g_t = (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\boldsymbol{t}$. Its derivative is:\n$$\n\\frac{\\partial g_t}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{t} + (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}}\n$$\nAt the linearization point, the slave position $\\boldsymbol{x}_s$ is held constant, and the master contact point position is $\\boldsymbol{x}_m=\\frac{1}{2}(\\boldsymbol{x}_A+\\boldsymbol{x}_B)$. The displacement of the master point is $\\boldsymbol{u}_m = \\frac{1}{2}(\\boldsymbol{u}_A+\\boldsymbol{u}_B)$.\nThe derivative of the relative position vector is:\n$$\n\\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} = -\\frac{\\partial \\boldsymbol{x}_m}{\\partial u_{y}^{B}} = -\\frac{\\partial \\boldsymbol{u}_m}{\\partial u_{y}^{B}} = -\\frac{1}{2}\\frac{\\partial \\boldsymbol{u}_B}{\\partial u_{y}^{B}} = -\\frac{1}{2}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\nEvaluate the terms for $\\frac{\\partial g_t}{\\partial u_{y}^{B}}$ at the linearization point:\nFirst term: $\\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{t} = \\left(-\\frac{1}{2}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = 0$.\nSecond term: The relative position vector is $\\boldsymbol{x}_s - \\boldsymbol{x}_m = [0, -\\delta]^\\top - [0, 0]^\\top = [0, -\\delta]^\\top$.\n$$\n(\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{t}}{\\partial u_{y}^{B}} = \\begin{bmatrix} 0 \\\\ -\\delta \\end{bmatrix} \\cdot \\left(\\frac{1}{L}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) = -\\frac{\\delta}{L}\n$$\nSo, $\\frac{\\partial g_t}{\\partial u_{y}^{B}} = 0 - \\frac{\\delta}{L} = -\\frac{\\delta}{L}$.\nThe derivative of the tangential traction is $\\frac{\\partial t_t}{\\partial u_{y}^{B}} = k_t \\left(-\\frac{\\delta}{L}\\right) = -\\frac{k_t \\delta}{L}$.\nFinally, we assemble the stiffness entry for the stick case:\n$$\nK_{\\text{stick}} = \\frac{k_n \\delta}{L} - \\frac{k_t \\delta}{L} = \\frac{\\delta}{L}(k_n - k_t)\n$$\n\n### 2. Slip Regime ($K_{\\text{slip}}$)\nIn the slip regime, $t_t = -\\mu p_n s$. Differentiating with respect to $u_{y}^{B}$:\n$$\n\\frac{\\partial t_t}{\\partial u_{y}^{B}} = -\\mu s \\frac{\\partial p_n}{\\partial u_{y}^{B}}\n$$\nWe need to find the derivative of the normal pressure $p_n = k_n(-g_n)$:\n$$\n\\frac{\\partial p_n}{\\partial u_{y}^{B}} = -k_n \\frac{\\partial g_n}{\\partial u_{y}^{B}}\n$$\nThe normal gap is $g_n = (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\boldsymbol{n}$. Its derivative is:\n$$\n\\frac{\\partial g_n}{\\partial u_{y}^{B}} = \\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{n} + (\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}}\n$$\nEvaluate the terms for $\\frac{\\partial g_n}{\\partial u_{y}^{B}}$ at the linearization point:\nFirst term: $\\frac{\\partial (\\boldsymbol{x}_s - \\boldsymbol{x}_m)}{\\partial u_{y}^{B}} \\cdot \\boldsymbol{n} = \\left(-\\frac{1}{2}\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = -\\frac{1}{2}$.\nSecond term:\n$$\n(\\boldsymbol{x}_s - \\boldsymbol{x}_m) \\cdot \\frac{\\partial \\boldsymbol{n}}{\\partial u_{y}^{B}} = \\begin{bmatrix} 0 \\\\ -\\delta \\end{bmatrix} \\cdot \\left(\\frac{1}{L}\\begin{bmatrix} -1 \\\\ 0 \\end{bmatrix}\\right) = 0\n$$\nSo, $\\frac{\\partial g_n}{\\partial u_{y}^{B}} = -\\frac{1}{2} + 0 = -\\frac{1}{2}$.\nThe derivative of the normal pressure is $\\frac{\\partial p_n}{\\partial u_{y}^{B}} = -k_n \\left(-\\frac{1}{2}\\right) = \\frac{k_n}{2}$.\nThen, the derivative of the tangential traction is $\\frac{\\partial t_t}{\\partial u_{y}^{B}} = -\\mu s \\left(\\frac{k_n}{2}\\right) = -\\frac{\\mu s k_n}{2}$.\nFinally, we assemble the stiffness entry for the slip case:\n$$\nK_{\\text{slip}} = \\frac{k_n \\delta}{L} - \\frac{\\mu s k_n}{2}\n$$\n\n### 3. Change in Stiffness ($\\Delta K$)\nThe change in the tangent stiffness entry when transitioning from stick to slip is:\n$$\n\\Delta K = K_{\\text{slip}} - K_{\\text{stick}} = \\left(\\frac{k_n \\delta}{L} - \\frac{\\mu s k_n}{2}\\right) - \\left(\\frac{k_n \\delta}{L} - \\frac{k_t \\delta}{L}\\right)\n$$\n$$\n\\Delta K = \\frac{k_n \\delta}{L} - \\frac{\\mu s k_n}{2} - \\frac{k_n \\delta}{L} + \\frac{k_t \\delta}{L} = \\frac{k_t \\delta}{L} - \\frac{\\mu s k_n}{2}\n$$\n\n### 4. Numerical Calculation\nWe substitute the given numerical values into the expression for $\\Delta K$:\n$L=2\\,\\mathrm{m}$, $\\delta=1.0\\times 10^{-3}\\,\\mathrm{m}$, $k_{n}=1.0\\times 10^{6}\\,\\mathrm{N/m}$, $k_{t}=1.0\\times 10^{5}\\,\\mathrm{N/m}$, $\\mu=0.3$, and $s=1$.\n\nFirst term:\n$$\n\\frac{k_t \\delta}{L} = \\frac{(1.0 \\times 10^{5}\\,\\mathrm{N/m}) (1.0 \\times 10^{-3}\\,\\mathrm{m})}{2\\,\\mathrm{m}} = \\frac{100}{2}\\,\\mathrm{N/m} = 50\\,\\mathrm{N/m}\n$$\nSecond term:\n$$\n\\frac{\\mu s k_n}{2} = \\frac{(0.3)(1)(1.0 \\times 10^{6}\\,\\mathrm{N/m})}{2} = \\frac{3 \\times 10^{5}}{2}\\,\\mathrm{N/m} = 1.5 \\times 10^{5}\\,\\mathrm{N/m} = 150000\\,\\mathrm{N/m}\n$$\nThe change in stiffness is:\n$$\n\\Delta K = 50\\,\\mathrm{N/m} - 150000\\,\\mathrm{N/m} = -149950\\,\\mathrm{N/m}\n$$\nRounding this value to four significant figures:\n$$\n-149950 = -1.4995 \\times 10^5\n$$\nRounding the fourth significant digit (the second $9$) up due to the following digit being $5$, we get:\n$$\n\\Delta K \\approx -1.500 \\times 10^5\\,\\mathrm{N/m}\n$$",
            "answer": "$$\n\\boxed{-1.500 \\times 10^{5}}\n$$"
        }
    ]
}