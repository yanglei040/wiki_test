{
    "hands_on_practices": [
        {
            "introduction": "In the Finite Element Method, the principle of virtual work provides the foundation for transforming continuous physical problems into discrete algebraic systems. A key step in this process is handling natural boundary conditions, such as distributed forces or moments. This exercise  guides you through the process of calculating the work-equivalent nodal moments for a prescribed distributed bending moment on a plate edge, a fundamental skill for accurately modeling external loads in structural mechanics.",
            "id": "3563213",
            "problem": "A thin plate modeled under the Kirchhoff–Love hypothesis is discretized for the Finite Element Method (FEM). Consider a single straight edge of an element of length $L$, parameterized by the arc-length coordinate $s \\in [0, L]$ and mapped to the one-dimensional parent coordinate $\\xi \\in [-1, 1]$ by the affine relation $s = \\tfrac{L}{2}(\\xi + 1)$ with $ds = \\tfrac{L}{2}\\,d\\xi$. Along this edge, the bending moment per unit length about the tangent axis (the normal bending moment) is prescribed as $m_{n}(s) = m_{0} + m_{1}\\,s$, which constitutes a natural boundary condition in the weak form of the plate problem. The work-conjugate edge kinematic field is the edge rotation about the tangent axis, denoted $\\theta_{n}(s)$, which is interpolated with quadratic Lagrange shape functions associated with the three edge nodes at $\\xi = -1, 0, 1$:\n$$\nN_{1}(\\xi) = \\frac{\\xi(\\xi - 1)}{2}, \\qquad\nN_{2}(\\xi) = 1 - \\xi^{2}, \\qquad\nN_{3}(\\xi) = \\frac{\\xi(\\xi + 1)}{2}.\n$$\nUsing the Principle of Virtual Work as the fundamental starting point, derive the expression for the equivalent nodal moment vector along the edge, with nodal components corresponding to the degrees of freedom associated with $\\theta_{n}$ at $\\xi = -1, 0, 1$. Then evaluate the resulting edge integral by the $2$-point Gauss–Legendre quadrature with abscissae $\\xi = \\pm 1/\\sqrt{3}$ and weights $1$. Express your final answer symbolically in terms of $L$, $m_{0}$, and $m_{1}$. The equivalent nodal moments should be expressed in Newton–meter (N·m). No numerical substitution is required, and no rounding is needed. The final answer must be a single composite expression.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. All necessary information is provided, and the setup is consistent. The problem is a standard application of the Principle of Virtual Work within the context of the Finite Element Method for structural mechanics.\n\nThe derivation for the equivalent nodal moments begins with the Principle of Virtual Work. The external virtual work, $\\delta W_{\\text{ext}}$, done by the prescribed normal bending moment per unit length, $m_{n}(s)$, along the element edge is given by the integral of the moment multiplied by the corresponding virtual rotation, $\\delta\\theta_{n}(s)$:\n$$\n\\delta W_{\\text{ext}} = \\int_{s=0}^{s=L} m_{n}(s) \\delta\\theta_{n}(s) \\, ds\n$$\nIn the Finite Element Method, the kinematic field $\\theta_{n}(s)$ and its variation $\\delta\\theta_{n}(s)$ are interpolated from the nodal degrees of freedom using shape functions. Given the three nodes along the edge, the rotation $\\theta_{n}(s)$ is expressed as:\n$$\n\\theta_{n}(s) = \\sum_{i=1}^{3} N_{i}(\\xi(s)) \\theta_{ni}\n$$\nwhere $\\theta_{ni}$ are the nodal values of the rotation at nodes $i=1, 2, 3$ (corresponding to $\\xi = -1, 0, 1$). The virtual rotation is then:\n$$\n\\delta\\theta_{n}(s) = \\sum_{i=1}^{3} N_{i}(\\xi(s)) \\delta\\theta_{ni}\n$$\nSubstituting this into the virtual work expression:\n$$\n\\delta W_{\\text{ext}} = \\int_{s=0}^{s=L} m_{n}(s) \\left( \\sum_{i=1}^{3} N_{i}(\\xi(s)) \\delta\\theta_{ni} \\right) \\, ds\n$$\nSince the virtual nodal rotations $\\delta\\theta_{ni}$ are arbitrary constants with respect to the integration variable $s$, we can rearrange the expression:\n$$\n\\delta W_{\\text{ext}} = \\sum_{i=1}^{3} \\left( \\int_{s=0}^{s=L} m_{n}(s) N_{i}(\\xi(s)) \\, ds \\right) \\delta\\theta_{ni}\n$$\nThe external virtual work can also be expressed directly as the sum of the work done by the equivalent nodal moments, $M_i$, conjugate to the virtual nodal rotations $\\delta\\theta_{ni}$:\n$$\n\\delta W_{\\text{ext}} = \\sum_{i=1}^{3} M_{i} \\delta\\theta_{ni}\n$$\nBy comparing the two expressions for $\\delta W_{\\text{ext}}$, we identify the formula for the $i$-th equivalent nodal moment:\n$$\nM_{i} = \\int_{s=0}^{s=L} m_{n}(s) N_{i}(\\xi(s)) \\, ds\n$$\nTo evaluate this integral, we change the variable of integration from the arc-length coordinate $s$ to the parent coordinate $\\xi$. The problem provides the affine mapping $s = \\frac{L}{2}(\\xi + 1)$, which implies the differential relation $ds = \\frac{L}{2} d\\xi$. The integration limits $s \\in [0, L]$ map to $\\xi \\in [-1, 1]$. The distributed moment $m_{n}(s)$ must also be expressed in terms of $\\xi$:\n$$\nm_{n}(s(\\xi)) = m_{0} + m_{1}s(\\xi) = m_{0} + m_{1} \\frac{L}{2}(\\xi + 1)\n$$\nThe integral for $M_{i}$ becomes:\n$$\nM_{i} = \\int_{-1}^{1} \\left( m_{0} + m_{1} \\frac{L}{2}(\\xi + 1) \\right) N_{i}(\\xi) \\frac{L}{2} \\, d\\xi\n$$\nThe problem specifies that this integral is to be evaluated using $2$-point Gauss–Legendre quadrature. The formula for this numerical integration is:\n$$\n\\int_{-1}^{1} f(\\xi) \\, d\\xi \\approx \\sum_{j=1}^{2} w_{j} f(\\xi_{j})\n$$\nwith abscissae $\\xi_{1} = -1/\\sqrt{3}$, $\\xi_{2} = 1/\\sqrt{3}$ and weights $w_{1}=w_{2}=1$. The integrand for the $i$-th moment is $f_i(\\xi) = \\frac{L}{2} \\left[ m_{0} + m_{1} \\frac{L}{2}(\\xi + 1) \\right] N_{i}(\\xi)$. Thus, the nodal moments are approximated by:\n$$\nM_{i} \\approx f_i(-\\frac{1}{\\sqrt{3}}) + f_i(\\frac{1}{\\sqrt{3}})\n$$\nFirst, we evaluate the shape functions $N_i(\\xi)$ and the distributed moment $m_n(\\xi)$ at the Gauss points $\\xi = \\pm 1/\\sqrt{3}$.\n\nShape functions at Gauss points:\n$N_{1}(\\xi) = \\frac{\\xi(\\xi-1)}{2} \\implies N_{1}(-\\frac{1}{\\sqrt{3}}) = \\frac{1}{6} + \\frac{1}{2\\sqrt{3}}, \\quad N_{1}(\\frac{1}{\\sqrt{3}}) = \\frac{1}{6} - \\frac{1}{2\\sqrt{3}}$\n$N_{2}(\\xi) = 1 - \\xi^{2} \\implies N_{2}(-\\frac{1}{\\sqrt{3}}) = \\frac{2}{3}, \\quad N_{2}(\\frac{1}{\\sqrt{3}}) = \\frac{2}{3}$\n$N_{3}(\\xi) = \\frac{\\xi(\\xi+1)}{2} \\implies N_{3}(-\\frac{1}{\\sqrt{3}}) = \\frac{1}{6} - \\frac{1}{2\\sqrt{3}}, \\quad N_{3}(\\frac{1}{\\sqrt{3}}) = \\frac{1}{6} + \\frac{1}{2\\sqrt{3}}$\n\nDistributed moment at Gauss points:\n$m_n(\\xi) = m_{0} + m_{1} \\frac{L}{2}(\\xi + 1)$\n$m_n(-\\frac{1}{\\sqrt{3}}) = m_{0} + m_{1} \\frac{L}{2}(1 - \\frac{1}{\\sqrt{3}})$\n$m_n(\\frac{1}{\\sqrt{3}}) = m_{0} + m_{1} \\frac{L}{2}(1 + \\frac{1}{\\sqrt{3}})$\n\nNow we compute each nodal moment $M_i$:\n$M_i \\approx \\frac{L}{2} \\left[ m_n(-\\frac{1}{\\sqrt{3}}) N_i(-\\frac{1}{\\sqrt{3}}) + m_n(\\frac{1}{\\sqrt{3}}) N_i(\\frac{1}{\\sqrt{3}}) \\right]$\n\nFor $M_1$:\n$M_1 \\approx \\frac{L}{2} \\left[ \\left(m_{0} + \\frac{m_{1}L}{2} - \\frac{m_{1}L}{2\\sqrt{3}}\\right) \\left(\\frac{1}{6} + \\frac{1}{2\\sqrt{3}}\\right) + \\left(m_{0} + \\frac{m_{1}L}{2} + \\frac{m_{1}L}{2\\sqrt{3}}\\right) \\left(\\frac{1}{6} - \\frac{1}{2\\sqrt{3}}\\right) \\right]$\nLet $A = m_0 + \\frac{m_1L}{2}$, $B = \\frac{m_1L}{2\\sqrt{3}}$, $C = \\frac{1}{6}$, $D = \\frac{1}{2\\sqrt{3}}$. The expression is $\\frac{L}{2}[(A-B)(C+D) + (A+B)(C-D)] = \\frac{L}{2}[2AC - 2BD] = L(AC-BD)$.\n$AC = (m_0 + \\frac{m_1L}{2})\\frac{1}{6} = \\frac{m_0}{6} + \\frac{m_1L}{12}$.\n$BD = (\\frac{m_1L}{2\\sqrt{3}})(\\frac{1}{2\\sqrt{3}}) = \\frac{m_1L}{12}$.\n$M_1 = L \\left( \\frac{m_0}{6} + \\frac{m_1L}{12} - \\frac{m_1L}{12} \\right) = \\frac{m_0L}{6}$.\n\nFor $M_2$:\n$N_2$ is constant at both Gauss points, $N_2(\\pm\\frac{1}{\\sqrt{3}}) = 2/3$.\n$M_2 \\approx \\frac{L}{2} \\cdot \\frac{2}{3} \\left[ m_n(-\\frac{1}{\\sqrt{3}}) + m_n(\\frac{1}{\\sqrt{3}}) \\right] = \\frac{L}{3} \\left[ \\left(m_0 + \\frac{m_1L}{2} - \\frac{m_1L}{2\\sqrt{3}}\\right) + \\left(m_0 + \\frac{m_1L}{2} + \\frac{m_1L}{2\\sqrt{3}}\\right) \\right]$\n$M_2 \\approx \\frac{L}{3} \\left[ 2m_0 + m_1L \\right] = \\frac{2m_0L}{3} + \\frac{m_1L^2}{3}$.\n\nFor $M_3$:\nThe expression is $\\frac{L}{2}[(A-B)(C-D) + (A+B)(C+D)] = \\frac{L}{2}[2AC + 2BD] = L(AC+BD)$.\n$M_3 = L \\left( (\\frac{m_0}{6} + \\frac{m_1L}{12}) + \\frac{m_1L}{12} \\right) = L \\left( \\frac{m_0}{6} + \\frac{m_1L}{6} \\right) = \\frac{m_0L}{6} + \\frac{m_1L^2}{6}$.\n\nThe integrand is a polynomial of degree $3$ in $\\xi$, and $2$-point Gauss quadrature is exact for polynomials up to degree $2(2)-1=3$. Therefore, the results are exact and not approximations.\nThe components of the equivalent nodal moment vector are:\n$M_{1} = \\frac{m_{0}L}{6}$\n$M_{2} = \\frac{2m_{0}L}{3} + \\frac{m_{1}L^{2}}{3} = \\frac{2m_{0}L + m_{1}L^{2}}{3}$\n$M_{3} = \\frac{m_{0}L}{6} + \\frac{m_{1}L^{2}}{6} = \\frac{m_{0}L + m_{1}L^{2}}{6}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{m_{0}L}{6} & \\frac{2m_{0}L + m_{1}L^{2}}{3} & \\frac{m_{0}L + m_{1}L^{2}}{6} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While natural boundary conditions arise naturally from the weak form, essential (or Dirichlet) boundary conditions, which prescribe displacements, require specific enforcement techniques. This computational practice  contrasts two common approaches: the \"strong\" method of direct elimination and the \"weak\" penalty method. By implementing both for a simple bar problem, you will gain practical insight into how reaction forces are computed and how the penalty method's accuracy depends on the chosen penalty parameter.",
            "id": "3563196",
            "problem": "Consider a one-dimensional, linearly elastic bar of length $L$ with constant cross-sectional area $A$ and Young's modulus $E$. Let $x \\in [0,L]$ denote the axial coordinate. The unknown displacement field is $u(x)$ (in meters). The bar is subjected to a uniform body force density $b$ (in newtons per meter) and an end force $F$ (in newtons) applied at $x=L$. The axial strain is $\\varepsilon(x) = u'(x)$ and the axial stress is $\\sigma(x) = E \\varepsilon(x)$. The product $EA$ (in newtons) is the axial stiffness of the bar.\n\nWe study two ways to enforce an essential (Dirichlet) boundary condition at $x=0$ of the form $u(0) = \\bar{u}$, where $\\bar{u}$ is a prescribed displacement in meters:\n- Strong enforcement: the Dirichlet condition is imposed exactly on the discrete displacement at the first node.\n- Weak (penalty) enforcement: the Dirichlet condition is enforced by augmenting the discrete system with a penalty term of magnitude $\\gamma$ (in newtons per meter), which penalizes deviations of $u(0)$ from $\\bar{u}$.\n\nThe natural (Neumann) boundary condition at $x=L$ is the applied end force $F$ (in newtons). The body force density $b$ contributes to the distributed loading along the bar. The governing weak form is built upon the Principle of Virtual Work: the internal virtual work equals the external virtual work for all kinematically admissible virtual displacements.\n\nYour tasks:\n1. Using the Finite Element Method (FEM), discretize the bar into $n$ equal linear elements with nodes $x_i = i h$ for $i=0,\\dots,n$, where $h = L/n$ is the element length. Assemble the global stiffness matrix $K \\in \\mathbb{R}^{(n+1) \\times (n+1)}$ and load vector $f \\in \\mathbb{R}^{n+1}$ using the standard linear-element formulas:\n   - Element stiffness matrix $k_e = \\dfrac{EA}{h} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$ for each element.\n   - Consistent element load vector due to the uniform body force $f_e = \\dfrac{b h}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$ for each element.\n   - End force $F$ is added to the last node: $f_{n} \\leftarrow f_{n} + F$.\n2. Strong enforcement of $u(0) = \\bar{u}$: eliminate the first degree of freedom in the linear system to solve for the remaining unknowns, then build the full displacement vector $u^{\\star}$ with $u^{\\star}_0 = \\bar{u}$. Define the reaction force at $x=0$ as the internal nodal force that equilibrates the external loads at the first node:\n   $$ r_{\\infty} := \\left( K u^{\\star} - f \\right)_0 \\quad \\text{in newtons.} $$\n3. Penalty enforcement of $u(0) = \\bar{u}$: form the penalized system\n   $$ (K + \\gamma e_0 e_0^{\\top}) u_{\\gamma} = f + \\gamma \\bar{u} \\, e_0, $$\n   where $e_0 \\in \\mathbb{R}^{n+1}$ is the unit vector with a $1$ in the first entry and zeros elsewhere, and $\\gamma > 0$ is the penalty parameter. Solve for $u_{\\gamma}$, and define the penalty reaction as\n   $$ r_{\\gamma} := \\gamma \\left( \\bar{u} - u_{\\gamma,0} \\right) \\quad \\text{in newtons,} $$\n   where $u_{\\gamma,0}$ is the first component of $u_{\\gamma}$. Also define the Dirichlet violation magnitude\n   $$ v_{\\gamma} := \\left| u_{\\gamma,0} - \\bar{u} \\right| \\quad \\text{in meters.} $$\n4. Demonstrate the consistency of the reaction computation by comparing $r_{\\gamma}$ with $r_{\\infty}$. Specifically, for each test case, compute the absolute reaction error\n   $$ e_{\\gamma} := \\left| r_{\\gamma} - r_{\\infty} \\right| \\quad \\text{in newtons} $$\n   and the Dirichlet violation $v_{\\gamma}$ (in meters).\n\nThe program must implement the above for the following test suite of parameter sets. Each test case is a tuple $(L, E, A, n, F, b, \\bar{u}, \\gamma)$, with units as specified:\n- Test 1 (happy path, small penalty): $(1.0 \\text{ m}, 210\\times 10^{9} \\text{ Pa}, 1.0\\times 10^{-4} \\text{ m}^2, 20, 1000 \\text{ N}, 0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{3} \\text{ N/m})$.\n- Test 2 (happy path, moderate penalty): $(1.0 \\text{ m}, 210\\times 10^{9} \\text{ Pa}, 1.0\\times 10^{-4} \\text{ m}^2, 20, 1000 \\text{ N}, 0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{6} \\text{ N/m})$.\n- Test 3 (limit behavior, very large penalty): $(1.0 \\text{ m}, 210\\times 10^{9} \\text{ Pa}, 1.0\\times 10^{-4} \\text{ m}^2, 20, 1000 \\text{ N}, 0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{12} \\text{ N/m})$.\n- Test 4 (with body force): $(1.0 \\text{ m}, 70\\times 10^{9} \\text{ Pa}, 5.0\\times 10^{-5} \\text{ m}^2, 30, 500 \\text{ N}, 200 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{6} \\text{ N/m})$.\n- Test 5 (soft bar): $(1.0 \\text{ m}, 1.0\\times 10^{6} \\text{ Pa}, 1.0\\times 10^{-6} \\text{ m}^2, 10, 1.0 \\text{ N}, 1.0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{6} \\text{ N/m})$.\n\nExpress all reaction forces in newtons and all displacements in meters. Angles are not involved. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, append four numbers in order: $r_{\\infty}$, $r_{\\gamma}$, $e_{\\gamma}$, $v_{\\gamma}$. Thus, the final output is a flat list of $20$ numbers corresponding to the $5$ test cases.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It presents a standard application of the Finite Element Method (FEM) to a one-dimensional linear elasticity problem, a fundamental topic in computational solid mechanics. The provided physical parameters, governing equations, element formulations, and definitions for boundary condition enforcement (strong and penalty methods) are all consistent with established theory. The problem is self-contained, with all necessary data provided for each test case. Therefore, a complete and reasoned solution can be constructed.\n\nThe solution proceeds in four stages:\n1.  Discretization of the continuous problem and assembly of the global system of linear equations.\n2.  Imposition of the essential boundary condition using the strong (elimination) method and computation of the reaction force.\n3.  Imposition of the essential boundary condition using the weak (penalty) method and computation of the approximate reaction force and boundary displacement violation.\n4.  Comparison of the reaction forces obtained from both methods.\n\n**1. Finite Element Discretization and Assembly**\n\nThe one-dimensional domain of length $L$, $x \\in [0, L]$, is discretized into $n$ linear finite elements of equal length $h = L/n$. This creates $n+1$ nodes, located at positions $x_i = i h$ for $i=0, 1, \\dots, n$. The displacement field $u(x)$ is approximated as a piecewise linear function over these elements. The unknown nodal displacements are collected in a vector $u \\in \\mathbb{R}^{n+1}$.\n\nThe principle of virtual work leads to a system of linear equations, $K u = f$, where $K$ is the global stiffness matrix and $f$ is the global load vector. These are assembled from element-level contributions.\n\nFor each element $e$ (connecting local nodes $0$ and $1$, corresponding to global nodes $i$ and $i+1$), the element stiffness matrix $k_e$ is given by:\n$$\nk_e = \\frac{EA}{h} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}\n$$\nwhere $E$ is Young's modulus, $A$ is the cross-sectional area, and $h$ is the element length.\n\nThe consistent element load vector $f_e$ due to a uniform body force $b$ is:\n$$\nf_e = \\frac{b h}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n\nThe global stiffness matrix $K \\in \\mathbb{R}^{(n+1) \\times (n+1)}$ and load vector $f \\in \\mathbb{R}^{n+1}$ are initialized as zero matrices. Then, for each element $e$ spanning global nodes $i$ and $i+1$ (for $i=0, \\dots, n-1$), the entries of $k_e$ and $f_e$ are added to the corresponding locations in $K$ and $f$. This is the standard \"assembly\" process. For instance, $K_{i,i}$ receives contributions from elements $i-1$ and $i$.\n\nFinally, the external point load $F$ at $x=L$ (node $n$) is added to the last component of the global load vector: $f_n \\leftarrow f_n + F$.\n\n**2. Strong Enforcement of the Essential Boundary Condition**\n\nThe essential (Dirichlet) boundary condition is $u(0) = \\bar{u}$. In the discrete system, this corresponds to setting the displacement of the first node to the prescribed value: $u_0 = \\bar{u}$. This is \"strong\" enforcement because the condition is satisfied exactly.\n\nThe global system $K u = f$ can be partitioned based on known and unknown degrees of freedom (DOFs). Here, $u_0$ is known, and the remaining displacements $u_R = [u_1, u_2, \\dots, u_n]^\\top$ are unknown.\n$$\n\\begin{bmatrix}\nK_{00} & K_{0R} \\\\\nK_{R0} & K_{RR}\n\\end{bmatrix}\n\\begin{Bmatrix}\nu_0 \\\\\nu_R\n\\end{Bmatrix}\n=\n\\begin{Bmatrix}\nf_0 \\\\\nf_R\n\\end{Bmatrix}\n$$\nFrom the second row of this block system, we can solve for the unknown displacements $u_R$:\n$$\nK_{R0} u_0 + K_{RR} u_R = f_R \\implies K_{RR} u_R = f_R - K_{R0} u_0\n$$\nSince $u_0 = \\bar{u}$ is known, we solve the reduced system of size $n \\times n$ for $u_R$. Let this solution be $u_R^{\\star}$. The full displacement vector, denoted $u^{\\star}$, is then constructed by combining the prescribed and computed values: $u^{\\star} = [\\bar{u}, (u_R^{\\star})^\\top]^\\top$.\n\nThe reaction force at the constrained node ($x=0$) is the force required to maintain the prescribed displacement. It is computed from the first row of the original system *after* solving for all displacements:\n$$\nr_{\\infty} := (K u^{\\star} - f)_0 = K_{00} u^{\\star}_0 + K_{0R} u^{\\star}_R - f_0\n$$\nThe subscript $\\infty$ conceptually denotes that this is the exact reaction, corresponding to an infinite penalty parameter.\n\n**3. Penalty Enforcement of the Essential Boundary Condition**\n\nThe penalty method enforces the boundary condition $u_0 = \\bar{u}$ in an approximate, \"weak\" sense. The idea is to add a large \"spring\" with stiffness $\\gamma$ to the system at node $0$, which pulls the node towards the position $\\bar{u}$. This is mathematically achieved by augmenting the potential energy functional with a penalty term $\\frac{1}{2}\\gamma(u_0 - \\bar{u})^2$.\n\nThis modification leads to a modified linear system:\n$$\nK_{\\gamma} u_{\\gamma} = f_{\\gamma}\n$$\nwhere $K_{\\gamma}$ and $f_{\\gamma}$ are the penalized stiffness matrix and load vector, respectively. They are formed by modifying the original system at the DOF corresponding to the boundary condition (index $0$):\n$$\nK_{\\gamma} = K + \\gamma e_0 e_0^{\\top} \\quad \\text{(i.e., } K_{\\gamma,00} = K_{00} + \\gamma \\text{)}\n$$\n$$\nf_{\\gamma} = f + \\gamma \\bar{u} \\, e_0 \\quad \\text{(i.e., } f_{\\gamma,0} = f_0 + \\gamma \\bar{u} \\text{)}\n$$\nHere, $e_0$ is the standard basis vector with a $1$ at index $0$ and zeros elsewhere. This modified $(n+1) \\times (n+1)$ system is non-singular (if the original reduced system was) and can be solved directly for the full displacement vector $u_{\\gamma}$.\n\nThe first equation of the penalized system is $(K_{00} + \\gamma) u_{\\gamma,0} + \\sum_{j=1}^{n} K_{0j} u_{\\gamma,j} = f_0 + \\gamma \\bar{u}$. Rearranging gives $\\gamma (\\bar{u} - u_{\\gamma,0}) = \\sum_{j=0}^{n} K_{0j} u_{\\gamma,j} - f_0$, where the right-hand side represents the internal nodal force. This motivates the definition of the penalty reaction force:\n$$\nr_{\\gamma} := \\gamma \\left( \\bar{u} - u_{\\gamma,0} \\right)\n$$\nUnlike strong enforcement, the computed displacement $u_{\\gamma,0}$ will not be exactly equal to $\\bar{u}$. The magnitude of this discrepancy is the Dirichlet violation:\n$$\nv_{\\gamma} := \\left| u_{\\gamma,0} - \\bar{u} \\right|\n$$\nAs the penalty parameter $\\gamma \\to \\infty$, it can be shown that $u_{\\gamma} \\to u^{\\star}$ and $r_{\\gamma} \\to r_{\\infty}$.\n\n**4. Error Analysis**\n\nTo demonstrate the convergence of the penalty method to the strong solution, we compute the absolute error between the reaction forces:\n$$\ne_{\\gamma} := \\left| r_{\\gamma} - r_{\\infty} \\right|\n$$\nThe provided test cases explore how the choice of the penalty parameter $\\gamma$ affects the accuracy of the computed reaction force (measured by $e_{\\gamma}$) and the satisfaction of the essential boundary condition (measured by $v_{\\gamma}$). A larger $\\gamma$ generally leads to smaller values for both $v_{\\gamma}$ and $e_{\\gamma}$, but can lead to numerical ill-conditioning if it is excessively large compared to the diagonal entries of $K$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a 1D linear elastic bar problem using FEM with both strong and penalty\n    enforcement of Dirichlet boundary conditions and compares the results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, E, A, n, F, b, u_bar, gamma)\n    test_cases = [\n        # (L, E, A, n, F, b, u_bar, gamma)\n        (1.0, 210e9, 1.0e-4, 20, 1000.0, 0.0, 0.0, 1.0e3),\n        (1.0, 210e9, 1.0e-4, 20, 1000.0, 0.0, 0.0, 1.0e6),\n        (1.0, 210e9, 1.0e-4, 20, 1000.0, 0.0, 0.0, 1.0e12),\n        (1.0, 70e9, 5.0e-5, 30, 500.0, 200.0, 0.0, 1.0e6),\n        (1.0, 1.0e6, 1.0e-6, 10, 1.0, 1.0, 0.0, 1.0e6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, E, A, n, F, b, u_bar, gamma = case\n\n        # 1. Discretization and Assembly\n        h = L / n\n        n_nodes = n + 1\n        \n        # Initialize global stiffness matrix and load vector\n        K_global = np.zeros((n_nodes, n_nodes))\n        f_global = np.zeros(n_nodes)\n        \n        # Element properties\n        axial_stiffness = E * A\n        k_elem_val = axial_stiffness / h\n        k_elem = k_elem_val * np.array([[1, -1], [-1, 1]])\n        \n        f_elem_val = b * h / 2\n        f_elem = f_elem_val * np.array([1, 1])\n\n        # Assembly loop\n        for i in range(n):\n            # Global node indices for element i\n            nodes = [i, i + 1]\n            # Add element contributions to global system\n            K_global[np.ix_(nodes, nodes)] += k_elem\n            f_global[nodes] += f_elem\n            \n        # Apply natural boundary condition (point force F at x=L)\n        f_global[n] += F\n\n        # 2. Strong Enforcement\n        # Partition the system: K u = f\n        K_RR = K_global[1:, 1:]\n        f_R = f_global[1:]\n        K_R0 = K_global[1:, 0]\n\n        # Solve for unknown displacements: K_RR * u_R = f_R - K_R0 * u_bar\n        rhs_strong = f_R - K_R0 * u_bar\n        u_R_star = np.linalg.solve(K_RR, rhs_strong)\n        \n        # Reconstruct the full displacement vector\n        u_star = np.concatenate(([u_bar], u_R_star))\n\n        # Calculate reaction force r_inf = (K*u_star - f)[0]\n        r_inf = (K_global @ u_star - f_global)[0]\n\n        # 3. Penalty Enforcement\n        # Form the penalized system\n        K_penalty = K_global.copy()\n        K_penalty[0, 0] += gamma\n        \n        f_penalty = f_global.copy()\n        f_penalty[0] += gamma * u_bar\n        \n        # Solve for displacements u_gamma\n        u_gamma = np.linalg.solve(K_penalty, f_penalty)\n        u_gamma_0 = u_gamma[0]\n\n        # Calculate penalty reaction r_gamma\n        r_gamma = gamma * (u_bar - u_gamma_0)\n        \n        # Calculate Dirichlet violation v_gamma\n        v_gamma = np.abs(u_gamma_0 - u_bar)\n\n        # 4. Comparison\n        # Calculate absolute reaction error e_gamma\n        e_gamma = np.abs(r_gamma - r_inf)\n        \n        # Append results for this test case\n        results.extend([r_inf, r_gamma, e_gamma, v_gamma])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.8e}' for x in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The penalty method, explored in the previous practice, offers great implementation simplicity, but this convenience comes at a numerical cost. This exercise  delves into the theoretical underpinnings of this trade-off by analyzing the effect of the penalty parameter $\\alpha$ on the conditioning of the system's stiffness matrix. Deriving the asymptotic growth of the condition number will reveal why choosing an excessively large penalty parameter can lead to numerical instability and inaccurate results.",
            "id": "3563169",
            "problem": "Consider a one-dimensional, prismatic, linearly elastic bar of length $h$, Young’s modulus $E$, and unit cross-sectional area, occupying the interval $x \\in [0,h]$. The displacement $u(x)$ is governed by equilibrium derived from the Principle of Virtual Work, with the symmetric bilinear form\n$$\na(u,v) \\;=\\; \\int_{0}^{h} E \\, u'(x)\\, v'(x)\\, dx \\;+\\; \\alpha\\, u(0)\\, v(0),\n$$\nand the linear functional of external work set to zero. The term with $\\alpha > 0$ penalizes violation of the essential boundary condition $u(0)=0$ by modeling a very stiff spring attached at $x=0$, while the right end $x=h$ is stress-free, which is a natural boundary condition.\n\nDiscretize the bar using the standard two-node linear finite element with nodal displacements $u_1 \\approx u(0)$ and $u_2 \\approx u(h)$. Using the definition of the bilinear form, assemble the discrete $2 \\times 2$ stiffness matrix corresponding to the quadratic form $a(\\cdot,\\cdot)$, and observe how the penalty stiffness $\\alpha$ enters the algebraic system. Denote the resulting matrix by $K(\\alpha,E,h)$, and define its condition number in the Euclidean norm (the spectral condition number) as\n$$\n\\kappa_2\\big(K(\\alpha,E,h)\\big) \\;=\\; \\frac{\\lambda_{\\max}\\big(K(\\alpha,E,h)\\big)}{\\lambda_{\\min}\\big(K(\\alpha,E,h)\\big)},\n$$\nwhere $\\lambda_{\\max}$ and $\\lambda_{\\min}$ are the largest and smallest eigenvalues, respectively. Starting from first principles and without assuming any pre-existing formulas for eigenvalues or condition numbers, derive an exact analytic expression for the two eigenvalues of $K(\\alpha,E,h)$, and then obtain the leading-order asymptotic expression as $\\alpha \\to \\infty$ with $E$ and $h$ held fixed.\n\nYour final answer must be the leading-order asymptotic expression for the condition number growth as a closed-form function of $\\alpha$, $E$, and $h$. Do not include any units in your final answer. The condition number is dimensionless.",
            "solution": "The problem statement has been validated and is determined to be valid. It is scientifically grounded, well-posed, objective, and contains no contradictions or ambiguities. We may proceed with the solution.\n\nThe problem asks for the derivation of the leading-order asymptotic expression for the condition number of a stiffness matrix for a one-dimensional bar element, where an essential boundary condition is enforced using a penalty method.\n\nFirst, we discretize the displacement field $u(x)$ over the domain $x \\in [0, h]$ using a two-node linear finite element. The nodes are located at $x=0$ and $x=h$. The nodal displacements are denoted by $u_1$ and $u_2$, respectively. The interpolated displacement field is given by\n$$u(x) = N_1(x) u_1 + N_2(x) u_2,$$\nwhere $N_1(x)$ and $N_2(x)$ are the linear shape functions. For an element of length $h$ defined on $[0, h]$, these are:\n$$N_1(x) = 1 - \\frac{x}{h}$$\n$$N_2(x) = \\frac{x}{h}$$\nThe derivatives of the shape functions with respect to $x$ are constants:\n$$N_1'(x) = -\\frac{1}{h}$$\n$$N_2'(x) = \\frac{1}{h}$$\n\nThe stiffness matrix $K$ is a $2 \\times 2$ matrix whose components $K_{ij}$ are defined by the given symmetric bilinear form $a(\\cdot,\\cdot)$ applied to the basis functions: $K_{ij} = a(N_j, N_i)$.\nThe bilinear form is\n$$a(u,v) = \\int_{0}^{h} E \\, u'(x)\\, v'(x)\\, dx \\;+\\; \\alpha\\, u(0)\\, v(0).$$\nWe compute the four components of the stiffness matrix $K(\\alpha, E, h)$.\n\nFor $K_{11}$:\n$$K_{11} = a(N_1, N_1) = \\int_{0}^{h} E \\, (N_1'(x))^2 \\, dx + \\alpha \\, N_1(0) \\, N_1(0).$$\nAt $x=0$, we have $N_1(0)=1$ and $N_2(0)=0$.\n$$K_{11} = \\int_{0}^{h} E \\left(-\\frac{1}{h}\\right)^2 dx + \\alpha (1)(1) = \\frac{E}{h^2} \\int_{0}^{h} dx + \\alpha = \\frac{E}{h^2} [x]_0^h + \\alpha = \\frac{E}{h} + \\alpha.$$\n\nFor $K_{12}$:\n$$K_{12} = a(N_2, N_1) = \\int_{0}^{h} E \\, N_2'(x) \\, N_1'(x) \\, dx + \\alpha \\, N_2(0) \\, N_1(0).$$\n$$K_{12} = \\int_{0}^{h} E \\left(\\frac{1}{h}\\right) \\left(-\\frac{1}{h}\\right) dx + \\alpha (0)(1) = -\\frac{E}{h^2} \\int_{0}^{h} dx = -\\frac{E}{h}.$$\n\nFor $K_{21}$:\nSince the bilinear form is symmetric, $K_{21} = a(N_1, N_2) = K_{12} = -E/h$.\n\nFor $K_{22}$:\n$$K_{22} = a(N_2, N_2) = \\int_{0}^{h} E \\, (N_2'(x))^2 \\, dx + \\alpha \\, N_2(0) \\, N_2(0).$$\n$$K_{22} = \\int_{0}^{h} E \\left(\\frac{1}{h}\\right)^2 dx + \\alpha (0)(0) = \\frac{E}{h^2} \\int_{0}^{h} dx = \\frac{E}{h}.$$\n\nAssembling these components, the stiffness matrix is:\n$$K(\\alpha, E, h) = \\begin{pmatrix} \\frac{E}{h} + \\alpha & -\\frac{E}{h} \\\\ -\\frac{E}{h} & \\frac{E}{h} \\end{pmatrix}.$$\nThe natural boundary condition of a stress-free end at $x=h$ is satisfied implicitly by setting the corresponding component of the force vector to zero, which is consistent with the problem statement that the linear functional of external work is zero.\n\nNext, we find the eigenvalues $\\lambda$ of $K$. The eigenvalues are the roots of the characteristic equation $\\det(K - \\lambda I) = 0$, where $I$ is the identity matrix.\n$$\\det \\begin{pmatrix} \\frac{E}{h} + \\alpha - \\lambda & -\\frac{E}{h} \\\\ -\\frac{E}{h} & \\frac{E}{h} - \\lambda \\end{pmatrix} = 0.$$\nExpanding the determinant gives the characteristic polynomial:\n$$\\left(\\frac{E}{h} + \\alpha - \\lambda\\right)\\left(\\frac{E}{h} - \\lambda\\right) - \\left(-\\frac{E}{h}\\right)^2 = 0$$\n$$\\left(\\frac{E}{h}\\right)^2 - \\frac{E}{h}\\lambda + \\alpha\\frac{E}{h} - \\alpha\\lambda - \\frac{E}{h}\\lambda + \\lambda^2 - \\left(\\frac{E}{h}\\right)^2 = 0$$\n$$\\lambda^2 - \\left(2\\frac{E}{h} + \\alpha\\right)\\lambda + \\alpha\\frac{E}{h} = 0.$$\nThis is a quadratic equation for $\\lambda$. We solve for $\\lambda$ using the quadratic formula:\n$$\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a},$$\nwith $a=1$, $b = -(2E/h + \\alpha)$, and $c = \\alpha E/h$.\n$$\\lambda = \\frac{ (2\\frac{E}{h} + \\alpha) \\pm \\sqrt{\\left(2\\frac{E}{h} + \\alpha\\right)^2 - 4(1)\\left(\\alpha\\frac{E}{h}\\right)} }{2}.$$\nLet's simplify the term under the square root (the discriminant):\n$$\\left(2\\frac{E}{h} + \\alpha\\right)^2 - 4\\alpha\\frac{E}{h} = \\left(4\\left(\\frac{E}{h}\\right)^2 + 4\\alpha\\frac{E}{h} + \\alpha^2\\right) - 4\\alpha\\frac{E}{h} = 4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2.$$\nSo, the exact eigenvalues are:\n$$\\lambda = \\frac{1}{2} \\left[ \\left(2\\frac{E}{h} + \\alpha\\right) \\pm \\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} \\right].$$\nThe largest and smallest eigenvalues are:\n$$\\lambda_{\\max} = \\frac{1}{2} \\left[ \\left(2\\frac{E}{h} + \\alpha\\right) + \\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} \\right]$$\n$$\\lambda_{\\min} = \\frac{1}{2} \\left[ \\left(2\\frac{E}{h} + \\alpha\\right) - \\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} \\right].$$\n\nNow, we find the leading-order asymptotic expressions for these eigenvalues as $\\alpha \\to \\infty$. We analyze the square root term by factoring out $\\alpha$:\n$$\\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} = \\alpha \\sqrt{1 + 4\\left(\\frac{E}{h\\alpha}\\right)^2}.$$\nUsing the Taylor expansion $\\sqrt{1+x} = 1 + \\frac{1}{2}x + O(x^2)$ for small $x$, where $x = 4(E/(h\\alpha))^2 \\to 0$ as $\\alpha \\to \\infty$:\n$$\\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} = \\alpha \\left[ 1 + \\frac{1}{2} \\left(4\\left(\\frac{E}{h\\alpha}\\right)^2\\right) + O(\\alpha^{-4}) \\right] = \\alpha \\left[ 1 + 2\\frac{E^2}{h^2\\alpha^2} + O(\\alpha^{-4}) \\right] = \\alpha + \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3}).$$\n\nSubstitute this expansion back into the expressions for the eigenvalues.\nFor $\\lambda_{\\max}$:\n$$\\lambda_{\\max} = \\frac{1}{2} \\left[ 2\\frac{E}{h} + \\alpha + \\left(\\alpha + \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3})\\right) \\right] = \\frac{1}{2} \\left[ 2\\alpha + 2\\frac{E}{h} + O(\\alpha^{-1}) \\right] = \\alpha + \\frac{E}{h} + O(\\alpha^{-1}).$$\nThe leading-order term for $\\lambda_{\\max}$ is $\\alpha$.\n\nFor $\\lambda_{\\min}$:\n$$\\lambda_{\\min} = \\frac{1}{2} \\left[ 2\\frac{E}{h} + \\alpha - \\left(\\alpha + \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3})\\right) \\right] = \\frac{1}{2} \\left[ 2\\frac{E}{h} - \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3}) \\right] = \\frac{E}{h} - \\frac{E^2}{h^2\\alpha} + O(\\alpha^{-3}).$$\nThe leading-order term for $\\lambda_{\\min}$ is a constant, $E/h$.\n\nThe condition number $\\kappa_2$ is the ratio of the largest to the smallest eigenvalue:\n$$\\kappa_2(K(\\alpha,E,h)) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{\\alpha + \\frac{E}{h} + O(\\alpha^{-1})}{\\frac{E}{h} - \\frac{E^2}{h^2\\alpha} + O(\\alpha^{-3})}.$$\nTo find the leading-order asymptotic expression for the growth of $\\kappa_2$ as $\\alpha \\to \\infty$, we take the ratio of the leading-order terms of the numerator and the denominator:\n$$\\kappa_2 \\sim \\frac{\\alpha}{E/h} \\quad \\text{as } \\alpha \\to \\infty.$$\nThus, the leading-order asymptotic expression is:\n$$\\kappa_2 \\sim \\frac{\\alpha h}{E}.$$\nThis result shows that the condition number grows linearly with the penalty parameter $\\alpha$, which is a characteristic feature of ill-conditioning in penalty-based finite element methods.",
            "answer": "$$\\boxed{\\frac{\\alpha h}{E}}$$"
        }
    ]
}