{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个练习是一个经典的入门问题，旨在帮助你掌握瑞利-里兹法的基本流程。我们将通过应用一个简单的抛物线试函数来近似计算两端固定杆的基频，从而将一个连续体动力学问题简化为一个单自由度振动系统。通过这个练习，你将亲手体验如何从能量泛函出发，推导出广义质量和广义刚度，并最终估算系统的固有频率。",
            "id": "3593572",
            "problem": "考虑一根长度为 $L$、恒定横截面积为 $A$、质量密度为 $\\rho$、杨氏模量为 $E$ 的均匀直棱柱杆的小振幅纵向振动。该杆两端固定，因此本质边界条件为 $u(0,t)=0$ 和 $u(L,t)=0$，其中 $u(x,t)$ 是轴向位移场。应变能泛函为 $U=\\frac{1}{2}\\int_{0}^{L}E A \\left(\\frac{\\partial u}{\\partial x}\\right)^{2}\\,\\mathrm{d}x$，动能泛函为 $T=\\frac{1}{2}\\int_{0}^{L}\\rho A \\left(\\frac{\\partial u}{\\partial t}\\right)^{2}\\,\\mathrm{d}x$，这与线性弹性力学和一维弹性动力学一致。\n\n使用瑞利-里兹法（RRM），通过单个广义坐标 $q(t)$ 和一个满足本质边界条件的容许试探形函数来近似位移场：\n$$\nu(x,t)=q(t)\\,\\phi(x),\\quad \\phi(x)=x\\,(L-x).\n$$\n从上述能量泛函和假设的 $u(x,t)$ 出发，推导通过瑞利-里兹过程得到的标量刚度和质量：\n$$\n\\mathbf{K}=\\begin{pmatrix}K\\end{pmatrix},\\qquad \\mathbf{M}=\\begin{pmatrix}M\\end{pmatrix},\n$$\n其中 $K$ 和 $M$ 由包含 $\\phi(x)$ 的空间积分定义。然后，使用这些量，求得纵向振动的近似基频角频率。最终角频率以弧度/秒为单位表示。请提供一个精确的闭式解析表达式，不要四舍五入。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n1.  **已知条件提取：**\n    *   杆的属性：长度 $L$、横截面积 $A$、质量密度 $\\rho$、杨氏模量 $E$。\n    *   边界条件：$u(0,t)=0$, $u(L,t)=0$。\n    *   应变能：$U=\\frac{1}{2}\\int_{0}^{L}E A \\left(\\frac{\\partial u}{\\partial x}\\right)^{2}\\,\\mathrm{d}x$。\n    *   动能：$T=\\frac{1}{2}\\int_{0}^{L}\\rho A \\left(\\frac{\\partial u}{\\partial t}\\right)^{2}\\,\\mathrm{d}x$。\n    *   假设的位移场：$u(x,t)=q(t)\\,\\phi(x)$，其中 $\\phi(x)=x\\,(L-x)$。\n2.  **验证：**\n    *   该问题基于线性弹性动力学的科学原理，并使用了一维杆的动能和应变能的标准定义。\n    *   瑞利-里兹法是固体力学中一种标准的、有效的先验近似技术。\n    *   所选的试探函数 $\\phi(x)=x(L-x)$ 是容许的，因为它满足本质边界条件：$\\phi(0)=0\\cdot(L-0)=0$ 和 $\\phi(L)=L\\cdot(L-L)=0$。\n    *   该问题是适定的，提供了推导所求量所需的所有信息。语言客观且精确。\n3.  **结论：** 问题有效。将推导求解。\n\n求解过程是将假设的位移场代入给定的能量泛函，以推导广义刚度矩阵和质量矩阵，在本例中它们是标量 $K$ 和 $M$。\n\n首先，我们用广义坐标 $q(t)$ 来表示应变能 $U$。位移场的空间导数为：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} [q(t)\\,\\phi(x)] = q(t)\\frac{d\\phi}{dx}\n$$\n试探函数为 $\\phi(x) = Lx - x^2$。其对 $x$ 的导数为：\n$$\n\\frac{d\\phi}{dx} = L - 2x\n$$\n将此代入应变能泛函中：\n$$\nU = \\frac{1}{2}\\int_{0}^{L} E A \\left(q(t)\\frac{d\\phi}{dx}\\right)^{2}\\,\\mathrm{d}x = \\frac{1}{2}[q(t)]^2 \\left(E A \\int_{0}^{L} \\left(\\frac{d\\phi}{dx}\\right)^{2}\\,\\mathrm{d}x\\right)\n$$\n此表达式的形式为 $U = \\frac{1}{2}K[q(t)]^2$，其中广义刚度 $K$ 由下式给出：\n$$\nK = E A \\int_{0}^{L} \\left(\\frac{d\\phi}{dx}\\right)^{2}\\,\\mathrm{d}x = E A \\int_{0}^{L} (L-2x)^2\\,\\mathrm{d}x\n$$\n计算该积分：\n$$\n\\int_{0}^{L} (L-2x)^2\\,\\mathrm{d}x = \\int_{0}^{L} (L^2 - 4Lx + 4x^2)\\,\\mathrm{d}x = \\left[L^2x - 2Lx^2 + \\frac{4}{3}x^3\\right]_{0}^{L}\n$$\n$$\n= \\left(L^2(L) - 2L(L^2) + \\frac{4}{3}L^3\\right) - 0 = L^3 - 2L^3 + \\frac{4}{3}L^3 = \\frac{1}{3}L^3\n$$\n因此，广义刚度为：\n$$\nK = \\frac{E A L^3}{3}\n$$\n\n接下来，我们用广义坐标的时间导数 $\\dot{q}(t)$ 来表示动能 $T$。位移场的时间导数为：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial t} [q(t)\\,\\phi(x)] = \\dot{q}(t)\\,\\phi(x)\n$$\n将此代入动能泛函中：\n$$\nT = \\frac{1}{2}\\int_{0}^{L} \\rho A \\left(\\dot{q}(t)\\phi(x)\\right)^{2}\\,\\mathrm{d}x = \\frac{1}{2}[\\dot{q}(t)]^2 \\left(\\rho A \\int_{0}^{L} [\\phi(x)]^2\\,\\mathrm{d}x\\right)\n$$\n此表达式的形式为 $T = \\frac{1}{2}M[\\dot{q}(t)]^2$，其中广义质量 $M$ 由下式给出：\n$$\nM = \\rho A \\int_{0}^{L} [\\phi(x)]^2\\,\\mathrm{d}x = \\rho A \\int_{0}^{L} [x(L-x)]^2\\,\\mathrm{d}x\n$$\n计算该积分：\n$$\n\\int_{0}^{L} (Lx-x^2)^2\\,\\mathrm{d}x = \\int_{0}^{L} (L^2x^2 - 2Lx^3 + x^4)\\,\\mathrm{d}x = \\left[\\frac{L^2x^3}{3} - \\frac{2Lx^4}{4} + \\frac{x^5}{5}\\right]_{0}^{L}\n$$\n$$\n= \\left(\\frac{L^5}{3} - \\frac{L^5}{2} + \\frac{L^5}{5}\\right) - 0 = \\left(\\frac{10 - 15 + 6}{30}\\right)L^5 = \\frac{1}{30}L^5\n$$\n因此，广义质量为：\n$$\nM = \\frac{\\rho A L^5}{30}\n$$\n\n单自由度无阻尼自由振动系统的运动方程由拉格朗日方程推导得出，结果为：\n$$\nM\\ddot{q}(t) + Kq(t) = 0\n$$\n为求自然角频率 $\\omega$，我们假设一个形式为 $q(t) = Q\\exp(i\\omega t)$ 的谐波解，其中 $Q$ 是振幅。其二阶时间导数为 $\\ddot{q}(t) = -\\omega^2 Q\\exp(i\\omega t) = -\\omega^2 q(t)$。将此代入运动方程：\n$$\nM(-\\omega^2 q(t)) + Kq(t) = 0 \\implies (K - \\omega^2 M)q(t) = 0\n$$\n对于非平凡解（$q(t) \\neq 0$），必须满足特征方程：\n$$\nK - \\omega^2 M = 0 \\implies \\omega^2 = \\frac{K}{M}\n$$\n因此，基频角频率 $\\omega$ 为：\n$$\n\\omega = \\sqrt{\\frac{K}{M}}\n$$\n代入推导出的 $K$ 和 $M$ 的表达式：\n$$\n\\omega = \\sqrt{\\frac{\\frac{E A L^3}{3}}{\\frac{\\rho A L^5}{30}}} = \\sqrt{\\frac{E A L^3}{3} \\cdot \\frac{30}{\\rho A L^5}} = \\sqrt{\\frac{10 E A L^3}{ \\rho A L^5}}\n$$\n通过消去公因子（$A$, $L^3$）来化简表达式：\n$$\n\\omega = \\sqrt{\\frac{10 E}{\\rho L^2}} = \\frac{\\sqrt{10}}{L}\\sqrt{\\frac{E}{\\rho}}\n$$\n这就是杆的纵向振动的近似基频角频率。单位是秒的倒数（$s^{-1}$），即弧度/秒。",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{10}}{L}\\sqrt{\\frac{E}{\\rho}}}\n$$"
        },
        {
            "introduction": "在掌握了单自由度近似之后，我们现在将问题扩展到多自由度系统，这是瑞利-里兹法威力的真正体现。在这个练习中，你将使用两个试函数来近似简支梁的振动，从而构建一个$2 \\times 2$的矩阵特征值问题。这个过程不仅能让你计算出更高阶的频率和模态，还将引导你验证模态关于质量矩阵的正交性，并直观地理解增加自由度如何提高解的精度，这是该方法收敛性的核心。",
            "id": "3593581",
            "problem": "考虑一根长度为 $L$ 的均匀 Euler–Bernoulli 梁，在 $x=0$ 和 $x=L$ 处简支，进行小振幅横向振动。横向位移为 $w(x,t)$。该梁具有恒定的抗弯刚度 $E I$ 和单位长度质量 $\\rho A$。总势能为 $U = \\frac{1}{2} \\int_{0}^{L} E I \\left(w''(x,t)\\right)^{2} \\,\\mathrm{d}x$，总动能为 $T = \\frac{1}{2} \\int_{0}^{L} \\rho A \\left(\\dot{w}(x,t)\\right)^{2} \\,\\mathrm{d}x$。使用 Rayleigh–Ritz 方法，通过两个满足基本边界条件 $w(0,t)=0$ 和 $w(L,t)=0$ 的容许试函数来近似位移：\n$$\n\\phi_{1}(x) = x^3 - x^2, \\qquad \\phi_{2}(x) = x - x^2\n$$\n并写作 $w(x,t) \\approx q_{1}(t)\\,\\phi_{1}(x) + q_{2}(t)\\,\\phi_{2}(x)$。计算中使用无量纲化的梁长 $L=1$。\n\n从上述能量定义和容许近似出发，执行 Rayleigh–Ritz 过程，以获得决定固有频率平方的 $2 \\times 2$ 广义特征值问题。将无量纲化的频率平方定义为 $\\lambda = \\left(\\rho A / E I\\right)\\,\\omega^{2}$。计算该近似所隐含的质量矩阵和刚度矩阵，并求解得到的 $2 \\times 2$ 特征问题，以获得两个无量纲化的频率平方 $\\lambda_{1}$ 和 $\\lambda_{2}$。然后，使用这些结果：\n\n- 通过计算 $i \\neq j$ 时的 $a^{(i)\\top} \\mathbf{M}\\, a^{(j)}$ 来验证所得模态相对于质量矩阵的正交性，其中 $a^{(i)}$ 是特征向量。\n- 通过将仅基于 $\\phi_{1}$ 的单模态 Rayleigh 商与从双模态系统获得的最低特征值进行比较，来展示模态收敛行为。\n\n将您的最终答案表示为无量纲化频率平方的有序对 $\\left(\\lambda_{1}, \\lambda_{2}\\right)$，以行矩阵的形式。无需四舍五入。最终答案是无量纲的。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **系统**：均匀 Euler–Bernoulli 梁。\n- **支撑条件**：在 $x=0$ 和 $x=L$ 处简支。\n- **长度**：$L=1$ (无量纲化)。\n- **物理属性**：恒定的抗弯刚度 $EI$，恒定的单位长度质量 $\\rho A$。\n- **势能**：$U = \\frac{1}{2} \\int_{0}^{L} E I \\left(w''(x,t)\\right)^{2} \\,\\mathrm{d}x$。\n- **动能**：$T = \\frac{1}{2} \\int_{0}^{L} \\rho A \\left(\\dot{w}(x,t)\\right)^{2} \\,\\mathrm{d}x$。\n- **基本边界条件**：$w(0,t)=0$, $w(L,t)=0$。\n- **位移近似**：$w(x,t) \\approx q_{1}(t)\\,\\phi_{1}(x) + q_{2}(t)\\,\\phi_{2}(x)$。\n- **试函数**：$\\phi_{1}(x) = x^3 - x^2$，$\\phi_{2}(x) = x - x^2$。\n- **无量纲化频率平方的定义**：$\\lambda = \\left(\\rho A / E I\\right)\\,\\omega^{2}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是 Rayleigh-Ritz 方法在 Euler-Bernoulli 梁理论中的一个标准应用，这是结构动力学和计算力学中的一个基本课题。该问题是科学合理的。\n2.  **适定性**：该问题提供了所有必要信息（能量表达式、试函数、边界条件），以构建和求解得到的离散系统，从而获得其近似固有频率。\n3.  **客观性**：问题陈述使用了精确的数学定义和客观的物理原理。\n4.  **完备性**：试函数必须满足基本（几何）边界条件。\n    对于 $\\phi_{1}(x) = x^3 - x^2$：\n    $\\phi_{1}(0) = 0^3 - 0^2 = 0$。\n    $\\phi_{1}(1) = 1^3 - 1^2 = 0$。\n    对于 $\\phi_{2}(x) = x - x^2$：\n    $\\phi_{2}(0) = 0 - 0^2 = 0$。\n    $\\phi_{2}(1) = 1 - 1^2 = 0$。\n    两个试函数都满足在 $x=0$ 和 $x=1$ 处的基本边界条件，因此都是容许的。\n5.  所有其他有效性标准均已满足。\n\n### 步骤 3：结论与行动\n问题有效。将提供解答。\n\nRayleigh-Ritz 方法要求将近似位移代入能量表达式中，以获得一个离散系统。近似位移由 $w(x,t) = q_{1}(t)\\phi_{1}(x) + q_{2}(t)\\phi_{2}(x)$ 给出。动能和势能用广义坐标 $q_1(t)$ 和 $q_2(t)$ 表示。\n\n对于谐波运动，我们假设 $q_{j}(t) = a_j \\sin(\\omega t + \\psi)$，其中 $a_j$ 是振幅。最大动能为 $T_{\\max} = \\frac{1}{2} \\omega^2 \\mathbf{a}^\\top \\mathbf{M} \\mathbf{a}$，最大势能为 $U_{\\max} = \\frac{1}{2} \\mathbf{a}^\\top \\mathbf{K} \\mathbf{a}$，其中 $\\mathbf{a} = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix}$。令 $T_{\\max}$ 和 $U_{\\max}$ 相等（能量守恒），得到广义特征值问题 $\\mathbf{K} \\mathbf{a} = \\omega^2 \\mathbf{M} \\mathbf{a}$。\n\n刚度矩阵 $\\mathbf{K}$ 和质量矩阵 $\\mathbf{M}$ 由下式给出：\n$$ K_{ij} = \\int_{0}^{L} E I \\phi_i''(x) \\phi_j''(x) \\,dx $$\n$$ M_{ij} = \\int_{0}^{L} \\rho A \\phi_i(x) \\phi_j(x) \\,dx $$\n由于 $EI$ 和 $\\rho A$ 是常数且 $L=1$，我们可以定义无量纲化的刚度矩阵 $\\mathbf{K}^*$ 和质量矩阵 $\\mathbf{M}^*$ 如下：\n$$ \\mathbf{K} = EI \\mathbf{K}^* \\quad \\text{其中} \\quad K^*_{ij} = \\int_{0}^{1} \\phi_i''(x) \\phi_j''(x) \\,dx $$\n$$ \\mathbf{M} = \\rho A \\mathbf{M}^* \\quad \\text{其中} \\quad M^*_{ij} = \\int_{0}^{1} \\phi_i(x) \\phi_j(x) \\,dx $$\n特征值问题变为 $EI \\mathbf{K}^* \\mathbf{a} = \\omega^2 \\rho A \\mathbf{M}^* \\mathbf{a}$，整理后得 $\\mathbf{K}^* \\mathbf{a} = \\frac{\\rho A \\omega^2}{EI} \\mathbf{M}^* \\mathbf{a}$。使用给定定义 $\\lambda = \\frac{\\rho A \\omega^2}{EI}$，我们得到最终形式：\n$$ (\\mathbf{K}^* - \\lambda \\mathbf{M}^*) \\mathbf{a} = 0 $$\n\n首先，我们求试函数的二阶导数：\n$\\phi_1(x) = x^3 - x^2 \\implies \\phi_1'(x) = 3x^2 - 2x \\implies \\phi_1''(x) = 6x - 2$。\n$\\phi_2(x) = x - x^2 \\implies \\phi_2'(x) = 1 - 2x \\implies \\phi_2''(x) = -2$。\n\n现在，我们计算 $\\mathbf{K}^*$ 的元素：\n$K^*_{11} = \\int_0^1 (6x-2)^2 dx = \\int_0^1 (36x^2 - 24x + 4) dx = [12x^3 - 12x^2 + 4x]_0^1 = 4$。\n$K^*_{12} = K^*_{21} = \\int_0^1 (6x-2)(-2) dx = \\int_0^1 (-12x+4) dx = [-6x^2+4x]_0^1 = -2$。\n$K^*_{22} = \\int_0^1 (-2)^2 dx = \\int_0^1 4 dx = [4x]_0^1 = 4$。\n所以，无量纲化的刚度矩阵是：\n$$ \\mathbf{K}^* = \\begin{pmatrix} 4  -2 \\\\ -2  4 \\end{pmatrix} $$\n\n接下来，我们计算 $\\mathbf{M}^*$ 的元素：\n$M^*_{11} = \\int_0^1 (x^3-x^2)^2 dx = \\int_0^1 (x^6 - 2x^5 + x^4) dx = \\left[\\frac{x^7}{7} - \\frac{2x^6}{6} + \\frac{x^5}{5}\\right]_0^1 = \\frac{1}{7} - \\frac{1}{3} + \\frac{1}{5} = \\frac{15 - 35 + 21}{105} = \\frac{1}{105}$。\n$M^*_{12} = M^*_{21} = \\int_0^1 (x^3-x^2)(x-x^2) dx = \\int_0^1 (2x^4 - x^5 - x^3) dx = \\left[\\frac{2x^5}{5} - \\frac{x^6}{6} - \\frac{x^4}{4}\\right]_0^1 = \\frac{2}{5} - \\frac{1}{6} - \\frac{1}{4} = \\frac{24 - 10 - 15}{60} = -\\frac{1}{60}$。\n$M^*_{22} = \\int_0^1 (x-x^2)^2 dx = \\int_0^1 (x^2 - 2x^3 + x^4) dx = \\left[\\frac{x^3}{3} - \\frac{2x^4}{4} + \\frac{x^5}{5}\\right]_0^1 = \\frac{1}{3} - \\frac{1}{2} + \\frac{1}{5} = \\frac{10 - 15 + 6}{30} = \\frac{1}{30}$。\n所以，无量纲化的质量矩阵是：\n$$ \\mathbf{M}^* = \\begin{pmatrix} 1/105  -1/60 \\\\ -1/60  1/30 \\end{pmatrix} = \\frac{1}{420}\\begin{pmatrix} 4  -7 \\\\ -7  14 \\end{pmatrix} $$\n\n为了找到特征值 $\\lambda$，我们求解特征方程 $\\det(\\mathbf{K}^* - \\lambda \\mathbf{M}^*) = 0$：\n$$ \\det\\left( \\begin{pmatrix} 4  -2 \\\\ -2  4 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1/105  -1/60 \\\\ -1/60  1/30 \\end{pmatrix} \\right) = 0 $$\n$$ \\det \\begin{pmatrix} 4 - \\frac{\\lambda}{105}  -2 + \\frac{\\lambda}{60} \\\\ -2 + \\frac{\\lambda}{60}  4 - \\frac{\\lambda}{30} \\end{pmatrix} = 0 $$\n展开行列式：\n$$ \\left(4 - \\frac{\\lambda}{105}\\right)\\left(4 - \\frac{\\lambda}{30}\\right) - \\left(-2 + \\frac{\\lambda}{60}\\right)^2 = 0 $$\n$$ \\left(16 - \\frac{4\\lambda}{30} - \\frac{4\\lambda}{105} + \\frac{\\lambda^2}{3150}\\right) - \\left(4 - \\frac{4\\lambda}{60} + \\frac{\\lambda^2}{3600}\\right) = 0 $$\n$$ 12 - \\left(\\frac{2}{15} + \\frac{4}{105} - \\frac{1}{15}\\right)\\lambda + \\left(\\frac{1}{3150} - \\frac{1}{3600}\\right)\\lambda^2 = 0 $$\n$$ 12 - \\left(\\frac{1}{15} + \\frac{4}{105}\\right)\\lambda + \\left(\\frac{3600-3150}{3150 \\cdot 3600}\\right)\\lambda^2 = 0 $$\n$$ 12 - \\left(\\frac{7+4}{105}\\right)\\lambda + \\left(\\frac{450}{11340000}\\right)\\lambda^2 = 0 $$\n$$ 12 - \\frac{11\\lambda}{105} + \\frac{1}{25200}\\lambda^2 = 0 $$\n乘以 $25200$：\n$$ (12)(25200) - \\frac{11(25200)}{105}\\lambda + \\lambda^2 = 0 $$\n$$ 302400 - 11(240)\\lambda + \\lambda^2 = 0 $$\n$$ \\lambda^2 - 2640\\lambda + 302400 = 0 $$\n我们求解这个关于 $\\lambda$ 的二次方程：\n$$ \\lambda = \\frac{2640 \\pm \\sqrt{(-2640)^2 - 4(1)(302400)}}{2} = \\frac{2640 \\pm \\sqrt{6969600 - 1209600}}{2} $$\n$$ \\lambda = \\frac{2640 \\pm \\sqrt{5760000}}{2} = \\frac{2640 \\pm 2400}{2} $$\n两个无量纲化的频率平方是：\n$\\lambda_1 = \\frac{2640 - 2400}{2} = \\frac{240}{2} = 120$。\n$\\lambda_2 = \\frac{2640 + 2400}{2} = \\frac{5040}{2} = 2520$。\n\n该问题还要求验证模态正交性和收敛性。\n首先，我们求特征向量（模态振型）$\\mathbf{a}^{(i)}$。\n对于 $\\lambda_1 = 120$：\n$(\\mathbf{K}^* - 120 \\mathbf{M}^*) \\mathbf{a}^{(1)} = 0$。该矩阵为：\n$$ \\begin{pmatrix} 4 - \\frac{120}{105}  -2 + \\frac{120}{60} \\\\ -2 + \\frac{120}{60}  4 - \\frac{120}{30} \\end{pmatrix} = \\begin{pmatrix} 4 - \\frac{8}{7}  -2 + 2 \\\\ -2 + 2  4 - 4 \\end{pmatrix} = \\begin{pmatrix} 20/7  0 \\\\ 0  0 \\end{pmatrix} $$\n方程 $(20/7)a_1^{(1)} = 0$ 意味着 $a_1^{(1)}=0$。我们可以选择 $a_2^{(1)}=1$。所以，$\\mathbf{a}^{(1)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n对于 $\\lambda_2 = 2520$：\n$(\\mathbf{K}^* - 2520 \\mathbf{M}^*) \\mathbf{a}^{(2)} = 0$。该矩阵为：\n$$ \\begin{pmatrix} 4 - \\frac{2520}{105}  -2 + \\frac{2520}{60} \\\\ -2 + \\frac{2520}{60}  4 - \\frac{2520}{30} \\end{pmatrix} = \\begin{pmatrix} 4 - 24  -2 + 42 \\\\ -2 + 42  4 - 84 \\end{pmatrix} = \\begin{pmatrix} -20  40 \\\\ 40  -80 \\end{pmatrix} $$\n方程 $-20 a_1^{(2)} + 40 a_2^{(2)} = 0$ 意味着 $a_1^{(2)} = 2a_2^{(2)}$。我们可以选择 $a_2^{(2)}=1$，因此 $a_1^{(2)}=2$。于是，$\\mathbf{a}^{(2)} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$。\n\n验证 M-正交性：$\\mathbf{a}^{(1)\\top} \\mathbf{M}^* \\mathbf{a}^{(2)} = 0$。\n$$ \\begin{pmatrix} 0  1 \\end{pmatrix} \\frac{1}{420}\\begin{pmatrix} 4  -7 \\\\ -7  14 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = \\frac{1}{420} \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 4(2) - 7(1) \\\\ -7(2) + 14(1) \\end{pmatrix} = \\frac{1}{420} \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 0 $$\n模态相对于质量矩阵是正交的。\n\n展示模态收敛行为：单个试函数 $\\phi(x)$ 的 Rayleigh 商给出了最低特征值的上界。对于 $\\phi_1(x)$，该商为：\n$$ \\lambda_{\\phi_1} = \\frac{\\int_0^1 (\\phi_1'')^2 dx}{\\int_0^1 \\phi_1^2 dx} = \\frac{K^*_{11}}{M^*_{11}} = \\frac{4}{1/105} = 420 $$\n将此单模态近似值与双模态系统的最低特征值 $\\lambda_1 = 120$ 进行比较，我们看到 $\\lambda_{\\phi_1} = 420 > \\lambda_1 = 120$。这证明了 Rayleigh-Ritz 方法的收敛特性，即增加自由度可以改善（降低）特征值的估计。\n\n最终答案是有序的无量纲化频率平方对。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n120  2520\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "作为本章的压轴练习，我们将挑战一个更复杂且更具实际意义的三维弹性动力学问题。这个综合性练习要求你为一个自由边界的弹性立方体推导并实现瑞利-里兹法的近似解。你不仅需要从弹性力学的第一性原理出发，为三维位移场推导完整的刚度与质量矩阵，还需要编写代码来数值求解该问题，并将结果与解析解进行验证。这个练习将理论推导与计算实践紧密结合，是连接理论学习与计算力学研究的重要桥梁。",
            "id": "3593547",
            "problem": "考虑一个边长为 $L$ 的均匀、各向同性、线性弹性立方体，其所有六个面都满足位移为零的边界条件。该材料的杨氏模量为 $E$，泊松比为 $\\nu$，质量密度为 $\\rho$，拉梅参数 $\\lambda$ 和 $\\mu$ 由各向同性线性弹性理论中经过充分检验的关系式定义：$\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$。对于小应变下的自由振动，其基本依据是应用于线性弹性动力学的驻值作用量原理，该原理对于固有频率可简化为瑞利商：一个容许位移场 $u$ 的固有频率平方 $\\omega^2$ 等于两倍的储存弹性势能与单位振幅下动能之比，这是由线性动量平衡和胡克定律推导出来的。总弹性势能为 $U(u) = \\dfrac{1}{2} \\int_{\\Omega} \\sigma(u) : \\varepsilon(u) \\, \\mathrm{d}V$，动能为 $T(u) = \\dfrac{1}{2} \\int_{\\Omega} \\rho \\, u \\cdot u \\, \\mathrm{d}V$，其中 $\\varepsilon(u) = \\dfrac{1}{2} (\\nabla u + \\nabla u^\\top)$ 是小应变张量，$\\sigma(u) = \\lambda \\, \\mathrm{tr}(\\varepsilon(u)) I + 2 \\mu \\, \\varepsilon(u)$ 是各向同性线性弹性的柯西应力张量。\n\n使用瑞利-里兹法和三角函数基\n$$\n\\phi_{i j k}(x,y,z) = \\sin\\!\\left(\\frac{i \\pi x}{L}\\right) \\sin\\!\\left(\\frac{j \\pi y}{L}\\right) \\sin\\!\\left(\\frac{k \\pi z}{L}\\right),\n$$\n其中 $i$、$j$ 和 $k$ 是正整数，来近似固有频率。构造一个矢量值试验位移，作为三个分量对齐的基函数的线性组合，\n$$\nu_h(x,y,z) = a_x \\, \\phi_{i j k}(x,y,z) \\, e_x + a_y \\, \\phi_{i j k}(x,y,z) \\, e_y + a_z \\, \\phi_{i j k}(x,y,z) \\, e_z,\n$$\n其中 $e_x$、$e_y$ 和 $e_z$ 是笛卡尔单位矢量，$a_x$、$a_y$、$a_z$ 是标量里兹系数。从上述变分陈述（基本依据）出发，推导系数 $\\{a_x, a_y, a_z\\}$ 的广义特征值问题。\n\n仅使用三角函数的正交性和在 $[0,L]$ 上的基本积分恒等式，推导逐分量的刚度贡献和质量贡献的闭式表达式。具体来说，证明交叉分量耦合消失，并且广义特征值问题简化为三个关于分量振幅的独立标量关系。然后，获得与一个固定的三元组 $(i,j,k)$ 相关联的三个固有频率平方的显式解析公式：\n$$\n\\omega_x^2(i,j,k) = \\frac{\\pi^2}{\\rho L^2} \\left[(\\lambda + 2\\mu) i^2 + \\mu (j^2 + k^2)\\right], \\quad\n\\omega_y^2(i,j,k) = \\frac{\\pi^2}{\\rho L^2} \\left[(\\lambda + 2\\mu) j^2 + \\mu (i^2 + k^2)\\right], \\quad\n\\omega_z^2(i,j,k) = \\frac{\\pi^2}{\\rho L^2} \\left[(\\lambda + 2\\mu) k^2 + \\mu (i^2 + j^2)\\right].\n$$\n以弧度/秒表示固有频率。\n\n你的程序必须：\n- 对每个指定的 $(i,j,k)$，使用上述试验空间，通过精确计算必要的域积分，组装瑞利-里兹广义特征值问题 $K a = \\omega^2 M a$。\n- 求解所得的 $3 \\times 3$ 广义特征值问题，并提取三个以弧度/秒为单位的固有频率。\n- 根据推导出的闭式表达式计算解析频率。\n- 对每个测试案例，计算数值瑞利-里兹频率与解析频率之间的最大绝对相对误差，即\n$$\n\\mathrm{err} = \\max_{\\ell \\in \\{x,y,z\\}} \\left| \\frac{\\omega_\\ell^{\\mathrm{num}} - \\omega_\\ell^{\\mathrm{ana}}}{\\omega_\\ell^{\\mathrm{ana}}} \\right|.\n$$\n\n设计一个测试套件，涵盖各种材料和几何参数以及不同的指数组合：\n- 测试案例 1：$E = 200 \\times 10^{9} \\ \\mathrm{Pa}$，$\\nu = 0.25$，$\\rho = 7800 \\ \\mathrm{kg/m^3}$，$L = 0.1 \\ \\mathrm{m}$，$(i,j,k) = (1,1,1)$。\n- 测试案例 2：$E = 70 \\times 10^{9} \\ \\mathrm{Pa}$，$\\nu = 0.33$，$\\rho = 2700 \\ \\mathrm{kg/m^3}$，$L = 0.05 \\ \\mathrm{m}$，$(i,j,k) = (2,1,3)$。\n- 测试案例 3（近不可压缩弹性体）：$E = 1 \\times 10^{6} \\ \\mathrm{Pa}$，$\\nu = 0.499$，$\\rho = 1000 \\ \\mathrm{kg/m^3}$，$L = 0.2 \\ \\mathrm{m}$，$(i,j,k) = (3,3,2)$。\n- 测试案例 4（剪切敏感指数）：$E = 3 \\times 10^{9} \\ \\mathrm{Pa}$，$\\nu = 0.45$，$\\rho = 1200 \\ \\mathrm{kg/m^3}$，$L = 0.15 \\ \\mathrm{m}$，$(i,j,k) = (1,4,5)$。\n- 测试案例 5（小尺寸几何）：$E = 100 \\times 10^{9} \\ \\mathrm{Pa}$，$\\nu = 0.30$，$\\rho = 8900 \\ \\mathrm{kg/m^3}$，$L = 0.01 \\ \\mathrm{m}$，$(i,j,k) = (1,2,3)$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，“[r1,r2,r3,r4,r5]”），其中每个 $r_\\ell$ 是相应测试案例的最大绝对相对误差，以十进制数表示。",
            "solution": "该问题具有科学依据，是适定的，并且为推导和计算提供了所有必要的数据。该公式基于线性弹性动力学的标准原理和瑞利-里兹近似法。任务是使用一组预设的试验函数，推导特定振动系统的固有频率的广义特征值问题，求解该问题，并将结果与作为过程一部分推导出的解析解进行比较。这构成了一个在计算科学中常见的自洽验证练习。该问题被确定为有效。\n\n中心任务是找到瑞利商的驻点，对于简谐运动 $u(x,t) = u(x) e^{i\\omega t}$，瑞利商由下式给出\n$$\n\\omega^2 = \\frac{U(u)}{T_{unit\\_amp}(u)} = \\frac{\\frac{1}{2} \\int_{\\Omega} \\sigma(u) : \\varepsilon(u) \\, \\mathrm{d}V}{\\frac{1}{2} \\int_{\\Omega} \\rho \\, u \\cdot u \\, \\mathrm{d}V} = \\frac{\\int_{\\Omega} \\sigma(u) : \\varepsilon(u) \\, \\mathrm{d}V}{\\int_{\\Omega} \\rho \\, u \\cdot u \\, \\mathrm{d}V}\n$$\n我们通过将试验位移场 $u_h$ 代入此商来采用瑞利-里兹法。试验场是基函数的线性组合：\n$$\nu_h(x,y,z) = \\sum_{p \\in \\{x,y,z\\}} a_p \\psi_p(x,y,z) = a_x \\psi_x + a_y \\psi_y + a_z \\psi_z\n$$\n其中矢量值基函数定义为 $\\psi_x = \\phi_{ijk} e_x$，$\\psi_y = \\phi_{ijk} e_y$ 和 $\\psi_z = \\phi_{ijk} e_z$，其中 $\\phi_{ijk}(x,y,z) = \\sin(\\frac{i \\pi x}{L}) \\sin(\\frac{j \\pi y}{L}) \\sin(\\frac{k \\pi z}{L})$。将 $u_h$ 代入瑞利商并寻求其关于系数 $a_p$ 的驻值，可得到 $3 \\times 3$ 的广义特征值问题 $K a = \\omega^2 M a$，其中 $a = [a_x, a_y, a_z]^\\top$。\n\n刚度矩阵 $K$ 和质量矩阵 $M$ 的元素由以下公式给出：\n$$\nK_{pq} = \\int_{\\Omega} \\sigma(\\psi_p) : \\varepsilon(\\psi_q) \\, \\mathrm{d}V\n$$\n$$\nM_{pq} = \\int_{\\Omega} \\rho \\, (\\psi_p \\cdot \\psi_q) \\, \\mathrm{d}V\n$$\n对于 $p, q \\in \\{x, y, z\\}$。我们现在将推导这些矩阵分量。\n\n首先，我们计算质量矩阵 $M$。两个基函数的点积是：\n$$\n\\psi_p \\cdot \\psi_q = (\\phi_{ijk} e_p) \\cdot (\\phi_{ijk} e_q) = \\phi_{ijk}^2 (e_p \\cdot e_q) = \\phi_{ijk}^2 \\delta_{pq}\n$$\n其中 $\\delta_{pq}$ 是克罗内克δ符号。因此，质量矩阵是对角的。对角线元素为：\n$$\nM_{pp} = \\int_{\\Omega} \\rho \\, \\phi_{ijk}^2 \\, \\mathrm{d}V = \\rho \\int_0^L \\sin^2\\left(\\frac{i \\pi x}{L}\\right) \\mathrm{d}x \\int_0^L \\sin^2\\left(\\frac{j \\pi y}{L}\\right) \\mathrm{d}y \\int_0^L \\sin^2\\left(\\frac{k \\pi z}{L}\\right) \\mathrm{d}z\n$$\n使用标准定积分恒等式 $\\int_0^L \\sin^2(\\frac{n\\pi \\xi}{L}) \\mathrm{d}\\xi = L/2$ 对于任何正整数 $n$，我们发现：\n$$\nM_{pp} = \\rho \\left(\\frac{L}{2}\\right) \\left(\\frac{L}{2}\\right) \\left(\\frac{L}{2}\\right) = \\frac{\\rho L^3}{8}\n$$\n所以，质量矩阵是 $M = \\frac{\\rho L^3}{8} I$，其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n\n接下来，我们计算刚度矩阵 $K$。这需要每个基函数 $\\psi_p$ 的应变张量 $\\varepsilon$ 和应力张量 $\\sigma$。令 $\\phi_{,x} = \\partial \\phi_{ijk}/\\partial x$，$\\phi_{,y} = \\partial \\phi_{ijk}/\\partial y$ 和 $\\phi_{,z} = \\partial \\phi_{ijk}/\\partial z$。\n\n对于基函数 $\\psi_x = \\phi_{ijk} e_x$，位移分量为 $u_x = \\phi_{ijk}$，$u_y = 0$，$u_z = 0$。应变张量 $\\varepsilon(\\psi_x)$ 的非零分量为：\n$$\n\\varepsilon_{xx} = \\phi_{,x}, \\quad \\varepsilon_{xy} = \\frac{1}{2}\\phi_{,y}, \\quad \\varepsilon_{xz} = \\frac{1}{2}\\phi_{,z}\n$$\n应变的迹为 $\\mathrm{tr}(\\varepsilon(\\psi_x)) = \\phi_{,x}$。应力张量 $\\sigma(\\psi_x) = \\lambda \\mathrm{tr}(\\varepsilon) I + 2\\mu \\varepsilon$ 的分量为：\n$$\n\\sigma_{xx}(\\psi_x) = (\\lambda + 2\\mu)\\phi_{,x}, \\quad \\sigma_{yy}(\\psi_x) = \\lambda\\phi_{,x}, \\quad \\sigma_{zz}(\\psi_x) = \\lambda\\phi_{,x}\n$$\n$$\n\\sigma_{xy}(\\psi_x) = 2\\mu\\varepsilon_{xy} = \\mu\\phi_{,y}, \\quad \\sigma_{xz}(\\psi_x) = 2\\mu\\varepsilon_{xz} = \\mu\\phi_{,z}, \\quad \\sigma_{yz}(\\psi_x) = 0\n$$\n通过对称性，$\\sigma(\\psi_y)$ 和 $\\sigma(\\psi_z)$ 的表达式可以通过指数的循环置换获得。\n\n现在我们计算刚度矩阵元素 $K_{pq}$。让我们从对角项 $K_{xx}$ 开始：\n$$\nK_{xx} = \\int_{\\Omega} \\sigma(\\psi_x) : \\varepsilon(\\psi_x) \\, \\mathrm{d}V = \\int_{\\Omega} \\left( \\sigma_{xx}\\varepsilon_{xx} + 2\\sigma_{xy}\\varepsilon_{xy} + 2\\sigma_{xz}\\varepsilon_{xz} \\right) \\mathrm{d}V\n$$\n$$\nK_{xx} = \\int_{\\Omega} \\left( (\\lambda+2\\mu)\\phi_{,x}^2 + 2(\\mu\\phi_{,y})(\\frac{1}{2}\\phi_{,y}) + 2(\\mu\\phi_{,z})(\\frac{1}{2}\\phi_{,z}) \\right) \\mathrm{d}V\n$$\n$$\nK_{xx} = \\int_{\\Omega} \\left( (\\lambda+2\\mu)\\phi_{,x}^2 + \\mu(\\phi_{,y}^2 + \\phi_{,z}^2) \\right) \\mathrm{d}V\n$$\n为了计算这个，我们需要 $\\phi_{ijk}$ 偏导数平方的积分：\n$$\n\\int_{\\Omega} \\phi_{,x}^2 \\, \\mathrm{d}V = \\left(\\frac{i\\pi}{L}\\right)^2 \\int_0^L \\cos^2\\left(\\frac{i\\pi x}{L}\\right)\\mathrm{d}x \\int_0^L \\sin^2\\left(\\frac{j\\pi y}{L}\\right)\\mathrm{d}y \\int_0^L \\sin^2\\left(\\frac{k\\pi z}{L}\\right)\\mathrm{d}z\n$$\n使用恒等式 $\\int_0^L \\cos^2(\\frac{n\\pi\\xi}{L})\\mathrm{d}\\xi = L/2$ 和 $\\int_0^L \\sin^2(\\frac{n\\pi\\xi}{L})\\mathrm{d}\\xi = L/2$，这变成：\n$$\n\\int_{\\Omega} \\phi_{,x}^2 \\,\\mathrm{d}V = \\left(\\frac{i\\pi}{L}\\right)^2 \\left(\\frac{L^3}{8}\\right), \\quad \\int_{\\Omega} \\phi_{,y}^2 \\,\\mathrm{d}V = \\left(\\frac{j\\pi}{L}\\right)^2 \\left(\\frac{L^3}{8}\\right), \\quad \\int_{\\Omega} \\phi_{,z}^2 \\,\\mathrm{d}V = \\left(\\frac{k\\pi}{L}\\right)^2 \\left(\\frac{L^3}{8}\\right)\n$$\n将这些代入 $K_{xx}$ 的表达式中：\n$$\nK_{xx} = \\left[ (\\lambda+2\\mu)\\left(\\frac{i\\pi}{L}\\right)^2 + \\mu\\left(\\left(\\frac{j\\pi}{L}\\right)^2 + \\left(\\frac{k\\pi}{L}\\right)^2\\right) \\right] \\frac{L^3}{8} = \\frac{\\pi^2 L}{8} \\left[ (\\lambda+2\\mu)i^2 + \\mu(j^2+k^2) \\right]\n$$\n其他对角项 $K_{yy}$ 和 $K_{zz}$ 可由指数 $(i,j,k)$ 的循环置换得到。\n\n对于非对角项，考虑 $K_{xy}$：\n$$\nK_{xy} = \\int_{\\Omega} \\sigma(\\psi_x) : \\varepsilon(\\psi_y) \\, \\mathrm{d}V\n$$\n对于 $\\psi_y=\\phi_{ijk}e_y$ 的非零应变分量是 $\\varepsilon_{yy}=\\phi_{,y}$，$\\varepsilon_{xy}=\\frac{1}{2}\\phi_{,x}$，$\\varepsilon_{yz}=\\frac{1}{2}\\phi_{,z}$。张量缩并为：\n$$\n\\sigma(\\psi_x) : \\varepsilon(\\psi_y) = \\sigma_{yy}(\\psi_x)\\varepsilon_{yy}(\\psi_y) + 2\\sigma_{xy}(\\psi_x)\\varepsilon_{xy}(\\psi_y) = (\\lambda\\phi_{,x})(\\phi_{,y}) + 2(\\mu\\phi_{,y})(\\frac{1}{2}\\phi_{,x}) = (\\lambda+\\mu)\\phi_{,x}\\phi_{,y}\n$$\n所以，$K_{xy} = (\\lambda+\\mu) \\int_{\\Omega} \\phi_{,x}\\phi_{,y} \\, \\mathrm{d}V$。该积分为：\n$$\n\\int_{\\Omega} \\phi_{,x}\\phi_{,y} \\, \\mathrm{d}V = \\left(\\frac{ij\\pi^2}{L^2}\\right) \\int_0^L \\sin\\left(\\frac{i\\pi x}{L}\\right)\\cos\\left(\\frac{i\\pi x}{L}\\right)\\mathrm{d}x \\int_0^L \\sin\\left(\\frac{j\\pi y}{L}\\right)\\cos\\left(\\frac{j\\pi y}{L}\\right)\\mathrm{d}y \\int_0^L \\sin^2\\left(\\frac{k\\pi z}{L}\\right)\\mathrm{d}z\n$$\n积分 $\\int_0^L \\sin(\\frac{n\\pi\\xi}{L})\\cos(\\frac{n\\pi\\xi}{L})\\mathrm{d}\\xi = \\frac{1}{2} \\int_0^L \\sin(\\frac{2n\\pi\\xi}{L})\\mathrm{d}\\xi = 0$ 对于任何正整数 $n$ 都成立。因此，$K_{xy}$ 的整个积分都为零。由于这种正交性，$K$ 的所有非对角项均为零，这证明了对于这种基的选择，交叉分量耦合消失了。\n\n特征值问题 $K a = \\omega^2 M a$ 变成了一组三个独立的标量方程，因为 $K$ 和 $M$ 都是对角矩阵：\n$$\nK_{xx} a_x = \\omega^2 M_{xx} a_x \\implies \\omega_x^2 = \\frac{K_{xx}}{M_{xx}}\n$$\n$$\nK_{yy} a_y = \\omega^2 M_{yy} a_y \\implies \\omega_y^2 = \\frac{K_{yy}}{M_{yy}}\n$$\n$$\nK_{zz} a_z = \\omega^2 M_{zz} a_z \\implies \\omega_z^2 = \\frac{K_{zz}}{M_{zz}}\n$$\n代入推导出的 $K_{pp}$ 和 $M_{pp}$ 表达式，得到固有频率平方的解析公式：\n$$\n\\omega_x^2 = \\frac{\\frac{\\pi^2 L}{8} \\left[ (\\lambda+2\\mu)i^2 + \\mu(j^2+k^2) \\right]}{\\frac{\\rho L^3}{8}} = \\frac{\\pi^2}{\\rho L^2} \\left[ (\\lambda+2\\mu)i^2 + \\mu(j^2+k^2) \\right]\n$$\n通过置换，我们得到 $\\omega_y^2$ 和 $\\omega_z^2$ 的表达式：\n$$\n\\omega_y^2 = \\frac{\\pi^2}{\\rho L^2} \\left[ (\\lambda+2\\mu)j^2 + \\mu(i^2+k^2) \\right]\n$$\n$$\n\\omega_z^2 = \\frac{\\pi^2}{\\rho L^2} \\left[ (\\lambda+2\\mu)k^2 + \\mu(i^2+j^2) \\right]\n$$\n此推导证实了问题陈述中提供的解析公式。数值实现将使用这些推导出的元素表达式来组装矩阵 $K$ 和 $M$，并求解特征值问题，其结果应与解析公式在机器精度范围内相同。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Solves the elastodynamics problem for specified test cases using the Rayleigh-Ritz method\n    and compares the numerical results against the analytical solution.\n    \"\"\"\n\n    # Define the test cases as specified in the problem statement.\n    # Structure: (E, nu, rho, L, (i, j, k))\n    test_cases = [\n        (200e9, 0.25, 7800.0, 0.1, (1, 1, 1)),\n        (70e9, 0.33, 2700.0, 0.05, (2, 1, 3)),\n        (1e6, 0.499, 1000.0, 0.2, (3, 3, 2)),\n        (3e9, 0.45, 1200.0, 0.15, (1, 4, 5)),\n        (100e9, 0.30, 8900.0, 0.01, (1, 2, 3)),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        E, nu, rho, L, indices = case\n        i, j, k = indices\n\n        # --- 1. Calculate Lamé parameters ---\n        # lambda_ is used to avoid conflict with Python's lambda keyword.\n        lambda_ = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n        mu = E / (2 * (1 + nu))\n\n        # --- 2. Numerical Rayleigh-Ritz Solution ---\n        # Assemble the 3x3 stiffness (K) and mass (M) matrices.\n        # The derivation shows that both matrices are diagonal for this basis.\n        # The entries are computed by evaluating the domain integrals exactly,\n        # resulting in the closed-form expressions derived in the solution.\n        \n        # Mass matrix component (all diagonal entries are identical)\n        # M_diag = rho *Integral(phi^2 dV) = rho * (L/2)^3\n        M_diag = rho * (L**3) / 8.0\n        M = np.diag([M_diag, M_diag, M_diag])\n\n        # Stiffness matrix components (diagonal entries)\n        # K_pp = Integral(sigma(psi_p) : epsilon(psi_p) dV)\n        # The term (np.pi**2 * L / 8) comes from combining the pi/L derivative factors\n        # and the integral result L^3/8.\n        common_factor_K = (np.pi**2 * L) / 8.0\n        \n        K_xx = common_factor_K * ((lambda_ + 2 * mu) * i**2 + mu * (j**2 + k**2))\n        K_yy = common_factor_K * ((lambda_ + 2 * mu) * j**2 + mu * (i**2 + k**2))\n        K_zz = common_factor_K * ((lambda_ + 2 * mu) * k**2 + mu * (i**2 + j**2))\n        K = np.diag([K_xx, K_yy, K_zz])\n        \n        # Solve the generalized eigenvalue problem K*a = omega^2*M*a\n        # eig returns eigenvalues (omega^2) and eigenvectors (a)\n        # For diagonal matrices, the eigenvalues are simply K[n,n]/M[n,n]\n        omega_sq_num, _ = eig(K, M)\n        \n        # Take the square root to find natural frequencies omega (in rad/s)\n        # The eigenvalues should be real and positive.\n        omega_num = np.sqrt(np.real(omega_sq_num))\n\n        # --- 3. Analytical Solution ---\n        # Compute the frequencies directly from the closed-form analytical expressions.\n        common_factor_ana = (np.pi**2) / (rho * L**2)\n        \n        omega_x_sq_ana = common_factor_ana * ((lambda_ + 2 * mu) * i**2 + mu * (j**2 + k**2))\n        omega_y_sq_ana = common_factor_ana * ((lambda_ + 2 * mu) * j**2 + mu * (i**2 + k**2))\n        omega_z_sq_ana = common_factor_ana * ((lambda_ + 2 * mu) * k**2 + mu * (i**2 + j**2))\n        \n        omega_sq_ana = np.array([omega_x_sq_ana, omega_y_sq_ana, omega_z_sq_ana])\n        omega_ana = np.sqrt(omega_sq_ana)\n        \n        # --- 4. Error Calculation ---\n        # The numerical and analytical results should be identical up to floating point precision.\n        # We need to sort both arrays to ensure a consistent comparison.\n        omega_num_sorted = np.sort(omega_num)\n        omega_ana_sorted = np.sort(omega_ana)\n        \n        # Calculate the maximum absolute relative error.\n        # Avoid division by zero if an analytical frequency is zero (not possible for i,j,k > 0).\n        relative_errors = np.abs((omega_num_sorted - omega_ana_sorted) / omega_ana_sorted)\n        max_relative_error = np.max(relative_errors)\n        \n        results.append(max_relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n\n```"
        }
    ]
}