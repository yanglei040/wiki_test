{
    "hands_on_practices": [
        {
            "introduction": "A deep understanding of boundary conditions begins with the governing physics they represent. This exercise () reverses the typical problem-solving direction: instead of finding a solution for given loads, you will start with a known displacement field and determine the body forces and boundary conditions necessary to produce it. This powerful code verification technique, known as the Method of Manufactured Solutions, provides invaluable insight into how displacement, strain, stress, body forces, and boundary tractions are fundamentally interconnected.",
            "id": "3558541",
            "problem": "Consider a two-dimensional solid occupying the open unit square domain $\\Omega = (0,1) \\times (0,1)$ in a state of plane strain. The material is homogeneous, isotropic, and linearly elastic with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The Lamé parameters are $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$. The governing equations are the static balance of linear momentum and the linear constitutive relation for small strains, where the Cauchy stress $\\sigma$ is related to the symmetric small-strain tensor $\\varepsilon$ by $\\sigma = \\lambda \\,\\operatorname{tr}(\\varepsilon)\\, I + 2 \\mu\\, \\varepsilon$, and the equilibrium equation is $-\\nabla \\cdot \\sigma = b$ in $\\Omega$, where $b$ is the body force.\n\nTo construct a manufactured solution for code verification, prescribe the displacement field $u(x,y) = \\begin{pmatrix} u_{1}(x,y) \\\\ u_{2}(x,y) \\end{pmatrix}$ with components $u_{1}(x,y) = x^{2} y + x y$ and $u_{2}(x,y) = - x y^{2} + x + y$. Define the boundary partition into Dirichlet and Neumann segments as $\\Gamma_{D} = \\{(0,y) \\,|\\, y \\in [0,1]\\} \\cup \\{(x,1) \\,|\\, x \\in [0,1]\\}$ and $\\Gamma_{N} = \\{(x,0) \\,|\\, x \\in [0,1]\\} \\cup \\{(1,y) \\,|\\, y \\in [0,1]\\}$, where the outward unit normal on each boundary segment is used to compute tractions.\n\nTasks:\n- Starting from the definitions of the small-strain tensor $\\varepsilon = \\dfrac{1}{2}\\left(\\nabla u + (\\nabla u)^{\\top}\\right)$ and the constitutive law $\\sigma = \\lambda \\,\\operatorname{tr}(\\varepsilon)\\, I + 2 \\mu\\, \\varepsilon$, compute the body force field $b(x,y)$ required for $u(x,y)$ to satisfy equilibrium in $\\Omega$.\n- Determine the traction vector $\\bar{t} = \\sigma n$ on the Neumann boundary $\\Gamma_{N}$, with $n$ denoting the outward unit normal.\n- Provide the Dirichlet data $\\bar{u}$ on $\\Gamma_{D}$ by restricting $u(x,y)$ to those segments.\n\nExpress your final answer as the closed-form analytic expression for the body force vector $b(x,y)$ in terms of $x$, $y$, $\\lambda$, and $\\mu$. No numerical rounding is required, and no units need to be reported in the final expression.",
            "solution": "The problem is valid as it is a well-posed, scientifically grounded exercise in linear elasticity, specifically using the method of manufactured solutions for code verification. All necessary data and definitions are provided, and there are no contradictions or ambiguities.\n\nThe objective is to compute the body force field $b(x,y)$, the traction vector $\\bar{t}$ on the Neumann boundary $\\Gamma_{N}$, and the displacement data $\\bar{u}$ on the Dirichlet boundary $\\Gamma_{D}$ corresponding to a prescribed displacement field $u(x,y)$. The final answer required is the expression for the body force $b(x,y)$.\n\nThe prescribed displacement field is given in components as:\n$$\nu_{1}(x,y) = x^{2} y + x y\n$$\n$$\nu_{2}(x,y) = - x y^{2} + x + y\n$$\n\nFirst, we compute the gradient of the displacement field, $\\nabla u$:\n$$\n\\nabla u = \\begin{pmatrix} \\frac{\\partial u_{1}}{\\partial x} & \\frac{\\partial u_{1}}{\\partial y} \\\\ \\frac{\\partial u_{2}}{\\partial x} & \\frac{\\partial u_{2}}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 2xy + y & x^{2} + x \\\\ -y^{2} + 1 & -2xy + 1 \\end{pmatrix}\n$$\n\nNext, we calculate the components of the symmetric small-strain tensor $\\varepsilon = \\frac{1}{2}\\left(\\nabla u + (\\nabla u)^{\\top}\\right)$:\n$$\n\\varepsilon_{11} = \\frac{\\partial u_{1}}{\\partial x} = 2xy + y\n$$\n$$\n\\varepsilon_{22} = \\frac{\\partial u_{2}}{\\partial y} = -2xy + 1\n$$\n$$\n\\varepsilon_{12} = \\varepsilon_{21} = \\frac{1}{2}\\left(\\frac{\\partial u_{1}}{\\partial y} + \\frac{\\partial u_{2}}{\\partial x}\\right) = \\frac{1}{2}\\left((x^{2} + x) + (-y^{2} + 1)\\right) = \\frac{1}{2}(x^{2} + x - y^{2} + 1)\n$$\n\nThe trace of the strain tensor, for the two-dimensional plane strain case, is:\n$$\n\\operatorname{tr}(\\varepsilon) = \\varepsilon_{11} + \\varepsilon_{22} = (2xy + y) + (-2xy + 1) = y + 1\n$$\n\nNow, we use the constitutive law $\\sigma = \\lambda \\,\\operatorname{tr}(\\varepsilon)\\, I + 2 \\mu\\, \\varepsilon$ to find the components of the Cauchy stress tensor $\\sigma$:\n$$\n\\sigma_{11} = \\lambda \\operatorname{tr}(\\varepsilon) + 2\\mu\\varepsilon_{11} = \\lambda(y + 1) + 2\\mu(2xy + y)\n$$\n$$\n\\sigma_{22} = \\lambda \\operatorname{tr}(\\varepsilon) + 2\\mu\\varepsilon_{22} = \\lambda(y + 1) + 2\\mu(-2xy + 1)\n$$\n$$\n\\sigma_{12} = \\sigma_{21} = 2\\mu\\varepsilon_{12} = 2\\mu \\left(\\frac{1}{2}(x^{2} + x - y^{2} + 1)\\right) = \\mu(x^{2} + x - y^{2} + 1)\n$$\n\nThe body force vector $b$ is determined from the equilibrium equation $b = -\\nabla \\cdot \\sigma$. The components of the divergence of the stress tensor are $(\\nabla \\cdot \\sigma)_{1} = \\frac{\\partial \\sigma_{11}}{\\partial x} + \\frac{\\partial \\sigma_{12}}{\\partial y}$ and $(\\nabla \\cdot \\sigma)_{2} = \\frac{\\partial \\sigma_{21}}{\\partial x} + \\frac{\\partial \\sigma_{22}}{\\partial y}$. First, we compute the partial derivatives of the stress components:\n$$\n\\frac{\\partial \\sigma_{11}}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\lambda(y + 1) + 2\\mu(2xy + y) \\right] = 4\\mu y\n$$\n$$\n\\frac{\\partial \\sigma_{12}}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ \\mu(x^{2} + x - y^{2} + 1) \\right] = -2\\mu y\n$$\n$$\n\\frac{\\partial \\sigma_{21}}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\mu(x^{2} + x - y^{2} + 1) \\right] = \\mu(2x + 1)\n$$\n$$\n\\frac{\\partial \\sigma_{22}}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ \\lambda(y + 1) + 2\\mu(-2xy + 1) \\right] = \\lambda + 2\\mu(-2x) = \\lambda - 4\\mu x\n$$\n\nNow, we assemble the components of the body force vector $b = \\begin{pmatrix} b_{1} \\\\ b_{2} \\end{pmatrix}$:\n$$\nb_{1} = -\\left( \\frac{\\partial \\sigma_{11}}{\\partial x} + \\frac{\\partial \\sigma_{12}}{\\partial y} \\right) = -(4\\mu y - 2\\mu y) = -2\\mu y\n$$\n$$\nb_{2} = -\\left( \\frac{\\partial \\sigma_{21}}{\\partial x} + \\frac{\\partial \\sigma_{22}}{\\partial y} \\right) = -(\\mu(2x + 1) + (\\lambda - 4\\mu x)) = -(\\lambda + \\mu + 2\\mu x - 4\\mu x) = -(\\lambda + \\mu - 2\\mu x) = 2\\mu x - \\lambda - \\mu\n$$\nThus, the body force field is $b(x,y) = \\begin{pmatrix} -2\\mu y \\\\ 2\\mu x - \\lambda - \\mu \\end{pmatrix}$. This is the required final answer.\n\nFor completeness, we also derive the boundary conditions.\nThe Neumann boundary is $\\Gamma_{N} = \\{(x,0) \\,|\\, x \\in [0,1]\\} \\cup \\{(1,y) \\,|\\, y \\in [0,1]\\}$. The traction vector is $\\bar{t} = \\sigma n$.\n\nOn the boundary segment where $y=0$ and $x \\in [0,1]$, the outward normal is $n = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$. The traction is:\n$$\n\\bar{t}(x,0) = \\begin{pmatrix} \\sigma_{11} & \\sigma_{12} \\\\ \\sigma_{21} & \\sigma_{22} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -\\sigma_{12}(x,0) \\\\ -\\sigma_{22}(x,0) \\end{pmatrix}\n$$\nEvaluating the stress components at $y=0$:\n$\\sigma_{12}(x,0) = \\mu(x^{2} + x + 1)$\n$\\sigma_{22}(x,0) = \\lambda(1) + 2\\mu(1) = \\lambda + 2\\mu$\nSo, $\\bar{t}(x,0) = \\begin{pmatrix} -\\mu(x^{2} + x + 1) \\\\ -(\\lambda + 2\\mu) \\end{pmatrix}$.\n\nOn the boundary segment where $x=1$ and $y \\in [0,1]$, the outward normal is $n = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The traction is:\n$$\n\\bar{t}(1,y) = \\begin{pmatrix} \\sigma_{11} & \\sigma_{12} \\\\ \\sigma_{21} & \\sigma_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{11}(1,y) \\\\ \\sigma_{21}(1,y) \\end{pmatrix}\n$$\nEvaluating the stress components at $x=1$:\n$\\sigma_{11}(1,y) = \\lambda(y+1) + 2\\mu(2y+y) = \\lambda(y+1) + 6\\mu y$\n$\\sigma_{21}(1,y) = \\mu(1^{2} + 1 - y^{2} + 1) = \\mu(3 - y^{2})$\nSo, $\\bar{t}(1,y) = \\begin{pmatrix} \\lambda(y+1) + 6\\mu y \\\\ \\mu(3-y^{2}) \\end{pmatrix}$.\n\nThe Dirichlet boundary is $\\Gamma_{D} = \\{(0,y) \\,|\\, y \\in [0,1]\\} \\cup \\{(x,1) \\,|\\, x \\in [0,1]\\}$. The Dirichlet data $\\bar{u}$ is the prescribed displacement field evaluated on $\\Gamma_D$.\n\nOn the boundary segment where $x=0$ and $y \\in [0,1]$:\n$$\n\\bar{u}(0,y) = \\begin{pmatrix} u_{1}(0,y) \\\\ u_{2}(0,y) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ y \\end{pmatrix}\n$$\n\nOn the boundary segment where $y=1$ and $x \\in [0,1]$:\n$$\n\\bar{u}(x,1) = \\begin{pmatrix} u_{1}(x,1) \\\\ u_{2}(x,1) \\end{pmatrix} = \\begin{pmatrix} x^{2}+x \\\\ -x(1)^{2}+x+1 \\end{pmatrix} = \\begin{pmatrix} x^{2}+x \\\\ 1 \\end{pmatrix}\n$$\nThese results define the full boundary value problem for which the given displacement field is the exact solution. The problem specifically asks for the body force vector as the final answer.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -2\\mu y \\\\ 2\\mu x - \\lambda - \\mu \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "After exploring the theoretical origins of boundary conditions, the next step is to apply them in a numerical simulation. This problem () provides a complete, step-by-step guide to solving a canonical mixed boundary value problem for a 1D bar using the Finite Element Method. It demonstrates how Neumann conditions arise naturally from the weak form, while Dirichlet conditions require a specific implementation strategy, in this case, the widely used penalty method.",
            "id": "3558610",
            "problem": "A prismatic bar of length $L$ undergoing small-strain, linear elastic, quasi-static axial deformation is modeled. The governing strong form in one spatial dimension is $-\\frac{d}{dx}\\!\\left(EA\\,\\frac{du}{dx}\\right)=0$ for $0<x<L$, where $u(x)$ is the axial displacement, $E$ is the Young’s modulus, and $A$ is the constant cross-sectional area. The bar is subjected to an essential (Dirichlet) boundary condition $u(0)=u_{D}$ and a natural (Neumann) boundary condition corresponding to an applied axial traction $\\bar{t}$ at $x=L$.\n\nStarting from this strong form and the principle of virtual work, derive the weak form and its Finite Element Method (FEM) discretization using standard linear Lagrange shape functions on $2$ equal linear elements over the interval $[0,L]$. Use the material and geometric properties $E=210\\times 10^{9}\\,\\mathrm{Pa}$, $A=2.0\\times 10^{-4}\\,\\mathrm{m}^{2}$, and $L=2\\,\\mathrm{m}$. Assume no body force in the domain. Impose the Dirichlet boundary condition at $x=0$ via the penalty method with penalty parameter $\\alpha=4.2\\times 10^{8}\\,\\mathrm{N/m}$ and prescribed displacement $u_{D}=1.0\\times 10^{-4}\\,\\mathrm{m}$. The Neumann boundary condition at $x=L$ is the axial traction $\\bar{t}=10^{3}\\,\\mathrm{N}$.\n\nAssemble the global discrete system, include the contribution of the Neumann condition, and then impose the Dirichlet condition via the penalty method. Solve the resulting system to obtain the nodal displacement at $x=L$. Express the final displacement in meters. Round your answer to four significant figures.",
            "solution": "The user wants to solve a 1D solid mechanics problem using the Finite Element Method (FEM).\n\n### Step 1: Problem Validation\n\n**1.1. Extraction of Givens:**\n-   **Governing Equation:** $-\\frac{d}{dx}\\!\\left(EA\\,\\frac{du}{dx}\\right)=0$ for $0<x<L$.\n-   **Domain:** A prismatic bar of length $L=2\\,\\mathrm{m}$ from $x=0$ to $x=L$.\n-   **Variables:** $u(x)$ is the axial displacement.\n-   **Properties:** Young's modulus $E=210\\times 10^{9}\\,\\mathrm{Pa}$, constant cross-sectional area $A=2.0\\times 10^{-4}\\,\\mathrm{m}^{2}$.\n-   **Body Force:** Assumed to be zero.\n-   **Boundary Conditions:**\n    -   Essential (Dirichlet) at $x=0$: $u(0)=u_{D}$, with $u_{D}=1.0\\times 10^{-4}\\,\\mathrm{m}$.\n    -   Natural (Neumann) at $x=L$: Applied axial force (traction) $\\bar{t}=10^{3}\\,\\mathrm{N}$.\n-   **Numerical Method:**\n    -   Finite Element Method (FEM) discretization.\n    -   $2$ equal linear elements over $[0,L]$.\n    -   Standard linear Lagrange shape functions.\n    -   Dirichlet BC imposed via the penalty method with penalty parameter $\\alpha=4.2\\times 10^{8}\\,\\mathrm{N/m}$.\n-   **Objective:** Solve the resulting system for the nodal displacement at $x=L$ and round the answer to four significant figures.\n\n**1.2. Validation:**\n-   **Scientific Grounding:** The problem describes a canonical one-dimensional bar in static equilibrium under axial loading. The governing equation is correct for linear elasticity and small strains. The principle of virtual work, FEM, and the penalty method are standard, well-established concepts in computational solid mechanics. All physical quantities ($E$, $A$, $L$, $\\bar{t}$, $u_D$, $\\alpha$) are given with consistent units and have physically realistic values for a steel bar. The problem is scientifically sound.\n-   **Well-Posedness:** This is a mixed (Dirichlet-Neumann) boundary value problem for a second-order ordinary differential equation. Such problems are well-posed, guaranteeing a unique and stable solution.\n-   **Objectivity:** The problem is stated using precise, unambiguous mathematical and engineering terminology.\n\n**1.3. Verdict:**\nThe problem is valid. It is self-contained, scientifically grounded, and well-posed. The solution process can proceed.\n\n### Step 2: Derivation and Solution\n\n**2.1. Weak Form Derivation:**\nStarting from the strong form of the governing equation $-\\frac{d}{dx}(EA\\frac{du}{dx}) = 0$, we multiply by an arbitrary test function (virtual displacement) $v(x)$ and integrate over the domain $\\Omega = [0, L]$:\n$$ \\int_{0}^{L} v \\left( -\\frac{d}{dx}\\left(EA\\frac{du}{dx}\\right) \\right) dx = 0 $$\nIntegrate by parts:\n$$ \\int_{0}^{L} \\frac{dv}{dx} EA \\frac{du}{dx} dx - \\left[ v \\left(EA \\frac{du}{dx}\\right) \\right]_{0}^{L} = 0 $$\nThe term $EA \\frac{du}{dx}$ represents the internal axial force, $\\sigma A$. Let's call it $F_{int}$. The equation becomes:\n$$ \\int_{0}^{L} \\frac{dv}{dx} EA \\frac{du}{dx} dx = v(L) F_{int}(L) - v(0) F_{int}(0) $$\nThe natural boundary condition at $x=L$ specifies the applied force $\\bar{t}$, so $F_{int}(L) = \\bar{t}$. At $x=0$, $F_{int}(0)$ is the unknown reaction force. The weak form is to find $u(x)$ satisfying the essential BC $u(0)=u_D$ such that for all admissible test functions $v(x)$, the equation holds. The FEM discretization will handle all terms.\n\n**2.2. FEM Discretization:**\nThe domain is discretized into $2$ elements of equal length $h=L/2 = 2/2 = 1\\,\\mathrm{m}$. This creates three nodes:\n-   Node 1 at $x_1=0$.\n-   Node 2 at $x_2=1$.\n-   Node 3 at $x_3=2$.\nThe element stiffness matrix $\\mathbf{k}^{(e)}$ for a linear bar element is:\n$$ \\mathbf{k}^{(e)} = \\frac{E^{(e)}A^{(e)}}{h^{(e)}} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nThe product $EA$ is constant:\n$$ EA = (210 \\times 10^9\\,\\mathrm{Pa})(2.0 \\times 10^{-4}\\,\\mathrm{m}^2) = 4.2 \\times 10^7\\,\\mathrm{N} $$\nFor both elements, $h=1\\,\\mathrm{m}$, so $\\frac{EA}{h} = 4.2 \\times 10^7\\,\\mathrm{N/m}$.\nThe element stiffness matrices for element 1 (nodes 1-2) and element 2 (nodes 2-3) are identical:\n$$ \\mathbf{k}^{(1)} = \\mathbf{k}^{(2)} = 4.2 \\times 10^7 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n\n**2.3. Assembly of Global System:**\nWe assemble the global stiffness matrix $\\mathbf{K}$ for the three degrees of freedom ($u_1, u_2, u_3$):\n$$ \\mathbf{K} = \\begin{pmatrix} k^{(1)}_{11} & k^{(1)}_{12} & 0 \\\\ k^{(1)}_{21} & k^{(1)}_{22} + k^{(2)}_{11} & k^{(2)}_{12} \\\\ 0 & k^{(2)}_{21} & k^{(2)}_{22} \\end{pmatrix} = 4.2 \\times 10^7 \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 1+1 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} $$\n$$ \\mathbf{K} = 4.2 \\times 10^7 \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} $$\nThe external force vector $\\mathbf{F}_{ext}$ includes the Neumann boundary condition. The force $\\bar{t}=10^3\\,\\mathrm{N}$ is applied at node $3$:\n$$ \\mathbf{F}_{ext} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1000 \\end{pmatrix} $$\n\n**2.4. Imposing Dirichlet BC via Penalty Method:**\nThe Dirichlet condition $u(0)=u_1=u_D$ is imposed by modifying the system $\\mathbf{K}\\mathbf{d}=\\mathbf{F}$. The penalty method modifies the diagonal stiffness entry corresponding to the constrained degree of freedom (DOF) and the corresponding force entry.\nThe equation for DOF $i$ gets modified as:\n$$ K_{ii} \\rightarrow K_{ii} + \\alpha $$\n$$ F_i \\rightarrow F_i + \\alpha u_D $$\nHere, the constrained DOF is $u_1$ ($i=1$). The penalty parameter is $\\alpha=4.2\\times 10^8\\,\\mathrm{N/m}$.\nThe modified stiffness matrix $\\mathbf{K}_{mod}$ is:\n$$ K_{11,mod} = K_{11} + \\alpha = 4.2 \\times 10^7 + 4.2 \\times 10^8 = 4.2 \\times 10^7 + 42.0 \\times 10^7 = 46.2 \\times 10^7 = 4.62 \\times 10^8 $$\n$$ \\mathbf{K}_{mod} = \\begin{pmatrix} 4.62 \\times 10^8 & -4.2 \\times 10^7 & 0 \\\\ -4.2 \\times 10^7 & 8.4 \\times 10^7 & -4.2 \\times 10^7 \\\\ 0 & -4.2 \\times 10^7 & 4.2 \\times 10^7 \\end{pmatrix} $$\nThe modified force vector $\\mathbf{F}_{mod}$ is:\n$$ F_{1,mod} = F_{ext,1} + \\alpha u_D = 0 + (4.2 \\times 10^8)(1.0 \\times 10^{-4}) = 4.2 \\times 10^4 $$\n$$ \\mathbf{F}_{mod} = \\begin{pmatrix} 4.2 \\times 10^4 \\\\ 0 \\\\ 1000 \\end{pmatrix} $$\n\n**2.5. Solving the Linear System:**\nThe final system of equations $\\mathbf{K}_{mod}\\mathbf{d}=\\mathbf{F}_{mod}$ is:\n$$ \\begin{pmatrix} 4.62 \\times 10^8 & -4.2 \\times 10^7 & 0 \\\\ -4.2 \\times 10^7 & 8.4 \\times 10^7 & -4.2 \\times 10^7 \\\\ 0 & -4.2 \\times 10^7 & 4.2 \\times 10^7 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 42000 \\\\ 0 \\\\ 1000 \\end{pmatrix} $$\nLet's solve this system.\nFrom the third row:\n$$ -4.2 \\times 10^7 u_2 + 4.2 \\times 10^7 u_3 = 1000 \\implies u_3 - u_2 = \\frac{1000}{4.2 \\times 10^7} $$\nFrom the second row:\n$$ -4.2 \\times 10^7 u_1 + 8.4 \\times 10^7 u_2 - 4.2 \\times 10^7 u_3 = 0 \\implies -u_1 + 2u_2 - u_3 = 0 $$\nSubstitute $u_3 = 2u_2 - u_1$ into the first relation:\n$$ (2u_2 - u_1) - u_2 = \\frac{1000}{4.2 \\times 10^7} \\implies u_2 - u_1 = \\frac{1000}{4.2 \\times 10^7} $$\nThis shows that the strain is constant in the first element, as expected.\nLet $C = \\frac{1000}{4.2 \\times 10^7}$. Then $u_2 = u_1+C$ and $u_3 = u_2+C = u_1+2C$.\nNow, use the first row of the system:\n$$ 4.62 \\times 10^8 u_1 - 4.2 \\times 10^7 u_2 = 42000 $$\nSubstitute $u_2=u_1+C$:\n$$ 4.62 \\times 10^8 u_1 - 4.2 \\times 10^7 (u_1+C) = 42000 $$\n$$ (4.62 \\times 10^8 - 4.2 \\times 10^7) u_1 - 4.2 \\times 10^7 C = 42000 $$\n$$ (4.2 \\times 10^8) u_1 - 4.2 \\times 10^7 \\left(\\frac{1000}{4.2 \\times 10^7}\\right) = 42000 $$\n$$ 4.2 \\times 10^8 u_1 - 1000 = 42000 $$\n$$ 4.2 \\times 10^8 u_1 = 43000 $$\n$$ u_1 = \\frac{43000}{4.2 \\times 10^8} = \\frac{4.3}{4.2} \\times 10^{-4} \\,\\mathrm{m} $$\nThe question asks for the displacement at $x=L$, which is $u_3$.\n$$ u_3 = u_1 + 2C = \\frac{43000}{4.2 \\times 10^8} + 2 \\left(\\frac{1000}{4.2 \\times 10^7}\\right) $$\n$$ u_3 = \\frac{43000}{4.2 \\times 10^8} + \\frac{20000}{4.2 \\times 10^8} = \\frac{63000}{4.2 \\times 10^8} $$\n$$ u_3 = \\frac{6.3 \\times 10^4}{4.2 \\times 10^8} = \\frac{6.3}{4.2} \\times 10^{-4} = 1.5 \\times 10^{-4} \\,\\mathrm{m} $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ u_3 = 1.500 \\times 10^{-4} \\,\\mathrm{m} $$",
            "answer": "$$\\boxed{1.500 \\times 10^{-4}}$$"
        },
        {
            "introduction": "Boundary conditions are not just mathematical formalities; they are essential for ensuring a problem is physically and numerically well-posed. Without sufficient displacement constraints (Dirichlet conditions), a simulated body is free to undergo rigid-body motion, which is represented mathematically by a singular stiffness matrix. This advanced practice () explores the consequences of such a \"floating\" body in a pure Neumann problem and investigates standard computational techniques to properly constrain it, thereby guaranteeing a unique and stable solution.",
            "id": "3558482",
            "problem": "Consider a small-strain, static, two-dimensional linear elastic body occupying the domain $\\Omega = [0,1] \\times [0,1]$ in meters, with boundary $\\partial \\Omega$. Let the material be homogeneous, isotropic, and obey the constitutive law of linear elasticity in plane stress with Young's modulus $E$ and Poisson's ratio $\\nu$. Let the body be of unit thickness $h=1$ meter. The governing equations follow from balance of linear momentum and the Cauchy stress-strain relation: equilibrium $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$ in $\\Omega$ (with zero body force $\\mathbf{b}=\\mathbf{0}$), kinematics $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top})$, and constitutive law $\\boldsymbol{\\sigma} = \\mathbf{D} \\, \\boldsymbol{\\varepsilon}$ where $\\mathbf{D}$ is the isotropic plane-stress elasticity matrix. On the entire boundary $\\partial \\Omega$, prescribe only Neumann boundary conditions of the form $\\boldsymbol{\\sigma} \\mathbf{n} = \\bar{\\mathbf{t}}$, where $\\mathbf{n}$ is the outward unit normal and $\\bar{\\mathbf{t}}$ is a specified traction per unit area. To ensure zero net resultant, use hydrostatic pressure loading $\\bar{\\mathbf{t}} = -p \\, \\mathbf{n}$ with constant pressure $p$ in Pascals, which corresponds physically to a uniform compressive pressure.\n\nThe Finite Element Method (FEM) approximation is constructed with linear three-node constant-strain triangles (CST). Using the principle of virtual work, the discrete system can be written as $\\mathbf{K} \\, \\mathbf{u} = \\mathbf{f}$, where $\\mathbf{K}$ is the global symmetric stiffness matrix assembled from element contributions $\\mathbf{K}^{(e)} = h \\, A^{(e)} \\, \\mathbf{B}^{\\top} \\mathbf{D} \\, \\mathbf{B}$, with $A^{(e)}$ the element area and $\\mathbf{B}$ the constant strain-displacement matrix for the triangle. The load vector $\\mathbf{f}$ is assembled from boundary edge traction integrals $\\int_{\\Gamma_e} \\mathbf{N}^{\\top} \\bar{\\mathbf{t}} \\, ds$, which simplify for uniform traction and linear shape functions to $\\tfrac{L_e}{2} h \\, \\bar{\\mathbf{t}}$ per boundary edge of length $L_e$ shared equally by the two edge nodes. With only Neumann boundary conditions, the stiffness matrix $\\mathbf{K}$ is positive semidefinite and its nullspace consists of rigid-body modes. In two dimensions, the rigid-body nullspace dimension is expected to be $3$ (two translations and one in-plane rotation) in the absence of displacement constraints.\n\nYour task is to write a program that assembles the finite element stiffness matrix $\\mathbf{K}$ and boundary load vector $\\mathbf{f}$ for the unit square with a uniform structured triangulation, and then investigates rigid-body mode removal under different minimal constraint strategies. Use material parameters $E = 210 \\times 10^9$ Pascals and $\\nu = 0.3$. Use mesh resolution $N_e = 4$ elements per side in each direction, leading to a structured grid subdivided into triangles by splitting each square along a diagonal. Apply hydrostatic pressure $p = 1 \\times 10^6$ Pascals on all boundaries so that $\\bar{\\mathbf{t}} = -p \\, \\mathbf{n}$ on $\\partial \\Omega$. Express any displacements, if computed, in meters.\n\nDefine the following four test cases to investigate the nullspace of the discrete operator:\n\n- Test case $1$ (pure Neumann): no displacement constraints are imposed. Compute the number of near-zero singular values of $\\mathbf{K}$, interpreted as the nullspace dimension corresponding to rigid-body modes.\n\n- Test case $2$ (minimal constraints, single node): impose the Dirichlet constraint $\\mathbf{u} = \\mathbf{0}$ at a single corner node (fix both components at that node). Compute the number of near-zero singular values of the reduced stiffness matrix obtained by eliminating the constrained degrees of freedom.\n\n- Test case $3$ (minimal constraints, remove rotation): impose the Dirichlet constraints $\\mathbf{u} = \\mathbf{0}$ at the same corner node and additionally constrain the vertical displacement at a second corner node to zero. Compute the number of near-zero singular values of the reduced stiffness matrix.\n\n- Test case $4$ (average constraints via Lagrange multipliers): impose zero average displacement constraints in both directions, meaning $\\tfrac{1}{|\\Omega|}\\int_{\\Omega} u_x \\, d\\Omega = 0$ and $\\tfrac{1}{|\\Omega|}\\int_{\\Omega} u_y \\, d\\Omega = 0$, using Lagrange multipliers in the discrete system. In practice, this is implemented by the constraint matrix $\\mathbf{C}$ such that the augmented system is $\\begin{bmatrix} \\mathbf{K} & \\mathbf{C}^{\\top} \\\\ \\mathbf{C} & \\mathbf{0} \\end{bmatrix} \\begin{bmatrix} \\mathbf{u} \\\\ \\boldsymbol{\\lambda} \\end{bmatrix} = \\begin{bmatrix} \\mathbf{f} \\\\ \\mathbf{0} \\end{bmatrix}$, where $\\mathbf{C}$ has one row of ones corresponding to all $x$-displacement degrees of freedom and one row of ones corresponding to all $y$-displacement degrees of freedom. Compute the number of near-zero singular values of the augmented operator.\n\nFor each test case, estimate the nullspace dimension by counting the number of singular values $\\sigma_i$ of the operator (either $\\mathbf{K}$, the reduced $\\mathbf{K}$, or the augmented operator) that satisfy $\\sigma_i < \\varepsilon \\, \\max_j \\sigma_j$ with tolerance $\\varepsilon = 10^{-9}$. Use the singular value decomposition on the appropriate matrix in each case.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is the integer count of near-zero singular values for test case $i$. This output is unitless. The program must be self-contained and must not require any user input or external files. The numerical values for material parameters and loading must be exactly those given above, with units as stated; the final output is purely the integer list as described, with no units.",
            "solution": "The user has provided a valid, well-posed problem statement from the field of computational solid mechanics. The problem is scientifically grounded, objective, and contains all necessary information to proceed with a solution. The task is to analyze the nullspace of a finite element stiffness matrix under various constraint strategies for a 2D linear elastic body.\n\nThe solution proceeds as follows: First, we construct the Finite Element Method (FEM) model for the specified problem. This involves generating a mesh, defining the element properties, and assembling the global stiffness matrix $\\mathbf{K}$. Subsequently, we address each of the four test cases by manipulating this matrix or augmenting it, and then determining the dimension of its nullspace using Singular Value Decomposition (SVD).\n\n**1. Finite Element Discretization**\n\nThe problem concerns a two-dimensional, linear elastic body under plane stress conditions. The domain is a unit square, $\\Omega = [0,1] \\times [0,1]$. The material is defined by Young's modulus $E = 210 \\times 10^9 \\, \\text{Pa}$ and Poisson's ratio $\\nu = 0.3$. The body has a unit thickness $h = 1 \\, \\text{m}$.\n\nThe constitutive relationship between the stress vector $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy}]^{\\top}$ and the strain vector $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, 2\\varepsilon_{xy}]^{\\top}$ is given by $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$. For isotropic plane stress, the elasticity matrix $\\mathbf{D}$ is:\n$$\n\\mathbf{D} = \\frac{E}{1 - \\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1 - \\nu}{2}\n\\end{bmatrix}\n$$\n\nThe domain is discretized using a structured mesh of linear three-node constant-strain triangles (CST). The mesh has $N_e = 4$ divisions per side, resulting in a grid of $(N_e+1) \\times (N_e+1) = 5 \\times 5 = 25$ nodes. Each of the $N_e^2 = 16$ square cells is divided into two triangles, for a total of $32$ elements. The total number of degrees of freedom (DOFs) is $2$ per node (one horizontal, one vertical displacement), giving $2 \\times 25 = 50$ total DOFs.\n\nFor a CST element with nodal coordinates $(x_1, y_1)$, $(x_2, y_2)$, and $(x_3, y_3)$, the strain-displacement matrix $\\mathbf{B}$ is constant within the element and is given by:\n$$\n\\mathbf{B} = \\frac{1}{2A^{(e)}}\n\\begin{bmatrix}\ny_2-y_3 & 0 & y_3-y_1 & 0 & y_1-y_2 & 0 \\\\\n0 & x_3-x_2 & 0 & x_1-x_3 & 0 & x_2-x_1 \\\\\nx_3-x_2 & y_2-y_3 & x_1-x_3 & y_3-y_1 & x_2-x_1 & y_1-y_2\n\\end{bmatrix}\n$$\nwhere $A^{(e)}$ is the area of the element. The element stiffness matrix $\\mathbf{K}^{(e)}$, a $6 \\times 6$ matrix, is calculated via the integral of $\\mathbf{B}^{\\top} \\mathbf{D} \\mathbf{B}$ over the element volume:\n$$\n\\mathbf{K}^{(e)} = h A^{(e)} \\mathbf{B}^{\\top} \\mathbf{D} \\mathbf{B}\n$$\n\nThe global stiffness matrix $\\mathbf{K}$ (a $50 \\times 50$ matrix) is assembled by summing the contributions from all $32$ element stiffness matrices $\\mathbf{K}^{(e)}$ into their corresponding global DOF locations.\n\n**2. Analysis of the Operator Nullspace**\n\nA problem with only Neumann boundary conditions specified on the entire boundary is physically free to undergo rigid-body motions (translations and rotations) without inducing any strain, and thus no stress. This is reflected in the global stiffness matrix $\\mathbf{K}$ being singular (positive semidefinite). Its nullspace corresponds to these rigid-body modes. For a 2D problem, there are three such modes: two translations and one in-plane rotation.\n\nTo numerically determine the dimension of the nullspace (i.e., the rank deficiency) of a matrix $\\mathbf{M}$, we use its Singular Value Decomposition (SVD). The number of singular values $\\sigma_i$ that are zero corresponds to the nullity. Due to finite precision arithmetic, we count the number of singular values that are numerically close to zero. As specified, a singular value $\\sigma_i$ is considered near-zero if $\\sigma_i < \\varepsilon \\cdot \\max_j \\sigma_j$, with a tolerance of $\\varepsilon = 10^{-9}$.\n\n**3. Implementation of Test Cases**\n\n**Test Case 1: Pure Neumann Problem**\nNo displacement constraints are applied. The operator to analyze is the original global stiffness matrix $\\mathbf{K}$. We expect to find a nullity corresponding to the three rigid-body modes.\n$$\n\\text{Nullity}(\\mathbf{K}) = 3\n$$\n\n**Test Case 2: Minimal Constraints (Single Node)**\nDisplacement constraints $\\mathbf{u} = \\mathbf{0}$ are imposed at a single corner node, for instance, the node at $(0,0)$. This corresponds to setting the first two DOFs (u_x and u_y at node 0) to zero. This is implemented by removing the rows and columns corresponding to these DOFs from the global matrix $\\mathbf{K}$, resulting in a reduced matrix $\\mathbf{K}_{red}$. Fixing a single node prevents both translational modes. However, the body can still rotate around this fixed point. Therefore, we expect the reduced system to have one remaining rigid-body mode.\n$$\n\\text{Nullity}(\\mathbf{K}_{red}) = 1\n$$\n\n**Test Case 3: Minimal Constraints (Rotation Removed)**\nIn addition to fixing the node at $(0,0)$ as in Case 2, the vertical displacement of a second corner node, e.g., at $(1,0)$, is constrained to zero. This set of three constraints is sufficient to eliminate all three rigid-body modes: the two translations are removed by fixing the first node, and the final constraint on the second node prevents any rotation around the first. The resulting reduced matrix $\\mathbf{K}_{red}$ should be nonsingular (positive definite).\n$$\n\\text{Nullity}(\\mathbf{K}_{red}) = 0\n$$\n\n**Test Case 4: Average Constraints via Lagrange Multipliers**\nThis case removes rigid-body translations by enforcing zero average displacement over the domain, i.e., $\\int_{\\Omega} u_x d\\Omega = 0$ and $\\int_{\\Omega} u_y d\\Omega = 0$. In the discrete system, this is approximated by two constraint equations. As per the problem, these are $\\sum u_{x,i} = 0$ and $\\sum u_{y,i} = 0$, where the sum is over all nodes. These constraints are incorporated using Lagrange multipliers, leading to the augmented saddle-point system:\n$$\n\\begin{bmatrix} \\mathbf{K} & \\mathbf{C}^{\\top} \\\\ \\mathbf{C} & \\mathbf{0} \\end{bmatrix} \\begin{bmatrix} \\mathbf{u} \\\\ \\boldsymbol{\\lambda} \\end{bmatrix} = \\begin{bmatrix} \\mathbf{f} \\\\ \\mathbf{0} \\end{bmatrix}\n$$\nHere, $\\mathbf{C}$ is a $2 \\times 50$ matrix where the first row contains ones at positions corresponding to $x$-DOFs and zeros elsewhere, and the second row does the same for $y$-DOFs. The operator to be analyzed is the augmented matrix $\\mathbf{M} = \\begin{bmatrix} \\mathbf{K} & \\mathbf{C}^{\\top} \\\\ \\mathbf{C} & \\mathbf{0} \\end{bmatrix}$. These two constraints effectively remove the two translational modes. The rotational mode is not constrained by this formulation, as a pure rotation about the body's geometric center results in zero net displacement. Thus, we expect the augmented operator to have a nullity of one.\n$$\n\\text{Nullity}(\\mathbf{M}) = 1\n$$\n\nThe following program implements this entire procedure to compute the nullity for each of the four cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import svdvals\n\ndef solve():\n    \"\"\"\n    Solves the FEM problem for rigid-body mode analysis.\n    \"\"\"\n    \n    # Material and problem parameters\n    E = 210e9  # Young's modulus in Pa\n    nu = 0.3   # Poisson's ratio\n    h = 1.0    # Thickness in m\n    Ne = 4     # Number of elements per side\n    \n    # Derived parameters\n    n_nodes_per_side = Ne + 1\n    n_nodes = n_nodes_per_side**2\n    n_dofs = 2 * n_nodes\n    \n    # 1. Mesh Generation (Nodes and Elements)\n    nodes = np.zeros((n_nodes, 2))\n    for i in range(n_nodes_per_side):\n        for j in range(n_nodes_per_side):\n            node_idx = i * n_nodes_per_side + j\n            nodes[node_idx] = [j / Ne, i / Ne]\n\n    elements = []\n    for i in range(Ne):\n        for j in range(Ne):\n            n1 = i * n_nodes_per_side + j         # Bottom-left\n            n2 = i * n_nodes_per_side + j + 1     # Bottom-right\n            n3 = (i + 1) * n_nodes_per_side + j + 1 # Top-right\n            n4 = (i + 1) * n_nodes_per_side + j     # Top-left\n            # Split square cell along the n1-n3 diagonal\n            elements.append([n1, n2, n3])\n            elements.append([n1, n3, n4])\n    elements = np.array(elements)\n\n    # 2. FEM Assembly\n    # Plane stress constitutive matrix D\n    D_factor = E / (1 - nu**2)\n    D = D_factor * np.array([[1, nu, 0],\n                             [nu, 1, 0],\n                             [0, 0, (1 - nu) / 2]])\n\n    # Global stiffness matrix K\n    K = np.zeros((n_dofs, n_dofs))\n\n    for el_nodes in elements:\n        # Node coordinates for the element\n        x1, y1 = nodes[el_nodes[0]]\n        x2, y2 = nodes[el_nodes[1]]\n        x3, y3 = nodes[el_nodes[2]]\n\n        # Area of the element\n        A_e = 0.5 * np.abs(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n\n        # Strain-displacement matrix B\n        B = (1 / (2 * A_e)) * np.array([\n            [y2 - y3, 0, y3 - y1, 0, y1 - y2, 0],\n            [0, x3 - x2, 0, x1 - x3, 0, x2 - x1],\n            [x3 - x2, y2 - y3, x1 - x3, y3 - y1, x2 - x1, y1 - y2]\n        ])\n\n        # Element stiffness matrix Ke\n        Ke = h * A_e * (B.T @ D @ B)\n\n        # Assemble Ke into global K\n        dof_map = np.array([2 * n for n in el_nodes for _ in range(2)])\n        dof_map[1::2] += 1\n        \n        K[np.ix_(dof_map, dof_map)] += Ke\n\n    # 3. Nullspace Analysis for each Test Case\n    \n    def count_nullity(matrix, epsilon=1e-9):\n        \"\"\"\n        Calculates the nullity of a matrix by counting near-zero singular values.\n        \"\"\"\n        s = svdvals(matrix)\n        # svdvals returns sorted values, s[0] is the maximum\n        max_sv = s[0]\n        if np.isclose(max_sv, 0):\n            return matrix.shape[0]  # Zero matrix case\n        \n        tolerance = epsilon * max_sv\n        return np.sum(s  tolerance)\n\n    results = []\n\n    # Test Case 1: Pure Neumann problem\n    nullity1 = count_nullity(K)\n    results.append(nullity1)\n\n    # Test Case 2: Minimal constraints, single node fixed\n    all_dofs = np.arange(n_dofs)\n    # Fix node 0 at (0,0) -> DOFs 0 (u_x) and 1 (u_y)\n    constrained_dofs_2 = [0, 1]\n    free_dofs_2 = np.setdiff1d(all_dofs, constrained_dofs_2)\n    K_red_2 = K[np.ix_(free_dofs_2, free_dofs_2)]\n    nullity2 = count_nullity(K_red_2)\n    results.append(nullity2)\n\n    # Test Case 3: Minimal constraints, rotation removed\n    # Fix node 0 at (0,0) and u_y at node located at (1,0)\n    # Node at (1,0) corresponds to grid indices i=0, j=Ne. \n    # Node index = 0 * (Ne+1) + Ne = Ne\n    node_idx_for_rot_constraint = Ne\n    dof_for_rot_constraint = 2 * node_idx_for_rot_constraint + 1\n    \n    constrained_dofs_3 = [0, 1, dof_for_rot_constraint]\n    free_dofs_3 = np.setdiff1d(all_dofs, constrained_dofs_3)\n    K_red_3 = K[np.ix_(free_dofs_3, free_dofs_3)]\n    nullity3 = count_nullity(K_red_3)\n    results.append(nullity3)\n\n    # Test Case 4: Average constraints via Lagrange multipliers\n    C = np.zeros((2, n_dofs))\n    C[0, 0::2] = 1.0  # Constraint on sum of u_x\n    C[1, 1::2] = 1.0  # Constraint on sum of u_y\n\n    augmented_size = n_dofs + 2\n    M = np.zeros((augmented_size, augmented_size))\n    M[:n_dofs, :n_dofs] = K\n    M[:n_dofs, n_dofs:] = C.T\n    M[n_dofs:, :n_dofs] = C\n    \n    nullity4 = count_nullity(M)\n    results.append(nullity4)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}