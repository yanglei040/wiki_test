{
    "hands_on_practices": [
        {
            "introduction": "本实践将探讨无限小应变张量 $\\boldsymbol{\\varepsilon}$ 与格林-拉格朗日应变张量 $\\mathbf{E}$ 之间的根本区别。通过分析经典的简单剪切变形案例，您将亲手计算这两种应变度量，并量化它们之间的差异。这个练习旨在阐明为何线性应变理论仅适用于小变形情况，并揭示在有限变形下必须考虑非线性效应的原因。",
            "id": "3559282",
            "problem": "在参考构型中，一个均匀单剪切由位移矢量场 $u(X)=\\big(\\gamma\\,X_{2},\\,0,\\,0\\big)$ 给出，其中 $X=\\big(X_{1},X_{2},X_{3}\\big)$ 表示材料坐标，$\\gamma$ 是一个实数的有限常数。严格从位移梯度、变形梯度、无穷小应变张量和格林-拉格朗日应变张量的基本运动学定义出发，完成以下任务：\n\n1. 推导与映射 $x(X)=X+u(X)$ 相关的位移梯度和变形梯度。\n2. 基于这些结果，构建无穷小应变张量 $\\varepsilon$ 和格林-拉格朗日应变张量 $E$。\n3. 为量化有限 $\\gamma$ 值下 $\\varepsilon$ 和 $E$ 之间的差异，定义 $\\Delta(\\gamma)=E-\\varepsilon$ 并给出标量度量\n$$D(\\gamma)=\\|\\Delta(\\gamma)\\|_{F},$$\n其中 $\\|\\cdot\\|_{F}$ 表示弗罗贝尼乌斯范数。请以 $\\gamma$ 的闭式解析表达式形式给出 $D(\\gamma)$。\n\n请将最终答案表示为关于 $\\gamma$ 的单个解析表达式。无需四舍五入。由于应变是无量纲的，因此不需要单位。",
            "solution": "解题过程是根据连续介质力学中的基本定义，系统地计算所需的运动学量。\n\n位移矢量场由 $u(X) = u_1 \\mathbf{e}_1 + u_2 \\mathbf{e}_2 + u_3 \\mathbf{e}_3$ 给出，其分量为：\n$$u_1(X) = \\gamma X_2$$\n$$u_2(X) = 0$$\n$$u_3(X) = 0$$\n\n首先，我们推导位移梯度张量，记为 $\\nabla_X u$。其分量由 $(\\nabla_X u)_{ij} = \\frac{\\partial u_i}{\\partial X_j}$ 给出。\n非零分量是：\n$$\\frac{\\partial u_1}{\\partial X_2} = \\gamma$$\n所有其他偏导数均为零。以矩阵形式表示，位移梯度张量为：\n$$\\nabla_X u = \\begin{pmatrix} \\frac{\\partial u_1}{\\partial X_1}  \\frac{\\partial u_1}{\\partial X_2}  \\frac{\\partial u_1}{\\partial X_3} \\\\ \\frac{\\partial u_2}{\\partial X_1}  \\frac{\\partial u_2}{\\partial X_2}  \\frac{\\partial u_2}{\\partial X_3} \\\\ \\frac{\\partial u_3}{\\partial X_1}  \\frac{\\partial u_3}{\\partial X_2}  \\frac{\\partial u_3}{\\partial X_3} \\end{pmatrix} = \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$$\n\n接下来，我们推导变形梯度张量 $F$。它被定义为 $F = I + \\nabla_X u$，其中 $I$ 是二阶单位张量。\n$$F = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n\n现在，我们构建无穷小应变张量 $\\varepsilon$。它被定义为位移梯度的对称部分：$\\varepsilon = \\frac{1}{2}(\\nabla_X u + (\\nabla_X u)^T)$。\n首先，我们求位移梯度的转置：\n$$(\\nabla_X u)^T = \\begin{pmatrix} 0  0  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix}$$\n然后，我们计算 $\\varepsilon$：\n$$\\varepsilon = \\frac{1}{2}\\left( \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  0  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\gamma}{2}  0 \\\\ \\frac{\\gamma}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix}$$\n\n我们接着构建格林-拉格朗日应变张量 $E$。它由 $E = \\frac{1}{2}(F^T F - I)$ 定义。\n首先，我们计算右柯西-格林 (Cauchy–Green) 变形张量 $C = F^T F$：\n$$F^T = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n$$C = F^T F = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n现在，我们可以求出 $E$：\n$$E = \\frac{1}{2}(C - I) = \\frac{1}{2}\\left( \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  \\gamma^2  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\gamma}{2}  0 \\\\ \\frac{\\gamma}{2}  \\frac{\\gamma^2}{2}  0 \\\\ 0  0  0 \\end{pmatrix}$$\n另外，也可以使用关系式 $E = \\frac{1}{2}(\\nabla_X u + (\\nabla_X u)^T + (\\nabla_X u)^T \\nabla_X u) = \\varepsilon + \\frac{1}{2}(\\nabla_X u)^T \\nabla_X u$。\n\n问题的第三部分要求我们量化 $E$ 和 $\\varepsilon$ 之间的差异。我们定义差值张量 $\\Delta(\\gamma) = E - \\varepsilon$。\n$$\\Delta(\\gamma) = \\begin{pmatrix} 0  \\frac{\\gamma}{2}  0 \\\\ \\frac{\\gamma}{2}  \\frac{\\gamma^2}{2}  0 \\\\ 0  0  0 \\end{pmatrix} - \\begin{pmatrix} 0  \\frac{\\gamma}{2}  0 \\\\ \\frac{\\gamma}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  \\frac{\\gamma^2}{2}  0 \\\\ 0  0  0 \\end{pmatrix}$$\n这个差值张量 $\\Delta(\\gamma) = \\frac{1}{2}(\\nabla_X u)^T \\nabla_X u$ 代表了对格林-拉格朗日应变张量的纯非线性贡献。\n\n最后，我们计算标量度量 $D(\\gamma)$，即 $\\Delta(\\gamma)$ 的弗罗贝尼乌斯范数。矩阵 $A$ 的弗罗贝尼乌斯范数由 $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$ 给出。\n对于张量 $\\Delta(\\gamma)$，除了 $\\Delta_{22} = \\frac{\\gamma^2}{2}$ 外，所有分量均为零。\n因此，弗罗贝尼乌斯范数为：\n$$D(\\gamma) = \\|\\Delta(\\gamma)\\|_F = \\sqrt{0^2 + 0^2 + 0^2 + 0^2 + \\left(\\frac{\\gamma^2}{2}\\right)^2 + 0^2 + 0^2 + 0^2 + 0^2}$$\n$$D(\\gamma) = \\sqrt{\\left(\\frac{\\gamma^2}{2}\\right)^2} = \\sqrt{\\frac{\\gamma^4}{4}}$$\n由于 $\\gamma$ 是一个实数，$\\gamma^2$ 是非负的。因此，我们可以取正平方根：\n$$D(\\gamma) = \\frac{\\gamma^2}{2}$$\n此表达式量化了在这种特定的有限剪切变形下，格林-拉格朗日应变张量和无穷小应变张量之间差异的大小。",
            "answer": "$$\\boxed{\\frac{\\gamma^2}{2}}$$"
        },
        {
            "introduction": "此练习进一步深入探讨有限变形运动学的精妙之处。通过分析一个代表有限转动的位移场，您将发现一个关键概念：即使在直观上没有“拉伸”的情况下，几何精确的格林-拉格朗日应变张量 $\\mathbf{E}$ 也不为零，而线性化应变张量 $\\boldsymbol{\\varepsilon}$ 却为零。这揭示了非线性应变度量如何正确捕捉被线性理论误解为无应变刚体运动的效应。",
            "id": "3559297",
            "problem": "考虑一个处于其参考构型中的均匀体，其物质点的位置向量为 $\\mathbf{X} = (X_{1}, X_{2}, X_{3})$。给定位移矢量场 $\\mathbf{u}(\\mathbf{X})$ 为 $\\mathbf{u}(\\mathbf{X}) = (\\theta X_{2}, -\\theta X_{1}, 0)$，其中 $\\theta$ 是一个有限常数角。当前构型由 $\\mathbf{x}(\\mathbf{X}) = \\mathbf{X} + \\mathbf{u}(\\mathbf{X})$ 给出。使用连续介质力学的基本运动学定义，推导变形梯度 $\\mathbf{F}$ 和格林-拉格朗日应变张量 $\\mathbf{E}$。然后，从右柯西-格林变形张量和无穷小应变张量的定义出发，从第一性原理阐释为什么对于有限的 $\\theta$，格林-拉格朗日应变不为零，尽管从此位移场的位移梯度对称部分计算出的无穷小应变为零。\n\n你的推导必须基于以下定义：\n- 变形梯度定义为 $\\mathbf{F} = \\partial \\mathbf{x} / \\partial \\mathbf{X}$。\n- 右柯西-格林变形张量定义为 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$。\n- 格林-拉格朗日应变张量定义为 $\\mathbf{E} = \\tfrac{1}{2}(\\mathbf{C} - \\mathbf{I})$，其中 $\\mathbf{I}$ 是单位张量。\n- 无穷小（线性化）应变张量为 $\\boldsymbol{\\varepsilon}^{\\text{lin}} = \\tfrac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\mathsf{T}})$。\n\n假设角度 $\\theta$ 以弧度为单位。不需要进行数值四舍五入。将你的最终答案表示为关于 $\\theta$ 的 $3 \\times 3$ 矩阵表达式 $\\mathbf{E}$，并将角度以弧度表示。除了这个最终答案，你的解答还必须推导出 $\\mathbf{F}$ 并包含所要求的解释。",
            "solution": "问题陈述被评估为有效。它在科学上基于连续介质力学，问题设定良好且客观。它提供了推导所求量和阐述解释所需的所有必要定义和数据。\n\n该问题要求针对给定的位移场，推导变形梯度 $\\mathbf{F}$ 和格林-拉格朗日应变张量 $\\mathbf{E}$，并随后解释该场的格林-拉格朗日应变和无穷小应变之间的差异。\n\n参考构型中的位置向量为 $\\mathbf{X} = (X_1, X_2, X_3)$。\n给定的位移矢量场为 $\\mathbf{u}(\\mathbf{X}) = (\\theta X_2, -\\theta X_1, 0)$，其中 $\\theta$ 是一个有限常数。\n当前构型中的位置向量由 $\\mathbf{x}(\\mathbf{X}) = \\mathbf{X} + \\mathbf{u}(\\mathbf{X})$ 给出。\n以分量形式表示，当前坐标 $x_i$ 为：\n$$x_1 = X_1 + u_1(\\mathbf{X}) = X_1 + \\theta X_2$$\n$$x_2 = X_2 + u_2(\\mathbf{X}) = X_2 - \\theta X_1$$\n$$x_3 = X_3 + u_3(\\mathbf{X}) = X_3 + 0 = X_3$$\n\n首先，我们推导变形梯度 $\\mathbf{F}$，其定义为 $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$。\n\n$\\mathbf{F}$ 的分量计算如下：\n$F_{11} = \\frac{\\partial x_1}{\\partial X_1} = \\frac{\\partial}{\\partial X_1}(X_1 + \\theta X_2) = 1$\n$F_{12} = \\frac{\\partial x_1}{\\partial X_2} = \\frac{\\partial}{\\partial X_2}(X_1 + \\theta X_2) = \\theta$\n$F_{13} = \\frac{\\partial x_1}{\\partial X_3} = \\frac{\\partial}{\\partial X_3}(X_1 + \\theta X_2) = 0$\n\n$F_{21} = \\frac{\\partial x_2}{\\partial X_1} = \\frac{\\partial}{\\partial X_1}(X_2 - \\theta X_1) = -\\theta$\n$F_{22} = \\frac{\\partial x_2}{\\partial X_2} = \\frac{\\partial}{\\partial X_2}(X_2 - \\theta X_1) = 1$\n$F_{23} = \\frac{\\partial x_2}{\\partial X_3} = \\frac{\\partial}{\\partial X_3}(X_2 - \\theta X_1) = 0$\n\n$F_{31} = \\frac{\\partial x_3}{\\partial X_1} = \\frac{\\partial}{\\partial X_1}(X_3) = 0$\n$F_{32} = \\frac{\\partial x_3}{\\partial X_2} = \\frac{\\partial}{\\partial X_2}(X_3) = 0$\n$F_{33} = \\frac{\\partial x_3}{\\partial X_3} = \\frac{\\partial}{\\partial X_3}(X_3) = 1$\n\n将这些分量组合成矩阵形式，变形梯度为：\n$$\\mathbf{F} = \\begin{pmatrix} 1  \\theta  0 \\\\ -\\theta  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n\n接下来，我们推导格林-拉格朗日应变张量 $\\mathbf{E}$。这需要右柯西-格林变形张量 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$。\n$\\mathbf{F}$ 的转置为：\n$$\\mathbf{F}^{\\mathsf{T}} = \\begin{pmatrix} 1  -\\theta  0 \\\\ \\theta  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n现在，我们计算矩阵乘积 $\\mathbf{C} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{F}$：\n$$\\mathbf{C} = \\begin{pmatrix} 1  -\\theta  0 \\\\ \\theta  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  \\theta  0 \\\\ -\\theta  1  0 \\\\ 0  0  1 \\end{pmatrix}$$\n$$= \\begin{pmatrix} (1)(1) + (-\\theta)(-\\theta) + (0)(0)  (1)(\\theta) + (-\\theta)(1) + (0)(0)  (1)(0) + (-\\theta)(0) + (0)(1) \\\\ (\\theta)(1) + (1)(-\\theta) + (0)(0)  (\\theta)(\\theta) + (1)(1) + (0)(0)  (\\theta)(0) + (1)(0) + (0)(1) \\\\ (0)(1) + (0)(-\\theta) + (1)(0)  (0)(\\theta) + (0)(1) + (1)(0)  (0)(0) + (0)(0) + (1)(1) \\end{pmatrix}$$\n$$= \\begin{pmatrix} 1 + \\theta^2  0  0 \\\\ 0  1 + \\theta^2  0 \\\\ 0  0  1 \\end{pmatrix}$$\n格林-拉格朗日应变张量定义为 $\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})$，其中 $\\mathbf{I}$ 是二阶单位张量。\n$$\\mathbf{E} = \\frac{1}{2} \\left( \\begin{pmatrix} 1 + \\theta^2  0  0 \\\\ 0  1 + \\theta^2  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right)$$\n$$\\mathbf{E} = \\frac{1}{2} \\begin{pmatrix} \\theta^2  0  0 \\\\ 0  \\theta^2  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}\\theta^2  0  0 \\\\ 0  \\frac{1}{2}\\theta^2  0 \\\\ 0  0  0 \\end{pmatrix}$$\n对于任何有限的非零角 $\\theta$，格林-拉格朗日应变张量 $\\mathbf{E}$ 均不为零。\n\n现在，我们研究无穷小应变张量 $\\boldsymbol{\\varepsilon}^{\\text{lin}}$ 并解释其差异。\n首先，我们计算位移梯度张量 $\\nabla \\mathbf{u}$，其分量为 $(\\nabla \\mathbf{u})_{ij} = \\frac{\\partial u_i}{\\partial X_j}$。\n$u_1 = \\theta X_2$, $u_2 = -\\theta X_1$, $u_3 = 0$。\n$(\\nabla \\mathbf{u})_{11} = \\frac{\\partial u_1}{\\partial X_1} = 0$, $(\\nabla \\mathbf{u})_{12} = \\frac{\\partial u_1}{\\partial X_2} = \\theta$, $(\\nabla \\mathbf{u})_{13} = \\frac{\\partial u_1}{\\partial X_3} = 0$\n$(\\nabla \\mathbf{u})_{21} = \\frac{\\partial u_2}{\\partial X_1} = -\\theta$, $(\\nabla \\mathbf{u})_{22} = \\frac{\\partial u_2}{\\partial X_2} = 0$, $(\\nabla \\mathbf{u})_{23} = \\frac{\\partial u_2}{\\partial X_3} = 0$\n$(\\nabla \\mathbf{u})_{31} = \\frac{\\partial u_3}{\\partial X_1} = 0$, $(\\nabla \\mathbf{u})_{32} = \\frac{\\partial u_3}{\\partial X_2} = 0$, $(\\nabla \\mathbf{u})_{33} = \\frac{\\partial u_3}{\\partial X_3} = 0$\n因此，位移梯度张量为：\n$$\\nabla \\mathbf{u} = \\begin{pmatrix} 0  \\theta  0 \\\\ -\\theta  0  0 \\\\ 0  0  0 \\end{pmatrix}$$\n这个张量是纯反对称的，即 $(\\nabla \\mathbf{u})^{\\mathsf{T}} = -\\nabla \\mathbf{u}$。\n\n无穷小应变张量是位移梯度的对称部分：\n$$\\boldsymbol{\\varepsilon}^{\\text{lin}} = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\mathsf{T}})$$\n代入计算出的 $\\nabla \\mathbf{u}$：\n$$\\boldsymbol{\\varepsilon}^{\\text{lin}} = \\frac{1}{2} \\left( \\begin{pmatrix} 0  \\theta  0 \\\\ -\\theta  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  -\\theta  0 \\\\ \\theta  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\mathbf{0}$$\n所以，无穷小应变为零张量。\n\n对这一看似矛盾的解释在于格林-拉格朗日应变张量 $\\mathbf{E}$ 和无穷小应变张量 $\\boldsymbol{\\varepsilon}^{\\text{lin}}$ 之间的基本关系。这个关系可以通过将 $\\mathbf{F} = \\mathbf{I} + \\nabla \\mathbf{u}$ 代入 $\\mathbf{E}$ 的定义中推导得出。\n$$\\mathbf{E} = \\frac{1}{2}(\\mathbf{F}^{\\mathsf{T}}\\mathbf{F} - \\mathbf{I}) = \\frac{1}{2}((\\mathbf{I} + \\nabla \\mathbf{u})^{\\mathsf{T}}(\\mathbf{I} + \\nabla \\mathbf{u}) - \\mathbf{I})$$\n$$\\mathbf{E} = \\frac{1}{2}((\\mathbf{I} + (\\nabla \\mathbf{u})^{\\mathsf{T}})(\\mathbf{I} + \\nabla \\mathbf{u}) - \\mathbf{I})$$\n$$\\mathbf{E} = \\frac{1}{2}(\\mathbf{I} + \\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\mathsf{T}} + (\\nabla \\mathbf{u})^{\\mathsf{T}} \\nabla \\mathbf{u} - \\mathbf{I})$$\n$$\\mathbf{E} = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^{\\mathsf{T}}) + \\frac{1}{2}(\\nabla \\mathbf{u})^{\\mathsf{T}} \\nabla \\mathbf{u}$$\n将第一项识别为 $\\boldsymbol{\\varepsilon}^{\\text{lin}}$，我们得到：\n$$\\mathbf{E} = \\boldsymbol{\\varepsilon}^{\\text{lin}} + \\frac{1}{2}(\\nabla \\mathbf{u})^{\\mathsf{T}} \\nabla \\mathbf{u}$$\n这个方程表明，格林-拉格朗日应变张量由一个线性部分（即无穷小应变张量）和一个非线性（二次）部分 $\\frac{1}{2}(\\nabla \\mathbf{u})^{\\mathsf{T}} \\nabla \\mathbf{u}$ 组成。\n\n对于给定的问题：\n1.  线性部分 $\\boldsymbol{\\varepsilon}^{\\text{lin}}$ 为零。在线性化理论中，零应变张量意味着刚体运动（平移加旋转）。反对称的位移梯度代表一个无穷小旋转，在线性化理论中被认为是无应变的。\n2.  然而，问题指明 $\\theta$ 是一个*有限*角。这意味着位移梯度并非无穷小，二次项 $(\\nabla \\mathbf{u})^{\\mathsf{T}} \\nabla \\mathbf{u}$ 不能被忽略。\n3.  让我们明确地计算这个非线性项：\n$$(\\nabla \\mathbf{u})^{\\mathsf{T}} \\nabla \\mathbf{u} = \\begin{pmatrix} 0  -\\theta  0 \\\\ \\theta  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  \\theta  0 \\\\ -\\theta  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\theta^2  0  0 \\\\ 0  \\theta^2  0 \\\\ 0  0  0 \\end{pmatrix}$$\n4.  将此代入 $\\mathbf{E}$ 的完整表达式中：\n$$\\mathbf{E} = \\mathbf{0} + \\frac{1}{2} \\begin{pmatrix} \\theta^2  0  0 \\\\ 0  \\theta^2  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}\\theta^2  0  0 \\\\ 0  \\frac{1}{2}\\theta^2  0 \\\\ 0  0  0 \\end{pmatrix}$$\n这个结果与我们最初计算的 $\\mathbf{E}$ 相匹配。\n\n总之，无穷小应变张量 $\\boldsymbol{\\varepsilon}^{\\text{lin}}$ 仅当位移梯度 $\\nabla \\mathbf{u}$ 的所有分量都远小于1时才是一个有效的近似。给定的位移场，当 $\\theta$ 是有限时，代表了一个具有大梯度（特别是大的旋转分量）的变形。线性化应变张量错误地将其记录为无应变的刚体运动。格林-拉格朗日应变张量 $\\mathbf{E}$ 是一个几何上精确的度量，它能正确地考虑由有限旋转和位移引起的非线性。$\\mathbf{E}$ 的非零分量表明，与线性理论的预测相反，给定的位移场确实会引起应变。具体来说，它引起了沿 $X_1$ 和 $X_2$ 方向的拉伸，这被其定义中的二次项所捕捉。这凸显了线性应变理论在存在有限旋转时的根本局限性。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\theta^2  0  0 \\\\\n0  \\frac{1}{2}\\theta^2  0 \\\\\n0  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从理论转向计算实践，最后一个练习介绍了有限元方法中的一个基本验证工具——“分片检验”（Patch Test）。您将设计并实施一个测试，以验证由简单双线性单元（$Q_1$ 单元）组成的网格能否精确再现线性位移场（即恒定应变状态）。这是确保数值方法收敛性的一个必要条件，该实践将连续介质力学中的位移和应变概念与计算力学的核心原理直接联系起来。",
            "id": "3559279",
            "problem": "您必须设计、论证并实现一个二维分片检验，该检验用于在小应变线弹性的背景下，验证在结构化网格上，双线性四边形单元（通常表示为 $Q_{1}$）能够精确再现线性位移矢量场。必须以虚功原理、对称小应变张量的定义，以及平面应力和平面应变的线弹性 Cauchy 应力-应变关系为出发点。您的任务是构建一个计算实验，在该实验中，当边界牵引力从精确应力场一致地导出，且刚体模态受到最小约束时，有限元离散必须能够以机器精度再现精确的线性位移场。\n\n问题设置如下。考虑一个矩形域 $\\Omega = [0,L_{x}] \\times [0,L_{y}]$，由 $Q_{1}$ 双线性四边形单元的结构化网格离散。未知量是位移矢量场 $\\mathbf{u}(x,y) = [u(x,y), v(x,y)]^{\\mathsf{T}}$。假设小应变，其对称应变定义为 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}}\\right)$，单位厚度，无体力，且在边界 $\\partial \\Omega$ 上规定了边界牵引力 $\\mathbf{t} = \\boldsymbol{\\sigma}\\mathbf{n}$，其中 $\\mathbf{n}$ 是外法向单位向量，$\\boldsymbol{\\sigma}$ 是 Cauchy 应力。对于本构行为，使用线弹性：Cauchy 应力 $\\boldsymbol{\\sigma}$ 通过适用于平面应变或平面应力的相应线弹性定律与 $\\boldsymbol{\\varepsilon}$ 相关。所有材料常数必须使用国际单位制（SI单位）：杨氏模量 $E$ 的单位为帕斯卡，泊松比 $\\nu$ 为无量纲。\n\n您的有限元离散必须仅基于：\n- 小应变线弹性的虚功原理。\n- 对称应变张量的定义。\n- 平面应变和平面应力的线弹性 Cauchy 应力-应变关系（胡克定律）。\n- 使用足以精确积分所有出现的多项式的高斯求积进行精确数值积分。\n\n您必须验证对以下形式的线性位移场的精确再现\n$\\displaystyle u(x,y) = a_{0} + a_{1}\\,x + a_{2}\\,y,\\quad v(x,y) = b_{0} + b_{1}\\,x + b_{2}\\,y,$\n其中 $a_{0},a_{1},a_{2},b_{0},b_{1},b_{2}$ 为常数。对于该场，对称应变在 $\\Omega$ 中是恒定的，因此根据胡克定律计算出的应力也是恒定的。使用这个恒定应力来定义 $\\partial \\Omega$ 各部分的边界牵引力 $\\mathbf{t}=\\boldsymbol{\\sigma}\\mathbf{n}$。通过在节点 $(x,y)=(0,0)$ 处规定两个分量的精确位移，并在节点 $(x,y)=(L_{x},0)$ 处规定精确的垂直位移，来消除刚体模态。不允许施加其他位移边界条件。所有其他边界必须是与 $\\mathbf{t}=\\boldsymbol{\\sigma}\\mathbf{n}$ 一致的牵引力边界。假设单位厚度 $t=1$。\n\n实现要求：\n- 使用 $Q_{1}$ 单元、对称小应变-位移矩阵和在每个单元上的精确高斯求积来装配全局刚度矩阵（对内部使用 $2\\times 2$ 高斯法则，对每个边界边使用 $2$ 点高斯法则）。\n- 通过沿边界边积分 $\\mathbf{N}^{\\mathsf{T}}\\mathbf{t}$ 来装配一致的全局牵引力向量，其中 $\\mathbf{N}$ 是边的 $Q_{1}$ 形函数矩阵。\n- 通过在线性系统中以保持对称性的方式进行直接消元（行列修改）来施加位移约束。\n- 求解线性系统以获得节点位移向量，并从规定的线性场计算节点精确位移。\n- 计算所有位移分量上的最大绝对节点位移误差 $\\max_{i}\\lvert U_{i}^{\\text{num}} - U_{i}^{\\text{exact}}\\rvert$。此误差必须以米为单位报告。\n\n测试套件：\n对以下四种情况中的每一种，评估最大绝对节点位移误差。所有长度单位为米，杨氏模量单位为帕斯卡。角度单位不适用。\n\n- 情况 1 (理想路径，单单元，平面应变)：\n  - $N_{x}=1$, $N_{y}=1$, $L_{x}=1.0$, $L_{y}=1.0$, $E=1.00\\times 10^{3}$, $\\nu=0.30$, 平面应变。\n  - 系数：$a_{0}=0.10$, $a_{1}=0.20$, $a_{2}=-0.30$, $b_{0}=-0.05$, $b_{1}=0.40$, $b_{2}=0.25$。\n\n- 情况 2 (矩形网格，平面应力)：\n  - $N_{x}=2$, $N_{y}=3$, $L_{x}=2.0$, $L_{y}=1.0$, $E=2.10\\times 10^{5}$, $\\nu=0.29$, 平面应力。\n  - 系数：$a_{0}=-0.02$, $a_{1}=0.15$, $a_{2}=0.05$, $b_{0}=0.03$, $b_{1}=-0.10$, $b_{2}=0.12$。\n\n- 情况 3 (高纵横比单元，平面应变)：\n  - $N_{x}=4$, $N_{y}=1$, $L_{x}=8.0$, $L_{y}=1.0$, $E=7.00\\times 10^{4}$, $\\nu=0.33$, 平面应变。\n  - 系数：$a_{0}=0.00$, $a_{1}=0.05$, $a_{2}=1.50$, $b_{0}=0.01$, $b_{1}=-1.20$, $b_{2}=0.02$。\n\n- 情况 4 (中等网格，平面应力)：\n  - $N_{x}=3$, $N_{y}=3$, $L_{x}=1.5$, $L_{y}=1.5$, $E=3.00\\times 10^{5}$, $\\nu=0.25$, 平面应力。\n  - 系数：$a_{0}=0.005$, $a_{1}=-0.08$, $a_{2}=0.06$, $b_{0}=-0.01$, $b_{1}=0.07$, $b_{2}=-0.09$。\n\n最终输出规范：\n- 您的程序必须为四种情况中的每一种计算最大绝对节点位移误差（以米为单位），并表示为浮点数。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[r_{1},r_{2},r_{3},r_{4}]$，其中 $r_{k}$ 是情况 $k$ 的结果。",
            "solution": "所提出的问题是计算固体力学中一个经典的验证程序，称为分片检验。其目的是验证有限元公式能否精确再现恒定应变状态。对于基于位移的有限元方法，这是收敛的必要条件。该问题是适定的，科学上是合理的，并为构建有效的计算实验提供了所有必要信息。我们将开始进行求解。\n\n### 1. 理论基础：虚功原理\n\n有限元模型的基础是虚功原理（PVW），它代表了力学平衡方程的弱形式。对于占据域 $\\Omega$、承受体力 $\\mathbf{f}$ 和在边界部分 $\\partial\\Omega_t$ 上承受表面牵引力 $\\mathbf{t}$ 的物体，虚功原理指出，对于任何运动学容许的虚位移场 $\\delta\\mathbf{u}$，内虚功必须等于外虚功：\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} \\, dV = \\int_{\\Omega} \\mathbf{f} \\cdot \\delta\\mathbf{u} \\, dV + \\int_{\\partial\\Omega_t} \\mathbf{t} \\cdot \\delta\\mathbf{u} \\, dS\n$$\n在此，$\\boldsymbol{\\sigma}$ 是 Cauchy 应力张量，$\\delta\\boldsymbol{\\varepsilon}$ 是虚应变张量，定义为虚位移梯度的对称部分，$\\delta\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla(\\delta\\mathbf{u}) + (\\nabla(\\delta\\mathbf{u}))^{\\mathsf{T}})$。问题指定了无体力（$\\mathbf{f}=\\mathbf{0}$）和单位厚度，因此体积分和面积分分别简化为面积分和线积分：\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} \\, dA = \\int_{\\partial\\Omega_t} \\mathbf{t} \\cdot \\delta\\mathbf{u} \\, dL\n$$\n\n### 2. 有限元离散\n\n我们将域 $\\Omega$ 离散为不重叠的双线性四边形单元（$Q_1$）网格。在每个单元 $e$ 内，位移场 $\\mathbf{u}(\\mathbf{x})$ 通过使用形函数 $\\mathbf{N}(\\mathbf{x})$ 插值节点位移 $\\mathbf{d}^e$ 来近似：\n$$\n\\mathbf{u}(\\mathbf{x}) \\approx \\mathbf{u}^h(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\mathbf{d}^e\n$$\n对于一个有四个节点的 $Q_1$ 单元，矩阵的结构如下：\n$$\n\\mathbf{N} = \\begin{bmatrix} N_1  0  N_2  0  N_3  0  N_4  0 \\\\ 0  N_1  0  N_2  0  N_3  0  N_4 \\end{bmatrix}, \\quad \\mathbf{d}^e = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^{\\mathsf{T}}\n$$\n其中 $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i \\xi)(1+\\eta_i \\eta)$ 是在父单元域 $[-1, 1] \\times [-1, 1]$ 上的双线性形函数。\n\n小应变张量 $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf{T}}$（使用工程剪切应变 $\\gamma_{xy} = 2\\varepsilon_{xy}$）通过应变-位移矩阵 $\\mathbf{B}$ 与节点位移相关联：\n$$\n\\boldsymbol{\\varepsilon}^h = \\mathbf{B} \\mathbf{d}^e, \\quad \\text{其中} \\quad \\mathbf{B}_i = \\begin{bmatrix} \\partial N_i/\\partial x  0 \\\\ 0  \\partial N_i/\\partial y \\\\ \\partial N_i/\\partial y  \\partial N_i/\\partial x \\end{bmatrix} \\quad \\text{且} \\quad \\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4]\n$$\n相对于物理坐标 $(x,y)$ 的导数是使用链式法则和等参映射的雅可比矩阵求得的：$\\left\\{\\partial N_i/\\partial x, \\partial N_i/\\partial y\\right\\}^{\\mathsf{T}} = \\mathbf{J}^{-1} \\left\\{\\partial N_i/\\partial \\xi, \\partial N_i/\\partial \\eta\\right\\}^{\\mathsf{T}}$。对于指定的结构化矩形网格，雅可比矩阵 $\\mathbf{J}$ 在每个单元内是恒定的。\n\n本构关系是胡克定律，$\\boldsymbol{\\sigma} = \\mathbf{D}\\boldsymbol{\\varepsilon}$，其中 $\\mathbf{D}$ 是材料弹性矩阵。对于**平面应变**：\n$$\n\\mathbf{D}_{\\text{strain}} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{bmatrix} 1-\\nu  \\nu  0 \\\\ \\nu  1-\\nu  0 \\\\ 0  0  \\frac{1-2\\nu}{2} \\end{bmatrix}\n$$\n而对于**平面应力**：\n$$\n\\mathbf{D}_{\\text{stress}} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix}\n$$\n将有限元近似代入虚功原理，并注意到它对任意虚位移 $\\delta\\mathbf{d}$ 都成立，我们得到离散化系统 $\\mathbf{K}\\mathbf{U} = \\mathbf{F}$，其中 $\\mathbf{U}$ 是全局节点位移向量。单元刚度矩阵 $\\mathbf{k}^e$ 和全局刚度矩阵 $\\mathbf{K}$ 由下式装配而成：\n$$\n\\mathbf{k}^e = \\int_{\\Omega_e} \\mathbf{B}^{\\mathsf{T}} \\mathbf{D} \\mathbf{B} \\, t \\, dA\n$$\n问题指定了单位厚度 $t=1$。该积分使用 $2 \\times 2$ 高斯求积法则进行数值计算，这足以对矩形单元产生的多项式被积函数进行精确积分。\n\n### 3. 分片检验设置\n\n分片检验的本质是应用从已知精确解派生的边界条件，而单元应该能够再现该解。在这里，目标是一个线性位移场：\n$$\nu(x,y) = a_0 + a_1 x + a_2 y \\quad , \\quad v(x,y) = b_0 + b_1 x + b_2 y\n$$\n该场在整个域 $\\Omega$ 内产生一个恒定的应变状态：\n$$\n\\boldsymbol{\\varepsilon}_{\\text{exact}} = \\begin{Bmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{Bmatrix} = \\begin{Bmatrix} \\partial u / \\partial x \\\\ \\partial v / \\partial y \\\\ \\partial u / \\partial y + \\partial v / \\partial x \\end{Bmatrix} = \\begin{Bmatrix} a_1 \\\\ b_2 \\\\ a_2 + b_1 \\end{Bmatrix}\n$$\n相应的 Cauchy 应力，$\\boldsymbol{\\sigma}_{\\text{exact}} = \\mathbf{D} \\boldsymbol{\\varepsilon}_{\\text{exact}}$，也是恒定的。这个恒定应力被用来定义整个边界 $\\partial\\Omega$ 上的牵引力 $\\mathbf{t} = \\boldsymbol{\\sigma}_{\\text{exact}} \\mathbf{n}$，其中 $\\mathbf{n}$ 是外法向单位向量。\n\n外力向量 $\\mathbf{F}$ 是由从这些牵引力派生的一致节点力装配而成的。对于一个边界边，单元力向量为：\n$$\n\\mathbf{f}^e_{\\text{ext}} = \\int_{\\text{edge}} \\mathbf{N}^{\\mathsf{T}} \\mathbf{t} \\, t \\, dL\n$$\n这个积分是使用沿每个边界边的 2 点高斯法则计算的。对于长度为 $L_{edge}$ 的直边上的恒定牵引力 $\\mathbf{t}$，该积分将总力 $\\mathbf{t} L_{edge}$ 平均分配给该边的两个节点。\n\n### 4. 系统求解与验证\n\n全局系统 $\\mathbf{K}\\mathbf{U}=\\mathbf{F}$ 是奇异的，因为仅有牵引力的边界条件不能排除刚体运动（二维中的两次平移和一次旋转）。为了获得唯一解，我们必须施加最小位移边界条件。问题指定：\n1. $u(0,0) = a_0$\n2. $v(0,0) = b_0$\n3. $v(L_x,0) = b_0 + b_1 L_x$\n\n这三个约束足以消除三个刚体模态。它们通过一种保持刚度矩阵对称性的直接消元法施加于线性系统。这涉及到修改与受约束自由度（DOF）对应的 $\\mathbf{K}$ 的行和列，并相应地调整力向量 $\\mathbf{F}$。对于一个规定的自由度 $U_k = d$：\n1. 对于所有自由自由度 $i$，更新力分量： $F_i \\leftarrow F_i - K_{ik} d$。\n2. 将矩阵的第 $k$ 行和第 $k$ 列设为零，即 $K_{ik} = K_{ki} = 0$ 对于 $i \\neq k$。\n3. 将对角线元素设为 1：$K_{kk} \\leftarrow 1$。\n4. 将力分量设为规定值：$F_k \\leftarrow d$。\n\n在求解修正后的系统得到数值节点位移 $\\mathbf{U}_{\\text{num}}$ 后，我们将它们与精确节点位移 $\\mathbf{U}_{\\text{exact}}$ 进行比较，后者是通过在每个节点的坐标处评估线性位移场计算得出的。如果最大绝对误差在机器精度量级，则验证成功：\n$$\n\\text{Error} = \\max_{i} | (U_{\\text{num}})_i - (U_{\\text{exact}})_i | \\approx 0\n$$\n\n该程序被系统地应用于所提供的四个测试案例。",
            "answer": "```python\nimport numpy as np\n\ndef get_constitutive_matrix(E, nu, case_type):\n    \"\"\"\n    Constructs the 2D linear elastic constitutive matrix D.\n    \n    Args:\n        E (float): Young's modulus.\n        nu (float): Poisson's ratio.\n        case_type (str): 'plane_strain' or 'plane_stress'.\n\n    Returns:\n        np.ndarray: The 3x3 constitutive matrix.\n    \"\"\"\n    if case_type == 'plane_strain':\n        factor = E / ((1 + nu) * (1 - 2 * nu))\n        D = factor * np.array([\n            [1 - nu, nu, 0],\n            [nu, 1 - nu, 0],\n            [0, 0, (1 - 2 * nu) / 2]\n        ])\n    elif case_type == 'plane_stress':\n        factor = E / (1 - nu**2)\n        D = factor * np.array([\n            [1, nu, 0],\n            [nu, 1, 0],\n            [0, 0, (1 - nu) / 2]\n        ])\n    else:\n        raise ValueError(\"Invalid case_type. Must be 'plane_strain' or 'plane_stress'.\")\n    return D\n\ndef get_shape_func_derivs_parent(xi, eta):\n    \"\"\"\n    Computes derivatives of Q1 shape functions with respect to parent coordinates.\n    Node ordering is counter-clockwise from bottom-left: (-1,-1), (1,-1), (1,1), (-1,1).\n    \"\"\"\n    dN_dxi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n    dN_deta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)])\n    return dN_dxi, dN_deta\n\ndef solve_patch_test_case(params):\n    \"\"\"\n    Runs a single patch test case.\n    \"\"\"\n    Nx, Ny, Lx, Ly, E, nu, case_type, coeffs = params\n    a0, a1, a2, b0, b1, b2 = coeffs\n\n    # 1. Mesh Generation\n    num_nodes_x = Nx + 1\n    num_nodes_y = Ny + 1\n    num_nodes = num_nodes_x * num_nodes_y\n    num_elements = Nx * Ny\n    \n    nodes = np.zeros((num_nodes, 2))\n    for j in range(num_nodes_y):\n        for i in range(num_nodes_x):\n            node_idx = j * num_nodes_x + i\n            nodes[node_idx] = [i * Lx / Nx, j * Ly / Ny]\n\n    elements = np.zeros((num_elements, 4), dtype=int)\n    for j in range(Ny):\n        for i in range(Nx):\n            el_idx = j * Nx + i\n            n1 = j * num_nodes_x + i        # bottom-left\n            n2 = j * num_nodes_x + i + 1    # bottom-right\n            n3 = (j + 1) * num_nodes_x + i + 1  # top-right\n            n4 = (j + 1) * num_nodes_x + i      # top-left\n            elements[el_idx] = [n1, n2, n3, n4]\n\n    # 2. Exact Solution  Material Properties\n    eps_exact = np.array([a1, b2, a2 + b1]) # [exx, eyy, gxy]\n    D = get_constitutive_matrix(E, nu, case_type)\n    sigma_exact = D @ eps_exact\n\n    # 3. Assembly of Global Stiffness Matrix K\n    num_dofs = 2 * num_nodes\n    K = np.zeros((num_dofs, num_dofs))\n    \n    gp_loc = 1.0 / np.sqrt(3)\n    gauss_points = [(-gp_loc, -gp_loc), (gp_loc, -gp_loc), (gp_loc, gp_loc), (-gp_loc, gp_loc)]\n    gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n    hx, hy = Lx / Nx, Ly / Ny\n    \n    # Pre-calculate for rectangular elements\n    J = np.array([[hx / 2, 0], [0, hy / 2]])\n    detJ = np.linalg.det(J)\n    invJ = np.linalg.inv(J)\n\n    for el_nodes_indices in elements:\n        ke = np.zeros((8, 8))\n        for gp, w in zip(gauss_points, gauss_weights):\n            xi, eta = gp\n            dN_dxi, dN_deta = get_shape_func_derivs_parent(xi, eta)\n            \n            dN_dx_dy = invJ @ np.vstack((dN_dxi, dN_deta))\n            dN_dx = dN_dx_dy[0, :]\n            dN_dy = dN_dx_dy[1, :]\n\n            B = np.zeros((3, 8))\n            B[0, 0::2] = dN_dx\n            B[1, 1::2] = dN_dy\n            B[2, 0::2] = dN_dy\n            B[2, 1::2] = dN_dx\n            \n            ke += B.T @ D @ B * detJ * w\n        \n        dof_indices = np.ravel([[2 * n, 2 * n + 1] for n in el_nodes_indices])\n        K[np.ix_(dof_indices, dof_indices)] += ke\n\n    # 4. Assembly of Global Force Vector F\n    F = np.zeros(num_dofs)\n    boundary_edges = {\n        'bottom': [(j * num_nodes_x + i, j * num_nodes_x + i + 1) for j in range(Ny) for i in range(Nx) if j == 0],\n        'right': [(j * num_nodes_x + i + 1, (j + 1) * num_nodes_x + i + 1) for j in range(Ny) for i in range(Nx) if i == Nx - 1],\n        'top': [((j + 1) * num_nodes_x + i, (j + 1) * num_nodes_x + i + 1) for j in range(Ny) for i in range(Nx) if j == Ny - 1],\n        'left': [(j * num_nodes_x + i, (j + 1) * num_nodes_x + i) for j in range(Ny) for i in range(Nx) if i == 0]\n    }\n    # Correct order for outward normal\n    boundary_edges['top'] = [(n2, n1) for n1, n2 in boundary_edges['top']]\n    boundary_edges['left'] = [(n2, n1) for n1, n2 in boundary_edges['left']]\n\n    normals = {'bottom': np.array([0, -1]),'right': np.array([1, 0]),'top': np.array([0, 1]),'left': np.array([-1, 0])}\n    edge_lengths = {'bottom': hx, 'top': hx, 'left': hy, 'right': hy}\n\n    for side, edges in boundary_edges.items():\n        if not edges: continue\n        traction = np.array([sigma_exact[0]*normals[side][0] + sigma_exact[2]*normals[side][1],\n                             sigma_exact[2]*normals[side][0] + sigma_exact[1]*normals[side][1]])\n        force_per_node = traction * edge_lengths[side] / 2.0\n        for n1, n2 in edges:\n            F[2 * n1:2 * n1 + 2] += force_per_node\n            F[2 * n2:2 * n2 + 2] += force_per_node\n\n    # 5. Apply Displacement Boundary Conditions\n    node_0_idx = 0\n    node_Lx0_idx = Nx\n    \n    u0 = a0 + a1 * nodes[node_0_idx, 0] + a2 * nodes[node_0_idx, 1]\n    v0 = b0 + b1 * nodes[node_0_idx, 0] + b2 * nodes[node_0_idx, 1]\n    vLx0 = b0 + b1 * nodes[node_Lx0_idx, 0] + b2 * nodes[node_Lx0_idx, 1]\n\n    prescribed_dofs = {\n        2 * node_0_idx: u0,            # u(0,0)\n        2 * node_0_idx + 1: v0,        # v(0,0)\n        2 * node_Lx0_idx + 1: vLx0     # v(Lx,0)\n    }\n    \n    free_dofs = np.setdiff1d(np.arange(num_dofs), list(prescribed_dofs.keys()))\n    \n    for dof, val in prescribed_dofs.items():\n        F[free_dofs] -= K[free_dofs, dof] * val\n    \n    for dof, val in prescribed_dofs.items():\n        K[dof, :] = 0\n        K[:, dof] = 0\n        K[dof, dof] = 1\n        F[dof] = val\n\n    # 6. Solve and Compute Error\n    U_num = np.linalg.solve(K, F)\n    \n    U_exact = np.zeros(num_dofs)\n    for i in range(num_nodes):\n        x, y = nodes[i, 0], nodes[i, 1]\n        U_exact[2 * i] = a0 + a1 * x + a2 * y\n        U_exact[2 * i + 1] = b0 + b1 * x + b2 * y\n        \n    error = np.max(np.abs(U_num - U_exact))\n    return error\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {'Nx': 1, 'Ny': 1, 'Lx': 1.0, 'Ly': 1.0, 'E': 1.00e3, 'nu': 0.30, 'type': 'plane_strain', \n         'coeffs': (0.10, 0.20, -0.30, -0.05, 0.40, 0.25)},\n        # Case 2\n        {'Nx': 2, 'Ny': 3, 'Lx': 2.0, 'Ly': 1.0, 'E': 2.10e5, 'nu': 0.29, 'type': 'plane_stress',\n         'coeffs': (-0.02, 0.15, 0.05, 0.03, -0.10, 0.12)},\n        # Case 3\n        {'Nx': 4, 'Ny': 1, 'Lx': 8.0, 'Ly': 1.0, 'E': 7.00e4, 'nu': 0.33, 'type': 'plane_strain',\n         'coeffs': (0.00, 0.05, 1.50, 0.01, -1.20, 0.02)},\n        # Case 4\n        {'Nx': 3, 'Ny': 3, 'Lx': 1.5, 'Ly': 1.5, 'E': 3.00e5, 'nu': 0.25, 'type': 'plane_stress',\n         'coeffs': (0.005, -0.08, 0.06, -0.01, 0.07, -0.09)}\n    ]\n    \n    results = []\n    for case in test_cases:\n        params = (case['Nx'], case['Ny'], case['Lx'], case['Ly'], case['E'], case['nu'], case['type'], case['coeffs'])\n        result = solve_patch_test_case(params)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}