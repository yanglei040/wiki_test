{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础练习开始，它旨在将位移场的抽象数学描述与应变的具体物理意义联系起来。通过分析一个简单的线性位移场，你将练习从位移梯度直接计算无穷小应变张量和体积应变 。这项实践有助于建立对材料在拉伸、压缩和体积变化等基本变形模式下的直观理解。",
            "id": "2620349",
            "problem": "考虑一个线性弹性、均匀且单连通的实体，其正在经历小变形，因此线性化运动学有效。位移场被规定为 $u_{x}(x,y,z)=a\\,x$，$u_{y}(x,y,z)=b\\,y$，$u_{z}(x,y,z)=c\\,z$，其中 $a$、$b$ 和 $c$ 是常实数参数，满足 $|a|,|b|,|c|\\ll 1$。从位移梯度、无穷小应变张量和无穷小旋转张量的基本定义出发，完成以下任务：计算无穷小应变张量的所有分量，计算体积应变（定义为无穷小应变张量的迹），计算无穷小旋转张量以评估变形是否为无旋的，并通过陈述 $a$、$b$ 和 $c$ 在何种代数条件下变形是纯膨胀、等体积畸变或一般三轴拉伸，来根据其体积和畸变特性对变形进行分类。仅使用适用于小应变弹性静力学的平衡和运动学原理；不要引用任何有限变形度量。为评分目的，仅报告体积应变的符号表达式作为最终答案，该表达式为无量纲。无需四舍五入，也无需报告物理单位。",
            "solution": "所给问题是有效的，是连续介质运动学中的一个基本练习。该问题是适定的，科学上是合理的，并包含足够的信息以获得唯一解。我们将进行严格的推导。\n\n位移场在笛卡尔坐标系 $(x, y, z)$ 中以 $\\mathbf{u}(x,y,z)$ 的形式给出。其分量由下式给出：\n$u_x(x,y,z) = a\\,x$\n$u_y(x,y,z) = b\\,y$\n$u_z(x,y,z) = c\\,z$\n其中 $a$、$b$ 和 $c$ 是小的实常数，满足 $|a|, |b|, |c| \\ll 1$。这一条件证明了使用线性化（或无穷小）应变理论的合理性。\n\n首先，我们计算位移梯度张量 $\\mathbf{H}$，其分量 $H_{ij}$ 定义为位移分量对空间坐标的偏导数，$H_{ij} = \\frac{\\partial u_i}{\\partial x_j}$。令 $x_1=x$，$x_2=y$，$x_3=z$。\n\n$\\mathbf{H}$ 的分量为：\n$H_{11} = \\frac{\\partial u_x}{\\partial x} = \\frac{\\partial(a\\,x)}{\\partial x} = a$\n$H_{22} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial(b\\,y)}{\\partial y} = b$\n$H_{33} = \\frac{\\partial u_z}{\\partial z} = \\frac{\\partial(c\\,z)}{\\partial z} = c$\n\n所有非对角分量均为零，例如：\n$H_{12} = \\frac{\\partial u_x}{\\partial y} = \\frac{\\partial(a\\,x)}{\\partial y} = 0$\n$H_{21} = \\frac{\\partial u_y}{\\partial x} = \\frac{\\partial(b\\,y)}{\\partial x} = 0$\n这对所有 $i \\neq j$ 都成立。因此，位移梯度张量是一个对角矩阵：\n$$\n\\mathbf{H} = \\begin{pmatrix} a  0  0 \\\\ 0  b  0 \\\\ 0  0  c \\end{pmatrix}\n$$\n位移梯度张量 $\\mathbf{H}$ 可以分解为一个对称部分（无穷小应变张量 $\\boldsymbol{\\varepsilon}$）和一个反对称部分（无穷小旋转张量 $\\boldsymbol{\\omega}$）。这是二阶张量的基本亥姆霍兹分解（Helmholtz decomposition）：$\\mathbf{H} = \\boldsymbol{\\varepsilon} + \\boldsymbol{\\omega}$。\n\n无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 定义为 $\\varepsilon_{ij} = \\frac{1}{2} (H_{ij} + H_{ji})$。由于我们计算出的 $\\mathbf{H}$ 已经是一个对称矩阵（$H_{ij} = H_{ji}$），其反对称部分为零，而对称部分就是它自身。\n因此，无穷小应变张量与位移梯度张量相同：\n$$\n\\boldsymbol{\\varepsilon} = \\mathbf{H} = \\begin{pmatrix} a  0  0 \\\\ 0  b  0 \\\\ 0  0  c \\end{pmatrix}\n$$\n应变张量的分量为：\n$\\varepsilon_{xx} = a$，$\\varepsilon_{yy} = b$，$\\varepsilon_{zz} = c$。\n剪切应变分量全为零：$\\varepsilon_{xy} = \\varepsilon_{yz} = \\varepsilon_{zx} = 0$。\n\n接下来，我们计算体积应变 $\\varepsilon_V$，它被定义为无穷小应变张量的迹，$\\varepsilon_V = \\text{tr}(\\boldsymbol{\\varepsilon})$。\n$$\n\\varepsilon_V = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}\n$$\n代入我们已求出的分量：\n$$\n\\varepsilon_V = a + b + c\n$$\n这个量表示单位初始体积的无穷小体积变化。\n\n无穷小旋转张量 $\\boldsymbol{\\omega}$ 定义为 $\\omega_{ij} = \\frac{1}{2} (H_{ij} - H_{ji})$。由于 $\\mathbf{H}$ 是对称的，$\\boldsymbol{\\omega}$ 的所有分量恒为零。\n$$\n\\boldsymbol{\\omega} = \\frac{1}{2} (\\mathbf{H} - \\mathbf{H}^T) = \\frac{1}{2} \\begin{pmatrix} a-a  0-0  0-0 \\\\ 0-0  b-b  0-0 \\\\ 0-0  0-0  c-c \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n旋转张量为零表示变形是无旋的。这种变形也称为纯应变或纯拉伸。\n\n最后，我们对变形进行分类。应变张量 $\\boldsymbol{\\varepsilon}$ 可以分解为一个球量部分（与体积变化相关）和一个偏量部分（与形状变化或畸变相关）。\n$\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}_{\\text{spherical}} + \\boldsymbol{\\varepsilon}_{\\text{deviatoric}}$\n球量部分由 $\\frac{1}{3}\\text{tr}(\\boldsymbol{\\varepsilon})\\mathbf{I} = \\frac{1}{3}(a+b+c)\\mathbf{I}$ 给出。\n偏量部分是 $\\boldsymbol{\\varepsilon}' = \\boldsymbol{\\varepsilon} - \\frac{1}{3}\\text{tr}(\\boldsymbol{\\varepsilon})\\mathbf{I}$。\n$$\n\\boldsymbol{\\varepsilon}' = \\frac{1}{3} \\begin{pmatrix} 2a-b-c  0  0 \\\\ 0  2b-a-c  0 \\\\ 0  0  2c-a-b \\end{pmatrix}\n$$\n变形分类如下：\n$1$. **纯膨胀**：纯粹的体积变化，没有畸变。这发生在偏应变张量为零时，$\\boldsymbol{\\varepsilon}' = \\mathbf{0}$。这要求 $\\boldsymbol{\\varepsilon}'$ 的所有对角元素都为零，从而得出条件 $a=b=c$。在这种情况下，所有方向上都有均匀的膨胀或收缩。\n\n$2$. **等体积畸变**：纯粹的形状畸变变化，没有体积变化。“等体积”意味着体积保持不变。这发生在体积应变为零时，$\\varepsilon_V = 0$。因此，代数条件是 $a+b+c=0$。\n\n$3$. **一般三轴拉伸**：这是该变形场最一般的情况，既有体积变化，也有形状变化。这发生在上述两个特殊条件均不满足时，即当 $(a,b,c)$ 不全相等且 $a+b+c \\neq 0$。\n\n问题要求一个单一的最终答案，即体积应变的符号表达式。",
            "answer": "$$\\boxed{a+b+c}$$"
        },
        {
            "introduction": "在掌握了应变的基本计算之后，下一个关键问题是理解无穷小应变理论的适用范围。无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 是对更普适的格林-拉格朗日有限应变张量 $\\boldsymbol{E}$ 在小变形假设下的线性近似 。这个练习通过对简单剪切变形的分析，让你能够量化这两种应变度量之间的差异，从而深刻理解“小变形”假设的精确含义及其有效边界。",
            "id": "3574328",
            "problem": "一个均匀的三维连续体经历简单剪切，其特征在于位移场 $\\boldsymbol{u}(\\boldsymbol{X}) = (\\gamma\\,Y, 0, 0)$，其中 $\\boldsymbol{X} = (X, Y, Z)$ 表示参考构型中的物质坐标，$\\gamma$ 是一个无量纲剪切参数。从连续介质力学的核心运动学定义出发，即变形梯度 $\\boldsymbol{F}$ 定义为 $\\boldsymbol{F} = \\boldsymbol{I} + \\nabla \\boldsymbol{u}$，右 Cauchy-Green 变形张量 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$，Green-Lagrange 应变张量 $\\boldsymbol{E} = \\tfrac{1}{2}(\\boldsymbol{C} - \\boldsymbol{I})$，以及无穷小应变张量 $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}}\\right)$，执行以下任务：\n\n1. 对给定的简单剪切位移，推导 $\\boldsymbol{F}$、$\\boldsymbol{C}$、$\\boldsymbol{E}$ 和 $\\boldsymbol{\\varepsilon}$。\n2. 显式计算张量差 $\\boldsymbol{E} - \\boldsymbol{\\varepsilon}$。\n3. 使用 Frobenius 范数 $\\|\\boldsymbol{A}\\|_{F} = \\sqrt{\\mathrm{tr}(\\boldsymbol{A}^{\\mathsf{T}}\\boldsymbol{A})}$，求得闭式解析表达式 $r(\\gamma) = \\|\\boldsymbol{E} - \\boldsymbol{\\varepsilon}\\|_{F} \\big/ \\|\\boldsymbol{\\varepsilon}\\|_{F}$。\n4. 确定使 $r(\\gamma)  0.01$ 成立的 $\\gamma$ 的完整范围。\n\n请给出 $r(\\gamma)$ 的解析表达式以及 $\\gamma$ 的容许区间的两个端点作为最终答案。不需要进行数值四舍五入；要求提供精确的符号表达式。由于应变是无量纲的，最终答案中不需要物理单位。",
            "solution": "用户提供了一个连续介质力学领域的问题。\n\n基于以下评估，该问题被认为是 **有效的**：\n- **科学与事实的可靠性**：问题陈述牢固地建立在固体力学中既定的运动学原理之上。所有给出的定义——变形梯度 $\\boldsymbol{F}$、右 Cauchy-Green 变形张量 $\\boldsymbol{C}$、Green-Lagrange 应变张量 $\\boldsymbol{E}$ 和无穷小应变张量 $\\boldsymbol{\\varepsilon}$——都是标准且正确的。\n- **完整性与一致性**：该问题是自洽的。它提供了所有必要的信息，包括位移场和所需张量的定义。没有内部矛盾。\n- **适定性与客观性**：任务明确，导向一个唯一的、定义明确的数学解。语言客观且无歧义。\n\n该问题没有表现出任何与不可形式化、不切实际、不适定、伪深刻或超出科学可验证范围相关的缺陷。因此，将提供一个合理的解答。\n\n解答过程将按照问题陈述中指定的四个任务进行。\n\n给定的位移场为 $\\boldsymbol{u}(\\boldsymbol{X}) = (\\gamma\\,Y, 0, 0)$，其中 $\\boldsymbol{X} = (X, Y, Z)$ 表示物质坐标。用分量形式表示，我们有 $u_1 = \\gamma Y$，$u_2 = 0$ 和 $u_3 = 0$。\n\n**任务1：推导 $\\boldsymbol{F}$、$\\boldsymbol{C}$、$\\boldsymbol{E}$ 和 $\\boldsymbol{\\varepsilon}$**\n\n首先，我们计算位移梯度张量 $\\nabla \\boldsymbol{u}$，其分量由 $(\\nabla \\boldsymbol{u})_{ij} = \\frac{\\partial u_i}{\\partial X_j}$ 给出。\n偏导数为：\n$\\frac{\\partial u_1}{\\partial X} = 0$，$\\frac{\\partial u_1}{\\partial Y} = \\gamma$，$\\frac{\\partial u_1}{\\partial Z} = 0$。\n由于 $u_2$ 和 $u_3$ 为零，所有其他偏导数都为零。\n相对于 $(X, Y, Z)$ 基，位移梯度的矩阵形式为：\n$$ \\nabla \\boldsymbol{u} = \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n变形梯度 $\\boldsymbol{F}$ 定义为 $\\boldsymbol{F} = \\boldsymbol{I} + \\nabla \\boldsymbol{u}$，其中 $\\boldsymbol{I}$ 是二阶单位张量。\n$$ \\boldsymbol{F} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n右 Cauchy-Green 变形张量 $\\boldsymbol{C}$ 定义为 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$。\n$$ \\boldsymbol{F}^{\\mathsf{T}} = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n$$ \\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F} = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix} $$\nGreen-Lagrange 应变张量 $\\boldsymbol{E}$ 定义为 $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{C} - \\boldsymbol{I})$。\n$$ \\boldsymbol{E} = \\frac{1}{2} \\left( \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  \\gamma^2  0 \\\\ 0  0  0 \\end{pmatrix} $$\n无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 定义为位移梯度的对称部分：$\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}}\\right)$。\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\left( \\begin{pmatrix} 0  \\gamma  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  0  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n\n**任务2：计算张量差 $\\boldsymbol{E} - \\boldsymbol{\\varepsilon}$**\n\n使用任务1的结果，我们从 $\\boldsymbol{E}$ 中减去 $\\boldsymbol{\\varepsilon}$。\n$$ \\boldsymbol{E} - \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  \\gamma^2  0 \\\\ 0  0  0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 0  0  0 \\\\ 0  \\gamma^2  0 \\\\ 0  0  0 \\end{pmatrix} $$\n这个差值表示应变定义中被无穷小应变理论所忽略的高阶（非线性）项。对于简单剪切，该项为 $\\frac{1}{2}(\\nabla \\boldsymbol{u})^{\\mathsf{T}}(\\nabla\\boldsymbol{u})$。\n\n**任务3：求得 $r(\\gamma)$ 的表达式**\n\n比率 $r(\\gamma)$ 定义为 $r(\\gamma) = \\|\\boldsymbol{E} - \\boldsymbol{\\varepsilon}\\|_{F} \\big/ \\|\\boldsymbol{\\varepsilon}\\|_{F}$。矩阵 $\\boldsymbol{A}$ 的 Frobenius 范数由 $\\|\\boldsymbol{A}\\|_{F} = \\sqrt{\\sum_{i,j} A_{ij}^2}$ 给出。\n\n首先，我们计算差值张量 $\\boldsymbol{D} = \\boldsymbol{E} - \\boldsymbol{\\varepsilon}$ 的范数。\n$$ \\boldsymbol{D} = \\begin{pmatrix} 0  0  0 \\\\ 0  \\frac{\\gamma^2}{2}  0 \\\\ 0  0  0 \\end{pmatrix} $$\n$$ \\|\\boldsymbol{E} - \\boldsymbol{\\varepsilon}\\|_{F} = \\sqrt{0^2 + 0^2 + 0^2 + 0^2 + \\left(\\frac{\\gamma^2}{2}\\right)^2 + 0^2 + 0^2 + 0^2 + 0^2} = \\sqrt{\\frac{\\gamma^4}{4}} = \\frac{\\gamma^2}{2} $$\n注意，$\\sqrt{\\gamma^4} = |\\gamma^2| = \\gamma^2$，因为 $\\gamma^2$ 是非负的。\n\n接下来，我们计算无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 的范数。\n$$ \\boldsymbol{\\varepsilon} = \\begin{pmatrix} 0  \\frac{\\gamma}{2}  0 \\\\ \\frac{\\gamma}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n$$ \\|\\boldsymbol{\\varepsilon}\\|_{F} = \\sqrt{0^2 + \\left(\\frac{\\gamma}{2}\\right)^2 + 0^2 + \\left(\\frac{\\gamma}{2}\\right)^2 + 0^2 + 0^2 + 0^2 + 0^2 + 0^2} = \\sqrt{\\frac{\\gamma^2}{4} + \\frac{\\gamma^2}{4}} = \\sqrt{2 \\frac{\\gamma^2}{4}} = \\sqrt{\\frac{\\gamma^2}{2}} = \\frac{|\\gamma|}{\\sqrt{2}} $$\n绝对值 $|\\gamma|$ 是必要的，因为 $\\sqrt{\\gamma^2} = |\\gamma|$。\n\n现在，我们计算当 $\\gamma \\neq 0$ 时的比率 $r(\\gamma)$。\n$$ r(\\gamma) = \\frac{\\|\\boldsymbol{E} - \\boldsymbol{\\varepsilon}\\|_{F}}{\\|\\boldsymbol{\\varepsilon}\\|_{F}} = \\frac{\\frac{\\gamma^2}{2}}{\\frac{|\\gamma|}{\\sqrt{2}}} = \\frac{\\gamma^2}{2} \\cdot \\frac{\\sqrt{2}}{|\\gamma|} = \\frac{\\sqrt{2}}{2} \\frac{\\gamma^2}{|\\gamma|} $$\n由于 $\\gamma^2 = |\\gamma|^2$，我们可以简化这个表达式：\n$$ r(\\gamma) = \\frac{\\sqrt{2}}{2} \\frac{|\\gamma|^2}{|\\gamma|} = \\frac{\\sqrt{2}}{2} |\\gamma| = \\frac{|\\gamma|}{\\sqrt{2}} $$\n这个表达式定义了简单剪切下，无穷小应变张量相对于 Green-Lagrange 张量的相对误差。\n\n**任务4：确定使 $r(\\gamma)  0.01$ 成立的 $\\gamma$ 的范围**\n\n我们必须解不等式：\n$$ \\frac{|\\gamma|}{\\sqrt{2}}  0.01 $$\n两边同乘以 $\\sqrt{2}$ 得：\n$$ |\\gamma|  0.01 \\sqrt{2} $$\n这个绝对值不等式等价于复合不等式：\n$$ -0.01 \\sqrt{2}  \\gamma  0.01 \\sqrt{2} $$\n问题要求 $\\gamma$ 的容许区间的两个端点。它们是下界 $-0.01 \\sqrt{2}$ 和上界 $0.01 \\sqrt{2}$。\n\n最终答案需要 $r(\\gamma)$ 的解析表达式和两个区间端点。\n- $r(\\gamma) = \\frac{|\\gamma|}{\\sqrt{2}}$\n- 下端点：$-0.01 \\sqrt{2}$\n- 上端点：$0.01 \\sqrt{2}$\n根据要求，这三个结果将以一个行矩阵的形式呈现。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{|\\gamma|}{\\sqrt{2}}  -0.01 \\sqrt{2}  0.01 \\sqrt{2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "最后的实践将我们从解析理论带入计算力学的核心——有限元方法（FEM）。在有限元分析中，连续的位移场被离散化，应变能等物理量的积分通过数值求积（如高斯求积）来近似计算 。本练习旨在研究一种常见的计算技巧（减缩积分）如何影响应变计算的精度，并揭示其可能导致的非物理“沙漏”模式，这对于确保数值模拟的可靠性至关重要。",
            "id": "3574313",
            "problem": "您的任务是研究数值积分积分不足对二维弯曲设定下无穷小应变张量精度的影响，并使用单个四节点等参四边形单元通过异常应变模式来检测沙漏模式。工作应在小应变、小位移范畴内进行，以便应用无穷小应变张量。从第一性原理出发：无穷小应变张量由位移梯度的对称部分定义。考虑一个在物理坐标中占据矩形域的单个单元，其角点位于 $(x,y)\\in\\{(0,0),(L,0),(L,H),(0,H)\\}$，并使用从参考正方形 $[-1,1]\\times[-1,1]$ 到该单元的标准双线性等参映射，并采用 Gauss–Legendre 数值积分。所有变量和单位都必须按规定保持一致：长度 $L$ 和 $H$ 必须以米为单位，类曲率参数 $k$ 以米的倒数为单位，所有应变均为无量纲。此问题不涉及角度。\n\n使用的基本原理：\n- 无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 定义为 $\\varepsilon_{ij}=\\dfrac{1}{2}\\left(\\dfrac{\\partial u_i}{\\partial x_j}+\\dfrac{\\partial u_j}{\\partial x_i}\\right)$，其中 $\\boldsymbol{u}(x,y)$ 是位移场。\n- 物理域 $\\Omega$ 上标量场 $g(x,y)$ 的单元级积分为 $\\displaystyle \\int_{\\Omega} g(x,y)\\,\\mathrm{d}A=\\int_{-1}^{1}\\int_{-1}^{1} g(\\xi,\\eta)\\,\\det(\\boldsymbol{J}(\\xi,\\eta))\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$，其中 $\\boldsymbol{J}$ 是从 $(\\xi,\\eta)$ 到 $(x,y)$ 的等参映射的雅可比矩阵。\n- 在 $[-1,1]$ 上使用 $n$ 个点的 Gauss–Legendre 数值积分对于最高为 $2n-1$ 次的多项式是精确的。在二维中，适用张量积法则。\n- 四节点双线性等参单元（有限元法 (FEM) 中的标准单元）在参考正方形上使用双线性形函数，其导数通过雅可比矩阵进行变换以计算位移梯度和应变。\n\n任务：\n- 实现单个四节点等参四边形单元的运动学和数值积分，其节点顺序为 $(0,0)$, $(L,0)$, $(L,H)$, $(0,H)$。使用双线性形函数和雅可比变换，从离散化位移场中计算分量 $\\varepsilon_{xx}$。然后计算积分\n$$\nI = \\int_{\\Omega} \\left(\\varepsilon_{xx}(x,y)\\right)^2 \\,\\mathrm{d}A\n$$\n在参考域上使用两种不同的积分方案：\n    - 减缩积分：在 $[-1,1]\\times[-1,1]$ 上使用位于 $(\\xi,\\eta)=(0,0)$ 的单个高斯点，权重为 $4$（即 $1\\times 1$ 法则）。\n    - 完全积分：使用位于 $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$ 的两点 Gauss–Legendre 节点的张量积，权重为单位权重（即 $2\\times 2$ 法则）。\n\n- 考虑在同一矩形单元上的以下三种位移场，每种都由节点值描述：\n    1. 纯弯曲类场：设 $u_x(x,y)=-k\\,y\\,x$ 且 $u_y(x,y)=0$。该场沿高度方向产生线性变化的 $\\varepsilon_{xx}$。通过在四个节点上求值来构建节点位移。\n    2. 沙漏节点模式：仅设置节点上的 $u_x$ 值，使其围绕四个节点 $(0,0)$, $(L,0)$, $(L,H)$, $(0,H)$ 分别以棋盘格方式交替变号 $[+a,-a,+a,-a]$，并将所有 $u_y$ 节点值设为零。已知该模式在双线性四边形单元的减缩积分下是一种零能模式，应表现为单元中心的应变为零。\n    3. 混合场：将第1项中的纯弯曲类场与第2项中的沙漏节点模式叠加。\n\n- 对于每种情况，同时使用减缩积分 ($1 \\times 1$) 和完全积分 ($2 \\times 2$) 计算 $I$，然后计算下面测试套件中描述的所需标量输出。\n\n科学真实性和单位：\n- 使用物理上合理的参数，其中 $L$ 和 $H$ 以米为单位， $k$ 以米的倒数为单位。数量 $I$ 的单位是面积，因为 $\\varepsilon_{xx}$ 是无量纲的；然而，由于被积函数是应变的平方，得到的 $I$ 是无量纲乘以面积，在本任务中，由于比率比较中隐含的归一化，它简化为一个无量纲的度量。所有要求的输出都是无量纲标量或布尔值。报告任何浮点输出时，请四舍五入到 $6$ 位小数。\n\n测试套件和所需输出：\n- 使用以下三组参数集来检验不同的行为：\n    - 测试A（理想路径，纯弯曲类场）：$L=1.0\\,\\mathrm{m}$，$H=0.4\\,\\mathrm{m}$，$k=2.0\\,\\mathrm{m}^{-1}$。计算并返回比率 $r_A = I_{\\text{reduced}}/I_{\\text{full}}$，作为浮点数并四舍五入到6位小数。\n    - 测试B（沙漏检测）：$L=1.0\\,\\mathrm{m}$，$H=0.4\\,\\mathrm{m}$，$a=1.0$。$I_{\\text{reduced}}$ 应接近于零，而 $I_{\\text{full}}$ 应显著为正。如果 $I_{\\text{reduced}} \\le 10^{-12}$ 且 $I_{\\text{full}} \\ge 10^{-6}$，则返回布尔标志 $h_B$ 为 $\\text{True}$，否则为 $\\text{False}$。\n    - 测试C（混合场）：$L=1.0\\,\\mathrm{m}$，$H=0.4\\,\\mathrm{m}$，$k=2.0\\,\\mathrm{m}^{-1}$，$a=0.1$。计算并返回比率 $r_C = I_{\\text{reduced}}/I_{\\text{full}}$，作为浮点数并四舍五入到6位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序必须为 $[r_A,h_B,r_C]$，其中浮点数四舍五入到6位小数，布尔值为原生布尔值（例如，$[0.750000,True,0.700000]$）。不应打印任何额外文本。",
            "solution": "该问题要求分析在不同位移场下，单个四节点等参四边形单元的无穷小应变张量 $\\boldsymbol{\\varepsilon}$。任务的核心是使用减缩 ($1 \\times 1$) 和完全 ($2 \\times 2$) Gauss-Legendre 数值积分来计算应变分量 $\\varepsilon_{xx}$ 平方的积分，记为 $I = \\int_{\\Omega} (\\varepsilon_{xx})^2 \\,\\mathrm{d}A$，并研究沙漏这一数值假象。\n\n首先，我们为双线性等参单元建立运动学框架。单元内的物理坐标 $(x,y)$ 和位移场 $(u_x, u_y)$ 是通过在参考正方形域 $(\\xi, \\eta) \\in [-1,1] \\times [-1,1]$ 上定义的双线性形函数 $N_i(\\xi, \\eta)$ 从其节点值插值得到的。从 $(\\xi,\\eta)=(-1,-1)$ 开始逆时针排序的节点 $i=1,2,3,4$ 的形函数为：\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n物理单元是一个矩形，其角点节点位于 $(x_1,y_1)=(0,0)$、$(x_2,y_2)=(L,0)$、$(x_3,y_3)=(L,H)$ 和 $(x_4,y_4)=(0,H)$。从参考坐标到物理坐标的映射为 $x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i$ 和 $y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i$。\n\n物理坐标系和参考坐标系中导数之间的关系由雅可比矩阵 $\\boldsymbol{J}$ 给出：\n$$\n\\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} = \\boldsymbol{J} \\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} \\quad \\text{其中} \\quad \\boldsymbol{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix}\n$$\n对于指定的矩形单元，$\\boldsymbol{J}$ 的分量大大简化。例如，$\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i = \\frac{1}{4}[-(1-\\eta)x_1 + (1-\\eta)x_2 + (1+\\eta)x_3 - (1+\\eta)x_4] = \\frac{1}{4}[L(1-\\eta) + L(1+\\eta)] = \\frac{L}{2}$。计算所有分量后，我们发现雅可比矩阵是常数对角阵：\n$$\n\\boldsymbol{J} = \\begin{bmatrix} L/2  0 \\\\ 0  H/2 \\end{bmatrix}\n$$\n因此，其逆矩阵和行列式也是常数：\n$$\n\\boldsymbol{J}^{-1} = \\begin{bmatrix} 2/L  0 \\\\ 0  2/H \\end{bmatrix}, \\quad \\det(\\boldsymbol{J}) = \\frac{LH}{4}\n$$\n无穷小应变分量 $\\varepsilon_{xx}$ 定义为 $\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x}$。使用逆链式法则，$\\frac{\\partial u_x}{\\partial x} = J_{11}^{-1} \\frac{\\partial u_x}{\\partial \\xi} + J_{12}^{-1} \\frac{\\partial u_x}{\\partial \\eta}$。利用我们简化的 $\\boldsymbol{J}^{-1}$，这变为 $\\varepsilon_{xx} = \\frac{2}{L} \\frac{\\partial u_x}{\\partial \\xi}$。\n位移分量 $u_x$ 插值为 $u_x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{xi}$，其中 $u_{xi}$ 是 $x$ 方向的节点位移。其导数为：\n$$\n\\frac{\\partial u_x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} u_{xi} = \\frac{1}{4} [-(1-\\eta)u_{x1} + (1-\\eta)u_{x2} + (1+\\eta)u_{x3} - (1+\\eta)u_{x4}]\n$$\n这个表达式可以重排为 $\\eta$ 的线性函数：\n$$\n\\varepsilon_{xx}(\\xi, \\eta) = \\frac{2}{L} \\frac{\\partial u_x}{\\partial \\xi} = \\frac{1}{2L} [ (u_{x2}-u_{x1}) + (u_{x3}-u_{x4}) + \\eta((u_{x3}-u_{x4}) - (u_{x2}-u_{x1})) ]\n$$\n我们定义常数 $C_1$ 和 $C_2$，使得 $\\varepsilon_{xx}(\\eta) = C_1 + C_2 \\eta$：\n$$\nC_1 = \\frac{1}{2L} [ (u_{x2}-u_{x1}) + (u_{x3}-u_{x4}) ]\n$$\n$$\nC_2 = \\frac{1}{2L} [ (u_{x3}-u_{x4}) - (u_{x2}-u_{x1}) ]\n$$\n积分 $I$ 变换到参考域：$I = \\int_{-1}^{1}\\int_{-1}^{1} (\\varepsilon_{xx}(\\xi,\\eta))^2 \\det(\\boldsymbol{J}) \\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$。由于 $\\varepsilon_{xx}$ 与 $\\xi$ 无关，且 $\\det(\\boldsymbol{J})$ 是常数，我们有：\n$$\nI = \\frac{LH}{4} \\int_{-1}^{1}\\int_{-1}^{1} (C_1 + C_2\\eta)^2 \\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta = \\frac{LH}{2} \\int_{-1}^{1} (C_1 + C_2\\eta)^2 \\,\\mathrm{d}\\eta\n$$\n被积函数是关于 $\\eta$ 的二次多项式。\n该积分的精确值为 $I_{\\text{exact}} = \\frac{LH}{2} \\left[ C_1^2 \\eta + C_1 C_2 \\eta^2 + \\frac{C_2^2}{3}\\eta^3 \\right]_{-1}^{1} = LH(C_1^2 + \\frac{C_2^2}{3})$。\n\n现在我们使用两种指定的积分方案来计算此积分：\n1.  **减缩积分 ($1 \\times 1$)**：在 $(\\xi,\\eta)=(0,0)$ 处的单个高斯点，权重 $w=4$。\n    $$ I_{\\text{reduced}} = (\\varepsilon_{xx}(0))^2 \\det(\\boldsymbol{J}) \\times w = C_1^2 \\left(\\frac{LH}{4}\\right) \\times 4 = LH C_1^2 $$\n2.  **完全积分 ($2 \\times 2$)**：在 $(\\xi, \\eta) \\in \\{\\pm 1/\\sqrt{3}\\} \\times \\{\\pm 1/\\sqrt{3}\\}$ 处的四个高斯点，单位权重 ($w=1$)。由于被积函数仅依赖于 $\\eta$，积分为：\n    $$ I_{\\text{full}} = \\det(\\boldsymbol{J}) \\sum_{i=1}^2 \\sum_{j=1}^2 w_i w_j (\\varepsilon_{xx}(\\eta_j))^2 = \\frac{LH}{4} \\times 2 \\times [(\\varepsilon_{xx}(1/\\sqrt{3}))^2 + (\\varepsilon_{xx}(-1/\\sqrt{3}))^2] $$\n    $$ I_{\\text{full}} = \\frac{LH}{2} [(C_1 + C_2/\\sqrt{3})^2 + (C_1 - C_2/\\sqrt{3})^2] = \\frac{LH}{2} [2C_1^2 + 2C_2^2/3] = LH(C_1^2 + \\frac{C_2^2}{3}) $$\n    这与精确积分值相符，因为两点 Gauss 法则对最高为 $2(2)-1=3$ 次的多项式是精确的。\n\n现在我们使用这些推导出的公式分析三个测试案例。\n\n**测试 A：纯弯曲类场**\n节点位移由 $u_x(x,y) = -kxy$ 导出：$u_{x1}=0$，$u_{x2}=0$，$u_{x3}=-kLH$，$u_{x4}=0$。\n当 $L=1.0$，$H=0.4$，$k=2.0$ 时，我们有 $u_{x3} = -2.0 \\times 1.0 \\times 0.4 = -0.8$。\n节点向量为 $u_x = [0, 0, -0.8, 0]$。\n$C_1 = \\frac{1}{2(1.0)} [ (0-0) + (-0.8-0) ] = -0.4$。\n$C_2 = \\frac{1}{2(1.0)} [ (-0.8-0) - (0-0) ] = -0.4$。\n比率 $r_A = I_{\\text{reduced}} / I_{\\text{full}}$ 为：\n$$ r_A = \\frac{LH C_1^2}{LH(C_1^2 + C_2^2/3)} = \\frac{(-0.4)^2}{(-0.4)^2 + (-0.4)^2/3} = \\frac{1}{1 + 1/3} = \\frac{3}{4} = 0.75 $$\n\n**测试 B：沙漏节点模式**\n节点1、2、3、4的节点位移为 $u_x = [a, -a, a, -a]$。当 $a=1.0$，$L=1.0$，$H=0.4$ 时：\n$u_{x1}=1.0$，$u_{x2}=-1.0$，$u_{x3}=1.0$，$u_{x4}=-1.0$。\n$C_1 = \\frac{1}{2(1.0)} [ (-1.0-1.0) + (1.0 - (-1.0)) ] = \\frac{1}{2} [-2.0 + 2.0] = 0$。\n$C_2 = \\frac{1}{2(1.0)} [ (1.0 - (-1.0)) - (-1.0-1.0) ] = \\frac{1}{2} [2.0 - (-2.0)] = 2.0$。\n积分为：\n$I_{\\text{reduced}} = LH C_1^2 = 1.0 \\times 0.4 \\times 0^2 = 0$。\n$I_{\\text{full}} = LH(C_1^2 + C_2^2/3) = 1.0 \\times 0.4 \\times (0^2 + 2.0^2/3) = 0.4 \\times 4/3 \\approx 0.533333$。\n如果 $I_{\\text{reduced}} \\le 10^{-12}$ 且 $I_{\\text{full}} \\ge 10^{-6}$，则布尔标志 $h_B$ 为真。\n$0 \\le 10^{-12}$ 为真。$0.533333 \\ge 10^{-6}$ 为真。因此，$h_B$ 为真。这个案例表明，减缩积分未能检测到沙漏模式的变形能。\n\n**测试 C：混合场**\n节点位移是测试 A 和测试 B 中场的叠加，其中 $k=2.0$，$a=0.1$。\n$C_1$ 和 $C_2$ 也是两种情况下系数的叠加。\n$C_{1,\\text{mix}} = C_{1,\\text{bend}} + C_{1,\\text{hg}} = -0.4 + 0 = -0.4$。\n对于 $C_2$，我们用 $a=0.1$ 重新计算沙漏的贡献：$C_{2,\\text{hg}} = \\frac{2a}{L} = \\frac{2(0.1)}{1.0} = 0.2$。\n$C_{2,\\text{mix}} = C_{2,\\text{bend}} + C_{2,\\text{hg}} = -0.4 + 0.2 = -0.2$。\n比率 $r_C = I_{\\text{reduced}} / I_{\\text{full}}$ 为：\n$$ r_C = \\frac{C_{1,\\text{mix}}^2}{C_{1,\\text{mix}}^2 + C_{2,\\text{mix}}^2/3} = \\frac{(-0.4)^2}{(-0.4)^2 + (-0.2)^2/3} = \\frac{0.16}{0.16 + 0.04/3} $$\n$$ r_C = \\frac{0.16}{0.16 + 0.013333...} = \\frac{0.16}{0.173333...} = \\frac{0.48}{0.52} = \\frac{12}{13} \\approx 0.923077 $$\n\n要格式化的最终结果是 $r_A=0.75$，$h_B=\\text{True}$ 以及 $r_C \\approx 0.923077$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_integrals(L, H, u_x_nodes):\n    \"\"\"\n    Calculates the integral of (epsilon_xx)^2 using reduced and full quadrature.\n\n    This function uses the analytical formulas derived for a rectangular element,\n    which is a direct and exact implementation of the specified kinematics.\n\n    Args:\n        L (float): Length of the element.\n        H (float): Height of the element.\n        u_x_nodes (list or tuple of 4 floats): Nodal displacements [u_x1, u_x2, u_x3, u_x4].\n\n    Returns:\n        tuple: (I_reduced, I_full)\n    \"\"\"\n    u_x1, u_x2, u_x3, u_x4 = u_x_nodes\n\n    # Strain is epsilon_xx(eta) = C1 + C2 * eta\n    # C1 is the constant part (strain at eta=0)\n    # C2 is the linear part\n    C1 = ((u_x2 - u_x1) + (u_x3 - u_x4)) / (2.0 * L)\n    C2 = ((u_x3 - u_x4) - (u_x2 - u_x1)) / (2.0 * L)\n\n    # Reduced integration (1-point quadrature) evaluates the integrand at eta=0.\n    # I_reduced = L * H * (epsilon_xx(0))^2 = L * H * C1^2\n    I_reduced = L * H * C1**2\n\n    # Full integration (2x2 quadrature) is exact for the quadratic integrand.\n    # I_full = L * H * (C1^2 + C2^2 / 3)\n    I_full = L * H * (C1**2 + C2**2 / 3.0)\n\n    return I_reduced, I_full\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {'type': 'A', 'L': 1.0, 'H': 0.4, 'k': 2.0},\n        {'type': 'B', 'L': 1.0, 'H': 0.4, 'a': 1.0},\n        {'type': 'C', 'L': 1.0, 'H': 0.4, 'k': 2.0, 'a': 0.1}\n    ]\n\n    results = []\n\n    # Test A: Pure bending-like field\n    case_A = test_cases[0]\n    L, H, k = case_A['L'], case_A['H'], case_A['k']\n    u_x_bend = [0.0, 0.0, -k * L * H, 0.0]\n    I_red_A, I_full_A = calculate_integrals(L, H, u_x_bend)\n    r_A = I_red_A / I_full_A if I_full_A != 0 else 0.0\n    results.append(r_A)\n\n    # Test B: Hourglass nodal pattern\n    case_B = test_cases[1]\n    L, H, a = case_B['L'], case_B['H'], case_B['a']\n    u_x_hg = [+a, -a, +a, -a]\n    I_red_B, I_full_B = calculate_integrals(L, H, u_x_hg)\n    h_B = (I_red_B = 1e-12) and (I_full_B >= 1e-6)\n    results.append(h_B)\n    \n    # Test C: Mixed field\n    case_C = test_cases[2]\n    L, H, k, a = case_C['L'], case_C['H'], case_C['k'], case_C['a']\n    u_x_bend_C = np.array([0.0, 0.0, -k * L * H, 0.0])\n    u_x_hg_C = np.array([+a, -a, +a, -a])\n    u_x_mixed = u_x_bend_C + u_x_hg_C\n    I_red_C, I_full_C = calculate_integrals(L, H, u_x_mixed)\n    r_C = I_red_C / I_full_C if I_full_C != 0 else 0.0\n    results.append(r_C)\n\n    # Format and print the final output\n    formatted_results = [\n        f\"{results[0]:.6f}\",\n        str(results[1]),\n        f\"{results[2]:.6f}\"\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}