{
    "hands_on_practices": [
        {
            "introduction": "Understanding the relationship between forces acting throughout a body's volume and those acting on its surface is fundamental. This first practice provides a direct, hands-on calculation to solidify the connection between the local equilibrium equation and the global force balance. By integrating prescribed body forces and surface tractions over a simple geometry, you will apply the divergence theorem and Cauchy's formula to enforce static equilibrium, a core procedure in both analytical mechanics and the formulation of finite elements .",
            "id": "3547556",
            "problem": "Consider a prismatic, plane-stress triangular finite element occupying the right triangular region in the $x$–$y$ plane with vertices at $(0,0)$, $(L,0)$, and $(0,H)$, extruded uniformly in the $z$-direction with constant thickness $t$. Assume a static configuration (no inertia), no body couples, and that all fields are sufficiently smooth. A body force per unit volume acts only in the $x$-direction and is given by $b_x(x,y) = b_0 + b_1 x$, with $b_0$ having units $\\mathrm{N}\\,\\mathrm{m}^{-3}$ and $b_1$ having units $\\mathrm{N}\\,\\mathrm{m}^{-4}$. The only nonzero prescribed surface traction is uniform and acts on the slanted edge connecting $(L,0)$ to $(0,H)$; it has the constant vector value $\\boldsymbol{\\bar{t}} = q\\,\\boldsymbol{e}_x$, where $q$ is unknown. All other boundary segments are traction-free.\n\nStarting from the local balance of linear momentum and using only fundamental laws and definitions (including the definition of traction via Cauchy’s formula), determine the unique value of the scalar $q$ that enforces global force equilibrium of the element. Express your final answer for $q$ symbolically in terms of $L$, $H$, $t$, $b_0$, and $b_1$. Express the final $q$ in Pascals (Pa). Do not substitute numerical values and do not invoke any pre-packaged finite element formulas. The answer must be a single closed-form analytic expression.",
            "solution": "The problem requires finding the value of a constant surface traction component, $q$, that ensures global force equilibrium for a prismatic body. The solution must be derived from fundamental principles, starting with the local balance of linear momentum.\n\nFor a body in static equilibrium, with no inertial effects, the local balance of linear momentum is expressed by Cauchy's first law of motion:\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\mathbf{0}\n$$\nHere, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\boldsymbol{b}$ is the body force vector per unit volume. To obtain the global equilibrium condition, we integrate this local equation over the entire volume $V$ of the body:\n$$\n\\int_V (\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b}) \\, dV = \\mathbf{0}\n$$\nBy linearity of the integral, this can be separated into two terms:\n$$\n\\int_V \\nabla \\cdot \\boldsymbol{\\sigma} \\, dV + \\int_V \\boldsymbol{b} \\, dV = \\mathbf{0}\n$$\nApplying the Gauss divergence theorem to the first term transforms the volume integral of the divergence of the stress tensor into an integral over the body's surface, $S$:\n$$\n\\int_S (\\boldsymbol{\\sigma} \\cdot \\boldsymbol{n}) \\, dS + \\int_V \\boldsymbol{b} \\, dV = \\mathbf{0}\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal vector to the surface element $dS$. The traction vector $\\boldsymbol{t}$ on the surface is defined by Cauchy's formula as $\\boldsymbol{t} = \\boldsymbol{\\sigma} \\cdot \\boldsymbol{n}$. Substituting this definition yields the global force balance equation:\n$$\n\\int_V \\boldsymbol{b} \\, dV + \\int_S \\boldsymbol{t} \\, dS = \\mathbf{0}\n$$\nThis equation states that the vector sum of the total body force and the total surface force acting on the body must be zero. We will analyze the $x$-component of this vector equation, as all specified forces in the problem act along the $x$-axis.\n$$\n\\int_V b_x \\, dV + \\int_S t_x \\, dS = 0\n$$\nWe now evaluate each integral term for the given problem geometry and loads.\n\nFirst, we compute the resultant body force in the $x$-direction, $\\int_V b_x \\, dV$. The body is a prism with a uniform thickness $t$ over a right-triangular area $A$ in the $x$-$y$ plane. The vertices of $A$ are $(0,0)$, $(L,0)$, and $(0,H)$. The body force per unit volume is given as $\\boldsymbol{b} = (b_0 + b_1 x)\\boldsymbol{e}_x$, so its $x$-component is $b_x(x) = b_0 + b_1 x$. The volume integral is:\n$$\n\\int_V b_x \\, dV = \\int_0^t \\left( \\iint_A (b_0 + b_1 x) \\, dA \\right) \\, dz\n$$\nSince the integrand and the area $A$ are independent of $z$, the integration with respect to $z$ yields a factor of $t$:\n$$\n\\int_V b_x \\, dV = t \\iint_A (b_0 + b_1 x) \\, dx \\, dy\n$$\nThe triangular domain $A$ is bounded by $x=0$, $y=0$, and the line connecting $(L,0)$ and $(0,H)$, whose equation is $y = H(1 - x/L)$. We set up the double integral as:\n$$\n\\iint_A (b_0 + b_1 x) \\, dx \\, dy = \\int_0^L \\int_0^{H(1 - x/L)} (b_0 + b_1 x) \\, dy \\, dx\n$$\nIntegrating with respect to $y$:\n$$\n\\int_0^L (b_0 + b_1 x) [y]_0^{H(1-x/L)} \\, dx = \\int_0^L (b_0 + b_1 x) H(1 - \\frac{x}{L}) \\, dx\n$$\nThis simplifies to:\n$$\nH \\int_0^L \\left(b_0 + \\left(b_1 - \\frac{b_0}{L}\\right)x - \\frac{b_1}{L}x^2\\right) \\, dx\n$$\nIntegrating with respect to $x$:\n$$\nH \\left[ b_0 x + \\left(b_1 - \\frac{b_0}{L}\\right)\\frac{x^2}{2} - \\frac{b_1}{L}\\frac{x^3}{3} \\right]_0^L = H \\left( b_0 L + \\left(b_1 - \\frac{b_0}{L}\\right)\\frac{L^2}{2} - \\frac{b_1}{L}\\frac{L^3}{3} \\right)\n$$\n$$\n= H \\left( b_0 L + \\frac{b_1 L^2}{2} - \\frac{b_0 L}{2} - \\frac{b_1 L^2}{3} \\right) = H \\left( \\frac{b_0 L}{2} + \\frac{b_1 L^2}{6} \\right) = \\frac{LH}{2} \\left( b_0 + \\frac{b_1 L}{3} \\right)\n$$\nThus, the total body force in the $x$-direction is:\n$$\n\\int_V b_x \\, dV = t \\frac{LH}{2} \\left( b_0 + \\frac{b_1 L}{3} \\right)\n$$\n\nNext, we compute the resultant surface force in the $x$-direction, $\\int_S t_x \\, dS$. The problem states that the surface traction is zero on all boundary segments except for the slanted face. On this slanted face, the prescribed traction is a uniform vector $\\boldsymbol{\\bar{t}} = q\\,\\boldsymbol{e}_x$. Therefore, its $x$-component is $t_x = q$, where $q$ is a constant. The surface integral becomes:\n$$\n\\int_S t_x \\, dS = \\int_{S_{\\text{slanted}}} q \\, dS = q \\int_{S_{\\text{slanted}}} dS = q \\cdot \\text{Area}(S_{\\text{slanted}})\n$$\nThe slanted face $S_{\\text{slanted}}$ is a rectangle with thickness $t$ and length equal to the hypotenuse of the base triangle. The length of the hypotenuse, connecting $(L,0)$ and $(0,H)$, is $\\sqrt{(L-0)^2 + (0-H)^2} = \\sqrt{L^2 + H^2}$. The area of the slanted face is:\n$$\n\\text{Area}(S_{\\text{slanted}}) = t \\sqrt{L^2 + H^2}\n$$\nSo, the total surface force in the $x$-direction is:\n$$\n\\int_S t_x \\, dS = q t \\sqrt{L^2 + H^2}\n$$\n\nFinally, we substitute these two results into the global equilibrium equation for the $x$-direction:\n$$\nt \\frac{LH}{2} \\left( b_0 + \\frac{b_1 L}{3} \\right) + q t \\sqrt{L^2 + H^2} = 0\n$$\nWe solve for the unknown scalar $q$. Assuming $t \\neq 0$, we can cancel the thickness $t$:\n$$\nq \\sqrt{L^2 + H^2} = - \\frac{LH}{2} \\left( b_0 + \\frac{b_1 L}{3} \\right)\n$$\nIsolating $q$ gives:\n$$\nq = - \\frac{LH}{2 \\sqrt{L^2 + H^2}} \\left( b_0 + \\frac{b_1 L}{3} \\right)\n$$\nCombining the terms in the parenthesis gives a single fractional expression:\n$$\nq = - \\frac{LH}{2 \\sqrt{L^2 + H^2}} \\left( \\frac{3b_0 + b_1 L}{3} \\right) = - \\frac{LH(3b_0 + b_1L)}{6\\sqrt{L^2 + H^2}}\n$$\nThis expression provides the unique value of $q$ in units of force per area (Pascals), as required to maintain global static equilibrium of the element.",
            "answer": "$$\n\\boxed{- \\frac{LH(3b_0 + b_1L)}{6\\sqrt{L^2 + H^2}}}\n$$"
        },
        {
            "introduction": "A well-posed problem in solid mechanics must satisfy global equilibrium. This practice challenges you to act as a critical analyst, assessing whether a given set of body forces and boundary tractions are physically permissible before attempting a full solution. You will test the necessary conditions of global force and moment balance, which are direct consequences of integrating the local equilibrium equations over the entire body, to determine if a valid, equilibrating stress state can exist .",
            "id": "3547540",
            "problem": "Consider a simply connected, planar, prismatic body of unit thickness occupying the disk $\\Omega = \\{(x,y)\\in\\mathbb{R}^2:\\, x^2+y^2\\le R^2\\}$, with smooth boundary $\\partial\\Omega$ parameterized by the polar angle $\\theta\\in[0,2\\pi)$. The body is in a static configuration in an inertial frame, inertial effects are negligible, and no distributed couples act. A spatially uniform body force per unit area $\\mathbf{b}(\\mathbf{x})$ is present, and a traction per unit length $\\bar{\\mathbf{t}}(\\mathbf{x})$ is prescribed along $\\partial\\Omega$. Throughout, let the polar orthonormal basis be $(\\mathbf{e}_r(\\theta),\\mathbf{e}_\\theta(\\theta))$ with $\\mathbf{e}_r(\\theta)=\\cos\\theta\\,\\mathbf{e}_x+\\sin\\theta\\,\\mathbf{e}_y$ and $\\mathbf{e}_\\theta(\\theta)=-\\sin\\theta\\,\\mathbf{e}_x+\\cos\\theta\\,\\mathbf{e}_y$.\n\nData:\n- Radius $R=3$.\n- Body force $\\mathbf{b}(\\mathbf{x})=b_0\\,\\mathbf{e}_x$ with $b_0=-1$.\n- Boundary traction $\\bar{\\mathbf{t}}(\\theta)=\\alpha\\cos\\theta\\,\\mathbf{e}_r(\\theta)+\\lambda\\sin\\theta\\,\\mathbf{e}_\\theta(\\theta)$ with $\\alpha=5$ and $\\lambda=2$.\n\nUsing only balance of linear momentum, balance of angular momentum, and Cauchy’s stress principle (together with the definition of traction and the relation between traction and stress on a surface), assess whether there exists a symmetric Cauchy stress field $\\boldsymbol{\\sigma}(\\mathbf{x})$ such that the stress field is in local static equilibrium with the given body force in $\\Omega$ and reproduces the prescribed boundary traction on $\\partial\\Omega$. In your assessment, consider global consistency conditions implied by these laws over $\\Omega$ and $\\partial\\Omega$.\n\nWhich option is correct?\n\nA. A symmetric Cauchy stress field $\\boldsymbol{\\sigma}$ can exist consistent with the given $\\mathbf{b}$ and $\\bar{\\mathbf{t}}$, because both global force and moment balances over $\\Omega$ are satisfied by the prescribed fields.\n\nB. No such $\\boldsymbol{\\sigma}$ can exist, because the net moment about the origin generated by $\\bar{\\mathbf{t}}$ on $\\partial\\Omega$ is nonzero and cannot be balanced by $\\mathbf{b}$.\n\nC. No such $\\boldsymbol{\\sigma}$ can exist, because the net force in the $\\mathbf{e}_x$ direction is nonzero for the given $\\mathbf{b}$ and $\\bar{\\mathbf{t}}$.\n\nD. No such $\\boldsymbol{\\sigma}$ can exist, because a nonzero tangential traction component $\\lambda\\sin\\theta\\,\\mathbf{e}_\\theta(\\theta)$ contradicts the symmetry of $\\boldsymbol{\\sigma}$ required by balance of angular momentum.\n\nNote: You must decide based on first principles and global implications of the governing laws; do not assume any constitutive relation. Any mathematical conclusion must follow from the stated laws and definitions alone, without invoking numerical solvers such as the Finite Element Method (FEM) or unproven existence theorems for the associated Partial Differential Equation (PDE) boundary-value problem.",
            "solution": "Begin with the foundational balance laws for a classical Cauchy continuum in static equilibrium, with no distributed couples:\n\n1. Balance of linear momentum (local form): $\\nabla\\cdot\\boldsymbol{\\sigma}+\\mathbf{b}=\\mathbf{0}$ in $\\Omega$.\n2. Cauchy’s traction formula (local form): $\\mathbf{t}(\\mathbf{n})=\\boldsymbol{\\sigma}\\,\\mathbf{n}$ on any oriented surface with unit normal $\\mathbf{n}$, and in particular on $\\partial\\Omega$ with outward unit normal $\\mathbf{n}=\\mathbf{e}_r(\\theta)$, the prescribed traction must satisfy $\\boldsymbol{\\sigma}\\,\\mathbf{n}=\\bar{\\mathbf{t}}$ on $\\partial\\Omega$.\n3. Balance of angular momentum implies the Cauchy stress $\\boldsymbol{\\sigma}$ is symmetric in the absence of distributed couples: $\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}^\\mathsf{T}$.\n\nIntegrating the local balance of linear momentum over $\\Omega$ and using the divergence theorem together with the boundary condition $\\boldsymbol{\\sigma}\\mathbf{n}=\\bar{\\mathbf{t}}$, one obtains the global force balance for static equilibrium:\n$$\n\\int_{\\Omega}\\mathbf{b}\\,dA+\\oint_{\\partial\\Omega}\\bar{\\mathbf{t}}\\,ds=\\mathbf{0}.\n$$\nSimilarly, integrating the angular momentum balance over $\\Omega$, using $\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}^\\mathsf{T}$, yields the global moment balance about the origin:\n$$\n\\int_{\\Omega}\\mathbf{x}\\times\\mathbf{b}\\,dA+\\oint_{\\partial\\Omega}\\mathbf{x}\\times\\bar{\\mathbf{t}}\\,ds=\\mathbf{0}.\n$$\n\nWe now evaluate these global balances for the given data.\n\nParameterize $\\partial\\Omega$ by the polar angle $\\theta\\in[0,2\\pi)$:\n- Position vector on the boundary: $\\mathbf{x}(\\theta)=R\\,\\mathbf{e}_r(\\theta)$.\n- Differential arc length: $ds=R\\,d\\theta$.\n\nThe prescribed traction on $\\partial\\Omega$ is\n$$\n\\bar{\\mathbf{t}}(\\theta)=\\alpha\\cos\\theta\\,\\mathbf{e}_r(\\theta)+\\lambda\\sin\\theta\\,\\mathbf{e}_\\theta(\\theta),\n$$\nwith $\\alpha=5$, $\\lambda=2$, $R=3$.\n\nFirst convert $\\bar{\\mathbf{t}}(\\theta)$ to Cartesian components to evaluate net force:\n$$\n\\mathbf{e}_r(\\theta)=\\cos\\theta\\,\\mathbf{e}_x+\\sin\\theta\\,\\mathbf{e}_y,\\quad\n\\mathbf{e}_\\theta(\\theta)=-\\sin\\theta\\,\\mathbf{e}_x+\\cos\\theta\\,\\mathbf{e}_y.\n$$\nThus,\n$$\n\\bar{\\mathbf{t}}(\\theta)\n=\\alpha\\cos\\theta\\left(\\cos\\theta\\,\\mathbf{e}_x+\\sin\\theta\\,\\mathbf{e}_y\\right)\n+\\lambda\\sin\\theta\\left(-\\sin\\theta\\,\\mathbf{e}_x+\\cos\\theta\\,\\mathbf{e}_y\\right),\n$$\nso the Cartesian components are\n$$\n\\bar{t}_x(\\theta)\n=\\alpha\\cos^2\\theta-\\lambda\\sin^2\\theta,\\quad\n\\bar{t}_y(\\theta)\n=\\alpha\\cos\\theta\\sin\\theta+\\lambda\\sin\\theta\\cos\\theta.\n$$\n\nGlobal force balance.\nThe boundary resultant is\n$$\n\\mathbf{F}_{\\partial\\Omega}\n=\\oint_{\\partial\\Omega}\\bar{\\mathbf{t}}\\,ds\n=R\\int_{0}^{2\\pi}\\bar{\\mathbf{t}}(\\theta)\\,d\\theta.\n$$\nCompute components:\n$$\nF^{\\partial\\Omega}_x\n=R\\int_{0}^{2\\pi}\\left(\\alpha\\cos^2\\theta-\\lambda\\sin^2\\theta\\right)\\,d\\theta\n=R\\left(\\alpha\\int_{0}^{2\\pi}\\cos^2\\theta\\,d\\theta-\\lambda\\int_{0}^{2\\pi}\\sin^2\\theta\\,d\\theta\\right)\n=R\\left(\\alpha\\pi-\\lambda\\pi\\right)=\\pi R(\\alpha-\\lambda),\n$$\nsince $\\int_{0}^{2\\pi}\\cos^2\\theta\\,d\\theta=\\int_{0}^{2\\pi}\\sin^2\\theta\\,d\\theta=\\pi$.\nSimilarly,\n$$\nF^{\\partial\\Omega}_y\n=R\\int_{0}^{2\\pi}\\left(\\alpha\\cos\\theta\\sin\\theta+\\lambda\\sin\\theta\\cos\\theta\\right)\\,d\\theta\n=R(\\alpha+\\lambda)\\int_{0}^{2\\pi}\\sin\\theta\\cos\\theta\\,d\\theta=0.\n$$\n\nThe body force resultant is\n$$\n\\mathbf{F}_{\\Omega}=\\int_{\\Omega}\\mathbf{b}\\,dA\n=b_0\\,\\mathbf{e}_x\\int_{\\Omega}dA\n=b_0\\,\\pi R^2\\,\\mathbf{e}_x,\n$$\nwith no $\\mathbf{e}_y$ component.\n\nTherefore, the total resultant force is\n$$\n\\mathbf{F}_{\\text{tot}}=\\mathbf{F}_{\\Omega}+\\mathbf{F}_{\\partial\\Omega}\n=\\left[\\pi R(\\alpha-\\lambda)+\\pi R^2 b_0\\right]\\mathbf{e}_x + 0\\cdot\\mathbf{e}_y.\n$$\nPlugging in $R=3$, $\\alpha=5$, $\\lambda=2$, $b_0=-1$:\n$$\n\\pi R(\\alpha-\\lambda)+\\pi R^2 b_0\n=\\pi\\cdot 3\\cdot(5-2)+\\pi\\cdot 9\\cdot(-1)\n=9\\pi-9\\pi=0,\n$$\nso the net force vanishes: $\\mathbf{F}_{\\text{tot}}=\\mathbf{0}$.\n\nGlobal moment balance about the origin (out-of-plane component).\nCompute the boundary moment:\n$$\n\\mathbf{M}_{\\partial\\Omega}\n=\\oint_{\\partial\\Omega}\\mathbf{x}\\times\\bar{\\mathbf{t}}\\,ds\n=R\\int_{0}^{2\\pi}\\big(R\\,\\mathbf{e}_r(\\theta)\\times\\bar{\\mathbf{t}}(\\theta)\\big)\\,d\\theta\n=R^2\\int_{0}^{2\\pi}\\left[\\mathbf{e}_r(\\theta)\\times\\left(\\alpha\\cos\\theta\\,\\mathbf{e}_r(\\theta)+\\lambda\\sin\\theta\\,\\mathbf{e}_\\theta(\\theta)\\right)\\right]\\,d\\theta.\n$$\nUse $\\mathbf{e}_r(\\theta)\\times\\mathbf{e}_r(\\theta)=\\mathbf{0}$ and $\\mathbf{e}_r(\\theta)\\times\\mathbf{e}_\\theta(\\theta)=\\mathbf{e}_z$:\n$$\n\\mathbf{M}_{\\partial\\Omega}\n=R^2\\int_{0}^{2\\pi}\\lambda\\sin\\theta\\,\\mathbf{e}_z\\,d\\theta\n=\\lambda R^2\\left(\\int_{0}^{2\\pi}\\sin\\theta\\,d\\theta\\right)\\mathbf{e}_z\n=\\lambda R^2\\cdot 0\\cdot \\mathbf{e}_z=\\mathbf{0}.\n$$\nThe body moment about the origin is\n$$\n\\mathbf{M}_{\\Omega}\n=\\int_{\\Omega}\\mathbf{x}\\times\\mathbf{b}\\,dA\n=\\int_{\\Omega}(x\\,\\mathbf{e}_x+y\\,\\mathbf{e}_y)\\times(b_0\\,\\mathbf{e}_x)\\,dA\n=\\int_{\\Omega}\\left(0\\,\\mathbf{e}_x+0\\,\\mathbf{e}_y+(x\\cdot 0-y\\cdot b_0)\\,\\mathbf{e}_z\\right)\\,dA\n=-b_0\\left(\\int_{\\Omega}y\\,dA\\right)\\mathbf{e}_z=\\mathbf{0},\n$$\nby symmetry of the disk $\\Omega$ about the $x$-axis, which gives $\\int_{\\Omega}y\\,dA=0$.\n\nTherefore, the net moment vanishes:\n$$\n\\mathbf{M}_{\\text{tot}}=\\mathbf{M}_{\\Omega}+\\mathbf{M}_{\\partial\\Omega}=\\mathbf{0}.\n$$\n\nSince both global force and global moment balances are satisfied by the given $\\mathbf{b}$ and $\\bar{\\mathbf{t}}$, the data are consistent with static equilibrium. The symmetry requirement for $\\boldsymbol{\\sigma}$ follows from local angular momentum balance and does not preclude tangential tractions; a symmetric stress tensor can generate shear (tangential) boundary tractions through $\\mathbf{t}=\\boldsymbol{\\sigma}\\mathbf{n}$ with $\\mathbf{n}=\\mathbf{e}_r(\\theta)$, provided shear components of $\\boldsymbol{\\sigma}$ exist. There is no contradiction between $\\lambda\\neq 0$ and $\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}^\\mathsf{T}$.\n\nOption-by-option analysis:\n- Option A: Correct. As shown, $\\mathbf{F}_{\\text{tot}}=\\mathbf{0}$ and $\\mathbf{M}_{\\text{tot}}=\\mathbf{0}$ for the given $R$, $\\alpha$, $\\lambda$, $b_0$. These global conditions are necessary consequences of the local laws and boundary condition, and they are satisfied by the prescribed fields. There is no violation of stress symmetry.\n- Option B: Incorrect. The net boundary moment vanishes because the only nonzero contribution from $\\bar{\\mathbf{t}}$ involves $\\int_{0}^{2\\pi}\\sin\\theta\\,d\\theta=0$, and the body moment is zero by symmetry.\n- Option C: Incorrect. The net force in the $\\mathbf{e}_x$ direction is $\\pi R(\\alpha-\\lambda)+\\pi R^2 b_0=0$ with the given values; thus, the force balance is satisfied.\n- Option D: Incorrect. A nonzero tangential traction component does not contradict $\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}^\\mathsf{T}$; symmetric stresses produce shear tractions on boundaries with non-collinear normals, and local angular momentum balance enforces stress symmetry, not the absence of tangential traction.\n\nTherefore, the correct assessment is Option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "In the world of computational mechanics, verifying that a numerical solver correctly implements the governing physical laws is paramount. This hands-on coding exercise introduces the powerful Method of Manufactured Solutions, a cornerstone of modern code verification. You will start with a chosen analytical stress field, use the equilibrium equation $\\nabla\\cdot\\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$ to manufacture the required body force, and then use Cauchy's formula to define exact boundary tractions, providing a complete benchmark to test the accuracy of a numerical approximation .",
            "id": "3547591",
            "problem": "You are asked to design and implement a manufactured-solution benchmark to assess the consistency of surface traction evaluation and static equilibrium enforcement in computational solid mechanics. The benchmark is constructed from analytic stress and body force fields, and it evaluates errors arising when stress is discretized by a bilinear interpolation, mimicking a low-order Finite Element Method (FEM) post-processing of stress. The benchmark must be implemented as a complete, runnable program that produces a single-line output aggregating the results for a provided test suite.\n\nThe fundamental base for this task consists of the following principles and definitions:\n\n- Static equilibrium in the absence of inertia: the linear momentum balance is given by $$\\nabla\\cdot\\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0},$$ where $\\boldsymbol{\\sigma}(\\mathbf{x})$ is the Cauchy stress tensor and $\\mathbf{b}(\\mathbf{x})$ is the body force per unit volume.\n- Cauchy’s formula for the traction vector: $$\\mathbf{t}(\\mathbf{n}) = \\boldsymbol{\\sigma}\\,\\mathbf{n},$$ where $\\mathbf{n}$ is the outward unit normal vector to a surface.\n- The domain is the unit square $$\\Omega = [0,1]\\times[0,1],$$ with outward unit normals on the boundary segments given by $$\\mathbf{n} = (-1,0) \\text{ on } x=0,\\quad \\mathbf{n} = (1,0) \\text{ on } x=1,\\quad \\mathbf{n} = (0,-1) \\text{ on } y=0,\\quad \\mathbf{n} = (0,1) \\text{ on } y=1.$$\n- The manufactured-solution approach selects an analytic stress field $$\\boldsymbol{\\sigma}(\\mathbf{x})$$ and defines $$\\mathbf{b}(\\mathbf{x}) = -\\nabla\\cdot\\boldsymbol{\\sigma}(\\mathbf{x})$$ to guarantee exact satisfaction of static equilibrium.\n\nPhysical units must be used consistently. Coordinates $x$ and $y$ are in meters, $\\boldsymbol{\\sigma}$ is in Pascals, and $\\mathbf{b}$ is in Newton per cubic meter. The traction $\\mathbf{t}$ has units of Pascals. All error metrics must be reported in these units: traction error in Pascals and equilibrium residual in Newton per cubic meter.\n\nApproximation and error assessment procedure to implement:\n\n- Discretize the unit square using a uniform $N\\times N$ grid of bilinear quadrilateral cells with grid spacing $$h_x = h_y = \\frac{1}{N}.$$\n- Define the “FEM-like” approximate stress field $\\boldsymbol{\\sigma}_h(x,y)$ as the bilinear interpolation of nodal stress values at the four corners of each cell, with standard bilinear shape functions $$N_1(\\xi,\\eta) = (1-\\xi)(1-\\eta),\\;N_2(\\xi,\\eta) = \\xi(1-\\eta),\\;N_3(\\xi,\\eta) = \\xi\\eta,\\;N_4(\\xi,\\eta) = (1-\\xi)\\eta,$$ where $$\\xi = \\frac{x-x_0}{h_x},\\;\\eta = \\frac{y-y_0}{h_y}$$ are local coordinates in the current cell.\n- Compute the divergence $$\\nabla\\cdot\\boldsymbol{\\sigma}_h = \\begin{bmatrix} \\frac{\\partial \\sigma_{11,h}}{\\partial x} + \\frac{\\partial \\sigma_{12,h}}{\\partial y} \\\\ \\frac{\\partial \\sigma_{12,h}}{\\partial x} + \\frac{\\partial \\sigma_{22,h}}{\\partial y} \\end{bmatrix}$$ by analytically differentiating the bilinear interpolants (using the derivatives of $N_i(\\xi,\\eta)$ with $\\partial \\xi/\\partial x = 1/h_x$ and $\\partial \\eta/\\partial y = 1/h_y$).\n- Define the exact traction on $\\partial\\Omega$ by $$\\mathbf{t}_{\\text{exact}} = \\boldsymbol{\\sigma}\\,\\mathbf{n},$$ and the approximate traction by $$\\mathbf{t}_h = \\boldsymbol{\\sigma}_h\\,\\mathbf{n}.$$\n- Evaluate boundary integrals with composite Gaussian quadrature using two-point Gauss on each boundary segment of length $$h = 1/N$$ per side, and evaluate domain integrals with tensor-product two-point Gauss quadrature in each cell. Use these quadrature rules to compute the root-mean-square (RMS) errors:\n    - Traction RMS error: $$E_t = \\sqrt{\\frac{1}{L}\\int_{\\partial\\Omega} \\|\\mathbf{t}_h - \\mathbf{t}_{\\text{exact}}\\|^2\\,\\mathrm{d}s},\\quad L = 4,$$ expressed in Pascals.\n    - Equilibrium residual RMS: $$E_r = \\sqrt{\\frac{1}{A}\\int_{\\Omega} \\|\\nabla\\cdot\\boldsymbol{\\sigma}_h + \\mathbf{b}\\|^2\\,\\mathrm{d}\\Omega},\\quad A = 1,$$ expressed in Newton per cubic meter.\n\nDefine relative RMS errors by normalizing with the corresponding RMS of the exact fields:\n- Traction relative RMS error: $$R_t = \\frac{E_t}{\\sqrt{\\frac{1}{L}\\int_{\\partial\\Omega} \\|\\mathbf{t}_{\\text{exact}}\\|^2\\,\\mathrm{d}s}}.$$\n- Equilibrium residual relative RMS error: $$R_r = \\frac{E_r}{\\sqrt{\\frac{1}{A}\\int_{\\Omega} \\|\\mathbf{b}\\|^2\\,\\mathrm{d}\\Omega}},$$ with the special case that if the denominator is zero, judge equilibrium by the absolute threshold instead: $$E_r < 10^{-10}\\;\\text{Newton per cubic meter}.$$\n\nTest suite:\n\nFor each test case, provide the analytic stress field components $\\sigma_{11}(x,y)$, $\\sigma_{22}(x,y)$, $\\sigma_{12}(x,y)$, set $\\sigma_{21}=\\sigma_{12}$, and set $$\\mathbf{b}(x,y) = -\\nabla\\cdot\\boldsymbol{\\sigma}(x,y).$$ Use the specified grid resolution $N$.\n\n- Case $1$ (polynomial, moderate variation, “happy path”): $$\\sigma_{11} = 2x + 3y,\\;\\sigma_{22} = -x + y^2,\\;\\sigma_{12} = xy,\\;N=8.$$\n- Case $2$ (oscillatory, higher frequency): Let $$k = 4\\pi.$$ Then $$\\sigma_{11} = \\sin(kx) + y,\\;\\sigma_{22} = \\cos(ky) + x,\\;\\sigma_{12} = \\tfrac{1}{2}\\sin(kx)\\sin(ky),\\;N=32.$$\n- Case $3$ (constant stress, boundary condition edge case, zero body force): $$\\sigma_{11} = 5,\\;\\sigma_{22} = -2,\\;\\sigma_{12} = 1,\\;N=4.$$\n- Case $4$ (steep gradients near boundaries): $$\\sigma_{11} = e^x + y^3,\\;\\sigma_{22} = e^y + x^2,\\;\\sigma_{12} = x^2 y,\\;N=16.$$\n\nAcceptance criteria and outputs:\n\n- For each test case, compute $(E_t,\\;E_r,\\;P_t,\\;P_r)$, where $E_t$ is the traction RMS error in Pascals and $E_r$ is the equilibrium residual RMS in Newton per cubic meter. Define $P_t$ as a boolean that is $\\text{True}$ if $$R_t < 0.05,$$ and $P_r$ as a boolean that is $\\text{True}$ if $$R_r < 0.05$$ when the denominator is nonzero; otherwise, if the RMS of $\\mathbf{b}$ is zero, set $$P_r = (E_r < 10^{-10}).$$\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one entry per test case. Each entry must be a list in the format $$[E_t,E_r,P_t,P_r].$$ For example, $$[[e_{t,1},e_{r,1},p_{t,1},p_{r,1}],[e_{t,2},e_{r,2},p_{t,2},p_{r,2}],\\ldots].$$\n\nAll mathematical quantities in the problem statement are expressed in the International System of Units (SI). Angles are not used. Answers must be numeric floats and booleans in the units specified. The code must implement the quadrature-based integration, bilinear interpolation, and divergence computation as described. No external files or inputs are allowed.",
            "solution": "The user has provided a problem that requires the design and implementation of a manufactured-solution benchmark for computational solid mechanics. The process involves validating the problem statement for scientific soundness and completeness before proceeding with a solution.\n\n### Step 1: Problem Validation\n\nThe problem statement is critically evaluated based on the established criteria.\n\n**1. Extraction of Givens:**\n- **Governing Equations:** Static equilibrium $\\nabla\\cdot\\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$ and Cauchy's traction formula $\\mathbf{t}(\\mathbf{n}) = \\boldsymbol{\\sigma}\\,\\mathbf{n}$.\n- **Domain:** Unit square $\\Omega = [0,1]\\times[0,1]$ with specified outward normal vectors on its four boundaries.\n- **Methodology:** Manufactured solution approach where $\\mathbf{b}(\\mathbf{x}) = -\\nabla\\cdot\\boldsymbol{\\sigma}(\\mathbf{x})$ for a chosen analytic stress field $\\boldsymbol{\\sigma}(\\mathbf{x})$.\n- **Discretization:** A uniform $N\\times N$ grid of bilinear quadrilateral cells. The stress field is approximated by $\\boldsymbol{\\sigma}_h$ using bilinear interpolation within each cell.\n- **Numerical Integration:** Composite two-point Gaussian quadrature for all boundary and domain integrals.\n- **Error Metrics:** Root-mean-square (RMS) errors for traction ($E_t$) and equilibrium residual ($E_r$), and their relative counterparts ($R_t, R_r$).\n- **Acceptance Criteria:** A threshold of $0.05$ for relative errors ($R_t, R_r$) to determine pass/fail booleans ($P_t, P_r$). A special absolute threshold ($E_r < 10^{-10}$) is specified for cases where the body force is identically zero.\n- **Test Suite:** Four distinct cases are provided, each with a specific analytic stress tensor field $\\boldsymbol{\\sigma}(x,y)$ and grid resolution $N$.\n- **Units:** All quantities are specified in SI units (meters, Pascals, Newtons).\n- **Output Format:** A specific single-line string format for the final results.\n\n**2. Validation using Extracted Givens:**\n- **Scientific Grounding:** The problem is firmly based on fundamental principles of continuum mechanics and standard numerical methods (Finite Element Method concepts, numerical quadrature) used for verification in computational engineering. It is scientifically and mathematically sound.\n- **Well-Posedness:** The problem is well-posed. For each test case, the inputs are explicit, and the sequence of calculations (derivation of body forces, interpolation, numerical integration, error calculation) is deterministic, leading to a unique, computable result.\n- **Objectivity:** The problem is formulated with precise, objective language. All terms are mathematically defined, and the criteria for evaluation are quantitative and unambiguous.\n- **Completeness and Consistency:** The problem is self-contained. It provides all necessary analytic functions, parameters ($N$), numerical procedures (quadrature rules), and definitions required for a complete solution. The manufactured solution approach ensures consistency between the stress field and the body force by definition.\n- **Feasibility:** The provided stress fields are smooth analytic functions, and the specified grid resolutions are modest. The required computations are numerically stable and computationally feasible within a standard programming environment.\n- **Clarity:** The problem is clearly structured and free of vague or undefined terms.\n\n**3. Verdict and Action:**\nThe problem is deemed **valid**. It is a well-defined, rigorous, and relevant problem in computational solid mechanics. I will now proceed to construct the solution.\n\n### Step 2: Solution Design\n\nThe solution will be implemented in Python, adhering to the specified libraries. The core of the solution involves a systematic application of the described numerical procedures for each test case.\n\n**1. Analytic Preliminaries:**\nFor each test case, the body force components $b_x$ and $b_y$ are derived analytically from the given stress tensor $\\boldsymbol{\\sigma}$ using the formula $\\mathbf{b} = -\\nabla\\cdot\\boldsymbol{\\sigma} = -(\\frac{\\partial \\sigma_{ij}}{\\partial x_j})$.\n- **Case 1:** $\\boldsymbol{\\sigma} = \\begin{pmatrix} 2x + 3y & xy \\\\ xy & -x + y^2 \\end{pmatrix}$. This gives $\\mathbf{b} = \\begin{pmatrix} -(2+x) \\\\ -3y \\end{pmatrix}$.\n- **Case 2:** For $k=4\\pi$, $\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sin(kx) + y & \\frac{1}{2}\\sin(kx)\\sin(ky) \\\\ \\frac{1}{2}\\sin(kx)\\sin(ky) & \\cos(ky) + x \\end{pmatrix}$. This gives $\\mathbf{b} = \\begin{pmatrix} -k\\cos(kx) - \\frac{k}{2}\\sin(kx)\\cos(ky) \\\\ -\\frac{k}{2}\\cos(kx)\\sin(ky) + k\\sin(ky) \\end{pmatrix}$.\n- **Case 3:** $\\boldsymbol{\\sigma} = \\begin{pmatrix} 5 & 1 \\\\ 1 & -2 \\end{pmatrix}$. This gives $\\mathbf{b} = \\mathbf{0}$.\n- **Case 4:** $\\boldsymbol{\\sigma} = \\begin{pmatrix} e^x + y^3 & x^2 y \\\\ x^2 y & e^y + x^2 \\end{pmatrix}$. This gives $\\mathbf{b} = \\begin{pmatrix} -(e^x+x^2) \\\\ -(2xy+e^y) \\end{pmatrix}$.\nThese analytic functions for both $\\boldsymbol{\\sigma}$ and $\\mathbf{b}$ will be implemented directly.\n\n**2. Numerical Integration Setup:**\nA two-point Gaussian quadrature rule is used. The points and weights for the reference interval $[-1, 1]$ are $\\zeta_{1,2} = \\mp 1/\\sqrt{3}$ and $w_{1,2} = 1$. These will be mapped to each cell for domain integrals and to each boundary segment for line integrals. The Jacobian of the transformation must be included.\n- For a square cell of side length $h$, the area element is $\\mathrm{d}A = (h/2)^2 \\mathrm{d}\\zeta\\mathrm{d}\\eta$. The integral contribution from one Gauss point is $w_i w_j \\cdot f(\\mathbf{x}_{ij}) \\cdot (h^2/4)$.\n- For a boundary segment of length $h$, the length element is $\\mathrm{d}s = (h/2) \\mathrm{d}\\zeta$. The integral contribution is $w_i \\cdot f(\\mathbf{x}_i) \\cdot (h/2)$.\n\n**3. Discretized Field Calculations:**\nFor each cell, the approximate stress field $\\boldsymbol{\\sigma}_h$ is defined by bilinearly interpolating the exact stress values at the four cell nodes. The divergence of this field, $\\nabla\\cdot\\boldsymbol{\\sigma}_h$, is computed by analytically differentiating the bilinear shape functions.\nGiven a scalar field $f_h$ interpolated from nodal values $f_1, f_2, f_3, f_4$ in a cell (with local coordinates $\\xi=(x-x_0)/h, \\eta=(y-y_0)/h$), its derivatives are:\n$$ \\frac{\\partial f_h}{\\partial x} = \\frac{1}{h}\\left[ (f_2-f_1)(1-\\eta) + (f_3-f_4)\\eta \\right] $$\n$$ \\frac{\\partial f_h}{\\partial y} = \\frac{1}{h}\\left[ (f_4-f_1)(1-\\xi) + (f_3-f_2)\\xi \\right] $$\nThese formulas are applied to each component of $\\boldsymbol{\\sigma}_h$ to compute $\\nabla\\cdot\\boldsymbol{\\sigma}_h$ at the Gauss points within each cell. On the boundary, $\\boldsymbol{\\sigma}_h$ reduces to a linear interpolant between the two nodes of a segment.\n\n**4. Error Computation Loop:**\nThe core of the implementation will iterate through cells and boundary segments to accumulate the squared norms for the RMS error calculations.\n\n- **Equilibrium Residual ($E_r$):**\n  - Loop over all $N \\times N$ cells.\n  - In each cell, loop over the $2 \\times 2$ Gauss points.\n  - At each Gauss point, calculate $\\mathbf{v} = \\nabla\\cdot\\boldsymbol{\\sigma}_h + \\mathbf{b}$.\n  - Add $\\|\\mathbf{v}\\|^2 \\cdot (\\text{weight factor})$ to a running sum for the error integral.\n  - Similarly, compute the integral of $\\|\\mathbf{b}\\|^2$ for normalization.\n  - After the loops, compute $E_r$ and $R_r$ from the total sums.\n\n- **Traction Error ($E_t$):**\n  - Loop over the four boundaries of the domain.\n  - For each boundary, loop over its $N$ segments.\n  - On each segment, loop over the $2$ Gauss points.\n  - At each Gauss point, calculate $\\mathbf{d} = \\mathbf{t}_h - \\mathbf{t}_{\\text{exact}} = (\\boldsymbol{\\sigma}_h - \\boldsymbol{\\sigma})\\mathbf{n}$.\n  - Add $\\|\\mathbf{d}\\|^2 \\cdot (\\text{weight factor})$ to the error sum.\n  - Similarly, compute the integral of $\\|\\mathbf{t}_{\\text{exact}}\\|^2$ for normalization.\n  - After the loops, compute $E_t$ and $R_t$.\n\n**5. Final Evaluation:**\nThe pass/fail booleans $P_t$ and $P_r$ are determined by comparing the relative errors $R_t$ and $R_r$ to the $0.05$ threshold, with the specified special handling for the case where $\\|\\mathbf{b}\\|_{RMS} = 0$.\n\nThis structured approach ensures that all requirements of the problem statement are met accurately and efficiently. The final code will encapsulate this logic in a self-contained, executable script.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the manufactured-solution benchmark for all test cases.\n    \"\"\"\n\n    # --- Test Case Definitions ---\n    # Each case provides analytic functions for stress components, their derivatives\n    # to compute the body force, and the grid resolution N.\n\n    k = 4 * np.pi\n    test_cases = [\n        # Case 1: Polynomial stress field\n        {\n            \"N\": 8,\n            \"sigma11\": lambda x, y: 2 * x + 3 * y,\n            \"sigma22\": lambda x, y: -x + y**2,\n            \"sigma12\": lambda x, y: x * y,\n            \"b_x\": lambda x, y: -(2 + x),\n            \"b_y\": lambda x, y: -(y + 2*y), # Corrected for clarity: -(3*y)\n        },\n        # Case 2: Oscillatory stress field\n        {\n            \"N\": 32,\n            \"sigma11\": lambda x, y: np.sin(k * x) + y,\n            \"sigma22\": lambda x, y: np.cos(k * y) + x,\n            \"sigma12\": lambda x, y: 0.5 * np.sin(k * x) * np.sin(k * y),\n            \"b_x\": lambda x, y: -(k * np.cos(k * x) + 0.5 * k * np.sin(k * x) * np.cos(k * y)),\n            \"b_y\": lambda x, y: -(0.5 * k * np.cos(k * x) * np.sin(k * y) - k * np.sin(k * y)),\n        },\n        # Case 3: Constant stress field (zero body force)\n        {\n            \"N\": 4,\n            \"sigma11\": lambda x, y: 5.0,\n            \"sigma22\": lambda x, y: -2.0,\n            \"sigma12\": lambda x, y: 1.0,\n            \"b_x\": lambda x, y: 0.0,\n            \"b_y\": lambda x, y: 0.0,\n        },\n        # Case 4: Exponential/polynomial stress field\n        {\n            \"N\": 16,\n            \"sigma11\": lambda x, y: np.exp(x) + y**3,\n            \"sigma22\": lambda x, y: np.exp(y) + x**2,\n            \"sigma12\": lambda x, y: x**2 * y,\n            \"b_x\": lambda x, y: -(np.exp(x) + x**2),\n            \"b_y\": lambda x, y: -(2 * x * y + np.exp(y)),\n        },\n    ]\n    # Re-assign b_y for Case 1 to avoid lambda re-binding issues.\n    test_cases[0][\"b_y\"] = lambda x,y: -3*y\n\n    results = []\n    for case in test_cases:\n        result = process_case(case)\n        results.append(result)\n\n    # Format the final output string exactly as specified.\n    # The default str() for a list includes spaces, which we avoid by custom formatting.\n    result_strings = []\n    for res in results:\n        # Format: [float, float, bool, bool] with no spaces\n        result_strings.append(f\"[{res[0]},{res[1]},{res[2]},{res[3]}]\")\n    print(f\"[{','.join(result_strings)}]\")\n\ndef process_case(case_data):\n    \"\"\"\n    Processes a single test case to compute error metrics and pass/fail criteria.\n    \"\"\"\n    N = case_data[\"N\"]\n    h = 1.0 / N\n    s11_f, s22_f, s12_f = case_data[\"sigma11\"], case_data[\"sigma22\"], case_data[\"sigma12\"]\n    bx_f, by_f = case_data[\"b_x\"], case_data[\"b_y\"]\n\n    # Gaussian quadrature points and weights for the interval [-1, 1]\n    gauss_points_1d = [-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)]\n    gauss_weights_1d = [1.0, 1.0]\n\n    # --- Equilibrium Residual Calculation (Domain Integral) ---\n    sum_err_r_sq = 0.0\n    sum_norm_b_sq = 0.0\n    domain_area = 1.0\n\n    for i in range(N):\n        for j in range(N):\n            x0, y0 = i * h, j * h\n            \n            # Get exact stress at the 4 nodes of the cell (counter-clockwise from bottom-left)\n            s_nodes = {\n                's11': np.array([s11_f(x0, y0), s11_f(x0 + h, y0), s11_f(x0 + h, y0 + h), s11_f(x0, y0 + h)]),\n                's22': np.array([s22_f(x0, y0), s22_f(x0 + h, y0), s22_f(x0 + h, y0 + h), s22_f(x0, y0 + h)]),\n                's12': np.array([s12_f(x0, y0), s12_f(x0 + h, y0), s12_f(x0 + h, y0 + h), s12_f(x0, y0 + h)]),\n            }\n\n            for gp_xi_ref, w_xi in zip(gauss_points_1d, gauss_weights_1d):\n                for gp_eta_ref, w_eta in zip(gauss_points_1d, gauss_weights_1d):\n                    # Map from reference element [-1,1]x[-1,1] to physical cell\n                    # Local coordinates xi, eta are in [0,1]\n                    xi = (1.0 + gp_xi_ref) / 2.0\n                    eta = (1.0 + gp_eta_ref) / 2.0\n                    x, y = x0 + xi * h, y0 + eta * h\n\n                    # Calculate derivatives of interpolated stress components\n                    # d(f_h)/dx = (1/h) * [(f2-f1)(1-eta) + (f3-f4)eta]\n                    # d(f_h)/dy = (1/h) * [(f4-f1)(1-xi) + (f3-f2)xi]\n                    def get_derivs(f_nodes):\n                        df_dx = (1/h) * ((f_nodes[1] - f_nodes[0]) * (1 - eta) + (f_nodes[2] - f_nodes[3]) * eta)\n                        df_dy = (1/h) * ((f_nodes[3] - f_nodes[0]) * (1 - xi) + (f_nodes[2] - f_nodes[1]) * xi)\n                        return df_dx, df_dy\n\n                    ds11_dx, _ = get_derivs(s_nodes['s11'])\n                    _, ds22_dy = get_derivs(s_nodes['s22'])\n                    ds12_dx, ds12_dy = get_derivs(s_nodes['s12'])\n\n                    # Divergence of approximate stress\n                    div_s_h_x = ds11_dx + ds12_dy\n                    div_s_h_y = ds12_dx + ds22_dy\n\n                    # Exact body force\n                    b_x, b_y = bx_f(x, y), by_f(x, y)\n\n                    # Integrand for equilibrium residual\n                    residual_x = div_s_h_x + b_x\n                    residual_y = div_s_h_y + b_y\n                    \n                    dV = (h/2.0) * (h/2.0) * w_xi * w_eta # Area element\n                    sum_err_r_sq += (residual_x**2 + residual_y**2) * dV\n                    sum_norm_b_sq += (b_x**2 + b_y**2) * dV\n\n    # Final RMS values for residual\n    E_r = np.sqrt(sum_err_r_sq / domain_area)\n    rms_b = np.sqrt(sum_norm_b_sq / domain_area)\n    \n    if rms_b  1e-12: # Special case for zero body force\n        P_r = E_r  1e-10\n    else:\n        R_r = E_r / rms_b\n        P_r = R_r  0.05\n\n    # --- Traction Error Calculation (Boundary Integral) ---\n    sum_err_t_sq = 0.0\n    sum_norm_t_sq = 0.0\n    boundary_length = 4.0\n    \n    boundaries = {\n        'bottom': {'n': np.array([0, -1]), 'fixed_coord': 'y', 'val': 0.0, 'moving_coord': 'x'},\n        'right':  {'n': np.array([1, 0]),  'fixed_coord': 'x', 'val': 1.0, 'moving_coord': 'y'},\n        'top':    {'n': np.array([0, 1]),  'fixed_coord': 'y', 'val': 1.0, 'moving_coord': 'x'},\n        'left':   {'n': np.array([-1, 0]), 'fixed_coord': 'x', 'val': 0.0, 'moving_coord': 'y'},\n    }\n\n    for name, b_info in boundaries.items():\n        n = b_info['n']\n        for i in range(N):\n            # Define segment endpoints\n            p0_coord, p1_coord = i * h, (i + 1) * h\n            if b_info['moving_coord'] == 'x':\n                nodes = [(p0_coord, b_info['val']), (p1_coord, b_info['val'])]\n            else: # moving_coord == 'y'\n                nodes = [(b_info['val'], p0_coord), (b_info['val'], p1_coord)]\n            \n            # Get exact stress at segment endpoints\n            s11_nodes = np.array([s11_f(n_coord[0], n_coord[1]) for n_coord in nodes])\n            s22_nodes = np.array([s22_f(n_coord[0], n_coord[1]) for n_coord in nodes])\n            s12_nodes = np.array([s12_f(n_coord[0], n_coord[1]) for n_coord in nodes])\n\n            for gp_ref, w in zip(gauss_points_1d, gauss_weights_1d):\n                p_local = (1 + gp_ref) / 2.0 # local coord [0,1]\n                \n                # Physical coordinate of Gauss point\n                p_phys = p0_coord + p_local * h\n                if b_info['moving_coord'] == 'x':\n                    x, y = p_phys, b_info['val']\n                else:\n                    x, y = b_info['val'], p_phys\n                    \n                # Linearly interpolated stress at Gauss point\n                s11_h = s11_nodes[0] * (1 - p_local) + s11_nodes[1] * p_local\n                s22_h = s22_nodes[0] * (1 - p_local) + s22_nodes[1] * p_local\n                s12_h = s12_nodes[0] * (1 - p_local) + s12_nodes[1] * p_local\n                \n                # Approximate traction\n                t_h_x = s11_h * n[0] + s12_h * n[1]\n                t_h_y = s12_h * n[0] + s22_h * n[1]\n\n                # Exact stress and traction\n                s11, s22, s12 = s11_f(x, y), s22_f(x, y), s12_f(x, y)\n                t_exact_x = s11 * n[0] + s12 * n[1]\n                t_exact_y = s12 * n[0] + s22 * n[1]\n                \n                # Integrands\n                err_t_x = t_h_x - t_exact_x\n                err_t_y = t_h_y - t_exact_y\n                \n                ds = (h / 2.0) * w # Length element\n                sum_err_t_sq += (err_t_x**2 + err_t_y**2) * ds\n                sum_norm_t_sq += (t_exact_x**2 + t_exact_y**2) * ds\n\n    # Final RMS values for traction\n    E_t = np.sqrt(sum_err_t_sq / boundary_length)\n    rms_t_exact = np.sqrt(sum_norm_t_sq / boundary_length)\n\n    if rms_t_exact  1e-12:\n        P_t = E_t  1e-10\n    else:\n        R_t = E_t / rms_t_exact\n        P_t = R_t  0.05\n        \n    return [E_t, E_r, bool(P_t), bool(P_r)]\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}