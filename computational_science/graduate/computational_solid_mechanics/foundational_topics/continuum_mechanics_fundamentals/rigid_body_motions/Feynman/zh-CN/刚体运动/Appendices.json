{
    "hands_on_practices": [
        {
            "introduction": "本练习将理论与应用联系起来，要求您编写一个程序，以数值方式验证刚体运动的基本运动学条件。您将基于形变率张量和涡度实现测试，以区分刚体运动和变形流动，从而巩固您对这些核心概念的理解。这项实践让您能够通过编写代码，将抽象的数学定义转化为具体的检验工具 。",
            "id": "3596983",
            "problem": "设计并实现一个程序，通过检验从第一性原理推导出的三个不变量——形变率张量为零、散度为零、涡度（旋度）在空间上为常数——来验证一个数值采样的平面速度（或单位时间的位移）场是否代表刚体运动。该程序必须在均匀网格上构建几个测试场，使用有限差分计算数值导数，评估不变量，然后根据预设的容差判定每个场是否应被归类为刚体运动。\n\n推导的基本依据如下：\n- 牛顿运动学及瞬时速度场 $\\boldsymbol{v}(\\boldsymbol{x},t)$ 的定义。\n- 速度梯度 $\\boldsymbol{L} := \\nabla \\boldsymbol{v}$、形变率张量 $\\boldsymbol{D} := \\dfrac{1}{2}\\left(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}}\\right)$ 以及涡度（旋度）$\\boldsymbol{\\omega} := \\nabla \\times \\boldsymbol{v}$。\n- 对于刚体运动，空间速度场具有形式 $\\boldsymbol{v}(\\boldsymbol{x}) = \\boldsymbol{c} + \\boldsymbol{\\Omega}\\,\\boldsymbol{x}$，其中 $\\boldsymbol{\\Omega}$ 是反对称的，这蕴含了恒等式 $\\boldsymbol{D} = \\boldsymbol{0}$ 和 $\\nabla \\cdot \\boldsymbol{v} = \\mathrm{tr}(\\boldsymbol{L}) = 0$，并得出涡度 $\\boldsymbol{\\omega}$ 在空间上为常数。\n\n你的程序必须：\n- 在二维空间中的矩形网格上工作。设域为 $[-1,1]\\times[-0.9,0.9]$，$x$ 方向上有 $N_x = 41$ 个均匀分布的点，$y$ 方向上有 $N_y = 37$ 个均匀分布的点。因此，间距为 $\\Delta x = \\dfrac{2}{40} = 0.05$ 和 $\\Delta y = \\dfrac{1.8}{36} = 0.05$。\n- 将速度场表示为在网格上采样的 $\\boldsymbol{v}(x,y) = \\left(v_x(x,y), v_y(x,y)\\right)$。\n- 使用有限差分计算数值偏导数：\n  - 在内部网格点，对 $\\dfrac{\\partial (\\cdot)}{\\partial x}$ 和 $\\dfrac{\\partial (\\cdot)}{\\partial y}$ 使用二阶中心差分。\n  - 在边界网格点，使用与网格间距一致的一阶单边差分。\n- 构建速度梯度 $\\boldsymbol{L}(x,y)$，其元素为 $L_{11} = \\dfrac{\\partial v_x}{\\partial x}$、$L_{12} = \\dfrac{\\partial v_x}{\\partial y}$、$L_{21} = \\dfrac{\\partial v_y}{\\partial x}$、$L_{22} = \\dfrac{\\partial v_y}{\\partial y}$。\n- 逐点地形成形变率张量 $\\boldsymbol{D} = \\dfrac{1}{2}\\left(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}}\\right)$。在二维情况下，每个网格点上 $\\boldsymbol{D}$ 的弗罗贝尼乌斯范数为 $||\\boldsymbol{D}||_F = \\sqrt{D_{11}^2 + 2 D_{12}^2 + D_{22}^2}$。\n- 逐点地计算散度 $\\nabla \\cdot \\boldsymbol{v} = L_{11} + L_{22}$。\n- 逐点地计算标量离面涡度（二维旋度）$\\omega_z = \\dfrac{\\partial v_y}{\\partial x} - \\dfrac{\\partial v_x}{\\partial y}$。对于平面内的刚体运动，$\\omega_z$ 在空间上为常数（可能为零），且等于标量角速度的两倍。计算中不直接涉及度或弧度；将所有量视为无量纲，角度以弧度为单位。\n\n在网格上定义以下判决指标：\n- $E_D := \\max\\limits_{\\text{grid}} ||\\boldsymbol{D}||_F$,\n- $E_{\\mathrm{div}} := \\max\\limits_{\\text{grid}} \\left|\\nabla \\cdot \\boldsymbol{v}\\right|$,\n- $E_{\\mathrm{curlvar}} := \\max\\limits_{\\text{grid}} \\left|\\omega_z - \\overline{\\omega}_z\\right|$，其中 $\\overline{\\omega}_z$ 是 $\\omega_z$ 在网格上的空间平均值。\n\n使用以下容差：\n- $T_D = 5\\times 10^{-3}$,\n- $T_{\\mathrm{div}} = 5\\times 10^{-3}$,\n- $T_{\\mathrm{curlvar}} = 5\\times 10^{-3}$.\n\n当且仅当以下三个条件全部成立时，将场分类为刚体运动：\n- $E_D \\leq T_D$,\n- $E_{\\mathrm{div}} \\leq T_{\\mathrm{div}}$,\n- $E_{\\mathrm{curlvar}} \\leq T_{\\mathrm{curlvar}}$.\n\n实现以下测试套件，每个测试由一个在网格上采样的闭式速度场定义：\n- 测试 1（纯平移）：$\\boldsymbol{v}(x,y) = \\left(a, b\\right)$，其中 $a = 0.3, b = -0.2$。预期为刚体运动。\n- 测试 2（绕原点的纯旋转）：$\\boldsymbol{v}(x,y) = \\omega \\left(-y, x\\right)$，其中 $\\omega = 1.7$。预期为刚体运动。\n- 测试 3（旋转加平移）：$\\boldsymbol{v}(x,y) = \\omega \\left(-y, x\\right) + \\left(a, b\\right)$，其中 $\\omega = -0.8, a = 0.05, b = -0.04$。预期为刚体运动。\n- 测试 4（简单剪切，非刚体）：$\\boldsymbol{v}(x,y) = \\left(\\gamma y, 0\\right)$，其中 $\\gamma = 0.3$。预期为非刚体运动。\n- 测试 5（旋转加小噪声）：$\\boldsymbol{v}(x,y) = \\omega \\left(-y, x\\right) + \\varepsilon \\,\\boldsymbol{\\eta}(x,y)$，其中 $\\omega = 0.6$，$\\varepsilon = 10^{-4}$，且 $\\boldsymbol{\\eta}$ 是一个具有独立分量和单位方差的零均值随机场；固定一个确定性种子以使结果可复现。在给定容差下，预期为刚体运动。\n- 测试 6（各向同性膨胀，非刚体）：$\\boldsymbol{v}(x,y) = \\alpha \\left(x, y\\right)$，其中 $\\alpha = 10^{-2}$。预期为非刚体运动。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试 1 到 6 的顺序排列结果，每个条目是你所用编程语言的布尔字面量，指示该场是否被分类为刚体运动。例如，输出可能看起来像 $[\\mathrm{True},\\mathrm{False},\\dots]$。\n\n无需用户输入，也不得使用外部文件。所有随机量必须使用固定的种子生成，以确保可复现性。角度以弧度为单位。最终输出中不需要物理单位。每个测试的输出类型为布尔型，最终输出必须是指定格式的单行文本。",
            "solution": "该问题要求设计并实现一个数值程序，用于将二维速度场分类为是否代表刚体运动。此验证基于刚体运动的三个基本运动学不变量。从网格生成到最终分类的整个过程详述如下。\n\n### I. 刚体运动的运动学原理\n\n连续介质的运动由速度场 $\\boldsymbol{v}(\\boldsymbol{x}, t)$ 描述，该场在时间 $t$ 为空间中的每个点 $\\boldsymbol{x}$ 指定一个速度矢量。对于本问题，我们考虑稳态（不随时间变化）的平面速度场，$\\boldsymbol{v}(\\boldsymbol{x}) = (v_x(x,y), v_y(x,y))$。\n\n流动的局部行为由速度梯度张量 $\\boldsymbol{L}$ 表征，定义为：\n$$\n\\boldsymbol{L} = \\nabla \\boldsymbol{v} = \\begin{pmatrix} \\dfrac{\\partial v_x}{\\partial x} & \\dfrac{\\partial v_x}{\\partial y} \\\\ \\dfrac{\\partial v_y}{\\partial x} & \\dfrac{\\partial v_y}{\\partial y} \\end{pmatrix}\n$$\n张量 $\\boldsymbol{L}$ 可以唯一地分解为其对称和反对称部分：\n$$\n\\boldsymbol{L} = \\boldsymbol{D} + \\boldsymbol{W}\n$$\n其中 $\\boldsymbol{D}$ 是形变率（或应变率）张量，$\\boldsymbol{W}$ 是自旋（或涡量）张量：\n$$\n\\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}}) \\quad \\text{and} \\quad \\boldsymbol{W} = \\frac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{\\mathsf{T}})\n$$\n当且仅当任意两个物质点之间的距离随时间保持不变时，运动被定义为刚体运动。此运动学约束意味着形变率张量在整个物体内必须恒等于零，即 $\\boldsymbol{D} = \\boldsymbol{0}$。一般刚体运动的速度场具有形式 $\\boldsymbol{v}(\\boldsymbol{x}) = \\boldsymbol{c} + \\boldsymbol{\\Omega}\\,\\boldsymbol{x}$，其中 $\\boldsymbol{c}$ 是一个恒定的平移速度矢量，$\\boldsymbol{\\Omega}$ 是一个代表角速度的恒定反对称张量。对于这样的场，速度梯度为 $\\boldsymbol{L} = \\boldsymbol{\\Omega}$，它是一个常数且反对称。\n\n从条件 $\\boldsymbol{D} = \\boldsymbol{0}$，可以推导出另外两个不变量：\n1.  **零散度**：速度场的散度代表单位体积的体积变化率，它必须为零。散度是速度梯度的迹，$\\nabla \\cdot \\boldsymbol{v} = \\mathrm{tr}(\\boldsymbol{L}) = \\mathrm{tr}(\\boldsymbol{D}) + \\mathrm{tr}(\\boldsymbol{W})$。由于 $\\boldsymbol{W}$ 是反对称的，其迹为零，所以 $\\nabla \\cdot \\boldsymbol{v} = \\mathrm{tr}(\\boldsymbol{D})$。因此，如果 $\\boldsymbol{D} = \\boldsymbol{0}$，则 $\\nabla \\cdot \\boldsymbol{v} = 0$。\n2.  **空间恒定涡度**：涡度矢量 $\\boldsymbol{\\omega} = \\nabla \\times \\boldsymbol{v}$ 衡量流体微元的局部角速度。对于一个二维场 $\\boldsymbol{v} = (v_x, v_y, 0)$，涡度只有一个非零分量 $\\omega_z = \\frac{\\partial v_y}{\\partial x} - \\frac{\\partial v_x}{\\partial y}$。这通过 $\\omega_z = 2W_{21}$ 与自旋张量相关。对于刚体运动，$\\boldsymbol{L} = \\boldsymbol{\\Omega}$ 是常数，这意味着 $\\boldsymbol{W}$ 是常数，因此涡度 $\\omega_z$ 必须在空间上为常数。\n\n这三个条件构成了我们数值验证的基础：\n- 条件 1：形变率张量 $\\boldsymbol{D}$ 的大小为零。\n- 条件 2：散度 $\\nabla \\cdot \\boldsymbol{v}$ 为零。\n- 条件 3：标量涡度 $\\omega_z$ 在空间上为常数。\n\n### II. 数值实现\n\n我们给定一个矩形域 $[-1,1]\\times[-0.9,0.9]$，它被离散化为一个 $N_x = 41 \\times N_y = 37$ 个点的均匀网格。网格间距为 $\\Delta x = \\frac{1 - (-1)}{41 - 1} = 0.05$ 和 $\\Delta y = \\frac{0.9 - (-0.9)}{37 - 1} = 0.05$。速度分量 $v_x(x,y)$ 和 $v_y(x,y)$ 在每个网格点 $(x_j, y_i)$ 上进行采样。\n\n**A. 数值微分**\n\n计算速度梯度 $\\boldsymbol{L}$ 所需的偏导数是使用有限差分法计算的。对于一个在网格上采样为 $f_{i,j} = f(x_j, y_i)$ 的函数 $f(x,y)$：\n- 在内部点（$1 \\le j \\le N_x-2$），为保证精度使用二阶中心差分格式：\n  $$ \\frac{\\partial f}{\\partial x}\\bigg|_{i,j} \\approx \\frac{f_{i,j+1} - f_{i,j-1}}{2\\Delta x} $$\n- 在边界点（$j=0$ 和 $j=N_x-1$），使用一阶单边差分：\n  $$ \\frac{\\partial f}{\\partial x}\\bigg|_{i,0} \\approx \\frac{f_{i,1} - f_{i,0}}{\\Delta x} \\quad \\text{and} \\quad \\frac{\\partial f}{\\partial x}\\bigg|_{i,N_x-1} \\approx \\frac{f_{i,N_x-1} - f_{i,N_x-2}}{\\Delta x} $$\n类似的公式适用于关于 $y$ 的偏导数。这种混合格式提供了完整的导数场。\n\n**B. 指标计算**\n\n对于六个测试速度场中的每一个，我们执行以下步骤：\n1.  **场采样**：在网格坐标上评估 $v_x(x,y)$ 和 $v_y(x,y)$ 的解析函数，以生成两个形状为 $(N_y, N_x)$ 的数组 $\\boldsymbol{V}_x$ 和 $\\boldsymbol{V}_y$。对于随机情况，使用固定种子的随机数生成器以确保可复现性。\n2.  **计算速度梯度**：将数值微分格式应用于 $\\boldsymbol{V}_x$ 和 $\\boldsymbol{V}_y$，以计算每个网格点上速度梯度张量 $\\boldsymbol{L}$ 的四个分量：$L_{11} = \\frac{\\partial v_x}{\\partial x}$、$L_{12} = \\frac{\\partial v_x}{\\partial y}$、$L_{21} = \\frac{\\partial v_y}{\\partial x}$ 和 $L_{22} = \\frac{\\partial v_y}{\\partial y}$。\n3.  **评估不变量**：在每个网格点，我们计算：\n    - 形变率张量分量：$D_{11} = L_{11}$、$D_{22} = L_{22}$ 和 $D_{12} = \\frac{1}{2}(L_{12} + L_{21})$。\n    - $\\boldsymbol{D}$ 的弗罗贝尼乌斯范数：$||\\boldsymbol{D}||_F = \\sqrt{D_{11}^2 + 2 D_{12}^2 + D_{22}^2}$。\n    - 散度：$\\nabla \\cdot \\boldsymbol{v} = L_{11} + L_{22}$。\n    - 标量涡度：$\\omega_z = L_{21} - L_{12}$。\n4.  **计算判决指标**：通过取整个网格上的最大值，将不变量的空间分布场简化为单个标量指标：\n    - $E_D = \\max_{\\text{grid}} ||\\boldsymbol{D}||_F$\n    - $E_{\\mathrm{div}} = \\max_{\\text{grid}} |\\nabla \\cdot \\boldsymbol{v}|$\n    - $E_{\\mathrm{curlvar}} = \\max_{\\text{grid}} |\\omega_z - \\overline{\\omega}_z|$，其中 $\\overline{\\omega}_z$ 是所有网格点上 $\\omega_z$ 的平均值。\n\n**C. 分类**\n\n一个给定的速度场被分类为“刚体”，当且仅当其计算出的所有三个指标都低于各自预定义的容差：\n- $E_D \\leq T_D$，其中 $T_D = 5 \\times 10^{-3}$\n- $E_{\\mathrm{div}} \\leq T_{\\mathrm{div}}$，其中 $T_{\\mathrm{div}} = 5 \\times 10^{-3}$\n- $E_{\\mathrm{curlvar}} \\leq T_{\\mathrm{curlvar}}$，其中 $T_{\\mathrm{curlvar}} = 5 \\times 10^{-3}$\n\n解析上，前三个测试案例代表真实的刚体运动，因此它们的指标应该在机器精度和数值离散误差范围内为零。第四个（简单剪切）和第六个（各向同性膨胀）案例是非刚体运动，其指标 $E_D$ 和/或 $E_{\\mathrm{div}}$ 预计将显著大于容差。第五个案例，一个带有小加性噪声的刚性旋转，旨在测试方法的鲁棒性；其指标预计与噪声振幅 $\\varepsilon$ 除以网格间距 $\\Delta x$ 成正比，其值比容差小一个数量级，因此会正确地将其分类为刚体运动。所实现的程序对每个测试案例执行此逻辑，并报告布尔分类结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_derivatives(F, dx, dy):\n    \"\"\"\n    Computes partial derivatives of a 2D field F using finite differences.\n    - 2nd-order central differences for interior points.\n    - 1st-order one-sided differences for boundary points.\n    \n    Args:\n        F (np.ndarray): The 2D field of shape (Ny, Nx).\n        dx (float): Grid spacing in the x-direction.\n        dy (float): Grid spacing in the y-direction.\n    \n    Returns:\n        tuple[np.ndarray, np.ndarray]: A tuple (dF_dx, dF_dy).\n    \"\"\"\n    Ny, Nx = F.shape\n    dF_dx = np.zeros_like(F)\n    dF_dy = np.zeros_like(F)\n\n    # Compute dF/dx\n    # Interior points (central difference)\n    dF_dx[:, 1:-1] = (F[:, 2:] - F[:, :-2]) / (2 * dx)\n    # Boundary points (one-sided differences)\n    dF_dx[:, 0] = (F[:, 1] - F[:, 0]) / dx\n    dF_dx[:, -1] = (F[:, -1] - F[:, -2]) / dx\n\n    # Compute dF/dy\n    # Interior points (central difference)\n    dF_dy[1:-1, :] = (F[2:, :] - F[:-2, :]) / (2 * dy)\n    # Boundary points (one-sided differences)\n    dF_dy[0, :] = (F[1, :] - F[0, :]) / dy\n    dF_dy[-1, :] = (F[-1, :] - F[-2, :]) / dy\n\n    return dF_dx, dF_dy\n\ndef verify_field(vx, vy, dx, dy, tolerances):\n    \"\"\"\n    Verifies if a velocity field (vx, vy) represents a rigid body motion.\n\n    Args:\n        vx (np.ndarray): The x-component of the velocity field.\n        vy (np.ndarray): The y-component of the velocity field.\n        dx (float): Grid spacing in x.\n        dy (float): Grid spacing in y.\n        tolerances (dict): A dictionary with keys 'T_D', 'T_div', 'T_curlvar'.\n\n    Returns:\n        bool: True if the field is classified as rigid, False otherwise.\n    \"\"\"\n    # 1. Compute components of the velocity gradient tensor L\n    dvx_dx, dvx_dy = compute_derivatives(vx, dx, dy)\n    dvy_dx, dvy_dy = compute_derivatives(vy, dx, dy)\n    \n    L11 = dvx_dx\n    L12 = dvx_dy\n    L21 = dvy_dx\n    L22 = dvy_dy\n\n    # 2. Compute invariants\n    # Rate-of-deformation tensor D\n    D11 = L11\n    D22 = L22\n    D12 = 0.5 * (L12 + L21)\n    \n    # Frobenius norm of D, pointwise\n    norm_D_F = np.sqrt(D11**2 + 2 * D12**2 + D22**2)\n    \n    # Divergence\n    div_v = L11 + L22\n\n    # Vorticity (scalar z-component)\n    omega_z = L21 - L12\n\n    # 3. Compute decision metrics\n    E_D = np.max(norm_D_F)\n    E_div = np.max(np.abs(div_v))\n    \n    mean_omega_z = np.mean(omega_z)\n    E_curlvar = np.max(np.abs(omega_z - mean_omega_z))\n\n    # 4. Classify the field\n    T_D = tolerances['T_D']\n    T_div = tolerances['T_div']\n    T_curlvar = tolerances['T_curlvar']\n\n    is_rigid = (E_D = T_D) and (E_div = T_div) and (E_curlvar = T_curlvar)\n    \n    return is_rigid\n\ndef solve():\n    # Define grid parameters\n    Nx = 41\n    Ny = 37\n    x_min, x_max = -1.0, 1.0\n    y_min, y_max = -0.9, 0.9\n    \n    dx = (x_max - x_min) / (Nx - 1)\n    dy = (y_max - y_min) / (Ny - 1)\n\n    # Create grid\n    x = np.linspace(x_min, x_max, Nx)\n    y = np.linspace(y_min, y_max, Ny)\n    xx, yy = np.meshgrid(x, y, indexing='xy')\n\n    # Define tolerances\n    tolerances = {\n        'T_D': 5e-3,\n        'T_div': 5e-3,\n        'T_curlvar': 5e-3\n    }\n\n    # Define test cases\n    test_cases = [\n        # Test 1: Pure translation\n        lambda xx, yy: (0.3 * np.ones_like(xx), -0.2 * np.ones_like(yy)),\n        # Test 2: Pure rotation\n        lambda xx, yy: (1.7 * (-yy), 1.7 * xx),\n        # Test 3: Rotation plus translation\n        lambda xx, yy: (-0.8 * (-yy) + 0.05, -0.8 * xx - 0.04),\n        # Test 4: Simple shear (non-rigid)\n        lambda xx, yy: (0.3 * yy, np.zeros_like(xx)),\n        # Test 5: Rotation plus small noise\n        lambda xx, yy: (\n            lambda omega=0.6, eps=1e-4, seed=42: (\n                (rng := np.random.default_rng(seed)),\n                (omega * (-yy) + eps * rng.standard_normal(xx.shape), \n                 omega * xx + eps * rng.standard_normal(xx.shape))\n            )[1]\n        )(xx, yy),\n        # Test 6: Isotropic expansion (non-rigid)\n        lambda xx, yy: (1e-2 * xx, 1e-2 * yy)\n    ]\n\n    results = []\n    for test_func in test_cases:\n        vx, vy = test_func(xx, yy)\n        is_rigid = verify_field(vx, vy, dx, dy, tolerances)\n        results.append(is_rigid)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在计算力学中，小转动近似常被用来简化计算，但这种简化何时才有效呢？本练习将引导您对这种近似所引入的误差进行严格分析。通过推导其使用阈值，您将掌握一项创建高效且精确的仿真算法的关键技能 。",
            "id": "3597030",
            "problem": "一个在 $\\mathbb{R}^3$ 中的刚体绕单位轴 $\\hat{\\mathbf{n}} \\in \\mathbb{R}^3$（其中 $\\|\\hat{\\mathbf{n}}\\|=1$）进行纯旋转，旋转角度为 $\\theta \\in \\mathbb{R}$。令 $\\mathbf{R}(\\theta,\\hat{\\mathbf{n}}) \\in \\mathrm{SO}(3)$ 表示精确的旋转矩阵，它由生成元 $\\mathbf{S}=[\\hat{\\mathbf{n}}]_{\\times}$ 的矩阵指数得到，其中 $[\\cdot]_{\\times}$ 表示代表叉积运算的 $3 \\times 3$ 反对称矩阵。在计算固体力学的许多时间步进算法中，每一步都使用小旋转近似，即用 $\\mathbf{R}_{\\mathrm{s}}(\\theta,\\hat{\\mathbf{n}})=\\mathbf{I}+\\theta \\mathbf{S}$ 代替 $\\mathbf{R}(\\theta,\\hat{\\mathbf{n}})$。考虑由旋转矩阵之差的 Frobenius 范数给出的误差度量 $E_{F}(\\theta)=\\|\\mathbf{R}(\\theta,\\hat{\\mathbf{n}})-\\mathbf{R}_{\\mathrm{s}}(\\theta,\\hat{\\mathbf{n}})\\|_{F}$。仅从定义 $\\mathbf{R}(\\theta,\\hat{\\mathbf{n}})=\\exp(\\theta \\mathbf{S})$、叉积算子的性质以及标准矩阵范数和内积出发，完成以下任务：\n\n$1.$ 推导 $E_{F}(\\theta)$ 作为一个仅与 $\\theta$ 有关的闭式表达式，该表达式除了通过单位范数外，不依赖于 $\\hat{\\mathbf{n}}$ 的具体选择。\n\n$2.$ 在小角度 $\\theta$ 的渐近区域，反演您的主阶近似，以获得一个渐近精确的阈值角 $\\theta_{\\mathrm{crit}}(\\tau_{F})$，使得当 $|\\theta| \\le \\theta_{\\mathrm{crit}}(\\tau_{F})$ 时，$E_{F}(\\theta) \\le \\tau_{F}$ 在小公差 $\\tau_{F}  0$ 的主阶上成立。将 $\\theta_{\\mathrm{crit}}$ 以弧度表示。\n\n$3.$ 基于您的结果，为一个对角速度 $\\boldsymbol{\\omega}(t)$ 在大小为 $\\Delta t$ 的时间步长上进行积分的算法，陈述一个实用的切换准则：如果 $\\|\\boldsymbol{\\omega}\\| \\Delta t \\le \\theta_{\\mathrm{crit}}(\\tau_{F})$，则使用小旋转更新；否则切换到有限旋转表示，例如指数映射。\n\n您最终报告的答案必须是您在第 $2$ 项中得到的关于 $\\theta_{\\mathrm{crit}}(\\tau_{F})$ 的单一闭式渐近表达式。不需要进行数值舍入。角度必须以弧度为单位。",
            "solution": "该问题要求分析刚体力学中小旋转近似所产生的误差，并最终得出一个在数值算法中使用的实用准则。该问题是适定的，具有科学依据，并且可以使用线性代数和微积分的标准原理来解决。\n\n根据一个三部分问题的要求，分析分三个阶段进行。首先，推导误差矩阵的 Frobenius 范数 $E_{F}(\\theta)$ 的闭式表达式。其次，在小旋转角 $\\theta$ 的渐近极限下分析此表达式，以找到与给定误差公差 $\\tau_{F}$ 对应的临界角阈值 $\\theta_{\\mathrm{crit}}(\\tau_{F})$。第三，将此结果转化为刚体运动数值积分的实用切换准则。\n\n令 $\\hat{\\mathbf{n}}$ 为定义旋转轴的单位向量，$\\theta$ 为旋转角度。旋转的生成元是反对称矩阵 $\\mathbf{S} = [\\hat{\\mathbf{n}}]_{\\times}$。精确的旋转矩阵由矩阵指数给出：$\\mathbf{R}(\\theta, \\hat{\\mathbf{n}}) = \\exp(\\theta \\mathbf{S})$。小旋转近似是该指数的一阶泰勒展开式：$\\mathbf{R}_{\\mathrm{s}}(\\theta, \\hat{\\mathbf{n}}) = \\mathbf{I} + \\theta \\mathbf{S}$。\n\n推导将依赖于矩阵 $\\mathbf{S}$ 的代数性质。对于任何向量 $\\mathbf{v} \\in \\mathbb{R}^3$，有 $\\mathbf{S}\\mathbf{v} = \\hat{\\mathbf{n}} \\times \\mathbf{v}$。一个关键性质是 $\\mathbf{S}$ 的幂是相关的。使用向量三重积恒等式，我们有 $\\mathbf{S}^2 \\mathbf{v} = \\hat{\\mathbf{n}} \\times (\\hat{\\mathbf{n}} \\times \\mathbf{v}) = (\\hat{\\mathbf{n}} \\cdot \\mathbf{v})\\hat{\\mathbf{n}} - (\\hat{\\mathbf{n}} \\cdot \\hat{\\mathbf{n}})\\mathbf{v} = (\\hat{\\mathbf{n}}\\hat{\\mathbf{n}}^T)\\mathbf{v} - \\mathbf{I}\\mathbf{v}$。因此，矩阵恒等式为 $\\mathbf{S}^2 = \\hat{\\mathbf{n}}\\hat{\\mathbf{n}}^T - \\mathbf{I}$。由此，我们发现 $\\mathbf{S}^3 = \\mathbf{S}(\\hat{\\mathbf{n}}\\hat{\\mathbf{n}}^T - \\mathbf{I}) = \\mathbf{S}(\\hat{\\mathbf{n}}\\hat{\\mathbf{n}}^T) - \\mathbf{S}$。第一项为零，因为对于任何向量 $\\mathbf{v}$，$\\mathbf{S}(\\hat{\\mathbf{n}}\\hat{\\mathbf{n}}^T)\\mathbf{v} = \\hat{\\mathbf{n}} \\times ((\\hat{\\mathbf{n}} \\cdot \\mathbf{v})\\hat{\\mathbf{n}}) = (\\hat{\\mathbf{n}}\\cdot\\mathbf{v})(\\hat{\\mathbf{n}}\\times\\hat{\\mathbf{n}}) = \\mathbf{0}$。因此，我们得到了关键的恒等式 $\\mathbf{S}^3 = -\\mathbf{S}$。\n\n**$1.$ 误差范数 $E_{F}(\\theta)$ 的推导**\n\n我们首先通过展开其指数定义，将精确旋转矩阵 $\\mathbf{R}$ 表示为一个闭式形式，即 Rodrigues 旋转公式：\n$$ \\mathbf{R} = \\exp(\\theta \\mathbf{S}) = \\sum_{k=0}^{\\infty} \\frac{(\\theta \\mathbf{S})^k}{k!} = \\mathbf{I} + \\theta \\mathbf{S} + \\frac{\\theta^2}{2!} \\mathbf{S}^2 + \\frac{\\theta^3}{3!} \\mathbf{S}^3 + \\dots $$\n使用 $\\mathbf{S}^3 = -\\mathbf{S}$、$\\mathbf{S}^4 = -\\mathbf{S}^2$ 等关系，我们可以对各项进行分组：\n$$ \\mathbf{R} = \\mathbf{I} + \\left( \\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - \\dots \\right) \\mathbf{S} + \\left( \\frac{\\theta^2}{2!} - \\frac{\\theta^4}{4!} + \\frac{\\theta^6}{6!} - \\dots \\right) \\mathbf{S}^2 $$\n括号中的级数分别是 $\\sin\\theta$ 和 $(1-\\cos\\theta)$ 的泰勒级数。这便得到了 Rodrigues 公式：\n$$ \\mathbf{R}(\\theta, \\hat{\\mathbf{n}}) = \\mathbf{I} + (\\sin\\theta)\\mathbf{S} + (1-\\cos\\theta)\\mathbf{S}^2 $$\n误差矩阵 $\\mathbf{E}(\\theta)$ 是精确旋转与其一阶近似之间的差：\n$$ \\mathbf{E}(\\theta) = \\mathbf{R}(\\theta, \\hat{\\mathbf{n}}) - \\mathbf{R}_{\\mathrm{s}}(\\theta, \\hat{\\mathbf{n}}) = (\\mathbf{I} + (\\sin\\theta)\\mathbf{S} + (1-\\cos\\theta)\\mathbf{S}^2) - (\\mathbf{I} + \\theta\\mathbf{S}) $$\n$$ \\mathbf{E}(\\theta) = (\\sin\\theta - \\theta)\\mathbf{S} + (1-\\cos\\theta)\\mathbf{S}^2 $$\n误差度量是该矩阵的 Frobenius 范数，$E_{F}(\\theta) = \\|\\mathbf{E}(\\theta)\\|_{F}$。Frobenius 范数的平方由 $E_{F}^2(\\theta) = \\mathrm{Tr}(\\mathbf{E}(\\theta)^T \\mathbf{E}(\\theta))$ 给出。矩阵 $\\mathbf{S}$ 和 $\\mathbf{S}^2$ 在 Frobenius 内积 $\\langle\\mathbf{A}, \\mathbf{B}\\rangle_{F} = \\mathrm{Tr}(\\mathbf{A}^T\\mathbf{B})$ 下具有有用的正交性。具体来说，$\\mathbf{S}$ 是反对称的（$\\mathbf{S}^T = -\\mathbf{S}$），而 $\\mathbf{S}^2$ 是对称的（$(\\mathbf{S}^2)^T = \\mathbf{S}^2$）。它们的内积是：\n$$ \\langle \\mathbf{S}, \\mathbf{S}^2 \\rangle_{F} = \\mathrm{Tr}(\\mathbf{S}^T \\mathbf{S}^2) = \\mathrm{Tr}(-\\mathbf{S} \\mathbf{S}^2) = -\\mathrm{Tr}(\\mathbf{S}^3) = -\\mathrm{Tr}(-\\mathbf{S}) = \\mathrm{Tr}(\\mathbf{S}) = 0 $$\n因为任何反对称矩阵的迹都为 $0$。这种正交性允许我们将和的范数平方写成范数平方的和：\n$$ E_{F}^2(\\theta) = \\|(\\sin\\theta - \\theta)\\mathbf{S} + (1-\\cos\\theta)\\mathbf{S}^2\\|_{F}^2 = (\\sin\\theta - \\theta)^2 \\|\\mathbf{S}\\|_{F}^2 + (1-\\cos\\theta)^2 \\|\\mathbf{S}^2\\|_{F}^2 $$\n我们现在计算 $\\mathbf{S}$ 和 $\\mathbf{S}^2$ 的范数。$\\mathbf{S}^2 = \\hat{\\mathbf{n}}\\hat{\\mathbf{n}}^T - \\mathbf{I}$ 的迹是 $\\mathrm{Tr}(\\hat{\\mathbf{n}}\\hat{\\mathbf{n}}^T) - \\mathrm{Tr}(\\mathbf{I}) = \\|\\hat{\\mathbf{n}}\\|^2 - 3 = 1-3 = -2$。\n$$ \\|\\mathbf{S}\\|_{F}^2 = \\mathrm{Tr}(\\mathbf{S}^T\\mathbf{S}) = \\mathrm{Tr}(-\\mathbf{S}^2) = -\\mathrm{Tr}(\\mathbf{S}^2) = -(-2) = 2 $$\n$$ \\|\\mathbf{S}^2\\|_{F}^2 = \\mathrm{Tr}((\\mathbf{S}^2)^T\\mathbf{S}^2) = \\mathrm{Tr}(\\mathbf{S}^4) = \\mathrm{Tr}(-\\mathbf{S}^2) = -(-2) = 2 $$\n将这些范数代回 $E_{F}^2(\\theta)$ 的表达式中：\n$$ E_{F}^2(\\theta) = 2(\\sin\\theta - \\theta)^2 + 2(1-\\cos\\theta)^2 $$\n取平方根，得到误差的闭式表达式，该表达式与 $\\hat{\\mathbf{n}}$ 无关：\n$$ E_{F}(\\theta) = \\sqrt{2 \\left( (\\sin\\theta - \\theta)^2 + (1-\\cos\\theta)^2 \\right)} $$\n\n**$2.$ $\\theta_{\\mathrm{crit}}(\\tau_{F})$ 的渐近分析**\n\n为了找到小角度 $\\theta$ 的渐近行为，我们使用 $\\sin\\theta$ 和 $\\cos\\theta$ 在 $\\theta=0$ 附近的泰勒级数展开：\n$$ \\sin\\theta = \\theta - \\frac{\\theta^3}{6} + O(\\theta^5) \\implies \\sin\\theta - \\theta = -\\frac{\\theta^3}{6} + O(\\theta^5) $$\n$$ \\cos\\theta = 1 - \\frac{\\theta^2}{2} + O(\\theta^4) \\implies 1 - \\cos\\theta = \\frac{\\theta^2}{2} + O(\\theta^4) $$\n将这些代入 $E_{F}^2(\\theta)$ 的表达式中：\n$$ E_{F}^2(\\theta) = 2\\left( \\left(-\\frac{\\theta^3}{6} + O(\\theta^5)\\right)^2 + \\left(\\frac{\\theta^2}{2} + O(\\theta^4)\\right)^2 \\right) = 2\\left( \\frac{\\theta^6}{36} + O(\\theta^8) + \\frac{\\theta^4}{4} + O(\\theta^6) \\right) $$\n对于小角度 $\\theta$，主导项是 $\\theta$ 的最低次幂项，即 $\\theta^4$：\n$$ E_{F}^2(\\theta) \\approx 2 \\left( \\frac{\\theta^4}{4} \\right) = \\frac{\\theta^4}{2} $$\n取平方根得到误差范数的主阶近似：\n$$ E_{F}(\\theta) \\approx \\sqrt{\\frac{\\theta^4}{2}} = \\frac{|\\theta|^2}{\\sqrt{2}} $$\n问题将 $\\theta_{\\mathrm{crit}}(\\tau_{F})$ 定义为阈值角，对于该角度，$E_{F}(\\theta_{\\mathrm{crit}}) = \\tau_{F}$，其中 $\\tau_{F}  0$ 是一个小的公差。使用我们的渐近结果：\n$$ \\frac{\\theta_{\\mathrm{crit}}^2}{\\sqrt{2}} = \\tau_{F} $$\n求解 $\\theta_{\\mathrm{crit}}$（取正根，因为它代表角度的大小）：\n$$ \\theta_{\\mathrm{crit}}^2 = \\tau_{F}\\sqrt{2} \\implies \\theta_{\\mathrm{crit}}(\\tau_{F}) = \\sqrt{\\tau_{F}\\sqrt{2}} = (2\\tau_{F}^2)^{1/4} = 2^{1/4} \\tau_{F}^{1/2} $$\n\n**$3.$ 实用切换准则**\n\n在刚体动力学的数值积分方案中，刚体的方位在小的时间步长 $\\Delta t$ 内更新。如果刚体具有角速度 $\\boldsymbol{\\omega}(t)$，则时间步长内的旋转角度约为 $\\theta = \\|\\boldsymbol{\\omega}\\| \\Delta t$，旋转轴为 $\\hat{\\mathbf{n}} = \\boldsymbol{\\omega}/\\|\\boldsymbol{\\omega}\\|$。增量旋转矩阵为 $\\exp(\\Delta t[\\boldsymbol{\\omega}]_{\\times})$。\n\n上述误差分析为判断计算成本较低的小旋转近似何时足够精确提供了定量依据。准则是将近似误差 $E_F$ 保持在规定的公差 $\\tau_F$ 以下。这等同于将旋转角 $\\theta$ 保持在推导出的临界角 $\\theta_{\\mathrm{crit}}(\\tau_F)$ 以下。\n\n实用的切换准则如下：\n给定一个用户定义的误差公差 $\\tau_F$，首先计算临界角 $\\theta_{\\mathrm{crit}}(\\tau_{F}) = 2^{1/4}\\tau_{F}^{1/2}$。然后，在每个时间步长 $\\Delta t$：\n\\begin{enumerate}\n    \\item 计算角增量的大小：$\\theta = \\|\\boldsymbol{\\omega}\\| \\Delta t$。\n    \\item 如果 $\\theta \\le \\theta_{\\mathrm{crit}}(\\tau_{F})$，则小旋转近似足够精确。使用线性公式更新方位：$\\mathbf{R}_{\\mathrm{new}} = (\\mathbf{I} + \\Delta t [\\boldsymbol{\\omega}]_{\\times}) \\mathbf{R}_{\\mathrm{old}}$。\n    \\item 如果 $\\theta  \\theta_{\\mathrm{crit}}(\\tau_{F})$，误差将超过公差。必须使用更精确、通常也更昂贵的更新方法，例如完全指数映射：$\\mathbf{R}_{\\mathrm{new}} = \\exp(\\Delta t [\\boldsymbol{\\omega}]_{\\times}) \\mathbf{R}_{\\mathrm{old}}$。\n\\end{enumerate}\n该准则通过在其有效范围内使用最廉价的方法来确保计算效率，同时通过对较大的旋转切换到更好的表示来保持精度。",
            "answer": "$$\\boxed{2^{1/4} \\tau_{F}^{1/2}}$$"
        },
        {
            "introduction": "纯粹的刚体转动不应产生任何物理应变，然而，对于数值算法而言，情况并非总是如此。本练习通过比较两种不同的应变更新方案，探讨了算法客观性这一关键概念。它揭示了某些方法如何在大转动下错误地产生“伪应变”，这对于理解和构建可靠的大变形模型至关重要 。",
            "id": "3597009",
            "problem": "你的任务是在计算固体力学领域设计并实现一个计算实验，以评估在大刚体转动下的算法客观性。考虑一个仅由时间相关的刚体转动引起的变形，其中变形梯度为 $F(t) = R(t)$，且 $R(t) \\in \\mathrm{SO}(3)$，$\\det(R(t)) = 1$。空间速度梯度为 $L(t) = \\dot{F}(t) F(t)^{-1}$，在纯转动下，它满足 $L(t) = \\dot{R}(t) R(t)^{\\mathsf{T}} = W(t)$，其中 $W(t)$ 是一个反对称自旋张量。变形率张量为 $D(t) = \\frac{1}{2} \\left( L(t) + L(t)^{\\mathsf{T}} \\right) = 0$（对于所有 $t$ 在刚体转动下）。转动根据基本运动学关系 $\\dot{R}(t) = W(t) R(t)$ 演化，其中 $W(t)$ 由随时间变化的角速度矢量 $\\omega(t)$ 通过 $W(t) = \\mathrm{skew}(\\omega(t))$ 生成，$\\mathrm{skew}(\\omega)$ 是一个 $3 \\times 3$ 的反对称矩阵，使得对于任意矢量 $x$，有 $W(t) x = \\omega(t) \\times x$。\n\n从这些核心定义和定律出发，为纯转动路径 $F(t) = R(t)$ 推导并实现两种不同的算法应变更新：\n\n1) 一种与 Jaumann 余旋法在旋转坐标系中累积小应变相一致的离散更新。该更新通过在时间 $t_n$ 的当前余旋坐标系中工作，并累加从 $t_n$ 到 $t_{n+1}$ 的对称增量映射来构建。此更新必须从第一性原理出发，使用上述运动学基础进行推导，并且必须将 $N$ 步后的累积应变张量表示为依赖于步间离散转动的对称增量之和。\n\n2) 一种与 Hencky 应变（对数应变）相关的对数率相一致的离散更新。其中应变增量从右伸长张量的谱定义中导出，该张量从极分解 $F = R U$ 中提取。在纯转动下，利用基本事实 $U(t) = I$，且 Hencky 应变由矩阵对数 $E(t) = \\log(U(t))$ 定义。推导离散更新，并展示其如何逐步计算。\n\n定义在时间 $t$ 的人为剪切量级 $\\tau(t)$ 为空间坐标系中累积应变张量非对角分量的欧几里得范数，即对于一个对称应变张量 $E(t)$，定义\n$$\n\\tau(t) = \\sqrt{E_{12}(t)^2 + E_{13}(t)^2 + E_{23}(t)^2}.\n$$\n你的程序必须：\n- 通过积分 $\\dot{R}(t) = W(t) R(t)$ 并设 $R(0) = I$ 来构造 $R(t)$，其中角速度为 $\\omega(t) = \\Omega \\, n(t)$，$\\Omega$ 为恒定大小，时变单位轴 $n(t)$ 由固定的极角 $\\vartheta$ 和进动率 $\\beta$ 定义为\n$$\nn(t) = \\big[ \\cos(\\beta t) \\sin(\\vartheta), \\; \\sin(\\beta t) \\sin(\\vartheta), \\; \\cos(\\vartheta) \\big]^{\\mathsf{T}}.\n$$\n- 使用固定的时间步长 $\\Delta t$ 和 $N = T / \\Delta t$ 步来离散积分转动，其中一个步长内的增量转动由该步开始时的角速度获得。\n- 实现两种更新（Jaumann 和对数率），累积各步的应变张量，并计算每种更新在最终时间 $T$ 时的 $\\tau(T)$。\n\n你必须报告 $\\tau(T)$ 如何依赖于转动速率的范数和时间步长。在你的推导中，将纯转动下 $\\|\\dot{R}(t)\\|_{\\mathrm{F}}$ 的 Frobenius 范数与角速度 $\\|\\omega(t)\\|$ 联系起来。角度使用弧度。时间单位为秒。角速度 $\\Omega$ 和进动率 $\\beta$ 的单位为弧度/秒。人为剪切量级 $\\tau(T)$ 是无量纲的。\n\n测试套件：\n使用以下参数集，每个参数集由 $(\\Omega,\\beta,\\vartheta,T,\\Delta t)$ 定义：\n- 情况 1：$(\\Omega,\\beta,\\vartheta,T,\\Delta t) = (5.0, 3.0, \\pi/4, 1.0, 1.0 \\times 10^{-3})$。\n- 情况 2：$(\\Omega,\\beta,\\vartheta,T,\\Delta t) = (5.0, 3.0, \\pi/4, 1.0, 1.0 \\times 10^{-4})$。\n- 情况 3：$(\\Omega,\\beta,\\vartheta,T,\\Delta t) = (20.0, 7.0, \\pi/3, 0.5, 5.0 \\times 10^{-3})$。\n- 情况 4：$(\\Omega,\\beta,\\vartheta,T,\\Delta t) = (0.0, 5.0, \\pi/4, 1.0, 1.0 \\times 10^{-3})$。\n- 情况 5：$(\\Omega,\\beta,\\vartheta,T,\\Delta t) = (5.0, 3.0, \\pi/4, 1.0, 2.0 \\times 10^{-2})$。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含情况 1 到 5 的 Jaumann 更新在最终时间 $T$ 的人为剪切量级，然后是情况 1 到 5 的对数率更新在最终时间 $T$ 的人为剪切量级。例如，输出必须是以下形式：\n$$\n[\\tau^{\\mathrm{J}}_1,\\tau^{\\mathrm{J}}_2,\\tau^{\\mathrm{J}}_3,\\tau^{\\mathrm{J}}_4,\\tau^{\\mathrm{J}}_5,\\tau^{\\log}_1,\\tau^{\\log}_2,\\tau^{\\log}_3,\\tau^{\\log}_4,\\tau^{\\log}_5].\n$$\n所有角度都以弧度为单位，报告的 $\\tau$ 值为无量纲浮点数。",
            "solution": "该问题是有效的。这是一个在计算固体力学中定义明确的问题，其科学基础在于连续介质力学和大变形运动学原理。它要求推导和实现两种不同的数值应变更新算法，以展示算法客观性的概念，这是计算固体力学的一个基石。所有必要的数据和条件都已提供。\n\n问题的核心是分析两种应变累积方案在纯刚体转动下的行为。从解析上看，纯刚体运动不会引起变形或应变。因此，由数值算法计算出的任何非零应变都是人为产物，通常称为“伪应变”。目标是量化基于 Jaumann 率的更新所产生的这种人为产物，并将其与基于 Hencky（对数）应变的总拉格朗日更新进行对比。\n\n**1. 运动学预备知识**\n\n变形是纯刚体转动，由变形梯度 $F(t) = R(t)$ 描述，其中 $R(t) \\in \\mathrm{SO}(3)$ 是在时间 $t$ 的正常正交旋转矩阵。初始状态是未变形的，因此 $R(0) = I$（单位矩阵）。\n\n空间速度梯度为 $L(t) = \\dot{F}(t) F(t)^{-1} = \\dot{R}(t) R(t)^{\\mathsf{T}}$。由于 $R(t) R(t)^{\\mathsf{T}} = I$，对时间求导可得 $\\dot{R}(t) R(t)^{\\mathsf{T}} + R(t) \\dot{R}(t)^{\\mathsf{T}} = 0$。这意味着 $L(t) + L(t)^{\\mathsf{T}} = 0$，即 $L(t)$ 是一个反对称张量。这个张量就是自旋张量，$W(t) = L(t)$。\n\n变形率张量 $D(t)$ 是 $L(t)$ 的对称部分：\n$$\nD(t) = \\frac{1}{2} \\left( L(t) + L(t)^{\\mathsf{T}} \\right) = \\frac{1}{2} \\left( W(t) + W(t)^{\\mathsf{T}} \\right) = 0\n$$\n由于 $D(t)$ 恒等于零，因此不存在物理上的应变率。\n\n运动学由关系 $\\dot{R}(t) = W(t) R(t)$ 控制，其中 $W(t)$ 从角速度矢量 $\\omega(t)$ 通过反对称算子 $W(t) = \\mathrm{skew}(\\omega(t))$ 生成。\n\n问题要求将 $\\dot{R}(t)$ 的 Frobenius 范数与 $\\omega(t)$ 的范数联系起来。\n$$\n\\|\\dot{R}(t)\\|_{\\mathrm{F}}^2 = \\mathrm{Tr}(\\dot{R}(t)^{\\mathsf{T}}\\dot{R}(t)) = \\mathrm{Tr}\\left( (W(t)R(t))^{\\mathsf{T}} (W(t)R(t)) \\right) = \\mathrm{Tr}(R(t)^{\\mathsf{T}}W(t)^{\\mathsf{T}}W(t)R(t))\n$$\n利用迹的循环性质 $\\mathrm{Tr}(ABC) = \\mathrm{Tr}(CAB)$，我们有：\n$$\n\\|\\dot{R}(t)\\|_{\\mathrm{F}}^2 = \\mathrm{Tr}(W(t)^{\\mathsf{T}}W(t)R(t)R(t)^{\\mathsf{T}}) = \\mathrm{Tr}(W(t)^{\\mathsf{T}}W(t))\n$$\n设 $\\omega = [\\omega_1, \\omega_2, \\omega_3]^{\\mathsf{T}}$。$W = \\mathrm{skew}(\\omega)$ 的 Frobenius 范数为 $\\|W\\|_{\\mathrm{F}}^2 = 2(\\omega_1^2 + \\omega_2^2 + \\omega_3^2) = 2\\|\\omega\\|^2$。由于 $\\mathrm{Tr}(W^{\\mathsf{T}}W) = \\|W\\|_{\\mathrm{F}}^2$，我们有 $\\|\\dot{R}(t)\\|_{\\mathrm{F}}^2 = 2\\|\\omega(t)\\|^2$。因此，$\\|\\dot{R}(t)\\|_{\\mathrm{F}} = \\sqrt{2}\\|\\omega(t)\\|$。给定 $\\|\\omega(t)\\| = \\Omega$ 是一个常数，我们得到 $\\|\\dot{R}(t)\\|_{\\mathrm{F}} = \\sqrt{2}\\Omega$。\n\n**2. 转动的数值积分**\n\n演化方程 $\\dot{R}(t) = W(t) R(t)$ 在大小为 $\\Delta t$ 的离散时间步长上进行积分。我们在李群 $\\mathrm{SO}(3)$ 上使用一阶显式积分器。给定 $R_n = R(t_n)$，下一步的转动 $R_{n+1} = R(t_{n+1})$ 可通过以下方式求得：\n$$\nR_{n+1} = \\Delta R_n R_n \n$$\n其中 $\\Delta R_n$ 是在 $[t_n, t_{n+1}]$ 上的增量转动。该增量使用区间开始时的角速度 $\\omega_n = \\omega(t_n)$ 和矩阵指数进行近似：\n$$\n\\Delta R_n = \\exp(\\Delta t \\, W_n) \\quad \\text{其中} \\quad W_n = \\mathrm{skew}(\\omega_n)\n$$\n反对称矩阵 $\\mathrm{skew}(w)$ 的矩阵指数是一个旋转矩阵，由 Rodrigues 公式给出：\n$$\n\\exp(\\mathrm{skew}(w)) = I + \\frac{\\sin \\theta}{\\theta} \\mathrm{skew}(w) + \\frac{1 - \\cos \\theta}{\\theta^2} (\\mathrm{skew}(w))^2\n$$\n其中 $\\theta = \\|w\\|$。在我们的情况下，$w = \\Delta t \\, \\omega_n$ 且 $\\theta = \\Delta t \\|\\omega_n\\| = \\Delta t \\Omega$。这种数值方案能正确保持旋转矩阵的正交性，即如果 $R_n \\in \\mathrm{SO}(3)$，那么 $R_{n+1} \\in \\mathrm{SO}(3)$。\n\n**3. Jaumann 余旋更新的推导**\n\n对称应变张量 $E$ 的 Jaumann 率由 $E^\\nabla = \\dot{E} - WE + EW$ 给出。对于亚弹性材料，这个客观率与变形率相关，$E^\\nabla = D$。由于对于纯转动 $D(t)=0$，我们有 $\\dot{E} = WE - EW$。\n\n一个看似直接的离散化是 $E_{n+1} = E_n + \\Delta t (W_n E_n - E_n W_n)$。然而，这种方案无法保持 $E$ 的对称性。问题源于在离散设置中，变形率 $D$ 并非精确为零。一个有效的变形率 $D_n$ 来自于运动学的近似。\n设增量变形为 $\\Delta R_n = \\exp(\\Delta t W_n)$。区间内的平均空间速度梯度约为 $L_{avg} \\approx \\frac{1}{\\Delta t} (\\Delta R_n - I)$。\n相应的变形率张量近似为：\n$$\nD_n = \\text{symm}(L_{avg}) = \\frac{1}{2\\Delta t} (\\Delta R_n + \\Delta R_n^{\\mathsf{T}} - 2I)\n$$\n使用 Rodrigues 公式处理 $\\Delta R_n = \\exp(\\Delta t W_n)$ 和 $\\Delta R_n^{\\mathsf{T}} = \\exp(-\\Delta t W_n)$：\n$$\n\\Delta R_n + \\Delta R_n^{\\mathsf{T}} = 2I + 2 \\frac{1-\\cos(\\theta_n)}{\\theta_n^2} (\\Delta t W_n)^2\n$$\n其中 $\\theta_n = \\Delta t \\Omega$。将此代入 $D_n$ 的表达式中：\n$$\nD_n = \\frac{1}{2\\Delta t} \\left( 2 \\frac{1-\\cos(\\theta_n)}{\\theta_n^2} (\\Delta t W_n)^2 \\right) = \\frac{1-\\cos(\\Delta t \\Omega)}{\\Delta t \\Omega^2} W_n^2\n$$\n当 $\\Omega  0$ 且 $\\Delta t  0$ 时，这个数值变形率 $D_n$ 是非零的。Jaumann 更新基于这个伪变形率累积应变增量。问题指定了“对称增量映射”的“累加”。这对应于最简单的更新方案：\n$$\nE_{n+1}^{\\mathrm{J}} = E_{n}^{\\mathrm{J}} + \\Delta E_n\n$$\n其中应变增量 $\\Delta E_n$ 是 $\\Delta t D_n$。\n$$\n\\Delta E_n = \\Delta t D_n = \\frac{1 - \\cos(\\Delta t \\Omega)}{\\Omega^2} W_n^2\n$$\n此更新在每一步执行，从 $E_0^{\\mathrm{J}} = 0$ 开始。在最终时间 $T=N\\Delta t$ 时的累积应变 $E_N^{\\mathrm{J}}$ 将是非零的，导致非零的人为剪切量级 $\\tau^{\\mathrm{J}}(T)$。请注意，如果 $\\Omega=0$，则 $W_n=0$ 且 $\\Delta E_n=0$，正确地得到零应变。\n\n**4. 对数应变更新的推导**\n\nHencky 应变（对数应变）是根据总变形定义的。首先，计算右 Cauchy-Green 张量：$C(t) = F(t)^{\\mathsf{T}} F(t)$。然后，通过谱分解找到右伸长张量 $U(t) = \\sqrt{C(t)}$。最后，Hencky 应变为 $E(t) = \\log(U(t))$，其中 $\\log$ 是矩阵对数。\n\n在纯刚体转动的情况下，任何时间 $t$ 的变形梯度是 $F(t) = R(t)$。由于 $R(t)$ 是一个旋转矩阵，所以 $R(t)^{\\mathsf{T}} R(t) = I$。\n计算过程如下：\n1. $C(t) = F(t)^{\\mathsf{T}} F(t) = R(t)^{\\mathsf{T}} R(t) = I$。\n2. $U(t) = \\sqrt{C(t)} = \\sqrt{I} = I$。\n3. $E^{\\log}(t) = \\log(U(t)) = \\log(I) = 0$。\n\n这对于离散数值方案同样成立。旋转矩阵通过 $R_{n+1} = \\Delta R_n R_n$ 更新。由于 $\\Delta R_n$ 和 $R_n$ 都是旋转矩阵（$\\mathrm{SO}(3)$ 的元素），它们的乘积 $R_{n+1}$ 也是一个旋转矩阵。因此，在模拟的任何步骤 $n$，我们都有 $F_n = R_n \\in \\mathrm{SO}(3)$。\n在最终时间 $T$ 的离散应变计算得出：\n1. $F_N = R_N$。\n2. $C_N = F_N^{\\mathsf{T}} F_N = R_N^{\\mathsf{T}} R_N = I$。\n3. $U_N = I$。\n4. $E_N^{\\log} = 0$。\n\n对于此应变度量，“逐步更新”只是在任何给定时间从总变形梯度重新评估应变。由于它始终为零，累积应变也自然为零。这证明了 Hencky 应变度量的客观性；它正确地记录了纯刚体运动的零应变，无论转动路径或大小如何。\n\n**5. 人为剪切量级的计算**\n\n对于每种更新方案，人为剪切量级 $\\tau(T)$ 从最终累积应变张量 $E(T)$ 计算得出：\n$$\n\\tau(T) = \\sqrt{(E_{12}(T))^2 + (E_{13}(T))^2 + (E_{23}(T))^2}\n$$\n对于 Jaumann 更新，这将是一个非零值，依赖于问题参数，特别是 $\\Omega$ 和 $\\Delta t$。对于对数应变更新，所有测试案例的 $\\tau^{\\log}(T)$ 都将为零。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational solid mechanics problem to assess algorithmic objectivity\n    under large rigid body rotations for Jaumann and logarithmic strain updates.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Omega, beta, vartheta, T, dt)\n    test_cases = [\n        # Case 1\n        (5.0, 3.0, np.pi/4, 1.0, 1.0e-3),\n        # Case 2\n        (5.0, 3.0, np.pi/4, 1.0, 1.0e-4),\n        # Case 3\n        (20.0, 7.0, np.pi/3, 0.5, 5.0e-3),\n        # Case 4\n        (0.0, 5.0, np.pi/4, 1.0, 1.0e-3),\n        # Case 5\n        (5.0, 3.0, np.pi/4, 1.0, 2.0e-2),\n    ]\n\n    results_jaumann = []\n    results_log = []\n\n    for case in test_cases:\n        Omega, beta, vartheta, T, dt = case\n        \n        # Use a robust method to calculate the number of steps\n        num_steps = int(round(T / dt))\n\n        # --- Jaumann Corotational Update Calculation ---\n        # Initialize the accumulated strain tensor\n        E_jaumann = np.zeros((3, 3))\n        \n        # Pre-calculate constant values for the loop\n        sin_vartheta = np.sin(vartheta)\n        cos_vartheta = np.cos(vartheta)\n\n        # The factor multiplying W^2 in the strain increment formula\n        # Handle the case Omega = 0 to avoid division by zero.\n        # This is the stable evaluation of (1-cos(x))/x^2 for x=dt*Omega\n        if abs(Omega) > 1e-12:\n            factor = (1.0 - np.cos(dt * Omega)) / (Omega**2)\n        else:\n            factor = 0.0  # As Omega -> 0, the increment is zero.\n\n        for n in range(num_steps):\n            t_n = n * dt\n            \n            # If the factor is zero (e.g., Omega=0), no strain accumulates.\n            if factor == 0.0:\n                break\n                \n            # Define the time-varying rotation axis n(t)\n            nx = np.cos(beta * t_n) * sin_vartheta\n            ny = np.sin(beta * t_n) * sin_vartheta\n            nz = cos_vartheta\n            \n            # Angular velocity vector omega(t) = Omega * n(t)\n            omega_n = Omega * np.array([nx, ny, nz])\n            \n            # Skew-symmetric spin tensor W(t)\n            W_n = np.array([[0.0, -omega_n[2], omega_n[1]],\n                            [omega_n[2], 0.0, -omega_n[0]],\n                            [-omega_n[1], omega_n[0], 0.0]])\n            \n            # Square of the spin tensor\n            W2_n = W_n @ W_n\n            \n            # Calculate the spurious strain increment\n            delta_E = factor * W2_n\n            \n            # Additively accumulate the strain increment\n            E_jaumann += delta_E\n        \n        # Calculate artificial shear magnitude from off-diagonal components\n        # tau = sqrt(E12^2 + E13^2 + E23^2)\n        tau_jaumann = np.sqrt(E_jaumann[0, 1]**2 + E_jaumann[0, 2]**2 + E_jaumann[1, 2]**2)\n        results_jaumann.append(tau_jaumann)\n\n        # --- Logarithmic Strain Update Calculation ---\n        # As derived in the solution, for a pure rigid body rotation, the Hencky\n        # strain is identically zero. Therefore, the artificial shear is zero.\n        results_log.append(0.0)\n    \n    # Combine results into the final list as specified\n    final_results = results_jaumann + results_log\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures consistent floating point representation.\n    print(f\"[{','.join(f'{r:.10f}' for r in final_results)}]\")\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}