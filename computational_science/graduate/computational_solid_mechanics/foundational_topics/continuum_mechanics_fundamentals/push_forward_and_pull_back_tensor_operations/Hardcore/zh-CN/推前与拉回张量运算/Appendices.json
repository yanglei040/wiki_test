{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固前推与回拉操作的基本定义。通过一个具体的变形梯度 $\\mathbf{F}$，我们将练习如何将参考构型中的向量 $\\mathbf{V}$ 前推到当前构型得到空间向量 $\\mathbf{v}$，以及如何将当前构型中的对偶向量 $\\mathbf{a}$ 回拉到参考构型得到物质对偶向量 $\\mathbf{A}$。这个练习的关键之处在于验证对偶配对的不变性，即 $\\mathbf{a} \\cdot \\mathbf{v} = \\mathbf{A} \\cdot \\mathbf{V}$，这一关系是保证物理量（如力在位移上所做的功）在不同构型下计算结果一致性的核心 。",
            "id": "3591896",
            "problem": "考虑一个变形的三维体，其从参考构型到当前构型的光滑运动由映射 $\\boldsymbol{\\varphi}:\\mathcal{B}_{0}\\rightarrow\\mathcal{B}$ 描述，其变形梯度由运动的参考梯度定义，即 $\\mathbf{F}(\\mathbf{X})=\\nabla_{\\mathbf{X}}\\boldsymbol{\\varphi}(\\mathbf{X})$。参考向量 $\\mathbf{V}$ 的前推是通过变形梯度作用得到的空间向量 $\\mathbf{v}$，而空间余向量 $\\mathbf{a}$ 的拉回是通过变形梯度的转置作用得到的参考余向量 $\\mathbf{A}$。这些构造保持了向量和余向量之间的欧几里得对偶配对不变，即在当前构型中计算的配对等于在参考构型中计算的配对。\n\n设运动在物质点 $\\mathbf{X}=(X_{1},X_{2},X_{3})$ 处的变形梯度由 $\\boldsymbol{\\varphi}$ 的以下分量的参考梯度给出：\n$$\n\\varphi_{1}(\\mathbf{X})=X_{1}+\\tfrac{1}{2}X_{1}^{2}-0.1\\,X_{2},\\quad\n\\varphi_{2}(\\mathbf{X})=X_{2}+X_{3}^{2}\\,X_{2},\\quad\n\\varphi_{3}(\\mathbf{X})=X_{3}+0.3\\,X_{1}+0.06\\,X_{1}X_{3}.\n$$\n计算在物质点 $\\mathbf{X}=(0.2,-0.1,0.3)$ 处的 $\\mathbf{F}(\\mathbf{X})$。设参考向量为 $\\mathbf{V}=(2,-1,3)$，空间余向量为 $\\mathbf{a}=(1,4,-2)$，两者均在标准欧几里得意义下理解，因此对偶配对是标准点积。使用前推和拉回的基本定义，计算空间向量 $\\mathbf{v}$ 和参考余向量 $\\mathbf{A}$，然后在 $\\mathbf{X}=(0.2,-0.1,0.3)$ 处数值验证对偶配对的不变性，即 $\\mathbf{a}\\cdot\\mathbf{v}=\\mathbf{A}\\cdot\\mathbf{V}$。将对偶配对的共同值作为最终答案报告。以精确小数形式表示答案（无需四舍五入）。",
            "solution": "问题陈述已经过验证，被认为是有效的。这是一个计算固体力学中的适定问题，具有科学依据、客观且自洽。所提供的定义和关系是连续介质力学中的标准内容。我们开始求解。\n\n运动由映射 $\\boldsymbol{\\varphi}(\\mathbf{X})$ 描述，变形梯度由 $\\mathbf{F} = \\nabla_{\\mathbf{X}}\\boldsymbol{\\varphi}$ 给出。以分量形式表示，记 $\\mathbf{x} = \\boldsymbol{\\varphi}(\\mathbf{X})$，$\\mathbf{F}$ 的分量为 $F_{ij} = \\frac{\\partial \\varphi_i}{\\partial X_j}$。运动的分量如下：\n$$\n\\varphi_{1}(\\mathbf{X}) = X_{1} + \\frac{1}{2}X_{1}^{2} - 0.1\\,X_{2}\n$$\n$$\n\\varphi_{2}(\\mathbf{X}) = X_{2} + X_{3}^{2}\\,X_{2}\n$$\n$$\n\\varphi_{3}(\\mathbf{X}) = X_{3} + 0.3\\,X_{1} + 0.06\\,X_{1}X_{3}\n$$\n首先，我们通过对参考坐标 $X_j$ 求偏导数来计算变形梯度张量 $\\mathbf{F}$ 的分量：\n$$\nF_{11} = \\frac{\\partial \\varphi_1}{\\partial X_1} = 1+X_1\n$$\n$$\nF_{12} = \\frac{\\partial \\varphi_1}{\\partial X_2} = -0.1\n$$\n$$\nF_{13} = \\frac{\\partial \\varphi_1}{\\partial X_3} = 0\n$$\n$$\nF_{21} = \\frac{\\partial \\varphi_2}{\\partial X_1} = 0\n$$\n$$\nF_{22} = \\frac{\\partial \\varphi_2}{\\partial X_2} = 1+X_3^2\n$$\n$$\nF_{23} = \\frac{\\partial \\varphi_2}{\\partial X_3} = 2 X_2 X_3\n$$\n$$\nF_{31} = \\frac{\\partial \\varphi_3}{\\partial X_1} = 0.3 + 0.06 X_3\n$$\n$$\nF_{32} = \\frac{\\partial \\varphi_3}{\\partial X_2} = 0\n$$\n$$\nF_{33} = \\frac{\\partial \\varphi_3}{\\partial X_3} = 1 + 0.06 X_1\n$$\n这给出了作为物质点 $\\mathbf{X}$ 函数的变形梯度张量：\n$$\n\\mathbf{F}(\\mathbf{X}) =\n\\begin{pmatrix}\n1+X_1  -0.1  0 \\\\\n0  1+X_3^2  2 X_2 X_3 \\\\\n0.3 + 0.06 X_3  0  1 + 0.06 X_1\n\\end{pmatrix}\n$$\n接下来，我们在特定物质点 $\\mathbf{X}=(0.2, -0.1, 0.3)$ 处计算 $\\mathbf{F}$：\n$$\nF_{11} = 1+0.2 = 1.2\n$$\n$$\nF_{12} = -0.1\n$$\n$$\nF_{13} = 0\n$$\n$$\nF_{21} = 0\n$$\n$$\nF_{22} = 1+(0.3)^2 = 1+0.09 = 1.09\n$$\n$$\nF_{23} = 2(-0.1)(0.3) = -0.06\n$$\n$$\nF_{31} = 0.3 + 0.06(0.3) = 0.3 + 0.018 = 0.318\n$$\n$$\nF_{32} = 0\n$$\n$$\nF_{33} = 1 + 0.06(0.2) = 1 + 0.012 = 1.012\n$$\n因此，在给定点处 $\\mathbf{F}$ 的数值矩阵为：\n$$\n\\mathbf{F} =\n\\begin{pmatrix}\n1.2  -0.1  0 \\\\\n0  1.09  -0.06 \\\\\n0.318  0  1.012\n\\end{pmatrix}\n$$\n问题将参考向量 $\\mathbf{V}$ 的前推定义为空间向量 $\\mathbf{v} = \\mathbf{F}\\mathbf{V}$。给定参考向量 $\\mathbf{V}=(2, -1, 3)$，我们计算 $\\mathbf{v}$：\n$$\n\\mathbf{v} = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} =\n\\begin{pmatrix}\n1.2  -0.1  0 \\\\\n0  1.09  -0.06 \\\\\n0.318  0  1.012\n\\end{pmatrix}\n\\begin{pmatrix} 2 \\\\ -1 \\\\ 3 \\end{pmatrix}\n$$\n$$\nv_1 = (1.2)(2) + (-0.1)(-1) + (0)(3) = 2.4 + 0.1 = 2.5\n$$\n$$\nv_2 = (0)(2) + (1.09)(-1) + (-0.06)(3) = -1.09 - 0.18 = -1.27\n$$\n$$\nv_3 = (0.318)(2) + (0)(-1) + (1.012)(3) = 0.636 + 3.036 = 3.672\n$$\n因此，空间向量为 $\\mathbf{v}=(2.5, -1.27, 3.672)$。\n\n问题将空间余向量 $\\mathbf{a}$ 的拉回定义为参考余向量 $\\mathbf{A} = \\mathbf{F}^T \\mathbf{a}$。给定空间余向量 $\\mathbf{a}=(1, 4, -2)$，我们首先求出 $\\mathbf{F}$ 的转置：\n$$\n\\mathbf{F}^T =\n\\begin{pmatrix}\n1.2  0  0.318 \\\\\n-0.1  1.09  0 \\\\\n0  -0.06  1.012\n\\end{pmatrix}\n$$\n现在我们计算 $\\mathbf{A}$：\n$$\n\\mathbf{A} = \\begin{pmatrix} A_1 \\\\ A_2 \\\\ A_3 \\end{pmatrix} =\n\\begin{pmatrix}\n1.2  0  0.318 \\\\\n-0.1  1.09  0 \\\\\n0  -0.06  1.012\n\\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ 4 \\\\ -2 \\end{pmatrix}\n$$\n$$\nA_1 = (1.2)(1) + (0)(4) + (0.318)(-2) = 1.2 - 0.636 = 0.564\n$$\n$$\nA_2 = (-0.1)(1) + (1.09)(4) + (0)(-2) = -0.1 + 4.36 = 4.26\n$$\n$$\nA_3 = (0)(1) + (-0.06)(4) + (1.012)(-2) = -0.24 - 2.024 = -2.264\n$$\n因此，参考余向量为 $\\mathbf{A}=(0.564, 4.26, -2.264)$。\n\n最后，我们必须验证对偶配对是不变的，即 $\\mathbf{a} \\cdot \\mathbf{v} = \\mathbf{A} \\cdot \\mathbf{V}$。我们分别计算每个点积。\n在当前构型中的对偶配对是：\n$$\n\\mathbf{a} \\cdot \\mathbf{v} = (1)(2.5) + (4)(-1.27) + (-2)(3.672) = 2.5 - 5.08 - 7.344 = -9.924\n$$\n在参考构型中的对偶配对是：\n$$\n\\mathbf{A} \\cdot \\mathbf{V} = (0.564)(2) + (4.26)(-1) + (-2.264)(3) = 1.128 - 4.26 - 6.792 = -9.924\n$$\n数值验证确认了 $\\mathbf{a} \\cdot \\mathbf{v} = \\mathbf{A} \\cdot \\mathbf{V} = -9.924$。问题要求报告这个共同值。",
            "answer": "$$\n\\boxed{-9.924}\n$$"
        },
        {
            "introduction": "在掌握了向量的基本变换之后，本练习将这些概念应用于一个关键的物理量——名义牵引力 $\\mathbf{T}$。为了在不同构型间正确地关联力与面积，必须使用Nanson公式，它描述了面积微元如何从参考构型变换到当前构型。这个练习通过对比正确公式（使用 $\\mathbf{F}^{-\\mathsf{T}}$）与一个错误公式（使用 $\\mathbf{F}^{\\mathsf{T}}$）所产生的名义牵引力，清晰地揭示了遵循正确运动学变换对于保证结果客观性（即与刚体转动无关）的至关重要性 。",
            "id": "3591936",
            "problem": "考虑一个在三维（3D）欧几里得空间中进行纯刚性旋转的均质弹性体。设运动映射为 $\\boldsymbol{\\varphi}(\\mathbf{X}) = \\mathbf{R}\\,\\mathbf{X}$，其中 $\\mathbf{X}$ 是参考构形中的物质点，$\\mathbf{R} \\in \\mathrm{SO}(3)$ 是一个真正常交旋转。变形梯度为 $\\mathbf{F} = \\nabla \\boldsymbol{\\varphi} = \\mathbf{R}$，雅可比行列式为 $J = \\det(\\mathbf{F}) = 1$。空间柯西应力是均匀的，在当前构形中由下式给出：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n2  0  0 \\\\\n0  1  0 \\\\\n0  0  3\n\\end{pmatrix}.\n$$\n参考构形中的一个物质面元具有单位法向量 $\\mathbf{N} = \\mathbf{e}_{1}$，其中 $\\mathbf{e}_{1}$ 是第一个笛卡尔基向量。\n\n仅从连续介质力学中牵引力和参考与当前面积元之间关系的定义出发，推导参考表面上单位参考面积的名义牵引力 $\\mathbf{T}_{\\text{true}}$ 关于柯西应力 $\\boldsymbol{\\sigma}$ 和旋转 $\\mathbf{R}$ 的正确表达式。然后，考虑在面积变换中用 $\\mathbf{F}^{T}$ 替换 $\\mathbf{F}^{-T}$ 的错误做法，这会导致一个不正确的名义牵引力 $\\mathbf{T}_{\\text{wrong}}$。使用绕z轴旋转角度为 $\\theta = \\pi/3$ 弧度的刚性旋转，\n$$\n\\mathbf{R} = \\begin{pmatrix}\n\\cos\\theta  -\\sin\\theta  0 \\\\\n\\sin\\theta  \\cos\\theta  0 \\\\\n0  0  1\n\\end{pmatrix},\n$$\n为给定的 $\\boldsymbol{\\sigma}$ 和 $\\mathbf{N}$ 显式计算 $\\mathbf{T}_{\\text{true}}$ 和 $\\mathbf{T}_{\\text{wrong}}$。\n\n最后，通过计算相对误差来量化使用 $\\mathbf{F}^{T}$ 而非 $\\mathbf{F}^{-T}$ 所引入的非客观性：\n$$\ne \\;=\\; \\frac{\\left\\|\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}}\\right\\|}{\\left\\|\\mathbf{T}_{\\text{true}}\\right\\|},\n$$\n其中 $\\|\\cdot\\|$ 表示欧几里得范数。请以单个简化的精确表达式形式提供最终答案。不要四舍五入；$e$ 是无量纲的，因此不需要单位。",
            "solution": "该问题被验证为具有科学依据、提法恰当且客观。这是一个连续介质力学中的标准问题，旨在检验对牵引力向量、应力度量以及参考构形与当前构形之间面积元变换的理解。\n\n第一步是推导名义牵引力向量 $\\mathbf{T}_{\\text{true}}$ 的正确表达式。名义牵引力 $\\mathbf{T}$ 定义为作用在当前构形中一个面元上的力 $d\\mathbf{f}$，但按其在参考构形中对应面元的单位面积 $dA$ 计算。因此，$d\\mathbf{f} = \\mathbf{T} \\, dA$。\n\n力 $d\\mathbf{f}$ 也可以用柯西应力 $\\boldsymbol{\\sigma}$ 和当前构形中的面积元 $da$ 来表示。柯西牵引力 $\\mathbf{t}$ 是单位当前面积上的力，由柯西定律给出：$\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$，其中 $\\mathbf{n}$ 是当前构形中表面的单位法向量。于是力为 $d\\mathbf{f} = \\mathbf{t} \\, da = (\\boldsymbol{\\sigma} \\mathbf{n}) \\, da$。\n\n令两种力的表达式相等，得到：\n$$\n\\mathbf{T} \\, dA = \\boldsymbol{\\sigma} \\mathbf{n} \\, da\n$$\n参考面积元向量 $\\mathbf{N} \\, dA$ 和当前面积元向量 $\\mathbf{n} \\, da$ 之间的关系由南森公式（Nanson's formula）给出：\n$$\n\\mathbf{n} \\, da = J \\mathbf{F}^{-T} \\mathbf{N} \\, dA\n$$\n其中 $\\mathbf{F}$ 是变形梯度，$J = \\det(\\mathbf{F})$ 是其行列式，$\\mathbf{N}$ 是参考构形中表面的单位法向量。\n\n将南森公式代入力平衡方程，得到：\n$$\n\\mathbf{T} \\, dA = \\boldsymbol{\\sigma} (J \\mathbf{F}^{-T} \\mathbf{N}) \\, dA\n$$\n两边同除以标量面积元 $dA$，得到名义牵引力向量的一般表达式：\n$$\n\\mathbf{T} = J \\boldsymbol{\\sigma} \\mathbf{F}^{-T} \\mathbf{N}\n$$\n这就是真实的名义牵引力 $\\mathbf{T}_{\\text{true}}$。对于给定的问题，运动是纯刚性旋转，因此变形梯度是一个真正常交矩阵，$\\mathbf{F} = \\mathbf{R} \\in \\mathrm{SO}(3)$。对于正交矩阵，其逆矩阵等于其转置矩阵，$\\mathbf{R}^{-1} = \\mathbf{R}^{T}$。因此，项 $\\mathbf{F}^{-T}$ 变为 $(\\mathbf{R}^{-1})^{T} = (\\mathbf{R}^{T})^{T} = \\mathbf{R}$。雅可比行列式为 $J = \\det(\\mathbf{R}) = 1$。将这些代入通用公式，得到：\n$$\n\\mathbf{T}_{\\text{true}} = (1) \\boldsymbol{\\sigma} \\mathbf{R} \\mathbf{N} = \\boldsymbol{\\sigma} \\mathbf{R} \\mathbf{N}\n$$\n问题通过在通用公式中错误地用 $\\mathbf{F}^{T}$ 替换 $\\mathbf{F}^{-T}$ 来定义一个错误的牵引力向量 $\\mathbf{T}_{\\text{wrong}}$。当 $\\mathbf{F} = \\mathbf{R}$ 且 $J=1$ 时，这得到：\n$$\n\\mathbf{T}_{\\text{wrong}} = J \\boldsymbol{\\sigma} \\mathbf{F}^{T} \\mathbf{N} = (1) \\boldsymbol{\\sigma} \\mathbf{R}^{T} \\mathbf{N} = \\boldsymbol{\\sigma} \\mathbf{R}^{T} \\mathbf{N}\n$$\n接下来，我们针对给定的特定旋转和应力状态计算这些向量。旋转角为 $\\theta = \\pi/3$，因此 $\\cos(\\theta) = 1/2$ 且 $\\sin(\\theta) = \\sqrt{3}/2$。旋转矩阵 $\\mathbf{R}$ 及其转置 $\\mathbf{R}^T$ 为：\n$$\n\\mathbf{R} = \\begin{pmatrix} \\frac{1}{2}  -\\frac{\\sqrt{3}}{2}  0 \\\\ \\frac{\\sqrt{3}}{2}  \\frac{1}{2}  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad \\mathbf{R}^{T} = \\begin{pmatrix} \\frac{1}{2}  \\frac{\\sqrt{3}}{2}  0 \\\\ -\\frac{\\sqrt{3}}{2}  \\frac{1}{2}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n参考法向量为 $\\mathbf{N} = \\mathbf{e}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$，柯西应力为 $\\boldsymbol{\\sigma} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix}$。\n\n我们首先计算 $\\mathbf{T}_{\\text{true}} = \\boldsymbol{\\sigma} \\mathbf{R} \\mathbf{N}$：\n$$\n\\mathbf{R} \\mathbf{N} = \\begin{pmatrix} \\frac{1}{2}  -\\frac{\\sqrt{3}}{2}  0 \\\\ \\frac{\\sqrt{3}}{2}  \\frac{1}{2}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{T}_{\\text{true}} = \\boldsymbol{\\sigma} (\\mathbf{R} \\mathbf{N}) = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\times \\frac{1}{2} \\\\ 1 \\times \\frac{\\sqrt{3}}{2} \\\\ 3 \\times 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\n接下来，我们计算 $\\mathbf{T}_{\\text{wrong}} = \\boldsymbol{\\sigma} \\mathbf{R}^{T} \\mathbf{N}$：\n$$\n\\mathbf{R}^{T} \\mathbf{N} = \\begin{pmatrix} \\frac{1}{2}  \\frac{\\sqrt{3}}{2}  0 \\\\ -\\frac{\\sqrt{3}}{2}  \\frac{1}{2}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{T}_{\\text{wrong}} = \\boldsymbol{\\sigma} (\\mathbf{R}^{T} \\mathbf{N}) = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\times \\frac{1}{2} \\\\ 1 \\times (-\\frac{\\sqrt{3}}{2}) \\\\ 3 \\times 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\n最后，我们计算相对误差 $e = \\left\\|\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}}\\right\\| / \\left\\|\\mathbf{T}_{\\text{true}}\\right\\|$。\n差向量是：\n$$\n\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}} = \\begin{pmatrix} 1 \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\sqrt{3} \\\\ 0 \\end{pmatrix}\n$$\n差向量的欧几里得范数是：\n$$\n\\left\\|\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}}\\right\\| = \\sqrt{0^2 + (-\\sqrt{3})^2 + 0^2} = \\sqrt{3}\n$$\n真实牵引力向量的欧几里得范数是：\n$$\n\\left\\|\\mathbf{T}_{\\text{true}}\\right\\| = \\sqrt{1^2 + \\left(\\frac{\\sqrt{3}}{2}\\right)^2 + 0^2} = \\sqrt{1 + \\frac{3}{4}} = \\sqrt{\\frac{7}{4}} = \\frac{\\sqrt{7}}{2}\n$$\n相对误差是这两个范数的比值：\n$$\ne = \\frac{\\left\\|\\mathbf{T}_{\\text{wrong}} - \\mathbf{T}_{\\text{true}}\\right\\|}{\\left\\|\\mathbf{T}_{\\text{true}}\\right\\|} = \\frac{\\sqrt{3}}{\\frac{\\sqrt{7}}{2}} = \\frac{2\\sqrt{3}}{\\sqrt{7}}\n$$\n为使分母有理化，我们将分子和分母同乘以 $\\sqrt{7}$：\n$$\ne = \\frac{2\\sqrt{3}\\sqrt{7}}{\\sqrt{7}\\sqrt{7}} = \\frac{2\\sqrt{21}}{7}\n$$",
            "answer": "$$\\boxed{\\frac{2\\sqrt{21}}{7}}$$"
        },
        {
            "introduction": "本练习是一项综合性的计算实践，旨在解决非线性固体力学中的一个核心任务：四阶材料弹性张量 $\\mathbb{C}_{IJKL}$ 的前推。在有限元分析中，为了在当前构型下构建本构关系，必须将其对应的材料张量正确地映射为空间弹性张量 $c_{ijkl}$。此练习不仅要求推导其精确的映射公式，更要求将其编写为代码，并针对一系列变形梯度进行测试，同时验证其基本对称性（主、次对称性）在变换后是否得以保持，这是确保数值模型鲁棒性的关键一步 。",
            "id": "3591937",
            "problem": "给定一个三维材料弹性张量，在参考构型中以指标形式表示为一个分量为 $\\,\\mathbb{C}_{IJKL}\\,$ 的四阶张量，以及一个变形梯度，其分量为 $\\,F_{iI}\\,$，雅可比行列式为 $\\,J = \\det F\\,$ 且 $\\,J \\gt 0\\,$。从计算固体力学的基本原理出发，通过对所有容许自变量强制满足柯西应力张量从第二类皮奥拉-基尔霍夫应力张量变换的法则，推导出一个精确的前推映射，该映射将材料弹性张量 $\\,\\mathbb{C}_{IJKL}\\,$ 变换为其空间对应物，分量为 $\\,c_{ijkl}\\,$。您的推导必须且仅从以下基本定义和事实出发：\n- 变形梯度 $\\,F\\,$ 映射微分线元并在不同构型间变换二阶张量。\n- 柯西应力张量 $\\,\\sigma\\,$ 和第二类皮奥拉-基尔霍夫应力张量 $\\,S\\,$ 之间的关系为 $\\,\\sigma = \\dfrac{1}{J} F S F^{\\mathsf{T}}\\,$。\n- 材料弹性张量 $\\,\\mathbb{C}\\,$ 通过 $\\,\\mathrm{d}S = \\mathbb{C} : \\mathrm{d}E\\,$ 将材料应变度量 $\\,E\\,$ 的变分映射到 $\\,S\\,$ 的变分。\n\n在推导出该映射后，将其实现为一个程序，该程序：\n- 为一个各向同性、标架无关的超弹性固体，在参考构型中根据给定的拉梅参数 $\\,\\lambda = 5.0\\,$ 和 $\\,\\mu = 2.0\\,$ (无量纲)，构造 $\\,\\mathbb{C}_{IJKL}\\,$。\n- 对下方测试套件中的每个变形梯度，应用您推导的前推映射来计算 $\\,c_{ijkl}\\,$。\n- 验证映射后材料张量对称性的保持情况：\n  1. 次对称性：$\\,c_{ijkl} = c_{jikl}\\,$ 和 $\\,c_{ijkl} = c_{ijlk}\\,$。\n  2. 主对称性：$\\,c_{ijkl} = c_{klij}\\,$。\n- 仅当变形梯度是满足 $\\,F^{\\mathsf{T}} F = I\\,$ 和 $\\,J = 1\\,$ 定义的真正交张量（纯旋转）时，计算一个表示旋转不变性的布尔标志。在这种情况下，检查前推后的张量 $\\,c_{ijkl}\\,$ 是否在数值上等于直接在空间构型中由相同的拉梅参数 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 得到的各向同性张量。对于非纯旋转的变形梯度，将此标志设置为 False。\n\n所有对称性检查必须使用 $\\,\\varepsilon = 10^{-10}\\,$ 的相对容差，该容差通过比较对称性破坏的最大绝对值与 $\\,c_{ijkl}\\,$ 分量的最大绝对值来定义。旋转不变性检查必须使用相同的相对容差。本问题不要求物理单位，且不涉及角度。\n\n测试套件：\n- 使用 $\\,\\lambda = 5.0\\,$ 和 $\\,\\mu = 2.0\\,$。\n- 评估以下五个变形梯度：\n  1. 单位矩阵： $\\,F^{(1)} = \\begin{bmatrix} 1.0  0.0  0.0 \\\\ 0.0  1.0  0.0 \\\\ 0.0  0.0  1.0 \\end{bmatrix}\\,$。\n  2. 绕 $\\,z\\,$ 轴旋转 $\\,\\pi/2\\,$ 弧度的纯旋转： $\\,F^{(2)} = \\begin{bmatrix} 0.0  -1.0  0.0 \\\\ 1.0  0.0  0.0 \\\\ 0.0  0.0  1.0 \\end{bmatrix}\\,$。\n  3. 纯拉伸： $\\,F^{(3)} = \\mathrm{diag}(1.2,\\, 0.8,\\, 1.0)\\,$。\n  4. 剪切参数为 $\\,\\gamma = 0.5\\,$ 的简单剪切： $\\,F^{(4)} = \\begin{bmatrix} 1.0  0.5  0.0 \\\\ 0.0  1.0  0.0 \\\\ 0.0  0.0  1.0 \\end{bmatrix}\\,$。\n  5. 接近奇异但容许的拉伸： $\\,F^{(5)} = \\mathrm{diag}(0.1,\\, 0.9,\\, 1.1)\\,$。\n\n程序要求和输出：\n- 使用参考构型中的标准各向同性表达式，根据 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 构造 $\\,\\mathbb{C}_{IJKL}\\,$。\n- 实现您的精确前推映射，为每个 $\\,F^{(n)}\\,$ 获得 $\\,c_{ijkl}\\,$。\n- 对每个测试用例 $\\,n \\in \\{1,2,3,4,5\\}\\,$，生成一个包含三个布尔值的列表 $\\,[\\text{minor\\_ok}, \\text{major\\_ok}, \\text{rotation\\_invariance\\_ok}]\\,$，其定义如上。\n- 您的程序应生成单行输出，其中包含所有五个测试用例的结果，格式为一个用方括号括起来的逗号分隔列表，其中每个元素是按顺序排列的对应一个测试用例的含三个布尔值的列表。例如，输出格式必须与 $\\,[[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot]]\\,$ 完全一致，不得包含任何多余文本。",
            "solution": "题目陈述已经过仔细审查，并被确定为 **有效**。它在科学上基于连续介质力学原理，问题定义明确，目标清晰，数据充分，并使用精确、客观的语言进行表述。该问题是非线性固体力学中一个标准的、非平凡的练习，既需要形式推导，也需要严谨的数值实现。\n\n### 弹性张量的前推映射推导\n\n目标是推导将材料（或参考）弹性张量 $\\mathbb{C}_{IJKL}$ 映射到其空间（或当前）对应物 $c_{ijkl}$ 的变换。这通过要求两种构型中的本构关系保持一致来实现，而最好的表述方式是关联应力和应变的客观率。\n\n**1. 基本关系与客观率**\n\n我们已知以下核心关系：\n- 对称的柯西应力张量 $\\boldsymbol{\\sigma}$（在空间构型中）和对称的第二类皮奥拉-基尔霍夫（2nd P-K）应力张量 $\\mathbf{S}$（在材料构型中）之间的关系：\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{J} \\mathbf{F} \\mathbf{S} \\mathbf{F}^{\\mathsf{T}} \\quad \\text{其中 } J = \\det(\\mathbf{F})\n$$\n使用基尔霍夫应力张量 $\\boldsymbol{\\tau} = J\\boldsymbol{\\sigma}$ 更为方便，它将关系简化为：\n$$\n\\boldsymbol{\\tau} = \\mathbf{F} \\mathbf{S} \\mathbf{F}^{\\mathsf{T}}\n$$\n- 材料本构律，通过四阶材料弹性张量 $\\mathbb{C}$ 将第二类P-K应力率 $\\dot{\\mathbf{S}}$ 与格林-拉格朗日应变张量率 $\\dot{\\mathbf{E}}$ 相关联：\n$$\n\\dot{\\mathbf{S}} = \\mathbb{C} : \\dot{\\mathbf{E}} \\quad \\text{或以指标形式表示,} \\quad \\dot{S}_{IJ} = \\mathbb{C}_{IJKL} \\dot{E}_{KL}\n$$\n\n为建立一个一致的空间本构律，我们必须使用空间量的客观（标架无关）时间导数。一个标准的选择是李导数 $\\mathcal{L}_v$。空间本构律将应力张量的李导数与空间变形率张量 $\\mathbf{d}$ 相关联。张量 $\\mathbf{d}$ 是空间速度梯度 $\\mathbf{l} = \\dot{\\mathbf{F}}\\mathbf{F}^{-1}$ 的对称部分，即 $\\mathbf{d} = \\frac{1}{2}(\\mathbf{l} + \\mathbf{l}^{\\mathsf{T}})$。\n\n**2. 运动学和应力率变换**\n\n首先，我们将材料应变率 $\\dot{\\mathbf{E}}$ 与空间变形率 $\\mathbf{d}$ 联系起来。格林-拉格朗日应变张量为 $\\mathbf{E} = \\frac{1}{2}(\\mathbf{F}^{\\mathsf{T}}\\mathbf{F} - \\mathbf{I})$。其材料时间导数为：\n$$\n\\dot{\\mathbf{E}} = \\frac{1}{2}(\\dot{\\mathbf{F}}^{\\mathsf{T}}\\mathbf{F} + \\mathbf{F}^{\\mathsf{T}}\\dot{\\mathbf{F}})\n$$\n代入 $\\dot{\\mathbf{F}} = \\mathbf{l}\\mathbf{F}$：\n$$\n\\dot{\\mathbf{E}} = \\frac{1}{2}((\\mathbf{l}\\mathbf{F})^{\\mathsf{T}}\\mathbf{F} + \\mathbf{F}^{\\mathsf{T}}(\\mathbf{l}\\mathbf{F})) = \\frac{1}{2}(\\mathbf{F}^{\\mathsf{T}}\\mathbf{l}^{\\mathsf{T}}\\mathbf{F} + \\mathbf{F}^{\\mathsf{T}}\\mathbf{l}\\mathbf{F}) = \\mathbf{F}^{\\mathsf{T}} \\left( \\frac{1}{2}(\\mathbf{l}^{\\mathsf{T}} + \\mathbf{l}) \\right) \\mathbf{F} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{d} \\mathbf{F}\n$$\n这个操作，$\\dot{\\mathbf{E}} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{d} \\mathbf{F}$，是空间变形率张量 $\\mathbf{d}$ 到参考构型的拉回。\n\n接下来，我们建立应力率的变换。连续介质力学中的一个基本结果是，基尔霍夫应力张量的李导数 $\\mathcal{L}_v \\boldsymbol{\\tau}$ 是第二类P-K应力张量的材料时间导数 $\\dot{\\mathbf{S}}$ 的前推：\n$$\n\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{F} \\dot{\\mathbf{S}} \\mathbf{F}^{\\mathsf{T}}\n$$\n其中 $(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij} = \\dot{\\tau}_{ij} - l_{ik}\\tau_{kj} - \\tau_{ik}l_{kj}$。\n\n**3. 空间弹性张量的推导**\n\n现在我们可以结合这些关系来推导空间本构律。\n从应力率变换开始：\n$$\n\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{F} \\dot{\\mathbf{S}} \\mathbf{F}^{\\mathsf{T}}\n$$\n代入材料本构律 $\\dot{\\mathbf{S}} = \\mathbb{C} : \\dot{\\mathbf{E}}$：\n$$\n\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{F} (\\mathbb{C} : \\dot{\\mathbf{E}}) \\mathbf{F}^{\\mathsf{T}}\n$$\n现在，代入运动学关系 $\\dot{\\mathbf{E}} = \\mathbf{F}^{\\mathsf{T}} \\mathbf{d} \\mathbf{F}$：\n$$\n\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{F} (\\mathbb{C} : (\\mathbf{F}^{\\mathsf{T}} \\mathbf{d} \\mathbf{F})) \\mathbf{F}^{\\mathsf{T}}\n$$\n为使结构清晰，我们用指标表示法来写。令大写指标（$I, J, K, L$）表示材料构型，小写指标（$i, j, k, l$）表示空间构型。\n$$\n(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij} = F_{iI} (\\dot{S}_{IJ}) F_{jJ}\n$$\n$$\n\\dot{S}_{IJ} = \\mathbb{C}_{IJKL} \\dot{E}_{KL} = \\mathbb{C}_{IJKL} (F_{kK} d_{kl} F_{lL})\n$$\n将 $\\dot{S}_{IJ}$ 代入 $(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij}$ 的表达式中：\n$$\n(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij} = F_{iI} (\\mathbb{C}_{IJKL} F_{kK} d_{kl} F_{lL}) F_{jJ}\n$$\n重新排列各项（因为它们都是对重复指标求和的标量）：\n$$\n(\\mathcal{L}_v \\boldsymbol{\\tau})_{ij} = (F_{iI} F_{jJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL}) d_{kl}\n$$\n空间本构律将一个客观应力率与变形率相关联，通常形式为 $\\mathcal{L}_v \\boldsymbol{\\tau} = \\mathbf{c}_{\\tau} : \\mathbf{d}$，其中 $\\mathbf{c}_{\\tau}$ 是对应于基尔霍夫应力的空间弹性张量。通过比较，我们确定其分量为：\n$$\n(c_{\\tau})_{ijkl} = F_{iI} F_{jJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL}\n$$\n问题要求的是与柯西应力变换一致的 $\\mathbb{C}_{IJKL}$ 的空间对应物。这对应于将柯西应力的特鲁斯德尔率（Truesdell rate） $\\boldsymbol{\\sigma}^\\nabla$ 与 $\\mathbf{d}$ 相关联的张量，其中 $\\boldsymbol{\\sigma}^\\nabla = \\frac{1}{J}\\mathcal{L}_v \\boldsymbol{\\tau}$。该关系为 $\\boldsymbol{\\sigma}^\\nabla = \\mathbf{c} : \\mathbf{d}$。\n由此，我们有 $\\mathbf{c} = \\frac{1}{J}\\mathbf{c}_{\\tau}$。因此，空间弹性张量 $\\mathbf{c}$ 的分量为：\n$$\nc_{ijkl} = \\frac{1}{J} F_{iI} F_{jJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL}\n$$\n这就是所需的前推映射。\n\n**4. 对称性的保持**\n\n超弹性材料的材料张量 $\\mathbb{C}_{IJKL}$ 具有次对称性（$\\mathbb{C}_{IJKL} = \\mathbb{C}_{JIKL}$ 和 $\\mathbb{C}_{IJKL} = \\mathbb{C}_{IJLK}$）和主对称性（$\\mathbb{C}_{IJKL} = \\mathbb{C}_{KLIJ}$）。推导出的前推映射保持这些对称性。例如，为证明第一个次对称性 $c_{ijkl} = c_{jikl}$：\n\\begin{align*}\nc_{jikl} = \\frac{1}{J} F_{jI} F_{iJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL} \\\\\n= \\frac{1}{J} F_{jJ} F_{iI} F_{kK} F_{lL} \\mathbb{C}_{JIKL} \\quad (\\text{交换哑指标 } I \\leftrightarrow J) \\\\\n= \\frac{1}{J} F_{iI} F_{jJ} F_{kK} F_{lL} \\mathbb{C}_{IJKL} \\quad (\\text{使用 } \\mathbb{C}_{JIKL} = \\mathbb{C}_{IJKL} \\text{ 并重新排列各项}) \\\\\n= c_{ijkl}\n\\end{align*}\n类似地可以证明其他次对称性和主对称性，从而确认如果 $\\mathbb{C}$ 具有这些对称性，那么前推后的张量 $c$ 也将具有这些对称性。\n\n**5. 材料和空间各向同性张量**\n\n对于各向同性材料，参考构型中的弹性张量 $\\mathbb{C}$ 由下式给出：\n$$\n\\mathbb{C}_{IJKL} = \\lambda \\delta_{IJ} \\delta_{KL} + \\mu (\\delta_{IK} \\delta_{JL} + \\delta_{IL} \\delta_{JK})\n$$\n如果变形是纯旋转，$\\mathbf{F} \\in SO(3)$，则 $\\mathbf{F}^{\\mathsf{T}}\\mathbf{F} = \\mathbf{I}$ 且 $J=1$。前推操作简化，在空间构型中产生相同的各向同性形式：\n$$\nc_{ijkl} = \\lambda \\delta_{ij} \\delta_{kl} + \\mu (\\delta_{ik} \\delta_{jl} + \\delta_{il} \\delta_{jk})\n$$\n这个性质被称为材料标架无关性，将通过数值进行验证。\n\n下面的 Python 代码实现了这个推导出的映射，并执行了所要求的检查。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements the push-forward of the material elasticity tensor,\n    verifying symmetry and rotational invariance properties.\n    \"\"\"\n    \n    # Define Lamé parameters and tolerance\n    lambda_ = 5.0\n    mu = 2.0\n    tol = 1e-10\n\n    # Define the test suite of deformation gradients\n    test_cases = [\n        # 1. Identity\n        np.array([[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n        # 2. Pure rotation about z-axis by pi/2\n        np.array([[0.0, -1.0, 0.0], [1.0, 0.0, 0.0], [0.0, 0.0, 1.0]]),\n        # 3. Pure stretch\n        np.array([[1.2, 0.0, 0.0], [0.0, 0.8, 0.0], [0.0, 0.0, 1.0]]),\n        # 4. Simple shear\n        np.array([[1.0, 0.5, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n        # 5. Nearly singular stretch\n        np.array([[0.1, 0.0, 0.0], [0.0, 0.9, 0.0], [0.0, 0.0, 1.1]]),\n    ]\n    \n    # Construct the isotropic material elasticity tensor C_IJKL\n    delta = np.identity(3)\n    # C_IJKL = lambda * delta_IJ * delta_KL + mu * (delta_IK * delta_JL + delta_IL * delta_JK)\n    C_material = (lambda_ * np.einsum('ij,kl->ijkl', delta, delta, optimize=True) +\n                  mu * (np.einsum('ik,jl->ijkl', delta, delta, optimize=True) +\n                        np.einsum('il,jk->ijkl', delta, delta, optimize=True)))\n\n    results = []\n    \n    for F in test_cases:\n        # Calculate the Jacobian determinant\n        J = np.linalg.det(F)\n        if J == 0:\n            raise ValueError(\"Deformation gradient must have a positive determinant.\")\n\n        # Perform the push-forward operation: c_ijkl = (1/J) * F_iI * F_jJ * F_kK * F_lL * C_IJKL\n        c_spatial = (1.0 / J) * np.einsum('iI,jJ,kK,lL,IJKL->ijkl', F, F, F, F, C_material, optimize=True)\n\n        c_max = np.max(np.abs(c_spatial))\n        \n        # --- Symmetry Checks ---\n        \n        # 1. Minor symmetries: c_ijkl = c_jikl and c_ijkl = c_ijlk\n        err_minor1 = np.max(np.abs(c_spatial - np.transpose(c_spatial, (1, 0, 2, 3))))\n        err_minor2 = np.max(np.abs(c_spatial - np.transpose(c_spatial, (0, 1, 3, 2))))\n        \n        # The check must handle the case where c_max is zero.\n        minor_ok = True\n        if c_max > 0:\n            if (err_minor1 / c_max >= tol) or (err_minor2 / c_max >= tol):\n                minor_ok = False\n        elif err_minor1 > 0 or err_minor2 > 0:\n            minor_ok = False\n            \n        # 2. Major symmetry: c_ijkl = c_klij\n        err_major = np.max(np.abs(c_spatial - np.transpose(c_spatial, (2, 3, 0, 1))))\n        \n        major_ok = True\n        if c_max > 0:\n            if err_major / c_max >= tol:\n                major_ok = False\n        elif err_major > 0:\n            major_ok = False\n\n        # --- Rotation-Invariance Check ---\n        \n        rotation_invariance_ok = False\n        # Check if F is a proper orthogonal tensor (rotation)\n        # F.T @ F = I and det(F) = 1\n        is_rotation = np.allclose(F.T @ F, np.identity(3), atol=tol) and np.isclose(J, 1.0, atol=tol)\n        \n        if is_rotation:\n            # Construct the isotropic tensor directly in the spatial configuration\n            c_iso_spatial = (lambda_ * np.einsum('ij,kl->ijkl', delta, delta, optimize=True) +\n                             mu * (np.einsum('ik,jl->ijkl', delta, delta, optimize=True) +\n                                   np.einsum('il,jk->ijkl', delta, delta, optimize=True)))\n            \n            # Check for numerical equality\n            err_rot_inv = np.max(np.abs(c_spatial - c_iso_spatial))\n            \n            rot_inv_check_val = True\n            if c_max > 0:\n                if err_rot_inv / c_max >= tol:\n                    rot_inv_check_val = False\n            elif err_rot_inv > 0:\n                rot_inv_check_val = False\n            \n            rotation_invariance_ok = rot_inv_check_val\n\n        results.append([minor_ok, major_ok, rotation_invariance_ok])\n\n    # Format the output string precisely as required\n    # e.g., \"[[True,True,True],[True,True,False]]\"\n    sub_results_str = []\n    for res_list in results:\n        # Convert list of booleans to string like \"[True,True,False]\"\n        res_str = str(res_list).replace(\" \", \"\")\n        sub_results_str.append(res_str)\n        \n    final_output = f\"[{','.join(sub_results_str)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}