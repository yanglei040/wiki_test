{
    "hands_on_practices": [
        {
            "introduction": "全积分是确保单元刚度矩阵（至少在简单几何形状下）被精确计算的一种策略。对于等参单元，被积函数通常是关于母元坐标的有理函数。本练习  将通过多项式阶数分析，带领你确定在二次几何映射下，对一个常用的二次四边形单元（Q8）进行全积分所需的最小高斯积分阶数。这项实践旨在让你掌握有限元分析中选择积分方案时所需的核心理论分析技能。",
            "id": "3566863",
            "problem": "考虑一个二维小应变线性弹性体，其通过一个八节点（Q8 serendipity）等参二次四边形单元进行离散。设本构矩阵为常数，记为 $C \\in \\mathbb{R}^{3 \\times 3}$，单元刚度矩阵定义为\n$$\nK_{e} \\;=\\; \\int_{\\Omega_{e}} B^{T} C\\, B \\, d\\Omega,\n$$\n其中 $B$ 是由等参形函数及其空间导数构建的标准应变-位移矩阵。\n\n假设存在一个从母单元正方形 $\\hat{\\Omega} = [-1,1] \\times [-1,1]$（母单元坐标为 $(\\xi,\\eta)$）到物理单元 $\\Omega_{e}$ 的二次几何映射，使得映射分量 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 是由相同的 Q8 形函数构建的关于 $(\\xi,\\eta)$ 的二次多项式。将此映射的雅可比矩阵记为 $J(\\xi,\\eta)$，其行列式记为 $|J(\\xi,\\eta)|$。\n\n通过张量化单向阶数为 $k$ 的一维高斯-勒让德法则来应用二维高斯求积，已知该法则能精确积分最高为 $2k-1$ 次的任意一维多项式。基于以下基本且经过充分验证的事实进行多项式次数分析：\n- Q8 serendipity 形函数是关于 $(\\xi,\\eta)$ 的二次多项式，其母单元导数是线性多项式。\n- 在二次等参映射下，$J(\\xi,\\eta)$ 的每个元素是线性多项式，而 $|J(\\xi,\\eta)|$ 是二次多项式。\n- 链式法则使用 $J^{-1}(\\xi,\\eta)$ 表示形函数的空间导数，因此 $B$ 的元素是有理函数，其分子是关于 $(\\xi,\\eta)$ 的多项式。\n\n确定必须使用的最小单向高斯-勒让德阶数 $k$，使得高斯求积（在此单元类型的完全积分公认意义上）足以精确积分由 Q8 插值与二次映射相互作用所产生的所有多项式内容。你的推理必须依赖于变换到母单元域后被积函数分子中出现的多项式的次数分析，并且必须清楚地说明在存在二次映射的情况下为何这一选择是必要的。请以整数 $k$ 的形式给出最终答案。无需单位。最终答案必须是单个数字。",
            "solution": "我们从定义开始\n$$\nK_{e} \\;=\\; \\int_{\\Omega_{e}} B^{T} C\\, B \\, d\\Omega \\;=\\; \\int_{-1}^{1}\\int_{-1}^{1} \\big(B(\\xi,\\eta)\\big)^{T} C\\, B(\\xi,\\eta)\\, |J(\\xi,\\eta)| \\, d\\xi\\, d\\eta,\n$$\n其中 $C$ 是常数，对 $(\\xi,\\eta)$ 的依赖性通过等参映射和形函数导数产生。\n\n对于 Q8 serendipity 插值：\n- 形函数 $N_{a}(\\xi,\\eta)$ 是关于 $(\\xi,\\eta)$ 的二次多项式。\n- 它们的母单元导数 $\\partial N_{a}/\\partial \\xi$ 和 $\\partial N_{a}/\\partial \\eta$ 是关于 $(\\xi,\\eta)$ 的线性多项式。\n\n在二次等参映射下：\n- 雅可比矩阵 $J(\\xi,\\eta)$ 的每个元素是关于 $(\\xi,\\eta)$ 的线性多项式。\n- 行列式 $|J(\\xi,\\eta)|$ 是关于 $(\\xi,\\eta)$ 的二次多项式。\n\n形函数的空间导数通过链式法则获得：\n$$\n\\begin{pmatrix}\n\\partial N_{a}/\\partial x \\\\\n\\partial N_{a}/\\partial y\n\\end{pmatrix}\n\\;=\\;\nJ(\\xi,\\eta)^{-1}\n\\begin{pmatrix}\n\\partial N_{a}/\\partial \\xi \\\\\n\\partial N_{a}/\\partial \\eta\n\\end{pmatrix}.\n$$\n因为 $J^{-1} = \\operatorname{adj}(J)/|J|$，且 $\\operatorname{adj}(J)$ 的元素是线性多项式（作为线性元素矩阵的代数余子式），所以每个空间导数分量具有以下形式\n$$\n\\frac{\\text{(线性)}\\times\\text{(线性)}}{|J(\\xi,\\eta)|} \\;=\\; \\frac{\\text{关于}(\\xi,\\eta)\\text{的二次多项式}}{|J(\\xi,\\eta)|}.\n$$\n因此，应变-位移矩阵 $B(\\xi,\\eta)$ 的每个元素是一个有理函数，其分子是关于 $(\\xi,\\eta)$ 的二次多项式，分母是 $|J(\\xi,\\eta)|$。\n\n因此，母单元域中的能量密度为\n$$\n\\mathcal{I}(\\xi,\\eta)\\;=\\; \\big(B(\\xi,\\eta)\\big)^{T} C\\, B(\\xi,\\eta)\\, |J(\\xi,\\eta)|,\n$$\n并且，按分量来看，其结构形式为\n$$\n\\mathcal{I}(\\xi,\\eta) \\;\\sim\\; \\frac{Q_{2}(\\xi,\\eta)\\,Q_{2}(\\xi,\\eta)}{|J(\\xi,\\eta)|^{2}}\\,|J(\\xi,\\eta)|\n\\;=\\; \\frac{Q_{4}(\\xi,\\eta)}{|J(\\xi,\\eta)|},\n$$\n其中 $Q_{m}(\\xi,\\eta)$ 表示一个关于 $(\\xi,\\eta)$ 的总次数为 $m$ 的通用多项式。\n\n这表明了两个关键事实：\n1. 由于因子 $1/|J(\\xi,\\eta)|$ 的存在，被积函数是一个有理函数。因此，对于一般的二次映射，不存在有限的张量积高斯-勒让德法则能保证对所有容许的弯曲单元进行精确积分；任何固定的有限 $k$ 值都无法确保有理被积函数的积分精确性。\n2. 尽管如此，分子 $Q_{4}(\\xi,\\eta)$ 中的多项式内容最高为四次，这源于 $B^{T} C B$ 中两个二次分子的乘积。\n\n在实践中，对于等参二次四边形单元，公认的完全积分概念是选择能够精确积分所有多项式的最小阶数，这些多项式包括通过插值在分子中出现的最高次项，同时承认非多项式的分母 $1/|J|$ 在完全弯曲的情况下排除了积分的精确性。这个次数分析原则的理由如下。\n\n- 在仿射极限情况下（$J$ 为常数，因此 $|J|$ 和 $J^{-1}$ 也为常数），$B$ 的每个元素都变成关于 $(\\xi,\\eta)$ 的线性多项式，所以 $B^{T} C B$ 是一个二次多项式，且 $|J|$ 是常数。此时被积函数是一个最高为二次的多项式，满足 $2k-1 \\geq 2$ 的单向阶数 $k$ 即可，即 $k \\geq 2$。\n- 对于真正的二次映射，$|J|$ 呈二次变化，$J^{-1}$ 呈有理变化。虽然对于完整的有理被积函数，任何有限的 $k$ 值都无法达到精确性，但由插值引入能量密度分子中的最高次多项式内容是四次的，即 $Q_{4}(\\xi,\\eta)$。一个保守且被广泛采用的要求是，求积法能精确积分每个参数方向上最高为四次的所有二维多项式。对于张量积高斯-勒让德法则，为了捕捉四次项，需要对一维多项式的精确度达到 $2k-1$ 次，因此\n$$\n2k - 1 \\;\\geq\\; 4 \\quad \\Longrightarrow \\quad k \\;\\geq\\; 3.\n$$\n\n因此，满足由 Q8 插值引起的四次分子的多项式次数分析，并且通常被认为是二次映射下二次四边形单元完全积分的最小单向高斯-勒让德阶数是 $k=3$。这一选择能够精确积分在映射域中由 $B^{T} C B$ 产生的所有最高为四次的二维多项式项，并在仿射极限下提供公认的精确度水平，同时稳健地处理由二次几何形状引入的可变性。\n\n因此，所需的单向高斯阶数为 $k=3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "尽管全积分很精确，但在某些情况下（如弯曲问题）可能导致单元“自锁”现象，使结果过于刚硬。减缩积分是缓解自锁的常用方法，但它也带来了新的问题，即伪零能模式（“沙漏”模式）。本练习  采用经典的“分片检验”（patch test），通过计算一个处于均匀应变状态的双线性单元组的内节点力，来揭示单点积分方案的一个关键后果。你将发现，即使在最简单的应力状态下，内部节点力也无法自动平衡，这凸显了引入沙漏控制的必要性。",
            "id": "3566901",
            "problem": "考虑一个二维小变形线弹性中的两单元片，由两个相同的厚度为常数 $t$ 的四节点双线性四边形单元（记为 $Q4$）组成。该单元片占据矩形区域 $\\{(x,y)\\,|\\,0 \\leq x \\leq 2a,\\ 0 \\leq y \\leq b\\}$，其中左单元覆盖 $0 \\leq x \\leq a$，右单元覆盖 $a \\leq x \\leq 2a$。每个单元都通过仿射变换从母单元正方形 $[-1,1] \\times [-1,1]$ 进行等参映射，因此每个单元内的雅可比矩阵是常数。材料是均匀、各向同性的，并服从平面应力条件下的线弹性理论，其杨氏模量为 $E$，泊松比为 $\\nu$。\n\n在整个单元片上施加一个在物理坐标中呈线性的运动学容许位移场，\n$$\nu(x,y) = \\alpha x + \\beta y + c_{1}, \\qquad v(x,y) = \\gamma x + \\delta y + c_{2},\n$$\n其中 $\\alpha,\\beta,\\gamma,\\delta,c_{1},c_{2}$ 是常数。该位移场产生一个均匀小应变张量，其分量为\n$$\n\\varepsilon_{xx} = \\alpha, \\qquad \\varepsilon_{yy} = \\delta, \\qquad \\varepsilon_{xy} = \\frac{\\beta + \\gamma}{2}.\n$$\n在平面应力条件下，相应的柯西应力分量为\n$$\n\\sigma_{xx} = \\frac{E}{1-\\nu^{2}}\\left(\\varepsilon_{xx} + \\nu \\varepsilon_{yy}\\right), \\quad\n\\sigma_{yy} = \\frac{E}{1-\\nu^{2}}\\left(\\nu \\varepsilon_{xx} + \\varepsilon_{yy}\\right), \\quad\n\\sigma_{xy} = \\frac{E}{1+\\nu}\\,\\varepsilon_{xy}.\n$$\n\n在每个单元内，使用减缩积分策略，即在母单元坐标 $(\\xi,\\eta) = (0,0)$ 处使用权为 $w = 4$ 的单个高斯点，来计算一致内节点力矢量\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e} = \\int_{A_{e}} \\mathbf{B}^{T}\\boldsymbol{\\sigma}\\, t \\,\\mathrm{d}A,\n$$\n其中 $\\mathbf{B}$ 是标准的 $Q4$ 应变-位移矩阵，$\\boldsymbol{\\sigma} = \\begin{pmatrix}\\sigma_{xx} & \\sigma_{yy} & \\sigma_{xy}\\end{pmatrix}^{T}$。组装这两个单元，并提取内部垂直界面 $x=a$ 上两个公共角节点处的总内节点力分量，即节点 $(x,y) = (a,0)$ 和 $(x,y) = (a,b)$ 处的力。\n\n从虚功原理和等参映射出发，符号推导在给定均匀应变场和减缩积分法则下，这两个界面节点上的组装内节点力，并用 $a$、$t$、$E$、$\\nu$、$\\varepsilon_{xx}$、$\\varepsilon_{yy}$ 和 $\\varepsilon_{xy}$ 明确表示最终结果。使用以下顺序\n$$\n\\left(f_{x}(a,0),\\ f_{y}(a,0),\\ f_{x}(a,b),\\ f_{y}(a,b)\\right).\n$$\n无需进行数值计算。将最终答案以单行矩阵的形式给出。最终答案中不要包含单位。",
            "solution": "单元内节点力矢量 $\\mathbf{f}_{\\mathrm{int}}^{e}$ 由转置的应变-位移矩阵 $\\mathbf{B}^T$ 和应力矢量 $\\boldsymbol{\\sigma}$ 的乘积在单元面积 $A_e$ 上的积分给出，再乘以厚度 $t$：\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e} = \\int_{A_{e}} \\mathbf{B}^{T}\\boldsymbol{\\sigma}\\, t \\,\\mathrm{d}A\n$$\n题目指定使用减缩积分方案，即在母单元中心 $(\\xi, \\eta) = (0,0)$ 处使用权为 $w=4$ 的单个高斯点。该积分近似为：\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e} \\approx \\left[ \\mathbf{B}(\\xi=0, \\eta=0)^{T} \\boldsymbol{\\sigma}(\\xi=0, \\eta=0) \\right] t \\cdot \\det(\\mathbf{J}(\\xi=0, \\eta=0)) \\cdot w\n$$\n由于给定的位移场在 $x$ 和 $y$ 中是线性的，且单元几何形状为矩形（从母单元正方形的仿射映射），应变场 $\\boldsymbol{\\varepsilon}$ 以及因此产生的应力场 $\\boldsymbol{\\sigma}$ 在整个单元片上是均匀的。雅可比矩阵 $\\mathbf{J}$ 在每个单元内也是常数。单元的面积为 $A_e = w \\det(\\mathbf{J})$。因此，公式简化为：\n$$\n\\mathbf{f}_{\\mathrm{int}}^{e} = A_e t \\, \\mathbf{B}(0,0)^{T} \\boldsymbol{\\sigma}\n$$\n其中 $\\mathbf{B}(0,0)$ 是在单元中心处计算的应变-位移矩阵。\n\n我们来分析一个单元，例如占据区域 $[0,a] \\times [0,b]$ 的左单元（单元1）。其节点从原点开始逆时针编号，分别为 $(0,0)$、$(a,0)$、$(a,b)$ 和 $(0,b)$。从 $(\\xi, \\eta) \\in [-1,1]^2$ 的等参映射为：\n$$\nx(\\xi,\\eta) = \\frac{a}{2}(1+\\xi), \\qquad y(\\xi,\\eta) = \\frac{b}{2}(1+\\eta)\n$$\n此变换的雅可比矩阵为：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} a/2 & 0 \\\\ 0 & b/2 \\end{pmatrix}\n$$\n正如预期的，雅可比矩阵是常数，其行列式为 $\\det(\\mathbf{J}) = \\frac{ab}{4}$。单元面积为 $A_e = ab$。逆雅可比矩阵为：\n$$\n\\mathbf{J}^{-1} = \\begin{pmatrix} 2/a & 0 \\\\ 0 & 2/b \\end{pmatrix}\n$$\n应变-位移矩阵 $\\mathbf{B}$ 由形函数 $N_i$ 关于物理坐标 $(x,y)$ 的导数构建。这些导数通过 $\\mathbf{J}^{-1}$ 从关于母单元坐标 $(\\xi,\\eta)$ 的导数获得：\n$$\n\\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{pmatrix}\n$$\n双线性形函数 $N_i(\\xi, \\eta) = \\frac{1}{4}(1\\pm\\xi)(1\\pm\\eta)$ 在中心点 $(\\xi, \\eta) = (0,0)$ 处的导数为：\n$$\n\\begin{array}{ll}\n\\frac{\\partial N_1}{\\partial \\xi}|_{(0,0)} = -1/4, \\quad  \\frac{\\partial N_1}{\\partial \\eta}|_{(0,0)} = -1/4 \\\\\n\\frac{\\partial N_2}{\\partial \\xi}|_{(0,0)} = +1/4, \\quad  \\frac{\\partial N_2}{\\partial \\eta}|_{(0,0)} = -1/4 \\\\\n\\frac{\\partial N_3}{\\partial \\xi}|_{(0,0)} = +1/4, \\quad  \\frac{\\partial N_3}{\\partial \\eta}|_{(0,0)} = +1/4 \\\\\n\\frac{\\partial N_4}{\\partial \\xi}|_{(0,0)} = -1/4, \\quad  \\frac{\\partial N_4}{\\partial \\eta}|_{(0,0)} = +1/4\n\\end{array}\n$$\n使用 $\\mathbf{J}^{-1}$，我们求得在单元中心处关于 $(x,y)$ 的导数：\n$$\n\\begin{array}{ll}\n\\frac{\\partial N_1}{\\partial x} = -\\frac{1}{2a}, \\quad  \\frac{\\partial N_1}{\\partial y} = -\\frac{1}{2b} \\\\\n\\frac{\\partial N_2}{\\partial x} = +\\frac{1}{2a}, \\quad  \\frac{\\partial N_2}{\\partial y} = -\\frac{1}{2b} \\\\\n\\frac{\\partial N_3}{\\partial x} = +\\frac{1}{2a}, \\quad  \\frac{\\partial N_3}{\\partial y} = +\\frac{1}{2b} \\\\\n\\frac{\\partial N_4}{\\partial x} = -\\frac{1}{2a}, \\quad  \\frac{\\partial N_4}{\\partial y} = +\\frac{1}{2b}\n\\end{array}\n$$\n矩阵 $\\mathbf{B}(0,0)^T$ 是一个 $8\\times 3$ 矩阵，可以写成：\n$$\n\\mathbf{B}(0,0)^T = \\begin{pmatrix} \\mathbf{B}_1^T \\\\ \\mathbf{B}_2^T \\\\ \\mathbf{B}_3^T \\\\ \\mathbf{B}_4^T \\end{pmatrix}, \\quad \\text{其中} \\quad \\mathbf{B}_i^T = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} & 0 & \\frac{\\partial N_i}{\\partial y} \\\\ 0 & \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}\n$$\n代入导数，我们可以计算一个单元的节点力：$\\mathbf{f}_{\\mathrm{int}}^{e} = (ab)t \\, \\mathbf{B}(0,0)^T \\boldsymbol{\\sigma}$。\n对于局部节点 $i$，力 $(f_{ix}, f_{iy})$ 为：\n$$\n\\begin{pmatrix} f_{ix} \\\\ f_{iy} \\end{pmatrix} = abt \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}\\sigma_{xx} + \\frac{\\partial N_i}{\\partial y}\\sigma_{xy} \\\\ \\frac{\\partial N_i}{\\partial y}\\sigma_{yy} + \\frac{\\partial N_i}{\\partial x}\\sigma_{xy} \\end{pmatrix}\n$$\n由于单元2与单元1尺寸相同，其 $\\mathbf{B}(0,0)$ 矩阵和面积也相同。我们可以计算两个单元的节点力，然后将它们组装起来。\n\n对于单元1（左侧，节点位于 $(0,0), (a,0), (a,b), (0,b)$）：\n- 节点2 $(a,0)$: $\\mathbf{f}^{(1)}_2 = abt \\begin{pmatrix} \\frac{1}{2a}\\sigma_{xx} - \\frac{1}{2b}\\sigma_{xy} \\\\ -\\frac{1}{2b}\\sigma_{yy} + \\frac{1}{2a}\\sigma_{xy} \\end{pmatrix} = \\begin{pmatrix} \\frac{bt}{2}\\sigma_{xx} - \\frac{at}{2}\\sigma_{xy} \\\\ -\\frac{at}{2}\\sigma_{yy} + \\frac{bt}{2}\\sigma_{xy} \\end{pmatrix}$\n- 节点3 $(a,b)$: $\\mathbf{f}^{(1)}_3 = abt \\begin{pmatrix} \\frac{1}{2a}\\sigma_{xx} + \\frac{1}{2b}\\sigma_{xy} \\\\ \\frac{1}{2b}\\sigma_{yy} + \\frac{1}{2a}\\sigma_{xy} \\end{pmatrix} = \\begin{pmatrix} \\frac{bt}{2}\\sigma_{xx} + \\frac{at}{2}\\sigma_{xy} \\\\ \\frac{at}{2}\\sigma_{yy} + \\frac{bt}{2}\\sigma_{xy} \\end{pmatrix}$\n\n对于单元2（右侧，节点位于 $(a,0), (2a,0), (2a,b), (a,b)$）：\n对于该单元，界面节点是局部节点1和局部节点4。\n- 节点1 $(a,0)$: $\\mathbf{f}^{(2)}_1 = abt \\begin{pmatrix} -\\frac{1}{2a}\\sigma_{xx} - \\frac{1}{2b}\\sigma_{xy} \\\\ -\\frac{1}{2b}\\sigma_{yy} - \\frac{1}{2a}\\sigma_{xy} \\end{pmatrix} = \\begin{pmatrix} -\\frac{bt}{2}\\sigma_{xx} - \\frac{at}{2}\\sigma_{xy} \\\\ -\\frac{at}{2}\\sigma_{yy} - \\frac{bt}{2}\\sigma_{xy} \\end{pmatrix}$\n- 节点4 $(a,b)$: $\\mathbf{f}^{(2)}_4 = abt \\begin{pmatrix} -\\frac{1}{2a}\\sigma_{xx} + \\frac{1}{2b}\\sigma_{xy} \\\\ \\frac{1}{2b}\\sigma_{yy} - \\frac{1}{2a}\\sigma_{xy} \\end{pmatrix} = \\begin{pmatrix} -\\frac{bt}{2}\\sigma_{xx} + \\frac{at}{2}\\sigma_{xy} \\\\ \\frac{at}{2}\\sigma_{yy} - \\frac{bt}{2}\\sigma_{xy} \\end{pmatrix}$\n\n现在，我们通过对每个单元的贡献求和，来组装两个界面节点上的力。\n节点 $(a,0)$ 处的总力，$F(a,0) = \\mathbf{f}^{(1)}_2 + \\mathbf{f}^{(2)}_1$：\n$f_x(a,0) = \\left(\\frac{bt}{2}\\sigma_{xx} - \\frac{at}{2}\\sigma_{xy}\\right) + \\left(-\\frac{bt}{2}\\sigma_{xx} - \\frac{at}{2}\\sigma_{xy}\\right) = -at\\sigma_{xy}$\n$f_y(a,0) = \\left(-\\frac{at}{2}\\sigma_{yy} + \\frac{bt}{2}\\sigma_{xy}\\right) + \\left(-\\frac{at}{2}\\sigma_{yy} - \\frac{bt}{2}\\sigma_{xy}\\right) = -at\\sigma_{yy}$\n\n节点 $(a,b)$ 处的总力，$F(a,b) = \\mathbf{f}^{(1)}_3 + \\mathbf{f}^{(2)}_4$：\n$f_x(a,b) = \\left(\\frac{bt}{2}\\sigma_{xx} + \\frac{at}{2}\\sigma_{xy}\\right) + \\left(-\\frac{bt}{2}\\sigma_{xx} + \\frac{at}{2}\\sigma_{xy}\\right) = at\\sigma_{xy}$\n$f_y(a,b) = \\left(\\frac{at}{2}\\sigma_{yy} + \\frac{bt}{2}\\sigma_{xy}\\right) + \\left(\\frac{at}{2}\\sigma_{yy} - \\frac{bt}{2}\\sigma_{xy}\\right) = at\\sigma_{yy}$\n\n这些内部节点上的非零结果是采用单点积分的Q4单元的一个已知特性，与其未能控制“沙漏”变形模式有关。最后一步是将 $\\sigma_{yy}$ 和 $\\sigma_{xy}$ 的本构关系代入这些表达式中。\n$$\n\\sigma_{yy} = \\frac{E}{1-\\nu^{2}}\\left(\\nu \\varepsilon_{xx} + \\varepsilon_{yy}\\right)\n$$\n$$\n\\sigma_{xy} = \\frac{E}{1+\\nu}\\,\\varepsilon_{xy}\n$$\n将这些代入力的表达式中：\n$f_x(a,0) = -at \\left( \\frac{E}{1+\\nu}\\varepsilon_{xy} \\right)$\n$f_y(a,0) = -at \\left( \\frac{E}{1-\\nu^{2}}(\\nu \\varepsilon_{xx} + \\varepsilon_{yy}) \\right)$\n$f_x(a,b) = at \\left( \\frac{E}{1+\\nu}\\varepsilon_{xy} \\right)$\n$f_y(a,b) = at \\left( \\frac{E}{1-\\nu^{2}}(\\nu \\varepsilon_{xx} + \\varepsilon_{yy}) \\right)$\n\n最终结果，按指定顺序排列成一个行矩阵，是：\n$\n\\left(f_{x}(a,0),\\ f_{y}(a,0),\\ f_{x}(a,b),\\ f_{y}(a,b)\\right)\n$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -at\\frac{E}{1+\\nu}\\varepsilon_{xy} & -at\\frac{E}{1-\\nu^2}(\\nu\\varepsilon_{xx} + \\varepsilon_{yy}) & at\\frac{E}{1+\\nu}\\varepsilon_{xy} & at\\frac{E}{1-\\nu^2}(\\nu\\varepsilon_{xx} + \\varepsilon_{yy}) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "沙漏控制是抑制减缩积分所引起的伪模式的标准方法。然而，这种稳定性并非没有代价，尤其是在显式动力学分析中。本练习  将通过一个简化的双模态系统，让你亲手实践并探索一个关键的权衡问题。你将推导并编程实现中心差分法的时间步长稳定性判据，并观察增加沙漏控制刚度虽然能抑制伪模式，但同时也会提高系统的最高频率，从而减小显式积分所允许的最大稳定时间步长。",
            "id": "3566838",
            "problem": "考虑一个通过有限元法离散化的线性弹性体，其半离散运动方程可以写成二阶形式 $M \\ddot{u}(t) + K u(t) = 0$，其中 $M$ 是对称正定质量矩阵，$K$ 是对称刚度矩阵，$u(t)$ 是广义位移向量。在对刚度进行完全（充分）数值积分时，$K$ 是满秩的，其最小非零特征值对应于最低频率的物理模态。在使用减缩积分时，会出现不受 $K$ 控制并导致秩亏的伪零能模态（沙漏模态）。一种标准的稳定化方法是沿着这些沙漏方向增加一个人工刚度，该刚度由一个无量纲的沙漏控制参数 $\\alpha \\ge 0$ 进行缩放。\n\n为了研究减缩积分和沙漏控制如何影响显式中心差分格式的稳定性，我们考虑以下最小双模态模型。假设物理子空间和沙漏子空间是正交且解耦的，其模态坐标分别为 $q_p(t)$ 和 $q_h(t)$。模态质量矩阵和模态刚度矩阵为\n$$\nM_{\\text{modal}} = \\begin{bmatrix} m_p & 0 \\\\ 0 & m_h \\end{bmatrix}, \\quad\nK_{\\text{modal}} = \\begin{bmatrix} k_p & 0 \\\\ 0 & \\alpha k_0 \\end{bmatrix},\n$$\n其中 $m_p$ 和 $m_h$ 是等效模态质量，单位为 $\\mathrm{kg}$；$k_p$ 是物理模态刚度，单位为 $\\mathrm{N/m}$；$k_0$ 是一个特征沙漏刚度标量，单位为 $\\mathrm{N/m}$；$\\alpha$ 是一个缩放沙漏刚度的无量纲稳定化因子。解耦的模态方程为 $m_p \\ddot{q}_p + k_p q_p = 0$ 和 $m_h \\ddot{q}_h + \\alpha k_0 q_h = 0$。\n\n使用显式中心差分时间积分器进行时间步进。您必须从单自由度的半离散方程和中心差分时间离散化出发，推导出离散放大因子，然后根据最大模态圆频率推导出线性稳定性的充要条件。由此，推导出作为 $\\alpha$ 函数的最大稳定时间步长 $\\Delta t_{\\max}(\\alpha)$，以及沙漏模态开始控制稳定性的临界值 $\\alpha^\\star$。\n\n然后，实现一个程序，对下面的每个测试用例，计算并报告：\n- 使得物理模态和沙漏模态的圆频率相等的临界稳定化参数 $\\alpha^\\star$，以及\n- 针对一组给定的稳定化参数值 $\\alpha$，以秒为单位的最大稳定时间步长 $\\Delta t_{\\max}(\\alpha)$ 列表。\n\n所有 $\\Delta t_{\\max}$ 的答案必须以秒为单位表示，并四舍五入到六位小数。参数 $\\alpha$ 是无量纲的。\n\n测试套件：\n- 案例 1 (正常路径): $m_p = 1\\,\\mathrm{kg}$, $k_p = 10^6\\,\\mathrm{N/m}$, $m_h = 0.5\\,\\mathrm{kg}$, $k_0 = 10^5\\,\\mathrm{N/m}$, $\\alpha \\in \\{0,\\, 0.1,\\, 0.5,\\, 1.0,\\, 5.0,\\, 10.0\\}$。\n- 案例 2 (超过一个小阈值后由沙漏模态主导): $m_p = 1\\,\\mathrm{kg}$, $k_p = 10^6\\,\\mathrm{N/m}$, $m_h = 0.05\\,\\mathrm{kg}$, $k_0 = 10^5\\,\\mathrm{N/m}$, $\\alpha \\in \\{0,\\, 0.25,\\, 0.5,\\, 1.0,\\, 2.0\\}$。\n- 案例 3 (物理模态非常刚硬；交叉点较晚出现): $m_p = 1\\,\\mathrm{kg}$, $k_p = 4 \\times 10^6\\,\\mathrm{N/m}$, $m_h = 0.5\\,\\mathrm{kg}$, $k_0 = 10^5\\,\\mathrm{N/m}$, $\\alpha \\in \\{0,\\, 1.0,\\, 5.0,\\, 20.0,\\, 40.0\\}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身是一个形式为 $[\\alpha^\\star, [\\Delta t_{\\max}(\\alpha_1), \\ldots, \\Delta t_{\\max}(\\alpha_M)]]$ 的列表。例如，输出行必须是 $[[\\alpha^\\star_1,[\\ldots]],[\\alpha^\\star_2,[\\ldots]],[\\alpha^\\star_3,[\\ldots]]]$ 的形式，所有 $\\Delta t_{\\max}$ 值以秒为单位，四舍五入到六位小数，$\\alpha^\\star$ 也四舍五入到六位小数。",
            "solution": "该问题是有效的，因为它基于计算固体力学和数值分析的原理，具有科学依据；问题是适定的，目标明确，数据充分，且没有歧义或矛盾。任务是分析一个代表了使用减缩积分和沙漏控制的有限元模型的简化双模态系统中，显式中心差分格式的稳定性。\n\n解答按要求分三部分进行：首先，推导中心差分格式的稳定性条件；其次，将此条件应用于给定的双模态系统，以求得最大稳定时间步长 $\\Delta t_{\\max}(\\alpha)$；第三，推导临界沙漏稳定化参数 $\\alpha^\\star$。\n\n### 1. 中心差分格式的稳定性\n\n我们从一般的单自由度（SDOF）无阻尼运动方程开始：\n$$\nm \\ddot{q}(t) + k q(t) = 0\n$$\n其中 $m$ 是质量，$k$ 是刚度，$q(t)$ 是位移。此方程可以根据自有圆频率 $\\omega = \\sqrt{k/m}$ 改写为：\n$$\n\\ddot{q}(t) + \\omega^2 q(t) = 0\n$$\n显式中心差分格式使用二阶精度的有限差分来近似时间步 $n$（时间 $t_n = n \\Delta t$）处的加速度：\n$$\n\\ddot{q}^n \\approx \\frac{q^{n+1} - 2q^n + q^{n-1}}{(\\Delta t)^2}\n$$\n其中 $q^n = q(t_n)$。将此式代入运动方程，得到离散递推关系：\n$$\n\\frac{q^{n+1} - 2q^n + q^{n-1}}{(\\Delta t)^2} + \\omega^2 q^n = 0\n$$\n求解下一时间步的位移 $q^{n+1}$，我们得到：\n$$\nq^{n+1} = (2 - (\\omega \\Delta t)^2) q^n - q^{n-1}\n$$\n为了分析此递推关系的稳定性，我们寻求 $q^n = A \\lambda^n$ 形式的解，其中 $\\lambda$ 是一个复放大因子。代入递推关系得到特征方程：\n$$\nA \\lambda^{n+1} = (2 - (\\omega \\Delta t)^2) A \\lambda^n - A \\lambda^{n-1}\n$$\n$$\n\\lambda^2 - (2 - (\\omega \\Delta t)^2) \\lambda + 1 = 0\n$$\n为使数值解保持有界（稳定），该二次方程的根 $\\lambda$ 的模必须小于或等于 1，即 $|\\lambda| \\le 1$。根由二次方程求根公式给出：\n$$\n\\lambda = \\frac{(2 - (\\omega \\Delta t)^2) \\pm \\sqrt{(2 - (\\omega \\Delta t)^2)^2 - 4}}{2}\n$$\n为使根成为模为 1 的共轭复数对，判别式必须为非正：\n$$\n(2 - (\\omega \\Delta t)^2)^2 - 4 \\le 0\n$$\n$$\n(2 - (\\omega \\Delta t)^2)^2 \\le 4\n$$\n对两边取平方根得到 $|2 - (\\omega \\Delta t)^2| \\le 2$，这等价于以下两个不等式：\n$$\n-2 \\le 2 - (\\omega \\Delta t)^2 \\quad \\text{and} \\quad 2 - (\\omega \\Delta t)^2 \\le 2\n$$\n第二个不等式 $2 - (\\omega \\Delta t)^2 \\le 2$ 化简为 $-(\\omega \\Delta t)^2 \\le 0$，此式恒成立。第一个不等式 $-2 \\le 2 - (\\omega \\Delta t)^2$ 化简为：\n$$\n(\\omega \\Delta t)^2 \\le 4\n$$\n$$\n\\omega \\Delta t \\le 2\n$$\n这就是中心差分格式稳定性的充要条件。对于一个多自由度系统，此条件必须对所有模态频率都成立。因此，整个系统的稳定性由具有最高频率 $\\omega_{\\max}$ 的模态决定。全局稳定性极限为：\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}}\n$$\n\n### 2. 最大稳定时间步长 $\\Delta t_{\\max}(\\alpha)$\n\n该问题提供了一个代表物理模态和沙漏模态的解耦双模态系统。其控制方程为：\n1. 物理模态：$m_p \\ddot{q}_p + k_p q_p = 0$。其圆频率为 $\\omega_p = \\sqrt{k_p/m_p}$。\n2. 沙漏模态：$m_h \\ddot{q}_h + \\alpha k_0 q_h = 0$。其圆频率为 $\\omega_h(\\alpha) = \\sqrt{\\alpha k_0/m_h}$。\n\n沙漏频率 $\\omega_h(\\alpha)$ 取决于无量纲稳定化参数 $\\alpha$。当 $\\alpha=0$ 时，对应于未稳定的减缩积分，$\\omega_h(0) = 0$。这种零频模态不限制时间步长，但会导致污染解的无阻力运动（线性漂移）。\n\n系统中的最高频率为 $\\omega_{\\max}(\\alpha) = \\max(\\omega_p, \\omega_h(\\alpha))$。因此，最大稳定时间步长是 $\\alpha$ 的函数：\n$$\n\\Delta t_{\\max}(\\alpha) = \\frac{2}{\\omega_{\\max}(\\alpha)} = \\frac{2}{\\max\\left(\\sqrt{\\frac{k_p}{m_p}}, \\sqrt{\\frac{\\alpha k_0}{m_h}}\\right)}\n$$\n这也可以表示为：\n$$\n\\Delta t_{\\max}(\\alpha) = \\min\\left(2\\sqrt{\\frac{m_p}{k_p}}, 2\\sqrt{\\frac{m_h}{\\alpha k_0}}\\right)\n$$\n其中如果 $\\alpha = 0$，则第二项被视为无穷大。\n\n### 3. 临界稳定化因子 $\\alpha^\\star$\n\n当 $\\omega_p > \\omega_h(\\alpha)$ 时，系统稳定性由物理模态控制；当 $\\omega_h(\\alpha) > \\omega_p$ 时，由沙漏模态控制。临界稳定化因子 $\\alpha^\\star$ 是沙漏模态频率等于物理模态频率时的 $\\alpha$ 值，标志着沙漏模态开始决定稳定性极限的时刻。\n$$\n\\omega_h(\\alpha^\\star) = \\omega_p\n$$\n代入频率的表达式：\n$$\n\\sqrt{\\frac{\\alpha^\\star k_0}{m_h}} = \\sqrt{\\frac{k_p}{m_p}}\n$$\n两边平方并求解 $\\alpha^\\star$ 可得：\n$$\n\\frac{\\alpha^\\star k_0}{m_h} = \\frac{k_p}{m_p} \\implies \\alpha^\\star = \\frac{k_p m_h}{k_0 m_p}\n$$\n对于 $\\alpha  \\alpha^\\star$，时间步长受物理模态限制：$\\Delta t_{\\max} = 2/\\omega_p$。对于 $\\alpha \\ge \\alpha^\\star$，时间步长受沙漏模态限制：$\\Delta t_{\\max} = 2/\\omega_h(\\alpha)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the critical hourglass stabilization and maximum stable time steps\n    for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: m_p, k_p, m_h, k_0, alpha_list\n        (1.0, 1e6, 0.5, 1e5, [0, 0.1, 0.5, 1.0, 5.0, 10.0]),\n        # Case 2: m_p, k_p, m_h, k_0, alpha_list\n        (1.0, 1e6, 0.05, 1e5, [0, 0.25, 0.5, 1.0, 2.0]),\n        # Case 3: m_p, k_p, m_h, k_0, alpha_list\n        (1.0, 4e6, 0.5, 1e5, [0, 1.0, 5.0, 20.0, 40.0]),\n    ]\n\n    final_results_as_strings = []\n    \n    for case in test_cases:\n        m_p, k_p, m_h, k_0, alpha_list = case\n\n        # Calculate the critical stabilization factor alpha_star.\n        # This is derived from equating the physical and hourglass frequencies:\n        # omega_p = omega_h(alpha_star) = sqrt(k_p/m_p) = sqrt(alpha_star*k_0/m_h)\n        # alpha_star = (k_p * m_h) / (k_0 * m_p)\n        if k_0 == 0 or m_p == 0:\n            # Avoid division by zero, though not expected from problem data.\n            alpha_star = float('inf')\n        else:\n            alpha_star = (k_p * m_h) / (k_0 * m_p)\n\n        # Calculate the physical mode circular frequency.\n        omega_p = np.sqrt(k_p / m_p)\n\n        dt_max_list = []\n        for alpha in alpha_list:\n            # Calculate the hourglass mode circular frequency.\n            if alpha == 0:\n                omega_h = 0.0\n            else:\n                omega_h = np.sqrt(alpha * k_0 / m_h)\n\n            # The stability of the central difference scheme is limited by the\n            # maximum frequency in the system: dt_max = 2 / omega_max.\n            omega_max = max(omega_p, omega_h)\n\n            if omega_max == 0:\n                 # This case corresponds to a rigid body motion (k_p=0, alpha=0),\n                 # which has no stability limit.\n                 dt_max = float('inf')\n            else:\n                 dt_max = 2.0 / omega_max\n            \n            dt_max_list.append(dt_max)\n\n        # Format the results for the current case into the required string representation.\n        # All values are rounded to six decimal places.\n        alpha_star_str = f'{alpha_star:.6f}'\n        dt_list_str_parts = [f'{dt:.6f}' for dt in dt_max_list]\n        dt_list_str = f\"[{','.join(dt_list_str_parts)}]\"\n        case_str = f\"[{alpha_star_str},{dt_list_str}]\"\n        \n        final_results_as_strings.append(case_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(final_results_as_strings)}]\")\n\nsolve()\n```"
        }
    ]
}