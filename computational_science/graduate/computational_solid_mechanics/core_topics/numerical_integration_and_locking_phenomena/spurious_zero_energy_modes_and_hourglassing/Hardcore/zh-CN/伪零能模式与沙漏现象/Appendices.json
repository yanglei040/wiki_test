{
    "hands_on_practices": [
        {
            "introduction": "理解沙漏现象的第一步是亲眼观察这些非物理变形模式是如何在物理加载条件下产生的。本练习提供了一个具体的场景——一根扭转的杆件，并要求您通过将节点位移投影到已知的沙漏模式形状上，来量化变形中有多少“能量”进入了沙漏模式。这项实践将帮助您直观地理解物理变形如何激发减缩积分单元中的伪模式（spurious modes）。",
            "id": "3602265",
            "problem": "考虑三维线弹性中的八节点三线性六面体（Hex8）单元，其采用单点（减缩）高斯积分。从虚功原理出发：内虚功由 $\\delta W_{\\text{int}} = \\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\delta \\mathbf{u}) \\, dV$ 给出，其中 $\\boldsymbol{\\varepsilon}(\\mathbf{u})$ 是小应变张量，$\\mathbb{C}$ 是四阶弹性张量，$\\Omega$ 是单元域。对于采用单点积分的 Hex8 单元，单元刚度矩阵在单个减缩积分点 $(\\xi_0,\\eta_0,\\zeta_0) = (0,0,0)$ 处进行计算，近似为 $\\mathbf{K}_e \\approx \\mathbf{B}(\\xi_0,\\eta_0,\\zeta_0)^{\\top} \\mathbb{C} \\, \\mathbf{B}(\\xi_0,\\eta_0,\\zeta_0) \\, \\det \\mathbf{J}(\\xi_0,\\eta_0,\\zeta_0)$。对于 Hex8 单元，这种近似是秩亏的，并会产生伪零能模式（通常称为沙漏模式），这些模式在积分点处产生零应变，因此在减缩积分法则下不消耗能量。这些伪模式可以通过定义在参考单元上的节点符号模式来表示。\n\n在六面体的八个角节点处定义参考参数坐标 $(r,s,t)\\in\\{-1,+1\\}^3$，其排序如下：节点 $1$ 位于 $(r,s,t)=(-1,-1,-1)$，节点 $2$ 位于 $(+1,-1,-1)$，节点 $3$ 位于 $(+1,+1,-1)$，节点 $4$ 位于 $(-1,+1,-1)$，节点 $5$ 位于 $(-1,-1,+1)$，节点 $6$ 位于 $(+1,-1,+1)$，节点 $7$ 位于 $(+1,+1,+1)$，节点 $8$ 位于 $(-1,+1,+1)$。令 $h_i^{(1)}=r_i$、$h_i^{(2)}=s_i$、$h_i^{(3)}=t_i$ 和 $h_i^{(4)}=r_i s_i t_i$ 表示标准的沙漏形状模式（其中 $i=1,\\dots,8$ 且模式 $\\alpha=1,\\dots,4$）。对于一个给定的单元，其在笛卡尔方向 $a\\in\\{x,y,z\\}$ 上的节点位移分量为 $u_i^{(a)}$，通过离散投影定义模式 $\\alpha$ 和方向 $a$ 上的沙漏幅值\n$$\nq_{e}^{(\\alpha,a)} = \\frac{1}{8} \\sum_{i=1}^{8} h_i^{(\\alpha)} \\, u_i^{(a)}.\n$$\n这个 $q_{e}^{(\\alpha,a)}$ 是衡量单元的节点位移模式在单点积分下激发相应伪零能模式强度的度量。\n\n现在考虑一根长度为 $L$ 的直棱柱杆，沿全局 $Z$ 轴放置，其矩形截面沿全局 $X$ 轴和 $Y$ 轴的宽度分别为 $W_x$ 和 $W_y$。该杆在 $Z=0$ 处被夹紧，在 $Z=L$ 处受到一个小的末端扭转角 $\\Theta$。采用小扭转运动学假设，即每个横截面都围绕 $Z$ 轴刚性旋转一个角度 $\\theta(Z)=\\Theta \\, Z / L$。在笛卡尔坐标系中，施加的位移场为\n$$\nu_x(X,Y,Z) = -\\theta(Z) \\, Y = -\\frac{\\Theta}{L} \\, Z \\, Y,\\quad\nu_y(X,Y,Z) = \\theta(Z) \\, X = \\frac{\\Theta}{L} \\, Z \\, X,\\quad\nu_z(X,Y,Z) = 0.\n$$\n\n用一个结构化的 Hex8 单元网格对杆进行离散化，在 $X$、$Y$ 和 $Z$ 方向上的单元数量分别为 $N_x \\times N_y \\times N_z$。为了改变网格相对于全局坐标轴的方向，将每个单元的局部平面内坐标轴绕 $Z$ 轴旋转一个角度 $\\beta$，使得局部方向 $\\mathbf{e}_1$ 和 $\\mathbf{e}_2$ 是通过将全局 $(X,Y)$ 轴旋转 $\\beta$ 得到的，而 $\\mathbf{e}_3$ 保持与 $Z$ 轴对齐。在每个单元内部，假设存在一个从 $(r,s,t)\\in[-1,1]^3$到全局坐标的仿射映射：\n$$\n\\mathbf{x}(r,s,t) = \\mathbf{x}_c + \\mathbf{R}_z(\\beta) \\begin{bmatrix} \\frac{h_x}{2} r \\\\ \\frac{h_y}{2} s \\\\ \\frac{h_z}{2} t \\end{bmatrix},\n$$\n其中 $\\mathbf{x}_c$ 是单元中心的全局坐标，$h_x=W_x/N_x$，$h_y=W_y/N_y$，$h_z=L/N_z$，$\\mathbf{R}_z(\\beta)$ 是绕 $Z$ 轴旋转角度 $\\beta$ 的标准旋转矩阵。\n\n对于每个单元，通过代入 $(r_i,s_i,t_i)$ 计算八个角节点的节点位置，然后计算在这些节点坐标处的施加扭转位移 $(u_x,u_y,u_z)$。使用上述定义，计算 $\\alpha\\in\\{1,2,3,4\\}$ 和 $a\\in\\{x,y,z\\}$ 的 $q_{e}^{(\\alpha,a)}$。作为每个网格的标量总结，定义最大绝对沙漏幅值\n$$\nQ_{\\max} = \\max_{e} \\max_{\\alpha\\in\\{1,2,3,4\\}} \\max_{a\\in\\{x,y,z\\}} \\left| q_{e}^{(\\alpha,a)} \\right|.\n$$\n这个 $Q_{\\max}$ 的单位是长度。您的任务是为一组参数化测试用例计算 $Q_{\\max}$，这些用例通过 $(N_x,N_y,N_z)$ 改变网格方向 $\\beta$、扭转角 $\\Theta$ 和单元长宽比。\n\n您必须实现一个程序，从第一性原理出发执行以下步骤：\n- 创建结构化网格的单元中心 $\\mathbf{x}_c$，覆盖范围为 $X\\in[-W_x/2,W_x/2]$、$Y\\in[-W_y/2,W_y/2]$、$Z\\in[0,L]$，单元数量为 $N_x$、$N_y$、$N_z$。\n- 对于每个单元，使用带有旋转角 $\\beta$ 和尺寸 $(h_x,h_y,h_z)$ 的仿射映射生成其八个节点坐标。\n- 计算每个节点上施加的位移场。\n- 计算每个单元的四个沙漏模式幅值 $q_{e}^{(\\alpha,a)}$ 以及整个网格上的标量 $Q_{\\max}$。\n\n所有物理量均使用国际单位制。具体来说：\n- 所有长度 $L$、$W_x$、$W_y$ 必须以米为单位给出，输出 $Q_{\\max}$ 也必须以米为单位报告。\n- 角度 $\\Theta$ 必须以弧度为单位给出。\n- 网格方向角 $\\beta$ 在输入参数集中必须以度为单位给出，并在内部转换为弧度进行计算。\n\n测试套件：\n为以下四个测试用例计算 $Q_{\\max}$。每个用例是一个有序元组 $(L,W_x,W_y,N_x,N_y,N_z,\\Theta,\\beta)$，其单位和约定如上所述。\n- 用例 1：$(L,W_x,W_y,N_x,N_y,N_z,\\Theta,\\beta) = (2.0, 1.0, 0.6, 2, 1, 4, 0.1, 0.0)$。\n- 用例 2：$(L,W_x,W_y,N_x,N_y,N_z,\\Theta,\\beta) = (2.0, 1.0, 0.6, 2, 1, 4, 0.1, 45.0)$。\n- 用例 3：$(L,W_x,W_y,N_x,N_y,N_z,\\Theta,\\beta) = (2.0, 1.0, 0.6, 4, 1, 2, 0.1, 0.0)$。\n- 用例 4：$(L,W_x,W_y,N_x,N_y,N_z,\\Theta,\\beta) = (2.0, 1.0, 0.6, 2, 1, 4, 1.0\\times 10^{-6}, 30.0)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个用例的 $Q_{\\max}$ 值（单位为米），每个值格式化为小数点后恰好 $10$ 位数字，作为一个用方括号括起来的逗号分隔列表。例如，一个可接受的输出格式是 $[0.1234567890,0.2345678901,0.3456789012,0.4567890123]$。不应打印任何额外文本。",
            "solution": "用户提供了一个计算固体力学领域中有效且适定的问题。任务是计算在扭转作用下直棱柱杆几种离散化方案的最大沙漏幅值，记为 $Q_{\\max}$。解决方案需要直接根据问题陈述中给出的公式，从第一性原理出发进行数值实现。以下步骤详细说明了针对单个测试用例计算 $Q_{\\max}$ 的过程。\n\n第一步是为给定的测试用例建立几何和运动学参数，该用例由元组 $(L, W_x, W_y, N_x, N_y, N_z, \\Theta, \\beta_{\\text{deg}})$ 定义。杆的物理尺寸为长度 $L$、宽度 $W_x$ 和深度 $W_y$。它被离散化为一个由 $N_x \\times N_y \\times N_z$ 个六面体单元组成的结构化网格。每个单元的尺寸为 $h_x = W_x / N_x$、$h_y = W_y / N_y$ 和 $h_z = L / N_z$。总扭转角为 $\\Theta$，单元方向角 $\\beta$ 通过将 $\\beta_{\\text{deg}}$ 从度转换为弧度得到。\n\n计算的核心是遍历网格中的每个单元。杆的域在 $X$-$Y$ 平面中居中，范围为 $X \\in [-W_x/2, W_x/2]$ 和 $Y \\in [-W_y/2, W_y/2]$，并沿 $Z$ 轴从 $Z=0$ 延伸到 $Z=L$。一个由 $(i,j,k)$ 索引的单元（其中 $i \\in \\{0, \\dots, N_x-1\\}$，$j \\in \\{0, \\dots, N_y-1\\}$，$k \\in \\{0, \\dots, N_z-1\\}$）的中心位于全局坐标 $\\mathbf{x}_c = [X_c, Y_c, Z_c]^{\\top}$，计算如下：\n$$\nX_c = -\\frac{W_x}{2} + (i + 0.5) h_x\n$$\n$$\nY_c = -\\frac{W_y}{2} + (j + 0.5) h_y\n$$\n$$\nZ_c = (k + 0.5) h_z\n$$\n对于每个单元，我们必须确定其八个节点的全局坐标。问题指定了一个从参考单元域 $(r,s,t) \\in [-1,1]^3$ 到全局坐标系 $\\mathbf{x}$ 的仿射映射：\n$$\n\\mathbf{x}(r,s,t) = \\mathbf{x}_c + \\mathbf{R}_z(\\beta) \\begin{bmatrix} \\frac{h_x}{2} r \\\\ \\frac{h_y}{2} s \\\\ \\frac{h_z}{2} t \\end{bmatrix}\n$$\n其中 $\\mathbf{R}_z(\\beta)$ 是绕 $Z$ 轴的标准旋转矩阵：\n$$\n\\mathbf{R}_z(\\beta) = \\begin{bmatrix} \\cos\\beta & -\\sin\\beta & 0 \\\\ \\sin\\beta & \\cos\\beta & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\n八个节点（$i=1,\\dots,8$）的坐标 $\\mathbf{x}_i = [X_i, Y_i, Z_i]^{\\top}$ 是通过将每个节点对应的参数坐标 $(r_i, s_i, t_i)$ 代入映射函数得到的。节点的排序及其参数坐标 $(r_i, s_i, t_i)$ 给出如下：$1:(-1,-1,-1)$，$2:(+1,-1,-1)$，$3:(+1,+1,-1)$，$4:(-1,+1,-1)$，$5:(-1,-1,+1)$，$6:(+1,-1,+1)$，$7:(+1,+1,+1)$，$8:(-1,+1,+1)$。\n\n一旦八个节点的全局坐标 $(X_i, Y_i, Z_i)$ 已知，就可以在这些位置上计算施加的位移场。小角度扭转的位移场为：\n$$\nu_x(X,Y,Z) = -\\frac{\\Theta}{L} Z Y, \\quad u_y(X,Y,Z) = \\frac{\\Theta}{L} Z X, \\quad u_z(X,Y,Z) = 0\n$$\n代入节点坐标 $(X_i, Y_i, Z_i)$ 即可得到节点位移分量 $(u_i^{(x)}, u_i^{(y)}, u_i^{(z)})$。\n\n计算出单元的节点位移后，下一步是计算沙漏模式的幅值。这些幅值 $q_{e}^{(\\alpha,a)}$ 衡量了单元变形在伪零能模式上的投影。提供的公式为：\n$$\nq_{e}^{(\\alpha,a)} = \\frac{1}{8} \\sum_{i=1}^{8} h_i^{(\\alpha)} \\, u_i^{(a)}\n$$\n这个计算针对四个沙漏模式 $\\alpha \\in \\{1,2,3,4\\}$ 和每个笛卡尔方向 $a \\in \\{x,y,z\\}$ 进行。沙漏形状模式 $h_i^{(\\alpha)}$ 是基于节点参数坐标定义的：$h_i^{(1)}=r_i$，$h_i^{(2)}=s_i$，$h_i^{(3)}=t_i$ 和 $h_i^{(4)}=r_i s_i t_i$。这样，每个单元总共会产生 $4 \\times 3 = 12$ 个沙漏幅值。\n\n最后，通过在网格中所有单元的所有计算出的沙漏幅值中找到最大绝对值来确定整体度量 $Q_{\\max}$：\n$$\nQ_{\\max} = \\max_{e} \\max_{\\alpha\\in\\{1,2,3,4\\}} \\max_{a\\in\\{x,y,z\\}} |q_{e}^{(\\alpha,a)}|\n$$\n对问题中指定的每个测试用例重复此过程，并收集所得的 $Q_{\\max}$ 值。该实现将使用矩阵和向量运算以提高效率，特别是在计算节点坐标和沙漏幅值公式中的求和-乘积时。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_q_max(L, Wx, Wy, Nx, Ny, Nz, Theta, beta_deg):\n    \"\"\"\n    Computes the maximum absolute hourglass amplitude Q_max for a given set of parameters.\n    \"\"\"\n    # 1. Define constants and derived parameters\n    hx = Wx / Nx\n    hy = Wy / Ny\n    hz = L / Nz\n    beta_rad = np.deg2rad(beta_deg)\n    k0 = Theta / L\n\n    # 2. Pre-compute helper matrices\n    # Nodal parametric coordinates based on the specified ordering\n    r = np.array([-1, 1, 1, -1, -1, 1, 1, -1])\n    s = np.array([-1, -1, 1, 1, -1, -1, 1, 1])\n    t = np.array([-1, -1, -1, -1, 1, 1, 1, 1])\n\n    # Hourglass shape pattern vectors h_i^(alpha)\n    h1 = r\n    h2 = s\n    h3 = t\n    h4 = r * s * t\n    H = np.array([h1, h2, h3, h4])  # Shape (4, 8)\n\n    # Rotation matrix R_z(beta)\n    c, s_rot = np.cos(beta_rad), np.sin(beta_rad)\n    Rz = np.array([[c, -s_rot, 0], [s_rot, c, 0], [0, 0, 1]])\n\n    # Vector of local coordinates for the 8 nodes relative to the element center\n    nodes_local_coords = 0.5 * np.array([hx * r, hy * s, hz * t]) # Shape (3, 8)\n\n    global_q_max = 0.0\n\n    # 3. Iterate over all elements in the structured mesh\n    for i in range(Nx):\n        for j in range(Ny):\n            for k in range(Nz):\n                # 3.1. Calculate element center coordinates\n                Xc = -Wx / 2 + (i + 0.5) * hx\n                Yc = -Wy / 2 + (j + 0.5) * hy\n                Zc = (k + 0.5) * hz\n                elem_center = np.array([Xc, Yc, Zc])\n\n                # 3.2. Generate global coordinates for the 8 nodes of the element\n                # Use broadcasting: (3,1) + (3,3) @ (3,8) -> (3,8)\n                nodes_global_coords = elem_center[:, np.newaxis] + Rz @ nodes_local_coords\n                X_nodes = nodes_global_coords[0, :]\n                Y_nodes = nodes_global_coords[1, :]\n                Z_nodes = nodes_global_coords[2, :]\n\n                # 3.3. Evaluate the imposed displacement field at each node\n                ux_nodes = -k0 * Z_nodes * Y_nodes\n                uy_nodes = k0 * Z_nodes * X_nodes\n                uz_nodes = np.zeros(8)\n                U = np.array([ux_nodes, uy_nodes, uz_nodes]) # Shape (3, 8)\n\n                # 3.4. Compute the hourglass mode amplitudes for the element\n                # Q_e (4,3) = (1/8) * H(4,8) @ U.T(8,3)\n                Q_e = (1.0 / 8.0) * H @ U.T\n\n                # 3.5. Update the global maximum absolute amplitude\n                elem_q_max = np.max(np.abs(Q_e))\n                if elem_q_max > global_q_max:\n                    global_q_max = elem_q_max\n\n    return global_q_max\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n    # Test suite: (L, Wx, Wy, Nx, Ny, Nz, Theta, beta_deg)\n    test_cases = [\n        (2.0, 1.0, 0.6, 2, 1, 4, 0.1, 0.0),\n        (2.0, 1.0, 0.6, 2, 1, 4, 0.1, 45.0),\n        (2.0, 1.0, 0.6, 4, 1, 2, 0.1, 0.0),\n        (2.0, 1.0, 0.6, 2, 1, 4, 1.0e-6, 30.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, Wx, Wy, Nx, Ny, Nz, Theta, beta_deg = case\n        q_max_result = calculate_q_max(L, Wx, Wy, Nx, Ny, Nz, Theta, beta_deg)\n        results.append(f\"{q_max_result:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "既然我们能够量化沙漏模式，我们应如何设计一个明确的测试来证明某种单元列式容易产生这种问题呢？这个思想实验将挑战您设计一个专门激发零能模式的“分片检验”（patch test），并将其与无法检测此缺陷的标准分片检验进行对比。这项实践将增强您诊断单元病态行为的能力。",
            "id": "3602258",
            "problem": "一个边长为 $2h$ 的方形弹性贴片被离散化为一个 $2 \\times 2$ 的双线性四边形 ($Q4$) 单元网格。材料是线性弹性、均匀、各向同性的，处于平面应变状态，其杨氏模量为 $E$，泊松比为 $\\nu$。每个 $Q4$ 单元在其形心处使用单个 Gauss 点进行积分（单点减缩积分）。设全局笛卡尔坐标为 $(x,y)$，贴片节点在 $(x_i,y_j)$ 处形成一个均匀的 $3 \\times 3$ 网格，其中 $x_i = i h$，$y_j = j h$，且 $i,j \\in \\{0,1,2\\}$。\n\n要求您设计一个基于位移的贴片检验，以揭示这种减缩积分离散化中的沙漏不稳定性（伪零能模式），并解释为什么标准的线性（仿射）位移贴片检验无法检测到它们。使用以下内容作为基本依据：小应变张量的定义 $\\varepsilon = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\mathsf{T}})$、虚功原理 $\\int_{\\Omega} \\boldsymbol{\\sigma}:\\delta \\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega = \\int_{\\partial \\Omega_t} \\bar{\\mathbf{t}} \\cdot \\delta \\mathbf{u} \\, \\mathrm{d}\\Gamma$、双线性 $Q4$ 形函数，以及单点积分仅在单元形心处对应变和应力进行采样这一事实。假设一个边长为 $h$ 的方形单元，具有标准的等参映射 $(\\xi,\\eta) \\mapsto (x,y)$，对于规则网格，其雅可比矩阵为常数对角阵，对角线元素为 $h/2$。\n\n考虑以下旨在揭示沙漏不稳定性的候选边界位移设定和诊断方法。在所有情况下，除非另有说明，均将 $u_x$ 和 $u_y$ 作为边界节点上指定的位移分量，并将任何未指定的位移分量设置为零。设 $\\Delta>0$ 为一个指定的位移幅值。位于 $(h,h)$ 的内部节点保持自由。\n\n哪个选项正确地指定了一个能揭示此 $2 \\times 2$ 贴片中沙漏不稳定性的基于位移的贴片检验，并正确解释了为什么标准的线性场贴片检验无法检测到它们？\n\nA. 指定一个仿射边界位移场 $u_x = a x + b y$, $u_y = c x + d y$（其中 $a,b,c,d$ 为常数），并通过检查单元常应变是否在单个 Gauss 点处被再现来验证通过/失败。这能检测到沙漏现象，因为任何秩亏都会表现为无法再现常应变。\n\nB. 为所有边界节点 $(i,j)$ 指定一个交替的“棋盘式”边界位移 $u_x(i,j) = \\Delta \\, (-1)^{i+j}$ 和 $u_y(i,j) = 0$，并通过出现零（或接近零）的反作用力来诊断沙漏现象，尽管边界功不为零。这揭示了沙漏现象，因为对于每个单元，在单点积分下，单元周围的节点 $u_x$ 模式 $[+,-,+,-]$ 会产生零形心应变（因此内能为零），所以减缩积分刚度无法抵抗这种模式。标准的线性场检验之所以失败，是因为仿射场引起的常应变在形心处被精确采样，所以尽管减缩积分的 $Q4$ 单元易于出现沙漏现象，但它仍然通过了检验。\n\nC. 在边界上指定一个刚体转动 $u_x = -\\theta y$, $u_y = \\theta x$（其中 $\\theta$ 为常数），并通过观察到零反作用力来检测沙漏现象。这揭示了沙漏现象，因为在非平凡位移下出现零反作用力意味着存在一个零能模式。线性场检验之所以失败，是因为它对转动不敏感。\n\nD. 仅在左右边缘指定交替边界位移 $u_x(i,j) = \\Delta \\, (-1)^i$ 和 $u_y(i,j) = 0$，而顶部和底部边缘完全固定，并通过内部节点位移的非唯一性来诊断沙漏现象。这揭示了沙漏现象，因为交替模式将每个单元的形心应变减小到零。线性场检验失败的原因与选项 B 相同。\n\n选择唯一的最佳选项。",
            "solution": "该问题要求评估候选的基于位移的贴片检验，以找出一个能正确揭示采用单点减缩积分的双线性四边形 ($Q4$) 单元 $2 \\times 2$ 网格中的沙漏不稳定性的检验方法。问题陈述本身是科学合理的、适定的和客观的，为分析提供了有效的基础。\n\n首先，我们将确定单点积分 $Q4$ 单元的基本行为。单元内的位移场 $\\mathbf{u}(\\xi, \\eta)$ 是通过双线性形函数 $N_I(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_I\\xi)(1+\\eta_I\\eta)$ 从其四个节点位移 $\\mathbf{d}_e$ 插值得到的，其中 $(\\xi, \\eta)$ 是 $[-1, 1] \\times [-1, 1]$ 内的母单元坐标，$(\\xi_I, \\eta_I)$ 是节点 $I$ 的坐标。对于规则网格中边长为 $h$ 的方形单元，等参映射的雅可比矩阵是常数对角阵，$\\mathbf{J} = \\mathrm{diag}(h/2, h/2)$。\n\n应变张量分量由位移场的空间导数计算得出。例如，$\\varepsilon_{xx} = \\partial u_x / \\partial x$。利用链式法则，我们将空间导数与母单元域中的导数联系起来：\n$$ \\begin{Bmatrix} \\partial/\\partial x \\\\ \\partial/\\partial y \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\partial/\\partial \\xi \\\\ \\partial/\\partial \\eta \\end{Bmatrix} = \\begin{bmatrix} 2/h & 0 \\\\ 0 & 2/h \\end{bmatrix} \\begin{Bmatrix} \\partial/\\partial \\xi \\\\ \\partial/\\partial \\eta \\end{Bmatrix} $$\n因此，应变分量用节点位移 $u_{xI}, u_{yI}$ 表示。对于单点积分，这些应变仅在单元形心 $(\\xi, \\eta) = (0,0)$ 处计算。形函数在形心处的导数是：\n$$ \\frac{\\partial N_I}{\\partial \\xi}\\bigg|_{(0,0)} = \\frac{1}{4}\\xi_I \\quad \\text{and} \\quad \\frac{\\partial N_I}{\\partial \\eta}\\bigg|_{(0,0)} = \\frac{1}{4}\\eta_I $$\n设局部节点 $I=1,2,3,4$ 分别对应于母单元坐标 $(-1,-1), (1,-1), (1,1), (-1,1)$。形心处的应变分量变为：\n$$ \\varepsilon_{xx}|_{(0,0)} = \\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial x}\\bigg|_{(0,0)} u_{xI} = \\frac{2}{h} \\sum_{I=1}^4 \\left(\\frac{1}{4}\\xi_I\\right) u_{xI} = \\frac{1}{2h}(-u_{x1} + u_{x2} + u_{x3} - u_{x4}) $$\n$$ \\varepsilon_{yy}|_{(0,0)} = \\sum_{I=1}^4 \\frac{\\partial N_I}{\\partial y}\\bigg|_{(0,0)} u_{yI} = \\frac{2}{h} \\sum_{I=1}^4 \\left(\\frac{1}{4}\\eta_I\\right) u_{yI} = \\frac{1}{2h}(-u_{y1} - u_{y2} + u_{y3} + u_{y4}) $$\n$$ \\gamma_{xy}|_{(0,0)} = \\sum_{I=1}^4 \\left( \\frac{\\partial N_I}{\\partial y}\\bigg|_{(0,0)} u_{xI} + \\frac{\\partial N_I}{\\partial x}\\bigg|_{(0,0)} u_{yI} \\right) = \\frac{1}{2h} [(-u_{x1}-u_{x2}+u_{x3}+u_{x4}) + (-u_{y1}+u_{y2}+u_{y3}-u_{y4})] $$\n伪零能模式，或称沙漏模式，是一种非刚体节点位移模式，它导致在积分点处的应变为零。根据虚功原理，如果应变 $\\boldsymbol{\\varepsilon}$ 为零，则应力 $\\boldsymbol{\\sigma} = \\mathbf{C}\\boldsymbol{\\varepsilon}$ 也为零，导致内虚功为零，即 $\\int_{\\Omega} \\boldsymbol{\\sigma}:\\delta \\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega = 0$。这意味着单元刚度矩阵对此类变形模式的抵抗力为零。\n\n一个经典的沙漏模式涉及形式为 $u_{xI} = \\Delta \\xi_I \\eta_I$ 和 $u_{yI} = 0$ 的位移。对于我们的节点排序，这对应于位移向量 $\\{u_{x1}, u_{x2}, u_{x3}, u_{x4}\\} = \\{\\Delta, -\\Delta, \\Delta, -\\Delta\\}$。将此代入应变方程：\n$$ \\varepsilon_{xx}|_{(0,0)} \\propto -(\\Delta) + (-\\Delta) + (\\Delta) - (-\\Delta) = 0 $$\n$$ \\gamma_{xy}|_{(0,0)} \\propto -(\\Delta) - (-\\Delta) + (\\Delta) + (-\\Delta) = 0 $$\n该位移模式是一种零能模式。这种模式是非物理的，是减缩积分方案的产物。\n\n标准的贴片检验验证了单元精确再现恒定应变状态的能力。这对应于施加从仿射位移场 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{u}_0 + \\mathbf{A}\\mathbf{x}$ 导出的边界条件。双线性 $Q4$ 单元可以精确表示任何线性多项式。因此，应变场在整个单元内将是恒定且精确的。在形心处计算该应变自然会得到正确的值。单元通过了该检验。然而，该检验对沙漏不稳定性是“盲目”的，因为恒定应变模式在数学上与沙漏模式（即高阶模式）正交。一个旨在揭示沙漏现象的检验必须专门激发这些高阶模式。\n\n现在我们来评估给定的选项。\n\n**A. 指定一个仿射边界位移场 $u_x = a x + b y$, $u_y = c x + d y$（其中 $a,b,c,d$ 为常数），并通过检查单元常应变是否在单个 Gauss 点处被再现来验证通过/失败。这能检测到沙漏现象，因为任何秩亏都会表现为无法再现常应变。**\n\n这描述了标准的线性位移贴片检验。如上所述，减缩积分 $Q4$ 单元*通过*了此检验。它正确地再现了恒定应变状态。检验的成功证明了该单元捕捉恒定应变的能力，但完全无法探测沙漏现象。该检验能检测到沙漏现象的结论在事实上是错误的。因此，此选项不正确。\n\n结论：**不正确**。\n\n**B. 为所有边界节点 $(i,j)$ 指定一个交替的“棋盘式”边界位移 $u_x(i,j) = \\Delta \\, (-1)^{i+j}$ 和 $u_y(i,j) = 0$，并通过出现零（或接近零）的反作用力来诊断沙漏现象，尽管边界功不为零。这揭示了沙漏现象，因为对于每个单元，在单点积分下，单元周围的节点 $u_x$ 模式 $[+,-,+,-]$ 会产生零形心应变（因此内能为零），所以减缩积分刚度无法抵抗这种模式。标准的线性场检验之所以失败，是因为仿射场引起的常应变在形心处被精确采样，所以尽管减缩积分的 $Q4$ 单元易于出现沙漏现象，但它仍然通过了检验。**\n\n让我们分析指定的位移。全局节点位于 $(x_i, y_j)$，其中 $i,j \\in \\{0,1,2\\}$。施加在网格上的位移 $u_x(i,j) = \\Delta (-1)^{i+j}$ 会在每个单元中激发沙漏模式。例如，考虑左下角的单元，其节点位于 $(0,0), (1,0), (1,1), (0,1)$。如果位于 $(1,1)$ 的自由中心节点位移为 $u_x(1,1) = \\Delta(-1)^{1+1} = \\Delta$，则该单元的 $u_x$ 方向的节点位移，从节点 $(0,0)$ 开始逆时针移动，为 $\\{\\Delta, -\\Delta, \\Delta, -\\Delta\\}$。如初步分析所示，这种特定模式在单元形心处产生零应变。这对贴片中的所有四个单元都成立。由于每个单元的应变为零，应力也为零，内能为零，因此根据单元应力计算出的节点反作用力也为零。一个非平凡的指定位移场导致零反作用力，标志着一个零能模式，在本例中即为伪沙漏不稳定性。短语“非零边界功”略有不精确；功 $\\int \\bar{\\mathbf{t}} \\cdot \\mathbf{u} \\, \\mathrm{d}\\Gamma$ 为零，因为反作用力 $\\bar{\\mathbf{t}}$ 为零。关键的诊断是在非零指定位移下反作用力为零。关于此检验为何有效以及标准线性贴片检验为何失败的解释完全正确，并与有限元理论一致。\n\n结论：**正确**。\n\n**C. 在边界上指定一个刚体转动 $u_x = -\\theta y$, $u_y = \\theta x$（其中 $\\theta$ 为常数），并通过观察到零反作用力来检测沙漏现象。这揭示了沙漏现象，因为在非平凡位移下出现零反作用力意味着存在一个零能模式。线性场检验之所以失败，是因为它对转动不敏感。**\n\n一个由 $u_x = -\\theta y$ 和 $u_y = \\theta x$ 给出的小刚体转动是一种零应变状态：$\\varepsilon_{xx} = 0$，$\\varepsilon_{yy} = 0$，$\\gamma_{xy} = \\partial u_x/\\partial y + \\partial u_y/\\partial x = -\\theta + \\theta = 0$。任何有效的有限元列式都必须对任何刚体运动产生零应变和零应力。因此，观察到指定刚体转动下的零反作用力仅仅证实了该单元能正确处理物理刚体模式。它并不能揭示像沙漏这样的*伪*模式。该陈述将物理零能模式与伪零能模式混为一谈。此外，“线性场检验因对转动不敏感而失败”的说法是错误的；刚体转动是仿射/线性场的一个特例，单元通过贴片检验的能力包括正确表示这种零应变状态。\n\n结论：**不正确**。\n\n**D. 仅在左右边缘指定交替边界位移 $u_x(i,j) = \\Delta \\, (-1)^i$ 和 $u_y(i,j) = 0$，而顶部和底部边缘完全固定，并通过内部节点位移的非唯一性来诊断沙漏现象。这揭示了沙漏现象，因为交替模式将每个单元的形心应变减小到零。线性场检验失败的原因与选项 B 相同。**\n\n指定的边界条件是自相矛盾的。节点 $(0,0)$ 同时位于左边缘 ($i=0$) 和底边缘 ($j=0$)。左边缘规则指定 $u_x(0,0) = \\Delta(-1)^0 = \\Delta$，而底边缘规则要求其完全固定，即 $u_x(0,0)=0$。这些条件不能同时应用。此外，对于左边缘 ($i=0$) 的规定 $u_x(i,j) = \\Delta(-1)^i$ 意味着该边缘上所有节点的 $u_x = \\Delta$，这并非沿该边缘的“交替”模式。所提议的检验定义不明确。\n\n结论：**不正确**。\n\n基于严谨的分析，选项 B 提供了唯一正确的、旨在揭示沙漏现象的贴片检验的描述，以及对其机理和标准线性贴片检验失败原因的正确解释。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在显式动力学分析中，沙漏不稳定问题尤为突出，因此从静态检测过渡到动态分析至关重要。本练习研究了在施加典型控制方案（刚度和阻尼）时，沙漏模式在时域中的行为。通过分析该模式在不同质量矩阵公式（集中质量与一致质量）下的稳定性，您将深入了解哪些数值因素会抑制或加剧这些随时间演变的伪振荡。",
            "id": "3602209",
            "problem": "考虑一个二维空间中的单点减缩积分$4$节点双线性四边形（Q4）有限元方法（FEM）单元，但将注意力限制在每个节点沿一个笛卡尔方向的单个标量自由度上。在$1$点（减缩）积分下，该单元表现出一个伪零能沙漏模式。设节点位移向量为 $u \\in \\mathbb{R}^4$，并选择一个由下式定义的典型沙漏模式向量 $q \\in \\mathbb{R}^4$：\n$$\nq = \\begin{bmatrix} 1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{bmatrix}.\n$$\n假设单位正方形单元的面积 $A = 1$，单位集中密度-厚度 $\\rho t = 1$，并对每个节点的标量自由度采用以下质量矩阵：\n- 一致质量矩阵 $M_c$ 由下式给出：\n$$\nM_c = \\frac{A}{36} \\begin{bmatrix}\n4  & 2 & 1 & 2 \\\\\n2 & 4 & 2 & 1 \\\\\n1 & 2 & 4 & 2 \\\\\n2 & 1 & 2 & 4\n\\end{bmatrix},\n$$\n- 集中质量矩阵 $M_l$ 由下式给出：\n$$\nM_l = \\operatorname{diag}\\left(\\frac{A}{4}, \\frac{A}{4}, \\frac{A}{4}, \\frac{A}{4}\\right).\n$$\n人工沙漏控制被建模为仅在由 $q$ 张成的沙漏子空间中起作用的粘性和刚度罚函数，其中\n$$\nK_{\\mathrm{hg}} = k_0 \\, q q^{\\mathsf{T}}, \\qquad C_{\\mathrm{hg}} = c_0 \\, q q^{\\mathsf{T}},\n$$\n其中 $k_0 \\ge 0$ 和 $c_0 \\ge 0$ 是无量纲控制参数。考虑沙漏子空间中的半离散自由振动方程，通过假定解 $u(t) = a(t) q$ 进行投影：\n$$\nM \\, \\ddot{u}(t) + C_{\\mathrm{hg}} \\, \\dot{u}(t) + K_{\\mathrm{hg}} \\, u(t) = 0.\n$$\n投影到 $q$ 上，得到关于沙漏振幅 $a(t)$ 的单自由度振子：\n$$\nm \\, \\ddot{a}(t) + c \\, \\dot{a}(t) + k \\, a(t) = 0,\n$$\n其有效模态系数为\n$$\nm = q^{\\mathsf{T}} M q, \\qquad c = q^{\\mathsf{T}} C_{\\mathrm{hg}} q = c_0 \\, (q^{\\mathsf{T}} q)^2, \\qquad k = q^{\\mathsf{T}} K_{\\mathrm{hg}} q = k_0 \\, (q^{\\mathsf{T}} q)^2.\n$$\n所有量都是无量纲的；答案中不需要也不期望有物理单位。\n\n时间积分通过 Newmark 族方法执行，采用平均加速度参数 $\\gamma = \\tfrac{1}{2}$ 和 $\\beta = \\tfrac{1}{4}$。用 $\\Delta t > 0$ 表示离散时间步长。对于给定的 $(m,c,k,\\Delta t)$，Newmark 方法定义了一个线性放大算子，该算子将时间步 $n$ 的状态向量 $[u^n, v^n, a^n]^{\\mathsf{T}}$ 映射到时间步 $n+1$ 的状态向量 $[u^{n+1}, v^{n+1}, a^{n+1}]^{\\mathsf{T}}$。沙漏模式在一个时间步长内的增长/衰减因子是该放大算子的谱半径 $\\rho$，即其特征值的最大模。$\\rho  1$ 表示衰减，$\\rho = 1$ 表示中性传播，$\\rho > 1$ 表示增长。\n\n任务：\n- 对 $M = M_c$（一致）和 $M = M_l$（集中）两种情况推导 $m$。\n- 为应用于标量振子 $m \\, \\ddot{a} + c \\, \\dot{a} + k \\, a = 0$ 的 Newmark 平均加速度方法（参数为 $\\gamma = \\tfrac{1}{2}$ 和 $\\beta = \\tfrac{1}{4}$）构建 $3 \\times 3$ 放大矩阵，并将 $[u,v,a]$ 视为状态。\n- 对下面的每个测试用例，使用相同的 $(k_0,c_0,\\Delta t)$，分别用 $M = M_c$ 计算谱半径 $\\rho_c$ 和用 $M = M_l$ 计算谱半径 $\\rho_l$。使用 $q^{\\mathsf{T}} q = 4$ 和上述定义从 $(k_0,c_0)$ 获得 $k$ 和 $c$。\n- 判断质量集中是否加剧了伪振荡，这里定义为谓词 $\\rho_l > \\rho_c$。\n\n测试套件：\n- 用例 1： $(k_0, c_0, \\Delta t) = (0.5, 0.1, 0.2)$。\n- 用例 2： $(k_0, c_0, \\Delta t) = (0.0, 0.1, 0.4)$。\n- 用例 3： $(k_0, c_0, \\Delta t) = (0.0, 0.0, 0.1)$。\n- 用例 4： $(k_0, c_0, \\Delta t) = (2.0, 0.02, 0.05)$。\n\n你的程序必须：\n- 按照说明进行数值推导，为每个用例生成 $\\rho_c$ 和 $\\rho_l$，并四舍五入到 $8$ 位小数。\n- 对每个用例，输出一个列表 $[\\rho_c, \\rho_l, \\text{exacerbate}]$，其中 $\\text{exacerbate}$ 是一个布尔值，当且仅当 $\\rho_l  \\rho_c$ 时为 $\\text{True}$。\n- 将所有四个用例的结果按给定顺序汇总到一个列表中。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个用例都按指定格式格式化，浮点数四舍五入到 $8$ 位小数，例如：$[[\\rho_{c,1},\\rho_{l,1},\\text{bool}_1],[\\rho_{c,2},\\rho_{l,2},\\text{bool}_2],[\\rho_{c,3},\\rho_{l,3},\\text{bool}_3],[\\rho_{c,4},\\rho_{l,4},\\text{bool}_4]]$。",
            "solution": "用户提供了一个来自计算固体力学领域的适定问题陈述。该问题具有科学依据，客观，并包含得出唯一解所需的所有必要信息。因此，该问题被认为是有效的。\n\n任务是分析在使用 Newmark 平均加速度方法进行时间积分时，一个$4$节点四边形有限元在不同质量矩阵公式（一致与集中）下伪沙漏模式的稳定性。稳定性通过与数值方案相关的放大算子的谱半径来量化。\n\n### 步骤 1：模态参数的推导\n\n沙漏模式的动力学被投影到典型沙漏向量 $q = \\begin{bmatrix} 1  -1  1  -1 \\end{bmatrix}^{\\mathsf{T}}$ 上，得到关于模态振幅 $a(t)$ 的单自由度振子：\n$$\nm \\, \\ddot{a}(t) + c \\, \\dot{a}(t) + k \\, a(t) = 0\n$$\n有效模态参数 $m$、$c$ 和 $k$ 是通过将完整系统矩阵投影到沙漏模式 $q$ 上推导出来的。\n\n**有效刚度和阻尼：**\n沙漏刚度和阻尼由 $K_{\\mathrm{hg}} = k_0 \\, q q^{\\mathsf{T}}$ 和 $C_{\\mathrm{hg}} = c_0 \\, q q^{\\mathsf{T}}$ 给出。有效模态系数为：\n$$\nk = q^{\\mathsf{T}} K_{\\mathrm{hg}} q = q^{\\mathsf{T}} (k_0 \\, q q^{\\mathsf{T}}) q = k_0 (q^{\\mathsf{T}} q) (q^{\\mathsf{T}} q) = k_0 (q^{\\mathsf{T}} q)^2\n$$\n$$\nc = q^{\\mathsf{T}} C_{\\mathrm{hg}} q = q^{\\mathsf{T}} (c_0 \\, q q^{\\mathsf{T}}) q = c_0 (q^{\\mathsf{T}} q) (q^{\\mathsf{T}} q) = c_0 (q^{\\mathsf{T}} q)^2\n$$\n给定向量 $q$，我们首先计算标量积 $q^{\\mathsf{T}} q$：\n$$\nq^{\\mathsf{T}} q = (1)^2 + (-1)^2 + (1)^2 + (-1)^2 = 1+1+1+1=4\n$$\n因此，有效刚度和阻尼为：\n$$\nk = k_0 (4)^2 = 16 k_0\n$$\n$$\nc = c_0 (4)^2 = 16 c_0\n$$\n\n**有效质量：**\n有效模态质量 $m$ 由 $m = q^{\\mathsf{T}} M q$ 给出。我们必须针对集中质量矩阵和一致质量矩阵计算这个值，单元面积 $A=1$。\n\n1.  **集中质量矩阵 ($M_l$)：**\n    集中质量矩阵是对角矩阵：$M_l = \\operatorname{diag}\\left(\\frac{A}{4}, \\frac{A}{4}, \\frac{A}{4}, \\frac{A}{4}\\right) = \\frac{1}{4} I$，其中 $I$ 是 $4 \\times 4$ 单位矩阵。\n    $$\n    m_l = q^{\\mathsf{T}} M_l q = q^{\\mathsf{T}} \\left(\\frac{1}{4} I\\right) q = \\frac{1}{4} q^{\\mathsf{T}} q = \\frac{1}{4} (4) = 1\n    $$\n    集中公式的有效质量是 $m_l = 1$。\n\n2.  **一致质量矩阵 ($M_c$)：**\n    一致质量矩阵由 $M_c = \\frac{A}{36} \\begin{bmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{bmatrix} = \\frac{1}{36} \\begin{bmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{bmatrix}$ 给出。\n    我们计算乘积 $M_c q$：\n    $$\n    M_c q = \\frac{1}{36} \\begin{bmatrix} 4  2  1  2 \\\\ 2  4  2  1 \\\\ 1  2  4  2 \\\\ 2  1  2  4 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{bmatrix} = \\frac{1}{36} \\begin{bmatrix} 4(1) + 2(-1) + 1(1) + 2(-1) \\\\ 2(1) + 4(-1) + 2(1) + 1(-1) \\\\ 1(1) + 2(-1) + 4(1) + 2(-1) \\\\ 2(1) + 1(-1) + 2(1) + 4(-1) \\end{bmatrix} = \\frac{1}{36} \\begin{bmatrix} 1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{bmatrix} = \\frac{1}{36} q\n    $$\n    沙漏向量 $q$ 是 $M_c$ 的一个特征向量，其特征值为 $\\frac{1}{36}$。\n    那么有效质量为：\n    $$\n    m_c = q^{\\mathsf{T}} M_c q = q^{\\mathsf{T}} \\left(\\frac{1}{36} q\\right) = \\frac{1}{36} q^{\\mathsf{T}} q = \\frac{1}{36}(4) = \\frac{1}{9}\n    $$\n    一致公式的有效质量为 $m_c = \\frac{1}{9}$。值得注意的是，$m_c  m_l$。\n\n### 步骤 2：Newmark 放大矩阵\n\nNewmark 族方法用于时间积分。具体参数为 $\\gamma = \\frac{1}{2}$ 和 $\\beta = \\frac{1}{4}$，对应于平均加速度法，该方法对线性系统是无条件稳定的。我们分别用 $d_n$、$v_n$ 和 $A_n$ 表示时间步 $n$ 的模态位移、速度和加速度。状态由向量 $[d_n, v_n, A_n]^{\\mathsf{T}}$ 表示。用于找到 $n+1$ 状态的更新公式如下：\n$$\nd_{n+1} = d_n + \\Delta t \\, v_n + \\Delta t^2 \\left[ \\left(\\frac{1}{2} - \\beta\\right) A_n + \\beta A_{n+1} \\right]\n$$\n$$\nv_{n+1} = v_n + \\Delta t \\left[ (1 - \\gamma) A_n + \\gamma A_{n+1} \\right]\n$$\n并且运动方程必须在时间 $t_{n+1}$ 得到满足：\n$$\nm A_{n+1} + c v_{n+1} + k d_{n+1} = 0\n$$\n代入 $\\gamma = \\frac{1}{2}$ 和 $\\beta = \\frac{1}{4}$：\n$$\nd_{n+1} = d_n + \\Delta t \\, v_n + \\frac{\\Delta t^2}{4} (A_n + A_{n+1})\n$$\n$$\nv_{n+1} = v_n + \\frac{\\Delta t}{2} (A_n + A_{n+1})\n$$\n我们可以将状态 $[d_{n+1}, v_{n+1}, A_{n+1}]^{\\mathsf{T}}$ 表示为状态 $[d_n, v_n, A_n]^{\\mathsf{T}}$ 的线性变换。为此，我们首先通过将 $d_{n+1}$ 和 $v_{n+1}$ 的表达式代入运动方程来求解 $A_{n+1}$：\n$$\nm A_{n+1} + c \\left(v_n + \\frac{\\Delta t}{2} A_n + \\frac{\\Delta t}{2} A_{n+1}\\right) + k \\left(d_n + \\Delta t \\, v_n + \\frac{\\Delta t^2}{4} A_n + \\frac{\\Delta t^2}{4} A_{n+1}\\right) = 0\n$$\n收集 $A_{n+1}$ 的项：\n$$\n\\left( m + c\\frac{\\Delta t}{2} + k\\frac{\\Delta t^2}{4} \\right) A_{n+1} = -k d_n - (c + k \\Delta t) v_n - \\left( c\\frac{\\Delta t}{2} + k\\frac{\\Delta t^2}{4} \\right) A_n\n$$\n设 $D = m + c\\frac{\\Delta t}{2} + k\\frac{\\Delta t^2}{4}$。我们可以将 $A_{n+1}$ 写成时间步 $n$ 状态的线性组合：\n$$\nA_{n+1} = \\left(-\\frac{k}{D}\\right) d_n + \\left(-\\frac{c + k \\Delta t}{D}\\right) v_n + \\left(-\\frac{c\\Delta t/2 + k\\Delta t^2/4}{D}\\right) A_n\n$$\n设此为 $A_{n+1} = A_{31} d_n + A_{32} v_n + A_{33} A_n$。现在可以将 $d_{n+1}$ 和 $v_{n+1}$ 的表达式用时间步 $n$ 的状态来表示：\n$$\nd_{n+1} = d_n + \\Delta t v_n + \\frac{\\Delta t^2}{4} A_n + \\frac{\\Delta t^2}{4} (A_{31} d_n + A_{32} v_n + A_{33} A_n)\n$$\n$$\nv_{n+1} = v_n + \\frac{\\Delta t}{2} A_n + \\frac{\\Delta t}{2} (A_{31} d_n + A_{32} v_n + A_{33} A_n)\n$$\n这定义了 $3 \\times 3$ 放大矩阵 $\\mathbf{A}$，使得 $[d_{n+1}, v_{n+1}, A_{n+1}]^{\\mathsf{T}} = \\mathbf{A} [d_n, v_n, A_n]^{\\mathsf{T}}$：\n$$\n\\mathbf{A} = \\begin{bmatrix}\n1 + \\frac{\\Delta t^2}{4} A_{31}  \\Delta t + \\frac{\\Delta t^2}{4} A_{32}  \\frac{\\Delta t^2}{4}(1 + A_{33}) \\\\\n\\frac{\\Delta t}{2} A_{31}  1 + \\frac{\\Delta t}{2} A_{32}  \\frac{\\Delta t}{2}(1 + A_{33}) \\\\\nA_{31}  A_{32}  A_{33}\n\\end{bmatrix}\n$$\n\n### 步骤 3：谱半径和稳定性分析\n\n数值方案的稳定性由放大矩阵 $\\mathbf{A}$ 的特征值决定。如果所有特征值的模都小于或等于1，则该方法是稳定的。谱半径 $\\rho(\\mathbf{A})$ 是特征值中的最大模：\n$$\n\\rho(\\mathbf{A}) = \\max_i |\\lambda_i|\n$$\n其中 $\\lambda_i$ 是 $\\mathbf{A}$ 的特征值。\n- 如果 $\\rho  1$，任何初始扰动都会衰减，表明存在数值阻尼。\n- 如果 $\\rho = 1$，模式的振幅是中性稳定的。\n- 如果 $\\rho > 1$，模式将会增长，导致数值不稳定。\n\n较大的谱半径（更接近于$1$）意味着较少的数值阻尼，从而导致更持久（加剧）的伪振荡。我们将计算一致质量情况下的谱半径 $\\rho_c=\\rho(\\mathbf{A}_c)$ 和集中质量情况下的谱半径 $\\rho_l=\\rho(\\mathbf{A}_l)$。谓词 $\\rho_l > \\rho_c$ 决定了对于给定的参数集，质量集中是否会加剧沙漏模式。\n\n### 步骤 4：测试用例的数值评估\n\n对每个测试用例 $(k_0, c_0, \\Delta t)$，执行以下算法：\n1.  计算 $k = 16 k_0$ 和 $c = 16 c_0$。\n2.  **一致质量情况：**\n    a. 设置 $m = m_c = 1/9$。\n    b. 使用 $(m, c, k, \\Delta t)$ 构建放大矩阵 $\\mathbf{A}_c$。\n    c. 计算 $\\mathbf{A}_c$ 的特征值并找到谱半径 $\\rho_c$。\n3.  **集中质量情况：**\n    a. 设置 $m = m_l = 1$。\n    b. 使用 $(m, c, k, \\Delta t)$ 构建放大矩阵 $\\mathbf{A}_l$。\n    c. 计算 $\\mathbf{A}_l$ 的特征值并找到谱半径 $\\rho_l$。\n4.  比较结果以确定是否 $\\rho_l > \\rho_c$。\n5.  将三元组 $[\\rho_c, \\rho_l, (\\rho_l > \\rho_c)]$ 存储为最终输出，浮点数四舍五入到 $8$ 位小数。\n\n此过程将在提供的 Python 脚本中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing hourglass mode stability for consistent\n    and lumped mass matrices using the Newmark average acceleration method.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k0, c0, dt)\n        (0.5, 0.1, 0.2),\n        (0.0, 0.1, 0.4),\n        (0.0, 0.0, 0.1),\n        (2.0, 0.02, 0.05),\n    ]\n\n    # Pre-calculated modal parameter constants\n    qTq = 4.0\n    m_c = 1.0 / 9.0  # Effective mass for consistent mass matrix\n    m_l = 1.0        # Effective mass for lumped mass matrix\n\n    def calculate_spectral_radius(m, c, k, dt):\n        \"\"\"\n        Constructs the Newmark amplification matrix for state [d, v, A]\n        and returns its spectral radius.\n        \n        Args:\n            m (float): Effective mass\n            c (float): Effective damping\n            k (float): Effective stiffness\n            dt (float): Time step\n        \n        Returns:\n            float: The spectral radius of the amplification matrix.\n        \"\"\"\n        # Newmark parameters for average acceleration method\n        beta = 0.25\n        gamma = 0.5\n        \n        # Denominator in the expression for A_{n+1}\n        # D = m + c*gamma*dt + k*beta*dt**2\n        D = m + c * (gamma * dt) + k * (beta * dt**2)\n        \n        if D == 0:\n            # Avoid division by zero, though unlikely with the given problem setup.\n            # A large number will indicate instability if it happens.\n            return np.inf\n\n        # Third row of the amplification matrix A, which relates A_{n+1} to [d_n, v_n, A_n]\n        A31 = -k / D\n        A32 = -(c + k * dt) / D\n        # A33 = -(c * (1 - gamma) * dt + k * (0.5 - beta) * dt**2) / D\n        \n        # With beta=1/4 and gamma=1/2:\n        A33 = -(c * dt / 2 + k * dt**2 / 4) / D\n\n        # Construct the full 3x3 amplification matrix\n        # amp_matrix = np.array([\n        #     [1 + beta * dt**2 * A31, dt + beta * dt**2 * A32, dt**2 * (0.5 - beta) + beta * dt**2 * A33],\n        #     [gamma * dt * A31, 1 + gamma * dt * A32, dt * (1 - gamma) + gamma * dt * A33],\n        #     [A31, A32, A33]\n        # ])\n\n        # Using direct formula for beta=1/4, gamma=1/2\n        amp_matrix = np.array([\n            [1 + 0.25 * dt**2 * A31, dt + 0.25 * dt**2 * A32, 0.25 * dt**2 * (1 + A33)],\n            [0.5 * dt * A31, 1 + 0.5 * dt * A32, 0.5 * dt * (1 + A33)],\n            [A31, A32, A33]\n        ])\n\n        # Calculate eigenvalues and find the spectral radius (max absolute value)\n        eigenvalues = np.linalg.eigvals(amp_matrix)\n        spectral_radius = np.max(np.abs(eigenvalues))\n        \n        return spectral_radius\n\n    results = []\n    for case in test_cases:\n        k0, c0, dt = case\n        \n        # Calculate effective stiffness and damping\n        k = k0 * (qTq**2)\n        c = c0 * (qTq**2)\n        \n        # Calculate spectral radius for consistent mass\n        rho_c = calculate_spectral_radius(m_c, c, k, dt)\n        \n        # Calculate spectral radius for lumped mass\n        rho_l = calculate_spectral_radius(m_l, c, k, dt)\n        \n        # Round results to 8 decimal places\n        rho_c_rounded = round(rho_c, 8)\n        rho_l_rounded = round(rho_l, 8)\n        \n        # Check if mass lumping exacerbates oscillations\n        is_exacerbated = rho_l_rounded > rho_c_rounded\n        \n        results.append([rho_c_rounded, rho_l_rounded, is_exacerbated])\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) automatically converts each inner list to its string representation.\n    # The replacement is needed to match the boolean format exactly.\n    final_string = f\"[{','.join(map(str, results))}]\".replace(\"'True'\", 'True').replace(\"'False'\", 'False')\n    print(final_string)\n\nsolve()\n```"
        }
    ]
}