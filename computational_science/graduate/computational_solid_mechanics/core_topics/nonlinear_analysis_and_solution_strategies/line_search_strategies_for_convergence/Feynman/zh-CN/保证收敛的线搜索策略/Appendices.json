{
    "hands_on_practices": [
        {
            "introduction": "Armijo 条件，也称为充分下降条件，是许多线搜索算法的基石。它确保每一步都能在不过大的前提下，为目标函数带来有意义的减少。第一个实践练习  提供了一个具体的编程任务，要求你为一个简单的非线性超弹性杆实现这一基本的回溯算法，帮助你建立开发数值求解器所需的基础技能。",
            "id": "3577625",
            "problem": "考虑超弹性杆的一维总势能，其由标量函数 $\\Pi(u) = \\tfrac{1}{2}\\,k\\,u^{2} + \\tfrac{1}{4}\\,\\beta\\,u^{4} - f\\,u$ 给出，其中 $k$、$\\beta$、$f$ 和 $u$ 均为无量纲实数。在迭代点 $u^{k}$ 和给定的搜索方向 $p^{k}$ 下，应用 Armijo 回溯线搜索，找到第一个满足充分下降条件的、可接受的步长 $\\alpha \\in (0,1]$：\n$\\Pi(u^{k} + \\alpha\\,p^{k}) \\le \\Pi(u^{k}) + c_{1}\\,\\alpha\\,\\nabla \\Pi(u^{k})\\,p^{k}$，\n其中 $\\nabla \\Pi(u)$ 表示 $\\Pi$ 关于 $u$ 的导数，而乘积 $\\nabla \\Pi(u^{k})\\,p^{k}$ 是在方向 $p^{k}$ 上的方向导数。请使用以下规则和参数：\n- 使用初始步长 $\\alpha_{0} = 1$，回溯因子 $\\tau = 0.5$，以及 Armijo 常数 $c_{1} = 10^{-4}$。\n- 如果方向不是下降方向，即 $\\nabla \\Pi(u^{k})\\,p^{k} \\ge 0$，则在开始回溯之前，将 $p^{k}$ 替换为最速下降方向 $-\\,\\nabla \\Pi(u^{k})$。\n- 如果在此检查后 $p^{k} = 0$，则按照约定返回 $\\alpha = 1$，因为此时 $\\Pi(u^{k} + \\alpha\\,p^{k}) = \\Pi(u^{k})$，条件不言自明地成立。\n- 在回溯期间，从 $\\alpha = \\alpha_{0}$ 开始反复测试 Armijo 条件，并更新 $\\alpha \\leftarrow \\tau\\,\\alpha$，直到该条件首次被满足。为了数值稳健性，可以将回溯次数限制在一个固定的有限整数内。\n\n基于基本原理进行实现：通过对 $\\Pi(u)$ 求导直接计算 $\\nabla \\Pi(u)$，评估给定的 Armijo 条件，并执行所述的回溯操作。所有量均为无量纲（没有物理单位）。\n\n实现一个程序，对下述每个测试用例，根据上述规则计算出第一个可接受的 $\\alpha$。\n\n测试用例（每个用例指定 $(k,\\beta,f,u^{k},p^{k})$）：\n- 用例 A（在二次能量上的类牛顿步，预计接受接近于 1 的 $\\alpha$）：$k = 10$，$\\beta = 0$，$f = 4$，$u^{k} = 0.5$，$p^{k} = -0.1$。\n- 用例 B（非下降输入方向；强制执行最速下降，中等刚度，使得第一个可接受的折半步长为 $\\alpha = 0.5$）：$k = 3$，$\\beta = 0$，$f = 0$，$u^{k} = 1.0$，$p^{k} = +1.0$。\n- 用例 C（在具有更强刚度的二次能量上进行最速下降，使得 $\\alpha = 0.25$ 是第一个可接受的步长）：$k = 5$，$\\beta = 0$，$f = 0$，$u^{k} = 1.0$，$p^{k} = -5.0$。\n- 用例 D（零方向；按约定返回 $\\alpha = 1$；同时检验四次项）：$k = 2$，$\\beta = 5$，$f = 0$，$u^{k} = 0.0$，$p^{k} = 0.0$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，并按测试用例的顺序排列，例如 $[\\alpha_{A},\\alpha_{B},\\alpha_{C},\\alpha_{D}]$。每个用例的答案必须是实数（浮点值）。",
            "solution": "用户提供的问题经评估有效。其科学基础在于非线性力学的数值优化原理，问题提法得当，具有清晰确定的算法，并以形式化的方式指定了所有必要的数据和条件。以下解决方案遵循指定的算法流程。\n\n核心任务是实现 Armijo 回溯线搜索，以找到一个可接受的步长 $\\alpha$，用于最小化一维势能函数 $\\Pi(u)$。\n\n势能由下式给出：\n$$ \\Pi(u) = \\tfrac{1}{2}\\,k\\,u^{2} + \\tfrac{1}{4}\\,\\beta\\,u^{4} - f\\,u $$\n其中 $k$、$\\beta$、$f$ 和 $u$ 是无量纲实数。\n\n第一步是推导势能的梯度 $\\nabla\\Pi(u)$，它在力学系统中代表残余力。通过对 $\\Pi(u)$ 关于 $u$ 求导，我们得到：\n$$ \\nabla\\Pi(u) = \\frac{d\\Pi}{du} = k\\,u + \\beta\\,u^{3} - f $$\n\nArmijo 线搜索算法旨在找到一个步长 $\\alpha \\in (0, 1]$，使其满足充分下降条件。该条件确保新点 $u^{k+1} = u^k + \\alpha p^k$ 产生的势能减少量至少是在 $u^k$ 处的一阶泰勒展开所预测的线性减少量的一部分。该条件可正式表述为：\n$$ \\Pi(u^{k} + \\alpha\\,p^{k}) \\le \\Pi(u^{k}) + c_{1}\\,\\alpha\\,\\nabla \\Pi(u^{k})\\,p^{k} $$\n这里，$u^k$ 是当前迭代点，$p^k$ 是搜索方向，$c_1$ 是 Armijo 常数（给定为 $c_1 = 10^{-4}$），而项 $\\nabla\\Pi(u^k)p^k$ 是 $\\Pi$ 在 $u^k$ 点沿方向 $p^k$ 的方向导数。\n\n指定的算法流程如下：\n\n1.  **方向验证**：在当前迭代点 $u^k$，计算梯度 $\\nabla\\Pi(u^k)$ 和方向导数 $\\nabla\\Pi(u^k)p^k$。一个有效的搜索方向必须是下降方向，即必须满足 $\\nabla\\Pi(u^k)p^k  0$。如果情况并非如此（即，如果 $\\nabla\\Pi(u^k)p^k \\ge 0$），则舍弃提供的搜索方向 $p^k$。它将被替换为最速下降方向，定义为 $p^k \\leftarrow -\\nabla\\Pi(u^k)$。\n\n2.  **零方向处理**：在方向验证步骤之后，检查得到的搜索方向 $p^k$。如果 $p^k = 0$，这意味着 $\\nabla\\Pi(u^k)=0$，即 $u^k$ 是一个驻点（一个平衡位置）。在驻点处，无法取得进一步的进展。Armijo 条件简化为 $\\Pi(u^k) \\le \\Pi(u^k)$，这显然成立。根据问题的约定，在这种情况下返回 $\\alpha=1$。\n\n3.  **回溯搜索**：如果搜索方向 $p^k$ 是一个非零的下降方向，则开始回溯过程。\n    - 初始试探步长设置为 $\\alpha = \\alpha_0 = 1$。\n    - 使用当前的 $\\alpha$ 评估 Armijo 充分下降条件。\n    - 如果条件满足，则接受当前的 $\\alpha$，搜索终止。\n    - 如果条件不满足，则步长过大。它将通过回溯因子 $\\tau = 0.5$ 进行缩减，因此新的试探步长变为 $\\alpha \\leftarrow \\tau\\alpha$。\n    - 重复此检查条件和缩减 $\\alpha$ 的过程，直到条件首次被满足。连续可微函数的性质保证了对于足够小的 $\\alpha > 0$，此过程必将终止。\n\n将此完整算法应用于每个提供的测试用例 $(k, \\beta, f, u^k, p^k)$，以确定第一个可接受的步长 $\\alpha$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Armijo line search step size for a series of test cases.\n    \"\"\"\n\n    # Test cases: tuples of (k, beta, f, u_k, p_k)\n    test_cases = [\n        (10.0, 0.0, 4.0, 0.5, -0.1), # Case A\n        (3.0, 0.0, 0.0, 1.0, 1.0),  # Case B\n        (5.0, 0.0, 0.0, 1.0, -5.0), # Case C\n        (2.0, 5.0, 0.0, 0.0, 0.0)   # Case D\n    ]\n\n    # --- Helper functions for potential energy and its gradient ---\n    def pi_potential(u, k, beta, f):\n        \"\"\"Computes the potential energy Pi(u) as a scalar.\"\"\"\n        return 0.5 * k * u**2 + 0.25 * beta * u**4 - f * u\n\n    def grad_pi_potential(u, k, beta, f):\n        \"\"\"Computes the gradient of the potential energy nabla Pi(u) as a scalar.\"\"\"\n        return k * u + beta * u**3 - f\n\n    def perform_line_search(k, beta, f, u_k, p_k):\n        \"\"\"\n        Performs the Armijo backtracking line search for a single case.\n        \"\"\"\n        # Line search parameters as defined in the problem\n        c1 = 1e-4\n        tau = 0.5\n        alpha_0 = 1.0\n\n        # Calculate gradient at the current iterate u_k\n        grad_k = grad_pi_potential(u_k, k, beta, f)\n        \n        current_p_k = float(p_k)\n\n        # Step 1: Check if the search direction is a descent direction.\n        # If not, replace it with the steepest descent direction.\n        dir_deriv = grad_k * current_p_k\n        if dir_deriv >= 0:\n            current_p_k = -grad_k\n        \n        # Step 2: Handle the zero direction case.\n        # This check occurs *after* the potential update of p_k.\n        if np.isclose(current_p_k, 0.0):\n            return 1.0\n        \n        # Step 3: Perform backtracking line search.\n        # Re-calculate directional derivative in case p_k was updated.\n        dir_deriv = grad_k * current_p_k\n        \n        alpha = alpha_0\n        pi_k = pi_potential(u_k, k, beta, f)\n        \n        # This term on the RHS of the Armijo condition is constant during the loop\n        armijo_rhs_slope = c1 * dir_deriv\n        \n        # Loop until the Armijo condition is satisfied\n        while True:\n            lhs = pi_potential(u_k + alpha * current_p_k, k, beta, f)\n            rhs = pi_k + alpha * armijo_rhs_slope\n            \n            if lhs = rhs:\n                # Sufficient decrease condition is met\n                return alpha\n            \n            # Condition not met, backtrack (reduce step size)\n            alpha *= tau\n\n    results = []\n    for case in test_cases:\n        alpha_result = perform_line_search(*case)\n        results.append(alpha_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然 Armijo 条件能有效防止步长过大，但它本身并不能排除那些可能减慢收敛速度的过小步长。为了确保迭代取得实质性进展，我们通常会引入曲率条件，从而构成强 Wolfe 条件。这个练习  要求你为一个非线性弹簧模型找到一个同时满足充分下降条件和曲率条件的步长 $\\alpha$，从而加深你对何为“好”步长的理解。",
            "id": "3577646",
            "problem": "一个位移为 $u$ 的一维非线性弹簧，其内能遵循截断的小应变多项式模型 $E(u)=\\frac{1}{2} k\\,u^{2}+\\frac{1}{3} b\\,u^{3}$，其中 $k>0$ 和 $b>0$ 是无量纲刚度参数。平衡构型通过最小化总势能得到，牛顿-拉夫逊（NR）迭代通过沿下降方向 $p^{k}$ 的线搜索进行全局化。在当前迭代点 $u^{k}$，线搜索寻找一个步长 $\\alpha>0$，该步长能够减小标量函数 $\\phi(\\alpha)=E(u^{k}+\\alpha\\,p^{k})$ 的值，同时促进全局收敛。\n\n考虑具体数据 $k=100$，$b=200$，$u^{k}=0.05$ 和 $p^{k}=-0.02$，均为无量纲。沿线搜索的目标是三次函数 $\\phi(\\alpha)=E(u^{k}+\\alpha\\,p^{k})$。计算一个单一的正步长 $\\alpha$，使其沿给定方向 $p^{k}$ 同时满足 Armijo 充分下降条件（$c_{1}=10^{-4}$）和强 Wolfe 曲率条件（$c_{2}=0.9$）。将最终的 $\\alpha$ 表示为一个无量纲数。如果必须进行近似，请将答案四舍五入到四位有效数字。",
            "solution": "用户提供了一个来自计算力学的问题，涉及一维非线性系统的线搜索。\n\n### 第一步：提取已知条件\n-   内能函数：$E(u)=\\frac{1}{2} k\\,u^{2}+\\frac{1}{3} b\\,u^{3}$\n-   刚度参数：$k>0$，$b>0$\n-   具体数据：$k=100$，$b=200$（无量纲）\n-   当前迭代点：$u^{k}=0.05$（无量纲）\n-   搜索方向：$p^{k}=-0.02$（无量纲）\n-   线搜索目标函数：$\\phi(\\alpha)=E(u^{k}+\\alpha\\,p^{k})$\n-   Armijo条件参数：$c_{1}=10^{-4}$\n-   强Wolfe条件参数：$c_{2}=0.9$\n-   目标：计算一个同时满足两个条件的单一正步长 $\\alpha>0$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，是适定的、客观的。它描述了带有线搜索全局化策略的牛顿型优化算法的一个标准应用，这是计算固体力学和数值优化中的一个核心课题。能量函数是一个简单但有效的多项式模型。线搜索条件（Armijo和强Wolfe）是标准的。所有必要的数据都已提供，且没有内部矛盾。该问题可以使用既定的数学原理进行形式化和求解。\n\n### 第三步：结论与行动\n问题有效。将提供完整的解答。\n\n### 求解推导\n目标是找到一个步长 $\\alpha>0$，使其满足线搜索函数 $\\phi(\\alpha)=E(u^{k}+\\alpha\\,p^{k})$ 的两个条件。\n\n这两个条件是：\n1.  **Armijo（充分下降）条件**：\n    $$\\phi(\\alpha) \\le \\phi(0) + c_{1} \\alpha \\phi'(0)$$\n2.  **强Wolfe（曲率）条件**：\n    $$|\\phi'(\\alpha)| \\le c_{2} |\\phi'(0)|$$\n\n首先，我们使用给定的能量函数 $E(u)$ 来定义 $\\phi(\\alpha)$ 及其导数 $\\phi'(\\alpha)$。\n能量函数关于 $u$ 的导数是内力：\n$$E'(u) = \\frac{dE}{du} = k u + b u^2$$\n线搜索函数 $\\phi(\\alpha)$ 关于 $\\alpha$ 的导数通过链式法则求得：\n$$\\phi'(\\alpha) = \\frac{d}{d\\alpha} E(u^{k}+\\alpha\\,p^{k}) = E'(u^{k}+\\alpha\\,p^{k}) \\cdot \\frac{d}{d\\alpha}(u^{k}+\\alpha\\,p^{k}) = E'(u^{k}+\\alpha\\,p^{k}) \\cdot p^{k}$$\n\n接下来，我们使用给定数据计算 $\\phi(0)$ 和 $\\phi'(0)$：\n$k=100$，$b=200$，$u^{k}=0.05$，$p^{k}=-0.02$。\n\n当 $\\alpha=0$ 时，我们处于当前迭代点 $u^k$：\n$$\\phi(0) = E(u^{k}) = \\frac{1}{2} k (u^{k})^{2} + \\frac{1}{3} b (u^{k})^{3}$$\n$$\\phi(0) = \\frac{1}{2}(100)(0.05)^{2} + \\frac{1}{3}(200)(0.05)^{3} = 50(0.0025) + \\frac{200}{3}(0.000125)$$\n$$\\phi(0) = 0.125 + \\frac{0.025}{3} = \\frac{1}{8} + \\frac{1}{120} = \\frac{15+1}{120} = \\frac{16}{120} = \\frac{2}{15}$$\n对于 $\\alpha=0$ 处的导数：\n$$E'(u^k) = k u^k + b (u^k)^2 = 100(0.05) + 200(0.05)^2 = 5 + 200(0.0025) = 5 + 0.5 = 5.5$$\n$$\\phi'(0) = E'(u^k) p^k = (5.5)(-0.02) = -0.11$$\n由于 $\\phi'(0)  0$，方向 $p^k$ 是一个有效的下降方向。\n\n现在，我们可以使用 $c_1 = 10^{-4}$ 和 $c_2 = 0.9$ 来陈述 $\\alpha$ 的具体条件：\n1.  Armijo: $\\phi(\\alpha) \\le \\frac{2}{15} + (10^{-4}) \\alpha (-0.11) \\implies \\phi(\\alpha) \\le \\frac{2}{15} - 0.000011 \\alpha$\n2.  强Wolfe: $|\\phi'(\\alpha)| \\le (0.9)|-0.11| \\implies |\\phi'(\\alpha)| \\le 0.099$\n\n为了继续，我们需要 $\\phi'(\\alpha)$ 的一般表达式。令 $u(\\alpha) = u^k + \\alpha p^k = 0.05 - 0.02\\alpha$。\n$$\\phi'(\\alpha) = \\left( k(u^k+\\alpha p^k) + b(u^k+\\alpha p^k)^2 \\right) p^k$$\n$$\\phi'(\\alpha) = \\left( 100(0.05 - 0.02\\alpha) + 200(0.05 - 0.02\\alpha)^2 \\right) (-0.02)$$\n我们展开括号中的项：\n$$(5 - 2\\alpha) + 200(0.0025 - 0.002\\alpha + 0.0004\\alpha^2) = 5 - 2\\alpha + 0.5 - 0.4\\alpha + 0.08\\alpha^2$$\n$$= 0.08\\alpha^2 - 2.4\\alpha + 5.5$$\n乘以 $p^k = -0.02$：\n$$\\phi'(\\alpha) = (-0.02)(0.08\\alpha^2 - 2.4\\alpha + 5.5) = -0.0016\\alpha^2 + 0.048\\alpha - 0.11$$\n\n问题要求计算一个单一的步长 $\\alpha$。通常存在一个可接受的 $\\alpha$ 值区间。对于单一的步长，最符合物理和数学原理的选择是使势能沿搜索方向最小化的那一个。这对应于“精确线搜索”，即我们找到 $\\alpha > 0$ 使得 $\\phi'(\\alpha)=0$。\n我们求解二次方程 $\\phi'(\\alpha)=0$：\n$$-0.0016\\alpha^2 + 0.048\\alpha - 0.11 = 0$$\n乘以 $-10000$ 以消除小数：\n$$16\\alpha^2 - 480\\alpha + 1100 = 0$$\n除以 $4$：\n$$4\\alpha^2 - 120\\alpha + 275 = 0$$\n使用求根公式 $\\alpha = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$\\alpha = \\frac{120 \\pm \\sqrt{(-120)^2 - 4(4)(275)}}{2(4)} = \\frac{120 \\pm \\sqrt{14400 - 4400}}{8}$$\n$$\\alpha = \\frac{120 \\pm \\sqrt{10000}}{8} = \\frac{120 \\pm 100}{8}$$\n这给出了两个正根：\n$$\\alpha_1 = \\frac{120-100}{8} = \\frac{20}{8} = 2.5$$\n$$\\alpha_2 = \\frac{120+100}{8} = \\frac{220}{8} = 27.5$$\n为了确定哪个根对应于最小值，我们检查二阶导数 $\\phi''(\\alpha)$ 的符号：\n$$\\phi''(\\alpha) = \\frac{d}{d\\alpha}(-0.0016\\alpha^2 + 0.048\\alpha - 0.11) = -0.0032\\alpha + 0.048$$\n在 $\\alpha_1=2.5$ 处：\n$$\\phi''(2.5) = -0.0032(2.5) + 0.048 = -0.008 + 0.048 = 0.04 > 0$$\n这表示一个局部最小值。\n在 $\\alpha_2=27.5$ 处：\n$$\\phi''(27.5) = -0.0032(27.5) + 0.048 = -0.088 + 0.048 = -0.04  0$$\n这表示一个局部最大值。\n使 $\\phi(\\alpha)$ 最小化的步长是 $\\alpha^*=2.5$。\n\n最后，我们必须验证 $\\alpha^*=2.5$ 是否同时满足 Armijo 和强 Wolfe 条件。\n1.  **强 Wolfe 条件**：\n    我们必须检查是否 $|\\phi'(2.5)| \\le 0.099$。根据构造，$\\alpha^*=2.5$ 是 $\\phi'(\\alpha)$ 的一个根，因此 $\\phi'(2.5)=0$。条件变为 $|0| \\le 0.099$，这是成立的。\n\n2.  **Armijo 条件**：\n    我们必须检查是否 $\\phi(2.5) \\le \\phi(0) + c_1(2.5)\\phi'(0)$。为了找到 $\\phi(2.5)$，我们对 $\\phi'(\\alpha)$ 进行积分：\n    $$\\phi(\\alpha) = \\int (-0.0016\\alpha^2 + 0.048\\alpha - 0.11) d\\alpha = -\\frac{0.0016}{3}\\alpha^3 + 0.024\\alpha^2 - 0.11\\alpha + C$$\n    使用初始条件 $\\phi(0) = C = 2/15$。\n    $$\\phi(2.5) = -\\frac{0.0016}{3}(2.5)^3 + 0.024(2.5)^2 - 0.11(2.5) + \\frac{2}{15}$$\n    使用分数，$\\alpha=5/2$：\n    $$\\phi(5/2) = -\\frac{0.0016}{3}\\left(\\frac{125}{8}\\right) + 0.024\\left(\\frac{25}{4}\\right) - 0.11\\left(\\frac{5}{2}\\right) + \\frac{2}{15}$$\n    $$\\phi(5/2) = -0.0002\\frac{125}{3} + 0.006(25) - 0.275 + \\frac{2}{15}$$\n    $$\\phi(5/2) = -\\frac{0.025}{3} + 0.15 - 0.275 + \\frac{2}{15} = -\\frac{1}{120} + \\frac{3}{20} - \\frac{11}{40} + \\frac{16}{120}$$\n    通分得到分母为120：\n    $$\\phi(5/2) = \\frac{-1 + 18 - 33 + 16}{120} = \\frac{34-34}{120} = 0$$\n    Armijo 条件是：\n    $$0 \\le \\frac{2}{15} - 0.000011(2.5) = \\frac{2}{15} - 0.0000275$$\n    由于 $\\frac{2}{15} \\approx 0.1333$，不等式 $0 \\le 0.1333 - 0.0000275$ 成立。\n\n步长 $\\alpha=2.5$ 满足这两个条件。这是一个精确、正的无量纲数。",
            "answer": "$$\\boxed{2.5}$$"
        },
        {
            "introduction": "在非线性分析中，一个重大的挑战是当切线刚度矩阵 $K$ 变为不定矩阵时，例如在结构失稳或屈曲点。在这些情况下，标准的牛顿方向可能不再是下降方向 $\\nabla \\phi(u^{k})^{\\top} p^{k}  0$，可能导致迭代发散。这个高级实践练习  演示了一种修正刚度矩阵以构造保证下降方向的基本技术，这是创建能够应对复杂能量形貌的稳健求解器的关键技能。",
            "id": "3577649",
            "problem": "考虑一个正在经历有限变形的非线性固体，其总势能用 $\\phi(u)$ 表示，其中 $u \\in \\mathbb{R}^{2}$ 代表节点位移向量。最小总势能原理指出，平衡构型使 $\\phi(u)$ 最小化，因此在平衡状态下，梯度 $\\nabla \\phi(u)$ 为零。在计算环境中，通过迭代更新 $u^{k+1} = u^{k} + s^{k}$ 来寻求满足 $\\nabla \\phi(u) = 0$ 的 $u$，其中 $s^{k} = \\alpha p^{k}$ 结合了搜索方向 $p^{k}$ 和线搜索步长 $\\alpha > 0$。如果 $\\nabla \\phi(u^{k})^{\\top} p^{k}  0$，则方向 $p^{k}$ 被称为下降方向，这是线搜索能够使 $\\phi$ 减小的一个充分局部条件，从而有助于收敛。\n\n在当前迭代点 $u^{k}$，设残差为 $r = \\nabla \\phi(u^{k})$，切线刚度（$\\phi$ 的海森矩阵）为 $K = \\nabla^{2} \\phi(u^{k})$。在表现出几何非线性或材料非凸性的问题中，$K$ 可能是无限定的。假设在 $u^{k}$ 处，有\n$$\nK = \\begin{pmatrix}\n2  1 \\\\\n1  -1\n\\end{pmatrix}, \\quad r = \\begin{pmatrix}\n1 \\\\\n2\n\\end{pmatrix},\n$$\n因此 $K$ 恰好有一个负特征值。\n\n从上述定义和下降方向必须满足 $\\nabla \\phi(u^{k})^{\\top} p^{k}  0$ 的基本原理出发，推导一种对 $K$ 中曲率信息的修正方法，该方法能产生一个保证在 $u^{k}$ 处下降的搜索方向 $p^{k}$。利用对称矩阵和二次型的性质来证明该修正的合理性，并确定您引入的任何辅助参数所需满足的条件，以确保保证成立。然后，使用您构造的 $p^{k}$，为选定的线搜索参数 $\\alpha = \\frac{1}{5}$ 计算更新步长 $s^{k} = \\alpha p^{k}$。将最终步长 $s^{k}$ 表示为一个 $1 \\times 2$ 的行矩阵。无需四舍五入；请提供精确值。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、良态（well-posed）且客观。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- 总势能是一个函数 $\\phi(u)$，其中 $u \\in \\mathbb{R}^{2}$ 是节点位移向量。\n- 平衡条件是 $\\nabla \\phi(u) = 0$。\n- 迭代更新方案是 $u^{k+1} = u^{k} + s^{k}$。\n- 更新步长是 $s^{k} = \\alpha p^{k}$，其中 $\\alpha > 0$ 是线搜索步长，$p^{k}$ 是搜索方向。\n- 下降方向 $p^{k}$ 必须满足条件 $\\nabla \\phi(u^{k})^{\\top} p^{k}  0$。\n- 在当前迭代点 $u^{k}$，残差为 $r = \\nabla \\phi(u^{k})$，切线刚度为 $K = \\nabla^{2} \\phi(u^{k})$。\n- 给定的数值是：\n$$\nK = \\begin{pmatrix}\n2  1 \\\\\n1  -1\n\\end{pmatrix}, \\quad r = \\begin{pmatrix}\n1 \\\\\n2\n\\end{pmatrix}\n$$\n- 题目说明 $K$ 恰好有一个负特征值，使其成为一个不定矩阵。\n- 指定的线搜索参数是 $\\alpha = \\frac{1}{5}$。\n- 最终结果 $s^{k}$ 应表示为一个 $1 \\times 2$ 的行矩阵，值为精确值。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：**该问题是计算固体力学中使用有限元法的一个标准情景。势能最小化、残余力（$r$）、切线刚度（$K$）、迭代求解器（如 Newton-Raphson）和线搜索策略等概念是该领域的基础。切线刚度矩阵 $K$ 变为不定的情况是一个众所周知的挑战，通常与结构失稳（例如，屈曲）或材料软化有关，需要对标准的 Newton-Raphson 算法进行修改。下降条件陈述正确。\n- **良态性：**该问题是良态的。它要求推导一种确保下降方向的方法，然后用给定的数据应用该方法。这是一个具有明确目标的构造性任务。让我们验证 $K$ 是不定的且有一个负特征值的说法。特征方程是 $\\det(K - \\lambda I) = 0$。\n$$\n\\det \\begin{pmatrix} 2-\\lambda  1 \\\\ 1  -1-\\lambda \\end{pmatrix} = (2-\\lambda)(-1-\\lambda) - (1)(1) = -2 - 2\\lambda + \\lambda + \\lambda^2 - 1 = \\lambda^2 - \\lambda - 3 = 0\n$$\n特征值由二次公式给出：\n$$\n\\lambda = \\frac{-(-1) \\pm \\sqrt{(-1)^2 - 4(1)(-3)}}{2(1)} = \\frac{1 \\pm \\sqrt{1 + 12}}{2} = \\frac{1 \\pm \\sqrt{13}}{2}\n$$\n两个特征值是 $\\lambda_1 = \\frac{1 + \\sqrt{13}}{2} > 0$ 和 $\\lambda_2 = \\frac{1 - \\sqrt{13}}{2}  0$，因为 $\\sqrt{13} > \\sqrt{9} = 3$。这证实了问题陈述中 $K$ 是不定的，且具有一个正特征值和一个负特征值的说法。\n- **客观性：**该问题以精确的数学语言陈述，没有主观性或偏见。\n- **完整性与一致性：**该问题提供了执行所需计算的所有必要数据（$K$、$r$、$\\alpha$）。所提供的信息中没有矛盾之处。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。我们可以继续进行求解。\n\n**求解推导**\n\n问题的核心在于找到一个能保证势能函数 $\\phi(u)$ 减小的搜索方向 $p^{k}$。如果 $p^{k}$ 是一个下降方向，即满足条件 $r^{\\top} p^{k}  0$，其中 $r = \\nabla \\phi(u^k)$，则可以确保这一点。\n\n在标准的 Newton-Raphson 方法中，搜索方向是通过求解线性系统 $K p^{k} = -r$ 得到的，即 $p^{k} = -K^{-1}r$。让我们检验这个选择的下降条件：\n$$\nr^{\\top} p^{k} = r^{\\top}(-K^{-1}r) = -r^{\\top}K^{-1}r\n$$\n为了使该值为负，二次型 $r^{\\top}K^{-1}r$ 必须为正。只有当矩阵 $K^{-1}$ 是正定的时，这才能得到保证，而这又要求切线刚度矩阵 $K$ 是正定的。然而，我们已经确定给定的 $K$ 是不定的。因此，标准的牛顿方向 $p^{k} = -K^{-1}r$ 可能不是一个下降方向，并可能导致迭代偏离最小值。\n\n为了保证下降，我们必须修改该系统。一种常用且稳健的技术是将切线刚度矩阵 $K$ 修改为一个新的矩阵 $\\tilde{K}$，并保证 $\\tilde{K}$ 是对称且正定的。然后通过求解修改后的系统来获得搜索方向 $p^k$：\n$$\n\\tilde{K} p^{k} = -r\n$$\n因此，搜索方向为 $p^{k} = -\\tilde{K}^{-1}r$。下降条件变为：\n$$\nr^{\\top} p^{k} = -r^{\\top}\\tilde{K}^{-1}r\n$$\n由于 $\\tilde{K}$ 被构造为正定矩阵，其逆矩阵 $\\tilde{K}^{-1}$ 也是正定的。根据正定矩阵的定义，对于任何非零向量 $x$，二次型 $x^{\\top}\\tilde{K}^{-1}x > 0$。只要我们没有达到平衡状态，残差 $r$ 就是非零的。因此，$r^{\\top}\\tilde{K}^{-1}r > 0$，这确保了 $r^{\\top} p^{k} = -r^{\\top}\\tilde{K}^{-1}r  0$。这证明了所得到的 $p^k$ 是一个下降方向。\n\n一种简单而有效的构造 $\\tilde{K}$ 的方法是谱移（spectral shift），也称为 Levenberg-Marquardt 修正：\n$$\n\\tilde{K} = K + \\delta I\n$$\n其中 $I$ 是单位矩阵，$\\delta$ 是一个非负标量。为了使 $\\tilde{K}$ 是正定的，其所有特征值必须严格为正。设 $\\{\\lambda_i\\}$ 是 $K$ 的特征值集合。那么 $\\tilde{K}$ 的特征值是 $\\{\\lambda_i + \\delta\\}$。因此，我们需要对所有的 $i$ 都有 $\\lambda_i + \\delta > 0$。这个条件等价于对所有的 $i$ 都有 $\\delta > -\\lambda_i$，这意味着 $\\delta$ 必须大于 $K$ 的最小特征值的相反数：\n$$\n\\delta > -\\lambda_{\\min}(K)\n$$\n我们已经计算出 $K$ 的特征值为 $\\lambda = \\frac{1 \\pm \\sqrt{13}}{2}$。最小特征值是 $\\lambda_{\\min} = \\frac{1 - \\sqrt{13}}{2}$。因此对 $\\delta$ 的条件是：\n$$\n\\delta > -\\left(\\frac{1 - \\sqrt{13}}{2}\\right) = \\frac{\\sqrt{13} - 1}{2}\n$$\n因为 $3  \\sqrt{13}  4$，我们有 $1  \\frac{\\sqrt{13}-1}{2}  1.5$。所以我们必须选择 $\\delta > \\frac{\\sqrt{13}-1}{2} \\approx 1.3028$。一个满足此条件的简单整数选择是 $\\delta=2$。\n\n让我们使用 $\\delta=2$ 来构造修正后的刚度矩阵 $\\tilde{K}$：\n$$\n\\tilde{K} = K + 2I = \\begin{pmatrix} 2  1 \\\\ 1  -1 \\end{pmatrix} + 2 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 4  1 \\\\ 1  1 \\end{pmatrix}\n$$\n现在我们求解系统 $\\tilde{K}p^{k} = -r$ 以得到搜索方向 $p^k$：\n$$\n\\begin{pmatrix} 4  1 \\\\ 1  1 \\end{pmatrix} p^{k} = - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -2 \\end{pmatrix}\n$$\n为了求解 $p^k$，我们首先求 $\\tilde{K}$ 的逆矩阵：\n$$\n\\det(\\tilde{K}) = (4)(1) - (1)(1) = 3\n$$\n$$\n\\tilde{K}^{-1} = \\frac{1}{3} \\begin{pmatrix} 1  -1 \\\\ -1  4 \\end{pmatrix}\n$$\n现在，我们可以计算 $p^{k}$：\n$$\np^{k} = \\tilde{K}^{-1}(-r) = \\frac{1}{3} \\begin{pmatrix} 1  -1 \\\\ -1  4 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ -2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} (1)(-1) + (-1)(-2) \\\\ (-1)(-1) + (4)(-2) \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} -1 + 2 \\\\ 1 - 8 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 1 \\\\ -7 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ -\\frac{7}{3} \\end{pmatrix}\n$$\n最后，我们使用给定的线搜索参数 $\\alpha = \\frac{1}{5}$ 计算更新步长 $s^{k} = \\alpha p^{k}$：\n$$\ns^{k} = \\frac{1}{5} p^{k} = \\frac{1}{5} \\begin{pmatrix} \\frac{1}{3} \\\\ -\\frac{7}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{15} \\\\ -\\frac{7}{15} \\end{pmatrix}\n$$\n题目要求答案以 $1 \\times 2$ 行矩阵的形式给出。这只是计算出的列向量的转置：\n$$\ns^{k} = \\begin{pmatrix} \\frac{1}{15}  -\\frac{7}{15} \\end{pmatrix}\n$$\n推导至此完成。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{15}  -\\frac{7}{15} \\end{pmatrix}}\n$$"
        }
    ]
}