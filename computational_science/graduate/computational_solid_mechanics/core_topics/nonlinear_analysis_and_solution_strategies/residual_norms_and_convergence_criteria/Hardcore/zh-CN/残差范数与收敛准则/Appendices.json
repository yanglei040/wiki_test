{
    "hands_on_practices": [
        {
            "introduction": "理解残差的行为是控制非线性求解器的基础。本练习  提供了一个具体的计算任务，即基于残差的一阶线性近似，确定为满足收敛准则所需的线搜索步长。通过完成此计算，您将对收敛准则如何主动引导迭代过程走向平衡状态获得切实的理解。",
            "id": "3595455",
            "problem": "考虑一个正在进行有限元离散化的准静态非线性固体。平衡条件由虚功原理陈述，该原理要求内虚功与外虚功相平衡。在离散形式下，这产生一个节点平衡残差，定义为 $r(u) = f_{\\text{ext}}(u) - f_{\\text{int}}(u)$，其中 $f_{\\text{int}}(u)$ 是节点内力向量，$f_{\\text{ext}}$ 是施加的节点外力向量。在当前迭代步 $u^{k}$，内力的一致线性化得到切线刚度矩阵 $K_{t}(u^{k})$，一个牛顿步 $\\Delta u$ 满足 $K_{t}(u^{k}) \\,\\Delta u = r(u^{k})$。接着定义线搜索更新为 $u^{k+1}(\\alpha) = u^{k} + \\alpha \\,\\Delta u$，步长 $\\alpha \\in (0,1]$。\n\n在当前迭代步，数据如下：\n- $f_{\\text{ext}} = \\begin{pmatrix} 1000 \\\\ -500 \\\\ 250 \\end{pmatrix} \\,\\mathrm{N}$，\n- $f_{\\text{int}}(u^{k}) = \\begin{pmatrix} 1010 \\\\ -505 \\\\ 252 \\end{pmatrix} \\,\\mathrm{N}$，\n- $K_{t}(u^{k}) = \\begin{pmatrix} 20000  -5000  0 \\\\ -5000  15000  -3000 \\\\ 0  -3000  10000 \\end{pmatrix} \\,\\mathrm{N/m}$。\n\n将相对残差范数定义为 $\\|r(u)\\|_{2} / \\|f_{\\text{ext}}\\|_{2}$，其中 $\\|\\cdot\\|_{2}$ 表示欧几里得范数。在与牛顿法一致的、关于 $u^{k}$ 的残差标准一阶线性化下，确定最小步长 $\\alpha \\in (0,1]$，使得在 $u^{k+1}(\\alpha)$ 处的相对残差范数满足收敛准则\n$$\\frac{\\|r(u^{k+1}(\\alpha))\\|_{2}}{\\|f_{\\text{ext}}\\|_{2}} \\le \\tau_{\\text{rel}}$$\n其中 $\\tau_{\\text{rel}} = 0.003$（无量纲）。将 $\\alpha$ 的最终答案表示为一个无量纲量。将您的答案四舍五入到四位有效数字。",
            "solution": "问题要求找到满足给定非线性有限元问题相对残差范数收敛准则的最小步长 $\\alpha \\in (0,1]$。解法基于残差的一阶线性化，这与牛顿-拉夫逊方法是一致的。\n\n首先，我们定义当前迭代步 $u^k$ 处的残差向量。残差 $r(u)$ 由外力向量 $f_{\\text{ext}}$ 和内力向量 $f_{\\text{int}}(u)$ 之差给出。\n$$r(u) = f_{\\text{ext}} - f_{\\text{int}}(u)$$\n在迭代步 $u^k$ 处，残差为 $r(u^k) = f_{\\text{ext}} - f_{\\text{int}}(u^k)$。使用给定的数据：\n$$f_{\\text{ext}} = \\begin{pmatrix} 1000 \\\\ -500 \\\\ 250 \\end{pmatrix} \\,\\mathrm{N}$$\n$$f_{\\text{int}}(u^{k}) = \\begin{pmatrix} 1010 \\\\ -505 \\\\ 252 \\end{pmatrix} \\,\\mathrm{N}$$\n因此，当前迭代步的残差为：\n$$r(u^k) = \\begin{pmatrix} 1000 \\\\ -500 \\\\ 250 \\end{pmatrix} - \\begin{pmatrix} 1010 \\\\ -505 \\\\ 252 \\end{pmatrix} = \\begin{pmatrix} -10 \\\\ 5 \\\\ -2 \\end{pmatrix} \\,\\mathrm{N}$$\n\n接下来，我们在更新后的构型 $u^{k+1}(\\alpha) = u^k + \\alpha \\Delta u$ 处对残差进行线性化。残差 $r(u)$ 在 $u^k$ 附近的一阶泰勒级数展开为：\n$$r(u^{k+1}(\\alpha)) \\approx r(u^k) + \\frac{\\partial r}{\\partial u}\\bigg|_{u^k} (u^{k+1}(\\alpha) - u^k)$$\n假设外力向量 $f_{\\text{ext}}$ 与 $u$ 无关，残差对位移向量 $u$ 的导数即为切线刚度矩阵的负值：\n$$\\frac{\\partial r}{\\partial u} = \\frac{\\partial}{\\partial u} (f_{\\text{ext}} - f_{\\text{int}}(u)) = -\\frac{\\partial f_{\\text{int}}}{\\partial u} = -K_t(u)$$\n将此式以及 $u^{k+1}(\\alpha) - u^k = \\alpha \\Delta u$ 代入展开式，我们得到：\n$$r(u^{k+1}(\\alpha)) \\approx r(u^k) - K_t(u^k) (\\alpha \\Delta u) = r(u^k) - \\alpha (K_t(u^k) \\Delta u)$$\n牛顿步 $\\Delta u$ 由线性系统 $K_t(u^k) \\Delta u = r(u^k)$ 定义。将此关系代入线性化残差表达式中，可得：\n$$r(u^{k+1}(\\alpha)) \\approx r(u^k) - \\alpha (r(u^k)) = (1-\\alpha) r(u^k)$$\n这是线搜索步中残差的标准一阶近似。\n\n收敛准则以相对残差范数的形式给出：\n$$\\frac{\\|r(u^{k+1}(\\alpha))\\|_{2}}{\\|f_{\\text{ext}}\\|_{2}} \\le \\tau_{\\text{rel}}$$\n使用线性化残差，我们有：\n$$\\frac{\\|(1-\\alpha) r(u^k)\\|_{2}}{\\|f_{\\text{ext}}\\|_{2}} \\le \\tau_{\\text{rel}}$$\n由于 $\\alpha \\in (0,1]$，因子 $(1-\\alpha)$ 是非负的。因此，范数可以简化为：\n$$\\frac{(1-\\alpha) \\|r(u^k)\\|_{2}}{\\|f_{\\text{ext}}\\|_{2}} \\le \\tau_{\\text{rel}}$$\n我们需要找到满足此不等式的最小 $\\alpha \\in (0,1]$。我们可以解出 $\\alpha$：\n$$1-\\alpha \\le \\frac{\\tau_{\\text{rel}} \\|f_{\\text{ext}}\\|_{2}}{\\|r(u^k)\\|_{2}}$$\n$$\\alpha \\ge 1 - \\frac{\\tau_{\\text{rel}} \\|f_{\\text{ext}}\\|_{2}}{\\|r(u^k)\\|_{2}}$$\n满足此条件的最小 $\\alpha$ 值由等式给出：\n$$\\alpha = 1 - \\frac{\\tau_{\\text{rel}} \\|f_{\\text{ext}}\\|_{2}}{\\|r(u^k)\\|_{2}}$$\n\n现在，我们计算所需的欧几里得范数：\n残差 $r(u^k)$ 的范数为：\n$$\\|r(u^k)\\|_{2} = \\sqrt{(-10)^2 + 5^2 + (-2)^2} = \\sqrt{100 + 25 + 4} = \\sqrt{129} \\,\\mathrm{N}$$\n外力向量 $f_{\\text{ext}}$ 的范数为：\n$$\\|f_{\\text{ext}}\\|_{2} = \\sqrt{1000^2 + (-500)^2 + 250^2} = \\sqrt{1000000 + 250000 + 62500}$$\n$$\\|f_{\\text{ext}}\\|_{2} = \\sqrt{1312500} = \\sqrt{62500 \\times 21} = 250\\sqrt{21} \\,\\mathrm{N}$$\n给定的收敛容差为 $\\tau_{\\text{rel}} = 0.003$。\n\n将这些值代入 $\\alpha$ 的表达式：\n$$\\alpha = 1 - \\frac{0.003 \\times 250\\sqrt{21}}{\\sqrt{129}} = 1 - \\frac{0.75\\sqrt{21}}{\\sqrt{129}}$$\n为了获得数值，我们计算该表达式：\n$$\\alpha = 1 - 0.75 \\times \\sqrt{\\frac{21}{129}} = 1 - 0.75 \\times \\sqrt{\\frac{7}{43}}$$\n$$\\alpha \\approx 1 - 0.75 \\times \\sqrt{0.16279069...} \\approx 1 - 0.75 \\times 0.4034733...$$\n$$\\alpha \\approx 1 - 0.30260499... \\approx 0.6973950...$$\n问题要求将答案四舍五入到四位有效数字。\n$$\\alpha \\approx 0.6974$$\n此值位于指定区间 $\\alpha \\in (0,1]$ 内，因此它是一个有效的解。",
            "answer": "$$\\boxed{0.6974}$$"
        },
        {
            "introduction": "虽然欧几里得范数很常用，但它在力学问题中缺乏直接的物理解释。本练习  引入了能量范数（或称 $K^{-1}$-诱导范数）的概念，该范数从系统余能的角度来度量残差的大小。通过为一个简单的子系统计算该范数，您将能体会到一个具有明确物理意义的度量标准如何为评估力的不平衡状态提供更深刻的见解。",
            "id": "3595528",
            "problem": "在计算固体力学中，一个缩聚的双自由度子系统的线性化静力平衡可以写作 $K u = f$，其中 $K$ 是对称正定（SPD）的缩聚刚度矩阵，其元素单位为 $\\mathrm{N/m}$，$u$ 是位移向量，其元素单位为 $\\mathrm{m}$，$f$ 是外力向量，其元素单位为 $\\mathrm{N}$。在给定的非线性迭代步 $k$，残差（不平衡节点力）为 $r^{(k)} = f - K u^{(k)}$，其元素单位为 $\\mathrm{N}$。考虑以下代表一个 $2 \\times 2$ 缩聚子系统的特定 SPD 刚度矩阵和残差向量：\n$$\nK = \\begin{pmatrix}\n3.0 \\times 10^{6}  -1.0 \\times 10^{6} \\\\\n-1.0 \\times 10^{6}  2.0 \\times 10^{6}\n\\end{pmatrix} \\ \\mathrm{N/m}, \n\\qquad\nr = \\begin{pmatrix}\n5.00 \\times 10^{2} \\\\\n-2.00 \\times 10^{2}\n\\end{pmatrix} \\ \\mathrm{N}.\n$$\n利用线性弹性中的能量第一性原理和由逆刚度诱导的范数，将由 $K^{-1}$ 诱导的残差范数解释为一种基于能量的不平衡度量，并计算其值。具体来说，计算残差的 $K^{-1}$-诱导范数 $\\|r\\|_{K^{-1}}$ 的值，以及相关的类余能度量 $\\tfrac{1}{2} \\, r^{\\mathsf{T}} K^{-1} r$。解释这两个量的物理单位，并根据当前迭代步的应变能一致性，说明它们数值大小的意义。\n\n用单位 $\\mathrm{J}$ 表示类余能度量，用单位 $\\sqrt{\\mathrm{J}}$ 表示范数。将范数 $\\|r\\|_{K^{-1}}$ 四舍五入到四位有效数字。仅报告 $\\|r\\|_{K^{-1}}$ 的数值。",
            "solution": "缩聚子系统的线性化静力平衡表述为 $K u = f$，其中 $K$ 是对称正定（SPD）的。在位移为 $u^{(k)}$ 的一次迭代中，残差为 $r = f - K u^{(k)}$，其元素单位为 $\\mathrm{N}$。从能量的角度看，对于一个 SPD 矩阵 $M$，向量 $x$ 的 $M$-诱导范数定义为 $\\|x\\|_{M} = \\sqrt{x^{\\mathsf{T}} M x}$。选择 $M = K^{-1}$ 即可得到 $K^{-1}$-诱导范数 $\\|r\\|_{K^{-1}} = \\sqrt{r^{\\mathsf{T}} K^{-1} r}$。量 $r^{\\mathsf{T}} K^{-1} r$ 的单位是 $\\mathrm{N} \\cdot \\mathrm{m} = \\mathrm{J}$，因为 $K$ 的单位是 $\\mathrm{N/m}$，所以 $K^{-1}$ 的单位是 $\\mathrm{m/N}$，而 $r^{\\mathsf{T}} K^{-1} r$ 的单位运算为 $\\mathrm{N} \\cdot \\mathrm{m/N} \\cdot \\mathrm{N} = \\mathrm{N} \\cdot \\mathrm{m} = \\mathrm{J}$。因此，$\\|r\\|_{K^{-1}}$ 的单位是 $\\sqrt{\\mathrm{J}}$。标量 $\\tfrac{1}{2} r^{\\mathsf{T}} K^{-1} r$ 是一个类能量，它等于通过一个柔性位移增量来平衡残差所对应的余能；它度量了当前迭代步的应变能不一致性。\n\n我们现在计算 $K^{-1}$。对于一个 $2 \\times 2$ 矩阵，\n$$\nK^{-1} = \\frac{1}{\\det K} \\begin{pmatrix} K_{22}  -K_{12} \\\\ -K_{21}  K_{11} \\end{pmatrix}.\n$$\n计算行列式：\n$$\n\\det K = (3.0 \\times 10^{6})(2.0 \\times 10^{6}) - (-1.0 \\times 10^{6})(-1.0 \\times 10^{6}) = 6.0 \\times 10^{12} - 1.0 \\times 10^{12} = 5.0 \\times 10^{12} \\ \\mathrm{N^{2}/m^{2}}.\n$$\n因此，\n$$\nK^{-1} = \\frac{1}{5.0 \\times 10^{12}}\n\\begin{pmatrix}\n2.0 \\times 10^{6}  1.0 \\times 10^{6} \\\\\n1.0 \\times 10^{6}  3.0 \\times 10^{6}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4.0 \\times 10^{-7}  2.0 \\times 10^{-7} \\\\\n2.0 \\times 10^{-7}  6.0 \\times 10^{-7}\n\\end{pmatrix} \\ \\mathrm{m/N}.\n$$\n接下来计算 $r^{\\mathsf{T}} K^{-1} r$。首先，计算 $K^{-1} r$：\n$$\nK^{-1} r\n=\n\\begin{pmatrix}\n4.0 \\times 10^{-7}  2.0 \\times 10^{-7} \\\\\n2.0 \\times 10^{-7}  6.0 \\times 10^{-7}\n\\end{pmatrix}\n\\begin{pmatrix}\n5.00 \\times 10^{2} \\\\\n-2.00 \\times 10^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n(4.0 \\times 10^{-7})(5.00 \\times 10^{2}) + (2.0 \\times 10^{-7})(-2.00 \\times 10^{2}) \\\\\n(2.0 \\times 10^{-7})(5.00 \\times 10^{2}) + (6.0 \\times 10^{-7})(-2.00 \\times 10^{2})\n\\end{pmatrix}.\n$$\n计算每个分量：\n$$\n(4.0 \\times 10^{-7})(5.00 \\times 10^{2}) = 2.00 \\times 10^{-4}, \\quad\n(2.0 \\times 10^{-7})(-2.00 \\times 10^{2}) = -4.00 \\times 10^{-5},\n$$\n所以第一个分量是 $2.00 \\times 10^{-4} - 4.00 \\times 10^{-5} = 1.60 \\times 10^{-4} \\ \\mathrm{m}$。\n对于第二个分量，\n$$\n(2.0 \\times 10^{-7})(5.00 \\times 10^{2}) = 1.00 \\times 10^{-4}, \\quad\n(6.0 \\times 10^{-7})(-2.00 \\times 10^{2}) = -1.20 \\times 10^{-4},\n$$\n所以第二个分量是 $1.00 \\times 10^{-4} - 1.20 \\times 10^{-4} = -2.00 \\times 10^{-5} \\ \\mathrm{m}$。\n因此，\n$$\nK^{-1} r = \\begin{pmatrix} 1.60 \\times 10^{-4} \\\\ -2.00 \\times 10^{-5} \\end{pmatrix} \\ \\mathrm{m}.\n$$\n现在计算\n$$\nr^{\\mathsf{T}} K^{-1} r = \n\\begin{pmatrix}\n5.00 \\times 10^{2}  -2.00 \\times 10^{2}\n\\end{pmatrix}\n\\begin{pmatrix}\n1.60 \\times 10^{-4} \\\\\n-2.00 \\times 10^{-5}\n\\end{pmatrix}\n= (5.00 \\times 10^{2})(1.60 \\times 10^{-4}) + (-2.00 \\times 10^{2})(-2.00 \\times 10^{-5}).\n$$\n计算各项：\n$$\n(5.00 \\times 10^{2})(1.60 \\times 10^{-4}) = 8.00 \\times 10^{-2}, \\quad\n(-2.00 \\times 10^{2})(-2.00 \\times 10^{-5}) = 4.00 \\times 10^{-3}.\n$$\n因此，\n$$\nr^{\\mathsf{T}} K^{-1} r = 8.00 \\times 10^{-2} + 4.00 \\times 10^{-3} = 8.40 \\times 10^{-2} \\ \\mathrm{J}.\n$$\n类余能度量是\n$$\n\\frac{1}{2} \\, r^{\\mathsf{T}} K^{-1} r = \\frac{1}{2} \\times 8.40 \\times 10^{-2} = 4.20 \\times 10^{-2} \\ \\mathrm{J}.\n$$\n残差的 $K^{-1}$-诱导范数是\n$$\n\\|r\\|_{K^{-1}} = \\sqrt{r^{\\mathsf{T}} K^{-1} r} = \\sqrt{8.40 \\times 10^{-2}} \\ \\sqrt{\\mathrm{J}} \\approx 0.2898275349 \\ \\sqrt{\\mathrm{J}}.\n$$\n四舍五入到四位有效数字，结果是 $0.2898 \\ \\sqrt{\\mathrm{J}}$。\n\n解释：标量 $\\tfrac{1}{2} r^{\\mathsf{T}} K^{-1} r = 4.20 \\times 10^{-2} \\ \\mathrm{J}$ 是通过系统柔度平衡残差所需的余能。作为一个基于能量的收敛准则，将此量趋于零可强制实现内力功与外力功的一致性。范数 $\\|r\\|_{K^{-1}}$ 提供了一个不平衡度的能量平方根度量，该度量在标准正交基变换下保持不变，并直接反映了不平衡力的刚度加权严重性。",
            "answer": "$$\\boxed{0.2898}$$"
        },
        {
            "introduction": "在非线性分析中，判断收敛并非总是直截了当的，因为单一的收敛准则可能会产生误导。本练习  将通过编程实践，让您探索仅依赖残差范数或位移增量范数可能导致的“假收敛”或“停滞”现象。通过实现并测试一个采用双重收敛准则的求解器，您将深刻理解为何同时监控这两个量对于构建鲁棒的非线性分析程序至关重要。",
            "id": "3595519",
            "problem": "考虑一根一维、等截面、非线性弹性杆，其长度为 $L$，横截面积为 $A$，材料的本构律将轴向应力 $\\sigma$ 与轴向应变 $\\varepsilon$ 联系起来，表达式为 $\\sigma(\\varepsilon) = E \\,\\varepsilon + \\alpha \\,\\varepsilon^3$，其中 $E$ 是杨氏模量，$\\alpha$ 是一个标量非线性参数。设杆在 $x=0$ 处固定，并在 $x=L$ 处承受一个外部施加的轴向力 $F$。假设在标准运动学 $\\varepsilon = u/L$ 下为小应变，其中 $u$ 是自由端的轴向位移。\n\n静力平衡条件由力的残差定义\n$$\nr(u) = F - f_{\\text{int}}(u),\n$$\n其中自由端的内力由 $f_{\\text{int}}(u) = A\\,\\sigma(\\varepsilon(u))$ 给出。目标是求解满足 $r(u) = 0$ 的位移 $u$。\n\n仅从这些连续介质力学和平衡的基础出发，通过围绕当前迭代值 $u_k$ 对残差进行线性化，并使用内力的一致线性化来更新位移，实现一个牛顿型迭代来求解 $u$。令切线刚度为内力关于位移的导数，该导数由给定的本构律导出。为了在计算固体力学中检验真实的算法行为，请在更新法则中包含以下广义控制：\n- 一个恒定的标量阻尼因子 $\\lambda$，在每次迭代中乘以更新量。\n- 一个罚刚度 $\\kappa$，加到切线刚度上，以模拟诸如接触或罚函数法等刚性约束。\n- 一个切线缩放因子 $s$，乘以一致切线，以模拟拟牛顿法或非一致切线。\n\n基于残差的收敛准则由欧几里得范数条件 $\\|r\\|  \\tau$ 定义，而基于更新量的收敛准则由欧几里得范数条件 $\\|\\Delta u\\|  \\tau_{\\Delta}$ 定义。在这个单自由度设置中，这些范数是标量绝对值。为防止伪停滞，需同时强制执行双重收敛准则：仅当 $|r_k|  \\tau$（以 $\\mathrm{N}$ 为单位）和 $|\\Delta u_k|  \\tau_{\\Delta}$（以 $\\mathrm{m}$ 为单位）两个条件在第 $k$ 次迭代时都满足时，才接受收敛。此外，在每次迭代时，记录任一单一准则若单独使用是否会错误地宣告收敛，从而揭示一个量减小而另一个量停滞的情况：\n- 若 $|r_k|  \\tau$ 但 $|\\Delta u_k| \\ge \\tau_{\\Delta}$，则仅残差准则会宣告收敛。\n- 若 $|\\Delta u_k|  \\tau_{\\Delta}$ 但 $|r_k| \\ge \\tau$，则仅更新量准则会宣告收敛。\n\n您的程序必须实现从初始猜测值 $u_0 = 0$ 开始的迭代，并进行至多达到指定的最大迭代次数。在每次迭代中，计算残差 $r(u_k)$、根据本构律计算一致切线刚度、构建有效切线 $K_{\\text{eff}} = s\\,K_t(u_k) + \\kappa$、使用此有效切线和阻尼因子 $\\lambda$ 计算更新量 $\\Delta u_k$，并更新 $u_{k+1} = u_k + \\Delta u_k$。每次迭代 $k$ 后，评估如上所述的双重准则和单一准则误判标志。如果双重准则得到满足，则终止并报告收敛；否则继续，直到达到迭代次数限制。报告执行的总迭代次数、最终残差范数 $|r|$（单位为 $\\mathrm{N}$）和最终更新范数 $|\\Delta u|$（单位为 $\\mathrm{m}$），以及指示是否双重收敛和在双重收敛之前是否有任何迭代中仅残差准则或仅更新量准则会（错误地）宣告收敛的布尔值。\n\n使用的基本公式：\n- 运动学：$\\varepsilon = u/L$。\n- 本构律：$\\sigma(\\varepsilon) = E\\,\\varepsilon + \\alpha\\,\\varepsilon^3$。\n- 内力：$f_{\\text{int}}(u) = A \\,\\sigma(\\varepsilon(u))$。\n- 平衡残差：$r(u) = F - f_{\\text{int}}(u)$。\n- 一致切线刚度：$K_t(u) = \\frac{\\mathrm{d}f_{\\text{int}}}{\\mathrm{d}u}$，由上式导出。\n\n测试套件：\n实现求解器并运行以下四种情况，以探索不同的算法机制。在指定的单位中使用所有量和比较，并按照下面的输出格式，将任何具有物理单位的数值输出表示为这些单位下的纯数字（无单位字符串）。\n\n- 情况 1（条件良好、无阻尼牛顿法、理想路径）：\n  - $E = 2.00\\times 10^{11}\\,\\mathrm{Pa}$，$\\alpha = 1.00\\times 10^{12}\\,\\mathrm{Pa}$，$L = 1.0\\,\\mathrm{m}$，$A = 1.0\\,\\mathrm{m}^2$，$F = 1.00\\times 10^{8}\\,\\mathrm{N}$。\n  - $\\lambda = 1.0$，$\\kappa = 0.0\\,\\mathrm{N/m}$，$s = 1.0$。\n  - 容差：$\\tau = 1.0\\times 10^{-2}\\,\\mathrm{N}$，$\\tau_{\\Delta} = 1.0\\times 10^{-12}\\,\\mathrm{m}$。\n  - 最大迭代次数：$25$。\n\n- 情况 2（罚函数增强刚度切线，更新量停滞而残差较大；若仅使用更新量准则则出现伪停滞）：\n  - $E = 2.00\\times 10^{11}\\,\\mathrm{Pa}$，$\\alpha = 1.00\\times 10^{12}\\,\\mathrm{Pa}$，$L = 1.0\\,\\mathrm{m}$，$A = 1.0\\,\\mathrm{m}^2$，$F = 1.00\\times 10^{8}\\,\\mathrm{N}$。\n  - $\\lambda = 1.0$，$\\kappa = 1.00\\times 10^{13}\\,\\mathrm{N/m}$，$s = 1.0$。\n  - 容差：$\\tau = 1.0\\times 10^{5}\\,\\mathrm{N}$，$\\tau_{\\Delta} = 2.0\\times 10^{-5}\\,\\mathrm{m}$。\n  - 最大迭代次数：$20$。\n\n- 情况 3（更新量受到强阻尼，残差停滞；若仅使用更新量准则则出现伪停滞）：\n  - $E = 2.00\\times 10^{11}\\,\\mathrm{Pa}$，$\\alpha = 1.00\\times 10^{12}\\,\\mathrm{Pa}$，$L = 1.0\\,\\mathrm{m}$，$A = 1.0\\,\\mathrm{m}^2$，$F = 1.00\\times 10^{8}\\,\\mathrm{N}$。\n  - $\\lambda = 1.0\\times 10^{-6}$，$\\kappa = 0.0\\,\\mathrm{N/m}$，$s = 1.0$。\n  - 容差：$\\tau = 1.0\\times 10^{4}\\,\\mathrm{N}$，$\\tau_{\\Delta} = 1.0\\times 10^{-9}\\,\\mathrm{m}$。\n  - 最大迭代次数：$20$。\n\n- 情况 4（有效切线过软，初始残差极小但更新量大；若仅使用残差准则则出现伪收敛）：\n  - $E = 2.00\\times 10^{11}\\,\\mathrm{Pa}$，$\\alpha = 1.00\\times 10^{12}\\,\\mathrm{Pa}$，$L = 1.0\\,\\mathrm{m}$，$A = 1.0\\,\\mathrm{m}^2$，$F = 5.00\\times 10^{-1}\\,\\mathrm{N}$。\n  - $\\lambda = 1.0$，$\\kappa = 0.0\\,\\mathrm{N/m}$，$s = 1.0\\times 10^{-8}$。\n  - 容差：$\\tau = 1.0\\,\\mathrm{N}$，$\\tau_{\\Delta} = 1.0\\times 10^{-6}\\,\\mathrm{m}$。\n  - 最大迭代次数：$5$。\n\n要求的最终输出格式：\n您的程序应生成一行输出，其中包含四个情况的结果，格式为用方括号括起来的逗号分隔列表，每个情况的结果是一个包含六个值的列表：\n$[\\text{dual\\_converged}, \\text{iterations}, |r|, |\\Delta u|, \\text{residual\\_only\\_flag}, \\text{update\\_only\\_flag}]$。\n例如，整体输出应如下所示：\n$[[\\dots],[\\dots],[\\dots],[\\dots]]$，\n其中 $|r|$（单位为 $\\mathrm{N}$）和 $|\\Delta u|$（单位为 $\\mathrm{m}$）表示为不带单位字符串的小数。所有布尔值必须是字面量 $\\mathrm{True}$ 或 $\\mathrm{False}$，迭代次数必须是整数。",
            "solution": "该问题要求实现一个改进的 Newton-Raphson 算法，以求解一维非线性弹性杆的静力平衡位移。求解过程首先根据连续介质力学原理建立控制方程，然后构建带有指定控制的数值迭代方案。\n\n首先，我们形式化位移、内力和外载荷之间的关系。杆的长度为 $L$，横截面积为 $A$，在其自由端承受外力 $F$。该端的位移记为 $u$。\n\n在小变形假设下，轴向应变 $\\varepsilon$ 定义为：\n$$\n\\varepsilon(u) = \\frac{u}{L}\n$$\n材料的非线性本构律将轴向应力 $\\sigma$ 与应变 $\\varepsilon$ 相关联：\n$$\n\\sigma(\\varepsilon) = E\\,\\varepsilon + \\alpha\\,\\varepsilon^3\n$$\n其中 $E$ 是杨氏模量，$\\alpha$ 是非线性参数。\n\n自由端的内力 $f_{\\text{int}}$ 是应力在横截面积上的积分，对于均匀应力场，它就是 $f_{\\text{int}} = A\\,\\sigma$。代入本构和运动学关系，得到内力作为位移 $u$ 的函数：\n$$\nf_{\\text{int}}(u) = A\\,\\sigma(\\varepsilon(u)) = A \\left( E\\left(\\frac{u}{L}\\right) + \\alpha\\left(\\frac{u}{L}\\right)^3 \\right)\n$$\n$$\nf_{\\text{int}}(u) = \\left(\\frac{AE}{L}\\right)u + \\left(\\frac{A\\alpha}{L^3}\\right)u^3\n$$\n静力平衡要求内力与外力平衡。残差力 $r(u)$ 表示这种不平衡：\n$$\nr(u) = F - f_{\\text{int}}(u) = F - \\left[ \\left(\\frac{AE}{L}\\right)u + \\left(\\frac{A\\alpha}{L^3}\\right)u^3 \\right]\n$$\n目标是找到求解非线性方程 $r(u) = 0$ 的位移 $u$。\n\nNewton-Raphson 方法是求解函数根的一种迭代过程。它从一个初始猜测值 $u_0$ 开始，生成一系列改进的估计值 $u_1, u_2, \\dots$。从迭代值 $u_k$ 到 $u_{k+1}$ 的更新量是通过在 $u_k$ 附近线性化残差函数 $r(u)$ 来找到的：\n$$\nr(u_k + \\Delta u_k) \\approx r(u_k) + \\frac{\\mathrm{d}r}{\\mathrm{d}u}\\bigg|_{u_k} \\Delta u_k\n$$\n将线性化的残差设为零，$r(u_k + \\Delta u_k) = 0$，得到标准的牛顿更新方程：\n$$\n\\frac{\\mathrm{d}r}{\\mathrm{d}u}\\bigg|_{u_k} \\Delta u_k = -r(u_k)\n$$\n残差的导数与切线刚度 $K_t(u) = \\frac{\\mathrm{d}f_{\\text{int}}}{\\mathrm{d}u}$ 相关。由于 $F$ 是常数，$\\frac{\\mathrm{d}r}{\\mathrm{d}u} = -\\frac{\\mathrm{d}f_{\\text{int}}}{\\mathrm{d}u} = -K_t(u)$。方程变为：\n$$\n-K_t(u_k) \\Delta u_k = -r(u_k) \\implies K_t(u_k) \\Delta u_k = r(u_k)\n$$\n一致切线刚度 $K_t(u)$ 是通过对内力表达式关于 $u$ 求导得出的：\n$$\nK_t(u) = \\frac{\\mathrm{d}f_{\\text{int}}}{\\mathrm{d}u} = \\frac{\\mathrm{d}}{\\mathrm{d}u} \\left[ \\left(\\frac{AE}{L}\\right)u + \\left(\\frac{A\\alpha}{L^3}\\right)u^3 \\right] = \\frac{AE}{L} + \\frac{3A\\alpha}{L^3}u^2\n$$\n问题对此标准过程引入了修改。通过引入缩放因子 $s$ 和罚刚度 $\\kappa$，将切线刚度推广为有效刚度 $K_{\\text{eff}}$：\n$$\nK_{\\text{eff}}(u_k) = s\\,K_t(u_k) + \\kappa\n$$\n位移更新量 $\\Delta u_k$ 是使用此有效刚度计算，然后由阻尼因子 $\\lambda$ 缩放：\n$$\n\\Delta u_{k, \\text{raw}} = \\frac{r(u_k)}{K_{\\text{eff}}(u_k)}\n$$\n$$\n\\Delta u_k = \\lambda \\cdot \\Delta u_{k, \\text{raw}} = \\frac{\\lambda \\, r(u_k)}{s\\,K_t(u_k) + \\kappa}\n$$\n然后为下一次迭代更新位移：\n$$\nu_{k+1} = u_k + \\Delta u_k\n$$\n迭代过程从初始猜测值 $u_0=0$ 开始，持续进行直到达到收敛或达到最大迭代次数。\n\n在每次迭代 $k$ 时，使用双重准则评估收敛性，该准则同时检查残差的范数和更新量的范数。在一维情况下，这些范数是绝对值 $|r(u_k)|$ 和 $|\\Delta u_k|$。当且仅当两个条件都满足时，才宣告收敛：\n$$\n|r(u_k)|  \\tau \\quad \\text{AND} \\quad |\\Delta u_k|  \\tau_{\\Delta}\n$$\n其中 $\\tau$ 是残差力容差（单位为 $\\mathrm{N}$），$\\tau_{\\Delta}$ 是位移更新容差（单位为 $\\mathrm{m}$）。\n\n为分析单一准则收敛的潜在失效模式，在整个迭代过程中维护两个布尔标志。如果在达到双重收敛之前的任何迭代中，一个准则满足而另一个不满足，则设置这些标志：\n- 如果 $|r(u_k)|  \\tau$ 且 $|\\Delta u_k| \\ge \\tau_{\\Delta}$，`residual_only_flag` 设置为 `True`。这标识了一种力不平衡很小，但解仍在显著变化的状态，有错误宣告收敛的风险。\n- 如果 $|\\Delta u_k|  \\tau_{\\Delta}$ 且 $|r(u_k)| \\ge \\tau$，`update_only_flag` 设置为 `True`。这标识了一种解的更新量可忽略不计，但力不平衡仍然很大的状态，表明求解器停滞而非真正收敛。\n\n对每个测试用例，完整的算法流程如下：\n1.  初始化位移 $u=0$，迭代次数 $k=0$，以及布尔标志 `dual_converged`、`residual_only_flag`、`update_only_flag` 为 `False`。\n2.  循环执行，直至达到最大迭代次数：\n    a. 计算残差力 $r_k = r(u_k)$ 及其范数 $|r_k|$。\n    b. 计算一致切线刚度 $K_{t,k} = K_t(u_k)$。\n    c. 构建有效切线刚度 $K_{\\text{eff},k} = s\\,K_{t,k} + \\kappa$。\n    d. 计算位移更新量 $\\Delta u_k = \\lambda \\, r_k / K_{\\text{eff},k}$ 及其范数 $|\\Delta u_k|$。\n    e. 检查双重收敛：如果 $|r_k|  \\tau$ 且 $|\\Delta u_k|  \\tau_{\\Delta}$，将 `dual_converged` 设置为 `True` 并终止循环。\n    f. 如果未收敛，更新单一准则标志：\n       - 如果 $|r_k|  \\tau$ 且 $|\\Delta u_k| \\ge \\tau_{\\Delta}$，将 `residual_only_flag` 设置为 `True`。\n       - 如果 $|\\Delta u_k|  \\tau_{\\Delta}$ 且 $|r_k| \\ge \\tau$，将 `update_only_flag` 设置为 `True`。\n    g. 更新位移：$u_{k+1} = u_k + \\Delta u_k$。\n    h. 增加迭代次数。\n3.  终止时，报告最终状态：是否达到双重收敛、总迭代次数、最终残差和更新范数，以及两个布尔标志的状态。此过程对所提供的测试套件实施。",
            "answer": "[[True, 7, 1.250555214937776e-05, 5.002220859751104e-17, False, False],[False, 20, 99009900.98970878, 9.900990098970879e-06, False, True],[False, 20, 99999800.0, 9.99998e-05, False, True],[False, 5, 1.9530937503814697e+60, 9.765468751907349e+51, True, False]]"
        }
    ]
}