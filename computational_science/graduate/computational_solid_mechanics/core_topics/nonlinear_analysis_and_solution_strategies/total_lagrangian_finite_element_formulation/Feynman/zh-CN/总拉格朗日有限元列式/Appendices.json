{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个实践练习将重点关注全拉格朗日（TL）列式法的核心运动学。我们将通过一个具体的六面体单元，计算其内部一点的变形梯度（$F$）和格林-拉格朗日应变（$E$）。这个练习旨在强化节点位移、形函数与连续介质应变量之间的联系，并突显雅可比矩阵在将母单元空间导数映射到参考构形中的关键作用。",
            "id": "3607557",
            "problem": "考虑在有限元法（FEM）的全拉格朗日（TL）描述中，一个三维、八节点三线性六面体有限元。该单元占据参考构型，其节点位置由下式给出\n- 节点 $1$：$(X,Y,Z) = (0,0,0)$，\n- 节点 $2$：$(X,Y,Z) = (2,0,0)$，\n- 节点 $3$：$(X,Y,Z) = (2,1,0)$，\n- 节点 $4$：$(X,Y,Z) = (0,1,0)$，\n- 节点 $5$：$(X,Y,Z) = (0,0,3)$，\n- 节点 $6$：$(X,Y,Z) = (2,0,3)$，\n- 节点 $7$：$(X,Y,Z) = (2,1,3)$，\n- 节点 $8$：$(X,Y,Z) = (0,1,3)$，\n其标准父空间坐标 $(\\xi,\\eta,\\zeta)$ 分别为节点 $1$ 至 $8$ 的 $(-1,-1,-1)$、$(+1,-1,-1)$、$(+1,+1,-1)$、$(-1,+1,-1)$、$(-1,-1,+1)$、$(+1,-1,+1)$、$(+1,+1,+1)$、$(-1,+1,+1)$。形函数是通常的三线性函数\n$$\nN_{i}(\\xi,\\eta,\\zeta) = \\tfrac{1}{8}(1+\\xi\\,\\xi_{i})(1+\\eta\\,\\eta_{i})(1+\\zeta\\,\\zeta_{i}),\n$$\n其中 $(\\xi_{i},\\eta_{i},\\zeta_{i})$ 是节点 $i$ 的父空间坐标。\n\n单元内的位移场通过等参数插值 $ \\mathbf{u}(\\mathbf{X}) = \\sum_{i=1}^{8} N_{i}(\\xi,\\eta,\\zeta)\\,\\mathbf{u}_{i} $ 由节点位移值近似，节点位移由以下线性映射规定\n$$\n\\mathbf{u}(\\mathbf{X}) = \\begin{pmatrix} 0.04\\,X \\\\ -0.02\\,Y \\\\ 0.06\\,Z \\end{pmatrix}.\n$$\n\n在单元中心 $(\\xi,\\eta,\\zeta) = (0,0,0)$ 处，使用通过参考构型雅可比矩阵将父空间梯度前推得到的形函数的参考（物质）梯度，计算该点的变形梯度 $\\mathbf{F}$ 和格林-拉格朗日应变张量 $\\mathbf{E}$。从 TL 描述的运动学定义出发，仅使用参考量进行计算。\n\n最后，报告单元中心处的体积伸长率\n$$\nJ = \\det(\\mathbf{F})\n$$\n将答案四舍五入到四位有效数字。将最终值表示为无量纲数。",
            "solution": "用户希望使用全拉格朗日（TL）公式，计算一个八节点六面体单元中心的变形梯度 $\\mathbf{F}$、格林-拉格朗日应变张量 $\\mathbf{E}$ 和体积伸长率 $J$。\n\n### 步骤1：提取已知条件\n-   **单元类型**：三维八节点三线性六面体单元。\n-   **公式**：全拉格朗日（TL）。\n-   **参考节点坐标** $\\mathbf{X}_i$：\n    -   节点 $1$：$(0,0,0)$，节点 $2$：$(2,0,0)$，节点 $3$：$(2,1,0)$，节点 $4$：$(0,1,0)$\n    -   节点 $5$：$(0,0,3)$，节点 $6$：$(2,0,3)$，节点 $7$：$(2,1,3)$，节点 $8$：$(0,1,3)$\n-   **父空间坐标** $(\\xi_i, \\eta_i, \\zeta_i)$：\n    -   节点 $1$：$(-1,-1,-1)$，节点 $2$：$(+1,-1,-1)$，节点 $3$：$(+1,+1,-1)$，节点 $4$：$(-1,+1,-1)$\n    -   节点 $5$：$(-1,-1,+1)$，节点 $6$：$(+1,-1,+1)$，节点 $7$：$(+1,+1,+1)$，节点 $8$：$(-1,+1,+1)$\n-   **形函数**：$N_{i}(\\xi,\\eta,\\zeta) = \\frac{1}{8}(1+\\xi\\xi_{i})(1+\\eta\\eta_{i})(1+\\zeta\\zeta_{i})$。\n-   **位移插值**：$\\mathbf{u}(\\mathbf{X}) = \\sum_{i=1}^{8} N_{i}(\\xi,\\eta,\\zeta)\\mathbf{u}_{i}$。\n-   **给定位移场**：$\\mathbf{u}(\\mathbf{X}) = \\begin{pmatrix} 0.04X \\\\ -0.02Y \\\\ 0.06Z \\end{pmatrix}$。\n-   **计算点**：单元中心，$(\\xi,\\eta,\\zeta) = (0,0,0)$。\n-   **任务**：在单元中心，使用从父空间量派生出的参考量计算 $\\mathbf{F}$、$\\mathbf{E}$ 和 $J = \\det(\\mathbf{F})$。\n-   **最终输出**：$J$ 四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在科学上基于连续介质力学和有限元法的原理。诸如全拉格朗日公式、变形梯度、格林-拉格朗日应变和等参单元等术语都是计算固体力学中的标准术语。该问题是适定的，提供了所有必要的几何数据、本构关系（运动学定义）和一个定义明确的位移场。位移场是物质坐标的线性函数，这可以由矩形单元上的三线性形函数精确表示，从而确保了解析场与其有限元表示之间的一致性。语言精确、客观。该问题并非无足轻重，因为它需要一系列的变换和计算，但它是可解的。\n\n### 步骤3：结论和行动\n该问题**有效**。将提供解决方案。\n\n### 求解推导\n在全拉格朗日公式中，当前构型中物质点的位置 $\\mathbf{x}$ 通过位移矢量 $\\mathbf{u}$ 与其在参考构型中的位置 $\\mathbf{X}$ 相关联：\n$$ \\mathbf{x} = \\mathbf{X} + \\mathbf{u}(\\mathbf{X}) $$\n变形梯度张量 $\\mathbf{F}$ 定义为此映射对物质坐标的梯度：\n$$ \\mathbf{F} = \\frac{\\partial \\mathbf{x}}{\\partial \\mathbf{X}} = \\frac{\\partial(\\mathbf{X} + \\mathbf{u})}{\\partial \\mathbf{X}} = \\mathbf{I} + \\frac{\\partial \\mathbf{u}}{\\partial \\mathbf{X}} = \\mathbf{I} + \\nabla_{\\mathbf{X}}\\mathbf{u} $$\n其中 $\\mathbf{I}$ 是单位张量，$\\nabla_{\\mathbf{X}}\\mathbf{u}$ 是物质位移梯度。\n\n格林-拉格朗日应变张量 $\\mathbf{E}$ 是参考构型中应变的一种度量，定义为：\n$$ \\mathbf{E} = \\frac{1}{2}(\\mathbf{F}^T \\mathbf{F} - \\mathbf{I}) $$\n体积伸长率 $J$ 衡量体积的变化，由变形梯度的行列式给出：\n$$ J = \\det(\\mathbf{F}) $$\n问题要求计算基于有限元公式。位移梯度 $\\nabla_{\\mathbf{X}}\\mathbf{u}$ 是根据节点位移 $\\mathbf{u}_i$ 和形函数相对于物质坐标的梯度 $\\nabla_{\\mathbf{X}}N_i$ 计算的：\n$$ \\nabla_{\\mathbf{X}}\\mathbf{u} = \\sum_{i=1}^{8} \\mathbf{u}_i \\otimes \\nabla_{\\mathbf{X}} N_i $$\n其中 $\\otimes$ 表示并矢积。形函数的物质梯度通过链式法则从父空间梯度 $\\nabla_{\\mathbf{\\xi}}N_i$ 获得：\n$$ \\nabla_{\\mathbf{X}} N_i = (\\mathbf{J}_0^{-1})^T \\nabla_{\\mathbf{\\xi}} N_i $$\n这里，$\\mathbf{J}_0 = \\frac{\\partial \\mathbf{X}}{\\partial \\mathbf{\\xi}}$ 是从父空间到参考构型的坐标映射的雅可比矩阵。\n\n**1. 单元中心的雅可比矩阵 $\\mathbf{J}_0$**\n$\\mathbf{J}_0$ 的列由 $\\frac{\\partial \\mathbf{X}}{\\partial \\xi_k} = \\sum_{i=1}^8 \\frac{\\partial N_i}{\\partial \\xi_k} \\mathbf{X}_i$ 给出。在单元中心 $(\\xi,\\eta,\\zeta)=(0,0,0)$ 处，形函数的导数为 $\\frac{\\partial N_i}{\\partial \\xi}|_{(0,0,0)} = \\frac{1}{8}\\xi_i$、$\\frac{\\partial N_i}{\\partial \\eta}|_{(0,0,0)} = \\frac{1}{8}\\eta_i$ 和 $\\frac{\\partial N_i}{\\partial \\zeta}|_{(0,0,0)} = \\frac{1}{8}\\zeta_i$。\n\n$$ \\frac{\\partial \\mathbf{X}}{\\partial \\xi}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\sum_{i=1}^{8} \\xi_i \\mathbf{X}_i = \\frac{1}{8}(-\\mathbf{X}_1+\\mathbf{X}_2+\\mathbf{X}_3-\\mathbf{X}_4-\\mathbf{X}_5+\\mathbf{X}_6+\\mathbf{X}_7-\\mathbf{X}_8) = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n$$ \\frac{\\partial \\mathbf{X}}{\\partial \\eta}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\sum_{i=1}^{8} \\eta_i \\mathbf{X}_i = \\frac{1}{8}(-\\mathbf{X}_1-\\mathbf{X}_2+\\mathbf{X}_3+\\mathbf{X}_4-\\mathbf{X}_5-\\mathbf{X}_6+\\mathbf{X}_7+\\mathbf{X}_8) = \\begin{pmatrix} 0 \\\\ 0.5 \\\\ 0 \\end{pmatrix} $$\n$$ \\frac{\\partial \\mathbf{X}}{\\partial \\zeta}\\bigg|_{(0,0,0)} = \\frac{1}{8}\\sum_{i=1}^{8} \\zeta_i \\mathbf{X}_i = \\frac{1}{8}(-\\mathbf{X}_1-\\mathbf{X}_2-\\mathbf{X}_3-\\mathbf{X}_4+\\mathbf{X}_5+\\mathbf{X}_6+\\mathbf{X}_7+\\mathbf{X}_8) = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1.5 \\end{pmatrix} $$\n中心的雅可比矩阵为：\n$$ \\mathbf{J}_0 = \\begin{pmatrix} 1  0  0 \\\\ 0  0.5  0 \\\\ 0  0  1.5 \\end{pmatrix} $$\n由于 $\\mathbf{J}_0$ 是对角的，其逆转置矩阵也是对角的：\n$$ (\\mathbf{J}_0^{-1})^T = (\\mathbf{J}_0^T)^{-1} = \\mathbf{J}_0^{-1} = \\begin{pmatrix} 1  0  0 \\\\ 0  1/0.5  0 \\\\ 0  0  1/1.5 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  2  0 \\\\ 0  0  2/3 \\end{pmatrix} $$\n\n**2. 节点位移 $\\mathbf{u}_i$**\n节点位移是通过在每个节点坐标 $\\mathbf{X}_i$ 处计算给定的位移场 $\\mathbf{u}(\\mathbf{X}) = (0.04X, -0.02Y, 0.06Z)^T$ 来找到的：\n- $\\mathbf{u}_1 = (0, 0, 0)^T$\n- $\\mathbf{u}_2 = (0.08, 0, 0)^T$\n- $\\mathbf{u}_3 = (0.08, -0.02, 0)^T$\n- $\\mathbf{u}_4 = (0, -0.02, 0)^T$\n- $\\mathbf{u}_5 = (0, 0, 0.18)^T$\n- $\\mathbf{u}_6 = (0.08, 0, 0.18)^T$\n- $\\mathbf{u}_7 = (0.08, -0.02, 0.18)^T$\n- $\\mathbf{u}_8 = (0, -0.02, 0.18)^T$\n\n**3. 位移梯度 $\\nabla_{\\mathbf{X}}\\mathbf{u}$**\n我们使用 $(\\nabla_{\\mathbf{X}}\\mathbf{u})_{jk} = \\sum_{i=1}^8 u_{i,j} (\\nabla_{\\mathbf{X}}N_i)_k$ 计算 $\\nabla_{\\mathbf{X}}\\mathbf{u}$ 的分量。中心处形函数的物质梯度为 $\\nabla_{\\mathbf{X}} N_i = (\\mathbf{J}_0^{-1})^T \\frac{1}{8}(\\xi_i, \\eta_i, \\zeta_i)^T = \\frac{1}{8}(\\xi_i, 2\\eta_i, \\frac{2}{3}\\zeta_i)^T$。\n\n由于问题的对称性（正交单元和线性位移场），位移梯度的非对角项将为零。我们计算对角项：\n$$ (\\nabla_{\\mathbf{X}}\\mathbf{u})_{11} = \\sum_{i=1}^8 u_{i,1} (\\nabla_{\\mathbf{X}}N_i)_1 = \\frac{1}{8}\\sum_{i=1}^8 u_{i,x} \\xi_i = \\frac{1}{8}(0.08+0.08+0.08+0.08) = 0.04 $$\n$$ (\\nabla_{\\mathbf{X}}\\mathbf{u})_{22} = \\sum_{i=1}^8 u_{i,2} (\\nabla_{\\mathbf{X}}N_i)_2 = \\frac{1}{8}\\sum_{i=1}^8 u_{i,y} (2\\eta_i) = \\frac{1}{4}(-0.02 - 0.02 - 0.02 - 0.02) = -0.02 $$\n$$ (\\nabla_{\\mathbf{X}}\\mathbf{u})_{33} = \\sum_{i=1}^8 u_{i,3} (\\nabla_{\\mathbf{X}}N_i)_3 = \\frac{1}{8}\\sum_{i=1}^8 u_{i,z} (\\tfrac{2}{3}\\zeta_i) = \\frac{1}{12}(0.18+0.18+0.18+0.18) = 0.06 $$\n非对角项为零。例如，$(\\nabla_{\\mathbf{X}}\\mathbf{u})_{12} = \\frac{1}{8}\\sum_{i=1}^8 u_{i,x} (2\\eta_i) = \\frac{1}{4}(-0.08+0.08-0.08+0.08) = 0$。\n因此，中心处的位移梯度张量为：\n$$ \\nabla_{\\mathbf{X}}\\mathbf{u} = \\begin{pmatrix} 0.04  0  0 \\\\ 0  -0.02  0 \\\\ 0  0  0.06 \\end{pmatrix} $$\n\n**4. 变形梯度 $\\mathbf{F}$ 和应变张量 $\\mathbf{E}$**\n$$ \\mathbf{F} = \\mathbf{I} + \\nabla_{\\mathbf{X}}\\mathbf{u} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\begin{pmatrix} 0.04  0  0 \\\\ 0  -0.02  0 \\\\ 0  0  0.06 \\end{pmatrix} = \\begin{pmatrix} 1.04  0  0 \\\\ 0  0.98  0 \\\\ 0  0  1.06 \\end{pmatrix} $$\n格林-拉格朗日应变张量为：\n$$ \\mathbf{E} = \\frac{1}{2}(\\mathbf{F}^T\\mathbf{F} - \\mathbf{I}) = \\frac{1}{2}\\left( \\begin{pmatrix} 1.04^2  0  0 \\\\ 0  0.98^2  0 \\\\ 0  0  1.06^2 \\end{pmatrix} - \\mathbf{I} \\right) = \\begin{pmatrix} 0.0408  0  0 \\\\ 0  -0.0198  0 \\\\ 0  0  0.0618 \\end{pmatrix} $$\n\n**5. 体积伸长率 $J$**\n最后，体积伸长率 $J$ 是 $\\mathbf{F}$ 的行列式。由于 $\\mathbf{F}$ 是对角的，因此这是其对角元素的乘积：\n$$ J = \\det(\\mathbf{F}) = (1.04)(0.98)(1.06) $$\n$$ J = 1.0192 \\times 1.06 = 1.080352 $$\n问题要求答案四舍五入到四位有效数字。\n前四位有效数字是 $1$、$0$、$8$ 和 $0$。第五位数字是 $3$，小于 $5$，因此我们向下舍入。\n$$ J \\approx 1.080 $$",
            "answer": "$$ \\boxed{1.080} $$"
        },
        {
            "introduction": "在掌握了基本运动学量的计算后，下一个练习将探讨应变度量的线性化，这是构建隐式求解器中切线刚度矩阵的关键步骤。我们将推导全拉格朗日应变-位移矩阵（$B_0$）的一个分量，该矩阵将格林-拉格朗日应变的变分与虚节点位移联系起来。这个练习将连续介质力学理论与有限元法中求解的代数方程组联系在一起。",
            "id": "3607529",
            "problem": "在计算固体力学中，考虑一个在全拉格朗日列式下使用的三维直角线性四面体有限元。其节点的参考（物质）坐标由下式给出：$X_1 = (0,\\,0,\\,0)$、$X_2 = (L_x,\\,0,\\,0)$、$X_3 = (0,\\,L_y,\\,0)$ 和 $X_4 = (0,\\,0,\\,L_z)$，其中 $L_x = 1$ 米、$L_y = 2$ 米、$L_z = 3$ 米。变形梯度在整个单元上是恒定的，并由下式给出\n$$\n\\mathbf{F} \\;=\\;\n\\begin{pmatrix}\n1.2  0.1  0 \\\\\n0.5  0.9  0.2 \\\\\n0  0  1.1\n\\end{pmatrix}.\n$$\n格林-拉格朗日应变张量 $\\mathbf{E}$ 由基本运动学关系 $\\mathbf{E} = \\tfrac{1}{2}(\\mathbf{C} - \\mathbf{I})$ 定义，其中 $\\mathbf{C} = \\mathbf{F}^T\\mathbf{F}$ 是右柯西-格林变形张量，$\\mathbf{I}$ 是单位张量。在全拉格朗日列式中，虚应变是通过标准有限元插值，利用线性形函数 $N_I(X)$ 构建的虚位移场 $\\delta \\mathbf{u}$，并通过对参考坐标 $X$ 求导得到的。\n\n仅使用上述定义以及对于直角线性四面体，形函数是关于 $X$ 的线性函数并在节点处满足克罗内克-德尔塔性质这一事实，推导节点1的全拉格朗日应变-位移关系以及相应的全拉格朗日应变-位移矩阵 $\\mathbf{B}_0$ 的块。重点关注 $\\mathbf{B}_0$ 中与虚应变分量 $E_{xy}$（Voigt 序为 $[E_{xx},\\,E_{yy},\\,E_{zz},\\,E_{xy},\\,E_{yz},\\,E_{zx}]^T$，不含剪切分量的加倍）相关行中，乘以节点1处虚节点位移的 $y$ 分量（记为 $\\delta d_{1y}$）的标量系数。\n\n使用给定的几何形状和变形梯度，在单元层面计算这个标量系数。以 $\\mathrm{m}^{-1}$ 为单位表示您的最终结果，并四舍五入到四位有效数字。",
            "solution": "该问题要求计算线性四面体单元的全拉格朗日应变-位移矩阵 $\\mathbf{B}_0$ 中的一个特定标量系数。该矩阵将虚格林-拉格朗日应变 $\\delta\\mathbf{E}$ 与虚节点位移向量 $\\delta\\mathbf{d}$ 联系起来。\n\n起点是格林-拉格朗日应变张量 $\\mathbf{E}$ 根据变形梯度 $\\mathbf{F}$ 的定义：\n$$ \\mathbf{E} = \\frac{1}{2}(\\mathbf{F}^T\\mathbf{F} - \\mathbf{I}) $$\n其中 $\\mathbf{I}$ 是二阶单位张量。\n\n为找到包含虚量的关系，我们对 $\\mathbf{E}$ 取变分：\n$$ \\delta\\mathbf{E} = \\delta\\left[\\frac{1}{2}(\\mathbf{F}^T\\mathbf{F} - \\mathbf{I})\\right] = \\frac{1}{2}\\delta(\\mathbf{F}^T\\mathbf{F}) = \\frac{1}{2}(\\delta(\\mathbf{F}^T)\\mathbf{F} + \\mathbf{F}^T\\delta\\mathbf{F}) $$\n变形梯度的变分 $\\delta\\mathbf{F}$ 是虚位移场 $\\delta\\mathbf{u}$ 相对于物质坐标 $\\mathbf{X}$ 的梯度。用指标表示法为：\n$$ \\delta F_{ij} = \\frac{\\partial(\\delta u_i)}{\\partial X_j} $$\n将此代入格林-拉格朗日应变张量变分 $\\delta E_{ij}$ 的表达式中：\n$$ \\delta E_{ij} = \\frac{1}{2} (\\delta F_{ki} F_{kj} + F_{ki} \\delta F_{kj}) = \\frac{1}{2} \\left( \\frac{\\partial(\\delta u_k)}{\\partial X_i} F_{kj} + F_{ki} \\frac{\\partial(\\delta u_k)}{\\partial X_j} \\right) $$\n\n在有限元方法中，虚位移场 $\\delta\\mathbf{u}$ 是由虚节点位移 $\\delta d_{Ik}$ 使用形函数 $N_I(\\mathbf{X})$ 插值得到的：\n$$ \\delta u_k(\\mathbf{X}) = \\sum_{I=1}^{4} N_I(\\mathbf{X}) \\delta d_{Ik} $$\n其中 $I$ 是节点索引（从1到4），$k$ 是分量索引（从1到3）。虚位移的梯度则为：\n$$ \\frac{\\partial(\\delta u_k)}{\\partial X_j} = \\sum_{I=1}^{4} \\frac{\\partial N_I}{\\partial X_j} \\delta d_{Ik} $$\n将这个离散形式代入 $\\delta E_{ij}$ 的表达式中：\n$$ \\delta E_{ij} = \\frac{1}{2} \\left( F_{kj} \\sum_{I=1}^{4} \\frac{\\partial N_I}{\\partial X_i} \\delta d_{Ik} + F_{ki} \\sum_{I=1}^{4} \\frac{\\partial N_I}{\\partial X_j} \\delta d_{Ik} \\right) $$\n通过重排求和，我们可以将 $\\delta E_{ij}$ 表示为虚节点位移 $\\delta d_{Ik}$ 的线性组合：\n$$ \\delta E_{ij} = \\sum_{I=1}^{4} \\sum_{k=1}^{3} \\left\\{ \\frac{1}{2} \\left( F_{kj} \\frac{\\partial N_I}{\\partial X_i} + F_{ki} \\frac{\\partial N_I}{\\partial X_j} \\right) \\right\\} \\delta d_{Ik} $$\n花括号中的项是应变-位移矩阵 $\\mathbf{B}_0$ 的分量，它将应变分量 $\\delta E_{ij}$ 与节点位移分量 $\\delta d_{Ik}$ 联系起来。\n\n该问题要求的是与虚应变分量 $E_{xy}$ 相关的行中，乘以节点1处虚节点位移的 $y$ 分量（$\\delta d_{1y}$）的特定标量系数。用指标表示法，这对应于：\n- 应变分量：$xy \\implies i=1, j=2$。\n- 节点：$I=1$。\n- 位移分量：$y \\implies k=2$。\n\n将这些索引（$I=1, k=2, i=1, j=2$）代入通用系数表达式中，得到我们所求的标量系数，记为 $C$：\n$$ C = \\frac{1}{2} \\left( F_{22} \\frac{\\partial N_1}{\\partial X_1} + F_{21} \\frac{\\partial N_1}{\\partial X_2} \\right) $$\n为了计算这个系数，我们需要给定变形梯度中的分量 $F_{21}$ 和 $F_{22}$，以及节点1的形函数的梯度 $\\frac{\\partial N_1}{\\partial X_1}$ 和 $\\frac{\\partial N_1}{\\partial X_2}$。\n\n线性四面体的形函数形式为 $N_I(\\mathbf{X}) = a_I + b_I X_1 + c_I X_2 + d_I X_3$。梯度 $\\frac{\\partial N_I}{\\partial X_j}$ 是常数 $b_I, c_I, d_I$。这些常数是通过求解从克罗内克-德尔塔性质 $N_I(\\mathbf{X}_J) = \\delta_{IJ}$ 导出的方程组来确定的。对于给定的节点坐标为 $\\mathbf{X}_1=(0,0,0)$、$\\mathbf{X}_2=(L_x,0,0)$、$\\mathbf{X}_3=(0,L_y,0)$ 和 $\\mathbf{X}_4=(0,0,L_z)$ 的直角四面体，节点1的形函数为：\n$$ N_1(X_1, X_2, X_3) = 1 - \\frac{X_1}{L_x} - \\frac{X_2}{L_y} - \\frac{X_3}{L_z} $$\n$N_1$ 的梯度在整个单元上是恒定的：\n$$ \\frac{\\partial N_1}{\\partial X_1} = -\\frac{1}{L_x} $$\n$$ \\frac{\\partial N_1}{\\partial X_2} = -\\frac{1}{L_y} $$\n$$ \\frac{\\partial N_1}{\\partial X_3} = -\\frac{1}{L_z} $$\n\n现在我们可以整合所有必要的值。问题提供了：\n- 几何长度：$L_x = 1 \\, \\mathrm{m}$，$L_y = 2 \\, \\mathrm{m}$。\n- 变形梯度：\n$$\n\\mathbf{F} \\;=\\;\n\\begin{pmatrix}\n1.2  0.1  0 \\\\\n0.5  0.9  0.2 \\\\\n0  0  1.1\n\\end{pmatrix}\n$$\n从 $\\mathbf{F}$ 中，我们得到 $F_{21} = 0.5$ 和 $F_{22} = 0.9$。\n形函数的梯度为：\n$$ \\frac{\\partial N_1}{\\partial X_1} = -\\frac{1}{1 \\, \\mathrm{m}} = -1 \\, \\mathrm{m}^{-1} $$\n$$ \\frac{\\partial N_1}{\\partial X_2} = -\\frac{1}{2 \\, \\mathrm{m}} = -0.5 \\, \\mathrm{m}^{-1} $$\n\n将这些值代入系数 $C$ 的表达式中：\n$$ C = \\frac{1}{2} \\left[ (0.9) \\left( -1 \\, \\mathrm{m}^{-1} \\right) + (0.5) \\left( -0.5 \\, \\mathrm{m}^{-1} \\right) \\right] $$\n$$ C = \\frac{1}{2} \\left[ -0.9 - 0.25 \\right] \\, \\mathrm{m}^{-1} $$\n$$ C = \\frac{1}{2} \\left[ -1.15 \\right] \\, \\mathrm{m}^{-1} $$\n$$ C = -0.575 \\, \\mathrm{m}^{-1} $$\n问题要求结果四舍五入到四位有效数字。\n$$ C = -0.5750 \\, \\mathrm{m}^{-1} $$\n这个标量值是全拉格朗日应变-位移矩阵 $\\mathbf{B}_0$ 中对应 $E_{xy}$ 的行和 $\\delta d_{1y}$ 的列的元素。",
            "answer": "$$ \\boxed{-0.5750} $$"
        },
        {
            "introduction": "最后的这个实践练习将通过一个编程任务，把前面学习的概念融会贯通，用于计算单元残差向量，它代表了系统中的不平衡力。你将实现一个完整的数值计算流程，包括等参映射、高斯积分，以及根据超弹性本构模型计算第一皮奥拉-基尔霍夫应力。这个练习是构建一个完整的非线性有限元求解器的直接步骤。",
            "id": "3607498",
            "problem": "考虑计算固体力学中全拉格朗日有限元格式下的单个二维等参四节点双线性四边形有限元。目标是对于给定的节点位移场，在参考构型中使用高斯求积计算单元残差向量。全拉格朗日格式基于参考初始构型的基本平衡定律，并采用参考构型中线性动量平衡的弱形式。\n\n使用以下基本依据：\n- 参考构型中的虚功原理指出，对于任何运动学容许的虚位移，内虚功等于外虚功。参考构型中的内虚功涉及第一类Piola-Kirchhoff应力和虚位移相对于参考坐标的梯度。\n- 在全拉格朗日框架中，变形梯度定义为 $F = I + \\nabla_{X} u$，其中 $I$ 是单位张量，$u$ 是定义在参考坐标 $X$ 上的位移场。\n- 对于可压缩Neo-Hookean材料，第一类Piola-Kirchhoff应力 $P$ 由应变能密度导出，对于本问题，必须取为 $P = \\mu \\left(F - F^{-T}\\right) + \\lambda \\ln J \\, F^{-T}$，其中 $\\lambda$ 和 $\\mu$ 是Lamé参数，$J = \\det(F)$，且 $F^{-T}$ 是 $F$ 的逆转置。\n- 对于节点 $i$ 和笛卡尔分量 $\\alpha$，单元残差的弱形式由积分 $r_{i\\alpha} = \\int_{\\Omega_0} P_{\\alpha A} \\frac{\\partial N_i}{\\partial X_A} \\, d\\Omega_0 - \\int_{\\Omega_0} N_i \\, b_{0\\alpha} \\, d\\Omega_0$ 给出，其中 $N_i$ 是形函数，$b_0$ 是单位参考体积的体力。本问题中 $\\Gamma_0$ 上的边界面力项取为零。\n\n您必须使用以下定义在具有参数坐标 $(\\xi,\\eta)$ 的母单元正方形上的等参双线性形函数：\n- $N_1(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 - \\eta)$,\n- $N_2(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 - \\eta)$,\n- $N_3(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi)(1 + \\eta)$,\n- $N_4(\\xi,\\eta) = \\frac{1}{4}(1 - \\xi)(1 + \\eta)$.\n它们的参数导数为：\n- $\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1 - \\eta)$, $\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1 - \\xi)$,\n- $\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1 - \\eta)$, $\\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1 + \\xi)$,\n- $\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1 + \\eta)$, $\\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1 + \\xi)$,\n- $\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1 + \\eta)$, $\\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1 - \\xi)$.\n\n使用单元雅可比矩阵将导数映射到参考构型，该雅可比矩阵是关于参考坐标 $X$ 的，并由参考构型中的节点坐标 $X_i$ 计算得出。使用二乘二高斯求积，其求积点 $(\\xi,\\eta)$ 分别为 $\\left(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right)$、$\\left(\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right)$、$\\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$、$\\left(-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$，每个点的权重等于 $1$。所有量均为无量纲。\n\n单元残差向量必须组装为 $r_e = [r_{1x}, r_{1y}, r_{2x}, r_{2y}, r_{3x}, r_{3y}, r_{4x}, r_{4y}]$，其中 $r_{ix}$ 和 $r_{iy}$ 是节点 $i$ 的分量。对于每个高斯点，计算变形梯度 $F = I + \\sum_{i=1}^{4} u_i \\otimes \\nabla_X N_i$，其中 $u_i$ 是节点位移向量，$\\nabla_X N_i$ 是形函数在参考构型中的梯度。然后计算 $P$，并加上乘以参考域雅可比行列式和高斯权重的内力贡献 $\\left(P \\, \\nabla_X N_i\\right)$。减去乘以相同雅可比行列式和高斯权重的外体力贡献 $\\left(N_i \\, b_0\\right)$。没有边界面力贡献。\n\n您的程序必须实现此过程，并为以下四个测试用例生成数值结果。对于每个测试用例，单元由相同的参考节点坐标 $X_1 = [0, 0]$、$X_2 = [1, 0]$、$X_3 = [1, 1]$、$X_4 = [0, 1]$ 定义。位移场、Lamé参数和体力因情况而异，如下所示：\n- 测试用例 1:\n  - 节点位移 $u_1 = [0, 0]$, $u_2 = [0.05, 0]$, $u_3 = [0.05, 0.05]$, $u_4 = [0, 0.05]$。\n  - Lamé参数 $\\lambda = 20$, $\\mu = 10$。\n  - 体力 $b_0 = [0, 0]$。\n- 测试用例 2:\n  - 节点位移 $u_1 = [0, 0]$, $u_2 = [0, 0]$, $u_3 = [0, 0]$, $u_4 = [0, 0]$。\n  - Lamé参数 $\\lambda = 20$, $\\mu = 10$。\n  - 体力 $b_0 = [1, 2]$。\n- 测试用例 3:\n  - 节点位移 $u_1 = [0, 0]$, $u_2 = [-0.1, 0]$, $u_3 = [-0.1, -0.05]$, $u_4 = [0, -0.05]$。\n  - Lamé参数 $\\lambda = 100$, $\\mu = 50$。\n  - 体力 $b_0 = [0, 0]$。\n- 测试用例 4:\n  - 节点位移 $u_1 = [0, 0]$, $u_2 = [0.01, 0]$, $u_3 = [0.01, 0.01]$, $u_4 = [0, 0.01]$。\n  - Lamé参数 $\\lambda = 1000$, $\\mu = 10$。\n  - 体力 $b_0 = [0, 0]$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是测试用例的残差向量，表示为一个包含八个浮点数的列表，顺序为 $[r_{1x}, r_{1y}, r_{2x}, r_{2y}, r_{3x}, r_{3y}, r_{4x}, r_{4y}]$。例如，包含两个测试用例的输出形式为 $[[a_1,a_2,\\dots,a_8],[b_1,b_2,\\dots,b_8]]$。最终输出必须与此处提供的四个测试用例匹配。所有量均为无量纲，并且必须按照指定，使用参考构型和二乘二高斯求积进行计算。",
            "solution": "用户提供了一个有效且适定的计算固体力学问题。该问题具有科学依据，是客观的，并包含计算唯一解所需的所有必要信息。它要求使用全拉格朗日格式计算一个二维四节点四边形单元的单元残差向量。求解过程需要应用等参有限元映射、连续介质力学和数值积分的原理。\n\n计算单元残差向量 $r_e$ 的过程如下。残差向量是内力向量 $f_{int}$ 和外力向量 $f_{ext}$ 之间的差值。单个节点 $i$ 和分量 $\\alpha$ 的残差弱形式由以下公式给出：\n$$\nr_{i\\alpha} = \\int_{\\Omega_0} P_{\\alpha A} \\frac{\\partial N_i}{\\partial X_A} \\, d\\Omega_0 - \\int_{\\Omega_0} N_i \\, b_{0\\alpha} \\, d\\Omega_0\n$$\n其中 $\\Omega_0$ 是参考构型中的单元域，$P$ 是第一类Piola-Kirchhoff应力张量，$N_i$ 是形函数，$X_A$ 是参考坐标，$b_0$ 是单位参考体积的体力。重复的索引 $A$ 表示对空间维度求和（$A=1, 2$）。\n\n计算采用 $2 \\times 2$ 高斯求积进行数值计算。对参考域 $\\Omega_0$ 的积分被转换为对具有局部坐标 $(\\xi, \\eta)$ 的母单元正方形域 $\\Omega_p = [-1, 1] \\times [-1, 1]$ 的积分。\n$$\n\\int_{\\Omega_0} (\\cdot) \\, d\\Omega_0 = \\int_{\\Omega_p} (\\cdot) \\det(J_e) \\, d\\xi d\\eta \\approx \\sum_{k=1}^{4} (\\cdot)_k \\det(J_e)_k w_k\n$$\n其中 $k$ 是高斯求积点的索引，$w_k$ 是高斯权重（在本例中全部等于 $1$），$J_e$ 是等参坐标变换 $X(\\xi, \\eta)$ 的雅可比矩阵。\n\n单个单元的逐步计算算法如下：\n\n1.  **初始化**：将单元残差向量 $r_e$（对于一个每节点2个自由度的4节点单元，这是一个 $8 \\times 1$ 的向量）初始化为零。\n\n2.  **高斯求积循环**：对四个高斯点 $(\\xi_k, \\eta_k)$ 中的每一个执行以下步骤：\n    a. **形函数和导数**：在当前高斯点计算四个双线性形函数 $N_i(\\xi_k, \\eta_k)$ 的值及其关于母单元坐标的导数 $\\frac{\\partial N_i}{\\partial \\xi}$ 和 $\\frac{\\partial N_i}{\\partial \\eta}$。\n\n    b. **等参映射**：计算从母单元坐标到参考坐标的映射雅可比矩阵 $J_e$：\n    $$\n    J_e = \\begin{bmatrix} \\frac{\\partial X_1}{\\partial \\xi}  \\frac{\\partial X_2}{\\partial \\xi} \\\\ \\frac{\\partial X_1}{\\partial \\eta}  \\frac{\\partial X_2}{\\partial \\eta} \\end{bmatrix} = \\sum_{i=1}^{4} \\begin{bmatrix} \\frac{\\partial N_i}{\\partial \\xi} X_{i1}  \\frac{\\partial N_i}{\\partial \\xi} X_{i2} \\\\ \\frac{\\partial N_i}{\\partial \\eta} X_{i1}  \\frac{\\partial N_i}{\\partial \\eta} X_{i2} \\end{bmatrix} = \\begin{bmatrix} \\frac{\\partial N}{\\partial \\xi}^T X_{nodes,1}  \\frac{\\partial N}{\\partial \\xi}^T X_{nodes,2} \\\\ \\frac{\\partial N}{\\partial \\eta}^T X_{nodes,1}  \\frac{\\partial N}{\\partial \\eta}^T X_{nodes,2} \\end{bmatrix}\n    $$\n    同时计算其行列式 $\\det(J_e)$ 和逆矩阵 $J_e^{-1}$。对于指定的方形单元，$J_e$ 是一个常数对角矩阵。\n\n    c. **形函数梯度**：使用链式法则求得形函数相对于参考坐标的梯度 $\\nabla_X N_i$：\n    $$\n    \\begin{bmatrix} \\frac{\\partial N_i}{\\partial X_1} \\\\ \\frac{\\partial N_i}{\\partial X_2} \\end{bmatrix} = J_e^{-1} \\begin{bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{bmatrix}\n    $$\n    对所有四个形函数执行此操作，通常排列成一个 $4 \\times 2$ 的矩阵，记为 $B_N$。\n\n    d. **变形梯度**：单元内的位移场由节点位移 $u_i$ 插值得到 $u(X) = \\sum_{i=1}^{4} N_i(X) u_i$。然后在高斯点计算位移梯度 $\\nabla_X u$：\n    $$\n    (\\nabla_X u)_{\\alpha A} = \\frac{\\partial u_\\alpha}{\\partial X_A} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial X_A} u_{i\\alpha}\n    $$\n    然后计算变形梯度张量 $F$ 为 $F = I + \\nabla_X u$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n\n    e. **应力计算**：使用给定的可压缩Neo-Hookean本构模型计算第一类Piola-Kirchhoff应力张量 $P$：\n    $$\n    P = \\mu \\left(F - F^{-T}\\right) + \\lambda \\ln J \\, F^{-T}\n    $$\n    这需要计算 $F$ 的行列式 $J = \\det(F)$、其逆矩阵 $F^{-1}$ 及其逆转置矩阵 $F^{-T}$。\n\n    f. **残差贡献**：计算当前高斯点对内力和外力向量的贡献。\n    - 节点 $i$ 和分量 $\\alpha$ 的内力贡献为 $(f_{int})_{i\\alpha,k} = \\left( \\sum_A P_{\\alpha A} \\frac{\\partial N_i}{\\partial X_A} \\right)_k$。\n    - 外力贡献为 $(f_{ext})_{i\\alpha,k} = (N_i \\, b_{0\\alpha})_k$。\n    来自此高斯点的对残差的总贡献被组装成一个 $8 \\times 1$ 的向量，并乘以 $\\det(J_e)_k w_k$。\n\n3.  **组装**：将所有高斯点的贡献相加，得到最终的单元残差向量 $r_e$。\n\n对问题陈述中提供的四个测试用例中的每一个都实施此程序。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the residual vector for a 2D 4-node quad element for multiple test cases.\n    \"\"\"\n\n    def compute_residual(u_nodes: np.ndarray, lam: float, mu: float, b0: np.ndarray) - list:\n        \"\"\"\n        Calculates the residual vector for a single element.\n\n        Args:\n            u_nodes: A 4x2 NumPy array of nodal displacements.\n            lam: The first Lamé parameter.\n            mu: The second Lamé parameter (shear modulus).\n            b0: A 2-element NumPy array for the body force vector.\n\n        Returns:\n            A list of 8 floats representing the element residual vector.\n        \"\"\"\n        # Reference nodal coordinates for a unit square\n        X_nodes = np.array([[0.0, 0.0], [1.0, 0.0], [1.0, 1.0], [0.0, 1.0]])\n\n        # Gauss quadrature points and weights for a 2x2 scheme\n        gp_coord = 1.0 / np.sqrt(3.0)\n        gauss_points = np.array([\n            [-gp_coord, -gp_coord],\n            [ gp_coord, -gp_coord],\n            [ gp_coord,  gp_coord],\n            [-gp_coord,  gp_coord]\n        ])\n        gauss_weights = np.array([1.0, 1.0, 1.0, 1.0])\n\n        # Initialize the 8x1 element residual vector\n        r_e = np.zeros(8)\n\n        # Loop over all Gauss points\n        for i in range(len(gauss_weights)):\n            xi, eta = gauss_points[i]\n            weight = gauss_weights[i]\n\n            # 1. Evaluate shape functions N_i and their derivatives w.r.t. parent coordinates (xi, eta)\n            N = 0.25 * np.array([\n                (1.0 - xi) * (1.0 - eta),\n                (1.0 + xi) * (1.0 - eta),\n                (1.0 + xi) * (1.0 + eta),\n                (1.0 - xi) * (1.0 + eta)\n            ])\n\n            dNdxi_matrix = 0.25 * np.array([\n                [-(1.0 - eta), -(1.0 - xi)],  # dN1/dxi, dN1/deta\n                [ (1.0 - eta), -(1.0 + xi)],  # dN2/dxi, dN2/deta\n                [ (1.0 + eta),  (1.0 + xi)],  # dN3/dxi, dN3/deta\n                [-(1.0 + eta),  (1.0 - xi)]   # dN4/dxi, dN4/deta\n            ])\n\n            # 2. Compute the Jacobian of the mapping from parent to reference coordinates (J_e)\n            J_e = dNdxi_matrix.T @ X_nodes\n            det_J_e = np.linalg.det(J_e)\n            J_e_inv = np.linalg.inv(J_e)\n\n            # 3. Compute shape function derivatives in reference coordinates (dNdX)\n            dNdX_matrix = dNdxi_matrix @ J_e_inv\n\n            # 4. Compute the deformation gradient F\n            # The displacement gradient tensor (nabla_u)_alphaA = d(u_alpha)/d(X_A)\n            # In matrix form, nabla_u = (dNdX_matrix.T @ u_nodes).T\n            nabla_u = (dNdX_matrix.T @ u_nodes).T\n            F = np.eye(2) + nabla_u\n\n            # 5. Compute the First Piola-Kirchhoff stress tensor P\n            J_det_F = np.linalg.det(F)\n            if J_det_F = 0:\n                raise ValueError(f\"Non-positive determinant of deformation gradient F: {J_det_F}\")\n            \n            F_inv = np.linalg.inv(F)\n            F_inv_T = F_inv.T\n            P = mu * (F - F_inv_T) + lam * np.log(J_det_F) * F_inv_T\n            \n            # 6. Assemble residual contributions\n            # Internal force component: (dNdX @ P.T).flatten() gives the column vector of nodal forces\n            f_int_contrib = (dNdX_matrix @ P.T).flatten(order='C')\n            \n            # External force component\n            f_ext_contrib = np.kron(N, b0)\n\n            # 7. Add contributes to the total element residual vector\n            r_e += (f_int_contrib - f_ext_contrib) * det_J_e * weight\n\n        return r_e.tolist()\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {'u': np.array([[0.0, 0.0], [0.05, 0.0], [0.05, 0.05], [0.0, 0.05]]), 'lam': 20.0, 'mu': 10.0, 'b0': np.array([0.0, 0.0])},\n        {'u': np.array([[0.0, 0.0], [0.0, 0.0], [0.0, 0.0], [0.0, 0.0]]), 'lam': 20.0, 'mu': 10.0, 'b0': np.array([1.0, 2.0])},\n        {'u': np.array([[0.0, 0.0], [-0.1, 0.0], [-0.1, -0.05], [0.0, -0.05]]), 'lam': 100.0, 'mu': 50.0, 'b0': np.array([0.0, 0.0])},\n        {'u': np.array([[0.0, 0.0], [0.01, 0.0], [0.01, 0.01], [0.0, 0.01]]), 'lam': 1000.0, 'mu': 10.0, 'b0': np.array([0.0, 0.0])},\n    ]\n\n    results = []\n    for case in test_cases:\n        res_vector = compute_residual(case['u'], case['lam'], case['mu'], case['b0'])\n        results.append(res_vector)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists matches the desired output format.\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}