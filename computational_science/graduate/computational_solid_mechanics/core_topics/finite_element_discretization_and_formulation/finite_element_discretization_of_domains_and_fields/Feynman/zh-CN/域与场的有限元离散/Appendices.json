{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个动手实践将带你回到有限元方法最核心的概念：如何使用节点值和形函数来近似一个连续场。我们将以一个简单的一维杆为模型，其位移场是线性的，通过这个练习，你将亲手验证线性单元能够精确地捕捉线性解。这个基本原理是有限元方法正确性的基石，也是通过“单元检验”（patch test）的基础。",
            "id": "3565560",
            "problem": "考虑一个沿坐标 $x$ 的一维弹性杆段，以及一个由有限元法（FEM）离散化的三单元片区。物理域为 $x \\in [0, L]$，其中 $L = 0.9$ 米。该网格由三个相等的双节点等参 Lagrange 单元组成，全局节点位于 $x_{1} = 0$、$x_{2} = 0.3$、$x_{3} = 0.6$ 和 $x_{4} = 0.9$，单位均为米。精确位移场是线性的，由 $u(x) = a + B x$ 给出，其中 $a = 1.5 \\times 10^{-3}$ 米， $B = 5.0 \\times 10^{-3}$ （相对于米是无量纲的）。\n\n从控制双节点等参 Lagrange 单元上 $u(x)$ 的有限元近似的基本定义出发，推导通过在三单元片区上插值精确场 $u(x)$ 所得到的全局节点位移向量。然后，使用基本原理，验证插值场在节点处等于精确场。以米为单位表示最终的全局节点位移向量。无需四舍五入；请提供精确值。",
            "solution": "该问题被评估为有效，因为它具有科学依据、是适定的且客观的。它呈现了一个将有限元法（FEM）应用于一维问题的标准练习，其中所有必要的数据和定义都得到了一致的提供。\n\n问题的核心是通过插值一个已知的精确位移场来确定有限元网格的节点位移，并验证该插值在节点处的一致性。\n\n精确位移场是空间坐标 $x$ 的线性函数：\n$$u(x) = a + Bx$$\n其中常数 $a = 1.5 \\times 10^{-3}$ 米， $B = 5.0 \\times 10^{-3}$ （无量纲）。物理域为 $x \\in [0, 0.9]$ 米。\n\n该域被离散化为三个相等的双节点线性 Lagrange 单元。全局节点位于 $x_{1} = 0$、$x_{2} = 0.3$、$x_{3} = 0.6$ 和 $x_{4} = 0.9$ 米。\n全局节点位移向量，记为 $\\mathbf{d}$，是一个向量，其分量是每个全局节点处的位移值。在有限元法中，当已知精确解时，近似解的节点值通常通过在节点坐标处计算精确解的值来设定。这个过程被称为插值。\n因此，全局节点位移向量 $\\mathbf{d}$ 的分量 $d_i$ 由下式给出：\n$$d_i = u(x_i)$$\n其中 $x_i$ 是第 $i$ 个全局节点的坐标。\n\n我们计算四个全局节点中每个节点的位移：\n对于节点 $1$，位于 $x_1 = 0$：\n$$d_1 = u(x_1) = u(0) = a + B(0) = a = 1.5 \\times 10^{-3} \\text{ 米}$$\n\n对于节点 $2$，位于 $x_2 = 0.3$：\n$$d_2 = u(x_2) = u(0.3) = a + B(0.3) = (1.5 \\times 10^{-3}) + (5.0 \\times 10^{-3})(0.3) = 1.5 \\times 10^{-3} + 1.5 \\times 10^{-3} = 3.0 \\times 10^{-3} \\text{ 米}$$\n\n对于节点 $3$，位于 $x_3 = 0.6$：\n$$d_3 = u(x_3) = u(0.6) = a + B(0.6) = (1.5 \\times 10^{-3}) + (5.0 \\times 10^{-3})(0.6) = 1.5 \\times 10^{-3} + 3.0 \\times 10^{-3} = 4.5 \\times 10^{-3} \\text{ 米}$$\n\n对于节点 $4$，位于 $x_4 = 0.9$：\n$$d_4 = u(x_4) = u(0.9) = a + B(0.9) = (1.5 \\times 10^{-3}) + (5.0 \\times 10^{-3})(0.9) = 1.5 \\times 10^{-3} + 4.5 \\times 10^{-3} = 6.0 \\times 10^{-3} \\text{ 米}$$\n\n因此，全局节点位移向量 $\\mathbf{d}$ 为：\n$$\\mathbf{d} = \\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\\\ d_4 \\end{pmatrix} = \\begin{pmatrix} 1.5 \\times 10^{-3} \\\\ 3.0 \\times 10^{-3} \\\\ 4.5 \\times 10^{-3} \\\\ 6.0 \\times 10^{-3} \\end{pmatrix} \\text{ 米}$$\n\n接下来，我们必须验证插值场在节点处等于精确场。单个双节点单元内的插值位移场 $u_h^{(e)}(x)$ 是使用单元的线性 Lagrange 形函数 $N_1^{(e)}(x)$ 和 $N_2^{(e)}(x)$ 及其节点位移 $d_1^{(e)}$ 和 $d_2^{(e)}$ 构建的：\n$$u_h^{(e)}(x) = N_1^{(e)}(x) d_1^{(e)} + N_2^{(e)}(x) d_2^{(e)}$$\n单元的节点位移通过插值精确场获得，因此 $d_1^{(e)} = u(x_1^{(e)})$ 和 $d_2^{(e)} = u(x_2^{(e)})$，其中 $x_1^{(e)}$ 和 $x_2^{(e)}$ 是单元局部节点的坐标。\n\nLagrange 形函数在节点处具有 Kronecker delta 性质。这意味着，对于与节点 $i$ 相关联的形函数 $N_i$，其在节点 $i$ 处的值为 1，在单元的所有其他节点处的值为 0。对于一个具有局部节点 1 和 2 的双节点单元：\n$$N_1^{(e)}(x_1^{(e)}) = 1, \\quad N_1^{(e)}(x_2^{(e)}) = 0$$\n$$N_2^{(e)}(x_1^{(e)}) = 0, \\quad N_2^{(e)}(x_2^{(e)}) = 1$$\n\n为了验证在单元第一个节点处的插值场，我们在 $x = x_1^{(e)}$ 处计算 $u_h^{(e)}(x)$：\n$$u_h^{(e)}(x_1^{(e)}) = N_1^{(e)}(x_1^{(e)}) d_1^{(e)} + N_2^{(e)}(x_1^{(e)}) d_2^{(e)}$$\n代入形函数值和节点位移：\n$$u_h^{(e)}(x_1^{(e)}) = (1) \\cdot u(x_1^{(e)}) + (0) \\cdot u(x_2^{(e)}) = u(x_1^{(e)})$$\n\n类似地，对于单元在 $x = x_2^{(e)}$ 处的第二个节点：\n$$u_h^{(e)}(x_2^{(e)}) = N_1^{(e)}(x_2^{(e)}) d_1^{(e)} + N_2^{(e)}(x_2^{(e)}) d_2^{(e)}$$\n$$u_h^{(e)}(x_2^{(e)}) = (0) \\cdot u(x_1^{(e)}) + (1) \\cdot u(x_2^{(e)}) = u(x_2^{(e)})$$\n这表明对于任何单元，根据构造，插值场在节点处的值与精确场在该同一节点处的值是相同的。这个性质对网格中的所有三个单元都成立，因此也对所有全局节点成立。验证完成。\n\n有限元法的一个基本性质是，如果精确解是 $p$ 次多项式，并且单元使用的形函数是次数为 $k \\ge p$ 的多项式，那么通过插值得到的有限元解将不仅在节点处精确，而且在整个域内都精确。在这个问题中，精确场 $u(x)$ 是一个次数为 $p=1$ 的多项式，而双节点 Lagrange 单元使用线性形函数，这也是次数为 $k=1$ 的多项式。由于 $k=p$，插值场 $u_h(x)$ 对于所有 $x \\in [0, 0.9]$ 都与精确场 $u(x)$ 完全相同。在节点处的验证是这个一般性原理的一个特例。\n\n最终答案是推导出的全局节点位移向量。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.5 \\times 10^{-3} \\\\ 3.0 \\times 10^{-3} \\\\ 4.5 \\times 10^{-3} \\\\ 6.0 \\times 10^{-3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了场插值之后，我们接着处理离散化中的几何问题：如何将一个简单的“母单元”映射到物理空间中的复杂形状。这个实践的核心是雅可比行列式（Jacobian determinant），它是一个关键的量，其符号决定了单元的几何映射是否有效，或者是否出现了病态的扭曲。通过计算一个非凸四边形单元的雅可比行列式，你将获得识别和避免无效网格单元的实践经验。",
            "id": "3565546",
            "problem": "考虑一个用于在计算固体力学中离散化固体域的四节点双线性等参四边形单元。该单元在父空间中由自然坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 定义，并通过双线性形函数映射到物理空间 $(x,y)$。物理空间中的节点坐标按局部节点编号 $1\\to2\\to3\\to4$ 的顺序给出，分别为 $\\boldsymbol{x}_1=(0,0)$、$\\boldsymbol{x}_2=(0,2)$、$\\boldsymbol{x}_3=(2,0)$ 和 $\\boldsymbol{x}_4=(2,2)$。使用标准的双线性等参映射，计算在标准 $2\\times 2$ 高斯-勒让德求积点 $(\\xi,\\eta)=\\left(\\pm\\frac{1}{\\sqrt{3}},\\pm\\frac{1}{\\sqrt{3}}\\right)$ 处的雅可比行列式 $J(\\xi,\\eta)=\\det\\left(\\partial(x,y)/\\partial(\\xi,\\eta)\\right)$ 及其绝对值 $|J(\\xi,\\eta)|$。确定在这些点中，是否有任何点违反了正性条件 $J(\\xi,\\eta)>0$。\n\n将您的最终答案表示为单个行矩阵，其中包含：\n- 首先是按 $(\\xi,\\eta)=\\left(-\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}\\right)$、$\\left(+\\frac{1}{\\sqrt{3}},-\\frac{1}{\\sqrt{3}}\\right)$、$\\left(+\\frac{1}{\\sqrt{3}},+\\frac{1}{\\sqrt{3}}\\right)$、$\\left(-\\frac{1}{\\sqrt{3}},+\\frac{1}{\\sqrt{3}}\\right)$ 顺序排列的四个高斯点处的 $J$ 值，\n- 接着是按相同顺序排列的对应的四个 $|J|$ 值，\n- 最后是违反正性条件 $J(\\xi,\\eta)>0$ 的高斯点数量的整数计数。\n\n无需四舍五入。仅提供所要求的数字；最终答案中不包含单位。",
            "solution": "用户希望分析一个四节点双线性等参四边形单元。此过程涉及几个步骤：定义从父单元到物理单元的映射，计算该映射的雅可比行列式，然后在指定点评估其行列式以检查有效性。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- **单元类型**：四节点双线性等参四边形单元。\n- **父空间**：自然坐标 $(\\xi, \\eta)$ 在域 $[-1, 1] \\times [-1, 1]$ 内。\n- **物理空间节点坐标**：按局部节点编号 $1 \\to 2 \\to 3 \\to 4$ 的顺序给出：\n  - $\\boldsymbol{x}_1 = (x_1, y_1) = (0, 0)$\n  - $\\boldsymbol{x}_2 = (x_2, y_2) = (0, 2)$\n  - $\\boldsymbol{x}_3 = (x_3, y_3) = (2, 0)$\n  - $\\boldsymbol{x}_4 = (x_4, y_4) = (2, 2)$\n- **任务**：在四个标准的 $2 \\times 2$ 高斯-勒让德求积点处，计算雅可比行列式 $J(\\xi, \\eta)$ 及其绝对值 $|J(\\xi, \\eta)|$。\n- **高斯点**：$(\\xi, \\eta) = \\left(\\pm\\frac{1}{\\sqrt{3}}, \\pm\\frac{1}{\\sqrt{3}}\\right)$。\n- **正性条件**：确定违反 $J(\\xi, \\eta) > 0$ 的高斯点数量。\n- **输出顺序**：最终答案需要按以下顺序给出高斯点的 $J$ 值、$|J|$ 值和违规计数：\n  1. $(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$\n  2. $(+\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$\n  3. $(+\\frac{1}{\\sqrt{3}}, +\\frac{1}{\\sqrt{3}})$\n  4. $(-\\frac{1}{\\sqrt{3}}, +\\frac{1}{\\sqrt{3}})$\n\n**1.2. 使用提取的已知条件进行验证**\n该问题在科学上基于有限元法（FEM）的理论。它是一个适定问题，提供了计算唯一解所需的所有数据。节点坐标描述了一个非凸（“蝶形”或“沙漏形”）四边形，这是一种有效但扭曲的构型，用于测试单元公式的稳健性。检查雅可比行列式符号是有限元法中的一个标准程序，以确保从父单元到物理单元的映射是有效的一一映射。该问题是客观的，不包含任何科学缺陷、不一致或模糊之处。\n\n**1.3. 结论与操作**\n该问题有效。将提供完整的解答。\n\n### 步骤 2：定义等参映射\n\n对于四节点双线性等参单元，物理坐标 $(x, y)$ 是使用双线性形函数 $N_i(\\xi, \\eta)$ 从节点坐标插值得到的。父空间中的标准局部节点编号是逆时针方向的：\n- 节点 1：$(\\xi, \\eta) = (-1, -1)$\n- 节点 2：$(\\xi, \\eta) = (1, -1)$\n- 节点 3：$(\\xi, \\eta) = (1, 1)$\n- 节点 4：$(\\xi, \\eta) = (-1, 1)$\n\n相应的形函数是：\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\n问题陈述将给定的物理坐标 $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3, \\boldsymbol{x}_4$ 分别分配给局部节点 $1, 2, 3, 4$。等参映射为：\n$$ x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i $$\n$$ y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i $$\n\n代入给定的节点坐标：\n$x(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot 0 + N_2(\\xi, \\eta) \\cdot 0 + N_3(\\xi, \\eta) \\cdot 2 + N_4(\\xi, \\eta) \\cdot 2$\n$x(\\xi, \\eta) = 2(N_3(\\xi, \\eta) + N_4(\\xi, \\eta))$\n$x(\\xi, \\eta) = 2 \\left( \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) \\right)$\n$x(\\xi, \\eta) = \\frac{1}{2}(1+\\eta) \\left( (1+\\xi) + (1-\\xi) \\right) = \\frac{1}{2}(1+\\eta)(2) = 1+\\eta$\n\n$y(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot 0 + N_2(\\xi, \\eta) \\cdot 2 + N_3(\\xi, \\eta) \\cdot 0 + N_4(\\xi, \\eta) \\cdot 2$\n$y(\\xi, \\eta) = 2(N_2(\\xi, \\eta) + N_4(\\xi, \\eta))$\n$y(\\xi, \\eta) = 2 \\left( \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) \\right)$\n$y(\\xi, \\eta) = \\frac{1}{2} \\left( 1-\\eta+\\xi-\\xi\\eta + 1+\\eta-\\xi-\\xi\\eta \\right) = \\frac{1}{2}(2 - 2\\xi\\eta) = 1-\\xi\\eta$\n\n因此，从父空间到物理空间的映射由 $(x, y) = (1+\\eta, 1-\\xi\\eta)$ 给出。\n\n### 步骤 3：计算雅可比矩阵及其行列式\n\n变换的雅可比矩阵 $\\mathbf{J}$ 定义为：\n$$ \\mathbf{J}(\\xi, \\eta) = \\frac{\\partial(x, y)}{\\partial(\\xi, \\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} $$\n\n我们计算所需的偏导数：\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(1+\\eta) = 0$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(1+\\eta) = 1$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(1-\\xi\\eta) = -\\eta$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(1-\\xi\\eta) = -\\xi$\n\n组装雅可比矩阵：\n$$ \\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} 0 & 1 \\\\ -\\eta & -\\xi \\end{pmatrix} $$\n\n雅可比行列式，记为 $J(\\xi, \\eta)$，是：\n$$ J(\\xi, \\eta) = \\det(\\mathbf{J}) = (0)(-\\xi) - (1)(-\\eta) = \\eta $$\n\n### 步骤 4：在高斯求积点处求值\n\n我们需要在四个高斯点处评估 $J(\\xi, \\eta) = \\eta$ 和 $|J(\\xi, \\eta)|=|\\eta|$，并遵循指定的顺序。令 $a = \\frac{1}{\\sqrt{3}}$。\n\n1.  **点 1**：$(\\xi_1, \\eta_1) = (-a, -a) = \\left(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right)$\n    $J_1 = \\eta_1 = -\\frac{1}{\\sqrt{3}}$\n    $|J_1| = \\left|-\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n2.  **点 2**：$(\\xi_2, \\eta_2) = (a, -a) = \\left(\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right)$\n    $J_2 = \\eta_2 = -\\frac{1}{\\sqrt{3}}$\n    $|J_2| = \\left|-\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n3.  **点 3**：$(\\xi_3, \\eta_3) = (a, a) = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$\n    $J_3 = \\eta_3 = \\frac{1}{\\sqrt{3}}$\n    $|J_3| = \\left|\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n4.  **点 4**：$(\\xi_4, \\eta_4) = (-a, a) = \\left(-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$\n    $J_4 = \\eta_4 = \\frac{1}{\\sqrt{3}}$\n    $|J_4| = \\left|\\frac{1}{\\sqrt{3}}\\right| = \\frac{1}{\\sqrt{3}}$\n\n### 步骤 5：检查正性条件是否被违反\n\n正性条件 $J(\\xi, \\eta) > 0$ 确保映射是有效的（保向的）。如果 $J(\\xi, \\eta) \\le 0$，则发生违反。\n\n-   在点 1：$J_1 = -\\frac{1}{\\sqrt{3}}  0$。**违反**。\n-   在点 2：$J_2 = -\\frac{1}{\\sqrt{3}}  0$。**违反**。\n-   在点 3：$J_3 = \\frac{1}{\\sqrt{3}}  0$。未违反。\n-   在点 4：$J_4 = \\frac{1}{\\sqrt{3}}  0$。未违反。\n\n违反正性条件的高斯点总数为 $2$。\n\n### 步骤 6：组装最终答案\n\n最终答案是一个行矩阵，包含四个 $J$ 的值、四个 $|J|$ 的值和违规计数，按指定顺序排列。\n\n-   $J$ 的值：$-\\frac{1}{\\sqrt{3}}$, $-\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$\n-   $|J|$ 的值：$\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$, $\\frac{1}{\\sqrt{3}}$\n-   违规计数：$2$\n\n这将得到最终的矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{\\sqrt{3}}  -\\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的这项综合性实践将场和域的离散化概念结合起来，用于构建静态分析的核心：单元刚度矩阵。你将从第一性原理出发，推导并实现一个三维四面体单元的应变-位移矩阵（$B$ 矩阵）和刚度矩阵（$k_e$）。通过将你的实现应用于包括几何扭曲和材料近似不可压缩性在内的多种情况，你将深入理解这些因素如何影响单元的力学行为和计算稳定性。",
            "id": "3565565",
            "problem": "你需要使用单个线性四面体有限元，为三维小应变各向同性线弹性问题推导、实现并评估应变-位移矩阵和一致单元刚度。从虚功原理和小应变定义出发，得到离散形式。然后，为每个指定的测试用例，计算并报告所要求的标量不变量。\n\n从以下基本依据和核心定义开始：\n- 由 $\\,\\varepsilon_{ij} = \\tfrac{1}{2}\\left(u_{i,j}+u_{j,i}\\right)\\,$ 定义的小应变张量 $\\,\\boldsymbol{\\varepsilon}(\\mathbf{u})\\,$。\n- 各向同性线弹性固体（胡克定律）的本构关系 $\\,\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}\\,$，其中 $\\,\\mathbb{C}\\,$ 取决于杨氏模量 $\\,E\\,$ 和泊松比 $\\,\\nu\\,$。\n- 在单个单元域 $\\,\\Omega_e\\,$ 上，无体力作用下静力平衡的虚功原理的 Galerkin 形式，通过形函数进行空间离散化后可得到单元刚度。\n\n在一个线性四面体上，位移场由四个标量形函数 $\\,N_a(\\mathbf{x})\\,$, $\\,a\\in\\{1,2,3,4\\}\\,$ 插值得到，这些形函数在节点处满足 $\\,N_a(\\mathbf{x}_b) = \\delta_{ab}\\,$。每个 $\\,N_a\\,$ 都是仿射的，形式为 $\\,N_a(x,y,z) = a_a + b_a x + c_a y + d_a z\\,$。通过强制施加克罗内克 delta 性质来确定这些系数。梯度 $\\,\\nabla N_a\\,$ 在整个单元上是常数，并定义了线性四面体的应变-位移矩阵 $\\,\\mathbf{B}\\,$。对于三维弹性问题，采用工程应变向量排序 $\\,\\{\\varepsilon_{xx},\\varepsilon_{yy},\\varepsilon_{zz},\\gamma_{yz},\\gamma_{zx},\\gamma_{xy}\\}^{\\mathsf{T}}\\,$，相应地组装 $\\,\\mathbf{B}\\in\\mathbb{R}^{6\\times 12}\\,$。\n\n对于三维空间中的各向同性弹性矩阵 $\\,\\mathbf{D}\\in\\mathbb{R}^{6\\times 6}\\,$，使用由 $\\,E\\,$ 和 $\\,\\nu\\,$ 定义的 Lamé 参数 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$，以及与所选工程应变向量一致的标准 $\\,6\\times 6\\,$ 表示。\n\n一致单元刚度通过在单元上对双线性形式进行积分得到，对于线性四面体单元，这简化为常数被积函数乘以单元体积。\n\n实现一个程序，为每个测试用例计算：\n- 以 $\\,\\mathrm{m}^3\\,$ 为单位的单元体积 $\\,V\\,$，\n- 以 $\\,\\mathrm{m}^{-1}\\,$ 为单位的应变-位移矩阵的 Frobenius 范数 $\\,\\lVert \\mathbf{B}\\rVert_F\\,$，\n- 以 $\\,\\mathrm{N/m}\\,$ 为单位的单元刚度的 Frobenius 范数 $\\,\\lVert \\mathbf{k}_e\\rVert_F\\,$，\n- 以 $\\,\\mathrm{N/m}\\,$ 为单位的单元刚度的迹 $\\,\\mathrm{tr}(\\mathbf{k}_e)\\,$。\n\n所有答案必须使用国际单位制 (SI) 表示。不涉及角度。每个测试用例的四个输出均以实数形式报告。\n\n测试套件（每个用例由节点坐标和材料属性定义）：\n- 用例 $\\,1\\,$ (基准单位四面体): 节点位于 $\\,\\mathbf{x}_1=(0,0,0)\\,$, $\\,\\mathbf{x}_2=(1,0,0)\\,$, $\\,\\mathbf{x}_3=(0,1,0)\\,$, $\\,\\mathbf{x}_4=(0,0,1)\\,$，材料属性为 $\\,E=2.10\\times 10^{11}\\,\\mathrm{Pa}\\,$ 和 $\\,\\nu=0.3\\,$。\n- 用例 $\\,2\\,$ (几何尺寸缩放因子为 $\\,2\\,$): 节点位于 $\\,\\mathbf{x}_1=(0,0,0)\\,$, $\\,\\mathbf{x}_2=(2,0,0)\\,$, $\\,\\mathbf{x}_3=(0,2,0)\\,$, $\\,\\mathbf{x}_4=(0,0,2)\\,$，材料属性为 $\\,E=2.10\\times 10^{11}\\,\\mathrm{Pa}\\,$ 和 $\\,\\nu=0.3\\,$。\n- 用例 $\\,3\\,$ (扭曲四面体): 节点位于 $\\,\\mathbf{x}_1=(1.0,-1.0,0.5)\\,$, $\\,\\mathbf{x}_2=(2.0,0.2,-0.3)\\,$, $\\,\\mathbf{x}_3=(0.3,1.7,0.4)\\,$, $\\,\\mathbf{x}_4=(-0.5,-0.6,1.2)\\,$，材料属性为 $\\,E=7.0\\times 10^{10}\\,\\mathrm{Pa}\\,$ 和 $\\,\\nu=0.25\\,$。\n- 用例 $\\,4\\,$ (近乎退化的体积): 节点位于 $\\,\\mathbf{x}_1=(0,0,0)\\,$, $\\,\\mathbf{x}_2=(1,0,0)\\,$, $\\,\\mathbf{x}_3=(0,1.0\\times 10^{-2},0)\\,$, $\\,\\mathbf{x}_4=(0,0,1.0\\times 10^{-3})\\,$，材料属性为 $\\,E=1.0\\times 10^{10}\\,\\mathrm{Pa}\\,$ 和 $\\,\\nu=0.33\\,$。\n- 用例 $\\,5\\,$ (近乎不可压缩): 节点位于 $\\,\\mathbf{x}_1=(0,0,0)\\,$, $\\,\\mathbf{x}_2=(1,0,0)\\,$, $\\,\\mathbf{x}_3=(0,1,0)\\,$, $\\,\\mathbf{x}_4=(0,0,1)\\,$，材料属性为 $\\,E=1.0\\times 10^{6}\\,\\mathrm{Pa}\\,$ 和 $\\,\\nu=0.4999\\,$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，形式为一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个包含四个数字的子列表，顺序为 $[V,\\lVert \\mathbf{B}\\rVert_F,\\lVert \\mathbf{k}_e\\rVert_F,\\mathrm{tr}(\\mathbf{k}_e)]$。\n- 每个数字使用科学记数法表示，并精确到 $\\,10\\,$ 位有效数字。\n- 例如，总输出的格式必须类似于 $\\,\\big[\\,[v_1,b_1,k_1,t_1],[v_2,b_2,k_2,t_2],\\dots\\,\\big]\\,$，不含空格。\n\n你的任务是从第一性原理出发进行推导并实现计算，使得程序运行时能为上述五个用例输出所需的单行结果。",
            "solution": "我们从第一性原理出发，推导三维小应变各向同性弹性问题的线性四面体单元矩阵。设 $\\,\\Omega_e\\subset\\mathbb{R}^3\\,$ 为单元域，其节点位置为 $\\,\\mathbf{x}_a=(x_a,y_a,z_a)\\,$，其中 $\\,a\\in\\{1,2,3,4\\}\\,$。位移场 $\\,\\mathbf{u}(\\mathbf{x})\\,$ 通过形函数 $\\,N_a(\\mathbf{x})\\,$ 和节点位移向量 $\\,\\mathbf{d}_a\\in\\mathbb{R}^3\\,$ 近似为 $\\,\\mathbf{u}(\\mathbf{x})=\\sum_{a=1}^4 N_a(\\mathbf{x})\\,\\mathbf{d}_a\\,$。在小应变运动学中，应变张量为 $\\,\\boldsymbol{\\varepsilon}(\\mathbf{u})=\\tfrac{1}{2}\\left(\\nabla\\mathbf{u}+(\\nabla\\mathbf{u})^{\\mathsf{T}}\\right)\\,$，其分量为 $\\,\\varepsilon_{ij}=\\tfrac{1}{2}\\left(u_{i,j}+u_{j,i}\\right)\\,$。\n\n对于线性四面体，每个形函数 $\\,N_a\\,$ 都是仿射的：\n$$\nN_a(x,y,z)=a_a + b_a x + c_a y + d_a z\\,,\n$$\n其插值条件为克罗内克 delta 形式 $\\,N_a(\\mathbf{x}_b)=\\delta_{ab}\\,$。对于每个 $\\,a\\,$，这四个条件构成一个 $\\,4\\times 4\\,$ 的线性系统。将节点位置收集到矩阵\n$$\n\\mathbf{M}=\\begin{bmatrix}\n1  x_1  y_1  z_1\\\\\n1  x_2  y_2  z_2\\\\\n1  x_3  y_3  z_3\\\\\n1  x_4  y_4  z_4\n\\end{bmatrix},\n$$\n中，并定义系数向量 $\\,\\boldsymbol{\\alpha}_a=\\begin{bmatrix}a_a  b_a  c_a  d_a\\end{bmatrix}^{\\mathsf{T}}\\,$。克罗内克条件可写作 $\\,\\mathbf{M}\\,\\boldsymbol{\\alpha}_a=\\mathbf{e}_a\\,$，其中 $\\,\\mathbf{e}_a\\,$ 是 $\\,\\mathbb{R}^4\\,$ 的第 $\\,a\\,$ 个标准基向量。因此，$\\,\\boldsymbol{\\alpha}_a=\\mathbf{M}^{-1}\\mathbf{e}_a\\,$，并且梯度在整个单元上是常数：\n$$\n\\nabla N_a = \\begin{bmatrix} \\dfrac{\\partial N_a}{\\partial x} \\\\ \\dfrac{\\partial N_a}{\\partial y} \\\\ \\dfrac{\\partial N_a}{\\partial z} \\end{bmatrix} = \\begin{bmatrix} b_a\\\\ c_a\\\\ d_a\\end{bmatrix} \\in \\mathbb{R}^3\\,.\n$$\n\n采用工程应变向量排序 $\\,\\boldsymbol{\\varepsilon}_\\mathrm{eng}=\\begin{bmatrix}\\varepsilon_{xx}  \\varepsilon_{yy}  \\varepsilon_{zz}  \\gamma_{yz}  \\gamma_{zx}  \\gamma_{xy}\\end{bmatrix}^{\\mathsf{T}}\\,$。应变-位移矩阵 $\\,\\mathbf{B}\\in\\mathbb{R}^{6\\times 12}\\,$ 由梯度 $\\,\\nabla N_a\\,$ 组装而成，使得 $\\,\\boldsymbol{\\varepsilon}_\\mathrm{eng}=\\mathbf{B}\\,\\mathbf{d}_e\\,$，其中 $\\,\\mathbf{d}_e\\in\\mathbb{R}^{12}\\,$ 堆叠了节点位移 $\\,\\mathbf{d}_1,\\dots,\\mathbf{d}_4\\,$。对于节点 $\\,a\\,$，其梯度分量为 $\\,b_a=\\partial N_a/\\partial x\\,$, $\\,c_a=\\partial N_a/\\partial y\\,$, $\\,d_a=\\partial N_a/\\partial z\\,$，则位于 $\\,\\mathbf{B}\\,$ 矩阵第 $\\,3(a-1)+1\\,$ 到 $\\,3a\\,$ 列的 $\\,3\\times 3\\,$ 分块矩阵为\n$$\n\\mathbf{B}_a=\\begin{bmatrix}\nb_a  0  0\\\\\n0  c_a  0\\\\\n0  0  d_a\\\\\n0  d_a  c_a\\\\\nd_a  0  b_a\\\\\nc_a  b_a  0\n\\end{bmatrix}.\n$$\n因此，$\\,\\mathbf{B}=\\begin{bmatrix}\\mathbf{B}_1  \\mathbf{B}_2  \\mathbf{B}_3  \\mathbf{B}_4\\end{bmatrix}\\,$。\n\n对于三维各向同性线弹性，柯西应力和工程应变通过 $\\,\\boldsymbol{\\sigma}_\\mathrm{eng}=\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_\\mathrm{eng}\\,$ 相关联，其中 $\\,\\mathbf{D}\\in\\mathbb{R}^{6\\times 6}\\,$ 使用 Lamé 参数 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$ 表示：\n$$\n\\lambda=\\frac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}\\,,\\qquad \\mu=\\frac{E}{2(1+\\nu)}\\,,\n$$\n以及\n$$\n\\mathbf{D}=\\begin{bmatrix}\n\\lambda+2\\mu  \\lambda  \\lambda  0  0  0\\\\\n\\lambda  \\lambda+2\\mu  \\lambda  0  0  0\\\\\n\\lambda  \\lambda  \\lambda+2\\mu  0  0  0\\\\\n0  0  0  \\mu  0  0\\\\\n0  0  0  0  \\mu  0\\\\\n0  0  0  0  0  \\mu\n\\end{bmatrix}.\n$$\n\n对于无体力的单个单元，虚功原理给出\n$$\n\\delta W_\\mathrm{int}=\\int_{\\Omega_e}\\boldsymbol{\\varepsilon}(\\delta\\mathbf{u}):\\boldsymbol{\\sigma}(\\mathbf{u})\\,\\mathrm{d}V\n=\\int_{\\Omega_e}\\boldsymbol{\\varepsilon}_\\mathrm{eng}(\\delta\\mathbf{u})^{\\mathsf{T}}\\,\\mathbf{D}\\,\\boldsymbol{\\varepsilon}_\\mathrm{eng}(\\mathbf{u})\\,\\mathrm{d}V\n=\\delta\\mathbf{d}_e^{\\mathsf{T}}\\left(\\int_{\\Omega_e}\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}\\,\\mathrm{d}V\\right)\\mathbf{d}_e\\,.\n$$\n因此，一致单元刚度为\n$$\n\\mathbf{k}_e=\\int_{\\Omega_e}\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}\\,\\mathrm{d}V\\,.\n$$\n对于线性四面体单元，$\\,\\mathbf{B}\\,$ 在 $\\,\\Omega_e\\,$ 上是常数，因此\n$$\n\\mathbf{k}_e=\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}\\,V\\,,\\qquad V=\\int_{\\Omega_e}\\mathrm{d}V\\,.\n$$\n\n单元体积 $\\,V\\,$ 可以从节点坐标获得。令\n$$\n\\mathbf{M}=\\begin{bmatrix}\n1  x_1  y_1  z_1\\\\\n1  x_2  y_2  z_2\\\\\n1  x_3  y_3  z_3\\\\\n1  x_4  y_4  z_4\n\\end{bmatrix}.\n$$\n则有向体积为 $\\,V_s=\\dfrac{\\det(\\mathbf{M})}{6}\\,$，物理体积为 $\\,V=|V_s|\\,.$ 这等价于 $\\,V=\\dfrac{1}{6}\\big|(\\mathbf{x}_2-\\mathbf{x}_1)\\cdot\\big((\\mathbf{x}_3-\\mathbf{x}_1)\\times(\\mathbf{x}_4-\\mathbf{x}_1)\\big)\\big|\\,.$。\n\n每个测试用例的算法步骤：\n1. 根据节点坐标组装 $\\,\\mathbf{M}\\,$ 并计算 $\\,\\mathbf{M}^{-1}\\,$。对于每个节点 $\\,a\\,$，提取 $\\,\\boldsymbol{\\alpha}_a=\\mathbf{M}^{-1}\\mathbf{e}_a\\,$，使得 $\\,\\nabla N_a=\\begin{bmatrix}b_a  c_a  d_a\\end{bmatrix}^{\\mathsf{T}}\\,$ 对应于 $\\,\\boldsymbol{\\alpha}_a\\,$ 的后三个分量。\n2. 通过放置由 $\\,b_a,c_a,d_a\\,$ 构建的 $\\,\\mathbf{B}_a\\,$ 分块来组装 $\\,\\mathbf{B}\\,$。\n3. 根据给定的 $\\,E\\,$ 和 $\\,\\nu\\,$ 计算 $\\,\\lambda\\,$ 和 $\\,\\mu\\,$，并组装 $\\,\\mathbf{D}\\,$。\n4. 计算 $\\,V=\\dfrac{|\\det(\\mathbf{M})|}{6}\\,$。\n5. 计算 $\\,\\mathbf{k}_e=\\mathbf{B}^{\\mathsf{T}}\\mathbf{D}\\mathbf{B}\\,V\\,$。\n6. 报告每个用例的四个标量：$\\,V\\,$、$\\,\\lVert \\mathbf{B}\\rVert_F=\\sqrt{\\sum_{i,j}B_{ij}^2}\\,$、$\\,\\lVert \\mathbf{k}_e\\rVert_F=\\sqrt{\\sum_{i,j}k_{e,ij}^2}\\,$ 和 $\\,\\mathrm{tr}(\\mathbf{k}_e)=\\sum_i k_{e,ii}\\,$。\n\n单位和条件数说明：\n- $\\,V\\,$ 的单位是 $\\,\\mathrm{m}^3\\,$。\n- $\\,\\mathbf{B}\\,$ 的元素与长度的倒数成比例，因此 $\\,\\lVert\\mathbf{B}\\rVert_F\\,$ 的单位是 $\\,\\mathrm{m}^{-1}\\,$。\n- $\\,\\mathbf{D}\\,$ 的单位是 $\\,\\mathrm{Pa}=\\mathrm{N/m}^2\\,$，所以 $\\,\\mathbf{k}_e\\,$ 的单位是 $\\,\\mathrm{N/m}\\,$。因此，$\\,\\lVert\\mathbf{k}_e\\rVert_F\\,$ 和 $\\,\\mathrm{tr}(\\mathbf{k}_e)\\,$ 的单位都是 $\\,\\mathrm{N/m}\\,$。\n- 由于刚体模态，单个单元刚度 $\\,\\mathbf{k}_e\\,$ 是秩亏的；其 Frobenius 范数和迹仍然是良定义且严格为正的。\n- 在用例 $\\,2\\,$ 中，将单元尺寸缩放因子 $\\,s=2\\,$，梯度会缩放 $\\,1/s\\,$，体积会缩放 $\\,s^3\\,$，因此 $\\,\\mathbf{k}_e\\,$ 会缩放 $\\,s\\,$，这提供了一致性检验。在用例 $\\,5\\,$ 中，$\\,\\nu\\to 0.5^{-}\\,$ 使得 $\\,\\lambda\\,$ 很大，主要增加了体积子空间中的刚度项。在用例 $\\,4\\,$ 中，小体积和大的梯度导致有限的 $\\,\\mathbf{k}_e\\,$，但增大了 $\\,\\lVert\\mathbf{B}\\rVert_F\\,$。\n\n实现完全遵循这些推导，并按要求将每个用例的标量打印在单行的方括号括起的列表之列表中，每个数字均采用科学记数法，精确到十位有效数字。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_shape_function_gradients(nodes):\n    \"\"\"\n    Compute gradients of linear tetrahedral shape functions.\n    nodes: (4,3) array with rows [x_i, y_i, z_i] for i=1..4\n    Returns:\n        grads: (3,4) array where column i is [dNi/dx, dNi/dy, dNi/dz]\n        volume: positive scalar volume\n    \"\"\"\n    M = np.column_stack((np.ones(4), nodes))  # 4x4\n    detM = np.linalg.det(M)\n    volume = abs(detM) / 6.0\n    invM = np.linalg.inv(M)\n    # invM columns correspond to coefficients [a_i, b_i, c_i, d_i] for N_i\n    grads = invM[1:, :]  # rows 1..3 are [b, c, d], shape (3,4)\n    return grads, volume\n\ndef assemble_B(grads):\n    \"\"\"\n    Assemble the 6x12 B matrix from gradients.\n    grads: (3,4) with columns [dNi/dx, dNi/dy, dNi/dz]\n    Returns:\n        B: (6,12) strain-displacement matrix\n    \"\"\"\n    B = np.zeros((6, 12), dtype=float)\n    for a in range(4):\n        bx, by, bz = grads[0, a], grads[1, a], grads[2, a]\n        col = 3 * a\n        # Normal strains\n        B[0, col + 0] = bx\n        B[1, col + 1] = by\n        B[2, col + 2] = bz\n        # Engineering shear strains\n        B[3, col + 1] = bz  # gamma_yz: [0, d/dz, d/dy]\n        B[3, col + 2] = by\n        B[4, col + 0] = bz  # gamma_zx: [d/dz, 0, d/dx]\n        B[4, col + 2] = bx\n        B[5, col + 0] = by  # gamma_xy: [d/dy, d/dx, 0]\n        B[5, col + 1] = bx\n    return B\n\ndef elasticity_matrix_3d(E, nu):\n    \"\"\"\n    Build the 6x6 isotropic elasticity matrix D for 3D using engineering strains.\n    \"\"\"\n    lam = E * nu / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    mu = E / (2.0 * (1.0 + nu))\n    D = np.zeros((6, 6), dtype=float)\n    # Normal components\n    D[0, 0] = lam + 2.0 * mu\n    D[1, 1] = lam + 2.0 * mu\n    D[2, 2] = lam + 2.0 * mu\n    D[0, 1] = lam\n    D[0, 2] = lam\n    D[1, 0] = lam\n    D[1, 2] = lam\n    D[2, 0] = lam\n    D[2, 1] = lam\n    # Shear components\n    D[3, 3] = mu\n    D[4, 4] = mu\n    D[5, 5] = mu\n    return D\n\ndef compute_element_invariants(nodes, E, nu):\n    \"\"\"\n    Compute V, ||B||_F, ||ke||_F, trace(ke) for a linear tetrahedral element.\n    \"\"\"\n    grads, V = compute_shape_function_gradients(nodes)\n    B = assemble_B(grads)\n    D = elasticity_matrix_3d(E, nu)\n    ke = B.T @ D @ B * V\n    # Invariants\n    Bnorm = float(np.linalg.norm(B, ord='fro'))\n    Kenorm = float(np.linalg.norm(ke, ord='fro'))\n    TrKe = float(np.trace(ke))\n    return V, Bnorm, Kenorm, TrKe\n\ndef format_results(results):\n    \"\"\"\n    Format results as a single-line nested list with scientific notation (10 significant digits).\n    \"\"\"\n    def fmt(x):\n        return f\"{x:.10e}\"\n    sublists = []\n    for V, Bn, Kn, Tr in results:\n        sublists.append(\"[\" + \",\".join([fmt(V), fmt(Bn), fmt(Kn), fmt(Tr)]) + \"]\")\n    return \"[\" + \",\".join(sublists) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Unit tetrahedron, E=2.10e11 Pa, nu=0.3\n        (np.array([[0.0, 0.0, 0.0],\n                   [1.0, 0.0, 0.0],\n                   [0.0, 1.0, 0.0],\n                   [0.0, 0.0, 1.0]], dtype=float),\n         2.10e11, 0.3),\n        # Case 2: Scaled by 2\n        (np.array([[0.0, 0.0, 0.0],\n                   [2.0, 0.0, 0.0],\n                   [0.0, 2.0, 0.0],\n                   [0.0, 0.0, 2.0]], dtype=float),\n         2.10e11, 0.3),\n        # Case 3: Skew tetrahedron, E=7.0e10 Pa, nu=0.25\n        (np.array([[ 1.0, -1.0,  0.5],\n                   [ 2.0,  0.2, -0.3],\n                   [ 0.3,  1.7,  0.4],\n                   [-0.5, -0.6,  1.2]], dtype=float),\n         7.0e10, 0.25),\n        # Case 4: Nearly degenerate, E=1.0e10 Pa, nu=0.33\n        (np.array([[0.0, 0.0, 0.0],\n                   [1.0, 0.0, 0.0],\n                   [0.0, 1.0e-2, 0.0],\n                   [0.0, 0.0, 1.0e-3]], dtype=float),\n         1.0e10, 0.33),\n        # Case 5: Nearly incompressible, E=1.0e6 Pa, nu=0.4999\n        (np.array([[0.0, 0.0, 0.0],\n                   [1.0, 0.0, 0.0],\n                   [0.0, 1.0, 0.0],\n                   [0.0, 0.0, 1.0]], dtype=float),\n         1.0e6, 0.4999),\n    ]\n\n    results = []\n    for nodes, E, nu in test_cases:\n        V, Bnorm, Kenorm, TrKe = compute_element_invariants(nodes, E, nu)\n        results.append((V, Bnorm, Kenorm, TrKe))\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}