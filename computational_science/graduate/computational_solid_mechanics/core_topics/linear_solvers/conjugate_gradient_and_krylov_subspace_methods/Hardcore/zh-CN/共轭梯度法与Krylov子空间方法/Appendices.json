{
    "hands_on_practices": [
        {
            "introduction": "共轭梯度法是求解有限元法中大型稀疏线性方程组的强大工具，但其应用有一个关键前提：系统矩阵必须是对称正定的（SPD）。本练习  将引导你从一个简单的一维弹性杆物理问题出发，通过有限元离散化，亲自推导并组集其刚度矩阵。通过计算该矩阵的特征值，你将亲手验证其对称正定性，从而深刻理解为何共轭梯度法适用于此类固体力学问题。",
            "id": "3550398",
            "problem": "考虑一根总长度为 $2h$、杨氏模量为 $E0$、横截面积为常数 $A0$ 的小应变一维线弹性杆。该杆被离散为 $2$ 个线性的两节点有限元，节点位于 $x_{0}=0$、$x_{1}=h$ 和 $x_{2}=2h$。在 $x=0$ 处施加齐次狄利克雷边界条件 $u(0)=0$，在 $x=2h$ 处施加无面力自然边界条件。有限元近似在每个单元上使用标准的线性形函数。\n\n从杆的内部弹性能由下式给出的基本原理出发：\n$$\n\\Pi_{\\text{int}}(u)=\\frac{1}{2}\\int_{0}^{2h}EA\\left(\\frac{du}{dx}\\right)^{2}\\,dx,\n$$\n并利用轴向平衡弱形式的伽辽金法以及单元级形函数及其空间导数的定义，完成以下任务：\n- 对于长度为 $h$ 的通用单元，推导其协调的 $2\\times 2$ 单元刚度矩阵，用 $E$ 和 $A$ 表示。\n- 为三节点网格组装全局刚度矩阵，然后施加 $x=0$ 处的狄利克雷边界条件，以获得与 $x=h$ 和 $x=2h$ 处未知节点位移相关的降阶 $2\\times 2$ 全局刚度矩阵。\n- 以闭合形式计算降阶 $2\\times 2$ 全局刚度矩阵的特征值，并用它们来证明该矩阵是对称正定的，从而确保共轭梯度（CG）法在该问题的克雷洛夫子空间框架内收敛。\n\n将最终的特征值表示为包含 $E$、$A$ 和 $h$ 的闭合形式解析表达式。无需进行数值代入或四舍五入。以一对特征值的形式提供您的最终答案。",
            "solution": "该问题由小应变下的一维线弹性理论控制。内部弹性能泛函为\n$$\n\\Pi_{\\text{int}}(u)=\\frac{1}{2}\\int_{0}^{2h}EA\\left(\\frac{du}{dx}\\right)^{2}\\,dx,\n$$\n其中 $E0$ 是杨氏模量，$A0$ 是横截面积。轴向平衡的弱形式可以通过要求总势能对所有容许变分的一阶变分为零来推导：\n$$\n\\delta \\Pi_{\\text{int}}(u)=\\int_{0}^{2h}EA\\left(\\frac{du}{dx}\\right)\\left(\\frac{d\\,\\delta u}{dx}\\right)\\,dx=0,\n$$\n在没有体力且在 $x=2h$ 处为无面力边界的情况下。使用伽辽金法和有限元近似 $u(x)\\approx \\sum_{i}N_{i}(x)u_{i}$ 以及线性形函数，单元刚度矩阵的各项可由下式得出：\n$$\nk^{(e)}_{ij}=\\int_{x_{e}}^{x_{e}+h}EA\\,\\frac{dN_{i}}{dx}\\,\\frac{dN_{j}}{dx}\\,dx,\n$$\n对于一个跨越 $[x_{e},x_{e}+h]$ 的通用单元 $e$。\n\n对于位于 $[x_{e},x_{e}+h]$ 上的线性两节点单元，其形函数为\n$$\nN_{1}(x)=\\frac{x_{e}+h-x}{h},\\qquad N_{2}(x)=\\frac{x-x_{e}}{h},\n$$\n其空间导数在单元上是常数：\n$$\n\\frac{dN_{1}}{dx}=-\\frac{1}{h},\\qquad \\frac{dN_{2}}{dx}=\\frac{1}{h}.\n$$\n因此，\n$$\nk^{(e)}_{11}=\\int_{x_{e}}^{x_{e}+h}EA\\left(-\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right)\\,dx=\\frac{EA}{h},\\quad\nk^{(e)}_{12}=\\int_{x_{e}}^{x_{e}+h}EA\\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right)\\,dx=-\\frac{EA}{h},\n$$\n$$\nk^{(e)}_{21}=\\int_{x_{e}}^{x_{e}+h}EA\\left(\\frac{1}{h}\\right)\\left(-\\frac{1}{h}\\right)\\,dx=-\\frac{EA}{h},\\quad\nk^{(e)}_{22}=\\int_{x_{e}}^{x_{e}+h}EA\\left(\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right)\\,dx=\\frac{EA}{h}.\n$$\n因此，协调的单元刚度矩阵为\n$$\n\\mathbf{K}^{(e)}=\\frac{EA}{h}\\begin{bmatrix}1  -1 \\\\ -1  1\\end{bmatrix}.\n$$\n\n现在我们为节点位于 $x_{0}=0$、$x_{1}=h$ 和 $x_{2}=2h$ 的网格组装全局刚度矩阵。单元 $1$ 连接节点 $(0,1)$，单元 $2$ 连接节点 $(1,2)$。组装各单元的贡献得到全局 $3\\times 3$ 刚度矩阵\n$$\n\\mathbf{K}=\\frac{EA}{h}\\begin{bmatrix}\n1  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  1\n\\end{bmatrix}.\n$$\n齐次狄利克雷边界条件 $u(0)=0$ 消除了节点 $0$ 处的自由度，从而得到与节点 $1$ 和 $2$ 处的未知位移相关的降阶 $2\\times 2$ 全局刚度矩阵：\n$$\n\\mathbf{K}_{r}=\\frac{EA}{h}\\begin{bmatrix}\n2  -1 \\\\\n-1  1\n\\end{bmatrix}.\n$$\n\n为了验证对称正定性并与克雷洛夫子空间方法中对共轭梯度（CG）法的收敛性保证相联系，我们计算 $\\mathbf{K}_{r}$ 的特征值。令\n$$\n\\mathbf{M}=\\begin{bmatrix}\n2  -1 \\\\\n-1  1\n\\end{bmatrix}.\n$$\n$\\mathbf{M}$ 的特征多项式为\n$$\np(\\lambda)=\\det(\\mathbf{M}-\\lambda \\mathbf{I})=\\det\\begin{bmatrix}2-\\lambda  -1 \\\\ -1  1-\\lambda\\end{bmatrix}=(2-\\lambda)(1-\\lambda)-1=\\lambda^{2}-3\\lambda+1.\n$$\n$\\mathbf{M}$ 的特征值是 $p(\\lambda)=0$ 的根：\n$$\n\\lambda_{1,2}=\\frac{3\\pm\\sqrt{9-4}}{2}=\\frac{3\\pm\\sqrt{5}}{2}.\n$$\n因此，$\\mathbf{K}_{r}=(EA/h)\\,\\mathbf{M}$ 的特征值为\n$$\n\\mu_{1}=\\frac{EA}{h}\\cdot\\frac{3-\\sqrt{5}}{2},\\qquad \\mu_{2}=\\frac{EA}{h}\\cdot\\frac{3+\\sqrt{5}}{2}.\n$$\n由于 $E0$，$A0$，$h0$，且 $(3\\pm\\sqrt{5})/20$ 均成立，我们有 $\\mu_{1}0$ 和 $\\mu_{2}0$。因此，$\\mathbf{K}_{r}$ 是对称正定的。该性质保证了共轭梯度（CG）法（一种专门用于对称正定系统的克雷洛夫子空间方法）对于此离散化问题将收敛，其收敛速率受条件数 $\\kappa(\\mathbf{K}_{r})=\\mu_{2}/\\mu_{1}$ 的影响。\n\n因此，所需的闭合形式特征值已如上文明确地用 $E$、$A$ 和 $h$ 表示。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{EA}{2h}\\left(3-\\sqrt{5}\\right)  \\dfrac{EA}{2h}\\left(3+\\sqrt{5}\\right)\\end{pmatrix}}$$"
        },
        {
            "introduction": "理解了共轭梯度法为何适用之后，下一步是揭开其算法的“黑箱”，探究其具体工作流程。该算法通过构造一组关于系统矩阵 $A$ 共轭（或称 $A$-正交）的搜索方向来迭代逼近最优解。本练习  将让你为一个具体的 $3 \\times 3$ SPD 系统手动执行前两次 CG 迭代，计算每一步的迭代解、残差和搜索方向，并验证搜索方向之间的 $A$-共轭性，从而深入理解算法的核心机制。",
            "id": "3550427",
            "problem": "在一个通过有限元法（FEM）离散化的小应变线性弹性边值问题中，平衡方程可简化为形如 $\\boldsymbol{A} \\boldsymbol{x} = \\boldsymbol{b}$ 的对称正定（SPD）线性系统，其中 $\\boldsymbol{A}$ 是全局刚度矩阵，$\\boldsymbol{b}$ 是载荷向量。解 $\\boldsymbol{x}$ 使二次势能泛函 $E(\\boldsymbol{x}) = \\tfrac{1}{2} \\boldsymbol{x}^{\\top} \\boldsymbol{A} \\boldsymbol{x} - \\boldsymbol{b}^{\\top} \\boldsymbol{x}$ 最小化。共轭梯度（CG）法通过在由初始残差和 $\\boldsymbol{A}$ 在欧几里得内积下生成的逐次 Krylov 子空间上最小化该泛函来构造迭代解。\n\n考虑将非预处理的 CG 方法应用于具有以下参数的 SPD 系统：\n$$\n\\boldsymbol{A} = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix}, \n\\quad\n\\boldsymbol{b} = \\begin{pmatrix}\n4 \\\\\n2 \\\\\n2\n\\end{pmatrix},\n\\quad\n\\boldsymbol{x}_0 = \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}.\n$$\n使用标准的非预处理共轭梯度（CG）法（其中 $\\boldsymbol{p}_0 = \\boldsymbol{r}_0$ 且使用欧几里得内积）执行恰好两次迭代。计算第一次和第二次的迭代解 $\\boldsymbol{x}_1$ 和 $\\boldsymbol{x}_2$，相应的残差 $\\boldsymbol{r}_1$ 和 $\\boldsymbol{r}_2$，并对前两个搜索方向 $\\boldsymbol{p}_0$ 和 $\\boldsymbol{p}_1$ 验证 A-共轭条件 $\\boldsymbol{p}_0^{\\top} \\boldsymbol{A} \\boldsymbol{p}_1 = 0$。\n\n最后，将 $\\boldsymbol{p}_0^{\\top} \\boldsymbol{A} \\boldsymbol{p}_1$ 的值作为你的唯一数值答案报告。无需四舍五入。",
            "solution": "该问题提法恰当，具有科学依据，并包含了进行求解所需的所有必要信息。矩阵 $\\boldsymbol{A}$ 是对称的，其正定性可以通过验证其所有顺序主子式均为正来确认：\n$D_1 = \\det([4]) = 4  0$。\n$D_2 = \\det \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} = 4(3) - 1(1) = 11  0$。\n$D_3 = \\det(\\boldsymbol{A}) = 4(3 \\cdot 2 - 1 \\cdot 1) - 1(1 \\cdot 2 - 1 \\cdot 0) = 4(5) - 1(2) = 18  0$。\n由于所有顺序主子式均为正，矩阵 $\\boldsymbol{A}$ 是对称正定（SPD）的，这是标准共轭梯度（CG）法的一个先决条件。因此，该问题是有效的。\n\n用于求解 $\\boldsymbol{A} \\boldsymbol{x} = \\boldsymbol{b}$ 且初始猜测为 $\\boldsymbol{x}_0$ 的非预处理 CG 算法如下：\n初始化：\n$\\boldsymbol{r}_0 = \\boldsymbol{b} - \\boldsymbol{A} \\boldsymbol{x}_0$\n$\\boldsymbol{p}_0 = \\boldsymbol{r}_0$\n对于 $k=0, 1, 2, \\dots$\n$\\alpha_k = \\frac{\\boldsymbol{r}_k^{\\top} \\boldsymbol{r}_k}{\\boldsymbol{p}_k^{\\top} \\boldsymbol{A} \\boldsymbol{p}_k}$\n$\\boldsymbol{x}_{k+1} = \\boldsymbol{x}_k + \\alpha_k \\boldsymbol{p}_k$\n$\\boldsymbol{r}_{k+1} = \\boldsymbol{r}_k - \\alpha_k \\boldsymbol{A} \\boldsymbol{p}_k$\n$\\beta_k = \\frac{\\boldsymbol{r}_{k+1}^{\\top} \\boldsymbol{r}_{k+1}}{\\boldsymbol{r}_k^{\\top} \\boldsymbol{r}_k}$\n$\\boldsymbol{p}_{k+1} = \\boldsymbol{r}_{k+1} + \\beta_k \\boldsymbol{p}_k$\n\n给定：\n$$\n\\boldsymbol{A} = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix}, \n\\quad\n\\boldsymbol{b} = \\begin{pmatrix}\n4 \\\\\n2 \\\\\n2\n\\end{pmatrix},\n\\quad\n\\boldsymbol{x}_0 = \\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n\n**迭代 $k=0$**\n\n1.  计算初始残差 $\\boldsymbol{r}_0$：\n    $$\n    \\boldsymbol{r}_0 = \\boldsymbol{b} - \\boldsymbol{A} \\boldsymbol{x}_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} - \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}\n    $$\n2.  设置初始搜索方向 $\\boldsymbol{p}_0$：\n    $$\n    \\boldsymbol{p}_0 = \\boldsymbol{r}_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}\n    $$\n3.  计算步长 $\\alpha_0$：\n    首先，计算分子 $\\boldsymbol{r}_0^{\\top} \\boldsymbol{r}_0$：\n    $$\n    \\boldsymbol{r}_0^{\\top} \\boldsymbol{r}_0 = \\begin{pmatrix} 4  2  2 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = 4^2 + 2^2 + 2^2 = 16 + 4 + 4 = 24\n    $$\n    接下来，计算分母 $\\boldsymbol{p}_0^{\\top} \\boldsymbol{A} \\boldsymbol{p}_0$。我们首先需要计算 $\\boldsymbol{A} \\boldsymbol{p}_0$：\n    $$\n    \\boldsymbol{A} \\boldsymbol{p}_0 = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 4(4) + 1(2) + 0(2) \\\\ 1(4) + 3(2) + 1(2) \\\\ 0(4) + 1(2) + 2(2) \\end{pmatrix} = \\begin{pmatrix} 18 \\\\ 12 \\\\ 6 \\end{pmatrix}\n    $$\n    然后，计算 $\\boldsymbol{p}_0^{\\top} (\\boldsymbol{A} \\boldsymbol{p}_0)$：\n    $$\n    \\boldsymbol{p}_0^{\\top} \\boldsymbol{A} \\boldsymbol{p}_0 = \\begin{pmatrix} 4  2  2 \\end{pmatrix} \\begin{pmatrix} 18 \\\\ 12 \\\\ 6 \\end{pmatrix} = 4(18) + 2(12) + 2(6) = 72 + 24 + 12 = 108\n    $$\n    步长 $\\alpha_0$ 为：\n    $$\n    \\alpha_0 = \\frac{\\boldsymbol{r}_0^{\\top} \\boldsymbol{r}_0}{\\boldsymbol{p}_0^{\\top} \\boldsymbol{A} \\boldsymbol{p}_0} = \\frac{24}{108} = \\frac{2}{9}\n    $$\n4.  更新解以得到 $\\boldsymbol{x}_1$：\n    $$\n    \\boldsymbol{x}_1 = \\boldsymbol{x}_0 + \\alpha_0 \\boldsymbol{p}_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{2}{9} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{8}{9} \\\\ \\frac{4}{9} \\\\ \\frac{4}{9} \\end{pmatrix}\n    $$\n5.  更新残差以得到 $\\boldsymbol{r}_1$：\n    $$\n    \\boldsymbol{r}_1 = \\boldsymbol{r}_0 - \\alpha_0 \\boldsymbol{A} \\boldsymbol{p}_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} - \\frac{2}{9} \\begin{pmatrix} 18 \\\\ 12 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} - \\begin{pmatrix} 4 \\\\ \\frac{8}{3} \\\\ \\frac{4}{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2 - \\frac{8}{3} \\\\ 2 - \\frac{4}{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix}\n    $$\n6.  计算 $\\beta_0$ 以找到下一个搜索方向：\n    首先，计算 $\\boldsymbol{r}_1^{\\top} \\boldsymbol{r}_1$：\n    $$\n    \\boldsymbol{r}_1^{\\top} \\boldsymbol{r}_1 = \\begin{pmatrix} 0  -\\frac{2}{3}  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} = 0^2 + \\left(-\\frac{2}{3}\\right)^2 + \\left(\\frac{2}{3}\\right)^2 = \\frac{4}{9} + \\frac{4}{9} = \\frac{8}{9}\n    $$\n    然后，计算 $\\beta_0$：\n    $$\n    \\beta_0 = \\frac{\\boldsymbol{r}_1^{\\top} \\boldsymbol{r}_1}{\\boldsymbol{r}_0^{\\top} \\boldsymbol{r}_0} = \\frac{8/9}{24} = \\frac{8}{9 \\cdot 24} = \\frac{1}{27}\n    $$\n7.  更新搜索方向以得到 $\\boldsymbol{p}_1$：\n    $$\n    \\boldsymbol{p}_1 = \\boldsymbol{r}_1 + \\beta_0 \\boldsymbol{p}_0 = \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} + \\frac{1}{27} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{27} \\\\ -\\frac{18}{27} + \\frac{2}{27} \\\\ \\frac{18}{27} + \\frac{2}{27} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{27} \\\\ -\\frac{16}{27} \\\\ \\frac{20}{27} \\end{pmatrix}\n    $$\n\n第一次迭代完成。我们得到了 $\\boldsymbol{x}_1$、$\\boldsymbol{r}_1$ 和 $\\boldsymbol{p}_1$。\n\n**迭代 $k=1$**\n\n1.  计算步长 $\\alpha_1$：\n    分子是 $\\boldsymbol{r}_1^{\\top} \\boldsymbol{r}_1 = \\frac{8}{9}$。\n    对于分母，我们首先计算 $\\boldsymbol{A} \\boldsymbol{p}_1$：\n    $$\n    \\boldsymbol{A} \\boldsymbol{p}_1 = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} \\frac{4}{27} \\\\ -\\frac{16}{27} \\\\ \\frac{20}{27} \\end{pmatrix} = \\frac{1}{27} \\begin{pmatrix} 4(4) + 1(-16) + 0(20) \\\\ 1(4) + 3(-16) + 1(20) \\\\ 0(4) + 1(-16) + 2(20) \\end{pmatrix} = \\frac{1}{27} \\begin{pmatrix} 0 \\\\ -24 \\\\ 24 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix}\n    $$\n    然后，计算 $\\boldsymbol{p}_1^{\\top} (\\boldsymbol{A} \\boldsymbol{p}_1)$：\n    $$\n    \\boldsymbol{p}_1^{\\top} \\boldsymbol{A} \\boldsymbol{p}_1 = \\begin{pmatrix} \\frac{4}{27}  -\\frac{16}{27}  \\frac{20}{27} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix} = \\frac{1}{27} \\left( 4(0) - 16\\left(-\\frac{8}{9}\\right) + 20\\left(\\frac{8}{9}\\right) \\right) = \\frac{1}{27} \\left( \\frac{128}{9} + \\frac{160}{9} \\right) = \\frac{1}{27} \\left( \\frac{288}{9} \\right) = \\frac{32}{27}\n    $$\n    步长 $\\alpha_1$ 为：\n    $$\n    \\alpha_1 = \\frac{\\boldsymbol{r}_1^{\\top} \\boldsymbol{r}_1}{\\boldsymbol{p}_1^{\\top} \\boldsymbol{A} \\boldsymbol{p}_1} = \\frac{8/9}{32/27} = \\frac{8}{9} \\cdot \\frac{27}{32} = \\frac{1}{1} \\cdot \\frac{3}{4} = \\frac{3}{4}\n    $$\n2.  更新解以得到 $\\boldsymbol{x}_2$：\n    $$\n    \\boldsymbol{x}_2 = \\boldsymbol{x}_1 + \\alpha_1 \\boldsymbol{p}_1 = \\begin{pmatrix} \\frac{8}{9} \\\\ \\frac{4}{9} \\\\ \\frac{4}{9} \\end{pmatrix} + \\frac{3}{4} \\begin{pmatrix} \\frac{4}{27} \\\\ -\\frac{16}{27} \\\\ \\frac{20}{27} \\end{pmatrix} = \\begin{pmatrix} \\frac{8}{9} \\\\ \\frac{4}{9} \\\\ \\frac{4}{9} \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{9} \\\\ -\\frac{4}{9} \\\\ \\frac{5}{9} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n    $$\n3.  更新残差以得到 $\\boldsymbol{r}_2$：\n    $$\n    \\boldsymbol{r}_2 = \\boldsymbol{r}_1 - \\alpha_1 \\boldsymbol{A} \\boldsymbol{p}_1 = \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} - \\frac{3}{4} \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -\\frac{2}{3} \\\\ \\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n    $$\n\n迭代解为 $\\boldsymbol{x}_1 = \\begin{pmatrix} 8/9 \\\\ 4/9 \\\\ 4/9 \\end{pmatrix}$ 和 $\\boldsymbol{x}_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}$。残差为 $\\boldsymbol{r}_1 = \\begin{pmatrix} 0 \\\\ -2/3 \\\\ 2/3 \\end{pmatrix}$ 和 $\\boldsymbol{r}_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。残差 $\\boldsymbol{r}_2$ 是零向量，这表明 $\\boldsymbol{x}_2$ 是精确解。这是可能的，因为对于一个 $N \\times N$ 的系统，在精确算术中，CG 保证最多在 $N$ 步内收敛，而这里 $N=3$。\n\n**A-共轭性验证与最终答案**\n\n问题要求验证 A-共轭条件 $\\boldsymbol{p}_0^{\\top} \\boldsymbol{A} \\boldsymbol{p}_1 = 0$ 并报告计算出的值。\n使用上面推导出的向量 $\\boldsymbol{p}_0$ 和 $\\boldsymbol{A} \\boldsymbol{p}_1$：\n$$\n\\boldsymbol{p}_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} \\quad \\text{和} \\quad \\boldsymbol{A} \\boldsymbol{p}_1 = \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix}\n$$\n我们计算标量积：\n$$\n\\boldsymbol{p}_0^{\\top} \\boldsymbol{A} \\boldsymbol{p}_1 = \\begin{pmatrix} 4  2  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -\\frac{8}{9} \\\\ \\frac{8}{9} \\end{pmatrix} = 4(0) + 2\\left(-\\frac{8}{9}\\right) + 2\\left(\\frac{8}{9}\\right) = 0 - \\frac{16}{9} + \\frac{16}{9} = 0\n$$\n条件得到验证；搜索方向是 A-共轭的。数值为 $0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "我们已经探讨了共轭梯度法“为何”适用以及“如何”运作，现在让我们深入其理论核心，看看这一切发生的“场所”。共轭梯度法以及相关的迭代方法，都是在一个被称为克雷洛夫子空间 (Krylov subspace) 的特殊向量空间中构造近似解。本练习  将引导你为一个给定的系统矩阵和初始残差，亲手构建克雷洛夫子空间的基向量，并验证它们的线性无关性，从而具象化理解 CG 方法的搜索空间，夯实其理论基础。",
            "id": "3550446",
            "problem": "在小应变线性弹性力学中，有限元法 (FEM) 会产生一个形式为 $\\boldsymbol{A} \\boldsymbol{x} = \\boldsymbol{b}$ 的线性系统，其中 $\\boldsymbol{A}$ 是离散化结构的对称刚度矩阵，$\\boldsymbol{x}$ 是节点位移向量，$\\boldsymbol{b}$ 是节点力向量。对于一个施加了适当本质边界条件的稳定结构，刚度矩阵 $\\boldsymbol{A}$ 是对称正定 (SPD) 的。克雷洛夫子空间方法，例如共轭梯度 (CG) 法，在由残差 $\\boldsymbol{r}_{0} = \\boldsymbol{b} - \\boldsymbol{A} \\boldsymbol{x}_{0}$ 生成的克雷洛夫子空间中构造迭代解。\n\n考虑一个由三自由度离散化产生的 $3 \\times 3$ 对称正定刚度矩阵\n$$\n\\boldsymbol{A} = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix},\n$$\n一个节点力向量\n$$\n\\boldsymbol{b} = \\begin{pmatrix}\n1 \\\\\n2 \\\\\n3\n\\end{pmatrix},\n$$\n以及初始猜测值 $\\boldsymbol{x}_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n\n仅使用基本定义，完成以下操作：\n1. 计算初始残差 $\\boldsymbol{r}_{0} = \\boldsymbol{b} - \\boldsymbol{A} \\boldsymbol{x}_{0}$。\n2. 使用克雷洛夫子空间的定义，显式地为 $\\mathcal{K}_{3}(\\boldsymbol{A}, \\boldsymbol{r}_{0})$ 构造一个基。\n3. 构建这三个向量的 $3 \\times 3$ 格拉姆矩阵，并通过基于行列式的准则评估它们的线性无关性。\n\n将您在步骤 3 中构建的格拉姆矩阵的行列式作为最终答案。无需四舍五入。最终答案必须是一个不带单位的实数。",
            "solution": "该问题经验证是有科学依据的、适定的、客观的、完整的且一致的。矩阵 $\\boldsymbol{A}$ 是对称的，其正定性可以通过西尔维斯特准则 (Sylvester's criterion) 来确认，因为它的所有顺序主子式都是正的：$4  0$，$4(3)-1(1) = 11  0$，以及 $\\det(\\boldsymbol{A}) = 4(3 \\cdot 2 - 1 \\cdot 1) - 1(1 \\cdot 2 - 1 \\cdot 0) = 4(5) - 2 = 18  0$。满足了一个有效问题的所有条件。\n\n求解过程按照问题陈述的要求分三步进行。\n\n步骤 1：计算初始残差 $\\boldsymbol{r}_{0}$。\n初始残差 $\\boldsymbol{r}_{0}$ 定义为 $\\boldsymbol{r}_{0} = \\boldsymbol{b} - \\boldsymbol{A} \\boldsymbol{x}_{0}$。给定节点力向量 $\\boldsymbol{b}$ 和位移向量的初始猜测值 $\\boldsymbol{x}_{0}$。\n$$\n\\boldsymbol{b} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}, \\quad \\boldsymbol{x}_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n乘积 $\\boldsymbol{A} \\boldsymbol{x}_{0}$ 为：\n$$\n\\boldsymbol{A} \\boldsymbol{x}_{0} = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n因此，初始残差为：\n$$\n\\boldsymbol{r}_{0} = \\boldsymbol{b} - \\boldsymbol{A} \\boldsymbol{x}_{0} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n\n步骤 2：构造克雷洛夫子空间 $\\mathcal{K}_{3}(\\boldsymbol{A}, \\boldsymbol{r}_{0})$ 的一个基。\n克雷洛夫子空间 $\\mathcal{K}_{k}(\\boldsymbol{A}, \\boldsymbol{r})$ 定义为向量集 $\\{\\boldsymbol{r}, \\boldsymbol{A}\\boldsymbol{r}, \\boldsymbol{A}^2\\boldsymbol{r}, \\dots, \\boldsymbol{A}^{k-1}\\boldsymbol{r}\\}$ 的张成空间。在本例中，$k=3$ 且生成向量为 $\\boldsymbol{r}_{0}$。$\\mathcal{K}_{3}(\\boldsymbol{A}, \\boldsymbol{r}_{0})$ 的标准基是向量集 $\\{\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3\\}$，其中 $\\boldsymbol{v}_1 = \\boldsymbol{r}_0$，$\\boldsymbol{v}_2 = \\boldsymbol{A}\\boldsymbol{r}_0$ pornography $\\boldsymbol{v}_3 = \\boldsymbol{A}^2\\boldsymbol{r}_0$。\n\n第一个基向量是 $\\boldsymbol{v}_1 = \\boldsymbol{r}_0$。\n$$\n\\boldsymbol{v}_1 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n第二个基向量是 $\\boldsymbol{v}_2 = \\boldsymbol{A} \\boldsymbol{v}_1$。\n$$\n\\boldsymbol{v}_2 = \\boldsymbol{A} \\boldsymbol{r}_{0} = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 4(1) + 1(2) + 0(3) \\\\ 1(1) + 3(2) + 1(3) \\\\ 0(1) + 1(2) + 2(3) \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 10 \\\\ 8 \\end{pmatrix}\n$$\n第三个基向量是 $\\boldsymbol{v}_3 = \\boldsymbol{A}^2 \\boldsymbol{r}_{0} = \\boldsymbol{A} (\\boldsymbol{A} \\boldsymbol{r}_{0}) = \\boldsymbol{A} \\boldsymbol{v}_2$。\n$$\n\\boldsymbol{v}_3 = \\boldsymbol{A} \\boldsymbol{v}_{2} = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 10 \\\\ 8 \\end{pmatrix} = \\begin{pmatrix} 4(6) + 1(10) + 0(8) \\\\ 1(6) + 3(10) + 1(8) \\\\ 0(6) + 1(10) + 2(8) \\end{pmatrix} = \\begin{pmatrix} 24+10 \\\\ 6+30+8 \\\\ 10+16 \\end{pmatrix} = \\begin{pmatrix} 34 \\\\ 44 \\\\ 26 \\end{pmatrix}\n$$\n因此，为 $\\mathcal{K}_{3}(\\boldsymbol{A}, \\boldsymbol{r}_{0})$ 构造的基是 $\\left\\{ \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}, \\begin{pmatrix} 6 \\\\ 10 \\\\ 8 \\end{pmatrix}, \\begin{pmatrix} 34 \\\\ 44 \\\\ 26 \\end{pmatrix} \\right\\}$。\n\n步骤 3：构建格拉姆矩阵并计算其行列式。\n一组向量 $\\{\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3\\}$ 的格拉姆矩阵 $\\boldsymbol{G}$ 由 $\\boldsymbol{G}_{ij} = \\boldsymbol{v}_i^T \\boldsymbol{v}_j$ 给出，也就是内积（点积）矩阵。\n$$\n\\boldsymbol{G} = \\begin{pmatrix} \\boldsymbol{v}_1^T \\boldsymbol{v}_1  \\boldsymbol{v}_1^T \\boldsymbol{v}_2  \\boldsymbol{v}_1^T \\boldsymbol{v}_3 \\\\ \\boldsymbol{v}_2^T \\boldsymbol{v}_1  \\boldsymbol{v}_2^T \\boldsymbol{v}_2  \\boldsymbol{v}_2^T \\boldsymbol{v}_3 \\\\ \\boldsymbol{v}_3^T \\boldsymbol{v}_1  \\boldsymbol{v}_3^T \\boldsymbol{v}_2  \\boldsymbol{v}_3^T \\boldsymbol{v}_3 \\end{pmatrix}\n$$\n我们计算各个元素：\n$\\boldsymbol{v}_1^T \\boldsymbol{v}_1 = (1)^2 + (2)^2 + (3)^2 = 1+4+9 = 14$。\n$\\boldsymbol{v}_1^T \\boldsymbol{v}_2 = (1)(6) + (2)(10) + (3)(8) = 6+20+24 = 50$。\n$\\boldsymbol{v}_1^T \\boldsymbol{v}_3 = (1)(34) + (2)(44) + (3)(26) = 34+88+78 = 200$。\n$\\boldsymbol{v}_2^T \\boldsymbol{v}_2 = (6)^2 + (10)^2 + (8)^2 = 36+100+64 = 200$。\n$\\boldsymbol{v}_2^T \\boldsymbol{v}_3 = (6)(34) + (10)(44) + (8)(26) = 204+440+208 = 852$。\n$\\boldsymbol{v}_3^T \\boldsymbol{v}_3 = (34)^2 + (44)^2 + (26)^2 = 1156+1936+676 = 3768$。\n\n由于内积的对称性 ($\\boldsymbol{v}_i^T \\boldsymbol{v}_j = \\boldsymbol{v}_j^T \\boldsymbol{v}_i$)，格拉姆矩阵是对称的：\n$$\n\\boldsymbol{G} = \\begin{pmatrix} 14  50  200 \\\\ 50  200  852 \\\\ 200  852  3768 \\end{pmatrix}\n$$\n格拉姆矩阵的行列式 $\\det(\\boldsymbol{G})$ 是线性无关性的一个判据。这些向量是线性无关的，当且仅当 $\\det(\\boldsymbol{G}) \\neq 0$。一个强大的性质将格拉姆行列式与由这些向量作为列构成的矩阵的行列式联系起来。令 $\\boldsymbol{V} = \\begin{pmatrix} \\boldsymbol{v}_1  \\boldsymbol{v}_2  \\boldsymbol{v}_3 \\end{pmatrix}$。则 $\\det(\\boldsymbol{G}) = (\\det(\\boldsymbol{V}))^2$。\n$$\n\\boldsymbol{V} = \\begin{pmatrix} 1  6  34 \\\\ 2  10  44 \\\\ 3  8  26 \\end{pmatrix}\n$$\n我们沿第一行使用余子式展开来计算 $\\boldsymbol{V}$ 的行列式：\n$$\n\\det(\\boldsymbol{V}) = 1 \\cdot \\det\\begin{pmatrix} 10  44 \\\\ 8  26 \\end{pmatrix} - 6 \\cdot \\det\\begin{pmatrix} 2  44 \\\\ 3  26 \\end{pmatrix} + 34 \\cdot \\det\\begin{pmatrix} 2  10 \\\\ 3  8 \\end{pmatrix}\n$$\n$$\n\\det(\\boldsymbol{V}) = 1(10 \\cdot 26 - 44 \\cdot 8) - 6(2 \\cdot 26 - 44 \\cdot 3) + 34(2 \\cdot 8 - 10 \\cdot 3)\n$$\n$$\n\\det(\\boldsymbol{V}) = 1(260 - 352) - 6(52 - 132) + 34(16 - 30)\n$$\n$$\n\\det(\\boldsymbol{V}) = 1(-92) - 6(-80) + 34(-14) = -92 + 480 - 476 = -88\n$$\n格拉姆矩阵的行列式是这个值的平方：\n$$\n\\det(\\boldsymbol{G}) = (\\det(\\boldsymbol{V}))^2 = (-88)^2 = 7744\n$$\n因为 $\\det(\\boldsymbol{G}) = 7744 \\neq 0$，向量 $\\{\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3\\}$ 是线性无关的，并且构成了 $\\mathbb{R}^3$ 的一个基。这是预期的结果，因为对于一个大小为 $n \\times n$ 的非亏损矩阵 $\\boldsymbol{A}$ 和一个合适的起始向量 $\\boldsymbol{r}_0$，克雷洛夫子空间 $\\mathcal{K}_n(\\boldsymbol{A},\\boldsymbol{r}_0)$ 的维数是 $n$。格拉姆矩阵的行列式即为所求的最终答案。",
            "answer": "$$\n\\boxed{7744}\n$$"
        }
    ]
}