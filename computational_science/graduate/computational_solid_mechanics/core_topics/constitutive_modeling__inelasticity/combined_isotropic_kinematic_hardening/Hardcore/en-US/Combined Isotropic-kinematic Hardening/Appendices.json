{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of computational plasticity is the \"elastic predictor, plastic corrector\" algorithm. The first, crucial step is to determine if a material's response to a strain increment remains elastic or enters the plastic regime. This practice focuses on that decision-making process by having you evaluate the von Mises yield function for a trial stress state, explicitly accounting for the effects of both isotropic and kinematic hardening . Mastering this initial check is fundamental to implementing any stress update routine.",
            "id": "2570547",
            "problem": "At a single Gaussian integration point in a small-strain, rate-independent, associative von Mises plasticity model with combined linear isotropic and linear kinematic hardening, an elastic predictor has produced the following trial Cauchy stress tensor (in megapascals, MPa) and an existing backstress tensor (also in MPa):\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{trial}}=\\begin{pmatrix}\n160  30  0\\\\\n30  120  0\\\\\n0  0  80\n\\end{pmatrix},\\qquad\n\\boldsymbol{\\alpha}=\\begin{pmatrix}\n10  5  0\\\\\n5  -5  0\\\\\n0  0  -5\n\\end{pmatrix}.\n$$\nThe initial yield stress is $\\,\\sigma_{y0}=65\\,$ MPa. The isotropic hardening is linear with modulus $\\,H_{\\mathrm{iso}}=120\\,$ MPa and the accumulated equivalent plastic strain at the start of the increment is $\\,\\bar{\\varepsilon}^{p}=0.05\\,$, so that the isotropic hardening variable is given by $\\,R=H_{\\mathrm{iso}}\\,\\bar{\\varepsilon}^{p}\\,$. Using the definitions of deviatoric stress, second invariant of deviatoric stress, and the von Mises equivalent stress for combined isotropic and kinematic hardening (obtained by shifting the deviatoric stress by the backstress), compute the yield function value $\\,f\\,$ at the trial state and decide whether the state is elastic or plastic based on the sign of $\\,f\\,$. Express the final value of $\\,f\\,$ in MPa and round your answer to four significant figures.",
            "solution": "The problem requires the evaluation of the von Mises yield function, $f$, for a given trial stress state in the context of a plasticity model with combined linear isotropic and kinematic hardening. The sign of the yield function will determine whether the material response is elastic or plastic for the given increment.\n\nThe von Mises yield function for combined hardening is defined as:\n$$\nf(\\boldsymbol{\\sigma}, \\boldsymbol{\\alpha}, R) = \\sigma_{\\mathrm{eq}}(\\boldsymbol{s} - \\boldsymbol{\\alpha}) - (\\sigma_{y0} + R) = 0\n$$\nwhere $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\boldsymbol{s}$ is its deviatoric part, $\\boldsymbol{\\alpha}$ is the backstress tensor (kinematic hardening), $\\sigma_{y0}$ is the initial yield stress, and $R$ is the isotropic hardening variable. The equivalent stress, $\\sigma_{\\mathrm{eq}}$, is defined based on the effective stress tensor, $\\boldsymbol{\\xi} = \\boldsymbol{s} - \\boldsymbol{\\alpha}$, as:\n$$\n\\sigma_{\\mathrm{eq}}(\\boldsymbol{\\xi}) = \\sqrt{\\frac{3}{2} \\boldsymbol{\\xi} : \\boldsymbol{\\xi}}\n$$\nwhere $\\boldsymbol{\\xi}:\\boldsymbol{\\xi} = \\mathrm{tr}(\\boldsymbol{\\xi}^T \\boldsymbol{\\xi})$ is the double dot product. For the specified linear isotropic hardening model, the variable $R$ is given by $R = H_{\\mathrm{iso}}\\bar{\\varepsilon}^{p}$, where $H_{\\mathrm{iso}}$ is the isotropic hardening modulus and $\\bar{\\varepsilon}^{p}$ is the accumulated equivalent plastic strain.\n\nThe task is to evaluate this function at the trial state, denoted by the superscript 'trial'. The given data is:\nThe trial Cauchy stress tensor:\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{trial}}=\\begin{pmatrix}\n160  30  0\\\\\n30  120  0\\\\\n0  0  80\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\nThe backstress tensor at the beginning of the increment:\n$$\n\\boldsymbol{\\alpha}=\\begin{pmatrix}\n10  5  0\\\\\n5  -5  0\\\\\n0  0  -5\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\nThe material parameters and state variables:\nInitial yield stress, $\\sigma_{y0}=65$ MPa.\nIsotropic hardening modulus, $H_{\\mathrm{iso}}=120$ MPa.\nAccumulated equivalent plastic strain, $\\bar{\\varepsilon}^{p}=0.05$.\n\nThe calculation proceeds in several steps.\n\nFirst, we calculate the trial deviatoric stress tensor, $\\boldsymbol{s}^{\\mathrm{trial}}$. This requires the mean stress, $\\sigma_m^{\\mathrm{trial}}$, which is one-third of the trace of the stress tensor.\n$$\n\\sigma_m^{\\mathrm{trial}} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^{\\mathrm{trial}}) = \\frac{1}{3}(160 + 120 + 80) = \\frac{360}{3} = 120 \\, \\mathrm{MPa}\n$$\nThe trial deviatoric stress tensor is then $\\boldsymbol{s}^{\\mathrm{trial}} = \\boldsymbol{\\sigma}^{\\mathrm{trial}} - \\sigma_m^{\\mathrm{trial}}\\boldsymbol{I}$, where $\\boldsymbol{I}$ is the second-order identity tensor.\n$$\n\\boldsymbol{s}^{\\mathrm{trial}} = \\begin{pmatrix}\n160  30  0\\\\\n30  120  0\\\\\n0  0  80\n\\end{pmatrix} - 120\\begin{pmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix} = \\begin{pmatrix}\n40  30  0\\\\\n30  0  0\\\\\n0  0  -40\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\nAs a necessary check, the trace of $\\boldsymbol{s}^{\\mathrm{trial}}$ is $40 + 0 - 40 = 0$, confirming it is a deviatoric tensor.\n\nSecond, we compute the effective stress tensor at the trial state, $\\boldsymbol{\\xi} = \\boldsymbol{s}^{\\mathrm{trial}} - \\boldsymbol{\\alpha}$. Note that the backstress tensor $\\boldsymbol{\\alpha}$ is inherently deviatoric; its trace is $10 - 5 - 5 = 0$.\n$$\n\\boldsymbol{\\xi} = \\begin{pmatrix}\n40  30  0\\\\\n30  0  0\\\\\n0  0  -40\n\\end{pmatrix} - \\begin{pmatrix}\n10  5  0\\\\\n5  -5  0\\\\\n0  0  -5\n\\end{pmatrix} = \\begin{pmatrix}\n30  25  0\\\\\n25  5  0\\\\\n0  0  -35\n\\end{pmatrix} \\, \\mathrm{MPa}\n$$\n\nThird, we calculate the von Mises equivalent stress, $\\sigma_{\\mathrm{eq}}$. This involves the double dot product $\\boldsymbol{\\xi} : \\boldsymbol{\\xi}$. Since $\\boldsymbol{\\xi}$ is symmetric, $\\boldsymbol{\\xi} : \\boldsymbol{\\xi} = \\sum_{i,j} \\xi_{ij}^2$.\n$$\n\\boldsymbol{\\xi} : \\boldsymbol{\\xi} = (30)^2 + (25)^2 + (0)^2 + (25)^2 + (5)^2 + (0)^2 + (0)^2 + (0)^2 + (-35)^2\n$$\n$$\n\\boldsymbol{\\xi} : \\boldsymbol{\\xi} = 900 + 625 + 625 + 25 + 1225 = 3400 \\, \\mathrm{MPa}^2\n$$\nNow, the equivalent stress is:\n$$\n\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}(\\boldsymbol{\\xi} : \\boldsymbol{\\xi})} = \\sqrt{\\frac{3}{2}(3400)} = \\sqrt{3 \\times 1700} = \\sqrt{5100} \\, \\mathrm{MPa}\n$$\nNumerically, $\\sigma_{\\mathrm{eq}} \\approx 71.41428$ MPa.\n\nFourth, we determine the current yield stress, $\\sigma_y$, which defines the size of the yield surface. With linear isotropic hardening, the increase in yield stress, $R$, is:\n$$\nR = H_{\\mathrm{iso}}\\bar{\\varepsilon}^{p} = 120 \\, \\mathrm{MPa} \\times 0.05 = 6 \\, \\mathrm{MPa}\n$$\nThe current yield stress is the sum of the initial yield stress and this hardening contribution:\n$$\n\\sigma_y = \\sigma_{y0} + R = 65 \\, \\mathrm{MPa} + 6 \\, \\mathrm{MPa} = 71 \\, \\mathrm{MPa}\n$$\n\nFinally, we can compute the value of the yield function, $f$, at the trial state.\n$$\nf = \\sigma_{\\mathrm{eq}} - \\sigma_y = \\sqrt{5100} - 71 \\approx 71.41428 - 71 = 0.41428 \\, \\mathrm{MPa}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nf \\approx 0.4143 \\, \\mathrm{MPa}\n$$\nSince $f > 0$, the trial stress state lies outside the yield surface. This signifies that the correct response for the increment involves plastic deformation. The purely elastic assumption is invalid, and a return-mapping algorithm must be applied to bring the stress state back to the updated yield surface. The problem, however, only asks for the evaluation of $f$ and a decision on the state. The decision is that the state is plastic.",
            "answer": "$$\\boxed{0.4143}$$"
        },
        {
            "introduction": "Once plastic yielding is detected, the next question is: in what direction does the material deform plastically? This exercise delves into the associative flow rule for $J_2$ plasticity, which dictates that the plastic strain increment is normal to the yield surface in stress space. By calculating this direction, you will also verify a critical consequence of the theory: that plastic deformation in metals is isochoric (volume-preserving), a principle demonstrated by the orthogonality between the plastic flow direction and the hydrostatic axis .",
            "id": "2652004",
            "problem": "A metallic solid obeys associative von Mises (also called $J_2$) plasticity under small strains. The current Cauchy stress has deviatoric part $s$ given (in megapascals) by\n$$\ns \\;=\\; \\begin{pmatrix}\n60  12  -9 \\\\\n12  -20  8 \\\\\n-9  8  -40\n\\end{pmatrix}.\n$$\nThe material may exhibit isotropic, kinematic, or combined hardening, but assume that at the current instant the backstress (the kinematic hardening tensor) is zero so that the plastic flow direction is governed directly by the deviatoric stress. Use only fundamental definitions: the deviatoric decomposition, the Frobenius inner product $A\\!:\\!B=\\sum_{i,j}A_{ij}B_{ij}$, the Frobenius norm $\\|A\\|=\\sqrt{A\\!:\\!A}$, and the fact that associative $J_{2}$ flow is normal to the von Mises yield surface in stress space. Define the hydrostatic axis direction by the identity tensor $I$.\n\nTasks:\n- Compute the unit plastic strain increment direction tensor $\\hat{n}_{p}$ under associative $J_{2}$ flow at this state.\n- Verify orthogonality of the plastic strain increment direction with the hydrostatic axis by computing the angle $\\theta$ between $\\hat{n}_{p}$ and $I$ using the Frobenius inner product, with\n$$\n\\cos\\theta \\;=\\; \\dfrac{\\hat{n}_{p}\\!:\\!I}{\\|\\hat{n}_{p}\\|\\,\\|I\\|}.\n$$\n\nReport as your final answer only the angle $\\theta$ in radians. Give an exact value (no rounding is required). Do not include units in the final boxed answer.",
            "solution": "The problem requires the calculation of the angle between the plastic strain increment direction and the hydrostatic axis for a material governed by associative von Mises plasticity. The solution requires a rigorous application of continuum mechanics principles.\n\nFirst, we must validate the provided deviatoric stress tensor, $s$. A tensor is deviatoric if and only if its trace is zero. Let us compute the trace of the given tensor $s$:\n$$\ntr(s) = \\sum_{i=1}^{3} s_{ii} = 60 + (-20) + (-40) = 60 - 60 = 0\n$$\nThe trace is indeed $0$, so the provided tensor $s$ is a valid deviatoric stress tensor.\n\nThe problem states that the material obeys an associative flow rule. This means the plastic strain rate tensor, which we can denote as $\\dot{\\varepsilon}_p$, is normal to the yield surface in stress space. The direction of the plastic strain increment, and thus of $\\dot{\\varepsilon}_p$, is given by the gradient of the yield function, $f(\\sigma)$, with respect to the Cauchy stress tensor $\\sigma$:\n$$\n\\dot{\\varepsilon}_p = \\dot{\\lambda} \\frac{\\partial f}{\\partial \\sigma}\n$$\nHere, $\\dot{\\lambda}$ is the plastic multiplier, a non-negative scalar. The problem specifies von Mises (or $J_2$) plasticity. The von Mises yield criterion is a function only of the second invariant of the deviatoric stress, $J_2 = \\frac{1}{2} s:s$. A standard form of the yield function is $f(\\sigma) = \\sqrt{3J_2} - \\sigma_Y$, where $\\sigma_Y$ is the material's yield strength. The backstress is given as zero, which means the yield surface is centered at the origin of the deviatoric stress space.\n\nThe direction of plastic flow is proportional to $\\frac{\\partial f}{\\partial \\sigma}$. Using the chain rule, we find this gradient:\n$$\n\\frac{\\partial f}{\\partial \\sigma} = \\frac{\\partial f}{\\partial J_2} \\frac{\\partial J_2}{\\partial \\sigma}\n$$\nThe derivative of $J_2 = \\frac{1}{2}s_{ij}s_{ij}$ with respect to $\\sigma$ is known to be the deviatoric stress tensor $s$ itself. To demonstrate this:\n$$\n\\frac{\\partial J_2}{\\partial \\sigma_{kl}} = \\frac{1}{2} \\frac{\\partial (s_{ij}s_{ij})}{\\partial \\sigma_{kl}} = s_{ij} \\frac{\\partial s_{ij}}{\\partial \\sigma_{kl}}\n$$\nUsing $s_{ij} = \\sigma_{ij} - \\frac{1}{3}\\delta_{ij}\\sigma_{mm}$, we have $\\frac{\\partial s_{ij}}{\\partial \\sigma_{kl}} = (\\delta_{ik}\\delta_{jl}) - \\frac{1}{3}\\delta_{ij}\\delta_{kl}$. Substituting this gives:\n$$\n\\frac{\\partial J_2}{\\partial \\sigma_{kl}} = s_{ij} \\left( \\delta_{ik}\\delta_{jl} - \\frac{1}{3}\\delta_{ij}\\delta_{kl} \\right) = s_{kl} - \\frac{1}{3}\\delta_{kl} s_{jj} = s_{kl} - \\frac{1}{3}\\delta_{kl} tr(s)\n$$\nSince $tr(s)=0$, we confirm the fundamental relation $\\frac{\\partial J_2}{\\partial \\sigma} = s$. Consequently, the gradient of the yield function is:\n$$\n\\frac{\\partial f}{\\partial \\sigma} = \\frac{\\sqrt{3}}{2\\sqrt{J_2}} s = \\frac{\\sqrt{3}}{\\sqrt{s:s}} s = \\frac{\\sqrt{3}}{\\|s\\|} s\n$$\nThis shows that the direction of plastic flow is parallel to the deviatoric stress tensor $s$. The first task is to compute the unit plastic strain increment direction tensor, $\\hat{n}_p$. This is found by normalizing the direction vector, which is $s$:\n$$\n\\hat{n}_p = \\frac{s}{\\|s\\|}\n$$\nTo compute this explicitly, we need the Frobenius norm of $s$:\n$$\n\\|s\\|^2 = s:s = \\sum_{i,j} s_{ij}^2 = (60)^2 + (12)^2 + (-9)^2 + (12)^2 + (-20)^2 + (8)^2 + (-9)^2 + (8)^2 + (-40)^2\n$$\n$$\n\\|s\\|^2 = 3600 + 144 + 81 + 144 + 400 + 64 + 81 + 64 + 1600 = 6178\n$$\nThus, $\\|s\\| = \\sqrt{6178}$. The unit direction tensor $\\hat{n}_p$ is:\n$$\n\\hat{n}_p = \\frac{1}{\\sqrt{6178}} \\begin{pmatrix} 60  12  -9 \\\\ 12  -20  8 \\\\ -9  8  -40 \\end{pmatrix}\n$$\nThe second task is to compute the angle $\\theta$ between $\\hat{n}_p$ and the hydrostatic axis, represented by the identity tensor $I$. The angle is defined by:\n$$\n\\cos\\theta = \\frac{\\hat{n}_{p}:I}{\\|\\hat{n}_{p}\\| \\|I\\|}\n$$\nWe evaluate the terms in this expression.\nThe norm of the unit tensor $\\hat{n}_p$ is, by definition, $\\|\\hat{n}_p\\| = 1$.\nThe norm of the identity tensor $I$ in three dimensions is:\n$$\n\\|I\\| = \\sqrt{I:I} = \\sqrt{1^2 + 0^2 + 0^2 + \\dots + 1^2} = \\sqrt{1^2+1^2+1^2} = \\sqrt{3}\n$$\nThe inner product in the numerator is the trace of $\\hat{n}_p$:\n$$\n\\hat{n}_p : I = \\sum_{i,j} (\\hat{n}_p)_{ij} I_{ij} = \\sum_{i=1}^{3} (\\hat{n}_p)_{ii} = tr(\\hat{n}_p)\n$$\nSince $\\hat{n}_p$ is proportional to $s$, its trace is $tr(\\hat{n}_p) = \\frac{1}{\\|s\\|}tr(s)$. As we established at the beginning, $tr(s) = 0$. Therefore:\n$$\n\\hat{n}_p : I = 0\n$$\nSubstituting these values back into the formula for the cosine of the angle:\n$$\n\\cos\\theta = \\frac{0}{1 \\cdot \\sqrt{3}} = 0\n$$\nThis result signifies that the plastic strain increment direction tensor $\\hat{n}_p$ is orthogonal to the hydrostatic axis direction tensor $I$. This is a general feature of $J_2$ plasticity, which implies that plastic deformation is isochoric, i.e., it preserves volume, since $tr(\\dot{\\varepsilon}_p) = \\dot{\\varepsilon}_p : I = 0$.\nThe angle $\\theta$ that satisfies $\\cos\\theta = 0$ is:\n$$\n\\theta = \\arccos(0) = \\frac{\\pi}{2} \\text{ radians}\n$$\nThe specific numerical components of the tensor $s$ were only necessary to confirm that it is a non-zero deviatoric tensor, but the final result for the angle is a direct and general consequence of the theory.",
            "answer": "$$\\boxed{\\frac{\\pi}{2}}$$"
        },
        {
            "introduction": "This practice challenges you to synthesize the concepts of yielding, flow, and hardening into a complete computational tool. Moving beyond single calculations, you will implement a full stress-update algorithm for a 3D combined hardening model from first principles, a task central to finite element analysis. The objective is to validate your implementation's robustness by testing it against the fundamental Karush-Kuhn-Tucker (KKT) conditions, especially for complex, non-proportional strain paths where the interplay between isotropic and kinematic hardening becomes critical .",
            "id": "3549555",
            "problem": "Construct a complete, runnable program that numerically validates the Karush-Kuhn-Tucker (KKT) consistency conditions $\\dot{\\lambda} \\ge 0$, $f \\le 0$, and $\\dot{\\lambda} f = 0$ for small-strain associative $J_2$ plasticity with combined isotropic-kinematic hardening in three-dimensional space. The verification must be performed along a non-trivial, non-proportional strain path with sharp changes of direction (corners in the path), ensuring traversal near the boundary of the elastic domain.\n\nUse the following foundational base to guide the derivation and algorithm:\n- Small-strain kinematics: the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ with additive decomposition $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^{e} + \\boldsymbol{\\varepsilon}^{p}$, where $\\boldsymbol{\\varepsilon}^{e}$ is the elastic strain and $\\boldsymbol{\\varepsilon}^{p}$ is the plastic strain.\n- Linear isotropic elasticity: Cauchy stress $\\boldsymbol{\\sigma} = 2 G\\, \\text{dev}(\\boldsymbol{\\varepsilon}^{e}) + 3 K\\, \\text{sph}(\\boldsymbol{\\varepsilon}^{e})$, where $G = \\dfrac{E}{2(1+\\nu)}$ is the shear modulus, $K = \\dfrac{E}{3(1-2\\nu)}$ is the bulk modulus, $\\text{dev}(\\cdot)$ is the deviatoric projection, and $\\text{sph}(\\cdot)$ is the spherical projection $\\text{sph}(\\mathbf{A}) = \\dfrac{1}{3}\\,\\text{tr}(\\mathbf{A})\\,\\mathbf{I}$.\n- $J_2$ yield condition with combined hardening: define the backstress tensor $\\boldsymbol{\\alpha}$ for kinematic hardening and the isotropic hardening variable $R = H_{\\text{iso}}\\,p$, where $p$ is the equivalent plastic strain, and $H_{\\text{iso}}$ and $H_{\\text{kin}}$ are constant moduli. The yield function is $f(\\boldsymbol{\\sigma}, \\boldsymbol{\\alpha}, R) = \\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\| - \\sqrt{\\dfrac{2}{3}}\\left(\\sigma_{y0} + R\\right)$, where $\\boldsymbol{s} = \\text{dev}(\\boldsymbol{\\sigma})$, $\\sigma_{y0}$ is the initial yield stress, and $\\|\\cdot\\|$ is the Frobenius norm.\n- Associative flow rule and hardening evolution: plastic strain deviator evolves in the normal direction $\\boldsymbol{N}$ to the yield surface, and $\\boldsymbol{\\alpha}$ evolves linearly with $\\boldsymbol{\\varepsilon}^{p}$.\n\nYour program must implement a robust incremental stress update algorithm derived from these principles, without assuming any shortcut formulas externally provided. It must compute, at each strain increment:\n- The trial elastic response.\n- Plastic correction when the trial state violates the yield criterion, enforcing consistency via return mapping and satisfying the KKT conditions in discrete form with $\\Delta \\lambda \\ge 0$, $f_{n+1} \\le 0$, and $\\Delta \\lambda \\, f_{n+1} = 0$ up to a small numerical tolerance.\n\nPhysical units and numerical conventions:\n- Report stresses in $\\text{MPa}$ and treat strains as dimensionless.\n- Angles do not appear, so no angle unit is needed.\n- Tolerances must be specified in $\\text{MPa}$ for $f$ and dimensionless for $\\Delta \\lambda$.\n\nDesign a test suite of $3$ cases that cover:\n- A general case with non-proportional loading featuring multiple corners in the strain path, producing yielding and reverse loading (Bauschinger-type effect due to kinematic hardening).\n- A boundary condition case where the entire path remains strictly elastic.\n- An edge case where the path approaches the yield surface and hovers near it with alternating increments after yielding.\n\nFor all cases, use scientifically realistic material parameters. For each case, specify:\n- Young’s modulus $E$ in $\\text{MPa}$, Poisson’s ratio $\\nu$, initial yield stress $\\sigma_{y0}$ in $\\text{MPa}$, isotropic hardening modulus $H_{\\text{iso}}$ in $\\text{MPa}$, and kinematic hardening modulus $H_{\\text{kin}}$ in $\\text{MPa}$.\n- A non-proportional strain path defined as a list of $3 \\times 3$ strain increments $\\Delta \\boldsymbol{\\varepsilon}_k$ that includes at least $2$ corners in loading direction.\n\nNumerical validation:\n- At each increment $k$, compute $\\Delta \\lambda_k$ and the updated yield function $f_{k}$ at the end of the step.\n- Check the KKT conditions in discrete form: $\\Delta \\lambda_k \\ge 0$, $f_{k} \\le \\tau_f$, and $|\\Delta \\lambda_k\\, f_{k}| \\le \\tau_c$, where $\\tau_f$ and $\\tau_c$ are user-defined tolerances with $\\tau_f$ in $\\text{MPa}$ and $\\tau_c$ in $\\text{MPa}$.\n- Use $\\tau_f = 10^{-6}$ and $\\tau_c = 10^{-6}$, and a non-negativity tolerance on $\\Delta \\lambda$ equal to $10^{-12}$.\n\nAnswer format:\n- For each test case, return a boolean that is $ \\text{True} $ only if all increments in that case satisfy all three KKT checks within the specified tolerances.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result1,result2,result3]$).\n\nTest suite parameter values to implement:\n- Case $1$ (general non-proportional with corners and yielding-reversal): $E = 210000$ $\\text{MPa}$, $\\nu = 0.30$, $\\sigma_{y0} = 250$ $\\text{MPa}$, $H_{\\text{iso}} = 1000$ $\\text{MPa}$, $H_{\\text{kin}} = 15000$ $\\text{MPa}$. Strain path segments:\n  - $20$ increments: $\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(0.00020, 0, 0)$,\n  - $10$ increments: shear in $xy$, with $\\Delta \\varepsilon_{xy} = \\Delta \\varepsilon_{yx} = 0.00060$,\n  - $15$ increments: reverse axial in $xx$, with $\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(-0.00015, 0, 0)$,\n  - $10$ increments: shear in $yz$, with $\\Delta \\varepsilon_{yz} = \\Delta \\varepsilon_{zy} = 0.00050$.\n- Case $2$ (strictly elastic): $E = 70000$ $\\text{MPa}$, $\\nu = 0.33$, $\\sigma_{y0} = 300$ $\\text{MPa}$, $H_{\\text{iso}} = 5000$ $\\text{MPa}$, $H_{\\text{kin}} = 20000$ $\\text{MPa}$. Strain path segments:\n  - $30$ increments: $\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(0.000001, 0, 0)$,\n  - $30$ increments: shear in $xy$, with $\\Delta \\varepsilon_{xy} = \\Delta \\varepsilon_{yx} = 0.000001$.\n- Case $3$ (edge: near-yield hovering with alternating increments and corners): $E = 210000$ $\\text{MPa}$, $\\nu = 0.30$, $\\sigma_{y0} = 250$ $\\text{MPa}$, $H_{\\text{iso}} = 2000$ $\\text{MPa}$, $H_{\\text{kin}} = 10000$ $\\text{MPa}$. Strain path segments:\n  - $5$ increments: $\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(0.00080, 0, 0)$,\n  - $20$ alternating shear increments in $xy$: for $k = 1, 2, \\dots, 20$, set $\\Delta \\varepsilon_{xy} = \\Delta \\varepsilon_{yx} = 0.00010$ if $k$ is odd and $\\Delta \\varepsilon_{xy} = \\Delta \\varepsilon_{yx} = -0.00010$ if $k$ is even,\n  - $10$ increments: $\\Delta \\boldsymbol{\\varepsilon} = \\text{diag}(-0.00005, 0, 0)$,\n  - $10$ increments: shear in $yz$, with $\\Delta \\varepsilon_{yz} = \\Delta \\varepsilon_{zy} = 0.00006$.\n\nYour program must use these exact parameter sets and paths, apply the described algorithm, and output a single line: a list of $3$ booleans in the specified format.",
            "solution": "The problem is to construct and numerically validate a stress update algorithm for small-strain associative $J_2$ plasticity with combined linear isotropic and kinematic hardening. The validation will be performed by checking the Karush-Kuhn-Tucker (KKT) conditions for non-proportional strain paths.\n\n### 1. Foundational Principles\n\nThe constitutive model is defined by the following set of equations:\n\n1.  **Additive Strain Decomposition**: The total strain tensor $\\boldsymbol{\\varepsilon}$ is decomposed into an elastic part $\\boldsymbol{\\varepsilon}^e$ and a plastic part $\\boldsymbol{\\varepsilon}^p$:\n    $$ \\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p $$\n\n2.  **Linear Isotropic Elasticity**: The Cauchy stress tensor $\\boldsymbol{\\sigma}$ is related to the elastic strain $\\boldsymbol{\\varepsilon}^e$ by Hooke's law:\n    $$ \\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}^e = 2G\\,\\text{dev}(\\boldsymbol{\\varepsilon}^e) + K\\,\\text{tr}(\\boldsymbol{\\varepsilon}^e)\\mathbf{I} $$\n    where $G$ is the shear modulus and $K$ is the bulk modulus. $\\text{dev}(\\cdot)$ is the deviatoric operator and $\\text{tr}(\\cdot)$ is the trace operator.\n\n3.  **$J_2$ Yield Condition**: Plastic deformation initiates when the yield function $f$ is non-negative. For combined hardening, the yield function is:\n    $$ f(\\boldsymbol{\\sigma}, \\boldsymbol{\\alpha}, p) = \\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\| - \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + R) $$\n    where $\\boldsymbol{s} = \\text{dev}(\\boldsymbol{\\sigma})$ is the deviatoric stress, $\\boldsymbol{\\alpha}$ is the backstress tensor (kinematic hardening), and $R$ is the isotropic hardening variable. The norm $\\|\\cdot\\|$ is the Frobenius norm.\n\n4.  **Associative Flow Rule**: The evolution of the plastic strain is normal to the yield surface:\n    $$ \\dot{\\boldsymbol{\\varepsilon}}^p = \\dot{\\lambda} \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\dot{\\lambda} \\boldsymbol{N} $$\n    where $\\dot{\\lambda} \\ge 0$ is the plastic consistency parameter and $\\boldsymbol{N} = \\frac{\\boldsymbol{s} - \\boldsymbol{\\alpha}}{\\|\\boldsymbol{s} - \\boldsymbol{\\alpha}\\|}$ is the normal to the yield surface in stress space. Note that $\\boldsymbol{\\varepsilon}^p$ is purely deviatoric, i.e., $\\text{tr}(\\boldsymbol{\\varepsilon}^p) = 0$.\n\n5.  **Hardening Laws**:\n    - **Isotropic Hardening**: The yield surface size evolves with the equivalent plastic strain $p$.\n      $$ R = H_{\\text{iso}}p $$\n      The equivalent plastic strain rate $\\dot{p}$ is defined as $\\dot{p} = \\sqrt{\\frac{2}{3}\\dot{\\boldsymbol{\\varepsilon}}^p : \\dot{\\boldsymbol{\\varepsilon}}^p} = \\sqrt{\\frac{2}{3}}\\dot{\\lambda}$.\n    - **Kinematic Hardening**: The yield surface center evolves according to a linear (Prager) rule:\n      $$ \\dot{\\boldsymbol{\\alpha}} = \\frac{2}{3}H_{\\text{kin}}\\dot{\\boldsymbol{\\varepsilon}}^p $$\n\n6.  **KKT Conditions**: These are the loading/unloading conditions:\n    $$ \\dot{\\lambda} \\ge 0, \\quad f \\le 0, \\quad \\dot{\\lambda}f = 0 $$\n\n### 2. Incremental Stress Update Algorithm\n\nThe continuous equations are integrated over a discrete time (or load) step, from $t_n$ to $t_{n+1}$. We use a backward-Euler (fully implicit) scheme, which is unconditionally stable. The state variables at step $n$ ($\\boldsymbol{\\varepsilon}_n^p$, $\\boldsymbol{\\alpha}_n$, $p_n$) are known, and the total strain increment $\\Delta\\boldsymbol{\\varepsilon}$ is given.\n\n**Step 1: Elastic Predictor (Trial State)**\nFirst, we assume the entire increment is elastic. The plastic state variables remain frozen.\n- Trial plastic strain: $\\boldsymbol{\\varepsilon}_{n+1}^{p, \\text{trial}} = \\boldsymbol{\\varepsilon}_n^p$\n- Trial backstress: $\\boldsymbol{\\alpha}_{n+1}^{\\text{trial}} = \\boldsymbol{\\alpha}_n$\n- Trial equivalent plastic strain: $p_{n+1}^{\\text{trial}} = p_n \\implies R_{n+1}^{\\text{trial}} = H_{\\text{iso}} p_n$\n\nThe trial stress is computed from the updated total strain $\\boldsymbol{\\varepsilon}_{n+1} = \\boldsymbol{\\varepsilon}_n + \\Delta\\boldsymbol{\\varepsilon}$:\n$$ \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} = \\mathbb{C} : (\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}_n^p) = \\boldsymbol{\\sigma}_n + \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon} $$\nIn component form for implementation:\n$$ \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} = \\boldsymbol{\\sigma}_n + 2G\\,\\text{dev}(\\Delta\\boldsymbol{\\varepsilon}) + K\\,\\text{tr}(\\Delta\\boldsymbol{\\varepsilon})\\mathbf{I} $$\n\n**Step 2: Yield Check**\nWe evaluate the yield function at the trial state:\n$$ f_{n+1}^{\\text{trial}} = \\|\\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n\\| - \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}p_n) $$\n- If $f_{n+1}^{\\text{trial}} \\le 0$, the assumption was correct. The step is elastic. The state at $n+1$ is the trial state. The plastic multiplier for the increment, $\\Delta\\lambda$, is $0$.\n- If $f_{n+1}^{\\text{trial}} > 0$, the state lies outside the yield surface. Plastic deformation occurs, and a correction is required.\n\n**Step 3: Plastic Corrector (Return Mapping)**\nFor a plastic step, the final state $(\\boldsymbol{\\sigma}_{n+1}, \\boldsymbol{\\alpha}_{n+1}, p_{n+1})$ must lie on the updated yield surface, so $f_{n+1} = 0$. Using the backward-Euler scheme, the discrete evolution equations are:\n- Plastic strain increment: $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{\\varepsilon}_{n+1}^p - \\boldsymbol{\\varepsilon}_n^p = \\Delta\\lambda \\boldsymbol{N}_{n+1}$\n- Equivalent plastic strain: $p_{n+1} = p_n + \\Delta p = p_n + \\sqrt{\\frac{2}{3}}\\Delta\\lambda$\n- Backstress: $\\boldsymbol{\\alpha}_{n+1} = \\boldsymbol{\\alpha}_n + \\Delta\\boldsymbol{\\alpha} = \\boldsymbol{\\alpha}_n + \\frac{2}{3}H_{\\text{kin}}\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{\\alpha}_n + \\frac{2}{3}H_{\\text{kin}}\\Delta\\lambda\\boldsymbol{N}_{n+1}$\n\nThe stress at $n+1$ is related to the trial stress:\n$$ \\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} - 2G\\,\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} - 2G\\,\\Delta\\lambda\\boldsymbol{N}_{n+1} $$\nLet the relative deviatoric stress be $\\boldsymbol{\\xi} = \\boldsymbol{s} - \\boldsymbol{\\alpha}$. At the final state:\n$$ \\boldsymbol{\\xi}_{n+1} = \\boldsymbol{s}_{n+1} - \\boldsymbol{\\alpha}_{n+1} = (\\boldsymbol{s}_{n+1}^{\\text{trial}} - 2G\\,\\Delta\\lambda\\boldsymbol{N}_{n+1}) - (\\boldsymbol{\\alpha}_n + \\frac{2}{3}H_{\\text{kin}}\\Delta\\lambda\\boldsymbol{N}_{n+1}) $$\n$$ \\boldsymbol{\\xi}_{n+1} = (\\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n) - \\left( 2G + \\frac{2}{3}H_{\\text{kin}} \\right) \\Delta\\lambda \\boldsymbol{N}_{n+1} $$\nLetting $\\boldsymbol{\\xi}_{n+1}^{\\text{trial}} = \\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n$, and noting that $\\boldsymbol{N}_{n+1}$ must have the same direction as $\\boldsymbol{\\xi}_{n+1}$ and thus also $\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}$, we can set $\\boldsymbol{N}_{n+1} = \\boldsymbol{\\xi}_{n+1}^{\\text{trial}} / \\|\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}\\|$. The equation becomes a scalar relation between norms:\n$$ \\|\\boldsymbol{\\xi}_{n+1}\\| = \\|\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}\\| - \\left( 2G + \\frac{2}{3}H_{\\text{kin}} \\right) \\Delta\\lambda $$\nThe yield condition $f_{n+1} = 0$ requires:\n$$ \\|\\boldsymbol{\\xi}_{n+1}\\| = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + R_{n+1}) = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}} p_{n+1}) = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}(p_n + \\sqrt{\\frac{2}{3}}\\Delta\\lambda)) $$\n$$ \\|\\boldsymbol{\\xi}_{n+1}\\| = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}p_n) + \\frac{2}{3}H_{\\text{iso}}\\Delta\\lambda $$\nEquating the two expressions for $\\|\\boldsymbol{\\xi}_{n+1}\\|$:\n$$ \\|\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}\\| - \\left( 2G + \\frac{2}{3}H_{\\text{kin}} \\right) \\Delta\\lambda = \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}p_n) + \\frac{2}{3}H_{\\text{iso}}\\Delta\\lambda $$\nRecognizing that $f_{n+1}^{\\text{trial}} = \\|\\boldsymbol{\\xi}_{n+1}^{\\text{trial}}\\| - \\sqrt{\\frac{2}{3}}(\\sigma_{y0} + H_{\\text{iso}}p_n)$, we solve for $\\Delta\\lambda$:\n$$ f_{n+1}^{\\text{trial}} = \\left( 2G + \\frac{2}{3}H_{\\text{kin}} + \\frac{2}{3}H_{\\text{iso}} \\right) \\Delta\\lambda $$\n$$ \\Delta\\lambda = \\frac{f_{n+1}^{\\text{trial}}}{2G + \\frac{2}{3}(H_{\\text{iso}} + H_{\\text{kin}})} $$\nSince $f_{n+1}^{\\text{trial}} > 0$, it follows that $\\Delta\\lambda > 0$, satisfying the first KKT condition.\n\n**Step 4: State Update**\nOnce $\\Delta\\lambda$ is known, all state variables are updated:\n1.  Compute the normal vector $\\boldsymbol{N}_{n+1} = (\\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n) / \\|\\boldsymbol{s}_{n+1}^{\\text{trial}} - \\boldsymbol{\\alpha}_n\\|$.\n2.  Compute the plastic strain increment $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\boldsymbol{N}_{n+1}$.\n3.  Update plastic strain: $\\boldsymbol{\\varepsilon}_{n+1}^p = \\boldsymbol{\\varepsilon}_n^p + \\Delta\\boldsymbol{\\varepsilon}^p$.\n4.  Update equivalent plastic strain: $p_{n+1} = p_n + \\sqrt{\\frac{2}{3}}\\Delta\\lambda$.\n5.  Update backstress: $\\boldsymbol{\\alpha}_{n+1} = \\boldsymbol{\\alpha}_n + \\frac{2}{3}H_{\\text{kin}}\\Delta\\boldsymbol{\\varepsilon}^p$.\n6.  Update stress: $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n+1}^{\\text{trial}} - 2G\\Delta\\boldsymbol{\\varepsilon}^p$.\n\n### 3. Numerical Validation of KKT Conditions\n\nAt the end of each increment $k$, we verify the discrete KKT conditions using the computed step values $\\Delta\\lambda_k$ and the final yield function value $f_k = f(\\boldsymbol{\\sigma}_k, \\boldsymbol{\\alpha}_k, p_k)$:\n1.  **Consistency Parameter Non-negativity**: $\\Delta\\lambda_k \\ge 0$ (verified with tolerance: $\\Delta\\lambda_k \\ge -10^{-12}$).\n2.  **Yield Condition Admissibility**: $f_k \\le 0$ (verified with tolerance: $f_k \\le \\tau_f = 10^{-6}$).\n3.  **Complementarity Condition**: $\\Delta\\lambda_k f_k = 0$ (verified with tolerance: $|\\Delta\\lambda_k f_k| \\le \\tau_c = 10^{-6}$).\n\nA test case is considered valid ('True') only if all three conditions are met for every increment in its strain path.",
            "answer": "[True,True,True]"
        }
    ]
}