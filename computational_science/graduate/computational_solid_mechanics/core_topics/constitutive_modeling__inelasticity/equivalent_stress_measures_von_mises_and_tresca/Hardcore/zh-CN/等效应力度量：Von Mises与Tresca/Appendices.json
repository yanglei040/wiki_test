{
    "hands_on_practices": [
        {
            "introduction": "应用任何屈服准则的第一步，是将一个复杂的多轴应力状态提炼为几个关键数值。本练习将引导你完成一个基础过程：从给定的柯西应力张量（Cauchy stress tensor）计算主应力。然后，通过计算Tresca和von Mises等效应力，你将具体理解这些关键的失效判据度量如何与主应力状态直接关联。",
            "id": "3562844",
            "problem": "在一个材料点处，一个均匀、各向同性固体的柯西应力张量（相对于一个固定的标准正交基）由下式给出：\n$$\n\\boldsymbol{\\sigma} \\;=\\;\n\\begin{pmatrix}\n150  30  0 \\\\\n30  150  0 \\\\\n0  0  -20\n\\end{pmatrix}\n\\;\\text{MPa}.\n$$\n从主应力是柯西应力张量的特征值这一定义出发，确定三个主应力。使用最大切应力（即作用于通过该点的任意平面上的切引力矢量的最大模量）的定义，显式地计算最大切应力，并验证其值等于您所求得的主应力最大两两之差的一半。然后，仅使用这些主应力，计算 Tresca 等效应力和 von Mises 等效应力，这两种应力是计算固体力学中用于评估屈服的标准度量。\n\n将您最终报告的最大切应力值四舍五入至四位有效数字，并以兆帕 (MPa) 为单位表示。仅将最大切应力作为您的最终数值答案报告。",
            "solution": "首先根据既定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **柯西应力张量**：\n$$\n\\boldsymbol{\\sigma} \\;=\\;\n\\begin{pmatrix}\n150  30  0 \\\\\n30  150  0 \\\\\n0  0  -20\n\\end{pmatrix}\n\\;\\text{MPa}\n$$\n- **材料属性**：均匀、各向同性固体。\n- **定义**：\n  - 主应力是柯西应力张量的特征值。\n  - 最大切应力是任意平面上切引力矢量的最大模量。\n- **任务**：\n  1. 确定三个主应力。\n  2. 显式地计算最大切应力，并验证其值等于主应力最大两两之差的一半。\n  3. 计算 Tresca 和 von Mises 等效应力。\n  4. 将最大切应力四舍五入至四位有效数字，并作为最终数值答案报告。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题植根于连续介质力学和固体力学的基础原理，特别是应力状态分析。柯西应力、主应力、最大切应力以及 Tresca 和 von Mises 屈服准则等概念是该领域的标准且成熟的概念。给定的应力张量是对称的，这在没有体力矩的情况下是柯西应力张量所必需的。\n- **适定性**：该问题是适定的。一个对称的 $3 \\times 3$ 实矩阵有三个实特征值，这保证了主应力的存在性和唯一性。随后的最大切应力和等效应力的计算是这些主应力的确定性函数。\n- **客观性**：该问题使用精确的数学语言陈述，并提供了客观的数值数据。没有主观或模棱两可的术语。\n- **完整性和一致性**：该问题是自洽的，提供了执行所需计算的所有必要信息。单位（$\\text{MPa}$）是一致的。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的、适定的且完整的。它被认为是**有效的**。现在将展开解答。\n\n第一步是确定主应力，即柯西应力张量 $\\boldsymbol{\\sigma}$ 的特征值。特征值 $\\lambda$ 是特征方程 $\\det(\\boldsymbol{\\sigma} - \\lambda\\mathbf{I}) = 0$ 的根，其中 $\\mathbf{I}$ 是单位矩阵。\n\n给定应力张量的特征方程为：\n$$\n\\det \\begin{pmatrix} 150 - \\lambda  30  0 \\\\ 30  150 - \\lambda  0 \\\\ 0  0  -20 - \\lambda \\end{pmatrix} = 0\n$$\n为简化计算，我们沿第三行展开行列式：\n$$\n(-20 - \\lambda) \\det \\begin{pmatrix} 150 - \\lambda  30 \\\\ 30  150 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-20 - \\lambda) \\left[ (150 - \\lambda)^2 - 30^2 \\right] = 0\n$$\n此方程给出特征值。从第一个因子可以立即看出一个根：\n$$\n-20 - \\lambda = 0 \\implies \\lambda_A = -20\n$$\n另外两个根从第二个因子中求得：\n$$\n(150 - \\lambda)^2 - 30^2 = 0\n$$\n这是一个平方差公式，可以因式分解为：\n$$\n( (150 - \\lambda) - 30 ) ( (150 - \\lambda) + 30 ) = 0\n$$\n$$\n(120 - \\lambda)(180 - \\lambda) = 0\n$$\n这给出了剩下的两个根：\n$$\n\\lambda_B = 120 \\quad \\text{and} \\quad \\lambda_C = 180\n$$\n三个主应力即为特征值 $\\{180, 120, -20\\}$，单位为 $\\text{MPa}$。按照惯例，将它们排序为 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$。\n$$\n\\sigma_1 = 180 \\; \\text{MPa}\n$$\n$$\n\\sigma_2 = 120 \\; \\text{MPa}\n$$\n$$\n\\sigma_3 = -20 \\; \\text{MPa}\n$$\n\n接下来，我们计算最大切应力 $\\tau_{\\max}$。在主坐标系中，应力张量是对角矩阵。作用在单位法向量为 $\\mathbf{n} = (n_1, n_2, n_3)^T$ 的平面上的引力矢量 $\\mathbf{t}$ 由 $\\mathbf{t} = \\boldsymbol{\\sigma}_{\\text{diag}} \\mathbf{n} = (\\sigma_1 n_1, \\sigma_2 n_2, \\sigma_3 n_3)^T$ 给出。引力矢量的法向分量为 $t_n = \\mathbf{t} \\cdot \\mathbf{n} = \\sigma_1 n_1^2 + \\sigma_2 n_2^2 + \\sigma_3 n_3^2$。切引力矢量模量的平方为 $\\tau^2 = |\\mathbf{t}|^2 - t_n^2$。一个标准结论是，当法向量 $\\mathbf{n}$ 位于平分两个主方向的平面上时，该函数达到最大值。由此产生的切应力称为主切应力：\n$$\n\\tau_1 = \\frac{|\\sigma_2 - \\sigma_3|}{2} = \\frac{|120 - (-20)|}{2} = \\frac{140}{2} = 70 \\; \\text{MPa}\n$$\n$$\n\\tau_2 = \\frac{|\\sigma_1 - \\sigma_3|}{2} = \\frac{|180 - (-20)|}{2} = \\frac{200}{2} = 100 \\; \\text{MPa}\n$$\n$$\n\\tau_3 = \\frac{|\\sigma_1 - \\sigma_2|}{2} = \\frac{|180 - 120|}{2} = \\frac{60}{2} = 30 \\; \\text{MPa}\n$$\n最大切应力 $\\tau_{\\max}$ 是这些值中的最大者：\n$$\n\\tau_{\\max} = \\max(\\tau_1, \\tau_2, \\tau_3) = 100 \\; \\text{MPa}\n$$\n这证实了所要求的关系，因为主应力的最大两两之差为 $\\sigma_1 - \\sigma_3 = 180 - (-20) = 200 \\; \\text{MPa}$，其一半为 $\\frac{200}{2} = 100 \\; \\text{MPa}$，这与我们计算出的 $\\tau_{\\max}$ 相等。\n\n现在，我们使用主应力计算 Tresca 和 von Mises 等效应力。\n\nTresca 等效应力 $\\sigma_T$ 定义为最大切应力的两倍，或等效地，定义为任意两个主应力之间的最大差值：\n$$\n\\sigma_T = 2 \\tau_{\\max} = \\sigma_1 - \\sigma_3\n$$\n$$\n\\sigma_T = 180 - (-20) = 200 \\; \\text{MPa}\n$$\n\nvon Mises 等效应力 $\\sigma_v$ 根据主应力定义为：\n$$\n\\sigma_v = \\sqrt{\\frac{1}{2}\\left[ (\\sigma_1 - \\sigma_2)^2 + (\\sigma_2 - \\sigma_3)^2 + (\\sigma_3 - \\sigma_1)^2 \\right]}\n$$\n代入主应力值：\n$$\n\\sigma_v = \\sqrt{\\frac{1}{2}\\left[ (180 - 120)^2 + (120 - (-20))^2 + (-20 - 180)^2 \\right]}\n$$\n$$\n\\sigma_v = \\sqrt{\\frac{1}{2}\\left[ 60^2 + 140^2 + (-200)^2 \\right]}\n$$\n$$\n\\sigma_v = \\sqrt{\\frac{1}{2}\\left[ 3600 + 19600 + 40000 \\right]}\n$$\n$$\n\\sigma_v = \\sqrt{\\frac{1}{2}(63200)} = \\sqrt{31600}\n$$\n确切值为 $\\sigma_v = \\sqrt{400 \\times 79} = 20\\sqrt{79} \\; \\text{MPa}$。\n\n问题要求报告最大切应力 $\\tau_{\\max} = 100 \\; \\text{MPa}$，并四舍五入至四位有效数字。这得到 $100.0 \\; \\text{MPa}$。",
            "answer": "$$\n\\boxed{100.0}\n$$"
        },
        {
            "introduction": "虽然计算主应力是一种直接的方法，但高等连续介质力学提供了一种更为优雅和强大的方法，即使用应力不变量。本练习要求你通过两条不同路径计算等效应力：一条基于主应力，另一条基于应力不变量（如$J_2$和Lode角）。完成此练习不仅能验证这两种方法的等价性，还能凸显基于不变量方法的计算优势。",
            "id": "3562810",
            "problem": "在一个三维加载下的各向同性固体中的一个材料点，其柯西应力张量的笛卡尔分量由下式给出\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n50  30  0\\\\\n30  -10  0\\\\\n0  0  20\n\\end{pmatrix}\\ \\text{MPa}.\n$$\n仅从柯西应力张量及其偏量部分的主不变量的定义，以及最大剪应力的定义出发，完成以下任务：\n- 使用一种不显式对角化张量的基于不变量的路径，计算该点的 von Mises 等效应力和 Tresca 等效应力。具体而言，你的路径应从分解式 $\\boldsymbol{\\sigma}=\\boldsymbol{s}+\\frac{I_1}{3}\\boldsymbol{I}$、偏应力 $\\boldsymbol{s}$ 的第二和第三不变量 $J_2$ 和 $J_3$ 出发，对于 Tresca 准则，还需使用由不变量定义的 Lode 角。如果引入任何角度，必须以弧度表示。\n- 独立地，通过直接计算求出主应力，并从主值计算出相同的两个等效应力，从而验证对于此应力状态，基于不变量的方法和基于主值的方法是等价的。\n\n将 von Mises 等效应力和 Tresca 等效应力均以精确表达式报告。最终值以 MPa 为单位表示。无需四舍五入。以单行矩阵 $\\bigl[\\ \\sigma_{\\mathrm{vM}}\\ \\ \\sigma_{\\mathrm{T}}\\ \\bigr]$ 的形式提供你的最终两个答案。",
            "solution": "首先对问题进行验证。\n\n### 第1步：提取已知条件\n- 柯西应力张量：\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n50  30  0\\\\\n30  -10  0\\\\\n0  0  20\n\\end{pmatrix}\\ \\text{MPa}.\n$$\n- 材料是各向同性的。\n- 任务1：使用基于不变量的路径计算 von Mises 等效应力 ($\\sigma_{\\mathrm{vM}}$) 和 Tresca 等效应力 ($\\sigma_{\\mathrm{T}}$)。\n- 该路径必须使用分解式 $\\boldsymbol{\\sigma}=\\boldsymbol{s}+\\frac{I_1}{3}\\boldsymbol{I}$、偏应力 $\\boldsymbol{s}$ 的第二和第三不变量 ($J_2$, $J_3$)，以及由 $\\sin(3\\theta) = \\frac{3\\sqrt{3}}{2} \\frac{J_3}{J_2^{3/2}}$ 定义的 Lode 角 $\\theta$。\n- 任务2：独立计算主应力，并用它们求出 $\\sigma_{\\mathrm{vM}}$ 和 $\\sigma_{\\mathrm{T}}$，以验证任务1的结果。\n- $\\sigma_{\\mathrm{vM}}$ 和 $\\sigma_{\\mathrm{T}}$ 的最终答案必须是精确表达式，单位为 MPa。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题使用了连续介质力学的基本概念，特别是弹性和塑性理论（应力张量、不变量、屈服准则）。所有概念都是标准且成熟的。应力张量是对称的，符合柯西应力张量的要求。\n- **适定性：** 该问题提供了所有必要的信息（应力张量）和清晰的指令，要求通过两种不同但等价的方法计算特定的、唯一定义的量（$\\sigma_{\\mathrm{vM}}$ 和 $\\sigma_{\\mathrm{T}}$）。\n- **客观性：** 问题陈述精确、量化，没有任何主观或模糊的语言。\n\n### 第3步：结论与行动\n该问题是有效的。它在科学上是合理的，问题是适定的，并且是客观的。将提供完整的解答。\n\n解答按问题陈述的要求分为两部分。\n\n**第1部分：基于不变量的计算**\n\n给定的柯西应力张量为\n$$\n\\boldsymbol{\\sigma}=\\begin{pmatrix}\n50  30  0\\\\\n30  -10  0\\\\\n0  0  20\n\\end{pmatrix}\\ \\text{MPa}.\n$$\n第一步是将应力张量分解为其静水部分和偏量部分。应力张量的第一主不变量 $I_1$ 是 $\\boldsymbol{\\sigma}$ 的迹。\n$$\nI_1 = \\mathrm{tr}(\\boldsymbol{\\sigma}) = \\sigma_{11} + \\sigma_{22} + \\sigma_{33} = 50 + (-10) + 20 = 60\\ \\text{MPa}.\n$$\n静水压力为 $p = \\frac{I_1}{3} = \\frac{60}{3} = 20\\ \\text{MPa}$。静水应力张量为 $p\\boldsymbol{I}$。\n偏应力张量 $\\boldsymbol{s}$ 定义为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\boldsymbol{I}$。\n$$\n\\boldsymbol{s} = \\begin{pmatrix}\n50  30  0\\\\\n30  -10  0\\\\\n0  0  20\n\\end{pmatrix} - \\begin{pmatrix}\n20  0  0\\\\\n0  20  0\\\\\n0  0  20\n\\end{pmatrix} = \\begin{pmatrix}\n30  30  0\\\\\n30  -30  0\\\\\n0  0  0\n\\end{pmatrix}\\ \\text{MPa}.\n$$\n偏应力张量的第二不变量 $J_2$ 由 $J_2 = \\frac{1}{2} s_{ij}s_{ji} = \\frac{1}{2}\\mathrm{tr}(\\boldsymbol{s}^2)$ 给出。\n$$\nJ_2 = \\frac{1}{2} \\left[ s_{11}^2 + s_{22}^2 + s_{33}^2 + 2(s_{12}^2 + s_{23}^2 + s_{31}^2) \\right]\n$$\n$$\nJ_2 = \\frac{1}{2} \\left[ 30^2 + (-30)^2 + 0^2 + 2(30^2 + 0^2 + 0^2) \\right] = \\frac{1}{2} [ 900 + 900 + 2(900) ] = \\frac{3600}{2} = 1800\\ \\text{MPa}^2.\n$$\nvon Mises 等效应力 $\\sigma_{\\mathrm{vM}}$ 用 $J_2$ 定义为：\n$$\n\\sigma_{\\mathrm{vM}} = \\sqrt{3 J_2} = \\sqrt{3 \\times 1800} = \\sqrt{5400} = \\sqrt{900 \\times 6} = 30\\sqrt{6}\\ \\text{MPa}.\n$$\n为了求出 Tresca 等效应力，我们首先计算偏应力张量的第三不变量 $J_3 = \\det(\\boldsymbol{s})$。\n$$\nJ_3 = \\det \\begin{pmatrix}\n30  30  0\\\\\n30  -30  0\\\\\n0  0  0\n\\end{pmatrix} = 30((-30)(0) - 0) - 30((30)(0) - 0) + 0 = 0\\ \\text{MPa}^3.\n$$\nLode 角 $\\theta$ 在问题中定义为满足 $\\sin(3\\theta) = \\frac{3\\sqrt{3}}{2} \\frac{J_3}{J_2^{3/2}}$。\n当 $J_3 = 0$ 时，我们有 $\\sin(3\\theta) = 0$。对于 Lode 角的常规范围 $-\\frac{\\pi}{6} \\le \\theta \\le \\frac{\\pi}{6}$，这意味着 $3\\theta = 0$，所以 $\\theta = 0$ 弧度。\nTresca 等效应力 $\\sigma_{\\mathrm{T}}$ 可以用 $J_2$ 和 Lode 角 $\\theta$ 表示为：\n$$\n\\sigma_{\\mathrm{T}} = 2 \\sqrt{J_2} \\cos(\\theta).\n$$\n代入 $J_2$ 和 $\\theta$ 的值：\n$$\n\\sigma_{\\mathrm{T}} = 2 \\sqrt{1800} \\cos(0) = 2 \\sqrt{900 \\times 2} \\times 1 = 2 \\times 30\\sqrt{2} = 60\\sqrt{2}\\ \\text{MPa}.\n$$\n\n**第2部分：主应力计算与验证**\n\n我们现在通过求解柯西应力张量 $\\boldsymbol{\\sigma}$ 的特征值来计算主应力。特征方程为 $\\det(\\boldsymbol{\\sigma} - \\lambda\\boldsymbol{I}) = 0$。\n$$\n\\det \\begin{pmatrix}\n50-\\lambda  30  0\\\\\n30  -10-\\lambda  0\\\\\n0  0  20-\\lambda\n\\end{pmatrix} = 0.\n$$\n由于其块对角结构，一个特征值可以立即看出：\n$$\n(20-\\lambda) \\left[ (50-\\lambda)(-10-\\lambda) - (30)(30) \\right] = 0.\n$$\n一个主应力是 $\\lambda = 20\\ \\text{MPa}$。另外两个可以从以下二次方程中求出：\n$$\n\\lambda^2 - 40\\lambda - 500 - 900 = 0 \\implies \\lambda^2 - 40\\lambda - 1400 = 0.\n$$\n使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$\n\\lambda = \\frac{40 \\pm \\sqrt{(-40)^2 - 4(1)(-1400)}}{2} = \\frac{40 \\pm \\sqrt{1600 + 5600}}{2} = \\frac{40 \\pm \\sqrt{7200}}{2}.\n$$\n由于 $7200 = 3600 \\times 2$，我们有 $\\sqrt{7200} = 60\\sqrt{2}$。\n$$\n\\lambda = \\frac{40 \\pm 60\\sqrt{2}}{2} = 20 \\pm 30\\sqrt{2}\\ \\text{MPa}.\n$$\n三个主应力是 $20+30\\sqrt{2}$、$20$ 和 $20-30\\sqrt{2}$。按照惯例，我们将它们排序为 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$：\n$$\n\\sigma_1 = 20 + 30\\sqrt{2}\\ \\text{MPa},\n$$\n$$\n\\sigma_2 = 20\\ \\text{MPa},\n$$\n$$\n\\sigma_3 = 20 - 30\\sqrt{2}\\ \\text{MPa}.\n$$\n现在，我们从这些主值计算等效应力。von Mises 等效应力为：\n$$\n\\sigma_{\\mathrm{vM}} = \\sqrt{\\frac{1}{2} [(\\sigma_1-\\sigma_2)^2 + (\\sigma_2-\\sigma_3)^2 + (\\sigma_3-\\sigma_1)^2]}.\n$$\n差值为：\n$\\sigma_1-\\sigma_2 = (20 + 30\\sqrt{2}) - 20 = 30\\sqrt{2}$。\n$\\sigma_2-\\sigma_3 = 20 - (20 - 30\\sqrt{2}) = 30\\sqrt{2}$。\n$\\sigma_3-\\sigma_1 = (20 - 30\\sqrt{2}) - (20 + 30\\sqrt{2}) = -60\\sqrt{2}$。\n将这些值代入 $\\sigma_{\\mathrm{vM}}$ 的公式中：\n$$\n\\sigma_{\\mathrm{vM}} = \\sqrt{\\frac{1}{2} [ (30\\sqrt{2})^2 + (30\\sqrt{2})^2 + (-60\\sqrt{2})^2 ]} = \\sqrt{\\frac{1}{2} [ 1800 + 1800 + 7200 ]} = \\sqrt{\\frac{10800}{2}} = \\sqrt{5400}.\n$$\n$$\n\\sigma_{\\mathrm{vM}} = 30\\sqrt{6}\\ \\text{MPa}.\n$$\n这个结果与基于不变量的方法得到的结果相匹配。\nTresca 等效应力是任意两个主应力之差的最大值（最大剪应力的两倍）：\n$$\n\\sigma_{\\mathrm{T}} = \\max(|\\sigma_1-\\sigma_2|, |\\sigma_2-\\sigma_3|, |\\sigma_3-\\sigma_1|) = \\sigma_1 - \\sigma_3.\n$$\n$$\n\\sigma_{\\mathrm{T}} = (20 + 30\\sqrt{2}) - (20 - 30\\sqrt{2}) = 60\\sqrt{2}\\ \\text{MPa}.\n$$\n这个结果也与基于不变量的方法得到的结果相匹配。\n因此，对于此应力状态，两种方法的等价性得到了验证。最终值为 $\\sigma_{\\mathrm{vM}} = 30\\sqrt{6}$ MPa 和 $\\sigma_{\\mathrm{T}} = 60\\sqrt{2}$ MPa。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 30\\sqrt{6}  60\\sqrt{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从理论练习走向实际的工程分析，需要稳健的数值工具。本练习旨在提升你的编程和计算能力，要求你构建一个程序，使用工业标准的QR算法来计算主应力。通过针对具有挑战性的边界情况（如重根或近简并特征值）测试你的代码，你将深入理解真实世界计算力学软件所需的数值稳定性。",
            "id": "3562871",
            "problem": "您的任务是构建一个完整、可运行的程序，该程序使用基于带位移的商-余分解（QR分解）算法的稳健特征求解器来计算对称柯西应力张量的主应力，然后从第一性原理出发评估 von Mises 和 Tresca 等效应力。该程序必须在不调用任何高级特征值程序的情况下实现主应力计算例程，并且对于包括重复特征值和近简并谱在内的边界情况必须是数值稳定的。\n\n基本原理：\n- 根据角动量守恒定律，在没有分布力偶的连续体中，柯西应力张量 $\\boldsymbol{\\sigma}$ 是对称的，因此其特征值是实数，并对应于主应力。\n- 主应力是 $\\boldsymbol{\\sigma}$ 的特征多项式的根，可以通过迭代正交相似变换（如带位移的 $QR$ 算法）获得。\n- von Mises 等效应力由偏应力张量的第二不变量定义，而 Tresca 度量由最大剪应力准则定义，两者都基于主应力。\n\n任务：\n- 实现一个例程，对于给定的对称 $3 \\times 3$ 矩阵 $\\boldsymbol{\\sigma}$（其元素单位为帕斯卡 (Pascal (Pa))），通过迭代一个带位移的 $QR$ 算法来计算其三个主应力。该算法使用从末尾的 $2 \\times 2$ 子块中选择的隐式位移（Wilkinson 位移）。使用与矩阵范数相关的收敛容差，并在每次迭代后进行对称化以保持对称性。如果超过最大迭代次数，您可以安全地回退到数值稳定的对称特征求解器。\n- 根据计算出的主应力 $\\sigma_1$、$\\sigma_2$、$\\sigma_3$，计算：\n  - 基于偏应力不变量的 von Mises 等效应力 $\\sigma_{vm}$。\n  - 基于最大主应力差的 Tresca 等效应力 $\\sigma_{tr}$。\n- 将最终的等效应力以兆帕 (Megapascal (MPa)) 表示，并将每个值四舍五入到三位小数。\n\n此问题不涉及角度单位。\n\n测试套件：\n为以下六个对称柯西应力张量计算 von Mises 和 Tresca 等效应力，每个张量的单位均为 $\\text{Pa}$：\n1. 静水均匀压力：\n   $$\\boldsymbol{\\sigma}^{(1)} = \\begin{bmatrix} 100\\times 10^6  0  0 \\\\ 0  100\\times 10^6  0 \\\\ 0  0  100\\times 10^6 \\end{bmatrix}.$$\n2. 单轴拉伸：\n   $$\\boldsymbol{\\sigma}^{(2)} = \\begin{bmatrix} 200\\times 10^6  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}.$$\n3. 在 $x$-$y$ 平面上的纯剪切，剪切量为 $100\\times 10^6$：\n   $$\\boldsymbol{\\sigma}^{(3)} = \\begin{bmatrix} 0  100\\times 10^6  0 \\\\ 100\\times 10^6  0  0 \\\\ 0  0  0 \\end{bmatrix}.$$\n4. 近重复特征值（近简并谱）：\n   $$\\boldsymbol{\\sigma}^{(4)} = \\begin{bmatrix} 150\\times 10^6  0  0 \\\\ 0  150\\times 10^6  0 \\\\ 0  0  149.999999\\times 10^6 \\end{bmatrix}.$$\n5. 近简并的非对角耦合：\n   $$\\boldsymbol{\\sigma}^{(5)} = \\begin{bmatrix} 100\\times 10^6  10^{-3}  0 \\\\ 10^{-3}  100\\times 10^6  0 \\\\ 0  0  100\\times 10^6 \\end{bmatrix}.$$\n6. 双轴等拉伸：\n   $$\\boldsymbol{\\sigma}^{(6)} = \\begin{bmatrix} 100\\times 10^6  0  0 \\\\ 0  100\\times 10^6  0 \\\\ 0  0  0 \\end{bmatrix}.$$\n\n输出规范：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。\n- 每个测试用例的结果必须是一个双元素列表 $[\\sigma_{vm}, \\sigma_{tr}]$，其中两个条目都是以 $\\text{MPa}$ 为单位的浮点数，且均四舍五入到三位小数。\n- 因此，最终输出必须如下所示\n  $$[\\,[\\sigma_{vm}^{(1)},\\sigma_{tr}^{(1)}],\\,[\\sigma_{vm}^{(2)},\\sigma_{tr}^{(2)}],\\,\\dots,\\,[\\sigma_{vm}^{(6)},\\sigma_{tr}^{(6)}]\\,].$$",
            "solution": "该问题要求构建一个程序，为一组给定的对称 `$3 \\times 3$` 柯西应力张量计算 von Mises 和 Tresca 等效应力。这涉及一个两步过程：首先，确定主应力，即应力张量的特征值；其次，将等效应力度量的定义应用于这些主应力。\n\n对问题陈述的验证证实了其科学基础扎实、提法恰当、客观，并且不包含任何内在缺陷。主应力、带位移的QR算法以及 von Mises 和 Tresca 屈服准则等概念是计算固体力学的基本原则。所提供的测试用例代表了具有物理意义的应力状态。因此，我们着手提供一个完整的解决方案。\n\n### 第一部分：主应力计算\n\n柯西应力张量 $\\boldsymbol{\\sigma}$ 的主应力（$\\sigma_1$, $\\sigma_2$, $\\sigma_3$）是其特征值。由于角动量守恒要求在没有体力偶的连续体中 $\\boldsymbol{\\sigma}$ 是对称的，因此其特征值保证为实数。该问题指定实现一个带位移的商-余（QR）算法来找到这些特征值。\n\nQR 算法是一种用于寻找特征值的迭代方法。对于矩阵 $\\mathbf{A}$，单次迭代包括执行 QR 分解 $\\mathbf{A}_k = \\mathbf{Q}_k \\mathbf{R}_k$，然后通过反向乘法形成下一个迭代矩阵 $\\mathbf{A}_{k+1} = \\mathbf{R}_k \\mathbf{Q}_k$。这构成了一个相似变换 $\\mathbf{A}_{k+1} = \\mathbf{Q}_k^\\top \\mathbf{A}_k \\mathbf{Q}_k$，它保持特征值不变。对于对称矩阵，矩阵序列 $\\mathbf{A}_k$ 会收敛到一个对角矩阵，其对角线元素是原始矩阵 $\\mathbf{A}$ 的特征值。\n\n通过在每次迭代中使用位移 $\\mu_k$，可以显著加速收敛。带位移的 QR 迭代定义为：\n$$\n\\mathbf{A}_k - \\mu_k \\mathbf{I} = \\mathbf{Q}_k \\mathbf{R}_k \\\\\n\\mathbf{A}_{k+1} = \\mathbf{R}_k \\mathbf{Q}_k + \\mu_k \\mathbf{I}\n$$\n对于对称矩阵，一种特别有效的策略是 Wilkinson 位移。位移 $\\mu_k$ 被选为 $\\mathbf{A}_k$ 的末尾 `$2 \\times 2$` 子矩阵中更接近右下角元素 $\\mathbf{A}_k(n, n)$ 的那个特征值。对于一个通用的 `$n \\times n$` 对称矩阵 $\\mathbf{A}$，其末尾 `$2 \\times 2$` 子矩阵为：\n$$\n\\begin{bmatrix} a  b \\\\ b  c \\end{bmatrix}\n$$\n其中 $a = \\mathbf{A}(n-1, n-1)$，$b = \\mathbf{A}(n-1, n)$，且 $c = \\mathbf{A}(n, n)$，Wilkinson 位移 $\\mu$ 为：\n$$\n\\mu = c - \\frac{\\text{sgn}(\\delta) b^2}{|\\delta| + \\sqrt{\\delta^2 + b^2}}\n$$\n其中 $\\delta = (a-c)/2$。为了保证稳健性，使用一个在 $\\delta=0$ 时返回 `$1$` 的符号函数 $\\text{sgn}(\\delta)$。\n\n我们对给定的 `$3 \\times 3$` 张量的实现将首先检查是否存在任何预先存在的块对角结构（一种缩减形式）。如果一个非对角块为零（在很小的容差范围内），问题将解耦为一个更小的特征值问题，可以直接求解。例如，如果 $\\sigma_{13}$ 和 $\\sigma_{23}$ 为零，则 $\\sigma_{33}$ 是一个特征值，剩下的两个可以从左上角的 `$2 \\times 2$` 子矩阵中找到。一个对称的 `$2 \\times 2$` 矩阵 $\\begin{psmallmatrix} a  b \\\\ b  d \\end{psmallmatrix}$ 的特征值由解析公式 $\\lambda = \\frac{a+d}{2} \\pm \\sqrt{\\left(\\frac{a-d}{2}\\right)^2 + b^2}$ 给出。\n\n如果矩阵不是块对角的，则应用带有 Wilkinson 位移的迭代QR算法。为了防止浮点误差累积，每次迭代后都对矩阵进行显式对称化：$\\mathbf{A}_{k+1} \\leftarrow (\\mathbf{A}_{k+1} + \\mathbf{A}_{k+1}^\\top)/2$。迭代持续进行，直到非对角元素的平方和低于一个容差，该容差是相对于矩阵的初始范数设置的。如果算法在指定的最大迭代次数内未能收敛，则按照问题陈述的许可，采用一个基于库的稳健对称特征求解器（`scipy.linalg.eigh`）作为备用方案。\n\n### 第二部分：等效应力计算\n\n一旦计算出主应力 $\\sigma_1, \\sigma_2, \\sigma_3$（单位为帕斯卡，$\\text{Pa}$），就可以计算等效应力度量。\n\n**Von Mises 等效应力 ($\\sigma_{vm}$):**\nvon Mises 屈服准则基于偏应力张量的第二不变量 $J_2$。等效应力 $\\sigma_{vm}$ 是一个标量度量，用于衡量复杂应力状态，可以与材料在简单拉伸下的屈服强度进行比较。用主应力表示，其公式为：\n$$\n\\sigma_{vm} = \\sqrt{\\frac{1}{2}\\left[(\\sigma_1 - \\sigma_2)^2 + (\\sigma_2 - \\sigma_3)^2 + (\\sigma_3 - \\sigma_1)^2\\right]}\n$$\n\n**Tresca 等效应力 ($\\sigma_{tr}$):**\nTresca 屈服准则，即最大剪应力理论，假定当材料中的最大剪应力达到单轴拉伸试验中屈服时的最大剪应力时，材料开始屈服。最大剪应力是最大主应力和最小主应力之差的一半。因此，Tresca 等效应力为：\n$$\n\\sigma_{tr} = \\max(|\\sigma_1 - \\sigma_2|, |\\sigma_2 - \\sigma_3|, |\\sigma_3 - \\sigma_1|)\n$$\n如果主应力按 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3$ 的顺序排列，则公式简化为：\n$$\n\\sigma_{tr} = \\sigma_1 - \\sigma_3\n$$\n\n### 第三部分：单位与最终输出\n\n输入的应力值单位为帕斯卡 ($\\text{Pa}$)。所有中间计算，包括主应力和最终的等效应力，都使用此单位进行。然后将计算出的 $\\sigma_{vm}$ 和 $\\sigma_{tr}$ 的最终值除以 $10^6$ 转换为兆帕 ($\\text{MPa}$)。根据要求，这些结果被四舍五入到三位小数。最终输出被格式化为单行，其中包含每个测试用例的 `[$\\sigma_{vm}, \\sigma_{tr}$]` 对的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem.\n    Defines test cases, computes principal and equivalent stresses, and prints the result.\n    \"\"\"\n\n    def compute_principal_stresses(sigma, max_iter=100, tol_factor=1e-14):\n        \"\"\"\n        Computes the principal stresses (eigenvalues) of a 3x3 symmetric matrix.\n        \n        It first checks for block-diagonal structures for direct analytical solutions.\n        If the matrix is full, it uses an explicit shifted QR algorithm with a Wilkinson shift.\n        If the QR algorithm does not converge, it falls back to scipy.linalg.eigh.\n\n        Args:\n            sigma (np.ndarray): The 3x3 symmetric stress tensor.\n            max_iter (int): Maximum number of QR iterations.\n            tol_factor (float): Factor for setting the convergence tolerance.\n\n        Returns:\n            np.ndarray: An array containing the three principal stresses.\n        \"\"\"\n        n = sigma.shape[0]\n        if n != 3:\n            raise ValueError(\"Input matrix must be 3x3.\")\n\n        A = np.copy(sigma).astype(np.float64)\n        \n        # Tolerance based on the initial matrix norm\n        initial_norm = np.linalg.norm(A, 'fro')\n        # Handle zero matrix case\n        if initial_norm == 0:\n            return np.zeros(3)\n        tolerance = tol_factor * initial_norm\n\n        # Helper for 2x2 analytical eigenvalues\n        def eig_2x2(sub_matrix):\n            a, b, d = sub_matrix[0, 0], sub_matrix[0, 1], sub_matrix[1, 1]\n            trace = a + d\n            det = a * d - b * b\n            discriminant = np.sqrt(max(0, trace**2 - 4 * det))\n            return np.array([(trace + discriminant) / 2, (trace - discriminant) / 2])\n\n        # Check for block-diagonal structure (deflation)\n        if np.abs(A[0, 2])  tolerance and np.abs(A[1, 2])  tolerance:\n            eig1 = A[2, 2]\n            eigs_2x2 = eig_2x2(A[:2, :2])\n            return np.array([eig1, eigs_2x2[0], eigs_2x2[1]])\n        if np.abs(A[0, 1])  tolerance and np.abs(A[0, 2])  tolerance:\n            eig1 = A[0, 0]\n            eigs_2x2 = eig_2x2(A[1:, 1:])\n            return np.array([eig1, eigs_2x2[0], eigs_2x2[1]])\n        if np.abs(A[0, 1])  tolerance and np.abs(A[1, 2])  tolerance: # For tridiagonal case\n            # This is a bit more complex, but QR should handle it easily.\n            pass\n\n        # Iterative QR algorithm for a full 3x3 matrix\n        for _ in range(max_iter):\n            off_diag_norm_sq = np.sum(A**2) - np.sum(np.diag(A)**2)\n            if np.sqrt(off_diag_norm_sq)  tolerance:\n                return np.diag(A)\n\n            # Wilkinson shift calculation from trailing 2x2 submatrix\n            a, b, c = A[n-2, n-2], A[n-2, n-1], A[n-1, n-1]\n            \n            if np.abs(b)  tolerance:\n                mu = c\n            else:\n                delta = (a - c) / 2\n                # Robust formula for the shift\n                sign_delta = np.sign(delta) if delta != 0 else 1.0\n                mu = c - (sign_delta * b**2) / (np.abs(delta) + np.sqrt(delta**2 + b**2))\n\n            # Explicit shifted QR step\n            Q, R = np.linalg.qr(A - mu * np.identity(n))\n            A = R @ Q + mu * np.identity(n)\n\n            # Enforce symmetry to counteract floating-point errors\n            A = (A + A.T) / 2\n\n        # Fallback to a robust solver if convergence is not achieved\n        eigenvalues, _ = eigh(sigma)\n        return eigenvalues\n\n    def compute_equivalent_stresses(principal_stresses):\n        \"\"\"\n        Computes von Mises and Tresca equivalent stresses from principal stresses.\n\n        Args:\n            principal_stresses (np.ndarray): Array of three principal stresses in Pa.\n\n        Returns:\n            list: A list containing [sigma_vm_mpa, sigma_tr_mpa], rounded to 3 decimals.\n        \"\"\"\n        s1, s2, s3 = principal_stresses\n\n        # Von Mises stress in Pa\n        vm_sq = 0.5 * ((s1 - s2)**2 + (s2 - s3)**2 + (s3 - s1)**2)\n        sigma_vm = np.sqrt(max(0, vm_sq))\n\n        # Tresca stress in Pa (maximum shear stress criterion)\n        # Simplified by sorting the principal stresses\n        stresses_sorted = np.sort(principal_stresses)\n        sigma_tr = stresses_sorted[2] - stresses_sorted[0]\n        \n        # Convert from Pa to MPa and round to 3 decimal places\n        sigma_vm_mpa = round(sigma_vm / 1e6, 3)\n        sigma_tr_mpa = round(sigma_tr / 1e6, 3)\n\n        return [sigma_vm_mpa, sigma_tr_mpa]\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        np.array([[100e6, 0, 0], [0, 100e6, 0], [0, 0, 100e6]]),\n        np.array([[200e6, 0, 0], [0, 0, 0], [0, 0, 0]]),\n        np.array([[0, 100e6, 0], [100e6, 0, 0], [0, 0, 0]]),\n        np.array([[150e6, 0, 0], [0, 150e6, 0], [0, 0, 149.999999e6]]),\n        np.array([[100e6, 1e-3, 0], [1e-3, 100e6, 0], [0, 0, 100e6]]),\n        np.array([[100e6, 0, 0], [0, 100e6, 0], [0, 0, 0]]),\n    ]\n\n    results = []\n    for sigma_tensor in test_cases:\n        p_stresses = compute_principal_stresses(sigma_tensor)\n        eq_stresses = compute_equivalent_stresses(p_stresses)\n        results.append(eq_stresses)\n    \n    # Format the final output string as specified\n    output_str = f\"[[{results[0][0]:.3f},{results[0][1]:.3f}],[{results[1][0]:.3f},{results[1][1]:.3f}],[{results[2][0]:.3f},{results[2][1]:.3f}],[{results[3][0]:.3f},{results[3][1]:.3f}],[{results[4][0]:.3f},{results[4][1]:.3f}],[{results[5][0]:.3f},{results[5][1]:.3f}]]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}