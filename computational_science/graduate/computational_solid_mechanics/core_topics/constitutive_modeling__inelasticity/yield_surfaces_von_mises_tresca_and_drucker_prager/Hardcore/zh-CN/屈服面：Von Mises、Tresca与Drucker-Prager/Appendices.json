{
    "hands_on_practices": [
        {
            "introduction": "冯·米塞斯（von Mises）和特雷斯卡（Tresca）屈服准则是金属塑性力学理论的基石。虽然冯·米塞斯准则在数学上更为便捷，但特雷斯卡准则在某些情况下更为保守。本练习旨在量化这两种准则在单轴拉伸条件下校准一致时的差异。通过解析推导在平面应力状态下两者之间的最大偏差，您将对它们的几何关系建立更深刻的直观认识，并理解在工程实践中选择不同模型所带来的具体影响。",
            "id": "3610540",
            "problem": "考虑计算固体力学中的各向同性、压力无关塑性问题，其处于平面应力状态，主应力为 $(\\sigma_1,\\sigma_2,0)$。Tresca 屈服条件根据主应力定义为：当主应力之间的最大差值等于单轴拉伸屈服应力 $\\sigma_y$ 时，材料开始屈服。Hencky–von Mises（也称为 $J_2$）屈服条件定义为：当 $\\sqrt{3 J_2} = \\sigma_y$ 时，材料开始屈服，其中 $J_2$ 是偏应力张量的第二不变量。\n\n假设您使用 Hencky–von Mises 来近似 Tresca，并校准这两个准则以匹配相同的单轴拉伸屈服应力 $\\sigma_y$。对于一个固定的双轴应力方向 $(\\sigma_1,\\sigma_2,0)$，定义 $t_T$ 和 $t_V$ 为正标量乘子，使得 $t_T(\\sigma_1,\\sigma_2,0)$ 位于 Tresca 屈服面上，而 $t_V(\\sigma_1,\\sigma_2,0)$ 位于 Hencky–von Mises 屈服面上。定义 von Mises 近似相对于 Tresca 在该方向上的相对偏差为\n$$\n\\delta(\\sigma_1,\\sigma_2) = \\frac{|t_V(\\sigma_1,\\sigma_2,0) - t_T(\\sigma_1,\\sigma_2,0)|}{t_T(\\sigma_1,\\sigma_2,0)}.\n$$\n从 Tresca 和 $J_2$ 屈服准则的核心定义以及用主应力表示的第二偏应力不变量 $J_2$ 的定义出发，推导 $\\delta(\\sigma_1,\\sigma_2)$ 的表达式，并确定其在平面应力下所有双轴方向 $(\\sigma_1,\\sigma_2)$ 上的最大值。请将最终答案表示为一个闭式解析表达式，不要四舍五入。",
            "solution": "首先验证问题，以确保其科学基础扎实、提法恰当且客观。\n\n### 步骤 1：提取已知条件\n-   **物理背景**：计算固体力学中的各向同性、压力无关塑性。\n-   **应力状态**：平面应力，主应力为 $(\\sigma_1, \\sigma_2, \\sigma_3)$，其中 $\\sigma_3=0$。\n-   **Tresca 屈服条件**：当最大剪应力达到临界值时，材料开始屈服。用主应力表示为 $\\max(|\\sigma_i - \\sigma_j|) = \\sigma_y$，其中 $\\sigma_y$ 是单轴拉伸屈服应力。对于平面应力，这变为 $\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_2 - 0|, |0 - \\sigma_1|) = \\sigma_y$，简化为 $\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|) = \\sigma_y$。\n-   **Hencky–von Mises 屈服条件**：当偏应力张量的第二不变量 $J_2$ 满足 $\\sqrt{3 J_2} = \\sigma_y$ 时，材料开始屈服。\n-   **第二偏应力不变量 ($J_2$)**：用主应力表示为 $J_2 = \\frac{1}{6}[(\\sigma_1 - \\sigma_2)^2 + (\\sigma_2 - \\sigma_3)^2 + (\\sigma_3 - \\sigma_1)^2]$。\n-   **校准**：两个准则都校准到相同的单轴拉伸屈服应力 $\\sigma_y$。\n-   **标量乘子**：对于给定的双轴应力方向 $(\\sigma_1, \\sigma_2, 0)$，$t_T$ 是一个正标量，使得应力状态 $t_T(\\sigma_1, \\sigma_2, 0)$ 位于 Tresca 屈服面上。类似地，$t_V$ 是用于 Hencky–von Mises 屈服面的正标量。\n-   **相对偏差**：偏差定义为 $\\delta(\\sigma_1, \\sigma_2) = \\frac{|t_V(\\sigma_1, \\sigma_2, 0) - t_T(\\sigma_1, \\sigma_2, 0)|}{t_T(\\sigma_1, \\sigma_2, 0)}$。\n-   **目标**：推导 $\\delta(\\sigma_1, \\sigma_2)$ 的表达式，并确定其在所有双轴方向上的最大值。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学基础扎实**：该问题是塑性理论中两种广泛使用的屈服准则的标准、基本比较。Tresca 和 von Mises 准则、平面应力和 $J_2$ 的定义都是正确的，并基于连续介质力学的核心原理。\n-   **提法恰当**：问题定义清晰。它要求在一个定义明确的函数在所有双轴应力方向空间上的最大值。根据屈服面的几何特性，预期存在唯一的最大值。\n-   **客观性**：问题以精确的数学语言陈述，没有任何主观性或模糊性。\n-   **完整性**：提供了所有必要的信息和定义。\n因此，该问题被认定为**有效**。\n\n### 步骤 3：推导解答\n\n**1. 平面应力下屈服准则的公式化**\n\n首先，我们在平面应力条件（$\\sigma_3 = 0$）下，写出两个屈服面在主应力空间 $(\\sigma_1, \\sigma_2)$ 中的显式方程。\n\n**Hencky–von Mises** 准则为 $\\sqrt{3 J_2} = \\sigma_y$。将 $\\sigma_3=0$ 代入 $J_2$ 的表达式：\n$$ J_2 = \\frac{1}{6}[(\\sigma_1 - \\sigma_2)^2 + (\\sigma_2 - 0)^2 + (0 - \\sigma_1)^2] = \\frac{1}{6}[(\\sigma_1^2 - 2\\sigma_1\\sigma_2 + \\sigma_2^2) + \\sigma_2^2 + \\sigma_1^2] = \\frac{1}{3}(\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2) $$\n屈服条件变为：\n$$ \\sqrt{3 \\cdot \\frac{1}{3}(\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2)} = \\sigma_y $$\n$$ \\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2 = \\sigma_y^2 $$\n该方程描述了 $(\\sigma_1, \\sigma_2)$ 平面上的一个椭圆。\n\n平面应力（$\\sigma_3=0$）下的 **Tresca** 准则为：\n$$ \\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|) = \\sigma_y $$\n该方程描述了 $(\\sigma_1, \\sigma_2)$ 平面上的一个六边形。\n\n问题针对单轴拉伸进行了校准，例如 $(\\sigma_1, \\sigma_2) = (\\sigma_y, 0)$。\n对于 von Mises：$\\sigma_y^2 - \\sigma_y(0) + 0^2 = \\sigma_y^2$，满足条件。\n对于 Tresca：$\\max(|\\sigma_y - 0|, |\\sigma_y|, |0|) = \\sigma_y$，满足条件。\n这些公式与校准条件一致。\n\n**2. 标量乘子的表达式**\n\n考虑由向量 $(\\sigma_1, \\sigma_2)$ 定义的任意应力方向。屈服面上的应力状态为 $t(\\sigma_1, \\sigma_2)$。\n\n对于 von Mises 面，应力状态为 $(t_V \\sigma_1, t_V \\sigma_2)$。将其代入 von Mises 方程：\n$$ (t_V \\sigma_1)^2 - (t_V \\sigma_1)(t_V \\sigma_2) + (t_V \\sigma_2)^2 = \\sigma_y^2 $$\n$$ t_V^2 (\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2) = \\sigma_y^2 $$\n由于 $t_V$ 是正标量：\n$$ t_V = \\frac{\\sigma_y}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2}} $$\n\n对于 Tresca 面，应力状态为 $(t_T \\sigma_1, t_T \\sigma_2)$。将其代入 Tresca 方程：\n$$ \\max(|t_T \\sigma_1 - t_T \\sigma_2|, |t_T \\sigma_1|, |t_T \\sigma_2|) = \\sigma_y $$\n由于 $t_T$ 是正标量：\n$$ t_T \\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|) = \\sigma_y $$\n$$ t_T = \\frac{\\sigma_y}{\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|)} $$\n\n**3. 相对偏差的表达式**\n\n相对偏差 $\\delta$ 由 $\\delta = \\frac{|t_V - t_T|}{t_T} = \\left| \\frac{t_V}{t_T} - 1 \\right|$ 给出。\n我们来计算比率 $\\frac{t_V}{t_T}$：\n$$ \\frac{t_V}{t_T} = \\frac{\\frac{\\sigma_y}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2}}}{\\frac{\\sigma_y}{\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|)}} = \\frac{\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|)}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2}} $$\n在平面应力下，von Mises 椭圆外接于 Tresca 六边形，这意味着对于所有应力方向，$t_V \\ge t_T$。因此，$\\delta$ 不需要绝对值。\n$$ \\delta(\\sigma_1, \\sigma_2) = \\frac{t_V}{t_T} - 1 = \\frac{\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|)}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2}} - 1 $$\n\n**4. 偏差的最大化**\n\n为了找到 $\\delta$ 的最大值，我们需要找到比率 $\\frac{t_V}{t_T}$ 的最大值。该比率表示从原点到 von Mises 椭圆和 Tresca 六边形的径向距离之比。最大偏差将出现在两个曲面相距最远的地方。几何上，对于两个凸形，其中一个外接于另一个，并且它们在几个点（内多边形的顶点）上接触，最大径向距离比出现在内多边形一个面的中点。\n\n我们来分析对应于六边形一个面中点的应力状态。根据对称性，所有面都将产生相同的最大偏差。平面应力下的纯剪切状态由主应力 $\\sigma_1 = k$ 和 $\\sigma_2 = -k$ 表示，其中 $k$ 为某个标量。这个方向 $(\\sigma_1, \\sigma_2)=(k, -k)$ 对应于 Tresca 六边形一个面上的点。\n我们来分析应力方向 $(\\sigma_1, \\sigma_2) = (1, -1)$。\n\n对于这个方向，比率 $\\frac{t_V}{t_T}$ 的分子是：\n$$ \\max(|1 - (-1)|, |1|, |-1|) = \\max(2, 1, 1) = 2 $$\n分母是：\n$$ \\sqrt{1^2 - (1)(-1) + (-1)^2} = \\sqrt{1 + 1 + 1} = \\sqrt{3} $$\n该方向的比率为：\n$$ \\frac{t_V}{t_T} = \\frac{2}{\\sqrt{3}} $$\n\n我们来证明这是最大值。最大化 $\\frac{t_V}{t_T}$ 的问题等价于最大化其平方，这样更容易处理：\n$$ f(\\sigma_1, \\sigma_2) = \\left(\\frac{t_V}{t_T}\\right)^2 = \\frac{(\\max(|\\sigma_1 - \\sigma_2|, |\\sigma_1|, |\\sigma_2|))^2}{\\sigma_1^2 - \\sigma_1\\sigma_2 + \\sigma_2^2} $$\n我们来考察由 $\\sigma_1 - \\sigma_2 = \\sigma_y$ 定义的六边形的面，其中 $\\sigma_1 \\in [0, \\sigma_y]$ 和 $\\sigma_2 \\in [-\\sigma_y, 0]$。沿此面，一个点的形式为 $(\\sigma_1, \\sigma_1-\\sigma_y)$，且 Tresca 条件得到满足。在点 $(\\sigma_1, \\sigma_1-\\sigma_y)$ 处的比率 $\\frac{t_V}{t_T}$ 由以下公式给出：\n$$ \\frac{t_V}{t_T} = \\frac{\\sigma_y}{\\sqrt{\\sigma_1^2 - \\sigma_1(\\sigma_1-\\sigma_y) + (\\sigma_1-\\sigma_y)^2}} = \\frac{\\sigma_y}{\\sqrt{\\sigma_1^2 - \\sigma_1\\sigma_y + \\sigma_y^2}} $$\n为了最大化这个比率，我们必须最小化分母平方根内的表达式：$g(\\sigma_1) = \\sigma_1^2 - \\sigma_1\\sigma_y + \\sigma_y^2$。这是一个关于 $\\sigma_1$ 的二次函数，其在 $\\frac{dg}{d\\sigma_1} = 2\\sigma_1 - \\sigma_y = 0$ 处有最小值，因此 $\\sigma_1 = \\frac{\\sigma_y}{2}$。\n这个 $\\sigma_1$ 的值在有效范围 $[0, \\sigma_y]$ 内。此时，$\\sigma_2 = \\frac{\\sigma_y}{2} - \\sigma_y = -\\frac{\\sigma_y}{2}$。\n这个状态 $(\\frac{\\sigma_y}{2}, -\\frac{\\sigma_y}{2}, 0)$ 是纯剪切状态，它对应于 Tresca 六边形这个面的中点。\n将 $\\sigma_1 = \\frac{\\sigma_y}{2}$ 代入比率表达式：\n$$ \\left(\\frac{t_V}{t_T}\\right)_{\\max} = \\frac{\\sigma_y}{\\sqrt{(\\frac{\\sigma_y}{2})^2 - (\\frac{\\sigma_y}{2})\\sigma_y + \\sigma_y^2}} = \\frac{\\sigma_y}{\\sqrt{\\frac{\\sigma_y^2}{4} - \\frac{\\sigma_y^2}{2} + \\sigma_y^2}} = \\frac{\\sigma_y}{\\sqrt{\\frac{3}{4}\\sigma_y^2}} = \\frac{\\sigma_y}{\\frac{\\sqrt{3}}{2}\\sigma_y} = \\frac{2}{\\sqrt{3}} $$\n这证实了该比率的最大值出现在纯剪切状态下。\n\n**5. 最大偏差的最终计算**\n\n最大相对偏差 $\\delta_{\\max}$ 为：\n$$ \\delta_{\\max} = \\left(\\frac{t_V}{t_T}\\right)_{\\max} - 1 = \\frac{2}{\\sqrt{3}} - 1 $$\n这就是最大偏差的最终闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{3}} - 1}\n$$"
        },
        {
            "introduction": "与压力无关的模型不同，Drucker-Prager 准则考虑了静水压力对屈服的影响，这对于模拟土壤、岩石和混凝土等材料至关重要。为了在模拟中使用该模型，必须首先通过实验数据确定其材料参数。本练习通过使用标准的三轴压缩实验数据来校准Drucker-Prager参数 $\\alpha$ 和 $k$，从而将理论与应用联系起来。您将应用普通最小二乘法（OLS）这一基本数据分析技术，将模型拟合到假设的实验结果上，并使用置信区间来量化校准参数的不确定性。这项任务模拟了计算力学工程师在现实世界中的工作流程。",
            "id": "3610477",
            "problem": "给定您三轴压缩测量值，其形式为平均压力和偏应力的配对 $(p,q)$，两个量均以兆帕 (MPa) 为单位。在计算固体力学中，Cauchy 应力张量表示为 $\\boldsymbol{\\sigma}$，其第一不变量为 $I_1 = \\operatorname{tr}(\\boldsymbol{\\sigma})$，其偏量部分为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3} I_1 \\boldsymbol{I}$。偏应力的第二不变量为 $J_2 = \\tfrac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$。平均压力 $p$ 和等效剪应力 $q$ 分别定义为 $p = -\\tfrac{1}{3} I_1$（压缩为正）和 $q = \\sqrt{3 J_2}$。Drucker–Prager 屈服函数定义为 $f(\\boldsymbol{\\sigma}) = \\sqrt{J_2} + \\alpha I_1 - k$，其中 $\\alpha$ 是一个无量纲参数，$k$ 的单位是应力 (MPa)。假设测量的 $(p,q)$ 配对对应于屈服面上的应力状态，并且由 Drucker–Prager 屈服函数所隐含的 $q$ 和 $p$ 之间的关系是 $p$ 的线性函数。\n\n从上述基本定义出发，将 $q$ 对 $p$ 的线性依赖关系视为一个待标定的模型，对每个提供的数据集，执行 $q$ 对 $p$ 的普通最小二乘法 (OLS) 线性回归。从回归的斜率和截距，仅使用基于所述定义的代数推导，得出相应的 Drucker–Prager 参数 $(\\alpha,k)$。然后，通过传播 OLS 在斜率和截距中的不确定性，使用具有 $n-2$ 自由度的 Student’s $t$ 分布，计算 $(\\alpha,k)$ 的双侧 $95\\%$ 置信区间，其中 $n$ 是数据点的数量。\n\n所有答案必须以下列单位和格式表示：\n- $p$ 和 $q$ 以 MPa 为单位。\n- $k$ 必须以 MPa 报告。\n- $\\alpha$ 是无量纲的。\n- 置信区间必须报告为下界和上界，单位与相应参数相同。\n- 所有数值输出四舍五入至六位小数。\n- 本问题不涉及角度；如果您引入任何角度，请以弧度表示。\n\n您的程序必须实现这些计算，并生成一行输出，其中包含每个数据集的一个列表，每个列表包含六个浮点数：$[\\alpha,k,\\alpha_{\\text{lower}},\\alpha_{\\text{upper}},k_{\\text{lower}},k_{\\text{upper}}]$。将所有数据集聚合到一个列表中，并按下面指定的精确格式打印在一行上。\n\n使用以下测试数据集，每个数据集以 MPa 为单位的 $(p,q)$ 配对列表形式给出：\n1. 理想情况（完美的线性关系）：$[(50,120), (100,180), (150,240)]$。\n2. 一般情况（中等离散度）：$[(50,102), (80,130), (110,170), (140,197), (170,237), (200,261)]$。\n3. 边界情况（近压力无关）：$[(60,98), (120,102), (180,99), (240,101), (300,100)]$。\n\n最终输出格式规范：\n- 您的程序应生成一行输出，其中包含一个由方括号括起来的、逗号分隔的列表的列表。例如： \"[[a1,b1,c1,d1,e1,f1],[a2,b2,c2,d2,e2,f2],[a3,b3,c3,d3,e3,f3]]\"，其中每个 $a_i$ 到 $f_i$ 是如上所述四舍五入到六位小数的浮点数。",
            "solution": "该问题已经过仔细验证。所有给定条件、定义和约束在科学上都是合理、一致且适定的。该问题是计算固体力学中的一个标准练习，涉及使用统计方法（普通最小二乘法回归和置信区间估计）根据实验数据校准材料模型（Drucker–Prager）。该问题被认为是有效的，并提供了完整的解决方案。\n\n核心任务是根据几组实验数据对 $(p, q)$ 确定 Drucker–Prager 材料参数 $\\alpha$ 和 $k$ 及其 $95\\%$ 置信区间。这需要一个三步过程：首先，推导 $p-q$ 不变量与 Drucker–Prager 参数之间的理论关系；其次，对实验数据进行线性回归以找到经验关系；第三，将回归系数及其不确定性映射到材料参数及其置信区间。\n\n**第一步：Drucker–Prager 参数与 $p-q$ 不变量之间的理论关系**\n\n问题提供了必要的定义。Drucker–Prager 屈服函数给出如下：\n$$f(\\boldsymbol{\\sigma}) = \\sqrt{J_2} + \\alpha I_1 - k = 0$$\n其中，当 $f=0$ 时发生屈服。参数 $\\alpha$ 和 $k$ 是材料常数。\n\n平均压力 $p$ 和等效剪应力 $q$ 定义为：\n$$p = -\\frac{1}{3} I_1$$\n$$q = \\sqrt{3 J_2}$$\n\n为了建立屈服面上 $q$ 和 $p$ 之间的关系，我们重新整理这些定义，用 $p$ 和 $q$ 来表示 $I_1$ 和 $\\sqrt{J_2}$：\n$$I_1 = -3p$$\n$$\\sqrt{J_2} = \\frac{q}{\\sqrt{3}}$$\n\n将这些表达式代入 Drucker–Prager 屈服条件 $f=0$：\n$$\\frac{q}{\\sqrt{3}} + \\alpha (-3p) - k = 0$$\n\n我们现在可以重新整理这个方程，将 $q$ 表示为 $p$ 的函数，这揭示了一个线性关系：\n$$\\frac{q}{\\sqrt{3}} = 3\\alpha p + k$$\n$$q = (3\\sqrt{3}\\alpha) p + \\sqrt{3}k$$\n\n该方程是直线形式 $q = mp + c$，其中斜率 $m$ 和截距 $c$ 由 Drucker–Prager 参数定义：\n$$m = 3\\sqrt{3}\\alpha$$\n$$c = \\sqrt{3}k$$\n\n从这两个方程中，我们可以用可观测的回归系数 $m$ 和 $c$ 来求解 $\\alpha$ 和 $k$：\n$$\\alpha = \\frac{m}{3\\sqrt{3}}$$\n$$k = \\frac{c}{\\sqrt{3}}$$\n这些方程构成了将线性回归结果转换为所需材料参数的基础。\n\n**第二步：普通最小二乘法 (OLS) 线性回归**\n\n给定一组 $n$ 个数据点 $(p_i, q_i)$，OLS 回归找到斜率 $m$ 和截距 $c$，以最小化残差平方和 $S = \\sum_{i=1}^{n} (q_i - (mp_i + c))^2$。众所周知的 $m$ 和 $c$ 解为：\n$$m = \\frac{\\sum_{i=1}^{n} (p_i - \\bar{p})(q_i - \\bar{q})}{\\sum_{i=1}^{n} (p_i - \\bar{p})^2}$$\n$$c = \\bar{q} - m\\bar{p}$$\n其中 $\\bar{p} = \\frac{1}{n} \\sum_{i=1}^{n} p_i$ 和 $\\bar{q} = \\frac{1}{n} \\sum_{i=1}^{n} q_i$ 是样本均值。\n\n**第三步：置信区间计算与不确定性传播**\n\n为了计算 $\\alpha$ 和 $k$ 的置信区间，我们必须首先确定回归参数 $m$ 和 $c$ 的置信区间。这需要计算它们的标准误差。\n\n残差的方差 $\\hat{\\sigma}^2_{\\text{res}}$ 是线性模型中误差项方差的一个无偏估计量，计算如下：\n$$\\hat{\\sigma}^2_{\\text{res}} = \\frac{1}{n-2} \\sum_{i=1}^{n} (q_i - (mp_i + c))^2$$\n项 $n-2$ 表示自由度，解释了从数据中估计的两个参数（$m$ 和 $c$）。\n\n斜率的标准误差 $SE_m$ 和截距的标准误差 $SE_c$ 由下式给出：\n$$SE_m = \\sqrt{\\frac{\\hat{\\sigma}^2_{\\text{res}}}{\\sum_{i=1}^{n} (p_i - \\bar{p})^2}}$$\n$$SE_c = \\sqrt{\\hat{\\sigma}^2_{\\text{res}} \\left(\\frac{1}{n} + \\frac{\\bar{p}^2}{\\sum_{i=1}^{n} (p_i - \\bar{p})^2}\\right)}$$\n\n参数的双侧 $95\\%$ 置信区间是使用来自具有 $n-2$ 自由度的 Student's $t$-分布的临界值 $t_{\\text{crit}}$ 构建的。该临界值对应于双侧检验的第 $97.5$ 百分位数 ($t_{\\text{crit}} = t_{0.975, n-2}$)。$m$ 和 $c$ 的置信区间为：\n$$CI_m = [m - t_{\\text{crit}} \\cdot SE_m, \\quad m + t_{\\text{crit}} \\cdot SE_m]$$\n$$CI_c = [c - t_{\\text{crit}} \\cdot SE_c, \\quad c + t_{\\text{crit}} \\cdot SE_c]$$\n\n最后，我们传播这些不确定性以找到 $\\alpha$ 和 $k$ 的置信区间。由于关系式 $\\alpha = m/(3\\sqrt{3})$ 和 $k = c/\\sqrt{3}$ 是线性变换，因此传播是直接的。\n\n对于 $\\alpha = A \\cdot m$，其中 $A = 1/(3\\sqrt{3})$：\n点估计为 $\\alpha_{est} = A \\cdot m$。\n$\\alpha$ 的置信区间半宽度为 $HW_{\\alpha} = |A| \\cdot (t_{\\text{crit}} \\cdot SE_m) = A \\cdot HW_m$ (因为 $A>0$）。\n因此 $\\alpha$ 的置信区间为 $[\\alpha_{est} - HW_{\\alpha}, \\alpha_{est} + HW_{\\alpha}]$。\n\n对于 $k = B \\cdot c$，其中 $B = 1/\\sqrt{3}$：\n点估计为 $k_{est} = B \\cdot c$。\n$k$ 的置信区间半宽度为 $HW_{k} = |B| \\cdot (t_{\\text{crit}} \\cdot SE_c) = B \\cdot HW_c$ (因为 $B0$）。\n因此 $k$ 的置信区间为 $[k_{est} - HW_{k}, k_{est} + HW_{k}]$。\n\n请注意，如果数据完美拟合直线，则残差为零，$\\hat{\\sigma}^2_{\\text{res}} = 0$，标准误差为零，并且每个参数的置信区间会收缩为一个点（点估计值）。这是第一个测试用例的预期结果。\n\n最终答案中实现的算法对每个提供的数据集都精确地遵循了这些步骤。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Happy path (perfect linear relation)\n        [(50, 120), (100, 180), (150, 240)],\n        # Case 2: General case (moderate scatter)\n        [(50, 102), (80, 130), (110, 170), (140, 197), (170, 237), (200, 261)],\n        # Case 3: Edge case (near pressure-insensitive response)\n        [(60, 98), (120, 102), (180, 99), (240, 101), (300, 100)],\n    ]\n\n    all_results = []\n    for data in test_cases:\n        result = calculate_dp_params_with_ci(data)\n        all_results.append(result)\n\n    # Format the final output as a comma-separated list of lists.\n    formatted_results = []\n    for res_list in all_results:\n        # Use a list comprehension to format each number, then join.\n        # This handles the case where the result is None or contains NaNs gracefully.\n        formatted_list = [f\"{x:.6f}\" for x in res_list]\n        formatted_results.append(f\"[{','.join(formatted_list)}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\n\ndef calculate_dp_params_with_ci(data):\n    \"\"\"\n    Calculates Drucker-Prager parameters and their 95% confidence intervals from\n    (p, q) data using Ordinary Least Squares (OLS) regression.\n\n    Args:\n        data (list of tuples): A list of (p, q) data points in MPa.\n\n    Returns:\n        list: A list containing [alpha, k, alpha_lower, alpha_upper, k_lower, k_upper],\n              all rounded to six decimal places.\n    \"\"\"\n    p_data = np.array([d[0] for d in data], dtype=float)\n    q_data = np.array([d[1] for d in data], dtype=float)\n    n = len(p_data)\n\n    if n = 2:\n        # The statistical model for confidence intervals is not well-defined for n=2\n        # as degrees of freedom (n-2) would be non-positive.\n        nan_res = [np.nan] * 6\n        return nan_res\n\n    # --- Step 1: OLS Linear Regression (q = m*p + c) ---\n    p_mean = np.mean(p_data)\n    q_mean = np.mean(q_data)\n    \n    ss_p = np.sum((p_data - p_mean)**2)\n    sp_pq = np.sum((p_data - p_mean) * (q_data - q_mean))\n\n    # Avoid division by zero if all p_data points are the same\n    m = sp_pq / ss_p if ss_p != 0 else 0.0\n    c = q_mean - m * p_mean\n    \n    # --- Step 2: Calculate Standard Errors for m and c ---\n    q_pred = m * p_data + c\n    residuals = q_data - q_pred\n    ss_res = np.sum(residuals**2)\n    \n    df = n - 2\n    \n    # Residual variance. Handle perfect fit case where ss_res is ~0.\n    if np.isclose(ss_res, 0):\n        residual_variance = 0\n    else:\n        residual_variance = ss_res / df\n    \n    se_m = np.sqrt(residual_variance / ss_p) if ss_p > 0 else 0\n    se_c = np.sqrt(residual_variance * (1/n + p_mean**2 / ss_p)) if ss_p > 0 else np.sqrt(residual_variance / n)\n    \n    # --- Step 3: Calculate 95% Confidence Intervals for m and c ---\n    # For a two-sided 95% CI, we need the value at the 97.5th percentile.\n    confidence_level = 0.95\n    alpha_t = 1 - confidence_level\n    \n    if np.isclose(residual_variance, 0):\n        t_crit = 0 # Perfect fit, no variance\n    else:\n        t_crit = t.ppf(1 - alpha_t / 2, df)\n\n    m_half_width = t_crit * se_m\n    c_half_width = t_crit * se_c\n    \n    # --- Step 4: Map to Drucker-Prager parameters (alpha, k) ---\n    sqrt3 = np.sqrt(3.0)\n    \n    # Corrected formulas based on p = -I1/3\n    alpha_val = m / (3.0 * sqrt3)\n    k_val = c / sqrt3\n    \n    # --- Step 5: Propagate uncertainty to find CI for alpha and k ---\n    # The transformation from m to alpha is alpha = A * m, with A > 0.\n    # The transformation from c to k is k = B * c, with B > 0.\n    A = 1.0 / (3.0 * sqrt3)\n    B = 1.0 / sqrt3\n    \n    alpha_half_width = A * m_half_width\n    k_half_width = B * c_half_width\n    \n    alpha_lower = alpha_val - alpha_half_width\n    alpha_upper = alpha_val + alpha_half_width\n    k_lower = k_val - k_half_width\n    k_upper = k_val + k_half_width\n    \n    return [alpha_val, k_val, alpha_lower, alpha_upper, k_lower, k_upper]\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "实现像Drucker-Prager这样的压力相关屈服模型会带来独特的数值挑战。一个关键问题出现在屈服面的锥顶处（静水压力轴），此处屈服面的梯度在数学上是未定义的，会导致标准返回映射算法中出现奇点。本练习旨在解决在接近或处于静水应力状态时（此时第二偏应力不变量 $J_2$ 趋近于零）流动方向的计算问题。通过推导并实现一个稳健的、正则化的流动方向公式，您将学会如何克服在工业级有限元代码中常见的数值不稳定性。这项练习将加深您对连续介质力学理论与稳健计算实现的实际需求之间相互作用的理解。",
            "id": "3610527",
            "problem": "要求您推导并实现一个鲁棒的计算程序，用于计算 Drucker–Prager 模型在接近静水压力状态（此时第二偏应力不变量趋于零）时的流动方向。请从连续介质力学的基本定义出发。设柯西应力张量为 $\\sigma$，单位张量为 $I$，迹算子为 $\\operatorname{tr}(\\cdot)$，偏应力为 $s = \\sigma - \\frac{1}{3}\\operatorname{tr}(\\sigma) I$。第一不变量为 $I_1 = \\operatorname{tr}(\\sigma)$，偏应力的第二不变量为 $J_2 = \\frac{1}{2} s : s$，其中冒号表示双点积。Drucker–Prager 屈服函数为 $f(\\sigma) = \\sqrt{J_2} + \\alpha I_1 - k$，其中 $\\alpha \\ge 0$ 且 $k \\ge 0$。\n\n您的任务是：\n1. 从上述定义出发，推导梯度 $\\partial J_2/\\partial \\sigma$，进而推导 $\\sqrt{J_2}$ 相对于 $\\sigma$ 的梯度。识别当 $J_2 \\to 0$ 时（对应于 $s \\to 0$ 的近静水压力应力状态）出现的算法问题。\n2. 提出了一个鲁棒、定义明确的 $\\partial \\sqrt{J_2} / \\partial \\sigma$ 公式，该公式避免了除零错误，并与底层的不变性结构一致。在一个程序中实现此公式，并用它来计算流动方向 $\\partial f/\\partial \\sigma$。\n3. 设计检验以证明您的实现在近静水压力状态和静水压力状态下的数值鲁棒性和数学一致性。具体来说，验证正则化梯度在近静水压力状态下保持有限且与偏应力 $s$ 对齐，并在精确静水压力状态下正确地退化。\n\n应力值必须以兆帕（MPa）为单位处理。由于梯度 $\\partial \\sqrt{J_2} / \\partial \\sigma$ 是无量纲的，所有报告的浮点数输出必须是无量纲的小数。如果使用角度，内部计算必须使用弧度；但是，下面要求的输出是无量纲的浮点数或布尔值。\n\n实现一个执行以下测试套件并产生指定输出的单一程序：\n\n- 测试用例 1（一般非静水压力状态）：$\\sigma = \\begin{bmatrix}120  25  -5 \\\\ 25  90  10 \\\\ -5  10  70\\end{bmatrix}$ MPa，其中 $\\alpha = 0.1$，正则化参数 $\\varepsilon = 10^{-6}$ MPa。计算鲁棒梯度与在 $J_2  0$ 时有效的精确梯度公式之间的相对弗罗贝尼乌斯范数误差。输出一个等于 $\\|\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} - \\nabla_{\\sigma}^{\\text{exact}}\\sqrt{J_2}\\|_F / \\|\\nabla_{\\sigma}^{\\text{exact}}\\sqrt{J_2}\\|_F$ 的单一浮点数。\n\n- 测试用例 2（近静水压力状态）：$\\sigma = \\begin{bmatrix}100  10^{-9}  0 \\\\ 10^{-9}  100  0 \\\\ 0  0  100\\end{bmatrix}$ MPa，其中 $\\alpha = 0.1$，$\\varepsilon = 10^{-6}$ MPa。输出一个单一布尔值，如果鲁棒梯度是有限的（没有 NaN 或无穷大），并且与偏应力 $s$ 对齐，则为 true。对齐的判断标准是，它们之间夹角的余弦值，计算为 $(\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} : s) / (\\|\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2}\\|_F \\, \\|s\\|_F)$，超过 $0.999999$。\n\n- 测试用例 3（精确静水压力状态）：$\\sigma = \\begin{bmatrix}p  0  0 \\\\ 0  p  0 \\\\ 0  0  p\\end{bmatrix}$ MPa，其中 $p = 100$，$\\alpha = 0.1$，$\\varepsilon = 10^{-6}$ MPa。输出一个单一布尔值，如果鲁棒梯度 $\\partial \\sqrt{J_2}/\\partial \\sigma$（在数值上）是零张量（通过 $\\|\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2}\\|_F  10^{-14}$ 评估），并且流动方向 $\\partial f/\\partial \\sigma$ 具有正确的迹（通过 $|\\operatorname{tr}(\\partial f/\\partial \\sigma) - 3 \\alpha|  10^{-14}$ 评估），则为 true。\n\n- 测试用例 4（静水压力增量下的不变性）：设 $\\sigma_a = \\begin{bmatrix}5  2  0 \\\\ 2  -3  1 \\\\ 0  1  4\\end{bmatrix}$ MPa 和 $\\sigma_b = \\sigma_a + 500 I$ MPa，其中 $\\varepsilon = 10^{-6}$ MPa。输出一个单一布尔值，如果在弗罗贝尼乌斯范数容差 $10^{-12}$ 内，根据 $\\sigma_a$ 计算的鲁棒梯度 $\\partial \\sqrt{J_2} / \\partial \\sigma$ 等于根据 $\\sigma_b$ 计算的梯度，则为 true。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，`[result1,result2,result3,result4]`）。",
            "solution": "该问题要求推导并鲁棒地实现 Drucker-Prager 材料模型的流动方向，特别关注处理在静水压力状态下出现的奇点问题。解答分为三部分：首先，推导相关梯度并识别数值问题；其次，构建一个鲁棒的正则化方案；第三，通过一系列特定的测试用例验证实现。\n\n### 第一部分：梯度推导与奇点分析\n\n我们从给定的定义开始。柯西应力张量为 $\\sigma$，单位张量为 $I$，偏应力为 $s = \\sigma - \\frac{1}{3}\\operatorname{tr}(\\sigma) I$，第一应力不变量为 $I_1 = \\operatorname{tr}(\\sigma)$，第二偏应力不变量为 $J_2 = \\frac{1}{2} s : s$。Drucker-Prager 屈服函数为 $f(\\sigma) = \\sqrt{J_2} + \\alpha I_1 - k$。\n\n在相关联塑性理论的背景下，流动方向由屈服函数相对于应力张量的梯度 $\\partial f / \\partial \\sigma$ 给出。我们逐项计算。\n\n首先，我们求第一不变量 $I_1$ 的梯度。在索引表示法中，$I_1 = \\sigma_{kk}$。其相对于 $\\sigma_{ij}$ 的导数为：\n$$\n\\frac{\\partial I_1}{\\partial \\sigma_{ij}} = \\frac{\\partial \\sigma_{kk}}{\\partial \\sigma_{ij}} = \\delta_{ik}\\delta_{jk} = \\delta_{ij}\n$$\n在直接表示法中，这即是单位张量：\n$$\n\\frac{\\partial I_1}{\\partial \\sigma} = I\n$$\n\n接下来，我们处理涉及 $J_2$ 的项。我们使用链式法则：$\\partial \\sqrt{J_2} / \\partial \\sigma = (\\partial \\sqrt{J_2} / \\partial J_2) (\\partial J_2 / \\partial \\sigma)$。第一部分是初等的：$\\partial \\sqrt{J_2} / \\partial J_2 = 1 / (2\\sqrt{J_2})$。\n对于第二部分 $\\partial J_2 / \\partial \\sigma$，我们再次使用链式法则：$\\partial J_2 / \\partial \\sigma = (\\partial J_2 / \\partial s) : (\\partial s / \\partial \\sigma)$。\n$J_2 = \\frac{1}{2} s_{kl}s_{kl}$ 相对于 $s_{ij}$ 的导数为：\n$$\n\\frac{\\partial J_2}{\\partial s_{ij}} = \\frac{1}{2} \\left( \\frac{\\partial s_{kl}}{\\partial s_{ij}} s_{kl} + s_{kl} \\frac{\\partial s_{kl}}{\\partial s_{ij}} \\right) = \\frac{1}{2} (\\delta_{ik}\\delta_{jl} s_{kl} + s_{kl} \\delta_{ik}\\delta_{jl}) = s_{ij}\n$$\n因此，在直接表示法中，$\\partial J_2 / \\partial s = s$。\n\n偏应力 $s = \\sigma - \\frac{1}{3}\\operatorname{tr}(\\sigma)I$ 相对于 $\\sigma$ 的导数是四阶偏量投影张量 $\\mathbb{P}_{\\text{dev}}$。当与偏应力张量 $s$ 收缩时，它产生 $s$ 本身，因为一个偏量投影算子作用于一个已经是偏量的张量是一个恒等操作。更直接的计算表明：\n$$\n\\frac{\\partial J_2}{\\partial \\sigma_{ij}} = \\frac{\\partial}{\\partial \\sigma_{ij}} \\left( \\frac{1}{2} s_{kl} s_{kl} \\right) = s_{kl} \\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = s_{kl} \\left( \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{ij}\\delta_{kl} \\right) = s_{ij} - \\frac{1}{3} s_{kl}\\delta_{kl} \\delta_{ij} = s_{ij} - \\frac{1}{3} \\operatorname{tr}(s) \\delta_{ij}\n$$\n由于偏应力张量的迹根据定义为零，即 $\\operatorname{tr}(s) = 0$，我们得到一个简单的结果：\n$$\n\\frac{\\partial J_2}{\\partial \\sigma} = s\n$$\n\n结合这些结果，$\\sqrt{J_2}$ 的梯度为：\n$$\n\\frac{\\partial \\sqrt{J_2}}{\\partial \\sigma} = \\frac{1}{2\\sqrt{J_2}} \\frac{\\partial J_2}{\\partial \\sigma} = \\frac{s}{2\\sqrt{J_2}}\n$$\n\n算法问题现在就很明显了。静水压力状态定义为 $\\sigma = pI$，其中 $p$ 是压力。对于这样的状态，偏应力 $s=0$，因此 $J_2 = 0$。梯度表达式变成了 $0/0$ 的不定形式。对于近静水压力状态，其中 $s$ 非常小但非零，$J_2$ 非常小且为正，可能导致浮点溢出和数值不稳定性。\n\n### 第二部分：鲁棒正则化的构建\n\n为了解决奇点问题，我们必须提出了一个在 $J_2=0$ 处有良好定义的 $\\partial \\sqrt{J_2} / \\partial \\sigma$ 公式。在静水压力状态下，由于材料各向同性，没有优选的偏应力方向。物理响应不应依赖于一个任意且数值不稳定的方向。在纯静水压力状态下，流动偏量部分最一致的定义是零。这意味着当 $s=0$ 时，$\\partial \\sqrt{J_2} / \\partial \\sigma$ 应为零张量。\n\n通过修改分母可以实现鲁棒且连续的正则化。设 $\\varepsilon$ 是一个与 $\\sqrt{J_2}$ 具有相同单位（MPa）的小正则化参数。我们将鲁棒梯度定义为：\n$$\n\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} = \\frac{s}{2 \\max(\\sqrt{J_2}, \\varepsilon)}\n$$\n该公式的行为如下：\n- 如果 $\\sqrt{J_2} \\gg \\varepsilon$，公式近似于精确梯度，$\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} \\approx s/(2\\sqrt{J_2})$。\n- 如果 $\\sqrt{J_2} \\ll \\varepsilon$ (近静水压力状态），公式变为 $\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} \\approx s/(2\\varepsilon)$。当 $s \\to 0$时，该梯度平滑地趋近于零张量，避免了任何奇点。\n- 如果 $J_2=0$（精确静水压力状态），$s=0$，公式正确地得到零张量。\n\n使用这个鲁棒梯度，总的流动方向为：\n$$\n\\frac{\\partial f}{\\partial \\sigma} = \\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2} + \\alpha I = \\frac{s}{2 \\max(\\sqrt{J_2}, \\varepsilon)} + \\alpha I\n$$\n\n这个公式是数值稳定、连续的，并且与各向同性塑性物理学一致。\n\n### 第三部分：实现与验证\n\n提供的 Python 代码实现了这个鲁棒的公式，并通过四个测试用例来证明其正确性和稳定性。\n\n- **测试用例 1（一般非静水压力状态）：** 应力状态远离静水压力状态，所以 $\\sqrt{J_2} \\gg \\varepsilon$。鲁棒公式和精确公式应产生几乎相同的结果。该测试计算两者之间的相对弗罗贝尼乌斯范数误差，预期该误差接近机器精度（$0$）。\n\n- **测试用例 2（近静水压力状态）：** 偏应力极小（$s_{12} = 10^{-9}~\\text{MPa}$），所以 $\\sqrt{J_2} = 10^{-9}~\\text{MPa}$，小于正则化参数 $\\varepsilon = 10^{-6}~\\text{MPa}$。鲁棒梯度计算为 $s/(2\\varepsilon)$。该测试验证了两个属性：首先，得到的梯度张量只包含有限数（没有 `NaN` 或 `inf`）；其次，其方向与偏应力 $s$ 完全对齐。两者之间夹角的余弦值，通过归一化的双点积计算，应为 $1.0$。\n\n- **测试用例 3（精确静水压力状态）：** 应力是纯静水压力（$s=0$），所以 $J_2=0$。鲁棒梯度 $\\nabla_{\\sigma}^{\\text{rob}}\\sqrt{J_2}$ 必须是零张量，通过检查其弗罗贝尼乌斯范数小于一个小的容差（$10^{-14}$）来验证。完整的流动方向变为 $\\partial f/\\partial \\sigma = \\alpha I$。该张量的迹为 $\\operatorname{tr}(\\alpha I) = 3\\alpha$。测试的第二部分验证了这个性质。\n\n- **测试用例 4（静水压力增量下的不变性）：** 根据定义，偏应力 $s = \\sigma - \\frac{1}{3}\\operatorname{tr}(\\sigma)I$ 在加上静水压力后是不变的，即 $s(\\sigma + pI) = s(\\sigma)$。因此，$J_2$ 和梯度 $\\nabla_{\\sigma}\\sqrt{J_2}$ 也必须是不变的。此测试验证了为应力张量 $\\sigma_a$ 计算的鲁棒梯度与为 $\\sigma_b = \\sigma_a + 500I$ 计算的梯度在严格的数值容差内是相同的。\n\n这些测试的成功执行证实了所实现的数值程序的有效性和鲁棒性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes flow directions for the Drucker-Prager model using a robust\n    regularization for near-hydrostatic states, and runs a verification suite.\n    \"\"\"\n\n    # --- Helper Functions ---\n    def get_s_and_J2(sigma):\n        \"\"\"Computes the deviatoric stress tensor s and its second invariant J2.\"\"\"\n        if sigma.shape != (3, 3):\n            raise ValueError(\"Stress tensor must be a 3x3 matrix.\")\n        \n        I1 = np.trace(sigma)\n        s = sigma - (I1 / 3.0) * np.identity(3)\n        J2 = 0.5 * np.sum(s * s)  # s:s is sum(s_ij * s_ij)\n        return s, J2\n\n    def grad_sqrtJ2_robust(s, J2, epsilon):\n        \"\"\"\n        Computes the robust gradient of sqrt(J2) with respect to sigma.\n        nabla_sigma(sqrt(J2)) = s / (2 * max(sqrt(J2), epsilon))\n        \"\"\"\n        sqrt_J2 = np.sqrt(J2)\n        denominator = 2.0 * np.maximum(sqrt_J2, epsilon)\n        if denominator == 0: # Should only happen if epsilon=0 and s=0\n            return np.zeros((3, 3))\n        return s / denominator\n\n    def grad_sqrtJ2_exact(s, J2):\n        \"\"\"\n        Computes the exact, but potentially unstable, gradient of sqrt(J2).\n        This function is for comparison purposes only.\n        \"\"\"\n        if J2 == 0:\n            # For J2=0, this is the singular 0/0 case.\n            # In a real scenario, this branch indicates a problem.\n            # For this test, we return NaN to signal the singularity.\n            return np.full((3, 3), np.nan)\n        \n        sqrt_J2 = np.sqrt(J2)\n        return s / (2.0 * sqrt_J2)\n\n    # --- Test Suite ---\n    results = []\n    \n    # Common regularization parameter\n    epsilon = 1e-6 # MPa\n\n    # Test Case 1: General non-hydrostatic state\n    sigma1 = np.array([[120.0, 25.0, -5.0], [25.0, 90.0, 10.0], [-5.0, 10.0, 70.0]])\n    s1, J2_1 = get_s_and_J2(sigma1)\n    grad_rob_1 = grad_sqrtJ2_robust(s1, J2_1, epsilon)\n    grad_ex_1 = grad_sqrtJ2_exact(s1, J2_1)\n    \n    norm_diff_1 = np.linalg.norm(grad_rob_1 - grad_ex_1, 'fro')\n    norm_ex_1 = np.linalg.norm(grad_ex_1, 'fro')\n    \n    # The relative error is expected to be 0 or very close to it\n    # as sqrt(J2) >> epsilon in this case.\n    if norm_ex_1 > 0:\n        rel_err_1 = norm_diff_1 / norm_ex_1\n    else:\n        # This case should not be reached for sigma1\n        rel_err_1 = 0.0 if norm_diff_1 == 0 else float('inf')\n    results.append(rel_err_1)\n\n    # Test Case 2: Nearly hydrostatic state\n    sigma2 = np.array([[100.0, 1e-9, 0.0], [1e-9, 100.0, 0.0], [0.0, 0.0, 100.0]])\n    alpha2 = 0.1\n    s2, J2_2 = get_s_and_J2(sigma2)\n    grad_rob_2 = grad_sqrtJ2_robust(s2, J2_2, epsilon)\n    \n    is_finite = np.all(np.isfinite(grad_rob_2))\n    \n    norm_s2 = np.linalg.norm(s2, 'fro')\n    norm_grad_rob_2 = np.linalg.norm(grad_rob_2, 'fro')\n    is_aligned = False\n    if norm_s2 > 0 and norm_grad_rob_2 > 0:\n        dot_product = np.sum(grad_rob_2 * s2)\n        cos_angle = dot_product / (norm_grad_rob_2 * norm_s2)\n        # Theoretically, cos_angle should be 1.0. We check it's very close.\n        if cos_angle > 0.999999:\n            is_aligned = True\n    elif norm_s2 == 0 and norm_grad_rob_2 == 0:\n         is_aligned = True # Trivial alignment if both are zero\n         \n    results.append(is_finite and is_aligned)\n\n    # Test Case 3: Exactly hydrostatic state\n    p3 = 100.0\n    sigma3 = np.array([[p3, 0.0, 0.0], [0.0, p3, 0.0], [0.0, 0.0, p3]])\n    alpha3 = 0.1\n    s3, J2_3 = get_s_and_J2(sigma3)\n    grad_rob_sqrtJ2_3 = grad_sqrtJ2_robust(s3, J2_3, epsilon)\n\n    # Check 1: Robust gradient of sqrt(J2) is numerically the zero tensor\n    check3a = np.linalg.norm(grad_rob_sqrtJ2_3, 'fro')  1e-14\n    \n    # Check 2: The trace of the full flow direction is correct\n    flow_direction_3 = grad_rob_sqrtJ2_3 + alpha3 * np.identity(3)\n    trace_flow_dir_3 = np.trace(flow_direction_3)\n    check3b = abs(trace_flow_dir_3 - 3.0 * alpha3)  1e-14\n    \n    results.append(check3a and check3b)\n\n    # Test Case 4: Invariance under hydrostatic addition\n    sigma4a = np.array([[5.0, 2.0, 0.0], [2.0, -3.0, 1.0], [0.0, 1.0, 4.0]])\n    sigma4b = sigma4a + 500.0 * np.identity(3)\n\n    s4a, J2_4a = get_s_and_J2(sigma4a)\n    grad_rob_4a = grad_sqrtJ2_robust(s4a, J2_4a, epsilon)\n    \n    s4b, J2_4b = get_s_and_J2(sigma4b)\n    grad_rob_4b = grad_sqrtJ2_robust(s4b, J2_4b, epsilon)\n    \n    # The two gradients should be numerically identical\n    norm_diff_4 = np.linalg.norm(grad_rob_4a - grad_rob_4b, 'fro')\n    check4 = norm_diff_4  1e-12\n    results.append(check4)\n\n    # Final print statement in the exact required format.\n    # Python's str() for bool is 'True' or 'False' (capitalized), which is fine.\n    # The problem asks for a list, e.g., [result1,result2,result3,result4]\n    # which is a Python list representation.\n    # The example [a1,b1,c1] suggests just the content. The outer brackets in\n    # \"[[...],[...]]\" come from the overall aggregation in the problem spec.\n    # So str(results) would be perfect. However, to control formatting, manual construction is better.\n    print(f\"[{results[0]},{str(results[1]).lower()},{str(results[2]).lower()},{str(results[3]).lower()}]\")\n\n# The problem spec asks for a single line of output like \"[[a,b,..],[c,d,..]]\" for all datasets.\n# But this problem has only one set of tests. So, the format is \"[result1, result2, ...]\"\n# The bools are expected lowercase, so I'll convert them.\nsolve()\n```"
        }
    ]
}