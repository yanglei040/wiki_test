{
    "hands_on_practices": [
        {
            "introduction": "在计算塑性力学中，每个增量步的核心是判断材料是继续弹性变形还是进入塑性流动。这个练习将带你亲手完成这一关键决策过程。你将计算一个“试探应力”，即假设整个增量步完全是弹性的，然后使用屈服函数来检验这个假设的有效性，从而确定是发生了弹性卸载还是塑性加载。",
            "id": "3560485",
            "problem": "一个带有线性各向同性硬化的三维小应变各向同性 von Mises（也称为 $J_{2}$）塑性模型被用于模拟一个双轴加载-卸载循环。弹性响应由杨氏模量 $E$ 和泊松比 $\\nu$ 表征。塑性响应由初始屈服应力 $\\sigma_{y0}$ 和各向同性硬化模量 $H$ 表征。已知在时间 $t_{n}$ 的当前（收敛）状态位于屈服面上。给定以下数据：\n- $E = 210\\ \\mathrm{GPa}$，$\\nu = 0.30$，\n- $\\sigma_{y0} = 250\\ \\mathrm{MPa}$，$H = 1000\\ \\mathrm{MPa}$，\n- $t_{n}$ 时刻的柯西应力：$\\boldsymbol{\\sigma}_{n} = \\mathrm{diag}(300,\\,300,\\,0)\\ \\mathrm{MPa}$，\n- $t_{n}$ 时刻的累积等效塑性应变：$\\bar{\\varepsilon}^{p}_{n} = 0.050$，\n- 在接下来的步骤中不施加剪切应变。\n\n施加两个连续的应变增量：\n- 步骤 A：$\\Delta \\boldsymbol{\\varepsilon}^{(A)} = \\mathrm{diag}\\!\\left(-1.0\\times 10^{-4},\\,-1.0\\times 10^{-4},\\,0\\right)$，\n- 步骤 B：$\\Delta \\boldsymbol{\\varepsilon}^{(B)} = \\mathrm{diag}\\!\\left(2.0\\times 10^{-4},\\,2.0\\times 10^{-4},\\,0\\right)$。\n\n在每个步骤中，使用弹性预测方法，计算试探柯西应力及相应的 von Mises 屈服函数值 $f_{\\mathrm{tr}}$。屈服函数值的计算基于线性各向同性硬化，并采用该步骤开始时的硬化变量。对于每个步骤，判断该增量是可接受的弹性增量（如果是，判断其对应于弹性卸载还是弹性加载），还是需要进行塑性修正（塑性加载）。\n\n作为最终答案，报告步骤 B 的屈服函数 $f_{\\mathrm{tr}}$ 的标量值。最终值以 $\\mathrm{MPa}$ 为单位表示，并四舍五入至四位有效数字。",
            "solution": "首先，我们验证初始状态确实位于屈服面上。给定柯西应力 $\\boldsymbol{\\sigma}_{n} = \\mathrm{diag}(300, 300, 0)\\ \\mathrm{MPa}$，其偏应力张量为 $\\mathbf{s}_{n} = \\mathrm{diag}(100, 100, -200)\\ \\mathrm{MPa}$。对应的 von Mises 等效应力为：\n$$\n\\sigma_{\\mathrm{eq},n} = \\sqrt{\\frac{3}{2}\\mathbf{s}_{n}:\\mathbf{s}_{n}} = \\sqrt{\\frac{3}{2}(100^2 + 100^2 + (-200)^2)} = 300\\ \\mathrm{MPa}\n$$\n根据线性各向同性硬化法则，当前屈服应力为：\n$$\n\\sigma_y(\\bar{\\varepsilon}^{p}_{n}) = \\sigma_{y0} + H \\bar{\\varepsilon}^{p}_{n} = 250\\ \\mathrm{MPa} + (1000\\ \\mathrm{MPa})(0.050) = 300\\ \\mathrm{MPa}\n$$\n由于 $\\sigma_{\\mathrm{eq},n} = \\sigma_y(\\bar{\\varepsilon}^{p}_{n})$，初始状态确实位于屈服面上。\n\n接下来，我们计算 Lamé 参数：\n剪切模量 $\\mu = \\frac{E}{2(1+\\nu)} = \\frac{210000}{2.6} = \\frac{1050000}{13}\\ \\mathrm{MPa}$。\n第一 Lamé 参数 $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} = \\frac{63000}{0.52} = \\frac{1575000}{13}\\ \\mathrm{MPa}$。\n\n**步骤 A 分析**\n对于应变增量 $\\Delta \\boldsymbol{\\varepsilon}^{(A)} = \\mathrm{diag}(-1.0\\times 10^{-4}, -1.0\\times 10^{-4}, 0)$，其迹为 $\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}^{(A)}) = -2.0\\times 10^{-4}$。试探应力增量 $\\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)}$ 由胡克定律计算得出：\n$$\n\\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)} = \\mathrm{diag}(-\\frac{525}{13},\\, -\\frac{525}{13},\\, -\\frac{315}{13})\\ \\mathrm{MPa}\n$$\n试探应力为 $\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)} = \\boldsymbol{\\sigma}_{n} + \\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)} = \\mathrm{diag}(\\frac{3375}{13},\\, \\frac{3375}{13},\\, -\\frac{315}{13})\\ \\mathrm{MPa}$。\n计算其 von Mises 等效应力得到 $\\sigma_{\\mathrm{eq,tr}}^{(A)} = \\frac{3690}{13}\\ \\mathrm{MPa}$。试探屈服函数值为：\n$$\nf_{\\mathrm{tr}}^{(A)} = \\sigma_{\\mathrm{eq,tr}}^{(A)} - \\sigma_y(\\bar{\\varepsilon}^{p}_{n}) = \\frac{3690}{13} - 300 = -\\frac{210}{13}\\ \\mathrm{MPa} \\approx -16.15\\ \\mathrm{MPa}\n$$\n由于 $f_{\\mathrm{tr}}^{(A)}  0$，该步骤为弹性卸载。更新后的状态为 $\\boldsymbol{\\sigma}_{n+1/2} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(A)}$ 且 $\\bar{\\varepsilon}^p_{n+1/2} = \\bar{\\varepsilon}^p_n = 0.050$。\n\n**步骤 B 分析**\n步骤 B 从步骤 A 结束时的状态开始。应变增量为 $\\Delta \\boldsymbol{\\varepsilon}^{(B)} = \\mathrm{diag}(2.0\\times 10^{-4}, 2.0\\times 10^{-4}, 0)$。试探应力增量为 $\\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)} = \\mathrm{diag}(\\frac{1050}{13},\\, \\frac{1050}{13},\\, \\frac{630}{13})\\ \\mathrm{MPa}$。\n步骤 B 的试探应力为 $\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)} = \\boldsymbol{\\sigma}_{n+1/2} + \\Delta\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)}$:\n$$\n\\boldsymbol{\\sigma}_{\\mathrm{tr}}^{(B)} = \\mathrm{diag}(\\frac{3375}{13} + \\frac{1050}{13},\\, \\frac{3375}{13} + \\frac{1050}{13},\\, -\\frac{315}{13} + \\frac{630}{13}) = \\mathrm{diag}(\\frac{4425}{13},\\, \\frac{4425}{13},\\, \\frac{315}{13})\\ \\mathrm{MPa}\n$$\n计算其 von Mises 等效应力得到 $\\sigma_{\\mathrm{eq,tr}}^{(B)} = \\frac{4110}{13}\\ \\mathrm{MPa}$。用于检验的屈服应力仍为 $300\\ \\mathrm{MPa}$，因为步骤 A 是弹性的。因此，步骤 B 的试探屈服函数值为：\n$$\nf_{\\mathrm{tr}}^{(B)} = \\sigma_{\\mathrm{eq,tr}}^{(B)} - \\sigma_y(\\bar{\\varepsilon}^p_{n+1/2}) = \\frac{4110}{13} - 300 = \\frac{210}{13}\\ \\mathrm{MPa} \\approx 16.1538\\ \\mathrm{MPa}\n$$\n由于 $f_{\\mathrm{tr}}^{(B)}  0$，此步骤为塑性加载，需要塑性修正。问题要求报告步骤 B 的试探屈服函数值 $f_{\\mathrm{tr}}^{(B)}$，四舍五入至四位有效数字为 $16.15$。",
            "answer": "$$\\boxed{16.15}$$"
        },
        {
            "introduction": "真实材料在循环加载下会表现出复杂的记忆效应，例如包辛格效应。本练习旨在通过一个简化的模型，帮助你理解如何通过硬化模型来描述屈服面的演化，从而捕捉这些现象。你将分析组合硬化（即各向同性与随动硬化）法则，并计算材料在反向加载时再次屈服的应力点，从而深刻理解不同硬化分量的物理意义。",
            "id": "3560476",
            "problem": "考虑一个具有组合各向同性-随动硬化的一维小应变 von Mises 塑性模型。该材料遵循以下率无关相关联塑性法则：\n\n- 屈服函数为\n$$\nf(\\sigma,\\alpha,R) = |\\sigma - \\alpha| - \\left(\\sigma_{y0} + R\\right),\n$$\n其中 $\\sigma$ 是柯西应力，$\\alpha$ 是标量背应力（一维屈服面的中心），$R$ 是标量各向同性硬化变量（屈服面半径的增量），$\\sigma_{y0}$ 是初始屈服应力。\n\n- 各向同性硬化是线性的，\n$$\nR = H_{\\text{iso}}\\,\\bar{\\epsilon}^{p},\n$$\n其中 $H_{\\text{iso}}$ 是各向同性硬化模量，$\\bar{\\epsilon}^{p}$ 是等效塑性应变。在一维单调加载情况下，取 $\\bar{\\epsilon}^{p} = |\\epsilon^{p}|$，其中 $\\epsilon^{p}$ 是塑性应变。\n\n- 随动硬化在一维加载方向上是线性的，\n$$\n\\alpha = H_{\\text{kin}}\\,\\epsilon^{p},\n$$\n其中 $H_{\\text{kin}}$ 是一维随动硬化模量。不存在静态或动态恢复，因此内变量仅随塑性流动而演化。\n\n- 标准的库恩-塔克（Kuhn-Tucker）条件成立：\n$$\nf \\le 0,\\quad \\dot{\\lambda} \\ge 0,\\quad \\dot{\\lambda}\\,f = 0,\n$$\n服从相关联流动法则，因此当 $f0$ 时，$\\dot{\\epsilon}^{p} = 0$。\n\n在时刻 $t_0$，经过先前的单调拉伸塑性加载后，已知材料状态正好处于拉伸屈服面上，其内变量如下：\n$$\n\\bar{\\epsilon}^{p}_0 = 0.010,\\qquad \\epsilon^{p}_0 = 0.010,\\qquad \\sigma_{y0} = 250\\ \\mathrm{MPa},\\qquad H_{\\text{iso}} = 1000\\ \\mathrm{MPa},\\qquad H_{\\text{kin}} = 5000\\ \\mathrm{MPa}.\n$$\n在卸载过程中不发生进一步的塑性流动。然后，该物体从 $t_0$ 时刻弹性卸载至 $\\sigma=0$，之后在压缩（负 $\\sigma$）方向上重新加载，直至塑性流动重新开始。\n\n任务：\n\n1) 仅使用上述定义和原理，确定在从 $t_0$ 到 $\\sigma=0$ 的弹性卸载过程中，屈服面尺寸的变化量 $\\Delta R$ 和屈服面中心的变化量 $\\Delta \\alpha$。\n\n2) 确定从 $\\sigma=0$ 开始反向加载时，塑性再加载首次开始时的压缩柯西应力 $\\sigma$（一个负数）的值。使用给定的模型和数据，得到一个封闭形式的表达式及其数值。\n\n答案规格：\n- 为使推导清晰，请提供所有必要的中间表达式。\n- 对于您最终报告的结果，仅输出塑性再加载开始时的压缩应力值（单位为 $\\mathrm{MPa}$），作为一个单独的数字。除精确算术外，无需进行四舍五入。最终的方框答案中请勿包含单位。",
            "solution": "首先，我们根据给定的硬化定律和 $t_0$ 时刻的状态变量，确定此时的内变量 $R_0$（各向同性硬化）和 $\\alpha_0$（随动硬化）的值。\n\n各向同性硬化变量 $R_0$ 为：\n$$\nR_0 = H_{\\text{iso}}\\,\\bar{\\epsilon}^{p}_0 = (1000\\ \\mathrm{MPa}) \\times 0.010 = 10\\ \\mathrm{MPa}\n$$\n随动硬化变量（背应力）$\\alpha_0$ 为：\n$$\n\\alpha_0 = H_{\\text{kin}}\\,\\epsilon^{p}_0 = (5000\\ \\mathrm{MPa}) \\times 0.010 = 50\\ \\mathrm{MPa}\n$$\n\n**任务 1：确定弹性卸载期间的 $\\Delta R$ 和 $\\Delta \\alpha$。**\n\n根据塑性理论，内变量的演化仅在塑性流动期间发生。弹性卸载过程定义为没有塑性应变增量的过程，即 $\\dot{\\epsilon}^{p} = 0$，从而 $\\dot{\\bar{\\epsilon}}^{p} = 0$。\n由于内变量 $R$ 和 $\\alpha$ 的演化率（$\\dot{R} = H_{\\text{iso}}\\,\\dot{\\bar{\\epsilon}}^{p}$ 和 $\\dot{\\alpha} = H_{\\text{kin}}\\,\\dot{\\epsilon}^{p}$）都与塑性应变率成正比，在整个弹性卸载阶段，它们都保持恒定。\n因此，在从 $t_0$ 到 $\\sigma=0$ 的弹性卸载期间，屈服面尺寸和中心的变化量为零：\n$$\n\\Delta R = 0\n$$\n$$\n\\Delta \\alpha = 0\n$$\n在卸载结束时（$\\sigma = 0$），材料的内变量状态为 $R = R_0 = 10\\ \\mathrm{MPa}$ 和 $\\alpha = \\alpha_0 = 50\\ \\mathrm{MPa}$。\n\n**任务 2：确定塑性再加载开始时的压缩应力。**\n\n卸载后，材料从 $\\sigma=0$ 的状态进行压缩（负 $\\sigma$）再加载。此过程初始为弹性，内变量保持不变 ($R=R_0, \\alpha=\\alpha_0$)。当应力状态再次达到屈服面时，塑性流动重新开始。屈服条件为：\n$$\nf(\\sigma, \\alpha_0, R_0) = |\\sigma - \\alpha_0| - (\\sigma_{y0} + R_0) = 0\n$$\n由于是压缩加载，我们预期再次屈服应力 $\\sigma$ 为负值。而已知背应力 $\\alpha_0 = 50\\ \\mathrm{MPa}$ 为正，因此项 $(\\sigma - \\alpha_0)$ 为负。绝对值项可写作：\n$$\n|\\sigma - \\alpha_0| = -(\\sigma - \\alpha_0) = \\alpha_0 - \\sigma\n$$\n代入屈服条件：\n$$\n(\\alpha_0 - \\sigma) - (\\sigma_{y0} + R_0) = 0\n$$\n求解再次屈服时的压缩应力 $\\sigma$：\n$$\n\\sigma = \\alpha_0 - (\\sigma_{y0} + R_0)\n$$\n代入数值：\n$$\n\\sigma = 50\\ \\mathrm{MPa} - (250\\ \\mathrm{MPa} + 10\\ \\mathrm{MPa})\n$$\n$$\n\\sigma = 50\\ \\mathrm{MPa} - 260\\ \\mathrm{MPa}\n$$\n$$\n\\sigma = -210\\ \\mathrm{MPa}\n$$\n因此，当压缩应力达到 $-210\\ \\mathrm{MPa}$ 时，塑性再加载开始。这体现了由随动硬化描述的包辛格效应。",
            "answer": "$$\n\\boxed{-210}\n$$"
        },
        {
            "introduction": "从理论到代码是计算力学工程师的必经之路。这个综合性练习将指导你实现一个完整的 J2 塑性模型的应力更新算法，也就是所谓的“返回映射”算法。此实践不仅要求你正确执行塑性加载的计算，还强调了如何处理弹性步，并引入诊断指标来监控算法的数值精度和稳健性，例如识别由于数值累积误差导致的伪塑性。",
            "id": "3560499",
            "problem": "考虑一个由关联 von Mises（也称 $J_2$）塑性与线性各向同性硬化控制的小应变、率无关、各向同性弹塑性材料。设柯西应力张量为 $\\sigma$，总微应变张量为 $\\varepsilon$，塑性应变为 $\\varepsilon^{p}$。弹性刚度由杨氏模量 $E$ 和泊松比 $\\nu$ 定义，剪切模量为 $G = \\dfrac{E}{2(1+\\nu)}$，体积模量为 $K = \\dfrac{E}{3(1-2\\nu)}$。加法分解 $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$ 成立，线性弹性关系给出 $\\sigma = 2 G \\, \\mathrm{dev}(\\varepsilon^{e}) + K \\, \\mathrm{tr}(\\varepsilon^{e}) \\, I$，其中 $I$ 是单位张量。von Mises 等效应力为 $\\sigma_{\\mathrm{eq}} = \\sqrt{\\dfrac{3}{2} \\, s:s}$，其中偏应力为 $s = \\mathrm{dev}(\\sigma) = \\sigma - \\dfrac{1}{3} \\mathrm{tr}(\\sigma) I$。设硬化变量为等效塑性应变 $p$，屈服应力为 $\\sigma_{y}(p) = \\sigma_{y0} + H \\, p$，其中 $\\sigma_{y0}$ 是初始屈服应力，$H$ 是（常数）硬化模量。\n\n流动法则是关联的，塑性乘子为 $\\lambda$，并满足 Kuhn–Tucker 条件\n$ \\lambda \\ge 0,\\quad f(\\sigma,p) \\le 0,\\quad \\lambda \\, f(\\sigma,p) = 0,$\n其中屈服函数为 $f(\\sigma,p) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(p)$。在屈服面上的塑性加载过程中，强制执行一致性条件 $\\dot{f} = 0$。在弹性卸载过程中（包括在屈服面上），强制执行 $\\dot{\\lambda}=0$。\n\n按如下方式实现每个时间步（应变增量）的计算应力更新算法：\n- 从已知状态 $(\\sigma_{n}, p_{n})$ 和给定的总应变增量 $\\Delta \\varepsilon$ 开始。\n- 使用 $\\Delta \\varepsilon$ 和弹性响应（在试探中 $\\Delta \\varepsilon^{p} = 0$）构建弹性试探状态 $(\\sigma_{\\mathrm{trial}}, p_{n})$。\n- 使用一致性条件 $\\dot{f}=0$（塑性加载）和 $\\dot{\\lambda}=0$（弹性卸载）来判断该步是弹性的还是塑性的，并相应地更新 $(\\sigma_{n+1}, p_{n+1})$。\n- 使用等效塑性应变增量定义 $\\Delta p = \\sqrt{\\dfrac{2}{3} \\, \\|\\Delta \\varepsilon^{p}\\|}$（其中 $\\|\\cdot\\|$ 是 Frobenius 范数）和关联流动法则来构建返回映射，不依赖任何预先提供的快捷公式。\n\n你还必须计算用于量化数值漂移和潜在伪塑性的诊断指标：\n- 对于每个归类为塑性的增量，在更新后计算绝对一致性残差 $|f_{n+1}|$。将加载路径的 $r_1$ 定义为这些值的最大值（单位：$\\mathrm{Pa}$）。\n- 对于每个归类为弹性的增量，在更新后计算 $\\max(f_{n+1}, 0)$。将加载路径的 $r_2$ 定义为这些值的最大值（单位：$\\mathrm{Pa}$）。\n- 为检测由数值漂移引起的弹性卸载过程中的伪塑性，使用基于试探状态的离散卸载指标。设 $f_n$ 是在 $(\\sigma_n, p_n)$ 处计算的屈服函数，而 $f_{\\mathrm{trial}}$ 是在 $(\\sigma_{\\mathrm{trial}}, p_n)$ 处计算的。如果 $|f_n| \\le \\tau_y$ 且 $f_{\\mathrm{trial}} - f_n  0$（从屈服面向内移动），但算法产生 $\\Delta p  0$，则将此 $\\Delta p$ 累积为伪塑性。将加载路径的 $r_3$ 定义为累积的总伪 $\\Delta p$（无量纲）。\n- 使用固定屈服面容差 $\\tau_y = 10^{-6} \\, \\sigma_{y0}$（单位：$\\mathrm{Pa}$）来划分弹性和塑性，并用于上述卸载检测。所有应力以 $\\mathrm{Pa}$ 表示，应变为无量纲数。\n\n你的程序必须实现上述算法，并为以下每个测试加载路径（所有路径使用相同的材料参数）生成诊断指标 $(r_1, r_2, r_3)$：\n- 所有测试的材料参数：$E = 2.10 \\times 10^{11} \\, \\mathrm{Pa}$，$\\nu = 0.3$，$\\sigma_{y0} = 2.50 \\times 10^{8} \\, \\mathrm{Pa}$，$H = 1.00 \\times 10^{9} \\, \\mathrm{Pa}$。\n- 测试 $\\#1$（纯弹性单轴应变）：在 $x$ 方向上施加五个单轴应变增量，其中 $\\Delta \\varepsilon_{xx} = 1.00 \\times 10^{-4}$，所有其他分量为零，即\n$$\n\\Delta \\varepsilon^{(k)} = \\begin{bmatrix} 1.00 \\times 10^{-4}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\n对于 $k = 1,\\dots,5$。\n- 测试 $\\#2$（单轴应变中的塑性加载后弹性卸载）：八个增量，前四个为 $\\Delta \\varepsilon_{xx} = 5.00 \\times 10^{-4}$，随后是四个卸载增量 $\\Delta \\varepsilon_{xx} = -2.50 \\times 10^{-4}$，每个增量中的所有其他分量为零，即\n$$\n\\Delta \\varepsilon^{(k)} = \\begin{bmatrix} 5.00 \\times 10^{-4}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\n对于 $k=1,2,3,4$ 且\n$$\n\\Delta \\varepsilon^{(k)} = \\begin{bmatrix} -2.50 \\times 10^{-4}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\n对于 $k=5,6,7,8$。\n- 测试 $\\#3$（单轴应变中围绕屈服面的振荡）：一个较大的增量以达到并超过屈服，随后是小幅振荡，所有其他分量为零：\n$$\n\\Delta \\varepsilon^{(1)} = \\begin{bmatrix} 1.20 \\times 10^{-3}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\n然后对于 $m = 1,\\dots,10$，进行两步振荡\n$$\n\\Delta \\varepsilon^{(2m)} = \\begin{bmatrix} 1.00 \\times 10^{-5}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\n和\n$$\n\\Delta \\varepsilon^{(2m+1)} = \\begin{bmatrix} -1.00 \\times 10^{-5}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{bmatrix}\n$$\n总共 21 步。\n- 测试 $\\#4$（纯静水应变）：五个纯体积应变增量，每个增量为\n$$\n\\Delta \\varepsilon^{(k)} = 1.00 \\times 10^{-4} \\, I = \\begin{bmatrix} 1.00 \\times 10^{-4}  0  0 \\\\ 0  1.00 \\times 10^{-4}  0 \\\\ 0  0  1.00 \\times 10^{-4} \\end{bmatrix}\n$$\n对于 $k=1,\\dots,5$。\n\n你的程序应为每个测试计算 $(r_1, r_2, r_3)$，并生成一行输出，其中包含按测试顺序列出的结果，格式为逗号分隔的列表的列表，其中每个内部列表为 $[r_1, r_2, r_3]$（例如，$\\left[\\,[r_{1}^{(1)}, r_{2}^{(1)}, r_{3}^{(1)}], [r_{1}^{(2)}, r_{2}^{(2)}, r_{3}^{(2)}], \\dots \\right]$）。$r_1$ 和 $r_2$ 以 $\\mathrm{Pa}$ 表示，$r_3$ 为无量纲数。不涉及角度。不应打印百分比；对所有量使用十进制表示。",
            "solution": "该问题的解决方案在于实现一个标准的弹性预测-塑性校正（返回映射）算法，并为四个指定的加载路径计算诊断指标。\n\n**算法概述**\n\n1.  **初始化**：根据给定的杨氏模量 $E$ 和泊松比 $\\nu$ 计算剪切模量 $G$ 和体积模量 $K$。计算屈服面容差 $\\tau_y = 10^{-6} \\sigma_{y0}$。\n\n2.  **增量步循环**：对于每个加载路径中的每个应变增量 $\\Delta\\varepsilon$，从状态 $(\\sigma_n, p_n)$ 开始执行以下操作：\n    a. **弹性预测**：假设增量完全弹性，计算试探应力：\n    $$ \\sigma_{\\mathrm{trial}} = \\sigma_n + 2G \\, \\mathrm{dev}(\\Delta\\varepsilon) + K \\, \\mathrm{tr}(\\Delta\\varepsilon) I $$\n    b. **屈服检查**：计算试探屈服函数值 $f_{\\mathrm{trial}} = \\sigma_{\\mathrm{eq, trial}} - (\\sigma_{y0} + H p_n)$。\n    c. **状态更新**：\n        - 如果 $f_{\\mathrm{trial}} \\le \\tau_y$，则该步骤是弹性的。最终状态为 $(\\sigma_{n+1}, p_{n+1}) = (\\sigma_{\\mathrm{trial}}, p_n)$。\n        - 如果 $f_{\\mathrm{trial}}  \\tau_y$，则该步骤是塑性的。执行返回映射：\n            i.  计算等效塑性应变增量：\n                $$ \\Delta p = \\frac{f_{\\mathrm{trial}}}{3G + H} $$\n            ii. 更新状态变量：\n                $$ p_{n+1} = p_n + \\Delta p $$\n                $$ s_{n+1} = s_{\\mathrm{trial}} \\left(1 - \\frac{3G\\Delta p}{\\sigma_{\\mathrm{eq, trial}}}\\right) $$\n                $$ \\sigma_{n+1} = s_{n+1} + \\frac{1}{3}\\mathrm{tr}(\\sigma_{\\mathrm{trial}})I $$\n3.  **诊断指标计算**：\n    - **$r_1$**：在每个塑性步骤后，计算一致性残差 $|f_{n+1}|$，并更新 $r_1$ 为所有塑性步骤中该残差的最大值。\n    - **$r_2$**：在每个弹性步骤后，计算屈服面漂移 $\\max(f_{n+1}, 0)$，并更新 $r_2$ 为所有弹性步骤中该漂移的最大值。\n    - **$r_3$**：在每个步骤开始时，检查是否满足伪塑性条件：$|f_n| \\le \\tau_y$ 且 $f_{\\mathrm{trial}} - f_n  0$。如果满足此条件但算法仍计算出 $\\Delta p > 0$，则将此 $\\Delta p$ 累加到 $r_3$。\n\n所提供的答案中的 Python 代码实现了上述逻辑，为每个测试用例运行模拟并输出所需的诊断指标列表。",
            "answer": "```python\nimport numpy as np\n\ndef dev(tensor):\n    \"\"\"Computes the deviatoric part of a 3x3 tensor.\"\"\"\n    return tensor - (1/3) * np.trace(tensor) * np.identity(3)\n\ndef von_mises(sigma):\n    \"\"\"Computes the von Mises equivalent stress for a 3x3 Cauchy stress tensor.\"\"\"\n    s = dev(sigma)\n    # The Frobenius inner product s:s is equivalent to np.sum(s*s)\n    s_dot_s = np.sum(s * s)\n    # Handle the case where stress is purely hydrostatic to avoid sqrt of small negative number\n    if s_dot_s  1e-24: # Use a small tolerance instead of direct comparison\n        return 0.0\n    return np.sqrt(3/2 * s_dot_s)\n\ndef yield_f(sigma, p, sigma_y0, H):\n    \"\"\"Computes the value of the yield function.\"\"\"\n    sigma_eq = von_mises(sigma)\n    sigma_y = sigma_y0 + H * p\n    return sigma_eq - sigma_y\n\ndef run_test_path(strain_increments, E, nu, sigma_y0, H):\n    \"\"\"Runs a simulation for a given loading path and returns diagnostic indicators.\"\"\"\n    # Derived material properties\n    G = E / (2 * (1 + nu))\n    K = E / (3 * (1 - 2 * nu))\n    tau_y = 1e-6 * sigma_y0\n\n    # Initial state\n    sigma_n = np.zeros((3, 3))\n    p_n = 0.0\n\n    # Diagnostic accumulators\n    r1 = 0.0  # Max |f_np1| for plastic steps\n    r2 = 0.0  # Max max(f_np1, 0) for elastic steps\n    r3 = 0.0  # Accumulated spurious delta_p\n\n    for delta_eps in strain_increments:\n        # Calculate yield function at the beginning of the step for r3 check\n        f_n = yield_f(sigma_n, p_n, sigma_y0, H)\n\n        # 1. Elastic Trial Step\n        tr_delta_eps = np.trace(delta_eps)\n        dev_delta_eps = dev(delta_eps)\n        delta_sigma_trial = 2 * G * dev_delta_eps + K * tr_delta_eps * np.identity(3)\n        sigma_trial = sigma_n + delta_sigma_trial\n\n        # Current yield stress\n        sigma_y_n = sigma_y0 + p_n * H\n        \n        # Trial yield function value\n        sigma_eq_trial = von_mises(sigma_trial)\n        f_trial = sigma_eq_trial - sigma_y_n\n\n        delta_p = 0.0 # Initialize delta_p for the step\n\n        # 2. Check for Plasticity (Elastic/Plastic decision)\n        if f_trial = tau_y:\n            # Elastic step\n            sigma_np1 = sigma_trial\n            p_np1 = p_n\n            \n            f_np1 = yield_f(sigma_np1, p_np1, sigma_y0, H)\n            r2 = max(r2, max(f_np1, 0.0))\n\n        else:\n            # Plastic step (Return Mapping)\n            delta_p = f_trial / (3 * G + H)\n            p_np1 = p_n + delta_p\n            \n            s_trial = dev(sigma_trial)\n            \n            if sigma_eq_trial > 1e-12: # Avoid division by zero\n                s_np1 = s_trial * (1 - (3 * G * delta_p) / sigma_eq_trial)\n            else:\n                s_np1 = s_trial\n                \n            hydro_stress_trial = (1/3) * np.trace(sigma_trial)\n            sigma_np1 = s_np1 + hydro_stress_trial * np.identity(3)\n\n            f_np1 = yield_f(sigma_np1, p_np1, sigma_y0, H)\n            r1 = max(r1, abs(f_np1))\n\n        # 3. Spurious Plasticity Check (for r3)\n        is_on_surface = abs(f_n) = tau_y\n        is_unloading = (f_trial - f_n)  0\n        \n        if is_on_surface and is_unloading:\n            if delta_p > 0:\n                r3 += delta_p\n        \n        # 4. Update state for the next increment\n        sigma_n = sigma_np1\n        p_n = p_np1\n        \n    return [r1, r2, r3]\n\ndef solve():\n    \"\"\"\n    Defines and runs the test cases, then prints the results in the required format.\n    \"\"\"\n    # Material parameters from the problem statement\n    E = 2.10e11  # Pa\n    nu = 0.3\n    sigma_y0 = 2.50e8  # Pa\n    H = 1.00e9   # Pa\n\n    # Test Case #1: Purely elastic uniaxial straining\n    strain_path1 = []\n    delta_eps1 = np.zeros((3, 3))\n    delta_eps1[0, 0] = 1.00e-4\n    for _ in range(5):\n        strain_path1.append(delta_eps1)\n\n    # Test Case #2: Plastic loading then elastic unloading in uniaxial straining\n    strain_path2 = []\n    delta_eps2a = np.zeros((3, 3)); delta_eps2a[0, 0] = 5.00e-4\n    delta_eps2b = np.zeros((3, 3)); delta_eps2b[0, 0] = -2.50e-4\n    for _ in range(4):\n        strain_path2.append(delta_eps2a)\n    for _ in range(4):\n        strain_path2.append(delta_eps2b)\n\n    # Test Case #3: Oscillation about the yield surface in uniaxial straining\n    strain_path3 = []\n    delta_eps3_initial = np.zeros((3, 3)); delta_eps3_initial[0, 0] = 1.20e-3\n    delta_eps3_load = np.zeros((3, 3)); delta_eps3_load[0, 0] = 1.00e-5\n    delta_eps3_unload = np.zeros((3, 3)); delta_eps3_unload[0, 0] = -1.00e-5\n    strain_path3.append(delta_eps3_initial)\n    for _ in range(10):\n        strain_path3.append(delta_eps3_load)\n        strain_path3.append(delta_eps3_unload)\n\n    # Test Case #4: Pure hydrostatic straining\n    strain_path4 = []\n    delta_eps4 = np.identity(3) * 1.00e-4\n    for _ in range(5):\n        strain_path4.append(delta_eps4)\n        \n    test_cases = [\n        # (Parameter set 1) -> corresponds to Test #1 above\n        strain_path1,\n        # (Parameter set 2) -> Test #2\n        strain_path2,\n        # (Parameter set 3) -> Test #3\n        strain_path3,\n        # (Parameter set 4) -> Test #4\n        strain_path4,\n    ]\n    \n    results = []\n    for case_path in test_cases:\n        res = run_test_path(case_path, E, nu, sigma_y0, H)\n        results.append(res)\n    \n    # Format the output string to match the problem's specification exactly,\n    # i.e., a list of lists with no spaces.\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}