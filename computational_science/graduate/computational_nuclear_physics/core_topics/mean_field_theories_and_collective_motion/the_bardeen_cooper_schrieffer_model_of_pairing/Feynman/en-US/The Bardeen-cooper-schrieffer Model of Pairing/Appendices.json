{
    "hands_on_practices": [
        {
            "introduction": "Pairing is a collective phenomenon that does not arise from any arbitrarily weak attractive interaction. For a coherent, paired ground state to form, the pairing force must be strong enough to overcome the energy spacing between single-particle levels. This practice guides you through the derivation of the critical pairing strength, $G_c$, below which the system remains in a normal, unpaired state, providing a quantitative understanding of the threshold for the onset of pairing correlations .",
            "id": "3594084",
            "problem": "Consider a finite-level model for nuclear pairing within the Bardeen–Cooper–Schrieffer (BCS) framework at zero temperature. A set of $2m$ doubly-degenerate single-particle levels is arranged symmetrically about the chemical potential at $\\mu=0$ (half filling), with single-particle energies\n$$\n\\epsilon_{n,\\pm}=\\pm\\left(n+\\frac{1}{2}\\right)d,\\quad n=0,1,2,\\dots,m-1,\n$$\nwhere $d>0$ is the uniform level spacing. Assume a constant, attractive, separable pairing interaction acting among time-reversed partners across the entire set of these levels, with Hamiltonian\n$$\nH=\\sum_{j}\\epsilon_{j}\\left(a_{j}^{\\dagger}a_{j}+a_{\\bar{j}}^{\\dagger}a_{\\bar{j}}\\right)-G\\,P^{\\dagger}P,\n$$\nwhere $G>0$ is the pairing strength, $P^{\\dagger}=\\sum_{j}a_{j}^{\\dagger}a_{\\bar{j}}^{\\dagger}$ creates a correlated pair, and $j$ labels the single-particle levels while $\\bar{j}$ denotes the time-reversed partner. Using the Bardeen–Cooper–Schrieffer (BCS) variational ansatz, the mean-field decoupling, and the self-consistency condition for the pairing gap, analyze the existence of a nontrivial solution $0<\\Delta<\\infty$ for the BCS gap $\\Delta$ as a function of $G$ in this finite-level system.\n\nStarting from the Hamiltonian above and fundamental BCS definitions, derive the zero-temperature gap self-consistency condition and, by analyzing its behavior in the limit $\\Delta\\to 0^{+}$, determine the exact closed-form expression for the critical pairing strength $G_{c}$ such that a nontrivial gap solution exists if and only if $G\\ge G_{c}$. Express your final answer in terms of $m$ and $d$ only, and provide it as a single analytic expression. No numerical evaluation is required, and no rounding should be applied. The final answer must be dimensionally consistent with the pairing strength $G$ (energy units).",
            "solution": "The problem statement is critically validated before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **Model**: Finite-level Bardeen–Cooper–Schrieffer (BCS) model for nuclear pairing at zero temperature.\n- **Single-Particle Levels**: A set of $2m$ doubly-degenerate single-particle levels.\n- **Chemical Potential**: $\\mu=0$ (half filling).\n- **Single-Particle Energies**: The energies of the $2m$ levels are given by $\\epsilon_{n,\\pm}=\\pm\\left(n+\\frac{1}{2}\\right)d$, for $n=0,1,2,\\dots,m-1$.\n- **Level Spacing**: $d>0$.\n- **Interaction**: A constant, attractive, separable pairing interaction with strength $G>0$.\n- **Hamiltonian**: $H=\\sum_{j}\\epsilon_{j}\\left(a_{j}^{\\dagger}a_{j}+a_{\\bar{j}}^{\\dagger}a_{\\bar{j}}\\right)-G\\,P^{\\dagger}P$.\n- **Pair Operator**: $P^{\\dagger}=\\sum_{j}a_{j}^{\\dagger}a_{\\bar{j}}^{\\dagger}$, where the sum is over the single-particle levels available for pairing.\n- **Task**: Derive the zero-temperature BCS gap self-consistency condition for this system and find the critical pairing strength $G_c$ for the existence of a nontrivial pairing gap $\\Delta > 0$. The final expression for $G_c$ must be in terms of $m$ and $d$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a simplified version of the pairing model in nuclear physics, often referred to as a Richardson-Gaudin model. The BCS theory, the mean-field approximation, and the concept of a critical interaction strength for a pairing phase transition are all standard and fundamental topics in many-body quantum theory. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-posed. It provides a clearly defined physical system and a specific, calculable quantity to be determined ($G_c$). All necessary parameters ($m$, $d$) and conditions ($\\mu=0$, $T=0$) are provided.\n- **Objective**: The problem is stated in precise, objective mathematical and physical language, free from ambiguity or subjective content.\n- **Flaw Checklist**: The problem does not violate any of the invalidity criteria. It is complete, consistent, formalizable, and scientifically relevant.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\nThe solution proceeds by applying the variational principle to the BCS ground state ansatz for the provided Hamiltonian. The grand canonical Hamiltonian at zero temperature is $K = H - \\mu N$. Given that the chemical potential $\\mu=0$, we have $K=H$.\n\nThe BCS variational ground state is given by $|\\Psi_{\\text{BCS}}\\rangle = \\prod_{j} (u_j + v_j a_j^{\\dagger} a_{\\bar{j}}^{\\dagger}) |0\\rangle$, where the product is over all single-particle levels $j$ that participate in pairing. The real coefficients $u_j$ and $v_j$ represent the probability amplitudes for a pair state $(j, \\bar{j})$ to be empty or occupied, respectively, and they satisfy the normalization condition $u_j^2 + v_j^2 = 1$.\n\nThe expectation value of the Hamiltonian in the BCS state is\n$$\nE = \\langle \\Psi_{\\text{BCS}} | H | \\Psi_{\\text{BCS}} \\rangle = \\sum_{j} 2\\epsilon_j v_j^2 - G \\left( \\sum_{j} u_j v_j \\right)^2\n$$\nThe pairing gap $\\Delta$ is defined via the self-consistency relation $\\Delta = G \\sum_{j} u_j v_j$. Substituting this into the energy expression gives\n$$\nE = \\sum_j 2\\epsilon_j v_j^2 - \\frac{\\Delta^2}{G}\n$$\nWe minimize this energy with respect to the variational parameters $v_j$, subject to the constraints $u_j^2 + v_j^2 = 1$. A standard way to do this is to minimize the auxiliary functional $\\tilde{E} = \\langle H_{MF} \\rangle = \\langle H - \\Delta(P+P^\\dagger) + \\Delta^2/G \\rangle$, which leads to the well-known BCS results. The minimization yields the expressions for the occupation amplitudes:\n$$\nv_j^2 = \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_j}{E_j} \\right) \\quad \\text{and} \\quad u_j^2 = \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_j}{E_j} \\right)\n$$\nwhere $E_j = \\sqrt{\\epsilon_j^2 + \\Delta^2}$ is the quasiparticle energy for level $j$. From these, the product $u_j v_j$ is found to be\n$$\nu_j v_j = \\frac{\\Delta}{2 E_j} = \\frac{\\Delta}{2 \\sqrt{\\epsilon_j^2 + \\Delta^2}}\n$$\nSubstituting this back into the definition of the gap $\\Delta = G \\sum_{j} u_j v_j$, we obtain the zero-temperature BCS gap equation:\n$$\n\\Delta = G \\sum_{j} \\frac{\\Delta}{2 \\sqrt{\\epsilon_j^2 + \\Delta^2}}\n$$\nFor a non-trivial gap solution ($\\Delta > 0$), we can divide both sides by $\\Delta$ to get the self-consistency condition:\n$$\n1 = G \\sum_{j} \\frac{1}{2 \\sqrt{\\epsilon_j^2 + \\Delta^2}} \\quad \\implies \\quad \\frac{2}{G} = \\sum_{j} \\frac{1}{\\sqrt{\\epsilon_j^2 + \\Delta^2}}\n$$\nThe sum over $j$ runs over all single-particle levels involved in the pairing. The problem states that the pairing interaction acts across the entire set of $2m$ levels, whose energies are $\\epsilon_{n,\\pm} = \\pm(n + 1/2)d$ for $n=0, 1, \\dots, m-1$. The sum therefore has $2m$ terms. We can group the terms for positive and negative energies:\n$$\n\\frac{2}{G} = \\sum_{n=0}^{m-1} \\left( \\frac{1}{\\sqrt{\\epsilon_{n,+}^2 + \\Delta^2}} + \\frac{1}{\\sqrt{\\epsilon_{n,-}^2 + \\Delta^2}} \\right)\n$$\nSince $\\epsilon_{n,+}^2 = \\epsilon_{n,-}^2 = \\left( (n+1/2)d \\right)^2$, the two terms in the parenthesis are identical.\n$$\n\\frac{2}{G} = \\sum_{n=0}^{m-1} \\frac{2}{\\sqrt{\\left( \\left(n+\\frac{1}{2}\\right)d \\right)^2 + \\Delta^2}}\n$$\nThis simplifies to the specific gap equation for this model:\n$$\n\\frac{1}{G} = \\sum_{n=0}^{m-1} \\frac{1}{\\sqrt{\\left( \\left(n+\\frac{1}{2}\\right)d \\right)^2 + \\Delta^2}}\n$$\nA non-trivial solution for the gap, $\\Delta > 0$, exists if and only if the value of $1/G$ allows for a solution to this equation. Let $f(\\Delta^2) = \\sum_{n=0}^{m-1} \\left( \\left( (n+1/2)d \\right)^2 + \\Delta^2 \\right)^{-1/2}$. The function $f(\\Delta^2)$ is a monotonically decreasing function for $\\Delta^2 > 0$. A solution for $\\Delta > 0$ exists if and only if $1/G < \\lim_{\\Delta^2 \\to 0^+} f(\\Delta^2)$. The critical pairing strength, $G_c$, is defined by the equality, which marks the onset of a non-trivial solution.\n$$\n\\frac{1}{G_c} = \\lim_{\\Delta \\to 0^+} \\sum_{n=0}^{m-1} \\frac{1}{\\sqrt{\\left( \\left(n+\\frac{1}{2}\\right)d \\right)^2 + \\Delta^2}} = \\sum_{n=0}^{m-1} \\frac{1}{\\left|\\left(n+\\frac{1}{2}\\right)d\\right|}\n$$\nGiven that $n \\ge 0$ and $d>0$, the absolute value is redundant.\n$$\n\\frac{1}{G_c} = \\frac{1}{d} \\sum_{n=0}^{m-1} \\frac{1}{n+\\frac{1}{2}} = \\frac{2}{d} \\sum_{n=0}^{m-1} \\frac{1}{2n+1}\n$$\nTo obtain a closed-form expression, we evaluate the sum. Let $S_m = \\sum_{n=0}^{m-1} \\frac{1}{2n+1}$. This sum is over the reciprocals of the first $m$ odd integers. This sum can be expressed in terms of the generalized harmonic numbers, $H_k = \\sum_{i=1}^k \\frac{1}{i}$. We write the full harmonic number $H_{2m}$ as a sum over even and odd denominators:\n$$\nH_{2m} = \\sum_{k=1}^{2m} \\frac{1}{k} = \\left(\\frac{1}{1} + \\frac{1}{3} + \\dots + \\frac{1}{2m-1}\\right) + \\left(\\frac{1}{2} + \\frac{1}{4} + \\dots + \\frac{1}{2m}\\right)\n$$\nThe first parenthesis is our sum $S_m$. The second can be factored:\n$$\nH_{2m} = S_m + \\frac{1}{2}\\left(\\frac{1}{1} + \\frac{1}{2} + \\dots + \\frac{1}{m}\\right) = S_m + \\frac{1}{2} H_m\n$$\nThus, the sum is $S_m = H_{2m} - \\frac{1}{2}H_m$. Substituting this into the expression for $1/G_c$:\n$$\n\\frac{1}{G_c} = \\frac{2}{d} \\left( H_{2m} - \\frac{1}{2}H_m \\right) = \\frac{1}{d} (2H_{2m} - H_m)\n$$\nInverting to find $G_c$ provides the final expression. A non-trivial gap solution exists for $G \\ge G_c$.\n$$\nG_c = \\frac{d}{2H_{2m} - H_m}\n$$\nThis expression is in terms of $d$ and a function of $m$ (the harmonic numbers), as required. The dimensionality is correct, as $d$ has units of energy and harmonic numbers are dimensionless.",
            "answer": "$$\n\\boxed{\\frac{d}{2H_{2m} - H_m}}\n$$"
        },
        {
            "introduction": "The Bardeen-Cooper-Schrieffer theory is a powerful mean-field approximation, but it is essential to understand its domain of validity and its inherent limitations, especially when applied to finite systems like atomic nuclei. This exercise provides a crucial benchmark by guiding you through an analytical solution of the BCS equations for a simple two-level model . By comparing the resulting BCS ground-state energy to the exact energy obtained from direct diagonalization, you will gain direct insight into the nature and magnitude of the error introduced by the mean-field approximation.",
            "id": "3594122",
            "problem": "Consider a symmetric two-level constant-pairing model for like nucleons in two shell-model orbits straddling the Fermi energy. The single-particle levels are at energies $+\\epsilon$ and $-\\epsilon$ relative to the chemical potential, each with pair degeneracy $\\Omega$ (that is, each level contains $\\Omega$ time-reversed pair orbitals). The pairing Hamiltonian is\n$$\nH = \\sum_{j=\\pm} \\epsilon_{j} \\, N_{j} - G \\sum_{j,l=\\pm} P_{j}^{\\dagger} P_{l},\n$$\nwhere $\\epsilon_{+} = +\\epsilon$, $\\epsilon_{-} = -\\epsilon$, $N_{j}$ counts particles in level $j$, and $P_{j}^{\\dagger} \\equiv \\sum_{m>0} c_{j m}^{\\dagger} c_{j \\bar{m}}^{\\dagger}$ creates a pair in level $j$ ($c_{j m}^{\\dagger}$ creates a nucleon in single-particle state $m$ of level $j$ and $c_{j \\bar{m}}^{\\dagger}$ its time-reversed partner). The system is half-filled in pairs, $N_{\\text{pairs}} = \\Omega$, so exactly half of the total pair capacity $2\\Omega$ is occupied.\n\nUsing the Bardeen-Cooper-Schrieffer (BCS) variational framework with a uniform pairing strength $G>0$:\n\n- Derive from first principles (starting from the BCS variational ansatz and its self-consistency conditions) the analytical solution of the BCS equations for this symmetric two-level model at half filling. In particular, establish the value of the chemical potential by symmetry and obtain a closed-form expression for the pairing gap $\\Delta$ in terms of $\\epsilon$, $G$, and $\\Omega$.\n\n- Starting from the BCS expectation value of $H$ and the gap self-consistency relation, derive an analytic closed-form expression for the BCS ground-state energy $E_{\\text{BCS}}$ in this two-level model that depends only on $\\epsilon$, $G$, and $\\Omega$ (no intermediate $u_{j}$, $v_{j}$, or $\\mu$).\n\n- For the finite system with $\\Omega = 1$, compute the exact seniority-zero ground-state energy $E_{\\text{exact}}$ by diagonalizing $H$ in the one-pair subspace spanned by $ \\{|1\\rangle = P_{-}^{\\dagger} |0\\rangle, |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\} $. Then evaluate the fractional energy error\n$$\n\\delta = \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|}\n$$\nfor parameter values $\\epsilon = 0.50 \\text{ MeV}$ and $G = 0.60 \\text{ MeV}$. Round your final numerical value for $\\delta$ to four significant figures. Express the final number as a pure decimal (no percent sign).",
            "solution": "The problem is subjected to validation before proceeding with a solution.\n\n### Step 1: Extract Givens\n- **Model**: Symmetric two-level constant-pairing model for like nucleons.\n- **Single-particle levels**: Energies are stated as \"$+\\epsilon$\" and \"$-\\epsilon$\" relative to the chemical potential. The Hamiltonian is given with $\\epsilon_+ = +\\epsilon$ and $\\epsilon_- = -\\epsilon$, which clarifies that these are the bare single-particle energies.\n- **Pair degeneracy**: Each level $j$ has a pair degeneracy of $\\Omega$.\n- **Hamiltonian**: $H = \\sum_{j=\\pm} \\epsilon_{j} \\, N_{j} - G \\sum_{j,l=\\pm} P_{j}^{\\dagger} P_{l}$.\n- **Operators**: $N_{j}$ is the particle number operator for level $j$. $P_{j}^{\\dagger} \\equiv \\sum_{m>0} c_{j m}^{\\dagger} c_{j \\bar{m}}^{\\dagger}$ is the pair creation operator for level $j$.\n- **Pairing strength**: $G>0$.\n- **Occupation**: The system is half-filled in pairs, $N_{\\text{pairs}} = \\Omega$.\n- **Task 1**: Derive the chemical potential $\\mu$ and the pairing gap $\\Delta$ in terms of $\\epsilon$, $G$, and $\\Omega$ using the Bardeen-Cooper-Schrieffer (BCS) framework.\n- **Task 2**: Derive the BCS ground-state energy $E_{\\text{BCS}}$ in terms of $\\epsilon$, $G$, and $\\Omega$.\n- **Task 3**: For $\\Omega = 1$, compute the exact seniority-zero ground-state energy $E_{\\text{exact}}$ by diagonalizing $H$ in the one-pair subspace spanned by $\\{|1\\rangle = P_{-}^{\\dagger} |0\\rangle,\\; |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\}$.\n- **Task 4**: Evaluate the fractional energy error $\\delta = \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|}$ for parameter values $\\epsilon = 0.50 \\text{ MeV}$ and $G = 0.60 \\text{ MeV}$, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is based on the well-established BCS theory of superconductivity, applied to a standard pairing model in nuclear physics. The Hamiltonian and concepts are fundamental to nuclear many-body theory.\n- **Well-Posedness**: The problem is well-posed. It asks for derivations and calculations that follow standard, solvable procedures in theoretical physics (variational minimization, matrix diagonalization).\n- **Objectivity**: The language is objective and precise.\n- **Completeness and Consistency**: The model is fully specified. The ambiguity in the phrase \"relative to the chemical potential\" is resolved by the subsequent instruction to \"establish the value of the chemical potential by symmetry,\" which indicates that $\\mu$ is to be determined, not assumed. The half-filling condition $N_{\\text{pairs}} = \\Omega$ is consistent with the total pair capacity of $2\\Omega$.\n- **Realism**: The model is a simplification but serves as a canonical example in teaching and research. The numerical values provided are physically reasonable within the context of nuclear structure.\n- **Triviality**: The problem is non-trivial, requiring a multi-step derivation and calculation that tests a solid understanding of the BCS formalism and its relation to exact solutions.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### BCS Solution for the Two-Level Model\n\nThe BCS theory employs a variational ansatz for the ground state of a paired system. The ground state is approximated by a product of pair-correlated states for each level $j$:\n$$\n|\\text{BCS}\\rangle = \\prod_{j, m>0} (u_j + v_j c_{jm}^{\\dagger} c_{j\\bar{m}}^{\\dagger}) |0\\rangle\n$$\nwhere $u_j$ and $v_j$ are real variational parameters satisfying the normalization condition $u_j^2 + v_j^2 = 1$. The parameter $v_j^2$ represents the probability that a pair-orbital $(m, \\bar{m})$ in shell $j$ is occupied, and $u_j^2$ is the probability that it is empty.\n\nTo find the optimal $u_j$ and $v_j$, we minimize the expectation value of the grand potential operator $\\hat{K} = H - \\mu N$, where $H$ is the Hamiltonian and $N = \\sum_j N_j$ is the total particle number operator, with $\\mu$ being the chemical potential.\n\nThe expectation values of the number and pair operators in the BCS state are:\n$$\n\\langle N_j \\rangle = 2\\Omega v_j^2 \\quad \\text{and} \\quad \\langle P_j^\\dagger \\rangle = \\langle P_j \\rangle = \\Omega u_j v_j\n$$\nThe factor of $2$ in $\\langle N_j \\rangle$ is because $N_j$ counts particles, not pairs, and there are $\\Omega$ pair states in level $j$.\nIn the mean-field approximation, the expectation value of the pairing term is $\\langle \\sum_{j,l} P_j^\\dagger P_l \\rangle \\approx (\\sum_j \\langle P_j^\\dagger \\rangle)(\\sum_l \\langle P_l \\rangle)$.\nThe expectation value of the grand potential is:\n$$\n\\langle \\hat{K} \\rangle = \\sum_{j=\\pm} \\langle \\epsilon_j N_j - \\mu N_j \\rangle - G \\left( \\sum_{j=\\pm} \\langle P_j^\\dagger \\rangle \\right) \\left( \\sum_{l=\\pm} \\langle P_l \\rangle \\right) \\\\\n= \\sum_{j=\\pm} 2\\Omega (\\epsilon_j - \\mu) v_j^2 - G \\left( \\sum_{j=\\pm} \\Omega u_j v_j \\right)^2\n$$\nThe pairing gap $\\Delta$ is defined by the self-consistency relation $\\Delta = G \\sum_j \\langle P_j \\rangle = G \\sum_j \\Omega u_j v_j$. Substituting this, we get:\n$$\n\\langle \\hat{K} \\rangle = \\sum_{j=\\pm} 2\\Omega (\\epsilon_j - \\mu) v_j^2 - \\frac{\\Delta^2}{G}\n$$\nMinimizing $\\langle \\hat{K} \\rangle$ with respect to the $v_j$ (and $u_j = \\sqrt{1-v_j^2}$), subject to the definition of $\\Delta$, yields the standard BCS equations:\n$$\nu_j^2 = \\frac{1}{2} \\left(1 + \\frac{\\epsilon_j - \\mu}{E_j}\\right), \\quad v_j^2 = \\frac{1}{2} \\left(1 - \\frac{\\epsilon_j - \\mu}{E_j}\\right), \\quad u_j v_j = \\frac{\\Delta}{2E_j}\n$$\nwhere $E_j = \\sqrt{(\\epsilon_j - \\mu)^2 + \\Delta^2}$ is the quasiparticle energy for level $j$.\n\nThe self-consistency conditions for $\\mu$ and $\\Delta$ are the number equation and the gap equation.\nThe total number of particles is $N = 2 N_{\\text{pairs}} = 2\\Omega$.\n$$\nN = \\sum_{j=\\pm} \\langle N_j \\rangle = \\sum_{j=\\pm} 2\\Omega v_j^2 = 2\\Omega \\implies \\sum_{j=\\pm} v_j^2 = 1\n$$\n$$\nv_-^2 + v_+^2 = \\frac{1}{2} \\left(1 - \\frac{-\\epsilon - \\mu}{E_-}\\right) + \\frac{1}{2} \\left(1 - \\frac{\\epsilon - \\mu}{E_+}\\right) = 1\n$$\n$$\n1 - \\frac{1}{2} \\left( \\frac{-\\epsilon - \\mu}{E_-} + \\frac{\\epsilon - \\mu}{E_+} \\right) = 1 \\implies \\frac{\\epsilon + \\mu}{E_-} + \\frac{\\epsilon - \\mu}{E_+} = 0\n$$\nwhere $E_- = \\sqrt{(-\\epsilon-\\mu)^2 + \\Delta^2} = \\sqrt{(\\epsilon+\\mu)^2 + \\Delta^2}$ and $E_+ = \\sqrt{(\\epsilon-\\mu)^2 + \\Delta^2}$.\nThe equation becomes $(\\epsilon + \\mu)E_+ = -(\\epsilon - \\mu)E_-$. Squaring both sides:\n$$\n(\\epsilon + \\mu)^2 E_+^2 = (\\epsilon - \\mu)^2 E_-^2 \\\\\n(\\epsilon + \\mu)^2 [(\\epsilon - \\mu)^2 + \\Delta^2] = (\\epsilon - \\mu)^2 [(\\epsilon + \\mu)^2 + \\Delta^2] \\\\\n(\\epsilon + \\mu)^2 \\Delta^2 = (\\epsilon - \\mu)^2 \\Delta^2\n$$\nAssuming a non-trivial pairing solution ($\\Delta \\neq 0$), we must have $(\\epsilon + \\mu)^2 = (\\epsilon - \\mu)^2$. This gives two possibilities: $\\epsilon + \\mu = \\epsilon - \\mu$, which implies $\\mu = 0$, or $\\epsilon + \\mu = -(\\epsilon - \\mu)$, which implies $\\epsilon = 0$. As $\\epsilon$ is a given parameter, the solution is $\\mu = 0$. This result is expected due to the symmetric level placement and the half-filling condition.\n\nWith $\\mu=0$, the gap equation $\\Delta = G \\sum_j \\Omega u_j v_j$ becomes:\n$$\n\\Delta = G \\sum_{j=\\pm} \\Omega \\frac{\\Delta}{2E_j} \\implies 1 = \\frac{G\\Omega}{2} \\sum_{j=\\pm} \\frac{1}{E_j}\n$$\nWith $\\mu=0$, $E_j = \\sqrt{\\epsilon_j^2 + \\Delta^2}$. Since $\\epsilon_-^2 = (-\\epsilon)^2 = \\epsilon^2$ and $\\epsilon_+^2 = \\epsilon^2$, both quasiparticle energies are equal: $E_- = E_+ = \\sqrt{\\epsilon^2 + \\Delta^2}$.\n$$\n1 = \\frac{G\\Omega}{2} \\left( \\frac{1}{\\sqrt{\\epsilon^2 + \\Delta^2}} + \\frac{1}{\\sqrt{\\epsilon^2 + \\Delta^2}} \\right) = \\frac{G\\Omega}{2} \\frac{2}{\\sqrt{\\epsilon^2 + \\Delta^2}} = \\frac{G\\Omega}{\\sqrt{\\epsilon^2 + \\Delta^2}}\n$$\nSolving for $\\Delta$:\n$$\n\\sqrt{\\epsilon^2 + \\Delta^2} = G\\Omega \\implies \\epsilon^2 + \\Delta^2 = (G\\Omega)^2 \\implies \\Delta^2 = (G\\Omega)^2 - \\epsilon^2\n$$\nThis gives the analytical expression for the pairing gap:\n$$\n\\Delta = \\sqrt{(G\\Omega)^2 - \\epsilon^2}\n$$\nThis solution exists for $G\\Omega > \\epsilon$. If $G\\Omega \\le \\epsilon$, the only solution is $\\Delta=0$ (the normal, non-superfluid state).\n\n### BCS Ground-State Energy\n\nThe BCS ground-state energy $E_{\\text{BCS}}$ is the expectation value of the Hamiltonian $H$ in the BCS state:\n$$\nE_{\\text{BCS}} = \\langle H \\rangle = \\sum_{j=\\pm} \\epsilon_j \\langle N_j \\rangle - G \\left( \\sum_{j=\\pm} \\langle P_j \\rangle \\right)^2 = \\sum_{j=\\pm} 2\\Omega \\epsilon_j v_j^2 - \\frac{\\Delta^2}{G}\n$$\nUsing $\\mu=0$, $v_j^2 = \\frac{1}{2} (1 - \\epsilon_j/E_j)$ with $E_j = \\sqrt{\\epsilon_j^2+\\Delta^2}$.\n$$\nE_{\\text{BCS}} = \\sum_{j=\\pm} 2\\Omega \\epsilon_j \\frac{1}{2} \\left(1 - \\frac{\\epsilon_j}{E_j}\\right) - \\frac{\\Delta^2}{G} = \\Omega \\sum_{j=\\pm} \\left( \\epsilon_j - \\frac{\\epsilon_j^2}{E_j} \\right) - \\frac{\\Delta^2}{G}\n$$\nLet's evaluate the sum:\n$$\n\\sum_{j=\\pm} \\left( \\epsilon_j - \\frac{\\epsilon_j^2}{E_j} \\right) = \\left( \\epsilon_+ - \\frac{\\epsilon_+^2}{E_+} \\right) + \\left( \\epsilon_- - \\frac{\\epsilon_-^2}{E_-} \\right)\n$$\nWith $\\epsilon_+ = \\epsilon$, $\\epsilon_- = -\\epsilon$, and $E_+ = E_- = \\sqrt{\\epsilon^2+\\Delta^2} = E$:\n$$\n= \\left( \\epsilon - \\frac{\\epsilon^2}{E} \\right) + \\left( -\\epsilon - \\frac{(-\\epsilon)^2}{E} \\right) = \\epsilon - \\frac{\\epsilon^2}{E} -\\epsilon - \\frac{\\epsilon^2}{E} = -\\frac{2\\epsilon^2}{E}\n$$\nSubstituting this back into the expression for $E_{\\text{BCS}}$:\n$$\nE_{\\text{BCS}} = \\Omega \\left( -\\frac{2\\epsilon^2}{E} \\right) - \\frac{\\Delta^2}{G} = -\\frac{2\\Omega\\epsilon^2}{\\sqrt{\\epsilon^2+\\Delta^2}} - \\frac{\\Delta^2}{G}\n$$\nNow, we substitute the results from the gap equation: $\\sqrt{\\epsilon^2+\\Delta^2} = G\\Omega$ and $\\Delta^2 = (G\\Omega)^2 - \\epsilon^2$.\n$$\nE_{\\text{BCS}} = -\\frac{2\\Omega\\epsilon^2}{G\\Omega} - \\frac{(G\\Omega)^2 - \\epsilon^2}{G} = -\\frac{2\\epsilon^2}{G} - \\frac{G^2\\Omega^2 - \\epsilon^2}{G}\n$$\n$$\nE_{\\text{BCS}} = \\frac{-2\\epsilon^2 - G^2\\Omega^2 + \\epsilon^2}{G} = \\frac{-\\epsilon^2 - G^2\\Omega^2}{G} = -\\frac{\\epsilon^2}{G} - G\\Omega^2\n$$\n\n### Exact Solution for $\\Omega = 1$ and Fractional Error\n\nFor $\\Omega = 1$, the system contains $N_{\\text{pairs}}=1$ pair. The basis for seniority-zero states with one pair is $\\{|1\\rangle = P_{-}^{\\dagger} |0\\rangle, |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\}$. We construct the Hamiltonian matrix in this orthonormal basis.\nThe Hamiltonian is $H = \\epsilon N_+ - \\epsilon N_- - G(P_+^\\dagger + P_-^\\dagger)(P_+ + P_-)$.\nThe action of the single-particle part on the basis states:\n$$\n(\\epsilon N_+ - \\epsilon N_-) |1\\rangle = -\\epsilon N_- P_-^\\dagger |0\\rangle = -2\\epsilon |1\\rangle\n$$\n$$\n(\\epsilon N_+ - \\epsilon N_-) |2\\rangle = \\epsilon N_+ P_+^\\dagger |0\\rangle = 2\\epsilon |2\\rangle\n$$\nThe action of the pairing part $H_p = -G(P_+^\\dagger P_+ + P_-^\\dagger P_- + P_+^\\dagger P_- + P_-^\\dagger P_+)$ requires evaluating matrix elements $\\langle i | H_p | j \\rangle$. For $\\Omega=1$, the SU(2) algebra of pairing operators provides the commutation relation $[P_j, P_l^\\dagger] = \\delta_{jl}(1-N_j)$.\nLet's use the explicit rule for acting on seniority-zero states. The pairing term $P_j^\\dagger P_l$ connects states differing by one pair.\n$\\langle i|H|j \\rangle = \\langle 0 | P_i H P_j^\\dagger | 0 \\rangle$.\n$H_{11} = \\langle 1 | H | 1 \\rangle = \\langle 0 | P_- H P_-^\\dagger | 0 \\rangle = \\langle 0 | P_- (-2\\epsilon P_-^\\dagger) |0\\rangle - G \\sum_{k,l} \\langle 0 | P_- P_k^\\dagger P_l P_-^\\dagger |0\\rangle$.\n$H_{11} = -2\\epsilon \\langle 0 | P_- P_-^\\dagger |0 \\rangle - G \\langle 0| P_- P_-^\\dagger P_- P_-^\\dagger |0\\rangle - G \\langle 0| P_- P_+^\\dagger P_- P_-^\\dagger |0\\rangle$.\nUsing $\\langle 0 | P_i P_j^\\dagger |0 \\rangle = \\delta_{ij}$, $H_{11} = -2\\epsilon - G$.\n$H_{22} = \\langle 2 | H | 2 \\rangle = 2\\epsilon - G \\langle 2 | P_+^\\dagger P_+ | 2 \\rangle = 2\\epsilon - G$.\n$H_{12} = \\langle 1 | H | 2 \\rangle = \\langle 0 | P_- H P_+^\\dagger | 0 \\rangle$. The single-particle part is diagonal, so it does not contribute.\n$H_{12} = -G \\sum_{k,l} \\langle 0 | P_- P_k^\\dagger P_l P_+^\\dagger |0\\rangle = -G \\langle 0| P_- P_-^\\dagger P_+ P_+^\\dagger|0\\rangle = -G$.\nBy hermiticity, $H_{21} = H_{12}^* = -G$.\nThe Hamiltonian matrix is:\n$$\n\\mathbf{H} = \\begin{pmatrix} -2\\epsilon - G & -G \\\\ -G & 2\\epsilon - G \\end{pmatrix}\n$$\nThe eigenvalues $E$ are found from $\\det(\\mathbf{H} - E\\mathbf{I}) = 0$:\n$$\n(-2\\epsilon - G - E)(2\\epsilon - G - E) - G^2 = 0 \\\\\n(-(G+E) - 2\\epsilon)(-(G+E) + 2\\epsilon) - G^2 = 0 \\\\\n(G+E)^2 - (2\\epsilon)^2 - G^2 = 0 \\\\\n(G+E)^2 = 4\\epsilon^2 + G^2 \\\\\nG+E = \\pm\\sqrt{4\\epsilon^2 + G^2} \\implies E = -G \\pm \\sqrt{4\\epsilon^2 + G^2}\n$$\nThe exact ground-state energy is the lower eigenvalue:\n$$\nE_{\\text{exact}} = -G - \\sqrt{4\\epsilon^2 + G^2}\n$$\n\nNow, we calculate the fractional error $\\delta$ for $\\epsilon = 0.50 \\text{ MeV}$, $G = 0.60 \\text{ MeV}$, and $\\Omega = 1$.\n\nBCS energy:\n$$\nE_{\\text{BCS}} = -\\frac{\\epsilon^2}{G} - G\\Omega^2 = -\\frac{(0.50)^2}{0.60} - (0.60)(1)^2 = -\\frac{0.25}{0.60} - 0.60 = -\\frac{5}{12} - 0.60 \\approx -0.416667 - 0.60 = -1.016667 \\text{ MeV}\n$$\nExact energy:\n$$\nE_{\\text{exact}} = -0.60 - \\sqrt{4(0.50)^2 + (0.60)^2} = -0.60 - \\sqrt{4(0.25) + 0.36} = -0.60 - \\sqrt{1.00 + 0.36} = -0.60 - \\sqrt{1.36}\n$$\n$$\nE_{\\text{exact}} \\approx -0.60 - 1.166190 = -1.766190 \\text{ MeV}\n$$\nThe fractional error $\\delta$:\n$$\n\\delta = \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|} = \\frac{-1.016667 - (-1.766190)}{|-1.766190|} = \\frac{0.749523}{1.766190} \\approx 0.424360\n$$\nRounding to four significant figures, we get $\\delta = 0.4244$.",
            "answer": "$$\n\\boxed{0.4244}\n$$"
        },
        {
            "introduction": "Moving from analytical theory to computational practice is a key step in modern nuclear physics. This hands-on coding exercise demonstrates how the BCS model explains a fundamental feature of the nuclear landscape: the suppression of pairing at shell closures, which correspond to the \"magic numbers\" of exceptional stability . You will implement a BCS solver to show that a large energy gap between shells quenches pairing, and then quantify how this correlation can be restored, thus connecting the abstract BCS equations to tangible concepts in nuclear structure.",
            "id": "3594147",
            "problem": "You are tasked with writing a complete, runnable program that demonstrates suppression of pairing correlations at a closed (magic) shell in a nuclear two-shell model using the Bardeen-Cooper-Schrieffer (BCS) framework and quantifies how a small increase in the constant pairing strength or inclusion of cross-shell coupling restores a nonzero pairing gap. The physical content must be implemented in a mathematically explicit and unit-consistent way so that the logic alone suffices to produce correct numerical outputs.\n\nAssume a reduced Bardeen-Cooper-Schrieffer (BCS) Hamiltonian with a constant pairing interaction of magnitude $G$ that scatters time-reversed pairs among single-particle levels. Consider a two-shell model with single-particle energies $\\{\\epsilon_k\\}$ measured in megaelectronvolts (MeV), pair-degeneracies $\\{\\Omega_k\\}$ (the number of distinct time-reversed pairs in level $k$), and a total particle number $N$. At zero temperature, the BCS equations are\n$$\n\\Delta = G \\sum_{k} \\Omega_k u_k v_k,\n$$\n$$\nN = 2 \\sum_{k} \\Omega_k v_k^2,\n$$\nwith\n$$\nu_k^2 = \\tfrac{1}{2}\\left(1 + \\frac{\\epsilon_k - \\mu}{E_k}\\right), \\quad\nv_k^2 = \\tfrac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right), \\quad\nE_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2},\n$$\nwhere $\\Delta$ is the pairing gap and $\\mu$ is the chemical potential. For a constant interaction, one can eliminate the explicit $u_k v_k$ factors and write the gap equation in the standard form\n$$\n1 = G \\sum_{k} \\frac{\\Omega_k}{2 E_k}.\n$$\nFor a closed (magic) shell in a two-shell model with a large major shell gap, if only the lower shell is included (no cross-shell matrix elements), the lower shell is completely filled and the upper shell is absent from the pairing space; in that case, no scattering of pairs across the shell gap is possible and the only self-consistent solution is $\\Delta = 0$.\n\nBy contrast, when both the lower and upper shells are included in the pairing space (cross-shell matrix elements are included), a nontrivial solution $\\Delta \\neq 0$ appears only if the pairing strength exceeds a critical value determined by the linearized gap equation at $\\Delta \\to 0$. For a two-level model with energies $\\epsilon_L = -E_{\\text{gap}}/2$ and $\\epsilon_U = +E_{\\text{gap}}/2$ and pair-degeneracies $\\Omega_L$ and $\\Omega_U$, at the magic number $N = 2 \\Omega_L$ the chemical potential $\\mu$ lies in the gap at $\\Delta = 0$, and the critical coupling is\n$$\nG_c = \\frac{E_{\\text{gap}}}{\\Omega_L + \\Omega_U}.\n$$\nFor $G \\le G_c$ the only solution is $\\Delta = 0$; for $G > G_c$ a finite $\\Delta$ emerges from the self-consistent solution of the coupled equations for $\\Delta$ and $\\mu$.\n\nYour program must:\n- Implement the zero-temperature Bardeen-Cooper-Schrieffer (BCS) equations above in a two-shell model and solve for $\\Delta$ and $\\mu$ self-consistently when the nontrivial solution exists.\n- Detect suppression of pairing at a magic number with a large shell gap when the upper shell is excluded (no cross-shell coupling).\n- Quantify restoration of a nonzero $\\Delta$ under two distinct changes: (i) inclusion of cross-shell matrix elements at fixed $G$, and (ii) a small increase of $G$ across the critical threshold when cross-shell coupling is included.\n- Use the units megaelectronvolts (MeV) consistently and report the pairing gap in MeV.\n\nNumerical method requirements:\n- When both shells are included, you must determine whether a nontrivial solution exists by analyzing the linearized gap equation at $\\Delta \\to 0$. For the two-shell case described above, use the mid-gap chemical potential $\\mu = 0$ to evaluate the linearized criterion. If $G \\le G_c$, return $\\Delta = 0$. If $G > G_c$, solve the coupled equations numerically for $\\Delta$ and $\\mu$.\n- When only the lower shell is included (no cross-shell coupling) at the magic particle number, return $\\Delta = 0$ without attempting a numerical solution.\n- For a nontrivial solution, solve the coupled equations for $\\Delta$ and $\\mu$ by any robust numerical method suitable for nonlinear systems. The final reported $\\Delta$ must be accurate to within $10^{-6}$ MeV.\n\nTest suite:\nUse the following four test cases. In every case, the energies are measured in MeV and the output must be the pairing gap $\\Delta$ in MeV. The particle number is set to the magic value corresponding to a completely filled lower shell.\n\n- Test case A (suppression at magic number without cross-shell coupling):\n  - Lower shell only: $\\{\\epsilon_L\\} = \\{-2.0\\}$, $\\{\\Omega_L\\} = \\{8\\}$.\n  - Upper shell excluded.\n  - Major shell gap parameter for reference: $E_{\\text{gap}} = 4.0$.\n  - Particle number: $N = 2 \\Omega_L = 16$.\n  - Pairing strength: $G = 0.18$.\n  - Expected behavior: $\\Delta = 0$.\n\n- Test case B (restoration by including cross-shell coupling at fixed $G$):\n  - Both shells included: $\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$, so $E_{\\text{gap}} = 4.0$.\n  - Particle number: $N = 16$.\n  - Pairing strength: $G = 0.18$.\n  - Expected behavior: $G > G_c = E_{\\text{gap}}/(\\Omega_L+\\Omega_U) = 4.0/(8+16) = 0.166\\overline{6}$, so $\\Delta > 0$.\n\n- Test case C (below-threshold $G$ with cross-shell coupling):\n  - Both shells included: $\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$.\n  - Particle number: $N = 16$.\n  - Pairing strength: $G = 0.16$.\n  - Expected behavior: $G  G_c$, so $\\Delta = 0$.\n\n- Test case D (small increase of $G$ across threshold with cross-shell coupling):\n  - Both shells included: $\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$.\n  - Particle number: $N = 16$.\n  - Pairing strength: $G = 0.17$.\n  - Expected behavior: $G > G_c$ by a small margin, so $\\Delta > 0$ but small.\n\nFinal output requirements:\n- For each test case, compute the pairing gap $\\Delta$ in MeV.\n- Express each $\\Delta$ as a float rounded to exactly six decimal places (MeV).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [A, B, C, D]. For example, a valid output format is\n\"[0.000000,0.123456,0.000000,0.012345]\".",
            "solution": "The problem requires the implementation and solution of the zero-temperature Bardeen-Cooper-Schrieffer (BCS) equations for a two-shell nuclear model to demonstrate and quantify pairing correlations. We must solve for the pairing gap $\\Delta$ and the chemical potential $\\mu$ under different physical conditions.\n\nThe fundamental equations governing the system are the BCS gap equation and the number conservation equation. For a set of single-particle levels indexed by $k$, with energies $\\epsilon_k$ and pair-degeneracies $\\Omega_k$ (i.e., the number of pairs that can occupy the level), the equations are:\n$$\n\\frac{1}{G} = \\sum_{k} \\frac{\\Omega_k}{2 E_k} \\quad (\\text{for } \\Delta \\neq 0)\n$$\n$$\nN = \\sum_{k} \\Omega_k \\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right)\n$$\nwhere $G$ is the constant pairing strength, $N$ is the total number of particles, $\\mu$ is the chemical potential, and $E_k$ is the quasiparticle energy for level $k$:\n$$\nE_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}\n$$\nThe variables to be solved for are the pairing gap $\\Delta$ and the chemical potential $\\mu$. The pairing gap $\\Delta$ is, by convention, a non-negative quantity.\n\nThe problem specifies four test cases which fall into distinct physical scenarios. We will analyze each scenario based on the provided model parameters.\n\n**Scenario 1: Single Filled Shell (Test Case A)**\nThis case involves a single shell, designated as the lower shell ($L$), with energy $\\epsilon_L = -2.0$ MeV and pair-degeneracy $\\Omega_L = 8$. The particle number is $N = 16$. This number corresponds exactly to filling the shell, since $N = 2 \\Omega_L = 2 \\times 8 = 16$. The upper shell is explicitly excluded from the model space.\n\nIn the BCS model, pairing arises from the scattering of pairs of particles between different single-particle levels. When only one shell is present and it is completely filled, there are no available empty states for pairs to scatter into, and no pairs from other levels to scatter from. This situation is known as \"blocking\". The pairing interaction is rendered ineffective, and no pairing correlation can be established. The only self-consistent solution to the BCS equations in this configuration is a trivial one, where the pairing gap is zero.\nTherefore, for Test Case A, we conclude $\\Delta = 0$ MeV without the need for a numerical calculation.\n\n**Scenario 2: Two-Shell Model at Magic Number (Test Cases B, C, D)**\nThese cases involve a two-shell model with a lower shell ($L$) and an upper shell ($U$). The parameters are:\n-   Energies: $\\epsilon_L = -2.0$ MeV, $\\epsilon_U = +2.0$ MeV. The major shell gap is $E_{\\text{gap}} = \\epsilon_U - \\epsilon_L = 4.0$ MeV.\n-   Degeneracies: $\\Omega_L = 8$, $\\Omega_U = 16$.\n-   Particle Number: $N = 16 = 2 \\Omega_L$. This is a \"magic\" number corresponding to a filled lower shell.\n\nIn this scenario, even though the lower shell is filled, the presence of the empty upper shell provides states into which pairs can scatter. A non-trivial pairing solution ($\\Delta  0$) can exist if the pairing strength $G$ is sufficiently large to overcome the energy cost of promoting pairs across the shell gap $E_{\\text{gap}}$.\n\nThe transition from a trivial solution ($\\Delta = 0$) to a non-trivial one ($\\Delta  0$) occurs at a critical pairing strength, $G_c$. To find $G_c$, we analyze the gap equation in the limit $\\Delta \\to 0$. In this limit, the equation becomes:\n$$\n\\frac{1}{G} = \\sum_{k} \\frac{\\Omega_k}{2 |\\epsilon_k - \\mu|}\n$$\nFor the specific particle number $N = 2 \\Omega_L$ in a symmetric two-level model ($\\epsilon_L = -\\epsilon_U$), the chemical potential at the onset of pairing lies exactly in the middle of the gap, i.e., $\\mu = 0$. Substituting the parameters for the two-shell model:\n$$\n\\frac{1}{G_c} = \\frac{\\Omega_L}{2 |\\epsilon_L - 0|} + \\frac{\\Omega_U}{2 |\\epsilon_U - 0|} = \\frac{\\Omega_L}{2 (\\frac{E_{\\text{gap}}}{2})} + \\frac{\\Omega_U}{2 (\\frac{E_{\\text{gap}}}{2})} = \\frac{\\Omega_L + \\Omega_U}{E_{\\text{gap}}}\n$$\nThis gives the critical coupling:\n$$\nG_c = \\frac{E_{\\text{gap}}}{\\Omega_L + \\Omega_U}\n$$\nFor our specific parameters, $E_{\\text{gap}} = 4.0$ MeV, $\\Omega_L = 8$, and $\\Omega_U = 16$, the critical strength is:\n$$\nG_c = \\frac{4.0}{8 + 16} = \\frac{4.0}{24} = \\frac{1}{6} \\approx 0.166667 \\text{ MeV}\n$$\nThe formal condition is:\n-   If $G \\le G_c$, the only solution is the trivial one, $\\Delta = 0$.\n-   If $G  G_c$, a non-trivial solution with $\\Delta  0$ exists and must be found by solving the coupled BCS equations numerically.\n\nWe now apply this criterion to the remaining test cases.\n\n**Test Case C:** $G = 0.16$ MeV.\nSince $0.16  1/6$, the pairing strength is sub-critical. Thus, $\\Delta = 0$ MeV.\n\n**Test Cases B and D:** $G = 0.18$ MeV and $G = 0.17$ MeV, respectively.\nIn both cases, the pairing strength $G$ is greater than $G_c \\approx 0.166667$ MeV. Therefore, a non-trivial solution with $\\Delta  0$ exists. To find it, we must solve the following system of two non-linear equations for the two unknowns, $\\Delta$ and $\\mu$:\n$$\nf_1(\\Delta, \\mu) = \\frac{1}{G} - \\frac{\\Omega_L}{2 \\sqrt{(\\epsilon_L - \\mu)^2 + \\Delta^2}} - \\frac{\\Omega_U}{2 \\sqrt{(\\epsilon_U - \\mu)^2 + \\Delta^2}} = 0\n$$\n$$\nf_2(\\Delta, \\mu) = N - \\Omega_L \\left(1 - \\frac{\\epsilon_L - \\mu}{\\sqrt{(\\epsilon_L - \\mu)^2 + \\Delta^2}}\\right) - \\Omega_U \\left(1 - \\frac{\\epsilon_U - \\mu}{\\sqrt{(\\epsilon_U - \\mu)^2 + \\Delta^2}}\\right) = 0\n$$\nThis system is solved using a numerical root-finding algorithm, such as `scipy.optimize.root` in Python. An appropriate initial guess for the solver is essential. Since we are near the critical point, we expect $\\Delta$ to be small and $\\mu$ to be close to $0$. A reasonable initial guess is $(\\Delta_0, \\mu_0) = (0.1, 0.0)$. The solver iteratively refines this guess until the residuals $f_1$ and $f_2$ are simultaneously close to zero, meeting the specified tolerance of $10^{-6}$ MeV for the final $\\Delta$.\n\n**Summary of Approach per Case:**\n-   **Case A**: One filled shell, no upper shell. Pairing is blocked. Result: $\\Delta = 0.0$.\n-   **Case B**: Two shells, $G=0.18  G_c$. A non-trivial pairing gap $\\Delta  0$ forms. Result: Solve numerically.\n-   **Case C**: Two shells, $G=0.16  G_c$. Pairing is sub-critical. Result: $\\Delta = 0.0$.\n-   **Case D**: Two shells, $G=0.17  G_c$. Pairing is just super-critical, forming a small but non-zero gap $\\Delta  0$. Result: Solve numerically.\n\nThe implementation will follow this logic precisely, using `scipy.optimize.root` for the numerical solutions required in Cases B and D.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves the BCS equations for four test cases representing pairing suppression\n    and restoration in a nuclear two-shell model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Lower shell only, magic number\n        {\n            \"name\": \"A\",\n            \"shells\": {\"eps\": np.array([-2.0]), \"omg\": np.array([8])},\n            \"N\": 16,\n            \"G\": 0.18,\n            \"type\": \"one_shell_magic\"\n        },\n        # Case B: Both shells, G  Gc\n        {\n            \"name\": \"B\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.18,\n            \"type\": \"two_shell\"\n        },\n        # Case C: Both shells, G  Gc\n        {\n            \"name\": \"C\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.16,\n            \"type\": \"two_shell\"\n        },\n        # Case D: Both shells, G slightly  Gc\n        {\n            \"name\": \"D\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.17,\n            \"type\": \"two_shell\"\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        delta_val = 0.0\n        \n        if case[\"type\"] == \"one_shell_magic\":\n            # For a single, completely filled shell, pairing is blocked.\n            # The particle number N = 16 equals 2 * Omega_L = 2 * 8.\n            # The only solution is the trivial one.\n            delta_val = 0.0\n        \n        elif case[\"type\"] == \"two_shell\":\n            eps = case[\"shells\"][\"eps\"]\n            omg = case[\"shells\"][\"omg\"]\n            G = case[\"G\"]\n            N = case[\"N\"]\n            \n            # For a two-shell model at the magic number N=2*Omega_L, a non-trivial\n            # solution exists only if G  Gc.\n            E_gap = eps[1] - eps[0]\n            G_c = E_gap / np.sum(omg)\n            \n            if G = G_c:\n                # Pairing strength is sub-critical.\n                delta_val = 0.0\n            else:\n                # Pairing strength is super-critical. Solve the coupled equations.\n                \n                def bcs_system(variables, G_val, eps_vals, omg_vals, N_val):\n                    \"\"\"\n                    Defines the system of coupled BCS equations to be solved.\n                    variables = [Delta, mu]\n                    \"\"\"\n                    delta, mu = variables[0], variables[1]\n                    \n                    # Ensure Delta is positive, as it appears squared.\n                    # The solver might take a negative step, but the physical gap is positive.\n                    # Also handles the case where delta is ~0 to avoid division by zero.\n                    if np.isclose(delta, 0.0):\n                        delta = 1e-12 \n\n                    # Quasiparticle energies\n                    E_k = np.sqrt((eps_vals - mu)**2 + delta**2)\n                    \n                    # Gap equation residual\n                    # 1/G = sum(Omega_k / (2*E_k))\n                    gap_eq_residual = 1.0/G_val - np.sum(omg_vals / (2.0 * E_k))\n                    \n                    # Number equation residual\n                    # N = sum(Omega_k * (1 - (eps_k-mu)/E_k))\n                    num_eq_residual = N_val - np.sum(omg_vals * (1.0 - (eps_vals - mu) / E_k))\n                    \n                    return [gap_eq_residual, num_eq_residual]\n\n                # Initial guess [Delta, mu]. Near the critical point, Delta is small\n                # and mu is close to the mid-gap value (0).\n                initial_guess = [0.1, 0.0]\n                \n                # Solve the system of non-linear equations\n                solution = root(\n                    bcs_system, \n                    initial_guess, \n                    args=(G, eps, omg, N),\n                    method='hybr',  # A robust method for such problems\n                    tol=1e-9       # Tolerance for high accuracy\n                )\n                \n                if solution.success:\n                    # The pairing gap Delta is conventionally taken as positive.\n                    delta_val = abs(solution.x[0])\n                else:\n                    # This should not happen for the given well-posed problems.\n                    # As a fallback, report a negative value to indicate solver failure.\n                    delta_val = -1.0 \n\n        results.append(delta_val)\n\n    # Format the results to exactly six decimal places and print in the specified format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}