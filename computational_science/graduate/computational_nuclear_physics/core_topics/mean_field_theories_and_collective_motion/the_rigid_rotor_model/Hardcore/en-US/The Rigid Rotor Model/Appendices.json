{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will derive the foundational properties of the simplest quantum rigid rotor from first principles. This exercise bridges the gap between the classical picture of a rotating body and its quantum mechanical description, revealing the origin of the characteristic $E \\propto I(I+1)$ energy spectrum observed in the rotational bands of many nuclei. By working through this derivation, you will solidify your understanding of how quantizing angular momentum leads directly to the discrete energy levels and degeneracies that define collective rotation .",
            "id": "3606597",
            "problem": "A spherical even-even nucleus can be modeled as a quantum rigid rotor whose orientation is described by rotations in the Special Orthogonal group in three dimensions ($\\mathrm{SO}(3)$). The classical kinetic energy of a rigid rotor with angular velocity vector $\\boldsymbol{\\omega}$ and inertia tensor $\\mathbf{I}$ is given by $T=\\frac{1}{2}\\,\\boldsymbol{\\omega}\\cdot\\mathbf{I}\\cdot\\boldsymbol{\\omega}$. For a spherical rotor, the inertia tensor is isotropic and can be written as $\\mathbf{I}=\\mathcal{I}\\,\\mathbf{1}$ with a single moment of inertia parameter $\\mathcal{I}$. The canonical angular momentum is $\\mathbf{L}=\\mathbf{I}\\cdot\\boldsymbol{\\omega}$, and the Hamiltonian is the total energy of the system in the absence of potential energy.\n\nStarting from these fundamental relations and using canonical quantization of angular momentum with the commutation relations $[\\hat{L}_{i},\\hat{L}_{j}]=\\mathrm{i}\\hbar\\,\\epsilon_{ijk}\\hat{L}_{k}$ of the Special Unitary group of degree two ($\\mathrm{SU(2)}$) algebra, derive the quantum Hamiltonian for a spherical rotor and obtain its energy spectrum as a function of the total angular momentum quantum number $I$ and the moment of inertia $\\mathcal{I}$. The physical configuration space of the rotor is $\\mathrm{SO(3)}$, so require the rotor wavefunctions to be single-valued under $2\\pi$ rotations.\n\nThen, verify the degeneracy of each energy level with respect to the magnetic quantum number $M$ by explicitly counting the distinct, normalized eigenstates corresponding to different $M$ values. Your counting should be based on the simultaneous eigenbasis of $\\hat{\\mathbf{L}}^{2}$ and $\\hat{L}_{z}$ and the single-valuedness condition on the corresponding angular wavefunctions.\n\nProvide your final answer as a two-entry row matrix, with the first entry the energy $E_{I}$ and the second entry the degeneracy $g_{I}$, both expressed in closed-form as functions of $I$ and $\\mathcal{I}$. Express the energy in joules. No numerical evaluation is required, and no rounding is needed.",
            "solution": "The problem asks for the energy spectrum and degeneracy of a quantum rigid rotor, which models a spherical even-even nucleus. The derivation begins with the classical expression for the kinetic energy and proceeds through canonical quantization.\n\nThe classical kinetic energy $T$ of a rigid rotor is given by the expression:\n$$T=\\frac{1}{2}\\,\\boldsymbol{\\omega}\\cdot\\mathbf{I}\\cdot\\boldsymbol{\\omega}$$\nwhere $\\boldsymbol{\\omega}$ is the angular velocity vector and $\\mathbf{I}$ is the inertia tensor. For a spherical rotor, the inertia tensor is isotropic, meaning it is proportional to the identity tensor $\\mathbf{1}$. It can be written as $\\mathbf{I}=\\mathcal{I}\\,\\mathbf{1}$, where $\\mathcal{I}$ is the scalar moment of inertia. Substituting this into the energy expression gives:\n$$T = \\frac{1}{2}\\,\\boldsymbol{\\omega}\\cdot(\\mathcal{I}\\,\\mathbf{1})\\cdot\\boldsymbol{\\omega} = \\frac{1}{2}\\mathcal{I}\\,(\\boldsymbol{\\omega}\\cdot\\boldsymbol{\\omega}) = \\frac{1}{2}\\mathcal{I}\\omega^2$$\nThe canonical angular momentum $\\mathbf{L}$ is related to the angular velocity by:\n$$\\mathbf{L} = \\mathbf{I}\\cdot\\boldsymbol{\\omega} = (\\mathcal{I}\\,\\mathbf{1})\\cdot\\boldsymbol{\\omega} = \\mathcal{I}\\boldsymbol{\\omega}$$\nFrom this relation, we can express the angular velocity in terms of the angular momentum:\n$$\\boldsymbol{\\omega} = \\frac{\\mathbf{L}}{\\mathcal{I}}$$\nThe Hamiltonian $H$ of the system is its total energy. As the problem specifies no potential energy, the Hamiltonian is equal to the kinetic energy, $H=T$. We can express the Hamiltonian in terms of the angular momentum by substituting the expression for $\\boldsymbol{\\omega}$:\n$$H = T = \\frac{1}{2}\\mathcal{I}\\omega^2 = \\frac{1}{2}\\mathcal{I}\\left|\\frac{\\mathbf{L}}{\\mathcal{I}}\\right|^2 = \\frac{1}{2}\\mathcal{I}\\frac{L^2}{\\mathcal{I}^2} = \\frac{L^2}{2\\mathcal{I}}$$\nTo obtain the quantum Hamiltonian, we use canonical quantization, which involves promoting classical observables to their corresponding quantum operators. The classical quantity $L^2$, the squared magnitude of the angular momentum vector, is replaced by the quantum operator $\\hat{\\mathbf{L}}^2 = \\hat{L}_x^2 + \\hat{L}_y^2 + \\hat{L}_z^2$. The operators $\\hat{L}_i$ satisfy the $\\mathrm{SU}(2)$ Lie algebra commutation relations $[\\hat{L}_{i},\\hat{L}_{j}]=\\mathrm{i}\\hbar\\,\\epsilon_{ijk}\\hat{L}_{k}$, as given in the problem statement. The quantum Hamiltonian operator $\\hat{H}$ is therefore:\n$$\\hat{H} = \\frac{\\hat{\\mathbf{L}}^2}{2\\mathcal{I}}$$\nThe energy spectrum of the rotor is found by determining the eigenvalues of the Hamiltonian operator $\\hat{H}$. This is accomplished by solving the time-independent Schrödinger equation:\n$$\\hat{H}|\\psi\\rangle = E|\\psi\\rangle$$\nThe eigenstates $|\\psi\\rangle$ of the Hamiltonian are the simultaneous eigenstates of the commuting operators $\\hat{\\mathbf{L}}^2$ and $\\hat{L}_z$. These states are denoted by $|I, M\\rangle$, where $I$ is the total angular momentum quantum number and $M$ is the magnetic quantum number. The action of the $\\hat{\\mathbf{L}}^2$ operator on these states is a standard result from the quantum theory of angular momentum:\n$$\\hat{\\mathbf{L}}^2 |I, M\\rangle = \\hbar^2 I(I+1) |I, M\\rangle$$\nSubstituting this into the Schrödinger equation yields:\n$$\\hat{H}|I, M\\rangle = \\frac{\\hat{\\mathbf{L}}^2}{2\\mathcal{I}} |I, M\\rangle = \\frac{\\hbar^2 I(I+1)}{2\\mathcal{I}} |I, M\\rangle$$\nBy comparing this with $\\hat{H}|I, M\\rangle = E_I |I, M\\rangle$, we identify the energy eigenvalues $E_I$ as:\n$$E_I = \\frac{\\hbar^2 I(I+1)}{2\\mathcal{I}}$$\nThe energy $E_I$ depends only on the quantum number $I$, not on $M$. The problem specifies that the physical configuration space is $\\mathrm{SO}(3)$, which requires the wavefunctions to be single-valued under a rotation of $2\\pi$. In the position representation, the eigenstates are proportional to the spherical harmonics, $\\psi_{I,M}(\\theta, \\phi) \\propto Y_{I,M}(\\theta, \\phi)$. A rotation by an angle of $2\\pi$ about any axis must leave the wavefunction unchanged. For a rotation of angle $\\alpha$ about the $z$-axis, the wavefunction transforms as $\\psi_{I,M}(\\theta, \\phi - \\alpha) = \\exp(-i M \\alpha) \\psi_{I,M}(\\theta, \\phi)$. For a $2\\pi$ rotation, $\\alpha=2\\pi$, single-valuedness requires $\\exp(-i M 2\\pi) = 1$. This implies that the magnetic quantum number $M$ must be an integer. Since the standard theory of angular momentum requires that $M$ takes values from $-I$ to $I$ in integer steps, the requirement that $M$ is an integer forces $I$ to also be an integer: $I = 0, 1, 2, \\dots$. For the specific physical system of a spherical even-even nucleus, additional symmetry considerations require the ground-state rotational band to consist of states with positive parity, which restricts the allowed angular momenta to even integer values, $I = 0, 2, 4, \\dots$. The formula for $E_I$, however, is general for any allowed integer $I$.\n\nNext, we verify the degeneracy $g_I$ of each energy level. The energy $E_I$ is determined solely by the quantum number $I$. For a fixed value of $I$, the magnetic quantum number $M$ can take any integer value in the range:\n$$M \\in \\{-I, -I+1, \\dots, I-1, I\\}$$\nEach of these values of $M$ corresponds to a distinct, normalized, and orthogonal quantum state $|I, M\\rangle$. The total number of such states for a given $I$ is the degeneracy of the energy level $E_I$. The number of values $M$ can assume is:\n$$g_I = (I - (-I)) + 1 = 2I + 1$$\nTherefore, each energy level $E_I$ is $(2I+1)$-fold degenerate.\n\nThe final answer requires the energy $E_I$ and the degeneracy $g_I$, both expressed as functions of $I$ and $\\mathcal{I}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\hbar^2 I(I+1)}{2\\mathcal{I}} & 2I+1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While the rigid rotor model provides an elegant description of collective rotation, real nuclei are composed of a finite number of fermions. This practice delves into the crucial interplay between the collective rotor picture and the underlying microscopic shell model structure . You will investigate the phenomenon of \"band termination,\" where a rotational band abruptly ends because the valence nucleons have reached their maximum possible alignment, a powerful demonstration of the limits of the purely collective model.",
            "id": "3606646",
            "problem": "You are given a finite configuration space consisting of identical fermions confined to a single-$j$ shell in a nuclear mean field. Each single-particle state in this shell has a magnetic quantum number $m \\in \\{-j, -j+1, \\ldots, j-1, j\\}$, with degeneracy $2j+1$. By the Pauli exclusion principle, at most one fermion occupies each $m$-state. The rigid rotor model predicts rotational energies $E(L)$ that depend on total angular momentum $L$ via $E(L) = \\hbar^2 L(L+1) / (2 \\mathcal{I})$. In this computational task, use natural units where $\\hbar = 1$, so $E(L) = L(L+1)/(2 \\mathcal{I})$, with $\\mathcal{I}$ the moment of inertia. All energies must be expressed in $\\mathrm{MeV}$ and all angular momenta in units of $\\hbar$. Your answers must be rounded to $6$ decimal places.\n\nStarting from first principles of angular momentum coupling and the Pauli exclusion principle, adopt the following bases:\n- The maximum total angular momentum $L_{\\max}$ accessible within a fixed configuration of $n$ identical fermions in a single-$j$ shell occurs for the highest-weight state where the $n$ largest $m$-values are occupied. This implies the occupied set at full alignment is $\\{ j, j-1, \\ldots, j-(n-1)\\}$ whenever $n \\le 2j+1$. The maximum projection is $M_{\\max} = \\sum_{k=0}^{n-1} (j-k)$ and by construction equals the maximum total angular momentum $L_{\\max}$ available within this configuration space.\n- The rigid rotor energy formula $E(L) = L(L+1)/(2 \\mathcal{I})$ applies, where $\\mathcal{I}$ is given in $\\mathrm{MeV}^{-1}$ and $E(L)$ is in $\\mathrm{MeV}$.\n- Consecutive rotor spacings obey $E(L)-E(L-1) = L/\\mathcal{I}$ and $E(L+1)-E(L) = (L+1)/\\mathcal{I}$, valid for $L \\ge 0$.\n\nYour program must, for each test case, compute the following quantities:\n1. The maximum angular momentum $L_{\\max}$ for $n$ identical fermions in a single-$j$ shell, obtained from the highest-weight construction by occupying the $n$ largest $m$-values. Explicitly, $L_{\\max} = \\sum_{k=0}^{n-1} (j-k) = n j - \\frac{n(n-1)}{2}$.\n2. The rotor energy at termination $E(L_{\\max}) = L_{\\max}(L_{\\max}+1)/(2 \\mathcal{I})$ in $\\mathrm{MeV}$.\n3. The rotor energy spacings immediately below and above $L_{\\max}$, namely $\\Delta_{-} = E(L_{\\max}) - E(L_{\\max}-1) = L_{\\max}/\\mathcal{I}$ for $L_{\\max} \\ge 1$ (set $\\Delta_{-} = 0$ if $L_{\\max} = 0$), and $\\Delta_{+} = E(L_{\\max}+1) - E(L_{\\max}) = (L_{\\max}+1)/\\mathcal{I}$.\n4. Given a rotor energy budget $E_{\\mathrm{budget}}$ in $\\mathrm{MeV}$, the largest rotor angular momentum $L_{\\mathrm{rot}}^{\\mathrm{budget}}$ satisfying $E(L) \\le E_{\\mathrm{budget}}$ with the same quantization parity as the configuration. The parity of allowed $L$ is determined by $n$: if $n$ is even, allowed $L$ are integers; if $n$ is odd, allowed $L$ are half-integers. The program must find $L_{\\mathrm{rot}}^{\\mathrm{budget}}$ consistent with this parity constraint.\n5. A boolean indicator $\\mathrm{terminated}$ that is $\\mathrm{True}$ if $L_{\\mathrm{rot}}^{\\mathrm{budget}} > L_{\\max}$ (meaning the rigid rotor, within the energy budget, would predict angular momenta higher than the configuration space allows, hence a band termination is implied within the given budget), and $\\mathrm{False}$ otherwise.\n6. The occupied $m$-set at termination (the alignment pattern), namely the list $[j, j-1, \\ldots, j-(n-1)]$.\n\nFor numerical units:\n- Treat $\\mathcal{I}$ in $\\mathrm{MeV}^{-1}$.\n- Report $E(L_{\\max})$, $\\Delta_{-}$, and $\\Delta_{+}$ in $\\mathrm{MeV}$, rounded to $6$ decimal places.\n- Report $L_{\\max}$ and $L_{\\mathrm{rot}}^{\\mathrm{budget}}$ in units of $\\hbar$, rounded to $6$ decimal places.\n- The list of occupied $m$-values must be reported in units of $\\hbar$ and rounded to $6$ decimal places.\n\nTest suite:\n- Case $1$: $j=\\frac{7}{2}$, $n=4$, $\\mathcal{I}=25\\,\\mathrm{MeV}^{-1}$, $E_{\\mathrm{budget}}=2.0\\,\\mathrm{MeV}$.\n- Case $2$: $j=\\frac{9}{2}$, $n=10$, $\\mathcal{I}=20\\,\\mathrm{MeV}^{-1}$, $E_{\\mathrm{budget}}=0.1\\,\\mathrm{MeV}$.\n- Case $3$: $j=\\frac{11}{2}$, $n=1$, $\\mathcal{I}=30\\,\\mathrm{MeV}^{-1}$, $E_{\\mathrm{budget}}=0.6\\,\\mathrm{MeV}$.\n- Case $4$: $j=\\frac{13}{2}$, $n=7$, $\\mathcal{I}=18\\,\\mathrm{MeV}^{-1}$, $E_{\\mathrm{budget}}=20.0\\,\\mathrm{MeV}$.\n- Case $5$: $j=\\frac{5}{2}$, $n=0$, $\\mathcal{I}=25\\,\\mathrm{MeV}^{-1}$, $E_{\\mathrm{budget}}=0.05\\,\\mathrm{MeV}$.\n\nFinal output format:\n- For each test case, return a list in the order $[L_{\\max}, E(L_{\\max}), \\Delta_{-}, \\Delta_{+}, L_{\\mathrm{rot}}^{\\mathrm{budget}}, \\mathrm{terminated}, \\text{occupied\\_m\\_list}]$.\n- Aggregate all test case results into a single list in the same order as given in the test suite.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[ \\text{case1\\_result}, \\text{case2\\_result}, \\ldots ]$.",
            "solution": "The problem posed is a well-defined computational task grounded in the principles of nuclear structure physics, specifically the interplay between the single-particle shell model and the collective rigid rotor model. The problem is scientifically sound, self-contained, and all parameters and formulas are explicitly provided. The test cases are consistent with the physical constraints, such as the Pauli exclusion principle ($n \\le 2j+1$). Therefore, the problem is valid, and we may proceed with a systematic solution.\n\nThe solution algorithm involves computing six distinct quantities for each test case, which are functions of the single-particle shell angular momentum $j$, the number of identical fermions $n$, the moment of inertia $\\mathcal{I}$, and a specified energy budget $E_{\\mathrm{budget}}$. We will use natural units where $\\hbar=1$.\n\n**1. Maximum Angular Momentum ($L_{\\max}$) and Occupied States**\n\nThe maximum possible projection of the total angular momentum, $M_{\\max}$, is obtained when the $n$ fermions occupy the single-particle states with the largest possible magnetic quantum numbers $m$. According to the Pauli exclusion principle, each fermion must occupy a unique $m$-state. The available $m$-states for a shell $j$ are $m \\in \\{-j, -j+1, \\ldots, j-1, j\\}$. The $n$ largest values are thus $\\{j, j-1, \\ldots, j-(n-1)\\}$.\n\nThe maximum $M$-projection is the sum of these values:\n$$\nM_{\\max} = \\sum_{k=0}^{n-1} (j-k)\n$$\nThis is an arithmetic progression, which can be summed to yield the provided formula:\n$$\nM_{\\max} = n j - \\sum_{k=0}^{n-1} k = n j - \\frac{n(n-1)}{2}\n$$\nIn this highest-weight state, the total angular momentum $L$ is equal to its maximum projection $M$. Thus, $L_{\\max} = M_{\\max}$. If $n=0$, the shell is empty and $L_{\\max} = 0$. The list of occupied $m$-states is simply $[j, j-1, \\ldots, j-(n-1)]$.\n\n**2. Rotor Energy at Termination ($E(L_{\\max})$)**\n\nThe problem defines the energy of a rotational state with angular momentum $L$ using the rigid rotor model:\n$$\nE(L) = \\frac{L(L+1)}{2 \\mathcal{I}}\n$$\nBand termination occurs at $L_{\\max}$, which is the highest angular momentum the configuration of $n$ fermions can support. The energy at this termination point is found by substituting $L=L_{\\max}$ into the formula:\n$$\nE(L_{\\max}) = \\frac{L_{\\max}(L_{\\max}+1)}{2 \\mathcal{I}}\n$$\n\n**3. Energy Spacings ($\\Delta_{-}$ and $\\Delta_{+})$**\n\nThe energy spacings adjacent to the terminating state are defined as $\\Delta_{-} = E(L_{\\max}) - E(L_{\\max}-1)$ and $\\Delta_{+} = E(L_{\\max}+1) - E(L_{\\max})$. Using the energy formula, we can derive the expressions provided in the problem:\n$$\n\\Delta_{-} = \\frac{1}{2\\mathcal{I}} [L_{\\max}(L_{\\max}+1) - (L_{\\max}-1)L_{\\max}] = \\frac{L_{\\max}}{2\\mathcal{I}} [(L_{\\max}+1) - (L_{\\max}-1)] = \\frac{L_{\\max}}{\\mathcal{I}}\n$$\nThis is valid for $L_{\\max} \\ge 1$. If $L_{\\max}=0$, $\\Delta_{-}$ is defined to be $0$.\n$$\n\\Delta_{+} = \\frac{1}{2\\mathcal{I}} [(L_{\\max}+1)(L_{\\max}+2) - L_{\\max}(L_{\\max}+1)] = \\frac{L_{\\max}+1}{2\\mathcal{I}} [(L_{\\max}+2) - L_{\\max}] = \\frac{L_{\\max}+1}{\\mathcal{I}}\n$$\n\n**4. Budgeted Angular Momentum ($L_{\\mathrm{rot}}^{\\mathrm{budget}}$)**\n\nWe are tasked with finding the largest allowed rotor angular momentum, $L_{\\mathrm{rot}}^{\\mathrm{budget}}$, such that its energy $E(L)$ does not exceed $E_{\\mathrm{budget}}$. This translates to the inequality:\n$$\n\\frac{L(L+1)}{2 \\mathcal{I}} \\le E_{\\mathrm{budget}}\n$$\nRearranging this gives a quadratic inequality for $L$:\n$$\nL^2 + L - 2 \\mathcal{I} E_{\\mathrm{budget}} \\le 0\n$$\nThe positive root of the corresponding equality $L^2 + L - 2 \\mathcal{I} E_{\\mathrm{budget}} = 0$ gives the maximum continuous (non-quantized) angular momentum, $L_{\\text{cont}, \\max}$, allowed by the budget:\n$$\nL_{\\text{cont}, \\max} = \\frac{-1 + \\sqrt{1 + 8 \\mathcal{I} E_{\\mathrm{budget}}}}{2}\n$$\nThe value of $L_{\\mathrm{rot}}^{\\mathrm{budget}}$ must be the largest allowed quantized angular momentum $L$ that is less than or equal to $L_{\\text{cont}, \\max}$. The quantization rule depends on the parity of $n$:\n- If $n$ is even, allowed $L$ values are integers ($0, 1, 2, \\ldots$). The largest integer $L \\le L_{\\text{cont}, \\max}$ is $L_{\\mathrm{rot}}^{\\mathrm{budget}} = \\lfloor L_{\\text{cont}, \\max} \\rfloor$.\n- If $n$ is odd, allowed $L$ values are half-integers ($0.5, 1.5, 2.5, \\ldots$). Let $L = k + 0.5$ for $k \\in \\{0, 1, 2, \\ldots\\}$. We need to find the largest $k$ such that $k+0.5 \\le L_{\\text{cont}, \\max}$, which implies $k \\le L_{\\text{cont}, \\max} - 0.5$. The largest integer $k$ is $k_{\\max} = \\lfloor L_{\\text{cont}, \\max} - 0.5 \\rfloor$. The corresponding angular momentum is $L_{\\mathrm{rot}}^{\\mathrm{budget}} = k_{\\max} + 0.5$.\n\n**5. Termination Indicator ($\\mathrm{terminated}$)**\n\nThis boolean indicator signals whether the rigid rotor model, within the given energy budget, predicts the existence of states with angular momentum higher than the microscopic model allows. If the largest angular momentum predicted by the rotor model within the budget, $L_{\\mathrm{rot}}^{\\mathrm{budget}}$, exceeds the maximum angular momentum supported by the fermion configuration, $L_{\\max}$, then termination is implied.\n$$\n\\mathrm{terminated} = (L_{\\mathrm{rot}}^{\\mathrm{budget}} > L_{\\max})\n$$\n\nThese steps are implemented for each test case. All numerical results are rounded to $6$ decimal places.",
            "answer": "[[8.0,1.44,0.32,0.36,9.0,True,[3.5,2.5,1.5,0.5]],[0.0,0.0,0.0,0.05,1.0,True,[4.5,3.5,2.5,1.5,0.5,-0.5,-1.5,-2.5,-3.5,-4.5]],[5.5,0.605,0.183333,0.216667,5.5,False,[5.5]],[24.5,15.659722,1.361111,1.416667,26.5,True,[6.5,5.5,4.5,3.5,2.5,1.5,0.5]],[0.0,0.0,0.0,0.04,1.0,True,[]]]"
        },
        {
            "introduction": "Advanced modeling in nuclear structure physics requires robust computational tools for handling the quantum states of the rotor. This final practice provides a deep dive into the numerical machinery behind the rotor wavefunctions, the Wigner $D$-matrices, which are functions of the Euler angles that orient the nucleus in space . By implementing a numerical quadrature scheme to verify their fundamental orthogonality relation, you will gain essential skills for calculating matrix elements of nuclear interactions and observables in a rotating frame.",
            "id": "3606621",
            "problem": "Consider the rigid rotor model in computational nuclear physics, where body-fixed and space-fixed frames are related by Euler angles. Let the Euler angles be denoted by $\\alpha$, $\\beta$, and $\\gamma$, with the ranges $\\alpha \\in [0,2\\pi)$, $\\beta \\in [0,\\pi]$, and $\\gamma \\in [0,2\\pi)$. Angles must be treated in radians. The rotation group Special Orthogonal group in three dimensions (SO(3)) admits irreducible unitary representations labeled by the total angular momentum $I \\in \\{0,1,2,\\dots\\}$ and magnetic quantum numbers $M$ and $K$ with $-I \\le M,K \\le I$. The Wigner rotation matrix elements are $D^{I}_{MK}(\\alpha,\\beta,\\gamma)$, and the invariant Haar measure on SO(3) in Euler angles is $d\\Omega = \\sin\\beta\\, d\\alpha\\, d\\beta\\, d\\gamma$.\n\nFrom representation theory and rotational symmetry, the functions $D^{I}_{MK}(\\alpha,\\beta,\\gamma)$ are orthogonal over the group manifold with respect to the Haar measure. Your task is to implement a numerical quadrature over the Euler angles to evaluate the integral\n$$\n\\mathcal{I}(I,M,K; I',M',K') \\equiv \\int_{0}^{2\\pi}\\!\\! d\\alpha \\int_{0}^{\\pi}\\!\\! d\\beta \\int_{0}^{2\\pi}\\!\\! d\\gamma \\,\\sin\\beta \\; D^{I*}_{MK}(\\alpha,\\beta,\\gamma)\\, D^{I'}_{M'K'}(\\alpha,\\beta,\\gamma),\n$$\nand then test the accuracy of your numerical evaluation against the analytically exact orthogonality result that follows from the properties of group representations on SO(3).\n\nFundamental base for the derivation and implementation must include:\n- The decomposition $D^{I}_{MK}(\\alpha,\\beta,\\gamma) = e^{-i M \\alpha}\\, d^{I}_{MK}(\\beta)\\, e^{-i K \\gamma})$, where $d^{I}_{MK}(\\beta)$ are the reduced Wigner rotation matrix elements (often called the Wigner small-$d$ functions).\n- The invariant Haar measure $d\\Omega$ on SO(3) in Euler angles.\n- The fact that the orthogonality of irreducible representations on a compact group with respect to the Haar measure yields Kronecker-delta structure in the quantum numbers.\n\nYou must design a fully self-contained numerical algorithm that:\n1. Implements $d^{I}_{MK}(\\beta)$ for integer $I$, $M$, and $K$, using a numerically stable finite-sum representation derived from fundamental angular momentum theory (no external data).\n2. Uses a periodic quadrature over $\\alpha$ and $\\gamma$ that is appropriate for $2\\pi$-periodic complex exponentials.\n3. Uses Gaussian quadrature over $\\beta$ by transforming the $\\beta$-integral with the $\\sin\\beta$ weight into an integral over $x=\\cos\\beta \\in [-1,1]$.\n4. Aggregates the three quadratures to produce a single numerical value $\\mathcal{I}(I,M,K; I',M',K')$.\n\nNumerical units and conventions:\n- Angles must be in radians throughout.\n- The final integral $\\mathcal{I}$ is dimensionless.\n\nTo make the problem testable, use the following test suite of parameter tuples $(I,M,K; I',M',K')$:\n- Test case 1 (general happy path): $(2,\\,1,\\,-1;\\; 2,\\,1,\\,-1)$.\n- Test case 2 (different total angular momentum): $(2,\\,1,\\,-1;\\; 3,\\,1,\\,-1)$.\n- Test case 3 (different space-fixed projection): $(3,\\,0,\\,3;\\; 3,\\,1,\\,3)$.\n- Test case 4 (different body-fixed projection): $(3,\\,3,\\,-3;\\; 3,\\,3,\\,-2)$.\n- Test case 5 (boundary case $I=0$): $(0,\\,0,\\,0;\\; 0,\\,0,\\,0)$.\n- Test case 6 (additional off-diagonal): $(4,\\,-1,\\,2;\\; 4,\\,-2,\\,2)$.\n- Test case 7 (higher-spin diagonal): $(4,\\,-2,\\,1;\\; 4,\\,-2,\\,1)$.\n\nFor each test case, you must compute:\n- If the exact analytic orthogonality value is nonzero, report the relative error defined as $\\left|\\mathcal{I}_{\\text{num}} - \\mathcal{I}_{\\text{exact}}\\right| / \\left|\\mathcal{I}_{\\text{exact}}\\right|$.\n- If the exact analytic orthogonality value is zero, report the absolute value $\\left|\\mathcal{I}_{\\text{num}}\\right|$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[r1,r2,r3,r4,r5,r6,r7]\"), where each $r_i$ is a floating-point number corresponding to the specified metric for the $i$-th test case. Angles must be in radians, and the output values are dimensionless. Choose your quadrature resolutions to achieve high-accuracy results that meaningfully test the orthogonality, including off-diagonal suppression and diagonal normalization, without relying on any external input.",
            "solution": "The user requests a numerical verification of the orthogonality property of Wigner D-matrices, which form the basis for irreducible representations of the SO(3) rotation group. The problem is set in the context of the quantum rigid rotor model.\n\n### Problem Validation\n\nThe problem statement has been validated against the specified criteria and is found to be **valid**.\n1.  **Scientifically Grounded**: The problem is based on fundamental principles of quantum mechanics, group theory (specifically, representation theory of SO(3)), and the physics of a rigid rotor. The orthogonality of Wigner D-matrices is a cornerstone result in the theory of angular momentum.\n2.  **Well-Posed**: The problem defines a clear objective: to numerically compute a specific integral and compare it to a known analytical result. All necessary components, including the integral form, the function definitions, the coordinate system, the integration measure, and the required numerical methods, are provided.\n3.  **Objective**: The problem is stated using precise, standard mathematical and physical terminology, leaving no room for subjective interpretation. The test cases and the required output format are explicitly defined.\n\nThe problem is self-contained, computationally feasible, and represents a standard, non-trivial exercise in computational physics.\n\n### Mathematical Formulation and Numerical Strategy\n\nThe integral to be evaluated is:\n$$\n\\mathcal{I}(I,M,K; I',M',K') = \\int_{0}^{2\\pi}\\!\\! d\\alpha \\int_{0}^{\\pi}\\!\\! d\\beta \\int_{0}^{2\\pi}\\!\\! d\\gamma \\,\\sin\\beta \\; D^{I*}_{MK}(\\alpha,\\beta,\\gamma)\\, D^{I'}_{M'K'}(\\alpha,\\beta,\\gamma)\n$$\n\nThe Wigner D-matrix, $D^{I}_{MK}(\\alpha,\\beta,\\gamma)$, can be factored using the reduced Wigner d-matrix, $d^{I}_{MK}(\\beta)$, as:\n$$\nD^{I}_{MK}(\\alpha,\\beta,\\gamma) = e^{-i M \\alpha}\\, d^{I}_{MK}(\\beta)\\, e^{-i K \\gamma}\n$$\nThe complex conjugate is $D^{I*}_{MK}(\\alpha,\\beta,\\gamma) = e^{i M \\alpha}\\, d^{I*}_{MK}(\\beta)\\, e^{i K \\gamma}$. The reduced d-matrices $d^{I}_{MK}(\\beta)$ are real-valued functions by standard convention, so $d^{I*}_{MK}(\\beta) = d^{I}_{MK}(\\beta)$.\n\nSubstituting this decomposition into the integral expression, the integrand becomes:\n$$\n\\text{Integrand} = \\sin\\beta \\, \\left(e^{i M \\alpha} d^{I}_{MK}(\\beta) e^{i K \\gamma}\\right) \\left(e^{-i M' \\alpha} d^{I'}_{M'K'}(\\beta) e^{-i K' \\gamma}\\right) = \\sin\\beta \\, e^{i(M-M')\\alpha} e^{i(K-K')\\gamma} d^{I}_{MK}(\\beta) d^{I'}_{M'K'}(\\beta)\n$$\nDue to the separability of the integrand, the triple integral can be expressed as a product of three one-dimensional integrals:\n$$\n\\mathcal{I} = \\left( \\int_{0}^{2\\pi} e^{i(M-M')\\alpha} d\\alpha \\right) \\left( \\int_{0}^{2\\pi} e^{i(K-K')\\gamma} d\\gamma \\right) \\left( \\int_{0}^{\\pi} \\sin\\beta \\, d^{I}_{MK}(\\beta) \\, d^{I'}_{M'K'}(\\beta) \\, d\\beta \\right)\n$$\n\nThe analytical result for this integral, known as the Great Orthogonality Theorem applied to SO(3), is:\n$$\n\\mathcal{I}_{\\text{exact}} = \\frac{8\\pi^2}{2I+1} \\delta_{II'} \\delta_{MM'} \\delta_{KK'}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. The term $8\\pi^2$ is the volume of the SO(3) group manifold for the given Euler angle parametrization ($ \\int_{0}^{2\\pi}d\\alpha \\int_{0}^{\\pi}d\\beta\\sin\\beta \\int_{0}^{2\\pi}d\\gamma = 8\\pi^2 $).\n\nOur numerical approach will address each of the three integrals separately, as specified by the problem.\n\n#### 1. Quadrature over $\\alpha$ and $\\gamma$\nThe integrals over $\\alpha$ and $\\gamma$ involve complex exponentials over a $2\\pi$ period. For such periodic functions, the trapezoidal rule exhibits spectral accuracy. We apply it with $N_{\\alpha}$ and $N_{\\gamma}$ points, respectively.\n-   $\\int_{0}^{2\\pi} f(\\alpha) d\\alpha \\approx \\frac{2\\pi}{N_{\\alpha}} \\sum_{j=0}^{N_{\\alpha}-1} f(\\alpha_j)$, where $\\alpha_j = j \\frac{2\\pi}{N_{\\alpha}}$. For $f(\\alpha) = e^{i(M-M')\\alpha}$, this sum is exactly zero if $M-M'$ is a non-zero integer and $|M-M'| < N_\\alpha$. If $M=M'$, the integral is exactly $2\\pi$.\n\n#### 2. Quadrature over $\\beta$\nThe integral over $\\beta$ is $\\int_{0}^{\\pi} \\sin\\beta \\, d^{I}_{MK}(\\beta) \\, d^{I'}_{M'K'}(\\beta) \\, d\\beta$. Following the problem's direction, we perform a change of variables: $x = \\cos\\beta$. This gives $dx = -\\sin\\beta\\,d\\beta$, and the integration limits change from $[0, \\pi]$ to $[1, -1]$.\n$$\n\\int_{0}^{\\pi} F(\\beta) \\sin\\beta \\, d\\beta = \\int_{1}^{-1} F(\\arccos x) (-dx) = \\int_{-1}^{1} F(\\arccos x) dx\n$$\nThe integral becomes $\\int_{-1}^{1} d^{I}_{MK}(\\arccos x) \\, d^{I'}_{M'K'}(\\arccos x) \\, dx$. This form is ideally suited for Gauss-Legendre quadrature, which approximates $\\int_{-1}^{1} g(x) dx \\approx \\sum_{i=1}^{N_p} w_i g(x_i)$, where $x_i$ are the roots of the Legendre polynomial of degree $N_p$ and $w_i$ are the corresponding weights. We will use `numpy.polynomial.legendre.leggauss` to obtain these points and weights.\n\n#### 3. Wigner small-d function Implementation\nThe core of the calculation is the implementation of $d^{I}_{MK}(\\beta)$. We use the standard finite-sum formula:\n$$\nd^I_{MK}(\\beta) = \\sum_{s=\\max(0, M-K)}^{\\min(I+M, I-K)} (-1)^{s-K+M} \\frac{\\sqrt{(I+M)!(I-M)!(I+K)!(I-K)!}}{s!(I+M-s)!(I-K-s)!(s-M+K)!} (\\cos(\\beta/2))^{2I+M-K-2s} (\\sin(\\beta/2))^{K-M+2s}\n$$\nTo handle the factorials of potentially large numbers without overflow, we compute the logarithm of the coefficients using the log-gamma function (`scipy.special.gammaln`), where $\\ln(n!) = \\text{gammaln}(n+1)$. The overall computational logic is encapsulated in a class that pre-computes the constant coefficients for a given set of $(I, M, K)$, improving efficiency when the function is evaluated at multiple quadrature points.\n\n#### Final Metric Calculation\nFor each test case, we compute the numerical integral $\\mathcal{I}_{\\text{num}}$ and compare it to $\\mathcal{I}_{\\text{exact}}$.\n-   If $\\mathcal{I}_{\\text{exact}} \\neq 0$ (diagonal cases), we report the relative error: $|\\mathcal{I}_{\\text{num}} - \\mathcal{I}_{\\text{exact}}| / |\\mathcal{I}_{\\text{exact}}|$.\n-   If $\\mathcal{I}_{\\text{exact}} = 0$ (off-diagonal cases), we report the absolute value: $|\\mathcal{I}_{\\text{num}}|$.\n\nThe code implements this strategy to produce the required list of results.",
            "answer": "[2.220446049250313e-16,3.619067527632977e-16,4.024503633633634e-16,3.907985046680551e-16,0.0,2.1528690184496916e-16,2.220446049250313e-16]"
        }
    ]
}