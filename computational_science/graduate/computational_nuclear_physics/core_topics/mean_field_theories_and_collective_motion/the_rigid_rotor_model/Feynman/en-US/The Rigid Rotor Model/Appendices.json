{
    "hands_on_practices": [
        {
            "introduction": "The simplest model of nuclear rotation is the spherical rigid rotor, which provides the foundation for understanding collective excitations. This exercise traces the path from a classical description of rotational energy to a quantum mechanical Hamiltonian. By deriving the famous $E \\propto I(I+1)$ energy spectrum and its degeneracy, you will solidify your understanding of canonical quantization and the fundamental properties of angular momentum in quantum systems .",
            "id": "3606597",
            "problem": "A spherical even-even nucleus can be modeled as a quantum rigid rotor whose orientation is described by rotations in the Special Orthogonal group in three dimensions ($\\mathrm{SO}(3)$). The classical kinetic energy of a rigid rotor with angular velocity vector $\\boldsymbol{\\omega}$ and inertia tensor $\\mathbf{I}$ is given by $T=\\frac{1}{2}\\,\\boldsymbol{\\omega}\\cdot\\mathbf{I}\\cdot\\boldsymbol{\\omega}$. For a spherical rotor, the inertia tensor is isotropic and can be written as $\\mathbf{I}=\\mathcal{I}\\,\\mathbf{1}$ with a single moment of inertia parameter $\\mathcal{I}$. The canonical angular momentum is $\\mathbf{L}=\\mathbf{I}\\cdot\\boldsymbol{\\omega}$, and the Hamiltonian is the total energy of the system in the absence of potential energy.\n\nStarting from these fundamental relations and using canonical quantization of angular momentum with the commutation relations $[\\hat{L}_{i},\\hat{L}_{j}]=\\mathrm{i}\\hbar\\,\\epsilon_{ijk}\\hat{L}_{k}$ of the Special Unitary group of degree two ($\\mathrm{SU(2)}$) algebra, derive the quantum Hamiltonian for a spherical rotor and obtain its energy spectrum as a function of the total angular momentum quantum number $I$ and the moment of inertia $\\mathcal{I}$. The physical configuration space of the rotor is $\\mathrm{SO(3)}$, so require the rotor wavefunctions to be single-valued under $2\\pi$ rotations.\n\nThen, verify the degeneracy of each energy level with respect to the magnetic quantum number $M$ by explicitly counting the distinct, normalized eigenstates corresponding to different $M$ values. Your counting should be based on the simultaneous eigenbasis of $\\hat{\\mathbf{L}}^{2}$ and $\\hat{L}_{z}$ and the single-valuedness condition on the corresponding angular wavefunctions.\n\nProvide your final answer as a two-entry row matrix, with the first entry the energy $E_{I}$ and the second entry the degeneracy $g_{I}$, both expressed in closed-form as functions of $I$ and $\\mathcal{I}$. Express the energy in joules. No numerical evaluation is required, and no rounding is needed.",
            "solution": "The problem asks for the energy spectrum and degeneracy of a quantum rigid rotor, which models a spherical even-even nucleus. The derivation begins with the classical expression for the kinetic energy and proceeds through canonical quantization.\n\nThe classical kinetic energy $T$ of a rigid rotor is given by the expression:\n$$T=\\frac{1}{2}\\,\\boldsymbol{\\omega}\\cdot\\mathbf{I}\\cdot\\boldsymbol{\\omega}$$\nwhere $\\boldsymbol{\\omega}$ is the angular velocity vector and $\\mathbf{I}$ is the inertia tensor. For a spherical rotor, the inertia tensor is isotropic, meaning it is proportional to the identity tensor $\\mathbf{1}$. It can be written as $\\mathbf{I}=\\mathcal{I}\\,\\mathbf{1}$, where $\\mathcal{I}$ is the scalar moment of inertia. Substituting this into the energy expression gives:\n$$T = \\frac{1}{2}\\,\\boldsymbol{\\omega}\\cdot(\\mathcal{I}\\,\\mathbf{1})\\cdot\\boldsymbol{\\omega} = \\frac{1}{2}\\mathcal{I}\\,(\\boldsymbol{\\omega}\\cdot\\boldsymbol{\\omega}) = \\frac{1}{2}\\mathcal{I}\\omega^2$$\nThe canonical angular momentum $\\mathbf{L}$ is related to the angular velocity by:\n$$\\mathbf{L} = \\mathbf{I}\\cdot\\boldsymbol{\\omega} = (\\mathcal{I}\\,\\mathbf{1})\\cdot\\boldsymbol{\\omega} = \\mathcal{I}\\boldsymbol{\\omega}$$\nFrom this relation, we can express the angular velocity in terms of the angular momentum:\n$$\\boldsymbol{\\omega} = \\frac{\\mathbf{L}}{\\mathcal{I}}$$\nThe Hamiltonian $H$ of the system is its total energy. As the problem specifies no potential energy, the Hamiltonian is equal to the kinetic energy, $H=T$. We can express the Hamiltonian in terms of the angular momentum by substituting the expression for $\\boldsymbol{\\omega}$:\n$$H = T = \\frac{1}{2}\\mathcal{I}\\omega^2 = \\frac{1}{2}\\mathcal{I}\\left|\\frac{\\mathbf{L}}{\\mathcal{I}}\\right|^2 = \\frac{1}{2}\\mathcal{I}\\frac{L^2}{\\mathcal{I}^2} = \\frac{L^2}{2\\mathcal{I}}$$\nTo obtain the quantum Hamiltonian, we use canonical quantization, which involves promoting classical observables to their corresponding quantum operators. The classical quantity $L^2$, the squared magnitude of the angular momentum vector, is replaced by the quantum operator $\\hat{\\mathbf{L}}^2 = \\hat{L}_x^2 + \\hat{L}_y^2 + \\hat{L}_z^2$. The operators $\\hat{L}_i$ satisfy the $\\mathrm{SU}(2)$ Lie algebra commutation relations $[\\hat{L}_{i},\\hat{L}_{j}]=\\mathrm{i}\\hbar\\,\\epsilon_{ijk}\\hat{L}_{k}$, as given in the problem statement. The quantum Hamiltonian operator $\\hat{H}$ is therefore:\n$$\\hat{H} = \\frac{\\hat{\\mathbf{L}}^2}{2\\mathcal{I}}$$\nThe energy spectrum of the rotor is found by determining the eigenvalues of the Hamiltonian operator $\\hat{H}$. This is accomplished by solving the time-independent Schrödinger equation:\n$$\\hat{H}|\\psi\\rangle = E|\\psi\\rangle$$\nThe eigenstates $|\\psi\\rangle$ of the Hamiltonian are the simultaneous eigenstates of the commuting operators $\\hat{\\mathbf{L}}^2$ and $\\hat{L}_z$. These states are denoted by $|I, M\\rangle$, where $I$ is the total angular momentum quantum number and $M$ is the magnetic quantum number. The action of the $\\hat{\\mathbf{L}}^2$ operator on these states is a standard result from the quantum theory of angular momentum:\n$$\\hat{\\mathbf{L}}^2 |I, M\\rangle = \\hbar^2 I(I+1) |I, M\\rangle$$\nSubstituting this into the Schrödinger equation yields:\n$$\\hat{H}|I, M\\rangle = \\frac{\\hat{\\mathbf{L}}^2}{2\\mathcal{I}} |I, M\\rangle = \\frac{\\hbar^2 I(I+1)}{2\\mathcal{I}} |I, M\\rangle$$\nBy comparing this with $\\hat{H}|I, M\\rangle = E_I |I, M\\rangle$, we identify the energy eigenvalues $E_I$ as:\n$$E_I = \\frac{\\hbar^2 I(I+1)}{2\\mathcal{I}}$$\nThe energy $E_I$ depends only on the quantum number $I$, not on $M$. The problem specifies that the physical configuration space is $\\mathrm{SO}(3)$, which requires the wavefunctions to be single-valued under a rotation of $2\\pi$. In the position representation, the eigenstates are proportional to the spherical harmonics, $\\psi_{I,M}(\\theta, \\phi) \\propto Y_{I,M}(\\theta, \\phi)$. A rotation by an angle of $2\\pi$ about any axis must leave the wavefunction unchanged. For a rotation of angle $\\alpha$ about the $z$-axis, the wavefunction transforms as $\\psi_{I,M}(\\theta, \\phi - \\alpha) = \\exp(-i M \\alpha) \\psi_{I,M}(\\theta, \\phi)$. For a $2\\pi$ rotation, $\\alpha=2\\pi$, single-valuedness requires $\\exp(-i M 2\\pi) = 1$. This implies that the magnetic quantum number $M$ must be an integer. Since the standard theory of angular momentum requires that $M$ takes values from $-I$ to $I$ in integer steps, the requirement that $M$ is an integer forces $I$ to also be an integer: $I = 0, 1, 2, \\dots$. For the specific physical system of a spherical even-even nucleus, additional symmetry considerations require the ground-state rotational band to consist of states with positive parity, which restricts the allowed angular momenta to even integer values, $I = 0, 2, 4, \\dots$. The formula for $E_I$, however, is general for any allowed integer $I$.\n\nNext, we verify the degeneracy $g_I$ of each energy level. The energy $E_I$ is determined solely by the quantum number $I$. For a fixed value of $I$, the magnetic quantum number $M$ can take any integer value in the range:\n$$M \\in \\{-I, -I+1, \\dots, I-1, I\\}$$\nEach of these values of $M$ corresponds to a distinct, normalized, and orthogonal quantum state $|I, M\\rangle$. The total number of such states for a given $I$ is the degeneracy of the energy level $E_I$. The number of values $M$ can assume is:\n$$g_I = (I - (-I)) + 1 = 2I + 1$$\nTherefore, each energy level $E_I$ is $(2I+1)$-fold degenerate.\n\nThe final answer requires the energy $E_I$ and the degeneracy $g_I$, both expressed as functions of $I$ and $\\mathcal{I}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\hbar^2 I(I+1)}{2\\mathcal{I}} & 2I+1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "The eigenstates of the rotor Hamiltonian are described by Wigner D-matrices, which form a complete and orthogonal basis set. This practice involves numerically verifying the fundamental orthogonality relation for these functions, which are the matrix representations of the rotation group $SO(3)$. You will implement essential numerical techniques, such as quadrature over the group manifold, and gain hands-on experience with the mathematical functions that form the bedrock of angular momentum theory .",
            "id": "3606621",
            "problem": "Consider the rigid rotor model in computational nuclear physics, where body-fixed and space-fixed frames are related by Euler angles. Let the Euler angles be denoted by $\\alpha$, $\\beta$, and $\\gamma$, with the ranges $\\alpha \\in [0,2\\pi)$, $\\beta \\in [0,\\pi]$, and $\\gamma \\in [0,2\\pi)$. Angles must be treated in radians. The rotation group Special Orthogonal group in three dimensions (SO(3)) admits irreducible unitary representations labeled by the total angular momentum $I \\in \\{0,1,2,\\dots\\}$ and magnetic quantum numbers $M$ and $K$ with $-I \\le M,K \\le I$. The Wigner rotation matrix elements are $D^{I}_{MK}(\\alpha,\\beta,\\gamma)$, and the invariant Haar measure on SO(3) in Euler angles is $d\\Omega = \\sin\\beta \\, d\\alpha \\, d\\beta \\, d\\gamma$.\n\nFrom representation theory and rotational symmetry, the functions $D^{I}_{MK}(\\alpha,\\beta,\\gamma)$ are orthogonal over the group manifold with respect to the Haar measure. Your task is to implement a numerical quadrature over the Euler angles to evaluate the integral\n$$\n\\mathcal{I}(I,M,K; I',M',K') \\equiv \\int_{0}^{2\\pi} d\\alpha \\int_{0}^{\\pi} d\\beta \\int_{0}^{2\\pi} d\\gamma \\, \\sin\\beta \\, D^{I*}_{MK}(\\alpha,\\beta,\\gamma)\\, D^{I'}_{M'K'}(\\alpha,\\beta,\\gamma),\n$$\nand then test the accuracy of your numerical evaluation against the analytically exact orthogonality result that follows from the properties of group representations on SO(3).\n\nFundamental base for the derivation and implementation must include:\n- The decomposition $D^{I}_{MK}(\\alpha,\\beta,\\gamma) = e^{-i M \\alpha}\\, d^{I}_{MK}(\\beta)\\, e^{-i K \\gamma})$, where $d^{I}_{MK}(\\beta)$ are the reduced Wigner rotation matrix elements (often called the Wigner small-$d$ functions).\n- The invariant Haar measure $d\\Omega$ on SO(3) in Euler angles.\n- The fact that the orthogonality of irreducible representations on a compact group with respect to the Haar measure yields Kronecker-delta structure in the quantum numbers.\n\nYou must design a fully self-contained numerical algorithm that:\n1. Implements $d^{I}_{MK}(\\beta)$ for integer $I$, $M$, and $K$, using a numerically stable finite-sum representation derived from fundamental angular momentum theory (no external data).\n2. Uses a periodic quadrature over $\\alpha$ and $\\gamma$ that is appropriate for $2\\pi$-periodic complex exponentials.\n3. Uses Gaussian quadrature over $\\beta$ by transforming the $\\beta$-integral with the $\\sin\\beta$ weight into an integral over $x=\\cos\\beta \\in [-1,1]$.\n4. Aggregates the three quadratures to produce a single numerical value $\\mathcal{I}(I,M,K; I',M',K')$.\n\nNumerical units and conventions:\n- Angles must be in radians throughout.\n- The final integral $\\mathcal{I}$ is dimensionless.\n\nTo make the problem testable, use the following test suite of parameter tuples $(I,M,K; I',M',K')$:\n- Test case 1 (general happy path): $(2,\\,1,\\,-1;\\; 2,\\,1,\\,-1)$.\n- Test case 2 (different total angular momentum): $(2,\\,1,\\,-1;\\; 3,\\,1,\\,-1)$.\n- Test case 3 (different space-fixed projection): $(3,\\,0,\\,3;\\; 3,\\,1,\\,3)$.\n- Test case 4 (different body-fixed projection): $(3,\\,3,\\,-3;\\; 3,\\,3,\\,-2)$.\n- Test case 5 (boundary case $I=0$): $(0,\\,0,\\,0;\\; 0,\\,0,\\,0)$.\n- Test case 6 (additional off-diagonal): $(4,\\,-1,\\,2;\\; 4,\\,-2,\\,2)$.\n- Test case 7 (higher-spin diagonal): $(4,\\,-2,\\,1;\\; 4,\\,-2,\\,1)$.\n\nFor each test case, you must compute:\n- If the exact analytic orthogonality value is nonzero, report the relative error defined as $\\left|\\mathcal{I}_{\\text{num}} - \\mathcal{I}_{\\text{exact}}\\right| / \\left|\\mathcal{I}_{\\text{exact}}\\right|$.\n- If the exact analytic orthogonality value is zero, report the absolute value $\\left|\\mathcal{I}_{\\text{num}}\\right|$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[r1,r2,r3,r4,r5,r6,r7]\"), where each $r_i$ is a floating-point number corresponding to the specified metric for the $i$-th test case. Angles must be in radians, and the output values are dimensionless. Choose your quadrature resolutions to achieve high-accuracy results that meaningfully test the orthogonality, including off-diagonal suppression and diagonal normalization, without relying on any external input.",
            "solution": "The user requests a numerical verification of the orthogonality property of Wigner D-matrices, which form the basis for irreducible representations of the SO(3) rotation group. The problem is set in the context of the quantum rigid rotor model.\n\n### Problem Validation\n\nThe problem statement has been validated against the specified criteria and is found to be **valid**.\n1.  **Scientifically Grounded**: The problem is based on fundamental principles of quantum mechanics, group theory (specifically, representation theory of SO(3)), and the physics of a rigid rotor. The orthogonality of Wigner D-matrices is a cornerstone result in the theory of angular momentum.\n2.  **Well-Posed**: The problem defines a clear objective: to numerically compute a specific integral and compare it to a known analytical result. All necessary components, including the integral form, the function definitions, the coordinate system, the integration measure, and the required numerical methods, are provided.\n3.  **Objective**: The problem is stated using precise, standard mathematical and physical terminology, leaving no room for subjective interpretation. The test cases and the required output format are explicitly defined.\n\nThe problem is self-contained, computationally feasible, and represents a standard, non-trivial exercise in computational physics.\n\n### Mathematical Formulation and Numerical Strategy\n\nThe integral to be evaluated is:\n$$\n\\mathcal{I}(I,M,K; I',M',K') = \\int_{0}^{2\\pi}\\!\\! d\\alpha \\int_{0}^{\\pi}\\!\\! d\\beta \\int_{0}^{2\\pi}\\!\\! d\\gamma \\,\\sin\\beta \\; D^{I*}_{MK}(\\alpha,\\beta,\\gamma)\\, D^{I'}_{M'K'}(\\alpha,\\beta,\\gamma)\n$$\n\nThe Wigner D-matrix, $D^{I}_{MK}(\\alpha,\\beta,\\gamma)$, can be factored using the reduced Wigner d-matrix, $d^{I}_{MK}(\\beta)$, as:\n$$\nD^{I}_{MK}(\\alpha,\\beta,\\gamma) = e^{-i M \\alpha}\\, d^{I}_{MK}(\\beta)\\, e^{-i K \\gamma}\n$$\nThe complex conjugate is $D^{I*}_{MK}(\\alpha,\\beta,\\gamma) = e^{i M \\alpha}\\, d^{I*}_{MK}(\\beta)\\, e^{i K \\gamma}$. The reduced d-matrices $d^{I}_{MK}(\\beta)$ are real-valued functions by standard convention, so $d^{I*}_{MK}(\\beta) = d^{I}_{MK}(\\beta)$.\n\nSubstituting this decomposition into the integral expression, the integrand becomes:\n$$\n\\text{Integrand} = \\sin\\beta \\, \\left(e^{i M \\alpha} d^{I}_{MK}(\\beta) e^{i K \\gamma}\\right) \\left(e^{-i M' \\alpha} d^{I'}_{M'K'}(\\beta) e^{-i K' \\gamma}\\right) = \\sin\\beta \\, e^{i(M-M')\\alpha} e^{i(K-K')\\gamma} d^{I}_{MK}(\\beta) d^{I'}_{M'K'}(\\beta)\n$$\nDue to the separability of the integrand, the triple integral can be expressed as a product of three one-dimensional integrals:\n$$\n\\mathcal{I} = \\left( \\int_{0}^{2\\pi} e^{i(M-M')\\alpha} d\\alpha \\right) \\left( \\int_{0}^{2\\pi} e^{i(K-K')\\gamma} d\\gamma \\right) \\left( \\int_{0}^{\\pi} \\sin\\beta \\, d^{I}_{MK}(\\beta) \\, d^{I'}_{M'K'}(\\beta) \\, d\\beta \\right)\n$$\n\nThe analytical result for this integral, known as the Great Orthogonality Theorem applied to SO(3), is:\n$$\n\\mathcal{I}_{\\text{exact}} = \\frac{8\\pi^2}{2I+1} \\delta_{II'} \\delta_{MM'} \\delta_{KK'}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. The term $8\\pi^2$ is the volume of the SO(3) group manifold for the given Euler angle parametrization ($ \\int_{0}^{2\\pi}d\\alpha \\int_{0}^{\\pi}d\\beta\\sin\\beta \\int_{0}^{2\\pi}d\\gamma = 8\\pi^2 $).\n\nOur numerical approach will address each of the three integrals separately, as specified by the problem.\n\n#### 1. Quadrature over $\\alpha$ and $\\gamma$\nThe integrals over $\\alpha$ and $\\gamma$ involve complex exponentials over a $2\\pi$ period. For such periodic functions, the trapezoidal rule exhibits spectral accuracy. We apply it with $N_{\\alpha}$ and $N_{\\gamma}$ points, respectively.\n-   $\\int_{0}^{2\\pi} f(\\alpha) d\\alpha \\approx \\frac{2\\pi}{N_{\\alpha}} \\sum_{j=0}^{N_{\\alpha}-1} f(\\alpha_j)$, where $\\alpha_j = j \\frac{2\\pi}{N_{\\alpha}}$. For $f(\\alpha) = e^{i(M-M')\\alpha}$, this sum is exactly zero if $M-M'$ is a non-zero integer and $|M-M'| < N_\\alpha$. If $M=M'$, the integral is exactly $2\\pi$.\n\n#### 2. Quadrature over $\\beta$\nThe integral over $\\beta$ is $\\int_{0}^{\\pi} \\sin\\beta \\, d^{I}_{MK}(\\beta) \\, d^{I'}_{M'K'}(\\beta) \\, d\\beta$. Following the problem's direction, we perform a change of variables: $x = \\cos\\beta$. This gives $dx = -\\sin\\beta\\,d\\beta$, and the integration limits change from $[0, \\pi]$ to $[1, -1]$.\n$$\n\\int_{0}^{\\pi} F(\\beta) \\sin\\beta \\, d\\beta = \\int_{1}^{-1} F(\\arccos x) (-dx) = \\int_{-1}^{1} F(\\arccos x) dx\n$$\nThe integral becomes $\\int_{-1}^{1} d^{I}_{MK}(\\arccos x) \\, d^{I'}_{M'K'}(\\arccos x) \\, dx$. This form is ideally suited for Gauss-Legendre quadrature, which approximates $\\int_{-1}^{1} g(x) dx \\approx \\sum_{i=1}^{N_p} w_i g(x_i)$, where $x_i$ are the roots of the Legendre polynomial of degree $N_p$ and $w_i$ are the corresponding weights. We will use `numpy.polynomial.legendre.leggauss` to obtain these points and weights.\n\n#### 3. Wigner small-d function Implementation\nThe core of the calculation is the implementation of $d^{I}_{MK}(\\beta)$. We use the standard finite-sum formula:\n$$\nd^I_{MK}(\\beta) = \\sum_{s=\\max(0, M-K)}^{\\min(I+M, I-K)} (-1)^{s-K+M} \\frac{\\sqrt{(I+M)!(I-M)!(I+K)!(I-K)!}}{s!(I+M-s)!(I-K-s)!(s-M+K)!} (\\cos(\\beta/2))^{2I+M-K-2s} (\\sin(\\beta/2))^{K-M+2s}\n$$\nTo handle the factorials of potentially large numbers without overflow, we compute the logarithm of the coefficients using the log-gamma function (`scipy.special.gammaln`), where $\\ln(n!) = \\text{gammaln}(n+1)$. The overall computational logic is encapsulated in a class that pre-computes the constant coefficients for a given set of $(I, M, K)$, improving efficiency when the function is evaluated at multiple quadrature points.\n\n#### Final Metric Calculation\nFor each test case, we compute the numerical integral $\\mathcal{I}_{\\text{num}}$ and compare it to $\\mathcal{I}_{\\text{exact}}$.\n-   If $\\mathcal{I}_{\\text{exact}} \\neq 0$ (diagonal cases), we report the relative error: $|\\mathcal{I}_{\\text{num}} - \\mathcal{I}_{\\text{exact}}| / |\\mathcal{I}_{\\text{exact}}|$.\n-   If $\\mathcal{I}_{\\text{exact}} = 0$ (off-diagonal cases), we report the absolute value: $|\\mathcal{I}_{\\text{num}}|$.\n\nThe code implements this strategy to produce the required list of results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import gammaln\n\nclass WignerDCalculator:\n    \"\"\"\n    A class to compute Wigner small-d matrix elements d^I_{MK}(beta).\n\n    It uses a numerically stable finite-sum representation derived from\n    angular momentum theory. To improve efficiency for quadrature, where the\n    function is evaluated at many points, constant coefficients for the sum\n    are pre-calculated during initialization.\n    \"\"\"\n    def __init__(self, I, M, K):\n        if not (isinstance(I, int) and I >= 0):\n            raise ValueError(\"I must be a non-negative integer.\")\n        if not (isinstance(M, int) and abs(M) <= I):\n            raise ValueError(f\"M must be an integer with |M| <= I, but got M={M}, I={I}\")\n        if not (isinstance(K, int) and abs(K) <= I):\n            raise ValueError(f\"K must be an integer with |K| <= I, but got K={K}, I={I}\")\n            \n        self.I, self.M, self.K = I, M, K\n        \n        # Determine the summation range for s\n        self.s_min = max(0, M - K)\n        self.s_max = min(I + M, I - K)\n\n        self.coeffs = []\n        # The sum is non-empty only if s_min <= s_max\n        if self.s_min <= self.s_max:\n            # Pre-calculate the log of the large constant factor involving factorials\n            log_prefactor = 0.5 * (gammaln(I + M + 1) + gammaln(I - M + 1) + \n                                   gammaln(I + K + 1) + gammaln(I - K + 1))\n            \n            for s in range(self.s_min, self.s_max + 1):\n                sign = 1.0 if (s - K + M) % 2 == 0 else -1.0\n                \n                log_denominator = (gammaln(s + 1) + \n                                   gammaln(I + M - s + 1) + \n                                   gammaln(I - K - s + 1) + \n                                   gammaln(s - M + K + 1))\n                \n                # Exponentiate to get the final coefficient\n                coeff = sign * np.exp(log_prefactor - log_denominator)\n                self.coeffs.append(coeff)\n\n    def d(self, beta):\n        \"\"\"\n        Evaluates the d-function for a given angle beta.\n        \"\"\"\n        # If the summation range is empty, the function is zero\n        if not self.coeffs:\n            return 0.0\n\n        term_sum = 0.0\n        c_half_beta = np.cos(beta / 2.0)\n        s_half_beta = np.sin(beta / 2.0)\n\n        for i, s in enumerate(range(self.s_min, self.s_max + 1)):\n            pow1 = 2 * self.I + self.M - self.K - 2 * s\n            pow2 = self.K - self.M + 2 * s\n            \n            # Use np.power for robust handling of 0^0 = 1\n            trig_term = np.power(c_half_beta, pow1) * np.power(s_half_beta, pow2)\n            \n            term_sum += self.coeffs[i] * trig_term\n        return term_sum\n\ndef compute_orthogonality_integral(params, N_alpha, N_gamma, N_beta):\n    \"\"\"\n    Computes the orthogonality integral for a given set of quantum numbers.\n    \"\"\"\n    I, M, K, I_p, M_p, K_p = params\n\n    # Determine the analytical exact value of the integral\n    exact_val = 0.0\n    if I == I_p and M == M_p and K == K_p:\n        # The denominator 2I+1 is always positive since I >= 0\n        exact_val = (8 * np.pi**2) / (2 * I + 1)\n\n    # --- Numerical Quadrature ---\n\n    # 1. Alpha integral (Periodic Trapezoidal Rule)\n    dM = M - M_p\n    alpha_pts = np.linspace(0, 2 * np.pi, N_alpha, endpoint=False)\n    integrand_alpha = np.exp(1j * dM * alpha_pts)\n    I_alpha = (2 * np.pi / N_alpha) * np.sum(integrand_alpha)\n    \n    # 2. Gamma integral (Periodic Trapezoidal Rule)\n    dK = K - K_p\n    gamma_pts = np.linspace(0, 2 * np.pi, N_gamma, endpoint=False)\n    integrand_gamma = np.exp(1j * dK * gamma_pts)\n    I_gamma = (2 * np.pi / N_gamma) * np.sum(integrand_gamma)\n    \n    # 3. Beta integral (Gauss-Legendre Quadrature)\n    # Transformation: x = cos(beta), so integral is over [-1, 1] with measure dx\n    x_pts, w_pts = np.polynomial.legendre.leggauss(N_beta)\n    beta_pts = np.arccos(x_pts)\n    \n    # Instantiate calculators for the two d-functions\n    d1_calc = WignerDCalculator(I, M, K)\n    d2_calc = WignerDCalculator(I_p, M_p, K_p)\n    \n    # Evaluate d-functions at all quadrature points\n    d1_vals = np.array([d1_calc.d(b) for b in beta_pts])\n    d2_vals = np.array([d2_calc.d(b) for b in beta_pts])\n    \n    # The integrand is a simple product since d_MK are real\n    integrand_beta = d1_vals * d2_vals\n    I_beta = np.sum(w_pts * integrand_beta)\n    \n    # Combine the three parts to get the final numerical value\n    num_val = I_alpha * I_gamma * I_beta\n    \n    # Calculate the required metric based on whether the exact value is zero\n    if exact_val != 0:\n        # For diagonal cases, compute relative error\n        metric = np.abs(num_val - exact_val) / np.abs(exact_val)\n    else:\n        # For off-diagonal cases, compute absolute value (suppression)\n        metric = np.abs(num_val)\n        \n    return metric\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (2, 1, -1, 2, 1, -1),   # Test case 1\n        (2, 1, -1, 3, 1, -1),   # Test case 2\n        (3, 0, 3, 3, 1, 3),    # Test case 3\n        (3, 3, -3, 3, 3, -2),  # Test case 4\n        (0, 0, 0, 0, 0, 0),    # Test case 5\n        (4, -1, 2, 4, -2, 2),  # Test case 6\n        (4, -2, 1, 4, -2, 1),  # Test case 7\n    ]\n    \n    # Set quadrature resolutions\n    N_ALPHA = 100\n    N_GAMMA = 100\n    N_BETA = 200\n\n    results = []\n    for case in test_cases:\n        result = compute_orthogonality_integral(case, N_ALPHA, N_GAMMA, N_BETA)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "While the basic rotor model successfully describes even-even nuclei with integer angular momenta, nature also presents odd-mass nuclei with half-integer spin spectra. This exercise explores the deep group-theoretical reason for this distinction, rooted in the different topologies of the rotation group $SO(3)$ and its universal covering group $SU(2)$. By analyzing the consequences of coupling a rotor to an intrinsic fermion spin, you will grasp the physical origin of half-integer angular momentum and how it is correctly implemented in advanced nuclear models .",
            "id": "3606593",
            "problem": "A quantum rigid rotor that models collective nuclear rotation has Hamiltonian $H = \\frac{1}{2\\mathcal{I}} \\mathbf{J}^2$, where $\\mathcal{I}$ is the moment of inertia and $\\mathbf{J}$ is the total angular momentum operator obeying $[J_i,J_j]= i\\hbar \\epsilon_{ijk} J_k$. The configuration space of a physical rotor is the Special Orthogonal Group of degree three ($SO(3)$), while the Special Unitary Group of degree two ($SU(2)$) is its double cover. In odd nuclei, the particle–rotor model couples the rotor to an intrinsic fermion of spin $s=\\frac{1}{2}$, and the total states live in the tensor product of the rotor’s Hilbert space with the intrinsic fermionic space. Consider the role of single-valuedness of the wavefunction on the configuration space, the topology of $SO(3)$ versus $SU(2)$, and the implications for allowed angular momenta and boundary conditions in computational implementations based on Euler angles $(\\alpha,\\beta,\\gamma)$ and Wigner $\\mathcal{D}$-function expansions.\n\nSelect all statements that are correct:\n\nA. Quantizing the rigid rotor on $SO(3)$ with wavefunctions required to be single-valued on $SO(3)$ implies that only integer $L$ representations occur; states that change sign under a $2\\pi$ rotation are excluded for the pure rotor.\n\nB. Quantizing the rotor on $SU(2)$ and imposing single-valuedness on $SU(2)$ yields physically observable half-integer $L$ spectra for even–even nuclear rotors, because $SU(2)$ admits half-integer representations.\n\nC. In the particle–rotor model with one intrinsic fermion of spin $s=\\frac{1}{2}$, the total angular momentum $J$ can be half-integer even though the rotor’s $L$ is integer; the reason is that under a $2\\pi$ rotation the intrinsic fermion contributes a factor of $-1$, which is compatible with physical observables being quadratic in the state.\n\nD. The emergence of half-integer $L$ in odd-nucleus particle–rotor models is explained by a nontrivial second homotopy group $\\pi_2(SO(3))=\\mathbb{Z}_2$, which classifies projective representations relevant to nuclear rotation.\n\nE. In numerical diagonalization on Euler angles $(\\alpha,\\beta,\\gamma)$ using Wigner $\\mathcal{D}$-function expansions, single-valuedness on $SO(3)$ requires integer Fourier modes for both $M$ and $K$. When an intrinsic spin-$\\frac{1}{2}$ is included, the total projection $K$ can be half-integer, and one can implement this by an antiperiodic boundary condition under $\\gamma \\to \\gamma + 2\\pi$, which produces rotational bands with half-integer $J$ in odd nuclei.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n-   System: A quantum rigid rotor for collective nuclear rotation.\n-   Hamiltonian: $H = \\frac{1}{2\\mathcal{I}} \\mathbf{J}^2$.\n-   $\\mathcal{I}$: Moment of inertia.\n-   $\\mathbf{J}$: Total angular momentum operator.\n-   Angular Momentum Algebra: $[J_i,J_j]= i\\hbar \\epsilon_{ijk} J_k$.\n-   Configuration Space for a physical rotor: Special Orthogonal Group of degree three, $SO(3)$.\n-   Covering Group: The Special Unitary Group of degree two, $SU(2)$, is the double cover of $SO(3)$.\n-   Particle–Rotor Model: For odd nuclei, the rotor is coupled to an intrinsic fermion of spin $s=1/2$.\n-   Total Hilbert Space (Particle–Rotor): Tensor product of the rotor’s Hilbert space with the intrinsic fermionic space.\n-   Context: The problem concerns the implications of single-valuedness, the topology of $SO(3)$ versus $SU(2)$, and computational implementations using Euler angles $(\\alpha,\\beta,\\gamma)$ and Wigner $\\mathcal{D}$-function expansions for allowed angular momenta.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is firmly based on standard, well-established principles of quantum mechanics, group theory, and nuclear structure physics. The Hamiltonian, the angular momentum algebra, the identification of $SO(3)$ as the configuration space, its relationship to $SU(2)$, the particle-rotor model, and the use of Wigner $\\mathcal{D}$-functions are all cornerstone concepts in these fields.\n2.  **Well-Posed**: The problem provides a clear conceptual framework and asks for the evaluation of specific statements within that framework. The task is to identify which of the provided statements are correct based on the established theory. A definite answer exists for each statement.\n3.  **Objective**: The language is technical, precise, and free of any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is scientifically sound, well-posed, objective, and provides sufficient context to evaluate the options. The solution process may proceed.\n\n### Principle-Based Derivation and Option Analysis\n\nThe core of the problem lies in the properties of wavefunctions under rotation and the topological difference between $SO(3)$ and $SU(2)$. An operator for a rotation by an angle $\\phi$ about an axis defined by the unit vector $\\mathbf{n}$ is given by $U(\\mathbf{n}, \\phi) = \\exp(-i\\phi \\mathbf{n}\\cdot\\mathbf{J}/\\hbar)$. For a full rotation of $\\phi = 2\\pi$, this operator becomes $U(\\mathbf{n}, 2\\pi) = \\exp(-i2\\pi \\mathbf{n}\\cdot\\mathbf{J}/\\hbar)$. An eigenstate of $\\mathbf{J}^2$ and $J_z$ with quantum numbers $J$ and $M$ will transform under this $2\\pi$ rotation by a phase factor. Specifically, if we align the z-axis with $\\mathbf{n}$, the state transforms by a factor of $\\exp(-i2\\pi M)$. More generally, for any orientation, the state vector $|\\psi_J\\rangle$ transforms as $|\\psi_J\\rangle \\to (-1)^{2J} |\\psi_J\\rangle$.\n\nThe configuration space of a physical rigid body is $SO(3)$, where a $2\\pi$ rotation is equivalent to the identity. A strict single-valuedness condition on the wavefunction, $\\Psi(\\text{config})$, would require that the wavefunction returns to its original value after a $2\\pi$ rotation, i.e., acquires a phase of $+1$. This implies $(-1)^{2J} = 1$, which holds if and only if $J$ is an integer ($J=0, 1, 2, ...$).\n\nHowever, quantum mechanics only requires that physical observables, which are typically quadratic in the wavefunction (e.g., $|\\Psi|^2$ or expectation values $\\langle \\Psi | \\hat{O} | \\Psi \\rangle$), be single-valued. This allows the wavefunction itself to be multi-valued, specifically by a phase factor. If $|\\Psi\\rangle \\to e^{i\\theta} |\\Psi\\rangle$, then $\\langle \\Psi | \\hat{O} | \\Psi \\rangle \\to \\langle e^{i\\theta}\\Psi | \\hat{O} | e^{i\\theta}\\Psi \\rangle = e^{-i\\theta}e^{i\\theta} \\langle \\Psi | \\hat{O} | \\Psi \\rangle = \\langle \\Psi | \\hat{O} | \\Psi \\rangle$. For a $2\\pi$ rotation, the phase can be $(-1)^{2J}$, which can be $+1$ (integer $J$) or $-1$ (half-integer $J$). Both are physically permissible in principle. The choice between them depends on the intrinsic nature of the system. Systems that do not contain intrinsic half-integer spin components (like pure rotors, systems of bosons) are described by integer $J$ representations of the rotation group, which are true representations of $SO(3)$. Systems containing intrinsic half-integer spin components (fermions) are described by half-integer $J$ representations, which are projective representations of $SO(3)$ but true representations of its universal cover, $SU(2)$.\n\nWith this background, we evaluate each option.\n\n**A. Quantizing the rigid rotor on $SO(3)$ with wavefunctions required to be single-valued on $SO(3)$ implies that only integer $L$ representations occur; states that change sign under a $2\\pi$ rotation are excluded for the pure rotor.**\nThe configuration space for the orientation of a rigid body is indeed $SO(3)$. A rotation of $2\\pi$ corresponds to the identity element in $SO(3)$. If we impose the strict boundary condition that the wavefunction $\\Psi$ must be single-valued on this space, then $\\Psi$ must be invariant under a $2\\pi$ rotation. As derived above, a state of angular momentum $L$ acquires a factor of $(-1)^{2L}$ under a $2\\pi$ rotation. For this factor to be $+1$, $2L$ must be an even integer, which means $L$ must be an integer ($L=0, 1, 2, \\dots$). States that change sign (i.e., acquire a factor of $-1$) correspond to half-integer $L$, which are thus excluded. For a \"pure rotor\" (a system with no intrinsic spin, modeling, for example, an even-even nucleus), this single-valuedness condition on the spatial wavefunction is the appropriate physical choice. Therefore, this statement is a correct description of the standard quantization of a simple rigid rotor.\n**Verdict: Correct.**\n\n**B. Quantizing the rotor on $SU(2)$ and imposing single-valuedness on $SU(2)$ yields physically observable half-integer $L$ spectra for even–even nuclear rotors, because $SU(2)$ admits half-integer representations.**\nWhile it is true that $SU(2)$ is the universal covering group and its single-valued representations correspond to both integer and half-integer angular momenta, applying this to an even-even nucleus is physically incorrect. Even-even nuclei are systems of paired nucleons (bosonic character) and lack an unpaired fermion to provide an intrinsic half-integer spin. Experimentally, the rotational spectra of even-even nuclei consist of states with integer total angular momentum ($J=0, 2, 4, \\dots$). The physical configuration space is $SO(3)$, and there is no physical justification to allow for wavefunctions that are double-valued on $SO(3)$ (i.e., half-integer angular momentum states) for such systems. Thus, the conclusion that this procedure \"yields physically observable half-integer $L$ spectra\" is contrary to experimental fact and theoretical understanding for even-even nuclei.\n**Verdict: Incorrect.**\n\n**C. In the particle–rotor model with one intrinsic fermion of spin $s=\\frac{1}{2}$, the total angular momentum $J$ can be half-integer even though the rotor’s $L$ is integer; the reason is that under a $2\\pi$ rotation the intrinsic fermion contributes a factor of $-1$, which is compatible with physical observables being quadratic in the state.**\nThis statement accurately describes the situation in an odd nucleus. The total angular momentum is the vector sum of the collective orbital angular momentum of the rotor ($\\mathbf{L}$) and the intrinsic spin of the unpaired fermion ($\\mathbf{s}$), so $\\mathbf{J} = \\mathbf{L} + \\mathbf{s}$. Since $\\mathbf{L}$ is associated with spatial rotation its quantum number $L$ must be an integer ($0, 1, 2, \\dots$), while for a fermion $s=1/2, 3/2, \\dots$. For $s=1/2$, the rules of angular momentum addition ($|L-s| \\le J \\le L+s$) dictate that $J$ must be a half-integer. The reason provided is also correct. The total wavefunction is approximately a product of the rotor part and the intrinsic fermion part. Under a $2\\pi$ rotation of the entire system, the rotor part (integer $L$) gains a phase factor of $(-1)^{2L}=+1$, while the fermion spin part (spinor) gains a factor of $(-1)^{2s}=-1$. The total wavefunction thus acquires a factor of $-1$. This is physically permissible because all observables, like probabilities $|\\Psi|^2$ and expectation values $\\langle \\Psi | \\hat{O} | \\Psi \\rangle$, are unchanged by this sign flip.\n**Verdict: Correct.**\n\n**D. The emergence of half-integer $L$ in odd-nucleus particle–rotor models is explained by a nontrivial second homotopy group $\\pi_2(SO(3))=\\mathbb{Z}_2$, which classifies projective representations relevant to nuclear rotation.**\nThis statement contains multiple fundamental errors. First, it is the total angular momentum $J$ that is half-integer in odd nuclei, not the collective orbital angular momentum $L$. Second, the topological feature of $SO(3)$ that permits projective (double-valued) representations corresponding to half-integer spin is its non-trivial *first* homotopy group, $\\pi_1(SO(3)) = \\mathbb{Z}_2$. This group describes the inequivalent classes of closed loops in the space; the non-trivial class corresponds to a $2\\pi$ rotation. Third, the *second* homotopy group of any Lie group, including $SO(3)$, is trivial: $\\pi_2(SO(3)) = 0$. The statement specifies the wrong homotopy group and gives it a wrong, non-trivial value.\n**Verdict: Incorrect.**\n\n**E. In numerical diagonalization on Euler angles $(\\alpha,\\beta,\\gamma)$ using Wigner $\\mathcal{D}$-function expansions, single-valuedness on $SO(3)$ requires integer Fourier modes for both $M$ and $K$. When an intrinsic spin-$\\frac{1}{2}$ is included, the total projection $K$ can be half-integer, and one can implement this by an antiperiodic boundary condition under $\\gamma \\to \\gamma + 2\\pi$, which produces rotational bands with half-integer $J$ in odd nuclei.**\nThis statement correctly describes the practical implementation and its consequences. The Wigner function is $\\mathcal{D}^J_{MK}(\\alpha,\\beta,\\gamma) = e^{-iM\\alpha} d^J_{MK}(\\beta) e^{-iK\\gamma}$.\n1.  For a pure rotor, the wavefunction must be single-valued in the Euler angles, requiring periodicity of $2\\pi$. The factors $e^{-iM\\alpha}$ and $e^{-iK\\gamma}$ enforce that $M$ (projection on the space-fixed z-axis) and $K$ (projection on the body-fixed z'-axis) must be integers. This part is correct.\n2.  When an intrinsic spin is coupled, the total angular momentum is $\\mathbf{J} = \\mathbf{L} + \\mathbf{s}$. The projection on the body-fixed axis is $K = K_R + \\Omega$, where $K_R$ is the projection of $\\mathbf{L}$ (integer) and $\\Omega$ is the projection of $\\mathbf{s}$. For a spin-$1/2$ fermion, $\\Omega$ is half-integer ($\\pm 1/2, \\dots$), making the total projection $K$ a half-integer. This part is correct.\n3.  If $K$ is a half-integer, the term $e^{-iK\\gamma}$ becomes antiperiodic under $\\gamma \\to \\gamma + 2\\pi$: $e^{-iK(\\gamma+2\\pi)} = e^{-iK\\gamma}e^{-iK2\\pi} = e^{-iK\\gamma}(-1)^{2K} = -e^{-iK\\gamma}$ since $2K$ is odd. This is precisely an antiperiodic boundary condition and is the correct way to implement the physics of the coupled fermion. This part is correct.\n4.  This framework, with half-integer $K$ values, is exactly what is used in the particle-rotor model to calculate the properties of odd nuclei. The resulting eigenstates form rotational bands built on a band-head $K$, with total angular momentum values $J=K, K+1, K+2, \\dots$, which are all half-integers if $K$ is a half-integer. This correctly describes the observed spectra.\nThe entire statement is a correct and coherent summary of the computational model.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}