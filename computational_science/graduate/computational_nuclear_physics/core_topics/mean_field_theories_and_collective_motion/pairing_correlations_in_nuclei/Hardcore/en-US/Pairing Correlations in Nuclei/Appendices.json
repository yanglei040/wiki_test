{
    "hands_on_practices": [
        {
            "introduction": "Pairing correlations in nuclei have direct and measurable consequences, one of the most prominent being the systematic staggering of binding energies between nuclei with even and odd numbers of neutrons or protons. This exercise provides a tangible connection between the theoretical concept of a pairing gap and this key experimental observable . By analyzing real experimental mass data for a chain of tin isotopes, you will derive and compute the three-point odd-even staggering indicator, $\\Delta^{(3)}_n$, and investigate how the strength of neutron pairing changes as neutrons are added to the nucleus.",
            "id": "3578204",
            "problem": "A central quantitative signature of pairing correlations in finite nuclei is the odd-even staggering of binding energies along an isotopic chain. In the independent-particle picture augmented by pairing correlations as in Bardeen–Cooper–Schrieffer (BCS) theory, the magnitude of this staggering is closely related to the pairing gap. One of the most commonly used local estimators of this effect is the three-point neutron odd-even indicator constructed from a discrete second difference of the nuclear binding energy along fixed proton number.\n\nStart from the definition of the nuclear binding energy for a nuclide with proton number $Z$ and neutron number $N$,\n$$\nB(Z,N) \\equiv Z m_{p} c^{2} + N m_{n} c^{2} - M_{\\mathrm{nuc}}(Z,N) c^{2},\n$$\nand the definition of the atomic mass excess energy\n$$\n\\Delta_{\\mathrm{ME}}(Z,N) \\equiv \\left(M_{a}(Z,N) - A\\,u\\right)c^{2},\n$$\nwhere $M_{\\mathrm{nuc}}$ is the nuclear mass, $M_{a}$ is the atomic mass, $A \\equiv Z+N$ is the mass number, $u$ is the atomic mass unit, $m_{p}$ and $m_{n}$ are the proton and neutron masses, and $c$ is the speed of light. Assume throughout that, for second differences at fixed $Z$, the contributions from atomic electrons and their binding energies cancel to high accuracy, so that atomic masses can be used in place of nuclear masses for these differences.\n\nYou are provided with measured atomic mass excess energies (in $\\mathrm{MeV}$) for tin (Sn, $Z=50$) isotopes:\n- $^{116}\\mathrm{Sn}$ ($Z=50$, $N=66$): $\\Delta_{\\mathrm{ME}} = -89.464$\n- $^{117}\\mathrm{Sn}$ ($Z=50$, $N=67$): $\\Delta_{\\mathrm{ME}} = -87.668$\n- $^{118}\\mathrm{Sn}$ ($Z=50$, $N=68$): $\\Delta_{\\mathrm{ME}} = -89.100$\n- $^{119}\\mathrm{Sn}$ ($Z=50$, $N=69$): $\\Delta_{\\mathrm{ME}} = -87.348$\n- $^{120}\\mathrm{Sn}$ ($Z=50$, $N=70$): $\\Delta_{\\mathrm{ME}} = -88.800$\n- $^{121}\\mathrm{Sn}$ ($Z=50$, $N=71$): $\\Delta_{\\mathrm{ME}} = -87.044$\n- $^{122}\\mathrm{Sn}$ ($Z=50$, $N=72$): $\\Delta_{\\mathrm{ME}} = -88.468$\n- $^{123}\\mathrm{Sn}$ ($Z=50$, $N=73$): $\\Delta_{\\mathrm{ME}} = -86.660$\n- $^{124}\\mathrm{Sn}$ ($Z=50$, $N=74$): $\\Delta_{\\mathrm{ME}} = -88.008$\n\nTasks:\n- Using only fundamental definitions, derive the expression for the odd-$N$ three-point neutron odd-even staggering indicator as a discrete second difference of $B(Z,N)$ and then rewrite it entirely in terms of the provided $\\Delta_{\\mathrm{ME}}(Z,N)$ values. Use only odd $N$ values to characterize neutron pairing, and explain the sign choice that makes this quantity positive for odd $N$.\n- Compute this indicator for the odd-$N$ tin isotopes with $N \\in \\{67,69,71,73\\}$.\n- Quantify the trend of neutron pairing with neutron number by the endpoint finite-difference slope\n$$\nm \\equiv \\frac{\\Delta_{n,\\mathrm{odd}}^{(3)}(Z=50,N=73) - \\Delta_{n,\\mathrm{odd}}^{(3)}(Z=50,N=67)}{73-67}.\n$$\n\nExpress the final slope $m$ in $\\mathrm{MeV}$ per neutron, and round your answer to three significant figures.",
            "solution": "The problem requires the derivation and calculation of a nuclear physics quantity, the three-point neutron odd-even staggering indicator, and an analysis of its trend.\n\n### Part 1: Derivation of the Odd-Even Staggering Indicator\n\nThe three-point neutron odd-even staggering indicator for an odd neutron number $N$, which we denote as $\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N)$, is constructed from a discrete second difference of the nuclear binding energy $B(Z,N)$ at fixed proton number $Z$. The three points involved are for neutron numbers $N-1$, $N$, and $N+1$. Since $N$ is odd, $N-1$ and $N+1$ are even.\n\nThe physical phenomenon of odd-even staggering means that nuclei with an even number of neutrons are more tightly bound (have a larger binding energy) than their adjacent odd-neutron counterparts. This implies that for an odd $N$, the binding energy $B(Z,N)$ is smaller than the arithmetic mean of the binding energies of its even-$N$ neighbors, $B(Z,N-1)$ and $B(Z,N+1)$. Mathematically,\n$$\nB(Z,N)  \\frac{B(Z,N-1) + B(Z,N+1)}{2}\n$$\nThe indicator $\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N)$ is defined to quantify this difference and is chosen to be a positive quantity. We can define it as the difference between the average binding energy of the neighbors and the binding energy of the odd-$N$ nucleus:\n$$\n\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N) = \\frac{B(Z,N-1) + B(Z,N+1)}{2} - B(Z,N)\n$$\nThis expression can be rewritten as a symmetric, discrete second difference of $B(Z,N)$:\n$$\n\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N) = \\frac{1}{2} \\left[ B(Z,N-1) - 2B(Z,N) + B(Z,N+1) \\right]\n$$\nThis choice of sign for the second difference ensures that $\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N)$ is positive for odd $N$, reflecting the energy gain due to pairing in the even-$N$ systems.\n\nNext, we rewrite this expression in terms of the atomic mass excess energy, $\\Delta_{\\mathrm{ME}}(Z,N)$. We start with the definition of the binding energy:\n$$\nB(Z,N) = Z m_{p} c^{2} + N m_{n} c^{2} - M_{\\mathrm{nuc}}(Z,N) c^{2}\n$$\nThe problem states that for second differences at fixed $Z$, the contributions from atomic electrons and their binding energies cancel. This allows us to replace the nuclear mass $M_{\\mathrm{nuc}}(Z,N)$ with the atomic mass $M_{a}(Z,N)$. Let's consider the quantity inside the brackets of our expression for $\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N)$:\n$$\nB(Z,N-1) - 2B(Z,N) + B(Z,N+1)\n$$\nSubstituting the expression for $B(Z,N)$ (with $M_a$ replacing $M_{\\mathrm{nuc}}$):\n\\begin{align*}\n \\left[ Z m_{p} c^{2} + (N-1) m_{n} c^{2} - M_{a}(Z,N-1) c^{2} \\right] \\\\\n-  2\\left[ Z m_{p} c^{2} + N m_{n} c^{2} - M_{a}(Z,N) c^{2} \\right] \\\\\n+  \\left[ Z m_{p} c^{2} + (N+1) m_{n} c^{2} - M_{a}(Z,N+1) c^{2} \\right]\n\\end{align*}\nThe terms involving the proton mass $m_p$ sum to $(1-2+1) Z m_{p} c^{2} = 0$. The terms involving the neutron mass $m_n$ sum to $((N-1) - 2N + (N+1)) m_{n} c^{2} = 0$. The remaining terms are:\n$$\n-M_{a}(Z,N-1) c^{2} + 2M_{a}(Z,N) c^{2} - M_{a}(Z,N+1) c^{2}\n$$\nSo, the indicator becomes:\n$$\n\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N) = \\frac{1}{2} \\left[ -M_{a}(Z,N-1)c^2 + 2M_{a}(Z,N)c^2 - M_{a}(Z,N+1)c^2 \\right]\n$$\nNow we use the definition of the atomic mass excess energy, $\\Delta_{\\mathrm{ME}}(Z,N) = \\left(M_{a}(Z,N) - A\\,u\\right)c^{2}$, where $A=Z+N$. This can be rearranged to express the atomic mass energy:\n$$\nM_{a}(Z,N)c^{2} = \\Delta_{\\mathrm{ME}}(Z,N) + (Z+N)uc^{2}\n$$\nSubstituting this into our expression for $\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N)$:\n$$\n\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N) = \\frac{1}{2} \\left[ -(\\Delta_{\\mathrm{ME}}(Z,N-1) + (Z+N-1)uc^2) + 2(\\Delta_{\\mathrm{ME}}(Z,N) + (Z+N)uc^2) - (\\Delta_{\\mathrm{ME}}(Z,N+1) + (Z+N+1)uc^2) \\right]\n$$\nLet's examine the terms proportional to $uc^2$:\n$$\n-(Z+N-1) + 2(Z+N) - (Z+N+1) = -Z-N+1 + 2Z+2N -Z-N-1 = ( -1+2-1)Z + (-1+2-1)N + (1-1) = 0\n$$\nThese terms also cancel. We are left with the final expression for the indicator in terms of mass excesses:\n$$\n\\Delta_{n,\\mathrm{odd}}^{(3)}(Z,N) = \\frac{1}{2} \\left[ -\\Delta_{\\mathrm{ME}}(Z,N-1) + 2\\Delta_{\\mathrm{ME}}(Z,N) - \\Delta_{\\mathrm{ME}}(Z,N+1) \\right]\n$$\n\n### Part 2: Calculation of the Indicator for Tin Isotopes\n\nWe now compute $\\Delta_{n,\\mathrm{odd}}^{(3)}(Z=50,N)$ for $N \\in \\{67, 69, 71, 73\\}$ using the derived formula and the provided data for Sn ($Z=50$) isotopes. All $\\Delta_{\\mathrm{ME}}$ values are in MeV.\n\nFor $N=67$:\n$$\n\\Delta_{n,\\mathrm{odd}}^{(3)}(50,67) = \\frac{1}{2} \\left[ -\\Delta_{\\mathrm{ME}}(50,66) + 2\\Delta_{\\mathrm{ME}}(50,67) - \\Delta_{\\mathrm{ME}}(50,68) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ -(-89.464) + 2(-87.668) - (-89.100) \\right] = \\frac{1}{2} \\left[ 89.464 - 175.336 + 89.100 \\right] = \\frac{3.228}{2} = 1.614 \\, \\mathrm{MeV}\n$$\n\nFor $N=69$:\n$$\n\\Delta_{n,\\mathrm{odd}}^{(3)}(50,69) = \\frac{1}{2} \\left[ -\\Delta_{\\mathrm{ME}}(50,68) + 2\\Delta_{\\mathrm{ME}}(50,69) - \\Delta_{\\mathrm{ME}}(50,70) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ -(-89.100) + 2(-87.348) - (-88.800) \\right] = \\frac{1}{2} \\left[ 89.100 - 174.696 + 88.800 \\right] = \\frac{3.204}{2} = 1.602 \\, \\mathrm{MeV}\n$$\n\nFor $N=71$:\n$$\n\\Delta_{n,\\mathrm{odd}}^{(3)}(50,71) = \\frac{1}{2} \\left[ -\\Delta_{\\mathrm{ME}}(50,70) + 2\\Delta_{\\mathrm{ME}}(50,71) - \\Delta_{\\mathrm{ME}}(50,72) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ -(-88.800) + 2(-87.044) - (-88.468) \\right] = \\frac{1}{2} \\left[ 88.800 - 174.088 + 88.468 \\right] = \\frac{3.180}{2} = 1.590 \\, \\mathrm{MeV}\n$$\n\nFor $N=73$:\n$$\n\\Delta_{n,\\mathrm{odd}}^{(3)}(50,73) = \\frac{1}{2} \\left[ -\\Delta_{\\mathrm{ME}}(50,72) + 2\\Delta_{\\mathrm{ME}}(50,73) - \\Delta_{\\mathrm{ME}}(50,74) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ -(-88.468) + 2(-86.660) - (-88.008) \\right] = \\frac{1}{2} \\left[ 88.468 - 173.320 + 88.008 \\right] = \\frac{3.156}{2} = 1.578 \\, \\mathrm{MeV}\n$$\n\n### Part 3: Calculation of the Trend (Slope)\n\nThe trend of neutron pairing is quantified by the finite-difference slope $m$ between the endpoints of our calculated range of $N$:\n$$\nm = \\frac{\\Delta_{n,\\mathrm{odd}}^{(3)}(Z=50,N=73) - \\Delta_{n,\\mathrm{odd}}^{(3)}(Z=50,N=67)}{73-67}\n$$\nSubstituting the values calculated above:\n$$\nm = \\frac{1.578 \\, \\mathrm{MeV} - 1.614 \\, \\mathrm{MeV}}{73-67} = \\frac{-0.036 \\, \\mathrm{MeV}}{6} = -0.006 \\, \\mathrm{MeV} \\text{ per neutron}\n$$\nThe problem requires this answer to be rounded to three significant figures. In scientific notation, this is $-6.00 \\times 10^{-3}$ MeV per neutron.",
            "answer": "$$\\boxed{-6.00 \\times 10^{-3}}$$"
        },
        {
            "introduction": "After observing the phenomenological evidence for pairing, we now turn to the microscopic formalism that describes it. The Hartree-Fock-Bogoliubov (HFB) theory provides the fundamental framework, but its full complexity can be daunting. This practice demystifies the HFB equations by applying them to a minimal two-level \"toy model\" that is analytically solvable . By working through this simplified case, you will perform a first-principles derivation of key concepts like quasiparticle energies, Bogoliubov coherence factors ($u$ and $v$), and the self-consistent pairing gap $\\Delta$, building a solid conceptual foundation for more advanced applications.",
            "id": "3578196",
            "problem": "Consider a minimal Hartree–Fock–Bogoliubov (HFB) model for pairing correlations in a finite nucleus with two single-particle levels at energies $+\\epsilon$ and $-\\epsilon$ measured relative to the chemical potential, each with pair degeneracy $\\Omega$ (counting the number of time-reversed pairs available per level). Assume a constant monopole pairing interaction of strength $G$ acting uniformly among time-reversed pairs across the two levels, zero temperature, and mid-shell occupancy such that the chemical potential is pinned by symmetry. Neglect any Hartree–Fock mean-field shifts and focus solely on the pairing field. Work in the canonical basis where each level couples only to its time-reversed partner. \n\nStarting from the standard Hartree–Fock–Bogoliubov (HFB) variational principle and the definitions of the normal and anomalous densities, set up the self-consistent HFB equations for this two-level system. Then, solve them analytically to obtain the quasiparticle energies and the Bogoliubov coherence factors (the amplitudes $u$ and $v$ for each level). You should impose the physically relevant nontrivial paired solution with $\\Delta0$, and you may assume the strong-pairing regime $G \\Omega  \\epsilon$ so that the gap is real. Choose the convention in which all $u$ and $v$ are non-negative real numbers. Express your final results in closed form in terms of $\\epsilon$, $G$, and $\\Omega$.\n\nReport your final answer as a single row matrix containing, in order, the quasiparticle energies for the $+\\epsilon$ and $-\\epsilon$ levels, followed by the corresponding coherence factors $u$ and $v$ for the $+\\epsilon$ level, and then $u$ and $v$ for the $-\\epsilon$ level. No numerical evaluation or rounding is required, and you should provide symbolic expressions only.",
            "solution": "The user has provided a valid problem statement.\n\nThe problem asks for the solution of the Hartree–Fock–Bogoliubov (HFB) equations for a simplified two-level pairing model. The HFB theory describes a system of fermions in terms of independent quasiparticles, which are superpositions of particles and holes. The HFB equation, in its most general form, is an eigenvalue problem for the HFB Hamiltonian matrix.\n\nThe system consists of $2$ single-particle levels with energies $\\epsilon_1 = -\\epsilon$ and $\\epsilon_2 = +\\epsilon$ relative to the chemical potential $\\mu$. The problem states that the chemical potential is pinned by symmetry, which, for this symmetric level configuration, implies $\\mu=0$. Each level has a pair degeneracy of $\\Omega$.\n\nThe HFB Hamiltonian matrix for a single state $k$ and its time-reversed partner $\\bar{k}$ in the canonical basis (where the single-particle Hamiltonian $h$ and the pairing field $\\Delta$ are diagonal) is:\n$$\n\\mathcal{H}_{k} = \\begin{pmatrix} h_k - \\mu  \\Delta_k \\\\ -\\Delta_k^*  -(h_{\\bar{k}}^* - \\mu) \\end{pmatrix}\n$$\nThe problem specifies that Hartree–Fock mean-field shifts are neglected, so the single-particle Hamiltonian $h$ is simply the diagonal matrix of single-particle energies, $h_k = \\epsilon_k$. We are also told to assume a constant monopole pairing, which implies the pairing gap $\\Delta_k = \\Delta$ is a single real, positive value, uniform for all states. With $\\mu=0$, the HFB matrix for a level $i$ becomes:\n$$\n\\mathcal{H}_{i} = \\begin{pmatrix} \\epsilon_i  \\Delta \\\\ -\\Delta  -\\epsilon_i \\end{pmatrix}\n$$\nThe HFB equation is the eigenvalue equation for this matrix:\n$$\n\\begin{pmatrix} \\epsilon_i  \\Delta \\\\ -\\Delta  -\\epsilon_i \\end{pmatrix}\n\\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix}\n= E_i\n\\begin{pmatrix} u_i \\\\ v_i \\end{pmatrix}\n$$\nHere, $E_i$ is the quasiparticle energy for the level $i$, and $(u_i, v_i)$ are the Bogoliubov coherence factors, which form the eigenvector. These factors are subject to the normalization condition $u_i^2 + v_i^2 = 1$. The convention is chosen such that $u_i \\ge 0$ and $v_i \\ge 0$.\n\nThe eigenvalues $E_i$ are found by solving the characteristic equation:\n$$\n\\det(\\mathcal{H}_{i} - E_i \\mathbf{I}) = \\det\\begin{pmatrix} \\epsilon_i - E_i  \\Delta \\\\ -\\Delta  -\\epsilon_i - E_i \\end{pmatrix} = 0\n$$\n$$\n-(\\epsilon_i - E_i)(\\epsilon_i + E_i) + \\Delta^2 = 0\n$$\n$$\nE_i^2 - \\epsilon_i^2 + \\Delta^2 = 0 \\implies E_i^2 = \\epsilon_i^2 + \\Delta^2\n$$\nSince quasiparticle energies are defined as non-negative, we have:\n$$\nE_i = \\sqrt{\\epsilon_i^2 + \\Delta^2}\n$$\nThe coherence factors $u_i$ and $v_i$ can be determined from the eigenvalue equation and the normalization condition. A standard result from HFB theory gives:\n$$\nu_i^2 = \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_i}{E_i} \\right) \\quad \\text{and} \\quad v_i^2 = \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_i}{E_i} \\right)\n$$\nGiven the convention that $u_i$ and $v_i$ are non-negative, we take the positive square roots.\n\nThe pairing gap $\\Delta$ must be determined self-consistently. For a monopole pairing interaction of strength $G$, the gap equation is:\n$$\n\\Delta = G \\sum_{k} \\langle c_{\\bar{k}} c_k \\rangle = G \\sum_{k} u_k v_k\n$$\nwhere the sum runs over all available single-particle states that can form pairs. In our model, each of the $2$ levels has a pair degeneracy $\\Omega$. Thus, the sum is over the two levels, each weighted by $\\Omega$:\n$$\n\\Delta = G\\Omega \\left( u_1 v_1 + u_2 v_2 \\right)\n$$\nwhere the indices $1$ and $2$ correspond to the levels with energies $\\epsilon_1 = -\\epsilon$ and $\\epsilon_2 = +\\epsilon$, respectively.\n\nLet's calculate the product $u_i v_i$:\n$$\nu_i v_i = \\sqrt{\\frac{1}{4} \\left( 1 + \\frac{\\epsilon_i}{E_i} \\right) \\left( 1 - \\frac{\\epsilon_i}{E_i} \\right)} = \\sqrt{\\frac{1}{4} \\left( 1 - \\frac{\\epsilon_i^2}{E_i^2} \\right)} = \\frac{1}{2} \\sqrt{\\frac{E_i^2 - \\epsilon_i^2}{E_i^2}}\n$$\nSubstituting $E_i^2 = \\epsilon_i^2 + \\Delta^2$, we get:\n$$\nu_i v_i = \\frac{1}{2} \\sqrt{\\frac{\\Delta^2}{E_i^2}} = \\frac{\\Delta}{2E_i}\n$$\nsince we have chosen the nontrivial solution with $\\Delta  0$.\n\nNow, we substitute this into the gap equation:\n$$\n\\Delta = G\\Omega \\left( \\frac{\\Delta}{2E_1} + \\frac{\\Delta}{2E_2} \\right)\n$$\nThe quasiparticle energies for our two levels are:\n$$\nE_1 = \\sqrt{\\epsilon_1^2 + \\Delta^2} = \\sqrt{(-\\epsilon)^2 + \\Delta^2} = \\sqrt{\\epsilon^2 + \\Delta^2}\n$$\n$$\nE_2 = \\sqrt{\\epsilon_2^2 + \\Delta^2} = \\sqrt{(+\\epsilon)^2 + \\Delta^2} = \\sqrt{\\epsilon^2 + \\Delta^2}\n$$\nSo, $E_1 = E_2 = E = \\sqrt{\\epsilon^2 + \\Delta^2}$.\nThe gap equation simplifies to:\n$$\n\\Delta = G\\Omega \\left( \\frac{\\Delta}{2E} + \\frac{\\Delta}{2E} \\right) = G\\Omega \\frac{\\Delta}{E}\n$$\nWe are looking for the nontrivial solution where $\\Delta  0$, so we can divide both sides by $\\Delta$:\n$$\n1 = \\frac{G\\Omega}{E} \\implies E = G\\Omega\n$$\nThis provides a direct expression for the quasiparticle energy, which is the same for both levels.\nThus, the quasiparticle energies for both the $+\\epsilon$ and $-\\epsilon$ levels are $E_{+\\epsilon} = E_{-\\epsilon} = G\\Omega$.\n\nNow we can determine the value of the pairing gap $\\Delta$ by relating our two expressions for $E$:\n$$\nE = \\sqrt{\\epsilon^2 + \\Delta^2} = G\\Omega\n$$\nSquaring both sides:\n$$\n\\epsilon^2 + \\Delta^2 = (G\\Omega)^2 \\implies \\Delta^2 = (G\\Omega)^2 - \\epsilon^2\n$$\nThe problem assumes the strong-pairing regime, $G\\Omega  \\epsilon$, which ensures that $(G\\Omega)^2 - \\epsilon^2  0$ and $\\Delta$ is real. We take the positive root as required:\n$$\n\\Delta = \\sqrt{(G\\Omega)^2 - \\epsilon^2}\n$$\nFinally, we compute the coherence factors for each level using $E = G\\Omega$.\n\nFor the level at $+\\epsilon$ (let's denote its factors as $u_{+\\epsilon}, v_{+\\epsilon}$), we have $\\epsilon_i = +\\epsilon$ and $E_i = G\\Omega$:\n$$ u_{+\\epsilon} = \\sqrt{\\frac{1}{2} \\left( 1 + \\frac{\\epsilon}{G\\Omega} \\right)} $$\n$$ v_{+\\epsilon} = \\sqrt{\\frac{1}{2} \\left( 1 - \\frac{\\epsilon}{G\\Omega} \\right)} $$\n\nFor the level at $-\\epsilon$ (let's denote its factors as $u_{-\\epsilon}, v_{-\\epsilon}$), we have $\\epsilon_i = -\\epsilon$ and $E_i = G\\Omega$:\n$$ u_{-\\epsilon} = \\sqrt{\\frac{1}{2} \\left( 1 + \\frac{-\\epsilon}{G\\Omega} \\right)} = \\sqrt{\\frac{1}{2} \\left( 1 - \\frac{\\epsilon}{G\\Omega} \\right)} $$\n$$ v_{-\\epsilon} = \\sqrt{\\frac{1}{2} \\left( 1 - \\frac{-\\epsilon}{G\\Omega} \\right)} = \\sqrt{\\frac{1}{2} \\left( 1 + \\frac{\\epsilon}{G\\Omega} \\right)} $$\nThese expressions are well-defined, real, and non-negative due to the condition $G\\Omega  \\epsilon$ and the convention of taking the positive square root.\n\nThe results are summarized as follows:\n- Quasiparticle energy for level $+\\epsilon$: $E_{+\\epsilon} = G\\Omega$\n- Quasiparticle energy for level $-\\epsilon$: $E_{-\\epsilon} = G\\Omega$\n- Coherence factors for level $+\\epsilon$: $u_{+\\epsilon} = \\sqrt{\\frac{1}{2} \\left(1 + \\frac{\\epsilon}{G\\Omega}\\right)}$ and $v_{+\\epsilon} = \\sqrt{\\frac{1}{2} \\left(1 - \\frac{\\epsilon}{G\\Omega}\\right)}$\n- Coherence factors for level $-\\epsilon$: $u_{-\\epsilon} = \\sqrt{\\frac{1}{2} \\left(1 - \\frac{\\epsilon}{G\\Omega}\\right)}$ and $v_{-\\epsilon} = \\sqrt{\\frac{1}{2} \\left(1 + \\frac{\\epsilon}{G\\Omega}\\right)}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nG\\Omega  G\\Omega  \\sqrt{\\frac{1}{2} \\left(1 + \\frac{\\epsilon}{G\\Omega}\\right)}  \\sqrt{\\frac{1}{2} \\left(1 - \\frac{\\epsilon}{G\\Omega}\\right)}  \\sqrt{\\frac{1}{2} \\left(1 - \\frac{\\epsilon}{G\\Omega}\\right)}  \\sqrt{\\frac{1}{2} \\left(1 + \\frac{\\epsilon}{G\\Omega}\\right)}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Building on the foundational Bardeen-Cooper-Schrieffer (BCS) theory, this practice moves into a more realistic and computationally intensive domain relevant to modern nuclear physics. In weakly bound nuclei near the particle drip-lines, the coupling to the continuum of unbound states can significantly modify properties like pairing correlations. This hands-on coding exercise tasks you with implementing a numerical solution to the BCS equations for a model space that explicitly includes both discrete bound levels and near-threshold continuum states . By quantifying the difference in the pairing gap with and without the continuum, you will gain direct insight into the physics of exotic nuclei and develop practical skills in solving self-consistent many-body problems.",
            "id": "3578223",
            "problem": "You are to implement and analyze a reduced pairing model for finite nuclei that distinguishes between bound single-particle levels and near-threshold continuum levels. The computational task is to derive from first principles the canonical occupation numbers and the contributions to the anomalous density per level, then to quantitatively compare how bound states versus near-threshold continuum states affect pairing correlations. Use a representation in which discrete single-particle levels with energies are provided and degeneracies account for the number of time-reversed pairs. The basic setup, rooted in a standard reduced pairing Hamiltonian and the Bardeen–Cooper–Schrieffer (BCS) variational ansatz, is as follows.\n\nStart from a finite set of single-particle levels with energies $\\{\\epsilon_i\\}$ measured relative to the particle-emission threshold (continuum threshold at $0$). Levels with $\\epsilon_i  0$ are bound, while near-threshold continuum levels satisfy $0 \\le \\epsilon_i \\le E_{\\mathrm{cut}}$. Each level carries a degeneracy $\\{d_i\\}$ that counts the available time-reversed pairs. The chemical potential $\\lambda$ is fixed. The interaction is a constant pairing of strength $G$ that acts among included levels. The computation must be performed in units of megaelectronvolts (MeV) for all energies, and all outputs that are energies must be expressed in $\\mathrm{MeV}$.\n\nFrom the reduced pairing Hamiltonian and the Bardeen–Cooper–Schrieffer (BCS) ansatz, derive logically and implement the following, without relying on any provided shortcut formulas in the problem statement:\n- The quasiparticle energies $E_i$ as functions of $\\epsilon_i$, $\\lambda$, and the pairing gap $\\Delta$.\n- The canonical occupation numbers $v_i^2$ for each level $i$.\n- The level-wise anomalous density contributions $\\kappa_i$ for each level $i$.\n- The self-consistent pairing gap $\\Delta$ obtained by minimizing the BCS energy subject to particle-number conservation for the fixed $\\lambda$ and $G$ over the included levels.\n\nFor each test case specified below, do the following computations twice: once including both bound and near-threshold continuum levels, and once excluding the continuum (that is, including bound levels only). Use the same fixed $\\lambda$ in both computations. Then, quantify:\n1. The fraction of the total anomalous density arising from bound states, defined as the sum of $d_i \\kappa_i$ over bound states divided by the sum of $d_i \\kappa_i$ over all included states.\n2. The fraction of the total anomalous density arising from near-threshold continuum states, defined analogously over $0 \\le \\epsilon_i \\le E_{\\mathrm{cut}}$.\n3. The self-consistent pairing gap including continuum, $\\Delta_{\\mathrm{full}}$ (in $\\mathrm{MeV}$).\n4. The self-consistent pairing gap excluding continuum, $\\Delta_{\\mathrm{bound}}$ (in $\\mathrm{MeV}$).\n5. The difference $\\Delta_{\\mathrm{full}} - \\Delta_{\\mathrm{bound}}$ (in $\\mathrm{MeV}$).\n6. The sum of canonical occupations in the continuum region, $\\sum_{\\mathrm{cont}} d_i v_i^2$, computed using $\\Delta_{\\mathrm{full}}$.\n\nImportant numerical conventions and edge cases:\n- If the pairing strength is insufficient to produce a nonzero $\\Delta$ in the chosen finite space, report $\\Delta = 0$ and set anomalous density fractions to $0$.\n- All energies are in $\\mathrm{MeV}$. Fractions are dimensionless. Canonical occupation sums are dimensionless counts.\n- Angles are not used; do not introduce them.\n- Do not use percentages; when a fraction is needed, it must be returned as a decimal number.\n\nTest suite:\n- Test case $1$ (moderate pairing, balanced bound and continuum):\n  - Single-particle energies $\\{\\epsilon_i\\}$ in $\\mathrm{MeV}$: $\\{-6.0, -4.0, -2.0, -0.8, 0.2, 0.5, 1.0, 1.8\\}$.\n  - Degeneracies $\\{d_i\\}$: $\\{2, 4, 2, 6, 2, 4, 2, 2\\}$.\n  - Chemical potential $\\lambda$ in $\\mathrm{MeV}$: $-1.2$.\n  - Pairing strength $G$ in $\\mathrm{MeV}$: $0.35$.\n  - Continuum cutoff $E_{\\mathrm{cut}}$ in $\\mathrm{MeV}$: $2.0$.\n\n- Test case $2$ (near-drip line, strong continuum influence):\n  - Single-particle energies $\\{\\epsilon_i\\}$ in $\\mathrm{MeV}$: $\\{-2.0, -1.0, -0.3, 0.05, 0.2, 0.35, 0.6\\}$.\n  - Degeneracies $\\{d_i\\}$: $\\{4, 2, 6, 2, 4, 2, 4\\}$.\n  - Chemical potential $\\lambda$ in $\\mathrm{MeV}$: $-0.1$.\n  - Pairing strength $G$ in $\\mathrm{MeV}$: $0.30$.\n  - Continuum cutoff $E_{\\mathrm{cut}}$ in $\\mathrm{MeV}$: $1.0$.\n\n- Test case $3$ (weak pairing, likely trivial solution):\n  - Single-particle energies $\\{\\epsilon_i\\}$ in $\\mathrm{MeV}$: $\\{-5.0, -3.0, -1.5, 0.8, 1.6, 2.0\\}$.\n  - Degeneracies $\\{d_i\\}$: $\\{2, 4, 2, 2, 2, 4\\}$.\n  - Chemical potential $\\lambda$ in $\\mathrm{MeV}$: $-2.0$.\n  - Pairing strength $G$ in $\\mathrm{MeV}$: $0.15$.\n  - Continuum cutoff $E_{\\mathrm{cut}}$ in $\\mathrm{MeV}$: $2.0$.\n\nFinal output specification:\n- Your program must produce a single line of output that aggregates the results for all test cases into a comma-separated list enclosed in square brackets, where each test case contributes its own list of six numbers in the order described above. For example, the output must look like $[[x_{11},x_{12},x_{13},x_{14},x_{15},x_{16}],[x_{21},x_{22},x_{23},x_{24},x_{25},x_{26}],[x_{31},x_{32},x_{33},x_{34},x_{35},x_{36}]]$, with all energies expressed in $\\mathrm{MeV}$ and the fractions and occupation sums as decimal numbers.",
            "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\nThe problem provides the following data and definitions for a reduced pairing model in nuclear physics:\n\n- **Model Space:** A finite set of single-particle levels, each specified by an energy $\\epsilon_i$ and a degeneracy $d_i$.\n  - The energy $\\epsilon_i$ is measured relative to the continuum threshold, which is at $0$ $\\mathrm{MeV}$.\n  - Bound levels are defined by $\\epsilon_i  0$.\n  - Near-threshold continuum levels are defined by $0 \\le \\epsilon_i \\le E_{\\mathrm{cut}}$.\n  - The degeneracy $d_i$ represents the number of available time-reversed pairs for a level with energy $\\epsilon_i$.\n- **Model Parameters:**\n  - Chemical potential: $\\lambda$ (fixed for each test case).\n  - Pairing strength: $G$ (constant for all pairs).\n- **Required Derivations:** The following quantities must be derived from the reduced pairing Hamiltonian and the Bardeen–Cooper–Schrieffer (BCS) variational ansatz:\n  1. Quasiparticle energies $E_i$.\n  2. Canonical occupation numbers $v_i^2$.\n  3. Level-wise anomalous density contributions $\\kappa_i$.\n  4. The self-consistent pairing gap equation for $\\Delta$.\n- **Required Computations:** For each test case, two calculations are needed: one including all levels (bound and continuum, denoted 'full'), and one including only bound levels (denoted 'bound'). The following six quantities must be reported:\n  1. `frac_bound`: Fraction of total anomalous density from bound states, $(\\sum_{i \\in \\text{bound}} d_i \\kappa_i) / (\\sum_{i \\in \\text{full}} d_i \\kappa_i)$.\n  2. `frac_cont`: Fraction of total anomalous density from near-threshold continuum states, $(\\sum_{i \\in \\text{cont}} d_i \\kappa_i) / (\\sum_{i \\in \\text{full}} d_i \\kappa_i)$.\n  3. `Delta_full`: Self-consistent pairing gap $\\Delta$ for the full calculation.\n  4. `Delta_bound`: Self-consistent pairing gap $\\Delta$ for the bound-only calculation.\n  5. `Delta_diff`: The difference $\\Delta_{\\mathrm{full}} - \\Delta_{\\mathrm{bound}}$.\n  6. `sum_cont_occ`: The sum of canonical occupations in the continuum, $\\sum_{i \\in \\text{cont}} d_i v_i^2$, using $\\Delta_{\\mathrm{full}}$.\n- **Numerical Conventions:**\n  - All energies are in units of $\\mathrm{MeV}$.\n  - If a non-trivial solution for the gap $\\Delta$ does not exist, $\\Delta = 0$ must be reported, and anomalous density fractions are $0$.\n- **Test Case 1:**\n  - $\\{\\epsilon_i\\}$: $\\{-6.0, -4.0, -2.0, -0.8, 0.2, 0.5, 1.0, 1.8\\}$ in $\\mathrm{MeV}$.\n  - $\\{d_i\\}$: $\\{2, 4, 2, 6, 2, 4, 2, 2\\}$.\n  - $\\lambda = -1.2$ $\\mathrm{MeV}$.\n  - $G = 0.35$ $\\mathrm{MeV}$.\n  - $E_{\\mathrm{cut}} = 2.0$ $\\mathrm{MeV}$.\n- **Test Case 2:**\n  - $\\{\\epsilon_i\\}$: $\\{-2.0, -1.0, -0.3, 0.05, 0.2, 0.35, 0.6\\}$ in $\\mathrm{MeV}$.\n  - $\\{d_i\\}$: $\\{4, 2, 6, 2, 4, 2, 4\\}$.\n  - $\\lambda = -0.1$ $\\mathrm{MeV}$.\n  - $G = 0.30$ $\\mathrm{MeV}$.\n  - $E_{\\mathrm{cut}} = 1.0$ $\\mathrm{MeV}$.\n- **Test Case 3:**\n  - $\\{\\epsilon_i\\}$: $\\{-5.0, -3.0, -1.5, 0.8, 1.6, 2.0\\}$ in $\\mathrm{MeV}$.\n  - $\\{d_i\\}$: $\\{2, 4, 2, 2, 2, 4\\}$.\n  - $\\lambda = -2.0$ $\\mathrm{MeV}$.\n  - $G = 0.15$ $\\mathrm{MeV}$.\n  - $E_{\\mathrm{cut}} = 2.0$ $\\mathrm{MeV}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded:** The problem is based on the Bardeen-Cooper-Schrieffer (BCS) theory of superconductivity, as applied to nuclear pairing correlations. The reduced pairing Hamiltonian, the BCS variational state, and the resulting gap equation are standard and foundational concepts in nuclear structure theory. The distinction between bound and continuum states is a critical aspect of modern nuclear physics, particularly for nuclei near the particle drip lines. The problem is scientifically sound.\n- **Well-Posed:** The problem provides all necessary inputs ($G$, $\\lambda$, and the set of levels $\\{\\epsilon_i, d_i\\}$) for each calculation. The task is to solve a self-consistent equation for the pairing gap $\\Delta$. This equation has a well-defined structure, admitting either a trivial solution ($\\Delta=0$) or a unique non-trivial solution ($\\Delta0$) under specific conditions. The problem statement correctly specifies the procedure for the case of a trivial solution. All requested output quantities are uniquely determined by the model parameters. The problem is well-posed.\n- **Objective:** The problem is stated in precise, quantitative, and technical language. The descriptive phrases (\"moderate pairing\", \"near-drip line\") serve as physically motivated context for the parameter sets but do not introduce subjectivity into the calculations. The problem is objective.\n\nThe problem does not exhibit any of the listed flaws (e.g., factual unsoundness, incompleteness, contradiction, or ambiguity). The required derivations are standard bookwork in many-body theory, and the computational task is a direct application of these principles.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\nThe solution proceeds by first deriving the essential equations of the BCS model from first principles, as requested, and then outlining the numerical algorithm to solve these equations for the specified test cases.\n\n**Theoretical Derivation**\n\nThe system is described by a reduced pairing Hamiltonian, which includes a single-particle term and a constant pairing interaction term acting within a specified set of single-particle levels. To determine the ground-state properties, we seek to minimize the expectation value of the grand potential operator $\\hat{K} = \\hat{H} - \\lambda \\hat{N}$, where $\\hat{H}$ is the Hamiltonian, $\\hat{N}$ is the particle number operator, and $\\lambda$ is the chemical potential.\nThe Hamiltonian is given by $\\hat{H} = \\sum_{i} \\epsilon_i \\hat{n}_i - G \\sum_{i,j} \\hat{P}_i^\\dagger \\hat{P}_j$, where $\\hat{n}_i$ is the number operator for level $i$, and $\\hat{P}_i^\\dagger$ creates a pair of particles in time-reversed states within level $i$. The degeneracy $d_i$ indicates that there are $d_i$ such pairs of states at energy $\\epsilon_i$.\n\nThe variational ground state is the BCS state $|\\Psi_{\\mathrm{BCS}}\\rangle = \\prod_{i} \\prod_{\\alpha=1}^{d_i} (u_i + v_i c_{i\\alpha\\uparrow}^\\dagger c_{i\\alpha\\downarrow}^\\dagger)|0\\rangle$. Due to the degeneracy, all $d_i$ sub-levels at energy $\\epsilon_i$ share the same occupation amplitudes $u_i$ and $v_i$, which are real, non-negative, and satisfy the normalization condition $u_i^2 + v_i^2 = 1$.\n\nThe expectation value of the grand potential is:\n$$\n\\langle \\hat{K} \\rangle = \\langle \\Psi_{\\mathrm{BCS}} | \\hat{H} - \\lambda \\hat{N} | \\Psi_{\\mathrm{BCS}} \\rangle\n$$\nThe expectation values of the number operator and single-particle Hamiltonian are:\n$$\n\\langle \\hat{N} \\rangle = \\sum_i 2 d_i v_i^2\n$$\n$$\n\\langle \\hat{H}_{\\mathrm{sp}} \\rangle = \\sum_i 2 d_i \\epsilon_i v_i^2\n$$\nThe expectation value of the pairing term, in the standard mean-field approximation, is:\n$$\n\\langle \\hat{H}_{\\mathrm{pair}} \\rangle \\approx -G \\left( \\sum_i d_i u_i v_i \\right)^2\n$$\nWe define the pairing gap $\\Delta$ as:\n$$\n\\Delta = G \\sum_i d_i u_i v_i\n$$\nso that $\\langle \\hat{H}_{\\mathrm{pair}} \\rangle = -\\Delta^2/G$.\nThe total grand potential energy is:\n$$\nE_{\\mathrm{BCS}} = \\langle \\hat{K} \\rangle = \\sum_i 2 d_i (\\epsilon_i - \\lambda) v_i^2 - \\frac{\\Delta^2}{G} = \\sum_i 2 d_i (\\epsilon_i - \\lambda) v_i^2 - G \\left( \\sum_j d_j v_j \\sqrt{1 - v_j^2} \\right)^2\n$$\nWe minimize $E_{\\mathrm{BCS}}$ with respect to each $v_i$ by setting the partial derivative to zero: $\\frac{\\partial E_{\\mathrm{BCS}}}{\\partial v_i} = 0$.\n$$\n\\frac{\\partial E_{\\mathrm{BCS}}}{\\partial v_i} = 4 d_i (\\epsilon_i - \\lambda) v_i - 2 G \\left( \\sum_j d_j u_j v_j \\right) d_i \\left( \\frac{u_i^2 - v_i^2}{u_i} \\right) = 0\n$$\nSubstituting $\\Delta = G \\sum_j d_j u_j v_j$ yields:\n$$\n4 d_i (\\epsilon_i - \\lambda) v_i - 2 \\Delta d_i \\frac{u_i^2 - v_i^2}{u_i} = 0\n$$\n$$\n2 (\\epsilon_i - \\lambda) u_i v_i - \\Delta (u_i^2 - v_i^2) = 0\n$$\nThis fundamental equation relates the variational parameters for each level. We solve for $v_i^2$ and $u_i v_i$. Let $E_i = \\sqrt{(\\epsilon_i - \\lambda)^2 + \\Delta^2}$. This is the **quasiparticle energy**. Rearranging the equation gives $2 (\\epsilon_i - \\lambda) u_i v_i = \\Delta (u_i^2 - v_i^2)$. Squaring both sides and using $u_i^2+v_i^2=1$ leads to expressions for the occupation probabilities $v_i^2$ and $u_i^2$:\n$$\nv_i^2 = \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_i - \\lambda}{E_i} \\right)\n$$\nThis is the **canonical occupation number** for level $i$. Correspondingly, $u_i^2 = 1 - v_i^2 = \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_i - \\lambda}{E_i} \\right)$.\n\nThe **level-wise anomalous density contribution**, $\\kappa_i$, is the expectation value $\\langle c_{i\\downarrow} c_{i\\uparrow} \\rangle$, which evaluates to $\\kappa_i = u_i v_i$. From the expressions for $u_i^2$ and $v_i^2$:\n$$\n\\kappa_i^2 = u_i^2 v_i^2 = \\frac{1}{4} \\left( 1 - \\frac{(\\epsilon_i - \\lambda)^2}{E_i^2} \\right) = \\frac{1}{4} \\frac{E_i^2 - (\\epsilon_i - \\lambda)^2}{E_i^2} = \\frac{\\Delta^2}{4E_i^2}\n$$\nSince $u_i,v_i \\ge 0$, we take the positive root:\n$$\n\\kappa_i = u_i v_i = \\frac{\\Delta}{2E_i} = \\frac{\\Delta}{2 \\sqrt{(\\epsilon_i - \\lambda)^2 + \\Delta^2}}\n$$\nFinally, substituting this expression for $\\kappa_i$ back into the definition of $\\Delta$ yields the self-consistent **gap equation**:\n$$\n\\Delta = G \\sum_i d_i \\kappa_i = G \\sum_i d_i \\frac{\\Delta}{2 \\sqrt{(\\epsilon_i - \\lambda)^2 + \\Delta^2}}\n$$\nThis equation has a trivial solution $\\Delta = 0$. If $\\Delta \\neq 0$, we can divide by $\\Delta$ to obtain the non-trivial gap equation:\n$$\n1 = \\frac{G}{2} \\sum_i \\frac{d_i}{\\sqrt{(\\epsilon_i - \\lambda)^2 + \\Delta^2}}\n$$\nA non-trivial solution for $\\Delta  0$ exists if and only if the right-hand side, evaluated at $\\Delta \\to 0^+$, is greater than $1$. That is, if $\\frac{G}{2} \\sum_i \\frac{d_i}{|\\epsilon_i - \\lambda|}  1$.\n\n**Algorithmic Implementation**\n\nThe computational procedure follows from the derived equations.\n1.  **Define Levels:** For each test case, the provided sets of $\\{\\epsilon_i\\}$ and $\\{d_i\\}$ are used to define two model spaces:\n    - The 'full' space, including all levels where $\\epsilon_i \\le E_{\\mathrm{cut}}$.\n    - The 'bound' space, including only levels where $\\epsilon_i  0$.\n2.  **Solve for the Gap $\\Delta$:** A function is implemented to solve the gap equation for a given set of levels, $G$, and $\\lambda$.\n    - It first checks the condition for a non-trivial solution. If $\\frac{G}{2} \\sum_i \\frac{d_i}{|\\epsilon_i - \\lambda|} \\le 1$, the function returns $\\Delta=0$.\n    - Otherwise, a numerical root-finding algorithm (such as the Brent-Dekker method) is used to find the unique positive root $\\Delta$ of the equation $f(\\Delta) = \\frac{G}{2} \\sum_i \\frac{d_i}{\\sqrt{(\\epsilon_i - \\lambda)^2 + \\Delta^2}} - 1 = 0$.\n3.  **Compute Quantities:** For each test case, the process is:\n    a. Call the gap-solving function to compute $\\Delta_{\\mathrm{full}}$ using the 'full' level space.\n    b. Call the gap-solving function to compute $\\Delta_{\\mathrm{bound}}$ using the 'bound' level space.\n    c. If $\\Delta_{\\mathrm{full}} = 0$, the anomalous density is zero everywhere. Consequently, `frac_bound` and `frac_cont` are both $0$.\n    d. If $\\Delta_{\\mathrm{full}}  0$:\n        - For each level $i$ in the 'full' space, compute the anomalous density contribution $\\kappa_i = \\Delta_{\\mathrm{full}} / (2 \\sqrt{(\\epsilon_i - \\lambda)^2 + \\Delta_{\\mathrm{full}}^2})$.\n        - Calculate the total anomalous density from bound states, $K_{\\mathrm{bound}} = \\sum_{i \\in \\text{bound}} d_i \\kappa_i$.\n        - Calculate the total anomalous density from continuum states, $K_{\\mathrm{cont}} = \\sum_{i \\in \\text{cont}} d_i \\kappa_i$.\n        - The total anomalous density is $K_{\\mathrm{total}} = K_{\\mathrm{bound}} + K_{\\mathrm{cont}}$.\n        - The required fractions are then `frac_bound` $= K_{\\mathrm{bound}}/K_{\\mathrm{total}}$ and `frac_cont` $= K_{\\mathrm{cont}}/K_{\\mathrm{total}}$.\n    e. Compute the sum of canonical occupations in the continuum. For each level $i$ in the continuum space ($0 \\le \\epsilon_i \\le E_{\\mathrm{cut}}$), calculate $v_i^2 = \\frac{1}{2} (1 - (\\epsilon_i - \\lambda) / \\sqrt{(\\epsilon_i - \\lambda)^2 + \\Delta_{\\mathrm{full}}^2})$ and sum the total occupation `sum_cont_occ` $= \\sum_{i \\in \\text{cont}} d_i v_i^2$. If $\\Delta_{\\mathrm{full}}=0$, this simplifies to a step function determined by the sign of $\\epsilon_i - \\lambda$.\n    f. Assemble the six required quantities: `frac_bound`, `frac_cont`, $\\Delta_{\\mathrm{full}}$, $\\Delta_{\\mathrm{bound}}$, $(\\Delta_{\\mathrm{full}} - \\Delta_{\\mathrm{bound}})$, and `sum_cont_occ`.\n4.  **Final Output:** The results for all test cases are collected and formatted into a single string as specified.",
            "answer": "```python\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the nuclear pairing problem for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"epsilons\": np.array([-6.0, -4.0, -2.0, -0.8, 0.2, 0.5, 1.0, 1.8]),\n            \"degeneracies\": np.array([2, 4, 2, 6, 2, 4, 2, 2]),\n            \"lambda_\": -1.2,\n            \"G\": 0.35,\n            \"E_cut\": 2.0\n        },\n        {\n            \"epsilons\": np.array([-2.0, -1.0, -0.3, 0.05, 0.2, 0.35, 0.6]),\n            \"degeneracies\": np.array([4, 2, 6, 2, 4, 2, 4]),\n            \"lambda_\": -0.1,\n            \"G\": 0.30,\n            \"E_cut\": 1.0\n        },\n        {\n            \"epsilons\": np.array([-5.0, -3.0, -1.5, 0.8, 1.6, 2.0]),\n            \"degeneracies\": np.array([2, 4, 2, 2, 2, 4]),\n            \"lambda_\": -2.0,\n            \"G\": 0.15,\n            \"E_cut\": 2.0\n        }\n    ]\n\n    def solve_gap_equation(levels, G, lambda_):\n        \"\"\"\n        Solves the BCS gap equation for a given set of levels.\n        levels is astructured array with fields 'eps' and 'd'.\n        Returns the pairing gap Delta.\n        \"\"\"\n        if levels.size == 0:\n            return 0.0\n            \n        eps = levels['eps']\n        d = levels['d']\n        \n        # Denominator term at Delta=0\n        den_zero_delta = np.abs(eps - lambda_)\n        # Handle the case where epsilon_i = lambda, which gives a divergent sum.\n        # As per BCS theory, this implies an infinite pairing gap, but for this discrete model,\n        # it is sufficient to check if the sum is large. A small epsilon can be used.\n        if np.any(den_zero_delta  1e-12):\n             return np.inf # Practically, this will be handled by brentq finding a large root\n        \n        sum_term = np.sum(d / den_zero_delta)\n        \n        # Check condition for non-trivial solution\n        if 0.5 * G * sum_term = 1.0:\n            return 0.0\n\n        def gap_f(delta):\n            if delta  0: return np.nan\n            return 0.5 * G * np.sum(d / np.sqrt((eps - lambda_)**2 + delta**2)) - 1.0\n\n        try:\n            # Bracket the root. f(small_delta) > 0. f(large_delta)  0.\n            # A large_delta of 10 MeV is sufficient for typical nuclear physics problems.\n            delta_solution = optimize.brentq(gap_f, 1e-9, 10.0)\n            return delta_solution\n        except ValueError:\n            # Should not happen if the condition check passes and f is monotonic.\n            return 0.0\n\n    results = []\n    for case in test_cases:\n        epsilons = case[\"epsilons\"]\n        degeneracies = case[\"degeneracies\"]\n        lambda_ = case[\"lambda_\"]\n        G = case[\"G\"]\n        E_cut = case[\"E_cut\"]\n\n        # Define level structures (structured arrays for convenience)\n        level_dtype = [('eps', float), ('d', int)]\n        \n        full_mask = epsilons = E_cut\n        bound_mask = epsilons  0\n        continuum_mask = (epsilons >= 0)  (epsilons = E_cut)\n\n        levels_full = np.array(list(zip(epsilons[full_mask], degeneracies[full_mask])), dtype=level_dtype)\n        levels_bound = np.array(list(zip(epsilons[bound_mask], degeneracies[bound_mask])), dtype=level_dtype)\n        levels_continuum = np.array(list(zip(epsilons[continuum_mask], degeneracies[continuum_mask])), dtype=level_dtype)\n        \n        # Calculate gaps\n        delta_full = solve_gap_equation(levels_full, G, lambda_)\n        delta_bound = solve_gap_equation(levels_bound, G, lambda_)\n\n        # Calculate output quantities\n        if delta_full == 0.0:\n            frac_bound = 0.0\n            frac_cont = 0.0\n            sum_cont_occ = 0.0\n        else:\n            # Anomalous density kappa_i = Delta / (2 * E_i)\n            # Total anomalous density K = sum(d_i * kappa_i) = Delta/G\n            K_total = delta_full / G\n            \n            # Calculate K_bound\n            eps_b = levels_bound['eps']\n            d_b = levels_bound['d']\n            E_i_bound = np.sqrt((eps_b - lambda_)**2 + delta_full**2)\n            kappa_i_bound = delta_full / (2 * E_i_bound)\n            K_bound = np.sum(d_b * kappa_i_bound)\n            \n            # Calculate K_continuum\n            K_cont = 0.0\n            if len(levels_continuum) > 0:\n                eps_c = levels_continuum['eps']\n                d_c = levels_continuum['d']\n                E_i_cont = np.sqrt((eps_c - lambda_)**2 + delta_full**2)\n                kappa_i_cont = delta_full / (2 * E_i_cont)\n                K_cont = np.sum(d_c * kappa_i_cont)\n\n            frac_bound = K_bound / K_total if K_total > 0 else 0.0\n            frac_cont = K_cont / K_total if K_total > 0 else 0.0\n\n            # Sum of canonical occupations in continuum\n            sum_cont_occ = 0.0\n            if len(levels_continuum) > 0:\n                eps_c = levels_continuum['eps']\n                d_c = levels_continuum['d']\n                E_i_cont = np.sqrt((eps_c - lambda_)**2 + delta_full**2)\n                v_sq_cont = 0.5 * (1 - (eps_c - lambda_) / E_i_cont)\n                sum_cont_occ = np.sum(d_c * v_sq_cont)\n        \n        delta_diff = delta_full - delta_bound\n        \n        case_results = [frac_bound, frac_cont, delta_full, delta_bound, delta_diff, sum_cont_occ]\n        results.append(case_results)\n\n    # Format output as specified\n    output_str = \"[\" + \",\".join([f\"[{','.join(f'{x:.8f}' for x in res)}]\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}