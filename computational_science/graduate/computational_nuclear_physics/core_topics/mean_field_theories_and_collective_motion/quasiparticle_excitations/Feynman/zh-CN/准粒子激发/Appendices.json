{
    "hands_on_practices": [
        {
            "introduction": "配对能隙 $\\Delta$ 是超导电性和核超流性理论中的一个核心概念。本练习将指导您从第一性原理出发，推导出一个简化但功能强大的可分离相互作用下的 BCS 能隙方程。通过解析求解并分析其敏感性，您将对配对关联如何产生，以及它如何依赖于费米能级附近的状态密度等基本性质，获得深刻的定量理解，这是多体物理学中的一项基础性练习 ()。",
            "id": "3585386",
            "problem": "考虑在零温下由具有可分离相互作用的平均场 Bardeen–Cooper–Schrieffer (BCS) 配对描述的均匀中子物质。多体哈密顿量为\n$$\nH \\;=\\; \\sum_{k,\\sigma} \\xi_{k} \\, c^{\\dagger}_{k\\sigma} c_{k\\sigma} \\;+\\; \\sum_{k,k'} V_{kk'} \\, c^{\\dagger}_{k\\uparrow} c^{\\dagger}_{-k\\downarrow} c_{-k'\\downarrow} c_{k'\\uparrow},\n$$\n其中 $\\xi_{k} \\equiv \\varepsilon_{k} - \\mu$ 是相对于化学势 $\\mu$ 测量的单粒子能量，而 $V_{kk'}$ 是配对相互作用。假设一个可分离的吸引 s-波配对相互作用 $V_{kk'}=-G$，该相互作用仅在单粒子态满足 $|\\xi_{k}| \\le \\omega_{c}$ 时非零，其中 $\\omega_{c}$ 是一个源于有限程相互作用或模型空间的计算截断，在费米面附近具有物理动机的能量截断。在标准的 BCS 平均场退耦框架下进行计算，其中准粒子激发能为 $E_{k} = \\sqrt{\\xi_{k}^{2} + \\Delta^{2}}$，相干因子满足 $u_{k}^{2} = \\frac{1}{2}\\left(1 + \\frac{\\xi_{k}}{E_{k}}\\right)$，$v_{k}^{2} = \\frac{1}{2}\\left(1 - \\frac{\\xi_{k}}{E_{k}}\\right)$，以及 $u_{k} v_{k} = \\frac{\\Delta}{2 E_{k}}$，能隙序参量定义为 $\\Delta_{k} \\equiv -\\sum_{k'} V_{kk'} \\langle c_{-k'\\downarrow} c_{k'\\uparrow} \\rangle$。在这些假设下：\n\n- 从第一性原理推导零温能隙方程，并证明在给定可分离相互作用 $V_{kk'}=-G$ 和对称截断 $|\\xi_{k}| \\le \\omega_{c}$ 的条件下，能隙与动量无关，即 $\\Delta_{k} \\equiv \\Delta$。\n- 在连续谱极限下，使用单位自旋的态密度 $N(\\xi)$ 将动量求和替换为能量积分，并采用计算上常用的近似，即在截断范围内 $N(\\xi)\\approx N(0)$ 为常数。精确求解得到的积分方程，以获得常数能隙 $\\Delta$ 关于 $G$、$N(0)$ 和 $\\omega_{c}$ 的闭式解析表达式，不使用任何弱耦合近似。\n- 为量化对费米能级附近态密度的敏感度，定义对数敏感度 $S \\equiv \\frac{\\partial \\ln \\Delta}{\\partial \\ln N(0)}$，并用 $G$ 和 $N(0)$ 表示 $S$ 的闭式。基于你的表达式，简要解释在弱耦合极限下，该敏感度的行为，同时保持解析表达式的精确性。\n\n将最终答案表示为解析表达式。无需进行数值计算或四舍五入。",
            "solution": "该问题陈述是 Bardeen–Cooper–Schrieffer (BCS) 理论中的一个标准练习，在进行求解之前将对其进行验证。\n\n### 第 1 步：提取已知条件\n- **系统**：均匀中子物质，零温 ($T=0$)。\n- **模型**：具有可分离相互作用的平均场 BCS 配对。\n- **哈密顿量**：$H = \\sum_{k,\\sigma} \\xi_{k} c^{\\dagger}_{k\\sigma} c_{k\\sigma} + \\sum_{k,k'} V_{kk'} c^{\\dagger}_{k\\uparrow} c^{\\dagger}_{-k\\downarrow} c_{-k'\\downarrow} c_{k'\\uparrow}$。\n- **单粒子能量**：$\\xi_{k} \\equiv \\varepsilon_{k} - \\mu$，相对于化学势 $\\mu$ 测量。\n- **配对相互作用**：当 $|\\xi_{k}| \\le \\omega_{c}$ 且 $|\\xi_{k'}| \\le \\omega_{c}$ 时，$V_{kk'} = -G$；否则 $V_{kk'} = 0$。对于吸引相互作用，$G > 0$。$\\omega_c$ 是能量截断。\n- **BCS 平均场物理量**：\n    - 准粒子能量：$E_{k} = \\sqrt{\\xi_{k}^{2} + \\Delta^{2}}$。\n    - 相干因子：$u_{k}^{2} = \\frac{1}{2}\\left(1 + \\frac{\\xi_{k}}{E_{k}}\\right)$，$v_{k}^{2} = \\frac{1}{2}\\left(1 - \\frac{\\xi_{k}}{E_{k}}\\right)$，以及 $u_{k} v_{k} = \\frac{\\Delta}{2 E_{k}}$。\n    - 能隙序参量定义：$\\Delta_{k} \\equiv -\\sum_{k'} V_{kk'} \\langle c_{-k'\\downarrow} c_{k'\\uparrow} \\rangle$。\n- **近似**：\n    - 连续谱极限：$\\sum_{k} \\to \\int d\\xi N(\\xi)$，其中 $N(\\xi)$ 是单位自旋的态密度。\n    - 常数态密度：当 $|\\xi| \\le \\omega_c$ 时，$N(\\xi) \\approx N(0)$。\n- **定义**：\n    - 对数敏感度：$S \\equiv \\frac{\\partial \\ln \\Delta}{\\partial \\ln N(0)}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学基础**：该问题是 BCS 理论的一个基石性应用，BCS 理论是凝聚态物理和核物理中一个成熟的基础理论。哈密顿量、定义和假设（可分离势、常数态密度）是用于描述超导和超流的标准教科书模型。\n- **良态问题**：问题结构清晰，要求在所提供框架下进行特定的推导和表达式求解。这些假设导出了一个唯一的、可解的模型。\n- **客观性**：问题以精确的数学和物理术语陈述，没有歧义或主观论断。\n\n该问题没有表现出任何无效性缺陷：\n1. 它在科学上和事实上都是合理的。\n2. 这是一个可以形式化的问题，是准粒子激发这一主题的核心。\n3. 对于当前的任务，其设定是完整且一致的。\n4. 所要求的条件是多体物理学中的标准近似，并非物理上不可能。\n5. 其结构清晰，可以为所求物理量导出一个唯一的解。\n6. 这是一个非平凡的推导，需要对 BCS 理论的基本概念有深入的理解。\n7. 结果在理论物理的框架内是可验证的。\n\n### 第 3 步：结论与行动\n该问题是有效的。将提供完整的解答。\n\n### 解答\n\n根据问题陈述的要求，解答分为三个部分呈现。\n\n**第 1 部分：零温能隙方程的推导**\n\n我们从零温下依赖于动量的能隙参量 $\\Delta_{k}$ 的定义开始：\n$$\n\\Delta_{k} \\equiv -\\sum_{k'} V_{kk'} \\langle c_{-k'\\downarrow} c_{k'\\uparrow} \\rangle\n$$\n在 BCS 基态中（它是准粒子的真空态），对算符的期望值由 Bogoliubov 相干因子的乘积给出，即 $\\langle c_{-k'\\downarrow} c_{k'\\uparrow} \\rangle = u_{k'} v_{k'}$。问题提供了恒等式 $u_{k'} v_{k'} = \\frac{\\Delta_{k'}}{2 E_{k'}}$，其中 $E_{k'} = \\sqrt{\\xi_{k'}^{2} + \\Delta_{k'}^{2}}$ 是准粒子能量。将此代入 $\\Delta_{k}$ 的定义，得到能隙的自洽方程：\n$$\n\\Delta_{k} = -\\sum_{k'} V_{kk'} \\frac{\\Delta_{k'}}{2 E_{k'}} = -\\sum_{k'} V_{kk'} \\frac{\\Delta_{k'}}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta_{k'}^{2}}}\n$$\n现在，我们引入指定的可分离配对相互作用：$V_{kk'} = -G$（一个表示吸引的正数常数）当且仅当单粒子态 $k$ 和 $k'$ 都位于费米面附近的一个能量壳层 $\\omega_{c}$ 内，即 $|\\xi_{k}| \\le \\omega_{c}$ 且 $|\\xi_{k'}| \\le \\omega_{c}$。如果任一态处于该壳层之外，则 $V_{kk'} = 0$。\n\n我们来分析 $\\Delta_k$ 的方程。如果 $|\\xi_k| > \\omega_c$，那么对所有 $k'$ 都有 $V_{kk'} = 0$，这立即意味着 $\\Delta_k = 0$。如果 $|\\xi_k| \\le \\omega_c$，则对于所有满足 $|\\xi_{k'}| \\le \\omega_c$ 的 $k'$，相互作用为 $V_{kk'} = -G$，否则为 0。方程变为：\n$$\n\\Delta_{k} = - \\sum_{k' \\text{ s.t. } |\\xi_{k'}| \\le \\omega_{c}} (-G) \\frac{\\Delta_{k'}}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta_{k'}^{2}}} = G \\sum_{k' \\text{ s.t. } |\\xi_{k'}| \\le \\omega_{c}} \\frac{\\Delta_{k'}}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta_{k'}^{2}}}\n$$\n注意到该方程的右侧与动量 $k$ 无关。这迫使左侧的 $\\Delta_k$ 在相互作用窗口 $|\\xi_k| \\le \\omega_c$ 内对所有 $k$ 也为一个常数。我们将这个常数能隙记为 $\\Delta$。\n既然我们已经确定当 $|\\xi_k| \\le \\omega_c$ 时 $\\Delta_k = \\Delta$ 且当 $|\\xi_k| > \\omega_c$ 时 $\\Delta_k = 0$，我们可以将 $\\Delta_{k'} = \\Delta$ 代入求和式中，因为求和被限制在能隙为常数的区域内。这得到：\n$$\n\\Delta = G \\sum_{k' \\text{ s.t. } |\\xi_{k'}| \\le \\omega_{c}} \\frac{\\Delta}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta^{2}}}\n$$\n假设存在非平凡的超导/超流态（$\\Delta \\neq 0$），我们可以用 $\\Delta$ 除以方程两侧，得到零温能隙方程：\n$$\n1 = G \\sum_{k' \\text{ s.t. } |\\xi_{k'}| \\le \\omega_{c}} \\frac{1}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta^{2}}}\n$$\n这个推导证实了，对于给定的可分离相互作用，在活性（作用）能量窗口内，能隙确实与动量无关，即 $\\Delta_k \\equiv \\Delta$。\n\n**第 2 部分：能隙 $\\Delta$ 的解析解**\n\n为了求解能隙方程，我们转到连续谱极限，通过将分立动量态的求和替换为单粒子能量的积分。替换规则是 $\\sum_{k'} \\to \\int d\\xi' N(\\xi')$，其中 $N(\\xi')$ 是单位自旋的态密度。求和被限制在能量区间 $[-\\omega_c, \\omega_c]$。\n$$\n1 = G \\int_{-\\omega_c}^{\\omega_c} N(\\xi') \\frac{1}{2 \\sqrt{\\xi'^{2} + \\Delta^{2}}} d\\xi'\n$$\n问题指定使用在此窗口内态密度为常数的近似，即 $N(\\xi') \\approx N(0)$。\n$$\n1 = G N(0) \\int_{-\\omega_c}^{\\omega_c} \\frac{1}{2 \\sqrt{\\xi'^{2} + \\Delta^{2}}} d\\xi'\n$$\n被积函数是 $\\xi'$ 的偶函数，所以我们可以将积分写为：\n$$\n1 = \\frac{G N(0)}{2} \\cdot 2 \\int_{0}^{\\omega_c} \\frac{1}{\\sqrt{\\xi'^{2} + \\Delta^{2}}} d\\xi' = G N(0) \\int_{0}^{\\omega_c} \\frac{1}{\\sqrt{\\xi'^{2} + \\Delta^{2}}} d\\xi'\n$$\n这是一个标准积分：\n$$\n\\int \\frac{dx}{\\sqrt{x^2+a^2}} = \\arcsinh\\left(\\frac{x}{a}\\right) + C\n$$\n计算该定积分，我们得到：\n$$\n\\int_{0}^{\\omega_c} \\frac{d\\xi'}{\\sqrt{\\xi'^{2} + \\Delta^{2}}} = \\left[ \\arcsinh\\left(\\frac{\\xi'}{\\Delta}\\right) \\right]_{0}^{\\omega_c} = \\arcsinh\\left(\\frac{\\omega_c}{\\Delta}\\right) - \\arcsinh(0) = \\arcsinh\\left(\\frac{\\omega_c}{\\Delta}\\right)\n$$\n将此结果代回能隙方程，得到：\n$$\n1 = G N(0) \\arcsinh\\left(\\frac{\\omega_c}{\\Delta}\\right)\n$$\n对 $\\Delta$ 求解，给出所需的闭式解析表达式：\n$$\n\\arcsinh\\left(\\frac{\\omega_c}{\\Delta}\\right) = \\frac{1}{G N(0)} \\implies \\frac{\\omega_c}{\\Delta} = \\sinh\\left(\\frac{1}{G N(0)}\\right)\n$$\n$$\n\\Delta = \\frac{\\omega_{c}}{\\sinh\\left(\\frac{1}{G N(0)}\\right)}\n$$\n\n**第 3 部分：对数敏感度 $S$**\n\n能隙 $\\Delta$ 相对于费米能级处态密度 $N(0)$ 的对数敏感度定义为 $S \\equiv \\frac{\\partial \\ln \\Delta}{\\partial \\ln N(0)}$。为了计算它，我们首先对 $\\Delta$ 的表达式取自然对数：\n$$\n\\ln \\Delta = \\ln \\omega_c - \\ln\\left[\\sinh\\left(\\frac{1}{G N(0)}\\right)\\right]\n$$\n现在我们对 $\\ln \\Delta$ 关于 $\\ln N(0)$ 求导。使用链式法则，$S = \\frac{\\partial(\\ln \\Delta)}{\\partial N(0)} \\frac{\\partial N(0)}{\\partial(\\ln N(0))}$。由于 $\\frac{\\partial \\ln N(0)}{\\partial N(0)} = \\frac{1}{N(0)}$，第二项就是 $N(0)$。\n我们来计算第一项，$\\frac{\\partial(\\ln \\Delta)}{\\partial N(0)}$：\n$$\n\\frac{\\partial}{\\partial N(0)} (\\ln \\Delta) = 0 - \\frac{1}{\\sinh\\left(\\frac{1}{G N(0)}\\right)} \\cdot \\frac{\\partial}{\\partial N(0)}\\left[\\sinh\\left(\\frac{1}{G N(0)}\\right)\\right]\n$$\n$$\n= -\\frac{1}{\\sinh\\left(\\frac{1}{G N(0)}\\right)} \\cdot \\cosh\\left(\\frac{1}{G N(0)}\\right) \\cdot \\left(-\\frac{1}{G (N(0))^2}\\right)\n$$\n$$\n= \\frac{1}{G (N(0))^2} \\coth\\left(\\frac{1}{G N(0)}\\right)\n$$\n最后，我们计算 $S$：\n$$\nS = \\left[\\frac{1}{G (N(0))^2} \\coth\\left(\\frac{1}{G N(0)}\\right)\\right] \\cdot N(0)\n$$\n$$\nS = \\frac{1}{G N(0)} \\coth\\left(\\frac{1}{G N(0)}\\right)\n$$\n这是敏感度 $S$ 的精确闭式表达式。\n\n为了分析在弱耦合极限下的行为，我们考虑无量纲乘积 $G N(0) \\ll 1$ 的情况。在此极限下，双曲余切函数的自变量 $x = \\frac{1}{G N(0)}$ 变得非常大 ($x \\gg 1$)。$\\coth(x)$ 在 x 很大时的渐近行为是：\n$$\n\\coth(x) = \\frac{e^{x} + e^{-x}}{e^{x} - e^{-x}} = \\frac{1+e^{-2x}}{1-e^{-2x}} \\approx 1 \\quad \\text{for } x \\to \\infty\n$$\n因此，在弱耦合极限下，敏感度 $S$ 趋近于：\n$$\nS \\approx \\frac{1}{G N(0)}\n$$\n这个结果表明，随着耦合变弱，敏感度 $S$ 变得非常大。这意味着配对能隙 $\\Delta$ 对费米能级处态密度 $N(0)$ 的变化极其敏感。这种高敏感度是能隙非微扰性质的直接结果，即 $\\Delta \\propto \\exp\\left(-\\frac{1}{G N(0)}\\right)$，这是 BCS 机制的特征。输入参数 $N(0)$ 的微小变化会导致所得能隙成比例地大得多的变化。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\omega_{c}}{\\sinh\\left(\\frac{1}{G N(0)}\\right)}  \\frac{1}{G N(0)} \\coth\\left(\\frac{1}{G N(0)}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Bogoliubov 变换是将准粒子定义为粒子和空穴的叠加的数学引擎。本练习首先要求您推导变换矩阵 $U$ 和 $V$ 为保持系统的费米子性质而必须满足的基本幺正性条件。然后，您将在一个模型空间中通过数值实现 Hartree-Fock-Bogoliubov (HFB) 计算来验证这些关系，从而在抽象形式主义与具体计算实践之间建立起一座至关重要的桥梁，并观察当基不完备时这些关系是如何被破坏的 ()。",
            "id": "3585416",
            "problem": "考虑一个由费米子单粒子态构成的有限集合，这些态定义了一个大小为 $N$ 的离散谐振子基。令 $\\mathbf{a} = (a_0,\\dots,a_{N-1})^T$ 表示费米子湮灭算符矢量，$\\mathbf{a}^\\dagger$ 为相应的产生算符矢量，它们满足正则反对易关系 $\\{a_i,a_j^\\dagger\\} = \\delta_{ij}$，$\\{a_i,a_j\\} = 0$ 以及 $\\{a_i^\\dagger,a_j^\\dagger\\} = 0$。通过 Bogoliubov 变换定义一个准粒子基\n$$\n\\boldsymbol{\\gamma} = U^\\dagger \\mathbf{a} + V^\\dagger \\mathbf{a}^\\dagger,\n$$\n其中 $U$ 和 $V$ 是 $N\\times N$ 的复矩阵，$\\boldsymbol{\\gamma} = (\\gamma_0,\\dots,\\gamma_{N-1})^T$ 是准粒子湮灭算符，满足 $\\{\\gamma_k,\\gamma_l^\\dagger\\} = \\delta_{kl}$，$\\{\\gamma_k,\\gamma_l\\} = 0$ 以及 $\\{\\gamma_k^\\dagger,\\gamma_l^\\dagger\\} = 0$。从这些正则反对易关系和 Bogoliubov 变换的定义出发，推导完备性和正交归一性关系\n$$\nU^\\dagger U + V^\\dagger V = \\mathbb{1}, \\quad U^T V + V^T U = 0.\n$$\n你的推导必须清晰地标示出从正则反对易关系到这些矩阵恒等式的所有代数步骤。\n\n为了进行数值验证，请在一个离散谐振子基中构造一个 Hartree-Fock-Bogoliubov (HFB) 准粒子哈密顿量，其能级间距参数为 $\\hbar\\omega$（单位为兆电子伏特(MeV)）。设单粒子哈密顿量为对角矩阵，其能量为 $E_i = \\hbar\\omega\\,(i+1/2)$，其中 $i=0,1,\\dots,N-1$。选择化学势 $\\lambda$ 位于两个连续单粒子能级中间，以避免简并。定义一个实的对称对力场矩阵 $\\Delta$，其元为\n$$\n\\Delta_{ij} = g \\exp\\left(-\\frac{(i-j)^2}{2\\sigma^2}\\right),\n$$\n其中 $g$（单位为MeV）是对力强度，$\\sigma$ 是一个无量纲的力程参数。利用此，构建 Bogoliubov-de Gennes (BdG) 哈密顿量\n$$\n\\mathcal{H} = \\begin{pmatrix}\nh - \\lambda\\,\\mathbb{1}  \\Delta \\\\\n\\Delta  -(h - \\lambda\\,\\mathbb{1})\n\\end{pmatrix},\n$$\n其中 $h = \\mathrm{diag}(E_0,\\dots,E_{N-1})$。对角化 $\\mathcal{H}$ 以获得 $N$ 个正能量本征矢量。每个正能量本征矢量的形式为 $\\Psi_k = (u_k, v_k)^T$，其中 $u_k, v_k \\in \\mathbb{C}^N$。从这些列矢量组装矩阵 $U=[u_0,\\dots,u_{N-1}]$ 和 $V=[v_0,\\dots,v_{N-1}]$，并计算两个验证误差\n$$\n\\varepsilon_1 = \\left\\|U^\\dagger U + V^\\dagger V - \\mathbb{1}\\right\\|_F, \\quad \\varepsilon_2 = \\left\\|U^T V + V^T U\\right\\|_F,\n$$\n其中 $\\|\\cdot\\|_F$ 表示 Frobenius 范数。由于这些误差是无量纲的，它们的值无需指定物理单位。\n\n通过从 $U$ 和 $V$ 中人为移除一个准粒子列（即，舍弃最后一个正能量本征矢量）来对这些关系进行截断压力测试，并用这个截断后的集合重新计算相同的误差，这通常会破坏这些关系。此外，检验对谐振子基大小和对力强度的敏感性。\n\n在一个程序中实现该推导和数值验证，该程序无需任何用户输入，即可评估以下参数测试集：\n- 情况1（一般情况）：$N=8$，$\\hbar\\omega=8.0$ MeV，$g=1.5$ MeV，$\\sigma=1.5$，全正能量集。\n- 情况2（弱对力极限）：$N=8$，$\\hbar\\omega=8.0$ MeV，$g=10^{-6}$ MeV，$\\sigma=1.5$，全正能量集。\n- 情况3（强对力）：$N=8$，$\\hbar\\omega=8.0$ MeV，$g=6.0$ MeV，$\\sigma=1.5$，全正能量集。\n- 情况4（截断压力测试）：$N=8$，$\\hbar\\omega=8.0$ MeV，$g=1.5$ MeV，$\\sigma=1.5$，从 U 和 V 中舍弃最后一个正能量本征矢量的列。\n- 情况5（小基）：$N=4$，$\\hbar\\omega=8.0$ MeV，$g=1.5$ MeV，$\\sigma=1.0$，全正能量集。\n\n对每种情况，计算并以浮点数形式返回数对 $(\\varepsilon_1,\\varepsilon_2)$。你的程序应生成单行输出，其中按顺序列出十个结果，形式为方括号内以逗号分隔的列表，即：\n$[\\varepsilon_{1}^{(1)},\\varepsilon_{2}^{(1)},\\varepsilon_{1}^{(2)},\\varepsilon_{2}^{(2)},\\varepsilon_{1}^{(3)},\\varepsilon_{2}^{(3)},\\varepsilon_{1}^{(4)},\\varepsilon_{2}^{(4)},\\varepsilon_{1}^{(5)},\\varepsilon_{2}^{(5)}]$。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 第一步：提取已知条件\n- **定义**：\n  - 费米子湮灭和产生算符：$\\mathbf{a} = (a_0, \\dots, a_{N-1})^T$, $\\mathbf{a}^\\dagger$。\n  - 准粒子湮灭和产生算符：$\\boldsymbol{\\gamma} = (\\gamma_0, \\dots, \\gamma_{N-1})^T$, $\\boldsymbol{\\gamma}^\\dagger$。\n  - Bogoliubov 变换：$\\boldsymbol{\\gamma} = U^\\dagger \\mathbf{a} + V^\\dagger \\mathbf{a}^\\dagger$，其中 $U, V$ 是 $N \\times N$ 复矩阵。\n  - 单粒子哈密顿量：$h = \\mathrm{diag}(E_0, \\dots, E_{N-1})$，其中 $E_i = \\hbar\\omega(i+1/2)$。\n  - 对力场矩阵：$\\Delta_{ij} = g \\exp(-\\frac{(i-j)^2}{2\\sigma^2})$。\n  - Bogoliubov-de Gennes (BdG) 哈密顿量：$\\mathcal{H} = \\begin{pmatrix} h - \\lambda\\,\\mathbb{1}  \\Delta \\\\ \\Delta  -(h - \\lambda\\,\\mathbb{1}) \\end{pmatrix}$。\n  - HFB 本征矢量：$\\Psi_k = (u_k, v_k)^T$ 对应正能量，构成矩阵 $U=[u_0, \\dots, u_{N-1}]$ 和 $V=[v_0, \\dots, v_{N-1}]$。\n  - 验证误差：$\\varepsilon_1 = \\|U^\\dagger U + V^\\dagger V - \\mathbb{1}\\|_F$ 和 $\\varepsilon_2 = \\|U^T V + V^T U\\|_F$。\n- **正则反对易关系 (CARs)**：\n  - 对费米子：$\\{a_i, a_j^\\dagger\\} = \\delta_{ij}$, $\\{a_i, a_j\\} = 0$, $\\{a_i^\\dagger, a_j^\\dagger\\} = 0$。\n  - 对准粒子：$\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\delta_{kl}$, $\\{\\gamma_k, \\gamma_l\\} = 0$, $\\{\\gamma_k^\\dagger, \\gamma_l^\\dagger\\} = 0$。\n- **数值测试用例**：\n  1. $N=8$, $\\hbar\\omega=8.0$ MeV, $g=1.5$ MeV, $\\sigma=1.5$, 全集。\n  2. $N=8$, $\\hbar\\omega=8.0$ MeV, $g=10^{-6}$ MeV, $\\sigma=1.5$, 全集。\n  3. $N=8$, $\\hbar\\omega=8.0$ MeV, $g=6.0$ MeV, $\\sigma=1.5$, 全集。\n  4. $N=8$, $\\hbar\\omega=8.0$ MeV, $g=1.5$ MeV, $\\sigma=1.5$, 截断集。\n  5. $N=4$, $\\hbar\\omega=8.0$ MeV, $g=1.5$ MeV, $\\sigma=1.0$, 全集。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学基础**：该问题植根于标准的 Hartree-Fock-Bogoliubov (HFB) 理论，这是量子多体物理学（特别是核结构理论）的基石。Bogoliubov 变换、BdG 哈密顿量以及相关的矩阵关系都是标准且成熟的概念。\n- **良构性**：问题被完整详细地阐明。解析部分提出了一个标准的推导。数值部分提供了所有必要的参数（$N, \\hbar\\omega, g, \\sigma$）、所有矩阵（$h, \\Delta, \\mathcal{H}$）的明确形式，以及一个清晰的流程来获取感兴趣的量（从本征矢量得到 $U, V$）和验证误差（$\\varepsilon_1, \\varepsilon_2$）。化学势 $\\lambda$ 的选择也被明确指定。\n- **客观性**：问题使用精确、客观的数学和物理术语进行陈述。没有主观或基于观点的陈述。关于截断预期结果的定性评论（“通常会破坏这些关系”）是一个辅助性说明，并不影响明确且客观的计算任务。\n- **无其他缺陷**：该问题没有违反任何其他验证标准。它是可形式化的、与指定主题相关的、内部一致的，在 HFB 模型框架内是物理上合理的，并且并非无足轻重。\n\n### 第三步：结论与行动\n该问题是**有效的**。有必要提供一个完整的解决方案。\n\n### 解析推导\n目标是从原始粒子和准粒子的费米子性质出发，推导矩阵恒等式 $U^\\dagger U + V^\\dagger V = \\mathbb{1}$ 和 $U^T V + V^T U = 0$。\n\nBogoliubov 变换的分量形式为：\n$$\n\\gamma_k = \\sum_{i=0}^{N-1} (U_{ik}^* a_i + V_{ik}^* a_i^\\dagger)\n$$\n其厄米共轭算符为：\n$$\n\\gamma_k^\\dagger = \\left( \\sum_{i=0}^{N-1} (U_{ik}^* a_i + V_{ik}^* a_i^\\dagger) \\right)^\\dagger = \\sum_{i=0}^{N-1} (a_i^\\dagger U_{ik} + a_i V_{ik})\n$$\n原始算符 $a_i$ 和准粒子算符 $\\gamma_k$ 都是费米子，因此服从正则反对易关系 (CARs)。\n对于原始费米子：$\\{a_i, a_j^\\dagger\\} = \\delta_{ij}$，以及 $\\{a_i, a_j\\} = \\{a_i^\\dagger, a_j^\\dagger\\} = 0$。\n对于准粒子：$\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\delta_{kl}$，以及 $\\{\\gamma_k, \\gamma_l\\} = \\{\\gamma_k^\\dagger, \\gamma_l^\\dagger\\} = 0$。\n\n**1. 推导 $U^\\dagger U + V^\\dagger V = \\mathbb{1}$**\n我们计算反对易子 $\\{\\gamma_k, \\gamma_l^\\dagger\\}$ 并施加费米子条件。\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\left\\{ \\sum_i (U_{ik}^* a_i + V_{ik}^* a_i^\\dagger), \\sum_j (a_j^\\dagger U_{jl} + a_j V_{jl}) \\right\\}\n$$\n利用反对易子的双线性：\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\sum_{i,j} \\left( U_{ik}^* U_{jl} \\{a_i, a_j^\\dagger\\} + U_{ik}^* V_{jl} \\{a_i, a_j\\} + V_{ik}^* U_{jl} \\{a_i^\\dagger, a_j^\\dagger\\} + V_{ik}^* V_{jl} \\{a_i^\\dagger, a_j\\} \\right)\n$$\n代入 $a_i$ 算符的 CARs：\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\sum_{i,j} \\left( U_{ik}^* U_{jl} (\\delta_{ij}) + U_{ik}^* V_{jl} (0) + V_{ik}^* U_{jl} (0) + V_{ik}^* V_{jl} (\\delta_{ij}) \\right)\n$$\n由于克罗内克 $\\delta_{ij}$，对 $j$ 的求和得以简化：\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\sum_i (U_{ik}^* U_{il} + V_{ik}^* V_{il})\n$$\n第一项是 $\\sum_i (U^\\dagger)_{ki} U_{il} = (U^\\dagger U)_{kl}$，第二项是 $\\sum_i (V^\\dagger)_{ki} V_{il} = (V^\\dagger V)_{kl}$。因此：\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = (U^\\dagger U)_{kl} + (V^\\dagger V)_{kl} = (U^\\dagger U + V^\\dagger V)_{kl}\n$$\n施加准粒子的 CAR $\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\delta_{kl}$ 得到 $(U^\\dagger U + V^\\dagger V)_{kl} = \\delta_{kl}$。写成矩阵形式，这就是第一个所需的恒等式：\n$$\nU^\\dagger U + V^\\dagger V = \\mathbb{1}\n$$\n\n**2. 推导 $U^T V + V^T U = 0$**\n现在我们计算反对易子 $\\{\\gamma_k, \\gamma_l\\}$。\n$$\n\\{\\gamma_k, \\gamma_l\\} = \\left\\{ \\sum_i (U_{ik}^* a_i + V_{ik}^* a_i^\\dagger), \\sum_j (U_{jl}^* a_j + V_{jl}^* a_j^\\dagger) \\right\\}\n$$\n利用双线性展开：\n$$\n\\{\\gamma_k, \\gamma_l\\} = \\sum_{i,j} \\left( U_{ik}^* U_{jl}^* \\{a_i, a_j\\} + U_{ik}^* V_{jl}^* \\{a_i, a_j^\\dagger\\} + V_{ik}^* U_{jl}^* \\{a_i^\\dagger, a_j\\} + V_{ik}^* V_{jl}^* \\{a_i^\\dagger, a_j^\\dagger\\} \\right)\n$$\n代入 $a_i$ 算符的 CARs：\n$$\n\\{\\gamma_k, \\gamma_l\\} = \\sum_{i,j} \\left( U_{ik}^* U_{jl}^* (0) + U_{ik}^* V_{jl}^* (\\delta_{ij}) + V_{ik}^* U_{jl}^* (\\delta_{ij}) + V_{ik}^* V_{jl}^* (0) \\right)\n$$\n简化对 $j$ 的求和：\n$$\n\\{\\gamma_k, \\gamma_l\\} = \\sum_i (U_{ik}^* V_{il}^* + V_{ik}^* U_{il}^*)\n$$\n施加准粒子的 CAR $\\{\\gamma_k, \\gamma_l\\} = 0$，我们得到 $\\sum_i (U_{ik}^* V_{il}^* + V_{ik}^* U_{il}^*) = 0$。对该方程取复共轭得到：\n$$\n\\sum_i (U_{ik} V_{il} + V_{ik} U_{il}) = 0\n$$\n第一项是 $\\sum_i (U^T)_{ki} V_{il} = (U^T V)_{kl}$，第二项是 $\\sum_i (V^T)_{ki} U_{il} = (V^T U)_{kl}$。因此：\n$$\n(U^T V)_{kl} + (V^T U)_{kl} = 0\n$$\n这对所有 $k,l$ 都必须成立，从而给出第二个所需的矩阵恒等式：\n$$\nU^T V + V^T U = 0\n$$\n\n### 数值验证算法\n数值部分涉及为几个参数集构建和对角化 BdG 哈密顿量，以验证这些关系。\n\n1.  **构造矩阵**：对每个具有参数 $N$, $\\hbar\\omega$, $g$, 和 $\\sigma$ 的测试用例：\n    *   单粒子能量为 $E_i = \\hbar\\omega(i+1/2)$，其中 $i=0, \\dots, N-1$。这些构成单粒子哈密顿量 $h$ 的对角元。\n    *   化学势 $\\lambda$ 被设置在索引为 $\\lfloor N/2 \\rfloor-1$ 和 $\\lfloor N/2 \\rfloor$ 的单粒子能级之间，以避免费米面上的简并。\n    *   根据其定义 $\\Delta_{ij} = g \\exp(-\\frac{(i-j)^2}{2\\sigma^2})$ 构造对力矩阵 $\\Delta$。\n    *   按规定组装 $2N \\times 2N$ 的 BdG 哈密顿量 $\\mathcal{H}$。\n     由于 $h$ 和 $\\Delta$ 是实对称的，$\\mathcal{H}$ 是一个实对称矩阵。\n\n2.  **对角化**：使用标准的厄米矩阵数值算法（例如 `numpy.linalg.eigh`）对矩阵 $\\mathcal{H}$ 进行对角化。这将产生 $2N$ 个实本征值和相应的 $2N$ 个正交归一的实本征矢量。本征值成对出现，即 $\\pm E_k$。我们选择与 $N$ 个正本征值对应的 $N$ 个本征矢量。\n\n3.  **构成 U 和 V**：$N$ 个选定的本征矢量 $\\Psi_k$ 中的每一个都是一个 $2N$ 维矢量。前 $N$ 个分量构成一个列矢量 $u_k$，后 $N$ 个分量构成一个列矢量 $v_k$。通过将这 $N$ 个矢量 $u_k$ 和 $v_k$ 分别作为列来构造矩阵 $U$ 和 $V$：$U = [u_0, u_1, \\dots, u_{N-1}]$ 和 $V = [v_0, v_1, \\dots, v_{N-1}]$。\n\n4.  **处理截断**：对于截断测试用例，从 $U$ 和 $V$ 中都舍弃最后一列，得到大小为 $N \\times (N-1)$ 的矩阵。\n\n5.  **计算误差**：使用 Frobenius 范数计算两个验证误差 $\\varepsilon_1$ 和 $\\varepsilon_2$。\n    *   $\\varepsilon_1 = \\|U^\\dagger U + V^\\dagger V - \\mathbb{1}_K\\|_F$\n    *   $\\varepsilon_2 = \\|U^T V + V^T U\\|_F$\n    其中 $K$ 是准粒子态的数量（$U$ 和 $V$ 的列数），对于全集是 $N$，对于截断集是 $N-1$。由于本征矢量是实的，$U^\\dagger = U^T$ 且 $V^\\dagger = V^T$。\n\n此过程应用于五个测试用例中的每一个，并收集生成的数对 $(\\varepsilon_1, \\varepsilon_2)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the HFB validation for the specified test suite.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: General case\n        {'N': 8, 'hbar_omega': 8.0, 'g': 1.5, 'sigma': 1.5, 'truncate': False},\n        # Case 2: Weak pairing limit\n        {'N': 8, 'hbar_omega': 8.0, 'g': 1e-6, 'sigma': 1.5, 'truncate': False},\n        # Case 3: Strong pairing\n        {'N': 8, 'hbar_omega': 8.0, 'g': 6.0, 'sigma': 1.5, 'truncate': False},\n        # Case 4: Truncation stress-test\n        {'N': 8, 'hbar_omega': 8.0, 'g': 1.5, 'sigma': 1.5, 'truncate': True},\n        # Case 5: Small basis\n        {'N': 4, 'hbar_omega': 8.0, 'g': 1.5, 'sigma': 1.0, 'truncate': False},\n    ]\n\n    results = []\n    for params in test_cases:\n        eps1, eps2 = run_hfb_validation(**params)\n        results.extend([eps1, eps2])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_hfb_validation(N, hbar_omega, g, sigma, truncate):\n    \"\"\"\n    Performs the HFB calculation and computes validation errors for a given set of parameters.\n\n    Args:\n        N (int): Basis size.\n        hbar_omega (float): Harmonic oscillator energy spacing (MeV).\n        g (float): Pairing strength (MeV).\n        sigma (float): Dimensionless range parameter for pairing.\n        truncate (bool): If True, drop the highest energy quasiparticle state.\n\n    Returns:\n        tuple[float, float]: The validation errors (eps1, eps2).\n    \"\"\"\n    # 1. Construct single-particle Hamiltonian h and chemical potential lambda\n    sp_energies = hbar_omega * (np.arange(N) + 0.5)\n    h = np.diag(sp_energies)\n    \n    # Choose lambda midway between the two central single-particle levels to avoid degeneracy\n    mid_idx = N // 2\n    lambda_chem = (sp_energies[mid_idx - 1] + sp_energies[mid_idx]) / 2.0\n    \n    # 2. Construct the pairing field matrix Delta\n    indices = np.arange(N)\n    i_minus_j_sq = (indices[:, None] - indices[None, :])**2\n    Delta = g * np.exp(-i_minus_j_sq / (2.0 * sigma**2))\n    \n    # 3. Construct the Bogoliubov-de Gennes (BdG) Hamiltonian H\n    h_prime = h - lambda_chem * np.eye(N)\n    H_bdg = np.block([\n        [h_prime, Delta],\n        [Delta, -h_prime]\n    ])\n    \n    # 4. Diagonalize H_bdg to get eigenvalues and eigenvectors\n    # H_bdg is real and symmetric, so its eigenvectors can be chosen to be real.\n    # np.linalg.eigh sorts eigenvalues in ascending order.\n    eigenvalues, eigenvectors = np.linalg.eigh(H_bdg)\n    \n    # The N positive-energy eigenvectors are the last N columns of the eigenvector matrix.\n    positive_energy_eigenvectors = eigenvectors[:, N:]\n    \n    # 5. Assemble U and V matrices from the eigenvectors\n    U = positive_energy_eigenvectors[:N, :]\n    V = positive_energy_eigenvectors[N:, :]\n    \n    # 6. Apply truncation if requested\n    if truncate:\n        # Drop the last column (corresponding to the highest quasiparticle energy)\n        U = U[:, :-1]\n        V = V[:, :-1]\n        \n    # 7. Compute the validation errors\n    num_qp_states = U.shape[1]\n    identity_K = np.eye(num_qp_states)\n    \n    # Since H_bdg is real-symmetric, U and V are real matrices.\n    # U.conj().T becomes U.T\n    \n    # Error 1: Check U^T U + V^T V = I\n    err1_matrix = U.T @ U + V.T @ V - identity_K\n    eps1 = np.linalg.norm(err1_matrix, 'fro')\n    \n    # Error 2: Check U^T V + V^T U = 0\n    err2_matrix = U.T @ V + V.T @ U\n    eps2 = np.linalg.norm(err2_matrix, 'fro')\n\n    return eps1, eps2\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "HFB 框架描述了原子核的基态，而准粒子随机相近似 (QRPA) 则是描述集体激发态的标准工具。这项计算任务要求您为一个示意性的四极相互作用建立并求解 QRPA 方程，该模型抓住了集体振动的本质。通过选择性地开启和关闭粒子-空穴和粒子-粒子相互作用通道，您将直接观察到它们在塑造原子核谱（从低能集体态到高能巨共振）中的独特作用 ()。",
            "id": "3585349",
            "problem": "考虑一个偶偶核在线性响应下的行为，在准粒子随机相位近似 (QRPA) 框架内，该近似源于含时 Hartree–Fock–Bogoliubov 理论。其基本基础是 Bogoliubov 变换，该变换从粒子和空穴定义了准粒子，以及针对小振幅振荡的运动方程的线性化。在给定的多极性下，响应由一个在准粒子基中的矩阵方程控制，其中剩余相互作用通过粒子-空穴道和粒子-粒子/空穴-空穴道耦合了双准粒子组态。准粒子随机相位近似 (QRPA) 可以被构建为一个辛本征值问题，其度规结构确保在稳定条件下激发能以正负成对的形式出现。在一个用于同位旋标量四极响应的简化但科学上一致的可分离模型中，剩余相互作用在每个道中由秩一形式表示，并由耦合强度和编码跃迁振幅的结构因子控制。目标是通过直接计算来量化选择性地关闭粒子-粒子/空穴-空穴道与粒子-空穴道如何影响最低四极态和巨四极共振。\n\n从以下基础出发：\n- 双准粒子能量被收集在由列表 $\\boldsymbol{\\epsilon}$ 构建的对角矩阵中，其中每个元素都是以兆电子伏特 (MeV) 为单位的正能量。\n- 剩余相互作用通过一个带有无量纲振幅 $\\mathbf{q}$ 的可分离同位旋标量四极算符耦合这些组态，在粒子-空穴道和粒子-粒子/空穴-空穴道中产生秩一更新，受实数耦合强度 $\\kappa_{\\mathrm{ph}}$ 和 $\\kappa_{\\mathrm{pp}}$（单位为 MeV）控制。\n- QRPA 矩阵具有包含矩阵 $A$ 和 $B$ 的正则分块形式，这些矩阵体现了对角双准粒子能量加上剩余相互作用引起的耦合；辛度规选择正本征值作为物理激发能。\n\n您必须：\n1. 对每个测试用例，使用一个可分离的拟设来构建 QRPA 辛矩阵，其中粒子-空穴道和粒子-粒子/空穴-空穴道可以独立地开启或关闭。将两个道中的结构因子都视为与给定的 $\\mathbf{q}$ 成正比，其中粒子-空穴道和粒子-粒子/空穴-空穴道对 $A$ 块有相加的贡献，而在 $B$ 块中有符号相反的贡献，这与它们在 QRPA 中独特的对易结构相一致。\n2. 使用度规变换将辛本征值问题转换为标准本征值问题并求解。从本征值谱中，提取正本征值作为以 MeV 为单位的激发能。\n3. 对每个测试用例，报告两个量：最低的 QRPA 正能量（解释为低位 $2^{+}$ 态）和最高的 QRPA 正能量（解释为巨四极共振能量）。\n4. 所有能量均以 MeV 表示，并四舍五入到三位小数。\n5. 生成单行输出，包含所有测试用例的结果，格式化为逗号分隔的 Python 风格的列表的列表，其中每个内部列表包含该测试用例的两个浮点数（例如，$[[e_{1,\\min},e_{1,\\max}],[e_{2,\\min},e_{2,\\max}],\\dots]$）。\n\n测试套件参数：\n- 所有情况下均使用 $N=5$ 个双准粒子组态，其中 $\\boldsymbol{\\epsilon} = [\\,1.8,\\,2.4,\\,3.0,\\,6.5,\\,10.0\\,]$ MeV 且 $\\mathbf{q} = [\\,1.0,\\,0.85,\\,0.70,\\,0.40,\\,0.20\\,]$（无量纲）。\n- 定义了四个测试用例以探究各道的影响：\n  1. 用例 A（理想路径，两道均开启）：$\\kappa_{\\mathrm{ph}} = 0.150$ MeV，$\\kappa_{\\mathrm{pp}} = 0.080$ MeV，粒子-空穴道开启，粒子-粒子/空穴-空穴道开启。\n  2. 用例 B（粒子-粒子/空穴-空穴道关闭）：$\\kappa_{\\mathrm{ph}} = 0.150$ MeV，$\\kappa_{\\mathrm{pp}} = 0.080$ MeV，粒子-空穴道开启，粒子-粒子/空穴-空穴道关闭。\n  3. 用例 C（粒子-空穴道关闭）：$\\kappa_{\\mathrm{ph}} = 0.150$ MeV，$\\kappa_{\\mathrm{pp}} = 0.080$ MeV，粒子-空穴道关闭，粒子-粒子/空穴-空穴道开启。\n  4. 用例 D（两道均关闭，对角极限）：$\\kappa_{\\mathrm{ph}} = 0.150$ MeV，$\\kappa_{\\mathrm{pp}} = 0.080$ MeV，粒子-空穴道关闭，粒子-粒子/空穴-空穴道关闭。\n\n算法要求：\n- 设 $N$ 为 $\\boldsymbol{\\epsilon}$ 和 $\\mathbf{q}$ 的长度。构造 $N \\times N$ 对角矩阵 $E = \\mathrm{diag}(\\boldsymbol{\\epsilon})$。\n- 使用 $\\mathbf{q}$ 进行秩一更新，按如下方式构建 $A$ 和 $B$：\n  - 如果粒子-空穴道开启，则将 $\\kappa_{\\mathrm{ph}} \\, \\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ 加到 $A$ 上，并将 $\\kappa_{\\mathrm{ph}} \\, \\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ 加到 $B$ 上。\n  - 如果粒子-粒子/空穴-空穴道开启，则将 $\\kappa_{\\mathrm{pp}} \\, \\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ 加到 $A$ 上，并从 $B$ 中减去 $\\kappa_{\\mathrm{pp}} \\, \\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$。\n  - 始终将 $E$ 加到 $A$ 中。\n- 形成 $2N \\times 2N$ 的 QRPA 矩阵 $\\mathcal{M} = \\begin{pmatrix} A  B \\\\ -B  -A \\end{pmatrix}$ 和度规 $\\mathcal{S} = \\mathrm{diag}(\\underbrace{1,\\dots,1}_{N},\\underbrace{-1,\\dots,-1}_{N})$。求解关于 $\\mathcal{H} = \\mathcal{S}\\,\\mathcal{M}$ 的标准本征值问题 $\\mathcal{H}\\,\\mathbf{z} = \\omega\\,\\mathbf{z}$，并选取正本征值 $\\omega$。\n- 将正本征值升序排序。其中最小的是低位 $2^{+}$ 能量，最大的是巨四极共振能量。\n\n物理单位：\n- 能量必须以兆电子伏特 (MeV) 为单位报告。四舍五入到三位小数。\n\n最终输出格式规范：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表的列表，用方括号括起来，每个内部列表包含一个测试用例的两个浮点数 $[E_{2^{+}}, E_{\\mathrm{GQR}}]$，均以 MeV 为单位并四舍五入到三位小数（例如，$[[1.234,12.345],[\\dots,\\dots],[\\dots,\\dots],[\\dots,\\dots]]$）。",
            "solution": "推导始于核多体问题的准粒子表述。在 Hartree–Fock–Bogoliubov 理论中，Bogoliubov 变换定义了准粒子产生和湮灭算符，它们将平均场加对力哈密顿量对角化，从而产生双准粒子组态，其能量收集在集合 $\\boldsymbol{\\epsilon}$ 中，由对角矩阵 $E = \\mathrm{diag}(\\boldsymbol{\\epsilon})$ 表示，其中 $E_{ii} = \\epsilon_{i}  0$。围绕基态的小振幅振荡是通过线性化含时 Hartree–Fock–Bogoliubov 方程得到的，这导致了准粒子随机相位近似 (QRPA)。在 QRPA 中，激发算符是双准粒子产生和湮灭算符的线性组合，其振幅为 $\\mathbf{X}$ 和 $\\mathbf{Y}$，运动方程采用正则矩阵形式\n$$\n\\begin{pmatrix}\nA  B \\\\\n-B  -A\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{X} \\\\\n\\mathbf{Y}\n\\end{pmatrix}\n= \\omega\n\\begin{pmatrix}\n\\mathbf{X} \\\\\n-\\mathbf{Y}\n\\end{pmatrix},\n$$\n其中 $\\omega$ 是激发能。矩阵 $A$ 和 $B$ 编码了对角的双准粒子能量和剩余相互作用的影响。对于由可分离相互作用建模的同位旋标量四极响应，剩余相互作用可以示意性地写成粒子-空穴项和粒子-粒子/空穴-空穴项之和。当这些在给定的多极道中表示为秩一算符时，每个道都对 $A$ 和 $B$ 贡献结构因子的外积，并按特定于道​​的耦合强度进行缩放。\n\n在我们的可分离拟设中，我们指定无量纲四极振幅 $\\mathbf{q}$ 来表示每个双准粒子组态与四极算符的耦合强度。粒子-空穴道以相同的符号对 $A$ 和 $B$ 做出相干贡献，而粒子-粒子/空穴-空穴道加到 $A$ 上，但对 $B$ 的贡献符号相反。这种符号差异与 QRPA 方程的对易结构一致，并反映了粒子-空穴和粒子-粒子/空穴-空穴算符耦合前向和后向振幅的不同方式。因此，对于耦合强度 $\\kappa_{\\mathrm{ph}}$ 和 $\\kappa_{\\mathrm{pp}}$（均以兆电子伏特为单位），简化的可分离贡献被选为\n$$\nA = E + \\left(\\kappa_{\\mathrm{ph}} \\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}} \\right) \\mathbb{1}_{\\mathrm{ph\\,on}} + \\left(\\kappa_{\\mathrm{pp}} \\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}} \\right) \\mathbb{1}_{\\mathrm{pp\\,on}},\n$$\n$$\nB = \\left(\\kappa_{\\mathrm{ph}} \\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}} \\right) \\mathbb{1}_{\\mathrm{ph\\,on}} - \\left(\\kappa_{\\mathrm{pp}} \\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}} \\right) \\mathbb{1}_{\\mathrm{pp\\,on}},\n$$\n其中，如果粒子-空穴道开启，则 $\\mathbb{1}_{\\mathrm{ph\\,on}}$ 为 1，否则为 0；如果粒子-粒子/空穴-空穴道开启，则 $\\mathbb{1}_{\\mathrm{pp\\,on}}$ 为 1，否则为 0。外积 $\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ 是一个秩一的 $N \\times N$ 矩阵，它在所有双准粒子组态之间产生相干耦合。在两个道中使用相同的结构因子是一个实用的建模假设，它使计算保持自洽，同时对于同位旋标量四极响应在物理上仍然是合理的。\n\n为了求解激发能，我们将 QRPA 方程转换为一个标准的本征值问题。定义度规矩阵\n$$\n\\mathcal{S} = \\mathrm{diag}(\\underbrace{1,\\dots,1}_{N},\\underbrace{-1,\\dots,-1}_{N}),\n$$\n以及 QRPA 分块矩阵\n$$\n\\mathcal{M} = \\begin{pmatrix}\nA  B \\\\\n- B  - A\n\\end{pmatrix}.\n$$\n用 $\\mathcal{S}$ 左乘 QRPA 方程得到\n$$\n\\mathcal{S}\\,\\mathcal{M}\\,\\mathbf{Z} = \\omega\\,\\mathbf{Z},\n$$\n其中 $\\mathbf{Z}$ 堆叠了振幅 $\\mathbf{X}$ 和 $\\mathbf{Y}$。矩阵\n$$\n\\mathcal{H} \\equiv \\mathcal{S}\\,\\mathcal{M} = \\begin{pmatrix}\nA  B \\\\\nB  A\n\\end{pmatrix}\n$$\n在这个简化设置中具有对称的分块结构。在稳定条件下（我们通过使用适度的耦合强度来确保），$\\mathcal{H}$ 的本征值以 $\\pm \\omega$ 对的形式出现，物理激发能是正本征值 $\\omega0$。正本征值的集合构成了所选多极性的 QRPA 谱，我们将最低的正本征值识别为低位 $2^{+}$ 能量，将最高的正本征值识别为巨四极共振 (GQR) 能量。\n\n程序中实现的算法步骤：\n1. 对每个测试用例，根据给定的双准粒子能量 $\\boldsymbol{\\epsilon}$（单位为兆电子伏特）构建对角矩阵 $E = \\mathrm{diag}(\\boldsymbol{\\epsilon})$，并根据给定的振幅 $\\mathbf{q}$ 形成秩一矩阵 $\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$。\n2. 使用可切换的道贡献构建 $A$ 和 $B$：\n   - 如果粒子-空穴道开启，则将 $\\kappa_{\\mathrm{ph}}\\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ 加到 $A$ 和 $B$ 上。\n   - 如果粒子-粒子/空穴-空穴道开启，则将 $\\kappa_{\\mathrm{pp}}\\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ 加到 $A$ 上，并从 $B$ 中减去 $\\kappa_{\\mathrm{pp}}\\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$。\n   - 始终将 $E$ 包含在 $A$ 中。\n3. 通过应用度规变换 $\\mathcal{H} = \\mathcal{S}\\,\\mathcal{M}$，形成 $2N \\times 2N$ 矩阵 $\\mathcal{H} = \\begin{pmatrix} A  B \\\\ B  A \\end{pmatrix}$。\n4. 计算 $\\mathcal{H}$ 的所有本征值，并选择那些具有正实部（在小的数值容差内为非负）的本征值作为 QRPA 激发能（单位为兆电子伏特）。将它们升序排序，提取最小值和最大值分别作为 $E_{2^{+}}$ 和 $E_{\\mathrm{GQR}}$。\n5. 将 $E_{2^{+}}$ 和 $E_{\\mathrm{GQR}}$ 四舍五入到三位小数以供报告。\n\n测试套件包含四个用例，其中 $N=5$，$\\boldsymbol{\\epsilon} = [\\,1.8,\\,2.4,\\,3.0,\\,6.5,\\,10.0\\,]$ MeV，以及 $\\mathbf{q} = [\\,1.0,\\,0.85,\\,0.70,\\,0.40,\\,0.20\\,]$。通过切换各道来分离其影响：\n- 用例 A 包括两个道，$\\kappa_{\\mathrm{ph}} = 0.150$ MeV 和 $\\kappa_{\\mathrm{pp}} = 0.080$ MeV，预计会产生集体混合效应，从而降低最低态的能量，并相对于对角极限将 GQR 推向更高能量。\n- 用例 B 关闭了粒子-粒子/空穴-空穴道，从而分离出粒子-空穴道的贡献；最低态通常仍会降低，但相干性的平衡有所不同，导致与用例 A 相比，能谱的两端都发生了改变。\n- 用例 C 关闭了粒子-空穴道，只留下粒子-粒子/空穴-空穴道；$B$ 块中的符号差异倾向于以不同方式修改集体性，导致独特的移动。\n- 用例 D 关闭了两个道，给出了对角极限，此时 QRPA 的正能量与双准粒子能量 $\\boldsymbol{\\epsilon}$ 一致，因此低位能量是 $\\boldsymbol{\\epsilon}$ 的最小值，而 GQR 是 $\\boldsymbol{\\epsilon}$ 的最大值。\n\n该程序实现了上述步骤，并打印一行输出，其中包含一个含四个内部列表的列表，每个测试用例对应一个内部列表，每个内部列表包含以兆电子伏特为单位并四舍五入到三位小数的 $[E_{2^{+}}, E_{\\mathrm{GQR}}]$，格式符合规定。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef qrpa_spectrum(eps, q, k_ph, k_pp, ph_on=True, pp_on=True, tol=1e-8):\n    \"\"\"\n    Compute QRPA positive excitation energies (in MeV) for a separable model\n    with toggled particle-hole (ph) and particle-particle/hole-hole (pp/hh) channels.\n\n    Parameters:\n    - eps: array-like, two-quasiparticle energies (MeV), length N\n    - q: array-like, dimensionless quadrupole amplitudes, length N\n    - k_ph: float, coupling strength for particle-hole channel (MeV)\n    - k_pp: float, coupling strength for particle-particle/hole-hole channel (MeV)\n    - ph_on: bool, toggle particle-hole residual interaction\n    - pp_on: bool, toggle particle-particle/hole-hole residual interaction\n    - tol: float, numerical tolerance for selecting positive eigenvalues\n\n    Returns:\n    - pos_eigs_sorted: numpy array of positive eigenvalues (MeV), sorted ascending\n    \"\"\"\n    eps = np.asarray(eps, dtype=float)\n    q = np.asarray(q, dtype=float)\n    N = eps.size\n\n    # Diagonal two-quasiparticle energies matrix\n    E = np.diag(eps)\n\n    # Rank-one separable form\n    QQ = np.outer(q, q)\n\n    # Build A and B according to toggles and sign structure\n    A = E.copy()\n    B = np.zeros((N, N), dtype=float)\n\n    if ph_on:\n        A += k_ph * QQ\n        B += k_ph * QQ\n    if pp_on:\n        A += k_pp * QQ\n        B -= k_pp * QQ\n\n    # Construct H = S M = [[A, B], [B, A]]\n    H = np.block([[A, B],\n                  [B, A]])\n\n    # Compute eigenvalues\n    evals = np.linalg.eigvals(H)\n\n    # Keep positive real parts (discard tiny imaginary residuals)\n    # Use real parts and filter by  tol\n    evals_real = np.real(evals)\n    pos_eigs = evals_real[evals_real  tol]\n\n    # Sort ascending\n    pos_eigs_sorted = np.sort(pos_eigs)\n    return pos_eigs_sorted\n\ndef compute_case(eps, q, k_ph, k_pp, ph_on, pp_on):\n    \"\"\"\n    Compute [E_2plus, E_GQR] for one case, rounded to 3 decimals.\n    \"\"\"\n    pos_eigs = qrpa_spectrum(eps, q, k_ph, k_pp, ph_on, pp_on)\n    # Low-lying 2+ energy: smallest positive eigenvalue\n    E2 = float(pos_eigs[0])\n    # Giant quadrupole resonance energy: largest positive eigenvalue\n    EGQR = float(pos_eigs[-1])\n    # Round to 3 decimals\n    E2_r = round(E2, 3)\n    EGQR_r = round(EGQR, 3)\n    return [E2_r, EGQR_r]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    eps = [1.8, 2.4, 3.0, 6.5, 10.0]  # MeV\n    q = [1.0, 0.85, 0.70, 0.40, 0.20]  # dimensionless\n    k_ph = 0.150  # MeV\n    k_pp = 0.080  # MeV\n\n    test_cases = [\n        # Case A: both channels on\n        {\"eps\": eps, \"q\": q, \"k_ph\": k_ph, \"k_pp\": k_pp, \"ph_on\": True,  \"pp_on\": True},\n        # Case B: pp/hh off\n        {\"eps\": eps, \"q\": q, \"k_ph\": k_ph, \"k_pp\": k_pp, \"ph_on\": True,  \"pp_on\": False},\n        # Case C: ph off\n        {\"eps\": eps, \"q\": q, \"k_ph\": k_ph, \"k_pp\": k_pp, \"ph_on\": False, \"pp_on\": True},\n        # Case D: both channels off (diagonal limit)\n        {\"eps\": eps, \"q\": q, \"k_ph\": k_ph, \"k_pp\": k_pp, \"ph_on\": False, \"pp_on\": False},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_case(\n            case[\"eps\"], case[\"q\"], case[\"k_ph\"], case[\"k_pp\"],\n            case[\"ph_on\"], case[\"pp_on\"]\n        )\n        results.append(result)\n\n    # Format as single-line Python-style list of lists, with floats rounded to 3 decimals.\n    # Ensure exact required format.\n    inner_strs = []\n    for pair in results:\n        inner_strs.append(f\"[{pair[0]},{pair[1]}]\")\n    print(f\"[{','.join(inner_strs)}]\")\n\nsolve()\n```"
        }
    ]
}