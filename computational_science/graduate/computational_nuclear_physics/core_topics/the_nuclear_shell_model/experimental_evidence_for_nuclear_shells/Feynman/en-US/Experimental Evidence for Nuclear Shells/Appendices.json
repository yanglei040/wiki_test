{
    "hands_on_practices": [
        {
            "introduction": "The most compelling evidence for nuclear shell structure comes from observing simultaneous, distinct patterns across several independent observables. This exercise guides you through the process of identifying these classic signatures—kinks in separation energies, peaks in excitation energies, and anomalies in mirror energies—for the well-established proton magic number $Z=50$. By calculating these quantities from hypothetical nuclear data, you will practice the fundamental data analysis techniques used to reveal the presence of shell closures. ",
            "id": "3558348",
            "problem": "You are given synthetic, self-consistent binding energy data to analyze proton shell closures using two-proton separation energies across several isotonic chains, and to compare the inferred closure with even-even first excited quadrupole state energies and mirror displacement energy systematics. Work from the following foundational bases: the definition of nuclear binding energy, the definition of separation energy as an energy difference, and the fact that shell closures manifest as enhanced curvature (a “kink”) in separation-energy systematics, as well as large first $2^{+}$ excitation energies in even-even nuclei and anomalous trends in mirror displacement energies due to changes in charge radii and level spacings.\n\nDefinitions:\n- The nuclear binding energy $B(Z,N)$ is the energy required to separate a nucleus into its constituent $Z$ protons and $N$ neutrons.\n- The two-proton separation energy is $S_{2p}(Z,N)=B(Z,N)-B(Z-2,N)$.\n- A discrete second difference in a sequence $f(z)$ at $z=z_{0}$ is $\\Delta^{(2)} f(z_{0})=f(z_{0}+2)-2 f(z_{0})+f(z_{0}-2)$, which detects local curvature (“kinks”).\n\nData set A (binding energies at fixed neutron numbers for even $Z$; all $B$ in $\\mathrm{MeV}$):\n- For $N=78$:\n  - $B(46,78)=973.0$, $B(48,78)=985.9$, $B(50,78)=998.1$, $B(52,78)=1006.0$, $B(54,78)=1013.2$.\n- For $N=80$:\n  - $B(46,80)=989.0$, $B(48,80)=1002.2$, $B(50,80)=1014.7$, $B(52,80)=1022.8$, $B(54,80)=1030.2$.\n- For $N=82$:\n  - $B(46,82)=1005.0$, $B(48,82)=1018.5$, $B(50,82)=1031.3$, $B(52,82)=1039.7$, $B(54,82)=1047.3$.\n- For $N=84$:\n  - $B(46,84)=1021.0$, $B(48,84)=1034.8$, $B(50,84)=1047.8$, $B(52,84)=1056.5$, $B(54,84)=1064.5$.\n\nData set B (even-even first $2^{+}$ excitation energies, all in $\\mathrm{MeV}$, at $N=82$):\n- $E_{2^{+}}(Z=48,N=82)=1.20$, $E_{2^{+}}(Z=50,N=82)=4.10$, $E_{2^{+}}(Z=52,N=82)=1.25$.\n\nData set C (mirror binding energies for isobaric pairs with isospin $T=\\frac{1}{2}$ near $Z\\approx 50$; all $B$ in $\\mathrm{MeV}$):\n- For $A=97$ (pairs $(Z,N)=(49,48)$ and $(48,49)$): $B(49,48)=824.0$, $B(48,49)=832.0$.\n- For $A=101$ (pairs $(Z,N)=(51,50)$ and $(50,51)$): $B(51,50)=860.5$, $B(50,51)=869.5$.\n- For $A=105$ (pairs $(Z,N)=(53,52)$ and $(52,53)$): $B(53,52)=896.0$, $B(52,53)=904.2$.\n\nTasks:\n1. Using data set A, compute $S_{2p}(Z,N)$ for $Z\\in\\{48,50,52\\}$ and $N\\in\\{78,80,82,84\\}$. Then compute, for each $N$, the discrete second difference at $Z=50$,\n   $$\\Delta^{(2)} S_{2p}(Z=50,N)=S_{2p}(52,N)-2\\,S_{2p}(50,N)+S_{2p}(48,N).$$\n   Average these four values over $N$ to obtain $C_{S}$. Define the separation-energy closure strength as $Q_{S}=-C_{S}$.\n2. Using data set B, compute the curvature of the first $2^{+}$ excitation energy at $Z=50$,\n   $$C_{E}=E_{2^{+}}(50,82)-\\frac{E_{2^{+}}(48,82)+E_{2^{+}}(52,82)}{2}.$$\n   Define the $E_{2^{+}}$ closure strength as $Q_{E}=C_{E}$.\n3. Define the mirror displacement energy (MDE) for $T=\\frac{1}{2}$ mirror pairs at fixed $A$ as\n   $$\\Delta_{\\mathrm{MDE}}(A)=B(Z+1,Z)-B(Z,Z+1),\\quad A=2Z+1.$$\n   Using data set C, compute $\\Delta_{\\mathrm{MDE}}(97)$, $\\Delta_{\\mathrm{MDE}}(101)$, and $\\Delta_{\\mathrm{MDE}}(105)$. Then form the anomaly curvature at $A=101$,\n   $$C_{M}=\\Delta_{\\mathrm{MDE}}(101)-\\frac{\\Delta_{\\mathrm{MDE}}(97)+\\Delta_{\\mathrm{MDE}}(105)}{2}.$$\n   Define the mirror-energy closure strength as $Q_{M}=-C_{M}$.\n4. The composite, dimensionally homogeneous closure score is defined as\n   $$Q=Q_{S}+Q_{E}+Q_{M}.$$\n   This $Q$ aggregates the kink in two-proton separation energies, the high $2^{+}$ excitation energy, and the mirror displacement energy anomaly into a single quantitative measure of a proton shell closure centered at $Z=50$.\n5. Identify, from the signs and magnitudes of $C_{S}$, $C_{E}$, and $C_{M}$, the proton shell closure suggested by these systematics. Then compute and report the single numeric value $Q$. Express the final energy in $\\mathrm{MeV}$ and round your answer to three significant figures. Do not include units in your final boxed answer.",
            "solution": "The problem requires the calculation of a composite closure score, $Q$, which aggregates three independent experimental signatures of a nuclear shell closure at proton number $Z=50$. The calculation proceeds by analyzing synthetic data for binding energies, first $2^+$ excitation energies, and mirror displacement energies. The analysis is performed in a series of sequential tasks.\n\nFirst, as part of Task 5, we identify the proton shell closure. A key signature of a shell closure at a proton number $Z_0$ is a sharp drop in the two-proton separation energy, $S_{2p}$, for nuclei with $Z > Z_0$. The second-difference analysis is designed to detect this \"kink\". A negative second difference, $C_S<0$, at $Z_0$ indicates such a feature. Another signature is an anomalously high energy for the first excited $2^+$ state, $E_{2^+}$, in even-even nuclei at the magic number $Z_0$. This corresponds to a large positive curvature, $C_E > 0$. Finally, changes in nuclear charge radii at a shell closure cause an anomaly in the otherwise smooth trend of mirror displacement energies, $\\Delta_{\\mathrm{MDE}}$, leading to a non-zero curvature $C_M$. The signs of the calculated quantities $C_S$, $C_E$, and $C_M$ will confirm the presence and location of the shell closure being investigated. The problem centers all calculations on $Z=50$, implicitly postulating the closure is there. The calculations will verify this postulate.\n\nThe solution will now proceed through the specified computational tasks.\n\n**Task 1: Calculation of the Separation-Energy Closure Strength $Q_S$**\n\nThe two-proton separation energy is defined as $S_{2p}(Z,N)=B(Z,N)-B(Z-2,N)$. We compute this for $Z\\in\\{48,50,52\\}$ across the four isotonic chains ($N=78, 80, 82, 84$). All energies are in $\\mathrm{MeV}$.\n\nFor $N=78$:\n$S_{2p}(48,78) = B(48,78) - B(46,78) = 985.9 - 973.0 = 12.9$\n$S_{2p}(50,78) = B(50,78) - B(48,78) = 998.1 - 985.9 = 12.2$\n$S_{2p}(52,78) = B(52,78) - B(50,78) = 1006.0 - 998.1 = 7.9$\n\nFor $N=80$:\n$S_{2p}(48,80) = B(48,80) - B(46,80) = 1002.2 - 989.0 = 13.2$\n$S_{2p}(50,80) = B(50,80) - B(48,80) = 1014.7 - 1002.2 = 12.5$\n$S_{2p}(52,80) = B(52,80) - B(50,80) = 1022.8 - 1014.7 = 8.1$\n\nFor $N=82$:\n$S_{2p}(48,82) = B(48,82) - B(46,82) = 1018.5 - 1005.0 = 13.5$\n$S_{2p}(50,82) = B(50,82) - B(48,82) = 1031.3 - 1018.5 = 12.8$\n$S_{2p}(52,82) = B(52,82) - B(50,82) = 1039.7 - 1031.3 = 8.4$\n\nFor $N=84$:\n$S_{2p}(48,84) = B(48,84) - B(46,84) = 1034.8 - 1021.0 = 13.8$\n$S_{2p}(50,84) = B(50,84) - B(48,84) = 1047.8 - 1034.8 = 13.0$\n$S_{2p}(52,84) = B(52,84) - B(50,84) = 1056.5 - 1047.8 = 8.7$\n\nNext, we compute the discrete second difference $\\Delta^{(2)} S_{2p}(Z=50,N)=S_{2p}(52,N)-2\\,S_{2p}(50,N)+S_{2p}(48,N)$ for each $N$:\n$\\Delta^{(2)} S_{2p}(50,78) = 7.9 - 2(12.2) + 12.9 = 7.9 - 24.4 + 12.9 = -3.6$\n$\\Delta^{(2)} S_{2p}(50,80) = 8.1 - 2(12.5) + 13.2 = 8.1 - 25.0 + 13.2 = -3.7$\n$\\Delta^{(2)} S_{2p}(50,82) = 8.4 - 2(12.8) + 13.5 = 8.4 - 25.6 + 13.5 = -3.7$\n$\\Delta^{(2)} S_{2p}(50,84) = 8.7 - 2(13.0) + 13.8 = 8.7 - 26.0 + 13.8 = -3.5$\n\nThe average curvature $C_S$ is the mean of these values:\n$$C_S = \\frac{(-3.6) + (-3.7) + (-3.7) + (-3.5)}{4} = \\frac{-14.5}{4} = -3.625 \\, \\mathrm{MeV}$$\nThe strongly negative value of $C_S$ indicates a significant kink at $Z=50$, characteristic of a shell closure.\nThe separation-energy closure strength is $Q_S = -C_S$:\n$$Q_S = -(-3.625) = 3.625 \\, \\mathrm{MeV}$$\n\n**Task 2: Calculation of the $E_{2^{+}}$ Closure Strength $Q_E$**\n\nThe curvature of the first $2^{+}$ excitation energy at $Z=50$ for the $N=82$ isotones is given by $C_{E}=E_{2^{+}}(50,82)-\\frac{E_{2^{+}}(48,82)+E_{2^{+}}(52,82)}{2}$. Using the provided data from Data set B:\n$$C_{E} = 4.10 - \\frac{1.20 + 1.25}{2} = 4.10 - \\frac{2.45}{2} = 4.10 - 1.225 = 2.875 \\, \\mathrm{MeV}$$\nThe large positive value of $C_E$ reflects the exceptionally high $E_{2^+}$ energy at $Z=50$, a classic signature of a magic nucleus.\nThe $E_{2^{+}}$ closure strength is $Q_E = C_E$:\n$$Q_E = 2.875 \\, \\mathrm{MeV}$$\n\n**Task 3: Calculation of the Mirror-Energy Closure Strength $Q_M$**\n\nThe mirror displacement energy (MDE) is given by $\\Delta_{\\mathrm{MDE}}(A)=B(Z+1,Z)-B(Z,Z+1)$ for isobaric mass $A=2Z+1$. We compute this for the three given isobaric pairs from Data set C.\n\nFor $A=97$, $Z=48$:\n$\\Delta_{\\mathrm{MDE}}(97) = B(49,48) - B(48,49) = 824.0 - 832.0 = -8.0 \\, \\mathrm{MeV}$\n\nFor $A=101$, $Z=50$:\n$\\Delta_{\\mathrm{MDE}}(101) = B(51,50) - B(50,51) = 860.5 - 869.5 = -9.0 \\, \\mathrm{MeV}$\n\nFor $A=105$, $Z=52$:\n$\\Delta_{\\mathrm{MDE}}(105) = B(53,52) - B(52,53) = 896.0 - 904.2 = -8.2 \\, \\mathrm{MeV}$\n\nThe anomaly curvature at $A=101$ (which straddles the $Z=50$ shell) is $C_{M}=\\Delta_{\\mathrm{MDE}}(101)-\\frac{\\Delta_{\\mathrm{MDE}}(97)+\\Delta_{\\mathrm{MDE}}(105)}{2}$:\n$$C_{M} = -9.0 - \\frac{(-8.0) + (-8.2)}{2} = -9.0 - \\frac{-16.2}{2} = -9.0 - (-8.1) = -0.9 \\, \\mathrm{MeV}$$\nThe negative value of $C_M$ indicates an anomaly in the MDE trend around $Z=50$.\nThe mirror-energy closure strength is $Q_M = -C_M$:\n$$Q_M = -(-0.9) = 0.9 \\, \\mathrm{MeV}$$\n\n**Task 4 & 5: Calculation of the Composite Closure Score $Q$**\n\nThe three independent metrics, $Q_S > 0$, $Q_E > 0$, and $Q_M > 0$, all consistently indicate the presence of a strong proton shell closure at $Z=50$. We now combine them into the composite, dimensionally homogeneous closure score $Q = Q_{S}+Q_{E}+Q_{M}$:\n$$Q = 3.625 + 2.875 + 0.9 = 7.4 \\, \\mathrm{MeV}$$\nThe problem requires the final answer to be rounded to three significant figures. The exact value is $7.4$. To express this with three significant figures, we write $7.40$.\n\nFinal numeric value:\n$$Q = 7.40 \\, \\mathrm{MeV}$$",
            "answer": "$$\\boxed{7.40}$$"
        },
        {
            "introduction": "Beyond the primary signatures of shell closure, more subtle effects like the behavior of the nuclear pairing interaction provide crucial confirmatory evidence. This practice focuses on quantifying the odd-even staggering in nuclear binding energies, which becomes significantly enhanced at a magic number due to the large energy gap. You will use a three-point finite-difference formula to calculate the pairing gap from binding energy data around the magic number $N=82$, learning how to isolate and quantify this key indicator of shell structure. ",
            "id": "3558383",
            "problem": "A central piece of experimental evidence for nuclear shell structure is the presence of enhanced odd-even staggering and kinks in neutron separation energies at magic neutron numbers. Consider the isotopic chain of tin with fixed proton number $Z=50$ across the known magic neutron number $N=82$. Let $B(Z,N)$ denote the nuclear binding energy. The one-neutron separation energy is defined by the widely used relation $S_{n}(Z,N)=B(Z,N)-B(Z,N-1)$. A standard three-point finite-difference indicator of odd-even staggering in the neutron channel is the three-point neutron pairing gap,\n$$\n\\Delta_{n}^{(3)}(Z,N)=\\frac{(-1)^{N}}{2}\\big[B(Z,N+1)-2B(Z,N)+B(Z,N-1)\\big],\n$$\nwhich is known to be sensitive to shell closures through enhanced magnitude near magic numbers.\n\nYou are provided with experimentally consistent binding energies (in $\\mathrm{MeV}$) for $Z=50$ at neutron numbers near $N=82$:\n- $N=80$: $B(50,80)=1093.1\\,\\mathrm{MeV}$\n- $N=81$: $B(50,81)=1100.1\\,\\mathrm{MeV}$\n- $N=82$: $B(50,82)=1107.5\\,\\mathrm{MeV}$\n- $N=83$: $B(50,83)=1110.1\\,\\mathrm{MeV}$\n- $N=84$: $B(50,84)=1113.3\\,\\mathrm{MeV}$\n\nUsing only the definitions above and first principles of finite differences, compute the three-point indicator $\\Delta_{n}^{(3)}(50,N)$ at $N=81$, $N=82$, and $N=83$. Then quantify the shell-closure enhancement at $N=82$ by the dimensionless ratio\n$$\n\\mathcal{E}=\\frac{\\left|\\Delta_{n}^{(3)}(50,82)\\right|}{\\dfrac{1}{2}\\left(\\left|\\Delta_{n}^{(3)}(50,81)\\right|+\\left|\\Delta_{n}^{(3)}(50,83)\\right|\\right)}.\n$$\nReport the final value of $\\mathcal{E}$ rounded to four significant figures. Express the final answer as a pure number (dimensionless).",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a complete solution. The task is to compute a dimensionless ratio $\\mathcal{E}$ that quantifies the enhancement of the odd-even staggering in nuclear binding energies at a magic number. This requires calculating a three-point finite-difference indicator, $\\Delta_{n}^{(3)}(Z,N)$, for several neutron numbers $N$ around the magic number $N=82$ for the tin ($Z=50$) isotopic chain.\n\nThe three-point neutron pairing gap is defined as:\n$$\n\\Delta_{n}^{(3)}(Z,N)=\\frac{(-1)^{N}}{2}\\big[B(Z,N+1)-2B(Z,N)+B(Z,N-1)\\big]\n$$\nThe provided binding energies $B(Z,N)$ in $\\mathrm{MeV}$ for $Z=50$ are:\n- $B(50,80)=1093.1\\,\\mathrm{MeV}$\n- $B(50,81)=1100.1\\,\\mathrm{MeV}$\n- $B(50,82)=1107.5\\,\\mathrm{MeV}$\n- $B(50,83)=1110.1\\,\\mathrm{MeV}$\n- $B(50,84)=1113.3\\,\\mathrm{MeV}$\n\nWe will compute $\\Delta_{n}^{(3)}(50,N)$ for $N=81$, $N=82$, and $N=83$.\n\nFirst, for $N=81$:\nThe neutron number $N=81$ is odd, so the factor $(-1)^N$ is $(-1)^{81}=-1$.\n$$\n\\Delta_{n}^{(3)}(50,81) = \\frac{(-1)^{81}}{2}\\big[B(50,82) - 2B(50,81) + B(50,80)\\big]\n$$\nSubstituting the given binding energy values:\n$$\n\\Delta_{n}^{(3)}(50,81) = \\frac{-1}{2}\\big[1107.5 - 2(1100.1) + 1093.1\\big]\n$$\n$$\n\\Delta_{n}^{(3)}(50,81) = \\frac{-1}{2}\\big[1107.5 - 2200.2 + 1093.1\\big]\n$$\n$$\n\\Delta_{n}^{(3)}(50,81) = \\frac{-1}{2}\\big[2200.6 - 2200.2\\big] = \\frac{-1}{2}(0.4) = -0.2\\,\\mathrm{MeV}\n$$\n\nSecond, for the magic number $N=82$:\nThe neutron number $N=82$ is even, so the factor $(-1)^N$ is $(-1)^{82}=1$.\n$$\n\\Delta_{n}^{(3)}(50,82) = \\frac{(-1)^{82}}{2}\\big[B(50,83) - 2B(50,82) + B(50,81)\\big]\n$$\nSubstituting the given binding energy values:\n$$\n\\Delta_{n}^{(3)}(50,82) = \\frac{1}{2}\\big[1110.1 - 2(1107.5) + 1100.1\\big]\n$$\n$$\n\\Delta_{n}^{(3)}(50,82) = \\frac{1}{2}\\big[1110.1 - 2215.0 + 1100.1\\big]\n$$\n$$\n\\Delta_{n}^{(3)}(50,82) = \\frac{1}{2}\\big[2210.2 - 2215.0\\big] = \\frac{1}{2}(-4.8) = -2.4\\,\\mathrm{MeV}\n$$\nThe magnitude of $\\Delta_{n}^{(3)}$ is significantly larger at the magic number $N=82$, which is the physical effect the problem aims to demonstrate.\n\nThird, for $N=83$:\nThe neutron number $N=83$ is odd, so the factor $(-1)^N$ is $(-1)^{83}=-1$.\n$$\n\\Delta_{n}^{(3)}(50,83) = \\frac{(-1)^{83}}{2}\\big[B(50,84) - 2B(50,83) + B(50,82)\\big]\n$$\nSubstituting the given binding energy values:\n$$\n\\Delta_{n}^{(3)}(50,83) = \\frac{-1}{2}\\big[1113.3 - 2(1110.1) + 1107.5\\big]\n$$\n$$\n\\Delta_{n}^{(3)}(50,83) = \\frac{-1}{2}\\big[1113.3 - 2220.2 + 1107.5\\big]\n$$\n$$\n\\Delta_{n}^{(3)}(50,83) = \\frac{-1}{2}\\big[2220.8 - 2220.2\\big] = \\frac{1}{2}(0.6) = -0.3\\,\\mathrm{MeV}\n$$\n\nNow, we compute the dimensionless shell-closure enhancement ratio $\\mathcal{E}$:\n$$\n\\mathcal{E}=\\frac{\\left|\\Delta_{n}^{(3)}(50,82)\\right|}{\\dfrac{1}{2}\\left(\\left|\\Delta_{n}^{(3)}(50,81)\\right|+\\left|\\Delta_{n}^{(3)}(50,83)\\right|\\right)}\n$$\nWe use the absolute values of the quantities computed above:\n$|\\Delta_{n}^{(3)}(50,81)| = |-0.2| = 0.2$\n$|\\Delta_{n}^{(3)}(50,82)| = |-2.4| = 2.4$\n$|\\Delta_{n}^{(3)}(50,83)| = |-0.3| = 0.3$\n\nSubstituting these into the expression for $\\mathcal{E}$:\n$$\n\\mathcal{E} = \\frac{2.4}{\\dfrac{1}{2}(0.2 + 0.3)}\n$$\n$$\n\\mathcal{E} = \\frac{2.4}{\\dfrac{1}{2}(0.5)} = \\frac{2.4}{0.25}\n$$\n$$\n\\mathcal{E} = 9.6\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\mathcal{E} = 9.600\n$$\nThis high value of $\\mathcal{E}$ quantitatively confirms the strong enhancement of the pairing gap, a primary indicator of the shell closure at the magic neutron number $N=82$.",
            "answer": "$$\n\\boxed{9.600}\n$$"
        },
        {
            "introduction": "In modern nuclear physics, simply observing a trend is not enough; we must quantify the statistical significance of the evidence, especially when claiming the discovery of new 'magic numbers' in exotic nuclei. This exercise introduces a powerful method for this task: Bayesian model comparison. You will construct two competing statistical models—one with a shell gap at $N=32$ and one without—and use data from multiple observables to calculate the Bayes factor, which provides a definitive measure of how much more the data supports one model over the other. ",
            "id": "3558398",
            "problem": "You are asked to formalize and compute the combined strength of experimental evidence for the presence of a nuclear shell gap at neutron number $N=32$ by comparing two statistical models using Bayes factors, drawing on data for the Two-Neutron Separation Energy ($S_{2n}$), the first $2^+$ Excitation Energy ($E(2^+)$), and the Reduced Electric Quadrupole Transition Probability ($B(E2)$). Your answer must be a complete and runnable program that computes the specified outputs for the provided test suite.\n\nThe fundamental base for this task is Bayes’ theorem, the Gaussian likelihood for measurement errors, and the definition of Bayesian model evidence. Let $M_0$ denote the null model without a special feature at $N=32$ and $M_1$ denote the alternative model with an explicit parameter modeling a localized effect at $N=32$ for each observable. You will assume that, conditional on a model, all data points are independent and Gaussian-distributed around a linear predictor, with known standard deviations.\n\nFor each observable $o \\in \\{S_{2n}, E(2^+), B(E2)\\}$, for each datum $i$ with neutron number $N_i$, measured value $y_{o,i}$, and reported standard deviation $\\sigma_{o,i}$ (assumed known and Gaussian), define the models:\n- Under $M_0$ (no $N=32$ shell-gap term), the predictor is\n$$\n\\mu_{o,i}^{(0)} = \\beta_{o,0} + \\beta_{o,1} N_i,\n$$\nwith parameters $\\beta_{o,0}$ and $\\beta_{o,1}$.\n- Under $M_1$ (with an $N=32$ shell-gap term), the predictor is\n$$\n\\mu_{o,i}^{(1)} = \\beta_{o,0} + \\beta_{o,1} N_i + \\gamma_o \\, d(N_i),\n$$\nwhere $d(N_i)=1$ if $N_i=32$ and $d(N_i)=0$ otherwise, and $\\gamma_o$ captures a localized deviation at $N=32$.\n\nAssume independent Gaussian priors for all regression parameters with zero mean and prior variance $s_o^2$ for each parameter in observable $o$. That is, under $M_0$, $(\\beta_{o,0}, \\beta_{o,1}) \\sim \\mathcal{N}(0, s_o^2 I)$; under $M_1$, $(\\beta_{o,0}, \\beta_{o,1}, \\gamma_o) \\sim \\mathcal{N}(0, s_o^2 I)$. For each observable $o$, the parameter scale $s_o$ will be specified in the test cases below. The Gaussian likelihood for datum $i$ in observable $o$ is\n$$\ny_{o,i} \\sim \\mathcal{N}\\!\\left( \\mu_{o,i}^{(m)}, \\, \\sigma_{o,i}^2 \\right),\n$$\nwhere $m \\in \\{0,1\\}$ denotes the model.\n\nFor each observable, the Bayesian model evidence is the marginal likelihood obtained by integrating the likelihood over the prior. Because the prior and the likelihood are Gaussian, the evidence for each observable is a closed-form Gaussian integral. Assume independence across the three observables given the model, so that the combined evidence is the product of the evidences for the three observables under the same model. The Bayes factor $K$ comparing the models is defined as\n$$\nK \\equiv \\frac{Z_1}{Z_0},\n$$\nwhere $Z_1$ and $Z_0$ are the combined evidences for $M_1$ and $M_0$, respectively. Report the base-$10$ logarithm of the Bayes factor, $\\log_{10} K$, which is dimensionless.\n\nModeling notes:\n- Treat $N$ as a numeric predictor exactly as provided.\n- Treat $d(N)$ exactly as the indicator function equal to $1$ when $N=32$ and $0$ otherwise.\n- For each observable, under $M_0$ the design matrix has $2$ columns corresponding to an intercept and $N$. Under $M_1$ the design matrix has $3$ columns corresponding to an intercept, $N$, and $d(N)$.\n- The prior variance $s_o^2$ applies identically and independently to each parameter within observable $o$.\n- Use the provided numerical values and uncertainties directly; do not perform any unit conversions. The result $\\log_{10} K$ is dimensionless. Physical units for inputs are specified for realism and must be adhered to in model specification, but no unit conversion is needed.\n\nTest suite:\nCompute $\\log_{10} K$ for each of the three test cases below, each case comprising three observables with their data. All neutron numbers $N$ are unitless counts. All angles are not applicable. Units are specified for each observable. For all listed numbers, use them exactly as given.\n\n- Test Case A (representative of a pronounced shell gap at $N=32$):\n    - Two-Neutron Separation Energy ($S_{2n}$) in $\\mathrm{MeV}$:\n        - $N = [30, 32, 34]$\n        - $y = [20.0, 16.8, 17.6]$\n        - $\\sigma = [0.2, 0.2, 0.2]$\n        - prior scale $s_{S_{2n}} = 10.0$\n    - First $2^+$ Excitation Energy ($E(2^+)$) in $\\mathrm{MeV}$:\n        - $N = [30, 32, 34]$\n        - $y = [1.0, 2.3, 1.2]$\n        - $\\sigma = [0.05, 0.05, 0.05]$\n        - prior scale $s_{E(2^+)} = 3.0$\n    - Reduced Electric Quadrupole Transition Probability ($B(E2)$) in $e^2 b^2$:\n        - $N = [30, 32, 34]$\n        - $y = [0.20, 0.06, 0.16]$\n        - $\\sigma = [0.01, 0.01, 0.01]$\n        - prior scale $s_{B(E2)} = 0.5$\n\n- Test Case B (representative of no shell gap, smooth trend):\n    - Two-Neutron Separation Energy ($S_{2n}$) in $\\mathrm{MeV}$:\n        - $N = [30, 32, 34]$\n        - $y = [20.0, 18.8, 17.6]$\n        - $\\sigma = [0.2, 0.2, 0.2]$\n        - prior scale $s_{S_{2n}} = 10.0$\n    - First $2^+$ Excitation Energy ($E(2^+)$) in $\\mathrm{MeV}$:\n        - $N = [30, 32, 34]$\n        - $y = [1.0, 1.1, 1.2]$\n        - $\\sigma = [0.05, 0.05, 0.05]$\n        - prior scale $s_{E(2^+)} = 3.0$\n    - Reduced Electric Quadrupole Transition Probability ($B(E2)$) in $e^2 b^2$:\n        - $N = [30, 32, 34]$\n        - $y = [0.20, 0.18, 0.16]$\n        - $\\sigma = [0.01, 0.01, 0.01]$\n        - prior scale $s_{B(E2)} = 0.5$\n\n- Test Case C (sparse measurements with larger uncertainties):\n    - Two-Neutron Separation Energy ($S_{2n}$) in $\\mathrm{MeV}$:\n        - $N = [30, 32]$\n        - $y = [20.0, 18.8]$\n        - $\\sigma = [0.5, 0.5]$\n        - prior scale $s_{S_{2n}} = 10.0$\n    - First $2^+$ Excitation Energy ($E(2^+)$) in $\\mathrm{MeV}$:\n        - $N = [30, 32]$\n        - $y = [1.0, 1.1]$\n        - $\\sigma = [0.2, 0.2]$\n        - prior scale $s_{E(2^+)} = 3.0$\n    - Reduced Electric Quadrupole Transition Probability ($B(E2)$) in $e^2 b^2$:\n        - $N = [30, 32]$\n        - $y = [0.20, 0.18]$\n        - $\\sigma = [0.05, 0.05]$\n        - prior scale $s_{B(E2)} = 0.5$\n\nYour program must:\n- Implement the linear-Gaussian models $M_0$ and $M_1$ with the priors and likelihoods described above.\n- For each observable in each test case, compute the Bayesian model evidence by analytically integrating over the Gaussian priors.\n- Combine evidences across the three observables by multiplication to obtain $Z_0$ and $Z_1$ for the case.\n- Compute the Bayes factor $K = Z_1/Z_0$ and report $\\log_{10} K$.\n- Output a single line containing a list of three floats corresponding to $\\log_{10} K$ for Test Case A, Test Case B, and Test Case C, respectively, rounded to three decimal places, in the format $[x_1,x_2,x_3]$.\n\nAll numerical inputs in the test suite must be used exactly as provided. All physical inputs are specified in correct physical units: $S_{2n}$ in $\\mathrm{MeV}$, $E(2^+)$ in $\\mathrm{MeV}$, and $B(E2)$ in $e^2 b^2$. The final reported values $\\log_{10} K$ are dimensionless. The angle unit is not applicable in this problem. The program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3]$.",
            "solution": "The user has requested the formalization and computation of the Bayes factor to compare two statistical models regarding a potential nuclear shell gap at neutron number $N=32$. The solution requires calculating the Bayesian model evidence for each model and then their ratio.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Models**:\n    *   Null model ($M_0$): linear predictor $\\mu_{o,i}^{(0)} = \\beta_{o,0} + \\beta_{o,1} N_i$.\n    *   Alternative model ($M_1$): linear predictor $\\mu_{o,i}^{(1)} = \\beta_{o,0} + \\beta_{o,1} N_i + \\gamma_o \\, d(N_i)$, where $d(N_i) = 1$ if $N_i=32$ and $0$ otherwise.\n*   **Likelihood**: For each observable $o$ and data point $i$, the measured value $y_{o,i}$ is assumed to follow a Gaussian distribution around the model's prediction $\\mu_{o,i}^{(m)}$ with a known standard deviation $\\sigma_{o,i}$: $y_{o,i} \\sim \\mathcal{N}(\\mu_{o,i}^{(m)}, \\sigma_{o,i}^2)$. Data points are independent.\n*   **Priors**:\n    *   For $M_0$, parameters $(\\beta_{o,0}, \\beta_{o,1})$ have an independent Gaussian prior with zero mean and variance $s_o^2$: $(\\beta_{o,0}, \\beta_{o,1}) \\sim \\mathcal{N}(\\mathbf{0}, s_o^2 I_2)$.\n    *   For $M_1$, parameters $(\\beta_{o,0}, \\beta_{o,1}, \\gamma_o)$ have an independent Gaussian prior with zero mean and variance $s_o^2$: $(\\beta_{o,0}, \\beta_{o,1}, \\gamma_o) \\sim \\mathcal{N}(\\mathbf{0}, s_o^2 I_3)$.\n*   **Bayes Factor**: $K = Z_1 / Z_0$, where $Z_m$ is the combined evidence for model $M_m$.\n*   **Combined Evidence**: The total evidence for a model is the product of the evidences for each of the three observables, due to assumed independence: $Z_m = \\prod_{o} Z_{o,m}$.\n*   **Output**: The base-$10$ logarithm of the Bayes factor, $\\log_{10} K$.\n*   **Data**: Three test cases (A, B, C) are provided, each containing data ($N$, $y$, $\\sigma$) and a prior scale parameter $s_o$ for three observables: $S_{2n}$, $E(2^+)$, and $B(E2)$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded**: The problem uses standard nuclear physics observables ($S_{2n}$, $E(2^+)$, $B(E2)$) to test a hypothesis about nuclear shell structure, a core topic in the field. The statistical framework (Bayesian model comparison using linear models, Gaussian priors, and Gaussian likelihoods) is a rigorous and standard method for quantitative data analysis. The problem is scientifically sound.\n*   **Well-Posed**: The problem is formulated as a Bayesian linear regression problem. The marginal likelihood (model evidence) for such a model with Gaussian priors and likelihood has a well-defined analytical solution. All necessary inputs (data, uncertainties, prior parameters) are provided. The problem has a unique, stable, and meaningful solution.\n*   **Objective**: The problem statement is precise, quantitative, and free of ambiguity or subjective language. The task is a direct computation based on the provided formulas and data.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. I will proceed with the detailed solution.\n\n### Principle-Based Solution\n\nThe core of the problem is to compute the Bayesian model evidence, also known as the marginal likelihood, for the two competing models, $M_0$ and $M_1$, for each observable. The evidence represents the probability of the observed data given the model, $Z = p(\\mathbf{y}|M)$, obtained by integrating over all possible values of the model parameters weighted by their prior probabilities.\n\nFor a given observable $o$, we can write the Bayesian model in vector-matrix form. Let $\\mathbf{y}$ be the $n \\times 1$ vector of observed data points, $X$ be the $n \\times p$ design matrix, and $\\mathbf{\\beta}$ be the $p \\times 1$ vector of model parameters.\nThe likelihood is $p(\\mathbf{y}|\\mathbf{\\beta}, M) = \\mathcal{N}(\\mathbf{y} | X\\mathbf{\\beta}, \\Sigma_y)$, where $\\Sigma_y$ is the $n \\times n$ diagonal covariance matrix of measurement errors, with $\\left(\\Sigma_y\\right)_{ii} = \\sigma_i^2$.\nThe prior on the parameters is $p(\\mathbf{\\beta}|M) = \\mathcal{N}(\\mathbf{\\beta} | \\mathbf{\\beta}_0, \\Sigma_\\beta)$. In this problem, the prior mean is $\\mathbf{\\beta}_0 = \\mathbf{0}$ and the prior covariance is $\\Sigma_\\beta = s_o^2 I_p$, where $p$ is the number of parameters ($2$ for $M_0$, $3$ for $M_1$) and $I_p$ is the $p \\times p$ identity matrix.\n\nThe model evidence $Z$ is the integral:\n$$\nZ = \\int p(\\mathbf{y}|\\mathbf{\\beta}, M) p(\\mathbf{\\beta}|M) d\\mathbf{\\beta}\n$$\nThis is a standard Gaussian integral. The result is that the data vector $\\mathbf{y}$ itself follows a multivariate normal distribution, with a mean $E[\\mathbf{y}] = X\\mathbf{\\beta}_0$ and a covariance matrix $\\text{Cov}(\\mathbf{y}) = \\Sigma_y + X\\Sigma_\\beta X^T$.\nGiven that our prior mean is $\\mathbf{\\beta}_0 = \\mathbf{0}$, the predictive distribution for $\\mathbf{y}$ is:\n$$\np(\\mathbf{y}|M) = \\mathcal{N}(\\mathbf{y} | \\mathbf{0}, C)\n$$\nwhere $C = \\Sigma_y + s_o^2 X X^T$. The evidence $Z$ is the value of this probability density function evaluated at the observed data $\\mathbf{y}$:\n$$\nZ = (2\\pi)^{-n/2} |C|^{-1/2} \\exp\\left(-\\frac{1}{2} \\mathbf{y}^T C^{-1} \\mathbf{y}\\right)\n$$\nTo avoid numerical underflow and simplify calculations, we compute the natural logarithm of the evidence:\n$$\n\\ln Z = -\\frac{n}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|C| - \\frac{1}{2}\\mathbf{y}^T C^{-1} \\mathbf{y}\n$$\nThis calculation is performed for each observable under both models $M_0$ and $M_1$.\n\n**For Model $M_0$**: The parameter vector is $\\mathbf{\\beta} = (\\beta_0, \\beta_1)^T$. The $n \\times 2$ design matrix $X_0$ is constructed with a column of ones for the intercept $\\beta_0$ and a column of neutron numbers $N_i$ for the slope $\\beta_1$.\n$$\nX_0 = \\begin{pmatrix} 1 & N_1 \\\\ 1 & N_2 \\\\ \\vdots & \\vdots \\\\ 1 & N_n \\end{pmatrix}\n$$\n\n**For Model $M_1$**: The parameter vector is $\\mathbf{\\beta} = (\\beta_0, \\beta_1, \\gamma)^T$. The $n \\times 3$ design matrix $X_1$ adds a third column, $d(N_i)$, which is an indicator variable for $N_i=32$.\n$$\nX_1 = \\begin{pmatrix} 1 & N_1 & d(N_1) \\\\ 1 & N_2 & d(N_2) \\\\ \\vdots & \\vdots & \\vdots \\\\ 1 & N_n & d(N_n) \\end{pmatrix}\n$$\n\nThe overall evidence for a model ($Z_0$ or $Z_1$) is the product of the evidences from the three observables ($S_{2n}$, $E(2^+)$, $B(E2)$), due to their assumed independence. In log space, this corresponds to a sum:\n$$\n\\ln Z_m^{\\text{total}} = \\ln Z_{S_{2n},m} + \\ln Z_{E(2^+),m} + \\ln Z_{B(E2),m}\n$$\nfor $m \\in \\{0, 1\\}$.\n\nFinally, the Bayes factor $K = Z_1 / Z_0$ is computed. The desired output is its base-$10$ logarithm, which is calculated from the total log-evidences:\n$$\n\\log_{10} K = \\frac{\\ln K}{\\ln 10} = \\frac{\\ln Z_1^{\\text{total}} - \\ln Z_0^{\\text{total}}}{\\ln 10}\n$$\n\nThe algorithm proceeds as follows for each test case:\n1. Initialize total log-evidences $\\ln Z_0^{\\text{total}} = 0$ and $\\ln Z_1^{\\text{total}} = 0$.\n2. For each of the three observables:\n    a. Construct the data vector $\\mathbf{y}$, the data covariance matrix $\\Sigma_y$, and the design matrices $X_0$ and $X_1$.\n    b. For both models $M_0$ and $M_1$, compute the matrix $C = \\Sigma_y + s_o^2 X X^T$.\n    c. Calculate the log-evidence $\\ln Z$ using the formula involving the determinant and inverse of $C$.\n    d. Add the results to the corresponding total log-evidence accumulators.\n3. Compute the final $\\log_{10} K$ from the total log-evidences.\nThis process is repeated for all three test cases.",
            "answer": "```python\nimport numpy as np\n\ndef calculate_log_evidence(y, sigma, N, s, model_type):\n    \"\"\"\n    Calculates the log-marginal-likelihood (log-evidence) for a Bayesian linear model.\n\n    Args:\n        y (list): List of measurement values.\n        sigma (list): List of measurement standard deviations.\n        N (list): List of neutron numbers.\n        s (float): Prior standard deviation for model parameters.\n        model_type (str): 'M0' for the null model, 'M1' for the alternative model.\n\n    Returns:\n        float: The natural logarithm of the model evidence, ln(Z).\n    \"\"\"\n    n = len(y)\n    y_vec = np.array(y)\n    \n    # Construct the design matrix X based on the model type\n    ones = np.ones(n)\n    neutrons = np.array(N)\n    \n    if model_type == 'M0':\n        # Model M0: y = beta_0 + beta_1 * N\n        X = np.stack([ones, neutrons], axis=1)\n    elif model_type == 'M1':\n        # Model M1: y = beta_0 + beta_1 * N + gamma * d(N)\n        d_N = (neutrons == 32).astype(float)\n        X = np.stack([ones, neutrons, d_N], axis=1)\n    else:\n        raise ValueError(\"Invalid model type specified. Must be 'M0' or 'M1'.\")\n\n    # Construct the covariance matrix of the measurement errors (likelihood)\n    Sigma_y = np.diag(np.array(sigma)**2)\n    \n    # The prior covariance is s^2 * I.\n    # The covariance of the predictive distribution for y is C = Sigma_y + X * Sigma_beta * X.T\n    # which simplifies to C = Sigma_y + s^2 * X @ X.T\n    C = Sigma_y + (s**2) * (X @ X.T)\n    \n    # Calculate the log-determinant of C. slogdet is used for numerical stability.\n    sign, logdet_C = np.linalg.slogdet(C)\n    if sign <= 0:\n        # For a valid covariance matrix, the determinant must be positive.\n        # This case should not be reached with the given problem setup.\n        raise RuntimeError(\"Determinant of the predictive covariance matrix C is not positive.\")\n\n    # Calculate the inverse of C\n    try:\n        inv_C = np.linalg.inv(C)\n    except np.linalg.LinAlgError:\n        # C is singular, evidence is effectively zero.\n        raise RuntimeError(\"Predictive covariance matrix C is singular and cannot be inverted.\")\n\n    # Calculate the quadratic form y.T * C^-1 * y\n    quad_term = y_vec.T @ inv_C @ y_vec\n    \n    # Calculate the log-evidence using the formula for the log of a multivariate normal PDF\n    # evaluated at y, with mean 0 and covariance C.\n    # ln(Z) = -n/2*ln(2*pi) - 1/2*ln|C| - 1/2 * y.T * C^-1 * y\n    log_Z = -0.5 * n * np.log(2 * np.pi) - 0.5 * logdet_C - 0.5 * quad_term\n    \n    return log_Z\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Test Case A (pronounced shell gap at N=32)\n        [\n            {'N': [30, 32, 34], 'y': [20.0, 16.8, 17.6], 'sigma': [0.2, 0.2, 0.2], 's': 10.0},\n            {'N': [30, 32, 34], 'y': [1.0, 2.3, 1.2], 'sigma': [0.05, 0.05, 0.05], 's': 3.0},\n            {'N': [30, 32, 34], 'y': [0.20, 0.06, 0.16], 'sigma': [0.01, 0.01, 0.01], 's': 0.5}\n        ],\n        # Test Case B (no shell gap, smooth trend)\n        [\n            {'N': [30, 32, 34], 'y': [20.0, 18.8, 17.6], 'sigma': [0.2, 0.2, 0.2], 's': 10.0},\n            {'N': [30, 32, 34], 'y': [1.0, 1.1, 1.2], 'sigma': [0.05, 0.05, 0.05], 's': 3.0},\n            {'N': [30, 32, 34], 'y': [0.20, 0.18, 0.16], 'sigma': [0.01, 0.01, 0.01], 's': 0.5}\n        ],\n        # Test Case C (sparse measurements, larger uncertainties)\n        [\n            {'N': [30, 32], 'y': [20.0, 18.8], 'sigma': [0.5, 0.5], 's': 10.0},\n            {'N': [30, 32], 'y': [1.0, 1.1], 'sigma': [0.2, 0.2], 's': 3.0},\n            {'N': [30, 32], 'y': [0.20, 0.18], 'sigma': [0.05, 0.05], 's': 0.5}\n        ]\n    ]\n\n    results = []\n    for case_data in test_cases:\n        total_log_Z0 = 0.0\n        total_log_Z1 = 0.0\n        \n        for obs_data in case_data:\n            # Unpack data for the current observable\n            y, sigma, N, s = obs_data['y'], obs_data['sigma'], obs_data['N'], obs_data['s']\n            \n            # Calculate and accumulate log-evidence for model M0\n            log_Z0 = calculate_log_evidence(y, sigma, N, s, 'M0')\n            total_log_Z0 += log_Z0\n            \n            # Calculate and accumulate log-evidence for model M1\n            log_Z1 = calculate_log_evidence(y, sigma, N, s, 'M1')\n            total_log_Z1 += log_Z1\n            \n        # Compute the natural logarithm of the Bayes factor K = Z1/Z0\n        log_K = total_log_Z1 - total_log_Z0\n        \n        # Convert to base-10 logarithm\n        log10_K = log_K / np.log(10)\n        \n        results.append(round(log10_K, 3))\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}