{
    "hands_on_practices": [
        {
            "introduction": "Before diving into large-scale computations, it is crucial to grasp the physical principles that govern the distribution of spectroscopic strength. This foundational exercise guides you through an analytical derivation using the elegant seniority scheme, a cornerstone of the shell model. By applying its selection rules, you will determine how the total spectroscopic strength is partitioned, revealing the fundamental difference between removing a nucleon from a $J=0$ pair versus removing an already unpaired nucleon .",
            "id": "3591818",
            "problem": "In a single-orbit nuclear shell-model calculation for identical neutrons occupying a single orbital with total single-particle angular momentum $j$ (degeneracy $2j+1$), consider an even-$n$ configuration $j^{n}$ in the pure seniority scheme (no configuration mixing, seniority $v$ is a good quantum number). The nuclear one-nucleon removal spectroscopic factor $S_{n\\ell j}(f \\leftarrow i)$ for removing a neutron from the $(n,\\ell,j)$ orbital is defined, for an initial state $\\lvert i; j^{n}, J_{i} \\rangle$ and a final state $\\lvert f; j^{n-1}, J_{f} \\rangle$, by\n$$\nS_{n\\ell j}(f \\leftarrow i) \\equiv \\frac{1}{2J_{i}+1} \\sum_{M_{i},M_{f},m} \\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2},\n$$\nwhere $a_{jm}$ annihilates a neutron of quantum numbers $(\\ell,j,m)$ in that orbital.\n\nStarting only from this definition, the orthonormality/completeness of the final-state basis, and the seniority interpretation (seniority $v$ counts the number of nucleons not coupled to angular momentum $J=0$ pairs), do the following:\n\n1. Derive the sum rule for removal strength,\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = n_{j},\n$$\nwhere $n_{j}$ is the expectation value of the number operator in the $(n,\\ell,j)$ orbital for the initial state, and specialize to the pure $j^{n}$ configuration where $n_{j}=n$.\n\n2. Using the seniority selection under a one-body annihilation operator (which changes seniority by $\\Delta v = \\pm 1$ in the pure seniority limit) together with the interpretation of $v$ as the number of unpaired nucleons and $n-v$ as the number of nucleons in $J=0$ pairs, argue how the total removal strength partitions between final seniorities $v' = v-1$ and $v' = v+1$. State the resulting total strengths to each seniority class in terms of $n$ and $v$.\n\n3. Consider two initial even-$n$ cases in the same $j$ orbital: (i) the fully paired seniority-$v=0$ ground configuration $j^{n}(v=0)$, and (ii) a seniority-$v=2$ configuration $j^{n}(v=2)$. For each, compute the total removal spectroscopic factor to final states with $v'=1$. Then, compute the ratio\n$$\nR(n) \\equiv \\frac{\\text{total } S_{n\\ell j} \\text{ for } j^{n}(v=2) \\to j^{n-1}(v'=1)}{\\text{total } S_{n\\ell j} \\text{ for } j^{n}(v=0) \\to j^{n-1}(v'=1)}.\n$$\n\nExplain in words how the redistribution of strength between $v'=1$ and $v'=3$ for the $v=2$ initial state reflects the physics of removing an unpaired nucleon versus breaking a $J=0$ pair. Express your final answer for $R(n)$ as a simplified analytic expression in $n$. No numerical evaluation is required, and no units are involved.",
            "solution": "This problem will be addressed in three parts as requested. First, the sum rule for spectroscopic factors will be derived. Second, the partitioning of this total strength according to seniority selection rules will be established. Finally, these results will be applied to specific seniority states to compute the required ratio.\n\nPart 1: Derivation of the Sum Rule\n\nThe problem asks to derive the sum rule for the one-nucleon removal spectroscopic factor, $S_{n\\ell j}$. We start with the definition provided:\n$$\nS_{n\\ell j}(f \\leftarrow i) \\equiv \\frac{1}{2J_{i}+1} \\sum_{M_{i},M_{f},m} \\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2}\n$$\nTo find the total removal strength from an initial state $\\lvert i \\rangle$ to all possible final states $\\lvert f \\rangle$, we sum $S_{n\\ell j}(f \\leftarrow i)$ over all final states $f$. Note that the set of states $\\{ \\lvert f; J_{f} M_{f} \\rangle \\}$ forms a complete orthonormal basis for the $(n-1)$-particle system.\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\sum_{f} \\left( \\frac{1}{2J_{i}+1} \\sum_{M_{i},M_{f},m} \\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2} \\right)\n$$\nWe can interchange the order of summation. The sum over $f$ includes a sum over all of its defining quantum numbers, including $J_f$.\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} \\sum_{M_{i},m} \\sum_{f,M_{f}} \\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2}\n$$\nThe squared matrix element can be written as a product of the matrix element and its complex conjugate:\n$$\n\\left| \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle \\right|^{2} = \\langle i; J_{i} M_{i} \\lvert a_{j m}^{\\dagger} \\rvert f; J_{f} M_{f} \\rangle \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle\n$$\nInserting this into the sum:\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} \\sum_{M_{i},m} \\sum_{f,M_{f}} \\langle i; J_{i} M_{i} \\lvert a_{j m}^{\\dagger} \\rvert f; J_{f} M_{f} \\rangle \\langle f; J_{f} M_{f} \\lvert a_{j m} \\rvert i; J_{i} M_{i} \\rangle\n$$\nWe now use the completeness relation for the final states, $\\sum_{f,M_{f}} \\lvert f; J_{f} M_{f} \\rangle \\langle f; J_{f} M_{f} \\rvert = \\hat{\\mathbb{I}}$, where $\\hat{\\mathbb{I}}$ is the identity operator in the $(n-1)$-particle Hilbert space. The expression simplifies to:\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} \\sum_{M_{i},m} \\langle i; J_{i} M_{i} \\lvert a_{j m}^{\\dagger} a_{j m} \\rvert i; J_{i} M_{i} \\rangle\n$$\nThe sum over the magnetic substate $m$ of the product of creation and annihilation operators, $\\sum_{m=-j}^{j} a_{j m}^{\\dagger} a_{j m}$, defines the number operator $\\hat{n}_{j}$ for the orbital $j$.\n$$\n\\hat{n}_{j} = \\sum_{m=-j}^{j} a_{j m}^{\\dagger} a_{j m}\n$$\nSubstituting this into our equation gives:\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} \\sum_{M_{i}} \\langle i; J_{i} M_{i} \\lvert \\hat{n}_{j} \\rvert i; J_{i} M_{i} \\rangle\n$$\nThe number operator $\\hat{n}_{j}$ is a scalar operator, meaning its expectation value is independent of the magnetic quantum number $M_i$ of the state. Therefore, the sum over $M_i$ yields $2J_i+1$ identical terms:\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = \\frac{1}{2J_{i}+1} (2J_{i}+1) \\langle i; J_{i} M_{i} \\lvert \\hat{n}_{j} \\rvert i; J_{i} M_{i} \\rangle = \\langle \\hat{n}_{j} \\rangle_{i}\n$$\nThis is the general sum rule, stating that the total removal strength is equal to the expectation value of the number operator in the initial state, which is denoted as $n_j$. For a pure configuration $j^n$, the initial state $\\lvert i \\rangle$ is an eigenstate of $\\hat{n}_j$ with eigenvalue $n$. Thus, $\\langle \\hat{n}_j \\rangle_i = n$. The sum rule specializes to:\n$$\n\\sum_{f} S_{n\\ell j}(f \\leftarrow i) = n\n$$\n\nPart 2: Partition of Strength by Seniority\n\nWe are given that seniority $v$ represents the number of nucleons not coupled to angular momentum $J=0$ pairs, and that the single-nucleon annihilation operator $a_{jm}$ induces transitions with a change in seniority $\\Delta v = v' - v = \\pm 1$. The total number of nucleons is $n$, and the number of paired nucleons is $n-v$.\n\nThe process of removing one nucleon via $a_{jm}$ can be pictured in two ways:\n1.  Removing an unpaired nucleon: The initial state has $v$ unpaired nucleons. If we remove one of them, the number of unpaired nucleons in the final $(n-1)$-particle system becomes $v-1$. The number of pairs, $\\frac{n-v}{2}$, remains unchanged. The final seniority is $v' = v-1$. This corresponds to the $\\Delta v = -1$ selection rule.\n2.  Removing a paired nucleon: The initial state has $n-v$ nucleons participating in $J=0$ pairs. If we remove one nucleon from a pair, the pair is broken. The other nucleon of that pair is now unpaired. The final state thus has the original $v$ unpaired nucleons plus this newly unpaired one, for a total of $v+1$ unpaired nucleons. The final seniority is $v' = v+1$. This corresponds to the $\\Delta v = +1$ selection rule.\n\nThe sum rule states the total strength is $n$. This strength must be partitioned between the two possible final seniority classes, $v'=v-1$ and $v'=v+1$. The simplest and most direct interpretation, consistent with the problem's framing, is that the spectroscopic strength for each process is proportional to the number of nucleons available for that process.\n- The strength for transitions to $v' = v-1$ (removing an unpaired nucleon) is proportional to the number of unpaired nucleons, which is $v$.\n- The strength for transitions to $v' = v+1$ (removing a paired nucleon) is proportional to the number of paired nucleons, which is $n-v$.\n\nLet $S_{v \\to v'}$ be the total summed spectroscopic strength for transitions from an initial state of seniority $v$ to all final states of seniority $v'$. We can write:\n$S_{v \\to v-1} = C \\cdot v$\n$S_{v \\to v+1} = C \\cdot (n-v)$\nfor some constant of proportionality $C$.\nFrom the sum rule derived in Part 1, the total strength must be $n$:\n$S_{v \\to v-1} + S_{v \\to v+1} = n$\n$C \\cdot v + C \\cdot (n-v) = C \\cdot n = n$\nThis implies that the constant of proportionality is $C=1$. Therefore, the total strengths to each seniority class are:\n- Total strength to $v' = v-1$: $S_{v \\to v-1} = v$\n- Total strength to $v' = v+1$: $S_{v \\to v+1} = n-v$\n\nPart 3: Calculation of the Ratio $R(n)$\n\nWe apply the results from Part 2 to the two specified initial cases to find the total spectroscopic factor to final states with $v'=1$.\n\nCase (i): Initial state is $j^{n}(v=0)$.\nThe initial seniority is $v=0$. This is the fully paired configuration, containing $0$ unpaired nucleons and $n-0=n$ paired nucleons. We are removing one nucleon, so the final state will have $n-1$ nucleons. The possible final seniorities are $v' = v \\pm 1 = 0 \\pm 1$. Since seniority cannot be negative, the only possible final seniority is $v'=1$. This corresponds to a $\\Delta v = +1$ transition.\nThe total strength to $v'=1$ is given by the formula for $S_{v \\to v+1}$ with $v=0$:\n$$S_{j^{n}(v=0) \\to j^{n-1}(v'=1)} = n-v = n-0 = n$$\nPhysically, since all $n$ nucleons are in pairs, removing any one of them must break a pair, leading to a final state with $v'=1$. Thus, the entire strength of $n$ goes to this channel.\n\nCase (ii): Initial state is $j^{n}(v=2)$.\nThe initial seniority is $v=2$. This state has $2$ unpaired nucleons and $n-2$ paired nucleons. The possible final seniorities are $v' = v \\pm 1 = 2 \\pm 1$, which means $v'=1$ or $v'=3$. We are interested in the strength to final states with $v'=1$.\nThe transition $j^{n}(v=2) \\to j^{n-1}(v'=1)$ corresponds to a change $\\Delta v = 1 - 2 = -1$.\nThe total strength for this process is given by the formula for $S_{v \\to v-1}$ with $v=2$:\n$$S_{j^{n}(v=2) \\to j^{n-1}(v'=1)} = v = 2$$\nThis strength of $2$ corresponds to removing one of the two already unpaired nucleons. The remaining strength, $S_{j^{n}(v=2) \\to j^{n-1}(v'=3)} = n-v = n-2$, corresponds to breaking a pair.\n\nNow we compute the ratio $R(n)$:\n$$\nR(n) \\equiv \\frac{\\text{total } S_{n\\ell j} \\text{ for } j^{n}(v=2) \\to j^{n-1}(v'=1)}{\\text{total } S_{n\\ell j} \\text{ for } j^{n}(v=0) \\to j^{n-1}(v'=1)}\n$$\nSubstituting the calculated values:\n$$\nR(n) = \\frac{2}{n}\n$$\n\nPhysical Interpretation:\nIn the $j^{n}(v=0)$ initial state, all $n$ nucleons are in $J=0$ pairs. The removal of any nucleon necessarily breaks a pair, leading to a final state of seniority $v'=1$. The total removal strength, $n$, is therefore entirely concentrated in populating $v'=1$ states.\nIn the $j^{n}(v=2)$ initial state, the nucleons are of two types: $2$ are unpaired, and $n-2$ are paired. Removing one of the $2$ unpaired nucleons leads to a final state with seniority $v'=1$; the strength for this is $2$. Removing one of the $n-2$ paired nucleons breaks a pair and leads to a final state with seniority $v'=3$; the strength for this is $n-2$. The total strength $n$ is thus split between these two channels. The ratio $R(n)=2/n$ compares the absolute strength to the $v'=1$ final states from these two different starting points. It highlights how for a $v=2$ initial state, only a small fraction of the total strength ($2$ out of $n$) populates $v'=1$ states, a process corresponding to removing an 'spectator' unpaired nucleon. The dominant process is breaking an additional pair, which populates $v'=3$ states.",
            "answer": "$$\n\\boxed{\\frac{2}{n}}\n$$"
        },
        {
            "introduction": "In realistic nuclei, single-particle states are not pure; the residual interaction causes them to mix, leading to a fragmentation of spectroscopic strength across multiple final states. This hands-on computational experiment uses a simple but powerful two-level model to investigate this critical phenomenon. By systematically applying a \"monopole shift\" to control the energy splitting between two orbitals, you will directly observe and quantify how configuration mixing redistributes single-particle strength, providing key insights into the structure of complex nuclear states .",
            "id": "3591801",
            "problem": "You are asked to design and implement a complete, self-contained computational experiment that models the redistribution of single-particle strength in a minimal shell-model setting by applying controlled monopole shifts, and quantifies the non-linear response of the spectroscopic factor for near-degenerate orbitals. Your implementation must be a runnable program that outputs the requested numerical quantities for a specified test suite.\n\nBegin from the following fundamental base:\n\n1. A one-body shell-model Hamiltonian in a truncated single-particle space is represented by a Hermitian matrix whose diagonal elements are single-particle energies and whose off-diagonal elements encode residual mixing that couples orbitals. In matrix form for a two-orbital subspace, this is a real symmetric matrix. This follows from the standard formulation of quantum mechanics where observable operators are Hermitian.\n\n2. Spectroscopic factors are defined through one-body overlaps between exact many-body states connected by a one-nucleon transfer, and are dimensionless, bounded between zero and one. In a model with an inert core and a single valence nucleon distributed over a small set of single-particle orbitals, the many-body problem reduces to the diagonalization of a finite-dimensional one-body Hamiltonian for the valence space, and the spectroscopic factor to add a nucleon into a basis orbital from the inert core equals the norm of the corresponding component of the normalized eigenstate vector in that basis. This is a direct consequence of second-quantized orthonormality of single-particle states and the definition of the transfer amplitude.\n\n3. A monopole shift acts as a controlled, physically motivated diagonal energy shift of specific orbitals due to changes in the mean field with occupancy. In a parametric study, such a shift can be treated as an external control parameter modifying a chosen orbital’s energy by an amount that you will vary explicitly. This preserves Hermiticity and tests sensitivity of observables to single-particle centroids.\n\nModel, definitions, and tasks:\n\n- Consider two single-particle orbitals, labeled by basis states $\\lvert a \\rangle$ and $\\lvert b \\rangle$, initially characterized by single-particle energies $\\epsilon_a$ and $\\epsilon_b$ (in $\\mathrm{MeV}$). Assume a residual mixing matrix element $v$ (in $\\mathrm{MeV}$) couples $\\lvert a \\rangle$ and $\\lvert b \\rangle$ in the one-body Hamiltonian. Introduce a monopole control variable $x$ (in $\\mathrm{MeV}$) that shifts only orbital $b$ according to $\\epsilon_b \\mapsto \\epsilon_b + x$, while $\\epsilon_a$ remains unchanged. The truncated one-body Hamiltonian in the ordered basis $\\{\\lvert a \\rangle,\\lvert b \\rangle\\}$ is then a real symmetric $2 \\times 2$ matrix\n$$\nH(x) \\equiv\n\\begin{pmatrix}\n\\epsilon_a  v \\\\\nv  \\epsilon_b + x\n\\end{pmatrix}.\n$$\n\n- For each $x$, obtain the lowest-energy normalized eigenstate $\\lvert \\psi_{\\min}(x) \\rangle$ of $H(x)$. Denote its components in the chosen basis as\n$$\n\\lvert \\psi_{\\min}(x) \\rangle = c_a(x) \\lvert a \\rangle + c_b(x) \\lvert b \\rangle,\n$$\nwith $\\lvert c_a(x) \\rvert^2 + \\lvert c_b(x) \\rvert^2 = 1$.\n\n- Define the spectroscopic factor for adding a nucleon into orbital $a$ as\n$$\nS_a(x) \\equiv \\lvert c_a(x) \\rvert^2,\n$$\nwhich is dimensionless.\n\n- To quantify non-linearity in the response of $S_a(x)$ to the monopole shift, estimate the local curvature at $x = 0$ using the central second finite difference with a small step $h$ (in $\\mathrm{MeV}$):\n$$\n\\kappa \\equiv \\frac{S_a(h) - 2 S_a(0) + S_a(-h)}{h^2},\n$$\nwhich has units of $\\mathrm{MeV}^{-2}$.\n\nImplementation requirements:\n\n- Write a program that, for each specified test case, constructs $H(x)$, diagonalizes it to obtain $\\lvert \\psi_{\\min}(x) \\rangle$, computes $S_a(x)$ at $x \\in \\{-h, 0, +h\\}$, and then computes the curvature $\\kappa$ using the above discrete formula. All energies must be in $\\mathrm{MeV}$, and the curvature must be in $\\mathrm{MeV}^{-2}$.\n\n- Your program must not require any user input and must use the following test suite. Each test case is a $4$-tuple $(\\epsilon_a, \\epsilon_b, v, h)$, all in $\\mathrm{MeV}$:\n    1. $(0.0, 0.01, 0.005, 0.01)$\n    2. $(0.0, 0.0005, 0.0001, 0.0005)$\n    3. $(0.0, 0.0, 0.2, 0.05)$\n    4. $(0.1, 0.0, 0.03, 0.05)$\n\n- For each test case, the program must produce a $4$-tuple of floats:\n$$\n\\big[ S_a(-h),\\ S_a(0),\\ S_a(+h),\\ \\kappa \\big],\n$$\nwhere $S_a(\\cdot)$ is dimensionless and $\\kappa$ is in $\\mathrm{MeV}^{-2}$.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, with each test case reported as a nested list of four floats in the specified order. The final printed string must look like\n$$\n\\left[\n\\left[S_a(-h), S_a(0), S_a(+h), \\kappa\\right],\\ \\ldots\\ \\text{for all cases}\n\\right]\n$$\nwith no additional text. For example, a valid shape would be\n$[[s_{1,-}, s_{1,0}, s_{1,+}, \\kappa_1],[s_{2,-}, s_{2,0}, s_{2,+}, \\kappa_2],\\ldots]$.",
            "solution": "The problem statement is critically examined and determined to be valid. It is scientifically grounded in the principles of quantum mechanics, specifically the application of the shell model in nuclear physics. The problem is well-posed, objective, and contains all necessary information for a unique and meaningful solution. The specified computational task is a standard exercise in computational physics, involving the diagonalization of a small Hamiltonian matrix and the numerical estimation of a derivative.\n\nThe solution proceeds as follows. We are tasked with analyzing a two-level quantum system, a simplified representation of a single nucleon's behavior in a valence space comprised of two single-particle orbitals, $\\lvert a \\rangle$ and $\\lvert b \\rangle$. The system's dynamics are governed by a one-body Hamiltonian, which, in the basis $\\{\\lvert a \\rangle, \\lvert b \\rangle\\}$, is given by the real symmetric matrix:\n$$\nH(x) =\n\\begin{pmatrix}\n\\epsilon_a  v \\\\\nv  \\epsilon_b + x\n\\end{pmatrix}\n$$\nHere, $\\epsilon_a$ and $\\epsilon_b$ are the unperturbed single-particle energies of the orbitals, $v$ is the residual interaction strength that mixes the two basis states, and $x$ is an external parameter representing a monopole shift applied to orbital $\\lvert b \\rangle$. All these quantities are given in units of $\\mathrm{MeV}$.\n\nAccording to the postulates of quantum mechanics, the stationary states of the system are the eigenstates of the Hamiltonian, and their corresponding energies are the eigenvalues. To find the lowest-energy state, $\\lvert \\psi_{\\min}(x) \\rangle$, we must solve the time-independent Schrödinger equation, which in this matrix representation is an eigenvalue problem:\n$$\nH(x) \\lvert \\psi(x) \\rangle = E(x) \\lvert \\psi(x) \\rangle\n$$\nFor a $2 \\times 2$ real symmetric matrix, there will be two real eigenvalues, $E_{\\min}(x)$ and $E_{\\max}(x)$, and a corresponding set of two orthonormal eigenvectors. We are interested in the eigenstate $\\lvert \\psi_{\\min}(x) \\rangle$ associated with the lowest eigenvalue $E_{\\min}(x)$. This eigenstate can be expressed as a linear combination of the basis states:\n$$\n\\lvert \\psi_{\\min}(x) \\rangle = c_a(x) \\lvert a \\rangle + c_b(x) \\lvert b \\rangle\n$$\nThe coefficients $c_a(x)$ and $c_b(x)$ are the components of the normalized eigenvector corresponding to $E_{\\min}(x)$. The normalization condition requires that $\\lvert c_a(x) \\rvert^2 + \\lvert c_b(x) \\rvert^2 = 1$.\n\nThe spectroscopic factor for adding a nucleon into orbital $a$ to reach the final state $\\lvert \\psi_{\\min}(x) \\rangle$ is defined as the square of the overlap integral, which in this model simplifies to $S_a(x) \\equiv \\lvert c_a(x) \\rvert^2$. This quantity, being a squared norm, is dimensionless and represents the probability of finding the system in the configuration described by the basis state $\\lvert a \\rangle$.\n\nThe core of the computational task is to implement an algorithm that, for each given parameter set $(\\epsilon_a, \\epsilon_b, v, h)$, performs the following steps:\n$1$. Define the range of the monopole shift parameter to be evaluated: $x \\in \\{-h, 0, +h\\}$.\n$2$. For each value of $x$ in this set:\n    a. Construct the numerical matrix for the Hamiltonian $H(x)$.\n    b. Diagonalize $H(x)$ to find its eigenvalues and eigenvectors. Standard numerical linear algebra libraries provide robust routines for diagonalizing Hermitian matrices, such as `numpy.linalg.eigh`, which conveniently returns eigenvalues sorted in ascending order and the corresponding orthonormal eigenvectors.\n    c. Identify the lowest eigenvalue, $E_{\\min}(x)$, which will be the first element of the sorted list of eigenvalues.\n    d. Extract the corresponding eigenvector, $\\lvert \\psi_{\\min}(x) \\rangle$. Its components, $c_a(x)$ and $c_b(x)$, will form the first column of the eigenvector matrix returned by the diagonalization routine.\n    e. Calculate the spectroscopic factor $S_a(x)$ by squaring the first component of this eigenvector: $S_a(x) = (c_a(x))^2$.\n$3$. After obtaining the three values $S_a(-h)$, $S_a(0)$, and $S_a(+h)$, calculate the local curvature $\\kappa$ of the function $S_a(x)$ at $x=0$. This is estimated using the central second finite difference formula:\n$$\n\\kappa = \\frac{S_a(h) - 2 S_a(0) + S_a(-h)}{h^2}\n$$\nThe units of $\\kappa$ are $\\mathrm{MeV}^{-2}$, as $S_a$ is dimensionless and both $h$ and $x$ are in $\\mathrm{MeV}$.\n\nThis procedure is systematically applied to each test case provided in the problem statement. The final output for each case is a collection of the four computed floating-point numbers: $[S_a(-h), S_a(0), S_a(+h), \\kappa]$. The program is designed to be self-contained and to print the results for all test cases in the specified list-of-lists format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem for a given set of test cases.\n\n    This function iterates through a predefined test suite. For each case, it models\n    a two-level quantum system, calculates spectroscopic factors under monopole shifts,\n    and computes the curvature of the spectroscopic factor response.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (epsilon_a, epsilon_b, v, h) in MeV.\n    test_cases = [\n        (0.0, 0.01, 0.005, 0.01),\n        (0.0, 0.0005, 0.0001, 0.0005),\n        (0.0, 0.0, 0.2, 0.05),\n        (0.1, 0.0, 0.03, 0.05),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        epsilon_a, epsilon_b, v, h = case\n        \n        spectroscopic_factors = {}\n\n        # The monopole shift 'x' is evaluated at -h, 0, and +h.\n        for x_val in [-h, 0, h]:\n            # Construct the 2x2 one-body Hamiltonian matrix H(x).\n            # H(x) = [[epsilon_a,   v          ],\n            #         [v,           epsilon_b + x]]\n            hamiltonian = np.array([\n                [epsilon_a, v],\n                [v, epsilon_b + x_val]\n            ])\n\n            # Diagonalize the Hermitian Hamiltonian.\n            # numpy.linalg.eigh returns eigenvalues in ascending order and\n            # corresponding eigenvectors as columns of a matrix.\n            eigenvalues, eigenvectors = np.linalg.eigh(hamiltonian)\n\n            # The lowest-energy eigenstate corresponds to the first eigenvalue.\n            # Its eigenvector is the first column of the eigenvectors matrix.\n            # The eigenvector is already normalized.\n            lowest_eigenstate_vector = eigenvectors[:, 0]\n\n            # The component c_a(x) is the first element of this vector.\n            c_a = lowest_eigenstate_vector[0]\n\n            # The spectroscopic factor S_a(x) is the square of the component c_a(x).\n            s_a = c_a**2\n            \n            spectroscopic_factors[x_val] = s_a\n\n        # Extract the computed spectroscopic factors.\n        s_a_minus_h = spectroscopic_factors.get(-h)\n        s_a_zero = spectroscopic_factors.get(0)\n        s_a_plus_h = spectroscopic_factors.get(h)\n\n        # Calculate the curvature kappa using the central second finite difference.\n        # kappa = (S_a(h) - 2*S_a(0) + S_a(-h)) / h^2\n        # Handle the case h=0 to avoid division by zero, although not expected in test cases.\n        if h == 0.0:\n            kappa = 0.0\n        else:\n            kappa = (s_a_plus_h - 2 * s_a_zero + s_a_minus_h) / (h**2)\n\n        # Store the results for this test case as a list of four floats.\n        case_result = [s_a_minus_h, s_a_zero, s_a_plus_h, kappa]\n        all_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The standard string representation of a list of lists is used.\n    print(str(all_results))\n\nsolve()\n```"
        },
        {
            "introduction": "The shell-model spectroscopic factor is a theoretical construct related to the nuclear interior, yet it is experimentally inferred from transfer reactions, which are peripheral processes sensitive to the wavefunction's tail. This practice explores the connection between the spectroscopic factor, $S$, and the Asymptotic Normalization Coefficient (ANC), which characterizes the wavefunction's exterior. Through a computational model of a neutron in a potential well, you will demonstrate that for weakly bound systems, the ANC can change dramatically while the interior wavefunction shape—and thus the spectroscopic factor—remains relatively stable, highlighting an important subtlety in comparing theory and experiment .",
            "id": "3591851",
            "problem": "Consider a single neutron in a mean-field potential described by a spherical square-well of radius $R$ and depth $V_{0}$, such that $V(r) = -V_{0}$ for $0 \\le r  R$ and $V(r) = 0$ for $r \\ge R$. Work in the radial Schrödinger equation for the reduced radial wave function $u(r)$ (defined by $u(r) = r R(r)$ where $R(r)$ is the usual radial part of the wave function), with orbital angular momentum $l = 0$ (s-wave). Use the nonrelativistic kinetic term for a neutron with reduced mass $\\mu$ approximated by the neutron mass. Adopt the well-tested constant $\\hbar^{2}/(2\\mu) = 20.735$ in units of $\\text{MeV}\\cdot\\text{fm}^{2}$. Assume bound state energies $E = -E_{b}$ with $E_{b}  0$.\n\nStarting from the fundamental base of the time-independent Schrödinger equation and the definition of bound states, derive from first principles the piecewise form of $u(r)$ inside and outside the well for $l=0$, enforce physical boundary conditions and continuity to determine the relationship between the interior wavenumber and the exterior decay constant, and normalize $u(r)$ to unit probability:\n$$\\int_{0}^{\\infty} |u(r)|^{2} \\, dr = 1.$$\nDefine the Asymptotic Normalization Coefficient (ANC) as follows: for $r \\ge R$, the reduced radial wave function must decay as\n$$u(r) \\approx C \\, e^{-\\kappa r},$$\nwhere $\\kappa = \\sqrt{E_{b} / \\left(\\hbar^{2}/(2\\mu)\\right)}$ and $C$ is the ANC. For the purposes of quantification, define the interior overlap similarity between two normalized reduced radial wave functions $u_{a}(r)$ and $u_{b}(r)$ over the interior region $[0,R]$ by the cosine of the angle between them in the Hilbert space restricted to $[0,R]$:\n$$\\mathcal{S}_{\\mathrm{int}}(u_{a},u_{b}) = \\frac{\\int_{0}^{R} u_{a}(r) \\, u_{b}(r) \\, dr}{\\sqrt{\\left(\\int_{0}^{R} |u_{a}(r)|^{2} \\, dr\\right)\\left(\\int_{0}^{R} |u_{b}(r)|^{2} \\, dr\\right)}}.$$\nThis quantity satisfies $0 \\le \\mathcal{S}_{\\mathrm{int}} \\le 1$ and measures the interior-shape similarity independent of their exterior tails.\n\nYour task is to implement a program that, for a fixed well radius $R$ and a set of bound-state energies $E_{b}$, computes:\n- the ANC $C$ (in units of $\\text{fm}^{-1/2}$), and\n- the interior similarity $\\mathcal{S}_{\\mathrm{int}}(u_{\\mathrm{ref}}, u_{E_{b}})$ relative to a designated reference bound state $u_{\\mathrm{ref}}$ at a specified reference binding energy $E_{b}^{\\mathrm{ref}}$.\n\nBase everything on the definitions and boundary/matching conditions implied by the Schrödinger equation. Do not assume any formula that is not derived from these principles.\n\nNumerical and physical parameters to use (all mathematical entities and numbers are specified here):\n- Square-well radius: $R = 4.0$ in $\\text{fm}$.\n- Kinetic constant: $\\hbar^{2}/(2\\mu) = 20.735$ in $\\text{MeV}\\cdot\\text{fm}^{2}$.\n- Orbital angular momentum: $l = 0$.\n- Test suite of binding energies: $E_{b} \\in \\{0.05, 0.5, 1.0, 2.0, 5.0\\}$ in $\\text{MeV}$.\n- Reference binding energy: $E_{b}^{\\mathrm{ref}} = 1.0$ in $\\text{MeV}$.\n\nFor each $E_{b}$ in the test suite, construct the normalized bound-state reduced radial wave function $u_{E_{b}}(r)$ that satisfies the Schrödinger equation in the square-well potential, the appropriate boundary conditions, and the matching conditions at $r = R$. Compute:\n- the ANC $C$ in $\\text{fm}^{-1/2}$, and\n- the interior similarity $\\mathcal{S}_{\\mathrm{int}}(u_{\\mathrm{ref}}, u_{E_{b}})$ over $[0,R]$ with $u_{\\mathrm{ref}} = u_{E_{b}^{\\mathrm{ref}}}$.\n\nDemonstrate, via the computed values, that as $E_{b}$ varies, the ANC $C$ changes significantly for weak binding while the interior similarity $\\mathcal{S}_{\\mathrm{int}}$ remains close to unity, indicating a nearly constant interior overlap (and, by implication, a nearly constant spectroscopic factor in the shell-model sense).\n\nAngle units are not applicable here. All physical units must be respected as specified: report $C$ in units of $\\text{fm}^{-1/2}$ and report $\\mathcal{S}_{\\mathrm{int}}$ as a dimensionless number. For numerical reporting, round both $C$ and $\\mathcal{S}_{\\mathrm{int}}$ to $6$ decimal places.\n\nFinal output format specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list in the order $[C,\\mathcal{S}_{\\mathrm{int}}]$ corresponding to the binding energies in the test suite in the given order $[0.05, 0.5, 1.0, 2.0, 5.0]$. For example, the printed line must look like\n$$[ [C_{1}, S_{1}], [C_{2}, S_{2}], [C_{3}, S_{3}], [C_{4}, S_{4}], [C_{5}, S_{5}] ],$$\nwith each $C_{i}$ in $\\text{fm}^{-1/2}$ and each $S_{i}$ dimensionless, both rounded to $6$ decimal places.",
            "solution": "The user wants to analyze the properties of a neutron bound state in a spherical square-well potential. The problem requires a first-principles derivation of the wavefunction, followed by a numerical implementation to compute the Asymptotic Normalization Coefficient (ANC) and an interior overlap similarity for a given set of binding energies.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n\n-   **Potential**: Spherical square-well, $V(r) = -V_{0}$ for $0 \\le r  R$ and $V(r) = 0$ for $r \\ge R$.\n-   **Particle**: Single neutron with reduced mass $\\mu$ approximated by neutron mass.\n-   **Kinetic Term**: Nonrelativistic.\n-   **Constant**: $\\hbar^{2}/(2\\mu) = 20.735$ in units of $\\text{MeV}\\cdot\\text{fm}^{2}$.\n-   **Angular Momentum**: $l = 0$ (s-wave).\n-   **Wavefunction**: Reduced radial wave function $u(r) = r R(r)$.\n-   **Energy**: Bound states with energy $E = -E_{b}$, where $E_{b}  0$.\n-   **Well Radius**: $R = 4.0$ fm.\n-   **Binding Energies**: Test suite $E_{b} \\in \\{0.05, 0.5, 1.0, 2.0, 5.0\\}$ in MeV.\n-   **Reference Energy**: $E_{b}^{\\mathrm{ref}} = 1.0$ in MeV.\n-   **Normalization Condition**: $\\int_{0}^{\\infty} |u(r)|^{2} \\, dr = 1$.\n-   **ANC Definition**: For $r \\ge R$, $u(r) \\approx C \\, e^{-\\kappa r}$, where $\\kappa = \\sqrt{E_{b} / \\left(\\hbar^{2}/(2\\mu)\\right)}$. $C$ is the ANC.\n-   **Interior Overlap Similarity Definition**: $\\mathcal{S}_{\\mathrm{int}}(u_{a},u_{b}) = \\frac{\\int_{0}^{R} u_{a}(r) \\, u_{b}(r) \\, dr}{\\sqrt{\\left(\\int_{0}^{R} |u_{a}(r)|^{2} \\, dr\\right)\\left(\\int_{0}^{R} |u_{b}(r)|^{2} \\, dr\\right)}}$.\n-   **Task**: Compute the ANC $C$ (in $\\text{fm}^{-1/2}$) and the interior similarity $\\mathcal{S}_{\\mathrm{int}}$ relative to the reference state for each energy in the test suite.\n-   **Output Format**: A single line string `[ [C1, S1], [C2, S2], ... ]` with values rounded to $6$ decimal places.\n\n**1.2. Validate Using Extracted Givens**\n\n-   **Scientifically Grounded**: The problem is a standard exercise in introductory quantum mechanics and nuclear physics. The spherical square-well potential is a common, well-understood model. All physical quantities and constants are appropriate for the nuclear scale. It is scientifically sound.\n-   **Well-Posed**: The problem sets up a clear task with all necessary information. For a given binding energy $E_b$ and radius $R$, the potential depth $V_0$ and the corresponding wavefunction are uniquely determined (for the ground state). The existence and uniqueness of the solution are guaranteed.\n-   **Objective**: The problem is stated in precise, mathematical terms. The definitions for the ANC and overlap similarity are unambiguous. There are no subjective or opinion-based elements.\n-   **Completeness**: All required data ($R$, $\\hbar^2/(2\\mu)$, $E_b$ values) are provided. No information is missing.\n-   **Consistency**: The givens are internally consistent. Units are specified and are consistent throughout.\n\n**1.3. Verdict and Action**\n\nThe problem is valid. It is a well-defined, scientifically sound problem in computational nuclear physics that can be solved from first principles.\n\n### Step 2: Derivation and Solution\n\nThe solution proceeds by first deriving the analytical form of the wavefunction and the expressions for the required quantities ($C$ and $\\mathcal{S}_{\\mathrm{int}}$), and then outlining the numerical implementation.\n\n**2.1. The Time-Independent Schrödinger Equation**\n\nFor a particle of reduced mass $\\mu$ in a central potential $V(r)$, the radial Schrödinger equation for the reduced radial wavefunction $u(r)$ with orbital angular momentum $l$ is:\n$$ - \\frac{\\hbar^2}{2\\mu} \\frac{d^2 u(r)}{dr^2} + \\left[V(r) + \\frac{\\hbar^2 l(l+1)}{2\\mu r^2}\\right] u(r) = E u(r) $$\nGiven $l=0$ (s-wave), the centrifugal term vanishes. Using the constant $c_k = \\hbar^2/(2\\mu) = 20.735 \\, \\text{MeV} \\cdot \\text{fm}^2$ and a bound state energy $E = -E_b$, the equation simplifies to:\n$$ - c_k \\frac{d^2 u(r)}{dr^2} + V(r) u(r) = -E_b u(r) $$\n\n**2.2. Piecewise Solutions**\n\nWe solve the equation in two regions defined by the square-well potential.\n\n**Region I: Interior ($0 \\le r  R$)**\nHere, $V(r) = -V_0$. The equation becomes:\n$$ \\frac{d^2 u_{\\text{in}}(r)}{dr^2} = -\\frac{V_0 - E_b}{c_k} u_{\\text{in}}(r) \\equiv -k^2 u_{\\text{in}}(r) $$\nwhere the interior wavenumber is $k = \\sqrt{(V_0 - E_b)/c_k}$. The general solution is $u_{\\text{in}}(r) = A' \\sin(kr) + B' \\cos(kr)$. The physical boundary condition that the full radial wave function $R(r) = u(r)/r$ must be finite at the origin requires $u(0)=0$. This implies $B'=0$. Thus,\n$$ u_{\\text{in}}(r) = A \\sin(kr) $$\nwhere $A$ is a normalization constant.\n\n**Region II: Exterior ($r \\ge R$)**\nHere, $V(r) = 0$. The equation becomes:\n$$ \\frac{d^2 u_{\\text{out}}(r)}{dr^2} = \\frac{E_b}{c_k} u_{\\text{out}}(r) \\equiv \\kappa^2 u_{\\text{out}}(r) $$\nwhere the exterior decay constant is $\\kappa = \\sqrt{E_b/c_k}$, matching the problem's definition. The general solution is $u_{\\text{out}}(r) = C' e^{-\\kappa r} + D' e^{\\kappa r}$. The boundary condition that the wavefunction must be normalizable requires $u(r) \\to 0$ as $r \\to \\infty$. This implies $D'=0$. Thus,\n$$ u_{\\text{out}}(r) = B e^{-\\kappa r} $$\nwhere $B$ is a constant.\n\n**2.3. Continuity and the Transcendental Equation**\n\nFor the solution to be physically valid, both the wavefunction $u(r)$ and its first derivative $u'(r)$ must be continuous at the boundary $r=R$.\n\\begin{align*} u_{\\text{in}}(R) = u_{\\text{out}}(R) \\quad \\implies \\quad A \\sin(kR) = B e^{-\\kappa R} \\quad (1) \\\\ u'_{\\text{in}}(R) = u'_{\\text{out}}(R) \\quad \\implies \\quad kA \\cos(kR) = - \\kappa B e^{-\\kappa R} \\quad (2) \\end{align*}\nDividing equation $(2)$ by $(1)$ (for non-trivial solutions) yields the transcendental equation relating $k$ and $\\kappa$:\n$$ k \\cot(kR) = -\\kappa $$\nFor each given binding energy $E_b$, we first calculate $\\kappa$ and then numerically solve this equation for the corresponding interior wavenumber $k$. For the ground state (the most deeply bound state for a given potential, or the only state if the potential is shallow enough), we seek a solution for $k$ in the interval $(\\frac{\\pi}{2R}, \\frac{\\pi}{R})$.\n\n**2.4. Normalization and Asymptotic Normalization Coefficient (ANC)**\n\nThe wavefunction must be normalized to unity: $\\int_0^\\infty |u(r)|^2 dr = 1$.\n$$ \\int_0^R (A \\sin(kr))^2 dr + \\int_R^\\infty (B e^{-\\kappa r})^2 dr = 1 $$\nFrom equation $(1)$, we have $B = A \\sin(kR) e^{\\kappa R}$. Substituting this into the normalization integral:\n$$ A^2 \\left[ \\int_0^R \\sin^2(kr) dr + \\sin^2(kR) e^{2\\kappa R} \\int_R^\\infty e^{-2\\kappa r} dr \\right] = 1 $$\nThe integrals are $\\int_0^R \\sin^2(kr) dr = \\frac{R}{2} - \\frac{\\sin(2kR)}{4k}$ and $\\int_R^\\infty e^{-2\\kappa r} dr = \\frac{e^{-2\\kappa R}}{2\\kappa}$.\nA simplified expression for the normalization integral can be found. After simplification, the normalization constant $A$ is determined.\n$$ A = \\sqrt{\\frac{2}{R - \\frac{\\sin(2kR)}{2k} + \\frac{\\sin^2(kR)}{\\kappa}}} $$\nThe problem defines the ANC, denoted by $C$, through the asymptotic behavior $u(r) \\approx C e^{-\\kappa r}$ for $r \\ge R$. Our normalized exterior solution is $u_{\\text{out}}(r) = B e^{-\\kappa r}$. Therefore, the ANC is $C = B$. Using equation $(1)$:\n$$ C = B = A \\sin(kR) e^{\\kappa R} $$\n\n**2.5. Interior Overlap Similarity**\n\nThe similarity $\\mathcal{S}_{\\mathrm{int}}$ between two wavefunctions $u_a(r)$ and $u_b(r)$ is given by:\n$$ \\mathcal{S}_{\\mathrm{int}}(u_{a},u_{b}) = \\frac{\\int_{0}^{R} u_{a}(r) \\, u_{b}(r) \\, dr}{\\sqrt{\\left(\\int_{0}^{R} |u_{a}(r)|^{2} \\, dr\\right)\\left(\\int_{0}^{R} |u_{b}(r)|^{2} \\, dr\\right)}} $$\nSince $u_i(r) = A_i \\sin(k_i r)$ in the interior region, the normalization constants $A_i$ cancel out from the expression:\n$$ \\mathcal{S}_{\\mathrm{int}}(u_{a},u_{b}) = \\frac{\\int_0^R \\sin(k_a r)\\sin(k_b r) dr}{\\sqrt{\\left(\\int_0^R \\sin^2(k_a r)dr\\right)\\left(\\int_0^R \\sin^2(k_b r)dr\\right)}} $$\nThe required integrals can be computed analytically:\n\\begin{align*} \\int_0^R \\sin(k_a r)\\sin(k_b r) dr = \\frac{\\sin((k_a-k_b)R)}{2(k_a-k_b)} - \\frac{\\sin((k_a+k_b)R)}{2(k_a+k_b)} \\quad (\\text{for } k_a \\neq k_b) \\\\ \\int_0^R \\sin^2(k_a r) dr = \\frac{R}{2} - \\frac{\\sin(2k_a R)}{4k_a} \\end{align*}\n\n**2.6. Computational Algorithm**\n\nThe algorithm to compute the required values is as follows:\n1.  Define the constants $R = 4.0$ and $c_k = 20.735$.\n2.  Create a data structure to store results for each $E_{b,i}$ in the test suite $\\{0.05, 0.5, 1.0, 2.0, 5.0\\}$.\n3.  For each $E_{b,i}$:\n    a. Calculate $\\kappa_i = \\sqrt{E_{b,i}/c_k}$.\n    b. Numerically solve the transcendental equation $k_i \\cot(k_i R) = -\\kappa_i$ for $k_i$ in the interval $(\\frac{\\pi}{2R}, \\frac{\\pi}{R})$ using a root-finding algorithm like the Brent method.\n    c. Calculate the normalization constant $A_i$.\n    d. Calculate the ANC $C_i = A_i \\sin(k_i R) e^{\\kappa_i R}$.\n    e. Store the computed $k_i$ and $C_i$.\n4.  Identify the reference wavenumber $k_{\\mathrm{ref}}$ corresponding to the reference energy $E_{b}^{\\mathrm{ref}} = 1.0$ MeV.\n5.  For each state $i$:\n    a. Compute the overlap integral $I_{i, \\mathrm{ref}} = \\int_0^R \\sin(k_i r) \\sin(k_{\\mathrm{ref}} r) dr$.\n    b. Compute the self-overlap integrals $I_{ii} = \\int_0^R \\sin^2(k_i r) dr$ and $I_{\\mathrm{ref}, \\mathrm{ref}} = \\int_0^R \\sin^2(k_{\\mathrm{ref}} r) dr$.\n    c. Calculate the interior similarity $\\mathcal{S}_{\\mathrm{int}, i} = I_{i, \\mathrm{ref}} / \\sqrt{I_{ii} I_{\\mathrm{ref}, \\mathrm{ref}}}$.\n6.  Format the pairs $[C_i, \\mathcal{S}_{\\mathrm{int}, i}]$, rounded to $6$ decimal places, into the required string format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes the Asymptotic Normalization Coefficient (ANC) and interior overlap\n    similarity for neutron bound states in a spherical square-well potential.\n    \"\"\"\n\n    # Physical and numerical parameters from the problem statement.\n    R = 4.0  # Square-well radius in fm\n    HBAR2_2MU = 20.735  # Kinetic constant in MeV*fm^2\n    E_B_VALUES = [0.05, 0.5, 1.0, 2.0, 5.0]  # Binding energies in MeV\n    E_B_REF = 1.0  # Reference binding energy in MeV\n\n    def solve_transcendental_k(kappa, R_val):\n        \"\"\"\n        Solves the transcendental equation k*cot(k*R) = -kappa for k.\n        The ground state solution is sought in the interval k*R in (pi/2, pi).\n        \"\"\"\n        # Define the function whose root we want to find: f(k) = k*cot(k*R) + kappa\n        def f(k):\n            return k / np.tan(k * R_val) + kappa\n\n        # The root is located in the interval (pi/(2*R), pi/R).\n        # We add a small epsilon to avoid the poles of the cotangent function.\n        epsilon = 1e-9\n        k_min = np.pi / (2 * R_val) + epsilon\n        k_max = np.pi / R_val - epsilon\n\n        # Use Brent's method to find the root k.\n        # f(k_min) is positive and f(k_max) is negative in this interval.\n        k_solution = brentq(f, k_min, k_max)\n        return k_solution\n\n    def integrate_sin_product(k1, k2, R_val):\n        \"\"\"\n        Calculates the definite integral of sin(k1*r) * sin(k2*r) from 0 to R.\n        \"\"\"\n        # Case 1: k1 is close to k2 (diagonal term)\n        if np.isclose(k1, k2):\n            return R_val / 2.0 - np.sin(2.0 * k1 * R_val) / (4.0 * k1)\n        # Case 2: k1 is different from k2 (off-diagonal term)\n        else:\n            term1 = np.sin((k1 - k2) * R_val) / (2.0 * (k1 - k2))\n            term2 = np.sin((k1 + k2) * R_val) / (2.0 * (k1 + k2))\n            return term1 - term2\n\n    # Store wavefunction parameters (k and C) for each energy\n    wavefunction_params = {}\n\n    for eb in E_B_VALUES + [E_B_REF]:\n        if eb in wavefunction_params: continue # Avoid recomputing for reference\n        kappa = np.sqrt(eb / HBAR2_2MU)\n        k = solve_transcendental_k(kappa, R)\n\n        # Calculate the normalization constant A of the interior wavefunction\n        # The integral of the squared wavefunction is used for normalization\n        # Integral = int_0^R A^2 sin^2(kr) dr + int_R^inf B^2 e^(-2kr) dr = 1\n        # B = A sin(kR) e^(kR)\n        # A^2 * [ (R/2 - sin(2kR)/(4k)) + sin^2(kR)e^(2kR) * (e^(-2kR)/(2k)) ] = 1\n        # A^2 * [ (R/2 - sin(2kR)/(4k)) + sin^2(kR)/(2k) ] = 1 ... this uses k cot(kR) = -kappa\n        # A more stable formula for normalization uses the total probability\n        norm_factor_A_squared_inv = (R/2.0 - np.sin(2*k*R)/(4*k)) + (np.sin(k*R)**2)/(2*kappa)\n        A = 1.0 / np.sqrt(norm_factor_A_squared_inv)\n\n        # Calculate the Asymptotic Normalization Coefficient (ANC) C\n        # C = B = A * sin(k*R) * exp(kappa*R)\n        anc = A * np.sin(k * R) * np.exp(kappa * R)\n\n        wavefunction_params[eb] = {'k': k, 'C': anc}\n\n    # Retrieve the reference wavenumber k_ref\n    k_ref = wavefunction_params[E_B_REF]['k']\n\n    results = []\n    # Calculate self-overlap integral for the reference state\n    den_integral_ref = integrate_sin_product(k_ref, k_ref, R)\n\n    for eb in E_B_VALUES:\n        params = wavefunction_params[eb]\n        k_i = params['k']\n        C_i = params['C']\n\n        # Calculate overlap integrals for S_int\n        num_integral = integrate_sin_product(k_i, k_ref, R)\n        den_integral_i = integrate_sin_product(k_i, k_i, R)\n        \n        # Calculate the interior overlap similarity S_int\n        S_int = num_integral / np.sqrt(den_integral_i * den_integral_ref)\n\n        # Append the rounded results\n        results.append([round(C_i, 6), round(S_int, 6)])\n\n    # Format the final output string as specified in the problem\n    output_str = \"[\" + \", \".join([f\"[{c}, {s}]\" for c, s in results]) + \"]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}