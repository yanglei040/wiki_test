{
    "hands_on_practices": [
        {
            "introduction": "理解质心运动问题的第一步，是探究如何从数学上将其与核子间的内禀（或相对）运动分离开。本练习在谐振子基这一壳模型的基石上，探讨了这种分离。通过计算一个莫申斯基括号（Moshinsky bracket），我们将直接看到一个用单粒子坐标描述的态如何能被重新表达为质心与相对运动坐标的组合，这是构建平移不变理论的基础。",
            "id": "3548941",
            "problem": "考虑两个质量均为 $m$ 的等质量核子，在非相对论核壳层模型中，使用角频率为 $\\omega$ 的单粒子各向同性三维谐振子 (HO) 基进行描述。为使代数运算清晰，将所有激发限制在单个笛卡尔方向上，并处理该轴上的一维谐振子升降算符代数。设 $a_{1}^{\\dagger}$ 和 $a_{2}^{\\dagger}$ 分别表示作用于一维谐振子真空态 $|0\\rangle$ 上的核子 1 和核子 2 的单粒子谐振子产生算符，其正则对易关系为 $[a_{i},a_{j}^{\\dagger}]=\\delta_{ij}$，所有其他对易子为零。通过以下正交变换定义质心 (CM) 和相对运动产生算符\n$$\na_{R}^{\\dagger}=\\frac{a_{1}^{\\dagger}+a_{2}^{\\dagger}}{\\sqrt{2}},\\qquad a_{r}^{\\dagger}=\\frac{a_{1}^{\\dagger}-a_{2}^{\\dagger}}{\\sqrt{2}},\n$$\n其中 $a_{R}^{\\dagger}$ 在质心模式中产生量子，$a_{r}^{\\dagger}$ 在相对运动模式中产生量子，两者都作用于同一个真空态 $|0\\rangle$。\n\n态 $|n_{1},n_{2}\\rangle$ 表示核子 1 和核子 2 的一维谐振子数子本征态的乘积。质心/相对运动模式基矢 $|q,p\\rangle$ 分别表示 $a_{R}^{\\dagger}a_{R}$ 和 $a_{r}^{\\dagger}a_{r}$ 的数子本征态。在此一维限制设定下，Moshinsky 括号是将乘积态 $|n_{1},n_{2}\\rangle$ 在质心/相对运动基 $|q,p\\rangle$ 上展开时出现的系数。\n\n仅使用上述定义和升降算符代数，计算单量子乘积态 $|n_{1}=1,n_{2}=0\\rangle$ 到相对运动模式单量子且质心模式零量子的态 $|q=0,p=1\\rangle$ 上的显式 Moshinsky 括号（展开系数）。将最终答案表示为单个精确值，不要进行舍入。\n\n此外，从平移不变性的定义（即相互作用与空间平移生成元对易）出发，证明一个平移不变的两体势 $V(|\\mathbf{r}_{1}-\\mathbf{r}_{2}|)$ 仅依赖于相对坐标，并且在两体矩阵元中不与质心坐标耦合，从而在两体部分避免了质心污染。这部分不需要给出数值结果。问题的最终答案必须仅包含指定的 Moshinsky 括号的精确值。",
            "solution": "问题陈述已解析和验证。\n\n**1. 提取已知条件**\n-   两个质量均为 $m$ 的等质量核子。\n-   角频率为 $\\omega$ 的单粒子各向同性三维谐振子 (HO) 基，限制在一维笛卡尔方向上。\n-   核子 1 和 2 的单粒子产生算符：$a_{1}^{\\dagger}$，$a_{2}^{\\dagger}$。\n-   一维谐振子真空态：$|0\\rangle$。\n-   正则对易关系：对于 $i,j \\in \\{1,2\\}$ 有 $[a_{i},a_{j}^{\\dagger}]=\\delta_{ij}$，所有其他基本对易子（即 $[a_i, a_j]$ 和 $[a_i^\\dagger, a_j^\\dagger]$）均为零。\n-   质心 (CM) 和相对运动产生算符：$a_{R}^{\\dagger}=\\frac{a_{1}^{\\dagger}+a_{2}^{\\dagger}}{\\sqrt{2}}$ 和 $a_{r}^{\\dagger}=\\frac{a_{1}^{\\dagger}-a_{2}^{\\dagger}}{\\sqrt{2}}$。它们作用于同一个真空态 $|0\\rangle$。\n-   乘积态基：$|n_{1},n_{2}\\rangle$，核子 1 和 2 的数子本征态。\n-   质心/相对运动模式基：$|q,p\\rangle$，对应于算符 $N_R = a_{R}^{\\dagger}a_{R}$ 和 $N_r = a_{r}^{\\dagger}a_{r}$ 的数子本征态。\n-   Moshinsky 括号定义为展开系数 $\\langle q,p | n_{1},n_{2} \\rangle$。\n-   第一个目标：计算态 $|n_{1}=1,n_{2}=0\\rangle$ 与态 $|q=0,p=1\\rangle$ 的重叠所对应的特定 Moshinsky 括号。\n-   第二个目标：证明一个平移不变的两体势 $V(|\\mathbf{r}_{1}-\\mathbf{r}_{2}|)$ 在两体矩阵元中不与质心坐标耦合。\n\n**2. 验证**\n-   该问题具有科学依据，植根于核壳层模型的标准形式和作为计算核物理基石的谐振子基变换。\n-   该问题提法明确。它提供了所有必要的定义，并要求计算一个特定的、可计算的系数和一个标准的证明。\n-   术语客观而精确。\n-   该问题不包含矛盾、遗漏或事实错误。这是一个标准的、有效的问题。\n\n**3. 求解**\n该问题是有效的，并且可以求解。根据要求，解答分为两部分呈现。\n\n**第一部分：Moshinsky 括号的计算**\n\nMoshinsky 括号是双粒子单粒子基与相对运动-质心基之间的变换系数。我们需要计算特定的括号 $\\langle q=0, p=1 | n_1=1, n_2=0 \\rangle$。\n\n设双粒子真空态表示为 $|00\\rangle$，它是单粒子真空态的张量积：$|00\\rangle \\equiv |0\\rangle_1 \\otimes |0\\rangle_2$。该态被所有单粒子湮灭算符湮灭：$a_1 |00\\rangle = 0$ 且 $a_2 |00\\rangle = 0$。\n\n单粒子基矢 $|n_1=1, n_2=0\\rangle$ 是通过将产生算符 $a_1^{\\dagger}$ 作用于真空态来构建的：\n$$\n|n_1=1, n_2=0\\rangle = \\frac{(a_1^{\\dagger})^1}{\\sqrt{1!}} \\frac{(a_2^{\\dagger})^0}{\\sqrt{0!}} |00\\rangle = a_1^{\\dagger} |00\\rangle\n$$\n\n质心和相对运动湮灭算符 $a_R$ 和 $a_r$ 也湮灭真空态 $|00\\rangle$：\n$$\na_R |00\\rangle = \\frac{1}{\\sqrt{2}}(a_1+a_2)|00\\rangle = \\frac{1}{\\sqrt{2}}(a_1|00\\rangle + a_2|00\\rangle) = 0\n$$\n$$\na_r |00\\rangle = \\frac{1}{\\sqrt{2}}(a_1-a_2)|00\\rangle = \\frac{1}{\\sqrt{2}}(a_1|00\\rangle - a_2|00\\rangle) = 0\n$$\n这证实了单粒子基的真空态 $|00\\rangle$ 也是质心/相对运动基的真空态 $|q=0, p=0\\rangle$。\n\n质心/相对运动基矢 $|q=0, p=1\\rangle$ 是通过将相对运动产生算符 $a_r^{\\dagger}$ 作用于这个共同的真空态来构建的：\n$$\n|q=0, p=1\\rangle = \\frac{(a_R^{\\dagger})^0}{\\sqrt{0!}} \\frac{(a_r^{\\dagger})^1}{\\sqrt{1!}} |00\\rangle = a_r^{\\dagger} |00\\rangle\n$$\n\nMoshinsky 括号是这两个态的标量积：\n$$\n\\langle q=0, p=1 | n_1=1, n_2=0 \\rangle = \\langle a_r^{\\dagger} 00 | a_1^{\\dagger} 00 \\rangle = \\langle 00 | a_r (a_1^{\\dagger} |00\\rangle)\n$$\n\n为了简化计算，我们可以用质心和相对运动产生算符来表示单粒子产生算符 $a_1^{\\dagger}$。定义关系如下：\n$$\na_{R}^{\\dagger}=\\frac{1}{\\sqrt{2}}(a_{1}^{\\dagger}+a_{2}^{\\dagger})\n$$\n$$\na_{r}^{\\dagger}=\\frac{1}{\\sqrt{2}}(a_{1}^{\\dagger}-a_{2}^{\\dagger})\n$$\n这是一个正交变换。为了求逆变换，我们可以求解 $a_1^{\\dagger}$ 和 $a_2^{\\dagger}$。将这两个方程相加得到：\n$$\na_{R}^{\\dagger} + a_{r}^{\\dagger} = \\frac{1}{\\sqrt{2}}(a_{1}^{\\dagger}+a_{2}^{\\dagger} + a_{1}^{\\dagger}-a_{2}^{\\dagger}) = \\frac{2}{\\sqrt{2}}a_{1}^{\\dagger} = \\sqrt{2}a_{1}^{\\dagger}\n$$\n因此，\n$$\na_{1}^{\\dagger} = \\frac{1}{\\sqrt{2}}(a_{R}^{\\dagger} + a_{r}^{\\dagger})\n$$\n现在，我们可以在质心/相对运动基中表示态 $|n_1=1, n_2=0\\rangle$：\n$$\n|n_1=1, n_2=0\\rangle = a_1^{\\dagger} |00\\rangle = \\frac{1}{\\sqrt{2}}(a_{R}^{\\dagger} + a_{r}^{\\dagger})|00\\rangle\n$$\n将算符作用于真空态：\n$$\n|n_1=1, n_2=0\\rangle = \\frac{1}{\\sqrt{2}}a_{R}^{\\dagger}|00\\rangle + \\frac{1}{\\sqrt{2}}a_{r}^{\\dagger}|00\\rangle\n$$\n根据定义，$a_{R}^{\\dagger}|00\\rangle$ 产生一个质心激发的量子和零个相对运动激发的量子，即态 $|q=1, p=0\\rangle$。类似地，$a_{r}^{\\dagger}|00\\rangle$ 产生态 $|q=0, p=1\\rangle$。因此，态 $|n_1=1, n_2=0\\rangle$ 的展开式为：\n$$\n|n_1=1, n_2=0\\rangle = \\frac{1}{\\sqrt{2}}|q=1, p=0\\rangle + \\frac{1}{\\sqrt{2}}|q=0, p=1\\rangle\n$$\nMoshinsky 括号 $\\langle q=0, p=1 | n_1=1, n_2=0 \\rangle$ 是这个展开式中态 $|q=0, p=1\\rangle$ 的系数。通过将上述方程与 $\\langle q=0, p=1 |$ 做内积，并利用基矢的正交归一性（$\\langle q',p'|q,p\\rangle = \\delta_{q'q}\\delta_{p'p}$），我们得到：\n$$\n\\langle q=0, p=1 | n_1=1, n_2=0 \\rangle = \\frac{1}{\\sqrt{2}}\\langle q=0, p=1 | q=1, p=0 \\rangle + \\frac{1}{\\sqrt{2}}\\langle q=0, p=1 | q=0, p=1 \\rangle\n$$\n$$\n= \\frac{1}{\\sqrt{2}}(0) + \\frac{1}{\\sqrt{2}}(1) = \\frac{1}{\\sqrt{2}}\n$$\n指定的 Moshinsky 括号的值是 $\\frac{1}{\\sqrt{2}}$。\n\n**第二部分：两体势的平移不变性**\n\n一个粒子系统的空间平移生成元是总动量算符 $\\mathbf{P}_{\\text{tot}}$。对于一个两体系统，这是 $\\mathbf{P}_{\\text{tot}} = \\mathbf{p}_1 + \\mathbf{p}_2$。一个算符（如势 $V$）是平移不变的，当且仅当它与平移生成元对易：\n$$\n[V, \\mathbf{P}_{\\text{tot}}] = 0\n$$\n让我们考虑势 $V$ 是粒子位置的函数 $V(\\mathbf{r}_1, \\mathbf{r}_2)$。动量算符由 $\\mathbf{p}_k = -i\\hbar\\nabla_k$ 给出。对易关系变为：\n$$\n[V(\\mathbf{r}_1, \\mathbf{r}_2), \\mathbf{p}_1 + \\mathbf{p}_2] = [V, \\mathbf{p}_1] + [V, \\mathbf{p}_2] = 0\n$$\n使用正则对易关系 $[f(\\mathbf{r}), \\mathbf{p}] = i\\hbar\\nabla_{\\mathbf{r}}f(\\mathbf{r})$，我们有：\n$$\n(-i\\hbar)(\\nabla_1 V) + (-i\\hbar)(\\nabla_2 V) = 0\n$$\n这简化为条件：\n$$\n(\\nabla_1 + \\nabla_2)V(\\mathbf{r}_1, \\mathbf{r}_2) = 0\n$$\n这个一阶偏微分方程意味着 $V$ 必须是坐标差 $\\mathbf{r} = \\mathbf{r}_1 - \\mathbf{r}_2$ 的函数。为了验证，设 $V = V(\\mathbf{r}_1 - \\mathbf{r}_2)$。使用矢量导数的链式法则：\n$$\n\\nabla_1 V(\\mathbf{r}_1 - \\mathbf{r}_2) = \\nabla_{\\mathbf{r}} V(\\mathbf{r})\n$$\n$$\n\\nabla_2 V(\\mathbf{r}_1 - \\mathbf{r}_2) = -\\nabla_{\\mathbf{r}} V(\\mathbf{r})\n$$\n其中 $\\nabla_{\\mathbf{r}}$ 是关于相对坐标 $\\mathbf{r}$ 的梯度。将这些代入条件得到 $(\\nabla_{\\mathbf{r}} V) - (\\nabla_{\\mathbf{r}} V) = 0$，这是满足的。因此，任何平移不变的势都必须只依赖于相对坐标 $\\mathbf{r} = \\mathbf{r}_1 - \\mathbf{r}_2$。问题中给出的形式 $V(|\\mathbf{r}_{1}-\\mathbf{r}_{2}|)$ 是一个特例，它同时也是旋转不变的（各向同性的）。\n\n现在我们证明这样的势不与质心 (CM) 坐标 $\\mathbf{R} = (m_1\\mathbf{r}_1 + m_2\\mathbf{r}_2)/(m_1+m_2)$ 耦合。在这个问题中，质量相等，所以 $\\mathbf{R} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2$。\n\n由于 $V$ 仅是 $\\mathbf{r}$ 的函数，算符 $\\hat{V}$ 只作用于系统波函数的相对运动部分。一个普遍的两体波函数可以分离为质心部分和相对运动部分的乘积：$\\Psi(\\mathbf{r}_1, \\mathbf{r}_2) = \\psi_{\\text{CM}}(\\mathbf{R})\\phi_{\\text{rel}}(\\mathbf{r})$。\n\n考虑势 $V$ 在初态 $\\Psi_i = \\psi_{\\text{CM},i}(\\mathbf{R})\\phi_{\\text{rel},i}(\\mathbf{r})$ 和末态 $\\Psi_f = \\psi_{\\text{CM},f}(\\mathbf{R})\\phi_{\\text{rel},f}(\\mathbf{r})$ 之间的矩阵元：\n$$\n\\langle \\Psi_f | V | \\Psi_i \\rangle = \\iint \\Psi_f^*(\\mathbf{R}, \\mathbf{r}) V(\\mathbf{r}) \\Psi_i(\\mathbf{R}, \\mathbf{r}) \\,d^3\\mathbf{R}\\,d^3\\mathbf{r}\n$$\n代入分离变量后的波函数：\n$$\n\\langle \\Psi_f | V | \\Psi_i \\rangle = \\iint \\psi_{\\text{CM},f}^*(\\mathbf{R})\\phi_{\\text{rel},f}^*(\\mathbf{r}) V(\\mathbf{r}) \\psi_{\\text{CM},i}(\\mathbf{R})\\phi_{\\text{rel},i}(\\mathbf{r}) \\,d^3\\mathbf{R}\\,d^3\\mathbf{r}\n$$\n由于 $V(\\mathbf{r})$ 不依赖于 $\\mathbf{R}$，我们可以将关于质心和相对坐标的积分分开：\n$$\n\\langle \\Psi_f | V | \\Psi_i \\rangle = \\left( \\int \\psi_{\\text{CM},f}^*(\\mathbf{R}) \\psi_{\\text{CM},i}(\\mathbf{R}) \\,d^3\\mathbf{R} \\right) \\left( \\int \\phi_{\\text{rel},f}^*(\\mathbf{r}) V(\\mathbf{r}) \\phi_{\\text{rel},i}(\\mathbf{r}) \\,d^3\\mathbf{r} \\right)\n$$\n使用分离的希尔伯特空间的狄拉克符号可以将其紧凑地写为：\n$$\n\\langle \\Psi_f | V | \\Psi_i \\rangle = \\langle \\psi_{\\text{CM},f} | \\psi_{\\text{CM},i} \\rangle \\langle \\phi_{\\text{rel},f} | V | \\phi_{\\text{rel},i} \\rangle\n$$\n由于质心基矢（例如谐振子本征态）的正交性，重叠积分 $\\langle \\psi_{\\text{CM},f} | \\psi_{\\text{CM},i} \\rangle$ 仅在初末质心态相同时才非零。这意味着相互作用 $V$ 不能引起不同质心态之间的跃迁；其矩阵元在质心量子数上是对角的。这表明该势不与质心运动耦合，从而在使用这种相互作用的壳层模型计算中防止了伪质心激发（质心污染）。",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$"
        },
        {
            "introduction": "尽管哈密顿量通常可以被构造成平移不变的，但用于计算物理可观测量（如电磁跃迁率）的算符却未必如此，这会将赝质心效应引入我们的理论预测中。本实践提供了一个严格的数学判据——与总动量算符的对易关系——来检验任何算符的平移不变性，并将其应用于重要的 $E2$ 和 $M1$ 多极算符。它揭示了为何这些算符的标准形式会引发问题，并指出了使用内禀坐标的解决方案。",
            "id": "3548888",
            "problem": "考虑一个由 $A$ 个核子组成的相互作用体系，该体系在由谐振子单粒子态构建的壳模型基中进行描述。设 $\\mathbf{r}_{i}$ 和 $\\mathbf{p}_{i}$ 分别为核子 $i$ 的正则位置和动量算符，其中 $i \\in \\{1,\\dots,A\\}$，对于笛卡尔分量 $\\alpha,\\beta \\in \\{x,y,z\\}$，它们满足 $[r_{i,\\alpha},p_{j,\\beta}] = i\\hbar\\,\\delta_{ij}\\,\\delta_{\\alpha\\beta}$ 和 $[r_{i,\\alpha},r_{j,\\beta}] = [p_{i,\\alpha},p_{j,\\beta}] = 0$。总动量为 $\\mathbf{P} \\equiv \\sum_{i=1}^{A}\\mathbf{p}_{i}$，质心（Center-of-Mass (COM)）坐标为 $\\mathbf{R}_{\\mathrm{cm}} \\equiv \\frac{1}{A}\\sum_{i=1}^{A}\\mathbf{r}_{i}$。如果一个通用算符 $\\hat{O}$ 在由 $\\mathbf{P}$ 生成的均匀空间平移下保持不变，则称其为平移不变的。\n1. 从幺正平移算符 $U(\\mathbf{a}) \\equiv \\exp\\!\\left(-\\frac{i}{\\hbar}\\,\\mathbf{a}\\cdot\\mathbf{P}\\right)$ 及其在海森堡绘景中对算符的作用出发，推导算符 $\\hat{O}$ 具有平移不变性的一个充要判据，该判据需用 $\\hat{O}$ 与 $\\mathbf{P}$ 的对易子表示。你的推导不能预设结论，并且只能使用正则对易关系和 Baker–Campbell–Hausdorff 公式。\n2. 许多壳模型程序在长波极限下将电四极 ($E2$) 算符实现为一个二阶笛卡尔张量\n$$Q_{\\alpha\\beta} \\equiv \\sum_{i=1}^{A} e_{i}\\left(3\\,r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\,\\delta_{\\alpha\\beta}\\right),$$\n其中 $e_{i}$ 是有效电荷，$r_{i}^{2} \\equiv \\mathbf{r}_{i}\\cdot\\mathbf{r}_{i}$。显式地计算对易子 $[Q_{\\alpha\\beta},P_{\\gamma}]$，用 $\\mathbf{r}_{i}$ 表示，并展示所有的指标缩并。\n3. 许多壳模型程序在长波极限下将磁偶极 ($M1$) 算符实现为一个矢量算符\n$$\\mathbf{T}(M1) \\equiv \\mu_{N}\\sum_{i=1}^{A}\\left(g_{\\ell}^{(i)}\\,\\mathbf{\\ell}_{i} + g_{s}^{(i)}\\,\\mathbf{s}_{i}\\right),$$\n其中 $\\mu_{N}$ 是核磁子，$g_{\\ell}^{(i)}$ 和 $g_{s}^{(i)}$ 是轨道和自旋 $g$ 因子，$\\mathbf{s}_{i}$ 作用于内禀自旋空间且与所有的 $\\mathbf{r}_{j}$ 和 $\\mathbf{p}_{j}$ 对易，而 $\\mathbf{\\ell}_{i} \\equiv \\mathbf{r}_{i}\\times\\mathbf{p}_{i}$ 的分量为 $\\ell_{i,\\alpha} \\equiv \\epsilon_{\\alpha\\beta\\gamma} r_{i,\\beta}p_{i,\\gamma}$，其中 $\\epsilon_{\\alpha\\beta\\gamma}$ 为 Levi-Civita 符号。显式地计算混合对易子 $[T(M1)_{\\alpha},P_{\\delta}]$，并确定哪些部分（轨道部分与自旋部分）是平移不变的。\n4. 使用第 1 部分的判据，解释为什么“内禀”替换 $\\mathbf{r}_{i}\\mapsto \\boldsymbol{\\xi}_{i}\\equiv \\mathbf{r}_{i}-\\mathbf{R}_{\\mathrm{cm}}$ 和 $\\mathbf{p}_{i}\\mapsto \\boldsymbol{\\pi}_{i}\\equiv \\mathbf{p}_{i}-\\mathbf{P}/A$ 可以消除由坐标和动量构造的多极算符中的赝质心污染；显式地写出对易子 $[\\xi_{i,\\alpha},P_{\\beta}]$ 和 $[\\pi_{i,\\alpha},P_{\\beta}]$。\n最终答案只需提供第 2 和第 3 部分的对易子表达式对，以笛卡尔指标表示法写成一个行矩阵 $\\big([Q_{\\alpha\\beta},P_{\\gamma}] \\;\\; [T(M1)_{\\alpha},P_{\\delta}]\\big)$。不需要进行数值计算；所有量均保持符号形式。最终答案应为一个单一的封闭形式解析表达式；最终的方框表达式中不应包含任何单位。",
            "solution": "该问题经核实具有科学依据，提法明确且客观。它探讨了核壳模型计算中的一个基本问题。我们可以进行完整解答。\n\n**1. 平移不变性判据**\n\n如果一个算符 $\\hat{O}$ 在空间平移下保持不变，则它是平移不变的。由矢量 $\\mathbf{a}$ 描述的平移所对应的幺正算符为 $U(\\mathbf{a}) \\equiv \\exp\\!\\left(-\\frac{i}{\\hbar}\\,\\mathbf{a}\\cdot\\mathbf{P}\\right)$。在此变换下，算符 $\\hat{O}$ 变换为 $\\hat{O}' = U(\\mathbf{a})^\\dagger \\hat{O} U(\\mathbf{a})$。不变性的条件是 $\\hat{O}' = \\hat{O}$，这意味着 $U(\\mathbf{a})^\\dagger \\hat{O} U(\\mathbf{a}) = \\hat{O}$。由于 $U(\\mathbf{a})$ 是幺正的，这等价于 $\\hat{O}$ 与 $U(\\mathbf{a})$ 对易，即 $[\\hat{O}, U(\\mathbf{a})] = 0$。\n\n为了找到一个更基本的判据，我们考虑使用 Baker–Campbell–Hausdorff (BCH) 展开来处理算符的相似变换，$e^X Y e^{-X} = Y + [X,Y] + \\frac{1}{2!}[X,[X,Y]] + \\dots$。\n在我们的情况下，变换是 $U(\\mathbf{a})^\\dagger \\hat{O} U(\\mathbf{a}) = e^{\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}} \\hat{O} e^{-\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}}$。\n令 $X = \\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}$ 和 $Y = \\hat{O}$。变换后的算符是：\n$$ \\hat{O}' = \\hat{O} + \\left[\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}, \\hat{O}\\right] + \\frac{1}{2!}\\left[\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}, \\left[\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}, \\hat{O}\\right]\\right] + \\dots $$\n$$ \\hat{O}' = \\hat{O} - \\frac{i}{\\hbar}[\\hat{O}, \\mathbf{a}\\cdot\\mathbf{P}] - \\frac{1}{2\\hbar^2}[\\mathbf{a}\\cdot\\mathbf{P}, [\\hat{O}, \\mathbf{a}\\cdot\\mathbf{P}]] + \\dots $$\n为了使 $\\hat{O}$ 是平移不变的，对于任意平移矢量 $\\mathbf{a}$，必须有 $\\hat{O}'=\\hat{O}$。这要求展开式中除第一项外的所有项都为零。一阶项为零是所有高阶项也为零的充分条件。\n一阶项为 $[\\hat{O}, \\mathbf{a}\\cdot\\mathbf{P}] = \\left[\\hat{O}, \\sum_{\\gamma} a_\\gamma P_\\gamma\\right] = \\sum_{\\gamma} a_\\gamma [\\hat{O}, P_\\gamma]$。\n要使此项对任意矢量 $\\mathbf{a}$ 都为零，每个分量 $a_\\gamma$ 的系数必须为零。这导出了充要条件：\n$$ [\\hat{O}, P_\\gamma] = 0 \\quad \\text{对于所有 } \\gamma \\in \\{x,y,z\\}。$$\n用矢量符号表示，该判据为 $[\\hat{O}, \\mathbf{P}] = 0$。\n\n**2. E2 算符的对易子**\n\n电四极算符由 $Q_{\\alpha\\beta} \\equiv \\sum_{i=1}^{A} e_{i}\\left(3\\,r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\,\\delta_{\\alpha\\beta}\\right)$ 给出，总动量为 $P_{\\gamma} = \\sum_{j=1}^{A} p_{j,\\gamma}$。我们计算对易子 $[Q_{\\alpha\\beta},P_{\\gamma}]$。\n$$ [Q_{\\alpha\\beta}, P_{\\gamma}] = \\left[\\sum_{i=1}^{A} e_{i}\\left(3\\,r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\,\\delta_{\\alpha\\beta}\\right), \\sum_{j=1}^{A} p_{j,\\gamma}\\right] $$\n利用对易子的线性性质，以及不同粒子间的同类算符（r-r 或 p-p）对易，对易子简化为：\n$$ [Q_{\\alpha\\beta}, P_{\\gamma}] = \\sum_{i=1}^{A} \\sum_{j=1}^{A} e_i [3r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\delta_{\\alpha\\beta}, p_{j,\\gamma}] $$\n我们使用基本对易关系 $[r_{k,\\mu}, p_{l,\\nu}] = i\\hbar \\delta_{kl}\\delta_{\\mu\\nu}$ 和恒等式 $[AB, C] = A[B,C] + [A,C]B$。\n首先，我们计算 $r_{i,\\alpha}r_{i,\\beta}$ 项与 $p_{j,\\gamma}$ 的对易子：\n$$ [r_{i,\\alpha}r_{i,\\beta}, p_{j,\\gamma}] = r_{i,\\alpha}[r_{i,\\beta}, p_{j,\\gamma}] + [r_{i,\\alpha}, p_{j,\\gamma}]r_{i,\\beta} = r_{i,\\alpha}(i\\hbar\\delta_{ij}\\delta_{\\beta\\gamma}) + (i\\hbar\\delta_{ij}\\delta_{\\alpha\\gamma})r_{i,\\beta} = i\\hbar\\delta_{ij}(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) $$\n接下来，对于 $r_i^2 = \\sum_{\\mu} r_{i,\\mu}r_{i,\\mu}$ 项：\n$$ [r_i^2, p_{j,\\gamma}] = \\sum_{\\mu} [r_{i,\\mu}r_{i,\\mu}, p_{j,\\gamma}] = \\sum_{\\mu} (r_{i,\\mu}[r_{i,\\mu}, p_{j,\\gamma}] + [r_{i,\\mu}, p_{j,\\gamma}]r_{i,\\mu}) $$\n$$ = \\sum_{\\mu} (r_{i,\\mu}(i\\hbar\\delta_{ij}\\delta_{\\mu\\gamma}) + (i\\hbar\\delta_{ij}\\delta_{\\mu\\gamma})r_{i,\\mu}) = 2i\\hbar\\delta_{ij} \\sum_{\\mu} r_{i,\\mu}\\delta_{\\mu\\gamma} = 2i\\hbar\\delta_{ij}r_{i,\\gamma} $$\n综合这些结果：\n$$ [3r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\delta_{\\alpha\\beta}, p_{j,\\gamma}] = 3 i\\hbar\\delta_{ij}(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - (2i\\hbar\\delta_{ij}r_{i,\\gamma})\\delta_{\\alpha\\beta} $$\n$$ = i\\hbar\\delta_{ij}[3(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - 2\\delta_{\\alpha\\beta}r_{i,\\gamma}] $$\n将此结果代入完整的对易子表达式中，并对 $i$ 和 $j$ 求和，克罗内克 $\\delta_{ij}$ 使得对 $j$ 的求和简化：\n$$ [Q_{\\alpha\\beta}, P_{\\gamma}] = \\sum_{i=1}^{A} e_i \\left( i\\hbar [3(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - 2\\delta_{\\alpha\\beta}r_{i,\\gamma}] \\right) $$\n$$ [Q_{\\alpha\\beta}, P_{\\gamma}] = i\\hbar \\sum_{i=1}^{A} e_i (3(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - 2r_{i,\\gamma}\\delta_{\\alpha\\beta}) $$\n由于该对易子不为零，算符 $Q_{\\alpha\\beta}$ 不是平移不变的。\n\n**3. M1 算符的对易子**\n\n磁偶极算符为 $\\mathbf{T}(M1) \\equiv \\mu_{N}\\sum_{i=1}^{A}\\left(g_{\\ell}^{(i)}\\,\\mathbf{\\ell}_{i} + g_{s}^{(i)}\\,\\mathbf{s}_{i}\\right)$。我们计算其 $\\alpha$ 分量与总动量 $\\delta$ 分量的对易子 $[T(M1)_{\\alpha}, P_{\\delta}]$。\n$$ [T(M1)_{\\alpha}, P_{\\delta}] = \\mu_N \\sum_{i=1}^A \\sum_{j=1}^A [g_{\\ell}^{(i)}\\ell_{i,\\alpha} + g_s^{(i)}s_{i,\\alpha}, p_{j,\\delta}] $$\n我们可以分别分析轨道和自旋部分。\n对于自旋部分，已知自旋算符与所有空间和动量算符对易，即 $[s_{i,\\alpha}, p_{j,\\delta}] = 0$。因此，涉及自旋 g 因子的对易子为零：\n$$ \\mu_N \\sum_{i,j} g_s^{(i)} [s_{i,\\alpha}, p_{j,\\delta}] = 0 $$\n因此，$M1$ 算符的自旋部分是平移不变的。\n对于轨道部分，我们需要计算 $[\\ell_{i,\\alpha}, p_{j,\\delta}]$。轨道角动量分量为 $\\ell_{i,\\alpha} = \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu} r_{i,\\mu} p_{i,\\nu}$。\n$$ [\\ell_{i,\\alpha}, p_{j,\\delta}] = \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu} [r_{i,\\mu} p_{i,\\nu}, p_{j,\\delta}] = \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu} (r_{i,\\mu}[p_{i,\\nu}, p_{j,\\delta}] + [r_{i,\\mu}, p_{j,\\delta}]p_{i,\\nu}) $$\n第一项为零，因为动量算符之间对易，$[p_{i,\\nu}, p_{j,\\delta}] = 0$。\n$$ [\\ell_{i,\\alpha}, p_{j,\\delta}] = \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu} (i\\hbar\\delta_{ij}\\delta_{\\mu\\delta}) p_{i,\\nu} = i\\hbar\\delta_{ij} \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu}\\delta_{\\mu\\delta}p_{i,\\nu} = i\\hbar\\delta_{ij} \\sum_{\\nu}\\epsilon_{\\alpha\\delta\\nu} p_{i,\\nu} $$\n现在，我们计算轨道部分的完整对易子：\n$$ \\mu_N \\sum_{i,j} g_{\\ell}^{(i)} [\\ell_{i,\\alpha}, p_{j,\\delta}] = \\mu_N \\sum_{i,j} g_{\\ell}^{(i)} \\left( i\\hbar\\delta_{ij} \\sum_{\\nu}\\epsilon_{\\alpha\\delta\\nu} p_{i,\\nu} \\right) $$\n使用 $\\delta_{ij}$ 对 $j$ 求和：\n$$ = i\\hbar\\mu_N \\sum_{i=1}^A g_{\\ell}^{(i)} \\sum_{\\nu}\\epsilon_{\\alpha\\delta\\nu} p_{i,\\nu} $$\n设哑指标为 $\\sigma$，最终的对易子为：\n$$ [T(M1)_{\\alpha}, P_{\\delta}] = i\\hbar\\mu_N \\sum_{i=1}^{A} g_{\\ell}^{(i)} \\epsilon_{\\alpha\\delta\\sigma} p_{i,\\sigma} $$\n$M1$ 算符的轨道部分通常不是平移不变的。\n\n**4. 内禀坐标和动量**\n\n通过使用内禀坐标 $\\boldsymbol{\\xi}_i \\equiv \\mathbf{r}_i - \\mathbf{R}_{\\mathrm{cm}}$ 和内禀动量 $\\boldsymbol{\\pi}_i \\equiv \\mathbf{p}_i - \\mathbf{P}/A$ 构造算符，可以消除赝质心污染。根据第 1 部分的判据，如果一个算符与总动量 $\\mathbf{P}$ 对易，则它是平移不变的。如果我们能证明基本构造块 $\\boldsymbol{\\xi}_i$ 和 $\\boldsymbol{\\pi}_i$ 与 $\\mathbf{P}$ 对易，那么任何纯粹由这些内禀变量构造的算符也将与 $\\mathbf{P}$ 对易，从而没有质心污染。\n\n我们来计算对易子 $[\\xi_{i,\\alpha}, P_\\beta]$：\n$$ [\\xi_{i,\\alpha}, P_\\beta] = \\left[r_{i,\\alpha} - \\frac{1}{A}\\sum_{j=1}^A r_{j,\\alpha}, \\sum_{k=1}^A p_{k,\\beta}\\right] $$\n$$ = \\sum_{k=1}^A [r_{i,\\alpha}, p_{k,\\beta}] - \\frac{1}{A}\\sum_{j=1}^A\\sum_{k=1}^A [r_{j,\\alpha}, p_{k,\\beta}] $$\n$$ = \\sum_{k=1}^A i\\hbar\\delta_{ik}\\delta_{\\alpha\\beta} - \\frac{1}{A}\\sum_{j=1}^A\\sum_{k=1}^A i\\hbar\\delta_{jk}\\delta_{\\alpha\\beta} $$\n$$ = i\\hbar\\delta_{\\alpha\\beta} - \\frac{i\\hbar\\delta_{\\alpha\\beta}}{A}\\sum_{j=1}^A 1 = i\\hbar\\delta_{\\alpha\\beta} - \\frac{i\\hbar\\delta_{\\alpha\\beta}}{A}A = 0 $$\n所以，$[\\xi_{i,\\alpha}, P_\\beta] = 0$。\n\n接下来，我们计算对易子 $[\\pi_{i,\\alpha}, P_\\beta]$：\n$$ [\\pi_{i,\\alpha}, P_\\beta] = \\left[p_{i,\\alpha} - \\frac{1}{A}\\sum_{j=1}^A p_{j,\\alpha}, \\sum_{k=1}^A p_{k,\\beta}\\right] $$\n$$ = \\sum_{k=1}^A [p_{i,\\alpha}, p_{k,\\beta}] - \\frac{1}{A}\\sum_{j=1}^A\\sum_{k=1}^A [p_{j,\\alpha}, p_{k,\\beta}] $$\n由于动量算符之间相互对易，$[p_{\\mu}, p_{\\nu}] = 0$，所以两项都为零。\n$$ [\\pi_{i,\\alpha}, P_\\beta] = 0 - 0 = 0 $$\n由于 $\\boldsymbol{\\xi}_i$ 和 $\\boldsymbol{\\pi}_i$ 都与总动量 $\\mathbf{P}$ 对易，任何由它们构造的算符（例如，内禀四极算符 $\\sum_i e_i (3\\xi_{i,\\alpha}\\xi_{i,\\beta} - \\xi_i^2\\delta_{\\alpha\\beta})$ 或内禀角动量 $\\boldsymbol{\\xi}_i \\times \\boldsymbol{\\pi}_i$）也将与 $\\mathbf{P}$ 对易。这保证了此类算符是平移不变的，并且不会引起涉及质心运动的赝跃迁。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} i\\hbar \\sum_{i=1}^{A} e_i \\left(3(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - 2r_{i,\\gamma}\\delta_{\\alpha\\beta}\\right)  & i\\hbar\\mu_N \\sum_{i=1}^{A} g_{\\ell}^{(i)} \\epsilon_{\\alpha\\delta\\sigma} p_{i,\\sigma} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在完成一次大规模壳模型计算后，我们会得到一个包含许多多体态的谱，其中一些是具有物理意义的内禀激发，而另一些则是赝质心激发。最后一个关键步骤是识别并移除这些赝态。本计算练习将指导你设计并实现一个实用算法，根据态的质心特征对其进行标记并筛选谱，这项技术对于从壳模型代码中获得清晰、具有物理解释性的结果至关重要。",
            "id": "3548911",
            "problem": "您面临一项计算任务，其背景是在谐振子基中进行的核壳模型计算。在此类计算中，多体波函数可能包含由质心运动引起的赝态。您必须设计并实现一个算法，仅使用质心哈密顿量的期望值以及与由 $b_{\\text{cm}}^\\dagger$ 激发的组态的交叠，来为每个计算出的多体态近似地标记一个质心激发量子数 $N_{\\text{cm}}$，然后相应地筛选能谱。\n\n基本原理：\n- 对于一个由 $A$ 个核子组成的、处在频率为 $\\Omega$ 的谐振子囚禁势中的系统，其质心哈密顿量 $H_{\\text{cm}}$ 是一个在质心坐标 $\\mathbf{R}_{\\text{cm}}$ 中，质量为 $A m$ 的三维谐振子的哈密顿量，可以表示为 $H_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2 A m} + \\frac{1}{2} A m \\Omega^2 \\mathbf{R}_{\\text{cm}}^2$。\n- 质心自由度的阶梯算符 $b_{\\text{cm}}$ 和 $b_{\\text{cm}}^\\dagger$ 满足对易关系 $[b_{\\text{cm}}, b_{\\text{cm}}^\\dagger] = 1$，并定义了数算符 $N_{\\text{cm}} = b_{\\text{cm}}^\\dagger b_{\\text{cm}}$。\n- 由此可得到等间距的谐振子能谱，相邻 $N_{\\text{cm}}$ 能级组之间的能量间隔为 $\\hbar \\Omega$。\n\n任务：\n- 对于每个态，您将获得以下信息：\n  - 谐振子标度 $\\hbar\\Omega$（单位：MeV）。\n  - 内禀能量 $E_{\\text{intr}}$（单位：MeV）。\n  - 期望值 $\\langle H_{\\text{cm}} \\rangle$（单位：MeV）。\n  - 与由 $b_{\\text{cm}}^\\dagger$ 生成的单声子质心激发的交叠平方 $s_1$。\n  - 与由 $(b_{\\text{cm}}^\\dagger)^2$ 生成的双声子质心激发的交叠平方 $s_2$。\n- 假设在可用的截断信息内，$N_{\\text{cm}} \\in \\{0,1,2\\}$ 的近似概率在强制执行概率诠释后满足 $p_0 \\approx 1 - s_1 - s_2$，$p_1 \\approx s_1$，$p_2 \\approx s_2$。如果 $s_1 + s_2 > 1$，您必须通过一个公共因子对 $s_1$ 和 $s_2$ 进行重归一化，使得 $s_1 + s_2 = 1$，然后设置 $p_0 = 0$。\n- 从上述基本原理出发，推导一个算法，该算法：\n  1. 使用 $\\langle H_{\\text{cm}} \\rangle$ 和 $\\hbar\\Omega$，通过将 $\\langle H_{\\text{cm}} \\rangle$ 与谐振子间距所蕴含的分立阶梯值进行比较，为 $N_{\\text{cm}}$ 构建一个基于能量的候选整数标记。\n  2. 使用交叠 $s_1$ 和 $s_2$（在强制执行概率诠释后），通过选择最可能的 $N_{\\text{cm}} \\in \\{0,1,2\\}$，为 $N_{\\text{cm}}$ 构建一个基于交叠的候选整数标记。\n  3. 使用一个无量纲的容差窗口参数 $\\epsilon$（每个测试用例指定），来解决两个候选标记之间的差异。该参数定义了围绕阶梯能量的一个半宽度为 $\\epsilon \\,\\hbar\\Omega$ 的接受窗口。如果 $\\langle H_{\\text{cm}} \\rangle$ 位于基于能量的候选标记的窗口内，则优先选择基于能量的标记；否则，优先选择基于交叠的标记。在基于交叠的决策出现平局或模糊不清的情况下，通过选择使与基于能量的实值估计的距离最小化的整数 $N_{\\text{cm}}$ 来打破平局。\n  4. 估计 $p_0$ 并筛选能谱，仅保留那些最终标记为 $N_{\\text{cm}} = 0$ 且 $p_0 \\ge p_{0,\\min}$ 的态，其中 $p_{0,\\min}$ 是每个测试用例指定的阈值。\n- 对于每个测试用例，输出保留下来的态的内禀能量列表。\n\n数值和单位要求：\n- 所有能量（$\\hbar\\Omega$、$E_{\\text{intr}}$、$\\langle H_{\\text{cm}} \\rangle$）均以 MeV 为单位提供和处理。您最终报告的内禀能量必须以 MeV 为单位。\n- 在打印时，您必须将报告的内禀能量四舍五入到三位小数。\n- 不使用角度。\n- 概率必须作为 0 到 1 之间的小数处理。\n\n测试套件：\n在以下测试套件上实现您的算法。每个测试用例指定了 $\\hbar\\Omega$（单位：MeV）、窗口参数 $\\epsilon$（无量纲）、可接受的最小 $p_0$ 阈值 $p_{0,\\min}$，以及一个包含元组 $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2)$ 的态的列表，所有能量单位均为 MeV。\n\n- 测试用例 1：\n  - $\\hbar\\Omega = 16$。\n  - $\\epsilon = 0.2$。\n  - $p_{0,\\min} = 0.6$。\n  - 态：\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.6, 24.1, 0.03, 0.01)$。\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (2.1, 40.2, 0.85, 0.05)$。\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (1.5, 33.0, 0.45, 0.10)$。\n- 测试用例 2：\n  - $\\hbar\\Omega = 20$。\n  - $\\epsilon = 0.1$。\n  - $p_{0,\\min} = 0.7$。\n  - 态：\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.8, 31.0, 0.20, 0.02)$。\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (1.1, 50.5, 0.60, 0.10)$。\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (1.3, 40.0, 0.35, 0.20)$。\n- 测试用例 3：\n  - $\\hbar\\Omega = 12$。\n  - $\\epsilon = 0.15$。\n  - $p_{0,\\min} = 0.5$。\n  - 态：\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (2.5, 30.0, 0.70, 0.50)$。\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.4, 18.4, 0.12, 0.03)$。\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (1.9, 24.0, 0.40, 0.10)$。\n- 测试用例 4：\n  - $\\hbar\\Omega = 10$。\n  - $\\epsilon = 0.25$。\n  - $p_{0,\\min} = 0.8$。\n  - 态：\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.9, 17.0, 0.15, 0.00)$。\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.7, 15.0, 0.18, 0.02)$。\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (2.2, 35.0, 0.30, 0.55)$。\n\n要求的最终输出格式：\n- 您的程序应生成一行输出，其中包含一个由列表组成的逗号分隔列表形式的结果。每个内部列表包含一个测试用例中保留的内禀能量，四舍五入到三位小数并以 MeV 表示，例如：$[[x_{11},x_{12}], [x_{21}], [\\,], [x_{41},x_{42},x_{43}]]$。\n- 不得打印任何其他文本。\n- 您的程序必须是一个完整的、可运行的程序，且不得需要任何外部输入。所有常量和数据均已在上方指定，必须嵌入代码中。",
            "solution": "该问题要求设计并实现一个算法，用于筛选一组通过壳模型计算得到的核态。目标是仅保留那些主要处于质心（CM）基态的态，即没有赝质心激发的态。这是核结构理论中一个常见且关键的步骤，因为在截断基（例如谐振子基）中进行的计算，会人为地将原子核的内禀结构与其质心的运动混合在一起。\n\n该算法将为每个态分配一个整数的质心激发量子数 $N_{\\text{cm}}$，然后基于此标记和态的纯度进行筛选。分配过程综合来自两个来源的信息：质心哈密顿量的期望值 $\\langle H_{\\text{cm}} \\rangle$，以及与包含一个或两个质心激发量子的态的交叠平方 $s_1$ 和 $s_2$。\n\n**理论基础**\n\n对于一个在谐振子势中的 $A$ 核子系统，其质心哈密顿量为 $H_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2 A m} + \\frac{1}{2} A m \\Omega^2 \\mathbf{R}_{\\text{cm}}^2$。这是一个三维各向同性谐振子的哈密顿量。其能量本征值是量子化的，由下式给出：\n$$\nE_{N_{\\text{cm}}} = \\left(N_{\\text{cm}} + \\frac{3}{2}\\right) \\hbar\\Omega\n$$\n其中 $N_{\\text{cm}} = 0, 1, 2, \\dots$ 是质心运动的主量子数，$\\hbar\\Omega$ 是谐振子的能量间隔。$\\frac{3}{2}\\hbar\\Omega$ 项代表三维谐振子的零点能。\n\n一个在截断基中通过壳模型计算得到的多体态 $|\\Psi\\rangle$ 通常不是 $N_{\\text{cm}}$ 的本征态。它可以表示为具有不同质心量子数的组分的叠加：\n$$\n|\\Psi\\rangle = \\sum_{N_{\\text{cm}}=0}^{\\infty} c_{N_{\\text{cm}}} |\\phi_{\\text{intr}}; N_{\\text{cm}}\\rangle\n$$\n在这里，$|\\phi_{\\text{intr}}; N_{\\text{cm}}\\rangle$ 表示一个具有特定内禀结构 $\\phi_{\\text{intr}}$ 和质心激发为 $N_{\\text{cm}}$ 的态。该态具有质心激发 $N_{\\text{cm}}$ 的概率为 $p_{N_{\\text{cm}}} = |c_{N_{\\text{cm}}}|^2$。质心哈密顿量的期望值是能量本征值的加权平均值：\n$$\n\\langle H_{\\text{cm}} \\rangle = \\langle \\Psi | H_{\\text{cm}} | \\Psi \\rangle = \\sum_{N_{\\text{cm}}=0}^{\\infty} p_{N_{\\text{cm}}} E_{N_{\\text{cm}}} = \\sum_{N_{\\text{cm}}=0}^{\\infty} p_{N_{\\text{cm}}} \\left(N_{\\text{cm}} + \\frac{3}{2}\\right) \\hbar\\Omega\n$$\n这可以根据质心数算符的期望值 $\\langle N_{\\text{cm}} \\rangle = \\sum p_{N_{\\text{cm}}} N_{\\text{cm}}$ 重写为：\n$$\n\\langle H_{\\text{cm}} \\rangle = \\left(\\langle N_{\\text{cm}} \\rangle + \\frac{3}{2}\\right) \\hbar\\Omega\n$$\n\n**算法流程**\n\n该算法通过一系列步骤处理每个态，以确定其最终的质心标记 $N_{\\text{cm, final}}$，然后应用一个过滤器。\n\n**1. 概率估计**\n问题通过交叠平方 $s_1$ 和 $s_2$ 提供了关于波函数组成的有限信息。我们被指示使用这些信息来近似概率 $p_0$、$p_1$ 和 $p_2$，将展开截断到 $N_{\\text{cm}}=2$。概率 $\\{p_0, p_1, p_2\\}$ 的总和必须为 1。\n- 如果 $s_1 + s_2 \\le 1$，我们假设这些交叠直接近似于激发组分的概率，剩余的概率对应于基态：\n  $p_1 = s_1$，$p_2 = s_2$，以及 $p_0 = 1 - s_1 - s_2$。\n- 如果 $s_1 + s_2 > 1$，则这些交叠违反了简单的概率诠释（可能是由于用于计算它们的基态的非正交性）。问题规定了一个重归一化程序：\n  $p_0 = 0$，$p_1 = \\frac{s_1}{s_1+s_2}$，以及 $p_2 = \\frac{s_2}{s_1+s_2}$。这假设该态没有 $N_{\\text{cm}}=0$ 组分，并将总概率分配在 $N_{\\text{cm}}=1$ 和 $N_{\\text{cm}}=2$ 组分之间。\n\n**2. 基于能量的候选标记 ($N_{\\text{cm, E}}$)**\n从能量期望值的关系式中，我们可以推导出平均质心量子数的一个连续的（或实值的）估计：\n$$\n\\langle N_{\\text{cm}} \\rangle_{\\text{real}} = \\frac{\\langle H_{\\text{cm}} \\rangle}{\\hbar\\Omega} - \\frac{3}{2}\n$$\n基于其能量，该态主导的质心特性的最直观的整数候选标记是与此实值估计最接近的整数。这给出了基于能量的标记：\n$$\nN_{\\text{cm, E}} = \\text{round}\\left( \\langle N_{\\text{cm}} \\rangle_{\\text{real}} \\right)\n$$\n其中 $\\text{round}(\\cdot)$ 表示四舍五入到最近的整数。\n\n**3. 基于交叠的候选标记 ($N_{\\text{cm, S}}$)**\n该标记通过使用步骤 1 中估计的概率，在 $\\{0, 1, 2\\}$ 中识别出最可能的质心组分来确定。\n$$\nN_{\\text{cm, S}} = \\underset{i \\in \\{0, 1, 2\\}}{\\arg\\max} \\, p_i\n$$\n在出现平局（即多个组分共享相同的最大概率）的情况下，通过选择与实值估计 $\\langle N_{\\text{cm}} \\rangle_{\\text{real}}$ 最接近的标记 $i$ 来解决歧义。\n\n**4. 差异解决与最终标记**\n两个候选标记 $N_{\\text{cm, E}}$ 和 $N_{\\text{cm, S}}$ 可能不同。需要一个决策规则。如果测得的能量 $\\langle H_{\\text{cm}} \\rangle$ 与该标记的理想量子化能量 $E_{N_{\\text{cm, E}}} = (N_{\\text{cm, E}} + 3/2)\\hbar\\Omega$ 一致，则认为基于能量的标记 $N_{\\text{cm, E}}$ 是可靠的。这种一致性通过一个半宽度为 $\\Delta E = \\epsilon \\hbar\\Omega$ 的容差窗口进行测试，其中 $\\epsilon$ 是给定的无量纲参数。\n- 如果 $|\\langle H_{\\text{cm}} \\rangle - E_{N_{\\text{cm, E}}}| \\le \\Delta E$，则认为能量信息是可信的，我们将最终标记设为 $N_{\\text{cm, final}} = N_{\\text{cm, E}}$。\n- 否则，能量期望值与任何单个量子化能级相距太远，表明这是一个强混合态，此时概率分布的峰值（通过交叠探测）是更可靠的指标。因此，我们设置 $N_{\\text{cm, final}} = N_{\\text{cm, S}}$。\n\n**5. 筛选**\n最后一步是对能谱应用过滤器。如果一个态的指定质心标记为 0，并且其质心基态组分足够大，则该态被认为是“非赝态”或“纯净的”。一个具有内禀能量 $E_{\\text{intr}}$ 的态当且仅当同时满足以下两个条件时被保留：\n1. $N_{\\text{cm, final}} = 0$\n2. $p_0 \\ge p_{0, \\min}$\n其中 $p_{0,\\min}$ 是为 $N_{\\text{cm}}=0$ 概率指定的最小阈值。\n\n这个全面的流程允许对态进行稳健、自动的分类和筛选，有效地清除了理论能谱中的赝质心运动。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the center-of-mass contamination removal problem for a given test suite.\n    \"\"\"\n    test_cases = [\n        {\n            \"hbar_omega\": 16.0,\n            \"epsilon\": 0.2,\n            \"p0_min\": 0.6,\n            \"states\": [\n                (0.6, 24.1, 0.03, 0.01),\n                (2.1, 40.2, 0.85, 0.05),\n                (1.5, 33.0, 0.45, 0.10),\n            ],\n        },\n        {\n            \"hbar_omega\": 20.0,\n            \"epsilon\": 0.1,\n            \"p0_min\": 0.7,\n            \"states\": [\n                (0.8, 31.0, 0.20, 0.02),\n                (1.1, 50.5, 0.60, 0.10),\n                (1.3, 40.0, 0.35, 0.20),\n            ],\n        },\n        {\n            \"hbar_omega\": 12.0,\n            \"epsilon\": 0.15,\n            \"p0_min\": 0.5,\n            \"states\": [\n                (2.5, 30.0, 0.70, 0.50),\n                (0.4, 18.4, 0.12, 0.03),\n                (1.9, 24.0, 0.40, 0.10),\n            ],\n        },\n        {\n            \"hbar_omega\": 10.0,\n            \"epsilon\": 0.25,\n            \"p0_min\": 0.8,\n            \"states\": [\n                (0.9, 17.0, 0.15, 0.00),\n                (0.7, 15.0, 0.18, 0.02),\n                (2.2, 35.0, 0.30, 0.55),\n            ],\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        hbar_omega = case[\"hbar_omega\"]\n        epsilon = case[\"epsilon\"]\n        p0_min = case[\"p0_min\"]\n        \n        retained_energies = []\n        \n        for state_data in case[\"states\"]:\n            e_intr, h_cm_exp, s1_in, s2_in = state_data\n            \n            # 1. Process Probabilities\n            p0, p1, p2 = 0.0, 0.0, 0.0\n            if s1_in + s2_in > 1.0:\n                norm = s1_in + s2_in\n                p0 = 0.0\n                p1 = s1_in / norm\n                p2 = s2_in / norm\n            else:\n                p0 = 1.0 - s1_in - s2_in\n                p1 = s1_in\n                p2 = s2_in\n            \n            probs = [p0, p1, p2]\n\n            # 2. Calculate Candidate Labels\n            # Energy-based label\n            n_cm_real = (h_cm_exp / hbar_omega) - 1.5\n            n_cm_e = int(np.round(n_cm_real))\n            \n            # Overlap-based label\n            max_prob = -1.0\n            for p in probs:\n                if p > max_prob:\n                    max_prob = p\n            \n            candidate_indices = [i for i, p in enumerate(probs) if math.isclose(p, max_prob)]\n            \n            if len(candidate_indices) == 1:\n                n_cm_s = candidate_indices[0]\n            else:\n                # Tie-breaking rule\n                n_cm_s = min(candidate_indices, key=lambda i: abs(i - n_cm_real))\n\n            # 3. Resolve Discrepancy and Get Final Label\n            e_ideal = (n_cm_e + 1.5) * hbar_omega\n            delta_e = epsilon * hbar_omega\n            \n            n_cm_final = 0\n            if abs(h_cm_exp - e_ideal) <= delta_e:\n                n_cm_final = n_cm_e\n            else:\n                n_cm_final = n_cm_s\n                \n            # 4. Filter\n            if n_cm_final == 0 and p0 >= p0_min:\n                retained_energies.append(e_intr)\n                \n        all_results.append(retained_energies)\n\n    # Format the final output string\n    formatted_results = []\n    for res_list in all_results:\n        if not res_list:\n            formatted_results.append('[]')\n        else:\n            # Format numbers to three decimal places\n            formatted_numbers = [f'{x:.3f}' for x in res_list]\n            formatted_results.append(f'[{\",\".join(formatted_numbers)}]')\n            \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}