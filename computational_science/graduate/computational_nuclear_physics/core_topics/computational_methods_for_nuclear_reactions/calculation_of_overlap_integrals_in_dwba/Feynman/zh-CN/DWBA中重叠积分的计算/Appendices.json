{
    "hands_on_practices": [
        {
            "introduction": "在扭曲波玻恩近似（DWBA）的计算中，零程近似是一个常见的简化，它极大地简化了跃迁振幅的计算。然而，为了更精确地描述核反应，考虑核力的有限力程至关重要。本练习  将引导您从一个高斯形式的有限程相互作用出发，通过解析推导，得到一个因子化的有限程修正因子，从而揭示零程近似与更真实的有限程描述之间的联系。",
            "id": "3547926",
            "problem": "在单核子转移的畸波玻恩近似（DWBA）的末态形式中，有限程跃迁振幅可以示意性地写为质子-中子相对坐标核与质子-中子相互作用的重叠。设质子-中子相互作用由一个有限程高斯函数建模，\n$$\nV_{pn}(r)=V_{0}\\,\\exp\\!\\big(-r^{2}/\\beta^{2}\\big),\n$$\n其力程参数为 $\\beta0$，强度为 $V_{0}$。用 $\\mathbf{s}$ 表示质子-中子相对坐标，用 $R(\\mathbf{s})$ 表示在 DWBA 被积函数中乘以 $V_{pn}(\\mathbf{s})$ 的反应核（该核包含畸变波与相关束缚态重叠的乘积）。零程极限对应于在 $\\mathbf{s}=\\mathbf{0}$ 的邻域内 $R(\\mathbf{s})\\to R(\\mathbf{0})$。\n\n从写成关于 $\\mathbf{s}$ 的重叠积分的有限程振幅出发，并仅使用以下假设：\n- $R(\\mathbf{s})$ 在 $\\mathbf{s}=\\mathbf{0}$ 的邻域内是光滑的，并且其变化长度标度远大于 $\\beta$，\n- $R(\\mathbf{s})$ 在 $V_{pn}(\\mathbf{s})$ 支集上的主要变化是通过一个复相位，其在 $\\mathbf{s}=\\mathbf{0}$ 处的局域梯度定义了一个实的“局域动量失配”向量 $\\mathbf{K}$，\n\n推导有限程振幅的一个分解形式，该形式用零程振幅乘以一个仅依赖于 $K=|\\mathbf{K}|$ 和相互作用力程 $\\beta$ 的有限程修正因子 $F_{\\mathrm{FR}}(K)$ 来表示。然后，确定通过 $V_{pn}$ 的二阶矩进入重叠积分的有效力程参数，其定义为\n$$\nr_{\\mathrm{eff}}^{2}\\equiv \\frac{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, s^{2}\\,V_{pn}(s)}{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, V_{pn}(s)}.\n$$\n\n你的最终答案必须给出：\n1. $F_{\\mathrm{FR}}(K)$ 的闭式解析表达式。\n2. $r_{\\mathrm{eff}}^{2}$ 的闭式解析表达式。\n\n无需进行数值计算，也无需四舍五入。将两个结果表示为符号表达式。如果你提供两个结果，请按照答案格式的要求，使用 LaTeX 的 $pmatrix$ 环境将它们写成单行。",
            "solution": "该问题要求推导与单核子转移反应的有限程畸波玻恩近似（DWBA）跃迁振幅相关的两个量。第一个是有限程修正因子 $F_{\\mathrm{FR}}(K)$，第二个是给定质子-中子相互作用的有效力程平方参数 $r_{\\mathrm{eff}}^{2}$。\n\n该问题被验证为具有科学依据、适定且自洽的。这是核反应理论中的一个标准推导。\n\n让我们从定义有限程跃迁振幅 $T_{\\mathrm{FR}}$ 开始。示意性地，它由反应核 $R(\\mathbf{s})$ 与质子-中子相互作用 $V_{pn}(s)$ 在相对坐标 $\\mathbf{s}$ 上的重叠积分给出：\n$$\nT_{\\mathrm{FR}} = \\int_{\\mathbb{R}^{3}} d^{3}s \\, R(\\mathbf{s}) V_{pn}(s)\n$$\n其中 $s = |\\mathbf{s}|$，相互作用由高斯形式给出：\n$$\nV_{pn}(s) = V_{0} \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right)\n$$\n\n第一个任务是推导有限程修正因子 $F_{\\mathrm{FR}}(K)$。该因子将有限程振幅 $T_{\\mathrm{FR}}$ 与零程振幅 $T_{\\mathrm{ZR}}$ 联系起来。零程近似对应于假设核 $R(\\mathbf{s})$ 在相互作用的短程范围内是常数，即 $R(\\mathbf{s}) \\approx R(\\mathbf{0})$。因此，零程振幅为：\n$$\nT_{\\mathrm{ZR}} = \\int_{\\mathbb{R}^{3}} d^{3}s \\, R(\\mathbf{0}) V_{pn}(s) = R(\\mathbf{0}) \\int_{\\mathbb{R}^{3}} d^{3}s \\, V_{pn}(s)\n$$\n\n问题为计算 $T_{\\mathrm{FR}}$ 提供了一个更精细的 $R(\\mathbf{s})$ 近似。假设是 $R(\\mathbf{s})$ 是光滑的，并且其在 $\\mathbf{s}=\\mathbf{0}$ 附近的主要变化是一个复相位。这可以通过使用其相位的泰勒展开式的一阶项来近似 $R(\\mathbf{s})$ 来数学地表达。设 $R(\\mathbf{s}) = |R(\\mathbf{s})|\\exp(i\\phi(\\mathbf{s}))$。$|R(\\mathbf{s})|$ 的光滑性意味着对于小的 $s$，有 $|R(\\mathbf{s})| \\approx |R(\\mathbf{0})|$。相位近似为 $\\phi(\\mathbf{s}) \\approx \\phi(\\mathbf{0}) + \\mathbf{s} \\cdot \\left(\\nabla\\phi\\right)|_{\\mathbf{s}=\\mathbf{0}}$。问题将局域动量失配向量 $\\mathbf{K}$ 定义为该梯度，$\\mathbf{K} = \\left(\\nabla\\phi\\right)|_{\\mathbf{s}=\\mathbf{0}}$。因此，我们有局域动量近似：\n$$\nR(\\mathbf{s}) \\approx R(\\mathbf{0}) \\exp(i\\mathbf{K} \\cdot \\mathbf{s})\n$$\n其中任何常相位因子 $\\exp(i\\phi(\\mathbf{0}))$ 都已被吸收到复前置因子 $R(\\mathbf{0})$ 中。\n\n将此近似代入 $T_{\\mathrm{FR}}$ 的表达式中：\n$$\nT_{\\mathrm{FR}} \\approx \\int_{\\mathbb{R}^{3}} d^{3}s \\, \\left[ R(\\mathbf{0}) \\exp(i\\mathbf{K} \\cdot \\mathbf{s}) \\right] \\left[ V_{0} \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) \\right]\n$$\n$$\nT_{\\mathrm{FR}} \\approx R(\\mathbf{0}) V_{0} \\int_{\\mathbb{R}^{3}} d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - \\frac{s^{2}}{\\beta^{2}}\\right)\n$$\n有限程修正因子 $F_{\\mathrm{FR}}(K)$ 由关系式 $T_{\\mathrm{FR}} = T_{\\mathrm{ZR}} F_{\\mathrm{FR}}(K)$ 定义。因此：\n$$\nF_{\\mathrm{FR}}(K) = \\frac{T_{\\mathrm{FR}}}{T_{\\mathrm{ZR}}} = \\frac{R(\\mathbf{0}) V_{0} \\int d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - s^{2}/\\beta^{2}\\right)}{R(\\mathbf{0}) V_{0} \\int d^{3}s \\, \\exp\\left(-s^{2}/\\beta^{2}\\right)} = \\frac{\\int d^{3}s \\, \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s} - s^{2}/\\beta^{2}\\right)}{\\int d^{3}s \\, \\exp\\left(-s^{2}/\\beta^{2}\\right)}\n$$\n分母是一个标准的三维高斯积分，我们将其记为 $I_{denom}$。\n$$\nI_{denom} = \\int d^{3}s \\, \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) = (\\pi \\beta^{2})^{3/2} = \\pi^{3/2} \\beta^{3}\n$$\n分子 $I_{num}$ 是一个高斯函数的傅里叶变换。\n$$\nI_{num} = \\int d^{3}s \\, \\exp\\left(-\\frac{s^{2}}{\\beta^{2}}\\right) \\exp\\left(i\\mathbf{K} \\cdot \\mathbf{s}\\right)\n$$\n为了计算这个，我们在指数中进行配方：\n$$\n-\\frac{s^{2}}{\\beta^{2}} + i\\mathbf{K} \\cdot \\mathbf{s} = -\\frac{1}{\\beta^{2}}\\left(s^{2} - i\\beta^{2}\\mathbf{K} \\cdot \\mathbf{s}\\right) = -\\frac{1}{\\beta^{2}}\\left[\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2} + \\frac{\\beta^{4}K^{2}}{4}\\right] = -\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2} - \\frac{\\beta^{2}K^{2}}{4}\n$$\n其中 $K = |\\mathbf{K}|$。积分变为：\n$$\nI_{num} = \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right) \\int d^{3}s \\, \\exp\\left[-\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2}\\right]\n$$\n通过平移积分变量 $\\mathbf{s}' = \\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}$，这是一个到复平面的平移，高斯积分的值保持不变。\n$$\n\\int d^{3}s \\, \\exp\\left[-\\frac{1}{\\beta^{2}}\\left(\\mathbf{s} - \\frac{i\\beta^{2}\\mathbf{K}}{2}\\right)^{2}\\right] = \\int d^{3}s' \\, \\exp\\left(-\\frac{s'^{2}}{\\beta^{2}}\\right) = I_{denom}\n$$\n因此，$I_{num} = I_{denom} \\cdot \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right)$。修正因子是该比值：\n$$\nF_{\\mathrm{FR}}(K) = \\frac{I_{num}}{I_{denom}} = \\exp\\left(-\\frac{\\beta^{2}K^{2}}{4}\\right)\n$$\n\n第二个任务是找到有效力程平方参数 $r_{\\mathrm{eff}}^{2}$，其定义为势的二阶矩与其体积分的比值：\n$$\nr_{\\mathrm{eff}}^{2} \\equiv \\frac{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, s^{2}\\,V_{pn}(s)}{\\displaystyle\\int_{\\mathbb{R}^{3}} d^{3}s\\, V_{pn}(s)}\n$$\n代入 $V_{pn}(s) = V_{0}\\exp(-s^{2}/\\beta^{2})$，常数 $V_{0}$ 被消去：\n$$\nr_{\\mathrm{eff}}^{2} = \\frac{\\displaystyle\\int d^{3}s\\, s^{2}\\,\\exp(-s^{2}/\\beta^{2})}{\\displaystyle\\int d^{3}s\\, \\exp(-s^{2}/\\beta^{2})}\n$$\n分母同样是 $I_{denom} = \\pi^{3/2} \\beta^{3}$。\n分子是 $s^{2}\\exp(-s^{2}/\\beta^{2})$ 的积分。我们在球坐标中计算它，在角向积分后，$d^{3}s = 4\\pi s^{2}ds$。\n$$\nI_{num}' = \\int d^{3}s\\, s^{2}\\,\\exp(-s^{2}/\\beta^{2}) = 4\\pi \\int_{0}^{\\infty} s^{4}\\exp(-s^{2}/\\beta^{2}) ds\n$$\n我们使用标准积分公式 $\\int_{0}^{\\infty} x^{2n} \\exp(-ax^{2}) dx = \\frac{(2n-1)!!}{2^{n+1}}\\sqrt{\\frac{\\pi}{a^{2n+1}}}$。当 $n=2$ 且 $a=1/\\beta^{2}$ 时：\n$$\n\\int_{0}^{\\infty} s^{4}\\exp(-s^{2}/\\beta^{2}) ds = \\frac{3!!}{2^{3}}\\sqrt{\\frac{\\pi}{(1/\\beta^{2})^{5}}} = \\frac{3}{8}\\sqrt{\\pi\\beta^{10}} = \\frac{3\\sqrt{\\pi}}{8}\\beta^{5}\n$$\n所以分子积分为：\n$$\nI_{num}' = 4\\pi \\left(\\frac{3\\sqrt{\\pi}}{8}\\beta^{5}\\right) = \\frac{3\\pi^{3/2}}{2}\\beta^{5}\n$$\n最后，我们计算 $r_{\\mathrm{eff}}^{2}$ 的比值：\n$$\nr_{\\mathrm{eff}}^{2} = \\frac{I_{num}'}{I_{denom}} = \\frac{\\frac{3\\pi^{3/2}}{2}\\beta^{5}}{\\pi^{3/2}\\beta^{3}} = \\frac{3}{2}\\beta^{2}\n$$\n所求的两个表达式是 $F_{\\mathrm{FR}}(K) = \\exp(-\\frac{\\beta^{2}K^{2}}{4})$ 和 $r_{\\mathrm{eff}}^{2} = \\frac{3}{2}\\beta^{2}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\exp\\left(-\\frac{K^{2}\\beta^{2}}{4}\\right)  \\frac{3}{2}\\beta^{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在DWBA理论的先验形式中，跃迁相互作用通常被分解为几个部分，其中包括所谓的“剩余项”。尽管在某些理想情况下此项可以忽略，但理解和量化其贡献对于评估理论模型的准确性至关重要。本练习  要求您编写一个程序，在简化的平面波近似下，使用实际核物理中常见的伍兹-撒克逊势，通过数值积分来计算这个剩余项的大小。",
            "id": "3547961",
            "problem": "考虑在畸变波玻恩近似（DWBA）下，由氘核引发的反应中的核子转移，其跃迁振幅定义为 $T=\\langle \\chi_f^{(-)}|V_{tr}|\\phi_b\\,\\chi_i^{(+)}\\rangle$，其中 $V_{tr}$ 是跃遷相互作用，$\\chi_i^{(+)}$ 和 $\\chi_f^{(-)}$ 分别是入射和出射畸变波，$\\phi_b$ 是转移核子相对于剩余核的束缚态波函数。在标准初态形式中，可写作 $V_{tr}=V_{pn}+U_p-U_d$，其中 $V_{pn}$ 是质子-中子相互作用，$U_p$ 是出射道中的质子光学势，$U_d$ 是入射道中的氘核光学势。剩余项是 $U_p-U_d$ 对跃迁振幅的贡献，记为 $\\Delta T=\\langle \\chi_f^{(-)}|(U_p-U_d)|\\phi_b\\,\\chi_i^{(+)}\\rangle$。从第一玻恩近似和畸变波的平面波极限出发，将靶核视为无限重，因此约化质量可以很好地用入射粒子质量来近似。对质子和氘核使用 Woods–Saxon 形式的中心、局域且纯实数的光学势，$U_x(r)=-\\dfrac{V_{0,x}}{1+\\exp\\left(\\dfrac{r-R}{a}\\right)}$，其中 $x\\in\\{p,d\\}$，半径 $R=r_0\\,A^{1/3}$，弥散度为 $a$，深度为 $V_{0,x}$。将束缚态建模为具有类氢归一化的 s 波指數函数，$\\phi_b(r)=\\dfrac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\!\\left(-\\dfrac{r}{a_b}\\right)$。在平面波近似下，对入射和出射平面波的乘积进行角度平均，得到球贝塞尔函数 $j_0(qr)=\\dfrac{\\sin(qr)}{qr}$，其中动量转移为 $q=\\lvert k_i-k_f\\rvert$。在重靶极限下使用非相对论运动学，波数为 $k_i=\\dfrac{\\sqrt{2\\,m_d\\,E_d}}{\\hbar c}$ 和 $k_f=\\dfrac{\\sqrt{2\\,m_p\\,E_p}}{\\hbar c}$，其中 $m_d$ 和 $m_p$ 分别是氘核和质子的静止能量（单位 $\\mathrm{MeV}$），$E_d$ 和 $E_p$ 是实验室动能（单位 $\\mathrm{MeV}$），$\\hbar c$ 以 $\\mathrm{MeV\\cdot fm}$ 为单位表示。在这些假设下，剩余振幅简化为径向积分\n$$\n\\Delta T \\;=\\; 4\\pi\\int_0^\\infty r^2\\,j_0(qr)\\,\\big(U_p(r)-U_d(r)\\big)\\,\\phi_b(r)\\,dr,\n$$\n当 $\\phi_b$ 按给定方式归一化时，其单位为 $\\mathrm{MeV\\cdot fm^{3/2}}$。\n\n实现一个程序，用于计算给定靶核质量数 $A$、Woods–Saxon 参数 $r_0$ 和 $a$、束缚态长度标度 $a_b$、道能量 $E_d$ 和 $E_p$ 以及指定光学势深度 $V_{0,p}$ 和 $V_{0,d}$ 时的 $\\Delta T$。使用数值积分法计算在 $r\\in[0,R_{\\max}]$ 上的积分，其中 $R_{\\max}$ 足够大，使得被积函数在其之外可以忽略不计。使用球贝塞尔函数 $j_0(qr)=\\dfrac{\\sin(qr)}{qr}$，其极限值为 $j_0(0)=1$。使用的常数为 $\\hbar c=197.3269804\\,\\mathrm{MeV\\cdot fm}$，$m_p=938.2720813\\,\\mathrm{MeV}$ 和 $m_d=1875.61294257\\,\\mathrm{MeV}$。\n\n将计算出的剩余振幅以 $\\mathrm{MeV\\cdot fm^{3/2}}$ 为单位表示，并四舍五入到六位小数。\n\n测试组：\n- 情况 1（一般情况）：$A=40$，$r_0=1.25\\,\\mathrm{fm}$，$a=0.65\\,\\mathrm{fm}$，$a_b=4.0\\,\\mathrm{fm}$，$V_{0,p}=52.0\\,\\mathrm{MeV}$，$V_{0,d}=90.0\\,\\mathrm{MeV}$，$E_d=15.0\\,\\mathrm{MeV}$，$E_p=8.0\\,\\mathrm{MeV}$。\n- 情况 2（近阈值能量）：$A=40$，$r_0=1.25\\,\\mathrm{fm}$，$a=0.65\\,\\mathrm{fm}$，$a_b=4.0\\,\\mathrm{fm}$，$V_{0,p}=52.0\\,\\mathrm{MeV}$，$V_{0,d}=90.0\\,\\mathrm{MeV}$，$E_d=5.0\\,\\mathrm{MeV}$，$E_p=5.0\\,\\mathrm{MeV}$。\n- 情况 3（高入射能量）：$A=40$，$r_0=1.25\\,\\mathrm{fm}$，$a=0.65\\,\\mathrm{fm}$，$a_b=4.0\\,\\mathrm{fm}$，$V_{0,p}=52.0\\,\\mathrm{MeV}$，$V_{0,d}=90.0\\,\\mathrm{MeV}$，$E_d=60.0\\,\\mathrm{MeV}$，$E_p=20.0\\,\\mathrm{MeV}$。\n- 情况 4（剩余项深度差为零）：$A=40$，$r_0=1.25\\,\\mathrm{fm}$，$a=0.65\\,\\mathrm{fm}$，$a_b=4.0\\,\\mathrm{fm}$，$V_{0,p}=90.0\\,\\mathrm{MeV}$，$V_{0,d}=90.0\\,\\mathrm{MeV}$，$E_d=15.0\\,\\mathrm{MeV}$，$E_p=8.0\\,\\mathrm{MeV}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}\\right]$），每个条目都四舍五入到六位小数，并以 $\\mathrm{MeV\\cdot fm^{3/2}}$ 为单位表示。",
            "solution": "该问题是有效的，因为它在计算核物理领域内提出了一个适定且有科学依据的情景。它是自洽的，提供了所有必需的常数、参数和函数形式。这些近似虽然简化了问题，但在模型计算中是标准的，并且没有违反基本原理。任务是在这些指定的近似下，计算 DWBA 跃迁振幅的剩余项 $\\Delta T$。\n\n计算过程分为几个步骤：首先，确定运动学量；其次，定义构成被积函数的各个函数；第三，对最终积分进行数值计算。\n\n剩余项振幅由以下积分给出：\n$$\n\\Delta T = 4\\pi\\int_0^\\infty r^2\\,j_0(qr)\\,\\big(U_p(r)-U_d(r)\\big)\\,\\phi_b(r)\\,dr\n$$\n\n1.  **运动学量**\n\n计算需要从给定输入中导出几个中间运动学参数。\n\n-   **核半径 ($R$)**: 质子 ($p$) 和氘核 ($d$) 的 Woods-Saxon 势取决于核半径 $R$，该半径由靶核质量数 $A$ 和半径参数 $r_0$ 计算得出。\n    $$\n    R = r_0\\,A^{1/3}\n    $$\n-   **波数 ($k_i, k_f$)**: 初始（氘核）和最终（质子）波数由它们各自的实验室动能 ($E_d$, $E_p$) 和静止质量 ($m_d$, $m_p$) 使用非相对论运动学确定。\n    $$\n    k_i = \\frac{\\sqrt{2\\,m_d\\,E_d}}{\\hbar c}\n    $$\n    $$\n    k_f = \\frac{\\sqrt{2\\,m_p\\,E_p}}{\\hbar c}\n    $$\n    提供的常数为 $\\hbar c=197.3269804\\,\\mathrm{MeV\\cdot fm}$，$m_p=938.2720813\\,\\mathrm{MeV}$ 和 $m_d=1875.61294257\\,\\mathrm{MeV}$。\n-   **动量转移 ($q$)**: 问题在平面波和角度平均近似下，指定动量转移的大小为：\n    $$\n    q = |k_i - k_f|\n    $$\n\n2.  **被积函数的组成部分**\n\n被积函数是几个径向坐标 $r$ 的函数的乘积。\n\n-   **光学势 ($U_p(r), U_d(r)$)**: 质子和氘核的光学势由 Woods-Saxon 形式给出。它们共享相同的半径 $R$ 和弥散度 $a$，但势阱深度 $V_{0,p}$ 和 $V_{0,d}$ 不同。\n    $$\n    U_p(r) = -\\frac{V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n    $$\n    U_d(r) = -\\frac{V_{0,d}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n    因此，它们的差值为：\n    $$\n    U_p(r) - U_d(r) = \\frac{V_{0,d} - V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)}\n    $$\n-   **束缚态波函数 ($\\phi_b(r)$)**: 转移的核子由一个简单的归一化指数函数描述，其特征是长度标度 $a_b$。\n    $$\n    \\phi_b(r) = \\frac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\left(-\\frac{r}{a_b}\\right)\n    $$\n-   **球贝塞尔函数 ($j_0(qr)$)**: 该函数源于平面波的角度平均。其定义为：\n    $$\n    j_0(z) = \\frac{\\sin(z)}{z}\n    $$\n    对于自变量 $z=qr$，我们有 $j_0(qr) = \\frac{\\sin(qr)}{qr}$。为了避免在 $r=0$ 时出现除以零的情况，按规定使用极限值 $j_0(0)=1$。\n\n3.  **组合被积函数并执行积分**\n\n结合所有组成部分，完整的被积函数为：\n$$\nI(r) = r^2 \\left( \\frac{\\sin(qr)}{qr} \\right) \\left( \\frac{V_{0,d} - V_{0,p}}{1+\\exp\\left(\\frac{r-R}{a}\\right)} \\right) \\left( \\frac{1}{\\sqrt{\\pi}\\,a_b^{3/2}}\\,\\exp\\left(-\\frac{r}{a_b}\\right) \\right)\n$$\n剩余振幅则为 $\\Delta T = 4\\pi \\int_0^\\infty I(r) dr$。\n\n当 $V_{0,p} = V_{0,d}$ 时（如测试用例4所示），会出现一种特殊情况。在这种情况下，对于所有 $r$，$U_p(r) - U_d(r) = 0$，使得被积函数恒等于零。因此，无需数值积分即可得出 $\\Delta T = 0$。\n\n该积分通过数值方法计算。被积函数是多个平滑、良态函数的乘积，当 $r$ 很大时，该函数会呈指数衰减（这是由于 Woods-Saxon 分母和束缚态指数函数共同作用的结果）。这确保了在半无限区间 $[0, \\infty)$ 上的积分快速收敛。一个稳健的数值积分程序，例如 `scipy.integrate.quad`，非常适合此任务，因为它能够处理半无限积分域并提供高精度。该算法将把被积函数定义为一个 Python 函数，并将其传递给 `scipy.integrate.quad` 来计算从 $r=0$ 到 $r=\\infty$ 的定积分。最终结果是该积分值乘以因子 $4\\pi$。结果的单位是 $\\mathrm{MeV\\cdot fm^{3/2}}$，这与所涉及物理量的量纲一致。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the remnant term of the DWBA transition amplitude for several test cases.\n    \"\"\"\n    # Define physical constants. All energies are in MeV, lengths in fm.\n    hbar_c = 197.3269804  # MeV * fm\n    m_p = 938.2720813    # MeV/c^2 (numerically MeV)\n    m_d = 1875.61294257  # MeV/c^2 (numerically MeV)\n\n    # Test cases: (A, r0, a, a_b, V0p, V0d, Ed, Ep)\n    test_cases = [\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 15.0, 8.0),\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 5.0, 5.0),\n        (40, 1.25, 0.65, 4.0, 52.0, 90.0, 60.0, 20.0),\n        (40, 1.25, 0.65, 4.0, 90.0, 90.0, 15.0, 8.0),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, r0, a, ab, V0p, V0d, Ed, Ep = case\n\n        # Handle the trivial case where the potential difference is zero.\n        if V0p == V0d:\n            results.append(0.0)\n            continue\n\n        # Step 1: Calculate kinematic quantities\n        R = r0 * (A ** (1.0 / 3.0))\n        k_i = np.sqrt(2 * m_d * Ed) / hbar_c\n        k_f = np.sqrt(2 * m_p * Ep) / hbar_c\n        q = np.abs(k_i - k_f)\n        \n        # Step 2: Define component functions for the integrand\n        \n        def U_diff(r):\n            # U_p(r) - U_d(r)\n            return (V0d - V0p) / (1.0 + np.exp((r - R) / a))\n\n        def phi_b(r):\n            # Normalized s-wave exponential bound-state wavefunction\n            norm = 1.0 / (np.sqrt(np.pi) * (ab ** 1.5))\n            return norm * np.exp(-r / ab)\n\n        def j0(x):\n            # Spherical Bessel function of order 0, j0(x) = sin(x)/x\n            # Use np.sinc which is defined as sin(pi*x)/(pi*x)\n            # j0(z) = sinc(z/pi)\n            if x == 0:\n                return 1.0\n            return np.sin(x) / x\n\n        # Step 3: Define the full integrand for numerical quadrature\n        # Integrand of Delta_T = 4*pi * integral[ I(r) dr ]\n        # I(r) = r^2 * j0(q*r) * (Up(r) - Ud(r)) * phi_b(r)\n        def integrand(r):\n            if r  0:\n                return 0.0\n            \n            # For r=0, the j0 term is 1, but the r^2 term makes the whole thing 0.\n            if r == 0:\n                return 0.0\n\n            return r**2 * j0(q * r) * U_diff(r) * phi_b(r)\n\n        # Step 4: Perform numerical integration from 0 to infinity\n        integral_val, _ = integrate.quad(integrand, 0, np.inf)\n\n        delta_T = 4 * np.pi * integral_val\n        \n        results.append(round(delta_T, 6))\n\n    # Format output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "DWBA理论存在两种代数上等价的表述形式：先验（prior）形式和后验（post）形式。虽然在使用局域且能量无关的简单光学势时两者给出的结果相同，但当引入更真实的非局域或能量依赖的光学势时，这种等价性可能会被破坏。本练习  将通过一个简化的数值模型，让您亲手构建并计算违反等价性条件的例子，从而深入理解非局域性和能量依赖性对DWBA计算的微妙影响。",
            "id": "3547975",
            "problem": "考虑畸变波玻恩近似 (DWBA)，此处定义为由畸变波构建的入射道与出射道之间的一阶跃迁振幅，其中畸变波是具有光学势的有效单粒子薛定谔方程的解。令初始畸变波为 $\\chi_i(\\mathbf{r})$，末态畸变波为 $\\chi_f(\\mathbf{r})$。一般而言，DWBA 存在两种代数上等价的表述，称为 prior 和 post 形式。在存在定域且不依赖于能量的光学势的情况下，根据标准划分一致性，这两种形式是相等的。然而，当光学势为非定域或显式依赖于能量时，除非包含额外的一致性条件或修正项，否则这种相等关系可能被破坏。\n\n我们考虑一个简化的、在单一坐标 $R \\in [0,\\infty)$ 上的球对称模型，并采用无量纲单位，其中 $\\hbar^2/2\\mu = 1$，因此所有量均为无量纲。畸变波 $\\chi_i(R)$ 和 $\\chi_f(R)$ 被视为在 $[0,\\infty)$ 上的平方可积函数，并归一化为1。光学势可以是定域的 $U(R,E)$（可能依赖于能量），也可以是非定域的 $U(R,R')$。\n\n将 DWBA 跃迁振幅的 prior–post 差异定义为\n$$\n\\Delta T \\equiv T_{\\text{prior}} - T_{\\text{post}},\n$$\n其中，在这个简化的模型中，对于定域、不依赖能量的势存在一个划分恒等式，我们将 prior 和 post 算符写为四个划分的光学势（表示为 $U_{aA}$, $U_{bB}$, $U_{xA}$, $U_{xB}$）的组合。转移形状因子被忽略，以便仅关注 prior–post 算符差异。对于定域势，定义\n$$\n\\Delta T_{\\text{local}}(E_i,E_f) = \\int_0^\\infty dR\\, \\chi_f(R)\\,\\Big[U_{xA}(R,E_i) - U_{xB}(R,E_f) - U_{bB}(R,E_f) + U_{aA}(R,E_i)\\Big]\\,\\chi_i(R).\n$$\n对于非定域势，定义\n$$\n\\Delta T_{\\text{nonlocal}} = \\int_0^\\infty dR \\int_0^\\infty dR'\\, \\chi_f(R)\\,\\Big[U_{xA}(R,R') - U_{xB}(R,R') - U_{bB}(R,R') + U_{aA}(R,R')\\Big]\\,\\chi_i(R').\n$$\n\n在此简化模型中，prior–post 相等的条件是：\n- 对于定域且不依赖能量的势，算符恒等式 $U_{xA}(R) - U_{xB}(R) = U_{bB}(R) - U_{aA}(R)$ 在 $R$ 上逐点成立，这意味着对于任何 $\\chi_i$ 和 $\\chi_f$，都有 $\\Delta T_{\\text{local}}=0$。\n- 对于非定域势，算符恒等式 $U_{xA}(R,R') - U_{xB}(R,R') = U_{bB}(R,R') - U_{aA}(R,R')$ 必须作为核函数相等来成立，以确保对于任何 $\\chi_i$ 和 $\\chi_f$，都有 $\\Delta T_{\\text{nonlocal}}=0$。\n- 对于具有显式能量依赖性 $U(R,E)$ 的情况，要使等式对一般的 $(E_i,E_f)$ 成立，需要能量依赖性的安排使得 $U_{xA}(R,E_i) - U_{xB}(R,E_f) = U_{bB}(R,E_f) - U_{aA}(R,E_i)$ 在 $R$ 上逐点成立。如果不满足此条件，则 prior–post 相等性通常被破坏。\n\n你需要实现一个程序，在一具有均匀离散化的有限区间 $R \\in [0,R_{\\max}]$ 上，使用数值归一化的高斯畸变波，为一组测试用例计算 $\\Delta T$。使用\n$$\n\\chi_i(R) = \\mathcal{N}_i \\exp\\big(-\\gamma_i R^2\\big), \\quad \\chi_f(R) = \\mathcal{N}_f \\exp\\big(-\\gamma_f R^2\\big),\n$$\n其中 $\\mathcal{N}_i$ 和 $\\mathcal{N}_f$ 是由 $\\int_0^{R_{\\max}} dR\\, \\chi_i^2(R) = 1$ 和 $\\int_0^{R_{\\max}} dR\\, \\chi_f^2(R) = 1$ 决定的归一化常数。设置 $R_{\\max} = 10$, $\\gamma_i = 0.4$, 以及 $\\gamma_f = 0.7$。\n\n对于定域势，使用以下参数形式\n$$\nU_{\\alpha}(R,E) = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2}{a_\\alpha^2}\\right) + \\alpha_\\alpha\\,E\\,\\exp\\!\\left(-\\frac{R^2}{b_\\alpha^2}\\right),\n$$\n其中 $\\alpha \\in \\{aA, bB, xA, xB\\}$ 且 $\\alpha_\\alpha$ 是能量依赖系数。对于非定域核，使用对称高斯核\n$$\nU_{\\alpha}(R,R') = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2 + R'^2}{a_\\alpha^2}\\right)\\exp\\!\\left(-\\frac{(R - R')^2}{b_\\alpha^2}\\right).\n$$\n\n使用在 $[0,R_{\\max}]$ 上具有 $N = 1000$ 个点的均匀网格，并对单重和双重积分应用矩形法则，来实现数值求积。\n\n测试套件：\n- 案例1（定域，不依赖能量，等式成立）：$E_i=10$, $E_f=10$，其中 $V_{0,aA}=50$, $a_{aA}=2$, $b_{aA}=1.5$, $\\alpha_{aA}=0$；$V_{0,bB}=35$, $a_{bB}=2$, $b_{bB}=1.5$, $\\alpha_{bB}=0$；$V_{0,xA}=35$, $a_{xA}=2$, $b_{xA}=1.5$, $\\alpha_{xA}=0$；$V_{0,xB}=50$, $a_{xB}=2$, $b_{xB}=1.5$, $\\alpha_{xB}=0$。这逐点满足 $U_{xA}(R)-U_{xB}(R)=U_{bB}(R)-U_{aA}(R)$，所以 $\\Delta T_{\\text{local}}$ 在数值上应接近 $0$。\n- 案例2（定域，依赖能量，等式不成立）：$E_i=10$, $E_f=12$，其中 $V_{0,aA}=40$, $a_{aA}=2$, $b_{aA}=1.5$, $\\alpha_{aA}=0.5$；$V_{0,bB}=35$, $a_{bB}=2$, $b_{bB}=1.5$, $\\alpha_{bB}=0.2$；$V_{0,xA}=35$, $a_{xA}=2$, $b_{xA}=1.5$, $\\alpha_{xA}=0.2$；$V_{0,xB}=40$, $a_{xB}=2$, $b_{xB}=1.5$, $\\alpha_{xB}=0.5$。这不满足 $U_{xA}(R,E_i)-U_{xB}(R,E_f)=U_{bB}(R,E_f)-U_{aA}(R,E_i)$，所以 $\\Delta T_{\\text{local}} \\neq 0$。\n- 案例3（非定域，不依赖能量，等式不成立）：$E_i=10$, $E_f=10$，其中 $V_{0,aA}=40$, $a_{aA}=2$, $b_{aA}=1$；$V_{0,bB}=35$, $a_{bB}=2$, $b_{bB}=1$；$V_{0,xA}=30$, $a_{xA}=2$, $b_{xA}=1$；$V_{0,xB}=25$, $a_{xB}=2$, $b_{xB}=1$。这不满足 $U_{xA}(R,R')-U_{xB}(R,R')=U_{bB}(R,R')-U_{aA}(R,R')$，所以 $\\Delta T_{\\text{nonlocal}} \\neq 0$。\n- 案例4（非定域，不依赖能量，等式成立）：$E_i=10$, $E_f=10$，其中 $V_{0,aA}=40$, $a_{aA}=2$, $b_{aA}=1$；$V_{0,bB}=30$, $a_{bB}=2$, $b_{bB}=1$；$V_{0,xA}=30$, $a_{xA}=2$, $b_{xA}=1$；$V_{0,xB}=40$, $a_{xB}=2$, $b_{xB}=1$。这满足 $U_{xA}(R,R')-U_{xB}(R,R')=U_{bB}(R,R')-U_{aA}(R,R')$，所以 $\\Delta T_{\\text{nonlocal}}$ 应在数值上接近 $0$。\n\n你的程序必须：\n- 在网格上构建并归一化 $\\chi_i(R)$ 和 $\\chi_f(R)$。\n- 对每个测试用例，使用适当的公式（定域或非定域）计算 $\\Delta T$。\n- 生成单行输出，其中包含四个结果，格式为逗号分隔的列表并用方括号括起来，例如 $\\big[$result1,result2,result3,result4$\\big]$。\n\n所有结果均为无量纲实数。以浮点数形式表示输出。除已声明的无量纲约定外，不涉及任何角度或物理单位。",
            "solution": "用户提供了一个计算核物理领域的良态问题，要求计算畸变波玻恩近似 (DWBA) 跃迁振幅的 prior-post 差异 $\\Delta T$。该问题经确认为科学上合理、内容自洽且算法清晰。我们将着手制定分步解决方案。\n\n核心任务是为两种场景计算 $\\Delta T$：一种是使用定域、可能依赖于能量的光学势；另一种是使用非定域、不依赖于能量的光学势。计算将在离散网格上以数值方式执行。\n\n**1. 离散化与数值求积**\n\n我们的任务是在有限区间 $R \\in [0, R_{\\max}]$ 上执行计算，其中 $R_{\\max} = 10$。该区间被离散化为一个包含 $N=1000$ 个点的均匀网格。设网格点为 $R_j$，$j=0, 1, \\dots, N-1$。这些点的一个自然选择是由 `numpy.linspace` 生成的等间距序列。\n$$\nR_j = j \\cdot \\Delta R, \\quad \\text{for } j = 0, 1, \\dots, N-1\n$$\n其中网格间距为 $\\Delta R = R_{\\max} / (N-1)$。问题指定使用矩形法则进行数值积分。因此，单重积分 $\\int_0^{R_{\\max}} f(R) dR$ 可近似为以下求和：\n$$\n\\int_0^{R_{\\max}} f(R) dR \\approx \\sum_{j=0}^{N-1} f(R_j) \\Delta R\n$$\n类似地，双重积分 $\\int_0^{R_{\\max}} dR \\int_0^{R_{\\max}} dR' G(R,R')$ 近似为：\n$$\n\\int_0^{R_{\\max}} dR \\int_0^{R_{\\max}} dR' G(R,R') \\approx \\sum_{j=0}^{N-1} \\sum_{k=0}^{N-1} G(R_j, R_k) (\\Delta R)^2\n$$\n\n**2. 波函数归一化**\n\n初始和末态畸变波 $\\chi_i(R)$ 和 $\\chi_f(R)$ 由高斯函数给出：\n$$\n\\chi_k(R) = \\mathcal{N}_k \\exp(-\\gamma_k R^2), \\quad k \\in \\{i, f\\}\n$$\n参数为 $\\gamma_i = 0.4$ 和 $\\gamma_f = 0.7$。归一化常数 $\\mathcal{N}_i$ 和 $\\mathcal{N}_f$ 由波函数在数值网格上归一化为1的条件确定：\n$$\n\\int_0^{R_{\\max}} |\\chi_k(R)|^2 dR = 1\n$$\n代入函数形式和数值求积法则，我们得到：\n$$\n\\mathcal{N}_k^2 \\int_0^{R_{\\max}} \\exp(-2\\gamma_k R^2) dR \\approx \\mathcal{N}_k^2 \\left( \\sum_{j=0}^{N-1} \\exp(-2\\gamma_k R_j^2) \\Delta R \\right) = 1\n$$\n由此，归一化常数 $\\mathcal{N}_k$ 计算如下：\n$$\n\\mathcal{N}_k = \\left( \\Delta R \\sum_{j=0}^{N-1} \\exp(-2\\gamma_k R_j^2) \\right)^{-1/2}\n$$\n我们将计算这些常数，从而获得离散化的波函数 $\\chi_i(R_j)$ 和 $\\chi_f(R_j)$。\n\n**3. 定域势的 $\\Delta T$ 计算**\n\n对于定域势，prior-post 差异由以下积分给出：\n$$\n\\Delta T_{\\text{local}}(E_i,E_f) = \\int_0^\\infty dR\\, \\chi_f(R)\\,\\Big[U_{xA}(R,E_i) - U_{xB}(R,E_f) - U_{bB}(R,E_f) + U_{aA}(R,E_i)\\Big]\\,\\chi_i(R)\n$$\n定域势 $U_\\alpha(R, E)$ 具有以下形式：\n$$\nU_{\\alpha}(R,E) = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2}{a_\\alpha^2}\\right) + \\alpha_\\alpha\\,E\\,\\exp\\!\\left(-\\frac{R^2}{b_\\alpha^2}\\right)\n$$\n让我们将被积函数中的算符项定义为 $\\Delta U_{\\text{local}}(R)$：\n$$\n\\Delta U_{\\text{local}}(R) = U_{xA}(R,E_i) - U_{xB}(R,E_f) - U_{bB}(R,E_f) + U_{aA}(R,E_i)\n$$\n在数值上，我们首先在每个网格点 $R_j$ 上计算函数 $\\chi_i(R_j)$、$\\chi_f(R_j)$ 和 $\\Delta U_{\\text{local}}(R_j)$ 的值。然后，我们使用我们的求积法则计算积分：\n$$\n\\Delta T_{\\text{local}} \\approx \\sum_{j=0}^{N-1} \\chi_f(R_j) \\Delta U_{\\text{local}}(R_j) \\chi_i(R_j) \\Delta R\n$$\n\n**4. 非定域势的 $\\Delta T$ 计算**\n\n对于非定域势，prior-post 差异涉及一个双重积分：\n$$\n\\Delta T_{\\text{nonlocal}} = \\int_0^\\infty dR \\int_0^\\infty dR'\\, \\chi_f(R)\\,\\Big[U_{xA}(R,R') - U_{xB}(R,R') - U_{bB}(R,R') + U_{aA}(R,R')\\Big]\\,\\chi_i(R')\n$$\n非定域势 $U_\\alpha(R, R')$ 具有对称高斯形式：\n$$\nU_{\\alpha}(R,R') = V_{0,\\alpha}\\,\\exp\\!\\left(-\\frac{R^2 + R'^2}{a_\\alpha^2}\\right)\\exp\\!\\left(-\\frac{(R - R')^2}{b_\\alpha^2}\\right)\n$$\n让我们将算符的核定义为 $\\Delta U_{\\text{nonlocal}}(R, R')$：\n$$\n\\Delta U_{\\text{nonlocal}}(R,R') = U_{xA}(R,R') - U_{xB}(R,R') - U_{bB}(R,R') + U_{aA}(R,R')\n$$\n在离散化空间中，波函数变为长度为 $N$ 的向量 $\\boldsymbol{\\chi}_i$ 和 $\\boldsymbol{\\chi}_f$，而核则变为一个 $N \\times N$ 矩阵 $\\mathbf{\\Delta U}_{\\text{nonlocal}}$，其元素为 $(\\mathbf{\\Delta U}_{\\text{nonlocal}})_{jk} = \\Delta U_{\\text{nonlocal}}(R_j, R_k)$。双重积分变成一个矩阵运算：\n$$\n\\Delta T_{\\text{nonlocal}} \\approx \\sum_{j=0}^{N-1} \\sum_{k=0}^{N-1} \\chi_f(R_j) \\Delta U_{\\text{nonlocal}}(R_j, R_k) \\chi_i(R_k) (\\Delta R)^2\n$$\n这等价于矩阵乘积：\n$$\n\\Delta T_{\\text{nonlocal}} \\approx \\boldsymbol{\\chi}_f^T \\, \\mathbf{\\Delta U}_{\\text{nonlocal}} \\, \\boldsymbol{\\chi}_i \\, (\\Delta R)^2\n$$\n其中 $\\boldsymbol{\\chi}_f^T$ 是列向量 $\\boldsymbol{\\chi}_f$ 的转置。实现将涉及构建四个 $N \\times N$ 的势矩阵，将它们组合成 $\\mathbf{\\Delta U}_{\\text{nonlocal}}$，最后执行矩阵-向量乘法。\n\n**5. 测试用例的实现**\n\n程序将被结构化以处理四个指定的测试用例。它将首先设置公共元素（网格、波函数），然后遍历这些用例。根据用例是“定域”还是“非定域”，将遵循上述相应的计算路径。每个势的参数（$V_{0,\\alpha}, a_\\alpha, b_\\alpha, \\alpha_\\alpha$）和能量（$E_i, E_f$）将从每个用例的问题描述中获取。最终结果将被收集并按规定格式化。\n\n对于 prior-post 相等性成立的用例（案例1和案例4），算符项 $\\Delta U$ 在解析上应为零。数值计算应产生一个非常接近零的结果，任何偏差都可归因于浮点精度限制。对于相等性被破坏的用例（案例2和案例3），预计会得到一个非零结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the prior-post difference of the DWBA transition amplitude\n    for four test cases, involving local and nonlocal potentials.\n    \"\"\"\n    # --- Global Parameters ---\n    R_max = 10.0\n    N = 1000\n    gamma_i = 0.4\n    gamma_f = 0.7\n\n    # --- Grid Setup ---\n    R, dR = np.linspace(0, R_max, N, retstep=True)\n\n    # --- Helper Functions ---\n    def normalize_wave_function(gamma, R_grid, dr):\n        \"\"\"\n        Numerically normalizes a Gaussian wave function on the grid.\n        \"\"\"\n        unnormalized_wf = np.exp(-gamma * R_grid**2)\n        norm_integral = np.sum(unnormalized_wf**2) * dr\n        norm_constant = 1.0 / np.sqrt(norm_integral)\n        return norm_constant * unnormalized_wf\n\n    def U_local(R_grid, E, V0, a, b_param, alpha):\n        \"\"\"\n        Computes a local, energy-dependent potential on the grid.\n        \"\"\"\n        term1 = V0 * np.exp(-R_grid**2 / a**2)\n        term2 = alpha * E * np.exp(-R_grid**2 / b_param**2)\n        return term1 + term2\n\n    def U_nonlocal(R_grid, V0, a, b_param):\n        \"\"\"\n        Computes a nonlocal potential kernel as a matrix.\n        \"\"\"\n        R_mesh, R_prime_mesh = np.meshgrid(R_grid, R_grid)\n        term1 = np.exp(-(R_mesh**2 + R_prime_mesh**2) / a**2)\n        term2 = np.exp(-(R_mesh - R_prime_mesh)**2 / b_param**2)\n        return V0 * term1 * term2\n\n    # --- Wave Function Calculation ---\n    chi_i = normalize_wave_function(gamma_i, R, dR)\n    chi_f = normalize_wave_function(gamma_f, R, dR)\n\n    # --- Test Suite Definition ---\n    test_cases = [\n        # Case 1 (Local, energy-independent, equality satisfied)\n        {\n            \"type\": \"local\", \"E_i\": 10.0, \"E_f\": 10.0,\n            \"params\": {\n                \"aA\": {\"V0\": 50, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n                \"bB\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n                \"xA\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n                \"xB\": {\"V0\": 50, \"a\": 2, \"b\": 1.5, \"alpha\": 0},\n            }\n        },\n        # Case 2 (Local, energy-dependent, equality violated)\n        {\n            \"type\": \"local\", \"E_i\": 10.0, \"E_f\": 12.0,\n            \"params\": {\n                \"aA\": {\"V0\": 40, \"a\": 2, \"b\": 1.5, \"alpha\": 0.5},\n                \"bB\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0.2},\n                \"xA\": {\"V0\": 35, \"a\": 2, \"b\": 1.5, \"alpha\": 0.2},\n                \"xB\": {\"V0\": 40, \"a\": 2, \"b\": 1.5, \"alpha\": 0.5},\n            }\n        },\n        # Case 3 (Nonlocal, energy-independent, equality violated)\n        {\n            \"type\": \"nonlocal\",\n            \"params\": {\n                \"aA\": {\"V0\": 40, \"a\": 2, \"b\": 1},\n                \"bB\": {\"V0\": 35, \"a\": 2, \"b\": 1},\n                \"xA\": {\"V0\": 30, \"a\": 2, \"b\": 1},\n                \"xB\": {\"V0\": 25, \"a\": 2, \"b\": 1},\n            }\n        },\n        # Case 4 (Nonlocal, energy-independent, equality satisfied)\n        {\n            \"type\": \"nonlocal\",\n            \"params\": {\n                \"aA\": {\"V0\": 40, \"a\": 2, \"b\": 1},\n                \"bB\": {\"V0\": 30, \"a\": 2, \"b\": 1},\n                \"xA\": {\"V0\": 30, \"a\": 2, \"b\": 1},\n                \"xB\": {\"V0\": 40, \"a\": 2, \"b\": 1},\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        if case[\"type\"] == \"local\":\n            E_i, E_f = case[\"E_i\"], case[\"E_f\"]\n            p = case[\"params\"]\n            \n            U_aA = U_local(R, E_i, p[\"aA\"][\"V0\"], p[\"aA\"][\"a\"], p[\"aA\"][\"b\"], p[\"aA\"][\"alpha\"])\n            U_bB = U_local(R, E_f, p[\"bB\"][\"V0\"], p[\"bB\"][\"a\"], p[\"bB\"][\"b\"], p[\"bB\"][\"alpha\"])\n            U_xA = U_local(R, E_i, p[\"xA\"][\"V0\"], p[\"xA\"][\"a\"], p[\"xA\"][\"b\"], p[\"xA\"][\"alpha\"])\n            U_xB = U_local(R, E_f, p[\"xB\"][\"V0\"], p[\"xB\"][\"a\"], p[\"xB\"][\"b\"], p[\"xB\"][\"alpha\"])\n            \n            delta_U_local = U_xA - U_xB - U_bB + U_aA\n            integrand = chi_f * delta_U_local * chi_i\n            delta_T = np.sum(integrand) * dR\n            results.append(delta_T)\n\n        elif case[\"type\"] == \"nonlocal\":\n            p = case[\"params\"]\n\n            U_aA_mat = U_nonlocal(R, p[\"aA\"][\"V0\"], p[\"aA\"][\"a\"], p[\"aA\"][\"b\"])\n            U_bB_mat = U_nonlocal(R, p[\"bB\"][\"V0\"], p[\"bB\"][\"a\"], p[\"bB\"][\"b\"])\n            U_xA_mat = U_nonlocal(R, p[\"xA\"][\"V0\"], p[\"xA\"][\"a\"], p[\"xA\"][\"b\"])\n            U_xB_mat = U_nonlocal(R, p[\"xB\"][\"V0\"], p[\"xB\"][\"a\"], p[\"xB\"][\"b\"])\n\n            delta_U_nonlocal = U_xA_mat - U_xB_mat - U_bB_mat + U_aA_mat\n            \n            # Using matrix multiplication for the double summation\n            # result = chi_f^T @ (delta_U @ chi_i) * dR^2\n            delta_T = np.dot(chi_f, np.dot(delta_U_nonlocal, chi_i)) * dR**2\n            results.append(delta_T)\n\n    # --- Final Output ---\n    # Format results without scientific notation for small numbers near zero\n    formatted_results = [f\"{r:.15f}\".rstrip('0').rstrip('.') if abs(r) > 1e-12 else \"0.0\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}