{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的求解器之前，理解其产生的离散系统的性质至关重要。第一个练习将探讨用于模型扩散问题的有限差分法，并引导您推导所得到刚度矩阵的条件数。通过分析该数值如何随着网格加密而增长 ，您将对求解边值问题时固有的数值稳定性挑战获得基本认识。",
            "id": "3545166",
            "problem": "在计算核物理学中，边值问题求解器通常应用于板坯上的稳态一维 ($1\\text{D}$) 中子扩散模型，其中输运和吸收被简化为具有指定真空边界的扩散过程。考虑区间 $[0,1]$ 上的典型标量椭圆边值问题，\n$$\n-u''(x) = f(x), \\quad x \\in [0,1], \\quad u(0) = 0, \\quad u(1) = 0,\n$$\n作为此类求解器中出现的主阶扩散算子。使用 $n$ 个内点 $x_i = i h$（其中 $i = 1,2,\\dots,n$）和网格间距 $h = \\frac{1}{n+1}$ 对区间进行离散化，并采用标准的二阶中心有限差分（Finite Difference (FD)）格式得到线性系统 $A \\boldsymbol{u} = \\boldsymbol{f}$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是刚度矩阵。矩阵 $A$ 是对称正定（Symmetric Positive Definite (SPD)）且为三对角 Toeplitz 矩阵，其元素为\n$$\nA_{ii} = \\frac{2}{h^{2}}, \\quad A_{i,i+1} = A_{i+1,i} = -\\frac{1}{h^{2}}, \\quad i = 1,2,\\dots,n-1.\n$$\n从矩阵 $2$-范数条件数 $\\kappa_{2}(A) = \\|A\\|_{2} \\,\\|A^{-1}\\|_{2}$ 的定义和满足齐次 Dirichlet 边界编码 $\\boldsymbol{v}_0 = \\boldsymbol{v}_{n+1} = \\boldsymbol{0}$ 的离散特征值问题 $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$ 出发，推导 $A$ 的谱，并利用它得到 $\\kappa_{2}(A)$作为 $n$ 的函数的闭式表达式。在 $h \\to 0$（等价于 $n \\to \\infty$）的极限下，使用渐近分析从第一性原理证明 $\\kappa_{2}(A)$ 表现出 $O(h^{-2})$ 的增长，并确定乘以 $h^{-2}$ 的主阶常数。将您的最终答案表示为 $\\kappa_{2}(A)$ 关于 $n$ 的单一闭式解析表达式。无需四舍五入；条件数是无量纲的，应不带单位报告。",
            "solution": "矩阵 $A$ 是对称正定（SPD）的。对于任何 SPD 矩阵，矩阵 $2$-范数 $\\|A\\|_2$ 是其最大特征值（$\\lambda_{\\text{max}}$），其逆矩阵的 $2$-范数 $\\|A^{-1}\\|_2$ 是其最小特征值（$\\lambda_{\\text{min}}$）的倒数。因此，条件数 $\\kappa_2(A)$ 由最大特征值与最小特征值的比值给出：\n$$\n\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2 = \\frac{\\lambda_{\\text{max}}(A)}{\\lambda_{\\text{min}}(A)}\n$$\n为了求出 $\\kappa_2(A)$，我们必须首先确定矩阵 $A$ 的谱（所有特征值的集合）。特征值问题为 $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$，其中 $\\boldsymbol{v}$ 是一个特征向量，$\\lambda$ 是其对应的特征值。\n\n矩阵 $A$ 由 $A = \\frac{1}{h^2} T$ 给出，其中 $T$ 是三对角 Toeplitz 矩阵：\n$$\nT = \\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\cdots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  \\vdots \\\\\n\\vdots   -1  2  -1 \\\\\n0  \\cdots  0  -1  2\n\\end{pmatrix} \\in \\mathbb{R}^{n \\times n}\n$$\n特征值问题 $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$ 可以写成 $T\\boldsymbol{v} = (\\lambda h^2) \\boldsymbol{v}$。设 $\\mu = \\lambda h^2$ 为 $T$ 的一个特征值。该方程的第 $i$ 个分量是：\n$$\n-v_{i-1} + 2v_i - v_{i+1} = \\mu v_i, \\quad i = 1, 2, \\dots, n\n$$\n我们将其重新排列成一个齐次二阶线性差分方程：\n$$\n-v_{i-1} + (2-\\mu)v_i - v_{i+1} = 0\n$$\n问题陈述离散化包含了齐次 Dirichlet 边界条件，编码为 $v_0 = 0$ 和 $v_{n+1} = 0$。我们寻求特征向量分量 $v_i$ 的非平凡解。我们使用 ansatz $v_i = z^i$，其中 $z$ 为某个复数。将其代入差分方程得到：\n$$\n-z^{i-1} + (2-\\mu)z^i - z^{i+1} = 0\n$$\n除以 $z^{i-1}$（假设 $z \\neq 0$），我们得到特征方程：\n$$\n-1 + (2-\\mu)z - z^2 = 0 \\quad \\implies \\quad z^2 - (2-\\mu)z + 1 = 0\n$$\n这个二次方程的根是 $z_{1,2} = \\frac{(2-\\mu) \\pm \\sqrt{(2-\\mu)^2-4}}{2}$。由于根的乘积为 $z_1 z_2 = 1$，我们可以将它们记为 $z$ 和 $z^{-1}$。我们设 $z = e^{i\\theta}$，其中 $\\theta$ 为某个值。$v_i$ 的通解是两种形式的线性组合：\n$$\nv_i = C_1 z^i + C_2 z^{-i}\n$$\n应用边界条件 $v_0 = 0$：\n$$\nv_0 = C_1 z^0 + C_2 z^{-0} = C_1 + C_2 = 0 \\implies C_2 = -C_1\n$$\n这将解简化为 $v_i = C_1(z^i - z^{-i})$。如果我们设 $z = e^{i\\theta}$，则变为：\n$$\nv_i = C_1(e^{i\\theta i} - e^{-i\\theta i}) = 2i C_1 \\sin(i\\theta)\n$$\n令新常数 $C = 2i C_1$。则特征向量分量的形式为 $v_i = C \\sin(i\\theta)$。\n现在，我们应用第二个边界条件 $v_{n+1}=0$：\n$$\nv_{n+1} = C \\sin((n+1)\\theta) = 0\n$$\n对于非平凡特征向量，$C \\neq 0$，因此必须有 $\\sin((n+1)\\theta) = 0$。这意味着 $(n+1)\\theta = k\\pi$，其中 $k$ 是一个整数。因此，$\\theta$ 的可能值为：\n$$\n\\theta_k = \\frac{k\\pi}{n+1}, \\quad k = 1, 2, \\dots, n\n$$\n$k=0$ 和 $k=n+1$ 的值会产生平凡特征向量（对所有 $i$ 都有 $v_i=0$），而其他整数 $k$ 值导致的特征向量与 $k \\in \\{1, \\dots, n\\}$ 的特征向量等价（最多相差一个符号）。所以，我们有 $n$ 个不同的特征向量，其分量由下式给出：\n$$\n(v_k)_i = \\sin\\left(\\frac{ik\\pi}{n+1}\\right), \\quad i=1, \\dots, n \\quad \\text{for each } k=1, \\dots, n\n$$\n现在我们找出与每个特征向量 $v_k$ 对应的特征值 $\\mu_k$。从特征方程，我们有 $2-\\mu = z + z^{-1}$。当 $z = e^{i\\theta_k}$ 时，这变为：\n$$\n2-\\mu_k = e^{i\\theta_k} + e^{-i\\theta_k} = 2\\cos(\\theta_k)\n$$\n求解 $\\mu_k$：\n$$\n\\mu_k = 2 - 2\\cos(\\theta_k) = 4\\sin^2\\left(\\frac{\\theta_k}{2}\\right)\n$$\n代入 $\\theta_k = \\frac{k\\pi}{n+1}$：\n$$\n\\mu_k = 4\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right), \\quad k = 1, 2, \\dots, n\n$$\n这些是矩阵 $T$ 的特征值。原始矩阵 $A = \\frac{1}{h^2}T$ 的特征值 $\\lambda_k$ 是：\n$$\n\\lambda_k = \\frac{\\mu_k}{h^2} = \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right), \\quad k = 1, 2, \\dots, n\n$$\n正弦函数在区间 $[0, \\frac{\\pi}{2}]$ 上是单调递增的。对于所有 $k \\in \\{1, \\dots, n\\}$，自变量 $\\frac{k\\pi}{2(n+1)}$ 都在这个范围内，因为 $\\frac{n\\pi}{2(n+1)}  \\frac{\\pi}{2}$。\n最小特征值 $\\lambda_{\\text{min}}$ 在 $k=1$ 时出现：\n$$\n\\lambda_{\\text{min}} = \\lambda_1 = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\n最大特征值 $\\lambda_{\\text{max}}$ 在 $k=n$ 时出现：\n$$\n\\lambda_{\\text{max}} = \\lambda_n = \\frac{4}{h^2}\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)\n$$\n现在，我们可以计算条件数：\n$$\n\\kappa_2(A) = \\frac{\\lambda_{\\text{max}}}{\\lambda_{\\text{min}}} = \\frac{\\frac{4}{h^2}\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)}{\\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\frac{\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)}\n$$\n使用恒等式 $\\sin(x) = \\cos(\\frac{\\pi}{2}-x)$，我们可以重写分子：\n$$\n\\sin\\left(\\frac{n\\pi}{2(n+1)}\\right) = \\sin\\left(\\frac{(n+1-1)\\pi}{2(n+1)}\\right) = \\sin\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}\\right) = \\cos\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\n将此代回 $\\kappa_2(A)$ 的表达式中：\n$$\n\\kappa_2(A) = \\frac{\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\n这是 $\\kappa_2(A)$ 作为 $n$ 的函数的闭式表达式。\n\n对于 $h \\to 0$（即 $n \\to \\infty$）时的渐近分析，我们考虑余切函数的自变量 $x = \\frac{\\pi}{2(n+1)}$。当 $n \\to \\infty$ 时，$x \\to 0$。我们使用余切函数的小角度近似，这可以从正弦和余弦的泰勒级数推导出来：$\\sin(x) = x - O(x^3)$ 和 $\\cos(x) = 1 - O(x^2)$。\n$$\n\\cot(x) = \\frac{\\cos(x)}{\\sin(x)} \\approx \\frac{1}{x} \\quad \\text{对于 } x \\ll 1\n$$\n因此，对于大的 $n$：\n$$\n\\kappa_2(A) \\approx \\left(\\frac{1}{x}\\right)^2 = \\frac{1}{x^2} = \\frac{1}{\\left(\\frac{\\pi}{2(n+1)}\\right)^2} = \\frac{4(n+1)^2}{\\pi^2}\n$$\n根据定义 $h = \\frac{1}{n+1}$，我们可以用 $h$ 来表示这个式子：\n$$\n\\kappa_2(A) \\approx \\frac{4(1/h)^2}{\\pi^2} = \\frac{4}{\\pi^2 h^2} = \\frac{4}{\\pi^2} h^{-2}\n$$\n这从第一性原理证明了 $\\kappa_2(A)$ 表现出 $O(h^{-2})$ 的增长，且乘以 $h^{-2}$ 的主阶常数是 $\\frac{4}{\\pi^2}$。问题要求的是 $\\kappa_2(A)$ 关于 $n$ 的单一闭式表达式，这在渐近分析之前已经推导出。",
            "answer": "$$\n\\boxed{\\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)}\n$$"
        },
        {
            "introduction": "打靶法通过将边值问题（BVP）转化为初值问题（IVP）来求解，提供了一种直观的思路。然而，该方法的成功与否取决于其对初始猜测的敏感性。本练习将通过推导控制误差传播的变分方程，深入探讨打靶法稳定性的核心 。这项分析是理解初始条件的微小误差如何被放大的有力工具，也是设计稳健求解器时必须考量的关键因素。",
            "id": "3545163",
            "problem": "考虑在厚度为$L$的均匀平板中的稳态单群中子扩散，其常数扩散系数为$D0$，宏观吸收截面为$\\Sigma_{a}0$，并有给定的体积源$S(x)$，由以下二阶常微分方程控制：\n$$D\\,\\frac{d^{2}\\phi}{dx^{2}}-\\Sigma_{a}\\,\\phi+S(x)=0\\quad\\text{for }x\\in[0,L].$$\n施加两点狄利克雷边界条件$\\phi(0)=\\phi_{0}$和$\\phi(L)=\\phi_{L}$，构成一个边值问题（BVP）。经典的打靶法策略通过选择初始斜率$s=\\phi'(0)$，将初值问题（IVP）积分至$x=L$，然后定义边界残差，从而将此BVP转换为IVP：\n$$R(s)=\\phi(L;s)-\\phi_{L},$$\n其中$\\phi(x;s)$表示通过积分具有初始条件$\\phi(0)=\\phi_{0}$和$\\phi'(0)=s$的IVP所获得的解。\n\n从适用于计算核物理中边值问题求解器的第一性原理出发，包括控制扩散方程、线性化和基本解概念，推导所选初始斜率中的一个小误差$\\delta s$如何传播到$x=L$处的边界残差。具体来说：\n1. 通过$x=L\\hat{x}$对平板坐标进行无量纲化，并定义无量纲参数$\\kappa^{2}=\\Sigma_{a}L^{2}/D$。写出在$\\hat{x}\\in[0,1]$上的无量纲扩散BVP以及相应的打靶法残差$R(s)$。\n2. 推导控制$\\partial\\phi/\\partial s$的变分（灵敏度）方程，并说明残差相对于初始斜率的导数$dR/ds$如何能用相关齐次变分方程的基本解来表示。\n3. 对于上面给出的常系数情况，以$\\kappa$的函数形式，显式地计算出$dR/ds$的闭合形式。\n\n你的最终答案必须是$\\hat{x}=1$处无量纲灵敏度$dR/ds$的单一闭合形式解析表达式。不需要四舍五入。最终表达式中不要包含单位。请精确表达最终答案。",
            "solution": "**1. 无量纲化**\n\n为使问题无量纲化，我们引入一个由$x=L\\hat{x}$定义的无量纲坐标$\\hat{x}$。区域$x\\in[0,L]$变换为$\\hat{x}\\in[0,1]$。我们使用链式法则来变换导数：\n$$\\frac{d}{dx} = \\frac{d\\hat{x}}{dx}\\frac{d}{d\\hat{x}} = \\frac{1}{L}\\frac{d}{d\\hat{x}}$$\n$$\\frac{d^{2}}{dx^{2}} = \\frac{d}{dx}\\left(\\frac{1}{L}\\frac{d}{d\\hat{x}}\\right) = \\frac{1}{L^{2}}\\frac{d^{2}}{d\\hat{x}^{2}}$$\n将这些代入扩散方程可得：\n$$D\\left(\\frac{1}{L^{2}}\\frac{d^{2}\\phi}{d\\hat{x}^{2}}\\right) - \\Sigma_{a}\\phi + S(L\\hat{x}) = 0$$\n乘以$L^{2}/D$可得：\n$$\\frac{d^{2}\\phi}{d\\hat{x}^{2}} - \\frac{\\Sigma_{a}L^{2}}{D}\\phi + \\frac{L^{2}}{D}S(L\\hat{x}) = 0$$\n使用给定的无量纲参数定义$\\kappa^{2}=\\Sigma_{a}L^{2}/D$并定义一个无量纲源项$\\hat{S}(\\hat{x}) = (L^{2}/D)S(L\\hat{x})$，我们得到无量纲BVP：\n$$\\frac{d^{2}\\phi}{d\\hat{x}^{2}} - \\kappa^{2}\\phi + \\hat{S}(\\hat{x}) = 0, \\quad \\hat{x}\\in[0,1]$$\n边界条件保持为$\\phi(0)=\\phi_{0}$和$\\phi(1)=\\phi_{L}$。\n\n对于打靶法，有量纲的斜率为$s = \\frac{d\\phi}{dx}|_{x=0}$。用无量纲的术语来说，斜率为$\\hat{s} = \\frac{d\\phi}{d\\hat{x}}|_{\\hat{x}=0}$。两者关系如下：\n$$\\hat{s} = \\frac{d\\phi}{d\\hat{x}}|_{\\hat{x}=0} = \\left(L\\frac{d\\phi}{dx}\\right)|_{x=0} = Ls$$\n残差$R(s) = \\phi(L;s) - \\phi_{L}$可以表示为无量纲斜率$\\hat{s}$的函数，即$\\hat{R}(\\hat{s}) = \\phi(1;\\hat{s}) - \\phi_{L}$。\n\n**2. 变分方程和灵敏度导数**\n\n题目要求我们求残差对斜率的灵敏度，即导数$dR/ds$。“无量纲灵敏度”最自然地被解释为残差相对于无量纲斜率的导数，$d\\hat{R}/d\\hat{s}$。这两个导数通过链式法则联系起来：\n$$\\frac{dR}{ds} = \\frac{d\\hat{R}}{d\\hat{s}}\\frac{d\\hat{s}}{ds} = \\frac{d\\hat{R}}{d\\hat{s}}\\frac{d(Ls)}{ds} = L\\frac{d\\hat{R}}{d\\hat{s}}$$\n所以无量纲灵敏度是$\\frac{1}{L}\\frac{dR}{ds} = \\frac{d\\hat{R}}{d\\hat{s}}$。让我们来推导这个量。\n\n根据定义，$\\frac{d\\hat{R}}{d\\hat{s}} = \\frac{d}{d\\hat{s}}\\left(\\phi(1;\\hat{s}) - \\phi_{L}\\right) = \\frac{\\partial\\phi}{\\partial\\hat{s}}(1;\\hat{s})$。\n我们定义灵敏度函数$\\hat{\\psi}(\\hat{x}) = \\frac{\\partial\\phi}{\\partial\\hat{s}}(\\hat{x};\\hat{s})$。为找到$\\hat{\\psi}(\\hat{x})$的控制方程，我们对无量纲ODE关于$\\hat{s}$求导：\n$$\\frac{\\partial}{\\partial\\hat{s}}\\left(\\frac{d^{2}\\phi}{d\\hat{x}^{2}} - \\kappa^{2}\\phi + \\hat{S}(\\hat{x})\\right) = \\frac{\\partial}{\\partial\\hat{s}}(0)$$\n由于微分顺序可以交换，且$\\kappa$和$\\hat{S}(\\hat{x})$与斜率猜测值$\\hat{s}$无关，我们得到：\n$$\\frac{d^{2}}{d\\hat{x}^{2}}\\left(\\frac{\\partial\\phi}{\\partial\\hat{s}}\\right) - \\kappa^{2}\\left(\\frac{\\partial\\phi}{\\partial\\hat{s}}\\right) = 0$$\n这就得出了灵敏度函数$\\hat{\\psi}(\\hat{x})$的变分方程：\n$$\\frac{d^{2}\\hat{\\psi}}{d\\hat{x}^{2}} - \\kappa^{2}\\hat{\\psi} = 0$$\n这是一个齐次线性二阶常微分方程。为求解该方程，我们需要初始条件。这些条件通过对打靶法IVP的初始条件关于$\\hat{s}$求导得到：\n\\begin{enumerate}\n    \\item $\\phi(0;\\hat{s}) = \\phi_{0}$。对$\\hat{s}$求导得到$\\frac{\\partial\\phi}{\\partial\\hat{s}}(0;\\hat{s}) = 0$，因此$\\hat{\\psi}(0)=0$。\n    \\item $\\frac{d\\phi}{d\\hat{x}}(0;\\hat{s}) = \\hat{s}$。对$\\hat{s}$求导得到$\\frac{\\partial}{\\partial\\hat{s}}\\left(\\frac{d\\phi}{d\\hat{x}}(0;\\hat{s})\\right) = 1$。交换求导顺序，我们得到$\\frac{d}{d\\hat{x}}\\left(\\frac{\\partial\\phi}{\\partial\\hat{s}}\\right)(0;\\hat{s}) = 1$，因此$\\frac{d\\hat{\\psi}}{d\\hat{x}}(0)=1$。\n\\end{enumerate}\n所求的无量纲灵敏度为$\\frac{d\\hat{R}}{d\\hat{s}} = \\hat{\\psi}(1)$。问题要求将其与齐次变分方程的基本解联系起来。如果我们选择一组满足初始条件$u_1(0)=1, u_1'(0)=0$和$u_2(0)=0, u_2'(0)=1$的基本解$u_1(\\hat{x})$和$u_2(\\hat{x})$，那么$\\hat{\\psi}(\\hat{x})$的IVP解为$\\hat{\\psi}(\\hat{x}) = \\hat{\\psi}(0)u_1(\\hat{x}) + \\hat{\\psi}'(0)u_2(\\hat{x}) = 0 \\cdot u_1(\\hat{x}) + 1 \\cdot u_2(\\hat{x}) = u_2(\\hat{x})$。因此，无量纲灵敏度精确地是第二个基本解在边界处的值，即$d\\hat{R}/d\\hat{s} = u_2(1)$。\n\n**3. 显式闭合形式评估**\n\n我们现在求解$\\hat{\\psi}(\\hat{x})$的IVP，以找到无量纲灵敏度的显式表达式。方程为$\\hat{\\psi}'' - \\kappa^{2}\\hat{\\psi} = 0$。特征方程是$r^{2} - \\kappa^{2} = 0$，其根为$r = \\pm\\kappa$。通解可以方便地用双曲函数来写：\n$$\\hat{\\psi}(\\hat{x}) = C_{1}\\cosh(\\kappa\\hat{x}) + C_{2}\\sinh(\\kappa\\hat{x})$$\n我们应用初始条件，$\\hat{\\psi}(0)=0$和$\\hat{\\psi}'(0)=1$：\n$$\\hat{\\psi}(0) = C_{1}\\cosh(0) + C_{2}\\sinh(0) = C_{1} \\cdot 1 + C_{2} \\cdot 0 = C_{1}$$\n所以，$C_{1}=0$。解简化为$\\hat{\\psi}(\\hat{x}) = C_{2}\\sinh(\\kappa\\hat{x})$。现在我们使用对导数的第二个初始条件，$\\hat{\\psi}'(\\hat{x}) = C_{2}\\kappa\\cosh(\\kappa\\hat{x})$：\n$$\\hat{\\psi}'(0) = C_{2}\\kappa\\cosh(0) = C_{2}\\kappa \\cdot 1 = C_{2}\\kappa$$\n我们要求$\\hat{\\psi}'(0)=1$，所以$C_{2}\\kappa = 1$，这给出$C_{2} = 1/\\kappa$。\n\n因此，灵敏度函数为：\n$$\\hat{\\psi}(\\hat{x}) = \\frac{\\sinh(\\kappa\\hat{x})}{\\kappa}$$\n无量纲灵敏度是该函数在边界$\\hat{x}=1$处的值：\n$$\\frac{d\\hat{R}}{d\\hat{s}} = \\hat{\\psi}(1) = \\frac{\\sinh(\\kappa)}{\\kappa}$$\n这就是无量纲灵敏度作为$\\kappa$函数的最终闭合形式表达式。这个量描述了无量纲斜率$\\hat{s}$的初始猜测中的一个误差如何传播到远端边界$\\hat{x}=1$的残差。对于这样一个线性问题，残差$\\hat{R}$是$\\hat{s}$的线性函数，而$\\hat{\\psi}(1)$是这条直线的常数斜率。",
            "answer": "$$\\boxed{\\frac{\\sinh(\\kappa)}{\\kappa}}$$"
        },
        {
            "introduction": "有限元方法（FEM）是求解微分方程，特别是处理复杂几何形状或可变系数问题时，一个功能强大且用途广泛的框架。本练习将以一个中子扩散问题为例，手把手地引导您实践FEM的核心工作流程，这在核物理中非常常见。您将从方程的强形式过渡到弱形式，使用提升函数处理非齐次边界条件，并最终组装线性系统 ，从而巩固您对这一基石性数值技术的理解。",
            "id": "3545228",
            "problem": "考虑在区间 $[0,1]$ 上的无量纲、一维、稳态、单群中子扩散边值问题：\n$$\n-\\frac{d}{dx}\\!\\left(p(x)\\,\\frac{du}{dx}\\right) + q(x)\\,u(x) = s(x),\n$$\n其狄利克雷边界条件为 $u(0)=\\alpha$ 和 $u(1)=\\beta$。此处，$p(x)$ 模拟空间变化的扩散系数，$q(x)$ 模拟空间变化的宏观吸收，$s(x)$ 是一个体积中子源。使用无量纲单位进行计算。\n\n任务：\n- 从强形式出发，使用二阶线性椭圆算子的标准变分框架推导弱形式。清晰地指出双线性形式和线性泛函，并指明相关的函数空间。首次使用时需定义所有缩写（例如，有限元法 (FEM)，偏微分方程 (PDE)）。\n- 引入一个提升函数 $l(x)$ 以强制施加狄利克雷边界数据，记 $u = w + l$，其中 $w \\in H_0^1(0,1)$，并说明弱形式中的右端项是如何被修正的。\n- 对于在长度为 $h_i = x_{i+1}-x_i$ 的一般单元 $e = [x_i,x_{i+1}]$ 上使用连续分片线性形函数的有限元法，从第一性原理出发，推导以 $p(x)$、$q(x)$、$s(x)$ 和提升函数 $l(x)$ 表示的单元刚度矩阵和单元载荷向量：\n  - 将 $a,b \\in \\{i,i+1\\}$ 的 $K^{(e)}_{ab}$ 表示为包含 $p(x)$、$q(x)$ 以及单元形函数及其导数的积分。\n  - 将 $a \\in \\{i,i+1\\}$ 的 $f^{(e)}_{a}$ 表示为包含 $s(x)$、$p(x)$、$q(x)$、$l(x)$ 以及单元形函数及其导数的积分。\n- 特化到以下情况：\n$$\np(x) = 1 + x,\\qquad q(x) = x,\\qquad s(x) = 1 + x^2,\n$$\n狄利克雷数据为 $\\alpha = 0.2$ 和 $\\beta = 0.6$。选择线性提升函数 $l(x) = \\alpha + (\\beta-\\alpha)\\,x$。使用包含2个线性有限元和节点 $x_0=0, x_1=0.5, x_2=1$ 的均匀网格。为单个内部未知量组装全局系统，并精确计算有限元近似解 $u_h(x_1)$。\n\n答案形式：\n- 以 $u_h(0.5)$ 的单个标量值的形式提供您的最终答案。\n- 将最终答案表示为一个精确有理数。不包含单位。",
            "solution": "我们从稳态单群中子扩散偏微分方程 (PDE) 开始：\n$$\n-\\frac{d}{dx}\\!\\left(p(x)\\,\\frac{du}{dx}\\right) + q(x)\\,u(x) = s(x)\\quad \\text{in } (0,1),\n$$\n其狄利克雷边界条件为 $u(0)=\\alpha$ 和 $u(1)=\\beta$。我们在索博列夫空间 $H^1(0,1)$ 上寻求一个弱（变分）形式，其试探函数满足边界条件。令 $V := H_0^1(0,1)$，并令检验函数 $v \\in V$。将偏微分方程乘以 $v$ 并对扩散项进行分部积分：\n$$\n\\int_0^1 p(x)\\,u'(x)\\,v'(x)\\,dx + \\int_0^1 q(x)\\,u(x)\\,v(x)\\,dx = \\int_0^1 s(x)\\,v(x)\\,dx,\n$$\n其中边界项因 $v(0)=v(1)=0$ 而消失。定义双线性形式\n$$\na(u,v) := \\int_0^1 p(x)\\,u'(x)\\,v'(x)\\,dx + \\int_0^1 q(x)\\,u(x)\\,v(x)\\,dx,\n$$\n和线性泛函\n$$\n\\ell(v) := \\int_0^1 s(x)\\,v(x)\\,dx.\n$$\n弱问题是：求 $u \\in H^1(0,1)$，满足 $u(0)=\\alpha$，$u(1)=\\beta$，使得\n$$\na(u,v) = \\ell(v)\\quad \\forall v \\in V.\n$$\n\n为了通过提升函数施加狄利克雷边界数据，选择 $l \\in H^1(0,1)$ 满足 $l(0)=\\alpha$ 和 $l(1)=\\beta$，并记 $u = w + l$，其中 $w \\in V$。代入弱形式得到\n$$\na(w+l,v) = \\ell(v)\\quad \\forall v \\in V,\n$$\n因此\n$$\na(w,v) = \\ell(v) - a(l,v) = \\int_0^1 s(x)\\,v(x)\\,dx - \\int_0^1 p(x)\\,l'(x)\\,v'(x)\\,dx - \\int_0^1 q(x)\\,l(x)\\,v(x)\\,dx.\n$$\n因此，提升仅修正了右端项为\n$$\nf(v) := \\int_0^1 s(x)\\,v(x)\\,dx - \\int_0^1 p(x)\\,l'(x)\\,v'(x)\\,dx - \\int_0^1 q(x)\\,l(x)\\,v(x)\\,dx,\n$$\n而 $V$ 上的双线性形式 $a(\\cdot,\\cdot)$ 保持不变。\n\n对于有限元法 (FEM)，考虑一个长度为 $h_i = x_{i+1}-x_i$ 的单元 $e=[x_i,x_{i+1}]$。令 $\\{N_i,N_{i+1}\\}$ 为该单元的线性形函数，满足 $N_i(x_i)=1, N_i(x_{i+1})=0, N_{i+1}(x_i)=0, N_{i+1}(x_{i+1})=1$，以及 $N_i' = -1/h_i, N_{i+1}' = 1/h_i$。单元刚度矩阵项直接从双线性形式推导得出：\n$$\nK^{(e)}_{ab} = \\int_{x_i}^{x_{i+1}} p(x)\\,N_a'(x)\\,N_b'(x)\\,dx + \\int_{x_i}^{x_{i+1}} q(x)\\,N_a(x)\\,N_b(x)\\,dx,\\quad a,b\\in\\{i,i+1\\}.\n$$\n使用提升后的右端项，单元载荷向量项为：\n$$\nf^{(e)}_{a} = \\int_{x_i}^{x_{i+1}} s(x)\\,N_a(x)\\,dx - \\int_{x_i}^{x_{i+1}} p(x)\\,l'(x)\\,N_a'(x)\\,dx - \\int_{x_i}^{x_{i+1}} q(x)\\,l(x)\\,N_a(x)\\,dx,\\quad a\\in\\{i,i+1\\}.\n$$\n全局组装遵循标准的有限元流程，通过将相邻单元对共享全局自由度的贡献相加来完成。\n\n现在特化到\n$$\np(x)=1+x,\\quad q(x)=x,\\quad s(x)=1+x^2,\n$$\n狄利克雷数据为 $\\alpha=0.2$ 和 $\\beta=0.6$。选择线性提升函数\n$$\nl(x) = \\alpha + (\\beta-\\alpha)\\,x = 0.2 + 0.4\\,x,\n$$\n因此 $l'(x)=0.4$。使用包含2个单元和节点 $x_0=0, x_1=0.5, x_2=1$ 的均匀网格。离散未知量是与全局帽状基函数 $\\phi_1$ 相关联的单个内部自由度 $w_1 \\approx w(x_1)$。$w_1$ 的全局刚度为\n$$\nK_{11} = \\int_0^1 p(x)\\,(\\phi_1'(x))^2\\,dx + \\int_0^1 q(x)\\,(\\phi_1(x))^2\\,dx.\n$$\n在 $[0,0.5]$ 上，$\\phi_1(x)=2x$ 且 $\\phi_1'(x)=2$。在 $[0.5,1]$ 上，$\\phi_1(x)=2(1-x)$ 且 $\\phi_1'(x)=-2$。\n\n计算扩散部分：\n$$\n\\int_0^{0.5} (1+x)\\,(2)^2 dx = 4\\int_0^{0.5} (1+x)\\,dx = 4\\left(\\frac{5}{8}\\right)=\\frac{5}{2},\n$$\n$$\n\\int_{0.5}^{1} (1+x)\\,( -2)^2 dx = 4\\int_{0.5}^{1} (1+x)\\,dx = 4\\left(\\frac{7}{8}\\right)=\\frac{7}{2}.\n$$\n因此扩散部分的贡献总和为 $\\frac{5}{2}+\\frac{7}{2}=6$。\n\n计算吸收部分：\n$$\n\\int_0^{0.5} x\\,(2x)^2\\,dx = \\int_0^{0.5} 4x^3\\,dx = \\left[x^4\\right]_0^{0.5} = \\frac{1}{16},\n$$\n$$\n\\int_{0.5}^{1} x\\,[2(1-x)]^2\\,dx = \\int_{0.5}^{1} 4x(1-2x+x^2)\\,dx = \\frac{5}{48}.\n$$\n因此吸收部分的贡献为 $\\frac{1}{16}+\\frac{5}{48}=\\frac{1}{6}$。所以\n$$\nK_{11} = 6 + \\frac{1}{6} = \\frac{37}{6}.\n$$\n\n接下来为单个检验函数 $\\phi_1$ 计算提升后的右端项：\n$$\nf_1 = \\int_0^1 s(x)\\,\\phi_1(x)\\,dx - \\int_0^1 p(x)\\,l'(x)\\,\\phi_1'(x)\\,dx - \\int_0^1 q(x)\\,l(x)\\,\\phi_1(x)\\,dx.\n$$\n分段计算每一项。\n\n源项：\n在 $[0,0.5]$ 上，$(1+x^2)\\,(2x) = 2x + 2x^3$ 得到\n$$\n\\int_0^{0.5} (2x + 2x^3)\\,dx = \\left[x^2 + \\frac{x^4}{2}\\right]_0^{0.5} = \\frac{1}{4}+\\frac{1}{32} = \\frac{9}{32}.\n$$\n在 $[0.5,1]$ 上，$(1+x^2)\\,2(1-x) = 2 - 2x + 2x^2 - 2x^3$ 得到\n$$\n\\int_{0.5}^{1} (2 - 2x + 2x^2 - 2x^3)\\,dx = \\left[2x - x^2 + \\frac{2}{3}x^3 - \\frac{1}{2}x^4\\right]_{0.5}^{1} = \\frac{35}{96}.\n$$\n因此\n$$\n\\int_0^1 s(x)\\,\\phi_1(x)\\,dx = \\frac{9}{32} + \\frac{35}{96} = \\frac{31}{48}.\n$$\n\n提升-扩散耦合项：\n由于 $l'(x)=0.4=\\frac{2}{5}$ 并且 $\\phi_1'$ 在每个子区间上是常数，\n$$\n\\int_0^1 p(x)\\,l'(x)\\,\\phi_1'(x)\\,dx = \\frac{2}{5}\\left[2\\int_0^{0.5}(1+x)\\,dx - 2\\int_{0.5}^{1}(1+x)\\,dx\\right]\n= \\frac{2}{5}\\left[2\\cdot\\frac{5}{8} - 2\\cdot\\frac{7}{8}\\right] = -\\frac{1}{5}.\n$$\n\n提升-吸收耦合项：\n在 $[0,0.5]$ 上，$x\\,l(x)\\,\\phi_1(x) = x\\,(0.2+0.4x)\\,(2x) = 0.4 x^2 + 0.8 x^3$，因此\n$$\n\\int_0^{0.5} \\left(0.4 x^2 + 0.8 x^3\\right)\\,dx = \\frac{1}{60} + \\frac{1}{80} = \\frac{7}{240}.\n$$\n在 $[0.5,1]$ 上，$x\\,l(x)\\,\\phi_1(x) = x\\,(0.2+0.4x)\\,2(1-x) = 0.4 x + 0.4 x^2 - 0.8 x^3$，因此\n$$\n\\int_{0.5}^{1} \\left(0.4 x + 0.4 x^2 - 0.8 x^3\\right)\\,dx \n= \\left[\\frac{1}{5}x^2 + \\frac{2}{15}x^3 - \\frac{1}{5}x^4\\right]_{0.5}^{1} = \\frac{19}{240}.\n$$\n因此\n$$\n\\int_0^1 q(x)\\,l(x)\\,\\phi_1(x)\\,dx = \\frac{7}{240} + \\frac{19}{240} = \\frac{13}{120}.\n$$\n\n汇总各项，\n$$\nf_1 = \\frac{31}{48} - \\left(-\\frac{1}{5}\\right) - \\frac{13}{120} = \\frac{31}{48} + \\frac{1}{5} - \\frac{13}{120} = \\frac{59}{80}.\n$$\n\n单个未知量 $w_1$ 的离散方程是\n$$\nK_{11}\\,w_1 = f_1 \\quad \\Longrightarrow \\quad w_1 = \\frac{f_1}{K_{11}} = \\frac{\\frac{59}{80}}{\\frac{37}{6}} = \\frac{177}{1480}.\n$$\n通过加上提升函数来恢复内部节点处的 $u_h$：\n$$\nu_h(0.5) = w_1 + l(0.5) = \\frac{177}{1480} + \\left(0.2 + 0.4\\cdot 0.5\\right) = \\frac{177}{1480} + \\frac{2}{5} = \\frac{177}{1480} + \\frac{592}{1480} = \\frac{769}{1480}.\n$$\n这就是指定数据下，在 $x=0.5$ 处的有限元近似解的精确有理数值。",
            "answer": "$$\\boxed{\\frac{769}{1480}}$$"
        }
    ]
}