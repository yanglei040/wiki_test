{
    "hands_on_practices": [
        {
            "introduction": "在量子力学中，一个核心问题是确定一个势阱在何种条件下能够“捕获”一个粒子，形成束缚态。本练习将引导你使用变分原理——一个既强大又直观的工具——来探讨这个问题。你将通过构建一个简单的指数形式试探波函数，来估算汤川势支持第一个束缚态所需的“临界耦合强度”$g_c$。这个过程不仅能让你深入理解束缚态的形成条件，也完美展示了如何利用简洁的解析模型来洞察深刻的物理阈值问题 。",
            "id": "3609068",
            "problem": "考虑球对称 Yukawa 势的三维非相对论性薛定谔算符的无量纲形式，\n$$\nH_g = -\\nabla^2 - g \\,\\frac{e^{-a r}}{r},\n$$\n该算符作用于 $\\mathbb{R}^3$ 上的平方可积波函数，其中 $r = \\lVert \\mathbf{r}\\rVert$，耦合强度 $g \\ge 0$ 和屏蔽参数 $a  0$ 均为无量纲量，并且动能前置因子已被缩放以使 $\\hbar^2/(2m)=1$。重点关注 $s$ 波（$\\ell=0$）态，其具有球对称波函数 $\\psi(\\mathbf{r})=\\psi(r)$。\n\n你的任务是：\n\n1. 仅使用 Rayleigh–Ritz 变分原理和球坐标下拉普拉斯算符的基本性质，证明存在一个临界耦合 $g_c(a)  0$，使得当 $g  g_c(a)$ 时，$H_g$ 的基态能量为负；当 $g  g_c(a)$ 时，基态能量为非负。你的推导必须从以下定义出发：对于任意归一化的试探函数 $\\psi$，\n$$\nE[\\psi;g,a] = \\int_{\\mathbb{R}^3} \\psi(\\mathbf{r}) \\left( -\\nabla^2 \\right) \\psi(\\mathbf{r}) \\, d^3\\mathbf{r} \\; - \\; g \\int_{\\mathbb{R}^3} \\frac{e^{-a r}}{r} \\, \\lvert \\psi(\\mathbf{r}) \\rvert^2 \\, d^3\\mathbf{r}\n$$\n是基态能量的一个上界，并且 $s$ 波试探函数可以取为实数且非负。不要假定任何关于 Yukawa 势的预计算公式；所有必要的表达式都必须从这些原理中推导出来。\n\n2. 通过考虑一个单参数的归一化 $s$ 波试探函数族\n$$\n\\psi_{\\alpha}(r) = \\mathcal{N}(\\alpha)\\, e^{-\\alpha r}, \\quad \\alpha  0,\n$$\n其中归一化常数 $\\mathcal{N}(\\alpha)$ 的选择需满足 $\\int_{\\mathbb{R}^3} \\lvert \\psi_\\alpha(\\mathbf{r}) \\rvert^2 d^3\\mathbf{r} = 1$，来概述一个能够得出 $g_c(a)$ 的可计算上界的构造性变分证明。定义 Rayleigh 商\n$$\nE(\\alpha; g, a) = \\int_{\\mathbb{R}^3} \\left\\lvert \\nabla \\psi_\\alpha(\\mathbf{r}) \\right\\rvert^2 \\, d^3\\mathbf{r} \\; - \\; g \\int_{\\mathbb{R}^3} \\frac{e^{-a r}}{r} \\, \\lvert \\psi_\\alpha(\\mathbf{r}) \\rvert^2 \\, d^3\\mathbf{r}.\n$$\n证明基态能量的变分估计为 $\\inf_{\\alpha0} E(\\alpha; g,a)$，并论证临界耦合估计值 $g_c(a)$ 是使 $\\inf_{\\alpha0} E(\\alpha; g,a) = 0$ 成立的最小 $g$ 值。将此估计的计算简化为一个关于 $\\alpha$ 的显式一维最小化问题，其依据是在阈值处的 Euler–Lagrange 条件，即最小化参数 $\\alpha$ 同时满足 $E(\\alpha; g, a) = 0$ 和 $\\partial E(\\alpha; g, a)/\\partial \\alpha = 0$。\n\n3. 实现一个程序，对指数试探函数族执行此变分计算，计算由此产生的 $g_c(a)$ 的上界估计值，并将其应用于以下屏蔽参数测试集：\n- $a = 0.1$ （一般情况），\n- $a = 1.0$ （一般情况），\n- $a = 5.0$ （强屏蔽），\n- $a = 0.001$ （近库仑极限）。\n所有量均为无量纲。你的程序必须将这些 $a$ 值对应的估计临界耦合以浮点数形式输出，并四舍五入到十位小数。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序与上述测试集相同。例如，格式必须严格为\n$$\n[\\text{g1},\\text{g2},\\text{g3},\\text{g4}]\n$$\n其中每个 $\\text{gk}$ 是一个四舍五入到十位小数的十进制数（无单位）。",
            "solution": "在尝试任何解决方案之前，对用户提供的问题进行验证。\n\n### 步骤 1：提取已知条件\n- **哈密顿量**：球对称 Yukawa 势的三维非相对论性薛定谔算符的无量纲形式为 $H_g = -\\nabla^2 - g \\,\\frac{e^{-a r}}{r}$。\n- **定义域**：该算符作用于 $\\mathbb{R}^3$ 上的平方可积波函数。\n- **参数**：$r = \\lVert \\mathbf{r}\\rVert$，$g \\ge 0$ 是耦合强度，$a  0$ 是屏蔽参数。所有量均为无量纲。\n- **缩放**：动能前置因子已被缩放以使 $\\hbar^2/(2m)=1$。\n- **态类型**：分析重点是 $s$ 波（$\\ell=0$）态，其具有球对称波函数 $\\psi(\\mathbf{r})=\\psi(r)$。\n- **变分原理**：对于任意归一化的试探函数 $\\psi$，能量泛函 $E[\\psi;g,a] = \\int_{\\mathbb{R}^3} \\psi(\\mathbf{r}) \\left( -\\nabla^2 \\right) \\psi(\\mathbf{r}) \\, d^3\\mathbf{r} \\; - \\; g \\int_{\\mathbb{R}^3} \\frac{e^{-a r}}{r} \\, \\lvert \\psi(\\mathbf{r}) \\rvert^2 \\, d^3\\mathbf{r}$ 提供了基态能量的一个上界。对于 $s$ 波态，$\\psi$ 可以假定为实数且非负。\n- **替代能量泛函**：$E(\\alpha; g, a) = \\int_{\\mathbb{R}^3} \\left\\lvert \\nabla \\psi_\\alpha(\\mathbf{r}) \\right\\rvert^2 \\, d^3\\mathbf{r} \\; - \\; g \\int_{\\mathbb{R}^3} \\frac{e^{-a r}}{r} \\, \\lvert \\psi_\\alpha(\\mathbf{r}) \\rvert^2 \\, d^3\\mathbf{r}$。\n- **试探函数族**：对于构造性证明，提供了一个特定的单参数 $s$ 波试探函数族：$\\psi_{\\alpha}(r) = \\mathcal{N}(\\alpha)\\, e^{-\\alpha r}$，其中 $\\alpha  0$。\n- **归一化**：$\\int_{\\mathbb{R}^3} \\lvert \\psi_\\alpha(\\mathbf{r}) \\rvert^2 d^3\\mathbf{r} = 1$。\n- **任务**：为屏蔽参数测试集 $a \\in \\{0.1, 1.0, 5.0, 0.001\\}$ 计算临界耦合 $g_c(a)$ 的一个上界。\n- **输出格式**：单行 `[g1,g2,g3,g4]`，数值四舍五入到十位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于薛定谔方程的标准量子力学处理方法和 Rayleigh-Ritz 变分原理的应用。Yukawa 势是核物理和粒子物理中的一个基本要素。问题提法得当，提供了明确的目标和通向解决方案的构造性路径。所提供的信息是自洽且一致的；通过格林第一恒等式，对于在无穷远处消失的实值波函数，能量泛函的两种表达式是等价的。语言客观且数学上精确。未发现任何缺陷。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n根据要求，解答分为三个部分，详细说明临界耦合的存在性、通过构造性变分证明对其进行估计，以及推导用于实现的公式。\n\n**第 1 部分：临界耦合的存在性**\n\n哈密顿量 $H_g$ 的基态能量 $E_0(g,a)$ 由 Rayleigh-Ritz 泛函在所有归一化函数 $\\psi$ 上的下确界给出：\n$$\nE_0(g,a) = \\inf_{\\psi, \\lVert\\psi\\rVert=1} E[\\psi;g,a]\n$$\n泛函 $E[\\psi;g,a]$ 可以分为动能部分和势能部分：\n$$\nE[\\psi;g,a] = K[\\psi] - g V[\\psi]\n$$\n其中 $K[\\psi] = \\int_{\\mathbb{R}^3} |\\nabla\\psi|^2 \\, d^3\\mathbf{r}$ 且 $V[\\psi] = \\int_{\\mathbb{R}^3} \\frac{e^{-ar}}{r} |\\psi|^2 \\, d^3\\mathbf{r}$。对于任何非零、可归一化的函数 $\\psi$，$K[\\psi]$ 和 $V[\\psi]$ 均为正值。\n\n当且仅当基态能量为负（$E_0(g,a)  0$）时，束缚态存在。根据变分原理，如果存在至少一个试探函数 $\\psi$ 使得 $E[\\psi;g,a]  0$，则该条件满足。这个不等式可以重新整理为：\n$$\nK[\\psi] - g V[\\psi]  0 \\iff g  \\frac{K[\\psi]}{V[\\psi]}\n$$\n这启发我们将真实的临界耦合 $g_c(a)$ 定义为动能和势能泛函之比在所有容许函数上的下确界：\n$$\ng_c(a) = \\inf_{\\psi, \\lVert\\psi\\rVert=1} \\frac{K[\\psi]}{V[\\psi]} = \\inf_{\\psi, \\lVert\\psi\\rVert=1} \\frac{\\int |\\nabla\\psi|^2 \\, d^3\\mathbf{r}}{\\int \\frac{e^{-ar}}{r} |\\psi|^2 \\, d^3\\mathbf{r}}\n$$\n根据此定义：\n- 如果 $g > g_c(a)$，那么必定存在一个函数 $\\psi_0$ 使得 $g > \\frac{K[\\psi_0]}{V[\\psi_0]}$，这意味着 $E[\\psi_0;g,a]  0$。由于 $E_0(g,a) \\le E[\\psi_0;g,a]$，基态能量必定为负。\n- 如果 $g \\le g_c(a)$，那么对于所有函数 $\\psi$，$g \\le \\frac{K[\\psi]}{V[\\psi]}$，这意味着 $E[\\psi;g,a] \\ge 0$。由于这对所有 $\\psi$ 都成立，其下确界必定为非负，即 $E_0(g,a) \\ge 0$。\n- 在 $g = g_c(a)$ 时，$E_0(g_c(a),a) = 0$。\n\n临界耦合必须是严格正的，$g_c(a) > 0$。这是因为对于 $\\mathbb{R}^3$ 上任何不是常数的、可归一化的函数 $\\psi$，其动能 $K[\\psi]$ 严格为正（这是 Sobolev 不等式的一个推论）。势能泛函 $V[\\psi]$ 也严格为正。因此，该比值总是正的，其下确界也必须为正。\n\n**第 2 部分：$g_c(a)$ 的构造性变分估计**\n\n我们使用指定的试探函数族 $\\psi_\\alpha(r) = \\mathcal{N}(\\alpha)e^{-\\alpha r}$（其中 $\\alpha  0$）来寻求 $g_c(a)$ 的一个上界。\n\n**1. 归一化**\n对于球对称函数，体积元为 $d^3\\mathbf{r} = 4\\pi r^2 dr$。归一化条件是：\n$$\n\\int_{\\mathbb{R}^3} |\\psi_\\alpha|^2 \\, d^3\\mathbf{r} = \\int_0^\\infty \\mathcal{N}(\\alpha)^2 e^{-2\\alpha r} \\, 4\\pi r^2 dr = 1\n$$\n该积分为标准的 Gamma 函数形式：$\\int_0^\\infty r^n e^{-kx} dx = n!/k^{n+1}$。对于 $n=2$ 和 $k=2\\alpha$：\n$$\n4\\pi \\mathcal{N}(\\alpha)^2 \\left( \\frac{2!}{(2\\alpha)^3} \\right) = 4\\pi \\mathcal{N}(\\alpha)^2 \\left( \\frac{2}{8\\alpha^3} \\right) = \\frac{\\pi \\mathcal{N}(\\alpha)^2}{\\alpha^3} = 1\n$$\n这给出了归一化常数 $\\mathcal{N}(\\alpha) = \\sqrt{\\frac{\\alpha^3}{\\pi}}$。\n\n**2. 动能期望值**\n动能为 $K[\\psi_\\alpha] = \\int |\\nabla\\psi_\\alpha|^2 d^3\\mathbf{r}$。对于一个实值的球对称函数，$|\\nabla \\psi(r)|^2 = (\\frac{d\\psi}{dr})^2$。\n$$\n\\frac{d\\psi_\\alpha}{dr} = \\mathcal{N}(\\alpha) \\frac{d}{dr}(e^{-\\alpha r}) = -\\alpha \\mathcal{N}(\\alpha) e^{-\\alpha r} = -\\alpha \\psi_\\alpha(r)\n$$\n因此，$(\\frac{d\\psi_\\alpha}{dr})^2 = \\alpha^2 \\psi_\\alpha(r)^2$。动能变为：\n$$\nK[\\psi_\\alpha] = \\int \\alpha^2 |\\psi_\\alpha(r)|^2 \\, d^3\\mathbf{r} = \\alpha^2 \\int |\\psi_\\alpha(r)|^2 \\, d^3\\mathbf{r} = \\alpha^2\n$$\n因为 $\\psi_\\alpha$ 是归一化的。\n\n**3. 势能期望值**\n势能为 $V[\\psi_\\alpha] = \\int \\frac{e^{-ar}}{r} |\\psi_\\alpha|^2 d^3\\mathbf{r}$。\n$$\nV[\\psi_\\alpha] = \\int_0^\\infty \\frac{e^{-ar}}{r} \\left(\\frac{\\alpha^3}{\\pi}\\right) e^{-2\\alpha r} \\, 4\\pi r^2 dr = 4\\alpha^3 \\int_0^\\infty r e^{-(a+2\\alpha)r} dr\n$$\n使用 $n=1$ 和 $k=a+2\\alpha$ 的 Gamma 函数积分：\n$$\nV[\\psi_\\alpha] = 4\\alpha^3 \\left( \\frac{1!}{(a+2\\alpha)^2} \\right) = \\frac{4\\alpha^3}{(a+2\\alpha)^2}\n$$\n\n**4. 变分最小化**\n对于我们的试探函数族，能量泛函为：\n$$\nE(\\alpha; g, a) = K[\\psi_\\alpha] - g V[\\psi_\\alpha] = \\alpha^2 - g \\frac{4\\alpha^3}{(a+2\\alpha)^2}\n$$\n基态能量的变分估计为 $E_{var}(g,a) = \\inf_{\\alpha0} E(\\alpha;g,a)$。临界耦合的估计值（我们记为 $\\tilde{g}_c(a)$）是使 $E_{var}(g,a)=0$ 成立的最小 $g$ 值。这发生在函数的最小值等于零时，即要求对于某个最优的 $\\alpha_0  0$，函数及其导数同时为零：\n$$\n(1) \\quad E(\\alpha_0; \\tilde{g}_c, a) = 0 \\quad \\implies \\quad \\alpha_0^2 - \\tilde{g}_c \\frac{4\\alpha_0^3}{(a+2\\alpha_0)^2} = 0\n$$\n$$\n(2) \\quad \\frac{\\partial E}{\\partial \\alpha}\\bigg|_{\\alpha_0} = 0 \\quad \\implies \\quad 2\\alpha_0 - \\tilde{g}_c \\frac{\\partial}{\\partial \\alpha}\\left(\\frac{4\\alpha^3}{(a+2\\alpha)^2}\\right)\\bigg|_{\\alpha_0} = 0\n$$\n由 (1)，假设 $\\alpha_00$：\n$$\n1 = \\tilde{g}_c \\frac{4\\alpha_0}{(a+2\\alpha_0)^2} \\implies \\tilde{g}_c = \\frac{(a+2\\alpha_0)^2}{4\\alpha_0}\n$$\n由 (2)，我们首先计算导数：\n$$\n\\frac{\\partial}{\\partial \\alpha}\\left(\\frac{4\\alpha^3}{(a+2\\alpha)^2}\\right) = \\frac{12\\alpha^2(a+2\\alpha)^2 - 4\\alpha^3 \\cdot 2(a+2\\alpha) \\cdot 2}{(a+2\\alpha)^4} = \\frac{4\\alpha^2(3a+2\\alpha)}{(a+2\\alpha)^3}\n$$\n将此代入 (2) 并假设 $\\alpha_00$：\n$$\n2\\alpha_0 = \\tilde{g}_c \\frac{4\\alpha_0^2(3a+2\\alpha_0)}{(a+2\\alpha_0)^3} \\implies 1 = \\tilde{g}_c \\frac{2\\alpha_0(3a+2\\alpha_0)}{(a+2\\alpha_0)^3} \\implies \\tilde{g}_c = \\frac{(a+2\\alpha_0)^3}{2\\alpha_0(3a+2\\alpha_0)}\n$$\n令 $\\tilde{g}_c$ 的两个表达式相等：\n$$\n\\frac{(a+2\\alpha_0)^2}{4\\alpha_0} = \\frac{(a+2\\alpha_0)^3}{2\\alpha_0(3a+2\\alpha_0)}\n$$\n由于 $a0, \\alpha_00$，我们可以通过约去公因子来简化：\n$$\n\\frac{1}{2} = \\frac{a+2\\alpha_0}{3a+2\\alpha_0} \\implies 3a+2\\alpha_0 = 2(a+2\\alpha_0) = 2a+4\\alpha_0 \\implies a = 2\\alpha_0\n$$\n最优变分参数为 $\\alpha_0 = a/2$。\n\n**第 3 部分：用于实现的最终公式**\n将 $\\alpha_0 = a/2$ 代回 $\\tilde{g}_c(a)$ 的表达式中：\n$$\n\\tilde{g}_c(a) = \\frac{(a+2(a/2))^2}{4(a/2)} = \\frac{(a+a)^2}{2a} = \\frac{(2a)^2}{2a} = \\frac{4a^2}{2a} = 2a\n$$\n这个解析结果 $\\tilde{g}_c(a) = 2a$ 是真实临界耦合 $g_c(a)$ 的变分上界。程序将对测试集中的每个 $a$ 值实现这个简单的公式。\n\n对于给定的测试用例：\n- $a = 0.1 \\implies \\tilde{g}_c(0.1) = 2(0.1) = 0.2$\n- $a = 1.0 \\implies \\tilde{g}_c(1.0) = 2(1.0) = 2.0$\n- $a = 5.0 \\implies \\tilde{g}_c(5.0) = 2(5.0) = 10.0$\n- $a = 0.001 \\implies \\tilde{g}_c(0.001) = 2(0.001) = 0.002$\n\n实现将计算这些值并按要求格式化它们。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the variational upper bound for the critical coupling g_c(a)\n    for the Yukawa potential using an exponential trial wavefunction.\n    \"\"\"\n    # Define the test cases for the screening parameter 'a' from the problem statement.\n    test_cases = [0.1, 1.0, 5.0, 0.001]\n\n    results = []\n    for a in test_cases:\n        # The analytical result from the Rayleigh-Ritz variational principle with the\n        # trial function family psi_alpha(r) = N * exp(-alpha*r) is that the\n        # estimated critical coupling g_c(a) is exactly 2*a.\n        # This is an upper bound to the true critical coupling.\n        g_c_estimate = 2.0 * a\n        \n        # The problem requires the output to be a floating-point number\n        # rounded to ten decimal places.\n        results.append(f\"{g_c_estimate:.10f}\")\n\n    # Final print statement in the exact required format: [g1,g2,g3,g4]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "虽然变分法为我们提供了一个有用的估计，但计算物理学使我们能够找到更精确的答案。本练习将带领你从一个近似的解析解法，迈向一个精确的数值解法。你将学习如何将连续的薛定谔方程转化为离散的矩阵问题，并通过一种高效的数值技巧——计算矩阵$LDL^T$分解中的负主元数量来判断束缚态是否存在，从而避免了耗时的完全对角化。结合二分法搜索，你将能够精确定位临界耦合常数$g_c(\\mu)$，这充分展示了现代计算方法在解决物理问题时的强大能力与精妙之处 。",
            "id": "3609098",
            "problem": "考虑一个双体非相对论束缚态问题，采用自然单位制，其中普朗克常数除以 $2\\pi$（即 $\\hbar$）和两倍的约化质量满足 $\\hbar^2/(2m)=1$。s波（角动量量子数 $l=0$）径向 Schrödinger 算符定义在区间 $r\\in[0,R_{\\max}]$ 上，并采用 Dirichlet 边界条件 $u(0)=0$ 和 $u(R_{\\max})=0$。相互作用为 Yukawa 势 $V(r)=-g\\,\\mathrm{e}^{-\\mu r}/r$，其中 $g$ 是耦合常数，$\\mu0$ 是屏蔽参数。当哈密顿算符的最低本征值 $E_b$ 满足 $E_b  0$ 时，束缚态出现。对于固定的 $\\mu$，临界耦合常数 $g_c(\\mu)$ 是存在束缚态的最小 $g$ 值，等价于哈密顿算符至少有一个负本征值的最小 $g$ 值。\n\n从径向 Schrödinger 方程和基本定义出发，推导一个计算程序来定位 $g_c(\\mu)$。该程序通过在基态能量趋近于 $0^-$ 的位置对 $g$ 进行区间限定，并使用单调谓词将结果精化到指定的容差。使用二阶中心差分格式，在均匀网格 $r_i=i\\,h$（$i=0,1,\\dots,N+1$）上对算符 $-d^2/dr^2 + V(r)$ 进行离散化，其中 $h$ 是步长，$N$ 是内部点数。施加边界条件 $u(0)=0$ 和 $u(R_{\\max})=0$。为确保所有测试案例的一致性，请使用以下定义域和分辨率规则：\n- 径向截断半径必须为 $R_{\\max}=\\min(200,\\,60/\\mu)$。\n- 均匀步长必须为 $h=0.02$。\n- 内部点数必须为 $N=\\lfloor R_{\\max}/h\\rfloor - 1$，且对于所有测试案例，该值必须为严格正数。\n\n在不计算本征向量的情况下，构建一个可靠的方法来判断离散化的哈密顿算符是否至少有一个负本征值。基于移位三对角矩阵在 $\\lambda=0$ 时的惯性指数（负主元的数量），使用一个有数学依据的测试来判断对于给定的 $g$ 是否有 $E_b  0$。利用最低本征值在 $g$ 上的单调性，采用区间套分加二分法策略，将 $g_c(\\mu)$ 的计算精确到 $10^{-6}$ 的绝对容差（在相同的自然单位制下）。\n\n您的程序必须实现此过程，并为以下屏蔽参数测试套件评估 $g_c(\\mu)$：\n- $\\mu=0.1$（近库仑区），\n- $\\mu=0.5$（中等程），\n- $\\mu=1.0$（基准），\n- $\\mu=2.0$（短程）。\n\n在所选的自然单位制中，所有量都是无量纲的。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[g_{c,1},g_{c,2},g_{c,3},g_{c,4}]$），其中每个条目是对应测试案例计算出的 $g_c(\\mu)$，四舍五入到六位小数。输出必须是浮点数。该方法必须是自包含的，且不应需要任何外部输入文件。",
            "solution": "该问题要求计算 Yukawa 势 $V(r) = -g \\, \\mathrm{e}^{-\\mu r}/r$ 在几个不同屏蔽参数 $\\mu$ 值下的临界耦合常数 $g_c(\\mu)$。临界耦合常数定义为存在束缚态所需的最小 $g$ 值。在不含时 Schrödinger 方程的背景下，这对应于哈密顿算符的最低能量本征值 $E_b$ 变为非正值，即 $E_b \\leq 0$。我们寻求使 $E_b = 0$ 的特定 $g$ 值。\n\n该物理系统由 s波（$l=0$）径向 Schrödinger 方程描述，其波函数为 $u(r)$，定义在区间 $r \\in [0, R_{\\max}]$ 上，并采用 Dirichlet 边界条件 $u(0)=0$ 和 $u(R_{\\max})=0$。在给定的自然单位制（其中 $\\hbar^2/(2m)=1$）下，方程为：\n$$\n\\left( -\\frac{d^2}{dr^2} + V(r) \\right) u(r) = E u(r)\n$$\n这是一个针对一维哈密顿算符 $H = -d^2/dr^2 + V(r)$ 的本征值问题。\n\n为了用计算方法解决这个问题，我们在一个均匀网格上对算符进行离散化。径向定义域 $[0, R_{\\max}]$ 被划分为 $N+1$ 个等步长 $h$ 的段。网格点为 $r_i = i \\cdot h$（$i=0, 1, \\dots, N+1$），其中 $R_{\\max} = (N+1)h$。在这些点上的波函数记为 $u_i = u(r_i)$。边界条件意味着 $u_0 = 0$ 和 $u_{N+1} = 0$。\n\n二阶导数 $d^2/dr^2$ 在每个内部网格点 $r_i$（$i=1, \\dots, N$）处使用二阶中心差分公式近似：\n$$\n\\frac{d^2u}{dr^2}\\bigg|_{r=r_i} \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\n将此式代入 Schrödinger 方程，得到一个线性方程组：\n$$\n-\\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + V(r_i)u_i = E u_i, \\quad \\text{for } i=1, \\dots, N\n$$\n这可以重写为矩阵本征值方程 $H\\mathbf{u} = E\\mathbf{u}$，其中 $\\mathbf{u} = [u_1, u_2, \\dots, u_N]^T$ 是内部点上波函数的向量。矩阵 $H$ 是一个 $N \\times N$ 的实对称三对角矩阵，其元素为：\n$$\nH_{ij} =\n\\begin{cases}\n\\frac{2}{h^2} + V(r_i)  \\text{if } i=j \\\\\n-\\frac{1}{h^2}  \\text{if } |i-j|=1 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n其中 $V(r_i) = -g \\, \\mathrm{e}^{-\\mu r_i}/r_i$。\n\n寻找临界耦合常数 $g_c(\\mu)$ 的问题现在转化为寻找使矩阵 $H$ 的最低本征值为零的 $g$ 值。如果 $H$ 至少有一个负本征值，则存在束缚态。最低本征值 $E_b(g)$ 是耦合常数 $g$ 的单调递减函数。这意味着对于 $g  g_c(\\mu)$，$H$ 的所有本征值均为正（$H$ 是正定的），而对于 $g  g_c(\\mu)$，至少有一个本征值为负。\n\n为了在不进行完全对角化这种高计算成本操作的情况下确定给定 $g$ 时 $H$ 是否有负本征值，我们采用一种基于 Sylvester 惯性定理的方法。该定理指出，实对称矩阵的惯性指数（正、负、零本征值的数量）在合同变换下保持不变。$LDL^T$ 分解就是这样一种变换，其中 $L$ 是一个单位下三角矩阵，$D$ 是一个对角矩阵。$H$ 的负本征值数量等于 $D$ 中负对角元素（主元）的数量。\n\n对于像 $H$ 这样的三对角矩阵，$D$ 矩阵的主元 $d_i$ 可以通过以下递推关系高效计算：\n$$\nd_1 = H_{11}\n$$\n$$\nd_i = H_{ii} - \\frac{H_{i-1, i}^2}{d_{i-1}}, \\quad \\text{for } i=2, \\dots, N\n$$\n其中的项为 $H_{ii} = \\frac{2}{h^2} - g \\frac{e^{-\\mu r_i}}{r_i}$ 和 $H_{i-1, i} = -\\frac{1}{h^2}$。此过程的计算成本与矩阵大小成线性关系，即 $O(N)$，效率非常高。因此，我们可以创建一个谓词函数 `has_negative_eigenvalue(g)`，如果负主元 $d_i$ 的数量大于零，则返回 true，否则返回 false。\n\n有了这个谓词函数，我们可以使用二分（二元搜索）算法来寻找 $g_c(\\mu)$。搜索过程作用于耦合常数 $g$：\n1.  **区间限定**：建立一个包含 $g_c(\\mu)$ 的区间 $[g_{low}, g_{high}]$。我们知道 $g=0$ 时没有势，此时箱中粒子的哈密顿算符只有正本征值。因此，可以设置 $g_{low}=0$。选择一个 $g_{high}$ 的初始猜测值（例如 $g=0.1$），并将其重复加倍，直到 `has_negative_eigenvalue(g_high)` 返回 true。这确保了 $g_c(\\mu)$ 包含在最终的区间内。\n2.  **二分**：迭代地将区间减半。在每一步中，测试中点 $g_{mid} = (g_{low} + g_{high})/2$。如果 `has_negative_eigenvalue(g_mid)` 为 true，意味着 $g_{mid}$ 是一个新的、更紧的上界，因此我们设置 $g_{high} = g_{mid}$。否则，$g_{mid}$ 是一个新的下界，我们设置 $g_{low} = g_{mid}$。\n3.  **终止**：当区间宽度 $g_{high} - g_{low}$ 小于指定的绝对容差 $10^{-6}$ 时，过程终止。$g_c(\\mu)$ 的最终估计值是最终区间的中点。\n\n这种结合了有限差分、矩阵惯性指数分析和二分搜索的方法，为确定给定测试案例的临界耦合常数提供了一个稳健且计算高效的程序。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the critical coupling g_c(mu) for the Yukawa potential\n    for a given set of screening parameters mu.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [0.1, 0.5, 1.0, 2.0]\n    results = []\n\n    # Absolute tolerance for the bisection search.\n    TOLERANCE = 1e-6\n\n    for mu in test_cases:\n        # 1. Setup grid parameters according to the problem statement.\n        R_max = min(200.0, 60.0 / mu)\n        h = 0.02\n        \n        # N is the number of interior grid points.\n        # The grid runs from i=0 to N+1, with u(0)=u(N+1)=0.\n        # R_max = (N+1)*h -> N = R_max/h - 1.\n        N = int(R_max / h) - 1\n\n        if N = 0:\n            raise ValueError(f\"Grid size N must be positive, but got N={N} for mu={mu}.\")\n\n        # Grid points for the interior of the domain, r_i = i*h for i=1,...,N.\n        r = np.arange(1, N + 1) * h\n        \n        # Pre-calculate constants for efficiency.\n        h_sq = h * h\n        \n        # The off-diagonal elements of the Hamiltonian matrix are -1/h^2.\n        # The recurrence for LDL^T pivots uses the square of this term.\n        offdiag_sq = (1.0 / h_sq)**2\n\n        # 2. Define the predicate function for the bisection search.\n        def has_negative_eigenvalue(g: float) -> bool:\n            \"\"\"\n            Checks if the Hamiltonian matrix for a given coupling 'g' has\n            at least one negative eigenvalue. This is done by counting\n            the number of negative pivots in its LDL^T decomposition.\n            \"\"\"\n            # Calculate the diagonal of the Hamiltonian matrix H.\n            potential_term = -g * np.exp(-mu * r) / r\n            H_diag = 2.0 / h_sq + potential_term\n            \n            # Count negative pivots using the LDL^T recurrence.\n            neg_pivot_count = 0\n            \n            # First pivot d_1 = H_11\n            d = H_diag[0]\n            if d  0:\n                neg_pivot_count += 1\n            \n            # The standard algorithm can fail if a pivot is exactly zero.\n            # This is physically not expected for g != g_c, as the leading\n            # principal submatrices correspond to smaller systems which bind less\n            # easily. If d becomes zero, our check will rely on subsequent\n            # floating point behavior (e.g., d becomes -inf), which correctly\n            # signals a problem. A small perturbation can also work, but we\n            # proceed assuming standard float arithmetic is sufficient.\n            if d == 0.0:\n                d = 1e-99 # Avoid ZeroDivisionError\n\n            for i in range(1, N):\n                # Recurrence: d_i = H_ii - (H_{i-1,i})^2 / d_{i-1}\n                d = H_diag[i] - offdiag_sq / d\n                if d  0:\n                    neg_pivot_count += 1\n                if d == 0.0:\n                    d = 1e-99 # Avoid ZeroDivisionError in the next step\n\n            return neg_pivot_count > 0\n\n        # 3. Find an initial bracketing interval [g_low, g_high] for g_c.\n        g_low = 0.0  # At g=0, V=0, no bound state, so this is a safe lower bound.\n        \n        # Start with a guess and expand the bracket until a bound state is found.\n        g_high = 0.1 \n        while not has_negative_eigenvalue(g_high):\n            g_high *= 2.0\n\n        # 4. Use bisection to find g_c within the specified tolerance.\n        while (g_high - g_low) > TOLERANCE:\n            g_mid = g_low + (g_high - g_low) / 2.0\n            # If g_mid is indistinguishable from the bounds, stop.\n            if g_mid == g_low or g_mid == g_high:\n                break\n                \n            if has_negative_eigenvalue(g_mid):\n                # A bound state exists, so g_mid is an upper bound for g_c.\n                g_high = g_mid\n            else:\n                # No bound state, so g_mid is a lower bound for g_c.\n                g_low = g_mid\n\n        # The critical coupling is the midpoint of the final interval.\n        g_c = (g_low + g_high) / 2.0\n        results.append(g_c)\n\n    # 5. Format and print the results as required.\n    # The problem specifies rounding to six decimal places, and floats.\n    # The f-string format achieves this.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个理论模型若要具有物理意义，其参数必须与实验可观测量相联系。本练习将为你搭建这座桥梁。你将运用散射理论的基石——玻恩近似，推导出一个关键关系，它将汤川势的耦合强度$g$与可在实验中测量的低能$s$波散射长度$a_s$直接联系起来。通过这个练习，你不仅能学会如何将理论模型与真实世界的测量数据相结合，还将掌握在物理计算中进行单位转换以确保量纲一致性的重要技能 。",
            "id": "3609024",
            "problem": "在一个低能核子-核子散射的计算核物理模型中，相互作用由交换一个标量玻色子产生的汤川势近似。在自然单位制（其中 $\\hbar = c = 1$）中，该势为\n$$\nV(r) \\;=\\; -\\,\\frac{g^{2}}{4\\pi}\\,\\frac{\\exp(-m_{b}\\,r)}{r},\n$$\n其中 $g$ 是一个无量纲耦合常数，$m_{b}$ 是玻色子质量。考虑在非相对论性范围内，两个质量为 $m_{N}$ 的相同核子发生的弹性散射。约化质量为 $\\mu_{\\text{red}} = m_{N}/2$。一次低能测量给出的s波散射长度为 $a_{s} = -\\,5.000\\,\\text{fm}$。仅使用基本的非相对论性势散射理论（线性化的 Lippmann–Schwinger 方程，即一阶玻恩近似，以及零动量下的散射长度定义），推导无量纲耦合 $g^{2}/(4\\pi)$ 关于 $a_{s}$、$m_{b}$ 和 $m_{N}$ 的解析表达式，并包括所有必要的单位转换以确保量纲一致性。然后，对以下数值计算该表达式：\n- $m_{b} = 138.0\\,\\text{MeV}$，\n- $m_{N} = 939.0\\,\\text{MeV}$，\n- $\\hbar c = 197.3269804\\,\\text{MeV}\\cdot\\text{fm}$。\n将最终结果表示为一个纯数，并将答案四舍五入到四位有效数字。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n- **势的形式（自然单位制，$\\hbar = c = 1$）**：$V(r) = -\\frac{g^{2}}{4\\pi}\\,\\frac{\\exp(-m_{b}\\,r)}{r}$\n- **耦合**：$g$ 是一个无量纲耦合常数。\n- **散射过程**：两个相同核子的弹性散射。\n- **核子质量**：$m_{N}$\n- **范围**：非相对论性。\n- **约化质量**：$\\mu_{\\text{red}} = m_{N}/2$。\n- **实验数据**：s波散射长度 $a_{s} = -5.000\\,\\text{fm}$。\n- **理论框架**：一阶玻恩近似（线性化的 Lippmann–Schwinger 方程）和零动量下的散射长度定义。\n- **任务**：\n    1. 推导无量纲耦合 $g^{2}/(4\\pi)$ 关于 $a_{s}$、$m_{b}$ 和 $m_{N}$ 的解析表达式。\n    2. 对该表达式进行数值计算。\n- **数值**：\n    - $m_{b} = 138.0\\,\\text{MeV}$\n    - $m_{N} = 939.0\\,\\text{MeV}$\n    - $\\hbar c = 197.3269804\\,\\text{MeV}\\cdot\\text{fm}$\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题使用汤川势描述核子-核子散射，这是核物理学中一个标准且具有重要历史意义的模型。所引用的理论框架（玻恩近似、散射长度）是非相对论性量子散射理论的基础。所有概念都是公认的。\n- **适定性**：问题提供了足够的信息来推导耦合的唯一表达式并进行计算。输入数据是一致的，可以得出一个唯一的、稳定的数值答案。\n- **客观性**：问题以精确、定量的语言陈述，没有主观论断。\n- **完备性与一致性**：所提供的质量、散射长度和 $\\hbar c$ 的数据是自洽的，足以完成任务。为势的定义使用“自然单位制”是物理学中的标准惯例，其在有量纲常数的背景下的解释是明确的。\n- **真实性**：核子质量、π介子质量（玻色子质量 $m_b$ 接近π介子质量）和散射长度的数值对于低能核子-核子相互作用是符合物理实际的。\n\n### 步骤 3：结论与行动\n问题有效。这是一个适定的、有科学依据的量子散射理论问题。我将继续进行解答。\n\n---\n\n## 解题推导\n\n本题要求在一阶玻恩近似下，从散射长度 $a_s$ 推导出无量纲耦合常数 $g^2/(4\\pi)$。\n\ns波散射长度 $a_s$ 定义为散射振幅 $f(\\theta, \\phi)$ 在零能量极限（$k \\to 0$）下的负值：\n$$ a_s = -\\lim_{k\\to 0} f(\\theta, \\phi) $$\n在一阶玻恩近似中，一个约化质量为 $\\mu_{\\text{red}}$ 的粒子在中心势 $V(r)$ 中的散射振幅由下式给出：\n$$ f_B(\\mathbf{q}) = -\\frac{\\mu_{\\text{red}}}{2\\pi\\hbar^2} \\int V(r) \\exp(-i\\mathbf{q}\\cdot\\mathbf{r}/\\hbar) d^3r $$\n其中 $\\mathbf{q}$ 是动量转移。在零能量极限下，动量转移 $\\mathbf{q} \\to \\mathbf{0}$。因此，一阶玻恩近似下的散射长度为：\n$$ a_s = -f_B(q=0) = \\frac{\\mu_{\\text{red}}}{2\\pi\\hbar^2} \\int V(r) d^3r $$\n问题中给出的势是在自然单位制（$\\hbar=c=1$）下的形式 $V(r) = -\\frac{g^2}{4\\pi} \\frac{\\exp(-m_b r)}{r}$。为了使用标准物理单位，我们必须恢复因子 $\\hbar$ 和 $c$。势必须具有能量的量纲。无量纲耦合为 $\\alpha = g^2/(4\\pi)$。指数的宗量 $m_b r$ 必须是无量纲的。这要求其形式为 $m_b c r / \\hbar$。为确保整个表达式的单位是能量，势必须写成：\n$$ V(r) = -\\frac{g^2}{4\\pi} (\\hbar c) \\frac{\\exp(-m_b c r / \\hbar)}{r} $$\n现在，我们计算这个势的空间积分。由于 $V(r)$ 是球对称的，体积积分变为：\n$$ \\int V(r) d^3r = \\int_0^{2\\pi} d\\phi \\int_0^{\\pi} \\sin\\theta d\\theta \\int_0^{\\infty} r^2 V(r) dr = 4\\pi \\int_0^{\\infty} r^2 V(r) dr $$\n代入 $V(r)$ 的表达式：\n$$ \\int V(r) d^3r = 4\\pi \\int_0^{\\infty} r^2 \\left( -\\frac{g^2}{4\\pi} (\\hbar c) \\frac{\\exp(-m_b c r / \\hbar)}{r} \\right) dr $$\n$$ \\int V(r) d^3r = - \\frac{g^2}{4\\pi} (4\\pi \\hbar c) \\int_0^{\\infty} r \\exp\\left(-\\frac{m_b c}{\\hbar} r\\right) dr $$\n令指数中的常数为 $A = m_b c / \\hbar$。该积分的形式为 $\\int_0^{\\infty} x e^{-Ax} dx$，其值为 $1/A^2$。\n$$ \\int_0^{\\infty} r \\exp\\left(-\\frac{m_b c}{\\hbar} r\\right) dr = \\frac{1}{(m_b c / \\hbar)^2} = \\left(\\frac{\\hbar}{m_b c}\\right)^2 $$\n将此结果代回势的体积积分表达式中：\n$$ \\int V(r) d^3r = - g^2 (\\hbar c) \\left(\\frac{\\hbar}{m_b c}\\right)^2 = - g^2 \\frac{\\hbar^3 c}{m_b^2 c^2} = - g^2 \\frac{\\hbar^3}{m_b^2 c} $$\n现在我们将此代入 $a_s$ 的玻恩近似公式中：\n$$ a_s = \\frac{\\mu_{\\text{red}}}{2\\pi\\hbar^2} \\left( - g^2 \\frac{\\hbar^3}{m_b^2 c} \\right) = - \\frac{g^2 \\mu_{\\text{red}} \\hbar}{2\\pi m_b^2 c} $$\n我们已知约化质量为 $\\mu_{\\text{red}} = m_N/2$。代入此式：\n$$ a_s = - \\frac{g^2 (m_N/2) \\hbar}{2\\pi m_b^2 c} = - \\frac{g^2 m_N \\hbar}{4\\pi m_b^2 c} $$\n我们想求无量纲耦合 $g^2/(4\\pi)$。整理方程：\n$$ \\frac{g^2}{4\\pi} = - a_s \\frac{m_b^2 c}{m_N \\hbar} $$\n为了方便使用给定值（其中质量以 MeV 为单位，即能量 $E$ 的单位）进行数值计算，我们可以将质量表示为 $m = E/c^2$。通过在分子和分母上乘以 $c$，该表达式可以更方便地写为：\n$$ \\frac{g^2}{4\\pi} = - a_s \\frac{(m_b c^2)^2/c^2 \\cdot c}{(m_N c^2)/c^2 \\cdot \\hbar} = - a_s \\frac{(m_b c^2)^2}{ (m_N c^2) (\\hbar c)} $$\n这就是所要求的无量纲耦合 $g^2/(4\\pi)$ 关于 $a_s$、质量的能量等效值（$m_b c^2$，$m_N c^2$）和基本常数 $\\hbar c$ 的解析表达式。\n\n## 数值计算\n\n我们已知以下数值：\n- $a_s = -5.000\\,\\text{fm}$\n- $m_b c^2 = 138.0\\,\\text{MeV}$ (因为 $m_b=138.0$ MeV 意味着 $m_b c^2=138.0$ MeV)\n- $m_N c^2 = 939.0\\,\\text{MeV}$ (因为 $m_N=939.0$ MeV 意味着 $m_N c^2=939.0$ MeV)\n- $\\hbar c = 197.3269804\\,\\text{MeV}\\cdot\\text{fm}$\n\n将这些数值代入推导出的表达式中：\n$$ \\frac{g^2}{4\\pi} = - (-5.000\\,\\text{fm}) \\frac{(138.0\\,\\text{MeV})^2}{(939.0\\,\\text{MeV}) (197.3269804\\,\\text{MeV}\\cdot\\text{fm})} $$\n$$ \\frac{g^2}{4\\pi} = (5.000\\,\\text{fm}) \\frac{19044\\,\\text{MeV}^2}{185289.0346\\,\\text{MeV}^2 \\cdot \\text{fm}} $$\n单位 $\\text{fm} \\cdot \\text{MeV}^2$ 在分子和分母中相互抵消，留下一个预期的无量纲结果。\n$$ \\frac{g^2}{4\\pi} = \\frac{5.000 \\times 19044}{185289.0346} = \\frac{95220}{185289.0346} \\approx 0.5138936 $$\n将结果四舍五入到四位有效数字，我们得到 $0.5139$。",
            "answer": "$$\n\\boxed{0.5139}\n$$"
        }
    ]
}