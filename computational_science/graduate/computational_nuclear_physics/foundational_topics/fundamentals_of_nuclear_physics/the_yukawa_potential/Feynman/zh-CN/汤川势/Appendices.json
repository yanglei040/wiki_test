{
    "hands_on_practices": [
        {
            "introduction": "并非所有形式的吸引势都能束缚粒子；势的强度和作用范围必须足够大才能形成束缚态。本练习将运用量子力学中强大的变分原理，通过一个简单的试探波函数，推导出一个解析估计，确定形成s波束缚态所需的临界耦合强度。这项实践旨在揭示动能与势能之间的相互制衡关系，这是理解束缚态形成与否的核心物理机制。",
            "id": "3609068",
            "problem": "考虑三维非相对论性薛定谔算符，对于球对称汤川势，其无量纲形式为\n$$\nH_g = -\\nabla^2 - g \\,\\frac{e^{-a r}}{r},\n$$\n作用于 $\\mathbb{R}^3$ 上的平方可积波函数，其中 $r = \\lVert \\mathbf{r}\\rVert$，耦合强度 $g \\ge 0$ 和屏蔽参数 $a > 0$ 均为无量纲量，且动能前因子已被标度为 $\\hbar^2/(2m)=1$。我们关注 s-波（$\\ell=0$）态，其波函数是球对称的，即 $\\psi(\\mathbf{r})=\\psi(r)$。\n\n你的任务是：\n\n1. 仅使用瑞利-里兹变分原理和球坐标下拉普拉斯算子的基本性质，证明存在一个临界耦合 $g_c(a) > 0$，使得当 $g > g_c(a)$ 时，$H_g$ 的基态能量为负；当 $g  g_c(a)$ 时，基态能量为非负。你的推理必须从以下定义出发：对于任意归一化的试探函数 $\\psi$，\n$$\nE[\\psi;g,a] = \\int_{\\mathbb{R}^3} \\psi(\\mathbf{r}) \\left( -\\nabla^2 \\right) \\psi(\\mathbf{r}) \\, d^3\\mathbf{r} \\; - \\; g \\int_{\\mathbb{R}^3} \\frac{e^{-a r}}{r} \\, \\lvert \\psi(\\mathbf{r}) \\rvert^2 \\, d^3\\mathbf{r}\n$$\n是基态能量的一个上界，并且 s-波试探函数可以取为实数且非负。不要假设任何关于汤川势的预计算公式；所有必要的表达式都必须从这些原理推导出来。\n\n2. 概述一个构造性的变分证明，通过考虑一个单参数的归一化 s-波试探函数族\n$$\n\\psi_{\\alpha}(r) = \\mathcal{N}(\\alpha)\\, e^{-\\alpha r}, \\quad \\alpha > 0,\n$$\n得出一个 $g_c(a)$ 的可计算上界，其中归一化常数 $\\mathcal{N}(\\alpha)$ 的选择需满足 $\\int_{\\mathbb{R}^3} \\lvert \\psi_\\alpha(\\mathbf{r}) \\rvert^2 d^3\\mathbf{r} = 1$。定义瑞利商\n$$\nE(\\alpha; g, a) = \\int_{\\mathbb{R}^3} \\left\\lvert \\nabla \\psi_\\alpha(\\mathbf{r}) \\right\\rvert^2 \\, d^3\\mathbf{r} \\; - \\; g \\int_{\\mathbb{R}^3} \\frac{e^{-a r}}{r} \\, \\lvert \\psi_\\alpha(\\mathbf{r}) \\rvert^2 \\, d^3\\mathbf{r}.\n$$\n证明基态能量的变分估计为 $\\inf_{\\alpha>0} E(\\alpha; g,a)$，并论证临界耦合估计 $g_c(a)$ 是使 $\\inf_{\\alpha>0} E(\\alpha; g,a) = 0$ 成立的最小 $g$ 值。通过在临界阈值处应用欧拉-拉格朗日条件，即最小化参数 $\\alpha$ 同时满足 $E(\\alpha; g, a) = 0$ 和 $\\partial E(\\alpha; g, a)/\\partial \\alpha = 0$，将此估计的计算简化为一个关于 $\\alpha$ 的显式一维最小化问题。\n\n3. 实现一个程序，对指数试探函数族执行此变分计算，计算由此产生的 $g_c(a)$ 的上界估计，并将其应用于以下屏蔽参数测试集：\n- $a = 0.1$ （一般情况），\n- $a = 1.0$ （一般情况），\n- $a = 5.0$ （强屏蔽），\n- $a = 0.001$ （近库仑极限）。\n所有量均为无量纲。你的程序必须输出这些 $a$ 值对应的估计临界耦合，结果为浮点数，并四舍五入到十位小数。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，顺序与上述测试集一致。例如，格式必须严格为\n$$\n[\\text{g1},\\text{g2},\\text{g3},\\text{g4}]\n$$\n其中每个 $\\text{gk}$ 是一个四舍五入到十位小数的十进制数（无单位）。",
            "solution": "在尝试任何解决方案之前，会对用户提供的问题进行验证。\n\n### 步骤 1：提取已知条件\n-   **哈密顿量**: 三维非相对论性薛定谔算符对于球对称汤川势的无量纲形式为 $H_g = -\\nabla^2 - g \\,\\frac{e^{-a r}}{r}$。\n-   **作用域**: 该算符作用于 $\\mathbb{R}^3$ 上的平方可积波函数。\n-   **参数**: $r = \\lVert \\mathbf{r}\\rVert$, $g \\ge 0$ 是耦合强度, $a > 0$ 是屏蔽参数。所有量均为无量纲。\n-   **标度**: 动能前因子被标度为 $\\hbar^2/(2m)=1$。\n-   **态类型**: 分析集中于 s-波（$\\ell=0$）态，其波函数是球对称的，即 $\\psi(\\mathbf{r})=\\psi(r)$。\n-   **变分原理**: 对于任何归一化的试探函数 $\\psi$，能量泛函 $E[\\psi;g,a] = \\int_{\\mathbb{R}^3} \\psi(\\mathbf{r}) \\left( -\\nabla^2 \\right) \\psi(\\mathbf{r}) \\, d^3\\mathbf{r} \\; - \\; g \\int_{\\mathbb{R}^3} \\frac{e^{-a r}}{r} \\, \\lvert \\psi(\\mathbf{r}) \\rvert^2 \\, d^3\\mathbf{r}$ 提供了基态能量的一个上界。对于 s-波态，可以假定 $\\psi$ 是实数且非负的。\n-   **备选能量泛函**: $E(\\alpha; g, a) = \\int_{\\mathbb{R}^3} \\left\\lvert \\nabla \\psi_\\alpha(\\mathbf{r}) \\right\\rvert^2 \\, d^3\\mathbf{r} \\; - \\; g \\int_{\\mathbb{R}^3} \\frac{e^{-a r}}{r} \\, \\lvert \\psi_\\alpha(\\mathbf{r}) \\rvert^2 \\, d^3\\mathbf{r}$。\n-   **试探函数族**: 为了进行构造性证明，提供了一个特定的单参数 s-波试探函数族：对于 $\\alpha > 0$，有 $\\psi_{\\alpha}(r) = \\mathcal{N}(\\alpha)\\, e^{-\\alpha r}$。\n-   **归一化**: $\\int_{\\mathbb{R}^3} \\lvert \\psi_\\alpha(\\mathbf{r}) \\rvert^2 d^3\\mathbf{r} = 1$。\n-   **任务**: 计算屏蔽参数测试集 $a \\in \\{0.1, 1.0, 5.0, 0.001\\}$ 的临界耦合 $g_c(a)$ 的一个上界。\n-   **输出格式**: 单行 `[g1,g2,g3,g4]`，值为四舍五入到十位小数的浮点数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于薛定谔方程的标准量子力学处理方法以及瑞利-里兹变分原理的应用。汤川势是核物理和粒子物理中的一个基本模型。问题是适定的，提供了明确的目标和通向解决方案的构造性路径。所提供的信息是自洽且一致的；对于在无穷远处消失的实值波函数，通过格林第一恒等式，两种能量泛函的表达式是等价的。语言客观且数学上精确。未发现任何缺陷。\n\n### 步骤 3：结论与操作\n问题有效。将提供完整解决方案。\n\n### 解决方案\n解决方案按要求分为三部分呈现，详细说明了临界耦合的存在性、通过构造性变分证明对其进行的估计，以及用于实现的公式推导。\n\n**第 1 部分：临界耦合的存在性**\n\n哈密顿量 $H_g$ 的基态能量 $E_0(g,a)$ 由瑞利-里兹泛函在所有归一化函数 $\\psi$ 上的下确界给出：\n$$\nE_0(g,a) = \\inf_{\\psi, \\lVert\\psi\\rVert=1} E[\\psi;g,a]\n$$\n泛函 $E[\\psi;g,a]$ 可以分为动能部分和势能部分：\n$$\nE[\\psi;g,a] = K[\\psi] - g V[\\psi]\n$$\n其中 $K[\\psi] = \\int_{\\mathbb{R}^3} |\\nabla\\psi|^2 \\, d^3\\mathbf{r}$ 且 $V[\\psi] = \\int_{\\mathbb{R}^3} \\frac{e^{-ar}}{r} |\\psi|^2 \\, d^3\\mathbf{r}$。对于任何非零、可归一化的函数 $\\psi$，$K[\\psi]$ 和 $V[\\psi]$ 均为正值。\n\n当且仅当基态能量为负（$E_0(g,a)  0$）时，存在束缚态。根据变分原理，如果存在至少一个试探函数 $\\psi$ 使得 $E[\\psi;g,a]  0$，则此条件成立。该不等式可以重排为：\n$$\nK[\\psi] - g V[\\psi]  0 \\iff g > \\frac{K[\\psi]}{V[\\psi]}\n$$\n这启发我们将真实的临界耦合 $g_c(a)$ 定义为动能泛函与势能泛函之比在所有容许函数上的下确界：\n$$\ng_c(a) = \\inf_{\\psi, \\lVert\\psi\\rVert=1} \\frac{K[\\psi]}{V[\\psi]} = \\inf_{\\psi, \\lVert\\psi\\rVert=1} \\frac{\\int |\\nabla\\psi|^2 \\, d^3\\mathbf{r}}{\\int \\frac{e^{-ar}}{r} |\\psi|^2 \\, d^3\\mathbf{r}}\n$$\n根据此定义：\n-   如果 $g > g_c(a)$，那么必定存在一个函数 $\\psi_0$ 使得 $g > \\frac{K[\\psi_0]}{V[\\psi_0]}$，这意味着 $E[\\psi_0;g,a]  0$。由于 $E_0(g,a) \\le E[\\psi_0;g,a]$，基态能量必定为负。\n-   如果 $g  g_c(a)$，那么对于所有函数 $\\psi$，$g  \\frac{K[\\psi]}{V[\\psi]}$，这意味着 $E[\\psi;g,a] > 0$。由于这对所有 $\\psi$ 都成立，其下确界必定为非负，即 $E_0(g,a) \\ge 0$。\n-   在 $g = g_c(a)$ 时，$E_0(g_c(a),a) = 0$。\n\n临界耦合必须为严格正值，$g_c(a) > 0$。这是因为对于 $\\mathbb{R}^3$ 上任何不是常数的可归一化函数 $\\psi$，其动能 $K[\\psi]$ 是严格为正的（这是索博列夫不等式的一个推论）。势能泛函 $V[\\psi]$ 也是严格为正的。因此，该比值总是正的，其下确界也必须为正。\n\n**第 2 部分：$g_c(a)$ 的构造性变分估计**\n\n我们使用指定的试探函数族 $\\psi_\\alpha(r) = \\mathcal{N}(\\alpha)e^{-\\alpha r}$（其中 $\\alpha > 0$）寻求 $g_c(a)$ 的一个上界。\n\n**1. 归一化**\n对于球对称函数，体积元为 $d^3\\mathbf{r} = 4\\pi r^2 dr$。归一化条件是：\n$$\n\\int_{\\mathbb{R}^3} |\\psi_\\alpha|^2 \\, d^3\\mathbf{r} = \\int_0^\\infty \\mathcal{N}(\\alpha)^2 e^{-2\\alpha r} \\, 4\\pi r^2 dr = 1\n$$\n该积分为标准的伽马函数形式：$\\int_0^\\infty r^n e^{-kx} dx = n!/k^{n+1}$。对于 $n=2$ 和 $k=2\\alpha$：\n$$\n4\\pi \\mathcal{N}(\\alpha)^2 \\left( \\frac{2!}{(2\\alpha)^3} \\right) = 4\\pi \\mathcal{N}(\\alpha)^2 \\left( \\frac{2}{8\\alpha^3} \\right) = \\frac{\\pi \\mathcal{N}(\\alpha)^2}{\\alpha^3} = 1\n$$\n这给出了归一化常数 $\\mathcal{N}(\\alpha) = \\sqrt{\\frac{\\alpha^3}{\\pi}}$。\n\n**2. 动能期望值**\n动能为 $K[\\psi_\\alpha] = \\int |\\nabla\\psi_\\alpha|^2 d^3\\mathbf{r}$。对于实球对称函数，有 $|\\nabla \\psi(r)|^2 = (\\frac{d\\psi}{dr})^2$。\n$$\n\\frac{d\\psi_\\alpha}{dr} = \\mathcal{N}(\\alpha) \\frac{d}{dr}(e^{-\\alpha r}) = -\\alpha \\mathcal{N}(\\alpha) e^{-\\alpha r} = -\\alpha \\psi_\\alpha(r)\n$$\n因此，$(\\frac{d\\psi_\\alpha}{dr})^2 = \\alpha^2 \\psi_\\alpha(r)^2$。动能变为：\n$$\nK[\\psi_\\alpha] = \\int \\alpha^2 |\\psi_\\alpha(r)|^2 \\, d^3\\mathbf{r} = \\alpha^2 \\int |\\psi_\\alpha(r)|^2 \\, d^3\\mathbf{r} = \\alpha^2\n$$\n因为 $\\psi_\\alpha$ 是归一化的。\n\n**3. 势能期望值**\n势能为 $V[\\psi_\\alpha] = \\int \\frac{e^{-ar}}{r} |\\psi_\\alpha|^2 d^3\\mathbf{r}$。\n$$\nV[\\psi_\\alpha] = \\int_0^\\infty \\frac{e^{-ar}}{r} \\left(\\frac{\\alpha^3}{\\pi}\\right) e^{-2\\alpha r} \\, 4\\pi r^2 dr = 4\\alpha^3 \\int_0^\\infty r e^{-(a+2\\alpha)r} dr\n$$\n使用伽马函数积分，对于 $n=1$ 和 $k=a+2\\alpha$：\n$$\nV[\\psi_\\alpha] = 4\\alpha^3 \\left( \\frac{1!}{(a+2\\alpha)^2} \\right) = \\frac{4\\alpha^3}{(a+2\\alpha)^2}\n$$\n\n**4. 变分最小化**\n我们的试探函数族的能量泛函是：\n$$\nE(\\alpha; g, a) = K[\\psi_\\alpha] - g V[\\psi_\\alpha] = \\alpha^2 - g \\frac{4\\alpha^3}{(a+2\\alpha)^2}\n$$\n基态能量的变分估计为 $E_{var}(g,a) = \\inf_{\\alpha>0} E(\\alpha;g,a)$。临界耦合的估计值（我们记为 $\\tilde{g}_c(a)$）是使 $E_{var}(g,a)=0$ 的最小 $g$ 值。这发生在函数的最小值等于零时，即要求对于某个最优的 $\\alpha_0 > 0$，函数本身及其导数都为零：\n$$\n(1) \\quad E(\\alpha_0; \\tilde{g}_c, a) = 0 \\quad \\implies \\quad \\alpha_0^2 - \\tilde{g}_c \\frac{4\\alpha_0^3}{(a+2\\alpha_0)^2} = 0\n$$\n$$\n(2) \\quad \\frac{\\partial E}{\\partial \\alpha}\\bigg|_{\\alpha_0} = 0 \\quad \\implies \\quad 2\\alpha_0 - \\tilde{g}_c \\frac{\\partial}{\\partial \\alpha}\\left(\\frac{4\\alpha^3}{(a+2\\alpha)^2}\\right)\\bigg|_{\\alpha_0} = 0\n$$\n由 (1)，假设 $\\alpha_0>0$：\n$$\n1 = \\tilde{g}_c \\frac{4\\alpha_0}{(a+2\\alpha_0)^2} \\implies \\tilde{g}_c = \\frac{(a+2\\alpha_0)^2}{4\\alpha_0}\n$$\n由 (2)，我们首先计算导数：\n$$\n\\frac{\\partial}{\\partial \\alpha}\\left(\\frac{4\\alpha^3}{(a+2\\alpha)^2}\\right) = \\frac{12\\alpha^2(a+2\\alpha)^2 - 4\\alpha^3 \\cdot 2(a+2\\alpha) \\cdot 2}{(a+2\\alpha)^4} = \\frac{4\\alpha^2(3a+2\\alpha)}{(a+2\\alpha)^3}\n$$\n将此代入 (2) 并假设 $\\alpha_0>0$：\n$$\n2\\alpha_0 = \\tilde{g}_c \\frac{4\\alpha_0^2(3a+2\\alpha_0)}{(a+2\\alpha_0)^3} \\implies 1 = \\tilde{g}_c \\frac{2\\alpha_0(3a+2\\alpha_0)}{(a+2\\alpha_0)^3} \\implies \\tilde{g}_c = \\frac{(a+2\\alpha_0)^3}{2\\alpha_0(3a+2\\alpha_0)}\n$$\n令 $\\tilde{g}_c$ 的两个表达式相等：\n$$\n\\frac{(a+2\\alpha_0)^2}{4\\alpha_0} = \\frac{(a+2\\alpha_0)^3}{2\\alpha_0(3a+2\\alpha_0)}\n$$\n由于 $a>0, \\alpha_0>0$，我们可以通过除以公因子来简化：\n$$\n\\frac{1}{2} = \\frac{a+2\\alpha_0}{3a+2\\alpha_0} \\implies 3a+2\\alpha_0 = 2(a+2\\alpha_0) = 2a+4\\alpha_0 \\implies a = 2\\alpha_0\n$$\n最优变分参数为 $\\alpha_0 = a/2$。\n\n**第 3 部分：用于实现的最终公式**\n将 $\\alpha_0 = a/2$ 代回 $\\tilde{g}_c(a)$ 的表达式中：\n$$\n\\tilde{g}_c(a) = \\frac{(a+2(a/2))^2}{4(a/2)} = \\frac{(a+a)^2}{2a} = \\frac{(2a)^2}{2a} = \\frac{4a^2}{2a} = 2a\n$$\n这个解析结果 $\\tilde{g}_c(a) = 2a$ 是真实临界耦合 $g_c(a)$ 的变分上界。程序将对测试集中的每个 $a$ 值实现这个简单的公式。\n\n对于给定的测试用例：\n-   $a = 0.1 \\implies \\tilde{g}_c(0.1) = 2(0.1) = 0.2$\n-   $a = 1.0 \\implies \\tilde{g}_c(1.0) = 2(1.0) = 2.0$\n-   $a = 5.0 \\implies \\tilde{g}_c(5.0) = 2(5.0) = 10.0$\n-   $a = 0.001 \\implies \\tilde{g}_c(0.001) = 2(0.001) = 0.002$\n\n实现将计算这些值并按要求格式化它们。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the variational upper bound for the critical coupling g_c(a)\n    for the Yukawa potential using an exponential trial wavefunction.\n    \"\"\"\n    # Define the test cases for the screening parameter 'a' from the problem statement.\n    test_cases = [0.1, 1.0, 5.0, 0.001]\n\n    results = []\n    for a in test_cases:\n        # The analytical result from the Rayleigh-Ritz variational principle with the\n        # trial function family psi_alpha(r) = N * exp(-alpha*r) is that the\n        # estimated critical coupling g_c(a) is exactly 2*a.\n        # This is an upper bound to the true critical coupling.\n        g_c_estimate = 2.0 * a\n        \n        # The problem requires the output to be a floating-point number\n        # rounded to ten decimal places.\n        results.append(f\"{g_c_estimate:.10f}\")\n\n    # Final print statement in the exact required format: [g1,g2,g3,g4]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "在上一节估算的基础上，本练习将介绍一种稳健的数值方法，以高精度确定临界耦合常数。通过将薛定谔方程离散化，并分析所得矩阵的性质，我们可以高效地锁定束缚态出现的精确阈值。此方法展示了计算物理学中求解本征值问题的标准技巧，即将连续的物理问题转化为离散的矩阵问题来求解。",
            "id": "3609098",
            "problem": "考虑一个双体非相对论束缚态问题，在自然单位制下，普朗克常数除以 $2\\pi$ ($\\hbar$) 与两倍的约化质量满足 $\\hbar^2/(2m)=1$。s-波（角动量量子数 $l=0$）的径向薛定谔算符定义在区间 $r\\in[0,R_{\\max}]$ 上，并满足狄利克雷边界条件 $u(0)=0$ 和 $u(R_{\\max})=0$。相互作用为汤川势 $V(r)=-g\\,e^{-\\mu r}/r$，其中 $g$ 是耦合常数，$\\mu0$ 是屏蔽参数。当哈密顿量的最低本征值 $E_b$ 满足 $E_b  0$ 时，出现束缚态。对于固定的 $\\mu$，临界耦合常数 $g_c(\\mu)$ 是存在束缚态的最小 $g$ 值，等价于使哈密顿量至少有一个负本征值的最小 $g$ 值。\n\n从径向薛定谔方程和基本定义出发，推导一个计算程序来定位 $g_c(\\mu)$。该程序通过在基态能量趋近于 $0^-$ 的位置对 $g$ 进行区间包围，并使用单调谓词将其优化至指定公差。在均匀网格 $r_i=i\\,h$（其中 $i=0,1,\\dots,N+1$，$h$ 是步长，$N$ 是内部点数）上，使用二阶中心有限差分格式对算符 $-d^2/dr^2 + V(r)$ 进行离散化。施加边界条件 $u(0)=0$ 和 $u(R_{\\max})=0$。为确保所有测试用例的一致性，请使用以下区域和分辨率规则：\n- 径向截断半径必须为 $R_{\\max}=\\min(200,\\,60/\\mu)$。\n- 均匀步长必须为 $h=0.02$。\n- 内部点数必须为 $N=\\lfloor R_{\\max}/h\\rfloor - 1$，且对于所有测试用例，该值必须为正。\n\n设计一种可靠的方法，在不计算本征向量的情况下，判断离散化的哈密顿量是否至少有一个负本征值。使用一个基于平移三对角矩阵在 $\\lambda=0$ 处的惯性（负主元的数量）且有数学依据的检验方法，来判断对于给定的 $g$ 是否有 $E_b  0$。并利用最低本征值随 $g$ 变化的单调性，采用区间包围加二分法策略，在相同的自然单位制下，将 $g_c(\\mu)$ 确定到 $10^{-6}$ 的绝对公差范围内。\n\n你的程序必须实现此过程，并对以下屏蔽参数测试集评估 $g_c(\\mu)$：\n- $\\mu=0.1$ (近库仑区),\n- $\\mu=0.5$ (中等程),\n- $\\mu=1.0$ (基准),\n- $\\mu=2.0$ (短程).\n\n在所选的自然单位制中，所有量均为无量纲。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[g_{c,1},g_{c,2},g_{c,3},g_{c,4}]$），列表中的每个条目是对应测试用例计算出的 $g_c(\\mu)$ 值，四舍五入到六位小数。输出必须是浮点数。该方法必须是自包含的，并且不得需要任何外部输入文件。",
            "solution": "该问题要求计算汤川势 $V(r) = -g \\, e^{-\\mu r}/r$ 在几个不同屏蔽参数 $\\mu$ 值下的临界耦合常数 $g_c(\\mu)$。临界耦合常数定义为存在束缚态的最小 $g$ 值。在不含时薛定谔方程的背景下，这对应于哈密顿量的最低能量本征值 $E_b$ 变为非正值，即 $E_b \\leq 0$。我们寻求使 $E_b = 0$ 的特定 $g$ 值。\n\n该物理系统由 s-波（$l=0$）径向薛定谔方程描述，其波函数为 $u(r)$，定义在区间 $r \\in [0, R_{\\max}]$ 上，并满足狄利克雷边界条件 $u(0)=0$ 和 $u(R_{\\max})=0$。在给定的自然单位制（$\\hbar^2/(2m)=1$）下，该方程为：\n$$\n\\left( -\\frac{d^2}{dr^2} + V(r) \\right) u(r) = E u(r)\n$$\n这是一个一维哈密顿算符 $H = -d^2/dr^2 + V(r)$ 的本征值问题。\n\n为了通过计算解决这个问题，我们在均匀网格上对算符进行离散化。径向域 $[0, R_{\\max}]$ 被划分为 $N+1$ 个等步长 $h$ 的线段。网格点为 $r_i = i \\cdot h$，$i=0, 1, \\dots, N+1$，其中 $R_{\\max} = (N+1)h$。在这些点上的波函数记为 $u_i = u(r_i)$。边界条件意味着 $u_0 = 0$ 和 $u_{N+1} = 0$。\n\n二阶导数 $d^2/dr^2$ 在每个内部网格点 $r_i$（$i=1, \\dots, N$）处使用二阶中心有限差分公式近似为：\n$$\n\\frac{d^2u}{dr^2}\\bigg|_{r=r_i} \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\n将此代入薛定谔方程，得到一个线性方程组：\n$$\n-\\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + V(r_i)u_i = E u_i, \\quad \\text{for } i=1, \\dots, N\n$$\n这可以重写为矩阵本征值方程 $H\\mathbf{u} = E\\mathbf{u}$，其中 $\\mathbf{u} = [u_1, u_2, \\dots, u_N]^T$ 是内部点上波函数的向量。矩阵 $H$ 是一个实的、对称的 $N \\times N$ 三对角矩阵，其元素为：\n$$\nH_{ij} =\n\\begin{cases}\n\\frac{2}{h^2} + V(r_i)  \\text{if } i=j \\\\\n-\\frac{1}{h^2}  \\text{if } |i-j|=1 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n其中 $V(r_i) = -g \\, e^{-\\mu r_i}/r_i$。\n\n寻找临界耦合常数 $g_c(\\mu)$ 的问题现在转化为寻找使矩阵 $H$ 的最低本征值为零的 $g$ 值。如果 $H$ 至少有一个负本征值，则存在束缚态。最低本征值 $E_b(g)$ 是耦合常数 $g$ 的单调递减函数。这意味着对于 $g  g_c(\\mu)$，$H$ 的所有本征值均为正（$H$ 是正定的）；对于 $g > g_c(\\mu)$，至少有一个本征值为负。\n\n为了在不进行完全对角化这种高计算成本操作的情况下，判断给定 $g$ 值的 $H$ 是否有负本征值，我们采用一种基于 Sylvester 惯性定理的方法。该定理指出，实对称矩阵的惯性（正、负、零本征值的数量）在合同变换下保持不变。$LDL^T$ 分解就是这样一种变换，其中 $L$ 是单位下三角矩阵，$D$ 是对角矩阵。$H$ 的负本征值数量等于 $D$ 中负对角元素（主元）的数量。\n\n对于像 $H$ 这样的三对角矩阵，矩阵 $D$ 的主元 $d_i$ 可以通过以下递推关系高效计算：\n$$\nd_1 = H_{11}\n$$\n$$\nd_i = H_{ii} - \\frac{H_{i-1, i}^2}{d_{i-1}}, \\quad \\text{for } i=2, \\dots, N\n$$\n各项为 $H_{ii} = \\frac{2}{h^2} - g \\frac{e^{-\\mu r_i}}{r_i}$ 和 $H_{i-1, i} = -\\frac{1}{h^2}$。此过程的计算成本与矩阵大小成线性关系，即 $O(N)$，因此效率非常高。因此，我们可以创建一个谓词函数 `has_negative_eigenvalue(g)`，如果负主元 $d_i$ 的数量大于零，则返回 true，否则返回 false。\n\n有了这个谓词，我们就可以使用二分法（二分搜索）算法来找到 $g_c(\\mu)$。搜索针对耦合常数 $g$ 进行：\n1.  **区间包围**：建立一个包含 $g_c(\\mu)$ 的区间 $[g_{low}, g_{high}]$。我们知道 $g=0$ 时没有势，此时箱中粒子的哈密顿量只有正本征值。所以我们可以设置 $g_{low}=0$。选择一个 $g_{high}$ 的初始猜测值（例如 $g=0.1$），并将其重复加倍，直到 `has_negative_eigenvalue(g_high)` 返回 true。这确保了 $g_c(\\mu)$ 处于最终的区间内。\n2.  **二分法**：迭代地将区间减半。在每一步，测试中点 $g_{mid} = (g_{low} + g_{high})/2$。如果 `has_negative_eigenvalue(g_mid)` 为 true，意味着 $g_{mid}$ 是一个新的、更紧的上界，因此我们设置 $g_{high} = g_{mid}$。否则，$g_{mid}$ 是一个新的下界，我们设置 $g_{low} = g_{mid}$。\n3.  **终止条件**：该过程持续进行，直到区间宽度 $g_{high} - g_{low}$ 小于指定的绝对公差 $10^{-6}$。$g_c(\\mu)$ 的最终估计值是最后区间的中点。\n\n这种结合了有限差分离散化、矩阵惯性分析和二分搜索的方法，为确定给定测试用例的临界耦合常数提供了一个稳健且计算高效的程序。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the critical coupling g_c(mu) for the Yukawa potential\n    for a given set of screening parameters mu.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [0.1, 0.5, 1.0, 2.0]\n    results = []\n\n    # Absolute tolerance for the bisection search.\n    TOLERANCE = 1e-6\n\n    for mu in test_cases:\n        # 1. Setup grid parameters according to the problem statement.\n        R_max = min(200.0, 60.0 / mu)\n        h = 0.02\n        \n        # N is the number of interior grid points.\n        # The grid runs from i=0 to N+1, with u(0)=u(N+1)=0.\n        # R_max = (N+1)*h - N = R_max/h - 1.\n        N = int(R_max / h) - 1\n\n        if N = 0:\n            raise ValueError(f\"Grid size N must be positive, but got N={N} for mu={mu}.\")\n\n        # Grid points for the interior of the domain, r_i = i*h for i=1,...,N.\n        r = np.arange(1, N + 1) * h\n        \n        # Pre-calculate constants for efficiency.\n        h_sq = h * h\n        \n        # The off-diagonal elements of the Hamiltonian matrix are -1/h^2.\n        # The recurrence for LDL^T pivots uses the square of this term.\n        offdiag_sq = (1.0 / h_sq)**2\n\n        # 2. Define the predicate function for the bisection search.\n        def has_negative_eigenvalue(g: float) -> bool:\n            \"\"\"\n            Checks if the Hamiltonian matrix for a given coupling 'g' has\n            at least one negative eigenvalue. This is done by counting\n            the number of negative pivots in its LDL^T decomposition.\n            \"\"\"\n            # Calculate the diagonal of the Hamiltonian matrix H.\n            potential_term = -g * np.exp(-mu * r) / r\n            H_diag = 2.0 / h_sq + potential_term\n            \n            # Count negative pivots using the LDL^T recurrence.\n            neg_pivot_count = 0\n            \n            # First pivot d_1 = H_11\n            d = H_diag[0]\n            if d  0:\n                neg_pivot_count += 1\n            \n            # The standard algorithm can fail if a pivot is exactly zero.\n            # This is physically not expected for g  g_c, as the leading\n            # principal submatrices correspond to smaller systems which bind less\n            # easily. If d becomes zero, our check will rely on subsequent\n            # floating point behavior (e.g., d becomes -inf), which correctly\n            # signals a problem. A small perturbation can also work, but we\n            # proceed assuming standard float arithmetic is sufficient.\n            if d == 0.0:\n                d = 1e-99 # Avoid ZeroDivisionError\n\n            for i in range(1, N):\n                # Recurrence: d_i = H_ii - (H_{i-1,i})^2 / d_{i-1}\n                d = H_diag[i] - offdiag_sq / d\n                if d  0:\n                    neg_pivot_count += 1\n                if d == 0.0:\n                    d = 1e-99 # Avoid ZeroDivisionError in the next step\n\n            return neg_pivot_count > 0\n\n        # 3. Find an initial bracketing interval [g_low, g_high] for g_c.\n        g_low = 0.0  # At g=0, V=0, no bound state, so this is a safe lower bound.\n        \n        # Start with a guess and expand the bracket until a bound state is found.\n        g_high = 0.1 \n        while not has_negative_eigenvalue(g_high):\n            g_high *= 2.0\n\n        # 4. Use bisection to find g_c within the specified tolerance.\n        while (g_high - g_low) > TOLERANCE:\n            g_mid = g_low + (g_high - g_low) / 2.0\n            # If g_mid is indistinguishable from the bounds, stop.\n            if g_mid == g_low or g_mid == g_high:\n                break\n                \n            if has_negative_eigenvalue(g_mid):\n                # A bound state exists, so g_mid is an upper bound for g_c.\n                g_high = g_mid\n            else:\n                # No bound state, so g_mid is a lower bound for g_c.\n                g_low = g_mid\n\n        # The critical coupling is the midpoint of the final interval.\n        g_c = (g_low + g_high) / 2.0\n        results.append(g_c)\n\n    # 5. Format and print the results as required.\n    # The problem specifies rounding to six decimal places, and floats.\n    # The f-string format achieves this.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现代核物理的许多计算，尤其是在散射理论中，通常是在动量空间中进行的。本练习的核心任务是将我们熟悉的坐标空间中的汤川势 $V(r)$ 通过傅里叶变换转换到其动量空间表示 $V(k)$。这项实践涉及细致的数值积分以及对特殊情况的处理，为进行更高级的散射计算提供了关键的工具。",
            "id": "3609029",
            "problem": "要求您以物理上一致且数值上稳健的方式计算汤川势的动量空间表示。考虑一个在位置空间中定义的中心汤川势 $$V(r)=-\\alpha\\,\\hbar c\\,\\frac{e^{-\\mu r}}{r},$$ 其中 $r$ 是以飞米 (fm) 为单位的径向坐标，$\\alpha$ 是无量纲的耦合强度，$\\mu$ 是以反飞米 (fm$^{-1}$) 为单位的屏蔽质量参数，$\\hbar c$ 是普朗克常数乘以光速（单位为兆电子伏特·飞米 (MeV·fm)）。使用 $\\hbar c=197.3269804\\,\\mathrm{MeV\\cdot fm}$。\n\n动量空间势通过三维 (3D) 傅里叶变换定义\n$$V(\\mathbf{k})=\\int_{\\mathbb{R}^3}\\mathrm{d}^3\\mathbf{r}\\,e^{i\\mathbf{k}\\cdot\\mathbf{r}}\\,V(r),$$\n其中 $\\mathbf{k}$ 是以反飞米 (fm$^{-1}$) 为单位的动量矢量，$k=\\lVert\\mathbf{k}\\rVert$。对于球对称势 $V(r)$，使用角平均恒等式，该积分可简化为一维径向积分：\n$$\\int\\limits_{-1}^{1}\\mathrm{d}(\\cos\\theta)\\,e^{ik r\\cos\\theta}=2\\,\\frac{\\sin(kr)}{kr},$$\n这导出了如下表示：\n$$V(k)=4\\pi\\int_{0}^{\\infty} r^2\\,\\mathrm{d}r\\,V(r)\\,\\frac{\\sin(kr)}{kr}.$$\n\n您必须实现一个数值算法，该算法计算上述关于 $V(r)$ 的径向积分，并在有限径向域 $[0,R_{\\max}]$ 上汇总结果，并使用解析尾部校正来表示从 $R_{\\max}$ 到 $\\infty$ 的余项。具体来说，对于 $k>0$，使用：\n$$\\int_{R_{\\max}}^{\\infty}\\mathrm{d}r\\,e^{-\\mu r}\\sin(kr)=\\frac{e^{-\\mu R_{\\max}}\\left(\\mu\\sin(kR_{\\max})+k\\cos(kR_{\\max})\\right)}{k^2+\\mu^2},$$\n并将其与数值积分的有限范围部分相结合。对于 $k=0$ 的特殊情况，使用 $k\\to 0$ 时 $\\sin(kr)/k$ 的极限行为来避免除以零。基于第一性原理，实现对 $k=0$ 情况的稳健处理。\n\n所有量都必须以一致的单位进行计算：$r$ 的单位是 fm，$k$ 和 $\\mu$ 的单位是 fm$^{-1}$，最终的动量空间势 $V(k)$ 的单位是 MeV·fm$^3$。您的程序必须产生浮点数结果，并四舍五入到十位小数。\n\n测试套件：\n为以下参数集 $(\\alpha,\\mu,k,R_{\\max})$ 计算 $V(k)$：\n\n- 情况 1（一般情况）：$(0.5,\\,0.7\\,\\mathrm{fm}^{-1},\\,1.2\\,\\mathrm{fm}^{-1},\\,50\\,\\mathrm{fm})$。\n- 情况 2（$k=0$ 时的边界条件）：$(0.2,\\,1.5\\,\\mathrm{fm}^{-1},\\,0.0\\,\\mathrm{fm}^{-1},\\,80\\,\\mathrm{fm})$。\n- 情况 3（长程势，小 $\\mu$）：$(0.7,\\,0.05\\,\\mathrm{fm}^{-1},\\,0.3\\,\\mathrm{fm}^{-1},\\,200\\,\\mathrm{fm})$。\n- 情况 4（高动量振荡被积函数）：$(0.5,\\,0.7\\,\\mathrm{fm}^{-1},\\,10.0\\,\\mathrm{fm}^{-1},\\,60\\,\\mathrm{fm})$。\n- 情况 5（小 $R_{\\max}$ 的收敛性压力测试）：$(0.5,\\,0.7\\,\\mathrm{fm}^{-1},\\,1.2\\,\\mathrm{fm}^{-1},\\,10\\,\\mathrm{fm})$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如，$$[v_1,v_2,v_3,v_4,v_5],$$ 其中每个 $v_i$ 是对应测试用例计算出的 $V(k)$ 值，单位为 MeV·fm$^3$，四舍五入到十位小数。\n\n输出中不允许有其他文本或格式。",
            "solution": "用户要求为一组给定参数计算汤川势的动量空间表示 $V(k)$。该方法结合了有限域上的数值积分和域余下部分的解析尾部校正。\n\n**1. 理论公式**\n\n位置空间中的汤川势由以下公式给出：\n$$V(r)=-\\alpha\\,\\hbar c\\,\\frac{e^{-\\mu r}}{r}$$\n其中 $r$ 是以飞米 (fm) 为单位的径向距离，$\\alpha$ 是无量纲耦合强度，$\\mu$ 是以 fm$^{-1}$ 为单位的屏蔽质量参数，$\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$。\n\n动量空间中的势 $V(\\mathbf{k})$ 是 $V(r)$ 的三维傅里叶变换：\n$$V(\\mathbf{k})=\\int_{\\mathbb{R}^3}\\mathrm{d}^3\\mathbf{r}\\,e^{i\\mathbf{k}\\cdot\\mathbf{r}}\\,V(r)$$\n对于球对称势 $V(r)$，其中 $r = \\lVert \\mathbf{r} \\rVert$，在 $\\mathbf{r}$ 空间中变换到球坐标系可以解析地执行角度积分。将 $\\mathbf{k}$ 与 $z$ 轴对齐，则 $\\mathbf{k}\\cdot\\mathbf{r} = kr\\cos\\theta$。\n体积元为 $\\mathrm{d}^3\\mathbf{r} = r^2\\sin\\theta\\,\\mathrm{d}r\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$。积分变为：\n$$V(k) = \\int_{0}^{\\infty} r^2 V(r) \\,\\mathrm{d}r \\int_{0}^{2\\pi} \\mathrm{d}\\phi \\int_{0}^{\\pi} e^{ikr\\cos\\theta} \\sin\\theta\\,\\mathrm{d}\\theta$$\n角度积分得出：\n$$\\int_{0}^{2\\pi} \\mathrm{d}\\phi = 2\\pi$$\n$$\\int_{0}^{\\pi} e^{ikr\\cos\\theta} \\sin\\theta\\,\\mathrm{d}\\theta = \\int_{-1}^{1} e^{ikru}\\,\\mathrm{d}u = \\frac{e^{ikr}-e^{-ikr}}{ikr} = 2\\frac{\\sin(kr)}{kr}$$\n结合这些结果，得到问题陈述中提供的一维径向积分：\n$$V(k) = 4\\pi \\int_{0}^{\\infty} r^2 V(r) \\frac{\\sin(kr)}{kr}\\,\\mathrm{d}r$$\n代入 $V(r)$ 的表达式：\n$$V(k) = 4\\pi \\int_{0}^{\\infty} r^2 \\left(-\\alpha\\,\\hbar c\\,\\frac{e^{-\\mu r}}{r}\\right) \\frac{\\sin(kr)}{kr}\\,\\mathrm{d}r$$\n简化积分内的项：\n$$r^2 \\cdot \\frac{e^{-\\mu r}}{r} \\cdot \\frac{\\sin(kr)}{kr} = r \\cdot e^{-\\mu r} \\cdot \\frac{\\sin(kr)}{k}$$\n这似乎会导出一个 $r e^{-\\mu r} \\sin(kr)$ 的被积函数，但仔细重新审视表达式 $V(k) = \\frac{4\\pi}{k} \\int_0^\\infty r V(r) \\sin(kr) dr$（它与给定的公式等价），我们代入 $rV(r)$：\n$$rV(r) = r \\left(-\\alpha\\,\\hbar c\\,\\frac{e^{-\\mu r}}{r}\\right) = -\\alpha\\,\\hbar c\\,e^{-\\mu r}$$\n$V(k)$ 的积分因此正确地简化为：\n$$V(k) = \\frac{4\\pi}{k} \\int_{0}^{\\infty} (-\\alpha\\,\\hbar c\\,e^{-\\mu r}) \\sin(kr)\\,\\mathrm{d}r = -\\frac{4\\pi\\alpha\\,\\hbar c}{k} \\int_{0}^{\\infty} e^{-\\mu r} \\sin(kr)\\,\\mathrm{d}r$$\n这个公式至关重要，因为被积函数现在是 $e^{-\\mu r}\\sin(kr)$，问题为此提供了解析尾部积分。\n\n**2. 数值与解析策略**\n\n从 $0$ 到 $\\infty$ 的积分在一个有限半径 $R_{\\max}$ 处被分割：\n$$\\int_{0}^{\\infty} \\mathrm{d}r\\,e^{-\\mu r} \\sin(kr) = \\int_{0}^{R_{\\max}} \\mathrm{d}r\\,e^{-\\mu r} \\sin(kr) + \\int_{R_{\\max}}^{\\infty} \\mathrm{d}r\\,e^{-\\mu r} \\sin(kr)$$\n第一项进行数值计算。第二项，即尾部积分，是解析给出的。\n\n**2.1. $k > 0$ 的情况**\n\n对于动量转移 $k$ 大于 $0$ 的情况，数值部分为 $I_{\\text{num}}(k) = \\int_{0}^{R_{\\max}} e^{-\\mu r} \\sin(kr)\\,\\mathrm{d}r$。\n如问题所述，解析尾部校正为：\n$$I_{\\text{tail}}(k) = \\int_{R_{\\max}}^{\\infty} e^{-\\mu r} \\sin(kr)\\,\\mathrm{d}r = \\frac{e^{-\\mu R_{\\max}}\\left(\\mu\\sin(kR_{\\max})+k\\cos(kR_{\\max})\\right)}{k^2+\\mu^2}$$\n总势能则计算如下：\n$$V(k) = -\\frac{4\\pi\\alpha\\,\\hbar c}{k} \\left( I_{\\text{num}}(k) + I_{\\text{tail}}(k) \\right)$$\n\n**2.2. $k = 0$ 的情况**\n\n对于 $k=0$ 的特殊情况，$V(k)$ 的表达式涉及一个 $0/0$ 的不定形式。我们必须评估 $k \\to 0$ 时的极限。我们使用原始的球对称形式以及 $\\lim_{k\\to 0} \\frac{\\sin(kr)}{kr} = 1$ 这个事实：\n$$V(0) = \\lim_{k\\to 0} 4\\pi \\int_{0}^{\\infty} r^2 V(r) \\frac{\\sin(kr)}{kr}\\,\\mathrm{d}r = 4\\pi \\int_{0}^{\\infty} r^2 V(r)\\,\\mathrm{d}r$$\n代入 $V(r)$：\n$$V(0) = 4\\pi \\int_{0}^{\\infty} r^2 \\left(-\\alpha\\,\\hbar c\\,\\frac{e^{-\\mu r}}{r}\\right)\\,\\mathrm{d}r = -4\\pi\\alpha\\,\\hbar c \\int_{0}^{\\infty} r e^{-\\mu r}\\,\\mathrm{d}r$$\n这个积分也在 $R_{\\max}$ 处分割：\n$$\\int_{0}^{\\infty} r e^{-\\mu r}\\,\\mathrm{d}r = \\int_{0}^{R_{\\max}} r e^{-\\mu r}\\,\\mathrm{d}r + \\int_{R_{\\max}}^{\\infty} r e^{-\\mu r}\\,\\mathrm{d}r$$\n数值积分为 $I_{\\text{num}}(0) = \\int_{0}^{R_{\\max}} r e^{-\\mu r}\\,\\mathrm{d}r$。解析尾部积分 $I_{\\text{tail}}(0)$ 通过分部积分法求得：\n$$I_{\\text{tail}}(0) = \\int_{R_{\\max}}^{\\infty} r e^{-\\mu r}\\,\\mathrm{d}r = \\left[-\\frac{r e^{-\\mu r}}{\\mu}\\right]_{R_{\\max}}^{\\infty} - \\int_{R_{\\max}}^{\\infty}\\left(-\\frac{e^{-\\mu r}}{\\mu}\\right)\\,\\mathrm{d}r$$\n$$= \\frac{R_{\\max}e^{-\\mu R_{\\max}}}{\\mu} + \\frac{1}{\\mu}\\left[-\\frac{e^{-\\mu r}}{\\mu}\\right]_{R_{\\max}}^{\\infty} = \\frac{R_{\\max}e^{-\\mu R_{\\max}}}{\\mu} + \\frac{e^{-\\mu R_{\\max}}}{\\mu^2} = e^{-\\mu R_{\\max}}\\left(\\frac{R_{\\max}}{\\mu} + \\frac{1}{\\mu^2}\\right)$$\n$k=0$ 时的总势能为：\n$$V(0) = -4\\pi\\alpha\\,\\hbar c \\left( I_{\\text{num}}(0) + I_{\\text{tail}}(0) \\right)$$\n\n这种基于原理的方法正确地处理了问题中指定的所有情况，将主要贡献的数值积分与尾部的精确解析公式相结合，确保了准确性和稳健性。该算法将使用 Python 和 `scipy.integrate.quad` 函数进行数值积分来实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the momentum-space representation of the Yukawa potential for a suite of test cases.\n    The calculation combines numerical integration over a finite range [0, R_max]\n    with an analytical tail correction from R_max to infinity.\n    \"\"\"\n\n    # Physical constant in specified units\n    hbar_c = 197.3269804  # MeV·fm\n\n    def calculate_V_k(alpha, mu, k, R_max):\n        \"\"\"\n        Calculates V(k) for a single set of parameters.\n\n        Args:\n            alpha (float): Dimensionless coupling strength.\n            mu (float): Screening mass parameter in fm^-1.\n            k (float): Momentum transfer in fm^-1.\n            R_max (float): Upper limit for numerical integration in fm.\n\n        Returns:\n            float: The momentum-space potential V(k) in MeV·fm^3.\n        \"\"\"\n\n        if k > 0.0:\n            # Case k > 0\n            # Integrand for the numerical part\n            integrand_num = lambda r: np.exp(-mu * r) * np.sin(k * r)\n            \n            # Numerical integration from 0 to R_max\n            # quad returns (result, error_estimate)\n            integral_num, _ = integrate.quad(integrand_num, 0, R_max, limit=200)\n\n            # Analytical tail correction from R_max to infinity\n            exp_term = np.exp(-mu * R_max)\n            sin_term = np.sin(k * R_max)\n            cos_term = np.cos(k * R_max)\n            \n            numerator = exp_term * (mu * sin_term + k * cos_term)\n            denominator = k**2 + mu**2\n            \n            integral_tail = numerator / denominator\n\n            # Full integral I = integral_num + integral_tail\n            total_integral = integral_num + integral_tail\n\n            # Calculate V(k) from the total integral\n            V_k = - (4.0 * np.pi * alpha * hbar_c / k) * total_integral\n\n        else:  # Case k == 0.0\n            # Integrand for the numerical part at k=0\n            integrand_num_k0 = lambda r: r * np.exp(-mu * r)\n            \n            # Numerical integration from 0 to R_max\n            integral_num_k0, _ = integrate.quad(integrand_num_k0, 0, R_max, limit=200)\n\n            # Analytical tail correction for the k=0 integral\n            exp_term = np.exp(-mu * R_max)\n            integral_tail_k0 = exp_term * (R_max / mu + 1.0 / mu**2)\n\n            # Full integral I(0) = integral_num_k0 + integral_tail_k0\n            total_integral_k0 = integral_num_k0 + integral_tail_k0\n\n            # Calculate V(0)\n            V_k = -4.0 * np.pi * alpha * hbar_c * total_integral_k0\n            \n        return V_k\n\n    # Test suite provided in the problem statement\n    # Format: (alpha, mu, k, R_max)\n    test_cases = [\n        (0.5, 0.7, 1.2, 50.0),    # Case 1 (general case)\n        (0.2, 1.5, 0.0, 80.0),    # Case 2 (boundary condition at k=0)\n        (0.7, 0.05, 0.3, 200.0),  # Case 3 (long-range potential, small mu)\n        (0.5, 0.7, 10.0, 60.0),   # Case 4 (high-momentum oscillatory integrand)\n        (0.5, 0.7, 1.2, 10.0),   # Case 5 (convergence stress with small R_max)\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, mu, k, R_max = case\n        result = calculate_V_k(alpha, mu, k, R_max)\n        results.append(f\"{result:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}