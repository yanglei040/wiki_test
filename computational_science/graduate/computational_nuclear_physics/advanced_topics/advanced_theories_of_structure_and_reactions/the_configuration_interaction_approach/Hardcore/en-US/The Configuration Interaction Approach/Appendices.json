{
    "hands_on_practices": [
        {
            "introduction": "The first step in any configuration interaction calculation is to define the many-body Hilbert space. This exercise provides foundational practice in this crucial task, starting from the single-particle harmonic oscillator basis and building up to a truncated many-body model space. By working through the No-Core Shell Model (NCSM) for a light nucleus like $^6$Li, you will gain hands-on experience with defining configurations, applying energy truncations ($N_{\\max}$), and counting the dimension of the resulting basis in the M-scheme, which are all fundamental prerequisites for setting up a realistic CI calculation .",
            "id": "3597229",
            "problem": "Consider the No-Core Shell Model (NCSM) for the nucleus $^{6}\\mathrm{Li}$ using a three-dimensional harmonic oscillator single-particle basis characterized by the energy scale $\\hbar\\Omega=20\\,\\mathrm{MeV}$. In the NCSM, the many-body model space is truncated by the excitation quantum number $N_{\\max}$, which limits the total number of harmonic oscillator quanta above the lowest-energy Slater determinant configuration. The $^{6}\\mathrm{Li}$ nucleus has $A=6$ nucleons with $Z=3$ protons and $N=3$ neutrons. The harmonic oscillator major shells are labeled by the principal quantum number $N=2n+\\ell$, where $n$ is the radial quantum number and $\\ell$ is the orbital angular momentum, and each single-particle state is further specified by the total angular momentum $j=\\ell\\pm\\frac{1}{2}$ and its projection $m$. \n\nStarting only from the definitions of the harmonic oscillator basis and the NCSM $N_{\\max}$ truncation, do the following:\n- Identify the lowest-energy configuration for $A=6$ nucleons in the harmonic oscillator basis and compute the corresponding total number of harmonic oscillator quanta $N_{0}$.\n- Using the definition of the NCSM truncation, determine all allowed even-parity many-body excitation values $N\\hbar\\Omega$ (i.e., all allowed values of the total number of excitation quanta relative to $N_{0}$) for $A=6$ with $N_{\\max}=4$.\n- In the $M$-scheme (basis of Slater determinants labeled by the projection $M$ of the total angular momentum), compute the many-body basis dimension for $^{6}\\mathrm{Li}$ at the $0\\hbar\\Omega$ sector for total $M=1$. Treat protons and neutrons as distinguishable species occupying identical single-particle spaces and assume the $0s$ shell is completely filled in the lowest-energy configuration. \n\nExpress the final dimension as a single integer. No rounding is required. No physical units are required for the final answer.",
            "solution": "The problem asks for a multi-step analysis of the nucleus $^{6}\\mathrm{Li}$ within the No-Core Shell Model (NCSM) framework. The analysis involves identifying the ground state configuration, determining allowed excitation energies under a specific truncation, and calculating a many-body basis dimension.\n\n### Part 1: Lowest-Energy Configuration and $N_0$\n\nThe single-particle basis is composed of states of a three-dimensional harmonic oscillator (HO). These states are organized into major shells labeled by the principal quantum number $N=2n+\\ell$, where $n$ is the radial quantum number and $\\ell$ is the orbital angular momentum. The energy of a nucleon in a state with principal quantum number $N$ is proportional to $N$. To find the lowest-energy configuration for an $A$-nucleon system, we fill these HO shells in order of increasing $N$, respecting the Pauli exclusion principle for protons and neutrons separately.\n\nThe HO shells and their degeneracies are:\n- $N=0$: $\\ell=0$ ($s$-shell). This is the $0s_{1/2}$ subshell with degeneracy $2j+1 = 2$.\n- $N=1$: $\\ell=1$ ($p$-shell). This shell contains the $0p_{3/2}$ (degeneracy $4$) and $0p_{1/2}$ (degeneracy $2$) subshells, for a total degeneracy of $6$.\n- $N=2$: $\\ell=0, 2$ ($sd$-shell), and so on.\n\nThe nucleus $^{6}\\mathrm{Li}$ consists of $A=6$ nucleons: $Z=3$ protons and $N=3$ neutrons.\nTo construct the lowest-energy configuration, we place the nucleons in the lowest available energy shells.\n- **Protons ($Z=3$):** Two protons fill the $N=0$ shell ($0s_{1/2}$). The third proton must occupy a state in the next available shell, which is the $N=1$ shell ($p$-shell).\n- **Neutrons ($N=3$):** Similarly, two neutrons fill the $N=0$ shell ($0s_{1/2}$), and the third neutron occupies a state in the $N=1$ shell.\n\nThe total number of HO quanta for this configuration, denoted $N_0$, is the sum of the principal quantum numbers $N$ of all occupied single-particle states.\nFor the protons: $N_{0,p} = (2 \\times 0) + (1 \\times 1) = 1$.\nFor the neutrons: $N_{0,n} = (2 \\times 0) + (1 \\times 1) = 1$.\nThe total number of quanta for the lowest-energy configuration is the sum for protons and neutrons:\n$$N_0 = N_{0,p} + N_{0,n} = 1 + 1 = 2$$\n\n### Part 2: Allowed Even-Parity Excitation Values\n\nThe NCSM model space is truncated by $N_{\\max}$, which is the maximum number of HO excitation quanta allowed above the lowest-energy configuration. The number of excitation quanta for a given configuration with total quanta $N_{\\text{tot}}$ is $\\Delta N = N_{\\text{tot}} - N_0$. The truncation is given by $\\Delta N \\le N_{\\max}$.\nIn this problem, $N_0=2$ and $N_{\\max}=4$. Thus, the allowed values for $\\Delta N$ are $0, 1, 2, 3, 4$. The corresponding total quanta for allowed configurations are $N_{\\text{tot}} = N_0 + \\Delta N$, which gives $N_{\\text{tot}} \\in \\{2, 3, 4, 5, 6\\}$.\n\nThe parity of a many-body state is given by the product of the parities of the occupied single-particle states, $\\prod_{i=1}^{A} (-1)^{\\ell_i} = (-1)^{\\sum_{i=1}^{A} \\ell_i}$. The total number of quanta is $N_{\\text{tot}} = \\sum_{i=1}^{A} N_i = \\sum_{i=1}^{A} (2n_i + \\ell_i) = 2\\sum_{i=1}^{A} n_i + \\sum_{i=1}^{A} \\ell_i$. Since $2\\sum n_i$ is always even, the parity of $N_{\\text{tot}}$ is the same as the parity of $\\sum \\ell_i$. Therefore, the parity of a configuration is given by $(-1)^{N_{\\text{tot}}}$.\n\nThe problem asks for even-parity states, which means $(-1)^{N_{\\text{tot}}} = +1$. This requires $N_{\\text{tot}}$ to be an even integer. From the set of allowed total quanta $\\{2, 3, 4, 5, 6\\}$, we select the even values: $\\{2, 4, 6\\}$.\n\nThe corresponding excitation quanta $\\Delta N = N_{\\text{tot}} - N_0$ are:\n- For $N_{\\text{tot}}=2$, $\\Delta N = 2 - 2 = 0$.\n- For $N_{\\text{tot}}=4$, $\\Delta N = 4 - 2 = 2$.\n- For $N_{\\text{tot}}=6$, $\\Delta N = 6 - 2 = 4$.\n\nThe allowed even-parity many-body excitation values, expressed as $N\\hbar\\Omega$ where $N$ is the number of excitation quanta, are $0\\hbar\\Omega$, $2\\hbar\\Omega$, and $4\\hbar\\Omega$, with the given energy scale $\\hbar\\Omega=20\\,\\mathrm{MeV}$.\n\n### Part 3: Many-Body Basis Dimension at $0\\hbar\\Omega$ for $M=1$\n\nThis task requires calculating the dimension of the many-body basis in the $0\\hbar\\Omega$ sector for a total angular momentum projection of $M=1$. The $0\\hbar\\Omega$ sector corresponds to $\\Delta N=0$, which is the lowest-energy configuration identified in Part 1.\n\nThe configuration is:\n- Protons: two in the $0s$ shell, one in the $0p$ shell. This can be written as $(0s)^2(0p)^1$.\n- Neutrons: two in the $0s$ shell, one in the $0p$ shell. This is also a $(0s)^2(0p)^1$ configuration.\nThe problem states that the $0s$ shell is completely filled. A filled $0s_{1/2}$ subshell contains two nucleons with projections $m_j=+1/2$ and $m_j=-1/2$. The total angular momentum projection from a filled subshell is always zero. Therefore, the two protons in the $0s$ shell contribute $M_p(0s)=0$ to the total projection, and the two neutrons in the $0s$ shell contribute $M_n(0s)=0$.\n\nThe total projection $M$ is determined solely by the two valence nucleons: one proton in the $0p$ shell and one neutron in the $0p$ shell. Let their individual projections be $m_{jp}$ and $m_{jn}$, respectively. The total projection is $M = m_{jp} + m_{jn}$. We need to find the number of ways to form a state with $M=1$.\n\nThe single-particle states in the $0p$ shell ($N=1, \\ell=1$) are split into two subshells, $j=\\ell \\pm 1/2$:\n- $0p_{3/2}$ ($j=3/2$): has states with $m_j \\in \\{-3/2, -1/2, +1/2, +3/2\\}$.\n- $0p_{1/2}$ ($j=1/2$): has states with $m_j \\in \\{-1/2, +1/2\\}$.\n\nLet's count the number of available single-particle states for a valence nucleon in the $p$-shell, categorized by their $m_j$ value. Let $d(m_j)$ be this number.\n- For $m_j = +3/2$: $1$ state (from $0p_{3/2}$).\n- For $m_j = +1/2$: $2$ states (one from $0p_{3/2}$ and one from $0p_{1/2}$).\n- For $m_j = -1/2$: $2$ states (one from $0p_{3/2}$ and one from $0p_{1/2}$).\n- For $m_j = -3/2$: $1$ state (from $0p_{3/2}$).\nThe total is $1+2+2+1=6$ states, as expected for the $p$-shell.\n\nSince protons and neutrons are distinguishable, the total number of many-body states with $M=1$ is the sum of products of the number of ways to choose the proton state and the neutron state for all combinations $(m_{jp}, m_{jn})$ that sum to $1$.\n$$ \\text{Dimension}(M=1) = \\sum_{m_{jp}, m_{jn} \\text{ where } m_{jp}+m_{jn}=1} d_p(m_{jp}) \\times d_n(m_{jn}) $$\nThe degeneracies $d_p$ and $d_n$ are identical to $d$ calculated above.\n\nWe list the combinations of $(m_{jp}, m_{jn})$ that sum to $M=1$:\n1.  $(m_{jp}, m_{jn}) = (+3/2, -1/2)$: The number of such states is $d_p(+3/2) \\times d_n(-1/2) = 1 \\times 2 = 2$.\n2.  $(m_{jp}, m_{jn}) = (+1/2, +1/2)$: The number of such states is $d_p(+1/2) \\times d_n(+1/2) = 2 \\times 2 = 4$.\n3.  $(m_{jp}, m_{jn}) = (-1/2, +3/2)$: The number of such states is $d_p(-1/2) \\times d_n(+3/2) = 2 \\times 1 = 2$.\n\nThe total dimension is the sum of these contributions:\n$$ \\text{Dimension}(M=1) = 2 + 4 + 2 = 8 $$\nThus, there are $8$ many-body basis states (Slater determinants) for $^{6}\\mathrm{Li}$ in the $0\\hbar\\Omega$ sector with total angular momentum projection $M=1$.",
            "answer": "$$\\boxed{8}$$"
        },
        {
            "introduction": "Once a basis is defined, the core of a CI calculation involves representing and applying the Hamiltonian operator. This exercise dives into the computational engine of an M-scheme code, where efficiency is paramount. You will learn to represent many-body basis states (Slater determinants) as bitstrings and derive an algorithm to correctly and rapidly compute the fermionic sign factors that arise when one- and two-body operators act on these states, a task fundamental to iterative diagonalization methods like the Lanczos algorithm .",
            "id": "3597211",
            "problem": "You are working within the configuration interaction approach for computational nuclear physics using a fixed $M$-scheme basis. Consider two distinguishable fermion species, protons and neutrons, each occupying a finite set of single-particle orbitals labeled by nonnegative integers in ascending order. A many-body basis state is a Slater determinant constructed by applying creation operators, ordered by increasing single-particle index, onto the vacuum. The canonical anticommutation relations hold for all creation and annihilation operators, both within and across species. You will adopt the following explicit conventions, which you must use throughout:\n\n- Bitstring encoding: Represent the proton sector by a nonnegative integer $B_p$ and the neutron sector by a nonnegative integer $B_n$. The least significant bit corresponds to single-particle index $0$, and bit $i$ indicates occupancy of orbital $i$. For example, setting bits at indices $\\{1,3,5\\}$ yields $B_p=2^1+2^3+2^5$.\n- Global mode ordering: All proton modes come before all neutron modes in the global ordering of fermionic modes. Equivalently, in the canonical product that defines a Slater determinant, all proton creation operators appear to the left of all neutron creation operators.\n- Operator application ordering: An operator string written as a product from left to right $O_L \\cdots O_2 O_1$ is applied right-to-left to a basis state, i.e., $O_1$ acts first.\n- One-body operator: $a_p^\\dagger a_q$ in a given species acts by annihilating at index $q$ then creating at index $p$.\n- Two-body operator: $a_p^\\dagger a_r^\\dagger a_s a_q$ in a given species acts by annihilating at indices $q$ and $s$, then creating at $r$ and $p$, respecting the explicit left-to-right order of operators. For proton-neutron mixed operators, use the same ordering, with proton creation/annihilation denoted by $a^\\dagger, a$ and neutron creation/annihilation by $b^\\dagger, b$.\n\nStarting from the fundamental base of the fermionic canonical anticommutation relations and the definition of a Slater determinant as an ordered product of creation operators, derive an algorithm that computes the fermionic sign for valid one-body and two-body excitations in constant time per operator using only:\n\n- Bit manipulations on the occupation integers $B_p$ and $B_n$.\n- Population counts of subsets of bits below a given index.\n\nYour derivation must explain why the fermionic sign produced by $a_q$ on a determinant equals $(-1)^{N_{\\mathrm{cross}} + N_{<q}}$, where $N_{<q}$ is the number of occupied orbitals with index less than $q$ in the relevant species, and $N_{\\mathrm{cross}}$ counts occupied modes in all globally earlier species (with the above ordering, neutrons acquire a cross term $N_{\\mathrm{cross}}$ equal to the current number of occupied protons, while protons have $N_{\\mathrm{cross}}=0$). Similarly, explain the corresponding rule for $a_p^\\dagger$ on the intermediate state after prior operators in the string have acted. Show that invalid actions (annihilating an unoccupied orbital or creating into an already occupied orbital) yield zero amplitude.\n\nThen implement the algorithm to evaluate amplitudes for the test suite below, where each amplitude is the integer in $\\{-1,0,1\\}$ equal to the product of the fermionic sign factors if and only if the action is valid; otherwise it is $0$.\n\nUse the following fixed single-particle dimensions: there are $8$ proton orbitals and $8$ neutron orbitals, indexed $0$ through $7$ in each species. All test cases share the same initial determinant with proton occupation indices $\\{1,3,5\\}$ and neutron occupation indices $\\{0,2,6\\}$, i.e., $B_p=2^1+2^3+2^5=42$ and $B_n=2^0+2^2+2^6=69$.\n\nFor each test case, the operator string is given left-to-right. Your program must apply it right-to-left and compute the resulting amplitude as described.\n\nTest suite (each bullet is one case, in this order):\n\n- Case $1$ (proton one-body, valid): $a_4^\\dagger a_3$.\n- Case $2$ (proton one-body, invalid annihilation): $a_5^\\dagger a_0$.\n- Case $3$ (proton one-body, invalid creation): $a_3^\\dagger a_1$.\n- Case $4$ (neutron one-body, valid with cross-species sign): $b_5^\\dagger b_2$.\n- Case $5$ (proton two-body within species): $a_6^\\dagger a_4^\\dagger a_5 a_3$.\n- Case $6$ (neutron two-body within species, with cross-species sign at each neutron operator): $b_7^\\dagger b_1^\\dagger b_2 b_6$.\n- Case $7$ (proton-neutron mixed two-body): $a_4^\\dagger b_5^\\dagger b_2 a_1$.\n- Case $8$ (proton two-body, invalid repeated annihilation): $a_6^\\dagger a_4^\\dagger a_2 a_2$.\n- Case $9$ (neutron one-body, boundary indices): $b_7^\\dagger b_0$.\n\nFinal output format: Your program should produce a single line of output containing the amplitudes for Cases $1$ through $9$ as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,\\dots,x_9]$, where each $x_i$ is an integer in $\\{-1,0,1\\}$. No spaces are permitted. Angles are not used in this problem. No physical units are involved. All numeric answers must be provided exactly as integers in the prescribed list format.",
            "solution": "The core of the problem is to derive and implement an algorithm for calculating the amplitude (sign factor or zero) of one- and two-body fermionic operators acting on a Slater determinant. The state is represented by bitstrings, and the algorithm must rely on bitwise manipulations.\n\n### 1. State Representation and Operator Conventions\n\nA many-body basis state is a Slater determinant formed by applying creation operators to the vacuum state $|0\\rangle$. The problem specifies a global ordering where all proton modes precede all neutron modes. Within each species (protons or neutrons), creation operators are ordered by increasing single-particle index. A state with $N_p$ protons in orbitals $\\{p_1, \\dots, p_{N_p}\\}$ and $N_n$ neutrons in orbitals $\\{n_1, \\dots, n_{N_n}\\}$ is defined as:\n$$ |\\Psi\\rangle = (a_{p_1}^\\dagger a_{p_2}^\\dagger \\cdots a_{p_{N_p}}^\\dagger) (b_{n_1}^\\dagger b_{n_2}^\\dagger \\cdots b_{n_{N_n}}^\\dagger) |0\\rangle $$\nwhere $p_1 < p_2 < \\dots < p_{N_p}$ and $n_1 < n_2 < \\dots < n_{N_n}$. The operators $a^\\dagger/a$ and $b^\\dagger/b$ are for protons and neutrons, respectively.\n\nThe fundamental rules governing these operators are the canonical anticommutation relations (CARs). For operators of the same species (let's use a generic symbol $c$):\n$$ \\{c_i, c_j\\} = 0, \\quad \\{c_i^\\dagger, c_j^\\dagger\\} = 0, \\quad \\{c_i, c_j^\\dagger\\} = \\delta_{ij} $$\nFor operators of different species (protons and neutrons), all operators anticommute:\n$$ \\{a_i, b_j\\} = \\{a_i^\\dagger, b_j\\} = \\{a_i, b_j^\\dagger\\} = \\{a_i^\\dagger, b_j^\\dagger\\} = 0 $$\nThe bitstring encoding represents the occupation of single-particle orbitals. An integer $B$ has bit $i$ set if orbital $i$ is occupied. For example, $B_p = \\sum_{k \\in \\text{occupied protons}} 2^k$.\n\n### 2. Derivation for Annihilation Operator $c_q$\n\nAn operator string is applied right-to-left. Let's analyze the action of a single annihilation operator $c_q$ on the state $|\\Psi\\rangle$.\n\n**Case I: Proton Annihilation ($a_q$)**\nThe operator $a_q$ acts on $|\\Psi\\rangle = (\\prod_{i} a_{p_i}^\\dagger) (\\prod_{j} b_{n_j}^\\dagger) |0\\rangle$. Since $a_q$ anticommutes with all $b^\\dagger_j$, it can be moved past the neutron operator product without any sign change. The problem reduces to its action on the proton part of the state:\n$$ a_q |\\Psi\\rangle = (a_q a_{p_1}^\\dagger \\cdots a_{p_{N_p}}^\\dagger) (\\prod_{j} b_{n_j}^\\dagger) |0\\rangle $$\nIf orbital $q$ is not in the set of occupied proton orbitals $\\{p_k\\}$, then $a_q$ anticommutes with all $a_{p_k}^\\dagger$. It moves to the right until it acts on the vacuum, $a_q|0\\rangle = 0$. The resulting state is the null vector, so the amplitude is $0$.\n\nIf orbital $q$ is occupied, say $q=p_k$ for some $k \\in \\{1,\\dots,N_p\\}$, we must move $a_q$ past the creation operators $a_{p_1}^\\dagger, \\dots, a_{p_{k-1}}^\\dagger$. This requires $k-1$ anticommutations, each introducing a factor of $-1$.\n$$ a_q a_{p_1}^\\dagger \\cdots a_{p_{k-1}}^\\dagger a_{p_k}^\\dagger \\cdots |0\\rangle = (-1)^{k-1} a_{p_1}^\\dagger \\cdots a_{p_{k-1}}^\\dagger (a_q a_{p_k}^\\dagger) \\cdots |0\\rangle $$\nUsing $\\{a_q, a_{p_k}^\\dagger\\}=1$ (since $q=p_k$), we have $a_q a_q^\\dagger = 1 - a_q^\\dagger a_q$. The term $a_q^\\dagger a_q$ will annihilate the subsequent state as $q$ is no longer an occupied orbital. Therefore, $a_q a_q^\\dagger$ effectively acts as $1$. The resulting sign is $(-1)^{k-1}$. The value $k-1$ is precisely the number of occupied proton orbitals with an index less than $q$. We denote this $N_{<q}^{(p)}$. The problem statement gives the sign rule $(-1)^{N_{\\mathrm{cross}} + N_{<q}}$. For protons, the global ordering implies $N_{\\mathrm{cross}}=0$, so the sign is $(-1)^{N_{<q}^{(p)}}$, which matches our derivation.\n\n**Case II: Neutron Annihilation ($b_q$)**\nThe operator $b_q$ must first be moved past the entire product of $N_p$ proton creation operators. This yields a sign of $(-1)^{N_p}$:\n$$ b_q |\\Psi\\rangle = (-1)^{N_p} (\\prod_{i} a_{p_i}^\\dagger) (b_q \\prod_{j} b_{n_j}^\\dagger) |0\\rangle $$\nThe action of $b_q$ on the neutron part of the state proceeds as in Case I, yielding an additional sign of $(-1)^{N_{<q}^{(n)}}$, where $N_{<q}^{(n)}$ is the number of occupied neutron orbitals with an index less than $q$. The total sign is the product $(-1)^{N_p} (-1)^{N_{<q}^{(n)}} = (-1)^{N_p + N_{<q}^{(n)}}$. This matches the formula with $N_{\\mathrm{cross}} = N_p$, the number of occupied protons.\n\n### 3. Derivation for Creation Operator $c_p^\\dagger$\n\nA creation operator $c_p^\\dagger$ acts on an intermediate state $|\\Psi'\\rangle$ that is the result of any preceding annihilations.\n\nIf orbital $p$ is already occupied in $|\\Psi'\\rangle$, applying $c_p^\\dagger$ results in a state containing $c_p^\\dagger c_p^\\dagger$. Due to the CAR $\\{c_p^\\dagger, c_p^\\dagger\\} = 2(c_p^\\dagger)^2 = 0$, the resulting state is the null vector, and the amplitude is $0$.\n\nIf orbital $p$ is unoccupied, the action is valid. The new state $c_p^\\dagger |\\Psi'\\rangle$ must be reordered to maintain the canonical form (creation operators sorted by index). To do this, $c_p^\\dagger$ must be moved past all creation operators of the same species in $|\\Psi'\\rangle$ that have an index less than $p$. The number of such swaps is $N_{<p}$, the number of occupied orbitals of that species with index less than $p$. This gives a sign factor of $(-1)^{N_{<p}}$.\n\nSimilar to the annihilation case, for a neutron creation operator $b_p^\\dagger$, it must also be permuted past all $N'_p$ proton creation operators present in the state $|\\Psi'\\rangle$, yielding an additional factor of $(-1)^{N'_p}$. The total sign is $(-1)^{N'_p + N_{<p}^{(n)}}$. Note that $N'_p$ is the number of protons in the intermediate state $|\\Psi'\\rangle$, which might differ from the initial number if proton operators have already acted.\n\n### 4. Application to Composite Operators\n\nA one-body operator $a_p^\\dagger a_q$ or a two-body operator $a_p^\\dagger a_r^\\dagger a_s a_q$ is a string of elementary operators. According to the problem, the string is applied from right to left. The total amplitude is the product of the amplitudes from each elementary operation. If any step is invalid (annihilating an empty orbital or creating into an occupied one), the final amplitude is $0$.\n\nFor example, for $a_p^\\dagger a_r^\\dagger a_s a_q |\\Psi\\rangle$:\n1.  Apply $a_q$ to $|\\Psi\\rangle$. If invalid, amplitude is $0$. Otherwise, get sign $S_1$ and state $|\\Psi_1\\rangle$.\n2.  Apply $a_s$ to $|\\Psi_1\\rangle$. If invalid, amplitude is $0$. Otherwise, get sign $S_2$ and state $|\\Psi_2\\rangle$.\n3.  Apply $a_r^\\dagger$ to $|\\Psi_2\\rangle$. If invalid, amplitude is $0$. Otherwise, get sign $S_3$ and state $|\\Psi_3\\rangle$. Note that the signs for neutron operators depend on the number of protons in $|\\Psi_2\\rangle$.\n4.  Apply $a_p^\\dagger$ to $|\\Psi_3\\rangle$. If invalid, amplitude is $0$. Otherwise, get sign $S_4$ and final state $|\\Psi_4\\rangle$.\nThe total amplitude is the product $S_1 S_2 S_3 S_4$.\n\n### 5. Algorithmic Implementation\n\nThe derived rules translate directly into an efficient algorithm using bitwise operations on the occupation integers $B_p$ and $B_n$.\n\n-   **Check Occupancy**: Orbital $k$ is occupied in state $B$ if `(B >> k) & 1 == 1`.\n-   **Count Occupied Orbitals ($N_{<k}$)**: The number of occupied orbitals with index less than $k$ in state $B$ is the population count (number of set bits) of the integer formed by the low-order bits of $B$. This is calculated as `(B & ((1 << k) - 1)).bit_count()`.\n-   **Annihilation at $q$ on state $B$**:\n    1.  Check if orbital $q$ is occupied. If not, amplitude is $0$.\n    2.  Calculate the sign exponent. For protons, it's $N_{<q}^{(p)}$. For neutrons, it's $N_p + N_{<q}^{(n)}$, where $N_p$ is the population count of the current proton state $B_p$.\n    3.  Update state: $B' = B \\oplus (1 \\ll q)$.\n-   **Creation at $p$ on state $B$**:\n    1.  Check if orbital $p$ is occupied. If yes, amplitude is $0$.\n    2.  Calculate the sign exponent using the same rules on the current state $B$.\n    3.  Update state: $B' = B \\oplus (1 \\ll p)$.\n\nThis algorithm evaluates each elementary operator action in constant time (assuming a hardware `popcount` instruction, standard on modern CPUs and available in Python $\\ge 3.10$ as `int.bit_count()`), as requested.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the fermionic amplitudes for a series of one- and two-body operators\n    acting on a specified initial nuclear state.\n    \"\"\"\n    # Initial state from the problem description\n    # Proton occupation {1,3,5}: B_p = 2^1 + 2^3 + 2^5 = 42\n    # Neutron occupation {0,2,6}: B_n = 2^0 + 2^2 + 2^6 = 69\n    bp_initial = 42\n    bn_initial = 69\n\n    # Test cases defined as lists of elementary operations.\n    # Each operation is a tuple: (species, type, index)\n    # species: 'p' (proton) or 'n' (neutron)\n    # type: 'a' (annihilate) or 'c' (create)\n    # index: orbital index (integer)\n    # The order of operations in each list corresponds to the right-to-left\n    # application of the operator string.\n    test_cases = [\n        # Case 1: a_4^† a_3\n        [('p', 'a', 3), ('p', 'c', 4)],\n        # Case 2: a_5^† a_0\n        [('p', 'a', 0), ('p', 'c', 5)],\n        # Case 3: a_3^† a_1\n        [('p', 'a', 1), ('p', 'c', 3)],\n        # Case 4: b_5^† b_2\n        [('n', 'a', 2), ('n', 'c', 5)],\n        # Case 5: a_6^† a_4^† a_5 a_3\n        [('p', 'a', 3), ('p', 'a', 5), ('p', 'c', 4), ('p', 'c', 6)],\n        # Case 6: b_7^† b_1^† b_2 b_6\n        [('n', 'a', 6), ('n', 'a', 2), ('n', 'c', 1), ('n', 'c', 7)],\n        # Case 7: a_4^† b_5^† b_2 a_1\n        [('p', 'a', 1), ('n', 'a', 2), ('n', 'c', 5), ('p', 'c', 4)],\n        # Case 8: a_6^† a_4^† a_2 a_2\n        [('p', 'a', 2), ('p', 'a', 2), ('p', 'c', 4), ('p', 'c', 6)],\n        # Case 9: b_7^† b_0\n        [('n', 'a', 0), ('n', 'c', 7)],\n    ]\n\n    results = []\n\n    def popcount_lt(b, idx):\n        \"\"\"\n        Counts the number of set bits in integer b for indices less than idx.\n        This corresponds to the term N_{<k} in the sign calculation.\n        \"\"\"\n        if idx == 0:\n            return 0\n        mask = (1 << idx) - 1\n        return (b & mask).bit_count()\n\n    for ops in test_cases:\n        bp_current = bp_initial\n        bn_current = bn_initial\n        amplitude = 1\n\n        for species, op_type, index in ops:\n            if amplitude == 0:\n                break\n            \n            cross_term_exp = 0\n            if species == 'p':\n                state_to_act_on = bp_current\n            else:  # species == 'n'\n                state_to_act_on = bn_current\n                # The cross-term is the current number of protons\n                cross_term_exp = bp_current.bit_count()\n\n            is_occupied = (state_to_act_on >> index) & 1\n\n            if op_type == 'a':  # Annihilation\n                if not is_occupied:\n                    amplitude = 0\n                    continue\n                \n                local_exp = popcount_lt(state_to_act_on, index)\n                exponent = local_exp + cross_term_exp\n                if exponent % 2 != 0:\n                    amplitude *= -1\n                \n                # Update state by flipping the bit\n                if species == 'p':\n                    bp_current ^= (1 << index)\n                else:\n                    bn_current ^= (1 << index)\n\n            else:  # op_type == 'c', Creation\n                if is_occupied:\n                    amplitude = 0\n                    continue\n\n                local_exp = popcount_lt(state_to_act_on, index)\n                exponent = local_exp + cross_term_exp\n                if exponent % 2 != 0:\n                    amplitude *= -1\n                \n                # Update state by flipping the bit\n                if species == 'p':\n                    bp_current ^= (1 << index)\n                else:\n                    bn_current ^= (1 << index)\n\n        results.append(amplitude)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Obtaining eigenvalues and eigenvectors from the Hamiltonian matrix is a milestone, but not the end of the analysis. A critical part of computational nuclear physics is validating the physical quality of the resulting wavefunctions. This practice problem demonstrates a key diagnostic technique: checking for spurious center-of-mass motion, an artifact common in truncated harmonic oscillator bases. By calculating the expectation value of the center-of-mass Hamiltonian $\\langle H_{\\text{cm}} \\rangle$ for a CI state, you will learn how to quantify and interpret this contamination, ensuring the final results are physically meaningful .",
            "id": "3597197",
            "problem": "Consider a Configuration Interaction (CI) calculation in the valence space of the $sd$-shell for the nucleus $^{18}\\mathrm{O}$ built on top of a doubly closed $^{16}\\mathrm{O}$ core. The active particles are the two valence neutrons in the $sd$-shell. Assume a harmonic-oscillator single-particle basis with oscillator frequency $\\hbar\\Omega$ and mass number $A=18$. The center-of-mass Hamiltonian is defined as\n$$\nH_{\\text{cm}} \\equiv \\frac{\\mathbf{P}_{\\text{cm}}^{2}}{2 A m} + \\frac{1}{2} A m \\Omega^{2} \\mathbf{R}_{\\text{cm}}^{2} - \\frac{3}{2}\\hbar\\Omega,\n$$\nwhere $\\mathbf{R}_{\\text{cm}} = \\frac{1}{A}\\sum_{i=1}^{A} \\mathbf{r}_i$ and $\\mathbf{P}_{\\text{cm}} = \\sum_{i=1}^{A} \\mathbf{p}_i$ are the center-of-mass coordinate and momentum, respectively, and $m$ is the nucleon mass. The expectation value $\\langle H_{\\text{cm}}\\rangle$ serves as a diagnostic for spurious center-of-mass contamination: exact factorization of intrinsic and center-of-mass motion in a harmonic oscillator implies $\\langle H_{\\text{cm}}\\rangle = 0$ for states with the center-of-mass in its ground configuration.\n\nYou are given a low-lying $J^{\\pi}=0^{+}$ CI eigenstate of $^{18}\\mathrm{O}$ as a normalized superposition of three two-neutron configurations in the $sd$-shell:\n$$\n|\\Psi_{0^{+}}\\rangle = c_{1}\\, \\big[(d_{5/2})^{2}\\big]_{J=0} + c_{2}\\, \\big[(s_{1/2})^{2}\\big]_{J=0} + c_{3}\\, \\big[(d_{3/2})^{2}\\big]_{J=0},\n$$\nwith amplitudes $c_{1} = 0.92$, $c_{2} = -0.30$, and $c_{3} = 0.25$. The matrix elements of $H_{\\text{cm}}$ in this truncated basis (including the $^{16}\\mathrm{O}$ core implicitly) have been precomputed in units of $\\hbar\\Omega$ and are\n$$\n\\frac{H_{\\text{cm}}}{\\hbar\\Omega} \\equiv M =\n\\begin{pmatrix}\n0.08 & -0.02 & 0.01 \\\\\n-0.02 & 0.12 & -0.015 \\\\\n0.01 & -0.015 & 0.10\n\\end{pmatrix},\n$$\nwhere the rows and columns are ordered as $\\big[(d_{5/2})^{2}\\big]_{J=0}$, $\\big[(s_{1/2})^{2}\\big]_{J=0}$, and $\\big[(d_{3/2})^{2}\\big]_{J=0}$, respectively. Take $\\hbar\\Omega = 14\\,\\mathrm{MeV}$, a typical value for this mass region.\n\nStarting from the definition of $\\langle H_{\\text{cm}}\\rangle$ as a quantum expectation value of a Hermitian operator in a CI state, compute the expectation value $\\langle H_{\\text{cm}} \\rangle$ for the given $|\\Psi_{0^{+}}\\rangle$. Use the provided amplitudes and matrix elements and account for normalization of $|\\Psi_{0^{+}}\\rangle$ if needed. Express the final energy in $\\mathrm{MeV}$ and round your answer to four significant figures. Based on the value you obtain, briefly diagnose the degree of spurious center-of-mass contamination in this state (no quantitative threshold is required).",
            "solution": "The problem asks for the expectation value of the center-of-mass Hamiltonian, $\\langle H_{\\text{cm}} \\rangle$, for a given Configuration Interaction (CI) state, $|\\Psi_{0^{+}}\\rangle$, of the $^{18}\\mathrm{O}$ nucleus.\n\nThe theoretical foundation for this calculation is the quantum mechanical definition of the expectation value of an operator $\\hat{O}$ for a state $|\\Psi\\rangle$, which is given by:\n$$\n\\langle \\hat{O} \\rangle = \\frac{\\langle \\Psi | \\hat{O} | \\Psi \\rangle}{\\langle \\Psi | \\Psi \\rangle}\n$$\nIf the state $|\\Psi\\rangle$ is normalized, then $\\langle \\Psi | \\Psi \\rangle = 1$, and the expression simplifies to $\\langle \\hat{O} \\rangle = \\langle \\Psi | \\hat{O} | \\Psi \\rangle$.\n\nThe given CI state is a superposition of three basis states:\n$$\n|\\Psi_{0^{+}}\\rangle = c_{1}\\, |\\phi_1\\rangle + c_{2}\\, |\\phi_2\\rangle + c_{3}\\, |\\phi_3\\rangle\n$$\nwhere the basis states are $|\\phi_1\\rangle = \\big[(d_{5/2})^{2}\\big]_{J=0}$, $|\\phi_2\\rangle = \\big[(s_{1/2})^{2}\\big]_{J=0}$, and $|\\phi_3\\rangle = \\big[(d_{3/2})^{2}\\big]_{J=0}$. The amplitudes are given as $c_{1} = 0.92$, $c_{2} = -0.30$, and $c_{3} = 0.25$.\n\nFirst, we must verify the normalization of the state $|\\Psi_{0^{+}}\\rangle$. The problem states it is a \"normalized superposition\", but a meticulous check is required. The norm-squared of the state is $\\langle\\Psi_{0^{+}}|\\Psi_{0^{+}}\\rangle = c_{1}^{2} + c_{2}^{2} + c_{3}^{2}$, assuming the basis states $\\{|\\phi_i\\rangle\\}$ are orthonormal.\n$$\n\\langle\\Psi_{0^{+}}|\\Psi_{0^{+}}\\rangle = (0.92)^{2} + (-0.30)^{2} + (0.25)^{2} = 0.8464 + 0.0900 + 0.0625 = 0.9989\n$$\nSince $\\langle\\Psi_{0^{+}}|\\Psi_{0^{+}}\\rangle = 0.9989 \\neq 1$, the state as defined by the provided coefficients is not strictly normalized. This is likely due to rounding of the coefficients in the problem statement. To ensure correctness, we must use the general formula for the expectation value, which includes the norm in the denominator.\n\nIn the provided basis, the state $|\\Psi_{0^{+}}\\rangle$ can be represented by a column vector of its coefficients:\n$$\n\\mathbf{c} = \\begin{pmatrix} c_{1} \\\\ c_{2} \\\\ c_{3} \\end{pmatrix} = \\begin{pmatrix} 0.92 \\\\ -0.30 \\\\ 0.25 \\end{pmatrix}\n$$\nThe operator $H_{\\text{cm}}$ is represented by a matrix $H_{ij} = \\langle \\phi_i | H_{\\text{cm}} | \\phi_j \\rangle$. The problem provides the dimensionless matrix $M = H_{\\text{cm}}/\\hbar\\Omega$. Thus, the matrix for $H_{\\text{cm}}$ is $H = (\\hbar\\Omega)M$.\n$$\nM = \\begin{pmatrix}\n0.08 & -0.02 & 0.01 \\\\\n-0.02 & 0.12 & -0.015 \\\\\n0.01 & -0.015 & 0.10\n\\end{pmatrix}\n$$\nThe expectation value can now be computed using matrix algebra. Since the coefficients $c_i$ are real, the bra $\\langle\\Psi_{0^{+}}|$ is represented by the transpose of the column vector, $\\mathbf{c}^{T}$.\n$$\n\\langle H_{\\text{cm}} \\rangle = \\frac{\\langle\\Psi_{0^{+}}|H_{\\text{cm}}|\\Psi_{0^{+}}\\rangle}{\\langle\\Psi_{0^{+}}|\\Psi_{0^{+}}\\rangle} = \\frac{\\mathbf{c}^{T} H \\mathbf{c}}{\\mathbf{c}^{T} \\mathbf{c}} = (\\hbar\\Omega) \\frac{\\mathbf{c}^{T} M \\mathbf{c}}{\\mathbf{c}^{T} \\mathbf{c}}\n$$\nWe have already calculated the denominator: $\\mathbf{c}^{T}\\mathbf{c} = 0.9989$.\n\nNow, we compute the numerator, $\\mathcal{N} = \\mathbf{c}^{T} M \\mathbf{c}$:\n$$\n\\mathcal{N} = \\begin{pmatrix} 0.92 & -0.30 & 0.25 \\end{pmatrix}\n\\begin{pmatrix}\n0.08 & -0.02 & 0.01 \\\\\n-0.02 & 0.12 & -0.015 \\\\\n0.01 & -0.015 & 0.10\n\\end{pmatrix}\n\\begin{pmatrix} 0.92 \\\\ -0.30 \\\\ 0.25 \\end{pmatrix}\n$$\nFirst, we compute the matrix-vector product $M\\mathbf{c}$:\n$$\nM\\mathbf{c} = \\begin{pmatrix}\n(0.08)(0.92) + (-0.02)(-0.30) + (0.01)(0.25) \\\\\n(-0.02)(0.92) + (0.12)(-0.30) + (-0.015)(0.25) \\\\\n(0.01)(0.92) + (-0.015)(-0.30) + (0.10)(0.25)\n\\end{pmatrix} = \\begin{pmatrix}\n0.0736 + 0.006 + 0.0025 \\\\\n-0.0184 - 0.036 - 0.00375 \\\\\n0.0092 + 0.0045 + 0.025\n\\end{pmatrix} = \\begin{pmatrix}\n0.0821 \\\\\n-0.05815 \\\\\n0.0387\n\\end{pmatrix}\n$$\nNext, we compute the dot product $\\mathbf{c}^{T}(M\\mathbf{c})$:\n$$\n\\mathcal{N} = (0.92)(0.0821) + (-0.30)(-0.05815) + (0.25)(0.0387)\n$$\n$$\n\\mathcal{N} = 0.075532 + 0.017445 + 0.009675 = 0.102652\n$$\nNow we can compute the expectation value. We are given $\\hbar\\Omega = 14\\,\\mathrm{MeV}$.\n$$\n\\langle H_{\\text{cm}} \\rangle = (14\\,\\mathrm{MeV}) \\frac{0.102652}{0.9989} \\approx (14\\,\\mathrm{MeV}) \\times 0.10276504\n$$\n$$\n\\langle H_{\\text{cm}} \\rangle \\approx 1.43871056\\,\\mathrm{MeV}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\langle H_{\\text{cm}} \\rangle \\approx 1.439\\,\\mathrm{MeV}\n$$\nFor the diagnosis: The center-of-mass Hamiltonian $H_{\\text{cm}}$ for a harmonic oscillator basis has a spectrum of $N_{\\text{cm}}\\hbar\\Omega$, where $N_{\\text{cm}} = 0, 1, 2, ...$ corresponds to the quanta of center-of-mass excitation. A physical, low-lying nuclear state should have its center-of-mass motion in the ground state ($N_{\\text{cm}}=0$), for which the energy is zero, and thus $\\langle H_{\\text{cm}}\\rangle=0$. The calculated value of $\\langle H_{\\text{cm}}\\rangle \\approx 1.439\\,\\mathrm{MeV}$ is non-zero, indicating that the CI wavefunction $|\\Psi_{0^{+}}\\rangle$ is not an eigenstate of $H_{\\text{cm}}$ with eigenvalue zero. It is a superposition of different center-of-mass states, a phenomenon known as spurious center-of-mass contamination. The magnitude of this energy, while small relative to the oscillator energy $\\hbar\\Omega = 14\\,\\mathrm{MeV}$, indicates a noticeable degree of contamination, which is a typical artifact of shell-model calculations in a truncated single-particle space.",
            "answer": "$$\\boxed{1.439}$$"
        }
    ]
}