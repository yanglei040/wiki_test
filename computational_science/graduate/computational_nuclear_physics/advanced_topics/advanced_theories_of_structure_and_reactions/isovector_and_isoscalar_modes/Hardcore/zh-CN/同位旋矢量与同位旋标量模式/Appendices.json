{
    "hands_on_practices": [
        {
            "introduction": "许多核多体计算（如随机相近似，RPA）的主要输出是强度函数，它详细描述了原子核如何在一系列能量范围内响应外部探针。为了将此理论输出与物理可观测量联系起来并表征集体运动，我们计算了该分布的能量加权矩，即所谓的求和规则。这项练习  提供了将强度函数的形式化定义转化为计算算法的动手实践，以计算诸如非能量加权（$m_0$）、能量加权（$m_1$）和能量逆加权（$m_{-1}$）求和规则等关键量，这些量分别表征了集体运动的总强度、平均激发能和核极化率。",
            "id": "3566376",
            "problem": "考虑一个在非相对论性Skyrme能量密度泛函(EDF)框架下，通过随机相位近似(RPA)处理的等标量单极算符 $F = \\sum_{i=1}^{A} r_i^2$。在线性响应理论中，激发谱由具有正能量 $E_n  0$ 和跃迁强度 $B_n = \\left|\\langle n | F | 0 \\rangle \\right|^2$ 的离散RPA模来表征。相关的强度函数为 $S_F(E) = \\sum_{n} B_n \\, \\delta(E - E_n)$，能量矩（求和规则）对任意实数 $k$ 定义为 $m_k = \\int_0^\\infty E^k \\, S_F(E) \\, dE$。非能量加权、能量加权和逆能量加权求和规则分别对应于 $m_0$、$m_1$ 和 $m_{-1}$。质心能量定义为 $E_c = m_1/m_0$，约束能量定义为 $E_{\\text{con}} = \\sqrt{m_1/m_{-1}}$。\n\n从上面强度函数和能量矩的基本定义出发，推导 $m_0$、$m_1$ 和 $m_{-1}$ 关于有限组模能量 $E_n$ 和强度 $B_n$ 的离散表达式。然后实现一个算法，为几个测试用例计算 $m_0$、$m_1$、$m_{-1}$、质心能量 $E_c$ 和约束能量 $E_{\\text{con}}$。您的算法必须仅使用离散数据 $\\{(E_n, B_n)\\}$，并且不得假定任何特定于某个Skyrme参数化的闭合形式表达式。\n\n科学和数值要求：\n- 每个能量 $E_n$ 必须为严格正值，并以 $\\mathrm{MeV}$ 为单位。\n- 每个强度 $B_n$ 必须为非负值，并以 $\\mathrm{fm}^4$ 为单位。\n- 求和规则的单位为：$m_0$ 的单位是 $\\mathrm{fm}^4$，$m_1$ 的单位是 $\\mathrm{MeV}\\cdot\\mathrm{fm}^4$，$m_{-1}$ 的单位是 $\\mathrm{fm}^4/\\mathrm{MeV}$。\n- 质心能量 $E_c$ 和约束能量 $E_{\\text{con}}$ 必须以 $\\mathrm{MeV}$ 为单位。\n- 所有输出必须四舍五入到六位小数。\n\n测试套件：\n- 用例1（重核中典型的多峰巨单极共振）：$E = [10.5, 13.8, 15.6]$ $\\mathrm{MeV}$，$B = [200.0, 600.0, 250.0]$ $\\mathrm{fm}^4$。\n- 用例2（单个尖锐模）：$E = [14.0]$ $\\mathrm{MeV}$，$B = [1000.0]$ $\\mathrm{fm}^4$。\n- 用例3（与低能态的混合）：$E = [0.5, 17.0, 22.0]$ $\\mathrm{MeV}$，$B = [1.0, 800.0, 150.0]$ $\\mathrm{fm}^4$。\n- 用例4（用于测试数值稳定性的低强度）：$E = [12.345, 23.456, 34.567]$ $\\mathrm{MeV}$，$B = [0.001, 0.002, 0.003]$ $\\mathrm{fm}^4$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个格式为 $[m_0, m_1, m_{-1}, E_c, E_{\\text{con}}]$ 的内部列表，使用指定的单位并四舍五入到六位小数。例如，整体输出应类似于 $[[x_{11},x_{12},x_{13},x_{14},x_{15}],[x_{21},x_{22},x_{23},x_{24},x_{25}],\\dots]$，不含任何附加文本。",
            "solution": "问题陈述的评估如下。\n\n### 步骤1：提取已知条件\n- **算符**：等标量单极算符 $F = \\sum_{i=1}^{A} r_i^2$。\n- **框架**：非相对论性Skyrme能量密度泛函(EDF)及随机相位近似(RPA)。\n- **激发谱**：具有能量 $E_n  0$ 和跃迁强度 $B_n = \\left|\\langle n | F | 0 \\rangle \\right|^2$ 的离散RPA模。\n- **强度函数**：$S_F(E) = \\sum_{n} B_n \\, \\delta(E - E_n)$。\n- **能量矩（求和规则）**：$m_k = \\int_0^\\infty E^k \\, S_F(E) \\, dE$，对任意实数 $k$。\n- **特定矩**：$m_0$ (非能量加权)，$m_1$ (能量加权)，$m_{-1}$ (逆能量加权)。\n- **导出量**：质心能量 $E_c = m_1/m_0$，约束能量 $E_{\\text{con}} = \\sqrt{m_1/m_{-1}}$。\n- **任务**：从有限的模集 $\\{(E_n, B_n)\\}$ 推导 $m_0$、$m_1$、$m_{-1}$ 的离散表达式。实现一个算法来计算 $m_0$、$m_1$、$m_{-1}$、$E_c$ 和 $E_{\\text{con}}$。\n- **数值要求**：\n    - $E_n  0$，单位为 $\\mathrm{MeV}$。\n    - $B_n \\ge 0$，单位为 $\\mathrm{fm}^4$。\n    - $m_0$ 的单位：$\\mathrm{fm}^4$。\n    - $m_1$ 的单位：$\\mathrm{MeV}\\cdot\\mathrm{fm}^4$。\n    - $m_{-1}$ 的单位：$\\mathrm{fm}^4/\\mathrm{MeV}$。\n    - $E_c$、$E_{\\text{con}}$ 的单位：$\\mathrm{MeV}$。\n    - 输出必须四舍五入到六位小数。\n- **测试套件**：\n    - 用例1：$E = [10.5, 13.8, 15.6]$ $\\mathrm{MeV}$，$B = [200.0, 600.0, 250.0]$ $\\mathrm{fm}^4$。\n    - 用例2：$E = [14.0]$ $\\mathrm{MeV}$，$B = [1000.0]$ $\\mathrm{fm}^4$。\n    - 用例3：$E = [0.5, 17.0, 22.0]$ $\\mathrm{MeV}$，$B = [1.0, 800.0, 150.0]$ $\\mathrm{fm}^4$。\n    - 用例4：$E = [12.345, 23.456, 34.567]$ $\\mathrm{MeV}$，$B = [0.001, 0.002, 0.003]$ $\\mathrm{fm}^4$。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学性**：该问题植根于标准的原子核结构理论。等标量单极算符、强度函数、RPA和求和规则的定义在原子核巨共振的背景下都是标准且正确的。所涉及的物理量的单位也是正确的。\n2.  **适定性**：问题定义清晰。它要求从连续定义推导离散公式，并将其应用于特定的数值数据。输入数据是一组有限的离散模 $\\{(E_n, B_n)\\}$，所需的输出（$m_0, m_1, m_{-1}, E_c, E_{\\text{con}}$）由这些输入和所提供的定义唯一确定。约束条件 $E_n  0$ 和 $B_n \\ge 0$ 确保了这些物理量是适定且具有物理意义的。\n3.  **客观性**：问题以精确、正式的语言陈述，没有任何主观性或模糊性。\n4.  **无其他缺陷**：问题是可形式化的、自洽的，且测试数据在物理上是合理的。它要求应用基本定义，这在计算背景下是一项有效且非平凡的任务。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整的解决方案。\n\n### 推导与算法设计\n\n出发点是强度函数 $S_F(E)$ 的k阶能量矩的定义：\n$$\nm_k = \\int_0^\\infty E^k \\, S_F(E) \\, dE\n$$\n离散谱的强度函数由狄拉克δ函数的和给出：\n$$\nS_F(E) = \\sum_{n=1}^{N} B_n \\, \\delta(E - E_n)\n$$\n其中 $N$ 是离散模的有限数量，$E_n$ 是第 $n$ 个模的能量，$B_n$ 是其跃迁强度。\n\n将 $S_F(E)$ 的表达式代入 $m_k$ 的积分中，我们得到：\n$$\nm_k = \\int_0^\\infty E^k \\left( \\sum_{n=1}^{N} B_n \\, \\delta(E - E_n) \\right) dE\n$$\n由于求和是针对有限数量的模，我们可以交换求和与积分的顺序：\n$$\nm_k = \\sum_{n=1}^{N} B_n \\int_0^\\infty E^k \\, \\delta(E - E_n) \\, dE\n$$\n利用狄拉克δ函数的筛选性质，即 $\\int f(x) \\delta(x-a) dx = f(a)$，该积分的计算结果为 $E_n^k$。条件 $E_n  0$ 确保了积分域 $[0, \\infty)$ 包含了所有的模能量。\n因此，k阶矩的离散公式为：\n$$\nm_k = \\sum_{n=1}^{N} B_n E_n^k\n$$\n\n从这个通用结果，我们可以推导出所需特定矩的表达式：\n1.  **非能量加权求和规则 ($m_0$)**：对于 $k=0$，我们有 $E_n^0 = 1$。\n    $$\n    m_0 = \\sum_{n=1}^{N} B_n E_n^0 = \\sum_{n=1}^{N} B_n\n    $$\n2.  **能量加权求和规则 ($m_1$)**：对于 $k=1$，我们有 $E_n^1 = E_n$。\n    $$\n    m_1 = \\sum_{n=1}^{N} B_n E_n^1 = \\sum_{n=1}^{N} B_n E_n\n    $$\n3.  **逆能量加权求和规则 ($m_{-1}$)**：对于 $k=-1$，我们有 $E_n^{-1} = 1/E_n$。\n    $$\n    m_{-1} = \\sum_{n=1}^{N} B_n E_n^{-1} = \\sum_{n=1}^{N} \\frac{B_n}{E_n}\n    $$\n    这个表达式是适定的，因为问题规定所有模能量 $E_n$ 都严格为正 ($E_n  0$)。\n\n接下来，我们使用其定义推导质心能量和约束能量的离散表达式。\n1.  **质心能量 ($E_c$)**：\n    $$\n    E_c = \\frac{m_1}{m_0} = \\frac{\\sum_{n=1}^{N} B_n E_n}{\\sum_{n=1}^{N} B_n}\n    $$\n    对于给定的测试用例，强度 $B_n$ 是非负的且不全为零，因此分母 $m_0$ 严格为正。\n2.  **约束能量 ($E_{\\text{con}}$)**：\n    $$\n    E_{\\text{con}} = \\sqrt{\\frac{m_1}{m_{-1}}} = \\sqrt{\\frac{\\sum_{n=1}^{N} B_n E_n}{\\sum_{n=1}^{N} \\frac{B_n}{E_n}}}\n    $$\n    由于 $B_n \\ge 0$ 和 $E_n  0$，分子 $m_1$ 和分母 $m_{-1}$ 都是非负的。对于任何非平凡谱（其中至少有一个 $B_n  0$），两者都将严格为正，从而确保平方根内的参数是适定且为正的。\n\n### 计算算法\n该算法将按如下方式处理每个测试用例：\n1.  输入：一个模能量列表 $E = [E_1, E_2, \\dots, E_N]$ 和一个对应的跃迁强度列表 $B = [B_1, B_2, \\dots, B_N]$。\n2.  将三个变量 `sum_m0`、`sum_m1`、`sum_m_minus_1` 初始化为 $0.0$。\n3.  从 $n=1$ 迭代到 $N$：\n    a. 设 $E_n$ 为当前模的能量，$B_n$ 为其强度。\n    b. 通过加上 $B_n$ 更新 `sum_m0`。\n    c. 通过加上 $B_n \\times E_n$ 更新 `sum_m1`。\n    d. 通过加上 $B_n / E_n$ 更新 `sum_m_minus_1`。\n4.  循环结束后，这些变量保存了矩的值：$m_0 = \\text{sum\\_m0}$，$m_1 = \\text{sum\\_m1}$ 和 $m_{-1} = \\text{sum\\_m\\_minus\\_1}$。\n5.  计算质心能量：$E_c = m_1 / m_0$。\n6.  计算约束能量：$E_{\\text{con}} = \\sqrt{m_1 / m_{-1}}$。\n7.  收集五个结果：$[m_0, m_1, m_{-1}, E_c, E_{\\text{con}}]$。\n8.  将这五个值中的每一个都四舍五入到六位小数。\n9.  存储四舍五入后的结果。\n10. 对所有测试用例重复此过程，并将最终输出格式化为列表的列表。\n使用像NumPy这样的库进行矢量化计算对于此任务非常高效。能量数组 $E$ 和强度数组 $B$ 允许通过逐元素操作和最终的求和规約来计算这些总和。\n- $m_0 = \\text{sum}(B)$\n- $m_1 = \\text{sum}(E \\times B)$\n- $m_{-1} = \\text{sum}(B / E)$\n这种方法将在最终的代码中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes sum rules and derived energies for nuclear excitation spectra.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (typical multi-peak giant monopole resonance)\n        {'E': [10.5, 13.8, 15.6], 'B': [200.0, 600.0, 250.0]},\n        # Case 2 (single sharp mode)\n        {'E': [14.0], 'B': [1000.0]},\n        # Case 3 (mixture with a low-energy state)\n        {'E': [0.5, 17.0, 22.0], 'B': [1.0, 800.0, 150.0]},\n        # Case 4 (small strengths)\n        {'E': [12.345, 23.456, 34.567], 'B': [0.001, 0.002, 0.003]},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Convert lists to NumPy arrays for vectorized calculations\n        E = np.array(case['E'])\n        B = np.array(case['B'])\n\n        # Calculate the moments m_0, m_1, and m_{-1}\n        # m_k = sum(B_n * E_n^k)\n        \n        # k = 0: m_0 = sum(B_n)\n        m0 = np.sum(B)\n        \n        # k = 1: m_1 = sum(B_n * E_n)\n        m1 = np.sum(B * E)\n        \n        # k = -1: m_{-1} = sum(B_n / E_n)\n        # The problem guarantees E_n  0, so no division by zero.\n        m_minus_1 = np.sum(B / E)\n        \n        # Check for m0 being zero to avoid division by zero for Ec.\n        # Although not expected from the problem's test data.\n        if m0 == 0:\n            # If total strength is zero, all strengths are zero, so m1 is also zero.\n            # Ec is indeterminate (0/0), but 0 is a reasonable assignment.\n            Ec = 0.0\n        else:\n            # Centroid energy: Ec = m_1 / m_0\n            Ec = m1 / m0\n\n        # Check for m_minus_1 being zero for Econ.\n        if m_minus_1 == 0:\n            # If m_minus_1 is 0, m1 must also be 0.\n            # Econ is indeterminate, assigned 0.\n            Econ = 0.0\n        else:\n            # Constrained energy: Econ = sqrt(m_1 / m_{-1})\n            # The argument to sqrt is non-negative as m1 and m_minus_1 are sums\n            # of products/ratios of non-negative numbers.\n            Econ = math.sqrt(m1 / m_minus_1)\n        \n        # Round all results to six decimal places\n        case_results = [\n            round(m0, 6),\n            round(m1, 6),\n            round(m_minus_1, 6),\n            round(Ec, 6),\n            round(Econ, 6)\n        ]\n        \n        results.append(case_results)\n\n    # Format the final output string as a list of lists without spaces.\n    # The default string representation of a list of lists is '[[], [], ...]',\n    # but it includes spaces. We remove them for the exact format.\n    output_str = str(results).replace(\" \", \"\")\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "前一个练习侧重于同位旋标量模式，而本实践将我们的注意力转向纯同位旋矢量激发：Gamow-Teller（GT）跃迁，这对于理解贝塔衰变和中微子-原子核相互作用至关重要。分析这些跃迁的有力工具是 Ikeda 求和规则，这是一个不依赖于模型的理论关系，它约束了中子到质子（$S_{-}$）和质子到中子（$S_{+}$）的总 GT 强度之差。这项练习  将指导您通过实施这一基本求和规则来分析核物理学中一个长期存在的难题——“GT 强度淬灭”现象，并通过应用唯象校正来量化其影响。",
            "id": "3566332",
            "problem": "你的任务是实现一个程序，通过对粒子-振动耦合 (Particle–Vibration Coupling, PVC) 或两体流 (Two–Body Currents, 2BC) 引起的有效算符修正进行建模，来量化同位旋矢量电荷交换模式中 Gamow–Teller (GT) 强度的淬灭，并将计算结果与不依赖于模型的 Ikeda 求和规则期望值进行比较。从核多体理论的基本基础开始：Gamow–Teller 算符的定义、核本征态的完备性，以及 Pauli 自旋和同位旋算符的代数。具体来说，使用由 GT 算符 $\\hat{O}_{\\mathrm{GT},\\pm}=\\sum_{i=1}^{A}\\vec{\\sigma}(i)\\tau_{\\pm}(i)$ 构建的非能量加权强度和，其中 $\\vec{\\sigma}$ 是 Pauli 自旋算符，$\\tau_{\\pm}$ 是同位旋上升和下降算符，分别将中子转换为质子，反之亦然。从这些基础和相关的对易关系，可以推导出中子到质子和质子到中子分支之间 GT 强度差的一个不依赖于模型的关系，该关系用中子数 $N$ 和质子数 $Z$ 表示。除了下面明确说明的情况外，你的程序不得假设任何超出这些基本定义的特定核结构模型。\n\n将由粒子-振动耦合 (PVC) 或两体流 (2BC) 引起的淬灭建模为通过一个有效因子 $q$（其中 $0  q \\leq 1$）对 GT 算符的重整化，使得矩阵元减小一个因子 $q$，因此非能量加权强度（即矩阵元平方和）减小一个因子 $q^{2}$。假设给定原子核的未淬灭总同位旋矢量 GT 强度 $S_{\\mathrm{tot}}^{(0)}$ 由一个独立的微观计算（例如，在截断空间内）提供，并且各个未淬灭的分支和 $S_{-}^{(0)}$ 和 $S_{+}^{(0)}$ 通过将 $S_{\\mathrm{tot}}^{(0)}$ 与上述基础理论所蕴含的基本差值关系相结合而唯一确定。然后应用有效算符重整化以获得淬灭强度 $S_{-}^{(q)}$ 和 $S_{+}^{(q)}$，并将淬灭后的强度差与从基础理论推导出的不依赖于模型的期望值进行比较。\n\n对于每个测试用例，你的程序必须执行以下操作：\n- 使用基础理论，根据 $N$ 和 $Z$ 确定未淬灭强度之间的非能量加权差值。\n- 将此差值与给定的总未淬灭强度 $S_{\\mathrm{tot}}^{(0)}$ 相结合，以确定 $S_{-}^{(0)}$ 和 $S_{+}^{(0)}$，而不引入任何额外假设。\n- 在算符层面应用淬灭因子 $q$（代表 PVC 或 2BC），并将其影响传播到强度上。\n- 报告：\n  1. 淬灭后的总强度 $S_{\\mathrm{tot}}^{(q)}$，\n  2. 以 $N$ 和 $Z$ 表示的强度差的不依赖于模型的期望值，\n  3. 淬灭后的强度差与该期望值的偏差，定义为 $\\Delta \\equiv \\left(S_{-}^{(q)}-S_{+}^{(q)}\\right)-\\left(\\text{来自基础理论的期望值}\\right)$。\n\n所有输出均为无量纲。对于数值报告，将所有浮点输出四舍五入到小数点后恰好六位。\n\n测试套件：\n为以下参数集提供结果，每个参数集以元组 $(N,Z,S_{\\mathrm{tot}}^{(0)},\\text{corr},q)$ 的形式给出，其中 $\\text{corr}\\in\\{\\text{pvc},\\text{2bc}\\}$ 表示重整化的物理解释，$q$ 是相应的有效算符因子：\n- 案例 1：$(N,Z,S_{\\mathrm{tot}}^{(0)},\\text{corr},q)=(28,20,40.0,\\text{pvc},0.74)$。\n- 案例 2：$(N,Z,S_{\\mathrm{tot}}^{(0)},\\text{corr},q)=(28,20,40.0,\\text{2bc},0.90)$。\n- 案例 3：$(N,Z,S_{\\mathrm{tot}}^{(0)},\\text{corr},q)=(28,28,20.0,\\text{pvc},0.75)$。\n- 案例 4：$(N,Z,S_{\\mathrm{tot}}^{(0)},\\text{corr},q)=(50,50,25.0,\\text{2bc},0.90)$。\n- 案例 5：$(N,Z,S_{\\mathrm{tot}}^{(0)},\\text{corr},q)=(50,40,60.0,\\text{pvc},0.60)$。\n- 案例 6：$(N,Z,S_{\\mathrm{tot}}^{(0)},\\text{corr},q)=(28,20,35.0,\\text{2bc},1.00)$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个测试用例生成一个三元素列表 $[S_{\\mathrm{tot}}^{(q)},\\ \\text{expectation},\\ \\Delta]$，其中每个元素都四舍五入到小数点后六位。例如：$[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],\\ldots]$。",
            "solution": "该问题要求基于核多体理论的基本原理和一个唯象淬灭模型，计算与原子核中 Gamow–Teller (GT) 强度淬灭相关的量。解决方案的构建首先是建立理论框架，然后推导出必要的计算公式。\n\n### 1. 基本原理与定义\n\n问题的基础在于 Gamow–Teller 跃迁算符和一个不依赖于模型的求和规则。\n\n_Gamow–Teller 算符_：用于同位旋上升 ($\\beta^{-}$) 和同位旋下降 ($\\beta^{+}$) 跃迁的 GT 算符是自旋空间中的矢量算符，定义为：\n$$\n\\hat{O}_{\\mathrm{GT},+} = \\sum_{i=1}^{A} \\vec{\\sigma}(i) \\tau_{+}(i)\n$$\n$$\n\\hat{O}_{\\mathrm{GT},-} = \\sum_{i=1}^{A} \\vec{\\sigma}(i) \\tau_{-}(i)\n$$\n其中 $A$ 是原子核中的核子总数，$\\vec{\\sigma}(i)$ 是第 $i$ 个核子的 Pauli 自旋矩阵矢量，$\\tau_{\\pm}(i)$ 是同位旋上升/下降算符。算符 $\\tau_{+}$ 将一个中子转换为质子，而 $\\tau_{-}$ 将一个质子转换为中子。\n\n_Gamow–Teller 强度_：从一个初态 $|i\\rangle$ 到所有可能的末态 $|f\\rangle$ 的跃迁的非能量加权 GT 强度是 GT 算符矩阵元平方的和。$\\beta^{-}$ 和 $\\beta^{+}$ 分支的强度分别表示为 $S_{-}$ 和 $S_{+}$。按照惯例，$S_{-}$ 对应于算符 $\\hat{O}_{\\mathrm{GT},+}$，$S_{+}$ 对应于算符 $\\hat{O}_{\\mathrm{GT},-}$。\n$$\nS_{-} = \\sum_{f} |\\langle f | \\hat{O}_{\\mathrm{GT},+} | i \\rangle|^2\n$$\n$$\nS_{+} = \\sum_{f} |\\langle f | \\hat{O}_{\\mathrm{GT},-} | i \\rangle|^2\n$$\n在本问题中，我们从表示为 $S_{-}^{(0)}$ 和 $S_{+}^{(0)}$ 的未淬灭强度开始。\n\n### 2. Ikeda 求和规则\n\n一个不依赖于模型的求和规则，即 Ikeda 求和规则，可以从 GT 算符的对易关系推导出来。利用末态的完备性 $\\sum_f |f\\rangle\\langle f| = \\mathbb{I}$，强度差可以表示为对易子的基态期望值：\n$$\nS_{-}^{(0)} - S_{+}^{(0)} = \\langle i | \\left( \\hat{O}_{\\mathrm{GT},+}^{\\dagger} \\hat{O}_{\\mathrm{GT},+} - \\hat{O}_{\\mathrm{GT},-}^{\\dagger} \\hat{O}_{\\mathrm{GT},-} \\right) | i \\rangle\n$$\n注意到 $\\hat{O}_{\\mathrm{GT},+}^{\\dagger} = \\hat{O}_{\\mathrm{GT},-}$ 和 $\\hat{O}_{\\mathrm{GT},-}^{\\dagger} = \\hat{O}_{\\mathrm{GT},+}$, 上式变为：\n$$\nS_{-}^{(0)} - S_{+}^{(0)} = \\langle i | [\\hat{O}_{\\mathrm{GT},-}, \\hat{O}_{\\mathrm{GT},+}] | i \\rangle\n$$\n该对易子的计算结果为：\n$$\n[\\hat{O}_{\\mathrm{GT},-}, \\hat{O}_{\\mathrm{GT},+}] = \\sum_{j,k} [\\vec{\\sigma}(j)\\tau_{-}(j), \\vec{\\sigma}(k)\\tau_{+}(k)] = \\sum_{j} (\\vec{\\sigma}(j) \\cdot \\vec{\\sigma}(j)) [\\tau_{-}(j), \\tau_{+}(j)]\n$$\n使用恒等式 $\\vec{\\sigma} \\cdot \\vec{\\sigma} = 3$ 和 $[\\tau_{-}, \\tau_{+}] = -2\\tau_{z}$，我们得到：\n$$\n[\\hat{O}_{\\mathrm{GT},-}, \\hat{O}_{\\mathrm{GT},+}] = \\sum_{j} (3)(-2\\tau_{z}(j)) = -6 \\sum_{j} \\tau_{z}(j) = -6 \\hat{T}_{z}\n$$\n对于一个有 $N$ 个中子和 $Z$ 个质子的原子核，总同位旋投影算符 $\\hat{T}_{z}$ 的本征值为 $\\frac{1}{2}(N-Z)$。因此，期望值为：\n$$\n\\langle i | -6 \\hat{T}_{z} | i \\rangle = -6 \\left(\\frac{N-Z}{2}\\right) = -3(N-Z)\n$$\n这就得到了 Ikeda 求和规则，即强度差的不依赖于模型的期望值：\n$$\nS_{-}^{(0)} - S_{+}^{(0)} = 3(N-Z)\n$$\n\n### 3. 未淬灭分支强度的确定\n\n问题给出了总的未淬灭 GT 强度 $S_{\\mathrm{tot}}^{(0)}$，它是各分支强度的和：\n$$\nS_{\\mathrm{tot}}^{(0)} = S_{-}^{(0)} + S_{+}^{(0)}\n$$\n我们现在得到一个关于两个未知数 $S_{-}^{(0)}$ 和 $S_{+}^{(0)}$ 的二元线性方程组：\n1. $S_{-}^{(0)} + S_{+}^{(0)} = S_{\\mathrm{tot}}^{(0)}$\n2. $S_{-}^{(0)} - S_{+}^{(0)} = 3(N-Z)$\n\n解此方程组可得未淬灭的分支强度：\n$$\nS_{-}^{(0)} = \\frac{1}{2} \\left( S_{\\mathrm{tot}}^{(0)} + 3(N-Z) \\right)\n$$\n$$\nS_{+}^{(0)} = \\frac{1}{2} \\left( S_{\\mathrm{tot}}^{(0)} - 3(N-Z) \\right)\n$$\n这些强度必须为非负值，这施加了物理约束 $S_{\\mathrm{tot}}^{(0)} \\ge |3(N-Z)|$。\n\n### 4. 淬灭模型与输出计算\n\n由粒子-振动耦合 (PVC) 或两体流 (2BC) 引起的淬灭效应，通过一个有效因子 $q$（其中 $0  q \\leq 1$）对 GT 算符矩阵元进行重整化来建模。\n$$\n\\langle f | \\hat{O}_{\\mathrm{GT},\\pm}^{\\text{eff}} | i \\rangle = q \\langle f | \\hat{O}_{\\mathrm{GT},\\pm} | i \\rangle\n$$\n由于强度 $S_{\\pm}$ 是矩阵元平方的和，淬灭后的强度 $S_{\\pm}^{(q)}$ 与未淬灭的强度之间通过一个因子 $q^2$ 相关联：\n$$\nS_{-}^{(q)} = q^2 S_{-}^{(0)} \\quad \\text{and} \\quad S_{+}^{(q)} = q^2 S_{+}^{(0)}\n$$\n$q$ 的物理解释（PVC vs. 2BC）不改变数学处理过程。\n\n现在我们可以为每个测试用例 $(N, Z, S_{\\mathrm{tot}}^{(0)}, q)$ 推导出三个所需输出的表达式。\n\n1.  **淬灭后的总强度 $S_{\\mathrm{tot}}^{(q)}$**：\n    $$\n    S_{\\mathrm{tot}}^{(q)} = S_{-}^{(q)} + S_{+}^{(q)} = q^2 S_{-}^{(0)} + q^2 S_{+}^{(0)} = q^2 (S_{-}^{(0)} + S_{+}^{(0)}) = q^2 S_{\\mathrm{tot}}^{(0)}\n    $$\n\n2.  **强度差的不依赖于模型的期望值**：\n    这由 Ikeda 求和规则直接给出，该规则是从算符代数推导出的基本性质，并且独立于在截断空间内应用的淬灭模型。\n    $$\n    \\text{Expectation} = 3(N-Z)\n    $$\n\n3.  **偏差 $\\Delta$**：\n    偏差定义为淬灭后的强度差与不依赖于模型的期望值之间的差值。\n    $$\n    \\Delta = \\left(S_{-}^{(q)} - S_{+}^{(q)}\\right) - (\\text{Expectation})\n    $$\n    代入淬灭强度和期望值的表达式：\n    $$\n    \\Delta = \\left(q^2 S_{-}^{(0)} - q^2 S_{+}^{(0)}\\right) - 3(N-Z)\n    $$\n    提出因子 $q^2$ 并使用求和规则 $S_{-}^{(0)} - S_{+}^{(0)} = 3(N-Z)$：\n    $$\n    \\Delta = q^2 \\left(S_{-}^{(0)} - S_{+}^{(0)}\\right) - 3(N-Z) = q^2 \\left(3(N-Z)\\right) - 3(N-Z)\n    $$\n    这简化为偏差的最终表达式：\n    $$\n    \\Delta = (q^2 - 1) \\cdot 3(N-Z)\n    $$\n这组公式允许根据每个测试用例给定的参数直接计算所需的输出。所有输出都必须四舍五入到小数点后六位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nuclear physics problem for a given set of test cases.\n\n    The function calculates the quenched Gamow-Teller (GT) strength, the model-\n    independent Ikeda sum rule expectation, and the deviation of the quenched\n    strength difference from this expectation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, Z, S_tot_0, corr, q)\n    test_cases = [\n        (28, 20, 40.0, 'pvc', 0.74),\n        (28, 20, 40.0, '2bc', 0.90),\n        (28, 28, 20.0, 'pvc', 0.75),\n        (50, 50, 25.0, '2bc', 0.90),\n        (50, 40, 60.0, 'pvc', 0.60),\n        (28, 20, 35.0, '2bc', 1.00),\n    ]\n\n    result_strings = []\n    \n    for case in test_cases:\n        N, Z, S_tot_0, corr, q = case\n\n        # 1. Calculate the quenched total strength S_tot^(q)\n        # S_tot_q = q^2 * S_tot_0\n        S_tot_q = q**2 * S_tot_0\n\n        # 2. Calculate the model-independent expectation for the difference of strengths.\n        # This is the Ikeda sum rule: 3 * (N - Z)\n        expectation = 3.0 * (N - Z)\n\n        # 3. Calculate the deviation Delta.\n        # Delta = (S_-^(q) - S_+^(q)) - (expectation)\n        # Delta = q^2 * (S_-^(0) - S_+^(0)) - expectation\n        # Delta = q^2 * (3 * (N - Z)) - (3 * (N - Z))\n        # Delta = (q^2 - 1) * 3 * (N - Z)\n        delta = (q**2 - 1.0) * expectation\n\n        # Format each number in the result list to six decimal places\n        # as a string, and join them to form the inner list string.\n        # Example: \"[21.904000,24.000000,-10.857600]\"\n        case_result_str = f\"[{S_tot_q:.6f},{expectation:.6f},{delta:.6f}]\"\n        result_strings.append(case_result_str)\n\n    # Join the individual list strings with a comma and enclose in brackets for the final output format.\n    # Example: \"[[...],[...]]\"\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在前面练习的基础上，这最后一个实践融合了同位旋标量和同位旋矢量模式的概念，以进行比较分析，这是现代计算核物理中的一项常见任务。在这里，您将分解包含同位旋矢量和同位旋标量分量的电偶极（$E1$）响应，并比较高保真度的“从头算”（*ab initio*）模型与更唯象的能量密度泛函（EDF）模型的结果。这项练习  提供了一个实际例子，说明了如何通过分析预测的同位旋矢量和同位旋标量强度的差异，来作为一种强大的诊断工具，以识别理论模型中的特定缺陷，例如缺少某些三体力的贡献。",
            "id": "3566329",
            "problem": "您的任务是设计并实现一个数值程序，该程序使用简化的线性响应框架来模拟中等质量核中的电偶极（$E1$）响应，分离同位旋矢量和同位旋标量模式，并比较 *ab initio* 耦合簇（CC）计算（使用手征有效场论（EFT）相互作用）与能量密度泛函（EDF）计算得出的强度。目标是通过分析相对积分 $E1$ 强度，识别出与 EDF 中缺失的同位旋矢量三体贡献相符的缺陷。\n\n从以下基本依据和定义开始：\n\n- 在线性响应机制中，对于一个由基态 $\\lvert \\Psi_0 \\rangle$ 和在激发能 $\\{ \\omega_k \\}$ 处的离散激发态 $\\{ \\lvert \\Psi_k \\rangle \\}$ 描述的原子核，算符 $\\hat{O}$ 的强度函数为\n$$\nS_{\\hat{O}}(\\omega) = \\sum_{k} \\left| \\langle \\Psi_0 \\lvert \\hat{O} \\rvert \\Psi_k \\rangle \\right|^2 \\, \\delta(\\omega - \\omega_k).\n$$\n使用宽度为 $\\Gamma$ 的洛伦兹展宽，狄拉克 δ 函数被替换为\n$$\nL(\\omega; \\omega_k, \\Gamma) = \\frac{1}{\\pi}\\frac{\\Gamma}{(\\omega-\\omega_k)^2 + \\Gamma^2},\n$$\n并且在所有 $\\omega$ 上的能量积分强度保持为\n$$\n\\int_{0}^{\\infty} S_{\\hat{O}}(\\omega)\\, d\\omega = \\sum_{k} \\left| \\langle \\Psi_0 \\lvert \\hat{O} \\rvert \\Psi_k \\rangle \\right|^2,\n$$\n与 $\\Gamma$ 无关。\n\n- 考虑通过质子（$p$）和中子（$n$）的贡献分解为同位旋矢量和同位旋标量模式的电偶极（$E1$）算符。令 $Z$ 为质子数，$N$ 为中子数，$A = Z + N$ 为质量数。对于每个离散模式 $k$，为您提供了以飞米（$\\mathrm{fm}$）为单位的、扣除质心运动的有效质子和中子偶极振幅积分 $D_{p,k}$ 和 $D_{n,k}$。在这个简化模型中，同位旋矢量 $E1$ 矩阵元定义为\n$$\nM_{\\mathrm{IV},k} = e_p^{\\mathrm{IV}}\\, D_{p,k} + e_n^{\\mathrm{IV}}\\, D_{n,k},\n$$\n其有效电荷为\n$$\ne_p^{\\mathrm{IV}} = \\frac{N}{A}, \\quad e_n^{\\mathrm{IV}} = -\\frac{Z}{A}.\n$$\n同位旋标量 $E1$ 矩阵元（在此离散模型中代表压缩 $E1$ 的代理）定义为\n$$\nM_{\\mathrm{IS},k} = D_{p,k} + D_{n,k}.\n$$\n相应的离散强度为\n$$\nB_{\\mathrm{IV},k} = \\left| M_{\\mathrm{IV},k} \\right|^2, \\quad B_{\\mathrm{IS},k} = \\left| M_{\\mathrm{IS},k} \\right|^2,\n$$\n积分强度为\n$$\nS_{\\mathrm{IV}} = \\sum_{k} B_{\\mathrm{IV},k}, \\quad S_{\\mathrm{IS}} = \\sum_{k} B_{\\mathrm{IS},k}.\n$$\n所有强度必须以 $e^2\\,\\mathrm{fm}^2$ 为单位表示。能量必须以兆电子伏特（$\\mathrm{MeV}$）处理。本问题不涉及角度。\n\n- CC 和 EDF 预测之间的比较将针对积分强度 $S_{\\mathrm{IV}}$ 和 $S_{\\mathrm{IS}}$ 进行。为了模拟缺少同位旋矢量三体项的 EDF，通过一个混合规则为每个模式 $k$ 定义其质子和中子振幅积分\n$$\nD^{\\mathrm{EDF}}_{p,k} = (1-f)\\,D^{\\mathrm{CC}}_{p,k} + f\\,D^{\\mathrm{CC}}_{n,k}, \\quad\nD^{\\mathrm{EDF}}_{n,k} = (1-f)\\,D^{\\mathrm{CC}}_{n,k} + f\\,D^{\\mathrm{CC}}_{p,k},\n$$\n其中 $f \\in [0, 0.5]$ 是一个量化同位旋矢量淬灭的无量纲混合因子。这种混合降低了质子-中子差异，并选择性地抑制了同位旋矢量强度，同时保持同位旋标量总和 $D_{p,k}+D_{n,k}$ 不变。\n\n- 定义诊断量：\n    1. 同位旋矢量相对偏差\n    $$\n    r_{\\mathrm{IV}} = \\begin{cases}\n    \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IV}}}{S^{\\mathrm{EDF}}_{\\mathrm{IV}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}}  0,\\\\\n    0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}} = 0,\n    \\end{cases}\n    $$\n    2. 同位旋标量相对偏差\n    $$\n    r_{\\mathrm{IS}} = \\begin{cases}\n    \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IS}}}{S^{\\mathrm{EDF}}_{\\mathrm{IS}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}}  0,\\\\\n    0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}} = 0.\n    \\end{cases}\n    $$\n    3. 一个用于指示 EDF 缺少同位旋矢量三体项的布尔指标，\n    $$\n    \\text{missing\\_IV\\_3body} = \\begin{cases}\n    \\text{True},  \\text{if } r_{\\mathrm{IV}}  \\tau_{\\mathrm{IV}} \\text{ and } \\left| r_{\\mathrm{IS}} \\right| \\le \\tau_{\\mathrm{IS}},\\\\\n    \\text{False},  \\text{otherwise},\n    \\end{cases}\n    $$\n    其中阈值为 $\\tau_{\\mathrm{IV}} = 0.10$ 和 $\\tau_{\\mathrm{IS}} = 0.05$。\n\n您的程序必须为以下测试套件实现上述逻辑。对于每种情况，将宽度视为 $\\Gamma = 1.0\\,\\mathrm{MeV}$（这个选择不影响积分强度，但提供了物理真实性）。\n\n测试套件（所有能量单位为 $\\mathrm{MeV}$，所有 $D$ 值单位为 $\\mathrm{fm}$）：\n\n- 情况1（中等质量核）：$Z=28$, $N=32$, $A=60$, $f=0.15$。CC 激发和振幅：\n    - $\\omega = [9.0,\\, 15.5,\\, 23.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [1.6,\\, 0.8,\\, 0.5]$,\n    - $D^{\\mathrm{CC}}_{n} = [-0.4,\\, 0.6,\\, 0.2]$。\n\n- 情况2（对称核边界条件）：$Z=20$, $N=20$, $A=40$, $f=0.0$。CC 激发和振幅：\n    - $\\omega = [10.0,\\, 18.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [0.3,\\, 0.5]$,\n    - $D^{\\mathrm{CC}}_{n} = [0.3,\\, 0.5]$。\n\n- 情况3（重核，更强的淬灭）：$Z=50$, $N=70$, $A=120$, $f=0.30$。CC 激发和振幅：\n    - $\\omega = [8.0,\\, 12.5,\\, 17.0,\\, 25.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [2.0,\\, 1.5,\\, 1.1,\\, 0.6]$,\n    - $D^{\\mathrm{CC}}_{n} = [0.2,\\, 0.9,\\, 0.8,\\, 0.1]$。\n\n- 情况4（振幅消失的边界情况）：$Z=14$, $N=14$, $A=28$, $f=0.0$。CC 激发和振幅：\n    - $\\omega = [20.0]$,\n    - $D^{\\mathrm{CC}}_{p} = [0.0]$,\n    - $D^{\\mathrm{CC}}_{n} = [0.0]$。\n\n任务：\n\n1. 对每种情况，使用上述混合规则和给定的 $f$ 构建 EDF 振幅。\n2. 计算以 $e^2\\,\\mathrm{fm}^2$ 为单位的 $S^{\\mathrm{CC}}_{\\mathrm{IV}}$、$S^{\\mathrm{EDF}}_{\\mathrm{IV}}$、$S^{\\mathrm{CC}}_{\\mathrm{IS}}$ 和 $S^{\\mathrm{EDF}}_{\\mathrm{IS}}$。\n3. 使用阈值 $\\tau_{\\mathrm{IV}} = 0.10$ 和 $\\tau_{\\mathrm{IS}} = 0.05$ 计算 $r_{\\mathrm{IV}}$ 和布尔值 $\\text{missing\\_IV\\_3body}$。当 $r_{\\mathrm{IV}}$ 或 $r_{\\mathrm{IS}}$ 中的分母为零时，将相应的比率定义为 $0$。\n4. 将每个 $r_{\\mathrm{IV}}$ 表示为四舍五入到六位小数的浮点数。最终输出必须是单行，包含一个用方括号括起来的逗号分隔列表，由每个案例的交替条目组成：$[r_{\\mathrm{IV},1}, \\text{missing\\_IV\\_3body}_1, r_{\\mathrm{IV},2}, \\text{missing\\_IV\\_3body}_2, \\dots]$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3]”）。",
            "solution": "该问题要求设计并实现一个数值程序，用于计算和比较原子核的电偶极（$E1$）响应，并将其分为同位旋矢量和同位旋标量分量。比较是在一个基准的 *ab initio* 耦合簇（CC）计算和一个简化的能量密度泛函（EDF）模型之间进行的。目标是通过评估一组诊断量，识别出 EDF 模型中的一个特定缺陷，该缺陷被假定源于缺失的同位旋矢量三体力贡献。\n\n解决方案将通过首先形式化所有必要量的计算，然后概述单个测试用例的算法过程，最后在一个处理整个测试套件的程序中实现此过程来制定。\n\n首先，我们确定核心量。原子核由其质子数 $Z$、中子数 $N$ 和质量数 $A = Z+N$ 定义。对于给定的原子核，基本输入是离散激发能 $\\{\\omega_k\\}$ 和相应的扣除质心运动的质子和中子偶极振幅积分 $\\{D_{p,k}\\}$ 和 $\\{D_{n,k}\\}$。这些量由一个参考的 CC 计算提供，用上标 'CC' 表示。\n\n分析的关键在于 $E1$ 响应的同位旋矢量（IV）和同位旋标量（IS）分解。对于给定的离散跃迁 $k$，同位旋矢量矩阵元由下式给出\n$$\nM_{\\mathrm{IV},k} = e_p^{\\mathrm{IV}}\\, D_{p,k} + e_n^{\\mathrm{IV}}\\, D_{n,k},\n$$\n其中同位旋矢量有效电荷为 $e_p^{\\mathrm{IV}} = N/A$ 和 $e_n^{\\mathrm{IV}} = -Z/A$。这可以更紧凑地重写为\n$$\nM_{\\mathrm{IV},k} = \\frac{N}{A} D_{p,k} - \\frac{Z}{A} D_{n,k} = \\frac{1}{A}(N D_{p,k} - Z D_{n,k}).\n$$\n同位旋标量矩阵元，作为压缩运动的代理，定义为质子和中子振幅之和：\n$$\nM_{\\mathrm{IS},k} = D_{p,k} + D_{n,k}.\n$$\n同位旋矢量和同位旋标量模式的积分强度是所有离散态 $k$ 上矩阵元平方的和：\n$$\nS_{\\mathrm{IV}} = \\sum_{k} |M_{\\mathrm{IV},k}|^2, \\quad S_{\\mathrm{IS}} = \\sum_{k} |M_{\\mathrm{IS},k}|^2.\n$$\n这些公式适用于 CC 参考计算和 EDF 模型计算，只需代入各自的偶极振幅。强度的单位是 $e^2\\,\\mathrm{fm}^2$。正如问题所述，激发能 $\\omega_k$ 和展宽宽度 $\\Gamma$ 不进入积分强度的计算。\n\n接下来，我们建立 CC 和 EDF 模型之间的关系。EDF 模型的振幅是通过一个由因子 $f \\in [0, 0.5]$ 参数化的混合规则从 CC 振幅导出的：\n$$\nD^{\\mathrm{EDF}}_{p,k} = (1-f)\\,D^{\\mathrm{CC}}_{p,k} + f\\,D^{\\mathrm{CC}}_{n,k},\n$$\n$$\nD^{\\mathrm{EDF}}_{n,k} = (1-f)\\,D^{\\mathrm{CC}}_{n,k} + f\\,D^{\\mathrm{CC}}_{p,k}.\n$$\n这种混合模拟了质子-中子区别的淬灭。我们现在必须确定这种混合对同位旋矢量和同位旋标量强度的影响。\n\n对于同位旋标量分量，模式 $k$ 的 EDF 矩阵元是：\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IS},k} = D^{\\mathrm{EDF}}_{p,k} + D^{\\mathrm{EDF}}_{n,k} = \\left((1-f)D^{\\mathrm{CC}}_{p,k} + fD^{\\mathrm{CC}}_{n,k}\\right) + \\left((1-f)D^{\\mathrm{CC}}_{n,k} + fD^{\\mathrm{CC}}_{p,k}\\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IS},k} = (1-f+f)D^{\\mathrm{CC}}_{p,k} + (f+1-f)D^{\\mathrm{CC}}_{n,k} = D^{\\mathrm{CC}}_{p,k} + D^{\\mathrm{CC}}_{n,k} = M^{\\mathrm{CC}}_{\\mathrm{IS},k}.\n$$\n由于每个模式 $k$ 的矩阵元都相同，因此积分同位旋标量强度在此变换下是不变的：$S^{\\mathrm{EDF}}_{\\mathrm{IS}} = S^{\\mathrm{CC}}_{\\mathrm{IS}}$。\n\n对于同位旋矢量分量，EDF 矩阵元是：\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A}(N D^{\\mathrm{EDF}}_{p,k} - Z D^{\\mathrm{EDF}}_{n,k}).\n$$\n代入混合规则：\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( N\\left[(1-f)D^{\\mathrm{CC}}_{p,k} + fD^{\\mathrm{CC}}_{n,k}\\right] - Z\\left[(1-f)D^{\\mathrm{CC}}_{n,k} + fD^{\\mathrm{CC}}_{p,k}\\right] \\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( [N(1-f) - Zf]D^{\\mathrm{CC}}_{p,k} + [Nf - Z(1-f)]D^{\\mathrm{CC}}_{n,k} \\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( [N - (N+Z)f]D^{\\mathrm{CC}}_{p,k} + [-Z + (N+Z)f]D^{\\mathrm{CC}}_{n,k} \\right)\n$$\n使用 $A=N+Z$：\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A} \\left( (N - Af)D^{\\mathrm{CC}}_{p,k} + (-Z + Af)D^{\\mathrm{CC}}_{n,k} \\right)\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = \\frac{1}{A}(N D^{\\mathrm{CC}}_{p,k} - Z D^{\\mathrm{CC}}_{n,k}) - \\frac{Af}{A}(D^{\\mathrm{CC}}_{p,k} - D^{\\mathrm{CC}}_{n,k})\n$$\n$$\nM^{\\mathrm{EDF}}_{\\mathrm{IV},k} = M^{\\mathrm{CC}}_{\\mathrm{IV},k} - f(D^{\\mathrm{CC}}_{p,k} - D^{\\mathrm{CC}}_{n,k}).\n$$\n这个简化的表达式表明，混合引入了一个与 $f$ 以及质子和中子振幅之差成正比的项，这直接修改了同位旋矢量矩阵元。\n\n现在可以计算诊断量了。同位旋标量相对偏差为：\n$$\nr_{\\mathrm{IS}} = \\begin{cases} \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IS}}}{S^{\\mathrm{EDF}}_{\\mathrm{IS}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}}  0,\\\\ 0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IS}} = 0. \\end{cases}\n$$\n由于我们证明了 $S^{\\mathrm{EDF}}_{\\mathrm{IS}} = S^{\\mathrm{CC}}_{\\mathrm{IS}}$，如果 $S^{\\mathrm{EDF}}_{\\mathrm{IS}}  0$，则比值为 $1$，使得 $r_{\\mathrm{IS}} = 1 - 1 = 0$。如果 $S^{\\mathrm{EDF}}_{\\mathrm{IS}} = 0$，则 $r_{\\mathrm{IS}}$ 定义为 $0$。因此，$r_{\\mathrm{IS}}$ 总是 $0$。\n\n同位旋矢量相对偏差为：\n$$\nr_{\\mathrm{IV}} = \\begin{cases} \\dfrac{S^{\\mathrm{CC}}_{\\mathrm{IV}}}{S^{\\mathrm{EDF}}_{\\mathrm{IV}}} - 1,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}}  0,\\\\ 0,  \\text{if } S^{\\mathrm{EDF}}_{\\mathrm{IV}} = 0. \\end{cases}\n$$\n用于指示缺少同位旋矢量三体项的布尔指标是：\n$$\n\\text{missing\\_IV\\_3body} = \\begin{cases} \\text{True},  \\text{if } r_{\\mathrm{IV}}  \\tau_{\\mathrm{IV}} \\text{ and } \\left| r_{\\mathrm{IS}} \\right| \\le \\tau_{\\mathrm{IS}},\\\\ \\text{False},  \\text{otherwise}, \\end{cases}\n$$\n给定阈值为 $\\tau_{\\mathrm{IV}} = 0.10$ 和 $\\tau_{\\mathrm{IS}} = 0.05$。由于 $|r_{\\mathrm{IS}}| = 0$ 且 $0 \\le 0.05$，第二个条件总是成立。该标准简化为：当且仅当 $r_{\\mathrm{IV}}  0.10$ 时，$\\text{missing\\_IV\\_3body} = \\text{True}$。\n\n每个测试用例的算法过程如下：\n1.  接收输入 $Z, N, f$ 以及 CC 振幅数组 $D^{\\mathrm{CC}}_{p}$ 和 $D^{\\mathrm{CC}}_{n}$。\n2.  计算 $A = Z+N$。\n3.  对数组使用向量运算，计算所有模式 $k$ 的 CC 矩阵元：\n    -   $M^{\\mathrm{CC}}_{\\mathrm{IV}} = (1/A) \\cdot (N \\cdot D^{\\mathrm{CC}}_{p} - Z \\cdot D^{\\mathrm{CC}}_{n})$\n4.  计算积分 CC 同位旋矢量强度：\n    -   $S^{\\mathrm{CC}}_{\\mathrm{IV}} = \\sum |M^{\\mathrm{CC}}_{\\mathrm{IV}}|^2$\n5.  使用简化表达式，计算所有模式 $k$ 的 EDF 矩阵元：\n    -   $M^{\\mathrm{EDF}}_{\\mathrm{IV}} = M^{\\mathrm{CC}}_{\\mathrm{IV}} - f \\cdot (D^{\\mathrm{CC}}_{p} - D^{\\mathrm{CC}}_{n})$\n6.  计算积分 EDF 同位旋矢量强度：\n    -   $S^{\\mathrm{EDF}}_{\\mathrm{IV}} = \\sum |M^{\\mathrm{EDF}}_{\\mathrm{IV}}|^2$\n7.  根据提供的条件定义计算 $r_{\\mathrm{IV}}$，检查 $S^{\\mathrm{EDF}}_{\\mathrm{IV}}$ 是否为零。\n8.  通过将计算出的 $r_{\\mathrm{IV}}$ 与阈值 $\\tau_{\\mathrm{IV}}=0.10$ 进行比较，确定 $\\text{missing\\_IV\\_3body}$ 的布尔值。\n9.  存储并格式化结果 $r_{\\mathrm{IV}}$（四舍五入到六位小数）和布尔值。\n\n此过程将在一个迭代遍历所提供测试套件的循环中实现。`numpy` 库是高效、准确地执行所需向量化计算的理想选择。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem for a suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (medium-mass nucleus)\n        {\n            \"Z\": 28, \"N\": 32, \"f\": 0.15,\n            \"D_cc_p\": np.array([1.6, 0.8, 0.5]),\n            \"D_cc_n\": np.array([-0.4, 0.6, 0.2])\n        },\n        # Case 2 (symmetric nucleus boundary condition)\n        {\n            \"Z\": 20, \"N\": 20, \"f\": 0.0,\n            \"D_cc_p\": np.array([0.3, 0.5]),\n            \"D_cc_n\": np.array([0.3, 0.5])\n        },\n        # Case 3 (heavy nucleus, stronger quenching)\n        {\n            \"Z\": 50, \"N\": 70, \"f\": 0.30,\n            \"D_cc_p\": np.array([2.0, 1.5, 1.1, 0.6]),\n            \"D_cc_n\": np.array([0.2, 0.9, 0.8, 0.1])\n        },\n        # Case 4 (edge case with vanishing amplitudes)\n        {\n            \"Z\": 14, \"N\": 14, \"f\": 0.0,\n            \"D_cc_p\": np.array([0.0]),\n            \"D_cc_n\": np.array([0.0])\n        }\n    ]\n\n    # Diagnostic thresholds\n    tau_IV = 0.10\n    tau_IS = 0.05\n\n    results = []\n    \n    for case in test_cases:\n        Z = case[\"Z\"]\n        N = case[\"N\"]\n        f = case[\"f\"]\n        D_cc_p = case[\"D_cc_p\"]\n        D_cc_n = case[\"D_cc_n\"]\n        \n        A = Z + N\n\n        # --- Coupled Cluster (CC) Calculations ---\n        \n        # Isovector matrix elements for CC\n        # M_IV,k = (N/A)*D_p,k - (Z/A)*D_n,k\n        M_cc_iv_k = (1/A) * (N * D_cc_p - Z * D_cc_n)\n        \n        # Integrated isovector strength for CC\n        # S_IV = sum(|M_IV,k|^2)\n        S_cc_iv = np.sum(np.square(np.abs(M_cc_iv_k)))\n\n        # Isoscalar matrix elements for CC\n        # M_IS,k = D_p,k + D_n,k\n        # This is not strictly needed for the simplified logic but good for completeness\n        M_cc_is_k = D_cc_p + D_cc_n\n        S_cc_is = np.sum(np.square(np.abs(M_cc_is_k)))\n\n        # --- Energy Density Functional (EDF) Calculations ---\n\n        # The mixing rule preserves the isoscalar sum, so S_edf_is = S_cc_is.\n        S_edf_is = S_cc_is\n\n        # Use the derived simplified formula for EDF isovector matrix elements:\n        # M_EDF_IV,k = M_CC_IV,k - f * (D_CC_p,k - D_CC_n,k)\n        M_edf_iv_k = M_cc_iv_k - f * (D_cc_p - D_cc_n)\n\n        # Integrated isovector strength for EDF\n        S_edf_iv = np.sum(np.square(np.abs(M_edf_iv_k)))\n        \n        # --- Diagnostic Calculations ---\n        \n        # Isovector relative deviation\n        if S_edf_iv > 0:\n            r_iv = S_cc_iv / S_edf_iv - 1\n        else:\n            r_iv = 0.0\n\n        # Isoscalar relative deviation is always 0 due to the mixing rule's nature.\n        if S_edf_is > 0:\n            r_is = S_cc_is / S_edf_is - 1\n        else:\n            r_is = 0.0 # which is always 0\n\n        # Boolean indicator for missing isovector three-body term\n        # The condition |r_is| = tau_IS is always true because r_is is 0.\n        is_missing_iv_3body = r_iv > tau_IV\n        \n        # Append results for this case\n        results.append(f\"{r_iv:.6f}\")\n        results.append(str(is_missing_iv_3body))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}