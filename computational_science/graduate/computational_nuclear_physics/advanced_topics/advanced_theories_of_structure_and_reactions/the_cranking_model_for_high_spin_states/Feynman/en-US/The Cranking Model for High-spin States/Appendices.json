{
    "hands_on_practices": [
        {
            "introduction": "The cranking model provides a powerful framework for studying rotating quantum systems by shifting the perspective from a fixed angular momentum $I$ to a fixed rotational frequency $\\omega$. This transition is accomplished through a Legendre transform, which defines the Routhian energy in the rotating frame. This first exercise  walks you through this fundamental procedure, starting from a simple, phenomenologically-motivated energy expression. By deriving the Routhian and exploring the conditions for rotational stability, you will gain hands-on experience with the core mathematical machinery of the cranking model.",
            "id": "3597888",
            "problem": "In the cranking description of rotating nuclei, one models a rotational band by introducing a rotational frequency $\\omega$ that is thermodynamically conjugate to the spin $I$, and a Routhian $R(\\omega)$ obtained from the energy $E(I)$ by a Legendre transform. Consider a parametrized rotational energy\n$$\nE(I)=\\frac{I(I+1)}{2\\mathcal{J}}+\\alpha\\,I^{4},\n$$\nwhere $\\mathcal{J}$ is a positive moment of inertia and $\\alpha$ is a small parameter modeling high-spin stiffness. Treat $I$ as a continuous variable appropriate for large spins.\n\nStarting from first principles of thermodynamic conjugacy and Legendre transforms applied to the cranking model:\n- Derive the rotational frequency $\\omega(I)=\\partial E/\\partial I$.\n- Construct the Legendre transform $R(\\omega)$ as the minimized value of $E(I)-\\omega I$ with respect to $I$ at fixed $\\omega$. Work consistently to leading order in $\\alpha$, i.e., keep terms up to $\\mathcal{O}(\\alpha)$ and neglect $\\mathcal{O}(\\alpha^{2})$ and higher.\n- Discuss the stability criterion $\\partial I/\\partial\\omega>0$ in terms of $\\mathcal{J}$, $\\alpha$, and $I$, and relate it to convexity of $E(I)$.\n\nYour final answer must be the closed-form analytic expression for $R(\\omega)$ to leading order in $\\alpha$. No numerical evaluation is required and no units should be included in the final expression.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- The rotational energy is given by the parametrization: $E(I)=\\frac{I(I+1)}{2\\mathcal{J}}+\\alpha\\,I^{4}$.\n- The moment of inertia $\\mathcal{J}$ is a positive constant: $\\mathcal{J}>0$.\n- The parameter $\\alpha$ is small, implying a perturbative approach is appropriate.\n- The spin $I$ is treated as a continuous variable.\n- The rotational frequency $\\omega$ is defined as the derivative of energy with respect to spin: $\\omega(I)=\\frac{\\partial E}{\\partial I}$.\n- The Routhian $R(\\omega)$ is the Legendre transform of the energy $E(I)$: $R(\\omega) = \\min_I (E(I)-\\omega I)$.\n- The calculations are to be performed consistently to leading order in $\\alpha$, denoted as $\\mathcal{O}(\\alpha)$.\n- A stability criterion is given as $\\frac{\\partial I}{\\partial\\omega}>0$, which needs to be discussed.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes the cranking model, a cornerstone of theoretical nuclear structure physics used to model high-spin states. The energy expression is a standard phenomenological form, comprising a rotor term and a higher-order correction for nuclear stiffness. The definitions of the rotational frequency and the Routhian via a Legendre transform are fundamental to this formalism. The problem is firmly rooted in established principles of theoretical physics.\n- **Well-Posed**: The problem is well-posed. It provides all necessary definitions and equations. The instruction to work to a specific order ($\\mathcal{O}(\\alpha)$) in a small parameter provides a clear and unambiguous path to a unique solution.\n- **Objective**: The problem is stated in precise, formal language, free of any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe solution involves three parts as requested: deriving the rotational frequency $\\omega(I)$, constructing the Routhian $R(\\omega)$ to first order in $\\alpha$, and discussing the stability of the rotation.\n\n**1. Derivation of the Rotational Frequency $\\omega(I)$**\n\nThe rotational frequency $\\omega$ is defined as the first derivative of the energy $E(I)$ with respect to the angular momentum $I$.\nGiven the energy expression:\n$$E(I)=\\frac{I(I+1)}{2\\mathcal{J}}+\\alpha\\,I^{4} = \\frac{I^2+I}{2\\mathcal{J}}+\\alpha\\,I^{4}$$\nWe differentiate $E(I)$ with respect to $I$, treating $I$ as a continuous variable:\n$$\\omega(I) = \\frac{\\partial E}{\\partial I} = \\frac{\\partial}{\\partial I} \\left( \\frac{I^2+I}{2\\mathcal{J}}+\\alpha\\,I^{4} \\right)$$\nPerforming the differentiation, we obtain:\n$$\\omega(I) = \\frac{2I+1}{2\\mathcal{J}} + 4\\alpha I^3$$\nThis expression gives the rotational frequency as a function of the spin $I$. The first term corresponds to a rigid rotor, while the second is a correction due to the stiffness parameter $\\alpha$.\n\n**2. Construction of the Routhian $R(\\omega)$**\n\nThe Routhian $R(\\omega)$ is the Legendre transform of $E(I)$, defined as $R(\\omega) = E(I) - \\omega I$, evaluated at the value of $I$ that minimizes this expression for a given $\\omega$. This minimization condition is precisely $\\frac{\\partial}{\\partial I}(E(I) - \\omega I) = 0$, which yields $\\frac{\\partial E}{\\partial I} = \\omega$.\n\nThis means we must first invert the relation $\\omega(I)$ to find $I$ as a function of $\\omega$, denoted $I(\\omega)$. The equation to solve is:\n$$\\omega = \\frac{2I+1}{2\\mathcal{J}} + 4\\alpha I^3$$\nThis is a cubic equation for $I$ and is difficult to solve exactly. However, since $\\alpha$ is a small parameter, we can find $I(\\omega)$ perturbatively.\n\nLet $E(I) = E_0(I) + \\alpha E_1(I)$, where $E_0(I) = \\frac{I(I+1)}{2\\mathcal{J}}$ and $E_1(I) = I^4$.\nThe Routhian can be written as $R(\\omega, \\alpha)$. We seek an expression for $R$ that is accurate to first order in $\\alpha$. We can use the Hellmann-Feynman theorem (or the envelope theorem), which states that the derivative of the transformed function with respect to a parameter is the partial derivative of the original function with respect to that parameter, evaluated at the stationary point.\n$$ \\frac{\\partial R}{\\partial \\alpha} = \\frac{\\partial}{\\partial \\alpha} (E(I) - \\omega I) \\bigg|_{I=I(\\omega)} = \\frac{\\partial}{\\partial \\alpha} \\left( \\frac{I(I+1)}{2\\mathcal{J}} + \\alpha I^4 - \\omega I \\right) \\bigg|_{I=I(\\omega)} = I(\\omega)^4 $$\nTo find $R(\\omega)$ up to order $\\mathcal{O}(\\alpha)$, we can integrate this expression with respect to $\\alpha$ from $0$ to $\\alpha$:\n$$ R(\\omega, \\alpha) \\approx R(\\omega, 0) + \\int_0^\\alpha \\frac{\\partial R}{\\partial \\alpha'} \\bigg|_{\\alpha'=0} d\\alpha' = R_0(\\omega) + \\alpha \\left( \\frac{\\partial R}{\\partial \\alpha} \\bigg|_{\\alpha=0} \\right) $$\nFrom the derivative above, $\\frac{\\partial R}{\\partial \\alpha} \\big|_{\\alpha=0} = I(\\omega, \\alpha=0)^4$. Let's denote $I_0(\\omega) = I(\\omega, \\alpha=0)$.\nSo, the Routhian to first order in $\\alpha$ is:\n$$R(\\omega) \\approx R_0(\\omega) + \\alpha I_0(\\omega)^4$$\nwhere $R_0(\\omega)$ is the Routhian for the unperturbed system ($\\alpha=0$), and $I_0(\\omega)$ is the spin for the unperturbed system.\n\nFirst, we find $I_0(\\omega)$ by setting $\\alpha=0$ in the equation for $\\omega(I)$:\n$$\\omega = \\omega_0(I_0) = \\frac{2I_0+1}{2\\mathcal{J}}$$\nSolving for $I_0$:\n$$2\\mathcal{J}\\omega = 2I_0 + 1 \\implies I_0(\\omega) = \\mathcal{J}\\omega - \\frac{1}{2}$$\nNext, we find the unperturbed Routhian, $R_0(\\omega)$:\n$$R_0(\\omega) = E_0(I_0) - \\omega I_0 = \\frac{I_0(I_0+1)}{2\\mathcal{J}} - \\omega I_0$$\nSubstitute $I_0(\\omega) = \\mathcal{J}\\omega - \\frac{1}{2}$:\n$$I_0(I_0+1) = \\left(\\mathcal{J}\\omega - \\frac{1}{2}\\right)\\left(\\mathcal{J}\\omega + \\frac{1}{2}\\right) = (\\mathcal{J}\\omega)^2 - \\left(\\frac{1}{2}\\right)^2 = \\mathcal{J}^2\\omega^2 - \\frac{1}{4}$$\nSo,\n$$R_0(\\omega) = \\frac{\\mathcal{J}^2\\omega^2 - \\frac{1}{4}}{2\\mathcal{J}} - \\omega\\left(\\mathcal{J}\\omega - \\frac{1}{2}\\right) = \\frac{\\mathcal{J}\\omega^2}{2} - \\frac{1}{8\\mathcal{J}} - \\mathcal{J}\\omega^2 + \\frac{\\omega}{2}$$\n$$R_0(\\omega) = -\\frac{\\mathcal{J}\\omega^2}{2} + \\frac{\\omega}{2} - \\frac{1}{8\\mathcal{J}}$$\nFinally, we assemble the full Routhian to first order in $\\alpha$:\n$$R(\\omega) \\approx R_0(\\omega) + \\alpha I_0(\\omega)^4 = \\left(-\\frac{\\mathcal{J}\\omega^2}{2} + \\frac{\\omega}{2} - \\frac{1}{8\\mathcal{J}}\\right) + \\alpha \\left(\\mathcal{J}\\omega - \\frac{1}{2}\\right)^4$$\nThis is the required expression for the Routhian to leading order in $\\alpha$.\n\n**3. Discussion of the Stability Criterion**\n\nThe stability criterion for the rotational motion is given as $\\frac{\\partial I}{\\partial \\omega} > 0$. This means that for the rotation to be stable, the angular momentum $I$ must be a monotonically increasing function of the rotational frequency $\\omega$.\nUsing the inverse function theorem, $\\frac{\\partial I}{\\partial \\omega} = \\left(\\frac{\\partial \\omega}{\\partial I}\\right)^{-1}$. The condition $\\frac{\\partial I}{\\partial \\omega} > 0$ is therefore equivalent to $\\frac{\\partial \\omega}{\\partial I} > 0$ (assuming $\\frac{\\partial \\omega}{\\partial I}$ is not zero or infinite).\n\nWe calculate $\\frac{\\partial \\omega}{\\partial I}$ from our derived expression for $\\omega(I)$:\n$$\\frac{\\partial \\omega}{\\partial I} = \\frac{\\partial}{\\partial I}\\left(\\frac{2I+1}{2\\mathcal{J}} + 4\\alpha I^3\\right) = \\frac{2}{2\\mathcal{J}} + 12\\alpha I^2 = \\frac{1}{\\mathcal{J}} + 12\\alpha I^2$$\nThe stability condition is thus:\n$$\\frac{1}{\\mathcal{J}} + 12\\alpha I^2 > 0$$\nSince $\\mathcal{J}>0$ is given, $1/\\mathcal{J}$ is positive. We analyze the stability based on the sign of $\\alpha$:\n- If $\\alpha \\geq 0$: The term $12\\alpha I^2$ is non-negative. The sum $\\frac{1}{\\mathcal{J}} + 12\\alpha I^2$ is always strictly positive. Therefore, for $\\alpha \\geq 0$, the rotation is stable for all values of spin $I$.\n- If $\\alpha < 0$: Let $\\alpha = -|\\alpha|$. The stability condition becomes $\\frac{1}{\\mathcal{J}} - 12|\\alpha|I^2 > 0$. This inequality holds only when $12|\\alpha|I^2 < \\frac{1}{\\mathcal{J}}$, which means $I^2 < \\frac{1}{12|\\alpha|\\mathcal{J}}$. The rotation is stable only for spins below a critical value $I_{crit} = \\sqrt{\\frac{1}{12|\\alpha|\\mathcal{J}}}$. Above this spin, the system becomes unstable ($\\frac{\\partial I}{\\partial \\omega} < 0$), a phenomenon known as backbending.\n\nThis stability criterion is directly related to the convexity of the energy function $E(I)$. A function is strictly convex if its second derivative is positive. Let's examine the second derivative of $E(I)$:\n$$\\frac{\\partial^2 E}{\\partial I^2} = \\frac{\\partial}{\\partial I}\\left(\\frac{\\partial E}{\\partial I}\\right) = \\frac{\\partial \\omega}{\\partial I}$$\nThus, the stability condition $\\frac{\\partial \\omega}{\\partial I} > 0$ is identical to the mathematical condition for strict convexity of the energy, $\\frac{\\partial^2 E}{\\partial I^2} > 0$. An unstable rotational region corresponds to a non-convex (concave) region of the $E(I)$ curve.",
            "answer": "$$\\boxed{-\\frac{\\mathcal{J}\\omega^2}{2} + \\frac{\\omega}{2} - \\frac{1}{8\\mathcal{J}} + \\alpha \\left(\\mathcal{J}\\omega - \\frac{1}{2}\\right)^4}$$"
        },
        {
            "introduction": "The interplay between collective rotation and microscopic pairing correlations gives rise to some of the most fascinating phenomena in high-spin nuclear physics. The Coriolis force, which is potent at high rotational frequencies, acts to break nucleon pairs and align their individual angular momenta with the axis of rotation. This practice  guides you through a computational exploration of this process, challenging you to model the gradual breakdown and eventual collapse of pairing in a cranked single-$j$ shell. By implementing a seniority-blocking scheme, you will directly simulate how rotational stress drives a quantum phase transition from a superfluid to a normal state.",
            "id": "3597894",
            "problem": "Consider a single-$j$ shell model with constant pairing in the rotating (cranked) mean-field framework at zero temperature. The rotating frame Routhian is defined as $H' = H - \\omega J_x$, where $H$ is the laboratory-frame Hamiltonian, $\\omega$ is the rotational frequency (angular frequency), and $J_x$ is the $x$-component of the total angular momentum operator. Assume a constant pairing interaction of strength $G$ acting within a single spherical shell with total angular momentum $j$, whose $2\\Omega$ magnetic substates constitute the active valence space. Take $\\Omega = j + \\tfrac{1}{2}$ so that the shell contains $2\\Omega$ single-particle states. Work in natural units with $\\hbar = 1$ so that energies and angular frequencies are both in megaelectronvolts (MeV). \n\nStart from the Bardeen–Cooper–Schrieffer (BCS) variational principle for constant pairing in a discrete set of time-reversed orbitals and from the definition of the rotating frame. Use only the following foundational facts as the starting point:\n- The Routhian is $H' = H - \\omega J_x$.\n- In a single-$j$ shell, one may choose a basis that diagonalizes $J_x$ with eigenvalues $m_x$ taking values $\\{-j,-j+1,\\dots,j\\}$ in steps of $1$ (including half-integers).\n- The zero-temperature Bardeen–Cooper–Schrieffer (BCS) ground state for a constant pairing interaction is obtained by minimizing the expectation value of $H'$ in a quasiparticle vacuum characterized by amplitudes $u_k$ and $v_k$ subject to the particle-number constraint.\n\nYou must:\n1. Formulate the zero-temperature BCS equations in the rotating frame for a constant pairing interaction in the single-$j$ shell, using the above base definitions. Treat the cranking as a one-body term linear in $J_x$, and treat pair breaking by the standard seniority-blocking mechanism: when a quasiparticle Routhian crosses zero, the corresponding time-reversed pair is removed (blocked) from the pairing condensate, and the BCS problem is solved again in the reduced space with the particle number reduced by two and the pair degeneracy reduced by one. Continue this as $\\omega$ increases.\n2. For each unblocked pair, compute the quasiparticle Routhians as functions of $\\omega$ and compute the occupation probabilities $v_k^2(\\omega)$ of the corresponding magnetic substates, assuming that for unblocked (paired) levels both members of the time-reversed pair have equal occupation probability, while for blocked pairs the aligned substate has occupation $1$ and its time-reversed partner has occupation $0$.\n3. Identify the value of $\\omega$ at which the pairing field collapses, defined as the smallest $\\omega$ at which the nontrivial solution with pairing gap $\\Delta(\\omega) > 0$ ceases to exist under the above blocking procedure.\n\nYour program must implement a numerically robust algorithm that, for each case, sweeps $\\omega$ upward, self-consistently applies the blocking steps whenever a quasiparticle Routhian of an unblocked pair first reaches zero, recomputes the Bardeen–Cooper–Schrieffer (BCS) solution in the reduced space, and continues until pairing collapses. It must, in particular:\n- Construct the set of positive magnetic quantum numbers $m = j, j-1, \\dots, \\tfrac{1}{2}$ (these define the time-reversed pairs $\\pm m$).\n- For a given unblocked set and particle number, solve the zero-temperature BCS equations for constant pairing in the reduced space and compute the quasiparticle Routhians for the unblocked pairs in the rotating frame.\n- Determine and apply the next blocking event at the smallest $\\omega$ for which the lowest quasiparticle Routhian of any unblocked pair reaches zero.\n- Continue the process until there are no paired particles left or until the pairing gap $\\Delta$ vanishes.\n\nAll angular frequencies must be expressed in MeV (with $\\hbar = 1$), and your final reported results must be rounded to six decimal places.\n\nTest Suite:\nImplement your program for the following four parameter sets, each specified by $(j, N, G)$ with $j$ the total single-particle angular momentum of the shell, $N$ the even particle number occupying the $2\\Omega$ states, and $G$ the constant pairing strength in MeV:\n- Case 1 (general mid-shell): $(j = 15/2, N = 8, G = 0.5)$\n- Case 2 (general mid-shell): $(j = 11/2, N = 6, G = 0.3)$\n- Case 3 (off mid-shell): $(j = 9/2, N = 4, G = 0.4)$\n- Case 4 (boundary small system): $(j = 3/2, N = 2, G = 0.2)$\n\nFor each case, your program must compute the collapse frequency $\\omega_{\\mathrm{coll}}$ according to the above procedure.\n\nFinal Output Format:\nYour program should produce a single line of output containing the four collapse frequencies as a comma-separated list enclosed in square brackets, in the same order as the above cases, with each value rounded to six decimal places, for example: \"[x1,x2,x3,x4]\".",
            "solution": "The user wants to find the pairing collapse frequency, $\\omega_{\\text{coll}}$, in a single-$j$ shell model under rotation, using the cranking model and zero-temperature BCS theory with a specific blocking mechanism.\n\n### 1. Theoretical Formulation\n\nWe consider a single spherical shell of total angular momentum $j$ occupied by $N$ particles. The shell contains $2\\Omega = 2(j+\\tfrac{1}{2})$ degenerate single-particle states. The Hamiltonian in the laboratory frame is $H = H_{\\text{sp}} + H_{\\text{pair}}$, where $H_{\\text{sp}}$ is the single-particle part and $H_{\\text{pair}}$ is the pairing interaction. We can set the degenerate single-particle energy to zero, $\\epsilon_k=0$, without loss of generality. In the rotating frame, the problem is described by the Routhian $H' = H - \\omega J_x$, where $\\omega$ is the rotational frequency and $J_x$ is the angular momentum operator along the rotation axis. We work in a basis of states $|m\\rangle$ that are eigenstates of $J_x$ with eigenvalues $m \\in \\{-j, -j+1, \\dots, j\\}$. The single-particle part of the Routhian is diagonal in this basis, with eigenvalues (single-particle Routhians) $e'_m = -\\omega m$.\n\nThe constant pairing interaction $H_{\\text{pair}} = -G \\sum_{k,k'>0} c_{k}^\\dagger c_{\\bar{k}}^\\dagger c_{\\bar{k}'} c_{k'}$ acts between time-reversed states, which in this basis correspond to pairs $(m, -m)$. The problem is solved using the BCS approximation, which is updated iteratively based on a seniority-blocking mechanism.\n\n### 2. Iterative BCS Solution and Blocking\n\nThe procedure involves iteratively solving the BCS equations for a successively smaller set of active (unblocked) pairs. Let $\\mathcal{P}$ be the set of unblocked pairs, represented by their positive magnetic quantum numbers $m_k$, and let $|\\mathcal{P}|$ be the number of such pairs. Let $N_{\\text{rem}}$ be the number of particles distributed among these pairs.\n\nAt each step, we solve the standard zero-temperature BCS equations for a set of $|\\mathcal{P}|$ doubly degenerate levels with energy $\\epsilon=0$ and a particle number $N_{\\text{rem}}$.\nThe number equation is:\n$$N_{\\text{rem}} = \\sum_{k \\in \\mathcal{P}} 2 v_k^2 = \\sum_{k \\in \\mathcal{P}} \\left(1 - \\frac{-\\lambda}{\\sqrt{(-\\lambda)^2 + \\Delta^2}}\\right) = |\\mathcal{P}| \\left(1 + \\frac{\\lambda}{\\sqrt{\\lambda^2 + \\Delta^2}}\\right)$$\nThe gap equation is:\n$$1 = \\frac{G}{2} \\sum_{k \\in \\mathcal{P}} \\frac{1}{\\sqrt{(-\\lambda)^2 + \\Delta^2}} = \\frac{G |\\mathcal{P}|}{2\\sqrt{\\lambda^2 + \\Delta^2}}$$\nHere, $\\lambda$ is the chemical potential and $\\Delta$ is the pairing gap.\n\nSolving this system of equations for $\\lambda$ and $\\Delta$ yields:\nFrom the gap equation, the non-rotating quasiparticle energy $E_0 = \\sqrt{\\lambda^2 + \\Delta^2}$ is found to be constant for all pairs in the condensate:\n$$E_0 = \\frac{G|\\mathcal{P}|}{2}$$\nSubstituting this into the number equation gives the chemical potential:\n$$N_{\\text{rem}} = |\\mathcal{P}| \\left(1 + \\frac{\\lambda}{E_0}\\right) \\implies \\lambda = E_0 \\left(\\frac{N_{\\text{rem}}}{|\\mathcal{P}|} - 1\\right) = \\frac{G}{2}(N_{\\text{rem}} - |\\mathcal{P}|)$$\nThe pairing gap $\\Delta$ can then be calculated from $\\Delta^2 = E_0^2 - \\lambda^2$:\n$$\\Delta^2 = \\left(\\frac{G|\\mathcal{P}|}{2}\\right)^2 - \\left(\\frac{G}{2}(N_{\\text{rem}}-|\\mathcal{P}|)\\right)^2 = \\left(\\frac{G}{2}\\right)^2 \\left(|\\mathcal{P}|^2 - (N_{\\text{rem}}-|\\mathcal{P}|)^2\\right)$$\n$$\\Delta = \\frac{G}{2} \\sqrt{(|\\mathcal{P}| - (N_{\\text{rem}}-|\\mathcal{P}|)) (|\\mathcal{P}| + (N_{\\text{rem}}-|\\mathcal{P}|))} = \\frac{G}{2} \\sqrt{(2|\\mathcal{P}| - N_{\\text{rem}}) N_{\\text{rem}}}$$\nA non-trivial pairing solution ($\\Delta > 0$) exists only if the term under the square root is positive, which requires $0 < N_{\\text{rem}} < 2|\\mathcal{P}|$. If this condition is not met, pairing collapses ($\\Delta=0$).\n\n### 3. Rotational Effects and Pair Blocking\n\nIn the rotating frame, the quasiparticle Routhians for a pair $k$ are split by the cranking term:\n$$E'_{k, \\text{aligned}} = E_0 - \\omega m_k$$\n$$E'_{k, \\text{anti-aligned}} = E_0 + \\omega m_k$$\nAccording to the problem, a pair is blocked when its lowest quasiparticle Routhian first reaches zero. For $\\omega > 0$, this occurs for the aligned state ($E'_{k, \\text{aligned}}$). The system is stable as long as all $E'_{k, \\text{aligned}} > 0$. The first pair to become unstable as $\\omega$ increases is the one with the smallest critical frequency $\\omega_c(k) = E_0 / m_k$. This corresponds to the unblocked pair with the largest magnetic quantum number, $m_{\\text{max}} = \\max\\{m_k | k \\in \\mathcal{P}\\}$.\nThe next blocking event thus occurs at:\n$$\\omega_{\\text{next}} = \\frac{E_0}{m_{\\text{max}}} = \\frac{G|\\mathcal{P}|}{2m_{\\text{max}}}$$\nWhen this frequency is reached, the pair with $m_{\\text{max}}$ is blocked. For the next step of the calculation, this pair is removed from the set $\\mathcal{P}$, and the particle number for the remaining condensate is reduced by two, i.e., $N_{\\text{rem}} \\to N_{\\text{rem}} - 2$.\n\n### 4. Algorithm for Finding Collapse Frequency\n\nThe pairing collapse frequency $\\omega_{\\text{coll}}$ is found by the following iterative algorithm:\n\n1.  **Initialization**:\n    - Start with the full set of pairs $\\mathcal{P}_0$, corresponding to $m_k \\in \\{j, j-1, \\dots, \\tfrac{1}{2}\\}$.\n    - Set the initial remaining particle number $N_{\\text{rem}} = N$.\n    - Initialize the collapse frequency candidate $\\omega_{\\text{coll}} = 0$.\n\n2.  **Iteration**:\n    - Loop as long as the conditions for a non-trivial pairing solution ($0 < N_{\\text{rem}} < 2|\\mathcal{P}|$) are met. In each iteration:\n        a. Calculate the non-rotating quasiparticle energy $E_0 = \\frac{G|\\mathcal{P}|}{2}$.\n        b. Identify the largest magnetic quantum number $m_{\\text{max}}$ in the current set of unblocked pairs $\\mathcal{P}$.\n        c. Calculate the frequency for the next blocking event: $\\omega_{\\text{next}} = E_0 / m_{\\text{max}}$. This value is stored as the current candidate for $\\omega_{\\text{coll}}$.\n        d. Update the system for the next state: remove $m_{\\text{max}}$ from $\\mathcal{P}$ (so $|\\mathcal{P}| \\to |\\mathcal{P}|-1$) and decrease the particle number by two ($N_{\\text{rem}} \\to N_{\\text{rem}}-2$).\n\n3.  **Termination**:\n    - The loop terminates when the condition for non-trivial pairing is violated (i.e., when $N_{\\text{rem}} \\leq 0$ or $N_{\\text{rem}} \\geq 2|\\mathcal{P}|$).\n    - The collapse frequency $\\omega_{\\text{coll}}$ is the last calculated value of $\\omega_{\\text{next}}$, which is the frequency at which the system transitions into the collapsed state.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the pairing collapse frequency for a single-j shell in the cranking model.\n\n    The function implements an iterative algorithm based on the Bardeen-Cooper-Schrieffer (BCS)\n    theory with a seniority-blocking mechanism. At each step, it solves the BCS equations\n    analytically for a set of unblocked degenerate levels to find the pairing gap (Delta)\n    and quasiparticle energy (E0). It then determines the rotational frequency (omega) at which\n    the next pair becomes blocked. This process is repeated, reducing the number of active pairs\n    and particles, until the pairing gap collapses to zero. The frequency at which this\n    collapse occurs is reported.\n    \"\"\"\n\n    test_cases = [\n        # (j, N, G)\n        (15/2, 8, 0.5),  # Case 1\n        (11/2, 6, 0.3),  # Case 2\n        (9/2, 4, 0.4),   # Case 3\n        (3/2, 2, 0.2)    # Case 4\n    ]\n\n    results = []\n    for j, N, G in test_cases:\n        # Generate the list of positive magnetic quantum numbers m_x\n        # from j down to 1/2 in steps of 1.\n        unblocked_m = list(np.arange(j, 0, -1.0))\n        n_rem = float(N)\n        omega_coll = 0.0\n\n        while True:\n            num_pairs = len(unblocked_m)\n\n            # Check for pairing collapse conditions.\n            # A non-trivial solution (Delta > 0) exists only if 0 < n_rem < 2 * num_pairs.\n            # If these conditions are not met, the pairing has collapsed. The collapse\n            # frequency is the one calculated in the previous step, which led to\n            # this invalid state. The loop terminates, and the last stored omega_coll is returned.\n            if n_rem <= 0 or n_rem >= 2 * num_pairs:\n                break\n            \n            # For the current configuration of unblocked pairs, calculate the\n            # non-rotating quasiparticle energy E0.\n            # E0 = sqrt(lambda^2 + Delta^2) = (G * |P|) / 2\n            E0 = G * num_pairs / 2.0\n\n            # The next blocking event occurs when the lowest quasiparticle Routhian\n            # E' = E0 - omega * m_max drops to zero. This happens at omega = E0 / m_max,\n            # where m_max is the largest available magnetic quantum number.\n            m_max = max(unblocked_m)\n            omega_next = E0 / m_max\n            omega_coll = omega_next\n\n            # Update the system for the next iteration: block the pair with m_max.\n            unblocked_m.remove(m_max)\n            # Blocking a pair removes two particles from the condensate.\n            n_rem -= 2.0\n\n        results.append(f\"{omega_coll:.6f}\")\n\n    # Print the final results in the specified format \"[x1,x2,x3,x4]\".\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In realistic cranked mean-field calculations, the calculated quasiparticle energy levels often approach each other and then repel, forming \"avoided crossings.\" Naively following the lowest energy state would cause you to jump between different physical configurations, losing track of the rotational band of interest. This exercise  immerses you in the essential technique of diabatic tracking, which allows you to follow a consistent quantum configuration through this complex spectral landscape. You will implement a model to quantify the probability of non-adiabatic jumps at these crossings using the celebrated Landau-Zener formula, gaining insight into how the dynamics of rotation depend on how fast the nucleus is spun up.",
            "id": "3597896",
            "problem": "Consider a simplified cranked mean-field model for a single quasiparticle moving in a deformed potential, described by the cranked Routhian operator $H^{\\prime}(\\omega) = H - \\omega J_x$, where $H$ is the intrinsic mean-field Hamiltonian, $\\omega$ is the rotational frequency, and $J_x$ is the projection of the total angular momentum on the rotation axis. Work in a fixed orthonormal single-quasiparticle basis of dimension $N = 5$ that mimics a deformed Nilsson scheme. The diabatic (unmixed) basis states are labeled by $k \\in \\{0,1,2,3,4\\}$ with single-quasiparticle energies at zero frequency $\\varepsilon_k$ and aligned angular momenta $j_{x,k}$ (in units of $\\hbar$). Use natural units with $\\hbar = 1$, so that energies and rotational frequencies are both expressed in mega-electron volt (MeV), and time has units $\\mathrm{MeV}^{-1}$. The diabatic Routhian of basis state $k$ is $E^{(0)}_k(\\omega) = \\varepsilon_k - \\omega j_{x,k}$. Residual couplings $V_{kl}$ between different basis states $k \\neq l$ generate avoided crossings (level repulsion) in the adiabatic spectrum.\n\nFundamental base for derivation:\n- The cranked Routhian definition $H^{\\prime}(\\omega) = H - \\omega J_x$.\n- The properties of Hermitian matrices and unitary diagonalization to obtain adiabatic eigenvalues and eigenvectors.\n- The two-level time-dependent Schrödinger equation linearized near a crossing, where the diabatic energy difference is locally linear in time, and a constant off-diagonal coupling produces transitions that can be treated within the paradigm of a non-adiabatic crossing.\n- Widely accepted Landau–Zener physics as a consequence of the linearized two-level time-dependent Schrödinger equation, without assuming any target shortcut formula a priori in the problem statement.\n\nYou are asked to implement diabatic tracking of a specific high-$j$ quasiparticle through avoided crossings and to quantify the Landau–Zener non-adiabatic transition probabilities as a function of the sweep rate $\\dot{\\omega} = d\\omega/dt$.\n\nUse the following concrete, scientifically reasonable parameter set to define the diabatic basis:\n- Number of basis states: $N = 5$.\n- Choose the high-$j$ target state to track as index $k_0 = 0$, intended to represent an $i_{13/2}$ quasiparticle with $j_{x,0} = 6.5$.\n- Adopt the data arrays\n  - $\\boldsymbol{\\varepsilon} = [2.0, 0.5, 1.2, 2.6, 3.0]$ in MeV for $k = 0,1,2,3,4$ respectively,\n  - $\\boldsymbol{j}_x = [6.5, 4.5, 3.5, 2.5, 1.5]$ in units of $\\hbar$ for $k = 0,1,2,3,4$ respectively.\n- Define a real-symmetric residual coupling matrix $V$ (in MeV) with the nonzero off-diagonal entries\n  - $V_{0,1} = V_{1,0} = 0.06$,\n  - $V_{0,2} = V_{2,0} = 0.08$,\n  - $V_{1,2} = V_{2,1} = 0.02$,\n  and all other off-diagonal elements set to $0$, with $V_{kk} = 0$ for all $k$.\n- The full cranked Hamiltonian in this diabatic basis at frequency $\\omega$ is the $N \\times N$ Hermitian matrix with diagonal elements $H^{\\prime}_{kk}(\\omega) = \\varepsilon_k - \\omega j_{x,k}$ and off-diagonal elements $H^{\\prime}_{kl}(\\omega) = V_{kl}$ for $k \\neq l$.\n\nTasks to perform:\n1) Construct $H^{\\prime}(\\omega)$ on a uniform grid $\\omega \\in [\\omega_{\\min},\\omega_{\\max}]$ with $\\omega_{\\min} = 0.0$ MeV and $\\omega_{\\max} = 0.8$ MeV, using a grid step $\\Delta \\omega = 0.001$ MeV.\n2) Perform diabatic tracking of the target state $k_0 = 0$ across the grid by, at each $\\omega$, selecting the adiabatic eigenstate that maximizes the squared overlap with the unmixed basis vector $\\lvert k_0 \\rangle$. This provides a diabatic-followed adiabatic branch that reflects the identity of the high-$j$ quasiparticle through avoided crossings.\n3) Identify all pairwise diabatic crossings between $k_0$ and any other basis state $k \\neq k_0$ that occur within the frequency interval $[\\omega_{\\min},\\omega_{\\max}]$. Use the diabatic crossing condition $E^{(0)}_{k_0}(\\omega_c) = E^{(0)}_{k}(\\omega_c)$ to obtain the crossing frequency $\\omega_c$ and retain only those with $\\omega_c \\in [\\omega_{\\min},\\omega_{\\max}]$. For each such crossing, also determine the slope difference $s_{k_0 k} = \\left| \\frac{d}{d\\omega}\\left(E^{(0)}_{k_0}(\\omega) - E^{(0)}_{k}(\\omega)\\right) \\right| = \\left| j_{x,k} - j_{x,k_0} \\right|$ (dimensionless in the chosen units) and the half-gap coupling $\\Delta_{k_0 k} = \\lvert V_{k_0 k} \\rvert$ (in MeV).\n4) Starting from the linearized two-level time-dependent Schrödinger equation near each $\\omega_c$ with diabatic energy difference locally proportional to time, derive the Landau–Zener expression for the non-adiabatic transition probability to remain on the same diabatic state across a single avoided crossing as a function of sweep rate $\\dot{\\omega}$. Express the result in terms of the half-gap $\\Delta_{k_0 k}$ and the energy-difference slope $\\alpha_{k_0 k} = s_{k_0 k} \\dot{\\omega}$ at the crossing. In natural units with $\\hbar = 1$, ensure that your probability is dimensionless and depends on the ratio of $\\Delta_{k_0 k}^2$ to $\\lvert \\alpha_{k_0 k} \\rvert$.\n5) Assuming statistically independent crossings for the single tracked quasiparticle, compute the cumulative diabatic survival probability as the product over all relevant pairwise crossings within $[\\omega_{\\min},\\omega_{\\max}]$ for a given sweep rate $\\dot{\\omega}$. Use the following test suite of sweep rates (all in $\\mathrm{MeV}^2$ because $\\dot{\\omega}$ has units $\\mathrm{MeV}/\\mathrm{MeV}^{-1}$ in the chosen units):\n   - $\\dot{\\omega}_1 = 10^{-3}$,\n   - $\\dot{\\omega}_2 = 5 \\times 10^{-3}$,\n   - $\\dot{\\omega}_3 = 5 \\times 10^{-2}$,\n   - $\\dot{\\omega}_4 = 10^{-1}$,\n   - $\\dot{\\omega}_5 = 5 \\times 10^{-1}$.\n6) Your program must compute, for each $\\dot{\\omega}_i$ in the test suite, the cumulative diabatic survival probability for the tracked $k_0 = 0$ quasiparticle after sweeping $\\omega$ from $\\omega_{\\min}$ to $\\omega_{\\max}$. The final output should be a single line containing a list of five floating-point numbers rounded to six decimal places, corresponding to the five sweep rates in the order specified above.\n\nImportant implementation notes and requirements:\n- Use only the specified parameter set and natural units with $\\hbar = 1$. All energies, frequencies, and couplings are in MeV; $\\dot{\\omega}$ is in $\\mathrm{MeV}^2$; time is in $\\mathrm{MeV}^{-1}$. No angles are required.\n- Your diabatic tracking should be implemented via overlaps as described in task $2)$.\n- Your Landau–Zener derivation must begin from the linearized two-level time-dependent Schrödinger equation and should not assume any target formula from the outset.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,x_3,x_4,x_5]$, with each $x_i$ rounded to six decimal places.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of the nuclear cranking model and Landau-Zener theory, is well-posed with a complete and consistent set of parameters, and is expressed in objective, formal language. All conditions for a valid problem are met.\n\nThe solution will proceed by first identifying the diabatic crossings relevant to the specified frequency range. Second, the Landau-Zener formula for non-adiabatic survival probability will be derived from the two-level time-dependent Schrödinger equation. Finally, this formula will be applied to compute the cumulative survival probability for the target quasiparticle state across all relevant crossings for a given set of frequency sweep rates.\n\n### Step 1: Identification of Diabatic Crossings\n\nThe diabatic (unperturbed) Routhian for a basis state $\\lvert k \\rangle$ is given by $E^{(0)}_k(\\omega) = \\varepsilon_k - \\omega j_{x,k}$. A diabatic crossing between the target state $\\lvert k_0 \\rangle$ and another state $\\lvert k \\rangle$ occurs at a rotational frequency $\\omega_c$ where their energies are equal:\n$$\nE^{(0)}_{k_0}(\\omega_c) = E^{(0)}_{k}(\\omega_c)\n$$\n$$\n\\varepsilon_{k_0} - \\omega_c j_{x,k_0} = \\varepsilon_k - \\omega_c j_{x,k}\n$$\nSolving for the crossing frequency $\\omega_c$ yields:\n$$\n\\omega_c = \\frac{\\varepsilon_{k_0} - \\varepsilon_k}{j_{x,k_0} - j_{x,k}}\n$$\nWe must evaluate this for the target state $k_0=0$ and all other states $k \\in \\{1,2,3,4\\}$, retaining only those crossings that occur within the specified frequency interval $[\\omega_{\\min}, \\omega_{\\max}] = [0.0, 0.8]$ MeV.\n\nThe given parameters are:\n- Target state: $k_0 = 0$\n- Energies: $\\boldsymbol{\\varepsilon} = [2.0, 0.5, 1.2, 2.6, 3.0]$ MeV\n- Aligned angular momenta: $\\boldsymbol{j}_x = [6.5, 4.5, 3.5, 2.5, 1.5]$ (in units of $\\hbar=1$)\n- Residual couplings from state $0$: $V_{0,1} = 0.06$ MeV, $V_{0,2} = 0.08$ MeV, $V_{0,3} = 0$, $V_{0,4} = 0$.\n\n**Crossing between $k_0=0$ and $k=1$:**\n$$\n\\omega_c(0,1) = \\frac{\\varepsilon_0 - \\varepsilon_1}{j_{x,0} - j_{x,1}} = \\frac{2.0 - 0.5}{6.5 - 4.5} = \\frac{1.5}{2.0} = 0.75 \\text{ MeV}\n$$\nSince $0.0 \\le 0.75 \\le 0.8$, this crossing is within the relevant interval.\nThe associated parameters are:\n- Half-gap: $\\Delta_{01} = |V_{01}| = 0.06$ MeV.\n- Slope difference: $s_{01} = |j_{x,1} - j_{x,0}| = |4.5 - 6.5| = 2.0$.\n\n**Crossing between $k_0=0$ and $k=2$:**\n$$\n\\omega_c(0,2) = \\frac{\\varepsilon_0 - \\varepsilon_2}{j_{x,0} - j_{x,2}} = \\frac{2.0 - 1.2}{6.5 - 3.5} = \\frac{0.8}{3.0} \\approx 0.2667 \\text{ MeV}\n$$\nSince $0.0 \\le 0.2667 \\le 0.8$, this crossing is also relevant.\nThe associated parameters are:\n- Half-gap: $\\Delta_{02} = |V_{02}| = 0.08$ MeV.\n- Slope difference: $s_{02} = |j_{x,2} - j_{x,0}| = |3.5 - 6.5| = 3.0$.\n\n**Crossing between $k_0=0$ and $k=3$:**\n$$\n\\omega_c(0,3) = \\frac{\\varepsilon_0 - \\varepsilon_3}{j_{x,0} - j_{x,3}} = \\frac{2.0 - 2.6}{6.5 - 2.5} = \\frac{-0.6}{4.0} = -0.15 \\text{ MeV}\n$$\nThis is outside the interval $[0.0, 0.8]$.\n\n**Crossing between $k_0=0$ and $k=4$:**\n$$\n\\omega_c(0,4) = \\frac{\\varepsilon_0 - \\varepsilon_4}{j_{x,0} - j_{x,4}} = \\frac{2.0 - 3.0}{6.5 - 1.5} = \\frac{-1.0}{5.0} = -0.2 \\text{ MeV}\n$$\nThis is also outside the interval $[0.0, 0.8]$.\n\nThus, only the crossings with states $k=1$ and $k=2$ are relevant for the calculation.\n\n### Step 2: Derivation of the Landau-Zener Survival Probability\n\nWe consider a two-level system near an avoided crossing, described by the time-dependent Schrödinger equation $i\\hbar \\frac{d}{dt}|\\psi(t)\\rangle = H'(t)|\\psi(t)\\rangle$. With $\\hbar=1$, the cranked Hamiltonian $H'$ in the diabatic basis $\\{\\lvert \\phi_a \\rangle, \\lvert \\phi_b \\rangle\\}$ is:\n$$\nH'(\\omega(t)) = \\begin{pmatrix} E_a^{(0)}(\\omega(t)) & V_{ab} \\\\ V_{ba} & E_b^{(0)}(\\omega(t)) \\end{pmatrix}\n$$\nwhere $V_{ab}=V_{ba}^*$ is the constant residual coupling. The problem specifies a real-symmetric matrix, so $V_{ab} = V_{ba} \\in \\mathbb{R}$. We set the half-gap $\\Delta = |V_{ab}|$.\n\nNear the crossing time $t_c$ (where $\\omega(t_c) = \\omega_c$), the energy difference can be linearized. Let $\\tau = t - t_c$.\n$$\n\\delta E(\\tau) = E_a^{(0)}(\\omega(t_c+\\tau)) - E_b^{(0)}(\\omega(t_c+\\tau)) \\approx \\left. \\frac{d(E_a^{(0)} - E_b^{(0)})}{dt} \\right|_{t=t_c} \\tau\n$$\nUsing the chain rule, $\\frac{d}{dt} = \\frac{d\\omega}{dt} \\frac{d}{d\\omega} = \\dot{\\omega} \\frac{d}{d\\omega}$.\n$$\n\\frac{d}{dt}(E_a^{(0)} - E_b^{(0)}) = \\dot{\\omega} \\frac{d}{d\\omega}[(\\varepsilon_a - \\varepsilon_b) - \\omega(j_{x,a} - j_{x,b})] = -\\dot{\\omega}(j_{x,a} - j_{x,b})\n$$\nWe define the rate of change of the energy splitting as $\\alpha = -\\dot{\\omega}(j_{x,a} - j_{x,b})$. The problem defines $\\alpha_{ab} = |\\dot{\\omega}(j_{x,a} - j_{x,b})| = |\\alpha|$. The linearized energy difference is $\\delta E(\\tau) \\approx \\alpha \\tau$.\n\nA state vector is given by $|\\psi(t)\\rangle = c_a(t)e^{i\\theta(t)}|\\phi_a\\rangle + c_b(t)e^{i\\theta(t)}|\\phi_b\\rangle$, where we can remove a common phase factor $e^{i\\theta(t)}$. By shifting the energy origin to the midpoint of the diabatic energies, $E_{a/b}^{(0)} \\to \\pm \\frac{1}{2}\\alpha\\tau$, the Schrödinger equation becomes a system of coupled ODEs for the amplitudes $c_a$ and $c_b$:\n$$\ni \\frac{d}{d\\tau} \\begin{pmatrix} c_a \\\\ c_b \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}\\alpha\\tau & \\Delta \\\\ \\Delta & -\\frac{1}{2}\\alpha\\tau \\end{pmatrix} \\begin{pmatrix} c_a \\\\ c_b \\end{pmatrix}\n$$\nWe seek the probability of remaining in the initial diabatic state $\\lvert \\phi_a \\rangle$. The initial condition is $|c_a(-\\infty)|^2 = 1$ and $|c_b(-\\infty)|^2=0$. The desired quantity is the survival probability $P_{a \\to a} = |c_a(+\\infty)|^2$.\n\nThis system of equations can be decoupled, leading to a second-order linear ODE for, e.g., $c_b(\\tau)$, which is a form of the Weber differential equation. The exact solution of this system with the specified boundary conditions is a classic result derived by Landau, Zener, Stueckelberg, and Majorana. The probability of a non-adiabatic transition (jumping to the other diabatic state) is:\n$$\nP_{a \\to b} = |c_b(+\\infty)|^2 = 1 - \\exp\\left(-\\frac{2\\pi \\Delta^2}{|\\alpha|}\\right)\n$$\nConsequently, the probability of remaining in the original diabatic state (diabatic survival) is:\n$$\nP_{a \\to a} = 1 - P_{a \\to b} = \\exp\\left(-\\frac{2\\pi \\Delta^2}{|\\alpha|}\\right)\n$$\nSubstituting the problem's definitions, with $a=k_0$ and $b=k$, we have $\\Delta = \\Delta_{k_0 k} = |V_{k_0 k}|$ and $|\\alpha| = |\\dot{\\omega}(j_{x,k_0} - j_{x,k})| = \\dot{\\omega}|j_{x,k_0} - j_{x,k}| = \\dot{\\omega}s_{k_0 k} = \\alpha_{k_0 k}$.\nThe diabatic survival probability for a single crossing is:\n$$\nP_{k_0\\to k_0} = \\exp\\left(-\\frac{2\\pi \\Delta_{k_0 k}^2}{\\alpha_{k_0 k}}\\right) = \\exp\\left(-\\frac{2\\pi \\Delta_{k_0 k}^2}{\\dot{\\omega} s_{k_0 k}}\\right)\n$$\n\n### Step 3: Calculation of Cumulative Survival Probability\n\nAssuming that the avoided crossings are well-separated and can be treated as independent events, the cumulative survival probability for the state $\\lvert k_0 \\rangle$ after sweeping through the entire frequency range is the product of the survival probabilities at each relevant crossing.\n$$\nP_{\\text{total}}(\\dot{\\omega}) = \\prod_{k | \\omega_c(0,k) \\in [\\omega_{\\min},\\omega_{\\max}]} P_{0 \\to 0}^{(0,k)}(\\dot{\\omega})\n$$\nFrom Step 1, we have two relevant crossings, with $k=1$ and $k=2$. Therefore:\n$$\nP_{\\text{total}}(\\dot{\\omega}) = P_{0 \\to 0}^{(0,1)}(\\dot{\\omega}) \\times P_{0 \\to 0}^{(0,2)}(\\dot{\\omega})\n$$\n$$\nP_{\\text{total}}(\\dot{\\omega}) = \\exp\\left(-\\frac{2\\pi \\Delta_{01}^2}{\\dot{\\omega} s_{01}}\\right) \\times \\exp\\left(-\\frac{2\\pi \\Delta_{02}^2}{\\dot{\\omega} s_{02}}\\right) = \\exp\\left[-\\frac{2\\pi}{\\dot{\\omega}}\\left(\\frac{\\Delta_{01}^2}{s_{01}} + \\frac{\\Delta_{02}^2}{s_{02}}\\right)\\right]\n$$\nSubstituting the numerical values for the crossing parameters:\n- Crossing (0,1): $\\Delta_{01} = 0.06$ MeV, $s_{01} = 2.0$.\n- Crossing (0,2): $\\Delta_{02} = 0.08$ MeV, $s_{02} = 3.0$.\n$$\n\\frac{\\Delta_{01}^2}{s_{01}} + \\frac{\\Delta_{02}^2}{s_{02}} = \\frac{(0.06)^2}{2.0} + \\frac{(0.08)^2}{3.0} = \\frac{0.0036}{2.0} + \\frac{0.0064}{3.0} = 0.0018 + \\frac{0.0064}{3} \\approx 0.0039333... \\text{ MeV}^2\n$$\nThe exponent's argument becomes:\n$$\n-\\frac{2\\pi}{\\dot{\\omega}}\\left(0.0018 + \\frac{0.0064}{3}\\right) = -\\frac{2\\pi}{\\dot{\\omega}}\\left(\\frac{18}{10000} + \\frac{64}{30000}\\right) = -\\frac{2\\pi}{\\dot{\\omega}}\\left(\\frac{54+64}{30000}\\right) = -\\frac{2\\pi}{\\dot{\\omega}}\\left(\\frac{118}{30000}\\right)\n$$\nThis expression will be evaluated for each provided sweep rate $\\dot{\\omega}_i$.\n\n### Step 4: Algorithmic Implementation\n\nThe Python code will implement the above calculations.\n1.  Define the input parameters: $\\boldsymbol{\\varepsilon}$, $\\boldsymbol{j}_x$, $V_{kl}$, $\\omega_{\\min}$, $\\omega_{\\max}$, and the list of sweep rates $\\dot{\\omega}_i$.\n2.  Initialize an empty list to store information about the relevant crossings.\n3.  Iterate through all potential crossing partners $k \\in \\{1,2,3,4\\}$.\n4.  For each $k$, calculate the crossing frequency $\\omega_c(0,k)$.\n5.  If $\\omega_c$ falls within $[\\omega_{\\min}, \\omega_{\\max}]$, calculate $\\Delta_{0k}$ and $s_{0k}$ and store them.\n6.  Calculate the constant term $C = \\sum_{k} \\frac{\\Delta_{0k}^2}{s_{0k}}$ over all relevant crossings.\n7.  Iterate through the specified list of sweep rates $\\dot{\\omega}_i$.\n8.  For each $\\dot{\\omega}_i$, compute the total survival probability $P_{\\text{total}}(\\dot{\\omega}_i) = \\exp(-2\\pi C / \\dot{\\omega}_i)$.\n9.  Store each result, rounded to six decimal places, in a list.\n10. Format the final list of probabilities into the required string format `[p1,p2,p3,p4,p5]` for output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the cranking model Landau-Zener problem as specified.\n\n    This function calculates the cumulative diabatic survival probability of a target\n    quasiparticle state as it sweeps through a frequency range containing avoided\n    crossings with other states. The calculation proceeds as follows:\n    1. Defines the physical parameters of the N=5 level system from the problem statement.\n    2. Identifies all diabatic crossings between the target state (k=0) and other\n       states (k=1,2,3,4) that occur within the specified frequency range.\n    3. For each valid crossing, it stores the relevant parameters for the\n       Landau-Zener calculation: the half-gap (coupling strength) and the\n       difference in slopes of the diabatic energies.\n    4. Calculates the cumulative diabatic survival probability for a series of\n       given frequency sweep rates (dw/dt). The cumulative probability is the\n       product of survival probabilities from each independent crossing.\n    5. The Landau-Zener survival probability for a single crossing is computed as\n       P_survival = exp(-2*pi*Delta^2 / (s*dw_dt)), where Delta is the half-gap,\n       s is the slope difference, and dw_dt is the sweep rate.\n    6. The final results for the five specified sweep rates are collected and\n       formatted into a single string as required.\n    \"\"\"\n\n    # --- Step 1: Define parameters from the problem statement ---\n    \n    # Target state index\n    k0 = 0\n    \n    # Diabatic single-quasiparticle energies (MeV)\n    eps = np.array([2.0, 0.5, 1.2, 2.6, 3.0])\n    \n    # Diabatic aligned angular momenta (units of hbar=1)\n    jx = np.array([6.5, 4.5, 3.5, 2.5, 1.5])\n    \n    # Residual coupling matrix V (MeV). Only non-zero off-diagonal elements are needed.\n    V = np.zeros((5, 5))\n    V[0, 1] = V[1, 0] = 0.06\n    V[0, 2] = V[2, 0] = 0.08\n    V[1, 2] = V[2, 1] = 0.02\n    \n    # Rotational frequency range (MeV)\n    omega_min = 0.0\n    omega_max = 0.8\n    \n    # Test suite of sweep rates (MeV^2, since time is in MeV^-1)\n    sweep_rates = [1e-3, 5e-3, 5e-2, 1e-1, 5e-1]\n\n    # --- Step 2: Identify relevant diabatic crossings ---\n    \n    crossings = []\n    num_states = len(eps)\n    \n    for k in range(num_states):\n        if k == k0:\n            continue\n            \n        # Avoid division by zero if jx values are identical\n        delta_jx = jx[k0] - jx[k]\n        if delta_jx == 0:\n            continue\n            \n        # Calculate crossing frequency\n        delta_eps = eps[k0] - eps[k]\n        omega_c = delta_eps / delta_jx\n        \n        # Check if the crossing is within the specified frequency range\n        if omega_min <= omega_c <= omega_max:\n            # This is a relevant crossing. Store its parameters.\n            # Half-gap Delta_k0,k = |V_k0,k|\n            delta = np.abs(V[k0, k])\n            # Slope difference s_k0,k = |jx_k - jx_k0|\n            s = np.abs(jx[k] - jx[k0])\n            \n            # If coupling is zero, it's a true crossing with survival probability 1.\n            # The formula handles this (Delta=0 -> P=exp(0)=1), so no special check needed.\n            crossings.append({'k': k, 'omega_c': omega_c, 'Delta': delta, 's': s})\n\n    # --- Step 3: Compute the cumulative survival probability for each sweep rate ---\n    \n    results = []\n    \n    # Pre-calculate the constant part of the exponent argument sum\n    # Sum of Delta_i^2 / s_i for all relevant crossings\n    exponent_factor_sum = sum(c['Delta']**2 / c['s'] for c in crossings)\n\n    for dw_dt in sweep_rates:\n        # P_total = Product_i P_i = Product_i exp(-arg_i) = exp(-Sum_i arg_i)\n        # arg_i = 2 * pi * Delta_i^2 / (s_i * dw_dt)\n        \n        total_exponent_arg = (2 * np.pi * exponent_factor_sum) / dw_dt\n        \n        # Cumulative diabatic survival probability\n        p_survival = np.exp(-total_exponent_arg)\n        \n        results.append(p_survival)\n        \n    # --- Step 4: Format and print the final output ---\n    \n    # Format results to six decimal places as required\n    output_str = f\"[{','.join(f'{p:.6f}' for p in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}