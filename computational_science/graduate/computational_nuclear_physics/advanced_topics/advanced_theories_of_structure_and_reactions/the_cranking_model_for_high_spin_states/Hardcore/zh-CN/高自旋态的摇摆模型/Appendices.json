{
    "hands_on_practices": [
        {
            "introduction": "在摇摆模型中，核心的数学步骤是将实验室坐标系下的能量$E(I)$通过勒让德变换转换到旋转坐标系下的劳斯量（Routhian）$R(\\omega)$。这个变换揭示了角频率$\\omega$作为共轭变量的角色，并允许我们从一个更基本的角度分析旋转性质。本练习  将指导你亲手完成这一关键的变换过程，从一个唯象的能量表达式出发，推导出劳斯量，并探讨保证转动稳定性的物理条件。",
            "id": "3597888",
            "problem": "在描述转动核的摇摆模型中，通过引入一个与角动量 $\\,I\\,$ 热力学共轭的转动频率 $\\,\\omega\\,$，以及通过对能量 $\\,E(I)\\,$ 进行勒让德变换得到的劳斯量 $\\,R(\\omega)\\,$，来模拟一个转动带。考虑一个参数化的转动能\n$$\nE(I)=\\frac{I(I+1)}{2\\mathcal{J}}+\\alpha\\,I^{4},\n$$\n其中 $\\,\\mathcal{J}\\,$ 是一个正的转动惯量，$\\,\\alpha\\,$ 是一个模拟高角动量刚度的小参数。将 $\\,I\\,$ 视为适用于大角动量的连续变量。\n\n从应用于摇摆模型的热力学共轭和勒让德变换的第一性原理出发：\n- 推导转动频率 $\\,\\omega(I)=\\partial E/\\partial I\\,$。\n- 将勒让德变换得到的劳斯量 $\\,R(\\omega)\\,$ 构造为在 $\\,\\omega\\,$ 固定时 $\\,E(I)-\\omega I\\,$ 关于 $\\,I\\,$ 的最小值。在计算中一致地保留到 $\\,\\alpha\\,$ 的领头阶，即保留至 $\\,\\mathcal{O}(\\alpha)\\,$ 的项，并忽略 $\\,\\mathcal{O}(\\alpha^{2})\\,$ 及更高阶的项。\n- 讨论稳定性判据 $\\,\\partial I/\\partial\\omega>0\\,$，用 $\\,\\mathcal{J}\\,$, $\\,\\alpha\\,$ 和 $\\,I\\,$ 表示，并将其与 $\\,E(I)\\,$ 的凸性联系起来。\n\n你的最终答案必须是 $\\,R(\\omega)\\,$ 在 $\\,\\alpha\\,$ 领头阶下的闭式解析表达式。不需要进行数值计算，最终表达式中也不应包含单位。",
            "solution": "首先验证问题，以确保其具有科学依据、提法恰当且客观。\n\n### 第 1 步：提取已知条件\n- 转动能由以下参数化形式给出：$E(I)=\\frac{I(I+1)}{2\\mathcal{J}}+\\alpha\\,I^{4}$。\n- 转动惯量 $\\mathcal{J}$ 是一个正常数：$\\mathcal{J}>0$。\n- 参数 $\\alpha$ 很小，这意味着摄动方法是合适的。\n- 角动量 $I$ 被视为连续变量。\n- 转动频率 $\\omega$ 定义为能量对角动量的导数：$\\omega(I)=\\frac{\\partial E}{\\partial I}$。\n- 劳斯量 $R(\\omega)$ 是能量 $E(I)$ 的勒让德变换：$R(\\omega) = \\min_I (E(I)-\\omega I)$。\n- 计算需要一致地进行到 $\\alpha$ 的领头阶，记为 $\\mathcal{O}(\\alpha)$。\n- 给出了一个稳定性判据 $\\frac{\\partial I}{\\partial\\omega}>0$，需要对此进行讨论。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了摇摆模型，这是理论核结构物理中用于模拟高角动量态的基石。能量表达式是一个标准的唯象形式，包含一个转子项和一个对核刚度的高阶修正。通过勒让德变换定义的转动频率和劳斯量是此形式体系的基础。该问题牢固地植根于物理学的既定原理。\n- **提法恰当**：该问题提法恰当。它提供了所有必要的定义和方程。在一个小参数下计算到特定阶 ($\\mathcal{O}(\\alpha)$) 的指令为得到唯一解提供了一条清晰无歧义的路径。\n- **客观性**：该问题以精确、正式的语言陈述，没有任何主观性或歧义。\n\n### 第 3 步：结论与行动\n问题有效。将提供完整的解答。\n\n### 解答推导\n\n解答按要求分为三部分：推导转动频率 $\\omega(I)$，构造劳斯量 $R(\\omega)$ 至 $\\alpha$ 的一阶，以及讨论转动的稳定性。\n\n**1. 推导转动频率 $\\omega(I)$**\n\n转动频率 $\\omega$ 定义为能量 $E(I)$ 对角动量 $I$ 的一阶导数。\n给定能量表达式：\n$$E(I)=\\frac{I(I+1)}{2\\mathcal{J}}+\\alpha\\,I^{4} = \\frac{I^2+I}{2\\mathcal{J}}+\\alpha\\,I^{4}$$\n我们将 $E(I)$ 对 $I$ 求导，并将 $I$ 视为连续变量：\n$$\\omega(I) = \\frac{\\partial E}{\\partial I} = \\frac{\\partial}{\\partial I} \\left( \\frac{I^2+I}{2\\mathcal{J}}+\\alpha\\,I^{4} \\right)$$\n进行微分，我们得到：\n$$\\omega(I) = \\frac{2I+1}{2\\mathcal{J}} + 4\\alpha I^3$$\n该表达式给出了作为角动量 $I$ 函数的转动频率。第一项对应于刚性转子，而第二项是由刚度参数 $\\alpha$ 引起的修正。\n\n**2. 构造劳斯量 $R(\\omega)$**\n\n劳斯量 $R(\\omega)$ 是 $E(I)$ 的勒让德变换，定义为 $R(\\omega) = E(I) - \\omega I$，其值在使该表达式对于给定 $\\omega$ 最小化的 $I$ 处计算。这个最小化条件正是 $\\frac{\\partial}{\\partial I}(E(I) - \\omega I) = 0$，由此得出 $\\frac{\\partial E}{\\partial I} = \\omega$。\n\n这意味着我们必须首先反转关系式 $\\omega(I)$ 以求出 $I$ 作为 $\\omega$ 的函数，记为 $I(\\omega)$。需要求解的方程是：\n$$\\omega = \\frac{2I+1}{2\\mathcal{J}} + 4\\alpha I^3$$\n这是一个关于 $I$ 的三次方程，难以精确求解。然而，由于 $\\alpha$ 是一个小参数，我们可以用摄动法求 $I(\\omega)$。\n\n令 $E(I) = E_0(I) + \\alpha E_1(I)$，其中 $E_0(I) = \\frac{I(I+1)}{2\\mathcal{J}}$ 且 $E_1(I) = I^4$。\n劳斯量可以写成 $R(\\omega, \\alpha)$。我们寻求一个精确到 $\\alpha$ 一阶的 $R$ 的表达式。我们可以使用 Hellmann-Feynman 定理（或包络线定理），该定理指出变换后的函数对某个参数的导数等于原函数对该参数的偏导数，并在驻点处取值。\n$$ \\frac{\\partial R}{\\partial \\alpha} = \\frac{\\partial}{\\partial \\alpha} (E(I) - \\omega I) \\bigg|_{I=I(\\omega)} = \\frac{\\partial}{\\partial \\alpha} \\left( \\frac{I(I+1)}{2\\mathcal{J}} + \\alpha I^4 - \\omega I \\right) \\bigg|_{I=I(\\omega)} = I(\\omega)^4 $$\n为了求出 $R(\\omega)$ 直到 $\\mathcal{O}(\\alpha)$ 阶，我们可以将此表达式对 $\\alpha$ 从 $0$ 积分到 $\\alpha$：\n$$ R(\\omega, \\alpha) \\approx R(\\omega, 0) + \\int_0^\\alpha \\frac{\\partial R}{\\partial \\alpha'} \\bigg|_{\\alpha'=0} d\\alpha' = R_0(\\omega) + \\alpha \\left( \\frac{\\partial R}{\\partial \\alpha} \\bigg|_{\\alpha=0} \\right) $$\n根据上面的导数，$\\frac{\\partial R}{\\partial \\alpha} \\big|_{\\alpha=0} = I(\\omega, \\alpha=0)^4$。我们记 $I_0(\\omega) = I(\\omega, \\alpha=0)$。\n所以，劳斯量到 $\\alpha$ 一阶的表达式为：\n$$R(\\omega) \\approx R_0(\\omega) + \\alpha I_0(\\omega)^4$$\n其中 $R_0(\\omega)$ 是未扰动系统（$\\alpha=0$）的劳斯量，$I_0(\\omega)$ 是未扰动系统的角动量。\n\n首先，我们在 $\\omega(I)$ 方程中令 $\\alpha=0$ 来求 $I_0(\\omega)$：\n$$\\omega = \\omega_0(I_0) = \\frac{2I_0+1}{2\\mathcal{J}}$$\n解出 $I_0$：\n$$2\\mathcal{J}\\omega = 2I_0 + 1 \\implies I_0(\\omega) = \\mathcal{J}\\omega - \\frac{1}{2}$$\n接下来，我们求未扰动的劳斯量 $R_0(\\omega)$：\n$$R_0(\\omega) = E_0(I_0) - \\omega I_0 = \\frac{I_0(I_0+1)}{2\\mathcal{J}} - \\omega I_0$$\n代入 $I_0(\\omega) = \\mathcal{J}\\omega - \\frac{1}{2}$：\n$$I_0(I_0+1) = \\left(\\mathcal{J}\\omega - \\frac{1}{2}\\right)\\left(\\mathcal{J}\\omega + \\frac{1}{2}\\right) = (\\mathcal{J}\\omega)^2 - \\left(\\frac{1}{2}\\right)^2 = \\mathcal{J}^2\\omega^2 - \\frac{1}{4}$$\n所以，\n$$R_0(\\omega) = \\frac{\\mathcal{J}^2\\omega^2 - \\frac{1}{4}}{2\\mathcal{J}} - \\omega\\left(\\mathcal{J}\\omega - \\frac{1}{2}\\right) = \\frac{\\mathcal{J}\\omega^2}{2} - \\frac{1}{8\\mathcal{J}} - \\mathcal{J}\\omega^2 + \\frac{\\omega}{2}$$\n$$R_0(\\omega) = -\\frac{\\mathcal{J}\\omega^2}{2} + \\frac{\\omega}{2} - \\frac{1}{8\\mathcal{J}}$$\n最后，我们组合出完整的、到 $\\alpha$ 一阶的劳斯量：\n$$R(\\omega) \\approx R_0(\\omega) + \\alpha I_0(\\omega)^4 = \\left(-\\frac{\\mathcal{J}\\omega^2}{2} + \\frac{\\omega}{2} - \\frac{1}{8\\mathcal{J}}\\right) + \\alpha \\left(\\mathcal{J}\\omega - \\frac{1}{2}\\right)^4$$\n这就是所要求的劳斯量在 $\\alpha$ 领头阶下的表达式。\n\n**3. 稳定性判据的讨论**\n\n转动运动的稳定性判据为 $\\frac{\\partial I}{\\partial \\omega} > 0$。这意味着要使转动稳定，角动量 $I$ 必须是转动频率 $\\omega$ 的单调递增函数。\n使用反函数定理，$\\frac{\\partial I}{\\partial \\omega} = \\left(\\frac{\\partial \\omega}{\\partial I}\\right)^{-1}$。因此，条件 $\\frac{\\partial I}{\\partial \\omega} > 0$ 等价于 $\\frac{\\partial \\omega}{\\partial I} > 0$（假设 $\\frac{\\partial \\omega}{\\partial I}$ 不为零或无穷大）。\n\n我们从已推导的 $\\omega(I)$ 表达式计算 $\\frac{\\partial \\omega}{\\partial I}$：\n$$\\frac{\\partial \\omega}{\\partial I} = \\frac{\\partial}{\\partial I}\\left(\\frac{2I+1}{2\\mathcal{J}} + 4\\alpha I^3\\right) = \\frac{2}{2\\mathcal{J}} + 12\\alpha I^2 = \\frac{1}{\\mathcal{J}} + 12\\alpha I^2$$\n因此，稳定性条件是：\n$$\\frac{1}{\\mathcal{J}} + 12\\alpha I^2 > 0$$\n由于给定 $\\mathcal{J}>0$，$1/\\mathcal{J}$ 是正的。我们根据 $\\alpha$ 的符号来分析稳定性：\n- 如果 $\\alpha \\geq 0$：项 $12\\alpha I^2$ 是非负的。和 $\\frac{1}{\\mathcal{J}} + 12\\alpha I^2$ 总是严格为正。因此，对于 $\\alpha \\geq 0$，转动对于所有角动量 $I$ 的值都是稳定的。\n- 如果 $\\alpha < 0$：令 $\\alpha = -|\\alpha|$。稳定性条件变为 $\\frac{1}{\\mathcal{J}} - 12|\\alpha|I^2 > 0$。此不等式仅在 $12|\\alpha|I^2 < \\frac{1}{\\mathcal{J}}$ 时成立，即 $I^2 < \\frac{1}{12|\\alpha|\\mathcal{J}}$。转动仅在角动量低于临界值 $I_{crit} = \\sqrt{\\frac{1}{12|\\alpha|\\mathcal{J}}}$ 时稳定。高于此角动量，系统变得不稳定（$\\frac{\\partial I}{\\partial \\omega} < 0$），这一现象被称为回弯。\n\n这个稳定性判据与能量函数 $E(I)$ 的凸性直接相关。如果一个函数的二阶导数为正，则该函数是严格凸的。我们来考察 $E(I)$ 的二阶导数：\n$$\\frac{\\partial^2 E}{\\partial I^2} = \\frac{\\partial}{\\partial I}\\left(\\frac{\\partial E}{\\partial I}\\right) = \\frac{\\partial \\omega}{\\partial I}$$\n因此，稳定性条件 $\\frac{\\partial \\omega}{\\partial I} > 0$ 与能量严格凸性的数学条件 $\\frac{\\partial^2 E}{\\partial I^2} > 0$ 是相同的。不稳定的转动区域对应于 $E(I)$ 曲线的非凸（凹）区域。",
            "answer": "$$\\boxed{-\\frac{\\mathcal{J}\\omega^2}{2} + \\frac{\\omega}{2} - \\frac{1}{8\\mathcal{J}} + \\alpha \\left(\\mathcal{J}\\omega - \\frac{1}{2}\\right)^4}$$"
        },
        {
            "introduction": "核物理中的“回弯”（backbending）现象是高自旋态研究中的一个标志性特征，它反映了原子核内部结构的剧烈变化。为了直观地理解这一复杂的量子多体效应，我们可以构建一个简化的经典力学模型。本练习  邀请你分析一个双转子玩具模型，通过推导其内在振动模式与外部转动频率之间的共振条件，来揭示回弯现象背后的物理本质。",
            "id": "3597947",
            "problem": "考虑一个用于描述高自旋核态的最小半经典双转子玩具模型。其中一个转子代表偶偶核芯的集体转动，另一个代表单个准粒子的有效转动响应。设集体转子的角度为 $\\,\\phi_{c}(t)\\,$，其转动惯量为 $\\,I_{c}\\,$；单粒子转子的角度为 $\\,\\phi_{s}(t)\\,$，其转动惯量为 $\\,I_{s}\\,$。假设两个转子通过一种抑制其相对剪切的相互作用进行谐振耦合，该相互作用由势能 $\\,V=\\tfrac{1}{2}\\,\\kappa\\,(\\phi_{s}-\\phi_{c})^{2}\\,$ 建模，其中刚度 $\\,\\kappa>0\\,$。总动能为 $\\,T=\\tfrac{1}{2}\\,I_{c}\\,\\dot{\\phi}_{c}^{2}+\\tfrac{1}{2}\\,I_{s}\\,\\dot{\\phi}_{s}^{2}\\,$。\n\n在摇摆方法中，通过绕同一轴施加一个均匀的角频率 $\\,\\omega\\,$ 来研究稳定转动。一个均匀同相转动解具有 $\\,\\phi_{c}(t)=\\phi_{s}(t)=\\omega t\\,$ 的形式。在此玩具模型中，回弯被解释为一种动力学不稳定性，由外部施加的转动频率与耦合转子的内禀异相简正模式之间的共振引起。从拉格朗日力学的第一性原理出发，推导耦合系统的内禀异相简正模式频率，然后施加共振条件，即转动频率 $\\,\\omega\\,$ 等于该内禀频率，以获得该模型中回弯开始时的临界转动角频率 $\\,\\omega_{b}\\,$。\n\n将 $\\,\\omega_{b}\\,$ 表示为以 $\\,I_{c}\\,$, $\\,I_{s}\\,$ 和 $\\,\\kappa\\,$ 表示的闭式解析表达式。您的最终答案必须是单一的解析表达式。最终的角频率以弧度/秒为单位表示。无需进行数值计算。",
            "solution": "该问题在科学上是成立的、良定的且自洽的，因此是有效的。我们开始进行求解。\n\n该系统由两个广义坐标描述，即集体转子角度 $\\phi_c(t)$ 和单粒子转子角度 $\\phi_s(t)$。拉格朗日量 $L$ 定义为总动能 $T$ 和势能 $V$ 之差。\n\n动能 $T$ 给出如下：\n$$T = \\frac{1}{2} I_c \\dot{\\phi}_c^2 + \\frac{1}{2} I_s \\dot{\\phi}_s^2$$\n其中 $I_c$ 和 $I_s$ 是转动惯量，$\\dot{\\phi}_c$ 和 $\\dot{\\phi}_s$ 是角速度。\n\n谐振耦合的势能 $V$ 给出如下：\n$$V = \\frac{1}{2} \\kappa (\\phi_s - \\phi_c)^2$$\n其中 $\\kappa$ 是刚度常数。\n\n因此，耦合转子系统的拉格朗日量为：\n$$L = T - V = \\frac{1}{2} I_c \\dot{\\phi}_c^2 + \\frac{1}{2} I_s \\dot{\\phi}_s^2 - \\frac{1}{2} \\kappa (\\phi_s - \\phi_c)^2$$\n\n为求系统的运动方程，我们对每个坐标 $q_i$ 应用欧拉-拉格朗日方程：\n$$\\frac{d}{dt} \\left( \\frac{\\partial L}{\\partial \\dot{q}_i} \\right) - \\frac{\\partial L}{\\partial q_i} = 0$$\n\n对于坐标 $\\phi_c$：\n$$\\frac{\\partial L}{\\partial \\dot{\\phi}_c} = I_c \\dot{\\phi}_c$$\n$$\\frac{\\partial L}{\\partial \\phi_c} = - \\frac{1}{2} \\kappa \\cdot 2(\\phi_s - \\phi_c) \\cdot (-1) = \\kappa(\\phi_s - \\phi_c) = -\\kappa(\\phi_c - \\phi_s)$$\n$\\phi_c$ 的运动方程是：\n$$\\frac{d}{dt} (I_c \\dot{\\phi}_c) - [-\\kappa(\\phi_c - \\phi_s)] = 0$$\n$$I_c \\ddot{\\phi}_c + \\kappa(\\phi_c - \\phi_s) = 0$$\n\n对于坐标 $\\phi_s$：\n$$\\frac{\\partial L}{\\partial \\dot{\\phi}_s} = I_s \\dot{\\phi}_s$$\n$$\\frac{\\partial L}{\\partial \\phi_s} = - \\frac{1}{2} \\kappa \\cdot 2(\\phi_s - \\phi_c) \\cdot (1) = -\\kappa(\\phi_s - \\phi_c)$$\n$\\phi_s$ 的运动方程是：\n$$\\frac{d}{dt} (I_s \\dot{\\phi}_s) - [-\\kappa(\\phi_s - \\phi_c)] = 0$$\n$$I_s \\ddot{\\phi}_s + \\kappa(\\phi_s - \\phi_c) = 0$$\n\n我们得到一个由两个耦合线性齐次二阶微分方程组成的方程组：\n$$I_c \\ddot{\\phi}_c + \\kappa\\phi_c - \\kappa\\phi_s = 0$$\n$$I_s \\ddot{\\phi}_s - \\kappa\\phi_c + \\kappa\\phi_s = 0$$\n\n为了找到简正模式频率，我们寻找形如 $\\phi_c(t) = A e^{i\\Omega t}$ 和 $\\phi_s(t) = B e^{i\\Omega t}$ 的振荡解。将这些解代入运动方程，得到关于振幅 $A$ 和 $B$ 的代数方程组：\n$$(-\\Omega^2 I_c + \\kappa)A - \\kappa B = 0$$\n$$-\\kappa A + (-\\Omega^2 I_s + \\kappa)B = 0$$\n\n该方程组可以写成矩阵形式 $(K - \\Omega^2 M)\\vec{v} = 0$，其中 $\\vec{v} = \\begin{pmatrix} A \\\\ B \\end{pmatrix}$，质量矩阵为 $M = \\begin{pmatrix} I_c & 0 \\\\ 0 & I_s \\end{pmatrix}$，刚度矩阵为 $K = \\begin{pmatrix} \\kappa & -\\kappa \\\\ -\\kappa & \\kappa \\end{pmatrix}$。\n\n为了存在非平凡解，系数矩阵的行列式必须为零：\n$$\\det \\begin{pmatrix} \\kappa - \\Omega^2 I_c & -\\kappa \\\\ -\\kappa & \\kappa - \\Omega^2 I_s \\end{pmatrix} = 0$$\n\n计算行列式：\n$$(\\kappa - \\Omega^2 I_c)(\\kappa - \\Omega^2 I_s) - (-\\kappa)(-\\kappa) = 0$$\n$$\\kappa^2 - \\kappa\\Omega^2 I_s - \\kappa\\Omega^2 I_c + \\Omega^4 I_c I_s - \\kappa^2 = 0$$\n$$\\Omega^4 I_c I_s - \\Omega^2 \\kappa(I_c + I_s) = 0$$\n$$\\Omega^2 \\left[ \\Omega^2 I_c I_s - \\kappa(I_c + I_s) \\right] = 0$$\n\n这个特征方程给出了 $\\Omega^2$ 的两个可能值：\n1. $\\Omega^2 = 0$。这对应于零频简正模式，即整个系统在没有任何恢复力的情况下的均匀同相转动（$\\phi_c = \\phi_s$）。这是集体转动模式。\n\n2. $\\Omega^2 I_c I_s - \\kappa(I_c + I_s) = 0$。这给出了第二个简正模式的频率：\n$$\\Omega^2 = \\frac{\\kappa(I_c + I_s)}{I_c I_s}$$\n这个非零频率对应于两个转子的内禀异相振荡，即它们相互反向振荡。这就是我们寻求的内禀频率。\n我们记作 $\\Omega_{intr}$ 的内禀异相简正模式频率为：\n$$\\Omega_{intr} = \\sqrt{\\frac{\\kappa(I_c + I_s)}{I_c I_s}} = \\sqrt{\\kappa \\left(\\frac{1}{I_c} + \\frac{1}{I_s}\\right)}$$\n\n问题陈述，当外部施加的转动频率 $\\omega$ 与此内禀异相简正模式发生共振时，回弯开始。因此，临界转动角频率 $\\omega_b$ 等于 $\\Omega_{intr}$。\n$$\\omega_b = \\Omega_{intr}$$\n\n因此，回弯开始时的临界转动角频率为：\n$$\\omega_b = \\sqrt{\\kappa \\left(\\frac{1}{I_c} + \\frac{1}{I_s}\\right)}$$\n$\\kappa$ 的单位是 能量/角度$^2$，或 $M L^2 T^{-2}$，而 $I$ 的单位是 $M L^2$。平方根下的表达式的单位是 $(M L^2 T^{-2}) / (M L^2) = T^{-2}$，因此 $\\omega_b$ 的单位是 $T^{-1}$（弧度/秒），符合要求。",
            "answer": "$$\\boxed{\\sqrt{\\kappa \\left(\\frac{1}{I_c} + \\frac{1}{I_s}\\right)}}$$"
        },
        {
            "introduction": "回弯等高自旋现象的微观根源在于科里奥利力与核子间的对力配对（pairing）相互作用之间的竞争。随着转动频率$\\omega$的增加，旋转的“离心力”会试图拆散库珀对。本计算练习  要求你编写程序，在一个简化的单$j$壳层模型中实现摇摆BCS方法，通过逐步增加$\\omega$来模拟对力配对被破坏的过程，并最终确定对力坍缩的临界频率。",
            "id": "3597894",
            "problem": "考虑一个在零温下、转动（摇摆）平均场框架中的、具有恒定对力的单-$j$壳层模型。转动坐标系中的劳斯量定义为 $H' = H - \\omega J_x$，其中 $H$ 是实验室坐标系中的哈密顿量，$\\omega$ 是转动频率（角频率），而 $J_x$ 是总角动量算符的 $x$ 分量。假设在一个总角动量为 $j$ 的单一球形壳层内，作用着强度为 $G$ 的恒定对力相互作用，其 $2\\Omega$ 个磁亚态构成了活性价空间。取 $\\Omega = j + \\tfrac{1}{2}$，因此该壳层包含 $2\\Omega$ 个单粒子态。在自然单位制（$\\hbar = 1$）下进行计算，因此能量和角频率的单位均为兆电子伏（MeV）。\n\n从离散时间反演轨道中恒定对力的Bardeen–Cooper–Schrieffer (BCS) 变分原理以及转动坐标系的定义出发。仅使用以下基本事实作为起点：\n- 劳斯量为 $H' = H - \\omega J_x$。\n- 在单-$j$壳层中，可以选择一组对角化 $J_x$ 的基，其本征值 $m_x$ 的取值范围为 $\\{-j,-j+1,\\dots,j\\}$，步长为 $1$（包括半整数）。\n- 对于恒定对力相互作用，零温Bardeen–Cooper–Schrieffer (BCS) 基态是通过最小化 $H'$ 在一个由振幅 $u_k$ 和 $v_k$ 表征的准粒子真空中的期望值得到的，同时满足粒子数约束。\n\n您必须：\n1. 在单-$j$壳层中，使用上述基本定义，构建零温下转动坐标系中恒定对力相互作用的BCS方程。将摇摆项视为一个与 $J_x$ 呈线性的单体项，并采用标准的seniority阻塞机制处理对破裂：当一个准粒子劳斯量穿过零时，相应的时间反演对将从对凝聚体中被移除（阻塞），并在粒子数减少二、对简并度减少一的约化空间中重新求解BCS问题。随着 $\\omega$ 的增加，持续此过程。\n2. 对于每个未阻塞的对，计算准粒子劳斯量作为 $\\omega$ 的函数，并计算相应磁亚态的占据几率 $v_k^2(\\omega)$。假设对于未阻塞（成对）的能级，时间反演对的两个成员具有相等的占据几率；而对于阻塞对，对齐的亚态占据几率为 $1$，其时间反演伴侣的占据几率为 $0$。\n3. 确定对力场塌缩时的 $\\omega$ 值，该值定义为在上述阻塞程序下，具有对能隙 $\\Delta(\\omega) > 0$ 的非平凡解不复存在的最小 $\\omega$ 值。\n\n您的程序必须实现一个数值稳健的算法，对于每种情况，该算法会向上扫描 $\\omega$，每当一个未阻塞对的准粒子劳斯量首次达到零时，便自洽地应用阻塞步骤，在约化空间中重新计算Bardeen–Cooper–Schrieffer (BCS) 解，并继续此过程直到对力塌缩。具体来说，它必须：\n- 构建正磁量子数集合 $m = j, j-1, \\dots, \\tfrac{1}{2}$（这些定义了时间反演对 $\\pm m$）。\n- 对于给定的未阻塞集合和粒子数，在约化空间中求解恒定对力的零温BCS方程，并计算转动坐标系中未阻塞对的准粒子劳斯量。\n- 在任何未阻塞对的最低准粒子劳斯量达到零的最小 $\\omega$ 处，确定并应用下一次阻塞事件。\n- 继续此过程，直到没有剩余的成对粒子，或直到对能隙 $\\Delta$ 消失。\n\n所有角频率必须以MeV为单位（$\\hbar = 1$），并且您最终报告的结果必须四舍五入到六位小数。\n\n测试套件：\n为以下四个参数集实现您的程序，每个参数集由 $(j, N, G)$ 指定，其中 $j$ 是壳层的单粒子总角动量，$N$ 是占据 $2\\Omega$ 个状态的偶数粒子数，$G$ 是以MeV为单位的恒定对力强度：\n- 情况1（一般壳层中间）：$(j = 15/2, N = 8, G = 0.5)$\n- 情况2（一般壳层中间）：$(j = 11/2, N = 6, G = 0.3)$\n- 情况3（偏离壳层中间）：$(j = 9/2, N = 4, G = 0.4)$\n- 情况4（边界小体系）：$(j = 3/2, N = 2, G = 0.2)$\n\n对于每种情况，您的程序必须根据上述程序计算塌缩频率 $\\omega_{\\mathrm{coll}}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个塌缩频率，以逗号分隔的列表形式封装在方括号中，顺序与上述情况相同，每个值四舍五入到六位小数，例如：“[x1,x2,x3,x4]”。",
            "solution": "用户希望在摇摆模型和采用特定阻塞机制的零温BCS理论下，找到单-$j$壳层模型中的对塌缩频率 $\\omega_{\\text{coll}}$。\n\n### 1. 理论阐述\n\n我们考虑一个总角动量为 $j$、由 $N$ 个粒子占据的单一球形壳层。该壳层包含 $2\\Omega = 2(j+\\tfrac{1}{2})$ 个简并的单粒子态。实验室坐标系中的哈密顿量为 $H = H_{\\text{sp}} + H_{\\text{pair}}$，其中 $H_{\\text{sp}}$ 是单粒子部分，$H_{\\text{pair}}$ 是对力相互作用。不失一般性，我们可以将简并的单粒子能级设为零，即 $\\epsilon_k=0$。在转动坐标系中，问题由劳斯量 $H' = H - \\omega J_x$ 描述，其中 $\\omega$ 是转动频率，$J_x$ 是沿转动轴的角动量算符。我们在态 $|m\\rangle$ 的基中工作，这些态是 $J_x$ 的本征态，本征值为 $m \\in \\{-j, -j+1, \\dots, j\\}$。劳斯量的单粒子部分在此基中是对角的，其本征值（单粒子劳斯量）为 $e'_m = -\\omega m$。\n\n恒定对力相互作用 $H_{\\text{pair}} = -G \\sum_{k,k'>0} c_{k}^\\dagger c_{\\bar{k}}^\\dagger c_{\\bar{k}'} c_{k'}$ 在时间反演态之间起作用，在此基中对应于对 $(m, -m)$。此问题使用BCS近似求解，并基于seniority阻塞机制进行迭代更新。\n\n### 2. 迭代BCS解与阻塞\n\n该过程涉及为一个逐渐变小的活性（未阻塞）对集合迭代求解BCS方程。设 $\\mathcal{P}$ 为未阻塞对的集合，由其正磁量子数 $m_k$ 表示，并设 $|\\mathcal{P}|$ 为此类对的数量。设 $N_{\\text{rem}}$ 为分布在这些对中的粒子数。\n\n在每一步，我们为一组能量为 $\\epsilon=0$、粒子数为 $N_{\\text{rem}}$ 的 $|\\mathcal{P}|$ 个双重简并能级求解标准的零温BCS方程。\n粒子数方程为：\n$$N_{\\text{rem}} = \\sum_{k \\in \\mathcal{P}} 2 v_k^2 = \\sum_{k \\in \\mathcal{P}} \\left(1 - \\frac{-\\lambda}{\\sqrt{(-\\lambda)^2 + \\Delta^2}}\\right) = |\\mathcal{P}| \\left(1 + \\frac{\\lambda}{\\sqrt{\\lambda^2 + \\Delta^2}}\\right)$$\n能隙方程为：\n$$1 = \\frac{G}{2} \\sum_{k \\in \\mathcal{P}} \\frac{1}{\\sqrt{(-\\lambda)^2 + \\Delta^2}} = \\frac{G |\\mathcal{P}|}{2\\sqrt{\\lambda^2 + \\Delta^2}}$$\n这里，$\\lambda$ 是化学势，$\\Delta$ 是对能隙。\n\n求解此方程组以得到 $\\lambda$ 和 $\\Delta$：\n从能隙方程可知，非转动准粒子能量 $E_0 = \\sqrt{\\lambda^2 + \\Delta^2}$ 对于凝聚体中的所有对都是一个常数：\n$$E_0 = \\frac{G|\\mathcal{P}|}{2}$$\n将此代入粒子数方程，得到化学势：\n$$N_{\\text{rem}} = |\\mathcal{P}| \\left(1 + \\frac{\\lambda}{E_0}\\right) \\implies \\lambda = E_0 \\left(\\frac{N_{\\text{rem}}}{|\\mathcal{P}|} - 1\\right) = \\frac{G}{2}(N_{\\text{rem}} - |\\mathcal{P}|)$$\n然后可以从 $\\Delta^2 = E_0^2 - \\lambda^2$ 计算对能隙 $\\Delta$：\n$$\\Delta^2 = \\left(\\frac{G|\\mathcal{P}|}{2}\\right)^2 - \\left(\\frac{G}{2}(N_{\\text{rem}}-|\\mathcal{P}|)\\right)^2 = \\left(\\frac{G}{2}\\right)^2 \\left(|\\mathcal{P}|^2 - (N_{\\text{rem}}-|\\mathcal{P}|)^2\\right)$$\n$$\\Delta = \\frac{G}{2} \\sqrt{(|\\mathcal{P}| - (N_{\\text{rem}}-|\\mathcal{P}|)) (|\\mathcal{P}| + (N_{\\text{rem}}-|\\mathcal{P}|))} = \\frac{G}{2} \\sqrt{(2|\\mathcal{P}| - N_{\\text{rem}}) N_{\\text{rem}}}$$\n只有当根号下的项为正时，即 $0 < N_{\\text{rem}} < 2|\\mathcal{P}|$ 时，才存在非平凡的对解（$\\Delta > 0$）。如果不满足此条件，对力就会塌缩（$\\Delta=0$）。\n\n### 3. 转动效应与对阻塞\n\n在转动坐标系中，对 $k$ 的准粒子劳斯量因摇摆项而分裂：\n$$E'_{k, \\text{aligned}} = E_0 - \\omega m_k$$\n$$E'_{k, \\text{anti-aligned}} = E_0 + \\omega m_k$$\n根据问题描述，当一个对的最低准粒子劳斯量首次达到零时，该对被阻塞。对于 $\\omega > 0$，这发生在对齐态（$E'_{k, \\text{aligned}}$）。只要所有 $E'_{k, \\text{aligned}} > 0$，系统就保持稳定。随着 $\\omega$ 的增加，第一个变得不稳定的对是具有最小临界频率 $\\omega_c(k) = E_0 / m_k$ 的那一个。这对应于具有最大磁量子数 $m_{\\text{max}} = \\max\\{m_k | k \\in \\mathcal{P}\\}$ 的未阻塞对。\n因此，下一次阻塞事件发生在：\n$$\\omega_{\\text{next}} = \\frac{E_0}{m_{\\text{max}}} = \\frac{G|\\mathcal{P}|}{2m_{\\text{max}}}$$\n当达到此频率时，具有 $m_{\\text{max}}$ 的对被阻塞。在计算的下一步中，该对从集合 $\\mathcal{P}$ 中移除，剩余凝聚体的粒子数减少二，即 $N_{\\text{rem}} \\to N_{\\text{rem}} - 2$。\n\n### 4. 寻找塌缩频率的算法\n\n对塌缩频率 $\\omega_{\\text{coll}}$ 通过以下迭代算法找到：\n\n1.  **初始化**:\n    - 从完整的对集合 $\\mathcal{P}_0$ 开始，对应于 $m_k \\in \\{j, j-1, \\dots, \\tfrac{1}{2}\\}$。\n    - 设置初始剩余粒子数 $N_{\\text{rem}} = N$。\n    - 初始化塌缩频率候选值 $\\omega_{\\text{coll}} = 0$。\n\n2.  **迭代**:\n    - 只要满足非平凡对解的条件（$0 < N_{\\text{rem}} < 2|\\mathcal{P}|$），就循环。在每次迭代中：\n        a. 计算非转动准粒子能量 $E_0 = \\frac{G|\\mathcal{P}|}{2}$。\n        b. 在当前未阻塞对的集合 $\\mathcal{P}$ 中，确定最大的磁量子数 $m_{\\text{max}}$。\n        c. 计算下一次阻塞事件的频率：$\\omega_{\\text{next}} = E_0 / m_{\\text{max}}$。该值被存储为当前的 $\\omega_{\\text{coll}}$ 候选值。\n        d. 更新系统以进入下一个状态：从 $\\mathcal{P}$ 中移除 $m_{\\text{max}}$（因此 $|\\mathcal{P}| \\to |\\mathcal{P}|-1$），并将粒子数减少二（$N_{\\text{rem}} \\to N_{\\text{rem}}-2$）。\n\n3.  **终止**:\n    - 当非平凡对解的条件被违反时（即当 $N_{\\text{rem}} \\leq 0$ 或 $N_{\\text{rem}} \\geq 2|\\mathcal{P}|$ 时），循环终止。\n    - 塌缩频率 $\\omega_{\\text{coll}}$ 是最后计算出的 $\\omega_{\\text{next}}$ 值，该值是系统转变为塌缩状态时的频率。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the pairing collapse frequency for a single-j shell in the cranking model.\n\n    The function implements an iterative algorithm based on the Bardeen-Cooper-Schrieffer (BCS)\n    theory with a seniority-blocking mechanism. At each step, it solves the BCS equations\n    analytically for a set of unblocked degenerate levels to find the pairing gap (Delta)\n    and quasiparticle energy (E0). It then determines the rotational frequency (omega) at which\n    the next pair becomes blocked. This process is repeated, reducing the number of active pairs\n    and particles, until the pairing gap collapses to zero. The frequency at which this\n    collapse occurs is reported.\n    \"\"\"\n\n    test_cases = [\n        # (j, N, G)\n        (15/2, 8, 0.5),  # Case 1\n        (11/2, 6, 0.3),  # Case 2\n        (9/2, 4, 0.4),   # Case 3\n        (3/2, 2, 0.2)    # Case 4\n    ]\n\n    results = []\n    for j, N, G in test_cases:\n        # Generate the list of positive magnetic quantum numbers m_x\n        # from j down to 1/2 in steps of 1.\n        unblocked_m = list(np.arange(j, 0, -1.0))\n        n_rem = float(N)\n        omega_coll = 0.0\n\n        while True:\n            num_pairs = len(unblocked_m)\n\n            # Check for pairing collapse conditions.\n            # A non-trivial solution (Delta > 0) exists only if 0 < n_rem < 2 * num_pairs.\n            # If these conditions are not met, the pairing has collapsed. The collapse\n            # frequency is the one calculated in the previous step, which led to\n            # this invalid state. The loop terminates, and the last stored omega_coll is returned.\n            if n_rem <= 0 or n_rem >= 2 * num_pairs:\n                break\n            \n            # For the current configuration of unblocked pairs, calculate the\n            # non-rotating quasiparticle energy E0.\n            # E0 = sqrt(lambda^2 + Delta^2) = (G * |P|) / 2\n            E0 = G * num_pairs / 2.0\n\n            # The next blocking event occurs when the lowest quasiparticle Routhian\n            # E' = E0 - omega * m_max drops to zero. This happens at omega = E0 / m_max,\n            # where m_max is the largest available magnetic quantum number.\n            m_max = max(unblocked_m)\n            omega_next = E0 / m_max\n            omega_coll = omega_next\n\n            # Update the system for the next iteration: block the pair with m_max.\n            unblocked_m.remove(m_max)\n            # Blocking a pair removes two particles from the condensate.\n            n_rem -= 2.0\n\n        results.append(f\"{omega_coll:.6f}\")\n\n    # Print the final results in the specified format \"[x1,x2,x3,x4]\".\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}