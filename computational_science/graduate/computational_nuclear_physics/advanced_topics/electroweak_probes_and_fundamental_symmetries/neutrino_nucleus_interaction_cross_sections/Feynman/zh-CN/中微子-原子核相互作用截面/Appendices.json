{
    "hands_on_practices": [
        {
            "introduction": "我们的第一个实践练习关注带电荷流（CC）相互作用的一个基本方面：末态轻子质量对反应截面的影响。通过在一个简化模型中比较电子中微子和缪子中微子的散射，你将直接计算相空间抑制因子。这个练习将加深你对基本运动学和费米黄金定则如何决定可观测量（如截面）的理解。",
            "id": "3572485",
            "problem": "考虑电子中微子和缪子中微子在碳核上的带电荷流准弹性（CCQE）散射，该过程在低能情况下采用平面波脉冲近似进行建模。具体来说，研究发生在碳核内一个束缚中子上的过程 $\\nu_{\\ell} + n \\to \\ell^{-} + p$，其中 $\\ell$ 代表电子或缪子。假定初始的束缚中子处于静止状态，并由有效质量 $M_{n}^{*} = M_{n} - \\varepsilon_{B}$ 描述，其中包含一个恒定的分离能 $\\varepsilon_{B}$ 以考虑核束缚效应。忽略末态相互作用和库仑效应，并假定在这些运动学条件下，强子跃迁矩阵元与轻子味道无关。设中微子在实验室坐标系下的能量为 $E_{\\nu} \\le 300\\,\\text{MeV}$；在本题中，你将在 $E_{\\nu} = 300\\,\\text{MeV}$ 的条件下进行计算。\n\n从费米黄金定则和两体能量-动量守恒出发，通过末态轻子质量 $m_{\\ell}$ 对可用两体相空间的影响，建立总CCQE截面对该质量的领头阶（以核子质量的倒数为展开参数）依赖关系。利用这个关系，在固定 $E_{\\nu}$ 时定义相空间抑制因子，\n$$\nS(E_{\\nu}) \\equiv \\frac{\\sigma(\\nu_{\\mu})}{\\sigma(\\nu_{e})}\\,,\n$$\n该因子是在上述近似条件下，纯粹由 $m_{\\mu}$ 和 $m_{e}$ 之间的差异所导致的。\n\n取以下数值输入\n$$\nM_{n} = 939.565\\,\\text{MeV}, \\quad M_{p} = 938.272\\,\\text{MeV}, \\quad m_{e} = 0.511\\,\\text{MeV}, \\quad m_{\\mu} = 105.658\\,\\text{MeV}, \\quad \\varepsilon_{B} = 25\\,\\text{MeV}.\n$$\n对于运动学，将传递给轻子的主要能量视为\n$$\nE_{\\ell} \\approx E_{\\nu} - \\Delta_{Q}, \\quad \\text{其中} \\quad \\Delta_{Q} \\equiv M_{p} - M_{n} + \\varepsilon_{B},\n$$\n这与重重子极限和小动量转移一致。在这些假定下，以闭合形式表示 $S(E_{\\nu})$，并在 $E_{\\nu} = 300\\,\\text{MeV}$ 处计算其值。\n\n将最终数值答案四舍五入至四位有效数字。将最终结果表示为一个纯数（无量纲）。",
            "solution": "用户希望在一系列简化假定下，求出相空间抑制因子。该因子定义为缪子中微子和电子中微子在碳核上的总带电荷流准弹性（CCQE）截面之比。\n\n### 步骤1：提取已知条件\n- **过程**：束缚中子上的带电荷流准弹性（CCQE）散射：$\\nu_{\\ell} + n \\to \\ell^{-} + p$，其中 $\\ell \\in \\{e, \\mu\\}$。\n- **模型**：平面波脉冲近似。\n- **初始态**：由有效质量 $M_{n}^{*} = M_{n} - \\varepsilon_{B}$ 描述的束缚中子，初始静止。\n- **近似**：\n    - 忽略末态相互作用（FSI）。\n    - 忽略库仑效应。\n    - 强子跃迁矩阵元与轻子味道（$\\ell=e$ 或 $\\ell=\\mu$）无关。\n- **运动学条件**：中微子实验室能量 $E_{\\nu} = 300\\,\\text{MeV}$。\n- **运动学近似**：末态轻子能量由 $E_{\\ell} \\approx E_{\\nu} - \\Delta_{Q}$ 给出，其中 $\\Delta_{Q} \\equiv M_{p} - M_{n} + \\varepsilon_{B}$。\n- **定义**：相空间抑制因子为 $S(E_{\\nu}) \\equiv \\frac{\\sigma(\\nu_{\\mu})}{\\sigma(\\nu_{e})}$。\n- **数值**：\n    - 中子质量：$M_{n} = 939.565\\,\\text{MeV}$\n    - 质子质量：$M_{p} = 938.272\\,\\text{MeV}$\n    - 电子质量：$m_{e} = 0.511\\,\\text{MeV}$\n    - 缪子质量：$m_{\\mu} = 105.658\\,\\text{MeV}$\n    - 中子分离能：$\\varepsilon_{B} = 25\\,\\text{MeV}$\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了 CCQE 中微子-原子核散射，这是核物理与粒子物理中的一个基本过程。所引用的理论框架——费米黄金定则、两体相空间和脉冲近似——是标准的。使用有效质量来描述束缚核子是一种常见的唯象学方法（例如，在费米气体模型的背景下）。所有近似都明确说明，是该主题简化教学处理中的典型做法。粒子质量和分离能的数值在物理上是现实的。该问题在科学上是合理的。\n- **定义明确**：问题要求一个具体、可计算的量 $S(E_{\\nu})$。它提供了所有必要的数据和一组清晰的物理近似来定义计算。目标是明确的。\n- **客观性**：问题以精确、技术性的语言陈述，没有主观性或偏见。\n- **结论**：该问题是有效的。它是一个基于既定原理和标准近似的、定义明确的物理问题。\n\n### 步骤3：判断与行动\n该问题是有效的。将提供一个完整的解答。\n\n### 求解过程\n一个散射过程的微分截面由费米黄金定则给出。对于过程 $\\nu_{\\ell} + n \\to \\ell^{-} + p$，总截面 $\\sigma(\\nu_{\\ell})$ 是通过对末态相空间上的微分截面进行积分得到的：\n$$\n\\sigma(\\nu_{\\ell}) = \\int |\\mathcal{M}_{\\ell}|^2 d\\Phi_{\\ell}\n$$\n其中 $|\\mathcal{M}_{\\ell}|^2$ 是轻子味道为 $\\ell$ 的跃迁矩阵元的平方，$d\\Phi_{\\ell}$ 是末态 $(\\ell^{-}, p)$ 的两体洛伦兹不变相空间元。\n\n题目指出，强子跃迁矩阵元与轻子味道无关。这意味着如果我们对自旋和角度依赖性进行积分，矩阵元剩下的运动学部分也与味道无关。作为一阶近似，我们视 $|\\mathcal{M}_e|^2 \\approx |\\mathcal{M}_\\mu|^2 \\approx |\\mathcal{M}|^2$ 为一个相对于在电子和缪子末态之间不同的运动学变量的常数因子。\n\n抑制因子 $S(E_{\\nu})$ 是总截面之比：\n$$\nS(E_{\\nu}) = \\frac{\\sigma(\\nu_{\\mu})}{\\sigma(\\nu_{e})} = \\frac{\\int |\\mathcal{M}_{\\mu}|^2 d\\Phi_{\\mu}}{\\int |\\mathcal{M}_{e}|^2 d\\Phi_{e}} \\approx \\frac{\\int d\\Phi_{\\mu}}{\\int d\\Phi_{e}} = \\frac{\\Phi_{\\text{total}}(\\mu)}{\\Phi_{\\text{total}}(e)}\n$$\n因此，截面之比由末态可用相空间体积之比决定。\n\n题目为运动学提供了一个关键的简化：出射轻子的能量被近似为一个恒定值 $E_{\\ell} \\approx E_{\\nu} - \\Delta_{Q}$。这个近似与忽略反冲质子动能的重重子极限是一致的。在此近似下，电子和缪子末态的轻子能量 $E_{\\ell}$ 是相同的。让我们将此固定能量表示为 $E'_{\\ell} = E_{\\nu} - \\Delta_{Q}$。\n\n在末态轻子能量固定的情况下，我们不对 $E_{\\ell}$ 的范围进行积分。相反，“可用两体相空间”的概念指的是在这个特定运动学点上的相空间密度。质量为 $m_{\\ell}$、能量为 $E_{\\ell}$ 的自由粒子的态密度正比于其能量和动量大小的乘积 $E_{\\ell} |\\vec{k}_{\\ell}|$。因子 $|\\vec{k}_{\\ell}|$ 来自相空间体积元 $|\\vec{k}_{\\ell}|^2 d|\\vec{k}_{\\ell}|$，而雅可比行列式 $d|\\vec{k}_{\\ell}|/dE_{\\ell} = E_{\\ell}/|\\vec{k}_{\\ell}|$ 给出了 $E_{\\ell}$ 因子。因此，我们可以近似认为总截面与这个因子成正比：\n$$\n\\sigma(\\nu_{\\ell}) \\propto E_{\\ell} |\\vec{k}_{\\ell}|\n$$\n这假定截面中所有其他运动学因子都近似与味道无关。\n\n轻子动量的大小 $|\\vec{k}_{\\ell}|$ 由相对论能量-动量关系确定：$|\\vec{k}_{\\ell}| = \\sqrt{E_{\\ell}^2 - m_{\\ell}^2}$。\n\n使用我们的近似 $E_{e} = E_{\\mu} = E'_{\\ell}$，抑制因子变成了末态轻子动量之比：\n$$\nS(E_{\\nu}) = \\frac{E'_{\\ell} |\\vec{k}_{\\mu}|}{E'_{\\ell} |\\vec{k}_{e}|} = \\frac{|\\vec{k}_{\\mu}|}{|\\vec{k}_{e}|} = \\frac{\\sqrt{(E'_{\\ell})^2 - m_{\\mu}^2}}{\\sqrt{(E'_{\\ell})^2 - m_{e}^2}}\n$$\n代入 $E'_{\\ell} = E_{\\nu} - \\Delta_Q$ 得到抑制因子的最终闭合形式表达式：\n$$\nS(E_{\\nu}) = \\sqrt{\\frac{(E_{\\nu} - \\Delta_Q)^2 - m_{\\mu}^2}{(E_{\\nu} - \\Delta_Q)^2 - m_{e}^2}}\n$$\n其中 $\\Delta_Q = M_{p} - M_{n} + \\varepsilon_{B}$。\n\n现在，我们使用给定的数值来计算此表达式。\n首先，计算能量转移 $\\Delta_Q$：\n$$\n\\Delta_Q = M_{p} - M_{n} + \\varepsilon_{B} = 938.272\\,\\text{MeV} - 939.565\\,\\text{MeV} + 25\\,\\text{MeV} = 23.707\\,\\text{MeV}\n$$\n接下来，对于给定的中微子能量 $E_{\\nu} = 300\\,\\text{MeV}$，计算末态轻子能量 $E'_{\\ell}$：\n$$\nE'_{\\ell} = E_{\\nu} - \\Delta_Q = 300\\,\\text{MeV} - 23.707\\,\\text{MeV} = 276.293\\,\\text{MeV}\n$$\n该反应在运动学上是允许的，因为 $E'_{\\ell} > m_{\\mu}$ ($276.293\\,\\text{MeV} > 105.658\\,\\text{MeV}$)。\n\n现在，我们计算缪子和电子的动量平方：\n$$\n|\\vec{k}_{\\mu}|^2 = (E'_{\\ell})^2 - m_{\\mu}^2 = (276.293\\,\\text{MeV})^2 - (105.658\\,\\text{MeV})^2\n$$\n$$\n|\\vec{k}_{\\mu}|^2 = 76337.817449\\,\\text{MeV}^2 - 11163.606564\\,\\text{MeV}^2 = 65174.210885\\,\\text{MeV}^2\n$$\n$$\n|\\vec{k}_{e}|^2 = (E'_{\\ell})^2 - m_{e}^2 = (276.293\\,\\text{MeV})^2 - (0.511\\,\\text{MeV})^2\n$$\n$$\n|\\vec{k}_{e}|^2 = 76337.817449\\,\\text{MeV}^2 - 0.261121\\,\\text{MeV}^2 = 76337.556328\\,\\text{MeV}^2\n$$\n最后，我们计算抑制因子 $S(E_{\\nu})$：\n$$\nS(300\\,\\text{MeV}) = \\sqrt{\\frac{65174.210885}{76337.556328}} = \\sqrt{0.85377033...} \\approx 0.92399693\n$$\n四舍五入到四位有效数字，我们得到 $0.9240$。",
            "answer": "$$\n\\boxed{0.9240}\n$$"
        },
        {
            "introduction": "从简单的运动学转向一个核心的核模型，这个练习将处理相对论费米气体 (Relativistic Fermi Gas, RFG) 响应函数的数值计算。你将遇到计算物理学中的一个常见挑战——运动学边界上的可积奇异点——并需要通过变量变换来解决这个问题。这项实践对于为实际的核模型计算构建稳健高效的代码至关重要。",
            "id": "3572502",
            "problem": "考虑一个自旋饱和原子核的中微子散射，该原子核被建模为一个半径等于费米动量 $k_F$ 的均匀费米球。研究其在相对论费米气体 (RFG) 模型下的包容性准弹性响应。在自然单位制中，设光速 $c=1$，定义核子质量为 $m$，三动量转移大小为 $q$，能量转移为 $\\omega$。在冲量近似下，包容性标量相空间因子（与前向散射振幅的虚部成正比）在忽略一个总耦合常数的情况下，可以写为以下受能量守恒约束的六维积分：\n$$\nI(\\omega,q;k_F) \\equiv \\int_{|\\mathbf{p}|\\le k_F} d^3p \\ \\delta\\!\\left(\\omega + E(\\mathbf{p}) - E(\\mathbf{p}+\\mathbf{q})\\right),\n$$\n其中 $E(\\mathbf{p}) \\equiv \\sqrt{|\\mathbf{p}|^2 + m^2}$ 且 $E(\\mathbf{p}+\\mathbf{q}) \\equiv \\sqrt{|\\mathbf{p}+\\mathbf{q}|^2 + m^2}$。将 $z$ 轴与 $\\mathbf{q}$ 对齐，并记 $x\\equiv \\cos\\theta$，其中 $\\theta$ 是 $\\mathbf{p}$ 和 $\\mathbf{q}$ 之间的夹角。在 $\\mathbf{p}$ 空间中使用球坐标，该积分可简化为\n$$\nI(\\omega,q;k_F) \\equiv 2\\pi \\int_{-1}^{1} dx \\int_{0}^{k_F} dp \\ p^2 \\ \\delta\\!\\left(g(p,x)\\right),\n$$\n其中\n$$\ng(p,x) \\equiv \\omega + \\sqrt{p^2 + m^2} - \\sqrt{p^2 + q^2 + 2pqx + m^2}.\n$$\ndelta 函数将 $(p,x)$ 定义域限制在矩形区域 $p\\in[0,k_F]$ 和 $x\\in[-1,1]$ 内的曲线 $g(p,x) = 0$ 上。一种标准的计算方法是使用恒等式 $\\delta(g(p,x)) = \\sum_{i} \\delta(p - p_i(x)) \\left|\\partial g/\\partial p\\vert_{p_i(x)}\\right|^{-1}$ 来消去 delta 函数，其中 $p_i(x)$ 是 $g(p,x) = 0$ 在 $[0,k_F]$ 区间内的实根。这会得到一个形式如下的一维积分：\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{-1}^{1} dx \\ \\sum_{i} \\frac{p_i(x)^2}{\\left|\\partial g/\\partial p\\vert_{p_i(x)}\\right|},\n$$\n其中\n$$\n\\frac{\\partial g}{\\partial p}(p,x) = \\frac{p}{\\sqrt{p^2+m^2}} - \\frac{p+qx}{\\sqrt{p^2 + q^2 + 2pqx + m^2}}.\n$$\n在 $x$ 的运动学端点附近，允许的根 $p_i(x)$ 会趋近边界 $p=k_F$，导致 $\\left|\\partial g/\\partial p\\vert_{p_i(x)}\\right|$ 变小，并且被积函数在 $x$ 上出现可积的平方根发散（例如，当曲线 $g(p,x)=0$ 在 $x=\\pm 1$ 处与边界相切时）。这会导致对 $x$ 进行标准求积时出现数值不稳定性。\n\n你的任务是：\n\n1) 从上述定义和狄拉克 delta 函数 $\\delta(\\cdot)$ 的基本性质出发，解释为什么 $I(\\omega,q;k_F)$ 的一维表示是有效的，并找出当 $g(p,x)=0$ 的解在运动学边缘 $x=\\pm 1$ 处与边界 $p=k_F$ 相切时，可积奇异行为的潜在来源。\n\n2) 提出一个变量替换，以使被积函数在边缘的行为正则化，从而实现高效且稳定的求积。通过在 $x=\\pm 1$ 附近的局部渐近分析来证明你选择的合理性，并说明变换的雅可比行列式如何消除平方根发散。该变量替换必须用 $x$ 和一个新的角度变量显式表示，并且角度单位必须指定为弧度。\n\n3) 实现以下计算实验，以展示在运动学边缘附近数值稳定性和效率的提升。对于下述每个测试用例：\n   - 以三种方式计算 $I(\\omega,q;k_F)$：\n     a) 直接在 $x\\in[-1,1]$ 上使用 $N=16$ 个节点的朴素高斯-勒让德求积法。\n     b) 在将变量从 $x$ 变换到 $[0,\\pi]$ 中的角度变量后，使用 $N=16$ 个节点的正则化高斯-勒让德求积法，并确保正确地包含了雅可比行列式。\n     c) 对正则化后的积分使用自适应求积法，并设置严格的绝对容差 $10^{-9}$，以得到一个高精度参考值。\n   - 为保证数值鲁棒性，在 $[0,k_F]$ 内寻找 $g(p,x)=0$ 的根 $p_*(x)$ 时，对每个 $x$ 使用区间法来定位根；如果不存在根，则该 $x$ 处的贡献为零。使用在根处求得的导数 $\\partial g/\\partial p$ 来计算雅可比因子。如果 $|\\partial g/\\partial p|$ 变得极小（在自然单位制下小于 $10^{-12}$），将其大小限制在 $10^{-12}$，以避免浮点溢出，同时保持其可积性。\n   - 对于每个测试用例，报告朴素求积法的绝对误差与正则化求积法的绝对误差之比（一个无量纲数），两种误差都相对于高精度参考值进行测量。即：\n     $$\n     \\mathcal{R} \\equiv \\frac{\\left|I_{\\text{naive}} - I_{\\text{ref}}\\right|}{\\left|I_{\\text{reg}} - I_{\\text{ref}}\\right|}.\n     $$\n\n使用以下符合物理实际的常数和测试套件。所有能量和动量都以兆电子伏特 (MeV) 为单位，并隐含 $c=1$：\n- $m = 939$ MeV,\n- $k_F = 250$ MeV,\n- $q = 600$ MeV.\n\n定义在边界 $p=k_F$ 和 $x=\\pm 1$ 处的运动学边缘能量转移为\n$$\n\\omega_{\\pm}(q,k_F) \\equiv \\sqrt{(q \\pm k_F)^2 + m^2} - \\sqrt{k_F^2 + m^2}.\n$$\n构建三个测试用例：\n- 用例1（中心）：$\\omega = \\tfrac{1}{2}\\left(\\omega_{-} + \\omega_{+}\\right)$。\n- 用例2（靠近下边缘）：$\\omega = \\omega_{-} + \\Delta\\omega$，其中 $\\Delta\\omega = 0.2$ MeV。\n- 用例3（靠近上边缘）：$\\omega = \\omega_{+} - \\Delta\\omega$，其中 $\\Delta\\omega = 0.2$ MeV。\n\n角度单位：在你的变量替换中引入的所有角度变量都必须以弧度表示。\n\n最终输出格式规范：\n- 你的程序应生成单行输出，其中包含上述测试用例的三个比率 $\\mathcal{R}$，格式为用方括号括起来的逗号分隔列表，例如 $[\\mathcal{R}_1,\\mathcal{R}_2,\\mathcal{R}_3]$。\n- 每个 $\\mathcal{R}$ 都是一个无量纲浮点数。输出行中不应出现物理单位符号。",
            "solution": "该问题是有效的，因为它在科学上基于核物理的相对论费米气体模型，在数学上是适定的、客观的，并包含得出唯一解所需的所有信息。我们按步骤进行解答。\n\n### 任务1：一维积分表示的有效性与奇异性分析\n\n出发点是包容性准弹性响应的六维相空间积分，在假设存在均匀费米球并将 $z$ 轴与动量转移 $\\mathbf{q}$ 对齐的条件下，该积分简化为：\n$$\nI(\\omega,q;k_F) = \\int_{|\\mathbf{p}|\\le k_F} d^3p \\ \\delta\\!\\left(\\omega + E(\\mathbf{p}) - E(\\mathbf{p}+\\mathbf{q})\\right)\n$$\n为得到给定的二维积分，我们将体积元 $d^3p$ 用球坐标表示，其中 $\\mathbf{p}$ 的大小为 $p$，相对于 $\\mathbf{q}$ 的极角为 $\\theta$，方位角为 $\\phi$。体积元为 $d^3p = p^2 \\sin\\theta \\,dp \\,d\\theta \\,d\\phi$。由于坐标系的选择，delta 函数的自变量与 $\\phi$ 无关。对 $\\phi$ 从 $0$ 到 $2\\pi$ 积分，得到一个因子 $2\\pi$。然后我们进行变量替换，从 $\\theta$ 换为 $x \\equiv \\cos\\theta$。微分变为 $dx = -\\sin\\theta \\,d\\theta$。$\\theta \\in [0, \\pi]$ 的积分范围映射到 $x \\in [1, -1]$。将 $x$ 的积分限反转为 $[-1, 1]$ 会消除负号。因此，积分变为：\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{-1}^{1} dx \\int_{0}^{k_F} dp \\ p^2 \\ \\delta\\!\\left(g(p,x)\\right)\n$$\n其中 $g(p,x) \\equiv \\omega + \\sqrt{p^2 + m^2} - \\sqrt{p^2 + q^2 + 2pqx + m^2}$。\n\n为得到一维表示，我们对动量大小 $p$ 进行积分。这可以通过狄拉克 delta 函数的筛选性质来实现，该性质指出，对于一个函数 $f(y)$ 和一个具有单根 $y_i$ 的函数 $h(y)$，\n$$\n\\int dy \\ f(y) \\delta(h(y)) = \\sum_i \\frac{f(y_i)}{|h'(y_i)|}\n$$\n其中求和遍及 $h(y)=0$ 在积分域内的所有根 $y_i$。在我们的例子中，积分变量是 $p$，函数是 $f(p) = p^2$，delta 函数的自变量是 $h(p) = g(p,x)$，其中 $x$ 被视为参数。导数 $h'(p)$ 是 $\\frac{\\partial g}{\\partial p}$。$p$ 的积分域是 $[0, k_F]$。因此，对于每个 $x$ 值，我们找到 $g(p,x)=0$ 的根 $p_i(x)$。对 $p$ 的积分计算结果为：\n$$\n\\int_{0}^{k_F} dp \\ p^2 \\ \\delta(g(p,x)) = \\sum_{i} \\frac{p_i(x)^2}{\\left|\\frac{\\partial g}{\\partial p}\\vert_{p=p_i(x)}\\right|}\n$$\n求和遍及满足 $0 \\le p_i(x) \\le k_F$ 的所有根 $p_i(x)$。将此结果代回 $I(\\omega,q;k_F)$ 的表达式中，即可得到所述的一维积分表示：\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{-1}^{1} dx \\ \\sum_{i} \\frac{p_i(x)^2}{\\left|\\frac{\\partial g}{\\partial p}\\vert_{p_i(x)}\\right|}\n$$\n该表示在狄拉克 delta 函数的标准性质下是有效的。\n\n当分母 $\\left|\\frac{\\partial g}{\\partial p}\\right|$ 趋近于零时，就会出现可积奇异行为的来源。这发生在点 $(p,x)$ 处，此时由能量守恒约束 $g(p,x)=0$ 定义的曲线在 $(x,p)$ 平面中变为垂直，即 $\\frac{dp}{dx}$ 为无穷大。根据应用于 $g(p(x), x) = 0$ 的隐函数定理，我们有 $\\frac{\\partial g}{\\partial p}\\frac{dp}{dx} + \\frac{\\partial g}{\\partial x} = 0$，这给出 $\\frac{dp}{dx} = -\\frac{\\partial g/\\partial x}{\\partial g/\\partial p}$。因此，导数 $\\frac{dp}{dx}$ 为无穷大的充要条件是 $\\frac{\\partial g}{\\partial p} = 0$。\n\n让我们分析被积函数在运动学边缘附近的行为，例如，当根曲线 $p(x)$ 在某个 $x=x_0$（通常 $x_0$ 为 $\\pm 1$）处与边界 $p=k_F$ 相切时。在这个切点 $(k_F, x_0)$，必须同时满足 $g(k_F, x_0) = 0$ 和 $\\frac{\\partial g}{\\partial p}\\vert_{(k_F, x_0)} = 0$。我们可以对 $g(p,x)$ 在此点附近进行局部泰勒展开。对于 $k_F$ 附近的 $p$ 和 $x_0$ 附近的 $x$：\n$$\ng(p,x) \\approx g(k_F,x_0) + (p-k_F)\\frac{\\partial g}{\\partial p}\\bigg|_{(k_F,x_0)} + (x-x_0)\\frac{\\partial g}{\\partial x}\\bigg|_{(k_F,x_0)} + \\frac{1}{2}(p-k_F)^2\\frac{\\partial^2 g}{\\partial p^2}\\bigg|_{(k_F,x_0)} + \\dots\n$$\n由于前两项在切点处为零，对于解曲线上的点 $(p(x), x)$，有 $g(p(x),x)=0$，这意味着：\n$$\n(x-x_0)\\frac{\\partial g}{\\partial x}\\bigg|_{(k_F,x_0)} + \\frac{1}{2}(p(x)-k_F)^2\\frac{\\partial^2 g}{\\partial p^2}\\bigg|_{(k_F,x_0)} \\approx 0\n$$\n假设二阶导数和关于 $x$ 的偏导数非零，我们发现：\n$$\n(p(x)-k_F)^2 \\propto (x_0-x) \\implies |p(x)-k_F| \\propto \\sqrt{|x_0-x|}\n$$\n这表明根 $p(x)$ 到边界 $k_F$ 的距离与 $x$ 到边缘 $x_0$ 的距离的平方根成比例变化。现在，我们来考察分母 $\\frac{\\partial g}{\\partial p}$ 在该点附近的行为。将 $\\frac{\\partial g}{\\partial p}$ 在 $(k_F, x_0)$ 附近进行泰勒展开得到：\n$$\n\\frac{\\partial g}{\\partial p}\\bigg|_{(p(x),x)} \\approx \\frac{\\partial g}{\\partial p}\\bigg|_{(k_F,x_0)} + (p(x)-k_F)\\frac{\\partial^2 g}{\\partial p^2}\\bigg|_{(k_F,x_0)} \\approx (p(x)-k_F)\\frac{\\partial^2 g}{\\partial p^2}\\bigg|_{(k_F,x_0)}\n$$\n因此，分母的大小表现为：\n$$\n\\left|\\frac{\\partial g}{\\partial p}\\right| \\propto |p(x)-k_F| \\propto \\sqrt{|x_0-x|}\n$$\n被积函数与 $1/\\left|\\frac{\\partial g}{\\partial p}\\right|$ 成正比，因此当 $x \\to x_0$ 时，它表现出形如 $1/\\sqrt{|x_0-x|}$ 的平方根发散。这种奇异性是可积的，但对于像高斯-勒让德这样为光滑、类多项式函数设计的标准数值求积方案构成了重大挑战。\n\n### 任务2：正则化变量替换\n\n为了处理积分域 $x \\in [-1, 1]$ 端点处的可积平方根奇异性，我们提出了一个变量替换。任务1中的分析表明，在 $x=1$ 附近存在 $(1-x)^{-1/2}$ 类型的奇异性，在 $x=-1$ 附近存在 $(1+x)^{-1/2}$ 类型的奇异性。针对这类端点奇异性，一个非常有效的替换是：\n$$\nx = \\cos(\\theta)\n$$\n其中新的积分变量 $\\theta$ 是一个以弧度为单位的角度。当 $x$ 从 $-1$ 变化到 $1$ 时，$\\theta$ 从 $\\pi$ 变化到 $0$。微分关系为 $dx = -\\sin(\\theta) \\, d\\theta$。\n\n积分变换如下：\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{-1}^{1} dx \\ f(x) \\longrightarrow 2\\pi \\int_{\\pi}^{0} d\\theta \\ (-\\sin\\theta) \\ f(\\cos\\theta) = 2\\pi \\int_{0}^{\\pi} d\\theta \\ \\sin(\\theta) f(\\cos\\theta)\n$$\n其中 $f(x) = \\sum_{i} \\frac{p_i(x)^2}{\\left|\\partial g/\\partial p\\vert_{p_i(x)}\\right|}$。需要计算的新积分为：\n$$\nI(\\omega,q;k_F) = 2\\pi \\int_{0}^{\\pi} d\\theta \\ \\sin(\\theta) \\sum_{i} \\frac{p_i(\\cos\\theta)^2}{\\left|\\frac{\\partial g}{\\partial p}\\vert_{(p_i(\\cos\\theta),\\cos\\theta)}\\right|}\n$$\n让我们通过展示变换的雅可比行列式 $\\sin(\\theta)$ 如何消除奇异性来证明这一选择的合理性。\n在上运动学边缘附近，$x \\to 1^-$，对应于 $\\theta \\to 0^+$。对于小的 $\\theta$，我们有 $1-x = 1 - \\cos\\theta \\approx \\frac{\\theta^2}{2}$。被积函数 $f(x)$ 的奇异部分表现为 $(1-x)^{-1/2} \\approx (\\frac{\\theta^2}{2})^{-1/2} = \\frac{\\sqrt{2}}{\\theta}$。雅可比行列式为 $\\sin\\theta \\approx \\theta$。变换后被积函数中的乘积为 $(\\frac{\\sqrt{2}}{\\theta}) \\times \\theta = \\sqrt{2}$，它在 $\\theta=0$ 处是有限且表现良好的。\n\n在下运动学边缘附近，$x \\to -1^+$，对应于 $\\theta \\to \\pi^-$。令 $\\phi = \\pi - \\theta$，则 $\\phi \\to 0^+$。我们有 $1+x = 1 + \\cos\\theta = 1 + \\cos(\\pi-\\phi) = 1 - \\cos\\phi \\approx \\frac{\\phi^2}{2}$。被积函数 $f(x)$ 的奇异部分表现为 $(1+x)^{-1/2} \\approx (\\frac{\\phi^2}{2})^{-1/2} = \\frac{\\sqrt{2}}{\\phi}$。在 $\\theta=\\pi$ 附近的雅可比行列式为 $\\sin\\theta = \\sin(\\pi-\\phi) = \\sin\\phi \\approx \\phi$。乘积为 $(\\frac{\\sqrt{2}}{\\phi}) \\times \\phi = \\sqrt{2}$，它在 $\\theta=\\pi$ 处也是有限且表现良好的。\n\n这种变量替换将原始的关于 $x$ 的奇异被积函数转换为在区间 $[0, \\pi]$ 上关于 $\\theta$ 的光滑、正则的函数。这个正则化后的被积函数现在非常适合使用标准数值求积方法（如高斯-勒让德法）进行高效且稳定的求值。\n\n### 任务3：计算实验实现\n\n对于每个测试用例，实现将包括三个主要部分：\n1.  **高精度参考值 ($I_{\\text{ref}}$)**：我们将使用正则化公式（在 $\\theta \\in [0, \\pi]$ 上积分）和一个高精度自适应求积例程（`scipy.integrate.quad`），并设置 $10^{-9}$ 的严格绝对容差来计算积分。这个结果将作为“基准真相”。\n2.  **朴素求积法 ($I_{\\text{naive}}$)**：我们将使用在 $[-1, 1]$ 上的原始 $x$ 公式来计算积分。将使用固定的 $N=16$ 点高斯-勒让德求积法。由于未处理的奇异点，预计此方法在边缘情况下表现不佳。\n3.  **正则化求积法 ($I_{\\text{reg}}$)**：我们将使用在 $[0, \\pi]$ 上的正则化 $\\theta$ 公式来计算积分。将使用固定的 $N=16$ 点高斯-勒让德求积法。预计此方法将比朴素方法准确得多。\n\n对于每个求积点，都需要在 $[0, k_F]$ 内找到 $g(p,x)=0$ 的根 $p_i(x)$。这将在检查区间内是否存在根（通过检查 $g(p,x)$ 在 $p=0$ 和 $p=k_F$ 处的符号）之后，使用一个鲁棒的区间法（`scipy.optimize.brentq`）来完成。分母 $|\\partial g/\\partial p|$ 的值将被限制在 $10^{-12}$ 以防止浮点溢出。最后，将按规定为每个测试用例计算误差比 $\\mathcal{R}$。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate, optimize\nfrom numpy.polynomial.legendre import leggauss\n\ndef solve():\n    \"\"\"\n    Validates the problem and implements the computational experiment for\n    neutrino-nucleus scattering response function calculation.\n    \"\"\"\n    # Physical constants in MeV\n    M_N = 939.0  # Nucleon mass\n    K_F = 250.0  # Fermi momentum\n    Q_MAG = 600.0 # Momentum transfer magnitude\n\n    # Numerical parameters\n    N_NODES = 16\n    TOL_REF = 1e-9\n    DGDP_CLAMP = 1e-12\n\n    def E_p(p, m):\n        \"\"\"Relativistic energy.\"\"\"\n        return np.sqrt(p**2 + m**2)\n\n    def g_func(p, x, omega, q, m):\n        \"\"\"Energy conservation constraint function g(p,x) = 0.\"\"\"\n        _E_p = E_p(p, m)\n        _E_p_plus_q = np.sqrt(p**2 + q**2 + 2 * p * q * x + m**2)\n        return omega + _E_p - _E_p_plus_q\n\n    def dg_dp_func(p, x, q, m):\n        \"\"\"Partial derivative of g with respect to p.\"\"\"\n        if p == 0:\n            # Handle the limit p->0 to avoid 0/0\n            _E_p_val = m\n            p_over_E_p = 0\n        else:\n            _E_p_val = E_p(p, m)\n            p_over_E_p = p / _E_p_val\n        \n        # Denominator in second term can't be zero since p, q > 0 and m^2 > 0\n        _E_p_plus_q_val = np.sqrt(p**2 + q**2 + 2 * p * q * x + m**2)\n        return p_over_E_p - (p + q * x) / _E_p_plus_q_val\n\n    def get_integrand_value(x, omega, q, m, k_f):\n        \"\"\"\n        Calculates the value of the integrand p^2/|dg/dp| for a given x.\n        This involves finding the root of g(p,x)=0.\n        \"\"\"\n        # Define g for the current x and omega\n        g_p = lambda p: g_func(p, x, omega, q, m)\n        \n        try:\n            # Check for a root in the interval [0, k_f]\n            # If g(0) and g(k_f) have the same sign, brentq will fail.\n            # This indicates no root (or an even number of roots, typically none for this physics).\n            val_at_0 = g_p(0)\n            val_at_k_f = g_p(k_f)\n            if val_at_0 * val_at_k_f >= 0:\n                return 0.0\n            \n            p_root = optimize.brentq(g_p, 0, k_f)\n        except ValueError:\n            # No root found in the bracket\n            return 0.0\n\n        dg_dp_val = dg_dp_func(p_root, x, q, m)\n        \n        # Clamp the absolute value of the derivative to avoid overflow\n        abs_dg_dp = max(abs(dg_dp_val), DGDP_CLAMP)\n        \n        return p_root**2 / abs_dg_dp\n\n    # Define integrands for different methods\n    def integrand_naive(x, omega, q, m, k_f):\n        return get_integrand_value(x, omega, q, m, k_f)\n\n    def integrand_regularized(theta, omega, q, m, k_f):\n        x = np.cos(theta)\n        # Jacobian from x=cos(theta) change of variables\n        jacobian = np.sin(theta)\n        return get_integrand_value(x, omega, q, m, k_f) * jacobian\n\n    # Define kinematic edge energies\n    def omega_pm(q, k_f, m):\n        e_kf = E_p(k_f, m)\n        omega_minus = E_p(q - k_f, m) - e_kf\n        omega_plus = E_p(q + k_f, m) - e_kf\n        return omega_minus, omega_plus\n\n    omega_minus, omega_plus = omega_pm(Q_MAG, K_F, M_N)\n    delta_omega = 0.2\n\n    test_cases = [\n        0.5 * (omega_minus + omega_plus),  # Case 1: Central\n        omega_minus + delta_omega,         # Case 2: Near lower edge\n        omega_plus - delta_omega,          # Case 3: Near upper edge\n    ]\n\n    results = []\n    \n    # Get Gauss-Legendre nodes and weights for [-1, 1]\n    gl_nodes, gl_weights = leggauss(N_NODES)\n\n    for omega in test_cases:\n        args = (omega, Q_MAG, M_N, K_F)\n\n        # a) Naive quadrature calculation\n        integral_naive_sum = sum(w * integrand_naive(x, *args) for x, w in zip(gl_nodes, gl_weights))\n        I_naive = 2.0 * np.pi * integral_naive_sum\n\n        # b) Regularized quadrature calculation\n        # Transform GL quadrature from u in [-1,1] to theta in [0,pi]\n        # theta = (pi/2)(u+1) -> d(theta) = (pi/2)du\n        theta_nodes = 0.5 * np.pi * (gl_nodes + 1.0)\n        integral_reg_sum = sum(w * integrand_regularized(th, *args) for th, w in zip(theta_nodes, gl_weights))\n        I_reg = 2.0 * np.pi * (0.5 * np.pi) * integral_reg_sum\n\n        # c) High-accuracy reference calculation\n        ref_result, _ = integrate.quad(integrand_regularized, 0, np.pi, args=args, epsabs=TOL_REF, limit=200)\n        I_ref = 2.0 * np.pi * ref_result\n\n        # Calculate errors and the ratio\n        err_naive = abs(I_naive - I_ref)\n        err_reg = abs(I_reg - I_ref)\n\n        # Handle the case where the regularized method is perfectly accurate\n        if err_reg  1e-15: # effectively zero\n             if err_naive  1e-15:\n                 ratio = 1.0 # Both are perfect\n             else:\n                 ratio = np.inf # Regularized is perfect, naive is not\n        else:\n             ratio = err_naive / err_reg\n        results.append(ratio)\n\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "这最后一个实践练习将探讨如何构建和分析一个更完整（尽管是唯象的）的包容性截面模型。通过结合准弹性散射和双核子-双空穴（2p2h）出射道，你将研究总截面的预测如何对潜在的理论参数（例如 $\\pi$ 介子形状因子的截断能 $\\Lambda_\\pi$）敏感。这个练习强调了敏感性分析在连接理论模型与实验数据以及量化模型不确定性方面的关键作用。",
            "id": "3572496",
            "problem": "考虑在中微子能量为 $E_\\nu$ 时，在自旋饱和、同位旋标量靶上发生的电荷流全反应中微子-原子核散射。每个核子的总全反应截面 $\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi)$ 可以被建模为准弹性部分和双粒子-双空穴 (2p2h) 介子交换流部分之和。本题旨在通过将π介子形状因子截断 $\\Lambda_\\pi$ 的变化传播到 2p2h 强度中，来探究并量化全反应截面如何响应 $\\Lambda_\\pi$ 的变化。\n\n起点和假设：\n- 全反应截面由轻子张量和强子张量的收缩在允许的运动学范围内积分确定。在一个因子分解模型中，可以将不同机制视为可加的：$\\sigma_{\\text{inc}} = \\sigma_{\\text{QE}} + \\sigma_{\\text{2p2h}}$，其中 $\\sigma_{\\text{QE}}$ 是准弹性贡献，$\\sigma_{\\text{2p2h}}$ 是导致双核子出射的介子交换流贡献。\n- 将费米耦合常数 $G_F$ 和卡比博角因子 $\\cos\\theta_C$ 视为已知且固定的，并假设四动量转移平方的近似上限为 $Q^2_{\\max} \\approx 2 m_N E_\\nu$，其中 $m_N$ 是核子质量。这为此模型中的运动学积分提供了有限的积分范围。\n- 对于准弹性部分，用偶极形式对核子矢量和轴矢量形状因子的平方进行建模，其矢量质量为 $M_V$，轴向质量为 $M_A$，轴向电荷为 $g_A(0)$。在这个简化的能量平均模型中，将准弹性强度近似为在 $Q^2 \\in [0,Q^2_{\\max}]$ 上的加权积分。\n- 对于双粒子-双空穴部分，假设横向介子交换流响应受到π介子形状因子（截断为 $\\Lambda_\\pi$）和一个平滑的运动学权重的调制。假设π介子形状因子是 $Q^2$ 的单极形式，并假设能量依赖性通过一个在 高$E_\\nu$ 时饱和的平滑因子引入。\n\n定义和参数：\n- 令 $G_F$ 为费米耦合常数，单位为 $\\mathrm{GeV}^{-2}$；$\\cos\\theta_C$ 为卡比博角的余弦；$m_N$ 为核子质量，单位为 $\\mathrm{GeV}$。\n- 定义从 $\\mathrm{GeV}^{-2}$ 到 $\\mathrm{cm}^2$ 的转换系数 $C_{\\mathrm{conv}}$。\n- 准弹性贡献模型为\n$$\n\\sigma_{\\text{QE}}(E_\\nu) = S_0 \\, G_F^2 \\cos^2\\theta_C \\, E_\\nu \\, m_N \\, \\mathcal{I}_{\\text{QE}}(Q^2_{\\max}),\n$$\n其中 $S_0$ 是一个无量纲的缩放常数，且\n$$\n\\mathcal{I}_{\\text{QE}}(Q^2_{\\max}) = \\int_{0}^{Q^2_{\\max}} \\left[ \\left(\\frac{1}{1 + \\frac{Q^2}{M_V^2}}\\right)^4 + g_A(0)^2 \\left(\\frac{1}{1 + \\frac{Q^2}{M_A^2}}\\right)^4 \\right] \\, dQ^2.\n$$\n- 双粒子-双空穴贡献模型为\n$$\n\\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi) = S_1 \\, G_F^2 \\cos^2\\theta_C \\, E_\\nu \\, m_N \\, \\frac{E_\\nu}{E_\\nu + E_0} \\, \\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi),\n$$\n其中 $S_1$ 是一个无量纲的缩放常数，$E_0$ 是一个平滑的能量尺度，且\n$$\n\\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi) = \\int_{0}^{Q^2_{\\max}} \\exp\\!\\left(-\\frac{Q^2}{\\beta}\\right) \\left(\\frac{\\Lambda_\\pi^2}{\\Lambda_\\pi^2 + Q^2}\\right)^2 \\, dQ^2.\n$$\n- π介子形状因子为 $F_\\pi(Q^2;\\Lambda_\\pi) = \\frac{\\Lambda_\\pi^2}{\\Lambda_\\pi^2 + Q^2}$，它在 2p2h 被积函数中以平方形式出现，以表示被截断抑制的低 $Q^2$ π介子交换的主导地位。\n\n任务：\n- 实现一个程序，使用上述定义计算 $\\sigma_{\\text{QE}}(E_\\nu)$ 和 $\\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi)$，然后构成每个核子的全反应截面：\n$$\n\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi) = \\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi).\n$$\n- 使用以下常数：\n    - $G_F = 1.1663787 \\times 10^{-5}$，单位为 $\\mathrm{GeV}^{-2}$，\n    - $\\cos\\theta_C = 0.97420$，\n    - $m_N = 0.939$，单位为 $\\mathrm{GeV}$，\n    - $C_{\\mathrm{conv}} = 0.389379 \\times 10^{-27}$，单位为 $\\mathrm{cm}^2/\\mathrm{GeV}^{-2}$，\n    - $M_V = 0.84$，单位为 $\\mathrm{GeV}$，\n    - $M_A = 1.03$，单位为 $\\mathrm{GeV}$，\n    - $g_A(0) = 1.267$，\n    - $E_0 = 0.2$，单位为 $\\mathrm{GeV}$，\n    - $\\beta = 0.6$，单位为 $\\mathrm{GeV}^2$，\n    - $S_0 = 0.2$，\n    - $S_1 = 0.08$。\n- 程序必须以 $10^{-38} \\, \\mathrm{cm}^2$ 每核子为单位表示最终截面。也就是说，将计算出的 $\\mathrm{cm}^2$ 截面除以 $10^{-38}$，以产生表示截面（单位为 $10^{-38} \\, \\mathrm{cm}^2$）的无量纲数。\n- 为了量化灵敏度，定义一个参考截断 $\\Lambda_\\pi^{\\mathrm{ref}} = 1.0$，单位为 $\\mathrm{GeV}$，并计算比率\n$$\n\\mathcal{S}(E_\\nu,\\Lambda_\\pi) = \\frac{\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi)}{\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi^{\\mathrm{ref}})}.\n$$\n\n测试套件：\n- 使用中微子能量 $E_\\nu \\in \\{0.3, 0.6, 1.0, 2.0\\}$，单位为 $\\mathrm{GeV}$。\n- 使用π介子截断值 $\\Lambda_\\pi \\in \\{0.6, 0.8, 1.0, 1.2, 1.4\\}$，单位为 $\\mathrm{GeV}$。\n- 从这些集合中形成所有 $(E_\\nu,\\Lambda_\\pi)$ 的组合（总共 20 个测试用例），为每个组合计算 $\\mathcal{S}(E_\\nu,\\Lambda_\\pi)$，并汇总结果。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含 20 个灵敏度比率，顺序由升序迭代 $E_\\nu$ 并在每个 $E_\\nu$ 下升序迭代 $\\Lambda_\\pi$ 决定。该行必须是方括号括起来的逗号分隔列表（例如，$\\texttt{[result1,result2,\\dots]}$）。不应打印其他任何文本。",
            "solution": "起点是将全反应截面分解为对强子张量有贡献的附加机制。在电荷流中微子-原子核散射中，一种常用的因子分解方法是考虑准弹性（单核子敲出）道和双粒子-双空穴介子交换流道，因此可以写作\n$$\n\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi) = \\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi).\n$$\n这种分离与在全反应可观测量中将不同的多体响应视为非相干的处理方式是一致的，并且其基础是双微分截面的一般表达式，\n$$\n\\frac{d^2 \\sigma}{d\\Omega \\, dE'} = \\frac{G_F^2 \\cos^2\\theta_C}{4\\pi^2} \\, k' E' \\sum_{i} v_i(E_\\nu, E', \\theta) R_i(q,\\omega),\n$$\n其中 $R_i$ 是依赖于能量转移 $\\omega$ 和三动量转移 $q$ 的原子核响应函数，而 $v_i$ 是由轻子张量决定的运动学系数。通过对末态轻子运动学进行积分，可以形成每个响应道的能量平均强度。在一个专注于对π介子截断的参数敏感性的简化模型中，很自然地将详细的角度相空间和多体动力学吸收到 $Q^2$ 的领头阶积分中，并使用具有物理动机的形状因子。\n\n对于准弹性部分，主导的核子形状因子由偶极形式建模。记矢量偶极质量为 $M_V$，轴向偶极质量为 $M_A$，零动量转移时的轴向电荷为 $g_A(0)$，形状因子的平方取为\n$$\n|F_V(Q^2)|^2 \\approx \\left(\\frac{1}{1 + \\frac{Q^2}{M_V^2}}\\right)^4, \\qquad |F_A(Q^2)|^2 \\approx g_A(0)^2 \\left(\\frac{1}{1 + \\frac{Q^2}{M_A^2}}\\right)^4.\n$$\n然后我们定义能量平均的准弹性强度为\n$$\n\\mathcal{I}_{\\text{QE}}(Q^2_{\\max}) = \\int_{0}^{Q^2_{\\max}} \\left[ \\left(\\frac{1}{1 + \\frac{Q^2}{M_V^2}}\\right)^4 + g_A(0)^2 \\left(\\frac{1}{1 + \\frac{Q^2}{M_A^2}}\\right)^4 \\right] \\, dQ^2,\n$$\n其中上限 $Q^2_{\\max} \\approx 2 m_N E_\\nu$ 捕捉了在静止核子上进行固定靶散射的近似运动学可及范围。这个积分可以通过代换 $x = Q^2/M^2$ 并使用\n$$\n\\int \\frac{dx}{(1+x)^4} = -\\frac{1}{3 (1+x)^3} + \\text{constant},\n$$\n进行解析计算，得到闭合形式\n$$\n\\int_{0}^{Q^2_{\\max}} \\left(\\frac{1}{1 + \\frac{Q^2}{M^2}}\\right)^4 \\, dQ^2 = \\frac{M^2}{3} \\left[ 1 - \\frac{1}{\\left(1 + \\frac{Q^2_{\\max}}{M^2}\\right)^3} \\right].\n$$\n将此应用于矢量和轴向部分，得到\n$$\n\\mathcal{I}_{\\text{QE}}(Q^2_{\\max}) = \\frac{M_V^2}{3} \\left[ 1 - \\left(1 + \\frac{Q^2_{\\max}}{M_V^2}\\right)^{-3} \\right] + g_A(0)^2 \\frac{M_A^2}{3} \\left[ 1 - \\left(1 + \\frac{Q^2_{\\max}}{M_A^2}\\right)^{-3} \\right].\n$$\n准弹性截面的缩放关系为\n$$\n\\sigma_{\\text{QE}}(E_\\nu) = S_0 \\, G_F^2 \\cos^2\\theta_C \\, E_\\nu \\, m_N \\, \\mathcal{I}_{\\text{QE}}(Q^2_{\\max}),\n$$\n其中 $S_0$ 经过调整以表示被忽略的运动学和核效应，同时确保量级是现实的。\n\n对于双粒子-双空穴介子交换流部分，响应主要是横向的，并涉及π介子交换，其强度由一个以截断 $\\Lambda_\\pi$ 为特征的π介子形状因子调制。一个广泛使用的单极形式是\n$$\nF_\\pi(Q^2;\\Lambda_\\pi) = \\frac{\\Lambda_\\pi^2}{\\Lambda_\\pi^2 + Q^2},\n$$\n因此 $|F_\\pi|^2$ 会抑制大的 $Q^2$ 贡献。为了表示平滑的相空间和多核子关联，使用一个运动学权重，该权重指数地抑制大 $Q^2$，并随中微子能量趋于一个常数，\n$$\n\\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi) = \\int_{0}^{Q^2_{\\max}} \\exp\\!\\left(-\\frac{Q^2}{\\beta}\\right) \\left(\\frac{\\Lambda_\\pi^2}{\\Lambda_\\pi^2 + Q^2}\\right)^2 \\, dQ^2,\n$$\n其中正的 $\\beta$ 控制 $Q^2$ 的衰减。能量依赖性通过一个因子 $\\frac{E_\\nu}{E_\\nu+E_0}$ 进入，该因子平滑地饱和，其中 $E_0$ 是一个尺度参数。2p2h 截面则为\n$$\n\\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi) = S_1 \\, G_F^2 \\cos^2\\theta_C \\, E_\\nu \\, m_N \\, \\frac{E_\\nu}{E_\\nu+E_0} \\, \\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi),\n$$\n其中 $S_1$ 设定了在参考截断下介子交换流的总体强度。\n\n单位处理：\n按所写形式的因子产生的截面单位为 $\\mathrm{GeV}^{-2}$。要转换为 $\\mathrm{cm}^2$，需乘以将 $\\mathrm{GeV}^{-2}$ 转换为 $\\mathrm{cm}^2$ 的因子 $C_{\\mathrm{conv}}$，\n$$\n\\sigma_{\\mathrm{cm^2}} = \\sigma_{\\mathrm{GeV}^{-2}} \\times C_{\\mathrm{conv}},\n$$\n然后除以 $10^{-38}$ 以 $10^{-38} \\, \\mathrm{cm}^2$ 为单位表示。\n\n灵敏度度量：\n为了量化改变 $\\Lambda_\\pi$ 的效应，固定一个参考截断 $\\Lambda_\\pi^{\\mathrm{ref}} = 1.0 \\, \\mathrm{GeV}$ 并定义\n$$\n\\mathcal{S}(E_\\nu,\\Lambda_\\pi) = \\frac{\\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi)}{\\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi^{\\mathrm{ref}})}.\n$$\n该比率是无量纲的，在 $\\Lambda_\\pi = \\Lambda_\\pi^{\\mathrm{ref}}$ 时等于 1，并且隔离了由π介子截断通过 2p2h 道传播而引起的全反应强度的变化。\n\n算法步骤：\n- 对于每个测试能量 $E_\\nu$，计算 $Q^2_{\\max} = 2 m_N E_\\nu$。\n- 使用偶极积分的闭合形式表达式及 $(M_V, M_A, g_A(0))$ 计算 $\\mathcal{I}_{\\text{QE}}(Q^2_{\\max})$。\n- 使用给定的 $S_0$ 和常数计算 $\\sigma_{\\text{QE}}(E_\\nu)$，转换为 $\\mathrm{cm}^2$，然后再转换为以 $10^{-38} \\, \\mathrm{cm}^2$ 为单位。\n- 对于测试集中的每个 $\\Lambda_\\pi$，在 $Q^2 \\in [0,Q^2_{\\max}]$ 上数值计算 $\\mathcal{I}_{\\text{2p2h}}(Q^2_{\\max};\\Lambda_\\pi)$，使用稳定的求积方法，如自适应积分，并为平滑的被积函数设置合适的相对容差。\n- 使用给定的 $S_1$ 计算 $\\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi)$，按上述方法转换单位，然后形成 $\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi) = \\sigma_{\\text{QE}}(E_\\nu) + \\sigma_{\\text{2p2h}}(E_\\nu;\\Lambda_\\pi)$。\n- 在 $\\Lambda_\\pi^{\\mathrm{ref}} = 1.0 \\, \\mathrm{GeV}$ 处计算参考的 $\\sigma_{\\text{inc}}(E_\\nu;\\Lambda_\\pi^{\\mathrm{ref}})$，并为每个测试用例形成 $\\mathcal{S}(E_\\nu,\\Lambda_\\pi)$。\n- 按要求的顺序汇总 20 个灵敏度比率，并将其作为单个逗号分隔的列表打印在方括号中。\n\n覆盖范围和边界情况：\n- 测试能量 $E_\\nu \\in \\{0.3, 0.6, 1.0, 2.0\\}$ 探测了与加速器中微子相关的低、中、高能区。在低 $E_\\nu$ 时，准弹性占主导，$\\mathcal{S}$ 保持接近 1，因为 2p2h 的份额很小。随着 $E_\\nu$ 增加，2p2h 强度通过 $\\frac{E_\\nu}{E_\\nu+E_0}$ 因子增长，对 $\\Lambda_\\pi$ 的敏感性也增加。\n- 截断集 $\\Lambda_\\pi \\in \\{0.6, 0.8, 1.0, 1.2, 1.4\\} \\, \\mathrm{GeV}$ 跨越了核模型中使用的合理范围，测试了π介子介导流中的抑制/增强效应。\n- 数值积分的条件良好，因为被积函数在有限区间上是平滑、严格为正且快速衰减的；使用适度容差的自适应求积法可产生稳定结果。\n\n最终的程序实现了这些步骤，遵守了单位规范，并按规定的格式输出了所需的灵敏度比率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\n# Physical constants and model parameters\nG_F = 1.1663787e-5          # GeV^-2\ncos_theta_C = 0.97420       # dimensionless\nm_N = 0.939                 # GeV\nGEV2_TO_CM2 = 0.389379e-27  # cm^2 / GeV^-2\n\n# Nucleon form factor parameters\nM_V = 0.84                  # GeV\nM_A = 1.03                  # GeV\ngA0 = 1.267                 # axial charge\n\n# 2p2h model parameters\nE0 = 0.2                    # GeV\nbeta = 0.6                  # GeV^2\n\n# Scaling constants to set realistic magnitudes\nS0 = 0.2                    # QE strength scale (dimensionless)\nS1 = 0.08                   # 2p2h strength scale (dimensionless)\n\n# Reference cutoff\nLambda_pi_ref = 1.0         # GeV\n\ndef Q2_max(E_nu):\n    \"\"\"Approximate upper limit of Q^2 for fixed-target scattering: Q^2_max ≈ 2 m_N E_nu.\"\"\"\n    return 2.0 * m_N * E_nu\n\ndef dipole_integral(Q2m, M):\n    \"\"\"\n    Closed-form integral of [1 / (1 + Q^2 / M^2)]^4 dQ^2 from 0 to Q2m:\n    = (M^2 / 3) * [1 - (1 + Q2m / M^2)^(-3)]\n    \"\"\"\n    return (M**2 / 3.0) * (1.0 - (1.0 + Q2m / M**2)**(-3.0))\n\ndef sigma_QE_1e38(E_nu):\n    \"\"\"\n    Compute QE cross section per nucleon in units of 1e-38 cm^2 using the simplified model.\n    \"\"\"\n    Q2m = Q2_max(E_nu)\n    I_V = dipole_integral(Q2m, M_V)\n    I_A = dipole_integral(Q2m, M_A)\n    I_QE = I_V + (gA0**2) * I_A  # dimensionless integral in GeV^2 units\n    sigma_gevm2 = S0 * (G_F**2) * (cos_theta_C**2) * E_nu * m_N * I_QE\n    sigma_cm2 = sigma_gevm2 * GEV2_TO_CM2\n    return sigma_cm2 / 1e-38\n\ndef F_pi_squared(Q2, Lambda_pi):\n    \"\"\"Pion form factor squared (monopole squared) as a function of Q2 and cutoff Lambda_pi.\"\"\"\n    return (Lambda_pi**2 / (Lambda_pi**2 + Q2))**2\n\ndef two_p_two_h_integrand(Q2, Lambda_pi):\n    \"\"\"Integrand for the 2p2h Q^2 integral.\"\"\"\n    return np.exp(-Q2 / beta) * F_pi_squared(Q2, Lambda_pi)\n\ndef sigma_2p2h_1e38(E_nu, Lambda_pi):\n    \"\"\"\n    Compute 2p2h cross section per nucleon in units of 1e-38 cm^2 using the simplified model.\n    \"\"\"\n    Q2m = Q2_max(E_nu)\n    I_2p2h, _ = quad(two_p_two_h_integrand, 0.0, Q2m, args=(Lambda_pi,), epsrel=1e-7, epsabs=0.0, limit=200)\n    energy_factor = E_nu / (E_nu + E0)\n    sigma_gevm2 = S1 * (G_F**2) * (cos_theta_C**2) * E_nu * m_N * energy_factor * I_2p2h\n    sigma_cm2 = sigma_gevm2 * GEV2_TO_CM2\n    return sigma_cm2 / 1e-38\n\ndef sigma_inc_1e38(E_nu, Lambda_pi):\n    \"\"\"Inclusive cross section (QE + 2p2h) in units of 1e-38 cm^2.\"\"\"\n    return sigma_QE_1e38(E_nu) + sigma_2p2h_1e38(E_nu, Lambda_pi)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    E_nu_values = [0.3, 0.6, 1.0, 2.0]         # GeV\n    Lambda_pi_values = [0.6, 0.8, 1.0, 1.2, 1.4]  # GeV\n\n    results = []\n    for E in E_nu_values:\n        sigma_ref = sigma_inc_1e38(E, Lambda_pi_ref)\n        for L in Lambda_pi_values:\n            sigma_cur = sigma_inc_1e38(E, L)\n            sensitivity = sigma_cur / sigma_ref\n            results.append(sensitivity)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}