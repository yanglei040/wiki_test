{
    "hands_on_practices": [
        {
            "introduction": "主成分分析为理解复杂数据提供了强有力的基础，但这个基础的稳定性如何？本练习探讨了一个根本性问题：在实验数据和计算模拟中普遍存在的少量噪声，会如何影响主成分及其对应的方差（特征值）。掌握微扰理论的这一应用，能让你深刻理解任何基于PCA模型的稳健性。",
            "id": "3581397",
            "problem": "在计算核物理中，诸如手性有效场论模拟器等理论模型会根据模型参数的抽样，生成相关可观测量的向量。设模型的内在预测是一个随机向量 $s \\in \\mathbb{R}^{3}$，其均值为零，协方差矩阵为 $C = \\mathbb{E}[s s^{\\top}]$，其中 $C$ 是对称正定矩阵，具有不同的特征值和标准正交的特征向量。数据采集过程进一步引入了独立的高斯加性噪声 $n \\sim \\mathcal{N}(0, \\epsilon \\Sigma)$，其均值为零，协方差为 $\\epsilon \\Sigma$，其中 $\\Sigma$ 是一个固定的对称矩阵，$0 < \\epsilon \\ll 1$ 是一个表示信噪比尺度的无量纲小噪声强度参数。测量得到的向量为 $x = s + n$，因此根据协方差的独立性和双线性， $x$ 的总协方差为 $C_{\\epsilon} = \\mathbb{E}[x x^{\\top}] = C + \\epsilon \\Sigma$。\n\n主成分分析（PCA）旨在寻找协方差矩阵的特征对。假设 $C$ 具有谱分解 $C = \\sum_{k=1}^{3} \\lambda_{k} u_{k} u_{k}^{\\top}$，其特征值严格有序且非简并，即 $\\lambda_{1} > \\lambda_{2} > \\lambda_{3}$，对应的标准正交特征向量为 $u_{1}, u_{2}, u_{3}$。考虑受扰动的协方差 $C_{\\epsilon}$ 的特征问题：\n$$(C + \\epsilon \\Sigma) \\, u_{k}(\\epsilon) = \\lambda_{k}(\\epsilon) \\, u_{k}(\\epsilon),$$\n其中 $u_{k}(\\epsilon)$ 和 $\\lambda_{k}(\\epsilon)$ 分别是受扰动的主方向和特征值，其选择使得 $u_{k}(0) = u_{k}$。\n\n在标准正交基 $\\{e_{1}, e_{2}, e_{3}\\}$ 中进行计算，在此基下 $C$ 是对角矩阵，对角元为 $\\lambda_{1}, \\lambda_{2}, \\lambda_{3}$，因此 $u_{1} = e_{1}$, $u_{2} = e_{2}$, $u_{3} = e_{3}$。设噪声协方差为对称矩阵\n$$\\Sigma = \\begin{pmatrix}\n\\sigma_{11} & \\sigma_{12} & \\sigma_{13} \\\\\n\\sigma_{12} & \\sigma_{22} & \\sigma_{23} \\\\\n\\sigma_{13} & \\sigma_{23} & \\sigma_{33}\n\\end{pmatrix}.$$\n\n仅从对称矩阵的协方差、特征值和特征向量的定义出发，并假设非简并性和 $\\epsilon$ 很小，推导出特征值和主方向关于 $\\epsilon$ 的一阶微扰。然后，给出归一化的受扰动第一主方向 $u_{1}(\\epsilon)$ 中 $e_{2}$ 的一阶系数。\n\n您的最终答案必须是关于 $\\epsilon$、$\\lambda_{1}$、$\\lambda_{2}$ 和 $\\sigma_{12}$ 的单个闭式解析表达式。不包含任何单位。不提供任何数值近似。",
            "solution": "用户要求我解决以下问题。\n\n所提出的问题是线性代数中一阶非简并微扰理论应用于矩阵的一个标准练习，其背景设定在计算物理学领域。任务是确定协方差矩阵的特征向量在一个小的加性微扰下的一阶修正。\n\n设未受扰动的算子为协方差矩阵 $C$，微扰为 $\\epsilon \\Sigma$。总的、受扰动的协方差矩阵为 $C_{\\epsilon} = C + \\epsilon \\Sigma$。未受扰动的特征问题是 $C u_k = \\lambda_k u_k$，其中 $k \\in \\{1, 2, 3\\}$。问题指出，我们在 $C$ 为对角矩阵的标准正交基 $\\{e_{1}, e_{2}, e_{3}\\}$ 中进行计算，这意味着这是 $C$ 的特征基。因此，我们有 $u_k = e_k$ 和 $C = \\text{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$。假设特征值 $\\lambda_1, \\lambda_2, \\lambda_3$ 是互不相同且有序的，即 $\\lambda_1 > \\lambda_2 > \\lambda_3$，这确保了它们的非简并性。\n\n受扰动的特征问题是 $(C + \\epsilon \\Sigma) u_k(\\epsilon) = \\lambda_k(\\epsilon) u_k(\\epsilon)$。我们假设受扰动的特征值和特征向量可以按小参数 $\\epsilon$ 展开为幂级数：\n$$ \\lambda_k(\\epsilon) = \\lambda_k^{(0)} + \\epsilon \\lambda_k^{(1)} + \\epsilon^2 \\lambda_k^{(2)} + \\dots $$\n$$ u_k(\\epsilon) = u_k^{(0)} + \\epsilon u_k^{(1)} + \\epsilon^2 u_k^{(2)} + \\dots $$\n零阶项对应于未受扰动的系统，所以 $\\lambda_k^{(0)} = \\lambda_k$ 且 $u_k^{(0)} = u_k$。我们还要求受扰动的特征向量保持归一化，即 $\\|u_k(\\epsilon)\\|^2=1$。\n\n将级数展开式代入受扰动的特征值方程，得到：\n$$ (C + \\epsilon \\Sigma) (u_k + \\epsilon u_k^{(1)} + O(\\epsilon^2)) = (\\lambda_k + \\epsilon \\lambda_k^{(1)} + O(\\epsilon^2))(u_k + \\epsilon u_k^{(1)} + O(\\epsilon^2)) $$\n按 $\\epsilon$ 的幂次展开并收集各项：\n零阶 ($O(\\epsilon^0)$):\n$$ C u_k = \\lambda_k u_k $$\n这是未受扰动的特征值方程，根据定义，它是成立的。\n\n一阶 ($O(\\epsilon^1)$):\n$$ C u_k^{(1)} + \\Sigma u_k = \\lambda_k u_k^{(1)} + \\lambda_k^{(1)} u_k $$\n这个方程使我们能够确定一阶修正量 $\\lambda_k^{(1)}$ 和 $u_k^{(1)}$。\n\n为了求特征值的一阶修正 $\\lambda_k^{(1)}$，我们将一阶方程与未受扰动的特征向量 $u_k^{\\top}$ 作内积：\n$$ u_k^{\\top} C u_k^{(1)} + u_k^{\\top} \\Sigma u_k = u_k^{\\top} \\lambda_k u_k^{(1)} + u_k^{\\top} \\lambda_k^{(1)} u_k $$\n由于 $C$ 是对称的， $u_k^{\\top} C = (C u_k)^{\\top} = (\\lambda_k u_k)^{\\top} = \\lambda_k u_k^{\\top}$。方程变为：\n$$ \\lambda_k u_k^{\\top} u_k^{(1)} + u_k^{\\top} \\Sigma u_k = \\lambda_k u_k^{\\top} u_k^{(1)} + \\lambda_k^{(1)} u_k^{\\top} u_k $$\n利用归一化条件 $u_k^{\\top} u_k = 1$，涉及 $u_k^{(1)}$ 的项相互抵消，得到一阶能量（特征值）修正的标准结果：\n$$ \\lambda_k^{(1)} = u_k^{\\top} \\Sigma u_k $$\n在给定的基中，$u_k = e_k$，因此 $\\lambda_k^{(1)} = e_k^{\\top} \\Sigma e_k = \\Sigma_{kk} = \\sigma_{kk}$。\n\n为了求特征向量的一阶修正 $u_k^{(1)}$，我们重新整理一阶方程：\n$$ (C - \\lambda_k I) u_k^{(1)} = (\\lambda_k^{(1)} I - \\Sigma) u_k $$\n我们可以将修正向量 $u_k^{(1)}$ 表示为未受扰动的特征向量 $\\{u_j\\}_{j=1}^3$ 的线性组合：\n$$ u_k^{(1)} = \\sum_{j=1}^{3} c_{kj} u_j $$\n归一化条件 $\\|u_k(\\epsilon)\\|^2=1$ 意味着，在一阶近似下，修正量 $u_k^{(1)}$ 必须与 $u_k$ 正交。\n$$ \\|u_k + \\epsilon u_k^{(1)}\\|^2 = (u_k + \\epsilon u_k^{(1)})^{\\top}(u_k + \\epsilon u_k^{(1)}) = u_k^{\\top}u_k + 2\\epsilon u_k^{\\top}u_k^{(1)} + O(\\epsilon^2) = 1 $$\n由于 $u_k^{\\top}u_k = 1$，我们必须有 $u_k^{\\top}u_k^{(1)} = 0$。这意味着系数 $c_{kk} = u_k^{\\top}u_k^{(1)}$ 为零。因此，$u_k^{(1)}$ 的展开式对 $j \\neq k$ 求和：\n$$ u_k^{(1)} = \\sum_{j \\neq k} c_{kj} u_j $$\n为了求系数 $c_{kj}$，我们将重新整理后的一阶方程与 $u_j^{\\top}$ ($j \\neq k$) 作内积：\n$$ u_j^{\\top} (C - \\lambda_k I) u_k^{(1)} = u_j^{\\top} (\\lambda_k^{(1)} I - \\Sigma) u_k $$\n对于左边，由于 $u_j^{\\top}C=\\lambda_j u_j^{\\top}$：\n$$ u_j^{\\top} (C - \\lambda_k I) u_k^{(1)} = (\\lambda_j - \\lambda_k) u_j^{\\top} u_k^{(1)} = (\\lambda_j - \\lambda_k) u_j^{\\top} \\sum_{m \\neq k} c_{km} u_m = (\\lambda_j - \\lambda_k) c_{kj} $$\n对于右边，由于 $j \\neq k$, $u_j^{\\top}u_k=0$：\n$$ u_j^{\\top} (\\lambda_k^{(1)} I - \\Sigma) u_k = \\lambda_k^{(1)} u_j^{\\top}u_k - u_j^{\\top}\\Sigma u_k = - u_j^{\\top}\\Sigma u_k $$\n令两边相等，得到：\n$$ (\\lambda_j - \\lambda_k) c_{kj} = - u_j^{\\top}\\Sigma u_k $$\n由于特征值是非简并的，对于 $j \\neq k$ 有 $\\lambda_j \\neq \\lambda_k$，我们可以解出 $c_{kj}$：\n$$ c_{kj} = \\frac{- u_j^{\\top}\\Sigma u_k}{\\lambda_j - \\lambda_k} = \\frac{u_j^{\\top}\\Sigma u_k}{\\lambda_k - \\lambda_j} $$\n因此，特征向量的一阶修正为：\n$$ u_k^{(1)} = \\sum_{j \\neq k} \\frac{u_j^{\\top}\\Sigma u_k}{\\lambda_k - \\lambda_j} u_j $$\n现在我们将这个一般结果应用于具体问题。我们需要求受扰动的第一主方向 $u_1(\\epsilon)$ 中 $e_2$ 的系数。我们设 $k=1$。未受扰动的特征向量是 $u_1=e_1$。一阶近似下的受扰动特征向量是：\n$$ u_1(\\epsilon) \\approx u_1 + \\epsilon u_1^{(1)} = u_1 + \\epsilon \\sum_{j \\neq 1} \\frac{u_j^{\\top}\\Sigma u_1}{\\lambda_1 - \\lambda_j} u_j $$\n将 $j \\in \\{2, 3\\}$ 的和展开：\n$$ u_1(\\epsilon) \\approx u_1 + \\epsilon \\left( \\frac{u_2^{\\top}\\Sigma u_1}{\\lambda_1 - \\lambda_2} u_2 + \\frac{u_3^{\\top}\\Sigma u_1}{\\lambda_1 - \\lambda_3} u_3 \\right) $$\n在给定的基中，$u_1=e_1$，$u_2=e_2$，$u_3=e_3$。$\\Sigma$ 在此基下的矩阵元为 $u_i^\\top \\Sigma u_j = e_i^\\top \\Sigma e_j = \\sigma_{ij}$。将这些代入表达式中：\n$$ u_1(\\epsilon) \\approx e_1 + \\epsilon \\left( \\frac{\\sigma_{21}}{\\lambda_1 - \\lambda_2} e_2 + \\frac{\\sigma_{31}}{\\lambda_1 - \\lambda_3} e_3 \\right) $$\n由于 $\\Sigma$ 是对称矩阵，$\\sigma_{21} = \\sigma_{12}$。\n$$ u_1(\\epsilon) \\approx e_1 + \\epsilon \\frac{\\sigma_{12}}{\\lambda_1 - \\lambda_2} e_2 + \\epsilon \\frac{\\sigma_{13}}{\\lambda_1 - \\lambda_3} e_3 $$\n向量 $u_1(\\epsilon)$ 可以表示为基向量的线性组合：$u_1(\\epsilon) = c_1(\\epsilon)e_1 + c_2(\\epsilon)e_2 + c_3(\\epsilon)e_3$。乘以 $e_2$ 的系数是 $c_2(\\epsilon) = e_2^{\\top}u_1(\\epsilon)$。\n在一阶 $\\epsilon$ 近似下，该系数为：\n$$ e_2^{\\top} u_1(\\epsilon) \\approx e_2^{\\top} \\left( e_1 + \\epsilon \\frac{\\sigma_{12}}{\\lambda_1 - \\lambda_2} e_2 + \\epsilon \\frac{\\sigma_{13}}{\\lambda_1 - \\lambda_3} e_3 \\right) $$\n利用基向量的标准正交性（$e_2^{\\top}e_1=0$，$e_2^{\\top}e_2=1$，$e_2^{\\top}e_3=0$）：\n$$ e_2^{\\top} u_1(\\epsilon) \\approx 0 + \\epsilon \\frac{\\sigma_{12}}{\\lambda_1 - \\lambda_2} (1) + \\epsilon \\frac{\\sigma_{13}}{\\lambda_1 - \\lambda_3} (0) = \\epsilon \\frac{\\sigma_{12}}{\\lambda_1 - \\lambda_2} $$\n在归一化的受扰动第一主方向 $u_1(\\epsilon)$ 中乘以 $e_2$ 的显式一阶系数是 $u_1(\\epsilon)$ 在 $e_2$ 上的投影中 $\\epsilon$ 的一阶项。这就是推导出的表达式。",
            "answer": "$$\\boxed{\\epsilon \\frac{\\sigma_{12}}{\\lambda_{1} - \\lambda_{2}}}$$"
        },
        {
            "introduction": "PCA的一个关键应用是降维，即我们将基截断，只保留最重要的分量，但这并非没有代价。本练习将指导你量化这种截断如何影响单个可观测量的 不确定性（边际方差）。通过推导方差比率的严格边界，你将发现其影响关键取决于该可观测量与保留和舍弃的主成分的对齐方式。",
            "id": "3581437",
            "problem": "考虑一个计算核物理工作流，其中一个理论模型预测了一个包含 $p$ 个核可观测量（例如，沿同位素链的一组结合能）的向量。设模型差异由一个零均值的多元正态分布描述，其协方差矩阵为 $\\Sigma \\in \\mathbb{R}^{p \\times p}$。假设已对 $\\Sigma$ 执行主成分分析（PCA），得到谱分解 $\\Sigma = U \\Lambda U^{\\top}$，其中 $U$ 是一个其列为特征向量的正交矩阵，$\\Lambda = \\operatorname{diag}(\\lambda_{1}, \\lambda_{2}, \\dots, \\lambda_{p})$ 包含满足 $\\lambda_{1} \\geq \\lambda_{2} \\geq \\dots \\geq \\lambda_{p} > 0$ 的有序特征值。在实践中，通常会截断至前 $k$ 个主成分来报告后验预测区间。考虑以下设置：\n\n- 维度为 $p = 5$，特征值为 $\\lambda_{1} = 3.2$, $\\lambda_{2} = 1.5$, $\\lambda_{3} = 0.7$, $\\lambda_{4} = 0.3$, $\\lambda_{5} = 0.1$ （单位均为 $\\mathrm{MeV}^{2}$）。\n- 截断PCA近似保留 $k = 3$ 个成分。\n- 关注由 $j \\in \\{1, \\dots, p\\}$ 索引的单个可观测量。将标准基向量 $e_{j} \\in \\mathbb{R}^{p}$ 在PCA特征基中写作 $e_{j} = \\sum_{i=1}^{p} c_{i} u_{i}$，其中 $u_{i}$ 是第 $i$ 个特征向量，$c_{i} = u_{i}^{\\top} e_{j}$。定义子空间对齐分数 $A_{\\mathrm{top}} = \\sum_{i=1}^{k} c_{i}^{2}$ 和互补的尾部分数 $A_{\\mathrm{tail}} = 1 - A_{\\mathrm{top}}$。假设 $A_{\\mathrm{top}} = 0.6$。\n\n令 $s_{\\mathrm{true}} = e_{j}^{\\top} \\Sigma e_{j}$ 表示在完整协方差下该可观测量的真实边缘后验方差，令 $s_{\\mathrm{rep}}$ 表示在截断PCA（$k$ 个成分）下报告的边缘方差。定义方差比 $q = s_{\\mathrm{rep}} / s_{\\mathrm{true}}$。\n\n任务：\n1. 从多元正态分布、特征分解和线性投影的定义出发，推导当使用 $s_{\\mathrm{rep}}$ 计算区间而真实变异性为 $s_{\\mathrm{true}}$ 时，可观测量 $j$ 的名义 $(1-\\alpha)$ 后验覆盖率的显式表达式。用 $q$、标准正态累积分布函数和通常的分位数 $z_{1-\\alpha/2}$ 来表示此覆盖率。\n2. 仅使用特征值的排序和给定的 $A_{\\mathrm{top}}$ 值，推导 $q$ 的紧致下界和上界，这些界源于 $c_{i}^{2}$ 在保留和舍弃的主成分间的极值分配。\n3. 对给定的特征值和 $A_{\\mathrm{top}} = 0.6$ 进行数值评估。将你的答案四舍五入至四位有效数字。将最终答案表示为关于 $q$ 的一对无单位的界。",
            "solution": "对问题陈述进行验证。\n\n### 步骤1：提取给定信息\n-   一个理论模型预测一个包含 $p$ 个核可观测量的向量。\n-   模型差异是一个零均值的多元正态分布，协方差矩阵为 $\\Sigma \\in \\mathbb{R}^{p \\times p}$。\n-   谱分解：$\\Sigma = U \\Lambda U^{\\top}$。\n-   $U$ 是一个正交矩阵，其列为 $u_{i}$（特征向量）。\n-   $\\Lambda = \\operatorname{diag}(\\lambda_{1}, \\lambda_{2}, \\dots, \\lambda_{p})$。\n-   有序特征值：$\\lambda_{1} \\geq \\lambda_{2} \\geq \\dots \\geq \\lambda_{p} > 0$。\n-   维度：$p = 5$。\n-   特征值：$\\lambda_{1} = 3.2$, $\\lambda_{2} = 1.5$, $\\lambda_{3} = 0.7$, $\\lambda_{4} = 0.3$, $\\lambda_{5} = 0.1$（单位为 $\\mathrm{MeV}^{2}$）。\n-   截断保留 $k = 3$ 个成分。\n-   可观测量索引：$j \\in \\{1, \\dots, p\\}$。\n-   标准基向量：$e_{j} \\in \\mathbb{R}^{p}$。\n-   $e_{j}$ 的特征基展开：$e_{j} = \\sum_{i=1}^{p} c_{i} u_{i}$，其中 $c_{i} = u_{i}^{\\top} e_{j}$。\n-   子空间对齐分数：$A_{\\mathrm{top}} = \\sum_{i=1}^{k} c_{i}^{2} = 0.6$。\n-   尾部分数：$A_{\\mathrm{tail}} = 1 - A_{\\mathrm{top}}$。\n-   真实边缘后验方差：$s_{\\mathrm{true}} = e_{j}^{\\top} \\Sigma e_{j}$。\n-   截断PCA报告的边缘方差：$s_{\\mathrm{rep}}$。\n-   方差比：$q = s_{\\mathrm{rep}} / s_{\\mathrm{true}}$。\n\n### 步骤2：使用提取的给定信息进行验证\n根据指定标准评估该问题。\n-   **科学依据充分**：该问题在统计学和线性代数方面有充分的依据，并应用于计算核物理中的一个现实场景（理论不确定性的量化）。所使用的方法（PCA、多元正态分布）是标准的。\n-   **定义明确**：问题陈述清晰，提供了执行所需推导和计算的所有必要数据和定义。目标具体，能得出唯一且有意义的答案。\n-   **客观性**：语言正式、精确，没有任何主观性或歧义。\n-   该问题不违反任何基本原则，是可形式化、自洽且科学上可验证的。它不是琐碎、不适定或不切实际的。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n***\n\n### 任务1：后验覆盖率的推导\n\n设模型差异向量为 $\\delta \\in \\mathbb{R}^p$，且 $\\delta \\sim \\mathcal{N}(0, \\Sigma)$。我们关注单个可观测量，它对应于此向量的第 $j$ 个分量 $\\delta_j = e_j^\\top \\delta$。作为多元正态随机变量的线性变换，$\\delta_j$ 本身也服从正态分布。\n$\\delta_j$ 的均值为 $E[\\delta_j] = E[e_j^\\top \\delta] = e_j^\\top E[\\delta] = e_j^\\top 0 = 0$。\n$\\delta_j$ 的真实方差由下式给出：\n$$s_{\\mathrm{true}} = \\mathrm{Var}(\\delta_j) = \\mathrm{Var}(e_j^\\top \\delta) = e_j^\\top \\mathrm{Var}(\\delta) e_j = e_j^\\top \\Sigma e_j$$\n因此，该可观测量的差异的真实分布为 $\\delta_j \\sim \\mathcal{N}(0, s_{\\mathrm{true}})$。\n\n使用报告的方差 $s_{\\mathrm{rep}}$ 构建一个名义 $(1-\\alpha)$ 后验区间。该区间为 $[-\\sqrt{s_{\\mathrm{rep}}} z_{1-\\alpha/2}, \\sqrt{s_{\\mathrm{rep}}} z_{1-\\alpha/2}]$，其中 $z_{1-\\alpha/2}$ 是标准正态分布 $\\mathcal{N}(0,1)$ 的上 $(1-\\alpha/2)$ 分位数，即 $\\Phi(z_{1-\\alpha/2}) = 1-\\alpha/2$，其中 $\\Phi$ 是标准正态累积分布函数（CDF）。\n\n实际覆盖概率是真实随机变量 $\\delta_j$ 落在此报告区间内的概率：\n$$P(-\\sqrt{s_{\\mathrm{rep}}} z_{1-\\alpha/2} \\leq \\delta_j \\leq \\sqrt{s_{\\mathrm{rep}}} z_{1-\\alpha/2})$$\n为了评估此概率，我们使用其真实方差 $s_{\\mathrm{true}}$ 对 $\\delta_j$ 进行标准化。令 $Z = \\delta_j / \\sqrt{s_{\\mathrm{true}}}$，因此 $Z \\sim \\mathcal{N}(0,1)$。不等式变为：\n$$P(-\\sqrt{s_{\\mathrm{rep}}} z_{1-\\alpha/2} \\leq Z\\sqrt{s_{\\mathrm{true}}} \\leq \\sqrt{s_{\\mathrm{rep}}} z_{1-\\alpha/2})$$\n在概率表达式内部除以 $\\sqrt{s_{\\mathrm{true}}}$ 得到：\n$$P\\left(-\\frac{\\sqrt{s_{\\mathrm{rep}}}}{\\sqrt{s_{\\mathrm{true}}}} z_{1-\\alpha/2} \\leq Z \\leq \\frac{\\sqrt{s_{\\mathrm{rep}}}}{\\sqrt{s_{\\mathrm{true}}}} z_{1-\\alpha/2}\\right)$$\n使用方差比 $q = s_{\\mathrm{rep}} / s_{\\mathrm{true}}$ 的定义，表达式简化为：\n$$P(-\\sqrt{q} z_{1-\\alpha/2} \\leq Z \\leq \\sqrt{q} z_{1-\\alpha/2})$$\n此概率使用 $Z \\sim \\mathcal{N}(0,1)$ 的累积分布函数（CDF）进行评估：\n$$\\mathrm{Coverage} = \\Phi(\\sqrt{q} z_{1-\\alpha/2}) - \\Phi(-\\sqrt{q} z_{1-\\alpha/2})$$\n使用标准正态CDF的对称性质 $\\Phi(-x) = 1 - \\Phi(x)$，我们得到覆盖概率的最终表达式：\n$$\\mathrm{Coverage} = \\Phi(\\sqrt{q} z_{1-\\alpha/2}) - (1 - \\Phi(\\sqrt{q} z_{1-\\alpha/2})) = 2\\Phi(\\sqrt{q} z_{1-\\alpha/2}) - 1$$\n\n### 任务2：方差比 $q$ 的界推导\n\n首先，我们用特征值和投影系数来表示 $s_{\\mathrm{true}}$ 和 $s_{\\mathrm{rep}}$。\n真实方差为 $s_{\\mathrm{true}} = e_j^\\top \\Sigma e_j$。使用谱分解 $\\Sigma = \\sum_{i=1}^p \\lambda_i u_i u_i^\\top$：\n$$s_{\\mathrm{true}} = e_j^\\top \\left(\\sum_{i=1}^p \\lambda_i u_i u_i^\\top\\right) e_j = \\sum_{i=1}^p \\lambda_i (e_j^\\top u_i) (u_i^\\top e_j)$$\n当 $c_i = u_i^\\top e_j$ 时，这变为：\n$$s_{\\mathrm{true}} = \\sum_{i=1}^p \\lambda_i c_i^2$$\n使用 $k$ 个主成分的协方差矩阵的截断近似为 $\\Sigma_k = \\sum_{i=1}^k \\lambda_i u_i u_i^\\top$。报告的方差为：\n$$s_{\\mathrm{rep}} = e_j^\\top \\Sigma_k e_j = e_j^\\top \\left(\\sum_{i=1}^k \\lambda_i u_i u_i^\\top\\right) e_j = \\sum_{i=1}^k \\lambda_i c_i^2$$\n因此，方差比为：\n$$q = \\frac{s_{\\mathrm{rep}}}{s_{\\mathrm{true}}} = \\frac{\\sum_{i=1}^k \\lambda_i c_i^2}{\\sum_{i=1}^p \\lambda_i c_i^2} = \\frac{\\sum_{i=1}^k \\lambda_i c_i^2}{\\sum_{i=1}^k \\lambda_i c_i^2 + \\sum_{i=k+1}^p \\lambda_i c_i^2}$$\n系数 $c_i^2$ 是非负的，且它们的和为1，因为 $e_j$ 是单位向量：$\\sum_{i=1}^p c_i^2 = \\sum_{i=1}^p (e_j^\\top u_i)^2 = \\|e_j\\|^2 = 1$。\n我们有以下约束条件：\n1. $\\sum_{i=1}^k c_i^2 = A_{\\mathrm{top}}$\n2. $\\sum_{i=k+1}^p c_i^2 = A_{\\mathrm{tail}} = 1 - A_{\\mathrm{top}}$\n\n为了找到 $q$ 的界，我们必须找到 $q$ 关于在其各自总和内分配“质量” $c_i^2$ 的极值。令 $N = \\sum_{i=1}^k \\lambda_i c_i^2$ 和 $D_{\\mathrm{tail}} = \\sum_{i=k+1}^p \\lambda_i c_i^2$。那么 $q = N / (N + D_{\\mathrm{tail}})$。\n\n为了找到下界 $q_{\\min}$，我们需要最小化 $N$ 并最大化 $D_{\\mathrm{tail}}$。\n- 为了在 $\\sum_{i=1}^k c_i^2 = A_{\\mathrm{top}}$ 的约束下最小化 $N = \\sum_{i=1}^k \\lambda_i c_i^2$，我们必须将全部质量 $A_{\\mathrm{top}}$ 分配给集合 $\\{\\lambda_1, \\dots, \\lambda_k\\}$ 中的最小特征值，即 $\\lambda_k$（因为 $\\lambda_1 \\geq \\dots \\geq \\lambda_k$）。这通过设置 $c_k^2 = A_{\\mathrm{top}}$ 和 $c_i^2=0$（对于 $i=1, \\dots, k-1$）来实现。因此，$N_{\\min} = \\lambda_k A_{\\mathrm{top}}$。\n- 为了在 $\\sum_{i=k+1}^p c_i^2 = A_{\\mathrm{tail}}$ 的约束下最大化 $D_{\\mathrm{tail}} = \\sum_{i=k+1}^p \\lambda_i c_i^2$，我们必须将全部质量 $A_{\\mathrm{tail}}$ 分配给集合 $\\{\\lambda_{k+1}, \\dots, \\lambda_p\\}$ 中的最大特征值，即 $\\lambda_{k+1}$。这通过设置 $c_{k+1}^2 = A_{\\mathrm{tail}}$ 和 $c_i^2=0$（对于 $i=k+2, \\dots, p$）来实现。因此，$D_{\\mathrm{tail, max}} = \\lambda_{k+1} A_{\\mathrm{tail}}$。\n下界是：\n$$q_{\\min} = \\frac{N_{\\min}}{N_{\\min} + D_{\\mathrm{tail, max}}} = \\frac{\\lambda_k A_{\\mathrm{top}}}{\\lambda_k A_{\\mathrm{top}} + \\lambda_{k+1} A_{\\mathrm{tail}}} = \\frac{\\lambda_k A_{\\mathrm{top}}}{\\lambda_k A_{\\mathrm{top}} + \\lambda_{k+1} (1-A_{\\mathrm{top}})}$$\n\n为了找到上界 $q_{\\max}$，我们需要最大化 $N$ 并最小化 $D_{\\mathrm{tail}}$。\n- 为了在 $\\sum_{i=1}^k c_i^2 = A_{\\mathrm{top}}$ 的约束下最大化 $N = \\sum_{i=1}^k \\lambda_i c_i^2$，我们将质量 $A_{\\mathrm{top}}$ 分配给最大特征值 $\\lambda_1$。这得到 $N_{\\max} = \\lambda_1 A_{\\mathrm{top}}$。\n- 为了在 $\\sum_{i=k+1}^p c_i^2 = A_{\\mathrm{tail}}$ 的约束下最小化 $D_{\\mathrm{tail}} = \\sum_{i=k+1}^p \\lambda_i c_i^2$，我们将质量 $A_{\\mathrm{tail}}$ 分配给尾部中的最小特征值，即 $\\lambda_p$。这得到 $D_{\\mathrm{tail, min}} = \\lambda_p A_{\\mathrm{tail}}$。\n上界是：\n$$q_{\\max} = \\frac{N_{\\max}}{N_{\\max} + D_{\\mathrm{tail, min}}} = \\frac{\\lambda_1 A_{\\mathrm{top}}}{\\lambda_1 A_{\\mathrm{top}} + \\lambda_p A_{\\mathrm{tail}}} = \\frac{\\lambda_1 A_{\\mathrm{top}}}{\\lambda_1 A_{\\mathrm{top}} + \\lambda_p (1-A_{\\mathrm{top}})}$$\n\n### 任务3：界的数值评估\n\n我们给定以下值：\n-   $p=5$, $k=3$\n-   $\\lambda_1 = 3.2$, $\\lambda_2 = 1.5$, $\\lambda_3 = 0.7$, $\\lambda_4 = 0.3$, $\\lambda_5 = 0.1$\n-   $A_{\\mathrm{top}} = 0.6$，所以 $A_{\\mathrm{tail}} = 1 - 0.6 = 0.4$\n\n与界相关的特征值是：\n-   $\\lambda_1 = 3.2$\n-   $\\lambda_k = \\lambda_3 = 0.7$\n-   $\\lambda_{k+1} = \\lambda_4 = 0.3$\n-   $\\lambda_p = \\lambda_5 = 0.1$\n\n现在我们可以计算这些界的数值。\n\n对于下界 $q_{\\min}$：\n$$q_{\\min} = \\frac{\\lambda_3 A_{\\mathrm{top}}}{\\lambda_3 A_{\\mathrm{top}} + \\lambda_4 A_{\\mathrm{tail}}} = \\frac{0.7 \\times 0.6}{0.7 \\times 0.6 + 0.3 \\times 0.4} = \\frac{0.42}{0.42 + 0.12} = \\frac{0.42}{0.54} = \\frac{7}{9}$$\n数值上，$q_{\\min} \\approx 0.77777...$。四舍五入到四位有效数字，我们得到 $q_{\\min} = 0.7778$。\n\n对于上界 $q_{\\max}$：\n$$q_{\\max} = \\frac{\\lambda_1 A_{\\mathrm{top}}}{\\lambda_1 A_{\\mathrm{top}} + \\lambda_5 A_{\\mathrm{tail}}} = \\frac{3.2 \\times 0.6}{3.2 \\times 0.6 + 0.1 \\times 0.4} = \\frac{1.92}{1.92 + 0.04} = \\frac{1.92}{1.96} = \\frac{48}{49}$$\n数值上，$q_{\\max} \\approx 0.9795918...$。四舍五入到四位有效数字，我们得到 $q_{\\max} = 0.9796$。\n\n$q$ 的紧致界为 $[0.7778, 0.9796]$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.7778 & 0.9796\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "除了数据压缩，PCA还是一个强大的诊断工具，可用于审视理论模型本身的结构。本练习让你扮演模型开发者的角色，使用PCA来检测“参数简并”——即不同模型参数组合产生几乎相同物理预测的情况。通过分析可观测量协方差矩阵的特征值谱，你可以识别并诊断这些冗余，这对于构建更具预测性和简约性的理论至关重要。",
            "id": "3581425",
            "problem": "考虑一个简化的 Skyrme 能量密度泛函 (EDF) 的校准设置，其中模型参数矢量 $p \\in \\mathbb{R}^d$ 决定了可观测量矢量 $y \\in \\mathbb{R}^m$。假设在校准点 $p_0$ 附近，小的扰动 $\\delta p$ 引起的可观测量变化可以通过一个线性化的灵敏度模型来描述，并且参数变动是随机的，具有已知的协方差。所有量都通过先前的归一化处理为无量纲量，因此不需要物理单位。\n\n你的任务是设计并实现一个基于主成分分析 (PCA) 的测试，通过分析由参数变化引起的可观测量协方差中的近零特征值来检测参数的简并性。该测试应从第一性原理出发，使用以下基本依据进行推导：校准点周围的线性响应、具有协方差的随机变量，以及对称半正定矩阵的谱分解。你不能在问题陈述中使用任何关于诱导可观测量协方差或 PCA 的预设公式；相反，你必须在你的解答中从所述的基本依据出发推导出它们。\n\n定义一个简并性检测准则如下。设可观测量协方差矩阵的特征值为 $\\{\\lambda_i\\}_{i=1}^m$，其中 $\\lambda_{\\max} = \\max_i \\lambda_i$。给定一个阈值参数 $\\tau > 0$，如果一个主成分的特征值满足 $\\lambda_i \\le \\tau \\lambda_{\\max}$，则声明该主成分是“简并的”。简并的总数 $D$ 是此类特征值的计数。$D$ 值越大，表示简并性越强。\n\n实现一个程序，对于每个提供的测试用例，根据给定的灵敏度矩阵和参数协方差计算诱导的可观测量协方差矩阵，执行 PCA，并根据上述准则返回简并计数 $D$。\n\n测试套件包含四个案例。在每个案例中，$m = d = 6$。为清晰起见，将灵敏度矩阵表示为 $S \\in \\mathbb{R}^{6 \\times 6}$，参数协方差表示为 $C_p \\in \\mathbb{R}^{6 \\times 6}$。阈值为 $\\tau = 10^{-9}$。\n\n案例 1（良态，预计无简并性）：\n- 灵敏度矩阵 $S_1$：\n$$\nS_1 = \\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0 \\\\\n0.5 & 0.2 & 0.1 & 0.3 & 1.0 & 0.0 \\\\\n0.1 & 0.4 & 0.3 & 0.2 & 0.0 & 1.0\n\\end{pmatrix}\n$$\n- 参数协方差 $C_{p,1}$：\n$$\nC_{p,1} = \\mathrm{diag}(1.0, 0.8, 1.2, 0.9, 1.1, 1.0)\n$$\n\n案例 2（两个参数方向之间存在精确的线性相关性）：\n- 灵敏度矩阵 $S_2$ 是通过将 $S_1$ 的第 5 列复制到第 6 列得到的，因此第 5 列和第 6 列是相同的：\n$$\nS_2 = \\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0 \\\\\n0.5 & 0.2 & 0.1 & 0.3 & 1.0 & 1.0 \\\\\n0.1 & 0.4 & 0.3 & 0.2 & 0.0 & 0.0\n\\end{pmatrix}\n$$\n- 参数协方差 $C_{p,2}$：\n$$\nC_{p,2} = \\mathrm{diag}(1.0, 1.0, 1.0, 1.0, 1.0, 1.0)\n$$\n\n案例 3（具有近乎冻结方向的各向异性参数协方差）：\n- 灵敏度矩阵 $S_3$ 等于 $S_1$。\n- 参数协方差 $C_{p,3}$：\n$$\nC_{p,3} = \\mathrm{diag}(1.0, 1.0, 1.0, 1.0, 1.0, 10^{-12})\n$$\n\n案例 4（近简并性：两个参数方向几乎线性相关）：\n- 灵敏度矩阵 $S_4$ 是通过对 $S_2$ 的第 6 列进行轻微扰动得到的，使其与第 5 列几乎相等但不完全相等。具体来说，设第 5 行和第 6 行的扰动量级为 $10^{-10}$：\n$$\nS_4 = \\begin{pmatrix}\n1 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 1 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0 \\\\\n0.5 & 0.2 & 0.1 & 0.3 & 1.0 & 1.0 + 3 \\times 10^{-11} \\\\\n0.1 & 0.4 & 0.3 & 0.2 & 0.0 & -3 \\times 10^{-11}\n\\end{pmatrix}\n$$\n- 参数协方差 $C_{p,4}$：\n$$\nC_{p,4} = \\mathrm{diag}(1.0, 1.0, 1.0, 1.0, 1.0, 1.0)\n$$\n\n你的程序必须对每个案例 $i \\in \\{1,2,3,4\\}$，使用阈值为 $\\tau = 10^{-9}$ 的基于 PCA 的准则计算简并计数 $D_i$，并生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 `[d1,d2,d3,d4]`，其中每个 $d_i$ 是案例 $i$ 的整数值 $D_i$。程序必须是完全自包含的，不得读取任何外部输入，并且必须完全按照给定的矩阵和阈值计算结果。本问题中不出现角度，任何地方都不得使用百分比；任何比率都应表示为小数。",
            "solution": "该问题要求设计并实现一个基于主成分分析 (PCA) 的测试，用于在线性化的理论模型中检测参数简并性，并从第一性原理推导该方法。任务的核心是分析由模型参数的随机变化所引起的可观测量协方差结构。\n\n基本要素是：\n1.  线性响应模型：模型参数的微小扰动 $\\delta p \\in \\mathbb{R}^d$ 会根据关系式 $\\delta y = S \\delta p$ 引起模型可观测量 $\\delta y \\in \\mathbb{R}^m$ 的变化。这里，$S \\in \\mathbb{R}^{m \\times d}$ 是灵敏度矩阵，其元素 $S_{ij} = \\frac{\\partial y_i}{\\partial p_j}$ 表示在参考点 $p_0$ 处计算的第 $i$ 个可观测量对第 $j$ 个参数的偏导数。\n2.  随机参数变化：参数扰动 $\\delta p$ 被视为一个随机矢量，其协方差矩阵 $C_p \\in \\mathbb{R}^{d \\times d}$ 已知。协方差矩阵定义为 $C_p = E[(\\delta p - E[\\delta p]) (\\delta p - E[\\delta p])^T]$，其中 $E[\\cdot]$ 表示期望值。对于围绕中心值的扰动，通常假设其均值为零，即 $E[\\delta p] = 0$，此时 $C_p = E[\\delta p \\, \\delta p^T]$。\n\n第一步是根据给定的参数协方差 $C_p$ 和线性模型推导出可观测量的协方差矩阵 $C_y$。$\\delta y$ 的协方差矩阵定义为：\n$$C_y = E[(\\delta y - E[\\delta y]) (\\delta y - E[\\delta y])^T]$$\n根据线性模型，$\\delta y$ 的期望为 $E[\\delta y] = E[S \\delta p] = S E[\\delta p]$。将此代入 $C_y$ 的定义：\n$$C_y = E[(S \\delta p - S E[\\delta p]) (S \\delta p - S E[\\delta p])^T]$$\n利用转置的性质和期望算子的线性性质，我们可以重构该表达式：\n$$C_y = E[S (\\delta p - E[\\delta p]) (\\delta p - E[\\delta p])^T S^T]$$\n由于灵敏度矩阵 $S$ 是常数，可以将其从期望中提出：\n$$C_y = S E[(\\delta p - E[\\delta p]) (\\delta p - E[\\delta p])^T] S^T$$\n识别出期望内的项即为参数协方差矩阵 $C_p$ 的定义，我们得到最终表达式：\n$$C_y = S C_p S^T$$\n这个 $m \\times m$ 矩阵封装了由参数变化引起的可观测量的方差和相关性。由于 $C_p$ 是一个对称半正定矩阵，因此 $C_y$ 也是对称半正定的。这保证了其特征值为实数且非负。\n\n对可观测量进行主成分分析 (PCA) 等价于对其协方差矩阵 $C_y$ 进行谱分解。根据谱定理，任何像 $C_y$ 这样的实对称矩阵都可以通过一个正交矩阵进行对角化：\n$$C_y = V \\Lambda V^T$$\n这里，$\\Lambda$ 是一个对角矩阵，其对角元 $\\{\\lambda_i\\}_{i=1}^m$ 是 $C_y$ 的特征值。正交矩阵 $V$ 的列是相应的标准正交特征向量 $\\{v_i\\}_{i=1}^m$。这些特征向量代表主成分：可观测量空间中一组新的正交方向基。特征值 $\\lambda_i$ 是可观测量数据投影到主方向 $v_i$ 上的方差。\n\n当参数变化的不同组合导致几乎无法区分的可观测量变化时，就会出现参数简并性。这表现为可观测量空间中某个方向的方差接近于零。$C_y$ 的一个为零或接近零的特征值 $\\lambda_i$ 表明相应的主成分 $v_i$ 几乎没有方差。这种情况是简并性的明确信号，因为它意味着参数变化传播到可观测量变化的方式中存在约束或冗余。\n\n该问题提供了一个量化准则来识别这些“简并”分量。给定一个阈值 $\\tau > 0$，如果一个特征值 $\\lambda_i$ 相对于最大特征值 $\\lambda_{\\max} = \\max_j \\lambda_j$ 异常小，则认为它表示一个简并。条件是：\n$$\\lambda_i \\le \\tau \\lambda_{\\max}$$\n简并的总数 $D$ 是满足此不等式的特征值的数量。对于本问题，给定的阈值为 $\\tau = 10^{-9}$。\n\n对于每个测试用例要实现的算法如下：\n1.  给定灵敏度矩阵 $S$ 和参数协方差矩阵 $C_p$。在所提供的案例中，$m=d=6$。\n2.  使用推导出的公式计算可观测量协方差矩阵：$C_y = S C_p S^T$。\n3.  计算对称矩阵 $C_y$ 的特征值。设它们为 $\\{\\lambda_i\\}_{i=1}^6$。\n4.  确定最大特征值 $\\lambda_{\\max} = \\max_i \\lambda_i$。\n5.  计数满足 $\\lambda_i \\le 10^{-9} \\lambda_{\\max}$ 的特征值数量 $D$。此计数即为该测试用例的最终结果。\n\n此过程将应用于四个测试用例，每个用例都旨在探讨一种不同的情景：\n-   **案例 1**：一个良态系统，预计没有简并性 ($D_1=0$)。\n-   **案例 2**：一个灵敏度矩阵 $S_2$ 的列之间存在精确线性相关的系统。这会引入秩亏，应导致 $C_y$ 恰好有一个零特征值，从而得到 $D_2=1$。\n-   **案例 3**：一个其中某个参数的方差被人为抑制到一个非常小的值 ($10^{-12}$) 的系统。这种对参数方向的“冻结”预计会在可观测量中引起一个近零的方差，从而产生一个非常小的特征值，得到 $D_3=1$。\n-   **案例 4**：一个 $S_4$ 的列之间存在近线性相关的系统。这是案例 2 的一个扰动，旨在使其满秩但病态。这应该会产生一个非常小但非零的特征值，该特征值仍然足够小，足以被标记为简并，从而得到 $D_4=1$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs PCA-based degeneracy detection on a set of test cases for a \n    linearized model calibration problem.\n    \"\"\"\n    \n    # Define the fixed threshold parameter tau\n    tau = 1e-9\n\n    # Case 1: Well-conditioned, no degeneracy expected\n    S1 = np.array([\n        [1.0, 0.0, 0.0, 0.0, 0.0, 0.0],\n        [0.0, 1.0, 0.0, 0.0, 0.0, 0.0],\n        [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],\n        [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],\n        [0.5, 0.2, 0.1, 0.3, 1.0, 0.0],\n        [0.1, 0.4, 0.3, 0.2, 0.0, 1.0]\n    ])\n    Cp1 = np.diag([1.0, 0.8, 1.2, 0.9, 1.1, 1.0])\n    \n    # Case 2: Exact linear dependence in sensitivity matrix\n    S2 = np.array([\n        [1.0, 0.0, 0.0, 0.0, 0.0, 0.0],\n        [0.0, 1.0, 0.0, 0.0, 0.0, 0.0],\n        [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],\n        [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],\n        [0.5, 0.2, 0.1, 0.3, 1.0, 1.0],\n        [0.1, 0.4, 0.3, 0.2, 0.0, 0.0]\n    ])\n    Cp2 = np.identity(6)\n    \n    # Case 3: Anisotropic parameter covariance, nearly frozen direction\n    S3 = S1\n    Cp3 = np.diag([1.0, 1.0, 1.0, 1.0, 1.0, 1e-12])\n    \n    # Case 4: Near-degeneracy in sensitivity matrix\n    S4 = np.array([\n        [1.0, 0.0, 0.0, 0.0, 0.0, 0.0],\n        [0.0, 1.0, 0.0, 0.0, 0.0, 0.0],\n        [0.0, 0.0, 1.0, 0.0, 0.0, 0.0],\n        [0.0, 0.0, 0.0, 1.0, 0.0, 0.0],\n        [0.5, 0.2, 0.1, 0.3, 1.0, 1.0 + 3e-11],\n        [0.1, 0.4, 0.3, 0.2, 0.0, -3e-11]\n    ])\n    Cp4 = np.identity(6)\n    \n    test_cases = [\n        (S1, Cp1),\n        (S2, Cp2),\n        (S3, Cp3),\n        (S4, Cp4)\n    ]\n    \n    results = []\n    \n    for S, Cp in test_cases:\n        # Step 1: Compute the observable covariance matrix Cy = S * Cp * S^T\n        Cy = S @ Cp @ S.T\n        \n        # Step 2: Compute the eigenvalues of the symmetric matrix Cy.\n        # Use eigvalsh for numerical stability and efficiency with symmetric matrices.\n        eigenvalues = np.linalg.eigvalsh(Cy)\n        \n        # Step 3: Find the maximum eigenvalue.\n        # Check against a small positive number to handle the zero matrix case.\n        lambda_max = np.max(eigenvalues) if eigenvalues.size > 0 else 0.0\n        \n        # Step 4: Count degeneracies based on the criterion.\n        # Ensure lambda_max is not zero to avoid division by zero or spurious results.\n        if lambda_max > 1e-30:  # A small tolerance for a non-zero max eigenvalue\n            degeneracy_count = np.sum(eigenvalues <= tau * lambda_max)\n        else:\n            # If all eigenvalues are effectively zero, they are all degenerate.\n            degeneracy_count = len(eigenvalues)\n            \n        results.append(int(degeneracy_count))\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}