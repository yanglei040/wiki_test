{
    "hands_on_practices": [
        {
            "introduction": "为了将抽象的理论转化为切实的理解，我们从一个直接的计算开始。这个练习将运动方程耦合簇 (EOM-CC) 的形式简化为一个可管理的双能级模型，让你能够手动构建并对角化其核心的本征值问题 。通过这个过程，你将直接看到激发能是如何从相似变换后的哈密顿量中产生的，为更复杂的应用打下坚实的基础。",
            "id": "3558017",
            "problem": "考虑一个与计算核物理相关的最小二能级模型中的闭壳层参考态。哈密顿量相对于 Hartree-Fock 参考态 $|\\Phi_0\\rangle$ 进行了正规排序，并写作 $H_N = F + V$，其中 $F$ 是单体部分，$V$ 是二体相互作用。耦合簇基态为 $|\\Psi_0\\rangle = \\exp(T) |\\Phi_0\\rangle$，其中簇算符为 $T = T_1 + T_2$，相似变换后的哈密顿量定义为 $\\bar{H} = \\exp(-T) H_N \\exp(T)$。Equation-of-Motion Coupled-Cluster with singles and doubles (EOM-CCSD) 的激发态问题是求解\n$$\n\\bar{H} R |\\Phi_0\\rangle = \\omega R |\\Phi_0\\rangle,\n$$\n其中激发算符 $R$ 被截断到单激发部分，即 $R = \\sum_{ai} r_i^{a} a_a^{\\dagger} a_i$，$i$ 表示已占据（空穴）轨道，$a$ 表示未占据（粒子）轨道。在这个二能级模型中，有一个空穴轨道 $i$ 和两个粒子轨道 $p_1$ 和 $p_2$，它们定义了单激发基矢 $\\{ a_{p_1}^{\\dagger} a_i |\\Phi_0\\rangle, a_{p_2}^{\\dagger} a_i |\\Phi_0\\rangle \\}$。\n\n从 EOM-CCSD 本征值方程和单激发投影的定义出发，建立 $\\bar{H}$ 在单激发空间的 $2 \\times 2$ 矩阵表示，\n$$\nA_{ai,bj} = \\langle \\Phi_0 | a_i^{\\dagger} a_a \\, \\bar{H} \\, a_b^{\\dagger} a_j | \\Phi_0 \\rangle,\n$$\n其中限制条件为 $i=j$ 且 $a,b \\in \\{p_1,p_2\\}$。对于此模型，假设单体缀饰能隙和对 $\\bar{H}$ 的单-单激发块的有效二体贡献已通过耦合簇基态确定如下：\n- 缀饰单体能隙：$\\tilde{\\epsilon}_{p_1} - \\tilde{\\epsilon}_{i} = 6.2$，$\\tilde{\\epsilon}_{p_2} - \\tilde{\\epsilon}_{i} = 8.5$。\n- 单-单激发块中的有效相互作用矩阵元：$\\tilde{W}_{p_1 i}^{p_1 i} = -0.3$，$\\tilde{W}_{p_2 i}^{p_2 i} = -0.2$ 以及 $\\tilde{W}_{p_1 i}^{p_2 i} = \\tilde{W}_{p_2 i}^{p_1 i} = 0.4$。\n\n使用这些量，明确写出 $2 \\times 2$ 的单-单激发矩阵并计算其本征值，这些本征值是此截断 EOM-CCSD 处理中激发能 $\\omega$ 的近似值。将您的数值答案四舍五入到四位有效数字。最终能量以 MeV 表示。",
            "solution": "该问题要求我们在截断的单激发空间中求解 EOM-CCSD 本征值方程。矩阵形式的方程为 $A \\mathbf{r} = \\omega \\mathbf{r}$，其中 $A$ 是相似变换哈密顿量 $\\bar{H}$ 在单激发基矢下的矩阵表示，$\\mathbf{r}$ 是振幅 $r_i^a$ 的向量。本征值 $\\omega$ 对应于激发能。\n\n单激发空间由两个态 $|\\Phi_i^{p_1}\\rangle = a_{p_1}^{\\dagger} a_i |\\Phi_0\\rangle$ 和 $|\\Phi_i^{p_2}\\rangle = a_{p_2}^{\\dagger} a_i |\\Phi_0\\rangle$ 张成。$2 \\times 2$ 矩阵 $A$ 的元素为 $A_{ab} = \\langle \\Phi_i^a | \\bar{H} | \\Phi_i^b \\rangle$，其中 $a, b \\in \\{p_1, p_2\\}$。\n\n问题提供了这些矩阵元的组成部分：“缀饰单体能隙”和“有效相互作用矩阵元”。在 EOM-CCSD 形式体系中，$\\bar{H}$ 的矩阵元由单体和二体项构成，并由耦合簇振幅修正。给定的量代表了这些贡献的最终值。总矩阵元是这些部分的总和。具体来说，对角元 $A_{aa}$ 是相应缀饰能隙和对角有效相互作用之和，而非对角元 $A_{ab}$ ($a \\neq b$) 仅由非对角有效相互作用项构成。\n\n矩阵元的构建如下：\n$A_{ab} = (\\tilde{\\epsilon}_a - \\tilde{\\epsilon}_i) \\delta_{ab} + \\tilde{W}_{ai}^{bi}$，其中 $\\delta_{ab}$ 是克罗内克 δ。\n\n我们来计算矩阵 $A$ 的四个元素：\n1.  对角元 $A_{p_1, p_1}$：\n    $$A_{p_1, p_1} = (\\tilde{\\epsilon}_{p_1} - \\tilde{\\epsilon}_i) + \\tilde{W}_{p_1 i}^{p_1 i} = 6.2 + (-0.3) = 5.9$$\n\n2.  对角元 $A_{p_2, p_2}$：\n    $$A_{p_2, p_2} = (\\tilde{\\epsilon}_{p_2} - \\tilde{\\epsilon}_i) + \\tilde{W}_{p_2 i}^{p_2 i} = 8.5 + (-0.2) = 8.3$$\n\n3.  非对角元 $A_{p_1, p_2}$：\n    $$A_{p_1, p_2} = \\tilde{W}_{p_1 i}^{p_2 i} = 0.4$$\n\n4.  非对角元 $A_{p_2, p_1}$：\n    $$A_{p_2, p_1} = \\tilde{W}_{p_2 i}^{p_1 i} = 0.4$$\n\n得到的 $2 \\times 2$ 单-单激发矩阵是：\n$$\nA = \\begin{pmatrix} 5.9 & 0.4 \\\\ 0.4 & 8.3 \\end{pmatrix}\n$$\n该矩阵的本征值 $\\omega$ 是特征方程 $\\det(A - \\omega I) = 0$ 的解，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det \\begin{pmatrix} 5.9 - \\omega & 0.4 \\\\ 0.4 & 8.3 - \\omega \\end{pmatrix} = 0\n$$\n展开行列式得到二次方程：\n$$\n(5.9 - \\omega)(8.3 - \\omega) - (0.4)(0.4) = 0\n$$\n$$\n48.97 - 5.9\\omega - 8.3\\omega + \\omega^2 - 0.16 = 0\n$$\n$$\n\\omega^2 - 14.2\\omega + 48.81 = 0\n$$\n我们使用二次公式 $\\omega = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $\\omega$ 的二次方程，其中 $a=1$，$b=-14.2$，$c=48.81$。\n$$\n\\omega = \\frac{-(-14.2) \\pm \\sqrt{(-14.2)^2 - 4(1)(48.81)}}{2(1)}\n$$\n$$\n\\omega = \\frac{14.2 \\pm \\sqrt{201.64 - 195.24}}{2}\n$$\n$$\n\\omega = \\frac{14.2 \\pm \\sqrt{6.4}}{2}\n$$\n现在，我们计算两个本征值的数值，它们代表以 MeV 为单位的激发能。\n$$\n\\sqrt{6.4} \\approx 2.5298221\n$$\n两个本征值是：\n$$\n\\omega_1 = \\frac{14.2 - 2.5298221}{2} = \\frac{11.6701779}{2} \\approx 5.8350889\n$$\n$$\n\\omega_2 = \\frac{14.2 + 2.5298221}{2} = \\frac{16.7298221}{2} \\approx 8.3649111\n$$\n根据要求，将这些值四舍五入到四位有效数字：\n$$\n\\omega_1 \\approx 5.835 \\, \\text{MeV}\n$$\n$$\n\\omega_2 \\approx 8.365 \\, \\text{MeV}\n$$\n这些是通过此截断 EOM-CCSD 计算得到的近似激发能。",
            "answer": "[5.835, 8.365]"
        },
        {
            "introduction": "EOM-CC 方法之所以能成为多体物理学中的前沿方法，其激发能的尺度展示性 (size-intensivity) 是一个关键特性。这个动手编程练习将指导你完成一个数值实验，以验证对于非相互作用体系，这一基本性质是成立的 。这个练习将巩固你对 EOM-CC 方法为何能在大组合体系中得到物理上一致结果的理解，这对于实际的原子核计算至关重要。",
            "id": "3557984",
            "problem": "设计并实现一个完整的、可运行的程序，通过比较孤立子系统 $\\,A\\,$ 的激发能 $\\,\\omega\\,$ 与从无相互作用的复合体系 $\\,A+B\\,$ 中提取的激发能，来数值验证运动方程耦合簇单双激发 (EOM-CCSD) 激发能的尺寸集约性。该实验必须使用相似性变换后的哈密顿量 $\\,\\bar{H} = e^{-T} H e^{T}\\,$ 以及与无相互作用子系统一致的块对角（直和）复合体系哈密顿量。\n\n从以下基本概念和定义开始：\n- 耦合簇基态由簇算符 $\\,T\\,$ 构建，形式为 $\\,\\lvert \\Psi_0 \\rangle = e^{T} \\lvert \\Phi_0 \\rangle\\,$，其中 $\\,\\lvert \\Phi_0 \\rangle\\,$ 是一个参考态（相对于激发的真空态）。相似性变换后的哈密顿量为 $\\,\\bar{H} = e^{-T} H e^{T}\\,$.\n- 正规排序的相似性变换哈密顿量为 $\\,\\bar{H}_N = \\bar{H} - E_{\\mathrm{CC}}\\mathbb{1}\\,$，其中 $\\,E_{\\mathrm{CC}} = \\langle \\Phi_0 \\lvert \\bar{H} \\rvert \\Phi_0 \\rangle\\,$ 是耦合簇基态能量。\n- 粒子数守恒激发的运动方程 (EOM) 本征问题是 $\\,\\bar{H}_N R \\lvert \\Phi_0 \\rangle = \\omega \\, R \\lvert \\Phi_0 \\rangle\\,$，并投影到选定的激发流形中。本征值 $\\,\\omega\\,$ 是激发能。对于具有块对角哈密顿量的无相互作用子系统 $\\,A\\,$ 和 $\\,B\\,$，尺寸集约性意味着，无论是单独为 $\\,A\\,$ 计算，还是为复合体系 $\\,A+B\\,$ 计算，局域在 $\\,A\\,$ 上的激发都具有相同的 $\\,\\omega\\,$.\n\n待实现的模型和数值方案：\n1. 每个子系统 $\\,X \\in \\{A,B\\}\\,$ 是一个两态多体模型，其基为 $\\,\\{\\lvert \\Phi_X \\rangle,\\lvert D_X \\rangle\\}\\,$，其中 $\\,\\lvert \\Phi_X \\rangle\\,$ 是参考行列式，$\\,\\lvert D_X \\rangle\\,$ 代表一个类 $\\,2p\\text{–}2h\\,$ 的激发组态。$\\,X\\,$ 的哈密顿量是一个 $\\,2\\times 2\\,$ 矩阵\n   $$ H_X = \\begin{pmatrix} E_X^{(0)}  V_X \\\\ V_X  E_X^{(d)} \\end{pmatrix}, $$\n   参数 $\\,E_X^{(0)}\\,$, $\\,E_X^{(d)}\\,$, 和 $\\,V_X\\,$ 的单位为兆电子伏特 (MeV)。\n2. 复合无相互作用哈密顿量为\n   $$ H_{A+B} = H_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes H_B, $$\n   作用于张量积基 $\\,\\{\\lvert \\Phi_A \\rangle,\\lvert D_A \\rangle\\} \\otimes \\{\\lvert \\Phi_B \\rangle,\\lvert D_B \\rangle\\}.$\n3. 对于每个 $\\,X \\in \\{A,B\\}\\,$，构建一个只在 $\\,X\\,$ 内部激发的单双激发簇算符：\n   $$ T_X = t_X \\,\\lvert D_X \\rangle \\langle \\Phi_X \\rvert, $$\n   使得 $\\,T_X^2 = 0\\,$ 且 $\\,e^{T_X} = \\mathbb{1}_X + T_X\\,$. 通过施加耦合簇基态条件 $\\,e^{T_X} \\lvert \\Phi_X \\rangle \\propto \\lvert \\Psi_{0,X} \\rangle\\,$ 来确定 $\\,t_X\\,$，其中 $\\,\\lvert \\Psi_{0,X} \\rangle\\,$ 是 $\\,H_X\\,$ 的归一化基态本征向量。对于复合体系，使用\n   $$ T_{A+B} = T_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes T_B, $$\n   该算符满足 $\\,T_{A+B}^3 = 0\\,$ 和\n   $$ e^{T_{A+B}} = \\mathbb{1} + T_{A+B} + \\tfrac{1}{2} T_{A+B}^2. $$\n4. 构建相似性变换后的哈密顿量\n   $$ \\bar{H}_A = e^{-T_A} H_A e^{T_A}, \\quad \\bar{H}_{A+B} = e^{-T_{A+B}} H_{A+B} e^{T_{A+B}}, $$\n   以及相应的正规排序算符\n   $$ \\bar{H}_{N,A} = \\bar{H}_A - E_{\\mathrm{CC},A}\\,\\mathbb{1}_A, \\quad \\bar{H}_{N,A+B} = \\bar{H}_{A+B} - E_{\\mathrm{CC},A+B}\\,\\mathbb{1}, $$\n   其中 $\\,E_{\\mathrm{CC},A} = \\langle \\Phi_A \\lvert \\bar{H}_A \\rvert \\Phi_A \\rangle\\,$ 且 $\\,E_{\\mathrm{CC},A+B} = \\langle \\Phi_A \\Phi_B \\lvert \\bar{H}_{A+B} \\rvert \\Phi_A \\Phi_B \\rangle\\,$.\n5. 提取局域在 $\\,A\\,$ 上的 EOM 激发能：\n   - 孤立的 $\\,A\\,$：将 $\\,\\bar{H}_{N,A}\\,$ 投影到 $\\,\\lvert D_A \\rangle\\,$ 上，并设 $\\,\\omega_A^{\\text{(iso)}} = \\langle D_A \\lvert \\bar{H}_{N,A} \\rvert D_A \\rangle\\,$.\n   - 复合体系 $\\,A+B\\,$：将 $\\,\\bar{H}_{N,A+B}\\,$ 投影到 $\\,\\lvert D_A \\rangle \\otimes \\lvert \\Phi_B \\rangle\\,$ 上，并设 $\\,\\omega_A^{(A+B)} = \\langle D_A \\Phi_B \\lvert \\bar{H}_{N,A+B} \\rvert D_A \\Phi_B \\rangle\\,$.\n6. 对于下面的每个测试用例，计算绝对差\n   $$ \\Delta \\omega_A = \\left| \\omega_A^{\\text{(iso)}} - \\omega_A^{(A+B)} \\right| \\quad \\text{单位为 MeV}. $$\n\n测试套件（所有能量和耦合单位均为 MeV；将输出指定为 MeV 的十进制浮点数）：\n- 用例 $\\,1\\,$（一般情况，非平凡耦合）：\n  - $\\,A\\,$: $\\,E_A^{(0)} = 0.0\\,$, $\\,E_A^{(d)} = 4.0\\,$, $\\,V_A = 0.5\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = -1.0\\,$, $\\,E_B^{(d)} = 3.5\\,$, $\\,V_B = 0.1\\,$.\n- 用例 $\\,2\\,$（边缘情况：A 中无耦合，B 中强耦合）：\n  - $\\,A\\,$: $\\,E_A^{(0)} = 0.0\\,$, $\\,E_A^{(d)} = 4.0\\,$, $\\,V_A = 0.0\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = 2.0\\,$, $\\,E_B^{(d)} = 5.0\\,$, $\\,V_B = 0.8\\,$.\n- 用例 $\\,3\\,$（A 中近简并，B 中中等耦合）：\n  - $\\,A\\,$: $\\,E_A^{(0)} = 0.0\\,$, $\\,E_A^{(d)} = 2.0\\,$, $\\,V_A = 0.7\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = -3.0\\,$, $\\,E_B^{(d)} = 1.0\\,$, $\\,V_B = 0.2\\,$.\n- 用例 $\\,4\\,$（B 中有大的能量偏移）：\n  - $\\,A\\,$: $\\,E_A^{(0)} = 1.0\\,$, $\\,E_A^{(d)} = 6.0\\,$, $\\,V_A = 0.3\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = 10.0\\,$, $\\,E_B^{(d)} = 12.0\\,$, $\\,V_B = 0.4\\,$.\n\n程序要求：\n- 通过对 $\\,X \\in \\{A,B\\}\\,$ 施加 $\\,e^{T_X} \\lvert \\Phi_X \\rangle\\,$ 等于 $\\,H_X\\,$ 的归一化基态本征向量的条件，来实现 $\\,T_A\\,$ 和 $\\,T_B\\,$ 的构建。\n- 使用幂零簇算符的精确有限级数来计算 $\\,e^{\\pm T_X}\\,$ 和 $\\,e^{\\pm T_{A+B}}\\,$.\n- 对于四个用例中的每一个，计算 $\\,\\Delta \\omega_A\\,$（单位为 MeV）。\n- 最终输出格式：您的程序应生成单行结果，格式为包含在方括号中的逗号分隔列表，例如 $\\,\\big[\\Delta\\omega_A^{(1)},\\Delta\\omega_A^{(2)},\\Delta\\omega_A^{(3)},\\Delta\\omega_A^{(4)}\\big]\\,$. 将每个条目表示为 MeV 单位的十进制浮点数，采用计算的自然精度（输出中不含单位符号）。",
            "solution": "该问题在运动方程耦合簇 (EOM-CC) 理论的框架内，提出了一个定义明确、具有科学依据的计算任务，用以数值验证 EOM-CC 激发能对于无相互作用子系统的尺寸集约性（size-intensivity）。所有必要的定义、参数和一个清晰的方案都已提供。\n\n问题的核心是计算子系统 A 在两种情况下的激发能 $\\omega_A$：（1）对于孤立系统 A，以及（2）对于无相互作用的复合系统 A+B。尺寸集约性要求这两种能量是相同的。我们将以数值方式实现指定的方案来验证此性质。\n\n我们将子系统 $X \\in \\{A, B\\}$ 的基态表示为向量：$\\lvert \\Phi_X \\rangle \\equiv \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\lvert D_X \\rangle \\equiv \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。子系统 X 的哈密顿量则为 $2 \\times 2$ 矩阵：\n$$\nH_X = \\begin{pmatrix} E_X^{(0)}  V_X \\\\ V_X  E_X^{(d)} \\end{pmatrix}\n$$\n簇算符由 $T_X = t_X \\lvert D_X \\rangle \\langle \\Phi_X \\rvert$ 给出，其矩阵形式为：\n$$\nT_X = \\begin{pmatrix} 0  0 \\\\ t_X  0 \\end{pmatrix}\n$$\n该算符是幂零的，即 $T_X^2 = 0$。因此，簇算符的指数级数精确截断：$e^{T_X} = \\mathbb{1}_X + T_X$。\n\n一个关键步骤是确定簇振幅 $t_X$。问题指定 $e^{T_X} \\lvert \\Phi_X \\rangle$ 应与 $H_X$ 的真实基态本征向量成正比。我们通过数值对角化找到 $H_X$ 的基态本征向量 $\\lvert \\Psi_{0,X} \\rangle = c_0 \\lvert \\Phi_X \\rangle + c_d \\lvert D_X \\rangle$。由此，我们推断出振幅 $t_X = c_d/c_0$。\n\n在确定 $t_X$ 后，我们计算孤立系统 A 的激发能。我们构建相似性变换后的哈密顿量 $\\bar{H}_A = e^{-T_A} H_A e^{T_A}$，计算耦合簇基态能量 $E_{\\mathrm{CC},A} = \\langle \\Phi_A \\lvert \\bar{H}_A \\rvert \\Phi_A \\rangle$，并构建正规排序哈密顿量 $\\bar{H}_{N,A} = \\bar{H}_A - E_{\\mathrm{CC},A}\\mathbb{1}_A$。激发能则由 $\\omega_A^{\\text{(iso)}} = \\langle D_A \\lvert \\bar{H}_{N,A} \\rvert D_A \\rangle$ 给出。\n\n接下来，我们分析复合系统 A+B。复合哈密顿量是 $H_{A+B} = H_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes H_B$。复合簇算符是 $T_{A+B} = T_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes T_B$。由于子系统不相互作用，相似性变换后的哈密顿量保持了可加结构：\n$$\n\\bar{H}_{A+B} = \\bar{H}_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes \\bar{H}_B\n$$\n复合 CC 能量为 $E_{\\mathrm{CC},A+B} = E_{\\mathrm{CC},A} + E_{\\mathrm{CC},B}$，这证实了 CC 基态能量的大小广延性。\n局域在 A 上的激发能是 $\\omega_A^{(A+B)} = \\langle D_A \\Phi_B \\lvert \\bar{H}_{N,A+B} \\rvert D_A \\Phi_B \\rangle$。展开后可以证明：\n$$\n\\omega_A^{(A+B)} = \\langle D_A|\\bar{H}_A|D_A\\rangle - E_{\\mathrm{CC},A} = \\omega_A^{\\text{(iso)}}\n$$\n因此，我们预期在所有情况下 $\\Delta \\omega_A = \\left| \\omega_A^{\\text{(iso)}} - \\omega_A^{(A+B)} \\right|$ 在数值精度范围内等于 0。以下代码将通过完整的数值方案来验证这一理论结果。",
            "answer": "```python\nimport numpy as np\n\ndef get_t_amplitude(H):\n    \"\"\"\n    Calculates the cluster amplitude t for a 2x2 subsystem Hamiltonian.\n\n    The amplitude t is determined from the ground state eigenvector [c0, c_d]\n    as t = c_d / c_0.\n\n    Args:\n        H (np.ndarray): The 2x2 subsystem Hamiltonian matrix.\n\n    Returns:\n        float: The cluster amplitude t.\n    \"\"\"\n    # Check for the non-interacting case\n    if np.isclose(H[0, 1], 0.0):\n        # If uncoupled, ground state is the reference if E0  Ed\n        if H[0, 0]  H[1, 1]:\n            return 0.0\n        else: # Ground state is the excited state, c0=0, t is infinite.\n              # This scenario is not expected in the test cases provided.\n            return np.inf\n\n    eigvals, eigvecs = np.linalg.eigh(H)\n    \n    # Find the ground state (lowest eigenvalue)\n    gs_index = np.argmin(eigvals)\n    gs_eigenvector = eigvecs[:, gs_index]\n    \n    c0, c_d = gs_eigenvector[0], gs_eigenvector[1]\n\n    if np.isclose(c0, 0.0):\n        raise ValueError(\"c0 component of ground state is zero; t-amplitude is undefined.\")\n\n    return c_d / c0\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general, nontrivial couplings)\n        {'A': {'E0': 0.0, 'Ed': 4.0, 'V': 0.5}, 'B': {'E0': -1.0, 'Ed': 3.5, 'V': 0.1}},\n        # Case 2 (edge: no coupling in A, strong in B)\n        {'A': {'E0': 0.0, 'Ed': 4.0, 'V': 0.0}, 'B': {'E0': 2.0, 'Ed': 5.0, 'V': 0.8}},\n        # Case 3 (near-degeneracy in A, moderate in B)\n        {'A': {'E0': 0.0, 'Ed': 2.0, 'V': 0.7}, 'B': {'E0': -3.0, 'Ed': 1.0, 'V': 0.2}},\n        # Case 4 (large energy offset in B)\n        {'A': {'E0': 1.0, 'Ed': 6.0, 'V': 0.3}, 'B': {'E0': 10.0, 'Ed': 12.0, 'V': 0.4}},\n    ]\n    \n    results = []\n    \n    # Identity matrices of size 2 and 4\n    I2 = np.identity(2)\n    I4 = np.identity(4)\n\n    for case in test_cases:\n        params_A = case['A']\n        params_B = case['B']\n        \n        # --- Isolated System A ---\n        \n        H_A = np.array([[params_A['E0'], params_A['V']], \n                        [params_A['V'], params_A['Ed']]])\n        \n        t_A = get_t_amplitude(H_A)\n        \n        T_A = np.array([[0.0, 0.0], [t_A, 0.0]])\n        \n        exp_T_A = I2 + T_A\n        exp_neg_T_A = I2 - T_A\n        \n        Hbar_A = exp_neg_T_A @ H_A @ exp_T_A\n        \n        E_cc_A = Hbar_A[0, 0]\n        \n        Hbar_N_A = Hbar_A - E_cc_A * I2\n        \n        omega_iso_A = Hbar_N_A[1, 1]\n\n        # --- Composite System A+B ---\n        \n        H_B = np.array([[params_B['E0'], params_B['V']], \n                        [params_B['V'], params_B['Ed']]])\n                        \n        t_B = get_t_amplitude(H_B)\n        \n        T_B = np.array([[0.0, 0.0], [t_B, 0.0]])\n        \n        # Build composite operators using tensor products (np.kron)\n        H_AB = np.kron(H_A, I2) + np.kron(I2, H_B)\n        \n        T_AB = np.kron(T_A, I2) + np.kron(I2, T_B)\n        \n        # Since T_A^2 = 0 and T_B^2 = 0, it follows that T_{A+B}^3 = 0.\n        # e^{T} = 1 + T + T^2/2\n        # T_{A+B}^2 = 2 * (T_A kron T_B)\n        T_AB_sq = 2 * np.kron(T_A, T_B)\n        \n        exp_T_AB = I4 + T_AB + 0.5 * T_AB_sq\n        exp_neg_T_AB = I4 - T_AB + 0.5 * T_AB_sq\n        \n        Hbar_AB = exp_neg_T_AB @ H_AB @ exp_T_AB\n        \n        # Reference state |Phi_A Phi_B> corresponds to vector [1,0,0,0]\n        E_cc_AB = Hbar_AB[0, 0]\n        \n        Hbar_N_AB = Hbar_AB - E_cc_AB * I4\n        \n        # Excited state |D_A Phi_B> corresponds to vector [0,0,1,0]\n        omega_comp_A = Hbar_N_AB[2, 2]\n        \n        # --- Calculate the difference ---\n        \n        delta_omega_A = abs(omega_iso_A - omega_comp_A)\n        results.append(delta_omega_A)\n        \n    # Print final results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "EOM-CC 方法的威力源于其非厄米框架，但这也带来了独特的挑战。本练习探讨了作为非厄米问题标志的左右本征矢量间双正交性的后果 。通过计算 Petermann 因子，你将学会识别可能导致数值不稳定性和物理可观测量预测灵敏度增强的近简并态。",
            "id": "3558048",
            "problem": "给定一个源于计算核物理中运动方程耦合簇 (EOM-CC) 方法的非厄米本征值问题。在 EOM-CC 中，相似变换后的哈密顿量定义为 $\\bar{H} = e^{-T} H e^{T}$，其中 $T$ 是来自耦合簇 (CC) 理论的簇算符，$H$ 是核多体哈密顿量。相似变换算符 $\\bar{H}$ 是非厄米的，因此其右本征矢和左本征矢（分别记为 $R_i$ 和 $L_i$）满足不同的本征方程：\n$$\n\\bar{H} R_i = \\omega_i R_i, \\quad L_i^{\\top} \\bar{H} = \\omega_i L_i^{\\top}.\n$$\n对于给定的态 $i$，当 $L_i$ 和 $R_i$ 被独立地归一化到单位范数时，Petermann 因子定义为 $K_i = (L_i^{\\top} R_i)^{-1}$。在非厄米系统中，较大的 $K_i$ 值表示强的双正交性，并且已知与可观测量灵敏度的增强以及在近简并（几乎亏损）的本征态附近的数值不稳定性相关。考虑一个 $2 \\times 2$ 实矩阵族，它模拟了一个约化空间中的相似变换哈密顿量，\n$$\n\\bar{H}(\\delta) = \\begin{pmatrix} \\lambda  g \\\\ \\delta  \\lambda \\end{pmatrix},\n$$\n其中 $\\lambda$、$g$ 和 $\\delta$ 是实数参数。对于所有测试用例，取 $\\lambda = 0$ 和 $g = 1$。定义一个固定的跃迁算符\n$$\nO = \\begin{pmatrix} 0  1 \\\\ \\alpha  0 \\end{pmatrix},\n$$\n其中 $\\alpha = 0.3$。对每个测试用例，执行以下步骤：\n- 计算 $\\bar{H}(\\delta)$ 的右本征对 $(\\omega_i, R_i)$。\n- 从 $\\bar{H}(\\delta)^{\\top}$ 计算左本征对 $(\\omega_i, L_i)$，并将每个左本征矢 $L_i$ 与具有最接近本征值 $\\omega_i$ 的右本征矢 $R_i$ 匹配（通过最小本征值绝对差进行匹配）。\n- 将所有 $R_i$ 和 $L_i$ 归一化到单位矢量范数。\n- 对所有态 $i$ 计算 Petermann 因子 $K_i = (L_i^{\\top} R_i)^{-1}$，并通过取 $\\max_i |K_i|$ 来汇总结果。\n- 定义较低和较高本征态之间的未受扰跃迁强度为\n$$\nS = \\big| L_{j}^{\\top} O R_{i} \\big|^2,\n$$\n其中 $i$ 索引较低本征值的态，$j$ 索引较高本征值的态。\n- 对哈密顿量参数施加一个大小为 $\\epsilon$ 的小微扰，得到\n$$\n\\bar{H}'(\\delta, \\epsilon) = \\begin{pmatrix} \\lambda  g - \\epsilon \\\\ \\delta + \\epsilon  \\lambda \\end{pmatrix},\n$$\n重新计算左、右本征矢以及受扰跃迁强度 $S'$。计算相对变化\n$$\nr = \\frac{|S' - S|}{\\max(S, 10^{-16})},\n$$\n使用一个小的正则化项 $10^{-16}$ 以避免除以零。\n\n你的程序必须为每个测试用例计算数对 $[\\max_i |K_i|, r]$，并将所有测试用例的结果汇总到单行输出中，格式为一个逗号分隔的 Python 风格列表的列表。不使用任何物理单位，因为所有量都是无量纲的。不出现角度。所有输出都必须是实值浮点数。\n\n测试套件：\n- 情况 1（正常路径，中等非厄米性）：$\\delta = 0.5$, $\\epsilon = 10^{-6}$。\n- 情况 2（近简并本征值，强非厄米性）：$\\delta = 10^{-12}$, $\\epsilon = 10^{-6}$。\n- 情况 3（厄米边界情况）：$\\delta = 1.0$, $\\epsilon = 10^{-6}$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例贡献一个列表 $[\\max_i |K_i|, r]$，因此最终输出必须看起来像\n$$\n[[k_1, r_1],[k_2, r_2],[k_3, r_3]]\n$$\n其中每个 $k_n$ 和 $r_n$ 都是浮点数。",
            "solution": "该问题旨在通过数值计算，探索 EOM-CC 方法中非厄米哈密顿量的两个重要后果：双正交性和对微扰的敏感性。我们将针对一个简化的 $2 \\times 2$ 非厄米哈密顿量 $\\bar{H}(\\delta)$ 来执行此分析。\n\n**步骤 1：定义矩阵**\n我们首先根据问题描述，为每个测试用例设置未受扰的哈密顿量 $\\bar{H}(\\delta)$ 和跃迁算符 $O$。\n$$\n\\bar{H}(\\delta) = \\begin{pmatrix} 0  1 \\\\ \\delta  0 \\end{pmatrix}, \\quad O = \\begin{pmatrix} 0  1 \\\\ 0.3  0 \\end{pmatrix}\n$$\n\n**步骤 2：求解未受扰的本征问题**\n我们分别求解 $\\bar{H}$ 的右本征问题（$\\bar{H} R_i = \\omega_i R_i$）和左本征问题（通过求解其转置矩阵 $\\bar{H}^{\\top}$ 的右本征问题获得，$L_i^{\\top} \\bar{H} = \\omega_i L_i^{\\top}$）。为了确保左右本征矢的正确配对，我们根据本征值的实部对它们进行排序。\n\n**步骤 3：计算 Petermann 因子**\n我们将所有本征矢 $R_i$ 和 $L_i$ 归一化为单位范数。然后，我们计算 Petermann 因子 $K_i = (L_i^{\\top} R_i)^{-1}$。问题的第一个输出值是 $\\max_i |K_i|$。\n\n**步骤 4：计算未受扰的跃迁强度**\n我们计算较低能态（索引为0）和较高能态（索引为1）之间的跃迁强度 $S = |L_1^{\\top} O R_0|^2$。\n\n**步骤 5：分析受扰系统**\n我们引入一个小的微扰 $\\epsilon$，构建受扰哈密顿量 $\\bar{H}'(\\delta, \\epsilon)$：\n$$\n\\bar{H}'(\\delta, \\epsilon) = \\begin{pmatrix} 0  1 - \\epsilon \\\\ \\delta + \\epsilon  0 \\end{pmatrix}\n$$\n然后，我们重复步骤 2-4，计算受扰系统的左右本征矢 $R'_i, L'_i$ 和新的跃迁强度 $S' = |(L'_1)^{\\top} O R'_0|^2$。\n\n**步骤 6：计算相对变化**\n最后，我们计算跃迁强度的相对变化 $r = \\frac{|S' - S|}{\\max(S, 10^{-16})}$，其中分母中的小项用于防止除以零。\n\n通过比较不同 $\\delta$ 值下的 Petermann 因子和跃迁强度变化，我们可以观察到当 $\\delta \\to g$（厄米极限，$\\delta \\to 1$）时，双正交性减弱（$K \\to 1$），系统对微扰不敏感。而当 $\\delta \\to 0$（近简并或亏损点），双正交性极强（$K \\to \\infty$），系统对微扰异常敏感。",
            "answer": "```python\nimport numpy as np\n\ndef calculate_pair(delta, epsilon):\n    \"\"\"\n    Computes the pair [max|Ki|, r] for a given delta and epsilon.\n    \"\"\"\n    # Define fixed parameters\n    lam = 0.0\n    g = 1.0\n    alpha = 0.3\n    \n    # Define the transition operator O\n    O_op = np.array([[0.0, 1.0], [alpha, 0.0]])\n\n    # ---- 1. Unperturbed System Analysis ----\n    \n    H = np.array([[lam, g], [delta, lam]])\n    \n    # Compute and sort right eigenvectors\n    w_r, R = np.linalg.eig(H)\n    sort_idx_r = np.argsort(np.real(w_r))\n    w_r = w_r[sort_idx_r]\n    R = R[:, sort_idx_r]\n    \n    # Compute and sort left eigenvectors\n    w_l, L_T = np.linalg.eig(H.T)\n    L = L_T\n    sort_idx_l = np.argsort(np.real(w_l))\n    w_l = w_l[sort_idx_l]\n    L = L[:, sort_idx_l]\n    \n    # Normalize eigenvectors\n    R0_norm = R[:, 0] / np.linalg.norm(R[:, 0])\n    R1_norm = R[:, 1] / np.linalg.norm(R[:, 1])\n    L0_norm = L[:, 0] / np.linalg.norm(L[:, 0])\n    L1_norm = L[:, 1] / np.linalg.norm(L[:, 1])\n    \n    # Compute Petermann factors\n    K0 = 1.0 / np.dot(L0_norm, R0_norm)\n    K1 = 1.0 / np.dot(L1_norm, R1_norm)\n    max_K = max(abs(K0), abs(K1))\n    \n    # Compute unperturbed transition strength S\n    # The problem describes transition between lower and higher states.\n    S = np.abs(np.dot(L1_norm, O_op @ R0_norm))**2\n    \n    # ---- 2. Perturbed System Analysis ----\n    \n    H_prime = np.array([[lam, g - epsilon], [delta + epsilon, lam]])\n    \n    w_r_p, R_p = np.linalg.eig(H_prime)\n    sort_idx_r_p = np.argsort(np.real(w_r_p))\n    R_p = R_p[:, sort_idx_r_p]\n\n    w_l_p, L_T_p = np.linalg.eig(H_prime.T)\n    L_p = L_T_p\n    sort_idx_l_p = np.argsort(np.real(w_l_p))\n    L_p = L_p[:, sort_idx_l_p]\n    \n    R0_p_norm = R_p[:, 0] / np.linalg.norm(R_p[:, 0])\n    R1_p_norm = R_p[:, 1] / np.linalg.norm(R_p[:, 1])\n    L0_p_norm = L_p[:, 0] / np.linalg.norm(L_p[:, 0])\n    L1_p_norm = L_p[:, 1] / np.linalg.norm(L_p[:, 1])\n    \n    S_prime = np.abs(np.dot(L1_p_norm, O_op @ R0_p_norm))**2\n    \n    # ---- 3. Compute Relative Change ----\n    \n    r = np.abs(S_prime - S) / max(S, 1e-16)\n    \n    return [max_K, r]\n\ndef solve_all():\n    \"\"\"\n    Runs all test cases and prints the results in the required format.\n    \"\"\"\n    test_cases = [\n        {'delta': 0.5, 'epsilon': 1e-6},\n        {'delta': 1e-12, 'epsilon': 1e-6},\n        {'delta': 1.0, 'epsilon': 1e-6},\n    ]\n    \n    all_results = []\n    for case in test_cases:\n        result = calculate_pair(case['delta'], case['epsilon'])\n        all_results.append(result)\n\n    print(all_results)\n\nif __name__ == '__main__':\n    solve_all()\n```"
        }
    ]
}