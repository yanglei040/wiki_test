{
    "hands_on_practices": [
        {
            "introduction": "The astrophysical S-factor, $S(E)$, is a construct designed to factor out the strong energy dependencies from a charged-particle reaction cross-section, $\\sigma(E)$. While $S(E)$ is convenient for theoretical modeling and extrapolation, the cross-section is the quantity directly related to experimental observables. This first exercise provides a foundational practice in converting between these two quantities, reinforcing the role of the Sommerfeld parameter and ensuring fluency with the units commonly used in nuclear astrophysics. ",
            "id": "3542503",
            "problem": "A non-resonant, charged-particle radiative capture reaction between a proton and a carbon-12 nucleus is studied at a center-of-mass (CM) energy of $E = 100\\,\\mathrm{keV}$. The measured astrophysical $S$-factor at this energy is quoted as $S(E) = 25\\,\\mathrm{keV\\cdot barn}$. The proton and carbon-12 carry charges $Z_{1} = 1$ and $Z_{2} = 6$, respectively. Assume non-relativistic kinematics and that the astrophysical $S$-factor is defined as the smooth part of the charged-particle cross section once the known Coulomb barrier penetration factor and the kinematic $1/E$ scaling have been factored out. Using the non-relativistic expression for the Sommerfeld parameter, the relative speed $v$ at CM energy $E$, and the reduced mass $\\mu$ of the two-body system, determine the reaction cross section $\\sigma(E)$ at $E=100\\,\\mathrm{keV}$.\n\nUse the following constants and conversions, all in the International System of Units (SI):\n- Fine-structure constant $\\alpha = 7.297\\,352\\,5693\\times 10^{-3}$.\n- Speed of light $c = 2.997\\,924\\,58\\times 10^{8}\\,\\mathrm{m/s}$.\n- Proton mass $m_{p} = 1.672\\,621\\,92369\\times 10^{-27}\\,\\mathrm{kg}$.\n- Atomic mass unit $u = 1.660\\,539\\,06660\\times 10^{-27}\\,\\mathrm{kg}$; approximate the carbon-12 nuclear mass as $m_{C} \\approx 12\\,u$.\n- $1\\,\\mathrm{eV} = 1.602\\,176\\,634\\times 10^{-19}\\,\\mathrm{J}$.\n- $1\\,\\mathrm{barn} = 1.0\\times 10^{-28}\\,\\mathrm{m^{2}}$.\n\nInstructions:\n1. Convert the quoted $S(E)$ from $\\mathrm{keV\\cdot barn}$ to $\\mathrm{J\\cdot m^{2}}$.\n2. Starting from first principles, use the non-relativistic Sommerfeld parameter $\\eta$ for two nuclei with charges $Z_{1}$ and $Z_{2}$, the relation between relative speed $v$ and CM energy $E$, and the definition of the astrophysical $S$-factor as the factor that removes the Coulomb barrier penetration and the kinematic $1/E$ scaling from the cross section, derive an expression that allows you to compute $\\sigma(E)$ from $S(E)$, $E$, and $\\eta$.\n3. Evaluate $\\sigma(E)$ numerically for the parameters above.\n\nExpress your final cross section in square meters and round your answer to four significant figures.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, and objective, containing all necessary information to compute a unique and meaningful solution.\n\nThe problem requires the calculation of the reaction cross section, $\\sigma(E)$, for a non-resonant charged-particle reaction given the astrophysical $S$-factor, $S(E)$, at a specific center-of-mass energy, $E$. The relationship between these quantities is defined by factoring out the strong energy dependence from the cross section, which arises from two main sources: the $1/E$ kinematic factor related to the de Broglie wavelength, and the Coulomb barrier penetration probability.\n\nThe definition of the astrophysical $S$-factor is given by:\n$$\n\\sigma(E) = \\frac{S(E)}{E} \\exp(-2\\pi\\eta)\n$$\nwhere $\\eta$ is the dimensionless Sommerfeld parameter. This exponential term is the dominant part of the Gamow factor for s-wave reactions at low energies and accounts for the probability of two charged nuclei tunneling through their electrostatic repulsion.\n\nThe non-relativistic Sommerfeld parameter, $\\eta$, is defined as:\n$$\n\\eta = \\frac{Z_1 Z_2 e^2}{4\\pi\\epsilon_0 \\hbar v}\n$$\nwhere $Z_1$ and $Z_2$ are the charge numbers of the interacting nuclei, $e$ is the elementary charge, $\\epsilon_0$ is the vacuum permittivity, $\\hbar$ is the reduced Planck constant, and $v$ is the relative speed of the particles. Using the fine-structure constant, $\\alpha = \\frac{e^2}{4\\pi\\epsilon_0 \\hbar c}$, this expression can be written more conveniently as:\n$$\n\\eta = Z_1 Z_2 \\alpha \\frac{c}{v}\n$$\nThe relative speed $v$ is related to the center-of-mass energy $E$ through the non-relativistic relation for kinetic energy, $E = \\frac{1}{2}\\mu v^2$, where $\\mu$ is the reduced mass of the two-body system. Therefore, $v = \\sqrt{\\frac{2E}{\\mu}}$. Substituting this into the expression for $\\eta$ gives:\n$$\n\\eta = Z_1 Z_2 \\alpha c \\sqrt{\\frac{\\mu}{2E}}\n$$\nWe will now proceed with the calculation in a step-by-step manner, as requested. All calculations will be performed in SI units.\n\n**Step 1: Convert given quantities to SI units**\n\nThe center-of-mass energy is $E = 100\\,\\mathrm{keV}$:\n$$\nE = 100 \\times 10^3\\,\\mathrm{eV} \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 1.602\\,176\\,634 \\times 10^{-14}\\,\\mathrm{J}\n$$\nThe astrophysical $S$-factor is $S(E) = 25\\,\\mathrm{keV\\cdot barn}$:\n$$\nS(E) = 25 \\times 10^3\\,\\mathrm{eV\\cdot barn} \\times (1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}) \\times (1.0 \\times 10^{-28}\\,\\mathrm{m^2/barn})\n$$\n$$\nS(E) = 4.005\\,441\\,585 \\times 10^{-43}\\,\\mathrm{J \\cdot m^2}\n$$\n\n**Step 2: Calculate the reduced mass $\\mu$**\n\nThe reduced mass $\\mu$ of the proton ($m_p$) and carbon-12 ($m_C$) system is given by $\\mu = \\frac{m_p m_C}{m_p + m_C}$.\nThe given masses are:\n$m_p = 1.672\\,621\\,92369 \\times 10^{-27}\\,\\mathrm{kg}$.\n$u = 1.660\\,539\\,06660 \\times 10^{-27}\\,\\mathrm{kg}$.\nWe are to approximate the carbon-12 mass as $m_C \\approx 12 u$:\n$$\nm_C \\approx 12 \\times (1.660\\,539\\,06660 \\times 10^{-27}\\,\\mathrm{kg}) = 1.992\\,646\\,87992 \\times 10^{-26}\\,\\mathrm{kg}\n$$\nNow, we calculate the reduced mass:\n$$\n\\mu = \\frac{(1.672\\,621\\,92369 \\times 10^{-27}\\,\\mathrm{kg}) \\times (1.992\\,646\\,87992 \\times 10^{-26}\\,\\mathrm{kg})}{(1.672\\,621\\,92369 \\times 10^{-27}\\,\\mathrm{kg}) + (1.992\\,646\\,87992 \\times 10^{-26}\\,\\mathrm{kg})}\n$$\n$$\n\\mu = \\frac{3.332\\,350\\,00 \\times 10^{-53}\\,\\mathrm{kg^2}}{2.159\\,909\\,07 \\times 10^{-26}\\,\\mathrm{kg}} = 1.542\\,823\\,05 \\times 10^{-27}\\,\\mathrm{kg}\n$$\n\n**Step 3: Calculate the Sommerfeld parameter $\\eta$**\n\nWe use the formula $\\eta = Z_1 Z_2 \\alpha c \\sqrt{\\frac{\\mu}{2E}}$. The constants are:\nCharge numbers: $Z_1 = 1$, $Z_2 = 6$.\nFine-structure constant: $\\alpha = 7.297\\,352\\,5693 \\times 10^{-3}$.\nSpeed of light: $c = 2.997\\,924\\,58 \\times 10^{8}\\,\\mathrm{m/s}$.\n\nFirst, we calculate the term inside the square root:\n$$\n\\frac{\\mu}{2E} = \\frac{1.542\\,823\\,05 \\times 10^{-27}\\,\\mathrm{kg}}{2 \\times 1.602\\,176\\,634 \\times 10^{-14}\\,\\mathrm{J}} = 4.814\\,763\\,48 \\times 10^{-14}\\,\\mathrm{s^2/m^2}\n$$\nTaking the square root:\n$$\n\\sqrt{\\frac{\\mu}{2E}} = \\sqrt{4.814\\,763\\,48 \\times 10^{-14}\\,\\mathrm{s^2/m^2}} = 2.194\\,256\\,93 \\times 10^{-7}\\,\\mathrm{s/m}\n$$\nNow, we compute $\\eta$:\n$$\n\\eta = (1)(6) \\times (7.297\\,352\\,5693 \\times 10^{-3}) \\times (2.997\\,924\\,58 \\times 10^{8}\\,\\mathrm{m/s}) \\times (2.194\\,256\\,93 \\times 10^{-7}\\,\\mathrm{s/m})\n$$\n$$\n\\eta = 2.879\\,853\\,18\n$$\n\n**Step 4: Calculate the reaction cross section $\\sigma(E)$**\n\nWe use the defining equation $\\sigma(E) = \\frac{S(E)}{E} \\exp(-2\\pi\\eta)$.\nFirst, we compute the exponential term:\n$$\n2\\pi\\eta = 2\\pi \\times 2.879\\,853\\,18 = 18.094\\,536\\,7\n$$\n$$\n\\exp(-2\\pi\\eta) = \\exp(-18.094\\,536\\,7) = 1.385\\,510\\,5 \\times 10^{-8}\n$$\nAn alternative way to calculate the pre-factor $\\frac{S(E)}{E}$ is to use the given units directly:\n$$\n\\frac{S(E)}{E} = \\frac{25\\,\\mathrm{keV\\cdot barn}}{100\\,\\mathrm{keV}} = 0.25\\,\\mathrm{barn}\n$$\nConverting to SI units:\n$$\n0.25\\,\\mathrm{barn} = 0.25 \\times 1.0 \\times 10^{-28}\\,\\mathrm{m^2} = 2.5 \\times 10^{-29}\\,\\mathrm{m^2}\n$$\nNow, we can find the cross section $\\sigma(E)$:\n$$\n\\sigma(E) = (2.5 \\times 10^{-29}\\,\\mathrm{m^2}) \\times (1.385\\,510\\,5 \\times 10^{-8})\n$$\n$$\n\\sigma(E) = 3.463\\,776 \\times 10^{-37}\\,\\mathrm{m^2}\n$$\nFinally, rounding the result to four significant figures as instructed:\n$$\n\\sigma(E) \\approx 3.464 \\times 10^{-37}\\,\\mathrm{m^2}\n$$",
            "answer": "$$\n\\boxed{3.464 \\times 10^{-37}}\n$$"
        },
        {
            "introduction": "The ultimate astrophysical application of the S-factor is to compute the thermal reaction rate, $N_A \\langle \\sigma v \\rangle$, which determines the speed of nucleosynthesis in stellar environments. This rate involves averaging the cross-section over the Maxwell-Boltzmann distribution of particle energies, an integral dominated by the famous 'Gamow peak'. This exercise guides you through both a numerical integration and a powerful analytical technique, the saddle-point approximation, to compute this rate and assess the approximation's accuracy. ",
            "id": "3542550",
            "problem": "Consider a non-resonant charged-particle fusion reaction between two protons with charges $Z_1 = 1$ and $Z_2 = 1$ and reduced mass $\\mu = m_p/2$, where $m_p$ is the proton mass. The astrophysical $S$-factor is assumed constant, $S(E) = S_0$. The microscopic cross section is defined by the astrophysical $S$-factor relation $ \\sigma(E) = \\dfrac{S(E)}{E} \\exp(-2 \\pi \\eta) $, where the Sommerfeld parameter is $\\eta = \\dfrac{\\alpha Z_1 Z_2 c}{v}$, with $v = \\sqrt{2E/\\mu}$ the relative speed at center-of-mass kinetic energy $E$. Here $\\alpha$ is the fine-structure constant and $c$ is the speed of light. The Maxwellian-averaged reaction rate per particle pair is $ \\langle \\sigma v \\rangle = \\int \\sigma(v)\\, v\\, f_{\\text{MB}}(v;T)\\, d^3 v $, where $f_{\\text{MB}}(v;T)$ is the Maxwell–Boltzmann distribution at temperature $T$. Avogadro’s number is $N_A$. You will treat the reaction $p+p \\rightarrow d + e^+ + \\nu_e$ in the non-resonant, non-screened limit using the definitions above.\n\nYour tasks are:\n\n- Starting only from the definitions provided above for $ \\sigma(E) $, $\\eta$, $v(E)$, and the Maxwell–Boltzmann distribution (not from any pre-packaged “shortcut” rate formula), derive a one-dimensional integral over $E$ for $ \\langle \\sigma v \\rangle $ appropriate for non-resonant charged particles with constant $S(E)=S_0$. Then, using the method of steepest descent (saddle-point/Laplace approximation) applied to that integral, obtain an analytic asymptotic approximation for $ \\langle \\sigma v \\rangle $ when the integrand exhibits a Gamow peak. Your derived approximation must be expressed entirely in terms of $S_0$, $\\mu$, $k_B$, $T$, $\\alpha$, $c$, and fundamental constants that appear in the starting definitions. Do not introduce any empirical fit formulas; the derivation must follow from the provided fundamentals.\n\n- Implement two computations for $N_A \\langle \\sigma v \\rangle$:\n  1. A numerical evaluation of the $E$-integral you derived, performed in the International System of Units (SI) to yield $ \\langle \\sigma v \\rangle $ in $\\mathrm{m^3\\,s^{-1}}$, then multiplied by $N_A$ to obtain $N_A \\langle \\sigma v \\rangle$ in $\\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, and finally converted to $\\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$.\n  2. An evaluation of your saddle-point (steepest descent) approximation for the same quantity, again yielding $N_A \\langle \\sigma v \\rangle$ in $\\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$.\n\n- For each specified temperature, compute the relative error of the saddle-point approximation with respect to the numerical integral, defined as $ \\delta = \\dfrac{(N_A \\langle \\sigma v \\rangle)_{\\text{saddle}} - (N_A \\langle \\sigma v \\rangle)_{\\text{numeric}}}{(N_A \\langle \\sigma v \\rangle)_{\\text{numeric}}} $. Report $\\delta$ as a dimensionless decimal number (not a percentage).\n\nUse the following physical constants and unit conventions:\n- $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$.\n- $\\alpha = 7.2973525693 \\times 10^{-3}$.\n- $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s^{-1}}$.\n- $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$.\n- $m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$, hence $\\mu = m_p/2$ for $p+p$.\n- Adopt $S_0 = 4.01 \\times 10^{-22}\\ \\mathrm{keV\\,b}$ as a temperature-independent constant. Convert it to SI using $1\\ \\mathrm{eV} = 1.602176634 \\times 10^{-19}\\ \\mathrm{J}$ and $1\\ \\mathrm{b} = 10^{-28}\\ \\mathrm{m^2}$. Ensure that $S_0$ is used in $\\mathrm{J\\,m^2}$ in your integral.\n\nImplement your program to evaluate the relative error $\\delta$ for the following test-suite of temperatures (expressed in kelvin, all positive real numbers):\n- $T_1 = 5.0 \\times 10^{6}\\ \\mathrm{K}$ (lower, strong tunneling suppression),\n- $T_2 = 1.5 \\times 10^{7}\\ \\mathrm{K}$ (solar-core scale),\n- $T_3 = 3.0 \\times 10^{7}\\ \\mathrm{K}$ (higher, milder tunneling suppression),\n- $T_4 = 1.0 \\times 10^{8}\\ \\mathrm{K}$ (edge of constant-$S$ applicability for this channel, still non-resonant).\n\nNumerical requirements and guidance:\n- Perform the numerical integral directly over energy $E \\in [0,\\infty)$ using the one-dimensional form derived from the definitions. The integrand contains the exponential of the Maxwell–Boltzmann factor and the Gamow factor; it is finite and tends to zero as $E \\to 0^+$ and as $E \\to \\infty$. Ensure numerical stability near $E=0$.\n- All intermediate computations must be in SI units so that $ \\langle \\sigma v \\rangle $ is in $\\mathrm{m^3\\,s^{-1}}$ before multiplying by $N_A$ and converting to $\\mathrm{cm^3\\,mol^{-1}\\,s^{-1}}$ as needed for reporting and for the relative error. However, the final requested answer is the dimensionless list of $\\delta$ values as decimals.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[$\\delta_1,\\delta_2,\\delta_3,\\delta_4$]\"), where entries correspond to the temperatures in the same order as listed above. Each list element must be a floating-point number. No additional text should be printed.",
            "solution": "The user wants me to solve a problem in computational nuclear physics. I will first validate the problem and then provide a detailed solution.\n\n### Step 1: Extract Givens\n- **Reaction**: Non-resonant charged-particle fusion reaction $p+p \\rightarrow d + e^+ + \\nu_e$.\n- **Particle properties**: Charges $Z_1 = 1$, $Z_2 = 1$. Reduced mass $\\mu = m_p/2$, where $m_p$ is the proton mass.\n- **Astrophysical S-factor**: Assumed constant, $S(E) = S_0$.\n- **Microscopic cross section**: $\\sigma(E) = \\dfrac{S(E)}{E} \\exp(-2 \\pi \\eta)$.\n- **Sommerfeld parameter**: $\\eta = \\dfrac{\\alpha Z_1 Z_2 c}{v}$.\n- **Relative speed**: $v = \\sqrt{2E/\\mu}$ at center-of-mass kinetic energy $E$.\n- **Reaction rate per particle pair**: $\\langle \\sigma v \\rangle = \\int \\sigma(v)\\, v\\, f_{\\text{MB}}(v;T)\\, d^3 v$.\n- **Maxwell–Boltzmann distribution**: $f_{\\text{MB}}(v;T)$.\n- **Constants**:\n    - Avogadro's number: $N_A = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$.\n    - Fine-structure constant: $\\alpha = 7.2973525693 \\times 10^{-3}$.\n    - Speed of light: $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s^{-1}}$.\n    - Boltzmann constant: $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$.\n    - Proton mass: $m_p = 1.67262192369 \\times 10^{-27}\\ \\mathrm{kg}$.\n    - $S_0 = 4.01 \\times 10^{-22}\\ \\mathrm{keV\\,b}$.\n- **Unit conversions**:\n    - $1\\ \\mathrm{eV} = 1.602176634 \\times 10^{-19}\\ \\mathrm{J}$.\n    - $1\\ \\mathrm{b} = 10^{-28}\\ \\mathrm{m^2}$.\n- **Test cases**: Temperatures $T = [5.0 \\times 10^{6}, 1.5 \\times 10^{7}, 3.0 \\times 10^{7}, 1.0 \\times 10^{8}]\\ \\mathrm{K}$.\n- **Tasks**:\n    1. Derive a one-dimensional integral for $\\langle \\sigma v \\rangle$ over energy $E$.\n    2. Using the method of steepest descent, derive an analytic asymptotic approximation for $\\langle \\sigma v \\rangle$.\n    3. Implement a numerical computation of the integral for $N_A \\langle \\sigma v \\rangle$.\n    4. Implement a computation of the saddle-point approximation for $N_A \\langle \\sigma v \\rangle$.\n    5. For each temperature, compute the relative error $\\delta = \\dfrac{(N_A \\langle \\sigma v \\rangle)_{\\text{saddle}} - (N_A \\langle \\sigma v \\rangle)_{\\text{numeric}}}{(N_A \\langle \\sigma v \\rangle)_{\\text{numeric}}}$.\n- **Output format**: Single line, comma-separated list of $\\delta$ values in square brackets.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes the proton-proton fusion reaction, a fundamental process in stellar nucleosynthesis. The formulas for the cross section, Sommerfeld parameter, and Maxwellian-averaged reaction rate are standard in nuclear astrophysics. All physical principles and equations are well-established.\n- **Well-Posed**: The problem is well-posed. It requests the derivation of a standard formula and its numerical evaluation against a known approximation method. All necessary constants and data are provided. The tasks are clearly defined, leading to a unique set of numerical results.\n- **Objective**: The problem is stated in precise, objective language. There are no subjective or opinion-based elements.\n- **Other criteria**: The problem is self-contained, not contradictory, and its complexity is appropriate for a problem in computational physics, requiring both analytical derivation and numerical implementation. It is not trivial or tautological. It falls squarely within the specified topic of *astrophysical S-factor computations*.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. I will proceed with the solution.\n\n### Derivation and Solution Methodology\n\nThe primary goal is to compute the Maxwellian-averaged reaction rate per particle pair, $\\langle \\sigma v \\rangle$, and to compare its exact numerical value with an analytical approximation derived via the method of steepest descent.\n\n**1. Derivation of the One-Dimensional Energy Integral for $\\langle \\sigma v \\rangle$**\n\nThe Maxwellian-averaged reaction rate is given by the integral over the distribution of relative velocities:\n$$ \\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(v) v f_{\\text{MB}}(v; T) 4\\pi v^2 dv $$\nwhere the Maxwell-Boltzmann distribution of relative speeds $v$ is:\n$$ f_{\\text{MB}}(v; T) = \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{\\mu v^2}{2 k_B T}\\right) $$\nCombining these gives:\n$$ \\langle \\sigma v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\int_0^\\infty \\sigma(v) \\exp\\left(-\\frac{\\mu v^2}{2 k_B T}\\right) v^3 dv $$\nWe change the integration variable from relative speed $v$ to center-of-mass energy $E = \\frac{1}{2}\\mu v^2$. The differential is $dE = \\mu v dv$, so $v dv = dE/\\mu$. The term $v^3 dv$ becomes $v^2 (v dv) = (\\frac{2E}{\\mu})(\\frac{dE}{\\mu}) = \\frac{2E}{\\mu^2} dE$. The exponential term becomes $\\exp(-E/k_B T)$. Substituting these into the integral:\n$$ \\langle \\sigma v \\rangle = 4\\pi \\left(\\frac{\\mu}{2\\pi k_B T}\\right)^{3/2} \\int_0^\\infty \\sigma(E) \\exp\\left(-\\frac{E}{k_B T}\\right) \\frac{2E}{\\mu^2} dE $$\nSimplifying the pre-factor:\n$$ 4\\pi \\frac{\\mu^{3/2}}{(2\\pi)^{3/2} (k_B T)^{3/2}} \\frac{2}{\\mu^2} = \\frac{8\\pi}{2\\pi\\sqrt{2\\pi}\\mu^{1/2}(k_B T)^{3/2}} = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{(k_B T)^{3/2}} $$\nThis yields the reaction rate as an integral over energy:\n$$ \\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{1}{(k_B T)^{3/2}} \\int_0^\\infty \\sigma(E) E \\exp\\left(-\\frac{E}{k_B T}\\right) dE $$\nNow, we substitute the definition of the cross section, $\\sigma(E) = \\frac{S(E)}{E} \\exp(-2\\pi\\eta)$, with a constant S-factor, $S(E) = S_0$. The Sommerfeld parameter $\\eta$ is a function of energy:\n$$ 2\\pi\\eta = 2\\pi \\frac{\\alpha Z_1 Z_2 c}{v} = 2\\pi \\alpha Z_1 Z_2 c \\sqrt{\\frac{\\mu}{2E}} = \\frac{b}{\\sqrt{E}} $$\nwhere we define the constant $b \\equiv 2\\pi \\alpha Z_1 Z_2 c \\sqrt{\\mu/2}$.\nThe cross section is $\\sigma(E) = \\frac{S_0}{E} \\exp(-b/\\sqrt{E})$. Inserting this into the integral for $\\langle \\sigma v \\rangle$, the factor of $E$ cancels:\n$$ \\langle \\sigma v \\rangle = \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{S_0}{(k_B T)^{3/2}} \\int_0^\\infty \\exp\\left(-\\frac{E}{k_B T} - \\frac{b}{\\sqrt{E}}\\right) dE $$\nThis is the one-dimensional integral over energy $E$ that will be evaluated numerically.\n\n**2. Saddle-Point Approximation for $\\langle \\sigma v \\rangle$**\n\nThe integral $I = \\int_0^\\infty \\exp(f(E)) dE$, where $f(E) = -E/(k_B T) - b/\\sqrt{E}$, is dominated by the region around the maximum of $f(E)$. This peak is known as the Gamow peak. We find the energy $E_0$ of the peak by setting the derivative of $f(E)$ to zero:\n$$ f'(E) = -\\frac{1}{k_B T} + \\frac{b}{2} E^{-3/2} $$\nSetting $f'(E_0) = 0$ gives the peak energy:\n$$ \\frac{1}{k_B T} = \\frac{b}{2} E_0^{-3/2} \\implies E_0 = \\left(\\frac{b k_B T}{2}\\right)^{2/3} $$\nThe method of steepest descent (or saddle-point approximation) approximates $f(E)$ by a parabola (i.e., the integrand by a Gaussian) around $E_0$:\n$$ f(E) \\approx f(E_0) + \\frac{1}{2} f''(E_0) (E-E_0)^2 $$\nThe second derivative is $f''(E) = -\\frac{3b}{4} E^{-5/2}$. At $E_0$, this is $f''(E_0) = -\\frac{3b}{4} E_0^{-5/2}$. Since $f''(E_0) < 0$, $E_0$ is indeed a maximum.\nThe integral is then approximated by a Gaussian integral:\n$$ I \\approx \\int_{-\\infty}^{\\infty} \\exp\\left( f(E_0) + \\frac{1}{2} f''(E_0) (E-E_0)^2 \\right) dE = \\exp(f(E_0)) \\sqrt{\\frac{-2\\pi}{f''(E_0)}} $$\nLet's evaluate the terms. First, $f(E_0)$:\n$$ f(E_0) = -\\frac{E_0}{k_B T} - \\frac{b}{\\sqrt{E_0}} $$\nUsing $1/(k_B T) = b/(2E_0^{3/2})$ from the peak condition, we get $-E_0/(k_B T) = -E_0 \\cdot b/(2E_0^{3/2}) = -b/(2\\sqrt{E_0})$.\nThus, $f(E_0) = -b/(2\\sqrt{E_0}) - b/\\sqrt{E_0} = -3b/(2\\sqrt{E_0})$.\nThis can be expressed in terms of a single parameter $\\tau$:\n$$ f(E_0) = -\\frac{3E_0}{k_B T} \\equiv -\\tau $$\nThe parameter $\\tau = 3E_0/(k_B T)$ is a key dimensionless quantity. We can express it in terms of fundamental constants:\n$$ \\tau = \\frac{3}{k_B T} \\left(\\frac{b k_B T}{2}\\right)^{2/3} = 3 \\left(\\frac{b^2}{4k_B T}\\right)^{1/3} = 3 \\left(\\frac{(2\\pi \\alpha Z_1 Z_2 c)^2 (\\mu/2)}{4k_B T}\\right)^{1/3} = 3 \\left(\\frac{\\pi^2 \\alpha^2 Z_1^2 Z_2^2 c^2 \\mu}{2k_B T}\\right)^{1/3} $$\nNext, we evaluate the width term $\\sqrt{-2\\pi/f''(E_0)}$:\n$$ \\sqrt{\\frac{-2\\pi}{-3b/(4E_0^{5/2})}} = \\sqrt{\\frac{8\\pi E_0^{5/2}}{3b}} $$\nSubstituting $b = 2E_0^{3/2}/(k_B T)$, this becomes $\\sqrt{\\frac{8\\pi E_0^{5/2}}{3 \\cdot 2E_0^{3/2}/(k_B T)}} = \\sqrt{\\frac{4\\pi E_0 k_B T}{3}}$.\nThe integral approximation is $I \\approx \\exp(-\\tau) \\sqrt{\\frac{4\\pi E_0 k_B T}{3}}$.\nSubstituting this into the expression for $\\langle \\sigma v \\rangle$:\n$$ \\langle \\sigma v \\rangle_{\\text{saddle}} \\approx \\sqrt{\\frac{8}{\\pi\\mu}} \\frac{S_0}{(k_B T)^{3/2}} \\exp(-\\tau) \\sqrt{\\frac{4\\pi E_0 k_B T}{3}} $$\n$$ \\langle \\sigma v \\rangle_{\\text{saddle}} = S_0 \\sqrt{\\frac{32 E_0}{3\\mu (k_B T)^2}} \\exp(-\\tau) = \\frac{4S_0}{k_B T}\\sqrt{\\frac{2E_0}{3\\mu}} \\exp(-\\tau) $$\nTo express this in the standard form involving $\\tau$, we use $k_B T = 27b^2/(4\\tau^3)$ and $b = \\pi\\alpha Z_1 Z_2 c \\sqrt{2\\mu}$. After algebraic simplification, this yields:\n$$ \\langle \\sigma v \\rangle_{\\text{saddle}} = \\frac{8 S_0}{9\\sqrt{3} \\pi \\alpha Z_1 Z_2 c \\mu} \\tau^2 e^{-\\tau} $$\nThis is the final analytic approximation to be implemented. For the $p+p$ reaction, $Z_1 = Z_2 = 1$.\n\n**3. Numerical Implementation**\n\nThe solution will be implemented in Python using the `numpy` and `scipy` libraries.\n- All physical constants are defined in SI units. The S-factor $S_0$ is converted from $\\mathrm{keV\\,b}$ to $\\mathrm{J\\,m^2}$.\n- For each temperature $T$ in the test suite:\n    1. **Numerical Integration**: The integral $I = \\int_0^\\infty \\exp(-E/(k_B T) - b/\\sqrt{E}) dE$ is computed using `scipy.integrate.quad`. The full rate $\\langle \\sigma v \\rangle_{\\text{numeric}}$ is assembled using the derived pre-factors.\n    2. **Saddle-Point Evaluation**: The parameter $\\tau$ is calculated for the given temperature $T$. The rate $\\langle \\sigma v \\rangle_{\\text{saddle}}$ is then calculated using the derived analytic formula.\n    3. **Relative Error**: The relative error $\\delta$ is computed as $\\delta = (\\langle \\sigma v \\rangle_{\\text{saddle}} - \\langle \\sigma v \\rangle_{\\text{numeric}}) / \\langle \\sigma v \\rangle_{\\text{numeric}}$. As the factors $N_A$ and the unit conversion from $\\mathrm{m^3}$ to $\\mathrm{cm^3}$ appear in both the numerator and denominator, they cancel out, so the error can be computed directly from the SI results for $\\langle \\sigma v \\rangle$.\n\nThis procedure is repeated for all specified temperatures, and the resulting $\\delta$ values are collected and printed.",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Derives and computes the proton-proton reaction rate using numerical integration\n    and the saddle-point approximation, then calculates the relative error.\n    \"\"\"\n\n    # Physical constants in SI units\n    Z1 = 1.0\n    Z2 = 1.0\n    NA = 6.02214076e23  # mol^-1\n    ALPHA = 7.2973525693e-3\n    C = 2.99792458e8  # m/s\n    KB = 1.380649e-23  # J/K\n    M_P = 1.67262192369e-27  # kg\n    MU = M_P / 2.0  # Reduced mass for p-p\n\n    # S-factor conversion to SI units (J m^2)\n    S0_KEV_B = 4.01e-22  # keV b\n    EV_TO_J = 1.602176634e-19\n    KEV_TO_J = EV_TO_J * 1e3\n    B_TO_M2 = 1e-28\n    S0_SI = S0_KEV_B * KEV_TO_J * B_TO_M2\n\n    # Test suite of temperatures in Kelvin\n    temperatures = [\n        5.0e6,\n        1.5e7,\n        3.0e7,\n        1.0e8,\n    ]\n\n    results = []\n\n    for T in temperatures:\n        # --- 1. Numerical Integration Method ---\n\n        # Constant b in the Gamow factor exp(-b/sqrt(E))\n        b = 2.0 * np.pi * ALPHA * Z1 * Z2 * C * np.sqrt(MU / 2.0)\n\n        # Integrand for the reaction rate integral\n        def integrand(E):\n            # The term E/(KB*T) can be large, but E is positive.\n            # The term b/sqrt(E) can lead to division by zero at E=0.\n            # However, exp(-inf) is 0, which is the correct limit.\n            # We handle E=0 explicitly to avoid runtime warnings.\n            if E == 0:\n                return 0.0\n            \n            exponent = -E / (KB * T) - b / np.sqrt(E)\n            return np.exp(exponent)\n\n        # Perform the numerical integration from 0 to infinity\n        integral_val, _ = integrate.quad(integrand, 0, np.inf)\n\n        # Assemble the full rate <sigma v>\n        prefactor_numeric = np.sqrt(8.0 / (np.pi * MU)) * S0_SI / (KB * T)**1.5\n        rate_numeric = prefactor_numeric * integral_val\n\n        # --- 2. Saddle-Point Approximation Method ---\n\n        # Dimensionless parameter tau\n        tau_factor = (np.pi**2 * ALPHA**2 * Z1**2 * Z2**2 * C**2 * MU) / (2 * KB * T)\n        tau = 3.0 * (tau_factor)**(1.0/3.0)\n\n        # Assemble the saddle-point approximation for <sigma v>\n        numerator_saddle = 8.0 * S0_SI * tau**2 * np.exp(-tau)\n        denominator_saddle = 9.0 * np.sqrt(3.0) * np.pi * ALPHA * Z1 * Z2 * C * MU\n        rate_saddle = numerator_saddle / denominator_saddle\n\n        # --- 3. Relative Error ---\n        \n        # The terms N_A and unit conversions for cm^3 cancel out\n        relative_error = (rate_saddle - rate_numeric) / rate_numeric\n        results.append(relative_error)\n\n    # Format and print the final result\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "In practice, the true functional form of $S(E)$ is unknown and must be inferred from noisy experimental data. Choosing an appropriate model—for instance, deciding whether the data justify a simple constant S-factor or require a more complex energy-dependent form—is a critical step in data analysis. This exercise introduces the powerful framework of Bayesian model comparison, allowing you to use the data itself to weigh the evidence for competing physical models in a quantitative way. ",
            "id": "3542527",
            "problem": "You are given a statistical model-comparison task grounded in astrophysical S-factor analysis. The astrophysical S-factor, denoted by $S(E)$, relates to the charged-particle reaction cross section via a smooth function of center-of-mass energy $E$, and it is often analyzed directly to remove most of the Coulomb barrier energy dependence. In this task, you will compare two parametric models for $S(E)$ based on noisy measurements and compute Bayes factors to determine whether the data support departures from a constant $S(E)$.\n\nFundamental base:\n- Bayes’ theorem: for data $D$ and model $\\mathcal{M}$ with parameters $\\boldsymbol{\\theta}$, the posterior is $p(\\boldsymbol{\\theta}\\mid D,\\mathcal{M}) \\propto \\mathcal{L}(D\\mid\\boldsymbol{\\theta},\\mathcal{M})\\,\\pi(\\boldsymbol{\\theta}\\mid\\mathcal{M})$, and the model evidence (marginal likelihood) is $Z \\equiv p(D\\mid\\mathcal{M}) = \\int \\mathcal{L}(D\\mid\\boldsymbol{\\theta},\\mathcal{M})\\,\\pi(\\boldsymbol{\\theta}\\mid\\mathcal{M})\\,\\mathrm{d}\\boldsymbol{\\theta}$.\n- Gaussian noise model: independent measurements with known standard deviations combine multiplicatively in the likelihood for independent data points.\n- Linear-Gaussian propagation: a linear model with a multivariate normal prior and additive Gaussian measurement noise leads to a well-defined marginal likelihood.\n\nModel definitions:\n- Model $\\mathcal{M}_0$ (constant S-factor): $S(E) = S_0$ with parameter $S_0$. Prior: $S_0 \\sim \\mathcal{N}(\\mu_0,\\,\\sigma_{0,\\text{pr}}^2)$.\n- Model $\\mathcal{M}_1$ (linear in energy): $S(E) = S_0 + S_1 E$ with parameters $(S_0,S_1)$. Prior: $S_0 \\sim \\mathcal{N}(\\mu_0,\\,\\sigma_{0,\\text{pr}}^2)$ and $S_1 \\sim \\mathcal{N}(0,\\,\\sigma_{1,\\text{pr}}^2)$, independent.\n\nData model:\n- You are given $N$ measurements $\\{(E_i,\\,S_i,\\,\\sigma_i)\\}_{i=1}^N$ where $E_i$ is energy in $\\mathrm{keV}$, $S_i$ is a measured S-factor in $\\mathrm{keV}\\cdot\\mathrm{b}$, and $\\sigma_i$ is the $1\\sigma$ uncertainty on $S_i$ in $\\mathrm{keV}\\cdot\\mathrm{b}$. Assume independent Gaussian errors across $i$.\n\nTask:\n- For each test case, compute the model evidence $Z_0$ and $Z_1$ for $\\mathcal{M}_0$ and $\\mathcal{M}_1$, respectively, by integrating the Gaussian likelihood over the Gaussian prior(s) in parameter space (you may evaluate the integral analytically using the properties of multivariate normal distributions, or numerically with sufficient precision).\n- Compute the Bayes factor $K_{10} \\equiv Z_1 / Z_0$. Interpret $K_{10} > 1$ as support for the linear-in-$E$ model relative to the constant model given the chosen priors and data, and $K_{10} &lt; 1$ as support for the constant model.\n\nUnits:\n- Energies $E_i$ are provided in $\\mathrm{keV}$.\n- S-factor measurements $S_i$ and standard deviations $\\sigma_i$ are provided in $\\mathrm{keV}\\cdot\\mathrm{b}$.\n- Prior parameters $\\mu_0$ and $\\sigma_{0,\\text{pr}}$ are in $\\mathrm{keV}\\cdot\\mathrm{b}$, and $\\sigma_{1,\\text{pr}}$ is in $\\mathrm{keV}\\cdot\\mathrm{b}/\\mathrm{keV}$.\n- The Bayes factor $K_{10}$ is dimensionless. Your final results must be printed as floating-point numbers.\n\nTest suite:\n- Case A (informative, approximately constant):\n  - Energies: $[\\,10.0,\\,20.0,\\,30.0,\\,40.0\\,]\\,\\mathrm{keV}$\n  - Measurements: $[\\,19.6,\\,20.2,\\,19.8,\\,20.5\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - Uncertainties: $[\\,0.5,\\,0.5,\\,0.5,\\,0.5\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - Priors: $\\mu_0 = 20.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{0,\\text{pr}} = 10.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{1,\\text{pr}} = 0.5\\,\\mathrm{keV}\\cdot\\mathrm{b}/\\mathrm{keV}$\n- Case B (informative, approximately linear trend):\n  - Energies: $[\\,10.0,\\,20.0,\\,30.0,\\,40.0\\,]\\,\\mathrm{keV}$\n  - Measurements: $[\\,19.6,\\,19.9,\\,20.6,\\,20.8\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - Uncertainties: $[\\,0.3,\\,0.3,\\,0.3,\\,0.3\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - Priors: $\\mu_0 = 20.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{0,\\text{pr}} = 10.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{1,\\text{pr}} = 0.5\\,\\mathrm{keV}\\cdot\\mathrm{b}/\\mathrm{keV}$\n- Case C (weakly informative, broad priors, noisy data):\n  - Energies: $[\\,10.0,\\,30.0,\\,50.0\\,]\\,\\mathrm{keV}$\n  - Measurements: $[\\,21.0,\\,17.5,\\,24.0\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - Uncertainties: $[\\,5.0,\\,5.0,\\,5.0\\,]\\,\\mathrm{keV}\\cdot\\mathrm{b}$\n  - Priors: $\\mu_0 = 20.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{0,\\text{pr}} = 50.0\\,\\mathrm{keV}\\cdot\\mathrm{b}$, $\\sigma_{1,\\text{pr}} = 5.0\\,\\mathrm{keV}\\cdot\\mathrm{b}/\\mathrm{keV}$\n\nAlgorithmic requirements:\n- Construct the design matrix $X$ for each model: for $\\mathcal{M}_0$, $X = [\\mathbf{1}]$; for $\\mathcal{M}_1$, $X = [\\mathbf{1},\\,\\mathbf{E}]$, where $\\mathbf{1}$ is a column of ones and $\\mathbf{E}$ is the column vector of energies.\n- Use the independent Gaussian noise covariance $W = \\mathrm{diag}(\\sigma_1^2,\\dots,\\sigma_N^2)$.\n- Use the specified independent Gaussian priors in each case to define the prior mean vector and prior covariance matrix for the model parameter(s).\n- Compute the model evidence $Z$ for each model, then compute $K_{10} = Z_1/Z_0$ for each test case.\n\nFinal output format:\n- Your program should produce a single line of output containing the Bayes factors for Cases A, B, and C as a comma-separated list enclosed in square brackets, for example $[\\,x_A,\\,x_B,\\,x_C\\,]$, where each $x$ is a floating-point number representing $K_{10}$ for that case.\n- No additional text should be printed.",
            "solution": "The problem is subjected to validation and is determined to be a valid, well-posed scientific problem. It is scientifically grounded in the principles of Bayesian model comparison, mathematically consistent, and provides all necessary information to derive a unique solution. We may therefore proceed with a complete analytical and algorithmic solution.\n\nThe core of this problem is the computation of the model evidence, or marginal likelihood, for two competing models of the astrophysical S-factor, $S(E)$. The model evidence, $Z$, for a given model $\\mathcal{M}$ and data $D$, is the probability of observing the data given the model, averaged over all possible parameter values $\\boldsymbol{\\theta}$ weighted by their prior probabilities. It is formally defined as:\n$$\nZ = p(D \\mid \\mathcal{M}) = \\int p(D \\mid \\boldsymbol{\\theta}, \\mathcal{M}) \\, p(\\boldsymbol{\\theta} \\mid \\mathcal{M}) \\, \\mathrm{d}\\boldsymbol{\\theta}\n$$\nHere, $p(D \\mid \\boldsymbol{\\theta}, \\mathcal{M})$ is the likelihood $\\mathcal{L}(D \\mid \\boldsymbol{\\theta}, \\mathcal{M})$ and $p(\\boldsymbol{\\theta} \\mid \\mathcal{M})$ is the prior probability distribution $\\pi(\\boldsymbol{\\theta} \\mid \\mathcal{M})$ of the parameters. The Bayes factor, $K_{10}$, is the ratio of the evidences for two models, $\\mathcal{M}_1$ and $\\mathcal{M}_0$:\n$$\nK_{10} = \\frac{Z_1}{Z_0} = \\frac{p(D \\mid \\mathcal{M}_1)}{p(D \\mid \\mathcal{M}_0)}\n$$\nThis problem specifies a linear-Gaussian framework, where the models are linear in their parameters, and both the likelihood and prior are Gaussian distributions. This structure allows for an analytical solution for the model evidence.\n\nLet the data vector of $N$ S-factor measurements be $\\mathbf{D} = [S_1, S_2, \\dots, S_N]^T$. The model prediction is a linear function of the parameters $\\boldsymbol{\\theta}$, expressed as $\\mathbf{M}(\\boldsymbol{\\theta}) = X\\boldsymbol{\\theta}$, where $X$ is the $N \\times k$ design matrix and $k$ is the number of parameters.\n\nThe problem states that the measurement errors are independent and Gaussian. The likelihood is therefore:\n$$\n\\mathcal{L}(D \\mid \\boldsymbol{\\theta}) = p(\\mathbf{D} \\mid \\boldsymbol{\\theta}) = \\mathcal{N}(\\mathbf{D} \\mid X\\boldsymbol{\\theta}, W) = \\frac{1}{(2\\pi)^{N/2} (\\det W)^{1/2}} \\exp\\left(-\\frac{1}{2} (\\mathbf{D} - X\\boldsymbol{\\theta})^T W^{-1} (\\mathbf{D} - X\\boldsymbol{\\theta})\\right)\n$$\nwhere $W = \\mathrm{diag}(\\sigma_1^2, \\dots, \\sigma_N^2)$ is the noise covariance matrix.\n\nThe prior on the parameters is also Gaussian:\n$$\n\\pi(\\boldsymbol{\\theta}) = p(\\boldsymbol{\\theta}) = \\mathcal{N}(\\boldsymbol{\\theta} \\mid \\boldsymbol{\\mu}_{\\text{pr}}, \\Sigma_{\\text{pr}}) = \\frac{1}{(2\\pi)^{k/2} (\\det \\Sigma_{\\text{pr}})^{1/2}} \\exp\\left(-\\frac{1}{2} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_{\\text{pr}})^T \\Sigma_{\\text{pr}}^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_{\\text{pr}})\\right)\n$$\nwhere $\\boldsymbol{\\mu}_{\\text{pr}}$ and $\\Sigma_{\\text{pr}}$ are the prior mean vector and covariance matrix, respectively.\n\nThe integral for the model evidence $Z$ involves the product of these two Gaussians. The resulting integral is itself a Gaussian integral, which has a closed-form solution. The resulting log-marginal likelihood, $\\ln Z$, is given by:\n$$\n\\ln Z = -\\frac{N}{2}\\ln(2\\pi) + \\frac{1}{2}\\ln(\\det(\\Sigma_{\\text{pr}}^{-1})) - \\frac{1}{2}\\ln(\\det W) - \\frac{1}{2}\\ln(\\det(\\Sigma_{\\text{post}}^{-1})) - \\frac{1}{2} \\left( \\mathbf{D}^T W^{-1} \\mathbf{D} + \\boldsymbol{\\mu}_{\\text{pr}}^T \\Sigma_{\\text{pr}}^{-1} \\boldsymbol{\\mu}_{\\text{pr}} - \\boldsymbol{\\mu}_{\\text{post}}^T \\Sigma_{\\text{post}}^{-1} \\boldsymbol{\\mu}_{\\text{post}} \\right)\n$$\nwhere the posterior inverse covariance $\\Sigma_{\\text{post}}^{-1}$ and posterior mean $\\boldsymbol{\\mu}_{\\text{post}}$ are defined as:\n$$\n\\Sigma_{\\text{post}}^{-1} = \\Sigma_{\\text{pr}}^{-1} + X^T W^{-1} X\n$$\n$$\n\\boldsymbol{\\mu}_{\\text{post}} = (\\Sigma_{\\text{post}}^{-1})^{-1} \\left( \\Sigma_{\\text{pr}}^{-1} \\boldsymbol{\\mu}_{\\text{pr}} + X^T W^{-1} \\mathbf{D} \\right)\n$$\nWe will apply this general formula to both models, $\\mathcal{M}_0$ and $\\mathcal{M}_1$.\n\nFor Model $\\mathcal{M}_0$ (constant S-factor):\n$S(E) = S_0$.\nThe parameter vector is a scalar: $\\boldsymbol{\\theta}_0 = [S_0]$. Here, $k=1$.\nThe design matrix is an $N \\times 1$ column vector of ones: $X_0 = [1, 1, \\dots, 1]^T$.\nThe prior is $S_0 \\sim \\mathcal{N}(\\mu_0, \\sigma_{0,\\text{pr}}^2)$, so the prior mean is $\\boldsymbol{\\mu}_{\\text{pr},0} = [\\mu_0]$ and the prior covariance is $\\Sigma_{\\text{pr},0} = [\\sigma_{0,\\text{pr}}^2]$. The inverse prior covariance is $\\Sigma_{\\text{pr},0}^{-1} = [1/\\sigma_{0,\\text{pr}}^2]$.\nUsing these definitions, we can compute $\\ln Z_0$.\n\nFor Model $\\mathcal{M}_1$ (linear S-factor):\n$S(E) = S_0 + S_1 E$.\nThe parameter vector is $\\boldsymbol{\\theta}_1 = [S_0, S_1]^T$. Here, $k=2$.\nThe design matrix is an $N \\times 2$ matrix: $X_1 = \\begin{pmatrix} 1 & E_1 \\\\ 1 & E_2 \\\\ \\vdots & \\vdots \\\\ 1 & E_N \\end{pmatrix}$.\nThe priors are independent: $S_0 \\sim \\mathcal{N}(\\mu_0, \\sigma_{0,\\text{pr}}^2)$ and $S_1 \\sim \\mathcal{N}(0, \\sigma_{1,\\text{pr}}^2)$. This gives a prior mean vector $\\boldsymbol{\\mu}_{\\text{pr},1} = [\\mu_0, 0]^T$ and a diagonal prior covariance matrix $\\Sigma_{\\text{pr},1} = \\mathrm{diag}(\\sigma_{0,\\text{pr}}^2, \\sigma_{1,\\text{pr}}^2)$. The inverse prior covariance is $\\Sigma_{\\text{pr},1}^{-1} = \\mathrm{diag}(1/\\sigma_{0,\\text{pr}}^2, 1/\\sigma_{1,\\text{pr}}^2)$.\nUsing these definitions, we can compute $\\ln Z_1$.\n\nThe Bayes factor $K_{10}$ is then computed as:\n$$\nK_{10} = \\frac{Z_1}{Z_0} = \\exp(\\ln Z_1 - \\ln Z_0)\n$$\nThis approach avoids potential numerical underflow or overflow from calculating $Z_1$ and $Z_0$ directly. The algorithmic implementation will involve constructing the specified matrices and vectors for each model and test case, calculating $\\ln Z_0$ and $\\ln Z_1$ using the formula for the log-marginal likelihood, and then finding their ratio.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef compute_log_evidence(D, X, W_inv, mu_pr, Sigma_pr_inv):\n    \"\"\"\n    Computes the log model evidence for a linear-Gaussian model.\n\n    Args:\n        D (np.ndarray): Data vector of shape (N,).\n        X (np.ndarray): Design matrix of shape (N, k).\n        W_inv (np.ndarray): Inverse of the diagonal noise covariance matrix, shape (N, N).\n        mu_pr (np.ndarray): Prior mean vector of shape (k,).\n        Sigma_pr_inv (np.ndarray): Inverse of the prior covariance matrix, shape (k, k).\n\n    Returns:\n        float: The log model evidence (ln Z).\n    \"\"\"\n    N, k = X.shape\n\n    # Log determinant of the noise covariance W. W_inv is diagonal.\n    # det(W_inv) = product(1/sigma_i^2), so log(det(W_inv)) = sum(log(1/sigma_i^2))\n    # log(det(W)) = -log(det(W_inv))\n    log_det_W = -np.sum(np.log(np.diag(W_inv)))\n\n    # Log determinant of the prior covariance\n    _sign, log_det_Sigma_pr_inv = np.linalg.slogdet(Sigma_pr_inv)\n\n    # Posterior inverse covariance\n    Sigma_post_inv = Sigma_pr_inv + X.T @ W_inv @ X\n\n    # Log determinant of the posterior covariance\n    _sign, log_det_Sigma_post_inv = np.linalg.slogdet(Sigma_post_inv)\n\n    # Posterior mean\n    # We can compute mu_post using the inverse of Sigma_post_inv,\n    # or compute the term mu_post.T @ Sigma_post_inv @ mu_post differently.\n    # Let's define A = Sigma_pr_inv @ mu_pr + X.T @ W_inv @ D\n    # then mu_post = inv(Sigma_post_inv) @ A\n    # and mu_post.T @ Sigma_post_inv @ mu_post = (inv(Sigma_post_inv) @ A).T @ Sigma_post_inv @ (inv(Sigma_post_inv) @ A)\n    # = A.T @ inv(Sigma_post_inv).T @ Sigma_post_inv @ inv(Sigma_post_inv) @ A\n    # Since Sigma_post_inv is symmetric, inv(Sigma_post_inv).T = inv(Sigma_post_inv)\n    # = A.T @ inv(Sigma_post_inv) @ A\n    A = Sigma_pr_inv @ mu_pr + X.T @ W_inv @ D\n    quad_term_post = A.T @ np.linalg.inv(Sigma_post_inv) @ A\n\n    # Full quadratic term in the exponent\n    quad_term = D.T @ W_inv @ D + mu_pr.T @ Sigma_pr_inv @ mu_pr - quad_term_post\n\n    log_Z = (\n        -N / 2 * np.log(2 * np.pi)\n        - 0.5 * log_det_W\n        + 0.5 * log_det_Sigma_pr_inv\n        - 0.5 * log_det_Sigma_post_inv\n        - 0.5 * quad_term\n    )\n    \n    return log_Z\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\n            \"E\": np.array([10.0, 20.0, 30.0, 40.0]),\n            \"S\": np.array([19.6, 20.2, 19.8, 20.5]),\n            \"sigma\": np.array([0.5, 0.5, 0.5, 0.5]),\n            \"mu0\": 20.0,\n            \"sigma0_pr\": 10.0,\n            \"sigma1_pr\": 0.5\n        },\n        # Case B\n        {\n            \"E\": np.array([10.0, 20.0, 30.0, 40.0]),\n            \"S\": np.array([19.6, 19.9, 20.6, 20.8]),\n            \"sigma\": np.array([0.3, 0.3, 0.3, 0.3]),\n            \"mu0\": 20.0,\n            \"sigma0_pr\": 10.0,\n            \"sigma1_pr\": 0.5\n        },\n        # Case C\n        {\n            \"E\": np.array([10.0, 30.0, 50.0]),\n            \"S\": np.array([21.0, 17.5, 24.0]),\n            \"sigma\": np.array([5.0, 5.0, 5.0]),\n            \"mu0\": 20.0,\n            \"sigma0_pr\": 50.0,\n            \"sigma1_pr\": 5.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        E = case[\"E\"]\n        S = case[\"S\"]\n        sigma = case[\"sigma\"]\n        mu0 = case[\"mu0\"]\n        sigma0_pr = case[\"sigma0_pr\"]\n        sigma1_pr = case[\"sigma1_pr\"]\n        \n        N = len(E)\n        D = S\n        \n        # Diagonal inverse noise covariance matrix W^-1\n        W_inv = np.diag(1.0 / sigma**2)\n\n        #--- Model M0 (constant S-factor) ---\n        X0 = np.ones((N, 1))\n        mu_pr0 = np.array([mu0])\n        Sigma_pr_inv0 = np.array([[1.0 / sigma0_pr**2]])\n        log_Z0 = compute_log_evidence(D, X0, W_inv, mu_pr0, Sigma_pr_inv0)\n\n        #--- Model M1 (linear S-factor) ---\n        X1 = np.vstack((np.ones(N), E)).T\n        mu_pr1 = np.array([mu0, 0.0])\n        Sigma_pr_inv1 = np.diag([1.0 / sigma0_pr**2, 1.0 / sigma1_pr**2])\n        log_Z1 = compute_log_evidence(D, X1, W_inv, mu_pr1, Sigma_pr_inv1)\n\n        #--- Bayes Factor K10 = Z1 / Z0 ---\n        K10 = np.exp(log_Z1 - log_Z0)\n        results.append(K10)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}