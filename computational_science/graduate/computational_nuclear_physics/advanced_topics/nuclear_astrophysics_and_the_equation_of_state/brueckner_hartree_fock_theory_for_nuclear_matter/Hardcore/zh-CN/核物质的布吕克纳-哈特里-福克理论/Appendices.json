{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最好的检验方法就是动手实践。本章节的第一个练习将指导你构建一个基础但完整的布鲁克纳-哈特里-福克（BHF）理论计算程序。通过使用一个简化的、可分离的山口势，你将亲自实现计算核物质单位核子能量的核心步骤，包括处理动量空间中的积分和组合总能量。这个练习旨在为你后续更复杂的计算打下坚实的数值方法基础。",
            "id": "3545472",
            "problem": "考虑在 Brueckner-Hartree-Fock (BHF) 理论框架下处理的均匀对称核物质。Brueckner 反应矩阵，通常称为 $G$ 矩阵，求解 Bethe-Goldstone 方程：\n$$\nG(\\mathbf{k},\\mathbf{k}';\\omega) \\;=\\; V(\\mathbf{k},\\mathbf{k}') \\;+\\; \\int \\frac{d^3\\mathbf{q}}{(2\\pi)^3}\\, V(\\mathbf{k},\\mathbf{q}) \\, \\frac{Q(\\mathbf{q},k_F)}{\\omega - 2 e(\\mathbf{q}) + i\\eta} \\, G(\\mathbf{q},\\mathbf{k}';\\omega),\n$$\n其中 $V(\\mathbf{k},\\mathbf{k}')$ 是动量空间中的核子-核子相互作用，$Q(\\mathbf{q},k_F)$ 是泡利阻塞算符，$e(\\mathbf{q})$ 是单粒子能量，$\\omega$ 是起始能量，$k_F$ 是费米动量，$\\eta$ 是一个确保因果边界条件的正无穷小量。在均匀核物质中，通常采用角平均泡利算符和自由单粒子能谱，即 $e(\\mathbf{q})$ 仅依赖于 $|\\mathbf{q}|$，并由 $e(q) = \\frac{q^2}{2m}$ 给出。\n\n对于此问题，采用以下适用于计算验证任务的简化和标准近似：\n- 使用形式如下的可分离 Yamaguchi $S$ 波势\n$$\nV(k,k') \\;=\\; -\\lambda\\, g(k)\\, g(k'), \\qquad g(k) \\;=\\; \\frac{1}{k^2 + \\beta^2},\n$$\n其中耦合强度 $\\lambda$ 为正，力程参数 $\\beta > 0$。\n- 采用各向同性自由单粒子能量 $e(q)=\\frac{q^2}{2m}$，其中核子质量为 $m$。\n- 使用在费米面上求值的角平均起始能量 $\\omega$，\n$$\n\\omega \\;=\\; 2 e(k_F),\n$$\n以及角平均泡利算符 $Q(\\mathbf{q},k_F) = \\Theta(q - k_F)$，其中 $\\Theta$ 是亥维赛阶跃函数。\n- 在自然单位制中进行计算，其中 $\\hbar = 1$ 且 $m = 1$，因此 $e(q)=\\frac{q^2}{2}$；在这些单位中，所有能量和动量都是无量纲的。所有最终的每个粒子的能量都用这些自然单位表示。\n\n在这些假设下，可分离结构意味着可以采用以下拟设：\n$$\nG(k,k';\\omega) \\;=\\; g(k)\\, g(k')\\, \\tau(\\omega;k_F),\n$$\n其中介质中的 $\\tau$ 函数满足\n$$\n\\tau(\\omega;k_F) \\;=\\; \\frac{-\\lambda}{1 + \\lambda\\, J(\\omega;k_F)}, \\qquad\nJ(\\omega;k_F) \\;=\\; \\frac{1}{2\\pi^2} \\int_{k_F}^{\\infty} dq\\, \\frac{q^2\\, g(q)^2}{\\omega - 2 e(q) + i\\eta}.\n$$\n使用自由能谱 $e(q)=\\frac{q^2}{2}$ 和指定的 $\\omega=2 e(k_F)=k_F^2$，$J(\\omega;k_F)$ 的实部是主值积分\n$$\n\\operatorname{Re}\\, J(k_F^2;k_F) \\;=\\; \\frac{1}{2\\pi^2} \\int_{k_F}^{\\infty} dq\\, q^2\\, g(q)^2 \\, \\frac{k_F^2 - q^2}{(k_F^2 - q^2)^2 + \\eta^2},\n$$\n其中 $\\eta>0$ 正则化了 $q=k_F$ 处的可积奇点，并用于数值模拟主值。$g(k)^2$ 在已占据的费米球上的平均值通过以下方式出现：\n$$\nI_F(k_F) \\;=\\; \\frac{1}{2\\pi^2} \\int_0^{k_F} dk\\, k^2\\, g(k)^2.\n$$\n\n在这个简化的角平均可分离模型中，通过对费米海内部粒子对的在壳 $G$ 矩阵进行平均，可以得到每个粒子相互作用能的半解析表达式。用 $\\omega=2e(k_F)$ 处的 $\\tau$ 函数值进行近似，可以得到\n$$\n\\frac{E_{\\text{pot}}}{A}(k_F) \\;\\approx\\; \\frac{d\\, \\tau(k_F^2;k_F)}{2\\, \\rho(k_F)} \\; \\left[I_F(k_F)\\right]^2,\n$$\n其中 $d$ 是一个有效的道权重因子，对于单个 $S$ 波道，我们将其设为 $d=1$，对称核物质的密度（自旋-同位旋简并度等于 $4$）为\n$$\n\\rho(k_F) \\;=\\; \\frac{4\\, k_F^3}{6\\pi^2} \\;=\\; \\frac{2\\, k_F^3}{3\\pi^2}.\n$$\n在这些单位制中，自由费米气体的每个粒子的动能为\n$$\n\\frac{E_{\\text{kin}}}{A}(k_F) \\;=\\; \\frac{3}{5}\\, e(k_F) \\;=\\; \\frac{3}{10}\\, k_F^2,\n$$\n因此每个粒子的总能量为\n$$\n\\frac{E}{A}(k_F) \\;=\\; \\frac{E_{\\text{kin}}}{A}(k_F) \\;+\\; \\frac{E_{\\text{pot}}}{A}(k_F).\n$$\n\n任务：\n- 编写一个完整的程序，对于给定的参数集 $(k_F,\\beta,\\lambda)$，计算 $\\operatorname{Re}\\, J(k_F^2;k_F)$，然后使用 $J$ 的实部计算 $\\tau(k_F^2;k_F)$，评估 $I_F(k_F)$，最后返回每个粒子的总能量 $\\frac{E}{A}(k_F)$，使用指定的自然单位制。\n- 在对 $\\operatorname{Re}\\, J$ 进行数值积分时，使用一个小的正常则化子 $\\eta$（例如 $\\eta=10^{-6}$）。\n- 实现对半无限区间的精确数值积分，以评估 $J$ 和 $I_F$ 的积分。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3]”），每个结果四舍五入到六位小数。\n\n测试套件：\n计算以下四种情况的每个粒子的总能量 $\\frac{E}{A}(k_F)$，这些情况旨在验证极限和覆盖范围：\n1. 正常路径类核物质情况：$k_F = 1.33$, $\\beta = 1.0$, $\\lambda = 2.0$。\n2. 零耦合极限：$k_F = 1.33$, $\\beta = 1.0$, $\\lambda = 0.0$。在此极限下，输出必须等于自由费米气体每个粒子的动能 $\\frac{3}{10}k_F^2$。\n3. 低密度边界：$k_F = 0.1$, $\\beta = 1.0$, $\\lambda = 2.0$。相互作用的贡献应该可以忽略不计，输出应接近 $\\frac{3}{10}k_F^2$。\n4. 短程（大 $\\beta$）边界情况：$k_F = 1.33$, $\\beta = 10.0$, $\\lambda = 2.0$。Yamaguchi 形状因子抑制了相互作用，结果应接近动能项。\n\n您的程序应生成单行输出，其中包含按上面列出的确切顺序排列的四种情况的能量，格式为用方括号括起来的逗号分隔列表，并四舍五入到六位小数，例如，“[E1,E2,E3,E4]”。",
            "solution": "该问题要求在一个简化的 Brueckner-Hartree-Fock (BHF) 框架内，计算对称核物质的每个粒子的总能量 $\\frac{E}{A}$。该计算基于一组特定的近似：可分离的 Yamaguchi 势、自由粒子动能谱、以及角平均的泡利算符和起始能量。任务是针对给定的参数集 $(k_F, \\beta, \\lambda)$ 数值实现所提供的公式，其中 $k_F$ 是费米动量，$\\beta$ 和 $\\lambda$ 是势的参数。我们在 $\\hbar=1$ 和核子质量 $m=1$ 的自然单位制中进行操作。\n\n每个粒子的总能量是动能和势能贡献的总和：\n$$\n\\frac{E}{A}(k_F) = \\frac{E_{\\text{kin}}}{A}(k_F) + \\frac{E_{\\text{pot}}}{A}(k_F)\n$$\n\n计算过程通过评估每个分量进行，如下所示。\n\n**1. 每个粒子的动能**\n在指定的单位制中，对于自由费米气体核子，每个粒子的平均动能由下式给出：\n$$\n\\frac{E_{\\text{kin}}}{A}(k_F) = \\frac{3}{5} e(k_F) = \\frac{3}{5} \\frac{k_F^2}{2m} = \\frac{3}{10} k_F^2\n$$\n该项仅取决于费米动量 $k_F$。\n\n**2. 每个粒子的势能**\n在指定的近似下，每个粒子的势能由下式给出：\n$$\n\\frac{E_{\\text{pot}}}{A}(k_F) \\approx \\frac{d \\cdot \\tau(k_F^2;k_F)}{2 \\rho(k_F)} [I_F(k_F)]^2\n$$\n这里，有效道权重因子为 $d=1$。需要计算的三个关键分量是密度 $\\rho(k_F)$、积分 $I_F(k_F)$ 和介质中函数 $\\tau(k_F^2;k_F)$。\n\n**2.1. 核物质密度 $\\rho(k_F)$**\n考虑到自旋-同位旋简并度为 $4$，对称核物质的密度由下式给出：\n$$\n\\rho(k_F) = \\frac{4 \\cdot (\\frac{4}{3}\\pi k_F^3)}{(2\\pi)^3} = \\frac{2k_F^3}{3\\pi^2}\n$$\n\n**2.2. 费米球平均积分 $I_F(k_F)$**\n该项表示势的形状因子 $g(k)$ 的平方在费米球内已占据态上的平均值。Yamaguchi 势的形状因子是 $g(k) = \\frac{1}{k^2 + \\beta^2}$。该积分定义为：\n$$\nI_F(k_F) = \\frac{1}{2\\pi^2} \\int_0^{k_F} dk\\, k^2\\, g(k)^2 = \\frac{1}{2\\pi^2} \\int_0^{k_F} dk\\, \\frac{k^2}{(k^2 + \\beta^2)^2}\n$$\n这是一个在有限区间 $[0, k_F]$ 上的正常积分，将使用数值求积法进行计算。\n\n**2.3. 介质中函数 $\\tau(k_F^2; k_F)$**\n函数 $\\tau$ 捕捉了核介质对两核子相互作用的影响。对于可分离势，它由下式给出：\n$$\n\\tau(\\omega;k_F) = \\frac{-\\lambda}{1 + \\lambda J(\\omega;k_F)}\n$$\n问题指定使用起始能量 $\\omega = 2e(k_F) = k_F^2$，并指示仅使用回路积分 $J(\\omega;k_F)$ 的实部。因此，我们计算：\n$$\n\\tau(k_F^2;k_F) = \\frac{-\\lambda}{1 + \\lambda \\operatorname{Re}J(k_F^2;k_F)}\n$$\n\n**2.4. 回路积分 $\\operatorname{Re}J(k_F^2; k_F)$**\n回路积分 $J$ 的实部考虑了一对粒子在费米海之上传播的效应。需要计算的表达式是：\n$$\n\\operatorname{Re}J(k_F^2;k_F) = \\frac{1}{2\\pi^2} \\int_{k_F}^{\\infty} dq\\, q^2\\, g(q)^2 \\, \\frac{k_F^2 - q^2}{(k_F^2 - q^2)^2 + \\eta^2}\n$$\n代入形状因子 $g(q) = \\frac{1}{q^2 + \\beta^2}$，被积函数变为：\n$$\n\\frac{1}{2\\pi^2} \\frac{q^2}{(q^2 + \\beta^2)^2} \\frac{k_F^2 - q^2}{(k_F^2 - q^2)^2 + \\eta^2}\n$$\n该积分在半无限区间 $[k_F, \\infty)$ 上进行。包含 $\\eta$ 的项是对在极限 $\\eta \\to 0^+$ 下得到的主值积分中出现的 $q=k_F$ 处的极点的正则化。对于一个小的有限值 $\\eta = 10^{-6}$，被积函数是良态的，尽管它在 $q=k_F$ 附近可能有一个尖锐的特征，这需要一个稳健的数值积分方法。\n\n**计算算法**\n对于给定的参数集 $(k_F, \\beta, \\lambda)$，计算总能量的算法如下：\n1. 计算每个粒子的动能：$\\frac{E_{\\text{kin}}}{A} = \\frac{3}{10}k_F^2$。\n2. 如果 $\\lambda=0$，则势能为 $0$，总能量就是动能。\n3. 如果 $\\lambda \\neq 0$：\n    a. 定义 $I_F(k_F)$ 的被积函数，并从 $0$ 到 $k_F$ 进行数值积分。乘以预因子 $\\frac{1}{2\\pi^2}$ 得到 $I_F(k_F)$。\n    b. 使用正则化子 $\\eta=10^{-6}$ 定义 $\\operatorname{Re}J(k_F^2;k_F)$ 的被积函数。从 $k_F$ 到 $\\infty$ 进行数值积分。乘以预因子 $\\frac{1}{2\\pi^2}$ 得到 $\\operatorname{Re}J(k_F^2;k_F)$。\n    c. 计算 $\\tau(k_F^2;k_F) = \\frac{-\\lambda}{1 + \\lambda \\operatorname{Re}J(k_F^2;k_F)}$。\n    d. 计算核密度 $\\rho(k_F) = \\frac{2k_F^3}{3\\pi^2}$。\n    e. 组合得到每个粒子的势能：$\\frac{E_{\\text{pot}}}{A} = \\frac{\\tau(k_F^2;k_F)}{2\\rho(k_F)} [I_F(k_F)]^2$。\n    f. 将动能和势能相加，得到每个粒子的总能量 $\\frac{E}{A}(k_F)$。\n\n对问题陈述中提供的四个测试案例中的每一个都执行此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the BHF problem for the given test cases and prints the results.\n    \"\"\"\n\n    # Test cases: (k_F, beta, lambda)\n    test_cases = [\n        (1.33, 1.0, 2.0),\n        (1.33, 1.0, 0.0),\n        (0.1, 1.0, 2.0),\n        (1.33, 10.0, 2.0),\n    ]\n\n    results = []\n    for kF, beta, lam in test_cases:\n        energy = calculate_total_energy_per_particle(kF, beta, lam)\n        results.append(f\"{energy:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_total_energy_per_particle(kF, beta, lam, eta=1e-6):\n    \"\"\"\n    Calculates the total energy per particle for given BHF model parameters.\n\n    Args:\n        kF (float): Fermi momentum.\n        beta (float): Range parameter of the Yamaguchi potential.\n        lam (float): Coupling strength of the Yamaguchi potential.\n        eta (float): Regulator for the principal value integral.\n\n    Returns:\n        float: The total energy per particle E/A.\n    \"\"\"\n    # Kinetic energy per particle for a free Fermi gas in natural units (m=1)\n    E_kin_per_A = (3.0 / 10.0) * kF**2\n\n    # If coupling is zero, potential energy is zero.\n    if lam == 0.0:\n        return E_kin_per_A\n\n    # --- Potential Energy Calculation ---\n\n    # 1. Calculate the integral I_F(kF)\n    # Integrand for I_F\n    def integrand_IF(k):\n        return (k**2) / ((k**2 + beta**2)**2)\n\n    # Numerical integration from 0 to kF\n    integral_val_IF, _ = quad(integrand_IF, 0, kF)\n    I_F_kF = (1.0 / (2.0 * np.pi**2)) * integral_val_IF\n\n    # 2. Calculate the real part of the loop integral, Re[J(omega, kF)]\n    # Integrand for Re[J]\n    def integrand_ReJ(q):\n        # Using kF**2 for omega\n        omega = kF**2\n        g_q_sq = 1.0 / ((q**2 + beta**2)**2)\n        propagator_real_part = (omega - q**2) / ((omega - q**2)**2 + eta**2)\n        return q**2 * g_q_sq * propagator_real_part\n\n    # Numerical integration from kF to infinity\n    integral_val_ReJ, _ = quad(integrand_ReJ, kF, np.inf)\n    ReJ_kF = (1.0 / (2.0 * np.pi**2)) * integral_val_ReJ\n\n    # 3. Calculate the in-medium tau-function\n    tau_kF = -lam / (1.0 + lam * ReJ_kF)\n\n    # 4. Calculate the density rho(kF)\n    rho_kF = (2.0 * kF**3) / (3.0 * np.pi**2)\n\n    # 5. Calculate the potential energy per particle\n    # Effective channel weight d=1\n    E_pot_per_A = (tau_kF / (2.0 * rho_kF)) * (I_F_kF**2)\n\n    # Total energy is the sum of kinetic and potential energies\n    E_total_per_A = E_kin_per_A + E_pot_per_A\n\n    return E_total_per_A\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "在掌握了基本的能量计算之后，我们可以开始探讨一个关键的物理现象：核物质的饱和性。这个实践练习将引导你剖析核相互作用的不同组成部分，特别是分离出非中心的张量力成分所做的贡献。通过对比包含和不包含张量力时的计算结果，你将亲身体会到为何张量力对于真实地描述原子核结合能与饱和密度至关重要。",
            "id": "3545468",
            "problem": "您的任务是编写一个完整的、可运行的程序，在一个简化但有原则的 Brueckner-Hartree-Fock 框架内，量化在 ${}^3S_1$–${}^3D_1$ 通道中关闭张量力诱导的 $S$–$D$ 耦合如何改变对称核物质的饱和点。您必须基于以下基本要素和经过充分检验的近似方法来构建您的模型，并且所有能量必须以兆电子伏特每核子（MeV per nucleon）计算，所有密度以逆立方费米（fm$^{-3}$）计算，所有波数以逆费米（fm$^{-1}$）计算，所有力程以费米（fm）计算。要求的输出是单行内容，包含一个浮点数列表，该列表汇总了下述多个测试参数集的结果。\n\n从以下基础开始：\n\n1.  具有自旋-同位旋简并度 $\\nu = 4$ 的均匀对称核物质。数密度 $\\rho$ 和费米动量 $k_F$ 之间的关系为\n$$\n\\rho = \\frac{\\nu k_F^3}{6\\pi^2} = \\frac{2 k_F^3}{3\\pi^2}.\n$$\n\n2.  非相对论性费米气体中每个核子的动能为\n$$\n\\frac{T}{A} = \\frac{3}{5} \\frac{\\hbar^2 k_F^2}{2m},\n$$\n其中 $\\hbar^2/(2m) = 20.735 \\ \\mathrm{MeV\\,fm^2}$。\n\n3.  在 Hartree-Fock 近似下，由有限程中心力产生的每个核子的势能由坐标空间表达式给出\n$$\n\\frac{E_{\\text{central}}}{A} = \\frac{\\rho}{2} \\int d^3 r \\, V_c(r) \\left[ 1 - \\frac{1}{\\nu} \\, \\ell^2(k_F r) \\right],\n$$\n其中 $\\ell(x) = \\dfrac{3 j_1(x)}{x}$ 是 Slater 函数，$j_1(x)$ 是 1 阶球贝塞尔函数。使用一个双高斯中心势，\n$$\nV_c(r) = V_R \\, e^{-r^2/\\alpha_R^2} + V_A \\, e^{-r^2/\\alpha_A^2},\n$$\n其中 $V_R > 0$ 代表短程排斥，$V_A  0$ 代表中程吸引。执行角向积分，将积分简化为\n$$\n\\frac{E_{\\text{central}}}{A} = \\frac{\\rho}{2} \\int_{0}^{\\infty} 4\\pi r^2 \\, V_c(r) \\left[ 1 - \\frac{1}{\\nu} \\, \\ell^2(k_F r) \\right] \\, dr.\n$$\n\n4.  在自旋饱和物质中，张量力诱导的 ${}^3S_1$–${}^3D_1$ 耦合在 Hartree-Fock 阶没有贡献。为了包含它，通过一个具有高斯形状因子的可分离 $S$–$D$ 核来近似二阶 Brueckner 关联能。将每个核子的张量贡献建模为\n$$\n\\frac{E_{\\text{tensor}}}{A} = - c_0 \\, \\frac{\\hbar^2}{2m} \\, \\frac{1}{\\Lambda} \\, \\frac{J_h(k_F;\\Lambda) \\, J_p(k_F;\\Lambda,\\kappa)}{\\rho},\n$$\n其中 $c_0$ 是一个无量纲强度参数，$\\Lambda$ 是一个动量标度截断，$\\kappa$ 用于正则化平均粒子-空穴能量分母。使用分解的、角平均的积分\n$$\nJ_h(k_F;\\Lambda) = \\int_0^{k_F} h^2 \\, e^{-2h^2/\\Lambda^2} \\, dh, \\quad\nJ_p(k_F;\\Lambda,\\kappa) = \\int_{k_F}^{\\infty} \\frac{p^2 \\, e^{-2p^2/\\Lambda^2}}{p^2 + \\kappa^2} \\, dp.\n$$\n这种因式分解是通过将能量分母近似为仅是粒子动量的函数 $p^2 + \\kappa^2$ 而获得的，这在粒子-空穴激发中粒子动量通常大于空穴动量时是合理的，并且使用了可分离高斯形状因子 $g(k) = e^{-k^2/\\Lambda^2}$ 来描述 ${}^3S_1$–${}^3D_1$ 耦合。\n\n5.  于是，每个核子的总能量为\n$$\n\\frac{E}{A}(k_F; s) = \\frac{T}{A}(k_F) + \\frac{E_{\\text{central}}}{A}(k_F) + s \\, \\frac{E_{\\text{tensor}}}{A}(k_F),\n$$\n其中开关参数 $s \\in \\{0,1\\}$ 代表关闭 ($s=0$) 或开启 ($s=1$) $S$–$D$ 耦合。\n\n您的任务：\n\n- 对于下面测试套件中的每个参数集，计算两种情况下的饱和点：有张量耦合 ($s=1$) 和关闭张量耦合 ($s=0$)。饱和点定义为在指定网格上使 $E/A$ 最小化的 $k_F$ 值。如果 $E/A$ 在网格上是单调的，则将饱和点定义为 $E/A$ 达到其最小值的网格端点。\n- 使用 $\\rho = \\dfrac{2 k_F^3}{3\\pi^2}$ 将每个饱和费米动量转换为饱和密度。\n- 通过计算差异来量化由张量力引起的位移\n$$\n\\Delta \\rho_{\\text{sat}} = \\rho_{\\text{sat}}^{(s=1)} - \\rho_{\\text{sat}}^{(s=0)}, \\qquad\n\\Delta (E/A)_{\\text{sat}} = \\left.\\frac{E}{A}\\right|_{\\text{sat}, s=1} - \\left.\\frac{E}{A}\\right|_{\\text{sat}, s=0}.\n$$\n\n数值计算说明和约定：\n\n- 精确使用 $\\nu = 4$。\n- 精确使用 $\\hbar^2/(2m) = 20.735 \\ \\mathrm{MeV\\,fm^2}$。\n- 对于 Slater 函数，使用 $\\ell(x) = \\dfrac{3 j_1(x)}{x}$，其中 $j_1(x) = \\dfrac{\\sin x}{x^2} - \\dfrac{\\cos x}{x}$，并根据连续性定义 $\\ell(0)=1$。\n- 通过在一个大但有限的上限处截断，对中心能的 $r$ 积分在 $[0, +\\infty)$ 上进行。一个科学上合理的选择是使用等于最大力程参数 8 倍的上限，即 $r_{\\max} = 8 \\, \\max(\\alpha_R,\\alpha_A)$，这对于高斯力程是足够的。\n- 对于张量积分，在 $[0,k_F]$ 上计算 $J_h$，在 $[k_F,+\\infty)$ 上计算 $J_p$，指数形状因子确保收敛。\n- 在一个包含 121 个点的均匀网格 $k_F \\in [0.4, 1.8] \\ \\mathrm{fm^{-1}}$ 上扫描费米动量。\n- 对于每个参数集，按以下顺序返回六个量，并注明单位和进行四舍五入：\n    1. $\\rho_{\\text{sat}}^{(s=1)}$，单位为 fm$^{-3}$，四舍五入到三位小数。\n    2. $\\left.\\dfrac{E}{A}\\right|_{\\text{sat}, s=1}$，单位为 MeV per nucleon，四舍五入到两位小数。\n    3. $\\rho_{\\text{sat}}^{(s=0)}$，单位为 fm$^{-3}$，四舍五入到三位小数。\n    4. $\\left.\\dfrac{E}{A}\\right|_{\\text{sat}, s=0}$，单位为 MeV per nucleon，四舍五入到两位小数。\n    5. $\\Delta \\rho_{\\text{sat}}$，单位为 fm$^{-3}$，四舍五入到三位小数。\n    6. $\\Delta (E/A)_{\\text{sat}}$，单位为 MeV per nucleon，四舍五入到两位小数。\n\n测试套件（每个元组指定 $(V_R,\\alpha_R,V_A,\\alpha_A,c_0,\\Lambda,\\kappa)$，其中 $V_R$ 和 $V_A$ 的单位为 MeV，$\\alpha_R$ 和 $\\alpha_A$ 的单位为 fm，$\\Lambda$ 和 $\\kappa$ 的单位为 fm$^{-1}$）：\n\n- 情况 1（理想路径）：$(650.0, \\ 0.5, \\ -35.0, \\ 1.2, \\ 3.0, \\ 2.0, \\ 1.0)$。\n- 情况 2（弱张量边缘情况）：$(650.0, \\ 0.5, \\ -35.0, \\ 1.2, \\ 0.8, \\ 1.8, \\ 1.0)$。\n- 情况 3（更强的短程排斥）：$(800.0, \\ 0.5, \\ -30.0, \\ 1.2, \\ 3.5, \\ 2.2, \\ 1.3)$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含三个情况的结果，形式为一个用方括号括起来的逗号分隔列表，首先是情况 1 的六个四舍五入后的数字，然后是情况 2 的六个四舍五入后的数字，最后是情况 3 的六个四舍五入后的数字。例如，一个语法正确的输出结构是\n$[\\rho^{(1)}_{\\text{sat}, s=1},E^{(1)}_{\\text{sat}, s=1},\\rho^{(1)}_{\\text{sat}, s=0},E^{(1)}_{\\text{sat}, s=0},\\Delta\\rho^{(1)}_{\\text{sat}},\\Delta E^{(1)}_{\\text{sat}},\\rho^{(2)}_{\\text{sat}, s=1},\\dots,\\Delta E^{(3)}_{\\text{sat}}]$。",
            "solution": "所述问题具有科学依据、提法明确且客观。它提出了一个来自计算核物理的简化但标准的模型，具体来说是一个受 Brueckner-Hartree-Fock 启发的对称核物质框架。模型的所有组成部分，包括费米气体的动能、具有高斯相互作用的 Hartree-Fock 势能，以及用于二阶张量关联的可分离模型，都基于既定原理。所提供的参数、常数和数值说明是完整且一致的。因此可以推导出一个有意义且唯一的解。我们继续进行求解。\n\n目标是确定对称核物质的饱和点——即系统最稳定时的密度 $\\rho_{\\text{sat}}$ 和每核子能量 $(E/A)_{\\text{sat}}$。我们将针对两种情况计算这一点：包含张量力贡献（$s=1$）和不包含它（$s=0$）。然后将量化饱和点的位移。\n\n每核子总能量 $\\frac{E}{A}$ 是费米动量 $k_F$ 和开关参数 $s$ 的函数：\n$$\n\\frac{E}{A}(k_F; s) = \\frac{T}{A}(k_F) + \\frac{E_{\\text{central}}}{A}(k_F) + s \\, \\frac{E_{\\text{tensor}}}{A}(k_F)\n$$\n对于自旋-同位旋对称物质（简并度 $\\nu=4$），费米动量 $k_F$ 与核子数密度 $\\rho$ 的关系为 $\\rho = \\frac{2 k_F^3}{3\\pi^2}$。我们将详细分析能量表达式的每一项。\n\n**1. 每核子动能**\n非相对论性费米气体的平均每核子动能 $\\frac{T}{A}$ 由下式给出：\n$$\n\\frac{T}{A}(k_F) = \\frac{3}{5} \\frac{\\hbar^2 k_F^2}{2m}\n$$\n该项代表了由泡利不相容原理决定的、限制在有限体积内核子们的量子力学运动所产生的能量。我们使用给定的常数 $\\frac{\\hbar^2}{2m} = 20.735 \\ \\mathrm{MeV\\,fm^2}$。\n\n**2. 每核子中心势能**\n来自中心力的贡献 $\\frac{E_{\\text{central}}}{A}$ 是在 Hartree-Fock 近似下计算的。该项考虑了核子之间的直接（Hartree）和交换（Fock）相互作用。提供的公式是：\n$$\n\\frac{E_{\\text{central}}}{A}(k_F) = \\frac{\\rho}{2} \\int_{0}^{\\infty} 4\\pi r^2 \\, V_c(r) \\left[ 1 - \\frac{1}{\\nu} \\, \\ell^2(k_F r) \\right] \\, dr\n$$\n该表达式的组成部分是：\n- $V_c(r) = V_R \\, e^{-r^2/\\alpha_R^2} + V_A \\, e^{-r^2/\\alpha_A^2}$: 一种双程高斯势，一种常见的唯象形式，代表短程排斥（$V_R > 0$）和中程吸引（$V_A  0$）。\n- $\\ell(x) = \\frac{3 j_1(x)}{x}$: Slater 函数，其中 $j_1(x)$ 是一阶球贝塞尔函数。$\\ell^2(k_F r)$ 项源于单体密度矩阵平方的角平均，代表了泡利阻塞效应对介质中两核子相互作用的影响。根据连续性，$\\ell(0)=1$。此积分对每个 $k_F$ 进行数值计算。根据说明，由于势是高斯型的，积分范围在足够大的半径 $r_{\\max} = 8 \\, \\max(\\alpha_R, \\alpha_A)$ 处截断以确保收敛。\n\n**3. 每核子张量关联能**\n对于自旋饱和物质，Hartree-Fock 近似无法捕捉到强张量力的效应，而强张量力是核结合与饱和的关键驱动因素。$\\frac{E_{\\text{tensor}}}{A}$ 项在 Brueckner G-矩阵形式中将此贡献建模为二阶微扰。给出的公式是：\n$$\n\\frac{E_{\\text{tensor}}}{A}(k_F) = - c_0 \\, \\frac{\\hbar^2}{2m} \\, \\frac{1}{\\Lambda} \\, \\frac{J_h(k_F;\\Lambda) \\, J_p(k_F;\\Lambda,\\kappa)}{\\rho}\n$$\n该表达式近似了由张量力耦合 ${}^3S_1$ 和 ${}^3D_1$ 分波所诱导的虚粒子-空穴激发带来的能量增益。其组成部分是：\n- $J_h(k_F;\\Lambda) = \\int_0^{k_F} h^2 \\, e^{-2h^2/\\Lambda^2} \\, dh$: 一个对达到费米动量 $k_F$ 的已占据“空穴”态的积分。\n- $J_p(k_F;\\Lambda,\\kappa) = \\int_{k_F}^{\\infty} \\frac{p^2 \\, e^{-2p^2/\\Lambda^2}}{p^2 + \\kappa^2} \\, dp$: 一个对高于 $k_F$ 的未占据“粒子”态的积分。\n- 高斯形状因子 $e^{-k^2/\\Lambda^2}$ 反映了动量空间中相互作用的有限程。$\\frac{1}{p^2+\\kappa^2}$ 项是一个简化的角平均能量分母，其中 $\\kappa$ 代表一个平均激发能标。负号表示这个二阶项是吸引的。这些积分是数值计算的。\n\n**计算步骤**\n任务的核心是实现一个程序来计算 $\\frac{E}{A}$ 作为 $k_F$ 的函数并找到其最小值。\n1.  在区间 $[0.4, 1.8] \\ \\mathrm{fm^{-1}}$ 内建立一个包含 121 个点的 $k_F$ 均匀网格。\n2.  对于测试套件中提供的每个参数集：\n    a. 我们计算 $s=1$（张量力开启）和 $s=0$（张量力关闭）两种情况下整个网格上的每核子能量曲线 $\\frac{E}{A}(k_F)$。这涉及到为每个 $k_F$ 值计算三个能量分量，对中心势和张量势项使用数值积分（`scipy.integrate.quad`）。\n    b. 通过在网格上找到使 $\\frac{E}{A}$ 最小化的 $k_F$ 值来确定每种情况的饱和点。如果函数在网格上是单调的，则将饱和点取为能量较低的网格端点。\n    c. 饱和费米动量 $k_{F, \\text{sat}}$ 用于计算饱和密度 $\\rho_{\\text{sat}} = \\frac{2 k_{F, \\text{sat}}^3}{3\\pi^2}$。相应的最小能量是 $(E/A)_{\\text{sat}}$。\n    d. 最后，计算差异 $\\Delta \\rho_{\\text{sat}} = \\rho_{\\text{sat}}^{(s=1)} - \\rho_{\\text{sat}}^{(s=0)}$ 和 $\\Delta (E/A)_{\\text{sat}} = (E/A)_{\\text{sat}}^{(s=1)} - (E/A)_{\\text{sat}}^{(s=0)}$，以量化张量力的影响。\n3.  将每个测试用例的六个结果量按规定进行四舍五入，并汇总到单个输出列表中。\n\n该实现将被封装在一个 Python 程序中，利用 `numpy` 和 `scipy` 库进行数值计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.special import spherical_jn\n\ndef solve():\n    \"\"\"\n    Computes the saturation point of symmetric nuclear matter using a\n    simplified Brueckner-Hartree-Fock framework and quantifies the shift\n    due to the tensor force.\n    \"\"\"\n\n    # --- Fixed Physical and Model Constants ---\n    HBAR2_OVER_2M = 20.735  # MeV*fm^2\n    NU = 4.0  # Spin-isospin degeneracy\n\n    # --- Test Cases ---\n    # Each tuple: (V_R, alpha_R, V_A, alpha_A, c0, Lambda, kappa)\n    test_cases = [\n        (650.0, 0.5, -35.0, 1.2, 3.0, 2.0, 1.0),\n        (650.0, 0.5, -35.0, 1.2, 0.8, 1.8, 1.0),\n        (800.0, 0.5, -30.0, 1.2, 3.5, 2.2, 1.3),\n    ]\n\n    # --- Numerical Grid ---\n    kF_grid = np.linspace(0.4, 1.8, 121)\n\n    # --- Helper Functions for Energy Calculation ---\n\n    def _density(kF):\n        \"\"\"Calculates nucleon number density from Fermi momentum.\"\"\"\n        return 2.0 * kF**3 / (3.0 * np.pi**2)\n\n    def _kinetic_energy_per_nucleon(kF):\n        \"\"\"Calculates kinetic energy per nucleon.\"\"\"\n        return (3.0 / 5.0) * HBAR2_OVER_2M * kF**2\n\n    def _slater_l(x):\n        \"\"\"\n        Calculates the Slater function l(x) = 3*j1(x)/x.\n        Handles the x=0 case by using the known limit l(0)=1.\n        \"\"\"\n        if np.isclose(x, 0.0):\n            return 1.0\n        # For precision, use spherical_jn(1,x) which computes j_1(x)\n        return 3.0 * spherical_jn(1, x) / x\n\n    def _central_energy_per_nucleon(kF, params):\n        \"\"\"Calculates the central potential energy per nucleon.\"\"\"\n        V_R, alpha_R, V_A, alpha_A, _, _, _ = params\n        rho = _density(kF)\n\n        def Vc(r):\n            return V_R * np.exp(-r**2 / alpha_R**2) + V_A * np.exp(-r**2 / alpha_A**2)\n\n        def integrand(r):\n            slater_term = _slater_l(kF * r)\n            return 4.0 * np.pi * r**2 * Vc(r) * (1.0 - (1.0 / NU) * slater_term**2)\n\n        r_max = 8.0 * max(alpha_R, alpha_A)\n        # The integral from 0 to r_max\n        integral_val, _ = quad(integrand, 0, r_max, epsabs=1e-9, limit=100)\n\n        return (rho / 2.0) * integral_val\n\n    def _tensor_energy_per_nucleon(kF, params):\n        \"\"\"Calculates the tensor correlation energy per nucleon.\"\"\"\n        _, _, _, _, c0, Lambda, kappa = params\n        \n        if np.isclose(kF, 0.0):\n            return 0.0\n\n        rho = _density(kF)\n\n        # J_h integral\n        def jh_integrand(h):\n            return h**2 * np.exp(-2.0 * h**2 / Lambda**2)\n\n        Jh, _ = quad(jh_integrand, 0, kF, epsabs=1e-9, limit=100)\n\n        # J_p integral\n        def jp_integrand(p):\n            return (p**2 * np.exp(-2.0 * p**2 / Lambda**2)) / (p**2 + kappa**2)\n\n        Jp, _ = quad(jp_integrand, kF, np.inf, epsabs=1e-9, limit=100)\n\n        return -c0 * HBAR2_OVER_2M * (1.0 / Lambda) * (Jh * Jp / rho)\n\n    def _get_saturation_properties(params, s, kF_grid):\n        \"\"\"\n        Calculates the energy-density curve and finds the saturation point.\n        s=1 for tensor ON, s=0 for tensor OFF.\n        \"\"\"\n        energies = []\n        # Pre-calculate central energies as they are independent of 's'\n        central_energies = {kF: _central_energy_per_nucleon(kF, params) for kF in kF_grid}\n\n        for kF in kF_grid:\n            e_kin = _kinetic_energy_per_nucleon(kF)\n            e_cen = central_energies[kF]\n            e_ten = 0.0\n            if s == 1:\n                e_ten = _tensor_energy_per_nucleon(kF, params)\n            \n            total_energy = e_kin + e_cen + e_ten\n            energies.append(total_energy)\n        \n        energies = np.array(energies)\n        idx_min = np.argmin(energies)\n        \n        e_sat = energies[idx_min]\n        kF_sat = kF_grid[idx_min]\n        rho_sat = _density(kF_sat)\n        \n        return rho_sat, e_sat\n\n    # --- Main Loop to Process Test Cases ---\n    final_results = []\n    for params in test_cases:\n        # Scenario s=1 (Tensor ON)\n        rho_sat_s1, e_sat_s1 = _get_saturation_properties(params, 1, kF_grid)\n\n        # Scenario s=0 (Tensor OFF)\n        rho_sat_s0, e_sat_s0 = _get_saturation_properties(params, 0, kF_grid)\n\n        # Differences\n        delta_rho = rho_sat_s1 - rho_sat_s0\n        delta_e = e_sat_s1 - e_sat_s0\n\n        # Store rounded results in the required order\n        final_results.extend([\n            round(rho_sat_s1, 3), round(e_sat_s1, 2),\n            round(rho_sat_s0, 3), round(e_sat_s0, 2),\n            round(delta_rho, 3), round(delta_e, 2)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "这是一个旨在检验多体理论自洽性的进阶练习。胡根霍尔茲-范霍夫（Hugenholtz-Van Hove）定理建立了单粒子性质与系统宏观热力学性质之间的深刻联系。此练习将指导你通过数值计算来检验这一定理，并让你理解密度依赖相互作用以及由此产生的重排能项的深远意义，这些都是高级多体理论的基石。",
            "id": "3545559",
            "problem": "你的任务是在一个简化的 Brueckner–Hartree–Fock (BHF) 框架内，为零温下的无限对称核物质构建一个最小的、自洽的 Hugenholtz–Van Hove (HVH) 定理数值检验程序。该实现必须是一个完整、可运行的程序。目标是数值验证在连续选择下，饱和密度处的 HVH 等式是否满足，并量化当对单粒子势或泡利阻塞算符的处理进行近似时出现的偏差。\n\n从以下基本定义和模型假设开始：\n\n- 无限对称核物质是一个均匀的费米体系，其自旋-同位旋简并度为 $g = 4$。数密度为 $\\,\\rho\\,$ (单位 $\\mathrm{fm}^{-3}$)，费米动量为 $\\,k_F\\,$ (单位 $\\mathrm{fm}^{-1}$)，核子质量为 $\\,m_N\\,$ (单位 $\\mathrm{MeV}$)。使用 $\\,\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}\\,$ 和 $c=1$ 的自然单位制。\n- 密度和费米动量之间的关系为\n$$\n\\rho = \\frac{g\\,k_F^3}{6\\pi^2} \\quad\\Rightarrow\\quad k_F(\\rho) = \\left(\\frac{6\\pi^2}{g}\\rho\\right)^{1/3}.\n$$\n- 单粒子动能为 $\\,t(k) = \\frac{\\hbar^2 k^2}{2 m_N}\\,$。零温下自由费米气体每个粒子的能量为\n$$\n\\frac{T}{A}(\\rho) = \\frac{3}{5} \\frac{\\hbar^2 k_F(\\rho)^2}{2 m_N}.\n$$\n- 通过一个依赖于密度的有效 Brueckner $G$ 矩阵来模拟相互作用，其形式为\n$$\nG(\\rho) = g_0 + g_1 \\rho^\\beta,\n$$\n其中 $g_0$ 和 $g_1$ 是待标定的参数（具有适当的单位），而 $\\beta0$ 是一个固定指数，它编码了中间态泡利阻塞和关联强度的定性效应。每个粒子的相互作用能为\n$$\n\\left(\\frac{V}{A}\\right)(\\rho) = \\frac{1}{2}\\,\\rho\\,G(\\rho).\n$$\n- 每个粒子的总能量为\n$$\ne(\\rho) \\equiv \\frac{E}{A}(\\rho) = \\frac{T}{A}(\\rho) + \\frac{1}{2}\\,\\rho\\,G(\\rho).\n$$\n- 能量密度为 $\\,\\varepsilon(\\rho) = \\rho\\,e(\\rho)\\,$。化学势（零温）由热力学导数定义\n$$\n\\mu(\\rho) = \\frac{\\partial \\varepsilon}{\\partial \\rho}(\\rho).\n$$\n- 压强为\n$$\np(\\rho) = \\rho^2\\,\\frac{d e}{d \\rho}(\\rho).\n$$\n- 在连续选择下，单粒子势 $\\,U(k;\\rho)\\,$ 对所有 $\\,k\\,$ 都有定义，并且在局域密度平均场近似中，其在费米面上的值包含由 $\\,G(\\rho)\\,$ 的密度依赖性引起的重排贡献。考虑两种近似：\n  1. 不考虑重排：\n  $$\n  U_{\\text{noR}}(k_F;\\rho) = \\rho\\,G(\\rho).\n  $$\n  2. 考虑重排：\n  $$\n  U_{\\text{R}}(k_F;\\rho) = \\frac{\\partial}{\\partial \\rho}\\left[\\frac{1}{2}\\rho^2 G(\\rho)\\right] = \\rho\\,G(\\rho) + \\frac{1}{2}\\rho^2\\,\\frac{dG}{d\\rho}(\\rho),\n  \\quad\\text{其中}\\quad\n  \\frac{dG}{d\\rho}(\\rho) = \\beta g_1 \\rho^{\\beta-1}.\n  $$\n- 费米面上的单粒子能量为\n$$\n\\varepsilon_{\\text{sp}}(k_F;\\rho) = t(k_F) + U(k_F;\\rho),\n$$\n其中 $\\,U=U_{\\text{noR}}\\,$ 或 $\\,U=U_{\\text{R}}\\,$，取决于所选的近似。\n\n在饱和点进行标定：\n- 设经验饱和密度为 $\\,\\rho_0 = 0.16\\,\\mathrm{fm}^{-3}\\,$，每个粒子的饱和能量为 $\\,e(\\rho_0) = e_0 = -16\\,\\mathrm{MeV}\\,$。饱和意味着 $\\,p(\\rho_0) = 0\\,$。对于给定的指数 $\\,\\beta\\,$，通过同时强制满足 $\\,e(\\rho_0)=e_0\\,$ 和 $\\,p(\\rho_0)=0\\,$ 来确定 $\\,g_0\\,$ 和 $\\,g_1\\,$。这两个约束条件必须使用上述定义精确求解。\n\n需要执行的数值检验：\n- 对每个测试用例，计算：\n  1. HVH 热力学残差\n  $$\n  R_e(\\rho) = \\mu(\\rho) - \\left[e(\\rho) + \\frac{p(\\rho)}{\\rho}\\right],\n  $$\n  以 $\\mathrm{MeV}$ 为单位表示。HVH 定理指出，对于零温下的费米液体，$\\,\\mu(\\rho) = e(\\rho) + p(\\rho)/\\rho\\,$。\n  2. HVH 单粒子残差\n  $$\n  R_{\\text{sp}}(\\rho) = \\mu(\\rho) - \\varepsilon_{\\text{sp}}(k_F;\\rho),\n  $$\n  以 $\\mathrm{MeV}$ 为单位表示。在具有完全自洽性的连续选择下，HVH 要求 $\\,\\mu(\\rho) = \\varepsilon_{\\text{sp}}(k_F;\\rho)\\,$。\n\n物理单位和常数：\n- 能量以 $\\mathrm{MeV}$ 表示，密度以 $\\mathrm{fm}^{-3}$ 表示，动量以 $\\mathrm{fm}^{-1}$ 表示。使用 $\\,m_N = 938.918\\,\\mathrm{MeV}\\,$ 和 $\\,\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}\\,$。不涉及角度，无需指定。\n\n测试套件：\n- 实现以下四个用例，以探究不同方面和边缘条件：\n  1. 用例 A（理想情况，饱和密度下考虑重排的连续选择）：$\\,\\rho=\\rho_0\\,$, $\\,\\beta=1.25\\,$, $\\,U=U_{\\text{R}}\\,$。\n  2. 用例 B（饱和密度下忽略重排所导致的偏差）：$\\,\\rho=\\rho_0\\,$, $\\,\\beta=1.25\\,$, $\\,U=U_{\\text{noR}}\\,$。\n  3. 用例 C（低密度边界，考虑重排的连续选择）：$\\,\\rho=10^{-3}\\,\\mathrm{fm}^{-3}\\,$, $\\,\\beta=1.25\\,$, $\\,U=U_{\\text{R}}\\,$，使用在 $\\,\\rho_0\\,$ 处标定的相同 $\\,g_0,g_1\\,$。\n  4. 用例 D（修正的密度依赖性，模拟角度平均的泡利算符效应，忽略重排）：$\\,\\rho=\\rho_0\\,$, $\\,\\beta=0.50\\,$, $\\,U=U_{\\text{noR}}\\,$。\n\n输出规范：\n- 你的程序应产生单行输出，其中包含四个用例的八个残差值，格式为逗号分隔的列表，包含在方括号中，顺序如下\n$$\n[R_e^{A}, R_{\\text{sp}}^{A}, R_e^{B}, R_{\\text{sp}}^{B}, R_e^{C}, R_{\\text{sp}}^{C}, R_e^{D}, R_{\\text{sp}}^{D}],\n$$\n每个值都四舍五入到六位小数，单位为 $\\mathrm{MeV}$。例如，一个有效的输出格式是\n$$\n[\\text{float}_1,\\text{float}_2,\\ldots,\\text{float}_8].\n$$\n\n你的实现必须严格遵守指定的单位。程序必须是自包含的，不需要输入，并且可直接运行。它必须为每个选定的 $\\,\\beta\\,$ 通过饱和约束计算 $\\,g_0\\,$ 和 $\\,g_1\\,$，然后如上所述在四个用例中评估残差 $\\,R_e\\,$ 和 $\\,R_{\\text{sp}}\\,$，最后以指定的确切格式打印单行输出。",
            "solution": "该问题要求在一个简化的 Brueckner–Hartree–Fock (BHF) 模型中对无限对称核物质的 Hugenholtz–Van Hove (HVH) 定理进行数值验证。这涉及为核子-核子相互作用标定一个模型，计算关键的热力学和单粒子量，然后评估两个特定的残差，以量化在不同物理近似下对 HVH 定理的遵循或偏离情况。\n\n**1. 理论框架和模型定义**\n\n该模型将无限对称核物质描述为自旋-同位旋简并度 $g=4$ 的零温费米气体。系统的状态由核子数密度 $\\rho$ 定义。\n\n- **动能：** 动能贡献是自由费米气体的动能贡献。费米动量 $k_F$ 与密度 $\\rho$ 的关系为 $k_F(\\rho) = (6\\pi^2\\rho/g)^{1/3}$。平均每个粒子的动能为\n$$\n\\frac{T}{A}(\\rho) = \\frac{3}{5} t(k_F(\\rho)) = \\frac{3}{5} \\frac{\\hbar^2 k_F(\\rho)^2}{2 m_N}\n$$\n其中 $t(k) = \\hbar^2 k^2/(2m_N)$ 是单粒子动能。为了实现，我们定义一个常数 $C_{\\text{kin}} = \\hbar^2/(2m_N) = (\\hbar c)^2/(2 m_N c^2)$，其中给定的值为 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$ 和 $m_N = 938.918\\,\\mathrm{MeV}$。\n\n- **相互作用能：** 相互作用通过一个依赖于密度的有效 $G$ 矩阵 $G(\\rho) = g_0 + g_1 \\rho^\\beta$ 来建模。参数 $g_0$ 和 $g_1$ 将通过标定确定，而 $\\beta$ 是一个给定的指数。每个粒子的相互作用能由下式给出\n$$\n\\left(\\frac{V}{A}\\right)(\\rho) = \\frac{1}{2}\\,\\rho\\,G(\\rho) = \\frac{1}{2}g_0\\rho + \\frac{1}{2}g_1\\rho^{1+\\beta}\n$$\n\n- **每个粒子的总能量：** 每个粒子的总能量 $e(\\rho)$ 是动能和势能贡献之和：\n$$\ne(\\rho) = \\frac{E}{A}(\\rho) = \\frac{T}{A}(\\rho) + \\frac{1}{2}\\rho G(\\rho) = C_{\\text{kin}} \\frac{3}{5} \\left(\\frac{6\\pi^2}{g}\\right)^{2/3}\\rho^{2/3} + \\frac{1}{2}g_0\\rho + \\frac{1}{2}g_1\\rho^{1+\\beta}\n$$\n\n**2. 导出量和 HVH 定理**\n\n从每个粒子的能量 $e(\\rho)$，我们导出其他基本的热力学量。\n\n- **压强 ($p$)：** 零温下的压强由 $p(\\rho) = \\rho^2 \\frac{de}{d\\rho}$ 给出。核物质的饱和条件意味着在饱和密度 $\\rho_0$ 时，压强为零，即 $\\frac{de}{d\\rho}|_{\\rho=\\rho_0} = 0$。\n\n- **化学势 ($\\mu$)：** 化学势是总能量密度 $\\varepsilon(\\rho) = \\rho e(\\rho)$ 对密度的导数：\n$$\n\\mu(\\rho) = \\frac{\\partial \\varepsilon}{\\partial \\rho} = \\frac{\\partial}{\\partial \\rho}(\\rho e(\\rho)) = e(\\rho) + \\rho \\frac{de}{d\\rho}\n$$\n\n- **Hugenholtz-Van Hove 定理：** HVH 定理提供了基本的自洽性关系。\n    1.  **热力学关系：** 第一个关系连接了化学势、每个粒子的能量和压强：$\\mu(\\rho) = e(\\rho) + p(\\rho)/\\rho$。代入定义 $p(\\rho) = \\rho^2 \\frac{de}{d\\rho}$ 和 $\\mu(\\rho) = e(\\rho) + \\rho \\frac{de}{d\\rho}$，我们看到这个恒等式根据定义成立：\n    $$\n    e(\\rho) + \\frac{p(\\rho)}{\\rho} = e(\\rho) + \\frac{\\rho^2 \\frac{de}{d\\rho}}{\\rho} = e(\\rho) + \\rho \\frac{de}{d\\rho} = \\mu(\\rho)\n    $$\n    因此，热力学残差 $R_e(\\rho) = \\mu(\\rho) - [e(\\rho) + p(\\rho)/\\rho]$ 必须解析上为零。$R_e$ 的非零数值结果将表明热力学导数的实现存在不一致性。\n\n    2.  **单粒子关系：** 定理的第二部分指出，在自洽计算中，化学势等于费米面上的单粒子能量，即 $\\mu(\\rho) = \\varepsilon_{\\text{sp}}(k_F;\\rho)$。让我们推导 $\\mu(\\rho)$ 的显式表达式：\n    $$\n    \\mu(\\rho) = \\frac{5}{3}\\frac{T}{A}(\\rho) + \\rho G(\\rho) + \\frac{1}{2}\\rho^2 \\frac{dG}{d\\rho}(\\rho)\n    $$\n    由于 $\\frac{T}{A}(\\rho) = \\frac{3}{5}t(k_F(\\rho))$，这简化为：\n    $$\n    \\mu(\\rho) = t(k_F(\\rho)) + \\rho G(\\rho) + \\frac{1}{2}\\rho^2 \\frac{dG}{d\\rho}(\\rho)\n    $$\n    费米面上的单粒子能量为 $\\varepsilon_{\\text{sp}}(k_F;\\rho) = t(k_F) + U(k_F;\\rho)$。问题定义了单粒子势 $U$ 的两种近似：\n    -   不考虑重排：$U_{\\text{noR}}(k_F;\\rho) = \\rho G(\\rho)$。\n    -   考虑重排：$U_{\\text{R}}(k_F;\\rho) = \\rho G(\\rho) + \\frac{1}{2}\\rho^2 \\frac{dG}{d\\rho}(\\rho)$。\n    单粒子残差为 $R_{\\text{sp}}(\\rho) = \\mu(\\rho) - \\varepsilon_{\\text{sp}}(k_F;\\rho)$。\n    -   如果 $U=U_{\\text{R}}$，则 $\\varepsilon_{\\text{sp}}(k_F;\\rho) = t(k_F) + U_{\\text{R}} = t(k_F) + \\rho G + \\frac{1}{2}\\rho^2 \\frac{dG}{d\\rho} = \\mu(\\rho)$。因此，$R_{\\text{sp}}$ 应解析上为零。这种 $U$ 的选择在满足 HVH 定理的意义上是“自洽”的。\n    -   如果 $U=U_{\\text{noR}}$，则 $\\varepsilon_{\\text{sp}}(k_F;\\rho) = t(k_F) + U_{\\text{noR}} = t(k_F) + \\rho G$。残差变为 $R_{\\text{sp}} = \\mu(\\rho) - \\varepsilon_{\\text{sp}} = \\frac{1}{2}\\rho^2 \\frac{dG}{d\\rho}(\\rho)$。这个残差不为零，它分离出了对化学势的“重排”贡献，而该贡献在 $U_{\\text{noR}}$ 近似中被忽略了。\n\n**3. 模型参数的标定**\n\n对于给定的指数 $\\beta$，参数 $g_0$ 和 $g_1$ 通过在饱和密度 $\\rho_0 = 0.16\\,\\mathrm{fm}^{-3}$ 处强制满足两个经验条件来确定：\n1.  $e(\\rho_0) = e_0 = -16\\,\\mathrm{MeV}$\n2.  $p(\\rho_0) = 0 \\implies \\frac{de}{d\\rho}|_{\\rho=\\rho_0} = 0$\n\n这两个条件构成了一个关于 $g_0$ 和 $g_1$ 的二元线性方程组：\n1.  $\\frac{T}{A}(\\rho_0) + \\frac{1}{2}g_0\\rho_0 + \\frac{1}{2}g_1\\rho_0^{1+\\beta} = e_0$\n2.  $\\frac{d}{d\\rho}\\left(\\frac{T}{A}\\right)\\Big|_{\\rho_0} + \\frac{1}{2}g_0 + \\frac{1}{2}(1+\\beta)g_1\\rho_0^\\beta = 0$\n\n使用 $\\frac{d}{d\\rho}(\\frac{T}{A}) = \\frac{2}{3\\rho}\\frac{T}{A}(\\rho)$，该方程组可以解析求解出 $g_0$ 和 $g_1$：\n$$\ng_1 = \\frac{\\frac{2}{3\\rho_0}\\frac{T}{A}(\\rho_0) - 2 \\left(e_0 - \\frac{T}{A}(\\rho_0)\\right)/\\rho_0}{\\beta \\rho_0^\\beta}\n$$\n这可以简化为：\n$$\ng_1 = \\frac{\\frac{5}{3\\rho_0}T/A(\\rho_0) - e_0/\\rho_0}{\\beta/2 \\rho_0^\\beta}\n$$\n还有一个更简单的推导。从 $e = T/A + V/A$ 和 $\\mu = e + p/\\rho$ 出发，在 $\\rho_0$ 处，$p=0$, 所以 $\\mu=e_0$。又因为 $\\mu = \\frac{d(\\rho e)}{d\\rho} = \\frac{d(\\rho T/A + \\rho V/A)}{d\\rho}$。在$\\rho_0$处，$\\frac{de}{d\\rho}=0$，所以 $\\mu=e_0$。\n让我们重新解这个方程组。\n方程1: $g_0\\rho_0 + g_1\\rho_0^{1+\\beta} = 2(e_0 - T/A(\\rho_0))$\n方程2: $\\frac{1}{2}g_0 + \\frac{1}{2}(1+\\beta)g_1\\rho_0^{\\beta} = -\\frac{d(T/A)}{d\\rho}|_{\\rho_0} = -\\frac{2}{3\\rho_0}T/A(\\rho_0)$\n从方程2得到 $g_0 = - (1+\\beta)g_1\\rho_0^\\beta - \\frac{4}{3\\rho_0}T/A(\\rho_0)$。\n代入方程1:\n$[- (1+\\beta)g_1\\rho_0^\\beta - \\frac{4}{3\\rho_0}T/A(\\rho_0)]\\rho_0 + g_1\\rho_0^{1+\\beta} = 2e_0 - 2T/A(\\rho_0)$\n$-(1+\\beta)g_1\\rho_0^{1+\\beta} - \\frac{4}{3}T/A(\\rho_0) + g_1\\rho_0^{1+\\beta} = 2e_0 - 2T/A(\\rho_0)$\n$-\\beta g_1\\rho_0^{1+\\beta} = 2e_0 - \\frac{2}{3}T/A(\\rho_0)$\n$$\ng_1 = -\\frac{2e_0 - \\frac{2}{3}T/A(\\rho_0)}{\\beta \\rho_0^{1+\\beta}}\n$$\n$$\ng_0 = \\frac{2(e_0 - T/A(\\rho_0))}{\\rho_0} - g_1\\rho_0^\\beta\n$$\n对于测试用例中指定的每个 $\\beta$ 值，都必须执行此标定。\n\n**4. 数值实现策略**\n\n解决方案在 Python 中实现。一个名为 `NuclearMatterModel` 的类封装了物理逻辑。\n- 为特定的 $\\beta$ 值创建一个类的实例。像 $m_N$ 和 $\\hbar c$ 这样的常数被初始化。\n- `calibrate` 方法实现了 $g_0$ 和 $g_1$ 的解析解，并将它们存储为实例属性。\n- 所有物理量（$k_F$、$T/A$、$e$、$p$、$\\mu$、$U_{\\text{noR}}$、$U_{\\text{R}}$、$\\varepsilon_{\\text{sp}}$）的方法都是基于推导出的公式实现的。特别注意使用数值上稳定且高效的表达式，例如 $\\mu(\\rho)$ 的直接解析公式。\n- 一个主函数组织测试套件的执行。它为 $\\beta=1.25$ 和 $\\beta=0.50$ 创建模型实例，对它们进行标定，然后遍历四个指定的测试用例。\n- 对于每个用例，它调用一个方法来计算两个残差 $R_e$ 和 $R_{\\text{sp}}$，使用合适的密度 $\\rho$ 和单粒子势选择 $U$。\n- 将得到的八个残差值收集起来，格式化为六位小数，并以指定的列表格式打印。预期结果是所有情况下 $R_e$ 的值接近零，用例 A 和 C 中 $R_{\\text{sp}}$ 的值接近零，而用例 B 和 D 中 $R_{\\text{sp}}$ 的值不为零，这反映了正在测试的物理近似。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational nuclear physics problem to check the Hugenholtz-Van Hove theorem.\n    \"\"\"\n\n    # Define physical constants and saturation properties\n    HBARC = 197.3269804  # MeV fm\n    M_N = 938.918      # MeV (mass of nucleon, m_N*c^2)\n    G_DEGEN = 4          # Spin-isospin degeneracy for symmetric nuclear matter\n    RHO_0 = 0.16         # Saturation density in fm^-3\n    E_0 = -16.0          # Saturation energy per particle in MeV\n\n    class NuclearMatterModel:\n        \"\"\"\n        Encapsulates the physics of the simplified BHF model for nuclear matter.\n        \"\"\"\n        def __init__(self, beta, g_degen, m_n, hbarc):\n            self.beta = beta\n            self.g_degen = g_degen\n            self.m_n = m_n\n            self.hbarc = hbarc\n            \n            # Pre-calculate kinetic energy constant\n            self.c_kin = self.hbarc**2 / (2 * self.m_n)  # This is hbar^2/(2m) in units of MeV*fm^2\n            \n            self.g0 = None\n            self.g1 = None\n\n        def k_F(self, rho):\n            \"\"\"Calculates the Fermi momentum k_F in fm^-1.\"\"\"\n            if rho = 0: return 0.0\n            return (6 * np.pi**2 * rho / self.g_degen)**(1/3)\n\n        def T_per_A(self, rho):\n            \"\"\"Calculates the kinetic energy per nucleon T/A in MeV.\"\"\"\n            if rho = 0: return 0.0\n            kf_sq = self.k_F(rho)**2\n            return (3/5) * self.c_kin * kf_sq\n\n        def calibrate(self, rho0, e0):\n            \"\"\"\n            Calibrates g0 and g1 parameters using saturation properties.\n            \"\"\"\n            t_A_at_rho0 = self.T_per_A(rho0)\n            \n            # From the saturation condition p(rho0)=0 => de/drho(rho0)=0\n            # and e(rho0)=e0, we derive g0 and g1.\n            \n            # Solve for g1\n            numerator_g1 = 2 * e0 - (2/3) * t_A_at_rho0\n            denominator_g1 = -self.beta * rho0**(self.beta + 1)\n            self.g1 = numerator_g1 / denominator_g1\n\n            # Solve for g0\n            term1_g0 = 2 * (e0 - t_A_at_rho0) / rho0\n            term2_g0 = self.g1 * rho0**self.beta\n            self.g0 = term1_g0 - term2_g0\n\n        def G_matrix(self, rho):\n            \"\"\"Calculates the effective G-matrix interaction.\"\"\"\n            if rho = 0: return self.g0 # Trivial low-density limit\n            return self.g0 + self.g1 * rho**self.beta\n\n        def dG_drho(self, rho):\n            \"\"\"Calculates the derivative of the G-matrix w.r.t. density.\"\"\"\n            if rho = 0 or self.beta == 0: return 0.0\n            return self.beta * self.g1 * rho**(self.beta - 1)\n\n        def energy_per_particle(self, rho):\n            \"\"\"Calculates the total energy per particle e(rho) in MeV.\"\"\"\n            return self.T_per_A(rho) + 0.5 * rho * self.G_matrix(rho)\n\n        def de_drho(self, rho):\n            \"\"\"Calculates the derivative of energy per particle w.r.t. density.\"\"\"\n            if rho = 0: return 0.0 # Approximation for low density\n            dt_drho = (2/3) * self.T_per_A(rho) / rho\n            return dt_drho + 0.5 * self.G_matrix(rho) + 0.5 * rho * self.dG_drho(rho)\n\n        def pressure(self, rho):\n            \"\"\"Calculates the pressure p(rho) in MeV/fm^3.\"\"\"\n            if rho = 0: return 0.0\n            return rho**2 * self.de_drho(rho)\n\n        def chemical_potential(self, rho):\n            \"\"\"Calculates the chemical potential mu(rho) in MeV.\"\"\"\n            if rho = 0: return 0.0\n            # Analytically simplified form derived from mu = e + rho * de/drho\n            t_kF = self.c_kin * self.k_F(rho)**2\n            g_val = self.G_matrix(rho)\n            dg_drho_val = self.dG_drho(rho)\n            return t_kF + rho * g_val + 0.5 * rho**2 * dg_drho_val\n\n        def sp_energy_kF(self, rho, U_type):\n            \"\"\"\n            Calculates the single-particle energy at the Fermi surface in MeV.\n            U_type can be 'R' (with rearrangement) or 'noR' (without).\n            \"\"\"\n            t_kF = self.c_kin * self.k_F(rho)**2\n            g_val = self.G_matrix(rho)\n\n            if U_type == 'R':\n                dg_drho_val = self.dG_drho(rho)\n                U_val = rho * g_val + 0.5 * rho**2 * dg_drho_val\n            elif U_type == 'noR':\n                U_val = rho * g_val\n            else:\n                raise ValueError(\"Invalid U_type specified.\")\n            \n            return t_kF + U_val\n\n        def calculate_residuals(self, rho, U_type):\n            \"\"\"Calculates the thermodynamic and single-particle HVH residuals.\"\"\"\n            e = self.energy_per_particle(rho)\n            p = self.pressure(rho)\n            mu = self.chemical_potential(rho)\n            esp_kF = self.sp_energy_kF(rho, U_type)\n\n            # Thermodynamic residual: R_e = mu - (e + p/rho)\n            # This should be numerically zero if thermodynamics are consistent.\n            R_e = mu - (e + p / rho) if rho > 0 else mu - e\n\n            # Single-particle residual: R_sp = mu - esp(kF)\n            R_sp = mu - esp_kF\n            \n            return R_e, R_sp\n\n    # Define the test cases\n    test_cases = [\n        {'id': 'A', 'rho': RHO_0, 'beta': 1.25, 'U_type': 'R'},\n        {'id': 'B', 'rho': RHO_0, 'beta': 1.25, 'U_type': 'noR'},\n        {'id': 'C', 'rho': 1e-3, 'beta': 1.25, 'U_type': 'R'},\n        {'id': 'D', 'rho': RHO_0, 'beta': 0.50, 'U_type': 'noR'},\n    ]\n\n    # Pre-calibrate models for each beta value to avoid redundant calculations\n    model_beta_1_25 = NuclearMatterModel(beta=1.25, g_degen=G_DEGEN, m_n=M_N, hbarc=HBARC)\n    model_beta_1_25.calibrate(RHO_0, E_0)\n\n    model_beta_0_50 = NuclearMatterModel(beta=0.50, g_degen=G_DEGEN, m_n=M_N, hbarc=HBARC)\n    model_beta_0_50.calibrate(RHO_0, E_0)\n    \n    models = {1.25: model_beta_1_25, 0.50: model_beta_0_50}\n\n    results = []\n    for case in test_cases:\n        model = models[case['beta']]\n        Re, Rsp = model.calculate_residuals(case['rho'], case['U_type'])\n        results.extend([Re, Rsp])\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join([f'{x:.6f}' for x in results])}]\")\n\nsolve()\n\n```"
        }
    ]
}