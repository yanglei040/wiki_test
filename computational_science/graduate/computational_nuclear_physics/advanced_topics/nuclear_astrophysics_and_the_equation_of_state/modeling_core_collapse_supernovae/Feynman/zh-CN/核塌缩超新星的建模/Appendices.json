{
    "hands_on_practices": [
        {
            "introduction": "在超新星核心反弹后形成的初始冲击波，在向外穿过恒星外层时会损失能量。一个主要的能量消耗来源是重核（如铁）的离解。这个练习将指导你进行一项关键计算，揭示为何这种能量损失如此巨大，以至于常常导致冲击波停滞，从而凸显了为何需要一个额外的能量机制来驱动爆炸。",
            "id": "3570479",
            "problem": "在核塌缩超新星的计算模型中，向铁族核传播的吸积激波会因核离解而损失能量，这在激波的能量收支中充当了一个能量汇。考虑一个完全由铁-56核组成的上游流，在激波处瞬间离解成自由核子。上游质量密度为 $\\rho_1 = 10^{10}\\,\\mathrm{g\\,cm^{-3}}$，上游速度为 $v_1 = 2 \\times 10^{9}\\,\\mathrm{cm\\,s^{-1}}$。将上游动能视为非相对论性的。使用以下数据：\n- 铁的每核子结合能 $E_b = 8.8\\,\\mathrm{MeV}$。\n- 电子伏特定义 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-12}\\,\\mathrm{erg}$。\n- 原子质量单位（核子质量）$m_u = 1.66053906660 \\times 10^{-24}\\,\\mathrm{g}$。\n- 全程使用厘米-克-秒（CGS）单位制。\n\n计算穿过激波时，因铁离解所消耗的能量占上游单位质量来流动态能的分数。将最终答案表示为不带单位的小数，并四舍五入到三位有效数字。",
            "solution": "首先验证问题，以确保其科学上合理、内容自洽且提法恰当。\n\n**步骤1：提取已知条件**\n-   上游介质成分：铁-56核（$^{56}\\mathrm{Fe}$）。\n-   上游质量密度：$\\rho_1 = 10^{10}\\,\\mathrm{g\\,cm^{-3}}$。\n-   上游速度：$v_1 = 2 \\times 10^{9}\\,\\mathrm{cm\\,s^{-1}}$。\n-   动能模型：非相对论性。\n-   铁-56的每核子结合能：$E_b = 8.8\\,\\mathrm{MeV}$。\n-   转换常数：$1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-12}\\,\\mathrm{erg}$。\n-   原子质量单位（用作核子质量）：$m_u = 1.66053906660 \\times 10^{-24}\\,\\mathrm{g}$。\n-   任务：计算因铁离解所消耗的能量占来流单位质量动能的分数。\n-   输出格式：四舍五入到三位有效数字的小数。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题描述了超新星激波中核离解的能量成本，这是天体物理学中一个标准且关键的过程。所提供的密度、速度和结合能的物理值对于此环境是符合实际的。对于 $v_1 = 2 \\times 10^{9}\\,\\mathrm{cm\\,s^{-1}}$（约为 $0.067c$，其中 $c$ 是光速）的速度，采用非相对论性假设是合理的近似。问题陈述清晰，为其求解提供了所有必要的数据，并且不包含科学或逻辑上的矛盾。上游密度 $\\rho_1$ 是背景信息，计算所要求的单位质量能量比值时并不需要，但这不会使问题无效。该问题被认定为有效。\n\n**步骤3：进行求解**\n\n目标是计算分数 $f$，其定义为单位质量的离解消耗能量 $\\mathcal{E}_{diss}$ 与单位质量的来流动能 $\\mathcal{K}_1$ 之比。\n$$\nf = \\frac{\\mathcal{E}_{diss}}{\\mathcal{K}_1}\n$$\n\n首先，我们计算单位质量的来流动能 $\\mathcal{K}_1$。根据非相对论性近似，质量为 $m$ 的物质微元的动能为 $K_1 = \\frac{1}{2} m v_1^2$。因此，单位质量的动能为：\n$$\n\\mathcal{K}_1 = \\frac{K_1}{m} = \\frac{1}{2} v_1^2\n$$\n代入给定的 $v_1$ 值：\n$$\n\\mathcal{K}_1 = \\frac{1}{2} \\left(2 \\times 10^9\\,\\mathrm{cm\\,s^{-1}}\\right)^2 = \\frac{1}{2} \\left(4 \\times 10^{18}\\,\\mathrm{cm^2\\,s^{-2}}\\right) = 2 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}\n$$\n注意，在CGS单位制中，$1\\,\\mathrm{erg} = 1\\,\\mathrm{g\\,cm^2\\,s^{-2}}$。\n\n接下来，我们计算单位质量的离解消耗能量 $\\mathcal{E}_{diss}$。上游物质被指定为铁-56，它会离解成自由核子。此过程的能量成本由结合能给出。所给的结合能是每核子 $E_b = 8.8\\,\\mathrm{MeV}$。离解质量为 $m$ 的铁所需的能量是每核子能量乘以该质量中的核子数量。质量 $m$ 中的核子数量为 $m/m_{nucleon}$，其中 $m_{nucleon}$ 是单个核子的质量，我们将其近似为 $m_u$。\n因此，单位质量的离解能是每核子结合能除以一个核子的质量。\n$$\n\\mathcal{E}_{diss} = \\frac{E_b}{m_u}\n$$\n我们必须将 $E_b$ 的单位从 $\\mathrm{MeV}$ 转换为尔格（erg），以在CGS系统中保持一致。\n以尔格为单位的每核子结合能是：\n$$\nE_b = 8.8\\,\\mathrm{MeV} = 8.8 \\times 10^6\\,\\mathrm{eV} \\times \\left(\\frac{1.602176634 \\times 10^{-12}\\,\\mathrm{erg}}{1\\,\\mathrm{eV}}\\right)\n$$\n$$\nE_b = 1.40991543792 \\times 10^{-5}\\,\\mathrm{erg}\n$$\n现在，我们可以使用给定的 $m_u$ 值计算 $\\mathcal{E}_{diss}$：\n$$\n\\mathcal{E}_{diss} = \\frac{1.40991543792 \\times 10^{-5}\\,\\mathrm{erg}}{1.66053906660 \\times 10^{-24}\\,\\mathrm{g}} \\approx 8.4907106 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}\n$$\n\n最后，我们通过计算 $\\mathcal{E}_{diss}$ 与 $\\mathcal{K}_1$ 的比值来得到所求的分数 $f$：\n$$\nf = \\frac{\\mathcal{E}_{diss}}{\\mathcal{K}_1} = \\frac{8.4907106 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}}{2 \\times 10^{18}\\,\\mathrm{erg\\,g^{-1}}}\n$$\n$$\nf \\approx 4.2453553\n$$\n结果大于1具有深刻的物理意义：下落物质的动能不足以支持其自身的离解。这就是为什么在超新星模型中吸积激波会停滞的主要原因，需要一个额外的能量驱动机制（如中微子加热）才能成功爆炸。\n\n问题要求将答案四舍五入到三位有效数字。\n$$\nf \\approx 4.25\n$$",
            "answer": "$$\n\\boxed{4.25}\n$$"
        },
        {
            "introduction": "在证明了冲击波停滞的可能性之后，我们转向了驱动爆炸的主要候选机制：中微子加热。本练习将重点计算冲击波后方“增益区”内的中微子加热率，这是由原生中子星释放的大量中微子与物质相互作用引起的。通过将这个加热率与物质的引力束缚能进行比较，你可以估算出将物质解绑并可能驱动爆炸所需的时间尺度，从而对中微子驱动机制的可行性有一个定量的认识。",
            "id": "3570457",
            "problem": "考虑围绕一颗原中子星（PNS）的核心塌缩超新星增益区中的中微子加热。假设自由流的电子中微子光度为 $L_{\\nu_e}$，光度加权的平均中微子能量平方为 $\\langle E_{\\nu_e}^2\\rangle$。主要的加热通道是在光学薄条件下，电子中微子在自由中子上的荷电流吸收反应，$\\nu_e + n \\rightarrow p + e^{-}$。采用标准的低能荷电流截面近似 $\\sigma_{\\mathrm{abs}}(E_{\\nu}) \\approx \\sigma_0 \\left(E_{\\nu}/\\mathrm{MeV}\\right)^2$，其中 $\\sigma_0 = 9.2\\times 10^{-44}\\,\\mathrm{cm^2}$，并忽略弱磁效应、反冲和末态阻塞。假设物质是电子分数为 $Y_e$ 的自由核子气体，因此自由中子分数为 $Y_n = 1 - Y_e$。设重子质量为 $m_b$，包围质量为 $M$。半径 $r$ 处的中微子能流为 $F_{E,\\nu_e} = L_{\\nu_e}/(4\\pi r^2)$。在光学薄极限下进行计算，单位质量的能量沉积由吸收系数与能流的乘积给出。\n\n从这些基本原理和中子数密度定义 $n_n = Y_n \\rho/m_b$ 出发，推导比加热率 $\\dot{q}$（单位质量的能量沉积率）的表达式，用 $L_{\\nu_e}$、$r$、$Y_n$、$\\langle E_{\\nu_e}^2\\rangle$、$\\sigma_0$ 和 $m_b$ 表示。仔细论证您使用的任何谱平均方法。然后对以下数值计算 $\\dot{q}$：\n- $L_{\\nu_e} = 3.0\\times 10^{52}\\,\\mathrm{erg\\,s^{-1}}$，\n- $\\langle E_{\\nu_e}^2\\rangle = (12\\,\\mathrm{MeV})^2$，\n- $r = 150\\,\\mathrm{km}$，\n- $\\rho = 10^9\\,\\mathrm{g\\,cm^{-3}}$，\n- $Y_e = 0.5$（所以 $Y_n = 0.5$），\n- $m_b = 1.674\\times 10^{-24}\\,\\mathrm{g}$，\n- $M = 1.4\\,M_{\\odot}$，其中 $M_{\\odot} = 1.98847\\times 10^{33}\\,\\mathrm{g}$，\n- Newton 引力常数 $G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$。\n\n使用每个重子的引力结合能 $e_{\\mathrm{bind}} = G M m_b / r$，计算加热时标 $t_{\\mathrm{heat}} = |e_{\\mathrm{bind}}|/\\dot{q}_b$，其中 $\\dot{q}_b$ 是每个重子的加热率。将您的答案表示如下：\n- $\\dot{q}$ 的单位为 $\\mathrm{erg\\,g^{-1}\\,s^{-1}}$，\n- $t_{\\mathrm{heat}}$ 的单位为 $\\mathrm{s}$。\n\n将两个答案都四舍五入到三位有效数字。",
            "solution": "我们从光学薄区域中，电子中微子在自由中子上发生荷电流吸收所导致的单位体积能量沉积开始。单位体积单位时间内吸收的能量为\n$$\n\\dot{Q}_{\\mathrm{vol}} \\;=\\; \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu})\\, \\sigma_{\\mathrm{abs}}(E_{\\nu})\\, n_n,\n$$\n其中 $E_{\\nu}$ 是中微子能量，$\\Phi_{\\nu}(E_{\\nu})$ 是微分数量通量（单位面积单位时间单位能量的粒子数），$\\sigma_{\\mathrm{abs}}(E_{\\nu})$ 是吸收截面，$n_n = Y_n \\rho/m_b$ 是中子数密度。比加热率（单位质量）为 $\\dot{q} = \\dot{Q}_{\\mathrm{vol}}/\\rho$，因此\n$$\n\\dot{q} \\;=\\; \\frac{Y_n}{m_b} \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu})\\, \\sigma_{\\mathrm{abs}}(E_{\\nu}).\n$$\n\n使用低能截面近似 $\\sigma_{\\mathrm{abs}}(E_{\\nu}) = \\sigma_0 \\left(E_{\\nu}/\\mathrm{MeV}\\right)^2$，我们写出\n$$\n\\dot{q} \\;=\\; \\frac{Y_n}{m_b}\\, \\sigma_0 \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu}) \\left(\\frac{E_{\\nu}}{\\mathrm{MeV}}\\right)^2.\n$$\n定义能流 $F_{E,\\nu_e} = \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu}) = L_{\\nu_e}/(4\\pi r^2)$。为了将截面对 $E_{\\nu}^2$ 的依赖性与单个谱参数联系起来，我们引入光度加权的平均能量平方\n$$\n\\langle E_{\\nu_e}^2 \\rangle \\;\\equiv\\; \\frac{\\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}^3 \\Phi_{\\nu}(E_{\\nu})}{\\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu} \\Phi_{\\nu}(E_{\\nu})}.\n$$\n对于截面与 $E_{\\nu}^2$ 成正比且输运的量是能量的过程，这是一个自然的平均值。根据这个定义，\n$$\n\\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu}^3 \\Phi_{\\nu}(E_{\\nu}) \\;=\\; \\langle E_{\\nu_e}^2 \\rangle \\int_{0}^{\\infty} \\mathrm{d}E_{\\nu}\\, E_{\\nu} \\Phi_{\\nu}(E_{\\nu}) \\;=\\; \\langle E_{\\nu_e}^2 \\rangle\\, F_{E,\\nu_e}.\n$$\n然而，需要注意单位。截面表示为 $\\sigma_0 (E_{\\nu}/\\mathrm{MeV})^2$，其中 $\\sigma_0$ 的单位是 $\\mathrm{cm^2}$。设 $\\alpha \\equiv 1\\,\\mathrm{MeV}$ 用尔格（erg）表示，所以 $\\alpha = 1.602176634\\times 10^{-6}\\,\\mathrm{erg}$。那么 $(E_{\\nu}/\\mathrm{MeV})^2 = (E_{\\nu}/\\alpha)^2$，并且\n$$\n\\int \\mathrm{d}E_{\\nu}\\, E_{\\nu}\\, \\Phi_{\\nu}(E_{\\nu}) \\left(\\frac{E_{\\nu}}{\\mathrm{MeV}}\\right)^2\n\\;=\\; \\alpha^{-2} \\int \\mathrm{d}E_{\\nu}\\, E_{\\nu}^3 \\Phi_{\\nu}(E_{\\nu})\n\\;=\\; \\alpha^{-2}\\, \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{erg}}\\, F_{E,\\nu_e},\n$$\n其中 $\\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{erg}}$ 是用尔格为单位的 $E_{\\nu}$ 计算出的光度加权平均能量平方。由于 $\\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{erg}} = \\alpha^2 \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}}$，$\\alpha$ 因子相互抵消，得到一个简洁的结果\n$$\n\\dot{q} \\;=\\; \\frac{Y_n}{m_b}\\, \\sigma_0\\, \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}}\\, F_{E,\\nu_e}\n\\;=\\; \\frac{Y_n}{m_b}\\, \\sigma_0\\, \\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}}\\, \\frac{L_{\\nu_e}}{4\\pi r^2}.\n$$\n因此，在光学薄极限下，$\\dot{q}$ 与质量密度 $\\rho$ 无关；来自 $n_n$ 的显式因子 $\\rho$ 在除以 $\\rho$ 以获得比率时被抵消了。\n\n接下来，我们数值计算单位质量的加热率。代入数据：\n- $L_{\\nu_e} = 3.0\\times 10^{52}\\,\\mathrm{erg\\,s^{-1}}$，\n- $r = 150\\,\\mathrm{km} = 1.50\\times 10^{7}\\,\\mathrm{cm}$，\n- $Y_e = 0.5$ 所以 $Y_n = 0.5$，\n- $m_b = 1.674\\times 10^{-24}\\,\\mathrm{g}$，\n- $\\sigma_0 = 9.2\\times 10^{-44}\\,\\mathrm{cm^2}$，\n- $\\langle E_{\\nu_e}^2 \\rangle_{\\mathrm{MeV}} = (12\\,\\mathrm{MeV})^2 = 144\\,\\mathrm{MeV^2}$。\n\n计算能流：\n$$\nF_{E,\\nu_e} \\;=\\; \\frac{L_{\\nu_e}}{4\\pi r^2}\n\\;=\\; \\frac{3.0\\times 10^{52}}{4\\pi\\,(1.50\\times 10^{7})^2}\\,\\mathrm{erg\\,cm^{-2}\\,s^{-1}}\n\\;=\\; \\frac{3.0\\times 10^{52}}{2.827433388\\times 10^{15}}\\,\\mathrm{erg\\,cm^{-2}\\,s^{-1}}\n\\;\\approx\\; 1.06103\\times 10^{37}\\,\\mathrm{erg\\,cm^{-2}\\,s^{-1}}.\n$$\n计算单位质量的有效吸收系数：\n$$\n\\kappa_a \\;=\\; \\frac{Y_n}{m_b}\\,\\sigma_0\\,\\langle E_{\\nu_e}^2\\rangle_{\\mathrm{MeV}}\n\\;=\\; \\frac{0.5}{1.674\\times 10^{-24}} \\times (9.2\\times 10^{-44}) \\times 144 \\;\\mathrm{cm^2\\,g^{-1}}\n\\;\\approx\\; 3.96\\times 10^{-18}\\,\\mathrm{cm^2\\,g^{-1}}.\n$$\n因此，\n$$\n\\dot{q} \\;=\\; \\kappa_a\\, F_{E,\\nu_e}\n\\;\\approx\\; (3.96\\times 10^{-18}) \\times (1.06103\\times 10^{37})\\;\\mathrm{erg\\,g^{-1}\\,s^{-1}}\n\\;\\approx\\; 4.20\\times 10^{19}\\,\\mathrm{erg\\,g^{-1}\\,s^{-1}}.\n$$\n\n对于加热时标，问题将每个重子的引力结合能定义为 $e_{\\mathrm{bind}} = G M m_b / r$。基于单个重子能量学的加热时标是 $t_{\\mathrm{heat}} = |e_{\\mathrm{bind}}|/\\dot{q}_b$，其中 $\\dot{q}_b$ 是每个重子的加热率。注意到 $\\dot{q}_b = \\dot{q}\\, m_b$ 且 $e_{\\mathrm{bind}} = (G M/r)\\, m_b$，因子 $m_b$ 被抵消，所以时标可以等效地使用单位质量的结合能 $e_{\\mathrm{bind}}^{\\mathrm{(mass)}} = G M / r$ 来计算：\n$$\nt_{\\mathrm{heat}} \\;=\\; \\frac{G M / r}{\\dot{q}}.\n$$\n现在使用 $M = 1.4\\,M_{\\odot}$，$M_{\\odot} = 1.98847\\times 10^{33}\\,\\mathrm{g}$，$G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$ 和 $r = 1.50\\times 10^{7}\\,\\mathrm{cm}$ 来计算 $G M / r$：\n$$\nM \\;=\\; 1.4 \\times 1.98847\\times 10^{33}\\,\\mathrm{g} \\;=\\; 2.783858\\times 10^{33}\\,\\mathrm{g},\n$$\n$$\n\\frac{G M}{r} \\;=\\; \\frac{6.67430\\times 10^{-8}\\times 2.783858\\times 10^{33}}{1.50\\times 10^{7}}\\,\\mathrm{erg\\,g^{-1}}\n\\;\\approx\\; 1.23869\\times 10^{19}\\,\\mathrm{erg\\,g^{-1}}.\n$$\n因此，\n$$\nt_{\\mathrm{heat}} \\;=\\; \\frac{1.23869\\times 10^{19}}{4.20\\times 10^{19}}\\,\\mathrm{s}\n\\;\\approx\\; 0.295\\,\\mathrm{s}.\n$$\n\n总结并按要求四舍五入到三位有效数字：\n- $\\dot{q} \\approx 4.20\\times 10^{19}\\,\\mathrm{erg\\,g^{-1}\\,s^{-1}}$，\n- $t_{\\mathrm{heat}} \\approx 0.295\\,\\mathrm{s}$。\n\n对于给定的半径和光度下，由电子中微子引起的增益区加热，这些值在物理上是合理的，并且比加热率中 $\\rho$ 的抵消反映了光学薄、吸收主导的区域特性。",
            "answer": "$$\\boxed{\\begin{pmatrix}4.20\\times 10^{19}  0.295\\end{pmatrix}}$$"
        },
        {
            "introduction": "将物理概念转化为计算模型，我们面临着实际的数值挑战。准确模拟流体动力学（平流）和刚性弱相互作用的耦合，需要精密的数值方法。本练习要求你设计一个隐式-显式（IMEX）格式，它能正确处理刚性反应源项，同时严格遵守像轻子数守恒这样的基本物理定律。这项实践让你从理论理解跃迁到代码构建的具体现实，这对于开发物理上有效的模拟至关重要。",
            "id": "3570423",
            "problem": "您的任务是设计并实现一个数值守恒的隐式-显式格式，用于处理与核心坍缩超新星相关的一维电子轻子数演化模型中的刚性弱相互作用源项。您的目标是构建一个能够以机器精度守恒总电子轻子数的方法，并通过随时间追踪总电子轻子含量的空间积分来验证这种守恒性。所有量都已无量纲化；请将所有最终数值结果表示为无量纲浮点数。\n\n考虑一个长度为 $L$ 的一维周期性区域，离散为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀有限体积元，网格中心位于 $x_i$。设 $\\rho(x,t)$ 表示质量密度，$Y_e(x,t)$ 表示电子分数（每个重子的电子数），$Y_{\\nu_e}(x,t)$ 表示电子中微子分数（每个重子的电子中微子数）。速度场 $u(x)$ 是预先给定且不随时间变化的，代表一种可压缩的流入模式。弱相互作用通过一个刚性电子俘获源来建模，该源将电子轻子数从电子转移到电子中微子而无泄漏，因此局部源项构成一个守恒对。\n\n守恒形式的控制方程为：\n- 连续性方程：$\\partial_t \\rho + \\partial_x (\\rho u) = 0$。\n- 电子分数：$\\partial_t(\\rho Y_e) + \\partial_x(\\rho Y_e u) = - \\rho \\, \\mathcal{R}$。\n- 电子中微子分数：$\\partial_t(\\rho Y_{\\nu_e}) + \\partial_x(\\rho Y_{\\nu_e} u) = + \\rho \\, \\mathcal{R}$。\n\n这里 $\\mathcal{R}$ 是一个刚性相互作用率。假设采用以下物理上合理但简化的闭合关系：\n- 速度为 $u(x) = - U_0 \\sin(2\\pi x/L)$。\n- 反应率为 $\\mathcal{R} = \\lambda(\\rho)\\, \\big(Y_e - Y_e^{\\mathrm{eq}}(\\rho)\\big)$，其中 $\\lambda(\\rho) = \\lambda_0 \\rho$ 且 $Y_e^{\\mathrm{eq}}(\\rho) = 0.05 + 0.45\\,[1 + (\\rho/5)^2]^{-1}$。\n\n$t=0$ 时的初始条件为：\n- $\\rho(x,0) = 1.0 + 0.1 \\cos(2\\pi x/L)$，\n- $Y_e(x,0) = 0.45 + 0.05 \\sin(2\\pi x/L)$，\n- $Y_{\\nu_e}(x,0) = 10^{-6}$。\n\n所有数值均为无量纲。\n\n设计一个如下的隐式-显式时间步进方法：\n- 对 $\\rho$、$\\rho Y_e$ 和 $\\rho Y_{\\nu_e}$ 的平流通量，使用一阶守恒迎风有限体积方法进行离散化，在时间上采用显式格式，并遵循 Courant–Friedrichs–Lewy (CFL) 时间步约束。\n- 对刚性源项，在每个网格元上采用全隐式更新，在源项子步骤中以机器精度保持局部和 $Y_e + Y_{\\nu_e}$ 不变。您的推导必须仅从控制方程和反应率的定义出发；不要假设任何预先推导好的更新公式。\n\n设 $\\mathcal{L}(t)$ 表示守恒的总电子轻子含量，定义为质量加权的空间积分\n$$\n\\mathcal{L}(t) = \\int_0^L \\rho(x,t)\\,\\big(Y_e(x,t) + Y_{\\nu_e}(x,t)\\big)\\, dx.\n$$\n在周期性边界条件下且没有轻子泄漏的情况下，方程组意味着 $\\mathcal{L}(t)$ 随时间守恒。您的数值方法必须在任意由 $\\lambda_0$ 控制的刚度下，将 $\\mathcal{L}(t)$ 的守恒性维持在舍入误差范围内。\n\n实现要求：\n- 使用带有周期性边界条件的均匀网格。\n- 时间步长 $\\Delta t$ 由 CFL 条件 $\\Delta t = \\mathrm{CFL} \\, \\Delta x / \\max_i |u_{i+\\frac{1}{2}}|$ 给出，其中 $u_{i+\\frac{1}{2}}$ 是界面 $i+\\frac{1}{2}$ 上的速度，通过在界面位置处计算的解析速度 $u(x)$ 来近似。当 $\\max_i |u_{i+\\frac{1}{2}}| = 0$ 时，将 $\\Delta t$ 设置为一步达到最终时间 $T$ 所需的剩余时间。\n- 对每个守恒场使用一阶 Godunov 迎风通量。例如，守恒场 $q$ 通过界面 $i+\\frac{1}{2}$ 的通量为 $F_{i+\\frac{1}{2}} = u_{i+\\frac{1}{2}} \\, q^{\\mathrm{up}}_{i+\\frac{1}{2}}$，其中迎风状态在 $u_{i+\\frac{1}{2}} \\ge 0$ 时取自左侧网格元，否则取自右侧网格元。\n- 使用算子分裂：对 $\\rho$、$\\rho Y_e$ 和 $\\rho Y_{\\nu_e}$ 应用显式平流步骤，然后在每个网格元上对 $Y_e$ 和 $Y_{\\nu_e}$ 应用隐式反应步骤，在源项子步骤中保持 $\\rho$ 不变。\n\n验证目标：\n- 对每个测试案例，计算初始值 $\\mathcal{L}(0)$ 和最终值 $\\mathcal{L}(T)$。将绝对相对漂移 $|\\mathcal{L}(T) - \\mathcal{L}(0)| / \\mathcal{L}(0)$ 作为浮点数报告。\n\n测试套件：\n提供一个单一程序，运行以下四个测试案例，并按指定顺序在单行中输出四个漂移值。使用 $L = 1$。\n- 案例 1（刚性，中等平流）：$N = 256$，$\\mathrm{CFL} = 0.8$，$U_0 = 0.3$，$\\lambda_0 = 10^6$，$T = 1.0$。\n- 案例 2（无反应，仅平流）：$N = 64$，$\\mathrm{CFL} = 0.9$，$U_0 = 0.1$，$\\lambda_0 = 0.0$，$T = 2.0$。\n- 案例 3（粗网格，强流入）：$N = 8$，$\\mathrm{CFL} = 0.5$，$U_0 = 0.9$，$\\lambda_0 = 10^2$，$T = 0.5$。\n- 案例 4（单网格，仅反应）：$N = 1$，$\\mathrm{CFL} = 0.9$，$U_0 = 0.0$，$\\lambda_0 = 10^{12}$，$T = 1.0$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4]”），其中每个结果是对应测试案例的绝对相对漂移，以无量纲单位的浮点数表示。",
            "solution": "该问题是有效的，因为它提出了一个适定的、具有坚实科学基础的计算物理问题。它是自洽的，所有必要的方程、参数和数值要求都已明确指定。任务是为一个平流-反应方程组实现一个数值守恒格式，这是科学计算中的一个标准且可验证的问题。\n\n该解法基于算子分裂方法构建，其中平流和反应过程在分离的子步骤中处理。这允许针对每个过程的特性使用不同的数值方法：对非刚性平流使用显式方法，对刚性弱相互作用源项使用隐式方法。\n\n一维空间中的控制方程为：\n$$ \\partial_t \\rho + \\partial_x (\\rho u) = 0 $$\n$$ \\partial_t(\\rho Y_e) + \\partial_x(\\rho Y_e u) = - \\rho \\, \\mathcal{R} $$\n$$ \\partial_t(\\rho Y_{\\nu_e}) + \\partial_x(\\rho Y_{\\nu_e} u) = + \\rho \\, \\mathcal{R} $$\n其中 $\\rho$ 是质量密度，$Y_e$ 是电子分数，$Y_{\\nu_e}$ 是电子中微子分数，$u(x) = - U_0 \\sin(2\\pi x/L)$ 是给定的速度场，而 $\\mathcal{R} = \\lambda(\\rho)\\, \\big(Y_e - Y_e^{\\mathrm{eq}}(\\rho)\\big)$ 是反应率。问题指定 $\\lambda(\\rho) = \\lambda_0 \\rho$。\n\n总电子轻子数含量 $\\mathcal{L}(t)$ 定义为\n$$ \\mathcal{L}(t) = \\int_0^L \\rho(x,t)\\,\\big(Y_e(x,t) + Y_{\\nu_e}(x,t)\\big)\\, dx $$\n将 $\\rho Y_e$ 和 $\\rho Y_{\\nu_e}$ 的方程相加得到\n$$ \\partial_t\\big(\\rho(Y_e + Y_{\\nu_e})\\big) + \\partial_x\\big(\\rho(Y_e + Y_{\\nu_e})u\\big) = 0 $$\n这是一个关于量 $\\rho(Y_e + Y_{\\nu_e})$ 的守恒律。在周期性区域 $[0, L]$ 上积分表明 $d\\mathcal{L}/dt = 0$，意味着 $\\mathcal{L}(t)$ 是一个守恒量。数值格式必须将此性质保持到机器精度。\n\n区域被离散化为 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀有限体积元。在网格元 $i$（中心为 $x_i$）中，一个量 $q$ 在时间 $t_n$ 的网格平均值记为 $q_i^n$。时间步长为 $\\Delta t$。\n\n从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的整个更新过程使用算子分裂进行：\n1.  **平流子步骤（显式）：**\n    首先，我们对所有三个守恒量 $(\\rho, \\rho Y_e, \\rho Y_{\\nu_e})$ 求解方程的平流部分。对于一个通用的守恒量 $q$，方程为 $\\partial_t q + \\partial_x (q u) = 0$。使用一阶迎风有限体积方法，从状态 $n$ 到中间状态 $*$ 的更新为：\n    $$ q_i^* = q_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\n    其中 $F_{i+1/2}$ 是网格元 $i$ 和 $i+1$ 之间界面上的数值通量。对于一阶 Godunov 方法，通量由迎风状态确定：\n    $$ F_{i+1/2} = u_{i+1/2} \\, q_{i+1/2}^{\\mathrm{up}} = \\begin{cases} u_{i+1/2} \\, q_i^n  \\text{如果 } u_{i+1/2} \\ge 0 \\\\ u_{i+1/2} \\, q_{i+1}^n  \\text{如果 } u_{i+1/2}  0 \\end{cases} $$\n    其中 $u_{i+1/2}$ 是界面上的速度。由于通量求和的对消特性和周期性边界条件，此步骤精确守恒每个量的总量 $\\sum_i q_i \\Delta x$。因此，总轻子数 $\\sum_i (\\rho Y_e + \\rho Y_{\\nu_e})_i \\Delta x$ 在平流子步骤中是守恒的。\n\n2.  **反应子步骤（隐式）：**\n    接下来，我们在每个网格元中局部地应用源项，将状态从 $*$ 更新到 $n+1$。在此子步骤中，$\\rho$ 保持恒定，即 $\\rho_i^{n+1} = \\rho_i^*$。反应仅改变 $Y_e$ 和 $Y_{\\nu_e}$。每个网格元 $i$ 的局部常微分方程组为：\n    $$ \\frac{d Y_{e,i}}{dt} = -\\mathcal{R}_i = -\\lambda(\\rho_i^*) \\left( Y_{e,i} - Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*) \\right) $$\n    $$ \\frac{d Y_{\\nu_e,i}}{dt} = +\\mathcal{R}_i = +\\lambda(\\rho_i^*) \\left( Y_{e,i} - Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*) \\right) $$\n    该系统意味着 $\\frac{d}{dt}(Y_{e,i} + Y_{\\nu_e,i}) = 0$，因此和 $Y_{e,i} + Y_{\\nu_e,i}$ 在每个网格元内必须守恒。\n    为了处理反应率 $\\mathcal{R}$ 的刚性，我们对 $Y_e$ 方程使用全隐式（后向欧拉）离散化。从原始变量 $Y_{e,i}^* = (\\rho Y_e)_i^*/\\rho_i^*$ 开始，更新为：\n    $$ \\frac{Y_{e,i}^{n+1} - Y_{e,i}^*}{\\Delta t} = -\\lambda(\\rho_i^*) \\left( Y_{e,i}^{n+1} - Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*) \\right) $$\n    解出 $Y_{e,i}^{n+1}$ 得到更新公式：\n    $$ Y_{e,i}^{n+1} = \\frac{Y_{e,i}^* + \\Delta t \\, \\lambda_i^* Y_{e,i}^{\\mathrm{eq},*}}{1 + \\Delta t \\, \\lambda_i^*} $$\n    其中 $\\lambda_i^* = \\lambda(\\rho_i^*)$ 且 $Y_{e,i}^{\\mathrm{eq},*} = Y_{e,i}^{\\mathrm{eq}}(\\rho_i^*)$。此格式对于任何刚度参数 $\\lambda_0$ 和时间步长 $\\Delta t$ 都是无条件稳定的。\n    为确保守恒，我们不通过离散其自身的常微分方程来更新 $Y_{\\nu_e,i}$，而是利用守恒性质。$Y_e$ 的变化必须由 $Y_{\\nu_e}$ 的变化来平衡：$\\Delta Y_{\\nu_e,i} = - \\Delta Y_{e,i}$。因此：\n    $$ Y_{\\nu_e,i}^{n+1} = Y_{\\nu_e,i}^* - (Y_{e,i}^{n+1} - Y_{e,i}^*) $$\n    这保证了 $Y_{e,i}^{n+1} + Y_{\\nu_e,i}^{n+1} = Y_{e,i}^* + Y_{\\nu_e,i}^*$ 达到机器精度。\n    更新后的守恒量为 $(\\rho Y_e)_i^{n+1} = \\rho_i^{n+1} Y_{e,i}^{n+1}$ 和 $(\\rho Y_{\\nu_e})_i^{n+1} = \\rho_i^{n+1} Y_{\\nu_e,i}^{n+1}$。由于 $\\rho_i^{n+1} = \\rho_i^*$ 且 $(Y_e+Y_{\\nu_e})$ 守恒，每个网格元内的量 $(\\rho Y_e + \\rho Y_{\\nu_e})_i$ 在反应步骤中是守恒的。\n\n由于平流和反应子步骤都守恒总电子轻子数，完整的数值格式在浮点舍入误差范围内守恒 $\\mathcal{L}(t)$。实现将计算初始值 $\\mathcal{L}(0)$ 和最终值 $\\mathcal{L}(T)$，并报告绝对相对漂移 $|\\mathcal{L}(T) - \\mathcal{L}(0)| / \\mathcal{L}(0)|$，预计其量级与机器爱普西隆相当。",
            "answer": "```python\nimport numpy as np\n\ndef advect(q, u_at_faces, dt, dx):\n    \"\"\"\n    Advects a cell-centered quantity q using a first-order upwind scheme.\n\n    Args:\n        q (np.ndarray): Array of the cell-centered quantity, shape (N,).\n        u_at_faces (np.ndarray): Array of velocities at cell faces, shape (N+1,).\n        dt (float): Time step.\n        dx (float): Cell width.\n\n    Returns:\n        np.ndarray: The advected quantity, shape (N,).\n    \"\"\"\n    N = len(q)\n    # Extend q for periodic boundaries to get states at all faces\n    # q_ext[i] is the state to the left of face i (q_{i-1})\n    # q_ext[i+1] is the state to the right of face i (q_i)\n    q_ext = np.concatenate(([q[-1]], q, [q[0]]))\n    \n    # States to the left and right of each of the N+1 faces\n    q_left_states = q_ext[:-1]\n    q_right_states = q_ext[1:]\n    \n    # Calculate fluxes at N+1 faces using the upwind rule\n    fluxes = np.where(u_at_faces = 0, u_at_faces * q_left_states, u_at_faces * q_right_states)\n    \n    # Update cell-centered quantities using fluxes at cell boundaries.\n    # For cell i, the boundaries are face i and face i+1.\n    q_new = q - (dt/dx) * (fluxes[1:] - fluxes[:-1])\n    \n    return q_new\n\ndef run_simulation(N, CFL, U0, lambda0, T, L=1.0):\n    \"\"\"\n    Runs a single simulation case for the advection-reaction system.\n    \"\"\"\n    # 1. Grid setup\n    dx = L / N\n    x_centers = (np.arange(N) + 0.5) * dx\n    x_faces = np.arange(N + 1) * dx\n\n    # 2. Initial conditions\n    rho = 1.0 + 0.1 * np.cos(2 * np.pi * x_centers / L)\n    Ye = 0.45 + 0.05 * np.sin(2 * np.pi * x_centers / L)\n    Ynue = np.full(N, 1e-6)\n    \n    # Conserved variables\n    rhoYe = rho * Ye\n    rhoYnue = rho * Ynue\n\n    # 3. Calculate initial total lepton number\n    L0 = np.sum(rhoYe + rhoYnue) * dx\n\n    # 4. Main time loop\n    t = 0.0\n    while t  T:\n        # Calculate time step from CFL condition\n        u_at_faces = -U0 * np.sin(2 * np.pi * x_faces / L)\n        u_max = np.max(np.abs(u_at_faces))\n        \n        if u_max == 0.0:\n            dt = T - t\n        else:\n            dt = CFL * dx / u_max\n        \n        # Ensure the final time is not overshot\n        if t + dt  T:\n            dt = T - t\n\n        # Substep 1: Advection (Explicit)\n        rho_star = advect(rho, u_at_faces, dt, dx)\n        rhoYe_star = advect(rhoYe, u_at_faces, dt, dx)\n        rhoYnue_star = advect(rhoYnue, u_at_faces, dt, dx)\n\n        # Substep 2: Reaction (Implicit)\n        # Primitives at intermediate state\n        rho_star_safe = np.maximum(rho_star, 1e-100) # Avoid division by zero\n        Ye_star = rhoYe_star / rho_star_safe\n        Ynue_star = rhoYnue_star / rho_star_safe\n\n        # Reaction parameters\n        lambda_val = lambda0 * rho_star\n        Ye_eq = 0.05 + 0.45 / (1.0 + (rho_star / 5.0)**2)\n        \n        # Implicit update for Ye\n        dt_lambda = dt * lambda_val\n        Ye_new = (Ye_star + dt_lambda * Ye_eq) / (1.0 + dt_lambda)\n\n        # Conservative update for Ynue\n        delta_Ye = Ye_new - Ye_star\n        Ynue_new = Ynue_star - delta_Ye\n\n        # Update conserved variables for the next time step\n        rho = rho_star # Density is constant during the reaction step\n        rhoYe = rho * Ye_new\n        rhoYnue = rho * Ynue_new\n\n        # Update time\n        t += dt\n\n    # 5. Calculate final total lepton number\n    LT = np.sum(rhoYe + rhoYnue) * dx\n    \n    # 6. Compute and return absolute relative drift\n    if np.abs(L0)  1e-15:\n        drift = np.abs(LT - L0) / np.abs(L0)\n    else:\n        drift = np.abs(LT - L0)\n      \n    return drift\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (N, CFL, U0, lambda0, T)\n        (256, 0.8, 0.3, 1e6, 1.0),\n        (64, 0.9, 0.1, 0.0, 2.0),\n        (8, 0.5, 0.9, 1e2, 0.5),\n        (1, 0.9, 0.0, 1e12, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, CFL, U0, lambda0, T = case\n        drift = run_simulation(N, CFL, U0, lambda0, T)\n        results.append(drift)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}