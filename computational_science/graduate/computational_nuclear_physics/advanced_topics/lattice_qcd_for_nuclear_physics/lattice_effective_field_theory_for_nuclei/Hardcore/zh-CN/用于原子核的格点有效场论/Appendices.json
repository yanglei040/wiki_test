{
    "hands_on_practices": [
        {
            "introduction": "将物理理论从连续时空转换到离散格点上，是格点有效场论的第一步，但这个过程会不可避免地引入与物理现实不符的“膺像”(artifacts)。本练习  将引导你通过一个基础的理论推导，亲手揭示其中最著名的一种膺像：旋转对称性破缺。通过计算格点上的粒子能量-动量关系（即色散关系），你将量化地理解为何在格点世界里，不同方向的运动不再等价，这是理解所有格点计算结果的前提。",
            "id": "3567125",
            "problem": "考虑在一个格点间距为 $a$ 并带有周期性边界条件 (PBC) 的三维立方空间格点上，用有效场论 (EFT) 描述的低能核动力学。在单核子扇区中，相互作用不存在，动力学由非相对论动能算符决定。连续谱自由粒子的哈密顿量由 $H = -(\\hbar^{2}/2m)\\nabla^{2}$ 给出，其中 $m$ 是核子质量，$\\hbar$ 是普朗克常数除以 $2\\pi$。在格点上，动能项由一个离散拉普拉斯算子定义，该算子被构造成精度达到 $O(a^{2})$ 阶并满足立方对称性。\n\n从 $f(\\mathbf{r} \\pm a\\hat{\\mathbf{e}}_{i})$ 关于 $f(\\mathbf{r})$ 的泰勒展开出发，并根据离散拉普拉斯算子以 $O(a^{2})$ 的截断误差逼近连续拉普拉斯算子 $\\nabla^{2}$ 的要求，构造三维格点拉普拉斯算子的七点格式，并由此得到相应的格点动能算符。使用此格点算符，推导格点动量为 $\\mathbf{k}$ 的平面波本征态 $\\psi(\\mathbf{r}) = \\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ 的单粒子色散关系 $E(\\mathbf{k})$。\n\n为了量化由格点离散化引起的旋转对称性破缺，考虑两个大小相同（$|\\mathbf{k}| = k$）的动量：一个沿着坐标轴，$\\mathbf{k}_{\\text{ax}} = (k, 0, 0)$，另一个沿着体对角线，$\\mathbf{k}_{\\text{bd}} = (k/\\sqrt{3}, k/\\sqrt{3}, k/\\sqrt{3})$。定义无量纲各向异性度量\n$$\nR(x) = \\frac{E(\\mathbf{k}_{\\text{ax}}) - E(\\mathbf{k}_{\\text{bd}})}{E_{\\text{cont}}(k)},\n$$\n其中 $x = k a$，而 $E_{\\text{cont}}(k) = \\hbar^{2}k^{2}/(2m)$ 是连续谱色散关系。推导 $R(x)$ 的闭合形式表达式及其在 $x=0$ 附近的小 $x$ 级数展开。作为最终答案，报告展开式 $R(x) = c\\,x^{2} + O(x^{4})$ 中的领头阶系数 $c$。将最终答案表示为一个无量纲的精确数，无需四舍五入。",
            "solution": "该问题陈述经核实具有科学依据，提法恰当且内容完整。它描述了格点场论中一个标准问题，涉及动能算符的离散化以及对由此产生的效应（特别是旋转对称性破缺）的分析。我们可以开始求解。\n\n第一步是构造离散格点拉普拉斯算子，记为 $\\nabla^2_{\\text{lat}}$，它以 $O(a^2)$ 阶的截断误差逼近连续拉普拉斯算子 $\\nabla^2$，其中 $a$ 是格点间距。我们考虑格点上的一个标量函数 $f(\\mathbf{r})$，其中 $\\mathbf{r}$ 代表立方网格上的一个点。对于由 $i \\in \\{1, 2, 3\\}$ 索引的三个空间方向中的任意一个，我们在点 $\\mathbf{r}$ 周围对邻近格点 $\\mathbf{r} \\pm a\\hat{\\mathbf{e}}_i$ 处的函数 $f$ 进行泰勒级数展开，其中 $\\hat{\\mathbf{e}}_i$ 是沿第 $i$ 轴的单位向量。\n展开式为：\n$$f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) = f(\\mathbf{r}) + a \\frac{\\partial f}{\\partial r_i} + \\frac{a^2}{2!} \\frac{\\partial^2 f}{\\partial r_i^2} + \\frac{a^3}{3!} \\frac{\\partial^3 f}{\\partial r_i^3} + \\frac{a^4}{4!} \\frac{\\partial^4 f}{\\partial r_i^4} + O(a^5)$$\n$$f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) = f(\\mathbf{r}) - a \\frac{\\partial f}{\\partial r_i} + \\frac{a^2}{2!} \\frac{\\partial^2 f}{\\partial r_i^2} - \\frac{a^3}{3!} \\frac{\\partial^3 f}{\\partial r_i^3} + \\frac{a^4}{4!} \\frac{\\partial^4 f}{\\partial r_i^4} - O(a^5)$$\n将这两个方程相加，可以消去含 $a$ 的奇次幂项：\n$$f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) + f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) = 2f(\\mathbf{r}) + a^2 \\frac{\\partial^2 f}{\\partial r_i^2} + \\frac{a^4}{12} \\frac{\\partial^4 f}{\\partial r_i^4} + O(a^6)$$\n重新整理此式以求解二阶偏导数，得到中心差分公式：\n$$\\frac{\\partial^2 f}{\\partial r_i^2} = \\frac{1}{a^2} \\left[ f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) + f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) - 2f(\\mathbf{r}) \\right] - \\frac{a^2}{12} \\frac{\\partial^4 f}{\\partial r_i^4} + O(a^4)$$\n领头误差项与 $a^2$ 成正比，因此该形式提供了对 $\\frac{\\partial^2 f}{\\partial r_i^2}$ 的一个近似，其精度为 $O(a^2)$ 阶。为了构造三维拉普拉斯算子 $\\nabla^2 = \\sum_{i=1}^3 \\frac{\\partial^2}{\\partial r_i^2}$，我们将 $i=1, 2, 3$ 的中心差分表达式相加：\n$$\\nabla^2 f(\\mathbf{r}) = \\frac{1}{a^2} \\sum_{i=1}^3 \\left[ f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) + f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) - 2f(\\mathbf{r}) \\right] + O(a^2)$$\n格点拉普拉斯算子 $\\nabla^2_{\\text{lat}}$ 通过舍去误差项来定义：\n$$\\nabla^2_{\\text{lat}} f(\\mathbf{r}) = \\frac{1}{a^2} \\left( \\sum_{i=1}^3 \\left[ f(\\mathbf{r} + a\\hat{\\mathbf{e}}_i) + f(\\mathbf{r} - a\\hat{\\mathbf{e}}_i) \\right] - 6f(\\mathbf{r}) \\right)$$\n该算子使用中心点 $\\mathbf{r}$ 及其六个最近邻点的函数值，因此构成了所要求的七点格式。\n\n通过将 $\\nabla^2_{\\text{lat}}$ 代入连续谱表达式 $H = -(\\hbar^2/2m)\\nabla^2$，可以得到格点上的非相对论动能算符 $H_{\\text{lat}}$：\n$$H_{\\text{lat}} = -\\frac{\\hbar^2}{2m} \\nabla^2_{\\text{lat}} = -\\frac{\\hbar^2}{2ma^2} \\left( \\sum_{i=1}^3 \\left[ T_i^+ + T_i^- \\right] - 6 \\right)$$\n其中 $T_i^{\\pm}$ 是平移算符，使得 $T_i^{\\pm} f(\\mathbf{r}) = f(\\mathbf{r} \\pm a\\hat{\\mathbf{e}}_i)$。\n\n接下来，我们通过求解平面波态 $\\psi(\\mathbf{r}) = \\exp(i\\mathbf{k}\\cdot\\mathbf{r})$ 所对应的 $H_{\\text{lat}}$ 的本征值，来推导单粒子色散关系 $E(\\mathbf{k})$。将平移算符作用于此态，得到：\n$$T_i^{\\pm} \\psi(\\mathbf{r}) = \\exp(i\\mathbf{k}\\cdot(\\mathbf{r} \\pm a\\hat{\\mathbf{e}}_i)) = \\exp(i\\mathbf{k}\\cdot\\mathbf{r}) \\exp(\\pm i a k_i) = \\psi(\\mathbf{r}) \\exp(\\pm i a k_i)$$\n因此，哈密顿量作用在平面波上为：\n$$H_{\\text{lat}} \\psi(\\mathbf{r}) = -\\frac{\\hbar^2}{2ma^2} \\left( \\sum_{i=1}^3 \\left[ \\exp(i a k_i) + \\exp(-i a k_i) \\right] - 6 \\right) \\psi(\\mathbf{r})$$\n使用恒等式 $2\\cos\\theta = e^{i\\theta} + e^{-i\\theta}$，我们简化括号中的表达式：\n$$H_{\\text{lat}} \\psi(\\mathbf{r}) = -\\frac{\\hbar^2}{2ma^2} \\left( \\sum_{i=1}^3 2\\cos(a k_i) - 6 \\right) \\psi(\\mathbf{r}) = \\frac{\\hbar^2}{ma^2} \\left( 3 - \\sum_{i=1}^3 \\cos(a k_i) \\right) \\psi(\\mathbf{r})$$\n本征值即为能量 $E(\\mathbf{k})$。使用恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$：\n$$E(\\mathbf{k}) = \\frac{\\hbar^2}{ma^2} \\sum_{i=1}^3 \\left(1 - \\cos(a k_i)\\right) = \\frac{2\\hbar^2}{ma^2} \\sum_{i=1}^3 \\sin^2\\left(\\frac{a k_i}{2}\\right)$$\n这就是格点色散关系。\n\n现在，我们对两个指定的动量矢量 $\\mathbf{k}_{\\text{ax}} = (k, 0, 0)$ 和 $\\mathbf{k}_{\\text{bd}} = (k/\\sqrt{3}, k/\\sqrt{3}, k/\\sqrt{3})$ 计算此表达式，其中 $|\\mathbf{k}_{\\text{ax}}| = |\\mathbf{k}_{\\text{bd}}| = k$。\n对于轴向动量 $\\mathbf{k}_{\\text{ax}}$，其分量为 $k_1=k$, $k_2=0$, $k_3=0$：\n$$E(\\mathbf{k}_{\\text{ax}}) = \\frac{2\\hbar^2}{ma^2} \\left[ \\sin^2\\left(\\frac{ak}{2}\\right) + \\sin^2(0) + \\sin^2(0) \\right] = \\frac{2\\hbar^2}{ma^2} \\sin^2\\left(\\frac{ak}{2}\\right)$$\n对于体对角线动量 $\\mathbf{k}_{\\text{bd}}$，其分量为 $k_1=k_2=k_3=k/\\sqrt{3}$：\n$$E(\\mathbf{k}_{\\text{bd}}) = \\frac{2\\hbar^2}{ma^2} \\sum_{i=1}^3 \\sin^2\\left(\\frac{ak}{2\\sqrt{3}}\\right) = \\frac{6\\hbar^2}{ma^2} \\sin^2\\left(\\frac{ak}{2\\sqrt{3}}\\right)$$\n各向异性度量 $R(x)$ 定义为 $x=ka$，连续谱能量为 $E_{\\text{cont}}(k) = \\hbar^2 k^2/(2m) = \\hbar^2 x^2/(2ma^2)$。\n$$R(x) = \\frac{E(\\mathbf{k}_{\\text{ax}}) - E(\\mathbf{k}_{\\text{bd}})}{E_{\\text{cont}}(k)} = \\frac{\\frac{2\\hbar^2}{ma^2} \\sin^2\\left(\\frac{x}{2}\\right) - \\frac{6\\hbar^2}{ma^2} \\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right)}{\\frac{\\hbar^2 x^2}{2ma^2}}$$\n简化此表达式，我们得到 $R(x)$ 的闭合形式：\n$$R(x) = \\frac{4}{x^2} \\sin^2\\left(\\frac{x}{2}\\right) - \\frac{12}{x^2} \\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right) = \\frac{4}{x^2} \\left[ \\sin^2\\left(\\frac{x}{2}\\right) - 3\\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right) \\right]$$\n为了找到小 $x$ 的领头阶行为，我们展开正弦平方项。$\\sin^2(u)$ 在 $u=0$ 附近的泰勒级数为 $\\sin^2(u) = (u - u^3/6 + \\dots)^2 = u^2 - u^4/3 + O(u^6)$。\n对于第一项，令 $u=x/2$：\n$$\\sin^2\\left(\\frac{x}{2}\\right) = \\left(\\frac{x}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{x}{2}\\right)^4 + O(x^6) = \\frac{x^2}{4} - \\frac{x^4}{48} + O(x^6)$$\n对于第二项，令 $u=x/(2\\sqrt{3})$：\n$$3\\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right) = 3\\left[ \\left(\\frac{x}{2\\sqrt{3}}\\right)^2 - \\frac{1}{3}\\left(\\frac{x}{2\\sqrt{3}}\\right)^4 + O(x^6) \\right] = 3\\left[ \\frac{x^2}{12} - \\frac{x^4}{3 \\cdot 144} + O(x^6) \\right] = \\frac{x^2}{4} - \\frac{x^4}{144} + O(x^6)$$\n两者的差为：\n$$\\sin^2\\left(\\frac{x}{2}\\right) - 3\\sin^2\\left(\\frac{x}{2\\sqrt{3}}\\right) = \\left(\\frac{x^2}{4} - \\frac{x^4}{48}\\right) - \\left(\\frac{x^2}{4} - \\frac{x^4}{144}\\right) + O(x^6) = \\left(-\\frac{1}{48} + \\frac{1}{144}\\right)x^4 + O(x^6)$$\n$$= \\frac{-3+1}{144}x^4 + O(x^6) = -\\frac{2}{144}x^4 + O(x^6) = -\\frac{1}{72}x^4 + O(x^6)$$\n最后，我们将此结果代回 $R(x)$ 的表达式中：\n$$R(x) = \\frac{4}{x^2} \\left[ -\\frac{1}{72}x^4 + O(x^6) \\right] = -\\frac{4}{72}x^2 + O(x^4) = -\\frac{1}{18}x^2 + O(x^4)$$\n问题要求展开式 $R(x) = c\\,x^2 + O(x^4)$ 中的系数 $c$。通过比较，我们得出 $c = -1/18$。",
            "answer": "$$\\boxed{-\\frac{1}{18}}$$"
        },
        {
            "introduction": "在建立了格点框架后，我们进而模拟粒子间的相互作用，这正是格点有效场论的核心应用。实现这一目标依赖于如量子蒙特卡洛（QMC）这样的随机模拟算法。本练习  将带你深入这些算法的心脏地带，编写一个局域Metropolis更新程序。你将学习如何通过引入辅助场来处理复杂的相互作用，并掌握高效计算费米子行列式比值的关键技巧，这是所有处理费米子系统的格点模拟都必须面对的核心任务。",
            "id": "3567111",
            "problem": "考虑一个在一维空间格点上的情形，该格点具有周期性边界条件和单个欧几里得时间片，用于原子核的格点有效场论 (EFT)。具有吸引性接触相互作用的自旋-$\\frac{1}{2}$核子通过使用连续高斯辅助场的 Hubbard–Stratonovich (HS) 变换进行解耦。辅助场表示为 $\\mathbf{s} = (s_0, s_1, \\dots, s_{L-1})$，其中 $L$ 是格点位置的数量，HS 场的高斯测度导出一个形式为 $S_{\\mathrm{aux}}[\\mathbf{s}] = \\sum_{i=0}^{L-1} \\frac{s_i^2}{2\\sigma^2}$ 的作用量，其中 $\\sigma^2$ 是高斯分布的方差。\n\n在此单个时间片上，定义费米子矩阵 $M[\\mathbf{s}] \\in \\mathbb{R}^{L \\times L}$ 为\n$$\nM[\\mathbf{s}] \\equiv I + \\alpha \\Delta + \\lambda\\,\\mathrm{diag}(\\mathbf{s}),\n$$\n其中 $I$ 是 $L \\times L$ 单位矩阵，$\\alpha > 0$ 是一个动能耦合常数，$\\lambda$ 是与辅助场耦合的强度，$\\Delta$ 是具有周期性边界条件的一维离散拉普拉斯算子：\n$$\n\\Delta_{ij} =\n\\begin{cases}\n2  \\text{若 } i=j, \\\\\n-1  \\text{若 } j = i+1 \\mod L, \\\\\n-1  \\text{若 } j = i-1 \\mod L, \\\\\n0  \\text{其他情况}.\n\\end{cases}\n$$\n假设有 $N_f$ 种简并的费米子（例如，对于具有相同矩阵的上自旋和下自旋，有 $N_f=2$），因此总费米子权重因子为 $\\big(\\det M[\\mathbf{s}]\\big)^{N_f}$。\n\n您将实现一个局域 Metropolis–Hastings 提议（Metropolis–Hastings (MH)），该提议仅在单个位置 $i$ 处更改辅助场，提议\n$$\ns_i' = s_i + \\delta,\n$$\n而所有其他的 $s_j$ 保持不变，其中提议机制围绕 $s_i$ 是对称的（例如，以 $s_i$ 为中心的高斯分布）。接受概率必须从第一性原理推导得出，从 HS 变换后的欧几里得路径积分表示开始，并使用适用于由 $s_i$ 的局域变化引起的 $M[\\mathbf{s}]$ 的秩-1 更新的有效、通用的线性代数恒等式（如矩阵行列式引理）。请用辅助场作用量的局域变化和费米子行列式的比值来表示接受概率，确保最终表达式对任意 $N_f$ 均有效，并避免显式计算行列式。\n\n实现的算法要求：\n- 您必须精确地按照上述定义构建 $M[\\mathbf{s}]$。\n- 您必须避免计算完整的矩阵逆或任何行列式。相反，您应仅通过求解单个线性系统 $M[\\mathbf{s}]\\,\\mathbf{x} = \\mathbf{e}_i$ 来计算费米子格林函数 $G \\equiv M[\\mathbf{s}]^{-1}$ 所需的标量分量，其中 $\\mathbf{e}_i$ 是在位置 $i$ 的单位向量。使用此方法来表示由局域更新产生的行列式比值。\n- 接受概率必须用 $N_f$、$\\sigma^2$、$\\lambda$、$\\delta$ 和来自 $G$ 的相关标量来表示。\n\n您的程序必须实现上述内容，并为以下每个测试用例评估接受概率。索引是基于零的。当出现三角函数时，角度必须是弧度。\n\n测试套件（每个用例定义了 $(L,\\alpha,\\lambda,N_f,\\sigma,\\mathbf{s},i,\\delta)$）：\n1. 正常流程情况：\n   - $L = 6$, $\\alpha = 0.15$, $\\lambda = 0.6$, $N_f = 2$, $\\sigma = 1.0$, $\\mathbf{s} = [0.1,-0.05,0.2,-0.1,0.0,0.05]$, $i = 3$, $\\delta = 0.1$。\n2. 边界动能情况（$\\alpha = 0$）：\n   - $L = 6$, $\\alpha = 0.0$, $\\lambda = 0.7$, $N_f = 2$, $\\sigma = 1.0$, $\\mathbf{s} = [0.2,0.2,0.2,0.2,0.2,0.2]$, $i = 2$, $\\delta = -0.05$。\n3. 单味周期性边界情况：\n   - $L = 8$, $\\alpha = 0.05$, $\\lambda = 1.0$, $N_f = 1$, $\\sigma = 1.0$, $\\mathbf{s}$ 由 $s_j = 0.1 \\cos\\!\\left(\\frac{2\\pi j}{L}\\right)$ 给出，对于 $j \\in \\{0,\\dots,7\\}$，$i = 7$, $\\delta = 0.2$。\n4. 零更新情况：\n   - $L = 4$, $\\alpha = 0.2$, $\\lambda = 0.3$, $N_f = 2$, $\\sigma = 1.0$, $\\mathbf{s} = [0.05,-0.05,0.03,-0.02]$, $i = 1$, $\\delta = 0.0$。\n5. 强辅助场惩罚情况：\n   - $L = 10$, $\\alpha = 0.1$, $\\lambda = 0.9$, $N_f = 2$, $\\sigma = 0.5$, $\\mathbf{s} = [0.1,-0.05,0.08,-0.02,0.03,0.05,-0.04,0.06,-0.01,0.02]$, $i = 5$, $\\delta = -0.4$。\n\n输出规范：\n- 对于每个测试用例，计算接受概率为一个浮点数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个浮点数四舍五入到六位小数（例如，$[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_k$ 都四舍五入到六位小数）。\n\n您的解必须以欧几里得路径积分和 Hubbard–Stratonovich 变换作为基本出发点，利用局域提议的费米子行列式比值推导出接受概率，然后实现上述算法步骤以产生所需的输出。",
            "solution": "此问题是有效的。它提出了一个在计算核物理领域内，特别是格点有效场论中，一个定义良好且有科学依据的情景。它要求推导并实现 Metropolis-Hastings 算法中对辅助场进行局域更新的接受概率。所提供的参数和定义清晰、一致，并且足以获得唯一且有意义的解。虽然一般问题描述中指出 $\\alpha > 0$，但有一个测试用例使用了 $\\alpha = 0$。这被解释为探索一个有效的物理极限（静态极限），并不会使问题在数学上或物理上不一致。现在我们可以开始求解。\n\n理论框架始于配分函数 $Z$ 的欧几里得路径积分表示。在对费米子场进行积分并执行 Hubbard–Stratonovich (HS) 变换以解耦核子-核子相互作用后，配分函数表示为对辅助场构型 $\\mathbf{s} = (s_0, s_1, \\dots, s_{L-1})$ 的积分：\n$$\nZ = \\int \\mathcal{D}\\mathbf{s} \\, e^{-S_{\\mathrm{aux}}[\\mathbf{s}]} \\left(\\det M[\\mathbf{s}]\\right)^{N_f}\n$$\n其中 $S_{\\mathrm{aux}}[\\mathbf{s}] = \\sum_{i=0}^{L-1} \\frac{s_i^2}{2\\sigma^2}$ 是辅助场的高斯作用量，$M[\\mathbf{s}]$ 是费米子矩阵，$N_f$ 是简并费米子味的数目。表达式\n$$\nP(\\mathbf{s}) \\propto e^{-S_{\\mathrm{aux}}[\\mathbf{s}]} \\left(\\det M[\\mathbf{s}]\\right)^{N_f}\n$$\n定义了构型 $\\mathbf{s}$ 的平衡概率分布。我们使用 Metropolis–Hastings 算法生成一个对此分布进行采样的构型马尔可夫链。\n\n对于一个对称的提议分布，其中从 $\\mathbf{s}$ 提议移动到 $\\mathbf{s'}$ 的概率与提议反向移动的概率相同，即 $g(\\mathbf{s} | \\mathbf{s'}) = g(\\mathbf{s'} | \\mathbf{s})$，接受概率 $A(\\mathbf{s} \\to \\mathbf{s'})$ 简化为：\n$$\nA(\\mathbf{s} \\to \\mathbf{s'}) = \\min\\left(1, \\frac{P(\\mathbf{s'})}{P(\\mathbf{s})}\\right)\n$$\n问题的核心是计算比率 $R = P(\\mathbf{s'})/P(\\mathbf{s})$。我们可以将这个比率分为两个因子：一个来自辅助场作用量，另一个来自费米子行列式。\n$$\nR = \\frac{e^{-S_{\\mathrm{aux}}[\\mathbf{s'}]} \\left(\\det M[\\mathbf{s'}]\\right)^{N_f}}{e^{-S_{\\mathrm{aux}}[\\mathbf{s}]} \\left(\\det M[\\mathbf{s}]\\right)^{N_f}} = e^{-\\left(S_{\\mathrm{aux}}[\\mathbf{s'}] - S_{\\mathrm{aux}}[\\mathbf{s}]\\right)} \\left(\\frac{\\det M[\\mathbf{s'}]}{\\det M[\\mathbf{s}]}\\right)^{N_f}\n$$\n提议是在单个位置 $i$ 的局域更新：$s_i' = s_i + \\delta$，而对于 $j \\neq i$，$s_j'=s_j$。\n\n首先，我们计算辅助作用量的变化，$\\Delta S_{\\mathrm{aux}} = S_{\\mathrm{aux}}[\\mathbf{s'}] - S_{\\mathrm{aux}}[\\mathbf{s}]$。\n$$\nS_{\\mathrm{aux}}[\\mathbf{s'}] = \\left(\\sum_{j \\neq i} \\frac{s_j^2}{2\\sigma^2}\\right) + \\frac{(s_i + \\delta)^2}{2\\sigma^2} = S_{\\mathrm{aux}}[\\mathbf{s}] - \\frac{s_i^2}{2\\sigma^2} + \\frac{s_i^2 + 2s_i\\delta + \\delta^2}{2\\sigma^2}\n$$\n因此，作用量的变化是：\n$$\n\\Delta S_{\\mathrm{aux}} = \\frac{2s_i\\delta + \\delta^2}{2\\sigma^2}\n$$\n比率 $R$ 中的第一个因子是 $e^{-\\Delta S_{\\mathrm{aux}}}$。\n\n其次，我们处理费米子行列式的比值。对 $s_i$ 的局域更新引起费米子矩阵 $M[\\mathbf{s}] = I + \\alpha \\Delta + \\lambda\\,\\mathrm{diag}(\\mathbf{s})$ 的变化。新矩阵是：\n$$\nM[\\mathbf{s'}] = I + \\alpha \\Delta + \\lambda\\,\\mathrm{diag}(s_0, \\dots, s_i + \\delta, \\dots, s_{L-1}) = M[\\mathbf{s}] + \\lambda \\delta \\, \\mathbf{e}_i \\mathbf{e}_i^T\n$$\n其中 $\\mathbf{e}_i$ 是在索引 $i$ 处为 $1$、其他位置为零的标准基列向量。这是一个形如 $A' = A + \\mathbf{u}\\mathbf{v}^T$ 的秩-1 更新，其中 $A=M[\\mathbf{s}]$，$\\mathbf{u} = \\lambda\\delta\\,\\mathbf{e}_i$，以及 $\\mathbf{v} = \\mathbf{e}_i$。\n\n我们应用矩阵行列式引理，该引理指出 $\\det(A + \\mathbf{u}\\mathbf{v}^T) = (1 + \\mathbf{v}^T A^{-1} \\mathbf{u})\\det(A)$。\n$$\n\\det M[\\mathbf{s'}] = \\left(1 + \\mathbf{e}_i^T (M[\\mathbf{s}])^{-1} (\\lambda\\delta\\,\\mathbf{e}_i)\\right) \\det M[\\mathbf{s}]\n$$\n令 $G[\\mathbf{s}] \\equiv (M[\\mathbf{s}])^{-1}$ 为费米子格林函数（传播子）。项 $\\mathbf{e}_i^T G[\\mathbf{s}] \\mathbf{e}_i$ 正是其对角元 $G_{ii}[\\mathbf{s}]$。因此，行列式比值为：\n$$\n\\frac{\\det M[\\mathbf{s'}]}{\\det M[\\mathbf{s}]} = 1 + \\lambda\\delta\\,G_{ii}[\\mathbf{s}]\n$$\n这个优雅的结果避免了直接计算行列式这一计算成本过高的任务。\n\n结合这两个部分，完整的比率 $R$ 是：\n$$\nR = e^{-\\frac{2s_i\\delta + \\delta^2}{2\\sigma^2}} \\left(1 + \\lambda\\delta\\,G_{ii}[\\mathbf{s}]\\right)^{N_f}\n$$\n如果项 $1 + \\lambda\\delta\\,G_{ii}[\\mathbf{s}]$ 为负，则表示所提议的移动穿过了费米子矩阵的一个奇点，导致行列式符号的改变。在标准的 Metropolis-Hastings 实现中，对于一个（必须为非负的）概率分布，这样的移动将被拒绝。因此，如果 $R  0$，接受概率为 $0$。最终的接受概率是：\n$$\nA(\\mathbf{s} \\to \\mathbf{s'}) = \\min(1, \\max(0, R))\n$$\n根据问题的要求，我们不计算完整的逆矩阵 $G[\\mathbf{s}]$。相反，为了找到单个元素 $G_{ii}[\\mathbf{s}]$，我们求解线性方程组 $M[\\mathbf{s}]\\,\\mathbf{x} = \\mathbf{e}_i$。解向量 $\\mathbf{x}$ 是 $G[\\mathbf{s}]$ 的第 $i$ 列。所需的元素就是该向量的第 $i$ 个分量：$G_{ii}[\\mathbf{s}] = x_i$。\n\n每个测试用例的算法如下：\n1.  使用给定参数构建 $L \\times L$ 矩阵 $M[\\mathbf{s}] = I + \\alpha\\Delta + \\lambda\\,\\mathrm{diag}(\\mathbf{s})$。离散拉普拉斯算子 $\\Delta$ 的元素为 $\\Delta_{jj}=2$, $\\Delta_{j, j\\pm 1 \\pmod L} = -1$。\n2.  定义列向量 $\\mathbf{e}_i$。\n3.  求解线性系统 $M[\\mathbf{s}]\\,\\mathbf{x} = \\mathbf{e}_i$ 以得到 $\\mathbf{x}$。\n4.  提取所需的格林函数元素 $G_{ii}[\\mathbf{s}] = x_i$。\n5.  计算作用量变化 $\\Delta S_{\\mathrm{aux}} = (2s_i\\delta + \\delta^2)/(2\\sigma^2)$。\n6.  计算比率 $R = \\exp(-\\Delta S_{\\mathrm{aux}}) \\times (1 + \\lambda\\delta\\,G_{ii}[\\mathbf{s}])^{N_f}$。\n7.  计算接受概率 $A = \\min(1, \\max(0, R))$。\n\n现在为提供的测试套件实现此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve\n\ndef solve_problem():\n    \"\"\"\n    Solves the problem for all test cases and prints the results.\n    \"\"\"\n\n    def construct_fermion_matrix(L, alpha, lam, s_vec):\n        \"\"\"Constructs the fermion matrix M[s].\"\"\"\n        # Initialize with the identity matrix part\n        M = np.identity(L)\n\n        # Add the kinetic term (alpha * Delta)\n        # The 1D Laplacian with periodic boundary conditions\n        if alpha != 0:\n            laplacian = np.zeros((L, L))\n            for i in range(L):\n                laplacian[i, i] = 2\n                laplacian[i, (i + 1) % L] = -1\n                laplacian[i, (i - 1 + L) % L] = -1\n            M += alpha * laplacian\n        \n        # Add the auxiliary field coupling term (lambda * diag(s))\n        M += lam * np.diag(s_vec)\n        \n        return M\n\n    def calculate_acceptance_prob(L, alpha, lam, Nf, sigma, s_vec, i, delta):\n        \"\"\"\n        Calculates the Metropolis-Hastings acceptance probability for a local update.\n        \"\"\"\n        # Handle the trivial case where there is no change.\n        if delta == 0.0:\n            return 1.0\n\n        #  1. Construct the fermion matrix M[s] for the current configuration.\n        M = construct_fermion_matrix(L, alpha, lam, s_vec)\n        \n        #  2. Solve for the required element of the Green's function, G_ii.\n        #  This is done by solving the linear system M*x = e_i.\n        e_i = np.zeros(L)\n        e_i[i] = 1.0\n        \n        try:\n            # The solution vector x is the i-th column of the inverse of M.\n            x = solve(M, e_i, assume_a='gen') \n        except np.linalg.LinAlgError:\n            # If the matrix is singular, the determinant is zero.\n            # The update would result in a det ratio of infinity or be ill-defined.\n            # Such moves are rejected.\n            return 0.0\n\n        # The required element G_ii is the i-th component of the solution vector.\n        G_ii = x[i]\n        \n        #  3. Calculate the ratio R = P(s') / P(s).\n        #  Change in the auxiliary field action.\n        s_i = s_vec[i]\n        delta_S_aux = (2 * s_i * delta + delta**2) / (2 * sigma**2)\n        \n        #  Ratio of fermion determinants.\n        det_ratio_term = 1 + lam * delta * G_ii\n        \n        # If the determinant ratio is negative, it implies a sign problem.\n        # A move from a positive-weight state to a negative-weight state is rejected.\n        if det_ratio_term  0:\n            return 0.0\n            \n        # Full ratio R\n        R = np.exp(-delta_S_aux) * (det_ratio_term ** Nf)\n\n        #  4. The acceptance probability is min(1, R).\n        # We must also ensure R is not negative, though handled above.\n        A = min(1.0, R)\n        \n        return A\n\n    test_cases = [\n        # 1. Happy path case\n        (6, 0.15, 0.6, 2, 1.0, np.array([0.1, -0.05, 0.2, -0.1, 0.0, 0.05]), 3, 0.1),\n        # 2. Boundary kinetic case (alpha = 0)\n        (6, 0.0, 0.7, 2, 1.0, np.array([0.2, 0.2, 0.2, 0.2, 0.2, 0.2]), 2, -0.05),\n        # 3. Single-flavor case with periodic boundary\n        (8, 0.05, 1.0, 1, 1.0, 0.1 * np.cos(2 * np.pi * np.arange(8) / 8), 7, 0.2),\n        # 4. Zero update case\n        (4, 0.2, 0.3, 2, 1.0, np.array([0.05, -0.05, 0.03, -0.02]), 1, 0.0),\n        # 5. Strong auxiliary penalty case\n        (10, 0.1, 0.9, 2, 0.5, np.array([0.1, -0.05, 0.08, -0.02, 0.03, 0.05, -0.04, 0.06, -0.01, 0.02]), 5, -0.4)\n    ]\n    \n    results = []\n    for case in test_cases:\n        L, alpha, lam, Nf, sigma, s_vec, i, delta = case\n        prob = calculate_acceptance_prob(L, alpha, lam, Nf, sigma, s_vec, i, delta)\n        results.append(prob)\n        \n    # Format the final output string\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve_problem()\n```"
        },
        {
            "introduction": "对于包含费米子的蒙特卡洛模拟，一个被称为“符号问题”的根本性难题常常会阻碍我们获得精确的结果。本练习  旨在揭开这个高级课题的神秘面纱，展示如何利用物理洞察力来驯服它。你将通过一个简化的模型来分析符号问题的来源，并理解为何像Wigner的$SU(4)$自旋-同位旋对称性这样的近似对称性，能够极大地缓解该问题，从而将一个原理上的障碍转化为一个工程上可控的挑战。",
            "id": "3567137",
            "problem": "考虑一个在具有周期性边界条件和虚时范围的立方空间格点上的非相对论性核系统，该系统采用格点有效场论进行描述。引入辅助场的格点路径积分会产生一个复费米子行列式。在辅助场量子蒙特卡罗（AFQMC）方法中，符号问题表现为此行列式复相位的振荡。在接近四维维格纳特殊酉群（SU(4)）对称性时，符号问题在经验上和理论上都得到缓解。引入一个混合参数 $\\lambda \\in [0,1]$，它在 $\\lambda=1$ 处的SU(4)对称哈密顿量和 $\\lambda=0$ 处的完整物理哈密顿量之间进行插值。粒子数密度为 $\\rho = N/L^3$（以格点单位计），其中 $L$ 是每个空间维度上的格点数，虚时范围用 $\\beta$ 表示（以格点时间步长为单位）。角度（相位）以弧度为单位。\n\n您的任务是通过计算相位淬火重加权因子来量化符号问题的缓解程度。该因子定义为完整配分函数与相位淬火配分函数之比，是 $\\lambda$ 和 $\\rho$ 的函数。请从配分函数的AFQMC路径积分表示、相位淬火系综的定义以及费米子行列式复相位的累积量展开出发。仅使用基本定律和经过充分检验的事实：路径积分分解为幅度和相位、相位淬火期望值的定义、同位旋对称系统在零化学势下的时间反演对称性、弱关联局域贡献之和的涨落广延性，以及大量弱相关随机变量之和的中心极限定理。\n\n您的任务是：\n1) 基于第一性原理和这些假设，推导相位淬火重加权因子的闭式表达式（用相位的累积量表示），并将其特化为中心极限定理所蕴含的高斯累积量近似。解释为什么在 $\\lambda=1$ 附近，对到SU(4)对称点距离的主导依赖关系是 $(1-\\lambda)$ 的二次方，以及为什么相位的方差与时空体积和密度 $\\rho$ 成线性关系。\n2) 将领头阶相位方差参数化为一个广延量，其形式为一个无量纲低能常数 $\\alpha$ 乘以适当的因子。将 $\\alpha$ 视为一个给定的校准常数。使用此参数化方法，提供一个明确的算法，用于计算任意输入（以格点单位计）$(\\lambda,\\rho,L,\\beta)$ 的重加权因子。\n3) 将此算法实现为一个完整的程序，为以下测试套件生成重加权因子。使用格点单位，其中空间格点间距 $a=1$，虚时间步长 $\\Delta \\tau = 1$，因此 $L$、$\\beta$ 和 $\\rho$ 均为无量纲量。使用固定参数 $L=4$，$\\beta=6$ 和 $\\alpha=0.05$。测试套件包含以下 $(\\lambda,\\rho)$ 对：\n   - $(1.0,\\,0.10)$\n   - $(0.0,\\,0.10)$\n   - $(0.5,\\,0.10)$\n   - $(0.25,\\,0.00)$\n   - $(0.25,\\,0.30)$\n   - $(0.80,\\,0.50)$\n\n输出要求：\n- 您的程序必须为每一对参数计算相位淬火重加权因子，结果为浮点数值。\n- 将最终结果表示为无量纲浮点数，四舍五入到小数点后恰好 $6$ 位。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的结果列表，并用方括号括起来（例如，$[r_1,r_2,\\dots]$），顺序与上述测试套件相同。",
            "solution": "问题R-0193是计算核物理领域中的一个有效问题。它科学地基于格点量子蒙特卡罗模拟的原理，问题良定，目标明确，信息充分，并使用客观、正式的语言。该问题要求基于基本原理和标准近似，推导并应用辅助场量子蒙特卡罗（AFQMC）模拟中相位淬火重加权因子的公式。我们将着手解决。\n\n按照要求，解决方案分为两个主要部分：首先，从第一性原理推导所需的表达式；其次，对此表达式进行参数化并应用于计算给定测试用例集的重加权因子。\n\n**1. 重加权因子的推导**\n\n在AFQMC路径积分形式中，核系统的配分函数 $Z$ 由对辅助场构型 $s$ 的积分给出：\n$$ Z = \\int \\mathcal{D}s \\, \\det[M(s)] $$\n其中 $M(s)$ 是给定辅助场构型 $s$ 的费米子矩阵。通常情况下，费米子行列式 $\\det[M(s)]$ 是一个复数。符号问题源于此复数值的振荡性质。我们可以将行列式分解为其幅度和相位：\n$$ \\det[M(s)] = |\\det[M(s)]| e^{i\\theta(s)} $$\n其中 $\\theta(s)$ 是构型 $s$ 的行列式的复相位。配分函数可写为：\n$$ Z = \\int \\mathcal{D}s \\, |\\det[M(s)]| e^{i\\theta(s)} $$\n相位淬火配分函数 $Z_{PQ}$ 的定义是将相位设为零，从而有效地忽略符号问题：\n$$ Z_{PQ} = \\int \\mathcal{D}s \\, |\\det[M(s)]| $$\n被积函数 $|\\det[M(s)]|$ 是实数且非负的，可以解释为蒙特卡罗抽样的概率权重。由这些权重定义的系综称为相位淬火系综。\n\n我们记为 $R$ 的相位淬火重加权因子，是完整配分函数与相位淬火配分函数之比。该因子度量了相位因子 $e^{i\\theta}$ 在相位淬火系综上的平均值：\n$$ R = \\frac{Z}{Z_{PQ}} = \\frac{\\int \\mathcal{D}s \\, |\\det[M(s)]| e^{i\\theta(s)}}{\\int \\mathcal{D}s \\, |\\det[M(s)]|} \\equiv \\langle e^{i\\theta} \\rangle_{PQ} $$\n为了计算这个期望值，我们使用随机变量 $i\\theta$ 的指数的期望值的累积量展开：\n$$ \\langle e^{i\\theta} \\rangle_{PQ} = \\exp\\left( \\sum_{n=1}^{\\infty} \\frac{(i)^n}{n!} \\kappa_n(\\theta) \\right) $$\n其中 $\\kappa_n(\\theta)$ 是在相位淬火系综中计算的相位 $\\theta$ 的第$n$阶累积量。前两阶累积量分别是平均值 $\\kappa_1 = \\langle \\theta \\rangle_{PQ}$ 和方差 $\\kappa_2 = \\sigma^2_\\theta = \\langle \\theta^2 \\rangle_{PQ} - (\\langle \\theta \\rangle_{PQ})^2$。\n\n问题指定了一个在零化学势下的同位旋对称系统，该系统具有时间反演对称性。此对称性意味着，对于任何具有相位 $\\theta(s)$ 的辅助场构型 $s$，都存在一个相应的时间反演构型 $s'$，其相位为 $-\\theta(s')$，且权重相同 $|\\det[M(s)]|=|\\det[M(s')]|$。因此，在相位淬火系综中，相位 $\\theta$ 的概率分布是对称的，即 $P(\\theta) = P(-\\theta)$。这种对称性迫使所有奇数阶矩以及所有奇数阶累积量为零：对所有奇数 $n$，$\\kappa_n(\\theta) = 0$。因此，累积量展开简化为：\n$$ R = \\exp\\left( \\frac{i^2}{2!} \\kappa_2(\\theta) + \\frac{i^4}{4!} \\kappa_4(\\theta) + \\dots \\right) = \\exp\\left( -\\frac{1}{2}\\kappa_2(\\theta) + \\frac{1}{24}\\kappa_4(\\theta) - \\dots \\right) $$\n问题援引了中心极限定理。系统的总相位 $\\theta$ 是一个广延量，可以看作是遍布整个时空体积的许多弱关联局域贡献之和。根据中心极限定理，这样一个和的分布趋向于高斯分布。高斯分布的一个关键性质是其二阶以上的累积量均为零，即当 $n  2$ 时 $\\kappa_n = 0$。采用这种“高斯累积量近似”，我们只保留展开式中的领头项：\n$$ R \\approx \\exp\\left( -\\frac{1}{2}\\kappa_2(\\theta) \\right) = \\exp\\left( -\\frac{1}{2}\\sigma^2_\\theta \\right) $$\n这就得到了所要求的重加权因子的闭式表达式，用相位的方差 $\\sigma^2_\\theta$ 表示。\n\n接下来，我们分析 $\\sigma^2_\\theta$ 对物理参数的依赖关系。\n\n在 $\\lambda=1$ 时，系统具有Wigner SU(4)对称性。在此极限下，已知费米子行列式为实数且非负，这意味着对于所有构型，相位 $\\theta(s)$ 恒为零。因此，相位的方差为零：$\\sigma^2_\\theta(\\lambda=1)=0$。对该对称点的偏离由哈密顿量中破坏SU(4)对称性的项控制，这些项与 $(1-\\lambda)$ 成正比。对于小微扰，产生的相位 $\\theta(s)$ 预期与微扰强度成线性关系，因此 $\\theta(s) \\propto (1-\\lambda)$。由于时间反演对称性确保了 $\\langle \\theta \\rangle_{PQ} = 0$，方差为 $\\sigma^2_\\theta = \\langle \\theta^2 \\rangle_{PQ}$。因此，在对称点附近的领头阶依赖关系是二次方的：\n$$ \\sigma^2_\\theta(\\lambda) \\propto (1-\\lambda)^2 \\quad \\text{for } \\lambda \\to 1 $$\n广延性假设意味着总相位的方差，作为来自整个时空体积 $V_{ST} = L^3\\beta$ 的贡献之和，与该体积成线性关系：\n$$ \\sigma^2_\\theta \\propto L^3\\beta $$\n最后，符号问题是费米子相互作用的结果。在真空中，粒子密度 $\\rho=N/L^3=0$，没有费米子，因此没有符号问题，所以 $\\sigma^2_\\theta(\\rho=0)=0$。对于低密度情况，符号问题的严重性预期与粒子数成正比，因此与密度 $\\rho$ 成线性关系。\n$$ \\sigma^2_\\theta \\propto \\rho $$\n\n**2. 算法与实现**\n\n结合这些标度行为，我们可以为相位方差构建一个有物理动机的参数化形式。我们引入一个无量纲低能常数 $\\alpha$ 来捕捉相位涨落的总体强度，该强度取决于核相互作用的细节。\n$$ \\sigma^2_\\theta(\\lambda, \\rho, L, \\beta) = \\alpha (1-\\lambda)^2 \\rho L^3 \\beta $$\n这个表达式正确地反映了对偏离SU(4)对称性的二次方依赖关系，以及与密度和时空体积的线性标度关系。\n\n用于计算给定输入集 $(\\lambda, \\rho, L, \\beta)$ 和校准常数 $\\alpha$ 的重加权因子 $R$ 的算法如下：\n1.  接收输入参数：$\\lambda$、$\\rho$、$L$、$\\beta$ 和 $\\alpha$。\n2.  使用公式 $\\sigma^2_\\theta = \\alpha \\cdot (1-\\lambda)^2 \\cdot \\rho \\cdot L^3 \\cdot \\beta$ 计算相位方差 $\\sigma^2_\\theta$。\n3.  使用高斯近似 $R = \\exp(-\\frac{1}{2} \\sigma^2_\\theta)$ 计算重加权因子 $R$。\n4.  返回 $R$ 的值。\n\n我们现在将此算法应用于指定的测试套件，固定参数为 $L=4$，$\\beta=6$ 和 $\\alpha=0.05$。时空体积为 $V_{ST} = L^3 \\beta = 4^3 \\times 6 = 384$。重加权因子的公式变为：\n$$ R(\\lambda, \\rho) = \\exp\\left( -\\frac{1}{2} \\cdot 0.05 \\cdot (1-\\lambda)^2 \\cdot \\rho \\cdot 384 \\right) = \\exp\\left( -9.6 \\cdot (1-\\lambda)^2 \\cdot \\rho \\right) $$\n\n每个测试用例的计算如下：\n- 用例 1: $(\\lambda, \\rho) = (1.0, 0.10)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-1.0)^2 \\cdot 0.10\\right) = \\exp(0) = 1.0 $$\n- 用例 2: $(\\lambda, \\rho) = (0.0, 0.10)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.0)^2 \\cdot 0.10\\right) = \\exp(-0.96) \\approx 0.382893 $$\n- 用例 3: $(\\lambda, \\rho) = (0.5, 0.10)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.5)^2 \\cdot 0.10\\right) = \\exp(-9.6 \\cdot 0.25 \\cdot 0.10) = \\exp(-0.24) \\approx 0.786628 $$\n- 用例 4: $(\\lambda, \\rho) = (0.25, 0.00)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.25)^2 \\cdot 0.00\\right) = \\exp(0) = 1.0 $$\n- 用例 5: $(\\lambda, \\rho) = (0.25, 0.30)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.25)^2 \\cdot 0.30\\right) = \\exp(-9.6 \\cdot 0.5625 \\cdot 0.30) = \\exp(-1.62) \\approx 0.197900 $$\n- 用例 6: $(\\lambda, \\rho) = (0.80, 0.50)$\n  $$ R = \\exp\\left(-9.6 \\cdot (1-0.80)^2 \\cdot 0.50\\right) = \\exp(-9.6 \\cdot 0.04 \\cdot 0.50) = \\exp(-0.192) \\approx 0.825298 $$\n\n这些结果将由提供的Python程序生成。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the phase-quenched reweighting factor for a series of test cases\n    in lattice effective field theory for nuclei.\n    \"\"\"\n\n    # Fixed parameters from the problem statement\n    L = 4       # Number of lattice sites in each spatial dimension\n    beta = 6    # Imaginary-time extent in lattice units\n    alpha = 0.05 # Dimensionless low-energy constant\n\n    # Test suite of (lambda, rho) pairs\n    test_cases = [\n        (1.0, 0.10),\n        (0.0, 0.10),\n        (0.5, 0.10),\n        (0.25, 0.00),\n        (0.25, 0.30),\n        (0.80, 0.50),\n    ]\n\n    results = []\n    \n    # Calculate the constant part of the exponent for efficiency\n    # Exponent = -1/2 * sigma^2_theta\n    # sigma^2_theta = alpha * (1-lambda)^2 * rho * L^3 * beta\n    # Exponent = -1/2 * alpha * L^3 * beta * (1-lambda)^2 * rho\n    exponent_coeff = -0.5 * alpha * (L**3) * beta\n\n    for case in test_cases:\n        lambda_mix, rho = case\n\n        # The phase variance sigma^2_theta is parameterized as:\n        # sigma_sq = alpha * (1 - lambda)^2 * rho * L^3 * beta\n        # The reweighting factor R is exp(-1/2 * sigma_sq)\n        \n        # We can write the exponent directly as:\n        exponent = exponent_coeff * (1.0 - lambda_mix)**2 * rho\n        \n        # Calculate the reweighting factor\n        reweighting_factor = np.exp(exponent)\n        \n        results.append(reweighting_factor)\n\n    # Format the results to 6 decimal places as strings\n    formatted_results = [f\"{r:.6f}\" for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}