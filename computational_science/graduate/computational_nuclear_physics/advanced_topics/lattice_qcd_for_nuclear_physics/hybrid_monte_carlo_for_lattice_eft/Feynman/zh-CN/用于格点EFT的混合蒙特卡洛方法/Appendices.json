{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂算法之前，理解蒙特卡洛方法为何能首先应用于费米子系统至关重要。本次实践  使用一个极简的2格点模型，来演示一个关键特性：在一个具有时间反演对称性的系统中，费米子行列式如何保持为实数和正数，从而确保了有效的概率权重。这个动手计算将巩固作为格点有效场论混合蒙特卡洛（HMC）框架理论基础的核心概念。",
            "id": "3563899",
            "problem": "考虑一个用于格点有效场论 (EFT) 的混合蒙特卡洛 (HMC) 方法中的费米子矩阵结构的最小示例，该示例包含在一维空间格点上的两个简并的自旋-同位旋种类。从非相对论性核子的欧几里得格点路径积分出发，该积分包含一个静态背景 Hubbard-Stratonovich (HS) 辅助场，其中对二次费米子作用量的格拉斯曼积分产生费米子行列式。在一个具有周期性边界条件和单个欧几里得时间片的 $L = 2$ 个格点的空间格点上，将单种类费米子矩阵取为位形空间矩阵\n$$\nM(\\kappa,\\lambda) \\equiv \\mathbb{1} - \\kappa H - i \\lambda D,\n$$\n其中 $H$ 编码最近邻跃迁，$D$ 编码一个位形对角的 HS 场构型。令\n$$\nH \\equiv \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}, \\quad D \\equiv \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}.\n$$\n对于通过时间反演（或等效地，二次型的复共轭对称性）相关的两个简并的自旋-同位旋种类，第二种类的单种类矩阵是复共轭矩阵 $M(\\kappa,\\lambda)^{*}$，因此位形空间中的组合双种类费米子矩阵是块对角矩阵\n$$\n\\mathcal{M}(\\kappa,\\lambda) \\equiv \\begin{pmatrix} M(\\kappa,\\lambda)  0 \\\\ 0  M(\\kappa,\\lambda)^{*} \\end{pmatrix}.\n$$\n仅使用上述定义以及对二次费米子作用量的格拉斯曼积分产生作为权重的费米子矩阵行列式这一事实，为参数选择 $\\kappa = \\frac{1}{2}$ 和 $\\lambda = 1$ 显式构造 $\\mathcal{M}(\\kappa,\\lambda)$，找出 $M(\\kappa,\\lambda)$ 的本征值以展示复共轭配对，并计算双种类矩阵的行列式 $\\det \\mathcal{M}(\\kappa,\\lambda)$。将 $\\det \\mathcal{M}(\\kappa,\\lambda)$ 的最终结果表示为一个无单位的精确有理数。只提供数值作为最终答案，无需四舍五入。",
            "solution": "问题要求显式构造双种类费米子矩阵 $\\mathcal{M}(\\kappa,\\lambda)$，分析其构成的单种类矩阵 $M(\\kappa,\\lambda)$ 的本征值，并计算在特定参数值下 $\\mathcal{M}(\\kappa,\\lambda)$ 的行列式。\n\n单种类费米子矩阵定义为：\n$$\nM(\\kappa,\\lambda) \\equiv \\mathbb{1} - \\kappa H - i \\lambda D\n$$\n其中 $\\mathbb{1}$ 是 $2 \\times 2$ 单位矩阵，$H$ 和 $D$ 由下式给出：\n$$\nH \\equiv \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}, \\quad D \\equiv \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}\n$$\n问题指定了参数值为 $\\kappa = \\frac{1}{2}$ 和 $\\lambda = 1$。代入这些值，我们首先构造矩阵 $M(\\frac{1}{2}, 1)$。\n\n$$\nM\\left(\\frac{1}{2}, 1\\right) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} - i(1) \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}\n$$\n$$\nM\\left(\\frac{1}{2}, 1\\right) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 0  \\frac{1}{2} \\\\ \\frac{1}{2}  0 \\end{pmatrix} - \\begin{pmatrix} i  0 \\\\ 0  -i \\end{pmatrix}\n$$\n$$\nM\\left(\\frac{1}{2}, 1\\right) = \\begin{pmatrix} 1 - 0 - i  0 - \\frac{1}{2} - 0 \\\\ 0 - \\frac{1}{2} - 0  1 - 0 - (-i) \\end{pmatrix} = \\begin{pmatrix} 1 - i  -\\frac{1}{2} \\\\ -\\frac{1}{2}  1 + i \\end{pmatrix}\n$$\n\n双种类费米子矩阵 $\\mathcal{M}(\\kappa,\\lambda)$ 被定义为一个包含 $M(\\kappa,\\lambda)$ 及其复共轭 $M(\\kappa,\\lambda)^{*}$ 的块对角矩阵。\n$$\nM\\left(\\frac{1}{2}, 1\\right)^{*} = \\left( \\begin{pmatrix} 1 - i  -\\frac{1}{2} \\\\ -\\frac{1}{2}  1 + i \\end{pmatrix} \\right)^{*} = \\begin{pmatrix} 1 + i  -\\frac{1}{2} \\\\ -\\frac{1}{2}  1 - i \\end{pmatrix}\n$$\n因此，$\\mathcal{M}(\\frac{1}{2}, 1)$ 的显式构造为：\n$$\n\\mathcal{M}\\left(\\frac{1}{2}, 1\\right) = \\begin{pmatrix} M(\\frac{1}{2}, 1)  0 \\\\ 0  M(\\frac{1}{2}, 1)^{*} \\end{pmatrix} = \\begin{pmatrix} 1 - i  -\\frac{1}{2}  0  0 \\\\ -\\frac{1}{2}  1 + i  0  0 \\\\ 0  0  1 + i  -\\frac{1}{2} \\\\ 0  0  -\\frac{1}{2}  1 - i \\end{pmatrix}\n$$\n\n接下来，我们找出 $M(\\frac{1}{2}, 1)$ 的本征值以展示复共轭配对。本征值 $z$ 是特征方程 $\\det(M(\\frac{1}{2}, 1) - z \\mathbb{1}) = 0$ 的根。\n$$\n\\det \\begin{pmatrix} 1 - i - z  -\\frac{1}{2} \\\\ -\\frac{1}{2}  1 + i - z \\end{pmatrix} = 0\n$$\n$$\n(1 - i - z)(1 + i - z) - \\left(-\\frac{1}{2}\\right)\\left(-\\frac{1}{2}\\right) = 0\n$$\n这可以改写为：\n$$\n((1 - z) - i)((1 - z) + i) - \\frac{1}{4} = 0\n$$\n$$\n(1 - z)^{2} - i^{2} - \\frac{1}{4} = 0\n$$\n$$\n(1 - z)^{2} + 1 - \\frac{1}{4} = 0\n$$\n$$\n(1 - z)^{2} + \\frac{3}{4} = 0\n$$\n$$\n(1 - z)^{2} = -\\frac{3}{4}\n$$\n对两边取平方根得到：\n$$\n1 - z = \\pm \\sqrt{-\\frac{3}{4}} = \\pm i \\frac{\\sqrt{3}}{2}\n$$\n解出 $z$，我们得到两个本征值：\n$$\nz = 1 \\mp i \\frac{\\sqrt{3}}{2}\n$$\n本征值为 $z_{1} = 1 - i \\frac{\\sqrt{3}}{2}$ 和 $z_{2} = 1 + i \\frac{\\sqrt{3}}{2}$。这两个本征值形成一个复共轭对，满足 $z_{2} = z_{1}^{*}$，符合要求。\n\n最后，我们计算双种类矩阵的行列式 $\\det \\mathcal{M}(\\frac{1}{2}, 1)$。由于 $\\mathcal{M}$ 是一个块对角矩阵，其行列式是对角块行列式的乘积：\n$$\n\\det \\mathcal{M} = \\det(M) \\det(M^{*})\n$$\n一个矩阵的行列式是其本征值的乘积。对于 $M(\\frac{1}{2}, 1)$，我们有：\n$$\n\\det(M) = z_{1} z_{2} = \\left(1 - i \\frac{\\sqrt{3}}{2}\\right)\\left(1 + i \\frac{\\sqrt{3}}{2}\\right) = 1^{2} - \\left(i \\frac{\\sqrt{3}}{2}\\right)^{2} = 1 - \\left(i^{2} \\frac{3}{4}\\right) = 1 - \\left(-\\frac{3}{4}\\right) = 1 + \\frac{3}{4} = \\frac{7}{4}\n$$\n对于复共轭矩阵 $M^{*}$，我们使用性质 $\\det(A^{*}) = (\\det A)^{*}$。\n$$\n\\det(M^{*}) = (\\det M)^{*} = \\left(\\frac{7}{4}\\right)^{*} = \\frac{7}{4}\n$$\n因为 $\\det(M)$ 是一个实数。\n因此，双种类矩阵的行列式为：\n$$\n\\det \\mathcal{M}\\left(\\frac{1}{2}, 1\\right) = \\det(M) \\det(M^{*}) = \\left(\\frac{7}{4}\\right) \\left(\\frac{7}{4}\\right) = \\frac{49}{16}\n$$\n这个结果是实数且为正，这是蒙特卡洛模拟有效性的一个必要特征，因为费米子行列式在路径积分中作为权重出现。",
            "answer": "$$\\boxed{\\frac{49}{16}}$$"
        },
        {
            "introduction": "任何HMC模拟的准确性都取决于力的正确计算，即作用量的梯度。本次实践  通过实现有限差分力检验来解决代码验证这一基本任务。你将推导一个玩具模型作用量的解析梯度，并将其与数值近似进行比较，这是调试和确保任何科学模拟代码可靠性的基本技能。",
            "id": "3563928",
            "problem": "你的任务是为一个代表格点有效场论 (EFT) 中使用的混合蒙特卡洛 (HMC) 的一维格点场论玩具模型，实现并验证一个有限差分力检验。该验证必须将欧几里得作用量梯度的中心有限差分估计与基于矩阵微积分和变分微分第一性原理推导出的解析梯度进行比较。\n\n考虑一个具有 $N$ 个格点的一维周期性格点和一个实辅助场矢量 $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{N}$。定义周期性最近邻格点拉普拉斯矩阵 $\\mathbf{L} \\in \\mathbb{R}^{N \\times N}$ 为 $(\\mathbf{L}\\boldsymbol{v})_{i} = 2 v_{i} - v_{i+1} - v_{i-1}$，其中指标对 $N$ 取模。欧几里得作用量为\n$$\nS(\\boldsymbol{\\sigma}) = \\frac{1}{2}\\,\\boldsymbol{\\sigma}^{\\top}\\,\\mathbf{K}_{\\text{bos}}\\,\\boldsymbol{\\sigma} + \\frac{\\lambda}{4}\\sum_{i=0}^{N-1}\\sigma_i^{4} \\;-\\; \\log\\det\\mathbf{M}(\\boldsymbol{\\sigma}),\n$$\n其中玻色子核为 $\\mathbf{K}_{\\text{bos}} = m^{2}\\,\\mathbf{I} + \\kappa\\,\\mathbf{L}$，费米子矩阵为\n$$\n\\mathbf{M}(\\boldsymbol{\\sigma}) = \\mathbf{I} + a\\,\\mathrm{diag}\\!\\left(\\exp(\\beta\\,\\boldsymbol{\\sigma})\\right) + t\\,\\mathbf{L}.\n$$\n所有量均为无量纲。假设参数设置使得对于所有考虑的场构型，$\\mathbf{M}(\\boldsymbol{\\sigma})$ 都是对称正定的。\n\n需要实现的任务：\n\n1.  从上述定义出发，仅使用微积分和线性代数的基本规则，推导解析梯度 $\\nabla S(\\boldsymbol{\\sigma}) \\in \\mathbb{R}^{N}$。你不能假设任何非从这些基础推导出的简便公式。最终表达式对于任意 $N$ 和给定的作用量必须是正确的。\n\n2.  实现一个梯度的数值中心有限差分近似，采用分量步长。对于给定的步长尺度 $h>0$，使用分量步长 $\\,\\varepsilon_i = h\\,\\big(1 + |\\sigma_i|\\big)\\,$ 和\n$$\n\\big(\\nabla S\\big)^{\\text{FD}}_{i}(\\boldsymbol{\\sigma}) \\;=\\; \\frac{S\\big(\\boldsymbol{\\sigma} + \\varepsilon_i\\,\\mathbf{e}_i\\big) - S\\big(\\boldsymbol{\\sigma} - \\varepsilon_i\\,\\mathbf{e}_i\\big)}{2\\,\\varepsilon_i},\n$$\n其中 $\\mathbf{e}_i$ 是第 $i$ 个标准基矢量。\n\n3.  对于每个测试用例，通过在一个小的随机场训练集上观察到的解析梯度和有限差分梯度之间的一致性，直接估计一个容差。使用以下确定性过程：\n    -   使用每个测试用例特有的固定种子 $s_{\\text{train}}$（见下面的测试套件），生成 $N_{\\text{train}} = 5$ 个独立的训练构型 $\\boldsymbol{\\sigma}$，其分量从标准正态分布中抽样。对于每个构型，计算训练差异\n        $$\n        d = \\left\\|\\nabla S(\\boldsymbol{\\sigma}) - \\big(\\nabla S\\big)^{\\text{FD}}(\\boldsymbol{\\sigma})\\right\\|_{\\infty}.\n        $$\n        收集集合 $\\{d_j\\}_{j=1}^{N_{\\text{train}}}$。\n    -   计算一个尺度代理 $s = 1 + \\mathrm{median}\\big(\\{\\|\\nabla S(\\boldsymbol{\\sigma}_j)\\|_{\\infty}\\}_{j=1}^{N_{\\text{train}}}\\big)$。\n    -   将容差设置为\n        $$\n        \\mathrm{tol} = 10 \\cdot \\mathrm{median}\\left(\\{d_j\\}\\right) + 10^{-12}\\,s.\n        $$\n    这定义了一个完全基于训练集上有限差分和解析梯度之间观察到的一致性的容差。\n\n4.  使用一个独立的测试集，该测试集包含 $N_{\\text{test}} = 3$ 个随机构型，每个测试用例使用固定的种子 $s_{\\text{test}}$ 生成。当且仅当每个测试构型都满足以下条件时，宣布该测试用例通过：\n$$\n\\left\\|\\nabla S(\\boldsymbol{\\sigma}) - \\big(\\nabla S\\big)^{\\text{FD}}(\\boldsymbol{\\sigma})\\right\\|_{\\infty} \\le \\mathrm{tol}.\n$$\n\n你的程序必须为以下参数集的测试套件实现上述内容。对于每种情况，根据第4项中的规则报告一个指示通过或失败的布尔值。\n\n测试套件（每个元组为 $(N, m, \\kappa, \\lambda, a, \\beta, t, h, s_{\\text{train}}, s_{\\text{test}})$）：\n-   情况 A (顺利路径): $(4,\\, 0.5,\\, 1.0,\\, 0.1,\\, 0.7,\\, 0.6,\\, 0.2,\\, 10^{-6},\\, 12345,\\, 54321)$\n-   情况 B (最小格点，对角费米子): $(2,\\, 3.0,\\, 0.0,\\, 0.0,\\, 0.25,\\, 0.8,\\, 0.0,\\, 10^{-6},\\, 22345,\\, 64321)$\n-   情况 C (强最近邻费米子，较大的 $N$): $(8,\\, 0.1,\\, 2.0,\\, 0.0,\\, 0.5,\\, 1.0,\\, 0.5,\\, 10^{-6},\\, 32345,\\, 74321)$\n-   情况 D (四次相互作用和非常小的有限差分步长): $(6,\\, 1.2,\\, 0.5,\\, 0.5,\\, 1.0,\\, 1.2,\\, 0.3,\\, 10^{-8},\\, 42345,\\, 84321)$\n\n角度单位不适用。没有物理单位；所有量都是无量纲的。\n\n最终输出格式：你的程序应生成一行输出，其中包含 A、B、C、D 四种情况的布尔值列表，按顺序打印为Python风格的列表，例如，“[True,False,True,True]”。",
            "solution": "该问题陈述已经过严格验证，并被确定为有效。它具有科学依据、问题明确、自洽且计算上可行。它提出了计算物理中一个标准而有意义的任务：在格点场论模型的背景下，对照数值有限差分近似来验证解析推导的力项。\n\n解决方案分两个阶段进行。首先，从第一性原理推导欧几里得作用量的解析梯度（力）。其次，概述一个实现指定数值验证过程的算法。\n\n### 1. 欧几里得作用量的解析梯度\n\n欧几里得作用量 $S(\\boldsymbol{\\sigma})$ 由下式给出：\n$$\nS(\\boldsymbol{\\sigma}) = \\frac{1}{2}\\,\\boldsymbol{\\sigma}^{\\top}\\,\\mathbf{K}_{\\text{bos}}\\,\\boldsymbol{\\sigma} + \\frac{\\lambda}{4}\\sum_{i=0}^{N-1}\\sigma_i^{4} \\;-\\; \\log\\det\\mathbf{M}(\\boldsymbol{\\sigma})\n$$\n我们通过分别考虑每一项来计算梯度 $\\nabla S(\\boldsymbol{\\sigma})$，其第 $k$ 个分量是 $\\frac{\\partial S}{\\partial \\sigma_k}$。\n\n#### 1.1. 玻色子项的梯度\n\n第一项是二次玻色子作用量，$S_{\\text{bos}}(\\boldsymbol{\\sigma}) = \\frac{1}{2}\\,\\boldsymbol{\\sigma}^{\\top}\\,\\mathbf{K}_{\\text{bos}}\\,\\boldsymbol{\\sigma}$。\n玻色子核为 $\\mathbf{K}_{\\text{bos}} = m^{2}\\,\\mathbf{I} + \\kappa\\,\\mathbf{L}$。单位矩阵 $\\mathbf{I}$ 是对称的。格点拉普拉斯矩阵 $\\mathbf{L}$，由 $(\\mathbf{L}\\boldsymbol{v})_{i} = 2 v_{i} - v_{i+1} - v_{i-1}$ 定义并带有周期性边界条件，是一个实对称矩阵。具体来说，其元素为 $L_{ii}=2$，$L_{i,i\\pm 1}=-1$（指标对 $N$ 取模），其他 $L_{ij}=0$。因此，$\\mathbf{K}_{\\text{bos}}$ 是一个对称矩阵。\n\n对于具有对称矩阵 $\\mathbf{A}$ 的一般二次型 $f(\\mathbf{x}) = \\frac{1}{2}\\mathbf{x}^{\\top}\\mathbf{A}\\mathbf{x}$，其梯度为 $\\nabla f(\\mathbf{x}) = \\mathbf{A}\\mathbf{x}$。应用此规则，玻色子项的梯度为：\n$$\n\\nabla S_{\\text{bos}}(\\boldsymbol{\\sigma}) = \\mathbf{K}_{\\text{bos}}\\,\\boldsymbol{\\sigma}\n$$\n\n#### 1.2. 相互作用项的梯度\n\n第二项是四次自相互作用，$S_{\\text{int}}(\\boldsymbol{\\sigma}) = \\frac{\\lambda}{4}\\sum_{i=0}^{N-1}\\sigma_i^{4}$。\n为求梯度的第 $k$ 个分量，我们对 $\\sigma_k$ 求导：\n$$\n\\frac{\\partial S_{\\text{int}}}{\\partial \\sigma_k} = \\frac{\\partial}{\\partial \\sigma_k} \\left( \\frac{\\lambda}{4}\\sum_{i=0}^{N-1}\\sigma_i^{4} \\right) = \\frac{\\lambda}{4} \\cdot (4\\sigma_k^3) = \\lambda\\sigma_k^3\n$$\n这可以用矢量形式表示，使用逐元素（哈达玛）幂运算，记为 $\\circ 3$：\n$$\n\\nabla S_{\\text{int}}(\\boldsymbol{\\sigma}) = \\lambda\\,\\boldsymbol{\\sigma}^{\\circ 3}\n$$\n\n#### 1.3. 费米子项的梯度\n\n第三项是费米子行列式项，$S_{\\text{ferm}}(\\boldsymbol{\\sigma}) = -\\log\\det\\mathbf{M}(\\boldsymbol{\\sigma})$。\n我们使用链式法则和用于行列式微分的雅可比公式。对于可逆矩阵 $\\mathbf{A}$，$d(\\log\\det\\mathbf{A}) = \\mathrm{tr}(\\mathbf{A}^{-1}d\\mathbf{A})$。将此应用于我们的项：\n$$\nd S_{\\text{ferm}} = -d(\\log\\det\\mathbf{M}) = -\\mathrm{tr}(\\mathbf{M}^{-1}d\\mathbf{M})\n$$\n费米子矩阵 $\\mathbf{M}(\\boldsymbol{\\sigma}) = \\mathbf{I} + a\\,\\mathrm{diag}\\!\\left(\\exp(\\beta\\,\\boldsymbol{\\sigma})\\right) + t\\,\\mathbf{L}$ 对 $\\boldsymbol{\\sigma}$ 的依赖仅通过对角矩阵 $\\mathbf{D}(\\boldsymbol{\\sigma}) = a\\,\\mathrm{diag}\\!\\left(\\exp(\\beta\\,\\boldsymbol{\\sigma})\\right)$。因此，微分 $d\\mathbf{M}$ 等于 $d\\mathbf{D}$。\n\n$\\mathbf{D}$ 的分量是 $D_{ij}(\\boldsymbol{\\sigma}) = a \\exp(\\beta\\sigma_i) \\delta_{ij}$。关于 $\\sigma_k$ 的偏导数为：\n$$\n\\frac{\\partial D_{ij}}{\\partial \\sigma_k} = a \\frac{\\partial}{\\partial \\sigma_k} (\\exp(\\beta\\sigma_i)\\delta_{ij}) = a \\beta \\exp(\\beta\\sigma_i) \\delta_{ik} \\delta_{ij}\n$$\n这仅在 $i=j=k$ 时非零。因此，矩阵 $\\frac{\\partial \\mathbf{M}}{\\partial \\sigma_k} = \\frac{\\partial \\mathbf{D}}{\\partial \\sigma_k}$ 只有一个非零元素，位于位置 $(k,k)$：\n$$\n\\left(\\frac{\\partial \\mathbf{M}}{\\partial \\sigma_k}\\right)_{kk} = a \\beta \\exp(\\beta\\sigma_k)\n$$\n这可以使用标准基矢量 $\\mathbf{e}_k$ 写成 $\\frac{\\partial \\mathbf{M}}{\\partial \\sigma_k} = a \\beta \\exp(\\beta\\sigma_k) \\mathbf{e}_k \\mathbf{e}_k^{\\top}$。\n\n总微分 $d\\mathbf{M}$ 是 $d\\mathbf{M} = \\sum_{k=0}^{N-1} \\frac{\\partial \\mathbf{M}}{\\partial \\sigma_k} d\\sigma_k$。将其代入迹的表达式中：\n$$\nd S_{\\text{ferm}} = -\\mathrm{tr}\\left(\\mathbf{M}^{-1} \\sum_{k=0}^{N-1} a \\beta \\exp(\\beta\\sigma_k) \\mathbf{e}_k \\mathbf{e}_k^{\\top} d\\sigma_k\\right)\n$$\n根据迹的线性性质，我们可以将求和移到外面：\n$$\nd S_{\\text{ferm}} = -\\sum_{k=0}^{N-1} a \\beta \\exp(\\beta\\sigma_k) \\mathrm{tr}(\\mathbf{M}^{-1} \\mathbf{e}_k \\mathbf{e}_k^{\\top}) d\\sigma_k\n$$\n利用迹的循环性质 $\\mathrm{tr}(\\mathbf{A}\\mathbf{B}) = \\mathrm{tr}(\\mathbf{B}\\mathbf{A})$，我们有 $\\mathrm{tr}(\\mathbf{M}^{-1} \\mathbf{e}_k \\mathbf{e}_k^{\\top}) = \\mathrm{tr}(\\mathbf{e}_k^{\\top}\\mathbf{M}^{-1}\\mathbf{e}_k)$。项 $\\mathbf{e}_k^{\\top}\\mathbf{M}^{-1}\\mathbf{e}_k$ 是一个 $1 \\times 1$ 矩阵（一个标量），对应于 $\\mathbf{M}^{-1}$ 的第 $k$ 个对角元素，我们将其表示为 $(\\mathbf{M}^{-1})_{kk}$。\n微分变为：\n$$\nd S_{\\text{ferm}} = -\\sum_{k=0}^{N-1} a \\beta \\exp(\\beta\\sigma_k) (\\mathbf{M}^{-1})_{kk} d\\sigma_k\n$$\n根据定义，$d S_{\\text{ferm}} = \\sum_{k=0}^{N-1} (\\nabla S_{\\text{ferm}})_k d\\sigma_k$。比较系数可得梯度的第 $k$ 个分量：\n$$\n(\\nabla S_{\\text{ferm}})_k = -a \\beta \\exp(\\beta\\sigma_k) (\\mathbf{M}^{-1})_{kk}\n$$\n在矢量形式中，这是一个逐元素乘积：\n$$\n\\nabla S_{\\text{ferm}}(\\boldsymbol{\\sigma}) = -a\\beta \\exp(\\beta\\boldsymbol{\\sigma}) \\circ \\mathrm{diag}(\\mathbf{M}(\\boldsymbol{\\sigma})^{-1})\n$$\n其中 $\\mathrm{diag}(\\mathbf{A}^{-1})$ 表示矩阵 $\\mathbf{A}^{-1}$ 的对角元素的向量。\n\n#### 1.4. 总解析梯度\n\n结合这三项的梯度，得到作用量的解析梯度的最终表达式：\n$$\n\\nabla S(\\boldsymbol{\\sigma}) = \\mathbf{K}_{\\text{bos}}\\,\\boldsymbol{\\sigma} + \\lambda\\,\\boldsymbol{\\sigma}^{\\circ 3} - a \\beta \\exp(\\beta\\,\\boldsymbol{\\sigma}) \\circ \\mathrm{diag}(\\mathbf{M}(\\boldsymbol{\\sigma})^{-1})\n$$\n\n### 2. 算法设计与验证\n\n验证过程包括实现推导出的解析梯度，并将其与数值有限差分近似进行比较。\n\n1.  **矩阵构造**：对于给定的格点尺寸 $N$，构造周期性拉普拉斯矩阵 $\\mathbf{L}$。其元素为 $L_{ii}=2$, $L_{i, (i-1+N)\\%N}=-1$ 和 $L_{i, (i+1)\\%N}=-1$。然后根据定义构建玻色子核 $\\mathbf{K}_{\\text{bos}}$ 和费米子矩阵 $\\mathbf{M}(\\boldsymbol{\\sigma})$。\n\n2.  **作用量和梯度的实现**：实现三个函数：\n    *   `action(sigma, ...)`: 计算 $S(\\boldsymbol{\\sigma})$。$\\log\\det\\mathbf{M}$ 项使用 `numpy.linalg.slogdet` 计算，该函数数值上是稳定的。\n    *   `analytic_gradient(sigma, ...)`: 使用上面推导的公式计算 $\\nabla S(\\boldsymbol{\\sigma})$。这需要计算 $\\mathbf{M}(\\boldsymbol{\\sigma})$ 的逆矩阵以提取其对角元素。\n    *   `fd_gradient(sigma, ...)`: 计算中心有限差分梯度 $(\\nabla S)^{\\text{FD}}$。对于每个分量 $i$，它将 $\\sigma_i$ 扰动 $\\pm \\varepsilon_i$，其中 $\\varepsilon_i = h(1 + |\\sigma_i|)$，在 $\\boldsymbol{\\sigma} \\pm \\varepsilon_i \\mathbf{e}_i$ 处重新计算完整的作用量 $S$，并应用标准的中心差分公式。\n\n3.  **验证协议**：对于问题中指定的每个测试用例：\n    *   **容差估计**：确定一个容差 `tol`。使用种子 $s_{\\text{train}}$ 从标准正态分布生成一组 $N_{\\text{train}} = 5$ 个随机场构型。对于每个构型，计算差异 $d = \\|\\nabla S - (\\nabla S)^{\\text{FD}}\\|_{\\infty}$ 和解析梯度范数 $\\|\\nabla S\\|_{\\infty}$。容差设置为 $\\mathrm{tol} = 10 \\cdot \\mathrm{median}(\\{d_j\\}) + 10^{-12} \\cdot (1 + \\mathrm{median}(\\{\\|\\nabla S_j\\|_{\\infty}\\}))$.\n    *   **测试**：使用种子 $s_{\\text{test}}$ 生成一个独立的包含 $N_{\\text{test}} = 3$ 个构型的测试集。当且仅当所有三个测试构型的差异 $d$ 都小于或等于计算出的容差 `tol` 时，该测试用例标记为 `Pass` (True)。否则，标记为 `Fail` (False)。\n\n这个全面的过程确保了对解析梯度实现的可靠验证，将其与一个可信的数值标准进行对比。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the validation tests for the lattice EFT model's action gradient.\n    \"\"\"\n\n    test_cases = [\n        # (N, m, kappa, lambda, a, beta, t, h, s_train, s_test)\n        (4, 0.5, 1.0, 0.1, 0.7, 0.6, 0.2, 1e-6, 12345, 54321),\n        (2, 3.0, 0.0, 0.0, 0.25, 0.8, 0.0, 1e-6, 22345, 64321),\n        (8, 0.1, 2.0, 0.0, 0.5, 1.0, 0.5, 1e-6, 32345, 74321),\n        (6, 1.2, 0.5, 0.5, 1.0, 1.2, 0.3, 1e-8, 42345, 84321),\n    ]\n\n    results = []\n    \n    for case_params in test_cases:\n        result = process_case(case_params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef process_case(params):\n    \"\"\"\n    Processes a single test case: calculates tolerance and performs validation.\n    \"\"\"\n    N, m, kappa, lamb, a, beta, t, h, s_train, s_test = params\n    \n    # Pre-compute the static part of matrices\n    L = build_laplacian(N)\n    K_bos = m**2 * np.eye(N) + kappa * L\n\n    # Helper function to pass static matrices\n    def get_action(sigma):\n        return action(sigma, N, lamb, a, beta, t, L, K_bos)\n    \n    def get_analytic_grad(sigma):\n        return analytic_gradient(sigma, N, lamb, a, beta, t, L, K_bos)\n\n    def get_fd_grad(sigma):\n        return fd_gradient(sigma, h, get_action)\n\n    # --- Task 3: Tolerance Estimation ---\n    N_train = 5\n    rng_train = np.random.default_rng(s_train)\n    \n    discrepancies_train = []\n    grad_norms_train = []\n\n    for _ in range(N_train):\n        sigma = rng_train.standard_normal(N)\n        \n        grad_analytic = get_analytic_grad(sigma)\n        grad_fd = get_fd_grad(sigma)\n        \n        d = np.linalg.norm(grad_analytic - grad_fd, ord=np.inf)\n        discrepancies_train.append(d)\n        \n        grad_norm = np.linalg.norm(grad_analytic, ord=np.inf)\n        grad_norms_train.append(grad_norm)\n        \n    median_d = np.median(discrepancies_train)\n    median_grad_norm = np.median(grad_norms_train)\n    scale_proxy = 1.0 + median_grad_norm\n    tol = 10.0 * median_d + 1e-12 * scale_proxy\n\n    # --- Task 4: Validation ---\n    N_test = 3\n    rng_test = np.random.default_rng(s_test)\n    case_passed = True\n    \n    for _ in range(N_test):\n        sigma = rng_test.standard_normal(N)\n        \n        grad_analytic = get_analytic_grad(sigma)\n        grad_fd = get_fd_grad(sigma)\n        \n        d_test = np.linalg.norm(grad_analytic - grad_fd, ord=np.inf)\n\n        if d_test > tol:\n            case_passed = False\n            break\n            \n    return case_passed\n\ndef build_laplacian(N):\n    \"\"\"Constructs the 1D periodic nearest-neighbor lattice Laplacian matrix L.\"\"\"\n    eye_N = np.eye(N)\n    # L = 2I - P_f - P_b, where P_f is forward shift and P_b is backward shift\n    # np.roll(eye, 1, axis=0) is P_f\n    # np.roll(eye, -1, axis=0) is P_b\n    L = 2 * eye_N - np.roll(eye_N, 1, axis=0) - np.roll(eye_N, -1, axis=0)\n    return L\n\ndef action(sigma, N, lamb, a, beta, t, L, K_bos):\n    \"\"\"Computes the Euclidean action S(sigma).\"\"\"\n    # Bosonic term\n    s_bos = 0.5 * sigma.T @ K_bos @ sigma\n    \n    # Quartic interaction term\n    s_int = (lamb / 4.0) * np.sum(sigma**4)\n    \n    # Fermionic term\n    M = np.eye(N) + a * np.diag(np.exp(beta * sigma)) + t * L\n    \n    # M must be SPD as per problem statement, so sign of det is +1\n    sign, logdet = np.linalg.slogdet(M) \n    if sign != 1:\n        # This should not happen with the given problem parameters\n        # but is good practice to check.\n        return np.inf\n    \n    s_ferm = -logdet\n    \n    return s_bos + s_int + s_ferm\n\ndef analytic_gradient(sigma, N, lamb, a, beta, t, L, K_bos):\n    \"\"\"Computes the analytic gradient of the action, nabla S(sigma).\"\"\"\n    # Gradient of bosonic term\n    grad_bos = K_bos @ sigma\n    \n    # Gradient of quartic interaction term\n    grad_int = lamb * (sigma**3)\n    \n    # Gradient of fermionic term\n    M = np.eye(N) + a * np.diag(np.exp(beta * sigma)) + t * L\n    M_inv = np.linalg.inv(M)\n    diag_M_inv = np.diag(M_inv)\n    \n    grad_ferm = -a * beta * np.exp(beta * sigma) * diag_M_inv\n    \n    return grad_bos + grad_int + grad_ferm\n\ndef fd_gradient(sigma, h, action_func):\n    \"\"\"Computes the central finite-difference approximation of the gradient.\"\"\"\n    N = len(sigma)\n    grad_fd = np.zeros(N)\n    \n    for i in range(N):\n        sigma_i = sigma[i]\n        eps_i = h * (1.0 + np.abs(sigma_i))\n        \n        sigma_plus = sigma.copy()\n        sigma_plus[i] += eps_i\n        \n        sigma_minus = sigma.copy()\n        sigma_minus[i] -= eps_i\n        \n        s_plus = action_func(sigma_plus)\n        s_minus = action_func(sigma_minus)\n        \n        grad_fd[i] = (s_plus - s_minus) / (2.0 * eps_i)\n        \n    return grad_fd\n\n# Run the solver\nsolve()\n```"
        },
        {
            "introduction": "一个正确的HMC算法只有在高效的情况下才有用。本次实践  介绍了一种强大的优化技术：多重时间尺度积分。通过认识到作用量的不同部分在不同的尺度上演化，你可以设计一个积分方案，在保持目标接受率的同时最小化计算成本，这是将理论算法转变为实用研究工具的关键一步。",
            "id": "3563901",
            "problem": "考虑应用于格点有效场论 (EFT) 系统的混合蒙特卡罗 (HMC) 方案，其作用量分解为三个因子，分别表示为 $S_{0}$ (长程π介子场)、$S_{1}$ (短程接触相互作用) 和 $S_{2}$ (费米子行列式)。您将设计一个嵌套的多重时间尺度二阶 Omelyan 积分器，用于演化长度固定为 $\\tau = 1$ (以格点时间单位计) 的虚拟分子动力学轨迹。该积分器对 $S_{0}$ 使用最外层时间步长 $h_{0}$，通过细分因子 $m_{1}$ 为 $S_{1}$ 定义了1级步长 $h_{1} = h_{0}/m_{1}$，并再通过细分因子 $m_{2}$ 为 $S_{2}$ 定义了2级步长 $h_{2} = h_{0}/(m_{1} m_{2})$。在每个最外层步长中，$S_{0}$ 的力计算一次，$S_{1}$ 的力计算 $m_{1}$ 次，$S_{2}$ 的力计算 $m_{1} m_{2}$ 次。\n\n假设对于可逆、保面积的二阶积分器，以下经过充分检验的建模事实成立：\n- 主导的轨迹能量不守恒量的方差模型为\n$$\n\\operatorname{Var}(\\Delta H) \\;=\\; \\alpha_{0} h_{0}^{4} \\;+\\; \\alpha_{1} \\left(\\frac{h_{0}}{m_{1}}\\right)^{4} \\;+\\; \\alpha_{2} \\left(\\frac{h_{0}}{m_{1} m_{2}}\\right)^{4},\n$$\n其中 $\\alpha_{i}>0$ 是为每个因子测得的误差系数参数。\n- 期望的 Metropolis 接受概率为\n$$\nP_{\\mathrm{acc}} \\;=\\; \\operatorname{erfc}\\!\\left(\\frac{\\sqrt{\\operatorname{Var}(\\Delta H)}}{2}\\right),\n$$\n其中 $\\operatorname{erfc}$ 是互补误差函数。\n- 每条轨迹的总计算成本 (以相对成本单位计) 模型为\n$$\nC \\;=\\; \\frac{\\tau}{h_{0}}\\left(c_{0} \\;+\\; c_{1} m_{1} \\;+\\; c_{2} m_{1} m_{2}\\right),\n$$\n其中 $c_{i}>0$ 是测得的计算因子 $S_{i}$ 的力的相对成本。\n\n给定以下校准测量值 (来自在可比格点参数下的短期诊断性运行)：\n- $\\alpha_{0} = 4$, $\\alpha_{1} = 40$, $\\alpha_{2} = 12800$。\n- $c_{0} = 1$, $c_{1} = 10$, $c_{2} = 100$。\n- $\\tau = 1$。\n\n通过选择 $h_{0}>0$, $m_{1}>0$, $m_{2}>0$ 来设计连续 (实值) 的多重时间尺度方案，以在接受概率约束 $P_{\\mathrm{acc}} \\geq P^{\\star}$ (其中 $P^{\\star} = 0.8$) 的条件下最小化成本 $C$。在求解连续优化问题后，将细分因子 $m_{1}$ 和 $m_{2}$ 四舍五入到最接近的整数，重新计算 $h_{0}$ 以使用这些整数细分精确满足接受概率约束，然后计算期望的接受概率 $P_{\\mathrm{acc}}$ 和由此产生的成本 $C$。\n\n将接受概率四舍五入到四位有效数字，将成本四舍五入到三位有效数字。使用单位“成本单位”表示成本。您的最终答案必须是接受概率和成本的有序对，形式为行矩阵。",
            "solution": "用户要求我解决一个关于混合蒙特卡罗 (HMC) 模拟的优化问题。我将首先验证问题陈述，然后继续进行求解。\n\n### 第 1 步：提取已知条件\n- **系统**：一个格点有效场论 (EFT) 模型，其作用量分解为三个因子：$S_{0}$ (长程π介子场)，$S_{1}$ (短程接触相互作用)，和 $S_{2}$ (费米子行列式)。\n- **积分器**：一个嵌套的多重时间尺度二阶 Omelyan 积分器。\n- **轨迹长度**：$\\tau = 1$ (以格点时间单位计)。\n- **时间步长**：\n    - 最外层时间步长：$h_{0}$，用于 $S_{0}$。\n    - 1级时间步长：$h_{1} = h_{0}/m_{1}$，用于 $S_{1}$，细分因子为 $m_{1}$。\n    - 2级时间步长：$h_{2} = h_{1}/m_{2} = h_{0}/(m_{1} m_{2})$，用于 $S_{2}$，细分因子为 $m_{2}$。\n- **每个外层步长的力计算次数**：$S_{0}$ 为 $1$ 次，$S_{1}$ 为 $m_{1}$ 次，$S_{2}$ 为 $m_{1} m_{2}$ 次。\n- **能量不守恒量方差模型**：\n$$\n\\operatorname{Var}(\\Delta H) = \\alpha_{0} h_{0}^{4} + \\alpha_{1} \\left(\\frac{h_{0}}{m_{1}}\\right)^{4} + \\alpha_{2} \\left(\\frac{h_{0}}{m_{1} m_{2}}\\right)^{4}\n$$\n- **接受概率模型**：\n$$\nP_{\\mathrm{acc}} = \\operatorname{erfc}\\left(\\frac{\\sqrt{\\operatorname{Var}(\\Delta H)}}{2}\\right)\n$$\n- **计算成本模型**：\n$$\nC = \\frac{\\tau}{h_{0}}\\left(c_{0} + c_{1} m_{1} + c_{2} m_{1} m_{2}\\right)\n$$\n- **模型参数**：\n    - 误差系数：$\\alpha_{0} = 4$, $\\alpha_{1} = 40$, $\\alpha_{2} = 12800$。\n    - 成本系数：$c_{0} = 1$, $c_{1} = 10$, $c_{2} = 100$。\n- **优化目标**：通过选择连续 (实值) 的 $h_{0}>0$, $m_{1}>0$, $m_{2}>0$ 最小化成本 $C$。\n- **约束条件**：$P_{\\mathrm{acc}} \\geq P^{\\star}$，其中 $P^{\\star} = 0.8$。\n- **最后步骤**：\n    1. 将优化后的连续 $m_{1}$ 和 $m_{2}$ 四舍五入到最接近的整数。\n    2. 使用整数细分重新计算 $h_{0}$ 以精确满足接受约束。\n    3. 计算最终的期望接受概率 $P_{\\mathrm{acc}}$ 和由此产生的成本 $C$。\n    4. 将 $P_{\\mathrm{acc}}$ 四舍五入到四位有效数字，将 $C$ 四舍五入到三位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题在科学上是成立的，源于计算物理中优化算法参数的常见任务，特别是对于 HMC 模拟。能量不守恒量、接受概率和计算成本的模型在该领域是标准且成熟的。问题陈述清晰：它指定了一个要最小化的目标函数 ($C$)、一组要优化的变量 ($h_0, m_1, m_2$) 和一个明确定义的约束 ($P_{\\mathrm{acc}} \\geq P^{\\star}$)。所有必要的数据和参数都已提供，使问题自成一体。语言客观而精确。未检测到科学、逻辑或结构上的缺陷。\n\n### 第 3 步：结论和行动\n问题有效。我将继续解决它。\n\n### 求解\n目标是在最小接受概率约束 $P_{\\mathrm{acc}} \\geq P^{\\star}$ 的条件下，最小化计算成本 $C$。成本 $C$ 是最外层时间步长 $h_0$ 的单调递减函数。为了最小化 $C$，我们必须选择满足约束的可能的最大 $h_0$。接受概率 $P_{\\mathrm{acc}}$ 是能量不守恒量方差 $\\operatorname{Var}(\\Delta H)$ 的单调递减函数。因此，当约束饱和时，即 $P_{\\mathrm{acc}} = P^{\\star} = 0.8$ 时，可以获得最大的 $h_0$。\n\n首先，我们确定对应于 $P_{\\mathrm{acc}} = 0.8$ 的最大允许方差 $\\operatorname{Var}(\\Delta H)_{\\max}$：\n$$\n0.8 = \\operatorname{erfc}\\left(\\frac{\\sqrt{\\operatorname{Var}(\\Delta H)_{\\max}}}{2}\\right)\n$$\n对两边取反互补误差函数 $\\operatorname{erfc}^{-1}$：\n$$\n\\operatorname{erfc}^{-1}(0.8) = \\frac{\\sqrt{\\operatorname{Var}(\\Delta H)_{\\max}}}{2}\n$$\n数值上，$\\operatorname{erfc}^{-1}(0.8) \\approx 0.179143$。因此，\n$$\n\\sqrt{\\operatorname{Var}(\\Delta H)_{\\max}} = 2 \\times 0.179143 = 0.358286\n$$\n$$\n\\operatorname{Var}(\\Delta H)_{\\max} = (0.358286)^2 \\approx 0.128369\n$$\n我们将此最大允许方差表示为 $V_{\\max}$。约束变为 $\\operatorname{Var}(\\Delta H) = V_{\\max}$。\n\n问题是在 $\\operatorname{Var}(\\Delta H) = V_{\\max}$ 的约束下最小化 $C$。我们将作用量各部分的时间步长定义为 $h_0$、$h_1 = h_0/m_1$ 和 $h_2 = h_1/m_2 = h_0/(m_1 m_2)$。成本和方差可以用这些单独的时间步长重新表示：\n$$\n\\operatorname{Var}(\\Delta H) = \\alpha_{0} h_{0}^{4} + \\alpha_{1} h_{1}^{4} + \\alpha_{2} h_{2}^{4} = V_{\\max}\n$$\n$$\nC = \\frac{\\tau c_0}{h_0} + \\frac{\\tau c_1}{h_1} + \\frac{\\tau c_2}{h_2}\n$$\n这是一个关于变量 $h_0$、$h_1$、$h_2$ 的约束优化问题。我们使用拉格朗日乘数法。拉格朗日量 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(h_0, h_1, h_2, \\lambda) = \\sum_{i=0}^{2} \\frac{\\tau c_i}{h_i} + \\lambda \\left(\\sum_{i=0}^{2} \\alpha_i h_i^4 - V_{\\max}\\right)\n$$\n将关于每个 $h_i$ 的偏导数设为零，得到最优性条件：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial h_i} = -\\frac{\\tau c_i}{h_i^2} + 4 \\lambda \\alpha_i h_i^3 = 0\n$$\n$$\n\\implies h_i^5 = \\frac{\\tau c_i}{4 \\lambda \\alpha_i}\n$$\n这意味着在最优点，$h_i^5 \\propto c_i / \\alpha_i$。我们可以求出步长的最优比率，这决定了细分因子 $m_1$ 和 $m_2$：\n$$\nm_1^5 = \\left(\\frac{h_0}{h_1}\\right)^5 = \\frac{c_0/\\alpha_0}{c_1/\\alpha_1} = \\frac{c_0 \\alpha_1}{c_1 \\alpha_0}\n$$\n$$\nm_2^5 = \\left(\\frac{h_1}{h_2}\\right)^5 = \\frac{c_1/\\alpha_1}{c_2/\\alpha_2} = \\frac{c_1 \\alpha_2}{c_2 \\alpha_1}\n$$\n代入给定的参数值：\n- $\\alpha_{0} = 4$, $\\alpha_{1} = 40$, $\\alpha_{2} = 12800$\n- $c_{0} = 1$, $c_{1} = 10$, $c_{2} = 100$\n\n我们求出 $m_1$ 和 $m_2$ 的最优连续值：\n$$\nm_1^5 = \\frac{1 \\times 40}{10 \\times 4} = \\frac{40}{40} = 1 \\implies m_1 = 1\n$$\n$$\nm_2^5 = \\frac{10 \\times 12800}{100 \\times 40} = \\frac{128000}{4000} = 32 \\implies m_2 = 2\n$$\n问题要求将这些值四舍五入到最接近的整数。由于最优连续值已经是整数，所以整数细分因子为 $m_1 = 1$ 和 $m_2 = 2$。\n\n接下来，我们重新计算 $h_0$ 以使用这些整数细分精确满足接受约束。约束为 $\\operatorname{Var}(\\Delta H) = V_{\\max}$。\n$$\n\\operatorname{Var}(\\Delta H) = h_{0}^{4} \\left( \\alpha_{0} + \\frac{\\alpha_{1}}{m_{1}^{4}} + \\frac{\\alpha_{2}}{m_{1}^{4} m_{2}^{4}} \\right) = V_{\\max}\n$$\n代入数值：\n$$\nh_0^4 \\left( 4 + \\frac{40}{1^4} + \\frac{12800}{1^4 \\times 2^4} \\right) = V_{\\max}\n$$\n$$\nh_0^4 \\left( 4 + 40 + \\frac{12800}{16} \\right) = V_{\\max}\n$$\n$$\nh_0^4 (44 + 800) = 844 h_0^4 = V_{\\max} \\approx 0.128369\n$$\n求解 $h_0$：\n$$\nh_0^4 = \\frac{V_{\\max}}{844} \\approx \\frac{0.128369}{844} \\approx 0.000152096\n$$\n$$\nh_0 = (0.000152096)^{1/4} \\approx 0.111050\n$$\n使用这个 $h_0$ 值，方差 $\\operatorname{Var}(\\Delta H)$ 恰好为 $V_{\\max}$，因此期望的接受概率 $P_{\\mathrm{acc}}$ 恰好为 $P^{\\star} = 0.8$。保留四位有效数字，即为 $0.8000$。\n\n最后，我们使用 $\\tau=1$，$h_0 \\approx 0.111050$，$m_1=1$ 和 $m_2=2$ 计算总成本 $C$：\n$$\nC = \\frac{\\tau}{h_{0}}\\left(c_{0} + c_{1} m_{1} + c_{2} m_{1} m_{2}\\right)\n$$\n$$\nC = \\frac{1}{0.111050} \\left( 1 + 10(1) + 100(1)(2) \\right)\n$$\n$$\nC = \\frac{1}{0.111050} (1 + 10 + 200) = \\frac{211}{0.111050} \\approx 1899.95\n$$\n使用更精确的 $h_0$ 值 $h_0 = (V_{\\max}/844)^{1/4} \\approx 0.1110504$：\n$$\nC = \\frac{211}{0.1110504} \\approx 1899.988\n$$\n将成本四舍五入到三位有效数字：数字是 $1.899988 \\times 10^3$。前三位有效数字是 $1, 8, 9$。下一位数字是 $9$，所以我们将第三位数字向上取整。$189$ 变为 $190$。为了保持正确的数量级，成本为 $1900$。\n\n最终结果是接受概率 $P_{\\mathrm{acc}} = 0.8000$，成本 $C=1900$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8000 & 1900\n\\end{pmatrix}\n}\n$$"
        }
    ]
}