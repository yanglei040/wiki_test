{
    "hands_on_practices": [
        {
            "introduction": "To understand dilatancy, we must first learn how to measure it. This practice provides a scenario analogous to analyzing data from a laboratory triaxial test. By working through the provided stress and strain increments, you will perform the essential task of decomposing total strain into its elastic and plastic parts—a fundamental procedure in plasticity theory. This exercise sharpens your understanding of how the plastic volumetric strain, which defines dilatancy, is isolated from the total measured deformation .",
            "id": "3517370",
            "problem": "Consider a drained axisymmetric triaxial compression increment applied to a dense granular material (sand) with the second principal stress equal to the third principal stress, $\\sigma_{2}=\\sigma_{3}$. Adopt the geomechanics sign convention in which compression is positive for both stress and strain. The material is modeled as linearly elastic for the recoverable response with bulk modulus $K$ and shear modulus $G$, and as non-associated Mohr–Coulomb for the irreversible (plastic) response, with a plastic potential expressed in stress invariants as $g(p',q)=q-p' N_{\\psi}$, where $p'$ is the mean effective stress and $q$ is the triaxial stress measure. The parameter $N_{\\psi}$ is related to the instantaneous dilatancy angle $\\psi$ through $N_{\\psi}=\\dfrac{6\\sin\\psi}{3-\\sin\\psi}$. Throughout, use the conventional triaxial invariants $p'=\\dfrac{\\sigma_{1}+\\sigma_{2}+\\sigma_{3}}{3}$ and $q=\\sigma_{1}-\\sigma_{3}$, and the work-conjugate strain invariants $\\varepsilon_{v}=\\varepsilon_{1}+\\varepsilon_{2}+\\varepsilon_{3}$ and $\\varepsilon_{s}=\\dfrac{2}{3}\\left(\\varepsilon_{1}-\\varepsilon_{3}\\right)$.\n\nA small stress increment is applied with $\\mathrm{d}\\sigma_{1}=25~\\mathrm{kPa}$ and $\\mathrm{d}\\sigma_{3}=0~\\mathrm{kPa}$, so that $\\mathrm{d}\\sigma_{2}=\\mathrm{d}\\sigma_{3}=0~\\mathrm{kPa}$. The elastic moduli are $K=50~\\mathrm{MPa}$ and $G=20~\\mathrm{MPa}$. During this increment the measured principal strain increments are $\\mathrm{d}\\varepsilon_{1}=1.20\\times 10^{-3}$ and $\\mathrm{d}\\varepsilon_{3}=-1.00\\times 10^{-3}$. By axisymmetry, take $\\mathrm{d}\\varepsilon_{2}=\\mathrm{d}\\varepsilon_{3}$.\n\nStarting from the definitions of the stress and strain invariants and the linear elastic relations $\\mathrm{d}p'=K\\,\\mathrm{d}\\varepsilon_{v}^{e}$ and $\\mathrm{d}q=3G\\,\\mathrm{d}\\varepsilon_{s}^{e}$, and the non-associated flow rule $\\mathrm{d}\\varepsilon_{ij}^{p}=\\dot{\\lambda}\\,\\dfrac{\\partial g}{\\partial \\sigma_{ij}}$, compute:\n\n1) the total invariant strain increments $\\mathrm{d}\\varepsilon_{v}$ and $\\mathrm{d}\\varepsilon_{s}$,\n\n2) the elastic parts $\\mathrm{d}\\varepsilon_{v}^{e}$ and $\\mathrm{d}\\varepsilon_{s}^{e}$,\n\n3) the plastic parts $\\mathrm{d}\\varepsilon_{v}^{p}$ and $\\mathrm{d}\\varepsilon_{s}^{p}$,\n\nand then use these to obtain the instantaneous dilatancy angle $\\psi$ corresponding to this increment.\n\nExpress the final value of $\\psi$ in degrees, and round your answer to four significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Constitutive Model: Linear elasticity and non-associated Mohr-Coulomb plasticity.\n- Loading: Drained axisymmetric triaxial compression increment, with $\\mathrm{d}\\sigma_{2}=\\mathrm{d}\\sigma_{3}$.\n- Sign Convention: Compression is positive for stress and strain.\n- Stress Increment Components: $\\mathrm{d}\\sigma_{1}=25~\\mathrm{kPa}$, $\\mathrm{d}\\sigma_{2}=0~\\mathrm{kPa}$, $\\mathrm{d}\\sigma_{3}=0~\\mathrm{kPa}$.\n- Strain Increment Components: $\\mathrm{d}\\varepsilon_{1}=1.20\\times 10^{-3}$, $\\mathrm{d}\\varepsilon_{3}=-1.00\\times 10^{-3}$, $\\mathrm{d}\\varepsilon_{2}=\\mathrm{d}\\varepsilon_{3}$.\n- Elastic Moduli: Bulk modulus $K=50~\\mathrm{MPa}$, Shear modulus $G=20~\\mathrm{MPa}$.\n- Stress Invariants: $p'=\\dfrac{\\sigma_{1}+\\sigma_{2}+\\sigma_{3}}{3}$, $q=\\sigma_{1}-\\sigma_{3}$.\n- Strain Invariants: $\\varepsilon_{v}=\\varepsilon_{1}+\\varepsilon_{2}+\\varepsilon_{3}$, $\\varepsilon_{s}=\\dfrac{2}{3}\\left(\\varepsilon_{1}-\\varepsilon_{3}\\right)$.\n- Plastic Potential Function: $g(p',q)=q-p' N_{\\psi}$.\n- Dilatancy Parameter Definition: $N_{\\psi}=\\dfrac{6\\sin\\psi}{3-\\sin\\psi}$.\n- Elastic Constitutive Law Increments: $\\mathrm{d}p'=K\\,\\mathrm{d}\\varepsilon_{v}^{e}$, $\\mathrm{d}q=3G\\,\\mathrm{d}\\varepsilon_{s}^{e}$.\n- Plastic Flow Rule: $\\mathrm{d}\\varepsilon_{ij}^{p}=\\dot{\\lambda}\\,\\dfrac{\\partial g}{\\partial \\sigma_{ij}}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-defined within the framework of classical soil mechanics and constitutive modeling. The provided equations for invariants, elastic laws, and the plastic potential are standard. The material parameters ($K$, $G$) are physically realistic for sand, and the stress/strain increments are of a plausible magnitude. The description of a \"dense granular material\" experiencing plastic dilation (as will be shown by the calculation) is consistent with established soil behavior. The problem is self-contained, and all necessary information is provided to solve for the dilatancy angle $\\psi$. There are no scientific flaws, inconsistencies, or ambiguities.\n\n**Verdict:** The problem is valid.\n\n**Step 3: Solution**\n\nThe solution proceeds by first computing the total strain increments in invariant form, followed by the stress increments in invariant form. Then, the elastic parts of the strain increments are determined. The plastic parts are found by subtracting the elastic parts from the total. Finally, the ratio of the plastic strain invariants is used to determine the dilatancy angle $\\psi$. The sign convention is that compressive stresses and strains are positive.\n\n1.  **Compute total invariant strain increments ($\\mathrm{d}\\varepsilon_{v}$ and $\\mathrm{d}\\varepsilon_{s}$):**\n    The principal strain increments are given as $\\mathrm{d}\\varepsilon_{1}=1.20\\times 10^{-3}$ and $\\mathrm{d}\\varepsilon_{3}=-1.00\\times 10^{-3}$. Due to axisymmetry, $\\mathrm{d}\\varepsilon_{2}=\\mathrm{d}\\varepsilon_{3}$.\n    The volumetric strain increment, $\\mathrm{d}\\varepsilon_{v}$, is the sum of the principal strain increments:\n    $$\n    \\mathrm{d}\\varepsilon_{v} = \\mathrm{d}\\varepsilon_{1} + \\mathrm{d}\\varepsilon_{2} + \\mathrm{d}\\varepsilon_{3} = (1.20 \\times 10^{-3}) + (-1.00 \\times 10^{-3}) + (-1.00 \\times 10^{-3}) = -0.80 \\times 10^{-3}\n    $$\n    The deviatoric strain increment, $\\mathrm{d}\\varepsilon_{s}$, is:\n    $$\n    \\mathrm{d}\\varepsilon_{s} = \\frac{2}{3}(\\mathrm{d}\\varepsilon_{1} - \\mathrm{d}\\varepsilon_{3}) = \\frac{2}{3}(1.20 \\times 10^{-3} - (-1.00 \\times 10^{-3})) = \\frac{2}{3}(2.20 \\times 10^{-3}) = \\frac{4.4}{3} \\times 10^{-3}\n    $$\n\n2.  **Compute invariant stress increments ($\\mathrm{d}p'$ and $\\mathrm{d}q$):**\n    The principal stress increments are $\\mathrm{d}\\sigma_{1}=25~\\mathrm{kPa}$ and $\\mathrm{d}\\sigma_{2}=\\mathrm{d}\\sigma_{3}=0~\\mathrm{kPa}$.\n    The increment in mean effective stress, $\\mathrm{d}p'$, is:\n    $$\n    \\mathrm{d}p' = \\frac{\\mathrm{d}\\sigma_{1} + \\mathrm{d}\\sigma_{2} + \\mathrm{d}\\sigma_{3}}{3} = \\frac{25~\\mathrm{kPa} + 0 + 0}{3} = \\frac{25}{3}~\\mathrm{kPa}\n    $$\n    The increment in triaxial stress measure, $\\mathrm{d}q$, is:\n    $$\n    \\mathrm{d}q = \\mathrm{d}\\sigma_{1} - \\mathrm{d}\\sigma_{3} = 25~\\mathrm{kPa} - 0 = 25~\\mathrm{kPa}\n    $$\n\n3.  **Compute elastic invariant strain increments ($\\mathrm{d}\\varepsilon_{v}^{e}$ and $\\mathrm{d}\\varepsilon_{s}^{e}$):**\n    The elastic moduli are $K=50~\\mathrm{MPa} = 50 \\times 10^3~\\mathrm{kPa}$ and $G=20~\\mathrm{MPa} = 20 \\times 10^3~\\mathrm{kPa}$.\n    The elastic volumetric strain increment is:\n    $$\n    \\mathrm{d}\\varepsilon_{v}^{e} = \\frac{\\mathrm{d}p'}{K} = \\frac{\\frac{25}{3}~\\mathrm{kPa}}{50 \\times 10^3~\\mathrm{kPa}} = \\frac{25}{150 \\times 10^3} = \\frac{1}{6 \\times 10^3} = \\frac{1}{6} \\times 10^{-3}\n    $$\n    The elastic deviatoric strain increment is:\n    $$\n    \\mathrm{d}\\varepsilon_{s}^{e} = \\frac{\\mathrm{d}q}{3G} = \\frac{25~\\mathrm{kPa}}{3 \\times (20 \\times 10^3~\\mathrm{kPa})} = \\frac{25}{60 \\times 10^3} = \\frac{5}{12 \\times 10^3} = \\frac{5}{12} \\times 10^{-3}\n    $$\n\n4.  **Compute plastic invariant strain increments ($\\mathrm{d}\\varepsilon_{v}^{p}$ and $\\mathrm{d}\\varepsilon_{s}^{p}$):**\n    The total strain increment is the sum of its elastic and plastic parts: $\\mathrm{d}\\boldsymbol{\\varepsilon} = \\mathrm{d}\\boldsymbol{\\varepsilon}^e + \\mathrm{d}\\boldsymbol{\\varepsilon}^p$. This holds for the invariants as well.\n    The plastic volumetric strain increment is:\n    $$\n    \\mathrm{d}\\varepsilon_{v}^{p} = \\mathrm{d}\\varepsilon_{v} - \\mathrm{d}\\varepsilon_{v}^{e} = -0.80 \\times 10^{-3} - \\frac{1}{6} \\times 10^{-3} = \\left(-\\frac{4}{5} - \\frac{1}{6}\\right) \\times 10^{-3} = \\left(\\frac{-24 - 5}{30}\\right) \\times 10^{-3} = -\\frac{29}{30} \\times 10^{-3}\n    $$\n    The negative sign indicates plastic dilation (volume increase).\n    The plastic deviatoric strain increment is:\n    $$\n    \\mathrm{d}\\varepsilon_{s}^{p} = \\mathrm{d}\\varepsilon_{s} - \\mathrm{d}\\varepsilon_{s}^{e} = \\frac{4.4}{3} \\times 10^{-3} - \\frac{5}{12} \\times 10^{-3} = \\left(\\frac{22}{15} - \\frac{5}{12}\\right) \\times 10^{-3} = \\left(\\frac{88 - 25}{60}\\right) \\times 10^{-3} = \\frac{63}{60} \\times 10^{-3} = \\frac{21}{20} \\times 10^{-3}\n    $$\n\n5.  **Compute the dilatancy angle ($\\psi$):**\n    The plastic strain increments are derived from the plastic potential $g$ via the flow rule. The invariants are related through $\\mathrm{d}\\varepsilon_v^p = \\dot{\\lambda} \\frac{\\partial g}{\\partial p'}$ and $\\mathrm{d}\\varepsilon_s^p = \\dot{\\lambda} \\frac{\\partial g}{\\partial q}$.\n    For $g(p',q)=q-p' N_{\\psi}$, we have $\\dfrac{\\partial g}{\\partial p'} = -N_{\\psi}$ and $\\dfrac{\\partial g}{\\partial q} = 1$.\n    Thus, $\\mathrm{d}\\varepsilon_{v}^{p} = -\\dot{\\lambda} N_{\\psi}$ and $\\mathrm{d}\\varepsilon_{s}^{p} = \\dot{\\lambda}$.\n    Taking the ratio eliminates the plastic multiplier $\\dot{\\lambda}$:\n    $$\n    \\frac{\\mathrm{d}\\varepsilon_{v}^{p}}{\\mathrm{d}\\varepsilon_{s}^{p}} = -N_{\\psi}\n    $$\n    We can now calculate $N_{\\psi}$ from our computed values for the plastic strain invariants:\n    $$\n    N_{\\psi} = -\\frac{\\mathrm{d}\\varepsilon_{v}^{p}}{\\mathrm{d}\\varepsilon_{s}^{p}} = -\\frac{-\\frac{29}{30} \\times 10^{-3}}{\\frac{21}{20} \\times 10^{-3}} = \\frac{29}{30} \\times \\frac{20}{21} = \\frac{29 \\times 2}{3 \\times 21} = \\frac{58}{63}\n    $$\n    The problem provides the relationship between $N_{\\psi}$ and the dilatancy angle $\\psi$:\n    $$\n    N_{\\psi} = \\frac{6\\sin\\psi}{3-\\sin\\psi}\n    $$\n    Substituting the calculated value of $N_{\\psi}$:\n    $$\n    \\frac{58}{63} = \\frac{6\\sin\\psi}{3-\\sin\\psi}\n    $$\n    Solving for $\\sin\\psi$:\n    $$\n    58(3 - \\sin\\psi) = 63(6\\sin\\psi)\n    $$\n    $$\n    174 - 58\\sin\\psi = 378\\sin\\psi\n    $$\n    $$\n    174 = (378 + 58) \\sin\\psi = 436\\sin\\psi\n    $$\n    $$\n    \\sin\\psi = \\frac{174}{436} = \\frac{87}{218}\n    $$\n    The dilatancy angle in degrees is found by taking the arcsin:\n    $$\n    \\psi = \\arcsin\\left(\\frac{87}{218}\\right)\n    $$\n    Numerically, $\\psi \\approx 23.51953^\\circ$. Rounding to four significant figures gives $\\psi=23.52^\\circ$.",
            "answer": "$$\\boxed{23.52}$$"
        },
        {
            "introduction": "Constitutive models provide the theoretical framework for predicting material behavior. This problem explores dilatancy within the elegant context of the Modified Cam-Clay (MCC) model, a cornerstone of critical state soil mechanics. By deriving the plastic dilatancy ratio directly from the MCC yield surface and its associated flow rule, you will see how volumetric change during plastic shear is not an independent phenomenon but an inherent prediction of the model, directly linked to the current stress ratio $\\eta$ and the critical state friction $M$ . This reveals the predictive power and internal consistency of well-formulated plasticity models.",
            "id": "3517401",
            "problem": "A saturated isotropic granular material is modeled using the Modified Cam-Clay (MCC) framework under small strains and the standard triaxial invariants of effective stress and strain. Let the mean effective stress be $p'$, the deviatoric stress be $q$, the preconsolidation pressure be $p'_{c}$, and the critical state stress ratio be $M$ (a material constant determined by the critical state friction). The MCC yield function in terms of invariants is\n$$\nf(p',q,p'_{c}) \\equiv q^{2} + M^{2} p' \\left(p' - p'_{c}\\right) = 0,\n$$\nand the plastic flow is associative, so that the plastic strain rate tensor satisfies\n$$\n\\dot{\\varepsilon}_{ij}^{p} = \\dot{\\lambda} \\, \\frac{\\partial f}{\\partial \\sigma'_{ij}},\n$$\nwhere $\\sigma'_{ij}$ is the effective stress tensor and $\\dot{\\lambda} \\ge 0$ is the plastic multiplier. Define the plastic volumetric strain rate as $\\dot{\\varepsilon}_{v}^{p} \\equiv \\dot{\\varepsilon}_{kk}^{p}$ and the work-conjugate plastic shear strain rate invariant $\\dot{\\varepsilon}_{s}^{p}$ so that the plastic dissipation per unit volume is\n$$\n\\sigma'_{ij} \\dot{\\varepsilon}_{ij}^{p} = p' \\, \\dot{\\varepsilon}_{v}^{p} + q \\, \\dot{\\varepsilon}_{s}^{p}.\n$$\nConsider a triaxial compression state on the yield surface with a measured stress ratio $\\eta \\equiv q/p'  0$. Using only the above model ingredients and invariant definitions, derive the instantaneous plastic dilatancy\n$$\nD \\equiv \\frac{\\dot{\\varepsilon}_{v}^{p}}{\\dot{\\varepsilon}_{s}^{p}}\n$$\nas a closed-form expression that depends only on $\\eta$ and $M$. Then, interpret the sign and magnitude of $D$ in terms of plastic volumetric contraction or dilation under the conventional geomechanics sign convention where compressive strains are taken as positive. Express your final answer as a single analytic expression in terms of $\\eta$ and $M$ only. No numerical evaluation is required, and no units are needed for $D$ because it is dimensionless.",
            "solution": "The problem is valid as it is scientifically grounded in the theory of critical state soil mechanics, well-posed, objective, and internally consistent.\n\nThe plastic dilatancy, $D$, is defined as the ratio of the plastic volumetric strain rate, $\\dot{\\varepsilon}_{v}^{p}$, to the plastic shear strain rate, $\\dot{\\varepsilon}_{s}^{p}$:\n$$\nD \\equiv \\frac{\\dot{\\varepsilon}_{v}^{p}}{\\dot{\\varepsilon}_{s}^{p}}\n$$\nThe problem states that the plastic flow is associative. For an isotropic material whose yield function $f$ is expressed in terms of the stress invariants $p'$ and $q$, the associative flow rule dictates that the vector of plastic strain rates in the $(p', q)$ plane is normal to the yield surface. The plastic strain rate invariants $\\dot{\\varepsilon}_{v}^{p}$ and $\\dot{\\varepsilon}_{s}^{p}$ are work-conjugate to the stress invariants $p'$ and $q$, respectively, as established by the plastic dissipation expression $\\sigma'_{ij} \\dot{\\varepsilon}_{ij}^{p} = p' \\, \\dot{\\varepsilon}_{v}^{p} + q \\, \\dot{\\varepsilon}_{s}^{p}$. Therefore, the associative flow rule can be expressed in terms of these invariants as:\n$$\n\\dot{\\varepsilon}_{v}^{p} = \\dot{\\Lambda} \\frac{\\partial f}{\\partial p'}\n$$\n$$\n\\dot{\\varepsilon}_{s}^{p} = \\dot{\\Lambda} \\frac{\\partial f}{\\partial q}\n$$\nwhere $\\dot{\\Lambda}$ is a non-negative plastic multiplier (proportional to the $\\dot{\\lambda}$ in the tensor rule).\n\nThe ratio $D$ can then be written as the ratio of the partial derivatives of the yield function, as the multiplier $\\dot{\\Lambda}$ cancels out:\n$$\nD = \\frac{\\dot{\\Lambda} \\frac{\\partial f}{\\partial p'}}{\\dot{\\Lambda} \\frac{\\partial f}{\\partial q}} = \\frac{\\frac{\\partial f}{\\partial p'}}{\\frac{\\partial f}{\\partial q}}\n$$\nWe are given the Modified Cam-Clay (MCC) yield function:\n$$\nf(p',q,p'_{c}) = q^{2} + M^{2} p' \\left(p' - p'_{c}\\right) = 0\n$$\nNow, we compute the required partial derivatives of $f$:\nThe partial derivative with respect to the deviatoric stress $q$ is:\n$$\n\\frac{\\partial f}{\\partial q} = 2q\n$$\nThe partial derivative with respect to the mean effective stress $p'$ is:\n$$\n\\frac{\\partial f}{\\partial p'} = \\frac{\\partial}{\\partial p'} \\left( q^{2} + M^{2} (p')^{2} - M^{2} p' p'_{c} \\right) = 2 M^{2} p' - M^{2} p'_{c} = M^{2} (2p' - p'_{c})\n$$\nSubstituting these derivatives into the expression for $D$, we obtain:\n$$\nD = \\frac{M^{2} (2p' - p'_{c})}{2q}\n$$\nThis expression currently depends on the state variables $p'$, $q$, and the preconsolidation pressure $p'_{c}$. The problem requires the final answer to be in terms of the stress ratio $\\eta \\equiv q/p'$ and the material constant $M$. To achieve this, we must eliminate $p'_{c}$. Since the material state lies on the yield surface, the yield condition $f=0$ must be satisfied. We can rearrange the yield function to solve for $p'_{c}$:\n$$\nq^{2} + M^{2} p' \\left(p' - p'_{c}\\right) = 0\n$$\n$$\nM^{2} p' \\left(p' - p'_{c}\\right) = -q^{2}\n$$\nAssuming $p' \\neq 0$ and $M \\neq 0$:\n$$\np' - p'_{c} = -\\frac{q^{2}}{M^{2}p'}\n$$\n$$\np'_{c} = p' + \\frac{q^{2}}{M^{2}p'}\n$$\nNow, substitute this expression for $p'_{c}$ back into the equation for $D$:\n$$\nD = \\frac{M^{2} \\left(2p' - \\left(p' + \\frac{q^{2}}{M^{2}p'}\\right)\\right)}{2q} = \\frac{M^{2} \\left(p' - \\frac{q^{2}}{M^{2}p'}\\right)}{2q}\n$$\nDistributing the $M^{2}$ term in the numerator gives:\n$$\nD = \\frac{M^{2}p' - \\frac{q^{2}}{p'}}{2q}\n$$\nTo express this in terms of $\\eta = q/p'$, we can divide both the numerator and the denominator by $p'$:\n$$\nD = \\frac{M^{2} - \\frac{q^{2}}{(p')^{2}}}{2\\frac{q}{p'}}\n$$\nSubstituting $\\eta = q/p'$ yields the final closed-form expression for the dilatancy:\n$$\nD = \\frac{M^{2} - \\eta^{2}}{2\\eta}\n$$\nThe problem also asks for an interpretation of the sign and magnitude of $D$. Given the geomechanics sign convention that compressive strains are positive, and noting that for triaxial compression $\\eta > 0$ and shearing implies $\\dot{\\varepsilon}_{s}^{p} > 0$, the sign of $D$ is determined by the sign of the plastic volumetric strain rate $\\dot{\\varepsilon}_{v}^{p}$, which is given by the sign of the numerator $M^{2} - \\eta^{2}$.\n1.  If $\\eta  M$: The state is \"sub-critical\" or on the \"wet side\" of the critical state line. In this case, $M^{2} - \\eta^{2}  0$, so $D  0$. This implies $\\dot{\\varepsilon}_{v}^{p}  0$, which signifies plastic compaction (volume decrease).\n2.  If $\\eta  M$: The state is \"super-critical\" or on the \"dry side\" of the critical state line. In this case, $M^{2} - \\eta^{2}  0$, so $D  0$. This implies $\\dot{\\varepsilon}_{v}^{p}  0$, which signifies plastic dilation (volume increase).\n3.  If $\\eta = M$: The state is at the \"critical state\". In this case, $M^{2} - \\eta^{2} = 0$, so $D = 0$. This implies $\\dot{\\varepsilon}_{v}^{p} = 0$, which signifies plastic shearing at constant volume (zero net volumetric strain).\n\nThe magnitude of $D$ represents the ratio of instantaneous plastic volume change to plastic shear distortion. This ratio approaches zero as the stress state approaches the critical state line ($\\eta \\to M$).",
            "answer": "$$\n\\boxed{\\frac{M^{2} - \\eta^{2}}{2\\eta}}\n$$"
        },
        {
            "introduction": "Bridging theory and practical application in computational geomechanics requires robust numerical algorithms. This exercise guides you through the formulation and implementation of a return-mapping algorithm, which is the standard method for integrating elastoplastic constitutive equations in finite element software. You will work with the widely used non-associated Mohr-Coulomb model, where the friction angle $\\varphi$ and dilatancy angle $\\psi$ are treated as independent parameters, reflecting the behavior of many real sands . Mastering this procedure is a critical step towards developing or using advanced numerical tools for geotechnical analysis.",
            "id": "3517443",
            "problem": "Consider a small-strain, rate-independent, perfectly plastic, non-associated Mohr–Coulomb model in computational geomechanics, formulated in terms of isotropic stress-strain invariants. Use the following base assumptions:\n\n- The sign convention is compression-positive. Define the mean (pressure) stress invariant as $p = \\left(\\sigma_{1} + \\sigma_{2} + \\sigma_{3}\\right)/3$ and the deviatoric stress invariant as $q = \\sqrt{3\\,J_{2}}$, where $J_{2}$ is the second deviatoric invariant of the Cauchy stress tensor.\n- The elastic law is linear isotropic with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The bulk modulus is $K = \\dfrac{E}{3\\left(1 - 2\\nu\\right)}$ and the shear modulus is $G = \\dfrac{E}{2\\left(1 + \\nu\\right)}$.\n- The Mohr–Coulomb yield function in $p$–$q$ space for triaxial compression is\n$$\nf\\left(q,p\\right) = q - M_{\\varphi}\\,p - c_{0},\n$$\nwhere $M_{\\alpha} = \\dfrac{6\\sin\\alpha}{3 - \\sin\\alpha}$ for any angle $\\alpha$, $\\varphi$ is the friction angle, $c$ is the cohesion, and\n$$\nc_{0} = \\dfrac{6\\,c\\,\\cos\\varphi}{3 - \\sin\\varphi}.\n$$\n- The plastic potential is taken as\n$$\ng\\left(q,p\\right) = q - M_{\\psi}\\,p,\n$$\nwith $\\psi$ the dilatancy angle. The flow rule is non-associated, and plastic strain increments are defined in terms of work-conjugate invariant pairs as\n$$\n\\mathrm{d}\\varepsilon_{v}^{p} = \\lambda\\,\\dfrac{\\partial g}{\\partial p}, \\quad \\mathrm{d}\\varepsilon_{s}^{p} = \\lambda\\,\\dfrac{\\partial g}{\\partial q},\n$$\nwhere $\\varepsilon_{v}^{p}$ is the plastic volumetric strain, $\\varepsilon_{s}^{p}$ is the equivalent plastic shear strain, and $\\lambda \\ge 0$ is the plastic multiplier.\n- For a given total strain increment, the elastic predictor (trial state) in invariants is $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$. The stress correction upon yielding is governed by elastic unloading from the trial state along with plastic flow:\n$$\np = p^{\\mathrm{tr}} - K\\,\\mathrm{d}\\varepsilon_{v}^{p}, \\quad q = q^{\\mathrm{tr}} - 3\\,G\\,\\mathrm{d}\\varepsilon_{s}^{p}.\n$$\n\nTask A. Starting strictly from the above base, formulate a return-mapping algorithm in invariant form for this non-associated Mohr–Coulomb model. Derive, without assuming any further constitutive shortcuts, a closed-form expression for the plastic multiplier increment $\\lambda$ for the triaxial-compression branch and, consequently, explicit update equations for the plastic strain increments $\\mathrm{d}\\varepsilon_{v}^{p}$ and $\\mathrm{d}\\varepsilon_{s}^{p}$ in terms of the trial invariants $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$ and material parameters $\\left(E,\\nu,\\varphi,\\psi,c\\right)$. Show how to compute the corrected invariants $\\left(p, q\\right)$ at the end of the increment. The consistency condition $f\\left(q,p\\right) = 0$ must be enforced for plastic loading. If the trial state is admissible, that is, if $f\\left(q^{\\mathrm{tr}},p^{\\mathrm{tr}}\\right) \\le 0$, the step is elastic and the plastic increments must be zero.\n\nTask B. Implement the derived return-mapping as a program that, for each provided test case, takes as input $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$, $E$, $\\nu$, $\\varphi$, $\\psi$, and $c$, and outputs the four quantities $\\left[\\mathrm{d}\\varepsilon_{v}^{p}, \\mathrm{d}\\varepsilon_{s}^{p}, p, q\\right]$ for that case. Use the following requirements:\n\n- Units and angles:\n  - All stresses $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}, p, q, c\\right)$ must be expressed in Pascals.\n  - All angles $\\left(\\varphi,\\psi\\right)$ must be expressed in radians.\n  - Strains $\\left(\\mathrm{d}\\varepsilon_{v}^{p}, \\mathrm{d}\\varepsilon_{s}^{p}\\right)$ are dimensionless.\n- Numerical output formatting:\n  - Express every floating-point output as a decimal in scientific notation with exactly $10$ significant digits after the decimal point (for example, use a format such as $a.bbbbbbbbbe\\pm cc$).\n- Final output format:\n  - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of concatenating all test-case results one after another. For $N$ test cases, the output must be\n  $$\n  \\left[\\mathrm{d}\\varepsilon_{v,1}^{p},\\mathrm{d}\\varepsilon_{s,1}^{p},p_{1},q_{1},\\dots,\\mathrm{d}\\varepsilon_{v,N}^{p},\\mathrm{d}\\varepsilon_{s,N}^{p},p_{N},q_{N}\\right].\n  $$\n\nTest Suite. Use $5$ cases that cover elastic, on-yield, and plastic responses including edge conditions:\n\n- Case $1$ (elastic understrength): $E = 1.0\\times 10^{8}\\,\\mathrm{Pa}$, $\\nu = 0.3$, $\\varphi = \\dfrac{\\pi}{6}$, $\\psi = \\dfrac{\\pi}{18}$, $c = 1.0\\times 10^{4}\\,\\mathrm{Pa}$, $p^{\\mathrm{tr}} = 2.0\\times 10^{5}\\,\\mathrm{Pa}$, $q^{\\mathrm{tr}} = 1.5\\times 10^{5}\\,\\mathrm{Pa}$.\n- Case $2$ (on yield surface): same $E$, $\\nu$, $\\varphi$, $\\psi$, $c$, $p^{\\mathrm{tr}} = 2.0\\times 10^{5}\\,\\mathrm{Pa}$, and $q^{\\mathrm{tr}}$ exactly set to $q^{\\mathrm{tr}} = M_{\\varphi}\\,p^{\\mathrm{tr}} + c_{0}$.\n- Case $3$ (plastic, non-associated): same $E$, $\\nu$, $\\varphi$, $\\psi$, $c$, $p^{\\mathrm{tr}} = 2.0\\times 10^{5}\\,\\mathrm{Pa}$, $q^{\\mathrm{tr}} = 4.0\\times 10^{5}\\,\\mathrm{Pa}$.\n- Case $4$ (plastic, zero dilatancy): $E = 1.0\\times 10^{8}\\,\\mathrm{Pa}$, $\\nu = 0.3$, $\\varphi = \\dfrac{\\pi}{6}$, $\\psi = 0$, $c = 0$, $p^{\\mathrm{tr}} = 1.0\\times 10^{5}\\,\\mathrm{Pa}$, $q^{\\mathrm{tr}} = 2.0\\times 10^{5}\\,\\mathrm{Pa}$.\n- Case $5$ (cohesive, frictionless): $E = 1.0\\times 10^{8}\\,\\mathrm{Pa}$, $\\nu = 0.3$, $\\varphi = 0$, $\\psi = 0$, $c = 5.0\\times 10^{4}\\,\\mathrm{Pa}$, $p^{\\mathrm{tr}} = 5.0\\times 10^{4}\\,\\mathrm{Pa}$, $q^{\\mathrm{tr}} = 1.5\\times 10^{5}\\,\\mathrm{Pa}$.\n\nYour program must compute the return-mapped results for these cases and print a single line containing the flattened list\n$$\n\\left[\\mathrm{d}\\varepsilon_{v,1}^{p},\\mathrm{d}\\varepsilon_{s,1}^{p},p_{1},q_{1},\\mathrm{d}\\varepsilon_{v,2}^{p},\\mathrm{d}\\varepsilon_{s,2}^{p},p_{2},q_{2},\\mathrm{d}\\varepsilon_{v,3}^{p},\\mathrm{d}\\varepsilon_{s,3}^{p},p_{3},q_{3},\\mathrm{d}\\varepsilon_{v,4}^{p},\\mathrm{d}\\varepsilon_{s,4}^{p},p_{4},q_{4},\\mathrm{d}\\varepsilon_{v,5}^{p},\\mathrm{d}\\varepsilon_{s,5}^{p},p_{5},q_{5}\\right]\n$$\nformatted with no spaces anywhere in the line.",
            "solution": "The user has provided a well-posed problem in computational geomechanics, requiring the derivation and implementation of a return-mapping algorithm for a non-associated Mohr–Coulomb plasticity model. The problem is scientifically sound, self-contained, and all provided definitions and parameters are standard in the field. The validation is passed, and I will proceed with the solution.\n\n### Task A: Formulation of the Return-Mapping Algorithm\n\nThe objective is to derive a closed-form algorithm to update the stress state for a given total strain increment, which results in a trial stress state $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$. The update must ensure that the final stress state $\\left(p, q\\right)$ satisfies the Mohr-Coulomb yield criterion if the trial state lies outside the elastic domain.\n\n**1. Preliminary Definitions**\n\nThe problem provides the following key relationships:\n- Linear elastic moduli: Bulk modulus $K = \\dfrac{E}{3\\left(1 - 2\\nu\\right)}$ and shear modulus $G = \\dfrac{E}{2\\left(1 + \\nu\\right)}$.\n- Mohr-Coulomb yield function: $f\\left(q,p\\right) = q - M_{\\varphi}\\,p - c_{0} = 0$, where $M_{\\varphi} = \\dfrac{6\\sin\\varphi}{3 - \\sin\\varphi}$ and $c_{0} = \\dfrac{6c\\cos\\varphi}{3 - \\sin\\varphi}$.\n- Plastic potential function for non-associated flow: $g\\left(q,p\\right) = q - M_{\\psi}\\,p$, where $M_{\\psi} = \\dfrac{6\\sin\\psi}{3 - \\sin\\psi}$.\n\n**2. Flow Rule**\n\nThe plastic strain increments are given by the flow rule, derived from the plastic potential $g$:\n$$\n\\mathrm{d}\\varepsilon_{v}^{p} = \\lambda\\,\\dfrac{\\partial g}{\\partial p}, \\quad \\mathrm{d}\\varepsilon_{s}^{p} = \\lambda\\,\\dfrac{\\partial g}{\\partial q}\n$$\nwhere $\\lambda \\ge 0$ is the plastic multiplier. We compute the partial derivatives of $g(q,p)$:\n$$\n\\dfrac{\\partial g}{\\partial p} = -M_{\\psi}\n$$\n$$\n\\dfrac{\\partial g}{\\partial q} = 1\n$$\nSubstituting these into the flow rule gives the plastic strain increments in terms of $\\lambda$:\n$$\n\\mathrm{d}\\varepsilon_{v}^{p} = -\\lambda\\,M_{\\psi}\n$$\n$$\n\\mathrm{d}\\varepsilon_{s}^{p} = \\lambda\n$$\n\n**3. Stress Update Equations**\n\nThe total strain increment is additively decomposed into elastic and plastic parts. The stress is updated from the elastic predictor (trial) state $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$ by subtracting the stress change corresponding to the plastic part of the strain increment:\n$$\np = p^{\\mathrm{tr}} - K\\,\\mathrm{d}\\varepsilon_{v}^{p}\n$$\n$$\nq = q^{\\mathrm{tr}} - 3\\,G\\,\\mathrm{d}\\varepsilon_{s}^{p}\n$$\nSubstituting the expressions for the plastic strain increments from the flow rule yields the updated stresses as a function of the plastic multiplier $\\lambda$:\n$$\np = p^{\\mathrm{tr}} - K \\left(-\\lambda\\,M_{\\psi}\\right) = p^{\\mathrm{tr}} + \\lambda K M_{\\psi}\n$$\n$$\nq = q^{\\mathrm{tr}} - 3\\,G \\left(\\lambda\\right) = q^{\\mathrm{tr}} - 3G\\lambda\n$$\n\n**4. Consistency Condition and Derivation of the Plastic Multiplier $\\lambda$**\n\nThe process is governed by the Karush-Kuhn-Tucker (KKT) loading/unloading conditions:\n- $f(q, p) \\le 0$ (Yield condition)\n- $\\lambda \\ge 0$ (Non-negative plastic work)\n- $\\lambda f(q,p) = 0$ (Complementarity condition)\n\nWe first evaluate the yield function at the trial state:\n$$\nf^{\\mathrm{tr}} = f\\left(q^{\\mathrm{tr}}, p^{\\mathrm{tr}}\\right) = q^{\\mathrm{tr}} - M_{\\varphi}p^{\\mathrm{tr}} - c_{0}\n$$\n\nIf $f^{\\mathrm{tr}} \\le 0$, the trial state is inside or on the yield surface (admissible). The step is elastic. The KKT conditions imply $\\lambda = 0$. Consequently:\n- $\\mathrm{d}\\varepsilon_{v}^{p} = 0$\n- $\\mathrm{d}\\varepsilon_{s}^{p} = 0$\n- $p = p^{\\mathrm{tr}}$\n- $q = q^{\\mathrm{tr}}$\n\nIf $f^{\\mathrm{tr}}  0$, the trial state is outside the yield surface (inadmissible). Plastic flow must occur, so $\\lambda  0$. The KKT conditions then require that the final stress state $\\left(p, q\\right)$ lies on the yield surface, satisfying the consistency condition $f\\left(q, p\\right) = 0$.\n\nWe enforce this condition by substituting the update equations for $p$ and $q$ into the yield function:\n$$\nf\\left(q,p\\right) = \\left(q^{\\mathrm{tr}} - 3G\\lambda\\right) - M_{\\varphi}\\left(p^{\\mathrm{tr}} + \\lambda K M_{\\psi}\\right) - c_{0} = 0\n$$\nNow, we rearrange this equation to solve for the unknown plastic multiplier $\\lambda$:\n$$\nq^{\\mathrm{tr}} - M_{\\varphi}p^{\\mathrm{tr}} - c_{0} = 3G\\lambda + \\lambda K M_{\\varphi} M_{\\psi}\n$$\nThe left-hand side is exactly the yield function evaluated at the trial state, $f^{\\mathrm{tr}}$.\n$$\nf^{\\mathrm{tr}} = \\lambda \\left(3G + K M_{\\varphi} M_{\\psi}\\right)\n$$\nThis yields the closed-form expression for the plastic multiplier:\n$$\n\\lambda = \\dfrac{f^{\\mathrm{tr}}}{3G + K M_{\\varphi} M_{\\psi}} = \\dfrac{q^{\\mathrm{tr}} - M_{\\varphi}p^{\\mathrm{tr}} - c_{0}}{3G + K M_{\\varphi} M_{\\psi}}\n$$\n\n**5. Final Algorithm**\n\nThe complete return-mapping algorithm is as follows:\n\n1.  **Input**: Trial stress invariants $\\left(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}\\right)$ and material parameters $\\left(E, \\nu, \\varphi, \\psi, c\\right)$.\n2.  **Calculate Constants**:\n    -   Elastic moduli: $K = \\dfrac{E}{3(1-2\\nu)}$, $G = \\dfrac{E}{2(1+\\nu)}$.\n    -   Mohr-Coulomb parameters: $M_{\\varphi} = \\dfrac{6\\sin\\varphi}{3-\\sin\\varphi}$, $M_{\\psi} = \\dfrac{6\\sin\\psi}{3-\\sin\\psi}$, $c_0 = \\dfrac{6c\\cos\\varphi}{3-\\sin\\varphi}$.\n3.  **Check for Plasticity**: Evaluate the yield function at the trial state, $f^{\\mathrm{tr}} = q^{\\mathrm{tr}} - M_{\\varphi}p^{\\mathrm{tr}} - c_{0}$.\n4.  **Compute Final State**:\n    -   **If $f^{\\mathrm{tr}} \\le 0$ (Elastic Step)**:\n        -   $\\mathrm{d}\\varepsilon_{v}^{p} = 0.0$\n        -   $\\mathrm{d}\\varepsilon_{s}^{p} = 0.0$\n        -   $p = p^{\\mathrm{tr}}$\n        -   $q = q^{\\mathrm{tr}}$\n    -   **If $f^{\\mathrm{tr}}  0$ (Plastic Step)**:\n        -   Calculate the plastic multiplier: $\\lambda = \\dfrac{f^{\\mathrm{tr}}}{3G + K M_{\\varphi} M_{\\psi}}$.\n        -   Calculate plastic strain increments: $\\mathrm{d}\\varepsilon_{v}^{p} = -\\lambda M_{\\psi}$ and $\\mathrm{d}\\varepsilon_{s}^{p} = \\lambda$.\n        -   Update stress invariants: $p = p^{\\mathrm{tr}} + \\lambda K M_{\\psi}$ and $q = q^{\\mathrm{tr}} - 3G\\lambda$.\n5.  **Output**: The four quantities $\\left[\\mathrm{d}\\varepsilon_{v}^{p}, \\mathrm{d}\\varepsilon_{s}^{p}, p, q\\right]$.\n\nThis concludes the derivation for Task A. The subsequent implementation is based on this algorithm.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the Mohr-Coulomb return-mapping algorithm.\n    \"\"\"\n\n    # Helper function to perform the return-mapping for a single case.\n    def compute_mohr_coulomb_return_map(p_tr, q_tr, E, nu, phi, psi, c):\n        \"\"\"\n        Computes the corrected stress state and plastic strain increments for a\n        non-associated Mohr-Coulomb model using a return-mapping algorithm.\n\n        Args:\n            p_tr (float): Trial mean stress (Pa).\n            q_tr (float): Trial deviatoric stress (Pa).\n            E (float): Young's modulus (Pa).\n            nu (float): Poisson's ratio.\n            phi (float): Friction angle (radians).\n            psi (float): Dilatancy angle (radians).\n            c (float): Cohesion (Pa).\n\n        Returns:\n            tuple: A tuple containing (d_eps_v_p, d_eps_s_p, p, q).\n        \"\"\"\n        # Step 1: Calculate elastic and material constants\n        if 1 - 2 * nu = 0: # Avoid division by zero or negative K\n             # For nu=0.5, material is incompressible. K would be infinite.\n             # This problem context assumes compressible elasticity.\n             raise ValueError(\"Poisson's ratio results in non-positive K.\")\n\n        K = E / (3.0 * (1.0 - 2.0 * nu))\n        G = E / (2.0 * (1.0 + nu))\n\n        sin_phi = np.sin(phi)\n        cos_phi = np.cos(phi)\n        sin_psi = np.sin(psi)\n        \n        # Handle cases where denominator might be zero if phi or psi are ill-defined\n        # For this problem, angles are within physical ranges.\n        den_phi = 3.0 - sin_phi\n        if den_phi == 0: raise ValueError(\"Friction angle definition issue.\")\n\n        M_phi = (6.0 * sin_phi) / den_phi\n        c0 = (6.0 * c * cos_phi) / den_phi\n\n        den_psi = 3.0 - sin_psi\n        if den_psi == 0: raise ValueError(\"Dilatancy angle definition issue.\")\n        M_psi = (6.0 * sin_psi) / den_psi\n\n        # Step 2: Check for plasticity\n        f_tr = q_tr - M_phi * p_tr - c0\n\n        # Step 3: Determine path (elastic or plastic)\n        if f_tr = 1e-9:  # Use a small tolerance for floating point comparison\n            # Elastic or on-yield-surface step\n            d_eps_v_p = 0.0\n            d_eps_s_p = 0.0\n            p = p_tr\n            q = q_tr\n        else:\n            # Plastic step: return mapping required\n            # Calculate the plastic multiplier lambda\n            denominator = 3.0 * G + K * M_phi * M_psi\n            if denominator == 0:\n                raise ValueError(\"Denominator for lambda calculation is zero.\")\n            \n            lam = f_tr / denominator\n\n            # Calculate plastic strain increments\n            d_eps_v_p = -lam * M_psi\n            d_eps_s_p = lam\n\n            # Update stress invariants\n            p = p_tr + K * lam * M_psi\n            q = q_tr - 3.0 * G * lam\n\n        return d_eps_v_p, d_eps_s_p, p, q\n\n    # Define the test suite from the problem statement.\n    E_base = 1.0e8\n    nu_base = 0.3\n    phi_base = np.pi / 6.0\n    psi_base = np.pi / 18.0\n    c_base = 1.0e4\n\n    # Case 2 requires q_tr to be exactly on the yield surface.\n    sin_phi_base = np.sin(phi_base)\n    M_phi_base = (6.0 * sin_phi_base) / (3.0 - sin_phi_base)\n    c0_base = (6.0 * c_base * np.cos(phi_base)) / (3.0 - sin_phi_base)\n    q_tr_case2 = M_phi_base * 2.0e5 + c0_base\n\n    test_cases = [\n        # Case 1 (elastic understrength)\n        (2.0e5, 1.5e5, E_base, nu_base, phi_base, psi_base, c_base),\n        # Case 2 (on yield surface)\n        (2.0e5, q_tr_case2, E_base, nu_base, phi_base, psi_base, c_base),\n        # Case 3 (plastic, non-associated)\n        (2.0e5, 4.0e5, E_base, nu_base, phi_base, psi_base, c_base),\n        # Case 4 (plastic, zero dilatancy)\n        (1.0e5, 2.0e5, 1.0e8, 0.3, np.pi/6.0, 0.0, 0.0),\n        # Case 5 (cohesive, frictionless)\n        (5.0e4, 1.5e5, 1.0e8, 0.3, 0.0, 0.0, 5.0e4),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        p_tr, q_tr, E, nu, phi, psi, c = case\n        result = compute_mohr_coulomb_return_map(p_tr, q_tr, E, nu, phi, psi, c)\n        all_results.extend(result)\n\n    # Format the results into the required string format.\n    formatted_results = [f\"{val:.10e}\" for val in all_results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}