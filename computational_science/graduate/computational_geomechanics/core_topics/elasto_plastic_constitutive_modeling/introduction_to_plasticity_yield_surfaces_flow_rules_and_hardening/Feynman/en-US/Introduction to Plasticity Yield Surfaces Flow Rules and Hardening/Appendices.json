{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will implement a stress-update algorithm for the Modified Cam-Clay (MCC) model, a cornerstone of critical state soil mechanics. This exercise  requires you to code the full elastic predictor-plastic corrector framework, a fundamental skill in computational geomechanics. By successfully implementing this return-mapping algorithm, you will gain a deep, practical understanding of how path-dependent phenomena like plastic flow and hardening are simulated numerically within a single integration step.",
            "id": "3534591",
            "problem": "Implement a stress update for a single axisymmetric triaxial compression increment for a soil obeying the Modified Cam-Clay (MCC) model, returning the updated mean effective stress, deviatoric stress, and preconsolidation pressure. Use a small-strain additive split into elastic and plastic parts, an associated flow rule, and isotropic logarithmic elasticity for the volumetric response, with a consistent hardening law.\n\nAssume the following invariant definitions and sign conventions:\n- Compression is positive.\n- The mean effective stress is defined as $p = (\\sigma_1 + \\sigma_2 + \\sigma_3)/3$ and the deviatoric stress invariant is $q = \\sqrt{3/2}\\,\\lVert \\boldsymbol{s} \\rVert$, where $\\boldsymbol{s}$ is the stress deviator.\n- The Modified Cam-Clay yield function in $(p,q)$-space is\n$$\nf(p,q,p_c) = \\frac{q^2}{M^2} + p \\left(p - p_c \\right).\n$$\n- The elastic law is isotropic and logarithmic in volumetric response with $d \\varepsilon_v^e = \\kappa \\, d p / p$, so the tangent bulk modulus is $K(p) = p/\\kappa$. The shear modulus is linked to the bulk modulus through a constant elastic Poisson ratio $\\nu_e$ by \n$$\nG(p) = \\frac{3 K(p) (1 - 2 \\nu_e)}{2(1+\\nu_e)}.\n$$\n- The associated flow rule in invariant form implies plastic strain increments satisfy $d \\varepsilon_v^p = \\Lambda \\,\\partial f/\\partial p$ and $d \\varepsilon_s^p = \\Lambda \\,\\partial f/\\partial q$, where $\\Lambda \\ge 0$ is the plastic multiplier, $\\varepsilon_v$ is the volumetric strain, and $\\varepsilon_s$ is the deviatoric strain measure work-conjugate to $q$. For axisymmetric increments with axial strain increment $d \\varepsilon_a$ and radial strain increment $d \\varepsilon_r$, \n$$\nd \\varepsilon_v = d \\varepsilon_a + 2 d \\varepsilon_r,\\qquad d \\varepsilon_s = \\frac{2}{3}\\left(d \\varepsilon_a - d \\varepsilon_r \\right).\n$$\n- The hardening law for the preconsolidation pressure is given by\n$$\nd p_c = \\frac{p_c}{\\lambda - \\kappa}\\, d \\varepsilon_v^p,\n$$\nwhere $\\lambda$ is the compression index and $\\kappa$ is the swelling index.\n\nStarting from an initial admissible stress state $(p_n, q_n, p_{c,n})$ at the beginning of the increment and a given strain increment $(\\Delta \\varepsilon_a, \\Delta \\varepsilon_r)$, formulate an elastic predictor–plastic corrector algorithm. Use a predictor with the current-state tangent moduli $K(p_n)$ and $G(p_n)$ to compute the trial state $(p_{\\text{tr}}, q_{\\text{tr}})$. If $f(p_{\\text{tr}}, q_{\\text{tr}}, p_{c,n}) \\le 0$, accept the trial state and set $p_{c,n+1} = p_{c,n}$. Otherwise, perform a plastic return enforcing consistency $f(p_{n+1}, q_{n+1}, p_{c,n+1}) = 0$ using an implicit backward-Euler update with unknown plastic multiplier $\\Delta \\Lambda$. The fully implicit update must satisfy the following coupled equations at the end of the step:\n- Elastic-plastic stress update in invariants:\n$$\np_{n+1} = p_n + K(p_{n+1}) \\left(\\Delta \\varepsilon_v - \\Delta \\varepsilon_v^p \\right), \\quad q_{n+1} = q_n + 3 G(p_{n+1}) \\left(\\Delta \\varepsilon_s - \\Delta \\varepsilon_s^p \\right),\n$$\nwith $\\Delta \\varepsilon_v^p = \\Delta \\Lambda \\, \\frac{\\partial f}{\\partial p}(p_{n+1}, q_{n+1}, p_{c,n+1})$ and $\\Delta \\varepsilon_s^p = \\Delta \\Lambda \\, \\frac{\\partial f}{\\partial q}(p_{n+1}, q_{n+1}, p_{c,n+1})$.\n- Hardening update:\n$$\np_{c,n+1} = p_{c,n} + \\frac{p_{c,n+1}}{\\lambda - \\kappa} \\, \\Delta \\varepsilon_v^p.\n$$\n- Consistency:\n$$\nf(p_{n+1}, q_{n+1}, p_{c,n+1}) = 0.\n$$\n\nYour task is to implement a robust Newton-type return-mapping algorithm to solve for $(p_{n+1}, q_{n+1}, p_{c,n+1}, \\Delta \\Lambda)$ when plastic yielding occurs, with line search or damping to enforce $p_{n+1} > 0$ and $p_{c,n+1} > 0$. Assume all quantities are scalars except where noted.\n\nPhysical units and sign conventions:\n- Stresses $p$, $q$, and $p_c$ must be reported in kilopascals (kPa).\n- Strains are dimensionless.\n- Compression-positive convention for strains and stresses must be used.\n\nTest suite:\nUse the following four test cases. For each case, use the listed parameters, all in the units and conventions above. For material parameters, $M$ is the slope of the critical state line in $(p,q)$-space, $\\kappa$ is the swelling index, $\\lambda$ is the compression index, and $\\nu_e$ is the elastic Poisson ratio.\n\n- Case $1$ (elastic increment):\n  - $M = 1.2$, $\\kappa = 0.05$, $\\lambda = 0.2$, $\\nu_e = 0.2$.\n  - Initial state: $p_n = 100.0$ kPa, $q_n = 10.0$ kPa, $p_{c,n} = 300.0$ kPa.\n  - Increment: $\\Delta \\varepsilon_a = 0.0001$, $\\Delta \\varepsilon_r = 0.0$.\n\n- Case $2$ (plastic return from overstress):\n  - $M = 1.2$, $\\kappa = 0.05$, $\\lambda = 0.2$, $\\nu_e = 0.2$.\n  - Initial state: $p_n = 100.0$ kPa, $q_n = 150.0$ kPa, $p_{c,n} = 180.0$ kPa.\n  - Increment: $\\Delta \\varepsilon_a = 0.0002$, $\\Delta \\varepsilon_r = 0.0$.\n\n- Case $3$ (on-yield unloading, should remain elastic):\n  - $M = 1.2$, $\\kappa = 0.05$, $\\lambda = 0.2$, $\\nu_e = 0.2$.\n  - Initial state: $p_n = 100.0$ kPa, $p_{c,n} = 150.0$ kPa, $q_n = M \\sqrt{p_n (p_{c,n} - p_n)}$ kPa.\n  - Increment: $\\Delta \\varepsilon_a = -0.0001$, $\\Delta \\varepsilon_r = 0.0$.\n\n- Case $4$ (purely isotropic compression increment, $\\Delta \\varepsilon_s = 0$):\n  - $M = 1.2$, $\\kappa = 0.05$, $\\lambda = 0.2$, $\\nu_e = 0.2$.\n  - Initial state: $p_n = 50.0$ kPa, $q_n = 5.0$ kPa, $p_{c,n} = 80.0$ kPa.\n  - Increment: $\\Delta \\varepsilon_a = 0.0005$, $\\Delta \\varepsilon_r = 0.0005$.\n\nProgram requirements:\n- Your program must implement the algorithm described above for each case and compute the updated $(p_{n+1}, q_{n+1}, p_{c,n+1})$.\n- Use the elastic predictor with tangent moduli evaluated at $p_n$ and an implicit plastic corrector when needed with moduli evaluated at $p_{n+1}$.\n- Use a Newton-type method with line search or damping to solve the nonlinear system in the plastic step, ensuring $p_{n+1} > 0$ and $p_{c,n+1} > 0$.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n[p_1, q_1, p_{c,1}, p_2, q_2, p_{c,2}, p_3, q_3, p_{c,3}, p_4, q_4, p_{c,4}],\n$$\nwith all entries rounded to $6$ decimal places and reported in kilopascals (kPa).\n\nNo user input is required. The program must be self-contained and deterministic.",
            "solution": "### Step 1: Extract Givens\n\n- **Model:** Modified Cam-Clay (MCC)\n- **Problem Type:** Single axisymmetric triaxial compression stress update.\n- **Strain Decomposition:** Additive, $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p$.\n- **Sign Convention:** Compression is positive for stresses and strains.\n- **Stress Invariants:**\n    - Mean effective stress: $p = (\\sigma_1 + \\sigma_2 + \\sigma_3)/3$.\n    - Deviatoric stress: $q = \\sqrt{3/2} \\, \\lVert \\boldsymbol{s} \\rVert$, where $\\boldsymbol{s}$ is the stress deviator.\n- **Yield Function:** $f(p, q, p_c) = \\frac{q^2}{M^2} + p(p - p_c) = 0$.\n- **Elastic Law (Isotropic):**\n    - Volumetric: $d\\varepsilon_v^e = \\kappa \\, dp/p$, implying a tangent bulk modulus $K(p) = p/\\kappa$.\n    - Shear: Tangent shear modulus $G(p) = \\frac{3 K(p) (1 - 2 \\nu_e)}{2(1+\\nu_e)}$. $\\nu_e$ is a constant elastic Poisson's ratio.\n- **Flow Rule:** Associated, meaning the plastic potential is the yield function, $g=f$.\n    - Increments: $d\\varepsilon_v^p = \\Lambda \\, \\partial f/\\partial p$ and $d\\varepsilon_s^p = \\Lambda \\, \\partial f/\\partial q$, with plastic multiplier $\\Lambda \\ge 0$.\n- **Strain Invariant Increments (Axisymmetric):**\n    - $d\\varepsilon_v = d\\varepsilon_a + 2d\\varepsilon_r$.\n    - $d\\varepsilon_s = \\frac{2}{3}(d\\varepsilon_a - d\\varepsilon_r)$.\n- **Hardening Law (Isotropic):** Governs evolution of preconsolidation pressure $p_c$.\n    - $dp_c = \\frac{p_c}{\\lambda - \\kappa} d\\varepsilon_v^p$, where $\\lambda$ is the compression index and $\\kappa$ is the swelling index.\n- **Algorithm:** Elastic predictor-plastic corrector.\n    - **Predictor:** Uses tangent moduli $K(p_n), G(p_n)$ at the beginning of the step.\n    - **Corrector:** Fully implicit backward-Euler update if yield is detected. The final state $(p_{n+1}, q_{n+1}, p_{c,n+1})$ must satisfy:\n        1.  $p_{n+1} = p_n + K(p_{n+1}) (\\Delta \\varepsilon_v - \\Delta \\varepsilon_v^p)$.\n        2.  $q_{n+1} = q_n + 3 G(p_{n+1}) (\\Delta \\varepsilon_s - \\Delta \\varepsilon_s^p)$.\n        3.  $p_{c,n+1} = p_{c,n} + \\frac{p_{c,n+1}}{\\lambda - \\kappa} \\Delta \\varepsilon_v^p$.\n        4.  $f(p_{n+1}, q_{n+1}, p_{c,n+1}) = 0$.\n        5.  Flow rule derivatives are evaluated at the end state $(n+1)$.\n- **Solver for Corrector:** Newton-type method with line search to ensure $p_{n+1} > 0$ and $p_{c,n+1} > 0$.\n- **Test Cases:**\n    - Case 1: Elastic increment. $M=1.2, \\kappa=0.05, \\lambda=0.2, \\nu_e=0.2$. Initial state: $(p_n, q_n, p_{c,n}) = (100.0, 10.0, 300.0)$. Increment: $(\\Delta\\varepsilon_a, \\Delta\\varepsilon_r) = (0.0001, 0.0)$.\n    - Case 2: Plastic increment. Same material parameters. Initial state: $(100.0, 150.0, 180.0)$. Increment: $(0.0002, 0.0)$.\n    - Case 3: Elastic unloading. Same material parameters. Initial state: $p_n=100.0, p_{c,n}=150.0, q_n = M \\sqrt{p_n(p_{c,n}-p_n)}$. Increment: $(-0.0001, 0.0)$.\n    - Case 4: Isotropic compression. Same material parameters. Initial state: $(50.0, 5.0, 80.0)$. Increment: $(0.0005, 0.0005)$.\n- **Units:** Stresses in kPa, strains are dimensionless.\n- **Output:** A single list $[p_1, q_1, p_{c,1}, \\dots, p_4, q_4, p_{c,4}]$ rounded to $6$ decimal places.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded:** The problem describes the integration of the Modified Cam-Clay model, a cornerstone of critical state soil mechanics. The equations for the yield surface, elastic law, associated flow rule, and hardening are standard. The specified algorithm, an implicit elastic predictor-plastic corrector (return mapping) scheme solved with a Newton-Raphson method, is the canonical numerical technique for computational plasticity. The problem is scientifically sound.\n- **Well-Posed:** The problem provides an initial state, a strain increment, and a complete set of constitutive equations, asking for the updated state. This is a well-defined initial value problem at the material point level. The provided system of equations for the plastic corrector step defines a solvable (though nonlinear) system. The requirement for a Newton-type solver with line search acknowledges the need for a robust numerical approach.\n- **Objective:** The problem is specified using precise mathematical language, invariant definitions, and numerical values. There is no ambiguity, subjectivity, or opinion-based content.\n- **Consistency and Completeness:** All necessary material parameters ($M, \\lambda, \\kappa, \\nu_e$), initial states, and strain increments are provided. The system of equations is complete. Case 2 presents an initial state that is non-admissible ($f(p_n, q_n, p_{c,n}) > 0$), which is a valid test for the robustness of a return-mapping algorithm, as such states can arise from numerical error in larger simulations. This does not invalidate the problem; rather, it tests a key feature of the required algorithm.\n\n### Step 3: Verdict and Action\nThe problem is valid, scientifically grounded, and well-posed. A solution will be provided.\n\n### Principle-Based Design of the Solution\n\nThe problem requires the implementation of a stress update algorithm for the Modified Cam-Clay (MCC) model, a fundamental task in computational geomechanics. The algorithm follows the standard elastic predictor-plastic corrector framework for rate-independent plasticity.\n\n**1. Algorithm Initialization and Strain Increments**\nGiven an initial state $(p_n, q_n, p_{c,n})$ and an axisymmetric strain increment $(\\Delta \\varepsilon_a, \\Delta \\varepsilon_r)$, we first compute the corresponding volumetric and deviatoric strain increments:\n$$\n\\Delta \\varepsilon_v = \\Delta \\varepsilon_a + 2 \\Delta \\varepsilon_r\n$$\n$$\n\\Delta \\varepsilon_s = \\frac{2}{3}(\\Delta \\varepsilon_a - \\Delta \\varepsilon_r)\n$$\n\n**2. Elastic Predictor**\nThe algorithm begins by assuming the entire strain increment is purely elastic. The trial stress state, $(p_{\\text{tr}}, q_{\\text{tr}})$, is calculated using the elastic tangent moduli evaluated at the initial state $p_n$.\nThe tangent bulk and shear moduli are:\n$$\nK_n = K(p_n) = p_n / \\kappa\n$$\n$$\nG_n = G(p_n) = \\frac{3 K(p_n) (1 - 2 \\nu_e)}{2(1+\\nu_e)}\n$$\nThe trial stress state is then:\n$$\np_{\\text{tr}} = p_n + K_n \\Delta \\varepsilon_v\n$$\n$$\nq_{\\text{tr}} = q_n + 3 G_n \\Delta \\varepsilon_s\n$$\nThe preconsolidation pressure remains unchanged during a purely elastic step: $p_{c, \\text{tr}} = p_{c,n}$.\n\n**3. Yield Condition Check**\nThe trial state is checked against the yield criterion using the preconsolidation pressure from the beginning of the step, $p_{c,n}$:\n$$\nf_{\\text{tr}} = f(p_{\\text{tr}}, q_{\\text{tr}}, p_{c,n}) = \\frac{q_{\\text{tr}}^2}{M^2} + p_{\\text{tr}}(p_{\\text{tr}} - p_{c,n})\n$$\n- If $f_{\\text{tr}} \\le 0$, the assumption of elasticity was correct. The trial state is the final state for the increment: $(p_{n+1}, q_{n+1}, p_{c,n+1}) = (p_{\\text{tr}}, q_{\\text{tr}}, p_{c,n})$.\n- If $f_{\\text{tr}} > 0$, the state is outside the elastic domain, indicating that plastic deformation has occurred. A plastic corrector step is necessary to return the stress state to the updated yield surface while satisfying all constitutive laws.\n\n**4. Plastic Corrector: Newton-Raphson Solution**\nThe plastic corrector step involves solving a system of nonlinear equations based on a fully implicit backward-Euler discretization, where all quantities are evaluated at the unknown final state $(p_{n+1}, q_{n+1}, p_{c,n+1})$. For clarity, we will denote this final state as $(p, q, p_c)$.\n\nThe core idea is to establish a system of residual equations, $\\mathbf{R}(\\mathbf{x}) = \\mathbf{0}$, for the unknown state vector $\\mathbf{x} = [p, q, p_c]^T$. These residuals enforce the constitutive laws. By re-arranging the problem's governing equations, we can express the plastic strain increments in terms of the updated stresses and initial stresses:\nFrom the elastic laws:\n$$\n\\Delta \\varepsilon_v^p = \\Delta \\varepsilon_v - \\Delta \\varepsilon_v^e = \\Delta \\varepsilon_v - \\frac{\\kappa}{p}(p - p_n)\n$$\n$$\n\\Delta \\varepsilon_s^p = \\Delta \\varepsilon_s - \\Delta \\varepsilon_s^e = \\Delta \\varepsilon_s - \\frac{1}{3G(p)}(q - q_n)\n$$\nFrom the hardening law:\n$$\n\\Delta \\varepsilon_v^p = (\\lambda - \\kappa) \\frac{p_c - p_{c,n}}{p_c}\n$$\nThe associated flow rule provides a relationship between the plastic strain components:\n$$\n\\frac{\\Delta \\varepsilon_s^p}{\\Delta \\varepsilon_v^p} = \\frac{\\partial f / \\partial q}{\\partial f / \\partial p} = \\frac{2q/M^2}{2p-p_c}\n$$\nCombining these relationships allows us to formulate three residual equations for the three unknowns $(p, q, p_c)$:\n1.  **Residual $R_p$ (Volumetric consistency):** Equates the two expressions for $\\Delta \\varepsilon_v^p$.\n    $$\n    R_p(p, q, p_c) = \\Delta \\varepsilon_v - \\frac{\\kappa}{p}(p - p_n) - (\\lambda - \\kappa) \\frac{p_c - p_{c,n}}{p_c} = 0\n    $$\n2.  **Residual $R_q$ (Deviatoric flow rule):** Relates the plastic strain components through the flow rule.\n    $$\n    R_q(p, q, p_c) = \\left( \\Delta \\varepsilon_s - \\frac{q-q_n}{3G(p)} \\right) - \\left( (\\lambda - \\kappa) \\frac{p_c - p_{c,n}}{p_c} \\right) \\frac{2q}{M^2(2p-p_c)} = 0\n    $$\n3.  **Residual $R_f$ (Yield surface consistency):** Enforces that the final state lies on the yield surface.\n    $$\n    R_f(p, q, p_c) = \\frac{q^2}{M^2} + p(p - p_c) = 0\n    $$\nThis $3 \\times 3$ nonlinear system, $\\mathbf{R}(\\mathbf{x}) = \\mathbf{0}$, is solved using the Newton-Raphson method. Starting with an initial guess $\\mathbf{x}_0 = [p_{\\text{tr}}, q_{\\text{tr}}, p_{c,n}]^T$, the method iteratively improves the solution via:\n$$\n\\mathbf{x}_{k+1} = \\mathbf{x}_k - \\alpha_k \\mathbf{J}^{-1}(\\mathbf{x}_k) \\mathbf{R}(\\mathbf{x}_k)\n$$\nwhere $\\mathbf{J} = \\partial \\mathbf{R} / \\partial \\mathbf{x}$ is the Jacobian matrix of the residual system. The partial derivatives are computed analytically. $\\alpha_k$ is a step size determined by a line search procedure to ensure that $p$ and $p_c$ remain positive during the iteration, enhancing robustness. The iteration continues until the norm of the residual vector $\\|\\mathbf{R}(\\mathbf{x}_k)\\|$ falls below a specified tolerance.\n\nUpon convergence, the vector $\\mathbf{x}$ provides the final updated state $(p_{n+1}, q_{n+1}, p_{c,n+1})$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases for the Modified Cam-Clay stress update.\n    \"\"\"\n    # Material parameters\n    # M: CSL slope, kap: swelling index, lam: compression index, nu_e: elastic Poisson's ratio\n    params1_4 = {'M': 1.2, 'kap': 0.05, 'lam': 0.2, 'nu_e': 0.2}\n\n    # Test cases: (p_n, q_n, pc_n, d_eps_a, d_eps_r, params)\n    test_cases = [\n        # Case 1: Elastic increment\n        (100.0, 10.0, 300.0, 0.0001, 0.0, params1_4),\n        # Case 2: Plastic return from overstress\n        (100.0, 150.0, 180.0, 0.0002, 0.0, params1_4),\n        # Case 3: On-yield unloading\n        (100.0,\n         params1_4['M'] * math.sqrt(100.0 * (150.0 - 100.0)),\n         150.0, -0.0001, 0.0, params1_4),\n        # Case 4: Purely isotropic compression\n        (50.0, 5.0, 80.0, 0.0005, 0.0005, params1_4),\n    ]\n\n    results = []\n    for case in test_cases:\n        p_n, q_n, pc_n, d_eps_a, d_eps_r, params = case\n        p_np1, q_np1, pc_np1 = stress_update(p_n, q_n, pc_n, d_eps_a, d_eps_r, **params)\n        results.extend([round(p_np1, 6), round(q_np1, 6), round(pc_np1, 6)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef plastic_corrector(p_n, q_n, pc_n, d_eps_v, d_eps_s, p_tr, q_tr, M, lam, kap, nu_e):\n    \"\"\"\n    Performs the plastic correction using a Newton-Raphson scheme.\n    \"\"\"\n    # Initial guess for the state variables [p, q, pc]\n    x = np.array([p_tr, q_tr, pc_n])\n\n    max_iter = 30\n    tol = 1.e-9\n    damping_factor = 0.8  # for line search\n\n    def calculate_residuals(p, q, pc):\n        # Ensure physical values\n        if p <= 0 or pc <= 0:\n            return np.array([np.inf, np.inf, np.inf])\n\n        # G(p) from K(p)\n        K_p = p / kap\n        G_p = (3. * K_p * (1. - 2. * nu_e)) / (2. * (1. + nu_e))\n        \n        # Residual terms definitions\n        d_eps_v_p_from_hardening = (lam - kap) * (pc - pc_n) / pc\n        d_eps_v_p_from_stress = d_eps_v - (kap / p) * (p - p_n)\n        \n        # R_p: Volumetric consistency\n        R_p = d_eps_v_p_from_stress - d_eps_v_p_from_hardening\n        \n        # R_q: Deviatoric flow rule\n        d_eps_s_p = d_eps_s - (q - q_n) / (3. * G_p)\n        flow_rule_ratio = (2. * q) / (M**2 * (2. * p - pc))\n        R_q = d_eps_s_p - d_eps_v_p_from_hardening * flow_rule_ratio\n\n        # R_f: Yield surface consistency\n        R_f = q**2 / M**2 + p * (p - pc)\n        \n        return np.array([R_p, R_q, R_f])\n\n\n    def calculate_jacobian(p, q, pc):\n        # Pre-compute constant factors\n        C_G_inv = (2. * (1. + nu_e) * kap) / (3. * (1. - 2. * nu_e))\n        term_g = C_G_inv / (3. * p)  # This is 1/(3G)\n\n        # Derivatives of R_p\n        J_11 = -kap * p_n / p**2\n        J_12 = 0.0\n        J_13 = -(lam - kap) * pc_n / pc**2\n\n        # Derivatives of R_q\n        J_21 = -(q - q_n) * (-term_g / p) + \\\n               (lam - kap) * ((pc - pc_n) / pc) * (2 * q / M**2) * (2 / (2 * p - pc)**2)\n        J_22 = -term_g - (lam - kap) * ((pc - pc_n) / pc) * (2 / (M**2 * (2 * p - pc)))\n        J_23 = -(lam - kap) * (pc_n / pc**2) * (2 * q / (M**2 * (2 * p - pc))) - \\\n               (lam - kap) * ((pc - pc_n) / pc) * (2 * q / M**2) * (1 / (2 * p - pc)**2)\n\n        # Derivatives of R_f\n        J_31 = 2. * p - pc\n        J_32 = 2. * q / M**2\n        J_33 = -p\n        \n        return np.array([[J_11, J_12, J_13],\n                           [J_21, J_22, J_23],\n                           [J_31, J_32, J_33]])\n\n    for i in range(max_iter):\n        p_k, q_k, pc_k = x\n        \n        R = calculate_residuals(p_k, q_k, pc_k)\n\n        if np.linalg.norm(R) < tol:\n            return x\n\n        J = calculate_jacobian(p_k, q_k, pc_k)\n        \n        try:\n            dx = np.linalg.solve(J, -R)\n        except np.linalg.LinAlgError:\n            raise RuntimeError(f\"Singular Jacobian matrix in Newton iteration for case.\")\n\n        # Line search to prevent non-physical states\n        alpha = 1.0\n        if dx[0] < 0:\n            alpha = min(alpha, damping_factor * -p_k / dx[0])\n        if dx[2] < 0:\n            alpha = min(alpha, damping_factor * -pc_k / dx[2])\n\n        x = x + alpha * dx\n\n    raise RuntimeError(f\"Plastic corrector failed to converge.\")\n\ndef stress_update(p_n, q_n, pc_n, d_eps_a, d_eps_r, M, lam, kap, nu_e):\n    \"\"\"\n    Computes the updated stress state (p, q, pc) for a single increment.\n    \"\"\"\n    # 1. Calculate strain invariants from axisymmetric components\n    d_eps_v = d_eps_a + 2.0 * d_eps_r\n    d_eps_s = (2.0 / 3.0) * (d_eps_a - d_eps_r)\n\n    # 2. Elastic predictor\n    if p_n <= 0:\n        p_n = 1e-6 # Avoid division by zero, though not expected in test cases\n\n    K_n = p_n / kap\n    G_n = (3. * K_n * (1. - 2. * nu_e)) / (2. * (1. + nu_e))\n\n    p_tr = p_n + K_n * d_eps_v\n    q_tr = q_n + 3. * G_n * d_eps_s\n\n    # Deviatoric stress must be non-negative\n    q_tr = max(0.0, q_tr)\n    \n    # Model is undefined for p <= 0. If predictor gives tension, indicates issue.\n    # For given tests, p_tr will be positive.\n    if p_tr <= 0:\n        raise ValueError(\"Trial mean stress is non-positive. Increment may be too large.\")\n\n    # 3. Yield check\n    f_tr = q_tr**2 / M**2 + p_tr * (p_tr - pc_n)\n\n    if f_tr <= 0:\n        # Elastic step\n        return p_tr, q_tr, pc_n\n    else:\n        # Plastic step: call corrector\n        return plastic_corrector(p_n, q_n, pc_n, d_eps_v, d_eps_s, p_tr, q_tr, M, lam, kap, nu_e)\n\nsolve()\n```"
        },
        {
            "introduction": "While models like MCC are smooth, many essential geomaterials are described by frictional criteria like the Mohr-Coulomb model, which feature non-smooth corners in their yield surfaces. This practice  challenges you to implement and compare two common return-mapping algorithms—the accurate closest-point projection and the simpler cutting-plane method—for a frictional material. This comparison directly illuminates a critical trade-off in computational plasticity: the relationship between the accuracy of the local constitutive solver and the convergence rate of the global equilibrium analysis.",
            "id": "3534631",
            "problem": "Consider small-strain elastoplasticity for a geomaterial idealized by the Mohr–Coulomb criterion restricted to triaxial compression, formulated in terms of the pressure–deviatoric invariants. Let $p$ denote the mean normal stress invariant, $q$ the equivalent shear stress invariant, $\\varepsilon_v$ the volumetric strain, and $\\varepsilon_s$ the equivalent shear strain. Assume the following fundamental base, definitions, and modeling choices.\n\n- Small-strain additive decomposition with linear isotropic elasticity: the elastic law in invariants is\n$$\ndp = K \\left(d\\varepsilon_v - d\\varepsilon_v^p\\right), \\quad dq = 3 G \\left(d\\varepsilon_s - d\\varepsilon_s^p\\right),\n$$\n\n- Mohr–Coulomb yield on the triaxial compression branch is approximated by a single linear segment in the $p$–$q$ plane with cohesion $c$ and friction angle $\\varphi$. This branch is represented by a Drucker–Prager-like line\n$$\nf(p,q,\\kappa) = q + \\alpha(\\varphi)\\, p - k(\\kappa) \\le 0,\n$$\nwith $\\alpha(\\varphi) = \\dfrac{6 \\sin \\varphi}{3 - \\sin \\varphi}$ and initial cohesion-intercept\n$$\nk(0) = k_0(\\varphi,c) = \\dfrac{6 c \\cos \\varphi}{3 - \\sin \\varphi}.\n$$\nHere $\\kappa$ is a scalar internal variable controlling hardening of $k(\\kappa)$.\n\n- Non-associative plastic flow is defined by a plastic potential\n$$\ng(p,q) = q + \\alpha_g(\\psi) \\, p,\n$$\nwith dilatancy angle $\\psi$ and $\\alpha_g(\\psi) = \\dfrac{6 \\sin \\psi}{3 - \\sin \\psi}$. The plastic flow increments in invariants satisfy\n$$\nd\\varepsilon_v^p = a\\, d\\lambda, \\quad d\\varepsilon_s^p = b\\, d\\lambda, \\quad a = \\dfrac{\\partial g}{\\partial p} = \\alpha_g(\\psi), \\quad b = \\dfrac{\\partial g}{\\partial q} = 1,\n$$\nwhere $d\\lambda \\ge 0$ is the plastic multiplier. The hardening law is\n$$\nk(\\kappa) = k_0 + h \\, \\kappa^m,\n$$\nwith $h \\ge 0$ and $m \\ge 1$. The rate satisfies $d\\kappa = d\\lambda$ in monotonic loading.\n\n- Trial (elastic predictor) for a strain increment is given by\n$$\np^{\\mathrm{tr}} = p_n + K \\, d\\varepsilon_v, \\quad q^{\\mathrm{tr}} = q_n + 3 G \\, d\\varepsilon_s,\n$$\nwith state subscript $n$ denoting the beginning of the load step.\n\nTwo algorithmic plastic correctors are to be implemented for a return to the yield surface $f=0$:\n- Closest-point projection in stress space with consistency enforced for the nonlinear hardening $k(\\kappa)$.\n- Cutting-plane with a single linearized correction that evaluates the hardening slope at the beginning of the step and does not update it during the correction.\n\nYou must derive from first principles the algorithmic shear modulus (the consistent elastoplastic tangent in the $q$–$\\varepsilon_s$ direction), defined as\n$$\n\\mathbb{C}_{22}^{\\mathrm{alg}} = \\frac{\\partial q}{\\partial \\varepsilon_s},\n$$\nfor each algorithm under the above model. Then, you must embed the constitutive update into a single-degree-of-freedom equilibrium for a rigid strip footing idealized as a one-point integration element in plane strain with unit thickness and kinematics restricted to pure shear, $d\\varepsilon_v = 0$, $d\\varepsilon_s = du$, where $u$ is the scalar global degree of freedom. The internal force is $q(u)$ and the external force is $Q_{\\mathrm{ext}}$. The equilibrium residual at a trial $u$ is\n$$\nr(u) = q(u) - Q_{\\mathrm{ext}}.\n$$\nUse the Newton–Raphson method with the algorithmic tangent as the Jacobian,\n$$\n\\frac{dr}{du} = \\mathbb{C}_{22}^{\\mathrm{alg}},\n$$\nstarting from $u^{(0)} = 0$. Iterate until $|r(u)| < \\tau$ with a strict absolute tolerance $\\tau = 10^{-6}$ in kilopascals. Cap the iteration count at a maximum of $50$. For the cutting-plane algorithm, use the corresponding cutting-plane algorithmic tangent as the Jacobian. Count the number of iterations required to converge for each algorithm.\n\nAngle inputs must be provided in degrees. Stresses and moduli must be in kilopascals (kPa). Strains are dimensionless. Express the final iteration counts as integers and the algorithmic tangent differences as floats in kilopascals.\n\nImplement a complete, runnable program that:\n- Implements both return-mapping algorithms in the $p$–$q$ space with $d\\varepsilon_v = 0$ and $d\\varepsilon_s = u$ for a single load step from the zero state $p_n = 0$, $q_n = 0$, $\\kappa_n = 0$.\n- For a given $u$, computes the stress response $q(u)$ and the algorithmic shear tangent $\\mathbb{C}_{22}^{\\mathrm{alg}}(u)$ for each algorithm.\n- Uses Newton–Raphson to solve $r(u) = 0$ for each algorithm independently.\n- Reports, for each test case, the iteration count for the closest-point algorithm, the iteration count for the cutting-plane algorithm, the absolute difference of the final $\\mathbb{C}_{22}^{\\mathrm{alg}}$ values, and whether the closest-point algorithm converged in fewer iterations than the cutting-plane algorithm.\n\nUse the following test suite covering a general case, an elastic boundary case, a case without hardening, and a strongly nonlinear hardening, mildly dilatant, non-associative case. All angles are in degrees and all stresses/moduli are in kPa.\n- Case $1$ (general plastic, nonlinear hardening): $K = 50000$, $G = 20000$, $\\varphi = 30$, $\\psi = 10$, $c = 10$, $h = 8000$, $m = 2$, $Q_{\\mathrm{ext}} = 150$.\n- Case $2$ (elastic boundary): $K = 50000$, $G = 20000$, $\\varphi = 30$, $\\psi = 10$, $c = 10$, $h = 8000$, $m = 2$, $Q_{\\mathrm{ext}} = 10$.\n- Case $3$ (no hardening, perfectly plastic): $K = 50000$, $G = 20000$, $\\varphi = 30$, $\\psi = 0$, $c = 10$, $h = 0$, $m = 1$, $Q_{\\mathrm{ext}} = 60$.\n- Case $4$ (non-associative, strong nonlinear hardening): $K = 50000$, $G = 20000$, $\\varphi = 35$, $\\psi = 2$, $c = 5$, $h = 12000$, $m = 2.5$, $Q_{\\mathrm{ext}} = 80$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and must be a list of four entries in the order [iterations_closest_point, iterations_cutting_plane, final_tangent_difference_kPa, closest_point_faster_boolean]. For example, a valid output for two cases would be of the form\n$$\n\\left[ [i_1,j_1,\\Delta_1,b_1],[i_2,j_2,\\Delta_2,b_2] \\right].\n$$",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of computational plasticity, well-posed with all necessary parameters and conditions defined, and objective in its formulation. It presents a standard, albeit challenging, problem in constitutive modeling and nonlinear numerical analysis. A complete solution is therefore provided.\n\nThe core of the problem is to implement and compare two different plastic correction algorithms, Closest-Point Projection (CPP) and Cutting-Plane (CP), within a global Newton-Raphson (N-R) procedure to solve a single-degree-of-freedom equilibrium problem.\n\nLet the state at the beginning of a load increment be $(p_n, q_n, \\kappa_n)$, and the state at the end be $(p, q, \\kappa)$. The problem specifies a single load step from a zero initial state, so $p_n=0$, $q_n=0$, and $\\kappa_n=0$. The kinematic constraint is a pure shear deformation, which, when integrated over the step, gives total strains $\\Delta\\varepsilon_v = 0$ and $\\Delta\\varepsilon_s = u$, where $u$ is the unknown displacement degree of freedom.\n\nThe trial state is purely elastic:\n$$\np^{\\mathrm{tr}} = p_n + K \\Delta\\varepsilon_v = 0 + K(0) = 0\n$$\n$$\nq^{\\mathrm{tr}} = q_n + 3 G \\Delta\\varepsilon_s = 0 + 3G u = 3Gu\n$$\nThe yield function is evaluated at the trial state, using $\\kappa_n=0$:\n$$\nf^{\\mathrm{tr}} = f(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}, \\kappa_n) = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - k(\\kappa_n) = 3Gu - k_0\n$$\nwhere $\\alpha = \\frac{6 \\sin \\varphi}{3 - \\sin \\varphi}$ and $k_0 = \\frac{6 c \\cos \\varphi}{3 - \\sin \\varphi}$.\n\nIf $f^{\\mathrm{tr}} \\le 0$, the step is elastic. The final state is the trial state: $p=0$, $q=3Gu$. The algorithmic shear modulus is the elastic one, $\\mathbb{C}_{22}^{\\mathrm{alg}} = \\frac{\\partial q}{\\partial \\varepsilon_s} = \\frac{\\partial (3Gu)}{\\partial u} = 3G$.\n\nIf $f^{\\mathrm{tr}} > 0$, plastic deformation occurs. The state variables are updated using the plastic multiplier $\\Delta\\lambda \\ge 0$:\n$$\np = p^{\\mathrm{tr}} - K \\Delta\\varepsilon_v^p = 0 - K \\alpha_g \\Delta\\lambda = -K\\alpha_g \\Delta\\lambda\n$$\n$$\nq = q^{\\mathrm{tr}} - 3G \\Delta\\varepsilon_s^p = 3Gu - 3G \\Delta\\lambda\n$$\n$$\n\\kappa = \\kappa_n + \\Delta\\lambda = \\Delta\\lambda\n$$\nwhere $\\alpha_g = \\frac{6 \\sin \\psi}{3 - \\sin \\psi}$. The final state must satisfy the consistency condition $f(p,q,\\kappa)=0$.\n\n**1. Closest-Point Projection (CPP) Algorithm**\n\nThis algorithm enforces the consistency condition exactly. Substituting the updated state variables into the yield function $q + \\alpha p - k(\\kappa) = 0$:\n$$\n(3Gu - 3G\\Delta\\lambda) + \\alpha(-K\\alpha_g\\Delta\\lambda) - (k_0 + h(\\Delta\\lambda)^m) = 0\n$$\nRearranging gives a nonlinear scalar equation for $\\Delta\\lambda$:\n$$\nR(\\Delta\\lambda) = (3G + \\alpha K \\alpha_g)\\Delta\\lambda + h(\\Delta\\lambda)^m - f^{\\mathrm{tr}} = 0\n$$\nThis equation is solved for $\\Delta\\lambda$ using a local Newton-Raphson method: $\\Delta\\lambda_{i+1} = \\Delta\\lambda_i - R(\\Delta\\lambda_i)/R'(\\Delta\\lambda_i)$, where $R'(\\Delta\\lambda) = (3G + \\alpha K \\alpha_g) + hm(\\Delta\\lambda)^{m-1}$.\n\nThe algorithmic tangent modulus $\\mathbb{C}_{22}^{\\mathrm{alg, CPP}} = \\frac{\\partial q}{\\partial u}$ is derived by differentiating the system of equations defining the final state with respect to $u$. Differentiating the consistency condition $q + \\alpha p - k(\\kappa) = 0$ yields:\n$$\n\\frac{\\partial q}{\\partial u} + \\alpha \\frac{\\partial p}{\\partial u} - \\frac{dk}{d\\kappa}\\frac{\\partial \\kappa}{\\partial u} = 0\n$$\nUsing $\\frac{\\partial p}{\\partial u} = -K\\alpha_g \\frac{\\partial\\Delta\\lambda}{\\partial u}$, $\\frac{\\partial q}{\\partial u} = 3G - 3G\\frac{\\partial\\Delta\\lambda}{\\partial u}$, $\\frac{\\partial\\kappa}{\\partial u} = \\frac{\\partial\\Delta\\lambda}{\\partial u}$, and defining the hardening modulus $H_\\kappa = \\frac{dk}{d\\kappa} = hm\\kappa^{m-1} = hm(\\Delta\\lambda)^{m-1}$, we can solve for $\\frac{\\partial\\Delta\\lambda}{\\partial u}$:\n$$\n(3G - 3G\\frac{\\partial\\Delta\\lambda}{\\partial u}) + \\alpha(-K\\alpha_g\\frac{\\partial\\Delta\\lambda}{\\partial u}) - H_\\kappa \\frac{\\partial\\Delta\\lambda}{\\partial u} = 0 \\implies \\frac{\\partial\\Delta\\lambda}{\\partial u} = \\frac{3G}{3G + \\alpha K \\alpha_g + H_\\kappa}\n$$\nSubstituting this back into the expression for $\\frac{\\partial q}{\\partial u}$:\n$$\n\\mathbb{C}_{22}^{\\mathrm{alg, CPP}} = 3G\\left(1 - \\frac{3G}{3G + \\alpha K \\alpha_g + H_\\kappa}\\right) = 3G \\frac{\\alpha K \\alpha_g + H_\\kappa}{3G + \\alpha K \\alpha_g + H_\\kappa}\n$$\nThis is the consistent tangent modulus. Note that it depends on the final state through $H_\\kappa$.\n\n**2. Cutting-Plane (CP) Algorithm**\n\nThis algorithm uses an explicit update for $\\Delta\\lambda$ based on a linearization of the hardening law at the beginning of the step. The hardening modulus is evaluated at $\\kappa_n=0$:\n$$\nH_{\\kappa,n} = \\left. \\frac{dk}{d\\kappa} \\right|_{\\kappa_n=0} = \\begin{cases} h & \\text{if } m=1 \\\\ 0 & \\text{if } m>1 \\end{cases}\n$$\nThe plastic multiplier is then calculated explicitly as:\n$$\n\\Delta\\lambda = \\frac{f^{\\mathrm{tr}}}{3G + \\alpha K \\alpha_g + H_{\\kappa,n}}\n$$\nWith this $\\Delta\\lambda$, the final stress $q = 3Gu - 3G\\Delta\\lambda$ is computed. The resulting state does not in general lie exactly on the yield surface for nonlinear hardening ($m>1$).\n\nThe corresponding algorithmic tangent, $\\mathbb{C}_{22}^{\\mathrm{alg, CP}}$, is the derivative of the stress function $q_{CP}(u)$. Since $\\Delta\\lambda$ is a linear function of $f^{\\mathrm{tr}}$, which is linear in $u$, the entire expression for $q_{CP}(u)$ is linear in $u$ for a plastic step. The derivation of the tangent is analogous to the CPP case, but using the constant initial hardening modulus $H_{\\kappa,n}$ instead of the state-dependent $H_\\kappa$:\n$$\n\\mathbb{C}_{22}^{\\mathrm{alg, CP}} = 3G \\frac{\\alpha K \\alpha_g + H_{\\kappa,n}}{3G + \\alpha K \\alpha_g + H_{\\kappa,n}}\n$$\nThis tangent is constant for all plastic states ($u > k_0/(3G)$).\n\n**3. Global Newton-Raphson Solver**\n\nThe equilibrium equation to solve is $r(u) = q(u) - Q_{\\mathrm{ext}} = 0$. The N-R scheme is:\n$$\nu_{k+1} = u_k - \\frac{r(u_k)}{J(u_k)}\n$$\nwhere $u_k$ is the iterate, $r(u_k) = q(u_k) - Q_{\\mathrm{ext}}$ is the residual, and $J(u_k) = \\frac{\\partial q}{\\partial u}|_{u_k} = \\mathbb{C}_{22}^{\\mathrm{alg}}(u_k)$ is the Jacobian. For each N-R iteration, the constitutive update for the appropriate algorithm (CPP or CP) is called with the current $u_k$ to get the stress $q(u_k)$ and tangent $J(u_k)$.\n\nA special case arises in Case 3 (perfect plasticity, non-dilatant), where $h=0$ and $\\psi=0$ ($\\alpha_g=0$). For a plastic step, both algorithms give an algorithmic tangent $\\mathbb{C}_{22}^{\\mathrm{alg}}=0$. This singularity prevents convergence of the N-R method for loads $Q_{\\mathrm{ext}}$ exceeding the yield strength $k_0$, as the residual cannot be reduced to zero and the update step becomes undefined. The implementation will detect this and terminate, hitting the maximum iteration count.\n\nFor the CP algorithm in this 1D problem, since the plastic response $q_{CP}(u)$ is linear in $u$, the N-R method with the corresponding tangent will converge in exactly two iterations for any plastic case (one elastic guess, one plastic correction yielding the exact solution to the linearized problem).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes test cases and prints the results.\n    \"\"\"\n    test_cases = [\n        # Case 1 (general plastic, nonlinear hardening)\n        {'K': 50000, 'G': 20000, 'phi': 30, 'psi': 10, 'c': 10, 'h': 8000, 'm': 2, 'Q_ext': 150},\n        # Case 2 (elastic boundary)\n        {'K': 50000, 'G': 20000, 'phi': 30, 'psi': 10, 'c': 10, 'h': 8000, 'm': 2, 'Q_ext': 10},\n        # Case 3 (no hardening, perfectly plastic)\n        {'K': 50000, 'G': 20000, 'phi': 30, 'psi': 0, 'c': 10, 'h': 0, 'm': 1, 'Q_ext': 60},\n        # Case 4 (non-associative, strong nonlinear hardening)\n        {'K': 50000, 'G': 20000, 'phi': 35, 'psi': 2, 'c': 5, 'h': 12000, 'm': 2.5, 'Q_ext': 80},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = _solve_for_case(case_params)\n        results.append(str(result))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef _solve_for_case(params):\n    \"\"\"\n    Solves the equilibrium problem for a single set of parameters.\n    \"\"\"\n    K, G, phi_deg, psi_deg, c, h, m, Q_ext = params.values()\n\n    phi = np.deg2rad(phi_deg)\n    psi = np.deg2rad(psi_deg)\n\n    sin_phi, cos_phi = np.sin(phi), np.cos(phi)\n    sin_psi = np.sin(psi)\n    \n    alpha = (6 * sin_phi) / (3 - sin_phi)\n    k0 = (6 * c * cos_phi) / (3 - sin_phi)\n    alpha_g = (6 * sin_psi) / (3 - sin_psi)\n\n    # --- Closest-Point Projection (CPP) Solver ---\n    def constitutive_update_cpp(u):\n        q_tr = 3 * G * u\n        f_tr = q_tr - k0\n        \n        if f_tr <= 1e-12:  # Elastic step\n            return q_tr, 3 * G\n        \n        # Plastic step: local N-R for delta_lambda\n        H_const = 3 * G + alpha * K * alpha_g\n        dl = 0.0\n        for _ in range(50):\n            dl = max(0, dl)\n            R = H_const * dl + h * np.power(dl, m) - f_tr\n            if abs(R) < 1e-12: break\n            \n            H_kappa = h * m * np.power(dl, m - 1) if m > 1 or dl > 0 else (h if m == 1 else 0)\n            R_prime = H_const + H_kappa\n            if abs(R_prime) < 1e-12: break\n            dl -= R / R_prime\n\n        q = q_tr - 3 * G * dl\n        kappa = dl\n        \n        H_kappa_final = h * m * np.power(kappa, m - 1) if m > 1 or kappa > 0 else (h if m == 1 else 0)\n        denominator = H_const + H_kappa_final\n        C22_alg = 3 * G * (alpha * K * alpha_g + H_kappa_final) / denominator if abs(denominator) > 1e-12 else 0.0\n\n        return q, C22_alg\n\n    u_cpp = 0.0\n    iters_cpp = 0\n    for i in range(1, 51):\n        q_cpp, J_cpp = constitutive_update_cpp(u_cpp)\n        r = q_cpp - Q_ext\n        iters_cpp = i\n        if abs(r) < 1e-6: break\n        if abs(J_cpp) < 1e-9:\n            iters_cpp = 50\n            break\n        u_cpp -= r / J_cpp\n    else: iters_cpp = 50\n    _, C22_cpp_final = constitutive_update_cpp(u_cpp)\n\n    # --- Cutting-Plane (CP) Solver ---\n    def constitutive_update_cp(u):\n        q_tr = 3 * G * u\n        f_tr = q_tr - k0\n        \n        if f_tr <= 1e-12:  # Elastic step\n            return q_tr, 3 * G\n\n        H_kappa_n = h if m == 1 else 0.0\n        denominator = 3 * G + alpha * K * alpha_g + H_kappa_n\n        \n        dl = max(0, f_tr / denominator) if abs(denominator) > 1e-12 else (np.inf if f_tr > 0 else 0)\n        q = q_tr - 3 * G * dl\n        \n        C22_alg = 3 * G * (alpha * K * alpha_g + H_kappa_n) / denominator if abs(denominator) > 1e-12 else 0.0\n        return q, C22_alg\n\n    u_cp = 0.0\n    iters_cp = 0\n    for i in range(1, 51):\n        q_cp, J_cp = constitutive_update_cp(u_cp)\n        r = q_cp - Q_ext\n        iters_cp = i\n        if abs(r) < 1e-6: break\n        if abs(J_cp) < 1e-9:\n            iters_cp = 50\n            break\n        u_cp -= r / J_cp\n    else: iters_cp = 50\n    _, C22_cp_final = constitutive_update_cp(u_cp)\n\n    tangent_diff = abs(C22_cpp_final - C22_cp_final)\n    cpp_faster = bool(iters_cpp < iters_cp)\n\n    # Format each result entry to avoid scientific notation for integers\n    return [iters_cpp, iters_cp, tangent_diff, cpp_faster]\n\nsolve()\n```"
        },
        {
            "introduction": "Building on the challenge of non-smooth models, we now investigate the mathematical singularities that arise at the corners of a plastic potential, which can lead to ill-posedness in numerical simulations. This exercise  guides you through a conceptual analysis of a standard regularization technique: smoothing the corners of the plastic potential to ensure a unique plastic flow direction. This practice develops a sophisticated understanding of the interplay between numerical stability, the choice of a non-associated flow rule, and the prediction of physical failure mechanisms such as shear bands.",
            "id": "3534604",
            "problem": "Consider a small-strain, rate-independent elasto-plastic model in plane strain for a geomaterial described by an isotropic linear elastic stiffness tensor $\\mathbf{C}^e$ with bulk modulus $K$ and shear modulus $G$, a Mohr–Coulomb-type yield function $f(\\boldsymbol{\\sigma})=0$, and a non-associative plastic potential $g(\\boldsymbol{\\sigma})$. The plastic flow is governed by the standard normality relation to the plastic potential,\n$$\nd\\boldsymbol{\\varepsilon}^p = \\lambda\\,\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}},\n$$\nwith plastic multiplier $\\lambda\\ge 0$, consistency $df=0$ on the yield surface, and the standard elastoplastic decomposition $d\\boldsymbol{\\varepsilon}=d\\boldsymbol{\\varepsilon}^e+d\\boldsymbol{\\varepsilon}^p$ with $d\\boldsymbol{\\sigma}=\\mathbf{C}^e:(d\\boldsymbol{\\varepsilon}-d\\boldsymbol{\\varepsilon}^p)$.\n\nNon-associative Mohr–Coulomb-type plastic potentials $g(\\boldsymbol{\\sigma})$ are piecewise linear in stress space and possess corners along specific Lode angle directions, which make $\\partial g/\\partial\\boldsymbol{\\sigma}$ set-valued (non-unique) at the corners and can lead to singular consistent tangents and ill-posedness in localization analyses.\n\nTo regularize the corner singularities while preserving the non-associative character, consider a smoothed plastic potential\n$$\ng_\\varepsilon(\\boldsymbol{\\sigma}) \\;=\\; \\sqrt{s(\\boldsymbol{\\sigma})^2+\\varepsilon^2}\\;+\\;\\beta\\,p(\\boldsymbol{\\sigma}),\n$$\nwhere $s(\\boldsymbol{\\sigma})$ is a scalar shear measure chosen so that $g(\\boldsymbol{\\sigma})=|s(\\boldsymbol{\\sigma})|+\\beta p(\\boldsymbol{\\sigma})$ reproduces the original (unsmoothed) non-associative Mohr–Coulomb plastic potential in the stress region under consideration, $p(\\boldsymbol{\\sigma})$ is the mean stress, $\\beta=\\sin\\psi$ with $\\psi$ the dilation angle, and $\\varepsilon>0$ is a smoothing parameter. A specific choice for $s(\\boldsymbol{\\sigma})$ in simple shear or triaxial stress paths is $s(\\boldsymbol{\\sigma})=\\tau_{\\text{eq}}(\\boldsymbol{\\sigma})$, the equivalent shear stress consistent with the active Mohr–Coulomb plane; away from corners $s(\\boldsymbol{\\sigma})$ coincides with the active linear branch of the deviatoric measure.\n\nThe consistent elastoplastic tangent is given by the standard rank-one update\n$$\n\\mathbf{C}^{ep}_\\varepsilon \\;=\\; \\mathbf{C}^e \\;-\\; \\frac{\\mathbf{C}^e:\\mathbf{a}_\\varepsilon\\otimes\\mathbf{b}}{\\mathbf{b}:\\mathbf{C}^e:\\mathbf{a}_\\varepsilon + H}\\,:\\mathbf{C}^e,\n$$\nwhere $\\mathbf{a}_\\varepsilon=\\dfrac{\\partial g_\\varepsilon}{\\partial \\boldsymbol{\\sigma}}$ is the plastic flow direction, $\\mathbf{b}=\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ is the yield normal, and $H$ is the plastic modulus (positive for hardening, zero at perfect plasticity, negative for softening). The acoustic tensor for localization analysis is\n$$\n\\mathbf{Q}_\\varepsilon(\\mathbf{n}) \\;=\\; n_k\\,\\mathbf{C}^{ep}_{\\varepsilon,ikjl}\\,n_l,\n$$\nwith $\\mathbf{n}$ the unit normal to a potential localization band, and the onset condition for a shear band aligned with $\\mathbf{n}$ is $\\det\\mathbf{Q}_\\varepsilon(\\mathbf{n})=0$.\n\nUsing the above, answer the following question, which asks you to demonstrate the regularization provided by the smoothed plastic potential and to assess its effect on computed shear band angles. You should reason from the above elasto-plastic definitions and the structure of the consistent tangent and acoustic tensor, without relying on any shortcut formulas for localization angles.\n\nWhich of the following statements about the smoothed non-associative plastic potential $g_\\varepsilon(\\boldsymbol{\\sigma})$ and the shear band angle predicted by the acoustic tensor criterion is correct?\n\nA. The replacement of $g$ by $g_\\varepsilon=\\sqrt{s^2+\\varepsilon^2}+\\beta p$ makes the plastic flow direction $\\mathbf{a}_\\varepsilon=\\partial g_\\varepsilon/\\partial\\boldsymbol{\\sigma}$ globally Lipschitz in $\\boldsymbol{\\sigma}$, hence $\\mathbf{C}^{ep}_\\varepsilon$ and $\\mathbf{Q}_\\varepsilon(\\mathbf{n})$ are continuous functions of $(\\varepsilon,\\boldsymbol{\\sigma},\\mathbf{n})$. Consequently, the computed shear band angle $\\theta(\\varepsilon)$ varies continuously with $\\varepsilon$ and satisfies $\\lim_{\\varepsilon\\to 0}\\theta(\\varepsilon)=\\theta(0)$ for stress states not exactly on corner rays of the unsmoothed potential.\n\nB. Because the yield surface $f(\\boldsymbol{\\sigma})=0$ is unchanged by smoothing the plastic potential, the acoustic tensor $\\mathbf{Q}_\\varepsilon(\\mathbf{n})$ is identical to the unsmoothed one for all $\\varepsilon>0$, and the shear band angle $\\theta(\\varepsilon)$ is exactly independent of $\\varepsilon$.\n\nC. For any fixed stress state and material parameters, increasing $\\varepsilon$ strictly increases the shear band angle predicted by $\\det\\mathbf{Q}_\\varepsilon(\\mathbf{n})=0$, and this monotonic increase is independent of the dilation angle $\\psi$.\n\nD. As $\\varepsilon\\to 0$, the computed shear band angle $\\theta(\\varepsilon)$ fails to converge; smoothing introduces a persistent numerical artifact that predicts angles unrelated to the non-smoothed model even in the zero-smoothing limit.",
            "solution": "### Step 1: Extract Givens\nThe problem statement provides the following information for a small-strain, rate-independent elasto-plastic model in plane strain for a geomaterial:\n- **Elasticity**: Isotropic linear elastic stiffness tensor $\\mathbf{C}^e$ with bulk modulus $K$ and shear modulus $G$.\n- **Yield Function**: Mohr–Coulomb-type, $f(\\boldsymbol{\\sigma})=0$.\n- **Plastic Potential (Unsmoothed)**: Non-associative, $g(\\boldsymbol{\\sigma})$, which is piecewise linear and can be written as $g(\\boldsymbol{\\sigma})=|s(\\boldsymbol{\\sigma})|+\\beta p(\\boldsymbol{\\sigma})$, where $s(\\boldsymbol{\\sigma})$ is a scalar shear measure, $p(\\boldsymbol{\\sigma})$ is the mean stress, and $\\beta=\\sin\\psi$ with $\\psi$ being the dilation angle.\n- **Plastic Potential (Smoothed)**: $g_\\varepsilon(\\boldsymbol{\\sigma}) = \\sqrt{s(\\boldsymbol{\\sigma})^2+\\varepsilon^2}\\;+\\;\\beta\\,p(\\boldsymbol{\\sigma})$, where $\\varepsilon>0$ is a smoothing parameter.\n- **Flow Rule**: $d\\boldsymbol{\\varepsilon}^p = \\lambda\\,\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$, with plastic multiplier $\\lambda\\ge 0$. For the smoothed case, this becomes $d\\boldsymbol{\\varepsilon}^p = \\lambda\\,\\dfrac{\\partial g_\\varepsilon}{\\partial \\boldsymbol{\\sigma}}$.\n- **Strain Decomposition**: $d\\boldsymbol{\\varepsilon}=d\\boldsymbol{\\varepsilon}^e+d\\boldsymbol{\\varepsilon}^p$.\n- **Stress-Strain Relation**: $d\\boldsymbol{\\sigma}=\\mathbf{C}^e:(d\\boldsymbol{\\varepsilon}-d\\boldsymbol{\\varepsilon}^p)$.\n- **Consistency Condition**: $df=0$ on the yield surface.\n- **Consistent Elastoplastic Tangent**: $\\mathbf{C}^{ep}_\\varepsilon \\;=\\; \\mathbf{C}^e \\;-\\; \\dfrac{\\mathbf{C}^e:\\mathbf{a}_\\varepsilon\\otimes\\mathbf{b}}{\\mathbf{b}:\\mathbf{C}^e:\\mathbf{a}_\\varepsilon + H}\\,:\\mathbf{C}^e$.\n- **Definitions for Tangent**:\n    - Plastic flow direction: $\\mathbf{a}_\\varepsilon=\\dfrac{\\partial g_\\varepsilon}{\\partial \\boldsymbol{\\sigma}}$.\n    - Yield normal: $\\mathbf{b}=\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$.\n    - Plastic modulus: $H$.\n- **Acoustic Tensor**: $\\mathbf{Q}_\\varepsilon(\\mathbf{n}) = n_k\\,\\mathbf{C}^{ep}_{\\varepsilon,ikjl}\\,n_l$, where $\\mathbf{n}$ is the unit normal to a potential localization band.\n- **Localization Condition**: $\\det\\mathbf{Q}_\\varepsilon(\\mathbf{n})=0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation against the specified criteria.\n- **Scientifically Grounded**: The problem is firmly rooted in the established theory of computational plasticity for geomaterials. The concepts of Mohr-Coulomb yield criteria, non-associative flow rules, consistent tangent operators, and acoustic tensor analysis for shear band localization are standard in the field. The use of a smooth hyperbolic function to regularize corner singularities in the plastic potential is a well-known and mathematically sound technique. The formulation is physically and mathematically consistent with continuum mechanics principles.\n- **Well-Posed**: The problem is well-posed. It presents a clear theoretical question about the properties of a regularization scheme. All necessary mathematical definitions are provided to analyze the behavior of the system as the smoothing parameter $\\varepsilon$ is varied.\n- **Objective**: The language is precise, technical, and devoid of subjective or ambiguous statements. The problem asks for a logical deduction based on the provided mathematical framework.\n\nAll checklist items for invalidity are passed:\n1.  **Scientific/Factual Unsoundness**: None. The model is standard.\n2.  **Non-Formalizable/Irrelevant**: None. The problem is formal and directly relevant to the topic.\n3.  **Incomplete/Contradictory Setup**: None. The setup is self-contained.\n4.  **Unrealistic/Infeasible**: None. The model is a common idealization used in engineering practice.\n5.  **Ill-Posed/Poorly Structured**: None. The question is structured to have a single correct deductive answer.\n6.  **Pseudo-Profound/Trivial**: None. The question requires a non-trivial understanding of constitutive modeling and stability analysis.\n7.  **Outside Scientific Verifiability**: None. The statements can be verified through mathematical analysis of the provided equations.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived.\n\n### Derivation and Analysis\nThe question requires an analysis of the effect of the smoothing parameter $\\varepsilon$ on the properties of the plastic flow and the resulting shear band angle prediction.\n\n1.  **Analysis of the Plastic Flow Direction $\\mathbf{a}_\\varepsilon$**:\n    The smoothed plastic potential is given by $g_\\varepsilon(\\boldsymbol{\\sigma}) = \\sqrt{s(\\boldsymbol{\\sigma})^2+\\varepsilon^2}\\;+\\;\\beta\\,p(\\boldsymbol{\\sigma})$.\n    The plastic flow direction $\\mathbf{a}_\\varepsilon$ is its gradient with respect to stress $\\boldsymbol{\\sigma}$:\n    $$\n    \\mathbf{a}_\\varepsilon = \\frac{\\partial g_\\varepsilon}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}} \\left( \\sqrt{s(\\boldsymbol{\\sigma})^2+\\varepsilon^2} \\right) + \\beta \\frac{\\partial p(\\boldsymbol{\\sigma})}{\\partial \\boldsymbol{\\sigma}}\n    $$\n    Applying the chain rule to the first term yields:\n    $$\n    \\mathbf{a}_\\varepsilon = \\frac{1}{2\\sqrt{s^2+\\varepsilon^2}} (2s) \\frac{\\partial s}{\\partial \\boldsymbol{\\sigma}} + \\beta \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{s(\\boldsymbol{\\sigma})}{\\sqrt{s(\\boldsymbol{\\sigma})^2+\\varepsilon^2}} \\frac{\\partial s}{\\partial \\boldsymbol{\\sigma}} + \\beta \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}}\n    $$\n    The problem notes that the unsmoothed potential $g$ has corners where its gradient $\\partial g/\\partial\\boldsymbol{\\sigma}$ is non-unique (set-valued). These corners correspond to stress states where $s(\\boldsymbol{\\sigma})=0$. For the unsmoothed potential $g = |s| + \\beta p$, the gradient involves the term $\\text{sgn}(s) = \\partial|s|/\\partial s$, which is discontinuous at $s=0$.\n\n    For the smoothed potential $g_\\varepsilon$, the term replacing $\\text{sgn}(s)$ is $s/\\sqrt{s^2+\\varepsilon^2}$. For any $\\varepsilon>0$, the denominator $\\sqrt{s^2+\\varepsilon^2}$ is always strictly positive. The function $h(s) = s/\\sqrt{s^2+\\varepsilon^2}$ is continuously differentiable with respect to $s$. Its derivative is $h'(s) = \\varepsilon^2 / (s^2+\\varepsilon^2)^{3/2}$. For any fixed $\\varepsilon>0$, this derivative is bounded for all $s$, with a maximum value of $1/\\varepsilon$ at $s=0$. This implies that the function $h(s)$ is Lipschitz continuous. Since the other terms in the expression for $\\mathbf{a}_\\varepsilon$ (like $\\partial s/\\partial \\boldsymbol{\\sigma}$ and $\\partial p/\\partial \\boldsymbol{\\sigma}$) are piecewise smooth, the resulting flow direction $\\mathbf{a}_\\varepsilon$ is a globally Lipschitz continuous function of the stress $\\boldsymbol{\\sigma}$. This regularization removes the non-uniqueness of the flow direction at the corners.\n\n2.  **Continuity of Dependent Quantities**:\n    The consistent tangent $\\mathbf{C}^{ep}_\\varepsilon$ is constructed from $\\mathbf{C}^e$, $\\mathbf{a}_\\varepsilon$, $\\mathbf{b}$, and $H$. Since $\\mathbf{a}_\\varepsilon$ is a continuous function of $\\boldsymbol{\\sigma}$ and $\\varepsilon$ (for $\\varepsilon>0$), and all other components are independent of them or continuous, $\\mathbf{C}^{ep}_\\varepsilon$ is also a continuous function of $\\boldsymbol{\\sigma}$ and $\\varepsilon$, assuming the denominator $\\mathbf{b}:\\mathbf{C}^e:\\mathbf{a}_\\varepsilon + H \\neq 0$ (a condition for material stability).\n    The acoustic tensor $\\mathbf{Q}_\\varepsilon(\\mathbf{n}) = n_k\\,\\mathbf{C}^{ep}_{\\varepsilon,ikjl}\\,n_l$ is a linear mapping of $\\mathbf{C}^{ep}_\\varepsilon$. Therefore, $\\mathbf{Q}_\\varepsilon(\\mathbf{n})$ is also a continuous function of its arguments $(\\varepsilon, \\boldsymbol{\\sigma}, \\mathbf{n})$.\n\n3.  **Behavior of the Shear Band Angle $\\theta(\\varepsilon)$**:\n    The shear band angle $\\theta$ is determined by the condition $\\det \\mathbf{Q}_\\varepsilon(\\mathbf{n}(\\theta)) = 0$. Since $\\mathbf{Q}_\\varepsilon$ is a continuous function of $\\varepsilon$, its determinant is also a continuous function of $\\varepsilon$. The solution $\\theta(\\varepsilon)$ to this equation will therefore vary continuously with $\\varepsilon$, according to the Implicit Function Theorem (assuming non-degeneracy).\n\n4.  **Limit as $\\varepsilon \\to 0$**:\n    Let us examine the behavior of $\\mathbf{a}_\\varepsilon$ as $\\varepsilon \\to 0$:\n    $$\n    \\lim_{\\varepsilon\\to 0} \\mathbf{a}_\\varepsilon = \\lim_{\\varepsilon\\to 0} \\left( \\frac{s}{\\sqrt{s^2+\\varepsilon^2}} \\frac{\\partial s}{\\partial \\boldsymbol{\\sigma}} + \\beta \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} \\right)\n    $$\n    If the stress state is not on a corner, then $s(\\boldsymbol{\\sigma}) \\neq 0$. In this case:\n    $$\n    \\lim_{\\varepsilon\\to 0} \\frac{s}{\\sqrt{s^2+\\varepsilon^2}} = \\frac{s}{\\sqrt{s^2}} = \\frac{s}{|s|} = \\text{sgn}(s)\n    $$\n    The limit of the flow direction is therefore:\n    $$\n    \\lim_{\\varepsilon\\to 0} \\mathbf{a}_\\varepsilon = \\text{sgn}(s) \\frac{\\partial s}{\\partial \\boldsymbol{\\sigma}} + \\beta \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}} (|s| + \\beta p) = \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\mathbf{a}\n    $$\n    This shows that for stress states away from the corners of the original yield surface, the smoothed flow direction $\\mathbf{a}_\\varepsilon$ converges to the unsmoothed flow direction $\\mathbf{a}$. Consequently, $\\mathbf{C}^{ep}_\\varepsilon$ converges to the unsmoothed tangent $\\mathbf{C}^{ep}$, $\\mathbf{Q}_\\varepsilon(\\mathbf{n})$ converges to $\\mathbf{Q}(\\mathbf{n})$, and the predicted shear band angle $\\theta(\\varepsilon)$ converges to the unsmoothed angle $\\theta(0)$. That is, $\\lim_{\\varepsilon\\to 0}\\theta(\\varepsilon)=\\theta(0)$. The regularization is consistent.\n\n### Option-by-Option Analysis\n\n**A. The replacement of $g$ by $g_\\varepsilon=\\sqrt{s^2+\\varepsilon^2}+\\beta p$ makes the plastic flow direction $\\mathbf{a}_\\varepsilon=\\partial g_\\varepsilon/\\partial\\boldsymbol{\\sigma}$ globally Lipschitz in $\\boldsymbol{\\sigma}$, hence $\\mathbf{C}^{ep}_\\varepsilon$ and $\\mathbf{Q}_\\varepsilon(\\mathbf{n})$ are continuous functions of $(\\varepsilon,\\boldsymbol{\\sigma},\\mathbf{n})$. Consequently, the computed shear band angle $\\theta(\\varepsilon)$ varies continuously with $\\varepsilon$ and satisfies $\\lim_{\\varepsilon\\to 0}\\theta(\\varepsilon)=\\theta(0)$ for stress states not exactly on corner rays of the unsmoothed potential.**\n- As derived above, the smoothing makes $\\mathbf{a}_\\varepsilon$ Lipschitz continuous. This continuity propagates to $\\mathbf{C}^{ep}_\\varepsilon$ and $\\mathbf{Q}_\\varepsilon(\\mathbf{n})$. The continuity of the acoustic tensor implies that the solution angle $\\theta(\\varepsilon)$ varies continuously. Furthermore, the analysis of the limit $\\varepsilon \\to 0$ confirms that the regularized solution converges to the original solution for any stress state not on a corner singularity. This statement is a complete and accurate description of the regularization's properties.\n- **Verdict: Correct.**\n\n**B. Because the yield surface $f(\\boldsymbol{\\sigma})=0$ is unchanged by smoothing the plastic potential, the acoustic tensor $\\mathbf{Q}_\\varepsilon(\\mathbf{n})$ is identical to the unsmoothed one for all $\\varepsilon>0$, and the shear band angle $\\theta(\\varepsilon)$ is exactly independent of $\\varepsilon$.**\n- The premise that the yield surface $f(\\boldsymbol{\\sigma})=0$ is unchanged is correct. However, the conclusion is false. The acoustic tensor depends on the consistent tangent $\\mathbf{C}^{ep}_\\varepsilon$, which in turn depends on the plastic flow direction $\\mathbf{a}_\\varepsilon = \\partial g_\\varepsilon / \\partial \\boldsymbol{\\sigma}$. Since $g_\\varepsilon$ is different from $g$, $\\mathbf{a}_\\varepsilon$ is different from the unsmoothed flow direction $\\mathbf{a}$ for any $\\varepsilon > 0$. Therefore, $\\mathbf{Q}_\\varepsilon(\\mathbf{n})$ is not identical to the unsmoothed one, and the shear band angle $\\theta(\\varepsilon)$ will depend on $\\varepsilon$. This statement fundamentally misunderstands non-associative plasticity, where $\\mathbf{a} \\neq \\mathbf{b}$.\n- **Verdict: Incorrect.**\n\n**C. For any fixed stress state and material parameters, increasing $\\varepsilon$ strictly increases the shear band angle predicted by $\\det\\mathbf{Q}_\\varepsilon(\\mathbf{n})=0$, and this monotonic increase is independent of the dilation angle $\\psi$.**\n- This statement makes two strong claims. First, it claims strict monotonic behavior of $\\theta(\\varepsilon)$. While increasing $\\varepsilon$ does change $\\mathbf{a}_\\varepsilon$ in a predictable way (it damps the deviatoric component of plastic flow), the effect on the shear band angle, which arises from the complex tensorial expression $\\det \\mathbf{Q}_\\varepsilon = 0$, is not guaranteed to be monotonic for all stress states and material parameters. Second, it claims independence from the dilation angle $\\psi$. This is demonstrably false. The flow direction $\\mathbf{a}_\\varepsilon$ explicitly contains the term $\\beta \\partial p / \\partial \\boldsymbol{\\sigma}$, where $\\beta = \\sin\\psi$. Since $\\psi$ directly influences the plastic flow direction, it will influence the tangent, the acoustic tensor, and the resulting shear band angle.\n- **Verdict: Incorrect.**\n\n**D. As $\\varepsilon\\to 0$, the computed shear band angle $\\theta(\\varepsilon)$ fails to converge; smoothing introduces a persistent numerical artifact that predicts angles unrelated to the non-smoothed model even in the zero-smoothing limit.**\n- This statement contradicts the purpose and property of a consistent regularization scheme. As shown in the derivation for option A, for any stress state not at a corner ($s \\neq 0$), the smoothed quantities ($\\mathbf{a}_\\varepsilon$, $\\mathbf{C}^{ep}_\\varepsilon$, $\\mathbf{Q}_\\varepsilon$) converge to their unsmoothed counterparts as $\\varepsilon \\to 0$. This ensures that the computed angle $\\theta(\\varepsilon)$ converges to the correct angle $\\theta(0)$ predicted by the unsmoothed model. The statement that it fails to converge and produces an artifact is incorrect. The goal of smoothing is specifically to create a model that is well-behaved for $\\varepsilon>0$ but recovers the original model as $\\varepsilon \\to 0$.\n- **Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}