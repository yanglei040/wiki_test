{
    "hands_on_practices": [
        {
            "introduction": "To effectively build global systems of equations, we must first understand the origin of their fundamental components: the element stiffness matrix and load vector. This practice takes you back to first principles, guiding you through the derivation of these components for a simple one-dimensional bar element. By starting from the Principle of Virtual Work and using linear shape functions, you will see how physical laws and mathematical approximations translate directly into the matrices that form the building blocks of any finite element model .",
            "id": "3501532",
            "problem": "Consider a two-node linear finite element in one-dimensional axial deformation of a prismatic bar segment. The bar segment has constant Young's modulus $E$, constant cross-sectional area $A$, and length $L$. Let the axial displacement field be $u(x)$ along the bar axis $x \\in [0,L]$. A uniform body force per unit volume $b$ acts along the positive axial direction. At the right end $x=L$, a prescribed outward axial traction $\\bar{t}$ (with units of stress) acts on the end cross-section, while no external traction acts at $x=0$. Assume small strains and linear elasticity, with stress $\\sigma = E \\,\\varepsilon$ and axial strain $\\varepsilon = du/dx$.\n\nStarting from the strong form of linear momentum balance in one dimension and the Principle of Virtual Work, derive the consistent two-by-two element stiffness matrix $K_{e}$ and the consistent two-component element external force vector $f_{\\mathrm{ext},e}$ using exact integration over the element domain and boundary. Use a standard two-node isoparametric linear interpolation for $u(x)$ and its virtual variation over the parent domain, but perform all integrations exactly in the physical coordinate $x$.\n\nThen, using your derived $K_{e}$ and $f_{\\mathrm{ext},e}$, write the element potential energy functional\n$$\n\\Pi_{e}(u_{1},u_{2}) \\;=\\; \\tfrac{1}{2}\\, \\begin{bmatrix} u_{1} & u_{2} \\end{bmatrix} K_{e} \\begin{bmatrix} u_{1} \\\\ u_{2} \\end{bmatrix} \\;-\\; \\begin{bmatrix} u_{1} & u_{2} \\end{bmatrix} f_{\\mathrm{ext},e},\n$$\nas a closed-form analytic expression in terms of $E$, $A$, $L$, $b$, $\\bar{t}$, $u_{1}$, and $u_{2}$.\n\nYour final answer must be a single closed-form analytic expression for $\\Pi_{e}(u_{1},u_{2})$. Do not provide intermediate matrices or vectors as the final answer. No numerical evaluation is required. Express your final answer without units.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, complete, and mathematically verifiable. It represents a standard derivation within the finite element method for linear elastostatics. All provided data and definitions ($E$, $A$, $L$, $b$, $\\bar{t}$) are consistent and sufficient for the derivation of the requested potential energy functional. There are no contradictions, ambiguities, or violations of physical principles.\n\nWe begin with the principle of virtual work (PVW) for a one-dimensional elastic body, which equates the internal virtual work to the external virtual work. For the given element of volume $V_e$ and boundary surface $\\partial V_e$, the PVW is:\n$$\n\\int_{V_e} \\delta\\varepsilon \\, \\sigma \\, \\mathrm{d}V = \\int_{V_e} \\delta u \\, b \\, \\mathrm{d}V + \\int_{\\partial V_e} \\delta u \\, t \\, \\mathrm{d}S\n$$\nwhere $\\sigma$ is the axial stress, $\\varepsilon$ is the axial strain, $\\delta\\varepsilon$ and $\\delta u$ are the virtual strain and virtual displacement, respectively, $b$ is the body force per unit volume, and $t$ is the surface traction.\n\nFor the one-dimensional prismatic bar of length $L$ and constant cross-section $A$, this simplifies. We use the physical coordinate $x$ from $0$ to $L$. The volume element is $\\mathrm{d}V = A \\, \\mathrm{d}x$. The PVW becomes:\n$$\n\\int_0^L \\delta\\varepsilon(x) \\, \\sigma(x) \\, A \\, \\mathrm{d}x = \\int_0^L \\delta u(x) \\, b \\, A \\, \\mathrm{d}x + \\left[ \\delta u(x) \\, t(x) \\, A \\right]_{x=0}^{x=L}\n$$\nThe problem specifies a prescribed outward traction $\\bar{t}$ at $x=L$ and no external traction at $x=0$. Thus, $t(L) = \\bar{t}$ and the traction force from the external world at $x=0$ is zero. The boundary term becomes $A \\, \\bar{t} \\, \\delta u(L)$. Using the linear constitutive law $\\sigma = E\\varepsilon$, the PVW is:\n$$\n\\int_0^L \\delta\\varepsilon \\, A E \\varepsilon \\, \\mathrm{d}x = \\int_0^L \\delta u \\, A b \\, \\mathrm{d}x + A \\bar{t} \\, \\delta u(L)\n$$\nNext, we introduce the finite element approximation for the displacement field $u(x)$ and its variation $\\delta u(x)$ over the two-node element. The nodes are at $x_1=0$ and $x_2=L$, with corresponding nodal displacements $u_1$ and $u_2$. The linear interpolation is given by:\n$$\nu(x) = N_1(x) u_1 + N_2(x) u_2\n$$\nwhere $N_1(x)$ and $N_2(x)$ are the linear shape functions. These must satisfy $N_1(0)=1$, $N_1(L)=0$, $N_2(0)=0$, and $N_2(L)=1$. The unique linear functions are:\n$$\nN_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L}\n$$\nIn matrix notation, $u(x) = \\mathbf{N}(x) \\mathbf{u}_e$, where $\\mathbf{N}(x) = \\begin{bmatrix} N_1(x) & N_2(x) \\end{bmatrix}$ and $\\mathbf{u}_e = \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix}$. The virtual displacement follows the same interpolation: $\\delta u(x) = \\mathbf{N}(x) \\delta\\mathbf{u}_e$.\n\nThe strain $\\varepsilon = \\mathrm{d}u/\\mathrm{d}x$ is found by differentiating the shape functions:\n$$\n\\varepsilon(x) = \\frac{\\mathrm{d}N_1}{\\mathrm{d}x} u_1 + \\frac{\\mathrm{d}N_2}{\\mathrm{d}x} u_2 = \\left(-\\frac{1}{L}\\right) u_1 + \\left(\\frac{1}{L}\\right) u_2 = \\frac{u_2 - u_1}{L}\n$$\nIn matrix form, $\\varepsilon(x) = \\mathbf{B} \\mathbf{u}_e$, where the strain-displacement matrix $\\mathbf{B}$ is:\n$$\n\\mathbf{B} = \\begin{bmatrix} \\frac{\\mathrm{d}N_1}{\\mathrm{d}x} & \\frac{\\mathrm{d}N_2}{\\mathrm{d}x} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{L} & \\frac{1}{L} \\end{bmatrix}\n$$\nThe virtual strain is $\\delta\\varepsilon = \\mathbf{B} \\delta\\mathbf{u}_e$. Substituting these discretizations into the PVW:\n$$\n\\int_0^L (\\mathbf{B} \\delta\\mathbf{u}_e)^T A E (\\mathbf{B} \\mathbf{u}_e) \\, \\mathrm{d}x = \\int_0^L (\\mathbf{N} \\delta\\mathbf{u}_e)^T A b \\, \\mathrm{d}x + (\\mathbf{N}(L) \\delta\\mathbf{u}_e)^T A \\bar{t}\n$$\nUsing matrix transpose properties and factoring out the constant nodal displacement vectors $\\mathbf{u}_e$ and $\\delta\\mathbf{u}_e$:\n$$\n\\delta\\mathbf{u}_e^T \\left( \\int_0^L \\mathbf{B}^T A E \\mathbf{B} \\, \\mathrm{d}x \\right) \\mathbf{u}_e = \\delta\\mathbf{u}_e^T \\left( \\int_0^L \\mathbf{N}^T A b \\, \\mathrm{d}x + \\mathbf{N}(L)^T A \\bar{t} \\right)\n$$\nSince this must hold for any arbitrary $\\delta\\mathbf{u}_e$, we obtain the element system of equations $K_e \\mathbf{u}_e = \\mathbf{f}_{\\mathrm{ext},e}$, where:\n$$\nK_e = \\int_0^L A E \\mathbf{B}^T \\mathbf{B} \\, \\mathrm{d}x \\quad \\text{and} \\quad \\mathbf{f}_{\\mathrm{ext},e} = \\int_0^L A b \\mathbf{N}^T \\, \\mathrm{d}x + A \\bar{t} \\mathbf{N}(L)^T\n$$\nWe now compute these integrals exactly. For the stiffness matrix $K_e$:\n$$\n\\mathbf{B}^T \\mathbf{B} = \\begin{bmatrix} -1/L \\\\ 1/L \\end{bmatrix} \\begin{bmatrix} -1/L & 1/L \\end{bmatrix} = \\frac{1}{L^2} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}\n$$\nSince $A$, $E$, $L$ are constants, the integrand is constant:\n$$\nK_e = A E \\left( \\frac{1}{L^2} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} \\right) \\int_0^L \\mathrm{d}x = \\frac{AE}{L^2} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} L = \\frac{AE}{L} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}\n$$\nFor the external force vector $\\mathbf{f}_{\\mathrm{ext},e}$, we compute the body force and traction components.\nThe body force vector $\\mathbf{f}_{b,e}$ is:\n$$\n\\mathbf{f}_{b,e} = \\int_0^L A b \\mathbf{N}^T \\, \\mathrm{d}x = A b \\int_0^L \\begin{bmatrix} 1 - x/L \\\\ x/L \\end{bmatrix} \\mathrm{d}x = Ab \\begin{bmatrix} [x - x^2/(2L)]_0^L \\\\ [x^2/(2L)]_0^L \\end{bmatrix} = Ab \\begin{bmatrix} L - L/2 \\\\ L/2 \\end{bmatrix} = \\frac{ALb}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\nThe traction force vector $\\mathbf{f}_{t,e}$ is:\n$$\n\\mathbf{f}_{t,e} = A \\bar{t} \\mathbf{N}(L)^T = A \\bar{t} \\begin{bmatrix} N_1(L) \\\\ N_2(L) \\end{bmatrix} = A \\bar{t} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\nThe total external force vector is the sum:\n$$\n\\mathbf{f}_{\\mathrm{ext},e} = \\mathbf{f}_{b,e} + \\mathbf{f}_{t,e} = \\begin{bmatrix} \\frac{ALb}{2} \\\\ \\frac{ALb}{2} + A\\bar{t} \\end{bmatrix}\n$$\nFinally, we assemble the element potential energy functional $\\Pi_{e}(u_{1},u_{2})$, which is given by:\n$$\n\\Pi_{e}(u_{1},u_{2}) = \\frac{1}{2} \\mathbf{u}_e^T K_e \\mathbf{u}_e - \\mathbf{u}_e^T \\mathbf{f}_{\\mathrm{ext},e}\n$$\nSubstituting the derived matrices and vectors:\n$$\n\\Pi_{e}(u_1, u_2) = \\frac{1}{2} \\begin{bmatrix} u_1 & u_2 \\end{bmatrix} \\left( \\frac{AE}{L} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} \\right) \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix} - \\begin{bmatrix} u_1 & u_2 \\end{bmatrix} \\begin{bmatrix} \\frac{ALb}{2} \\\\ \\frac{ALb}{2} + A\\bar{t} \\end{bmatrix}\n$$\nWe evaluate the two terms separately. The first term (strain energy) is:\n$$\n\\frac{1}{2} \\mathbf{u}_e^T K_e \\mathbf{u}_e = \\frac{1}{2} \\frac{AE}{L} \\begin{bmatrix} u_1 & u_2 \\end{bmatrix} \\begin{bmatrix} u_1 - u_2 \\\\ -u_1 + u_2 \\end{bmatrix} = \\frac{AE}{2L} (u_1(u_1 - u_2) + u_2(-u_1 + u_2)) = \\frac{AE}{2L} (u_1^2 - 2u_1u_2 + u_2^2) = \\frac{AE}{2L}(u_2 - u_1)^2\n$$\nThe second term (work potential of external forces) is:\n$$\n\\mathbf{u}_e^T \\mathbf{f}_{\\mathrm{ext},e} = u_1\\left(\\frac{ALb}{2}\\right) + u_2\\left(\\frac{ALb}{2} + A\\bar{t}\\right)\n$$\nCombining these results gives the final closed-form expression for the element potential energy:\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_2-u_1)^2 - \\left[ u_1 \\frac{ALb}{2} + u_2 \\left(\\frac{ALb}{2} + A\\bar{t}\\right) \\right]\n$$\nThis expression can be rewritten by distributing the terms:\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_2-u_1)^2 - \\frac{ALb}{2}(u_1+u_2) - A\\bar{t}u_2\n$$\nBoth forms are equivalent. The first form highlights the contribution from the derived force vector. We will present the final answer in expanded form for clarity.\n$$\n\\Pi_e(u_1, u_2) = \\frac{AE}{2L}(u_1^2 - 2 u_1 u_2 + u_2^2) - \\frac{ALb}{2}u_1 - \\left(\\frac{ALb}{2} + A\\bar{t}\\right)u_2\n$$",
            "answer": "$$\n\\boxed{\\frac{AE}{2L}(u_2 - u_1)^2 - \\frac{ALb}{2}(u_1 + u_2) - A\\bar{t}u_2}\n$$"
        },
        {
            "introduction": "Once the element matrices are computed, the core of the assembly process lies in correctly placing their contributions into a single global system. This procedure, often called a \"scatter-add\" operation, is governed by the mesh connectivity that maps local element degrees of freedom (DOFs) to the global DOF numbering. This exercise  isolates this crucial algorithmic step by providing pre-calculated element matrices, allowing you to focus entirely on mastering the mapping and summation process that is central to every finite element program.",
            "id": "3501567",
            "problem": "Consider a quasi-static small-strain linear elasticity problem in two spatial dimensions governed by the balance of linear momentum and the constitutive law for a linear elastic solid. The global linear system arises from the Galerkin weak form, where the element stiffness matrix is defined by the bilinear form involving the kinematic matrix and the elasticity tensor, and the element load vector is defined by the linear form involving the body force. The Finite Element Method (FEM) assembles the global stiffness matrix and load vector by summing contributions from each element via a scatter-add procedure based on the mesh connectivity.\n\nA small mesh consists of $4$ nodes connected by $2$ three-node triangular elements. Each node carries $2$ displacement degrees of freedom (DOF), the horizontal displacement $u_{x}$ and the vertical displacement $u_{y}$. The global DOFs are numbered so that node $i$ corresponds to global DOFs $\\left(2i-1,\\,2i\\right)$. The elements share an edge, with the following nodal connectivity:\n- Element $1$: nodes $\\left(1,\\,2,\\,3\\right)$,\n- Element $2$: nodes $\\left(2,\\,4,\\,3\\right)$.\n\nThe local DOF ordering for each element is $\\left(u_{x}(n_{1}),\\,u_{y}(n_{1}),\\,u_{x}(n_{2}),\\,u_{y}(n_{2}),\\,u_{x}(n_{3}),\\,u_{y}(n_{3})\\right)$, where $\\left(n_{1},\\,n_{2},\\,n_{3}\\right)$ are the element’s node labels.\n\nYou are given the following element stiffness matrices and element load vectors, already evaluated through appropriate numerical quadrature of the weak form integrals:\n$$\n\\mathbf{K}^{(1)} \\;=\\;\n\\begin{pmatrix}\n6 & 0 & -3 & 0 & -3 & 0 \\\\\n0 & 6 & 0 & -3 & 0 & -3 \\\\\n-3 & 0 & 6 & 0 & -3 & 0 \\\\\n0 & -3 & 0 & 6 & 0 & -3 \\\\\n-3 & 0 & -3 & 0 & 6 & 0 \\\\\n0 & -3 & 0 & -3 & 0 & 6\n\\end{pmatrix},\n\\quad\n\\mathbf{f}^{(1)} \\;=\\;\n\\begin{pmatrix}\n2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ 3 \\\\ 2\n\\end{pmatrix},\n$$\n$$\n\\mathbf{K}^{(2)} \\;=\\;\n\\begin{pmatrix}\n7 & 0 & -2 & 0 & -5 & 0 \\\\\n0 & 7 & 0 & -2 & 0 & -5 \\\\\n-2 & 0 & 5 & 0 & -3 & 0 \\\\\n0 & -2 & 0 & 5 & 0 & -3 \\\\\n-5 & 0 & -3 & 0 & 8 & 0 \\\\\n0 & -5 & 0 & -3 & 0 & 8\n\\end{pmatrix},\n\\quad\n\\mathbf{f}^{(2)} \\;=\\;\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ -2 \\\\ 1 \\\\ 4 \\\\ -1\n\\end{pmatrix}.\n$$\n\nPerform the assembly of the global stiffness matrix $\\mathbf{K}$ of size $8 \\times 8$ and the global load vector $\\mathbf{f}$ of size $8$ by scatter-adding the element contributions according to the connectivity and DOF ordering provided. As part of your work, verify the row and column index pairs that define the nonzero pattern induced by each element’s connectivity and confirm the symmetry of the global stiffness matrix. Then, determine the single global stiffness entry $K_{7,5}$.\n\nReport only the numerical value of $K_{7,5}$ obtained after assembly. Express your final answer in kilo-Newton per meter (kN/m). No rounding is required; provide the exact value.",
            "solution": "The problem requires the assembly of a global stiffness matrix, $\\mathbf{K}$, from element stiffness matrices, $\\mathbf{K}^{(e)}$, in the context of the Finite Element Method (FEM) for a two-dimensional linear elasticity problem. The specific task is to determine the value of the entry $K_{7,5}$ of the global matrix.\n\nThe assembly process is based on the principle of superposition. The global stiffness matrix $\\mathbf{K}$ is initialized as a zero matrix of the appropriate size. Then, for each element $e$, its local stiffness matrix $\\mathbf{K}^{(e)}$ is added to the corresponding entries in the global matrix. The mapping between local and global degrees of freedom (DOFs) dictates where each entry of $\\mathbf{K}^{(e)}$ is placed. The value of a global entry $K_{I,J}$ is the sum of contributions from all elements that are connected to both global DOF $I$ and global DOF $J$.\n$$ K_{I,J} = \\sum_{e} K_{g^{(e)}(i), g^{(e)}(j)}^{(e)} = \\sum_{e} K_{i,j}^{(e)} \\quad \\text{where } I=g^{(e)}(i) \\text{ and } J=g^{(e)}(j) $$\nHere, $g^{(e)}$ is the local-to-global DOF mapping vector for element $e$.\n\nFirst, we must establish the local-to-global DOF mapping for each of the two elements. The problem states that there are $4$ nodes in total, and each node has $2$ DOFs ($u_x, u_y$). The global DOFs for node $i$ are given by $(2i-1, 2i)$.\n- Node $1$: Global DOFs $(1, 2)$.\n- Node $2$: Global DOFs $(3, 4)$.\n- Node $3$: Global DOFs $(5, 6)$.\n- Node $4$: Global DOFs $(7, 8)$.\nThe total number of global DOFs is $2 \\times 4 = 8$, so the global stiffness matrix $\\mathbf{K}$ is of size $8 \\times 8$.\n\nThe local DOF ordering for a three-node element with nodes $(n_1, n_2, n_3)$ is given as $\\left(u_{x}(n_{1}),\\,u_{y}(n_{1}),\\,u_{x}(n_{2}),\\,u_{y}(n_{2}),\\,u_{x}(n_{3}),\\,u_{y}(n_{3})\\right)$, which correspond to local DOF indices $(1, 2, 3, 4, 5, 6)$.\n\nFor Element $1$, the connectivity is given as nodes $(1, 2, 3)$.\n- Local DOFs $1, 2$ (from node $1$) map to global DOFs $1, 2$.\n- Local DOFs $3, 4$ (from node $2$) map to global DOFs $3, 4$.\n- Local DOFs $5, 6$ (from node $3$) map to global DOFs $5, 6$.\nThe local-to-global mapping vector for Element $1$ is $g^{(1)} = (1, 2, 3, 4, 5, 6)$.\n\nFor Element $2$, the connectivity is given as nodes $(2, 4, 3)$.\n- Local DOFs $1, 2$ (from node $2$) map to global DOFs $3, 4$.\n- Local DOFs $3, 4$ (from node $4$) map to global DOFs $7, 8$.\n- Local DOFs $5, 6$ (from node $3$) map to global DOFs $5, 6$.\nThe local-to-global mapping vector for Element $2$ is $g^{(2)} = (3, 4, 7, 8, 5, 6)$.\n\nWe need to find the value of the global stiffness entry $K_{7,5}$. This is the sum of contributions from both elements:\n$$ K_{7,5} = K_{7,5}^{\\text{from (1)}} + K_{7,5}^{\\text{from (2)}} $$\n\nContribution from Element $1$:\nThe global DOFs associated with Element $1$ are $(1, 2, 3, 4, 5, 6)$ according to its mapping vector $g^{(1)}$. The global DOF $7$ is not associated with Element $1$. Therefore, Element $1$ makes no contribution to any entry in the $7$-th row or $7$-th column of the global matrix $\\mathbf{K}$.\n$$ K_{7,5}^{\\text{from (1)}} = 0 $$\n\nContribution from Element $2$:\nThe global DOFs associated with Element $2$ are $(3, 4, 7, 8, 5, 6)$ according to its mapping vector $g^{(2)}$. To find the contribution to $K_{7,5}$, we must identify the local indices $i$ and $j$ in Element $2$ that correspond to the global indices $I=7$ and $J=5$.\n- For the global row index $I=7$, we search for $7$ in the mapping vector $g^{(2)} = (3, 4, 7, 8, 5, 6)$. It is the $3$-rd entry. Thus, the local row index is $i=3$.\n- For the global column index $J=5$, we search for $5$ in the mapping vector $g^{(2)}$. It is the $5$-th entry. Thus, the local column index is $j=5$.\nThe contribution from Element $2$ is the entry $K_{i,j}^{(2)} = K_{3,5}^{(2)}$ from the element stiffness matrix $\\mathbf{K}^{(2)}$.\nGiven:\n$$ \\mathbf{K}^{(2)} \\;=\\;\n\\begin{pmatrix}\n7 & 0 & -2 & 0 & -5 & 0 \\\\\n0 & 7 & 0 & -2 & 0 & -5 \\\\\n-2 & 0 & 5 & 0 & -3 & 0 \\\\\n0 & -2 & 0 & 5 & 0 & -3 \\\\\n-5 & 0 & -3 & 0 & 8 & 0 \\\\\n0 & -5 & 0 & -3 & 0 & 8\n\\end{pmatrix}\n$$\nThe value at row $3$, column $5$ is $K_{3,5}^{(2)} = -3$.\nTherefore, $K_{7,5}^{\\text{from (2)}} = -3$.\n\nThe total value of $K_{7,5}$ is the sum of the contributions:\n$$ K_{7,5} = 0 + (-3) = -3 $$\n\nAs a verification of the method and to confirm the symmetry of the assembled matrix, we can compute the entry $K_{5,7}$.\n$$ K_{5,7} = K_{5,7}^{\\text{from (1)}} + K_{5,7}^{\\text{from (2)}} $$\nThe contribution from Element $1$ is again $0$, as global DOF $7$ is not in its map.\nFor the contribution from Element $2$, we find the local indices corresponding to global indices $I=5$ and $J=7$.\n- For $I=5$, we find $5$ in $g^{(2)} = (3, 4, 7, 8, 5, 6)$ at the $5$-th position, so local row index is $i=5$.\n- For $J=7$, we find $7$ in $g^{(2)}$ at the $3$-rd position, so local column index is $j=3$.\nThe contribution is $K_{5,3}^{(2)}$. From the matrix $\\mathbf{K}^{(2)}$, the value is $K_{5,3}^{(2)} = -3$.\nSo, $K_{5,7} = 0 + (-3) = -3$.\nSince $K_{7,5} = K_{5,7} = -3$, the assembled matrix is symmetric for this pair of indices, which is consistent with the fact that the element stiffness matrices are symmetric and the assembly operation preserves symmetry.\n\nThe problem asks for the final answer to be expressed in kilo-Newton per meter $(\\mathrm{kN/m})$. The numerical values for the stiffness matrices are provided without units. It is assumed that these values are already in the desired units of $\\mathrm{kN/m}$.\n\nThus, the numerical value of the global stiffness entry $K_{7,5}$ is $-3$.",
            "answer": "$$ \\boxed{-3} $$"
        },
        {
            "introduction": "In practical computational geomechanics, global stiffness matrices are not only large but also sparse, meaning most of their entries are zero. Storing these matrices efficiently is critical for performance. This practice  bridges the gap between the abstract assembly procedure and its practical implementation. You will first compute element matrices for a 2D seepage problem, assemble the global matrix, and then represent the final system using the industry-standard Compressed Sparse Row (CSR) format, a vital skill for developing efficient and scalable simulation codes.",
            "id": "3501554",
            "problem": "Consider steady-state saturated seepage in a homogeneous, isotropic soil domain governed by Darcy’s law and conservation of mass, which reduce to the scalar Laplace equation for hydraulic head $h$: $\\nabla \\cdot \\left( k \\nabla h \\right) = 0$ in the domain, with hydraulic conductivity $k$ constant. Using the standard Galerkin finite element method with linear triangular elements, the global system is assembled from element contributions of the form $K_{ij}^{(e)} = \\int_{\\Omega^{(e)}} k \\, \\nabla N_{i} \\cdot \\nabla N_{j} \\, \\mathrm{d}\\Omega$, where $N_{i}$ are the element shape functions.\n\nYou are given a small mesh of $4$ nodes with coordinates $x_{1}=(0,0)$, $x_{2}=(1,0)$, $x_{3}=(1,1)$, and $x_{4}=(0,1)$, partitioned into $2$ linear triangular elements with connectivity $\\Omega^{(1)}=(1,2,3)$ and $\\Omega^{(2)}=(1,3,4)$. Assume $k=1$ (non-dimensional units for simplicity). No boundary conditions need to be applied; assemble the unconstrained global stiffness matrix.\n\nTasks:\n- Starting from the weak form and the definition of the element stiffness entries, derive the constant shape function gradients for each triangle using area coordinates and the geometric formula for linear triangles. Then compute each element stiffness matrix $K^{(1)}$ and $K^{(2)}$.\n- Assemble the global stiffness matrix $K \\in \\mathbb{R}^{4 \\times 4}$ by summing the element contributions into the appropriate global degrees of freedom using the given connectivity.\n- Store $K$ in Compressed Sparse Row (CSR) format using $0$-based indexing and ascending column indices within each row. Explicitly identify the CSR row pointer array $\\text{row\\_ptr}$, the column index array $\\text{col\\_ind}$, and the values array $\\text{val}$ produced by your assembly.\n- Finally, compute the Euclidean norm (i.e., the $2$-norm) of the vector of nonzero values in $\\text{val}$, defined as $\\|\\text{val}\\|_{2} = \\sqrt{\\sum_{\\ell} \\text{val}_{\\ell}^{2}}$.\n\nProvide your final answer as a single exact analytic expression for $\\|\\text{val}\\|_{2}$. Do not perform any boundary condition elimination. No rounding is required, and no units are to be reported.",
            "solution": "The user wants me to solve the problem. I have validated it and found it to be a valid, well-posed problem from computational geomechanics. I will now proceed with the solution.\n\nThe problem asks for the assembly of the global stiffness matrix for a steady-state seepage problem governed by the Laplace equation, using the Finite Element Method (FEM). The steps are to compute the element stiffness matrices, assemble the global matrix, represent it in Compressed Sparse Row (CSR) format, and finally calculate the Euclidean norm of the resulting value array.\n\nThe element stiffness matrix entries for a linear triangular element $\\Omega^{(e)}$ are given by\n$$K_{ij}^{(e)} = \\int_{\\Omega^{(e)}} k \\, \\nabla N_{i} \\cdot \\nabla N_{j} \\, \\mathrm{d}\\Omega$$\nwhere $N_i$ are the linear shape functions, $k$ is the hydraulic conductivity, and $\\Omega^{(e)}$ is the element domain. For linear triangular elements, the gradients $\\nabla N_i$ are constant within each element. With $k$ also being constant, the integral simplifies to:\n$$K_{ij}^{(e)} = k \\, (\\nabla N_i \\cdot \\nabla N_j) \\, A^{(e)}$$\nwhere $A^{(e)}$ is the area of element $\\Omega^{(e)}$.\n\nThe gradient of a shape function $N_i$ associated with local node $i$ of a triangle with vertices $(x_i, y_i)$, $(x_j, y_j)$, and $(x_k, y_k)$ arranged in counter-clockwise order is given by:\n$$\\nabla N_i = \\frac{1}{2A^{(e)}} \\begin{pmatrix} y_j - y_k \\\\ x_k - x_j \\end{pmatrix} = \\frac{1}{2A^{(e)}} \\begin{pmatrix} b_i \\\\ c_i \\end{pmatrix}$$\nUsing this, the element stiffness matrix can be expressed as:\n$$K_{ij}^{(e)} = \\frac{k}{4A^{(e)}} (b_i b_j + c_i c_j)$$\nWe are given $k=1$.\n\n**Step 1: Compute Element Stiffness Matrix $K^{(1)}$**\n\nElement $\\Omega^{(1)}$ has global nodes $(1,2,3)$ with coordinates $x_1=(0,0)$, $x_2=(1,0)$, and $x_3=(1,1)$. We use these as local nodes $(1,2,3)$ respectively.\nThe area of the triangle is $A^{(1)} = \\frac{1}{2} |x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)| = \\frac{1}{2} |0(0-1) + 1(1-0) + 1(0-0)| = \\frac{1}{2}$.\nThe coefficients $b_i$ and $c_i$ for each local node are:\n- $i=1$: $b_1 = y_2 - y_3 = 0 - 1 = -1$, $c_1 = x_3 - x_2 = 1 - 1 = 0$\n- $i=2$: $b_2 = y_3 - y_1 = 1 - 0 = 1$, $c_2 = x_1 - x_3 = 0 - 1 = -1$\n- $i=3$: $b_3 = y_1 - y_2 = 0 - 0 = 0$, $c_3 = x_2 - x_1 = 1 - 0 = 1$\nThe pre-factor for the stiffness matrix is $\\frac{k}{4A^{(1)}} = \\frac{1}{4(\\frac{1}{2})} = \\frac{1}{2}$.\nLet's construct the matrix of products $(b_i b_j + c_i c_j)$:\n$$\n\\begin{pmatrix} b_1^2+c_1^2 & b_1b_2+c_1c_2 & b_1b_3+c_1c_3 \\\\ b_2b_1+c_2c_1 & b_2^2+c_2^2 & b_2b_3+c_2c_3 \\\\ b_3b_1+c_3c_1 & b_3b_2+c_3c_2 & b_3^2+c_3^2 \\end{pmatrix} = \\begin{pmatrix} (-1)^2+0^2 & (-1)(1)+0(-1) & (-1)(0)+0(1) \\\\ (1)(-1)+(-1)(0) & 1^2+(-1)^2 & (1)(0)+(-1)(1) \\\\ (0)(-1)+(1)(0) & (0)(1)+(1)(-1) & 0^2+1^2 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}\n$$\nThus, the element stiffness matrix for element $\\Omega^{(1)}$ is:\n$$K^{(1)} = \\frac{1}{2} \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}$$\nThis matrix corresponds to global degrees of freedom $(1,2,3)$.\n\n**Step 2: Compute Element Stiffness Matrix $K^{(2)}$**\n\nElement $\\Omega^{(2)}$ has global nodes $(1,3,4)$ with coordinates $x_1=(0,0)$, $x_3=(1,1)$, and $x_4=(0,1)$. We map these to local nodes $(1,2,3)$ respectively. The coordinates for the local calculation are $(x'_1, y'_1)=(0,0)$, $(x'_2, y'_2)=(1,1)$, $(x'_3, y'_3)=(0,1)$.\nThe area is $A^{(2)} = \\frac{1}{2} |0(1-1) + 1(1-0) + 0(0-1)| = \\frac{1}{2}$.\nThe coefficients $b_i$ and $c_i$ for each local node are:\n- $i=1$: $b_1 = y'_2 - y'_3 = 1-1=0$, $c_1 = x'_3 - x'_2 = 0-1=-1$\n- $i=2$: $b_2 = y'_3 - y'_1 = 1-0=1$, $c_2 = x'_1 - x'_3 = 0-0=0$\n- $i=3$: $b_3 = y'_1 - y'_2 = 0-1=-1$, $c_3 = x'_2 - x'_1 = 1-0=1$\nThe pre-factor is also $\\frac{1}{2}$. The matrix of products is:\n$$\n\\begin{pmatrix} 0^2+(-1)^2 & 0(1)+(-1)(0) & 0(-1)+(-1)(1) \\\\ 1(0)+0(-1) & 1^2+0^2 & 1(-1)+0(1) \\\\ (-1)(0)+1(-1) & (-1)(1)+1(0) & (-1)^2+1^2 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & -1 \\\\ 0 & 1 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}\n$$\nThus, the element stiffness matrix for element $\\Omega^{(2)}$ is:\n$$K^{(2)} = \\frac{1}{2} \\begin{pmatrix} 1 & 0 & -1 \\\\ 0 & 1 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}$$\nThis matrix corresponds to global degrees of freedom $(1,3,4)$.\n\n**Step 3: Assemble Global Stiffness Matrix $K$**\n\nWe assemble the global $4 \\times 4$ matrix $K$ by adding the contributions from $K^{(1)}$ and $K^{(2)}$ into the appropriate locations based on their global degree of freedom mappings.\n\n- From $K^{(1)}$ (for DoFs 1,2,3):\n  $K_{11} \\mathrel{+}= \\frac{1}{2}$, $K_{12} \\mathrel{+}= -\\frac{1}{2}$, $K_{13} \\mathrel{+}= 0$\n  $K_{21} \\mathrel{+}= -\\frac{1}{2}$, $K_{22} \\mathrel{+}= 1$, $K_{23} \\mathrel{+}= -\\frac{1}{2}$\n  $K_{31} \\mathrel{+}= 0$, $K_{32} \\mathrel{+}= -\\frac{1}{2}$, $K_{33} \\mathrel{+}= \\frac{1}{2}$\n- From $K^{(2)}$ (for DoFs 1,3,4):\n  $K_{11} \\mathrel{+}= \\frac{1}{2}$, $K_{13} \\mathrel{+}= 0$, $K_{14} \\mathrel{+}= -\\frac{1}{2}$\n  $K_{31} \\mathrel{+}= 0$, $K_{33} \\mathrel{+}= \\frac{1}{2}$, $K_{34} \\mathrel{+}= -\\frac{1}{2}$\n  $K_{41} \\mathrel{+}= -\\frac{1}{2}$, $K_{43} \\mathrel{+}= -\\frac{1}{2}$, $K_{44} \\mathrel{+}= 1$\n\nSumming all contributions:\n$K_{11} = \\frac{1}{2} + \\frac{1}{2} = 1$\n$K_{22} = 1$\n$K_{33} = \\frac{1}{2} + \\frac{1}{2} = 1$\n$K_{44} = 1$\n$K_{12} = K_{21} = -\\frac{1}{2}$\n$K_{13} = K_{31} = 0 + 0 = 0$\n$K_{14} = K_{41} = -\\frac{1}{2}$\n$K_{23} = K_{32} = -\\frac{1}{2}$\n$K_{24} = K_{42} = 0$\n$K_{34} = K_{43} = -\\frac{1}{2}$\n\nThe assembled global stiffness matrix $K$ is:\n$$ K = \\begin{pmatrix} 1 & -\\frac{1}{2} & 0 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 1 & -\\frac{1}{2} & 0 \\\\ 0 & -\\frac{1}{2} & 1 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & -\\frac{1}{2} & 1 \\end{pmatrix} $$\n\n**Step 4: Store $K$ in Compressed Sparse Row (CSR) Format**\n\nTo convert $K$ to CSR format with $0$-based indexing, we identify the non-zero values (`val`), their column indices (`col_ind`), and the row start pointers (`row_ptr`). Column indices within each row must be in ascending order. The mapping from global node ID $i$ to matrix index is $i-1$.\n\n- Row 0 (Node 1): Non-zero values are at columns 0, 1, 3. Values: $1, -\\frac{1}{2}, -\\frac{1}{2}$.\n- Row 1 (Node 2): Non-zero values are at columns 0, 1, 2. Values: $-\\frac{1}{2}, 1, -\\frac{1}{2}$.\n- Row 2 (Node 3): Non-zero values are at columns 1, 2, 3. Values: $-\\frac{1}{2}, 1, -\\frac{1}{2}$.\n- Row 3 (Node 4): Non-zero values are at columns 0, 2, 3. Values: $-\\frac{1}{2}, -\\frac{1}{2}, 1$.\n\nThe three CSR arrays are:\n- `val`: This array stores the non-zero values, row by row.\n  $$\\text{val} = \\left[ 1, -\\frac{1}{2}, -\\frac{1}{2}, -\\frac{1}{2}, 1, -\\frac{1}{2}, -\\frac{1}{2}, 1, -\\frac{1}{2}, -\\frac{1}{2}, -\\frac{1}{2}, 1 \\right]$$\n- `col_ind`: This array stores the column indices corresponding to the values in `val`.\n  $$\\text{col\\_ind} = [ 0, 1, 3, 0, 1, 2, 1, 2, 3, 0, 2, 3 ]$$\n- `row_ptr`: This array stores the index in `val` where each row starts. It has $N+1$ entries, where $N=4$ is the number of rows.\n  $$\\text{row\\_ptr} = [ 0, 3, 6, 9, 12 ]$$\n\n**Step 5: Compute the Euclidean Norm of `val`**\n\nThe final task is to compute the Euclidean norm of the `val` vector:\n$$\\|\\text{val}\\|_{2} = \\sqrt{\\sum_{\\ell=0}^{11} \\text{val}_{\\ell}^{2}}$$\nThe `val` array contains four values of $1$ and eight values of $-\\frac{1}{2}$.\nThe sum of squares is:\n$$ \\sum_{\\ell=0}^{11} \\text{val}_{\\ell}^{2} = 4 \\times (1)^2 + 8 \\times \\left(-\\frac{1}{2}\\right)^2 $$\n$$ \\sum_{\\ell=0}^{11} \\text{val}_{\\ell}^{2} = 4 \\times 1 + 8 \\times \\frac{1}{4} = 4 + 2 = 6 $$\nThe Euclidean norm is therefore:\n$$ \\|\\text{val}\\|_{2} = \\sqrt{6} $$",
            "answer": "$$\\boxed{\\sqrt{6}}$$"
        }
    ]
}