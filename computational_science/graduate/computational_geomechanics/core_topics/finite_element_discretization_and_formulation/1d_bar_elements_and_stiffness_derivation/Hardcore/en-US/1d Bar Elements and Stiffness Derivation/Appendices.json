{
    "hands_on_practices": [
        {
            "introduction": "Before diving into numerical methods, it is essential to master the underlying physics by deriving solutions from first principles. This exercise challenges you to construct the governing boundary value problem and find the analytical solution for a bar under both body forces and an end load, starting from the fundamental equations of equilibrium, kinematics, and material constitution. By solving this canonical problem, you establish a benchmark \"ground truth\" that is invaluable for verifying subsequent numerical models .",
            "id": "3498523",
            "problem": "A prismatic bar made of a homogeneous, isotropic geomaterial is aligned with the spatial coordinate $x$ and occupies the interval $x \\in [0,L]$. The cross-sectional area $A$ and Young’s modulus $E$ are constant. The bar is subjected to a constant body force per unit volume $b$ acting in the positive $x$-direction. Small strain and linear elasticity assumptions apply. The left end at $x=0$ is kinematically restrained with $u(0)=0$. The right end at $x=L$ is loaded by an applied axial force $\\bar{F}$ in the positive $x$-direction. Assume $\\bar{F}>0$.\n\nStarting only from the one-dimensional balance of linear momentum, the small-strain kinematics, and linear elastic constitutive relation, derive the governing boundary value problem for the axial displacement $u(x)$ and obtain the closed-form solution $u(x)$ that satisfies the given boundary conditions.\n\nDefine the dimensionless tip-displacement amplification factor\n$$\nR \\equiv \\frac{u(L)}{\\displaystyle \\frac{\\bar{F} L}{E A}}.\n$$\nProvide a single closed-form analytic expression for $R$ in terms of $A$, $b$, $L$, and $\\bar{F}$. Do not substitute numerical values. The final answer must be a single analytic expression. Do not include units in the final boxed answer.",
            "solution": "The user has provided a problem statement that requires formal validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- A prismatic bar in the domain $x \\in [0,L]$.\n- Cross-sectional area: $A$ (constant).\n- Young’s modulus: $E$ (constant).\n- Material is homogeneous and isotropic.\n- Body force per unit volume: $b$ (constant, positive $x$-direction).\n- Assumptions: Small strain, linear elasticity.\n- Boundary condition at $x=0$: $u(0)=0$.\n- Boundary condition at $x=L$: Applied axial force $\\bar{F}$ (positive $x$-direction).\n- Assumption: $\\bar{F}>0$.\n- Task 1: Derive the governing boundary value problem for the axial displacement $u(x)$.\n- Task 2: Find the closed-form solution $u(x)$.\n- Task 3: Evaluate the dimensionless tip-displacement amplification factor $R \\equiv \\frac{u(L)}{\\displaystyle \\frac{\\bar{F} L}{E A}}$.\n- Task 4: Provide an expression for $R$ in terms of $A$, $b$, $L$, and $\\bar{F}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a canonical exercise in one-dimensional continuum mechanics, based on the fundamental principles of static equilibrium, strain-displacement kinematics, and linear elastic material response (Hooke's Law). These are well-established scientific principles.\n- **Well-Posed**: The problem describes a second-order ordinary differential equation with one Dirichlet boundary condition ($u(0)=0$) and one Neumann boundary condition at the other end. This constitutes a well-posed boundary value problem, for which a unique and stable solution is expected to exist.\n- **Objective**: The problem is stated using precise, unambiguous mathematical and physical terminology. It is free of subjective or opinion-based content.\n\nThe problem is self-contained and internally consistent. It does not violate any of the invalidity criteria listed in the instructions.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full, reasoned solution will be provided.\n\n### Solution Derivation\nThe derivation proceeds by combining the three fundamental pillars of continuum mechanics for this problem: balance of linear momentum (equilibrium), kinematics (strain-displacement relation), and the constitutive law (stress-strain relation).\n\n**1. Balance of Linear Momentum (Equilibrium)**\nConsider a differential element of the bar of length $dx$, located at position $x$. The forces acting on this element in the $x$-direction are the internal axial forces at its faces and the body force. Let $\\sigma(x)$ be the normal stress in the $x$-direction. The internal force at a cross-section is $N(x) = \\sigma(x) A$.\nFor static equilibrium, the sum of forces on the element must be zero:\n$$\n(\\sigma(x+dx)A) - (\\sigma(x)A) + b(Adx) = 0\n$$\nwhere $b$ is the body force per unit volume. Dividing by the volume of the element $Adx$ (assuming $A>0$ and $dx>0$):\n$$\n\\frac{\\sigma(x+dx) - \\sigma(x)}{dx} + b = 0\n$$\nTaking the limit as $dx \\to 0$ yields the differential form of the equilibrium equation:\n$$\n\\frac{d\\sigma}{dx} + b = 0\n$$\n\n**2. Kinematics (Strain-Displacement Relation)**\nUnder the small strain assumption, the axial strain $\\epsilon(x)$ is related to the axial displacement field $u(x)$ by:\n$$\n\\epsilon(x) = \\frac{du}{dx}\n$$\n\n**3. Constitutive Law (Stress-Strain Relation)**\nFor a homogeneous, isotropic, linear elastic material, the one-dimensional stress-strain relationship is given by Hooke's Law:\n$$\n\\sigma(x) = E \\epsilon(x)\n$$\nwhere $E$ is the constant Young's modulus.\n\n**4. Governing Boundary Value Problem**\nBy substituting the kinematic relation into the constitutive law, we express stress in terms of displacement:\n$$\n\\sigma(x) = E \\frac{du}{dx}\n$$\nSubstituting this result into the equilibrium equation gives the governing ordinary differential equation (ODE) for the displacement $u(x)$:\n$$\n\\frac{d}{dx}\\left(E \\frac{du}{dx}\\right) + b = 0\n$$\nSince $E$ is constant, this simplifies to:\n$$\nE \\frac{d^2u}{dx^2} + b = 0 \\quad \\implies \\quad \\frac{d^2u}{dx^2} = -\\frac{b}{E}\n$$\nThis ODE must be solved subject to the given boundary conditions.\n- At the left end ($x=0$), the bar is kinematically restrained: $u(0)=0$.\n- At the right end ($x=L$), an axial force $\\bar{F}$ is applied. The internal stress must balance this applied traction. The internal force is $\\sigma(L)A$. Thus, $\\sigma(L)A = \\bar{F}$. Using the stress-displacement relation, this condition becomes $E \\frac{du}{dx}(L) A = \\bar{F}$.\n\nThe complete boundary value problem is:\n$$\n\\text{ODE: } \\quad E \\frac{d^2u}{dx^2} + b = 0, \\quad x \\in (0,L)\n$$\n$$\n\\text{BCs: } \\quad u(0) = 0, \\quad E A \\frac{du}{dx}(L) = \\bar{F}\n$$\n\n**5. Closed-Form Solution**\nWe solve the ODE by direct integration. Integrating $\\frac{d^2u}{dx^2} = -\\frac{b}{E}$ with respect to $x$ once gives:\n$$\n\\frac{du}{dx} = -\\frac{b}{E}x + C_1\n$$\nwhere $C_1$ is a constant of integration. Integrating a second time gives the general solution for the displacement:\n$$\nu(x) = -\\frac{b}{2E}x^2 + C_1 x + C_2\n$$\nwhere $C_2$ is a second constant of integration. We determine $C_1$ and $C_2$ using the boundary conditions.\nFrom the condition $u(0)=0$:\n$$\nu(0) = -\\frac{b}{2E}(0)^2 + C_1(0) + C_2 = 0 \\quad \\implies \\quad C_2 = 0\n$$\nThe solution simplifies to $u(x) = -\\frac{b}{2E}x^2 + C_1 x$.\nFrom the condition at $x=L$:\n$$\nE A \\left. \\frac{du}{dx} \\right|_{x=L} = \\bar{F}\n$$\nSubstituting the expression for the derivative:\n$$\nE A \\left( -\\frac{b}{E}L + C_1 \\right) = \\bar{F}\n$$\n$$\n-AbL + E A C_1 = \\bar{F}\n$$\n$$\nE A C_1 = \\bar{F} + AbL\n$$\nSolving for $C_1$:\n$$\nC_1 = \\frac{\\bar{F}}{EA} + \\frac{AbL}{EA} = \\frac{\\bar{F}}{EA} + \\frac{bL}{E}\n$$\nSubstituting the constants $C_1$ and $C_2$ back into the general solution yields the closed-form solution for the displacement field:\n$$\nu(x) = -\\frac{b}{2E}x^2 + \\left(\\frac{\\bar{F}}{EA} + \\frac{bL}{E}\\right)x\n$$\nThis can be rearranged to better separate the effects of the point load and the body force:\n$$\nu(x) = \\frac{\\bar{F}x}{EA} + \\frac{b}{E}\\left(Lx - \\frac{x^2}{2}\\right)\n$$\n\n**6. Tip-Displacement Amplification Factor**\nThe problem defines the dimensionless factor $R$ as:\n$$\nR \\equiv \\frac{u(L)}{\\displaystyle \\frac{\\bar{F} L}{E A}}\n$$\nFirst, we evaluate the displacement at the tip, $u(L)$, by substituting $x=L$ into our solution:\n$$\nu(L) = \\frac{\\bar{F}L}{EA} + \\frac{b}{E}\\left(L(L) - \\frac{L^2}{2}\\right) = \\frac{\\bar{F}L}{EA} + \\frac{b}{E}\\left(\\frac{L^2}{2}\\right) = \\frac{\\bar{F}L}{EA} + \\frac{bL^2}{2E}\n$$\nThe term $\\frac{\\bar{F}L}{EA}$ in the denominator of $R$ represents the tip displacement that would occur if only the force $\\bar{F}$ were applied (i.e., if $b=0$).\nNow, we compute the ratio $R$:\n$$\nR = \\frac{\\displaystyle \\frac{\\bar{F}L}{EA} + \\frac{bL^2}{2E}}{\\displaystyle \\frac{\\bar{F}L}{EA}} = \\frac{\\displaystyle \\frac{\\bar{F}L}{EA}}{\\displaystyle \\frac{\\bar{F}L}{EA}} + \\frac{\\displaystyle \\frac{bL^2}{2E}}{\\displaystyle \\frac{\\bar{F}L}{EA}}\n$$\n$$\nR = 1 + \\left(\\frac{bL^2}{2E}\\right) \\left(\\frac{EA}{\\bar{F}L}\\right)\n$$\nSimplifying the second term:\n$$\nR = 1 + \\frac{bL^2EA}{2E\\bar{F}L} = 1 + \\frac{bAL}{2\\bar{F}}\n$$\nThis is the final closed-form analytic expression for $R$ in terms of the given parameters. The quantity $bAL$ represents the total body force over the entire bar. The factor $R$ is unity when there is no body force ($b=0$) and increases linearly with the ratio of the total body force to the applied tip force.",
            "answer": "$$\n\\boxed{1 + \\frac{b A L}{2 \\bar{F}}}\n$$"
        },
        {
            "introduction": "The power of the Finite Element Method (FEM) lies in its ability to solve problems where analytical solutions are intractable, but this comes with the introduction of \"discretization error.\" This practice provides a direct and insightful comparison between an exact analytical solution and a simple one-element FEM approximation for a bar under its own weight. This exercise will allow you to quantify this fundamental error using the energy norm, a core concept in the analysis of FEM convergence and accuracy .",
            "id": "3498577",
            "problem": "Consider a prismatic, uniform bar of length $L$, cross-sectional area $A$, and Young's modulus $E$ lying along the spatial coordinate $x \\in [0,L]$. The bar is subjected to a constant body force per unit volume $b$ acting in the axial direction. Assume small strains and linear elasticity. The left end at $x=0$ is fixed ($u(0)=0$), and the right end at $x=L$ is traction-free in the axial direction (zero axial force at $x=L$). \n\nStarting solely from axial equilibrium and the linear constitutive relation appropriate for a one-dimensional bar in computational geomechanics, derive the analytical displacement field $u(x)$ that satisfies the boundary conditions. Then, using the Finite Element Method (FEM) with a single two-node linear bar element spanning the entire domain $[0,L]$, construct the one-element finite element displacement field $u_h(x)$ with a consistent body-force load representation and the given natural boundary condition. \n\nQuantify the discretization error by the relative energy norm, defined as the ratio of the energy norm of the error field to the energy norm of the exact solution, using the energy norm induced by the one-dimensional linear elastic internal energy. Provide the exact value of this relative error as a pure number without units. No rounding is required.",
            "solution": "The user has provided a problem statement that requires validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- A prismatic, uniform bar of length $L$, cross-sectional area $A$, and Young's modulus $E$.\n- The bar is oriented along the $x$-axis, occupying the domain $x \\in [0,L]$.\n- A constant body force per unit volume, $b$, acts in the axial direction.\n- Assumptions: small strains and linear elasticity.\n- Boundary conditions:\n    1.  Fixed end at $x=0$: $u(0)=0$.\n    2.  Traction-free end at $x=L$: zero axial force.\n- The task is to:\n    1.  Derive the analytical displacement field $u(x)$.\n    2.  Derive the finite element displacement field $u_h(x)$ using a single two-node linear element.\n    3.  Quantify the discretization error using the relative energy norm, $\\eta = \\frac{||u-u_h||_E}{||u||_E}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a standard exercise in solid mechanics and computational methods. It is based on the fundamental principles of axial equilibrium of a bar, linear elasticity (Hooke's Law), and the Finite Element Method (FEM). All concepts are firmly established within the field of computational geomechanics and engineering.\n- **Well-Posed:** The problem is a second-order ordinary differential equation with one essential (Dirichlet) boundary condition, $u(0)=0$, and one natural (Neumann) boundary condition (zero force at $x=L$). This combination ensures the existence of a unique, stable solution.\n- **Objective:** The problem statement is precise, quantitative, and free of subjective or ambiguous language. All parameters ($L, A, E, b$) are clearly defined.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, objective, and complete. It is therefore deemed **valid**. A full solution will be provided.\n\n### Analytical Solution Derivation\nThe governing equation for axial equilibrium of a one-dimensional bar subjected to a body force is derived from force balance on a differential element. The equilibrium equation in terms of axial stress $\\sigma_{xx}$ and body force per unit volume $b$ is:\n$$ \\frac{d\\sigma_{xx}}{dx} + b = 0 $$\nFor linear elasticity, the constitutive relation (Hooke's Law) is:\n$$ \\sigma_{xx} = E \\epsilon_{xx} $$\nwhere $E$ is the Young's modulus and $\\epsilon_{xx}$ is the axial strain. The strain-displacement relationship for small strains is:\n$$ \\epsilon_{xx} = \\frac{du}{dx} $$\nwhere $u(x)$ is the axial displacement field.\nSubstituting the strain-displacement and constitutive relations into the equilibrium equation yields the governing differential equation for the displacement field $u(x)$:\n$$ \\frac{d}{dx}\\left(E \\frac{du}{dx}\\right) + b = 0 $$\nSince $E$ is constant for a uniform bar, this simplifies to:\n$$ E \\frac{d^2u}{dx^2} = -b $$\nIntegrating once with respect to $x$ gives:\n$$ E \\frac{du}{dx} = -bx + C_1 $$\nwhere $C_1$ is a constant of integration. Integrating a second time gives:\n$$ E u(x) = -\\frac{bx^2}{2} + C_1x + C_2 $$\nwhere $C_2$ is a second constant of integration. These constants are determined by applying the boundary conditions.\n\n1.  **Fixed end at $x=0$**: $u(0) = 0$.\n    $$ E u(0) = -\\frac{b(0)^2}{2} + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\n2.  **Traction-free end at $x=L$**: The axial force $N(x) = A\\sigma_{xx}(x)$ must be zero at $x=L$.\n    $$ N(x) = A\\sigma_{xx} = A E \\frac{du}{dx} $$\n    Using the result from the first integration:\n    $$ N(x) = A(-bx + C_1) $$\n    Applying the boundary condition $N(L)=0$:\n    $$ N(L) = A(-bL + C_1) = 0 \\implies C_1 = bL $$\nSubstituting the values of $C_1$ and $C_2$ back into the expression for $u(x)$, we obtain the exact analytical solution:\n$$ E u(x) = -\\frac{bx^2}{2} + bLx $$\n$$ u(x) = \\frac{b}{E} \\left( Lx - \\frac{x^2}{2} \\right) $$\n\n### Finite Element Solution Derivation\nWe model the bar with a single two-node linear element spanning the domain $[0,L]$. The nodes are at $x_1=0$ and $x_2=L$. The displacement field $u_h(x)$ is interpolated from the nodal displacements $d_1$ and $d_2$ using linear shape functions $N_1(x)$ and $N_2(x)$:\n$$ u_h(x) = N_1(x)d_1 + N_2(x)d_2 $$\nThe shape functions are:\n$$ N_1(x) = 1 - \\frac{x}{L}, \\quad N_2(x) = \\frac{x}{L} $$\nThe element stiffness matrix $\\mathbf{k}$ and consistent body force vector $\\mathbf{f}_b$ are given by:\n$$ \\mathbf{k} = \\frac{AE}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n$$ \\mathbf{f}_b = \\int_{V} \\mathbf{N}^T b \\, dV = \\int_0^L A \\begin{pmatrix} N_1(x) \\\\ N_2(x) \\end{pmatrix} b \\, dx = Ab \\int_0^L \\begin{pmatrix} 1 - x/L \\\\ x/L \\end{pmatrix} dx $$\n$$ \\mathbf{f}_b = Ab \\left[ \\begin{matrix} x - \\frac{x^2}{2L} \\\\ \\frac{x^2}{2L} \\end{matrix} \\right]_0^L = Ab \\begin{pmatrix} L - L/2 \\\\ L/2 \\end{pmatrix} = \\frac{AbL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\nThe finite element system of equations is $\\mathbf{k}\\mathbf{d} = \\mathbf{f}$, where $\\mathbf{f} = \\mathbf{f}_{ext} + \\mathbf{f}_b$. The external point load vector is $\\mathbf{f}_{ext} = \\begin{pmatrix} R_1 \\\\ 0 \\end{pmatrix}$, where $R_1$ is the reaction force at the fixed node $1$, and the force at node $2$ is zero due to the traction-free boundary condition.\nThe system is:\n$$ \\frac{AE}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = \\begin{pmatrix} R_1 \\\\ 0 \\end{pmatrix} + \\frac{AbL}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\nApplying the essential boundary condition $u(0)=0 \\implies d_1=0$. We can solve for the unknown displacement $d_2$ using the second equation of the system:\n$$ \\frac{AE}{L} (-d_1 + d_2) = 0 + \\frac{AbL}{2} $$\n$$ \\frac{AE}{L} (0 + d_2) = \\frac{AbL}{2} \\implies d_2 = \\frac{AbL}{2} \\frac{L}{AE} = \\frac{bL^2}{2E} $$\nThe finite element displacement field is thus:\n$$ u_h(x) = N_1(x)(0) + N_2(x)d_2 = \\frac{x}{L} \\left( \\frac{bL^2}{2E} \\right) = \\frac{bL}{2E}x $$\n\n### Error Quantification\nThe discretization error field is $e(x) = u(x) - u_h(x)$:\n$$ e(x) = \\frac{b}{E} \\left( Lx - \\frac{x^2}{2} \\right) - \\frac{bL}{2E}x = \\frac{b}{E} \\left( \\frac{Lx}{2} - \\frac{x^2}{2} \\right) = \\frac{b}{2E}(Lx - x^2) $$\nThe energy norm of a displacement field $v(x)$ is defined as $||v||_E = \\sqrt{\\int_0^L AE \\left(\\frac{dv}{dx}\\right)^2 dx}$. We need to compute the relative error $\\eta = \\frac{||e||_E}{||u||_E}$. We first compute the square of the norms.\n\nEnergy norm of the exact solution $u(x)$:\n$$ \\frac{du}{dx} = \\frac{b}{E}(L-x) $$\n$$ ||u||_E^2 = \\int_0^L AE \\left( \\frac{b}{E}(L-x) \\right)^2 dx = \\frac{Ab^2}{E} \\int_0^L (L-x)^2 dx $$\n$$ ||u||_E^2 = \\frac{Ab^2}{E} \\left[ -\\frac{(L-x)^3}{3} \\right]_0^L = \\frac{Ab^2}{E} \\left( 0 - \\left(-\\frac{L^3}{3}\\right) \\right) = \\frac{Ab^2L^3}{3E} $$\n\nEnergy norm of the error field $e(x)$:\n$$ \\frac{de}{dx} = \\frac{b}{2E}(L-2x) $$\n$$ ||e||_E^2 = \\int_0^L AE \\left( \\frac{b}{2E}(L-2x) \\right)^2 dx = \\frac{Ab^2}{4E} \\int_0^L (L-2x)^2 dx $$\n$$ ||e||_E^2 = \\frac{Ab^2}{4E} \\left[ -\\frac{(L-2x)^3}{6} \\right]_0^L = \\frac{Ab^2}{4E} \\left( -\\frac{(-L)^3}{6} - \\left(-\\frac{L^3}{6}\\right) \\right) = \\frac{Ab^2}{4E} \\left( \\frac{L^3}{6} + \\frac{L^3}{6} \\right) = \\frac{Ab^2}{4E} \\frac{L^3}{3} = \\frac{Ab^2L^3}{12E} $$\n\nThe relative error in energy norm is the ratio of the two norms:\n$$ \\eta = \\frac{||e||_E}{||u||_E} = \\sqrt{\\frac{||e||_E^2}{||u||_E^2}} = \\sqrt{\\frac{Ab^2L^3/(12E)}{Ab^2L^3/(3E)}} = \\sqrt{\\frac{1/12}{1/3}} = \\sqrt{\\frac{3}{12}} = \\sqrt{\\frac{1}{4}} $$\n$$ \\eta = \\frac{1}{2} $$\nThe exact value of the relative error is $1/2$.",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "A cornerstone of reliable computational analysis is code verification, ensuring that our numerical tools behave as expected. The \"patch test\" is a fundamental check to confirm that a finite element formulation is correctly implemented and can reproduce basic states of deformation exactly. In this hands-on exercise, you will perform a patch test for a 1D bar, verifying that your finite element model can perfectly capture a constant strain field, a critical requirement for ensuring the method will converge to the correct solution on refined meshes .",
            "id": "3498516",
            "problem": "Consider the one-dimensional linear elastic bar in small strain and small displacement setting. Let the bar occupy the interval $x \\in [0,L]$, with constant Young's modulus $E$ and constant cross-sectional area $A$. There are no body forces. The displacement field is prescribed at the two ends as $u(0) = \\alpha$ and $u(L) = \\alpha + \\beta L$, which enforces the exact linear displacement field $u(x) = \\alpha + \\beta x$ and constant strain $\\epsilon(x) = \\beta$ throughout the bar. Using the Finite Element Method (FEM), you will derive and implement the stiffness of a two-node linear bar element and assemble the global stiffness matrix for arbitrary mesh partitions. Then, you will conduct a patch test by imposing the given end displacements and verify that the assembled solution reproduces the exact constant strain field for arbitrary mesh partitioning.\n\nFundamental Principles:\n- Kinematics: small strain in one dimension $\\epsilon(x) = \\dfrac{du}{dx}$.\n- Constitutive law (Hooke’s law): $\\sigma(x) = E \\, \\epsilon(x)$, where $\\sigma$ is the axial stress.\n- Principle of Virtual Work (PVW): $\\displaystyle \\int_{0}^{L} \\sigma \\, \\delta \\epsilon \\, A \\, dx = \\int_{0}^{L} b \\, \\delta u \\, A \\, dx + \\left. t \\, \\delta u \\right|_{\\partial \\Omega_t}$, with $b=0$ and end tractions absent due to purely essential boundary conditions in this problem.\n\nTask:\n1. Starting from the Principle of Virtual Work and the above kinematics and constitutive relations, derive the element stiffness matrix for a two-node linear bar element on an interval $[x_i, x_{i+1}]$. Do not use any pre-memorized stiffness formulas; the derivation must start from the virtual work statement, employ the standard two-node $C^0$-continuous linear approximation within an element, and perform the element-level integration exactly.\n2. Assemble the global stiffness matrix for an arbitrary partition (mesh) of $[0,L]$ into sub-intervals. Impose the essential boundary conditions $u(0)=\\alpha$ and $u(L)=\\alpha+\\beta L$ and solve for the interior nodal displacements.\n3. For each test case below, compute the following dimensionless error metrics:\n   - The maximum relative nodal displacement error in the infinity norm: $\\displaystyle e_{u,\\infty}^{\\mathrm{rel}} = \\dfrac{\\max_j \\left| u_h(x_j) - u(x_j) \\right|}{\\max_j \\left| u(x_j) \\right|}$, where $u_h$ is the finite element solution and $\\{x_j\\}$ are the nodal coordinates.\n   - The relative $\\ell^2$ displacement error: $\\displaystyle e_{u,2}^{\\mathrm{rel}} = \\dfrac{\\left( \\sum_j \\left( u_h(x_j) - u(x_j) \\right)^2 \\right)^{1/2}}{\\left( \\sum_j \\left( u(x_j) \\right)^2 \\right)^{1/2}}$.\n   - The maximum relative element strain error: $\\displaystyle e_{\\epsilon,\\infty}^{\\mathrm{rel}} = \\max_e \\dfrac{\\left| \\epsilon_h^{(e)} - \\beta \\right|}{\\left| \\beta \\right|}$, where $\\epsilon_h^{(e)}$ is the constant strain computed on element $e$ as the difference of nodal displacements divided by the element length, and $\\beta$ is the exact constant strain.\nAll three errors are dimensionless. No physical unit should appear in your outputs.\n\nTest suite:\nProvide results for the following four test cases. In each case, $E$ is in $\\mathrm{Pa}$, $A$ is in $\\mathrm{m}^2$, $L$ is in $\\mathrm{m}$, $\\alpha$ is in $\\mathrm{m}$, and $\\beta$ is dimensionless. The mesh is given by an ordered list of nodal coordinates including $0$ and $L$.\n\n- Test case $1$ (general irregular partition):\n  - $L = 3.7$, $E = 2.1 \\times 10^{11}$, $A = 4.0 \\times 10^{-3}$, $\\alpha = 1.2 \\times 10^{-3}$, $\\beta = -8.5 \\times 10^{-4}$.\n  - Nodes: $[0.0,\\, 0.3,\\, 1.1,\\, 2.5,\\, 3.7]$.\n\n- Test case $2$ (single element partition):\n  - $L = 5.0$, $E = 3.5 \\times 10^{10}$, $A = 2.5 \\times 10^{-2}$, $\\alpha = -3.0 \\times 10^{-3}$, $\\beta = 2.0 \\times 10^{-4}$.\n  - Nodes: $[0.0,\\, 5.0]$.\n\n- Test case $3$ (highly skewed partition with very small elements near the left end):\n  - $L = 1.0$, $E = 7.0 \\times 10^{10}$, $A = 1.0 \\times 10^{-2}$, $\\alpha = 0.5 \\times 10^{-3}$, $\\beta = 3.0 \\times 10^{-3}$.\n  - Nodes: $[0.0,\\, 10^{-6},\\, 10^{-3},\\, 10^{-2},\\, 10^{-1},\\, 0.5,\\, 1.0]$.\n\n- Test case $4$ (graded mesh with many elements):\n  - $L = 2.0$, $E = 1.0 \\times 10^{11}$, $A = 5.0 \\times 10^{-3}$, $\\alpha = 2.5 \\times 10^{-4}$, $\\beta = -1.25 \\times 10^{-3}$.\n  - Nodes: $x_i = L \\left( \\dfrac{i}{N} \\right)^2$ for $i=0,1,\\dots,N$ with $N=50$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, each inner list corresponding to a test case in the same order as above and containing the three errors $[e_{u,\\infty}^{\\mathrm{rel}},\\, e_{u,2}^{\\mathrm{rel}},\\, e_{\\epsilon,\\infty}^{\\mathrm{rel}}]$. For example: $[[r_{1,1},r_{1,2},r_{1,3}],[r_{2,1},r_{2,2},r_{2,3}],[r_{3,1},r_{3,2},r_{3,3}],[r_{4,1},r_{4,2},r_{4,3}]]$. The numbers must be dimensionless (no physical units are to be reported).",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of linear elastostatics and the Finite Element Method, is well-posed as a Dirichlet boundary value problem, is expressed objectively and without ambiguity, and contains all necessary information to derive the expressions and compute the requested numerical results. The task constitutes a standard patch test, a fundamental verification procedure in computational mechanics.\n\n### 1. Derivation of the Element Stiffness Matrix\n\nThe derivation begins with the Principle of Virtual Work (PVW) for the one-dimensional bar. Given the absence of body forces ($b=0$) and external tractions on the boundary (as boundary conditions are purely of the Dirichlet type), the PVW simplifies to its homogeneous form, stating that the internal virtual work is zero for any kinematically admissible virtual displacement:\n$$\n\\int_{0}^{L} \\delta W_{int} \\, dx = \\int_{0}^{L} \\sigma(x) \\, \\delta \\epsilon(x) \\, A \\, dx = 0\n$$\nwhere $\\sigma$ is the axial stress, $\\epsilon$ is the axial strain, $\\delta\\epsilon$ is the virtual axial strain, and $A$ is the cross-sectional area.\n\nThe integral over the entire domain $[0,L]$ can be decomposed into a sum of integrals over each element in the finite element mesh. For a single element $e$, occupying the domain $[x_i, x_{i+1}]$ of length $L_e = x_{i+1} - x_i$, the contribution to the PVW is:\n$$\n\\int_{x_i}^{x_{i+1}} \\sigma^{(e)}(x) \\, \\delta \\epsilon^{(e)}(x) \\, A \\, dx = 0\n$$\n\nWe introduce a finite element approximation for the displacement field $u(x)$ within this element. For a two-node linear bar element, the displacement $u_h^{(e)}(x)$ is interpolated from the nodal displacements $d_1^{(e)} = u_h(x_i)$ and $d_2^{(e)} = u_h(x_{i+1})$ using linear shape functions. We define a local coordinate $\\xi \\in [0,1]$ such that $x = x_i + \\xi L_e$. The linear shape functions are:\n$$\nN_1(\\xi) = 1 - \\xi \\quad \\text{and} \\quad N_2(\\xi) = \\xi\n$$\nThe approximated displacement field is then written in matrix form as:\n$$\nu_h^{(e)}(x(\\xi)) = N_1(\\xi)d_1^{(e)} + N_2(\\xi)d_2^{(e)} = \\mathbf{N}(\\xi) \\mathbf{d}^{(e)}\n$$\nwhere $\\mathbf{N}(\\xi) = [N_1(\\xi), N_2(\\xi)]$ is the vector of shape functions and $\\mathbf{d}^{(e)} = [d_1^{(e)}, d_2^{(e)}]^T$ is the vector of element nodal displacements.\n\nThe strain is the spatial derivative of the displacement, $\\epsilon(x) = du/dx$. Using the chain rule, we relate the derivative with respect to $x$ to the derivative with respect to $\\xi$:\n$$\n\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi} = \\frac{1}{L_e}\\frac{d}{d\\xi}\n$$\nThe strain within the element, $\\epsilon_h^{(e)}$, is then:\n$$\n\\epsilon_h^{(e)} = \\frac{du_h^{(e)}}{dx} = \\frac{1}{L_e} \\frac{d\\mathbf{N}(\\xi)}{d\\xi} \\mathbf{d}^{(e)}\n$$\nThe derivatives of the shape functions are $\\frac{dN_1}{d\\xi} = -1$ and $\\frac{dN_2}{d\\xi} = 1$. This leads to the strain-displacement matrix, $\\mathbf{B}$:\n$$\n\\epsilon_h^{(e)} = \\frac{1}{L_e}[-1, 1]\\mathbf{d}^{(e)} = \\mathbf{B}\\mathbf{d}^{(e)}\n$$\nNote that for a linear element, the $\\mathbf{B}$ matrix is constant within the element, resulting in a constant strain field. The virtual strain $\\delta\\epsilon_h^{(e)}$ is related to the virtual nodal displacements $\\delta\\mathbf{d}^{(e)}$ by the same relationship:\n$$\n\\delta\\epsilon_h^{(e)} = \\mathbf{B}\\delta\\mathbf{d}^{(e)}\n$$\nThe constitutive relation (Hooke's Law) for linear elasticity is $\\sigma(x) = E \\epsilon(x)$. In the element context, this is $\\sigma_h^{(e)} = E \\epsilon_h^{(e)} = E \\mathbf{B} \\mathbf{d}^{(e)}$, where $E$ is the constant Young's modulus.\n\nSubstituting these expressions into the element's virtual work equation:\n$$\n\\int_{x_i}^{x_{i+1}} \\left( E \\mathbf{B} \\mathbf{d}^{(e)} \\right)^T \\left( \\mathbf{B} \\delta\\mathbf{d}^{(e)} \\right) A \\, dx = 0\n$$\nSince the terms are scalars, the transpose on the stress term can be moved. We can rearrange the expression, noting that nodal displacements are not functions of $x$:\n$$\n(\\delta\\mathbf{d}^{(e)})^T \\left( \\int_{x_i}^{x_{i+1}} \\mathbf{B}^T E A \\mathbf{B} \\, dx \\right) \\mathbf{d}^{(e)} = 0\n$$\nSince this must hold for any arbitrary virtual displacements $\\delta\\mathbf{d}^{(e)}$, the term in the parentheses must be zero. This term represents the element's force-displacement relationship, $\\mathbf{k}^{(e)}\\mathbf{d}^{(e)} = \\mathbf{f}^{(e)}$, where $\\mathbf{k}^{(e)}$ is the element stiffness matrix.\n$$\n\\mathbf{k}^{(e)} = \\int_{x_i}^{x_{i+1}} \\mathbf{B}^T E A \\mathbf{B} \\, dx\n$$\nAs $E$, $A$, and the $\\mathbf{B}$ matrix are constant within the element, they can be taken out of the integral:\n$$\n\\mathbf{k}^{(e)} = \\mathbf{B}^T E A \\mathbf{B} \\int_{x_i}^{x_{i+1}} dx = (\\mathbf{B}^T E A \\mathbf{B}) L_e\n$$\nSubstituting the expression for $\\mathbf{B}$:\n$$\n\\mathbf{k}^{(e)} = \\left( \\left(\\frac{1}{L_e}\\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix}\\right) E A \\left(\\frac{1}{L_e}[-1, 1]\\right) \\right) L_e = \\frac{EA}{L_e^2} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} L_e\n$$\nThis simplifies to the well-known stiffness matrix for a $2$-node linear elastic bar element:\n$$\n\\mathbf{k}^{(e)} = \\frac{EA}{L_e}\n\\begin{bmatrix}\n1 & -1 \\\\\n-1 & 1\n\\end{bmatrix}\n$$\n\n### 2. Global Assembly and Solution\n\nThe global stiffness matrix $\\mathbf{K}$ for a mesh with $N_{nodes}$ nodes is an $N_{nodes} \\times N_{nodes}$ matrix, initially filled with zeros. The global system of equations is $\\mathbf{K} \\mathbf{U} = \\mathbf{F}$, where $\\mathbf{U}$ is the vector of global nodal displacements and $\\mathbf{F}$ is the vector of external nodal forces (which is zero for this problem).\n\nThe matrix $\\mathbf{K}$ is assembled by iterating through each element $e$ connecting global nodes $i$ and $j$, and adding the entries of the element stiffness matrix $\\mathbf{k}^{(e)}$ to the corresponding locations in $\\mathbf{K}$. For an element connecting nodes $i$ and $i+1$, the assembly rule is:\n$$\nK_{i,i} \\leftarrow K_{i,i} + k^{(e)}_{11} \\quad \\quad K_{i,i+1} \\leftarrow K_{i,i+1} + k^{(e)}_{12} \\\\\nK_{i+1,i} \\leftarrow K_{i+1,i} + k^{(e)}_{21} \\quad \\quad K_{i+1,i+1} \\leftarrow K_{i+1,i+1} + k^{(e)}_{22}\n$$\nThe essential boundary conditions are $u(0) = \\alpha$ and $u(L) = \\alpha + \\beta L$. These are imposed on the first and last nodes of the global system. The global system is partitioned into unknown (interior) and prescribed (boundary) degrees of freedom (DOFs), denoted by subscripts $u$ and $p$ respectively:\n$$\n\\begin{bmatrix}\n\\mathbf{K}_{uu} & \\mathbf{K}_{up} \\\\\n\\mathbf{K}_{pu} & \\mathbf{K}_{pp}\n\\end{bmatrix}\n\\begin{Bmatrix}\n\\mathbf{U}_u \\\\\n\\mathbf{U}_p\n\\end{Bmatrix}\n=\n\\begin{Bmatrix}\n\\mathbf{F}_u \\\\\n\\mathbf{F}_p\n\\end{Bmatrix}\n$$\nHere, $\\mathbf{U}_u$ is the vector of unknown interior nodal displacements, and $\\mathbf{U}_p = [\\alpha, \\alpha + \\beta L]^T$ is the vector of known boundary displacements. Since $\\mathbf{F}_u = \\mathbf{0}$, the system for the unknown DOFs is:\n$$\n\\mathbf{K}_{uu} \\mathbf{U}_u + \\mathbf{K}_{up} \\mathbf{U}_p = \\mathbf{0} \\implies \\mathbf{K}_{uu} \\mathbf{U}_u = - \\mathbf{K}_{up} \\mathbf{U}_p\n$$\nThis linear system is solved for $\\mathbf{U}_u$. The full finite element solution vector $u_h$ is then constructed by combining the solved interior displacements $\\mathbf{U}_u$ with the prescribed boundary displacements $\\mathbf{U}_p$.\n\n### 3. Error Metrics and Patch Test Verification\n\nThe patch test verifies that the FEM implementation can exactly reproduce a constant or linear solution field. For this problem, the exact solution is the linear displacement field $u(x) = \\alpha + \\beta x$ and the constant strain field $\\epsilon(x) = \\beta$. Since a two-node element uses a linear interpolation, it can represent this solution exactly. Therefore, the finite element solution $u_h$ should match the exact solution $u(x)$ at all nodes to within machine precision, irrespective of the mesh layout.\n\nThe following dimensionless error metrics are computed to verify this:\n1.  Maximum relative nodal displacement error: This measures the largest deviation at any node, relative to the largest exact nodal displacement.\n    $$\n    e_{u,\\infty}^{\\mathrm{rel}} = \\dfrac{\\max_j \\left| u_h(x_j) - u(x_j) \\right|}{\\max_j \\left| u(x_j) \\right|}\n    $$\n2.  Relative $\\ell^2$ displacement error: This measures the overall error in nodal displacements in a root-mean-square sense.\n    $$\n    e_{u,2}^{\\mathrm{rel}} = \\dfrac{\\left( \\sum_j \\left( u_h(x_j) - u(x_j) \\right)^2 \\right)^{1/2}}{\\left( \\sum_j \\left( u(x_j) \\right)^2 \\right)^{1/2}} = \\frac{\\| \\mathbf{U}_h - \\mathbf{U}_{exact} \\|_2}{\\| \\mathbf{U}_{exact} \\|_2}\n    $$\n3.  Maximum relative element strain error: This measures the largest deviation in the element-wise constant strain from the exact constant strain $\\beta$.\n    $$\n    e_{\\epsilon,\\infty}^{\\mathrm{rel}} = \\max_e \\dfrac{\\left| \\epsilon_h^{(e)} - \\beta \\right|}{\\left| \\beta \\right|}\n    $$\n    where $\\epsilon_h^{(e)} = (u_h(x_{j+1}) - u_h(x_j))/(x_{j+1} - x_j)$ for an element between nodes $j$ and $j+1$.\n\nFor all test cases, since the patch test must be passed, all three error metrics are expected to be zero or a very small number on the order of machine floating-point precision (e.g., $\\approx 10^{-14}$ or smaller).",
            "answer": "[[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]"
        }
    ]
}