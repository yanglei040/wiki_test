{
    "hands_on_practices": [
        {
            "introduction": "In geomechanical analysis, accurately accounting for distributed body forces, such as self-weight or centrifugal loads, is fundamental. The isoparametric formulation provides a rigorous method for converting these distributed loads into a set of 'consistent' nodal forces that are energetically equivalent. This first exercise  challenges you to derive these forces from the principle of virtual work, revealing how the partition of unity property of shape functions ensures the conservation of total force.",
            "id": "3535642",
            "problem": "In the Finite Element Method (FEM) for computational geomechanics, consider a single isoparametric bilinear quadrilateral element with nodes ordered counterclockwise and physical coordinates (in meters) given by node $1$: $(0,0)$, node $2$: $(3,0)$, node $3$: $(3.5,2)$, and node $4$: $(-0.5,1)$. The element has a uniform out-of-plane thickness $t = 0.2$ meters and mass density $\\rho = 1800$ kilograms per cubic meter. The body acceleration field is due to uniform rotation about the line $x=0$ and is given by $\\mathbf{b}(\\mathbf{x}) = \\omega^{2} x \\,\\mathbf{e}_{x}$ with $\\omega = 4$ radians per second, where $x$ is the global Cartesian coordinate measured in meters.\n\nUsing only fundamental principles, starting from the weak form of equilibrium and the isoparametric interpolation properties, derive the expression for the resultant in the $x$-direction obtained by summing the $x$-components of the consistent equivalent nodal body force vector of this element. Then evaluate this resultant exactly for the given element geometry and parameters.\n\nExpress your final answer in newtons and round your answer to four significant figures. State the final numerical value only; do not include intermediate results in the final answer.",
            "solution": "The problem is well-posed and consistent with the principles of computational mechanics and the Finite Element Method (FEM). All necessary data are provided. We proceed with the solution.\n\nThe consistent equivalent nodal body force vector, $\\mathbf{F}_b$, is derived from the principle of virtual work. The virtual work done by the body forces, $\\mathbf{f}_b$, over the element volume, $V$, is given by:\n$$ \\delta W_b = \\int_V \\delta\\mathbf{u}^T \\mathbf{f}_b \\, dV $$\nWithin the FEM framework, the displacement field $\\mathbf{u}$ at any point $\\mathbf{x}$ inside the element is interpolated from the nodal displacements $\\mathbf{d}$ using the matrix of shape functions $\\mathbf{N}(\\mathbf{x})$:\n$$ \\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\mathbf{d} $$\nThe virtual displacement field $\\delta\\mathbf{u}$ is then:\n$$ \\delta\\mathbf{u}(\\mathbf{x}) = \\mathbf{N}(\\mathbf{x}) \\delta\\mathbf{d} $$\nSubstituting this into the virtual work expression, we get:\n$$ \\delta W_b = \\int_V (\\mathbf{N} \\delta\\mathbf{d})^T \\mathbf{f}_b \\, dV = \\delta\\mathbf{d}^T \\int_V \\mathbf{N}^T \\mathbf{f}_b \\, dV $$\nThe virtual work is also defined as $\\delta W_b = \\delta\\mathbf{d}^T \\mathbf{F}_b$. By comparing the two expressions, we identify the consistent nodal body force vector:\n$$ \\mathbf{F}_b = \\int_V \\mathbf{N}^T \\mathbf{f}_b \\, dV $$\nThe given body acceleration is $\\mathbf{b}(\\mathbf{x}) = \\omega^{2} x \\,\\mathbf{e}_{x}$. The body force per unit volume is $\\mathbf{f}_b = \\rho \\mathbf{b}$, where $\\rho$ is the mass density. Thus,\n$$ \\mathbf{f}_b(\\mathbf{x}) = \\begin{pmatrix} f_{bx} \\\\ f_{by} \\end{pmatrix} = \\begin{pmatrix} \\rho \\omega^2 x \\\\ 0 \\end{pmatrix} $$\nFor a $2$D element with $4$ nodes, the shape function matrix $\\mathbf{N}$ and the nodal force vector $\\mathbf{F}_b$ are structured as:\n$$ \\mathbf{N} = \\begin{bmatrix} N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 & 0 \\\\ 0 & N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 \\end{bmatrix} \\quad , \\quad \\mathbf{F}_b = \\begin{pmatrix} (F_{b,1})_x \\\\ (F_{b,1})_y \\\\ \\vdots \\\\ (F_{b,4})_x \\\\ (F_{b,4})_y \\end{pmatrix} $$\nThe $x$-component of the nodal force at node $i$ is:\n$$ (F_{b,i})_x = \\int_V N_i f_{bx} \\, dV = \\int_V N_i (\\rho \\omega^2 x) \\, dV $$\nThe problem asks for the resultant in the $x$-direction, which is the sum of the $x$-components of the nodal forces:\n$$ R_x = \\sum_{i=1}^{4} (F_{b,i})_x = \\sum_{i=1}^{4} \\int_V N_i (\\rho \\omega^2 x) \\, dV $$\nBy linearity of the integral, we can write:\n$$ R_x = \\int_V \\left( \\sum_{i=1}^{4} N_i \\right) (\\rho \\omega^2 x) \\, dV $$\nA fundamental property of isoparametric shape functions is the partition of unity, which states that $\\sum_{i=1}^{4} N_i(\\mathbf{x}) = 1$ for any point $\\mathbf{x}$ within the element. Therefore, the expression for $R_x$ simplifies to the total body force in the $x$-direction acting on the element:\n$$ R_x = \\int_V \\rho \\omega^2 x \\, dV $$\nFor an element with uniform thickness $t$, the volume integral can be written as an integral over the element area $A$:\n$$ R_x = \\rho \\omega^2 t \\int_A x \\, dA $$\nTo evaluate this integral for the given quadrilateral, we use the isoparametric mapping from a square parent element in $(\\xi, \\eta)$ coordinates, where $\\xi \\in [-1, 1]$ and $\\eta \\in [-1, 1]$, to the physical element in $(x, y)$ coordinates. The differential area element transforms as $dA = |\\mathbf{J}| d\\xi d\\eta$, where $|\\mathbf{J}|$ is the determinant of the Jacobian matrix of the transformation. The integral becomes:\n$$ R_x = \\rho \\omega^2 t \\int_{-1}^{1} \\int_{-1}^{1} x(\\xi, \\eta) |\\mathbf{J}(\\xi, \\eta)| \\, d\\xi d\\eta $$\nThe coordinate mapping is given by $x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i$, where $N_i$ are the bilinear shape functions:\n$N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\nThe physical coordinates of the nodes are $(x_1, y_1) = (0,0)$, $(x_2, y_2) = (3,0)$, $(x_3, y_3) = (3.5,2)$, and $(x_4, y_4) = (-0.5,1)$.\nSubstituting these coordinates into the mapping for $x$:\n$$ x(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(3) + \\frac{1}{4}(1+\\xi)(1+\\eta)(3.5) + \\frac{1}{4}(1-\\xi)(1+\\eta)(-0.5) $$\n$$ x(\\xi, \\eta) = \\frac{1}{4} [ (3+3.5-0.5) + (3+3.5+0.5)\\xi + (-3+3.5-0.5)\\eta + (-3+3.5+0.5)\\xi\\eta ] $$\n$$ x(\\xi, \\eta) = \\frac{1}{4} (6 + 7\\xi + \\xi\\eta) $$\nThe Jacobian matrix is $\\mathbf{J} = \\begin{bmatrix} \\partial x/\\partial \\xi & \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi & \\partial y/\\partial \\eta \\end{bmatrix}$. The partial derivatives are:\n$$ \\frac{\\partial x}{\\partial \\xi} = \\sum \\frac{\\partial N_i}{\\partial \\xi} x_i = \\frac{1}{4} [3(1-\\eta) + 3.5(1+\\eta) - (-0.5)(1+\\eta)] = \\frac{1}{4}(7+\\eta) $$\n$$ \\frac{\\partial y}{\\partial \\xi} = \\sum \\frac{\\partial N_i}{\\partial \\xi} y_i = \\frac{1}{4} [0(1-\\eta) + 2(1+\\eta) - 1(1+\\eta)] = \\frac{1}{4}(1+\\eta) $$\n$$ \\frac{\\partial x}{\\partial \\eta} = \\sum \\frac{\\partial N_i}{\\partial \\eta} x_i = \\frac{1}{4} [-3(1+\\xi) + 3.5(1+\\xi) + (-0.5)(1-\\xi)] = \\frac{1}{4}\\xi $$\n$$ \\frac{\\partial y}{\\partial \\eta} = \\sum \\frac{\\partial N_i}{\\partial \\eta} y_i = \\frac{1}{4} [0(1+\\xi) + 2(1+\\xi) + 1(1-\\xi)] = \\frac{1}{4}(3+\\xi) $$\nThe determinant of the Jacobian is:\n$$ |\\mathbf{J}| = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{16} [(7+\\eta)(3+\\xi) - (1+\\eta)\\xi] = \\frac{1}{16} (21 + 6\\xi + 3\\eta) $$\nNow, we assemble the integral for $R_x$:\n$$ R_x = \\rho \\omega^2 t \\int_{-1}^{1} \\int_{-1}^{1} \\left[ \\frac{1}{4}(6 + 7\\xi + \\xi\\eta) \\right] \\left[ \\frac{1}{16}(21 + 6\\xi + 3\\eta) \\right] d\\xi d\\eta $$\n$$ R_x = \\frac{\\rho \\omega^2 t}{64} \\int_{-1}^{1} \\int_{-1}^{1} (6 + 7\\xi + \\xi\\eta)(21 + 6\\xi + 3\\eta) \\, d\\xi d\\eta $$\nWe expand the polynomial product in the integrand:\n$$ (126 + 36\\xi + 18\\eta) + (147\\xi + 42\\xi^2 + 21\\xi\\eta) + (21\\xi\\eta + 6\\xi^2\\eta + 3\\xi\\eta^2) $$\n$$ = 126 + 183\\xi + 18\\eta + 42\\xi^2 + 42\\xi\\eta + 6\\xi^2\\eta + 3\\xi\\eta^2 $$\nWe integrate this expression over the domain $\\xi \\in [-1, 1], \\eta \\in [-1, 1]$. Due to the orthogonality of polynomials, terms with odd powers of $\\xi$ or $\\eta$ integrate to zero. The only non-zero contributions come from the constant and evenly-powered terms:\n$$ \\int_{-1}^{1} \\int_{-1}^{1} (126 + 42\\xi^2) \\, d\\xi d\\eta = \\int_{-1}^{1} [126\\xi + 14\\xi^3]_{-1}^{1} \\, d\\eta = \\int_{-1}^{1} [(126+14) - (-126-14)] \\, d\\eta $$\n$$ = \\int_{-1}^{1} 280 \\, d\\eta = [280\\eta]_{-1}^{1} = 280 - (-280) = 560 $$\nAlternatively, using standard integral identities:\n$$ \\int_{-1}^{1} \\int_{-1}^{1} 126 \\, d\\xi d\\eta = 126 \\times (2) \\times (2) = 504 $$\n$$ \\int_{-1}^{1} \\int_{-1}^{1} 42\\xi^2 \\, d\\xi d\\eta = 42 \\left(\\int_{-1}^{1} \\xi^2 d\\xi\\right) \\left(\\int_{-1}^{1} d\\eta\\right) = 42 \\left(\\frac{2}{3}\\right) (2) = 56 $$\nThe total value of the integral is $504 + 56 = 560$.\nNow we compute the final value of $R_x$ by substituting the given parameters: $\\rho = 1800 \\, \\text{kg/m}^3$, $\\omega = 4 \\, \\text{rad/s}$, and $t = 0.2 \\, \\text{m}$.\n$$ R_x = \\frac{1800 \\times 4^2 \\times 0.2}{64} \\times 560 $$\n$$ R_x = \\frac{1800 \\times 16 \\times 0.2}{64} \\times 560 = \\frac{1800 \\times 0.2}{4} \\times 560 $$\n$$ R_x = 90 \\times 560 = 50400 \\, \\text{N} $$\nThe question asks for the answer to be rounded to four significant figures. The exact value $50400$ can be written in scientific notation as $5.040 \\times 10^4$, which has four significant figures. Thus, no further rounding is necessary.",
            "answer": "$$\\boxed{50400}$$"
        },
        {
            "introduction": "Moving from static to dynamic problems requires representing the element's inertia through a mass matrix. Two primary approaches exist: the 'consistent' mass matrix, derived directly from the shape functions, and the computationally simpler diagonal 'lumped' mass matrix. This practice  delves into the relationship between these two formulations, guiding you to derive a key ratio that is independent of element geometry and material, thereby clarifying the physical and mathematical properties of each method.",
            "id": "3535709",
            "problem": "Consider transient wave propagation in a homogeneous, dry soil layer under plane strain, discretized by the Finite Element Method (FEM) using a single isoparametric bilinear $4$-node quadrilateral element that covers a rectangular patch with corner nodes at $(0,0)$, $(a,0)$, $(a,b)$, and $(0,b)$, where $a>0$ and $b>0$. The soil has constant mass density $\\rho>0$. The parent (reference) coordinate system is $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, and the standard bilinear shape functions are\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\nLet the isoparametric mapping be $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)x_i$ and $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)y_i$, and let the Jacobian matrix be $\\mathbf{J}=\\partial(x,y)/\\partial(\\xi,\\eta)$ with determinant $\\det\\mathbf{J}>0$ over the element. The consistent element mass matrix is defined by\n$$\n\\mathbf{M}_c = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T\\mathbf{N}\\, d\\Omega,\\quad \\text{with } \\mathbf{N}=[N_1\\;N_2\\;N_3\\;N_4],\n$$\nand, under the isoparametric mapping, $d\\Omega = \\det\\mathbf{J}\\, d\\xi\\, d\\eta$. The lumped element mass matrix is obtained by the standard row-sum diagonal approximation,\n$$\n\\mathbf{M}_\\ell = \\mathrm{diag}\\big(\\mathbf{M}_c\\,\\mathbf{1}\\big),\\quad \\text{where } \\mathbf{1}=[1\\;1\\;1\\;1]^T.\n$$\nStarting from these definitions and without invoking any pre-tabulated integrals, derive an exact expression for the ratio $r$ of the trace of the consistent mass matrix to the trace of the lumped mass matrix,\n$$\nr \\equiv \\frac{\\mathrm{tr}(\\mathbf{M}_c)}{\\mathrm{tr}(\\mathbf{M}_\\ell)},\n$$\nand provide the final value of $r$ as a single exact rational number. The answer is dimensionless, so no units are required. No rounding is needed; report the exact value.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of the Finite Element Method, is well-posed with all necessary information provided, and is stated objectively without ambiguity. We can therefore proceed with a full derivation.\n\nThe objective is to compute the ratio $r$ defined as\n$$\nr = \\frac{\\mathrm{tr}(\\mathbf{M}_c)}{\\mathrm{tr}(\\mathbf{M}_\\ell)}\n$$\nwhere $\\mathbf{M}_c$ is the consistent mass matrix and $\\mathbf{M}_\\ell$ is the lumped mass matrix for a single rectangular isoparametric element.\n\nFirst, we determine the Jacobian of the isoparametric mapping. The corner nodes of the rectangular element in the physical domain $(x,y)$ are given as $(x_1, y_1) = (0,0)$, $(x_2, y_2) = (a,0)$, $(x_3, y_3) = (a,b)$, and $(x_4, y_4) = (0,b)$. The isoparametric mapping from the parent domain $(\\xi, \\eta)$ to the physical domain is given by:\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)x_i = N_1(0) + N_2(a) + N_3(a) + N_4(0) = a(N_2 + N_3)\n$$\n$$\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)y_i = N_1(0) + N_2(0) + N_3(b) + N_4(b) = b(N_3 + N_4)\n$$\nUsing the provided definitions of the shape functions $N_i$:\n$$\nN_2 + N_3 = \\frac{1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1+\\xi)(1+\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta+1+\\eta) = \\frac{1}{2}(1+\\xi)\n$$\n$$\nN_3 + N_4 = \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1}{4}(1+\\eta)(1+\\xi+1-\\xi) = \\frac{1}{2}(1+\\eta)\n$$\nThus, the mapping is:\n$$\nx(\\xi,\\eta) = \\frac{a}{2}(1+\\xi) \\quad \\text{and} \\quad y(\\xi,\\eta) = \\frac{b}{2}(1+\\eta)\n$$\nThe Jacobian matrix $\\mathbf{J}$ has components $J_{ij} = \\frac{\\partial x_i}{\\partial \\xi_j}$:\n$$\nJ_{11} = \\frac{\\partial x}{\\partial \\xi} = \\frac{a}{2}, \\quad J_{12} = \\frac{\\partial x}{\\partial \\eta} = 0\n$$\n$$\nJ_{21} = \\frac{\\partial y}{\\partial \\xi} = 0, \\quad J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\frac{b}{2}\n$$\nSo, the Jacobian matrix is $\\mathbf{J} = \\begin{pmatrix} a/2 & 0 \\\\ 0 & b/2 \\end{pmatrix}$. The determinant of the Jacobian is:\n$$\n\\det\\mathbf{J} = \\left(\\frac{a}{2}\\right)\\left(\\frac{b}{2}\\right) - (0)(0) = \\frac{ab}{4}\n$$\nSince $a>0$ and $b>0$, $\\det\\mathbf{J}>0$ as required. The determinant is constant over the element, which simplifies the integration.\n\nNext, we calculate the trace of the consistent mass matrix, $\\mathrm{tr}(\\mathbf{M}_c)$. The consistent mass matrix is given by:\n$$\n\\mathbf{M}_c = \\int_{\\Omega_e} \\rho\\, \\mathbf{N}^T\\mathbf{N}\\, d\\Omega = \\int_{-1}^{1}\\int_{-1}^{1} \\rho\\, \\mathbf{N}^T(\\xi,\\eta)\\mathbf{N}(\\xi,\\eta)\\, \\det\\mathbf{J}\\, d\\xi\\, d\\eta\n$$\nThe components of $\\mathbf{M}_c$ are:\n$$\n(M_c)_{ij} = \\rho \\frac{ab}{4} \\int_{-1}^{1}\\int_{-1}^{1} N_i(\\xi,\\eta)N_j(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\nThe trace of $\\mathbf{M}_c$ is the sum of its diagonal elements:\n$$\n\\mathrm{tr}(\\mathbf{M}_c) = \\sum_{i=1}^{4} (M_c)_{ii} = \\rho \\frac{ab}{4} \\sum_{i=1}^{4} \\int_{-1}^{1}\\int_{-1}^{1} N_i^2(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\nDue to the structure of the shape functions, the integral of $N_i^2$ is the same for all $i=1,2,3,4$. Let's compute it for $i=1$:\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} N_1^2(\\xi,\\eta)\\, d\\xi\\, d\\eta = \\int_{-1}^{1}\\int_{-1}^{1} \\left(\\frac{1}{4}(1-\\xi)(1-\\eta)\\right)^2 d\\xi\\, d\\eta = \\frac{1}{16} \\int_{-1}^{1} (1-\\xi)^2 d\\xi \\int_{-1}^{1} (1-\\eta)^2 d\\eta\n$$\nWe evaluate the one-dimensional integral:\n$$\n\\int_{-1}^{1} (1-u)^2 du = \\left[ -\\frac{(1-u)^3}{3} \\right]_{-1}^{1} = -\\frac{(1-1)^3}{3} - \\left(-\\frac{(1-(-1))^3}{3}\\right) = 0 + \\frac{2^3}{3} = \\frac{8}{3}\n$$\nTherefore, the double integral is:\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} N_1^2(\\xi,\\eta)\\, d\\xi\\, d\\eta = \\frac{1}{16} \\left(\\frac{8}{3}\\right) \\left(\\frac{8}{3}\\right) = \\frac{64}{16 \\times 9} = \\frac{4}{9}\n$$\nBy symmetry, this result holds for all $N_i^2$. So, the diagonal elements of $\\mathbf{M}_c$ are:\n$$\n(M_c)_{ii} = \\rho \\frac{ab}{4} \\left(\\frac{4}{9}\\right) = \\frac{\\rho ab}{9}\n$$\nThe trace of the consistent mass matrix is the sum of these four identical diagonal elements:\n$$\n\\mathrm{tr}(\\mathbf{M}_c) = 4 \\times \\frac{\\rho ab}{9} = \\frac{4\\rho ab}{9}\n$$\n\nNow, we calculate the trace of the lumped mass matrix, $\\mathrm{tr}(\\mathbf{M}_\\ell)$. The lumped mass matrix is defined by the row-sum technique: $\\mathbf{M}_\\ell = \\mathrm{diag}(\\mathbf{M}_c\\mathbf{1})$. The diagonal elements are $(M_\\ell)_{ii} = \\sum_{j=1}^{4} (M_c)_{ij}$. The trace is the sum of these diagonal elements:\n$$\n\\mathrm{tr}(\\mathbf{M}_\\ell) = \\sum_{i=1}^{4} (M_\\ell)_{ii} = \\sum_{i=1}^{4} \\sum_{j=1}^{4} (M_c)_{ij}\n$$\nThis is the sum of all entries in the consistent mass matrix $\\mathbf{M}_c$. We can compute this sum directly:\n$$\n\\sum_{i=1}^{4} \\sum_{j=1}^{4} (M_c)_{ij} = \\sum_{i=1}^{4} \\sum_{j=1}^{4} \\left( \\rho \\frac{ab}{4} \\int_{-1}^{1}\\int_{-1}^{1} N_i N_j \\, d\\xi\\, d\\eta \\right) = \\rho \\frac{ab}{4} \\int_{-1}^{1}\\int_{-1}^{1} \\left(\\sum_{i=1}^{4} N_i\\right) \\left(\\sum_{j=1}^{4} N_j\\right) d\\xi\\, d\\eta\n$$\nA fundamental property of interpolating shape functions is that they form a partition of unity, i.e., $\\sum_{k=1}^{4} N_k(\\xi, \\eta) = 1$ for all $(\\xi, \\eta)$. Substituting this property into the expression:\n$$\n\\mathrm{tr}(\\mathbf{M}_\\ell) = \\rho \\frac{ab}{4} \\int_{-1}^{1}\\int_{-1}^{1} (1)(1)\\, d\\xi\\, d\\eta = \\rho \\frac{ab}{4} \\left[ \\xi \\right]_{-1}^{1} \\left[ \\eta \\right]_{-1}^{1} = \\rho \\frac{ab}{4} (2)(2) = \\rho ab\n$$\nPhysically, $\\mathrm{tr}(\\mathbf{M}_\\ell)$ represents the total mass of the element, which is the density $\\rho$ times the area $ab$.\n\nFinally, we compute the ratio $r$:\n$$\nr = \\frac{\\mathrm{tr}(\\mathbf{M}_c)}{\\mathrm{tr}(\\mathbf{M}_\\ell)} = \\frac{\\frac{4\\rho ab}{9}}{\\rho ab}\n$$\nThe terms $\\rho$, $a$, and $b$ cancel, yielding the final dimensionless value:\n$$\nr = \\frac{4}{9}\n$$\nThis result is an exact rational number as requested.",
            "answer": "$$ \\boxed{\\frac{4}{9}} $$"
        },
        {
            "introduction": "The power of the isoparametric formulation lies in its ability to map a simple parent element onto complex physical shapes, but this flexibility is not without its subtleties. The Jacobian of the mapping can introduce geometric anisotropy, meaning that physical directions are transformed non-uniformly, a critical detail when dealing with directional quantities like gradients or normals. This computational exercise  offers a tangible exploration of this concept by tasking you with quantifying the orientation error of a shear band normal that arises when the mapping's anisotropy is naively handled.",
            "id": "3535712",
            "problem": "You are asked to implement a program that quantifies how the computed shear band orientation in a bilinear quadrilateral isoparametric element is sensitive to element distortion, when a naive procedure ignores the anisotropy introduced by the isoparametric mapping. Work in two dimensions under small strains. The fundamental base shall consist of the isoparametric mapping with bilinear shape functions for a four-node quadrilateral element, the small-strain kinematics, and the transformation of gradients by the Jacobian matrix.\n\nConsider a four-node bilinear isoparametric quadrilateral element (often denoted as a $Q_4$ element). Let the parent coordinates be $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$. The parent-to-physical mapping is defined by the bilinear interpolation\n$$\n\\mathbf{x}(\\xi,\\eta) \\;=\\; \\sum_{a=1}^{4} N_a(\\xi,\\eta)\\,\\mathbf{x}_a,\n$$\nwhere $\\mathbf{x}_a = [x_a,y_a]^T$ are the physical coordinates of node $a$, and $N_a(\\xi,\\eta)$ are the standard bilinear shape functions. The Jacobian matrix at a point $(\\xi,\\eta)$ is\n$$\n\\mathbf{J}(\\xi,\\eta) \\;=\\; \\frac{\\partial \\mathbf{x}}{\\partial(\\xi,\\eta)} \\;=\\; \\begin{bmatrix}\n\\sum_{a=1}^{4} x_a\\,\\frac{\\partial N_a}{\\partial \\xi} & \\sum_{a=1}^{4} x_a\\,\\frac{\\partial N_a}{\\partial \\eta} \\\\\n\\sum_{a=1}^{4} y_a\\,\\frac{\\partial N_a}{\\partial \\xi} & \\sum_{a=1}^{4} y_a\\,\\frac{\\partial N_a}{\\partial \\eta}\n\\end{bmatrix}.\n$$\nIn small-strain kinematics, spatial gradients transform via $\\nabla_{\\mathbf{x}} = \\mathbf{J}^{-T}\\,\\nabla_{(\\xi,\\eta)}$. Consequently, spatial directions are affected by the anisotropy of $\\mathbf{J}$.\n\nSuppose a true physical shear band normal is specified by a unit vector $\\mathbf{n}_0 = [\\cos\\theta_0,\\sin\\theta_0]^T$ in physical space. A naive discrete procedure that ignores the anisotropy of the isoparametric mapping may erroneously treat $\\mathbf{n}_0$ as if it were a parent-space normal and then map it to physical space by the gradient transformation, thereby predicting a normal\n$$\n\\widehat{\\mathbf{n}} \\;\\propto\\; \\mathbf{J}^{-T}\\,\\mathbf{n}_0,\n$$\nnormalized to unit length. The resulting orientation error is defined by the smallest physical angle between $\\mathbf{n}_0$ and $\\widehat{\\mathbf{n}}$,\n$$\n\\Delta\\theta \\;=\\; \\arccos\\left(\\big|\\mathbf{n}_0\\cdot \\widehat{\\mathbf{n}}\\big|\\right),\n$$\nwhich lies in $[0,\\pi/2]$ due to the line-normal symmetry. This error is driven by the anisotropy and skewness of the Jacobian and, through the chain rule in the isoparametric formulation, by the corresponding skewness in the strain-displacement matrix. For interpretive analysis, define the metric tensor\n$$\n\\mathbf{M} \\;=\\; \\mathbf{J}^{-T}\\,\\mathbf{J}^{-1},\n$$\nwhose eigenvalues quantify the anisotropy of direction mapping. An anisotropy index can be defined as\n$$\n\\rho \\;=\\; \\sqrt{\\frac{\\lambda_{\\max}(\\mathbf{M})}{\\lambda_{\\min}(\\mathbf{M})}},\n$$\nand a skewness index as\n$$\ns \\;=\\; \\frac{|M_{12}|}{\\sqrt{M_{11}\\,M_{22}}}.\n$$\nThese indices do not need to be printed; they provide a means to relate distortion to orientation errors.\n\nUse the element centroid $(\\xi,\\eta)=(0,0)$ for all computations. At this point, the derivatives of the standard bilinear shape functions are\n$$\n\\left.\\frac{\\partial N}{\\partial \\xi}\\right|_{(0,0)} \\;=\\; \\left[-\\frac{1}{4},\\,\\frac{1}{4},\\,\\frac{1}{4},\\,-\\frac{1}{4}\\right],\\quad\n\\left.\\frac{\\partial N}{\\partial \\eta}\\right|_{(0,0)} \\;=\\; \\left[-\\frac{1}{4},\\,-\\frac{1}{4},\\,\\frac{1}{4},\\,\\frac{1}{4}\\right].\n$$\n\nImplement a program that, for the test suite below, computes the list of orientation errors $\\Delta\\theta$ (expressed in degrees) corresponding to each element and each target true orientation $\\theta_0$. Use the following test suite.\n\n- Element $E_0$ (square, in meters): node coordinates ordered as $a=1,2,3,4$ corresponding to parent nodes $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$,\n$$\n[(0,0),(1,0),(1,1),(0,1)].\n$$\n- Element $E_1$ (rectangle with aspect ratio, in meters):\n$$\n[(0,0),(2,0),(2,1),(0,1)].\n$$\n- Element $E_2$ (skewed parallelogram, in meters):\n$$\n[(0,0),(2,0.2),(2,1.2),(0,1)].\n$$\n\nFor each element, evaluate four true physical shear band orientation angles (in radians) at the centroid:\n$$\n\\theta_0 \\in \\left\\{0,\\,\\frac{\\pi}{8},\\,\\frac{\\pi}{4},\\,\\frac{3\\pi}{8}\\right\\}.\n$$\nFor each pair of element and $\\theta_0$, compute $\\Delta\\theta$ in degrees and round to six decimal places. Use the following angle unit specification: all input angles are in radians; the required outputs are in degrees.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by element then by angle in the sequence above, namely:\n$$\n[E_0\\text{ with }\\theta_0=0,\\; E_0\\text{ with }\\theta_0=\\pi/8,\\; E_0\\text{ with }\\theta_0=\\pi/4,\\; E_0\\text{ with }\\theta_0=3\\pi/8,\\; E_1\\text{ with the same four angles},\\; E_2\\text{ with the same four angles}].\n$$\nEach entry must be a float rounded to six decimal places.\n\nAll physical coordinates are in meters. The final answers (orientation errors) must be expressed in degrees, rounded to six decimal places. The final output format must be exactly a single line of the form\n$$\n[\\text{result}_1,\\text{result}_2,\\ldots,\\text{result}_{12}].\n$$",
            "solution": "The problem is valid as it presents a well-defined, scientifically grounded problem in computational mechanics. All necessary data and mathematical formulations are provided, leading to a unique and verifiable solution. The task is to compute the orientation error, $\\Delta\\theta$, for a shear band normal in a bilinear quadrilateral isoparametric element when a naive computation ignores the mapping-induced anisotropy.\n\nThe procedure to calculate the orientation error $\\Delta\\theta$ for each given element and true orientation angle $\\theta_0$ is as follows. All computations are performed at the element centroid, where the parent coordinates are $(\\xi,\\eta)=(0,0)$.\n\nFirst, we establish the element geometry and the necessary derivatives. For a four-node quadrilateral element with nodal coordinates $\\mathbf{x}_a = [x_a, y_a]^T$ for $a=1,2,3,4$, the Jacobian matrix $\\mathbf{J}$ of the isoparametric mapping $\\mathbf{x}(\\xi,\\eta)$ is computed at the centroid. The components of the Jacobian are given by:\n$$\nJ_{ij} = \\sum_{a=1}^{4} \\frac{\\partial N_a}{\\partial \\xi_j} x_{ai}\n$$\nwhere $i,j \\in \\{1,2\\}$, $(\\xi_1, \\xi_2) = (\\xi, \\eta)$, and $(x_{a1}, x_{a2}) = (x_a, y_a)$. At the element centroid $(\\xi,\\eta)=(0,0)$, the derivatives of the bilinear shape functions $N_a$ are provided:\n$$\n\\left.\\frac{\\partial N}{\\partial \\xi}\\right|_{(0,0)} = \\left[-\\frac{1}{4},\\,\\frac{1}{4},\\,\\frac{1}{4},\\,-\\frac{1}{4}\\right]\n$$\n$$\n\\left.\\frac{\\partial N}{\\partial \\eta}\\right|_{(0,0)} = \\left[-\\frac{1}{4},\\,-\\frac{1}{4},\\,\\frac{1}{4},\\,\\frac{1}{4}\\right]\n$$\nThe node ordering $a=1,2,3,4$ corresponds to the parent-space corners $(-1,-1), (1,-1), (1,1), (-1,1)$, respectively. Using these values and the given nodal coordinates for each element, the $2 \\times 2$ Jacobian matrix $\\mathbf{J}$ is assembled.\n\nSecond, the true physical shear band normal is defined by a unit vector $\\mathbf{n}_0$ for a given orientation angle $\\theta_0$:\n$$\n\\mathbf{n}_0 = \\begin{bmatrix} \\cos\\theta_0 \\\\ \\sin\\theta_0 \\end{bmatrix}\n$$\n\nThird, we determine the erroneously predicted normal, $\\widehat{\\mathbf{n}}$. A naive procedure treats $\\mathbf{n}_0$ as if it were a vector in the parent space and transforms it to the physical space using the same rule as for gradients, i.e., via the inverse-transpose Jacobian $\\mathbf{J}^{-T}$. This gives a predicted (but un-normalized) vector $\\mathbf{v}$:\n$$\n\\mathbf{v} = \\mathbf{J}^{-T} \\mathbf{n}_0\n$$\nTo calculate $\\mathbf{J}^{-T}$, we first compute the matrix inverse $\\mathbf{J}^{-1}$ and then its transpose $(\\mathbf{J}^{-1})^T$. The predicted normal direction is then found by normalizing $\\mathbf{v}$:\n$$\n\\widehat{\\mathbf{n}} = \\frac{\\mathbf{v}}{||\\mathbf{v}||}\n$$\n\nFourth, the orientation error $\\Delta\\theta$ is the smallest physical angle between the true normal $\\mathbf{n}_0$ and the predicted normal $\\widehat{\\mathbf{n}}$. This is calculated using the dot product:\n$$\n\\cos(\\Delta\\theta_{abs}) = \\mathbf{n}_0 \\cdot \\widehat{\\mathbf{n}}\n$$\nThe problem specifies the error as being in the range $[0, \\pi/2]$, which corresponds to the angle between the lines defined by the normals. This is achieved by taking the absolute value of the dot product before applying the arccosine function:\n$$\n\\Delta\\theta_{\\text{rad}} = \\arccos\\left(\\left|\\mathbf{n}_0 \\cdot \\widehat{\\mathbf{n}}\\right|\\right)\n$$\nFinally, the result is converted from radians to degrees:\n$$\n\\Delta\\theta_{\\text{deg}} = \\Delta\\theta_{\\text{rad}} \\times \\frac{180^\\circ}{\\pi}\n$$\nThis procedure is repeated for each element ($E_0$, $E_1$, $E_2$) and each specified angle $\\theta_0 \\in \\{0, \\pi/8, \\pi/4, 3\\pi/8\\}$. The resulting value of $\\Delta\\theta_{\\text{deg}}$ is rounded to six decimal places.\n\nFor an undistorted element like the square $E_0$, the Jacobian at the centroid is isotropic, i.e., $\\mathbf{J} = c\\mathbf{I}$ where $c$ is a scalar and $\\mathbf{I}$ is the identity matrix. In this case, $\\mathbf{J}^{-T} = (1/c)\\mathbf{I}$, and the transformation simply scales the vector $\\mathbf{n}_0$. Normalization removes this scaling, so $\\widehat{\\mathbf{n}} = \\mathbf{n}_0$, resulting in zero error, $\\Delta\\theta = 0$. For distorted elements, $\\mathbf{J}$ is not a scaled identity matrix, leading to a non-zero orientation error that depends on both the element distortion and the initial angle $\\theta_0$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the shear band orientation error due to naive isoparametric mapping.\n    \"\"\"\n    # Define the derivatives of the shape functions at the centroid (xi, eta) = (0, 0).\n    # dN/d_xi for nodes 1, 2, 3, 4\n    dN_dxi = np.array([-0.25, 0.25, 0.25, -0.25])\n    # dN/d_eta for nodes 1, 2, 3, 4\n    dN_deta = np.array([-0.25, -0.25, 0.25, 0.25])\n\n    # Node ordering a=1,2,3,4 corresponds to parent nodes (xi,eta)=(-1,-1),(1,-1),(1,1),(-1,1).\n    # Element E0 (square)\n    E0_coords = (np.array([0., 1., 1., 0.]), np.array([0., 0., 1., 1.]))\n    # Element E1 (rectangle)\n    E1_coords = (np.array([0., 2., 2., 0.]), np.array([0., 0., 1., 1.]))\n    # Element E2 (skewed parallelogram)\n    E2_coords = (np.array([0., 2., 2., 0.]), np.array([0., 0.2, 1.2, 1.]))\n\n    # Define the test suite of elements and orientation angles.\n    elements = [E0_coords, E1_coords, E2_coords]\n    thetas = [0., np.pi/8, np.pi/4, 3*np.pi/8]\n\n    results = []\n\n    for x_coords, y_coords in elements:\n        # Calculate the Jacobian matrix J at the centroid.\n        J = np.zeros((2, 2))\n        J[0, 0] = np.dot(x_coords, dN_dxi)\n        J[0, 1] = np.dot(x_coords, dN_deta)\n        J[1, 0] = np.dot(y_coords, dN_dxi)\n        J[1, 1] = np.dot(y_coords, dN_deta)\n\n        # Calculate the inverse-transpose of the Jacobian.\n        try:\n            J_inv_T = np.linalg.inv(J).T\n        except np.linalg.LinAlgError:\n            results.extend([float('nan')] * len(thetas))\n            continue\n\n        for theta_0 in thetas:\n            # Define the true physical normal vector n_0.\n            n0 = np.array([np.cos(theta_0), np.sin(theta_0)])\n\n            # Calculate the predicted normal vector n_hat.\n            # v is the un-normalized predicted vector.\n            v = J_inv_T @ n0\n            \n            # Normalize v to get the unit vector n_hat.\n            norm_v = np.linalg.norm(v)\n            if norm_v  1e-15: \n                delta_theta_deg = 90.0\n            else:\n                n_hat = v / norm_v\n\n                # Calculate the orientation error delta_theta.\n                # We take the absolute value as per the problem to get the smallest angle in [0, pi/2].\n                cos_delta_theta = np.abs(np.dot(n0, n_hat))\n\n                # Clip the value to be within [-1, 1] to avoid domain errors in arccos\n                # due to floating point inaccuracies.\n                cos_delta_theta = np.clip(cos_delta_theta, -1.0, 1.0)\n                \n                delta_theta_rad = np.arccos(cos_delta_theta)\n                delta_theta_deg = np.rad2deg(delta_theta_rad)\n\n            # Round the result to six decimal places and append to the list.\n            results.append(round(delta_theta_deg, 6))\n\n    # Format the final output as a single line: [result1,result2,...]\n    # The expected output from running this code is:\n    # [0.0,0.0,0.0,0.0,0.0,17.073456,26.565051,19.29053,5.710593,12.75133,18.89274,21.801409]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}