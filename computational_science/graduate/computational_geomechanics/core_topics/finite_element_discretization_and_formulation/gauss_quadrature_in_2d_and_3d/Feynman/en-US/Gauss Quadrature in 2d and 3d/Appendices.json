{
    "hands_on_practices": [
        {
            "introduction": "This first practice solidifies your understanding of tensor-product rules, the foundation of quadrature on quadrilateral and hexahedral elements. By integrating a simple polynomial over a square reference element, you will apply the Gauss-Legendre rule in two dimensions and verify its exactness against the analytical solution. This exercise  reinforces the concepts of separability and the degree of precision, which are central to the efficiency of Gaussian quadrature.",
            "id": "3527331",
            "problem": "In computational geomechanics, volume integrals over reference elements frequently arise when assembling matrices in the Finite Element Method (FEM). Consider the reference square $[-1,1]^2$ associated with a bilinear quadrilateral element. Evaluate the integral\n$$\nI \\;=\\; \\int_{-1}^{1}\\int_{-1}^{1} x^{3}\\,y^{5}\\,dx\\,dy\n$$\nusing a tensor-product Gauss–Legendre quadrature with $3$ points per direction. Then compute the analytic value of the same integral directly from the definition of the Riemann integral and compare the two values to determine whether the quadrature rule is exact for this integrand. Express your final answer as a pure number with no units. No rounding is required.",
            "solution": "The problem requires the evaluation of the integral $I = \\int_{-1}^{1}\\int_{-1}^{1} x^{3}\\,y^{5}\\,dx\\,dy$ using two methods: first, a $3$-point tensor-product Gauss–Legendre quadrature, and second, direct analytical integration. The results are then to be compared.\n\nFirst, let us evaluate the integral analytically. The integrand, $f(x,y) = x^3 y^5$, is a separable function, meaning it can be written as a product of a function of $x$ and a function of $y$. Therefore, the double integral can be expressed as the product of two single integrals:\n$$\nI = \\left( \\int_{-1}^{1} x^{3}\\,dx \\right) \\left( \\int_{-1}^{1} y^{5}\\,dy \\right)\n$$\nWe evaluate each integral separately. The first integral is:\n$$\n\\int_{-1}^{1} x^{3}\\,dx = \\left[ \\frac{x^{4}}{4} \\right]_{-1}^{1} = \\frac{(1)^{4}}{4} - \\frac{(-1)^{4}}{4} = \\frac{1}{4} - \\frac{1}{4} = 0\n$$\nAlternatively, we recognize that the integrand $p(x) = x^3$ is an odd function, meaning $p(-x) = (-x)^3 = -x^3 = -p(x)$. The integral of any odd function over a symmetric interval, such as $[-1, 1]$, is always zero.\n\nSimilarly, for the second integral:\n$$\n\\int_{-1}^{1} y^{5}\\,dy = \\left[ \\frac{y^{6}}{6} \\right]_{-1}^{1} = \\frac{(1)^{6}}{6} - \\frac{(-1)^{6}}{6} = \\frac{1}{6} - \\frac{1}{6} = 0\n$$\nThe integrand $q(y) = y^5$ is also an odd function, so its integral over $[-1, 1]$ is zero.\n\nTherefore, the analytical value of the integral is:\n$$\nI = 0 \\times 0 = 0\n$$\n\nNext, we evaluate the integral using a $3$-point tensor-product Gauss–Legendre quadrature. The formula for the numerical approximation of the integral, which we denote $I_{GQ}$, is:\n$$\nI_{GQ} = \\int_{-1}^{1}\\int_{-1}^{1} f(x,y)\\,dx\\,dy \\approx \\sum_{i=1}^{3} \\sum_{j=1}^{3} w_i w_j f(x_i, y_j)\n$$\nwhere $\\{x_i\\}$ and $\\{y_j\\}$ are the Gauss points and $\\{w_i\\}$ and $\\{w_j\\}$ are the corresponding weights for the $3$-point rule. For Gauss-Legendre quadrature, the points are the roots of the Legendre polynomial of degree $n$, and the weights are derived from these roots. For $n=3$, the points and weights are:\nPoints ($\\xi_k$): $\\xi_1 = -\\sqrt{\\frac{3}{5}}$, $\\xi_2 = 0$, $\\xi_3 = \\sqrt{\\frac{3}{5}}$\nWeights ($w_k$): $w_1 = \\frac{5}{9}$, $w_2 = \\frac{8}{9}$, $w_3 = \\frac{5}{9}$\n\nSince the integrand $f(x,y) = x^3 y^5$ is separable, the double summation can also be separated:\n$$\nI_{GQ} = \\left( \\sum_{i=1}^{3} w_i x_i^3 \\right) \\left( \\sum_{j=1}^{3} w_j y_j^5 \\right)\n$$\nLet's compute the first summation:\n\\begin{align*} \\label{eq:1}\n\\sum_{i=1}^{3} w_i x_i^3 &= w_1 x_1^3 + w_2 x_2^3 + w_3 x_3^3 \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^3 + \\left(\\frac{8}{9}\\right) (0)^3 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^3 \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\frac{3}{5}\\sqrt{\\frac{3}{5}}\\right) + 0 + \\left(\\frac{5}{9}\\right) \\left(\\frac{3}{5}\\sqrt{\\frac{3}{5}}\\right) \\\\\n&= -\\frac{3}{9}\\sqrt{\\frac{3}{5}} + \\frac{3}{9}\\sqrt{\\frac{3}{5}} \\\\\n&= 0\n\\end{align*}\nNow, we compute the second summation:\n\\begin{align*} \\label{eq:2}\n\\sum_{j=1}^{3} w_j y_j^5 &= w_1 y_1^5 + w_2 y_2^5 + w_3 y_3^5 \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^5 + \\left(\\frac{8}{9}\\right) (0)^5 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^5 \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\left(\\frac{3}{5}\\right)^2\\sqrt{\\frac{3}{5}}\\right) + 0 + \\left(\\frac{5}{9}\\right) \\left(\\left(\\frac{3}{5}\\right)^2\\sqrt{\\frac{3}{5}}\\right) \\\\\n&= \\left(\\frac{5}{9}\\right) \\left(-\\frac{9}{25}\\sqrt{\\frac{3}{5}}\\right) + \\left(\\frac{5}{9}\\right) \\left(\\frac{9}{25}\\sqrt{\\frac{3}{5}}\\right) \\\\\n&= -\\frac{5}{25}\\sqrt{\\frac{3}{5}} + \\frac{5}{25}\\sqrt{\\frac{3}{5}} \\\\\n&= 0\n\\end{align*}\nThe value of the integral approximated by Gauss quadrature is therefore:\n$$\nI_{GQ} = 0 \\times 0 = 0\n$$\n\nFinally, we compare the two results. The analytical value is $I = 0$ and the value obtained via $3$-point Gauss-Legendre quadrature is $I_{GQ} = 0$. The values are identical.\n\nThis demonstrates that the quadrature rule is exact for this specific integrand. This is consistent with the theory of Gauss-Legendre quadrature. An $n$-point rule is exact for all polynomials of degree up to $2n-1$. For this problem, $n=3$, so the rule is exact for polynomials of degree up to $2(3)-1=5$. The tensor-product rule is exact for any polynomial $f(x,y)$ that is a linear combination of terms $x^i y^j$ where $i \\le 2n-1$ and $j \\le 2n-1$. Our integrand is $f(x,y)=x^3y^5$. The degree in $x$ is $3$, and the degree in $y$ is $5$. Since $3 \\le 5$ and $5 \\le 5$, the $3$-point rule is exact for both the $x$ and $y$ components of the integral, and thus the tensor-product rule is exact for the full integral.\n\nThe computed value for the integral is $0$.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "We now advance from the simplicity of tensor-product domains to triangular elements, which are essential for meshing complex geometries. This exercise  challenges you to work with a non-tensor-product symmetric quadrature rule defined in barycentric coordinates, a standard approach in finite element analysis. By comparing the numerical approximation to the exact integral of a polynomial, you will gain hands-on experience with the specialized rules required for non-Cartesian domains.",
            "id": "3527327",
            "problem": "In computational geomechanics, assembling element stiffness and mass matrices requires accurate evaluation of polynomial integrals over reference domains. Consider the standard reference triangle $T = \\{(x,y) \\in \\mathbb{R}^2 : x \\ge 0,\\ y \\ge 0,\\ x + y \\le 1\\}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$. Using the principles of Gaussian quadrature in two dimensions, evaluate the integral of the quadratic polynomial $x^2 + x y + y^2$ over $T$ by:\n- computing the analytical value via direct integration, and\n- computing the numerical value using a symmetric $7$-point triangular Gaussian quadrature rule that is exact for all polynomials up to total degree $5$.\n\nThe $7$-point rule is defined by the following nodes and weights, given in barycentric coordinates $(\\lambda_1,\\lambda_2,\\lambda_3)$ relative to the vertices $(0,0)$, $(1,0)$, and $(0,1)$, with the mapping $(x,y) = (\\lambda_2,\\lambda_3)$. The weights below are scaled to the area of $T$.\n- One centroid point: $(\\lambda_1,\\lambda_2,\\lambda_3) = \\left(\\frac{1}{3},\\frac{1}{3},\\frac{1}{3}\\right)$ with weight $w_1 = 0.1125$.\n- Three points with $\\alpha_1 = 0.101286507323456$ and $\\beta_1 = 1 - 2 \\alpha_1 = 0.797426985353088$, each with weight $w_2 = 0.062969590272413$, namely\n  $(\\alpha_1,\\alpha_1,\\beta_1)$, $(\\alpha_1,\\beta_1,\\alpha_1)$, $(\\beta_1,\\alpha_1,\\alpha_1)$.\n- Three points with $\\alpha_2 = 0.470142064105115$ and $\\beta_2 = 1 - 2 \\alpha_2 = 0.059715871789770$, each with weight $w_3 = 0.066197076394253$, namely\n  $(\\alpha_2,\\alpha_2,\\beta_2)$, $(\\alpha_2,\\beta_2,\\alpha_2)$, $(\\beta_2,\\alpha_2,\\alpha_2)$.\n\nCompute both the analytic and quadrature values and compare them to confirm exactness for the given integrand. Express the final answer as a single exact fraction for the integral over $T$. No rounding is required.",
            "solution": "The problem requires the evaluation of a two-dimensional integral over a standard reference triangle. The evaluation is to be performed by two methods: direct analytical integration and numerical integration using a specified $7$-point Gaussian quadrature rule.\n\nThe integral to be evaluated is:\n$$I = \\int_T (x^2 + xy + y^2) \\, dA$$\nwhere $T$ is the reference triangle defined by the vertices $(0,0)$, $(1,0)$, and $(0,1)$. The domain $T$ can be described by the inequalities $x \\ge 0$, $y \\ge 0$, and $x+y \\le 1$.\n\n**Part 1: Analytical Evaluation**\n\nWe compute the integral directly using iterated integration. The limits of integration are from $x=0$ to $x=1$, and for each $x$, from $y=0$ to $y=1-x$.\n\n$$I = \\int_{0}^{1} \\int_{0}^{1-x} (x^2 + xy + y^2) \\, dy \\, dx$$\n\nFirst, we integrate with respect to $y$:\n\\begin{align*} \\int_{0}^{1-x} (x^2 + xy + y^2) \\, dy &= \\left[ x^2y + \\frac{1}{2}xy^2 + \\frac{1}{3}y^3 \\right]_{y=0}^{y=1-x} \\\\ &= x^2(1-x) + \\frac{1}{2}x(1-x)^2 + \\frac{1}{3}(1-x)^3 \\\\ &= (x^2 - x^3) + \\frac{1}{2}x(1 - 2x + x^2) + \\frac{1}{3}(1 - 3x + 3x^2 - x^3) \\\\ &= x^2 - x^3 + \\frac{1}{2}x - x^2 + \\frac{1}{2}x^3 + \\frac{1}{3} - x + x^2 - \\frac{1}{3}x^3 \\\\ &= \\left(-1 + \\frac{1}{2} - \\frac{1}{3}\\right)x^3 + (1-1+1)x^2 + \\left(\\frac{1}{2} - 1\\right)x + \\frac{1}{3} \\\\ &= -\\frac{5}{6}x^3 + x^2 - \\frac{1}{2}x + \\frac{1}{3}\\end{align*}\nNext, we integrate this resulting polynomial with respect to $x$ from $0$ to $1$:\n\\begin{align*} I &= \\int_{0}^{1} \\left( -\\frac{5}{6}x^3 + x^2 - \\frac{1}{2}x + \\frac{1}{3} \\right) \\, dx \\\\ &= \\left[ -\\frac{5}{6}\\frac{x^4}{4} + \\frac{x^3}{3} - \\frac{1}{2}\\frac{x^2}{2} + \\frac{1}{3}x \\right]_{0}^{1} \\\\ &= -\\frac{5}{24} + \\frac{1}{3} - \\frac{1}{4} + \\frac{1}{3} \\\\ &= -\\frac{5}{24} + \\frac{2}{3} - \\frac{1}{4} \\end{align*}\nTo sum these fractions, we find a common denominator, which is $24$:\n$$I = \\frac{-5}{24} + \\frac{2 \\times 8}{24} - \\frac{1 \\times 6}{24} = \\frac{-5 + 16 - 6}{24} = \\frac{5}{24}$$\nThe analytical value of the integral is $\\frac{5}{24}$.\n\n**Part 2: Numerical Evaluation via Gaussian Quadrature**\n\nThe problem states that the $7$-point quadrature rule is exact for all polynomials up to total degree $5$. Since the integrand $f(x,y) = x^2 + xy + y^2$ is a polynomial of total degree $2$, we expect the numerical result to be identical to the analytical one. The quadrature formula is given by:\n$$I_Q = \\sum_{i=1}^{7} W_i f(x_i, y_i)$$\nwhere $(x_i, y_i)$ are the coordinates of the quadrature points and $W_i$ are the corresponding weights, scaled by the area of the triangle, $A = \\frac{1}{2}$. The problem requires an exact fractional answer, so we must use the exact algebraic values for the points and weights, which can be found in standard references.\n- Let $a = \\sqrt{15}$. The weights are $w_1 = \\frac{9}{80}$, $w_2 = \\frac{155-a}{2400}$, and $w_3 = \\frac{155+a}{2400}$.\n- The barycentric coordinates are given by $\\alpha_1 = \\frac{6-a}{21}$, $\\beta_1 = 1-2\\alpha_1$ and $\\alpha_2 = \\frac{6+a}{21}$, $\\beta_2 = 1-2\\alpha_2$.\n\nThe $7$ quadrature points and their contributions are:\n1. Centroid point $P_1$: Cartesian $(x_1,y_1) = (\\frac{1}{3},\\frac{1}{3})$.\n   $f(\\frac{1}{3}, \\frac{1}{3}) = (\\frac{1}{3})^2 + (\\frac{1}{3})(\\frac{1}{3}) + (\\frac{1}{3})^2 = \\frac{3}{9} = \\frac{1}{3}$.\n   Contribution: $W_1 f(x_1,y_1) = \\frac{9}{80} \\times \\frac{1}{3} = \\frac{3}{80}$.\n\n2. A group of $3$ points defined by permutations of $(\\beta_1, \\alpha_1, \\alpha_1)$. The Cartesian coordinates are $(\\alpha_1,\\alpha_1)$, $(\\beta_1,\\alpha_1)$, and $(\\alpha_1,\\beta_1)$. Each has weight $W_2=w_2$. By symmetry of $f(x,y)$, the total contribution from this group is $w_2 [f(\\alpha_1,\\alpha_1) + 2f(\\beta_1,\\alpha_1)]$.\n   $f(\\alpha_1,\\alpha_1) = 3\\alpha_1^2$.\n   $f(\\beta_1,\\alpha_1) = \\beta_1^2 + \\beta_1\\alpha_1 + \\alpha_1^2 = (1-2\\alpha_1)^2 + (1-2\\alpha_1)\\alpha_1 + \\alpha_1^2 = 3\\alpha_1^2 - 3\\alpha_1 + 1$.\n   The sum of function values is $S_f^{(1)} = 3\\alpha_1^2 + 2(3\\alpha_1^2 - 3\\alpha_1 + 1) = 9\\alpha_1^2 - 6\\alpha_1 + 2$.\n   Substituting $\\alpha_1 = \\frac{6-\\sqrt{15}}{21}$, we get $S_f^{(1)} = \\frac{65+2\\sqrt{15}}{49}$.\n   Contribution: $w_2 S_f^{(1)} = \\frac{155-\\sqrt{15}}{2400} \\times \\frac{65+2\\sqrt{15}}{49} = \\frac{10045 + 245\\sqrt{15}}{2400 \\times 49} = \\frac{49(205+5\\sqrt{15})}{2400 \\times 49} = \\frac{205+5\\sqrt{15}}{2400}$.\n\n3. A group of $3$ points defined by permutations of $(\\beta_2, \\alpha_2, \\alpha_2)$. The calculation is identical, replacing $\\alpha_1, w_2$ with $\\alpha_2, w_3$.\n   The sum of function values is $S_f^{(2)} = 9\\alpha_2^2 - 6\\alpha_2 + 2 = \\frac{65-2\\sqrt{15}}{49}$.\n   Contribution: $w_3 S_f^{(2)} = \\frac{155+\\sqrt{15}}{2400} \\times \\frac{65-2\\sqrt{15}}{49} = \\frac{10045 - 245\\sqrt{15}}{2400 \\times 49} = \\frac{49(205-5\\sqrt{15})}{2400 \\times 49} = \\frac{205-5\\sqrt{15}}{2400}$.\n\nTotal numerical integral $I_Q$:\n\\begin{align*} I_Q &= \\frac{3}{80} + \\frac{205+5\\sqrt{15}}{2400} + \\frac{205-5\\sqrt{15}}{2400} \\\\ &= \\frac{3}{80} + \\frac{205+5\\sqrt{15} + 205-5\\sqrt{15}}{2400} \\\\ &= \\frac{3}{80} + \\frac{410}{2400} = \\frac{3}{80} + \\frac{41}{240} \\end{align*}\nThe common denominator is $240$:\n$$I_Q = \\frac{3 \\times 3}{240} + \\frac{41}{240} = \\frac{9+41}{240} = \\frac{50}{240} = \\frac{5}{24}$$\n\nThe numerical value is $\\frac{5}{24}$, which is identical to the analytical value. This confirms the exactness property of the specified quadrature rule for the given quadratic polynomial.",
            "answer": "$$\\boxed{\\frac{5}{24}}$$"
        },
        {
            "introduction": "This final practice moves beyond merely applying quadrature rules to the vital task of verifying their correctness, a critical skill in computational science and code development. You are challenged to create a program to determine the degree of exactness for various rules on a tetrahedral element, the building block of 3D unstructured meshes . This involves deriving the analytical formula for monomial moments and implementing a numerical test, providing deep insight into the theoretical foundation and practical validation of these powerful numerical tools.",
            "id": "3527352",
            "problem": "You are given a family of three-dimensional Gauss-type quadrature rules intended for integrating scalar fields over the reference tetrahedron. Your task is to implement a program that, for each quadrature rule in a provided test suite, determines the largest nonnegative integer degree of exactness $p$ such that every monomial in the polynomial space $\\mathbb{P}_p$ is integrated to within machine precision by that rule. You must do this by checking moment conditions up to a sufficiently high degree and reporting the maximum $p$ for which all moment conditions hold to machine precision.\n\nFundamental base. Use only the following base facts to derive the necessary exact reference moments and the test procedure:\n- The reference tetrahedron is defined as $\\Omega = \\{(x,y,z) \\in \\mathbb{R}^3 \\mid x \\ge 0, y \\ge 0, z \\ge 0, x + y + z \\le 1\\}$, with volume $|\\Omega| = \\int_{\\Omega} 1 \\, dV$.\n- The degree of exactness $p$ of a quadrature rule is the greatest integer such that $\\int_{\\Omega} m(x,y,z) \\, dV$ equals the quadrature approximation $\\sum_{q=1}^{N_q} w_q \\, m(x_q,y_q,z_q)$ for all monomials $m(x,y,z) = x^i y^j z^k$ with $i,j,k \\in \\mathbb{N}_0$ and $i+j+k \\le p$.\n- For nonnegative integers $n$, the one-dimensional integral satisfies $\\int_0^{a} t^n \\, dt = \\dfrac{a^{n+1}}{n+1}$, which, together with Fubini’s theorem and the definition of $\\Omega$, is sufficient to derive the exact value of the monomial moment $\\int_{\\Omega} x^i y^j z^k \\, dV$.\n\nDefinition of “to machine precision”. For an exact target moment $M_{i,j,k}$ and its quadrature approximation $\\widehat{M}_{i,j,k}$, declare the moment condition satisfied if\n$$\n\\left|\\widehat{M}_{i,j,k} - M_{i,j,k}\\right| \\le \\tau(|M_{i,j,k}|),\n$$\nwhere the tolerance function is\n$$\n\\tau(|M|) = c \\, \\varepsilon_{\\mathrm{mach}} \\, \\max(1,|M|) + \\tau_0,\n$$\nwith $c = 64$, $\\varepsilon_{\\mathrm{mach}}$ equal to the machine epsilon of IEEE double precision arithmetic as provided by your programming environment, and $\\tau_0 = 10^{-14}$.\n\nAlgorithmic requirements.\n1. Derive, from the fundamental base above, a closed-form expression for $M_{i,j,k} = \\int_{\\Omega} x^i y^j z^k \\, dV$ for all nonnegative integers $i,j,k$.\n2. Implement a routine that, given a quadrature rule $\\{(w_q, x_q, y_q, z_q)\\}_{q=1}^{N_q}$, checks all monomial moments with total degree up to $d_{\\max}$, where $d_{\\max}$ is at least $10$, and returns the largest $p \\le d_{\\max}$ for which all monomials in $\\mathbb{P}_p$ satisfy the tolerance requirement.\n3. Use the following test suite of quadrature rules on the reference tetrahedron $\\Omega$. Each rule is provided as a list of quadrature points $(x_q,y_q,z_q)$ and corresponding weights $w_q$. All coordinates and weights are dimensionless.\n   - Test case A (single-point centroid rule, candidate degree $p=1$): \n     - One point at $(x,y,z) = \\left(\\dfrac{1}{4}, \\dfrac{1}{4}, \\dfrac{1}{4}\\right)$ with weight $w = \\dfrac{1}{6}$.\n   - Test case B (symmetric four-point rule, candidate degree $p=2$):\n     - Let $a = 0.5854101966249685$ and $b = 0.1381966011250105$. Use four points obtained from the barycentric tuples $(\\lambda_1,\\lambda_2,\\lambda_3,\\lambda_4)$ equal to the permutations of $(a,b,b,b)$, mapped to Cartesian coordinates via $(x,y,z) = (\\lambda_2,\\lambda_3,\\lambda_4)$ for the reference tetrahedron with vertices at $(0,0,0)$, $(1,0,0)$, $(0,1,0)$, $(0,0,1)$. These yield the four Cartesian points $(a,b,b)$, $(b,a,b)$, $(b,b,a)$, and $(b,b,b)$, each with equal weight $w = \\dfrac{1}{24}$.\n   - Test case C (off-centroid single-point rule, candidate degree $p=0$):\n     - One point at $(x,y,z) = (0.3, 0.2, 0.1)$ with weight $w = \\dfrac{1}{6}$.\n\nEdge cases and coverage. The test suite includes a rule expected to be exact for all polynomials of degree up to $1$, one up to $2$, and one only for constants. Your implementation must be robust to floating-point roundoff and correctly report the degree based on the stated tolerance model.\n\nFinal output format. Your program should produce a single line of output containing the results for the three test cases, in order A, B, C, as a comma-separated list enclosed in square brackets, for example $[p_A,p_B,p_C]$, where each $p_\\cdot$ is an integer. Your code must be fully self-contained and produce this single line with no additional text.",
            "solution": "The task is to determine the degree of exactness, $p$, for a given set of quadrature rules on the reference tetrahedron $\\Omega$. The degree of exactness is the largest non-negative integer $p$ such that the quadrature rule integrates all monomials $x^i y^j z^k$ with total degree $i+j+k \\le p$ to within a specified machine-precision tolerance.\n\nThe solution is developed in two principal stages:\n1.  Derivation of a closed-form expression for the exact value of the monomial moments over the reference tetrahedron.\n2.  Implementation of a numerical procedure to test the quadrature rules against these exact values for increasing polynomial degrees.\n\n**1. Derivation of the Exact Monomial Moment**\n\nThe exact moment for a monomial $m(x,y,z) = x^i y^j z^k$ over the reference tetrahedron $\\Omega$ is given by the integral:\n$$\nM_{i,j,k} = \\int_{\\Omega} x^i y^j z^k \\, dV\n$$\nThe reference tetrahedron is defined as $\\Omega = \\{(x,y,z) \\in \\mathbb{R}^3 \\mid x \\ge 0, y \\ge 0, z \\ge 0, x + y + z \\le 1\\}$. Using Fubini's theorem, this volume integral can be expressed as an iterated integral:\n$$\nM_{i,j,k} = \\int_{x=0}^{1} x^i \\left( \\int_{y=0}^{1-x} y^j \\left( \\int_{z=0}^{1-x-y} z^k \\, dz \\right) \\, dy \\right) \\, dx\n$$\nWe evaluate this integral from the inside out. The innermost integral with respect to $z$ is:\n$$\n\\int_0^{1-x-y} z^k \\, dz = \\left[ \\frac{z^{k+1}}{k+1} \\right]_0^{1-x-y} = \\frac{(1-x-y)^{k+1}}{k+1}\n$$\nNext, we substitute this into the middle integral with respect to $y$:\n$$\n\\int_0^{1-x} y^j \\frac{(1-x-y)^{k+1}}{k+1} \\, dy = \\frac{1}{k+1} \\int_0^{1-x} y^j (1-x-y)^{k+1} \\, dy\n$$\nThis integral can be solved using the Beta function identity, $\\int_0^c u^a (c-u)^b du = c^{a+b+1} \\frac{a!b!}{(a+b+1)!}$. With $c=1-x$, $u=y$, $a=j$, and $b=k+1$, the integral becomes:\n$$\n\\frac{1}{k+1} \\left( (1-x)^{j+k+2} \\frac{j!(k+1)!}{(j+k+3)!} \\right) = (1-x)^{j+k+2} \\frac{j!k!}{(j+k+2)!}\n$$\nFinally, we evaluate the outermost integral with respect to $x$:\n$$\n\\int_0^1 x^i \\left( (1-x)^{j+k+2} \\frac{j!k!}{(j+k+2)!} \\right) dx = \\frac{j!k!}{(j+k+2)!} \\int_0^1 x^i (1-x)^{j+k+2} dx\n$$\nUsing the Beta function identity again with $c=1$, $u=x$, $a=i$, and $b=j+k+2$, the integral is:\n$$\n\\frac{j!k!}{(j+k+2)!} \\left( 1^{i+j+k+3} \\frac{i!(j+k+2)!}{(i+j+k+3)!} \\right) = \\frac{i!j!k!}{(i+j+k+3)!}\n$$\nThus, the exact closed-form expression for the moment is:\n$$\nM_{i,j,k} = \\frac{i!j!k!}{(i+j+k+3)!}\n$$\nAs a check, for $(i,j,k)=(0,0,0)$, $M_{0,0,0}=\\frac{1}{3!}=\\frac{1}{6}$, which is the correct volume of $\\Omega$. For $(i,j,k)=(1,0,0)$, $M_{1,0,0}=\\frac{1}{4!}=\\frac{1}{24}$. The centroid's coordinate is $\\bar{x} = M_{1,0,0}/M_{0,0,0} = (1/24)/(1/6) = 1/4$, which is also correct.\n\n**2. Algorithm for Determining the Degree of Exactness**\n\nThe degree of exactness $p$ is determined by testing all moment conditions for successively higher total polynomial degrees. Let $d_{\\max}=10$ be the maximum degree to check.\n\nThe algorithm for a given quadrature rule, consisting of $N_q$ points $(x_q, y_q, z_q)$ and weights $w_q$, is as follows:\n\n1.  Initialize the degree of exactness $p_{found} = -1$.\n2.  Iterate through total polynomial degrees $d$ from $0$ to $d_{\\max}$.\n3.  For each degree $d$, iterate through all combinations of non-negative integers $(i,j,k)$ such that $i+j+k=d$.\n4.  For each monomial $x^i y^j z^k$:\n    a. Calculate the exact moment $M_{i,j,k} = \\frac{i!j!k!}{(i+j+k+3)!}$.\n    b. Calculate the quadrature approximation $\\widehat{M}_{i,j,k} = \\sum_{q=1}^{N_q} w_q x_q^i y_q^j z_q^k$.\n    c. Define the tolerance $\\tau(|M_{i,j,k}|) = c \\, \\varepsilon_{\\mathrm{mach}} \\, \\max(1, |M_{i,j,k}|) + \\tau_0$, with constants $c=64$, $\\varepsilon_{\\mathrm{mach}}$ as the machine epsilon for double precision, and $\\tau_0=10^{-14}$.\n    d. Check if the absolute error satisfies the condition: $|\\widehat{M}_{i,j,k} - M_{i,j,k}| \\le \\tau(|M_{i,j,k}|)$.\n    e. If the condition is not satisfied for any monomial of degree $d$, the rule is not exact for degree $d$. The degree of exactness is therefore $d-1$. We record this result and terminate checking for the current rule.\n5.  If all monomials of degree $d$ are integrated within tolerance, the rule is exact for at least degree $d$. We update $p_{found} = d$ and continue to the next degree $d+1$.\n6.  If the loop completes for all $d$ up to $d_{\\max}$, the degree of exactness is at least $d_{\\max}$, so we report $p_{found} = d_{\\max}$.\n\nThis procedure is applied to each of the three test cases provided. The problem is a test of the rule *as given*, using the floating-point constants directly.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding the degree of exactness for 3D quadrature rules\n    on the reference tetrahedron.\n    \"\"\"\n\n    # Define the machine precision environment from the problem statement\n    c = 64.0\n    eps_mach = np.finfo(float).eps\n    tau0 = 1e-14\n\n    # Define the quadrature rules for the test suite\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"points\": [(1/4, 1/4, 1/4)],\n            \"weights\": [1/6],\n        },\n        {\n            \"name\": \"B\",\n            \"points\": [\n                (0.5854101966249685, 0.1381966011250105, 0.1381966011250105),\n                (0.1381966011250105, 0.5854101966249685, 0.1381966011250105),\n                (0.1381966011250105, 0.1381966011250105, 0.5854101966249685),\n                (0.1381966011250105, 0.1381966011250105, 0.1381966011250105)\n            ],\n            \"weights\": [1/24, 1/24, 1/24, 1/24],\n        },\n        {\n            \"name\": \"C\",\n            \"points\": [(0.3, 0.2, 0.1)],\n            \"weights\": [1/6],\n        },\n    ]\n\n    memo_factorial = {i: math.factorial(i) for i in range(20)}\n\n    def exact_moment(i, j, k):\n        \"\"\"\n        Calculates the exact moment M_ijk = integral(x^i * y^j * z^k) dV over the\n        reference tetrahedron using the closed-form formula.\n        \"\"\"\n        num = memo_factorial[i] * memo_factorial[j] * memo_factorial[k]\n        den = memo_factorial[i + j + k + 3]\n        return num / den\n\n    def get_degree_of_exactness(rule, d_max):\n        \"\"\"\n        Determines the degree of exactness for a single quadrature rule.\n        \"\"\"\n        points = rule[\"points\"]\n        weights = rule[\"weights\"]\n        \n        for p in range(d_max + 1):\n            # Generate all monomials of total degree p\n            for i in range(p + 1):\n                for j in range(p - i + 1):\n                    k = p - i - j\n\n                    # Calculate exact and approximate moments\n                    m_exact = exact_moment(i, j, k)\n                    \n                    m_approx = 0.0\n                    for q in range(len(points)):\n                        x, y, z = points[q]\n                        w = weights[q]\n                        # Use np.power for safe exponentiation with base 0\n                        m_approx += w * (np.power(x, i) * np.power(y, j) * np.power(z, k))\n\n                    # Check against tolerance\n                    tolerance = c * eps_mach * max(1.0, abs(m_exact)) + tau0\n                    error = abs(m_approx - m_exact)\n                    \n                    if error > tolerance:\n                        return p - 1  # Failed at degree p, so exactness is p-1\n        \n        return d_max # Passed all tests up to d_max\n\n    results = []\n    d_max = 10\n    for case in test_cases:\n        p_exact = get_degree_of_exactness(case, d_max)\n        results.append(p_exact)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}