{
    "hands_on_practices": [
        {
            "introduction": "The radial return mapping algorithm is the cornerstone of computational plasticity, providing a robust method for integrating elastoplastic constitutive laws. This first practice focuses on the classic von Mises, or $J_2$, plasticity model, which is fundamental to describing the behavior of ductile metals and serves as a foundational model in geomechanics. By working through the predictor-corrector steps for a simple shear increment, you will gain hands-on experience with the essential mechanics of stress updates, from calculating a trial stress to enforcing the yield condition through a plastic correction. ",
            "id": "3531837",
            "problem": "Consider small-strain simple shear of an undrained, isotropic, rate-independent material modeled by von Mises plasticity based on the second invariant of deviatoric stress (commonly called $J_2$ plasticity) with linear isotropic hardening. The material follows linear isotropic elasticity for the elastic response, with shear modulus $G$ and bulk modulus sufficiently large that volumetric strain remains negligible over the increment. The plasticity model employs an associated flow rule and the hardening law $\\sigma_y(\\kappa) = \\sigma_{y0} + H \\kappa$, where $\\sigma_y$ is the current yield stress, $\\sigma_{y0}$ is the initial yield stress, $H$ is the linear isotropic hardening modulus, and $\\kappa$ is the equivalent plastic strain. The yield function is defined as $f(\\boldsymbol{\\sigma},\\kappa) = \\|\\boldsymbol{s}\\| - \\sqrt{2/3}\\,\\sigma_y(\\kappa)$, where $\\boldsymbol{s}$ is the deviatoric part of the Cauchy stress and $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}$. The plastic flow direction is $\\boldsymbol{n} = \\boldsymbol{s}/\\|\\boldsymbol{s}\\|$, and the backward Euler time discretization is used for the plastic strain increment, so that $\\Delta \\boldsymbol{\\varepsilon}^p = \\Delta \\lambda\\, \\boldsymbol{n}_{n+1}$ and $\\kappa_{n+1} = \\kappa_n + \\sqrt{2/3}\\,\\Delta \\lambda$, where $\\Delta \\lambda \\ge 0$ is the plastic multiplier.\n\nA single strain increment is applied from state $n$ to $n+1$ with only an engineering shear strain increment $\\Delta \\gamma$ nonzero, such that the small-strain tensor increment satisfies $\\Delta \\varepsilon_{12} = \\Delta \\varepsilon_{21} = \\Delta \\gamma/2$ and all other components of $\\Delta \\boldsymbol{\\varepsilon}$ are zero. The material parameters and initial conditions are:\n- Shear modulus $G = 25$ MPa.\n- Initial yield stress $\\sigma_{y0} = 0.2$ MPa.\n- Linear isotropic hardening modulus $H = 5$ MPa.\n- Initial equivalent plastic strain $\\kappa_n = 0$.\n- Initial stress $\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$ and initial plastic strain $\\boldsymbol{\\varepsilon}^p_n = \\boldsymbol{0}$.\n- Engineering shear strain increment $\\Delta \\gamma = 0.03$.\n\nImplement the radial return stress update with backward Euler integration for this simple shear increment. Compute the updated deviatoric shear stress component $s_{12,n+1}$ (which equals the Cauchy shear stress $\\sigma_{12,n+1}$ in pure shear) and the plastic multiplier $\\Delta \\lambda$. Express $s_{12,n+1}$ in MPa and $\\Delta \\lambda$ as dimensionless. Round both results to five significant figures. Provide the final numerical values as a row matrix $\\begin{pmatrix} s_{12,n+1} & \\Delta \\lambda \\end{pmatrix}$.",
            "solution": "The problem is validated as being scientifically grounded, well-posed, objective, and complete. It is a standard problem in computational plasticity that can be solved using the specified radial return algorithm. We proceed with the solution.\n\nThe solution process involves a standard predictor-corrector algorithm for the stress update. First, an elastic predictor step calculates a trial stress assuming the entire strain increment is elastic. Second, this trial stress is checked against the yield criterion. If yielding is indicated, a plastic corrector step is applied to return the stress state to the updated yield surface.\n\nThe initial state at step $n$ is given by:\nInitial stress: $\\boldsymbol{\\sigma}_n = \\boldsymbol{0}$, which implies the deviatoric stress is also zero, $\\boldsymbol{s}_n = \\boldsymbol{0}$.\nInitial equivalent plastic strain: $\\kappa_n = 0$.\n\nThe applied strain increment $\\Delta\\boldsymbol{\\varepsilon}$ for simple shear with an engineering shear strain increment $\\Delta \\gamma = 0.03$ is given by its non-zero components:\n$$ \\Delta \\varepsilon_{12} = \\Delta \\varepsilon_{21} = \\frac{\\Delta \\gamma}{2} = \\frac{0.03}{2} = 0.015 $$\nSince the trace of the strain increment tensor $\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}) = \\Delta\\varepsilon_{11} + \\Delta\\varepsilon_{22} + \\Delta\\varepsilon_{33} = 0$, the strain increment is purely deviatoric.\n\n**Step 1: Elastic Predictor**\n\nIn the predictor step, the entire strain increment is assumed to be elastic, so $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{0}$ and $\\Delta\\boldsymbol{\\varepsilon}^e = \\Delta\\boldsymbol{\\varepsilon}$. The trial deviatoric stress at step $n+1$, denoted $\\boldsymbol{s}^{\\text{trial}}_{n+1}$, is calculated using the elastic constitutive law:\n$$ \\boldsymbol{s}^{\\text{trial}}_{n+1} = \\boldsymbol{s}_n + 2G \\Delta\\boldsymbol{\\varepsilon}^e = \\boldsymbol{s}_n + 2G \\Delta\\boldsymbol{\\varepsilon} $$\nWith $\\boldsymbol{s}_n = \\boldsymbol{0}$ and $G=25$ MPa:\n$$ \\boldsymbol{s}^{\\text{trial}}_{n+1} = 2(25 \\text{ MPa}) \\Delta\\boldsymbol{\\varepsilon} = 50 \\Delta\\boldsymbol{\\varepsilon} $$\nThe only non-zero components of the trial deviatoric stress are:\n$$ s^{\\text{trial}}_{12,n+1} = s^{\\text{trial}}_{21,n+1} = 50 \\times 0.015 = 0.75 \\text{ MPa} $$\nThe norm of the trial deviatoric stress is calculated as $\\|\\boldsymbol{s}\\| = \\sqrt{\\boldsymbol{s}:\\boldsymbol{s}} = \\sqrt{s_{ij}s_{ij}}$:\n$$ \\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| = \\sqrt{(s^{\\text{trial}}_{12,n+1})^2 + (s^{\\text{trial}}_{21,n+1})^2} = \\sqrt{(0.75)^2 + (0.75)^2} = \\sqrt{2 \\times (0.75)^2} = 0.75\\sqrt{2} \\text{ MPa} $$\nNumerically, $\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| \\approx 1.06066$ MPa.\n\n**Step 2: Yield Check**\n\nWe check if this trial stress state lies outside the elastic domain defined by the yield function $f(\\boldsymbol{\\sigma},\\kappa) = \\|\\boldsymbol{s}\\| - \\sqrt{2/3}\\,\\sigma_y(\\kappa) \\le 0$. The check is performed using the yield stress at the beginning of the increment, $\\sigma_y(\\kappa_n)$.\nThe hardening law is $\\sigma_y(\\kappa) = \\sigma_{y0} + H \\kappa$. With $\\kappa_n=0$, $\\sigma_{y0}=0.2$ MPa and $H=5$ MPa:\n$$ \\sigma_y(\\kappa_n) = \\sigma_y(0) = \\sigma_{y0} = 0.2 \\text{ MPa} $$\nThe trial value of the yield function is:\n$$ f^{\\text{trial}} = \\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| - \\sqrt{\\frac{2}{3}} \\sigma_y(\\kappa_n) = 0.75\\sqrt{2} - \\sqrt{\\frac{2}{3}}(0.2) \\text{ MPa} $$\nNumerically, $f^{\\text{trial}} \\approx 1.06066 - 0.81650 \\times 0.2 \\approx 1.06066 - 0.16330 = 0.89736$ MPa.\nSince $f^{\\text{trial}} > 0$, the elastic predictor violates the yield condition, and a plastic correction is required.\n\n**Step 3: Plastic Corrector (Radial Return)**\n\nFor plastic loading, the plastic multiplier $\\Delta \\lambda$ must be greater than zero. For a backward Euler integration scheme, $\\Delta \\lambda$ is found from the consistency condition $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1}) = 0$. This leads to the following expression for $\\Delta \\lambda$:\n$$ \\Delta \\lambda = \\frac{f^{\\text{trial}}}{2G + \\frac{2}{3}H} = \\frac{\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\| - \\sqrt{\\frac{2}{3}}\\sigma_y(\\kappa_n)}{2G + \\frac{2}{3}H} $$\nSubstituting the given values:\n$$ \\Delta \\lambda = \\frac{0.75\\sqrt{2} - \\sqrt{\\frac{2}{3}}(0.2)}{2(25) + \\frac{2}{3}(5)} = \\frac{0.75\\sqrt{2} - 0.2\\sqrt{2/3}}{50 + 10/3} = \\frac{0.75\\sqrt{2} - 0.2\\sqrt{2/3}}{160/3} $$\nNumerically:\n$$ \\Delta \\lambda = \\frac{1.060660 - 0.163299}{53.333333} = \\frac{0.897361}{53.333333} = 0.0168255 $$\nRounding to five significant figures, we get $\\Delta \\lambda = 0.016826$.\n\n**Step 4: Stress Update**\n\nThe final deviatoric stress $\\boldsymbol{s}_{n+1}$ is found by returning the trial stress radially to the expanded yield surface. The return mapping equation is:\n$$ \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\text{trial}}_{n+1} - 2G\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{s}^{\\text{trial}}_{n+1} - 2G\\Delta\\lambda \\boldsymbol{n}_{n+1} $$\nwhere $\\boldsymbol{n}_{n+1} = \\boldsymbol{s}_{n+1}/\\|\\boldsymbol{s}_{n+1}\\|$. For radial return, the direction of the final stress is the same as the trial stress, so $\\boldsymbol{n}_{n+1} = \\boldsymbol{s}^{\\text{trial}}_{n+1}/\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|$.\nThe component $s_{12,n+1}$ is:\n$$ s_{12,n+1} = s^{\\text{trial}}_{12,n+1} - 2G\\Delta\\lambda \\frac{s^{\\text{trial}}_{12,n+1}}{\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|} $$\nSubstituting the values for $s^{\\text{trial}}_{12,n+1}$ and $\\|\\boldsymbol{s}^{\\text{trial}}_{n+1}\\|$:\n$$ s_{12,n+1} = 0.75 - 2(25)\\Delta\\lambda \\frac{0.75}{0.75\\sqrt{2}} = 0.75 - \\frac{50}{\\sqrt{2}}\\Delta\\lambda $$\nUsing the computed value of $\\Delta\\lambda = 0.0168255...$:\n$$ s_{12,n+1} = 0.75 - \\frac{50}{\\sqrt{2}}(0.0168255) = 0.75 - (35.355339)(0.0168255) = 0.75 - 0.594865 = 0.155135 \\text{ MPa} $$\nRounding to five significant figures, we get $s_{12,n+1} = 0.15513$ MPa. Since the problem starts from a zero stress state and the strain increment is purely deviatoric, the mean stress remains zero, so $\\sigma_{12,n+1} = s_{12,n+1}$.\n\nThe final requested values are $s_{12,n+1}$ and $\\Delta \\lambda$.\n- $s_{12,n+1} = 0.15513$ MPa\n- $\\Delta \\lambda = 0.016826$\nWe present these in a row matrix as requested.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.15513 & 0.016826 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While smooth yield surfaces like the von Mises criterion are fundamental, many geomaterials exhibit more complex behaviors, such as an inability to withstand tension. This exercise introduces the concept of a tension cut-off, a critical feature in realistic soil and rock models, and demonstrates its implementation using the elegant and powerful method of spectral decomposition. By operating directly on the principal stresses of the trial state, this return mapping algorithm provides an efficient way to handle the non-smooth nature of the \"no-tension\" yield surface, a skill essential for simulating problems like excavation and unloading. ",
            "id": "3531831",
            "problem": "Implement a small-strain stress update with a tension cut-off for soils to prevent spurious tensile stresses during unloading (e.g., excavation). Use the following assumptions and requirements to derive and implement the algorithm.\n\nAssumptions and fundamental base:\n- Adopt the standard small-strain kinematics with the symmetric strain tensor $\\boldsymbol{\\varepsilon}$ and the Cauchy stress tensor $\\boldsymbol{\\sigma}$.\n- Use isotropic linear elasticity for the elastic predictor with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The elastic stiffness is defined by the Lamé parameters $\\lambda$ and $\\mu$, with $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$, and $\\boldsymbol{\\sigma} = \\lambda \\, \\text{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$, where $\\mathbf{I}$ is the second-order identity tensor and $\\text{tr}(\\cdot)$ is the trace.\n- Adopt the sign convention where tensile stresses are positive and compressive stresses are negative.\n- Model the soil as a no-tension material: at the end of the increment, the updated stress must lie in the admissible set $\\mathcal{K}$ defined by the requirement that all principal stresses are non-positive, i.e., the tensor is negative semidefinite.\n\nTask:\n- Given the previous stress state $\\boldsymbol{\\sigma}_n$ and a prescribed strain increment $\\Delta \\boldsymbol{\\varepsilon}$ over a time step, compute the elastic trial stress\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon},\n$$\nwhere $\\mathbb{C}$ is the fourth-order isotropic elastic tensor determined by $E$ and $\\nu$.\n- Enforce the tension cut-off by returning (projecting) $\\boldsymbol{\\sigma}^{\\text{tr}}$ to the admissible set $\\mathcal{K}$ in a way that is consistent with energy minimization and does not produce tensile principal stresses. Formulate the return as the closest-point projection in the Frobenius norm:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\operatorname*{arg\\,min}_{\\boldsymbol{\\sigma} \\in \\mathcal{K}} \\tfrac{1}{2}\\|\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\text{tr}}\\|_F^2.\n$$\n- Compute the three principal stresses of $\\boldsymbol{\\sigma}_{n+1}$ and sort them in descending order.\n\nPhysical and numerical units:\n- All stresses must be reported in kilopascals (kPa).\n- Angles do not appear in this problem.\n- Express the final answers as floats rounded to three decimal places in kPa.\n\nTest suite:\nUse $E = 50\\,\\text{MPa}$ and $\\nu = 0.3$ for all cases. Use the identity tensor $\\mathbf{I}$ for isotropic states and the standard small-strain relation for shear where an engineering shear $\\gamma$ corresponds to $\\varepsilon_{12} = \\varepsilon_{21} = \\gamma/2$.\n\nDefine the following four test cases, each specified by $(\\boldsymbol{\\sigma}_n, \\Delta \\boldsymbol{\\varepsilon})$:\n\n- Test case $1$ (compressive loading, elastic admissible):\n  - $\\boldsymbol{\\sigma}_n = -100\\,\\text{kPa}\\,\\mathbf{I}$,\n  - $\\Delta \\boldsymbol{\\varepsilon} = -10^{-4}\\,\\mathbf{I}$.\n\n- Test case $2$ (excavation-type unloading to tension, needs cut-off):\n  - $\\boldsymbol{\\sigma}_n = -100\\,\\text{kPa}\\,\\mathbf{I}$,\n  - $\\Delta \\boldsymbol{\\varepsilon} = 3 \\times 10^{-3}\\,\\mathbf{I}$.\n\n- Test case $3$ (pure shear from zero stress, mixed principal states, needs cut-off):\n  - $\\boldsymbol{\\sigma}_n = \\mathbf{0}$,\n  - Engineering shear $\\gamma = 10^{-4}$ in the $1$-$2$ plane, i.e., $\\Delta \\boldsymbol{\\varepsilon}_{12} = \\Delta \\boldsymbol{\\varepsilon}_{21} = \\gamma/2$ and other components zero.\n\n- Test case $4$ (boundary case to the cut-off surface):\n  - $\\boldsymbol{\\sigma}_n = -50\\,\\text{kPa}\\,\\mathbf{I}$,\n  - $\\Delta \\boldsymbol{\\varepsilon} = 4 \\times 10^{-4}\\,\\mathbf{I}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a list of length $4$ (one per test case).\n- Each entry is a list of the three principal stresses of $\\boldsymbol{\\sigma}_{n+1}$ in kPa, rounded to three decimal places and sorted in descending order.\n- The exact format is a single line like\n  $$\n  [ [s_{1,1}, s_{1,2}, s_{1,3}], [s_{2,1}, s_{2,2}, s_{2,3}], [s_{3,1}, s_{3,2}, s_{3,3}], [s_{4,1}, s_{4,2}, s_{4,3}] ]\n  $$\n  printed as a Python list literal with no additional text.",
            "solution": "The problem requires the implementation of a stress update algorithm for an isotropic linear elastic material subject to a tension cut-off condition. This is a classic problem in computational plasticity, specifically for a Rankine or no-tension material model, commonly used for geomaterials like soil or rock which exhibit negligible tensile strength. The solution will be derived and implemented based on a return mapping algorithm, which enforces the constitutive constraint via a closest-point projection in stress space. Tensile stresses are taken as positive.\n\n**1. Constitutive Framework**\n\nThe material behavior is described by two components:\n-   **Elasticity**: Governed by isotropic linear elasticity. The stress tensor $\\boldsymbol{\\sigma}$ is related to the strain tensor $\\boldsymbol{\\varepsilon}$ by Hooke's law, which can be written using Lamé's parameters, $\\lambda$ and $\\mu$:\n    $$\n    \\boldsymbol{\\sigma} = \\lambda \\, \\text{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}\n    $$\n    where $\\mathbf{I}$ is the second-order identity tensor. The material parameters $E=50\\,\\text{MPa} = 50000\\,\\text{kPa}$ and $\\nu=0.3$ yield:\n    $$\n    \\mu = \\frac{E}{2(1+\\nu)} = \\frac{50000\\,\\text{kPa}}{2(1+0.3)} = \\frac{25000}{1.3} = \\frac{250000}{13}\\,\\text{kPa} \\approx 19230.769\\,\\text{kPa}\n    $$\n    $$\n    \\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)} = \\frac{50000\\,\\text{kPa} \\cdot 0.3}{(1+0.3)(1-2 \\cdot 0.3)} = \\frac{15000}{1.3 \\cdot 0.4} = \\frac{15000}{0.52} = \\frac{375000}{13}\\,\\text{kPa} \\approx 28846.154\\,\\text{kPa}\n    $$\n\n-   **Tension Cut-off**: The material cannot sustain tensile stresses. This is formulated as a constraint on the updated stress tensor $\\boldsymbol{\\sigma}_{n+1}$. Its principal stresses, denoted by $\\sigma_1, \\sigma_2, \\sigma_3$, must all be non-positive. This defines the admissible stress set $\\mathcal{K}$:\n    $$\n    \\mathcal{K} = \\{ \\boldsymbol{\\sigma} \\in \\mathbb{S}^3 \\, | \\, \\sigma_i(\\boldsymbol{\\sigma}) \\le 0, \\forall i=1,2,3 \\}\n    $$\n    where $\\mathbb{S}^3$ is the space of symmetric second-order tensors in three dimensions.\n\n**2. Return Mapping Algorithm**\n\nThe stress update is performed in two steps: an elastic predictor and a plastic corrector (return mapping).\n\n-   **Elastic Predictor**: Given the stress state $\\boldsymbol{\\sigma}_n$ at the beginning of the increment and a strain increment $\\Delta\\boldsymbol{\\varepsilon}$, we first compute an elastic trial stress $\\boldsymbol{\\sigma}^{\\text{tr}}$. This assumes the material response is purely elastic over the increment:\n    $$\n    \\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}_n + \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon} = \\boldsymbol{\\sigma}_n + \\lambda \\, \\text{tr}(\\Delta \\boldsymbol{\\varepsilon}) \\mathbf{I} + 2 \\mu \\, \\Delta \\boldsymbol{\\varepsilon}\n    $$\n\n-   **Plastic Corrector**: If $\\boldsymbol{\\sigma}^{\\text{tr}}$ violates the tension cut-off condition (i.e., $\\boldsymbol{\\sigma}^{\\text{tr}} \\notin \\mathcal{K}$), it must be \"returned\" or \"projected\" onto the admissible set $\\mathcal{K}$. The problem specifies this projection as the one that minimizes the distance in the Frobenius norm, a standard choice ensuring energy consistency:\n    $$\n    \\boldsymbol{\\sigma}_{n+1} = \\operatorname*{arg\\,min}_{\\boldsymbol{\\sigma} \\in \\mathcal{K}} \\tfrac{1}{2}\\|\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}^{\\text{tr}}\\|_F^2\n    $$\n    This is a closest-point projection of $\\boldsymbol{\\sigma}^{\\text{tr}}$ onto the convex set $\\mathcal{K}$.\n\n**3. Spectral Projection**\n\nThe key to solving this minimization problem lies in spectral decomposition. The Frobenius norm and the admissibility condition are both isotropic functions of the stress tensor, meaning they depend only on its principal values (eigenvalues), not its principal directions (eigenvectors). Consequently, the projected stress $\\boldsymbol{\\sigma}_{n+1}$ shares the same principal directions as the trial stress $\\boldsymbol{\\sigma}^{\\text{tr}}$.\n\nLet the spectral decomposition of the trial stress be:\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\sum_{i=1}^3 \\sigma_i^{\\text{tr}} \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\nwhere $\\sigma_i^{\\text{tr}}$ are the principal stresses of $\\boldsymbol{\\sigma}^{\\text{tr}}$ and $\\mathbf{n}_i$ are the corresponding orthonormal principal directions. The updated stress $\\boldsymbol{\\sigma}_{n+1}$ has the form:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\sum_{i=1}^3 \\sigma_{i, n+1} \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\nThe optimization problem decouples into three independent one-dimensional problems for the principal stresses:\n$$\n\\sigma_{i, n+1} = \\operatorname*{arg\\,min}_{\\sigma_i \\le 0} (\\sigma_i - \\sigma_i^{\\text{tr}})^2 \\quad \\text{for } i=1,2,3\n$$\nThe solution is a simple projection onto the non-positive real axis:\n-   If $\\sigma_i^{\\text{tr}} \\le 0$, the trial value is already admissible, so $\\sigma_{i, n+1} = \\sigma_i^{\\text{tr}}$.\n-   If $\\sigma_i^{\\text{tr}} > 0$, the trial value is inadmissible, and the closest admissible point is $0$, so $\\sigma_{i, n+1} = 0$.\n\nThis can be expressed compactly as:\n$$\n\\sigma_{i, n+1} = \\min(\\sigma_i^{\\text{tr}}, 0)\n$$\n\n**Algorithm Summary:**\n1.  For each test case, given $\\boldsymbol{\\sigma}_n$ and $\\Delta\\boldsymbol{\\varepsilon}$, compute the trial stress tensor $\\boldsymbol{\\sigma}^{\\text{tr}}$.\n2.  Compute the principal stresses (eigenvalues) of $\\boldsymbol{\\sigma}^{\\text{tr}}$, let them be $\\{\\sigma_1^{\\text{tr}}, \\sigma_2^{\\text{tr}}, \\sigma_3^{\\text{tr}}\\}$.\n3.  Apply the tension cut-off to each principal trial stress: $\\sigma_{i, n+1} = \\min(\\sigma_i^{\\text{tr}}, 0)$.\n4.  The set $\\{\\sigma_{1, n+1}, \\sigma_{2, n+1}, \\sigma_{3, n+1}\\}$ constitutes the principal stresses of the final updated stress $\\boldsymbol{\\sigma}_{n+1}$.\n5.  Sort these final principal stresses in descending order and round to three decimal places.\n\n**Calculations for Test Cases:**\n\n**Case 1:** $\\boldsymbol{\\sigma}_n = -100\\,\\mathbf{I}$, $\\Delta\\boldsymbol{\\varepsilon} = -10^{-4}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = -3 \\times 10^{-4}$. The stress increment is isotropic: $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (-3 \\times 10^{-4}) + 2\\mu \\cdot (-10^{-4}))\\mathbf{I} = -12.5\\,\\mathbf{I}\\,\\text{kPa}$.\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -100\\,\\mathbf{I} - 12.5\\,\\mathbf{I} = -112.5\\,\\mathbf{I}\\,\\text{kPa}$.\nPrincipal stresses of $\\boldsymbol{\\sigma}^{\\text{tr}}$ are $\\{-112.5, -112.5, -112.5\\}$. All are $\\le 0$, so no projection is needed.\nFinal principal stresses, sorted descending: $[-112.500, -112.500, -112.500]$.\n\n**Case 2:** $\\boldsymbol{\\sigma}_n = -100\\,\\mathbf{I}$, $\\Delta\\boldsymbol{\\varepsilon} = 3 \\times 10^{-3}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 9 \\times 10^{-3}$. The stress increment is $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (9 \\times 10^{-3}) + 2\\mu \\cdot (3 \\times 10^{-3}))\\mathbf{I} = 375\\,\\mathbf{I}\\,\\text{kPa}$.\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -100\\,\\mathbf{I} + 375\\,\\mathbf{I} = 275\\,\\mathbf{I}\\,\\text{kPa}$.\nPrincipal stresses of $\\boldsymbol{\\sigma}^{\\text{tr}}$ are $\\{275, 275, 275\\}$. All are $> 0$.\nProjected principal stresses: $\\{\\min(275, 0), \\min(275, 0), \\min(275, 0)\\} = \\{0, 0, 0\\}$.\nFinal principal stresses, sorted descending: $[0.000, 0.000, 0.000]$.\n\n**Case 3:** $\\boldsymbol{\\sigma}_n = \\mathbf{0}$, pure shear $\\gamma=10^{-4}$\n$\\Delta\\varepsilon_{12} = \\Delta\\varepsilon_{21} = 0.5 \\times 10^{-4}$, other components zero. $\\text{tr}(\\Delta\\boldsymbol{\\varepsilon})=0$.\n$\\boldsymbol{\\sigma}^{\\text{tr}} = 2\\mu\\Delta\\boldsymbol{\\varepsilon}$. The only non-zero component is $\\sigma^{\\text{tr}}_{12} = \\sigma^{\\text{tr}}_{21} = 2\\mu \\Delta\\varepsilon_{12} = \\mu \\gamma = \\frac{250000}{13} \\cdot 10^{-4} = \\frac{25}{13} \\approx 1.923\\,\\text{kPa}$.\nThe principal stresses of this pure shear state are $\\{ \\sigma^{\\text{tr}}_{12}, 0, -\\sigma^{\\text{tr}}_{12} \\} = \\{25/13, 0, -25/13\\}$.\nProjected principal stresses: $\\{\\min(25/13, 0), \\min(0, 0), \\min(-25/13, 0)\\} = \\{0, 0, -25/13\\}$.\nFinal principal stresses, sorted descending: $[0.000, 0.000, -1.923]$.\n\n**Case 4:** $\\boldsymbol{\\sigma}_n = -50\\,\\mathbf{I}$, $\\Delta\\boldsymbol{\\varepsilon} = 4 \\times 10^{-4}\\,\\mathbf{I}$\n$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 12 \\times 10^{-4}$. The stress increment is $\\Delta\\boldsymbol{\\sigma} = (\\lambda \\cdot (12 \\times 10^{-4}) + 2\\mu \\cdot (4 \\times 10^{-4}))\\mathbf{I} = 50\\,\\mathbf{I}\\,\\text{kPa}$.\n$\\boldsymbol{\\sigma}^{\\text{tr}} = -50\\,\\mathbf{I} + 50\\,\\mathbf{I} = \\mathbf{0}\\,\\text{kPa}$.\nPrincipal stresses of $\\boldsymbol{\\sigma}^{\\text{tr}}$ are $\\{0, 0, 0\\}$. All are $\\le 0$. No projection needed.\nFinal principal stresses, sorted descending: $[0.000, 0.000, 0.000]$.",
            "answer": "[[-112.500, -112.500, -112.500], [0.000, 0.000, 0.000], [0.000, 0.000, -1.923], [0.000, 0.000, 0.000]]"
        },
        {
            "introduction": "A robust constitutive algorithm is only one part of a successful simulation; its interaction with the global time integration scheme is equally critical. This practice shifts focus from the mechanics of the stress update to the numerical stability of the overall solution, a paramount concern in explicit finite element analyses common in geomechanics. By analyzing the eigenvalues of a linearized hypoplastic model, you will learn how to derive the maximum stable time step for a forward Euler integration scheme, directly linking the material's stiffness to the global simulation parameters and ensuring the reliability of your numerical results. ",
            "id": "3531860",
            "problem": "Consider a two-dimensional plane-strain stress update for a hypoplastic sand model under a constant high strain-rate loading. Let the Cauchy stress vector be arranged as $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy}]^{\\mathsf{T}}$. The hypoplastic model prescribes a stress rate of the form $\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{h}(\\boldsymbol{\\sigma}, \\dot{\\boldsymbol{\\varepsilon}}, \\rho)$, where $\\dot{\\boldsymbol{\\varepsilon}}$ is the strain-rate tensor and $\\rho$ is the density. Under a rapid monotonic loading scenario with approximately constant $\\dot{\\boldsymbol{\\varepsilon}}$ and negligible density change over the time step, a first-order linearization about the current state $(\\boldsymbol{\\sigma}_{n}, \\dot{\\boldsymbol{\\varepsilon}})$ gives\n$$\n\\dot{\\boldsymbol{\\sigma}} \\approx \\boldsymbol{A}\\,\\boldsymbol{\\sigma} + \\boldsymbol{c},\n$$\nwhere $\\boldsymbol{A} \\in \\mathbb{R}^{3 \\times 3}$ is the algorithmic tangent matrix (the Jacobian of the stress-rate function with respect to stress at the current state) with entries having units of $\\mathrm{s}^{-1}$, and $\\boldsymbol{c}$ is a constant vector depending on $\\dot{\\boldsymbol{\\varepsilon}}$ and the current state.\n\nAn explicit forward Euler stress update implements\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n} + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}_{n},\n$$\nwith constant time step $\\Delta t > 0$. To assess stability with respect to growth of perturbations under the linearized homogeneous dynamics (i.e., neglecting $\\boldsymbol{c}$), start from the homogeneous part of the linearized system $\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{A}\\,\\boldsymbol{\\sigma}$ and derive the condition on $\\Delta t$ ensuring that the explicit update does not amplify any modal component of $\\boldsymbol{\\sigma}$.\n\nFor a representative dense hypoplastic sand state under plane strain, the algorithmic tangent is given by\n$$\n\\boldsymbol{A} =\n\\begin{pmatrix}\n-1200 & 300 & 0 \\\\\n-500 & -800 & 0 \\\\\n0 & 0 & -1600\n\\end{pmatrix}\n\\quad \\text{with entries in } \\mathrm{s}^{-1}.\n$$\nUsing only first principles of linear stability for explicit time integration of linear systems, determine the largest stable time step $\\Delta t_{\\max}$ for the forward Euler stress update applied to the above $\\boldsymbol{A}$. Your derivation should proceed from the explicit update mapping and the eigenstructure of $\\boldsymbol{A}$, and should account for potentially complex eigenvalues arising from the non-symmetric tangent.\n\nReport the final value of $\\Delta t_{\\max}$ rounded to four significant figures, and express your answer in seconds.",
            "solution": "The problem requires the determination of the largest stable time step, $\\Delta t_{\\max}$, for a forward Euler stress update of a linearized hypoplastic constitutive model. The analysis is based on the principles of linear stability for the numerical integration of systems of ordinary differential equations (ODEs).\n\nThe evolution of the stress state, neglecting the constant term $\\boldsymbol{c}$ for stability analysis, is governed by the homogeneous linear system of ODEs:\n$$\n\\dot{\\boldsymbol{\\sigma}} = \\boldsymbol{A}\\,\\boldsymbol{\\sigma}\n$$\nThe explicit forward Euler method is used to integrate this system over a time step $\\Delta t$. The update rule from state $\\boldsymbol{\\sigma}_n$ at time $t_n$ to state $\\boldsymbol{\\sigma}_{n+1}$ at time $t_{n+1} = t_n + \\Delta t$ is given by:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n} + \\Delta t\\,\\dot{\\boldsymbol{\\sigma}}_{n}\n$$\nSubstituting the governing ODE, we have:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{n} + \\Delta t(\\boldsymbol{A}\\,\\boldsymbol{\\sigma}_{n}) = (\\boldsymbol{I} + \\Delta t\\,\\boldsymbol{A})\\,\\boldsymbol{\\sigma}_{n}\n$$\nwhere $\\boldsymbol{I}$ is the $3 \\times 3$ identity matrix. The matrix $\\boldsymbol{G} = \\boldsymbol{I} + \\Delta t\\,\\boldsymbol{A}$ is known as the amplification matrix, as it maps the solution from one time step to the next.\n\nFor the numerical scheme to be stable, any initial perturbation must not be amplified over subsequent time steps. This requires that the spectral radius of the amplification matrix, $\\rho(\\boldsymbol{G})$, be no greater than one. The spectral radius is the maximum of the magnitudes of the eigenvalues of $\\boldsymbol{G}$:\n$$\n\\rho(\\boldsymbol{G}) = \\max_{k} |\\lambda_k(\\boldsymbol{G})| \\le 1\n$$\nLet $\\lambda_k$ be an eigenvalue of the matrix $\\boldsymbol{A}$ with corresponding eigenvector $\\boldsymbol{v}_k$. Then $\\boldsymbol{A}\\boldsymbol{v}_k = \\lambda_k \\boldsymbol{v}_k$. The action of $\\boldsymbol{G}$ on $\\boldsymbol{v}_k$ is:\n$$\n\\boldsymbol{G}\\boldsymbol{v}_k = (\\boldsymbol{I} + \\Delta t\\,\\boldsymbol{A})\\boldsymbol{v}_k = \\boldsymbol{v}_k + \\Delta t(\\boldsymbol{A}\\boldsymbol{v}_k) = \\boldsymbol{v}_k + \\Delta t(\\lambda_k \\boldsymbol{v}_k) = (1 + \\Delta t\\,\\lambda_k)\\boldsymbol{v}_k\n$$\nThis demonstrates that the eigenvalues of $\\boldsymbol{G}$ are related to the eigenvalues of $\\boldsymbol{A}$ by $\\lambda_k(\\boldsymbol{G}) = 1 + \\Delta t\\,\\lambda_k$. The stability condition thus becomes:\n$$\n|1 + \\Delta t\\,\\lambda_k| \\le 1 \\quad \\text{for all eigenvalues } \\lambda_k \\text{ of } \\boldsymbol{A}\n$$\nThis inequality defines the stability region for the forward Euler method. For a complex number $z = \\Delta t\\,\\lambda_k$, this region is a disk of radius $1$ centered at $(-1, 0)$ in the complex plane. We must find the largest $\\Delta t > 0$ such that $z_k = \\Delta t\\,\\lambda_k$ lies within this disk for all eigenvalues $\\lambda_k$.\n\nThe next step is to compute the eigenvalues of the given algorithmic tangent matrix $\\boldsymbol{A}$:\n$$\n\\boldsymbol{A} =\n\\begin{pmatrix}\n-1200 & 300 & 0 \\\\\n-500 & -800 & 0 \\\\\n0 & 0 & -1600\n\\end{pmatrix}\n$$\nThis matrix is block-diagonal. One eigenvalue can be read directly from the bottom-right $1 \\times 1$ block:\n$$\n\\lambda_1 = -1600 \\, \\mathrm{s}^{-1}\n$$\nThe other two eigenvalues are determined by the top-left $2 \\times 2$ block:\n$$\n\\boldsymbol{A}_{sub} =\n\\begin{pmatrix}\n-1200 & 300 \\\\\n-500 & -800\n\\end{pmatrix}\n$$\nThe characteristic equation is $\\det(\\boldsymbol{A}_{sub} - \\lambda \\boldsymbol{I}) = 0$:\n$$\n(-1200 - \\lambda)(-800 - \\lambda) - (300)(-500) = 0\n$$\n$$\n\\lambda^2 + 2000\\lambda + 960000 + 150000 = 0\n$$\n$$\n\\lambda^2 + 2000\\lambda + 1110000 = 0\n$$\nUsing the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\n\\lambda_{2,3} = \\frac{-2000 \\pm \\sqrt{2000^2 - 4(1)(1110000)}}{2} = \\frac{-2000 \\pm \\sqrt{4000000 - 4440000}}{2}\n$$\n$$\n\\lambda_{2,3} = \\frac{-2000 \\pm \\sqrt{-440000}}{2} = \\frac{-2000 \\pm 200i\\sqrt{11}}{2} = -1000 \\pm 100i\\sqrt{11} \\, \\mathrm{s}^{-1}\n$$\nNow we apply the stability condition to each eigenvalue.\n\nFor the real eigenvalue $\\lambda_1 = -1600$:\nThe condition is $|1 + \\Delta t(-1600)| \\le 1$, which is $|1 - 1600\\Delta t| \\le 1$. This is equivalent to $-1 \\le 1 - 1600\\Delta t \\le 1$.\nThe right part of the inequality, $1 - 1600\\Delta t \\le 1$, implies $-1600\\Delta t \\le 0$, which is always true for $\\Delta t > 0$.\nThe left part, $-1 \\le 1 - 1600\\Delta t$, implies $-2 \\le -1600\\Delta t$, or $2 \\ge 1600\\Delta t$. This gives the constraint:\n$$\n\\Delta t \\le \\frac{2}{1600} = \\frac{1}{800} \\, \\mathrm{s}\n$$\n\nFor the complex conjugate pair $\\lambda_{2,3} = -1000 \\pm 100i\\sqrt{11}$:\nLet $\\lambda = x+iy$ where $x = -1000$ and $y = \\pm 100\\sqrt{11}$. The stability condition $|1 + \\Delta t\\,\\lambda| \\le 1$ becomes $|(1+\\Delta t\\,x) + i(\\Delta t\\,y)| \\le 1$. Squaring the magnitude:\n$$\n(1+\\Delta t\\,x)^2 + (\\Delta t\\,y)^2 \\le 1\n$$\n$$\n1 + 2\\Delta t\\,x + (\\Delta t)^2 x^2 + (\\Delta t)^2 y^2 \\le 1\n$$\n$$\n2\\Delta t\\,x + (\\Delta t)^2 (x^2+y^2) \\le 0\n$$\nSince $\\Delta t > 0$, we can divide by it:\n$$\n2x + \\Delta t(x^2+y^2) \\le 0\n$$\nThis gives the constraint $\\Delta t \\le \\frac{-2x}{x^2+y^2}$. We compute $x^2+y^2 = |\\lambda|^2$:\n$$\n|\\lambda|^2 = (-1000)^2 + (100\\sqrt{11})^2 = 1000000 + 10000 \\times 11 = 1110000\n$$\nThe constraint on $\\Delta t$ is:\n$$\n\\Delta t \\le \\frac{-2(-1000)}{1110000} = \\frac{2000}{1110000} = \\frac{2}{1110} = \\frac{1}{555} \\, \\mathrm{s}\n$$\nThe overall maximum stable time step $\\Delta t_{\\max}$ must satisfy the conditions for all eigenvalues simultaneously. Therefore, $\\Delta t_{\\max}$ is the minimum of the individual limits:\n$$\n\\Delta t_{\\max} = \\min \\left(\\frac{1}{800}, \\frac{1}{555}\\right)\n$$\nSince $800 > 555$, it follows that $1/800  1/555$. The most restrictive condition, yielding the smallest time step limit, is therefore imposed by the purely real eigenvalue $\\lambda_1$.\n$$\n\\Delta t_{\\max} = \\frac{1}{800} \\, \\mathrm{s} = 0.00125 \\, \\mathrm{s}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\Delta t_{\\max} = 0.001250 \\, \\mathrm{s}\n$$",
            "answer": "$$\\boxed{0.001250}$$"
        }
    ]
}