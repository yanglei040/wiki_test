{
    "hands_on_practices": [
        {
            "introduction": "构建一致性切线算子 $\\mathbb{C}^{\\text{alg}}$ 的过程，类似于组装一台精密仪器，需要精确计算其各个部件。本练习  引导你推导其中一个核心部件：对于光滑的修正剑桥（MCC）屈服面，你需要计算出构成 $\\mathbb{C}^{\\text{alg}}$ 分母的关键标量项。这个过程将强化你处理应力不变量和进行张量微积分的技能，这是掌握计算塑性力学不可或缺的一步。",
            "id": "3508732",
            "problem": "考虑一个基于修正剑桥 (MCC) 理论和相关联流动法则的土体小应变、各向同性弹塑性材料模型。设塑性势 $G$ 与 MCC 屈服函数 $f$ 相同，该函数以平均有效应力 $p$、偏应力大小 $q$ 和硬化变量 $p_{c}$（前期固结压力）表示。MCC 塑性势由广为接受的椭圆形式给出\n$$\nG(p,q,p_{c}) \\equiv f(p,q,p_{c}) = \\frac{q^{2}}{M^{2}} + p\\left(p - p_{c}\\right),\n$$\n其中 $M>0$ 是 $p-q$ 平面中临界状态线的斜率。应力不变量定义为\n$$\np = \\frac{1}{3}\\,\\mathrm{tr}\\,\\boldsymbol{\\sigma}, \\quad \\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}, \\quad q = \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{s}\\|,\n$$\n其中 $\\boldsymbol{\\sigma}$ 是柯西 (Cauchy) 应力张量，$\\boldsymbol{I}$ 是二阶单位张量，$\\|\\cdot\\|$ 是欧几里得范数。弹性行为是线性和各向同性的，弹性四阶刚度张量 $\\mathbb{C}_{e}$ 以体积模量 $K>0$ 和剪切模量 $G>0$ 表示为\n$$\n\\mathbb{C}_{e} : \\boldsymbol{X} = K\\,\\mathrm{tr}(\\boldsymbol{X})\\,\\boldsymbol{I} + 2G\\,\\mathrm{dev}(\\boldsymbol{X}),\n$$\n对于任意二阶张量 $\\boldsymbol{X}$，其中 $\\mathrm{dev}(\\boldsymbol{X}) = \\boldsymbol{X} - \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{X})\\,\\boldsymbol{I}$。\n\n从这些定义出发，推导相关联流动方向的显式张量表达式\n$$\n\\boldsymbol{n} = \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}},\n$$\n用 $p$、$q$、$\\boldsymbol{s}$、$M$ 和 $\\boldsymbol{I}$ 表示。然后，使用给定的弹性刚度 $\\mathbb{C}_{e}$，计算标量缩并\n$$\n\\boldsymbol{n} : \\mathbb{C}_{e} : \\boldsymbol{n},\n$$\n并将最终答案表示为仅包含 $K$、$G$、$M$、$p$、$q$ 和 $p_{c}$ 的单一闭式解析表达式。不要进行任何数值代入。仅提供最终表达式。无需四舍五入，也无需报告最终表达式的单位。",
            "solution": "该问题具有科学依据，是良定的，并包含获得唯一解所需的所有信息。这是计算岩土力学领域中弹塑性模型的一个标准推导。\n\n目标是首先推导流动方向张量 $\\boldsymbol{n}$，然后计算标量缩并 $\\boldsymbol{n} : \\mathbb{C}_{e} : \\boldsymbol{n}$。\n\n首先，我们推导流动方向 $\\boldsymbol{n} = \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}}$ 的表达式。塑性势 $G$ 是应力不变量 $p$ 和 $q$ 以及硬化变量 $p_{c}$ 的函数：\n$$\nG(p,q,p_{c}) = \\frac{q^{2}}{M^{2}} + p\\left(p - p_{c}\\right)\n$$\n使用链式法则，$G$ 关于应力张量 $\\boldsymbol{\\sigma}$ 的梯度为：\n$$\n\\boldsymbol{n} = \\frac{\\partial G}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial G}{\\partial p} \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} + \\frac{\\partial G}{\\partial q} \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}}\n$$\n我们计算 $G$ 关于 $p$ 和 $q$ 的偏导数：\n$$\n\\frac{\\partial G}{\\partial p} = 2p - p_{c}\n$$\n$$\n\\frac{\\partial G}{\\partial q} = \\frac{2q}{M^{2}}\n$$\n接下来，我们计算应力不变量 $p$ 和 $q$ 关于 $\\boldsymbol{\\sigma}$ 的导数。\n对于平均应力 $p = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{3}\\sigma_{kk}$，其导数为：\n$$\n\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3} \\frac{\\partial (\\sigma_{kk})}{\\partial \\sigma_{ij}} \\boldsymbol{e}_{i} \\otimes \\boldsymbol{e}_{j} = \\frac{1}{3} \\delta_{ij} \\boldsymbol{e}_{i} \\otimes \\boldsymbol{e}_{j} = \\frac{1}{3}\\boldsymbol{I}\n$$\n其中 $\\boldsymbol{I}$ 是二阶单位张量。\n\n对于偏应力大小 $q = \\sqrt{\\frac{3}{2}}\\|\\boldsymbol{s}\\|$，先考虑 $q^{2} = \\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}$ 会更容易。$q$ 关于 $\\boldsymbol{\\sigma}$ 的导数是连续介质力学中的一个标准结果：\n$$\n\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2} \\frac{\\boldsymbol{s}}{q}\n$$\n为证明此式，我们再次使用链式法则：$\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{s}} : \\frac{\\partial \\boldsymbol{s}}{\\partial \\boldsymbol{\\sigma}}$。\n首先，$\\frac{\\partial q}{\\partial \\boldsymbol{s}} = \\frac{\\partial}{\\partial \\boldsymbol{s}} \\left(\\sqrt{\\frac{3}{2}(\\boldsymbol{s}:\\boldsymbol{s})}\\right) = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\sqrt{\\boldsymbol{s}:\\boldsymbol{s}}} = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}$。\n因为 $q = \\sqrt{\\frac{3}{2}} \\|\\boldsymbol{s}\\|$，我们有 $\\|\\boldsymbol{s}\\| = q / \\sqrt{\\frac{3}{2}}$。\n代入此式可得 $\\frac{\\partial q}{\\partial \\boldsymbol{s}} = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{q / \\sqrt{3/2}} = \\frac{3}{2} \\frac{\\boldsymbol{s}}{q}$。\n接着，$\\frac{\\partial \\boldsymbol{s}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}}(\\boldsymbol{\\sigma} - p\\boldsymbol{I}) = \\mathbb{I} - \\boldsymbol{I} \\otimes \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\mathbb{I} - \\frac{1}{3}\\boldsymbol{I} \\otimes \\boldsymbol{I}$，其中 $\\mathbb{I}$ 是四阶对称单位张量。\n因此，$\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\left( \\frac{3}{2} \\frac{\\boldsymbol{s}}{q} \\right) : \\left( \\mathbb{I} - \\frac{1}{3}\\boldsymbol{I} \\otimes \\boldsymbol{I} \\right) = \\frac{3}{2q}(\\boldsymbol{s}:\\mathbb{I}) - \\frac{3}{2q}\\left(\\frac{1}{3}(\\boldsymbol{s}:\\boldsymbol{I}) \\otimes \\boldsymbol{I}\\right) = \\frac{3}{2q}\\boldsymbol{s} - \\frac{1}{2q}\\mathrm{tr}(\\boldsymbol{s})\\boldsymbol{I}$。\n由于 $\\boldsymbol{s}$ 是偏张量，$\\mathrm{tr}(\\boldsymbol{s}) = 0$。这证实了 $\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2}\\frac{\\boldsymbol{s}}{q}$。\n\n现在，我们将这些导数代回到 $\\boldsymbol{n}$ 的表达式中：\n$$\n\\boldsymbol{n} = (2p - p_{c}) \\left(\\frac{1}{3}\\boldsymbol{I}\\right) + \\left(\\frac{2q}{M^{2}}\\right) \\left(\\frac{3}{2}\\frac{\\boldsymbol{s}}{q}\\right)\n$$\n$$\n\\boldsymbol{n} = \\frac{1}{3}(2p - p_{c})\\boldsymbol{I} + \\frac{3}{M^{2}}\\boldsymbol{s}\n$$\n这就是流动方向的显式张量表达式。\n\n问题的第二部分是计算标量缩并 $\\boldsymbol{n} : \\mathbb{C}_{e} : \\boldsymbol{n}$。\n弹性刚度张量作用于一个二阶张量 $\\boldsymbol{X}$ 的结果为 $\\mathbb{C}_{e} : \\boldsymbol{X} = K\\,\\mathrm{tr}(\\boldsymbol{X})\\,\\boldsymbol{I} + 2G\\,\\mathrm{dev}(\\boldsymbol{X})$。\n让我们首先计算 $\\mathbb{C}_{e}$ 对 $\\boldsymbol{n}$ 的作用：\n$$\n\\mathbb{C}_{e} : \\boldsymbol{n} = K\\,\\mathrm{tr}(\\boldsymbol{n})\\,\\boldsymbol{I} + 2G\\,\\mathrm{dev}(\\boldsymbol{n})\n$$\n我们需要求出 $\\boldsymbol{n}$ 的迹 $\\mathrm{tr}(\\boldsymbol{n})$ 和偏量部分 $\\mathrm{dev}(\\boldsymbol{n})$。\n迹为：\n$$\n\\mathrm{tr}(\\boldsymbol{n}) = \\mathrm{tr}\\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I} + \\frac{3}{M^{2}}\\boldsymbol{s}\\right) = \\frac{1}{3}(2p - p_{c})\\mathrm{tr}(\\boldsymbol{I}) + \\frac{3}{M^{2}}\\mathrm{tr}(\\boldsymbol{s})\n$$\n使用 $\\mathrm{tr}(\\boldsymbol{I}) = 3$ 和 $\\mathrm{tr}(\\boldsymbol{s}) = 0$（根据偏张量的定义），我们得到：\n$$\n\\mathrm{tr}(\\boldsymbol{n}) = \\frac{1}{3}(2p - p_{c})(3) + 0 = 2p - p_{c}\n$$\n$\\boldsymbol{n}$ 的偏量部分是 $\\mathrm{dev}(\\boldsymbol{n}) = \\boldsymbol{n} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{n})\\boldsymbol{I}$。\n代入 $\\boldsymbol{n}$ 和 $\\mathrm{tr}(\\boldsymbol{n})$ 的表达式：\n$$\n\\mathrm{dev}(\\boldsymbol{n}) = \\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I} + \\frac{3}{M^{2}}\\boldsymbol{s}\\right) - \\frac{1}{3}(2p - p_{c})\\boldsymbol{I} = \\frac{3}{M^{2}}\\boldsymbol{s}\n$$\n这不足为奇，因为 $\\boldsymbol{s}$ 本身就是偏张量。\n现在将 $\\mathrm{tr}(\\boldsymbol{n})$ 和 $\\mathrm{dev}(\\boldsymbol{n})$ 代入 $\\mathbb{C}_{e} : \\boldsymbol{n}$ 的表达式中：\n$$\n\\mathbb{C}_{e} : \\boldsymbol{n} = K(2p - p_{c})\\boldsymbol{I} + 2G\\left(\\frac{3}{M^{2}}\\boldsymbol{s}\\right) = K(2p - p_{c})\\boldsymbol{I} + \\frac{6G}{M^{2}}\\boldsymbol{s}\n$$\n最后，我们计算双点积 $\\boldsymbol{n} : (\\mathbb{C}_{e} : \\boldsymbol{n})$：\n$$\n\\boldsymbol{n} : (\\mathbb{C}_{e} : \\boldsymbol{n}) = \\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I} + \\frac{3}{M^{2}}\\boldsymbol{s}\\right) : \\left(K(2p - p_{c})\\boldsymbol{I} + \\frac{6G}{M^{2}}\\boldsymbol{s}\\right)\n$$\n我们根据双点积的分配律展开该乘积：\n$$\n= \\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I}\\right):\\left(K(2p - p_{c})\\boldsymbol{I}\\right) + \\left(\\frac{1}{3}(2p - p_{c})\\boldsymbol{I}\\right):\\left(\\frac{6G}{M^{2}}\\boldsymbol{s}\\right) \\\\ + \\left(\\frac{3}{M^{2}}\\boldsymbol{s}\\right):\\left(K(2p - p_{c})\\boldsymbol{I}\\right) + \\left(\\frac{3}{M^{2}}\\boldsymbol{s}\\right):\\left(\\frac{6G}{M^{2}}\\boldsymbol{s}\\right)\n$$\n我们使用张量恒等式 $\\boldsymbol{I}:\\boldsymbol{I} = 3$，$\\boldsymbol{I}:\\boldsymbol{s} = \\mathrm{tr}(\\boldsymbol{s}) = 0$ 和 $\\boldsymbol{s}:\\boldsymbol{I} = \\mathrm{tr}(\\boldsymbol{s})=0$。\n第一项是：\n$$\n\\frac{1}{3}K(2p-p_{c})^{2}(\\boldsymbol{I}:\\boldsymbol{I}) = \\frac{1}{3}K(2p-p_{c})^{2}(3) = K(2p - p_{c})^{2}\n$$\n由于 $\\boldsymbol{I}:\\boldsymbol{s}=0$ 和 $\\boldsymbol{s}:\\boldsymbol{I}=0$，第二项和第三项为零。\n第四项是：\n$$\n\\left(\\frac{3}{M^{2}}\\right)\\left(\\frac{6G}{M^{2}}\\right)(\\boldsymbol{s}:\\boldsymbol{s}) = \\frac{18G}{M^{4}}(\\boldsymbol{s}:\\boldsymbol{s})\n$$\n根据定义 $q = \\sqrt{\\frac{3}{2}}\\|\\boldsymbol{s}\\| = \\sqrt{\\frac{3}{2}(\\boldsymbol{s}:\\boldsymbol{s})}$，我们有 $q^{2} = \\frac{3}{2}(\\boldsymbol{s}:\\boldsymbol{s})$，由此可得 $\\boldsymbol{s}:\\boldsymbol{s} = \\frac{2}{3}q^{2}$。\n将此代入第四项：\n$$\n\\frac{18G}{M^{4}}\\left(\\frac{2}{3}q^{2}\\right) = \\frac{12G}{M^{4}}q^{2}\n$$\n合并非零项，我们得到最终表达式：\n$$\n\\boldsymbol{n} : \\mathbb{C}_{e} : \\boldsymbol{n} = K(2p - p_{c})^{2} + \\frac{12G}{M^{4}}q^{2}\n$$\n该表达式用所需的变量 $K、G、M、p、q$ 和 $p_{c}$ 表示。",
            "answer": "$$\n\\boxed{K(2p - p_{c})^{2} + \\frac{12G}{M^{4}}q^{2}}\n$$"
        },
        {
            "introduction": "当屈服面并非处处光滑时，例如在 Drucker-Prager 模型的圆锥顶点处，标准的切线算子推导方法便会失效，因为该点的法向不唯一。本练习  将带你直面这一挑战，推导顶点返回（apex return）这一特殊情况下的专用一致性切线算子。通过这个过程，你将理解为何需要进行“正则化”处理，并掌握如何为这类奇点情况构建正确的雅可比矩阵，这是保证非线性求解器稳健性的核心技术。",
            "id": "3508756",
            "problem": "考虑一个三维小应变、各向同性的弹塑性材料，其本构关系遵循线弹性定律和关联Drucker–Prager屈服条件。设四阶弹性刚度为 $\\mathbb{C} = K\\,\\mathbb{I} \\otimes \\mathbb{I} + 2G\\,\\mathbb{P}^{\\text{dev}}$, 其中 $K$ 和 $G$ 分别为体积模量和剪切模量, $\\mathbb{I}$ 是二阶单位张量, $\\mathbb{P}^{\\text{dev}} := \\mathbb{I}^{\\text{sym}} - \\tfrac{1}{3}\\,\\mathbb{I} \\otimes \\mathbb{I}$ 是偏量投影算子, $\\mathbb{I}^{\\text{sym}}$ 为四阶对称单位张量。Cauchy应力为 $\\boldsymbol{\\sigma}$，其第一不变量为 $I_{1} := \\operatorname{tr}(\\boldsymbol{\\sigma})$，偏应力为 $\\boldsymbol{s} := \\boldsymbol{\\sigma} - \\tfrac{1}{3}I_{1}\\,\\mathbb{I}$，第二不变量为 $J_{2} := \\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$。关联Drucker–Prager屈服函数为 \n$$\nf(\\boldsymbol{\\sigma},\\kappa) := \\sqrt{J_{2}} + \\alpha\\,I_{1} - \\kappa,\n$$\n其中摩擦参数 $\\alpha>0$，各向同性硬化标量 $\\kappa$ 的演化规律为 $\\Delta\\kappa = H\\,\\Delta\\lambda$，$H \\ge 0$ 是一个常塑性模量，$\\Delta\\lambda \\ge 0$ 是塑性乘子。后向欧拉返回映射将应力更新为\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\Delta\\lambda\\,\\mathbb{C} : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\\Big|_{n+1}, \n\\quad\nf(\\boldsymbol{\\sigma}_{n+1},\\kappa_{n} + H\\,\\Delta\\lambda) = 0,\n$$\n其中 $\\boldsymbol{\\sigma}_{\\text{tr}} := \\boldsymbol{\\sigma}_{n} + \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}$ 是对应于总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 的弹性试探应力。\n\n重点关注顶点返回情况，此时积分计算达到静水压力顶点，其特征为 $J_{2} \\to 0$ 且 $\\boldsymbol{s}_{n+1} = \\boldsymbol{0}$，这使得导数 $\\partial \\sqrt{J_{2}}/\\partial \\boldsymbol{\\sigma}$ 在形式上是奇异的。从给定的运动学、弹性、屈服函数、关联流动法则以及后向欧拉更新和一致性条件出发，推导特殊情况下的算法一致切线算子 $\\mathbb{C}_{\\text{alg}}^{\\text{apex}} := \\dfrac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}}$。推导过程必须明确处理 $J_{2} \\to 0$ 的顶点极限，并说明硬化模量 $H$ 的作用。\n\n此外，明确说明为避免在顶点处 $\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 出现奇异导数而必须引入的正则化方法，并论证其对 $\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$ 顶点极限形式的影响。\n\n请将最终答案表示为关于 $K$、$G$、$\\alpha$、$H$、$\\mathbb{I}\\otimes\\mathbb{I}$ 和 $\\mathbb{P}^{\\text{dev}}$ 的单一闭式解析表达式 $\\mathbb{C}_{\\text{alg}}^{\\text{apex}}$。无需进行数值计算。最终答案必须是方框内不带单位的单一表达式。",
            "solution": "用户希望解决一个计算岩土力学问题。\n\n### 步骤1：问题验证\n\n该问题旨在推导关联Drucker-Prager塑性模型在顶点返回特殊情况下的算法一致切线算子。\n\n**已知条件：**\n-   **弹性**：各向同性，四阶刚度为 $\\mathbb{C} = K\\,\\mathbb{I} \\otimes \\mathbb{I} + 2G\\,\\mathbb{P}^{\\text{dev}}$。\n-   **屈服函数**：$f(\\boldsymbol{\\sigma},\\kappa) := \\sqrt{J_{2}} + \\alpha\\,I_{1} - \\kappa$，其中 $\\alpha>0$。\n-   **应力不变量**：$I_{1} = \\operatorname{tr}(\\boldsymbol{\\sigma})$，$J_{2} = \\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}$，其中 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{1}{3}I_{1}\\,\\mathbb{I}$。\n-   **硬化**：各向同性，$\\Delta\\kappa = H\\,\\Delta\\lambda$，其中 $H \\ge 0$。\n-   **流动法则**：关联，$\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$。\n-   **积分**：后向欧拉法，$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\Delta\\lambda\\,\\mathbb{C} : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}\\Big|_{n+1}$ 且满足一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1}) = 0$。\n-   **顶点条件**：返回映射的结果是静水压力轴上的一个状态，即 $\\boldsymbol{s}_{n+1} = \\boldsymbol{0}$ 且 $J_{2,n+1} = 0$。\n-   **目标**：推导顶点情况下的 $\\mathbb{C}_{\\text{alg}}^{\\text{apex}} := \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}}$，并解释所需的正则化。\n\n**验证：**\n1.  **有科学依据**：该问题是计算塑性力学中的一个标准（尽管较高级）的课题。Drucker-Prager模型、返回映射算法以及一致切线算子的推导是固体力学和岩土力学中成熟的概念。\n2.  **良定性**：该问题提供了一套完整的控制方程和一个明确定义的目标。顶点返回是一个特定的、明确定义的场景，可以导出一个唯一的切线算子表达式。\n3.  **客观性**：该问题使用精确、无歧义的技术语言进行陈述。\n\n该问题被认为是有效的，因为它在科学上是合理的、良定的和客观的。没有矛盾、信息缺失或伪科学主张。\n\n### 步骤2：求解\n\n顶点返回情况下算法一致切线算子 $\\mathbb{C}_{\\text{alg}}^{\\text{apex}} := \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}}$ 的推导过程如下。\n\n**顶点的正则化**\n定义了塑性流动方向的屈服函数梯度为\n$$\n\\boldsymbol{N} := \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial \\sqrt{J_2}}{\\partial \\boldsymbol{\\sigma}} + \\alpha \\frac{\\partial I_1}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\boldsymbol{s}}{2\\sqrt{J_2}} + \\alpha \\mathbb{I}\n$$\n在屈服锥面的顶点，应力状态是纯静水的，意味着偏应力张量 $\\boldsymbol{s} = \\boldsymbol{0}$，因此其不变量 $J_2 = 0$。在此极限下，项 $\\frac{\\boldsymbol{s}}{2\\sqrt{J_2}}$ 是不定的。这个数学奇点反映了一个几何事实，即锥形顶点没有唯一的法向量。\n\n为了解决这种不确定性，必须引入正则化。在顶点返回的背景下，算法识别出最终状态必须是静水压力状态，即 $\\boldsymbol{s}_{n+1} = \\boldsymbol{0}$。这意味着塑性流动过程必须完全抵消整个试探偏应力 $\\boldsymbol{s}_{\\text{tr}}$。随后的塑性演化完全沿着静水压力轴发生。对于一个纯静水过程，塑性应变率也必须是纯体积的。因此，塑性流动梯度的偏量部分 $\\frac{\\boldsymbol{s}}{2\\sqrt{J_2}}$ 在此阶段被认为是非激活的。\n\n这种正则化的结果是，在顶点处的屈服函数有效梯度被认为是纯体积的：\n$$\n\\boldsymbol{N}^{\\text{apex}} = \\lim_{\\boldsymbol{s}\\to\\boldsymbol{0}} \\left(\\frac{\\boldsymbol{s}}{2\\sqrt{J_2}} + \\alpha \\mathbb{I}\\right) \\longrightarrow \\alpha \\mathbb{I}\n$$\n这假设对于在顶点处的纯静水塑性加载/卸载，流动方向的偏量部分为零。\n\n**顶点切线算子的推导**\n当试探应力处于其静水压力分量单独违反屈服条件的区域时（即 $f(\\frac{1}{3}I_{1,\\text{tr}}\\mathbb{I}, \\kappa_n) = \\alpha I_{1,\\text{tr}} - \\kappa_n > 0$），通常会触发顶点返回。在这种情况下，算法直接将最终偏应力设置为零，即 $\\boldsymbol{s}_{n+1}=\\boldsymbol{0}$，这意味着最终应力状态是静水压力状态：$\\boldsymbol{\\sigma}_{n+1} = \\frac{1}{3}I_{1,n+1}\\mathbb{I}$。\n\n最终应力状态由后向欧拉积分方案和一致性条件确定。我们有两个标量未知数，即最终的第一应力不变量 $I_{1,n+1}$ 和塑性乘子 $\\Delta\\lambda$。它们由两个标量方程控制。\n\n1.  **顶点处的一致性条件**：当 $J_{2,n+1}=0$ 且 $\\kappa_{n+1} = \\kappa_n + H\\Delta\\lambda$ 时，屈服函数 $f_{n+1}=0$ 变为：\n    $$\n    \\alpha I_{1,n+1} - (\\kappa_n + H\\Delta\\lambda) = 0\n    $$\n\n2.  **体积应力更新**：应力更新法则是 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\Delta\\lambda\\,\\mathbb{C} : \\boldsymbol{N}^{\\text{apex}}$。代入 $\\boldsymbol{N}^{\\text{apex}} = \\alpha \\mathbb{I}$ 并对该方程取迹，得到：\n    $$\n    I_{1,n+1} = I_{1,\\text{tr}} - \\Delta\\lambda\\, \\mathbb{I} : (\\mathbb{C} : (\\alpha \\mathbb{I}))\n    $$\n    我们来计算 $\\mathbb{I} : (\\mathbb{C} : (\\alpha \\mathbb{I}))$ 这一项。使用定义 $\\mathbb{C} = K\\,\\mathbb{I} \\otimes \\mathbb{I} + 2G\\,\\mathbb{P}^{\\text{dev}}$：\n    $$\n    \\mathbb{I} : (\\mathbb{C} : (\\alpha \\mathbb{I})) = \\alpha\\, \\mathbb{I} : (\\mathbb{C} : \\mathbb{I}) = \\alpha\\, (\\mathbb{I} : \\mathbb{C}) : \\mathbb{I}\n    $$\n    缩并 $\\mathbb{I} : \\mathbb{C}$ 为：\n    $$\n    \\mathbb{I} : \\mathbb{C} = \\mathbb{I} : (K\\,\\mathbb{I} \\otimes \\mathbb{I} + 2G\\,\\mathbb{P}^{\\text{dev}}) = K(\\mathbb{I} : (\\mathbb{I} \\otimes \\mathbb{I})) + 2G(\\mathbb{I} : \\mathbb{P}^{\\text{dev}})\n    $$\n    由于 $\\mathbb{I} : \\mathbb{I} = 3$ 并且 $\\mathbb{P}^{\\text{dev}}$ 投影到偏量子空间，所以 $\\mathbb{I} : \\mathbb{P}^{\\text{dev}} = \\boldsymbol{0}$。同时，$\\mathbb{I} : (\\mathbb{I} \\otimes \\mathbb{I}) = (\\mathbb{I}:\\mathbb{I})\\mathbb{I} = 3\\mathbb{I}$。所以，$\\mathbb{I} : \\mathbb{C} = 3K\\mathbb{I}$。\n    将其代回，我们得到：\n    $$\n    \\alpha\\, (3K\\mathbb{I}) : \\mathbb{I} = 3K\\alpha (\\mathbb{I}:\\mathbb{I}) = 3K\\alpha(3) = 9K\\alpha\n    $$\n    因此，体积应力更新简化为：\n    $$\n    I_{1,n+1} = I_{1, \\text{tr}} - 9K\\alpha\\Delta\\lambda\n    $$\n\n现在我们求解关于 $\\Delta\\lambda$ 和 $I_{1,n+1}$ 的两个线性方程组：\n(a) $\\alpha I_{1,n+1} - H\\Delta\\lambda = \\kappa_n$\n(b) $I_{1,n+1} + 9K\\alpha\\Delta\\lambda = I_{1, \\text{tr}}$\n\n从(b)式可得 $\\Delta\\lambda = \\frac{I_{1,\\text{tr}} - I_{1,n+1}}{9K\\alpha}$。将其代入(a)式：\n$$\n\\alpha I_{1,n+1} - H\\frac{I_{1,\\text{tr}} - I_{1,n+1}}{9K\\alpha} = \\kappa_n\n$$\n$$\n9K\\alpha^2 I_{1,n+1} - H I_{1,\\text{tr}} + H I_{1,n+1} = 9K\\alpha\\kappa_n\n$$\n$$\n(9K\\alpha^2 + H) I_{1,n+1} = 9K\\alpha\\kappa_n + H I_{1, \\text{tr}}\n$$\n这就得到了用试探不变量表示的最终静水应力不变量：\n$$\nI_{1,n+1} = \\frac{9K\\alpha\\kappa_n + H I_{1, \\text{tr}}}{H + 9K\\alpha^2}\n$$\n最终应力张量为 $\\boldsymbol{\\sigma}_{n+1} = \\frac{1}{3} I_{1,n+1} \\mathbb{I}$。为了计算一致切线算子 $\\mathbb{C}_{\\text{alg}}^{\\text{apex}} = \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}}$，我们首先将 $I_{1,\\text{tr}}$ 与总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 联系起来：\n$$\nI_{1, \\text{tr}} = \\operatorname{tr}(\\boldsymbol{\\sigma}_n + \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}) = I_{1,n} + \\mathbb{I}:(\\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}) = I_{1,n} + (3K\\mathbb{I}):\\Delta\\boldsymbol{\\varepsilon} = I_{1,n} + 3K\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon})\n$$\n对 $\\boldsymbol{\\sigma}_{n+1}$ 关于 $\\Delta\\boldsymbol{\\varepsilon}$ 求导：\n$$\nd\\boldsymbol{\\sigma}_{n+1} = \\frac{\\partial \\boldsymbol{\\sigma}_{n+1}}{\\partial \\Delta\\boldsymbol{\\varepsilon}} : d\\Delta\\boldsymbol{\\varepsilon} = \\mathbb{C}_{\\text{alg}}^{\\text{apex}} : d\\Delta\\boldsymbol{\\varepsilon}\n$$\n我们有 $d\\boldsymbol{\\sigma}_{n+1} = \\frac{1}{3} dI_{1,n+1} \\mathbb{I}$。对 $I_{1,n+1}$ 的表达式求导：\n$$\ndI_{1,n+1} = \\frac{\\partial I_{1,n+1}}{\\partial I_{1,\\text{tr}}} dI_{1,\\text{tr}} = \\frac{H}{H + 9K\\alpha^2} dI_{1,\\text{tr}}\n$$\n并且 $dI_{1,\\text{tr}} = 3K \\operatorname{tr}(d\\Delta\\boldsymbol{\\varepsilon}) = 3K (\\mathbb{I}:d\\Delta\\boldsymbol{\\varepsilon})$。正确地组合这些表达式：\n$$\nd\\boldsymbol{\\sigma}_{n+1} = \\frac{1}{3} \\left( \\frac{H}{H + 9K\\alpha^2} \\right) (3K (\\mathbb{I}:d\\Delta\\boldsymbol{\\varepsilon})) \\mathbb{I}\n$$\n$$\nd\\boldsymbol{\\sigma}_{n+1} = \\frac{KH}{H + 9K\\alpha^2} (\\mathbb{I}:d\\Delta\\boldsymbol{\\varepsilon}) \\mathbb{I}\n$$\n该关系可以写成张量形式：\n$$\nd\\boldsymbol{\\sigma}_{n+1} = \\left( \\frac{KH}{H + 9K\\alpha^2} \\mathbb{I} \\otimes \\mathbb{I} \\right) : d\\Delta\\boldsymbol{\\varepsilon}\n$$\n因此，根据定义，顶点返回的算法一致切线算子为：\n$$\n\\mathbb{C}_{\\text{alg}}^{\\text{apex}} = \\frac{KH}{H + 9K\\alpha^2} \\mathbb{I} \\otimes \\mathbb{I}\n$$\n该算子是纯体积的，这反映了最终应力状态是静水压力的事实。硬化模量 $H$ 的作用是显而易见的：对于理想塑性（$H=0$），$\\mathbb{C}_{\\text{alg}}^{\\text{apex}}=\\boldsymbol{0}$，这意味着应力固定在顶点，不随进一步的应变而改变。对于 $H>0$，材料表现出硬化响应。剪切模量 $G$ 和偏量投影算子 $\\mathbb{P}^{\\text{dev}}$ 没有出现，因为在顶点返回中，偏量响应已经完全塑性化。",
            "answer": "$$\n\\boxed{\\frac{KH}{H + 9K\\alpha^2} \\mathbb{I} \\otimes \\mathbb{I}}\n$$"
        },
        {
            "introduction": "理论的价值最终体现在其预测能力上。那么，不辞辛劳推导出的“一致性”切线算子，与简单的“割线”近似相比，在实践中究竟有多大差别？本练习  提供了一个绝佳的量化机会，它将切线模量的选择与剪切带厚度这一可观测的物理现象直接挂钩。你不仅需要从解析上推导两种不同的切线模量，还要通过编写代码进行数值实验，亲手验证和比较它们对软化失稳预测结果的影响，从而深刻体会到一致性切线在确保模拟准确性方面的关键作用。",
            "id": "3508706",
            "problem": "考虑一个在单调拉伸下的一维小应变梯度增强弹塑性固体。Cauchy 应力为 $\\sigma = E(\\varepsilon - \\varepsilon^{p})$，其中 $E$ 是杨氏模量，$\\varepsilon$ 是总应变，$\\varepsilon^{p}$ 是塑性应变。采用率无关相关联流动法则，在单轴单调加载中，累积塑性应变 $\\kappa$ 由 $\\dot{\\kappa} = \\dot{\\lambda}$ 和 $\\dot{\\varepsilon}^{p} = \\dot{\\lambda}$ 定义。屈服应力 $Y(\\kappa)$ 随 $\\kappa$ 呈指数下降，表达式为 $Y(\\kappa) = Y_{0}\\,\\exp(-\\kappa/\\kappa_{0})$，其中 $Y_{0} > 0$ 且 $\\kappa_{0} > 0$。\n\n单个内禀长度 $\\ell$ 通过一个能量梯度贡献来正则化局部化，该贡献在均匀状态附近进行线性化并对波数为 $k$ 的扰动进行傅里叶分解后，产生一个与 $g\\,E\\,(k\\,\\ell)^{2}$ 成正比的稳定项，其中 $g > 0$ 是一个无量纲梯度系数。假设在每个增量步中采用后向欧拉返回映射。令 $\\Delta \\varepsilon$ 表示施加的应变增量，$\\Delta \\gamma$ 表示塑性乘子增量，$\\kappa_{n}$ 表示第 $n$ 步之前的累积塑性应变。试探应力为 $\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E\\,\\Delta \\varepsilon$，其中 $\\sigma_{n} = Y(\\kappa_{n})$ (假设在单调加载中，上一步的状态位于屈服面上)。后向欧拉塑性修正强制满足 $\\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma$ 和 $\\kappa_{n+1} = \\kappa_{n} + \\Delta \\gamma$，以及步末一致性条件 $\\sigma_{n+1} - Y(\\kappa_{n+1}) = 0$。\n\n任务：\n1) 仅从上述本构定义和后向欧拉一致性条件出发，推导在塑性步结束时算法一致切线模量 $E_{\\mathrm{alg}}^{\\mathrm{con}}$ 的表达式，其为精确线性化 $\\mathrm{d}\\sigma_{n+1}/\\mathrm{d}\\varepsilon_{n+1}$。作为对比，推导由同一增量上的弦斜率 $(\\sigma_{n+1}-\\sigma_{n})/(\\varepsilon_{n+1}-\\varepsilon_{n})$ 定义的割线切线模量 $E_{\\mathrm{alg}}^{\\mathrm{sec}}$。\n2) 利用均匀响应在傅里叶模态扰动下的线性稳定性，推导定义临界波数 $k^{\\star}$ 的中性稳定条件，该条件用 $E_{\\mathrm{alg}}$ 和梯度贡献表示。由此，推导预测的剪切带厚度 $t$（作为临界模态的半波长），并给出归一化厚度 $T = t/\\ell$（用 $E_{\\mathrm{alg}}$, $E$ 和 $g$ 表示）。指明当 $E_{\\mathrm{alg}} \\ge 0$（无软化失稳）时应报告什么。\n3) 提出了一个数值实验，通过固定 $\\ell$ 和 $g$，仅改变加载增量 $\\Delta \\varepsilon$ 和/或软化曲率 $\\kappa_{0}$，来分离切线模量选择与内禀长度参数 $\\ell$ 的作用，并解释其基本原理。\n4) 实现一个完整的程序，该程序：\n   - 对于下述每个测试用例，通过使用稳健的区间法求解一致性方程 $\\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma - Y(\\kappa_{n}+\\Delta \\gamma) = 0$ 的根来求解标量后向欧拉塑性修正器中的 $\\Delta \\gamma$，然后根据你的推导计算 $E_{\\mathrm{alg}}^{\\mathrm{con}}$ 和 $E_{\\mathrm{alg}}^{\\mathrm{sec}}$。\n   - 对于固定的 $g$ 和 $\\ell$，分别计算一致切线模量和割线切线模量对应的归一化预测厚度 $T^{\\mathrm{con}}$ 和 $T^{\\mathrm{sec}}$。\n   - 对每个用例，以浮点数形式报告三元组 $[T^{\\mathrm{con}}, T^{\\mathrm{sec}}, T^{\\mathrm{sec}}-T^{\\mathrm{con}}]$，并使用约定：如果 $E_{\\mathrm{alg}} \\ge 0$，则 $T = 10^{9}$ (无量纲)，表示没有发生局部化。\n   - 将所有用例的结果汇总到单行中，格式为逗号分隔的 Python 风格列表的列表。\n\n使用以下测试套件，其中固定 $E$, $Y_{0}$, $\\kappa_{n}$, $g$ 和 $\\ell$，同时改变 $\\Delta \\varepsilon$ 和 $\\kappa_{0}$ 以分离切线模量的作用：\n- 用例 A (接近增量极限)：$E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.5$, $\\Delta \\varepsilon = 10^{-6}$, $g = 0.2$, $\\ell = 1$。\n- 用例 B (中等增量)：$E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.5$, $\\Delta \\varepsilon = 10^{-2}$, $g = 0.2$, $\\ell = 1$。\n- 用例 C (更陡峭的软化曲率)：$E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.05$, $\\Delta \\varepsilon = 10^{-2}$, $g = 0.2$, $\\ell = 1$。\n\n所有量在构造上都是无量纲的，并且请求的输出 $T^{\\mathrm{con}}$, $T^{\\mathrm{sec}}$ 及其差值也是无量纲的。您的程序应生成单行输出，其中包含一个由三个列表组成的逗号分隔列表，每个内部列表的格式为 $[T^{\\mathrm{con}},T^{\\mathrm{sec}},T^{\\mathrm{sec}}-T^{\\mathrm{con}}]$，按顺序对应 A、B、C 三个用例，例如 $[[a,b,c],[d,e,f],[g,h,i]]$。",
            "solution": "我们在一维、小应变和单调加载条件下进行分析。应力为 $\\sigma = E(\\varepsilon - \\varepsilon^{p})$，累积塑性应变 $\\kappa$ 满足 $\\dot{\\kappa} = \\dot{\\lambda}$ 和 $\\dot{\\varepsilon}^{p} = \\dot{\\lambda}$。屈服应力随 $Y(\\kappa) = Y_{0}\\exp(-\\kappa/\\kappa_{0})$ 下降。在应变增量为 $\\Delta \\varepsilon$ 的增量步 $n \\to n+1$ 中，我们采用后向欧拉法。假设由于单调加载，上一步的状态位于屈服面上：$\\sigma_{n} = Y(\\kappa_{n})$。试探应力为\n$$\n\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E\\,\\Delta \\varepsilon = Y(\\kappa_{n}) + E\\,\\Delta \\varepsilon.\n$$\n如果发生塑性修正，步末值满足\n$$\n\\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma, \\quad \\kappa_{n+1} = \\kappa_{n} + \\Delta \\gamma,\n$$\n以及离散一致性条件\n$$\nr(\\Delta \\gamma) \\equiv \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma - Y(\\kappa_{n+1}) = 0, \\quad \\text{其中} \\quad Y(\\kappa_{n+1}) = Y_{0}\\exp\\!\\left(-\\frac{\\kappa_{n}+\\Delta \\gamma}{\\kappa_{0}}\\right).\n$$\n\n1) 算法一致切线模量。算法一致切线模量 $E_{\\mathrm{alg}}^{\\mathrm{con}} = \\mathrm{d}\\sigma_{n+1}/\\mathrm{d}\\varepsilon_{n+1}$ 由完全隐式更新的精确线性化定义。对标量一致性方程关于 $\\Delta \\varepsilon$ 求导，注意 $\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E\\Delta \\varepsilon$ 且 $\\kappa_{n+1} = \\kappa_{n} + \\Delta \\gamma(\\Delta \\varepsilon)$：\n$$\n0 = \\frac{\\mathrm{d}r}{\\mathrm{d}\\Delta \\varepsilon} = \\frac{\\partial r}{\\partial \\Delta \\varepsilon} + \\frac{\\partial r}{\\partial \\Delta \\gamma}\\,\\frac{\\partial \\Delta \\gamma}{\\partial \\Delta \\varepsilon}\n= E + \\left(-E - Y'(\\kappa_{n+1})\\right)\\frac{\\partial \\Delta \\gamma}{\\partial \\Delta \\varepsilon},\n$$\n其中 $Y'(\\kappa) = \\mathrm{d}Y/\\mathrm{d}\\kappa = -\\frac{1}{\\kappa_{0}}\\,Y(\\kappa)$。求解敏感度可得\n$$\n\\frac{\\partial \\Delta \\gamma}{\\partial \\Delta \\varepsilon} = \\frac{E}{E + Y'(\\kappa_{n+1})}.\n$$\n步末应力满足 $\\sigma_{n+1} = \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma$，因此\n$$\nE_{\\mathrm{alg}}^{\\mathrm{con}} = \\frac{\\mathrm{d}\\sigma_{n+1}}{\\mathrm{d}\\varepsilon_{n+1}} = E - E\\,\\frac{\\partial \\Delta \\gamma}{\\partial \\Delta \\varepsilon}\n= E\\left(1 - \\frac{E}{E + Y'(\\kappa_{n+1})}\\right)\n= E\\,\\frac{Y'(\\kappa_{n+1})}{E + Y'(\\kappa_{n+1})}.\n$$\n因为对于软化而言 $Y'(\\kappa_{n+1})  0$，所以在塑性软化步中可以发现 $E_{\\mathrm{alg}}^{\\mathrm{con}}  0$。\n\n割线切线模量。在有限步长上的割线切线模量定义为弦斜率\n$$\nE_{\\mathrm{alg}}^{\\mathrm{sec}} = \\frac{\\sigma_{n+1} - \\sigma_{n}}{\\varepsilon_{n+1} - \\varepsilon_{n}} = \\frac{\\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma - \\sigma_{n}}{\\Delta \\varepsilon} = \\frac{E\\,\\Delta \\varepsilon - E\\,\\Delta \\gamma}{\\Delta \\varepsilon} = E\\left(1 - \\frac{\\Delta \\gamma}{\\Delta \\varepsilon}\\right).\n$$\n对于非线性软化 $Y(\\kappa)$，通常有 $\\Delta \\gamma/\\Delta \\varepsilon \\ne \\partial \\Delta \\gamma/\\partial \\Delta \\varepsilon$，因此 $E_{\\mathrm{alg}}^{\\mathrm{sec}} \\ne E_{\\mathrm{alg}}^{\\mathrm{con}}$。\n\n为计算任一切线模量，我们首先求解标量非线性方程 $r(\\Delta \\gamma) = 0$ 得到 $\\Delta \\gamma$。然后计算 $\\kappa_{n+1}$, $Y(\\kappa_{n+1})$ 和 $Y'(\\kappa_{n+1})$。一致切线模量由上述表达式得出；割线切线模量由弦斜率比值得出。\n\n2) 梯度正则化稳定性与剪切带厚度。考虑一个均匀状态周围的傅里叶模态为 $\\mathrm{e}^{\\mathrm{i}k x}$ 的线性扰动。均匀介质中的增量力算子可分为与标量算法切线模量 $E_{\\mathrm{alg}}$ 成正比的材料部分和与 $g\\,E\\,(k\\,\\ell)^{2}$ 成正比的稳定化梯度部分。当中性稳定性（局部化开始）发生时，某个模态的净增量刚度为零，这给出了标量条件\n$$\nE_{\\mathrm{alg}} + g\\,E\\,(k\\,\\ell)^{2} = 0 \\quad \\Rightarrow \\quad k^{\\star}\\ell = \\sqrt{\\frac{-E_{\\mathrm{alg}}}{g\\,E}}, \\quad \\text{对于 } E_{\\mathrm{alg}}  0.\n$$\n在开始时，最不稳定的扰动具有波数 $k^{\\star}$ 和波长 $\\lambda^{\\star} = 2\\pi/k^{\\star}$。剪切带厚度的一个常用度量是半波长，因此\n$$\nt = \\frac{\\pi}{k^{\\star}}, \\qquad T \\equiv \\frac{t}{\\ell} = \\pi\\,\\sqrt{\\frac{g\\,E}{-E_{\\mathrm{alg}}}} \\quad \\text{如果 } E_{\\mathrm{alg}}  0.\n$$\n当 $E_{\\mathrm{alg}} \\ge 0$ 时，不会预测到由软化驱动的局部化；我们采用约定 $T = 10^{9}$ (无量纲) 来表示在此线性化准则下不存在有限的局部化厚度。\n\n3) 分离切线模量作用的数值实验。为解耦切线模量与内禀长度参数的贡献，固定内禀长度 $\\ell$ 和梯度系数 $g$，并保持弹性模量 $E$ 和屈服尺度 $Y_{0}$ 不变。通过改变 (a) 应变增量 $\\Delta \\varepsilon$ (以探究弦斜率和微分斜率之间的差异) 或 (b) 软化曲率参数 $\\kappa_{0}$ (其在给定状态下控制 $Y'(\\kappa)$) 来改变返回映射的非线性。对于每种情况，计算 $E_{\\mathrm{alg}}^{\\mathrm{con}}$ 和 $E_{\\mathrm{alg}}^{\\mathrm{sec}}$，然后使用相同的固定 $g$ 和 $\\ell$ 从稳定性公式中评估 $T^{\\mathrm{con}}$ 和 $T^{\\mathrm{sec}}$。由于 $\\ell$ 和 $g$ 保持不变，不同情况之间 $T$ 的任何变化都完全归因于切线模量的选择和本构非线性引起的 $E_{\\mathrm{alg}}$ 的变化，从而分离了切线模量的作用。\n\n4) 算法实现。对于每个测试用例：\n- 计算 $\\sigma_{n} = Y_{0}\\exp(-\\kappa_{n}/\\kappa_{0})$ 和 $\\sigma_{\\mathrm{tr}} = \\sigma_{n} + E\\,\\Delta \\varepsilon$。\n- 使用区间法（例如，二分法）求解 $r(\\Delta \\gamma) = \\sigma_{\\mathrm{tr}} - E\\,\\Delta \\gamma - Y_{0}\\exp(-(\\kappa_{n}+\\Delta \\gamma)/\\kappa_{0}) = 0$ 以获得 $\\Delta \\gamma \\ge 0$，注意到 $r(0) = E\\,\\Delta \\varepsilon \\ge 0$ 并且当 $\\Delta \\gamma \\to +\\infty$ 时 $r(\\Delta \\gamma) \\to -\\infty$，因此总能构造一个求解区间。\n- 评估 $\\kappa_{n+1} = \\kappa_{n} + \\Delta \\gamma$, $Y(\\kappa_{n+1})$ 和 $Y'(\\kappa_{n+1}) = -Y(\\kappa_{n+1})/\\kappa_{0}$。\n- 计算 $E_{\\mathrm{alg}}^{\\mathrm{con}} = E\\,\\dfrac{Y'(\\kappa_{n+1})}{E + Y'(\\kappa_{n+1})}$ 和 $E_{\\mathrm{alg}}^{\\mathrm{sec}} = E\\left(1 - \\dfrac{\\Delta \\gamma}{\\Delta \\varepsilon}\\right)$。在割线计算中，保证 $\\Delta \\varepsilon > 0$。\n- 如果 $E_{\\mathrm{alg}}^{\\mathrm{con}}  0$，则计算 $T^{\\mathrm{con}} = \\pi\\sqrt{\\dfrac{g\\,E}{-E_{\\mathrm{alg}}^{\\mathrm{con}}}}$，否则 $T^{\\mathrm{con}} = 10^{9}$；对 $T^{\\mathrm{sec}}$ 使用 $E_{\\mathrm{alg}}^{\\mathrm{sec}}$ 进行类似的计算。\n- 报告三元组 $[T^{\\mathrm{con}}, T^{\\mathrm{sec}}, T^{\\mathrm{sec}}-T^{\\mathrm{con}}]$。\n\n使用指定的测试套件：\n- 用例 A：$E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.5$, $\\Delta \\varepsilon = 10^{-6}$, $g = 0.2$, $\\ell = 1$。\n- 用例 B：$E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.5$, $\\Delta \\varepsilon = 10^{-2}$, $g = 0.2$, $\\ell = 1$。\n- 用例 C：$E = 1000$, $Y_{0} = 300$, $\\kappa_{n} = 0.1$, $\\kappa_{0} = 0.05$, $\\Delta \\varepsilon = 10^{-2}$, $g = 0.2$, $\\ell = 1$。\n\n最终程序计算这些值，并打印单行输出，其中包含一个按 A、B、C 顺序排列的、由三个列表组成的 Python 风格列表，每个内部列表为 $[T^{\\mathrm{con}},T^{\\mathrm{sec}},T^{\\mathrm{sec}}-T^{\\mathrm{con}}]$，所有值均为无量纲。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_return_mapping(E, Y0, kappa0, kappa_n, delta_eps):\n    \"\"\"\n    Solve the backward Euler return mapping for exponential softening:\n      r(dgamma) = sigma_tr - E*dgamma - Y0*exp(-(kappa_n + dgamma)/kappa0) = 0\n    using a robust bisection method. Assumes previous state on yield: sigma_n = Y(kappa_n).\n    Returns:\n      dgamma, kappa_np1, Y_end, Yprime_end\n    \"\"\"\n    # Previous stress on yield\n    sigma_n = Y0 * np.exp(-kappa_n / kappa0)\n    # Trial stress\n    sigma_tr = sigma_n + E * delta_eps\n\n    # Residual function\n    def r(dg):\n        return sigma_tr - E * dg - Y0 * np.exp(-(kappa_n + dg) / kappa0)\n\n    # Bracket root: r(0) = 0, r(high) - negative for sufficiently large dgamma\n    r0 = r(0.0)\n    if r0  0:\n        # No plastic correction (should not happen in monotonic loading at yield with positive delta_eps)\n        dgamma = 0.0\n        kappa_np1 = kappa_n\n        Y_end = Y0 * np.exp(-kappa_np1 / kappa0)\n        Yprime_end = -Y_end / kappa0\n        return dgamma, kappa_np1, Y_end, Yprime_end\n\n    # Choose a high bound that guarantees negativity\n    # Since r ~ sigma_tr - E*dgamma as dg - inf, it becomes negative beyond sigma_tr/E\n    high = delta_eps + sigma_n / E + 10.0 * max(1.0, kappa0)\n    # Ensure r(high)  0; increase if needed\n    r_high = r(high)\n    iters = 0\n    while r_high  0 and iters  50:\n        high *= 2.0\n        r_high = r(high)\n        iters += 1\n\n    # Bisection\n    a, b = 0.0, high\n    fa, fb = r(a), r(b)\n    # Safety: if fb  0 due to numerical issues, fallback to small plastic step\n    if fb  0:\n        dgamma = 0.0\n        kappa_np1 = kappa_n\n        Y_end = Y0 * np.exp(-kappa_np1 / kappa0)\n        Yprime_end = -Y_end / kappa0\n        return dgamma, kappa_np1, Y_end, Yprime_end\n\n    tol = 1e-12\n    for _ in range(200):\n        c = 0.5 * (a + b)\n        fc = r(c)\n        if abs(fc)  tol or (b - a)  1e-12:\n            dgamma = c\n            break\n        if fa * fc  0:\n            a, fa = c, fc\n        else:\n            b, fb = c, fc\n    else:\n        dgamma = 0.5 * (a + b)\n\n    kappa_np1 = kappa_n + dgamma\n    Y_end = Y0 * np.exp(-kappa_np1 / kappa0)\n    Yprime_end = -Y_end / kappa0\n    return dgamma, kappa_np1, Y_end, Yprime_end\n\ndef consistent_tangent(E, Yprime_end):\n    # E_alg^con = E * Y' / (E + Y')\n    denom = E + Yprime_end\n    # Guard against division by zero\n    if abs(denom)  1e-15:\n        # In the singular limit, use a large negative tangent (approach -E)\n        return -E\n    return E * (Yprime_end / denom)\n\ndef secant_tangent(E, dgamma, delta_eps):\n    # E_alg^sec = E * (1 - dgamma/delta_eps)\n    if delta_eps = 0.0:\n        # No increment; use elastic stiffness as secant convention\n        return E\n    return E * (1.0 - dgamma / delta_eps)\n\ndef normalized_thickness(E, E_alg, g):\n    # T = pi * sqrt( g * E / (-E_alg) ) if E_alg  0, else 1e9\n    if E_alg  0.0:\n        val = np.pi * np.sqrt(g * E / (-E_alg))\n        # Numerical guard\n        if not np.isfinite(val):\n            return 1e9\n        return float(val)\n    else:\n        return 1e9\n\ndef run_case(E, Y0, kappa0, kappa_n, delta_eps, g, ell):\n    # ell is not used explicitly because we return normalized thickness T = t/ell\n    dgamma, kappa_np1, Y_end, Yprime_end = solve_return_mapping(E, Y0, kappa0, kappa_n, delta_eps)\n    E_alg_con = consistent_tangent(E, Yprime_end)\n    E_alg_sec = secant_tangent(E, dgamma, delta_eps)\n    T_con = normalized_thickness(E, E_alg_con, g)\n    T_sec = normalized_thickness(E, E_alg_sec, g)\n    return T_con, T_sec, T_sec - T_con\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (E, Y0, kappa0, kappa_n, delta_eps, g, ell)\n    test_cases = [\n        (1000.0, 300.0, 0.5, 0.1, 1e-6, 0.2, 1.0),    # Case A\n        (1000.0, 300.0, 0.5, 0.1, 1e-2, 0.2, 1.0),    # Case B\n        (1000.0, 300.0, 0.05, 0.1, 1e-2, 0.2, 1.0),   # Case C\n    ]\n\n    results = []\n    for case in test_cases:\n        E, Y0, kappa0, kappa_n, delta_eps, g, ell = case\n        T_con, T_sec, dT = run_case(E, Y0, kappa0, kappa_n, delta_eps, g, ell)\n        # Round for stable textual output\n        results.append([round(T_con, 6), round(T_sec, 6), round(dT, 6)])\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}