{
    "hands_on_practices": [
        {
            "introduction": "The von Mises, or $J_2$, plasticity model is a cornerstone of computational solid mechanics, providing a robust description for ductile metals and serving as a foundational model in geomechanics for undrained clay behavior. This first exercise  guides you through the derivation and application of the classic 'radial return' algorithm, the workhorse of implicit integration for smooth yield surfaces. By working in principal stress space, you will see how the tensorial problem simplifies, providing a clear illustration of how the trial stress is 'returned' to the yield surface along the shortest path.",
            "id": "3532232",
            "problem": "Consider a small-strain, isotropically hardening, associative von Mises plasticity model based on the second invariant of the deviatoric stress tensor, commonly denoted $J_2$. Let the elastic domain be defined by the yield function $f(\\boldsymbol{\\sigma}, \\bar{\\varepsilon}^{p}) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\bar{\\varepsilon}^{p})$, where the equivalent stress is $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}}\\,\\|\\boldsymbol{s}\\|$, $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ is the deviatoric stress, and the isotropic hardening follows $\\sigma_{y}(\\bar{\\varepsilon}^{p}) = \\sigma_{y0} + H\\,\\bar{\\varepsilon}^{p}$ with $\\sigma_{y0} > 0$ and $H \\ge 0$. The elastic response is linear with shear modulus $G>0$. The plastic flow is associative, $d\\boldsymbol{\\varepsilon}^{p} = d\\gamma\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$, and the equivalent plastic strain increment satisfies $d\\bar{\\varepsilon}^{p} = d\\gamma$.\n\nStarting from these fundamental definitions and the backward Euler stress update, derive the principal-space form of the implicit radial return for $J_2$ plasticity, showing that the updated principal deviatoric stresses are colinear with the trial principal deviatoric stresses and can be expressed via a single scalar factor that you must derive from first principles. Then apply your result to the following trial state and material parameters to compute the updated principal deviatoric stresses.\n\nGiven trial principal deviatoric stresses $s_{1}^{\\mathrm{tr}} = 100~\\mathrm{MPa}$, $s_{2}^{\\mathrm{tr}} = -50~\\mathrm{MPa}$, $s_{3}^{\\mathrm{tr}} = -50~\\mathrm{MPa}$, shear modulus $G = 300~\\mathrm{MPa}$, initial yield stress $\\sigma_{y0} = 80~\\mathrm{MPa}$, isotropic hardening modulus $H = 100~\\mathrm{MPa}$, and previous equivalent plastic strain $\\bar{\\varepsilon}^{p}_{n} = 0.2$, compute the updated principal deviatoric stresses $s_{1,n+1}$, $s_{2,n+1}$, $s_{3,n+1}$ using the implicit radial return in principal space. Express the final stresses in $\\mathrm{MPa}$. If a numerical approximation is required, round your answer to four significant figures. Provide your final answer as a single row matrix of the three components.",
            "solution": "The solution proceeds in two parts. First, the general form of the implicit radial return algorithm for $J_2$ plasticity is derived. Second, this algorithm is applied to the given numerical data to find the updated stress state.\n\n**Part 1: Derivation of the Implicit Radial Return Algorithm**\n\nThe total strain increment is additively decomposed into an elastic part $\\Delta\\boldsymbol{\\varepsilon}^{e}$ and a plastic part $\\Delta\\boldsymbol{\\varepsilon}^{p}$:\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}^{e} + \\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\nThe stress increment is related to the elastic strain increment via Hooke's law, $\\Delta\\boldsymbol{\\sigma} = \\boldsymbol{C}:\\Delta\\boldsymbol{\\varepsilon}^{e}$. We can write the updated stress $\\boldsymbol{\\sigma}_{n+1}$ at step $n+1$ in terms of the trial stress $\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\boldsymbol{C}:\\Delta\\boldsymbol{\\varepsilon}$:\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\boldsymbol{C}:\\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\nFor a linear isotropic elastic material, this relation can be decomposed into volumetric and deviatoric parts. The deviatoric stress update is given by:\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2G\\,\\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\nwhere $G$ is the shear modulus. The plastic strain increment $\\Delta\\boldsymbol{\\varepsilon}^{p}$ is determined by the backward Euler integration of the associative flow rule:\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\gamma\\,\\left(\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}\\right)_{\\boldsymbol{\\sigma}=\\boldsymbol{\\sigma}_{n+1}}\n$$\nwhere $\\Delta\\gamma \\ge 0$ is the plastic multiplier increment. The yield function is $f = \\sigma_{\\mathrm{eq}} - \\sigma_{y}$, with $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$. The gradient of $f$ is:\n$$\n\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}} = \\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial\\boldsymbol{s}} = \\sqrt{\\frac{3}{2}} \\frac{\\boldsymbol{s}}{\\|\\boldsymbol{s}\\|}\n$$\nLet $\\boldsymbol{N}_{n+1} = \\frac{\\boldsymbol{s}_{n+1}}{\\|\\boldsymbol{s}_{n+1}\\|}$ be the unit normal to the yield surface in deviatoric stress space at step $n+1$. The plastic strain increment becomes:\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\gamma \\sqrt{\\frac{3}{2}}\\boldsymbol{N}_{n+1}\n$$\nSubstituting this into the deviatoric stress update equation:\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2G\\,\\left(\\Delta\\gamma \\sqrt{\\frac{3}{2}}\\boldsymbol{N}_{n+1}\\right)\n$$\nThis equation shows that $\\boldsymbol{s}_{n+1}$ is a combination of $\\boldsymbol{s}^{\\mathrm{tr}}$ and $\\boldsymbol{N}_{n+1}$. Since $\\boldsymbol{N}_{n+1}$ is by definition parallel to $\\boldsymbol{s}_{n+1}$, it must be that $\\boldsymbol{s}_{n+1}$ is colinear with $\\boldsymbol{s}^{\\mathrm{tr}}$. This geometric relationship is the origin of the term \"radial return\". It implies that the principal directions of the deviatoric stress do not change, so the unit normal can be expressed in terms of the trial state:\n$$\n\\boldsymbol{N}_{n+1} = \\frac{\\boldsymbol{s}_{n+1}}{\\|\\boldsymbol{s}_{n+1}\\|} = \\frac{\\boldsymbol{s}^{\\mathrm{tr}}}{\\|\\boldsymbol{s}^{\\mathrm{tr}}\\|} \\equiv \\boldsymbol{N}^{\\mathrm{tr}}\n$$\nThe deviatoric stress update is therefore a return mapping along the direction defined by $\\boldsymbol{s}^{\\mathrm{tr}}$:\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2G\\Delta\\gamma\\sqrt{\\frac{3}{2}}\\boldsymbol{N}^{\\mathrm{tr}}\n$$\nTo find the unknown plastic multiplier $\\Delta\\gamma$, we enforce the consistency condition, which states that for a plastic step ($\\Delta\\gamma > 0$), the final stress state must lie on the updated yield surface: $f(\\boldsymbol{\\sigma}_{n+1}, \\bar{\\varepsilon}^{p}_{n+1}) = 0$. This means:\n$$\n\\sigma_{\\mathrm{eq},n+1} = \\sigma_{y}(\\bar{\\varepsilon}^{p}_{n+1})\n$$\nTaking the norm of the stress update equation and multiplying by $\\sqrt{3/2}$:\n$$\n\\sqrt{\\frac{3}{2}}\\|\\boldsymbol{s}_{n+1}\\| = \\sqrt{\\frac{3}{2}}\\left(\\|\\boldsymbol{s}^{\\mathrm{tr}}\\| - 2G\\Delta\\gamma\\sqrt{\\frac{3}{2}}\\right) \\implies \\sigma_{\\mathrm{eq},n+1} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\gamma\n$$\nThe yield stress is updated by the hardening law: $\\sigma_{y,n+1} = \\sigma_{y0} + H\\,\\bar{\\varepsilon}^{p}_{n+1}$. With the equivalent plastic strain increment $\\Delta\\bar{\\varepsilon}^{p} = \\Delta\\gamma$, we have $\\bar{\\varepsilon}^{p}_{n+1} = \\bar{\\varepsilon}^{p}_{n} + \\Delta\\gamma$. Let $\\sigma_{y,n} = \\sigma_{y0} + H\\,\\bar{\\varepsilon}^{p}_{n}$ be the yield stress at the start of the step. Then:\n$$\n\\sigma_{y,n+1} = \\sigma_{y,n} + H\\Delta\\gamma\n$$\nEquating the expressions for $\\sigma_{\\mathrm{eq},n+1}$ and $\\sigma_{y,n+1}$:\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\gamma = \\sigma_{y,n} + H\\Delta\\gamma\n$$\nSolving for $\\Delta\\gamma$:\n$$\n\\Delta\\gamma = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y,n}}{3G + H}\n$$\nThis is valid only if plasticity occurs, i.e., $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y,n} > 0$. If $f^{\\mathrm{tr}} \\le 0$, the step is elastic and $\\Delta\\gamma=0$. So, more generally:\n$$\n\\Delta\\gamma = \\frac{\\max(0, \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y,n})}{3G + H}\n$$\nFinally, we derive the scalar factor that relates $\\boldsymbol{s}_{n+1}$ to $\\boldsymbol{s}^{\\mathrm{tr}}$. Since $\\boldsymbol{s}_{n+1}$ is colinear with $\\boldsymbol{s}^{\\mathrm{tr}}$, we can write $\\boldsymbol{s}_{n+1} = \\alpha \\boldsymbol{s}^{\\mathrm{tr}}$. The scaling factor $\\alpha$ is given by the ratio of their equivalent stresses: $\\alpha = \\sigma_{\\mathrm{eq},n+1} / \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}$. Substituting the expression for $\\sigma_{\\mathrm{eq},n+1}$:\n$$\n\\alpha = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - 3G\\Delta\\gamma}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}} = 1 - \\frac{3G\\Delta\\gamma}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}}\n$$\nThe final updated deviatoric stress is computed by scaling the trial stress: $\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} \\left(1 - \\frac{3G\\Delta\\gamma}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}}\\right)$.\n\n**Part 2: Application to Numerical Data**\n\n**Given:**\n- Trial principal deviatoric stresses: $s_{1}^{\\mathrm{tr}} = 100~\\mathrm{MPa}$, $s_{2}^{\\mathrm{tr}} = -50~\\mathrm{MPa}$, $s_{3}^{\\mathrm{tr}} = -50~\\mathrm{MPa}$.\n- Material parameters: $G = 300~\\mathrm{MPa}$, $\\sigma_{y0} = 80~\\mathrm{MPa}$, $H = 100~\\mathrm{MPa}$.\n- Previous state: $\\bar{\\varepsilon}^{p}_{n} = 0.2$.\n\n**1. Check for Plasticity**\nFirst, compute the trial equivalent stress $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}$:\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\left((s_{1}^{\\mathrm{tr}})^2 + (s_{2}^{\\mathrm{tr}})^2 + (s_{3}^{\\mathrm{tr}})^2\\right)}\n$$\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\left((100)^2 + (-50)^2 + (-50)^2\\right)} = \\sqrt{\\frac{3}{2}\\left(10000 + 2500 + 2500\\right)}\n$$\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}(15000)} = \\sqrt{22500} = 150~\\mathrm{MPa}\n$$\nNext, compute the yield stress at the beginning of the step, $\\sigma_{y,n}$:\n$$\n\\sigma_{y,n} = \\sigma_{y0} + H\\,\\bar{\\varepsilon}^{p}_{n} = 80 + 100 \\times 0.2 = 80 + 20 = 100~\\mathrm{MPa}\n$$\nThe trial yield condition is $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y,n} = 150 - 100 = 50~\\mathrm{MPa}$. Since $f^{\\mathrm{tr}} > 0$, the state is outside the elastic domain, and plastic deformation occurs.\n\n**2. Calculate the Plastic Multiplier Increment**\nUsing the derived formula:\n$$\n\\Delta\\gamma = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y,n}}{3G + H} = \\frac{150 - 100}{3(300) + 100} = \\frac{50}{900 + 100} = \\frac{50}{1000} = 0.05\n$$\n\n**3. Compute the Updated Principal Deviatoric Stresses**\nThe updated deviatoric stresses are given by $\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} \\left(1 - \\frac{3G\\,\\Delta\\gamma}{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}} \\right)$. Let's calculate the scalar factor:\n$$\n\\text{Factor} = 1 - \\frac{3(300)(0.05)}{150} = 1 - \\frac{900 \\times 0.05}{150} = 1 - \\frac{45}{150} = 1 - 0.3 = 0.7\n$$\nNow, apply this factor to the trial principal deviatoric stresses:\n$$\ns_{1,n+1} = 0.7 \\times s_{1}^{\\mathrm{tr}} = 0.7 \\times 100 = 70~\\mathrm{MPa}\n$$\n$$\ns_{2,n+1} = 0.7 \\times s_{2}^{\\mathrm{tr}} = 0.7 \\times (-50) = -35~\\mathrm{MPa}\n$$\n$$\ns_{3,n+1} = 0.7 \\times s_{3}^{\\mathrm{tr}} = 0.7 \\times (-50) = -35~\\mathrm{MPa}\n$$\nThese results are exact and do not require rounding. The final updated principal deviatoric stresses are $(70, -35, -35)~\\mathrm{MPa}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 70 & -35 & -35 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Implementing a numerical algorithm is only the first step; verifying its correctness is a critical and non-trivial part of computational science. This practice  shifts our focus from implementation to verification, using a uniaxial benchmark test for which a closed-form analytical solution can be derived. By comparing your numerical implementation against this exact solution and evaluating key metrics like convergence rate and thermodynamic consistency, you will develop the skills necessary to build confidence in the predictive capabilities of your computational models.",
            "id": "3532179",
            "problem": "A small-strain isotropic elastic von Mises (second invariant of the deviatoric stress, $J_2$) rate-independent plasticity model with linear isotropic hardening is integrated in time using the Backward Euler (BE) implicit scheme. Consider a uniaxial strain-controlled benchmark: a prismatic bar subject to a single axial strain increment from $ \\varepsilon_{n} = 0 $ to $ \\varepsilon_{n+1} = 0.005 $, with initial plastic strain $ \\varepsilon^{p}_{n} = 0 $ and equivalent plastic strain $ \\kappa_{n} = 0 $. The material parameters are Young’s modulus $E = 20\\,\\text{GPa}$, Poisson’s ratio $\\nu = 0.25$, initial yield stress $\\sigma_{y0} = 50\\,\\text{MPa}$, and linear isotropic hardening modulus $H = 100\\,\\text{MPa}$. The shear modulus is $G = \\dfrac{E}{2(1+\\nu)}$.\n\nUnder uniaxial loading for the $J_2$ model, the equivalent stress satisfies $q = \\sqrt{\\dfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$, and in a uniaxial stress state $q = |\\sigma|$. The BE return mapping enforces the consistency condition $f_{n+1} = q_{n+1} - \\sigma_{y}(\\kappa_{n+1}) = 0$ if plastic loading occurs, with $\\sigma_{y}(\\kappa) = \\sigma_{y0} + H \\kappa$ and associated flow.\n\nSelect the option that correctly formulates a closed-form uniaxial return-mapping benchmark for this increment and outlines appropriate verification metrics for both the implicit integrator and the consistent algorithmic tangent (CAT). The correct option must include: an explicit closed-form expression for the plastic multiplier increment $\\Delta \\lambda$, stress and internal variable updates specialized to uniaxial loading, the one-dimensional consistent tangent modulus for this case, and scientifically sound verification metrics for both local integration and tangent consistency.\n\nA. Plastic step is detected if $|\\sigma^{\\mathrm{tr}}| > \\sigma_{y0} + H \\kappa_{n}$, where $\\sigma^{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n})$. The closed-form plastic corrector for the uniaxial case is\n$$\n\\Delta \\lambda = \\dfrac{|\\sigma^{\\mathrm{tr}}| - \\big(\\sigma_{y0} + H \\kappa_{n}\\big)}{E + H}, \\quad\n\\sigma_{n+1} = \\operatorname{sign}(\\sigma^{\\mathrm{tr}})\\,\\sigma_{y}(\\kappa_{n} + \\Delta \\lambda),\n$$\n$$\n\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta \\lambda\\,\\operatorname{sign}(\\sigma^{\\mathrm{tr}}), \\quad\n\\kappa_{n+1} = \\kappa_{n} + \\Delta \\lambda.\n$$\nThe one-dimensional consistent tangent modulus in the plastic regime is\n$$\nE_{\\mathrm{ep}} = \\dfrac{E\\,H}{E + H}.\n$$\nVerification metrics: enforce $|f_{n+1}| \\le \\text{tol}$ for the yield residual; confirm that the Newton-Raphson (NR) local solve with the CAT converges in one iteration for linear isotropic hardening; verify $E_{\\mathrm{ep}} = \\dfrac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}}$ by differentiating the closed-form mapping; confirm nonnegative incremental plastic work $W_{p} = \\sigma_{n+1}\\,\\Delta \\varepsilon^{p} \\ge 0$; and check elastic/plastic branch switching occurs exactly at $|\\sigma^{\\mathrm{tr}}| = \\sigma_{y0} + H \\kappa_{n}$.\n\nB. Plastic step is detected if $|\\sigma^{\\mathrm{tr}}| > \\sigma_{y0} + H \\kappa_{n}$, with $\\sigma^{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n})$. The plastic corrector uses\n$$\n\\Delta \\lambda = \\dfrac{|\\sigma^{\\mathrm{tr}}| - \\big(\\sigma_{y0} + H \\kappa_{n}\\big)}{3G + H}, \\quad\n\\sigma_{n+1} = \\operatorname{sign}(\\sigma^{\\mathrm{tr}})\\,\\sigma_{y}(\\kappa_{n} + \\Delta \\lambda),\n$$\n$$\n\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta \\lambda\\,\\operatorname{sign}(\\sigma^{\\mathrm{tr}}), \\quad\n\\kappa_{n+1} = \\kappa_{n} + \\sqrt{\\dfrac{2}{3}}\\,\\Delta \\lambda.\n$$\nThe consistent tangent modulus is stated as\n$$\nE_{\\mathrm{ep}} = \\dfrac{E\\,(3G)}{3G + H}.\n$$\nVerification metrics: check $|f_{n+1}| \\le \\text{tol}$ and that the CAT is symmetric positive definite for any step; energy checks are not required because $J_2$ plasticity is isochoric.\n\nC. Plastic step is detected by $q^{\\mathrm{tr}} = |\\sigma^{\\mathrm{tr}}| > \\sigma_{y0} + H \\kappa_{n}$, with $\\sigma^{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n})$. The plastic correction is written as\n$$\n\\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - 3G\\,\\Delta \\lambda\\,\\operatorname{sign}(\\sigma^{\\mathrm{tr}}), \\quad\n\\Delta \\lambda = \\dfrac{|\\sigma^{\\mathrm{tr}}| - \\big(\\sigma_{y0} + H \\kappa_{n}\\big)}{2G + H},\n$$\n$$\n\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\sqrt{\\dfrac{2}{3}}\\,\\Delta \\lambda\\,\\operatorname{sign}(\\sigma^{\\mathrm{tr}}), \\quad\n\\kappa_{n+1} = \\kappa_{n} + \\sqrt{\\dfrac{2}{3}}\\,\\Delta \\lambda.\n$$\nThe consistent tangent modulus is\n$$\nE_{\\mathrm{ep}} = \\dfrac{E\\,H}{3G + H}.\n$$\nVerification metrics: check only that $\\sigma_{n+1}$ is within $\\pm 1\\,\\text{MPa}$ of the expected value; convergence rate assessment is unnecessary if residuals are small.\n\nD. Plastic step detection and plastic multiplier use\n$$\n\\Delta \\lambda = \\dfrac{|\\sigma^{\\mathrm{tr}}| - \\big(\\sigma_{y0} + H \\kappa_{n}\\big)}{E + H}, \\quad\n\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta \\lambda\\,\\operatorname{sign}(\\sigma^{\\mathrm{tr}}), \\quad\n\\kappa_{n+1} = \\kappa_{n} + \\Delta \\lambda,\n$$\nbut the stress update is taken as purely elastic with\n$$\n\\sigma_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n+1}),\n$$\nand the consistent tangent modulus in the plastic regime is stated as\n$$\nE_{\\mathrm{ep}} = E - H.\n$$\nVerification metrics: require linear (not quadratic) NR convergence, and test tangent consistency by comparing to a secant slope over a finite strain interval rather than the instantaneous derivative.",
            "solution": "To determine the correct option, we must derive the closed-form solution for the 1D specialization of the rate-independent $J_2$ plasticity model. This will allow us to evaluate the correctness of the formulas presented in each option.\n\nThere is a subtle ambiguity in the problem statement: a \"uniaxial strain\" condition ($\\varepsilon_{22} = \\varepsilon_{33} = 0$) in a 3D continuum induces a multiaxial stress state, for which the simplification $q = |\\sigma|$ does not hold. However, the provided options are formulated for a one-dimensional (1D) model, which corresponds to a uniaxial *stress* state. In the context of computational mechanics benchmarks, it is common to refer to such a 1D idealization as a \"uniaxial test.\" We proceed by analyzing this 1D model.\n\n### Derivation of the 1D Model Solution\n\n**1. Elastic Trial Step**\nFirst, we compute a trial stress, $\\sigma^{\\mathrm{tr}}$, assuming the entire strain increment is elastic. The 1D Hooke's law is $\\sigma = E(\\varepsilon - \\varepsilon^p)$.\n$$\n\\sigma^{\\mathrm{tr}} = E (\\varepsilon_{n+1} - \\varepsilon^{p}_{n})\n$$\nUsing the given values:\n$$\n\\sigma^{\\mathrm{tr}} = (20 \\times 10^3\\,\\text{MPa}) \\times (0.005 - 0) = 100\\,\\text{MPa}\n$$\nNext, we check for yielding by evaluating the trial yield function, $f^{\\mathrm{tr}} = |\\sigma^{\\mathrm{tr}}| - \\sigma_y(\\kappa_n)$. The yield stress at the beginning of the increment (step $n$) is:\n$$\n\\sigma_y(\\kappa_n) = \\sigma_{y0} + H\\kappa_n = 50\\,\\text{MPa} + (100\\,\\text{MPa}) \\times 0 = 50\\,\\text{MPa}\n$$\nThe trial yield function value is:\n$$\nf^{\\mathrm{tr}} = |100\\,\\text{MPa}| - 50\\,\\text{MPa} = 50\\,\\text{MPa}\n$$\nSince $f^{\\mathrm{tr}} > 0$, plastic deformation occurs, and a return mapping is necessary.\n\n**2. Plastic Corrector (Return Mapping)**\nThe Backward Euler scheme formulates the update equations at the end of the step, $n+1$:\n(i) Stress update: $\\sigma_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon^p_{n+1})$\n(ii) Plastic strain flow rule: $\\varepsilon^p_{n+1} = \\varepsilon^p_n + \\Delta\\varepsilon^p = \\varepsilon^p_n + \\Delta\\lambda \\operatorname{sign}(\\sigma_{n+1})$. For the $J_2$ model simplified to 1D, the increment of the axial plastic strain component is $\\Delta\\varepsilon_p = \\Delta\\lambda \\operatorname{sign}(\\sigma)$.\n(iii) Hardening evolution: $\\kappa_{n+1} = \\kappa_n + \\Delta\\kappa$. For the standard $J_2$ model, the increment of the work-conjugate equivalent plastic strain is $\\Delta\\kappa = \\Delta\\lambda$.\n(iv) Consistency condition: $f_{n+1} = |\\sigma_{n+1}| - \\sigma_y(\\kappa_{n+1}) = 0$.\n\nSince $\\sigma^{\\mathrm{tr}} > 0$, we can assume $\\sigma_{n+1} > 0$, so $\\operatorname{sign}(\\sigma_{n+1}) = \\operatorname{sign}(\\sigma^{\\mathrm{tr}}) = 1$.\nFrom (i) and (ii):\n$$\n\\sigma_{n+1} = E(\\varepsilon_{n+1} - (\\varepsilon^p_n + \\Delta\\lambda)) = E(\\varepsilon_{n+1} - \\varepsilon^p_n) - E\\Delta\\lambda = \\sigma^{\\mathrm{tr}} - E\\Delta\\lambda\n$$\nFrom (iii) and (iv):\n$$\n\\sigma_{n+1} = \\sigma_y(\\kappa_{n+1}) = \\sigma_{y0} + H\\kappa_{n+1} = \\sigma_{y0} + H(\\kappa_n + \\Delta\\lambda)\n$$\nEquating the two expressions for $\\sigma_{n+1}$:\n$$\n\\sigma^{\\mathrm{tr}} - E\\Delta\\lambda = \\sigma_{y0} + H\\kappa_n + H\\Delta\\lambda\n$$\nRearranging to solve for the plastic multiplier increment $\\Delta\\lambda$:\n$$\n\\sigma^{\\mathrm{tr}} - (\\sigma_{y0} + H\\kappa_n) = (E + H)\\Delta\\lambda\n$$\nFor a general sign of stress, this becomes:\n$$\n\\Delta\\lambda = \\frac{|\\sigma^{\\mathrm{tr}}| - (\\sigma_{y0} + H\\kappa_n)}{E+H}\n$$\nThe updated state variables are then calculated using this $\\Delta\\lambda$.\n\n**3. Consistent Algorithmic Tangent (CAT)**\nThe 1D consistent tangent modulus, $E_{\\mathrm{ep}}$, is the derivative of the updated stress $\\sigma_{n+1}$ with respect to the total strain $\\varepsilon_{n+1}$, holding the state at step $n$ constant: $E_{\\mathrm{ep}} = \\frac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}}$.\nUsing the expression $\\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - E\\Delta\\lambda$ and substituting the formula for $\\Delta\\lambda$ (assuming $\\sigma^{\\mathrm{tr}} > 0$):\n$$\n\\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - E \\left( \\frac{\\sigma^{\\mathrm{tr}} - (\\sigma_{y0} + H\\kappa_n)}{E+H} \\right)\n$$\nSince $\\sigma^{\\mathrm{tr}} = E(\\varepsilon_{n+1} - \\varepsilon^p_n)$, we have $\\frac{\\partial \\sigma^{\\mathrm{tr}}}{\\partial \\varepsilon_{n+1}} = E$. Differentiating $\\sigma_{n+1}$:\n$$\nE_{\\mathrm{ep}} = \\frac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}} = \\frac{\\partial \\sigma^{\\mathrm{tr}}}{\\partial \\varepsilon_{n+1}} - \\frac{E}{E+H} \\frac{\\partial \\sigma^{\\mathrm{tr}}}{\\partial \\varepsilon_{n+1}} = E - \\frac{E^2}{E+H}\n$$\n$$\nE_{\\mathrm{ep}} = E \\left( 1 - \\frac{E}{E+H} \\right) = E \\left( \\frac{E+H-E}{E+H} \\right) = \\frac{EH}{E+H}\n$$\n\n**4. Verification Metrics**\nFor a robust implementation, several checks are crucial:\n- **Consistency**: The final stress state must lie on the yield surface, i.e., $|f_{n+1}| = ||\\sigma_{n+1}|-\\sigma_y(\\kappa_{n+1})| \\le \\text{tol}$, where $\\text{tol}$ is a small numerical tolerance.\n- **Convergence**: For linear hardening, the local problem of finding $\\Delta\\lambda$ is linear. Therefore, a Newton-Raphson method applied to solve for the state update should converge in exactly one iteration. For global analysis, using the CAT ensures asymptotic quadratic convergence of the Newton-Raphson scheme.\n- **Tangent Correctness**: The analytical formula for $E_{\\mathrm{ep}}$ must match the definition $\\frac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}}$.\n- **Thermodynamic Consistency**: The plastic work increment, $W_p = \\sigma_{n+1} \\Delta\\varepsilon^p$, must be non-negative.\n- **Branching Logic**: The code must correctly transition between elastic and plastic behavior.\n\n### Option-by-Option Analysis\n\n**A. Plastic step is detected if...**\n- **Formulation**: The formulas for trial stress, plastic multiplier $\\Delta \\lambda$, state variable updates ($\\sigma_{n+1}$, $\\varepsilon^p_{n+1}$, $\\kappa_{n+1}$), and the consistent tangent modulus $E_{\\mathrm{ep}} = \\frac{EH}{E+H}$ are all identical to those derived above for the correct 1D model.\n- **Verification Metrics**: The listed metrics (yield residual check, one-step convergence for local NR, confirmation of tangent definition, non-negative plastic work, and correct branch switching) are all scientifically sound, comprehensive, and appropriate for verifying an implicit plasticity integrator.\n- **Verdict**: **Correct**.\n\n**B. Plastic step is detected if...**\n- **Formulation**: The formula for $\\Delta \\lambda$ uses a denominator of $3G+H$, which is appropriate for the general 3D return mapping algorithm, but it is incorrectly mixed with a numerator based on the 1D trial stress definition. The hardening update $\\kappa_{n+1} = \\kappa_{n} + \\sqrt{\\frac{2}{3}}\\,\\Delta \\lambda$ is incorrect for the given model definition where $\\Delta\\kappa = \\Delta\\lambda$. The tangent modulus is also incorrect.\n- **Verification Metrics**: The metrics are incomplete. The justification that `energy checks are not required because J2 plasticity is isochoric` is fundamentally flawed. Incompressibility of plastic flow does not obviate the need to check for positive plastic dissipation.\n- **Verdict**: **Incorrect**.\n\n**C. Plastic step is detected by...**\n- **Formulation**: The stress update $\\sigma_{n+1} = \\sigma^{\\mathrm{tr}} - 3G\\,\\Delta \\lambda\\,\\operatorname{sign}(\\sigma^{\\mathrm{tr}})$ is incorrect; $3G\\Delta\\lambda$ is the magnitude of the update for the equivalent stress $q$ in 3D, not the uniaxial stress component $\\sigma$. The denominator for $\\Delta\\lambda$ and the hardening update are incorrect. The tangent modulus is incorrect.\n- **Verification Metrics**: The proposed metrics are unscientific. A fixed error tolerance is arbitrary, and dismissing convergence rate assessment demonstrates a poor understanding of numerical methods.\n- **Verdict**: **Incorrect**.\n\n**D. Plastic step is detected...**\n- **Formulation**: The stated consistent tangent modulus $E_{\\mathrm{ep}} = E - H$ is incorrect.\n- **Verification Metrics**: The metrics are incorrect. The CAT should provide quadratic, not linear, convergence for the global problem. Testing the tangent against a secant slope over a *finite* interval verifies a secant modulus, not the consistent *tangent* modulus.\n- **Verdict**: **Incorrect**.\n\nBased on the detailed analysis, only Option A provides a complete and correct description of the solution methodology and verification process for the intended problem.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "While smooth yield surfaces like von Mises are instructive, many real-world geomaterials are better described by pressure-dependent models with non-smooth yield surfaces, such as the Mohr-Coulomb model. The corners and edges of these surfaces pose a significant challenge for the simple radial return algorithm. This exercise  delves into the general closest-point projection algorithm, using the principles of constrained optimization to develop a robust 'active-set' strategy that can correctly handle returns to both faces and vertices of the yield surface, a crucial technique for developing reliable geomechanical simulation tools.",
            "id": "3532160",
            "problem": "Consider small-strain elasto-plasticity with a convex yield surface in stress space. The return mapping algorithm seeks the updated stress by enforcing that the final stress lies on or within the yield surface and is the closest to the elastic trial stress, in the sense of minimizing a Euclidean norm in stress space. The Mohr–Coulomb yield surface is non-smooth and features corners on its deviatoric section, which complicates the closest-point projection. In Haigh–Westergaard coordinates, the deviatoric section (the so-called $\\pi$-plane) of the Mohr–Coulomb surface at fixed mean stress $p$ is a regular hexagon.\n\nFundamental base: In convex elasto-plasticity, the admissible stress set $\\mathcal{K}$ is defined by a yield function $f(\\boldsymbol{\\sigma}) \\le 0$, with yield condition $f(\\boldsymbol{\\sigma}) = 0$ on the boundary. The implicit stress integration via closest-point projection solves the variational problem of finding the stress $\\boldsymbol{\\sigma}^{\\star}$ that minimizes the squared distance to the elastic trial stress $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ subject to $\\boldsymbol{\\sigma}^{\\star} \\in \\mathcal{K}$. The Kuhn–Tucker conditions ensure that, at the optimum, only the active yield constraints contribute via Lagrange multipliers. For a non-smooth surface like Mohr–Coulomb, multiple planes can be simultaneously active at corners.\n\nIn this problem, you will work in the deviatoric $\\pi$-plane and model the Mohr–Coulomb deviatoric section at a fixed mean stress $p$ as the convex set $\\mathcal{H}_R$ defined as:\n$$\n\\mathcal{H}_R = \\bigcap_{i=0}^{5} \\left\\{ \\mathbf{x} \\in \\mathbb{R}^2 \\;\\middle|\\; \\mathbf{n}_i^{\\top} \\mathbf{x} \\le R \\right\\},\n$$\nwhere $R>0$ is the inradius (a given constant determined by material parameters such as friction angle and cohesion at the specified mean stress), and $\\{\\mathbf{n}_i\\}_{i=0}^{5}$ are outward unit normals of the six faces of a regular hexagon, defined as\n$$\n\\mathbf{n}_0 = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix},\\quad\n\\mathbf{n}_1 = \\begin{bmatrix}\\tfrac{1}{2} \\\\ \\tfrac{\\sqrt{3}}{2}\\end{bmatrix},\\quad\n\\mathbf{n}_2 = \\begin{bmatrix}-\\tfrac{1}{2} \\\\ \\tfrac{\\sqrt{3}}{2}\\end{bmatrix},\\quad\n\\mathbf{n}_3 = \\begin{bmatrix}-1 \\\\ 0\\end{bmatrix},\\quad\n\\mathbf{n}_4 = \\begin{bmatrix}-\\tfrac{1}{2} \\\\ -\\tfrac{\\sqrt{3}}{2}\\end{bmatrix},\\quad\n\\mathbf{n}_5 = \\begin{bmatrix}\\tfrac{1}{2} \\\\ -\\tfrac{\\sqrt{3}}{2}\\end{bmatrix}.\n$$\nYou are given trial deviatoric stress points $\\mathbf{t} \\in \\mathbb{R}^2$. The implicit closest-point projection seeks\n$$\n\\mathbf{x}^{\\star} = \\arg\\min_{\\mathbf{x} \\in \\mathcal{H}_R} \\frac{1}{2} \\left\\| \\mathbf{x} - \\mathbf{t} \\right\\|_2^2.\n$$\nThe presence of corners allows the optimal solution $\\mathbf{x}^{\\star}$ to lie on a single face interior (one active plane) or at a vertex (intersection of two adjacent active planes). Your task is to derive, from first principles, an active-plane detection strategy that identifies whether the closest-point projection lies on a face interior or at a vertex, and then computes the projected point.\n\nRequirements:\n1. Derive the conditions under which the closest-point projection onto $\\mathcal{H}_R$ lies on a single face interior, and the conditions under which it lies at a vertex formed by the intersection of two adjacent faces. Use the variational characterization of the closest-point projection and the Kuhn–Tucker conditions as the fundamental base for your derivation.\n2. Implement a program that, given $R$ and a set of trial points $\\mathbf{t}$, performs the following for each trial point:\n   - If $\\mathbf{t} \\in \\mathcal{H}_R$, classify the case as elastic and return the classification integer $0$, the empty active set, and the distance $0$.\n   - If $\\mathbf{t} \\notin \\mathcal{H}_R$, compute $\\mathbf{x}^{\\star}$ and detect the active set as follows:\n     - If the projection lies on a single face interior, classify as plastic-face with classification integer $1$ and return the active plane index $i$.\n     - If the projection lies at a vertex, classify as plastic-corner with classification integer $2$ and return the two adjacent active plane indices $\\{i,j\\}$ with $j \\in \\{(i-1) \\bmod 6, (i+1) \\bmod 6\\}$.\n   - Report the Euclidean distance $\\|\\mathbf{x}^{\\star} - \\mathbf{t}\\|_2$ rounded to six decimals.\n3. Numerical robustness: Treat equality checks with a tolerance $\\varepsilon = 10^{-9}$ when deciding feasibility and activity.\n4. Use the provided normals $\\mathbf{n}_i$ and the given $R$; assume that $R$ is already computed from material parameters at the specified mean stress and is provided to you. No physical units are required for the outputs.\n5. Test suite: Use $R=1$ and the following five trial points in the $\\pi$-plane:\n   - Case A (outside, face-dominated): $\\mathbf{t}_A = (1.5, 0.0)$.\n   - Case B (outside, corner-dominated): $\\mathbf{t}_B = (1.2, 0.8)$.\n   - Case C (inside): $\\mathbf{t}_C = (0.2, 0.1)$.\n   - Case D (on a face interior): $\\mathbf{t}_D = (1.0, 0.0)$.\n   - Case E (on a vertex): $\\mathbf{t}_E = \\left(1.0, \\tfrac{1}{\\sqrt{3}}\\right)$.\n6. Final output format: Your program should produce a single line of output containing a list of five entries, one per test case, preserving the order A, B, C, D, E. Each entry must be a list of the form $[\\text{class}, [\\text{active\\_indices}], \\text{distance}]$, where $\\text{class}$ is an integer, $[\\text{active\\_indices}]$ is a list of integers, and $\\text{distance}$ is a float rounded to six decimals. The entire output must be a single comma-separated list enclosed in square brackets. For example: $[[1,[0],0.123456],[2,[1,2],0.654321],\\ldots]$.\n\nYour program must be complete and runnable and must not require any user input.",
            "solution": "The problem requires the derivation and implementation of a closest-point projection algorithm for a trial deviatoric stress point onto a regular hexagonal domain, which models the Mohr–Coulomb yield surface in the $\\pi$-plane. The derivation must be based on the variational principles of plasticity and the Karush–Kuhn–Tucker (KKT) conditions for constrained optimization.\n\nThe optimization problem is to find the point $\\mathbf{x}^{\\star}$ in the convex set $\\mathcal{H}_R$ that minimizes the squared Euclidean distance to a given trial point $\\mathbf{t} \\in \\mathbb{R}^2$. The feasible set $\\mathcal{H}_R$ is defined by six linear inequality constraints:\n$$\n\\mathcal{H}_R = \\left\\{ \\mathbf{x} \\in \\mathbb{R}^2 \\;\\middle|\\; g_i(\\mathbf{x}) = \\mathbf{n}_i^{\\top} \\mathbf{x} - R \\le 0, \\quad i = 0, \\dots, 5 \\right\\}\n$$\nThe minimization problem is thus stated as:\n$$\n\\text{minimize} \\quad L(\\mathbf{x}) = \\frac{1}{2} \\| \\mathbf{x} - \\mathbf{t} \\|_2^2 \\quad \\text{subject to} \\quad \\mathbf{x} \\in \\mathcal{H}_R\n$$\nThe Lagrangian for this problem is:\n$$\n\\mathcal{L}(\\mathbf{x}, \\boldsymbol{\\lambda}) = \\frac{1}{2} \\left( \\mathbf{x} - \\mathbf{t} \\right)^{\\top} \\left( \\mathbf{x} - \\mathbf{t} \\right) + \\sum_{i=0}^{5} \\lambda_i \\left( \\mathbf{n}_i^{\\top} \\mathbf{x} - R \\right)\n$$\nwhere $\\lambda_i$ are the Lagrange multipliers. At the optimal solution $(\\mathbf{x}^{\\star}, \\boldsymbol{\\lambda}^{\\star})$, the KKT conditions must be satisfied:\n1. **Stationarity**: The gradient of the Lagrangian with respect to $\\mathbf{x}$ vanishes:\n$$\n\\nabla_{\\mathbf{x}} \\mathcal{L}(\\mathbf{x}^{\\star}, \\boldsymbol{\\lambda}^{\\star}) = \\mathbf{x}^{\\star} - \\mathbf{t} + \\sum_{i=0}^{5} \\lambda_i^{\\star} \\mathbf{n}_i = \\mathbf{0} \\quad \\implies \\quad \\mathbf{t} - \\mathbf{x}^{\\star} = \\sum_{i=0}^{5} \\lambda_i^{\\star} \\mathbf{n}_i\n$$\n2. **Primal Feasibility**: The solution must be in the feasible set:\n$$\n\\mathbf{n}_i^{\\top} \\mathbf{x}^{\\star} - R \\le 0 \\quad \\text{for all } i \\in \\{0, \\dots, 5\\}\n$$\n3. **Dual Feasibility**: The Lagrange multipliers must be non-negative:\n$$\n\\lambda_i^{\\star} \\ge 0 \\quad \\text{for all } i \\in \\{0, \\dots, 5\\}\n$$\n4. **Complementary Slackness**: For each constraint, either the multiplier is zero or the constraint is active:\n$$\n\\lambda_i^{\\star} \\left( \\mathbf{n}_i^{\\top} \\mathbf{x}^{\\star} - R \\right) = 0 \\quad \\text{for all } i \\in \\{0, \\dots, 5\\}\n$$\nThe stationarity condition states that the vector from the projected point $\\mathbf{x}^{\\star}$ to the trial point $\\mathbf{t}$ must be expressible as a non-negative linear combination of the outward normals of the active constraints (where $\\mathbf{n}_i^{\\top} \\mathbf{x}^{\\star} - R = 0$).\n\nWe analyze the possible cases based on the location of the trial point $\\mathbf{t}$.\n\n**Case 0: Elastic (if $\\mathbf{t} \\in \\mathcal{H}_R$)**\nIf the trial point $\\mathbf{t}$ is already inside or on the boundary of the feasible set $\\mathcal{H}_R$, it is its own closest point. The minimum of $L(\\mathbf{x})$ is at $\\mathbf{x}^{\\star} = \\mathbf{t}$, with a value of $0$. The stationarity condition becomes $\\mathbf{t} - \\mathbf{t} = \\sum \\lambda_i^{\\star} \\mathbf{n}_i = \\mathbf{0}$, which implies all $\\lambda_i^{\\star} = 0$. Primal feasibility requires $\\mathbf{n}_i^{\\top}\\mathbf{t} - R \\le 0$ for all $i$. Thus, if $\\mathbf{n}_i^{\\top}\\mathbf{t} - R \\le \\varepsilon$ for all $i$ (using the given numerical tolerance), the case is elastic, the active set is empty, and the distance is $0$.\n\n**Case 1: Plastic Return to a Face (one active constraint)**\nSuppose the trial point $\\mathbf{t}$ is outside $\\mathcal{H}_R$, and its projection $\\mathbf{x}^{\\star}$ lies on the interior of a single face $k$. From complementary slackness, only $\\lambda_k^{\\star}$ can be non-zero. The stationarity equation simplifies to $\\mathbf{t} - \\mathbf{x}^{\\star} = \\lambda_k^{\\star} \\mathbf{n}_k$. The constraint for face $k$ is active: $\\mathbf{n}_k^{\\top}\\mathbf{x}^{\\star} = R$. Solving for $\\mathbf{x}^{\\star}$ from stationarity gives $\\mathbf{x}^{\\star} = \\mathbf{t} - \\lambda_k^{\\star} \\mathbf{n}_k$. Substituting this into the active constraint: $\\mathbf{n}_k^{\\top}(\\mathbf{t} - \\lambda_k^{\\star} \\mathbf{n}_k) = R$. Since $\\mathbf{n}_k$ is a unit normal, $\\|\\mathbf{n}_k\\|_2^2 = 1$, we find the multiplier: $\\lambda_k^{\\star} = \\mathbf{n}_k^{\\top}\\mathbf{t} - R$. Dual feasibility requires $\\lambda_k^{\\star} > 0$, confirming that $\\mathbf{t}$ is outside the half-space defined by face $k$. The projected point is therefore $\\mathbf{x}^{\\star} = \\mathbf{t} - (\\mathbf{n}_k^{\\top}\\mathbf{t} - R)\\mathbf{n}_k$. For this solution to be valid, $\\mathbf{x}^\\star$ must not violate any other constraint, i.e., $\\mathbf{n}_i^{\\top}\\mathbf{x}^\\star - R \\le 0$ for all $i \\ne k$. This means the projection falls within the line segment corresponding to face $k$ of the hexagon.\n\n**Case 2: Plastic Return to a Corner (two active constraints)**\nIf the projection $\\mathbf{x}^{\\star}$ is a vertex, it is the intersection of two adjacent faces, say $j$ and $k=(j+1)\\pmod 6$. The position of the vertex $\\mathbf{x}^{\\star}$ is found by solving the linear system:\n$$\n\\begin{bmatrix} \\mathbf{n}_j^{\\top} \\\\ \\mathbf{n}_k^{\\top} \\end{bmatrix} \\mathbf{x}^{\\star} = \\begin{bmatrix} R \\\\ R \\end{bmatrix}\n$$\nFrom complementary slackness, only $\\lambda_j^{\\star}$ and $\\lambda_k^{\\star}$ can be non-zero. The stationarity condition is $\\mathbf{t} - \\mathbf{x}^{\\star} = \\lambda_j^{\\star} \\mathbf{n}_j + \\lambda_k^{\\star} \\mathbf{n}_k$. This is a linear system for the multipliers:\n$$\n\\begin{bmatrix} \\mathbf{n}_j & \\mathbf{n}_k \\end{bmatrix} \\begin{bmatrix} \\lambda_j^{\\star} \\\\ \\lambda_k^{\\star} \\end{bmatrix} = \\mathbf{t} - \\mathbf{x}^{\\star}\n$$\nThe solution is valid if dual feasibility is met: $\\lambda_j^{\\star} \\ge 0$ and $\\lambda_k^{\\star} \\ge 0$. This condition geometrically means that the vector $\\mathbf{t} - \\mathbf{x}^{\\star}$ must lie within the cone spanned by the normals $\\mathbf{n}_j$ and $\\mathbf{n}_k$.\n\n**Active-Plane Detection Strategy**\nBased on this analysis, the following algorithm determines the active set and computes the projection $\\mathbf{x}^{\\star}$ for a given trial point $\\mathbf{t}$:\n$1$. **Elasticity Check**: For each face $i=0, \\dots, 5$, compute the signed distance $d_i = \\mathbf{n}_i^{\\top}\\mathbf{t} - R$. If $\\max_i(d_i) \\le \\varepsilon$, the point is inside or on the boundary of $\\mathcal{H}_R$. The case is elastic, $\\mathbf{x}^{\\star}=\\mathbf{t}$, the active set is empty, and the distance is $0$.\n$2$. **Face-Return Hypothesis**: If the point is outside, find the most violated constraint, $k = \\arg\\max_i(d_i)$. Hypothesize that the projection is onto the interior of face $k$. Compute the candidate projection point $\\mathbf{x}_{\\text{face}} = \\mathbf{t} - d_k \\mathbf{n}_k$. Check if this point lies on the face segment by verifying that the constraints of the two adjacent faces are satisfied: $\\mathbf{n}_{(k-1)\\pmod 6}^{\\top} \\mathbf{x}_{\\text{face}} \\le R+\\varepsilon$ and $\\mathbf{n}_{(k+1)\\pmod 6}^{\\top} \\mathbf{x}_{\\text{face}} \\le R+\\varepsilon$. If both conditions hold, the hypothesis is correct. The case is a plastic-face return, the active set is $\\{k\\}$, and $\\mathbf{x}^{\\star} = \\mathbf{x}_{\\text{face}}$.\n$3$. **Corner-Return Case**: If the face-return hypothesis fails, the trial point must lie in a region where the projection is a vertex. By convexity, the closest point in $\\mathcal{H}_R$ must be one of the two vertices of the most violated face $k$. Let these vertices be $v_k$ (intersection of faces $k-1$ and $k$) and $v_{k+1}$ (intersection of faces $k$ and $k+1$). Compute the distances $\\|\\mathbf{t}-v_k\\|_2$ and $\\|\\mathbf{t}-v_{k+1}\\|_2$. The closer vertex is the solution $\\mathbf{x}^{\\star}$. If $v_k$ is closer, the active planes are $\\{(k-1)\\pmod 6, k\\}$. If $v_{k+1}$ is closer, the active planes are $\\{k, (k+1)\\pmod 6\\}$. This is a plastic-corner return.\n\nThis strategy systematically and correctly identifies the active set and the closest point $\\mathbf{x}^{\\star}$ for any trial point $\\mathbf{t} \\in \\mathbb{R}^2$.",
            "answer": "```python\nimport numpy as np\n\ndef setup_geometry(R):\n    \"\"\"\n    Sets up the normals and vertices for the regular hexagon with inradius R.\n\n    Args:\n        R (float): The inradius of the hexagon.\n\n    Returns:\n        tuple: A tuple containing:\n            - np.ndarray: An array of the six outward unit normals.\n            - np.ndarray: An array of the six vertices of the hexagon. \n                          vertex[i] is the intersection of faces (i-1)%6 and i.\n    \"\"\"\n    s3_2 = np.sqrt(3) / 2.0\n    normals = np.array([\n        [1.0, 0.0],\n        [0.5, s3_2],\n        [-0.5, s3_2],\n        [-1.0, 0.0],\n        [-0.5, -s3_2],\n        [0.5, -s3_2]\n    ])\n    \n    vertices = np.zeros((6, 2))\n    for i in range(6):\n        im1 = (i - 1) % 6\n        # The vertex is the solution to a 2x2 linear system\n        # [n_{i-1}^T] * x = [R]\n        # [n_i^T    ]     [R]\n        A = np.array([normals[im1], normals[i]])\n        b = np.array([R, R])\n        vertices[i] = np.linalg.solve(A, b)\n        \n    return normals, vertices\n\ndef project_to_hexagon(t, R, normals, vertices, tolerance):\n    \"\"\"\n    Projects a trial point t onto the hexagon H_R.\n\n    Args:\n        t (np.ndarray): The 2D trial point.\n        R (float): The inradius of the hexagon.\n        normals (np.ndarray): The normals of the hexagon's faces.\n        vertices (np.ndarray): The vertices of the hexagon.\n        tolerance (float): Numerical tolerance for equality checks.\n\n    Returns:\n        list: A list containing [class, [active_indices], distance].\n    \"\"\"\n    # 1. Elastic Check: Check if the point is inside or on the boundary.\n    # Calculate violations d_i = n_i^T * t - R\n    violations = normals @ t - R\n    max_violation = np.max(violations)\n    \n    if max_violation <= tolerance:\n        # Point is inside or on the boundary (elastic case).\n        # Per problem statement, active set is empty and distance is 0.\n        return [0, [], 0.0]\n\n    # 2. Plastic Check: The point is outside.\n    # Identify the most violated plane (largest positive violation).\n    k = np.argmax(violations)\n    \n    # 3. Face Return Hypothesis\n    # Project t onto the infinite line containing face k.\n    d_k = violations[k]\n    n_k = normals[k]\n    x_face_proj = t - d_k * n_k\n    \n    # Check if the projection lies on the face segment by testing against adjacent planes.\n    km1 = (k - 1) % 6\n    kp1 = (k + 1) % 6\n    \n    # Check if the point is feasible with respect to adjacent constraints.\n    if (normals[km1] @ x_face_proj - R <= tolerance) and \\\n       (normals[kp1] @ x_face_proj - R <= tolerance):\n        # Projection is on the face interior.\n        distance = np.linalg.norm(t - x_face_proj)\n        return [1, [k], round(distance, 6)]\n        \n    # 4. Corner Return\n    # If face return fails, the projection must be to a corner.\n    # The candidate vertices are the two vertices of face k.\n    v_k = vertices[k]       # Intersection of faces (k-1, k)\n    v_kp1 = vertices[kp1]   # Intersection of faces (k, k+1)\n    \n    dist_vk = np.linalg.norm(t - v_k)\n    dist_vkp1 = np.linalg.norm(t - v_kp1)\n    \n    if dist_vk < dist_vkp1:\n        # Projection is to vertex v_k. Active planes are (k-1) and k.\n        active_indices = sorted([km1, k])\n        distance = dist_vk\n        return [2, active_indices, round(distance, 6)]\n    else:\n        # Projection is to vertex v_{k+1}. Active planes are k and (k+1).\n        active_indices = sorted([k, kp1])\n        distance = dist_vkp1\n        return [2, active_indices, round(distance, 6)]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    R = 1.0\n    TOLERANCE = 1e-9\n    \n    test_cases = [\n        np.array([1.5, 0.0]),                            # Case A\n        np.array([1.2, 0.8]),                            # Case B\n        np.array([0.2, 0.1]),                            # Case C\n        np.array([1.0, 0.0]),                            # Case D\n        np.array([1.0, 1.0/np.sqrt(3)])                  # Case E\n    ]\n    \n    normals, vertices = setup_geometry(R)\n    \n    results = []\n    for t_point in test_cases:\n        result = project_to_hexagon(t_point, R, normals, vertices, TOLERANCE)\n        results.append(result)\n        \n    # Format the results into the exact string format specified.\n    # Using str(list).replace(\" \", \"\") achieves the required no-space format,\n    # e.g., '[1,[0],0.5]' instead of '[1, [0], 0.5]'.\n    formatted_results = [str(res).replace(\" \", \"\") for res in results]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}