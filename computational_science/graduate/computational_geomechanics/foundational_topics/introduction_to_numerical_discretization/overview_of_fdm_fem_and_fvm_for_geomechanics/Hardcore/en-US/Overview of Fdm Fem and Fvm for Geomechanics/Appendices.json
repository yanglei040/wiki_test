{
    "hands_on_practices": [
        {
            "introduction": "Geological media are inherently heterogeneous, with properties that can change abruptly across material interfaces. A robust numerical method must correctly capture the physical behavior at these discontinuities, such as the continuity of pressure and flux in subsurface flow. This practice provides a direct, head-to-head comparison of how the Finite Difference, Finite Element, and Finite Volume methods handle a sharp material interface in a simple 1D steady-state flow problem, revealing fundamental differences in their underlying philosophies and construction .",
            "id": "3547671",
            "problem": "Consider one-dimensional steady subsurface flow in a homogeneous saturated porous medium governed by conservation of mass and Darcy’s law. The fundamental base is:\n- Conservation of mass for steady state without sources: $\\dfrac{d}{dx}\\,q(x)=0$.\n- Darcy’s law: $q(x)=-k(x)\\,\\dfrac{dp}{dx}$, where $k(x)$ is the hydraulic conductivity and $p(x)$ is the hydraulic head.\n- Interface conditions at a material discontinuity with unit normal $\\mathbf{n}$ pointing in the $+x$ direction: $\\llbracket p \\rrbracket=0$ and $\\llbracket \\mathbf{q}\\cdot\\mathbf{n} \\rrbracket=0$, i.e., continuity of hydraulic head and normal flux across the interface.\n\nLet the domain be $x\\in[-L,L]$ with Dirichlet boundary conditions $p(-L)=p_L$ and $p(L)=p_R$. Impose a manufactured discontinuity in hydraulic conductivity\n$$\nk(x)=\\begin{cases}\nk_1,& x<0,\\\\\nk_2,& x>0,\n\\end{cases}\n$$\nwith a sharp interface at $x=0$. Assume $k_1>0$ and $k_2>0$. Treat $p$ as hydraulic head in $\\mathrm{m}$ and $k$ as hydraulic conductivity in $\\mathrm{m/s}$, so that $q$ has units $\\mathrm{m/s}$. Angles do not appear in this problem. No percentages should be used.\n\nYour task is to implement three spatial discretizations in one space dimension to approximate $p(x)$ and evaluate how well they preserve the interface conditions:\n- Finite Difference Method (FDM) with central differences on a uniform nodal grid.\n- Finite Element Method (FEM) with continuous, piecewise-linear (linear) shape functions on a uniform mesh (Galerkin method).\n- Finite Volume Method (FVM) with a cell-centered, two-point flux scheme on a uniform grid with harmonic-mean face transmissibilities.\n\nAll meshes must be uniform with spacing $h=\\dfrac{2L}{N}$, where $N$ is an even positive integer ensuring that the interface at $x=0$ aligns with a nodal point for nodal schemes (FDM, FEM) and with a cell face for the cell-centered scheme (FVM). Use exact Dirichlet imposition at $x=-L$ and $x=L$.\n\nDefine the following interface-jump diagnostics to quantify how each method preserves the interface conditions at $x=0$:\n- For FDM: Let $x_i=-L+i\\,h$, $i\\in\\{0,1,\\dots,N\\}$ and let $i_0=\\dfrac{N}{2}$ so that $x_{i_0}=0$. Compute the one-sided fluxes at the faces adjacent to the interface,\n$$\nq_{\\text{left}}^{\\text{FDM}}=-k\\!\\left(x_{i_0-\\tfrac{1}{2}}\\right)\\frac{p_{i_0}-p_{i_0-1}}{h},\\quad\nq_{\\text{right}}^{\\text{FDM}}=-k\\!\\left(x_{i_0+\\tfrac{1}{2}}\\right)\\frac{p_{i_0+1}-p_{i_0}}{h},\n$$\nand define the flux-jump magnitude $\\Delta q^{\\text{FDM}}=\\left|q_{\\text{right}}^{\\text{FDM}}-q_{\\text{left}}^{\\text{FDM}}\\right|$ in $\\mathrm{m/s}$. Because the nodal unknown includes the interface point, define the head-jump magnitude $\\Delta p^{\\text{FDM}}=0$ in $\\mathrm{m}$ by construction with standard central differencing.\n- For FEM: Use the same nodal grid and continuous, piecewise-linear basis functions with exact elementwise integration. With $i_0=\\dfrac{N}{2}$, compute the one-sided element fluxes\n$$\nq_{\\text{left}}^{\\text{FEM}}=-k_1\\,\\frac{p_{i_0}-p_{i_0-1}}{h},\\quad\nq_{\\text{right}}^{\\text{FEM}}=-k_2\\,\\frac{p_{i_0+1}-p_{i_0}}{h},\n$$\nand define $\\Delta q^{\\text{FEM}}=\\left|q_{\\text{right}}^{\\text{FEM}}-q_{\\text{left}}^{\\text{FEM}}\\right|$ in $\\mathrm{m/s}$ and $\\Delta p^{\\text{FEM}}=0$ in $\\mathrm{m}$.\n- For FVM: Use a cell-centered grid with $N$ cells of width $h$ and centers $x_j=-L+\\left(j+\\dfrac{1}{2}\\right)h$, $j\\in\\{0,1,\\dots,N-1\\}$, so that the interface at $x=0$ coincides with the face between cells $j=\\dfrac{N}{2}-1$ and $j=\\dfrac{N}{2}$. Let the interior-face transmissibility be $T=\\dfrac{k_{\\text{harm}}}{h}$, where $k_{\\text{harm}}=\\dfrac{2}{\\tfrac{1}{k_{\\text{L}}}+\\tfrac{1}{k_{\\text{R}}}}$ is the harmonic mean of the left and right cell conductivities at that face, and boundary-face transmissibilities be $T_{\\text{bnd}}=\\dfrac{2k_{\\text{cell}}}{h}$. Compute the unique face flux at the interface $q_{\\text{face}}^{\\text{FVM}}=-T\\left(p_{\\text{R}}-p_{\\text{L}}\\right)$, which enforces flux continuity, and define $\\Delta q^{\\text{FVM}}=0$ in $\\mathrm{m/s}$. To probe head continuity in a cell-centered scheme, reconstruct one-sided face heads using one-sided linear reconstructions from cell centers on each side:\n$$\np_{\\text{L,face}}^{\\text{FVM}} \\approx p_{j_{\\text{L}}}+\\frac{1}{2}\\left(p_{j_{\\text{L}}}-p_{j_{\\text{LL}}}\\right),\\quad\np_{\\text{R,face}}^{\\text{FVM}} \\approx p_{j_{\\text{R}}}-\\frac{1}{2}\\left(p_{j_{\\text{RR}}}-p_{j_{\\text{R}}}\\right),\n$$\nwith $j_{\\text{L}}=\\dfrac{N}{2}-1$, $j_{\\text{LL}}=j_{\\text{L}}-1$, $j_{\\text{R}}=\\dfrac{N}{2}$, $j_{\\text{RR}}=j_{\\text{R}}+1$, and define the head-jump magnitude $\\Delta p^{\\text{FVM}}=\\left|p_{\\text{R,face}}^{\\text{FVM}}-p_{\\text{L,face}}^{\\text{FVM}}\\right|$ in $\\mathrm{m}$.\n\nImplementation details to respect the fundamental base:\n- The FDM should use central differences with face conductivities evaluated at midpoints $x_{i+\\tfrac{1}{2}}$, i.e., $k\\!\\left(x_{i+\\tfrac{1}{2}}\\right)=k_1$ if $x_{i+\\tfrac{1}{2}}<0$ and $k_2$ if $x_{i+\\tfrac{1}{2}}>0$.\n- The FEM should assemble the standard symmetric stiffness matrix with element matrices $\\dfrac{k_e}{h}\\begin{bmatrix}1&-1\\\\-1&1\\end{bmatrix}$ using $k_e=k_1$ on elements with $x<0$ and $k_e=k_2$ on elements with $x>0$.\n- The FVM should assemble a conservative two-point flux system using harmonic means at interior faces and half-cell distances to impose Dirichlet boundary conditions via boundary transmissibilities.\n\nTest suite. Use the following parameter sets, each specified as a tuple $\\left(L,k_1,k_2,p_L,p_R,N\\right)$ with units $L$ in $\\mathrm{m}$, $k_1,k_2$ in $\\mathrm{m/s}$, $p_L,p_R$ in $\\mathrm{m}$, and $N$ an even integer:\n- Case $1$: $\\left(1,1,1,10,0,100\\right)$.\n- Case $2$: $\\left(1,10^{-3},1,10,0,100\\right)$.\n- Case $3$: $\\left(1,1,10^{-3},10,0,100\\right)$.\n- Case $4$: $\\left(1,10^{-4},10^{2},7,2,200\\right)$.\n- Case $5$: $\\left(1,1,100,5,5,50\\right)$.\n\nProgram requirements:\n- Implement the three methods as described and, for each case, compute the six diagnostics $\\left[\\Delta p^{\\text{FDM}},\\Delta q^{\\text{FDM}},\\Delta p^{\\text{FEM}},\\Delta q^{\\text{FEM}},\\Delta p^{\\text{FVM}},\\Delta q^{\\text{FVM}}\\right]$ in the specified units.\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list of lists enclosed in square brackets, e.g., $\\left[\\left[r_{1,1},\\dots,r_{1,6}\\right],\\left[r_{2,1},\\dots,r_{2,6}\\right],\\dots\\right]$, where each $r_{i,j}$ is a floating-point number.",
            "solution": "The posed problem requires the implementation and comparison of three numerical methods—Finite Difference (FDM), Finite Element (FEM), and Finite Volume (FVM)—for a one-dimensional steady-state flow problem in a porous medium with a discontinuous hydraulic conductivity. The core of the task is to evaluate how each method enforces the physical conditions of continuous pressure and continuous flux at the material interface.\n\n### Analytical Preliminaries\nThe governing equation is $\\dfrac{d}{dx}\\left(k(x)\\dfrac{dp}{dx}\\right)=0$. Integrating once yields $k(x)\\dfrac{dp}{dx} = -q_0$, where $q_0$ is the constant Darcy flux throughout the domain. A second integration subject to the boundary conditions $p(-L)=p_L$ and $p(L)=p_R$, and the interface conditions $\\llbracket p \\rrbracket=0, \\llbracket q \\rrbracket=0$ at $x=0$, provides the exact analytical solution. The pressure $p(x)$ is piecewise linear, and the flux $q_0$ is constant, given by $q_0 = \\dfrac{p_L-p_R}{L/k_1 + L/k_2}$. The pressure at the interface is $p(0)=\\dfrac{p_L k_1 + p_R k_2}{k_1+k_2}$.\n\n### Method 1: Finite Difference Method (FDM)\nThe domain is discretized into a nodal grid $x_i = -L+ih$ for $i=0,\\dots,N$, with $N+1$ nodes. The pressures $p_0=p_L$ and $p_N=p_R$ are known. We solve for the $N-1$ interior pressures $p_1, \\dots, p_{N-1}$.\n\nThe governing equation is discretized using a conservative central difference scheme. At an interior node $i$, the discretization is:\n$$\n\\frac{1}{h}\\left[ \\left(-k\\frac{dp}{dx}\\right)_{i+1/2} - \\left(-k\\frac{dp}{dx}\\right)_{i-1/2} \\right] = 0\n$$\nApproximating the derivatives and evaluating conductivity at face midpoints yields:\n$$\n-k(x_{i+1/2})\\frac{p_{i+1}-p_i}{h} + k(x_{i-1/2})\\frac{p_i-p_{i-1}}{h} = 0\n$$\nThis can be rearranged into a linear equation for $p_{i-1}, p_i, p_{i+1}$. Assembling these equations for $i=1,\\dots,N-1$ results in a tridiagonal linear system $A\\mathbf{p}_{\\text{int}}=\\mathbf{b}$, where $\\mathbf{p}_{\\text{int}}=[p_1, \\dots, p_{N-1}]^T$.\n\n- For nodes in the homogeneous regions (away from the interface), $k(x_{i-1/2})=k(x_{i+1/2})=k_1$ or $k_2$, the equation simplifies to the standard 3-point stencil for the Laplacian.\n- At the interface node $i_0 = N/2$, we have $x_{i_0-1/2}=-h/2$ and $x_{i_0+1/2}=h/2$. Thus $k(x_{i_0-1/2})=k_1$ and $k(x_{i_0+1/2})=k_2$. The equation is:\n$$\n-k_2\\frac{p_{i_0+1}-p_{i_0}}{h} + k_1\\frac{p_{i_0}-p_{i_0-1}}{h} = 0 \\implies k_1\\frac{p_{i_0}-p_{i_0-1}}{h} = k_2\\frac{p_{i_0+1}-p_{i_0}}{h}\n$$\nThe problem defines the one-sided fluxes as $q_{\\text{left}}^{\\text{FDM}}=-k_1\\frac{p_{i_0}-p_{i_0-1}}{h}$ and $q_{\\text{right}}^{\\text{FDM}}=-k_2\\frac{p_{i_0+1}-p_{i_0}}{h}$. The discrete equation at the interface is thus equivalent to enforcing $q_{\\text{left}}^{\\text{FDM}}=q_{\\text{right}}^{\\text{FDM}}$. Consequently, the flux jump $\\Delta q^{\\text{FDM}} = |q_{\\text{right}}^{\\text{FDM}}-q_{\\text{left}}^{\\text{FDM}}|$ is zero by construction (up to floating-point precision).\nSince FDM is a nodal scheme, pressure is uniquely defined at each node, including the interface node $i_0$. Thus, the head jump $\\Delta p^{\\text{FDM}}$ is zero by definition.\n\n### Method 2: Finite Element Method (FEM)\nUsing a standard Galerkin FEM with continuous, piecewise-linear basis functions ($\\phi_i(x)$) on the same nodal grid, the weak form of the problem leads to a linear system $K\\mathbf{p}=\\mathbf{f}$. The stiffness matrix entry is $K_{ij} = \\int_{-L}^L k(x) \\phi_j'(x) \\phi_i'(x) dx$.\n\nFor this 1D problem, assembling the element stiffness matrices $\\frac{k_e}{h}\\begin{bmatrix}1 & -1 \\\\ -1 & 1\\end{bmatrix}$ (where $k_e$ is the element conductivity) produces a global system of equations for the interior nodes that is identical to the FDM system (up to a non-consequential global sign).\n- At the interface node $i_0$, the assembly combines contributions from the element $[x_{i_0-1}, x_{i_0}]$ with conductivity $k_1$ and $[x_{i_0}, x_{i_0+1}]$ with $k_2$. This yields an equation identical to the FDM one.\n\nTherefore, the computed nodal pressures $p_i$ will be identical for both FDM and FEM.\n- **Diagnostics**: As with FDM, $\\Delta p^{\\text{FEM}} = 0$ by construction due to continuous basis functions. Since the pressure solution is identical to FDM, the computed fluxes and thus the flux jump $\\Delta q^{\\text{FEM}}$ will also be identical to FDM's, which is zero by construction.\n\n### Method 3: Finite Volume Method (FVM)\nThe FVM is implemented on a cell-centered grid of $N$ control volumes (cells). The unknowns $p_j$ represent the average pressure in cell $j$. The interface at $x=0$ lies on the face between cell $j_{\\text{L_idx}}=N/2-1$ and cell $j_{\\text{R_idx}}=N/2$.\n\nThe method is conservative by construction, meaning the numerical flux is continuous across cell faces. The equation for each cell $j$ enforces that the sum of fluxes across its faces is zero.\n$$\nq_{j+1/2} - q_{j-1/2} = 0\n$$\nwhere $q_{j+1/2} = -T_{j+1/2}(p_{j+1}-p_j)$ is the flux across the face between cells $j$ and $j+1$.\n- At the material interface, the transmissibility $T$ is computed using the harmonic mean of the adjacent cell conductivities: $T_{\\text{iface}} = \\frac{1}{h} \\frac{2k_1k_2}{k_1+k_2}$. This specific choice is known to yield the exact flux for 1D layered media.\n- At the domain boundaries, second-order accurate Dirichlet conditions are imposed via boundary transmissibilities $T_{\\text{bnd}}=2k_{\\text{cell}}/h$.\n\nThe combination of a two-point flux approximation with harmonic mean for interface transmissivity and a second-order boundary condition treatment makes the FVM scheme exact for this 1D problem. The computed cell-centered pressures $p_j$ will be equal to the analytical solution evaluated at the cell centers, $p_{\\text{exact}}(x_j)$.\n- **Diagnostics**: $\\Delta q^{\\text{FVM}}=0$ by definition for this conservative scheme. The head jump $\\Delta p^{\\text FVM}$ is computed by reconstructing the head at the interface from the left and right. The specified one-sided linear reconstructions are:\n$$\np_{\\text{L,face}}^{\\text{FVM}} = p_{j_{\\text{L}}}+\\frac{1}{2}\\left(p_{j_{\\text{L}}}-p_{j_{\\text{LL}}}\\right) \\quad \\text{and} \\quad p_{\\text{R,face}}^{\\text{FVM}} = p_{j_{\\text{R}}}-\\frac{1}{2}\\left(p_{j_{\\text{RR}}}-p_{j_{\\text{R}}}\\right)\n$$\nSince the FVM solution $p_j$ is exact at cell centers and the analytical solution is piecewise linear, this linear reconstruction will exactly recover the analytical head at the interface from both sides: $p_{\\text{L,face}}^{\\text{FVM}}=p_{\\text{exact}}(0^-)$ and $p_{\\text{R,face}}^{\\text{FVM}}=p_{\\text{exact}}(0^+)$. As the analytical head is continuous ($p_{\\text{exact}}(0^-)=p_{\\text{exact}}(0^+)$), the computed head jump $\\Delta p^{\\text{FVM}}$ will be zero, up to floating-point error.\n\n### Conclusion of Analysis\nFor the specific problem and the specific numerical schemes described, all three methods are constructed in a way that perfectly respects both pressure and flux continuity at the interface, either by construction or by yielding an exact solution for this 1D case. Therefore, all six diagnostic jump values are expected to be zero or machine-precision close to zero.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_fdm_fem(L, k1, k2, pL, pR, N):\n    \"\"\"\n    Solves the 1D flow problem using a conservative Finite Difference Method.\n    The problem specifies a piecewise-linear Finite Element Method that results\n    in an identical algebraic system.\n    \n    Args:\n        L (float): Half-length of the domain [-L, L].\n        k1 (float): Hydraulic conductivity for x < 0.\n        k2 (float): Hydraulic conductivity for x > 0.\n        pL (float): Hydraulic head at x = -L.\n        pR (float): Hydraulic head at x = L.\n        N (int): Number of grid cells (must be even).\n        \n    Returns:\n        tuple: A tuple containing the four diagnostics:\n               (delta_p_fdm, delta_q_fdm, delta_p_fem, delta_q_fem).\n    \"\"\"\n    h = 2.0 * L / N\n    i0 = N // 2  # Index of the interface node\n\n    num_unknowns = N - 1\n    A = np.zeros((num_unknowns, num_unknowns))\n    b = np.zeros(num_unknowns)\n\n    # Assemble the tridiagonal system for interior nodes p_1, ..., p_{N-1}\n    for i in range(1, N):  # Node indices from 1 to N-1\n        row_idx = i - 1\n\n        if i < i0:\n            # Region 1 (k=k1)\n            lower_diag, main_diag, upper_diag = k1, -2.0 * k1, k1\n        elif i == i0:\n            # Interface node\n            lower_diag, main_diag, upper_diag = k1, -(k1 + k2), k2\n        else:  # i > i0\n            # Region 2 (k=k2)\n            lower_diag, main_diag, upper_diag = k2, -2.0 * k2, k2\n\n        if i > 1:\n            A[row_idx, row_idx - 1] = lower_diag\n        A[row_idx, row_idx] = main_diag\n        if i < N - 1:\n            A[row_idx, row_idx + 1] = upper_diag\n\n    # Apply Dirichlet boundary conditions\n    b[0] -= k1 * pL\n    if num_unknowns > 0:\n        b[num_unknowns - 1] -= k2 * pR\n\n    # Solve for interior pressures\n    p_int = np.linalg.solve(A, b) if num_unknowns > 0 else np.array([])\n    p = np.concatenate(([pL], p_int, [pR]))\n\n    # --- Diagnostics ---\n    # The discrete equation at i0 enforces flux continuity, so delta_q will be ~0.\n    # Nodal schemes have continuous pressure by construction.\n    delta_p_fdm = 0.0\n    \n    p_i0_minus_1 = p[i0 - 1]\n    p_i0 = p[i0]\n    p_i0_plus_1 = p[i0 + 1]\n    \n    q_left = -k1 * (p_i0 - p_i0_minus_1) / h\n    q_right = -k2 * (p_i0_plus_1 - p_i0) / h\n    delta_q_fdm = abs(q_right - q_left)\n\n    # For this problem, FEM results are identical to FDM\n    delta_p_fem = 0.0\n    delta_q_fem = delta_q_fdm\n\n    return delta_p_fdm, delta_q_fdm, delta_p_fem, delta_q_fem\n\ndef solve_fvm(L, k1, k2, pL, pR, N):\n    \"\"\"\n    Solves the 1D flow problem using a cell-centered Finite Volume Method.\n    \n    Args:\n        L (float): Half-length of the domain [-L, L].\n        k1 (float): Hydraulic conductivity for x < 0.\n        k2 (float): Hydraulic conductivity for x > 0.\n        pL (float): Hydraulic head at x = -L.\n        pR (float): Hydraulic head at x = L.\n        N (int): Number of grid cells (must be even).\n        \n    Returns:\n        tuple: A tuple containing the two diagnostics: (delta_p_fvm, delta_q_fvm).\n    \"\"\"\n    h = 2.0 * L / N\n    j_iface = N // 2 # Interface is face j_iface, between cells j_iface-1 and j_iface\n\n    # Transmissibilities\n    T_k1 = k1 / h\n    T_k2 = k2 / h\n    T_iface = (2.0 * k1 * k2) / (h * (k1 + k2)) if (k1 + k2) > 0 else 0.0\n    T_bnd_L = 2.0 * k1 / h\n    T_bnd_R = 2.0 * k2 / h\n\n    A = np.zeros((N, N))\n    b = np.zeros(N)\n\n    # Assemble system for cell-centered pressures p_0, ..., p_{N-1}\n    # Equation for cell j: T_{j+1/2}(p_{j+1}-p_j) - T_{j-1/2}(p_j-p_{j-1}) = 0\n    # Rearranged: T_{j-1/2} p_{j-1} - (T_{j-1/2}+T_{j+1/2}) p_j + T_{j+1/2} p_{j+1} = 0\n    for j in range(N):\n        # Left face of cell j is face j\n        if j == 0:\n            T_left = T_bnd_L\n            b[j] += T_left * pL\n        else:\n            T_left = T_k2 if j > j_iface else (T_iface if j == j_iface else T_k1)\n            A[j, j - 1] += T_left\n        \n        # Right face of cell j is face j+1\n        if j == N - 1:\n            T_right = T_bnd_R\n            b[j] += T_right * pR\n        else:\n            T_right = T_k2 if j + 1 > j_iface else (T_iface if j + 1 == j_iface else T_k1)\n            A[j, j + 1] += T_right\n\n        A[j, j] -= (T_left + T_right)\n\n    # The system is A*p=b where A is defined above. We solve -A*p=-b.\n    p_cell = np.linalg.solve(-A, -b)\n\n    # --- Diagnostics ---\n    # Conservative FVM has continuous flux by construction.\n    delta_q_fvm = 0.0\n    \n    # Head jump from linear reconstruction\n    # For this 1D problem, FVM is exact, and linear reconstruction is exact.\n    # Thus, delta_p should be ~0.\n    j_L = j_iface - 1\n    j_LL = j_iface - 2\n    j_R = j_iface\n    j_RR = j_iface + 1\n    \n    p_L_face = p_cell[j_L] + 0.5 * (p_cell[j_L] - p_cell[j_LL])\n    p_R_face = p_cell[j_R] - 0.5 * (p_cell[j_RR] - p_cell[j_R])\n    delta_p_fvm = abs(p_R_face - p_L_face)\n\n    return delta_p_fvm, delta_q_fvm\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        (1.0, 1.0, 1.0, 10.0, 0.0, 100),\n        (1.0, 1e-3, 1.0, 10.0, 0.0, 100),\n        (1.0, 1.0, 1e-3, 10.0, 0.0, 100),\n        (1.0, 1e-4, 1e2, 7.0, 2.0, 200),\n        (1.0, 1.0, 100.0, 5.0, 5.0, 50),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, k1, k2, pL, pR, N = case\n        \n        # FDM and FEM calculations\n        dp_fdm, dq_fdm, dp_fem, dq_fem = solve_fdm_fem(L, k1, k2, pL, pR, N)\n        \n        # FVM calculation\n        dp_fvm, dq_fvm = solve_fvm(L, k1, k2, pL, pR, N)\n        \n        case_results = [dp_fdm, dq_fdm, dp_fem, dq_fem, dp_fvm, dq_fvm]\n        results.append(case_results)\n\n    # Format the final output string\n    outer_list = []\n    for res_list in results:\n        inner_list = \", \".join(f\"{x:.8e}\" for x in res_list)\n        outer_list.append(f\"[{inner_list}]\")\n    \n    print(f\"[{', '.join(outer_list)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After comparing the methods at a high level, we now take a deeper look into the mechanics of the Finite Element Method (FEM), the most versatile tool for complex geometries in geomechanics. The heart of an FEM implementation is the element stiffness matrix $\\boldsymbol{K}_{e}$, which encodes the material's constitutive response and the element's geometry into the global algebraic system. This exercise guides you through the foundational derivation of $\\boldsymbol{K}_{e}$ for a 2D isoparametric element, starting from first principles of kinematics and elasticity, providing a crucial \"under the hood\" understanding of how physical laws are discretized in FEM .",
            "id": "3547676",
            "problem": "In computational geomechanics, different spatial discretization paradigms, including the Finite Difference Method (FDM), the Finite Volume Method (FVM), and the Finite Element Method (FEM), approximate continuum balance laws using distinct representations of geometry and unknown fields. The Finite Element Method (FEM) employs an isoparametric mapping to represent both geometry and fields using the same interpolation basis, which facilitates robust treatment of complex domains commonly arising in geomechanics.\n\nStarting from the small-strain kinematics and linear elasticity under the assumption of small deformations, consider a two-dimensional quadrilateral isoparametric element with parent coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ and physical coordinates $(x,y)\\in\\Omega_{e}$. Let the four nodes be ordered counterclockwise as node 1: bottom-left, node 2: bottom-right, node 3: top-right, and node 4: top-left.\n\nTasks:\n- Define the isoparametric mapping using the same bilinear shape functions for geometry and for the displacement field. Explicitly write the bilinear shape functions $N_{i}(\\xi,\\eta)$, $i\\in\\{1,2,3,4\\}$, on the parent square.\n- Using the small-strain definition $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}\\left(\\nabla\\boldsymbol{u}+(\\nabla\\boldsymbol{u})^{T}\\right)$ and the chain rule for the isoparametric mapping, derive the strain–displacement matrix $\\boldsymbol{B}(\\xi,\\eta)$ for the plane strain case in Voigt form $\\{\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}\\}^{T}$, expressing it in terms of the derivatives of the shape functions with respect to $(x,y)$ and the Jacobian of the mapping.\n- State the element stiffness matrix in the form $\\boldsymbol{K}_{e}=\\displaystyle\\int_{\\Omega_{e}}\\boldsymbol{B}^{T}\\mathbb{C}\\boldsymbol{B}\\,t\\,d\\Omega$, where $t$ is a constant thickness and $\\mathbb{C}$ is the plane strain elasticity tensor for an isotropic material.\n\nThen, specialize to the following concrete configuration to obtain a single closed-form scalar:\n- Let the physical element be the rectangle with nodal coordinates $(x_{1},y_{1})=(0,0)$, $(x_{2},y_{2})=(a,0)$, $(x_{3},y_{3})=(a,b)$, $(x_{4},y_{4})=(0,b)$, with $a>0$, $b>0$, and constant thickness $t>0$.\n- Consider the anti-plane shear reduction relevant to out-of-plane slip in geomechanics, in which the only nonzero displacement component is $w(x,y)$ in the out-of-plane direction, with strain energy density proportional to $G|\\nabla w|^{2}$, where $G>0$ is the shear modulus. In this reduction, the element stiffness entry associated with node 1 self-coupling is\n$$\nk_{11}\\;=\\;\\int_{\\Omega_{e}}G\\,t\\,\\nabla N_{1}\\cdot\\nabla N_{1}\\,d\\Omega,\n$$\nwhere $N_{1}(x,y)$ is the isoparametric interpolation of node 1’s shape function.\nCompute $k_{11}$ exactly as a closed-form analytic expression in terms of $G$, $t$, $a$, and $b$. Do not evaluate numerically or include units in the final expression.",
            "solution": "The foundational base consists of small-strain kinematics, linear momentum balance discretized by the Finite Element Method (FEM), and linear isotropic elasticity. The isoparametric concept uses the same interpolation basis for both geometry and primary fields, which facilitates the chain rule transformation of derivatives from the parent space $(\\xi,\\eta)$ to the physical space $(x,y)$.\n\nIsoparametric mapping and bilinear shape functions. On the parent square $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, the bilinear shape functions for the four-node quadrilateral are defined as\n$$\nN_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta),\\\\\nN_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\nThe isoparametric mapping for the geometry is given by\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i},\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i},\n$$\nand the displacement field interpolation is\n$$\nu_{x}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,u_{xi},\\qquad\nu_{y}(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,u_{yi}.\n$$\n\nStrain–displacement matrix in plane strain. The small-strain tensor is $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}\\left(\\nabla\\boldsymbol{u}+(\\nabla\\boldsymbol{u})^{T}\\right)$. In Voigt notation for plane strain, the strain vector is\n$$\n\\boldsymbol{\\varepsilon}=\n\\begin{bmatrix}\n\\varepsilon_{xx} \\\\\n\\varepsilon_{yy} \\\\\n\\gamma_{xy}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial u_{x}}{\\partial x} \\\\ \\\\\n\\displaystyle \\frac{\\partial u_{y}}{\\partial y} \\\\ \\\\\n\\displaystyle \\frac{\\partial u_{x}}{\\partial y}+\\frac{\\partial u_{y}}{\\partial x}\n\\end{bmatrix}.\n$$\nWith isoparametric interpolation, $u_{x}=\\sum_{i}N_{i}u_{xi}$ and $u_{y}=\\sum_{i}N_{i}u_{yi}$. Using the chain rule,\n$$\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial}{\\partial x} \\\\ \\\\\n\\displaystyle \\frac{\\partial}{\\partial y}\n\\end{bmatrix}\n=\n\\boldsymbol{J}^{-T}\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial}{\\partial \\xi} \\\\ \\\\\n\\displaystyle \\frac{\\partial}{\\partial \\eta}\n\\end{bmatrix},\\qquad\n\\boldsymbol{J}=\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial x}{\\partial \\xi} & \\displaystyle \\frac{\\partial x}{\\partial \\eta} \\\\ \\\\\n\\displaystyle \\frac{\\partial y}{\\partial \\xi} & \\displaystyle \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix}.\n$$\nHence,\n$$\n\\frac{\\partial N_{i}}{\\partial x}=\\left[\\boldsymbol{J}^{-T}\\right]_{11}\\frac{\\partial N_{i}}{\\partial \\xi}+\\left[\\boldsymbol{J}^{-T}\\right]_{12}\\frac{\\partial N_{i}}{\\partial \\eta},\\qquad\n\\frac{\\partial N_{i}}{\\partial y}=\\left[\\boldsymbol{J}^{-T}\\right]_{21}\\frac{\\partial N_{i}}{\\partial \\xi}+\\left[\\boldsymbol{J}^{-T}\\right]_{22}\\frac{\\partial N_{i}}{\\partial \\eta}.\n$$\nCollecting terms in Voigt form, the strain–displacement matrix $\\boldsymbol{B}(\\xi,\\eta)$ for the four-node quadrilateral under plane strain is\n$$\n\\boldsymbol{B}=\n\\begin{bmatrix}\n\\displaystyle \\frac{\\partial N_{1}}{\\partial x} & 0 & \\frac{\\partial N_{2}}{\\partial x} & 0 & \\frac{\\partial N_{3}}{\\partial x} & 0 & \\frac{\\partial N_{4}}{\\partial x} & 0 \\\\ \\\\\n0 & \\displaystyle \\frac{\\partial N_{1}}{\\partial y} & 0 & \\frac{\\partial N_{2}}{\\partial y} & 0 & \\frac{\\partial N_{3}}{\\partial y} & 0 & \\frac{\\partial N_{4}}{\\partial y} \\\\ \\\\\n\\displaystyle \\frac{\\partial N_{1}}{\\partial y} & \\displaystyle \\frac{\\partial N_{1}}{\\partial x} &\n\\frac{\\partial N_{2}}{\\partial y} & \\frac{\\partial N_{2}}{\\partial x} &\n\\frac{\\partial N_{3}}{\\partial y} & \\frac{\\partial N_{3}}{\\partial x} &\n\\frac{\\partial N_{4}}{\\partial y} & \\frac{\\partial N_{4}}{\\partial x}\n\\end{bmatrix}.\n$$\n\nElement stiffness in plane strain. For an isotropic material, the plane strain elasticity matrix is\n$$\n\\mathbb{C}=\n\\begin{bmatrix}\n\\lambda+2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda+2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix},\\qquad\n\\lambda=\\frac{E\\nu}{(1+\\nu)(1-2\\nu)},\\quad \\mu=\\frac{E}{2(1+\\nu)},\n$$\nwhere $E$ is Young’s modulus and $\\nu$ is Poisson’s ratio. The element stiffness matrix is\n$$\n\\boldsymbol{K}_{e}=\\int_{\\Omega_{e}}\\boldsymbol{B}^{T}\\mathbb{C}\\boldsymbol{B}\\,t\\,d\\Omega\n=\\int_{-1}^{1}\\int_{-1}^{1}\\boldsymbol{B}(\\xi,\\eta)^{T}\\mathbb{C}\\,\\boldsymbol{B}(\\xi,\\eta)\\,t\\,\\det\\boldsymbol{J}(\\xi,\\eta)\\,d\\xi\\,d\\eta.\n$$\n\nSpecialization to anti-plane shear for a rectangular element. Consider the rectangle with nodes $(0,0)$, $(a,0)$, $(a,b)$, $(0,b)$. The isoparametric geometry becomes an affine map:\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}x_{i}=\\frac{a}{2}(1+\\xi),\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}y_{i}=\\frac{b}{2}(1+\\eta),\n$$\nso the Jacobian is constant,\n$$\n\\boldsymbol{J}=\\begin{bmatrix}\n\\displaystyle \\frac{a}{2} & 0 \\\\ \\\\\n0 & \\displaystyle \\frac{b}{2}\n\\end{bmatrix},\\qquad\n\\det\\boldsymbol{J}=\\frac{ab}{4},\\qquad\n\\boldsymbol{J}^{-T}=\\begin{bmatrix}\n\\displaystyle \\frac{2}{a} & 0 \\\\ \\\\\n0 & \\displaystyle \\frac{2}{b}\n\\end{bmatrix}.\n$$\nFor anti-plane shear, the only displacement component is $w(x,y)$, interpolated as $w(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,w_{i}$, with strain energy density $G|\\nabla w|^{2}$. The scalar element stiffness entry associated with node 1 self-coupling is\n$$\nk_{11}=\\int_{\\Omega_{e}}G\\,t\\,\\nabla N_{1}\\cdot\\nabla N_{1}\\,d\\Omega\n=\\int_{-1}^{1}\\int_{-1}^{1}G\\,t\\,\\left[\\left(\\frac{\\partial N_{1}}{\\partial x}\\right)^{2}+\\left(\\frac{\\partial N_{1}}{\\partial y}\\right)^{2}\\right]\\det\\boldsymbol{J}\\,d\\xi\\,d\\eta.\n$$\nUsing the chain rule with the constant $\\boldsymbol{J}^{-T}$,\n$$\n\\frac{\\partial N_{1}}{\\partial x}=\\frac{2}{a}\\frac{\\partial N_{1}}{\\partial \\xi},\\qquad\n\\frac{\\partial N_{1}}{\\partial y}=\\frac{2}{b}\\frac{\\partial N_{1}}{\\partial \\eta}.\n$$\nThe parent-space derivatives of $N_{1}(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)$ are\n$$\n\\frac{\\partial N_{1}}{\\partial \\xi}=-\\frac{1}{4}(1-\\eta),\\qquad\n\\frac{\\partial N_{1}}{\\partial \\eta}=-\\frac{1}{4}(1-\\xi).\n$$\nTherefore,\n$$\n\\left(\\frac{\\partial N_{1}}{\\partial x}\\right)^{2}=\\frac{1}{4a^{2}}(1-\\eta)^{2},\\qquad\n\\left(\\frac{\\partial N_{1}}{\\partial y}\\right)^{2}=\\frac{1}{4b^{2}}(1-\\xi)^{2}.\n$$\nSubstituting and factoring constants,\n$$\nk_{11}=G\\,t\\,\\frac{ab}{4}\\int_{-1}^{1}\\int_{-1}^{1}\\left[\\frac{1}{4a^{2}}(1-\\eta)^{2}+\\frac{1}{4b^{2}}(1-\\xi)^{2}\\right]\\,d\\xi\\,d\\eta\n=G\\,t\\,\\frac{ab}{16}\\left[\\frac{1}{a^{2}}\\int_{-1}^{1}\\int_{-1}^{1}(1-\\eta)^{2}\\,d\\xi\\,d\\eta+\\frac{1}{b^{2}}\\int_{-1}^{1}\\int_{-1}^{1}(1-\\xi)^{2}\\,d\\xi\\,d\\eta\\right].\n$$\nThe inner integrals separate:\n$$\n\\int_{-1}^{1}\\int_{-1}^{1}(1-\\eta)^{2}\\,d\\xi\\,d\\eta=\\left(\\int_{-1}^{1}d\\xi\\right)\\left(\\int_{-1}^{1}(1-\\eta)^{2}\\,d\\eta\\right)=2\\cdot\\int_{-1}^{1}(1-2\\eta+\\eta^{2})\\,d\\eta.\n$$\nCompute\n$$\n\\int_{-1}^{1}(1-2\\eta+\\eta^{2})\\,d\\eta=\\left[\\eta-\\eta^{2}+\\frac{\\eta^{3}}{3}\\right]_{-1}^{1}=\\left(1-1+\\frac{1}{3}\\right)-\\left(-1-1-\\frac{1}{3}\\right)=\\frac{1}{3}+\\frac{7}{3}=\\frac{8}{3}.\n$$\nThus $\\displaystyle \\int_{-1}^{1}\\int_{-1}^{1}(1-\\eta)^{2}\\,d\\xi\\,d\\eta=\\frac{16}{3}$, and by symmetry $\\displaystyle \\int_{-1}^{1}\\int_{-1}^{1}(1-\\xi)^{2}\\,d\\xi\\,d\\eta=\\frac{16}{3}$. Therefore,\n$$\nk_{11}=G\\,t\\,\\frac{ab}{16}\\left[\\frac{1}{a^{2}}\\cdot\\frac{16}{3}+\\frac{1}{b^{2}}\\cdot\\frac{16}{3}\\right]\n=G\\,t\\,\\frac{ab}{16}\\cdot\\frac{16}{3}\\left(\\frac{1}{a^{2}}+\\frac{1}{b^{2}}\\right)\n=G\\,t\\,\\frac{ab}{3}\\left(\\frac{1}{a^{2}}+\\frac{1}{b^{2}}\\right).\n$$\nA compact equivalent form is\n$$\nk_{11}=G\\,t\\left(\\frac{b}{3a}+\\frac{a}{3b}\\right).\n$$\nThis closed-form expression completes the requested calculation.",
            "answer": "$$\\boxed{G\\,t\\left(\\frac{b}{3a}+\\frac{a}{3b}\\right)}$$"
        },
        {
            "introduction": "As our models grow to encompass coupled multi-physics phenomena like poroelasticity, analytical solutions for testing our code become exceedingly rare. How can we be certain that our complex implementation correctly solves the governing partial differential equations? This practice introduces a powerful and essential technique in modern computational science: the Method of Manufactured Solutions (MMS). By postulating an analytical solution and deriving the necessary source terms, you will construct a verification test that allows for a rigorous, quantitative assessment of your code's accuracy and convergence rate for a coupled problem .",
            "id": "3547686",
            "problem": "Consider the quasi-static, small-strain, linear poroelastic model of a saturated elastic porous solid (Biot poroelasticity). Let the spatial domain be the unit square $\\Omega = (0,1) \\times (0,1)$ and time $t \\ge 0$. The unknowns are the displacement vector field $\\boldsymbol{u}(\\boldsymbol{x},t)$ and the pore pressure $p(\\boldsymbol{x},t)$. The model is defined by the balance of linear momentum and mass conservation, with the Cauchy stress obeying linear elasticity and the Darcy law for fluid flow. The fundamental statements are:\n- Balance of linear momentum: $- \\nabla \\cdot \\boldsymbol{\\sigma} + \\alpha \\nabla p = \\boldsymbol{f}$, where $\\boldsymbol{\\sigma}$ is the stress tensor, $\\alpha$ is the Biot coefficient, and $\\boldsymbol{f}$ is a body force to be determined.\n- Linear elastic constitutive law: $\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u})) \\boldsymbol{I}$, with Lamé parameters $\\lambda$ and $\\mu$, strain tensor $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2} \\left( \\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top} \\right)$, and identity tensor $\\boldsymbol{I}$.\n- Mass conservation: $\\frac{\\partial}{\\partial t} \\left( \\alpha \\nabla \\cdot \\boldsymbol{u} + c\\, p \\right) - \\nabla \\cdot \\left( K \\nabla p \\right) = s$, where $c$ is the specific storage coefficient, $K$ is the constant hydraulic conductivity (assumed isotropic), and $s$ is a source term to be determined.\n\nYou are tasked with using the Method of Manufactured Solutions (MMS) to construct a verification problem for three discretization families commonly used in computational geomechanics: the Finite Difference Method (FDM), the Finite Element Method (FEM), and the Finite Volume Method (FVM). Specifically:\n\n- Outline a verification plan that: \n  (i) prescribes how $\\boldsymbol{u}$ and $p$ are enforced on $\\partial \\Omega$ to match the manufactured solution; \n  (ii) specifies norms for error measurement for both fields and source-driven residuals in space-time; \n  (iii) states the expected grid/time-step convergence orders for representative second-order centered FDM, conforming Galerkin FEM with linear elements and consistent stabilization for the pressure, and second-order FVM with linear reconstruction.\n- Starting only from the fundamental laws stated above, and taking the following analytic manufactured solution pair with constants $U>0$, $P>0$, $\\beta>0$:\n$$\n\\boldsymbol{u}(x,y,t) = \\begin{pmatrix}\nU \\sin(\\pi x)\\, \\sin(\\pi y)\\, \\exp(\\beta t) \\\\\nU \\cos(\\pi x)\\, \\sin(\\pi y)\\, \\exp(\\beta t)\n\\end{pmatrix}, \n\\qquad\np(x,y,t) = P \\sin(\\pi x)\\, \\cos(\\pi y)\\, \\exp(\\beta t),\n$$\nderive, in closed form, the body force $\\boldsymbol{f}(x,y,t)$ and the mass source $s(x,y,t)$ such that the pair $\\left( \\boldsymbol{u}, p \\right)$ satisfies the governing equations exactly in $\\Omega \\times (0,\\infty)$ when the boundary data are taken to be the traces of the manufactured fields.\n\nExpress the final answer as a single row matrix in terms of $\\lambda$, $\\mu$, $\\alpha$, $c$, $K$, $U$, $P$, $\\beta$, $x$, $y$, and $t$, with entries corresponding to the first component of $\\boldsymbol{f}$, the second component of $\\boldsymbol{f}$, and $s$. No numerical evaluation is required. If you choose to simplify trigonometric products, do so algebraically. Do not include physical units in your final boxed expression. Round nothing and provide an exact symbolic expression.",
            "solution": "The problem is valid. It is a well-posed, scientifically grounded exercise in the Method of Manufactured Solutions applied to the established equations of linear poroelasticity, a standard topic in computational geomechanics. The task requires direct application of vector and tensor calculus to derive source terms, which is a mathematically rigorous and verifiable procedure.\n\nThe solution consists of two parts. First, a verification plan is outlined. Second, the explicit symbolic forms for the body force $\\boldsymbol{f}(x,y,t)$ and the mass source term $s(x,y,t)$ are derived.\n\n### Verification Plan\n\nA verification plan using the Method of Manufactured Solutions (MMS) for the given Biot poroelasticity problem involves the following steps:\n\n(i) **Boundary and Initial Conditions**: The manufactured solutions for displacement $\\boldsymbol{u}(x,y,t)$ and pressure $p(x,y,t)$ are imposed as Dirichlet boundary conditions on the entire boundary $\\partial\\Omega$ of the domain $\\Omega = (0,1) \\times (0,1)$ for all times $t \\ge 0$.\n-   Displacement boundary condition: $\\boldsymbol{u}(\\boldsymbol{x},t) = \\boldsymbol{u}_{\\text{manufactured}}(\\boldsymbol{x},t)$ for all $\\boldsymbol{x} \\in \\partial\\Omega$, $t \\ge 0$.\n-   Pressure boundary condition: $p(\\boldsymbol{x},t) = p_{\\text{manufactured}}(\\boldsymbol{x},t)$ for all $\\boldsymbol{x} \\in \\partial\\Omega$, $t \\ge 0$.\nThe initial conditions at $t=0$ are also prescribed directly from the manufactured solution:\n-   Initial displacement: $\\boldsymbol{u}(\\boldsymbol{x},0) = \\boldsymbol{u}_{\\text{manufactured}}(\\boldsymbol{x},0)$.\n-   Initial pressure: $p(\\boldsymbol{x},0) = p_{\\text{manufactured}}(\\boldsymbol{x},0)$.\n\n(ii) **Error Measurement**: A numerical code solving the problem with the derived source terms $\\boldsymbol{f}$ and $s$ should produce numerical solutions $\\boldsymbol{u}_h(\\boldsymbol{x},t)$ and $p_h(\\boldsymbol{x},t)$, where $h$ is the characteristic mesh size. The error is the difference between the numerical solution and the exact manufactured solution. The error is measured using appropriate norms, typically evaluated at a fixed time $t_{final}$.\n-   Displacement error:\n    -   $L^2$-norm: $\\| \\boldsymbol{u} - \\boldsymbol{u}_h \\|_{L^2(\\Omega)} = \\left(\\int_\\Omega (\\boldsymbol{u} - \\boldsymbol{u}_h) \\cdot (\\boldsymbol{u} - \\boldsymbol{u}_h) \\, d\\Omega\\right)^{1/2}$.\n    -   $H^1$-seminorm: $| \\boldsymbol{u} - \\boldsymbol{u}_h |_{H^1(\\Omega)} = \\left(\\int_\\Omega \\| \\nabla\\boldsymbol{u} - \\nabla\\boldsymbol{u}_h \\|_F^2 \\, d\\Omega\\right)^{1/2}$, where $\\|\\cdot\\|_F$ is the Frobenius norm.\n-   Pressure error:\n    -   $L^2$-norm: $\\| p - p_h \\|_{L^2(\\Omega)} = \\left(\\int_\\Omega (p - p_h)^2 \\, d\\Omega\\right)^{1/2}$.\n    -   $H^1$-seminorm: $| p - p_h |_{H^1(\\Omega)} = \\left(\\int_\\Omega \\| \\nabla p - \\nabla p_h \\|^2 \\, d\\Omega\\right)^{1/2}$.\nBy refining the mesh size $h$ and the time step $\\Delta t$, the convergence of these error norms to zero is observed, and the rate of convergence is calculated.\n\n(iii) **Expected Convergence Orders**: For the specified numerical methods, assuming a second-order accurate time-stepping scheme (e.g., Crank-Nicolson) is used, the expected orders of convergence are as follows:\n-   **Second-order centered FDM**: The method is expected to show second-order convergence for both displacement and pressure in the discrete $L^2$-norm, i.e., the error is $O(h^2 + \\Delta t^2)$.\n-   **Conforming Galerkin FEM with linear elements**: For P1/P1 (linear) elements for both displacement and pressure, standard theory predicts error estimates of $O(h^2)$ in the $L^2$-norm and $O(h)$ in the $H^1$-norm for both fields. The use of a \"consistent stabilization\" is crucial to prevent pressure oscillations and achieve these optimal rates, which might not be guaranteed otherwise due to the LBB (Ladyzhenskaya-Babuška-Brezzi) condition. The temporal error is dependent on the time-stepping scheme, e.g., $O(\\Delta t^2)$ for a second-order scheme.\n-   **Second-order FVM with linear reconstruction**: This method is designed to be second-order accurate in space. Coupled with a second-order time integration scheme, it is expected to show an overall convergence order of $O(h^2 + \\Delta t^2)$ in a discrete $L^2$-norm for cell-averaged or reconstructed point-wise values.\n\n### Derivation of Source Terms\n\nThe source terms $\\boldsymbol{f}$ and $s$ are derived by substituting the manufactured solutions into the governing equations.\n\nThe manufactured solutions are:\n$$\n\\boldsymbol{u}(x,y,t) = \\begin{pmatrix} u_x \\\\ u_y \\end{pmatrix} = \\begin{pmatrix}\nU \\sin(\\pi x)\\, \\sin(\\pi y)\\, \\exp(\\beta t) \\\\\nU \\cos(\\pi x)\\, \\sin(\\pi y)\\, \\exp(\\beta t)\n\\end{pmatrix}\n$$\n$$\np(x,y,t) = P \\sin(\\pi x)\\, \\cos(\\pi y)\\, \\exp(\\beta t)\n$$\n\n**1. Derivation of the body force $\\boldsymbol{f}$**\n\nThe body force $\\boldsymbol{f}$ is given by $\\boldsymbol{f} = -\\nabla \\cdot \\boldsymbol{\\sigma} + \\alpha \\nabla p$. A convenient identity for the divergence of the linear elastic stress tensor is $\\nabla \\cdot \\boldsymbol{\\sigma} = (\\lambda+\\mu)\\nabla(\\nabla \\cdot \\boldsymbol{u}) + \\mu \\nabla^2 \\boldsymbol{u}$.\n\nFirst, we compute the necessary derivatives of $\\boldsymbol{u}$:\n-   Divergence of $\\boldsymbol{u}$:\n    $\\nabla \\cdot \\boldsymbol{u} = \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} = \\pi U \\cos(\\pi x) \\sin(\\pi y) \\exp(\\beta t) + \\pi U \\cos(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$\n    $\\nabla \\cdot \\boldsymbol{u} = \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) \\exp(\\beta t)$\n-   Gradient of the divergence:\n    $\\frac{\\partial}{\\partial x}(\\nabla \\cdot \\boldsymbol{u}) = -\\pi^2 U \\sin(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) \\exp(\\beta t)$\n    $\\frac{\\partial}{\\partial y}(\\nabla \\cdot \\boldsymbol{u}) = \\pi^2 U \\cos(\\pi x) (\\cos(\\pi y) - \\sin(\\pi y)) \\exp(\\beta t)$\n    So, $\\nabla(\\nabla \\cdot \\boldsymbol{u}) = \\pi^2 U \\exp(\\beta t) \\begin{pmatrix} -\\sin(\\pi x)(\\sin(\\pi y) + \\cos(\\pi y)) \\\\ \\cos(\\pi x)(\\cos(\\pi y) - \\sin(\\pi y)) \\end{pmatrix}$.\n-   Laplacian of $\\boldsymbol{u}$:\n    $\\nabla^2 u_x = \\frac{\\partial^2 u_x}{\\partial x^2} + \\frac{\\partial^2 u_x}{\\partial y^2} = -\\pi^2 u_x - \\pi^2 u_x = -2\\pi^2 U \\sin(\\pi x) \\sin(\\pi y) \\exp(\\beta t)$\n    $\\nabla^2 u_y = \\frac{\\partial^2 u_y}{\\partial x^2} + \\frac{\\partial^2 u_y}{\\partial y^2} = -\\pi^2 u_y - \\pi^2 u_y = -2\\pi^2 U \\cos(\\pi x) \\sin(\\pi y) \\exp(\\beta t)$\n    So, $\\nabla^2 \\boldsymbol{u} = -2\\pi^2 \\exp(\\beta t) \\begin{pmatrix} U \\sin(\\pi x)\\sin(\\pi y) \\\\ U \\cos(\\pi x)\\sin(\\pi y) \\end{pmatrix}$.\n\nNow, we compute $\\nabla \\cdot \\boldsymbol{\\sigma}$:\n-   x-component: $(\\nabla \\cdot \\boldsymbol{\\sigma})_x = (\\lambda+\\mu)\\frac{\\partial(\\nabla \\cdot \\boldsymbol{u})}{\\partial x} + \\mu \\nabla^2 u_x$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_x = (\\lambda+\\mu) \\left[-\\pi^2 U \\sin(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y))\\right] \\exp(\\beta t) + \\mu \\left[-2\\pi^2 U \\sin(\\pi x) \\sin(\\pi y)\\right] \\exp(\\beta t)$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_x = -\\pi^2 U \\sin(\\pi x) \\left[ (\\lambda+\\mu)(\\sin(\\pi y) + \\cos(\\pi y)) + 2\\mu \\sin(\\pi y) \\right] \\exp(\\beta t)$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_x = -\\pi^2 U \\sin(\\pi x) \\left[ (\\lambda+3\\mu)\\sin(\\pi y) + (\\lambda+\\mu)\\cos(\\pi y) \\right] \\exp(\\beta t)$\n-   y-component: $(\\nabla \\cdot \\boldsymbol{\\sigma})_y = (\\lambda+\\mu)\\frac{\\partial(\\nabla \\cdot \\boldsymbol{u})}{\\partial y} + \\mu \\nabla^2 u_y$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_y = (\\lambda+\\mu) \\left[\\pi^2 U \\cos(\\pi x) (\\cos(\\pi y) - \\sin(\\pi y))\\right] \\exp(\\beta t) + \\mu \\left[-2\\pi^2 U \\cos(\\pi x) \\sin(\\pi y)\\right] \\exp(\\beta t)$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_y = \\pi^2 U \\cos(\\pi x) \\left[ (\\lambda+\\mu)(\\cos(\\pi y) - \\sin(\\pi y)) - 2\\mu \\sin(\\pi y) \\right] \\exp(\\beta t)$\n    $(\\nabla \\cdot \\boldsymbol{\\sigma})_y = \\pi^2 U \\cos(\\pi x) \\left[ (\\lambda+\\mu)\\cos(\\pi y) - (\\lambda+3\\mu)\\sin(\\pi y) \\right] \\exp(\\beta t)$\n\nNext, we compute the gradient of the pressure $p$:\n$\\nabla p = P \\exp(\\beta t) \\begin{pmatrix} \\pi \\cos(\\pi x) \\cos(\\pi y) \\\\ -\\pi \\sin(\\pi x) \\sin(\\pi y) \\end{pmatrix}$\n\nFinally, we assemble $\\boldsymbol{f} = (f_x, f_y)^T$:\n$f_x = -(\\nabla \\cdot \\boldsymbol{\\sigma})_x + \\alpha \\frac{\\partial p}{\\partial x}$\n$f_x = \\pi^2 U \\sin(\\pi x) \\left[ (\\lambda+3\\mu)\\sin(\\pi y) + (\\lambda+\\mu)\\cos(\\pi y) \\right] \\exp(\\beta t) + \\alpha \\pi P \\cos(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$\n$f_x = \\left( \\pi^2 U \\sin(\\pi x) \\left[ (\\lambda+3\\mu)\\sin(\\pi y) + (\\lambda+\\mu)\\cos(\\pi y) \\right] + \\pi \\alpha P \\cos(\\pi x) \\cos(\\pi y) \\right) \\exp(\\beta t)$\n\n$f_y = -(\\nabla \\cdot \\boldsymbol{\\sigma})_y + \\alpha \\frac{\\partial p}{\\partial y}$\n$f_y = -\\pi^2 U \\cos(\\pi x) \\left[ (\\lambda+\\mu)\\cos(\\pi y) - (\\lambda+3\\mu)\\sin(\\pi y) \\right] \\exp(\\beta t) - \\alpha \\pi P \\sin(\\pi x) \\sin(\\pi y) \\exp(\\beta t)$\n$f_y = \\left( \\pi^2 U \\cos(\\pi x) \\left[ (\\lambda+3\\mu)\\sin(\\pi y) - (\\lambda+\\mu)\\cos(\\pi y) \\right] - \\pi \\alpha P \\sin(\\pi x) \\sin(\\pi y) \\right) \\exp(\\beta t)$\n\n**2. Derivation of the mass source $s$**\n\nThe mass source $s$ is given by $s = \\frac{\\partial}{\\partial t} \\left( \\alpha \\nabla \\cdot \\boldsymbol{u} + c\\, p \\right) - \\nabla \\cdot \\left( K \\nabla p \\right)$.\n\nFirst, we compute the term inside the time derivative:\n$\\alpha \\nabla \\cdot \\boldsymbol{u} + c p = \\left[ \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + c P \\sin(\\pi x) \\cos(\\pi y) \\right] \\exp(\\beta t)$\nIts time derivative is:\n$\\frac{\\partial}{\\partial t}(\\dots) = \\beta \\left[ \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + c P \\sin(\\pi x) \\cos(\\pi y) \\right] \\exp(\\beta t)$\n\nNext, we compute the fluid flux divergence term, $- \\nabla \\cdot (K \\nabla p)$. Since $K$ is constant, this is $-K \\nabla^2 p$.\n$\\nabla^2 p = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} = -\\pi^2 p - \\pi^2 p = -2 \\pi^2 p$\n$\\nabla^2 p = -2\\pi^2 P \\sin(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$\nSo, $-K \\nabla^2 p = 2\\pi^2 K P \\sin(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$.\n\nFinally, we assemble $s$:\n$s = \\beta \\left[ \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + c P \\sin(\\pi x) \\cos(\\pi y) \\right] \\exp(\\beta t) + 2\\pi^2 K P \\sin(\\pi x) \\cos(\\pi y) \\exp(\\beta t)$\nCombining terms proportional to $P$:\n$s = \\left( \\beta \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + (\\beta c + 2\\pi^2 K) P \\sin(\\pi x) \\cos(\\pi y) \\right) \\exp(\\beta t)$\n\nThe derived expressions for $f_x$, $f_y$, and $s$ are the source terms required to make the given $\\boldsymbol{u}$ and $p$ an exact solution to the poroelasticity equations.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\left( \\pi^{2} U \\sin(\\pi x) ((\\lambda+3\\mu)\\sin(\\pi y) + (\\lambda+\\mu)\\cos(\\pi y)) + \\pi \\alpha P \\cos(\\pi x) \\cos(\\pi y) \\right) \\exp(\\beta t) & \\left( \\pi^{2} U \\cos(\\pi x) ((\\lambda+3\\mu)\\sin(\\pi y) - (\\lambda+\\mu)\\cos(\\pi y)) - \\pi \\alpha P \\sin(\\pi x) \\sin(\\pi y) \\right) \\exp(\\beta t) & \\left( \\beta \\alpha \\pi U \\cos(\\pi x) (\\sin(\\pi y) + \\cos(\\pi y)) + (\\beta c + 2\\pi^{2} K) P \\sin(\\pi x) \\cos(\\pi y) \\right) \\exp(\\beta t) \\end{pmatrix}}\n$$"
        }
    ]
}