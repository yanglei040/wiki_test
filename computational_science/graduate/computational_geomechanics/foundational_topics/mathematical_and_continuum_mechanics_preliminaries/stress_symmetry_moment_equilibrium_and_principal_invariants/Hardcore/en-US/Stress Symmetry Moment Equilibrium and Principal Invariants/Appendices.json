{
    "hands_on_practices": [
        {
            "introduction": "The principal invariants of the Cauchy stress tensor, $I_1$, $I_2$, and $I_3$, form the foundation for many theories in geomechanics because they uniquely define the stress state, independent of the coordinate system. This exercise challenges you to work backward from a given set of invariants to reconstruct the principal stresses by solving the characteristic polynomial . This practice reinforces the fundamental algebraic relationship between invariants and principal stresses, which is a direct consequence of the symmetry of the stress tensor derived from moment equilibrium.",
            "id": "3565204",
            "problem": "A homogeneous point in a geomaterial is modeled as a Cauchy continuum under quasi-static loading with no body couples. By equilibrium of moments, the Cauchy stress tensor is symmetric at that point. Let the principal invariants of the Cauchy stress tensor be defined by $I_1 = \\operatorname{tr}(\\boldsymbol{\\sigma})$, $I_2 = \\tfrac{1}{2}\\!\\left[(\\operatorname{tr}\\boldsymbol{\\sigma})^2 - \\operatorname{tr}(\\boldsymbol{\\sigma}^2)\\right]$, and $I_3 = \\det(\\boldsymbol{\\sigma})$. At a particular material point, measurements and model reduction yield the invariant values $I_1 = 12$ (megapascal (MPa)), $I_2 = 5$ (MPa)$^2$, and $I_3 = -150$ (MPa)$^3$.\n\nStarting only from (i) the equilibrium of moments that implies symmetry of the Cauchy stress tensor and (ii) the above definitions of the principal invariants, reconstruct the three principal stresses $\\{\\sigma_i\\}$ by solving the appropriate algebraic relations. Then, using only well-tested relationships between polynomial coefficients and roots, determine the algebraic condition on $I_1$, $I_2$, and $I_3$ that characterizes the presence of a multiple principal stress value (i.e., repeated eigenvalue), and assess whether the given invariant set satisfies that condition.\n\nExpress your final principal stresses as a single row matrix in ascending order, and express each entry in megapascals (MPa). No rounding is necessary; give exact values.",
            "solution": "The problem requires the reconstruction of principal stresses from the given principal invariants of the Cauchy stress tensor and an assessment of whether any principal stresses are repeated. The Cauchy stress tensor, $\\boldsymbol{\\sigma}$, is symmetric due to the equilibrium of moments under the assumption of no body couples. The principal stresses, denoted here by $\\sigma$, are the eigenvalues of $\\boldsymbol{\\sigma}$. As eigenvalues, they are the roots of the characteristic equation of the tensor:\n$$ \\det(\\boldsymbol{\\sigma} - \\sigma \\mathbf{I}) = 0 $$\nwhere $\\mathbf{I}$ is the identity tensor. This equation can be expanded into a cubic polynomial in terms of the principal invariants of the stress tensor:\n$$ \\sigma^3 - I_1 \\sigma^2 + I_2 \\sigma - I_3 = 0 $$\nThe problem provides the values of the invariants:\n$I_1 = 12$ MPa\n$I_2 = 5$ (MPa)$^2$\n$I_3 = -150$ (MPa)$^3$\n\nFirst, we reconstruct the principal stresses by solving the characteristic equation. Substituting the given values (omitting units for calculation clarity, but understanding that the resulting stresses will be in MPa):\n$$ \\sigma^3 - (12)\\sigma^2 + (5)\\sigma - (-150) = 0 $$\n$$ \\sigma^3 - 12\\sigma^2 + 5\\sigma + 150 = 0 $$\nTo solve this cubic equation, we can use the rational root theorem to test for integer roots. Potential rational roots are the integer divisors of the constant term, $150$. Let's test a few values for the polynomial $P(\\sigma) = \\sigma^3 - 12\\sigma^2 + 5\\sigma + 150$:\nTesting $\\sigma = -3$:\n$$ P(-3) = (-3)^3 - 12(-3)^2 + 5(-3) + 150 $$\n$$ P(-3) = -27 - 12(9) - 15 + 150 $$\n$$ P(-3) = -27 - 108 - 15 + 150 $$\n$$ P(-3) = -150 + 150 = 0 $$\nSince $P(-3) = 0$, $\\sigma_1 = -3$ is a root of the equation, and thus one of the principal stresses. This means $(\\sigma+3)$ is a factor of the polynomial. We can perform polynomial division to find the remaining quadratic factor.\n$$ \\frac{\\sigma^3 - 12\\sigma^2 + 5\\sigma + 150}{\\sigma + 3} = \\sigma^2 - 15\\sigma + 50 $$\nSo, the characteristic equation can be factored as:\n$$ (\\sigma + 3)(\\sigma^2 - 15\\sigma + 50) = 0 $$\nWe now solve the quadratic equation $\\sigma^2 - 15\\sigma + 50 = 0$ to find the other two principal stresses. This quadratic can be factored by inspection:\n$$ (\\sigma - 5)(\\sigma - 10) = 0 $$\nThe roots are $\\sigma = 5$ and $\\sigma = 10$.\nThus, the three principal stresses are $\\sigma_1 = -3$ MPa, $\\sigma_2 = 5$ MPa, and $\\sigma_3 = 10$ MPa. The problem requires a row matrix of these values in ascending order: $\\{-3, 5, 10\\}$.\n\nNext, we must determine the algebraic condition for the presence of a multiple principal stress value. This corresponds to the characteristic polynomial having repeated roots. A polynomial has repeated roots if and only if its discriminant, $\\Delta$, is equal to zero. For the cubic equation $\\sigma^3 - I_1\\sigma^2 + I_2\\sigma - I_3 = 0$, the discriminant is given by the standard formula derived from the coefficients:\n$$ \\Delta = I_1^2 I_2^2 - 4I_1^3 I_3 - 4I_2^3 - 27I_3^2 + 18I_1 I_2 I_3 $$\nThe algebraic condition for a multiple principal stress value is therefore:\n$$ I_1^2 I_2^2 - 4I_1^3 I_3 - 4I_2^3 - 27I_3^2 + 18I_1 I_2 I_3 = 0 $$\nSince the Cauchy stress tensor is symmetric, its eigenvalues (the principal stresses) must all be real. The condition for three real roots is $\\Delta \\ge 0$. If $\\Delta = 0$, there are three real roots with at least one repeated. If $\\Delta  0$, there are three distinct real roots. If $\\Delta  0$, there is one real root and a pair of complex conjugate roots, which is not physically possible for principal stresses.\n\nFinally, we assess whether the given set of invariants satisfies this condition. We substitute $I_1 = 12$, $I_2 = 5$, and $I_3 = -150$ into the expression for the discriminant $\\Delta$:\n$$ I_1^2 I_2^2 = (12)^2 (5)^2 = 144 \\times 25 = 3600 $$\n$$ -4I_1^3 I_3 = -4(12)^3 (-150) = 4(1728)(150) = 1036800 $$\n$$ -4I_2^3 = -4(5)^3 = -4(125) = -500 $$\n$$ -27I_3^2 = -27(-150)^2 = -27(22500) = -607500 $$\n$$ 18I_1 I_2 I_3 = 18(12)(5)(-150) = 1080(-150) = -162000 $$\nSumming these terms to find $\\Delta$:\n$$ \\Delta = 3600 + 1036800 - 500 - 607500 - 162000 $$\n$$ \\Delta = (3600 - 500) + (1036800 - 607500 - 162000) $$\n$$ \\Delta = 3100 + (1036800 - 769500) $$\n$$ \\Delta = 3100 + 267300 = 270400 $$\nSince $\\Delta = 270400 \\neq 0$, the condition for a multiple principal stress value is not satisfied. The fact that $\\Delta  0$ confirms that there are three distinct real principal stresses, which is consistent with the roots $\\{-3, 5, 10\\}$ we found by solving the cubic equation directly.",
            "answer": "$$\\boxed{\\begin{pmatrix} -3  5  10 \\end{pmatrix}}$$"
        },
        {
            "introduction": "A cornerstone of continuum mechanics is the principle of material objectivity, which states that constitutive laws must be independent of the observer's reference frame. This practice requires you to computationally verify a key consequence of this principle: the invariance of the deviatoric stress invariants, $J_2$ and $J_3$, under rigid body rotations . By applying the correct tensor transformation rule, you will confirm that while the components of the stress tensor change with rotation, these fundamental scalar measures of the distortional stress state do not.",
            "id": "3565176",
            "problem": "You are given that, for a static continuum with no body couples, the balance of angular momentum implies that the Cauchy stress tensor is symmetric. In computational geomechanics, consider a granular column under gravity in static equilibrium with no body couples. For any stress state at a material point modeled as a symmetric second-order tensor $\\sigma$, define the deviatoric stress $s$ as $$s=\\sigma-\\tfrac{1}{3}I_1\\,\\mathbf{I},$$ where $I_1=\\mathrm{tr}(\\sigma)$ and $\\mathbf{I}$ is the identity tensor. The second and third principal invariants of $s$ are defined by $$J_2=\\tfrac{1}{2}s:s=\\tfrac{1}{2}\\sum_{i=1}^{3}\\sum_{j=1}^{3}s_{ij}s_{ij},\\qquad J_3=\\det(s).$$ Under a rigid rotation represented by a proper orthogonal tensor $R$ (that is, $RR^{\\mathsf{T}}=\\mathbf{I}$ and $\\det(R)=+1$), the stress transforms as $$\\sigma' = R\\,\\sigma\\,R^{\\mathsf{T}}.$$ The objective is to numerically validate from first principles that:\n- the symmetry of $\\sigma$ is preserved by rigid rotation (a numerical manifestation of balance of moments), and\n- the deviatoric invariants $J_2$ and $J_3$ are unchanged by rigid rotation.\n\nYour task is to write a complete program that, for each specified test case, constructs a rotation matrix $R$ from an axisâ€“angle pair using Rodrigues' formula, applies it to a given symmetric Cauchy stress tensor $\\sigma$, forms the deviatoric stresses $s$ and $s'$ before and after rotation, computes $J_2$ and $J_3$ for both, and checks the following with a prescribed numerical tolerance $\\varepsilon$:\n- stress symmetry preservation: the Frobenius norm of the skew-symmetric part of $\\sigma'$ is less than or equal to $\\varepsilon$,\n- $J_2$ invariance: $\\lvert J_2' - J_2\\rvert \\le \\varepsilon$,\n- $J_3$ invariance: $\\lvert J_3' - J_3\\rvert \\le \\varepsilon$.\n\nUse the following foundations only: balance of linear and angular momentum for continua, the tensorial transformation rule for Cauchy stress under rigid rotation, the definition of deviatoric stress, and the definitions of the principal invariants $J_2$ and $J_3$. Angles are to be interpreted in radians. The tolerance is $\\varepsilon=10^{-10}$.\n\nImplement the rotation matrix $R$ from a unit rotation axis $\\boldsymbol{a}=[a_x,a_y,a_z]^{\\mathsf{T}}$ and rotation angle $\\theta$ via Rodrigues' formula:\n$$\nR=\\mathbf{I}+\\sin(\\theta)[\\boldsymbol{a}]_\\times+\\left(1-\\cos(\\theta)\\right)[\\boldsymbol{a}]_\\times^2,\\quad\n[\\boldsymbol{a}]_\\times=\\begin{bmatrix}\n0  -a_z  a_y\\\\\na_z  0  -a_x\\\\\n-a_y  a_x  0\n\\end{bmatrix}.\n$$\nEnsure that $\\boldsymbol{a}$ is normalized before constructing $R$.\n\nTest Suite (each case is a triplet $(\\sigma,\\boldsymbol{a},\\theta)$):\n- Case $1$ (general anisotropic, non-coaxial stress): \n  $$\n  \\sigma=\\begin{bmatrix}\n  120.0  15.0  0.0\\\\\n  15.0  80.0  -5.0\\\\\n  0.0  -5.0  200.0\n  \\end{bmatrix},\\quad\n  \\boldsymbol{a}=\\tfrac{1}{\\sqrt{3}}\\begin{bmatrix}1\\\\1\\\\1\\end{bmatrix},\\quad\n  \\theta=\\tfrac{\\pi}{3}.\n  $$\n- Case $2$ (hydrostatic stress, boundary case with zero deviatoric stress): \n  $$\n  \\sigma=\\begin{bmatrix}\n  100.0  0.0  0.0\\\\\n  0.0  100.0  0.0\\\\\n  0.0  0.0  100.0\n  \\end{bmatrix},\\quad\n  \\boldsymbol{a}=\\begin{bmatrix}0.0\\\\0.0\\\\1.0\\end{bmatrix},\\quad\n  \\theta=\\tfrac{\\pi}{2}.\n  $$\n- Case $3$ (purely deviatoric, trace zero): \n  $$\n  \\sigma=\\begin{bmatrix}\n  30.0  20.0  10.0\\\\\n  20.0  10.0  -5.0\\\\\n  10.0  -5.0  -40.0\n  \\end{bmatrix},\\quad\n  \\boldsymbol{a}=\\begin{bmatrix}1.0\\\\0.0\\\\0.0\\end{bmatrix},\\quad\n  \\theta=\\pi.\n  $$\n- Case $4$ (zero rotation, boundary case): \n  $$\n  \\sigma=\\begin{bmatrix}\n  50.0  0.0  0.0\\\\\n  0.0  40.0  0.0\\\\\n  0.0  0.0  30.0\n  \\end{bmatrix},\\quad\n  \\boldsymbol{a}=\\begin{bmatrix}0.0\\\\1.0\\\\0.0\\end{bmatrix},\\quad\n  \\theta=0.0.\n  $$\n\nFor each test case, your program must:\n- compute $R$ from $(\\boldsymbol{a},\\theta)$,\n- compute $\\sigma' = R\\,\\sigma\\,R^{\\mathsf{T}}$,\n- verify symmetry of $\\sigma'$ by evaluating the Frobenius norm of $(\\sigma'-\\sigma'^{\\mathsf{T}})/2$ against $\\varepsilon$,\n- compute $s$ and $s'$,\n- compute $J_2$, $J_2'$, $J_3$, and $J_3'$,\n- return three booleans per case indicating, in order: symmetry preserved, $J_2$ invariant, $J_3$ invariant.\n\nFinal Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Concatenate the booleans for all cases in order, so the output has length $12$ with entries grouped implicitly as triples per case, e.g., $$[\\text{case }1\\ \\text{symmetry},\\ \\text{case }1\\ J_2,\\ \\text{case }1\\ J_3,\\ \\dots,\\ \\text{case }4\\ \\text{symmetry},\\ \\text{case }4\\ J_2,\\ \\text{case }4\\ J_3].$$ Angles must be interpreted in radians. No physical units are required in the output because the outputs are booleans.",
            "solution": "The problem requires a numerical validation of two fundamental properties of the Cauchy stress tensor, $\\sigma$, within the framework of continuum mechanics. These properties are:\n$1$. The preservation of the symmetry of $\\sigma$ under a rigid body rotation.\n$2$. The invariance of the second and third principal invariants, $J_2$ and $J_3$, of the deviatoric stress tensor, $s$, under the same rotation.\n\nThe validation will be performed for a set of specified test cases, each defined by an initial symmetric stress tensor $\\sigma$, a rotation axis $\\boldsymbol{a}$, and a rotation angle $\\theta$. The solution proceeds by implementing the specified calculations from first principles and checking the results against a given numerical tolerance, $\\varepsilon = 10^{-10}$.\n\nThe theoretical foundation is as follows:\n- The Cauchy stress tensor, $\\sigma$, is a second-order tensor that describes the state of stress at a material point. In the absence of body couples, the balance of angular momentum requires $\\sigma$ to be symmetric, i.e., $\\sigma = \\sigma^{\\mathsf{T}}$.\n- Under a rigid body rotation described by a proper orthogonal tensor $R$ (where $RR^{\\mathsf{T}}=\\mathbf{I}$ and $\\det(R)=1$), a second-order tensor transforms as $\\sigma' = R\\sigma R^{\\mathsf{T}}$. It can be shown analytically that if $\\sigma$ is symmetric, then $\\sigma'$ is also symmetric: $(\\sigma')^{\\mathsf{T}} = (R\\sigma R^{\\mathsf{T}})^{\\mathsf{T}} = (R^{\\mathsf{T}})^{\\mathsf{T}}\\sigma^{\\mathsf{T}}R^{\\mathsf{T}} = R\\sigma R^{\\mathsf{T}} = \\sigma'$.\n- The deviatoric stress tensor, $s$, is defined as the stress tensor with its hydrostatic component removed: $s = \\sigma - p\\mathbf{I}$, where $p = \\frac{1}{3}\\mathrm{tr}(\\sigma)$ is the mean stress. Using the first principal invariant of stress, $I_1 = \\mathrm{tr}(\\sigma)$, this is written as $s = \\sigma - \\frac{1}{3}I_1\\mathbf{I}$.\n- The principal invariants of a tensor are scalar quantities that are independent of the coordinate system. For the deviatoric stress tensor $s$, its second and third invariants, $J_2$ and $J_3$, are defined by $J_2 = \\frac{1}{2}s:s = \\frac{1}{2}\\mathrm{tr}(s^2)$ and $J_3 = \\det(s)$. Their invariance means that if $\\sigma$ transforms to $\\sigma'$, then the corresponding deviatoric tensor $s$ transforms to $s'$, but the invariants computed from $s$ and $s'$ remain the same, i.e., $J_2' = J_2$ and $J_3' = J_3$.\n\nThe numerical procedure for each test case $(\\sigma, \\boldsymbol{a}, \\theta)$ is as follows:\n\n**1. Construct the Rotation Matrix $R$**\nThe rotation matrix $R$ is constructed from the rotation axis $\\boldsymbol{a}$ and angle $\\theta$ using Rodrigues' formula. First, the axis vector $\\boldsymbol{a}$ must be a unit vector, $\\hat{\\boldsymbol{a}}$. We normalize it: $\\hat{\\boldsymbol{a}} = \\boldsymbol{a} / ||\\boldsymbol{a}||$. Then, we form the skew-symmetric matrix $[\\hat{\\boldsymbol{a}}]_\\times$:\n$$\n[\\hat{\\boldsymbol{a}}]_\\times = \\begin{bmatrix} 0  -\\hat{a}_z  \\hat{a}_y \\\\ \\hat{a}_z  0  -\\hat{a}_x \\\\ -\\hat{a}_y  \\hat{a}_x  0 \\end{bmatrix}\n$$\nThe rotation matrix $R$ is then assembled as:\n$$\nR = \\mathbf{I} + \\sin(\\theta)[\\hat{\\boldsymbol{a}}]_\\times + (1-\\cos(\\theta))[\\hat{\\boldsymbol{a}}]_\\times^2\n$$\nHere, $\\mathbf{I}$ is the $3 \\times 3$ identity matrix.\n\n**2. Transform the Stress Tensor**\nThe initial stress tensor $\\sigma$ is transformed into the new coordinate system using the standard tensor transformation rule:\n$$\n\\sigma' = R\\sigma R^{\\mathsf{T}}\n$$\nwhere $R^{\\mathsf{T}}$ is the transpose of $R$.\n\n**3. Verify Symmetry Preservation**\nTo numerically verify that the transformed tensor $\\sigma'$ remains symmetric, we compute its skew-symmetric part, $\\sigma'_{\\text{skew}}$:\n$$\n\\sigma'_{\\text{skew}} = \\frac{1}{2}(\\sigma' - (\\sigma')^{\\mathsf{T}})\n$$\nA perfectly symmetric tensor would have a zero skew-symmetric part. Due to floating-point arithmetic, the result may be a very small non-zero matrix. We quantify its magnitude using the Frobenius norm, $||\\cdot||_F$, and check if it is within the prescribed tolerance $\\varepsilon$:\n$$\n||\\sigma'_{\\text{skew}}||_F = \\sqrt{\\sum_{i=1}^{3}\\sum_{j=1}^{3} (\\sigma'_{\\text{skew}})_{ij}^2} \\le \\varepsilon\n$$\nThe first boolean result for the test case is the outcome of this comparison.\n\n**4. Compute Deviatoric Stresses**\nWe compute the deviatoric stress tensors $s$ and $s'$ corresponding to $\\sigma$ and $\\sigma'$.\n- First, the traces are calculated: $I_1 = \\mathrm{tr}(\\sigma)$ and $I'_1 = \\mathrm{tr}(\\sigma')$.\n- Then, the deviatoric tensors are formed:\n$$\ns = \\sigma - \\frac{1}{3}I_1\\mathbf{I}\n$$\n$$\ns' = \\sigma' - \\frac{1}{3}I'_1\\mathbf{I}\n$$\n\n**5. Verify Invariance of $J_2$ and $J_3$**\nFinally, we compute the invariants for both deviatoric tensors and check if their values are preserved.\n- **$J_2$ Invariance:** The second deviatoric invariant $J_2$ is calculated as half of the sum of the squares of the tensor components:\n$$\nJ_2 = \\frac{1}{2}\\sum_{i,j} s_{ij}^2 \\qquad \\text{and} \\qquad J'_2 = \\frac{1}{2}\\sum_{i,j} (s'_{ij})^2\n$$\nThe invariance is checked by comparing their absolute difference against the tolerance:\n$$\n|J'_2 - J_2| \\le \\varepsilon\n$$\nThe second boolean result is the outcome of this check.\n- **$J_3$ Invariance:** The third deviatoric invariant $J_3$ is the determinant of the deviatoric stress tensor:\n$$\nJ_3 = \\det(s) \\qquad \\text{and} \\qquad J'_3 = \\det(s')\n$$\nThe invariance is verified similarly:\n$$\n|J'_3 - J_3| \\le \\varepsilon\n$$\nThe third boolean result is determined by this comparison.\n\nThis entire procedure is applied to each of the four test cases provided, generating a total of $12$ boolean values which are then formatted into the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics problem by numerically validating\n    stress symmetry preservation and deviatoric invariant properties under\n    rigid rotations for a given set of test cases.\n    \"\"\"\n\n    # Define the tolerance for numerical comparisons.\n    epsilon = 1e-10\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (sigma, a, theta)\n    test_cases = [\n        (\n            np.array([[120.0, 15.0, 0.0],\n                      [15.0, 80.0, -5.0],\n                      [0.0, -5.0, 200.0]]),\n            np.array([1.0, 1.0, 1.0]) / np.sqrt(3),\n            np.pi / 3\n        ),\n        (\n            np.array([[100.0, 0.0, 0.0],\n                      [0.0, 100.0, 0.0],\n                      [0.0, 0.0, 100.0]]),\n            np.array([0.0, 0.0, 1.0]),\n            np.pi / 2\n        ),\n        (\n            np.array([[30.0, 20.0, 10.0],\n                      [20.0, 10.0, -5.0],\n                      [10.0, -5.0, -40.0]]),\n            np.array([1.0, 0.0, 0.0]),\n            np.pi\n        ),\n        (\n            np.array([[50.0, 0.0, 0.0],\n                      [0.0, 40.0, 0.0],\n                      [0.0, 0.0, 30.0]]),\n            np.array([0.0, 1.0, 0.0]),\n            0.0\n        ),\n    ]\n\n    results = []\n    for sigma, a, theta in test_cases:\n        # Step 1: Construct the Rotation Matrix R using Rodrigues' formula.\n        # Ensure the rotation axis 'a' is a unit vector.\n        norm_a = np.linalg.norm(a)\n        if norm_a > 0:\n            a_hat = a / norm_a\n        else:\n            # A zero vector axis is only meaningful for theta=0, where R is Identity.\n            # a_hat becomes [0,0,0], which correctly yields R=I in Rodrigues' formula.\n            a_hat = a\n\n        # Construct the skew-symmetric matrix [a_hat]_x\n        ax, ay, az = a_hat\n        a_cross = np.array([[0, -az, ay],\n                            [az, 0, -ax],\n                            [-ay, ax, 0]])\n        \n        # Identity matrix\n        I = np.identity(3)\n        \n        # Rodrigues' formula\n        R = I + np.sin(theta) * a_cross + (1 - np.cos(theta)) * (a_cross @ a_cross)\n\n        # Step 2: Transform the stress tensor\n        sigma_prime = R @ sigma @ R.T\n\n        # Step 3: Verify symmetry preservation of sigma_prime\n        skew_sigma_prime = 0.5 * (sigma_prime - sigma_prime.T)\n        norm_skew = np.linalg.norm(skew_sigma_prime, 'fro')\n        symmetry_preserved = norm_skew = epsilon\n        \n        # Step 4: Compute deviatoric stresses s and s'\n        I1 = np.trace(sigma)\n        s = sigma - (I1 / 3) * I\n        \n        I1_prime = np.trace(sigma_prime)\n        s_prime = sigma_prime - (I1_prime / 3) * I\n        \n        # Step 5: Verify invariance of J2 and J3\n        \n        # Calculate J2 and J2_prime\n        # J2 = 1/2 * s:s = 1/2 * sum(s_ij * s_ij)\n        J2 = 0.5 * np.sum(s * s)\n        J2_prime = 0.5 * np.sum(s_prime * s_prime)\n        \n        # Check J2 invariance\n        j2_invariant = np.abs(J2_prime - J2) = epsilon\n        \n        # Calculate J3 and J3_prime\n        # J3 = det(s)\n        J3 = np.linalg.det(s)\n        J3_prime = np.linalg.det(s_prime)\n        \n        # Check J3 invariance\n        j3_invariant = np.abs(J3_prime - J3) = epsilon\n\n        # Append the three boolean results for the current case\n        results.extend([symmetry_preserved, j2_invariant, j3_invariant])\n\n    # Final print statement in the exact required format.\n    # The map(str,...) converts Python booleans (True/False) to strings.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While theory dictates that the Cauchy stress tensor is symmetric due to moment equilibrium, numerical methods can introduce small asymmetries. This exercise focuses on the practical task of building a robust computational workflow for stress analysis that begins by enforcing this physical symmetry before proceeding with spectral decomposition . You will implement checks to verify the consistency between invariants computed directly from the tensor components and those derived from its eigenvalues, a crucial step for ensuring the reliability of any advanced geomechanical simulation.",
            "id": "3565171",
            "problem": "You are tasked with designing and implementing a robust computational routine for the spectral decomposition of a Cauchy stress tensor, as used in computational geomechanics. The routine must enforce the fundamental physical requirement of symmetry of the Cauchy stress tensor prior to eigenanalysis, verify moment equilibrium consistency, and compare principal invariant consistency against direct tensor-component evaluations for representative stress states arising in complex landslide geometries.\n\nStart from the following fundamental base:\n- The balance of angular momentum in a continuum without body couples implies that the Cauchy stress tensor is symmetric, i.e., $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathsf{T}}$.\n- For a real symmetric matrix, the spectral theorem guarantees the existence of an orthonormal basis of eigenvectors. Thus, there exists an orthogonal matrix $\\boldsymbol{Q}$ and a diagonal matrix $\\boldsymbol{\\Lambda} = \\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3)$ such that $\\boldsymbol{\\sigma} = \\boldsymbol{Q}\\boldsymbol{\\Lambda}\\boldsymbol{Q}^{\\mathsf{T}}$, where $\\lambda_i$ are the principal stresses.\n- The principal invariants of $\\boldsymbol{\\sigma}$ are defined as\n$$\nI_1 = \\operatorname{tr}(\\boldsymbol{\\sigma}), \\quad\nI_2 = \\tfrac{1}{2}\\left[\\left(\\operatorname{tr}\\boldsymbol{\\sigma}\\right)^2 - \\operatorname{tr}\\left(\\boldsymbol{\\sigma}^2\\right)\\right], \\quad\nI_3 = \\det(\\boldsymbol{\\sigma}).\n$$\n- The deviatoric stress is $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\tfrac{I_1}{3}\\boldsymbol{I}$, where $\\boldsymbol{I}$ is the identity tensor. Its invariants are\n$$\nJ_2 = \\tfrac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}, \\quad\nJ_3 = \\det(\\boldsymbol{s}),\n$$\nand since $\\boldsymbol{s}$ shares the eigenvectors with $\\boldsymbol{\\sigma}$, if $\\lambda_i$ are the principal stresses, then the principal deviatoric stresses are $\\lambda_i' = \\lambda_i - \\tfrac{I_1}{3}$ and\n$$\nI_1 = \\lambda_1 + \\lambda_2 + \\lambda_3, \\quad\nI_2 = \\lambda_1\\lambda_2 + \\lambda_2\\lambda_3 + \\lambda_3\\lambda_1, \\quad\nI_3 = \\lambda_1\\lambda_2\\lambda_3,\n$$\n$$\nJ_2 = \\tfrac{1}{2}\\sum_{i=1}^3 (\\lambda_i')^2, \\quad\nJ_3 = \\lambda_1' \\lambda_2' \\lambda_3'.\n$$\n\nImplement a program that:\n1. Takes a list of $3 \\times 3$ real matrices $\\boldsymbol{\\sigma}$ (each in Pascals) representing stress states typical of complex landslide geometries.\n2. Enforces symmetry using $\\boldsymbol{\\sigma}_{\\mathrm{sym}} = \\tfrac{1}{2}(\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}^{\\mathsf{T}})$ to honor moment equilibrium prior to eigenanalysis.\n3. Performs spectral decomposition on $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ to obtain $\\lambda_1,\\lambda_2,\\lambda_3$ and an orthonormal matrix of principal directions $\\boldsymbol{Q}$, and reconstructs $\\boldsymbol{\\sigma}_{\\mathrm{rec}} = \\boldsymbol{Q}\\operatorname{diag}(\\lambda_1,\\lambda_2,\\lambda_3)\\boldsymbol{Q}^{\\mathsf{T}}$.\n4. Computes the invariants $I_1$, $I_2$, $I_3$ and $J_2$, $J_3$ directly from tensor components, and independently from the principal stresses.\n5. Computes dimensionless normalized mismatch metrics for each invariant as\n$$\nr_{I_1} = \\frac{\\left|I_1^{\\text{direct}} - I_1^{\\text{eig}}\\right|}{\\max\\left(\\left|I_1^{\\text{direct}}\\right|,\\, 1\\right)}, \\quad\nr_{I_2} = \\frac{\\left|I_2^{\\text{direct}} - I_2^{\\text{eig}}\\right|}{\\max\\left(\\left|I_2^{\\text{direct}}\\right|,\\, 1\\right)}, \\quad\nr_{I_3} = \\frac{\\left|I_3^{\\text{direct}} - I_3^{\\text{eig}}\\right|}{\\max\\left(\\left|I_3^{\\text{direct}}\\right|,\\, 1\\right)},\n$$\n$$\nr_{J_2} = \\frac{\\left|J_2^{\\text{direct}} - J_2^{\\text{eig}}\\right|}{\\max\\left(\\left|J_2^{\\text{direct}}\\right|,\\, 1\\right)}, \\quad\nr_{J_3} = \\frac{\\left|J_3^{\\text{direct}} - J_3^{\\text{eig}}\\right|}{\\max\\left(\\left|J_3^{\\text{direct}}\\right|,\\, 1\\right)}.\n$$\n6. Computes the reconstruction residual and the post-symmetrization skew residual as\n$$\nr_{\\mathrm{rec}} = \\frac{\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\boldsymbol{\\sigma}_{\\mathrm{rec}}\\right\\|_{\\mathrm{F}}}{\\max\\left(\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}}\\right\\|_{\\mathrm{F}},\\, 1\\right)}, \\quad\nr_{\\mathrm{skew}} = \\frac{\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\boldsymbol{\\sigma}_{\\mathrm{sym}}^{\\mathsf{T}}\\right\\|_{\\mathrm{F}}}{\\max\\left(\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}}\\right\\|_{\\mathrm{F}},\\, 1\\right)},\n$$\nwhere $\\|\\cdot\\|_{\\mathrm{F}}$ denotes the Frobenius norm.\n7. For each test case, returns a single float equal to the maximum of the seven dimensionless normalized mismatch metrics\n$$\nm = \\max\\left(r_{I_1}, r_{I_2}, r_{I_3}, r_{J_2}, r_{J_3}, r_{\\mathrm{rec}}, r_{\\mathrm{skew}}\\right).\n$$\n\nUnits: All stress components are in Pascals; all mismatch metrics are dimensionless.\n\nAngle unit: Not applicable.\n\nTest suite:\n- Case $1$ (happy path, symmetric interior slope stress):\n$$\n\\boldsymbol{\\sigma}^{(1)} =\n\\begin{bmatrix}\n-120\\times 10^3  30\\times 10^3  0 \\\\\n30\\times 10^3  -80\\times 10^3  5\\times 10^3 \\\\\n0  5\\times 10^3  -20\\times 10^3\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n- Case $2$ (near-symmetric with small antisymmetric discretization noise):\n$$\n\\boldsymbol{\\sigma}^{(2)} = \\boldsymbol{\\sigma}^{(1)} +\n\\begin{bmatrix}\n0  200  -100 \\\\\n-200  0  50 \\\\\n100  -50  0\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n- Case $3$ (nearly hydrostatic compressive state with small shear):\n$$\n\\boldsymbol{\\sigma}^{(3)} =\n\\begin{bmatrix}\n-100\\times 10^3  200  0 \\\\\n200  -100\\times 10^3  0 \\\\\n0  0  -100\\times 10^3\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n- Case $4$ (ill-conditioned magnitudes with significant shear coupling):\n$$\n\\boldsymbol{\\sigma}^{(4)} =\n\\begin{bmatrix}\n-1.0\\times 10^6  4.0\\times 10^4  -3.0\\times 10^4 \\\\\n4.0\\times 10^4  -5.0\\times 10^3  2.0\\times 10^4 \\\\\n-3.0\\times 10^4  2.0\\times 10^4  2.0\\times 10^4\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n- Case $5$ (strongly deviatoric with zero trace, crest/tensile-shear mix):\n$$\n\\boldsymbol{\\sigma}^{(5)} =\n\\begin{bmatrix}\n50\\times 10^3  10\\times 10^3  -5\\times 10^3 \\\\\n10\\times 10^3  -30\\times 10^3  8\\times 10^3 \\\\\n-5\\times 10^3  8\\times 10^3  -20\\times 10^3\n\\end{bmatrix} \\, \\text{Pa}.\n$$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[m^{(1)},m^{(2)},m^{(3)},m^{(4)},m^{(5)}]$), where each $m^{(i)}$ is the maximum dimensionless normalized mismatch for Case $i$ rounded by default floating-point formatting. No other output is allowed.",
            "solution": "The problem statement is a well-posed and scientifically sound exercise in computational geomechanics. It requires the implementation of a numerical routine to analyze the Cauchy stress tensor, with a focus on verifying the consistency of its spectral properties and invariants. All definitions, principles, and procedures outlined are standard in continuum mechanics and numerical linear algebra. The provided test cases are realistic and serve to validate the robustness of the implementation across different stress regimes. Therefore, the problem is valid, and a full solution is warranted.\n\nThe solution will be developed following the sequence of operations specified in the problem statement. The core of this task is to implement and verify the mathematical relationships between a stress tensor, its invariants, and its spectral decomposition.\n\n1.  **Enforcement of Symmetry**: The fundamental principle of conservation of angular momentum, in the absence of body couples, dictates that the Cauchy stress tensor $\\boldsymbol{\\sigma}$ must be symmetric, i.e., $\\sigma_{ij} = \\sigma_{ji}$. Numerical models can sometimes produce slightly asymmetric stress tensors due to discretization errors or particular algorithmic choices. To restore physical consistency, any given tensor $\\boldsymbol{\\sigma}$ is first symmetrized. The symmetric part of any tensor $\\boldsymbol{\\sigma}$ is given by $\\boldsymbol{\\sigma}_{\\mathrm{sym}} = \\frac{1}{2}(\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}^{\\mathsf{T}})$. This operation projects the tensor from the general space of second-order tensors ($\\mathbb{R}^{3 \\times 3}$) onto the subspace of symmetric second-order tensors. All subsequent analyses must be performed on $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$.\n\n2.  **Spectral Decomposition**: The spectral theorem for real symmetric matrices guarantees that $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ can be diagonalized by an orthogonal transformation. This is expressed as:\n    $$ \\boldsymbol{\\sigma}_{\\mathrm{sym}} = \\boldsymbol{Q}\\boldsymbol{\\Lambda}\\boldsymbol{Q}^{\\mathsf{T}} $$\n    where:\n    - $\\boldsymbol{\\Lambda}$ is a diagonal matrix containing the eigenvalues $\\lambda_1, \\lambda_2, \\lambda_3$ of $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$. These real-valued eigenvalues are the principal stresses.\n    - $\\boldsymbol{Q}$ is an orthogonal matrix ($\\boldsymbol{Q}^{\\mathsf{T}}\\boldsymbol{Q} = \\boldsymbol{Q}\\boldsymbol{Q}^{\\mathsf{T}} = \\boldsymbol{I}$) whose columns are the corresponding orthonormal eigenvectors. These eigenvectors define the principal directions of the stress state.\n    A numerical eigensolver, such as the one provided by `numpy.linalg.eigh`, will be used to compute $\\boldsymbol{\\Lambda}$ (as a vector of eigenvalues) and $\\boldsymbol{Q}$.\n\n3.  **Calculation of Invariants**: The principal invariants of a tensor are scalar quantities that are independent of the coordinate system used to represent the tensor. They characterize intrinsic properties of the stress state. We will compute them using two independent methods to check for numerical consistency.\n\n    a.  **Direct Calculation from Tensor Components**: Using the components of $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$:\n        - First invariant (trace): $I_1^{\\text{direct}} = \\operatorname{tr}(\\boldsymbol{\\sigma}_{\\mathrm{sym}}) = \\sigma_{11} + \\sigma_{22} + \\sigma_{33}$.\n        - Second invariant: $I_2^{\\text{direct}} = \\frac{1}{2}\\left[\\left(\\operatorname{tr}\\boldsymbol{\\sigma}_{\\mathrm{sym}}\\right)^2 - \\operatorname{tr}\\left(\\boldsymbol{\\sigma}_{\\mathrm{sym}}^2\\right)\\right]$.\n        - Third invariant (determinant): $I_3^{\\text{direct}} = \\det(\\boldsymbol{\\sigma}_{\\mathrm{sym}})$.\n\n        To find the deviatoric invariants, we first compute the deviatoric stress tensor $\\boldsymbol{s}_{\\mathrm{sym}} = \\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\frac{I_1^{\\text{direct}}}{3}\\boldsymbol{I}$. Then:\n        - Second deviatoric invariant: $J_2^{\\text{direct}} = \\frac{1}{2}\\boldsymbol{s}_{\\mathrm{sym}}:\\boldsymbol{s}_{\\mathrm{sym}} = \\frac{1}{2}\\sum_{i,j} (s_{\\mathrm{sym}})_{ij}^2$.\n        - Third deviatoric invariant: $J_3^{\\text{direct}} = \\det(\\boldsymbol{s}_{\\mathrm{sym}})$.\n\n    b.  **Calculation from Eigenvalues (Principal Stresses)**: Using the computed principal stresses $\\lambda_1, \\lambda_2, \\lambda_3$:\n        - $I_1^{\\text{eig}} = \\lambda_1 + \\lambda_2 + \\lambda_3$.\n        - $I_2^{\\text{eig}} = \\lambda_1\\lambda_2 + \\lambda_2\\lambda_3 + \\lambda_3\\lambda_1$.\n        - $I_3^{\\text{eig}} = \\lambda_1\\lambda_2\\lambda_3$.\n\n        The principal deviatoric stresses are $\\lambda_i' = \\lambda_i - \\frac{I_1^{\\text{eig}}}{3}$. Then:\n        - $J_2^{\\text{eig}} = \\frac{1}{2}\\sum_{i=1}^3 (\\lambda_i')^2$.\n        - $J_3^{\\text{eig}} = \\lambda_1'\\lambda_2'\\lambda_3'$.\n\n4.  **Verification and Mismatch Metrics**: The final step is to quantify the numerical accuracy and consistency of the computations.\n\n    - **Invariant Mismatch**: The dimensionless normalized differences ($r_{I_1}, r_{I_2}, r_{I_3}, r_{J_2}, r_{J_3}$) compare the results from the direct and eigenvalue-based methods. For a perfect numerical calculation, these mismatches would be zero. In practice, they will be on the order of machine precision. The denominator $\\max(|\\text{value}|, 1)$ robustly handles cases where an invariant is zero or very small.\n\n    - **Reconstruction Residual ($r_{\\mathrm{rec}}$)**: This metric checks the accuracy of the eigensolver itself. We reconstruct the tensor from its spectral components, $\\boldsymbol{\\sigma}_{\\mathrm{rec}} = \\boldsymbol{Q}\\boldsymbol{\\Lambda}\\boldsymbol{Q}^{\\mathsf{T}}$, and compare it to the original symmetric tensor, $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$. The Frobenius norm of the difference, normalized, should be close to zero.\n    \n    - **Skew-Symmetry Residual ($r_{\\mathrm{skew}}$)**: This metric, $r_{\\mathrm{skew}} = \\frac{\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\boldsymbol{\\sigma}_{\\mathrm{sym}}^{\\mathsf{T}}\\right\\|_{\\mathrm{F}}}{\\max\\left(\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{sym}}\\right\\|_{\\mathrm{F}},\\, 1\\right)}$, serves as a sanity check on the symmetrization step. By construction, $\\boldsymbol{\\sigma}_{\\mathrm{sym}}$ is perfectly symmetric. Therefore, $\\boldsymbol{\\sigma}_{\\mathrm{sym}} - \\boldsymbol{\\sigma}_{\\mathrm{sym}}^{\\mathsf{T}}$ is the zero matrix, and $r_{\\mathrm{skew}}$ must be exactly zero. This confirms the correct implementation of the symmetrization and serves as a baseline for the other numerical errors.\n\nFinally, the maximum of these seven metrics, $m = \\max(r_{I_1}, r_{I_2}, r_{I_3}, r_{J_2}, r_{J_3}, r_{\\mathrm{rec}}, r_{\\mathrm{skew}})$, is taken as the single, conservative measure of the overall numerical quality for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the stress tensor analysis for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: happy path, symmetric interior slope stress\n        np.array([\n            [-120e3, 30e3, 0],\n            [30e3, -80e3, 5e3],\n            [0, 5e3, -20e3]\n        ]),\n        # Case 2: near-symmetric with small antisymmetric discretization noise\n        np.array([\n            [-120e3, 30e3 + 200, -100],\n            [30e3 - 200, -80e3, 5e3 + 50],\n            [100, 5e3 - 50, -20e3]\n        ]),\n        # Case 3: nearly hydrostatic compressive state with small shear\n        np.array([\n            [-100e3, 200, 0],\n            [200, -100e3, 0],\n            [0, 0, -100e3]\n        ]),\n        # Case 4: ill-conditioned magnitudes with significant shear coupling\n        np.array([\n            [-1.0e6, 4.0e4, -3.0e4],\n            [4.0e4, -5.0e3, 2.0e4],\n            [-3.0e4, 2.0e4, 2.0e4]\n        ]),\n        # Case 5: strongly deviatoric with zero trace, crest/tensile-shear mix\n        np.array([\n            [50e3, 10e3, -5e3],\n            [10e3, -30e3, 8e3],\n            [-5e3, 8e3, -20e3]\n        ])\n    ]\n\n    results = []\n    for sigma in test_cases:\n        m = analyze_stress_tensor(sigma)\n        results.append(m)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.16e}' for r in results)}]\")\n\ndef analyze_stress_tensor(sigma: np.ndarray) -> float:\n    \"\"\"\n    Performs the complete analysis for a single 3x3 stress tensor.\n    \n    Args:\n        sigma: A 3x3 numpy array representing the Cauchy stress tensor.\n\n    Returns:\n        The maximum dimensionless normalized mismatch metric.\n    \"\"\"\n    # 1. Enforce symmetry\n    sigma_sym = 0.5 * (sigma + sigma.T)\n\n    # 2. Spectral decomposition of the symmetric tensor\n    # np.linalg.eigh is for hermitian/symmetric matrices, guaranteeing real eigenvalues\n    # and being more numerically stable for this case.\n    # The eigenvalues are not guaranteed to be sorted.\n    # The columns of eigvecs are the corresponding eigenvectors.\n    eigvals, eigvecs = np.linalg.eigh(sigma_sym)\n\n    # 3. Reconstruct the tensor to check eigensolver accuracy\n    sigma_rec = eigvecs @ np.diag(eigvals) @ eigvecs.T\n\n    # 4. Compute invariants directly from tensor components\n    I1_direct = np.trace(sigma_sym)\n    I2_direct = 0.5 * (np.trace(sigma_sym)**2 - np.trace(sigma_sym @ sigma_sym))\n    I3_direct = np.linalg.det(sigma_sym)\n    \n    s_sym = sigma_sym - (I1_direct / 3.0) * np.identity(3)\n    J2_direct = 0.5 * np.sum(s_sym**2)  # 0.5 * s:s\n    J3_direct = np.linalg.det(s_sym)\n\n    # Compute invariants from principal stresses (eigenvalues)\n    lambdas = eigvals\n    I1_eig = np.sum(lambdas)\n    # This formula is robust to the order of eigenvalues\n    I2_eig = lambdas[0]*lambdas[1] + lambdas[1]*lambdas[2] + lambdas[2]*lambdas[0]\n    I3_eig = np.prod(lambdas)\n\n    s_lambdas = lambdas - (I1_eig / 3.0)\n    J2_eig = 0.5 * np.sum(s_lambdas**2)\n    J3_eig = np.prod(s_lambdas)\n\n    # 5. Compute dimensionless normalized mismatch metrics for invariants\n    def mismatch(direct_val, eig_val):\n        numerator = np.abs(direct_val - eig_val)\n        denominator = np.maximum(np.abs(direct_val), 1.0)\n        return numerator / denominator\n\n    r_I1 = mismatch(I1_direct, I1_eig)\n    r_I2 = mismatch(I2_direct, I2_eig)\n    r_I3 = mismatch(I3_direct, I3_eig)\n    r_J2 = mismatch(J2_direct, J2_eig)\n    r_J3 = mismatch(J3_direct, J3_eig)\n\n    # 6. Compute reconstruction and skew residuals\n    norm_sigma_sym = np.linalg.norm(sigma_sym, 'fro')\n    \n    r_rec = np.linalg.norm(sigma_sym - sigma_rec, 'fro') / np.maximum(norm_sigma_sym, 1.0)\n    \n    # By construction, sigma_sym is symmetric, so this should be 0.0\n    r_skew = np.linalg.norm(sigma_sym - sigma_sym.T, 'fro') / np.maximum(norm_sigma_sym, 1.0)\n    \n    # 7. Find the maximum of all seven metrics\n    m = max(r_I1, r_I2, r_I3, r_J2, r_J3, r_rec, r_skew)\n    \n    return m\n\n# Execute the main function\nsolve()\n\n```"
        }
    ]
}