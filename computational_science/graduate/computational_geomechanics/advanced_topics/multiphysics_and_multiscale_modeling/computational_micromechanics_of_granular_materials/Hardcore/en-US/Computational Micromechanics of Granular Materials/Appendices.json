{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in micromechanics is to quantitatively describe the material's internal structure, as this fabric governs its mechanical behavior. This exercise guides you through computing the fabric tensor, a fundamental descriptor of geometric anisotropy, from a discrete set of contact data. By calculating its principal values and directions, you will learn to connect the directional arrangement of particle contacts to the anisotropic nature of the material's properties .",
            "id": "3507288",
            "problem": "A three-dimensional periodic granular Representative Volume Element (RVE) contains a small ensemble of contacts resolved from a Discrete Element Method (DEM) simulation. The RVE is a cube with side length $L$ and volume $V=L^{3}$, and periodic boundary conditions ensure that branch vectors are taken with the minimum image convention. The contact geometry is provided as a set of branch vectors $\\{\\boldsymbol{\\ell}^{(c)}\\}$ connecting particle centers and their associated unit contact normals $\\{\\boldsymbol{n}^{(c)}\\}$, for $c=1,\\dots,N_{c}$ with $N_{c}=6$. The data are\n- $c=1$: $\\boldsymbol{\\ell}^{(1)}=(1.2\\times 10^{-3},\\,0,\\,0)\\,\\text{m}$, $\\boldsymbol{n}^{(1)}=(1,\\,0,\\,0)$,\n- $c=2$: $\\boldsymbol{\\ell}^{(2)}=(1.1\\times 10^{-3},\\,0,\\,0)\\,\\text{m}$, $\\boldsymbol{n}^{(2)}=(1,\\,0,\\,0)$,\n- $c=3$: $\\boldsymbol{\\ell}^{(3)}=(0,\\,0.9\\times 10^{-3},\\,0)\\,\\text{m}$, $\\boldsymbol{n}^{(3)}=(0,\\,1,\\,0)$,\n- $c=4$: $\\boldsymbol{\\ell}^{(4)}=(0,\\,0.8\\times 10^{-3},\\,0)\\,\\text{m}$, $\\boldsymbol{n}^{(4)}=(0,\\,1,\\,0)$,\n- $c=5$: $\\boldsymbol{\\ell}^{(5)}=(0,\\,0,\\,0.7\\times 10^{-3})\\,\\text{m}$, $\\boldsymbol{n}^{(5)}=(0,\\,0,\\,1)$,\n- $c=6$: $\\boldsymbol{\\ell}^{(6)}=(0,\\,0,\\,0.6\\times 10^{-3})\\,\\text{m}$, $\\boldsymbol{n}^{(6)}=(0,\\,0,\\,1)$.\n\nStarting from a fundamental definition of the fabric as the second moment of the contact orientation distribution on the unit sphere, and recognizing that branch lengths provide a physically motivated measure of spatial weighting for discrete contacts in a periodic cell, derive a consistent, trace-normalized expression for the fabric tensor $F_{ij}$ in terms of $\\{\\boldsymbol{n}^{(c)}\\}$ and $\\{|\\boldsymbol{\\ell}^{(c)}|\\}$. Use this expression to compute the components of $F_{ij}$ for the given data. Then, compute the eigenvalues and eigenvectors of $F_{ij}$, and the anisotropy index\n$$\na=\\frac{\\lambda_{\\max}-\\lambda_{\\min}}{\\lambda_{\\max}+\\lambda_{\\min}}\\,,\n$$\nwhere $\\lambda_{\\max}$ and $\\lambda_{\\min}$ are the largest and smallest eigenvalues of $F_{ij}$. Explain the physical meaning of $F_{ij}$, its principal directions, and $a$ within computational micromechanics of granular materials, focusing on how periodicity and branch-length weighting influence these quantities.\n\nRound your final anisotropy index to four significant figures. Express the anisotropy index as a decimal and do not include a unit.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of computational micromechanics, is well-posed with sufficient and consistent data, and is stated in objective, formal language. The problem requires the derivation and calculation of the fabric tensor for a discrete granular system, which is a standard procedure in the field.\n\nThe fabric tensor, $F_{ij}$, is a descriptor of the geometric anisotropy of a granular material's contact network. It is defined as the second moment of the contact orientation distribution function, $E(\\boldsymbol{n})$, over the surface of a unit sphere, $\\Omega$. For a continuous distribution, this is given by:\n$$\nF_{ij} = \\int_{\\Omega} n_i n_j E(\\boldsymbol{n}) d\\Omega\n$$\nFor a discrete system of $N_c$ contacts, this integral becomes a weighted summation:\n$$\nF_{ij} = C \\sum_{c=1}^{N_c} w^{(c)} n_i^{(c)} n_j^{(c)}\n$$\nwhere $\\boldsymbol{n}^{(c)}$ is the unit normal vector for contact $c$, $w^{(c)}$ is a weighting factor, and $C$ is a normalization constant.\n\nThe problem specifies that the branch lengths, $\\{|\\boldsymbol{\\ell}^{(c)}|\\}$, should be used as the physically motivated weighting factors, so $w^{(c)} = |\\boldsymbol{\\ell}^{(c)}|$. The unnormalized fabric tensor, $\\tilde{F}_{ij}$, is therefore:\n$$\n\\tilde{F}_{ij} = \\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}| n_i^{(c)} n_j^{(c)}\n$$\nThe problem requires a trace-normalized expression, meaning the trace of the final tensor, $\\text{tr}(\\boldsymbol{F}) = F_{kk} = \\sum_{k=1}^3 F_{kk}$, must equal $1$. We first compute the trace of the unnormalized tensor, $\\tilde{F}_{ij}$:\n$$\n\\text{tr}(\\tilde{\\boldsymbol{F}}) = \\sum_{k=1}^3 \\tilde{F}_{kk} = \\sum_{k=1}^3 \\left( \\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}| n_k^{(c)} n_k^{(c)} \\right) = \\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}| \\left( \\sum_{k=1}^3 n_k^{(c)} n_k^{(c)} \\right)\n$$\nSince each $\\boldsymbol{n}^{(c)}$ is a unit vector, the inner sum is $|\\boldsymbol{n}^{(c)}|^2 = 1$. This simplifies the trace to:\n$$\n\\text{tr}(\\tilde{\\boldsymbol{F}}) = \\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}|\n$$\nTo achieve trace normalization, we must divide $\\tilde{F}_{ij}$ by its trace. This gives the consistent, trace-normalized expression for the fabric tensor:\n$$\nF_{ij} = \\frac{\\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}| n_i^{(c)} n_j^{(c)}}{\\sum_{c=1}^{N_c} |\\boldsymbol{\\ell}^{(c)}|}\n$$\nNow, we compute the components of $F_{ij}$ using the provided data. First, we calculate the magnitudes of the branch vectors and their sum.\nFor $c=1$, $|\\boldsymbol{\\ell}^{(1)}| = 1.2 \\times 10^{-3}\\,\\text{m}$.\nFor $c=2$, $|\\boldsymbol{\\ell}^{(2)}| = 1.1 \\times 10^{-3}\\,\\text{m}$.\nFor $c=3$, $|\\boldsymbol{\\ell}^{(3)}| = 0.9 \\times 10^{-3}\\,\\text{m}$.\nFor $c=4$, $|\\boldsymbol{\\ell}^{(4)}| = 0.8 \\times 10^{-3}\\,\\text{m}$.\nFor $c=5$, $|\\boldsymbol{\\ell}^{(5)}| = 0.7 \\times 10^{-3}\\,\\text{m}$.\nFor $c=6$, $|\\boldsymbol{\\ell}^{(6)}| = 0.6 \\times 10^{-3}\\,\\text{m}$.\n\nThe normalization denominator is the sum of these lengths:\n$$\n\\sum_{c=1}^{6} |\\boldsymbol{\\ell}^{(c)}| = (1.2 + 1.1 + 0.9 + 0.8 + 0.7 + 0.6) \\times 10^{-3}\\,\\text{m} = 5.3 \\times 10^{-3}\\,\\text{m}\n$$\nNext, we compute the components of the unnormalized tensor $\\tilde{F}_{ij}$. The term $n_i^{(c)} n_j^{(c)}$ is the outer product of the normal vector with itself.\nContacts $c=1$ and $c=2$ have $\\boldsymbol{n}=(1,0,0)$. Their contribution is only to $\\tilde{F}_{11}$.\n$\\tilde{F}_{11} = |\\boldsymbol{\\ell}^{(1)}| (1 \\cdot 1) + |\\boldsymbol{\\ell}^{(2)}| (1 \\cdot 1) = (1.2 + 1.1) \\times 10^{-3} = 2.3 \\times 10^{-3}\\,\\text{m}$.\nContacts $c=3$ and $c=4$ have $\\boldsymbol{n}=(0,1,0)$. Their contribution is only to $\\tilde{F}_{22}$.\n$\\tilde{F}_{22} = |\\boldsymbol{\\ell}^{(3)}| (1 \\cdot 1) + |\\boldsymbol{\\ell}^{(4)}| (1 \\cdot 1) = (0.9 + 0.8) \\times 10^{-3} = 1.7 \\times 10^{-3}\\,\\text{m}$.\nContacts $c=5$ and $c=6$ have $\\boldsymbol{n}=(0,0,1)$. Their contribution is only to $\\tilde{F}_{33}$.\n$\\tilde{F}_{33} = |\\boldsymbol{\\ell}^{(5)}| (1 \\cdot 1) + |\\boldsymbol{\\ell}^{(6)}| (1 \\cdot 1) = (0.7 + 0.6) \\times 10^{-3} = 1.3 \\times 10^{-3}\\,\\text{m}$.\nAll off-diagonal components $\\tilde{F}_{ij}$ for $i \\neq j$ are zero because none of the contact normals have more than one non-zero component.\nThe unnormalized tensor is:\n$$\n\\tilde{\\boldsymbol{F}} = \\begin{pmatrix} 2.3  0  0 \\\\ 0  1.7  0 \\\\ 0  0  1.3 \\end{pmatrix} \\times 10^{-3}\\,\\text{m}\n$$\nNormalizing by $\\sum |\\boldsymbol{\\ell}^{(c)}| = 5.3 \\times 10^{-3}\\,\\text{m}$:\n$$\n\\boldsymbol{F} = \\frac{1}{5.3} \\begin{pmatrix} 2.3  0  0 \\\\ 0  1.7  0 \\\\ 0  0  1.3 \\end{pmatrix} = \\begin{pmatrix} \\frac{2.3}{5.3}  0  0 \\\\ 0  \\frac{1.7}{5.3}  0 \\\\ 0  0  \\frac{1.3}{5.3} \\end{pmatrix}\n$$\nThe fabric tensor is diagonal. Therefore, its eigenvalues are the diagonal elements and its eigenvectors are the standard basis vectors.\nThe eigenvalues are:\n$\\lambda_1 = \\lambda_{\\max} = \\frac{2.3}{5.3}$\n$\\lambda_2 = \\frac{1.7}{5.3}$\n$\\lambda_3 = \\lambda_{\\min} = \\frac{1.3}{5.3}$\nThe corresponding eigenvectors (principal directions of fabric) are:\n$\\boldsymbol{v}_1 = (1, 0, 0)^T$\n$\\boldsymbol{v}_2 = (0, 1, 0)^T$\n$\\boldsymbol{v}_3 = (0, 0, 1)^T$\n\nNow we compute the anisotropy index $a$:\n$$\na = \\frac{\\lambda_{\\max}-\\lambda_{\\min}}{\\lambda_{\\max}+\\lambda_{\\min}} = \\frac{\\frac{2.3}{5.3} - \\frac{1.3}{5.3}}{\\frac{2.3}{5.3} + \\frac{1.3}{5.3}} = \\frac{2.3 - 1.3}{2.3 + 1.3} = \\frac{1.0}{3.6} = \\frac{1}{3.6}\n$$\nCalculating the numerical value and rounding to four significant figures:\n$a = \\frac{1}{3.6} = 0.27777... \\approx 0.2778$.\n\nThe physical meaning of these quantities in computational micromechanics is as follows:\nThe fabric tensor $F_{ij}$ quantifies the anisotropy of the granular assembly's geometric structure. Its components describe the predominant orientation of contacts. An isotropic material, with no preferential contact orientation, would have $F_{ij} = \\frac{1}{3}\\delta_{ij}$. The computed tensor is clearly anisotropic since $F_{11}  F_{22}  F_{33}$.\nThe principal directions of $F_{ij}$ (its eigenvectors) are the axes along which the geometric structure is extremal. The corresponding eigenvalues represent the statistical weight of contacts oriented along these principal directions. In this problem, the largest eigenvalue $\\lambda_{\\max} = \\lambda_1$ corresponds to the $x_1$-direction, indicating this is the direction of strongest geometric fabric. This is consistent with the input data, where the contacts aligned with the $x_1$-direction have the largest total branch length weighting.\nThe anisotropy index $a$ is a scalar measure that condenses the degree of fabric anisotropy into a single number, ranging from $0$ for an isotropic fabric ($\\lambda_{\\max} = \\lambda_{\\min}$) to $1$ for a purely one-dimensional fabric (e.g., all contacts aligned in one direction). The calculated value $a \\approx 0.2778$ signifies a moderate degree of structural anisotropy.\nThe use of periodic boundary conditions is critical for ensuring that the small RVE is statistically representative of a larger (theoretically infinite) granular medium, by eliminating confounding surface effects. The branch vectors are defined using the minimum image convention, which correctly captures the nearest-neighbor distances in this periodic space. Weighting by branch length $|\\boldsymbol{\\ell}^{(c)}|$ emphasizes the contribution of contacts that span larger distances, thus providing a measure sensitive to the overall spatial arrangement and not just the number of contacts in a given orientation. This specific choice of weighting makes the fabric tensor a descriptor of the structural skeleton of the granular packing.",
            "answer": "$$\\boxed{0.2778}$$"
        },
        {
            "introduction": "The central goal of computational micromechanics is to bridge the gap between discrete particle interactions and continuum-level quantities like stress. This practice challenges you to compute the macroscopic Cauchy stress tensor using two fundamental approaches: the microscopic Love-Weber formula and the macroscopic boundary reaction method. By implementing and comparing these methods for different boundary conditions, you will gain a deeper appreciation for the principles of homogenization and the subtle yet critical role of the Representative Volume Element (RVE) in ensuring consistency between scales .",
            "id": "3507321",
            "problem": "You are given a two-dimensional discrete assembly representing a Representative Volume Element (RVE) of frictional, linearly elastic granular contacts. The RVE is a square of side length $L_x = L_y = 1.0$ meter, occupied by four identical circular particles of radius $r = 0.12$ meter with centers initially located at $(r,r)$, $(L_x - r, r)$, $(r, L_y - r)$, and $(L_x - r, L_y - r)$. Contacts follow a linear elastic law consisting of a normal spring with stiffness $k_n = 1.0\\times 10^5$ newton per meter and a tangential spring with stiffness $k_t = 5.0\\times 10^4$ newton per meter. The contact normal force acts only in compression; the tangential spring responds in both directions. Motion is homogeneous and defined by a deformation gradient $F$, and the small-strain assumption is used for contact kinematics. All quantities must be expressed in International System of Units (SI), and any stress must be in pascal.\n\nFundamental base:\n- Newton’s Second Law and balance of linear momentum.\n- The definition of Cauchy stress as average traction transmitted across the RVE boundary.\n- The Love–Weber virial expression for stress in discrete systems, which aggregates contact forces and branch vectors.\n- Linear elastic contact laws consistent with small relative kinematics induced by homogeneous deformation.\n\nModeling assumptions:\n1. Under homogeneous deformation given by $F$, any branch vector $l_0$ between two interacting points (particle–particle or particle–wall contact) maps to $l' = F \\, l_0$. The relative displacement is $\\Delta = l' - l_0$.\n2. For each contact, let $n_0 = l_0/\\|l_0\\|$ be the initial contact normal direction, and decompose $\\Delta$ as $\\Delta_n = (n_0 \\cdot \\Delta)$ and $\\Delta_t = \\Delta - \\Delta_n n_0$.\n3. The unilateral normal contact law is $f_n = k_n \\max(0, -\\Delta_n)$ along $n_0$, and the tangential elastic law is $f_t = k_t \\Delta_t$, giving the contact force $f = f_n n_0 + f_t$.\n4. For periodic boundaries, interacting particle pairs include those crossing the domain boundary by minimum-image convention in each coordinate; branch vectors $l_0$ are the minimum-image differences.\n5. For servo-controlled boundaries, the boundary kinematics are homogeneous, and particle–wall contacts are defined by initial branch vectors of magnitude $r$ along the wall normals, which map by $F$ and follow the same linear laws. Reaction forces are obtained by summing the opposite of particle–wall contact forces on each wall.\n\nRequired computations:\n- Compute the macroscopic Cauchy stress tensor $\\sigma_{ij}$ by two methods:\n  a) Love–Weber approach: $\\sigma_{ij}$ is obtained by RVE averaging of dyadic products of contact forces and branch vectors. Use the current branch vector $l'$ and the contact force $f$ induced by $\\Delta$.\n  b) Reaction approach for servo-controlled boundaries: $\\sigma_{ij}$ is obtained from wall reaction forces by averaging tractions on opposite faces. For the vertical faces with outward normals $\\pm \\hat{e}_x$, define total reaction forces $F_{\\mathrm{left}}$ and $F_{\\mathrm{right}}$ (vectors), and compute the column associated with $\\hat{e}_x$ as $\\sigma \\cdot \\hat{e}_x = \\left(F_{\\mathrm{left}} - F_{\\mathrm{right}}\\right) / \\left(2 L_y\\right)$. For the horizontal faces with outward normals $\\pm \\hat{e}_y$, define $F_{\\mathrm{bottom}}$ and $F_{\\mathrm{top}}$ and compute $\\sigma \\cdot \\hat{e}_y = \\left(F_{\\mathrm{bottom}} - F_{\\mathrm{top}}\\right) / \\left(2 L_x\\right)$.\n- For periodic boundaries, determine interacting particle pairs by the minimum-image rule and compute $\\sigma_{ij}$ using the Love–Weber approach only.\n\nContact sets to use:\n- Periodic boundaries: include particle pairs for which the minimum-image distance equals $2r$ within a tolerance of $10^{-12}$ meter in either the horizontal or vertical direction.\n- Servo-controlled boundaries: include particle–wall contacts for particles that initially touch the walls. Specifically, the particle at $(r,r)$ contacts the left and bottom walls, $(L_x - r,r)$ contacts the right and bottom walls, $(r,L_y - r)$ contacts the left and top walls, and $(L_x - r,L_y - r)$ contacts the right and top walls. Treat the wall contact branch vectors $l_0$ as $(\\pm r,0)$ for left/right and $(0,\\pm r)$ for bottom/top.\n\nHomogeneous deformation test suite:\n- Case A (simple shear): $F = \\begin{bmatrix} 1  \\gamma \\\\ 0  1 \\end{bmatrix}$ with $\\gamma = 0.02$ (dimensionless).\n- Case B (isotropic compression): $F = (1 + s) I$ with $s = -0.01$ (dimensionless).\n- Case C (no deformation): $F = I$.\n\nTasks:\n1. For each test case, compute $\\sigma_{ij}$ for the periodic boundary case by the Love–Weber method, using the periodic pair contacts and current branch vectors.\n2. For the servo-controlled boundary case, compute $\\sigma_{ij}$ by the Love–Weber method using the particle–wall contacts, and independently compute $\\sigma_{ij}$ by the reaction method using the wall reactions and the traction averaging specified above.\n3. For each test case, assess boundary-condition invariance under homogeneous deformation: return a boolean that is true if (i) the Love–Weber stress under periodic boundaries equals the Love–Weber stress under servo-controlled boundaries to within an absolute tolerance of $10^{-9}$ pascal component-wise, and (ii) the Love–Weber stress under servo boundaries equals the reaction-based stress under servo boundaries to within the same tolerance. If both conditions are met, the test case returns true; otherwise, it returns false.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `\"[resultA,resultB,resultC]\"`), where each entry is a boolean corresponding to Case A, Case B, and Case C respectively.",
            "solution": "The problem requires the computation and comparison of the Cauchy stress tensor $\\sigma$ for a two-dimensional granular assembly under three different homogeneous deformations. The stress is to be computed using three distinct methods derived from two different boundary condition (BC) models: periodic and servo-controlled. The final goal is to assess whether these methods yield identical results for each deformation case. All quantities are expressed in SI units.\n\nThe fundamental parameters are the Representative Volume Element (RVE) side lengths $L_x = L_y = 1.0$ m, particle radius $r = 0.12$ m, normal contact stiffness $k_n = 1.0 \\times 10^5$ N/m, and tangential contact stiffness $k_t = 5.0 \\times 10^4$ N/m. The RVE area is $V = L_x L_y = 1.0$ m$^2$.\n\nThe core of the calculation involves determining the contact force $f$ for a given deformation gradient $F$. For an initial branch vector $l_0$, the new branch vector is $l' = F l_0$. The relative displacement is $\\Delta = l' - l_0 = (F-I) l_0$. The initial unit normal vector is $n_0 = l_0/\\|l_0\\|$. The normal component of displacement is $\\Delta_n = \\Delta \\cdot n_0$. The tangential displacement vector is $\\Delta_t = \\Delta - \\Delta_n n_0$. The contact force is then $f = f_n n_0 + f_t$, where the normal force is $f_n = k_n \\max(0, -\\Delta_n)$ (compressive only) and the tangential force is $f_t = k_t \\Delta_t$.\n\nThe three stress tensors to be compared are:\n1.  $\\sigma_{\\text{periodic, LW}}$: Love-Weber stress for the periodic BC case.\n2.  $\\sigma_{\\text{servo, LW}}$: Love-Weber stress for the servo-controlled BC case.\n3.  $\\sigma_{\\text{servo, reaction}}$: Stress computed from wall reactions for the servo-controlled BC case.\n\nThe Love-Weber stress is given by $\\sigma_{LW} = \\frac{1}{V} \\sum_{c} f^{(c)} \\otimes l'^{(c)}$, where the sum is over all contacts $c$. The reaction stress is computed from the total forces exerted by the walls on the particles ($F_{\\text{left}}, F_{\\text{right}}, F_{\\text{bottom}}, F_{\\text{top}}$) as $\\sigma \\cdot \\hat{e}_x = (F_{\\text{left}} - F_{\\text{right}}) / (2 L_y)$ and $\\sigma \\cdot \\hat{e}_y = (F_{\\text{bottom}} - F_{\\text{top}}) / (2 L_x)$.\n\nThe initial contact configuration for each BC model must be established.\nFor periodic BCs, the four particles form a square lattice. The minimum-image distance between adjacent particles in the horizontal and vertical directions is $2r = 0.24$ m. This results in four active contacts: two horizontal and two vertical. Taking the convention of branch vectors pointing from a lower-indexed particle to a higher-indexed one (with periodic wrapping), the initial branch vectors are:\n$l_{0,\\text{p}}^{(1,2)} = (-0.24, 0)$ m and $l_{0,\\text{p}}^{(3,4)} = (0, -0.24)$ m, each appearing twice.\n\nFor servo-controlled BCs, each of the four corner particles touches two walls. This results in eight particle-wall contacts. The branch vectors point from the wall to the particle center and have a magnitude of $r = 0.12$ m. The set of initial branch vectors is:\n$l_{0,\\text{s}}$: two contacts with $(0.12, 0)$, two with $(-0.12, 0)$, two with $(0, 0.12)$, and two with $(0, -0.12)$.\n\nWe now analyze each deformation case.\n\n**Case A: Simple Shear**\n\nThe deformation gradient is $F = \\begin{bmatrix} 1  \\gamma \\\\ 0  1 \\end{bmatrix}$ with $\\gamma = 0.02$. Thus, $F-I = \\begin{bmatrix} 0  0.02 \\\\ 0  0 \\end{bmatrix}$.\n\n1.  **Periodic BC, Love-Weber Stress ($\\sigma_{\\text{p,LW}}$):**\n    For horizontal contacts $l_{0} = (\\pm 0.24, 0)$, $\\Delta = (F-I)l_0 = (0, 0)$. The force is zero.\n    For vertical contacts $l_{0} = (0, \\pm 0.24)$, $\\Delta = (F-I)l_0 = ( \\mp (0.02)(0.24), 0) = (\\mp 0.0048, 0)$.\n    Taking $l_{0}=(0, -0.24)$, $n_0 = (0, -1)$. $\\Delta = (-0.0048, 0)$, so $\\Delta_n = \\Delta \\cdot n_0 = 0$. The normal force is zero.\n    The tangential displacement is $\\Delta_t = \\Delta = (-0.0048, 0)$.\n    The tangential force is $f_t = k_t \\Delta_t = (5 \\times 10^4) (-0.0048, 0) = (-240, 0)$ N. So, $f = (-240, 0)$ N.\n    The current branch vector is $l' = F l_0 = (-0.0048, -0.24)$ m.\n    The dyadic product is $f \\otimes l' = \\begin{pmatrix} -240 \\\\ 0 \\end{pmatrix} \\otimes (-0.0048, -0.24) = \\begin{bmatrix} 1.152  57.6 \\\\ 0  0 \\end{bmatrix}$ Pa$\\cdot$m$^2$.\n    There are two such vertical contacts. The total stress is $\\sigma_{\\text{p,LW}} = \\frac{2}{1.0} \\begin{bmatrix} 1.152  57.6 \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 2.304  115.2 \\\\ 0  0 \\end{bmatrix}$ Pa.\n\n2.  **Servo BC, Love-Weber Stress ($\\sigma_{\\text{s,LW}}$):**\n    For horizontal contacts $l_{0} = (\\pm 0.12, 0)$, $\\Delta = (0, 0)$ and $f=0$.\n    For vertical contacts $l_{0} = (0, \\pm 0.12)$, $\\Delta = (\\mp (0.02)(0.12), 0) = (\\mp 0.0024, 0)$. $\\Delta_n=0$, so $f_n=0$.\n    $f_t = k_t \\Delta_t = \\pm (5 \\times 10^4)(-0.0024, 0) = \\mp (120, 0)$ N.\n    For $l_0 = (0, -0.12)$, $f = (-120, 0)$ N and $l' = (-0.0024, -0.12)$ m. The dyad is $f \\otimes l' = \\begin{bmatrix} 0.288  14.4 \\\\ 0  0 \\end{bmatrix}$.\n    For $l_0 = (0, 0.12)$, $f = (120, 0)$ N and $l' = (0.0024, 0.12)$ m. The dyad is $f \\otimes l' = \\begin{bmatrix} 0.288  14.4 \\\\ 0  0 \\end{bmatrix}$.\n    There are two of each type of vertical contact. The total stress is $\\sigma_{\\text{s,LW}} = \\frac{1}{1.0} (2+2) \\begin{bmatrix} 0.288  14.4 \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 1.152  57.6 \\\\ 0  0 \\end{bmatrix}$ Pa.\n\n3.  **Servo BC, Reaction Stress ($\\sigma_{\\text{s,react}}$):**\n    The horizontal wall contacts have zero force. $F_{\\text{left}} = F_{\\text{right}} = (0,0)$.\n    The two bottom wall contacts ($l_0 = (0,0.12)$) each have force $f=(120, 0)$ N. $F_{\\text{bottom}} = (240, 0)$ N.\n    The two top wall contacts ($l_0 = (0,-0.12)$) each have force $f=(-120, 0)$ N. $F_{\\text{top}} = (-240, 0)$ N.\n    $\\sigma \\cdot \\hat{e}_x = (F_{\\text{left}} - F_{\\text{right}}) / 2 = (0,0)$, so $\\sigma_{xx} = \\sigma_{yx} = 0$.\n    $\\sigma \\cdot \\hat{e}_y = (F_{\\text{bottom}} - F_{\\text{top}}) / 2 = ((240,0) - (-240,0))/2 = (240, 0)$, so $\\sigma_{xy}=240$, $\\sigma_{yy}=0$.\n    $\\sigma_{\\text{s,react}} = \\begin{bmatrix} 0  240 \\\\ 0  0 \\end{bmatrix}$ Pa.\n\nThe three stress tensors are not equal. Thus, the condition for Case A is **false**.\n\n**Case B: Isotropic Compression**\n\nThe deformation is $F = (1+s)I = 0.99 I$ with $s = -0.01$. Thus, $F-I = -0.01 I$.\n\n1.  **Periodic BC, Love-Weber Stress ($\\sigma_{\\text{p,LW}}$):**\n    For horizontal contacts $l_{0} = (-0.24, 0)$, $\\Delta = (-0.01)l_0 = (0.0024, 0)$. $n_0=(-1,0)$, so $\\Delta_n = -0.0024$. $\\Delta_t=0$.\n    $f_n = k_n(-\\Delta_n) = (10^5)(0.0024) = 240$ N. $f=f_n n_0 = (-240, 0)$ N.\n    $l' = 0.99 l_0 = (-0.2376, 0)$ m.\n    $f \\otimes l' = \\begin{pmatrix} -240 \\\\ 0 \\end{pmatrix} \\otimes (-0.2376, 0) = \\begin{bmatrix} 57.024  0 \\\\ 0  0 \\end{bmatrix}$.\n    For vertical contacts $l_{0} = (0, -0.24)$, similarly, $f=(0, -240)$ N, $l'=(0, -0.2376)$ m.\n    $f \\otimes l' = \\begin{bmatrix} 0  0 \\\\ 0  57.024 \\end{bmatrix}$.\n    With two contacts of each type, $\\sigma_{\\text{p,LW}} = \\frac{2}{1.0} (\\begin{bmatrix} 57.024  0 \\\\ 0  0 \\end{bmatrix} + \\begin{bmatrix} 0  0 \\\\ 0  57.024 \\end{bmatrix}) = \\begin{bmatrix} 114.048  0 \\\\ 0  114.048 \\end{bmatrix}$ Pa.\n\n2.  **Servo BC, Love-Weber Stress ($\\sigma_{\\text{s,LW}}$):**\n    For $l_0 = (0.12, 0)$, $\\Delta = (-0.0012, 0)$, $\\Delta_n = -0.0012$, $f_n=120$ N, $f=(120,0)$ N. $l'=(0.1188, 0)$ m.\n    $f \\otimes l' = \\begin{bmatrix} 14.256  0 \\\\ 0  0 \\end{bmatrix}$.\n    By symmetry, all four horizontal contacts contribute this dyad.\n    All four vertical contacts contribute $\\begin{bmatrix} 0  0 \\\\ 0  14.256 \\end{bmatrix}$.\n    Total stress $\\sigma_{\\text{s,LW}} = \\frac{4}{1.0}(\\begin{bmatrix} 14.256  0 \\\\ 0  0 \\end{bmatrix} + \\begin{bmatrix} 0  0 \\\\ 0  14.256 \\end{bmatrix}) = \\begin{bmatrix} 57.024  0 \\\\ 0  57.024 \\end{bmatrix}$ Pa.\n\n3.  **Servo BC, Reaction Stress ($\\sigma_{\\text{s,react}}$):**\n    Left walls: two contacts with $f=(120,0)$ N, so $F_{\\text{left}}=(240,0)$ N.\n    Right walls: two contacts with $f=(-120,0)$ N, so $F_{\\text{right}}=(-240,0)$ N.\n    Bottom walls: two contacts with $f=(0,120)$ N, so $F_{\\text{bottom}}=(0,240)$ N.\n    Top walls: two contacts with $f=(0,-120)$ N, so $F_{\\text{top}}=(0,-240)$ N.\n    $\\sigma \\cdot \\hat{e}_x = ((240,0) - (-240,0))/2 = (240,0)$.\n    $\\sigma \\cdot \\hat{e}_y = ((0,240) - (0,-240))/2 = (0,240)$.\n    $\\sigma_{\\text{s,react}} = \\begin{bmatrix} 240  0 \\\\ 0  240 \\end{bmatrix}$ Pa.\n\nThe three stress tensors are not equal. Thus, the condition for Case B is **false**.\n\n**Case C: No Deformation**\n\nThe deformation is $F = I$. Thus, $F-I = 0$ and $\\Delta=0$ for all contacts.\nThis immediately implies that all contact forces are zero, $f=0$.\nConsequently, all three stress tensors are the zero tensor:\n$\\sigma_{\\text{p,LW}} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$ Pa.\n$\\sigma_{\\text{s,LW}} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$ Pa.\n$\\sigma_{\\text{s,react}} = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$ Pa.\nSince all three tensors are identical, the condition is satisfied. The result for Case C is **true**.\n\nThe discrepancy in stress values for Cases A and B highlights that the equivalence between microscopic (Love-Weber) and macroscopic (boundary traction) stress definitions, and invariance to boundary conditions, depends on specific assumptions regarding the RVE and the boundary kinematics that are not all met by the definitions provided in this idealized problem.\n\nFinal Assessment:\n- Case A: false\n- Case B: false\n- Case C: true",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes stresses for a granular assembly under different deformation cases\n    and boundary conditions, then assesses their equivalence.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    Lx, Ly = 1.0, 1.0\n    V = Lx * Ly\n    r = 0.12\n    kn = 1.0e5\n    kt = 5.0e4\n    tol = 1.0e-9\n\n    # --- Deformation Gradients for Test Cases ---\n    F_A = np.array([[1.0, 0.02], [0.0, 1.0]])\n    F_B = np.array([[0.99, 0.0], [0.0, 0.99]])\n    F_C = np.array([[1.0, 0.0], [0.0, 1.0]])\n    test_cases = [F_A, F_B, F_C]\n    \n    # --- Contact Definitions ---\n    # Periodic BCs: Branch vectors determined by minimum image convention.\n    # The setup results in four contacts of length 2r=0.24m.\n    # Two horizontal contacts arise from particle pairs (1,2) and (3,4).\n    # Two vertical contacts arise from particle pairs (1,3) and (2,4).\n    l0_list_periodic = [\n        np.array([-2.0 * r, 0.0]),  # Horizontal contact\n        np.array([-2.0 * r, 0.0]),  # Horizontal contact\n        np.array([0.0, -2.0 * r]),  # Vertical contact\n        np.array([0.0, -2.0 * r])   # Vertical contact\n    ]\n\n    # Servo-controlled BCs: Branch vectors from wall to particle center.\n    # Each of the 4 particles has 2 wall contacts, for a total of 8.\n    l0_list_servo = [\n        # Particle 1 at (r,r)\n        (np.array([r, 0.0]), 'left'),    \n        (np.array([0.0, r]), 'bottom'),\n        # Particle 2 at (Lx-r, r)\n        (np.array([-r, 0.0]), 'right'),\n        (np.array([0.0, r]), 'bottom'),\n        # Particle 3 at (r, Ly-r)\n        (np.array([r, 0.0]), 'left'),\n        (np.array([0.0, -r]), 'top'),\n        # Particle 4 at (Lx-r, Ly-r)\n        (np.array([-r, 0.0]), 'right'),\n        (np.array([0.0, -r]), 'top')\n    ]\n\n    # --- Helper Functions ---\n    def calculate_force(l0, F, kn_val, kt_val):\n        \"\"\"Calculates contact force based on displacement.\"\"\"\n        l0_norm = np.linalg.norm(l0)\n        if l0_norm == 0:\n            return np.zeros(2)\n        \n        I = np.identity(2)\n        delta = (F - I) @ l0\n        \n        n0 = l0 / l0_norm\n        delta_n_scalar = np.dot(delta, n0)\n        \n        # Normal force (compressive only)\n        fn_scalar = kn_val * max(0.0, -delta_n_scalar)\n        fn_vec = fn_scalar * n0\n        \n        # Tangential force\n        delta_t_vec = delta - delta_n_scalar * n0\n        ft_vec = kt_val * delta_t_vec\n        \n        return fn_vec + ft_vec\n\n    def calculate_love_weber_stress(l0_list, F, kn_val, kt_val, V_val):\n        \"\"\"Calculates Love-Weber stress tensor for a list of contacts.\"\"\"\n        sigma_lw = np.zeros((2, 2))\n        for l0 in l0_list:\n            f = calculate_force(l0, F, kn_val, kt_val)\n            l_prime = F @ l0\n            sigma_lw += np.outer(f, l_prime)\n        return sigma_lw / V_val\n\n    def calculate_servo_stresses(l0_list_s, F, kn_val, kt_val, V_val, Lx_val, Ly_val):\n        \"\"\"Calculates both Love-Weber and Reaction stresses for servo BCs.\"\"\"\n        sigma_lw = np.zeros((2, 2))\n        wall_forces = {\n            'left': np.zeros(2), 'right': np.zeros(2),\n            'bottom': np.zeros(2), 'top': np.zeros(2)\n        }\n        \n        for l0, wall_id in l0_list_s:\n            f = calculate_force(l0, F, kn_val, kt_val)\n            l_prime = F @ l0\n            sigma_lw += np.outer(f, l_prime)\n            wall_forces[wall_id] += f\n        \n        sigma_lw /= V_val\n\n        # Reaction stress calculation\n        sigma_react = np.zeros((2, 2))\n        col1 = (wall_forces['left'] - wall_forces['right']) / (2.0 * Ly_val)\n        col2 = (wall_forces['bottom'] - wall_forces['top']) / (2.0 * Lx_val)\n        sigma_react[:, 0] = col1\n        sigma_react[:, 1] = col2\n\n        return sigma_lw, sigma_react\n\n    results = []\n    for F_matrix in test_cases:\n        # 1. Periodic BCs - Love-Weber\n        sigma_p_lw = calculate_love_weber_stress(l0_list_periodic, F_matrix, kn, kt, V)\n\n        # 2. Servo BCs - Love-Weber and Reaction\n        sigma_s_lw, sigma_s_react = calculate_servo_stresses(l0_list_servo, F_matrix, kn, kt, V, Lx, Ly)\n        \n        # 3. Assessment\n        # Condition (i): periodic LW vs servo LW\n        cond1 = np.allclose(sigma_p_lw, sigma_s_lw, atol=tol, rtol=0)\n        # Condition (ii): servo LW vs servo reaction\n        cond2 = np.allclose(sigma_s_lw, sigma_s_react, atol=tol, rtol=0)\n        \n        results.append(cond1 and cond2)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A powerful feature of micromechanical modeling is the ability to test and validate the physical assumptions made at the particle scale. This advanced practice introduces a Bayesian framework for model selection, a rigorous statistical method for using macroscopic experimental data to determine which underlying contact law (e.g., linear vs. Hertzian) provides a better explanation for the observed behavior. This exercise demonstrates a modern, data-driven approach to connecting macro-scale measurements back to the fundamental physics governing granular interactions .",
            "id": "3507353",
            "problem": "Consider a cohesionless granular material idealized as a random, isotropic packing of identical spherical particles with radius $R$, effective Young's modulus $E^{*}$, and average coordination number $z$. At small strains under isotropic confining pressure $p$ and negligible frictional sliding, the macroscopic shear modulus $G$ scales with the effective normal contact stiffness $k_{n}$ through effective medium arguments grounded in Newton's laws of motion and the contact force-displacement relations. For an average contact normal force $F_{n}$ arising from the applied pressure $p$, two competing micromechanical contact laws are considered:\n\n- Linear contact law: $F_{n} = k_{n} \\delta$, implying $k_{n}$ is independent of $F_{n}$ and pressure $p$; upscaling gives a pressure-independent $G$, modeled as $G(p; A, \\alpha=0) = A p^{0}$, where $A$ is a positive prefactor aggregating microstructural constants such as $z$, $R$, and $E^{*}$.\n- Hertz (Hertz-Mindlin) contact law: $F_{n} = c \\delta^{3/2}$ with $c$ depending on $E^{*}$ and $R$, implying $k_{n} = \\frac{dF_{n}}{d\\delta} \\propto \\delta^{1/2} \\propto F_{n}^{1/3}$; because the average $F_{n}$ is proportional to $p$, upscaling yields $G \\propto p^{1/3}$, modeled as $G(p; A, \\alpha=1/3) = A p^{1/3}$, where $A$ is a positive prefactor.\n\nAssume the following data model for macroscopic measurements: given pressures $\\{p_{i}\\}_{i=1}^{N}$ and measured shear moduli $\\{G_{i}\\}_{i=1}^{N}$, the data likelihood for a contact-law model $\\mathcal{M}$ with exponent $\\alpha \\in \\{0, 1/3\\}$ and prefactor parameter $A > 0$ is\n$$\np(\\mathcal{D} \\mid A, \\mathcal{M}) = \\prod_{i=1}^{N} \\mathcal{N}\\!\\left(G_{i} \\mid A p_{i}^{\\alpha}, \\sigma^{2}\\right),\n$$\nwhere $\\mathcal{N}(\\cdot \\mid \\mu, \\sigma^{2})$ denotes the Gaussian (Normal) density with mean $\\mu$ and variance $\\sigma^{2}$, and $\\sigma  0$ is a known measurement standard deviation common to all $i$ in a given test case. Let the prior for $A$ be Log-Normal with parameters $(\\mu_{A}, \\sigma_{A})$, namely\n$$\np(A \\mid \\mathcal{M}) = \\frac{1}{A \\, \\sigma_{A} \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(\\ln A - \\mu_{A})^{2}}{2 \\sigma_{A}^{2}} \\right), \\quad A  0.\n$$\nThe Bayesian model evidence (marginal likelihood) for model $\\mathcal{M}$ is\n$$\n\\mathcal{Z}(\\mathcal{M}) = \\int_{0}^{\\infty} p(\\mathcal{D} \\mid A, \\mathcal{M}) \\, p(A \\mid \\mathcal{M}) \\, dA.\n$$\nUsing the transformation $y = \\ln A$, this integral may be computed as\n$$\n\\mathcal{Z}(\\mathcal{M}) = \\int_{-\\infty}^{\\infty} \\left[ \\prod_{i=1}^{N} \\mathcal{N}\\!\\left(G_{i} \\mid e^{y} p_{i}^{\\alpha}, \\sigma^{2}\\right) \\right] \\, \\mathcal{N}\\!\\left(y \\mid \\mu_{A}, \\sigma_{A}^{2}\\right) \\, dy.\n$$\n\nYour task is to write a complete, runnable program that, for each test case below, computes the evidences $\\mathcal{Z}$ for the linear model with $\\alpha = 0$ and the Hertz model with $\\alpha = 1/3$, compares them, and outputs the selected model per test case as an integer: output $0$ if the linear model has greater or equal evidence, and $1$ if the Hertz model has greater evidence. All physical quantities must be treated in Pascals (Pa). No angles are involved. The numerical prior parameters should be set to $\\mu_{A} = \\ln(10^{6})$ and $\\sigma_{A} = 2$, which represents a broad prior over plausible prefactor magnitudes. The Gaussian likelihood must use the provided $\\sigma$ per test case.\n\nThe program must evaluate the integral for $\\mathcal{Z}$ numerically in the transformed variable $y = \\ln A$ using one-dimensional quadrature over a finite interval that captures effectively all prior mass (for example, a symmetric interval around $\\mu_{A}$ spanning many standard deviations). To ensure numerical robustness, implement the integrand in log-space and exponentiate only at the point of integration.\n\nTest Suite:\n- Case $1$ (expected Hertz-like scaling): $p = [10^{5}, 2 \\cdot 10^{5}, 5 \\cdot 10^{5}]$ Pa, $G = [2.80 \\cdot 10^{6}, 3.45 \\cdot 10^{6}, 4.70 \\cdot 10^{6}]$ Pa, $\\sigma = 1.5 \\cdot 10^{5}$ Pa.\n- Case $2$ (expected linear-like scaling): $p = [10^{5}, 2 \\cdot 10^{5}, 5 \\cdot 10^{5}]$ Pa, $G = [3.25 \\cdot 10^{6}, 3.15 \\cdot 10^{6}, 3.28 \\cdot 10^{6}]$ Pa, $\\sigma = 1.2 \\cdot 10^{5}$ Pa.\n- Case $3$ (strong Hertz-like scaling across a wider pressure span): $p = [10^{5}, 10^{6}, 5 \\cdot 10^{6}]$ Pa, $G = [2.30 \\cdot 10^{6}, 5.05 \\cdot 10^{6}, 8.60 \\cdot 10^{6}]$ Pa, $\\sigma = 5.0 \\cdot 10^{4}$ Pa.\n- Case $4$ (ambiguous due to high noise, near-constant moduli): $p = [10^{5}, 2 \\cdot 10^{5}, 5 \\cdot 10^{5}]$ Pa, $G = [3.00 \\cdot 10^{6}, 3.00 \\cdot 10^{6}, 3.00 \\cdot 10^{6}]$ Pa, $\\sigma = 5.0 \\cdot 10^{5}$ Pa.\n\nFinal Output Format:\nYour program should produce a single line of output containing the model selections for the four test cases as a comma-separated list of integers enclosed in square brackets (e.g., `\"[0,1,1,0]\"`). The integers must be in the order of the test cases listed above.\n\nAll calculations must be performed in the International System of Units (SI) with pressures and moduli in Pascals (Pa). The final selections must be integers as specified, with no additional text or formatting beyond the required single-line output.",
            "solution": "The fundamental base is Newton's second law, $m \\, d^{2}\\mathbf{x}/dt^{2} = \\sum \\mathbf{F}$, applied at the grain scale, along with the contact force-displacement relations between spherical particles. For small quasi-static strains, inertia is negligible, and the macroscopic stress arises from ensemble-averaged static contact forces and fabric. In an isotropic random packing, the macroscopic shear modulus $G$ scales with the average normal contact stiffness $k_{n}$ multiplied by geometric factors dependent on coordination number $z$, particle radius $R$, and packing fraction. This follows from standard homogenization arguments where the macroscopic stress-strain relation is derived from summing contact contributions and linearizing small increments.\n\nFor the linear contact law, the normal force-displacement relation is $F_{n} = k_{n} \\delta$, where $\\delta$ is the normal overlap. Under small strain increments, $k_{n}$ is constant and independent of $F_{n}$, leading to a macroscopic $G$ that is approximately constant with confining pressure $p$. We parameterize this constant as a positive prefactor $A$ and write $G(p; A, \\alpha=0) = A p^{0} = A$.\n\nFor the Hertz (Hertz-Mindlin) contact law, the normal force-displacement relation between two spheres of equal radius $R$ and effective modulus $E^{*}$ is $F_{n} = \\frac{4}{3} E^{*} \\sqrt{R} \\, \\delta^{3/2}$. The incremental stiffness is $k_{n} = dF_{n}/d\\delta = 2 E^{*} \\sqrt{R} \\, \\delta^{1/2}$. The mean contact force $F_{n}$ scales with the confining pressure $p$ because the average contact force balances the macroscopic stress over the contact network. Solving $F_{n} \\propto \\delta^{3/2}$ for $\\delta$ gives $\\delta \\propto F_{n}^{2/3}$, hence $k_{n} \\propto \\delta^{1/2} \\propto F_{n}^{1/3} \\propto p^{1/3}$. Therefore the macroscopic shear modulus scales as $G \\propto k_{n} \\propto p^{1/3}$, which we model as $G(p; A, \\alpha=1/3) = A p^{1/3}$, where $A  0$ aggregates the microstructural prefactors.\n\nWe treat measurements $\\{(p_{i}, G_{i})\\}_{i=1}^{N}$ as Gaussian around the model prediction with standard deviation $\\sigma$ shared within a test case:\n$$\np(\\mathcal{D} \\mid A, \\mathcal{M}) = \\prod_{i=1}^{N} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{\\left(G_{i} - A p_{i}^{\\alpha}\\right)^{2}}{2 \\sigma^{2}} \\right).\n$$\nWe place a Log-Normal prior on $A$,\n$$\np(A \\mid \\mathcal{M}) = \\frac{1}{A \\, \\sigma_{A} \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(\\ln A - \\mu_{A})^{2}}{2 \\sigma_{A}^{2}} \\right), \\quad A  0,\n$$\nwith $\\mu_{A} = \\ln(10^{6})$ and $\\sigma_{A} = 2$, a broad choice that weakly informs the scale while respecting positivity.\n\nThe Bayesian evidence is\n$$\n\\mathcal{Z}(\\mathcal{M}) = \\int_{0}^{\\infty} p(\\mathcal{D} \\mid A, \\mathcal{M}) \\, p(A \\mid \\mathcal{M}) \\, dA.\n$$\nChanging variables to $y = \\ln A$ simplifies the integral because $dA = e^{y} dy$ and the Log-Normal's $1/A$ factor cancels:\n$$\n\\mathcal{Z}(\\mathcal{M}) = \\int_{-\\infty}^{\\infty} \\left[ \\prod_{i=1}^{N} \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{\\left(G_{i} - e^{y} p_{i}^{\\alpha}\\right)^{2}}{2 \\sigma^{2}} \\right) \\right] \\frac{1}{\\sigma_{A} \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(y - \\mu_{A})^{2}}{2 \\sigma_{A}^{2}} \\right) \\, dy.\n$$\nDefine the log-integrand\n$$\n\\ell(y) = -\\sum_{i=1}^{N} \\frac{\\left(G_{i} - e^{y} p_{i}^{\\alpha}\\right)^{2}}{2 \\sigma^{2}} - N \\ln\\!\\left(\\sigma \\sqrt{2\\pi}\\right) - \\frac{(y - \\mu_{A})^{2}}{2 \\sigma_{A}^{2}} - \\ln\\!\\left(\\sigma_{A} \\sqrt{2\\pi}\\right).\n$$\nThen the integrand is $I(y) = \\exp(\\ell(y))$, and the evidence is $\\mathcal{Z}(\\mathcal{M}) = \\int_{-\\infty}^{\\infty} I(y) \\, dy$. Numerically, we truncate the integral to $y \\in [\\mu_{A} - L \\sigma_{A}, \\mu_{A} + L \\sigma_{A}]$ with $L$ large (for instance $L = 10$), which captures essentially all prior mass. One-dimensional quadrature (such as adaptive Gauss-Kronrod) can then be applied. To avoid underflow and preserve stability, we compute $\\ell(y)$ in log-space and exponentiate to obtain $I(y)$ inside the integrator.\n\nFor each test case, we compute $\\mathcal{Z}(\\alpha=0)$ for the linear model and $\\mathcal{Z}(\\alpha=1/3)$ for the Hertz model, then select the model with the larger evidence. Because of the broad prior, the comparison is predominantly driven by how well each scaling explains the data across the provided pressures, properly penalized by parameter uncertainty as encoded through the integral.\n\nAlgorithmic steps implemented in the program:\n- Encode the test cases with pressure vector $\\mathbf{p}$ and modulus observations $\\mathbf{G}$ in Pascals, and the scalar noise $\\sigma$ in Pascals.\n- For a given model exponent $\\alpha$, define the log-integrand $\\ell(y)$ using the expressions above, and compute $I(y) = \\exp(\\ell(y))$.\n- Integrate $I(y)$ over $y \\in [\\mu_{A} - 10 \\sigma_{A}, \\mu_{A} + 10 \\sigma_{A}]$ using adaptive quadrature to obtain $\\mathcal{Z}$.\n- Compare $\\mathcal{Z}$ between $\\alpha = 0$ and $\\alpha = 1/3$; output $0$ if the linear model's evidence is greater or equal, otherwise output $1$.\n- Aggregate the outputs for the four test cases into a single line formatted as a comma-separated list in square brackets.\n\nScientific realism is ensured by grounding the macroscopic modulus scaling in contact mechanics and effective medium reasoning, applying a noise model consistent with experimental measurements, and using a prior that is physically meaningful (positivity and broad plausibility). The test suite provides coverage: expected Hertz-like scaling (Case $1$), expected linear-like scaling (Case $2$), strong Hertz-like scaling across a wide pressure range (Case $3$), and an ambiguous high-noise scenario (Case $4$). The final outputs are integers per the required specification, and all quantities are handled in Pascals (Pa) as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef evidence(p, G, sigma, alpha, mu_prior, sigma_prior):\n    \"\"\"\n    Compute the Bayesian evidence Z for model exponent alpha\n    with Log-Normal prior on A using integration over y = ln A.\n    \"\"\"\n    p = np.asarray(p, dtype=float)\n    G = np.asarray(G, dtype=float)\n    n = G.size\n\n    # Define log-integrand ell(y)\n    def log_integrand(y):\n        A = np.exp(y)\n        residuals = G - A * (p ** alpha)\n        # Log-likelihood\n        ll = -0.5 * np.sum((residuals / sigma) ** 2) - n * np.log(sigma * np.sqrt(2.0 * np.pi))\n        # Log-prior in y-space: Normal(y | mu_prior, sigma_prior^2)\n        lp = -0.5 * ((y - mu_prior) ** 2) / (sigma_prior ** 2) - np.log(sigma_prior * np.sqrt(2.0 * np.pi))\n        return ll + lp\n\n    def integrand(y):\n        return np.exp(log_integrand(y))\n\n    # Integrate over a wide interval capturing prior mass\n    y_min = mu_prior - 10.0 * sigma_prior\n    y_max = mu_prior + 10.0 * sigma_prior\n\n    val, err = quad(integrand, y_min, y_max, epsabs=1e-12, epsrel=1e-10, limit=200)\n    return val\n\ndef solve():\n    # Prior parameters for A (Log-Normal)\n    mu_prior = np.log(1e6)\n    sigma_prior = 2.0\n\n    # Test cases: (p_list, G_list, sigma)\n    test_cases = [\n        # Case 1: Hertz-like scaling\n        (np.array([1e5, 2e5, 5e5]), np.array([2.80e6, 3.45e6, 4.70e6]), 1.5e5),\n        # Case 2: Linear-like scaling\n        (np.array([1e5, 2e5, 5e5]), np.array([3.25e6, 3.15e6, 3.28e6]), 1.2e5),\n        # Case 3: Strong Hertz-like scaling across wider pressure span\n        (np.array([1e5, 1e6, 5e6]), np.array([2.30e6, 5.05e6, 8.60e6]), 5.0e4),\n        # Case 4: Ambiguous due to high noise\n        (np.array([1e5, 2e5, 5e5]), np.array([3.00e6, 3.00e6, 3.00e6]), 5.0e5),\n    ]\n\n    alpha_linear = 0.0\n    alpha_hertz = 1.0 / 3.0\n\n    results = []\n    for p, G, sigma in test_cases:\n        Z_linear = evidence(p, G, sigma, alpha_linear, mu_prior, sigma_prior)\n        Z_hertz = evidence(p, G, sigma, alpha_hertz, mu_prior, sigma_prior)\n        winner = 0 if Z_linear >= Z_hertz else 1\n        results.append(winner)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}