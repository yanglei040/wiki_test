{
    "hands_on_practices": [
        {
            "introduction": "To begin, we translate the abstract Karush-Kuhn-Tucker (KKT) conditions for frictional contact into a concrete calculation. This exercise demonstrates the core logic of a predictor-corrector algorithm, a cornerstone of computational plasticity, where we first assume a 'stick' state and then project the trial traction back onto the Coulomb friction cone if the slip condition is violated. This practice solidifies the geometric interpretation of stick-slip kinematics on the friction cone .",
            "id": "3537748",
            "problem": "A single integration point on a rough, frictional contact interface between an elastic body and a rigid obstacle is enforced via Lagrange multipliers. The non-penetration constraint is represented by the normal Lagrange multiplier $\\lambda_{n}$ and the no-slip/frictional constraint by the tangential Lagrange multiplier vector $\\boldsymbol{\\lambda}_{t}$, with the contact traction defined by $\\mathbf{t}_{c}=\\lambda_{n}\\mathbf{n}+\\boldsymbol{\\lambda}_{t}$, where $\\mathbf{n}$ is the unit outward normal to the obstacle. The interface obeys Coulomb friction. Use the fundamental normal and frictional cone complementarity structure as the starting point: (i) normal complementarity $g_{n}\\ge 0$, $\\lambda_{n}\\ge 0$, $g_{n}\\lambda_{n}=0$, where $g_{n}$ is the normal gap; (ii) friction cone admissibility $\\|\\boldsymbol{\\lambda}_{t}\\|\\le \\mu\\,\\lambda_{n}$ with $\\mu0$, along with the associated Karush–Kuhn–Tucker (KKT) switch between stick and slip governed by this cone.\n\nAt the end of a quasi-static increment, assume the normal contact is active with zero gap, the local orthonormal basis at the point has unit normal $\\mathbf{n}=(0,1,0)$ and tangential plane orthogonal to $\\mathbf{n}$, the friction coefficient is $\\mu=0.35$, the normal Lagrange multiplier is $\\lambda_{n}=120\\,\\mathrm{kPa}$, and the stick-predictor (trial) tangential Lagrange multiplier is $\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}=(50,\\,0,\\,70)\\,\\mathrm{kPa}$ expressed in the global basis. Starting from the above complementarity framework and without invoking any pre-stated projection formula, determine whether the point is in stick or slip, enforce the cone complementarity accordingly, and compute the corrected $\\boldsymbol{\\lambda}_{t}$ and the resulting contact traction $\\mathbf{t}_{c}$.\n\nFinally, report the magnitude $\\|\\mathbf{t}_{c}\\|$ in $\\mathrm{kPa}$. Round your answer to $4$ significant figures. Express the final result in $\\mathrm{kPa}$.",
            "solution": "The problem requires the analysis of a single contact point on a frictional interface under a quasi-static loading increment. The enforcement is based on the Lagrange multiplier method within the framework of Coulomb friction. The state of the contact point (stick or slip) must be determined, and the final contact traction must be computed. The process adheres to the Karush–Kuhn–Tucker (KKT) complementarity conditions for contact.\n\nThe givens are:\nThe unit normal vector to the obstacle's surface is $\\mathbf{n} = (0, 1, 0)$.\nThe coefficient of friction is $\\mu = 0.35$.\nThe normal Lagrange multiplier, representing the normal contact pressure, is $\\lambda_{n} = 120\\,\\mathrm{kPa}$. The problem states that normal contact is active ($g_{n}=0$) and since $\\lambda_{n} > 0$, the normal complementarity condition $g_{n}\\lambda_{n}=0$ is satisfied.\nThe stick-predictor (trial) tangential Lagrange multiplier is $\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}} = (50, 0, 70)\\,\\mathrm{kPa}$.\n\nThe core of the problem lies in the friction cone constraint, which states that for a point to be in a physically admissible state, the magnitude of the tangential traction, $\\|\\boldsymbol{\\lambda}_{t}\\|$, cannot exceed the maximum value allowed by the Coulomb friction law, which is $\\mu \\lambda_{n}$. This is expressed as:\n$$ \\|\\boldsymbol{\\lambda}_{t}\\| \\le \\mu \\lambda_{n} $$\n\nThe computational procedure for contact mechanics often employs a predictor-corrector scheme. We first assume the point sticks (the predictor step) and calculate a trial tangential traction, $\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}$. We then check if this trial state is admissible by testing it against the friction cone constraint.\n\nStep 1: Check if the point is in stick or slip.\nThe condition for sticking is $\\|\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}\\| \\le \\mu \\lambda_{n}$. If this condition is violated, the point is slipping.\n\nLet's compute the magnitude of the trial tangential Lagrange multiplier:\n$$ \\|\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}\\| = \\sqrt{50^2 + 0^2 + 70^2} = \\sqrt{2500 + 4900} = \\sqrt{7400}\\,\\mathrm{kPa} $$\nNumerically, this is approximately $\\|\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}\\| \\approx 86.023\\,\\mathrm{kPa}$.\n\nNext, we compute the maximum allowable tangential traction (the friction limit):\n$$ \\mu \\lambda_{n} = 0.35 \\times 120\\,\\mathrm{kPa} = 42\\,\\mathrm{kPa} $$\n\nNow, we compare the two values:\n$$ \\sqrt{7400}\\,\\mathrm{kPa} > 42\\,\\mathrm{kPa} $$\nSince $\\|\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}\\| > \\mu \\lambda_{n}$, the trial state is inadmissible. The assumption of sticking is incorrect, and the point must be in a state of slip.\n\nStep 2: Enforce the slip condition (the corrector step).\nFor a point in slip, the tangential traction must lie on the boundary of the friction cone. This means its magnitude must be exactly equal to the friction limit, and its direction must be opposite to the direction of relative tangential motion. In this rate-independent plasticity analogy, the direction of the corrected tangential traction $\\boldsymbol{\\lambda}_{t}$ is collinear with the trial traction $\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}$. This is known as a radial return algorithm.\n\nThe corrected tangential Lagrange multiplier $\\boldsymbol{\\lambda}_{t}$ is found by scaling the trial vector $\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}$ back to the surface of the friction cone:\n$$ \\boldsymbol{\\lambda}_{t} = (\\mu \\lambda_{n}) \\frac{\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}}{\\|\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}\\|} $$\nSubstituting the values:\n$$ \\boldsymbol{\\lambda}_{t} = 42 \\frac{(50, 0, 70)}{\\sqrt{7400}} = \\frac{42}{\\sqrt{7400}}(50, 0, 70)\\,\\mathrm{kPa} $$\nThe magnitude of this corrected vector is, by construction, $||\\boldsymbol{\\lambda}_t|| = 42\\,\\mathrm{kPa}$.\n\nStep 3: Compute the total contact traction vector $\\mathbf{t}_{c}$.\nThe total contact traction is the sum of its normal and tangential components:\n$$ \\mathbf{t}_{c} = \\lambda_{n}\\mathbf{n} + \\boldsymbol{\\lambda}_{t} $$\nSubstituting the vectors and scalars:\n$$ \\mathbf{t}_{c} = 120(0, 1, 0) + \\frac{42}{\\sqrt{7400}}(50, 0, 70) $$\n$$ \\mathbf{t}_{c} = \\left( \\frac{2100}{\\sqrt{7400}}, 120, \\frac{2940}{\\sqrt{7400}} \\right)\\,\\mathrm{kPa} $$\n\nStep 4: Compute the magnitude of the total contact traction $\\|\\mathbf{t}_{c}\\|$.\nThe magnitude of the total contact traction can be computed from its components. However, a more direct approach is to recognize that the normal component $\\lambda_{n}\\mathbf{n}$ and the tangential component $\\boldsymbol{\\lambda}_{t}$ are orthogonal.\nThe normal component vector is $\\lambda_{n}\\mathbf{n} = (0, 120, 0)$.\nThe tangential component vector $\\boldsymbol{\\lambda}_{t}$ has components only in the x-z plane, as $\\boldsymbol{\\lambda}_{t} = (\\lambda_{t,x}, 0, \\lambda_{t,z})$.\nTheir dot product is $\\lambda_{n}\\mathbf{n} \\cdot \\boldsymbol{\\lambda}_{t} = (0)( \\lambda_{t,x}) + (120)(0) + (0)(\\lambda_{t,z}) = 0$.\nSince the vectors are orthogonal, we can use the Pythagorean theorem for their vector sum:\n$$ \\|\\mathbf{t}_{c}\\|^2 = \\|\\lambda_{n}\\mathbf{n}\\|^2 + \\|\\boldsymbol{\\lambda}_{t}\\|^2 $$\nWe have:\n$\\|\\lambda_{n}\\mathbf{n}\\| = \\lambda_{n}\\|\\mathbf{n}\\| = \\lambda_{n} \\times 1 = 120\\,\\mathrm{kPa}$.\n$\\|\\boldsymbol{\\lambda}_{t}\\| = \\mu \\lambda_{n} = 42\\,\\mathrm{kPa}$ (from the slip condition).\n\nSubstituting these magnitudes into the Pythagorean relation:\n$$ \\|\\mathbf{t}_{c}\\|^2 = (120)^2 + (42)^2 = 14400 + 1764 = 16164 $$\n$$ \\|\\mathbf{t}_{c}\\| = \\sqrt{16164}\\,\\mathrm{kPa} $$\nCalculating the numerical value:\n$$ \\|\\mathbf{t}_{c}\\| \\approx 127.1377209\\,\\mathrm{kPa} $$\nThe problem requires rounding the final answer to $4$ significant figures.\n$$ \\|\\mathbf{t}_{c}\\| \\approx 127.1\\,\\mathrm{kPa} $$",
            "answer": "$$\n\\boxed{127.1}\n$$"
        },
        {
            "introduction": "Building on the kinematic rules of the friction cone, this practice delves into the theoretical foundations of the numerical algorithms themselves. You will derive the classic return-mapping algorithm from the fundamental principle of maximum dissipation, proving its equivalence to a closest-point projection, and then apply it to a numerical example. This exercise bridges the gap between physical theory and the computational routines embedded within finite element software .",
            "id": "3537768",
            "problem": "Consider a single active contact point in a three-dimensional small-deformation Finite Element Method (FEM) discretization of a deformable body pressed against a rigid obstacle. Let the normal Lagrange multiplier be denoted by $\\lambda_{n}$ (compression is positive), and let the tangential Lagrange multiplier be $\\boldsymbol{\\lambda}_{t} \\in \\mathbb{R}^{2}$ expressed in a fixed orthonormal tangent frame $\\{\\mathbf{t}_{1},\\mathbf{t}_{2}\\}$ attached to the contact surface. Coulomb friction with friction coefficient $\\mu$ is assumed, so that the admissible set for $\\boldsymbol{\\lambda}_{t}$ is the friction cone section (disc) $\\mathcal{F}=\\{\\boldsymbol{\\lambda}_{t} \\in \\mathbb{R}^{2}:\\|\\boldsymbol{\\lambda}_{t}\\| \\le \\mu \\lambda_{n},\\, \\lambda_{n} \\ge 0\\}$. The incremental tangential relative displacement at the contact point is $\\Delta \\mathbf{u}_{t} \\in \\mathbb{R}^{2}$, related to the incremental global displacement vector $\\Delta \\mathbf{u} \\in \\mathbb{R}^{6}$ of two interacting nodes $\\mathrm{P}$ and $\\mathrm{Q}$ by the kinematic mapping $\\Delta \\mathbf{u}_{t} = \\mathbf{B}_{t}\\,\\Delta \\mathbf{u}$, where the contact operator $\\mathbf{B}_{t} \\in \\mathbb{R}^{2 \\times 6}$ is known. The contact contribution to the global equilibrium residual in a primal-dual formulation is of the form $\\mathbf{B}_{t}^{T}\\boldsymbol{\\lambda}_{t}$.\n\nUsing only (i) the Coulomb friction cone $\\mathcal{F}$, (ii) the principle of maximum dissipation for rate-independent friction, and (iii) the stationarity of the incremental Lagrangian for an augmented formulation with a quadratic regularization of tangential slip controlled by a positive parameter $k_{t}$, derive from first principles a return-mapping algorithm that updates $\\boldsymbol{\\lambda}_{t}$ in a single time increment from a known previous multiplier $\\boldsymbol{\\lambda}_{t}^{n}$ and a given trial tangential slip $\\Delta \\mathbf{u}_{t}$. Your derivation must begin by formulating the appropriate constrained minimization problem for the tangential contact subproblem at fixed $\\lambda_{n}$ and show that the algorithm is equivalent to the closest-point projection of a trial multiplier $\\boldsymbol{\\lambda}_{t}^{\\mathrm{tr}}$ onto the admissible set $\\mathcal{F}$. Then, show how this updated $\\boldsymbol{\\lambda}_{t}$ couples to the global Newton system through the contact residual term $\\mathbf{B}_{t}^{T}\\boldsymbol{\\lambda}_{t}$.\n\nFinally, evaluate the derived formulas for the following specific data and provide the resulting global contact force vector $\\mathbf{B}_{t}^{T}\\boldsymbol{\\lambda}_{t}$ as your final answer. Use the global degree-of-freedom ordering $\\Delta \\mathbf{u} = \\big(u_{\\mathrm{P}x},\\,u_{\\mathrm{P}y},\\,u_{\\mathrm{P}z},\\,u_{\\mathrm{Q}x},\\,u_{\\mathrm{Q}y},\\,u_{\\mathrm{Q}z}\\big)^{T}$, and take the tangent frame aligned with the global axes so that\n$$\n\\mathbf{B}_{t}=\\begin{pmatrix}\n1  0  0  -1  0  0\\\\\n0  1  0  0  -1  0\n\\end{pmatrix}.\n$$\nAssume $\\boldsymbol{\\lambda}_{t}^{n}=\\mathbf{0}$, $\\lambda_{n}=20000\\,\\text{N}$, $\\mu=0.3$, $k_{t}=1.0\\times 10^{7}\\,\\text{N/m}$, and $\\Delta \\mathbf{u}_{t}=\\begin{pmatrix}0.0008\\\\-0.0006\\end{pmatrix}\\,\\text{m}$. Express the final answer as the $6$-component row vector for $\\mathbf{B}_{t}^{T}\\boldsymbol{\\lambda}_{t}$ in $\\text{N}$. No rounding is required; provide exact values as determined by the computation.",
            "solution": "The problem requires the derivation of a return-mapping algorithm for Coulomb friction in a small-deformation, three-dimensional Finite Element contact setting. The derivation must be based on first principles, including maximum dissipation and an augmented Lagrangian formulation. The equivalence to a closest-point projection must be shown. Finally, the derived algorithm is to be applied to a specific numerical example.\n\nThe derivation begins by considering the local tangential contact problem at a single contact point. The state is described by the tangential Lagrange multiplier $\\boldsymbol{\\lambda}_t \\in \\mathbb{R}^2$, which represents the frictional traction.\n\n**1. Constitutive Relations for Rate-Independent Friction**\n\nThe fundamental assumption for rate-independent plasticity and friction is the decomposition of the total incremental relative displacement (slip), $\\Delta\\mathbf{u}_t$, into an elastic (reversible) part, $\\Delta\\mathbf{u}_t^e$, and a plastic (irreversible) part, $\\Delta\\mathbf{u}_t^p$:\n$$\n\\Delta\\mathbf{u}_t = \\Delta\\mathbf{u}_t^e + \\Delta\\mathbf{u}_t^p\n$$\nThe problem specifies an augmented formulation with a quadratic regularization parameter $k_t$. This parameter relates the change in tangential traction to the elastic part of the slip, defining a fictitious elastic behavior for the contact interface:\n$$\n\\boldsymbol{\\lambda}_t - \\boldsymbol{\\lambda}_t^n = k_t \\Delta\\mathbf{u}_t^e\n$$\nwhere $\\boldsymbol{\\lambda}_t^n$ is the traction at the beginning of the increment. This can be rewritten as:\n$$\n\\Delta\\mathbf{u}_t^e = \\frac{1}{k_t}(\\boldsymbol{\\lambda}_t - \\boldsymbol{\\lambda}_t^n)\n$$\nThe plastic slip, $\\Delta\\mathbf{u}_t^p$, is governed by the principle of maximum dissipation. For the admissible traction set $\\mathcal{F} = \\{\\boldsymbol{\\tau} \\in \\mathbb{R}^2 : \\|\\boldsymbol{\\tau}\\| \\le \\mu\\lambda_n\\}$, this principle leads to a normality rule. Let the friction yield function be $\\phi(\\boldsymbol{\\lambda}_t) = \\|\\boldsymbol{\\lambda}_t\\| - \\mu\\lambda_n$. The normality rule states that the plastic slip vector must be normal to the yield surface:\n$$\n\\Delta\\mathbf{u}_t^p = \\gamma \\frac{\\partial \\phi}{\\partial \\boldsymbol{\\lambda}_t} = \\gamma \\frac{\\boldsymbol{\\lambda}_t}{\\|\\boldsymbol{\\lambda}_t\\|}\n$$\nwhere $\\gamma \\ge 0$ is the consistency parameter or plastic slip multiplier. This relationship is subject to the Karush-Kuhn-Tucker (KKT) conditions for constrained optimization:\n$$\n\\phi(\\boldsymbol{\\lambda}_t) \\le 0, \\quad \\gamma \\ge 0, \\quad \\gamma \\phi(\\boldsymbol{\\lambda}_t) = 0\n$$\nThese conditions enforce the stick-slip logic: if the traction is strictly inside the friction cone ($\\phi  0$), there is no plastic slip ($\\gamma = 0$). If there is plastic slip ($\\gamma > 0$), the traction must lie on the boundary of the friction cone ($\\phi = 0$).\n\n**2. Derivation of the Return-Mapping Algorithm**\n\nBy substituting the expressions for $\\Delta\\mathbf{u}_t^e$ and $\\Delta\\mathbf{u}_t^p$ into the slip decomposition, we obtain a single evolution equation for $\\boldsymbol{\\lambda}_t$:\n$$\n\\Delta\\mathbf{u}_t = \\frac{1}{k_t}(\\boldsymbol{\\lambda}_t - \\boldsymbol{\\lambda}_t^n) + \\gamma \\frac{\\boldsymbol{\\lambda}_t}{\\|\\boldsymbol{\\lambda}_t\\|}\n$$\nTo solve for $\\boldsymbol{\\lambda}_t$, we first define a **trial state**. The trial state is a predictor based on the assumption of purely elastic behavior (sticking, $\\gamma=0$).\n$$\n\\Delta\\mathbf{u}_t^p = \\mathbf{0} \\implies \\Delta\\mathbf{u}_t = \\Delta\\mathbf{u}_t^e = \\frac{1}{k_t}(\\boldsymbol{\\lambda}_t^{\\mathrm{tr}} - \\boldsymbol{\\lambda}_t^n)\n$$\nThis gives the definition of the trial tangential traction $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}$:\n$$\n\\boldsymbol{\\lambda}_t^{\\mathrm{tr}} := \\boldsymbol{\\lambda}_t^n + k_t \\Delta\\mathbf{u}_t\n$$\nThe trial state is a known quantity, as $\\boldsymbol{\\lambda}_t^n$, $k_t$, and the trial slip $\\Delta\\mathbf{u}_t$ are given for the increment. Now, we check if this trial state is admissible.\n\n**Case 1: Stick Condition** (`\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\| \\le \\mu\\lambda_n`)\nIf the trial traction lies within or on the boundary of the friction cone, then $\\phi(\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}) \\le 0$. Our assumption of $\\gamma=0$ is consistent with the KKT conditions. Therefore, the trial state is the final updated state:\n$$\n\\boldsymbol{\\lambda}_t = \\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\n$$\n\n**Case 2: Slip Condition** (`\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\|  \\mu\\lambda_n`)\nIf the trial traction lies outside the friction cone, $\\phi(\\boldsymbol{\\lambda}_t^{\\mathrm{tr}})  0$, the elastic assumption is invalid. Plastic slip must occur ($\\gamma  0$), and the final state must lie on the yield surface ($\\phi(\\boldsymbol{\\lambda}_t) = 0$, so `\\|\\boldsymbol{\\lambda}_t\\| = \\mu\\lambda_n`).\n\nWe relate the final state $\\boldsymbol{\\lambda}_t$ to the trial state $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}$ using the evolution equation:\n$$\nk_t \\Delta\\mathbf{u}_t = \\boldsymbol{\\lambda}_t - \\boldsymbol{\\lambda}_t^n + k_t \\gamma \\frac{\\boldsymbol{\\lambda}_t}{\\|\\boldsymbol{\\lambda}_t\\|}\n$$\nSubstituting $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}} = \\boldsymbol{\\lambda}_t^n + k_t \\Delta\\mathbf{u}_t$:\n$$\n\\boldsymbol{\\lambda}_t^{\\mathrm{tr}} - \\boldsymbol{\\lambda}_t^n = \\boldsymbol{\\lambda}_t - \\boldsymbol{\\lambda}_t^n + k_t \\gamma \\frac{\\boldsymbol{\\lambda}_t}{\\|\\boldsymbol{\\lambda}_t\\|} \\implies \\boldsymbol{\\lambda}_t^{\\mathrm{tr}} = \\boldsymbol{\\lambda}_t + k_t \\gamma \\frac{\\boldsymbol{\\lambda}_t}{\\|\\boldsymbol{\\lambda}_t\\|}\n$$\nSince $\\|\\boldsymbol{\\lambda}_t\\| = \\mu\\lambda_n$, this becomes:\n$$\n\\boldsymbol{\\lambda}_t^{\\mathrm{tr}} = \\boldsymbol{\\lambda}_t \\left(1 + \\frac{k_t \\gamma}{\\mu\\lambda_n}\\right)\n$$\nThis equation shows that $\\boldsymbol{\\lambda}_t$ is collinear with $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}$ and points in the same direction. Therefore, we can write:\n$$\n\\frac{\\boldsymbol{\\lambda}_t}{\\|\\boldsymbol{\\lambda}_t\\|} = \\frac{\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}}{\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\|}\n$$\nThe updated traction $\\boldsymbol{\\lambda}_t$ is obtained by scaling the trial traction vector back to the yield surface. Since $\\|\\boldsymbol{\\lambda}_t\\| = \\mu\\lambda_n$:\n$$\n\\boldsymbol{\\lambda}_t = (\\mu\\lambda_n) \\frac{\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}}{\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\|}\n$$\nThis operation is known as a radial return or return mapping.\n\n**3. Equivalence to Closest-Point Projection**\n\nThe problem asks to show that this algorithm is equivalent to finding the closest point in the admissible set $\\mathcal{F}$ to the trial traction $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}$. This is the constrained optimization problem:\n$$\n\\text{minimize} \\quad f(\\boldsymbol{\\tau}) = \\frac{1}{2} \\|\\boldsymbol{\\tau} - \\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\|^2 \\quad \\text{subject to} \\quad g(\\boldsymbol{\\tau}) = \\|\\boldsymbol{\\tau}\\| - \\mu\\lambda_n \\le 0\n$$\nThe Lagrangian for this problem is $\\mathcal{L}(\\boldsymbol{\\tau}, \\gamma_p) = \\frac{1}{2} \\|\\boldsymbol{\\tau} - \\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\|^2 + \\gamma_p (\\|\\boldsymbol{\\tau}\\| - \\mu\\lambda_n)$, where $\\gamma_p$ is a Lagrange multiplier. The KKT optimality conditions are:\n1. Stationarity: $\\nabla_{\\boldsymbol{\\tau}} \\mathcal{L} = \\boldsymbol{\\tau} - \\boldsymbol{\\lambda}_t^{\\mathrm{tr}} + \\gamma_p \\frac{\\boldsymbol{\\tau}}{\\|\\boldsymbol{\\tau}\\|} = \\mathbf{0}$\n2. Primal Feasibility: $\\|\\boldsymbol{\\tau}\\| - \\mu\\lambda_n \\le 0$\n3. Dual Feasibility: $\\gamma_p \\ge 0$\n4. Complementarity: $\\gamma_p (\\|\\boldsymbol{\\tau}\\| - \\mu\\lambda_n) = 0$\n\nWe analyze the complementarity condition.\n- If we assume the solution $\\boldsymbol{\\tau}$ is in the interior of $\\mathcal{F}$ (`\\|\\boldsymbol{\\tau}\\|  \\mu\\lambda_n`), then $\\gamma_p$ must be $0$. The stationarity condition reduces to $\\boldsymbol{\\tau} - \\boldsymbol{\\lambda}_t^{\\mathrm{tr}} = \\mathbf{0}$, so $\\boldsymbol{\\tau} = \\boldsymbol{\\lambda}_t^{\\mathrm{tr}}$. This is a valid solution if and only if $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}$ itself satisfies the constraint, i.e., $\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\| \\le \\mu\\lambda_n$. This corresponds to the **stick case**.\n- If we assume the solution is on the boundary (`\\|\\boldsymbol{\\tau}\\| = \\mu\\lambda_n`), then we may have $\\gamma_p > 0$. The stationarity condition $\\boldsymbol{\\tau} - \\boldsymbol{\\lambda}_t^{\\mathrm{tr}} + \\gamma_p \\frac{\\boldsymbol{\\tau}}{\\mu\\lambda_n} = \\mathbf{0}$ implies $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}} = \\boldsymbol{\\tau}(1 + \\frac{\\gamma_p}{\\mu\\lambda_n})$. Taking norms, $\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\| = \\|\\boldsymbol{\\tau}\\|(1 + \\frac{\\gamma_p}{\\mu\\lambda_n}) = \\mu\\lambda_n(1 + \\frac{\\gamma_p}{\\mu\\lambda_n}) = \\mu\\lambda_n + \\gamma_p$. Thus $\\gamma_p = \\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\| - \\mu\\lambda_n$. The condition $\\gamma_p > 0$ means this case applies when $\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\| > \\mu\\lambda_n$. The solution $\\boldsymbol{\\tau}$ is collinear with $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}$ and has norm $\\mu\\lambda_n$, so $\\boldsymbol{\\tau} = (\\mu\\lambda_n) \\frac{\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}}{\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\|}$. This corresponds to the **slip case**.\n\nThe solutions of the minimization problem are identical to the return-mapping algorithm, proving their equivalence.\n\n**4. Coupling to the Global Newton System**\n\nThe derived algorithm $\\boldsymbol{\\lambda}_t = \\boldsymbol{\\lambda}_t(\\Delta\\mathbf{u})$ provides the updated tangential traction for a given incremental global displacement $\\Delta\\mathbf{u}$ via the relations $\\Delta\\mathbf{u}_t = \\mathbf{B}_t \\Delta\\mathbf{u}$ and $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}} = \\boldsymbol{\\lambda}_t^n + k_t \\Delta\\mathbf{u}_t$. In a global implicit solver (e.g., Newton-Raphson), the goal is to find $\\Delta\\mathbf{u}$ that drives a global residual vector $\\mathbf{R}(\\Delta\\mathbf{u})$ to zero. The contact contribution to this residual is $\\mathbf{R}_c = \\mathbf{B}_t^T \\boldsymbol{\\lambda}_t$. At each Newton iteration, an estimate for $\\Delta\\mathbf{u}$ is available. The return-mapping algorithm is used to compute the corresponding $\\boldsymbol{\\lambda}_t$, and the resulting force $\\mathbf{B}_t^T \\boldsymbol{\\lambda}_t$ is assembled into the global residual vector. The linearization of this term contributes to the global tangent stiffness matrix, ensuring quadratic convergence of the Newton method.\n\n**5. Numerical Evaluation**\n\nGiven data:\n`\\boldsymbol{\\lambda}_t^n = \\mathbf{0}`\n`\\lambda_n = 20000\\,\\text{N}`\n`\\mu = 0.3`\n`k_t = 1.0 \\times 10^7\\,\\text{N/m}`\n`\\Delta\\mathbf{u}_t = \\begin{pmatrix} 0.0008 \\\\ -0.0006 \\end{pmatrix}\\,\\text{m}`\n`\\mathbf{B}_t = \\begin{pmatrix} 1  0  0  -1  0  0 \\\\ 0  1  0  0  -1  0 \\end{pmatrix}`\n\n**Step 1: Calculate the trial tangential traction $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}$**\n$$\n\\boldsymbol{\\lambda}_t^{\\mathrm{tr}} = \\boldsymbol{\\lambda}_t^n + k_t \\Delta\\mathbf{u}_t = \\mathbf{0} + (1.0 \\times 10^7) \\begin{pmatrix} 0.0008 \\\\ -0.0006 \\end{pmatrix} = \\begin{pmatrix} 8000 \\\\ -6000 \\end{pmatrix}\\,\\text{N}\n$$\n\n**Step 2: Check for slip**\nCalculate the norm of the trial traction:\n$$\n\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\| = \\sqrt{8000^2 + (-6000)^2} = \\sqrt{64000000 + 36000000} = \\sqrt{100000000} = 10000\\,\\text{N}\n$$\nCalculate the friction limit (radius of the friction disc $\\mathcal{F}$):\n$$\nR = \\mu\\lambda_n = 0.3 \\times 20000 = 6000\\,\\text{N}\n$$\nSince $\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\| = 10000\\,\\text{N} > R = 6000\\,\\text{N}$, the condition is slip.\n\n**Step 3: Apply the return map for the slip case**\nThe updated tangential traction $\\boldsymbol{\\lambda}_t$ is found by projecting $\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}$ radially onto the friction cone boundary:\n$$\n\\boldsymbol{\\lambda}_t = R \\frac{\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}}{\\|\\boldsymbol{\\lambda}_t^{\\mathrm{tr}}\\|} = 6000 \\cdot \\frac{\\begin{pmatrix} 8000 \\\\ -6000 \\end{pmatrix}}{10000} = 6000 \\cdot \\begin{pmatrix} 0.8 \\\\ -0.6 \\end{pmatrix} = \\begin{pmatrix} 4800 \\\\ -3600 \\end{pmatrix}\\,\\text{N}\n$$\n\n**Step 4: Calculate the global contact force vector**\nThe final answer is the contact force contribution to the global residual, given by $\\mathbf{B}_t^T\\boldsymbol{\\lambda}_t$. First, we determine the transpose of $\\mathbf{B}_t$:\n$$\n\\mathbf{B}_t^T = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\\\ -1  0 \\\\ 0  -1 \\\\ 0  0 \\end{pmatrix}\n$$\nNow, we compute the product:\n$$\n\\mathbf{B}_t^T \\boldsymbol{\\lambda}_t = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  0 \\\\ -1  0 \\\\ 0  -1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 4800 \\\\ -3600 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 4800 + 0 \\cdot (-3600) \\\\ 0 \\cdot 4800 + 1 \\cdot (-3600) \\\\ 0 \\\\ -1 \\cdot 4800 + 0 \\cdot (-3600) \\\\ 0 \\cdot 4800 + (-1) \\cdot (-3600) \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4800 \\\\ -3600 \\\\ 0 \\\\ -4800 \\\\ 3600 \\\\ 0 \\end{pmatrix}\\,\\text{N}\n$$\nThe global contact force vector acts with components `(4800, -3600, 0)` on node `\\mathrm{P}` and `(-4800, 3600, 0)` on node `\\mathrm{Q}`, consistent with the definition of $\\mathbf{B}_t$. The final answer is this vector, presented as a row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4800  -3600  0  -4800  3600  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The final practice moves from algorithm derivation to full solver implementation and analysis, the ultimate test of computational understanding. You will implement a one-dimensional contact solver using a powerful semismooth Newton method, built upon the Fischer-Burmeister complementarity function, to investigate a contact-driven localization problem. This exercise not only provides hands-on coding experience but also explores the practical effects of numerical regularization on solution accuracy and stability .",
            "id": "3537740",
            "problem": "Consider a one-dimensional discrete interface representing a frictionless unilateral contact problem in computational geomechanics, enforced by Lagrange multipliers. Let there be $N$ nodal degrees of freedom $u \\in \\mathbb{R}^N$ describing the normal displacement field along the interface. The barrier (rigid obstacle) profile is given by $h \\in \\mathbb{R}^N$, and external nodal loading is $f \\in \\mathbb{R}^N$. The discrete elastic energy is defined by the quadratic form $\\tfrac{1}{2} u^\\top K u - f^\\top u$, where $K \\in \\mathbb{R}^{N \\times N}$ is a symmetric positive definite stiffness matrix constructed from a standard second-derivative finite difference stencil with homogeneous Dirichlet boundary conditions on the ends, specifically $K$ is tridiagonal with $K_{ii} = 2$, $K_{i,i-1} = -1$, $K_{i,i+1} = -1$ for interior indices. The unilateral contact constraint requires the non-penetration condition $g_i(u) = u_i - h_i \\ge 0$ for all $i$, with the Lagrange multipliers $\\lambda_i \\ge 0$ enforcing $g_i(u) \\ge 0$. The governing conditions are the Karush-Kuhn-Tucker (KKT) system derived from minimizing the energy subject to the unilateral constraint:\n- Equilibrium: $K u - f - \\lambda = 0$,\n- Inequality constraints: $u - h \\ge 0$, $\\lambda \\ge 0$,\n- Complementarity: $(u_i - h_i) \\lambda_i = 0$ for all $i$, which may be written using a Nonlinear Complementarity Problem (NCP) function.\n\nYou will implement and compare two contact enforcement strategies:\n1. The standard nonsmooth complementarity via the Fischer-Burmeister function $\\phi(a,b) = \\sqrt{a^2 + b^2} - (a + b)$, which enforces $a \\ge 0$, $b \\ge 0$, and $a b = 0$ when $\\phi(a,b) = 0$.\n2. A numerically regularized (smoothed) complementarity via the $\\epsilon$-smoothed Fischer-Burmeister function $\\phi_\\epsilon(a,b) = \\sqrt{a^2 + b^2 + 2 \\epsilon} - (a + b)$, with $\\epsilon  0$.\n\nStarting from the fundamental base of convex constrained minimization and contact mechanics, the equilibrium and complementarity are combined as the semismooth system\n$$\nF(u,\\lambda) =\n\\begin{bmatrix}\nK u - f - \\lambda \\\\\n\\phi_\\epsilon(u - h, \\lambda)\n\\end{bmatrix}\n= 0,\n$$\nwhere the first block enforces equilibrium and the second block enforces the complementarity for each node. For the nonsmooth case, set $\\epsilon = 0$; for the smoothed case, set $\\epsilon  0$. You must solve $F(u,\\lambda) = 0$ using a semismooth Newton method with line search ensuring $u - h \\ge 0$ and $\\lambda \\ge 0$ at all iterates, using the generalized Jacobian based on the derivatives of $\\phi_\\epsilon$:\n$$\n\\frac{\\partial \\phi_\\epsilon}{\\partial a} = \\frac{a}{\\sqrt{a^2 + b^2 + 2 \\epsilon}} - 1,\\quad\n\\frac{\\partial \\phi_\\epsilon}{\\partial b} = \\frac{b}{\\sqrt{a^2 + b^2 + 2 \\epsilon}} - 1,\n$$\nwith the convention that at $a = 0$ and $b = 0$ the partial derivatives can be taken as $-1$ for numerical robustness. The Jacobian for $F$ is then\n$$\nJ(u,\\lambda) =\n\\begin{bmatrix}\nK  -I \\\\\n\\operatorname{diag}\\left(\\tfrac{\\partial \\phi_\\epsilon}{\\partial a}\\big|_{a=u-h,\\,b=\\lambda}\\right)  \\operatorname{diag}\\left(\\tfrac{\\partial \\phi_\\epsilon}{\\partial b}\\big|_{a=u-h,\\,b=\\lambda}\\right)\n\\end{bmatrix}.\n$$\n\nDefine the barrier profile $h$ as a symmetric Gaussian bump centered at the interface middle:\n$$\nh_i = h_0 \\exp\\!\\left(-\\left(\\frac{i - m}{\\sigma_h}\\right)^2\\right), \\quad m = \\frac{N+1}{2},\n$$\nwith $h_0  0$ and $\\sigma_h  0$ in units of nodes. Define the external load $f$ to be the sum of two Gaussian edge loads that encourage opening near the ends:\n$$\nf_i = p \\left[\\exp\\!\\left(-\\left(\\frac{i - 1}{\\sigma_e}\\right)^2\\right) + \\exp\\!\\left(-\\left(\\frac{i - N}{\\sigma_e}\\right)^2\\right)\\right],\n$$\nwith $p  0$ and $\\sigma_e  0$. This loading produces an open-gap region ($u_i - h_i  0$, $\\lambda_i = 0$) near the edges and a contact region ($u_i - h_i = 0$, $\\lambda_i  0$) near the bump, yielding boundaries where the Lagrange multipliers tend to localize.\n\nYour study goal is to examine whether the numerical regularization by $\\epsilon$-smoothing reduces spurious peak multipliers without altering the global response. Quantify:\n- The peak multiplier as $\\max_i \\lambda_i$,\n- The global response as the total reaction $R = \\sum_i \\lambda_i$.\n\nFor each test case, compute the unsmoothed solution with $\\epsilon = 0$ and the smoothed solution with the specified $\\epsilon  0$, then evaluate the boolean predicate\n$$\n\\left[\\max_i \\lambda_i^{(\\epsilon)}  \\max_i \\lambda_i^{(0)}\\right] \\wedge \\left[\\frac{\\left|R^{(\\epsilon)} - R^{(0)}\\right|}{R^{(0)}} \\le \\text{tol}\\right],\n$$\nwhich is true if smoothing reduces the peak multiplier and preserves the global response within the prescribed tolerance $\\text{tol}$ (expressed as a decimal, not a percentage sign).\n\nImplement the semismooth Newton with:\n- Initialization $u^{(0)} = h$, $\\lambda^{(0)} = \\max(K u^{(0)} - f, 0)$,\n- Update by solving $J \\Delta z = -F$ for $\\Delta z$, then line search scaling to enforce $u - h \\ge 0$ and $\\lambda \\ge 0$ while decreasing the residual norm,\n- Convergence when $\\|F\\|_2 \\le \\tau$ for a small tolerance $\\tau$.\n\nUse the following fixed parameters for all tests: $h_0 = 1.0$, $\\sigma_h = N/10$, $\\sigma_e = N/12$, and Newton tolerance $\\tau = 10^{-10}$, with a cap of $200$ iterations per solve.\n\nTest suite:\n- Case $1$: $N = 64$, $\\epsilon = 10^{-2}$, $p = 0.5$, $\\text{tol} = 0.02$.\n- Case $2$: $N = 64$, $\\epsilon = 10^{-6}$, $p = 0.5$, $\\text{tol} = 0.001$.\n- Case $3$: $N = 64$, $\\epsilon = 10^{-1}$, $p = 0.5$, $\\text{tol} = 0.02$.\n- Case $4$: $N = 128$, $\\epsilon = 10^{-2}$, $p = 0.5$, $\\text{tol} = 0.02$.\n- Case $5$: $N = 16$, $\\epsilon = 10^{-2}$, $p = 0.5$, $\\text{tol} = 0.02$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"). Each result must be a boolean indicating whether the predicate holds for the corresponding test case.",
            "solution": "The user has provided a problem statement that is complete, scientifically sound, and well-posed. The problem is a standard exercise in computational contact mechanics, a subfield of computational geomechanics. It asks for the implementation of a semismooth Newton method to solve a frictionless unilateral contact problem, and to compare the results of a standard nonsmooth formulation with a regularized (smoothed) one. All parameters and governing equations are clearly defined. Therefore, proceeding with a solution is appropriate.\n\n### Principle-Based Solution Derivation\n\nThe problem at hand is the minimization of a discrete elastic potential energy, subject to a set of inequality constraints. This is a classic convex constrained optimization problem.\n\n**1. Variational Formulation and KKT Conditions**\n\nThe total potential energy $\\Pi(u)$ of the system is the sum of the elastic strain energy and the potential of the external forces:\n$$\n\\Pi(u) = \\frac{1}{2} u^\\top K u - f^\\top u\n$$\nwhere $u \\in \\mathbb{R}^N$ is the vector of nodal displacements, $K \\in \\mathbb{R}^{N \\times N}$ is the symmetric positive definite stiffness matrix, and $f \\in \\mathbb{R}^N$ is the external force vector.\n\nThe contact is unilateral, meaning nodes cannot penetrate a rigid barrier defined by the profile $h \\in \\mathbb{R}^N$. This imposes a set of inequality constraints:\n$$\ng_i(u) = u_i - h_i \\ge 0 \\quad \\forall i \\in \\{1, \\dots, N\\}\n$$\nThe problem is to find the displacement field $u$ that minimizes $\\Pi(u)$ subject to $g_i(u) \\ge 0$.\n\nWe introduce Lagrange multipliers $\\lambda \\in \\mathbb{R}^N$ to enforce these constraints. The Lagrangian functional $L(u, \\lambda)$ is:\n$$\nL(u, \\lambda) = \\Pi(u) - \\sum_{i=1}^N \\lambda_i g_i(u) = \\frac{1}{2} u^\\top K u - f^\\top u - \\lambda^\\top(u - h)\n$$\nThe solution to the constrained minimization problem must satisfy the Karush-Kuhn-Tucker (KKT) conditions, which represent the first-order necessary conditions for optimality:\n1.  **Stationarity (Equilibrium):** The gradient of the Lagrangian with respect to the primal variables ($u$) must be zero.\n    $$\n    \\nabla_u L(u, \\lambda) = K u - f - \\lambda = 0\n    $$\n    This is the discrete equilibrium equation, where $\\lambda$ represents the contact reaction forces.\n2.  **Primal Feasibility:** The displacement constraints must be satisfied.\n    $$\n    u_i - h_i \\ge 0 \\quad \\forall i\n    $$\n3.  **Dual Feasibility:** The Lagrange multipliers (contact forces) must be non-negative, as contact can only be compressive.\n    $$\n    \\lambda_i \\ge 0 \\quad \\forall i\n    $$\n4.  **Complementarity:** For each node, either the node is not in contact (gap is open, $u_i - h_i > 0$) and the contact force is zero ($\\lambda_i = 0$), or the node is in contact (gap is closed, $u_i - h_i = 0$) and there can be a non-zero contact force ($\\lambda_i \\ge 0$). This is captured by the complementarity condition:\n    $$\n    \\lambda_i (u_i - h_i) = 0 \\quad \\forall i\n    $$\n\n**2. Nonlinear Complementarity Problem (NCP) Formulation**\n\nThe three conditions involving inequalities (primal feasibility, dual feasibility, and complementarity) can be written compactly for each node $i$ as:\n$$\nu_i - h_i \\ge 0, \\quad \\lambda_i \\ge 0, \\quad (u_i - h_i) \\lambda_i = 0\n$$\nThis is a Nonlinear Complementarity Problem (NCP). A powerful way to express this is using an NCP function, $\\phi(a, b)$, which has the property that $\\phi(a, b) = 0 \\iff a \\ge 0, b \\ge 0, ab = 0$.\n\nThe problem specifies the Fischer-Burmeister (FB) function:\n$$\n\\phi(a, b) = \\sqrt{a^2 + b^2} - (a + b)\n$$\nThe system of equations to be solved consists of the equilibrium equation and the complementarity conditions for all nodes, expressed using the FB function. Let $z = [u^\\top, \\lambda^\\top]^\\top$ be the combined vector of unknowns. The system is $F(z) = 0$, where:\n$$\nF(u, \\lambda) = \\begin{bmatrix} K u - f - \\lambda \\\\ \\phi(u - h, \\lambda) \\end{bmatrix} = 0\n$$\nThe second block, $\\phi(u - h, \\lambda)$, is a vector where the $i$-th component is $\\phi(u_i - h_i, \\lambda_i)$.\n\nThe FB function is nonsmooth (not differentiable) at $(a, b) = (0, 0)$. This occurs at the transition between contact and non-contact. This lack of differentiability prevents the use of a standard Newton method.\n\n**3. Semismooth Newton Method**\n\nA semismooth Newton method is an extension of Newton's method for nonsmooth functions. It replaces the standard Jacobian with a member of the generalized Jacobian (or B-subdifferential). For the FB function, the generalized partial derivatives are well-defined.\n\nThe iterative update is:\n$$\nJ(z^{(k)}) \\Delta z^{(k)} = -F(z^{(k)})\n$$\n$$\nz^{(k+1)} = z^{(k)} + \\alpha^{(k)} \\Delta z^{(k)}\n$$\nwhere $J$ is the generalized Jacobian of $F$, and $\\alpha^{(k)}$ is a step length determined by a line search.\n\nThe problem also introduces a smoothed FB function for regularization:\n$$\n\\phi_\\epsilon(a, b) = \\sqrt{a^2 + b^2 + 2\\epsilon} - (a+b) \\quad (\\epsilon > 0)\n$$\nThis function is continuously differentiable everywhere, turning the problem into a standard nonlinear system solvable by Newton's method. As $\\epsilon \\to 0$, the solution to the smoothed problem approaches the solution of the original nonsmooth problem. The study aims to investigate the effect of this smoothing.\n\nThe Jacobian matrix $J$ for the system $F(u,\\lambda)=0$ (using the smoothed or nonsmooth function) has a $2 \\times 2$ block structure:\n$$\nJ(u,\\lambda) = \\frac{\\partial F}{\\partial z} = \\begin{bmatrix} \\frac{\\partial (Ku-f-\\lambda)}{\\partial u}  \\frac{\\partial (Ku-f-\\lambda)}{\\partial \\lambda} \\\\ \\frac{\\partial \\phi_\\epsilon}{\\partial u}  \\frac{\\partial \\phi_\\epsilon}{\\partial \\lambda} \\end{bmatrix}\n$$\nCalculating the partial derivatives of the blocks gives:\n- $\\frac{\\partial (Ku-f-\\lambda)}{\\partial u} = K$\n- $\\frac{\\partial (Ku-f-\\lambda)}{\\partial \\lambda} = -I$ (where $I$ is the identity matrix)\n- $\\frac{\\partial \\phi_\\epsilon(u-h, \\lambda)}{\\partial u} = \\operatorname{diag}\\left( \\frac{\\partial \\phi_\\epsilon(u_i-h_i, \\lambda_i)}{\\partial(u_i-h_i)} \\right) = \\operatorname{diag}\\left( \\frac{u_i-h_i}{\\sqrt{(u_i-h_i)^2 + \\lambda_i^2 + 2\\epsilon}} - 1 \\right)$\n- $\\frac{\\partial \\phi_\\epsilon(u-h, \\lambda)}{\\partial \\lambda} = \\operatorname{diag}\\left( \\frac{\\partial \\phi_\\epsilon(u_i-h_i, \\lambda_i)}{\\partial\\lambda_i} \\right) = \\operatorname{diag}\\left( \\frac{\\lambda_i}{\\sqrt{(u_i-h_i)^2 + \\lambda_i^2 + 2\\epsilon}} - 1 \\right)$\n\nFor the nonsmooth case ($\\epsilon=0$), at points where $u_i-h_i=0$ and $\\lambda_i=0$, the denominators become zero. At these points, we use a specific element from the generalized Jacobian, as instructed: the partial derivatives are taken to be $-1$.\n\n**4. Algorithmic Implementation**\n\nThe algorithm proceeds as follows for each test case:\n1.  **Setup:** For a given $N$, construct the stiffness matrix $K$, the barrier profile $h$, and the external load vector $f$ according to the provided formulas. The matrix $K$ is a tridiagonal matrix with $2$ on the main diagonal and $-1$ on the off-diagonals.\n2.  **Initialization:** A robust initial guess is crucial. We start with the displacements on the contact boundary, $u^{(0)}=h$. Then, we compute the reaction force that would be required to maintain equilibrium if all nodes were in contact: $\\lambda_{guess} = K u^{(0)} - f$. Since contact forces must be non-negative, we project these onto the feasible set: $\\lambda^{(0)} = \\max(0, \\lambda_{guess})$. This ensures both primal and dual feasibility for the initial guess (with respect to non-negativity).\n3.  **Newton Iteration:**\n    a.  **Compute Residual:** Calculate the residual vector $F(u^{(k)}, \\lambda^{(k)})$.\n    b.  **Check Convergence:** If the L2-norm $\\|F\\|_2$ is below the tolerance $\\tau=10^{-10}$, the solution has converged.\n    c.  **Assemble Jacobian:** Construct the Jacobian matrix $J(u^{(k)}, \\lambda^{(k)})$ using the derivatives specified. Special care is taken for the singular case when $\\epsilon=0$, $u_i-h_i=0$, and $\\lambda_i=0$.\n    d.  **Solve Linear System:** Solve the linear system $J \\Delta z = -F$ to find the Newton search direction $\\Delta z = [\\Delta u^\\top, \\Delta \\lambda^\\top]^\\top$.\n    e.  **Line Search:** Perform a backtracking line search to find a step size $\\alpha \\in (0, 1]$. Start with $\\alpha=1$. At each trial step, verify that the new iterates $u^{(k+1)} = u^{(k)} + \\alpha \\Delta u$ and $\\lambda^{(k+1)} = \\lambda^{(k)} + \\alpha \\Delta \\lambda$ satisfy the non-negativity constraints $u^{(k+1)} - h \\ge 0$ and $\\lambda^{(k+1)} \\ge 0$. Also, ensure the step provides a sufficient decrease in the residual norm $\\|F(z^{(k+1)})\\|_2  \\|F(z^{(k)})\\|_2$. If conditions are not met, reduce $\\alpha$ (e.g., $\\alpha \\leftarrow \\alpha/2$) and repeat.\n    f.  **Update:** Update the solution vectors $u^{(k+1)}$ and $\\lambda^{(k+1)}$ and proceed to the next iteration.\n4.  **Analysis:** After obtaining converged solutions for both the nonsmooth case ($\\lambda^{(0)}$ for $\\epsilon=0$) and the smoothed case ($\\lambda^{(\\epsilon)}$ for $\\epsilon0$), compute the required quantities: the peak multipliers $\\max_i \\lambda_i$ and the total reactions $R = \\sum_i \\lambda_i$. Evaluate the boolean predicate specified in the problem statement to determine if smoothing reduces the peak multiplier while preserving the global response. This process is repeated for each of the five test cases.",
            "answer": "$$ \\boxed{\\texttt{[True,True,False,True,True]}} $$"
        }
    ]
}