{
    "hands_on_practices": [
        {
            "introduction": "在任何接触力学分析中，首要任务是精确地描述接触的几何形态。本练习提供了计算两个表面之间法向间隙 $g_n$ 和切向间隙 $\\boldsymbol{g}_t$ 的基础实践，这两个量是接触力学中的核心运动学变量。通过应用有限元方法中常用的最近点投影法，你将掌握从离散的节点位移中量化接触状态的基本技能 。",
            "id": "3534212",
            "problem": "在三维空间中，一对离散化表面由有限元法 (FEM) 中的两个线性三角形表面单元表示。第一个三角形指定为主控面，第二个为从动面。每个三角形由三个具有初始位置和已知节点位移的节点定义，并且两个表面在单个时间步内都发生小变形。使用线性三角形的标准等参插值以及面积（重心）坐标中形心高斯点的定义。主控三角形节点的顺序为 $\\boldsymbol{X}_{M1} \\rightarrow \\boldsymbol{X}_{M2} \\rightarrow \\boldsymbol{X}_{M3}$，以便通过右手定则定义向外的单位法线。\n\n给定初始坐标和位移：\n- 主控三角形初始节点坐标：$\\boldsymbol{X}_{M1} = (0,\\,0,\\,0)$，$\\boldsymbol{X}_{M2} = (1,\\,0,\\,0)$，$\\boldsymbol{X}_{M3} = (0,\\,1,\\,0.1)$。\n- 主控三角形节点位移：$\\boldsymbol{u}_{M1} = (0,\\,0,\\,0)$，$\\boldsymbol{u}_{M2} = (0,\\,0,\\,0.02)$，$\\boldsymbol{u}_{M3} = (0,\\,0,\\,0)$。\n- 从动三角形初始节点坐标：$\\boldsymbol{X}_{S1} = (0.2,\\,0.2,\\,0.15)$，$\\boldsymbol{X}_{S2} = (1.05,\\,0.1,\\,0.12)$，$\\boldsymbol{X}_{S3} = (0.1,\\,0.9,\\,0.25)$。\n- 从动三角形节点位移：$\\boldsymbol{u}_{S1} = (0.01,\\,-0.005,\\,-0.02)$，$\\boldsymbol{u}_{S2} = (0,\\,0,\\,-0.03)$，$\\boldsymbol{u}_{S3} = (-0.005,\\,0.005,\\,-0.01)$。\n\n假设小应变，并在当前（变形后）构型中计算所有量。在重心坐标为 $(\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3})$ 的从动三角形的形心高斯点处，执行到当前主控三角形上的最近点投影。使用界面接触运动学的第一性原理：\n1. 根据变形后的从动节点构建从动高斯点的当前坐标。\n2. 根据变形后的主控节点构建主控三角形的当前向外单位法线。\n3. 计算从动高斯点到主控三角形平面上的正交最近点投影，并通过重心坐标验证该投影点位于三角形内部。\n4. 从相对位置向量 $\\boldsymbol{g} = \\boldsymbol{x}_{S}^{\\text{GP}} - \\boldsymbol{x}_{M}^{\\text{proj}}$ 中，通过将 $\\boldsymbol{g}$ 分解为相对于投影点处主控面的法向和切向分量，提取法向间隙 $g_n$ 和切向间隙向量 $\\boldsymbol{g}_t$。使用的符号约定为：$g_n  0$ 表示沿主控面外法线方向的分离，$g_n  0$ 表示侵彻。\n\n将您的最终数值四舍五入至四位有效数字。以米为单位表示 $g_n$ 和 $\\boldsymbol{g}_t$ 的每个分量。将最终答案表示为一个单行矩阵，其中包含 $g_n$ 以及 $\\boldsymbol{g}_t$ 在全局坐标系下的三个笛卡尔分量。",
            "solution": "首先验证问题，以确保其科学基础可靠、问题定义明确且提供了所有必要信息。\n\n### 步骤 1：提取已知条件\n- 主控三角形初始节点坐标：$\\boldsymbol{X}_{M1} = (0,\\,0,\\,0)$，$\\boldsymbol{X}_{M2} = (1,\\,0,\\,0)$，$\\boldsymbol{X}_{M3} = (0,\\,1,\\,0.1)$。\n- 主控三角形节点位移：$\\boldsymbol{u}_{M1} = (0,\\,0,\\,0)$，$\\boldsymbol{u}_{M2} = (0,\\,0,\\,0.02)$，$\\boldsymbol{u}_{M3} = (0,\\,0,\\,0)$。\n- 从动三角形初始节点坐标：$\\boldsymbol{X}_{S1} = (0.2,\\,0.2,\\,0.15)$，$\\boldsymbol{X}_{S2} = (1.05,\\,0.1,\\,0.12)$，$\\boldsymbol{X}_{S3} = (0.1,\\,0.9,\\,0.25)$。\n- 从动三角形节点位移：$\\boldsymbol{u}_{S1} = (0.01,\\,-0.005,\\,-0.02)$，$\\boldsymbol{u}_{S2} = (0,\\,0,\\,-0.03)$，$\\boldsymbol{u}_{S3} = (-0.005,\\,0.005,\\,-0.01)$。\n- 从动点：形心高斯点，重心坐标为 $(\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3})$。\n- 主控法线方向：由节点顺序 $\\boldsymbol{X}_{M1} \\rightarrow \\boldsymbol{X}_{M2} \\rightarrow \\boldsymbol{X}_{M3}$ 和右手定则定义。\n- 运动学假设：小变形，在当前构型中进行计算。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础：** 该问题使用了有限元法 (FEM) 中计算接触力学的标准概念，例如等参插值、主从接触对以及用于间隙计算的最近点投影。这些都是已确立的基本原理。\n- **问题定义明确：** 提供了所有必要数据（节点坐标和位移）。任务定义清晰，可以导出一个唯一、可计算的解。\n- **客观性：** 问题以精确、定量的术语陈述，没有主观或模糊的语言。\n- **结论：** 该问题被认为是有效的，因为它是自洽、一致的，并且基于计算力学中已确立的科学原理。\n\n### 求解推导\n求解过程遵循问题陈述中概述的四个步骤。首先，我们计算当前（变形后）构型中的节点坐标。当前坐标向量 $\\boldsymbol{x}$ 是初始坐标向量 $\\boldsymbol{X}$ 和位移向量 $\\boldsymbol{u}$ 的和，即 $\\boldsymbol{x} = \\boldsymbol{X} + \\boldsymbol{u}$。\n\n变形后主控节点坐标：\n$\\boldsymbol{x}_{M1} = \\boldsymbol{X}_{M1} + \\boldsymbol{u}_{M1} = (0,\\,0,\\,0) + (0,\\,0,\\,0) = (0,\\,0,\\,0)$\n$\\boldsymbol{x}_{M2} = \\boldsymbol{X}_{M2} + \\boldsymbol{u}_{M2} = (1,\\,0,\\,0) + (0,\\,0,\\,0.02) = (1,\\,0,\\,0.02)$\n$\\boldsymbol{x}_{M3} = \\boldsymbol{X}_{M3} + \\boldsymbol{u}_{M3} = (0,\\,1,\\,0.1) + (0,\\,0,\\,0) = (0,\\,1,\\,0.1)$\n\n变形后从动节点坐标：\n$\\boldsymbol{x}_{S1} = \\boldsymbol{X}_{S1} + \\boldsymbol{u}_{S1} = (0.2,\\,0.2,\\,0.15) + (0.01,\\,-0.005,\\,-0.02) = (0.21,\\,0.195,\\,0.13)$\n$\\boldsymbol{x}_{S2} = \\boldsymbol{X}_{S2} + \\boldsymbol{u}_{S2} = (1.05,\\,0.1,\\,0.12) + (0,\\,0,\\,-0.03) = (1.05,\\,0.1,\\,0.09)$\n$\\boldsymbol{x}_{S3} = \\boldsymbol{X}_{S3} + \\boldsymbol{u}_{S3} = (0.1,\\,0.9,\\,0.25) + (-0.005,\\,0.005,\\,-0.01) = (0.095,\\,0.905,\\,0.24)$\n\n**1. 构建从动高斯点的当前坐标 ($\\boldsymbol{x}_{S}^{\\text{GP}}$)**\n形心高斯点的位置是节点坐标的平均值，对应于重心坐标 $(\\xi_1, \\xi_2, \\xi_3) = (\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3})$。\n$$ \\boldsymbol{x}_{S}^{\\text{GP}} = \\frac{1}{3}\\boldsymbol{x}_{S1} + \\frac{1}{3}\\boldsymbol{x}_{S2} + \\frac{1}{3}\\boldsymbol{x}_{S3} = \\frac{1}{3}(\\boldsymbol{x}_{S1} + \\boldsymbol{x}_{S2} + \\boldsymbol{x}_{S3}) $$\n$$ \\boldsymbol{x}_{S}^{\\text{GP}} = \\frac{1}{3} \\left( (0.21+1.05+0.095),\\,(0.195+0.1+0.905),\\,(0.13+0.09+0.24) \\right) $$\n$$ \\boldsymbol{x}_{S}^{\\text{GP}} = \\frac{1}{3} (1.355,\\,1.2,\\,0.46) = (0.45166\\dots,\\,0.4,\\,0.15333\\dots) $$\n\n**2. 构建主控三角形的当前向外单位法线 ($\\boldsymbol{n}$)**\n法向量 $\\boldsymbol{N}$ 是通过从一个公共节点出发的两条边向量的叉积求得的，这与右手定则一致。我们使用边向量 $\\boldsymbol{v}_{12} = \\boldsymbol{x}_{M2}-\\boldsymbol{x}_{M1}$ 和 $\\boldsymbol{v}_{13} = \\boldsymbol{x}_{M3}-\\boldsymbol{x}_{M1}$。\n$$ \\boldsymbol{v}_{12} = (1,\\,0,\\,0.02) - (0,\\,0,\\,0) = (1,\\,0,\\,0.02) $$\n$$ \\boldsymbol{v}_{13} = (0,\\,1,\\,0.1) - (0,\\,0,\\,0) = (0,\\,1,\\,0.1) $$\n$$ \\boldsymbol{N} = \\boldsymbol{v}_{12} \\times \\boldsymbol{v}_{13} = \\begin{vmatrix} \\boldsymbol{i}  \\boldsymbol{j}  \\boldsymbol{k} \\\\ 1  0  0.02 \\\\ 0  1  0.1 \\end{vmatrix} = (-0.02, -0.1, 1) $$\n法向量的模为：\n$$ ||\\boldsymbol{N}|| = \\sqrt{(-0.02)^2 + (-0.1)^2 + 1^2} = \\sqrt{0.0004 + 0.01 + 1} = \\sqrt{1.0104} \\approx 1.0051865 $$\n单位法向量 $\\boldsymbol{n}$ 为：\n$$ \\boldsymbol{n} = \\frac{\\boldsymbol{N}}{||\\boldsymbol{N}||} = \\frac{1}{\\sqrt{1.0104}}(-0.02,\\,-0.1,\\,1) \\approx (-0.01990,\\, -0.09949,\\, 0.99494) $$\n\n**3. 计算正交最近点投影 ($\\boldsymbol{x}_{M}^{\\text{proj}}$) 并验证**\n主控面是一个由 $\\boldsymbol{n} \\cdot (\\boldsymbol{x} - \\boldsymbol{x}_{M1}) = 0$ 定义的平面。由于 $\\boldsymbol{x}_{M1} = (0,0,0)$，该平面方程为 $\\boldsymbol{n} \\cdot \\boldsymbol{x} = 0$。\n投影点 $\\boldsymbol{x}_{M}^{\\text{proj}}$ 是通过从 $\\boldsymbol{x}_{S}^{\\text{GP}}$ 沿 $-\\boldsymbol{n}$ 方向移动一段等于正交距离 $d = (\\boldsymbol{x}_{S}^{\\text{GP}} - \\boldsymbol{x}_{M1}) \\cdot \\boldsymbol{n}$ 的距离得到的。\n$$ d = \\boldsymbol{x}_{S}^{\\text{GP}} \\cdot \\boldsymbol{n} = \\frac{1}{3}(1.355,\\,1.2,\\,0.46) \\cdot \\frac{1}{\\sqrt{1.0104}}(-0.02,\\,-0.1,\\,1) $$\n$$ d = \\frac{1}{3\\sqrt{1.0104}} \\left(1.355(-0.02) + 1.2(-0.1) + 0.46(1) \\right) $$\n$$ d = \\frac{1}{3\\sqrt{1.0104}} (-0.0271 - 0.12 + 0.46) = \\frac{0.3129}{3\\sqrt{1.0104}} = \\frac{0.1043}{\\sqrt{1.0104}} \\approx 0.103762 $$\n投影点为 $\\boldsymbol{x}_{M}^{\\text{proj}} = \\boldsymbol{x}_{S}^{\\text{GP}} - d \\boldsymbol{n}$。\n$$ \\boldsymbol{x}_{M}^{\\text{proj}} \\approx (0.451667,\\,0.4,\\,0.153333) - 0.103762 \\cdot (-0.01990,\\, -0.09949,\\, 0.99494) $$\n$$ \\boldsymbol{x}_{M}^{\\text{proj}} \\approx (0.451667+0.002065,\\, 0.4+0.010323,\\, 0.153333-0.103234) $$\n$$ \\boldsymbol{x}_{M}^{\\text{proj}} \\approx (0.45373,\\, 0.41032,\\, 0.05010) $$\n为了验证该点在主控三角形内部，我们求解其重心坐标 $(\\xi_1, \\xi_2, \\xi_3)$，使得 $\\boldsymbol{x}_{M}^{\\text{proj}} = \\xi_1\\boldsymbol{x}_{M1} + \\xi_2\\boldsymbol{x}_{M2} + \\xi_3\\boldsymbol{x}_{M3}$ 且 $\\xi_1+\\xi_2+\\xi_3=1$。\n由于 $\\boldsymbol{x}_{M1} = (0,0,0)$，这可以简化为 $\\boldsymbol{x}_{M}^{\\text{proj}} = \\xi_2\\boldsymbol{x}_{M2} + \\xi_3\\boldsymbol{x}_{M3}$。\n$$ (0.45373,\\, 0.41032,\\, 0.05010) = \\xi_2(1,\\,0,\\,0.02) + \\xi_3(0,\\,1,\\,0.1) $$\n根据 $x$ 和 $y$ 分量：\n$\\xi_2 = 0.45373$\n$\\xi_3 = 0.41032$\n然后 $\\xi_1 = 1 - \\xi_2 - \\xi_3 = 1 - 0.45373 - 0.41032 = 0.13595$。\n由于 $\\xi_1, \\xi_2, \\xi_3$ 均为正值且和为 1，所以投影点位于主控三角形内。验证成功。\n\n**4. 计算法向间隙 ($g_n$) 和切向间隙向量 ($\\boldsymbol{g}_t$)**\n相对位置向量（间隙向量）为 $\\boldsymbol{g} = \\boldsymbol{x}_{S}^{\\text{GP}} - \\boldsymbol{x}_{M}^{\\text{proj}}$。根据正交投影的定义，该向量在构造上平行于法向量 $\\boldsymbol{n}$，其长度等于距离 $d$。\n$$ \\boldsymbol{g} = d \\boldsymbol{n} $$\n法向间隙 $g_n$ 是 $\\boldsymbol{g}$ 沿 $\\boldsymbol{n}$ 方向的分量。根据 $g_n  0$ 表示分离的符号约定，可得：\n$$ g_n = \\boldsymbol{g} \\cdot \\boldsymbol{n} = (d \\boldsymbol{n}) \\cdot \\boldsymbol{n} = d (\\boldsymbol{n} \\cdot \\boldsymbol{n}) = d $$\n$$ g_n = d \\approx 0.103762 $$\n四舍五入到四位有效数字，$g_n = 0.1038$ 米。由于 $g_n  0$，因此两表面在该点处于分离状态。\n\n切向间隙向量 $\\boldsymbol{g}_t$ 是 $\\boldsymbol{g}$ 在主控面平面内的分量。它可以通过从 $\\boldsymbol{g}$ 中减去法向分量得到：\n$$ \\boldsymbol{g}_t = \\boldsymbol{g} - g_n \\boldsymbol{n} $$\n代入 $\\boldsymbol{g} = d \\boldsymbol{n}$ 和 $g_n = d$：\n$$ \\boldsymbol{g}_t = d \\boldsymbol{n} - d \\boldsymbol{n} = \\boldsymbol{0} $$\n切向间隙向量为零，因为投影被定义为与主控面正交。因此，根据定义，从动点到其投影点的向量没有切向分量。\n切向间隙向量的分量为 $\\boldsymbol{g}_t = (g_{tx}, g_{ty}, g_{tz}) = (0, 0, 0)$。\n\n最终值四舍五入至四位有效数字：\n$g_n = 0.1038$\n$\\boldsymbol{g}_t = (0, 0, 0)$\n将这些值表示为单行矩阵 $[g_n, g_{tx}, g_{ty}, g_{tz}]$：\n$[0.1038,\\, 0,\\, 0,\\, 0]$。\n请注意，问题要求对最终数值进行四舍五入，因此 0 分量保持为精确的 0。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.1038  0  0  0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "定义了接触几何后，下一步是理解界面上的物理行为，特别是能量的转化与耗散。本练习探讨了摩擦接触的能量学原理，将施加于界面的总功分解为可恢复的弹性储能和由摩擦不可逆耗散的功 。掌握这种能量划分对于理解材料损伤、热量产生以及摩擦过程的不可逆性至关重要。",
            "id": "3534277",
            "problem": "一个平面岩石节理被理想化为两个可变形体之间的零厚度界面。在恒定的法向压应力 $p_n$ 作用下，该界面承受一个指定的单调递增的切向相对位移跳跃 $g_t$，加载过程中接触始终保持闭合，无分离。其切向本构响应在滑动前是弹性的，单位面积刚度为 $k_t$，而在滑动开始后遵循经典的库仑摩擦定律：剪切牵引力的大小 $|\\tau|$ 不能超过由摩擦系数 $\\mu$ 与施加的法向应力 $p_n$ 的乘积所定义的摩擦极限，并且在滑动期间， $|\\tau|$ 的大小保持等于该摩擦极限。界面面积为 $A$。加载路径在滑动开始前表现为粘滞，随后在摩擦极限下稳定滑移，最终达到一个切向位移跳跃 $D_f$。\n\n仅利用第一性原理，即切向位移跳跃的运动学定义、滑动前的弹性本构关系、库仑摩擦极限以及界面处的机械功率/功的定义，推导总外功如何划分为加载结束时储存的可恢复弹性能和在加载路径中累积的不可恢复的摩擦耗散。然后，根据以下符合科学实际的参数计算这两种能量：\n- 界面面积 $A = 0.50\\,\\mathrm{m}^2$，\n- 恒定法向压应力 $p_n = 10\\,\\mathrm{MPa}$，\n- 摩擦系数 $\\mu = 0.60$，\n- 单位面积切向刚度 $k_t = 2.0\\,\\mathrm{GPa/m}$，\n- 最终切向位移跳跃 $D_f = 8.0\\,\\mathrm{mm}$。\n\n以焦耳为单位表示最终能量。将答案取四位有效数字。将最终答案以行矩阵形式报告，其中第一个条目为可恢复弹性能，第二个条目为不可恢复的摩擦耗散。",
            "solution": "该问题是有效的，因为它科学地基于接触力学和连续介质力学的原理，是适定的，具有一套完整且一致的数据和本构定律，并以客观、正式的语言表述。我们着手求解。\n\n该问题要求划分在剪切加载下平面界面上的总外功，将其分为可恢复弹性能和不可恢复的摩擦耗散。我们来定义相关量。界面面积为 $A$。它承受恒定的法向压应力 $p_n$ 和单调递增的切向相对位移跳跃 $g_t$。剪切牵引力用 $\\tau$ 表示。\n\n界面的本构行为由两种状态描述：\n1.  **弹性（粘滞）状态**：滑动开始前，剪切牵引力与切向位移跳跃成线性比例关系。单位面积刚度为 $k_t$。该关系由下式给出：\n    $$ \\tau = k_t g_t $$\n    只要剪切牵引力低于摩擦强度，该状态就成立。\n2.  **塑性（滑移）状态**：当剪切牵引力达到库仑摩擦定律定义的极限时，发生滑动。摩擦强度为 $\\mu p_n$，其中 $\\mu$ 是摩擦系数。在滑动过程中，剪切牵引力的大小是恒定的，等于此极限：\n    $$ |\\tau| = \\mu p_n $$\n\n从粘滞到滑移状态的转变发生在一个特定的切向位移跳跃处，我们称之为屈服位移 $g_{t, \\text{yield}}$。在这一点，弹性牵引力等于摩擦强度：\n$$ k_t g_{t, \\text{yield}} = \\mu p_n $$\n求解屈服位移可得：\n$$ g_{t, \\text{yield}} = \\frac{\\mu p_n}{k_t} $$\n加载路径包括一个初始弹性阶段（$0 \\le g_t \\le g_{t, \\text{yield}}$），随后是一个稳定滑移阶段（$g_{t, \\text{yield}}  g_t \\le D_f$），其中 $D_f$ 是最终指定的切向位移跳跃。我们必须首先验证 $D_f  g_{t, \\text{yield}}$，以确认确实达到了滑移阶段。\n\n施加在界面上的总外功 $W_{\\text{total}}$ 是总切向力 $F_t = \\tau A$ 对总切向位移跳跃从 $g_t=0$ 到 $g_t=D_f$ 的积分。\n$$ W_{\\text{total}} = \\int_0^{D_f} F_t(g_t) \\, dg_t = A \\int_0^{D_f} \\tau(g_t) \\, dg_t $$\n我们必须根据加载路径的两个阶段来拆分这个积分：\n$$ W_{\\text{total}} = A \\left( \\int_0^{g_{t, \\text{yield}}} \\tau(g_t) \\, dg_t + \\int_{g_{t, \\text{yield}}}^{D_f} \\tau(g_t) \\, dg_t \\right) $$\n将每个阶段的 $\\tau(g_t)$ 的本构关系代入：\n$$ W_{\\text{total}} = A \\left( \\int_0^{g_{t, \\text{yield}}} (k_t g_t) \\, dg_t + \\int_{g_{t, \\text{yield}}}^{D_f} (\\mu p_n) \\, dg_t \\right) $$\n计算积分：\n$$ W_{\\text{total}} = A \\left( \\left[ \\frac{1}{2} k_t g_t^2 \\right]_0^{g_{t, \\text{yield}}} + \\left[ \\mu p_n g_t \\right]_{g_{t, \\text{yield}}}^{D_f} \\right) $$\n$$ W_{\\text{total}} = A \\left( \\frac{1}{2} k_t g_{t, \\text{yield}}^2 + \\mu p_n (D_f - g_{t, \\text{yield}}) \\right) $$\n\n这个总功被划分为可恢复的储存弹性能 $U_e$ 和不可恢复的耗散能 $W_d$。\n$$ W_{\\text{total}} = U_e + W_d $$\n\n可恢复弹性能 $U_e$ 是在最终状态（对应位移 $D_f$）下储存在界面中的能量。在此最终状态下，界面正在滑动，因此剪切牵引力为 $\\tau_f = \\mu p_n$。位移的弹性部分 $g_t^e$ 通过弹性定律与该牵引力相关：$\\tau_f = k_t g_t^e$。因此，在最终状态下：\n$$ g_{t,f}^e = \\frac{\\tau_f}{k_t} = \\frac{\\mu p_n}{k_t} = g_{t, \\text{yield}} $$\n单位面积储存的弹性能为 $u_e = \\frac{1}{2} k_t (g_{t,f}^e)^2 = \\frac{1}{2} \\frac{\\tau_f^2}{k_t}$。整个界面的总可恢复弹性能为：\n$$ U_e = A \\cdot u_e = A \\left( \\frac{1}{2} \\frac{(\\mu p_n)^2}{k_t} \\right) $$\n\n不可恢复的摩擦耗散 $W_d$ 是摩擦力在位移的塑性（滑移）部分 $g_t^p = g_t - g_t^e$ 上所做的功。耗散仅在滑移阶段发生，即 $g_t  g_{t, \\text{yield}}$ 且 $|\\tau| = \\mu p_n$。滑移量为 $\\Delta g_t^p = D_f - g_{t,f}^e = D_f - g_{t, \\text{yield}}$。耗散是恒定的总摩擦力 $F_f = A \\mu p_n$ 与总滑移距离的乘积：\n$$ W_d = (A \\mu p_n) (D_f - g_{t, \\text{yield}}) $$\n代入 $g_{t, \\text{yield}}$ 的表达式：\n$$ W_d = A \\mu p_n \\left( D_f - \\frac{\\mu p_n}{k_t} \\right) = A \\left( \\mu p_n D_f - \\frac{(\\mu p_n)^2}{k_t} \\right) $$\n\n现在我们代入给定的数值，并确保所有单位都是国际单位制（SI）基本单位。\n- 界面面积：$A = 0.50\\,\\mathrm{m}^2$\n- 法向应力：$p_n = 10\\,\\mathrm{MPa} = 10 \\times 10^6\\,\\mathrm{Pa}$\n- 摩擦系数：$\\mu = 0.60$\n- 切向刚度：$k_t = 2.0\\,\\mathrm{GPa/m} = 2.0 \\times 10^9\\,\\mathrm{N/m^3}$\n- 最终位移：$D_f = 8.0\\,\\mathrm{mm} = 8.0 \\times 10^{-3}\\,\\mathrm{m}$\n\n首先，我们计算屈服位移 $g_{t, \\text{yield}}$：\n$$ g_{t, \\text{yield}} = \\frac{\\mu p_n}{k_t} = \\frac{0.60 \\times (10 \\times 10^6\\,\\mathrm{Pa})}{2.0 \\times 10^9\\,\\mathrm{N/m^3}} = \\frac{6.0 \\times 10^6\\,\\mathrm{N/m^2}}{2.0 \\times 10^9\\,\\mathrm{N/m^3}} = 3.0 \\times 10^{-3}\\,\\mathrm{m} $$\n由于 $D_f = 8.0 \\times 10^{-3}\\,\\mathrm{m}  g_{t, \\text{yield}} = 3.0 \\times 10^{-3}\\,\\mathrm{m}$，界面确实经历了一段稳定滑移，因此我们推导的公式是适用的。\n\n接下来，我们计算可恢复弹性能 $U_e$：\n$$ U_e = A \\left( \\frac{1}{2} \\frac{(\\mu p_n)^2}{k_t} \\right) = (0.50\\,\\mathrm{m}^2) \\left( \\frac{1}{2} \\frac{(0.60 \\times 10 \\times 10^6\\,\\mathrm{Pa})^2}{2.0 \\times 10^9\\,\\mathrm{N/m^3}} \\right) $$\n$$ U_e = 0.50 \\left( \\frac{1}{2} \\frac{(6.0 \\times 10^6)^2}{2.0 \\times 10^9} \\right) \\,\\mathrm{J} = 0.50 \\left( \\frac{36 \\times 10^{12}}{4.0 \\times 10^9} \\right) \\,\\mathrm{J} $$\n$$ U_e = 0.50 \\times (9.0 \\times 10^3) \\,\\mathrm{J} = 4500\\,\\mathrm{J} $$\n\n最后，我们计算不可恢复的摩擦耗散 $W_d$：\n$$ W_d = A \\mu p_n (D_f - g_{t, \\text{yield}}) = (0.50\\,\\mathrm{m}^2)(0.60)(10 \\times 10^6\\,\\mathrm{Pa})(8.0 \\times 10^{-3}\\,\\mathrm{m} - 3.0 \\times 10^{-3}\\,\\mathrm{m}) $$\n总摩擦力为 $F_f = A \\mu p_n = (0.50\\,\\mathrm{m}^2)(6.0 \\times 10^6\\,\\mathrm{N/m^2}) = 3.0 \\times 10^6\\,\\mathrm{N}$。\n总滑移距离为 $\\Delta g_t^p = (8.0 - 3.0) \\times 10^{-3}\\,\\mathrm{m} = 5.0 \\times 10^{-3}\\,\\mathrm{m}$。\n$$ W_d = (3.0 \\times 10^6\\,\\mathrm{N}) (5.0 \\times 10^{-3}\\,\\mathrm{m}) = 15.0 \\times 10^3\\,\\mathrm{J} = 15000\\,\\mathrm{J} $$\n\n题目要求将结果取四位有效数字。\n可恢复弹性能：$U_e = 4500\\,\\mathrm{J} = 4.500 \\times 10^3\\,\\mathrm{J}$。\n不可恢复的摩擦耗散：$W_d = 15000\\,\\mathrm{J} = 1.500 \\times 10^4\\,\\mathrm{J}$。\n\n最终答案是一个包含这两个能量值（单位为焦耳）的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.500 \\times 10^3  1.500 \\times 10^4\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了运动学和能量学的基本概念之后，这项高级实践将深入计算岩土力学领域的核心：为岩石节理实现一个切合实际的本构模型。本练习要求你推导并编写一个针对非关联摩擦塑性模型的返回映射算法，从而揭示剪胀效应在岩土地质界面力学响应中的关键作用 。这项实践是连接理论与数值模拟的关键一步。",
            "id": "3534255",
            "problem": "你需要实现一个小应变、率无关、理想塑性的界面本构更新，并用它来比较相关联塑性（塑性流动势等于屈服函数）与非相关联塑性（塑性流动势不同于屈服函数）在三轴压缩下剪胀节理响应方面的差异。其教学背景是计算岩土力学，重点关注界面和接触力学的基础知识。实现必须是一个完整、可运行的程序。\n\n假设一个摩擦节理被建模为一个界面单元，其弹性法向刚度为 $K_n$，弹性剪切刚度为 $K_s$，这两个刚度将应力与位移跳跃的弹性部分联系起来。设剪应力为 $\\tau$，法向应力为 $\\sigma_n$，两者分别在正向剪切和压缩方向上定义为正。设总剪切位移跳跃为 $\\delta_s$，总法向位移跳跃为 $\\delta_n$。设其塑性部分为 $\\delta_s^p$ 和 $\\delta_n^p$。则弹性部分为 $\\delta_s - \\delta_s^p$ 和 $\\delta_n - \\delta_n^p$。\n\n使用广泛接受的摩擦屈服函数\n$$ f = \\tau - \\mu \\, \\sigma_n, $$\n其中 $\\mu = \\tan \\phi$，$ \\phi $ 为摩擦角。使用塑性流动势\n$$ g = \\tau - \\tan \\psi \\, \\sigma_n, $$\n其中 $\\psi$ 是剪胀角。相关联塑性对应于 $\\psi = \\phi$，非相关联塑性对应于 $\\psi \\neq \\phi$。\n\n采用以下基本定义和原理作为基础：\n- 弹性应力-位移关系：$ \\tau = K_s \\, (\\delta_s - \\delta_s^p) $ 和 $ \\sigma_n = K_n \\, (\\delta_n - \\delta_n^p) $。\n- 标准率无关塑性条件（Kuhn-Tucker 条件）：$ f \\le 0 $，$ \\dot{\\lambda} \\ge 0 $ 和 $ \\dot{\\lambda} \\, f = 0 $，其中 $ \\dot{\\lambda} $ 是塑性乘子率。\n- 由 $g$ 定义的塑性流动的法向法则，给出与 $g$ 的梯度成正比的塑性增量：$ \\Delta \\delta_s^p = \\Delta \\lambda \\, \\frac{\\partial g}{\\partial \\tau} $ 和 $ \\Delta \\delta_n^p = \\Delta \\lambda \\, \\frac{\\partial g}{\\partial \\sigma_n} $。\n- 对于小增量，$ \\frac{\\partial g}{\\partial \\tau} = 1 $ 且 $ \\frac{\\partial g}{\\partial \\sigma_n} = - \\tan \\psi $。\n\n考虑一个离散的增量加载过程，该过程由一系列给定的位移跳跃增量 $ (\\Delta \\delta_s, \\Delta \\delta_n) $ 组成。在每个增量步中，执行弹性试探，检查屈服条件，如果 $ f > 0 $，则使用流动势强制塑性一致性来校正状态。假设在整个测试过程中节理保持受压状态，并忽略分离；本问题中不强制执行受拉截止。\n\n你的任务是：\n1. 严格从上述基本原理出发（不引入任何快捷公式），推导当弹性试探状态违反 $ f \\le 0 $ 时，将状态返回到屈服面所需的塑性校正的算法表达式。展示如何获得塑性乘子增量 $ \\Delta \\lambda $ 以及 $ \\delta_s^p $ 和 $ \\delta_n^p $ 的相应更新，以在校正后达到 $ f = 0 $。\n2. 实现一个鲁棒的增量更新程序，在每个加载增量中：\n   - 更新 $ \\delta_s $ 和 $ \\delta_n $，\n   - 形成弹性试探应力，\n   - 检查屈服函数，\n   - 根据需要执行相关联或非相关联的塑性校正，\n   - 输出最终的剪应力 $ \\tau $ 和累积塑性法向张开量，定义为 $ \\max(0, -\\delta_n^p) $，在此符号约定下，负的 $ \\delta_n^p $ 代表剪胀张开。\n\n角度必须以度为单位提供，但在内部为进行三角函数计算需转换为弧度。剪应力以帕斯卡（Pascals）表示，塑性法向张开量以米（meters）表示。所有输出必须是国际单位制（SI）中的浮点数。\n\n使用以下测试套件，每个测试由 $ (K_s, K_n, \\phi, \\psi, \\text{increments}) $ 定义，其中增量以一个包含三个或更少对 $ (\\Delta \\delta_s, \\Delta \\delta_n) $（单位：米）的列表形式给出：\n\n- 测试 1 (相关联，剪胀，标准情况): $ K_s = 5.0 \\times 10^9 $, $ K_n = 6.0 \\times 10^9 $, $ \\phi = 30^\\circ $, $ \\psi = 30^\\circ $, 增量 $ [(1.0 \\times 10^{-5}, \\; 3.0 \\times 10^{-6}), (1.0 \\times 10^{-5}, \\; 3.0 \\times 10^{-6}), (1.0 \\times 10^{-5}, \\; 3.0 \\times 10^{-6})] $。\n- 测试 2 (非相关联，剪胀减小): $ K_s = 5.0 \\times 10^9 $, $ K_n = 6.0 \\times 10^9 $, $ \\phi = 30^\\circ $, $ \\psi = 10^\\circ $, 增量 $ [(1.0 \\times 10^{-5}, \\; 3.0 \\times 10^{-6}), (1.0 \\times 10^{-5}, \\; 3.0 \\times 10^{-6}), (1.0 \\times 10^{-5}, \\; 3.0 \\times 10^{-6})] $。\n- 测试 3 (弹性状态，不屈服): $ K_s = 2.0 \\times 10^9 $, $ K_n = 6.0 \\times 10^9 $, $ \\phi = 35^\\circ $, $ \\psi = 30^\\circ $, 增量 $ [(2.0 \\times 10^{-6}, \\; 3.0 \\times 10^{-6}), (2.0 \\times 10^{-6}, \\; 3.0 \\times 10^{-6}), (2.0 \\times 10^{-6}, \\; 3.0 \\times 10^{-6})] $。\n- 测试 4 (相关联，算法分母接近临界值): $ K_s = 1.107 \\times 10^9 $, $ K_n = 5.0 \\times 10^9 $, $ \\phi = 25^\\circ $, $ \\psi = 25^\\circ $, 增量 $ [(2.0 \\times 10^{-5}, \\; 4.0 \\times 10^{-6}), (2.0 \\times 10^{-5}, \\; 4.0 \\times 10^{-6})] $。\n- 测试 5 (非相关联，零剪胀边界): $ K_s = 5.0 \\times 10^9 $, $ K_n = 6.0 \\times 10^9 $, $ \\phi = 30^\\circ $, $ \\psi = 0^\\circ $, 增量 $ [(1.0 \\times 10^{-5}, \\; 3.0 \\times 10^{-6}), (1.0 \\times 10^{-5}, \\; 3.0 \\times 10^{-6}), (1.0 \\times 10^{-5}, \\; 3.0 \\times 10^{-6})] $。\n\n对于每个测试，在最后一个增量之后计算：\n- 累积塑性法向张开量 $ \\max(0, -\\delta_n^p) $（单位：米）。\n- 最终剪应力 $ \\tau $（单位：帕斯卡）。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果是一个双元素列表 $ [\\text{opening\\_m}, \\text{tau\\_Pa}] $。例如，输出格式必须类似于 $ [[o_1,t_1],[o_2,t_2],\\dots] $，所有值均为浮点数，且无附加文本。",
            "solution": "该问题要求推导并实现一个针对表现出率无关、理想塑性行为的摩擦界面的本构更新算法。任务的核心是为给定的屈服函数和流动势正确应用返回映射算法，并比较相关联塑性与非相关联塑性的结果，特别是关于剪切引起的剪胀。\n\n该问题遵循一套应用于界面单元的连续介质塑性理论基本原理。设一个增量开始时的状态已知。这包括总位移跳跃 $(\\delta_s, \\delta_n)$ 和累积塑性位移跳跃 $(\\delta_s^p, \\delta_n^p)$。相应的应力为 $\\tau = K_s(\\delta_s - \\delta_s^p)$ 和 $\\sigma_n = K_n(\\delta_n - \\delta_n^p)$。我们给定一个规定的位移增量 $(\\Delta \\delta_s, \\Delta \\delta_n)$。\n\n更新过程遵循标准的预测-校正方案。\n\n首先，将总位移跳跃更新为增量结束时的值：\n$$ \\delta_{s, \\text{new}} = \\delta_{s, \\text{old}} + \\Delta \\delta_s $$\n$$ \\delta_{n, \\text{new}} = \\delta_{n, \\text{old}} + \\Delta \\delta_n $$\n\n接下来，计算弹性试探状态。这个预测步骤假设整个增量是弹性的。塑性变量保持不变，并计算试探应力：\n$$ \\delta_{s, \\text{new}}^{p, \\text{trial}} = \\delta_{s, \\text{old}}^p $$\n$$ \\delta_{n, \\text{new}}^{p, \\text{trial}} = \\delta_{n, \\text{old}}^p $$\n$$ \\tau^{\\text{trial}} = K_s (\\delta_{s, \\text{new}} - \\delta_{s, \\text{old}}^p) $$\n$$ \\sigma_n^{\\text{trial}} = K_n (\\delta_{n, \\text{new}} - \\delta_{n, \\text{old}}^p) $$\n\n然后根据屈服条件检查试探状态。屈服函数为 $f = \\tau - \\mu \\sigma_n$，其中 $\\mu = \\tan\\phi$。我们在试探状态下评估 $f$：\n$$ f^{\\text{trial}} = \\tau^{\\text{trial}} - \\mu \\sigma_n^{\\text{trial}} $$\n如果 $f^{\\text{trial}} \\le 0$，则弹性假设有效。试探状态即为该增量的最终状态。塑性乘子增量为 $\\Delta\\lambda = 0$，塑性位移跳跃不发生变化。\n\n如果 $f^{\\text{trial}}  0$，则界面已屈服，需要进行塑性校正。最终状态必须位于屈服面上，即 $f_{\\text{new}} = 0$。这是一致性条件。塑性流动由流动势 $g = \\tau - \\tan\\psi \\sigma_n$ 和法向法则控制。塑性位移跳跃的增量为：\n$$ \\Delta\\delta_s^p = \\Delta\\lambda \\frac{\\partial g}{\\partial \\tau} = \\Delta\\lambda (1) = \\Delta\\lambda $$\n$$ \\Delta\\delta_n^p = \\Delta\\lambda \\frac{\\partial g}{\\partial \\sigma_n} = \\Delta\\lambda (-\\tan\\psi) = -\\Delta\\lambda \\tan\\psi $$\n其中 $\\Delta\\lambda  0$ 是塑性乘子增量。更新后的塑性位移为：\n$$ \\delta_{s, \\text{new}}^p = \\delta_{s, \\text{old}}^p + \\Delta\\delta_s^p $$\n$$ \\delta_{n, \\text{new}}^p = \\delta_{n, \\text{old}}^p + \\Delta\\delta_n^p $$\n\n增量结束时的最终应力与试探应力和塑性校正有关：\n$$ \\tau_{\\text{new}} = K_s(\\delta_{s, \\text{new}} - \\delta_{s, \\text{new}}^p) = K_s(\\delta_{s, \\text{new}} - \\delta_{s, \\text{old}}^p - \\Delta\\delta_s^p) = \\tau^{\\text{trial}} - K_s \\Delta\\delta_s^p $$\n$$ \\sigma_{n, \\text{new}} = K_n(\\delta_{n, \\text{new}} - \\delta_{n, \\text{new}}^p) = K_n(\\delta_{n, \\text{new}} - \\delta_{n, \\text{old}}^p - \\Delta\\delta_n^p) = \\sigma_n^{\\text{trial}} - K_n \\Delta\\delta_n^p $$\n代入塑性增量的表达式：\n$$ \\tau_{\\text{new}} = \\tau^{\\text{trial}} - K_s \\Delta\\lambda $$\n$$ \\sigma_{n, \\text{new}} = \\sigma_n^{\\text{trial}} - K_n (-\\Delta\\lambda \\tan\\psi) = \\sigma_n^{\\text{trial}} + K_n \\Delta\\lambda \\tan\\psi $$\n这些方程描述了从试探状态返回到屈服面的返回路径。最终状态必须满足一致性条件 $f_{\\text{new}} = 0$：\n$$ f_{\\text{new}} = \\tau_{\\text{new}} - \\mu \\sigma_{n, \\text{new}} = 0 $$\n代入 $\\tau_{\\text{new}}$ 和 $\\sigma_{n, \\text{new}}$ 的表达式：\n$$ (\\tau^{\\text{trial}} - K_s \\Delta\\lambda) - \\mu (\\sigma_n^{\\text{trial}} + K_n \\Delta\\lambda \\tan\\psi) = 0 $$\n这个方程可以重新整理以求解未知的塑性乘子增量 $\\Delta\\lambda$。\n$$ \\tau^{\\text{trial}} - \\mu \\sigma_n^{\\text{trial}} = K_s \\Delta\\lambda + \\mu K_n \\Delta\\lambda \\tan\\psi $$\n左侧恰好是屈服函数在试探状态下的值 $f^{\\text{trial}}$。在右侧提出 $\\Delta\\lambda$ 因子可得：\n$$ f^{\\text{trial}} = \\Delta\\lambda (K_s + \\mu K_n \\tan\\psi) $$\n由此，我们推导出塑性乘子增量的最终表达式：\n$$ \\Delta\\lambda = \\frac{f^{\\text{trial}}}{K_s + \\mu K_n \\tan\\psi} = \\frac{\\tau^{\\text{trial}} - (\\tan\\phi) \\sigma_n^{\\text{trial}}}{K_s + (\\tan\\phi) K_n (\\tan\\psi)} $$\n由于 $f^{\\text{trial}}  0$，且分母代表弹性刚度的组合，对于所有物理上相关的材料参数（$K_s  0, K_n  0, \\phi \\ge 0, \\psi \\ge 0$）均为正，因此可以保证 $\\Delta\\lambda  0$，这与塑性加载的 Kuhn-Tucker 条件一致。\n\n一旦计算出 $\\Delta\\lambda$，状态就完全更新了。计算塑性位移增量，将其加到先前的累积值上，然后使用更新后的塑性位移通过弹性定律计算最终应力。这样就完成了一个增量的本构更新。\n\n该实现将包含一个针对每个测试用例的预定增量循环。在循环内部，执行这个精确的预测-校正算法。所有测试的初始条件都是零位移、零塑性位移和零应力。程序将跟踪加载路径上 $\\delta_s^p$ 和 $\\delta_n^p$ 的演化。根据我们的符号约定（法向位移压为正），剪胀或节理的塑性张开对应于负的 $\\delta_n^p$ 值，因此张开量由 $-\\delta_n^p$ 给出。每个测试用例的最终输出是处理完所有增量后累积的塑性张开量 $\\max(0, -\\delta_n^p)$ 和最终的剪应力 $\\tau$。",
            "answer": "```python\nimport numpy as np\nimport json\n\ndef solve():\n    \"\"\"\n    Solves the interface plasticity problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test 1 (associative, dilative, happy path)\n        (5.0e9, 6.0e9, 30.0, 30.0, [(1.0e-5, 3.0e-6), (1.0e-5, 3.0e-6), (1.0e-5, 3.0e-6)]),\n        # Test 2 (non-associative, reduced dilation)\n        (5.0e9, 6.0e9, 30.0, 10.0, [(1.0e-5, 3.0e-6), (1.0e-5, 3.0e-6), (1.0e-5, 3.0e-6)]),\n        # Test 3 (elastic regime, no yield)\n        (2.0e9, 6.0e9, 35.0, 30.0, [(2.0e-6, 3.0e-6), (2.0e-6, 3.0e-6), (2.0e-6, 3.0e-6)]),\n        # Test 4 (associative, near-critical algorithmic denominator)\n        (1.107e9, 5.0e9, 25.0, 25.0, [(2.0e-5, 4.0e-6), (2.0e-5, 4.0e-6)]),\n        # Test 5 (non-associative, zero dilation boundary)\n        (5.0e9, 6.0e9, 30.0, 0.0, [(1.0e-5, 3.0e-6), (1.0e-5, 3.0e-6), (1.0e-5, 3.0e-6)]),\n    ]\n\n    results = []\n    for case in test_cases:\n        opening, tau = run_simulation(*case)\n        results.append([opening, tau])\n\n    # Format the final output string to match the required format '[[o1,t1],[o2,t2],...]'\n    # Using json.dumps is a reliable way to get this format, but as it's not standard lib, we'll build it.\n    # An alternative is str(results).replace(' ', '')\n    output_str = str(results).replace(\" \", \"\")\n    print(output_str)\n\n\ndef run_simulation(Ks, Kn, phi_deg, psi_deg, increments):\n    \"\"\"\n    Performs the incremental analysis for a single test case.\n\n    Args:\n        Ks (float): Shear stiffness (Pa/m).\n        Kn (float): Normal stiffness (Pa/m).\n        phi_deg (float): Friction angle (degrees).\n        psi_deg (float): Dilation angle (degrees).\n        increments (list of tuples): List of (d_delta_s, d_delta_n) increments.\n\n    Returns:\n        tuple: (accumulated plastic normal opening in m, final shear traction in Pa).\n    \"\"\"\n    # Convert angles to radians\n    phi = np.deg2rad(phi_deg)\n    psi = np.deg2rad(psi_deg)\n    \n    # Pre-calculate trigonometric values\n    tan_phi = np.tan(phi)\n    tan_psi = np.tan(psi)\n    \n    # Initialize state variables\n    delta_s = 0.0  # Total shear displacement jump\n    delta_n = 0.0  # Total normal displacement jump\n    delta_s_p = 0.0  # Plastic shear displacement jump\n    delta_n_p = 0.0  # Plastic normal displacement jump\n\n    for d_delta_s, d_delta_n in increments:\n        # Update total displacement jumps\n        delta_s += d_delta_s\n        delta_n += d_delta_n\n        \n        # --- Elastic Trial ---\n        tau_trial = Ks * (delta_s - delta_s_p)\n        sigma_n_trial = Kn * (delta_n - delta_n_p)\n        \n        # --- Yield Check ---\n        f_trial = tau_trial - tan_phi * sigma_n_trial\n        \n        if f_trial > 0:\n            # --- Plastic Corrector ---\n            denominator = Ks + tan_phi * Kn * tan_psi\n            delta_lambda = f_trial / denominator\n            \n            # --- Update Plastic State ---\n            d_delta_s_p = delta_lambda\n            d_delta_n_p = -delta_lambda * tan_psi\n            \n            delta_s_p += d_delta_s_p\n            delta_n_p += d_delta_n_p\n\n    # After all increments, calculate final tractions and outputs\n    final_tau = Ks * (delta_s - delta_s_p)\n    # The normal displacement jump delta_n is positive in compression.\n    # Plastic dilation (opening) corresponds to a negative delta_n_p.\n    # The magnitude of opening is therefore -delta_n_p.\n    final_opening = max(0.0, -delta_n_p)\n\n    return final_opening, final_tau\n\nsolve()\n```"
        }
    ]
}