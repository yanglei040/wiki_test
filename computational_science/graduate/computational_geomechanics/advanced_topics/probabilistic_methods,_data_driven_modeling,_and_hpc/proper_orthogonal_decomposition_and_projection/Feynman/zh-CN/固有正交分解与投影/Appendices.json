{
    "hands_on_practices": [
        {
            "introduction": "应用本征正交分解的第一步是从一组数据快照中提取主要的变异模式。本实践练习将引导您完成一个简单低维系统中计算POD模式的基本过程。通过完成这个练习，您将巩固对POD变分原理、相关矩阵的特征值问题以及奇异值分解（SVD）之间联系的理解。",
            "id": "3553475",
            "problem": "在一个平面应变岩土力学边值问题的有限元模拟中，假设位移场已通过静力凝聚被简化为两个主导自由度，并已计算了三个准静态加载步。设快照矩阵为 $2 \\times 3$ 矩阵\n$$\nX=\\begin{bmatrix}1  1  0 \\\\ 0  1  1\\end{bmatrix},\n$$\n其中第 $j$ 列存储了加载步 $j$ 的离散位移向量。采用标准的欧几里得内积，因此权重矩阵为 $W=I$，其中 $I$ 表示 $2 \\times 2$ 的单位矩阵。\n\n使用本征正交分解（POD）的变分定义，即第一模态 $u_{1}$ 是在关于 $W$ 的归一化约束条件下，快照在 $u_{1}$ 上投影的均方值的约束最大化问题的解，从第一性原理出发，推导当 $W=I$ 时表征POD模态的相关性特征问题。然后，对于给定的 $X$：\n- 显式计算前两个POD模态 $u_{1}$ 和 $u_{2}$，确保在 $W$-内积中精确归一化，并为每个模态明确指定一致的符号约定。\n- 计算形成最优秩一POD重构 $\\widehat{X}_{1}$ 所需的相关奇异值，以及对应于 $u_{1}$ 和 $u_{2}$ 的右奇异向量。\n- 将最优秩一POD重构定义为 $\\widehat{X}_{1}=\\sigma_{1}\\,u_{1}\\,v_{1}^{\\top}$，残差定义为 $R=X-\\widehat{X}_{1}$。仅使用基本定义和结果，计算弗罗贝尼乌斯范数 $\\|R\\|_{F}$。\n\n你的最终答案应为等于 $\\|R\\|_{F}$ 的单个实数。如果你选择对任何中间量进行近似，请将最终答案四舍五入到四位有效数字。最终答案不应包含单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 背景是平面应变岩土力学边值问题的有限元模拟。\n- 快照矩阵为 $X=\\begin{bmatrix}1  1  0\\\\ 0  1  1\\end{bmatrix}$，是一个 $2 \\times 3$ 矩阵。各列代表 $3$ 个准静态加载步的离散位移向量。\n- 权重矩阵为 $W=I$，即 $2 \\times 2$ 的单位矩阵。内积为标准的欧几里得内积。\n- 第一POD模态 $u_{1}$ 被定义为在关于 $W$ 的归一化约束下，快照在 $u_{1}$ 上投影的均方值的约束最大化问题的解。\n- 任务要求：\n    1. 从第一性原理出发，推导当 $W=I$ 时的相关性特征问题。\n    2. 计算前两个POD模态 $u_{1}$ 和 $u_{2}$。\n    3. 计算相关的奇异值和右奇异向量。\n    4. 将最优秩一POD重构定义为 $\\widehat{X}_{1}=\\sigma_{1}\\,u_{1}\\,v_{1}^{\\top}$。\n    5. 计算残差 $R=X-\\widehat{X}_{1}$ 的弗罗贝尼乌斯范数，记为 $\\|R\\|_{F}$。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学性：** 该问题使用本征正交分解（POD），这是一种在计算力学（包括岩土力学）中广泛使用的标准模型降阶技术。通过变分原理的表述及其与奇异值分解（SVD）的联系是线性代数和数据分析中的基本概念。该问题基于已确立的数学原理。\n- **适定性：** 问题提供了所有必要信息（快照矩阵 $X$，权重矩阵 $W$），并要求计算具体的、可计算的量。矩阵维度是一致的。对于任何非零矩阵 $X$，POD模态（在符号上可能不同）和奇异值的存在性和唯一性是有保证的。\n- **客观性：** 问题以精确的数学语言陈述，没有歧义或主观论断。任务定义清晰。\n\n**第3步：结论与行动**\n该问题被认为是有效的，因为它具有科学性、适定性、客观性和自包含性。解法将如下推导。\n\n### 解题过程\n\n**第1部分：相关性特征问题的推导**\n\n第一POD模态 $u_1$ 的变分问题是在归一化约束下，最大化快照在向量 $u$ 上的均方投影。设快照数量为 $N_s = 3$。快照是矩阵 $X$ 的列，记为 $x_j \\in \\mathbb{R}^2$，$j=1, 2, 3$。\n\n快照 $x_j$ 在向量 $u$ 上的投影由内积 $\\langle x_j, u \\rangle_W = u^T W x_j$ 给出。由于 $W=I$，这就是标准的点积 $u^T x_j$。\n均方投影是需要最大化的目标函数：\n$$J(u) = \\frac{1}{N_s} \\sum_{j=1}^{N_s} (\\langle x_j, u \\rangle_W)^2 = \\frac{1}{3} \\sum_{j=1}^{3} (u^T x_j)^2$$\n归一化约束为 $\\langle u, u \\rangle_W = 1$，可简化为 $u^T W u = u^T I u = u^T u = 1$。\n\n我们可以用矩阵表示法重写目标函数：\n$$J(u) = \\frac{1}{3} \\sum_{j=1}^{3} (u^T x_j)(x_j^T u) = u^T \\left( \\frac{1}{3} \\sum_{j=1}^{3} x_j x_j^T \\right) u$$\n矩阵 $X$ 由 $X = \\begin{bmatrix} x_1  x_2  x_3 \\end{bmatrix}$ 给出。求和可以写成矩阵乘积 $XX^T = \\sum_{j=1}^{3} x_j x_j^T$。\n因此，目标函数为 $J(u) = u^T \\left(\\frac{1}{3} XX^T\\right) u$。\n\n我们使用拉格朗日乘子法来解决这个约束优化问题：最大化 $J(u)$，约束条件为 $g(u) = u^T u - 1 = 0$。\n拉格朗日函数为 $\\mathcal{L}(u, \\lambda) = J(u) - \\lambda g(u) = u^T \\left(\\frac{1}{3} XX^T\\right) u - \\lambda(u^T u - 1)$。\n为了找到驻点，我们对 $u$ 求梯度并令其为零：\n$$\\nabla_u \\mathcal{L} = 2 \\left(\\frac{1}{3} XX^T\\right) u - 2\\lambda u = 0$$\n这简化为特征问题：\n$$\\left(\\frac{1}{3} XX^T\\right) u = \\lambda u$$\n这就是相关性特征问题。矩阵 $C_X = \\frac{1}{3} XX^T$ 被称为空间相关矩阵。POD模态 $u_i$ 是 $C_X$ 的特征向量，相应的特征值 $\\lambda_i$ 代表每个模态捕获的平均能量。\n\n**第2部分：POD模态和奇异值的计算**\n\n首先，计算矩阵 $K = XX^T$：\n$$K = XX^T = \\begin{bmatrix}1  1  0\\\\ 0  1  1\\end{bmatrix} \\begin{bmatrix}1  0\\\\ 1  1\\\\ 0  1\\end{bmatrix} = \\begin{bmatrix} (1)(1)+(1)(1)+(0)(0)  (1)(0)+(1)(1)+(0)(1) \\\\ (0)(1)+(1)(1)+(1)(0)  (0)(0)+(1)(1)+(1)(1) \\end{bmatrix} = \\begin{bmatrix}2  1\\\\ 1  2\\end{bmatrix}$$\nPOD模态是 $C_X = \\frac{1}{3}K$ 的特征向量，这与 $K$ 的特征向量相同。设 $\\theta$ 为 $K$ 的特征值。特征方程为 $\\det(K - \\theta I) = 0$。\n$$\\det\\begin{pmatrix} 2-\\theta  1 \\\\ 1  2-\\theta \\end{pmatrix} = (2-\\theta)^2 - 1 = 0 \\implies \\theta^2 - 4\\theta + 3 = 0$$\n因式分解得到 $(\\theta-3)(\\theta-1)=0$。$K$ 的特征值为 $\\theta_1 = 3$ 和 $\\theta_2 = 1$，按大小降序排列。\n\n对于 $\\theta_1 = 3$：\n$$(K - 3I)u_1 = \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies -a+b=0 \\implies a=b$$\n未归一化的特征向量是 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。将其归一化：$u_1 = \\frac{1}{\\sqrt{1^2+1^2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。我们采用第一个非零元素为正的符号约定。\n\n对于 $\\theta_2 = 1$：\n$$(K - 1I)u_2 = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies a+b=0 \\implies a=-b$$\n未归一化的特征向量是 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。将其归一化：$u_2 = \\frac{1}{\\sqrt{1^2+(-1)^2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\nPOD模态为 $u_1 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $u_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\nPOD模态 $u_i$ 是 $X$ 的左奇异向量。奇异值 $\\sigma_i$ 与 $XX^T$ 的特征值 $\\theta_i$ 相关，关系为 $\\sigma_i = \\sqrt{\\theta_i}$。\n$$\\sigma_1 = \\sqrt{\\theta_1} = \\sqrt{3}$$\n$$\\sigma_2 = \\sqrt{\\theta_2} = \\sqrt{1} = 1$$\n\n**第3部分：右奇异向量的计算**\n\n右奇异向量 $v_i$ 是 SVD $X=U\\Sigma V^T$ 中矩阵 $V$ 的列。它们可以通过关系式 $v_i = \\frac{1}{\\sigma_i} X^T u_i$ 计算。\n对于 $v_1$：\n$$v_1 = \\frac{1}{\\sigma_1}X^T u_1 = \\frac{1}{\\sqrt{3}} \\begin{bmatrix}1  0\\\\ 1  1\\\\ 0  1\\end{bmatrix} \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\\right) = \\frac{1}{\\sqrt{6}} \\begin{bmatrix} 1 \\\\ 2 \\\\ 1 \\end{bmatrix}$$\n对于 $v_2$：\n$$v_2 = \\frac{1}{\\sigma_2}X^T u_2 = \\frac{1}{1} \\begin{bmatrix}1  0\\\\ 1  1\\\\ 0  1\\end{bmatrix} \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\\right) = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ 0 \\\\ -1 \\end{bmatrix}$$\n\n**第4部分：残差的弗罗贝尼乌斯范数计算**\n\n$X$ 的奇异值分解由 $X = \\sum_{i=1}^r \\sigma_i u_i v_i^T$ 给出，其中 $r = \\text{rank}(X)=2$。\n$$X = \\sigma_1 u_1 v_1^T + \\sigma_2 u_2 v_2^T$$\n最优秩一POD重构为 $\\widehat{X}_1 = \\sigma_1 u_1 v_1^T$。\n残差矩阵为 $R = X - \\widehat{X}_1$。\n$$R = (\\sigma_1 u_1 v_1^T + \\sigma_2 u_2 v_2^T) - \\sigma_1 u_1 v_1^T = \\sigma_2 u_2 v_2^T$$\n矩阵 $M$ 的弗罗贝尼乌斯范数为 $\\|M\\|_F = \\sqrt{\\text{Tr}(M^T M)}$。关于外积 $ab^T$ 的弗罗贝尼乌斯范数的一个基本结果是 $\\|ab^T\\|_F = \\|a\\|_2 \\|b\\|_2$，其中 $\\| \\cdot \\|_2$ 是标准的欧几里得向量范数。\n\n将此结果应用于残差矩阵 $R$：\n$$\\|R\\|_F = \\|\\sigma_2 u_2 v_2^T\\|_F = \\|\\sigma_2 u_2\\|_2 \\|v_2\\|_2$$\n由于 $\\sigma_2$ 是一个标量，所以 $\\|\\sigma_2 u_2\\|_2 = |\\sigma_2| \\|u_2\\|_2$。\n向量 $u_2$ 和 $v_2$ 是奇异向量，根据构造它们是标准正交的。因此，$\\|u_2\\|_2 = 1$ 且 $\\|v_2\\|_2 = 1$。\n$$\\|R\\|_F = \\sigma_2 \\cdot 1 \\cdot 1 = \\sigma_2$$\n我们发现第二个奇异值为 $\\sigma_2=1$。\n因此，残差的弗罗贝尼乌斯范数为：\n$$\\|R\\|_F = 1$$\n\n作为验证，我们可以显式计算 $R$：\n$$R = \\sigma_2 u_2 v_2^T = 1 \\cdot \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\\right) \\cdot \\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  0  -1 \\end{pmatrix}\\right) = \\frac{1}{2}\\begin{pmatrix} 1  0  -1\\\\ -1  0  1\\end{pmatrix}$$\n弗罗贝尼乌斯范数的平方是其所有元素平方的总和：\n$$\\|R\\|_F^2 = \\left(\\frac{1}{2}\\right)^2 + 0^2 + \\left(-\\frac{1}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2 + 0^2 + \\left(\\frac{1}{2}\\right)^2$$\n$$\\|R\\|_F^2 = \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4} = 4 \\cdot \\frac{1}{4} = 1$$\n因此，$\\|R\\|_F = \\sqrt{1} = 1$。这证实了结果。最终答案是一个精确的整数，因此不需要四舍五入。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "一旦确定了POD基向量（即模态），它们就构成了一个可用于近似系统行为的低维子空间。本实践练习演示了如何利用这个基通过伽辽金投影（Galerkin projection）构建降阶模型（ROM）。您将看到原始的高维控制方程如何被投影到POD子空间上，从而得到一个规模小得多、计算效率更高的方程组进行求解。",
            "id": "3553438",
            "problem": "一个通过有限元法离散化的线性、准静态地质力学模型可导出代数系统 $K u = f$，其中 $K \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定刚度矩阵，$f \\in \\mathbb{R}^{n}$ 是载荷向量。通过本征正交分解（POD）构建一个降阶模型，该模型使用单个试验基向量 $V \\in \\mathbb{R}^{n \\times 1}$，此向量已根据由对称正定矩阵 $W \\in \\mathbb{R}^{n \\times n}$ 诱导的加权内积进行了归一化。近似位移被参数化为 $u \\approx \\bar{u} + V a$，其中 $\\bar{u} \\in \\mathbb{R}^{n}$ 是一个基准场，$a \\in \\mathbb{R}$ 是降阶坐标。通过强制要求残差 $r(u) = K u - f$ 相对于 W-加权内积与测试空间正交，来获得降阶方程。\n\n考虑一个 $n=2$ 的示例模型，\n$$\nK=\\begin{bmatrix}2  -1\\\\ -1  2\\end{bmatrix}, \n\\qquad \nf=\\begin{bmatrix}1\\\\ 0\\end{bmatrix},\n\\qquad \n\\bar{u}=\\begin{bmatrix}0\\\\ 0\\end{bmatrix},\n\\qquad\nV=\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1\\\\ 1\\end{bmatrix},\n\\qquad\nW=I,\n$$\n其中 $I$ 是单位矩阵。使用关于 W-加权内积的残差正交性条件，推导降阶标量平衡方程，计算降阶算子，并求解降阶系数 $a$。\n\n最终答案只需给出 $a$ 的值。无需单位。请勿对答案进行四舍五入；请提供精确值。",
            "solution": "用户提供的问题已经过验证，被确定为计算力学中的一个有效的、适定的问题。所有提供的数据都是自洽且一致的。\n\n该问题要求解一个通过本征正交分解（POD）和 Galerkin 投影获得的降阶模型。近似位移场 $u \\in \\mathbb{R}^{n}$ 被参数化为基准场 $\\bar{u} \\in \\mathbb{R}^{n}$ 和单个试验基向量 $V \\in \\mathbb{R}^{n \\times 1}$ 的线性组合：\n$$u \\approx \\bar{u} + V a$$\n其中 $a \\in \\mathbb{R}$ 是待求的降阶坐标。\n\n全阶模型是线性代数系统 $K u = f$。对于给定的近似位移 $u$，其残差定义为：\n$$r(u) = K u - f$$\n将 $u$ 的参数化近似代入，残差变为 $a$ 的函数：\n$$r(a) = K(\\bar{u} + V a) - f = K \\bar{u} + (K V) a - f$$\n\n降阶模型通过强制执行 Galerkin 条件来推导，该条件规定残差必须与测试空间正交。在此问题中，测试空间由相同的基向量 $V$ 张成，正交性是关于 W-加权内积定义的。两个向量 $x, y \\in \\mathbb{R}^{n}$ 的内积为 $(x, y)_W = x^T W y$。因此，正交性条件为：\n$$(V, r(a))_W = 0$$\n其矩阵形式为：\n$$V^T W r(a) = 0$$\n代入残差 $r(a)$ 的表达式：\n$$V^T W (K \\bar{u} + (K V) a - f) = 0$$\n展开 $V^T W$ 项，我们得到关于 $a$ 的标量线性方程：\n$$V^T W K \\bar{u} + (V^T W K V) a - V^T W f = 0$$\n重新整理此方程以求解 $a$，得到一般降阶方程：\n$$(V^T W K V) a = V^T W f - V^T W K \\bar{u}$$\n该方程的形式为 $K_r a = f_r$，其中 $K_r$ 是降阶刚度，$f_r$ 是降阶力项。\n\n对于所提供的特定示例模型，参数为：\n$n=2$\n$$\nK=\\begin{bmatrix}2  -1\\\\ -1  2\\end{bmatrix}, \n\\quad \nf=\\begin{bmatrix}1\\\\ 0\\end{bmatrix},\n\\quad \n\\bar{u}=\\begin{bmatrix}0\\\\ 0\\end{bmatrix},\n\\quad\nV=\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1\\\\ 1\\end{bmatrix},\n\\quad\nW=I=\\begin{bmatrix}1  0\\\\ 0  1\\end{bmatrix}\n$$\n由于 $\\bar{u}$ 是零向量，项 $V^T W K \\bar{u}$ 为零，降阶方程简化为：\n$$(V^T W K V) a = V^T W f$$\n\n首先，我们计算降阶刚度算子 $K_r = V^T W K V$。由于 $W=I$，因此 $K_r = V^T K V$：\n$$K_r = \\left(\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1  1\\end{bmatrix}\\right) \\begin{bmatrix}2  -1\\\\ -1  2\\end{bmatrix} \\left(\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1\\\\ 1\\end{bmatrix}\\right)$$\n$$K_r = \\frac{1}{2} \\begin{bmatrix}1  1\\end{bmatrix} \\left(\\begin{bmatrix}2  -1\\\\ -1  2\\end{bmatrix} \\begin{bmatrix}1\\\\ 1\\end{bmatrix}\\right)$$\n$$K_r = \\frac{1}{2} \\begin{bmatrix}1  1\\end{bmatrix} \\begin{bmatrix}2(1) - 1(1) \\\\ -1(1) + 2(1)\\end{bmatrix} = \\frac{1}{2} \\begin{bmatrix}1  1\\end{bmatrix} \\begin{bmatrix}1\\\\ 1\\end{bmatrix}$$\n$$K_r = \\frac{1}{2} (1 \\cdot 1 + 1 \\cdot 1) = \\frac{1}{2}(2) = 1$$\n\n接下来，我们计算降阶力算子 $f_r = V^T W f$。由于 $W=I$，因此 $f_r = V^T f$：\n$$f_r = \\left(\\frac{1}{\\sqrt{2}}\\begin{bmatrix}1  1\\end{bmatrix}\\right) \\begin{bmatrix}1\\\\ 0\\end{bmatrix}$$\n$$f_r = \\frac{1}{\\sqrt{2}} (1 \\cdot 1 + 1 \\cdot 0) = \\frac{1}{\\sqrt{2}}$$\n\n因此，降阶标量平衡方程 $K_r a = f_r$ 为：\n$$1 \\cdot a = \\frac{1}{\\sqrt{2}}$$\n\n求解降阶坐标 $a$，我们得到：\n$$a = \\frac{1}{\\sqrt{2}}$$",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$"
        },
        {
            "introduction": "在构建基于POD的降阶模型时，一个关键决策是选择模态的数量，即模型的阶数$r$。这个选择代表了模型精度与计算成本之间的权衡。本练习侧重于先验误差估计，展示了奇异值谱如何直接量化近似误差，并允许我们选择满足给定误差容限所需的最小模态数。",
            "id": "3553439",
            "problem": "考虑在一个饱和、各向异性黏土层中进行准静态固结的有限元模拟。状态变量是在 $m$ 个离散荷载步下采样的位移场，形成一个快照矩阵 $X \\in \\mathbb{R}^{n \\times m}$。为了反映计算岩土力学中使用的能量内积，设 $W \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定矩阵，该矩阵诱导出加权内积 $\\langle u, v \\rangle_{W} = u^{\\top} W v$。定义 $W$ 加权快照矩阵为 $X_{W} = W^{1/2} X$。在 $W$ 内积下的本征正交分解（Proper Orthogonal Decomposition, POD）通过对 $X_{W}$ 进行奇异值分解得到。\n\n从基本原理出发，利用奇异向量的正交性以及秩-$r$ 投影在Frobenius范数下的最优性，推导最佳秩-$r$ $W$ 正交投影的时间平均截断误差的表达式，该表达式应使用 $X_{W}$ 的奇异值 $\\{\\sigma_{j}\\}$ 来表示。然后，利用所提供的数据，计算该误差界，并确定能达到指定相对容差的最小 $r$ 值。\n\n$W$ 加权快照矩阵 $X_{W}$ 的奇异值为\n$$\n\\{\\sigma_{j}\\}_{j=1}^{12} = \\{6.0,\\; 3.5,\\; 2.1,\\; 1.4,\\; 1.0,\\; 0.72,\\; 0.52,\\; 0.36,\\; 0.25,\\; 0.18,\\; 0.12,\\; 0.08\\}。\n$$\n假设有 $m = 40$ 个快照，且 $\\varepsilon = 1.0 \\times 10^{-2}$。令截断误差界为\n$$\n\\eta_{r} = \\sqrt{\\frac{1}{m} \\sum_{j=r+1}^{\\min(n,m)} \\sigma_{j}^{2}}，\n$$\n相对容差准则为\n$$\n\\frac{\\eta_{r}}{\\|X_{W}\\|_{F}} \\le \\varepsilon，\n$$\n其中 $\\|X_{W}\\|_{F}$ 表示Frobenius范数。\n\n报告满足容差要求的最小整数 $r$，以及对应的截断误差界 $\\eta_{r}$ 和达到的相对界 $\\eta_{r}/\\|X_{W}\\|_{F}$。将后两个量四舍五入至四位有效数字。将最终的无量纲比率表示为纯数字，不带百分号。",
            "solution": "用户提供了一个来自计算岩土力学领域关于本征正交分解（POD）的问题，要求推导截断误差，然后进行数值计算以确定所需的模型阶数。\n\n**问题验证**\n\n首先，对问题陈述进行验证。\n\n*   **提取的已知条件**：\n    1.  背景为准静态固结模拟，快照矩阵为 $X \\in \\mathbb{R}^{n \\times m}$。\n    2.  定义了一个能量内积 $\\langle u, v \\rangle_{W} = u^{\\top} W v$，其中 $W$ 是一个对称正定矩阵。\n    3.  $W$加权快照矩阵为 $X_{W} = W^{1/2} X$。\n    4.  $W$内积下的POD通过对 $X_{W}$ 进行奇异值分解（SVD）获得。\n    5.  $X_W$的奇异值：$\\{\\sigma_{j}\\}_{j=1}^{12} = \\{6.0,\\; 3.5,\\; 2.1,\\; 1.4,\\; 1.0,\\; 0.72,\\; 0.52,\\; 0.36,\\; 0.25,\\; 0.18,\\; 0.12,\\; 0.08\\}$。$X_W$的秩为$12$。\n    6.  快照数量：$m = 40$。\n    7.  指定的相对容差：$\\varepsilon = 1.0 \\times 10^{-2}$。\n    8.  截断误差界定义：$\\eta_{r} = \\sqrt{\\frac{1}{m} \\sum_{j=r+1}^{\\min(n,m)} \\sigma_{j}^{2}}$。\n    9.  相对容差准则：$\\frac{\\eta_{r}}{\\|X_{W}\\|_{F}} \\le \\varepsilon$。\n*   **验证检查**：\n    - **科学依据**：该问题在POD降阶模型理论中有充分依据，特别是在有限元分析中的应用。使用加权范数（能量范数）是力学中的标准严谨做法。所有概念在科学上都是合理的。\n    - **良定性**：问题陈述清晰。它要求进行标准推导，然后进行计算，所有必要的数据和公式均已提供。存在唯一解。\n    - **客观性**：语言精确且数学化，没有主观因素。\n    - **完整性**：问题是自洽的。虽然没有给出用奇异值表示Frobenius范数的公式，但这属于该主题应具备的基础知识。\n    - **现实性**：问题的背景和数据（递减的奇异值）对于工程应用来说是现实的。\n\n*   **结论**：该问题是**有效的**。\n\n**第一部分：截断误差的推导**\n\n目标是求出用秩为 $r$ 的截断POD基来近似完整快照集时产生的误差。快照是矩阵 $X$ 的列，记为 $\\{x_k\\}_{k=1}^m$。误差由矩阵 $W$ 诱导的能量范数来衡量。\n\nPOD基向量 $\\{\\phi_j\\}_{j=1}^{\\text{rank}(X)}$ 是一组最适合表示快照集的向量。在 $W$ 内积下，这些基向量是 $W$ 正交的：$\\langle\\phi_i, \\phi_j\\rangle_W = \\phi_i^\\top W \\phi_j = \\delta_{ij}$（对于归一化基）。一个快照 $x_k$ 在由前 $r$ 个基向量张成的子空间上的投影由下式给出：\n$$\nx_{k,r} = \\sum_{j=1}^{r} \\langle x_k, \\phi_j \\rangle_W \\phi_j\n$$\n对所有快照求和的总投影误差的平方为\n$$\nE_r = \\sum_{k=1}^{m} \\|x_k - x_{k,r}\\|_W^2 = \\sum_{k=1}^{m} \\langle x_k - x_{k,r}, x_k - x_{k,r} \\rangle_W\n$$\n利用 $W$ 内积的定义，这可以改写为使用标准的欧几里得$2$-范数：\n$$\nE_r = \\sum_{k=1}^{m} (x_k - x_{k,r})^\\top W (x_k - x_{k,r}) = \\sum_{k=1}^{m} \\| W^{1/2}(x_k - x_{k,r}) \\|_2^2\n$$\n“快照法”通过对加权快照矩阵 $X_W = W^{1/2} X$ 进行SVD来找到POD基。设 $X_W$ 的SVD为：\n$$\nX_W = U \\Sigma V^\\top\n$$\n其中 $U \\in \\mathbb{R}^{n \\times n}$ 和 $V \\in \\mathbb{R}^{m \\times m}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{n \\times m}$ 是由奇异值 $\\sigma_j \\ge 0$ 构成的对角矩阵。$U$的列 $\\{u_j\\}$ 是左奇异向量，在加权空间中被称为POD模态。原始的POD基向量是 $\\phi_j = W^{-1/2} u_j$。\n\n项 $W^{1/2}x_k$ 是 $X_W$ 的第 $k$ 列。投影 $x_{k,r}$ 变换为：\n$$\nW^{1/2} x_{k,r} = W^{1/2} \\sum_{j=1}^{r} (x_k^\\top W \\phi_j) \\phi_j = \\sum_{j=1}^{r} ((W^{1/2}x_k)^\\top (W^{1/2}\\phi_j)) (W^{1/2}\\phi_j) = \\sum_{j=1}^{r} (y_k^\\top u_j) u_j\n$$\n其中 $y_k = W^{1/2}x_k$ 是 $X_W$ 的第 $k$ 列。这是 $y_k$ 在由 $\\{u_j\\}_{j=1}^r$ 张成的子空间上的欧几里得投影。该投影可以写成 $U_r U_r^\\top y_k$，其中 $U_r$ 是包含 $U$ 的前 $r$ 列的矩阵。\n\n总误差 $E_r$ 是矩阵 $X_W$ 与其在前 $r$ 个左奇异向量张成的子空间上的投影之差的Frobenius范数的平方：\n$$\nE_r = \\sum_{k=1}^{m} \\|y_k - U_r U_r^\\top y_k\\|_2^2 = \\|X_W - U_r U_r^\\top X_W\\|_F^2\n$$\n根据Eckart-Young-Mirsky定理，在Frobenius范数下，$X_W$ 的最佳秩-$r$ 近似是截断SVD，$X_{W,r} = U_r \\Sigma_r V_r^\\top$，其中 $\\Sigma_r$ 包含前 $r$ 个奇异值。可以证明 $U_r U_r^\\top X_W = X_{W,r}$。因此，误差为：\n$$\nE_r = \\|X_W - X_{W,r}\\|_F^2\n$$\n利用 $X_W$ 的SVD，误差矩阵为：\n$$\nX_W - X_{W,r} = U \\Sigma V^\\top - U_r \\Sigma_r V_r^\\top = \\sum_{j=1}^{\\text{rank}(X_W)} \\sigma_j u_j v_j^\\top - \\sum_{j=1}^{r} \\sigma_j u_j v_j^\\top = \\sum_{j=r+1}^{\\text{rank}(X_W)} \\sigma_j u_j v_j^\\top\n$$\nFrobenius范数在正交变换下是不变的，所以：\n$$\nE_r = \\|X_W - X_{W,r}\\|_F^2 = \\left\\| U^\\top (X_W - X_{W,r}) V \\right\\|_F^2 = \\left\\| \\Sigma - \\begin{pmatrix} \\Sigma_r  0 \\\\ 0  0 \\end{pmatrix} \\right\\|_F^2 = \\sum_{j=r+1}^{\\text{rank}(X_W)} \\sigma_j^2\n$$\n问题将时间平均截断误差界 $\\eta_r$ 定义为 $m$ 个快照上的均方根误差：\n$$\n\\eta_r^2 = \\frac{1}{m} E_r = \\frac{1}{m} \\sum_{j=r+1}^{\\min(n,m)} \\sigma_j^2\n$$\n取平方根得到所需的表达式：\n$$\n\\eta_r = \\sqrt{\\frac{1}{m} \\sum_{j=r+1}^{\\min(n,m)} \\sigma_j^2}\n$$\n推导完毕。\n\n**第二部分：数值计算**\n\n我们需要找到满足相对容差准则的最小整数 $r$：\n$$\n\\frac{\\eta_{r}}{\\|X_{W}\\|_{F}} \\le \\varepsilon\n$$\n给定数据：$m=40$，$\\varepsilon = 1.0 \\times 10^{-2}=0.01$，以及 $\\{\\sigma_{j}\\}_{j=1}^{12} = \\{6.0,\\; 3.5,\\; 2.1,\\; 1.4,\\; 1.0,\\; 0.72,\\; 0.52,\\; 0.36,\\; 0.25,\\; 0.18,\\; 0.12,\\; 0.08\\}$。$X_W$ 的秩为 $12$。\n\n首先，我们利用其奇异值计算 $X_W$ 的Frobenius范数的平方：\n$$\n\\|X_{W}\\|_{F}^2 = \\sum_{j=1}^{12} \\sigma_{j}^{2}\n$$\n奇异值的平方为：\n$\\sigma_1^2 = 6.0^2 = 36$\n$\\sigma_2^2 = 3.5^2 = 12.25$\n$\\sigma_3^2 = 2.1^2 = 4.41$\n$\\sigma_4^2 = 1.4^2 = 1.96$\n$\\sigma_5^2 = 1.0^2 = 1.0$\n$\\sigma_6^2 = 0.72^2 = 0.5184$\n$\\sigma_7^2 = 0.52^2 = 0.2704$\n$\\sigma_8^2 = 0.36^2 = 0.1296$\n$\\sigma_9^2 = 0.25^2 = 0.0625$\n$\\sigma_{10}^2 = 0.18^2 = 0.0324$\n$\\sigma_{11}^2 = 0.12^2 = 0.0144$\n$\\sigma_{12}^2 = 0.08^2 = 0.0064$\n\n将这些值相加得到：\n$$\n\\|X_{W}\\|_{F}^2 = 36 + 12.25 + 4.41 + 1.96 + 1.0 + 0.5184 + 0.2704 + 0.1296 + 0.0625 + 0.0324 + 0.0144 + 0.0064 = 56.6541\n$$\n所以，$\\|X_{W}\\|_{F} = \\sqrt{56.6541} \\approx 7.5268915$。\n\n容差准则可以改写为：\n$$\n\\eta_r^2 \\le \\varepsilon^2 \\|X_{W}\\|_F^2\n$$\n$$\n\\frac{1}{m} \\sum_{j=r+1}^{12} \\sigma_j^2 \\le \\varepsilon^2 \\sum_{j=1}^{12} \\sigma_j^2\n$$\n代入数值：\n$$\n\\frac{1}{40} \\sum_{j=r+1}^{12} \\sigma_j^2 \\le (0.01)^2 \\times 56.6541\n$$\n$$\n\\sum_{j=r+1}^{12} \\sigma_j^2 \\le 40 \\times 0.0001 \\times 56.6541 = 0.2266164\n$$\n我们需要找到满足此条件的最小整数 $r$。我们计算尾部奇异值平方和，$S_r = \\sum_{j=r+1}^{12} \\sigma_j^2$。\n让我们从一个较大的 $r$ 值开始测试：\n对于 $r=8$：$S_8 = \\sum_{j=9}^{12} \\sigma_j^2 = \\sigma_9^2+\\sigma_{10}^2+\\sigma_{11}^2+\\sigma_{12}^2 = 0.0625 + 0.0324 + 0.0144 + 0.0064 = 0.1157$。\n由于 $0.1157 \\le 0.2266164$，因此 $r=8$ 满足准则。\n\n我们测试 $r=7$ 以确保 $r=8$ 是最小整数：\n对于 $r=7$：$S_7 = \\sum_{j=8}^{12} \\sigma_j^2 = \\sigma_8^2 + S_8 = 0.1296 + 0.1157 = 0.2453$。\n由于 $0.2453 > 0.2266164$，因此 $r=7$ 不满足准则。\n\n因此，满足容差的最小整数 $r$ 是 $r=8$。\n\n最后，我们计算截断误差界 $\\eta_8$ 和达到的相对界 $\\eta_8/\\|X_{W}\\|_F$。\n$$\n\\eta_8 = \\sqrt{\\frac{1}{m} \\sum_{j=9}^{12} \\sigma_j^2} = \\sqrt{\\frac{0.1157}{40}} = \\sqrt{0.0028925} \\approx 0.05378196...\n$$\n四舍五入至四位有效数字，$\\eta_8 = 0.05378$。\n\n达到的相对界为：\n$$\n\\frac{\\eta_8}{\\|X_{W}\\|_F} = \\frac{0.05378196...}{7.5268915...} \\approx 0.0071454...\n$$\n四舍五入至四位有效数字，相对界为 $0.007145$。该值确实小于或等于指定的容差 $\\varepsilon=0.01$。\n\n所要求的量为：\n- 最小整数 $r$：$8$\n- 截断误差界 $\\eta_r$：$0.05378$\n- 达到的相对界 $\\eta_r/\\|X_W\\|_F$：$0.007145$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8  0.05378  0.007145\n\\end{pmatrix}\n}\n$$"
        }
    ]
}