{
    "hands_on_practices": [
        {
            "introduction": "Before applying any plasticity model, one must first be able to characterize the stress state. This exercise provides essential practice in calculating key stress invariants—the mean stress $p$, the deviatoric stress measure $q$, and the Lode angle $\\theta$—from a given Cauchy stress tensor. Mastering this calculation is fundamental, as these invariants form the coordinate system for visualizing and evaluating pressure-dependent yield criteria common for geomaterials. ",
            "id": "3525005",
            "problem": "Consider a homogeneous geomaterial undergoing finite deformation where the stress measure is the Cauchy stress tensor. Assume compressive stresses are taken as positive and the Cauchy stress tensor is symmetric. You are given the Cauchy stress tensor in the current configuration\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n80 & 20 & 0 \\\\\n20 & 80 & 0 \\\\\n0 & 0 & 60\n\\end{pmatrix}\n\\ \\text{MPa}.\n$$\nUsing the standard stress invariants of the Cauchy stress in computational geomechanics, compute the mean stress $p$, the deviatoric stress measure $q$, and the Lode angle $\\theta$ associated with the deviatoric stress. Then classify the loading path as triaxial compression, triaxial extension, or pure shear. For the classification, report a numeric code $C$ according to the following convention: $C=+1$ for triaxial compression, $C=-1$ for triaxial extension, and $C=0$ for pure shear.\n\nExpress $p$ and $q$ in $\\text{MPa}$ and $\\theta$ in radians. No rounding is required; provide exact values if they arise naturally. Present your final answer as a single row matrix containing $p$, $q$, $\\theta$, and $C$, in that order.",
            "solution": "The Cauchy stress tensor $\\boldsymbol{\\sigma}$ is symmetric and real, so it admits an orthonormal set of eigenvectors and real eigenvalues, which are the principal stresses. For a symmetric block matrix of the form\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n80 & 20 & 0 \\\\\n20 & 80 & 0 \\\\\n0 & 0 & 60\n\\end{pmatrix},\n$$\nthe upper $2\\times 2$ block has eigenvalues obtained by solving\n$$\n\\det\\!\\left(\\begin{pmatrix}80 & 20 \\\\ 20 & 80\\end{pmatrix} - \\lambda \\begin{pmatrix}1 & 0 \\\\ 0 & 1\\end{pmatrix}\\right) = 0,\n$$\nwhich gives $(80-\\lambda)^{2} - 20^{2} = 0$ and hence $\\lambda = 100$ and $\\lambda = 60$. The decoupled $(3,3)$ component is $60$. Therefore, the principal stresses are\n$$\n\\sigma_{1} = 100,\\quad \\sigma_{2} = 60,\\quad \\sigma_{3} = 60\n$$\nin $\\text{MPa}$, ordered as $\\sigma_{1} \\geq \\sigma_{2} \\geq \\sigma_{3}$.\n\nThe mean stress $p$ is defined as one-third of the first invariant of $\\boldsymbol{\\sigma}$,\n$$\np = \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma}) = \\frac{\\sigma_{1} + \\sigma_{2} + \\sigma_{3}}{3} = \\frac{100 + 60 + 60}{3} = \\frac{220}{3}.\n$$\n\nTo obtain the deviatoric stress measure $q$, we first form the deviatoric stress tensor $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\,\\boldsymbol{I}$, which in principal components yields\n$$\ns_{1} = \\sigma_{1} - p = 100 - \\frac{220}{3} = \\frac{80}{3},\\quad\ns_{2} = \\sigma_{2} - p = 60 - \\frac{220}{3} = -\\frac{40}{3},\\quad\ns_{3} = \\sigma_{3} - p = 60 - \\frac{220}{3} = -\\frac{40}{3}.\n$$\nThese components satisfy $s_{1} + s_{2} + s_{3} = 0$ as required. The second invariant of $\\boldsymbol{s}$ is\n$$\nJ_{2} = \\frac{1}{2}\\,\\boldsymbol{s}:\\boldsymbol{s} = \\frac{1}{2}\\left(s_{1}^{2} + s_{2}^{2} + s_{3}^{2}\\right) = \\frac{1}{2}\\left(\\left(\\frac{80}{3}\\right)^{2} + 2\\left(\\frac{40}{3}\\right)^{2}\\right) = \\frac{1600}{3}.\n$$\nThe deviatoric stress measure $q$ is then\n$$\nq = \\sqrt{3\\,J_{2}} = \\sqrt{3 \\cdot \\frac{1600}{3}} = \\sqrt{1600} = 40.\n$$\n\nThe Lode angle $\\theta$ characterizes the position on the deviatoric plane and is obtained from the third invariant of $\\boldsymbol{s}$,\n$$\nJ_{3} = \\det(\\boldsymbol{s}) = s_{1}\\,s_{2}\\,s_{3} = \\left(\\frac{80}{3}\\right)\\left(-\\frac{40}{3}\\right)\\left(-\\frac{40}{3}\\right) = \\frac{128000}{27}.\n$$\nDefine the Lode parameter\n$$\n\\mu = \\frac{3\\sqrt{3}}{2}\\,\\frac{J_{3}}{J_{2}^{3/2}},\n$$\nwith the Lode angle given by\n$$\n\\theta = \\frac{1}{3}\\,\\arcsin(\\mu),\n$$\nwhich yields values in the interval $-\\frac{\\pi}{6} \\leq \\theta \\leq \\frac{\\pi}{6}$. Compute $J_{2}^{3/2}$:\n$$\nJ_{2}^{1/2} = \\sqrt{\\frac{1600}{3}} = \\frac{40}{\\sqrt{3}},\\quad\nJ_{2}^{3/2} = J_{2}\\,J_{2}^{1/2} = \\frac{1600}{3}\\cdot \\frac{40}{\\sqrt{3}} = \\frac{64000}{3\\sqrt{3}}.\n$$\nTherefore,\n$$\n\\mu = \\frac{3\\sqrt{3}}{2}\\,\\frac{\\frac{128000}{27}}{\\frac{64000}{3\\sqrt{3}}}\n= \\frac{3\\sqrt{3}}{2}\\cdot \\frac{128000}{27}\\cdot \\frac{3\\sqrt{3}}{64000}\n= \\frac{9}{2}\\cdot \\frac{2}{27} = 1,\n$$\nand hence\n$$\n\\theta = \\frac{1}{3}\\,\\arcsin(1) = \\frac{\\pi}{6}.\n$$\n\nThe classification follows from the Lode angle: $\\theta = \\frac{\\pi}{6}$ corresponds to an axisymmetric compression (triaxial compression) state because two minor principal stresses are equal ($\\sigma_{2} = \\sigma_{3}$) and the Lode parameter attains its positive extremum. Therefore, the classification code is $C = +1$.\n\nCollecting the results in the requested order and units, we have $p = \\frac{220}{3}\\ \\text{MPa}$, $q = 40\\ \\text{MPa}$, $\\theta = \\frac{\\pi}{6}\\ \\text{rad}$, and $C = +1$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{220}{3} & 40 & \\frac{\\pi}{6} & 1\\end{pmatrix}}$$"
        },
        {
            "introduction": "With the stress state quantified, the next step is to apply the 'rules of the game' that govern plastic behavior. This practice focuses on the heart of rate-independent plasticity: the Kuhn–Tucker loading/unloading conditions. By analyzing two distinct stress states, you will verify whether the material responds elastically or undergoes plastic deformation, a critical decision point in any computational algorithm, and connect this behavior to the physical principle of mechanical dissipation. ",
            "id": "3524975",
            "problem": "A granular geomaterial is modeled at finite strains using the multiplicative decomposition of the deformation gradient, with $\\mathbf{F} = \\mathbf{F}^{e}\\mathbf{F}^{p}$, where $\\mathbf{F}^{e}$ is the elastic part and $\\mathbf{F}^{p}$ is the plastic part. Work-conjugate stress and strain-rate measures are adopted such that the mechanical dissipation rate is $D = \\boldsymbol{\\tau} : \\mathbf{d}^{p}$, where $\\boldsymbol{\\tau}$ is the Kirchhoff stress and $\\mathbf{d}^{p}$ is the plastic rate-of-deformation tensor. The material follows a rate-independent non-associated Drucker–Prager type model, with yield function $f(\\boldsymbol{\\tau}) = \\alpha\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})} - k \\le 0$, and plastic potential $g(\\boldsymbol{\\tau}) = \\alpha_{g}\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})}$. Here $I_{1}(\\boldsymbol{\\tau}) = \\operatorname{tr}(\\boldsymbol{\\tau})$, $J_{2}(\\boldsymbol{\\tau}) = \\tfrac{1}{2}\\,\\mathbf{s}:\\mathbf{s}$ with $\\mathbf{s} = \\boldsymbol{\\tau} - \\tfrac{1}{3}I_{1}(\\boldsymbol{\\tau})\\,\\mathbf{I}$ the deviatoric Kirchhoff stress, and $\\mathbf{I}$ the second-order identity tensor. The normality flow rule is $\\mathbf{d}^{p} = \\dot{\\lambda}\\,\\dfrac{\\partial g}{\\partial \\boldsymbol{\\tau}}$, where $\\dot{\\lambda}$ is the plastic multiplier. The Kuhn–Tucker conditions are $\\dot{\\lambda} \\ge 0$, $f \\le 0$, and $\\dot{\\lambda}\\,f = 0$.\n\nConsider two instantaneous states of stress for a single time increment:\n- State A (unloading candidate): $\\boldsymbol{\\tau}^{A} = \\operatorname{diag}(50,\\,50,\\,50)\\,\\text{MPa}$, with material parameters $\\alpha = 0.1$, $\\alpha_{g} = 0.08$, and $k = 21 + 10\\sqrt{3}\\,\\text{MPa}$. Let $\\dot{\\lambda}^{A} = 0$.\n- State B (loading candidate): $\\boldsymbol{\\tau}^{B} = \\operatorname{diag}(90,\\,60,\\,60)\\,\\text{MPa}$, with the same material parameters $\\alpha = 0.1$, $\\alpha_{g} = 0.08$, and $k = 21 + 10\\sqrt{3}\\,\\text{MPa}$. The plastic multiplier is $\\dot{\\lambda}^{B} = 0.015\\,\\text{s}^{-1}$. The stress increment from State A to State B is $\\Delta\\boldsymbol{\\tau} = \\boldsymbol{\\tau}^{B} - \\boldsymbol{\\tau}^{A}$.\n\nTasks:\n1. Using only the definitions provided, compute the mechanical dissipation rate $D^{B} = \\boldsymbol{\\tau}^{B} : \\mathbf{d}^{p,B}$ for State B.\n2. Verify the Kuhn–Tucker conditions $\\dot{\\lambda} \\ge 0$, $f \\le 0$, and $\\dot{\\lambda}\\,f = 0$ for State A and for State B.\n3. Based on your verification, state whether State A corresponds to unloading and State B corresponds to loading, and check consistency by confirming that State A remains strictly inside the yield surface while State B lies on the yield surface.\n\nExpress the final dissipation rate $D^{B}$ in kilowatts per cubic meter, $\\text{kW/m}^{3}$, and round your answer to four significant figures. The final answer must be a single real-valued number.",
            "solution": "The solution requires analyzing two stress states, State A and State B, within the framework of a non-associated Drucker–Prager plasticity model. We will first verify the Kuhn–Tucker conditions for each state to determine if they correspond to elastic or plastic behavior (Task 2 and 3), and then compute the mechanical dissipation for the plastic state (Task 1).\n\nThe yield function is given by $f(\\boldsymbol{\\tau}) = \\alpha\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})} - k$, and the plastic potential is $g(\\boldsymbol{\\tau}) = \\alpha_{g}\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})}$. The Kuhn–Tucker conditions for rate-independent plasticity are:\n1.  Plastic multiplier non-negativity: $\\dot{\\lambda} \\ge 0$\n2.  Yield condition: $f \\le 0$\n3.  Consistency condition: $\\dot{\\lambda}\\,f = 0$\n\nThe material parameters are given as $\\alpha = 0.1$, $\\alpha_{g} = 0.08$, and $k = 21 + 10\\sqrt{3}\\,\\text{MPa}$.\n\n**Verification for State A (Unloading Candidate)**\n\nFor State A, the Kirchhoff stress tensor is $\\boldsymbol{\\tau}^{A} = \\operatorname{diag}(50,\\,50,\\,50)\\,\\text{MPa}$. The plastic multiplier is given as $\\dot{\\lambda}^{A} = 0$.\n\n1.  **Check Kuhn–Tucker Conditions:**\n    -   The condition $\\dot{\\lambda}^{A} \\ge 0$ is satisfied, as $\\dot{\\lambda}^{A} = 0$.\n    -   The consistency condition $\\dot{\\lambda}^{A}\\,f(\\boldsymbol{\\tau}^{A}) = 0$ is satisfied, as $0 \\cdot f(\\boldsymbol{\\tau}^{A}) = 0$.\n    -   We must verify the yield condition $f(\\boldsymbol{\\tau}^{A}) \\le 0$. To do this, we compute the stress invariants for $\\boldsymbol{\\tau}^{A}$.\n        -   The first invariant of stress is $I_{1}(\\boldsymbol{\\tau}^{A}) = \\operatorname{tr}(\\boldsymbol{\\tau}^{A}) = 50 + 50 + 50 = 150\\,\\text{MPa}$.\n        -   The mean stress is $p^{A} = \\frac{1}{3}I_{1}(\\boldsymbol{\\tau}^{A}) = \\frac{150}{3} = 50\\,\\text{MPa}$.\n        -   The deviatoric stress tensor is $\\mathbf{s}^{A} = \\boldsymbol{\\tau}^{A} - p^{A}\\mathbf{I} = \\operatorname{diag}(50, 50, 50) - 50\\,\\operatorname{diag}(1, 1, 1) = \\mathbf{0}$.\n        -   The second invariant of the deviatoric stress is $J_{2}(\\boldsymbol{\\tau}^{A}) = \\frac{1}{2}\\mathbf{s}^{A}:\\mathbf{s}^{A} = 0$.\n        -   Now we evaluate the yield function:\n            $$f(\\boldsymbol{\\tau}^{A}) = \\alpha\\,I_{1}(\\boldsymbol{\\tau}^{A}) + \\sqrt{J_{2}(\\boldsymbol{\\tau}^{A})} - k$$\n            $$f(\\boldsymbol{\\tau}^{A}) = 0.1 \\cdot (150) + \\sqrt{0} - (21 + 10\\sqrt{3}) = 15 - 21 - 10\\sqrt{3} = -6 - 10\\sqrt{3}\\,\\text{MPa}$$\n    -   Since $\\sqrt{3} > 0$, $f(\\boldsymbol{\\tau}^{A}) = -6 - 10\\sqrt{3}$ is strictly negative. Thus, the condition $f(\\boldsymbol{\\tau}^{A}) \\le 0$ is satisfied.\n\n2.  **Conclusion for State A:**\n    All Kuhn–Tucker conditions are satisfied. Since $f(\\boldsymbol{\\tau}^{A}) < 0$ and $\\dot{\\lambda}^{A} = 0$, State A represents an elastic state where the stress point lies strictly inside the yield surface. This is consistent with the description of an \"unloading candidate\".\n\n**Verification for State B (Loading Candidate)**\n\nFor State B, the Kirchhoff stress tensor is $\\boldsymbol{\\tau}^{B} = \\operatorname{diag}(90,\\,60,\\,60)\\,\\text{MPa}$. The plastic multiplier is given as $\\dot{\\lambda}^{B} = 0.015\\,\\text{s}^{-1}$.\n\n1.  **Check Kuhn–Tucker Conditions:**\n    -   The condition $\\dot{\\lambda}^{B} \\ge 0$ is satisfied, as $\\dot{\\lambda}^{B} = 0.015 > 0$.\n    -   For the consistency condition $\\dot{\\lambda}^{B}\\,f(\\boldsymbol{\\tau}^{B}) = 0$ to hold with $\\dot{\\lambda}^{B} > 0$, it must be that $f(\\boldsymbol{\\tau}^{B}) = 0$. This would also satisfy the yield condition $f(\\boldsymbol{\\tau}^{B}) \\le 0$. Let's verify this.\n        -   The first invariant of stress is $I_{1}(\\boldsymbol{\\tau}^{B}) = \\operatorname{tr}(\\boldsymbol{\\tau}^{B}) = 90 + 60 + 60 = 210\\,\\text{MPa}$.\n        -   The mean stress is $p^{B} = \\frac{1}{3}I_{1}(\\boldsymbol{\\tau}^{B}) = \\frac{210}{3} = 70\\,\\text{MPa}$.\n        -   The deviatoric stress tensor is $\\mathbf{s}^{B} = \\boldsymbol{\\tau}^{B} - p^{B}\\mathbf{I} = \\operatorname{diag}(90, 60, 60) - 70\\,\\operatorname{diag}(1, 1, 1) = \\operatorname{diag}(20, -10, -10)\\,\\text{MPa}$.\n        -   The second invariant of the deviatoric stress is:\n            $$J_{2}(\\boldsymbol{\\tau}^{B}) = \\frac{1}{2}\\mathbf{s}^{B}:\\mathbf{s}^{B} = \\frac{1}{2} \\left( (20)^{2} + (-10)^{2} + (-10)^{2} \\right) = \\frac{1}{2}(400 + 100 + 100) = 300\\,\\text{MPa}^{2}$$\n        -   Therefore, $\\sqrt{J_{2}(\\boldsymbol{\\tau}^{B})} = \\sqrt{300} = 10\\sqrt{3}\\,\\text{MPa}$.\n        -   Now we evaluate the yield function:\n            $$f(\\boldsymbol{\\tau}^{B}) = \\alpha\\,I_{1}(\\boldsymbol{\\tau}^{B}) + \\sqrt{J_{2}(\\boldsymbol{\\tau}^{B})} - k$$\n            $$f(\\boldsymbol{\\tau}^{B}) = 0.1 \\cdot (210) + 10\\sqrt{3} - (21 + 10\\sqrt{3}) = 21 + 10\\sqrt{3} - 21 - 10\\sqrt{3} = 0$$\n    -   Since $f(\\boldsymbol{\\tau}^{B})=0$, the yield condition $f \\le 0$ and the consistency condition $\\dot{\\lambda}^{B}\\,f(\\boldsymbol{\\tau}^{B}) = 0.015 \\cdot 0 = 0$ are both satisfied.\n\n2.  **Conclusion for State B:**\n    All Kuhn–Tucker conditions are satisfied. Since $f(\\boldsymbol{\\tau}^{B}) = 0$ and $\\dot{\\lambda}^{B} > 0$, State B represents a plastic loading state where the stress point lies on the yield surface and plastic deformation is occurring. This is consistent with the description of a \"loading candidate\". The consistency check required by Task 3 is thus confirmed: State A is an elastic state strictly within the yield surface, and State B is a plastic state on the yield surface.\n\n**Computation of Mechanical Dissipation Rate for State B (Task 1)**\n\nThe mechanical dissipation rate is given by $D = \\boldsymbol{\\tau} : \\mathbf{d}^{p}$. For State B, this is $D^{B} = \\boldsymbol{\\tau}^{B} : \\mathbf{d}^{p,B}$.\nThe plastic rate-of-deformation tensor, $\\mathbf{d}^{p,B}$, is defined by the non-associated normality flow rule:\n$$\\mathbf{d}^{p,B} = \\dot{\\lambda}^{B}\\,\\frac{\\partial g}{\\partial \\boldsymbol{\\tau}}\\bigg|_{\\boldsymbol{\\tau}=\\boldsymbol{\\tau}^{B}}$$\nThus, the dissipation rate can be written as:\n$$D^{B} = \\dot{\\lambda}^{B} \\left( \\boldsymbol{\\tau}^{B} : \\frac{\\partial g}{\\partial \\boldsymbol{\\tau}}\\bigg|_{\\boldsymbol{\\tau}=\\boldsymbol{\\tau}^{B}} \\right)$$\nLet's compute the inner product term. The gradient of the plastic potential $g(\\boldsymbol{\\tau}) = \\alpha_{g}\\,I_{1}(\\boldsymbol{\\tau}) + \\sqrt{J_{2}(\\boldsymbol{\\tau})}$ with respect to $\\boldsymbol{\\tau}$ is:\n$$\\frac{\\partial g}{\\partial \\boldsymbol{\\tau}} = \\alpha_{g}\\,\\frac{\\partial I_{1}}{\\partial \\boldsymbol{\\tau}} + \\frac{\\partial \\sqrt{J_{2}}}{\\partial \\boldsymbol{\\tau}} = \\alpha_{g}\\mathbf{I} + \\frac{1}{2\\sqrt{J_{2}}}\\frac{\\partial J_{2}}{\\partial \\boldsymbol{\\tau}}$$\nUsing the standard result $\\frac{\\partial J_{2}}{\\partial \\boldsymbol{\\tau}} = \\mathbf{s}$, we get:\n$$\\frac{\\partial g}{\\partial \\boldsymbol{\\tau}} = \\alpha_{g}\\mathbf{I} + \\frac{\\mathbf{s}}{2\\sqrt{J_{2}}}$$\nNow, we compute the tensor contraction $\\boldsymbol{\\tau} : \\frac{\\partial g}{\\partial \\boldsymbol{\\tau}}$:\n$$\\boldsymbol{\\tau} : \\left( \\alpha_{g}\\mathbf{I} + \\frac{\\mathbf{s}}{2\\sqrt{J_{2}}} \\right) = \\alpha_{g}(\\boldsymbol{\\tau}:\\mathbf{I}) + \\frac{\\boldsymbol{\\tau}:\\mathbf{s}}{2\\sqrt{J_{2}}}$$\nWe know that $\\boldsymbol{\\tau}:\\mathbf{I} = I_{1}$ and $\\boldsymbol{\\tau} = \\mathbf{s} + \\frac{1}{3}I_{1}\\mathbf{I}$. Therefore, $\\boldsymbol{\\tau}:\\mathbf{s} = (\\mathbf{s} + \\frac{1}{3}I_{1}\\mathbf{I}):\\mathbf{s} = \\mathbf{s}:\\mathbf{s} + \\frac{1}{3}I_{1}(\\mathbf{I}:\\mathbf{s})$. Since $\\mathbf{I}:\\mathbf{s} = \\operatorname{tr}(\\mathbf{s}) = 0$, we have $\\boldsymbol{\\tau}:\\mathbf{s} = \\mathbf{s}:\\mathbf{s} = 2J_{2}$.\nSubstituting this back, we get:\n$$\\boldsymbol{\\tau} : \\frac{\\partial g}{\\partial \\boldsymbol{\\tau}} = \\alpha_{g}I_{1} + \\frac{2J_{2}}{2\\sqrt{J_{2}}} = \\alpha_{g}I_{1} + \\sqrt{J_{2}} = g(\\boldsymbol{\\tau})$$\nSo, the dissipation is simply $D^{B} = \\dot{\\lambda}^{B}\\,g(\\boldsymbol{\\tau}^{B})$.\nWe can now substitute the values for State B: $\\alpha_g=0.08$, $I_{1}(\\boldsymbol{\\tau}^{B}) = 210\\,\\text{MPa}$, and $\\sqrt{J_{2}(\\boldsymbol{\\tau}^{B})} = 10\\sqrt{3}\\,\\text{MPa}$.\n$$g(\\boldsymbol{\\tau}^{B}) = 0.08 \\cdot (210) + 10\\sqrt{3} = 16.8 + 10\\sqrt{3}\\,\\text{MPa}$$\nThe dissipation rate is:\n$$D^{B} = \\dot{\\lambda}^{B} \\, g(\\boldsymbol{\\tau}^{B}) = 0.015\\,\\text{s}^{-1} \\cdot (16.8 + 10\\sqrt{3})\\,\\text{MPa}$$\n$$D^{B} = (0.015 \\cdot 16.8 + 0.015 \\cdot 10\\sqrt{3})\\,\\text{MPa}\\cdot\\text{s}^{-1} = (0.252 + 0.15\\sqrt{3})\\,\\text{MPa}\\cdot\\text{s}^{-1}$$\nTo get a numerical value:\n$$D^{B} \\approx 0.252 + 0.15 \\cdot 1.73205 = 0.252 + 0.2598075 = 0.5118075\\,\\text{MPa}\\cdot\\text{s}^{-1}$$\nThe problem asks for the answer in kilowatts per cubic meter ($\\text{kW/m}^{3}$). The unit conversion is:\n$$1\\,\\text{MPa}\\cdot\\text{s}^{-1} = 10^{6}\\,\\text{Pa}\\cdot\\text{s}^{-1} = 10^{6}\\,\\frac{\\text{N}}{\\text{m}^{2}}\\cdot\\text{s}^{-1} = 10^{6}\\,\\frac{\\text{J}}{\\text{m}^{3}}\\cdot\\text{s}^{-1} = 10^{6}\\,\\frac{\\text{W}}{\\text{m}^{3}} = 1000\\,\\frac{\\text{kW}}{\\text{m}^{3}}$$\nTherefore,\n$$D^{B} \\approx 0.5118075 \\times 1000\\,\\frac{\\text{kW}}{\\text{m}^{3}} = 511.8075\\,\\frac{\\text{kW}}{\\text{m}^{3}}$$\nRounding to four significant figures, we get $D^{B} = 511.8\\,\\text{kW/m}^{3}$.",
            "answer": "$$\\boxed{511.8}$$"
        },
        {
            "introduction": "The previous concepts are the building blocks for the numerical algorithms at the core of modern finite element simulations. This capstone exercise guides you through the implementation of a complete elastic-predictor plastic-corrector scheme, the most common method for integrating elasto-plastic constitutive laws. You will combine finite strain kinematics, a hyperelastic model, a Drucker–Prager yield criterion, and a return mapping algorithm to simulate the material response over a finite deformation step, translating theory into a functional code. ",
            "id": "3525032",
            "problem": "Consider an isotropic geomaterial modeled by a Drucker–Prager plasticity surface embedded in a finite strain framework with a hyperelastic elastic predictor and a plastic corrector in the pressure–deviatoric invariant space. The deformation is a single finite simple shear step with deformation gradient $F \\in \\mathbb{R}^{3 \\times 3}$ applied from an initially stress-free and undeformed state. The algorithm should compute the elastic trial stress from a compressible hyperelastic model, evaluate the Drucker–Prager yield function in terms of the invariants $p$ and $q$ of the Cauchy stress, and, if yielding occurs, perform a return mapping (plastic corrector) by projecting back to the Drucker–Prager cone in the $(p,q)$-plane using a backward-Euler algorithm with linear isotropic hardening. The internal variables are the accumulated equivalent plastic strain $r$ and the plastic volumetric strain $\\varepsilon_v^p$.\n\nUse the following fundamental bases and definitions.\n\n- Kinematics: The finite simple shear step is represented by the deformation gradient\n$$\nF = \\begin{bmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix},\n$$\nwith shear parameter $\\gamma \\ge 0$ (dimensionless). For this $F$, the Jacobian is $J = \\det F = 1$, and the left Cauchy-Green tensor is $b = F F^\\top$.\n\n- Elastic predictor: Use a compressible Neo-Hookean hyperelastic model defined by shear modulus $\\mu$ and bulk modulus $K$. Define the isochoric left Cauchy-Green tensor $\\bar b = J^{-2/3} b$. The Kirchhoff stress is\n$$\n\\tau^{\\mathrm{tr}} = \\mu\\, \\mathrm{dev}(\\bar b) + K \\ln J \\, \\mathbf{I},\n$$\nand the Cauchy stress is $\\sigma^{\\mathrm{tr}} = \\tau^{\\mathrm{tr}}/J$. Because $J = 1$ for the given simple shear, $\\sigma^{\\mathrm{tr}} = \\mu\\, \\mathrm{dev}(b)$. The material constants are related to Young’s modulus $E$ and Poisson’s ratio $\\nu$ by\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\qquad K = \\frac{E}{3(1-2\\nu)}.\n$$\n\n- Stress invariants and sign convention: Define pressure $p$ (positive in compression) and deviatoric invariant $q$ from the Cauchy stress $\\sigma$ as\n$$\np = -\\frac{1}{3} \\mathrm{tr}(\\sigma), \\qquad s = \\sigma + p \\mathbf{I}, \\qquad q = \\sqrt{\\frac{3}{2}\\, s:s}.\n$$\n\n- Drucker–Prager yield function with linear isotropic hardening:\n$$\nf(p,q,r) = q + \\beta\\, p - \\left(c_0 + H\\, r\\right),\n$$\nwhere $\\beta = \\dfrac{6 \\sin \\varphi}{3 - \\sin \\varphi}$ depends on the friction angle $\\varphi$ (in radians), $c_0 \\ge 0$ is the initial cohesion (in megapascals), $H \\ge 0$ is the linear hardening modulus (in megapascals), and $r$ is the accumulated equivalent plastic strain (dimensionless). The flow rule is non-associative in general, with plastic potential $g(p,q) = q + \\beta_g p$, where $\\beta_g = \\dfrac{6 \\sin \\psi}{3 - \\sin \\psi}$ depends on the dilation angle $\\psi$ (in radians). The internal variables update by backward-Euler as\n$$\nr_{n+1} = r_n + \\Delta \\lambda, \\qquad \\varepsilon_{v,n+1}^p = \\varepsilon_{v,n}^p + \\beta_g\\, \\Delta \\lambda,\n$$\nwith plastic multiplier $\\Delta \\lambda \\ge 0$.\n\n- Elastic-plastic corrector in $(p,q)$-space: Starting from the elastic predictor $(p^{\\mathrm{tr}},q^{\\mathrm{tr}})$, apply the backward-Euler return mapping in the $(p,q)$ space,\n$$\np_{n+1} = p^{\\mathrm{tr}} - K\\, \\beta_g\\, \\Delta \\lambda, \\qquad q_{n+1} = q^{\\mathrm{tr}} - 3 \\mu\\, \\Delta \\lambda,\n$$\nsubject to the consistency condition $f(p_{n+1},q_{n+1},r_{n+1}) = 0$. Solving for $\\Delta \\lambda$ gives\n$$\n\\Delta \\lambda =\n\\begin{cases}\n0, & \\text{if } f^{\\mathrm{tr}} \\le 0,\\\\\n\\dfrac{f^{\\mathrm{tr}}}{3\\mu + K \\beta \\beta_g + H}, & \\text{if } f^{\\mathrm{tr}} > 0,\n\\end{cases}\n\\quad \\text{where } f^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\beta p^{\\mathrm{tr}} - \\left(c_0 + H r_n\\right).\n$$\nThe deviatoric stress direction is preserved during the return, i.e., if $q^{\\mathrm{tr}} > 0$, then $s_{n+1} = \\dfrac{q_{n+1}}{q^{\\mathrm{tr}}} s^{\\mathrm{tr}}$; otherwise $s_{n+1} = \\mathbf{0}$. The Cauchy stress at the end of the step is $\\sigma_{n+1} = s_{n+1} - p_{n+1} \\mathbf{I}$.\n\nYour task is to implement a program that performs the above elastic predictor–plastic corrector for a single simple shear step for each of the test cases below and returns the final $(p,q)$ values after correction.\n\nAngle units must be in radians when used in trigonometric functions. Input friction and dilation angles will be specified in degrees in the test cases; convert to radians inside your program. All stresses, moduli, and cohesion/hardening parameters are in megapascals (MPa). The shear parameter $\\gamma$ is dimensionless. Express the final outputs $p$ and $q$ in megapascals (MPa). Round each output value to six decimal places.\n\nTest Suite:\nProvide results for the following cases, each starting from $r_n = 0$ and $\\varepsilon_{v,n}^p = 0$:\n\n- Case $1$ (elastic check): $E = 10000$ MPa, $\\nu = 0.30$, $\\varphi = 30$ degrees, $\\psi = 0$ degrees, $c_0 = 150$ MPa, $H = 100$ MPa, $\\gamma = 0.01$.\n- Case $2$ (plastic, non-associative): $E = 5000$ MPa, $\\nu = 0.30$, $\\varphi = 30$ degrees, $\\psi = 5$ degrees, $c_0 = 5$ MPa, $H = 50$ MPa, $\\gamma = 0.10$.\n- Case $3$ (perfectly plastic, frictional with zero cohesion): $E = 10000$ MPa, $\\nu = 0.20$, $\\varphi = 35$ degrees, $\\psi = 0$ degrees, $c_0 = 0$ MPa, $H = 0$ MPa, $\\gamma = 0.20$.\n- Case $4$ (boundary on yield, frictionless): $E = 6000$ MPa, $\\nu = 0.25$, $\\varphi = 0$ degrees, $\\psi = 0$ degrees, $c_0 = 41.568$ MPa, $H = 0$ MPa, $\\gamma = 0.01$.\n- Case $5$ (very large hardening, near-elastic response): $E = 8000$ MPa, $\\nu = 0.30$, $\\varphi = 25$ degrees, $\\psi = 10$ degrees, $c_0 = 1$ MPa, $H = 1000000$ MPa, $\\gamma = 0.20$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the flat order $[p_1,q_1,p_2,q_2,\\dots,p_5,q_5]$, where $p_i$ and $q_i$ are the final corrected values for Case $i$. Each number must be rounded to six decimals and expressed in MPa.",
            "solution": "The user has provided a problem in computational geomechanics, requiring the implementation of a finite strain elastic-predictor, plastic-corrector algorithm for a Drucker-Prager material model. The task is to calculate the final stress state, represented by pressure $p$ and deviatoric invariant $q$, after a single step of finite simple shear. The following exposition details the methodology, derived from the provided problem statement.\n\nThe algorithm proceeds in three main stages:\n1.  Calculation of material parameters from base properties.\n2.  The elastic predictor step, which computes a trial stress state assuming purely elastic behavior.\n3.  The plastic corrector step, which checks for yielding and, if it has occurred, returns the trial stress state to the yield surface.\n\nAll steps are performed for an initially undeformed, stress-free material, thus the initial values for the internal variables, accumulated equivalent plastic strain $r_n$ and plastic volumetric strain $\\varepsilon_{v,n}^p$, are zero.\n\n**1. Material Parameter Calculation**\n\nThe constitutive behavior is defined by a set of material parameters. Young’s modulus $E$ and Poisson’s ratio $\\nu$ are used to define the elastic shear modulus $\\mu$ and bulk modulus $K$:\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\qquad K = \\frac{E}{3(1-2\\nu)}\n$$\nThe Drucker-Prager yield surface and plastic potential are defined by the friction angle $\\varphi$ and dilation angle $\\psi$, respectively. These are used to calculate the dimensionless parameters $\\beta$ and $\\beta_g$:\n$$\n\\beta = \\frac{6 \\sin \\varphi}{3 - \\sin \\varphi}, \\qquad \\beta_g = \\frac{6 \\sin \\psi}{3 - \\sin \\psi}\n$$\nThe input angles in degrees must first be converted to radians for use in the trigonometric functions. The model also includes an initial cohesion $c_0$ and a linear hardening modulus $H$.\n\n**2. Elastic Predictor Step**\n\nThe deformation is a single finite simple shear step, defined by the deformation gradient $F$ with shear parameter $\\gamma$:\n$$\nF = \\begin{bmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\nThe determinant of $F$ is $J = \\det(F) = 1$, indicating an isochoric (volume-preserving) deformation. The left Cauchy-Green tensor $b$ is computed as $b = F F^\\top$:\n$$\nb = \\begin{bmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n\\begin{bmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n= \\begin{bmatrix} 1+\\gamma^2 & \\gamma & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}\n$$\nThe elastic predictor stress is given by the compressible Neo-Hookean model. Since $J=1$, the Kirchhoff stress $\\tau^{\\mathrm{tr}}$ and Cauchy stress $\\sigma^{\\mathrm{tr}}$ are identical, and simplify to:\n$$\n\\sigma^{\\mathrm{tr}} = \\mu\\, \\mathrm{dev}(b)\n$$\nwhere $\\mathrm{dev}(b) = b - \\frac{1}{3}\\mathrm{tr}(b)\\mathbf{I}$. The trace of $b$ is $\\mathrm{tr}(b) = (1+\\gamma^2) + 1 + 1 = 3 + \\gamma^2$.\n$$\n\\mathrm{dev}(b) = \\begin{bmatrix} 1+\\gamma^2 & \\gamma & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} - \\frac{3+\\gamma^2}{3}\\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} = \\begin{pmatrix} \\frac{2}{3}\\gamma^2 & \\gamma & 0 \\\\ \\gamma & -\\frac{1}{3}\\gamma^2 & 0 \\\\ 0 & 0 & -\\frac{1}{3}\\gamma^2 \\end{pmatrix}\n$$\nThe trial Cauchy stress is therefore:\n$$\n\\sigma^{\\mathrm{tr}} = \\mu \\begin{pmatrix} \\frac{2}{3}\\gamma^2 & \\gamma & 0 \\\\ \\gamma & -\\frac{1}{3}\\gamma^2 & 0 \\\\ 0 & 0 & -\\frac{1}{3}\\gamma^2 \\end{pmatrix}\n$$\nFrom this trial stress, we compute the trial stress invariants, pressure $p^{\\mathrm{tr}}$ and deviatoric invariant $q^{\\mathrm{tr}}$.\nThe trial pressure $p^{\\mathrm{tr}}$ is:\n$$\np^{\\mathrm{tr}} = -\\frac{1}{3} \\mathrm{tr}(\\sigma^{\\mathrm{tr}}) = -\\frac{\\mu}{3} \\left( \\frac{2}{3}\\gamma^2 - \\frac{1}{3}\\gamma^2 - \\frac{1}{3}\\gamma^2 \\right) = 0\n$$\nSince $p^{\\mathrm{tr}}=0$, the trial deviatoric stress tensor $s^{\\mathrm{tr}}$ is equal to the trial stress $\\sigma^{\\mathrm{tr}}$ itself. The trial deviatoric invariant $q^{\\mathrm{tr}}$ is:\n$$\nq^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} s^{\\mathrm{tr}}:s^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2} \\sum_{i,j} (\\sigma^{\\mathrm{tr}}_{ij})^2} = \\sqrt{\\frac{3}{2} \\mu^2 \\left[ (\\frac{2}{3}\\gamma^2)^2 + \\gamma^2 + \\gamma^2 + (-\\frac{1}{3}\\gamma^2)^2 + (-\\frac{1}{3}\\gamma^2)^2 \\right]}\n$$\n$$\nq^{\\mathrm{tr}} = \\mu \\sqrt{\\frac{3}{2} \\left[ \\frac{4}{9}\\gamma^4 + 2\\gamma^2 + \\frac{2}{9}\\gamma^4 \\right]} = \\mu \\sqrt{\\frac{3}{2} \\left[ \\frac{2}{3}\\gamma^4 + 2\\gamma^2 \\right]} = \\mu \\sqrt{\\gamma^4 + 3\\gamma^2} = \\mu \\gamma \\sqrt{\\gamma^2 + 3}\n$$\nSo, for the given simple shear deformation, the trial state is simply $(p^{\\mathrm{tr}}, q^{\\mathrm{tr}}) = (0, \\mu \\gamma \\sqrt{\\gamma^2 + 3})$.\n\n**3. Yield Check and Plastic Corrector Step**\n\nWe evaluate the Drucker-Prager yield function $f$ at the trial state:\n$$\nf^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\beta p^{\\mathrm{tr}} - (c_0 + H r_n)\n$$\nGiven $p^{\\mathrm{tr}} = 0$ and the initial condition $r_n=0$, this simplifies to:\n$$\nf^{\\mathrm{tr}} = q^{\\mathrm{tr}} - c_0\n$$\n- If $f^{\\mathrm{tr}} \\le 0$, the material response is elastic. The trial state is the final state:\n  $$ p_{n+1} = p^{\\mathrm{tr}} = 0, \\qquad q_{n+1} = q^{\\mathrm{tr}} $$\n- If $f^{\\mathrm{tr}} > 0$, the trial state lies outside the yield surface, and plastic flow occurs. A plastic correction is required. The magnitude of the plastic correction is determined by the plastic multiplier $\\Delta\\lambda$, calculated as:\n  $$\n  \\Delta \\lambda = \\frac{f^{\\mathrm{tr}}}{3\\mu + K \\beta \\beta_g + H}\n  $$\n  The final stress invariants $(p_{n+1}, q_{n+1})$ are found by returning the trial state to the yield surface using the backward-Euler algorithm:\n  $$\n  p_{n+1} = p^{\\mathrm{tr}} - K \\beta_g \\Delta\\lambda = - K \\beta_g \\Delta\\lambda\n  $$\n  $$\n  q_{n+1} = q^{\\mathrm{tr}} - 3 \\mu \\Delta\\lambda\n  $$\nThe internal variables are also updated, though not required for the final output of $(p,q)$:\n$$\nr_{n+1} = r_n + \\Delta\\lambda = \\Delta\\lambda\n$$\n\nThis complete algorithm is applied to each test case specified in the problem statement. The final values of $p_{n+1}$ and $q_{n+1}$ for each case are computed, rounded to six decimal places, and presented in the required format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational geomechanics problem for a set of test cases.\n\n    This function implements an elastic-predictor, plastic-corrector algorithm\n    for a Drucker-Prager material model under a single finite simple shear step.\n    It calculates the final stress state (p, q) for each test case.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (elastic check)\n        {'E': 10000, 'nu': 0.30, 'phi': 30, 'psi': 0, 'c0': 150, 'H': 100, 'gamma': 0.01},\n        # Case 2 (plastic, non-associative)\n        {'E': 5000, 'nu': 0.30, 'phi': 30, 'psi': 5, 'c0': 5, 'H': 50, 'gamma': 0.10},\n        # Case 3 (perfectly plastic, frictional with zero cohesion)\n        {'E': 10000, 'nu': 0.20, 'phi': 35, 'psi': 0, 'c0': 0, 'H': 0, 'gamma': 0.20},\n        # Case 4 (boundary on yield, frictionless)\n        {'E': 6000, 'nu': 0.25, 'phi': 0, 'psi': 0, 'c0': 41.568, 'H': 0, 'gamma': 0.01},\n        # Case 5 (very large hardening, near-elastic response)\n        {'E': 8000, 'nu': 0.30, 'phi': 25, 'psi': 10, 'c0': 1, 'H': 1000000, 'gamma': 0.20},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p_final, q_final = calculate_stress_state(case)\n        # Round to six decimal places as required\n        results.extend([round(p_final, 6), round(q_final, 6)])\n\n    # Format the final output string\n    # Using format specifier to avoid scientific notation and ensure standard decimal representation\n    formatted_results = [f\"{x:.6f}\" for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_stress_state(params):\n    \"\"\"\n    Performs the elastic-predictor plastic-corrector calculation for one case.\n\n    Args:\n        params (dict): A dictionary containing all material and loading parameters.\n\n    Returns:\n        tuple: A tuple containing the final pressure (p) and deviatoric invariant (q).\n    \"\"\"\n    # Unpack parameters\n    E = params['E']\n    nu = params['nu']\n    phi_deg = params['phi']\n    psi_deg = params['psi']\n    c0 = params['c0']\n    H = params['H']\n    gamma = params['gamma']\n    \n    # --- 1. Material Parameter Calculation ---\n\n    # Elastic moduli\n    mu = E / (2 * (1 + nu))\n    K = E / (3 * (1 - 2 * nu))\n\n    # Convert angles to radians\n    phi_rad = np.deg2rad(phi_deg)\n    psi_rad = np.deg2rad(psi_deg)\n    \n    sin_phi = np.sin(phi_rad)\n    sin_psi = np.sin(psi_rad)\n\n    # Drucker-Prager parameters\n    # The denominator 3-sin(phi) cannot be zero since sin(phi) is in [-1, 1]\n    beta = (6 * sin_phi) / (3 - sin_phi) if (3 - sin_phi) != 0 else 0\n    beta_g = (6 * sin_psi) / (3 - sin_psi) if (3 - sin_psi) != 0 else 0\n\n    # --- 2. Elastic Predictor Step ---\n    \n    # For finite simple shear, the trial stress invariants are:\n    p_tr = 0.0\n    q_tr = mu * gamma * np.sqrt(gamma**2 + 3)\n\n    # --- 3. Yield Check ---\n\n    # Initial internal variable state\n    r_n = 0.0\n    \n    # Evaluate trial yield function\n    f_tr = q_tr + beta * p_tr - (c0 + H * r_n)\n\n    # --- 4. Plastic Corrector Step (if needed) ---\n    \n    if f_tr <= 0:\n        # Elastic step: final state is the trial state\n        p_final = p_tr\n        q_final = q_tr\n    else:\n        # Plastic step: perform return mapping\n        \n        # Calculate plastic multiplier\n        denominator = 3 * mu + K * beta * beta_g + H\n        if denominator == 0:\n            # Avoid division by zero, although physically unlikely with H>=0\n            # For H=0, mu>0, K>0, phi>=psi>=0, this is positive\n            delta_lambda = 0\n        else:\n            delta_lambda = f_tr / denominator\n        \n        # Update stress invariants\n        p_final = p_tr - K * beta_g * delta_lambda\n        q_final = q_tr - 3 * mu * delta_lambda\n\n    return p_final, q_final\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}