{
    "hands_on_practices": [
        {
            "introduction": "理解极分解的第一步是将其应用于一个简单的变形模式。本练习  将通过一个沿坐标轴的单轴拉伸案例，引导你从基本定义出发，计算变形的关键张量。通过这个过程，你将直观地理解当变形不包含刚体旋转时，极分解的结果，并为分析更复杂的变形打下坚实的基础。",
            "id": "2886394",
            "problem": "对一个物体施加均匀变形，使其在参考构型的固定标准正交基中的变形梯度为 $\\mathbf{F}=\\operatorname{diag}(\\lambda,1,1)$，其中 $\\lambda>0$。仅从右Cauchy–Green变形张量、变形梯度的右极分解、以及作为右伸长张量特征对的主伸长和主方向的概念出发，确定下列各量：\n- 右Cauchy–Green变形张量 $\\mathbf{C}$，\n- 唯一的对称正定右伸长张量 $\\mathbf{U}$，\n- 正常正交旋转 $\\mathbf{R}$，\n- 主伸长，以及\n- 参考构型中对应的标准正交主方向。\n\n将你的最终结果表示为单个组合表达式，依次包含 $\\mathbf{C}$、$\\mathbf{U}$、$\\mathbf{R}$、主伸长列向量，以及列为参考基中主方向的 $3\\times 3$ 矩阵。无需进行数值计算或舍入。如果出现角度，必须以弧度为单位；但是，你的最终结果不应包含任何角度。",
            "solution": "该问题在连续介质力学的既定框架内提出了一个有效且适定的问题。我们将严格按照规定应用基本定义来求解。\n\n变形梯度张量 $\\mathbf{F}$ 是在参考构型的固定标准正交基 $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$ 中给出的。其矩阵表示为：\n$$\n[F] = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n其中 $\\lambda > 0$ 是一个标量伸长率。\n\n首先，我们确定右Cauchy–Green变形张量 $\\mathbf{C}$。根据定义，$\\mathbf{C}$ 由乘积 $\\mathbf{C} = \\mathbf{F}^T \\mathbf{F}$ 给出。由于 $\\mathbf{F}$ 的矩阵表示是对角的，它与其转置相同，即 $[F]^T = [F]$。计算很简单：\n$$\n[C] = [F]^T [F] = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\lambda^2  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n因此，$\\mathbf{C} = \\lambda^2 \\mathbf{e}_1 \\otimes \\mathbf{e}_1 + \\mathbf{e}_2 \\otimes \\mathbf{e}_2 + \\mathbf{e}_3 \\otimes \\mathbf{e}_3$。\n\n接下来，我们处理变形梯度的右极分解 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$，其中 $\\mathbf{R}$ 是表示旋转的正常正交张量，$\\mathbf{U}$ 是对称正定的右伸长张量。从此分解可得 $\\mathbf{C} = \\mathbf{F}^T \\mathbf{F} = (\\mathbf{R}\\mathbf{U})^T (\\mathbf{R}\\mathbf{U}) = \\mathbf{U}^T \\mathbf{R}^T \\mathbf{R} \\mathbf{U}$。由于 $\\mathbf{R}$ 是正交的，所以 $\\mathbf{R}^T\\mathbf{R} = \\mathbf{I}$；由于 $\\mathbf{U}$ 是对称的，所以 $\\mathbf{U}^T = \\mathbf{U}$。这简化为 $\\mathbf{C} = \\mathbf{U}^2$。因此，右伸长张量 $\\mathbf{U}$ 是 $\\mathbf{C}$ 的唯一正定平方根。\n\n鉴于 $[C]$ 是一个对角元为正数（$\\lambda^2 > 0$, $1 > 0$）的对角矩阵，其主平方根可通过对每个对角元素取平方根来求得：\n$$\n[U] = \\sqrt{[C]} = \\begin{pmatrix} \\sqrt{\\lambda^2}  0  0 \\\\ 0  \\sqrt{1}  0 \\\\ 0  0  \\sqrt{1} \\end{pmatrix} = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n我们利用 $\\lambda > 0$ 这一事实写出 $\\sqrt{\\lambda^2} = \\lambda$。张量 $\\mathbf{U}$ 是对称的。其特征值为 $\\lambda$、1 和 1。由于 $\\lambda>0$，所有特征值均为正，这证实了 $\\mathbf{U}$ 是正定的。在此特定情况下，经检验可知 $[U] = [F]$。\n\n确定 $\\mathbf{U}$ 后，我们从分解式 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 中求出旋转张量 $\\mathbf{R}$。由于 $\\mathbf{U}$ 是可逆的（其行列式为 $\\lambda > 0$），我们可以写出 $\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}$。对角矩阵 $[U]$ 的逆矩阵计算很简单：\n$$\n[U]^{-1} = \\begin{pmatrix} 1/\\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n现在，我们对 $[R]$ 进行矩阵乘法：\n$$\n[R] = [F] [U]^{-1} = \\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1/\\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n这是单位矩阵 $[I]$。因此，$\\mathbf{R} = \\mathbf{I}$。这个结果在物理上是合理的：沿坐标轴的纯伸长不含任何剪切分量，因此不涉及旋转。张量 $\\mathbf{I}$ 确实是正常正交的，因为 $\\mathbf{I}^T\\mathbf{I} = \\mathbf{I}$ 且 $\\det(\\mathbf{I}) = 1$。\n\n最后，我们确定主伸长及其对应方向。根据定义，它们分别是右伸长张量 $\\mathbf{U}$ 的特征值和归一化特征向量。由于 $[U]$ 是一个对角矩阵，其特征值就是其对角元。因此，主伸长为 $\\lambda_1 = \\lambda$，$\\lambda_2 = 1$，$\\lambda_3 = 1$。\n\n通过求解特征值问题 $(\\mathbf{U} - \\lambda_i \\mathbf{I})\\mathbf{N}_i = \\mathbf{0}$，可以找到相应的主方向 $\\mathbf{N}_i$。\n对于 $\\lambda_1 = \\lambda$：\n特征向量是 $(\\mathbf{U} - \\lambda\\mathbf{I})$ 零空间的基向量。\n$$\n[U] - \\lambda[I] = \\begin{pmatrix} 0  0  0 \\\\ 0  1-\\lambda  0 \\\\ 0  0  1-\\lambda \\end{pmatrix}\n$$\n如果 $\\lambda \\neq 1$，该矩阵将任意向量 $(N_1, N_2, N_3)^T$ 映射到 $(0, (1-\\lambda)N_2, (1-\\lambda)N_3)^T$。要使其成为零向量，必须有 $N_2=0$ 和 $N_3=0$。$N_1$ 是任意的。归一化的特征向量是 $\\mathbf{N}_1 = (1, 0, 0)^T$，它对应于基向量 $\\mathbf{e}_1$。\n\n对于重特征值 $\\lambda_2 = \\lambda_3 = 1$：\n特征向量是 $(\\mathbf{U} - 1 \\cdot \\mathbf{I})$ 零空间的基向量。\n$$\n[U] - 1[I] = \\begin{pmatrix} \\lambda-1  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n如果 $\\lambda \\neq 1$，该矩阵将 $(N_1, N_2, N_3)^T$ 映射到 $((\\lambda-1)N_1, 0, 0)^T$。要使其成为零向量，必须有 $N_1=0$。$N_2$ 和 $N_3$ 是任意的。这定义了一个二维特征空间，即由 $\\mathbf{e}_2$ 和 $\\mathbf{e}_3$ 张成的平面。此平面中的任何向量都是伸长为1的主方向。我们必须为此空间选择一个标准正交基。标准的选择是 $\\mathbf{N}_2 = (0, 1, 0)^T = \\mathbf{e}_2$ 和 $\\mathbf{N}_3 = (0, 0, 1)^T = \\mathbf{e}_3$。\n\n如果 $\\lambda=1$，则 $\\mathbf{F}=\\mathbf{U}=\\mathbf{I}$ 且 $\\mathbf{C}=\\mathbf{I}$。这对应于无变形。所有伸长均为1，任何方向都是主方向。选择 $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$ 作为标准正交主方向的集合仍然有效。\n\n因此，主伸长为 $\\{\\lambda, 1, 1\\}$，参考构型中一组对应的标准正交主方向为 $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$。以这些方向为列的矩阵是单位矩阵 $\\mathbf{I}$。\n\n我们按要求的顺序汇总结果：$\\mathbf{C}$、$\\mathbf{U}$、$\\mathbf{R}$、主伸长列向量，以及主方向矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} \\lambda^{2}  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n\n\\begin{pmatrix} \\lambda  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n\n\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n\n\\begin{pmatrix} \\lambda \\\\ 1 \\\\ 1 \\end{pmatrix}\n\n\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "简单剪切是岩土力学中一种常见的变形模式，但其运动学比纯拉伸更为复杂。通过本练习 ，你将分析简单剪切变形，并发现它并不仅仅是“纯粹的剪切”，而是包含了拉伸与刚体旋转的组合。这有助于深化对有限变形理论中非线性效应（如剪切引起的法向应变）的理解。",
            "id": "3516613",
            "problem": "考虑一个在计算岩土力学中常用于模拟直剪的矩形土样的均匀单剪切，其从参考构型坐标 $\\{X_{1}, X_{2}, X_{3}\\}$ 到当前构型坐标 $\\{x_{1}, x_{2}, x_{3}\\}$ 的变形映射定义如下：\n$$x_{1} = X_{1} + \\gamma X_{2}, \\quad x_{2} = X_{2}, \\quad x_{3} = X_{3},$$\n其中 $\\gamma \\geq 0$ 是施加的剪切幅值。仅使用有限变形运动学的基本定义，计算与此映射相关的变形梯度张量、右Cauchy–Green变形张量、左Cauchy–Green变形张量和Green–Lagrange应变张量。基于变形梯度张量的极分解，解释您得到的非零应变分量的物理意义，阐明旋转和拉伸在剪切中的作用。然后，确定Green–Lagrange应变张量的主值（特征值），并找出作为 $\\gamma$ 函数的最大主Green–Lagrange应变。将您的最终答案表示为关于 $\\gamma$ 的单个闭式解析表达式。无需四舍五入，并且由于应变是无量纲的，最终答案中不需要单位。",
            "solution": "该问题是有效的，因为它在连续介质力学中有科学依据，是适定的、客观的，并包含获得唯一解所需的所有信息。\n\n变形映射由以下公式给出：\n$$x_{1} = X_{1} + \\gamma X_{2}$$\n$$x_{2} = X_{2}$$\n$$x_{3} = X_{3}$$\n其中 $\\{X_{1}, X_{2}, X_{3}\\}$ 是参考构型中的坐标，$\\{x_{1}, x_{2}, x_{3}\\}$ 是当前构型中的坐标。参数 $\\gamma \\ge 0$ 代表剪切幅值。\n\n首先，我们计算变形梯度张量 $\\mathbf{F}$，其分量定义为 $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$。\n各分量为：\n$F_{11} = \\frac{\\partial}{\\partial X_1}(X_{1} + \\gamma X_{2}) = 1$\n$F_{12} = \\frac{\\partial}{\\partial X_2}(X_{1} + \\gamma X_{2}) = \\gamma$\n$F_{13} = \\frac{\\partial}{\\partial X_3}(X_{1} + \\gamma X_{2}) = 0$\n$F_{21} = \\frac{\\partial}{\\partial X_1}(X_{2}) = 0$\n$F_{22} = \\frac{\\partial}{\\partial X_2}(X_{2}) = 1$\n$F_{23} = \\frac{\\partial}{\\partial X_3}(X_{2}) = 0$\n$F_{31} = \\frac{\\partial}{\\partial X_1}(X_{3}) = 0$\n$F_{32} = \\frac{\\partial}{\\partial X_2}(X_{3}) = 0$\n$F_{33} = \\frac{\\partial}{\\partial X_3}(X_{3}) = 1$\n\n以矩阵形式表示，变形梯度张量 $\\mathbf{F}$ 为：\n$$\n\\mathbf{F} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\n接下来，我们计算右Cauchy–Green变形张量 $\\mathbf{C}$，定义为 $\\mathbf{C} = \\mathbf{F}^T \\mathbf{F}$。\n$$\n\\mathbf{C} = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\n左Cauchy–Green变形张量 $\\mathbf{B}$ 定义为 $\\mathbf{B} = \\mathbf{F} \\mathbf{F}^T$。\n$$\n\\mathbf{B} = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\gamma^2 + 1  \\gamma  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\nGreen–Lagrange应变张量 $\\mathbf{E}$ 定义为 $\\mathbf{E} = \\frac{1}{2}(\\mathbf{C} - \\mathbf{I})$，其中 $\\mathbf{I}$ 是单位张量。\n$$\n\\mathbf{E} = \\frac{1}{2} \\left( \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  \\gamma^2 + 1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0  \\gamma  0 \\\\ \\gamma  \\gamma^2  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{\\gamma}{2}  0 \\\\ \\frac{\\gamma}{2}  \\frac{\\gamma^2}{2}  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n\n为了进行物理上的解释，我们使用极分解定理。该定理指出，任何可逆的变形梯度 $\\mathbf{F}$ 都可以唯一地分解为一个旋转张量 $\\mathbf{R}$ 和一个对称正定的右拉伸张量 $\\mathbf{U}$，使得 $\\mathbf{F} = \\mathbf{R} \\mathbf{U}$。张量 $\\mathbf{U}$ 描述了材料的纯变形（拉伸和剪切），而 $\\mathbf{R}$ 描述了材料元的刚体旋转。Green–Lagrange应变张量 $\\mathbf{E}$ 是纯应变的一种度量，因为它通过 $\\mathbf{E} = \\frac{1}{2}(\\mathbf{U}^2 - \\mathbf{I})$ 与 $\\mathbf{U}$ 相关。对于给定的单剪切，当 $\\gamma > 0$ 时，$\\mathbf{F}$ 不是对称的，这意味着旋转张量 $\\mathbf{R}$ 不是单位张量，因此变形包含一个旋转分量。$\\mathbf{E}$ 的非零分量阐明了纯应变的性质：\n$E_{12} = \\frac{\\gamma}{2}$ 代表剪切应变分量，它量化了最初平行于 $X_1$ 和 $X_2$ 轴的材料线之间的角度变化。\n$E_{22} = \\frac{\\gamma^2}{2}$ 是沿 $X_2$ 方向的正应变分量。这是一种有限变形效应（通常称为Poynting效应），它表明单剪切伴随着在某些方向上的伸长或收缩。该项是关于 $\\gamma$ 的二阶项，在线性化微小应变理论中可以忽略。因此，极分解揭示了单剪切不是“纯剪切”，而是纯变形（其本身是剪切和拉伸的混合，由 $\\mathbf{E}$ 度量）和刚体旋转的组合。\n\n为了求Green–Lagrange应变张量 $\\mathbf{E}$ 的主值，我们求解特征值问题 $\\det(\\mathbf{E} - \\lambda \\mathbf{I}) = 0$。变形是平面的，因此我们分析左上角的 $2 \\times 2$ 子矩阵。第三个主应变显然为 $0$。\n$$\n\\det \\begin{pmatrix} 0 - \\lambda  \\frac{\\gamma}{2} \\\\ \\frac{\\gamma}{2}  \\frac{\\gamma^2}{2} - \\lambda \\end{pmatrix} = 0\n$$\n这给出了特征方程：\n$$\n(-\\lambda)\\left(\\frac{\\gamma^2}{2} - \\lambda\\right) - \\left(\\frac{\\gamma}{2}\\right)^2 = 0\n$$\n$$\n\\lambda^2 - \\frac{\\gamma^2}{2}\\lambda - \\frac{\\gamma^2}{4} = 0\n$$\n对这个关于 $\\lambda$ 的二次方程求解：\n$$\n\\lambda = \\frac{-(-\\frac{\\gamma^2}{2}) \\pm \\sqrt{(-\\frac{\\gamma^2}{2})^2 - 4(1)(-\\frac{\\gamma^2}{4})}}{2(1)}\n$$\n$$\n\\lambda = \\frac{\\frac{\\gamma^2}{2} \\pm \\sqrt{\\frac{\\gamma^4}{4} + \\gamma^2}}{2} = \\frac{\\frac{\\gamma^2}{2} \\pm \\sqrt{\\gamma^2(\\frac{\\gamma^2}{4} + 1)}}{2}\n$$\n由于 $\\gamma \\ge 0$，我们有 $\\sqrt{\\gamma^2} = \\gamma$。\n$$\n\\lambda = \\frac{\\frac{\\gamma^2}{2} \\pm \\gamma \\sqrt{\\frac{\\gamma^2+4}{4}}}{2} = \\frac{\\frac{\\gamma^2}{2} \\pm \\frac{\\gamma}{2}\\sqrt{\\gamma^2+4}}{2}\n$$\n$$\n\\lambda = \\frac{\\gamma^2 \\pm \\gamma\\sqrt{\\gamma^2+4}}{4}\n$$\n三个主Green–Lagrange应变为：\n$$\n\\lambda_1 = \\frac{\\gamma^2 + \\gamma\\sqrt{\\gamma^2+4}}{4}\n$$\n$$\n\\lambda_2 = \\frac{\\gamma^2 - \\gamma\\sqrt{\\gamma^2+4}}{4}\n$$\n$$\n\\lambda_3 = 0\n$$\n为了找到最大主应变，我们比较这些值。由于 $\\gamma \\ge 0$，项 $\\gamma\\sqrt{\\gamma^2+4}$ 是非负的。\n因此，$\\lambda_1 \\ge \\lambda_2$。\n此外，对于 $\\gamma > 0$，我们有 $\\gamma^2 < \\gamma\\sqrt{\\gamma^2+4}$，因为 $\\gamma^4 < \\gamma^2(\\gamma^2+4) = \\gamma^4 + 4\\gamma^2$。这意味着 $\\lambda_2 < 0$。\n显然，当 $\\gamma > 0$ 时，$\\lambda_1 > 0$。\n因此，最大主Green–Lagrange应变为 $\\lambda_1$。\n\n$$\nE_{\\text{max}} = \\frac{\\gamma^2 + \\gamma\\sqrt{\\gamma^2+4}}{4}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\gamma^2 + \\gamma\\sqrt{\\gamma^2+4}}{4}}\n$$"
        },
        {
            "introduction": "在计算岩土力学中，理论的有效性最终取决于其数值实现的稳健性。本练习  将带你从理论计算走向算法设计，要求你为三维变形梯度张量的极分解构建一个完整的计算流程。这不仅包括核心的计算方法，还涉及处理奇异或病态情况的关键条件检查，这是任何实用有限元代码都必须考虑的现实问题。",
            "id": "3516660",
            "problem": "您的任务是设计并实现一个稳健的计算算法，用于计算三维变形梯度张量的极分解。在计算地质力学中，变形梯度张量 $\\mathbf{F}$ 定义为 $\\mathbf{F} = \\partial \\mathbf{x} / \\partial \\mathbf{X}$，其中 $\\mathbf{x}$ 表示空间坐标，$\\mathbf{X}$ 表示参考坐标。雅可比行列式为 $J = \\det(\\mathbf{F})$。右柯西-格林变形张量为 $\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$。右极分解将 $\\mathbf{F}$ 表示为 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$，其中 $\\mathbf{R}$ 是正交的（即 $\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$），$\\mathbf{U}$ 是对称正定的。\n\n从这些基本定义出发，您必须推导出一个基于原理的算法，该算法能够：\n- 对给定的 $3 \\times 3$ 矩阵 $\\mathbf{F}$ 计算其右极分解 $(\\mathbf{R}, \\mathbf{U})$。\n- 基于雅可比行列式 $J$ 和 $\\mathbf{F}$ 的奇异值条件数进行条件检查，以决定是使用主谱方法（通过 $\\mathbf{C}$ 的谱特性）还是退回到奇异值分解（SVD）。\n- 通过在必要时对 $\\mathbf{U}$ 进行对称化处理以及避免除以接近零的量来确保数值稳健性。\n- 通过量化以下指标来验证计算出的因子：\n  1. 重构残差 $\\|\\mathbf{F} - \\mathbf{R}\\mathbf{U}\\|_F$，\n  2. 正交性缺陷 $\\|\\mathbf{R}^\\mathsf{T}\\mathbf{R} - \\mathbf{I}\\|_F$，\n  3. 对称性缺陷 $\\|\\mathbf{U} - \\mathbf{U}^\\mathsf{T}\\|_F$，\n  4. 对称化 $\\mathbf{U}$ 的最小特征值，\n  5. 行列式 $\\det(\\mathbf{R})$，\n  6. 是否使用了退回SVD的备用方法（布尔值）。\n\n在所有构造中，角度单位均为弧度。本问题不需要物理单位，所有量均为无量纲量。\n\n主算法要求：\n- 对于良态情况，使用 $\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$ 的谱特性来构造对称正定右拉伸张量 $\\mathbf{U}$，然后相应地获得 $\\mathbf{R}$。不要使用任何快捷公式；从定义中隐含的属性进行推导。\n\n备用算法要求：\n- 当雅可比行列式 $J$ 接近零或 $\\mathbf{F}$ 的条件数（基于其最大奇异值与最小奇异值之比）很大时，退回到使用奇异值分解来计算极分解。实数矩阵的SVD分解为 $\\mathbf{F} = \\mathbf{U}_s \\mathbf{\\Sigma} \\mathbf{V}^\\mathsf{T}$，其中 $\\mathbf{U}_s$ 和 $\\mathbf{V}$ 是正交矩阵，$\\mathbf{\\Sigma}$ 是具有非负元素的对角矩阵。\n\n条件阈值：\n- 使用阈值 $|J| < \\tau_J$（其中 $\\tau_J = 1 \\times 10^{-7}$）和一个条件数阈值 $\\kappa(\\mathbf{F}) > \\tau_\\kappa$（其中 $\\tau_\\kappa = 1 \\times 10^{12}$）。此外，如果主方法中使用的最小主值会导致除以一个小于 $\\tau_\\sigma = 1 \\times 10^{-7}$ 的量，则必须使用退回到SVD的备用方法。\n\n测试套件：\n- 使用从轴-角数据（罗德里格斯表示法）和对角右拉伸张量构建的旋转，为 $\\mathbf{F}$ 构造以下五个测试用例。所有角度均以弧度为单位。\n  1. 情况 A（良态“理想路径”）：轴 $\\mathbf{a} = [0, 0, 1]$，角度 $\\theta = 0.5$，右拉伸对角线 $\\operatorname{diag}([1.2, 0.9, 1.1])$。定义 $\\mathbf{F} = \\mathbf{R}(\\mathbf{a}, \\theta)\\operatorname{diag}([1.2, 0.9, 1.1])$。\n  2. 情况 B（$J$ 接近奇异）：轴 $\\mathbf{a} = [1, 0, 0]$，角度 $\\theta = 0.4$，右拉伸对角线 $\\operatorname{diag}([1 \\times 10^{-8}, 1.0, 1.0])$。定义 $\\mathbf{F} = \\mathbf{R}(\\mathbf{a}, \\theta)\\operatorname{diag}([1 \\times 10^{-8}, 1.0, 1.0])$。\n  3. 情况 C（方向反转的正交因子）：轴 $\\mathbf{a} = [0, 1, 0]$，角度 $\\theta = 0.6$，右拉伸对角线 $\\operatorname{diag}([1.3, 0.7, 1.0])$，并通过与 $\\operatorname{diag}([-1, 1, 1])$ 复合，对正交部分施加一个反射。定义 $\\mathbf{F} = \\left(\\mathbf{R}(\\mathbf{a}, \\theta)\\operatorname{diag}([-1, 1, 1])\\right)\\operatorname{diag}([1.3, 0.7, 1.0])$。\n  4. 情况 D（纯对称正定输入）：角度 $\\theta = 0.0$，任意轴（例如，$\\mathbf{a} = [0, 0, 1]$），右拉伸对角线 $\\operatorname{diag}([2.0, 0.5, 1.5])$。定义 $\\mathbf{F} = \\mathbf{I}\\operatorname{diag}([2.0, 0.5, 1.5]) = \\operatorname{diag}([2.0, 0.5, 1.5])$。\n  5. 情况 E（极端病态）：轴 $\\mathbf{a} = [1, 1, 0]$，角度 $\\theta = 0.3$，右拉伸对角线 $\\operatorname{diag}([1 \\times 10^{-12}, 1.0, 1 \\times 10^{8}])$。定义 $\\mathbf{F} = \\mathbf{R}(\\mathbf{a}, \\theta)\\operatorname{diag}([1 \\times 10^{-12}, 1.0, 1 \\times 10^{8}])$。\n\n输出规范：\n- 对于每个测试用例，计算并返回列表 $[\\|\\mathbf{F} - \\mathbf{R}\\mathbf{U}\\|_F, \\|\\mathbf{R}^\\mathsf{T}\\mathbf{R} - \\mathbf{I}\\|_F, \\|\\mathbf{U} - \\mathbf{U}^\\mathsf{T}\\|_F, \\lambda_{\\min}((\\mathbf{U} + \\mathbf{U}^\\mathsf{T})/2), \\det(\\mathbf{R}), \\text{fallback\\_used}]$，其中 $\\lambda_{\\min}(\\cdot)$ 表示指定对称张量的最小特征值，$\\text{fallback\\_used}$ 是一个布尔值，指示是否触发了SVD备用方法。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4},\\text{result5}]$），其中每个 $\\text{result}$ 本身就是上述针对一个测试用例的列表。",
            "solution": "该问题要求设计并实现一个稳健的算法，用于计算一个 $3 \\times 3$ 变形梯度张量 $\\mathbf{F}$ 的右极分解。该分解由 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 给出，其中 $\\mathbf{R}$ 是一个正交张量（$\\mathbf{R}^\\mathsf{T}\\mathbf{R} = \\mathbf{I}$），$\\mathbf{U}$ 是一个对称正定张量，称为右拉伸张量。该算法必须从基本原理推导，并包含条件检查，以便在主谱方法和基于奇异值分解（SVD）的更稳健的备用方法之间切换。\n\n首先，我们为谱方法建立理论基础。根据极分解 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ 以及 $\\mathbf{R}$ 和 $\\mathbf{U}$ 的性质（$\\mathbf{R}^\\mathsf{T} = \\mathbf{R}^{-1}$，$\\mathbf{U}^\\mathsf{T} = \\mathbf{U}$），我们可以将右柯西-格林变形张量 $\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$ 表示如下：\n$$\n\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F} = (\\mathbf{R}\\mathbf{U})^\\mathsf{T}(\\mathbf{R}\\mathbf{U}) = \\mathbf{U}^\\mathsf{T}\\mathbf{R}^\\mathsf{T}\\mathbf{R}\\mathbf{U} = \\mathbf{U}(\\mathbf{R}^\\mathsf{T}\\mathbf{R})\\mathbf{U} = \\mathbf{U}\\mathbf{I}\\mathbf{U} = \\mathbf{U}^2\n$$\n这个基本关系式 $\\mathbf{C} = \\mathbf{U}^2$ 表明，右拉伸张量 $\\mathbf{U}$ 是右柯西-格林张量 $\\mathbf{C}$ 的主平方根。由于 $\\mathbf{F}$ 是一个实数张量，$\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$ 是对称半正定的。如果 $\\mathbf{F}$ 是可逆的（即 $\\det(\\mathbf{F}) \\neq 0$），那么 $\\mathbf{C}$ 是正定的。\n\n适用于良态张量 $\\mathbf{F}$ 的主算法利用了 $\\mathbf{C}$ 的谱分解：\n1.  计算右柯西-格林张量 $\\mathbf{C} = \\mathbf{F}^\\mathsf{T}\\mathbf{F}$。为确保数值对称性，谨慎的做法是将其计算为 $\\mathbf{C} = \\frac{1}{2}((\\mathbf{F}^\\mathsf{T}\\mathbf{F}) + (\\mathbf{F}^\\mathsf{T}\\mathbf{F})^\\mathsf{T})$。\n2.  由于 $\\mathbf{C}$ 是对称的，它允许进行谱分解 $\\mathbf{C} = \\mathbf{Q}\\mathbf{\\Lambda}\\mathbf{Q}^\\mathsf{T}$，其中 $\\mathbf{Q}$ 是一个正交矩阵，其列是 $\\mathbf{C}$ 的特征向量，而 $\\mathbf{\\Lambda}$ 是一个包含相应非负特征值 $\\lambda_i$ 的对角矩阵。\n3.  拉伸张量 $\\mathbf{U} = \\mathbf{C}^{1/2}$ 随后可以构造为 $\\mathbf{U} = \\mathbf{Q}\\mathbf{\\Lambda}^{1/2}\\mathbf{Q}^\\mathsf{T}$，其中 $\\mathbf{\\Lambda}^{1/2} = \\operatorname{diag}(\\sqrt{\\lambda_1}, \\sqrt{\\lambda_2}, \\sqrt{\\lambda_3})$。这种构造保证了 $\\mathbf{U}$ 是对称的，并且对于正定的 $\\mathbf{C}$，$\\mathbf{U}$ 也是正定的。\n4.  一旦 $\\mathbf{U}$ 已知，就可以通过在原始分解中对 $\\mathbf{U}$求逆来找到旋转张量 $\\mathbf{R}$：$\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}$。逆矩阵 $\\mathbf{U}^{-1}$ 通过谱分解计算得出，即 $\\mathbf{U}^{-1} = \\mathbf{Q}\\mathbf{\\Lambda}^{-1/2}\\mathbf{Q}^\\mathsf{T}$，其中 $\\mathbf{\\Lambda}^{-1/2} = \\operatorname{diag}(1/\\sqrt{\\lambda_1}, 1/\\sqrt{\\lambda_2}, 1/\\sqrt{\\lambda_3})$。如果任何特征值 $\\lambda_i$ 接近于零，此步骤在数值上会很敏感。\n\n对于病态或奇异张量 $\\mathbf{F}$，需要一种更稳定的备用方法，即使用奇异值分解（SVD）。$\\mathbf{F}$ 的SVD分解由 $\\mathbf{F} = \\mathbf{U}_s\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T}$ 给出，其中 $\\mathbf{U}_s$ 和 $\\mathbf{V}$ 是正交矩阵，$\\mathbf{\\Sigma}$ 是非负奇异值 $\\sigma_i$ 组成的对角矩阵。我们可以重新排列它以匹配极分解的形式 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$：\n$$\n\\mathbf{F} = (\\mathbf{U}_s\\mathbf{V}^\\mathsf{T})(\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T})\n$$\n我们将这些因子识别为：\n-   $\\mathbf{R} = \\mathbf{U}_s\\mathbf{V}^\\mathsf{T}$。这是两个正交矩阵的乘积，其本身也是正交的。\n-   $\\mathbf{U} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T}$。根据构造，该张量是对称的（$\\mathbf{U}^\\mathsf{T} = (\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T})^\\mathsf{T} = \\mathbf{V}\\mathbf{\\Sigma}^\\mathsf{T}\\mathbf{V}^\\mathsf{T} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{V}^\\mathsf{T} = \\mathbf{U}$）。其特征值是 $\\mathbf{F}$ 的奇异值 $\\sigma_i$，这些值是非负的，因此 $\\mathbf{U}$ 是半正定的。这种方法避免了矩阵求逆，使其更加稳健。\n\n决定是否使用SVD备用方法基于三个条件：\n1.  雅可比行列式 $J = \\det(\\mathbf{F})$ 接近于零：$|J| < \\tau_J = 1 \\times 10^{-7}$。这表明 $\\mathbf{F}$ 是奇异或接近奇异的。\n2.  $\\mathbf{F}$ 的条件数 $\\kappa(\\mathbf{F}) = \\sigma_{\\max}/\\sigma_{\\min}$ 过大：$\\kappa(\\mathbf{F}) > \\tau_\\kappa = 1 \\times 10^{12}$。这标志着对数值误差极度敏感。奇异值 $\\sigma_i$ 是 $\\mathbf{C}$ 的特征值的平方根。\n3.  谱方法将涉及除以一个很小的数。如果任何主拉伸 $\\sigma_i = \\sqrt{\\lambda_i}$ 小于一个容差 $\\tau_\\sigma = 1 \\times 10^{-7}$，就会发生这种情况。\n\n为了构造测试用例，旋转矩阵 $\\mathbf{R}$ 是根据轴-角表示 $(\\mathbf{a}, \\theta)$ 使用罗德里格斯公式生成的：$\\mathbf{R} = \\mathbf{I} + \\sin(\\theta)[\\mathbf{a}]_\\times + (1-\\cos(\\theta))[\\mathbf{a}]_\\times^2$，其中 $[\\mathbf{a}]_\\times$ 是单位轴向量 $\\mathbf{a}$ 的斜对称叉乘矩阵。\n\n最后，通过计算一组六个度量指标来验证计算出的因子 $(\\mathbf{R}, \\mathbf{U})$：\n1.  重构残差：$\\|\\mathbf{F} - \\mathbf{R}\\mathbf{U}\\|_F$，用于衡量分解的准确性。\n2.  正交性缺陷：$\\|\\mathbf{R}^\\mathsf{T}\\mathbf{R} - \\mathbf{I}\\|_F$，用于衡量 $\\mathbf{R}$ 与完美正交的接近程度。\n3.  对称性缺陷：$\\|\\mathbf{U} - \\mathbf{U}^\\mathsf{T}\\|_F$，用于衡量计算出的拉伸张量 $\\mathbf{U}$ 的数值不对称性。\n4.  对称化 $\\mathbf{U}$ 的最小特征值：$\\lambda_{\\min}((\\mathbf{U} + \\mathbf{U}^\\mathsf{T})/2)$，用于检查 $\\mathbf{U}$ 的正定性。\n5.  $\\mathbf{R}$ 的行列式：$\\det(\\mathbf{R})$，其值应为 $\\pm 1$。值为 $+1$ 表示一个真旋转，而 $-1$ 表示一个反转方向的变换（一个旋转加上一个反射）。\n6.  备用方法标志：一个布尔值，指示是否触发了SVD备用方法。",
            "answer": "```python\nimport numpy as np\n\ndef rodrigues_rotation(axis, angle):\n    \"\"\"\n    Computes the 3D rotation matrix from an axis-angle representation\n    using Rodrigues' formula.\n    \"\"\"\n    axis = np.asarray(axis, dtype=float)\n    axis = axis / np.linalg.norm(axis)\n    a1, a2, a3 = axis\n    K = np.array([[0, -a3, a2], [a3, 0, -a1], [-a2, a1, 0]])\n    I = np.identity(3)\n    R = I + np.sin(angle) * K + (1 - np.cos(angle)) * np.dot(K, K)\n    return R\n\ndef should_use_svd(F, tau_J, tau_kappa, tau_sigma):\n    \"\"\"\n    Determines whether to use the SVD fallback based on conditioning.\n    \"\"\"\n    # 1. Jacobian determinant check\n    if abs(np.linalg.det(F))  tau_J:\n        return True\n\n    # For the next checks, use eigenvalues of C = F.T @ F.\n    C = F.T @ F\n    # Symmetrize for numerical stability with eigh/eigvalsh\n    C = 0.5 * (C + C.T)\n    \n    try:\n        eigvals = np.linalg.eigvalsh(C)\n    except np.linalg.LinAlgError:\n        # If C is badly conditioned and eigvalsh fails, use SVD.\n        return True\n        \n    lambda_min = np.min(eigvals)\n    lambda_max = np.max(eigvals)\n\n    # If lambda_min is non-positive, C is not positive definite.\n    # The spectral method for U=C^(1/2) is ill-defined or U would be singular.\n    if lambda_min = 0:\n        return True\n    \n    # 2. Condition number check: kappa = sigma_max / sigma_min\n    kappa = np.sqrt(lambda_max / lambda_min)\n    if kappa > tau_kappa:\n        return True\n    \n    # 3. Minimum principal value check (for division safety)\n    min_singular_value = np.sqrt(lambda_min)\n    if min_singular_value  tau_sigma:\n        return True\n        \n    return False\n\ndef polar_decomposition(F, tau_J, tau_kappa, tau_sigma):\n    \"\"\"\n    Computes the right polar decomposition F = RU with conditioning checks.\n    \"\"\"\n    fallback_used = should_use_svd(F, tau_J, tau_kappa, tau_sigma)\n\n    if fallback_used:\n        # Fallback: SVD-based method\n        Us, s, Vh = np.linalg.svd(F)\n        R = Us @ Vh\n        Sigma = np.diag(s)\n        V = Vh.T\n        U = V @ Sigma @ Vh\n    else:\n        # Primary: Spectral method\n        C = F.T @ F\n        C = 0.5 * (C + C.T) # Symmetrize for stability\n        \n        eigvals, Q = np.linalg.eigh(C)\n        \n        # Ensure eigenvalues are non-negative before sqrt\n        eigvals[eigvals  0] = 0\n\n        Lambda_sqrt = np.diag(np.sqrt(eigvals))\n        \n        # Guard against zero-division\n        inv_sqrt_eigvals = np.zeros_like(eigvals)\n        safe_idx = eigvals > 0\n        inv_sqrt_eigvals[safe_idx] = 1.0 / np.sqrt(eigvals[safe_idx])\n        Lambda_inv_sqrt = np.diag(inv_sqrt_eigvals)\n\n        U = Q @ Lambda_sqrt @ Q.T\n        U_inv = Q @ Lambda_inv_sqrt @ Q.T\n        R = F @ U_inv\n\n    return R, U, fallback_used\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and produce the final output.\n    \"\"\"\n    # Define conditioning thresholds\n    tau_J = 1e-7\n    tau_kappa = 1e12\n    tau_sigma = 1e-7\n\n    # Construct test cases\n    test_cases_defs = [\n        # Case A: Well-conditioned\n        {'axis': [0, 0, 1], 'angle': 0.5, 'stretch_diag': [1.2, 0.9, 1.1], 'pre_reflect': None},\n        # Case B: Near-singular J\n        {'axis': [1, 0, 0], 'angle': 0.4, 'stretch_diag': [1e-8, 1.0, 1.0], 'pre_reflect': None},\n        # Case C: Orientation-reversing\n        {'axis': [0, 1, 0], 'angle': 0.6, 'stretch_diag': [1.3, 0.7, 1.0], 'pre_reflect': np.diag([-1, 1, 1])},\n        # Case D: Pure symmetric positive-definite\n        {'axis': [0, 0, 1], 'angle': 0.0, 'stretch_diag': [2.0, 0.5, 1.5], 'pre_reflect': None},\n        # Case E: Extremely ill-conditioned\n        {'axis': [1, 1, 0], 'angle': 0.3, 'stretch_diag': [1e-12, 1.0, 1e8], 'pre_reflect': None},\n    ]\n\n    test_cases_F = []\n    for case_def in test_cases_defs:\n        R_rot = rodrigues_rotation(case_def['axis'], case_def['angle'])\n        U_diag_mat = np.diag(case_def['stretch_diag'])\n        \n        Orthogonal_part = R_rot\n        if case_def['pre_reflect'] is not None:\n            Orthogonal_part = Orthogonal_part @ case_def['pre_reflect']\n            \n        F = Orthogonal_part @ U_diag_mat\n        test_cases_F.append(F)\n\n    results = []\n    for F in test_cases_F:\n        R, U, fallback_used = polar_decomposition(F, tau_J, tau_kappa, tau_sigma)\n        \n        # Calculate verification metrics\n        # 1. Reconstruction residual\n        recon_resid = np.linalg.norm(F - R @ U, 'fro')\n        \n        # 2. Orthogonality defect\n        ortho_defect = np.linalg.norm(R.T @ R - np.identity(3), 'fro')\n        \n        # 3. Symmetry defect\n        symm_defect = np.linalg.norm(U - U.T, 'fro')\n        \n        # 4. Minimum eigenvalue of symmetrized U\n        U_symm = 0.5 * (U + U.T)\n        try:\n            min_eig_U = np.min(np.linalg.eigvalsh(U_symm))\n        except np.linalg.LinAlgError:\n            min_eig_U = float('nan')\n\n        # 5. Determinant of R\n        det_R = np.linalg.det(R)\n        \n        # 6. Fallback usage (boolean)\n        \n        results.append([\n            recon_resid,\n            ortho_defect,\n            symm_defect,\n            min_eig_U,\n            det_R,\n            fallback_used\n        ])\n\n    # Format output as specified\n    formatted_results = [str(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}