{
    "hands_on_practices": [
        {
            "introduction": "The first step in analyzing any foundation is to understand how the load it carries spreads into the underlying ground. This practice revisits the classical Boussinesq solution for a point load on an elastic half-space, a fundamental building block in geomechanics. By discretizing a uniformly loaded area into a grid of point loads and applying the principle of linear superposition, you will construct an approximation for the stress distribution, directly connecting continuum mechanics theory to a practical engineering scenario .",
            "id": "3500556",
            "problem": "Consider a semi-infinite, homogeneous, isotropic, linear elastic half-space subjected at its surface to a rigid square footing of side length $B$ that imposes a uniform vertical pressure $q$ over the area $\\{(x,y): |x| \\leq B/2, |y| \\leq B/2\\}$. Let the coordinate system be defined with the origin at the center of the footing on the surface, the $z$-axis pointing downward into the half-space, and the point of interest located at $(r=0,z)$ directly beneath the center of the footing. Assume small-strain linear elasticity and neglect body forces.\n\nStarting from the axi-symmetric Green’s function of the linear elastic half-space (Boussinesq’s solution) for a vertical point load $P$ applied at the surface at the origin, first state the nonzero stress components beneath the point load in cylindrical coordinates $(r,z)$. Then, using the principle of linear superposition and without introducing any shortcut formulas, construct a discrete approximation to the vertical stress beneath the center of the footing by representing the uniformly loaded square as an $M \\times M$ array of equal square subareas, each replaced by a vertical point load of magnitude equal to the distributed load acting over that subarea and located at the subarea centroid. Non-dimensionalize the result by introducing the dimensionless depth $\\eta = z/B$ and define the dimensionless influence factor $I(M,\\eta)$ by $I(M,\\eta) = \\sigma_{z}(0,z)/q$, where $\\sigma_{z}(0,z)$ is the vertical stress beneath the center at depth $z$ arising from the discrete superposition.\n\nProvide the final expression for $I(M,\\eta)$ in closed analytic form as a finite double sum over the $M \\times M$ centroid positions, expressed entirely in terms of $M$ and $\\eta$. Do not numerically evaluate your expression. No units are required for the final expression, since $I(M,\\eta)$ is dimensionless.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Geometry**: Semi-infinite, homogeneous, isotropic, linear elastic half-space.\n- **Loading**: A rigid square footing of side length $B$ imposes a uniform vertical pressure $q$ over the area $\\{(x,y): |x| \\leq B/2, |y| \\leq B/2\\}$.\n- **Coordinate System**: Origin at the center of the footing on the surface, $z$-axis pointing downward into the half-space.\n- **Point of Interest**: $(r=0, z)$, i.e., at depth $z$ directly beneath the center of the footing.\n- **Assumptions**: Small-strain linear elasticity, body forces are neglected.\n- **Methodology**:\n    1.  Start with the axi-symmetric Green’s function (Boussinesq’s solution) for a vertical point load $P$.\n    2.  State the nonzero stress components beneath the point load in cylindrical coordinates.\n    3.  Use linear superposition to find the vertical stress from the distributed load.\n    4.  The uniformly loaded square is to be approximated by an $M \\times M$ array of equal square subareas.\n    5.  Each subarea is replaced by a vertical point load at its centroid, with magnitude equal to the load over that subarea.\n- **Required Output**:\n    1.  The dimensionless influence factor $I(M,\\eta) = \\sigma_{z}(0,z)/q$.\n    2.  The dimensionless depth parameter is $\\eta = z/B$.\n    3.  The final expression for $I(M,\\eta)$ must be a closed analytic form as a finite double sum over the $M \\times M$ centroid positions, expressed entirely in terms of $M$ and $\\eta$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the classical theory of linear elasticity, specifically Boussinesq's solution for a half-space, which is a cornerstone of soil mechanics and geomechanics. The principle of linear superposition is valid for a linear elastic material. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-defined. It specifies the geometry, material behavior, loading, and a clear methodology (discretization and superposition) to arrive at an approximate solution. The required output is a specific analytical expression, which is uniquely determined by the prescribed method.\n- **Objective**: The problem statement is written in precise, unbiased technical language, free of any subjective or ambiguous terms.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard exercise in applying fundamental principles of continuum mechanics. I will now proceed with the solution.\n\n#### Boussinesq's Solution for a Point Load\nThe problem begins with Boussinesq's solution for a vertical point load $P$ applied at the origin on the surface of a linear elastic half-space. The stress components in a cylindrical coordinate system $(r, z)$ are functions of the load $P$, the coordinates $(r,z)$, and the material's Poisson's ratio, $\\nu$. The problem asks for the nonzero stress components beneath the point load, which corresponds to the axis $r=0$. Due to axial symmetry, all shear stresses are zero on this axis. The nonzero stress components are the principal stresses $\\sigma_z$, $\\sigma_r$, and $\\sigma_\\theta$.\n\nAt a point $(0, z)$ on the axis of the load, these are given by:\n-   Vertical stress: $\\sigma_z(0, z) = \\frac{3P}{2\\pi z^2}$\n-   Radial stress: $\\sigma_r(0, z) = -\\frac{P(1-2\\nu)}{4\\pi z^2}$\n-   Hoop stress: $\\sigma_\\theta(0, z) = \\sigma_r(0, z) = -\\frac{P(1-2\\nu)}{4\\pi z^2}$\n\nFor the main part of the problem, we only need the vertical stress component $\\sigma_z$ at a general point $(r, z)$, which is given by:\n$$\n\\sigma_z(r, z) = \\frac{3P}{2\\pi} \\frac{z^3}{(r^2 + z^2)^{5/2}}\n$$\n\n#### Discretization and Superposition\nThe square footing of side length $B$ is subjected to a uniform pressure $q$. The total load is $qB^2$. We discretize the loaded area into an $M \\times M$ grid of smaller, equal square subareas.\n\n-   The side length of each subarea is $b = B/M$.\n-   The area of each subarea is $A_{sub} = b^2 = (B/M)^2 = B^2/M^2$.\n-   The load on each subarea is treated as a concentrated point load, $dP$, applied at the centroid of the subarea. The magnitude of this point load is:\n    $$\n    dP = q \\cdot A_{sub} = q \\frac{B^2}{M^2}\n    $$\nWe define a coordinate system with the origin at the center of the footing. The subareas are indexed by $i$ and $j$, where $i, j \\in \\{1, 2, \\dots, M\\}$. The centroid of the $(i, j)$-th subarea has coordinates $(x_i, y_j)$. The $x$-coordinate of the centroid of the $i$-th column of subareas is given by:\n$$\nx_i = -\\frac{B}{2} + (i - \\frac{1}{2}) \\frac{B}{M} = \\frac{B}{M} \\left(i - \\frac{1}{2} - \\frac{M}{2}\\right) = \\frac{B}{M} \\left(i - \\frac{M+1}{2}\\right)\n$$\nSimilarly, the $y$-coordinate of the centroid of the $j$-th row of subareas is:\n$$\ny_j = \\frac{B}{M} \\left(j - \\frac{M+1}{2}\\right)\n$$\n\nThe vertical stress $\\sigma_z(0, z)$ at the point of interest $(0, 0, z)$ is found by superposing the contributions from each of the $M^2$ point loads. The contribution from the load $dP$ at $(x_i, y_j)$ is found using the Boussinesq formula, where the horizontal distance from the load to the point of evaluation is $r_{ij} = \\sqrt{x_i^2 + y_j^2}$.\nThe stress contribution from subarea $(i,j)$ is $d\\sigma_{z,ij}$:\n$$\nd\\sigma_{z,ij} = \\frac{3(dP)}{2\\pi} \\frac{z^3}{(r_{ij}^2 + z^2)^{5/2}} = \\frac{3}{2\\pi} \\left(q \\frac{B^2}{M^2}\\right) \\frac{z^3}{(x_i^2 + y_j^2 + z^2)^{5/2}}\n$$\nThe total vertical stress is the sum of all contributions:\n$$\n\\sigma_z(0, z) = \\sum_{i=1}^{M} \\sum_{j=1}^{M} d\\sigma_{z,ij} = \\sum_{i=1}^{M} \\sum_{j=1}^{M} \\frac{3qB^2}{2\\pi M^2} \\frac{z^3}{(x_i^2 + y_j^2 + z^2)^{5/2}}\n$$\n\n#### Non-dimensionalization\nThe problem requires the result to be expressed in terms of the dimensionless influence factor $I(M,\\eta) = \\sigma_z(0,z)/q$ and the dimensionless depth $\\eta = z/B$.\n$$\nI(M,\\eta) = \\frac{\\sigma_z(0, z)}{q} = \\sum_{i=1}^{M} \\sum_{j=1}^{M} \\frac{3B^2}{2\\pi M^2} \\frac{z^3}{(x_i^2 + y_j^2 + z^2)^{5/2}}\n$$\nWe substitute the expressions for $x_i$, $y_j$, and $z = \\eta B$:\n$$\nx_i^2 + y_j^2 + z^2 = \\left[\\frac{B}{M}\\left(i - \\frac{M+1}{2}\\right)\\right]^2 + \\left[\\frac{B}{M}\\left(j - \\frac{M+1}{2}\\right)\\right]^2 + (\\eta B)^2\n$$\nFactoring out $B^2$:\n$$\nx_i^2 + y_j^2 + z^2 = B^2 \\left[ \\frac{1}{M^2}\\left(i - \\frac{M+1}{2}\\right)^2 + \\frac{1}{M^2}\\left(j - \\frac{M+1}{2}\\right)^2 + \\eta^2 \\right]\n$$\nNow we substitute this into the denominator of the expression for $I(M,\\eta)$:\n$$\n(x_i^2 + y_j^2 + z^2)^{5/2} = \\left(B^2\\right)^{5/2} \\left[ \\frac{1}{M^2}\\left\\{\\left(i - \\frac{M+1}{2}\\right)^2 + \\left(j - \\frac{M+1}{2}\\right)^2\\right\\} + \\eta^2 \\right]^{5/2}\n$$\n$$\n(x_i^2 + y_j^2 + z^2)^{5/2} = B^5 \\left[ \\frac{1}{M^2}\\left\\{\\left(i - \\frac{M+1}{2}\\right)^2 + \\left(j - \\frac{M+1}{2}\\right)^2\\right\\} + \\eta^2 \\right]^{5/2}\n$$\nThe numerator of the summation term is $3B^2 z^3 = 3B^2 (\\eta B)^3 = 3\\eta^3 B^5$.\nSubstituting back into the expression for $I(M,\\eta)$:\n$$\nI(M,\\eta) = \\sum_{i=1}^{M} \\sum_{j=1}^{M} \\frac{3\\eta^3 B^5}{2\\pi M^2 \\left( B^5 \\left[ \\frac{1}{M^2}\\left\\{\\left(i - \\frac{M+1}{2}\\right)^2 + \\left(j - \\frac{M+1}{2}\\right)^2\\right\\} + \\eta^2 \\right]^{5/2} \\right)}\n$$\nThe $B^5$ terms cancel, yielding the final dimensionless expression:\n$$\nI(M,\\eta) = \\sum_{i=1}^{M} \\sum_{j=1}^{M} \\frac{3\\eta^3}{2\\pi M^2} \\left[ \\frac{1}{M^2}\\left\\{\\left(i - \\frac{M+1}{2}\\right)^2 + \\left(j - \\frac{M+1}{2}\\right)^2\\right\\} + \\eta^2 \\right]^{-5/2}\n$$\nThis is the required closed analytic form for the influence factor as a finite double sum in terms of $M$ and $\\eta$.",
            "answer": "$$\n\\boxed{\\sum_{i=1}^{M} \\sum_{j=1}^{M} \\frac{3\\eta^3}{2\\pi M^2} \\left[ \\frac{1}{M^2}\\left(\\left(i - \\frac{M+1}{2}\\right)^2 + \\left(j - \\frac{M+1}{2}\\right)^2\\right) + \\eta^2 \\right]^{-5/2}}\n$$"
        },
        {
            "introduction": "A safe foundation must not only avoid catastrophic collapse but also perform its function without excessive movement. This exercise places you in the role of a design engineer, applying the principles of Limit State Design to a mat foundation on clay . You will calculate the allowable bearing pressure based on two distinct criteria—the Ultimate Geotechnical State (UGS) for structural safety and the Serviceability Limit State (SLS) for controlling settlement—and determine which constraint governs the final design.",
            "id": "3500565",
            "problem": "A rigid mat foundation of very large plan dimensions is placed directly on a saturated, homogeneous clay layer of thickness $H$ over a rigid base. The mat is sufficiently large compared to $H$ that, for serviceability calculations, the stress increment within the clay can be idealized as spatially uniform and equal to the applied uniform contact pressure $q$ over the entire thickness $H$. The clay is modeled as a linear, isotropic, small-strain, one-dimensional compressible material in the operational stress range, characterized by a constrained modulus $M$ (that is, axial strain equals vertical stress increment divided by $M$ under zero lateral strain). The foundation must satisfy both the Serviceability Limit State (SLS), which limits the total settlement, and the Ultimate Geotechnical State (UGS), which limits the mobilized bearing resistance.\n\nGiven:\n- Allowable total settlement for SLS, $s_{allow} = 25$ mm,\n- Constrained modulus, $M = 30$ MPa,\n- Clay layer thickness, $H = 4.0$ m,\n- Computed ultimate bearing capacity from a rigorous geomechanical analysis, $q_u = 600$ kPa,\n- Required factor of safety against ultimate failure, $FS = 3$.\n\nStarting from fundamental definitions of strain and stress in linear elasticity under one-dimensional constrained compression, determine the allowable uniform contact pressure $q_{allow}$ that simultaneously satisfies SLS and UGS. Express $q_{allow}$ in kilopascals and round your answer to three significant figures. In your reasoning, indicate which limit state governs the final design value. The final numeric answer must be a single value for $q_{allow}$.",
            "solution": "The problem statement will first be validated for scientific soundness, completeness, and consistency before a solution is attempted.\n\n### Step 1: Extract Givens\nThe following data and definitions are provided in the problem statement:\n-   A rigid mat foundation of very large plan dimensions.\n-   The foundation is on a saturated, homogeneous clay layer over a rigid base.\n-   Clay layer thickness: $H = 4.0$ m.\n-   The stress increment is idealized as a spatially uniform contact pressure $q$ over the entire thickness $H$.\n-   The clay is modeled as a linear, isotropic, small-strain, one-dimensional compressible material.\n-   The constitutive relationship is given by: axial strain equals vertical stress increment divided by the constrained modulus $M$.\n-   Constrained modulus: $M = 30$ MPa.\n-   Allowable total settlement for Serviceability Limit State (SLS): $s_{allow} = 25$ mm.\n-   Ultimate bearing capacity: $q_u = 600$ kPa.\n-   Required factor of safety for Ultimate Geotechnical State (UGS): $FS = 3$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the required criteria:\n-   **Scientifically Grounded:** The problem uses fundamental concepts from soil mechanics and foundation engineering, including one-dimensional consolidation theory, limit state design (SLS and UGS), ultimate bearing capacity, and factor of safety. The idealization of a large mat foundation causing uniform stress increase for one-dimensional settlement calculation is a standard and valid engineering practice. The use of a constrained modulus $M$ to relate stress and strain is a direct application of linear elasticity under constrained boundary conditions, which is a common soil model for small-strain analysis. All concepts are well-established.\n-   **Well-Posed:** The problem provides a clear objective (determine $q_{allow}$) with a complete set of constraints (SLS and UGS). The data are sufficient to calculate the allowable pressure for each limit state. The final answer is the minimum of these two values, leading to a unique solution.\n-   **Objective:** The problem is stated using precise, quantitative, and unbiased technical language.\n-   **Completeness and Consistency:** All necessary parameters ($H$, $M$, $s_{allow}$, $q_u$, $FS$) are provided. A unit consistency check is required.\n    -   $s_{allow} = 25$ mm $= 0.025$ m.\n    -   $M = 30$ MPa $= 30 \\times 10^3$ kPa.\n    -   $H = 4.0$ m.\n    -   $q_u = 600$ kPa.\n    -   $FS = 3$ (dimensionless).\n    All units are consistent within the SI system, using kilopascals (kPa) for pressure/stress and meters (m) for length. There are no contradictions.\n-   **Realism:** The given values for clay thickness, constrained modulus, settlement allowance, ultimate capacity, and factor of safety are all within realistic ranges for typical civil engineering projects.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, complete, consistent, and realistic. It is therefore deemed **valid**. A full solution will be provided.\n\nThe objective is to determine the allowable uniform contact pressure, $q_{allow}$, that simultaneously satisfies two conditions: the Serviceability Limit State (SLS) and the Ultimate Geotechnical State (UGS). This requires calculating the maximum pressure permitted by each limit state and selecting the more restrictive (i.e., lower) value.\n\n**1. Serviceability Limit State (SLS) Analysis**\nThe SLS is governed by the allowable settlement, $s_{allow}$. We must find the pressure, $q_{SLS}$, that would cause this exact amount of settlement.\n\nAccording to the problem statement, the clay behaves as a one-dimensional compressible material. The vertical strain, $\\epsilon_z$, under a vertical stress increment, $\\Delta\\sigma_v$, is given by the constitutive law:\n$$\n\\epsilon_z = \\frac{\\Delta\\sigma_v}{M}\n$$\nThe problem specifies that the stress increment within the clay is uniform and equal to the applied contact pressure, so $\\Delta\\sigma_v = q$.\n$$\n\\epsilon_z = \\frac{q}{M}\n$$\nFor small strains, the vertical strain is also defined as the total settlement (change in thickness), $s$, divided by the initial thickness of the clay layer, $H$.\n$$\n\\epsilon_z = \\frac{s}{H}\n$$\nEquating the two expressions for strain gives the relationship between pressure and settlement:\n$$\n\\frac{s}{H} = \\frac{q}{M}\n$$\nSolving for the settlement $s$:\n$$\ns = \\frac{qH}{M}\n$$\nThe SLS condition is that the calculated settlement $s$ must not exceed the allowable settlement $s_{allow}$:\n$$\ns \\le s_{allow}\n$$\nSubstituting the expression for $s$, we find the constraint on the pressure $q$:\n$$\n\\frac{qH}{M} \\le s_{allow}\n$$\nThe maximum pressure that satisfies the SLS criterion, which we denote as $q_{SLS}$, is therefore:\n$$\nq_{SLS} = \\frac{s_{allow} M}{H}\n$$\nWe now substitute the given values, ensuring unit consistency. Let's use kPa for pressure/modulus and meters for length.\n-   $s_{allow} = 25$ mm $= 0.025$ m.\n-   $M = 30$ MPa $= 30,000$ kPa.\n-   $H = 4.0$ m.\n\n$$\nq_{SLS} = \\frac{(0.025 \\, \\text{m}) \\times (30,000 \\, \\text{kPa})}{4.0 \\, \\text{m}} = \\frac{750 \\, \\text{kPa} \\cdot \\text{m}}{4.0 \\, \\text{m}} = 187.5 \\, \\text{kPa}\n$$\nSo, the maximum allowable pressure based on the serviceability limit is $187.5$ kPa.\n\n**2. Ultimate Geotechnical State (UGS) Analysis**\nThe UGS is concerned with ensuring the foundation is safe from catastrophic bearing failure. This is managed by applying a factor of safety, $FS$, to the ultimate bearing capacity, $q_u$.\n\nThe allowable bearing capacity, which we denote as $q_{UGS}$, is defined as:\n$$\nq_{UGS} = \\frac{q_u}{FS}\n$$\nThe UGS condition is that the applied pressure $q$ must not exceed this allowable bearing capacity:\n$$\nq \\le q_{UGS}\n$$\nSubstituting the given values:\n-   $q_u = 600$ kPa.\n-   $FS = 3$.\n\n$$\nq_{UGS} = \\frac{600 \\, \\text{kPa}}{3} = 200 \\, \\text{kPa}\n$$\nSo, the maximum allowable pressure based on the ultimate geotechnical state is $200$ kPa.\n\n**3. Determination of Allowable Contact Pressure, $q_{allow}$**\nThe design must satisfy both the SLS and UGS conditions. This means the applied pressure $q$ must be less than or equal to both $q_{SLS}$ and $q_{UGS}$. Therefore, the overall allowable contact pressure, $q_{allow}$, is the minimum of the two values:\n$$\nq_{allow} = \\min(q_{SLS}, q_{UGS})\n$$\nSubstituting the calculated values:\n$$\nq_{allow} = \\min(187.5 \\, \\text{kPa}, 200 \\, \\text{kPa}) = 187.5 \\, \\text{kPa}\n$$\nThe lower value comes from the Serviceability Limit State. Therefore, the design is **governed by settlement (SLS)**.\n\nThe problem requires the final answer to be rounded to three significant figures.\n$$\nq_{allow} = 187.5 \\, \\text{kPa} \\approx 188 \\, \\text{kPa}\n$$\nThe allowable uniform contact pressure is $188$ kPa.",
            "answer": "$$\n\\boxed{188}\n$$"
        },
        {
            "introduction": "Geotechnical design is inherently uncertain due to the natural variability of soil properties. This computational practice introduces you to sensitivity analysis, a powerful method for quantifying how uncertainty in soil parameters, such as the friction angle $\\phi'$ and unit weight $\\gamma$, affects the calculated bearing capacity . By deriving and implementing the sensitivity indices, you will develop a crucial skill for reliability-based design: identifying which parameters have the most influence on safety and therefore demand the most careful characterization.",
            "id": "3500555",
            "problem": "You are to design and implement a complete computational procedure for a local, derivative-based sensitivity study of the ultimate bearing capacity of a shallow strip footing resting on a dry, homogeneous, isotropic, cohesionless soil under vertical centric loading. Your work must begin from fundamental principles consistent with the theory of plasticity-based bearing capacity for shallow foundations and standard definitions of bearing capacity factors as functions of the effective friction angle. You must then derive the governing expressions needed for sensitivity quantification.\n\nAssumptions and modeling scope:\n- The soil is drained and cohesionless, so the effective cohesion is $c' = 0$.\n- The footing is a long strip footing with width $B$ embedded at depth $D_f$ in a dry soil with total unit weight $\\gamma$.\n- The foundation is loaded centrally and vertically; shape, load inclination, and depth factors are taken as unity.\n- The surcharge at the foundation base is $q = \\gamma D_f$.\n- The effective stress friction angle is $\\phi'$, to be expressed in radians.\n- All physical computations of ultimate bearing capacity must be expressed in kilopascals, that is, $\\mathrm{kPa}$, and all lengths in meters, that is, $\\mathrm{m}$, and unit weight in kilonewtons per cubic meter, that is, $\\mathrm{kN/m^3}$.\n\nTasks:\n- Starting from the concept of limit analysis for shallow foundation bearing capacity and the definition that the ultimate bearing capacity $q_u$ is the sum of contributions from surcharge and self-weight of soil mobilized by plastic collapse, derive the formula for $q_u$ for a cohesionless soil in terms of $B$, $D_f$, $\\gamma$, and $\\phi'$, using classical bearing capacity factors that depend only on $\\phi'$.\n- Derive closed-form expressions for the bearing capacity factors $N_q(\\phi')$ and $N_\\gamma(\\phi')$ from standard, well-tested definitions consistent with classical solutions, and obtain their derivatives with respect to $\\phi'$ needed for sensitivity analysis.\n- Define and compute the local, dimensionless sensitivity indices at a given nominal parameter point $(\\phi', \\gamma)$:\n  - $S_{\\phi'} = \\left| \\dfrac{\\partial q_u}{\\partial \\phi'} \\dfrac{\\phi'}{q_u} \\right|$,\n  - $S_{\\gamma} = \\left| \\dfrac{\\partial q_u}{\\partial \\gamma} \\dfrac{\\gamma}{q_u} \\right|$.\n- Use the above to decide which parameter is locally more influential at the nominal point, according to the criterion:\n  - If $S_{\\phi'} - S_{\\gamma} > 0$ by more than a tolerance $\\varepsilon$, then $\\phi'$ is more influential.\n  - If $S_{\\gamma} - S_{\\phi'} > 0$ by more than $\\varepsilon$, then $\\gamma$ is more influential.\n  - Otherwise, treat as a tie. Use $\\varepsilon = 10^{-9}$.\n\nAngle unit requirement:\n- All angles must be in radians.\n\nUnits requirement:\n- Compute $q_u$ in $\\mathrm{kPa}$, using $B$ in $\\mathrm{m}$, $D_f$ in $\\mathrm{m}$, and $\\gamma$ in $\\mathrm{kN/m^3}$.\n\nTest suite:\n- Provide results for the following four test cases, each specified as $(B, D_f, \\phi', \\gamma)$ with $B$ in $\\mathrm{m}$, $D_f$ in $\\mathrm{m}$, $\\phi'$ in $\\mathrm{rad}$, and $\\gamma$ in $\\mathrm{kN/m^3}$:\n  - Case $1$: $(B, D_f, \\phi', \\gamma) = (\\,2.0,\\,1.0,\\,0.6108652381980153,\\,18.0\\,)$.\n  - Case $2$: $(B, D_f, \\phi', \\gamma) = (\\,1.5,\\,0.5,\\,0.4363323129985824,\\,16.0\\,)$.\n  - Case $3$: $(B, D_f, \\phi', \\gamma) = (\\,1.0,\\,0.0,\\,0.5235987755982988,\\,17.0\\,)$.\n  - Case $4$: $(B, D_f, \\phi', \\gamma) = (\\,3.0,\\,1.0,\\,0.7330382858376184,\\,20.0\\,)$.\n\nProgram output specification:\n- For each test case, output a single integer code indicating the most influential parameter at the nominal point:\n  - Output $0$ if $\\phi'$ is more influential.\n  - Output $1$ if $\\gamma$ is more influential.\n  - Output $2$ if they are tied within tolerance $\\varepsilon$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4]$, where each $r_i$ is an integer code for case $i$.",
            "solution": "The user wants a computational procedure for a sensitivity analysis of shallow foundation bearing capacity.\n\n### Step 1: Problem Validation\n\nThe problem statement is validated against the required criteria.\n\n#### Givens Extraction\n- **Soil Properties**: Drained, cohesionless ($c' = 0$), dry, homogeneous, isotropic soil.\n- **Foundation Geometry**: Long strip footing, width $B$, embedment depth $D_f$.\n- **Loading**: Vertical and centric.\n- **Parameters**: Total unit weight $\\gamma$, effective stress friction angle $\\phi'$.\n- **Assumptions**:\n    - $c' = 0$.\n    - Surcharge at foundation base: $q = \\gamma D_f$.\n    - Shape, load inclination, and depth factors are unity.\n- **Governing Equation (General Form)**: Ultimate bearing capacity $q_u$ is the sum of contributions from surcharge and self-weight of soil.\n- **Bearing Capacity Factors**: $N_q$ and $N_\\gamma$ are functions of $\\phi'$ only.\n- **Sensitivity Indices**:\n    - $S_{\\phi'} = \\left| \\dfrac{\\partial q_u}{\\partial \\phi'} \\dfrac{\\phi'}{q_u} \\right|$\n    - $S_{\\gamma} = \\left| \\dfrac{\\partial q_u}{\\partial \\gamma} \\dfrac{\\gamma}{q_u} \\right|$\n- **Decision Criterion**: Compare $S_{\\phi'}$ and $S_{\\gamma}$ using a tolerance $\\varepsilon = 10^{-9}$. If $S_{\\phi'} - S_{\\gamma} > \\varepsilon$, $\\phi'$ is more influential. If $S_{\\gamma} - S_{\\phi'} > \\varepsilon$, $\\gamma$ is more influential. Otherwise, they are tied.\n- **Units**: $q_u$ in $\\mathrm{kPa}$, lengths ($B, D_f$) in $\\mathrm{m}$, $\\gamma$ in $\\mathrm{kN/m^3}$, $\\phi'$ in radians.\n- **Test Cases**:\n    1. $(B, D_f, \\phi', \\gamma) = (2.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 0.6108652381980153\\,\\mathrm{rad}, 18.0\\,\\mathrm{kN/m^3})$\n    2. $(B, D_f, \\phi', \\gamma) = (1.5\\,\\mathrm{m}, 0.5\\,\\mathrm{m}, 0.4363323129985824\\,\\mathrm{rad}, 16.0\\,\\mathrm{kN/m^3})$\n    3. $(B, D_f, \\phi', \\gamma) = (1.0\\,\\mathrm{m}, 0.0\\,\\mathrm{m}, 0.5235987755982988\\,\\mathrm{rad}, 17.0\\,\\mathrm{kN/m^3})$\n    4. $(B, D_f, \\phi', \\gamma) = (3.0\\,\\mathrm{m}, 1.0\\,\\mathrm{m}, 0.7330382858376184\\,\\mathrm{rad}, 20.0\\,\\mathrm{kN/m^3})$\n\n#### Validation Assessment\n- **Scientifically Grounded**: The problem is based on the classical theory of plasticity for determining the bearing capacity of shallow foundations, a cornerstone of geotechnical engineering. The use of bearing capacity factors $N_q$ and $N_\\gamma$ as functions of $\\phi'$ is standard practice. The sensitivity analysis is a standard mathematical technique. The problem is scientifically sound.\n- **Well-Posed**: All necessary parameters, equations, and criteria are provided. The request to use \"standard, well-tested definitions\" for $N_q$ and $N_\\gamma$ is specific enough to allow for the selection of widely accepted formulas (e.g., Prandtl, Vesic). The problem is structured to lead to a unique numerical answer for each test case.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased technical language.\n- **Complete and Consistent**: The problem is self-contained. All data for the test cases are provided. The unit system ($\\mathrm{kPa}$, $\\mathrm{m}$, $\\mathrm{kN/m^3}$) is internally consistent, as $1\\,\\mathrm{kN/m^2} = 1\\,\\mathrm{kPa}$. The requirement for angles to be in radians is clear.\n\n#### Verdict\nThe problem is valid. It is a well-defined computational task in geotechnical engineering.\n\n### Step 2: Derivation of Analytical Expressions\n\n#### Ultimate Bearing Capacity, $q_u$\nThe general equation for the ultimate bearing capacity of a strip footing is:\n$$q_u = c'N_c s_c d_c i_c + qN_q s_q d_q i_q + 0.5 \\gamma B N_\\gamma s_\\gamma d_\\gamma i_\\gamma$$\nApplying the problem's simplifying assumptions:\n- Cohesionless soil, $c' = 0$: The first term vanishes.\n- Strip footing, vertical and centric load, and the explicit assumption that all shape, depth, and inclination factors are unity ($s_q = s_\\gamma = d_q = d_\\gamma = i_q = i_\\gamma = 1$).\n- Surcharge at foundation depth is $q = \\gamma D_f$.\n\nThe equation simplifies to:\n$$q_u = (\\gamma D_f) N_q(\\phi') + 0.5 \\gamma B N_\\gamma(\\phi')$$\nThis is the governing equation for $q_u$. It can be factored as:\n$$q_u = \\gamma (D_f N_q(\\phi') + 0.5 B N_\\gamma(\\phi'))$$\n\n#### Bearing Capacity Factors and Their Derivatives\nStandard expressions for $N_q$ and $N_\\gamma$ and their derivatives with respect to $\\phi'$ are required. All angles must be in radians.\n\n1.  **Bearing Capacity Factor $N_q(\\phi')$**: The exact solution from plasticity theory by Prandtl is used.\n    $$N_q(\\phi') = e^{\\pi \\tan \\phi'} \\tan^2\\left(\\frac{\\pi}{4} + \\frac{\\phi'}{2}\\right)$$\n\n2.  **Derivative of $N_q(\\phi')$**: We differentiate $N_q$ with respect to $\\phi'$ using the product rule and chain rule. A simplified expression for the derivative is:\n    $$\\frac{dN_q}{d\\phi'} = N_q(\\phi') \\left( \\frac{\\pi}{\\cos^2 \\phi'} + \\frac{2}{\\cos \\phi'} \\right)$$\n\n3.  **Bearing Capacity Factor $N_\\gamma(\\phi')$**: A widely used and well-tested expression is that proposed by Vesic (1975), which relates $N_\\gamma$ to $N_q$.\n    $$N_\\gamma(\\phi') = 2(N_q(\\phi') + 1) \\tan \\phi'$$\n\n4.  **Derivative of $N_\\gamma(\\phi')$**: Using the product rule on the expression for $N_\\gamma$:\n    $$\\frac{dN_\\gamma}{d\\phi'} = \\frac{d}{d\\phi'} [2(N_q + 1) \\tan \\phi']$$\n    $$\\frac{dN_\\gamma}{d\\phi'} = \\left(2 \\frac{dN_q}{d\\phi'}\\right) (\\tan \\phi') + (2(N_q + 1)) (\\sec^2 \\phi')$$\n    $$\\frac{dN_\\gamma}{d\\phi'} = 2 \\frac{dN_q}{d\\phi'} \\tan \\phi' + \\frac{2(N_q + 1)}{\\cos^2 \\phi'}$$\n\n#### Sensitivity Indices\nThe dimensionless sensitivity indices $S_{\\phi'}$ and $S_{\\gamma}$ are computed.\n\n1.  **Sensitivity to Soil Unit Weight, $S_\\gamma$**:\n    We differentiate $q_u$ with respect to $\\gamma$:\n    $$\\frac{\\partial q_u}{\\partial \\gamma} = \\frac{\\partial}{\\partial \\gamma} [\\gamma (D_f N_q + 0.5 B N_\\gamma)] = D_f N_q + 0.5 B N_\\gamma = \\frac{q_u}{\\gamma}$$\n    Substituting this into the definition of $S_\\gamma$:\n    $$S_{\\gamma} = \\left| \\frac{\\partial q_u}{\\partial \\gamma} \\frac{\\gamma}{q_u} \\right| = \\left| \\frac{q_u}{\\gamma} \\frac{\\gamma}{q_u} \\right| = |1| = 1$$\n    The sensitivity of $q_u$ to $\\gamma$ is unity, reflecting the linear relationship between them.\n\n2.  **Sensitivity to Friction Angle, $S_{\\phi'}$**:\n    We differentiate $q_u$ with respect to $\\phi'$:\n    $$\\frac{\\partial q_u}{\\partial \\phi'} = \\gamma \\left(D_f \\frac{dN_q}{d\\phi'} + 0.5 B \\frac{dN_\\gamma}{d\\phi'}\\right)$$\n    The sensitivity index is then:\n    $$S_{\\phi'} = \\left| \\frac{\\partial q_u}{\\partial \\phi'} \\frac{\\phi'}{q_u} \\right| = \\left| \\frac{\\gamma \\left(D_f \\frac{dN_q}{d\\phi'} + 0.5 B \\frac{dN_\\gamma}{d\\phi'}\\right)}{\\gamma (D_f N_q + 0.5 B N_\\gamma)} \\phi' \\right|$$\n    Since $B, D_f, \\gamma, \\phi'$ are positive, and $N_q, N_\\gamma$ and their derivatives are positive for $\\phi' \\in (0, \\pi/2)$, the term inside the absolute value is positive. Thus:\n    $$S_{\\phi'} = \\frac{D_f \\frac{dN_q}{d\\phi'} + 0.5 B \\frac{dN_\\gamma}{d\\phi'}}{D_f N_q + 0.5 B N_\\gamma} \\phi'$$\n\n### Step 3: Computational Procedure\nThe final step is to implement these derived formulas to analyze the test cases.\n1.  For each test case $(B, D_f, \\phi', \\gamma)$, compute the necessary trigonometric terms for the given $\\phi'$.\n2.  Calculate $N_q(\\phi')$ and its derivative $\\frac{dN_q}{d\\phi'}$.\n3.  Calculate $N_\\gamma(\\phi')$ and its derivative $\\frac{dN_\\gamma}{d\\phi'}$.\n4.  Calculate the sensitivity index $S_{\\phi'}$.\n5.  Compare $S_{\\phi'}$ with $S_\\gamma = 1$ using the specified tolerance $\\varepsilon = 10^{-9}$.\n    - If $S_{\\phi'} - 1 > 10^{-9}$, the result is $0$ ($\\phi'$ is more influential).\n    - If $1 - S_{\\phi'} > 10^{-9}$, the result is $1$ ($\\gamma$ is more influential).\n    - Otherwise, the result is $2$ (tied).\nThis procedure will be encapsulated in a Python program.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the shallow foundation sensitivity analysis problem for a suite of test cases.\n    \"\"\"\n    \n    # Test cases: (B [m], Df [m], phi' [rad], gamma [kN/m^3])\n    test_cases = [\n        (2.0, 1.0, 0.6108652381980153, 18.0), # Case 1: 35 degrees\n        (1.5, 0.5, 0.4363323129985824, 16.0), # Case 2: 25 degrees\n        (1.0, 0.0, 0.5235987755982988, 17.0), # Case 3: 30 degrees (surface footing)\n        (3.0, 1.0, 0.7330382858376184, 20.0), # Case 4: 42 degrees\n    ]\n\n    results = []\n    for case in test_cases:\n        result_code = analyze_influence(*case)\n        results.append(result_code)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analyze_influence(B, Df, phi_rad, gamma):\n    \"\"\"\n    Analyzes the local sensitivity of the ultimate bearing capacity to the\n    friction angle (phi') and soil unit weight (gamma).\n\n    Args:\n        B (float): Width of the strip footing in meters.\n        Df (float): Depth of embedment of the footing in meters.\n        phi_rad (float): Effective stress friction angle in radians.\n        gamma (float): Total unit weight of the soil in kN/m^3.\n\n    Returns:\n        int: An integer code indicating the most influential parameter:\n             0 for phi', 1 for gamma, 2 for a tie.\n    \"\"\"\n    epsilon = 1e-9\n\n    # 1. Calculate bearing capacity factors and their derivatives\n    \n    # Helper trigonometric terms\n    tan_phi = np.tan(phi_rad)\n    cos_phi = np.cos(phi_rad)\n    sec2_phi = 1.0 / (cos_phi**2)\n    \n    # Nq (Prandtl, 1921)\n    half_angle_term = np.pi / 4.0 + phi_rad / 2.0\n    tan_half_sq = np.tan(half_angle_term)**2\n    Nq = np.exp(np.pi * tan_phi) * tan_half_sq\n\n    # dNq/d(phi')\n    # Simplified form: dNq/d(phi') = Nq * (pi * sec^2(phi) + 2 / cos(phi))\n    dNq_dphi = Nq * (np.pi * sec2_phi + 2.0 / cos_phi)\n    \n    # N_gamma (Vesic, 1975)\n    N_gamma = 2.0 * (Nq + 1.0) * tan_phi\n    \n    # d(N_gamma)/d(phi')\n    # dN_gamma/d(phi') = 2 * (dNq/d(phi')) * tan(phi) + 2 * (Nq + 1) * sec^2(phi)\n    dN_gamma_dphi = 2.0 * dNq_dphi * tan_phi + 2.0 * (Nq + 1.0) * sec2_phi\n\n    # 2. Calculate ultimate bearing capacity qu\n    # qu = gamma * (Df * Nq + 0.5 * B * N_gamma)\n    # This value must be positive for the given inputs to avoid division by zero.\n    \n    # 3. Calculate sensitivity indices\n    \n    # S_gamma is analytically 1\n    S_gamma = 1.0\n\n    # S_phi = |(d(qu)/d(phi')) * (phi'/qu)|\n    # Since all parameters and factors are positive, the absolute value is not needed.\n    # S_phi = ((Df*dNq_dphi + 0.5*B*dN_gamma_dphi) / (Df*Nq + 0.5*B*N_gamma)) * phi_rad\n    \n    # To avoid potential division by zero if Df=Nq=B=N_gamma=0, although not possible here.\n    # The term (gamma) cancels out from the numerator and denominator.\n    numerator_s_phi = Df * dNq_dphi + 0.5 * B * dN_gamma_dphi\n    denominator_s_phi = Df * Nq + 0.5 * B * N_gamma\n    \n    if abs(denominator_s_phi)  1e-12:\n        # This case should not occur with the given test data.\n        # It could happen if B, Df, phi_rad were all zero.\n        # If qu is zero, sensitivity is undefined. We can treat it as a tie.\n        return 2\n\n    S_phi = (numerator_s_phi / denominator_s_phi) * phi_rad\n\n    # 4. Compare sensitivities and return code\n    diff = S_phi - S_gamma\n    if diff > epsilon:\n        return 0  # phi' is more influential\n    elif diff  -epsilon:\n        return 1  # gamma is more influential\n    else:\n        return 2  # Tied\n\n# Execute the main function\nsolve()\n```"
        }
    ]
}