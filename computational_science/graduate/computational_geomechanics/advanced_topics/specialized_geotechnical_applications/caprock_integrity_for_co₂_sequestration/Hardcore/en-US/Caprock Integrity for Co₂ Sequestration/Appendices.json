{
    "hands_on_practices": [
        {
            "introduction": "The injection of CO₂ directly increases the pore pressure in the storage reservoir, which in turn alters the stress state within the overlying caprock. This fundamental hydro-mechanical (HM) coupling is a primary driver of geomechanical risk. This practice  guides you through the application of the effective stress principle and stress transformation rules to quantify the change in normal and shear stress on a potential plane of weakness, a foundational skill for assessing the risk of fault reactivation.",
            "id": "3505769",
            "problem": "A laterally extensive saline aquifer is being used for Carbon Dioxide (CO₂) injection beneath a shale caprock. Consider a point in the caprock immediately above the reservoir. A rapid increase of reservoir pore pressure produces an overpressure increment of $\\Delta p$ that induces a poroelastic total stress increment in the caprock at that point. Assume the caprock is linear elastic and, at the scale of interest, the induced total stress increment is spatially uniform and diagonal in the geographic Cartesian basis $(x,y,z)$ with $z$ vertical upward. Adopt the geomechanics sign convention that compressive stress is positive. The total stress increment tensor is approximated as\n$$\n\\Delta \\boldsymbol{\\sigma} = \\mathrm{diag}\\!\\left(c_h\\,\\Delta p,\\; c_h\\,\\Delta p,\\; c_v\\,\\Delta p\\right),\n$$\nwhere $c_h$ and $c_v$ are dimensionless coefficients characterizing the horizontal and vertical poroelastic stress coupling in the caprock near the reservoir-caprock interface.\n\nLet the caprock Biot effective stress coefficient be $\\alpha$, and use the effective stress definition $\\boldsymbol{\\sigma}'=\\boldsymbol{\\sigma}-\\alpha p\\,\\mathbf{I}$, where $\\mathbf{I}$ is the second-order identity. Consider a plane through the point whose unit normal $\\mathbf{n}$ is specified by spherical angles $(\\theta,\\phi)$ measured from the $z$-axis (polar) and from the $x$-axis within the $x$-$y$ plane (azimuth), respectively, with\n$$\n\\mathbf{n} = \\begin{pmatrix} \\sin\\theta \\cos\\phi \\\\ \\sin\\theta \\sin\\phi \\\\ \\cos\\theta \\end{pmatrix}.\n$$\n\nUsing Cauchy’s traction law and the effective stress principle, compute:\n- the change in effective normal stress on the plane, $\\Delta \\sigma'_{n}$, and\n- the magnitude of the change in effective shear traction on the plane, $\\Delta \\tau'$,\n\nresulting solely from the overpressure increment $\\Delta p$.\n\nUse the data: $\\Delta p = 12$ MPa, $c_h = 0.35$, $c_v = 0.15$, $\\alpha = 0.85$, $\\theta = 58^\\circ$, $\\phi = 22^\\circ$. Treat angles in degrees. Express your final answers in MPa, and round to four significant figures. Provide the final result as a two-entry row matrix $\\begin{pmatrix} \\Delta \\sigma'_{n}  \\Delta \\tau' \\end{pmatrix}$.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. There is a minor ambiguity regarding the pore pressure change in the caprock; however, it is reasonably resolved by assuming the pore pressure increment at the point of interest, which is \"immediately above the reservoir,\" is equal to the reservoir pressure increment $\\Delta p$. This implies hydraulic continuity at the interface for the purpose of this analysis. We may now proceed with the solution.\n\nThe problem requires the computation of the change in effective normal stress, $\\Delta \\sigma'_{n}$, and the magnitude of the change in effective shear traction, $\\Delta \\tau'$, on a specific plane within the caprock. The analysis is based on the principles of poroelasticity and continuum mechanics.\n\nFirst, we establish the change in the effective stress tensor, $\\Delta \\boldsymbol{\\sigma}'$. The effective stress principle, in its incremental form, relates the change in effective stress $\\Delta \\boldsymbol{\\sigma}'$ to the change in total stress $\\Delta \\boldsymbol{\\sigma}$ and the change in pore pressure $\\Delta p_c$ at the point of interest:\n$$\n\\Delta \\boldsymbol{\\sigma}' = \\Delta \\boldsymbol{\\sigma} - \\alpha \\Delta p_c \\mathbf{I}\n$$\nwhere $\\alpha$ is the Biot effective stress coefficient and $\\mathbf{I}$ is the second-order identity tensor. As reasoned during validation, we take the pore pressure increment in the caprock at the interface, $\\Delta p_c$, to be equal to the specified reservoir overpressure increment, $\\Delta p$.\n$$\n\\Delta \\boldsymbol{\\sigma}' = \\Delta \\boldsymbol{\\sigma} - \\alpha \\Delta p \\mathbf{I}\n$$\nThe problem provides the total stress increment tensor as:\n$$\n\\Delta \\boldsymbol{\\sigma} = \\mathrm{diag}\\!\\left(c_h\\,\\Delta p,\\; c_h\\,\\Delta p,\\; c_v\\,\\Delta p\\right) = \\Delta p \\begin{pmatrix} c_h  0  0 \\\\ 0  c_h  0 \\\\ 0  0  c_v \\end{pmatrix}\n$$\nSubstituting this into the equation for $\\Delta \\boldsymbol{\\sigma}'$:\n$$\n\\Delta \\boldsymbol{\\sigma}' = \\Delta p \\begin{pmatrix} c_h  0  0 \\\\ 0  c_h  0 \\\\ 0  0  c_v \\end{pmatrix} - \\alpha \\Delta p \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\Delta p \\begin{pmatrix} c_h - \\alpha  0  0 \\\\ 0  c_h - \\alpha  0 \\\\ 0  0  c_v - \\alpha \\end{pmatrix}\n$$\nNext, we use Cauchy’s traction law to find the effective traction vector increment, $\\Delta \\mathbf{t}'$, on the plane defined by the unit normal vector $\\mathbf{n}$.\n$$\n\\Delta \\mathbf{t}' = \\Delta \\boldsymbol{\\sigma}' \\mathbf{n}\n$$\nThe unit normal vector $\\mathbf{n}$ is given in spherical coordinates $(\\theta, \\phi)$:\n$$\n\\mathbf{n} = \\begin{pmatrix} n_x \\\\ n_y \\\\ n_z \\end{pmatrix} = \\begin{pmatrix} \\sin\\theta \\cos\\phi \\\\ \\sin\\theta \\sin\\phi \\\\ \\cos\\theta \\end{pmatrix}\n$$\nPerforming the matrix-vector multiplication:\n$$\n\\Delta \\mathbf{t}' = \\Delta p \\begin{pmatrix} (c_h - \\alpha) \\sin\\theta \\cos\\phi \\\\ (c_h - \\alpha) \\sin\\theta \\sin\\phi \\\\ (c_v - \\alpha) \\cos\\theta \\end{pmatrix}\n$$\nThe change in effective normal stress, $\\Delta \\sigma'_{n}$, is the component of the traction vector $\\Delta \\mathbf{t}'$ parallel to the normal vector $\\mathbf{n}$. This is obtained by the dot product $\\Delta \\mathbf{t}' \\cdot \\mathbf{n}$:\n$$\n\\Delta \\sigma'_{n} = \\Delta \\mathbf{t}' \\cdot \\mathbf{n} = (\\Delta \\mathbf{t}')^T \\mathbf{n}\n$$\n$$\n\\Delta \\sigma'_{n} = \\Delta p \\left[ (c_h - \\alpha) \\sin^2\\theta \\cos^2\\phi + (c_h - \\alpha) \\sin^2\\theta \\sin^2\\phi + (c_v - \\alpha) \\cos^2\\theta \\right]\n$$\nUsing the trigonometric identity $\\cos^2\\phi + \\sin^2\\phi = 1$:\n$$\n\\Delta \\sigma'_{n} = \\Delta p \\left[ (c_h - \\alpha) \\sin^2\\theta (\\cos^2\\phi + \\sin^2\\phi) + (c_v - \\alpha) \\cos^2\\theta \\right]\n$$\n$$\n\\Delta \\sigma'_{n} = \\Delta p \\left[ (c_h - \\alpha) \\sin^2\\theta + (c_v - \\alpha) \\cos^2\\theta \\right]\n$$\nThe magnitude of the change in effective shear traction, $\\Delta \\tau'$, is found using the relationship $|\\Delta \\mathbf{t}'|^2 = (\\Delta \\sigma'_{n})^2 + (\\Delta \\tau')^2$. Thus, $(\\Delta \\tau')^2 = |\\Delta \\mathbf{t}'|^2 - (\\Delta \\sigma'_{n})^2$. First, we compute the squared magnitude of the traction vector, $|\\Delta \\mathbf{t}'|^2 = \\Delta \\mathbf{t}' \\cdot \\Delta \\mathbf{t}'$:\n$$\n|\\Delta \\mathbf{t}'|^2 = (\\Delta p)^2 \\left[ (c_h - \\alpha)^2 \\sin^2\\theta \\cos^2\\phi + (c_h - \\alpha)^2 \\sin^2\\theta \\sin^2\\phi + (c_v - \\alpha)^2 \\cos^2\\theta \\right]\n$$\n$$\n|\\Delta \\mathbf{t}'|^2 = (\\Delta p)^2 \\left[ (c_h - \\alpha)^2 \\sin^2\\theta + (c_v - \\alpha)^2 \\cos^2\\theta \\right]\n$$\nNow we compute $(\\Delta \\tau')^2$:\n$$\n(\\Delta \\tau')^2 = (\\Delta p)^2 \\left[ (c_h - \\alpha)^2 \\sin^2\\theta + (c_v - \\alpha)^2 \\cos^2\\theta \\right] - \\left( \\Delta p \\left[ (c_h - \\alpha) \\sin^2\\theta + (c_v - \\alpha) \\cos^2\\theta \\right] \\right)^2\n$$\nLet $A = c_h - \\alpha$ and $B = c_v - \\alpha$. Let $S^2 = \\sin^2\\theta$ and $C^2 = \\cos^2\\theta$.\n$$\n\\frac{(\\Delta \\tau')^2}{(\\Delta p)^2} = (A^2 S^2 + B^2 C^2) - (A S^2 + B C^2)^2 = A^2 S^2 + B^2 C^2 - (A^2 S^4 + B^2 C^4 + 2AB S^2 C^2)\n$$\n$$\n= A^2 S^2(1 - S^2) + B^2 C^2(1 - C^2) - 2AB S^2 C^2 = A^2 S^2 C^2 + B^2 C^2 S^2 - 2AB S^2 C^2\n$$\n$$\n= (A^2 - 2AB + B^2) S^2 C^2 = (A-B)^2 S^2 C^2\n$$\nSubstituting back $A$, $B$, $S^2$, and $C^2$:\n$$\n(\\Delta \\tau')^2 = (\\Delta p)^2 ((c_h - \\alpha) - (c_v - \\alpha))^2 \\sin^2\\theta \\cos^2\\theta = (\\Delta p)^2 (c_h - c_v)^2 \\sin^2\\theta \\cos^2\\theta\n$$\nTaking the square root for the magnitude, which must be non-negative:\n$$\n\\Delta \\tau' = \\left| \\Delta p (c_h - c_v) \\sin\\theta \\cos\\theta \\right|\n$$\nUsing the identity $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$:\n$$\n\\Delta \\tau' = \\frac{1}{2} \\left| \\Delta p (c_h - c_v) \\sin(2\\theta) \\right|\n$$\nNow, we substitute the given numerical values: $\\Delta p = 12$ MPa, $c_h = 0.35$, $c_v = 0.15$, $\\alpha = 0.85$, and $\\theta = 58^\\circ$. Note that the results are independent of $\\phi$ due to the transverse isotropy of the stress state.\n\nFor $\\Delta \\sigma'_{n}$:\n$$\n\\Delta \\sigma'_{n} = 12 \\left[ (0.35 - 0.85) \\sin^2(58^\\circ) + (0.15 - 0.85) \\cos^2(58^\\circ) \\right]\n$$\n$$\n\\Delta \\sigma'_{n} = 12 \\left[ (-0.50) \\sin^2(58^\\circ) - 0.70 \\cos^2(58^\\circ) \\right]\n$$\n$$\n\\Delta \\sigma'_{n} \\approx 12 \\left[ (-0.50)(0.719186) - (0.70)(0.280814) \\right]\n$$\n$$\n\\Delta \\sigma'_{n} \\approx 12 \\left[ -0.359593 - 0.196570 \\right] = 12(-0.556163) \\approx -6.673956 \\text{ MPa}\n$$\nRounding to four significant figures, $\\Delta \\sigma'_{n} \\approx -6.674$ MPa. A negative value indicates a decrease in compressive normal stress (i.e., a tensile change).\n\nFor $\\Delta \\tau'$:\nGiven $\\Delta p > 0$ and $\\theta \\in (0, 90^\\circ)$, the terms inside the absolute value are positive, so we can drop the absolute value signs.\n$$\n\\Delta \\tau' = 12 \\times |0.35 - 0.15| \\times \\sin(58^\\circ) \\cos(58^\\circ)\n$$\n$$\n\\Delta \\tau' = 12 \\times 0.20 \\times \\sin(58^\\circ) \\cos(58^\\circ)\n$$\n$$\n\\Delta \\tau' \\approx 2.4 \\times (0.848048) \\times (0.529919) \\approx 1.07853 \\text{ MPa}\n$$\nRounding to four significant figures, $\\Delta \\tau' \\approx 1.079$ MPa.\n\nThe final answer is the two-entry row matrix $\\begin{pmatrix} \\Delta \\sigma'_{n}  \\Delta \\tau' \\end{pmatrix}$.\n$$\n\\begin{pmatrix} -6.674  1.079 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -6.674  1.079 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond the transmission of fluid pressure, the long-term integrity of a caprock also depends on its ability to prevent the physical migration of the CO₂ phase. The slow intrusion of CO₂ into the caprock, driven by complex capillary phenomena, can be effectively modeled as a diffusion process, especially at early times and low saturations. In this computational exercise , you will solve the linearized saturation transport equation to predict the evolution of the CO₂ saturation profile, providing insight into the caprock's sealing capacity.",
            "id": "3505839",
            "problem": "Consider a one-dimensional vertical coordinate $z \\ge 0$ measured upward into a uniform, low-permeability caprock above a saline reservoir. We study the early-time, diffusion-dominated intrusion of a small free-phase carbon dioxide (CO₂) saturation $S(z,t)$ into the caprock. Assume the following.\n\n- The porous medium has constant properties (porosity $\\phi$, intrinsic permeability $K$) and remains fully water-wet with a small, nonwetting CO₂ saturation $S$.\n- Flow is isothermal, compressibility is negligible, and gravity and advective terms can be neglected over the time and length scales of interest.\n- The dynamics are governed by mass conservation and a Richards-type equation with capillary pressure $p_c(S)$.\n- Linearize the governing equation about a small saturation state $S \\approx 0$ so that the evolution of $S(z,t)$ is well approximated by a constant-coefficient diffusion equation with an effective capillary diffusivity $D$ (units $\\mathrm{m^2/s}$). Treat $D$ as a given parameter obtained from the linearization.\n\nYou are to implement a program that, for specified boundary and initial conditions, computes $S(z,t)$ for the following two boundary condition sets.\n\n- Boundary condition set A (semi-infinite domain): The caprock is modeled as a semi-infinite domain $z \\in [0,\\infty)$. At the reservoir-caprock interface $z=0$, the CO₂ saturation is held at a small constant value $S(0,t)=S_0$ for all $t0$. Far from the interface, $S(\\infty,t)=0$. The initial condition is $S(z,0)=0$ for all $z0$.\n- Boundary condition set B (finite domain with no-flux top): The caprock has finite thickness $H$ (units $\\mathrm{m}$) with $z \\in [0,H]$. At the reservoir-caprock interface $z=0$, $S(0,t)=S_0$ for all $t0$. At the top of the caprock, a no-flux condition holds, $\\partial S/\\partial z \\,(H,t)=0$. The initial condition is $S(z,0)=0$ for all $z \\in [0,H]$.\n\nAll quantities must be treated in consistent International System of Units (SI). Specifically, $z$ and $H$ are in $\\mathrm{m}$, $t$ is in $\\mathrm{s}$, and $D$ is in $\\mathrm{m^2/s}$. The saturation $S$ and the boundary value $S_0$ are dimensionless.\n\nYour program must compute $S(z,t)$ for the following five test cases, each provided as a tuple of parameters. For boundary condition set A, the tuple is $(\\text{bc}, D, S_0, z, t)$, where $\\text{bc}=0$ indicates set A. For boundary condition set B, the tuple is $(\\text{bc}, D, S_0, H, z, t)$, where $\\text{bc}=1$ indicates set B.\n\n- Test case $1$ (set A): $(0,\\, 1.0\\times 10^{-9},\\, 0.05,\\, 0.1,\\, 3.1536\\times 10^{7})$.\n- Test case $2$ (set A): $(0,\\, 1.0\\times 10^{-9},\\, 0.05,\\, 0.0,\\, 1.0\\times 10^{6})$.\n- Test case $3$ (set A): $(0,\\, 5.0\\times 10^{-10},\\, 0.03,\\, 5.0,\\, 1.0\\times 10^{7})$.\n- Test case $4$ (set B): $(1,\\, 2.0\\times 10^{-9},\\, 0.02,\\, 10.0,\\, 10.0,\\, 1.0\\times 10^{9})$.\n- Test case $5$ (set B): $(1,\\, 2.0\\times 10^{-9},\\, 0.02,\\, 10.0,\\, 5.0,\\, 1.0\\times 10^{7})$.\n\nAlgorithmic requirements and numerical accuracy:\n\n- For boundary condition set A, use the exact closed-form solution implied by the linearized diffusion equation and the stated boundary and initial conditions.\n- For boundary condition set B, use the exact eigenfunction representation implied by the linearized diffusion equation and the stated boundary and initial conditions; evaluate the series numerically by summing terms until the absolute change in partial sums is below an absolute tolerance of $10^{-12}$ or until a hard cap of $100000$ terms is reached, whichever occurs first. The series must be implemented in a manner that remains numerically stable for all provided test cases.\n- If due to floating-point roundoff the computed $S$ is slightly negative with magnitude less than $10^{-12}$, set it to $0$.\n\nFinal answer specification:\n\n- For each test case, compute $S(z,t)$ and round the result to exactly six digits after the decimal point (for example, $0.034567$).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases $1$ through $5$; for example, $[s_1,s_2,s_3,s_4,s_5]$, where each $s_i$ is the rounded saturation value for test case $i$ (dimensionless).",
            "solution": "The user has provided a well-posed problem from the field of computational geomechanics, specifically concerning caprock integrity for CO₂ sequestration. The problem is scientifically grounded, objective, and contains all necessary information for a unique solution.\n\nThe problem requires the calculation of CO₂ saturation, $S(z,t)$, governed by a one-dimensional linear diffusion equation, $\\partial S / \\partial t = D \\, \\partial^2 S / \\partial z^2$, under two different sets of boundary conditions.\n\n### Boundary Condition Set A: Semi-infinite Domain\nThis set models the caprock as a semi-infinite medium $z \\in [0, \\infty)$.\nThe governing partial differential equation (PDE) is:\n$$ \\frac{\\partial S}{\\partial t} = D \\frac{\\partial^2 S}{\\partial z^2} \\quad \\text{for } z > 0, t > 0 $$\nwith initial and boundary conditions:\n- Initial condition: $S(z, 0) = 0$ for $z > 0$\n- Boundary condition at the interface: $S(0, t) = S_0$ for $t > 0$\n- Boundary condition at infinity: $S(z, t) \\to 0$ as $z \\to \\infty$\n\nThis is a classic diffusion problem. The solution is found by applying a similarity transformation or using Laplace transforms. The standard closed-form solution is expressed in terms of the complementary error function, $\\mathrm{erfc}(x)$:\n$$ S(z, t) = S_0 \\, \\mathrm{erfc}\\left( \\frac{z}{2\\sqrt{Dt}} \\right) $$\nwhere $\\mathrm{erfc}(x) = 1 - \\mathrm{erf}(x)$, and $\\mathrm{erf}(x)$ is the error function.\nThis formula applies for $z > 0$ and $t > 0$. At the boundary $z=0$, the solution correctly yields $S(0,t) = S_0 \\times \\mathrm{erfc}(0) = S_0 \\times 1 = S_0$, consistent with the boundary condition. The function `scipy.special.erfc` will be used for the numerical computation.\n\n### Boundary Condition Set B: Finite Domain\nThis set models the caprock as a finite-thickness layer $z \\in [0, H]$.\nThe PDE remains the same:\n$$ \\frac{\\partial S}{\\partial t} = D \\frac{\\partial^2 S}{\\partial z^2} \\quad \\text{for } 0  z  H, t > 0 $$\nwith initial and boundary conditions:\n- Initial condition: $S(z, 0) = 0$ for $0 \\leq z \\leq H$\n- Boundary condition at the interface: $S(0, t) = S_0$ for $t > 0$\n- Boundary condition at the top: No-flux, $\\frac{\\partial S}{\\partial z}(H, t) = 0$ for $t > 0$\n\nThis is an inhomogeneous boundary value problem. We solve it by decomposing the solution $S(z,t)$ into a steady-state part $S_{ss}(z)$ and a transient part $S_{tr}(z,t)$, such that $S(z,t) = S_{ss}(z) + S_{tr}(z,t)$.\n\n1.  **Steady-State Solution:** $S_{ss}(z)$ satisfies $\\frac{d^2 S_{ss}}{dz^2} = 0$ with the boundary conditions $S_{ss}(0)=S_0$ and $\\frac{dS_{ss}}{dz}(H) = 0$. The solution is readily found to be constant:\n    $$ S_{ss}(z) = S_0 $$\n\n2.  **Transient Solution:** $S_{tr}(z,t)$ must satisfy a homogeneous problem. The governing equation is the same PDE, $\\frac{\\partial S_{tr}}{\\partial t} = D \\frac{\\partial^2 S_{tr}}{\\partial z^2}$. The boundary conditions for the transient part become homogeneous: $S_{tr}(0,t) = S(0,t) - S_{ss}(0) = S_0 - S_0 = 0$ and $\\frac{\\partial S_{tr}}{\\partial z}(H,t) = \\frac{\\partial S}{\\partial z}(H,t) - \\frac{dS_{ss}}{dz}(H) = 0 - 0 = 0$. The initial condition is $S_{tr}(z,0) = S(z,0) - S_{ss}(z) = 0 - S_0 = -S_0$.\n\nThis homogeneous transient problem is solved using the method of separation of variables. Assuming a solution of the form $S_{tr}(z,t) = Z(z)T(t)$, we find the eigenfunctions $Z_n(z)$ and corresponding eigenvalues $\\lambda_n$ that satisfy the boundary conditions:\n$$ Z_n(z) = \\sin(\\lambda_n z), \\quad \\lambda_n = \\frac{(2n+1)\\pi}{2H} \\quad \\text{for } n = 0, 1, 2, \\dots $$\nThe solution for $S_{tr}(z,t)$ is an infinite series (eigenfunction expansion):\n$$ S_{tr}(z,t) = \\sum_{n=0}^{\\infty} c_n e^{-\\lambda_n^2 D t} \\sin(\\lambda_n z) $$\nThe coefficients $c_n$ are determined by the initial condition $S_{tr}(z,0) = -S_0$ using the orthogonality of the eigenfunctions:\n$$ c_n = \\frac{\\int_0^H (-S_0) \\sin(\\lambda_n z) \\,dz}{\\int_0^H \\sin^2(\\lambda_n z) \\,dz} = -\\frac{4S_0}{(2n+1)\\pi} $$\nCombining the steady-state and transient parts gives the final solution for Set B:\n$$ S(z,t) = S_0 - \\frac{4S_0}{\\pi} \\sum_{n=0}^{\\infty} \\frac{1}{2n+1} \\exp\\left( -D \\left(\\frac{(2n+1)\\pi}{2H}\\right)^2 t \\right) \\sin\\left(\\frac{(2n+1)\\pi z}{2H}\\right) $$\nThis series will be evaluated numerically according to the specified tolerance and term limit.\n\n### Implementation Details\nThe program will implement these two solutions. For Set A, the calculation is a direct evaluation of the `erfc` function. For Set B, a loop will compute the partial sum of the series. The loop terminates when the absolute value of the term being added (scaled by the series prefactor $4S_0/\\pi$) drops below a tolerance of $10^{-12}$, or after $100,000$ terms. A special case for $z=H$ is handled where $\\sin\\left(\\frac{(2n+1)\\pi H}{2H}\\right) = (-1)^n$ to enhance numerical robustness. Finally, any small negative results due to floating-point inaccuracies are floored at zero, and all final values are rounded to six decimal places.",
            "answer": "$$\n[0.034867, 0.050000, 0.000000, 0.020000, 0.007629]\n$$"
        },
        {
            "introduction": "Injecting CO₂ at temperatures below that of the reservoir introduces a critical thermo-mechanical (TM) coupling, where thermal contraction induces tensile stresses that can potentially compromise the caprock. This advanced practice  simulates a realistic monitoring and analysis workflow, where you will invert field data to estimate a key material property—the coefficient of thermal expansion. You will then use this inverted parameter to perform a forward analysis of stress evolution and assess the risk of thermal fracturing.",
            "id": "3505757",
            "problem": "You are tasked with formulating and solving a physics-based inverse problem relevant to caprock integrity during early Carbon Dioxide (CO$_2$) injection. Early injection of cold CO$_2$ cools the reservoir-caprock interface, producing temperature transients detectable by Distributed Temperature Sensing (DTS). Concurrently, the thermoelastic response of the caprock creates stress changes that can be linearly coupled to wellhead pressure transients in a first-order approximation of the reservoir–wellbore–caprock system.\n\nStarting from first principles, use the following bases without shortcut formulas:\n- The one-dimensional heat conduction equation and its role in governing transient temperature in a semi-infinite solid: $\\partial T / \\partial t = \\kappa \\, \\partial^2 T / \\partial x^2$.\n- Linear thermoelasticity for small deformations in isotropic solids, including thermal strain defined by the coefficient of linear thermal expansion $\\alpha$ and elastic moduli $(E,\\nu)$, under a plane-strain constraint at the interface.\n- The effective stress principle for fluid-saturated porous media (Terzaghi–Biot), with Biot coefficient $b$ and pore pressure $p$, where the effective normal stress is $\\sigma'_n = \\sigma_n - b\\,p$.\n\nAssume a linear compliance $S_{\\mathrm{th}}$ (dimensionless) connecting the caprock thermoelastic normal stress change to the wellhead pressure change for small perturbations: changes in caprock thermoelastic stress are linearly mapped to wellhead pressure transients through $S_{\\mathrm{th}}$. Use this relationship consistently across all time steps.\n\nYour program must implement an inversion for the caprock thermal expansion coefficient $\\alpha$ using the provided DTS-derived interface temperature change time series $\\Delta T_s(t_i)$ and wellhead pressure change time series $\\Delta P_w(t_i)$, together with known elastic and coupling parameters $(E,\\nu,S_{\\mathrm{th}})$. Then, use the inverted $\\alpha$ to compute the thermoelastic stress evolution $\\Delta \\sigma_{\\mathrm{th}}(t_i)$ at the interface and assess the caprock’s tensile risk using the effective stress criterion with the given Biot coefficient $b$ and tensile strength threshold $T_0$.\n\nDefinitions and units:\n- Distributed Temperature Sensing (DTS): fiber-optic distributed measurements of temperature along the well trajectory.\n- $\\alpha$: coefficient of linear thermal expansion in $\\mathrm{K}^{-1}$.\n- $E$: Young’s modulus in $\\mathrm{Pa}$.\n- $\\nu$: Poisson’s ratio (dimensionless).\n- $S_{\\mathrm{th}}$: linear compliance mapping stress to pressure (dimensionless).\n- $b$: Biot coefficient (dimensionless).\n- $\\Delta T_s(t_i)$: interface temperature change relative to pre-injection, in $\\mathrm{K}$.\n- $\\Delta P_w(t_i)$: wellhead pressure change relative to pre-injection, in $\\mathrm{MPa}$.\n- $\\Delta \\sigma_{\\mathrm{th}}(t_i)$: thermoelastic normal stress change in the caprock, expressed in $\\mathrm{MPa}$ for output.\n- $\\sigma'_n(t_i)$: effective normal stress change at the interface, expressed in $\\mathrm{MPa}$ for output.\n- $T_0$: tensile strength threshold, in $\\mathrm{MPa}$.\n\nInverse problem and outputs:\n- Estimate $\\alpha$ by minimizing the sum of squared residuals between measured $\\Delta P_w(t_i)$ and predicted $\\Delta P_w(t_i)$ from a physically consistent thermoelastic model under plane strain, using the linear mapping with $S_{\\mathrm{th}}$.\n- Using the inverted $\\alpha$, compute $\\Delta \\sigma_{\\mathrm{th}}(t_i)$ in $\\mathrm{MPa}$ for each time step.\n- Compute $\\sigma'_n(t_i)$ in $\\mathrm{MPa}$ using the given $b$ and measured $\\Delta P_w(t_i)$.\n- Report, for each test case: the inverted $\\alpha$ in $\\mathrm{K}^{-1}$, the final-time thermoelastic stress $\\Delta \\sigma_{\\mathrm{th}}(t_{\\mathrm{final}})$ in $\\mathrm{MPa}$, the most tensile (minimum) effective normal stress $\\min_i \\sigma'_n(t_i)$ in $\\mathrm{MPa}$, and a boolean risk flag indicating whether $\\sigma'_n(t_i)  -T_0$ at any time (true means tensile risk).\n\nAngle units do not apply. Express all outputs in the specified physical units. Do not include units in the printed output; ensure your program’s numerical outputs adhere to the units specified above.\n\nTest suite:\nFor each case, you are given time stamps $t_i$ (in $\\mathrm{s}$), DTS-derived interface temperature changes $\\Delta T_s(t_i)$ (in $\\mathrm{K}$), and wellhead pressure changes $\\Delta P_w(t_i)$ (in $\\mathrm{MPa}$), together with $(E,\\nu,S_{\\mathrm{th}},b,T_0)$.\n\n- Case 1 (general early-cooling response):\n  - $t_i = [\\,0,30,60,120,240,480\\,]$ $\\mathrm{s}$.\n  - $\\Delta T_s(t_i) = [\\,0.0,-2.211992,-3.934693,-6.321206,-8.646647,-9.816844\\,]$ $\\mathrm{K}$.\n  - $\\Delta P_w(t_i) = [\\,0.0,0.221199,0.393469,0.632121,0.864665,0.981684\\,]$ $\\mathrm{MPa}$.\n  - $E = 2.5\\times 10^{10}$ $\\mathrm{Pa}$, $\\nu = 0.25$, $S_{\\mathrm{th}} = -0.5$, $b=0.8$, $T_0 = 2.5$ $\\mathrm{MPa}$.\n\n- Case 2 (boundary-like small cooling):\n  - $t_i = [\\,0,30,60,120,240,480\\,]$ $\\mathrm{s}$.\n  - $\\Delta T_s(t_i) = [\\,0.0,-0.196735,-0.316060,-0.432332,-0.490842,-0.499832\\,]$ $\\mathrm{K}$.\n  - $\\Delta P_w(t_i) = [\\,0.0,0.026999,0.043331,0.059620,0.067643,0.068539\\,]$ $\\mathrm{MPa}$.\n  - $E = 3.0\\times 10^{10}$ $\\mathrm{Pa}$, $\\nu = 0.30$, $S_{\\mathrm{th}} = -0.4$, $b=0.85$, $T_0 = 5.0$ $\\mathrm{MPa}$.\n\n- Case 3 (stiff caprock, stronger coupling):\n  - $t_i = [\\,0,30,60,120,240,480\\,]$ $\\mathrm{s}$.\n  - $\\Delta T_s(t_i) = [\\,0.0,-2.302774,-4.252030,-7.298743,-11.046043,-13.957748\\,]$ $\\mathrm{K}$.\n  - $\\Delta P_w(t_i) = [\\,0.0,0.575694,1.063007,1.824686,2.761511,3.489437\\,]$ $\\mathrm{MPa}$.\n  - $E = 5.0\\times 10^{10}$ $\\mathrm{Pa}$, $\\nu = 0.20$, $S_{\\mathrm{th}} = -1.0$, $b=0.9$, $T_0 = 3.5$ $\\mathrm{MPa}$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets. Each test-case result must itself be a list in the order $[\\,\\alpha,\\,\\Delta \\sigma_{\\mathrm{th}}(t_{\\mathrm{final}}),\\,\\min_i \\sigma'_n(t_i),\\,\\text{risk}\\,]$. For example, your program must print a single line like:\n$[\\,[\\alpha_1,\\Delta \\sigma_{\\mathrm{th},1},\\min \\sigma'_{n,1},\\text{True or False}],[\\alpha_2,\\Delta \\sigma_{\\mathrm{th},2},\\min \\sigma'_{n,2},\\text{True or False}],[\\alpha_3,\\Delta \\sigma_{\\mathrm{th},3},\\min \\sigma'_{n,3},\\text{True or False}]\\,]$.",
            "solution": "The user-provided problem is validated as being scientifically grounded, self-contained, and well-posed, contingent upon a physically consistent interpretation of the provided terms within the established principles of geomechanics. The problem requires the formulation and solution of an inverse problem to determine a material property ($\\alpha$) from transient field data, followed by a forward calculation to assess mechanical risk.\n\nThe solution is structured as follows:\n1.  Derivation of the thermoelastic forward model.\n2.  Formulation and solution of the inverse problem for the thermal expansion coefficient, $\\alpha$.\n3.  Calculation of the thermoelastic and effective stress evolution.\n4.  Assessment of tensile failure risk.\n\nA geomechanics sign convention is adopted where compressive stress is positive and tensile stress is negative. All stress and pressure quantities are expressed in megapascals ($\\mathrm{MPa}$), except where specified otherwise.\n\n**1. Thermoelastic Forward Model**\n\nThe problem states that cooling at the reservoir-caprock interface induces a thermoelastic response. We model the caprock as a semi-infinite solid, with the interface being a plane of large lateral extent. The cooling is uniform across this plane. The \"plane-strain constraint at the interface\" implies that the caprock is prevented from deforming in the plane of the interface (i.e., laterally). Let the direction normal to the interface be $z$ and the lateral directions be $x$ and $y$. The plane-strain condition is $\\varepsilon_x = \\varepsilon_y = 0$.\n\nFor an isotropic, linear elastic material, a change in temperature, $\\Delta T$, induces a thermal strain $\\varepsilon_{\\mathrm{th}} = \\alpha \\Delta T$. The constitutive relationship connecting stress $\\sigma$ and strain $\\varepsilon$ is given by Hooke's Law, modified for thermal effects. Under plane strain and assuming zero change in vertical stress, the induced change in horizontal stress, $\\Delta \\sigma_h = \\Delta \\sigma_x = \\Delta \\sigma_y$, is a direct consequence of the thermal contraction being constrained. This stress change is given by:\n$$\n\\Delta \\sigma_h = \\frac{E \\alpha \\Delta T}{1-\\nu}\n$$\nHere, $E$ is Young's modulus and $\\nu$ is Poisson's ratio. This is the relevant stress component for opening vertical tensile fractures. We identify this quantity as the \"thermoelastic normal stress change\" referenced in the problem, $\\Delta \\sigma_{\\mathrm{th}}$. With our sign convention (compression positive), cooling ($\\Delta T  0$) induces tensile stress ($\\Delta \\sigma_{\\mathrm{th}}  0$), which is consistent with this formula.\n\nThe problem states a linear compliance, $S_{\\mathrm{th}}$, maps this stress change to the wellhead pressure change, $\\Delta P_w$. We formalize this as:\n$$\n\\Delta P_w(t_i) = S_{\\mathrm{th}} \\Delta \\sigma_{\\mathrm{th}}(t_i)\n$$\nSubstituting the expression for $\\Delta \\sigma_{\\mathrm{th}}$ and using the measured interface temperature change $\\Delta T_s(t_i)$, we obtain the forward model predicting the wellhead pressure change:\n$$\n\\Delta P_{w, \\text{predicted}}(t_i) = S_{\\mathrm{th}} \\left( \\frac{E \\alpha \\Delta T_s(t_i)}{1-\\nu} \\right)\n$$\n\n**2. Inverse Problem for $\\alpha$**\n\nThe inverse problem is to find the value of $\\alpha$ that best explains the observed data. We achieve this by minimizing the sum of squared residuals between the measured pressure changes, $\\Delta P_{w, \\text{measured}}(t_i)$, and the pressure changes predicted by our model. The objective function to minimize is:\n$$\nJ(\\alpha) = \\sum_{i=1}^{N} \\left( \\Delta P_{w, \\text{measured}}(t_i) - \\Delta P_{w, \\text{predicted}}(t_i) \\right)^2\n$$\nSubstituting the forward model, we can write:\n$$\nJ(\\alpha) = \\sum_{i=1}^{N} \\left( \\Delta P_{w, \\text{measured}}(t_i) - \\alpha \\left[ \\frac{S_{\\mathrm{th}} E}{1-\\nu} \\right] \\Delta T_s(t_i) \\right)^2\n$$\nThis is a linear least-squares problem of the form $y_i = m x_i$, where $y_i = \\Delta P_{w, \\text{measured}}(t_i)$, $x_i = \\Delta T_s(t_i)$, and the slope $m$ is $\\alpha \\left( \\frac{S_{\\mathrm{th}} E}{1-\\nu} \\right)$. The value of $m$ that minimizes the sum of squares is given by:\n$$\nm = \\frac{\\sum_{i=1}^{N} x_i y_i}{\\sum_{i=1}^{N} x_i^2} = \\frac{\\sum_{i=1}^{N} \\Delta T_s(t_i) \\Delta P_{w, \\text{measured}}(t_i)}{\\sum_{i=1}^{N} (\\Delta T_s(t_i))^2}\n$$\nFrom this, we can solve for $\\alpha$:\n$$\n\\alpha = m \\left( \\frac{S_{\\mathrm{th}} E}{1-\\nu} \\right)^{-1} = \\frac{\\sum_{i=1}^{N} \\Delta T_s(t_i) \\Delta P_{w, \\text{measured}}(t_i)}{\\sum_{i=1}^{N} (\\Delta T_s(t_i))^2} \\frac{1-\\nu}{S_{\\mathrm{th}} E}\n$$\nTo ensure consistent units, $E$ (in $\\mathrm{Pa}$) is converted to $\\mathrm{MPa}$ by multiplying by $10^{-6}$, as $\\Delta P_w$ is given in $\\mathrm{MPa}$.\n\n**3. Stress Evolution Calculation**\n\nWith the inverted value of $\\alpha$, we can now compute the time series of the thermoelastic stress change using the measured temperature data:\n$$\n\\Delta \\sigma_{\\mathrm{th}}(t_i) = \\frac{(E \\cdot 10^{-6}) \\alpha \\Delta T_s(t_i)}{1-\\nu} \\quad [\\text{in MPa}]\n$$\nThe problem requires reporting the final-time value, $\\Delta \\sigma_{\\mathrm{th}}(t_{\\mathrm{final}})$.\n\nNext, we calculate the change in effective normal stress, $\\sigma'_n(t_i)$, using the Terzaghi–Biot principle: $\\sigma'_n = \\sigma_n - b p$. In terms of changes, this is $\\Delta\\sigma'_n = \\Delta\\sigma_n - b \\Delta p$. The relevant total stress change $\\Delta \\sigma_n$ is the thermoelastic stress $\\Delta \\sigma_{\\mathrm{th}}(t_i)$ we just calculated. The pore pressure change at the interface, $\\Delta p$, is assumed to be represented by the measured wellhead pressure change $\\Delta P_{w, \\text{measured}}(t_i)$. Thus:\n$$\n\\sigma'_n(t_i) = \\Delta \\sigma_{\\mathrm{th}}(t_i) - b \\cdot \\Delta P_{w, \\text{measured}}(t_i)\n$$\nThe problem asks for the most tensile (minimum) value in this time series, $\\min_i \\sigma'_n(t_i)$.\n\n**4. Tensile Risk Assessment**\n\nTensile failure of the caprock is assumed to occur if the effective normal stress becomes more tensile than the rock's tensile strength, $T_0$. Since tension is negative in our convention, the failure criterion is:\n$$\n\\sigma'_n(t_i)  -T_0\n$$\nwhere $T_0$ is given as a positive value in $\\mathrm{MPa}$. A boolean risk flag is set to `True` if this condition is met for any time step $t_i$, and `False` otherwise. This completes the set of required calculations for each test case.",
            "answer": "$$\n[[6e-06,-1.963369,-2.750716,True],[8.000027e-06,-0.137146,-0.253719,False],[3.3596e-06,-3.489437,-6.62993,True]]\n$$"
        }
    ]
}