{
    "hands_on_practices": [
        {
            "introduction": "对挡土结构上的土压力进行量化是岩土工程中的一个基本问题。本练习将通过一个理想化的场景，指导您从最基本的Mohr-Coulomb破坏准则出发，推导出适用于无粘性土的Rankine主动土压力理论。通过完成这项实践，您不仅将计算出作用在挡土墙上的总推力及其作用点，还将通过与静止土压力的对比，深刻理解墙体位移对土压力大小和分布的关键影响。",
            "id": "3500145",
            "problem": "一个高度为 $H$ 的竖直、光滑、刚性挡土墙，支挡着水平的无粘性粒状回填土。回填土的特性由摩尔-库仑强度模型描述，其粘聚力为零（$c=0$），内摩擦角为 $\\phi$。土体的总重度 $\\gamma$ 为常数且干燥，无附加荷载，地表水平；适用平面应变条件。假设墙体产生足够的位移以使回填土达到主动极限状态。将应力视为有效应力，并忽略任何水力效应。\n\n从摩尔-库仑破坏准则和主应力表示出发（不直接使用预先推导的土压力系数），(i) 根据朗肯理论推导此种构型下的主动土压力系数，并求出随深度变化的侧向应力。然后，(ii) 计算作用在单位长度墙体上的主动合力及其作用点（从墙底算起的竖直高度）。接着，(iii) 采用 Jaky 的静止土压力系数经验关系式，即静止土压力系数 $K_{0}$ 作为 $\\phi$ 的函数，并计算相同构型下作用在单位长度墙体上的相应静止合力。最后，(iv) 通过静止合力与主动合力的比值 $R$ 来量化比较。\n\n使用以下数据：$\\phi = 30^{\\circ}$，$c=0$，$\\gamma = 18$ kN/m$^3$，$H=6$ m。将合力大小以千牛顿/米墙长（kN/m）表示，作用点高度以米（m）表示。将你的答案四舍五入到四位有效数字，并按以下顺序报告四个量：主动合力大小、主动合力作用点（距墙底的高度）、静止合力大小以及定义为 $R = P_{0}/P_{a}$ 的比值 $R$。角度必须以度为单位处理。",
            "solution": "土壤是无粘性的，即 $c=0$，内摩擦角为 $\\phi$，服从摩尔-库仑破坏准则\n$$\n\\tau = \\sigma' \\tan \\phi,\n$$\n其中 $\\sigma'$ 是破坏面上的法向有效应力，$\\tau$ 是剪应力。在平面应变条件下，对于支挡水平回填土的竖直光滑墙体，当侧向应力减小到足以使墙后土体达到初始破坏状态时，即出现主动极限状态。此时，竖向应力为最大主应力 $\\sigma_{1}'$，水平应力为最小主应力 $\\sigma_{3}'$。\n\n在 $(\\sigma',\\tau)$ 平面内，摩尔圆的圆心为 $C=(\\sigma_{1}'+\\sigma_{3}')/2$，半径为 $R=(\\sigma_{1}'-\\sigma_{3}')/2$。当 $c=0$ 时，在破坏状态下，该圆与过原点的直线 $\\tau=\\sigma' \\tan \\phi$ 相切。从几何关系可知，圆心到原点的连线与 $\\sigma'$ 轴的夹角为 $\\phi$，即 $\\sin\\phi = R/C$。\n代入 $C$ 和 $R$ 的表达式，我们得到\n$$\n\\sin \\phi = \\frac{(\\sigma_{1}' - \\sigma_{3}')/2}{(\\sigma_{1}' + \\sigma_{3}')/2} = \\frac{\\sigma_{1}' - \\sigma_{3}'}{\\sigma_{1}' + \\sigma_{3}'},\n$$\n整理后得到\n$$\n(\\sigma_{1}' + \\sigma_{3}') \\sin \\phi = \\sigma_{1}' - \\sigma_{3}',\n$$\n$$\n\\sigma_{1}'(1 - \\sin \\phi) = \\sigma_{3}'(1 + \\sin \\phi).\n$$\n因此，破坏时的主应力比为\n$$\n\\frac{\\sigma_{3}'}{\\sigma_{1}'} = \\frac{1 - \\sin \\phi}{1 + \\sin \\phi},\n$$\n这便是朗肯主动土压力系数\n$$\nK_{a} = \\frac{\\sigma_{3}'}{\\sigma_{1}'} = \\frac{1 - \\sin \\phi}{1 + \\sin \\phi} = \\tan^{2}\\!\\left(45^{\\circ} - \\frac{\\phi}{2}\\right).\n$$\n\n对于被支挡的土体，最大有效主应力是自重引起的竖向应力：\n$$\n\\sigma_{1}'(z) = \\gamma\\, z,\n$$\n其中 $z$ 是地表以下的深度。因此，主动水平应力分布为\n$$\n\\sigma_{h,a}(z) = K_{a}\\,\\gamma\\, z.\n$$\n单位墙长上的主动合力是侧向应力在墙高上的积分：\n$$\nP_{a} = \\int_{0}^{H} \\sigma_{h,a}(z)\\,\\mathrm{d}z = \\int_{0}^{H} K_{a}\\,\\gamma\\, z\\, \\mathrm{d}z = \\frac{1}{2} K_{a}\\, \\gamma\\, H^{2}.\n$$\n由于 $\\sigma_{h,a}(z)$ 从 $z=0$ 处的 $0$ 线性变化到 $z=H$ 处的 $K_{a}\\gamma H$，压力图是三角形的，其合力作用在距离墙底 $H/3$ 的高度处（三角形的形心）。\n\n接下来，对于静止状态，采用 Jaky 的静止土压力系数经验关系式，\n$$\nK_{0} = 1 - \\sin \\phi.\n$$\n在静止状态下（无侧向应变），侧向应力为\n$$\n\\sigma_{h,0}(z) = K_{0}\\,\\gamma\\, z,\n$$\n单位长度上的合力为\n$$\nP_{0} = \\int_{0}^{H} \\sigma_{h,0}(z)\\,\\mathrm{d}z = \\frac{1}{2} K_{0}\\,\\gamma\\, H^{2}.\n$$\n比较比值为\n$$\nR = \\frac{P_{0}}{P_{a}} = \\frac{K_{0}}{K_{a}}.\n$$\n\n现在对 $\\phi = 30^{\\circ}$，$c=0$，$\\gamma = 18$ kN/m$^3$，$H=6$ m 进行数值计算，角度以度为单位。首先，计算\n$$\n\\sin \\phi = \\sin 30^{\\circ} = \\frac{1}{2}.\n$$\n因此，\n$$\nK_{a} = \\frac{1 - \\sin \\phi}{1 + \\sin \\phi} = \\frac{1 - \\frac{1}{2}}{1 + \\frac{1}{2}} = \\frac{\\frac{1}{2}}{\\frac{3}{2}} = \\frac{1}{3},\n$$\n以及\n$$\nK_{0} = 1 - \\sin \\phi = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\n计算合力：\n$$\nP_{a} = \\frac{1}{2} K_{a} \\gamma H^{2} = \\frac{1}{2} \\left(\\frac{1}{3}\\right) (18)(6^{2}) = \\frac{1}{2}\\left(\\frac{1}{3}\\right)(18)(36) = 108,\n$$\n单位为千牛顿/米墙长（kN/m），以及\n$$\nP_{0} = \\frac{1}{2} K_{0} \\gamma H^{2} = \\frac{1}{2} \\left(\\frac{1}{2}\\right) (18)(36) = \\frac{1}{2}(324) = 162,\n$$\n单位为千牛顿/米墙长（kN/m）。主动合力作用在\n$$\ny_{a} = \\frac{H}{3} = \\frac{6}{3} = 2\n$$\n米高的墙底上方。比值为\n$$\nR = \\frac{P_{0}}{P_{a}} = \\frac{162}{108} = \\frac{3}{2} = 1.5.\n$$\n\n将每个量四舍五入到四位有效数字，并将大小以千牛顿/米表示，高度以米表示，得到：\n$$\nP_{a} = 108.0,\\quad y_{a} = 2.000,\\quad P_{0} = 162.0,\\quad R = 1.500.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}108.0  2.000  162.0  1.500\\end{pmatrix}}$$"
        },
        {
            "introduction": "与粗粒土不同，粘土等细粒土的工程行为与时间密切相关，这主要是由于孔隙水压力的消散过程。因此，工程师必须分别评估短期（不排水）和长期（排水）条件下的结构稳定性。本练习模拟了一个典型的基坑支护场景，要求您在“静止”土压力条件下，分别采用总应力法和有效应力法计算短期和长期两种情况下的侧向荷载，从而掌握在饱和软粘土中进行两种关键分析方法的精髓。",
            "id": "3500144",
            "problem": "在一个均质、软的、正常固结的黏土沉积层中，建造了一个垂直支撑的基坑。基坑开挖至原始地表以下 $H=12\\,\\mathrm{m}$ 的深度。支撑有效地防止了侧向墙体位移，因此邻近墙体的被支护土体的侧向应变可以视为零（静止状态）。地下水位与地表齐平。黏土的饱和总重度为 $\\gamma_{\\mathrm{sat}}=18\\,\\mathrm{kN/m^3}$，水的重度为 $\\gamma_{w}=9.81\\,\\mathrm{kN/m^3}$。不排水抗剪强度在空间上是均匀的，为 $s_{u}=50\\,\\mathrm{kPa}$。在长期条件下，黏土表现为正常固结材料，其有效应力摩擦角为常数 $\\phi' = 25^\\circ$。\n\n使用适用于计算岩土力学的基本连续介质力学和土力学原理：\n- 在静止状态下，采用总应力法，推导短期不排水侧向土压力分布 $p_{u}(z)$ 作为深度 $z$ 的函数。\n- 结合静止状态有效应力条件和孔隙水压力的有效应力原理，推导长期侧向土压力分布 $p_{\\ell t}(z)$ 作为深度 $z$ 的函数。\n\n然后，对于每种情况，通过将各自的压力分布从地表的 $z=0$ 到 $z=H$ 进行积分，计算单位墙长上的侧向合力。最后，计算不排水合力与长期合力之比，\n$$\nR \\;=\\; \\frac{\\int_{0}^{H} p_{u}(z)\\,dz}{\\int_{0}^{H} p_{\\ell t}(z)\\,dz}.\n$$\n将您的最终答案四舍五入到四位有效数字。将最终答案表示为无量纲数（无单位）。",
            "solution": "此问题要求推导和计算支撑基坑在两种不同排水条件下的侧向土压力和合力：短期（不排水）和长期（排水）。假设开挖墙体是刚性的且不移动，这对应于静止土压力条件（$\\epsilon_h = 0$）。\n\n**第一部分：短期不排水侧向土压力**\n\n对于短期条件，土体行为是不排水的。分析采用总应力法进行。问题指定了静止状态，意味着侧向应变为零。对于不排水荷载下的饱和土，材料被视为不可压缩的。在线性弹性框架内，这对应于不排水泊松比 $\\nu_u = 0.5$。\n\n静止土压力系数 $K_0$ 关联了水平和竖向应力。对于零侧向应变（一维压缩）条件下的弹性材料，总应力静止系数由下式给出：\n$$\nK_{0,u} = \\frac{\\nu_u}{1 - \\nu_u}\n$$\n代入 $\\nu_u = 0.5$：\n$$\nK_{0,u} = \\frac{0.5}{1 - 0.5} = 1\n$$\n这意味着总水平应力等于总竖向应力。这是模拟软饱和黏土中短期静止压力的标准假设。\n\n地表以下深度 $z$ 处的总竖向应力 $\\sigma_v$ 是由上覆土体的重量引起的。给定饱和重度 $\\gamma_{\\mathrm{sat}}$，则有：\n$$\n\\sigma_v(z) = \\gamma_{\\mathrm{sat}} z\n$$\n因此，短期不排水侧向土压力 $p_u(z)$ 为：\n$$\np_u(z) = K_{0,u} \\sigma_v(z) = 1 \\cdot \\gamma_{\\mathrm{sat}} z = \\gamma_{\\mathrm{sat}} z\n$$\n单位墙长上的侧向合力 $P_u$ 是该压力分布在开挖深度 $H$ 上的积分。\n$$\nP_u = \\int_{0}^{H} p_u(z) \\, dz = \\int_{0}^{H} \\gamma_{\\mathrm{sat}} z \\, dz\n$$\n进行积分得到：\n$$\nP_u = \\gamma_{\\mathrm{sat}} \\left[ \\frac{z^2}{2} \\right]_{0}^{H} = \\frac{1}{2} \\gamma_{\\mathrm{sat}} H^2\n$$\n\n**第二部分：长期排水侧向土压力**\n\n对于长期条件，开挖过程中产生的任何超孔隙水压力已经消散，土体表现为排水行为。分析采用有效应力法进行。由于地下水位在地表，孔隙水压力 $u$ 是静水压力。\n$$\nu(z) = \\gamma_w z\n$$\n其中 $\\gamma_w$ 是水的重度。\n\n总竖向应力与之前相同：$\\sigma_v(z) = \\gamma_{\\mathrm{sat}} z$。竖向有效应力 $\\sigma'_v$ 由有效应力原理给出：\n$$\n\\sigma'_v(z) = \\sigma_v(z) - u(z) = \\gamma_{\\mathrm{sat}} z - \\gamma_w z = (\\gamma_{\\mathrm{sat}} - \\gamma_w) z\n$$\n问题指定了静止状态有效应力条件。水平有效应力 $\\sigma'_h$ 通过静止土压力的有效应力系数 $K_0$ 与竖向有效应力相关联：\n$$\n\\sigma'_h(z) = K_0 \\sigma'_v(z)\n$$\n对于正常固结黏土， $K_0$ 可以使用雅基（Jaky）经验公式估算：\n$$\nK_0 = 1 - \\sin(\\phi')\n$$\n其中 $\\phi'$ 是有效应力摩擦角。\n\n墙上的长期总侧向压力 $p_{\\ell t}(z)$ 是水平有效应力和孔隙水压力之和：\n$$\np_{\\ell t}(z) = \\sigma'_h(z) + u(z) = K_0 \\sigma'_v(z) + u(z)\n$$\n代入 $K_0$、$\\sigma'_v(z)$ 和 $u(z)$ 的表达式：\n$$\np_{\\ell t}(z) = (1 - \\sin(\\phi'))(\\gamma_{\\mathrm{sat}} - \\gamma_w)z + \\gamma_w z\n$$\n这可以写成：\n$$\np_{\\ell t}(z) = \\left[ (1 - \\sin(\\phi'))(\\gamma_{\\mathrm{sat}} - \\gamma_w) + \\gamma_w \\right] z\n$$\n单位墙长上的长期侧向合力 $P_{\\ell t}$ 是该压力分布的积分：\n$$\nP_{\\ell t} = \\int_{0}^{H} p_{\\ell t}(z) \\, dz = \\int_{0}^{H} \\left[ (1 - \\sin(\\phi'))(\\gamma_{\\mathrm{sat}} - \\gamma_w) + \\gamma_w \\right] z \\, dz\n$$\n进行积分：\n$$\nP_{\\ell t} = \\left[ (1 - \\sin(\\phi'))(\\gamma_{\\mathrm{sat}} - \\gamma_w) + \\gamma_w \\right] \\left[ \\frac{z^2}{2} \\right]_{0}^{H} = \\frac{1}{2} \\left[ (1 - \\sin(\\phi'))(\\gamma_{\\mathrm{sat}} - \\gamma_w) + \\gamma_w \\right] H^2\n$$\n\n**第三部分：合力之比**\n\n问题要求计算不排水（短期）合力与长期合力之比 $R$。\n$$\nR = \\frac{P_u}{P_{\\ell t}} = \\frac{\\frac{1}{2} \\gamma_{\\mathrm{sat}} H^2}{\\frac{1}{2} \\left[ (1 - \\sin(\\phi'))(\\gamma_{\\mathrm{sat}} - \\gamma_w) + \\gamma_w \\right] H^2}\n$$\n分子和分母中的项 $\\frac{1}{2} H^2$ 消去，得到：\n$$\nR = \\frac{\\gamma_{\\mathrm{sat}}}{(1 - \\sin(\\phi'))(\\gamma_{\\mathrm{sat}} - \\gamma_w) + \\gamma_w}\n$$\n现在，我们代入给定的数值：\n$\\gamma_{\\mathrm{sat}} = 18\\,\\mathrm{kN/m^3}$\n$\\gamma_w = 9.81\\,\\mathrm{kN/m^3}$\n$\\phi' = 25^{\\circ}$\n\n首先，计算分母中的各项。\n$\\gamma_{\\mathrm{sat}} - \\gamma_w = 18 - 9.81 = 8.19\\,\\mathrm{kN/m^3}$\n$\\sin(\\phi') = \\sin(25^{\\circ}) \\approx 0.422618$\n$1 - \\sin(\\phi') = 1 - 0.422618 = 0.577382$\n\n分母变为：\n$$\n(0.577382)(8.19) + 9.81 = 4.728758 + 9.81 = 14.538758\n$$\n现在，计算比值 $R$：\n$$\nR = \\frac{18}{14.538758} \\approx 1.23807\n$$\n按要求将最终答案四舍五入到四位有效数字：\n$$\nR \\approx 1.238\n$$",
            "answer": "$$\\boxed{1.238}$$"
        },
        {
            "introduction": "计算岩土力学将理论模型与强大的数值工具相结合，以解决复杂的工程问题，但模型的预测能力在很大程度上取决于参数的准确性。本高级练习旨在弥合理论与计算实践之间的鸿沟，它要求您为一个简化的挡土墙模型实施伴随方法（adjoint method）以进行灵敏度分析。掌握这种先进技术对于根据现场观测数据高效地校准模型参数至关重要，这是现代计算科学和工程中进行参数反演和数据同化的核心技能。",
            "id": "3500110",
            "problem": "一个高度为 $H$ 的垂直挡土墙被建模为放置在代表土壤刚度的 Winkler 弹性地基上的 Euler–Bernoulli 梁。沿深度的水平挠度剖面由 $w(z)$ 表示，其中 $z \\in [0,H]$ 是从墙顶向下测量的深度。在小应变、线弹性体系下，控制平衡方程被表述为以下边值问题\n$$\nE I \\, \\frac{d^4 w}{dz^4}(z) + k_s \\, w(z) = q(z;\\phi) \\quad \\text{for } z \\in (0,H),\n$$\n边界条件为\n$$\n\\frac{d^2 w}{dz^2}(0) = 0, \\quad \\frac{d^3 w}{dz^3}(0) = 0, \\quad w(H)=0, \\quad \\frac{dw}{dz}(H)=0.\n$$\n这里，$E$ 是墙体的杨氏模量，$I$ 是墙体的截面二次矩，$k_s$ 是单位长度的 Winkler 地基刚度，$q(z;\\phi)$ 是根据 Rankine 主动土压力理论得到的单位长度上的侧向土荷载。使用 Rankine 理论，当土壤内摩擦角为 $\\phi$（以度为单位）时，主动土压力系数为\n$$\nK_a(\\phi) = \\tan^2\\!\\Big(\\frac{\\pi}{4} - \\frac{\\phi_{\\mathrm{rad}}}{2}\\Big), \\quad \\phi_{\\mathrm{rad}} = \\phi \\frac{\\pi}{180},\n$$\n分布荷载为\n$$\nq(z;\\phi) = K_a(\\phi)\\, \\gamma \\, z,\n$$\n其中 $\\gamma$ 是土壤的单位重量。Winkler 刚度取为\n$$\nk_s = \\frac{E_s}{1-\\nu_s^2},\n$$\n其中 $E_s$ 是土壤的杨氏模量，$\\nu_s$ 是土壤的泊松比。\n\n对于算法微分和逆分析，设最大挠度为平滑的 $p$-范数近似\n$$\nw_{\\max}(E,\\phi) := \\Bigg(\\sum_{i=0}^{N-1} \\big| w_i(E,\\phi)\\big|^p \\Bigg)^{\\!\\!1/p},\n$$\n其中 $w_i$ 表示节点 $z_i$ 处的离散化挠度，$p$ 是一个固定的偶数。设相对于观测剖面 $w_{\\mathrm{obs}}(z)$ 的逆向辨识损失为离散最小二乘泛函\n$$\nJ_{\\mathrm{inv}}(E,\\phi) := \\frac{1}{2}\\sum_{i=0}^{N-1} \\big( w_i(E,\\phi) - w_{\\mathrm{obs},i} \\big)^2 \\, \\Delta z,\n$$\n其中 $\\Delta z$ 是均匀的网格间距。\n\n您必须在具有 $N$ 个节点的均匀网格上构建该边值问题的有限差分离散化，组装得到的线性系统\n$$\n\\mathbf{A}(E,\\phi)\\,\\mathbf{w} = \\mathbf{b}(\\phi),\n$$\n并求解 $\\mathbf{w} \\in \\mathbb{R}^N$。使用伴随法进行算法微分求解线性系统，高效地计算偏导数 $\\partial w_{\\max}/\\partial \\phi$ 和 $\\partial w_{\\max}/\\partial E$，以及伴随梯度 $\\nabla J_{\\mathrm{inv}} = \\big(\\partial J_{\\mathrm{inv}}/\\partial E,\\; \\partial J_{\\mathrm{inv}}/\\partial \\phi\\big)$，而无需构建稠密的雅可比矩阵。\n\n离散化要求如下：\n- 对内部节点使用中心五点模板计算四阶导数，并使用协调的单边差分公式来施加边界条件 $\\frac{d^2 w}{dz^2}(0) = 0$、$\\frac{d^3 w}{dz^3}(0) = 0$、$w(H)=0$ 和 $\\frac{dw}{dz}(H)=0$。\n- 使用具有 $N$ 个节点的均匀网格：$z_i = i \\,\\Delta z$, $i=0,\\ldots,N-1$, $\\Delta z = H/(N-1)$。\n\n算法微分要求如下：\n- 对线性系统 $\\mathbf{A}(E,\\phi)\\mathbf{w}=\\mathbf{b}(\\phi)$ 和标量目标 $J(\\mathbf{w},E,\\phi)$ 推导并实现反向模式伴随法，得到\n$$\n\\frac{\\partial J}{\\partial \\theta} = -\\boldsymbol{\\lambda}^\\top \\frac{\\partial \\mathbf{A}}{\\partial \\theta}\\,\\mathbf{w} + \\boldsymbol{\\lambda}^\\top \\frac{\\partial \\mathbf{b}}{\\partial \\theta},\n\\quad \\text{其中 } \\boldsymbol{\\lambda} \\text{ 求解 } \\mathbf{A}(E,\\phi)^\\top \\boldsymbol{\\lambda} = \\frac{\\partial J}{\\partial \\mathbf{w}},\n$$\n其中对每个参数 $\\theta \\in \\{E,\\phi\\}$。\n- 对于 $J(\\mathbf{w},E,\\phi) = w_{\\max}(E,\\phi)$，使用 $p$-范数相对于 $\\mathbf{w}$ 的精确梯度。\n- 对于 $J(\\mathbf{w},E,\\phi) = J_{\\mathrm{inv}}(E,\\phi)$，在权重为 $\\Delta z$ 的离散内积下，使用相对于 $\\mathbf{w}$ 的精确梯度。\n\n物理单位和输出单位：\n- 使用 $H$（单位 $\\mathrm{m}$）、$E$（单位 $\\mathrm{GPa}$，内部转换为 $\\mathrm{Pa}$）、$I$（单位 $\\mathrm{m}^4$）、$E_s$（单位 $\\mathrm{MPa}$，内部转换为 $\\mathrm{Pa}$）、$\\nu_s$（无量纲）、$\\gamma$（单位 $\\mathrm{N/m}^3$）、$\\phi$（单位度）、$w$（单位 $\\mathrm{m}$）。\n- 报告 $w_{\\max}$（单位 $\\mathrm{m}$）、$\\partial w_{\\max}/\\partial \\phi$（单位 $\\mathrm{m/degree}$）和 $\\partial w_{\\max}/\\partial E$（单位 $\\mathrm{m/GPa}$）。\n- 报告逆损失梯度 $\\partial J_{\\mathrm{inv}}/\\partial \\phi$（单位 $\\mathrm{m}^2/\\mathrm{degree}$）和 $\\partial J_{\\mathrm{inv}}/\\partial E$（单位 $\\mathrm{m}^2/\\mathrm{GPa}$）。\n\n通过有限差分进行验证：\n- 对 $w_{\\max}$ 和 $J_{\\mathrm{inv}}$，使用中心有限差分法，通过小的扰动 $\\delta_\\phi$ 和 $\\delta_E$ 来验证基于伴随法的导数。\n- 使用相对容差 $\\tau$ 为每个导数比较生成布尔值的通过/失败检查。\n\n测试套件：\n- 设 $H = 12\\,\\mathrm{m}$，$N = 101$，$p = 8$，$I = 0.05\\,\\mathrm{m}^4$，$E_s = 50\\,\\mathrm{MPa}$，$\\nu_s = 0.30$，$\\gamma = 18000\\,\\mathrm{N/m}^3$，$\\delta_\\phi = 10^{-3}\\,\\mathrm{degree}$，$\\delta_E = 10^{-3}\\,\\mathrm{GPa}$，$\\tau = 10^{-4}$。\n- 情况 1（理想情况）：$(\\phi, E) = (30\\,\\mathrm{degree},\\,30\\,\\mathrm{GPa})$。计算并返回 $w_{\\max}$、$\\partial w_{\\max}/\\partial \\phi$、$\\partial w_{\\max}/\\partial E$，以及两个布尔值，指示 $w_{\\max}$ 相对于 $\\phi$ 和 $E$ 的伴随梯度是否通过有限差分检查。\n- 情况 2（逆向辨识检查）：使用来自 $(\\phi_{\\mathrm{true}},E_{\\mathrm{true}}) = (32\\,\\mathrm{degree},\\,28\\,\\mathrm{GPa})$ 的合成观测数据，并在每个节点上添加振幅为 $10^{-5}\\,\\mathrm{m}$ 的零均值噪声。在初始猜测值 $(\\phi, E) = (30\\,\\mathrm{degree},\\,30\\,\\mathrm{GPa})$ 下评估 $J_{\\mathrm{inv}}$ 的伴随梯度，并返回关于 $\\phi$ 和 $E$ 的有限差分检查的两个布尔值。\n- 情况 3（高摩擦角附近的边界行为）：$(\\phi, E) = (45\\,\\mathrm{degree},\\,20\\,\\mathrm{GPa})$。返回 $w_{\\max}$、$\\partial w_{\\max}/\\partial \\phi$、$\\partial w_{\\max}/\\partial E$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result_1,result_2,\\ldots]$）。该列表必须按顺序包括：\n  $[w_{\\max}^{(1)},\\; (\\partial w_{\\max}/\\partial \\phi)^{(1)},\\; (\\partial w_{\\max}/\\partial E)^{(1)},\\; \\mathrm{bool}_\\phi^{(1)},\\; \\mathrm{bool}_E^{(1)},\\; \\mathrm{bool}_\\phi^{\\mathrm{inv}},\\; \\mathrm{bool}_E^{\\mathrm{inv}},\\; w_{\\max}^{(3)},\\; (\\partial w_{\\max}/\\partial \\phi)^{(3)},\\; (\\partial w_{\\max}/\\partial E)^{(3)}]$,\n  其中上标 $(1)$ 和 $(3)$ 指的是情况 1 和情况 3，而 $\\mathrm{bool}_\\phi^{\\mathrm{inv}}, \\mathrm{bool}_E^{\\mathrm{inv}}$ 是情况 2 的逆向检查布尔值。",
            "solution": "该问题要求通过数值方法求解一个模拟挡土墙行为的四阶边值问题，并利用伴随法进行高效的灵敏度分析。以下是求解该问题的步骤和实现。\n\n### 1. 数学模型与离散化\n控制物理系统的 Euler-Bernoulli 梁方程通过有限差分法进行离散化。在一个包含 $N$ 个节点的均匀网格上，四阶微分算子使用内部节点的中心五点模板近似，而四个边界条件（顶部自由、底部固定）则使用相应的单边差分格式施加。这将原始的常微分方程边值问题转化为一个大型线性代数方程组 $\\mathbf{A}(E)\\mathbf{w} = \\mathbf{b}(\\phi)$，其中 $\\mathbf{w}$ 是节点挠度向量。\n\n### 2. 伴随法灵敏度分析\n为了高效计算目标函数 $J$ (例如最大挠度 $w_{\\max}$ 或逆向辨识损失 $J_{\\mathrm{inv}}$) 相对于模型参数 $\\theta \\in \\{E, \\phi\\}$ 的梯度，我们采用离散伴随法。该方法避免了构造和存储昂贵的雅可比矩阵 $\\frac{\\partial \\mathbf{w}}{\\partial \\theta}$。其核心步骤包括：\n1.  **正向求解**: 求解线性系统 $\\mathbf{A}\\mathbf{w} = \\mathbf{b}$ 得到状态向量 $\\mathbf{w}$。\n2.  **伴随源项**: 计算目标函数 $J$ 相对于状态向量 $\\mathbf{w}$ 的梯度 $\\frac{\\partial J}{\\partial \\mathbf{w}}$。\n3.  **伴随求解**: 求解伴随线性系统 $\\mathbf{A}^\\top \\boldsymbol{\\lambda} = \\frac{\\partial J}{\\partial \\mathbf{w}}$ 得到伴随向量 $\\boldsymbol{\\lambda}$。\n4.  **梯度组装**: 利用伴随向量 $\\boldsymbol{\\lambda}$ 和系统矩阵/向量对参数的偏导数（$\\frac{\\partial \\mathbf{A}}{\\partial \\theta}$, $\\frac{\\partial \\mathbf{b}}{\\partial \\theta}$）组装最终的梯度：\n    $$\n    \\frac{dJ}{d\\theta} = -\\boldsymbol{\\lambda}^\\top \\frac{\\partial \\mathbf{A}}{\\partial \\theta}\\,\\mathbf{w} + \\boldsymbol{\\lambda}^\\top \\frac{\\partial \\mathbf{b}}{\\partial \\theta}\n    $$\n此方法对于每个参数只需要进行一次额外的线性求解，计算成本远低于直接方法或有限差分法，尤其是在参数众多的情况下。\n\n### 3. 代码实现\n以下 Python 代码实现了上述数值方案，包括系统组装、正向求解、伴随求解和梯度验证。\n```python\nimport numpy as np\n\nclass RetainingWallSolver:\n    \"\"\"\n    Solves the retaining wall BVP and computes sensitivities using the adjoint method.\n    \"\"\"\n    def __init__(self, H, N, p, I, E_s_MPa, nu_s, gamma):\n        self.H = H\n        self.N = N\n        self.p = p\n        self.I = I\n        self.E_s = E_s_MPa * 1e6  # Convert MPa to Pa\n        self.nu_s = nu_s\n        self.gamma = gamma\n\n        self.dz = H / (N - 1)\n        self.z = np.linspace(0, H, N)\n        self.k_s = self.E_s / (1 - self.nu_s**2)\n\n    def _K_a(self, phi_deg):\n        \"\"\"Computes Rankine's active earth pressure coefficient.\"\"\"\n        phi_rad = np.deg2rad(phi_deg)\n        return np.tan(np.pi / 4 - phi_rad / 2)**2\n\n    def _dKa_dphi(self, phi_deg):\n        \"\"\"Computes the derivative of K_a with respect to phi in degrees.\"\"\"\n        u = np.pi / 4 - np.deg2rad(phi_deg) / 2\n        # d/d(phi_deg) [phi_deg * pi/180] = pi/180\n        du_dphi_deg = - (np.pi / 180) / 2\n        return 2 * np.tan(u) * (1 / np.cos(u)**2) * du_dphi_deg\n\n    def _assemble_system(self, E_GPa, phi_deg):\n        \"\"\"Assembles the scaled linear system A'w = b'.\"\"\"\n        E_Pa = E_GPa * 1e9\n        N = self.N\n        dz = self.dz\n        \n        A = np.zeros((N, N))\n        b = np.zeros(N)\n        \n        # Row 0: BC w''(0) = 0, scaled by dz^2\n        A[0, 0:4] = [2, -5, 4, -1]\n        \n        # Row 1: BC w'''(0) = 0, scaled by 2*dz^3\n        A[1, 0:5] = [-5, 18, -24, 14, -3]\n\n        # Rows i = 2 to N-3: PDE EIw'''' + k_s*w = q, scaled by dz^4\n        stencil_d4 = np.array([1, -4, 6, -4, 1])\n        for i in range(2, N - 2):\n            A[i, i-2:i+3] = E_Pa * self.I * stencil_d4\n            A[i, i] += self.k_s * dz**4\n            \n            q_i = self._K_a(phi_deg) * self.gamma * self.z[i]\n            b[i] = q_i * dz**4\n\n        # Row N-2: BC w'(H) = 0, scaled by 2*dz\n        A[N-2, N-3:N] = [1, -4, 3]\n\n        # Row N-1: BC w(H) = 0\n        A[N-1, N-1] = 1\n\n        return A, b\n\n    def compute_solution_and_gradients(self, E_GPa, phi_deg, objective_type, w_obs=None):\n        \"\"\"\n        Performs the forward solve, adjoint solve, and computes objective and gradients.\n        \"\"\"\n        A, b = self._assemble_system(E_GPa, phi_deg)\n        \n        try:\n            w = np.linalg.solve(A, b)\n        except np.linalg.LinAlgError:\n            return np.nan, np.nan, np.nan, None\n\n        if objective_type == 'w_max':\n            # p is even, so |w|^p = w^p\n            J = np.power(np.sum(w**self.p), 1.0/self.p)\n            dJ_dw = np.power(J, 1 - self.p) * (w**(self.p - 1))\n        elif objective_type == 'J_inv':\n            J = 0.5 * np.sum((w - w_obs)**2) * self.dz\n            dJ_dw = (w - w_obs) * self.dz\n        else:\n            raise ValueError(\"Invalid objective type\")\n\n        try:\n            lamb = np.linalg.solve(A.T, dJ_dw)\n        except np.linalg.LinAlgError:\n            return J, np.nan, np.nan, w\n            \n        # --- Gradient w.r.t. E ---\n        N = self.N\n        dz = self.dz\n        # This is d(A_scaled)/d(E_Pa)\n        dA_scaled_dE_Pa = np.zeros_like(A)\n        stencil_d4 = np.array([1, -4, 6, -4, 1])\n        for i in range(2, N - 2):\n            # d/dE_Pa(E_Pa * I * stencil) = I * stencil\n            dA_scaled_dE_Pa[i, i-2:i+3] = self.I * stencil_d4\n        \n        dJ_dE_Pa = -lamb.T @ (dA_scaled_dE_Pa @ w)\n        dJ_dE_GPa = dJ_dE_Pa * 1e9 # Convert units/Pa to units/GPa\n\n        # --- Gradient w.r.t. phi ---\n        db_scaled_dphi = np.zeros_like(b)\n        dKa_val = self._dKa_dphi(phi_deg)\n        for i in range(2, N - 2):\n            # d/dphi (K_a(phi)*gamma*z_i * dz^4)\n            db_scaled_dphi[i] = dKa_val * self.gamma * self.z[i] * dz**4\n\n        dJ_dphi = lamb.T @ db_scaled_dphi\n        \n        return J, dJ_dE_GPa, dJ_dphi, w\n\n    def verify_gradients(self, E_GPa, phi_deg, delta_E, delta_phi, tau, objective_type, w_obs=None):\n        \"\"\"\n        Verifies adjoint gradients against finite differences.\n        \"\"\"\n        J_center, dJ_dE_adj, dJ_dphi_adj, _ = self.compute_solution_and_gradients(E_GPa, phi_deg, objective_type, w_obs)\n        if np.isnan(dJ_dE_adj) or np.isnan(dJ_dphi_adj):\n            return False, False \n\n        # Finite Difference for E\n        J_plus_E, _, _, _ = self.compute_solution_and_gradients(E_GPa + delta_E, phi_deg, objective_type, w_obs)\n        J_minus_E, _, _, _ = self.compute_solution_and_gradients(E_GPa - delta_E, phi_deg, objective_type, w_obs)\n        dJ_dE_fd = (J_plus_E - J_minus_E) / (2 * delta_E)\n\n        # Finite Difference for phi\n        J_plus_phi, _, _, _ = self.compute_solution_and_gradients(E_GPa, phi_deg + delta_phi, objective_type, w_obs)\n        J_minus_phi, _, _, _ = self.compute_solution_and_gradients(E_GPa, phi_deg - delta_phi, objective_type, w_obs)\n        dJ_dphi_fd = (J_plus_phi - J_minus_phi) / (2 * delta_phi)\n\n        err_E_rel = np.abs(dJ_dE_adj - dJ_dE_fd) / (np.abs(dJ_dE_fd) + 1e-12)\n        err_phi_rel = np.abs(dJ_dphi_adj - dJ_dphi_fd) / (np.abs(dJ_dphi_fd) + 1e-12)\n\n        check_E = err_E_rel  tau\n        check_phi = err_phi_rel  tau\n        \n        return check_phi, check_E\n```",
            "answer": "$$\\boxed{\\text{答案由解答中的代码生成}}$$"
        }
    ]
}