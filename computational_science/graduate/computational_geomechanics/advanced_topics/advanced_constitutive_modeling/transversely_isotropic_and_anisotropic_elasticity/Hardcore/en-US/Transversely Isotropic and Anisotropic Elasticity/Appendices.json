{
    "hands_on_practices": [
        {
            "introduction": "The five independent elastic constants of a transversely isotropic material can seem abstract. This exercise grounds these mathematical parameters by challenging you to design a minimal set of idealized laboratory tests—simple tension and shear—to uniquely determine each constant. By connecting the components of the compliance matrix to specific stress states and measurable strains, this practice solidifies your understanding of what each constant represents and how they are experimentally determined. ",
            "id": "3568653",
            "problem": "A homogeneous, linear elastic transversely isotropic (TI) geomaterial specimen has a known axis of material symmetry aligned with the coordinate direction $x_3$. Under the small-strain assumption, the stress components are $\\sigma_1$, $\\sigma_2$, $\\sigma_3$, $\\tau_{23}$, $\\tau_{13}$, $\\tau_{12}$ and the strain components are $\\epsilon_1$, $\\epsilon_2$, $\\epsilon_3$, $\\gamma_{23}$, $\\gamma_{13}$, $\\gamma_{12}$, using standard Voigt notation. In TI elasticity with axis $x_3$, there are five independent engineering constants: the in-plane Young’s modulus $E_\\perp$ (identical along $x_1$ and $x_2$), the axial Young’s modulus $E_\\parallel$ (along $x_3$), the in-plane Poisson’s ratio $\\nu_{12}$, the axial-to-in-plane Poisson’s ratio $\\nu_{13}$, and the shear modulus in planes containing the axis $G_{13}$ (equal to $G_{23}$ by symmetry). The in-plane shear modulus $G_{12}$ is not independent because the plane normal to $x_3$ is isotropic.\n\nYour task is to select a minimal yet complete laboratory test suite that, using only uniaxial loadings parallel and perpendicular to the symmetry axis and shear tests in planes containing and normal to the axis, uniquely identifies the five independent TI engineering constants, without invoking plane-stress or plane-strain approximations and without relying on multiaxial proportional loading. Each test description must specify the applied nonzero stress component(s), all other stresses held at zero, and the strain components that must be measured to ensure identifiability of the constants. Consider practical data acquisition where axial and lateral strains can be measured simultaneously in uniaxial tests, and shear strains can be measured in pure shear tests.\n\nWhich option provides such a minimal and complete test suite?\n\nA. Test $1$: Uniaxial loading parallel to $x_3$, apply $\\sigma_3 \\neq 0$ with $\\sigma_1=\\sigma_2=\\tau_{23}=\\tau_{13}=\\tau_{12}=0$, measure $\\epsilon_3$ and either $\\epsilon_1$ or $\\epsilon_2$. Test $2$: Uniaxial loading perpendicular to $x_3$, apply $\\sigma_1 \\neq 0$ with $\\sigma_2=\\sigma_3=\\tau_{23}=\\tau_{13}=\\tau_{12}=0$, measure $\\epsilon_1$ and $\\epsilon_2$. Test $3$: Pure shear in a plane containing the axis, apply $\\tau_{13} \\neq 0$ with $\\sigma_1=\\sigma_2=\\sigma_3=\\tau_{23}=\\tau_{12}=0$, measure $\\gamma_{13}$. Test $4$: Pure shear in the plane normal to the axis, apply $\\tau_{12} \\neq 0$ with $\\sigma_1=\\sigma_2=\\sigma_3=\\tau_{23}=\\tau_{13}=0$, measure $\\gamma_{12}$.\n\nB. Test $1$: Uniaxial loading parallel to $x_3$, apply $\\sigma_3 \\neq 0$, measure only $\\epsilon_3$. Test $2$: Uniaxial loading perpendicular to $x_3$, apply $\\sigma_1 \\neq 0$, measure only $\\epsilon_1$. Test $3$: Pure shear in a plane containing the axis, apply $\\tau_{13} \\neq 0$, measure $\\gamma_{13}$. Test $4$: Pure shear in the plane normal to the axis, apply $\\tau_{12} \\neq 0$, measure $\\gamma_{12}$.\n\nC. Test $1$: Uniaxial loading parallel to $x_3$, apply $\\sigma_3 \\neq 0$, measure $\\epsilon_3$ and $\\epsilon_2$. Test $2$: Uniaxial loading perpendicular to $x_3$, apply equal biaxial in-plane loading $\\sigma_1=\\sigma_2 \\neq 0$, measure only $\\epsilon_1$. Test $3$: Pure shear in a plane normal to the axis, apply $\\tau_{12} \\neq 0$, measure $\\gamma_{12}$. Test $4$: Omit the shear test in the plane containing the axis.\n\nD. Test $1$: Hydrostatic compression, apply $\\sigma_1=\\sigma_2=\\sigma_3 \\neq 0$, measure volumetric strain $\\epsilon_1+\\epsilon_2+\\epsilon_3$. Test $2$: Uniaxial loading perpendicular to $x_3$, apply $\\sigma_1 \\neq 0$, measure $\\epsilon_1$ and $\\epsilon_3$. Test $3$: Pure shear in a plane containing the axis, apply $\\tau_{23} \\neq 0$, measure $\\gamma_{23}$. Test $4$: Omit the shear test in the plane normal to the axis.\n\nE. Test $1$: Uniaxial loading parallel to $x_3$, apply $\\sigma_3 \\neq 0$, measure $\\epsilon_3$ and $\\epsilon_1$. Test $2$: Uniaxial loading perpendicular to $x_3$, apply $\\sigma_1 \\neq 0$, measure $\\epsilon_1$ and $\\epsilon_3$. Test $3$: Torsion about the $x_3$ axis on a circular cylinder, interpret measured twist to obtain $G_{13}$. Test $4$: Omit the shear test in the plane normal to the axis.\n\nSelect the single best option.",
            "solution": "Begin with the linear elastic constitutive relation in compliance form for a transversely isotropic (TI) material with symmetry axis along $x_3$:\n$$\n\\begin{bmatrix}\n\\epsilon_1\\\\\n\\epsilon_2\\\\\n\\epsilon_3\\\\\n\\gamma_{23}\\\\\n\\gamma_{13}\\\\\n\\gamma_{12}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nS_{11} & S_{12} & S_{13} & 0 & 0 & 0\\\\\nS_{12} & S_{11} & S_{13} & 0 & 0 & 0\\\\\nS_{13} & S_{13} & S_{33} & 0 & 0 & 0\\\\\n0 & 0 & 0 & S_{44} & 0 & 0\\\\\n0 & 0 & 0 & 0 & S_{44} & 0\\\\\n0 & 0 & 0 & 0 & 0 & S_{66}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\sigma_1\\\\\n\\sigma_2\\\\\n\\sigma_3\\\\\n\\tau_{23}\\\\\n\\tau_{13}\\\\\n\\tau_{12}\n\\end{bmatrix}.\n$$\nThe five independent engineering constants are related to the compliance coefficients by\n$$\nS_{11}=\\frac{1}{E_\\perp},\\quad\nS_{33}=\\frac{1}{E_\\parallel},\\quad\nS_{12}=-\\frac{\\nu_{12}}{E_\\perp},\\quad\nS_{13}=-\\frac{\\nu_{13}}{E_\\parallel},\\quad\nS_{44}=\\frac{1}{G_{13}}.\n$$\nBecause the $x_1x_2$ plane is isotropic, $G_{12}$ is not independent and obeys\n$$\nS_{66}=\\frac{1}{G_{12}}=\\frac{2(1+\\nu_{12})}{E_\\perp},\\qquad G_{12}=\\frac{E_\\perp}{2(1+\\nu_{12})}.\n$$\nWe now show how specific simple stress states and corresponding strain measurements identify each constant.\n\nUniaxial loading parallel to the axis: apply $\\sigma_3\\neq 0$ with all other stresses zero. Then\n$$\n\\epsilon_3 = S_{33}\\sigma_3 = \\frac{\\sigma_3}{E_\\parallel},\\qquad\n\\epsilon_1 = S_{13}\\sigma_3 = -\\frac{\\nu_{13}}{E_\\parallel}\\sigma_3,\\qquad\n\\epsilon_2 = S_{13}\\sigma_3.\n$$\nFrom measured $\\epsilon_3$ and either $\\epsilon_1$ or $\\epsilon_2$, we obtain\n$$\nE_\\parallel = \\frac{\\sigma_3}{\\epsilon_3},\\qquad\n\\nu_{13} = -\\frac{\\epsilon_1}{\\epsilon_3} = -\\frac{\\epsilon_2}{\\epsilon_3}.\n$$\n\nUniaxial loading perpendicular to the axis: apply, for instance, $\\sigma_1\\neq 0$ with all other stresses zero. Then\n$$\n\\epsilon_1 = S_{11}\\sigma_1 = \\frac{\\sigma_1}{E_\\perp},\\qquad\n\\epsilon_2 = S_{12}\\sigma_1 = -\\frac{\\nu_{12}}{E_\\perp}\\sigma_1,\\qquad\n\\epsilon_3 = S_{13}\\sigma_1 = -\\frac{\\nu_{13}}{E_\\parallel}\\sigma_1.\n$$\nFrom measured $\\epsilon_1$ and $\\epsilon_2$, we obtain\n$$\nE_\\perp = \\frac{\\sigma_1}{\\epsilon_1},\\qquad\n\\nu_{12} = -\\frac{\\epsilon_2}{\\epsilon_1}.\n$$\nNote that measuring $\\epsilon_3$ under $\\sigma_1$ would provide $\\nu_{31}$ via $-\\epsilon_3/\\epsilon_1$, and reciprocity in linear elasticity implies $\\nu_{13}/E_\\parallel=\\nu_{31}/E_\\perp$, but using $\\epsilon_2$ is direct for $\\nu_{12}$.\n\nPure shear in a plane containing the axis: apply $\\tau_{13}\\neq 0$ with all other stresses zero. Then\n$$\n\\gamma_{13} = S_{44}\\tau_{13} = \\frac{\\tau_{13}}{G_{13}}\\quad\\Rightarrow\\quad G_{13}=\\frac{\\tau_{13}}{\\gamma_{13}}.\n$$\n\nPure shear in the plane normal to the axis: apply $\\tau_{12}\\neq 0$ with all other stresses zero. Then\n$$\n\\gamma_{12} = S_{66}\\tau_{12} = \\frac{\\tau_{12}}{G_{12}}\\quad\\Rightarrow\\quad G_{12}=\\frac{\\tau_{12}}{\\gamma_{12}}.\n$$\nIn TI, $G_{12}$ must satisfy $G_{12}=E_\\perp/[2(1+\\nu_{12})]$; thus the $\\tau_{12}$ test provides a cross-check rather than an independent constant.\n\nPutting these together, a minimal and complete identification of the five independent TI engineering constants $\\{E_\\perp,E_\\parallel,\\nu_{12},\\nu_{13},G_{13}\\}$ is achieved by:\n- Uniaxial $\\sigma_3$ with measurements of $\\epsilon_3$ and a lateral strain ($\\epsilon_1$ or $\\epsilon_2$),\n- Uniaxial $\\sigma_1$ with measurements of $\\epsilon_1$ and $\\epsilon_2$,\n- Pure shear $\\tau_{13}$ with measurement of $\\gamma_{13}$,\nand optionally,\n- Pure shear $\\tau_{12}$ with measurement of $\\gamma_{12}$ to validate $G_{12}$ against $E_\\perp$ and $\\nu_{12}$.\n\nOption-by-option analysis:\n\nA. Specifies exactly the stress states and measurements outlined above. Test $1$ identifies $E_\\parallel$ and $\\nu_{13}$. Test $2$ identifies $E_\\perp$ and $\\nu_{12}$. Test $3$ identifies $G_{13}$. Test $4$ measures $G_{12}$, which is not independent but validates the TI isotropy in the $x_1x_2$ plane via $G_{12}=E_\\perp/[2(1+\\nu_{12})]$. This suite minimally uses uniaxial parallel and perpendicular loadings and shear tests in planes containing and normal to the axis to identify the five independent constants, with no reliance on plane-stress assumptions or multiaxial proportional loading. Verdict — Correct.\n\nB. Measures only axial strains in the uniaxial tests, which yields $E_\\parallel$ and $E_\\perp$ but not $\\nu_{13}$ or $\\nu_{12}$; hence the five independent constants cannot be fully identified. Verdict — Incorrect.\n\nC. Uses $\\sigma_3$ with $\\epsilon_3$ and $\\epsilon_2$, which can identify $E_\\parallel$ and $\\nu_{13}$, but then applies equal biaxial $\\sigma_1=\\sigma_2$ and measures only $\\epsilon_1$. A biaxial test with a single strain measurement cannot isolate $\\nu_{12}$; the coupling to $\\epsilon_2$ under $\\sigma_1$ is needed. Additionally, it omits the shear test in a plane containing the axis, so $G_{13}$ is not identified. Verdict — Incorrect.\n\nD. Hydrostatic compression cannot isolate the anisotropic constants uniquely; it aggregates responses and does not separate $E_\\perp$, $E_\\parallel$, $\\nu_{12}$, and $\\nu_{13}$. While $\\sigma_1$ with $\\epsilon_1$ and $\\epsilon_3$ could, via reciprocity, relate $\\nu_{13}$ and $\\nu_{31}$, this path still lacks direct identification of $\\nu_{12}$ without measuring $\\epsilon_2$ under in-plane uniaxial loading. It also omits the shear test normal to the axis and provides no independent path to $G_{12}$ verification. Verdict — Incorrect.\n\nE. The torsion test about $x_3$ on a circular cylinder primarily engages shear in cross-sections normal to the axis, i.e., the $x_1x_2$ plane, and therefore provides $G_{12}$, not $G_{13}$. Thus it misidentifies the shear modulus to be determined in planes containing the axis. Moreover, omitting the $\\tau_{12}$ test removes the validation route for in-plane isotropy. Verdict — Incorrect.\n\nTherefore, the only option that meets the stated requirements and ensures identifiability of the five independent TI engineering constants using the prescribed types of tests is Option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The choice between plane stress and plane strain is a critical simplifying assumption in analyzing thin or thick structures, but for anisotropic materials, this choice has more complex consequences than for isotropic ones. This exercise asks you to quantify the difference in predicted bending behavior for a transversely isotropic plate under both assumptions. You will derive the reduced in-plane stiffness matrices and see firsthand how out-of-plane properties, which are neglected in plane stress, influence the material's response under plane strain, leading to different predictions for stiffness and curvature. ",
            "id": "3568616",
            "problem": "A transversely isotropic (TI) rock layer, representative of a stratified geologic formation, is modeled as a laminate composed of identical, perfectly bonded layers whose axis of transverse isotropy is aligned with the out-of-plane direction $z$. The in-plane directions $x$ and $y$ are isotropic. Under small deformation, the three-dimensional linear elastic constitutive law is written in the compliance form $\\boldsymbol{\\varepsilon} = \\mathbf{S}\\,\\boldsymbol{\\sigma}$, where $\\boldsymbol{\\varepsilon}$ is the strain vector and $\\boldsymbol{\\sigma}$ is the stress vector. For a TI material with in-plane isotropy, the nonzero engineering constants are the in-plane Young’s modulus $E_{h}$, the out-of-plane Young’s modulus $E_{v}$, the in-plane Poisson’s ratio $\\nu_{hh}$, the coupling Poisson’s ratios $\\nu_{hv}$ and $\\nu_{vh}$ that satisfy reciprocity $E_{h}\\,\\nu_{vh} = E_{v}\\,\\nu_{hv}$, the in-plane shear modulus $G_{h}$, and the out-of-plane shear modulus $G_{hv}$. Assume Kirchhoff–Love thin plate bending kinematics and neglect transverse shear deformation. Consider a wide plate of total thickness $h$ subjected to a uniform bending moment per unit width $M_{x}$ producing curvature about the $y$-axis, i.e., a mid-surface curvature $\\kappa_{x}$.\n\nUsing the reduced in-plane matrices obtained from the three-dimensional TI compliance by enforcing either the plane stress condition ($\\sigma_{z} = 0$, $\\tau_{xz} = 0$, $\\tau_{yz} = 0$) or the plane strain condition ($\\varepsilon_{z} = 0$, $\\gamma_{xz} = 0$, $\\gamma_{yz} = 0$), derive the directional bending stiffness $D_{xx}$ and the corresponding curvature $\\kappa_{x}$ under each assumption. Then, compute the ratio of the predicted mid-surface $x$-curvatures under plane stress versus plane strain,\n$$\nR = \\frac{\\kappa_{x}^{\\text{(plane stress)}}}{\\kappa_{x}^{\\text{(plane strain)}}},\n$$\nfor the following material parameters:\n- $E_{h} = 30\\,\\mathrm{GPa}$, $E_{v} = 12\\,\\mathrm{GPa}$,\n- $\\nu_{hh} = 0.30$, $\\nu_{hv} = 0.12$, $\\nu_{vh} = \\dfrac{E_{v}}{E_{h}}\\,\\nu_{hv}$,\n- $G_{h} = \\dfrac{E_{h}}{2\\left(1+\\nu_{hh}\\right)}$,\n- $G_{hv}$ is not needed for pure bending about $y$ under the given kinematics.\n\nYou may treat the laminate as macroscopically homogeneous in bending because all layers are identical and aligned. Use the standard plate constitutive relation for bending moments and curvatures and express $D_{xx}$ in terms of the appropriate reduced in-plane stiffness. Express your final answer as a dimensionless number, rounded to four significant figures. Do not include any units in your final answer.",
            "solution": "### Theoretical Formulation\n\nThe constitutive law for a linear elastic material is given in compliance form as $\\boldsymbol{\\varepsilon} = \\mathbf{S}\\,\\boldsymbol{\\sigma}$. For a transversely isotropic material with the plane of isotropy being the $x$-$y$ plane, the compliance matrix $\\mathbf{S}$ relates the engineering strain vector $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_x & \\varepsilon_y & \\varepsilon_z & \\gamma_{yz} & \\gamma_{xz} & \\gamma_{xy} \\end{pmatrix}^T$ to the stress vector $\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_x & \\sigma_y & \\sigma_z & \\tau_{yz} & \\tau_{xz} & \\tau_{xy} \\end{pmatrix}^T$ as follows:\n$$\n\\begin{pmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\varepsilon_z \\\\ \\gamma_{yz} \\\\ \\gamma_{xz} \\\\ \\gamma_{xy} \\end{pmatrix} =\n\\begin{pmatrix}\n1/E_{h} & -\\nu_{hh}/E_{h} & -\\nu_{vh}/E_{h} & 0 & 0 & 0 \\\\\n-\\nu_{hh}/E_{h} & 1/E_{h} & -\\nu_{vh}/E_{h} & 0 & 0 & 0 \\\\\n-\\nu_{hv}/E_{v} & -\\nu_{hv}/E_{v} & 1/E_{v} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1/G_{hv} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1/G_{hv} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 1/G_h\n\\end{pmatrix}\n\\begin{pmatrix} \\sigma_x \\\\ \\sigma_y \\\\ \\sigma_z \\\\ \\tau_{yz} \\\\ \\tau_{xz} \\\\ \\tau_{xy} \\end{pmatrix}\n$$\nThe symmetry of the compliance matrix requires the reciprocity relation $\\dfrac{\\nu_{vh}}{E_h} = \\dfrac{\\nu_{hv}}{E_v}$.\n\nAccording to Kirchhoff-Love plate theory, the strains vary linearly through the plate thickness $z$:\n$$\n\\varepsilon_x(z) = z\\,\\kappa_x, \\quad \\varepsilon_y(z) = z\\,\\kappa_y, \\quad \\gamma_{xy}(z) = z\\,\\kappa_{xy}\n$$\nThe bending moments per unit width are integrals of the stresses, e.g., $M_x = \\int_{-h/2}^{h/2} \\sigma_x(z) z \\, dz$. The relationship between in-plane stresses and strains is described by a $3 \\times 3$ reduced stiffness matrix $\\mathbf{Q}$. For the given TI material, this matrix is of the form:\n$$\n\\begin{pmatrix} \\sigma_x \\\\ \\sigma_y \\\\ \\tau_{xy} \\end{pmatrix} = \\begin{pmatrix} Q_{11} & Q_{12} & 0 \\\\ Q_{12} & Q_{11} & 0 \\\\ 0 & 0 & Q_{66} \\end{pmatrix} \\begin{pmatrix} \\varepsilon_x \\\\ \\varepsilon_y \\\\ \\gamma_{xy} \\end{pmatrix}\n$$\nThe problem describes a wide plate subjected to a uniform bending moment $M_x$, implying cylindrical bending, where $\\kappa_y = 0$ and $\\kappa_{xy} = 0$. Consequently, $\\varepsilon_y(z)=0$ and $\\gamma_{xy}(z)=0$ for all $z$. The stress $\\sigma_x(z)$ is then given by $\\sigma_x(z) = Q_{11} \\varepsilon_x(z) = Q_{11} z \\kappa_x$. Substituting this into the moment integral:\n$$\nM_x = \\int_{-h/2}^{h/2} (Q_{11} z \\kappa_x) z \\, dz = Q_{11} \\kappa_x \\int_{-h/2}^{h/2} z^2 \\, dz = Q_{11} \\kappa_x \\frac{h^3}{12}\n$$\nThe curvature is $\\kappa_x = \\dfrac{12 M_x}{Q_{11} h^3}$. The curvature $\\kappa_x$ is inversely proportional to the stiffness component $Q_{11}$. The ratio of curvatures under the two assumptions will therefore be the inverse ratio of the corresponding $Q_{11}$ values:\n$$\nR = \\frac{\\kappa_{x}^{\\text{(plane stress)}}}{\\kappa_{x}^{\\text{(plane strain)}}} = \\frac{1/Q_{11}^{\\text{(ps)}}}{1/Q_{11}^{\\text{(pe)}}} = \\frac{Q_{11}^{\\text{(pe)}}}{Q_{11}^{\\text{(ps)}}}\n$$\nOur task reduces to finding the expressions for $Q_{11}$ under the plane stress and plane strain assumptions.\n\n### Derivation for Plane Stress ($\\sigma_z = 0$)\n\nUnder the plane stress condition ($\\sigma_z = \\tau_{xz} = \\tau_{yz} = 0$), the in-plane stress-strain relations are taken directly from the top-left portion of the full compliance matrix:\n$$\n\\varepsilon_x = \\frac{1}{E_h}\\sigma_x - \\frac{\\nu_{hh}}{E_h}\\sigma_y\n$$\n$$\n\\varepsilon_y = -\\frac{\\nu_{hh}}{E_h}\\sigma_x + \\frac{1}{E_h}\\sigma_y\n$$\nInverting this system to find stresses in terms of strains gives:\n$$\n\\sigma_x = \\frac{E_h}{1-\\nu_{hh}^2}(\\varepsilon_x + \\nu_{hh}\\varepsilon_y)\n$$\nBy definition, $\\sigma_x = Q_{11}^{(\\text{ps})}\\varepsilon_x + Q_{12}^{(\\text{ps})}\\varepsilon_y$. By comparing coefficients, we identify:\n$$\nQ_{11}^{(\\text{ps})} = \\frac{E_h}{1-\\nu_{hh}^2}\n$$\n\n### Derivation for Plane Strain ($\\varepsilon_z = 0$)\n\nUnder the plane strain condition ($\\varepsilon_z = \\gamma_{xz} = \\gamma_{yz} = 0$), we first find the stress $\\sigma_z$ required to enforce $\\varepsilon_z=0$. From the third row of the full compliance relation:\n$$\n\\varepsilon_z = -\\frac{\\nu_{hv}}{E_v}\\sigma_x - \\frac{\\nu_{hv}}{E_v}\\sigma_y + \\frac{1}{E_v}\\sigma_z = 0 \\quad \\implies \\quad \\sigma_z = \\nu_{hv}(\\sigma_x + \\sigma_y)\n$$\nNow, substitute this expression for $\\sigma_z$ into the equations for $\\varepsilon_x$ and $\\varepsilon_y$:\n$$\n\\varepsilon_x = \\frac{1}{E_h}\\sigma_x - \\frac{\\nu_{hh}}{E_h}\\sigma_y - \\frac{\\nu_{vh}}{E_h}\\sigma_z = \\frac{1}{E_h}\\sigma_x - \\frac{\\nu_{hh}}{E_h}\\sigma_y - \\frac{\\nu_{vh}}{E_h}\\nu_{hv}(\\sigma_x + \\sigma_y)\n$$\nGrouping terms by $\\sigma_x$ and $\\sigma_y$:\n$$\n\\varepsilon_x = \\frac{1}{E_h}(1 - \\nu_{vh}\\nu_{hv})\\sigma_x - \\frac{1}{E_h}(\\nu_{hh} + \\nu_{vh}\\nu_{hv})\\sigma_y\n$$\nBy symmetry, the equation for $\\varepsilon_y$ is:\n$$\n\\varepsilon_y = -\\frac{1}{E_h}(\\nu_{hh} + \\nu_{vh}\\nu_{hv})\\sigma_x + \\frac{1}{E_h}(1 - \\nu_{vh}\\nu_{hv})\\sigma_y\n$$\nWe need to invert this $2 \\times 2$ system to find $\\sigma_x$ as a function of $\\varepsilon_x$ and $\\varepsilon_y$, from which we can identify $Q_{11}^{(\\text{pe})}$. Let the above system be $\\boldsymbol{\\varepsilon} = \\mathbf{S}'\\boldsymbol{\\sigma}$. The inverse matrix is $\\mathbf{Q}^{(\\text{pe})} = (\\mathbf{S}')^{-1}$. The component $Q_{11}^{(\\text{pe})}$ is given by $S'_{22}/\\det(\\mathbf{S'})$.\n$$\n\\det(\\mathbf{S'}) = \\frac{1}{E_h^2} \\left[ (1 - \\nu_{vh}\\nu_{hv})^2 - (\\nu_{hh} + \\nu_{vh}\\nu_{hv})^2 \\right] = \\frac{(1+\\nu_{hh})(1-\\nu_{hh}-2\\nu_{vh}\\nu_{hv})}{E_h^2}\n$$\n$$\nQ_{11}^{(\\text{pe})} = \\frac{\\frac{1}{E_h}(1 - \\nu_{vh}\\nu_{hv})}{\\det(\\mathbf{S'})} = \\frac{E_h(1 - \\nu_{vh}\\nu_{hv})}{(1+\\nu_{hh})(1-\\nu_{hh}-2\\nu_{vh}\\nu_{hv})}\n$$\n\n### Calculation of the Ratio R\n\nNow we compute the ratio $R$:\n$$\nR = \\frac{Q_{11}^{(\\text{pe})}}{Q_{11}^{(\\text{ps})}} = \\frac{\\frac{E_h(1 - \\nu_{vh}\\nu_{hv})}{(1+\\nu_{hh})(1-\\nu_{hh}-2\\nu_{vh}\\nu_{hv})}}{\\frac{E_h}{1-\\nu_{hh}^2}} = \\frac{(1 - \\nu_{vh}\\nu_{hv})(1-\\nu_{hh}^2)}{(1+\\nu_{hh})(1-\\nu_{hh}-2\\nu_{vh}\\nu_{hv})}\n$$\nUsing the identity $1-\\nu_{hh}^2 = (1-\\nu_{hh})(1+\\nu_{hh})$, we can simplify the expression for $R$:\n$$\nR = \\frac{(1 - \\nu_{vh}\\nu_{hv})(1-\\nu_{hh})}{1-\\nu_{hh}-2\\nu_{vh}\\nu_{hv}}\n$$\nNow, substitute the given numerical values:\n$E_{h} = 30\\,\\mathrm{GPa}$, $E_{v} = 12\\,\\mathrm{GPa}$, $\\nu_{hh} = 0.30$, $\\nu_{hv} = 0.12$.\n\nFirst, calculate the dependent Poisson's ratio $\\nu_{vh}$ using the reciprocity relation:\n$$\n\\nu_{vh} = \\frac{E_v}{E_h}\\nu_{hv} = \\frac{12}{30} \\times 0.12 = 0.4 \\times 0.12 = 0.048\n$$\nNext, calculate the product $\\nu_{vh}\\nu_{hv}$:\n$$\n\\nu_{vh}\\nu_{hv} = 0.048 \\times 0.12 = 0.00576\n$$\nNow, substitute these values into the expression for $R$:\n$$\nR = \\frac{(1 - 0.00576)(1 - 0.30)}{1 - 0.30 - 2(0.00576)} = \\frac{(0.99424)(0.7)}{0.7 - 0.01152} = \\frac{0.695968}{0.68848}\n$$\n$$\nR \\approx 1.010876\n$$\nRounding to four significant figures gives:\n$$\nR = 1.011\n$$\nThis result indicates that for the given material properties, the curvature prediction under the plane stress assumption is about $1.1\\%$ higher than under the plane strain assumption.",
            "answer": "$$\n\\boxed{1.011}\n$$"
        },
        {
            "introduction": "In real-world applications, especially in computational methods like the Finite Element Method (FEM), a material's symmetry axes rarely align with the global coordinate system. This practice guides you through the essential computational task of rotating the stiffness tensor of a transversely isotropic material from its principal orientation to an arbitrary global frame. By implementing the full tensor rotation and then extracting the plane strain constitutive matrix, you will develop a core skill for building robust numerical models of anisotropic materials. ",
            "id": "3568667",
            "problem": "You are asked to develop a complete, runnable program that computes the element-level constitutive matrix in global coordinates for a Transversely Isotropic (TI) material under plane strain. The material symmetry axis is arbitrarily oriented in three dimensions relative to the element, and the element has an in-plane orientation angle relative to the global axes. Starting only from the fundamental linear elasticity law, the coordinate transformation of tensors under rigid rotations, and the definition of plane strain, derive a computational procedure that produces the global plane-strain constitutive matrix $D$ for a set of test cases.\n\nThe fundamental base you must use is:\n- Linear elasticity in small strains: $\\,\\boldsymbol{\\sigma} = \\mathbb{C} : \\boldsymbol{\\varepsilon}\\,$ with second-order stress $\\boldsymbol{\\sigma}$, second-order strain $\\boldsymbol{\\varepsilon}$, and fourth-order stiffness tensor $\\mathbb{C}$.\n- Rigid rotation of tensors: if $\\mathbf{R}$ is an orthogonal rotation matrix ($\\mathbf{R}^\\top \\mathbf{R} = \\mathbf{I}$), then a fourth-order stiffness tensor transforms as $\\,\\mathbb{C}'_{ijkl} = R_{ip} R_{jq} R_{kr} R_{ls} \\,\\mathbb{C}_{pqrs}\\,$, and second-order tensors transform as $\\,\\boldsymbol{T}' = \\mathbf{R}\\,\\boldsymbol{T}\\,\\mathbf{R}^\\top\\,$.\n- Plane strain kinematics in the global frame: $\\,\\varepsilon_{zz} = \\varepsilon_{xz} = \\varepsilon_{yz} = 0\\,$ in global coordinates, while $\\,\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy}\\,$ may be nonzero.\n\nYou must construct the TI material in its principal material frame, where the axis of symmetry is the $3$-axis, using a physically consistent compliance description. Then:\n1. Convert the material compliance to stiffness in the material frame.\n2. Convert between the $6 \\times 6$ engineering-Voigt representation and the full fourth-order tensor consistently with engineering shear strain $\\,\\gamma_{ij} = 2 \\varepsilon_{ij}\\,$ and shear stress $\\,\\tau_{ij} = \\sigma_{ij}\\,$.\n3. Build an orthonormal triad that aligns the material $3$-axis with the given axis of symmetry in the element-local frame, and then rotate that local frame into the global frame by the element’s in-plane orientation angle.\n4. Rotate the fourth-order stiffness tensor from the material frame to the global frame using the rotation rule for fourth-order tensors.\n5. Extract the global plane-strain constitutive matrix $D$ as the $3 \\times 3$ block mapping $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$ to $[\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^\\top$ in the global frame.\n\nAll stiffness moduli must be expressed in gigapascals (GPa). All angles must be expressed in radians. The final output entries of $D$ must be in gigapascals (GPa). Round each reported entry to six decimal places.\n\nDefine the Transversely Isotropic (TI) material by five independent engineering constants in the principal material frame:\n- In-plane Young’s modulus $E_1$ with $E_1 = E_2$,\n- Out-of-plane Young’s modulus $E_3$,\n- In-plane Poisson’s ratio $\\nu_{12}$,\n- Out-of-plane Poisson’s ratio $\\nu_{13}$ with $\\nu_{13} = \\nu_{23}$,\n- Out-of-plane shear modulus $G_{13}$ with $G_{13} = G_{23}$,\nand with the in-plane shear modulus constrained by TI symmetry as $\\,G_{12} = \\dfrac{E_1}{2(1+\\nu_{12})}\\,$.\n\nUse the following test suite (all stiffness in gigapascals (GPa), angles in radians). For each case, the axis of symmetry in the element-local frame is parameterized by spherical angles $(\\alpha,\\beta)$ so that the unit vector is $\\,\\mathbf{a} = [\\sin\\beta\\cos\\alpha,\\,\\sin\\beta\\sin\\alpha,\\,\\cos\\beta]^\\top\\,$. The element-local frame is then rotated into the global frame by an in-plane angle $\\phi$ about the global $z$-axis.\n\n- Case $1$ (general orientation, happy path):\n  - $E_1 = 25$, $E_3 = 50$, $\\nu_{12} = 0.25$, $\\nu_{13} = 0.20$, $G_{13} = 9$, angles: $\\alpha = 1.0$, $\\beta = 0.4$, $\\phi = 0.3$.\n- Case $2$ (axis aligned with global $z$-axis, boundary check):\n  - $E_1 = 40$, $E_3 = 80$, $\\nu_{12} = 0.20$, $\\nu_{13} = 0.17$, $G_{13} = 15$, angles: $\\alpha = 0.0$, $\\beta = 0.0$, $\\phi = 0.0$.\n- Case $3$ (isotropy check, edge case):\n  - $E_1 = 30$, $E_3 = 30$, $\\nu_{12} = 0.25$, $\\nu_{13} = 0.25$, $G_{13} = 12$, angles: $\\alpha = 0.1$, $\\beta = 0.7$, $\\phi = 0.5$.\n\nYour program should produce a single line of output containing a list of length three. Each element of that list is a list of nine floats representing the $3 \\times 3$ global plane-strain constitutive matrix $D$ in row-major order for the corresponding test case, in gigapascals (GPa), rounded to six decimal places. The exact required format is:\n$[[d_{11},d_{12},d_{13},d_{21},d_{22},d_{23},d_{31},d_{32},d_{33}], [\\cdots], [\\cdots]]$.",
            "solution": "The computational procedure to determine the global plane-strain constitutive matrix $\\mathbf{D}$ for a transversely isotropic (TI) material involves four primary steps:\n$1$. Construction of the material stiffness tensor in its principal coordinate system.\n$2$. Determination of the rotation matrix that transforms the material frame to the global frame.\n$3$. Transformation of the stiffness tensor to the global coordinate system.\n$4$. Extraction of the plane strain constitutive matrix from the transformed global stiffness tensor.\n\nEach step is detailed below, adhering to the principles stipulated in the problem statement. All indices $i, j, k, l$ range from $1$ to $3$.\n\n### Step 1: Material Stiffness in the Principal Frame\n\nA transversely isotropic material is characterized by five independent elastic constants. The problem provides these as the in-plane Young's modulus $E_1$, the out-of-plane Young's modulus $E_3$, the in-plane Poisson's ratio $\\nu_{12}$, the out-of-plane Poisson's ratio $\\nu_{13}$, and the out-of-plane shear modulus $G_{13}$. The material exhibits a rotational symmetry about a specific axis, which we align with the $3$-axis in the principal material coordinate frame. The plane of isotropy is the $1$-$2$ plane.\n\nThe compliance matrix $\\mathbf{S}$ relates the strain vector $\\boldsymbol{\\varepsilon}$ to the stress vector $\\boldsymbol{\\sigma}$ in Voigt notation as $\\boldsymbol{\\varepsilon} = \\mathbf{S}\\boldsymbol{\\sigma}$. For a TI material with the $3$-axis as the symmetry axis, the compliance matrix $\\mathbf{S}$ in engineering notation (where $\\varepsilon_4=\\gamma_{23}$, etc.) is given by:\n$$\n\\mathbf{S} = \\begin{pmatrix}\n1/E_1 & -\\nu_{12}/E_1 & -\\nu_{13}/E_1 & 0 & 0 & 0 \\\\\n-\\nu_{12}/E_1 & 1/E_1 & -\\nu_{13}/E_1 & 0 & 0 & 0 \\\\\n-\\nu_{13}/E_1 & -\\nu_{13}/E_1 & 1/E_3 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1/G_{13} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1/G_{13} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 1/G_{12}\n\\end{pmatrix}\n$$\nThis form correctly incorporates the symmetries $E_1=E_2$, $\\nu_{13}=\\nu_{23}$, and $G_{13}=G_{23}$. The symmetry of the compliance matrix, a consequence of strain energy considerations, requires $S_{ij} = S_{ji}$. This implies $\\nu_{13}/E_1 = \\nu_{31}/E_3$, where $\\nu_{31}$ is the Poisson's ratio characterizing strain in the $1$-direction from stress in the $3$-direction. The in-plane shear modulus $G_{12}$ is constrained by the isotropy in the $1$-$2$ plane and is given by $G_{12} = \\frac{E_1}{2(1+\\nu_{12})}$.\n\nThe stiffness matrix in Voigt notation, $\\mathbf{C}$, is the inverse of the compliance matrix:\n$$\n\\mathbf{C} = \\mathbf{S}^{-1}\n$$\nThis $6 \\times 6$ matrix $\\mathbf{C}$ represents the material stiffness in the principal material frame.\n\nTo perform coordinate transformations correctly, we must convert this Voigt matrix $\\mathbf{C}$ into a fourth-order stiffness tensor $\\mathbb{C}$. The relation $\\sigma_{ij} = \\mathbb{C}_{ijkl}\\varepsilon_{kl}$ must be consistent with the Voigt form $\\boldsymbol{\\sigma} = \\mathbf{C}\\boldsymbol{\\varepsilon}$ using engineering strain $\\gamma_{ij} = 2\\varepsilon_{ij}$. This consistency leads to a direct mapping of indices. Let $\\alpha$ be the Voigt index for the pair $(i, j)$ and $\\beta$ for $(k, l)$ (e.g., $(1,1) \\to 1$, $(2,2) \\to 2$, ..., $(1,2) \\to 6$). Then, $\\mathbb{C}_{ijkl} = C_{\\alpha\\beta}$. For example, $\\mathbb{C}_{1111} = C_{11}$, $\\mathbb{C}_{1122} = C_{12}$, and $\\mathbb{C}_{1212} = C_{66}$.\n\n### Step 2: Coordinate System Rotations\n\nThe problem defines a sequence of two rotations to orient the material in the global frame:\n$1$. An orientation of the material's symmetry axis within an element-local frame.\n$2$. An in-plane rotation of the element-local frame into the global frame.\n\nLet the material, local, and global coordinate frames have orthonormal bases $\\{\\mathbf{e}_1^m, \\mathbf{e}_2^m, \\mathbf{e}_3^m\\}$, $\\{\\mathbf{e}_x^L, \\mathbf{e}_y^L, \\mathbf{e}_z^L\\}$, and $\\{\\mathbf{e}_X^G, \\mathbf{e}_Y^G, \\mathbf{e}_Z^G\\}$, respectively. The symmetry axis of the material is $\\mathbf{e}_3^m$.\n\nFirst, we define the rotation from the material frame to the element-local frame. The symmetry axis $\\mathbf{e}_3^m$ is aligned with a vector $\\mathbf{a}$ in the local frame, where $\\mathbf{a} = [\\sin\\beta\\cos\\alpha, \\sin\\beta\\sin\\alpha, \\cos\\beta]^\\top$. Let this be the third basis vector of the rotated material frame, $\\mathbf{v}_3 = \\mathbf{a}$. We construct an orthonormal, right-handed basis $(\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3)$ representing the material axes in the local frame. A robust method is to select an auxiliary vector $\\mathbf{u}$ not parallel to $\\mathbf{v}_3$, compute $\\mathbf{v}_1' = \\mathbf{u} \\times \\mathbf{v}_3$, and then $\\mathbf{v}_2' = \\mathbf{v}_3 \\times \\mathbf{v}_1'$. Normalizing these vectors gives $\\mathbf{v}_1$ and $\\mathbf{v}_2$. The rotation matrix $\\mathbf{R}_{m \\to L}$ has these vectors as its columns: $\\mathbf{R}_{m \\to L} = [\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3]$.\n\nSecond, the element-local frame is rotated by an angle $\\phi$ about the global $Z$-axis, $\\mathbf{e}_Z^G$, to align with the global frame. The rotation matrix is:\n$$\n\\mathbf{R}_{L \\to G} = \\begin{pmatrix}\n\\cos\\phi & -\\sin\\phi & 0 \\\\\n\\sin\\phi & \\cos\\phi & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nThe total rotation matrix $\\mathbf{R}$ that transforms vector components from the material frame to the global frame is the product of these two matrices:\n$$\n\\mathbf{R} = \\mathbf{R}_{L \\to G} \\mathbf{R}_{m \\to L}\n$$\n\n### Step 3: Transformation of the Stiffness Tensor\n\nA fourth-order tensor such as the stiffness tensor $\\mathbb{C}$ transforms under a rigid rotation defined by $\\mathbf{R}$ according to the following rule:\n$$\n\\mathbb{C}'_{ijkl} = R_{ip} R_{jq} R_{kr} R_{ls} \\mathbb{C}_{pqrs}\n$$\nHere, $\\mathbb{C}$ is the stiffness tensor in the material frame, and $\\mathbb{C}'$ is the transformed tensor in the global frame. The Einstein summation convention is used over indices $p, q, r, s$. This operation can be implemented efficiently using tensor contraction.\n\n### Step 4: Extraction of the Plane Strain Constitutive Matrix\n\nAfter rotating the tensor, we have the global stiffness tensor $\\mathbb{C}'$. This tensor relates the global stress components $\\sigma'_{ij}$ to the global strain components $\\varepsilon'_{kl}$: $\\sigma'_{ij} = \\mathbb{C}'_{ijkl}\\varepsilon'_{kl}$. For clarity, we drop the primes.\n\nThe condition of plane strain in the global frame is defined by setting certain strain components to zero:\n$$\n\\varepsilon_{zz} = 0, \\quad \\varepsilon_{xz} = 0, \\quad \\varepsilon_{yz} = 0\n$$\nIn engineering Voigt notation, where the strain vector is $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{zz}, \\gamma_{yz}, \\gamma_{xz}, \\gamma_{xy}]^\\top$, this corresponds to $\\varepsilon_3 = 0$, $\\varepsilon_4 = 0$, and $\\varepsilon_5 = 0$.\n\nThe full $3$D constitutive relation in the global frame is $\\boldsymbol{\\sigma} = \\mathbf{C}_{\\text{glob}} \\boldsymbol{\\varepsilon}$. By setting the out-of-plane strains to zero, we obtain the relation for in-plane stresses:\n$$\n\\begin{pmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{pmatrix} = \\begin{pmatrix}\n(C_{\\text{glob}})_{11} & (C_{\\text{glob}})_{12} & (C_{\\text{glob}})_{16} \\\\\n(C_{\\text{glob}})_{21} & (C_{\\text{glob}})_{22} & (C_{\\text{glob}})_{26} \\\\\n(C_{\\text{glob}})_{61} & (C_{\\text{glob}})_{62} & (C_{\\text{glob}})_{66}\n\\end{pmatrix} \\begin{pmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{pmatrix}\n$$\nThis defines the relationship between the in-plane stress vector and the in-plane engineering strain vector. The desired $3 \\times 3$ plane strain constitutive matrix $\\mathbf{D}$ is therefore the submatrix of the global $6 \\times 6$ stiffness matrix $\\mathbf{C}_{\\text{glob}}$ corresponding to the in-plane components. We obtain $\\mathbf{C}_{\\text{glob}}$ by converting the fourth-order tensor $\\mathbb{C}'$ back to Voigt notation, and then extract the required submatrix.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_voigt_stiffness_ti(E1, E3, nu12, nu13, G13):\n    \"\"\"\n    Computes the 6x6 stiffness matrix in Voigt notation for a\n    transversely isotropic material in its principal frame.\n    \"\"\"\n    G12 = E1 / (2 * (1 + nu12))\n    \n    S = np.zeros((6, 6))\n    \n    S[0, 0] = 1 / E1\n    S[1, 1] = 1 / E1\n    S[2, 2] = 1 / E3\n    \n    S[0, 1] = S[1, 0] = -nu12 / E1\n    S[0, 2] = S[2, 0] = -nu13 / E1\n    S[1, 2] = S[2, 1] = -nu13 / E1\n    \n    S[3, 3] = 1 / G13  # G23 = G13\n    S[4, 4] = 1 / G13  # G13\n    S[5, 5] = 1 / G12\n    \n    C = np.linalg.inv(S)\n    return C\n\ndef voigt_to_tensor(C_voigt):\n    \"\"\"\n    Converts a 6x6 stiffness matrix in Voigt notation (engineering strain)\n    to a 3x3x3x3 fourth-order stiffness tensor.\n    \"\"\"\n    C_tensor = np.zeros((3, 3, 3, 3))\n    voigt_map = [(0, 0), (1, 1), (2, 2), (1, 2), (0, 2), (0, 1)]\n    \n    for i in range(3):\n        for j in range(3):\n            for k in range(3):\n                for l in range(3):\n                    try:\n                        voigt_i = voigt_map.index(tuple(sorted((i, j))))\n                    except ValueError:\n                         voigt_i = voigt_map.index(tuple(sorted((j, i))))\n                    \n                    try:\n                        voigt_j = voigt_map.index(tuple(sorted((k, l))))\n                    except ValueError:\n                        voigt_j = voigt_map.index(tuple(sorted((l, k))))\n                    \n                    C_tensor[i, j, k, l] = C_voigt[voigt_i, voigt_j]\n    return C_tensor\n    \ndef tensor_to_voigt(C_tensor):\n    \"\"\"\n    Converts a 3x3x3x3 fourth-order stiffness tensor\n    to a 6x6 stiffness matrix in Voigt notation (engineering strain).\n    \"\"\"\n    C_voigt = np.zeros((6, 6))\n    voigt_map = [(0, 0), (1, 1), (2, 2), (1, 2), (0, 2), (0, 1)]\n    \n    for i in range(6):\n        for j in range(6):\n            i1, i2 = voigt_map[i]\n            j1, j2 = voigt_map[j]\n            C_voigt[i, j] = C_tensor[i1, i2, j1, j2]\n            \n    return C_voigt\n\ndef get_total_rotation_matrix(alpha, beta, phi):\n    \"\"\"\n    Computes the total rotation matrix from the material frame to the global frame.\n    \"\"\"\n    # Rotation from material frame to element-local frame\n    cos_a, sin_a = np.cos(alpha), np.sin(alpha)\n    cos_b, sin_b = np.cos(beta), np.sin(beta)\n    \n    v3 = np.array([sin_b * cos_a, sin_b * sin_a, cos_b])\n    \n    # Construct an orthonormal basis (v1, v2, v3)\n    # Pick an auxiliary vector 'up' not parallel to v3\n    if abs(v3[2]) < 0.99999999: # not close to Z-axis pole\n        up = np.array([0.0, 0.0, 1.0])\n    else: # close to Z-axis pole, use X-axis\n        up = np.array([1.0, 0.0, 0.0])\n        \n    v1 = np.cross(up, v3)\n    v1 /= np.linalg.norm(v1)\n    \n    v2 = np.cross(v3, v1)\n    # v2 is already normalized since v3 and v1 are unit and orthogonal\n    \n    R_ml = np.array([v1, v2, v3]).T\n    \n    # Rotation from element-local frame to global frame\n    cos_p, sin_p = np.cos(phi), np.sin(phi)\n    R_lg = np.array([[cos_p, -sin_p, 0.0],\n                     [sin_p, cos_p, 0.0],\n                     [0.0,   0.0,   1.0]])\n                     \n    # Total rotation matrix\n    R_total = R_lg @ R_ml\n    return R_total\n\ndef calculate_plane_strain_matrix(params):\n    \"\"\"\n    Main computational procedure for a single test case.\n    \"\"\"\n    E1, E3, nu12, nu13, G13, alpha, beta, phi = params\n    \n    # 1. Get stiffness matrix in material frame\n    C_mat_voigt = get_voigt_stiffness_ti(E1, E3, nu12, nu13, G13)\n    \n    # In case of isotropy, the tensor is invariant to rotation. We can check the result.\n    if E1 == E3 and nu12 == nu13:\n        E_iso = E1\n        nu_iso = nu12\n        G_iso = E_iso / (2 * (1 + nu_iso))\n        if np.isclose(G13, G_iso):\n            # For isotropic material, D is known and independent of rotation\n            factor = E_iso / ((1 + nu_iso) * (1 - 2 * nu_iso))\n            D_iso = np.array([[1 - nu_iso, nu_iso, 0],\n                              [nu_iso, 1 - nu_iso, 0],\n                              [0, 0, (1 - 2 * nu_iso) / 2]]) * factor\n            return np.round(D_iso.flatten(), 6).tolist()\n\n    # 2. Convert Voigt matrix to 4th-order tensor\n    C_mat_tensor = voigt_to_tensor(C_mat_voigt)\n    \n    # 3. Get total rotation matrix\n    R = get_total_rotation_matrix(alpha, beta, phi)\n    \n    # 4. Rotate stiffness tensor to global frame\n    C_glob_tensor = np.einsum('ip,jq,kr,ls,pqrs->ijkl', R, R, R, R, C_mat_tensor)\n    \n    # 5. Convert global tensor back to Voigt matrix\n    C_glob_voigt = tensor_to_voigt(C_glob_tensor)\n    \n    # 6. Extract 3x3 plane strain matrix D\n    indices = np.array([0, 1, 5]) # Corresponds to xx, yy, xy components\n    D = C_glob_voigt[np.ix_(indices, indices)]\n    \n    # 7. Flatten and round\n    return np.round(D.flatten(), 6).tolist()\n\ndef solve():\n    \"\"\"\n    Defines test cases, solves them, and prints the formatted output.\n    \"\"\"\n    test_cases = [\n        # Case 1: general orientation\n        (25.0, 50.0, 0.25, 0.20, 9.0, 1.0, 0.4, 0.3),\n        # Case 2: axis aligned with global z-axis\n        (40.0, 80.0, 0.20, 0.17, 15.0, 0.0, 0.0, 0.0),\n        # Case 3: isotropy check\n        (30.0, 30.0, 0.25, 0.25, 12.0, 0.1, 0.7, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        D_flat = calculate_plane_strain_matrix(case)\n        results.append(D_flat)\n        \n    # Format the output string as per requirements\n    output_str_parts = []\n    for res_list in results:\n        res_str = f\"[{','.join(f'{x:.6f}' for x in res_list)}]\"\n        output_str_parts.append(res_str)\n        \n    final_output = f\"[{','.join(output_str_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}