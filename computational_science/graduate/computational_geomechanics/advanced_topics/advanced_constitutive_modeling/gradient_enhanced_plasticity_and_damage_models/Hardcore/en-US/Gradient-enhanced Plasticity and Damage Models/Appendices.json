{
    "hands_on_practices": [
        {
            "introduction": "A key motivation for gradient-enhanced models is their ability to regularize the physically unrealistic, mesh-dependent localization of strain or damage that occurs in standard softening continuum models. This first practice provides a crucial analytical insight into this regularization mechanism. By deriving the damage profile for a one-dimensional bar, you will establish a direct, closed-form relationship between the model's internal length scale, $\\ell$, and the physical width of the localization zone, making the abstract concept of regularization concrete .",
            "id": "3528898",
            "problem": "Consider a one-dimensional uniaxial bar occupying the interval $x \\in \\left[-\\frac{L}{2}, \\frac{L}{2}\\right]$, subject to small strains and a prescribed end-to-end displacement producing a nominal tensile strain that is spatially uniform in the far field. The bar is modeled by a phase-field damage formulation of the Ambrosio-Tortorelli type 2 (AT2), in which the displacement field is $u(x)$, the scalar damage field is $\\alpha(x) \\in [0,1]$, the Young’s modulus is $E$, and the critical energy release rate is $G_c$. Assume pure tension and ignore residual stiffness regularization. The total energy functional is\n$$\n\\Pi[u,\\alpha] \\;=\\; \\int_{-L/2}^{L/2} \\left[ g(\\alpha)\\,\\psi_e(\\varepsilon) \\;+\\; G_c\\left(\\frac{\\alpha^2}{2\\,l} \\;+\\; \\frac{l}{2}\\,(\\alpha')^2\\right) \\right] \\,\\mathrm{d}x,\n$$\nwith degradation function $g(\\alpha)=(1-\\alpha)^2$, elastic energy density $\\psi_e(\\varepsilon) = \\tfrac{1}{2} E\\,\\varepsilon^2$, strain $\\varepsilon(x)=u'(x)$, and internal length scale $l>0$. Assume $L \\gg l$ so that the damage zone is well separated from the boundaries, and that at the peak load the damage localizes around $x=0$ while the far field remains essentially elastic with a nearly uniform tensile strain.\n\nStarting from the minimum potential energy principle and the associated Euler–Lagrange equations together with the rate-independent damage irreversibility conditions, derive, in the neighborhood of the peak load and under the assumption of small but nonzero peak-load damage in the far field, the leading-order one-dimensional damage profile $\\alpha(x)$ in closed form. Then define the localization width $w$ as the full width at half maximum (FWHM) of the excess damage over its far-field value, namely for $\\beta(x) \\equiv \\alpha(x)-\\alpha_{\\infty}$ with $\\alpha_{\\infty} \\equiv \\lim_{|x|\\to\\infty} \\alpha(x)$, let $w$ be such that $\\beta\\!\\left(\\tfrac{w}{2}\\right) = \\tfrac{1}{2}\\,\\beta(0)$. Use this definition to express $w$ explicitly and discuss how it depends on $l$ and $E$.\n\nAnswer specification:\n- Provide the full derivation of $\\alpha(x)$ and the reasoning leading to $w$.\n- Report the final answer as the closed-form analytic expression for $w$ in terms of $l$ and $E$. Do not insert numerical values. Do not include units in the final boxed answer. Explain in the solution whether and how $w$ depends on $E$.",
            "solution": "The problem asks for the derivation of the damage profile and the localization width for a one-dimensional bar described by an Ambrosio-Tortorelli (AT2) phase-field damage model.\n\nFirst, we must validate the problem statement.\nThe givens are:\n- The domain is a 1D bar, $x \\in [-L/2, L/2]$.\n- The state variables are the displacement field $u(x)$ and the damage field $\\alpha(x) \\in [0,1]$.\n- Physical constants are Young's modulus $E$ and critical energy release rate $G_c$.\n- The total energy functional is $\\Pi[u,\\alpha] = \\int_{-L/2}^{L/2} \\left[ g(\\alpha)\\,\\psi_e(\\varepsilon) + G_c\\left(\\frac{\\alpha^2}{2\\,l} + \\frac{l}{2}\\,(\\alpha')^2\\right) \\right] \\,\\mathrm{d}x$.\n- Constitutive functions and definitions are: degradation function $g(\\alpha)=(1-\\alpha)^2$, elastic energy density $\\psi_e(\\varepsilon) = \\frac{1}{2} E\\,\\varepsilon^2$, strain $\\varepsilon(x)=u'(x)$, and internal length scale $l0$.\n- Assumptions include $L \\gg l$, localization at $x=0$, and \"small but nonzero peak-load damage in the far field\", denoted $\\alpha_{\\infty}$.\n\nThe problem is scientifically grounded, using a standard formulation from computational mechanics. It is largely well-posed and objective. However, there is a subtle contradiction. For the specified AT2 model, the peak load condition (bifurcation from a homogeneous state) occurs at a far-field damage value of $\\alpha_{\\infty} = 1/4$, which is not a small value. The problem's assumption of \"small but nonzero peak-load damage in the far field\" is thus in direct conflict with the properties of the model at the peak load. To proceed, we must interpret this as an instruction to find a \"leading-order\" solution, which corresponds to the limit of small far-field damage ($\\alpha_{\\infty} \\to 0$). This is the only path that yields a closed-form analytical solution as requested. Under this interpretation, the problem is deemed valid.\n\nThe equilibrium state of the bar is found by minimizing the total potential energy $\\Pi[u,\\alpha]$. The Euler-Lagrange equations associated with the variations of $\\Pi$ with respect to $u$ and $\\alpha$ provide the governing equations. The integrand of the functional is $\\mathcal{L}(\\alpha, \\alpha', \\varepsilon) = (1-\\alpha)^2 \\frac{1}{2} E \\varepsilon^2 + G_c \\frac{\\alpha^2}{2l} + G_c \\frac{l}{2} (\\alpha')^2$.\n\n1.  **Equilibrium Equation (from $\\delta_u \\Pi$):**\n    The Euler-Lagrange equation for the displacement field $u(x)$ is $\\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\varepsilon}\\right) - \\frac{\\partial \\mathcal{L}}{\\partial u} = 0$. Since $\\mathcal{L}$ does not explicitly depend on $u$, this simplifies to $\\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\varepsilon}\\right) = 0$.\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial \\varepsilon} = (1-\\alpha)^2 E \\varepsilon = \\sigma\n    $$\n    This is the constitutive relation for the stress $\\sigma$. The equilibrium equation is thus $\\sigma'(x) = 0$, which implies that the stress $\\sigma$ must be uniform throughout the bar. Let's denote this constant stress by $\\sigma_0$.\n\n2.  **Damage Evolution Equation (from $\\delta_\\alpha \\Pi$):**\n    The Euler-Lagrange equation for the damage field $\\alpha(x)$ is $\\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\alpha'}\\right) - \\frac{\\partial \\mathcal{L}}{\\partial \\alpha} = 0$.\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial \\alpha'} = G_c l \\alpha'\n    $$\n    $$\n    \\frac{\\partial \\mathcal{L}}{\\partial \\alpha} = 2(1-\\alpha)(-1)\\frac{1}{2}E\\varepsilon^2 + G_c\\frac{\\alpha}{l} = -(1-\\alpha)E\\varepsilon^2 + G_c\\frac{\\alpha}{l}\n    $$\n    The governing equation for damage, respecting the irreversibility condition ($\\dot{\\alpha} \\geq 0$), is:\n    $$\n    G_c l \\alpha'' - G_c\\frac{\\alpha}{l} + (1-\\alpha)E\\varepsilon^2 = 0\n    $$\n    From the equilibrium equation, we have $\\varepsilon(x) = \\frac{\\sigma_0}{E(1-\\alpha(x))^2}$. Substituting this into the damage equation gives a nonlinear ordinary differential equation (ODE) for $\\alpha(x)$:\n    $$\n    G_c l \\alpha'' - G_c\\frac{\\alpha}{l} + (1-\\alpha)E\\left(\\frac{\\sigma_0}{E(1-\\alpha)^2}\\right)^2 = 0\n    \\implies G_c l \\alpha'' - G_c\\frac{\\alpha}{l} + \\frac{\\sigma_0^2}{E(1-\\alpha)^3} = 0\n    $$\n\n3.  **First Integral of the Equation:**\n    This is an autonomous ODE. We can find a first integral by multiplying by $\\alpha'$ and integrating with respect to $x$. A more direct energy-based argument leads to the same result. The first integral is:\n    $$\n    \\frac{1}{2} G_c l (\\alpha')^2 - \\frac{1}{2} G_c \\frac{\\alpha^2}{l} - \\frac{\\sigma_0^2}{2E(1-\\alpha)^2} = \\text{constant}\n    $$\n    We evaluate the constant using the far-field boundary conditions: as $|x| \\to \\infty$, $\\alpha \\to \\alpha_{\\infty}$ and $\\alpha' \\to 0$.\n    $$\n    \\text{constant} = -\\frac{1}{2} G_c \\frac{\\alpha_{\\infty}^2}{l} - \\frac{\\sigma_0^2}{2E(1-\\alpha_{\\infty})^2}\n    $$\n    Substituting this back and simplifying, we get:\n    $$\n    G_c l (\\alpha')^2 = G_c\\frac{\\alpha^2 - \\alpha_{\\infty}^2}{l} + \\frac{\\sigma_0^2}{E}\\left(\\frac{1}{(1-\\alpha)^2} - \\frac{1}{(1-\\alpha_{\\infty})^2}\\right)\n    $$\n    In the far field, the damage evolution equation must also hold for a uniform state ($\\alpha''=0$), giving a relationship between $\\sigma_0$ and $\\alpha_{\\infty}$: $G_c \\frac{\\alpha_{\\infty}}{l} = \\frac{\\sigma_0^2}{E(1-\\alpha_{\\infty})^3}$, so $\\sigma_0^2 = \\frac{E G_c \\alpha_{\\infty} (1-\\alpha_{\\infty})^3}{l}$.\n    Substituting $\\sigma_0^2$ into the first integral equation yields:\n    $$\n    l^2 (\\alpha')^2 = (\\alpha^2 - \\alpha_{\\infty}^2) - \\alpha_{\\infty}(1-\\alpha_{\\infty})^3 \\left(\\frac{1}{(1-\\alpha)^2} - \\frac{1}{(1-\\alpha_{\\infty})^2}\\right)\n    $$\n\n4.  **Leading-Order Approximation of the Damage Profile:**\n    To find the leading-order profile, we analyze the behavior for damage $\\alpha(x)$ close to its far-field value $\\alpha_{\\infty}$. Let $\\alpha(x) = \\alpha_{\\infty} + \\beta(x)$, where $\\beta(x)$ is small. We expand the right-hand side (RHS) of the equation for $(\\alpha')^2$ in powers of $\\beta$.\n    Let $F(\\alpha) = \\text{RHS}$. We perform a Taylor expansion of $F(\\alpha)$ around $\\alpha=\\alpha_{\\infty}$: $F(\\alpha) = F(\\alpha_{\\infty}) + F'(\\alpha_{\\infty})\\beta + \\frac{1}{2}F''(\\alpha_{\\infty})\\beta^2 + O(\\beta^3)$.\n    - $F(\\alpha_{\\infty})=0$ by construction.\n    - $F'(\\alpha) = 2\\alpha - 2\\alpha_{\\infty}(1-\\alpha_{\\infty})^3(1-\\alpha)^{-3}$. Thus, $F'(\\alpha_{\\infty}) = 2\\alpha_{\\infty} - 2\\alpha_{\\infty}(1-\\alpha_{\\infty})^3(1-\\alpha_{\\infty})^{-3} = 0$.\n    - $F''(\\alpha) = 2 - 6\\alpha_{\\infty}(1-\\alpha_{\\infty})^3(1-\\alpha)^{-4}$. Thus, $F''(\\alpha_{\\infty}) = 2 - 6\\alpha_{\\infty}(1-\\alpha_{\\infty})^{-1} = 2\\frac{1-4\\alpha_{\\infty}}{1-\\alpha_{\\infty}}$.\n    So, for small $\\beta$, we have $(\\beta')^2 = l^{-2} (\\frac{1}{2}F''(\\alpha_{\\infty})\\beta^2) = l^{-2} \\left(\\frac{1-4\\alpha_{\\infty}}{1-\\alpha_{\\infty}}\\right)\\beta^2$.\n    The ODE is $\\beta' = \\pm \\frac{1}{l}\\sqrt{\\frac{1-4\\alpha_{\\infty}}{1-\\alpha_{\\infty}}} \\beta$.\n    As noted during validation, the problem statement requires assuming \"small... far-field damage\", which we interpret as taking the limit $\\alpha_{\\infty} \\to 0$. In this limit, the term $\\sqrt{\\frac{1-4\\alpha_{\\infty}}{1-\\alpha_{\\infty}}} \\to 1$.\n    The leading-order equation for the excess damage $\\beta(x)$ becomes:\n    $$\n    \\beta' = \\pm \\frac{1}{l} \\beta\n    $$\n    The solution that decays to zero as $|x| \\to \\infty$ is an exponential function:\n    $$\n    \\beta(x) = \\beta(0) \\exp\\left(-\\frac{|x|}{l}\\right)\n    $$\n    Here $\\beta(0) = \\alpha(0) - \\alpha_{\\infty}$ is the peak excess damage at the center of the bar. The full leading-order damage profile is thus $\\alpha(x) = \\alpha_{\\infty} + (\\alpha(0) - \\alpha_{\\infty})\\exp(-|x|/l)$.\n\n5.  **Calculation of the Localization Width $w$:**\n    The localization width $w$ is defined as the full width at half maximum (FWHM) of the excess damage profile $\\beta(x)$. This requires finding the width $w$ such that $\\beta(w/2) = \\frac{1}{2}\\beta(0)$.\n    $$\n    \\beta(0) \\exp\\left(-\\frac{w/2}{l}\\right) = \\frac{1}{2}\\beta(0)\n    $$\n    Assuming non-trivial localization ($\\beta(0) \\neq 0$), we can divide by $\\beta(0)$:\n    $$\n    \\exp\\left(-\\frac{w}{2l}\\right) = \\frac{1}{2}\n    $$\n    Taking the natural logarithm of both sides:\n    $$\n    -\\frac{w}{2l} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n    $$\n    Solving for $w$, we find:\n    $$\n    w = 2l\\ln(2)\n    $$\n    This expression provides the localization width in terms of the internal length scale $l$.\n\n6.  **Dependence on $l$ and $E$:**\n    The derived localization width $w$ is directly proportional to the internal length scale $l$. It is, to this leading order of approximation, completely independent of the Young's modulus $E$. The physical reason is that the shape of the damage profile in the localized zone is determined by the balance between the local energy storage term $G_c \\alpha^2/(2l)$ and the gradient energy term $G_c l (\\alpha')^2/2$. Both terms are part of the fracture energy penalization and are independent of the material's elasticity $E$. The elastic properties, through $E$, influence the magnitude of the stress $\\sigma_0$ and the damage values $\\alpha_{\\infty}$ and $\\alpha(0)$, but they do not affect the characteristic length of the spatial damage variation in this leading-order analysis.",
            "answer": "$$\n\\boxed{2l\\ln(2)}\n$$"
        },
        {
            "introduction": "Having understood the conceptual role of the internal length scale, we now turn to the practical matter of numerical implementation. This exercise guides you through the foundational steps of creating a finite element model for gradient-enhanced plasticity, starting from a potential energy functional . You will derive the coupled weak form and the corresponding element tangent matrix, which are the essential building blocks for developing a robust computational code to solve these advanced models.",
            "id": "3528869",
            "problem": "Consider a straight, prismatic, one-dimensional bar of length $L$ and constant cross-sectional area $A$, modeled with an energetic gradient-enhanced plasticity formulation in small strain. The total strain is given by $\\varepsilon = u'$, where $u$ is the displacement field, and the internal scalar field $\\kappa$ represents an equivalent plastic strain-like variable. The Helmholtz free energy per unit reference length is assumed to be quadratic and given by\n$$\n\\psi(u,\\kappa) = \\tfrac{1}{2} E A \\left(u' - \\kappa\\right)^2 + \\tfrac{1}{2} A H \\kappa^2 + \\tfrac{1}{2} A \\ell^2 \\left(\\kappa'\\right)^2,\n$$\nwhere $E$ is the Young's modulus, $H$ is a constant energetic hardening/softening modulus (which may be negative in softening but such that $E+H$ remains positive to ensure stability of the internal variable), and $\\ell$ is a material length scale. Neglect external body forces and tractions so that only the internal energy contributes to the incremental potential. Assume quasi-static conditions with no inertia.\n\nTask A (derivation): Starting from the stationary condition of the total potential energy (first variation equal to zero), derive the coupled weak form for the unknown fields $u$ and $\\kappa$ using the Galerkin method with equal-order interpolation. Both $u$ and $\\kappa$ are discretized with the same linear Lagrange shape functions over two-node elements on a uniform mesh. Use isoparametric mapping in the physical coordinate $x$ so that derivatives are taken with respect to $x$.\n\nTask B (discretization): From the weak form, write down the consistent element-level tangent submatrices for a two-node element of length $h$ using linear shape functions for both $u$ and $\\kappa$. Clearly identify the blocks that couple $u$ and $\\kappa$.\n\nTask C (implementation and symmetry demonstration): Implement a program that:\n- Assembles the global tangent matrix for a uniform mesh with $n$ elements, using the element matrices from Task B.\n- Orders the global degrees of freedom as $[u_0, u_1, \\dots, u_n, \\kappa_0, \\kappa_1, \\dots, \\kappa_n]$.\n- Enforces the essential boundary condition $u(0)=0$ by symmetric row-and-column elimination to preserve symmetry on the reduced system. Do not prescribe any essential boundary condition on $\\kappa$.\n- Computes a symmetry indicator defined as the normalized Frobenius norm\n$$\n\\eta = \\frac{\\left\\|K - K^\\top\\right\\|_F}{\\max\\left(1, \\left\\|K\\right\\|_F\\right)},\n$$\nwhere $K$ is the reduced global tangent matrix after applying essential boundary conditions, and $\\|\\cdot\\|_F$ denotes the Frobenius norm. The symmetry indicator $\\eta$ is dimensionless and equals zero for an exactly symmetric matrix (up to roundoff).\n\nScientific base and modeling assumptions to use:\n- Small-strain kinematics and the principle of minimum potential energy applied to the stated Helmholtz free energy.\n- Standard two-node linear Lagrange shape functions on each element for both $u$ and $\\kappa$.\n- Uniform mesh with element length $h = L/n$.\n- Galerkin finite element discretization and consistent linearization to form the global tangent.\n\nTest suite:\nCompute the symmetry indicator $\\eta$ for each of the following parameter sets $(L, n, E, A, H, \\ell)$:\n- Case $1$: $(1.0, 4, 30\\times 10^9, 0.01, 5\\times 10^9, 0.05)$.\n- Case $2$: $(1.0, 4, 30\\times 10^9, 0.01, 0.0, 0.05)$.\n- Case $3$: $(1.0, 4, 30\\times 10^9, 0.01, 5\\times 10^9, 0.0)$.\n- Case $4$: $(1.0, 1, 210\\times 10^9, 0.02, 10\\times 10^9, 0.1)$.\n- Case $5$: $(1.5, 3, 25\\times 10^9, 0.015, -2\\times 10^9, 0.08)$.\n\nAll quantities are in the International System of Units: $L$ and $\\ell$ in meters, $E$ and $H$ in pascals, $A$ in square meters. The output $\\eta$ is a dimensionless real number. Your program must compute the list $[\\eta_1, \\eta_2, \\eta_3, \\eta_4, \\eta_5]$ corresponding to the five cases.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $r_i$ is the floating-point value of $\\eta$ for case $i$.",
            "solution": "The problem requires the derivation, discretization, and implementation of a gradient-enhanced plasticity model for a one-dimensional bar to verify the symmetry of the resulting tangent stiffness matrix. The solution is presented in three parts, following the tasks specified.\n\n### Task A: Derivation of the Coupled Weak Form\n\nThe starting point is the principle of minimum potential energy, which states that for a system in stable equilibrium, the total potential energy is stationary. For this quasi-static problem with no external forces, the total potential energy $\\Pi$ is the integral of the Helmholtz free energy density $\\psi$ over the domain of the bar, from $x=0$ to $x=L$.\n\nThe given Helmholtz free energy per unit reference length is:\n$$\n\\psi(u', \\kappa, \\kappa') = \\tfrac{1}{2} E A (u' - \\kappa)^2 + \\tfrac{1}{2} A H \\kappa^2 + \\tfrac{1}{2} A \\ell^2 (\\kappa')^2\n$$\nThe total potential energy is:\n$$\n\\Pi[u, \\kappa] = \\int_0^L \\psi(u', \\kappa, \\kappa') dx = \\int_0^L \\left[ \\tfrac{1}{2} E A (u' - \\kappa)^2 + \\tfrac{1}{2} A H \\kappa^2 + \\tfrac{1}{2} A \\ell^2 (\\kappa')^2 \\right] dx\n$$\nThe stationary condition requires that the first variation of $\\Pi$ with respect to the independent fields $u$ and $\\kappa$ vanishes for all admissible variations $\\delta u$ and $\\delta \\kappa$. An admissible variation is one that is kinematically compatible with the constraints; here, the essential boundary condition $u(0)=0$ implies that the corresponding variation must satisfy $\\delta u(0)=0$.\n\nThe first variation (or Gâteaux derivative) is:\n$$\n\\delta \\Pi = \\int_0^L \\left[ \\frac{\\partial \\psi}{\\partial u'} \\delta(u') + \\frac{\\partial \\psi}{\\partial \\kappa} \\delta \\kappa + \\frac{\\partial \\psi}{\\partial \\kappa'} \\delta(\\kappa') \\right] dx = 0\n$$\nSince variation and differentiation are linear operators, we have $\\delta(u') = (\\delta u)'$ and $\\delta(\\kappa') = (\\delta \\kappa)'$. The partial derivatives of $\\psi$ are:\n$$\n\\frac{\\partial \\psi}{\\partial u'} = E A (u' - \\kappa)\n$$\n$$\n\\frac{\\partial \\psi}{\\partial \\kappa} = -E A (u' - \\kappa) + A H \\kappa\n$$\n$$\n\\frac{\\partial \\psi}{\\partial \\kappa'} = A \\ell^2 \\kappa'\n$$\nSubstituting these into the variational statement gives:\n$$\n\\delta \\Pi = \\int_0^L \\left[ E A (u' - \\kappa) (\\delta u)' + (-E A (u' - \\kappa) + A H \\kappa) \\delta \\kappa + (A \\ell^2 \\kappa') (\\delta \\kappa)' \\right] dx = 0\n$$\nIn the Galerkin method, the variations $\\delta u$ and $\\delta \\kappa$ are replaced by arbitrary weighting functions, $w_u$ and $w_\\kappa$, from the same function space as $u$ and $\\kappa$. Since this equation must hold for any choice of $w_u$ and $w_\\kappa$, we can separate it into two independent equations. This constitutes the coupled weak form of the problem.\n\nThe first equation, governing the mechanical equilibrium (associated with $u$):\n$$\nG_u(u, \\kappa; w_u) = \\int_0^L E A (u' - \\kappa) w_u' \\,dx = 0 \\quad \\forall w_u \\text{ with } w_u(0)=0\n$$\nThe second equation, governing the evolution of the internal variable (associated with $\\kappa$):\n$$\nG_\\kappa(u, \\kappa; w_\\kappa) = \\int_0^L \\left[ -E A (u' - \\kappa) w_\\kappa + A H \\kappa w_\\kappa + A \\ell^2 \\kappa' w_\\kappa' \\right] dx = 0 \\quad \\forall w_\\kappa\n$$\nThese two integral equations form the coupled weak form. They must be solved simultaneously for the displacement field $u(x)$ and the internal variable field $\\kappa(x)$.\n\n### Task B: Element-Level Tangent Submatrices\n\nTo solve the weak form numerically, we employ the finite element method. We discretize the domain $L$ into $n$ two-node linear elements, each of length $h = L/n$. Within each element, the unknown fields $u$ and $\\kappa$ are approximated using linear Lagrange shape functions $\\mathbf{N} = [N_1, N_2]$:\n$$\nu^h(x) = \\mathbf{N}(x) \\mathbf{u}_e, \\quad \\kappa^h(x) = \\mathbf{N}(x) \\boldsymbol{\\kappa}_e\n$$\nwhere $\\mathbf{u}_e = [u_1, u_2]^\\top$ and $\\boldsymbol{\\kappa}_e = [\\kappa_1, \\kappa_2]^\\top$ are the nodal values for the element. The derivatives are approximated as:\n$$\n(u^h)'(x) = \\mathbf{B}(x) \\mathbf{u}_e, \\quad (\\kappa^h)'(x) = \\mathbf{B}(x) \\boldsymbol{\\kappa}_e\n$$\nwhere $\\mathbf{B} = d\\mathbf{N}/dx$. For a linear element of length $h$, the shape function derivatives are constant: $\\mathbf{B} = [-1/h, 1/h]$. The test functions are discretized identically.\n\nSince the governing weak form equations are linear in $u$ and $\\kappa$, their discretization leads to a system of linear algebraic equations $\\mathbf{K}_{global} \\mathbf{d} = \\mathbf{f}$. The matrix $\\mathbf{K}_{global}$ is the global tangent stiffness matrix. We derive it by first finding the element tangent matrix $\\mathbf{K}_e$. The tangent is the derivative of the residual vector with respect to the nodal degrees of freedom. For this linear problem, this is equivalent to substituting the finite element approximations into the bilinear form underlying the weak form. The element tangent matrix is a $4 \\times 4$ matrix composed of four $2 \\times 2$ submatrices:\n$$\n\\mathbf{K}_e = \\begin{pmatrix} \\mathbf{K}_{e,uu}  \\mathbf{K}_{e,u\\kappa} \\\\ \\mathbf{K}_{e,\\kappa u}  \\mathbf{K}_{e,\\kappa\\kappa} \\end{pmatrix}\n$$\nThese submatrices are derived by integrating the corresponding terms from the weak form over the element length $h$:\n$$\n\\mathbf{K}_{e,uu} = E A \\int_0^h \\mathbf{B}^\\top \\mathbf{B} \\,dx = E A \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{e,u\\kappa} = -E A \\int_0^h \\mathbf{B}^\\top \\mathbf{N} \\,dx = -E A \\begin{pmatrix} -1/2  -1/2 \\\\ 1/2  1/2 \\end{pmatrix} = E A \\begin{pmatrix} 1/2  1/2 \\\\ -1/2  -1/2 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{e,\\kappa u} = -E A \\int_0^h \\mathbf{N}^\\top \\mathbf{B} \\,dx = -E A \\begin{pmatrix} -1/2  1/2 \\\\ -1/2  1/2 \\end{pmatrix} = E A \\begin{pmatrix} 1/2  -1/2 \\\\ 1/2  -1/2 \\end{pmatrix}\n$$\n$$\n\\mathbf{K}_{e,\\kappa\\kappa} = (E+H) A \\int_0^h \\mathbf{N}^\\top \\mathbf{N} \\,dx + A \\ell^2 \\int_0^h \\mathbf{B}^\\top \\mathbf{B} \\,dx = (E+H) A \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} + A \\ell^2 \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\nThe integrals $\\int \\mathbf{N}^\\top\\mathbf{N}\\,dx$ and $\\int \\mathbf{B}^\\top\\mathbf{N}\\,dx$ are standard results for linear finite elements. The matrices $\\mathbf{K}_{e,u\\kappa}$ and $\\mathbf{K}_{e,\\kappa u}$ are the coupling blocks. As expected from a potential-based formulation, the element tangent matrix is symmetric, since $\\mathbf{K}_{e,\\kappa u} = \\mathbf{K}_{e,u\\kappa}^\\top$.\n\n### Task C: Implementation and Symmetry Demonstration\n\nThe implementation involves assembling the global tangent matrix from the element matrices and then computing a symmetry indicator.\n\n1.  **Assembly**: We initialize a global tangent matrix $\\mathbf{K}_{global}$ of size $(2(n+1) \\times 2(n+1))$ with zeros. We then iterate through each of the $n$ elements. For each element $i$ (connecting nodes $i$ and $i+1$), we compute its $4 \\times 4$ element tangent matrix $\\mathbf{K}_e$. The entries of $\\mathbf{K}_e$ are then added to the corresponding positions in $\\mathbf{K}_{global}$. The mapping from local to global degrees of freedom respects the specified ordering $[u_0, \\dots, u_n, \\kappa_0, \\dots, \\kappa_n]$. For element $i$, the nodal degrees of freedom map to global indices as follows: $u_i \\rightarrow i$, $u_{i+1} \\rightarrow i+1$, $\\kappa_i \\rightarrow (n+1)+i$, and $\\kappa_{i+1} \\rightarrow (n+1)+i+1$. This standard assembly procedure, known as the direct stiffness method, constructs the full global matrix.\n\n2.  **Boundary Conditions**: The essential boundary condition $u(0)=0$ fixes the degree of freedom $u_0$, which corresponds to index $0$ in our global system. To obtain the reduced system for the unknown DOFs, we apply symmetric elimination. This involves removing the row and column corresponding to the constrained DOF from the global matrix. The resulting reduced matrix, $K$, will be of size $(2n+1) \\times (2n+1)$. This operation preserves the symmetry of the original matrix.\n\n3.  **Symmetry Indicator**: Finally, to numerically verify the symmetry of the reduced matrix $K$, we compute the symmetry indicator $\\eta$:\n    $$\n    \\eta = \\frac{\\left\\|K - K^\\top\\right\\|_F}{\\max\\left(1, \\left\\|K\\right\\|_F\\right)}\n    $$\n    where $\\|\\cdot\\|_F$ is the Frobenius norm. The term $\\|K - K^\\top\\|_F$ will be zero if $K$ is perfectly symmetric. Due to finite-precision floating-point arithmetic, this norm will be a very small number close to machine epsilon. The normalization by $\\|K\\|_F$ makes the indicator dimensionless and robust to the magnitude of the matrix entries. For a correctly implemented symmetric formulation, $\\eta$ should be effectively zero for all test cases. The provided program implements this entire procedure.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_element_matrix(h, E, A, H, l):\n    \"\"\"\n    Computes the 4x4 element tangent matrix for a two-node element.\n\n    The local degrees of freedom are ordered as [u1, u2, k1, k2].\n    \"\"\"\n    # K_uu = E*A/h * [[1, -1], [-1, 1]]\n    k_uu = (E * A / h) * np.array([[1, -1], [-1, 1]])\n\n    # K_uk = E*A * [[1/2, 1/2], [-1/2, -1/2]]\n    k_uk = (E * A / 2.0) * np.array([[1, 1], [-1, -1]])\n\n    # K_ku = E*A * [[1/2, -1/2], [1/2, -1/2]]\n    k_ku = (E * A / 2.0) * np.array([[1, -1], [1, -1]])\n    # Note: k_ku should be the transpose of k_uk for symmetry.\n    # As a check: k_uk.T = (E*A/2) * [[1, -1], [1, -1]] == k_ku. Correct.\n\n    # K_kk = (E+H)*A*h/6 * [[2, 1], [1, 2]] + A*l^2/h * [[1, -1], [-1, 1]]\n    term1 = ((E + H) * A * h / 6.0) * np.array([[2, 1], [1, 2]])\n    term2 = (A * l**2 / h) * np.array([[1, -1], [-1, 1]])\n    k_kk = term1 + term2\n\n    # Assemble the 4x4 element matrix using blocks\n    K_e = np.block([[k_uu, k_uk], [k_ku, k_kk]])\n    \n    return K_e\n\ndef assemble_global_matrix(n, K_e):\n    \"\"\"\n    Assembles the global tangent matrix from element matrices.\n    \n    DOF ordering: [u_0, ..., u_n, k_0, ..., k_n]\n    \"\"\"\n    num_nodes = n + 1\n    total_dofs = 2 * num_nodes\n    K_global = np.zeros((total_dofs, total_dofs))\n\n    for i in range(n):\n        # Global indices for element 'i' (connecting nodes i and i+1)\n        # Local DOFs: u_i, u_{i+1}, k_i, k_{i+1}\n        # Global DOF map for the element\n        dof_map = [\n            i,          # u_i\n            i + 1,      # u_{i+1}\n            num_nodes + i,  # k_i\n            num_nodes + i + 1   # k_{i+1}\n        ]\n        \n        # Add element matrix to global matrix\n        K_global[np.ix_(dof_map, dof_map)] += K_e\n        \n    return K_global\n\ndef compute_symmetry_indicator(L, n, E, A, H, l):\n    \"\"\"\n    Computes the symmetry indicator for the given set of parameters.\n    \"\"\"\n    # 1. Calculate element properties\n    h = L / n\n    \n    # 2. Compute the element tangent matrix\n    K_e = compute_element_matrix(h, E, A, H, l)\n    \n    # 3. Assemble the global tangent matrix\n    K_global = assemble_global_matrix(n, K_e)\n    \n    # 4. Apply essential boundary condition u(0)=0 by symmetric elimination\n    # The DOF for u(0) is at index 0. We remove the first row and column.\n    K_reduced = np.delete(K_global, 0, axis=0)\n    K_reduced = np.delete(K_reduced, 0, axis=1)\n\n    # 5. Compute the symmetry indicator eta\n    K_transpose = K_reduced.T\n    diff_norm = np.linalg.norm(K_reduced - K_transpose, 'fro')\n    K_norm = np.linalg.norm(K_reduced, 'fro')\n    \n    eta = diff_norm / max(1.0, K_norm)\n    \n    return eta\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test suite: (L, n, E, A, H, l)\n    test_cases = [\n        (1.0, 4, 30e9, 0.01, 5e9, 0.05),\n        (1.0, 4, 30e9, 0.01, 0.0, 0.05),\n        (1.0, 4, 30e9, 0.01, 5e9, 0.0),\n        (1.0, 1, 210e9, 0.02, 10e9, 0.1),\n        (1.5, 3, 25e9, 0.015, -2e9, 0.08),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, n, E, A, H, l = case\n        eta = compute_symmetry_indicator(L, n, E, A, H, l)\n        results.append(eta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n```"
        },
        {
            "introduction": "The final step in developing a reliable computational model is verification—ensuring the code correctly solves the underlying mathematical equations. This practice introduces the powerful method of manufactured solutions to benchmark a gradient-plasticity implementation against a known, exact solution . By comparing the performance of the gradient model against a simple local model across various mesh refinements, you will quantitatively demonstrate the concept of mesh-objectivity and appreciate why gradient enhancement is essential for predictive simulations of material failure.",
            "id": "3528900",
            "problem": "Consider a one-dimensional bar of length $L$ and cross-sectional area $A$ subjected to small-strain quasi-static tensile loading with prescribed uniform total strain $\\varepsilon_0$. The bar exhibits elastoplastic softening behavior. In a standard local plasticity description, the equivalent plastic strain $p(x)$ evolves pointwise, which leads to pathological mesh sensitivity in the presence of softening. A gradient-enhanced plasticity model introduces an intrinsic internal length scale $\\ell$ to regularize the response, producing mesh-objective fields and energetics. Assume small deformations so that the axial stress is given by $\\sigma(x) = E\\left(\\varepsilon(x) - p(x)\\right)$, where $E$ is the Young's modulus and $\\varepsilon(x)$ is the axial strain. For uniform displacement-controlled loading, assume $\\varepsilon(x) \\equiv \\varepsilon_0$.\n\nUse a manufactured solution paradigm to benchmark the models. Specifically, assume the exact nonlocal equivalent plastic strain field is prescribed by\n$$\np_m(x) = p_0 \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right), \\quad x \\in [0,L],\n$$\nfor some amplitude $p_0 > 0$. In a linear Helmholtz-type Aifantis gradient formulation that relates the nonlocal measure $p(x)$ to a local measure $\\bar{p}(x)$,\n$$\np(x) - \\ell^2 \\frac{d^2 p(x)}{dx^2} = \\bar{p}(x),\n$$\nwith natural (zero micro-traction) boundary conditions $\\frac{d p}{dx}(0) = 0$ and $\\frac{d p}{dx}(L) = 0$, the prescribed $p_m(x)$ induces the corresponding local measure\n$$\n\\bar{p}(x) = p_m(x) - \\ell^2 \\frac{d^2 p_m(x)}{dx^2}.\n$$\nFor the chosen Gaussian $p_m(x)$, compute analytically\n$$\n\\frac{d^2 p_m}{dx^2}(x) = p_0 \\left(\\frac{\\left(x-\\frac{L}{2}\\right)^2}{\\ell^4} - \\frac{1}{\\ell^2} \\right) \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right),\n$$\nand thus\n$$\n\\bar{p}(x) = p_0 \\left(2 - \\frac{\\left(x-\\frac{L}{2}\\right)^2}{\\ell^2}\\right) \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right).\n$$\n\nDiscretize the interval $[0,L]$ using a uniform mesh of $N$ nodes with spacing $h = \\frac{L}{N-1}$, so that the element size to internal length ratio is $r = \\frac{h}{\\ell}$. Implement two discrete models:\n\n- Local model: set $p_{\\text{local}}(x_i) = \\bar{p}(x_i)$ pointwise at nodes $x_i$.\n- Gradient model: solve the discrete Helmholtz problem\n$$\np - \\ell^2 \\, D^{(2)} p = \\bar{p},\n$$\nwhere $D^{(2)}$ is the standard second-derivative finite difference operator with homogeneous Neumann boundary conditions. For interior nodes $i=1,\\dots,N-2$,\n$(D^{(2)} p)_i = \\frac{p_{i-1} - 2 p_i + p_{i+1}}{h^2}$,\nand at boundaries $i=0$ and $i=N-1$ (using ghost points with $\\frac{dp}{dx}=0$),\n$(D^{(2)} p)_0 = \\frac{-2 p_0 + 2 p_1}{h^2}, \\quad (D^{(2)} p)_{N-1} = \\frac{2 p_{N-2} - 2 p_{N-1}}{h^2}.$\n\nBenchmark accuracy and mesh-objectivity using the manufactured solution. For each $r$:\n\n1. Construct the mesh and evaluate $p_m(x_i)$ and $\\bar{p}(x_i)$ at nodes.\n2. Assemble and solve the linear system for the gradient model to obtain $p_{\\text{grad}}(x_i)$.\n3. Compute the relative $L^2$ errors with respect to $p_m(x)$:\n$$\ne_{\\text{grad}} = \\frac{\\left\\|p_{\\text{grad}} - p_m\\right\\|_{L^2}}{\\left\\|p_m\\right\\|_{L^2}}, \\quad e_{\\text{local}} = \\frac{\\left\\|p_{\\text{local}} - p_m\\right\\|_{L^2}}{\\left\\|p_m\\right\\|_{L^2}},\n$$\napproximating the $L^2$ norm by the trapezoidal rule over the grid.\n4. Compute the nominal stress for each model under the uniform total strain $\\varepsilon_0$:\n$$\n\\Sigma_{\\text{grad}} = E \\left(\\varepsilon_0 - \\frac{1}{L} \\int_0^L p_{\\text{grad}}(x)\\, dx \\right), \\quad \\Sigma_{\\text{local}} = E \\left(\\varepsilon_0 - \\frac{1}{L} \\int_0^L p_{\\text{local}}(x)\\, dx \\right),\n$$\nwith integrals approximated by the trapezoidal rule.\n\nUse the following physically consistent parameters:\n- $E = 3.0 \\times 10^{10}$ (Pascals),\n- $\\ell = 5.0 \\times 10^{-2}$ (meters),\n- $L = 40\\,\\ell$ (meters),\n- $p_0 = 1.0 \\times 10^{-3}$ (dimensionless),\n- $\\varepsilon_0 = 2.0 \\times 10^{-3}$ (dimensionless).\n\nNo angle units are involved. All stress outputs must be expressed in Pascals (Pa). Error outputs are dimensionless.\n\nTest suite of element size ratios $r = h/\\ell$:\n- $r = 0.1$ (fine mesh),\n- $r = 0.5$ (moderately fine),\n- $r = 1.0$ (internal length resolved),\n- $r = 2.5$ (coarse mesh),\n- $r = 10.0$ (very coarse mesh).\n\nFor each $r$ in the test suite, the program must compute and report the tuple $[e_{\\text{grad}}, e_{\\text{local}}, \\Sigma_{\\text{grad}}, \\Sigma_{\\text{local}}]$, where the errors are floats and the stresses are floats in Pascals. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one $r$ and is itself a list in the specified order (for example, $[[e_{\\text{grad}},e_{\\text{local}},\\Sigma_{\\text{grad}},\\Sigma_{\\text{local}}],\\dots]$).",
            "solution": "The user-provided problem has been rigorously validated and is determined to be a well-posed and scientifically sound exercise in computational mechanics. All parameters, equations, and boundary conditions are specified, and the methodology leverages standard, verifiable techniques. The manufactured solution $p_m(x)$ does not strictly satisfy the homogeneous Neumann boundary conditions in an analytical sense; however, for the given parameter $L=40\\ell$, the value of the derivative at the boundaries is of the order $10^{-86}$, which is numerically zero. This discrepancy is characteristic of using unbounded domain functions (like a Gaussian) on a finite domain and does not invalidate the problem's utility as a benchmark.\n\nThe problem asks for a comparison between a local and a gradient-enhanced plasticity model using the method of manufactured solutions. This method provides a powerful verification tool, allowing us to quantify the accuracy of our numerical schemes against a known, exact solution. The core physical issue being addressed is the pathological mesh-dependence of numerical solutions for materials that exhibit softening, a phenomenon where material strength degrades with increasing strain. Standard local continuum models fail in this regime, as they lack an intrinsic length scale, leading to localization of deformation into a zone of zero width, which is physically unrealistic and numerically intractable. Gradient-enhanced models, such as the one presented, introduce an internal length scale, $\\ell$, to regularize the problem, ensuring that the zone of deformation has a finite, physically meaningful width, thereby restoring mesh-objectivity to the numerical simulations.\n\nThe problem is centered on a one-dimensional bar of length $L$ with Young's modulus $E$. The axial stress $\\sigma$ is related to the total strain $\\varepsilon$ and the plastic strain $p$ by the small-strain relation $\\sigma(x) = E(\\varepsilon(x) - p(x))$. For the specified loading, the total strain is uniform, $\\varepsilon(x) = \\varepsilon_0$.\n\nThe gradient-enhancement is introduced via a linear Helmholtz-type equation, which relates the nonlocal plastic strain $p(x)$ (the field that enters the stress equation) to an underlying local-like variable $\\bar{p}(x)$:\n$$\np(x) - \\ell^2 \\frac{d^2 p(x)}{dx^2} = \\bar{p}(x)\n$$\nThis equation is solved over the domain $x \\in [0, L]$ with homogeneous Neumann (zero flux) boundary conditions, $\\frac{dp}{dx}(0) = \\frac{dp}{dx}(L) = 0$.\n\nIn the manufactured solution approach, we postulate an exact form for the nonlocal plastic strain, $p_m(x)$, and use the governing equation to derive the necessary \"source\" term, $\\bar{p}(x)$, that produces this solution.\nThe prescribed manufactured solution is a Gaussian function:\n$$\np_m(x) = p_0 \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right)\n$$\nSubstituting $p_m(x)$ into the Helmholtz equation yields the corresponding source term $\\bar{p}(x)$:\n$$\n\\bar{p}(x) = p_m(x) - \\ell^2 \\frac{d^2 p_m(x)}{dx^2} = p_0 \\left(2 - \\frac{\\left(x-\\frac{L}{2}\\right)^2}{\\ell^2}\\right) \\exp\\left(-\\frac{\\left(x - \\frac{L}{2}\\right)^2}{2\\ell^2}\\right)\n$$\n\nThe task is to compare two discrete models for a series of mesh resolutions, defined by the ratio $r=h/\\ell$, where $h$ is the mesh spacing.\n\n1.  **Local Model**: This model incorrectly assumes that the physical plastic strain at a point is simply the local source term, i.e., $p_{\\text{local}}(x_i) = \\bar{p}(x_i)$ at each node $x_i$. This approach entirely neglects the regularizing effect of the spatial gradient term and is expected to yield inaccurate results for the plastic strain field and consequently the overall structural response.\n\n2.  **Gradient Model**: This model correctly solves the discretized version of the Helmholtz equation to find the nonlocal plastic strain field $p_{\\text{grad}}(x_i)$. The domain $[0, L]$ is discretized into $N$ nodes with spacing $h = L/(N-1)$. Using a second-order finite difference approximation for the second derivative, we obtain a system of linear algebraic equations:\n    $$\n    \\mathbf{p}_{\\text{grad}} - \\ell^2 \\mathbf{D}^{(2)} \\mathbf{p}_{\\text{grad}} = \\bar{\\mathbf{p}}\n    $$\n    where $\\mathbf{p}_{\\text{grad}}$ and $\\bar{\\mathbf{p}}$ are vectors of nodal values and $\\mathbf{D}^{(2)}$ is the matrix representation of the second derivative operator including the Neumann boundary conditions. This can be written as a linear system $\\mathbf{A} \\mathbf{p}_{\\text{grad}} = \\bar{\\mathbf{p}}$, where $\\mathbf{A} = \\mathbf{I} - \\ell^2 \\mathbf{D}^{(2)}$ is a symmetric, tridiagonal, and positive-definite matrix, guaranteeing a unique solution. Let $\\alpha = \\ell^2/h^2 = 1/r^2$. The non-zero entries of the matrix $\\mathbf{A}$ are:\n    $$\n    \\begin{cases}\n    A_{i,i-1} = -\\alpha, \\quad A_{i,i} = 1+2\\alpha, \\quad A_{i,i+1} = -\\alpha  \\text{for } i \\in \\{1, \\dots, N-2\\} \\\\\n    A_{0,0} = 1+2\\alpha, \\quad A_{0,1} = -2\\alpha  \\text{for } i=0 \\\\\n    A_{N-1,N-2} = -2\\alpha, \\quad A_{N-1,N-1} = 1+2\\alpha  \\text{for } i=N-1\n    \\end{cases}\n    $$\n\nFollowing the assembly and solution of this system, we assess the accuracy of both models by computing the relative $L^2$ error with respect to the exact solution $p_m(x)$. The $L^2$ norm, $\\|f\\|_{L^2} = \\sqrt{\\int_0^L f(x)^2 dx}$, is approximated numerically using the trapezoidal rule on the discrete nodal values.\n$$\ne_{\\text{grad}} = \\frac{\\|p_{\\text{grad}} - p_m\\|_{L^2}}{\\|p_m\\|_{L^2}}, \\quad e_{\\text{local}} = \\frac{\\|p_{\\text{local}} - p_m\\|_{L^2}}{\\|p_m\\|_{L^2}}\n$$\nAs the mesh is refined (i.e., as $r$ decreases), $e_{\\text{grad}}$ is expected to decrease, demonstrating convergence to the exact solution. Conversely, $e_{\\text{local}}$ will remain large, as the local model is fundamentally incorrect.\n\nFinally, we compute the macroscopic engineering response, the nominal stress $\\Sigma$, for both models. This requires averaging the respective plastic strain fields over the bar's length $L$:\n$$\n\\Sigma = E \\left(\\varepsilon_0 - \\frac{1}{L} \\int_0^L p(x)\\, dx \\right)\n$$\nThe integral is again computed using the trapezoidal rule. The comparison of $\\Sigma_{\\text{grad}}$ and $\\Sigma_{\\text{local}}$ demonstrates the impact of model choice on predicting global structural behavior.\n\nThe implementation will loop through the specified ratios $r \\in \\{0.1, 0.5, 1.0, 2.5, 10.0\\}$, and for each, it will:\n1.  Define the mesh based on $L$, $\\ell$, and $r$.\n2.  Evaluate the manufactured fields $p_m(x_i)$ and $\\bar{p}(x_i)$ at the nodes.\n3.  Set $p_{\\text{local},i} = \\bar{p}(x_i)$.\n4.  Assemble and solve the linear system $\\mathbf{A} \\mathbf{p}_{\\text{grad}} = \\bar{\\mathbf{p}}$ to find $p_{\\text{grad},i}$.\n5.  Calculate the four requested metrics: $e_{\\text{grad}}, e_{\\text{local}}, \\Sigma_{\\text{grad}}, \\Sigma_{\\text{local}}$.\n\nThis procedure will quantitatively demonstrate the superiority and mesh-objectivity of the gradient-enhanced formulation.",
            "answer": "```python\nimport numpy as np\nimport scipy  # Specified in environment, though not directly used in this implementation\n\ndef solve():\n    \"\"\"\n    Solves the gradient-enhanced plasticity benchmark problem for a suite of mesh sizes.\n    \"\"\"\n    # Physical and model parameters\n    E = 3.0e10        # Young's modulus in Pascals\n    l_scale = 5.0e-2  # Internal length scale in meters\n    L = 40.0 * l_scale # Bar length in meters\n    p_0 = 1.0e-3      # Amplitude of plastic strain (dimensionless)\n    eps_0 = 2.0e-3    # Prescribed total strain (dimensionless)\n\n    # Test suite of element size to internal length ratios\n    r_values = [0.1, 0.5, 1.0, 2.5, 10.0]\n\n    # --- Analytical Functions for Manufactured Solution ---\n    def p_m_func(x, L_val, l_val, p0_val):\n        \"\"\"Manufactured solution for nonlocal plastic strain p(x).\"\"\"\n        term = (x - L_val / 2.0)**2 / (2.0 * l_val**2)\n        return p0_val * np.exp(-term)\n\n    def p_bar_func(x, L_val, l_val, p0_val):\n        \"\"\"Induced local measure p_bar(x) corresponding to p_m(x).\"\"\"\n        term1 = (x - L_val / 2.0)**2 / l_val**2\n        exp_term = np.exp(-term1 / 2.0)\n        return p0_val * (2.0 - term1) * exp_term\n\n    def compute_metrics(r, E_val, l_val, L_val, p0_val, eps0_val):\n        \"\"\"\n        Computes errors and stresses for a given mesh size ratio 'r'.\n        \"\"\"\n        # 1. Construct the mesh\n        h = r * l_val\n        # Ensure N is an integer, rounding handles potential floating point issues\n        N = int(round(L_val / h)) + 1\n        x_nodes = np.linspace(0, L_val, N)\n\n        # Evaluate the manufactured fields at the mesh nodes\n        p_m_nodes = p_m_func(x_nodes, L_val, l_val, p0_val)\n        p_bar_nodes = p_bar_func(x_nodes, L_val, l_val, p0_val)\n\n        # 2. Local model solution (trivial assignment)\n        p_local_nodes = p_bar_nodes\n\n        # 3. Gradient model: assemble and solve the linear system\n        # A * p_grad = p_bar, where A = I - l^2 * D^(2)\n        A = np.zeros((N, N))\n        alpha = (l_val / h)**2  # alpha = 1/r^2\n\n        # Fill the interior rows of the matrix A\n        for i in range(1, N - 1):\n            A[i, i - 1] = -alpha\n            A[i, i] = 1.0 + 2.0 * alpha\n            A[i, i + 1] = -alpha\n\n        # Fill the boundary rows (homogeneous Neumann BCs)\n        A[0, 0] = 1.0 + 2.0 * alpha\n        A[0, 1] = -2.0 * alpha\n        A[N - 1, N - 2] = -2.0 * alpha\n        A[N - 1, N - 1] = 1.0 + 2.0 * alpha\n\n        # Solve for the gradient-enhanced plastic strain field\n        p_grad_nodes = np.linalg.solve(A, p_bar_nodes)\n\n        # 4. Compute relative L2 errors\n        # The L2 norm is computed using the trapezoidal rule.\n        # ||f||^2 = integral(f^2 dx)\n        norm_p_m_sq = np.trapz(p_m_nodes**2, x_nodes)\n        \n        # Avoid division by zero if p_m is zero everywhere (not the case here)\n        norm_p_m = np.sqrt(norm_p_m_sq) if norm_p_m_sq > 0 else 1.0\n\n        # Error for the gradient model\n        err_grad_sq = np.trapz((p_grad_nodes - p_m_nodes)**2, x_nodes)\n        e_grad = np.sqrt(err_grad_sq) / norm_p_m\n\n        # Error for the local model\n        err_local_sq = np.trapz((p_local_nodes - p_m_nodes)**2, x_nodes)\n        e_local = np.sqrt(err_local_sq) / norm_p_m\n\n        # 5. Compute nominal stresses\n        # Stress = E * (total_strain - average_plastic_strain)\n        # Average plastic strain = (1/L) * integral(p(x) dx)\n        avg_p_grad = np.trapz(p_grad_nodes, x_nodes) / L_val\n        sigma_grad = E_val * (eps0_val - avg_p_grad)\n\n        avg_p_local = np.trapz(p_local_nodes, x_nodes) / L_val\n        sigma_local = E_val * (eps0_val - avg_p_local)\n        \n        return [e_grad, e_local, sigma_grad, sigma_local]\n\n    # --- Main Execution Loop ---\n    all_results = []\n    for r in r_values:\n        result_tuple = compute_metrics(r, E, l_scale, L, p_0, eps_0)\n        all_results.append(result_tuple)\n\n    # Format the final output string exactly as required\n    output_str = \"[\" + \",\".join([str(res) for res in all_results]) + \"]\"\n\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}