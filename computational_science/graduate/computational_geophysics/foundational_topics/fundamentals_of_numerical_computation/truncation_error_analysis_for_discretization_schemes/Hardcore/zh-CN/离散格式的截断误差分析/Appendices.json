{
    "hands_on_practices": [
        {
            "introduction": "分析和构建有限差分格式的基础在于泰勒级数展开。通过系统地匹配泰勒级数的系数，我们可以为任意阶导数设计出具有特定精度的数值逼近。这项练习将指导你推导一个用于一阶导数的四阶精度中心差分格式的权重，并确定其主截断误差项，这是开发和分析数值方法的一项基本技能。",
            "id": "3617972",
            "problem": "在计算地球物理学中使用的高阶有限差分离散中，需要光滑场的精确空间梯度来减少由偏微分方程（PDE）控制的波传播模拟中的数值频散。考虑一个光滑的标量地球物理场 $u(x)$，它在一个间距为 $h$ 的均匀网格上采样，采样点为 $x_i + m h$，其中整数偏移量 $m \\in \\{-2,-1,0,1,2\\}$。你的目标是使用以下形式的中心五点格式来近似一阶空间导数 $u_x(x_i)$：\n$$\nD u_i \\equiv \\frac{1}{h} \\sum_{m=-2}^{2} w_m \\, u(x_i + m h),\n$$\n其中权重 $w_m$ 的选择应使 $D u_i$ 在 $x_i$ 处达到四阶精度。从 $u(x_i + m h)$ 关于 $x_i$ 的泰勒级数展开开始，通过匹配系数来确定权重 $w_m$，使得除了正确再现的 $u_x(x_i)$ 项之外，$D u_i - u_x(x_i)$ 中与 $h^k$（对于 $k = 0,1,2,3,4$）成比例的项都为零。假设这是一个与一阶导数一致的中心格式，即对于 $m = 1,2$，有 $w_{-m} = - w_m$。然后，使用得到的权重，计算由下式定义的主截断误差系数 $C$：\n$$\nD u_i - u_x(x_i) = C \\, h^4 \\, u^{(5)}(x_i) + \\mathcal{O}(h^6).\n$$\n将最终系数 $C$ 表示为一个精确的有理数。不需要四舍五入，且 $C$ 没有单位。",
            "solution": "我们的目标是找到近似一阶导数 $u_x(x_i)$ 的五点中心差分格式的权重 $w_m$ 和主截断误差系数 $C$。该格式具有以下形式：\n$$\nD u_i \\equiv \\frac{1}{h} \\sum_{m=-2}^{2} w_m \\, u(x_i + m h) \\approx u_x(x_i)\n$$\n且截断误差为 $\\mathcal{O}(h^4)$。\n\n由于格式是中心的且用于近似一阶导数，权重是反对称的，即 $w_{-m} = -w_m$。这意味着 $w_0 = 0$。因此，格式可以简化为：\n$$\nD u_i = \\frac{1}{h} \\left( w_1 (u(x_i+h) - u(x_i-h)) + w_2 (u(x_i+2h) - u(x_i-2h)) \\right)\n$$\n为了确定权重 $w_1$ 和 $w_2$，我们使用 $u$ 在 $x_i$ 点的泰勒级数展开。设 $u^{(k)}(x_i)$ 为 $u$ 在 $x_i$ 处的 $k$ 阶导数。\n$u(x_i \\pm mh)$ 的展开式为：\n$$\nu(x_i \\pm mh) = u(x_i) \\pm (mh)u^{(1)}(x_i) + \\frac{(mh)^2}{2!}u^{(2)}(x_i) \\pm \\frac{(mh)^3}{3!}u^{(3)}(x_i) + \\frac{(mh)^4}{4!}u^{(4)}(x_i) \\pm \\frac{(mh)^5}{5!}u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n我们需要的差分项展开后为：\n$$\nu(x_i+h) - u(x_i-h) = 2h u^{(1)}(x_i) + \\frac{h^3}{3} u^{(3)}(x_i) + \\frac{h^5}{60} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n$$\nu(x_i+2h) - u(x_i-2h) = 4h u^{(1)}(x_i) + \\frac{8h^3}{3} u^{(3)}(x_i) + \\frac{32h^5}{60} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n将这些展开式代入 $D u_i$ 的表达式中，并按 $u$ 的导数阶数进行分组：\n$$\nD u_i = (2w_1 + 4w_2) u^{(1)}(x_i) + \\left(\\frac{w_1}{3} + \\frac{8w_2}{3}\\right) h^2 u^{(3)}(x_i) + \\left(\\frac{w_1}{60} + \\frac{32w_2}{60}\\right) h^4 u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n为了达到四阶精度，我们要求：\n1.  $u^{(1)}(x_i)$ 的系数为 1，以正确匹配一阶导数：\n    $$2w_1 + 4w_2 = 1 \\quad (1)$$\n2.  $h^2 u^{(3)}(x_i)$ 的系数为 0，以消除二阶误差项：\n    $$\\frac{w_1}{3} + \\frac{8w_2}{3} = 0 \\implies w_1 + 8w_2 = 0 \\quad (2)$$\n\n我们现在求解这个关于 $w_1$ 和 $w_2$ 的线性方程组。从方程 (2) 中得到 $w_1 = -8w_2$。将其代入方程 (1)：\n$$\n2(-8w_2) + 4w_2 = 1 \\implies -16w_2 + 4w_2 = 1 \\implies -12w_2 = 1\n$$\n因此，$w_2 = -\\frac{1}{12}$。\n进而求得 $w_1$：\n$$\nw_1 = -8 \\left(-\\frac{1}{12}\\right) = \\frac{8}{12} = \\frac{2}{3}\n$$\n所以，完整的权重集为：$w_2 = -1/12$, $w_1 = 2/3$, $w_0 = 0$, $w_{-1} = -2/3$, $w_{-2} = 1/12$。\n\n截断误差 $D u_i - u_x(x_i)$ 的主项是第一个非零项，即 $h^4 u^{(5)}(x_i)$ 项。其系数 $C$ 为：\n$$\nC = \\frac{w_1}{60} + \\frac{32w_2}{60} = \\frac{1}{60} \\left( w_1 + 32w_2 \\right)\n$$\n代入 $w_1$ 和 $w_2$ 的值：\n$$\nC = \\frac{1}{60} \\left( \\frac{2}{3} + 32 \\left(-\\frac{1}{12}\\right) \\right) = \\frac{1}{60} \\left( \\frac{2}{3} - \\frac{32}{12} \\right) = \\frac{1}{60} \\left( \\frac{2}{3} - \\frac{8}{3} \\right)\n$$\n$$\nC = \\frac{1}{60} \\left( -\\frac{6}{3} \\right) = \\frac{1}{60} (-2) = -\\frac{2}{60} = -\\frac{1}{30}\n$$\n所以，主截断误差系数是 $-\\frac{1}{30}$。",
            "answer": "$$\n\\boxed{-\\frac{1}{30}}\n$$"
        },
        {
            "introduction": "理论推导之后，必须在实践中验证数值格式的正确实现。人造解方法 (Method of Manufactured Solutions, MMS) 是一种严谨的验证技术，它通过构造一个已知的解析解来检验数值解是否以理论预测的收敛阶收敛。本练习将带你为一个在地球物理学中常见的偏微分方程——热传导方程——设计一个人造解测试，这对于确保计算代码的可靠性至关重要。",
            "id": "3617926",
            "problem": "在计算地球物理学中，一维空间中的热扩散过程由偏微分方程(PDE) $u_{t}=\\kappa u_{xx}$ 在周期性域 $x\\in[0,1]$ 上建模，其中 $\\kappa>0$ 是一个常数扩散系数，并且对于所有 $t\\geq 0$ 施加周期性边界条件 $u(0,t)=u(1,t)$ 和 $u_{x}(0,t)=u_{x}(1,t)$。为使用制造解方法（Method of Manufactured Solutions）评估离散化格式的截断误差，考虑以下制造解：\n$$\nu(x,t)=\\exp(\\sigma t)\\sin(2\\pi x)+\\exp(2\\sigma t)\\cos(4\\pi x),\n$$\n其中 $\\sigma\\neq 0$ 是一个给定的实常数。引入一个源项 $s(x,t)$，使得 $u(x,t)$ 是强迫偏微分方程\n$$\nu_{t}=\\kappa u_{xx}+s(x,t),\n$$\n的精确解，并满足相同的周期性边界条件。\n\n在一个均匀网格上，对于整数 $i$ 有 $x_{i}=i\\,\\Delta x$，对于整数 $n$ 有时间层级 $t^{n}=n\\,\\Delta t$，考虑以下在时间和空间上均为二阶精度的 Crank–Nicolson 有限差分格式，该格式使用中心二阶差分和源项的梯形时间平均：\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}=\\kappa\\,\\frac{1}{2}\\left[\\frac{u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}}{\\Delta x^{2}}+\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}\\right]+\\frac{1}{2}\\left(s_{i}^{n}+s_{i}^{n+1}\\right),\n$$\n其中 $i$ 中的索引是周期性的，与边界条件一致。\n\n任务：\n- 推导源项 $s(x,t)$ 的显式闭式表达式，使得给定的 $u(x,t)$ 成为强迫偏微分方程的精确解。\n- 使用在 $(x_{i},t^{n})$ 处的泰勒展开和局部截断误差的定义，预测阶数 $p$，使得局部截断误差的缩放行为如同 $\\mathcal{O}(\\Delta t^{p})+\\mathcal{O}(\\Delta x^{p})$。\n\n以行矩阵的形式提供你的最终答案，其中依次包含 $s(x,t)$ 的显式表达式和整数 $p$。不需要单位。",
            "solution": "该问题分为两部分：首先，推导源项 $s(x,t)$；其次，预测Crank-Nicolson格式的精度阶 $p$。\n\n**1. 推导源项 s(x,t)**\n\n根据强迫偏微分方程 $u_t = \\kappa u_{xx} + s(x,t)$，源项 $s(x,t)$ 可以通过将给定的制造解 $u(x,t)$ 代入方程中来确定，即 $s(x,t) = u_t - \\kappa u_{xx}$。\n\n首先，我们计算 $u(x,t)$ 对时间 $t$ 的偏导数 $u_t$：\n$$\nu(x,t) = \\exp(\\sigma t)\\sin(2\\pi x) + \\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n$$\nu_t = \\frac{\\partial}{\\partial t} u(x,t) = \\sigma \\exp(\\sigma t)\\sin(2\\pi x) + 2\\sigma \\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n\n接下来，我们计算 $u(x,t)$ 对空间 $x$ 的二阶偏导数 $u_{xx}$：\n$$\nu_x = \\frac{\\partial}{\\partial x} u(x,t) = 2\\pi \\exp(\\sigma t)\\cos(2\\pi x) - 4\\pi \\exp(2\\sigma t)\\sin(4\\pi x)\n$$\n$$\nu_{xx} = \\frac{\\partial^2}{\\partial x^2} u(x,t) = -(2\\pi)^2 \\exp(\\sigma t)\\sin(2\\pi x) - (4\\pi)^2 \\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n$$\nu_{xx} = -4\\pi^2 \\exp(\\sigma t)\\sin(2\\pi x) - 16\\pi^2 \\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n\n最后，我们将 $u_t$ 和 $u_{xx}$ 代入 $s(x,t) = u_t - \\kappa u_{xx}$ 的表达式中：\n$$\ns(x,t) = \\left( \\sigma \\exp(\\sigma t)\\sin(2\\pi x) + 2\\sigma \\exp(2\\sigma t)\\cos(4\\pi x) \\right) - \\kappa \\left( -4\\pi^2 \\exp(\\sigma t)\\sin(2\\pi x) - 16\\pi^2 \\exp(2\\sigma t)\\cos(4\\pi x) \\right)\n$$\n整理各项，得到源项的最终表达式：\n$$\ns(x,t) = (\\sigma + 4\\kappa\\pi^2)\\exp(\\sigma t)\\sin(2\\pi x) + (2\\sigma + 16\\kappa\\pi^2)\\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n\n**2. 预测阶数 p**\n\n局部截断误差 (LTE) 是通过将精确解 $u(x,t)$ 代入离散格式并减去原始PDE在同一点的值得到的残差。对于给定的Crank-Nicolson格式，我们可以分析其时间和空间离散项的精度。\n\n1.  **时间离散**：格式使用时间平均，$\\frac{1}{2}(\\cdot^n + \\cdot^{n+1})$，这是梯形法则的一种形式。梯形法则对时间积分的局部截断误差是 $O(\\Delta t^2)$。\n2.  **空间离散**：空间导数 $u_{xx}$ 使用标准的中心差分 $\\frac{u_{i+1}-2u_i+u_{i-1}}{\\Delta x^2}$ 来近似。这个近似的局部截断误差是 $O(\\Delta x^2)$。\n\n由于整个格式结合了二阶时间离散和二阶空间离散，其总的局部截断误差为各项误差之和，即 $\\mathcal{O}(\\Delta t^2) + \\mathcal{O}(\\Delta x^2)$。\n问题要求预测阶数 $p$，使得局部截断误差的缩放行为如同 $\\mathcal{O}(\\Delta t^{p}) + \\mathcal{O}(\\Delta x^{p})$。根据我们的分析，时间和空间的精度阶均为2。因此，$p=2$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} (\\sigma + 4\\kappa\\pi^{2})\\exp(\\sigma t)\\sin(2\\pi x) + (2\\sigma + 16\\kappa\\pi^{2})\\exp(2\\sigma t)\\cos(4\\pi x)  2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在代码验证之外，我们常常希望在真实模拟中（当精确解未知时）估计实际的离散化误差。理查森外推法 (Richardson extrapolation) 提供了一种强大的方法，通过比较在两种不同分辨率网格上得到的数值解来估计主阶误差项。这项练习将展示如何实现这一技术，并从数值结果中估计出渐近误差展开式中的主误差系数 $C_p$，从而将理论误差分析与可测量的计算结果联系起来。",
            "id": "3617978",
            "problem": "考虑一个光滑的标量关注量 $Q$，该量从均匀间距为 $h$ 的网格上一个偏微分方程（PDE）的数值解中提取。假设离散格式是相容且稳定的，并且其对于 $Q$ 的全局误差允许一个渐近展开 $Q_h = Q + C_p h^p + C_{p+1} h^{p+1} + \\mathcal{O}(h^{p+2})$，其中 $p \\ge 1$ 为某个整数阶，$C_p$ 是主截断误差常数，它依赖于离散格式、偏微分方程、边界条件以及泛函 $Q$。任务是利用在两个间距分别为 $h$ 和 $h/2$ 的嵌套网格上的 Richardson 外推法，推导出一个 $C_p$ 的估计量，证明其有效性所依赖的假设，并针对计算地球物理学中的具体测试问题实现它。\n\n你的程序必须：\n1. 使用渐近误差模型和在间距 $h$ 和 $h/2$ 上计算出的两个解，从第一性原理出发，推导出 $C_p$ 的估计量。\n2. 对以下一维空间中的测试实现该估计量，使用二阶中心有限差分格式离散区域 $[0,1]$ 上的椭圆问题 $-u''(x) = f(x)$，边界条件为齐次 Dirichlet 边界条件 $u(0) = 0$ 和 $u(1) = 0$。在所有情况下，精确解选择为 $u(x) = \\sin(k \\pi x)$，这意味着 $f(x) = k^2 \\pi^2 \\sin(k \\pi x)$，并且格式的阶为 $p = 2$。对于一个有 $m$ 个内部点的网格，使用间距 $h = 1/(m+1)$ 和内部网格点 $x_j = j h$，$j = 1, 2, \\dots, m$。将关注量 $Q$ 定义为在指定位置 $x_0$ 处的解的点值，该位置 $x_0$ 同时是间距为 $h$ 的粗网格和间距为 $h/2$ 的细网格的网格点（即，在粗网格上 $x_0 = j h$，在细网格上 $x_0 = j' (h/2)$）。\n\n使用以下测试套件：\n- 测试 $1$：$k = 1$，粗网格内部点数 $m = 9$（因此 $h = 1/10$），细网格内部点数 $m' = 19$（因此 $h' = h/2 = 1/20$），以及 $x_0 = 1/2$。使用 $p = 2$。\n- 测试 $2$：$k = 3$，粗网格内部点数 $m = 9$（因此 $h = 1/10$），细网格内部点数 $m' = 19$（因此 $h' = h/2 = 1/20$），以及 $x_0 = 3/10$。使用 $p = 2$。\n- 测试 $3$：$k = 1$，粗网格内部点数 $m = 3$（因此 $h = 1/4$），细网格内部点数 $m' = 7$（因此 $h' = h/2 = 1/8$），以及 $x_0 = 1/2$。使用 $p = 2$。\n\n在每个测试中：\n- 使用标准的二阶中心有限差分模板为 $-u''(x) = f(x)$ 组装离散系统，这将产生线性系统 $A \\mathbf{u} = \\mathbf{f}$，其中 $A$ 是三对角的，$\\mathbf{f}$ 是在内部网格点上求值的。\n- 在两个网格上求解 $\\mathbf{u}$。\n- 分别从粗网格和细网格上在 $x_0$ 处求值的 $\\mathbf{u}$ 中提取 $Q_h$ 和 $Q_{h/2}$。\n- 计算在第 1 部分中推导出的基于 Richardson 的 $C_p$ 估计量。\n\n为证明估计量的有效性需要陈述和论证的假设：\n- 格式是 $p$ 阶相容且稳定的，因此对于足够小的 $h$，$Q$ 的全局误差允许一个渐近展开 $Q_h - Q = C_p h^p + C_{p+1} h^{p+1} + \\mathcal{O}(h^{p+2})$。\n- 网格是均匀且嵌套的，并且对 $h$ 和 $h/2$ 使用相同的离散化方法（包括边界处理）。\n- 泛函 $Q$ 足够光滑，以使其离散误差继承格式的阶 $p$。\n- 对于所选的 $Q$，主常数 $C_p$ 非零，并且在所选的 $h$ 下，舍入误差或求解器误差相对于截断误差可以忽略不计。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试 $1$、$2$ 和 $3$ 的顺序排列结果，例如 $[c_1,c_2,c_3]$，其中每个 $c_i$是相应测试的 $C_p$ 的浮点估计值。不需要单位，也不出现角度。\n\n你的程序必须是自包含的，并且可以直接运行，不得从用户读取输入。",
            "solution": "此问题被评估为有效。这是一个数值分析中的适定问题，具体涉及应用于一维椭圆边值问题的有限差分格式的截断误差分析。所有参数和条件都定义清晰，具有科学依据，并且内部一致。\n\n解答过程分为三个部分：首先，推导主截断误差常数 $C_p$ 的估计量；其次，讨论证明该估计量合理性的假设；第三，概述针对指定测试用例的数值实现。\n\n**1. $C_p$ 估计量的推导**\n\n问题陈述了在间距为 $h$ 的网格上计算出的数值关注量 $Q_h$ 具有以下形式的渐近误差展开：\n$$Q_h = Q + C_p h^p + C_{p+1} h^{p+1} + \\mathcal{O}(h^{p+2})$$\n此处，$Q$ 是该量的精确值，$p \\ge 1$ 是格式的精度阶，$C_p$ 和 $C_{p+1}$ 是与 $h$ 无关的常数。\n\n我们得到了在间距为 $h$ 和 $h/2$ 的嵌套网格上计算的两个解。让它们分别为 $Q_h$ 和 $Q_{h/2}$。我们可以为每个解写出误差展开式：\n$$Q_h = Q + C_p h^p + C_{p+1} h^{p+1} + \\mathcal{O}(h^{p+2}) \\quad (1)$$\n$$Q_{h/2} = Q + C_p \\left(\\frac{h}{2}\\right)^p + C_{p+1} \\left(\\frac{h}{2}\\right)^{p+1} + \\mathcal{O}(h^{p+2})$$\n$$Q_{h/2} = Q + \\frac{C_p}{2^p} h^p + \\frac{C_{p+1}}{2^{p+1}} h^{p+1} + \\mathcal{O}(h^{p+2}) \\quad (2)$$\n\n为了推导 $C_p$ 的估计量，我们首先通过将方程 $(1)$ 从方程 $(2)$ 中减去来消去未知的精确值 $Q$：\n$$Q_{h/2} - Q_h = \\left( \\frac{C_p}{2^p} h^p - C_p h^p \\right) + \\left( \\frac{C_{p+1}}{2^{p+1}} h^{p+1} - C_{p+1} h^{p+1} \\right) + \\mathcal{O}(h^{p+2})$$\n$$Q_{h/2} - Q_h = C_p h^p \\left( \\frac{1}{2^p} - 1 \\right) + C_{p+1} h^{p+1} \\left( \\frac{1}{2^{p+1}} - 1 \\right) + \\mathcal{O}(h^{p+2})$$\n\n为了获得 $C_p$ 的估计量，我们假设 $h$ 足够小，以至于主项 $C_p h^p (...)$ 主导高阶项。因此我们可以截断该级数：\n$$Q_{h/2} - Q_h \\approx C_p h^p \\left( \\frac{1}{2^p} - 1 \\right)$$\n现在，我们可以求解 $C_p$：\n$$C_p \\approx \\frac{Q_{h/2} - Q_h}{h^p \\left( \\frac{1 - 2^p}{2^p} \\right)} = \\frac{Q_{h/2} - Q_h}{h^p} \\frac{2^p}{1 - 2^p}$$\n为了得到更常规的形式，重新整理分子，得到估计量的最终表达式，我们将其记为 $\\hat{C}_p$：\n$$\\hat{C}_p = \\frac{Q_h - Q_{h/2}}{h^p (1 - 1/2^p)} = \\frac{2^p}{2^p - 1} \\frac{Q_h - Q_{h/2}}{h^p}$$\n\n问题指定使用二阶格式，所以 $p=2$。主误差常数 $C_2$ 的估计量变为：\n$$\\hat{C}_2 = \\frac{2^2}{2^2 - 1} \\frac{Q_h - Q_{h/2}}{h^2} = \\frac{4}{3} \\frac{Q_h - Q_{h/2}}{h^2}$$\n此表达式将在实现中使用。\n\n**2. 假设的论证**\n\n此估计量的有效性依赖于问题中列出的几个假设，这些假设在给定的偏微分方程和数值格式的背景下是合理的。\n\n- **渐近误差展开**：对于具有光滑源项 $f(x)$ 和解 $u(x)$ 的椭圆问题 $-u''(x) = f(x)$，已知中心有限差分格式产生的全局误差允许一个关于 $h$ 的偶数次幂的渐近展开。由于精确解 $u(x) = \\sin(k\\pi x)$ 和源项 $f(x) = k^2\\pi^2\\sin(k\\pi x)$ 是无限可微的（$C^\\infty$），这一假设是充分成立的。\n- **嵌套网格和一致的离散化**：问题通过设置细网格的内部点数 $m'$ 为 $2m+1$（其中 $m$ 是粗网格的内部点数）来明确定义细网格的间距为 $h' = h/2$。这种构造确保了网格是完美嵌套的。对两个网格使用相同的标准二阶模板满足了相容性要求。\n- **光滑泛函**：关注量 $Q$ 是解的点值，$Q[u] = u(x_0)$。这是一个线性的、性质良好的泛函。这个泛函的误差 $u_h(x_0) - u(x_0)$ 已知会继承解 $u_h$ 的全局误差的阶，这为其包含在展开式中提供了理由。\n- **非零 $C_p$ 和可忽略的舍入误差**：主误差常数 $C_p = C_2$ 与解的四阶导数 $u^{(4)}(x)$ 成正比。对于 $u(x) = \\sin(k\\pi x)$，我们有 $u^{(4)}(x) = (k\\pi)^4\\sin(k\\pi x)$。对于所有指定的测试用例，求值点 $x_0$ 的选择使得 $\\sin(k\\pi x_0) \\neq 0$，从而确保 $C_2 \\neq 0$。网格间距（$h=1/10$ 和 $h=1/4$）是适中的，因此在使用标准双精度浮点运算时，预计截断误差将主导舍入误差。\n\n**3. 数值实现**\n\n待解问题是在区域 $[0,1]$ 上的 $-u''(x) = f(x)$，边界条件为 $u(0)=0$ 和 $u(1)=0$。我们使用 $m$ 个内部网格点 $x_j = j h$（$j=1, 2, \\dots, m$）来离散该区域，其中 $h = 1/(m+1)$。\n\n在点 $x_j$ 处，$-u''$ 的二阶中心差分近似为：\n$$-u''(x_j) \\approx \\frac{-u(x_{j-1}) + 2u(x_j) - u(x_{j+1})}{h^2}$$\n设 $u_j$ 为 $u(x_j)$ 的数值近似。离散方程组为：\n$$\\frac{-u_{j-1} + 2u_j - u_{j+1}}{h^2} = f(x_j) \\quad \\text{for } j=1, \\dots, m$$\n边界条件 $u_0=0$ 和 $u_{m+1}=0$ 意味着 $u_0=0$ 和 $u_{m+1}=0$。该系统可以写成矩阵形式 $A\\mathbf{u} = \\mathbf{f}$，其中 $\\mathbf{u} = [u_1, u_2, \\dots, u_m]^T$，$\\mathbf{f} = [f(x_1), f(x_2), \\dots, f(x_m)]^T$。$m \\times m$ 矩阵 $A$ 是一个对称正定三对角矩阵：\n$$A = \\frac{1}{h^2} \\begin{pmatrix} 2  -1  0  \\dots  0 \\\\ -1  2  -1   \\vdots \\\\ 0  \\ddots  \\ddots  \\ddots  0 \\\\ \\vdots   -1  2  -1 \\\\ 0  \\dots  0  -1  2 \\end{pmatrix}$$\n对于每个测试用例，我们对粗网格（间距 $h$）和细网格（间距 $h/2$）执行以下步骤：\n1. 构建矩阵 $A$ 和右端向量 $\\mathbf{f}$。\n2. 求解线性系统 $A\\mathbf{u} = \\mathbf{f}$ 以获得数值解向量 $\\mathbf{u}$。\n3. 提取关注量。由于 $x_0$ 是一个网格点，对于某个整数 $j_0$ 有 $x_0 = j_0 h$。那么值 $Q$ 就是解向量 $\\mathbf{u}$ 的第 $j_0$ 个元素（考虑到基于 1 和基于 0 的索引，所以在 Python 中是 `u[j_0-1]`）。\n4. 计算出 $Q_h$ 和 $Q_{h/2}$ 后，我们应用上面推导的估计量公式来找到 $\\hat{C}_2$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a Richardson-based estimator for the leading \n    truncation error constant C_p for a finite difference scheme applied \n    to a 1D elliptic PDE.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (k, m_coarse, x_0)\n    # The order p=2 is fixed for all tests.\n    test_cases = [\n        (1, 9, 0.5),   # Test 1\n        (3, 9, 0.3),   # Test 2\n        (1, 3, 0.5),   # Test 3\n    ]\n\n    def compute_Q_at_x0(k, m, x0):\n        \"\"\"\n        Solves the discrete system -u''=f on a grid with m interior points\n        and returns the numerical solution at the point x0.\n\n        Args:\n            k (int): Wavenumber for the exact solution u(x) = sin(k*pi*x).\n            m (int): Number of interior grid points.\n            x0 (float): The point at which to extract the solution value.\n\n        Returns:\n            float: The numerical solution u_h(x0).\n        \"\"\"\n        # 1. Define grid parameters\n        h = 1.0 / (m + 1)\n        \n        # 2. Set up the linear system A*u = f_vec\n        \n        # Create the grid points\n        x_grid = np.linspace(h, 1.0 - h, m)\n        \n        # Create the right-hand side vector f_vec\n        f_vec = (k * np.pi)**2 * np.sin(k * np.pi * x_grid)\n        \n        # Create the tridiagonal matrix A\n        main_diag = 2.0 * np.ones(m)\n        off_diag = -1.0 * np.ones(m - 1)\n        A = (np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)) / h**2\n        \n        # 3. Solve the linear system\n        u_vec = np.linalg.solve(A, f_vec)\n        \n        # 4. Extract solution at x0\n        # The grid points are x_j = j*h for j=1, ..., m.\n        # The corresponding Python index is j-1.\n        # We need to find the index corresponding to x0.\n        # j0 = x0/h\n        # Since x0 is guaranteed to be a grid point, this should be an integer.\n        # Use rounding for floating point safety.\n        j0 = int(round(x0 / h))\n        \n        # The python index is j0-1\n        idx = j0 - 1\n        \n        # Check if index is valid\n        if idx  0 or idx >= m:\n            raise ValueError(f\"x0={x0} is not an interior grid point for m={m}, h={h}\")\n\n        return u_vec[idx]\n\n    results = []\n    p = 2  # The scheme is second order\n\n    for case in test_cases:\n        k, m_coarse, x0 = case\n        \n        # Grid parameters\n        m_fine = 2 * m_coarse + 1\n        h_coarse = 1.0 / (m_coarse + 1)\n        \n        # Compute the quantity of interest on coarse and fine grids\n        Q_h = compute_Q_at_x0(k, m_coarse, x0)\n        Q_h_half = compute_Q_at_x0(k, m_fine, x0)\n        \n        # Compute the estimator for the leading error constant C_p\n        # Formula: C_p_est = (2^p / (2^p - 1)) * (Q_h - Q_{h/2}) / h^p\n        numerator = Q_h - Q_h_half\n        denominator = h_coarse**p\n        factor = (2**p) / (2**p - 1)\n        \n        C_p_est = factor * numerator / denominator\n        results.append(C_p_est)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}