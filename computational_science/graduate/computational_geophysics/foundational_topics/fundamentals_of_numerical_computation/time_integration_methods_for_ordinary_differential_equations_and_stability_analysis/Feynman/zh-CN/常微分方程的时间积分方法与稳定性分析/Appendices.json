{
    "hands_on_practices": [
        {
            "introduction": "许多地球物理系统，例如地幔中的热化学过程，都包含在截然不同的时间尺度上发生的现象，这在数学上表现为刚性与非刚性项并存的常微分方程组。隐式-显式（IMEX）方法为这类问题提供了一种高效且自然的解决方案。本练习  将指导你推导一个简单的一阶IMEX格式，并通过线性稳定性分析来理解它为何能在不付出完全隐式方法高昂计算代价的情况下，成功地处理刚性问题。",
            "id": "3617586",
            "problem": "考虑一个计算地球物理学中出现的用于描述地幔中热化学场的半离散模型，其中平流是非刚性的，但成分弛豫是刚性的。在使用线方法进行空间离散化后，标量状态变量的时间演化由常微分方程 $y'(t) = f(y(t)) + g(y(t))$ 建模，其中 $f$ 代表非刚性的平流和源项贡献，而 $g$ 代表由快速局部平衡过程引起的刚性线性弛豫。假设 $f$ 和 $g$ 足够光滑，以允许使用一个相容的一阶时间积分器。\n\n任务1. 从用于非刚性项的前向欧拉法和用于刚性项的后向欧拉法的定义出发，推导出一个针对 $y'(t) = f(y(t)) + g(y(t))$ 的一阶隐式-显式（IMEX）欧拉格式，其中时间步长 $\\Delta t  0$。您的推导必须清楚地说明哪个项被显式处理，哪个项被隐式处理，并且必须提供一个用 $y^{n}$、$\\Delta t$、$f$ 和 $g$ 表示的 $y^{n+1}$ 的闭式更新表达式。\n\n任务2. 对所推导的 IMEX 欧拉格式在标量测试方程 $y'(t) = \\lambda y(t) + \\mu y(t)$ 上进行线性稳定性分析，其中 $\\lambda \\in \\mathbb{C}$ 模拟非刚性贡献，$\\mu \\in \\mathbb{C}$ 模拟刚性贡献，且 $\\operatorname{Re}(\\mu) \\ll 0$。令 $z = \\Delta t\\,\\lambda$ 和 $w = \\Delta t\\,\\mu$。推导单步放大因子 $R(z,w)$，使得 $y^{n+1} = R(z,w)\\,y^{n}$，并将 $R(z,w)$ 写成一个关于 $z$ 和 $w$ 的单一闭式解析表达式。基于 $R(z,w)$，讨论当 $w$ 满足 $\\operatorname{Re}(w)  0$ 且 $|w|$ 很大时，对刚性分量稳定性的影响。\n\n答案格式要求：提供 $R(z,w)$ 的单一闭式表达式作为最终答案。不需要进行数值计算，也不涉及单位。最终答案必须是精确的，而非近似的。",
            "solution": "首先验证问题，以确保其科学上合理、适定且客观。\n\n### 第一步：提取已知条件\n-   控制常微分方程 (ODE) 为 $y'(t) = f(y(t)) + g(y(t))$。\n-   $f(y(t))$ 代表非刚性贡献。\n-   $g(y(t))$ 代表刚性线性弛豫。\n-   时间步长为 $\\Delta t  0$。\n-   用于线性稳定性分析的标量测试方程为 $y'(t) = \\lambda y(t) + \\mu y(t)$。\n-   $\\lambda \\in \\mathbb{C}$ 对应于非刚性部分。\n-   $\\mu \\in \\mathbb{C}$ 对应于刚性部分，具有属性 $\\operatorname{Re}(\\mu) \\ll 0$。\n-   归一化参数定义为 $z = \\Delta t\\,\\lambda$ 和 $w = \\Delta t\\,\\mu$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是适定的，并且基于常微分方程数值方法的既定理论。这种涉及包含刚性和非刚性部分的分区 ODE 的设置是用于分析隐式-显式 (IMEX) 格式的典型模型。使用标量测试方程研究线性稳定性是数值分析中的一种标准、基本技术。诸如“刚性”、“非刚性”、“IMEX”和“放大因子”等术语和概念在该领域内都有明确的定义。问题陈述是自洽的、无歧义的，并且不违反任何科学原理或逻辑一致性。这是一个形式化的数学问题，存在唯一、可验证的解。\n\n### 第三步：结论与行动\n该问题被认定为有效。将提供完整解答。\n\n### 任务一：IMEX 欧拉格式的推导\n\n问题描述了一种一阶隐式-显式 (IMEX) 格式，也称为半隐式格式。其核心思想是根据 ODE 不同部分的特性，采用不同的时间步进方法来处理它们。具体来说，非刚性项 $f(y)$ 进行显式处理，而刚性项 $g(y)$ 进行隐式处理。\n\n我们从 ODE 开始：\n$$y'(t) = f(y(t)) + g(y(t))$$\n设 $y^n$ 是解 $y(t_n)$ 在时间 $t_n = n \\Delta t$ 的数值近似。我们使用一阶前向差分来近似时间导数：\n$$y'(t_n) \\approx \\frac{y^{n+1} - y^n}{\\Delta t}$$\n将其代入 ODE，我们使用 IMEX 方法计算右侧项。非刚性项 $f$ 在当前已知的时间层 $t_n$ 上进行计算，这是一种显式处理（具体来说，是前向欧拉法）。刚性项 $g$ 在未来未知的时间层 $t_{n+1}$ 上进行计算，这是一种隐式处理（具体来说，是后向欧拉法）。这得到了以下离散方程：\n$$\\frac{y^{n+1} - y^n}{\\Delta t} = f(y^n) + g(y^{n+1})$$\n问题陈述 $g$ 代表“刚性线性弛豫”，这意味着 $g$ 是其自变量的线性函数。因此，我们可以写成 $g(y) = G y$，其中 $G$ 是某个线性算子。在多维系统中，$G$ 将是一个矩阵。将 $g$ 的这种线性形式代入我们的格式中得到：\n$$\\frac{y^{n+1} - y^n}{\\Delta t} = f(y^n) + G y^{n+1}$$\n为了找到 $y^{n+1}$ 的闭式更新，我们重新整理方程，将 $y^{n+1}$ 分离到一边。首先，乘以 $\\Delta t$：\n$$y^{n+1} - y^n = \\Delta t f(y^n) + \\Delta t G y^{n+1}$$\n接下来，将所有包含 $y^{n+1}$ 的项移到左边，所有其他项移到右边：\n$$y^{n+1} - \\Delta t G y^{n+1} = y^n + \\Delta t f(y^n)$$\n在左边提出 $y^{n+1}$ 的公因子。这涉及到单位算子 $I$：\n$$(I - \\Delta t G) y^{n+1} = y^n + \\Delta t f(y^n)$$\n最后，为了解出 $y^{n+1}$，我们将算子 $(I - \\Delta t G)$ 的逆作用于方程两边：\n$$y^{n+1} = (I - \\Delta t G)^{-1} \\left( y^n + \\Delta t f(y^n) \\right)$$\n这就是应用于具有线性刚性部分的 ODE 的一阶 IMEX 欧拉格式的闭式更新。\n\n### 任务二：线性稳定性分析\n\n我们现在对标量测试方程进行线性稳定性分析：\n$$y'(t) = \\lambda y(t) + \\mu y(t)$$\n在这里，非刚性贡献被确定为 $f(y) = \\lambda y$，刚性线性贡献被确定为 $g(y) = \\mu y$。对于这种标量情况，算子 $G$ 只是乘以复数 $\\mu$，单位算子 $I$ 是乘以 $1$。\n\n我们将推导出的 IMEX 欧拉格式应用于此测试方程。将 $f(y^n) = \\lambda y^n$ 和 $g(y^{n+1}) = \\mu y^{n+1}$ 代入格式的基本形式：\n$$\\frac{y^{n+1} - y^n}{\\Delta t} = \\lambda y^n + \\mu y^{n+1}$$\n我们的目标是找到放大因子 $R(z,w)$，使得 $y^{n+1} = R(z,w) y^n$。我们重新整理方程以 $y^n$ 表示 $y^{n+1}$：\n$$y^{n+1} - y^n = \\Delta t \\lambda y^n + \\Delta t \\mu y^{n+1}$$\n$$y^{n+1} - \\Delta t \\mu y^{n+1} = y^n + \\Delta t \\lambda y^n$$\n提出 $y^{n+1}$ 和 $y^n$ 的公因子：\n$$y^{n+1} (1 - \\Delta t \\mu) = y^n (1 + \\Delta t \\lambda)$$\n分离出 $y^{n+1}$ 得到：\n$$y^{n+1} = \\left( \\frac{1 + \\Delta t \\lambda}{1 - \\Delta t \\mu} \\right) y^n$$\n根据定义，放大因子就是括号中的项。使用给定的代换 $z = \\Delta t \\lambda$ 和 $w = \\Delta t \\mu$，我们得到 $R(z,w)$ 的表达式：\n$$R(z,w) = \\frac{1 + z}{1 - w}$$\n格式的稳定性要求 $|R(z,w)| \\le 1$。问题要求讨论关于刚性分量的稳定性影响，其中 $\\operatorname{Re}(\\mu) \\ll 0$ 且 $|w|$ 很大。\n因为 $\\Delta t > 0$，所以 $\\operatorname{Re}(\\mu)  0$ 意味着 $\\operatorname{Re}(w)  0$。仅对刚性分量而言的稳定区域（通过设置 $z=0$）由 $|R(0,w)| = |\\frac{1}{1-w}| \\le 1$ 给出，可简化为 $|1-w| \\ge 1$。这个区域是在复平面上以 $w=1$ 为中心的单位圆的外部。该区域包含了整个左半平面，即 $\\{w \\in \\mathbb{C} \\mid \\operatorname{Re}(w) \\le 0\\}$。由于我们的刚性分量满足 $\\operatorname{Re}(w)  0$，该方法对于刚性部分是无条件稳定的。这个性质被称为 A-稳定性。\n当 $|w| \\to \\infty$（同时保持 $\\operatorname{Re}(w)0$），分母 $|1-w| \\to \\infty$。因此，对于任何固定的 $z$，放大因子的模趋近于零：\n$$\\lim_{|w|\\to\\infty, \\operatorname{Re}(w)0} |R(z,w)| = \\lim_{|w|\\to\\infty} \\frac{|1+z|}{|1-w|} = 0$$\n这表明该方法对于无限刚性的分量不仅是稳定的，而且是强耗散的（L-稳定的）。时间步长 $\\Delta t$ 不受刚性参数 $\\mu$ 的限制，而是受非刚性参数 $\\lambda$ 的限制，其稳定区域 $|1+z| \\le |1-w|$ 类似于显式前向欧拉法的稳定区域。这是使用 IMEX 格式的主要动机。\n所要求的最终答案是 $R(z,w)$ 的闭式表达式。",
            "answer": "$$\\boxed{\\frac{1+z}{1-w}}$$"
        },
        {
            "introduction": "学习了IMEX方法后，理解其应用场景至关重要。本练习  采用了地球物理流体动力学的基石——线性化浅水方程。通过对该方程组进行空间离散和傅里叶分析，你将能直接识别出系统中的“快”重力波和“慢”地转/惯性模态，这个过程为刚性与多时间尺度的抽象概念赋予了具体的物理意义，并揭示了为何最快的波会决定显式方法稳定性的上限，从而激发了使用更高级积分器的需求。",
            "id": "3617571",
            "problem": "考虑一个$f$平面上的一维线性化浅水方程，其自由表面位移$\\,\\eta(x,t)\\,$很小，水平速度分量为$\\,u(x,t)\\,$（纬向）和$\\,v(x,t)\\,$（经向），平均深度$\\,H0\\,$、重力加速度$\\,g0\\,$和科里奥利参数$\\,f\\,$均为常数。连续系统为\n$$\n\\eta_{t} + H\\,u_{x} = 0,\\qquad\nu_{t} + g\\,\\eta_{x} - f\\,v = 0,\\qquad\nv_{t} + f\\,u = 0,\n$$\n其中下标表示偏导数。使用二阶中心差分对空间导数进行离散化，在长度为$\\,L\\,$的周期性域上，有$\\,N\\,$个均匀间隔的网格点，间距为$\\,h=L/N\\,$。对于堆叠状态向量$\\,\\mathbf{y}=[\\eta_{1},\\dots,\\eta_{N},\\,u_{1},\\dots,u_{N},\\,v_{1},\\dots,v_{N}]^{\\mathsf{T}}\\,$，将半离散的线方法（MOL）常微分方程（ODE）写成紧凑形式$\\,\\dot{\\mathbf{y}}=\\mathbf{J}\\,\\mathbf{y}\\,$。\n\n任务：\n- 明确推导MOL ODE $\\,\\dot{\\mathbf{y}}=\\mathbf{J}\\,\\mathbf{y}\\,$，用作用于$\\,u\\,$和$\\,\\eta\\,$的二阶中心差分算子表示。\n- 在周期性边界条件下，使用离散傅里叶分析，求出符号$\\,\\mathbf{J}(\\theta)\\,$的特征值，其中离散傅里叶模式的无量纲波数为$\\,\\theta=2\\pi m/N\\,$，且$\\,m\\in\\{0,1,\\dots,N-1\\}\\,$。识别哪些特征值是快的，哪些是慢的，这取决于它们在离散谱中虚部的大小。\n- 推断这些快、慢特征值对计算地球物理学中振荡问题的显式时间步长稳定性约束的定性影响，重点关注最大的虚部大小如何控制最严格的显式时间步长。\n\n提供$\\,\\mathbf{J}\\,$的所有离散傅里叶模式特征值虚部的最大值的闭式解析表达式，用$\\,g\\,$, $\\,H\\,$, $\\,h\\,$和$\\,f\\,$表示。最终答案以无单位的符号表达式形式给出。",
            "solution": "该问题是有效的。这是一个计算地球物理学领域的适定问题，具体涉及应用于线性化浅水方程的数值方法的稳定性分析。所有前提都具有科学依据，并为求解提供了所有必要信息。\n\n一维线性化浅水方程的连续系统由以下公式给出：\n$$\n\\eta_{t} + H\\,u_{x} = 0\n$$\n$$\nu_{t} + g\\,\\eta_{x} - f\\,v = 0\n$$\n$$\nv_{t} + f\\,u = 0\n$$\n\n每个网格点 $j$ 处的状态向量为 $(\\eta_j, u_j, v_j)^{\\mathsf{T}}$。该域是周期性的，长度为 $L$，并被离散化为 $N$ 个点，网格间距为 $h=L/N$。\n\n**任务1：推导线方法（MOL）常微分方程**\n我们使用二阶中心差分算子对空间导数进行离散化：\n$$\n\\left(\\frac{\\partial w}{\\partial x}\\right)_{j} \\approx \\frac{w_{j+1} - w_{j-1}}{2h}\n$$\n将此应用于偏微分方程组，我们得到一个关于每个网格点 $j \\in \\{1, \\dots, N\\}$ 处变量的常微分方程（ODE）组。周期性边界条件意味着索引按模 $N$ 解释；例如，$u_{N+1} = u_1$ 和 $u_{0} = u_N$。\n\n半离散化系统为：\n$$\n\\frac{d\\eta_j}{dt} = -H \\left(\\frac{u_{j+1} - u_{j-1}}{2h}\\right)\n$$\n$$\n\\frac{du_j}{dt} = -g \\left(\\frac{\\eta_{j+1} - \\eta_{j-1}}{2h}\\right) + fv_j\n$$\n$$\n\\frac{dv_j}{dt} = -fu_j\n$$\n这个包含 $3N$ 个耦合ODE的系统表示了状态向量 $\\mathbf{y}=[\\eta_{1},\\dots,\\eta_{N},\\,u_{1},\\dots,u_{N},\\,v_{1},\\dots,v_{N}]^{\\mathsf{T}}$ 的MOL形式 $\\dot{\\mathbf{y}}=\\mathbf{J}\\,\\mathbf{y}$。矩阵 $\\mathbf{J}$ 是一个大的稀疏块矩阵，由代表中心差分算子的循环块和代表科里奥利项的单位矩阵组成。\n\n**任务2：符号 $\\mathbf{J}(\\theta)$ 的特征值**\n为了找到 $\\mathbf{J}$ 的特征值，我们进行离散傅里叶分析。我们考虑一个单一傅里叶模式，其形式如下：\n$$\n\\begin{pmatrix} \\eta_j(t) \\\\ u_j(t) \\\\ v_j(t) \\end{pmatrix} = \\begin{pmatrix} \\hat{\\eta}(k) \\\\ \\hat{u}(k) \\\\ \\hat{v}(k) \\end{pmatrix} e^{i(kx_j - \\omega t)}\n$$\n其中 $x_j=jh$ 是第 $j$ 个网格点的位置，$k$ 是波数。由于在有 $N$ 个点的网格上具有周期性，离散波数为 $k = 2\\pi m / L = 2\\pi m / (Nh)$，其中整数 $m \\in \\{0, 1, \\dots, N-1\\}$。时间导数为 $\\frac{d}{dt} \\to -i\\omega$。问题要求雅可比矩阵 $\\mathbf{J}$ 的特征值，我们将其记为 $\\lambda = -i\\omega$。因此，$\\frac{d}{dt} \\to \\lambda$。\n\n中心差分算子对傅里叶模式的作用是：\n$$\n\\frac{w_{j+1} - w_{j-1}}{2h} = \\frac{\\hat{w}e^{ik(j+1)h} - \\hat{w}e^{ik(j-1)h}}{2h} = \\frac{\\hat{w}e^{ikjh}}{2h}(e^{ikh} - e^{-ikh}) = \\hat{w}e^{ikjh} \\left(\\frac{2i\\sin(kh)}{2h}\\right) = \\frac{i\\sin(kh)}{h} w_j\n$$\n将傅里叶模式代入半离散化方程，我们得到一个关于傅里叶振幅 $(\\hat{\\eta}, \\hat{u}, \\hat{v})^{\\mathsf{T}}$ 的系统：\n$$\n\\lambda \\hat{\\eta} = -H \\left(\\frac{i\\sin(kh)}{h}\\right) \\hat{u}\n$$\n$$\n\\lambda \\hat{u} = -g \\left(\\frac{i\\sin(kh)}{h}\\right) \\hat{\\eta} + f\\hat{v}\n$$\n$$\n\\lambda \\hat{v} = -f\\hat{u}\n$$\n这可以写成矩阵方程 $\\lambda \\hat{\\mathbf{y}} = \\hat{\\mathbf{J}}(k) \\hat{\\mathbf{y}}$，其中 $\\hat{\\mathbf{y}}=(\\hat{\\eta}, \\hat{u}, \\hat{v})^{\\mathsf{T}}$，$\\hat{\\mathbf{J}}(k)$ 是雅可比算子对于波数 $k$ 的 $3 \\times 3$ 符号：\n$$\n\\hat{\\mathbf{J}}(k) = \\begin{pmatrix}\n0   -H \\frac{i\\sin(kh)}{h}   0 \\\\\n-g \\frac{i\\sin(kh)}{h}   0   f \\\\\n0   -f   0\n\\end{pmatrix}\n$$\n$\\hat{\\mathbf{J}}(k)$ 的特征值 $\\lambda$ 由特征方程 $\\det(\\hat{\\mathbf{J}}(k) - \\lambda\\mathbf{I}) = 0$ 求得：\n$$\n\\det \\begin{pmatrix}\n-\\lambda   -H \\frac{i\\sin(kh)}{h}   0 \\\\\n-g \\frac{i\\sin(kh)}{h}   -\\lambda   f \\\\\n0   -f   -\\lambda\n\\end{pmatrix} = 0\n$$\n展开行列式：\n$$\n-\\lambda \\left( (-\\lambda)(-\\lambda) - (f)(-f) \\right) - \\left(-H \\frac{i\\sin(kh)}{h}\\right) \\left( \\left(-g \\frac{i\\sin(kh)}{h}\\right)(-\\lambda) - 0 \\right) = 0\n$$\n$$\n-\\lambda(\\lambda^2 + f^2) + H \\frac{i\\sin(kh)}{h} \\left(\\lambda g \\frac{i\\sin(kh)}{h}\\right) = 0\n$$\n$$\n-\\lambda(\\lambda^2 + f^2) - \\lambda gH \\frac{\\sin^2(kh)}{h^2} = 0\n$$\n$$\n-\\lambda \\left( \\lambda^2 + f^2 + gH \\frac{\\sin^2(kh)}{h^2} \\right) = 0\n$$\n该方程为每个波数 $k$ 产生三个特征值：\n1.  $\\lambda_0 = 0$\n2.  $\\lambda^2 = - \\left( f^2 + gH \\frac{\\sin^2(kh)}{h^2} \\right) \\implies \\lambda_{\\pm} = \\pm i \\sqrt{f^2 + gH \\frac{\\sin^2(kh)}{h^2}}$\n\n使用问题中的记号 $\\theta = kh = 2\\pi m/N$，符号 $\\mathbf{J}(\\theta)$ 的特征值为：\n$$\n\\lambda_0 = 0, \\qquad \\lambda_{\\pm}(\\theta) = \\pm i \\sqrt{f^2 + gH \\frac{\\sin^2(\\theta)}{h^2}}\n$$\n\n**任务3：快、慢特征值及其对稳定性的影响**\n特征值表示离散模式的增长率（实部）和振荡频率（虚部）。在这里，所有特征值都是纯虚数，对应于纯振荡行为。\n\n-   特征值 $\\lambda_0 = 0$ 对应一个静止模式。这代表了地转平衡的离散版本，它是一个稳态。这是可能的最“慢”模式。\n-   特征值 $\\lambda_{\\pm}$ 对应于离散的惯性重力波。它们的振荡频率为 $\\omega_k = |\\operatorname{Im}(\\lambda_{\\pm})| = \\sqrt{f^2 + gH \\frac{\\sin^2(kh)}{h^2}}$。\n-   “慢”波是频率较低的波。对于长波（$k \\to 0$），$\\sin(kh) \\approx kh$，频率趋近于 $\\omega_k \\approx \\sqrt{f^2 + gHk^2}$。当 $k \\to 0$ 时，$\\omega_k \\to |f|$，即惯性振荡的频率。这些是相对较慢的。\n-   “快”波是频率较高的波。当项 $\\sin^2(kh)$ 最大化时，频率 $\\omega_k$ 也达到最大值。这些高频模式对应于离散的重力波。\n\n对于一个显式时间积分方案（例如，前向欧拉法、龙格-库塔法），其稳定性由一个 Courant-Friedrichs-Lewy (CFL) 型条件控制。时间步长 $\\Delta t$ 必须足够小，以解析系统中最快的振荡。对于振荡问题，显式方案的稳定区域要求 $|\\lambda| \\Delta t \\le C$，其中 $C$ 是特定于该方案的常数（虚轴上的“稳定性边界”）。这意味着最大允许时间步长受到最大模特征值的限制：\n$$\n\\Delta t \\le \\frac{C}{\\max_k |\\lambda_k|}\n$$\n在我们的情况下，特征值是纯虚数，所以 $|\\lambda| = |\\operatorname{Im}(\\lambda)|$。对 $\\Delta t$ 最严格的约束来自虚部最大的特征值，它对应于离散化系统中最快的波。我们必须在所有离散波数上找到 $\\omega_k$ 的最大值。\n\n为了找到这个最大值，我们需要将 $\\omega_k$ 的表达式最大化：\n$$\n\\max_k \\left( \\sqrt{f^2 + gH \\frac{\\sin^2(kh)}{h^2}} \\right)\n$$\n由于 $f^2$, $g$, $H$ 和 $h^2$ 都是正常数，最大化此表达式等同于在允许的离散波数 $k = 2\\pi m/(Nh)$（其中 $m \\in \\{0, 1, \\dots, N-1\\}$）上最大化 $\\sin^2(kh)$ 项。函数 $\\sin^2(x)$ 的最大值为 $1$。当其参数 $x$ 是 $\\pi/2$ 的奇数倍时，达到此最大值。对于足够大的网格尺寸 $N$，将存在一个离散模式 $m$，使得 $kh = 2\\pi m/N$ 非常接近 $\\pi/2$，甚至可能精确等于它（如果 $N$ 是 $4$ 的倍数）。在确定最严格稳定性极限的背景下，我们考虑在可表示波数的连续谱上的绝对最大值。因此，我们将 $\\sin^2(kh)$ 的最大值取为 $1$。\n\n因此，特征值虚部的最大值为：\n$$\n|\\operatorname{Im}(\\lambda)|_{\\text{max}} = \\sqrt{f^2 + gH \\frac{1}{h^2}} = \\sqrt{f^2 + \\frac{gH}{h^2}}\n$$\n这就是所要求的最终表达式。它表明，稳定性极限是由旋转频率 $f$ 和网格上可解析的最快重力波的频率共同决定的，后者的速度由 $\\sqrt{gH}$ 表征，波长由网格间距 $h$ 表征。",
            "answer": "$$\\boxed{\\sqrt{f^{2} + \\frac{gH}{h^{2}}}}$$"
        },
        {
            "introduction": "在前两个练习的基础上，我们将探索一种功能更强大的多物理场问题求解策略：算子分裂法。本练习  介绍了一个反应输运模型，其中不同的物理过程（输运与反应）由不同的算子控制。你将学习如何设计一个分裂步长格式，分析每个子步骤的稳定性，并通过计算算子间的对易子来量化关键的*分裂误差*。这个高级练习突出了在为复杂地球物理系统设计稳健数值模型时，稳定性和精度之间必须进行的权衡。",
            "id": "3617594",
            "problem": "考虑在区间 $\\left[0,L\\right]$（其中 $L=1$）上的一个一维、周期性、双物种反应输运模型。使用一个包含 $N=100$ 个点的均匀网格，网格间距为 $\\Delta x=L/N$。令 $\\mathbf{u}(x,t)\\in\\mathbb{R}^{2}$ 表示物种浓度。通过线方法进行半离散化后，网格单元浓度的演化由以下线性常微分方程控制\n$$\n\\frac{d\\mathbf{y}}{dt}=\\left(A+B\\right)\\mathbf{y},\n$$\n其中 $A$ 代表平流-扩散输运，$B$ 代表局部反应。输运算子为\n$$\nA=A_{\\mathrm{adv}}\\otimes I_{2}+L\\otimes D,\n$$\n其中 $A_{\\mathrm{adv}}$ 是针对恒定速度 $c=0.1$ 的一阶迎风离散平流算子，$I_{2}$ 是作用于物种的 $2\\times 2$ 单位矩阵，$L$ 是具有周期性边界条件的二阶中心有限差分离散拉普拉斯算子，以及 $D=\\mathrm{diag}\\!\\left(\\kappa_{1},\\kappa_{2}\\right)$，其中 $\\kappa_{1}=10^{-3}$ 且 $\\kappa_{2}=5\\times 10^{-4}$。反应算子在网格单元上是块对角的，\n$$\nB=I_{N}\\otimes R,\n$$\n其刚性反应矩阵为\n$$\nR=\\begin{pmatrix}\n-500   200\\\\\n50   -300\n\\end{pmatrix}.\n$$\n每个时间步长使用 Lie 分裂法：首先应用反应子步（通过后向欧拉法求解），然后应用输运子步（通过具有 $s=20$ 个阶段的显式稳定 Runge–Kutta–Chebyshev (RKC) 方法求解）。对于显式稳定 RKC 方法，一个经过充分检验的事实是，沿负实轴的线性稳定区间近似按 $\\left[-2s^{2},0\\right]$ 比例缩放。对于周期性网格上间距为 $\\Delta x$ 的离散拉普拉斯算子 $L$，其特征值为 $\\mu(k)=\\frac{4}{\\Delta x^{2}}\\sin^{2}\\!\\left(\\frac{\\pi k}{N}\\right)$（其中 $k=0,1,\\dots,N-1$），谱半径为 $\\mu_{\\max}=\\frac{4}{\\Delta x^{2}}$。\n\n假设对于所选的参数和阶段数，平流对稳定性约束的贡献与扩散相比可以忽略不计。时间步长 $h$ 的选择必须同时满足以下两个条件：\n\n- 使用最大的扩散特征值，满足显式稳定输运子步的实轴稳定性要求。\n- 对每步的主阶局部算子分裂误差进行限制，该误差界由 Baker–Campbell–Hausdorff 级数和对易子 $[A,B]$ 导出，要求局部算子分裂误差范数与初始范数之比不超过预设容差 $\\varepsilon=10^{-2}$。\n\n计算满足这两个约束的最大时间步长 $h$（以秒为单位）。将您的答案四舍五入到四位有效数字，并以秒为单位表示。",
            "solution": "该问题要求找到 Lie 分裂格式所能允许的最大时间步长 $h$，该步长需满足两个不同的约束：一个关乎显式输运子步的稳定性，另一个关乎算子分裂的精度。我们将分别确定每个约束所允许的最大时间步长 $h_{\\text{stability}}$ 和 $h_{\\text{error}}$。总的最大允许时间步长将是这两个值的最小值，即 $h = \\min(h_{\\text{stability}}, h_{\\text{error}})$。\n\n首先，我们确定给定参数。区域长度 $L=1$，用 $N=100$ 个点进行离散化，因此网格间距为 $\\Delta x = L/N = 1/100 = 0.01$。扩散系数为 $\\kappa_1 = 10^{-3}$ 和 $\\kappa_2 = 5 \\times 10^{-4}$。显式输运子步使用具有 $s=20$ 个阶段的 RKC 方法求解。算子分裂误差容差为 $\\varepsilon = 10^{-2}$。\n\n**约束 1：输运子步的稳定性**\n\n输运子步涉及使用显式 RKC 方法求解常微分方程 $\\frac{d\\mathbf{z}}{dt} = A\\mathbf{z}$。该方法的稳定性取决于算子 $A$ 的特征值。问题指明，在稳定性分析中可以忽略平流的贡献，因此我们只考虑算子的扩散部分，即 $A \\approx L \\otimes D$。\n\nKronecker 积 $L \\otimes D$ 的特征值是 $L$ 和 $D$ 的特征值的乘积。\n对角矩阵 $D = \\mathrm{diag}(\\kappa_1, \\kappa_2)$ 的特征值是其对角线元素，即 $\\kappa_1=10^{-3}$ 和 $\\kappa_2=5 \\times 10^{-4}$。\n问题陈述了周期性网格上离散拉普拉斯算子 $L$ 的特征值为 $\\mu(k) = \\frac{4}{\\Delta x^2}\\sin^2(\\frac{\\pi k}{N})$，其中 $k=0, \\dots, N-1$。然而，离散拉普拉斯算子是负半定的，意味着其特征值必须是非正的。所给公式对应于特征值的模。正确的表达式应为 $\\mu_k = -\\frac{4}{\\Delta x^2}\\sin^2(\\frac{\\pi k}{N})$。这与为 RKC 方法指定的稳定性区域位于负实轴上是一致的。\n\n因此，扩散算子 $L \\otimes D$ 的特征值为 $\\lambda_{k,j} = \\mu_k \\kappa_j$，它们都是实数且非正。显式格式的稳定性由最负的特征值 $\\lambda_{\\min}$（即模最大的特征值）决定。这对应于 $L$ 的模最大的特征值和 $D$ 的最大特征值。\n\n$L$ 的谱半径为 $\\rho(L) = \\max_k |\\mu_k|$。当 $k=N/2$ 时（因为 $N=100$ 是偶数），$\\sin^2(\\pi(N/2)/N) = \\sin^2(\\pi/2) = 1$，所以模最大的特征值是 $\\lambda_{\\min}(L) = -4/\\Delta x^2$。\n数值上，$\\lambda_{\\min}(L) = -\\frac{4}{(0.01)^2} = -\\frac{4}{10^{-4}} = -4 \\times 10^4$。\n最大的扩散系数为 $\\kappa_{\\max} = \\max(\\kappa_1, \\kappa_2) = 10^{-3}$。\n\n近似输运算子的最负特征值为：\n$$\n\\lambda_{\\min}(L \\otimes D) = \\lambda_{\\min}(L) \\cdot \\kappa_{\\max} = (-4 \\times 10^4) \\cdot (10^{-3}) = -40\n$$\n具有 $s=20$ 个阶段的 RKC 方法的稳定性区间近似为 $[-2s^2, 0]$。稳定性条件要求时间步长 $h$ 与系统矩阵的任意特征值 $\\lambda$ 的乘积位于此区间内。对于最严格的特征值 $\\lambda_{\\min}(L \\otimes D)$，我们需要：\n$$\nh \\cdot \\lambda_{\\min}(L \\otimes D) \\ge -2s^2\n$$\n$$\nh \\cdot (-40) \\ge -2 \\cdot (20)^2 = -2 \\cdot 400 = -800\n$$\n求解 $h$，我们得到由稳定性施加的限制：\n$$\nh \\le \\frac{-800}{-40} = 20\n$$\n因此，$h_{\\text{stability}} = 20$ 秒。\n\n**约束 2：算子分裂误差**\n\nLie 分裂格式是一种一阶算子分裂方法。单个时间步长 $h$ 的局部误差由 Baker-Campbell-Hausdorff (BCH) 公式给出。精确的演化算子是 $\\exp(h(A+B))$，而 Lie 分裂算子是 $\\exp(hB)\\exp(hA)$。主阶误差项为：\n$$\n\\mathcal{E}(h) = \\exp(hB)\\exp(hA) - \\exp(h(A+B)) \\approx -\\frac{h^2}{2}[A,B]\n$$\n其中 $[A,B] = AB-BA$ 是算子的对易子。约束条件是局部误差向量的范数相对于解的范数不得超过 $\\varepsilon$：\n$$\n\\frac{\\|-\\frac{h^2}{2}[A,B]\\mathbf{y}\\|}{\\|\\mathbf{y}\\|} \\le \\varepsilon\n$$\n这可以由 $\\frac{h^2}{2}\\|[A,B]\\| \\le \\varepsilon$ 来界定。我们将使用谱范数（2-范数）。因此对 $h$ 的约束为：\n$$\nh \\le \\sqrt{\\frac{2\\varepsilon}{\\|[A,B]\\|_2}}\n$$\n我们需要计算对易子 $[A,B]$。给定 $A = A_{\\mathrm{adv}} \\otimes I_2 + L \\otimes D$ 和 $B = I_N \\otimes R$，我们利用 Kronecker 积的性质：\n$$\nAB = (A_{\\mathrm{adv}} \\otimes I_2 + L \\otimes D)(I_N \\otimes R) = A_{\\mathrm{adv}} \\otimes R + L \\otimes (DR)\n$$\n$$\nBA = (I_N \\otimes R)(A_{\\mathrm{adv}} \\otimes I_2 + L \\otimes D) = A_{\\mathrm{adv}} \\otimes R + L \\otimes (RD)\n$$\n对易子为：\n$$\n[A,B] = AB - BA = (A_{\\mathrm{adv}} \\otimes R + L \\otimes DR) - (A_{\\mathrm{adv}} \\otimes R + L \\otimes RD) = L \\otimes (DR - RD) = L \\otimes [D,R]\n$$\n现在我们计算矩阵对易子 $[D,R]$：\n$D = \\begin{pmatrix} 10^{-3}   0 \\\\ 0   5 \\times 10^{-4} \\end{pmatrix}$， $R = \\begin{pmatrix} -500   200 \\\\ 50   -300 \\end{pmatrix}$。\n$$\nDR = \\begin{pmatrix} 10^{-3}   0 \\\\ 0   5 \\times 10^{-4} \\end{pmatrix} \\begin{pmatrix} -500   200 \\\\ 50   -300 \\end{pmatrix} = \\begin{pmatrix} -0.5   0.2 \\\\ 0.025   -0.15 \\end{pmatrix}\n$$\n$$\nRD = \\begin{pmatrix} -500   200 \\\\ 50   -300 \\end{pmatrix} \\begin{pmatrix} 10^{-3}   0 \\\\ 0   5 \\times 10^{-4} \\end{pmatrix} = \\begin{pmatrix} -0.5   0.1 \\\\ 0.05   -0.15 \\end{pmatrix}\n$$\n$$\n[D,R] = DR - RD = \\begin{pmatrix} 0   0.1 \\\\ -0.025   0 \\end{pmatrix}\n$$\n接下来，我们求解范数 $\\|[A,B]\\|_2 = \\|L \\otimes [D,R]\\|_2$。利用性质 $\\|P \\otimes Q\\|_2 = \\|P\\|_2 \\|Q\\|_2$：\n$\\|L\\|_2 = \\rho(L) = \\frac{4}{\\Delta x^2} = \\frac{4}{(0.01)^2} = 4 \\times 10^4$。\n为了找到 $\\|[D,R]\\|_2$，我们计算其最大的奇异值，即 $[D,R]^T[D,R]$ 最大特征值的平方根。令 $C = [D,R]$。\n$$\nC^T C = \\begin{pmatrix} 0   -0.025 \\\\ 0.1   0 \\end{pmatrix} \\begin{pmatrix} 0   0.1 \\\\ -0.025   0 \\end{pmatrix} = \\begin{pmatrix} (-0.025)^2   0 \\\\ 0   (0.1)^2 \\end{pmatrix} = \\begin{pmatrix} 6.25 \\times 10^{-4}   0 \\\\ 0   10^{-2} \\end{pmatrix}\n$$\n特征值为 $6.25 \\times 10^{-4}$ 和 $10^{-2}$。最大的是 $10^{-2}$。\n$\\|[D,R]\\|_2 = \\sqrt{10^{-2}} = 0.1$。\n所以，完整对易子的范数为：\n$$\n\\|[A,B]\\|_2 = \\|L\\|_2 \\cdot \\|[D,R]\\|_2 = (4 \\times 10^4) \\cdot 0.1 = 4 \\times 10^3\n$$\n现在我们可以根据误差约束计算时间步长的限制：\n$$\nh^2 \\le \\frac{2\\varepsilon}{\\|[A,B]\\|_2} = \\frac{2 \\cdot 10^{-2}}{4 \\times 10^3} = 0.5 \\times 10^{-5} = 5 \\times 10^{-6}\n$$\n$$\nh \\le \\sqrt{5 \\times 10^{-6}} = \\sqrt{5} \\times 10^{-3} \\approx 2.2360679... \\times 10^{-3}\n$$\n因此，$h_{\\text{error}} \\approx 2.236 \\times 10^{-3}$ 秒。\n\n**结论**\n\n我们必须同时满足两个约束，因此最大允许时间步长 $h$ 是两个导出边界的最小值：\n$$\nh_{\\max} = \\min(h_{\\text{stability}}, h_{\\text{error}}) = \\min(20, 2.236 \\times 10^{-3}) = 2.236 \\times 10^{-3}\n$$\n算子分裂误差是限制因素。问题要求将答案四舍五入到四位有效数字。\n$h_{\\max} \\approx 2.236 \\times 10^{-3}$ 秒。",
            "answer": "$$\\boxed{2.236 \\times 10^{-3}}$$"
        }
    ]
}