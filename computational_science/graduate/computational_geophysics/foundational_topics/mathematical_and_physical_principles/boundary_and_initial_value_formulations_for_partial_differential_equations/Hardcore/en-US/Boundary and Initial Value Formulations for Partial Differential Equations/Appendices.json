{
    "hands_on_practices": [
        {
            "introduction": "The Courant–Friedrichs–Lewy (CFL) condition is a fundamental stability constraint for explicit numerical methods that solve hyperbolic partial differential equations, such as the wave equation. This exercise is essential for understanding why the time step and grid spacing in a simulation are intimately linked to the physical wave speed of the medium. By deriving the CFL condition using von Neumann stability analysis, you will gain a practical understanding of numerical instability and learn why boundary conditions do not necessarily relax the constraints imposed by the interior computational stencil .",
            "id": "3578541",
            "problem": "Consider linear acoustic wave propagation in a homogeneous, isotropic medium of constant wavespeed $c$ occupying a $d$-dimensional rectangular domain $\\Omega = [0,L]^{d}$, with homogeneous Dirichlet boundary conditions $u(\\mathbf{x},t) = 0$ for all $\\mathbf{x} \\in \\partial \\Omega$ and $t \\ge 0$, and smooth initial conditions $u(\\mathbf{x},0) = f(\\mathbf{x})$ and $u_{t}(\\mathbf{x},0) = g(\\mathbf{x})$. The governing partial differential equation is the second-order hyperbolic wave equation $u_{tt}(\\mathbf{x},t) = c^{2} \\nabla^{2} u(\\mathbf{x},t)$.\n\nOn a uniform Cartesian grid with mesh spacing $\\Delta x$ in each coordinate direction, discretize space with the standard second-order centered finite-difference Laplacian and time with the standard second-order centered three-level explicit update. For interior grid indices $\\mathbf{j} = (j_{1},\\dots,j_{d})$ and time levels $t^{n} = n \\Delta t$, the scheme reads\n$$\nu_{\\mathbf{j}}^{n+1} \\;=\\; 2 u_{\\mathbf{j}}^{n} \\;-\\; u_{\\mathbf{j}}^{n-1} \\;+\\; c^{2} \\Delta t^{2} \\sum_{m=1}^{d} \\frac{u_{\\mathbf{j}+\\mathbf{e}_{m}}^{n} \\;-\\; 2 u_{\\mathbf{j}}^{n} \\;+\\; u_{\\mathbf{j}-\\mathbf{e}_{m}}^{n}}{\\Delta x^{2}},\n$$\nwhere $\\mathbf{e}_{m}$ is the unit index vector in the $m$-th coordinate direction. Impose homogeneous Dirichlet boundary conditions at all time levels: $u_{\\mathbf{j}}^{n} = 0$ for $\\mathbf{j}$ on the discrete boundary.\n\nStarting from the governing equation and this explicit scheme, derive the Courant–Friedrichs–Lewy (CFL) stability condition that constrains the time step $\\Delta t$ in terms of $c$, $\\Delta x$, and $d$ by analyzing the boundedness of the scheme’s amplification factor over all admissible discrete wavenumbers. Then, using an argument grounded in operator spectra or discrete energy, explain why the presence of homogeneous Dirichlet boundaries does not permit a larger $\\Delta t$ than the constraint dictated by the interior stencil. Provide your final result as a single closed-form analytic expression for the maximum allowable $\\Delta t$ in terms of $c$, $\\Delta x$, and $d$. Do not include units in your final boxed expression.",
            "solution": "The fundamental base is the linear acoustic wave equation $u_{tt} = c^{2} \\nabla^{2} u$, which is hyperbolic and admits traveling waves with characteristic speed $c$. A standard second-order accurate explicit finite-difference method combines centered differences in time and space. On a uniform Cartesian grid with spacing $\\Delta x$ in each direction, the discrete Laplacian $\\Delta_{h}$ acting on a grid function $v_{\\mathbf{j}}$ is\n$$\n\\Delta_{h} v_{\\mathbf{j}} \\;=\\; \\sum_{m=1}^{d} \\frac{v_{\\mathbf{j}+\\mathbf{e}_{m}} \\;-\\; 2 v_{\\mathbf{j}} \\;+\\; v_{\\mathbf{j}-\\mathbf{e}_{m}}}{\\Delta x^{2}}.\n$$\nThe explicit three-level update for the wave equation is\n$$\nu_{\\mathbf{j}}^{n+1} \\;=\\; 2 u_{\\mathbf{j}}^{n} \\;-\\; u_{\\mathbf{j}}^{n-1} \\;+\\; c^{2} \\Delta t^{2} \\,\\Delta_{h} u_{\\mathbf{j}}^{n}.\n$$\n\nTo derive the Courant–Friedrichs–Lewy (CFL) stability condition, we perform a von Neumann analysis, which, for linear constant-coefficient stencils, assesses the amplification factor of discrete plane waves. Although the physical problem has homogeneous Dirichlet boundary conditions, the CFL constraint for an explicit local stencil arises from the interior update; thus it suffices to analyze modes that locally resemble plane waves. Consider the discrete Fourier mode\n$$\nu_{\\mathbf{j}}^{n} \\;=\\; \\rho^{n} \\exp\\!\\Big( i \\sum_{m=1}^{d} j_{m} \\theta_{m} \\Big),\n$$\nwith phase angles $\\theta_{m} \\in [0,\\pi]$ capturing the highest resolvable grid frequencies. Substituting this ansatz into the update yields, using linearity and separability,\n$$\n\\rho^{n+1} \\exp\\!\\Big( i \\sum_{m} j_{m} \\theta_{m} \\Big) \\;-\\; 2 \\rho^{n} \\exp\\!\\Big( i \\sum_{m} j_{m} \\theta_{m} \\Big) \\;+\\; \\rho^{n-1} \\exp\\!\\Big( i \\sum_{m} j_{m} \\theta_{m} \\Big)\n$$\n$$\n=\\; c^{2} \\Delta t^{2} \\sum_{m=1}^{d} \\frac{\\exp\\!\\big( i (j_{m}+1) \\theta_{m} \\big) + \\exp\\!\\big( i (j_{m}-1) \\theta_{m} \\big) - 2 \\exp\\!\\big( i j_{m} \\theta_{m} \\big)}{\\Delta x^{2}} \\prod_{k \\neq m} \\exp\\!\\big( i j_{k} \\theta_{k} \\big) \\,\\rho^{n}.\n$$\nCanceling the common factor $\\exp\\!\\big( i \\sum_{m} j_{m} \\theta_{m} \\big) \\rho^{n}$ and using $\\exp(i \\theta) + \\exp(-i \\theta) - 2 = 2 (\\cos \\theta - 1) = -4 \\sin^{2}(\\theta/2)$, we obtain the scalar recurrence for the amplification factor $\\rho$:\n$$\n\\rho^{2} \\;-\\; 2 \\rho \\;+\\; 1 \\;=\\; -\\, 4 \\rho \\, \\sum_{m=1}^{d} \\lambda^{2} \\sin^{2}\\!\\Big( \\frac{\\theta_{m}}{2} \\Big),\n$$\nwhere $\\lambda := \\frac{c \\Delta t}{\\Delta x}$ is the dimensionless Courant number for each coordinate when the spacing is uniform. Rearranging,\n$$\n\\rho^{2} \\;+\\; \\rho \\Big( 4 \\sum_{m=1}^{d} \\lambda^{2} \\sin^{2}\\!\\Big( \\frac{\\theta_{m}}{2} \\Big) \\;-\\; 2 \\Big) \\;+\\; 1 \\;=\\; 0.\n$$\nLet $z := \\rho$ and divide by $z$ to obtain\n$$\nz \\;+\\; \\frac{1}{z} \\;=\\; 2 \\;-\\; 4 \\sum_{m=1}^{d} \\lambda^{2} \\sin^{2}\\!\\Big( \\frac{\\theta_{m}}{2} \\Big).\n$$\nFor stability of a second-order centered scheme for a conservative hyperbolic equation, the amplification factors must be unimodular, i.e. $|z| = 1$, so we can set $z = \\exp(i \\Omega \\Delta t)$ for some real discrete frequency $\\Omega$. Then $z + z^{-1} = 2 \\cos(\\Omega \\Delta t)$, implying\n$$\n2 \\cos(\\Omega \\Delta t) \\;=\\; 2 \\;-\\; 4 \\sum_{m=1}^{d} \\lambda^{2} \\sin^{2}\\!\\Big( \\frac{\\theta_{m}}{2} \\Big).\n$$\nA necessary and sufficient condition for a real $\\Omega$ uniformly over all admissible $\\theta_{m}$ is that the right-hand side lies in the interval $[-2,2]$ for all $\\theta_{m}$. Therefore,\n$$\n\\Big| \\, 2 \\;-\\; 4 \\sum_{m=1}^{d} \\lambda^{2} \\sin^{2}\\!\\Big( \\frac{\\theta_{m}}{2} \\Big) \\, \\Big| \\;\\le\\; 2\n\\quad \\Longleftrightarrow \\quad\n0 \\;\\le\\; \\sum_{m=1}^{d} \\lambda^{2} \\sin^{2}\\!\\Big( \\frac{\\theta_{m}}{2} \\Big) \\;\\le\\; 1.\n$$\nBecause $\\sin^{2}(\\cdot)$ is bounded by $1$, the worst-case over all resolvable grid wavenumbers is attained when each $\\sin^{2}(\\theta_{m}/2)$ approaches $1$. Hence a sufficient and sharp bound is\n$$\n\\sum_{m=1}^{d} \\lambda^{2} \\;\\le\\; 1.\n$$\nWith uniform spacing in all directions, $\\lambda$ is the same for each $m$, yielding\n$$\nd \\lambda^{2} \\;\\le\\; 1\n\\quad \\Longrightarrow \\quad\n\\lambda \\;\\le\\; \\frac{1}{\\sqrt{d}}\n\\quad \\Longrightarrow \\quad\n\\Delta t \\;\\le\\; \\frac{\\Delta x}{c \\sqrt{d}}.\n$$\nThis is the Courant–Friedrichs–Lewy (CFL) stability condition for the explicit second-order accurate centered scheme for the wave equation on a $d$-dimensional uniform grid.\n\nWe now explain why homogeneous Dirichlet boundaries do not relax this interior time step constraint. There are two complementary perspectives grounded in first principles:\n\n1. Spectral viewpoint. The discrete Laplacian with homogeneous Dirichlet boundary conditions is a symmetric negative definite matrix whose eigenvectors are tensor products of sines, and whose eigenvalues are\n$$\n\\mu_{\\mathbf{k}} \\;=\\; \\frac{2}{\\Delta x^{2}} \\sum_{m=1}^{d} \\big( \\cos(\\theta_{m}) - 1 \\big)\n\\;=\\; -\\, \\frac{4}{\\Delta x^{2}} \\sum_{m=1}^{d} \\sin^{2}\\!\\Big( \\frac{\\theta_{m}}{2} \\Big),\n$$\nwith discrete angles $\\theta_{m}$ determined by the grid and boundary. The spectral radius $|\\mu_{\\max}|$ is bounded above by $\\frac{4}{\\Delta x^{2}} \\sum_{m=1}^{d} 1 = \\frac{4 d}{\\Delta x^{2}}$, the same as the periodic interior stencil bound. As the grid is refined, the largest admissible $\\sin^{2}$ approaches $1$, so the Dirichlet spectrum asymptotically saturates the same bound as the interior plane-wave analysis. The explicit update multiplies this spectrum by $c^{2} \\Delta t^{2}$, and the three-level stability requirement derived above depends only on the supremum of $\\sum_{m} \\sin^{2}(\\theta_{m}/2)$, which Dirichlet boundary conditions cannot increase beyond $1$; thus they do not allow a larger $\\Delta t$.\n\n2. Local energy viewpoint. The CFL constraint reflects the requirement that numerical information does not propagate across more than one grid cell per time step relative to the characteristic speed $c$. This locality is controlled by the interior stencil width and the wave speed, independent of boundary conditions. Homogeneous Dirichlet boundaries restrict global mode shapes but do not change the local coupling in the interior update. Therefore, the most restrictive local mode—corresponding to grid-scale oscillations—still dictates the stability limit, and boundary enforcement does not relax the interior time step constraint.\n\nHence, the maximum allowable time step for stability of this explicit second-order accurate scheme on a $d$-dimensional uniform grid is\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{\\Delta x}{c \\sqrt{d}}.\n$$",
            "answer": "$$\\boxed{\\frac{\\Delta x}{c \\sqrt{d}}}$$"
        },
        {
            "introduction": "The accurate implementation of boundary conditions is a critical factor determining the fidelity of any numerical simulation. This practice focuses on the Poisson equation, a canonical elliptic PDE, and guides you through the derivation and implementation of a second-order accurate \"ghost point\" method for enforcing Dirichlet boundary data on a cell-centered grid . This exercise develops a core implementation skill and provides crucial insight into the relationship between the local truncation error near boundaries and the overall global accuracy of the solution.",
            "id": "3578589",
            "problem": "Consider the elliptic Partial Differential Equation (PDE) Poisson problem in two spatial dimensions on the open unit square domain $\\Omega=(0,1)\\times(0,1)$:\n$$\n-\\,\\Delta u = f \\quad \\text{in } \\Omega,\n$$\nwith Dirichlet boundary data\n$$\nu=g \\quad \\text{on } \\partial\\Omega.\n$$\nYou are asked to derive and implement a second-order accurate ghost-point finite difference stencil that enforces the Dirichlet data near the boundary while preserving the overall second-order accuracy of the scheme.\n\nYour derivation must start from fundamental calculus and Taylor expansion principles and respect the following modeling assumptions that are standard in computational geophysics for finite volume or cell-centered finite difference formulations:\n- The unknown $u$ is represented at cell centers on a uniform Cartesian grid with $N\\times N$ cells, grid spacing $h=1/N$, and cell-center coordinates $x_i=(i+\\tfrac{1}{2})h$, $y_j=(j+\\tfrac{1}{2})h$ for integers $i,j\\in\\{0,1,\\ldots,N-1\\}$.\n- The five-point discrete Laplacian interior stencil approximates $-\\Delta u$ at cell centers by the standard central differences on a uniform mesh.\n- Near a boundary face (e.g., $x=0$), you will introduce a ghost value at the reflected cell-center location (e.g., $x=-\\tfrac{h}{2}$) and enforce the Dirichlet boundary condition at the face location using a local one-dimensional argument in the outward normal direction. Your derivation must use Taylor expansions to justify the ghost-value relation and its order of accuracy with respect to the exact ghost value implied by the smooth solution $u$ and the boundary data $g$.\n\nTasks:\n1. Derive, in one spatial dimension, a ghost-point relation that enforces Dirichlet data $u(0)=g(0)$ at the boundary face $x=0$ for a cell-centered grid with unknowns at $x_{-1}=-\\tfrac{h}{2}$, $x_0=\\tfrac{h}{2}$, $x_1=\\tfrac{3h}{2}$. Starting from Taylor expansions about either the boundary face or a nearby cell center, show how to express the ghost value in terms of the boundary data and the adjacent interior value, and state clearly the order of consistency of that relation with the exact ghost value. Then write the resulting normal-direction discrete second-derivative stencil adjacent to the boundary face, and combine it with the tangential-direction difference to obtain the two-dimensional near-boundary stencil for $-\\,\\Delta u=f$ at the first layer of interior cell centers.\n2. Explain why, even if the local truncation error near the boundary is worse than the interior (for example, $\\mathcal{O}(h)$ or $\\mathcal{O}(1)$ at a set of cell centers of width $\\mathcal{O}(h)$ next to $\\partial\\Omega$), the overall global error in a mesh-weighted discrete $L^2$ norm can still be $\\mathcal{O}(h^2)$ for smooth solutions $u$ and data $f,g$. Your explanation should be based on the stability and smoothing properties of elliptic operators and a discrete energy estimate argument grounded in well-tested facts for elliptic PDEs.\n3. Implement the full two-dimensional scheme on $\\Omega$ using the cell-centered grid with ghost values to impose Dirichlet data on all four sides. Assemble the linear system for the unknown vector of size $N^2$ and solve it using any direct sparse solver. For each problem instance below, compute the mesh-weighted discrete $L^2$ error\n$$\n\\|e_h\\|_{2,h} \\;=\\; \\left(h^2 \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1}\\left(u_{ij}^{\\text{num}}-u(x_i,y_j)\\right)^2\\right)^{1/2},\n$$\nand the observed order of accuracy\n$$\np \\;=\\; \\log_2\\!\\left(\\frac{\\|e_h\\|_{2,h}}{\\|e_{h/2}\\|_{2,h/2}}\\right).\n$$\n\nTest Suite:\n- Case A (homogeneous Dirichlet; smooth nontrivial source): exact solution $u(x,y)=\\sin(2\\pi x)\\sin(3\\pi y)$, so $f(x,y)=\\left((2\\pi)^2+(3\\pi)^2\\right)\\sin(2\\pi x)\\sin(3\\pi y)$ and $g$ is the trace of $u$ on $\\partial\\Omega$. Use $N\\in\\{16,32,64\\}$.\n- Case B (inhomogeneous Dirichlet; nonzero source): exact solution $u(x,y)=\\exp(x+y)$, so $f(x,y)=-2\\exp(x+y)$ and $g$ is the trace of $u$ on $\\partial\\Omega$. Use $N\\in\\{16,32,64\\}$.\n- Case C (Laplace equation; inhomogeneous boundary): exact solution $u(x,y)=\\cosh(x)\\cos(y)$, so $f(x,y)=0$ and $g$ is the trace of $u$ on $\\partial\\Omega$. Use $N\\in\\{16,32,64\\}$.\n\nRequired final output:\n- Your program must compute the observed order $p$ using the largest two grids for each case (that is, compare $N=32$ and $N=64$), and produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, for example $[p_A,p_B,p_C]$.\n- Each $p$ must be printed as a floating-point number rounded to three decimal places.\n- No physical units are involved in this problem. Angles, where they appear inside trigonometric functions, are in radians.\n\nYour final answer must be a complete, runnable program that carries out these computations exactly as specified and prints the final output in the required single-line format.",
            "solution": "The user-provided problem is assessed to be valid as it is scientifically grounded, well-posed, objective, and contains a complete and consistent setup for a standard numerical analysis task. The methodology involves deriving, analyzing, and implementing a finite difference scheme for the Poisson equation.\n\n### Task 1: Derivation of the Ghost-Point Stencil\n\nWe are asked to derive a second-order accurate finite difference scheme for the Poisson problem $-\\Delta u = f$ on the unit square $\\Omega=(0,1)\\times(0,1)$ with Dirichlet boundary conditions $u=g$ on $\\partial\\Omega$. The scheme uses a cell-centered grid where unknowns $u_{ij}$ represent the solution at cell centers $(x_i, y_j) = ((i+\\frac{1}{2})h, (j+\\frac{1}{2})h)$ for $i,j \\in \\{0, 1, \\ldots, N-1\\}$ with grid spacing $h=1/N$.\n\nFirst, we consider the one-dimensional problem near the boundary at $x=0$. The first interior cell center is at $x_0=h/2$. We introduce a \"ghost\" cell center at $x_{-1}=-h/2$. The value of the solution at this ghost point, $u_{-1}$, is determined by enforcing the boundary condition $u(0)=g(0)$.\n\nA second-order accurate way to enforce this condition is to assume that the boundary value is the average of the values at the two adjacent cell centers:\n$$\n\\frac{u_0 + u_{-1}}{2} = g(0)\n$$\nThis is equivalent to a centered interpolation. To verify its accuracy, we use Taylor series expansion of the exact solution $u(x)$ around $x=0$:\n$$\nu(h/2) = u(0) + \\frac{h}{2} u'(0) + \\frac{h^2}{8} u''(0) + O(h^3)\n$$\n$$\nu(-h/2) = u(0) - \\frac{h}{2} u'(0) + \\frac{h^2}{8} u''(0) - O(h^3)\n$$\nSumming these and dividing by $2$ gives:\n$$\n\\frac{u(h/2) + u(-h/2)}{2} = u(0) + \\frac{h^2}{8} u''(0) + O(h^4)\n$$\nThus, setting $\\frac{u_0+u_{-1}}{2} = g(0)$ enforces the boundary condition with an error of $O(h^2)$. From this relation, we express the ghost value $u_{-1}$ as:\n$$\nu_{-1} = 2g(0) - u_0\n$$\nTo verify the consistency of this computed ghost value with the exact value $u_{exact}(-h/2)$, we compute the difference:\n$$\nu_{-1} - u_{exact}(-h/2) = (2g(0) - u_0) - u(-h/2)\n$$\nSubstituting Taylor expansions for $u_0=u(h/2)$ and $g(0)=u(0)$ around $x=-h/2$, or more simply as done above by expanding all around $x=0$, we find:\n$$\nu_{-1} - u_{exact}(-h/2) = \\left(2u(0) - \\left(u(0)+\\frac{h}{2}u'(0)+\\frac{h^2}{8}u''(0)\\right)\\right) - \\left(u(0)-\\frac{h}{2}u'(0)+\\frac{h^2}{8}u''(0)\\right) + O(h^3)\n$$\n$$\n= -\\frac{h^2}{4}u''(0) + O(h^3)\n$$\nThe computed ghost value is therefore consistent with the exact value to order $O(h^2)$.\n\nNext, we formulate the discrete second-derivative stencil for $-u_{xx}$ at the first interior point $x_0=h/2$. We use the standard centered difference formula, which involves points $x_0-h = -h/2$ and $x_0+h = 3h/2$. The corresponding grid indices are $-1$ and $1$.\n$$\n-u_{xx}(x_0) \\approx -\\frac{u_1 - 2u_0 + u_{-1}}{h^2}\n$$\nSubstituting our expression for the ghost value $u_{-1}$:\n$$\n-u_{xx}(x_0) \\approx -\\frac{u_1 - 2u_0 + (2g(0) - u_0)}{h^2} = \\frac{3u_0 - u_1 - 2g(0)}{h^2}\n$$\nThis is the required near-boundary stencil for the normal second derivative.\n\nFinally, we assemble the full two-dimensional stencil for $-\\Delta u = f$ at a point $(x_0, y_j)$ on the grid adjacent to the left boundary $x=0$.\n$$\n-\\Delta u(x_0, y_j) = -u_{xx}(x_0, y_j) - u_{yy}(x_0, y_j) = f(x_0, y_j)\n$$\nWe use our derived stencil for $-u_{xx}$ and the standard centered difference stencil for $-u_{yy}$:\n$$\n\\frac{3u_{0j} - u_{1j} - 2g(0, y_j)}{h^2} + \\frac{2u_{0j} - u_{0,j-1} - u_{0,j+1}}{h^2} \\approx f_{0j}\n$$\nRearranging to place all unknown terms on the left-hand side yields the final discrete equation at $(x_0, y_j)$:\n$$\n\\frac{5u_{0j} - u_{1j} - u_{0,j-1} - u_{0,j+1}}{h^2} = f_{0j} + \\frac{2g(0, y_j)}{h^2}\n$$\nThis equation, along with analogous ones for the other three boundaries and the standard 5-point stencil in the interior, forms the system of linear equations to be solved for the unknowns $\\{u_{ij}\\}$.\n\n### Task 2: Global Accuracy with Lower-Order Local Error\n\nA direct analysis of the local truncation error (LTE) for the near-boundary stencil derived in Task 1 reveals it to be $O(h)$. For instance, at $(x_0, y_j)$, the LTE is $\\tau_{0j} = (-\\Delta u - L_h u)|_{(x_0,y_j)}$. The tangential part $-u_{yy} - L_h^y u$ is $O(h^2)$, but the normal part $-u_{xx}-L_h^x u$ has an LTE of $-\\frac{1}{4}u_{xx}(0, y_j) + O(h)$. Thus, the total LTE is $O(h)$ at grid points adjacent to the boundary.\n\nOne might intuitively expect that an $O(h)$ LTE on $O(N) = O(1/h)$ grid points would degrade the global accuracy to $O(h)$. However, for elliptic problems, the global error in a discrete $L^2$ norm often remains $O(h^2)$, a phenomenon sometimes referred to as superconvergence. The explanation rests on the stability and smoothing properties of the elliptic operator and its discrete counterpart.\n\nLet $A_h$ be the matrix representing the discrete Laplacian operator, $e_h$ be the vector of global errors at grid points, and $\\tau_h$ be the vector of LTEs. The error satisfies the equation $A_h e_h = \\tau_h$. A basic stability estimate states that $\\|e_h\\|_{2,h} \\le \\|A_h^{-1}\\|_{2,h} \\|\\tau_h\\|_{2,h}$. The matrix norm $\\|A_h^{-1}\\|_{2,h}$ is bounded independently of $h$ for a stable scheme. The norm of the LTE vector is $\\|\\tau_h\\|_{2,h} = \\left(h^2 \\sum_{i,j} \\tau_{ij}^2\\right)^{1/2}$. This sum consists of approximately $(N-2)^2$ interior terms where $\\tau_{ij} = O(h^2)$ and approximately $4(N-2)$ boundary-adjacent terms where $\\tau_{ij}=O(h)$.\nThe resulting norm estimate is:\n$$\n\\|\\tau_h\\|_{2,h}^2 = h^2 \\left( O(N^2) \\cdot (O(h^2))^2 + O(N) \\cdot (O(h))^2 \\right) = h^2 \\left( O(h^{-2}) \\cdot O(h^4) + O(h^{-1}) \\cdot O(h^2) \\right) = O(h^4) + O(h^3)\n$$\nThis suggests $\\|\\tau_h\\|_{2,h} = O(h^{3/2})$, leading to a global error of $\\|e_h\\|_{2,h}=O(h^{3/2})$. While better than $O(h)$, this simple analysis is still too pessimistic.\n\nA more refined analysis, based on a discrete form of Green's identity or properties of the discrete Green's function, is needed. The inverse operator $A_h^{-1}$ possesses a smoothing property: it maps a \"rough\" forcing term (like our $\\tau_h$, which has a sharp jump at the boundary layer) to a \"smoother\" solution $e_h$. The impact of the larger error sources concentrated at the boundary is dampened and decays rapidly into the interior of the domain. This is analogous to Saint-Venant's principle in mechanics. A rigorous proof (e.g., using Bramble's Lemma or GKS theory) demonstrates that the influence of the $O(h)$ LTE on the co-dimension one boundary set contributes to the global $L^2$ error at the same order as an $O(h^2)$ LTE in the bulk. Consequently, both the interior and boundary LTEs lead to an $O(h^2)$ contribution to the global error, resulting in an overall observed accuracy of $O(h^2)$ for smooth solutions.\n\n### Task 3: Implementation\n\nThe numerical implementation involves constructing and solving the $N^2 \\times N^2$ linear system $A \\vec{u} = \\vec{b}$ derived from the finite difference stencils. For a general point $(i,j)$, the equation is:\n$$\nc_{ij} u_{ij} - \\sum_{(i',j') \\in \\mathcal{N}_{ij}} u_{i'j'} = h^2 f_{ij} + (\\text{boundary terms})\n$$\n- **Interior points:** $c_{ij}=4$.\n- **Edge points (not corners):** $c_{ij}=5$.\n- **Corner points:** $c_{ij}=6$.\n\nThe matrix $A$ is sparse, symmetric, and positive definite, making it suitable for specialized solvers. The Python implementation below uses `scipy.sparse` to build the matrix efficiently and `scipy.sparse.linalg.spsolve` to solve the system. It then computes the discrete $L^2$ error and convergence order for the three test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import sparse\nfrom scipy.sparse import linalg\n\ndef compute_order_of_accuracy(u_exact_func, f_func, N_values):\n    \"\"\"\n    Computes the observed order of accuracy for the Poisson solver.\n\n    Args:\n        u_exact_func: Lambda function for the exact solution u(x, y).\n        f_func: Lambda function for the source term f(x, y).\n        N_values: A list of grid sizes [N_coarse, N_fine].\n\n    Returns:\n        The computed order of accuracy p.\n    \"\"\"\n    errors = []\n    g_func = u_exact_func # Boundary data g is the trace of u\n\n    for N in N_values:\n        h = 1.0 / N\n        \n        # Create grid with cell centers\n        x = (np.arange(N) + 0.5) * h\n        y = (np.arange(N) + 0.5) * h\n        X, Y = np.meshgrid(x, y, indexing='ij')\n\n        # Assemble the linear system A*u = b\n        # Using row-major mapping: k = i * N + j\n        num_unknowns = N * N\n        mat_A = sparse.lil_matrix((num_unknowns, num_unknowns))\n        vec_b = np.zeros(num_unknowns)\n\n        for i in range(N):\n            for j in range(N):\n                k = i * N + j\n                \n                # Diagonal coefficient is 4 for interior, 5 for edge, 6 for corner\n                diag_coeff = 4.0\n                \n                # Source term\n                b_val = f_func(X[i, j], Y[i, j])\n\n                # Left neighbor / boundary\n                if i  0:\n                    mat_A[k, (i - 1) * N + j] = -1.0\n                else:\n                    diag_coeff += 1.0\n                    b_val += 2.0 / h**2 * g_func(0.0, Y[i, j])\n\n                # Right neighbor / boundary\n                if i  N - 1:\n                    mat_A[k, (i + 1) * N + j] = -1.0\n                else:\n                    diag_coeff += 1.0\n                    b_val += 2.0 / h**2 * g_func(1.0, Y[i, j])\n\n                # Bottom neighbor / boundary\n                if j  0:\n                    mat_A[k, i * N + (j - 1)] = -1.0\n                else:\n                    diag_coeff += 1.0\n                    b_val += 2.0 / h**2 * g_func(X[i, j], 0.0)\n                \n                # Top neighbor / boundary\n                if j  N - 1:\n                    mat_A[k, i * N + (j + 1)] = -1.0\n                else:\n                    diag_coeff += 1.0\n                    b_val += 2.0 / h**2 * g_func(X[i, j], 1.0)\n                \n                mat_A[k, k] = diag_coeff\n                vec_b[k] = b_val\n        \n        mat_A = mat_A / h**2\n        \n        # Solve the sparse linear system\n        mat_A_csr = mat_A.tocsr()\n        u_vec = linalg.spsolve(mat_A_csr, vec_b)\n        \n        # Reshape solution vector to grid\n        u_numerical = u_vec.reshape((N, N))\n        \n        # Compute error\n        u_exact_grid = u_exact_func(X, Y)\n        error_grid = u_numerical - u_exact_grid\n        l2_error = np.sqrt(h**2 * np.sum(error_grid**2))\n        errors.append(l2_error)\n        \n    # Calculate observed order of accuracy p\n    # p = log2(error_coarse / error_fine)\n    p = np.log2(errors[0] / errors[1])\n    return p\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    N_list_full = [16, 32, 64]\n    \n    # We compare the two largest grids, N=32 and N=64\n    N_list_for_order = [32, 64]\n\n    # Test Case A\n    u_A = lambda x, y: np.sin(2 * np.pi * x) * np.sin(3 * np.pi * y)\n    f_A = lambda x, y: ((2 * np.pi)**2 + (3 * np.pi)**2) * u_A(x, y)\n    p_A = compute_order_of_accuracy(u_A, f_A, N_list_for_order)\n\n    # Test Case B\n    u_B = lambda x, y: np.exp(x + y)\n    f_B = lambda x, y: -2 * np.exp(x + y)\n    p_B = compute_order_of_accuracy(u_B, f_B, N_list_for_order)\n\n    # Test Case C\n    u_C = lambda x, y: np.cosh(x) * np.cos(y)\n    f_C = lambda x, y: 0.0 * x * y # Zero function\n    p_C = compute_order_of_accuracy(u_C, f_C, N_list_for_order)\n\n    results = [p_A, p_B, p_C]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving beyond simple numerical approximations, a more powerful approach for handling boundaries in unbounded domains involves formulating exact, non-reflecting boundary conditions. This exercise introduces the concept of the Dirichlet-to-Neumann (DtN) operator, which perfectly encapsulates the solution's behavior in the domain's exterior. You will use Fourier analysis to derive the symbol of the DtN map for the Helmholtz equation in a half-space, a foundational result in wave theory, and in doing so, discover the inherently nonlocal nature of this exact boundary operator .",
            "id": "3578531",
            "problem": "Consider a time-harmonic acoustic pressure field in a homogeneous half-space with constant wavespeed $c$ and angular frequency $\\omega$, under the standard time dependence $\\exp(-i \\omega t)$. Let $x=(x_{1},x_{2},x_{3})$, with $x_{3}0$ denoting depth and the plane $x_{3}=0$ the boundary. The complex amplitude $u(x)$ satisfies the Helmholtz equation\n$$(\\Delta + \\kappa^{2})\\,u=0 \\quad \\text{in} \\quad x_{3}0,$$\nwhere $\\kappa=\\omega/c$. On the boundary $x_{3}=0$, the Dirichlet data $u(x_{1},x_{2},0)=g(x_{1},x_{2})$ is prescribed. Impose the outgoing or decaying behavior as $x_{3}\\to +\\infty$ consistent with the Sommerfeld radiation condition.\n\nDefine the Dirichlet-to-Neumann (DtN) operator $\\Lambda$ that maps the boundary Dirichlet data to the interior normal derivative in the $x_{3}$-direction, $\\Lambda g=\\partial_{3}u|_{x_{3}=0^{+}}$. Use the Fourier transform in the tangential variables $x'=(x_{1},x_{2})$ to derive the exact scalar Fourier multiplier $m(k)$, with $k=(k_{1},k_{2})$ and $|k|=\\sqrt{k_{1}^{2}+k_{2}^{2}}$, such that $\\widehat{\\Lambda g}(k)=m(k)\\,\\widehat{g}(k)$. Your derivation must start from the governing equation and the radiation condition, and proceed by transforming in $x'$ to obtain and solve the resulting ordinary differential equation in $x_{3}$ for each fixed tangential wavenumber $k$, enforcing the radiation condition to fix the branch of the vertical wavenumber.\n\nWithin your solution, interpret how the form of $m(k)$ implies that $\\Lambda$ is a nonlocal operator along the boundary $x_{3}=0$. In particular, relate the nonpolynomial dependence of $m(k)$ on $|k|$ to the fact that $\\Lambda$ cannot be represented as a finite-order differential operator in $x'$ and discuss the qualitative decay of its boundary integral kernel.\n\nAnswer specification:\n- Provide your final answer as a single, closed-form analytic expression for the Fourier multiplier $m(k)$ in terms of $\\kappa$ and $|k|$, using the principal branch of the square root chosen consistently with the radiation condition.\n- No numerical evaluation is required.\n- Do not include any additional commentary in the final answer beyond the requested expression.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Physical System**: Time-harmonic acoustic pressure field in a homogeneous half-space, $x_{3}0$.\n- **Parameters**: Constant wavespeed $c$, angular frequency $\\omega$.\n- **Time Dependence**: $\\exp(-i \\omega t)$.\n- **Coordinates**: $x=(x_{1},x_{2},x_{3})$, with boundary at $x_{3}=0$.\n- **Governing Equation**: The Helmholtz equation, $(\\Delta + \\kappa^{2})\\,u=0$ in $x_{3}0$.\n- **Wavenumber**: $\\kappa=\\omega/c$.\n- **Boundary Condition**: Dirichlet data $u(x_{1},x_{2},0)=g(x_{1},x_{2})$ on the plane $x_{3}=0$.\n- **Radiation Condition**: The solution $u(x)$ must exhibit outgoing or decaying behavior as $x_{3}\\to +\\infty$.\n- **Operator Definition**: The Dirichlet-to-Neumann (DtN) operator is defined as $\\Lambda g=\\partial_{3}u|_{x_{3}=0^{+}}$.\n- **Objective**: Derive the Fourier multiplier $m(k)$ for the DtN operator, where $k=(k_{1},k_{2})$ is the tangential wavenumber, such that $\\widehat{\\Lambda g}(k)=m(k)\\,\\widehat{g}(k)$. The derivation must use the Fourier transform in the tangential variables $x'=(x_{1},x_{2})$.\n- **Interpretation**: Explain the nonlocality of $\\Lambda$ based on the derived form of $m(k)$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is scientifically sound. The Helmholtz equation is the fundamental time-independent wave equation for time-harmonic phenomena. The problem setup—a half-space with a radiation condition—is a classic and fundamental boundary value problem in wave physics, geophysics, and engineering.\n2.  **Well-Posedness**: The problem is well-posed. The combination of the Helmholtz equation in a half-space, a Dirichlet condition on the boundary, and a Sommerfeld-type radiation condition at infinity guarantees the existence and uniqueness of the solution.\n3.  **Objectivity**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective claims.\n4.  **Completeness and Consistency**: The problem is self-contained and provides all necessary information, including the governing equation, domain, boundary conditions, and the crucial time-dependence convention, which is essential for correctly interpreting the radiation condition. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, well-posed problem in mathematical physics. The solution process may proceed.\n\n### Solution Derivation\n\nThe governing equation for the complex pressure amplitude $u(x_{1},x_{2},x_{3})$ is the Helmholtz equation:\n$$ (\\partial_{1}^{2} + \\partial_{2}^{2} + \\partial_{3}^{2} + \\kappa^{2})u(x_{1},x_{2},x_{3}) = 0 \\quad \\text{for} \\quad x_{3}  0 $$\nWe introduce the two-dimensional Fourier transform with respect to the tangential variables $x'=(x_{1},x_{2})$. Let $k=(k_{1},k_{2})$ be the corresponding tangential wavevector. The transform of $u$ is denoted $\\widehat{u}(k_{1},k_{2},x_{3})$.\nThe Fourier transform converts partial derivatives with respect to $x_1$ and $x_2$ into multiplication by Fourier variables:\n$$ \\mathcal{F}\\{\\partial_{1}^{2}u\\} = (i k_{1})^{2}\\widehat{u} = -k_{1}^{2}\\widehat{u} $$\n$$ \\mathcal{F}\\{\\partial_{2}^{2}u\\} = (i k_{2})^{2}\\widehat{u} = -k_{2}^{2}\\widehat{u} $$\nThe derivative with respect to $x_3$ is unaffected, becoming an ordinary derivative. Applying the Fourier transform to the Helmholtz equation yields a second-order ordinary differential equation (ODE) in the variable $x_3$ for each $k$:\n$$ (-k_{1}^{2} - k_{2}^{2} + \\frac{d^{2}}{dx_{3}^{2}} + \\kappa^{2}) \\widehat{u}(k, x_{3}) = 0 $$\nLet $|k|^{2} = k_{1}^{2}+k_{2}^{2}$. The ODE simplifies to:\n$$ \\frac{d^{2}\\widehat{u}}{dx_{3}^{2}} + (\\kappa^{2} - |k|^{2}) \\widehat{u} = 0 $$\nLet's define the vertical wavenumber $k_3$ such that $k_{3}^{2} = \\kappa^{2} - |k|^{2}$. The general solution to this ODE is a linear combination of complex exponentials:\n$$ \\widehat{u}(k, x_{3}) = A(k) \\exp(i k_{3} x_{3}) + B(k) \\exp(-i k_{3} x_{3}) $$\nwhere $k_{3} = \\sqrt{\\kappa^{2} - |k|^{2}}$. The coefficients $A(k)$ and $B(k)$ are determined by the boundary and radiation conditions.\n\nThe radiation condition requires the solution to be either outgoing (propagating towards $x_{3} \\to +\\infty$) or decaying as $x_{3} \\to +\\infty$. With the given time dependence $\\exp(-i\\omega t)$, a wave of the form $\\exp(i k_z z - i\\omega t)$ propagates in the $+z$ direction for positive real $k_z$.\n\nWe analyze two cases for $k_3$:\n1.  **Propagating Modes ($|k|  \\kappa$)**: Here, $\\kappa^{2} - |k|^{2}  0$, so $k_3$ is real. We choose the positive root, $k_{3} = \\sqrt{\\kappa^{2} - |k|^{2}}  0$. The term $A(k)\\exp(i k_{3} x_{3})$ represents a wave propagating in the $+x_{3}$ direction (outgoing). The term $B(k)\\exp(-i k_{3} x_{3})$ represents a wave propagating in the $-x_{3}$ direction (incoming from infinity). The radiation condition requires that there are no sources at infinity, so we must discard the incoming wave. This mandates that $B(k)=0$.\n2.  **Evanescent Modes ($|k|  \\kappa$)**: Here, $\\kappa^{2} - |k|^{2}  0$. It is convenient to write $k_{3} = \\sqrt{-1(|k|^{2} - \\kappa^{2})}$. To ensure decaying behavior, we need the exponent to have a negative real part. The correct branch of the square root must be chosen. Let $\\gamma = \\sqrt{|k|^{2} - \\kappa^{2}}  0$. Then $k_{3} = \\pm i\\gamma$. The solution is $\\widehat{u}(k, x_{3}) = A(k)\\exp(-\\gamma x_{3}) + B(k)\\exp(\\gamma x_{3})$. The term $\\exp(\\gamma x_{3})$ grows without bound as $x_{3} \\to \\infty$ and must be rejected. This again mandates that $B(k)=0$, and we must choose the solution proportional to $\\exp(-\\gamma x_3)$. This corresponds to choosing $k_3 = i\\gamma = i\\sqrt{|k|^2 - \\kappa^2}$.\n\nBoth cases can be unified by defining $k_3 = \\sqrt{\\kappa^2-|k|^2}$ with the branch choice that ensures $\\text{Im}(\\sqrt{z}) \\ge 0$. This ensures that for $|k|\\kappa$, $k_3$ is real and positive, and for $|k|\\kappa$, $k_3$ is positive imaginary. The solution that satisfies the radiation condition for all $k$ is therefore:\n$$ \\widehat{u}(k, x_{3}) = A(k) \\exp(i k_{3} x_{3}) = A(k) \\exp\\left(i \\sqrt{\\kappa^{2}-|k|^{2}} x_{3}\\right) $$\nNext, we apply the Dirichlet boundary condition $u(x_{1},x_{2},0) = g(x_{1},x_{2})$. In the Fourier domain, this is $\\widehat{u}(k,0) = \\widehat{g}(k)$. Evaluating our solution at $x_3=0$:\n$$ \\widehat{u}(k, 0) = A(k) \\exp(0) = A(k) $$\nThus, we find $A(k) = \\widehat{g}(k)$. The full solution in the Fourier domain is:\n$$ \\widehat{u}(k, x_{3}) = \\widehat{g}(k) \\exp\\left(i \\sqrt{\\kappa^{2}-|k|^{2}} x_{3}\\right) $$\nThe problem asks for the symbol $m(k)$ of the DtN operator $\\Lambda g = \\partial_{3}u|_{x_{3}=0^{+}}$. We find this by taking the Fourier transform: $\\widehat{\\Lambda g}(k) = \\mathcal{F}\\{\\partial_{3}u|_{x_{3}=0^{+}}\\}$. Since the Fourier transform and the $x_3$-derivative commute, this is equivalent to $\\frac{d\\widehat{u}}{dx_{3}}|_{x_{3}=0^{+}}$.\nDifferentiating $\\widehat{u}(k, x_{3})$ with respect to $x_3$:\n$$ \\frac{d\\widehat{u}}{dx_3} = \\widehat{g}(k) \\cdot \\left(i \\sqrt{\\kappa^{2}-|k|^{2}}\\right) \\cdot \\exp\\left(i \\sqrt{\\kappa^{2}-|k|^{2}} x_{3}\\right) $$\nEvaluating at $x_{3}=0^{+}$:\n$$ \\frac{d\\widehat{u}}{dx_3}\\bigg|_{x_{3}=0^{+}} = \\widehat{g}(k) \\cdot \\left(i \\sqrt{\\kappa^{2}-|k|^{2}}\\right) $$\nBy the definition $\\widehat{\\Lambda g}(k) = m(k)\\widehat{g}(k)$, we can directly identify the Fourier multiplier:\n$$ m(k) = i \\sqrt{\\kappa^{2}-|k|^{2}} $$\nwhere the branch of the square root is chosen such that its imaginary part is non-negative.\n\n### Interpretation of Nonlocality\n\nThe DtN operator $\\Lambda$ maps Dirichlet data $g$ on the boundary to Neumann data $\\partial_{3}u|_{x_{3}=0^{+}}$. The action of this operator in the Fourier domain is multiplication by the symbol $m(k)$.\nAn operator is a *local* differential operator if its action at a point $x'$ depends only on the values of the input function and its derivatives at that same point $x'$. In the Fourier domain, an $N$-th order linear partial differential operator in variables $x'=(x_1, x_2)$ has a symbol that is a polynomial in $k=(k_1, k_2)$ of degree $N$. For instance, the Laplacian $\\partial_1^2 + \\partial_2^2$ has the symbol $-k_1^2 - k_2^2 = -|k|^2$, which is a polynomial.\n\nThe derived symbol for the DtN operator is $m(k) = i \\sqrt{\\kappa^{2}-|k|^{2}}$. This expression is not a polynomial in $k_1$ and $k_2$ due to the presence of the square root. Therefore, $\\Lambda$ cannot be represented as a finite-order partial differential operator. Such operators are termed *pseudo-differential operators*.\n\nThe physical manifestation of a non-polynomial symbol is nonlocality. In the spatial domain, the action of $\\Lambda$ is given by a convolution:\n$$ (\\Lambda g)(x') = (\\mathcal{F}^{-1}\\{m\\} * g)(x') = \\int_{\\mathbb{R}^2} K(x' - y') g(y') dy' $$\nwhere $K(x') = \\mathcal{F}^{-1}\\{m(k)\\}$ is the kernel of the operator. For a local operator, the kernel $K(x')$ would be a finite combination of the Dirac delta distribution and its derivatives, meaning the integral would only sample $g$ at the point $x'$. Because $m(k)$ is not a polynomial, its inverse Fourier transform $K(x')$ is not supported solely at the origin. Instead, $K(x')$ is a function that decays away from the origin. The value of $(\\Lambda g)(x')$ at a point $x'$ thus depends on the values of $g(y')$ over the entire boundary, making $\\Lambda$ a *nonlocal* operator.\n\nThe qualitative decay of the kernel $K(x')$ is determined by the smoothness of its symbol $m(k)$. The function $m(k)$ is analytic everywhere except on the circle $|k|=\\kappa$, where the term inside the square root is zero. At this circle, $m(k)$ is continuous, but its derivatives are singular. This lack of smoothness dictates that the kernel $K(x')$ cannot decay rapidly (e.g., exponentially). Instead, singularities in the Fourier domain lead to algebraic decay in the spatial domain. The influence of the boundary data $g(y')$ on the normal derivative at $x'$ diminishes slowly with the distance $|x'-y'|$, which is a defining characteristic of nonlocality in physical systems.",
            "answer": "$$ \\boxed{i \\sqrt{\\kappa^{2} - |k|^{2}}} $$"
        }
    ]
}