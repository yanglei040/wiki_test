{
    "hands_on_practices": [
        {
            "introduction": "Discretizing continuous equations inevitably involves approximation, and one of the most critical choices is how to represent material properties at the interfaces between control volumes. This practice uses a simple one-dimensional model to starkly illustrate why a naive arithmetic average of conductivity can lead to physically incorrect results, especially in media with high-contrast properties. By comparing this common but flawed approach to the exact analytical solution, you will gain a fundamental intuition for the necessity of harmonic averaging for fluxes in series .",
            "id": "3579264",
            "problem": "Consider one-dimensional, steady, single-phase flow in a composite isotropic medium occupying the interval $[0,1]$ with unit cross-sectional area $A=1$. The scalar potential $u(x)$ satisfies a linear constitutive law (Darcy or Fourier type), with flux $q(x)$ proportional to the gradient of $u(x)$ and the material conductivity $k(x)$, and the conservation law implies that the flux is spatially constant at steady state. The medium consists of two layers: a left layer on $x \\in [0,1/2]$ with constant conductivity $k_L$, and a right layer on $x \\in [1/2,1]$ with constant conductivity $k_R$. Impose Dirichlet boundary conditions $u(0) = 1$ and $u(1) = 0$.\n\nTwo discrete viewpoints are considered:\n\n1. In a vertex-centered discretization with vertices at $x=0$ and $x=1$, the flux across the single edge connecting the vertices is approximated using a two-point flux with an edge conductivity defined by arithmetic averaging of the adjacent layer conductivities, $k_{\\mathrm{edge}}^{\\mathrm{arith}} = (k_L + k_R)/2$. The flux magnitude predicted by this scheme is $|q_{\\mathrm{arith}}| = k_{\\mathrm{edge}}^{\\mathrm{arith}} \\, |u(1) - u(0)| / 1$.\n\n2. The physically correct flux magnitude $|q_{\\mathrm{phys}}|$ follows from the continuum model by enforcing steady conservation and the constitutive law across the two layers.\n\nUsing first principles, derive closed-form expressions for $|q_{\\mathrm{arith}}|$ and $|q_{\\mathrm{phys}}|$, and then compute the ratio $r = |q_{\\mathrm{arith}}| / |q_{\\mathrm{phys}}|$ for the high-contrast case $k_L = 1$ and $k_R = 10^{6}$. Provide your final answer for $r$ as a pure number (dimensionless), rounding to four significant figures.",
            "solution": "First, we derive the expression for the flux magnitude predicted by the vertex-centered discretization, $|q_{\\mathrm{arith}}|$. The problem defines this flux approximation as:\n$$\n|q_{\\mathrm{arith}}| = k_{\\mathrm{edge}}^{\\mathrm{arith}} \\frac{|u(1) - u(0)|}{1}\n$$\nThe edge conductivity $k_{\\mathrm{edge}}^{\\mathrm{arith}}$ is given as the arithmetic average of the conductivities of the adjacent layers:\n$$\nk_{\\mathrm{edge}}^{\\mathrm{arith}} = \\frac{k_L + k_R}{2}\n$$\nThe Dirichlet boundary conditions are $u(0) = 1$ and $u(1) = 0$. The potential difference is $|u(1) - u(0)| = |0 - 1| = 1$. The total length of the domain is $L=1$. Substituting these values into the formula for $|q_{\\mathrm{arith}}|$ yields:\n$$\n|q_{\\mathrm{arith}}| = \\left(\\frac{k_L + k_R}{2}\\right) \\frac{1}{1} = \\frac{k_L + k_R}{2}\n$$\n\nNext, we derive the expression for the physically correct flux magnitude, $|q_{\\mathrm{phys}}|$. This is obtained from the continuum model. The governing equations are the conservation law and the constitutive law.\nFor one-dimensional, steady-state flow, the conservation law dictates that the flux $q(x)$ is constant throughout the domain. Let's denote this constant flux as $q$.\nThe constitutive law (e.g., Darcy's law or Fourier's law) relates the flux to the potential gradient:\n$$\nq = -k(x) \\frac{du}{dx}\n$$\nwhere $A=1$ is the unit cross-sectional area. The negative sign indicates that flow occurs from high potential to low potential.\n\nWe can integrate this equation over the two layers of the medium.\nFor the left layer, $x \\in [0, 1/2]$, the conductivity is $k(x) = k_L$. We integrate from $x=0$ to $x=1/2$:\n$$\n\\int_{u(0)}^{u(1/2)} du = \\int_{0}^{1/2} -\\frac{q}{k_L} dx\n$$\n$$\nu(1/2) - u(0) = -\\frac{q}{k_L} \\left(\\frac{1}{2} - 0\\right) = -\\frac{q}{2k_L}\n$$\nFor the right layer, $x \\in [1/2, 1]$, the conductivity is $k(x) = k_R$. We integrate from $x=1/2$ to $x=1$:\n$$\n\\int_{u(1/2)}^{u(1)} du = \\int_{1/2}^{1} -\\frac{q}{k_R} dx\n$$\n$$\nu(1) - u(1/2) = -\\frac{q}{k_R} \\left(1 - \\frac{1}{2}\\right) = -\\frac{q}{2k_R}\n$$\nWe have a system of two equations. We can eliminate the unknown interface potential $u(1/2)$ by adding them:\n$$\n(u(1/2) - u(0)) + (u(1) - u(1/2)) = -\\frac{q}{2k_L} - \\frac{q}{2k_R}\n$$\n$$\nu(1) - u(0) = -q \\left(\\frac{1}{2k_L} + \\frac{1}{2k_R}\\right)\n$$\nNow, we solve for the flux $q$:\n$$\nq = -\\frac{u(1) - u(0)}{\\frac{1}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right)}\n$$\nSubstituting the boundary conditions $u(0)=1$ and $u(1)=0$:\n$$\nq = -\\frac{0 - 1}{\\frac{1}{2}\\left(\\frac{k_R + k_L}{k_L k_R}\\right)} = \\frac{1}{\\frac{k_L + k_R}{2k_L k_R}} = \\frac{2k_L k_R}{k_L + k_R}\n$$\nThe flux is positive, indicating flow in the positive $x$-direction, as expected. The magnitude is:\n$$\n|q_{\\mathrm{phys}}| = \\frac{2k_L k_R}{k_L + k_R}\n$$\nThis expression corresponds to a total resistance being the sum of the series resistances of the two layers, $R_{total} = R_L + R_R = \\frac{L_L}{k_L A} + \\frac{L_R}{k_R A} = \\frac{1/2}{k_L} + \\frac{1/2}{k_R}$. The effective conductivity is the harmonic mean of $k_L$ and $k_R$.\n\nNow we compute the ratio $r = |q_{\\mathrm{arith}}| / |q_{\\mathrm{phys}}|$.\n$$\nr = \\frac{\\frac{k_L + k_R}{2}}{\\frac{2k_L k_R}{k_L + k_R}} = \\frac{(k_L + k_R)(k_L + k_R)}{2 \\cdot (2k_L k_R)} = \\frac{(k_L + k_R)^2}{4k_L k_R}\n$$\nThis ratio represents the error introduced by using an arithmetic average for conductivity in the numerical scheme, instead of the physically correct harmonic average for this one-dimensional series flow problem.\n\nFinally, we substitute the given numerical values, $k_L = 1$ and $k_R = 10^6$, to compute $r$.\n$$\nr = \\frac{(1 + 10^6)^2}{4(1)(10^6)} = \\frac{(1,000,001)^2}{4,000,000}\n$$\n$$\nr = \\frac{1,000,002,000,001}{4,000,000} \\approx 250000.5\n$$\nThe problem requires rounding the result to four significant figures. The number is written as $2.500005 \\times 10^5$. The first four significant digits are $2, 5, 0, 0$. The fifth significant digit is $0$, so we do not round up the fourth digit. The number, rounded to four significant figures, is $250,000$. To unambiguously represent this with four significant figures, we use scientific notation.\n$$\nr \\approx 2.500 \\times 10^5\n$$\nThis large value of $r$ highlights the severe inaccuracy of the arithmetic mean approximation for flux in media with high conductivity contrast.",
            "answer": "$$\n\\boxed{2.500 \\times 10^5}\n$$"
        },
        {
            "introduction": "Building on the insight that simple averaging can fail, we now tackle the challenge of formulating fluxes on more general, non-orthogonal meshes. In this practical scenario, a naive, one-sided flux approximation can break the symmetry of the discrete system—a property crucial for both physical realism and numerical efficiency. This exercise guides you through the derivation of a corrected two-point symmetric transmissibility, a cornerstone of robust cell-centered finite volume methods that ensures consistency regardless of mesh geometry .",
            "id": "3579382",
            "problem": "Consider the steady diffusion equation in two spatial dimensions, governed by the conservation law $\\nabla \\cdot \\boldsymbol{q} = 0$ and Fourier’s law $\\boldsymbol{q} = -k \\nabla u$, with piecewise constant isotropic conductivity $k$. In a cell-centered Finite Volume Method (FVM), consider two adjacent polygonal control volumes $V_{1}$ and $V_{2}$ with centroids at $\\boldsymbol{x}_{1}$ and $\\boldsymbol{x}_{2}$ that share an interior face $f$ of area (edge length in two dimensions) $A_{f}$ and unit normal $\\hat{\\boldsymbol{n}}_{f}$ oriented from $V_{1}$ to $V_{2}$. Let the signed distances from the centroids to the face plane along $\\hat{\\boldsymbol{n}}_{f}$ be $d_{1f} > 0$ and $d_{2f} > 0$, defined by $d_{1f} = \\hat{\\boldsymbol{n}}_{f} \\cdot (\\boldsymbol{x}_{f} - \\boldsymbol{x}_{1})$ and $d_{2f} = \\hat{\\boldsymbol{n}}_{f} \\cdot (\\boldsymbol{x}_{2} - \\boldsymbol{x}_{f})$, where $\\boldsymbol{x}_{f}$ is the centroid of face $f$. On a skewed mesh, $\\boldsymbol{x}_{2} - \\boldsymbol{x}_{1}$ is not colinear with $\\hat{\\boldsymbol{n}}_{f}$, so generally $d_{1f} \\neq d_{2f}$.\n\nA common but flawed face-assembly in cell-centered discretizations is to assign one-sided, face-normal flux contributions per row using local distances only, namely $a_{12}^{\\text{naive}} = k_{2} A_{f} / d_{2f}$ in the row of $V_{1}$ and $a_{21}^{\\text{naive}} = k_{1} A_{f} / d_{1f}$ in the row of $V_{2}$. This breaks the off-diagonal symmetry required for a symmetric positive definite operator whenever $d_{1f} \\neq d_{2f}$ or $k_{1} \\neq k_{2}$. As a concrete counterexample, take $k_{1} = k_{2} = 1$, $A_{f} = 1$, $d_{1f} = 0.3$, and $d_{2f} = 0.7$; then $a_{12}^{\\text{naive}} \\neq a_{21}^{\\text{naive}}$. Assume all quantities are non-dimensionalized so that units do not appear in the final result.\n\nStarting from the conservation law integrated over each control volume and continuity of the normal flux across $f$, derive a corrected two-point face transmissibility $T_{f}$ that restores symmetry by enforcing $a_{12} = a_{21} = T_{f}$ for the shared face $f$, expressed only in terms of $A_{f}$, $k_{1}$, $k_{2}$, $d_{1f}$, and $d_{2f}$. Your final answer must be a single, closed-form analytic expression for $T_{f}$. Do not provide an inequality or an equation; provide only the expression itself.",
            "solution": "The goal is to determine the flux $F_f$ across the face $f$ shared by control volumes $V_1$ and $V_2$ as a function of the cell-centered values $u_1$ and $u_2$. The flux is expressed in the form $F_f = T_f(u_1 - u_2)$, where $T_f$ is the transmissibility we seek to derive.\n\nThe total flux $F_f$ across the face $f$ from $V_1$ to $V_2$ is given by the integral of the normal component of the flux vector $\\boldsymbol{q}$ over the face area:\n$$F_f = \\int_f \\boldsymbol{q} \\cdot \\hat{\\boldsymbol{n}}_f \\, dS$$\nAssuming the flux is uniform across the face, we can approximate this as:\n$$F_f \\approx A_f (\\boldsymbol{q}|_f \\cdot \\hat{\\boldsymbol{n}}_f)$$\nUsing Fourier's law, $\\boldsymbol{q} = -k \\nabla u$, this becomes:\n$$F_f \\approx -A_f (k \\nabla u)|_f \\cdot \\hat{\\boldsymbol{n}}_f = -A_f k_f \\frac{\\partial u}{\\partial n}\\bigg|_f$$\nwhere $k_f$ is the conductivity at the face and $\\frac{\\partial u}{\\partial n}|_f$ is the normal derivative of $u$ at the face.\n\nThe core of the two-point flux approximation is to relate the face value of the potential, $u_f$, and its normal derivative to the cell-centered values $u_1$ and $u_2$. We assume a one-dimensional variation of the potential $u$ along the direction normal to the face in the region near the face.\n\nLet $u_f$ be the value of the potential at the face centroid $\\boldsymbol{x}_f$. We can express the flux from two perspectives: from cell $V_1$ to the face $f$, and from the face $f$ to cell $V_2$.\n\n1.  **Flux from $V_1$ to $f$**: The normal derivative inside $V_1$ at the face can be approximated using a finite difference over the normal distance $d_{1f}$. The conductivity in this region is $k_1$.\n    $$F_f \\approx -A_f k_1 \\frac{u_f - u_1}{d_{1f}} = A_f \\frac{k_1}{d_{1f}}(u_1 - u_f)$$\n\n2.  **Flux from $f$ to $V_2$**: Similarly, the normal derivative inside $V_2$ at the face can be approximated using the normal distance $d_{2f}$ and conductivity $k_2$.\n    $$F_f \\approx -A_f k_2 \\frac{u_2 - u_f}{d_{2f}} = A_f \\frac{k_2}{d_{2f}}(u_f - u_2)$$\n\nFor steady-state diffusion without sources or sinks at the face, the flux must be continuous. Therefore, we equate the two expressions for $F_f$:\n$$A_f \\frac{k_1}{d_{1f}}(u_1 - u_f) = A_f \\frac{k_2}{d_{2f}}(u_f - u_2)$$\nWe can cancel the face area $A_f$ and solve for the unknown face potential $u_f$:\n$$\\frac{k_1}{d_{1f}} u_1 - \\frac{k_1}{d_{1f}} u_f = \\frac{k_2}{d_{2f}} u_f - \\frac{k_2}{d_{2f}} u_2$$\n$$\\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2 = u_f \\left( \\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}} \\right)$$\n$$u_f = \\frac{\\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}}$$\nThis shows that $u_f$ is a weighted average of $u_1$ and $u_2$.\n\nNow, we substitute this expression for $u_f$ back into one of the flux equations to eliminate the intermediate variable $u_f$ and obtain a flux expression solely in terms of $u_1$ and $u_2$.\n$$F_f = A_f \\frac{k_1}{d_{1f}}(u_1 - u_f) = A_f \\frac{k_1}{d_{1f}} \\left( u_1 - \\frac{\\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} \\right)$$\nTo simplify the term in the parentheses:\n$$u_1 - u_f = \\frac{u_1 \\left( \\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}} \\right) - \\left( \\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2 \\right)}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} = \\frac{\\frac{k_2}{d_{2f}}(u_1 - u_2)}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}}$$\nSubstituting this back into the expression for $F_f$:\n$$F_f = A_f \\frac{k_1}{d_{1f}} \\left( \\frac{\\frac{k_2}{d_{2f}}(u_1 - u_2)}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} \\right) = A_f \\left( \\frac{\\frac{k_1 k_2}{d_{1f} d_{2f}}}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} \\right) (u_1 - u_2)$$\nThe term multiplying $(u_1 - u_2)$ is the transmissibility $T_f$:\n$$T_f = A_f \\left( \\frac{\\frac{k_1 k_2}{d_{1f} d_{2f}}}{\\frac{k_1 d_{2f} + k_2 d_{1f}}{d_{1f} d_{2f}}} \\right)$$\nSimplifying this expression yields the final form for the symmetric transmissibility:\n$$T_f = \\frac{A_f k_1 k_2}{k_2 d_{1f} + k_1 d_{2f}}$$\nThis can be interpreted as the reciprocal of the sum of two resistances in series, $T_f = \\left(\\frac{d_{1f}}{k_1 A_f} + \\frac{d_{2f}}{k_2 A_f}\\right)^{-1}$, which is the harmonic mean of the half-cell conductivities scaled by the area $A_f$.",
            "answer": "$$\\boxed{\\frac{A_f k_1 k_2}{k_2 d_{1f} + k_1 d_{2f}}}$$"
        },
        {
            "introduction": "After developing and implementing sophisticated numerical schemes, how can we be confident that our code is free of bugs? This practice introduces the Method of Manufactured Solutions (MMS), a powerful and standard technique for code verification. By assuming a desired analytical solution, you will work backwards to derive the corresponding source term, thereby creating a benchmark problem where the exact solution is known and allowing for a rigorous and quantitative assessment of your implementation's accuracy .",
            "id": "3579337",
            "problem": "Consider the steady diffusion equation used in computational geophysics to model conductive transport of heat or mass,\n$$-\\nabla \\cdot \\left( \\mathbf{K}(\\mathbf{x}) \\nabla u(\\mathbf{x}) \\right) = s(\\mathbf{x}) \\quad \\text{in } \\Omega,$$\nposed on the unit square domain $\\Omega = (0,1) \\times (0,1)$ with outward unit normal $\\mathbf{n}$. The governing law arises from conservation of a scalar quantity and a linear constitutive relation, where the flux is $\\mathbf{q} = -\\mathbf{K}\\nabla u$, and the local balance over a control volume $V \\subset \\Omega$ reads\n$$\\int_{V} s \\, \\mathrm{d}V = -\\int_{\\partial V} \\mathbf{n}\\cdot \\mathbf{K}\\nabla u \\, \\mathrm{d}A.$$\nThis partial differential equation is the common continuous target for both cell-centered and vertex-centered spatial discretizations. To validate both discretizations with exact boundary treatment via the method of manufactured solutions, we prescribe the manufactured solution\n$$u(x,y) = \\sin(\\pi x)\\,\\sin(\\pi y),$$\nand the symmetric, spatially varying conductivity tensor\n$$\\mathbf{K}(x,y) = \n\\begin{pmatrix}\n1 + x^{2} & x y \\\\\nx y & 2 + y^{2}\n\\end{pmatrix},$$\nwhich is positive definite for $(x,y)\\in \\Omega$. Dirichlet data on any Dirichlet boundary are to be set by the exact manufactured solution, $u|_{\\Gamma_{D}}$, and Neumann data on any Neumann boundary are to be set by the exact outward flux, $q_{N} := -\\mathbf{n}\\cdot \\mathbf{K}\\nabla u|_{\\Gamma_{N}}$, so that the boundary is treated exactly in either a cell-centered or a vertex-centered scheme.\n\nStarting from the conservation statement and the constitutive law, and without using any pre-derived shortcut formulas, derive the unique closed-form expression of the source term $s(x,y)$ in the strong form that makes $u(x,y)$ an exact solution of the model with the given $\\mathbf{K}(x,y)$. Your final answer must be the single analytic expression for $s(x,y)$. You do not need to report boundary data in the final answer. No rounding is required and no physical units are needed.",
            "solution": "To find the source term $s(x,y)$ that satisfies the equation $-\\nabla \\cdot \\left( \\mathbf{K}(\\mathbf{x}) \\nabla u(\\mathbf{x}) \\right) = s(\\mathbf{x})$, we substitute the given expressions for the manufactured solution $u(x,y)$ and conductivity tensor $\\mathbf{K}(x,y)$ into the left-hand side of the partial differential equation.\n\nThe provided manufactured solution is\n$$u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$$\nand the conductivity tensor is\n$$\\mathbf{K}(x,y) = \n\\begin{pmatrix}\n1 + x^{2} & x y \\\\\nx y & 2 + y^{2}\n\\end{pmatrix}$$\n\nFirst, we compute the gradient of the scalar field $u(x,y)$, which is $\\nabla u = \\begin{pmatrix} \\frac{\\partial u}{\\partial x} \\\\ \\frac{\\partial u}{\\partial y} \\end{pmatrix}$.\nThe partial derivatives of $u(x,y)$ are:\n$$\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sin(\\pi x)\\sin(\\pi y) \\right) = \\pi\\cos(\\pi x)\\sin(\\pi y)$$\n$$\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sin(\\pi x)\\sin(\\pi y) \\right) = \\pi\\sin(\\pi x)\\cos(\\pi y)$$\nSo, the gradient vector is:\n$$\\nabla u(x,y) = \\begin{pmatrix} \\pi\\cos(\\pi x)\\sin(\\pi y) \\\\ \\pi\\sin(\\pi x)\\cos(\\pi y) \\end{pmatrix}$$\n\nNext, we compute the vector field $\\mathbf{F}(x,y) = \\mathbf{K}(x,y)\\nabla u(x,y)$. The source term will then be $s = -\\nabla \\cdot \\mathbf{F}$.\n$$\\mathbf{F}(x,y) = \\begin{pmatrix} 1 + x^{2} & x y \\\\ x y & 2 + y^{2} \\end{pmatrix} \\begin{pmatrix} \\pi\\cos(\\pi x)\\sin(\\pi y) \\\\ \\pi\\sin(\\pi x)\\cos(\\pi y) \\end{pmatrix}$$\nPerforming the matrix-vector multiplication gives the components of $\\mathbf{F} = \\begin{pmatrix} F_x \\\\ F_y \\end{pmatrix}$:\n$$F_x = \\pi(1+x^2)\\cos(\\pi x)\\sin(\\pi y) + \\pi xy\\sin(\\pi x)\\cos(\\pi y)$$\n$$F_y = \\pi xy\\cos(\\pi x)\\sin(\\pi y) + \\pi(2+y^2)\\sin(\\pi x)\\cos(\\pi y)$$\n\nNow, we compute the divergence of $\\mathbf{F}$, which is $\\nabla \\cdot \\mathbf{F} = \\frac{\\partial F_x}{\\partial x} + \\frac{\\partial F_y}{\\partial y}$. We calculate each partial derivative separately.\nFor $\\frac{\\partial F_x}{\\partial x}$:\n$$\n\\frac{\\partial F_x}{\\partial x} = \\pi\\sin(\\pi y) \\left[ 2x\\cos(\\pi x) - \\pi(1+x^2)\\sin(\\pi x) \\right] + \\pi y\\cos(\\pi y) \\left[ \\sin(\\pi x) + \\pi x\\cos(\\pi x) \\right]\n$$\n$$= 2\\pi x\\cos(\\pi x)\\sin(\\pi y) - \\pi^2(1+x^2)\\sin(\\pi x)\\sin(\\pi y) + \\pi y\\sin(\\pi x)\\cos(\\pi y) + \\pi^2 xy\\cos(\\pi x)\\cos(\\pi y)$$\n\nFor $\\frac{\\partial F_y}{\\partial y}$:\n$$\n\\frac{\\partial F_y}{\\partial y} = \\pi x\\cos(\\pi x) \\left[ \\sin(\\pi y) + \\pi y\\cos(\\pi y) \\right] + \\pi\\sin(\\pi x) \\left[ 2y\\cos(\\pi y) - \\pi(2+y^2)\\sin(\\pi y) \\right]\n$$\n$$= \\pi x\\cos(\\pi x)\\sin(\\pi y) + \\pi^2 xy\\cos(\\pi x)\\cos(\\pi y) + 2\\pi y\\sin(\\pi x)\\cos(\\pi y) - \\pi^2(2+y^2)\\sin(\\pi x)\\sin(\\pi y)$$\n\nNow we sum the two partial derivatives to find $\\nabla \\cdot \\mathbf{F}$:\n$$\\nabla \\cdot \\mathbf{F} = \\left( 2\\pi x\\cos(\\pi x)\\sin(\\pi y) - \\pi^2(1+x^2)\\sin(\\pi x)\\sin(\\pi y) + \\pi y\\sin(\\pi x)\\cos(\\pi y) + \\pi^2 xy\\cos(\\pi x)\\cos(\\pi y) \\right) \\\\ + \\left( \\pi x\\cos(\\pi x)\\sin(\\pi y) + \\pi^2 xy\\cos(\\pi x)\\cos(\\pi y) + 2\\pi y\\sin(\\pi x)\\cos(\\pi y) - \\pi^2(2+y^2)\\sin(\\pi x)\\sin(\\pi y) \\right)$$\nGrouping terms by their trigonometric factors gives:\n$$\\nabla \\cdot (\\mathbf{K}\\nabla u) = -\\pi^2(3+x^2+y^2)\\sin(\\pi x)\\sin(\\pi y) + 3\\pi x\\cos(\\pi x)\\sin(\\pi y) + 3\\pi y\\sin(\\pi x)\\cos(\\pi y) + 2\\pi^2 xy\\cos(\\pi x)\\cos(\\pi y)$$\n\nThe source term is $s(x,y) = -\\nabla \\cdot (\\mathbf{K}\\nabla u)$. Therefore, we negate the expression above:\n$$s(x,y) = \\pi^2(3+x^2+y^2)\\sin(\\pi x)\\sin(\\pi y) - 3\\pi x\\cos(\\pi x)\\sin(\\pi y) - 3\\pi y\\sin(\\pi x)\\cos(\\pi y) - 2\\pi^2 xy\\cos(\\pi x)\\cos(\\pi y)$$\nThis is the unique closed-form expression for the source term.",
            "answer": "$$\\boxed{\\pi^{2}(3+x^{2}+y^{2})\\sin(\\pi x)\\sin(\\pi y) - 3\\pi x\\cos(\\pi x)\\sin(\\pi y) - 3\\pi y\\sin(\\pi x)\\cos(\\pi y) - 2\\pi^{2}xy\\cos(\\pi x)\\cos(\\pi y)}$$"
        }
    ]
}