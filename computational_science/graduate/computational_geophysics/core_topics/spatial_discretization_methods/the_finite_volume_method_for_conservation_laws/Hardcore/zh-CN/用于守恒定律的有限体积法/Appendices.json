{
    "hands_on_practices": [
        {
            "introduction": "本练习将聚焦于非结构网格上有限体积法的基本几何要素。在近似计算通量之前，我们必须能准确地表示控制体积本身。这项实践涉及从顶点坐标计算面元面积和朝外的法向量等关键几何属性，这是为复杂几何形状构建任何有限体积代码的至关重要的第一步。",
            "id": "3616607",
            "problem": "考虑一个三角化区域中的单个控制体，该控制体由一个四面体单元定义。四面体的顶点坐标（单位为 $\\mathrm{m}$）分别为 $V_{0}=(0,0,0)$、$V_{1}=(2,0,0)$、$V_{2}=(0,3,0)$ 和 $V_{3}=(0,0,6)$。对于形式为 $\\nabla \\cdot \\boldsymbol{u} = s$ 的守恒律（其中 $\\boldsymbol{u}$ 是给定的速度场，$s$ 是源项），将此四面体视为有限体积法（Finite Volume Method, FVM）中的一个控制体。通过控制体边界的体积通量由 $\\boldsymbol{u} \\cdot \\boldsymbol{n}$ 在边界上的面积分给出，其中 $\\boldsymbol{n}$ 是外向单位法向量。\n\n一个散度协调的离散化方法要求对四面体的每个三角形面 $f$ 执行以下几何和定向步骤：仅使用顶点坐标计算面心、面面积 $A_{f}$ 和外向单位法向量 $\\boldsymbol{n}_{f}$。使用以下几何构造以确保正确定向：对于一个具有有序顶点 $(\\boldsymbol{v}_{1},\\boldsymbol{v}_{2},\\boldsymbol{v}_{3})$ 的面，定义其有向面积矢量为 $\\boldsymbol{S}_{f}=\\tfrac{1}{2}[(\\boldsymbol{v}_{2}-\\boldsymbol{v}_{1}) \\times (\\boldsymbol{v}_{3}-\\boldsymbol{v}_{1})]$，并在必要时翻转 $\\boldsymbol{S}_{f}$ 的符号，以使 $\\boldsymbol{S}_{f} \\cdot (\\boldsymbol{x}_{f}-\\boldsymbol{x}_{c})0$ 成立，其中 $\\boldsymbol{x}_{f}$ 是面心，$\\boldsymbol{x}_{c}$ 是单元中心。然后，$A_{f}=|\\boldsymbol{S}_{f}|$ 且 $\\boldsymbol{n}_{f}=\\boldsymbol{S}_{f}/|\\boldsymbol{S}_{f}|$。\n\n设速度场为 $\\boldsymbol{u}(x,y,z)=(\\alpha x,\\, \\beta y,\\, \\gamma z)$，其中 $\\alpha=1\\,\\mathrm{s}^{-1}$，$\\beta=2\\,\\mathrm{s}^{-1}$，$\\gamma=2\\,\\mathrm{s}^{-1}$。对于每个面 $f$，在其面心 $\\boldsymbol{x}_{f}$ 处计算 $\\boldsymbol{u}$，计算有向面通量 $\\Phi_{f}=\\boldsymbol{u}(\\boldsymbol{x}_{f}) \\cdot \\boldsymbol{n}_{f}\\,A_{f}=\\boldsymbol{u}(\\boldsymbol{x}_{f}) \\cdot \\boldsymbol{S}_{f}$，然后对所有面求和，以获得通过四面体边界的净外向体积通量。\n\n从守恒的积分形式（净外向通量等于 $\\boldsymbol{u}\\cdot \\boldsymbol{n}$ 在边界上的面积分）出发，并仅使用上述定义，从顶点坐标开始进行显式计算。给出净外向体积通量的最终数值。答案以 $\\mathrm{m}^{3}/\\mathrm{s}$ 为单位，并四舍五入到四位有效数字。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确且客观。它为有限体积法背景下的一个标准数值分析问题提供了一个完整且一致的设定。我们可以开始求解。\n\n目标是计算通过四面体控制体边界的净外向体积通量。问题指定，这需要通过对四面体的四个面上的通量求和来完成，其中每个面通量使用中点法则进行近似。净通量 $\\Phi_{\\text{net}}$ 由下式给出：\n$$\n\\Phi_{\\text{net}} = \\sum_{f} \\Phi_f = \\sum_{f} \\boldsymbol{u}(\\boldsymbol{x}_f) \\cdot \\boldsymbol{S}_f\n$$\n其中，求和遍及四面体的四个面，$\\boldsymbol{x}_f$ 是面 $f$ 的面心，$\\boldsymbol{S}_f$ 是面 $f$ 的有向面积矢量。\n\n四面体的顶点坐标（单位为米）分别为 $V_{0}=(0,0,0)$、$V_{1}=(2,0,0)$、$V_{2}=(0,3,0)$ 和 $V_{3}=(0,0,6)$。\n速度场为 $\\boldsymbol{u}(x,y,z) = (\\alpha x, \\beta y, \\gamma z)$，常数 $\\alpha = 1\\,\\mathrm{s}^{-1}$，$\\beta = 2\\,\\mathrm{s}^{-1}$，$\\gamma = 2\\,\\mathrm{s}^{-1}$。\n\n首先，我们计算四面体单元的中心 $\\boldsymbol{x}_c$：\n$$\n\\boldsymbol{x}_c = \\frac{1}{4} (V_0 + V_1 + V_2 + V_3) = \\frac{1}{4} ((0,0,0) + (2,0,0) + (0,3,0) + (0,0,6))\n$$\n$$\n\\boldsymbol{x}_c = \\frac{1}{4} (2, 3, 6) = (0.5, 0.75, 1.5)\n$$\n\n四面体的四个面是：\n1.  $f_1$：位于 $xy$ 平面上的面，顶点为 $(V_0, V_1, V_2)$。\n2.  $f_2$：位于 $xz$ 平面上的面，顶点为 $(V_0, V_1, V_3)$。\n3.  $f_3$：位于 $yz$ 平面上的面，顶点为 $(V_0, V_2, V_3)$。\n4.  $f_4$：斜面，顶点为 $(V_1, V_2, V_3)$。\n\n现在我们将根据指定的步骤计算每个面的通量。\n\n**面 1：顶点 $(V_0, V_1, V_2)$**\n我们将顶点排序为 $(\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3) = (V_0, V_1, V_2)$。\n初始有向面积矢量 $\\boldsymbol{S}_{f_1}'$ 为：\n$$\n\\boldsymbol{S}_{f_1}' = \\frac{1}{2} ( (V_1 - V_0) \\times (V_2 - V_0) ) = \\frac{1}{2} ( (2,0,0) \\times (0,3,0) ) = \\frac{1}{2} (0,0,6) = (0,0,3)\n$$\n面心 $\\boldsymbol{x}_{f_1}$ 为：\n$$\n\\boldsymbol{x}_{f_1} = \\frac{1}{3} (V_0 + V_1 + V_2) = \\frac{1}{3} (2,3,0)\n$$\n为确定外向方向，我们检查 $\\boldsymbol{S}_{f_1}' \\cdot (\\boldsymbol{x}_{f_1} - \\boldsymbol{x}_c)$ 的符号：\n$$\n(0,0,3) \\cdot \\left( \\frac{1}{3}(2,3,0) - \\frac{1}{4}(2,3,6) \\right) = (0,0,3) \\cdot \\left( \\frac{2}{3} - \\frac{1}{2}, 1 - \\frac{3}{4}, 0 - \\frac{3}{2} \\right) = (0,0,3) \\cdot \\left( \\frac{1}{6}, \\frac{1}{4}, -\\frac{3}{2} \\right) = -4.5\n$$\n由于结果为负，我们必须翻转符号。正确定向的面积矢量为 $\\boldsymbol{S}_{f_1} = -\\boldsymbol{S}_{f_1}' = (0,0,-3)$。\n面心处的速度为 $\\boldsymbol{u}(\\boldsymbol{x}_{f_1}) = (\\alpha \\frac{2}{3}, \\beta \\cdot 1, \\gamma \\cdot 0) = (1 \\cdot \\frac{2}{3}, 2 \\cdot 1, 2 \\cdot 0) = (\\frac{2}{3}, 2, 0)$。\n通过面 $f_1$ 的通量为：\n$$\n\\Phi_{f_1} = \\boldsymbol{u}(\\boldsymbol{x}_{f_1}) \\cdot \\boldsymbol{S}_{f_1} = (\\frac{2}{3}, 2, 0) \\cdot (0,0,-3) = 0\n$$\n\n**面 2：顶点 $(V_0, V_1, V_3)$**\n我们将顶点排序为 $(\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3) = (V_0, V_3, V_1)$。\n初始有向面积矢量 $\\boldsymbol{S}_{f_2}'$ 为：\n$$\n\\boldsymbol{S}_{f_2}' = \\frac{1}{2} ( (V_3 - V_0) \\times (V_1 - V_0) ) = \\frac{1}{2} ( (0,0,6) \\times (2,0,0) ) = \\frac{1}{2} (0,12,0) = (0,6,0)\n$$\n面心 $\\boldsymbol{x}_{f_2}$ 为：\n$$\n\\boldsymbol{x}_{f_2} = \\frac{1}{3} (V_0 + V_1 + V_3) = \\frac{1}{3} (2,0,6)\n$$\n检查方向：\n$$\n(0,6,0) \\cdot \\left( \\frac{1}{3}(2,0,6) - \\frac{1}{4}(2,3,6) \\right) = (0,6,0) \\cdot \\left( \\frac{2}{3} - \\frac{1}{2}, 0 - \\frac{3}{4}, 2 - \\frac{3}{2} \\right) = (0,6,0) \\cdot \\left( \\frac{1}{6}, -\\frac{3}{4}, \\frac{1}{2} \\right) = -4.5\n$$\n结果为负，所以 $\\boldsymbol{S}_{f_2} = -\\boldsymbol{S}_{f_2}' = (0,-6,0)$。\n面心处的速度为 $\\boldsymbol{u}(\\boldsymbol{x}_{f_2}) = (\\alpha \\frac{2}{3}, \\beta \\cdot 0, \\gamma \\cdot 2) = (1 \\cdot \\frac{2}{3}, 2 \\cdot 0, 2 \\cdot 2) = (\\frac{2}{3}, 0, 4)$。\n通过面 $f_2$ 的通量为：\n$$\n\\Phi_{f_2} = \\boldsymbol{u}(\\boldsymbol{x}_{f_2}) \\cdot \\boldsymbol{S}_{f_2} = (\\frac{2}{3}, 0, 4) \\cdot (0,-6,0) = 0\n$$\n\n**面 3：顶点 $(V_0, V_2, V_3)$**\n我们将顶点排序为 $(\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3) = (V_0, V_2, V_3)$。\n初始有向面积矢量 $\\boldsymbol{S}_{f_3}'$ 为：\n$$\n\\boldsymbol{S}_{f_3}' = \\frac{1}{2} ( (V_2 - V_0) \\times (V_3 - V_0) ) = \\frac{1}{2} ( (0,3,0) \\times (0,0,6) ) = \\frac{1}{2} (18,0,0) = (9,0,0)\n$$\n面心 $\\boldsymbol{x}_{f_3}$ 为：\n$$\n\\boldsymbol{x}_{f_3} = \\frac{1}{3} (V_0 + V_2 + V_3) = \\frac{1}{3} (0,3,6) = (0,1,2)\n$$\n检查方向：\n$$\n(9,0,0) \\cdot \\left( (0,1,2) - (0.5, 0.75, 1.5) \\right) = (9,0,0) \\cdot (-0.5, 0.25, 0.5) = -4.5\n$$\n结果为负，所以 $\\boldsymbol{S}_{f_3} = -\\boldsymbol{S}_{f_3}' = (-9,0,0)$。\n面心处的速度为 $\\boldsymbol{u}(\\boldsymbol{x}_{f_3}) = (\\alpha \\cdot 0, \\beta \\cdot 1, \\gamma \\cdot 2) = (1 \\cdot 0, 2 \\cdot 1, 2 \\cdot 2) = (0,2,4)$。\n通过面 $f_3$ 的通量为：\n$$\n\\Phi_{f_3} = \\boldsymbol{u}(\\boldsymbol{x}_{f_3}) \\cdot \\boldsymbol{S}_{f_3} = (0,2,4) \\cdot (-9,0,0) = 0\n$$\n通过坐标平面上三个面的通量均为零，因为对于每个这样的面，速度在该面上任意点处的法向分量都为零。\n\n**面 4：顶点 $(V_1, V_2, V_3)$**\n我们将顶点排序为 $(\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3) = (V_1, V_2, V_3)$。\n初始有向面积矢量 $\\boldsymbol{S}_{f_4}'$ 为：\n$$\n\\boldsymbol{S}_{f_4}' = \\frac{1}{2} ( (V_2 - V_1) \\times (V_3 - V_1) ) = \\frac{1}{2} ( (-2,3,0) \\times (-2,0,6) ) = \\frac{1}{2} (18,12,6) = (9,6,3)\n$$\n面心 $\\boldsymbol{x}_{f_4}$ 为：\n$$\n\\boldsymbol{x}_{f_4} = \\frac{1}{3} (V_1 + V_2 + V_3) = \\frac{1}{3} (2,3,6)\n$$\n检查方向：\n$$\n(9,6,3) \\cdot \\left( \\frac{1}{3}(2,3,6) - \\frac{1}{4}(2,3,6) \\right) = (9,6,3) \\cdot \\left( \\frac{1}{12}(2,3,6) \\right) = \\frac{1}{12} (18+18+18) = \\frac{54}{12} = 4.5\n$$\n结果为正，所以方向已是向外：$\\boldsymbol{S}_{f_4} = \\boldsymbol{S}_{f_4}' = (9,6,3)$。\n面心处的速度为 $\\boldsymbol{u}(\\boldsymbol{x}_{f_4}) = (\\alpha \\frac{2}{3}, \\beta \\cdot 1, \\gamma \\cdot 2) = (1 \\cdot \\frac{2}{3}, 2 \\cdot 1, 2 \\cdot 2) = (\\frac{2}{3}, 2, 4)$。\n通过面 $f_4$ 的通量为：\n$$\n\\Phi_{f_4} = \\boldsymbol{u}(\\boldsymbol{x}_{f_4}) \\cdot \\boldsymbol{S}_{f_4} = (\\frac{2}{3}, 2, 4) \\cdot (9,6,3) = (\\frac{2}{3})(9) + (2)(6) + (4)(3) = 6 + 12 + 12 = 30\n$$\n\n**总净通量**\n净外向体积通量是所有四个面通量的总和：\n$$\n\\Phi_{\\text{net}} = \\Phi_{f_1} + \\Phi_{f_2} + \\Phi_{f_3} + \\Phi_{f_4} = 0 + 0 + 0 + 30 = 30\n$$\n单位是 $\\mathrm{m}^3/\\mathrm{s}$。问题要求四舍五入到四位有效数字，所以答案是 $30.00\\,\\mathrm{m}^3/\\mathrm{s}$。\n\n作为验证，我们可以使用散度定理。精确的净通量是速度场散度的体积分：\n$$\n\\Phi_{\\text{net, exact}} = \\int_V (\\nabla \\cdot \\boldsymbol{u}) \\, dV\n$$\n$\\boldsymbol{u}$ 的散度是：\n$$\n\\nabla \\cdot \\boldsymbol{u} = \\frac{\\partial}{\\partial x}(\\alpha x) + \\frac{\\partial}{\\partial y}(\\beta y) + \\frac{\\partial}{\\partial z}(\\gamma z) = \\alpha + \\beta + \\gamma = 1 + 2 + 2 = 5\\,\\mathrm{s}^{-1}\n$$\n由于散度是常数，通量等于 $(\\alpha + \\beta + \\gamma)$ 乘以四面体的体积 $\\mathcal{V}$：\n$$\n\\mathcal{V} = \\frac{1}{6} |(V_1-V_0) \\cdot ((V_2-V_0) \\times (V_3-V_0))| = \\frac{1}{6} |(2,0,0) \\cdot ((0,3,0) \\times (0,0,6))| = \\frac{1}{6} |(2,0,0) \\cdot (18,0,0)| = \\frac{36}{6} = 6\\,\\mathrm{m}^3\n$$\n因此，精确的通量是：\n$$\n\\Phi_{\\text{net, exact}} = (5\\,\\mathrm{s}^{-1}) \\times (6\\,\\mathrm{m}^3) = 30\\,\\mathrm{m}^3/\\mathrm{s}\n$$\n问题中规定的数值方法（对面积分使用中点法则）对于多边形/多面体域上的线性速度场是精确的，因此我们计算的结果与精确的解析解相匹配。\n\n最终答案，四舍五入到四位有效数字，是 $30.00\\,\\mathrm{m}^3/\\mathrm{s}$。",
            "answer": "$$\\boxed{30.00}$$"
        },
        {
            "introduction": "数值格式并非精确求解原始的偏微分方程，而是求解一个包含了高阶误差项的“修正方程”。本练习通过推导广泛使用的 Lax-Friedrichs 通量的修正方程，深入分析这些误差。理解这个修正方程使我们能够量化格式引入的人工粘性，并预测其对解特征（例如激波的展宽）的影响。",
            "id": "3616566",
            "problem": "考虑标量守恒律偏微分方程 (PDE) $u_{t} + f(u)_{x} = 0$，该方程在一个间距为 $\\Delta x$ 的均匀一维网格上，通过守恒型有限体积 (FV) 方法进行离散。令 $u_{i}(t)$ 表示单元 $i$ 中的单元平均值。半离散 FV 格式为\n$$\n\\frac{d u_{i}}{d t} = -\\frac{1}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right),\n$$\n其中数值通量为全局 Lax–Friedrichs (GLF) 通量\n$$\nF_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(f(u_{i}) + f(u_{i+1})\\right) - \\frac{1}{2}\\,\\alpha\\,(u_{i+1} - u_{i}),\n$$\n其中常数 $\\alpha \\ge \\sup_{u} |f'(u)|$ 被选择以全局地约束特征速度。假设 $u(x,t)$ 在 $\\Delta x$ 的尺度上是光滑的，因此泰勒展开是有效的。\n\n(a) 从上述半离散 FV 格式和 GLF 通量出发，推导主阶空间修正方程，即 $u(x,t)$ 在忽略 $\\mathcal{O}(\\Delta x^{2})$ 阶项的情况下所满足的 PDE，并确定人工粘性项 $\\nu\\,u_{xx}$ 中的系数 $\\nu$。\n\n(b) 现在特化为无粘 Burgers 通量 $f(u) = \\frac{1}{2}u^{2}$，并考虑一个连接左右常数状态 $u_{L}  u_{R}$ 的稳态行进激波，其跳跃幅度为 $\\Delta u = u_{L} - u_{R}  0$。利用 (a) 部分中修正方程的粘性行波分析，将特征激波厚度 $\\delta$ 定义为稳态粘性 Burgers 激波剖面的双曲正切函数自变量中系数的倒数。证明 $\\delta$ 与人工粘性系数成线性关系，并用 $\\nu$ 和 $\\Delta u$ 表示 $\\delta$。然后，通过将跨越激波的网格单元数定义为 $N_{\\text{shock}} = \\delta/\\Delta x$，将此厚度与网格分辨率联系起来，并纯粹用 $\\alpha$ 和 $\\Delta u$ 表示 $N_{\\text{shock}}$。\n\n你的最终答案必须是 $N_{\\text{shock}}$ 关于 $\\alpha$ 和 $\\Delta u$ 的单一闭式解析表达式。不需要进行数值计算。如果引入任何角度量，请以弧度表示。最终答案中不要包含单位。",
            "solution": "用户要求我分两部分解决一个问题。首先，我需要推导带有全局 Lax-Friedrichs 通量的有限体积格式的修正方程。其次，我需要将其应用于 Burgers 方程，以确定解析稳态激波的网格单元数。\n\n该问题在科学上和数学上都是适定的，为严格推导提供了所有必要的信息和定义。这是守恒律数值分析中的一个标准练习。因此，该问题是有效的，我将着手求解。\n\n(a) 主阶空间修正方程的推导。\n\n我们从给定的半离散有限体积格式开始\n$$\n\\frac{d u_{i}}{d t} = -\\frac{1}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)\n$$\n其中 $u_i(t)$ 是解 $u(x,t)$ 在以 $x_i$ 为中心的单元 $i$ 中的单元平均值。对于光滑解，有 $u_i(t) = u(x_i, t) + \\mathcal{O}(\\Delta x^2)$，因此 $\\frac{du_i}{dt} = u_t(x_i, t) + \\mathcal{O}(\\Delta x^2)$。我们将 $u(x_i, t)$ 记为 $u_i$，其空间导数记为 $u_x, u_{xx}$ 等，均在 $x_i$ 处取值。通量 $F_{i+1/2}$ 是全局 Lax-Friedrichs 通量：\n$$\nF_{i+\\frac{1}{2}} = \\frac{1}{2}\\left(f(u_{i}) + f(u_{i+1})\\right) - \\frac{1}{2}\\,\\alpha\\,(u_{i+1} - u_{i})\n$$\n为了找到修正方程，我们对格式右侧在点 $x_i$ 附近进行泰勒级数展开。右侧为\n$$\n-\\frac{1}{\\Delta x} \\left[ \\left(\\frac{1}{2}(f_i + f_{i+1}) - \\frac{\\alpha}{2}(u_{i+1} - u_i)\\right) - \\left(\\frac{1}{2}(f_{i-1} + f_i) - \\frac{\\alpha}{2}(u_i - u_{i-1})\\right) \\right]\n$$\n$$\n= -\\frac{1}{2\\Delta x}(f_{i+1} - f_{i-1}) + \\frac{\\alpha}{2\\Delta x}(u_{i+1} - 2u_i + u_{i-1})\n$$\n我们将项 $u_{i\\pm1}$ 和 $f_{i\\pm1} = f(u_{i\\pm1})$ 在 $x_i$ 附近展开：\n$$\nu_{i\\pm1} = u(x_i \\pm \\Delta x) = u_i \\pm \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} \\pm \\frac{\\Delta x^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4)\n$$\n项 $u_{i+1} - 2u_i + u_{i-1}$ 是 $\\Delta x^2 u_{xx}$ 的标准二阶中心差分近似：\n$$\nu_{i+1} - 2u_i + u_{i-1} = \\Delta x^2 u_{xx} + \\mathcal{O}(\\Delta x^4)\n$$\n项 $f_{i+1} - f_{i-1}$ 是通量函数 $f(u)$ 的中心差分。\n我们将其展开为：\n$$\nf_{i+1} = f(u(x_i+\\Delta x)) = f(u_i) + \\Delta x (f(u))_x + \\frac{\\Delta x^2}{2} (f(u))_{xx} + \\mathcal{O}(\\Delta x^3)\n$$\n$$\nf_{i-1} = f(u(x_i-\\Delta x)) = f(u_i) - \\Delta x (f(u))_x + \\frac{\\Delta x^2}{2} (f(u))_{xx} - \\mathcal{O}(\\Delta x^3)\n$$\n所以，$f_{i+1} - f_{i-1} = 2\\Delta x (f(u))_x + \\mathcal{O}(\\Delta x^3) = 2\\Delta x f'(u)u_x + \\mathcal{O}(\\Delta x^3)$。\n\n将这些展开式代回格式的右侧：\n$$\n-\\frac{1}{2\\Delta x}(2\\Delta x f'(u)u_x + \\mathcal{O}(\\Delta x^3)) + \\frac{\\alpha}{2\\Delta x}(\\Delta x^2 u_{xx} + \\mathcal{O}(\\Delta x^4))\n$$\n$$\n= -f'(u)u_x + \\frac{\\alpha \\Delta x}{2} u_{xx} + \\mathcal{O}(\\Delta x^2)\n$$\n将左侧 ($u_t$) 与此表达式相等，得到修正方程：\n$$\nu_t = -f'(u)u_x + \\frac{\\alpha \\Delta x}{2} u_{xx}\n$$\n它可以重写为\n$$\nu_t + f(u)_x = \\frac{\\alpha \\Delta x}{2} u_{xx}\n$$\n这就是主阶空间修正方程。右侧项是人工粘性项 $\\nu u_{xx}$，其中人工粘性系数由下式给出\n$$\n\\nu = \\frac{\\alpha \\Delta x}{2}\n$$\n\n(b) 无粘 Burgers 方程的激波厚度。\n\n我们特化为无粘 Burgers 通量 $f(u) = \\frac{1}{2}u^2$。修正方程变为粘性 Burgers 方程：\n$$\nu_t + u u_x = \\nu u_{xx}\n$$\n我们寻找形式为 $u(x,t) = U(\\xi)$ 的稳态行波解，其中 $\\xi = x - st$，$s$ 是恒定的波速。偏导数变为关于 $\\xi$ 的常导数：$u_t = -sU'$ 和 $u_x = U'$。代入 PDE，我们得到关于剖面 $U(\\xi)$ 的 ODE：\n$$\n-sU' + UU' = \\nu U''\n$$\n我们将此方程对 $\\xi$ 积分一次：\n$$\n-sU + \\frac{1}{2}U^2 = \\nu U' + C_1\n$$\n其中 $C_1$ 是积分常数。激波在 $\\xi \\to -\\infty$ 时连接左侧常数状态 $u_L$，在 $\\xi \\to +\\infty$ 时连接右側常数状态 $u_R$。在这些极限下，解是常数，因此其导数 $U'$ 必須为零。应用这些边界条件：\n当 $\\xi \\to -\\infty$，$U \\to u_L$ 且 $U' \\to 0$，因此 $-su_L + \\frac{1}{2}u_L^2 = C_1$。\n当 $\\xi \\to +\\infty$，$U \\to u_R$ 且 $U' \\to 0$，因此 $-su_R + \\frac{1}{2}u_R^2 = C_1$。\n令 $C_1$ 的表达式相等，得到 Rankine-Hugoniot 激波速度 $s$：\n$$\n-su_L + \\frac{1}{2}u_L^2 = -su_R + \\frac{1}{2}u_R^2 \\implies s(u_L - u_R) = \\frac{1}{2}(u_L^2 - u_R^2) = \\frac{1}{2}(u_L - u_R)(u_L + u_R)\n$$\n由于 $u_L \\ne u_R$，我们得到 $s = \\frac{1}{2}(u_L + u_R)$。\n\n剖面的 ODE 是 $\\nu U' = -sU + \\frac{1}{2}U^2 - C_1$。对右侧的二次式进行因式分解：\n$$\n\\nu U' = \\frac{1}{2}(U^2 - 2sU - 2C_1) = \\frac{1}{2}(U^2 - (u_L+u_R)U + u_L u_R) = \\frac{1}{2}(U-u_L)(U-u_R)\n$$\n这是一个可分离的 ODE。我们通过分离变量来求解，对于 $u_R  U  u_L$：\n$$\n\\frac{dU}{(U-u_L)(U-u_R)} = \\frac{1}{2\\nu} d\\xi\n$$\n使用部分分式分解，$\\frac{1}{(U-u_L)(U-u_R)} = \\frac{1}{u_L-u_R}\\left(\\frac{1}{U-u_L} - \\frac{1}{U-u_R}\\right)$，我们积分：\n$$\n\\frac{1}{u_L-u_R}\\int\\left(\\frac{1}{U-u_L} - \\frac{1}{U-u_R}\\right)dU = \\int\\frac{1}{2\\nu}d\\xi\n$$\n$$\n\\frac{1}{u_L-u_R}\\left(\\ln|U-u_L| - \\ln|U-u_R|\\right) = \\frac{\\xi}{2\\nu} + C_2 \\implies \\ln\\left(\\frac{u_L-U}{U-u_R}\\right) = \\frac{u_L-u_R}{2\\nu}\\xi + C_3\n$$\n求解 $U$ 并在 $U = (u_L+u_R)/2$ 处设置原点 $\\xi=0$ 以确定积分常数，我们得到经典的双曲正切剖面：\n$$\nU(\\xi) = \\frac{u_L+u_R}{2} - \\frac{u_L-u_R}{2} \\tanh\\left(\\frac{u_L-u_R}{4\\nu}\\xi\\right)\n$$\n问题将特征激波厚度 $\\delta$ 定义为双曲正切函数自变量中 $\\xi$ 的系数的倒数。该系数是 $\\frac{u_L-u_R}{4\\nu}$。\n因此，激波厚度为\n$$\n\\delta = \\left( \\frac{u_L - u_R}{4\\nu} \\right)^{-1} = \\frac{4\\nu}{u_L - u_R}\n$$\n使用跳跃幅度 $\\Delta u = u_L - u_R$ 的定义，我们有 $\\delta = \\frac{4\\nu}{\\Delta u}$。这表明 $\\delta$ 与 $\\nu$ 成线性关系。\n\n最后，我们将此厚度与网格分辨率联系起来。跨越激波的网格单元数定义为 $N_{\\text{shock}} = \\delta/\\Delta x$。代入 $\\delta$ 和 $\\nu = \\frac{\\alpha\\Delta x}{2}$ 的表达式：\n$$\nN_{\\text{shock}} = \\frac{1}{\\Delta x} \\delta = \\frac{1}{\\Delta x} \\frac{4\\nu}{\\Delta u} = \\frac{1}{\\Delta x} \\frac{4}{\\Delta u} \\left(\\frac{\\alpha \\Delta x}{2}\\right)\n$$\n$\\Delta x$ 项消掉了，剩下：\n$$\nN_{\\text{shock}} = \\frac{2\\alpha}{\\Delta u}\n$$\n此表达式给出了激波内的网格单元数，纯粹用全局 Lax-Friedrichs 参数 $\\alpha$ 和激波跳跃幅度 $\\Delta u$ 来表示。",
            "answer": "$$\n\\boxed{\\frac{2\\alpha}{\\Delta u}}\n$$"
        },
        {
            "introduction": "在计算科学中，验证数值代码是否正确实现是一个至关重要的挑战。“人造解方法”（Method of Manufactured Solutions, MMS）为此任务提供了一个严谨的框架，它通过强制代码重现一个预先选定的解析解来达成验证目的。本练习将指导您完成设计一个MMS测试的过程：从一个期望的光滑解出发，您将推导出使其成为控制方程精确解所必需的源项和边界条件。",
            "id": "3616557",
            "problem": "考虑在一个非凸新月形区域上定义的二维空间标量守恒律，\n$$\nu_{t}+\\nabla\\cdot \\boldsymbol{f}(u)=s(\\boldsymbol{x},t)\\quad \\text{in}\\quad \\Omega\\times (0,T],\n$$\n其中 $\\boldsymbol{x}=(x,y)$，$\\Omega=\\{(x,y)\\in\\mathbb{R}^{2}:\\,(x+\\tfrac{1}{5})^{2}+y^{2}1\\ \\text{and}\\ x^{2}+y^{2}\\tfrac{1}{4}\\}$，通量为非线性向量函数 $\\boldsymbol{f}(u)=\\big(\\tfrac{1}{2}u^{2},\\,\\tfrac{1}{3}u^{3}\\big)$。请您为此问题的有限体积法 (FVM) 代码设计一个制造解方法 (MMS) 测试。为此，选择解析场\n$$\nu(\\boldsymbol{x},t)=\\exp(-t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\tfrac{1}{5}xy\\Big).\n$$\n从守恒律的积分形式和散度定理出发，仅使用标准微积分恒等式，推导在 $\\Omega$ 内使 $u(\\boldsymbol{x},t)$ 满足该偏微分方程的精确源项 $s(\\boldsymbol{x},t)$，并为标量守恒律提供与 $\\partial\\Omega$ 上的特征流入相一致的边界数据。对于通量为 $\\boldsymbol{f}(u)$ 的标量守恒律，其平流速度为 $\\boldsymbol{a}(u)=\\boldsymbol{f}'(u)$，因此流入是边界上满足 $\\boldsymbol{a}(u)\\cdot\\boldsymbol{n}0$ 的子集，其中 $\\boldsymbol{n}$ 是向外的单位法向量。将边界数据指定为施加在 $\\partial\\Omega$ 的流入部分上的狄利克雷条件 (Dirichlet condition) $u_{b}(\\boldsymbol{x},t)$。将您的最终答案表示为一个行矩阵，其中包含两个条目，顺序如下：首先是 $s(\\boldsymbol{x},t)$ 的闭式表达式，其次是 $u_{b}(\\boldsymbol{x},t)$ 的闭式表达式。不需要进行数值计算。",
            "solution": "该问题要求为一个应用于二维标量守恒律的制造解方法 (MMS) 测试推导源项 $s(\\boldsymbol{x},t)$ 和边界数据 $u_b(\\boldsymbol{x},t)$。\n\n控制偏微分方程 (PDE) 的微分形式如下：\n$$\n\\frac{\\partial u}{\\partial t} + \\nabla\\cdot \\boldsymbol{f}(u) = s(\\boldsymbol{x},t)\n$$\n守恒律的这种局部微分形式是通过对通量项应用散度定理，并假设所得的被积函数是连续的而推导出来的，对于所提供的光滑制造解，这一假设是成立的。MMS 测试的目标是指定一个解，在此例中为 $u(\\boldsymbol{x},t)$，并推导出使该选定函数成为偏微分方程精确解所必需的源项 $s(\\boldsymbol{x},t)$ 和边界条件。\n\n提供的制造解为：\n$$\nu(\\boldsymbol{x},t) = \\exp(-t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big)\n$$\n非线性通量函数为：\n$$\n\\boldsymbol{f}(u) = \\begin{pmatrix} f_1(u) \\\\ f_2(u) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}u^{2} \\\\ \\frac{1}{3}u^{3} \\end{pmatrix}\n$$\n\n**第 1 部分：源项 $s(\\boldsymbol{x},t)$ 的推导**\n\n为找到与制造解一致的源项 $s(\\boldsymbol{x},t)$，我们对偏微分方程进行重排，并代入 $u(\\boldsymbol{x},t)$ 的表达式：\n$$\ns(\\boldsymbol{x},t) = \\frac{\\partial u}{\\partial t} + \\nabla\\cdot \\boldsymbol{f}(u)\n$$\n我们必须计算右侧的每一项。\n\n首先，计算 $u(\\boldsymbol{x},t)$ 的时间导数：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\exp(-t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big) \\right] = -\\exp(-t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big)\n$$\n注意，$\\frac{\\partial u}{\\partial t} = -u(\\boldsymbol{x},t)$。\n\n其次，计算通量的散度 $\\nabla\\cdot \\boldsymbol{f}(u)$。使用多变量函数的链式法则，我们得到：\n$$\n\\nabla\\cdot \\boldsymbol{f}(u) = \\frac{\\partial}{\\partial x}f_1(u) + \\frac{\\partial}{\\partial y}f_2(u) = \\frac{df_1}{du}\\frac{\\partial u}{\\partial x} + \\frac{df_2}{du}\\frac{\\partial u}{\\partial y}\n$$\n我们求出通量分量相对于 $u$ 的导数：\n$$\n\\frac{df_1}{du} = \\frac{d}{du}\\left(\\frac{1}{2}u^2\\right) = u\n$$\n$$\n\\frac{df_2}{du} = \\frac{d}{du}\\left(\\frac{1}{3}u^3\\right) = u^2\n$$\n因此，散度项变为：\n$$\n\\nabla\\cdot \\boldsymbol{f}(u) = u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial u}{\\partial y}\n$$\n接下来，我们计算 $u(\\boldsymbol{x},t)$ 的空间偏导数：\n$$\n\\frac{\\partial u}{\\partial x} = \\exp(-t)\\frac{\\partial}{\\partial x}\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big) = \\exp(-t)\\Big(2\\pi\\cos(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}y\\Big)\n$$\n$$\n\\frac{\\partial u}{\\partial y} = \\exp(-t)\\frac{\\partial}{\\partial y}\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big) = \\exp(-t)\\Big(-\\pi\\sin(2\\pi x)\\sin(\\pi y)+\\frac{1}{5}x\\Big)\n$$\n现在，我们将所有计算出的导数代回 $s(\\boldsymbol{x},t)$ 的表达式中：\n$$\ns(\\boldsymbol{x},t) = \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial u}{\\partial y}\n$$\n代入 $u$ 及其导数的表达式：\n$$\ns(\\boldsymbol{x},t) = -\\exp(-t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big) \\\\\n+ \\left[\\exp(-t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big)\\right] \\left[\\exp(-t)\\Big(2\\pi\\cos(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}y\\Big)\\right] \\\\\n+ \\left[\\exp(-t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big)\\right]^2 \\left[\\exp(-t)\\Big(-\\pi\\sin(2\\pi x)\\sin(\\pi y)+\\frac{1}{5}x\\Big)\\right]\n$$\n合并指数项，我们得到源项的最终闭式表达式：\n$$\ns(\\boldsymbol{x},t) = -\\exp(-t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big) \\\\\n+ \\exp(-2t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big)\\Big(2\\pi\\cos(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}y\\Big) \\\\\n+ \\exp(-3t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big)^2\\Big(-\\pi\\sin(2\\pi x)\\sin(\\pi y)+\\frac{1}{5}x\\Big)\n$$\n\n**第 2 部分：边界数据 $u_b(\\boldsymbol{x},t)$ 的推导**\n\n对于双曲守恒律，必须在边界 $\\partial\\Omega$ 上特征线进入区域的部分指定边界条件。这就是流入边界，定义为点集 $\\boldsymbol{x} \\in \\partial\\Omega$，其中 $\\boldsymbol{a}(u) \\cdot \\boldsymbol{n}  0$。这里，$\\boldsymbol{n}$ 是边界的向外单位法向量，而 $\\boldsymbol{a}(u)$ 是平流速度。\n\n平流速度由 $\\boldsymbol{a}(u) = \\boldsymbol{f}'(u) = (df_1/du, df_2/du)$ 给出。根据我们之前的计算：\n$$\n\\boldsymbol{a}(u) = (u, u^2)\n$$\n在 MMS 的背景下，狄利克雷条件的边界数据必须与制造解一致。这意味着在任何流入边界点，$u$ 的值必须设置为该点处制造解的值。因此，定义边界数据的函数 $u_b(\\boldsymbol{x},t)$ 就是制造解本身。数值代码会在边界点上计算该函数，并仅在满足流入条件 $\\boldsymbol{a}(u_b(\\boldsymbol{x},t))\\cdot\\boldsymbol{n}  0$ 的地方应用它。\n\n该问题要求此边界数据函数的闭式表达式，即：\n$$\nu_b(\\boldsymbol{x},t) = u(\\boldsymbol{x},t) = \\exp(-t)\\Big(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\Big)\n$$\n\n最终答案由两个推导出的表达式组成，即 $s(\\boldsymbol{x},t)$ 和 $u_b(\\boldsymbol{x},t)$，并按指定顺序呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\exp(-t)\\left(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\right) + \\exp(-2t)\\left(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\right)\\left(2\\pi\\cos(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}y\\right) + \\exp(-3t)\\left(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\right)^{2}\\left(-\\pi\\sin(2\\pi x)\\sin(\\pi y)+\\frac{1}{5}x\\right)  \\exp(-t)\\left(\\sin(2\\pi x)\\cos(\\pi y)+\\frac{1}{5}xy\\right) \\end{pmatrix}}\n$$"
        }
    ]
}