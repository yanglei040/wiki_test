{
    "hands_on_practices": [
        {
            "introduction": "在着手数值求解平流问题之前，我们必须首先掌握其背后的物理原理。本练习聚焦于物质导数（material derivative），它描述了流体微团在随流运动时其自身属性的变化率。我们将直接根据其定义进行计算，以判断一个给定的标量场是否沿质点轨迹守恒 。",
            "id": "3574977",
            "problem": "考虑平面上的一个连续介质，其空间线性、随时间变化的速度场定义为\n$$\n\\mathbf{u}(x,y,t) \\;=\\; \\alpha_{0}\\cos(\\omega t)\\,(x,\\,y)\\;+\\;\\beta_{0}\\exp(-\\mu t)\\,(-y,\\,x),\n$$\n其中 $\\alpha_{0}$、$\\beta_{0}$、$\\omega$ 和 $\\mu$ 是正常数。定义标量场\n$$\n\\phi(x,y,t)\\;=\\;\\ln\\!\\Big(1+\\gamma\\,s(t)\\,\\big(x^{2}+y^{2}\\big)\\Big),\n$$\n其中 $\\gamma0$ 是一个常数，且\n$$\ns(t)\\;=\\;\\exp\\!\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big).\n$$\n从连续介质运动学中物质导数的定义以及复合有拉格朗日轨迹的时变场的链式法则出发，计算在一般点 $(x,y,t)$ 处的物质导数 $D\\phi/Dt$，并用您的结果判断在该流场中，$\\phi$ 是否沿着粒子轨迹物质守恒。\n\n将您的最终答案表示为 $D\\phi/Dt$ 的单个简化解析表达式。如果它简化为一个常数，请报告该常数。不需要进行数值计算，也无需四舍五入。最终答案中不要包含单位。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 第1步：提取已知条件\n\n-   **速度场**：在点 $(x,y)$ 和时间 $t$ 处的速度场 $\\mathbf{u}$ 由下式给出\n    $$ \\mathbf{u}(x,y,t) = \\alpha_{0}\\cos(\\omega t)\\,(x,\\,y)\\;+\\;\\beta_{0}\\exp(-\\mu t)\\,(-y,\\,x) $$\n    其分量为 $u_x(x,y,t) = \\alpha_{0}\\cos(\\omega t)x - \\beta_{0}\\exp(-\\mu t)y$ 和 $u_y(x,y,t) = \\alpha_{0}\\cos(\\omega t)y + \\beta_{0}\\exp(-\\mu t)x$。\n-   **标量场**：标量场 $\\phi$ 定义为\n    $$ \\phi(x,y,t) = \\ln\\Big(1+\\gamma\\,s(t)\\,\\big(x^{2}+y^{2}\\big)\\Big) $$\n-   **辅助函数**：随时间变化的函数 $s(t)$ 由下式给出\n    $$ s(t) = \\exp\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big) $$\n-   **常数**：参数 $\\alpha_{0}$、$\\beta_{0}$、$\\omega$、$\\mu$ 和 $\\gamma$ 均为正常数。\n\n### 第2步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题在连续介质力学的成熟框架内构建。速度场、标量场和物质导数的概念是该领域的基础。该速度场是一个随时间变化的纯应变/膨胀和一个随时间变化的旋转的线性叠加，这是对流体流动进行建模的数学和物理上合理的构造。\n-   **适定性**：该问题在数学上是适定的。所有函数和参数都已明确给出。任务是计算一个特定的量，可以推导出其唯一解。\n-   **客观性**：问题陈述使用精确、无歧义的数学语言，不含任何主观或基于意见的内容。\n-   **完整性和一致性**：问题提供了进行计算所需的所有必要信息。没有缺失的定义或矛盾的约束。\n-   **真实性和可行性**：指定的场和函数是理想化的，但对于理论模型而言，在物理上并非不可能，在科学上亦非不合理。\n-   **结构与平凡性**：该问题需要系统地应用多元微积分，特别是微分的链式法则。所需的代数简化并非微不足道，它考验了对物质导数结构的理解。\n\n### 第3步：结论与行动\n\n该问题科学合理、适定且完整。这是一个连续介质运动学中的有效问题。我将继续进行求解。\n\n在具有速度场 $\\mathbf{u}(x,y,t) = (u_x, u_y)$ 的二维流中，标量场 $\\phi(x,y,t)$ 的物质导数定义为：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\phi = \\frac{\\partial \\phi}{\\partial t} + u_x \\frac{\\partial \\phi}{\\partial x} + u_y \\frac{\\partial \\phi}{\\partial y}\n$$\n我们分别计算右侧的每一项。\n\n**1. 局部时间导数, $\\frac{\\partial \\phi}{\\partial t}$**\n\n场 $\\phi$ 通过函数 $s(t)$ 显式地依赖于时间 $t$。使用链式求导法则：\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\ln\\Big(1+\\gamma\\,s(t)\\,(x^{2}+y^{2})\\Big) \\right] = \\frac{1}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} \\cdot \\frac{\\partial}{\\partial t} \\Big(\\gamma\\,s(t)\\,(x^{2}+y^{2})\\Big)\n$$\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\gamma(x^{2}+y^{2})}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} \\cdot \\frac{ds}{dt}\n$$\n接下来，我们计算 $s(t)$ 关于 $t$ 的导数：\n$$\n\\frac{ds}{dt} = \\frac{d}{dt} \\left[ \\exp\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big) \\right] = \\exp\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big) \\cdot \\frac{d}{dt}\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big)\n$$\n$$\n\\frac{ds}{dt} = s(t) \\cdot \\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\Big) (\\omega \\cos(\\omega t)) = -2\\alpha_{0}\\cos(\\omega t)s(t)\n$$\n将此代回 $\\frac{\\partial \\phi}{\\partial t}$ 的表达式中：\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\gamma(x^{2}+y^{2})}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} \\cdot \\Big(-2\\alpha_{0}\\cos(\\omega t)s(t)\\Big) = -\\frac{2\\alpha_{0}\\gamma s(t)(x^{2}+y^{2})\\cos(\\omega t)}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})}\n$$\n\n**2. 平流项, $\\mathbf{u} \\cdot \\nabla \\phi$**\n\n首先，我们计算 $\\phi$ 的梯度，$\\nabla\\phi = \\left(\\frac{\\partial \\phi}{\\partial x}, \\frac{\\partial \\phi}{\\partial y}\\right)$。\n对于关于 $x$ 的偏导数：\n$$\n\\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\ln\\Big(1+\\gamma\\,s(t)\\,(x^{2}+y^{2})\\Big) \\right] = \\frac{1}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} \\cdot \\frac{\\partial}{\\partial x} \\Big(\\gamma\\,s(t)\\,(x^{2}+y^{2})\\Big)\n$$\n$$\n\\frac{\\partial \\phi}{\\partial x} = \\frac{\\gamma s(t) (2x)}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} = \\frac{2\\gamma s(t) x}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})}\n$$\n根据 $x$ 和 $y$ 的对称性，关于 $y$ 的偏导数为：\n$$\n\\frac{\\partial \\phi}{\\partial y} = \\frac{2\\gamma s(t) y}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})}\n$$\n现在，我们计算点积 $\\mathbf{u} \\cdot \\nabla \\phi$：\n$$\n\\mathbf{u} \\cdot \\nabla \\phi = u_x \\frac{\\partial \\phi}{\\partial x} + u_y \\frac{\\partial \\phi}{\\partial y}\n$$\n代入 $u_x$、$u_y$、$\\frac{\\partial \\phi}{\\partial x}$ 和 $\\frac{\\partial \\phi}{\\partial y}$ 的表达式：\n$$\n\\mathbf{u} \\cdot \\nabla \\phi = \\Big(\\alpha_{0}\\cos(\\omega t)x - \\beta_{0}\\exp(-\\mu t)y\\Big)\\frac{2\\gamma s(t) x}{1+\\gamma s(t)(x^{2}+y^{2})} + \\Big(\\alpha_{0}\\cos(\\omega t)y + \\beta_{0}\\exp(-\\mu t)x\\Big)\\frac{2\\gamma s(t) y}{1+\\gamma s(t)(x^{2}+y^{2})}\n$$\n我们可以提出公分母和项 $2\\gamma s(t)$：\n$$\n\\mathbf{u} \\cdot \\nabla \\phi = \\frac{2\\gamma s(t)}{1+\\gamma s(t)(x^{2}+y^{2})} \\Big[ \\big(\\alpha_{0}\\cos(\\omega t)x - \\beta_{0}\\exp(-\\mu t)y\\big)x + \\big(\\alpha_{0}\\cos(\\omega t)y + \\beta_{0}\\exp(-\\mu t)x\\big)y \\Big]\n$$\n我们来简化方括号中的表达式：\n$$\n[\\dots] = \\alpha_{0}\\cos(\\omega t)x^2 - \\beta_{0}\\exp(-\\mu t)xy + \\alpha_{0}\\cos(\\omega t)y^2 + \\beta_{0}\\exp(-\\mu t)xy\n$$\n包含 $\\beta_0$ 的项相互抵消：\n$$\n[\\dots] = \\alpha_{0}\\cos(\\omega t)x^2 + \\alpha_{0}\\cos(\\omega t)y^2 = \\alpha_{0}\\cos(\\omega t)(x^2+y^2)\n$$\n将这个简化后的结果代回平流项的表达式中：\n$$\n\\mathbf{u} \\cdot \\nabla \\phi = \\frac{2\\gamma s(t)}{1+\\gamma s(t)(x^{2}+y^{2})} \\Big[ \\alpha_{0}\\cos(\\omega t)(x^2+y^2) \\Big] = \\frac{2\\alpha_{0}\\gamma s(t)(x^{2}+y^{2})\\cos(\\omega t)}{1+\\gamma s(t)(x^{2}+y^{2})}\n$$\n\n**3. 合并各项以求得 $\\frac{D\\phi}{Dt}$**\n\n最后，我们将局部时间导数和平流项相加：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\phi\n$$\n$$\n\\frac{D\\phi}{Dt} = -\\frac{2\\alpha_{0}\\gamma s(t)(x^{2}+y^{2})\\cos(\\omega t)}{1+\\gamma s(t)(x^{2}+y^{2})} + \\frac{2\\alpha_{0}\\gamma s(t)(x^{2}+y^{2})\\cos(\\omega t)}{1+\\gamma s(t)(x^{2}+y^{2})}\n$$\n这两项大小相等，符号相反，因此它们的和为零。\n$$\n\\frac{D\\phi}{Dt} = 0\n$$\n结果表明标量场 $\\phi$ 是物质守恒的。这意味着对于沿其轨迹运动的任何流体粒子，与该粒子相关的 $\\phi$ 值随时间保持不变。问题特别要求给出物质导数本身的表达式。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "对于数值方法，特别是有限体积法，使用守恒形式（conservative form）的输运方程至关重要。本练习将引导你将一个平流形式的方程转换为其守恒形式，并对一个控制体积应用积分守恒律来计算某个总量的变化，从而在抽象的偏微分方程和具体的、可计算的收支之间建立联系 。",
            "id": "3574946",
            "problem": "考虑一个二维空间中的可压缩连续体，其速度场为 $\\mathbf{u}(\\mathbf{x},t) = (u_x,u_y) = (\\alpha x, \\beta y)$，其中 $\\alpha$ 和 $\\beta$ 为实常数，且 $\\alpha + \\beta \\neq 0$。设质量密度为 $\\rho(\\mathbf{x},t)$，并设 $\\phi(\\mathbf{x},t)$ 是一个物质守恒的标量属性（例如，单位质量的被动示踪剂），因此其物质导数满足 $D\\phi/Dt = 0$。假设质量连续性方程成立：$\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$。在时间 $t=0$ 时，密度在空间上是均匀的，其值为 $\\rho_0  0$。\n\n(a) 仅从连续性方程和物质导数的定义 $D(\\cdot)/Dt = \\partial_t(\\cdot) + \\mathbf{u} \\cdot \\nabla(\\cdot)$ 出发，推导广延量 $\\rho \\phi$ 的输运方程的守恒（通量-散度）形式。\n\n(b) 使用(a)部分得到的守恒形式，写出在一个固定的矩形控制体积 $V = [0,L_x] \\times [0,L_y]$ 上的相应积分平衡方程，该控制体积在 $x$-$y$ 平面内，并沿 $z$ 方向均匀拉伸，厚度为 $W$。明确写出边界 $\\partial V$ 上的通量项，并指明单位法线的方向约定。\n\n(c) 对于给定的数据 $L_x = 1\\,\\mathrm{m}$，$L_y = 2\\,\\mathrm{m}$，$W = 1\\,\\mathrm{m}$，$\\alpha = 1\\,\\mathrm{s}^{-1}$，$\\beta = -\\tfrac{1}{2}\\,\\mathrm{s}^{-1}$，$\\rho_0 = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，以及 $\\phi(x,y,0) = (x/L_x)^2 + \\gamma (y/L_y)$，其中 $\\gamma = 3$（无量纲），计算在时间 $t=0$ 时总广延量 $\\int_V \\rho \\phi \\,\\mathrm{d}V$ 的瞬时变化率。最终速率以 $\\mathrm{kg}\\,\\mathrm{s}^{-1}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "我们从基本表述开始：质量连续性方程 $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$ 和物质导数的定义 $D(\\cdot)/Dt = \\partial_t(\\cdot) + \\mathbf{u} \\cdot \\nabla(\\cdot)$。标量 $\\phi$ 是物质守恒的，因此 $D\\phi/Dt = 0$。\n\n(a) 为得到广延量 $\\rho \\phi$ 的守恒形式，我们计算\n$$\n\\partial_t(\\rho \\phi) + \\nabla \\cdot (\\rho \\phi \\mathbf{u}).\n$$\n使用乘法法则，\n$$\n\\partial_t(\\rho \\phi) = \\phi \\,\\partial_t \\rho + \\rho \\,\\partial_t \\phi,\n$$\n以及标量 $f$ 和矢量 $\\mathbf{u}$ 的输运散度恒等式，\n$$\n\\nabla \\cdot (f \\mathbf{u}) = f \\,\\nabla \\cdot \\mathbf{u} + \\mathbf{u} \\cdot \\nabla f.\n$$\n令 $f = \\rho \\phi$，我们写出\n$$\n\\nabla \\cdot (\\rho \\phi \\mathbf{u}) = \\phi \\,\\nabla \\cdot (\\rho \\mathbf{u}) + \\rho \\,\\mathbf{u} \\cdot \\nabla \\phi.\n$$\n因此，\n\\begin{align*}\n\\partial_t(\\rho \\phi) + \\nabla \\cdot (\\rho \\phi \\mathbf{u})\n= \\phi \\,\\partial_t \\rho + \\rho \\,\\partial_t \\phi + \\phi \\,\\nabla \\cdot (\\rho \\mathbf{u}) + \\rho \\,\\mathbf{u} \\cdot \\nabla \\phi \\\\\n= \\phi \\big(\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u})\\big) + \\rho \\big(\\partial_t \\phi + \\mathbf{u} \\cdot \\nabla \\phi\\big).\n\\end{align*}\n引用连续性方程 $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$ 和物质守恒 $D\\phi/Dt = \\partial_t \\phi + \\mathbf{u} \\cdot \\nabla \\phi = 0$，我们得到守恒形式\n$$\n\\partial_t(\\rho \\phi) + \\nabla \\cdot (\\rho \\phi \\mathbf{u}) = 0.\n$$\n\n(b) 该守恒偏微分方程意味着在一个具有向外单位法线 $\\mathbf{n}$ 的固定控制体积 $V$ 上的积分平衡：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_V \\rho \\phi \\,\\mathrm{d}V + \\int_{\\partial V} \\rho \\phi \\,\\mathbf{u} \\cdot \\mathbf{n} \\,\\mathrm{d}S = 0.\n$$\n这里，$\\mathbf{n}$ 是矩形棱柱 $V = [0,L_x] \\times [0,L_y] \\times [0,W]$ 每个面上的向外法线。由于速度场没有 $z$ 分量且在 $z$ 方向上是均匀的，所以只有四个侧面（其向外法线为 $\\pm \\hat{\\mathbf{i}}$ 和 $\\pm \\hat{\\mathbf{j}}$）对通量有贡献。顶部和底部面（法线为 $\\pm \\hat{\\mathbf{k}}$）的通量贡献为零，因为 $\\mathbf{u} \\cdot \\hat{\\mathbf{k}} = 0$。\n\n(c) 我们根据给定数据评估 $t=0$ 时的瞬时变化率。在 $t=0$ 时，密度是均匀的：$\\rho(\\mathbf{x},0) = \\rho_0$，标量为 $\\phi(x,y,0) = (x/L_x)^2 + \\gamma (y/L_y)$。积分平衡方程得出\n$$\n\\left.\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_V \\rho \\phi \\,\\mathrm{d}V \\right|_{t=0}\n= - \\int_{\\partial V} \\rho \\phi \\,\\mathbf{u} \\cdot \\mathbf{n} \\,\\mathrm{d}S \\Big|_{t=0}.\n$$\n由于 $\\rho_0$ 是均匀的，且几何形状是厚度为 $W$ 的矩形棱柱，边界积分简化为四个侧面积分之和：\n\\begin{align*}\n\\int_{\\partial V} \\rho \\phi \\,\\mathbf{u} \\cdot \\mathbf{n} \\,\\mathrm{d}S\n= \\rho_0 \\Bigg[\n\\int_{y=0}^{L_y} \\int_{z=0}^{W} \\phi(L_x,y,0)\\, (\\alpha L_x)\\, \\mathrm{d}z\\,\\mathrm{d}y \\\\\n\\quad + \\int_{x=0}^{L_x} \\int_{z=0}^{W} \\phi(x,L_y,0)\\, (\\beta L_y)\\, \\mathrm{d}z\\,\\mathrm{d}x \\\\\n\\quad + \\int_{y=0}^{L_y} \\int_{z=0}^{W} \\phi(0,y,0)\\, (-\\alpha \\cdot 0)\\, \\mathrm{d}z\\,\\mathrm{d}y \\\\\n\\quad + \\int_{x=0}^{L_x} \\int_{z=0}^{W} \\phi(x,0,0)\\, (-\\beta \\cdot 0)\\, \\mathrm{d}z\\,\\mathrm{d}x\n\\Bigg].\n\\end{align*}\n最后两个积分消失，因为 $u_x(0,y) = \\alpha \\cdot 0 = 0$ 和 $u_y(x,0) = \\beta \\cdot 0 = 0$。计算剩余的贡献，\n\\begin{align*}\n\\int_{y=0}^{L_y} \\phi(L_x,y,0)\\, \\mathrm{d}y\n= \\int_{0}^{L_y} \\left( (L_x/L_x)^2 + \\gamma \\frac{y}{L_y} \\right) \\mathrm{d}y\n= \\int_{0}^{L_y} \\left( 1 + \\gamma \\frac{y}{L_y} \\right) \\mathrm{d}y \\\\\n= L_y \\left(1 + \\frac{\\gamma}{2}\\right),\n\\\\\n\\int_{x=0}^{L_x} \\phi(x,L_y,0)\\, \\mathrm{d}x\n= \\int_{0}^{L_x} \\left( \\left(\\frac{x}{L_x}\\right)^2 + \\gamma \\right) \\mathrm{d}x\n= \\left[\\frac{x^3}{3 L_x^2}\\right]_{0}^{L_x} + \\gamma L_x\n= \\frac{L_x}{3} + \\gamma L_x.\n\\end{align*}\n因此，\n\\begin{align*}\n\\int_{\\partial V} \\rho \\phi \\,\\mathbf{u} \\cdot \\mathbf{n} \\,\\mathrm{d}S\n= \\rho_0 \\left[ (\\alpha L_x) \\, W \\, L_y \\left(1 + \\frac{\\gamma}{2}\\right) + (\\beta L_y) \\, W \\left( \\frac{L_x}{3} + \\gamma L_x \\right) \\right] \\\\\n= \\rho_0 \\, W \\, L_x \\, L_y \\left[ \\alpha \\left(1 + \\frac{\\gamma}{2}\\right) + \\beta \\left( \\frac{1}{3} + \\gamma \\right) \\right].\n\\end{align*}\n于是，\n$$\n\\left.\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_V \\rho \\phi \\,\\mathrm{d}V \\right|_{t=0}\n= - \\rho_0 \\, W \\, L_x \\, L_y \\left[ \\alpha \\left(1 + \\frac{\\gamma}{2}\\right) + \\beta \\left( \\frac{1}{3} + \\gamma \\right) \\right].\n$$\n代入给定值 $L_x = 1\\,\\mathrm{m}$，$L_y = 2\\,\\mathrm{m}$，$W = 1\\,\\mathrm{m}$，$\\alpha = 1\\,\\mathrm{s}^{-1}$，$\\beta = -\\tfrac{1}{2}\\,\\mathrm{s}^{-1}$，$\\rho_0 = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，以及 $\\gamma = 3$：\n\\begin{align*}\n\\left[ \\alpha \\left(1 + \\frac{\\gamma}{2}\\right) + \\beta \\left( \\frac{1}{3} + \\gamma \\right) \\right]\n= 1 \\left(1 + \\frac{3}{2}\\right) + \\left(-\\frac{1}{2}\\right) \\left( \\frac{1}{3} + 3 \\right) \\\\\n= \\frac{5}{2} - \\frac{1}{2} \\cdot \\frac{10}{3} \\\\\n= \\frac{5}{2} - \\frac{5}{3} \\\\\n= \\frac{15 - 10}{6} \\\\\n= \\frac{5}{6}.\n\\end{align*}\n因此，\n\\begin{align*}\n\\left.\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_V \\rho \\phi \\,\\mathrm{d}V \\right|_{t=0}\n= - \\rho_0 \\, W \\, L_x \\, L_y \\cdot \\frac{5}{6} \\\\\n= - 1000 \\cdot 1 \\cdot 1 \\cdot 2 \\cdot \\frac{5}{6} \\\\\n= - \\frac{10000}{6} \\\\\n= - \\frac{5000}{3}\\,\\mathrm{kg\\,s^{-1}}.\n\\end{align*}\n数值上，这约等于 $-1.666\\overline{6} \\times 10^{3}\\,\\mathrm{kg\\,s^{-1}}$。四舍五入到四位有效数字并以 $\\mathrm{kg}\\,\\mathrm{s}^{-1}$ 为单位表示，结果为 $-1.667 \\times 10^{3}\\,\\mathrm{kg\\,s^{-1}}$。\n\n此计算验证了由守恒形式所蕴含的积分平衡，并为给定的控制体积和场提供了所求的瞬时变化率。",
            "answer": "$$\\boxed{-1.667 \\times 10^{3}}$$"
        },
        {
            "introduction": "将连续方程离散为数值格式会引入新的约束，其中最著名的就是Courant–Friedrichs–Lewy (CFL)条件，它为保证显式格式的稳定性而限制了时间步长。本练习要求你从第一性原理出发，推导一个二维平流格式的稳定性条件，并将其与另一种数值策略（维度分裂法）进行比较，从而揭示算法设计中的重要权衡 。",
            "id": "3574958",
            "problem": "考虑一个被动标量场 $q(x,y,t)$ 的二维平流，其由守恒律 $\\partial_{t} q + \\nabla \\cdot (\\boldsymbol{u} q) = 0$ 和一个空间均匀的速度场 $\\boldsymbol{u} = (u,v)$ 控制。计算域通过均匀的笛卡尔网格进行离散化，其在 $x$ 方向的间距为 $\\Delta x$，在 $y$ 方向的间距为 $\\Delta y$。空间离散化采用显式、非分裂的一阶迎风有限体积格式，并使用显式前向欧拉步长进行时间推进。速度大小为 $|\\boldsymbol{u}| = V$，其方向与 $x$ 轴正方向的夹角为 $\\theta$，因此 $u = V \\cos(\\theta)$ 且 $v = V \\sin(\\theta)$。\n\n根据单调显式格式的守恒性和稳定性的第一性原理，推导在这种非分裂更新下，能够确保离散 $L^{\\infty}$ 范数不增且保持 $q$ 的离散极值原理的最大稳定时间步长。然后，针对一个计算地球物理示踪剂输运应用的科学实际参数集，计算这个最大稳定时间步长：$\\Delta x = 50\\,\\mathrm{m}$，$\\Delta y = 200\\,\\mathrm{m}$，$V = 1.8\\,\\mathrm{m/s}$，以及 $\\theta = \\pi/3$ 弧度。\n\n最后，通过将您推导的非分裂稳定性约束与维度分裂的一阶迎风更新（该更新在一个持续时间为 $\\Delta t$ 的时间步内依次应用 $x$ 方向平流和 $y$ 方向平流）的约束进行比较，评估多维 Courant–Friedrichs–Lewy (CFL) 约束的影响。请根据显式更新的结构，解释哪个约束更严格及其原因。\n\n仅报告非分裂格式的最大稳定时间步长，四舍五入到四位有效数字，并以秒为单位表示。",
            "solution": "问题陈述已经过验证，并被确定为计算科学领域一个有效的、适定的问题。它具有科学依据，是客观的，并包含得出唯一解所需的所有必要信息。\n\n被动标量场 $q(x,y,t)$ 平流的控制方程是守恒律：\n$$ \\partial_{t} q + \\nabla \\cdot (\\boldsymbol{u} q) = 0 $$\n鉴于速度场 $\\boldsymbol{u} = (u,v)$ 是空间均匀的，该方程简化为：\n$$ \\partial_{t} q + \\boldsymbol{u} \\cdot \\nabla q = 0 $$\n为推导有限体积格式，我们在一个面积为 $\\Delta x \\Delta y$、中心点为 $(x_i, y_j)$ 的计算单元 $\\Omega_{i,j}$ 上对守恒律进行积分。\n$$ \\iint_{\\Omega_{i,j}} \\partial_{t} q \\,dA + \\iint_{\\Omega_{i,j}} \\nabla \\cdot (\\boldsymbol{u} q) \\,dA = 0 $$\n对第二项使用散度定理，我们将面积分转换为沿单元边界 $\\partial\\Omega_{i,j}$ 的线积分：\n$$ \\frac{d}{dt} \\iint_{\\Omega_{i,j}} q \\,dA + \\oint_{\\partial\\Omega_{i,j}} (\\boldsymbol{u} q) \\cdot \\boldsymbol{n} \\,ds = 0 $$\n令 $q_{i,j}(t)$ 表示单元平均值，$q_{i,j} \\approx \\frac{1}{\\Delta x \\Delta y} \\iint_{\\Omega_{i,j}} q \\,dA$。方程变为：\n$$ \\Delta x \\Delta y \\frac{dq_{i,j}}{dt} + (\\text{Flux}_{east} - \\text{Flux}_{west}) + (\\text{Flux}_{north} - \\text{Flux}_{south}) = 0 $$\n通过单元面的通量近似如下：\n$$ \\text{Flux}_{east} \\approx (u q_{i+1/2,j}) \\Delta y $$\n$$ \\text{Flux}_{west} \\approx (u q_{i-1/2,j}) \\Delta y $$\n$$ \\text{Flux}_{north} \\approx (v q_{i,j+1/2}) \\Delta x $$\n$$ \\text{Flux}_{south} \\approx (v q_{i,j-1/2}) \\Delta x $$\n其中 $q_{i \\pm 1/2, j}$ 和 $q_{i, j \\pm 1/2}$ 是单元面上的标量值。半离散方程为：\n$$ \\frac{dq_{i,j}}{dt} = - \\frac{u q_{i+1/2,j} - u q_{i-1/2,j}}{\\Delta x} - \\frac{v q_{i,j+1/2} - v q_{i,j-1/2}}{\\Delta y} $$\n对于一阶迎风格式，面值取自上风（迎风）单元。这通常可以利用速度的正部和负部来表示。在面 $i+1/2$ 处 $x$ 方向的数值通量为 $F_{i+1/2} = u^{+} q_{i,j} + u^{-} q_{i+1,j}$，其中 $u^{+} = \\max(u,0)$ 且 $u^{-} = \\min(u,0)$。这等价于 $F_{i+1/2} = \\frac{u+|u|}{2}q_{i,j} + \\frac{u-|u|}{2}q_{i+1,j}$。\n$x$ 方向的净通量散度近似为：\n$$ \\frac{F_{i+1/2,j} - F_{i-1/2,j}}{\\Delta x} = \\frac{1}{\\Delta x} \\left[ (u^{+}q_{i,j} + u^{-}q_{i+1,j}) - (u^{+}q_{i-1,j} + u^{-}q_{i,j}) \\right] $$\n$y$ 方向同理。半离散方程变为：\n$$ \\frac{dq_{i,j}}{dt} = - \\frac{1}{\\Delta x} \\left[ u^{+}(q_{i,j} - q_{i-1,j}) + u^{-}(q_{i+1,j} - q_{i,j}) \\right] - \\frac{1}{\\Delta y} \\left[ v^{+}(q_{i,j} - q_{i,j-1}) + v^{-}(q_{i,j+1} - q_{i,j}) \\right] $$\n应用前向欧拉时间步长，$\\frac{q^{n+1}_{i,j} - q^n_{i,j}}{\\Delta t} = (\\dots)^n$：\n$$ q^{n+1}_{i,j} = q^n_{i,j} - \\frac{\\Delta t}{\\Delta x} \\left[ u^{+}(q^n_{i,j} - q^n_{i-1,j}) + u^{-}(q^n_{i+1,j} - q^n_{i,j}) \\right] - \\frac{\\Delta t}{\\Delta y} \\left[ v^{+}(q^n_{i,j} - q^n_{i,j-1}) + v^{-}(q^n_{i,j+1} - q^n_{i,j}) \\right] $$\n我们将各项按照在时间层 $n$ 的空间索引进行分组：\n$$ q^{n+1}_{i,j} = \\left( 1 - \\frac{\\Delta t}{\\Delta x}(u^{+} - u^{-}) - \\frac{\\Delta t}{\\Delta y}(v^{+} - v^{-}) \\right)q^n_{i,j} + \\frac{\\Delta t}{\\Delta x} u^{+} q^n_{i-1,j} - \\frac{\\Delta t}{\\Delta x} u^{-} q^n_{i+1,j} + \\frac{\\Delta t}{\\Delta y} v^{+} q^n_{i,j-1} - \\frac{\\Delta t}{\\Delta y} v^{-} q^n_{i,j+1} $$\n注意到 $u^{+} - u^{-} = |u|$ 和 $v^{+} - v^{-} = |v|$，更新方程简化为：\n$$ q^{n+1}_{i,j} = \\left( 1 - \\frac{|u|\\Delta t}{\\Delta x} - \\frac{|v|\\Delta t}{\\Delta y} \\right)q^n_{i,j} + \\frac{|u|\\Delta t}{\\Delta x} q^n_{upwind,x} + \\frac{|v|\\Delta t}{\\Delta y} q^n_{upwind,y} $$\n其中 $q^n_{upwind,x}$ 是 $x$ 方向的迎风值（$q^n_{i-1,j}$ 或 $q^n_{i+1,j}$），$q^n_{upwind,y}$ 是 $y$ 方向的迎风值。\n\n为使格式满足离散极值原理并具有不增的 $L^{\\infty}$ 范数，新值 $q^{n+1}_{i,j}$ 必须是旧值的凸组合。这要求模板中的所有系数都为非负。\n迎风单元的系数为 $\\frac{\\Delta t}{\\Delta x}u^{+}$、$-\\frac{\\Delta t}{\\Delta x}u^{-}$、$\\frac{\\Delta t}{\\Delta y}v^{+}$ 和 $-\\frac{\\Delta t}{\\Delta y}v^{-}$。对于任何 $u,v$，这些系数本身都是非负的。\n关键条件来自于 $q^n_{i,j}$ 的系数：\n$$ 1 - \\frac{|u|\\Delta t}{\\Delta x} - \\frac{|v|\\Delta t}{\\Delta y} \\ge 0 $$\n这就给出了非分裂、一阶迎风格式的 Courant-Friedrichs-Lewy (CFL) 稳定性约束：\n$$ \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} \\right) \\le 1 $$\n因此，最大稳定时间步长 $\\Delta t_{max}$ 为：\n$$ \\Delta t_{max} = \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y}} $$\n我们现在用给定的参数计算此值：$\\Delta x = 50\\,\\mathrm{m}$，$\\Delta y = 200\\,\\mathrm{m}$，$V = 1.8\\,\\mathrm{m/s}$，以及 $\\theta = \\pi/3$ 弧度。\n速度分量为：\n$$ |u| = |V \\cos(\\theta)| = |1.8 \\cos(\\pi/3)| = |1.8 \\times 0.5| = 0.9\\,\\mathrm{m/s} $$\n$$ |v| = |V \\sin(\\theta)| = |1.8 \\sin(\\pi/3)| = |1.8 \\times \\frac{\\sqrt{3}}{2}| = 0.9\\sqrt{3}\\,\\mathrm{m/s} \\approx 1.5588457\\,\\mathrm{m/s} $$\n将这些值代入 $\\Delta t_{max}$ 的表达式中：\n$$ \\Delta t_{max} = \\frac{1}{\\frac{0.9}{50} + \\frac{0.9\\sqrt{3}}{200}} = \\frac{1}{0.018 + \\frac{1.5588457}{200}} $$\n$$ \\Delta t_{max} = \\frac{1}{0.018 + 0.0077942286} = \\frac{1}{0.0257942286} \\approx 38.7683\\,\\mathrm{s} $$\n四舍五入到四位有效数字，最大稳定时间步长为 $38.77\\,\\mathrm{s}$。\n\n为了进行比较，我们考虑一个维度分裂格式。这涉及两个顺序步骤：\n1. $x$ 方向平流：$q^* = \\mathcal{L}_x(\\Delta t) q^n$。此步骤的稳定性条件是 $\\frac{|u|\\Delta t}{\\Delta x} \\le 1$。\n2. $y$ 方向平流：$q^{n+1} = \\mathcal{L}_y(\\Delta t) q^*$。此步骤的稳定性条件是 $\\frac{|v|\\Delta t}{\\Delta y} \\le 1$。\n为了使组合的分裂格式稳定，两个单独的步骤都必须稳定。这要求 $\\Delta t$ 同时满足两个约束条件：\n$$ \\Delta t \\le \\frac{\\Delta x}{|u|} \\quad \\text{和} \\quad \\Delta t \\le \\frac{\\Delta y}{|v|} $$\n这等价于关于最大时间步长的单个条件：\n$$ \\Delta t_{split, max} = \\min\\left(\\frac{\\Delta x}{|u|}, \\frac{\\Delta y}{|v|}\\right) $$\n我们来比较一下这些约束。令 $C_x = \\frac{|u|\\Delta t}{\\Delta x}$ 且 $C_y = \\frac{|v|\\Delta t}{\\Delta y}$。\n- 非分裂约束：$C_x + C_y \\le 1$。\n- 分裂约束：$\\max(C_x, C_y) \\le 1$。\n由于 $C_x \\ge 0$ 且 $C_y \\ge 0$，条件 $C_x + C_y \\le 1$ 意味着 $C_x \\le 1$ 和 $C_y \\le 1$ 都成立。因此，任何对于非分裂格式稳定的 $\\Delta t$ 对于分裂格式也稳定。然而，反之则不成立。例如，如果 $C_x = 0.7$ 且 $C_y = 0.7$，分裂格式的约束 $\\max(0.7, 0.7) \\le 1$ 是满足的，但非分裂格式的约束 $0.7+0.7 = 1.4  1$ 被违反了。\n因此，**非分裂稳定性约束比分裂格式的约束更严格**。\n其原因是，非分裂更新在单个阶段内同时考虑了量 $q$ 从一个单元 $(i,j)$ 向所有方向的总流出量。稳定性条件 $1 - (C_x + C_y) \\ge 0$ 确保在一个时间步内离开单元的 $q$ 的量不超过该单元中初始存在的 $q$ 的量。而分裂格式将这两个流出解耦成独立的子步骤，从而导致一个更宽松、且通常更理想的稳定性限制。\n对于给定的参数：\n$$ \\Delta t_{split, max} = \\min\\left(\\frac{50}{0.9}, \\frac{200}{0.9\\sqrt{3}}\\right) = \\min(55.55\\dots, 128.3\\dots) = 55.56\\,\\mathrm{s} $$\n如上所示，$\\Delta t_{unsplit, max} (38.77\\,\\mathrm{s})$ 确实小于 $\\Delta t_{split, max} (55.56\\,\\mathrm{s})$。",
            "answer": "$$\n\\boxed{38.77}\n$$"
        }
    ]
}