{
    "hands_on_practices": [
        {
            "introduction": "We begin by exploring the material derivative, the cornerstone of continuum mechanics that describes how a property of a fluid parcel changes as it moves. This exercise provides a concrete example of calculating this derivative, $D\\phi/Dt$, for a given flow and scalar field. It challenges you to apply the chain rule in a dynamic context and determine if a property is conserved along a particle's path, directly testing your understanding of the link between the Eulerian and Lagrangian frames of reference. ",
            "id": "3574977",
            "problem": "Consider a continuum in the plane with a spatially linear, time-dependent velocity field defined by\n$$\n\\mathbf{u}(x,y,t) \\;=\\; \\alpha_{0}\\cos(\\omega t)\\,(x,\\,y)\\;+\\;\\beta_{0}\\exp(-\\mu t)\\,(-y,\\,x),\n$$\nwhere $\\alpha_{0}$, $\\beta_{0}$, $\\omega$, and $\\mu$ are positive constants. Define the scalar field\n$$\n\\phi(x,y,t)\\;=\\;\\ln\\!\\Big(1+\\gamma\\,s(t)\\,\\big(x^{2}+y^{2}\\big)\\Big),\n$$\nwith $\\gamma0$ a constant and\n$$\ns(t)\\;=\\;\\exp\\!\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big).\n$$\nStarting from the continuum kinematics definition of the material derivative and the chain rule for time-dependent fields composed with Lagrangian trajectories, compute the material derivative $D\\phi/Dt$ at a general point $(x,y,t)$ and use your result to determine whether $\\phi$ is materially conserved along particle trajectories in this flow.\n\nExpress your final answer as a single simplified analytic expression for $D\\phi/Dt$. If it reduces to a constant, report that constant. No numerical evaluation is required, and no rounding is needed. Do not include units in your final answer.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n\n-   **Velocity field**: The velocity field $\\mathbf{u}$ at a point $(x,y)$ and time $t$ is given by\n    $$ \\mathbf{u}(x,y,t) = \\alpha_{0}\\cos(\\omega t)\\,(x,\\,y)\\;+\\;\\beta_{0}\\exp(-\\mu t)\\,(-y,\\,x) $$\n    where the components are $u_x(x,y,t) = \\alpha_{0}\\cos(\\omega t)x - \\beta_{0}\\exp(-\\mu t)y$ and $u_y(x,y,t) = \\alpha_{0}\\cos(\\omega t)y + \\beta_{0}\\exp(-\\mu t)x$.\n-   **Scalar field**: The scalar field $\\phi$ is defined as\n    $$ \\phi(x,y,t) = \\ln\\Big(1+\\gamma\\,s(t)\\,\\big(x^{2}+y^{2}\\big)\\Big) $$\n-   **Auxiliary function**: The time-dependent function $s(t)$ is given by\n    $$ s(t) = \\exp\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big) $$\n-   **Constants**: The parameters $\\alpha_{0}$, $\\beta_{0}$, $\\omega$, $\\mu$, and $\\gamma$ are all positive constants.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is formulated within the well-established framework of continuum mechanics. The concepts of a velocity field, a scalar field, and the material derivative are fundamental to this field. The velocity field is a linear superposition of a time-dependent pure strain/dilation and a time-dependent rotation, which is a mathematically and physically sound construct for modeling fluid flows.\n-   **Well-Posed**: The problem is mathematically well-defined. All functions and parameters are explicitly given. The task is to compute a specific quantity, for which a unique solution can be derived.\n-   **Objective**: The problem is stated using precise, unambiguous mathematical language, free of any subjective or opinion-based content.\n-   **Completeness and Consistency**: The problem provides all necessary information to perform the calculation. There are no missing definitions or contradictory constraints.\n-   **Realism and Feasibility**: The specified fields and functions are idealized but are not physically impossible or scientifically implausible for a theoretical model.\n-   **Structure and Triviality**: The problem requires a systematic application of multivariable calculus, specifically the chain rule for differentiation. The required algebraic simplification is non-trivial and tests understanding of the material derivative's structure.\n\n### Step 3: Verdict and Action\n\nThe problem is scientifically sound, well-posed, and complete. It is a valid problem in continuum kinematics. I will proceed with the solution.\n\nThe material derivative of a scalar field $\\phi(x,y,t)$ in a two-dimensional flow with velocity field $\\mathbf{u}(x,y,t) = (u_x, u_y)$ is defined as:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\phi = \\frac{\\partial \\phi}{\\partial t} + u_x \\frac{\\partial \\phi}{\\partial x} + u_y \\frac{\\partial \\phi}{\\partial y}\n$$\nWe compute each term on the right-hand side separately.\n\n**1. The local time derivative, $\\frac{\\partial \\phi}{\\partial t}$**\n\nThe field $\\phi$ depends on time $t$ explicitly through the function $s(t)$. Using the chain rule for differentiation:\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\ln\\Big(1+\\gamma\\,s(t)\\,(x^{2}+y^{2})\\Big) \\right] = \\frac{1}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} \\cdot \\frac{\\partial}{\\partial t} \\Big(\\gamma\\,s(t)\\,(x^{2}+y^{2})\\Big)\n$$\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\gamma(x^{2}+y^{2})}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} \\cdot \\frac{ds}{dt}\n$$\nNext, we compute the derivative of $s(t)$ with respect to $t$:\n$$\n\\frac{ds}{dt} = \\frac{d}{dt} \\left[ \\exp\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big) \\right] = \\exp\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big) \\cdot \\frac{d}{dt}\\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\,\\sin(\\omega t)\\Big)\n$$\n$$\n\\frac{ds}{dt} = s(t) \\cdot \\Big(-\\,\\frac{2\\alpha_{0}}{\\omega}\\Big) (\\omega \\cos(\\omega t)) = -2\\alpha_{0}\\cos(\\omega t)s(t)\n$$\nSubstituting this back into the expression for $\\frac{\\partial \\phi}{\\partial t}$:\n$$\n\\frac{\\partial \\phi}{\\partial t} = \\frac{\\gamma(x^{2}+y^{2})}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} \\cdot \\Big(-2\\alpha_{0}\\cos(\\omega t)s(t)\\Big) = -\\frac{2\\alpha_{0}\\gamma s(t)(x^{2}+y^{2})\\cos(\\omega t)}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})}\n$$\n\n**2. The advection term, $\\mathbf{u} \\cdot \\nabla \\phi$**\n\nFirst, we compute the gradient of $\\phi$, $\\nabla\\phi = \\left(\\frac{\\partial \\phi}{\\partial x}, \\frac{\\partial \\phi}{\\partial y}\\right)$.\nFor the partial derivative with respect to $x$:\n$$\n\\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ \\ln\\Big(1+\\gamma\\,s(t)\\,(x^{2}+y^{2})\\Big) \\right] = \\frac{1}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} \\cdot \\frac{\\partial}{\\partial x} \\Big(\\gamma\\,s(t)\\,(x^{2}+y^{2})\\Big)\n$$\n$$\n\\frac{\\partial \\phi}{\\partial x} = \\frac{\\gamma s(t) (2x)}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})} = \\frac{2\\gamma s(t) x}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})}\n$$\nBy symmetry in $x$ and $y$, the partial derivative with respect to $y$ is:\n$$\n\\frac{\\partial \\phi}{\\partial y} = \\frac{2\\gamma s(t) y}{1+\\gamma\\,s(t)\\,(x^{2}+y^{2})}\n$$\nNow, we compute the dot product $\\mathbf{u} \\cdot \\nabla \\phi$:\n$$\n\\mathbf{u} \\cdot \\nabla \\phi = u_x \\frac{\\partial \\phi}{\\partial x} + u_y \\frac{\\partial \\phi}{\\partial y}\n$$\nSubstituting the expressions for $u_x$, $u_y$, $\\frac{\\partial \\phi}{\\partial x}$, and $\\frac{\\partial \\phi}{\\partial y}$:\n$$\n\\mathbf{u} \\cdot \\nabla \\phi = \\Big(\\alpha_{0}\\cos(\\omega t)x - \\beta_{0}\\exp(-\\mu t)y\\Big)\\frac{2\\gamma s(t) x}{1+\\gamma s(t)(x^{2}+y^{2})} + \\Big(\\alpha_{0}\\cos(\\omega t)y + \\beta_{0}\\exp(-\\mu t)x\\Big)\\frac{2\\gamma s(t) y}{1+\\gamma s(t)(x^{2}+y^{2})}\n$$\nWe can factor out the common denominator and the term $2\\gamma s(t)$:\n$$\n\\mathbf{u} \\cdot \\nabla \\phi = \\frac{2\\gamma s(t)}{1+\\gamma s(t)(x^{2}+y^{2})} \\Big[ \\big(\\alpha_{0}\\cos(\\omega t)x - \\beta_{0}\\exp(-\\mu t)y\\big)x + \\big(\\alpha_{0}\\cos(\\omega t)y + \\beta_{0}\\exp(-\\mu t)x\\big)y \\Big]\n$$\nLet's simplify the expression in the square brackets:\n$$\n[\\dots] = \\alpha_{0}\\cos(\\omega t)x^2 - \\beta_{0}\\exp(-\\mu t)xy + \\alpha_{0}\\cos(\\omega t)y^2 + \\beta_{0}\\exp(-\\mu t)xy\n$$\nThe terms involving $\\beta_0$ cancel out:\n$$\n[\\dots] = \\alpha_{0}\\cos(\\omega t)x^2 + \\alpha_{0}\\cos(\\omega t)y^2 = \\alpha_{0}\\cos(\\omega t)(x^2+y^2)\n$$\nSubstituting this simplified result back into the expression for the advection term:\n$$\n\\mathbf{u} \\cdot \\nabla \\phi = \\frac{2\\gamma s(t)}{1+\\gamma s(t)(x^{2}+y^{2})} \\Big[ \\alpha_{0}\\cos(\\omega t)(x^2+y^2) \\Big] = \\frac{2\\alpha_{0}\\gamma s(t)(x^{2}+y^{2})\\cos(\\omega t)}{1+\\gamma s(t)(x^{2}+y^{2})}\n$$\n\n**3. Combine terms to find $\\frac{D\\phi}{Dt}$**\n\nFinally, we sum the local time derivative and the advection term:\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\phi\n$$\n$$\n\\frac{D\\phi}{Dt} = -\\frac{2\\alpha_{0}\\gamma s(t)(x^{2}+y^{2})\\cos(\\omega t)}{1+\\gamma s(t)(x^{2}+y^{2})} + \\frac{2\\alpha_{0}\\gamma s(t)(x^{2}+y^{2})\\cos(\\omega t)}{1+\\gamma s(t)(x^{2}+y^{2})}\n$$\nThe two terms are identical in magnitude and opposite in sign, thus they sum to zero.\n$$\n\\frac{D\\phi}{Dt} = 0\n$$\nThe result indicates that the scalar field $\\phi$ is materially conserved. This means that for any fluid particle moving along its trajectory, the value of $\\phi$ associated with that particle remains constant over time. The problem specifically asks for the expression for the material derivative itself.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "While the material derivative offers a Lagrangian view, many numerical methods are built upon the Eulerian concept of conservation within a fixed volume. This practice bridges these two perspectives by tasking you with converting a statement of material conservation ($D\\phi/Dt=0$) into its equivalent conservative (or flux-divergence) form for an extensive quantity, $\\rho\\phi$. You will then apply this principle to calculate the net flux of a quantity through a control volume, a foundational skill for understanding and implementing conservation laws in computational models, especially for compressible flows. ",
            "id": "3574946",
            "problem": "Consider a compressible continuum in two spatial dimensions with a velocity field $\\mathbf{u}(\\mathbf{x},t) = (u_x,u_y) = (\\alpha x, \\beta y)$, where $\\alpha$ and $\\beta$ are real constants with $\\alpha + \\beta \\neq 0$. Let the mass density be $\\rho(\\mathbf{x},t)$ and let $\\phi(\\mathbf{x},t)$ be a materially conserved scalar property (for example, a passive tracer per unit mass), so that the material derivative satisfies $D\\phi/Dt = 0$. Assume the mass continuity equation holds: $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$. At time $t=0$, the density is spatially uniform with value $\\rho_0  0$.\n\n(a) Starting only from the continuity equation and the definition of the material derivative $D(\\cdot)/Dt = \\partial_t(\\cdot) + \\mathbf{u} \\cdot \\nabla(\\cdot)$, derive the conservative (flux-divergence) form of the transport equation for the extensive quantity $\\rho \\phi$.\n\n(b) Using the conservative form from part (a), write the corresponding integral balance over a fixed rectangular control volume $V = [0,L_x] \\times [0,L_y]$ in the $x$-$y$ plane, extruded uniformly in the $z$-direction to thickness $W$. State explicitly the flux term over the boundary $\\partial V$, and indicate the unit normal orientation convention.\n\n(c) For the specific data $L_x = 1\\,\\mathrm{m}$, $L_y = 2\\,\\mathrm{m}$, $W = 1\\,\\mathrm{m}$, $\\alpha = 1\\,\\mathrm{s}^{-1}$, $\\beta = -\\tfrac{1}{2}\\,\\mathrm{s}^{-1}$, $\\rho_0 = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and $\\phi(x,y,0) = (x/L_x)^2 + \\gamma (y/L_y)$ with $\\gamma = 3$ (dimensionless), compute the instantaneous rate of change at time $t=0$ of the total extensive content $\\int_V \\rho \\phi \\,\\mathrm{d}V$. Express the final rate in $\\mathrm{kg}\\,\\mathrm{s}^{-1}$ and round your answer to four significant figures.",
            "solution": "We begin from the fundamental statements: the mass continuity equation $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$ and the definition of the material derivative $D(\\cdot)/Dt = \\partial_t(\\cdot) + \\mathbf{u} \\cdot \\nabla(\\cdot)$. The scalar $\\phi$ is materially conserved, so $D\\phi/Dt = 0$.\n\n(a) To obtain a conservative form for the extensive quantity $\\rho \\phi$, we compute\n$$\n\\partial_t(\\rho \\phi) + \\nabla \\cdot (\\rho \\phi \\mathbf{u}).\n$$\nUsing the product rule,\n$$\n\\partial_t(\\rho \\phi) = \\phi \\,\\partial_t \\rho + \\rho \\,\\partial_t \\phi,\n$$\nand the transport divergence identity for a scalar $f$ and vector $\\mathbf{u}$,\n$$\n\\nabla \\cdot (f \\mathbf{u}) = f \\,\\nabla \\cdot \\mathbf{u} + \\mathbf{u} \\cdot \\nabla f.\n$$\nWith $f = \\rho \\phi$, we write\n$$\n\\nabla \\cdot (\\rho \\phi \\mathbf{u}) = \\phi \\,\\nabla \\cdot (\\rho \\mathbf{u}) + \\rho \\,\\mathbf{u} \\cdot \\nabla \\phi.\n$$\nTherefore,\n\\begin{align*}\n\\partial_t(\\rho \\phi) + \\nabla \\cdot (\\rho \\phi \\mathbf{u})\n= \\phi \\,\\partial_t \\rho + \\rho \\,\\partial_t \\phi + \\phi \\,\\nabla \\cdot (\\rho \\mathbf{u}) + \\rho \\,\\mathbf{u} \\cdot \\nabla \\phi \\\\\n= \\phi \\big(\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u})\\big) + \\rho \\big(\\partial_t \\phi + \\mathbf{u} \\cdot \\nabla \\phi\\big).\n\\end{align*}\nInvoking continuity $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$ and material conservation $D\\phi/Dt = \\partial_t \\phi + \\mathbf{u} \\cdot \\nabla \\phi = 0$, we obtain the conservative form\n$$\n\\partial_t(\\rho \\phi) + \\nabla \\cdot (\\rho \\phi \\mathbf{u}) = 0.\n$$\n\n(b) The conservative partial differential equation implies an integral balance over a fixed control volume $V$ with outward unit normal $\\mathbf{n}$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_V \\rho \\phi \\,\\mathrm{d}V + \\int_{\\partial V} \\rho \\phi \\,\\mathbf{u} \\cdot \\mathbf{n} \\,\\mathrm{d}S = 0.\n$$\nHere, $\\mathbf{n}$ is the outward-pointing normal on each face of the rectangular prism $V = [0,L_x] \\times [0,L_y] \\times [0,W]$. Because the velocity field has no $z$-component and is uniform in $z$, only the four side faces with outward normals $\\pm \\hat{\\mathbf{i}}$ and $\\pm \\hat{\\mathbf{j}}$ contribute to the flux. The top and bottom faces with normals $\\pm \\hat{\\mathbf{k}}$ contribute zero flux since $\\mathbf{u} \\cdot \\hat{\\mathbf{k}} = 0$.\n\n(c) We evaluate the instantaneous rate of change at $t=0$ for the given data. At $t=0$ the density is uniform: $\\rho(\\mathbf{x},0) = \\rho_0$, and the scalar is $\\phi(x,y,0) = (x/L_x)^2 + \\gamma (y/L_y)$. The integral balance yields\n$$\n\\left.\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_V \\rho \\phi \\,\\mathrm{d}V \\right|_{t=0}\n= - \\int_{\\partial V} \\rho \\phi \\,\\mathbf{u} \\cdot \\mathbf{n} \\,\\mathrm{d}S \\Big|_{t=0}.\n$$\nWith $\\rho_0$ uniform and the geometry a rectangular prism of thickness $W$, the boundary integral reduces to the sum over the four side faces:\n\\begin{align*}\n\\int_{\\partial V} \\rho \\phi \\,\\mathbf{u} \\cdot \\mathbf{n} \\,\\mathrm{d}S\n= \\rho_0 \\Bigg[\n\\int_{y=0}^{L_y} \\int_{z=0}^{W} \\phi(L_x,y,0)\\, (\\alpha L_x)\\, \\mathrm{d}z\\,\\mathrm{d}y \\\\\n\\quad + \\int_{x=0}^{L_x} \\int_{z=0}^{W} \\phi(x,L_y,0)\\, (\\beta L_y)\\, \\mathrm{d}z\\,\\mathrm{d}x \\\\\n\\quad + \\int_{y=0}^{L_y} \\int_{z=0}^{W} \\phi(0,y,0)\\, (-\\alpha \\cdot 0)\\, \\mathrm{d}z\\,\\mathrm{d}y \\\\\n\\quad + \\int_{x=0}^{L_x} \\int_{z=0}^{W} \\phi(x,0,0)\\, (-\\beta \\cdot 0)\\, \\mathrm{d}z\\,\\mathrm{d}x\n\\Bigg].\n\\end{align*}\nThe last two integrals vanish because $u_x(0,y) = \\alpha \\cdot 0 = 0$ and $u_y(x,0) = \\beta \\cdot 0 = 0$. Evaluating the remaining contributions,\n\\begin{align*}\n\\int_{y=0}^{L_y} \\phi(L_x,y,0)\\, \\mathrm{d}y\n= \\int_{0}^{L_y} \\left( (L_x/L_x)^2 + \\gamma \\frac{y}{L_y} \\right) \\mathrm{d}y\n= \\int_{0}^{L_y} \\left( 1 + \\gamma \\frac{y}{L_y} \\right) \\mathrm{d}y \\\\\n= L_y \\left(1 + \\frac{\\gamma}{2}\\right),\n\\\\\n\\int_{x=0}^{L_x} \\phi(x,L_y,0)\\, \\mathrm{d}x\n= \\int_{0}^{L_x} \\left( \\left(\\frac{x}{L_x}\\right)^2 + \\gamma \\right) \\mathrm{d}x\n= \\left[\\frac{x^3}{3 L_x^2}\\right]_{0}^{L_x} + \\gamma L_x\n= \\frac{L_x}{3} + \\gamma L_x.\n\\end{align*}\nTherefore,\n\\begin{align*}\n\\int_{\\partial V} \\rho \\phi \\,\\mathbf{u} \\cdot \\mathbf{n} \\,\\mathrm{d}S\n= \\rho_0 \\left[ (\\alpha L_x) \\, W \\, L_y \\left(1 + \\frac{\\gamma}{2}\\right) + (\\beta L_y) \\, W \\left( \\frac{L_x}{3} + \\gamma L_x \\right) \\right] \\\\\n= \\rho_0 \\, W \\, L_x \\, L_y \\left[ \\alpha \\left(1 + \\frac{\\gamma}{2}\\right) + \\beta \\left( \\frac{1}{3} + \\gamma \\right) \\right].\n\\end{align*}\nThus,\n$$\n\\left.\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_V \\rho \\phi \\,\\mathrm{d}V \\right|_{t=0}\n= - \\rho_0 \\, W \\, L_x \\, L_y \\left[ \\alpha \\left(1 + \\frac{\\gamma}{2}\\right) + \\beta \\left( \\frac{1}{3} + \\gamma \\right) \\right].\n$$\nInsert the given values $L_x = 1\\,\\mathrm{m}$, $L_y = 2\\,\\mathrm{m}$, $W = 1\\,\\mathrm{m}$, $\\alpha = 1\\,\\mathrm{s}^{-1}$, $\\beta = -\\tfrac{1}{2}\\,\\mathrm{s}^{-1}$, $\\rho_0 = 1000\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and $\\gamma = 3$:\n\\begin{align*}\n\\left[ \\alpha \\left(1 + \\frac{\\gamma}{2}\\right) + \\beta \\left( \\frac{1}{3} + \\gamma \\right) \\right]\n= 1 \\left(1 + \\frac{3}{2}\\right) + \\left(-\\frac{1}{2}\\right) \\left( \\frac{1}{3} + 3 \\right) \\\\\n= \\frac{5}{2} - \\frac{1}{2} \\cdot \\frac{10}{3}\n= \\frac{5}{2} - \\frac{5}{3}\n= \\frac{15 - 10}{6}\n= \\frac{5}{6}.\n\\end{align*}\nHence,\n\\begin{align*}\n\\left.\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_V \\rho \\phi \\,\\mathrm{d}V \\right|_{t=0}\n= - \\rho_0 \\, W \\, L_x \\, L_y \\cdot \\frac{5}{6}\n= - 1000 \\cdot 1 \\cdot 1 \\cdot 2 \\cdot \\frac{5}{6} \\\\\n= - \\frac{10000}{6}\n= - \\frac{5000}{3}\n\\ \\ \\text{in}\\ \\ \\mathrm{kg}\\,\\mathrm{s}^{-1}.\n\\end{align*}\nNumerically, this is approximately $-1.666\\overline{6} \\times 10^{3}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$. Rounding to four significant figures and expressing in $\\mathrm{kg}\\,\\mathrm{s}^{-1}$ yields $-1.667 \\times 10^{3}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$.\n\nThis computation verifies the integral balance implied by the conservative form and provides the requested instantaneous rate of change for the given control volume and fields.",
            "answer": "$$\\boxed{-1.667 \\times 10^{3}}$$"
        },
        {
            "introduction": "Moving from continuous conservation laws to discrete algorithms on a grid introduces fundamental constraints on the numerical integration. A stable solution requires that the time step be linked to the grid spacing and flow velocity, a principle formalized by the Courant-Friedrichs-Lewy (CFL) condition. In this exercise, you will derive the CFL stability constraint for a 2D advection scheme from first principles and apply it to a practical scenario, gaining insight into why different numerical implementations, such as unsplit versus dimensionally split schemes, have different stability properties. ",
            "id": "3574958",
            "problem": "Consider two-dimensional advection of a passive scalar field $q(x,y,t)$ governed by the conservation law $\\partial_{t} q + \\nabla \\cdot (\\boldsymbol{u} q) = 0$ with a spatially uniform velocity field $\\boldsymbol{u} = (u,v)$. The computational domain is discretized by a uniform Cartesian grid with spacings $\\Delta x$ in the $x$-direction and $\\Delta y$ in the $y$-direction, and an explicit, unsplit, first-order upwind finite-volume scheme is used for the spatial discretization, advanced in time by an explicit forward Euler step. The velocity magnitude is $|\\boldsymbol{u}| = V$ and its direction forms an angle $\\theta$ with the positive $x$-axis, so that $u = V \\cos(\\theta)$ and $v = V \\sin(\\theta)$. \n\nFrom first principles of conservation and stability for monotone explicit schemes, derive the maximum stable time step that ensures a non-increasing discrete $L^{\\infty}$ norm and preserves a discrete maximum principle for $q$ under this unsplit update. Then evaluate this maximum stable time step for the following scientifically realistic parameter set for a computational geophysics tracer-transport application: $\\Delta x = 50\\,\\mathrm{m}$, $\\Delta y = 200\\,\\mathrm{m}$, $V = 1.8\\,\\mathrm{m/s}$, and $\\theta = \\pi/3$ radians. \n\nFinally, assess the implications of multi-dimensional Courant–Friedrichs–Lewy (CFL) constraints by comparing the unsplit stability constraint you derived with that of a dimensionally split first-order upwind update that applies the $x$-advection and $y$-advection sequentially in a single time step of duration $\\Delta t$. Explain which constraint is more restrictive and why, based on the structure of the explicit updates.\n\nReport only the maximum stable time step for the unsplit scheme, rounded to four significant figures and expressed in seconds.",
            "solution": "The problem statement has been validated and is determined to be a valid, well-posed problem in computational science. It is scientifically grounded, objective, and contains all necessary information to proceed with a unique solution.\n\nThe governing equation for the advection of a passive scalar field $q(x,y,t)$ is the conservation law:\n$$ \\partial_{t} q + \\nabla \\cdot (\\boldsymbol{u} q) = 0 $$\nGiven that the velocity field $\\boldsymbol{u} = (u,v)$ is spatially uniform, this simplifies to:\n$$ \\partial_{t} q + \\boldsymbol{u} \\cdot \\nabla q = 0 $$\nTo derive the finite-volume scheme, we integrate the conservation law over a computational cell $\\Omega_{i,j}$ with area $\\Delta x \\Delta y$, centered at $(x_i, y_j)$.\n$$ \\iint_{\\Omega_{i,j}} \\partial_{t} q \\,dA + \\iint_{\\Omega_{i,j}} \\nabla \\cdot (\\boldsymbol{u} q) \\,dA = 0 $$\nUsing the divergence theorem on the second term, we convert the area integral into a line integral over the cell boundary $\\partial\\Omega_{i,j}$:\n$$ \\frac{d}{dt} \\iint_{\\Omega_{i,j}} q \\,dA + \\oint_{\\partial\\Omega_{i,j}} (\\boldsymbol{u} q) \\cdot \\boldsymbol{n} \\,ds = 0 $$\nLet $q_{i,j}(t)$ represent the cell-averaged value, $q_{i,j} \\approx \\frac{1}{\\Delta x \\Delta y} \\iint_{\\Omega_{i,j}} q \\,dA$. The equation becomes:\n$$ \\Delta x \\Delta y \\frac{dq_{i,j}}{dt} + (\\text{Flux}_{east} - \\text{Flux}_{west}) + (\\text{Flux}_{north} - \\text{Flux}_{south}) = 0 $$\nThe fluxes through the cell faces are approximated as follows:\n$$ \\text{Flux}_{east} \\approx (u q_{i+1/2,j}) \\Delta y $$\n$$ \\text{Flux}_{west} \\approx (u q_{i-1/2,j}) \\Delta y $$\n$$ \\text{Flux}_{north} \\approx (v q_{i,j+1/2}) \\Delta x $$\n$$ \\text{Flux}_{south} \\approx (v q_{i,j-1/2}) \\Delta x $$\nwhere $q_{i \\pm 1/2, j}$ and $q_{i, j \\pm 1/2}$ are the scalar values at the cell faces. The semi-discrete equation is:\n$$ \\frac{dq_{i,j}}{dt} = - \\frac{u q_{i+1/2,j} - u q_{i-1/2,j}}{\\Delta x} - \\frac{v q_{i,j+1/2} - v q_{i,j-1/2}}{\\Delta y} $$\nFor a first-order upwind scheme, the face value is taken from the upwind cell. This can be written generally using positive and negative parts of the velocity. The numerical flux for the $x$-direction at face $i+1/2$ is $F_{i+1/2} = u^{+} q_{i,j} + u^{-} q_{i+1,j}$, where $u^{+} = \\max(u,0)$ and $u^{-} = \\min(u,0)$. This is equivalent to $F_{i+1/2} = \\frac{u+|u|}{2}q_{i,j} + \\frac{u-|u|}{2}q_{i+1,j}$.\nThe net flux divergence in the $x$-direction is approximated as:\n$$ \\frac{F_{i+1/2,j} - F_{i-1/2,j}}{\\Delta x} = \\frac{1}{\\Delta x} \\left[ (u^{+}q_{i,j} + u^{-}q_{i+1,j}) - (u^{+}q_{i-1,j} + u^{-}q_{i,j}) \\right] $$\nSimilarly for the $y$-direction. The semi-discrete equation becomes:\n$$ \\frac{dq_{i,j}}{dt} = - \\frac{1}{\\Delta x} \\left[ u^{+}(q_{i,j} - q_{i-1,j}) + u^{-}(q_{i+1,j} - q_{i,j}) \\right] - \\frac{1}{\\Delta y} \\left[ v^{+}(q_{i,j} - q_{i,j-1}) + v^{-}(q_{i,j+1} - q_{i,j}) \\right] $$\nApplying a forward Euler time step, $\\frac{q^{n+1}_{i,j} - q^n_{i,j}}{\\Delta t} = (\\dots)^n$:\n$$ q^{n+1}_{i,j} = q^n_{i,j} - \\frac{\\Delta t}{\\Delta x} \\left[ u^{+}(q^n_{i,j} - q^n_{i-1,j}) + u^{-}(q^n_{i+1,j} - q^n_{i,j}) \\right] - \\frac{\\Delta t}{\\Delta y} \\left[ v^{+}(q^n_{i,j} - q^n_{i,j-1}) + v^{-}(q^n_{i,j+1} - q^n_{i,j}) \\right] $$\nWe group terms by their spatial index at time level $n$:\n$$ q^{n+1}_{i,j} = \\left( 1 - \\frac{\\Delta t}{\\Delta x}(u^{+} - u^{-}) - \\frac{\\Delta t}{\\Delta y}(v^{+} - v^{-}) \\right)q^n_{i,j} + \\frac{\\Delta t}{\\Delta x} u^{+} q^n_{i-1,j} - \\frac{\\Delta t}{\\Delta x} u^{-} q^n_{i+1,j} + \\frac{\\Delta t}{\\Delta y} v^{+} q^n_{i,j-1} - \\frac{\\Delta t}{\\Delta y} v^{-} q^n_{i,j+1} $$\nRecognizing that $u^{+} - u^{-} = |u|$ and $v^{+} - v^{-} = |v|$, the update equation simplifies to:\n$$ q^{n+1}_{i,j} = \\left( 1 - \\frac{|u|\\Delta t}{\\Delta x} - \\frac{|v|\\Delta t}{\\Delta y} \\right)q^n_{i,j} + \\frac{|u|\\Delta t}{\\Delta x} q^n_{upwind,x} + \\frac{|v|\\Delta t}{\\Delta y} q^n_{upwind,y} $$\nwhere $q^n_{upwind,x}$ is the upwind value in $x$ (either $q^n_{i-1,j}$ or $q^n_{i+1,j}$) and $q^n_{upwind,y}$ is the upwind value in $y$.\n\nFor the scheme to satisfy a discrete maximum principle and have a non-increasing $L^{\\infty}$ norm, the new value $q^{n+1}_{i,j}$ must be a convex combination of the old values. This requires all coefficients in the stencil to be non-negative.\nThe coefficients of the upwind cells are $\\frac{\\Delta t}{\\Delta x}u^{+}$, $-\\frac{\\Delta t}{\\Delta x}u^{-}$, $\\frac{\\Delta t}{\\Delta y}v^{+}$, and $-\\frac{\\Delta t}{\\Delta y}v^{-}$. All these are inherently non-negative for any $u,v$.\nThe critical condition comes from the coefficient of $q^n_{i,j}$:\n$$ 1 - \\frac{|u|\\Delta t}{\\Delta x} - \\frac{|v|\\Delta t}{\\Delta y} \\ge 0 $$\nThis gives the Courant-Friedrichs-Lewy (CFL) stability constraint for the unsplit, first-order upwind scheme:\n$$ \\Delta t \\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} \\right) \\le 1 $$\nThe maximum stable time step $\\Delta t_{max}$ is therefore:\n$$ \\Delta t_{max} = \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y}} $$\nWe now evaluate this for the given parameters: $\\Delta x = 50\\,\\mathrm{m}$, $\\Delta y = 200\\,\\mathrm{m}$, $V = 1.8\\,\\mathrm{m/s}$, and $\\theta = \\pi/3$ radians.\nThe velocity components are:\n$$ |u| = |V \\cos(\\theta)| = |1.8 \\cos(\\pi/3)| = |1.8 \\times 0.5| = 0.9\\,\\mathrm{m/s} $$\n$$ |v| = |V \\sin(\\theta)| = |1.8 \\sin(\\pi/3)| = |1.8 \\times \\frac{\\sqrt{3}}{2}| = 0.9\\sqrt{3}\\,\\mathrm{m/s} \\approx 1.5588457\\,\\mathrm{m/s} $$\nSubstituting these values into the expression for $\\Delta t_{max}$:\n$$ \\Delta t_{max} = \\frac{1}{\\frac{0.9}{50} + \\frac{0.9\\sqrt{3}}{200}} = \\frac{1}{0.018 + \\frac{1.5588457}{200}} $$\n$$ \\Delta t_{max} = \\frac{1}{0.018 + 0.0077942286} = \\frac{1}{0.0257942286} \\approx 38.7683\\,\\mathrm{s} $$\nRounding to four significant figures, the maximum stable time step is $38.77\\,\\mathrm{s}$.\n\nFor the comparison, we consider a dimensionally split scheme. This involves two sequential steps:\n1. Advection in $x$: $q^* = \\mathcal{L}_x(\\Delta t) q^n$. The stability condition for this step is $\\frac{|u|\\Delta t}{\\Delta x} \\le 1$.\n2. Advection in $y$: $q^{n+1} = \\mathcal{L}_y(\\Delta t) q^*$. The stability condition for this step is $\\frac{|v|\\Delta t}{\\Delta y} \\le 1$.\nFor the combined split scheme to be stable, both individual steps must be stable. This requires that $\\Delta t$ satisfies both constraints simultaneously:\n$$ \\Delta t \\le \\frac{\\Delta x}{|u|} \\quad \\text{and} \\quad \\Delta t \\le \\frac{\\Delta y}{|v|} $$\nThis is equivalent to a single condition on the maximum time step:\n$$ \\Delta t_{split, max} = \\min\\left(\\frac{\\Delta x}{|u|}, \\frac{\\Delta y}{|v|}\\right) $$\nLet's compare the constraints. Let $C_x = \\frac{|u|\\Delta t}{\\Delta x}$ and $C_y = \\frac{|v|\\Delta t}{\\Delta y}$.\n- Unsplit constraint: $C_x + C_y \\le 1$.\n- Split constraint: $\\max(C_x, C_y) \\le 1$.\nSince $C_x \\ge 0$ and $C_y \\ge 0$, the condition $C_x + C_y \\le 1$ implies that both $C_x \\le 1$ and $C_y \\le 1$. Thus, any $\\Delta t$ stable for the unsplit scheme is also stable for the split scheme. However, the converse is not true. For example, if $C_x = 0.7$ and $C_y = 0.7$, the split scheme constraint $\\max(0.7, 0.7) \\le 1$ is satisfied, but the unsplit constraint $0.7+0.7 = 1.4 > 1$ is violated.\nTherefore, the **unsplit stability constraint is more restrictive** than the split scheme constraint.\nThe reason for this is that the unsplit update considers the total efflux of the quantity $q$ from a cell $(i,j)$ in all directions simultaneously within a single stage. The stability condition $1 - (C_x + C_y) \\ge 0$ ensures that the amount of $q$ leaving the cell in one time step does not exceed the amount of $q$ initially present in the cell. The split scheme decouples these two outflows into separate sub-steps, leading to a less restrictive, and often more desirable, stability limit.\nFor the given parameters:\n$$ \\Delta t_{split, max} = \\min\\left(\\frac{50}{0.9}, \\frac{200}{0.9\\sqrt{3}}\\right) = \\min(55.55\\dots, 128.3\\dots) = 55.56\\,\\mathrm{s} $$\nAs shown, $\\Delta t_{unsplit, max} (38.77\\,\\mathrm{s})$ is indeed smaller than $\\Delta t_{split, max} (55.56\\,\\mathrm{s})$.",
            "answer": "$$\n\\boxed{38.77}\n$$"
        }
    ]
}