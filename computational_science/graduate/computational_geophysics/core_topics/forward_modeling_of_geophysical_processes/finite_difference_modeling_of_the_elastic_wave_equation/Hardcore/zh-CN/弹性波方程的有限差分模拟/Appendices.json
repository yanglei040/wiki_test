{
    "hands_on_practices": [
        {
            "introduction": "在任何时域有限差分模拟中，时间步长 $\\Delta t$ 的选择都是一个基本且关键的决策。这个选择不仅要避免数值解发散（稳定性），还要确保模拟波的传播速度和形态不失真（准确性）。本练习将引导你从第一性原理出发，推导并应用两个核心约束——Courant-Friedrichs-Lewy (CFL) 稳定条件和数值频散误差限制——来为一个一维弹性波模拟选择最佳的时间步长 。",
            "id": "3593130",
            "problem": "考虑小振幅弹性纵波在均匀、各向同性固体中的一维传播。设质量密度为 $\\rho = 2700\\,\\mathrm{kg/m^3}$，第一拉梅参数为 $\\lambda = 20\\times 10^{9}\\,\\mathrm{Pa}$，剪切模量为 $\\mu = 30\\times 10^{9}\\,\\mathrm{Pa}$。您将使用时间上二阶精度的中心差分和空间上二阶精度的中心差分，在间距为 $\\Delta x = 2\\,\\mathrm{m}$ 的均匀网格上对位移场 $u(x,t)$ 进行建模。假设对于感兴趣的频率，空间频散已通过足够精细的空间分辨率得到控制，因此在最大模拟频率下，时间频散占主导地位。\n\n您的任务是选择一个单一的时间步长 $\\Delta t$，使其同时满足：\n- 显式格式的 Courant–Friedrichs–Lewy (CFL) 稳定性条件，以及\n- 在最大频率 $f_{\\max} = 500\\,\\mathrm{Hz}$ 下的时间相位误差约束，即相对时间相速度误差不超过 $\\varepsilon = 0.005$。\n\n从第一性原理（线性动量平衡和线性各向同性弹性）出发，推导控制稳定性的波速，推导所选二阶有限差分格式的稳定性条件，并推导在角频率 $\\omega_{\\max} = 2\\pi f_{\\max}$ 下由时间频散要求所隐含的 $\\Delta t$ 的主阶界。然后，选择 $\\Delta t$ 为稳定性限制的时间步长和时间频散限制的时间步长中的较小者。将您的答案四舍五入到四位有效数字。以秒为单位表示时间步长。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n-   波类型：一维、小振幅弹性纵波。\n-   介质：均匀、各向同性固体。\n-   质量密度：$\\rho = 2700\\,\\mathrm{kg/m^3}$。\n-   第一拉梅参数：$\\lambda = 20\\times 10^{9}\\,\\mathrm{Pa}$。\n-   剪切模量（第二拉梅参数）：$\\mu = 30\\times 10^{9}\\,\\mathrm{Pa}$。\n-   位移场：$u(x,t)$。\n-   数值格式：时间上二阶精度中心差分和空间上二阶精度中心差分。\n-   网格间距：$\\Delta x = 2\\,\\mathrm{m}$。\n-   假设：在最大模拟频率下，时间频散占主导地位。\n-   最大模拟频率：$f_{\\max} = 500\\,\\mathrm{Hz}$。\n-   时间相位误差约束：相对时间相速度误差不超过 $\\varepsilon = 0.005$。\n-   任务：选择一个满足稳定性和频散约束的单一时间步长 $\\Delta t$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于线性弹性动力学和有限差分法的基本原理，这些是计算地球物理学和地震学中的标准课题。所有物理参数和概念都是公认的。\n-   **适定性**：该问题提供了一套完整的参数（$\\rho, \\lambda, \\mu, \\Delta x, f_{\\max}, \\varepsilon$）和明确的约束（稳定性和频散），以确定时间步长 $\\Delta t$ 的唯一值。\n-   **客观性**：该问题使用精确、定量且无偏见的技术语言进行陈述。\n\n### 步骤 3：结论与行动\n该问题具有科学合理性、适定性和客观性。判定为**有效**。现在开始求解过程。\n\n### 控制方程和波速的推导\n\n一维线性动量平衡方程为\n$$\n\\frac{\\partial \\sigma_{xx}}{\\partial x} = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\n其中 $\\sigma_{xx}$ 是纵向应力，$u$ 是纵向位移，$\\rho$ 是质量密度。\n\n对于线性各向同性弹性固体，一维应力-应变关系（胡克定律）为\n$$\n\\sigma_{xx} = (\\lambda + 2\\mu) \\varepsilon_{xx}\n$$\n其中 $\\varepsilon_{xx}$ 是纵向应变，$\\lambda$ 和 $\\mu$ 是拉梅参数。应变与位移的关系为\n$$\n\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}\n$$\n将应变-位移关系和应力-应变关系代入动量方程，我们得到\n$$\n\\frac{\\partial}{\\partial x} \\left( (\\lambda + 2\\mu) \\frac{\\partial u}{\\partial x} \\right) = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\n对于均匀介质，$\\lambda$、$\\mu$ 和 $\\rho$ 是常数。该方程简化为一维弹性波方程：\n$$\n(\\lambda + 2\\mu) \\frac{\\partial^2 u}{\\partial x^2} = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\n这可以写成标准形式 $\\frac{\\partial^2 u}{\\partial t^2} = c_p^2 \\frac{\\partial^2 u}{\\partial x^2}$，其中 $c_p$ 是压缩波（P波）速度，由下式给出\n$$\nc_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}\n$$\n使用给定值：\n-   $\\lambda = 20 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\mu = 30 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\rho = 2700\\,\\mathrm{kg/m^3}$\n\nP波模量为 $M = \\lambda + 2\\mu = (20 \\times 10^9) + 2(30 \\times 10^9) = 80 \\times 10^9\\,\\mathrm{Pa}$。\nP波速度为：\n$$\nc_p = \\sqrt{\\frac{80 \\times 10^9\\,\\mathrm{Pa}}{2700\\,\\mathrm{kg/m^3}}} = \\sqrt{\\frac{800}{27} \\times 10^6}\\,\\mathrm{m/s} \\approx 5443.3105\\,\\mathrm{m/s}\n$$\n\n### 稳定性条件 (CFL)\n\n问题指定了在时间和空间上均为二阶精度的中心差分格式。波动方程离散化为：\n$$\n\\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{\\Delta t^2} = c_p^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\n$$\n其中 $u_j^n = u(j\\Delta x, n\\Delta t)$。对于这种显式格式，Courant–Friedrichs–Lewy (CFL) 稳定性条件是：\n$$\nS = \\frac{c_p \\Delta t}{\\Delta x} \\le 1\n$$\n其中 $S$ 是库朗数。该条件为保证格式稳定对时间步长设定了一个上限。稳定性允许的最大时间步长为：\n$$\n\\Delta t_{\\text{stab}} = \\frac{\\Delta x}{c_p}\n$$\n使用给定的网格间距 $\\Delta x = 2\\,\\mathrm{m}$ 和计算出的波速：\n$$\n\\Delta t_{\\text{stab}} = \\frac{2\\,\\mathrm{m}}{5443.3105\\,\\mathrm{m/s}} \\approx 3.6724 \\times 10^{-4}\\,\\mathrm{s}\n$$\n\n### 时间频散约束\n\n问题陈述时间频散占主导地位。这使我们可以独立于空间离散化来分析时间离散化的影响。我们考虑在时间上半离散化的方程，其中空间导数被解析处理。对于角频率为 $\\omega_{\\text{phy}}$ 的单个谐波分量，波动方程为 $\\frac{\\partial^2 u}{\\partial t^2} = -\\omega_{\\text{phy}}^2 u$。在时间上应用二阶中心差分算子可得：\n$$\n\\frac{u(t+\\Delta t) - 2u(t) + u(t-\\Delta t)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2 u(t)\n$$\n我们寻求形式为 $u(t) = \\exp(-i\\omega_{\\text{num}}t)$ 的数值解，其中 $\\omega_{\\text{num}}$ 是数值角频率。将其代入差分方程可得：\n$$\n\\frac{\\exp(-i\\omega_{\\text{num}}\\Delta t) - 2 + \\exp(i\\omega_{\\text{num}}\\Delta t)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n$$\n\\frac{2\\cos(\\omega_{\\text{num}}\\Delta t) - 2}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n使用恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$：\n$$\n\\frac{-4\\sin^2(\\omega_{\\text{num}}\\Delta t / 2)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n$$\n\\frac{2\\sin(\\omega_{\\text{num}}\\Delta t / 2)}{\\Delta t} = \\omega_{\\text{phy}}\n$$\n这是半离散化系统的频散关系。由此，我们求解数值频率 $\\omega_{\\text{num}}$：\n$$\n\\omega_{\\text{num}} = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right)\n$$\n数值相速度为 $c_{\\text{num}} = c_p \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{phy}}}$。相对相速度误差 $E_v$ 为：\n$$\nE_v = \\frac{c_{\\text{num}}}{c_p} - 1 = \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{phy}}} - 1 = \\frac{2}{\\omega_{\\text{phy}}\\Delta t} \\arcsin\\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right) - 1\n$$\n对于小量 $y$，$\\arcsin(y)$ 的泰勒展开为 $y + \\frac{y^3}{6} + O(y^5)$。令 $y = \\frac{\\omega_{\\text{phy}}\\Delta t}{2}$。对于小的时间步长，$y$ 很小，我们可以将误差近似到主阶：\n$$\nE_v \\approx \\frac{1}{y} \\left(y + \\frac{y^3}{6}\\right) - 1 = \\left(1 + \\frac{y^2}{6}\\right) - 1 = \\frac{y^2}{6}\n$$\n代回 $y$：\n$$\nE_v \\approx \\frac{1}{6} \\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right)^2 = \\frac{\\omega_{\\text{phy}}^2 \\Delta t^2}{24}\n$$\n问题要求在最大频率 $f_{\\max} = 500\\,\\mathrm{Hz}$（对应最大角频率 $\\omega_{\\max} = 2\\pi f_{\\max} = 2\\pi(500) = 1000\\pi\\,\\mathrm{rad/s}$）下，此误差不超过 $\\varepsilon = 0.005$。\n约束条件是：\n$$\n\\frac{\\omega_{\\max}^2 \\Delta t^2}{24} \\le \\varepsilon\n$$\n求解 $\\Delta t$ 得到频散限制的时间步长 $\\Delta t_{\\text{disp}}$：\n$$\n\\Delta t \\le \\frac{\\sqrt{24\\varepsilon}}{\\omega_{\\max}} \\implies \\Delta t_{\\text{disp}} = \\frac{\\sqrt{24\\varepsilon}}{\\omega_{\\max}}\n$$\n代入数值 $\\varepsilon = 0.005$ 和 $\\omega_{\\max} = 1000\\pi\\,\\mathrm{rad/s}$：\n$$\n\\Delta t_{\\text{disp}} = \\frac{\\sqrt{24 \\times 0.005}}{1000\\pi} = \\frac{\\sqrt{0.12}}{1000\\pi} \\approx \\frac{0.346410}{3141.5927} \\approx 1.10266 \\times 10^{-4}\\,\\mathrm{s}\n$$\n\n### 最终时间步长选择\n\n时间步长 $\\Delta t$ 必须同时满足稳定性和频散约束。因此，它必须是两个推导出的上限中的较小者：\n$$\n\\Delta t \\le \\min(\\Delta t_{\\text{stab}}, \\Delta t_{\\text{disp}})\n$$\n我们有：\n-   $\\Delta t_{\\text{stab}} \\approx 3.6724 \\times 10^{-4}\\,\\mathrm{s}$\n-   $\\Delta t_{\\text{disp}} \\approx 1.10266 \\times 10^{-4}\\,\\mathrm{s}$\n\n更严格的约束来自于时间频散要求。因此，最大允许时间步长为 $\\Delta t = \\Delta t_{\\text{disp}}$。\n$$\n\\Delta t = 1.10266 \\times 10^{-4}\\,\\mathrm{s}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t = 1.103 \\times 10^{-4}\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{1.103 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "真实的地球介质是高度非均匀的，充满了不同材料属性的界面。当我们在交错网格上进行模拟时，必须为那些横跨界面的网格点赋予等效的材料参数，如密度 $\\rho$ 和P波模量 $M$。本练习探讨了不同的参数平均策略，并从物理连续性条件出发，揭示了为何特定的平均方法（模量使用调和平均，密度使用算术平均）是确保能量守恒以及在强对比度界面附近获得稳定、精确解的关键 。",
            "id": "3593113",
            "problem": "考虑一维各向同性线弹性问题，其中纵向运动发生在 $x$ 方向，受线性动量守恒和胡克定律控制：$\\rho(x)\\,\\partial_t v(x,t)=\\partial_x \\sigma(x,t)$ 和 $\\partial_t \\sigma(x,t)=M(x)\\,\\partial_x v(x,t)$，其中 $v$ 是质点速度，$\\sigma$ 是正应力，$\\rho$ 是密度，$M=\\lambda+2\\mu$ 是用拉梅参数 $\\lambda$ 和 $\\mu$ 表示的P波模量。连续总能量密度为 $e=\\tfrac{1}{2}\\rho v^2+\\tfrac{1}{2}\\sigma^2/M$，连续能量通量为 $S=\\sigma v$。假设一个交错网格有限差分格式，其中 $v$ 存储在半网格点 $x_{i+1/2}$，$\\sigma$ 存储在整网格点 $x_i$，网格间距 $\\Delta x$ 均匀，并且在 $x=x_0$ 处有一个平面材料界面，该界面与一个应力网格点 $x_{i_0}=x_0$ 对齐。材料属性 $\\rho$、$\\lambda$ 和 $\\mu$ 在 $x_0$ 处不连续，具有强间断（例如，量级为一的跳跃）。\n\n要求您分析不同平均方案将 $\\rho$、$\\lambda$ 和 $\\mu$ 配置到离散更新所需的交错位置上的效果。具体来说，速度更新需要在 $x_{i+1/2}$ 处有 $\\rho$，应力更新需要在 $x_i$ 处有 $M$。当必须在界面上进行平均，以为一个跨越两种材料的交错位置提供属性时，有三种候选的平均方法：算术平均、调和平均和几何平均。仅使用第一性原理（线性动量守恒、胡克定律以及连续能量密度和通量的定义），推导交错格式的离散能量平衡，并确定哪种平均选择能确保跨越 $x_0$ 的离散能量通量连续性，并在强间断情况下最小化界面附近的虚假能量产生。在您的分析中，请通过讨论每种选择是高估还是低估了界面附近的局部波速估计，将平均选择与 Courant–Friedrichs–Lewy (CFL) 条件联系起来。\n\n当以离散能量通量连续性为主要评价指标时，哪种陈述最准确地描述了在强属性间断附近能产生最佳稳定性和准确性的平均选择？\n\nA. 在所有交错点上对 $\\rho$ 和模量（$\\lambda$ 和 $\\mu$）都使用算术平均；这能保持能量通量连续性，并在强间断附近产生最稳定的格式。\n\nB. 在速度点上对 $\\rho$ 使用算术平均，在应力点上对模量（即 $\\lambda$ 和 $\\mu$，等效于P波更新中的 $M=\\lambda+2\\mu$）使用调和平均；这种选择强制实现了跨界面的离散能量通量连续性，并提高了强间断下的稳定性和准确性。\n\nC. 在所有三个属性 $\\rho$、$\\lambda$ 和 $\\mu$ 的交错位置上都使用几何平均；这能最好地保持阻抗，从而保证能量通量连续性和稳定性。\n\nD. 对 $\\rho$ 使用调和平均，对 $\\lambda$ 和 $\\mu$ 使用算术平均；这能最优化地平衡质量和刚度，并在强间断间给出最准确的通量。",
            "solution": "该问题陈述是计算地球物理学中一个有效且适定的问题。它要求在具有强间断的界面上，为交错有限差分网格上的材料属性确定合适的平均方案。评判标准是离散能量通量连续性和数值稳定性。\n\n首先，让我们建立在位于 $x=x_0$ 的连续材料界面处的物理原理。对于焊接接触，位移 $u(x,t)$ 和应力 $\\sigma(x,t)$ 都必须是连续的。位移的连续性意味着质点速度 $v = \\partial_t u$ 的连续性。因此，我们有：\n1. $v(x_0^-, t) = v(x_0^+, t)$\n2. $\\sigma(x_0^-, t) = \\sigma(x_0^+, t)$\n\n这些条件对界面处的控制方程有直接影响。\n从第一个控制方程 $\\partial_t v = \\frac{1}{\\rho} \\partial_x \\sigma$ 来看，由于 $v$ 是连续的，$\\partial_t v$ 在界面两侧也是连续的。由于 $\\rho$ 不连续，这意味着 $\\partial_x \\sigma$ 必须有一个跳跃，以使量 $\\frac{1}{\\rho} \\partial_x \\sigma$ 保持连续。\n从第二个控制方程 $\\partial_t \\sigma = M \\partial_x v$ 来看，由于 $\\sigma$ 是连续的，$\\partial_t \\sigma$ 也是连续的。由于模量 $M$ 不连续，这意味着应变率 $\\partial_x v$ 必须有一个跳跃，以使量 $M \\partial_x v$ 保持连续。\n\n一个精确的有限差分格式应在其离散形式中遵守这些连续性属性。这可以通过为跨越界面的网格点上的材料属性 $\\rho$ 和 $M$ 选择合适的平均方案来实现。\n\n让我们分析 P 波模量 $M = \\lambda+2\\mu$ 的平均。应力更新在整网格点 $x_i$ 上执行，并需要 $M_i$。如果界面位于 $x_{i_0}$，则值 $M_{i_0}$ 必须是代表两种材料（比如 $M_1$ 和 $M_2$）属性的等效模量。在 $x_{i_0}$ 处的应力更新方程是：\n$$ \\frac{\\sigma_{i_0}^{n+1} - \\sigma_{i_0}^n}{\\Delta t} = M_{i_0} \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0-1/2}^{n+1/2}}{\\Delta x} $$\n左侧代表在 $x_{i_0}$ 处 $\\partial_t \\sigma$ 的离散近似，它是连续的。右侧是 $M \\partial_x v$ 的离散近似，它也是连续的。关键的物理洞察是考虑应力和应变在界面网格单元 $[x_{i_0-1/2}, x_{i_0+1/2}]$ 上的行为。由于应力 $\\sigma$ 是连续的，这类似于两个串联的弹簧。对于串联的材料，柔度（刚度的倒数）是可加的。穿过单元的总应变是每个部分应变的总和。单元的等效柔度是两种材料柔度的算术平均。柔度是 $1/M$。\n假设以 $x_{i_0}$ 为中心的网格单元在 $[x_{i_0-1/2}, x_{i_0}]$ 上由材料1组成，在 $[x_{i_0}, x_{i_0+1/2}]$ 上由材料2组成。对于给定的应力 $\\sigma$，单元 $\\Delta x$ 上的总应变增量为 $\\Delta\\epsilon = (\\sigma/M_1)(\\Delta x/2) + (\\sigma/M_2)(\\Delta x/2)$。等效模量 $M_{i_0}$ 由 $\\Delta\\epsilon = (\\sigma/M_{i_0})\\Delta x$ 定义。\n$$ \\frac{\\sigma}{M_{i_0}} \\Delta x = \\sigma \\left( \\frac{1}{M_1} \\frac{\\Delta x}{2} + \\frac{1}{M_2} \\frac{\\Delta x}{2} \\right) \\implies \\frac{1}{M_{i_0}} = \\frac{1}{2}\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) $$\n这是 $M_{i_0}$ 的调和平均的定义。如果在应力点上单独需要 $\\lambda$ 和 $\\mu$，也适用等效的论证。\n\n接下来，我们分析密度 $\\rho$ 的平均。速度更新在半整网格点 $x_{i+1/2}$ 上执行，并需要 $\\rho_{i+1/2}$。如果界面位于 $x_{i_0+1/2}$，则值 $\\rho_{i_0+1/2}$ 必须是等效密度。速度更新方程为：\n$$ \\rho_{i_0+1/2} \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} = \\frac{\\sigma_{i_0+1}^n - \\sigma_{i_0}^n}{\\Delta x} $$\n左侧是单位体积质量与加速度（离散近似）的乘积，右侧是单位体积力。该方程是控制体积 $[x_{i_0}, x_{i_0+1}]$ 的牛顿第二定律的离散形式。该体积内的总质量为 $\\text{质量} = \\rho_1 (\\Delta x/2) + \\rho_2 (\\Delta x/2)$。合力为 $\\sigma_{i_0+1}^n - \\sigma_{i_0}^n$。应用牛顿定律（质量 $\\times$ 加速度 = 力）：\n$$ (\\rho_1 \\frac{\\Delta x}{2} + \\rho_2 \\frac{\\Delta x}{2}) \\left( \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} \\right) = \\sigma_{i_0+1}^n - \\sigma_{i_0}^n $$\n将其重新排列以匹配有限差分形式，我们得到：\n$$ \\frac{\\rho_1 + \\rho_2}{2} \\left( \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} \\right) = \\frac{\\sigma_{i_0+1}^n - \\sigma_{i_0}^n}{\\Delta x} $$\n这表明等效密度 $\\rho_{i_0+1/2}$ 必须是 $\\rho_1$ 和 $\\rho_2$ 的算术平均。\n\n这些平均选择确保了离散格式正确地遵守了界面处的物理连续性条件。这反过来又最小化了虚假数值能量的产生，并确保了离散形式的能量通量连续性。因此，在强间断附近的格式稳定性得到了改善，这不是通过直接操纵 CFL 条件，而是通过构建一个物理上更准确、振荡更小的格式。如果对模量 $M$ 使用算术平均，局部波速 $c = \\sqrt{M/\\rho}$ 可能会被高估（因为算术平均总是大于或等于调和平均），这可能导致一个限制性较小但物理上不正确的局部条件。模量使用调和平均和密度使用算术平均的组合提供了最高的稳定性和准确性。\n\n我们现在根据此推导评估给定的选项。\n\nA. 在所有交错点上对 $\\rho$ 和模量（$\\lambda$ 和 $\\mu$）都使用算术平均；这能保持能量通量连续性，并在强间断附近产生最稳定的格式。\n这是不正确的。虽然对 $\\rho$ 使用算术平均是正确的，但对弹性模量 $M$、$\\lambda$ 和 $\\mu$ 来说是不正确的。对模量使用算术平均相当于假设应变是连续的，这在应力连续而模量不连续的界面上是物理上错误的。这种选择违反了物理原理，不能确保离散能量通量的连续性。\n\nB. 在速度点上对 $\\rho$ 使用算术平均，在应力点上对模量（即 $\\lambda$ 和 $\\mu$，等效于P波更新中的 $M=\\lambda+2\\mu$）使用调和平均；这种选择强制实现了跨界面的离散能量通量连续性，并提高了强间断下的稳定性和准确性。\n这是正确的。我们从第一性原理（应力连续性和控制体积的牛顿第二定律）的推导表明，对模量（$M$，并延伸至 $\\lambda$ 和 $\\mu$）使用调和平均是合适的，而对密度（$\\rho$）使用算术平均是合适的。这种组合遵守了物理连续性条件，这是确保能量通量连续性的离散等价物，并且已知在强间断界面处为交错网格格式提供了最稳定和最准确的结果。\n\nC. 在所有三个属性 $\\rho$、$\\lambda$ 和 $\\mu$ 的交错位置上都使用几何平均；这能最好地保持阻抗，从而保证能量通量连续性和稳定性。\n这是不正确的。在这种情况下，无论是对密度还是模量，从第一性原理的推导都不支持使用几何平均。虽然阻抗是反射/透射的一个重要概念，但将其守恒作为平均其组成参数的规则，对于偏微分方程算子本身的离散化来说，在物理上是不合理的。\n\nD. 对 $\\rho$ 使用调和平均，对 $\\lambda$ 和 $\\mu$ 使用算术平均；这能最优化地平衡质量和刚度，并在强间断间给出最准确的通量。\n这是不正确的。该陈述提出的方案与从物理原理推导出的正确方案完全相反。对 $\\rho$ 使用调和平均是不正确的，对模量使用算术平均也是不正确的。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "将有限差分法从一维推广到高维，并非简单地增加方程。变量在网格上的空间布局——即交错网格的设计——对于保证模拟的物理真实性至关重要。一个精心设计的交错网格能内在地满足连续介质力学的基本守恒律，例如角动量守恒所要求的应力张量对称性（$\\sigma_{ij}=\\sigma_{ji}$）。本练习通过对比几种离散格式，展示了标准的交错网格设计  如何精确地消除虚假的刚体旋转模式，从而凸显其在多维弹性波模拟中的优越性和必要性。",
            "id": "3593170",
            "problem": "考虑速度-应力形式的二维各向同性线性弹性波方程，该方程由无耦合应力的柯西连续介质中的线性和角动量守恒导出。主要场量为质点速度 $v_x$ 和 $v_z$，柯西应力分量 $\\sigma_{xx}$、$\\sigma_{zz}$ 和剪应力 $\\sigma_{xz}$，以及拉梅参数 $\\lambda$ 和 $\\mu$、质量密度 $\\rho$，所有这些都假定为空间常数。该连续介质满足应力对称性 $\\sigma_{ij}=\\sigma_{ji}$，以及一个运动学事实，即刚体旋转场产生零应变，因此也产生零应力。\n\n要求您在间距为 $\\Delta x$ 和 $\\Delta z$、时间步长为 $\\Delta t$ 的均匀笛卡尔网格上，选择一种二阶精度的时域有限差分 (FDTD) 蛙跳格式更新方案，该方案能以机器精度保持应力对称性 $\\sigma_{ij}=\\sigma_{ji}$，并能精确消除刚体旋转模式，从而避免虚假的旋转能量增长。目标是选择一种满足这些不变性的网格交错和离散更新方案，并将其与同位网格上可能出现的已知伪影进行对比。\n\n网格索引定义如下。整数索引 $(i,j)$ 指代位于 $(x_i,z_j)=(i\\,\\Delta x,j\\,\\Delta z)$ 的单元中心。半整数索引表示面或角点位置。采用蛙跳时间步进，其中速度存储在整数时间 $t^n=n\\,\\Delta t$，应力存储在半整数时间 $t^{n+\\tfrac{1}{2}}=\\left(n+\\tfrac{1}{2}\\right)\\Delta t$。\n\n从以下四种离散格式中选择唯一的最佳选项。\n\nA. 一种交错网格速度-应力格式，将 $v_x$ 存储在 $(i+\\tfrac{1}{2},j)$， $v_z$ 存储在 $(i,j+\\tfrac{1}{2})$，$\\sigma_{xx}$ 和 $\\sigma_{zz}$ 存储在 $(i,j)$，以及将单一剪应力 $\\sigma_{xz}$（同时代表 $\\sigma_{xz}$ 和 $\\sigma_{zx}$）存储在 $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$。更新公式为\n$$\n\\sigma_{xx}^{n+\\tfrac{1}{2}}(i,j)=\\sigma_{xx}^{n-\\tfrac{1}{2}}(i,j)+\\Delta t\\left[(\\lambda+2\\mu)\\,\\frac{v_x^n(i+\\tfrac{1}{2},j)-v_x^n(i-\\tfrac{1}{2},j)}{\\Delta x}+\\lambda\\,\\frac{v_z^n(i,j+\\tfrac{1}{2})-v_z^n(i,j-\\tfrac{1}{2})}{\\Delta z}\\right],\n$$\n$$\n\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j)=\\sigma_{zz}^{n-\\tfrac{1}{2}}(i,j)+\\Delta t\\left[\\lambda\\,\\frac{v_x^n(i+\\tfrac{1}{2},j)-v_x^n(i-\\tfrac{1}{2},j)}{\\Delta x}+(\\lambda+2\\mu)\\,\\frac{v_z^n(i,j+\\tfrac{1}{2})-v_z^n(i,j-\\tfrac{1}{2})}{\\Delta z}\\right],\n$$\n$$\n\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})=\\sigma_{xz}^{n-\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})\n+\\mu\\,\\Delta t\\left[\\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z}+\\frac{v_z^n(i+1,j+\\tfrac{1}{2})-v_z^n(i,j+\\tfrac{1}{2})}{\\Delta x}\\right],\n$$\n以及\n$$\nv_x^{n+1}(i+\\tfrac{1}{2},j)=v_x^{n}(i+\\tfrac{1}{2},j)+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xx}^{n+\\tfrac{1}{2}}(i+1,j)-\\sigma_{xx}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta x}+\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j-\\tfrac{1}{2})}{\\Delta z}\\right],\n$$\n$$\nv_z^{n+1}(i,j+\\tfrac{1}{2})=v_z^{n}(i,j+\\tfrac{1}{2})+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i-\\tfrac{1}{2},j+\\tfrac{1}{2})}{\\Delta x}+\\frac{\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j+1)-\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta z}\\right].\n$$\n\nB. 一种同位网格格式，将所有场分量 $v_x$、$v_z$、$\\sigma_{xx}$、$\\sigma_{zz}$、$\\sigma_{xz}$ 和 $\\sigma_{zx}$ 存储在单元中心 $(i,j)$ 和时间 $t^n$，应力更新到 $t^{n+1}$，无时间交错。剪应力使用单边空间差分进行更新：\n$$\n\\sigma_{xz}^{n+1}(i,j)=\\sigma_{xz}^{n}(i,j)+\\mu\\,\\Delta t\\left[\\frac{v_x^{n}(i,j+1)-v_x^{n}(i,j)}{\\Delta z}+\\frac{v_z^{n}(i+1,j)-v_z^{n}(i,j)}{\\Delta x}\\right],\n$$\n$$\n\\sigma_{zx}^{n+1}(i,j)=\\sigma_{zx}^{n}(i,j)+\\mu\\,\\Delta t\\left[\\frac{v_z^{n}(i+1,j)-v_z^{n}(i,j)}{\\Delta x}+\\frac{v_x^{n}(i,j)-v_x^{n}(i,j-1)}{\\Delta z}\\right],\n$$\n速度通过在同一点的应力的前向-后向差分进行更新。\n\nC. 一种交错网格格式，其场分量位置与选项A相同，但仅用一个梯度分量更新剪应力，\n$$\n\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})=\\sigma_{xz}^{n-\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})\n+\\mu\\,\\Delta t\\left[\\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z}\\right],\n$$\n并使用与选项A相同的速度和正应力更新公式。\n\nD. 一种交错网格格式，将剪应力存储在单元中心 $(i,j)$（而不是角点），并使用混合的前向-后向差分进行速度更新，\n$$\n\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)=\\sigma_{xz}^{n-\\tfrac{1}{2}}(i,j)+\\mu\\,\\Delta t\\left[\\frac{v_x^{n}(i,j+\\tfrac{1}{2})-v_x^{n}(i,j-\\tfrac{1}{2})}{\\Delta z}+\\frac{v_z^{n}(i+\\tfrac{1}{2},j)-v_z^{n}(i-\\tfrac{1}{2},j)}{\\Delta x}\\right],\n$$\n$$\nv_x^{n+1}(i+\\tfrac{1}{2},j)=v_x^{n}(i+\\tfrac{1}{2},j)+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xx}^{n+\\tfrac{1}{2}}(i+1,j)-\\sigma_{xx}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta x}+\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j-1)}{\\Delta z}\\right],\n$$\n$$\nv_z^{n+1}(i,j+\\tfrac{1}{2})=v_z^{n}(i,j+\\tfrac{1}{2})+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i-1,j)}{\\Delta x}+\\frac{\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j+1)-\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta z}\\right].\n$$\n\n哪个选项能确保 $\\sigma_{ij}=\\sigma_{ji}$ 达到机器精度，并消除虚假的刚体旋转模式，而其他选项则表现出典型的同位或错位离散化所特有的伪影？",
            "solution": "该问题要求为二维各向同性弹性波方程选择一种时域有限差分 (FDTD) 格式，该格式能保持应力对称性并正确处理刚体旋转。我们首先陈述控制连续方程以及需要验证的性质。\n\n二维各向同性线性弹性波方程的速度-应力形式如下：\n动量守恒：\n$$ \\rho \\frac{\\partial v_x}{\\partial t} = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xz}}{\\partial z} $$\n$$ \\rho \\frac{\\partial v_z}{\\partial t} = \\frac{\\partial \\sigma_{zx}}{\\partial x} + \\frac{\\partial \\sigma_{zz}}{\\partial z} $$\n本构关系（各向同性固体的胡克定律）：\n$$ \\frac{\\partial \\sigma_{xx}}{\\partial t} = (\\lambda + 2\\mu) \\frac{\\partial v_x}{\\partial x} + \\lambda \\frac{\\partial v_z}{\\partial z} $$\n$$ \\frac{\\partial \\sigma_{zz}}{\\partial t} = \\lambda \\frac{\\partial v_x}{\\partial x} + (\\lambda + 2\\mu) \\frac{\\partial v_z}{\\partial z} $$\n$$ \\frac{\\partial \\sigma_{xz}}{\\partial t} = \\mu \\left( \\frac{\\partial v_x}{\\partial z} + \\frac{\\partial v_z}{\\partial x} \\right) $$\n对于应力对称性，$\\sigma_{zx} = \\sigma_{xz}$，这意味着 $\\frac{\\partial \\sigma_{zx}}{\\partial t} = \\frac{\\partial \\sigma_{xz}}{\\partial t}$。\n\n我们必须根据两个标准来分析每个提议的离散格式：\n1.  **保持应力对称性**：格式必须确保 $\\sigma_{xz} = \\sigma_{zx}$ 达到机器精度。实现这一点的一个常用方法是只计算一个剪应力分量（例如 $\\sigma_{xz}$），并在 $v_x$（代表 $\\sigma_{xz}$）和 $v_z$（代表 $\\sigma_{zx}$）的更新方程中使用它。\n2.  **消除刚体旋转模式**：$x-z$ 平面内的刚体旋转由速度场 $v_x = -\\omega z$ 和 $v_z = \\omega x$ 描述，其中 $\\omega$ 是某个恒定的角速度。该速度场对应于零应变。一个有效的数值格式不能从此类速度场中产生应力。这意味着对于该速度场的离散表示，离散化的应变率项必须计算为零。\n\n让我们定义 FDTD 格式中使用的离散微分算子。场 $f$ 在位置 $(i,j)$ 处关于 $x$ 的二阶中心差分通常形式为 $D_x f(i,j) = \\frac{f(i+\\tfrac{1}{2},j) - f(i-\\tfrac{1}{2},j)}{\\Delta x}$。\n\n### 逐项分析\n\n**选项A的分析**\n\n该选项提出了标准的旋转交错网格，也称为 Virieux (1986) 格式。\n-   **网格交错**：$v_x$ 在 $(i+\\tfrac{1}{2},j)$， $v_z$ 在 $(i,j+\\tfrac{1}{2})$，正应力 $\\sigma_{xx}, \\sigma_{zz}$ 在 $(i,j)$，剪应力 $\\sigma_{xz}$ 在 $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$。\n-   **应力对称性**：该格式只计算一个剪应力分量 $\\sigma_{xz}$，并在 $v_x$ 和 $v_z$ 的更新中使用它。这通过构造强制实现了 $\\sigma_{xz} = \\sigma_{zx}$。此性质得到满足。\n-   **刚体旋转**：让我们在交错网格上离散化旋转场 $v_x = -\\omega z, v_z = \\omega x$。\n    $v_x$ 位于 $(x_{i+\\tfrac{1}{2}}, z_j)$，因此 $v_x^n(i+\\tfrac{1}{2}, j) = -\\omega z_j = -\\omega j \\Delta z$。\n    $v_z$ 位于 $(x_i, z_{j+\\tfrac{1}{2}})$，因此 $v_z^n(i, j+\\tfrac{1}{2}) = \\omega x_i = \\omega i \\Delta x$。\n\n    位于 $(i,j)$ 的 $\\sigma_{xx}$ 和 $\\sigma_{zz}$ 的更新取决于 $\\frac{\\partial v_x}{\\partial x}$ 和 $\\frac{\\partial v_z}{\\partial z}$ 的离散近似：\n    $D_x v_x = \\frac{v_x^n(i+\\tfrac{1}{2},j)-v_x^n(i-\\tfrac{1}{2},j)}{\\Delta x} = \\frac{(-\\omega j \\Delta z) - (-\\omega j \\Delta z)}{\\Delta x} = 0$。\n    $D_z v_z = \\frac{v_z^n(i,j+\\tfrac{1}{2})-v_z^n(i,j-\\tfrac{1}{2})}{\\Delta z} = \\frac{(\\omega i \\Delta x) - (\\omega i \\Delta x)}{\\Delta z} = 0$。\n    由于这些项为零，$\\sigma_{xx}$ 和 $\\sigma_{zz}$ 不会被虚假地产生。\n\n    位于 $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$ 的 $\\sigma_{xz}$ 更新取决于 $\\frac{\\partial v_x}{\\partial z} + \\frac{\\partial v_z}{\\partial x}$ 的离散近似：\n    $D_z v_x = \\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z} = \\frac{(-\\omega (j+1) \\Delta z) - (-\\omega j \\Delta z)}{\\Delta z} = -\\omega$。\n    $D_x v_z = \\frac{v_z^n(i+1,j+\\tfrac{1}{2})-v_z^n(i,j+\\tfrac{1}{2})}{\\Delta x} = \\frac{(\\omega (i+1) \\Delta x) - (\\omega i \\Delta x)}{\\Delta x} = \\omega$。\n    两者之和为 $D_z v_x + D_x v_z = -\\omega + \\omega = 0$。\n    因此，$\\sigma_{xz}$ 也不会被虚假地产生。对于刚体旋转，所有应力更新方程产生的变化都为零。这是因为在交错网格上，所有空间导数都是自然中心化的。\n\n**选项A的结论**：正确。该格式满足所有两项必要性质。\n\n**选项B的分析**\n\n该选项提出了一个同位网格格式。\n-   **网格交错**：所有变量都位于相同的点 $(i,j)$。没有时间交错。\n-   **应力对称性**：该格式使用不同的离散公式分别更新 $\\sigma_{xz}$ 和 $\\sigma_{zx}$。例如，在更新 $\\sigma_{xz}$ 时，$\\frac{\\partial v_x}{\\partial z}$ 由前向差分 $\\frac{v_x^{n}(i,j+1)-v_x^{n}(i,j)}{\\Delta z}$ 近似，但在更新 $\\sigma_{zx}$ 时，则由后向差分 $\\frac{v_x^{n}(i,j)-v_x^{n}(i,j-1)}{\\Delta z}$ 近似。由于更新规则不同，$\\sigma_{xz}$ 和 $\\sigma_{zx}$ 在数值上会发散，从而破坏对称性。这是弹性力学简单同位网格格式的一个已知伪影。此性质不满足。\n-   **时间步进**：问题陈述指定了蛙跳格式，但选项B指出“应力更新到 $t^{n+1}$，无时间交错”，这不是蛙跳格式。这违反了问题的一个前提。\n\n**选项B的结论**：不正确。它未能保持应力对称性，也没有使用指定的蛙跳时间步进格式。\n\n**选项C的分析**\n\n该选项使用与选项A相同的交错网格，但修改了剪应力更新。\n-   **网格交错**：与A相同。\n-   **应力对称性**：使用单一剪应力分量 $\\sigma_{xz}$。此性质得到满足。\n-   **刚体旋转**：$\\sigma_{xz}$ 的更新公式为：\n    $\\sigma_{xz}^{n+\\tfrac{1}{2}}(\\dots) = \\sigma_{xz}^{n-\\tfrac{1}{2}}(\\dots) + \\mu\\,\\Delta t\\left[\\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z}\\right]$。\n    该格式仅近似了 $\\frac{\\partial \\sigma_{xz}}{\\partial t} = \\mu \\frac{\\partial v_x}{\\partial z}$，省略了物理上必需的 $\\mu \\frac{\\partial v_z}{\\partial x}$ 项。这是对控制方程的根本性错误离散化。\n    让我们用刚体旋转场来测试这个有缺陷的格式。正如为选项A计算的那样，离散项 $D_z v_x$ 的值为 $-\\omega$。缺失的 $D_x v_z$ 项本应为 $+\\omega$。由于缺少第二项，剪应力的更新非零：$\\frac{\\partial \\sigma_{xz}}{\\partial t} \\approx -\\mu\\omega \\neq 0$。这意味着刚体旋转会虚假地产生剪应力。\n\n**选项C的结论**：不正确。该格式在物理上不一致，并且未能消除刚体旋转模式。\n\n**选项D的分析**\n\n该选项提出了一个不同的交错网格，其中剪应力 $\\sigma_{xz}$ 位于单元中心 $(i,j)$，而其他变量的放置方式与选项A相同。\n-   **网格交错**：$v_x$ 在 $(i+\\tfrac{1}{2},j)$， $v_z$ 在 $(i,j+\\tfrac{1}{2})$，$\\sigma_{xx}, \\sigma_{zz}$ 在 $(i,j)$，以及 $\\sigma_{xz}$ 在 $(i,j)$。\n-   **内部一致性**：$\\sigma_{xz}$ 的更新公式为：\n    $\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)=\\dots+\\mu\\,\\Delta t\\left[\\frac{v_x^n(i,j+\\tfrac{1}{2})-v_x^n(i,j-\\tfrac{1}{2})}{\\Delta z}+\\frac{v_z^n(i+\\tfrac{1}{2},j)-v_z^n(i-\\tfrac{1}{2},j)}{\\Delta x}\\right]$。\n    该公式需要像 $(i, j+\\tfrac{1}{2})$ 这样位置上的 $v_x$ 值，但 $v_x$ 在网格上定义于 $(i+\\tfrac{1}{2},j)$。类似地，它需要 $(i+\\tfrac{1}{2},j)$ 处的 $v_z$ 值，但 $v_z$ 定义于 $(i,j+\\tfrac{1}{2})$。该公式定义不明确，因为它查询了变量未存储位置上的值，而没有指定插值规则。\n-   **导数中心化**：让我们检查速度更新。在 $(i+\\tfrac{1}{2},j)$ 处 $v_x$ 的更新涉及项 $\\frac{\\partial \\sigma_{xz}}{\\partial z}$。其离散公式为 $\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j-1)}{\\Delta z}$。此有限差分中心位于 $(i, j-\\tfrac{1}{2})$。这不是 $v_x$ 的位置，即 $(i+\\tfrac{1}{2},j)$。离散导数与被更新变量之间的这种空间错位会导致精度降低并可能引入数值伪影。一个设计良好的格式，如选项A，所有导数都精确地中心化在需要它们的位置。\n\n**选项D的结论**：不正确。该格式如其所述是定义不明确的。即使通过某种隐式插值来解释，它也存在导数计算不对齐的问题，这是一个已知的数值缺陷（“错位离散化”）。\n\n### 结论\n\n选项A是唯一一个定义明确、正确近似控制方程，并满足两个关键不变性（保持应力对称性和消除刚体旋转模式）的格式。这些性质是其特定交错网格结构的直接结果，该结构确保了离散算子具有正确的伴随关系，从而模仿了连续微分算子的性质。其他选项都包含了替代离散化方法的典型缺陷。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}