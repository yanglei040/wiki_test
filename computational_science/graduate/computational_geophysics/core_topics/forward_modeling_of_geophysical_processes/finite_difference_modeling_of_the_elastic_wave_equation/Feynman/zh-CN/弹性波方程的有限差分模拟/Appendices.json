{
    "hands_on_practices": [
        {
            "introduction": "在多维建模中，首要决策之一是如何在网格上排布（或称“交错”）物理变量。这并非简单的约定俗成，而是对模拟的物理准确性有着深远影响。本练习旨在挑战你分析不同的网格布局，并选择能够正确保持基本物理定律的方案，例如应力张量的对称性和刚体旋转的行为。",
            "id": "3593170",
            "problem": "考虑速度-应力形式的二维各向同性线性弹性波方程，该方程由无力偶应力的柯西连续介质中的线动量和角动量守恒导出。主要场量为质点速度 $v_x$ 和 $v_z$、柯西应力分量 $\\sigma_{xx}$、$\\sigma_{zz}$ 和剪应力 $\\sigma_{xz}$，以及拉梅参数 $\\lambda$ 和 $\\mu$ 和质量密度 $\\rho$，所有这些都假定在空间上是常数。该连续介质满足应力对称性 $\\sigma_{ij}=\\sigma_{ji}$，以及刚体旋转场产生零应变并因此产生零应变的运动学事实。\n\n要求您在间距为 $\\Delta x$ 和 $\\Delta z$、时间步长为 $\\Delta t$ 的均匀笛卡尔网格上，选择一个二阶精度的时域有限差分（FDTD）蛙跳格式更新方案，该方案能以机器精度保持应力对称性 $\\sigma_{ij}=\\sigma_{ji}$，并能精确消除刚体旋转模式，从而避免虚假的旋转能量增长。目标是选择一种满足这些不变性属性的网格交错和离散更新方案，并将其与同位网格上可能出现的已知伪影进行对比。\n\n网格索引定义如下。整数索引 $(i,j)$ 指的是位于 $(x_i,z_j)=(i\\,\\Delta x,j\\,\\Delta z)$ 的网格中心。半整数索引表示面或角的位置。采用蛙跳格式时间步进，其中速度存储在整数时间 $t^n=n\\,\\Delta t$，应力存储在半整数时间 $t^{n+\\tfrac{1}{2}}=\\left(n+\\tfrac{1}{2}\\right)\\Delta t$。\n\n从以下四个离散方案中选择唯一最佳的选项。\n\nA. 一种交错网格速度-应力方案，将 $v_x$ 存储在 $(i+\\tfrac{1}{2},j)$，$v_z$ 存储在 $(i,j+\\tfrac{1}{2})$，$\\sigma_{xx}$ 和 $\\sigma_{zz}$ 存储在 $(i,j)$，以及一个剪应力 $\\sigma_{xz}$（同时代表 $\\sigma_{xz}$ 和 $\\sigma_{zx}$）存储在 $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$。更新公式为\n$$\n\\sigma_{xx}^{n+\\tfrac{1}{2}}(i,j)=\\sigma_{xx}^{n-\\tfrac{1}{2}}(i,j)+\\Delta t\\left[(\\lambda+2\\mu)\\,\\frac{v_x^n(i+\\tfrac{1}{2},j)-v_x^n(i-\\tfrac{1}{2},j)}{\\Delta x}+\\lambda\\,\\frac{v_z^n(i,j+\\tfrac{1}{2})-v_z^n(i,j-\\tfrac{1}{2})}{\\Delta z}\\right],\n$$\n$$\n\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j)=\\sigma_{zz}^{n-\\tfrac{1}{2}}(i,j)+\\Delta t\\left[\\lambda\\,\\frac{v_x^n(i+\\tfrac{1}{2},j)-v_x^n(i-\\tfrac{1}{2},j)}{\\Delta x}+(\\lambda+2\\mu)\\,\\frac{v_z^n(i,j+\\tfrac{1}{2})-v_z^n(i,j-\\tfrac{1}{2})}{\\Delta z}\\right],\n$$\n$$\n\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})=\\sigma_{xz}^{n-\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})\n+\\mu\\,\\Delta t\\left[\\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z}+\\frac{v_z^n(i+1,j+\\tfrac{1}{2})-v_z^n(i,j+\\tfrac{1}{2})}{\\Delta x}\\right],\n$$\n以及\n$$\nv_x^{n+1}(i+\\tfrac{1}{2},j)=v_x^{n}(i+\\tfrac{1}{2},j)+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xx}^{n+\\tfrac{1}{2}}(i+1,j)-\\sigma_{xx}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta x}+\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j-\\tfrac{1}{2})}{\\Delta z}\\right],\n$$\n$$\nv_z^{n+1}(i,j+\\tfrac{1}{2})=v_z^{n}(i,j+\\tfrac{1}{2})+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i-\\tfrac{1}{2},j+\\tfrac{1}{2})}{\\Delta x}+\\frac{\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j+1)-\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta z}\\right].\n$$\n\nB. 一种同位网格方案，将所有场分量 $v_x$、$v_z$、$\\sigma_{xx}$、$\\sigma_{zz}$、$\\sigma_{xz}$ 和 $\\sigma_{zx}$ 存储在网格中心 $(i,j)$ 和时间 $t^n$，应力更新到 $t^{n+1}$，没有时间交错。剪应力使用单边空间差分进行更新：\n$$\n\\sigma_{xz}^{n+1}(i,j)=\\sigma_{xz}^{n}(i,j)+\\mu\\,\\Delta t\\left[\\frac{v_x^{n}(i,j+1)-v_x^{n}(i,j)}{\\Delta z}+\\frac{v_z^{n}(i+1,j)-v_z^{n}(i,j)}{\\Delta x}\\right],\n$$\n$$\n\\sigma_{zx}^{n+1}(i,j)=\\sigma_{zx}^{n}(i,j)+\\mu\\,\\Delta t\\left[\\frac{v_z^{n}(i+1,j)-v_z^{n}(i,j)}{\\Delta x}+\\frac{v_x^{n}(i,j)-v_x^{n}(i,j-1)}{\\Delta z}\\right],\n$$\n速度通过在同一中心点对应力的前向-后向差分进行更新。\n\nC. 一种交错网格方案，使用与选项 A 相同的变量位置，但仅用一个梯度分量更新剪应力，\n$$\n\\sigma_{xz}^{n+\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})=\\sigma_{xz}^{n-\\tfrac{1}{2}}(i+\\tfrac{1}{2},j+\\tfrac{1}{2})\n+\\mu\\,\\Delta t\\left[\\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z}\\right],\n$$\n并使用与选项 A 相同的速度和法向应力更新公式。\n\nD. 一种交错网格方案，将剪应力存储在网格中心 $(i,j)$（而不是角点），并使用混合的前向-后向差分进行速度更新，\n$$\n\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)=\\sigma_{xz}^{n-\\tfrac{1}{2}}(i,j)+\\mu\\,\\Delta t\\left[\\frac{v_x^{n}(i,j+\\tfrac{1}{2})-v_x^{n}(i,j-\\tfrac{1}{2})}{\\Delta z}+\\frac{v_z^{n}(i+\\tfrac{1}{2},j)-v_z^{n}(i-\\tfrac{1}{2},j)}{\\Delta x}\\right],\n$$\n$$\nv_x^{n+1}(i+\\tfrac{1}{2},j)=v_x^{n}(i+\\tfrac{1}{2},j)+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xx}^{n+\\tfrac{1}{2}}(i+1,j)-\\sigma_{xx}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta x}+\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j-1)}{\\Delta z}\\right],\n$$\n$$\nv_z^{n+1}(i,j+\\tfrac{1}{2})=v_z^{n}(i,j+\\tfrac{1}{2})+\\frac{\\Delta t}{\\rho}\\left[\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i-1,j)}{\\Delta x}+\\frac{\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j+1)-\\sigma_{zz}^{n+\\tfrac{1}{2}}(i,j)}{\\Delta z}\\right].\n$$\n\n哪个选项能确保 $\\sigma_{ij}=\\sigma_{ji}$ 达到机器精度并消除虚假的刚体旋转模式，而其他选项则表现出同位网格或不匹配离散化所特有的伪影？",
            "solution": "该问题要求为二维各向同性弹性波方程选择一种时域有限差分（FDTD）方案，该方案能保持应力对称性并正确处理刚体旋转。我们首先陈述控制连续方程以及需要验证的属性。\n\n二维各向同性线性弹性波方程的速度-应力形式如下：\n动量守恒：\n$$ \\rho \\frac{\\partial v_x}{\\partial t} = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xz}}{\\partial z} $$\n$$ \\rho \\frac{\\partial v_z}{\\partial t} = \\frac{\\partial \\sigma_{zx}}{\\partial x} + \\frac{\\partial \\sigma_{zz}}{\\partial z} $$\n本构关系（各向同性固体的胡克定律）：\n$$ \\frac{\\partial \\sigma_{xx}}{\\partial t} = (\\lambda + 2\\mu) \\frac{\\partial v_x}{\\partial x} + \\lambda \\frac{\\partial v_z}{\\partial z} $$\n$$ \\frac{\\partial \\sigma_{zz}}{\\partial t} = \\lambda \\frac{\\partial v_x}{\\partial x} + (\\lambda + 2\\mu) \\frac{\\partial v_z}{\\partial z} $$\n$$ \\frac{\\partial \\sigma_{xz}}{\\partial t} = \\mu \\left( \\frac{\\partial v_x}{\\partial z} + \\frac{\\partial v_z}{\\partial x} \\right) $$\n对于应力对称性，$\\sigma_{zx} = \\sigma_{xz}$，这意味着 $\\frac{\\partial \\sigma_{zx}}{\\partial t} = \\frac{\\partial \\sigma_{xz}}{\\partial t}$。\n\n我们必须根据两个标准分析每个提议的离散方案：\n1.  **保持应力对称性**：方案必须确保 $\\sigma_{xz} = \\sigma_{zx}$ 达到机器精度。实现这一点的一个常用方法是只计算一个剪应力分量，比如 $\\sigma_{xz}$，并在更新 $v_x$（代表 $\\sigma_{xz}$）和 $v_z$（代表 $\\sigma_{zx}$）的方程中使用它。\n2.  **消除刚体旋转模式**：x-z 平面内的刚体旋转由速度场 $v_x = -\\omega z$ 和 $v_z = \\omega x$ 描述，其中 $\\omega$ 是某个恒定的角速度。该速度场对应于零应变。一个有效的数值方案必须不能从此类速度场中产生应力。这意味着对于该速度场的离散表示，离散化的应变率项必须计算为零。\n\n让我们定义在FDTD方案中使用的离散导数算子。场 $f$ 在位置 $(i,j)$ 相对于 $x$ 的二阶中心差分通常形式为 $D_x f(i,j) = \\frac{f(i+\\tfrac{1}{2},j) - f(i-\\tfrac{1}{2},j)}{\\Delta x}$。\n\n### 逐项分析\n\n**选项 A 的分析**\n\n该选项提出了标准的旋转交错网格，也称为 Virieux (1986) 方案。\n-   **网格交错**：$v_x$ 在 $(i+\\tfrac{1}{2},j)$，$v_z$ 在 $(i,j+\\tfrac{1}{2})$，法向应力 $\\sigma_{xx}, \\sigma_{zz}$ 在 $(i,j)$，剪应力 $\\sigma_{xz}$ 在 $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$。\n-   **应力对称性**：该方案只计算一个剪应力分量 $\\sigma_{xz}$，并在 $v_x$ 和 $v_z$ 的更新中使用它。这通过构造强制了 $\\sigma_{xz} = \\sigma_{zx}$。此属性得到满足。\n-   **刚体旋转**：让我们在交错网格上离散化旋转场 $v_x = -\\omega z, v_z = \\omega x$。\n    $v_x$ 位于 $(x_{i+\\tfrac{1}{2}}, z_j)$，所以 $v_x^n(i+\\tfrac{1}{2}, j) = -\\omega z_j = -\\omega j \\Delta z$。\n    $v_z$ 位于 $(x_i, z_{j+\\tfrac{1}{2}})$，所以 $v_z^n(i, j+\\tfrac{1}{2}) = \\omega x_i = \\omega i \\Delta x$。\n\n    在 $(i,j)$ 处 $\\sigma_{xx}$ 和 $\\sigma_{zz}$ 的更新取决于 $\\frac{\\partial v_x}{\\partial x}$ 和 $\\frac{\\partial v_z}{\\partial z}$ 的离散近似：\n    $D_x v_x = \\frac{v_x^n(i+\\tfrac{1}{2},j)-v_x^n(i-\\tfrac{1}{2},j)}{\\Delta x} = \\frac{(-\\omega j \\Delta z) - (-\\omega j \\Delta z)}{\\Delta x} = 0$。\n    $D_z v_z = \\frac{v_z^n(i,j+\\tfrac{1}{2})-v_z^n(i,j-\\tfrac{1}{2})}{\\Delta z} = \\frac{(\\omega i \\Delta x) - (\\omega i \\Delta x)}{\\Delta z} = 0$。\n    由于这些项为零，$\\sigma_{xx}$ 和 $\\sigma_{zz}$ 不会虚假地产生。\n\n    在 $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$ 处 $\\sigma_{xz}$ 的更新取决于 $\\frac{\\partial v_x}{\\partial z} + \\frac{\\partial v_z}{\\partial x}$ 的离散近似：\n    $D_z v_x = \\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z} = \\frac{(-\\omega (j+1) \\Delta z) - (-\\omega j \\Delta z)}{\\Delta z} = -\\omega$。\n    $D_x v_z = \\frac{v_z^n(i+1,j+\\tfrac{1}{2})-v_z^n(i,j+\\tfrac{1}{2})}{\\Delta x} = \\frac{(\\omega (i+1) \\Delta x) - (\\omega i \\Delta x)}{\\Delta x} = \\omega$。\n    它们的和是 $D_z v_x + D_x v_z = -\\omega + \\omega = 0$。\n    因此，$\\sigma_{xz}$ 也不会虚假地产生。对于刚体旋转，所有应力更新方程都产生零变化。这是因为在交错网格上，所有的空间导数都是自然居中的。\n\n**选项 A 的结论**：正确。该方案满足两个所需属性。\n\n**选项 B 的分析**\n\n该选项提出了一个同位网格方案。\n-   **网格交错**：所有变量都位于相同的点 $(i,j)$。没有时间交错。\n-   **应力对称性**：该方案使用不同的离散公式分别更新 $\\sigma_{xz}$ 和 $\\sigma_{zx}$。例如，对于 $\\sigma_{xz}$ 的更新，$\\frac{\\partial v_x}{\\partial z}$ 由前向差分 $\\frac{v_x^{n}(i,j+1)-v_x^{n}(i,j)}{\\Delta z}$ 近似；而对于 $\\sigma_{zx}$ 的更新，则由后向差分 $\\frac{v_x^{n}(i,j)-v_x^{n}(i,j-1)}{\\Delta z}$ 近似。由于更新规则不同，$\\sigma_{xz}$ 和 $\\sigma_{zx}$ 在数值上会发散，破坏了对称性。这是简单同位网格方案在弹性问题中的一个已知伪影。该属性未得到满足。\n-   **时间步进**：问题陈述指定了蛙跳格式，但选项 B 指出“应力更新到 $t^{n+1}$，没有时间交错”，这不是蛙跳格式。这违反了问题的一个前提。\n\n**选项 B 的结论**：不正确。它未能保持应力对称性，并且没有使用指定的蛙跳格式时间步进。\n\n**选项 C 的分析**\n\n该选项使用与选项 A 相同的交错网格，但修改了剪应力更新。\n-   **网格交错**：与 A 相同。\n-   **应力对称性**：使用单一剪应力分量 $\\sigma_{xz}$。该属性得到满足。\n-   **刚体旋转**：$\\sigma_{xz}$ 的更新由以下公式给出：\n    $\\sigma_{xz}^{n+\\tfrac{1}{2}}(\\dots) = \\sigma_{xz}^{n-\\tfrac{1}{2}}(\\dots) + \\mu\\,\\Delta t\\left[\\frac{v_x^n(i+\\tfrac{1}{2},j+1)-v_x^n(i+\\tfrac{1}{2},j)}{\\Delta z}\\right]$。\n    该方案仅近似了 $\\frac{\\partial \\sigma_{xz}}{\\partial t} = \\mu \\frac{\\partial v_x}{\\partial z}$，省略了物理上必需的 $\\mu \\frac{\\partial v_z}{\\partial x}$ 项。这是对控制方程的一个根本错误的离散化。\n    让我们用刚体旋转场测试这个有缺陷的方案。如对选项 A 的计算，离散项 $D_z v_x$ 计算结果为 $-\\omega$。缺失的 $D_x v_z$ 项本应计算为 $+\\omega$。由于第二项缺失，剪应力的更新非零：$\\frac{\\partial \\sigma_{xz}}{\\partial t} \\approx -\\mu\\omega \\neq 0$。这意味着刚体旋转会虚假地产生剪应力。\n\n**选项 C 的结论**：不正确。该方案在物理上不一致，并且未能消除刚体旋转模式。\n\n**选项 D 的分析**\n\n该选项提出了一个不同的交错网格，其中剪应力 $\\sigma_{xz}$ 位于网格中心 $(i,j)$，而其他变量的放置与选项 A 相同。\n-   **网格交错**：$v_x$ 在 $(i+\\tfrac{1}{2},j)$，$v_z$ 在 $(i,j+\\tfrac{1}{2})$，$\\sigma_{xx}, \\sigma_{zz}$ 在 $(i,j)$，$\\sigma_{xz}$ 在 $(i,j)$。\n-   **内部一致性**：$\\sigma_{xz}$ 的更新公式为：\n    $\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)=\\dots+\\mu\\,\\Delta t\\left[\\frac{v_x^n(i,j+\\tfrac{1}{2})-v_x^n(i,j-\\tfrac{1}{2})}{\\Delta z}+\\frac{v_z^n(i+\\tfrac{1}{2},j)-v_z^n(i-\\tfrac{1}{2},j)}{\\Delta x}\\right]$。\n    该公式需要像 $(i, j+\\tfrac{1}{2})$ 这样的位置上的 $v_x$，但 $v_x$ 是定义在网格上的 $(i+\\tfrac{1}{2},j)$ 位置。类似地，它需要 $(i+\\tfrac{1}{2},j)$ 位置上的 $v_z$，但 $v_z$ 是定义在 $(i,j+\\tfrac{1}{2})$ 位置。该公式是不明确的，因为它查询了变量未存储位置上的值，而没有指定插值规则。\n-   **导数居中**：让我们检查速度更新。在 $(i+\\tfrac{1}{2},j)$ 处的 $v_x$ 更新涉及项 $\\frac{\\partial \\sigma_{xz}}{\\partial z}$。离散公式为 $\\frac{\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j)-\\sigma_{xz}^{n+\\tfrac{1}{2}}(i,j-1)}{\\Delta z}$。这个有限差分居中于位置 $(i, j-\\tfrac{1}{2})$。这不是 $v_x$ 的位置 $(i+\\tfrac{1}{2},j)$。离散导数和被更新变量的这种空间错位会导致精度降低，并可能引入数值伪影。一个设计良好的方案，如选项 A，其所有导数都精确地居中在需要它们的位置。\n\n**选项 D 的结论**：不正确。该方案如其所呈现的那样是不明确的。即使通过某种隐式插值来解释，它也存在导数计算错位的问题，这是一个已知的数值缺陷（“不匹配的离散化”）。\n\n### 结论\n\n选项 A 是唯一一个定义明确、正确逼近控制方程，并满足两个关键不变性属性的方案：保持应力对称性和消除刚体旋转模式。这些属性是其特定交错网格结构的直接结果，该结构确保了离散算子具有正确的伴随关系，模拟了连续微分算子的属性。其他选项都包含了替代离散化方案的典型缺陷。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "确定了稳定的网格方案后，我们必须选择一个时间步长 $\\Delta t$ 以确保模拟既稳定又准确。这两个要求常常是相互矛盾的。本练习提供了一个动手实践的场景，你需要推导并应用来自 Courant–Friedrichs–Lewy (CFL) 稳定条件的约束和来自数值频散的精度约束，从而进行一次实际的权衡。",
            "id": "3593130",
            "problem": "考虑小振幅弹性纵波在一维均匀、各向同性固体中的传播。设质量密度为 $\\rho = 2700\\,\\mathrm{kg/m^3}$，第一拉梅参数为 $\\lambda = 20\\times 10^{9}\\,\\mathrm{Pa}$，剪切模量为 $\\mu = 30\\times 10^{9}\\,\\mathrm{Pa}$。您将使用时间上二阶精确的中心差分和空间上二阶精确的中心差分，在间距为 $\\Delta x = 2\\,\\mathrm{m}$ 的均匀网格上对位移场 $u(x,t)$ 进行建模。假设对于感兴趣的频率，空间色散由足够精细的空间分辨率控制，因此在最大模拟频率下，时间色散占主导地位。\n\n您的任务是选择一个时间步长 $\\Delta t$，使其同时满足：\n- 显式格式的 Courant–Friedrichs–Lewy (CFL) 稳定性条件，以及\n- 在最大频率 $f_{\\max} = 500\\,\\mathrm{Hz}$ 下，相对时间相速度误差不超过 $\\varepsilon = 0.005$ 的时间相误差约束。\n\n从第一性原理（线性动量平衡和线性各向同性弹性理论）出发，推导控制稳定性的波速，推导所选二阶有限差分格式的稳定性条件，并推导在角频率 $\\omega_{\\max} = 2\\pi f_{\\max}$ 下由时间色散要求所隐含的 $\\Delta t$ 的主阶界。然后，选择 $\\Delta t$ 为稳定性限制的时间步长和时间色散限制的时间步长中的较小者。将您的答案四舍五入到四位有效数字。以秒为单位表示时间步长。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第一步：提取已知条件\n-   波类型：一维、小振幅弹性纵波。\n-   介质：均匀、各向同性固体。\n-   质量密度：$\\rho = 2700\\,\\mathrm{kg/m^3}$。\n-   第一拉梅参数：$\\lambda = 20\\times 10^{9}\\,\\mathrm{Pa}$。\n-   剪切模量（第二拉梅参数）：$\\mu = 30\\times 10^{9}\\,\\mathrm{Pa}$。\n-   位移场：$u(x,t)$。\n-   数值格式：时间上二阶精确中心差分和空间上二阶精确中心差分。\n-   网格间距：$\\Delta x = 2\\,\\mathrm{m}$。\n-   假设：在最大模拟频率下，时间色散占主导地位。\n-   最大模拟频率：$f_{\\max} = 500\\,\\mathrm{Hz}$。\n-   时间相误差约束：相对时间相速度误差不超过 $\\varepsilon = 0.005$。\n-   任务：选择一个满足稳定性和色散约束的时间步长 $\\Delta t$。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于线性弹性动力学和有限差分法的基本原理，这些是计算地球物理学和地震学中的标准课题。所有物理参数和概念都是公认的。\n-   **适定的**：该问题提供了一套完整的参数（$\\rho, \\lambda, \\mu, \\Delta x, f_{\\max}, \\varepsilon$）和明确的约束（稳定性和色散），以确定时间步长 $\\Delta t$ 的唯一值。\n-   **客观的**：该问题使用精确、量化且无偏见的技术语言陈述。\n\n### 第三步：结论与行动\n该问题在科学上是合理的、适定的和客观的。它被判定为**有效**。现在将进行求解过程。\n\n### 控制方程和波速的推导\n\n一维线性动量平衡方程为\n$$\n\\frac{\\partial \\sigma_{xx}}{\\partial x} = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\n其中 $\\sigma_{xx}$ 是纵向应力，$u$ 是纵向位移，$\\rho$ 是质量密度。\n\n对于线性各向同性弹性固体，一维的应力-应变关系（胡克定律）是\n$$\n\\sigma_{xx} = (\\lambda + 2\\mu) \\varepsilon_{xx}\n$$\n其中 $\\varepsilon_{xx}$ 是纵向应变，$\\lambda$ 和 $\\mu$ 是拉梅参数。应变与位移的关系为\n$$\n\\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}\n$$\n将应变-位移和应力-应变关系代入动量方程，我们得到\n$$\n\\frac{\\partial}{\\partial x} \\left( (\\lambda + 2\\mu) \\frac{\\partial u}{\\partial x} \\right) = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\n对于均匀介质，$\\lambda$、$\\mu$ 和 $\\rho$ 是常数。该方程简化为一维弹性波方程：\n$$\n(\\lambda + 2\\mu) \\frac{\\partial^2 u}{\\partial x^2} = \\rho \\frac{\\partial^2 u}{\\partial t^2}\n$$\n这可以写成标准形式 $\\frac{\\partial^2 u}{\\partial t^2} = c_p^2 \\frac{\\partial^2 u}{\\partial x^2}$，其中 $c_p$ 是压缩波（P波）速度，由下式给出\n$$\nc_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}\n$$\n使用给定值：\n-   $\\lambda = 20 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\mu = 30 \\times 10^9\\,\\mathrm{Pa}$\n-   $\\rho = 2700\\,\\mathrm{kg/m^3}$\n\nP波模量为 $M = \\lambda + 2\\mu = (20 \\times 10^9) + 2(30 \\times 10^9) = 80 \\times 10^9\\,\\mathrm{Pa}$。\nP波速度为：\n$$\nc_p = \\sqrt{\\frac{80 \\times 10^9\\,\\mathrm{Pa}}{2700\\,\\mathrm{kg/m^3}}} = \\sqrt{\\frac{800}{27} \\times 10^6}\\,\\mathrm{m/s} \\approx 5443.3105\\,\\mathrm{m/s}\n$$\n\n### 稳定性条件 (CFL)\n\n该问题指定了在时间和空间上均为二阶精确的中心差分格式。波动方程离散化为：\n$$\n\\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{\\Delta t^2} = c_p^2 \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\n$$\n其中 $u_j^n = u(j\\Delta x, n\\Delta t)$。对于这个显式格式，Courant–Friedrichs–Lewy (CFL) 稳定性条件是：\n$$\nS = \\frac{c_p \\Delta t}{\\Delta x} \\le 1\n$$\n其中 $S$ 是库朗数。该条件为格式保持稳定对时间步长设定了上限。稳定性允许的最大时间步长是：\n$$\n\\Delta t_{\\text{stab}} = \\frac{\\Delta x}{c_p}\n$$\n使用给定的网格间距 $\\Delta x = 2\\,\\mathrm{m}$ 和计算出的波速：\n$$\n\\Delta t_{\\text{stab}} = \\frac{2\\,\\mathrm{m}}{5443.3105\\,\\mathrm{m/s}} \\approx 3.6724 \\times 10^{-4}\\,\\mathrm{s}\n$$\n\n### 时间色散约束\n\n问题陈述时间色散占主导地位。这使我们能够独立于空间离散化来分析时间离散化的影响。我们考虑时间上的半离散方程，其中空间导数被视为解析的。对于角频率为 $\\omega_{\\text{phy}}$ 的单个谐波分量，波动方程为 $\\frac{\\partial^2 u}{\\partial t^2} = -\\omega_{\\text{phy}}^2 u$。在时间上应用二阶中心差分算子得到：\n$$\n\\frac{u(t+\\Delta t) - 2u(t) + u(t-\\Delta t)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2 u(t)\n$$\n我们寻求形式为 $u(t) = \\exp(-i\\omega_{\\text{num}}t)$ 的数值解，其中 $\\omega_{\\text{num}}$ 是数值角频率。将其代入差分方程得到：\n$$\n\\frac{\\exp(-i\\omega_{\\text{num}}\\Delta t) - 2 + \\exp(i\\omega_{\\text{num}}\\Delta t)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n$$\n\\frac{2\\cos(\\omega_{\\text{num}}\\Delta t) - 2}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n使用恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$:\n$$\n\\frac{-4\\sin^2(\\omega_{\\text{num}}\\Delta t / 2)}{\\Delta t^2} = -\\omega_{\\text{phy}}^2\n$$\n$$\n\\frac{2\\sin(\\omega_{\\text{num}}\\Delta t / 2)}{\\Delta t} = \\omega_{\\text{phy}}\n$$\n这是半离散系统的色散关系。由此，我们求解数值频率 $\\omega_{\\text{num}}$：\n$$\n\\omega_{\\text{num}} = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right)\n$$\n数值相速度为 $c_{\\text{num}} = c_p \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{phy}}}$。相对相速度误差 $E_v$ 是：\n$$\nE_v = \\frac{c_{\\text{num}}}{c_p} - 1 = \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{phy}}} - 1 = \\frac{2}{\\omega_{\\text{phy}}\\Delta t} \\arcsin\\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right) - 1\n$$\n对于小宗量 $y$，$\\arcsin(y)$ 的泰勒展开是 $y + \\frac{y^3}{6} + O(y^5)$。设 $y = \\frac{\\omega_{\\text{phy}}\\Delta t}{2}$。对于小的时间步长，$y$ 很小，我们可以将误差近似到主阶：\n$$\nE_v \\approx \\frac{1}{y} \\left(y + \\frac{y^3}{6}\\right) - 1 = \\left(1 + \\frac{y^2}{6}\\right) - 1 = \\frac{y^2}{6}\n$$\n代回 $y$：\n$$\nE_v \\approx \\frac{1}{6} \\left(\\frac{\\omega_{\\text{phy}}\\Delta t}{2}\\right)^2 = \\frac{\\omega_{\\text{phy}}^2 \\Delta t^2}{24}\n$$\n问题要求在最大频率 $f_{\\max} = 500\\,\\mathrm{Hz}$ 时，此误差不超过 $\\varepsilon = 0.005$。该频率对应的最大角频率为 $\\omega_{\\max} = 2\\pi f_{\\max} = 2\\pi(500) = 1000\\pi\\,\\mathrm{rad/s}$。\n约束条件是：\n$$\n\\frac{\\omega_{\\max}^2 \\Delta t^2}{24} \\le \\varepsilon\n$$\n求解 $\\Delta t$ 得到色散限制的时间步长 $\\Delta t_{\\text{disp}}$：\n$$\n\\Delta t \\le \\frac{\\sqrt{24\\varepsilon}}{\\omega_{\\max}} \\implies \\Delta t_{\\text{disp}} = \\frac{\\sqrt{24\\varepsilon}}{\\omega_{\\max}}\n$$\n代入数值 $\\varepsilon = 0.005$ 和 $\\omega_{\\max} = 1000\\pi\\,\\mathrm{rad/s}$：\n$$\n\\Delta t_{\\text{disp}} = \\frac{\\sqrt{24 \\times 0.005}}{1000\\pi} = \\frac{\\sqrt{0.12}}{1000\\pi} \\approx \\frac{0.346410}{3141.5927} \\approx 1.10266 \\times 10^{-4}\\,\\mathrm{s}\n$$\n\n### 最终时间步长选择\n\n时间步长 $\\Delta t$ 必须同时满足稳定性和色散约束。因此，它必须是两个推导出的上界中的最小值：\n$$\n\\Delta t \\le \\min(\\Delta t_{\\text{stab}}, \\Delta t_{\\text{disp}})\n$$\n我们有：\n-   $\\Delta t_{\\text{stab}} \\approx 3.6724 \\times 10^{-4}\\,\\mathrm{s}$\n-   $\\Delta t_{\\text{disp}} \\approx 1.10266 \\times 10^{-4}\\,\\mathrms$\n\n更严格的约束是由时间色散要求施加的。因此，最大允许时间步长为 $\\Delta t = \\Delta t_{\\text{disp}}$。\n$$\n\\Delta t = 1.10266 \\times 10^{-4}\\,\\mathrm{s}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t = 1.103 \\times 10^{-4}\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{1.103 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "真实的地球介质是高度非均匀的，材料属性在界面两侧存在剧烈变化。在交错网格上，我们需要在原始定义点之间的位置定义密度和刚度等属性。本练习将探讨在界面处对这些属性采用不同的“平均”方案会如何显著影响模拟的稳定性和物理真实性，并引导你做出尊重底层波传播物理学的选择。",
            "id": "3593113",
            "problem": "考虑一维各向同性线性弹性问题，其中纵向运动在 $x$ 方向，由线性动量守恒和虎克定律控制：$\\rho(x)\\,\\partial_t v(x,t)=\\partial_x \\sigma(x,t)$ 和 $\\partial_t \\sigma(x,t)=M(x)\\,\\partial_x v(x,t)$，其中 $v$ 是质点速度，$\\sigma$ 是正应力，$\\rho$ 是密度，$M=\\lambda+2\\mu$ 是用拉梅参数 $\\lambda$ 和 $\\mu$ 表示的P波模量。连续总能量密度为 $e=\\tfrac{1}{2}\\rho v^2+\\tfrac{1}{2}\\sigma^2/M$，连续能量通量为 $S=\\sigma v$。假设采用交错网格有限差分格式，其中 $v$ 存储在半网格点 $x_{i+1/2}$，$\\sigma$ 存储在整网格点 $x_i$，网格间距 $\\Delta x$ 均匀，且一个平面材料界面位于 $x=x_0$ 处，与一个应力网格点 $x_{i_0}=x_0$ 对齐。材料属性 $\\rho$、$\\lambda$ 和 $\\mu$ 在 $x_0$ 处不连续，并具有强对比度（例如，量级为1的跳跃）。\n\n要求您分析不同平均格式对将 $\\rho$、$\\lambda$ 和 $\\mu$ 配置到离散更新所需的交错位置上的影响。具体来说，速度更新需要在 $x_{i+1/2}$ 处使用 $\\rho$，应力更新需要在 $x_i$ 处使用 $M$。当必须在界面上进行平均，以为跨越两种材料的交错位置提供属性时，有三种候选的平均方法：算术平均、调和平均和几何平均。仅使用第一性原理（线性动量守恒、虎克定律以及连续能量密度和通量的定义），推导交错格式的离散能量平衡，并确定哪种平均选择能确保跨越 $x_0$ 的离散能量通量连续性，并在强对比度下最小化界面附近的伪能量产生。在您的分析中，通过讨论每种选择是高估还是低估了界面附近的局部波速估计，将平均选择与 Courant–Friedrichs–Lewy (CFL) 条件联系起来。\n\n当以离散能量通量连续性为主要衡量标准时，哪种陈述最准确地描述了在强属性对比度附近能产生最佳稳定性和准确性的平均选择？\n\nA. 对所有交错点上的 $\\rho$ 和模量（$\\lambda$ 和 $\\mu$）都使用算术平均；这能保持能量通量连续性，并在强对比度附近产生最稳定的格式。\n\nB. 在速度点上对 $\\rho$ 使用算术平均，在应力点上对模量（即P波更新中的 $\\lambda$ 和 $\\mu$，等效于 $M=\\lambda+2\\mu$）使用调和平均；这种选择强制实现了跨界面的离散能量通量连续性，并提高了强对比度下的稳定性和准确性。\n\nC. 对所有三种属性 $\\rho$、$\\lambda$ 和 $\\mu$ 在其交错位置上都使用几何平均；这能最好地保持阻抗，从而保证能量通量连续性和稳定性。\n\nD. 对 $\\rho$ 使用调和平均，对 $\\lambda$ 和 $\\mu$ 使用算术平均；这能最优化地平衡质量和刚度，并在强对比度间给出最准确的通量。",
            "solution": "该问题陈述是计算地球物理学中一个有效且适定的问题。它要求在具有强对比度的界面上，为交错网格有限差分格式确定合适的材料属性平均方案。评判的标准是离散能量通量连续性和数值稳定性。\n\n首先，让我们建立连续材料界面（位于 $x=x_0$）处的物理原理。对于焊接接触，位移 $u(x,t)$ 和应力 $\\sigma(x,t)$ 都必须是连续的。位移的连续性意味着质点速度 $v = \\partial_t u$ 也是连续的。因此，我们有：\n1. $v(x_0^-, t) = v(x_0^+, t)$\n2. $\\sigma(x_0^-, t) = \\sigma(x_0^+, t)$\n\n这些条件对界面处的控制方程有直接影响。\n从第一个控制方程 $\\partial_t v = \\frac{1}{\\rho} \\partial_x \\sigma$ 来看，由于 $v$ 是连续的，$\\partial_t v$ 在界面两侧也是连续的。由于 $\\rho$ 是不连续的，这意味着 $\\partial_x \\sigma$ 必须有一个跳跃，以使 $\\frac{1}{\\rho} \\partial_x \\sigma$ 这一项保持连续。\n从第二个控制方程 $\\partial_t \\sigma = M \\partial_x v$ 来看，由于 $\\sigma$ 是连续的，$\\partial_t \\sigma$ 也是连续的。由于模量 $M$ 是不连续的，这意味着应变率 $\\partial_x v$ 必须有一个跳跃，以使 $M \\partial_x v$ 这一项保持连续。\n\n一个精确的有限差分格式应该在其离散形式中遵循这些连续性属性。这可以通过为在跨越界面的网格点上的材料属性 $\\rho$ 和 $M$ 选择合适的平均方案来实现。\n\n让我们来分析P波模量 $M = \\lambda+2\\mu$ 的平均方法。应力更新在整网格点 $x_i$ 上进行，需要 $M_i$ 的值。如果界面位于 $x_{i_0}$，则 $M_{i_0}$ 的值必须是一个代表两种材料（比如 $M_1$ 和 $M_2$）属性的有效模量。在 $x_{i_0}$ 处的应力更新方程是：\n$$ \\frac{\\sigma_{i_0}^{n+1} - \\sigma_{i_0}^n}{\\Delta t} = M_{i_0} \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0-1/2}^{n+1/2}}{\\Delta x} $$\n左边是 $\\partial_t \\sigma$ 在 $x_{i_0}$ 处的离散近似，它是连续的。右边是 $M \\partial_x v$ 的离散近似，它也是连续的。关键的物理洞察力在于考虑应变和应力在界面网格单元 $[x_{i_0-1/2}, x_{i_0+1/2}]$ 内的行为。由于应力 $\\sigma$ 是连续的，这类似于两个串联的弹簧。对于串联的材料，其柔度（刚度的倒数）是可加的。穿过该单元的总应变是每个部分应变之和。该单元的有效柔度是两种材料柔度的算术平均。柔度为 $1/M$。\n假设以 $x_{i_0}$ 为中心的网格单元由 $[x_{i_0-1/2}, x_{i_0}]$ 上的材料1和 $[x_{i_0}, x_{i_0+1/2}]$ 上的材料2组成。对于给定的应力 $\\sigma$，在单元 $\\Delta x$ 上的总应变增量为 $\\Delta\\epsilon = (\\sigma/M_1)(\\Delta x/2) + (\\sigma/M_2)(\\Delta x/2)$。有效模量 $M_{i_0}$ 由 $\\Delta\\epsilon = (\\sigma/M_{i_0})\\Delta x$ 定义。\n$$ \\frac{\\sigma}{M_{i_0}} \\Delta x = \\sigma \\left( \\frac{1}{M_1} \\frac{\\Delta x}{2} + \\frac{1}{M_2} \\frac{\\Delta x}{2} \\right) \\implies \\frac{1}{M_{i_0}} = \\frac{1}{2}\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) $$\n这是 $M_{i_0}$ 的调和平均的定义。如果应力点需要 $\\lambda$ 和 $\\mu$ 单独的值，同样的论证也适用。\n\n接下来，我们分析密度 $\\rho$ 的平均方法。速度更新在半整网格点 $x_{i+1/2}$ 上进行，需要 $\\rho_{i+1/2}$ 的值。如果界面位于 $x_{i_0+1/2}$，则 $\\rho_{i_0+1/2}$ 的值必须是一个有效密度。速度更新方程是：\n$$ \\rho_{i_0+1/2} \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} = \\frac{\\sigma_{i_0+1}^n - \\sigma_{i_0}^n}{\\Delta x} $$\n左边是单位体积质量与加速度（离散近似）的乘积，右边是单位体积的力。这个方程是控制体积 $[x_{i_0}, x_{i_0+1}]$ 的牛顿第二定律的离散形式。该体积内的总质量为 $\\text{mass} = \\rho_1 (\\Delta x/2) + \\rho_2 (\\Delta x/2)$。净力为 $\\sigma_{i_0+1}^n - \\sigma_{i_0}^n$。应用牛顿第二定律（质量 × 加速度 = 力）：\n$$ (\\rho_1 \\frac{\\Delta x}{2} + \\rho_2 \\frac{\\Delta x}{2}) \\left( \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} \\right) = \\sigma_{i_0+1}^n - \\sigma_{i_0}^n $$\n将其重新整理以匹配有限差分形式，我们得到：\n$$ \\frac{\\rho_1 + \\rho_2}{2} \\left( \\frac{v_{i_0+1/2}^{n+1/2} - v_{i_0+1/2}^{n-1/2}}{\\Delta t} \\right) = \\frac{\\sigma_{i_0+1}^n - \\sigma_{i_0}^n}{\\Delta x} $$\n这表明有效密度 $\\rho_{i_0+1/2}$ 必须是 $\\rho_1$ 和 $\\rho_2$ 的算术平均。\n\n这些平均选择确保了离散格式能正确地遵循界面处的物理连续性条件。这反过来又最小化了伪数值能量的产生，并确保了能量通量连续性的离散形式。因此，强对比度附近的格式稳定性得到改善，不是通过直接操纵CFL条件，而是通过构建一个物理上更准确、振荡更少的格式。如果对模量 $M$ 使用算术平均，局部波速 $c = \\sqrt{M/\\rho}$ 可能会被高估（因为算术平均总是大于或等于调和平均），可能导致一个限制较少但物理上不正确的局部条件。对模量使用调和平均和对密度使用算术平均的组合提供了最高的稳定性和准确性。\n\n我们现在根据此推导评估给定的选项。\n\nA. 对所有交错点上的 $\\rho$ 和模量（$\\lambda$ 和 $\\mu$）都使用算术平均；这能保持能量通量连续性，并在强对比度附近产生最稳定的格式。\n这是不正确的。虽然对 $\\rho$ 使用算术平均是正确的，但对弹性模量 $M$、$\\lambda$ 和 $\\mu$ 来说是不正确的。对模量使用算术平均对应于假设应变连续，这在应力连续而模量不连续的界面上是物理上错误的。这种选择违反了物理原理，不能确保离散能量通量的连续性。\n\nB. 在速度点上对 $\\rho$ 使用算术平均，在应力点上对模量（即P波更新中的 $\\lambda$ 和 $\\mu$，等效于 $M=\\lambda+2\\mu$）使用调和平均；这种选择强制实现了跨界面的离散能量通量连续性，并提高了强对比度下的稳定性和准确性。\n这是正确的。我们从第一性原理（应力连续性和控制体积的牛顿第二定律）的推导表明，对模量（$M$，并延伸到 $\\lambda$ 和 $\\mu$）使用调和平均是合适的，而对密度（$\\rho$）使用算术平均是合适的。这种组合遵循了物理连续性条件，这是确保能量通量连续性的离散等价形式，并且已知在强对比度界面上为交错网格格式提供最稳定和最准确的结果。\n\nC. 对所有三种属性 $\\rho$、$\\lambda$ 和 $\\mu$ 在其交错位置上都使用几何平均；这能最好地保持阻抗，从而保证能量通量连续性和稳定性。\n这是不正确的。在这种情况下，无论是对密度还是模量，从第一性原理的推导都不支持使用几何平均。虽然阻抗是反射/透射的一个重要概念，但将其守恒作为对构成参数进行平均的规则，在偏微分方程算子的离散化本身上是没有物理依据的。\n\nD. 对 $\\rho$ 使用调和平均，对 $\\lambda$ 和 $\\mu$ 使用算术平均；这能最优化地平衡质量和刚度，并在强对比度间给出最准确的通量。\n这是不正确的。该陈述提出的方案与从物理原理推导出的正确方案正好相反。对 $\\rho$ 使用调和平均是不正确的，对模量使用算术平均也是不正确的。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}