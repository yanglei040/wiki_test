{
    "hands_on_practices": [
        {
            "introduction": "等效源方法的核心思想是将一个连续的源分布离散为一组具有简单几何形状的基本单元。在位场模拟中，均匀密度的矩形面元是最常用和最基本的构建模块之一。本练习将引导你从第一性原理出发，推导单个矩形面元在任意观测点产生的引力位和垂向引力场分量的闭合解析表达式，这是构建任何基于网格的等效源正演模拟算法的基石。",
            "id": "3589271",
            "problem": "考虑一种等效源法，该方法将平面上的质量分布表示为由密度均匀的矩形面元组成的网格剖分。设单个矩形面元位于平面 $z=0$ 上，具有均匀的面密度 $\\sigma$（单位面积的质量），其边界为 $x \\in [x_1, x_2]$ 和 $y \\in [y_1, y_2]$。设观测点为 $\\mathbf{r}_0 = (x_0, y_0, z_0)$，其中 $z_0 > 0$（垂直坐标向上为正）。根据牛顿引力理论，引力常数为 $G$，该面元产生的引力势 $U(\\mathbf{r}_0)$ 定义为\n$$\nU(\\mathbf{r}_0) = G \\sigma \\iint_{\\text{patch}} \\frac{1}{\\|\\mathbf{r}_0 - \\mathbf{r}\\|} \\, \\mathrm{d}A,\n$$\n引力加速度为 $\\mathbf{g}(\\mathbf{r}_0) = \\nabla U(\\mathbf{r}_0)$，其垂直分量为 $g_z(\\mathbf{r}_0) = \\frac{\\partial U}{\\partial z_0}(\\mathbf{r}_0)$。\n\n从这些定义和位势理论的第一性原理出发，推导 $U(\\mathbf{r}_0)$ 和 $g_z(\\mathbf{r}_0)$ 的闭式解析表达式，表达式应以 $x_1$、$x_2$、$y_1$、$y_2$、$x_0$、$y_0$、$z_0$、$\\sigma$ 和 $G$ 表示。您的推导必须对 $z_0>0$ 的任意观测点都有效。使用基于角点的容斥原理，将最终结果表示为四个依赖于到观测点相对偏移的带符号贡献项之和。无需进行数值计算。请以解析表达式的形式提供最终答案。最终方框内的表达式不应包含单位。",
            "solution": "该问题要求推导由一个密度均匀的矩形面元产生的引力势 $U(\\mathbf{r}_0)$ 和引力加速度的垂直分量 $g_z(\\mathbf{r}_0)$ 的闭式表达式。推导必须从第一性原理开始，并使用基于角点的容斥原理形式来表示。\n\n设观测点为 $\\mathbf{r}_0 = (x_0, y_0, z_0)$，其中 $z_0 > 0$。矩形面元位于 $z=0$ 平面，边界为 $x \\in [x_1, x_2]$ 和 $y \\in [y_1, y_2]$，具有均匀的面密度 $\\sigma$。面元上的一个点是 $\\mathbf{r} = (x, y, 0)$。\n\n为简化起见，我们引入相对坐标：$\\xi = x - x_0$ 和 $\\eta = y - y_0$。积分在平移后的矩形 $[\\xi_1, \\xi_2] \\times [\\eta_1, \\eta_2]$ 上进行，其中 $\\xi_i = x_i - x_0$，$\\eta_j = y_j - y_0$。\n\n引力势 $U(\\mathbf{r}_0)$ 由以下积分给出：\n$$ U(\\mathbf{r}_0) = G \\sigma \\int_{\\eta_1}^{\\eta_2} \\int_{\\xi_1}^{\\xi_2} \\frac{1}{\\sqrt{\\xi^2 + \\eta^2 + z_0^2}} \\, d\\xi \\, d\\eta $$\n\n引力加速度的垂直分量 $g_z(\\mathbf{r}_0)$ 是引力势对 $z_0$ 的偏导数：\n$$ g_z(\\mathbf{r}_0) = \\frac{\\partial U}{\\partial z_0} = -G \\sigma z_0 \\int_{\\eta_1}^{\\eta_2} \\int_{\\xi_1}^{\\xi_2} (\\xi^2 + \\eta^2 + z_0^2)^{-3/2} \\, d\\xi \\, d\\eta $$\n\n**推导过程**\n\n该问题的标准解法是先找到被积函数的不定二重积分，然后应用容斥原理在矩形区域上求定积分。设 $r = \\sqrt{\\xi^2 + \\eta^2 + z_0^2}$。\n对于引力势 $U$，被积函数 $1/r$ 的不定二重积分核函数为：\n$$ \\Phi_U(\\xi, \\eta, z_0) = \\xi \\ln(\\eta + r) + \\eta \\ln(\\xi + r) - z_0 \\arctan\\left(\\frac{\\xi\\eta}{z_0 r}\\right) $$\n该核函数满足 $\\frac{\\partial^2 \\Phi_U}{\\partial\\xi \\partial\\eta} = \\frac{1}{r}$。\n\n对于垂直引力 $g_z$，被积函数 $-z_0/r^3$ 的不定二重积分核函数为：\n$$ \\Psi_{g_z}(\\xi, \\eta, z_0) = -\\arctan\\left(\\frac{\\xi\\eta}{z_0 r}\\right) $$\n该核函数满足 $\\frac{\\partial^2 \\Psi_{g_z}}{\\partial\\xi \\partial\\eta} = -\\frac{z_0}{r^3}$。\n\n**最终表达式**\n\n通过对矩形 $[\\xi_1, \\xi_2] \\times [\\eta_1, \\eta_2]$ 的四个角点应用容斥原理，可以得到最终的闭式表达式。\n设 $\\xi_i = x_i - x_0$ 且 $\\eta_j = y_j - y_0$，对于 $i,j \\in \\{1,2\\}$。设 $r_{ij} = \\sqrt{\\xi_i^2 + \\eta_j^2 + z_0^2}$。\n\n引力势 $U(\\mathbf{r}_0)$ 为：\n$$ U(\\mathbf{r}_0) = G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\Phi_U(\\xi_i, \\eta_j, z_0) $$\n代入 $\\Phi_U$ 的表达式：\n$$ U(\\mathbf{r}_0) = G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\left[ \\xi_i \\ln(\\eta_j+r_{ij}) + \\eta_j \\ln(\\xi_i+r_{ij}) - z_0 \\arctan\\left(\\frac{\\xi_i\\eta_j}{z_0 r_{ij}}\\right) \\right] $$\n垂直引力加速度 $g_z(\\mathbf{r}_0)$ 为：\n$$ g_z(\\mathbf{r}_0) = G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\Psi_{g_z}(\\xi_i, \\eta_j, z_0) $$\n代入 $\\Psi_{g_z}$ 的表达式：\n$$ g_z(\\mathbf{r}_0) = -G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\arctan\\left(\\frac{\\xi_i\\eta_j}{z_0 r_{ij}}\\right) $$\n\n这就完成了从第一性原理出发的推导。",
            "answer": "$$ \\boxed{ \\begin{aligned} U(\\mathbf{r}_0) = G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\left[ (x_i-x_0) \\ln(y_j-y_0+r_{ij}) + (y_j-y_0) \\ln(x_i-x_0+r_{ij}) - z_0 \\arctan\\left(\\frac{(x_i-x_0)(y_j-y_0)}{z_0 r_{ij}}\\right) \\right] \\\\ g_z(\\mathbf{r}_0) = -G \\sigma \\sum_{i=1}^2 \\sum_{j=1}^2 (-1)^{i+j} \\arctan\\left(\\frac{(x_i-x_0)(y_j-y_0)}{z_0 r_{ij}}\\right) \\end{aligned} } $$"
        },
        {
            "introduction": "直接使用正演模型进行反演，往往会得到不切实际的结果，即等效源会不自然地聚集在靠近观测面的浅部。这种现象的根源在于位场核函数（即格林函数）的灵敏度会随深度增加而迅速衰减。本练习旨在解决这一关键的反演难题，通过分析格林函数的渐近行为，你将推导出一个深度加权函数，以补偿深部源信号的衰减，从而确保反演结果的物理实在性。",
            "id": "3589251",
            "problem": "考虑在均匀半空间上方 $z=0$ 的水平观测平面上测量的三维（$3$D）位场。一个等效层被用来表示该场，它由位于深度 $z=z_{0}0$ 的平面上、面密度为 $\\sigma(x',y')$ 的标量单极子分布构成。设 $U(x,y,z)$ 表示该层在 $(x,y,z)$ 处产生的标量势，并设测量数据为在观测平面上求值的位的 $n$ 阶垂向导数，即 $d_{n}(x,y)=\\partial^{n}U(x,y,0)/\\partial z^{n}$，其中 $n$ 为正整数。\n\n你将使用三维拉普拉斯方程的基本格林函数 $G(\\mathbf{r})=1/(4\\pi|\\mathbf{r}|)$ 来模拟正演响应，并可以假定源足够局域化，以至于对于大的 $z_{0}$，轴上行为（即接收器位于源元素正上方，即 $(x,y)=(x',y')$）控制着灵敏度的主阶深度依赖性。对于位于 $(x',y',z_{0})$ 的单位源， $d_{n}$ 的等效层灵敏度核为 $K_{n}(x-x',y-y';z_{0})=\\partial^{n}G(\\mathbf{r})/\\partial z^{n}$，其中 $\\mathbf{r}=(x-x',y-y',0-z_{0})$。\n\n从第一性原理和 $G(\\mathbf{r})$ 在 $z_{0}$ 很大时的渐近行为出发，推导一个显式的深度加权函数 $w(z_{0})$，该函数可以抵消灵敏度随深度的衰减，即当 $z_{0}\\to\\infty$ 时，$w(z_{0})\\,K_{n}(0,0;z_{0})$ 在主阶上与 $z_{0}$ 无关。通过施加 $w(1)=1$ 的条件对你的答案进行归一化，以使权重是无量纲的。以闭合形式给出 $w(z_{0})$ 的最终表达式。不需要进行数值计算，你的答案必须是单个解析表达式。",
            "solution": "该问题要求推导用于位场等效层表示的深度加权函数 $w(z_{0})$，该函数需抵消轴上灵敏度核随深度 $z_{0}$ 的衰减。\n\n首先，我们确定关键组成部分。位场使用三维拉普拉斯方程的格林函数 $G(\\mathbf{r}) = \\frac{1}{4\\pi|\\mathbf{r}|}$ 进行建模。源层位于恒定深度 $z = z_{0} > 0$ 处，观测平面位于 $z=0$ 处。向量 $\\mathbf{r}$ 连接源点 $(x', y', z_{0})$ 和观测点 $(x, y, z)$，因此 $\\mathbf{r} = (x-x', y-y', z-z_{0})$。\n\n灵敏度核 $K_{n}$ 被定义为格林函数关于垂向观测坐标 $z$ 的 $n$ 阶偏导数，并在观测平面 $z=0$ 处求值：\n$$\nK_{n}(x-x', y-y'; z_{0}) = \\left. \\frac{\\partial^{n}}{\\partial z^{n}} G(x-x', y-y', z-z_{0}) \\right|_{z=0}\n$$\n问题指明，主阶深度依赖性由轴上行为控制，即 $(x,y) = (x',y')$。对于轴上情况，$x-x'=0$ 且 $y-y'=0$。位置向量的模简化为 $|\\mathbf{r}| = \\sqrt{0^{2} + 0^{2} + (z-z_{0})^{2}} = |z-z_{0}|$。由于观测平面位于 $z=0$ 且源平面位于 $z_{0}>0$，我们关心 $z  z_{0}$ 的区域，因此 $|z-z_{0}| = z_{0}-z$。\n\n轴上格林函数为：\n$$\nG_{\\text{on-axis}}(z; z_{0}) = \\frac{1}{4\\pi(z_{0}-z)} = \\frac{1}{4\\pi}(z_{0}-z)^{-1}\n$$\n现在，我们计算该函数关于 $z$ 的 $n$ 阶偏导数。通过归纳法可以得到通用公式：\n$$\n\\frac{\\partial}{\\partial z} (z_{0}-z)^{-k} = k(z_{0}-z)^{-(k+1)}\n$$\n因此，\n$$\n\\frac{\\partial^{n}}{\\partial z^{n}} \\left( \\frac{1}{4\\pi}(z_{0}-z)^{-1} \\right) = \\frac{n!}{4\\pi}(z_{0}-z)^{-(n+1)}\n$$\n为了获得轴上灵敏度核 $K_{n}(0,0;z_{0})$，我们在观测平面 $z=0$ 处对该表达式求值：\n$$\nK_{n}(0,0;z_{0}) = \\left. \\frac{n!}{4\\pi}(z_{0}-z)^{-(n+1)} \\right|_{z=0} = \\frac{n!}{4\\pi}z_{0}^{-(n+1)}\n$$\n该表达式描述了灵敏度随源深度 $z_{0}$ 按 $z_{0}^{-(n+1)}$ 的规律衰减。\n\n问题要求找到一个深度加权函数 $w(z_{0})$，使得乘积 $w(z_{0})K_{n}(0,0;z_{0})$ 与 $z_{0}$ 无关。这意味着该乘积必须是一个常数。\n$$\nw(z_{0}) \\left( \\frac{n!}{4\\pi}z_{0}^{-(n+1)} \\right) = C\n$$\n为了使左侧与 $z_{0}$ 无关，$w(z_{0})$ 的结构必须能够抵消 $z_{0}^{-(n+1)}$ 项。因此，$w(z_{0})$ 必须与此项的倒数成正比：\n$$\nw(z_{0}) \\propto \\frac{1}{z_{0}^{-(n+1)}} = z_{0}^{n+1}\n$$\n我们可以用一个比例常数 $A$ 来表示这种关系：\n$$\nw(z_{0}) = A \\, z_{0}^{n+1}\n$$\n问题提供了一个归一化条件来确定常数 $A$：$w(1)=1$。我们应用这个条件：\n$$\nw(1) = A \\cdot (1)^{n+1} = A \\implies A=1\n$$\n因此，归一化的深度加权函数的显式闭合表达式为：\n$$\nw(z_{0}) = z_{0}^{n+1}\n$$\n该函数与轴上灵敏度核 $K_{n}(0,0;z_{0})$ 相乘，得到结果 $\\frac{n!}{4\\pi}$，这个结果确实与深度 $z_{0}$ 无关。",
            "answer": "$$\\boxed{z_{0}^{n+1}}$$"
        },
        {
            "introduction": "在解决了深度加权问题之后，等效源反演仍然是一个不适定的问题，通常需要使用吉洪诺夫（Tikhonov）正则化等方法来获得稳定解。正则化引入了一个关键的超参数 $\\lambda$，它控制着数据拟合与解的平滑度之间的权衡。本练习将深入探讨如何基于莫罗佐夫（Morozov）的偏差原理（Discrepancy Principle）来科学地选择 $\\lambda$，该原理将正则化参数的选择与已知的观测数据噪声水平直接联系起来。通过推导用于求解 $\\lambda$ 的牛顿法更新公式，你将掌握如何量化地平衡数据拟合与模型复杂度，从而获得可靠且有意义的反演结果。",
            "id": "3589321",
            "problem": "考虑一个二维标量势场，其在位于 $z=z_{0}$ 高度的 $n$ 个观测点上进行测量。这些观测点位于一个包含 $p$ 个等效点源的水平面上方，等效点源位于 $z=0$。设观测数据向量为 $\\mathbf{d} \\in \\mathbb{R}^{n}$，等效源强度向量为 $\\mathbf{m} \\in \\mathbb{R}^{p}$。将源强度映射到观测值的正演算子是线性矩阵 $\\mathbf{G} \\in \\mathbb{R}^{n \\times p}$。假设数据噪声为零均值高斯噪声，其协方差为 $\\mathbf{C}_{\\epsilon} = \\sigma^{2} \\mathbf{I}_{n}$，其中 $\\sigma^{2}$ 已知，$\\mathbf{I}_{n}$ 是 $n \\times n$ 单位矩阵。\n\n为了从 $\\mathbf{d}$ 估计 $\\mathbf{m}$，考虑使用带有零阶稳定器的 Tikhonov 正则化，求解\n$$\n\\min_{\\mathbf{m}} \\left\\| \\mathbf{W}_{d} \\left( \\mathbf{G} \\mathbf{m} - \\mathbf{d} \\right) \\right\\|_{2}^{2} + \\lambda^{2} \\left\\| \\mathbf{m} \\right\\|_{2}^{2},\n$$\n其中 $\\mathbf{W}_{d} = \\sigma^{-1} \\mathbf{I}_{n}$ 对数据进行白化，$\\lambda > 0$ 是正则化参数。定义白化后的量 $\\tilde{\\mathbf{G}} = \\mathbf{W}_{d} \\mathbf{G}$ 和 $\\tilde{\\mathbf{d}} = \\mathbf{W}_{d} \\mathbf{d}$。设 $\\tilde{\\mathbf{G}}$ 的奇异值分解 (SVD) 为 $\\tilde{\\mathbf{G}} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top}$，其中 $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$ 和 $\\mathbf{V} \\in \\mathbb{R}^{p \\times p}$ 是正交矩阵，$\\boldsymbol{\\Sigma} \\in \\mathbb{R}^{n \\times p}$ 的对角线上有非零奇异值 $\\sigma_{i} > 0$（对于 $i=1,\\dots,p$）。记 $a_{i} = \\mathbf{u}_{i}^{\\top} \\tilde{\\mathbf{d}}$，其中 $\\mathbf{u}_{i}$ 是 $\\mathbf{U}$ 的第 $i$ 列。\n\n偏差原理（也称为 Morozov 原理）规定选择 $\\lambda$ 使得白化残差范数满足\n$$\n\\left\\| \\tilde{\\mathbf{r}}(\\lambda) \\right\\|_{2}^{2} = n,\n$$\n其中 $\\tilde{\\mathbf{r}}(\\lambda) = \\tilde{\\mathbf{d}} - \\tilde{\\mathbf{G}} \\mathbf{m}(\\lambda)$ 是白化残差，$\\mathbf{m}(\\lambda)$ 是正则化解。从上述定义和 Tikhonov 正则化的结构出发，推导偏差函数\n$$\n\\Phi(\\lambda) = \\left\\| \\tilde{\\mathbf{r}}(\\lambda) \\right\\|_{2}^{2}\n$$\n关于 $\\{ \\sigma_{i} \\}_{i=1}^{p}$ 和 $\\{ a_{i} \\}_{i=1}^{n}$ 的显式表达式，以及其导数 $\\Phi'(\\lambda)$。然后，推导求解 $\\Phi(\\lambda) = n$ 的单步牛顿更新公式。\n\n在你的推导中，从正演算子的线性、奇异值分解的性质以及 Tikhonov 正则化的定义开始。清晰地论证构建 $\\Phi(\\lambda)$ 和 $\\Phi'(\\lambda)$ 的每一步，以及它们如何导出 $\\lambda$ 的牛顿更新公式。\n\n最后，简要分析通过偏差原理选择 $\\lambda$ 的方法，在原理上与通过广义交叉验证 (GCV; Generalized Cross-Validation) 和 L 曲线法选择 $\\lambda$ 的方法有何不同，并关注已知噪声方差和拟合的有效自由度的作用。\n\n提供牛顿更新 $\\lambda_{k+1}$ 关于 $\\lambda_{k}$、$\\{ \\sigma_{i} \\}$ 和 $\\{ a_{i} \\}$ 的单个闭式解析表达式作为最终答案，该表达式适用于在偏差原理下对 $\\lambda$ 进行迭代计算。不需要进行数值评估。你的最终答案必须是单个表达式，且不得包含任何单位。",
            "solution": "本问题旨在推导用于选择 Tikhonov 正则化参数 $\\lambda$ 的牛顿法更新公式，其选择依据为莫罗佐夫偏差原理。我们将从正则化问题的解出发，利用奇异值分解 (SVD) 推导出偏差函数及其导数的显式表达式。\n\nTikhonov 正则化问题被表述为最小化目标函数 $J(\\mathbf{m})$：\n$$\nJ(\\mathbf{m}) = \\left\\| \\tilde{\\mathbf{G}} \\mathbf{m} - \\tilde{\\mathbf{d}} \\right\\|_{2}^{2} + \\lambda^{2} \\left\\| \\mathbf{m} \\right\\|_{2}^{2}\n$$\n其中 $\\tilde{\\mathbf{G}} = \\sigma^{-1}\\mathbf{G}$ 和 $\\tilde{\\mathbf{d}} = \\sigma^{-1}\\mathbf{d}$ 分别是白化算子和白化数据。对 $J(\\mathbf{m})$ 关于 $\\mathbf{m}$ 求梯度并将其设为零，可得正规方程组：\n$$\n(\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{G}} + \\lambda^2 \\mathbf{I}_{p}) \\mathbf{m}(\\lambda) = \\tilde{\\mathbf{G}}^{\\top} \\tilde{\\mathbf{d}}\n$$\n由此，正则化解 $\\mathbf{m}(\\lambda)$ 为 $\\mathbf{m}(\\lambda) = (\\tilde{\\mathbf{G}}^{\\top}\\tilde{\\mathbf{G}} + \\lambda^2 \\mathbf{I}_{p})^{-1} \\tilde{\\mathbf{G}}^{\\top} \\tilde{\\mathbf{d}}$。\n我们利用 SVD $\\tilde{\\mathbf{G}} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top}$ 来分析解的结构。解可以表示为：\n$$\n\\mathbf{m}(\\lambda) = \\sum_{i=1}^{p} \\frac{\\sigma_{i} a_{i}}{\\sigma_{i}^{2} + \\lambda^{2}} \\mathbf{v}_{i}\n$$\n接下来，我们推导偏差函数 $\\Phi(\\lambda) = \\left\\| \\tilde{\\mathbf{r}}(\\lambda) \\right\\|_{2}^{2} = \\|\\tilde{\\mathbf{d}} - \\tilde{\\mathbf{G}}\\mathbf{m}(\\lambda)\\|_2^2$。由于 L2 范数的平方在正交变换 $\\mathbf{U}^{\\top}$ 下是不变的，我们可以在 SVD 变换域中计算：\n$$\n\\Phi(\\lambda) = \\|\\mathbf{U}^{\\top}(\\tilde{\\mathbf{d}} - \\tilde{\\mathbf{G}}\\mathbf{m}(\\lambda))\\|_2^2 = \\|\\mathbf{U}^{\\top}\\tilde{\\mathbf{d}} - (\\mathbf{U}^{\\top}\\tilde{\\mathbf{G}})\\mathbf{m}(\\lambda)\\|_2^2\n$$\n变换后残差向量 $\\mathbf{U}^{\\top}\\tilde{\\mathbf{r}}(\\lambda)$ 的分量为：\n$$\n(\\mathbf{U}^{\\top}\\tilde{\\mathbf{r}}(\\lambda))_{i} = a_{i} - \\frac{\\sigma_{i}^{2} a_{i}}{\\sigma_{i}^{2} + \\lambda^{2}} = \\frac{\\lambda^{2} a_{i}}{\\sigma_{i}^{2} + \\lambda^{2}} \\quad \\text{对于 } i=1,\\dots,p\n$$\n$$\n(\\mathbf{U}^{\\top}\\tilde{\\mathbf{r}}(\\lambda))_{i} = a_{i} - 0 = a_{i} \\quad \\text{对于 } i=p+1,\\dots,n\n$$\n偏差函数 $\\Phi(\\lambda)$ 是这些分量的平方和：\n$$\n\\Phi(\\lambda) = \\sum_{i=1}^{p} \\left( \\frac{\\lambda^{2} a_{i}}{\\sigma_{i}^{2} + \\lambda^{2}} \\right)^{2} + \\sum_{i=p+1}^{n} a_{i}^{2}\n$$\n这是偏差函数的显式表达式。它对 $\\lambda$ 的导数 $\\Phi'(\\lambda)$ 为：\n$$\n\\Phi'(\\lambda) = \\frac{d}{d\\lambda} \\left( \\sum_{i=1}^{p} \\frac{\\lambda^{4} a_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda^{2})^{2}} \\right) = \\sum_{i=1}^{p} a_{i}^{2} \\left( \\frac{4\\lambda^{3}\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda^{2})^{3}} \\right) = 4\\lambda^{3} \\sum_{i=1}^{p} \\frac{a_{i}^{2}\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda^{2})^{3}}\n$$\n偏差原理要求解非线性方程 $\\Phi(\\lambda) - n = 0$。牛顿法的迭代更新公式为：\n$$\n\\lambda_{k+1} = \\lambda_{k} - \\frac{f(\\lambda_{k})}{f'(\\lambda_{k})} = \\lambda_{k} - \\frac{\\Phi(\\lambda_{k}) - n}{\\Phi'(\\lambda_{k})}\n$$\n代入 $\\Phi(\\lambda_k)$ 和 $\\Phi'(\\lambda_k)$ 的表达式，即可得到本问题所要求的单步牛顿更新公式。\n\n最后，简要对比偏差原理与广义交叉验证 (GCV) 和 L 曲线法。\n*   **偏差原理 (Discrepancy Principle):** 此方法具有统计学基础，它选择的 $\\lambda$ 使得白化残差范数 $\\|\\tilde{\\mathbf{r}}(\\lambda)\\|_2^2$ 等于其期望值 $n$。这个期望值基于白化噪声向量 $\\tilde{\\mathbf{\\epsilon}}$ 的单位协方差（即 $E[\\|\\tilde{\\mathbf{\\epsilon}}\\|_2^2] = n$）。此方法的关键前提是必须准确知道噪声方差 $\\sigma^2$。\n*   **广义交叉验证 (GCV):** 此方法不需要预先知道 $\\sigma^2$。它旨在最小化一个作为留一法交叉验证误差代理的函数，通过对模型的有效自由度进行惩罚来平衡数据拟合与模型复杂度。\n*   **L 曲线法 (L-curve Method):** 这是一种启发式图形技术，同样不需要知道 $\\sigma^2$。它在对数-对数坐标上绘制解的范数 $\\|\\mathbf{m}(\\lambda)\\|_2$ 与残差范数 $\\|\\mathbf{G}\\mathbf{m}(\\lambda)-\\mathbf{d}\\|_2$ 的关系曲线。曲线的“拐角”处被认为是数据拟合和解平滑度之间的最佳权衡点。\n\n综上，当噪声方差已知时，偏差原理是理论上最合理的选择。当噪声方差未知时，GCV 提供了一个统计上稳健的替代方案，而 L 曲线法则是一种广受欢迎的实用方法。",
            "answer": "$$\n\\boxed{\\lambda_{k+1} = \\lambda_{k} - \\frac{\\left( \\sum_{i=1}^{p} \\left( \\frac{\\lambda_{k}^{2} a_{i}}{\\sigma_{i}^{2} + \\lambda_{k}^{2}} \\right)^{2} + \\sum_{i=p+1}^{n} a_{i}^{2} \\right) - n}{4\\lambda_{k}^{3} \\sum_{i=1}^{p} \\frac{a_{i}^{2}\\sigma_{i}^{2}}{(\\sigma_{i}^{2} + \\lambda_{k}^{2})^{3}}}}\n$$"
        }
    ]
}