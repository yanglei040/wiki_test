{
    "hands_on_practices": [
        {
            "introduction": "理解波的传播始于两个关键概念：相速度（$v_p$）和群速度（$v_g$）。相速度描述了单个频率分量波峰的移动速度，而群速度则描述了整个波包或能量的传播速度。第一个练习  将通过一个普适的幂律频散关系，让您从第一性原理出发推导这两种速度，从而建立基本直觉。通过分析指数 $n$ 如何控制 $v_p$ 与 $v_g$ 之间的关系，您将更深刻地理解频散现象的根本性质。",
            "id": "3585604",
            "problem": "考虑一个一维、线性、非耗散、各向同性的弹性介质，其中小振幅平面波由波场 $u(x,t)=\\Re\\{A \\exp(i[k x - \\omega t])\\}$ 描述，其中 $A$ 是一个恒定的复振幅，$k$ 是波数，$\\omega$ 是角频率。假设该介质由形式为 $\\omega=\\beta k^{n}$ 的幂律频散关系表征，其中常数 $\\beta>0$ 且 $n>0$。一个以波数 $k$ 为中心的窄带波包根据此频散关系所蕴含的运动学规律进行传播。\n\n仅使用相速度和群速度的基本定义，其中相速度 $v_{p}$ 定义为角频率与波数之比，群速度 $v_{g}$ 定义为角频率对波数的导数，推导出 $v_{p}(k)$ 和 $v_{g}(k)$ 作为 $k$、$\\beta$ 和 $n$ 的函数的闭式表达式。然后，分析 $n=1$ 和 $n=2$ 的特殊情况，讨论介质是否具有频散性以及 $v_{p}$ 和 $v_{g}$ 的相对大小。\n\n将你的最终答案表示为一个包含三个条目 $\\bigl[v_{p}(k),\\,v_{g}(k),\\,v_{g}(k)/v_{p}(k)\\bigr]$ 的行矩阵。不需要进行数值计算，最终答案中也不应包含单位。不要四舍五入；请提供精确表达式。任何定性讨论都应包含在推导过程中，而不应出现在最终答案中。",
            "solution": "问题要求推导由幂律频散关系控制的波的相速度和群速度，并随后分析特定情况。该问题提法恰当，有科学依据，并为严谨求解提供了所有必要的定义和约束。\n\n给定的频散关系为 $\\omega(k) = \\beta k^{n}$，其中 $\\omega$ 是角频率，$k$ 是波数，$\\beta$ 和 $n$ 是正常数。波场由 $u(x,t)=\\Re\\{A \\exp(i[k x - \\omega t])\\}$ 给出。\n\n首先，我们推导相速度 $v_p$。提供的定义是角频率与波数之比：\n$$v_p(k) = \\frac{\\omega(k)}{k}$$\n将给定的频散关系代入此定义可得：\n$$v_p(k) = \\frac{\\beta k^{n}}{k}$$\n根据指数定律，可将其简化为：\n$$v_p(k) = \\beta k^{n-1}$$\n这就是相速度作为 $k$、$\\beta$ 和 $n$ 的函数的闭式表达式。\n\n接下来，我们推导群速度 $v_g$。提供的定义是角频率对波数的导数：\n$$v_g(k) = \\frac{d\\omega(k)}{dk}$$\n代入频散关系并使用幂法则进行微分，其中 $\\beta$ 和 $n$ 是常数：\n$$v_g(k) = \\frac{d}{dk} (\\beta k^{n})$$\n$$v_g(k) = \\beta \\frac{d}{dk} (k^{n})$$\n$$v_g(k) = \\beta (n k^{n-1})$$\n$$v_g(k) = n \\beta k^{n-1}$$\n这就是群速度的闭式表达式。\n\n从这两个结果中，我们可以观察到群速度和相速度之间的直接关系：\n$$v_g(k) = n (\\beta k^{n-1}) = n v_p(k)$$\n因此，群速度与相速度之比就是常数指数 $n$：\n$$\\frac{v_g(k)}{v_p(k)} = n$$\n\n现在，我们分析所要求的两种特殊情况。\n\n情况1：$n=1$\n在这种情况下，频散关系是线性的：$\\omega = \\beta k$。\n相速度为：\n$$v_p(k) = \\beta k^{1-1} = \\beta k^{0} = \\beta$$\n群速度为：\n$$v_g(k) = (1) \\beta k^{1-1} = \\beta k^{0} = \\beta$$\n此处，$v_p = v_g = \\beta$。相速度是一个常数，与波数 $k$ 无关。这是非频散介质的定义特征。在此类介质中，波包的所有频率分量都以相同的速度传播，因此波包在传播过程中其形状不会发生畸变。\n\n情况2：$n=2$\n在这种情况下，频散关系是二次的：$\\omega = \\beta k^2$。\n相速度为：\n$$v_p(k) = \\beta k^{2-1} = \\beta k$$\n群速度为：\n$$v_g(k) = (2) \\beta k^{2-1} = 2 \\beta k$$\n在这种情况下，$v_g = 2 v_p$。由于相速度 $v_p$ 是波数 $k$ 的函数（具体来说，$v_p(k) \\propto k$），因此该介质是频散的。不同的频率分量以不同的相速度传播，导致波包在传播时发生展宽或“弥散”。对于这种类型的频散，波数较高（波长较短）的分量具有较高的相速度。\n\n最终答案要求以行矩阵的形式给出 $v_p(k)$、$v_g(k)$ 及其比率的通用表达式。\n这三个条目是：\n1. $v_p(k) = \\beta k^{n-1}$\n2. $v_g(k) = n \\beta k^{n-1}$\n3. $\\frac{v_g(k)}{v_p(k)} = n$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\beta k^{n-1} & n \\beta k^{n-1} & n\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在真实的地质材料中，波速通常依赖于传播方向，这一特性被称为各向异性。一个至关重要的推论是，波包的能量传播方向（群速度方向）不一定与波前传播方向（相速度方向）相同。本练习  深入探讨了在弱各向异性VTI（垂直横向各向同性）介质中（一种地震学中常用的模型）的这一现象。通过使用Thomsen参数推导群速度角和相速度角之间的一阶差异，您将对各向异性如何影响地震能量的聚焦和射线路径建立起实践性的理解。",
            "id": "3585699",
            "problem": "在一个具有弱各向异性的垂直横向各向同性（VTI）弹性介质中，考虑由 Thomsen 参数 $\\epsilon$ 和 $\\delta$（其中 $|\\epsilon| \\ll 1$ 和 $|\\delta| \\ll 1$）表征的准压缩波（qP 波）。设相角 $\\theta$ 为波法线（等效于相慢度矢量）与对称轴（垂直方向）之间的夹角，群角 $\\theta_{g}$ 为能量（群速度）方向与对称轴之间的夹角。假设在 $\\epsilon$ 和 $\\delta$ 的一阶弱各向异性范围内，忽略 $\\gamma$，并对 qP 模式采用声学近似。\n\n从以下定义出发：(i) 群速度矢量是角频率相对于波数矢量的梯度；(ii) 在二维中，群速度方向垂直于相慢度曲线。仅使用 Thomsen 参数表示的 qP 波相速度的一阶弱各向异性特征，推导相角 $\\theta$、$\\epsilon$ 和 $\\delta$ 的函数——差值 $\\Delta(\\theta) \\equiv \\theta_{g} - \\theta$ 的显式一阶表达式。\n\n将最终答案表示为 $\\Delta(\\theta)$ 的单一闭合形式解析表达式，单位为弧度。不需要数值计算，也不需要四舍五入。清晰地陈述并证明您使用的任何一阶近似，并忽略所有高于 $\\epsilon$ 和 $\\delta$ 一阶的项。",
            "solution": "目标是推导在弱各向异性VTI介质中，准压缩波（qP波）的群角 $\\theta_g$ 和相角 $\\theta$ 之差的一阶表达式，记为 $\\Delta(\\theta) \\equiv \\theta_g - \\theta$。\n\n出发点是群速度方向与相慢度曲线之间的关系。群速度矢量 $\\vec{v}_g$ 定义为角频率 $\\omega$ 对波数矢量 $\\vec{k}$ 的梯度，即 $\\vec{v}_g = \\nabla_{\\vec{k}}\\omega(\\vec{k})$。可以证明，$\\vec{v}_g$ 垂直于慢度面，慢度面是由相慢度矢量 $\\vec{s}(\\vec{k}) = \\vec{k}/\\omega(\\vec{k})$ 定义的点的轨迹。\n\n在二维情况下，考虑一个包含对称轴的平面，我们可以在极坐标 $(s, \\theta)$ 中描述慢度曲线，其中 $s$ 是相慢度的大小，$s(\\theta) = 1/v_p(\\theta)$，$\\theta$ 是相对于对称轴的相角。慢度曲线上一点的笛卡尔分量为 $s_x = s(\\theta)\\sin\\theta$ 和 $s_z = s(\\theta)\\cos\\theta$。该曲线的切向矢量为 $\\vec{T} = (\\frac{ds_x}{d\\theta}, \\frac{ds_z}{d\\theta})$。由于群速度方向垂直于慢度曲线，群角 $\\theta_g$ 是曲线法向矢量的角度。从这个几何特性出发，一个标准的推导得出两角之间的关系：\n$$\n\\tan(\\theta_g - \\theta) = \\frac{1}{v_p(\\theta)} \\frac{d v_p(\\theta)}{d\\theta}\n$$\n这个关系是精确的。现在我们应用弱各向异性近似。\n\n问题指定使用VTI介质中qP波相速度的一阶弱各向异性近似，该近似由Thomsen公式给出：\n$$\nv_p(\\theta) \\approx v_{p0} \\left( 1 + \\delta \\sin^2\\theta \\cos^2\\theta + \\epsilon \\sin^4\\theta \\right)\n$$\n这里，$v_{p0}$ 是沿对称轴（$\\theta=0$）的P波速度，$\\epsilon$ 和 $\\delta$ 是Thomsen参数，假设它们很小（$|\\epsilon| \\ll 1$，$|\\delta| \\ll 1$）。\n\n第一步是计算 $v_p(\\theta)$ 关于 $\\theta$ 的导数：\n$$\n\\frac{d v_p}{d\\theta} = v_{p0} \\frac{d}{d\\theta} \\left( \\delta \\sin^2\\theta \\cos^2\\theta + \\epsilon \\sin^4\\theta \\right)\n$$\n我们使用链式法则和三角恒等式分别对各项求导。\n对于第一项：\n$$\n\\frac{d}{d\\theta} \\left( \\sin^2\\theta \\cos^2\\theta \\right) = \\frac{d}{d\\theta} \\left( (\\sin\\theta\\cos\\theta)^2 \\right) = \\frac{d}{d\\theta} \\left( \\left(\\frac{1}{2}\\sin(2\\theta)\\right)^2 \\right) = \\frac{1}{4} \\frac{d}{d\\theta} \\left( \\sin^2(2\\theta) \\right)\n$$\n$$\n= \\frac{1}{4} \\cdot 2\\sin(2\\theta) \\cdot \\cos(2\\theta) \\cdot 2 = \\sin(2\\theta)\\cos(2\\theta) = \\frac{1}{2}\\sin(4\\theta)\n$$\n对于第二项：\n$$\n\\frac{d}{d\\theta} \\left( \\sin^4\\theta \\right) = 4\\sin^3\\theta \\cos\\theta\n$$\n我们可以使用多倍角恒等式重写此式，以便与第一项合并：\n$$\n4\\sin^3\\theta\\cos\\theta = 4\\sin^2\\theta(\\sin\\theta\\cos\\theta) = 4\\left( \\frac{1-\\cos(2\\theta)}{2} \\right) \\left( \\frac{\\sin(2\\theta)}{2} \\right) = (1-\\cos(2\\theta))\\sin(2\\theta) = \\sin(2\\theta) - \\sin(2\\theta)\\cos(2\\theta)\n$$\n$$\n= \\sin(2\\theta) - \\frac{1}{2}\\sin(4\\theta)\n$$\n将这些导数代回到 $\\frac{dv_p}{d\\theta}$ 的表达式中：\n$$\n\\frac{dv_p}{d\\theta} = v_{p0} \\left[ \\delta \\left( \\frac{1}{2}\\sin(4\\theta) \\right) + \\epsilon \\left( \\sin(2\\theta) - \\frac{1}{2}\\sin(4\\theta) \\right) \\right]\n$$\n$$\n\\frac{dv_p}{d\\theta} = v_{p0} \\left[ \\epsilon \\sin(2\\theta) + \\frac{1}{2}(\\delta - \\epsilon)\\sin(4\\theta) \\right]\n$$\n$$\n\\frac{dv_p}{d\\theta} = v_{p0} \\left[ \\epsilon \\sin(2\\theta) - \\frac{1}{2}(\\epsilon - \\delta)\\sin(4\\theta) \\right]\n$$\n现在，我们构建比率 $\\frac{1}{v_p(\\theta)}\\frac{dv_p(\\theta)}{d\\theta}$。由于导数项 $\\frac{dv_p}{d\\theta}$ 已经是关于 $\\epsilon$ 和 $\\delta$ 的一阶项，我们可以用其零阶部分 $1/v_{p0}$ 来近似 $1/v_p(\\theta)$ 项，以保持整个表达式的一阶精度。$1/v_p(\\theta)$ 展开式中的任何高阶项与导数相乘都会产生各向异性参数的二阶或更高阶项，这些项应被忽略。\n$$\n\\frac{1}{v_p(\\theta)}\\frac{dv_p}{d\\theta} \\approx \\frac{1}{v_{p0}} \\left( v_{p0} \\left[ \\epsilon \\sin(2\\theta) - \\frac{1}{2}(\\epsilon - \\delta)\\sin(4\\theta) \\right] \\right) = \\epsilon \\sin(2\\theta) - \\frac{1}{2}(\\epsilon - \\delta)\\sin(4\\theta)\n$$\n我们现在有：\n$$\n\\tan(\\Delta(\\theta)) = \\tan(\\theta_g - \\theta) \\approx \\epsilon \\sin(2\\theta) - \\frac{1}{2}(\\epsilon - \\delta)\\sin(4\\theta)\n$$\n由于 $\\epsilon$ 和 $\\delta$ 很小，等式右边是一个小量。这意味着角度差 $\\Delta(\\theta)$ 也很小。对于小角度 $x$，我们可以使用一阶泰勒近似 $\\tan(x) \\approx x$。因此，我们可以写出：\n$$\n\\Delta(\\theta) \\approx \\tan(\\Delta(\\theta))\n$$\n最后，综合这些结果，我们得到了群角和相角之差所需的一阶表达式：\n$$\n\\Delta(\\theta) \\approx \\epsilon \\sin(2\\theta) - \\frac{1}{2}(\\epsilon - \\delta)\\sin(4\\theta)\n$$\n这是最终表达式，在Thomsen参数 $\\epsilon$ 和 $\\delta$ 的一阶范围内有效。",
            "answer": "$$ \\boxed{\\epsilon \\sin(2\\theta) - \\frac{1}{2}(\\epsilon - \\delta)\\sin(4\\theta)} $$"
        },
        {
            "introduction": "当我们从解析物理学过渡到计算建模时，会引入一种新的误差来源：数值频散。计算网格的离散特性改变了波的传播方式，这意味着我们的模拟无法完美复现连续波动方程的物理过程。这个计算练习  要求您分析一个标准有限差分格式的数值频散。通过推导并实现数值相速度和群速度的公式，您将学会如何量化模拟参数对精度的影响，并理解为什么高频信号在网格上通常难以被准确表示。",
            "id": "3585666",
            "problem": "考虑一维声波方程 $u_{tt} = c^{2} u_{xx}$，其中 $c$ 是以米/秒为单位的波速。在时间和空间上采用标准的显式二阶时域有限差分 (FDTD) 离散化，可以得到一个隐含在平面波拟设 $u^{n}_{j} = \\exp\\left(i (k j \\Delta x - \\omega n \\Delta t)\\right)$ 中的数值频散关系，其中 $k$ 是以弧度/米为单位的空间波数，$\\omega$ 是以弧度/秒为单位的角频率，$\\Delta x$ 是以米为单位的空间网格间距，$\\Delta t$ 是以秒为单位的时间步长。在此拟设下，与离散化相关的数值频散曲线 $\\omega_{h}(k)$ 由以下关系隐式定义：\n$$\n\\sin^{2}\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right) = \\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)^{2}\\,\\sin^{2}\\left(\\frac{k\\,\\Delta x}{2}\\right).\n$$\n采用反正弦的主支，使得 $\\omega_{h}(k) \\in \\left[0,\\frac{\\pi}{\\Delta t}\\right]$。\n\n使用相速度 $v_{p,h}(k) = \\omega_{h}(k)/k$ 和群速度 $v_{g,h}(k) = d\\omega_{h}(k)/dk$ 的定义，为给定的参数集计算 $v_{p,h}$ 和 $v_{g,h}$，并量化它们与连续非频散目标（其中 $\\omega(k) = c\\,k$，$v_{p} = c$ 且 $v_{g} = c$）的偏差。基于上述隐式数值频散关系，使用解析微分计算 $d\\omega_{h}/dk$。速度以米/秒表示，所有角度均使用弧度。偏差以小数形式报告（不使用百分号），相速度偏差定义为 $(v_{p,h} - c)/c$，群速度偏差定义为 $(v_{g,h} - c)/c$。\n\n您的程序必须为每个测试用例计算以下内容：\n- $v_{p,h}$，单位为米/秒，\n- $v_{g,h}$，单位为米/秒，\n- $v_{p,h}$ 相对于 $c$ 的相对偏差，即 $(v_{p,h} - c)/c$，\n- $v_{g,h}$ 相对于 $c$ 的相对偏差，即 $(v_{g,h} - c)/c$。\n\n使用以下测试套件，其中所有角度均以弧度为单位，所有距离均以米为单位：\n- 测试用例 1：$c = 2500$，$\\Delta x = 10$，$\\Delta t = 0.002$，$k = \\frac{\\pi}{40}$。\n- 测试用例 2：$c = 2500$，$\\Delta x = 10$，$\\Delta t = 0.0036$，$k = \\frac{\\pi}{20}$。\n- 测试用例 3：$c = 2500$，$\\Delta x = 10$，$\\Delta t = 0.003996$，$k = 10^{-6}$。\n- 测试用例 4：$c = 2500$，$\\Delta x = 10$，$\\Delta t = 0.0036$，$k = \\frac{\\pi}{10} - 10^{-9}$。\n- 测试用例 5：$c = 2500$，$\\Delta x = 10$，$\\Delta t = 0.0004$，$k = \\frac{\\pi}{30}$。\n\n为覆盖率而设计：\n- 测试用例 1 是一个普通的中波数、中等 Courant–Friedrichs–Lewy (CFL) 数的场景。\n- 测试用例 2 使用了更高的 CFL 数和更高的波数。\n- 测试用例 3 在接近 CFL 极限的条件下探测 $k \\to 0^{+}$ 附近的小波数极限。\n- 测试用例 4 探索了奈奎斯特波数 (Nyquist wavenumber) $k_{\\text{N}} = \\frac{\\pi}{\\Delta x}$ 附近的行为，在该处数值群速度趋向于 $0$。\n- 测试用例 5 检验了低 CFL 数的情况。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，其顺序为\n$[v_{p,h}^{(1)}, v_{g,h}^{(1)}, \\delta v_{p}^{(1)}, \\delta v_{g}^{(1)}, v_{p,h}^{(2)}, v_{g,h}^{(2)}, \\delta v_{p}^{(2)}, \\delta v_{g}^{(2)}, \\dots, v_{p,h}^{(5)}, v_{g,h}^{(5)}, \\delta v_{p}^{(5)}, \\delta v_{g}^{(5)}]$，\n其中上标索引了从 $1$ 到 $5$ 的测试用例。所有速度值必须以米/秒为单位，偏差必须是相对于 $c$ 的小数值。",
            "solution": "已根据指定标准对用户提供的问题进行了分析和验证。\n\n### 第 1 步：提取已知条件\n- **控制方程**：一维声波方程，$u_{tt} = c^{2} u_{xx}$。\n- **物理/数值参数**：波速 $c$ (米/秒)，空间波数 $k$ (弧度/米)，角频率 $\\omega$ (弧度/秒)，空间网格间距 $\\Delta x$ (米)，时间步长 $\\Delta t$ (秒)。\n- **平面波拟设**：$u^{n}_{j} = \\exp\\left(i (k j \\Delta x - \\omega n \\Delta t)\\right)$。\n- **隐式数值频散关系**：$\\sin^{2}\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right) = \\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)^{2}\\,\\sin^{2}\\left(\\frac{k\\,\\Delta x}{2}\\right)$。\n- **支路约束**：$\\omega_{h}(k) \\in \\left[0,\\frac{\\pi}{\\Delta t}\\right]$。\n- **速度定义**：数值相速度 $v_{p,h}(k) = \\omega_{h}(k)/k$，数值群速度 $v_{g,h}(k) = d\\omega_{h}(k)/dk$。\n- **连续（目标）速度**：$v_{p} = c$，$v_{g} = c$。\n- **偏差定义**：相速度偏差 $\\delta v_{p} = (v_{p,h} - c)/c$，群速度偏差 $\\delta v_{g} = (v_{g,h} - c)/c$。\n- **计算要求**：使用解析微分计算 $d\\omega_{h}/dk$。\n- **测试用例**：\n    1.  $c = 2500$ 米/秒，$\\Delta x = 10$ 米，$\\Delta t = 0.002$ 秒，$k = \\frac{\\pi}{40}$ 弧度/米。\n    2.  $c = 2500$ 米/秒，$\\Delta x = 10$ 米，$\\Delta t = 0.0036$ 秒，$k = \\frac{\\pi}{20}$ 弧度/米。\n    3.  $c = 2500$ 米/秒，$\\Delta x = 10$ 米，$\\Delta t = 0.003996$ 秒，$k = 10^{-6}$ 弧度/米。\n    4.  $c = 2500$ 米/秒，$\\Delta x = 10$ 米，$\\Delta t = 0.0036$ 秒，$k = \\frac{\\pi}{10} - 10^{-9}$ 弧度/米。\n    5.  $c = 2500$ 米/秒，$\\Delta x = 10$ 米，$\\Delta t = 0.0004$ 秒，$k = \\frac{\\pi}{30}$ 弧度/米。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。\n- **科学依据**：该问题探讨了应用于声波方程的标准二阶有限差分格式的数值频散分析。这是计算地球物理学和偏微分方程数值分析中的一个典型课题。所有方程和定义都是标准且正确的。\n- **适定的**：问题陈述清晰，提供了所有必要的参数。为了使解存在，数值格式必须是稳定的，这要求满足 Courant–Friedrichs–Lewy (CFL) 条件。CFL 数为 $S = c \\Delta t / \\Delta x$。为了保证稳定性，$S \\le 1$。对测试用例的分析证实，所有用例都满足 $S \\le 1$（分别为 $0.5$、$0.9$、$0.999$、$0.9$ 和 $0.1$），这确保了频散关系中反正弦函数的参数的绝对值不超过 $1$，从而保证了 $\\omega_h(k)$ 有实数值解。\n- **客观性**：问题以精确、客观和定量的语言表达，没有任何主观性。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。下面提供了完整的解决方案。\n\n### 基于原理的求解推导\n目标是从给定的隐式频散关系中推导出数值相速度 $v_{p,h}(k)$ 和群速度 $v_{g,h}(k)$ 的显式表达式，然后用它们来计算指定测试用例所需的量。\n\n隐式频散关系为：\n$$ \\sin^{2}\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right) = S^2\\,\\sin^{2}\\left(\\frac{k\\,\\Delta x}{2}\\right) $$\n其中 $S = \\frac{c\\,\\Delta t}{\\Delta x}$ 是 Courant 数。\n\n**1. 数值相速度 ($v_{p,h}$) 的推导**\n\n首先，我们求解频散关系以得到 $\\omega_h(k)$。对两边取平方根得到：\n$$ \\left|\\sin\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right)\\right| = |S|\\,\\left|\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\\right| $$\n按照惯例，$c$、$\\Delta t$ 和 $\\Delta x$ 均为正值，因此 $S$ 为正值。波数 $k$ 通常被认为在范围 $[0, k_{\\text{N}}]$ 内，其中奈奎斯特波数 (Nyquist wavenumber) 为 $k_{\\text{N}} = \\pi/\\Delta x$。在此范围内，$k \\Delta x / 2 \\in [0, \\pi/2]$，因此 $\\sin(k \\Delta x / 2) \\ge 0$。问题规定 $\\omega_{h}(k) \\in [0, \\pi/\\Delta t]$，这意味着 $\\omega_{h} \\Delta t / 2 \\in [0, \\pi/2]$，因此 $\\sin(\\omega_{h} \\Delta t / 2) \\ge 0$。因此我们可以去掉绝对值符号：\n$$ \\sin\\left(\\frac{\\omega_{h}(k)\\,\\Delta t}{2}\\right) = S\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right) $$\n应用反正弦函数（按指定的主支）可得：\n$$ \\frac{\\omega_{h}(k)\\,\\Delta t}{2} = \\arcsin\\left(S\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\\right) $$\n求解数值角频率 $\\omega_h(k)$：\n$$ \\omega_{h}(k) = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{c\\,\\Delta t}{\\Delta x}\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\\right) $$\n数值相速度定义为 $v_{p,h}(k) = \\omega_{h}(k)/k$。代入 $\\omega_h(k)$ 的表达式得到：\n$$ v_{p,h}(k) = \\frac{2}{k\\,\\Delta t} \\arcsin\\left(\\frac{c\\,\\Delta t}{\\Delta x}\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\\right) $$\n由于 $\\omega_h$ 和 $k$ 之间的非线性关系，$v_{p,h}$ 是 $k$ 的函数，这种现象被称为数值频散。对于此格式，可以证明 $v_{p,h}(k) \\le c$，这表明数值波滞后于真实的物理波。\n\n**2. 数值群速度 ($v_{g,h}$) 的推导**\n\n数值群速度为 $v_{g,h}(k) = d\\omega_{h}(k)/dk$。我们使用链式法则对 $\\omega_h(k)$ 的显式表达式关于 $k$ 求导。令 $u(k) = S \\sin(k \\Delta x / 2)$。那么 $\\omega_h(k) = (2/\\Delta t) \\arcsin(u(k))$。\n$$ v_{g,h}(k) = \\frac{d\\omega_h}{dk} = \\frac{2}{\\Delta t} \\frac{d}{dk}\\left(\\arcsin(u)\\right) = \\frac{2}{\\Delta t} \\frac{1}{\\sqrt{1 - u^2}} \\frac{du}{dk} $$\n$u(k)$ 的导数是：\n$$ \\frac{du}{dk} = \\frac{d}{dk}\\left(S \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) = S \\cos\\left(\\frac{k\\Delta x}{2}\\right) \\frac{\\Delta x}{2} $$\n代回到 $v_{g,h}(k)$ 的表达式中：\n$$ v_{g,h}(k) = \\frac{2}{\\Delta t} \\frac{1}{\\sqrt{1 - S^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)}} \\left(S \\cos\\left(\\frac{k\\Delta x}{2}\\right) \\frac{\\Delta x}{2}\\right) $$\n化简并代入 $S = c \\Delta t / \\Delta x$，这意味着 $S \\Delta x / \\Delta t = c$：\n$$ v_{g,h}(k) = \\frac{S\\,\\Delta x}{\\Delta t} \\frac{\\cos\\left(\\frac{k\\Delta x}{2}\\right)}{\\sqrt{1 - S^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)}} = c \\frac{\\cos\\left(\\frac{k\\Delta x}{2}\\right)}{\\sqrt{1 - \\left(\\frac{c\\Delta t}{\\Delta x}\\right)^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)}} $$\n这个表达式表明 $v_{g,h}$ 也依赖于 $k$。当 $k \\to k_{\\text{N}} = \\pi/\\Delta x$ 时，项 $\\cos(k \\Delta x / 2) \\to \\cos(\\pi/2) = 0$，导致群速度消失，$v_{g,h} \\to 0$。这意味着高频波包在网格上传播得很差。在低波数极限下 ($k \\to 0$)， $v_{p,h}$ 和 $v_{g,h}$ 都趋近于物理速度 $c$。\n\n**3. 偏差计算**\n\n相对偏差按指定方式计算：\n- 相对相速度偏差：$\\delta v_{p} = \\frac{v_{p,h}(k) - c}{c}$\n- 相对群速度偏差：$\\delta v_{g} = \\frac{v_{g,h}(k) - c}{c}$\n\n将为每个测试用例实现这些公式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical phase and group velocities and their deviations\n    for a 1D FDTD scheme for the acoustic wave equation.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (c, delta_x, delta_t, k)\n        (2500.0, 10.0, 0.002, np.pi / 40.0),\n        (2500.0, 10.0, 0.0036, np.pi / 20.0),\n        (2500.0, 10.0, 0.003996, 1e-6),\n        (2500.0, 10.0, 0.0036, np.pi / 10.0 - 1e-9),\n        (2500.0, 10.0, 0.0004, np.pi / 30.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        c, dx, dt, k = case\n\n        # Calculate the Courant number, S\n        S = c * dt / dx\n\n        # --- Phase Velocity Calculation ---\n        # Argument for the arcsin function\n        arg_asin = S * np.sin(k * dx / 2.0)\n\n        # The problem setup ensures S <= 1 and k <= pi/dx, so arg_asin is in [-1, 1].\n        # Numerical angular frequency omega_h(k)\n        omega_h = (2.0 / dt) * np.arcsin(arg_asin)\n\n        # Numerical phase velocity v_p,h(k) = omega_h / k\n        # For k -> 0, the limit is c. Direct computation is fine for k=1e-6.\n        v_ph = omega_h / k\n\n        # --- Group Velocity Calculation ---\n        # Numerator of the group velocity expression\n        v_gh_num = c * np.cos(k * dx / 2.0)\n        \n        # Denominator of the group velocity expression\n        v_gh_den = np.sqrt(1.0 - arg_asin**2)\n        \n        # Numerical group velocity v_g,h(k)\n        v_gh = v_gh_num / v_gh_den\n        \n        # --- Deviation Calculation ---\n        # Relative deviation of phase velocity\n        dev_vph = (v_ph - c) / c\n        \n        # Relative deviation of group velocity\n        dev_vgh = (v_gh - c) / c\n        \n        results.extend([v_ph, v_gh, dev_vph, dev_vgh])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}