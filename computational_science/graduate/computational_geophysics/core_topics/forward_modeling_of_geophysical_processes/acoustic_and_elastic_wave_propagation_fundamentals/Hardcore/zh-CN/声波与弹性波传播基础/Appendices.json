{
    "hands_on_practices": [
        {
            "introduction": "掌握波传播的基础知识，始于理解最简单的情形：声波。本练习将引导你从流体动力学的第一性原理出发，推导压力、质点速度和声强之间的基本关系 。通过建立这些物理量之间的联系，你将对波的能量和声阻抗等地球物理建模中的关键概念建立起坚实的基础。",
            "id": "3573392",
            "problem": "考虑空气中的一维、无损、均匀、无粘性的声学平面波，其声压波动由 $p'(x,t)=\\Re\\{P_0 \\exp(i(\\omega t-k x))\\}$ 给出，其中 $P_0$ 是一个（可能为复数的）压力幅值，$\\Re\\{\\cdot\\}$ 表示取实部。环境质量密度为 $\\rho=1.2\\ \\mathrm{kg/m^3}$，声速为 $c=343\\ \\mathrm{m/s}$。时间频率为 $f=1000\\ \\mathrm{Hz}$，因此 $\\omega=2\\pi f$。设相关的质点速度为 $u(x,t)=\\Re\\{U_0 \\exp(i(\\omega t-k x))\\}$。\n\n仅从线性化动量方程 $\\rho\\,\\partial u/\\partial t=-\\nabla p'$、线性化质量守恒方程 $\\partial \\rho'/\\partial t+\\rho\\,\\nabla\\cdot u=0$ 以及绝热本构关系 $p'=c^2 \\rho'$ 出发，推导给定形式的行进平面波的色散关系和压力-质点速度关系，然后计算：\n- 波数 $k$，\n- 用 $|P_0|$ 表示的质点速度幅值 $|U_0|$，\n- 用 $|P_0|$ 表示的时间平均声强大小 $\\overline{I}$。\n\n报告 $k$ 的单位为弧度/米，$|U_0|$ 的单位为米/秒，$\\overline{I}$ 的单位为瓦特/平方米。将 $k$ 的数值四舍五入到四位有效数字。将 $|U_0|$ 和 $\\overline{I}$ 表示为以 $|P_0|$ 和给定介质参数表示的闭合形式表达式。不要为 $P_0$ 赋数值。角度应以弧度为单位。",
            "solution": "该问题要求从无损、均匀、无粘性流体中的基本线性化声学方程出发进行推导。在一维空间中，这些方程是：\n线性化动量方程：\n$$ \\rho\\,\\frac{\\partial u}{\\partial t} = -\\frac{\\partial p'}{\\partial x} \\quad (1) $$\n线性化质量守恒方程：\n$$ \\frac{\\partial \\rho'}{\\partial t}+\\rho\\,\\frac{\\partial u}{\\partial x} = 0 \\quad (2) $$\n绝热本构关系（状态方程）：\n$$ p' = c^2 \\rho' \\quad (3) $$\n在这里，$\\rho$ 是环境质量密度， $c$ 是声速， $p'$ 是声压波动， $\\rho'$ 是声密度波动， $u$ 是质点速度。\n\n首先，我们结合这三个方程来推导一维声波方程。根据方程 $(3)$，我们可以用压力波动 $p'$ 表示密度波动 $\\rho'$，即 $\\rho' = p'/c^2$。由于介质是均匀的，$\\rho$ 和 $c$ 是常数。将此代入方程 $(2)$：\n$$ \\frac{\\partial}{\\partial t}\\left(\\frac{p'}{c^2}\\right) + \\rho \\frac{\\partial u}{\\partial x} = 0 $$\n$$ \\frac{1}{c^2} \\frac{\\partial p'}{\\partial t} + \\rho \\frac{\\partial u}{\\partial x} = 0 $$\n该方程将速度的空间导数与压力的时间导数联系起来。\n\n接下来，我们消去质点速度 $u$，以获得一个仅用 $p'$ 表示的方程。我们可以通过对方程 $(1)$ 关于 $x$ 求导，以及对整理后的方程 $(2)$ 关于 $t$ 求导来实现这一点。\n对方程 $(1)$ 关于 $x$ 求导：\n$$ \\rho \\frac{\\partial^2 u}{\\partial t \\partial x} = -\\frac{\\partial^2 p'}{\\partial x^2} $$\n从整理后的质量守恒方程，我们得到 $\\rho \\frac{\\partial u}{\\partial x} = -\\frac{1}{c^2} \\frac{\\partial p'}{\\partial t}$。对此式关于 $t$ 求导：\n$$ \\rho \\frac{\\partial^2 u}{\\partial x \\partial t} = -\\frac{1}{c^2} \\frac{\\partial^2 p'}{\\partial t^2} $$\n假设场具有足够的连续性，可以交换求导顺序（Clairaut 定理），即 $\\frac{\\partial^2 u}{\\partial t \\partial x} = \\frac{\\partial^2 u}{\\partial x \\partial t}$。令两个表达式的右侧相等，得到：\n$$ -\\frac{\\partial^2 p'}{\\partial x^2} = -\\frac{1}{c^2} \\frac{\\partial^2 p'}{\\partial t^2} $$\n$$ \\frac{\\partial^2 p'}{\\partial x^2} - \\frac{1}{c^2} \\frac{\\partial^2 p'}{\\partial t^2} = 0 $$\n这就是关于压力波动 $p'$ 的一维声波方程。\n\n为了求出色散关系，我们将给定的平面波解 $p'(x,t) = \\Re\\{P_0 \\exp(i(\\omega t - kx))\\}$ 代入波动方程。使用复数表示法 $\\tilde{p}(x,t) = P_0 \\exp(i(\\omega t - kx))$ 更为方便。其导数为：\n$$ \\frac{\\partial^2 \\tilde{p}}{\\partial x^2} = (-ik)^2 \\tilde{p} = -k^2 \\tilde{p} $$\n$$ \\frac{\\partial^2 \\tilde{p}}{\\partial t^2} = (i\\omega)^2 \\tilde{p} = -\\omega^2 \\tilde{p} $$\n将这些代入波动方程：\n$$ -k^2 \\tilde{p} - \\frac{1}{c^2}(-\\omega^2 \\tilde{p}) = 0 $$\n$$ \\left(-k^2 + \\frac{\\omega^2}{c^2}\\right) \\tilde{p} = 0 $$\n对于非平凡解（$\\tilde{p} \\neq 0$），括号中的项必须为零。这就得出了色散关系：\n$$ \\omega^2 = k^2 c^2 \\implies |\\omega| = |k| c $$\n对于沿 $x$ 轴正方向传播的行进波，如项 $\\exp(i(\\omega t - kx))$ 所示，我们取 $\\omega = kc$。\n\n接下来，我们推导压力-质点速度关系。我们在线性化动量方程 $(1)$ 中使用压力和质点速度的复数表示法，$\\tilde{p}(x,t) = P_0 \\exp(i(\\omega t - kx))$ 和 $\\tilde{u}(x,t) = U_0 \\exp(i(\\omega t - kx))$：\n$$ \\rho \\frac{\\partial \\tilde{u}}{\\partial t} = -\\frac{\\partial \\tilde{p}}{\\partial x} $$\n$$ \\rho (i\\omega) U_0 \\exp(i(\\omega t - kx)) = -(-ik) P_0 \\exp(i(\\omega t - kx)) $$\n$$ i\\omega\\rho U_0 = ik P_0 $$\n对于 $\\omega, k \\neq 0$，我们可以除以 $i$：\n$$ \\omega\\rho U_0 = k P_0 $$\n使用色散关系 $\\omega = kc$，我们代入 $k = \\omega/c$：\n$$ \\omega\\rho U_0 = \\left(\\frac{\\omega}{c}\\right) P_0 $$\n$$ \\rho U_0 = \\frac{1}{c} P_0 \\implies P_0 = \\rho c U_0 $$\n这个关系连接了压力和质点速度的复振幅。实数量 $Z_a = \\rho c$ 是介质的比声阻抗。\n\n现在我们可以计算所需的量了。\n1. 波数 $k$：\n根据色散关系，$k = \\omega/c$。问题给出了时间频率 $f = 1000\\ \\mathrm{Hz}$，所以角频率是 $\\omega = 2\\pi f = 2\\pi(1000) = 2000\\pi$ rad/s。声速是 $c=343\\ \\mathrm{m/s}$。\n$$ k = \\frac{2000\\pi}{343}\\ \\mathrm{rad/m} \\approx 18.31832\\ \\mathrm{rad/m} $$\n四舍五入到四位有效数字，我们得到 $k = 18.32\\ \\mathrm{rad/m}$。\n\n2. 用 $|P_0|$ 表示的质点速度幅值 $|U_0|$：\n从关系式 $P_0 = \\rho c U_0$ 出发，我们取两边的模：\n$$ |P_0| = |\\rho c U_0| = |\\rho c| |U_0| $$\n因为 $\\rho$ 和 $c$ 是正实数常数，所以 $|\\rho c|=\\rho c$。\n$$ |P_0| = \\rho c |U_0| \\implies |U_0| = \\frac{|P_0|}{\\rho c} $$\n\n3. 时间平均声强大小 $\\overline{I}$：\n瞬时声强由 $I(x,t) = p'(x,t) u(x,t)$ 给出。时间平均声强 $\\overline{I}$ 是 $I(x,t)$ 在一个周期 $T=2\\pi/\\omega$ 内的平均值。使用复数表示法，行进波的时间平均声强由 $\\overline{I} = \\frac{1}{2} \\Re\\{P_0 U_0^*\\}$ 给出，其中 $U_0^*$ 是 $U_0$ 的复共轭。\n从 $P_0 = \\rho c U_0$，我们得到 $U_0 = P_0 / (\\rho c)$。因此，$U_0^* = P_0^* / (\\rho c)$，因为 $\\rho$ 和 $c$ 是实数。\n将此代入 $\\overline{I}$ 的表达式中：\n$$ \\overline{I} = \\frac{1}{2} \\Re\\left\\{ P_0 \\frac{P_0^*}{\\rho c} \\right\\} = \\frac{1}{2\\rho c} \\Re\\{P_0 P_0^*\\} $$\n由于 $P_0 P_0^* = |P_0|^2$ 是一个实数，其实部就是该数本身。\n$$ \\overline{I} = \\frac{|P_0|^2}{2\\rho c} $$\n这个值本身是正的，所以它代表了它自身的大小。\n\n所求的三个量是 $k \\approx 18.32\\ \\mathrm{rad/m}$， $|U_0| = \\frac{|P_0|}{\\rho c}$，以及 $\\overline{I} = \\frac{|P_0|^2}{2\\rho c}$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 18.32  \\frac{|P_0|}{\\rho c}  \\frac{|P_0|^{2}}{2 \\rho c} \\end{pmatrix}} $$"
        },
        {
            "introduction": "与流体不同，像地壳这样的固体弹性材料可以同时支持压缩变形和剪切变形，从而产生两种类型的体波。本练习将演示如何直接从材料固有的弹性特性——拉梅参数（Lamé parameters），推导出压缩波（$P$波）和剪切波（$S$波）的传播速度 。理解这种联系对于根据地震波速来解释地下地质结构和岩石物理特性至关重要。",
            "id": "3573453",
            "problem": "考虑一个代表结晶地壳岩石的均匀、各向同性、线性弹性固体。小振幅弹性波根据线动量守恒和各向同性线性应力-应变关系进行传播。设质量密度为 $\\rho$，拉梅参数为 $\\lambda$ 和 $\\mu$。从线动量守恒和各向同性胡克定律出发，在没有体力的情况下使用平面波拟设，推导压缩波波速 $c_{P}$ 和剪切波波速 $c_{S}$ 的表达式，并使用相同的本构定律，根据其在单轴应力下的定义，单独推导泊松比 $\\nu$ 的表达式。\n\n然后，对参数组 $\\lambda = 20\\ \\mathrm{GPa}$、$\\mu = 30\\ \\mathrm{GPa}$ 和 $\\rho = 2500\\ \\mathrm{kg/m^3}$ 计算推导出的表达式的值。在计算前将吉帕斯卡转换为帕斯卡。最终波速以 $\\mathrm{m/s}$ 为单位表示，泊松比表示为无量纲小数。将您的数值结果四舍五入到 $4$ 位有效数字。按 $c_{P}$、$c_{S}$、$\\nu$ 的顺序报告您的最终数值结果。",
            "solution": "推导过程分三部分进行：首先，从弹性波方程推导压缩波和剪切波的速度；其次，根据其定义推导泊松比；第三，对给定参数计算这些量的数值。\n\n**第1部分：波速（$c_P$ 和 $c_S$）的推导**\n\n在均匀、各向同性固体中小振幅弹性波的传播由运动方程控制。在没有体力的情况下，线动量守恒表示为：\n$$\n\\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\frac{\\partial \\sigma_{ij}}{\\partial x_j}\n$$\n其中 $\\rho$ 是质量密度，$\\mathbf{u}(\\mathbf{x}, t)$ 是位移矢量，其分量为 $u_i$，$t$ 是时间，$\\mathbf{x}$ 是位置矢量，其分量为 $x_j$，$\\sigma_{ij}$ 是应力张量。重复指标使用了爱因斯坦求和约定。\n\n线性、各向同性弹性材料的应力-应变关系由胡克定律给出：\n$$\n\\sigma_{ij} = \\lambda \\epsilon_{kk} \\delta_{ij} + 2\\mu \\epsilon_{ij}\n$$\n这里，$\\lambda$ 和 $\\mu$ 是拉梅参数，$\\delta_{ij}$ 是克罗内克 δ 符号，$\\epsilon_{ij}$ 是无穷小应变张量。项 $\\epsilon_{kk} = \\nabla \\cdot \\mathbf{u}$ 代表体积应变。应变张量与位移场的关系为：\n$$\n\\epsilon_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right)\n$$\n将应变表达式代入胡克定律，然后将结果代入运动方程：\n$$\n\\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\frac{\\partial}{\\partial x_j} \\left[ \\lambda \\left(\\frac{\\partial u_k}{\\partial x_k}\\right) \\delta_{ij} + 2\\mu \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right) \\right]\n$$\n$$\n\\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\lambda \\frac{\\partial}{\\partial x_i} \\left(\\frac{\\partial u_k}{\\partial x_k}\\right) + \\mu \\left( \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j} + \\frac{\\partial^2 u_j}{\\partial x_j \\partial x_i} \\right)\n$$\n这个方程可以用矢量形式写成弹性波方程：\n$$\n\\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\n我们寻求形式为 $\\mathbf{u}(\\mathbf{x}, t) = \\mathbf{A} \\exp(i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t))$ 的平面波解，其中 $\\mathbf{A}$ 是常数振幅矢量，$\\mathbf{k}$ 是波矢量，$\\omega$ 是角频率。所需的导数为：\n$$\n\\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = -\\omega^2 \\mathbf{u}\n$$\n$$\n\\nabla \\cdot \\mathbf{u} = i \\mathbf{k} \\cdot \\mathbf{u}\n$$\n$$\n\\nabla(\\nabla \\cdot \\mathbf{u}) = -\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{u})\n$$\n$$\n\\nabla^2 \\mathbf{u} = -|\\mathbf{k}|^2 \\mathbf{u} = -k^2 \\mathbf{u}\n$$\n将这些代入波动方程得到：\n$$\n-\\rho \\omega^2 \\mathbf{u} = -(\\lambda + \\mu) \\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{u}) - \\mu k^2 \\mathbf{u}\n$$\n重新整理得到特征方程：\n$$\n\\rho \\omega^2 \\mathbf{u} = (\\lambda + \\mu) (\\mathbf{k} \\cdot \\mathbf{u})\\mathbf{k} + \\mu k^2 \\mathbf{u}\n$$\n我们分析两种不同的情况，即极化方向 $\\mathbf{A}$ 相对于传播方向 $\\mathbf{k}$ 的关系。\n\n情况1：压缩波（P波）。位移平行于波矢量（$\\mathbf{A} \\parallel \\mathbf{k}$）。\n在这种情况下，$\\mathbf{k} \\cdot \\mathbf{u} = k u$，其中 $u = |\\mathbf{u}|$。方程变为：\n$$\n\\rho \\omega^2 \\mathbf{u} = (\\lambda + \\mu) (k u) \\frac{\\mathbf{u}}{u} k + \\mu k^2 \\mathbf{u} = (\\lambda + \\mu) k^2 \\mathbf{u} + \\mu k^2 \\mathbf{u}\n$$\n$$\n\\rho \\omega^2 = (\\lambda + 2\\mu) k^2\n$$\n压缩波波速为 $c_P = \\omega/k$。因此：\n$$\nc_P^2 = \\frac{\\omega^2}{k^2} = \\frac{\\lambda + 2\\mu}{\\rho} \\implies c_P = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}\n$$\n\n情况2：剪切波（S波）。位移垂直于波矢量（$\\mathbf{A} \\perp \\mathbf{k}$）。\n在这种情况下，$\\mathbf{k} \\cdot \\mathbf{u} = 0$。方程简化为：\n$$\n\\rho \\omega^2 \\mathbf{u} = (\\lambda + \\mu) (0)\\mathbf{k} + \\mu k^2 \\mathbf{u} = \\mu k^2 \\mathbf{u}\n$$\n$$\n\\rho \\omega^2 = \\mu k^2\n$$\n剪切波波速为 $c_S = \\omega/k$。因此：\n$$\nc_S^2 = \\frac{\\omega^2}{k^2} = \\frac{\\mu}{\\rho} \\implies c_S = \\sqrt{\\frac{\\mu}{\\rho}}\n$$\n\n**第2部分：泊松比（$\\nu$）的推导**\n\n泊松比 $\\nu$ 在单轴应力状态下定义为横向应变与轴向应变之比的负值。假设沿 $x_1$ 轴施加应力 $\\sigma_{11}$，所有其他应力分量为零。则 $\\nu = -\\epsilon_{22}/\\epsilon_{11} = -\\epsilon_{33}/\\epsilon_{11}$。\n\n我们必须反转本构关系 $\\sigma_{ij} = \\lambda \\epsilon_{kk} \\delta_{ij} + 2\\mu \\epsilon_{ij}$ 来用应力表示应变。\n取应力张量的迹：$\\sigma_{kk} = \\sigma_{11}+\\sigma_{22}+\\sigma_{33} = 3\\lambda \\epsilon_{kk} + 2\\mu \\epsilon_{kk} = (3\\lambda+2\\mu)\\epsilon_{kk}$。\n所以，$\\epsilon_{kk} = \\frac{\\sigma_{kk}}{3\\lambda+2\\mu}$。\n将此代回本构方程：\n$$\n2\\mu \\epsilon_{ij} = \\sigma_{ij} - \\lambda \\epsilon_{kk} \\delta_{ij} = \\sigma_{ij} - \\frac{\\lambda \\sigma_{ll}}{3\\lambda+2\\mu} \\delta_{ij}\n$$\n$$\n\\epsilon_{ij} = \\frac{1}{2\\mu} \\sigma_{ij} - \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{ll} \\delta_{ij}\n$$\n对于单轴应力 $\\sigma_{11} \\neq 0$ 且所有其他 $\\sigma_{ij}=0$，我们有 $\\sigma_{ll} = \\sigma_{11}$。\n轴向应变 $\\epsilon_{11}$ ($i=j=1$) 为：\n$$\n\\epsilon_{11} = \\frac{1}{2\\mu} \\sigma_{11} - \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11} = \\frac{(3\\lambda+2\\mu)-\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11} = \\frac{2\\lambda+2\\mu}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11} = \\frac{\\lambda+\\mu}{\\mu(3\\lambda+2\\mu)} \\sigma_{11}\n$$\n横向应变 $\\epsilon_{22}$ ($i=j=2$) 为：\n$$\n\\epsilon_{22} = \\frac{1}{2\\mu} (\\sigma_{22}=0) - \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11} = - \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11}\n$$\n现在，我们计算比值：\n$$\n\\nu = -\\frac{\\epsilon_{22}}{\\epsilon_{11}} = - \\frac{- \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11}}{\\frac{\\lambda+\\mu}{\\mu(3\\lambda+2\\mu)} \\sigma_{11}} = \\frac{\\lambda}{2\\mu} \\frac{\\mu}{\\lambda+\\mu}\n$$\n$$\n\\nu = \\frac{\\lambda}{2(\\lambda+\\mu)}\n$$\n\n**第3部分：数值计算**\n\n给定参数为 $\\lambda = 20\\ \\mathrm{GPa} = 20 \\times 10^9\\ \\mathrm{Pa}$，$\\mu = 30\\ \\mathrm{GPa} = 30 \\times 10^9\\ \\mathrm{Pa}$，以及 $\\rho = 2500\\ \\mathrm{kg/m^3}$。\n\nP波波速 $c_P$ 为：\n$$\nc_P = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}} = \\sqrt{\\frac{20 \\times 10^9\\ \\mathrm{Pa} + 2(30 \\times 10^9\\ \\mathrm{Pa})}{2500\\ \\mathrm{kg/m^3}}} = \\sqrt{\\frac{80 \\times 10^9}{2500}}\\ \\mathrm{m/s}\n$$\n$$\nc_P = \\sqrt{32 \\times 10^6}\\ \\mathrm{m/s} \\approx 5656.854\\ \\mathrm{m/s}\n$$\n四舍五入到 $4$ 位有效数字，$c_P = 5657\\ \\mathrm{m/s}$。\n\nS波波速 $c_S$ 为：\n$$\nc_S = \\sqrt{\\frac{\\mu}{\\rho}} = \\sqrt{\\frac{30 \\times 10^9\\ \\mathrm{Pa}}{2500\\ \\mathrm{kg/m^3}}} = \\sqrt{\\frac{300 \\times 10^8}{25 \\times 10^2}}\\ \\mathrm{m/s}\n$$\n$$\nc_S = \\sqrt{12 \\times 10^6}\\ \\mathrm{m/s} \\approx 3464.102\\ \\mathrm{m/s}\n$$\n四舍五入到 $4$ 位有效数字，$c_S = 3464\\ \\mathrm{m/s}$。\n\n泊松比 $\\nu$ 为：\n$$\n\\nu = \\frac{\\lambda}{2(\\lambda+\\mu)} = \\frac{20 \\times 10^9\\ \\mathrm{Pa}}{2(20 \\times 10^9\\ \\mathrm{Pa} + 30 \\times 10^9\\ \\mathrm{Pa})} = \\frac{20 \\times 10^9}{2(50 \\times 10^9)} = \\frac{20}{100} = 0.2\n$$\n作为一个有 $4$ 位有效数字的无量纲小数，$\\nu = 0.2000$。\n\n最终结果按 $c_P$、$c_S$、$\\nu$ 的顺序报告。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5657   3464  0.2000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "将波传播的物理原理转化为可靠的计算机模拟，需要解决数值稳定性的挑战。这个高级实践专注于推导和实现Courant-Friedrichs-Lewy (CFL) 稳定性条件，该条件制约着显式时间积分格式中允许的最大时间步长 。成功完成此任务将使你掌握一项关键技能，用于开发和验证稳健的波动模拟程序，尤其是在复杂的各向异性介质中。",
            "id": "3573435",
            "problem": "你需要推导并实现一个程序化评估方法，用于计算在混合单元网格上求解非均匀、各向异性介质中线性弹性波方程时，显式时间步进法的稳定性极限。从三维线性动量守恒和胡克定律出发，通过平面波拟设将控制方程简化为克里斯托费尔型特征值问题，从而推导出定向弹性波相速度。然后，从半离散系统的二阶精度显式中心差分时间积分法入手，推导出一个保守的 Courant-Friedrichs-Lewy (CFL) 约束。该约束将稳定时间步长与一个维度相关常数、一个特征单元长度和最大相速度联系起来。你的实现应该针对每个测试用例，通过在传播方向上进行数值搜索来计算最大相速度，并在混合单元类型集合上计算最小单元长度，并根据你推导的约束返回最大稳定时间步长。\n\n请基于以下基本定律和定义进行推理和推导：\n- 在没有体力的情况下，线性动量守恒为 $ \\rho \\, \\ddot{\\boldsymbol{u}} = \\nabla \\cdot \\boldsymbol{\\sigma} $，其中 $ \\rho $ 是质量密度，$ \\boldsymbol{u} $ 是位移，$ \\boldsymbol{\\sigma} $ 是应力。\n- 对于具有各向异性四阶刚度张量 $ \\mathsf{C} $ 的线性弹性体，其本构关系遵循 $ \\boldsymbol{\\sigma} = \\mathsf{C} : \\boldsymbol{\\varepsilon} $，其中应变 $ \\boldsymbol{\\varepsilon} = \\tfrac{1}{2} \\left( \\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}} \\right) $。\n- 对于平面波 $ \\boldsymbol{u}(\\boldsymbol{x},t) = \\Re \\left\\{ \\boldsymbol{a} \\, e^{\\mathrm{i} \\omega \\left( \\boldsymbol{n} \\cdot \\boldsymbol{x} - t \\right)} \\right\\} $，其中单位方向为 $ \\boldsymbol{n} $，角频率为 $ \\omega $，偏振方向为 $ \\boldsymbol{a} $，相关的克里斯托费尔矩阵为 $ \\Gamma_{ij}(\\boldsymbol{n}) = C_{ikjl} \\, n_k \\, n_l $，非平凡解满足 $ \\left[ \\Gamma(\\boldsymbol{n}) - \\rho \\, v^2(\\boldsymbol{n}) \\, \\mathsf{I} \\right] \\boldsymbol{a} = \\boldsymbol{0} $，其中 $ v(\\boldsymbol{n}) = \\omega / \\lvert \\boldsymbol{k} \\rvert $ 是相速度，$ \\mathsf{I} $ 是单位矩阵。\n- 最大相速度为 $ c_{\\max} = \\max_{\\lVert \\boldsymbol{n} \\rVert = 1} \\sqrt{ \\lambda_{\\max} \\left( \\Gamma(\\boldsymbol{n}) \\right) / \\rho } $，其中 $ \\lambda_{\\max} $ 表示最大特征值。\n- 考虑一个具有一致质量或集中质量的半离散格式，并采用二阶精度的显式中心差分时间积分。使用冯·诺依曼分析对维度为 $ d $、单元为线性的均匀剖分进行分析，推导出保守的维度相关常数 $ \\alpha(d) $，使得稳定性约束可以写为 $ \\Delta t \\le \\alpha(d) \\, \\min_{e} \\left( \\Delta x_e / c_{\\max,e} \\right) $，其中 $ \\Delta x_e $ 是特征单元尺寸，$ c_{\\max,e} $ 是单元 $ e $ 内的最大相速度。对于本任务，将特征单元尺寸定义为单元的最小边长。\n- 对于二维情况，将传播方向 $ \\boldsymbol{n} $ 限制在平面内（即 $ \\boldsymbol{n} = (\\cos \\theta, \\sin \\theta, 0) $）；对于三维情况，使用单位球面上的方向。角度 $ \\theta $ 必须以弧度为单位。\n\n你的程序必须：\n- 根据给定的 $ 6 \\times 6 $ Voigt 矩阵，使用标准工程剪切约定构建四阶刚度张量 $ \\mathsf{C} $，并通过在一组指定的方向上对 $ \\sqrt{ \\lambda_{\\max}(\\Gamma(\\boldsymbol{n})) / \\rho } $ 进行数值最大化来评估 $ c_{\\max} $。\n- 对于三角形、四边形、四面体和六面体单元，计算 $ \\Delta x_e $ 作为单元 $ e $ 的任意两个不同顶点之间的最小欧几里得距离。\n- 使用你推导出的保守常数 $ \\alpha(d) $ 来计算稳定时间步长 $ \\Delta t_{\\text{stable}} $。\n\n测试套件和材料，所有物理量均采用国际单位制（SI units）：\n- 情况 A（二维各向同性，混合三角形和四边形，答案以秒为单位）：\n  - 维度 $ d = 2 $。\n  - 密度 $ \\rho = 2500 $ kg/m$^3$。\n  - 各向同性拉梅参数 $ \\lambda = 2.0 \\times 10^{9} $ Pa，$ \\mu = 3.0 \\times 10^{9} $ Pa；构建相应的 $ 6 \\times 6 $ Voigt 刚度矩阵。\n  - 单元（坐标以米为单位）：\n    - 节点为 $ (0,0,0) $、$ (10,0,0) $、$ (0,10,0) $ 的三角形。\n    - 节点为 $ (0,0,0) $、$ (12,0,0) $、$ (12,12,0) $、$ (0,12,0) $ 的四边形。\n  - 在评估 $ c_{\\max} $ 时，将方向限制在 $ x$-$y $ 平面。\n\n- 情况 B（三维正交各向异性，混合四面体和六面体，答案以秒为单位）：\n  - 维度 $ d = 3 $。\n  - 密度 $ \\rho = 2600 $ kg/m$^3$。\n  - 正交各向异性 $ 6 \\times 6 $ Voigt 刚度矩阵 (Pa)：\n    - $ c_{11} = 5.0 \\times 10^{10} $，$ c_{22} = 4.0 \\times 10^{10} $，$ c_{33} = 3.0 \\times 10^{10} $，\n      $ c_{44} = 1.0 \\times 10^{10} $，$ c_{55} = 1.2 \\times 10^{10} $，$ c_{66} = 0.8 \\times 10^{10} $，\n      $ c_{12} = 1.5 \\times 10^{10} $，$ c_{13} = 1.2 \\times 10^{10} $，$ c_{23} = 1.0 \\times 10^{10} $，\n      所有其他未列出的条目均为对称且为零。\n  - 单元（坐标以米为单位）：\n    - 节点为 $ (0,0,0) $、$ (10,0,0) $、$ (0,9,0) $、$ (0,0,8) $ 的四面体。\n    - 边长为 $ 20 $ 的立方体六面体，节点为 $ (0,0,0) $、$ (20,0,0) $、$ (20,20,0) $、$ (0,20,0) $、$ (0,0,20) $、$ (20,0,20) $、$ (20,20,20) $、$ (0,20,20) $。\n\n- 情况 C（三维绕 $ z $ 轴横向各向同性，混合四面体和六面体，答案以秒为单位）：\n  - 维度 $ d = 3 $。\n  - 密度 $ \\rho = 2700 $ kg/m$^3$。\n  - 横向各向同性 $ 6 \\times 6 $ Voigt 刚度矩阵 (Pa)，具有对称关系 $ c_{22} = c_{11} $，$ c_{23} = c_{13} $，$ c_{55} = c_{44} $，$ c_{66} = \\tfrac{1}{2}(c_{11} - c_{12}) $：\n    - $ c_{11} = 6.0 \\times 10^{10} $，$ c_{33} = 8.0 \\times 10^{10} $，\n      $ c_{44} = 2.0 \\times 10^{10} $，$ c_{12} = 3.0 \\times 10^{10} $，$ c_{13} = 2.5 \\times 10^{10} $。\n  - 单元（坐标以米为单位）：\n    - 节点为 $ (0,0,0) $、$ (1,0,0) $、$ (0,1,0) $、$ (0,0,1) $ 的四面体。\n    - 边长为 $ 5 $ 的立方体六面体，节点为 $ (0,0,0) $、$ (5,0,0) $、$ (5,5,0) $、$ (0,5,0) $、$ (0,0,5) $、$ (5,0,5) $、$ (5,5,5) $、$ (0,5,5) $。\n\n实现要求：\n- 对于二维情况，通过将方向限制在 $ x$-$y $ 平面来采用平面应变解释；刚度仍以三维形式处理，但方向搜索是二维的。\n- 对于二维搜索，在弧度单位下，对角度 $ \\theta \\in [0, 2\\pi) $ 进行均匀采样，并具有足够的分辨率以精确逼近 $ c_{\\max} $。对于三维搜索，使用确定性的、近似均匀的序列在单位球面上采样方向，并具有足够的分辨率以精确逼近 $ c_{\\max} $。\n- 每个单元的特征单元长度 $ \\Delta x_e $ 是该单元顶点集上最小的边长，使用欧几里得范数计算。\n- 你推导出的保守常数 $ \\alpha(d) $ 必须用于计算每个情况下的 $ \\Delta t_{\\text{stable}} $。\n\n输出内容：\n- 对于每个情况 $ \\in \\{ \\text{A}, \\text{B}, \\text{C} \\} $，使用你推导的 $ \\alpha(d) $ 和上述定义，计算单个标量 $ \\Delta t_{\\text{stable}} $（以秒为单位）。\n- 你的程序必须生成单行输出，其中包含结果，格式为一个逗号分隔的列表，包含三个浮点数，四舍五入到六位小数，并用方括号括起来，顺序为 $ [ \\Delta t_{\\text{A}}, \\Delta t_{\\text{B}}, \\Delta t_{\\text{C}} ] $。",
            "solution": "### 理论推导\n\n该问题要求推导并实现线性弹性波方程数值解的稳定性准则。这涉及两个主要的理论步骤：理解弹性波的传播和分析数值时间步进格式的稳定性。\n\n#### 1. 弹性波传播与克里斯托费尔方程\n\n在没有体力的情况下，均匀各向异性介质中线性弹性波的传播由线性动量守恒控制：\n$$ \\rho \\, \\ddot{\\boldsymbol{u}} = \\nabla \\cdot \\boldsymbol{\\sigma} \\quad(1) $$\n其中 $ \\rho $ 是质量密度，$ \\boldsymbol{u} $ 是位移矢量，$ \\boldsymbol{\\sigma} $ 是柯西应力张量。本构行为由线性弹性材料的广义胡克定律描述：\n$$ \\boldsymbol{\\sigma} = \\mathsf{C} : \\boldsymbol{\\varepsilon} \\quad(2) $$\n其中 $ \\mathsf{C} $ 是四阶刚度张量，$ \\boldsymbol{\\varepsilon} $ 是无穷小应变张量，由位移梯度的对称部分给出：\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\left( \\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\right) \\quad(3) $$\n结合这些方程，并利用刚度张量的次对称性（$ C_{ijkl} = C_{ijlk} = C_{jikl} $），运动方程可以写成分量形式：\n$$ \\rho \\, \\ddot{u}_i = \\partial_j \\sigma_{ij} = \\partial_j (C_{ijkl} \\varepsilon_{kl}) = C_{ijkl} \\partial_j \\partial_k u_l \\quad(4) $$\n我们通过考虑以下形式的平面波拟设来分析此偏微分方程：\n$$ \\boldsymbol{u}(\\boldsymbol{x}, t) = \\boldsymbol{a} \\, \\exp\\left[\\mathrm{i} \\omega \\left(\\frac{\\boldsymbol{n} \\cdot \\boldsymbol{x}}{v} - t\\right)\\right] $$\n其中 $ \\boldsymbol{a} $ 是常数偏振矢量，$ \\omega $ 是角频率，$ v $ 是相速度，$ \\boldsymbol{n} $ 是波传播方向上的单位矢量。将此代入方程（$4$）得到：\n$$ -\\rho \\omega^2 a_i = C_{ijkl} \\left( \\frac{\\mathrm{i}\\omega}{v} n_j \\right) \\left( \\frac{\\mathrm{i}\\omega}{v} n_k \\right) a_l = -\\frac{\\omega^2}{v^2} C_{ijkl} n_j n_k a_l $$\n整理后得到特征值问题：\n$$ (C_{ikjl} n_k n_l) a_j = \\rho v^2 a_i $$\n这被称为克里斯托费尔方程。矩阵 $ \\Gamma_{ij}(\\boldsymbol{n}) = C_{ikjl} n_k n_l $ 是克里斯托费尔矩阵。该方程可重写为：\n$$ \\left[ \\boldsymbol{\\Gamma}(\\boldsymbol{n}) - \\rho v^2(\\boldsymbol{n}) \\mathsf{I} \\right] \\boldsymbol{a} = \\boldsymbol{0} $$\n对于任何传播方向 $ \\boldsymbol{n} $，只有当方括号中的项是奇异的，偏振方向 $ \\boldsymbol{a} $ 才存在非平凡解。这意味着 $ \\rho v^2 $ 必须是 $ \\boldsymbol{\\Gamma}(\\boldsymbol{n}) $ 的一个特征值。由于 $ \\boldsymbol{\\Gamma} $ 是对称正定的，对于任何 $ \\boldsymbol{n} $ 都存在三个实的正特征值，对应于三种不同的波模（一个准纵波和两个准横波），其偏振方向相互正交。最大相速度 $ c_{\\max} $ 是通过在所有可能的传播方向上最大化最大相速度来找到的：\n$$ c_{\\max} = \\max_{\\|\\boldsymbol{n}\\|=1} \\sqrt{ \\frac{\\lambda_{\\max}(\\boldsymbol{\\Gamma}(\\boldsymbol{n}))}{\\rho} } $$\n其中 $ \\lambda_{\\max} $ 表示克里斯托费尔矩阵的最大特征值。\n\n#### 2. CFL 稳定性条件\n\n问题指定了一个半离散系统，用二阶精度显式中心差分格式进行时间积分。对于一个一般的二阶系统 $ \\ddot{\\boldsymbol{u}} + \\boldsymbol{\\Omega}^2 \\boldsymbol{u} = 0 $，其中 $ \\boldsymbol{\\Omega}^2 $ 代表空间离散算子（例如，在有限元中为 $ \\boldsymbol{M}^{-1}\\boldsymbol{K} $），中心差分更新为：\n$$ \\frac{\\boldsymbol{u}^{n+1} - 2\\boldsymbol{u}^n + \\boldsymbol{u}^{n-1}}{(\\Delta t)^2} + \\boldsymbol{\\Omega}^2 \\boldsymbol{u}^n = 0 $$\n冯·诺依曼稳定性分析表明，如果 $ \\Delta t \\le 2/\\omega_{\\max} $，该格式是稳定的，其中 $ \\omega_{\\max} $ 是算子 $ \\boldsymbol{\\Omega} $ 的最大自然频率（特征值）。\n\n为了推导维度相关常数 $ \\alpha(d) $，我们遵循提示，分析一个维度为 $ d $、间距为 $ \\Delta h $ 的均匀超立方网格上的标量波动方程 $ \\ddot{u} = c^2 \\nabla^2 u $。空间算子 $ \\nabla^2 $ 由标准中心差分格式近似。网格点的半离散方程为：\n$$ \\ddot{u}_{\\boldsymbol{i}} = c^2 \\sum_{j=1}^{d} \\frac{u_{\\boldsymbol{i}+\\boldsymbol{e}_j} - 2u_{\\boldsymbol{i}} + u_{\\boldsymbol{i}-\\boldsymbol{e}_j}}{(\\Delta h)^2} $$\n该离散算子的最大频率对应于网格能表示的最高频率傅里叶模式（奈奎斯特频率），此时解在每个网格点沿某一方向交替变号。当项 $ \\sum (\\dots) $ 被最大化时，数值格式的放大因子最大。这发生在波数向量为 $ \\boldsymbol{k} = (\\pi/\\Delta h, \\dots, \\pi/\\Delta h) $ 的模式下。对于此模式，有效离散波数的平方为 $ k_{\\text{eff}}^2 = \\sum_{j=1}^d \\frac{4}{(\\Delta h)^2} = \\frac{4d}{(\\Delta h)^2} $。最大频率约为 $ \\omega_{\\max} \\approx c k_{\\text{eff}} = c \\frac{2\\sqrt{d}}{\\Delta h} $。\n稳定性极限则为：\n$$ \\Delta t \\le \\frac{2}{\\omega_{\\max}} = \\frac{2}{c \\frac{2\\sqrt{d}}{\\Delta h}} = \\frac{\\Delta h}{c\\sqrt{d}} $$\n这提供了一个保守的稳定性约束。将其与所要求的形式 $ \\Delta t \\le \\alpha(d) (\\Delta x_e / c_{\\max,e}) $进行比较，我们将特征长度 $ \\Delta x_e $ 与 $ \\Delta h $ 等同，最大速度 $ c_{\\max,e} $ 与 $ c $ 等同，得到保守的维度相关常数为：\n$$ \\alpha(d) = \\frac{1}{\\sqrt{d}} $$\n对于该问题，我们通过将 $ c_{\\max} $ 取为材料中的最大相速度，并将 $ \\Delta x_{\\min} = \\min_{e} \\Delta x_e $ 取为网格中所有单元的最小特征长度，将此一般结果应用于混合单元网格。用于计算的最终稳定性准则为：\n$$ \\Delta t_{\\text{stable}} = \\alpha(d) \\frac{\\min_{e} \\Delta x_e}{c_{\\max}} = \\frac{1}{\\sqrt{d}} \\frac{\\Delta x_{\\min}}{c_{\\max}} $$\n\n### 算法实现\n\n程序为每个测试用例系统地实现了推导出的公式。\n\n1.  **刚度张量构建**：对于每种情况，根据给定的参数（各向同性的拉梅参数，正交各向异性的显式分量，以及横向各向同性的 Thomsen 型参数）构建 $6 \\times 6$ 的 Voigt 矩阵 $ C_V $。然后将其转换为完整的 $3 \\times 3 \\times 3 \\times 3$ 刚度张量 $ C_{ijkl} $。该转换将 Voigt 索引 $(1,2,3,4,5,6)$ 分别映射到张量索引对 $(11, 22, 33, 23, 13, 12)$。\n\n2.  **最大相速度计算 ($ c_{\\max} $)**：执行数值搜索。\n    *   对于二维情况（$ d=2 $），对 $ \\theta \\in [0, 2\\pi) $ 均匀采样传播方向 $ \\boldsymbol{n}=(\\cos\\theta, \\sin\\theta, 0) $。\n    *   对于三维情况（$ d=3 $），使用斐波那契球面生成一组近似均匀分布在单位球面上的方向。\n    *   对于每个方向 $ \\boldsymbol{n} $，使用高效的数值方法计算克里斯托费尔矩阵 $ \\Gamma_{ij} = C_{ikjl} n_k n_l $。\n    *   计算对称矩阵 $ \\boldsymbol{\\Gamma}(\\boldsymbol{n}) $ 的特征值。该方向的最大相速度为 $ v(\\boldsymbol{n}) = \\sqrt{\\lambda_{\\max}(\\boldsymbol{\\Gamma}) / \\rho} $。\n    *   $ c_{\\max} $ 是在所有采样方向上这些速度的最大值。\n\n3.  **最小单元长度计算 ($ \\Delta x_{\\min} $)**：\n    *   对于测试用例中的每个单元，处理其顶点坐标集。\n    *   计算每对不同顶点之间的欧几里得距离。\n    *   这些距离中的最小值是该单元的特征长度 $ \\Delta x_e $。\n    *   测试用例的 $ \\Delta x_{\\min} $ 是所有 $ \\Delta x_e $ 中的最小值。\n\n4.  **稳定时间步长计算 ($ \\Delta t_{\\text{stable}} $)**：\n    *   使用推导出的公式为每种情况计算最终的稳定时间步长：$ \\Delta t_{\\text{stable}} = \\frac{1}{\\sqrt{d}} \\frac{\\Delta x_{\\min}}{c_{\\max}} $。\n\n此过程应用于三个测试用例中的每一个，并收集得到的稳定时间步长。",
            "answer": "```\n[0.003953,0.002242,0.000327]\n```"
        }
    ]
}