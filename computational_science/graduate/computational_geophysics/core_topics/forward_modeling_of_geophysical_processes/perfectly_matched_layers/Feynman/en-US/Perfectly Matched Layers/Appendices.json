{
    "hands_on_practices": [
        {
            "introduction": "Before a Perfectly Matched Layer can be effectively used to absorb waves, we must first ensure it does not compromise the numerical stability of our time-domain simulation. The introduction of PML stretching and damping terms modifies the discrete wave operator, which in turn affects the maximum allowable time step, $\\Delta t$, dictated by the Courant–Friedrichs–Lewy (CFL) condition. This first exercise  provides a foundational practice in analyzing this interaction through a von Neumann stability analysis, allowing you to derive precisely how PML parameters constrain the time step in a finite-difference time-domain (FDTD) scheme.",
            "id": "3612714",
            "problem": "Consider the two-dimensional linear acoustic equations in a homogeneous medium of constant density $\\rho$ and bulk modulus $K$, with wave speed $c = \\sqrt{K/\\rho}$. The equations in first-order form are\n$$\n\\frac{\\partial p}{\\partial t} = -K\\left(\\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y}\\right), \\quad\n\\frac{\\partial v_x}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}, \\quad\n\\frac{\\partial v_y}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial y}.\n$$\nAssume the entire computational domain is filled with a homogeneous Convolutional Perfectly Matched Layer (C-PML) characterized by constant stretching parameters $\\kappa_x \\ge 1$, $\\kappa_y \\ge 1$, constant damping profiles $\\sigma_x = \\sigma_y = \\sigma \\ge 0$, and set $\\alpha_x = \\alpha_y = 0$. In the frequency domain, the C-PML coordinate stretching modifies spatial derivatives by $s_x^{-1}\\partial/\\partial x$ and $s_y^{-1}\\partial/\\partial y$, where $s_x(\\omega) = \\kappa_x + \\sigma_x/(i\\omega)$ and $s_y(\\omega) = \\kappa_y + \\sigma_y/(i\\omega)$.\n\nDiscretize the equations on a uniform staggered grid (pressure $p$ at integer time levels $n\\Delta t$ and integer spatial nodes, velocities $v_x, v_y$ at half time steps $(n+\\tfrac{1}{2})\\Delta t$ and staggered spatial locations) using second-order accurate central differences in space with spacings $(\\Delta x,\\Delta y)$ and the standard leapfrog time stepping. Perform a von Neumann analysis under the assumption that $\\kappa_x$, $\\kappa_y$, and $\\sigma$ are constant throughout space and time. Use a plane-wave ansatz for the discrete fields of the form\n$$\np^n_{j,k} = P\\,G^n \\exp\\!\\left(i k_x j \\Delta x + i k_y k \\Delta y\\right), \\quad v_x^{n+\\frac{1}{2}}{}_{j+\\frac{1}{2},k} = V_x\\,G^{n+\\frac{1}{2}} \\exp\\!\\left(i k_x \\left(j+\\tfrac{1}{2}\\right) \\Delta x + i k_y k \\Delta y\\right),\n$$\nand similarly for $v_y$, where $G$ is the amplification factor and $(k_x,k_y)$ are spatial wavenumbers.\n\nStarting from the fundamental acoustic equations and the definition of the C-PML stretch operators, derive the discrete dispersion relation for $G$ and establish the Courant–Friedrichs–Lewy (CFL) stability condition by requiring $|G| \\le 1$ for all $(k_x, k_y)$ in the first Brillouin zone. Show explicitly how the C-PML parameters $(\\kappa_x,\\kappa_y,\\sigma)$ enter the symbol of the spatial operator and explain the role of $\\sigma$ in the stability bound. Then, compute the maximum allowable time step $\\Delta t_{\\max}$ as a closed-form function of $c$, $\\Delta x$, $\\Delta y$, and the PML parameters $(\\kappa_x,\\kappa_y)$ under the stated assumptions.\n\nExpress the final $\\Delta t_{\\max}$ in seconds. No numerical substitution is required; provide a single closed-form analytic expression. Do not round.",
            "solution": "The problem asks for the derivation of the Courant–Friedrichs–Lewy (CFL) stability condition for the two-dimensional acoustic equations discretized with a finite-difference scheme in a domain governed by a Convolutional Perfectly Matched Layer (C-PML).\n\nFirst, we must validate the problem statement.\n\n### Step 1: Extract Givens\n-   **Governing Equations**:\n    $$\n    \\frac{\\partial p}{\\partial t} = -K\\left(\\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y}\\right), \\quad\n    \\frac{\\partial v_x}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}, \\quad\n    \\frac{\\partial v_y}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial y}.\n    $$\n-   **Medium Properties**: Homogeneous, with constant density $\\rho$ and bulk modulus $K$.\n-   **Wave Speed**: $c = \\sqrt{K/\\rho}$.\n-   **PML Model**: Convolutional PML (C-PML) with constant parameters.\n-   **PML Parameters**: Stretching factors $\\kappa_x \\ge 1$, $\\kappa_y \\ge 1$. Damping profiles $\\sigma_x = \\sigma_y = \\sigma \\ge 0$. $\\alpha_x = \\alpha_y = 0$.\n-   **PML Stretch Operators (Frequency Domain)**: The spatial derivative $\\partial/\\partial x$ is modified by a factor $s_x(\\omega)^{-1}$ and $\\partial/\\partial y$ by $s_y(\\omega)^{-1}$, where $s_x(\\omega) = \\kappa_x + \\sigma_x/(i\\omega)$ and $s_y(\\omega) = \\kappa_y + \\sigma_y/(i\\omega)$.\n-   **Discretization Scheme**:\n    -   Grid: Uniform staggered grid. Pressure $p$ at integer time levels $n\\Delta t$ and integer spatial nodes $(j\\Delta x, k\\Delta y)$. Velocities $v_x, v_y$ at half-integer time levels $(n+\\tfrac{1}{2})\\Delta t$ and staggered spatial locations $((j+\\tfrac{1}{2})\\Delta x, k\\Delta y)$ and $(j\\Delta x, (k+\\tfrac{1}{2})\\Delta y)$, respectively.\n    -   Spatial Discretization: Second-order accurate central differences with spacings $\\Delta x, \\Delta y$.\n    -   Temporal Discretization: Standard leapfrog time stepping.\n-   **Analysis Method**: von Neumann stability analysis using a plane-wave ansatz.\n-   **Plane-Wave Ansatz**:\n    $$\n    p^n_{j,k} = P\\,G^n \\exp\\!\\left(i k_x j \\Delta x + i k_y k \\Delta y\\right)\n    $$\n    $$\n    v_x^{n+\\frac{1}{2}}{}_{j+\\frac{1}{2},k} = V_x\\,G^{n+\\frac{1}{2}} \\exp\\!\\left(i k_x \\left(j+\\tfrac{1}{2}\\right) \\Delta x + i k_y k \\Delta y\\right)\n    $$\n    and a similar form for $v_y$, where $G$ is the amplification factor and $(k_x, k_y)$ are the spatial wavenumbers.\n-   **Objective**: Derive the discrete dispersion relation for $G$, find the CFL stability condition by requiring $|G| \\le 1$, explain the role of $\\sigma$, and find the maximum allowable time step $\\Delta t_{\\max}$ as a function of $c$, $\\Delta x$, $\\Delta y$, $\\kappa_x$, and $\\kappa_y$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is based on the standard acoustic wave equation and the widely used C-PML formulation for absorbing boundary conditions in finite-difference time-domain (FDTD) simulations. The methodology is a cornerstone of numerical analysis for partial differential equations. The problem is factually and scientifically sound.\n-   **Well-Posed**: The problem is clearly defined, with all necessary components provided to derive the stability condition. The objective is specific and achievable.\n-   **Objective**: The language is precise and technical, free of any subjectivity or ambiguity.\n-   **Completeness and Consistency**: The provided information is self-contained and sufficient. The description of the staggered grid, time-stepping scheme, and C-PML model is consistent with standard practices in computational wave physics.\n-   **Other Flaws**: The problem is not trivial, unrealistic, or otherwise flawed.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\n#### Derivation of the Discrete Dispersion Relation\n\nThe leapfrog time-stepping scheme for the given staggered grid can be written as:\n$$\n\\frac{p^{n+1}_{j,k} - p^{n}_{j,k}}{\\Delta t} = -K\\left[ (D_x^{PML} v_x^{n+1/2})_{j,k} + (D_y^{PML} v_y^{n+1/2})_{j,k} \\right] \\quad (1)\n$$\n$$\n\\frac{v_x^{n+\\frac{1}{2}}{}_{j+\\frac{1}{2},k} - v_x^{n-\\frac{1}{2}}{}_{j+\\frac{1}{2},k}}{\\Delta t} = -\\frac{1}{\\rho} (D_x^{PML} p^{n})_{j+\\frac{1}{2},k} \\quad (2)\n$$\n$$\n\\frac{v_y^{n+\\frac{1}{2}}{}_{j,k+\\frac{1}{2}} - v_y^{n-\\frac{1}{2}}{}_{j,k+\\frac{1}{2}}}{\\Delta t} = -\\frac{1}{\\rho} (D_y^{PML} p^{n})_{j,k+\\frac{1}{2}} \\quad (3)\n$$\nwhere $D_x^{PML}$ and $D_y^{PML}$ represent the PML-modified discrete spatial derivative operators.\n\nFor the von Neumann analysis, we substitute the plane-wave ansatz into these equations. The standard second-order central difference operators acting on the plane-wave ansatz become multiplicative factors (symbols). For a field $f$, the symbol $\\hat{D}_x$ of the operator $D_x$ at wavenumber $k_x$ is:\n$$\n\\hat{D}_x f = \\frac{\\exp(i k_x \\Delta x/2) - \\exp(-i k_x \\Delta x/2)}{\\Delta x} f = \\frac{2i}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right) f\n$$\nSimilarly, for the $y$-derivative:\n$$\n\\hat{D}_y f = \\frac{2i}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right) f\n$$\nThe problem states that the C-PML modifies the spatial derivatives by factors of $s_x(\\omega)^{-1}$ and $s_y(\\omega)^{-1}$ in the frequency domain. In the context of von Neumann analysis, the continuous frequency $\\omega$ is identified with the numerical frequency of the discrete mode, which is related to the amplification factor $G$ by $G = \\exp(-i\\omega\\Delta t)$. Thus, the symbols for the PML-modified operators become:\n$$\n\\hat{D}^{PML}_x = \\frac{\\hat{D}_x}{s_x(\\omega)}, \\quad \\hat{D}^{PML}_y = \\frac{\\hat{D}_y}{s_y(\\omega)}\n$$\nSubstituting the ansatz and these symbols into equations $(1)-(3)$:\nEquation $(1)$ becomes:\n$P G^n \\frac{G-1}{\\Delta t} = -K \\left[ V_x G^{n+\\frac{1}{2}} \\frac{\\hat{D}_x}{s_x} + V_y G^{n+\\frac{1}{2}} \\frac{\\hat{D}_y}{s_y} \\right]$\nDividing by $G^n$ yields:\n$$\nP(G-1) = -K \\Delta t G^{\\frac{1}{2}} \\left( V_x \\frac{\\hat{D}_x}{s_x} + V_y \\frac{\\hat{D}_y}{s_y} \\right) \\quad (1')\n$$\nEquation $(2)$ becomes:\n$V_x G^{n-\\frac{1}{2}} \\frac{G-1}{\\Delta t} = -\\frac{1}{\\rho} P G^n \\frac{\\hat{D}_x}{s_x}$\nDividing by $G^{n-\\frac{1}{2}}$ yields:\n$$\nV_x(G-1) = -\\frac{\\Delta t}{\\rho} G^{\\frac{1}{2}} P \\frac{\\hat{D}_x}{s_x} \\quad (2')\n$$\nSimilarly, equation $(3)$ becomes:\n$$\nV_y(G-1) = -\\frac{\\Delta t}{\\rho} G^{\\frac{1}{2}} P \\frac{\\hat{D}_y}{s_y} \\quad (3')\n$$\nFrom $(2')$ and $(3')$, we express $V_x$ and $V_y$ in terms of $P$:\n$$\nV_x = -\\frac{\\Delta t}{\\rho} \\frac{G^{\\frac{1}{2}}}{G-1} P \\frac{\\hat{D}_x}{s_x}, \\quad V_y = -\\frac{\\Delta t}{\\rho} \\frac{G^{\\frac{1}{2}}}{G-1} P \\frac{\\hat{D}_y}{s_y}\n$$\nSubstituting these into $(1')$:\n$$\nP(G-1) = -K \\Delta t G^{\\frac{1}{2}} \\left[ \\left(-\\frac{\\Delta t}{\\rho} \\frac{G^{\\frac{1}{2}}}{G-1} P \\frac{\\hat{D}_x}{s_x}\\right) \\frac{\\hat{D}_x}{s_x} + \\left(-\\frac{\\Delta t}{\\rho} \\frac{G^{\\frac{1}{2}}}{G-1} P \\frac{\\hat{D}_y}{s_y}\\right) \\frac{\\hat{D}_y}{s_y} \\right]\n$$\nFor a non-trivial solution ($P \\ne 0$), we can cancel $P$ and simplify:\n$$\n(G-1) = \\frac{K \\Delta t^2}{\\rho} \\frac{G}{G-1} \\left( \\frac{\\hat{D}_x^2}{s_x^2} + \\frac{\\hat{D}_y^2}{s_y^2} \\right)\n$$\nUsing $c^2 = K/\\rho$, this gives the discrete dispersion relation for $G$:\n$$\n(G-1)^2 = G c^2 \\Delta t^2 \\left( \\frac{\\hat{D}_x^2}{s_x(\\omega)^2} + \\frac{\\hat{D}_y^2}{s_y(\\omega)^2} \\right)\n$$\nSubstitute the expressions for $\\hat{D}_x^2$ and $\\hat{D}_y^2$:\n$$\n(G-1)^2 = G c^2 \\Delta t^2 \\left[ \\frac{-4\\sin^2(k_x\\Delta x/2)}{s_x(\\omega)^2 \\Delta x^2} + \\frac{-4\\sin^2(k_y\\Delta y/2)}{s_y(\\omega)^2 \\Delta y^2} \\right]\n$$\nThis can be rewritten using the relation $G=\\exp(-i\\omega\\Delta t)$. The term $(G-1)^2/G = (G^{1/2}-G^{-1/2})^2 = (\\exp(-i\\omega\\Delta t/2) - \\exp(i\\omega\\Delta t/2))^2 = (-2i\\sin(\\omega\\Delta t/2))^2 = -4\\sin^2(\\omega\\Delta t/2)$.\n$$\n-4\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = -4 c^2 \\Delta t^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{s_x(\\omega)^2 \\Delta x^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{s_y(\\omega)^2 \\Delta y^2} \\right]\n$$\nThus, the dispersion relation relating the numerical frequency $\\omega$ to the wavenumbers $(k_x, k_y)$ is:\n$$\n\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = c^2 \\Delta t^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{s_x(\\omega)^2 \\Delta x^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{s_y(\\omega)^2 \\Delta y^2} \\right]\n$$\n\n#### CFL Stability Condition and Role of $\\sigma$\n\nThe stability condition is $|G| \\le 1$ for all wavenumbers. Since $G = \\exp(-i\\omega\\Delta t)$, we have $|G| = \\exp(\\text{Im}(\\omega)\\Delta t)$. Therefore, stability requires that the imaginary part of the numerical frequency be non-positive, $\\text{Im}(\\omega) \\le 0$.\n\nThe C-PML parameters are given by $s_x(\\omega) = \\kappa_x + \\sigma/(i\\omega)$ and $s_y(\\omega) = \\kappa_y + \\sigma/(i\\omega)$. The stability limit on the time step $\\Delta t$ is determined by the most unstable (or least stable) mode. We examine the behavior of the dispersion relation in limiting cases.\n\nConsider high-frequency modes, where $|\\omega| \\to \\infty$. In this limit, the term $\\sigma/(i\\omega) \\to 0$. The stretch factors approach their real, frequency-independent parts:\n$$\n\\lim_{|\\omega|\\to\\infty} s_x(\\omega) = \\kappa_x, \\quad \\lim_{|\\omega|\\to\\infty} s_y(\\omega) = \\kappa_y\n$$\nIn this limit, the dispersion relation simplifies to:\n$$\n\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = c^2 \\Delta t^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{\\kappa_x^2 \\Delta x^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{\\kappa_y^2 \\Delta y^2} \\right]\n$$\nFor a solution $\\omega$ to be real, the right-hand side, which is real and non-negative, must not exceed $1$. If the right-hand side is greater than $1$, $\\sin(\\omega\\Delta t/2)$ becomes greater than $1$, implying that $\\omega\\Delta t/2$ is complex. A complex $\\omega$ in this non-dissipative case leads to one growing and one decaying mode ($|G|>1$ and $|G|<1$), hence instability. Therefore, for stability of all modes, we must require:\n$$\nc^2 \\Delta t^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{\\kappa_x^2 \\Delta x^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{\\kappa_y^2 \\Delta y^2} \\right] \\le 1\n$$\nThis condition must hold for all wavenumbers $(k_x, k_y)$ in the first Brillouin zone, i.e., $k_x \\in [-\\pi/\\Delta x, \\pi/\\Delta x]$ and $k_y \\in [-\\pi/\\Delta y, \\pi/\\Delta y]$. To find the most restrictive condition on $\\Delta t$, we must maximize the left-hand side with respect to $k_x$ and $k_y$. The maximum value of $\\sin^2(\\cdot)$ is $1$, which occurs at the Nyquist wavenumbers $k_x = \\pm \\pi/\\Delta x$ and $k_y = \\pm \\pi/\\Delta y$.\nThe stability condition thus becomes:\n$$\nc^2 \\Delta t^2 \\left[ \\frac{1}{\\kappa_x^2 \\Delta x^2} + \\frac{1}{\\kappa_y^2 \\Delta y^2} \\right] \\le 1\n$$\n\nThe role of $\\sigma$: The parameter $\\sigma \\ge 0$ introduces dissipation into the system for finite frequencies. The term $\\sigma/(i\\omega)$ adds an imaginary component to the stretch factors $s_x$ and $s_y$, which in turn makes the numerical frequency $\\omega$ complex with $\\text{Im}(\\omega)  0$ for propagating waves. This corresponds to an amplification factor $|G| = \\exp(\\text{Im}(\\omega)\\Delta t)  1$, causing the desired attenuation of waves within the PML. The high-frequency limit, which dictates the stability bound, is unaffected by $\\sigma$. Dissipation cannot make a stable scheme unstable, so the stability limit derived from the undamped ($\\sigma=0$ or $\\omega \\to \\infty$) case remains the correct CFL condition for the full C-PML system. The parameters $\\kappa_x \\ge 1$ and $\\kappa_y \\ge 1$ act to stretch the computational grid, increasing the effective phase velocity of high-frequency numerical waves, which necessitates a smaller time step for stability.\n\n#### Maximum Allowable Time Step\nFrom the stability inequality, we solve for the maximum allowable time step, $\\Delta t_{\\max}$:\n$$\n\\Delta t^2 \\le \\frac{1}{c^2 \\left( \\frac{1}{(\\kappa_x \\Delta x)^2} + \\frac{1}{(\\kappa_y \\Delta y)^2} \\right)}\n$$\n$$\n\\Delta t_{\\max} = \\frac{1}{c \\sqrt{\\frac{1}{(\\kappa_x \\Delta x)^2} + \\frac{1}{(\\kappa_y \\Delta y)^2}}}\n$$\nThis is the final closed-form expression for the maximum time step.",
            "answer": "$$\\boxed{\\frac{1}{c \\sqrt{\\frac{1}{(\\kappa_x \\Delta x)^{2}} + \\frac{1}{(\\kappa_y \\Delta y)^{2}}}}}$$"
        },
        {
            "introduction": "A stable simulation is necessary but not sufficient; the PML must also be an effective absorber. The central design task is to calibrate the layer's parameters—its thickness $L$ and damping profile $\\sigma(x)$—to suppress outgoing waves to a desired level, quantified by a target reflection coefficient $R_{\\mathrm{target}}$. This practical exercise  guides you through the process of deriving a calibration rule that connects the physical properties of the wave, the geometry of the PML, and the shape of the damping profile to the peak damping value $\\sigma_{\\max}$ required to meet a specific performance target.",
            "id": "3612678",
            "problem": "Consider one-dimensional propagation of surface-wave dominated motions in a sedimentary basin, modeled by the acoustic wave equation in the absence of sources inside the computational domain. To truncate the domain without artificial reflections, a Perfectly Matched Layer (PML) is applied on one side. The PML is implemented in the time domain via complex coordinate stretching whose effect in one dimension with a polynomial damping profile is to introduce a spatially varying damping coefficient. Assume normal incidence of a plane wave of angular frequency $\\omega$ entering the PML, and let the PML damping profile be $\\sigma(x) = \\sigma_{\\max}\\left(\\dfrac{x}{L}\\right)^{m}$ for $x \\in [0,L]$, where $L$ is the PML thickness, $\\sigma_{\\max}$ is the maximum damping rate, and $m$ is a nonnegative integer denoting the polynomial order. The minimum relevant phase velocity of the surface wavefield is $v_{\\min}$, which must be used for conservative calibration of the PML.\n\nFundamental base:\n- The acoustic wave equation in one spatial dimension for pressure $p(x,t)$ in a homogeneous medium is $\\dfrac{\\partial^{2}p}{\\partial t^{2}} = v^{2}\\dfrac{\\partial^{2}p}{\\partial x^{2}}$, where $v$ is the phase velocity.\n- A plane wave solution has wavelength $\\lambda = \\dfrac{2\\pi v}{\\omega}$ and wavenumber $k = \\dfrac{\\omega}{v}$.\n- For a time-domain PML with a damping profile $\\sigma(x)$ entering as a first-order linear attenuation along the stretched coordinate, the envelope amplitude $A(x)$ of a normally incident plane wave decays approximately according to $\\dfrac{dA}{dx} = -\\dfrac{\\sigma(x)}{v}A$, yielding $A(L) = A(0)\\exp\\!\\left(-\\int_{0}^{L}\\dfrac{\\sigma(x)}{v}\\,dx\\right)$.\n- The reflection at the entrance of a sufficiently thick PML dominated by attenuation is approximately $R \\approx \\exp\\!\\left(-2\\int_{0}^{L}\\dfrac{\\sigma(x)}{v}\\,dx\\right)$.\n- To control numerical dispersion, a finite-difference or finite-element discretization requires a mesh spacing obeying the sampling criterion $\\,\\Delta x \\le \\dfrac{\\lambda}{n_{\\mathrm{ppw}}} = \\dfrac{2\\pi v}{\\omega\\,n_{\\mathrm{ppw}}}$, where $n_{\\mathrm{ppw}}$ is the required number of points per wavelength.\n\nTasks:\n1) Starting from the above base, derive the calibration rule for $\\sigma_{\\max}$ as a function of the target reflection amplitude $R_{\\mathrm{target}} \\in (0,1)$, the polynomial order $m$, the PML thickness $L$, and the minimum phase velocity $v_{\\min}$. You must show the steps leading from the differential attenuation relation and the polynomial profile to a closed-form expression for $\\sigma_{\\max}$ that achieves $R \\approx R_{\\mathrm{target}}$ for normal incidence at angular frequency $\\omega$.\n2) Propose a frequency-dependent meshing rule adjacent to and inside the PML using the sampling criterion based on $n_{\\mathrm{ppw}}$ and $v_{\\min}$, resulting in a recommended mesh spacing $\\Delta x(\\omega)$ and, for a given integer number of PML cells $N_{\\mathrm{pml}}$, a thickness $L(\\omega) = N_{\\mathrm{pml}}\\Delta x(\\omega)$.\n3) For each test case below, compute the following outputs using your derived relations:\n   - $L(\\omega)$ in meters.\n   - $\\sigma_{\\max}$ in $\\mathrm{s}^{-1}$.\n   - $\\Delta x(\\omega)$ in meters.\n   - $N_{\\mathrm{pml}}$ as an integer (reported unchanged from the input parameter but included for completeness).\n   - The estimated entrance reflection $R_{\\mathrm{est}}$ as a decimal.\n   - The attenuated amplitude at the back of the PML, $A_{\\mathrm{out}} = A_{\\mathrm{in}}\\exp\\!\\left(-\\int_{0}^{L}\\dfrac{\\sigma(x)}{v_{\\min}}\\,dx\\right)$, reported as a scalar with the same unit as $A_{\\mathrm{in}}$.\n\nAll physical outputs must be expressed in their specified units. Angles, if any, should be in radians. Express any probabilities or fractions as decimals. You must round all floating-point outputs to six decimal places.\n\nTest suite:\nFor each case, parameters are given as $(v_{\\min}\\,\\text{in m/s},\\,f\\,\\text{in Hz},\\,R_{\\mathrm{target}}\\,\\text{as decimal},\\,m\\,\\text{as integer},\\,n_{\\mathrm{ppw}}\\,\\text{as integer},\\,N_{\\mathrm{pml}}\\,\\text{as integer},\\,A_{\\mathrm{in}}\\,\\text{scalar})$. Angular frequency must be computed as $\\omega = 2\\pi f$ in $\\mathrm{rad/s}$.\n\n- Case $1$: $(800,\\,5,\\,10^{-4},\\,3,\\,12,\\,12,\\,10^{6})$.\n- Case $2$: $(600,\\,20,\\,10^{-6},\\,4,\\,14,\\,16,\\,5\\times 10^{6})$.\n- Case $3$: $(300,\\,10,\\,10^{-5},\\,2,\\,10,\\,20,\\,2\\times 10^{6})$.\n- Case $4$: $(700,\\,1,\\,10^{-3},\\,3,\\,8,\\,10,\\,10^{7})$.\n\nAlgorithmic specifications:\n- Use $\\Delta x(\\omega) = \\dfrac{2\\pi v_{\\min}}{\\omega\\,n_{\\mathrm{ppw}}}$ to enforce the frequency-dependent meshing.\n- Use $L(\\omega) = N_{\\mathrm{pml}}\\Delta x(\\omega)$ to define thickness.\n- Use the derived formula for $\\sigma_{\\max}$ from Task $1$.\n- Use $R_{\\mathrm{est}} = \\exp\\!\\left(-2\\int_{0}^{L}\\dfrac{\\sigma(x)}{v_{\\min}}\\,dx\\right)$ and $A_{\\mathrm{out}} = A_{\\mathrm{in}}\\exp\\!\\left(-\\int_{0}^{L}\\dfrac{\\sigma(x)}{v_{\\min}}\\,dx\\right)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the order $[L,\\sigma_{\\max},\\Delta x,N_{\\mathrm{pml}},R_{\\mathrm{est}},A_{\\mathrm{out}}]$. For example, your output must look like $[[\\dots],[\\dots],[\\dots],[\\dots]]$ with all floating-point values rounded to six decimal places and no additional text.",
            "solution": "The problem statement is assessed for validity.\n\n### Step 1: Extract Givens\n- **Wave Propagation Model**: One-dimensional acoustic wave equation $\\dfrac{\\partial^{2}p}{\\partial t^{2}} = v^{2}\\dfrac{\\partial^{2}p}{\\partial x^{2}}$.\n- **PML Damping Profile**: $\\sigma(x) = \\sigma_{\\max}\\left(\\dfrac{x}{L}\\right)^{m}$ for $x$ in the interval $[0,L]$.\n- **Parameters**: PML thickness $L$, maximum damping rate $\\sigma_{\\max}$, polynomial order $m$, minimum phase velocity $v_{\\min}$.\n- **Incident Wave**: Normal incidence plane wave with angular frequency $\\omega$.\n- **Fundamental Relations**:\n    - Wavelength: $\\lambda = \\dfrac{2\\pi v}{\\omega}$.\n    - Wavenumber: $k = \\dfrac{\\omega}{v}$.\n    - Amplitude decay: $A(L) = A(0)\\exp\\!\\left(-\\int_{0}^{L}\\dfrac{\\sigma(x)}{v}\\,dx\\right)$.\n    - Reflection coefficient: $R \\approx \\exp\\!\\left(-2\\int_{0}^{L}\\dfrac{\\sigma(x)}{v}\\,dx\\right)$.\n    - Discretization rule: $\\Delta x \\le \\dfrac{\\lambda}{n_{\\mathrm{ppw}}} = \\dfrac{2\\pi v}{\\omega\\,n_{\\mathrm{ppw}}}$.\n- **Algorithmic Specifications**:\n    - Mesh spacing: $\\Delta x(\\omega) = \\dfrac{2\\pi v_{\\min}}{\\omega\\,n_{\\mathrm{ppw}}}$.\n    - PML thickness: $L(\\omega) = N_{\\mathrm{pml}}\\Delta x(\\omega)$.\n    - Target reflection: $R_{\\mathrm{target}}$.\n    - Angular frequency: $\\omega = 2\\pi f$.\n    - Formulas for estimation: $R_{\\mathrm{est}} = \\exp\\!\\left(-2\\int_{0}^{L}\\dfrac{\\sigma(x)}{v_{\\min}}\\,dx\\right)$ and $A_{\\mathrm{out}} = A_{\\mathrm{in}}\\exp\\!\\left(-\\int_{0}^{L}\\dfrac{\\sigma(x)}{v_{\\min}}\\,dx\\right)$.\n- **Test Cases**:\n    1. $(v_{\\min}=800\\,\\text{m/s}, f=5\\,\\text{Hz}, R_{\\mathrm{target}}=10^{-4}, m=3, n_{\\mathrm{ppw}}=12, N_{\\mathrm{pml}}=12, A_{\\mathrm{in}}=10^{6})$.\n    2. $(v_{\\min}=600\\,\\text{m/s}, f=20\\,\\text{Hz}, R_{\\mathrm{target}}=10^{-6}, m=4, n_{\\mathrm{ppw}}=14, N_{\\mathrm{pml}}=16, A_{\\mathrm{in}}=5 \\times 10^{6})$.\n    3. $(v_{\\min}=300\\,\\text{m/s}, f=10\\,\\text{Hz}, R_{\\mathrm{target}}=10^{-5}, m=2, n_{\\mathrm{ppw}}=10, N_{\\mathrm{pml}}=20, A_{\\mathrm{in}}=2 \\times 10^{6})$.\n    4. $(v_{\\min}=700\\,\\text{m/s}, f=1\\,\\text{Hz}, R_{\\mathrm{target}}=10^{-3}, m=3, n_{\\mathrm{ppw}}=8, N_{\\mathrm{pml}}=10, A_{\\mathrm{in}}=10^{7})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is based on established principles of computational wave propagation and the theory of Perfectly Matched Layers. The provided equations are standard, albeit simplified, models used for PML design. The problem is self-contained, with all necessary parameters, equations, and constraints specified for its solution. There are no contradictions, ambiguities, or factually incorrect premises. The tasks are a direct application of the provided theoretical base to a concrete computational problem.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A complete solution is provided below.\n\nThe solution proceeds by addressing the three tasks outlined in the problem statement.\n\n**Task 1: Derivation of the PML Calibration Rule for $\\sigma_{\\max}$**\n\nThe objective is to calibrate the PML such that the reflection coefficient $R$ at the PML interface is approximately equal to a specified target value, $R_{\\mathrm{target}}$. The starting point is the given approximate formula for the reflection coefficient for a normally incident plane wave, using the conservative minimum phase velocity $v_{\\min}$:\n$$\nR \\approx \\exp\\left(-2 \\int_{0}^{L} \\frac{\\sigma(x)}{v_{\\min}} dx\\right)\n$$\nWe set $R = R_{\\mathrm{target}}$ to find the required attenuation:\n$$\nR_{\\mathrm{target}} = \\exp\\left(-2 \\int_{0}^{L} \\frac{\\sigma(x)}{v_{\\min}} dx\\right)\n$$\nTaking the natural logarithm of both sides yields:\n$$\n\\ln(R_{\\mathrm{target}}) = -2 \\int_{0}^{L} \\frac{\\sigma(x)}{v_{\\min}} dx\n$$\nThe integral, which represents the total one-way attenuation, can be solved for:\n$$\n\\int_{0}^{L} \\frac{\\sigma(x)}{v_{\\min}} dx = -\\frac{1}{2} \\ln(R_{\\mathrm{target}})\n$$\nNow, we substitute the specified polynomial damping profile, $\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^{m}$, into the integral. Since $\\sigma_{\\max}$, $L$, $m$, and $v_{\\min}$ are constant with respect to the integration variable $x$, we have:\n$$\n\\int_{0}^{L} \\frac{1}{v_{\\min}} \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^{m} dx = \\frac{\\sigma_{\\max}}{v_{\\min} L^m} \\int_{0}^{L} x^m dx\n$$\nThe definite integral of the polynomial term is:\n$$\n\\int_{0}^{L} x^m dx = \\left[\\frac{x^{m+1}}{m+1}\\right]_{0}^{L} = \\frac{L^{m+1}}{m+1}\n$$\nSubstituting this result back, the total attenuation integral is:\n$$\n\\int_{0}^{L} \\frac{\\sigma(x)}{v_{\\min}} dx = \\frac{\\sigma_{\\max}}{v_{\\min} L^m} \\left(\\frac{L^{m+1}}{m+1}\\right) = \\frac{\\sigma_{\\max}L}{v_{\\min}(m+1)}\n$$\nEquating the two expressions for the integral:\n$$\n\\frac{\\sigma_{\\max}L}{v_{\\min}(m+1)} = -\\frac{1}{2} \\ln(R_{\\mathrm{target}})\n$$\nFinally, we solve for $\\sigma_{\\max}$, which provides the desired calibration rule:\n$$\n\\sigma_{\\max} = -\\frac{v_{\\min}(m+1)}{2L} \\ln(R_{\\mathrm{target}})\n$$\nThis formula determines the maximum damping value required to achieve the target reflection $R_{\\mathrm{target}}$ for a PML of thickness $L$, polynomial order $m$, and for waves with minimum velocity $v_{\\min}$.\n\n**Task 2: Frequency-Dependent Meshing Rule**\n\nThe problem specifies the meshing rules. A conservative approach is adopted by using the minimum relevant phase velocity, $v_{\\min}$, to determine the shortest wavelength at a given frequency, $\\lambda_{\\min}(\\omega) = \\frac{2\\pi v_{\\min}}{\\omega}$. To prevent numerical dispersion, the mesh spacing $\\Delta x$ must sufficiently sample this wavelength. The rule is given as:\n$$\n\\Delta x(\\omega) = \\frac{\\lambda_{\\min}(\\omega)}{n_{\\mathrm{ppw}}} = \\frac{2\\pi v_{\\min}}{\\omega \\, n_{\\mathrm{ppw}}}\n$$\nwhere $n_{\\mathrm{ppw}}$ is the number of grid points per wavelength. The problem further defines the PML thickness $L$ to be dependent on this frequency-dependent mesh spacing and a fixed number of cells within the PML, $N_{\\mathrm{pml}}$:\n$$\nL(\\omega) = N_{\\mathrm{pml}} \\Delta x(\\omega)\n$$\nThis ensures that the PML thickness scales with frequency, providing a consistent number of grid points to resolve the damping profile, which is crucial for the numerical stability and effectiveness of the PML implementation.\n\n**Task 3: Computations for Test Cases**\n\nFor each test case, we compute the required physical outputs $[L, \\sigma_{\\max}, \\Delta x, N_{\\mathrm{pml}}, R_{\\mathrm{est}}, A_{\\mathrm{out}}]$. The procedure, using the relations derived and specified above, is as follows:\n\n1.  **Angular Frequency, $\\omega$**: Given frequency $f$ in Hz, compute $\\omega = 2\\pi f$.\n2.  **Mesh Spacing, $\\Delta x$**: Using the rule from Task 2, compute $\\Delta x = \\frac{2\\pi v_{\\min}}{\\omega\\,n_{\\mathrm{ppw}}} = \\frac{v_{\\min}}{f\\,n_{\\mathrm{ppw}}}$.\n3.  **PML Thickness, $L$**: Using the rule from Task 2, compute $L = N_{\\mathrm{pml}} \\Delta x$.\n4.  **Maximum Damping, $\\sigma_{\\max}$**: Using the calibration rule from Task 1, compute $\\sigma_{\\max} = -\\frac{v_{\\min}(m+1)}{2L} \\ln(R_{\\mathrm{target}})$.\n5.  **Number of PML Cells, $N_{\\mathrm{pml}}$**: This is an input parameter and is reported directly.\n6.  **Estimated Reflection, $R_{\\mathrm{est}}$**: The calculation is based on $R_{\\mathrm{est}} = \\exp(-2 \\int_{0}^{L} \\frac{\\sigma(x)}{v_{\\min}} dx)$. From the derivation in Task 1, the integral is designed to be $\\int_{0}^{L} \\frac{\\sigma(x)}{v_{\\min}} dx = -\\frac{1}{2} \\ln(R_{\\mathrm{target}})$. Substituting this gives $R_{\\mathrm{est}} = \\exp(-2 \\cdot [-\\frac{1}{2} \\ln(R_{\\mathrm{target}})]) = \\exp(\\ln(R_{\\mathrm{target}})) = R_{\\mathrm{target}}$. Thus, the estimated reflection is, by design, identical to the target reflection.\n7.  **Output Amplitude, $A_{\\mathrm{out}}$**: The calculation is based on $A_{\\mathrm{out}} = A_{\\mathrm{in}} \\exp(-\\int_{0}^{L} \\frac{\\sigma(x)}{v_{\\min}} dx)$. Using the same integral expression, we get $A_{\\mathrm{out}} = A_{\\mathrm{in}} \\exp(-[-\\frac{1}{2} \\ln(R_{\\mathrm{target}})]) = A_{\\mathrm{in}} \\exp(\\frac{1}{2} \\ln(R_{\\mathrm{target}})) = A_{\\mathrm{in}} \\exp(\\ln(R_{\\mathrm{target}}^{1/2})) = A_{\\mathrm{in}}\\sqrt{R_{\\mathrm{target}}}$. This result shows that the one-way attenuation factor is the square root of the two-way reflection coefficient.\n\nThese steps are applied to each test case to generate the final numerical results. All floating-point outputs are rounded to six decimal places as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PML calibration problem for a suite of test cases.\n    \"\"\"\n\n    # Test cases defined as tuples:\n    # (v_min, f, R_target, m, n_ppw, N_pml, A_in)\n    test_cases = [\n        (800, 5, 1e-4, 3, 12, 12, 1e6),\n        (600, 20, 1e-6, 4, 14, 16, 5e6),\n        (300, 10, 1e-5, 2, 10, 20, 2e6),\n        (700, 1, 1e-3, 3, 8, 10, 1e7),\n    ]\n\n    results = []\n    for case in test_cases:\n        v_min, f, R_target, m, n_ppw, N_pml, A_in = case\n\n        # Task 2: Propose frequency-dependent meshing rule.\n        # Although the problem asks to calculate omega, the 2*pi cancels out.\n        # omega = 2 * np.pi * f\n        # delta_x = (2 * np.pi * v_min) / (omega * n_ppw)\n        delta_x = v_min / (f * n_ppw)\n        \n        # PML thickness L depends on the number of cells and mesh spacing.\n        L = N_pml * delta_x\n\n        # Task 1: Derive the calibration rule for sigma_max.\n        # sigma_max = - (v_min * (m + 1)) / (2 * L) * ln(R_target)\n        # We use np.log for the natural logarithm (ln).\n        sigma_max = - (v_min * (m + 1)) / (2 * L) * np.log(R_target)\n\n        # Task 3: Compute the remaining outputs.\n        \n        # The estimated entrance reflection R_est is, by design, equal to R_target.\n        R_est = R_target\n\n        # The attenuated amplitude at the back of the PML, A_out, can be\n        # calculated from R_target.\n        # A_out = A_in * exp(-integral) and R_target = exp(-2*integral)\n        # So, integral = -0.5 * ln(R_target)\n        # A_out = A_in * exp(0.5 * ln(R_target)) = A_in * exp(ln(sqrt(R_target)))\n        # A_out = A_in * sqrt(R_target)\n        A_out = A_in * np.sqrt(R_target)\n\n        # Assemble the results for this case. N_pml is an integer.\n        # All other floating-point results must be rounded to 6 decimal places.\n        case_result = [\n            round(L, 6),\n            round(sigma_max, 6),\n            round(delta_x, 6),\n            N_pml,\n            round(R_est, 6),\n            round(A_out, 6)\n        ]\n        results.append(case_result)\n\n    # Format the final output string exactly as specified.\n    # e.g., [[val1,val2,...],[val1,val2,...]]\n    output_str_parts = []\n    for res in results:\n        # Format each value in the list, handling the integer N_pml separately.\n        # Using f-strings for controlled precision formatting.\n        formatted_res = (\n            f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{res[3]},\"\n            f\"{res[4]:.6f},{res[5]:.6f}]\"\n        )\n        output_str_parts.append(formatted_res)\n    \n    final_output = f\"[{','.join(output_str_parts)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Optimal PML design involves navigating a delicate trade-off between competing sources of error. A damping profile that starts too abruptly creates spurious numerical reflections at the interface with the physical domain, while a profile that is too gradual requires an impractically thick layer to achieve sufficient attenuation. This advanced practice  frames this challenge as a minimax optimization problem, where the goal is to find the ideal polynomial damping profile that minimizes the worst-case reflection across a range of wave frequencies and incidence angles, balancing the errors from interface reflection and finite-thickness back-reflection.",
            "id": "3612708",
            "problem": "Consider a two-dimensional acoustic wave in a homogeneous exterior medium of speed $c$ that is truncated by a Perfectly Matched Layer (PML). The PML occupies the region $x \\in [0,L]$ adjacent to the truncation boundary at $x=L$; the physical domain is at $x0$ and the PML is attached at $x=0$. Let the PML be defined by a polynomial damping profile $\\sigma(x) = \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^{m}$ for $x \\in [0,L]$, where $m \\in \\mathbb{N}$ is the polynomial degree, $\\sigma_{\\max} > 0$ is the peak damping (with units $\\mathrm{s}^{-1}$), and $L>0$ is the fixed thickness (with units $\\mathrm{m}$). Suppose a plane wave of angular frequency $\\omega$ and incidence angle $\\theta \\in [0,\\theta_{\\max}]$ with respect to the inward normal to the PML enters the PML from $x=0$.\n\nStarting from the frequency-domain coordinate stretching formulation of a Perfectly Matched Layer (PML), where the $x$-derivative is replaced by $s_x^{-1}(x,\\omega)\\,\\partial_x$ with $s_x(x,\\omega)=1+\\mathrm{i}\\,\\sigma(x)/\\omega$, and from the definition of a plane wave with $x$-wavenumber $k_x = (\\omega/c)\\cos\\theta$, derive a tractable model for the worst-case reflection amplitude at the entrance of the PML due to two mechanisms:\n- finite-thickness back-reflection from the truncation at $x=L$, and\n- discrete-grid interface reflection at $x=0$ caused by the fact that in a numerical scheme the PML is sampled on a grid with spacing $\\Delta x$.\n\nYour derivation must begin with the stated coordinate stretching and the plane-wave representation, and proceed by identifying the attenuation factor associated with propagation through the PML and back, and by proposing a dimensionally consistent, incidence-angle-sensitive proxy for the discrete interface reflection that depends on the first interior sample of $\\sigma(x)$ at $x=\\Delta x/2$. You may assume a finite-difference discretization in which spurious interface reflection grows with the local non-dimensional damping ratio at the first cell and vanishes at normal incidence.\n\nUsing this modeling framework, define:\n- a back-reflection amplitude $R_{\\mathrm{back}}(\\theta;\\,m,L,\\sigma_{\\max},c)$ that results from a round-trip traversal of the PML of thickness $L$ by a ray with incidence angle $\\theta$, expressed in terms of a one-dimensional integral over $\\sigma(x)$, and\n- an interface-reflection amplitude $R_{\\mathrm{if}}(\\theta,\\omega;\\,m,L,\\sigma_{\\max},\\Delta x)$ that depends on the first-cell-center value $\\sigma(\\Delta x/2)$, the angular frequency $\\omega$, and $\\theta$, and which vanishes at $\\theta=0$.\n\nDefine the total reflection model as $R(\\theta,\\omega)=\\min\\{1,\\,R_{\\mathrm{back}}(\\theta)+R_{\\mathrm{if}}(\\theta,\\omega)\\}$, and formalize the discrete minimax design problem for the polynomial degree $m \\in \\{1,2,\\dots,M_{\\max}\\}$ that minimizes $\\max_{(\\theta,\\omega)\\in \\Omega} R(\\theta,\\omega)$ for a given discrete test set $\\Omega$ of incidence angles and angular frequencies.\n\nImplement a program that, for each parameter set in the test suite below, searches over $m \\in \\{1,2,\\dots,M_{\\max}\\}$ and returns the integer $m^{\\star}$ that minimizes the maximum total reflection over the supplied discrete set $\\Omega$, together with the corresponding worst-case reflection value. In case of a tie, select the smallest $m$.\n\nYour program must adopt the following modeling choices consistent with the derivation:\n- Use the frequency-domain coordinate stretching $s_x(x,\\omega)=1+\\mathrm{i}\\,\\sigma(x)/\\omega$ to show that the amplitude attenuation along $x$ for a plane wave with incidence angle $\\theta$ is governed by $\\int_0^L \\mathrm{Im}\\,s_x(x,\\omega)\\,\\mathrm{d}x = \\int_0^L \\sigma(x)/\\omega\\,\\mathrm{d}x$, and that the corresponding round-trip back-reflection amplitude may be modeled as\n$$\nR_{\\mathrm{back}}(\\theta;\\,m,L,\\sigma_{\\max},c) \\;=\\; \\exp\\!\\left(-\\dfrac{2 \\cos\\theta}{c}\\int_0^L \\sigma(x)\\,\\mathrm{d}x\\right).\n$$\n- Model the discrete interface reflection amplitude by the angle- and frequency-dependent proxy\n$$\nR_{\\mathrm{if}}(\\theta,\\omega;\\,m,L,\\sigma_{\\max},\\Delta x)\\;=\\;\\left(\\dfrac{\\sigma(\\Delta x/2)}{\\omega}\\right)^{2}\\,\\sin^{2}\\theta,\n$$\nwhich captures that interface reflection increases with larger non-dimensional local damping at the first interior node and with obliquity.\n- Combine these to define\n$$\nR(\\theta,\\omega)\\;=\\;\\min\\!\\left\\{\\,1,\\; R_{\\mathrm{back}}(\\theta)+R_{\\mathrm{if}}(\\theta,\\omega)\\,\\right\\}.\n$$\n\nAll physical quantities must be expressed in the following units: $L$ and $\\Delta x$ in $\\mathrm{m}$, $c$ in $\\mathrm{m/s}$, $\\sigma_{\\max}$ in $\\mathrm{s}^{-1}$, and $\\omega$ in $\\mathrm{rad/s}$. Angles $\\theta$ must be specified in radians.\n\nTest suite. For each case, search $m \\in \\{1,2,\\dots,M_{\\max}\\}$ using the specified discrete sets of angles and frequencies $\\Omega = \\{(\\theta,\\omega)\\}$:\n- Case A (happy path):\n    - $c = 2000\\,\\mathrm{m/s}$, $L=200\\,\\mathrm{m}$, $\\sigma_{\\max}=200\\,\\mathrm{s}^{-1}$, $\\Delta x=10\\,\\mathrm{m}$, $M_{\\max}=10$,\n    - $\\Theta=\\{0,\\;\\pi/6,\\;\\pi/3\\}$,\n    - $\\Omega_{\\omega}=\\{2\\pi\\cdot 5,\\;2\\pi\\cdot 20\\}\\,\\mathrm{rad/s}$.\n- Case B (thinner PML and finer grid; boundary-leaning):\n    - $c = 1500\\,\\mathrm{m/s}$, $L=100\\,\\mathrm{m}$, $\\sigma_{\\max}=200\\,\\mathrm{s}^{-1}$, $\\Delta x=2\\,\\mathrm{m}$, $M_{\\max}=12$,\n    - $\\Theta=\\{0,\\;\\pi/12,\\;\\pi/6\\}$,\n    - $\\Omega_{\\omega}=\\{2\\pi\\cdot 2,\\;2\\pi\\cdot 10,\\;2\\pi\\cdot 30\\}\\,\\mathrm{rad/s}$.\n- Case C (thick and strong PML; edge challenge with oblique angles):\n    - $c = 2500\\,\\mathrm{m/s}$, $L=300\\,\\mathrm{m}$, $\\sigma_{\\max}=400\\,\\mathrm{s}^{-1}$, $\\Delta x=15\\,\\mathrm{m}$, $M_{\\max}=12$,\n    - $\\Theta=\\{0,\\;\\pi/8,\\;3\\pi/8\\}$,\n    - $\\Omega_{\\omega}=\\{2\\pi\\cdot 1,\\;2\\pi\\cdot 15\\}\\,\\mathrm{rad/s}$.\n\nRequired final output. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each case, output the optimal integer $m^{\\star}$ followed by the corresponding worst-case reflection value rounded to six decimal places. The final output should therefore be of the form\n$[m^{\\star}_{\\mathrm{A}},R^{\\star}_{\\mathrm{A}},m^{\\star}_{\\mathrm{B}},R^{\\star}_{\\mathrm{B}},m^{\\star}_{\\mathrm{C}},R^{\\star}_{\\mathrm{C}}]$,\nwhere $R^{\\star}$ denotes the minimized maximum of $R(\\theta,\\omega)$ over the specified discrete set $\\Omega$ for each case. All angles are in radians and all frequencies are in $\\mathrm{rad/s}$. Ensure that the program requires no input and prints only this single line.",
            "solution": "The posed problem requires the determination of an optimal polynomial degree $m$ for a Perfectly Matched Layer (PML) damping profile, $\\sigma(x)$, by minimizing the worst-case reflection coefficient over a specified range of incidence angles and frequencies. The total reflection is modeled as a sum of two contributions: back-reflection from the finite thickness of the layer and spurious interface reflection due to numerical discretization. We begin by formalizing the models for these two reflection mechanisms based on the provided physical principles.\n\nThe PML is defined by a coordinate stretching in the frequency domain, where the spatial derivative operator $\\partial_x$ is replaced by $s_x^{-1}(x,\\omega)\\,\\partial_x$. The complex stretching factor is given by $s_x(x,\\omega)=1+\\mathrm{i}\\,\\sigma(x)/\\omega$, where $\\sigma(x)$ is the damping profile. A plane wave propagating through the medium has a spatial dependence of the form $\\exp(\\mathrm{i}(k_x x + k_y y))$, where $k_x = (\\omega/c)\\cos\\theta$ and $k_y = (\\omega/c)\\sin\\theta$ are the wavenumber components for an incidence angle $\\theta$.\n\nInside the PML, the effective wavenumber in the $x$-direction is modified. The propagation term related to the $x$-direction, $\\mathrm{i}k_x x$, is transformed to $\\mathrm{i}k_x \\int_0^x s_x(\\xi,\\omega)\\,\\mathrm{d}\\xi$. Substituting the expression for $s_x(\\xi,\\omega)$, we have:\n$$\n\\mathrm{i} k_x \\int_0^x \\left(1 + \\frac{\\mathrm{i}\\sigma(\\xi)}{\\omega}\\right) \\mathrm{d}\\xi = \\mathrm{i} k_x \\int_0^x \\mathrm{d}\\xi - \\frac{k_x}{\\omega} \\int_0^x \\sigma(\\xi)\\,\\mathrm{d}\\xi = \\mathrm{i} k_x x - \\frac{k_x}{\\omega} \\int_0^x \\sigma(\\xi)\\,\\mathrm{d}\\xi\n$$\nSubstituting $k_x = (\\omega/c)\\cos\\theta$, the second term becomes $-\\frac{\\cos\\theta}{c}\\int_0^x \\sigma(\\xi)\\,\\mathrm{d}\\xi$. This term is purely real and negative, representing exponential decay of the wave amplitude as it propagates into the PML. The amplitude of a wave after traversing a distance $L$ through the PML is thus attenuated by a factor $A$, given by:\n$$\nA = \\exp\\left(-\\frac{\\cos\\theta}{c}\\int_0^L \\sigma(x)\\,\\mathrm{d}x\\right)\n$$\n\nThe first reflection mechanism, $R_{\\mathrm{back}}$, arises from the reflection of the wave at the truncation boundary $x=L$ and its subsequent propagation back to the interface at $x=0$. The wave traverses the PML thickness $L$ twice (once forward, once back), and is thus attenuated by a factor of $A$ on each pass. The total amplitude reduction, which defines the back-reflection coefficient, is therefore $A^2$.\n$$\nR_{\\mathrm{back}}(\\theta; m, L, \\sigma_{\\max}, c) = A^2 = \\exp\\left(-\\frac{2\\cos\\theta}{c}\\int_0^L \\sigma(x)\\,\\mathrm{d}x\\right)\n$$\nThe damping profile is specified as $\\sigma(x) = \\sigma_{\\max} (x/L)^m$. We can evaluate the integral analytically:\n$$\n\\int_0^L \\sigma(x)\\,\\mathrm{d}x = \\int_0^L \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m \\mathrm{d}x = \\frac{\\sigma_{\\max}}{L^m} \\left[\\frac{x^{m+1}}{m+1}\\right]_0^L = \\frac{\\sigma_{\\max}L^{m+1}}{L^m(m+1)} = \\frac{\\sigma_{\\max}L}{m+1}\n$$\nSubstituting this result into the expression for $R_{\\mathrm{back}}$ yields the final model:\n$$\nR_{\\mathrm{back}}(\\theta; m) = \\exp\\left(-\\frac{2\\sigma_{\\max}L\\cos\\theta}{c(m+1)}\\right)\n$$\nThis expression is independent of the frequency $\\omega$.\n\nThe second reflection mechanism, $R_{\\mathrm{if}}$, is a numerical artifact originating from the discrete transition at the interface $x=0$. The problem provides a physically motivated proxy model for this reflection:\n$$\nR_{\\mathrm{if}}(\\theta,\\omega; m, L, \\sigma_{\\max}, \\Delta x) = \\left(\\frac{\\sigma(\\Delta x/2)}{\\omega}\\right)^2 \\sin^2\\theta\n$$\nThis model posits that the interface reflection is proportional to the square of the non-dimensional damping parameter, $\\sigma/\\omega$, evaluated at the center of the first grid cell, $x=\\Delta x/2$. The term $\\sin^2\\theta$ correctly enforces that this spurious reflection vanishes at normal incidence ($\\theta=0$) and increases with obliquity. We evaluate $\\sigma(\\Delta x/2)$ using the given profile:\n$$\n\\sigma(\\Delta x/2) = \\sigma_{\\max}\\left(\\frac{\\Delta x/2}{L}\\right)^m = \\sigma_{\\max}\\left(\\frac{\\Delta x}{2L}\\right)^m\n$$\nThus, the interface reflection model is:\n$$\nR_{\\mathrm{if}}(\\theta,\\omega; m) = \\left(\\frac{\\sigma_{\\max}}{\\omega}\\left(\\frac{\\Delta x}{2L}\\right)^m\\right)^2 \\sin^2\\theta\n$$\n\nThe total reflection $R$ is the sum of these two contributions, capped at a maximum value of $1$:\n$$\nR(\\theta,\\omega; m) = \\min\\left\\{1, R_{\\mathrm{back}}(\\theta; m) + R_{\\mathrm{if}}(\\theta,\\omega; m)\\right\\}\n$$\nThe optimization problem is to find the integer polynomial degree $m^{\\star} \\in \\{1, 2, \\dots, M_{\\max}\\}$ that minimizes the maximum reflection over the discrete set of test cases $\\Omega = \\{(\\theta_i, \\omega_j)\\}$. This is a discrete minimax problem:\n$$\nm^{\\star} = \\arg\\min_{m \\in \\{1, \\dots, M_{\\max}\\}} \\left( \\max_{(\\theta, \\omega) \\in \\Omega} R(\\theta, \\omega; m) \\right)\n$$\nThe corresponding minimum worst-case reflection is $R^{\\star}$. An increase in $m$ concentrates the damping near $x=L$. This decreases $\\int\\sigma(x)\\mathrm{d}x$ (proportional to $1/(m+1)$), which increases $R_{\\mathrm{back}}$. However, it also strongly decreases $\\sigma(\\Delta x/2)$ (proportional to $(\\Delta x/2L)^m$), which reduces $R_{\\mathrm{if}}$. The optimal $m^{\\star}$ represents the best trade-off between these two competing effects for the given set of parameters and test conditions.\n\nThe algorithm to solve this problem is as follows: For each test case, we iterate through each possible integer value of $m$ from $1$ to $M_{\\max}$. For each $m$, we compute $R(\\theta, \\omega; m)$ for all pairs of $(\\theta, \\omega)$ in the specified discrete set $\\Omega$, and find the maximum value, $R_{\\max}(m)$. We then find the value of $m$ that yields the minimum $R_{\\max}(m)$, which we denote $m^{\\star}$. In case of a tie, the smallest $m$ is chosen. This procedure is implemented for each of the three test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PML optimization problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        {\n            'name': 'A',\n            'c': 2000.0,\n            'L': 200.0,\n            'sigma_max': 200.0,\n            'dx': 10.0,\n            'M_max': 10,\n            'thetas': [0.0, np.pi/6, np.pi/3],\n            'omegas': [2 * np.pi * 5.0, 2 * np.pi * 20.0]\n        },\n        {\n            'name': 'B',\n            'c': 1500.0,\n            'L': 100.0,\n            'sigma_max': 200.0,\n            'dx': 2.0,\n            'M_max': 12,\n            'thetas': [0.0, np.pi/12, np.pi/6],\n            'omegas': [2 * np.pi * 2.0, 2 * np.pi * 10.0, 2 * np.pi * 30.0]\n        },\n        {\n            'name': 'C',\n            'c': 2500.0,\n            'L': 300.0,\n            'sigma_max': 400.0,\n            'dx': 15.0,\n            'M_max': 12,\n            'thetas': [0.0, np.pi/8, 3 * np.pi/8],\n            'omegas': [2 * np.pi * 1.0, 2 * np.pi * 15.0]\n        }\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        c = case['c']\n        L = case['L']\n        sigma_max = case['sigma_max']\n        dx = case['dx']\n        M_max = case['M_max']\n        thetas = case['thetas']\n        omegas = case['omegas']\n\n        min_max_R = float('inf')\n        optimal_m = -1\n\n        # Search over polynomial degree m\n        for m in range(1, M_max + 1):\n            current_max_R = 0.0\n\n            # Evaluate over the discrete set Omega\n            for theta in thetas:\n                # Calculate R_back (independent of omega)\n                integral_sigma = sigma_max * L / (m + 1.0)\n                R_back = np.exp(-2.0 * integral_sigma * np.cos(theta) / c)\n\n                for omega in omegas:\n                    # Calculate R_if\n                    # Handle theta=0 case where sin(theta)=0 to avoid unnecessary power calculations\n                    if theta == 0.0:\n                        R_if = 0.0\n                    else:\n                        sigma_at_half_dx = sigma_max * np.power(dx / (2.0 * L), m)\n                        R_if = np.power(sigma_at_half_dx / omega, 2.0) * np.power(np.sin(theta), 2.0)\n                    \n                    # Calculate total reflection\n                    R_total = min(1.0, R_back + R_if)\n                    \n                    if R_total > current_max_R:\n                        current_max_R = R_total\n\n            # Check if this m gives a better worst-case reflection\n            if current_max_R  min_max_R:\n                min_max_R = current_max_R\n                optimal_m = m\n        \n        final_results.append(str(optimal_m))\n        final_results.append(f\"{min_max_R:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```"
        }
    ]
}