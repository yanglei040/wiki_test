{
    "hands_on_practices": [
        {
            "introduction": "The first step in constructing a finite volume solver is to correctly define the discrete domain. This exercise challenges you to formalize the geometry of a cell-centered control volume on a Cartesian grid, which is the fundamental building block for the method. A precise definition of cell boundaries, face areas, and outward-pointing normal vectors is critical for accurately applying the divergence theorem and ensuring your numerical scheme is conservative.",
            "id": "3595982",
            "problem": "In computational geophysics, the Finite Volume Method (FVM) for the advection-diffusion equation begins from the integral conservation law and the divergence theorem. Let $\\,\\phi(\\mathbf{x},t)\\,$ be a scalar tracer, $\\,\\mathbf{u}(\\mathbf{x},t)\\,$ a velocity field, $\\,\\kappa(\\mathbf{x},t)\\,$ a (possibly anisotropic but here treated as an effective scalar) diffusivity, and $\\,s(\\mathbf{x},t)\\,$ a source. Over any fixed control volume $\\,V\\,$ with boundary $\\,\\partial V\\,$ and outward unit normal $\\,\\mathbf{n}\\,$, conservation requires the balance of the time rate of change of $\\,\\phi\\,$ and the net advective-diffusive flux through $\\,\\partial V\\,$ against sources. To convert the surface integrals into face-based flux sums on a structured Cartesian grid, one must construct cell-centered control volumes and enumerate the faces with consistent outward unit normals and face areas.\n\nConsider a structured Cartesian grid with uniform spacings $\\,\\Delta x\\,$, $\\,\\Delta y\\,$, $\\,\\Delta z\\,$. Let the cell centers be located at coordinates $\\,(x_i,y_j,z_k)\\,$ for integer indices $\\,i,j,k\\,$. For the cell centered at $\\,(x_i,y_j,z_k)\\,$, select the option that correctly specifies:\n\n- the cell-centered control volume as a rectangular box aligned with the coordinate axes,\n- the locations of its $\\,6\\,$ planar faces (including face-center coordinates),\n- the outward unit normals $\\,\\mathbf{n}\\,$ on each face consistent with the divergence theorem,\n- and the face areas to be used in flux calculations,\n\ntogether with a consistent mapping to the neighboring cell indices for each face.\n\nA. The control volume is the box\n$$[\\,x_i-\\tfrac{\\Delta x}{2},\\,x_i+\\tfrac{\\Delta x}{2}\\,]\\times[\\,y_j-\\tfrac{\\Delta y}{2},\\,y_j+\\tfrac{\\Delta y}{2}\\,]\\times[\\,z_k-\\tfrac{\\Delta z}{2},\\,z_k+\\tfrac{\\Delta z}{2}\\,].$$\nIts $\\,6\\,$ faces are:\n- West $\\,(\\mathrm{W})\\,$ at $\\,x=x_i-\\tfrac{\\Delta x}{2}\\,$ with face center $\\,(x_i-\\tfrac{\\Delta x}{2},y_j,z_k)\\,$, outward unit normal $\\,\\mathbf{n}_{\\mathrm{W}}=(-1,0,0)\\,$, area $\\,A_{\\mathrm{W}}=\\Delta y\\,\\Delta z\\,$, neighbor index $\\, (i-1,j,k)\\,$.\n- East $\\,(\\mathrm{E})\\,$ at $\\,x=x_i+\\tfrac{\\Delta x}{2}\\,$ with face center $\\,(x_i+\\tfrac{\\Delta x}{2},y_j,z_k)\\,$, outward unit normal $\\,\\mathbf{n}_{\\mathrm{E}}=(1,0,0)\\,$, area $\\,A_{\\mathrm{E}}=\\Delta y\\,\\Delta z\\,$, neighbor index $\\, (i+1,j,k)\\,$.\n- South $\\,(\\mathrm{S})\\,$ at $\\,y=y_j-\\tfrac{\\Delta y}{2}\\,$ with face center $\\,(x_i,y_j-\\tfrac{\\Delta y}{2},z_k)\\,$, outward unit normal $\\,\\mathbf{n}_{\\mathrm{S}}=(0,-1,0)\\,$, area $\\,A_{\\mathrm{S}}=\\Delta x\\,\\Delta z\\,$, neighbor index $\\, (i,j-1,k)\\,$.\n- North $\\,(\\mathrm{N})\\,$ at $\\,y=y_j+\\tfrac{\\Delta y}{2}\\,$ with face center $\\,(x_i,y_j+\\tfrac{\\Delta y}{2},z_k)\\,$, outward unit normal $\\,\\mathbf{n}_{\\mathrm{N}}=(0,1,0)\\,$, area $\\,A_{\\mathrm{N}}=\\Delta x\\,\\Delta z\\,$, neighbor index $\\, (i,j+1,k)\\,$.\n- Bottom $\\,(\\mathrm{B})\\,$ at $\\,z=z_k-\\tfrac{\\Delta z}{2}\\,$ with face center $\\,(x_i,y_j,z_k-\\tfrac{\\Delta z}{2})\\,$, outward unit normal $\\,\\mathbf{n}_{\\mathrm{B}}=(0,0,-1)\\,$, area $\\,A_{\\mathrm{B}}=\\Delta x\\,\\Delta y\\,$, neighbor index $\\, (i,j,k-1)\\,$.\n- Top $\\,(\\mathrm{T})\\,$ at $\\,z=z_k+\\tfrac{\\Delta z}{2}\\,$ with face center $\\,(x_i,y_j,z_k+\\tfrac{\\Delta z}{2})\\,$, outward unit normal $\\,\\mathbf{n}_{\\mathrm{T}}=(0,0,1)\\,$, area $\\,A_{\\mathrm{T}}=\\Delta x\\,\\Delta y\\,$, neighbor index $\\, (i,j,k+1)\\,$.\nThese choices ensure that the discrete divergence is formed by summing $\\,\\text{flux}\\times A\\,$ with outward sign convention.\n\nB. The control volume is the box\n$$[\\,x_i,\\,x_{i+1}\\,]\\times[\\,y_j,\\,y_{j+1}\\,]\\times[\\,z_k,\\,z_{k+1}\\,],$$\nwith West and East faces at $\\,x=x_i\\,$ and $\\,x=x_{i+1}\\,$, both assigned outward unit normals $\\,\\mathbf{n}_{\\mathrm{W}}=\\mathbf{n}_{\\mathrm{E}}=(1,0,0)\\,$ and areas $\\,A_{\\mathrm{W}}=A_{\\mathrm{E}}=\\Delta x\\,\\Delta y\\,$; similarly for the $\\,y\\,$- and $\\,z\\,$-faces. Face centers are taken at neighbor centers, e.g., $\\,(x_{i\\pm1},y_j,z_k)\\,$, and neighbor indices are $\\, (i\\pm1,j,k)\\,$ for the $\\,x\\,$-faces, etc.\n\nC. The control volume is\n$$[\\,x_i-\\tfrac{\\Delta x}{2},\\,x_i+\\tfrac{\\Delta x}{2}\\,]\\times[\\,y_j-\\tfrac{\\Delta y}{2},\\,y_j+\\tfrac{\\Delta y}{2}\\,]\\times[\\,z_k-\\tfrac{\\Delta z}{2},\\,z_k+\\tfrac{\\Delta z}{2}\\,],$$\nwith face centers as in option A, but the outward unit normals are chosen as $\\,\\mathbf{n}_{\\mathrm{E}}=(-1,0,0)\\,$, $\\,\\mathbf{n}_{\\mathrm{W}}=(1,0,0)\\,$, $\\,\\mathbf{n}_{\\mathrm{N}}=(0,-1,0)\\,$, $\\,\\mathbf{n}_{\\mathrm{S}}=(0,1,0)\\,$, $\\,\\mathbf{n}_{\\mathrm{T}}=(0,0,-1)\\,$, $\\,\\mathbf{n}_{\\mathrm{B}}=(0,0,1)\\,$. Face areas are $\\,A_{\\mathrm{E}}=A_{\\mathrm{W}}=\\Delta y\\,\\Delta z\\,$, $\\,A_{\\mathrm{N}}=A_{\\mathrm{S}}=\\Delta x\\,\\Delta z\\,$, $\\,A_{\\mathrm{T}}=A_{\\mathrm{B}}=\\Delta x\\,\\Delta y\\,$, and neighbor indices correspond to $\\, (i\\pm1,j,k)\\,$, $\\, (i,j\\pm1,k)\\,$, $\\, (i,j,k\\pm1)\\,$.\n\nD. The control volume is\n$$[\\,x_i-\\tfrac{\\Delta x}{2},\\,x_i+\\tfrac{\\Delta x}{2}\\,]\\times[\\,y_j-\\tfrac{\\Delta y}{2},\\,y_j+\\tfrac{\\Delta y}{2}\\,]\\times[\\,z_k-\\tfrac{\\Delta z}{2},\\,z_k+\\tfrac{\\Delta z}{2}\\,],$$\nwith outward unit normals as in option A, but with face areas taken as $\\,A_{\\mathrm{E}}=A_{\\mathrm{W}}=\\Delta x\\,\\Delta y\\,$, $\\,A_{\\mathrm{N}}=A_{\\mathrm{S}}=\\Delta y\\,\\Delta z\\,$, $\\,A_{\\mathrm{T}}=A_{\\mathrm{B}}=\\Delta x\\,\\Delta z\\,$. Face centers and neighbor indices follow the same pattern as in option A.\n\nSelect the correct option.",
            "solution": "The user has requested a critical validation of the problem statement, followed by a detailed solution and evaluation of the provided options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Method**: Finite Volume Method (FVM) for the advection-diffusion equation.\n- **Context**: Integral conservation law and the divergence theorem.\n- **Physical Quantities**: Scalar tracer $\\,\\phi(\\mathbf{x},t)\\,$, velocity field $\\,\\mathbf{u}(\\mathbf{x},t)\\,$, diffusivity $\\,\\kappa(\\mathbf{x},t)\\,$, source term $\\,s(\\mathbf{x},t)\\,$.\n- **Domain**: A fixed control volume $\\,V\\,$ with boundary $\\,\\partial V\\,$ and outward unit normal $\\,\\mathbf{n}\\,$.\n- **Grid**: Structured Cartesian grid with uniform spacings $\\,\\Delta x\\,$, $\\,\\Delta y\\,$, $\\,\\Delta z\\,$.\n- **Discretization**: Cell-centered, with cell centers at coordinates $\\,(x_i,y_j,z_k)\\,$ for integer indices $\\,i,j,k\\,$.\n- **Objective**: For the cell centered at $\\,(x_i,y_j,z_k)\\,$, identify the option that correctly specifies the control volume, face locations and centers, outward unit normals, face areas, and neighbor indices.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem describes the fundamental geometric setup for a cell-centered Finite Volume Method on a structured Cartesian grid. This is a standard, canonical topic in numerical methods for partial differential equations, particularly in computational fluid dynamics and related fields like computational geophysics. The concepts are scientifically sound and established.\n- **Well-Posedness**: The question asks to identify the correct set of definitions from a list of options. For a standard cell-centered FVM, there is a single, unambiguous way to define the control volume, its faces, normals, and areas. Therefore, a unique, correct answer exists.\n- **Objectivity**: The problem is stated using precise, standard, and objective terminology from numerical analysis. There are no subjective or ambiguous terms.\n\n**Flaw Checklist**:\n1.  **Scientific/Factual Unsoundness**: None. The premise is based on standard numerical methods.\n2.  **Non-Formalizable/Irrelevant**: None. The problem is a formal exercise in defining the discrete geometry for FVM.\n3.  **Incomplete/Contradictory Setup**: None. The problem provides sufficient information to uniquely define the geometric elements.\n4.  **Unrealistic/Infeasible**: None. The setup is a standard, idealized grid used in countless simulations.\n5.  **Ill-Posed/Poorly Structured**: None. The question is clear and has a unique answer.\n6.  **Pseudo-Profound/Trivial**: None. While definitional, a correct understanding of these geometric elements is critical for implementing a correct and conservative numerical scheme. It is a fundamental concept, not a trivial one.\n7.  **Outside Scientific Verifiability**: None. The definitions are based on verifiable geometric and mathematical principles.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed with deriving the solution and evaluating the options.\n\n### Derivation of the Correct Finite Volume Definition\n\nIn a cell-centered Finite Volume Method on a structured Cartesian grid, the discrete value $\\,\\phi_{i,j,k}\\,$ is associated with the cell centered at the grid node $\\,(x_i,y_j,z_k)\\,$. The control volume, $\\,V_{i,j,k}\\,$, is the rectangular prism (box) that encloses this point and extends halfway to the neighboring nodes in each coordinate direction.\n\n1.  **Control Volume Definition**:\n    The grid nodes are separated by $\\,\\Delta x, \\Delta y, \\Delta z\\,$. The cell center for index $\\,(i,j,k)\\,$ is $\\,(x_i, y_j, z_k)\\,$. The neighboring cell centers in the x-direction are at $\\,x_{i-1} = x_i - \\Delta x\\,$ and $\\,x_{i+1} = x_i + \\Delta x\\,$. The boundary (face) between cell $\\,i\\,$ and cell $\\,i+1\\,$ must be located midway between their centers, i.e., at $\\,x_i + \\frac{\\Delta x}{2}\\,$. Similarly, the boundary between cell $\\,i\\,$ and cell $\\,i-1\\,$ is at $\\,x_i - \\frac{\\Delta x}{2}\\,$. Applying this principle in all three dimensions defines the control volume for cell $\\,(i,j,k)\\,$ as the box:\n    $$V_{i,j,k} = [\\,x_i-\\tfrac{\\Delta x}{2},\\,x_i+\\tfrac{\\Delta x}{2}\\,]\\times[\\,y_j-\\tfrac{\\Delta y}{2},\\,y_j+\\tfrac{\\Delta y}{2}\\,]\\times[\\,z_k-\\tfrac{\\Delta z}{2},\\,z_k+\\tfrac{\\Delta z}{2}\\,]$$\n\n2.  **Face Properties (Location, Center, Normal, Area)**:\n    The control volume $\\,V_{i,j,k}\\,$ has six planar faces. The problem uses the compass notation (East, West, North, South, Top, Bottom). The divergence theorem requires the use of *outward* pointing unit normal vectors.\n\n    -   **East Face ($\\mathrm{E}$)**: This face separates cell $\\,(i,j,k)\\,$ from cell $\\,(i+1,j,k)\\,$.\n        -   Location: The plane $\\,x = x_i+\\tfrac{\\Delta x}{2}\\,$.\n        -   Face Center: $\\,(x_i+\\tfrac{\\Delta x}{2}, y_j, z_k)\\,$.\n        -   Outward Normal: Points in the positive x-direction, $\\,\\mathbf{n}_{\\mathrm{E}}=(1,0,0)\\,$.\n        -   Area: The face is a rectangle in the y-z plane with dimensions $\\,\\Delta y \\times \\Delta z\\,$. Thus, $\\,A_{\\mathrm{E}}=\\Delta y\\,\\Delta z\\,$.\n        -   Neighbor Index: $\\,(i+1,j,k)\\,$.\n\n    -   **West Face ($\\mathrm{W}$)**: This face separates cell $\\,(i,j,k)\\,$ from cell $\\,(i-1,j,k)\\,$.\n        -   Location: The plane $\\,x = x_i-\\tfrac{\\Delta x}{2}\\,$.\n        -   Face Center: $\\,(x_i-\\tfrac{\\Delta x}{2}, y_j, z_k)\\,$.\n        -   Outward Normal: Points in the negative x-direction, $\\,\\mathbf{n}_{\\mathrm{W}}=(-1,0,0)\\,$.\n        -   Area: $\\,A_{\\mathrm{W}}=\\Delta y\\,\\Delta z\\,$.\n        -   Neighbor Index: $\\,(i-1,j,k)\\,$.\n\n    -   **North Face ($\\mathrm{N}$)**: This face separates cell $\\,(i,j,k)\\,$ from cell $\\,(i,j+1,k)\\,$.\n        -   Location: The plane $\\,y = y_j+\\tfrac{\\Delta y}{2}\\,$.\n        -   Face Center: $\\,(x_i, y_j+\\tfrac{\\Delta y}{2}, z_k)\\,$.\n        -   Outward Normal: Points in the positive y-direction, $\\,\\mathbf{n}_{\\mathrm{N}}=(0,1,0)\\,$.\n        -   Area: The face is a rectangle in the x-z plane with dimensions $\\,\\Delta x \\times \\Delta z\\,$. Thus, $\\,A_{\\mathrm{N}}=\\Delta x\\,\\Delta z\\,$.\n        -   Neighbor Index: $\\,(i,j+1,k)\\,$.\n\n    -   **South Face ($\\mathrm{S}$)**: This face separates cell $\\,(i,j,k)\\,$ from cell $\\,(i,j-1,k)\\,$.\n        -   Location: The plane $\\,y = y_j-\\tfrac{\\Delta y}{2}\\,$.\n        -   Face Center: $\\,(x_i, y_j-\\tfrac{\\Delta y}{2}, z_k)\\,$.\n        -   Outward Normal: Points in the negative y-direction, $\\,\\mathbf{n}_{\\mathrm{S}}=(0,-1,0)\\,$.\n        -   Area: $\\,A_{\\mathrm{S}}=\\Delta x\\,\\Delta z\\,$.\n        -   Neighbor Index: $\\,(i,j-1,k)\\,$.\n\n    -   **Top Face ($\\mathrm{T}$)**: This face separates cell $\\,(i,j,k)\\,$ from cell $\\,(i,j,k+1)\\,$.\n        -   Location: The plane $\\,z = z_k+\\tfrac{\\Delta z}{2}\\,$.\n        -   Face Center: $\\,(x_i, y_j, z_k+\\tfrac{\\Delta z}{2})\\,$.\n        -   Outward Normal: Points in the positive z-direction, $\\,\\mathbf{n}_{\\mathrm{T}}=(0,0,1)\\,$.\n        -   Area: The face is a rectangle in the x-y plane with dimensions $\\,\\Delta x \\times \\Delta y\\,$. Thus, $\\,A_{\\mathrm{T}}=\\Delta x\\,\\Delta y\\,$.\n        -   Neighbor Index: $\\,(i,j,k+1)\\,$.\n\n    -   **Bottom Face ($\\mathrm{B}$)**: This face separates cell $\\,(i,j,k)\\,$ from cell $\\,(i,j,k-1)\\,$.\n        -   Location: The plane $\\,z = z_k-\\tfrac{\\Delta z}{2}\\,$.\n        -   Face Center: $\\,(x_i, y_j, z_k-\\tfrac{\\Delta z}{2})\\,$.\n        -   Outward Normal: Points in the negative z-direction, $\\,\\mathbf{n}_{\\mathrm{B}}=(0,0,-1)\\,$.\n        -   Area: $\\,A_{\\mathrm{B}}=\\Delta x\\,\\Delta y\\,$.\n        -   Neighbor Index: $\\,(i,j,k-1)\\,$.\n\nThese specifications fully and consistently define the geometry for the cell-centered finite volume.\n\n### Option-by-Option Analysis\n\n**Option A**: This option lists:\n- Control Volume: $\\,[\\,x_i-\\tfrac{\\Delta x}{2},\\,x_i+\\tfrac{\\Delta x}{2}\\,]\\times[\\,y_j-\\tfrac{\\Delta y}{2},\\,y_j+\\tfrac{\\Delta y}{2}\\,]\\times[\\,z_k-\\tfrac{\\Delta z}{2},\\,z_k+\\tfrac{\\Delta z}{2}\\,]\\,$.\n- West Face: $\\,x=x_i-\\tfrac{\\Delta x}{2}\\,$, $\\,\\mathbf{n}_{\\mathrm{W}}=(-1,0,0)\\,$, $\\,A_{\\mathrm{W}}=\\Delta y\\,\\Delta z\\,$, neighbor $\\,(i-1,j,k)\\,$.\n- East Face: $\\,x=x_i+\\tfrac{\\Delta x}{2}\\,$, $\\,\\mathbf{n}_{\\mathrm{E}}=(1,0,0)\\,$, $\\,A_{\\mathrm{E}}=\\Delta y\\,\\Delta z\\,$, neighbor $\\,(i+1,j,k)\\,$.\n- South Face: $\\,y=y_j-\\tfrac{\\Delta y}{2}\\,$, $\\,\\mathbf{n}_{\\mathrm{S}}=(0,-1,0)\\,$, $\\,A_{\\mathrm{S}}=\\Delta x\\,\\Delta z\\,$, neighbor $\\,(i,j-1,k)\\,$.\n- North Face: $\\,y=y_j+\\tfrac{\\Delta y}{2}\\,$, $\\,\\mathbf{n}_{\\mathrm{N}}=(0,1,0)\\,$, $\\,A_{\\mathrm{N}}=\\Delta x\\,\\Delta z\\,$, neighbor $\\,(i,j+1,k)\\,$.\n- Bottom Face: $\\,z=z_k-\\tfrac{\\Delta z}{2}\\,$, $\\,\\mathbf{n}_{\\mathrm{B}}=(0,0,-1)\\,$, $\\,A_{\\mathrm{B}}=\\Delta x\\,\\Delta y\\,$, neighbor $\\,(i,j,k-1)\\,$.\n- Top Face: $\\,z=z_k+\\tfrac{\\Delta z}{2}\\,$, $\\,\\mathbf{n}_{\\mathrm{T}}=(0,0,1)\\,$, $\\,A_{\\mathrm{T}}=\\Delta x\\,\\Delta y\\,$, neighbor $\\,(i,j,k+1)\\,$.\n- All entries in this option, including face center coordinates, perfectly match the standard definition derived above.\n**Verdict**: **Correct**.\n\n**Option B**: This option defines the control volume as $\\,[\\,x_i,\\,x_{i+1}\\,]\\times[\\,y_j,\\,y_{j+1}\\,]\\times[\\,z_k,\\,z_{k+1}]\\,$.\n- This volume has the grid node $\\,(x_i, y_j, z_k)\\,$ at its corner, not its center. This is the definition of a *vertex-centered* (or node-centered) finite volume, which contradicts the problem's specification of a *cell-centered* scheme.\n- It also claims that the outward normals for the West and East faces are identical, $\\,\\mathbf{n}_{\\mathrm{W}}=\\mathbf{n}_{\\mathrm{E}}=(1,0,0)\\,$. This is geometrically impossible for a closed volume; the outward normals on opposite faces must point in opposite directions.\n- The area for the West/East faces is given as $\\,A_{\\mathrm{W}}=A_{\\mathrm{E}}=\\Delta x\\,\\Delta y\\,$. A face at constant $\\,x\\,$ has dimensions in $\\,y\\,$ and $\\,z\\,$, so its area must be proportional to $\\,\\Delta y\\,\\Delta z\\,$. The given area is for a face at constant $\\,z\\,$. This is incorrect.\n**Verdict**: **Incorrect**.\n\n**Option C**: This option uses the correct control volume definition, but specifies the normal vectors as $\\,\\mathbf{n}_{\\mathrm{E}}=(-1,0,0)\\,$, $\\,\\mathbf{n}_{\\mathrm{W}}=(1,0,0)\\,$, etc.\n- The East face is at $\\,x=x_i+\\tfrac{\\Delta x}{2}\\,$. The direction outward from the box $\\,[\\,x_i-\\tfrac{\\Delta x}{2},\\,x_i+\\tfrac{\\Delta x}{2}\\,]\\,$ is the positive x-direction, $\\,(1,0,0)\\,$. This option gives $\\,(-1,0,0)\\,$, which is the *inward* normal.\n- All normal vectors listed in this option are inward normals, which contradicts the stated requirement for \"outward unit normals $\\,\\mathbf{n}\\,$ consistent with the divergence theorem.\"\n**Verdict**: **Incorrect**.\n\n**Option D**: This option uses the correct control volume and the correct outward normal vectors (as in option A). However, it specifies the face areas as:\n- $\\,A_{\\mathrm{E}}=A_{\\mathrm{W}}=\\Delta x\\,\\Delta y\\,$\n- $\\,A_{\\mathrm{N}}=A_{\\mathrm{S}}=\\Delta y\\,\\Delta z\\,$\n- $\\,A_{\\mathrm{T}}=A_{\\mathrm{B}}=\\Delta x\\,\\Delta z\\,$\n- As derived above, the East/West faces (constant $\\,x\\,$) have area $\\,\\Delta y\\,\\Delta z\\,$. Option D incorrectly gives $\\,\\Delta x\\,\\Delta y\\,$.\n- The North/South faces (constant $\\,y\\,$) have area $\\,\\Delta x\\,\\Delta z\\,$. Option D incorrectly gives $\\,\\Delta y\\,\\Delta z\\,$.\n- The Top/Bottom faces (constant $\\,z\\,$) have area $\\,\\Delta x\\,\\Delta y\\,$. Option D incorrectly gives $\\,\\Delta x\\,\\Delta z\\,$.\n- The areas are cyclically permuted and thus are all incorrect.\n**Verdict**: **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "This practice provides a hands-on experience with the critical interplay between analytical methods and numerical scheme design. You will use the method of manufactured solutions to create a test case with a known exponential boundary layer, a common feature in advection-dominated geophysical flows with high Péclet number ($\\text{Pe}$). This allows you to quantify the numerical diffusion inherent in a first-order upwind scheme and determine the grid resolution needed to accurately capture both physical and numerical phenomena .",
            "id": "3596007",
            "problem": "Consider the steady one-dimensional advection-diffusion of a passive scalar concentration $C(x)$ along a rock core of length $L$ with constant pore-scale advection velocity $u0$ and molecular diffusivity $k0$. The governing conservation law for a control volume in one dimension is the steady balance of flux divergence and a volumetric source $s(x)$,\n$$\\frac{d}{dx}\\left(-k\\frac{dC}{dx}+u\\,C\\right)+s(x)=0,$$\nposed on $x\\in[0,L]$ with Dirichlet boundary conditions $C(0)=0$ and $C(L)=1-\\exp(-\\alpha L)$, where $\\alpha0$. You are to use the method of manufactured solutions to impose the exact boundary-layer profile $C_{\\mathrm{ex}}(x)=1-\\exp(-\\alpha x)$ as the unique steady solution by choosing an appropriate source $s(x)$, and then to assess the resolution requirements of a cell-centered Finite Volume (FV) discretization on a uniform grid of $N$ cells of width $\\Delta x=L/N$.\n\nTasks:\n1) Starting from the conservation law and the exact manufactured solution $C_{\\mathrm{ex}}(x)=1-\\exp(-\\alpha x)$, determine the source term $s(x)$ (as a function of $x$, $u$, $k$, and $\\alpha$) that makes $C_{\\mathrm{ex}}(x)$ an exact solution.\n\n2) Consider a first-order upwind approximation for the advective face flux and a centered difference for the diffusive face gradient in the FV fluxes. Show, by comparing the upwind convective flux at a cell face with its centered counterpart, that this convective discretization is equivalent to adding an artificial or numerical diffusion $k_{\\mathrm{num}}$ to the physical diffusion $k$, and identify $k_{\\mathrm{num}}$ in terms of $u$ and $\\Delta x$.\n\n3) Let the Péclet number ($\\text{Pe}$) be defined as $\\mathrm{Pe}=uL/k$. Impose two independent accuracy requirements: (i) the numerical diffusion should not exceed a fraction $\\beta$ of the physical diffusion, that is $k_{\\mathrm{num}}\\le \\beta k$ with $\\beta=0.1$, and (ii) the exponential boundary layer of e-folding thickness $1/\\alpha$ must be resolved by at least $m$ cells with $m=12$. Derive the resulting lower bound on the required number of cells $N$ in terms of $\\mathrm{Pe}$, $\\alpha$, $L$, $\\beta$, and $m$.\n\n4) For a core of length $L=1\\,\\text{m}$ with $\\mathrm{Pe}=200$ and $\\alpha=50\\,\\text{m}^{-1}$, compute the minimal number of uniform FV cells $N_{\\min}$ that simultaneously satisfies both accuracy requirements. Report the final answer as the integer $N_{\\min}$ with no units. No rounding by significant figures is required because $N_{\\min}$ is an integer by construction.",
            "solution": "The problem requires a four-part analysis of a steady one-dimensional advection-diffusion problem, starting with the method of manufactured solutions to define a source term, followed by an analysis of the numerical diffusion of a finite volume scheme, and concluding with a derivation and calculation of grid resolution requirements.\n\n**Part 1: Determination of the Source Term $s(x)$**\n\nThe governing equation for the steady-state concentration $C(x)$ is given by:\n$$\n\\frac{d}{dx}\\left(-k\\frac{dC}{dx}+uC\\right)+s(x)=0\n$$\nwhere the flux is $F(x) = -k\\frac{dC}{dx} + uC$. The source term $s(x)$ is therefore given by $s(x) = -\\frac{dF(x)}{dx}$.\n\nWe are given a manufactured solution $C_{\\mathrm{ex}}(x) = 1 - \\exp(-\\alpha x)$. We first compute its derivative with respect to $x$:\n$$\n\\frac{dC_{\\mathrm{ex}}}{dx} = \\frac{d}{dx}\\left(1 - \\exp(-\\alpha x)\\right) = -(-\\alpha)\\exp(-\\alpha x) = \\alpha\\exp(-\\alpha x)\n$$\nNext, we substitute $C_{\\mathrm{ex}}(x)$ and its derivative into the expression for the flux $F(x)$:\n$$\nF(x) = -k\\left(\\alpha\\exp(-\\alpha x)\\right) + u\\left(1 - \\exp(-\\alpha x)\\right)\n$$\nDistributing the terms, we get:\n$$\nF(x) = u - k\\alpha\\exp(-\\alpha x) - u\\exp(-\\alpha x) = u - (k\\alpha + u)\\exp(-\\alpha x)\n$$\nTo find the source term $s(x)$, we must differentiate the flux $F(x)$ with respect to $x$:\n$$\n\\frac{dF}{dx} = \\frac{d}{dx}\\left(u - (k\\alpha + u)\\exp(-\\alpha x)\\right) = 0 - (k\\alpha + u)(-\\alpha)\\exp(-\\alpha x)\n$$\n$$\n\\frac{dF}{dx} = \\alpha(k\\alpha + u)\\exp(-\\alpha x) = (k\\alpha^2 + u\\alpha)\\exp(-\\alpha x)\n$$\nThe source term $s(x)$ is the negative of this expression:\n$$\ns(x) = -\\frac{dF}{dx} = -(k\\alpha^2 + u\\alpha)\\exp(-\\alpha x)\n$$\nThis source term ensures that $C_{\\mathrm{ex}}(x) = 1 - \\exp(-\\alpha x)$ is the exact solution to the advection-diffusion equation.\n\n**Part 2: Numerical Diffusion of the Upwind Scheme**\n\nIn a cell-centered finite volume method, the discretized equation for a cell $i$ involves fluxes at the cell faces, for example, at face $i+1/2$ between cell $i$ and cell $i+1$. The total flux $F_{i+1/2}$ is the sum of the advective flux $F_{\\mathrm{adv}, i+1/2}$ and the diffusive flux $F_{\\mathrm{diff}, i+1/2}$.\n\nThe diffusive flux is approximated using a centered difference:\n$$\nF_{\\mathrm{diff}, i+1/2} \\approx -k \\frac{C_{i+1} - C_i}{\\Delta x}\n$$\nwhere $C_i$ and $C_{i+1}$ are the concentrations at the centers of cells $i$ and $i+1$, and $\\Delta x$ is the cell width.\n\nFor the advective flux, with a positive velocity $u0$, the first-order upwind scheme takes the value from the upstream cell, which is cell $i$:\n$$\nF_{\\mathrm{adv}, i+1/2} \\approx uC_i\n$$\nThe total numerical flux at the face $i+1/2$ is therefore:\n$$\nF_{i+1/2} \\approx uC_i - k \\frac{C_{i+1} - C_i}{\\Delta x}\n$$\nTo analyze this, we compare it to a scheme with a centered convective flux, which would be $u (C_i + C_{i+1})/2$. We can rewrite the upwind term $uC_i$ by adding and subtracting $uC_{i+1}/2$:\n$$\nuC_i = u\\left(\\frac{C_i + C_{i+1}}{2} - \\frac{C_{i+1} - C_i}{2}\\right) = u\\frac{C_i + C_{i+1}}{2} - \\frac{u}{2}(C_{i+1} - C_i)\n$$\nNow we substitute this back into the expression for the total flux $F_{i+1/2}$:\n$$\nF_{i+1/2} \\approx \\left(u\\frac{C_i + C_{i+1}}{2} - \\frac{u}{2}(C_{i+1} - C_i)\\right) - k \\frac{C_{i+1} - C_i}{\\Delta x}\n$$\nWe can rewrite the term $\\frac{u}{2}(C_{i+1} - C_i)$ by multiplying and dividing by $\\Delta x$:\n$$\nF_{i+1/2} \\approx u\\frac{C_i + C_{i+1}}{2} - \\frac{u\\Delta x}{2}\\frac{C_{i+1} - C_i}{\\Delta x} - k \\frac{C_{i+1} - C_i}{\\Delta x}\n$$\nGrouping the terms that are proportional to the gradient $(C_{i+1} - C_i)/\\Delta x$:\n$$\nF_{i+1/2} \\approx u\\frac{C_i + C_{i+1}}{2} - \\left(k + \\frac{u\\Delta x}{2}\\right)\\frac{C_{i+1} - C_i}{\\Delta x}\n$$\nThis expression is equivalent to a centered scheme for both advection and diffusion, but with an effective diffusion coefficient of $k_{\\mathrm{eff}} = k + \\frac{u\\Delta x}{2}$. The additional term is the numerical diffusion, $k_{\\mathrm{num}}$. Thus, we identify the numerical diffusion as:\n$$\nk_{\\mathrm{num}} = \\frac{u\\Delta x}{2}\n$$\n\n**Part 3: Lower Bound on the Number of Cells $N$**\n\nWe must derive the minimum number of cells $N$ that satisfies two independent accuracy requirements.\n\nRequirement (i): The numerical diffusion must not exceed a fraction $\\beta$ of the physical diffusion.\n$$\nk_{\\mathrm{num}} \\le \\beta k\n$$\nSubstituting the expression for $k_{\\mathrm{num}}$ from Part 2 and $\\Delta x = L/N$:\n$$\n\\frac{u(L/N)}{2} \\le \\beta k\n$$\n$$\n\\frac{uL}{2N} \\le \\beta k\n$$\nSolving for $N$, we get the first lower bound on $N$:\n$$\nN \\ge \\frac{uL}{2\\beta k}\n$$\nRecognizing the Péclet number $\\mathrm{Pe} = uL/k$, we can write this as:\n$$\nN \\ge \\frac{\\mathrm{Pe}}{2\\beta}\n$$\n\nRequirement (ii): The boundary layer must be adequately resolved.\nThe e-folding thickness of the exponential boundary layer is given by $1/\\alpha$. This length scale must be resolved by at least $m$ cells. This implies that the cell width $\\Delta x$ must be smaller than or equal to the characteristic length divided by $m$.\n$$\n\\Delta x \\le \\frac{1/\\alpha}{m} = \\frac{1}{m\\alpha}\n$$\nSubstituting $\\Delta x = L/N$:\n$$\n\\frac{L}{N} \\le \\frac{1}{m\\alpha}\n$$\nSolving for $N$, we get the second lower bound:\n$$\nN \\ge m\\alpha L\n$$\nTo satisfy both requirements simultaneously, $N$ must be greater than or equal to the maximum of these two lower bounds:\n$$\nN \\ge \\max\\left(\\frac{\\mathrm{Pe}}{2\\beta}, m\\alpha L\\right)\n$$\n\n**Part 4: Calculation of the Minimal Number of Cells $N_{\\min}$**\n\nWe are given the following numerical values:\n- $L = 1\\,\\text{m}$\n- $\\mathrm{Pe} = 200$\n- $\\alpha = 50\\,\\text{m}^{-1}$\n- $\\beta = 0.1$ (from Part 3)\n- $m = 12$ (from Part 3)\n\nWe calculate the two lower bounds found in Part 3.\n\nFirst bound, from requirement (i):\n$$\nN_1 = \\frac{\\mathrm{Pe}}{2\\beta} = \\frac{200}{2 \\times 0.1} = \\frac{200}{0.2} = 1000\n$$\nSecond bound, from requirement (ii):\n$$\nN_2 = m\\alpha L = 12 \\times 50 \\times 1 = 600\n$$\nThe required number of cells $N$ must satisfy $N \\ge N_1$ and $N \\ge N_2$. Therefore, $N$ must be greater than or equal to the maximum of the two values:\n$$\nN \\ge \\max(1000, 600) = 1000\n$$\nSince $N$ must be an integer, the minimal number of uniform FV cells $N_{\\min}$ that satisfies both constraints is $1000$.",
            "answer": "$$\\boxed{1000}$$"
        },
        {
            "introduction": "A cornerstone of the finite volume method is its inherent conservation property, which is vital for modeling physical transport processes. This comprehensive coding exercise tasks you with building a 2D solver and verifying that global mass is conserved to machine precision for a divergence-free flow in a periodic domain . By implementing various time-stepping schemes and spatial reconstructions, you will demonstrate that this conservation is a direct result of the conservative flux-difference formulation, a key strength of the FVM framework.",
            "id": "3595966",
            "problem": "Implement a finite volume solver for the conservative advection–diffusion equation on a two-dimensional periodic square domain and verify global tracer mass conservation to machine precision under different spatial reconstructions and time integrators. The governing equation is\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\left( \\mathbf{u} \\, c \\right) = \\nabla \\cdot \\left( \\kappa \\, \\nabla c \\right),\n$$\nwhere $c(\\mathbf{x},t)$ is the scalar tracer concentration, $\\mathbf{u}(\\mathbf{x})$ is a prescribed divergence-free velocity field, and $\\kappa \\ge 0$ is a constant diffusivity. The computational domain is the unit square with periodic boundary conditions:\n$$\n\\Omega = [0,1] \\times [0,1].\n$$\n\nStarting from the conservation law and the divergence theorem as the fundamental base, design a cell-centered finite volume method on a uniform Cartesian mesh with $N_x \\times N_y$ rectangular control volumes, each of size $\\Delta x = 1/N_x$ and $\\Delta y = 1/N_y$. The method must compute a numerical face flux in conservative form at each control-volume face and update cell averages with the flux divergence. The advective face flux shall use one of the following spatial reconstructions to obtain face states:\n- First-order upwind (piecewise constant).\n- Monotonic Upstream-centered Scheme for Conservation Laws (MUSCL) with the minmod slope limiter.\n\nThe diffusive face flux shall be computed with a second-order central approximation of the gradient. Use the following explicit time integrators:\n- Forward Euler (also called Runge–Kutta of order $1$).\n- Strong Stability Preserving Runge–Kutta of order $3$ (Shu–Osher $3$-stage).\n- Classical Runge–Kutta of order $4$.\n\nAdopt periodicity in both directions. Choose a divergence-free, time-independent, smooth velocity field constructed from a streamfunction $\\psi(x,y)$ via\n$$\n\\mathbf{u}(x,y) = \\begin{pmatrix} -\\partial \\psi/\\partial y \\\\ \\partial \\psi/\\partial x \\end{pmatrix}.\n$$\nFor the test suite below, use the periodic double-gyre streamfunction\n$$\n\\psi(x,y) = \\sin(2\\pi x)\\sin(2\\pi y),\n$$\nso that\n$$\nu(x,y) = -2\\pi \\cos(2\\pi y)\\sin(2\\pi x), \\quad v(x,y) = 2\\pi \\cos(2\\pi x)\\sin(2\\pi y).\n$$\nAlso include a zero-velocity case defined by $u(x,y) = 0$ and $v(x,y) = 0$.\n\nUse the initial condition\n$$\nc(x,y,0) = 1 + \\tfrac{1}{2}\\exp\\!\\left(-\\frac{(x-0.3)^2 + (y-0.7)^2}{0.05^2}\\right) + \\tfrac{1}{4}\\sin(2\\pi x)\\sin(2\\pi y).\n$$\n\nTime step size $\\Delta t$ must be chosen to respect explicit stability constraints. Define an advective Courant–Friedrichs–Lewy (CFL) number $C_a \\in (0,1)$ and a diffusive CFL number $C_d \\in (0,1)$, then set\n$$\n\\Delta t_{\\text{adv}} = C_a \\cdot \\min\\!\\left(\\frac{\\Delta x}{\\max |u|}, \\frac{\\Delta y}{\\max |v|}\\right),\n\\quad\n\\Delta t_{\\text{diff}} = \n\\begin{cases}\nC_d \\cdot \\dfrac{\\Delta x^2}{4\\kappa},  \\kappa  0,\\\\\n+\\infty,  \\kappa = 0,\n\\end{cases}\n$$\nand use $\\Delta t = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}})$, adjusted so that an integer number of steps reaches the final time $T$. If both $\\mathbf{u} = \\mathbf{0}$ and $\\kappa = 0$, use a single step with $\\Delta t = T$.\n\nFor each run, compute the total tracer mass\n$$\nM(t) = \\iint_{\\Omega} c(x,y,t)\\,dx\\,dy,\n$$\nusing the cell averages and cell volumes. Report the absolute relative mass drift at final time $T$:\n$$\n\\epsilon = \\frac{|M(T) - M(0)|}{M(0)}.\n$$\n\nImplement the program so that it runs the following test suite on a mesh with $N_x = 64$, $N_y = 64$, and final time $T = 1$:\n- Test case $1$: Forward Euler, first-order upwind, double-gyre velocity, $\\kappa = 0$, $C_a = 0.5$, $C_d = 1$.\n- Test case $2$: Strong Stability Preserving Runge–Kutta of order $3$, MUSCL with minmod, double-gyre velocity, $\\kappa = 0$, $C_a = 0.9$, $C_d = 1$.\n- Test case $3$: Classical Runge–Kutta of order $4$, first-order upwind, zero velocity, $\\kappa = 10^{-3}$, $C_a = 1$, $C_d = 0.2$.\n- Test case $4$: Strong Stability Preserving Runge–Kutta of order $3$, MUSCL with minmod, double-gyre velocity, $\\kappa = 10^{-3}$, $C_a = 0.8$, $C_d = 0.2$.\n- Test case $5$: Classical Runge–Kutta of order $4$, MUSCL with minmod, zero velocity, $\\kappa = 0$, $C_a = 1$, $C_d = 1$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\"), where each entry is the floating-point value of $\\epsilon$ for the corresponding test case in the above order. All quantities are nondimensional; no physical units are required. Angles in trigonometric functions are in radians. The outputs must be machine-representable floating-point numbers.",
            "solution": "The user-provided problem is valid. It is scientifically grounded in the principles of computational fluid dynamics, well-posed as an initial boundary value problem, and specified with sufficient detail and objectivity to permit a unique, verifiable solution. The task is to implement a two-dimensional finite volume solver for the advection-diffusion equation.\n\n### Finite Volume Discretization\n\nThe governing equation is the conservation law for a scalar quantity $c$:\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{F}(c, \\nabla c, \\mathbf{u}) = 0\n$$\nwhere the flux vector $\\mathbf{F}$ is composed of an advective part and a diffusive part:\n$$\n\\mathbf{F} = \\mathbf{u} c - \\kappa \\nabla c = \\mathbf{F}_{\\text{adv}} + \\mathbf{F}_{\\text{diff}}\n$$\nWe discretize the domain $\\Omega = [0,1] \\times [0,1]$ into a uniform grid of $N_x \\times N_y$ cells, each of size $\\Delta x \\times \\Delta y$. The cell $V_{i,j}$ is centered at $(x_i, y_j) = ((i+0.5)\\Delta x, (j+0.5)\\Delta y)$. Integrating the governing equation over $V_{i,j}$ and applying the divergence theorem yields:\n$$\n\\iint_{V_{i,j}} \\frac{\\partial c}{\\partial t} \\,dx\\,dy + \\oint_{\\partial V_{i,j}} \\mathbf{F} \\cdot \\mathbf{n} \\,ds = 0\n$$\nDefining the cell average concentration $\\bar{c}_{i,j}(t) = \\frac{1}{\\Delta x \\Delta y} \\iint_{V_{i,j}} c(x,y,t) \\,dx\\,dy$, the equation becomes an ordinary differential equation (ODE) for each cell average:\n$$\n\\frac{d\\bar{c}_{i,j}}{dt} \\Delta x \\Delta y + \\left[ \\hat{F}_{x,i+1/2,j} - \\hat{F}_{x,i-1/2,j} \\right] \\Delta y + \\left[ \\hat{F}_{y,i,j+1/2} - \\hat{F}_{y,i,j-1/2} \\right] \\Delta x = 0\n$$\nwhere $\\hat{F}_{x,i+1/2,j}$ and $\\hat{F}_{y,i,j+1/2}$ are numerical approximations to the fluxes at the eastern and northern cell faces, respectively. This can be written in the semi-discrete form $\\frac{d\\bar{c}_{i,j}}{dt} = L(\\bar{c})_{i,j}$, where $L(\\bar{c})_{i,j}$ is the discrete spatial operator:\n$$\nL(\\bar{c})_{i,j} = -\\frac{1}{\\Delta x} \\left( \\hat{F}_{x,i+1/2,j} - \\hat{F}_{x,i-1/2,j} \\right) - \\frac{1}{\\Delta y} \\left( \\hat{F}_{y,i,j+1/2} - \\hat{F}_{y,i,j-1/2} \\right)\n$$\nThe use of the same numerical flux $\\hat{F}_{x,i+1/2,j}$ for the outflow of cell $(i,j)$ and the inflow of cell $(i+1,j)$ ensures that the method is conservative, which is the key to verifying mass conservation.\n\n### Spatial Flux Discretization\n\nThe numerical flux $\\hat{F}$ is approximated by discretizing its advective and diffusive components. The velocities $u$ and $v$ are evaluated at the center of the corresponding faces.\n\n#### Diffusive Flux\nThe diffusive flux is approximated using a second-order central difference for the gradient, which is consistent with the finite volume framework. For the face at $x_{i+1/2}$:\n$$\n\\hat{F}_{\\text{diff}, x, i+1/2,j} = -\\kappa \\left(\\frac{\\partial c}{\\partial x}\\right)_{i+1/2,j} \\approx -\\kappa \\frac{\\bar{c}_{i+1,j} - \\bar{c}_{i,j}}{\\Delta x}\n$$\nSimilarly, for the face at $y_{j+1/2}$:\n$$\n\\hat{F}_{\\text{diff}, y, i,j+1/2} = -\\kappa \\frac{\\bar{c}_{i,j+1} - \\bar{c}_{i,j}}{\\Delta y}\n$$\n\n#### Advective Flux\nThe advective flux $\\hat{F}_{\\text{adv},x,i+1/2,j} = u_{i+1/2,j} c_{i+1/2,j}$ requires reconstructing the concentration $c$ at the cell interface from the cell-average values.\n\n1.  **First-Order Upwind**: This method assumes a piecewise constant representation of the data. The value at the interface is taken from the upwind cell, i.e., the cell from which the flow originates.\n    $$\n    c_{i+1/2,j} = \\begin{cases} \\bar{c}_{i,j}  \\text{if } u_{i+1/2,j} \\ge 0 \\\\ \\bar{c}_{i+1,j}  \\text{if } u_{i+1/2,j}  0 \\end{cases}\n    $$\n2.  **MUSCL with Minmod Limiter**: This higher-order scheme uses a piecewise linear reconstruction in each cell, $\\bar{c}(x) = \\bar{c}_{i,j} + (x-x_i)\\sigma^{(x)}_{i,j}$ for $x \\in [x_{i-1/2}, x_{i+1/2}]$. The slope $\\sigma$ is limited to prevent spurious oscillations.\n    - At the east face of cell $(i,j)$ ($x=x_{i+1/2}$), the reconstructed value from the left is $c_L = \\bar{c}_{i,j} + \\frac{\\Delta x}{2} \\sigma^{(x)}_{i,j}$.\n    - At the west face of cell $(i+1,j)$ ($x=x_{i+1/2}$), the reconstructed value from the right is $c_R = \\bar{c}_{i+1,j} - \\frac{\\Delta x}{2} \\sigma^{(x)}_{i+1,j}$.\n    - The slope in cell $(i,j)$ is limited using the forward and backward differences:\n      $$\n      \\sigma^{(x)}_{i,j} = \\text{minmod}\\left( \\frac{\\bar{c}_{i+1,j} - \\bar{c}_{i,j}}{\\Delta x}, \\frac{\\bar{c}_{i,j} - \\bar{c}_{i-1,j}}{\\Delta x} \\right)\n      $$\n    - The minmod function is defined as $\\text{minmod}(a,b) = \\frac{1}{2}(\\text{sgn}(a) + \\text{sgn}(b))\\min(|a|, |b|)$. It returns the argument with the smallest absolute value if both have the same sign, and zero otherwise.\n    - The interface value is then chosen using the upwind principle applied to the reconstructed states:\n      $$\n      c_{i+1/2,j} = \\begin{cases} c_L  \\text{if } u_{i+1/2,j} \\ge 0 \\\\ c_R  \\text{if } u_{i+1/2,j}  0 \\end{cases}\n      $$\n    The same logic applies in the $y$-direction. Due to periodic boundary conditions, neighbor indices are handled using modular arithmetic.\n\n### Temporal Integration\n\nThe system of ODEs $\\frac{d\\bar{c}}{dt} = L(\\bar{c})$ is solved using one of the specified explicit Runge-Kutta methods. Let $\\bar{c}^n$ be the solution at time $t_n$.\n\n1.  **Forward Euler (RK1)**:\n    $$\n    \\bar{c}^{n+1} = \\bar{c}^n + \\Delta t L(\\bar{c}^n)\n    $$\n2.  **SSP-RK3**:\n    \\begin{align*}\n    \\mathbf{w}^{(1)} = \\bar{c}^n + \\Delta t L(\\bar{c}^n) \\\\\n    \\mathbf{w}^{(2)} = \\frac{3}{4}\\bar{c}^n + \\frac{1}{4}\\left(\\mathbf{w}^{(1)} + \\Delta t L(\\mathbf{w}^{(1)})\\right) \\\\\n    \\bar{c}^{n+1} = \\frac{1}{3}\\bar{c}^n + \\frac{2}{3}\\left(\\mathbf{w}^{(2)} + \\Delta t L(\\mathbf{w}^{(2)})\\right)\n    \\end{align*}\n3.  **Classical RK4**:\n    \\begin{align*}\n    \\mathbf{k}_1 = L(\\bar{c}^n) \\\\\n    \\mathbf{k}_2 = L(\\bar{c}^n + \\frac{\\Delta t}{2} \\mathbf{k}_1) \\\\\n    \\mathbf{k}_3 = L(\\barc}^n + \\frac{\\Delta t}{2} \\mathbf{k}_2) \\\\\n    \\mathbf{k}_4 = L(\\bar{c}^n + \\Delta t \\mathbf{k}_3) \\\\\n    \\bar{c}^{n+1} = \\bar{c}^n + \\frac{\\Delta t}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n    \\end{align*}\n\n### Mass Conservation Verification\n\nThe total mass is $M(t) = \\iint_{\\Omega} c \\,dx\\,dy \\approx \\sum_{i,j} \\bar{c}_{i,j} \\Delta x \\Delta y$. The rate of change of total mass is:\n$$\n\\frac{dM}{dt} \\approx \\sum_{i,j} \\frac{d\\bar{c}_{i,j}}{dt} \\Delta x \\Delta y = \\Delta x \\Delta y \\sum_{i,j} L(\\bar{c})_{i,j}\n$$\nSubstituting the definition of $L(\\bar{c})_{i,j}$ results in a telescoping sum. For periodic boundary conditions, the sum over all flux differences is identically zero. For example, in the $x$-direction for a given row $j$:\n$$\n\\sum_{i=0}^{N_x-1} (\\hat{F}_{x,i+1/2,j} - \\hat{F}_{x,i-1/2,j}) = 0\n$$\nbecause flux $\\hat{F}_{x,N_x-1/2,j}$ out of cell $N_x-1$ is identical to flux $\\hat{F}_{x,-1/2,j}$ into cell $0$. Therefore, the discrete summation $\\sum_{i,j} L(\\bar{c})_{i,j}$ evaluates to zero. This implies that the time integration schemes, which are linear combinations of applications of the $L$ operator, will also conserve the total sum of $\\bar{c}_{i,j}$. Any non-zero mass drift $\\epsilon$ must therefore be attributable solely to floating-point round-off errors, and is expected to be on the order of machine precision.",
            "answer": "[1.2183301018873737e-16,3.6062778747441584e-15,4.3644498305369634e-15,2.1648057997931460e-14,0.0000000000000000e+00]"
        }
    ]
}