{
    "hands_on_practices": [
        {
            "introduction": "一阶迎风格式是求解平流方程最基础的方法。虽然它易于实现，但其实际应用受到一个关键稳定性条件的限制，即 Courant-Friedrichs-Lewy (CFL) 条件。本练习  将引导您通过冯·诺依曼稳定性分析，推导出这一基本条件，从而具体理解为何时间步长 $\\Delta t$、网格间距 $\\Delta x$ 和波速 $a$ 之间存在紧密的联系。",
            "id": "3618319",
            "problem": "地球物理流中的一维被动示踪物由线性平流方程 $u_{t} + a\\,u_{x} = 0$ 建模，其中波速 $a0$ 为常数。考虑一个空间间距为 $\\Delta x$ 的均匀空间网格，并使用前向欧拉法进行显式时间推进。对于 $a0$，一阶迎风空间离散使用左偏差分。假设一个空间周期性域，以便傅里叶模态是可接受的。\n\n从连续方程以及由时间上的前向欧拉法和空间上的一阶迎风法得到的离散更新式出发，分析单个傅里叶模态的放大情况，并推导时间步长 $\\Delta t$ 必须满足的稳定性要求，以使数值解对所有波数保持有界。然后，使用推导出的条件，计算当 $a = 1$ m/s 和 $\\Delta x = 100$ m 时的最大允许时间步长。以秒为单位表示最终的时间步长，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导应用于线性平流方程的数值格式的稳定性条件，并随后计算给定参数下的最大允许时间步长。\n\n控制偏微分方程 (PDE) 是一维线性平流方程：\n$$ u_t + a u_x = 0 $$\n其中 $u(x, t)$ 是在位置 $x$ 和时间 $t$ 的被动示踪物浓度，$a$ 是常数波速，给定为 $a > 0$。\n\n我们在均匀网格上离散化该方程，其中 $x_j = j \\Delta x$ 和 $t^n = n \\Delta t$。令 $u_j^n$ 表示 $u(x_j, t^n)$ 的数值近似。\n\n时间导数 $u_t$ 使用显式前向欧拉法进行离散：\n$$ u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t} $$\n空间导数 $u_x$ 使用一阶迎风格式进行离散。由于波速 $a$ 为正 ($a>0$)，“迎风”方向是向左（即 $x$ 减小的方向）。这对应于一阶后向差分：\n$$ u_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x} $$\n将这些离散近似代入偏微分方程，得到有限差分方程：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) = 0 $$\n我们可以重新整理这个方程，以求解下一个时间步的解 $u_j^{n+1}$：\n$$ u_j^{n+1} = u_j^n - \\frac{a \\Delta t}{\\Delta x} \\left( u_j^n - u_{j-1}^n \\right) $$\n通常将库朗数 $C$ 定义为无量纲比率：\n$$ C = \\frac{a \\Delta t}{\\Delta x} $$\n使用库朗数，更新格式变为：\n$$ u_j^{n+1} = u_j^n - C (u_j^n - u_{j-1}^n) = (1 - C) u_j^n + C u_{j-1}^n $$\n为了分析该格式的稳定性，我们进行冯·诺依曼稳定性分析。我们考虑解的单个傅里叶模态的行为，其形式可以写为：\n$$ u_j^n = \\hat{u}^n(k) e^{i k x_j} $$\n其中 $k$ 是波数，$i = \\sqrt{-1}$，$\\hat{u}^n(k)$ 是在时间步 $n$ 的模态幅值。将此代入离散方程得到：\n$$ \\hat{u}^{n+1} e^{i k x_j} = (1 - C) \\hat{u}^n e^{i k x_j} + C \\hat{u}^n e^{i k x_{j-1}} $$\n由于 $x_{j-1} = x_j - \\Delta x$，我们有 $e^{i k x_{j-1}} = e^{i k (x_j - \\Delta x)} = e^{i k x_j} e^{-i k \\Delta x}$。代入此式并用公因子 $e^{i k x_j}$（非零）除以整个方程，我们得到：\n$$ \\hat{u}^{n+1} = (1 - C) \\hat{u}^n + C \\hat{u}^n e^{-i k \\Delta x} $$\n放大因子 $G(k)$ 定义为连续时间步上幅值的比率，$G(k) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^n}$：\n$$ G(k) = 1 - C + C e^{-i k \\Delta x} $$\n为使数值格式稳定，对任何波数 $k$，放大因子的模长都不能超过1。即 $|G(k)| \\le 1$。\n让我们分析 $G(k)$ 的模长。使用欧拉公式 $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$，其中 $\\theta = k \\Delta x$：\n$$ G(k) = (1 - C) + C (\\cos(k \\Delta x) - i \\sin(k \\Delta x)) $$\n$$ G(k) = [1 - C + C \\cos(k \\Delta x)] - i [C \\sin(k \\Delta x)] $$\n$G(k)$ 的模长平方是其实部和虚部平方的和：\n$$ |G(k)|^2 = [1 - C + C \\cos(k \\Delta x)]^2 + [-C \\sin(k \\Delta x)]^2 $$\n$$ |G(k)|^2 = (1-C)^2 + 2C(1-C)\\cos(k\\Delta x) + C^2\\cos^2(k\\Delta x) + C^2\\sin^2(k\\Delta x) $$\n使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$ |G(k)|^2 = (1-C)^2 + 2C(1-C)\\cos(k\\Delta x) + C^2 $$\n$$ |G(k)|^2 = (1 - 2C + C^2) + 2C\\cos(k\\Delta x) - 2C^2\\cos(k\\Delta x) + C^2 $$\n$$ |G(k)|^2 = 1 - 2C + 2C^2 + (2C - 2C^2)\\cos(k\\Delta x) $$\n$$ |G(k)|^2 = 1 - 2C(1-C) + 2C(1-C)\\cos(k\\Delta x) = 1 + 2C(1-C)(\\cos(k\\Delta x) - 1) $$\n使用半角公式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到 $\\cos(k\\Delta x) - 1 = -2\\sin^2(k\\Delta x/2)$。\n$$ |G(k)|^2 = 1 - 4C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) $$\n稳定性条件是 $|G(k)|^2 \\le 1$。将此应用于我们的表达式：\n$$ 1 - 4C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\le 1 $$\n$$ -4C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\le 0 $$\n$$ C(1-C)\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\ge 0 $$\n对于任何实数 $k$ 和 $\\Delta x$，项 $\\sin^2\\left(\\frac{k\\Delta x}{2}\\right)$ 总是非负的。库朗数 $C = \\frac{a \\Delta t}{\\Delta x}$ 也是非负的，因为 $a > 0$, $\\Delta t > 0$ 和 $\\Delta x > 0$。因此，为了使不等式成立，我们必须有：\n$$ 1 - C \\ge 0 \\implies C \\le 1 $$\n因此，对于带前向欧拉时间推进的一阶迎风格式，稳定性要求是 $0 \\le C \\le 1$。这就是此特定格式的库朗-弗里德里希斯-列维 (CFL) 条件。\n$$ \\frac{a \\Delta t}{\\Delta x} \\le 1 $$\n这意味着时间步长 $\\Delta t$ 必须满足：\n$$ \\Delta t \\le \\frac{\\Delta x}{a} $$\n当等号成立时，获得最大允许时间步长 $\\Delta t_{\\text{max}}$：\n$$ \\Delta t_{\\text{max}} = \\frac{\\Delta x}{a} $$\n问题给出了以下数值：\n$$ a = 1 \\text{ m/s} $$\n$$ \\Delta x = 100 \\text{ m} $$\n将这些值代入最大时间步长的表达式中：\n$$ \\Delta t_{\\text{max}} = \\frac{100 \\text{ m}}{1 \\text{ m/s}} = 100 \\text{ s} $$\n问题要求答案以秒为单位表示，并四舍五入到四位有效数字。计算出的值恰好是 $100$。为了用四位有效数字表示，我们将其写为 $100.0$。",
            "answer": "$$\n\\boxed{100.0}\n$$"
        },
        {
            "introduction": "一阶格式会引入过度的数值耗散，导致解的特征变得模糊。为了在避免伪振荡的同时提高精度，我们转向使用像 MUSCL 这样的高分辨率格式，并结合通量限制器。本练习  提供了一个动手实践的机会，您将通过计算一个单元的单步时间更新来应用该理论，并使用著名的 van Leer 通量限制器来观察格式如何根据局部数据的平滑度自适应地控制数值解。",
            "id": "3618311",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中无量纲被动示踪剂 $u(x,t)$ 在计算地球物理学背景下，沿着一个直线断面以恒定的正速度 $a0$ 平流。假设在一个均匀网格上采用守恒型有限体积半离散格式，网格平均值 $u_{i}(t)$ 位于网格中心 $x_{i}$，网格大小为 $\\Delta x$，并使用显式时间步长 $\\Delta t$ 进行时间推进。\n\n从守恒律和针对 $a0$ 的相容迎风 Godunov 通量出发，采用一个带总变差递减通量限制器的二阶守恒律单调上游中心格式 (Monotone Upstream-centered Schemes for Conservation Laws, MUSCL) 分段线性重构。使用由下式定义的 van Leer 限制器\n$$\n\\phi(r) = \\frac{r + |r|}{1 + |r|}.\n$$\n通过以下比率定义网格 $i$ 处的局部光滑度指标\n$$\nr_{i} = \\frac{u_{i}^{n} - u_{i-1}^{n}}{u_{i+1}^{n} - u_{i}^{n}},\n$$\n并使用 $\\phi(r_{i})$ 在网格 $i$ 中构建一个受限斜率。对于 $a0$，从网格 $i$ 重构界面 $x_{i+1/2}$ 处的左状态，并类似地从网格 $i-1$ 重构 $x_{i-1/2}$ 处的左状态，然后通过守恒通量差分来更新 $u_{i}$。\n\n给定在时间层 $n$ 的以下数值上合理的数据：\n- 平流速度 $a = 1.5$，\n- 网格间距 $\\Delta x = 10$，\n- 时间步长 $\\Delta t = 4$，\n- 相邻网格的平均值 $u_{i-2}^{n} = 0.80$，$u_{i-1}^{n} = 1.00$，$u_{i}^{n} = 1.10$，$u_{i+1}^{n} = 0.90$，\n\n从第一性原理出发，推导由带 van Leer 限制器的 MUSCL 策略所蕴含的有限体积界面重构，计算 $r_{i}$ 以及控制 $a0$ 时界面 $x_{i+1/2}$ 的受限斜率，形成迎风数值通量，并对 $u_{i}$ 执行一次显式更新以获得 $u_{i}^{n+1}$。将最终更新后的值 $u_{i}^{n+1}$ 报告为一个无单位的纯数。如果选择近似计算，请将答案四舍五入到六位有效数字；否则，请提供精确值。",
            "solution": "本问题要求使用二阶 MUSCL 有限体积格式，为线性平流方程 $u_{t} + a\\,u_{x} = 0$ 计算更新后的网格平均值 $u_{i}^{n+1}$。\n\n有限体积法根据守恒型半离散形式更新网格平均值 $u_i$：\n$$\n\\frac{d u_i}{dt} = -\\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2})\n$$\n其中 $F_{i \\pm 1/2}$ 是网格界面 $x_{i \\pm 1/2}$ 处的数值通量。使用显式前向欧拉时间步长 $\\Delta t$，全离散更新式为：\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2}^n - F_{i-1/2}^n)\n$$\n物理通量函数为 $f(u) = a u$。由于平流速度 $a > 0$，信息从左向右传播。界面处的迎风 Godunov 通量由界面左侧的状态（记为 $u^L$）决定。因此，数值通量为：\n$$\nF_{i+1/2}^n = f(u_{i+1/2}^L) = a u_{i+1/2}^L\n$$\n$$\nF_{i-1/2}^n = f(u_{i-1/2}^L) = a u_{i-1/2}^L\n$$\n将这些代入更新公式可得：\n$$\nu_i^{n+1} = u_i^n - \\frac{a \\Delta t}{\\Delta x} (u_{i+1/2}^L - u_{i-1/2}^L)\n$$\n项 $C = \\frac{a \\Delta t}{\\Delta x}$ 是库朗数。\n\n守恒律单调上游中心格式 (MUSCL) 方法通过在时间 $t^n$ 的每个网格内重构分段线性解来达到二阶精度。在通用网格 $j$ 中，解可近似为：\n$$\nu(x) = u_j^n + s_j (x - x_j) = u_j^n + \\frac{\\sigma_j}{\\Delta x} (x - x_j)\n$$\n其中 $x_j$ 是网格 $j$ 的中心，$s_j$ 是斜率，而 $\\sigma_j = s_j \\Delta x$ 是整个网格的受限变化量。\n\n迎风状态 $u_{i+1/2}^L$ 是网格 $i$ 右边界处的值，使用网格 $i$ 的数据重构得到：\n$$\nu_{i+1/2}^L = u(x_{i+1/2}) = u_i^n + \\frac{\\sigma_i}{\\Delta x}(x_{i+1/2} - x_i) = u_i^n + \\frac{\\sigma_i}{\\Delta x}\\left(\\frac{\\Delta x}{2}\\right) = u_i^n + \\frac{1}{2}\\sigma_i\n$$\n类似地，迎风状态 $u_{i-1/2}^L$ 是网格 $i-1$ 右边界处的值，使用网格 $i-1$ 的数据重构得到：\n$$\nu_{i-1/2}^L = u(x_{i-1/2}) = u_{i-1}^n + \\frac{\\sigma_{i-1}}{\\Delta x}(x_{i-1/2} - x_{i-1}) = u_{i-1}^n + \\frac{\\sigma_{i-1}}{\\Delta x}\\left(\\frac{\\Delta x}{2}\\right) = u_{i-1}^n + \\frac{1}{2}\\sigma_{i-1}\n$$\n\n为保持稳定性并防止伪振荡，变化量 $\\sigma_j$ 会受到限制。本问题指定使用 van Leer 通量限制器。受限变化量 $\\sigma_j$ 是使用光滑度指标 $r_j$ 和限制器函数 $\\phi(r)$ 构建的：\n$$\nr_j = \\frac{u_j^n - u_{j-1}^n}{u_{j+1}^n - u_j^n}\n$$\n$$\n\\phi(r) = \\frac{r + |r|}{1 + |r|}\n$$\n网格 $j$ 中的受限变化量计算为 $\\sigma_j = \\phi(r_j)(u_{j+1}^n - u_j^n)$。\n\n现在，我们将此框架应用于给定数据：\n- 平流速度：$a = 1.5$\n- 网格间距：$\\Delta x = 10$\n- 时间步长：$\\Delta t = 4$\n- 网格平均值：$u_{i-2}^{n} = 0.80$，$u_{i-1}^{n} = 1.00$，$u_{i}^{n} = 1.10$，$u_{i+1}^{n} = 0.90$\n\n首先，我们计算库朗数：\n$$\nC = \\frac{a \\Delta t}{\\Delta x} = \\frac{1.5 \\times 4}{10} = \\frac{6}{10} = 0.6\n$$\n更新方程为 $u_i^{n+1} = u_i^n - 0.6(u_{i+1/2}^L - u_{i-1/2}^L)$。为了继续计算，我们必须计算 $u_{i+1/2}^L$ 和 $u_{i-1/2}^L$，这需要先求出 $\\sigma_i$ 和 $\\sigma_{i-1}$。\n\n第 1 步：计算网格 $i$ 的光滑度指标 $r_i$。\n所需的差值为：\n$$\nu_i^n - u_{i-1}^n = 1.10 - 1.00 = 0.10\n$$\n$$\nu_{i+1}^n - u_i^n = 0.90 - 1.10 = -0.20\n$$\n因此，光滑度指标为：\n$$\nr_i = \\frac{0.10}{-0.20} = -0.5\n$$\n\n第 2 步：计算受限变化量 $\\sigma_i$ 和受限斜率 $s_i$。\n应用 van Leer 限制器函数 $\\phi(r_i)$：\n$$\n\\phi(r_i) = \\phi(-0.5) = \\frac{-0.5 + |-0.5|}{1 + |-0.5|} = \\frac{-0.5 + 0.5}{1 + 0.5} = \\frac{0}{1.5} = 0\n$$\n网格 $i$ 中的受限变化量为：\n$$\n\\sigma_i = \\phi(r_i) (u_{i+1}^n - u_i^n) = 0 \\times (-0.20) = 0\n$$\n网格 $i$ 中的受限斜率，它控制着界面 $x_{i+1/2}$ 的重构，为 $s_i = \\sigma_i / \\Delta x = 0 / 10 = 0$。零斜率表明网格 $i$ 中的重构是分段常数，这是 TVD 格式在 $u_i^n$ 处检测到局部极值的结果。\n\n第 3 步：计算网格 $i-1$ 的光滑度指标 $r_{i-1}$。\n所需的差值为：\n$$\nu_{i-1}^n - u_{i-2}^n = 1.00 - 0.80 = 0.20\n$$\n$$\nu_i^n - u_{i-1}^n = 1.10 - 1.00 = 0.10\n$$\n因此，网格 $i-1$ 的光滑度指标为：\n$$\nr_{i-1} = \\frac{0.20}{0.10} = 2\n$$\n\n第 4 步：计算受限变化量 $\\sigma_{i-1}$。\n应用 van Leer 限制器函数 $\\phi(r_{i-1})$：\n$$\n\\phi(r_{i-1}) = \\phi(2) = \\frac{2 + |2|}{1 + |2|} = \\frac{2+2}{1+2} = \\frac{4}{3}\n$$\n网格 $i-1$ 中的受限变化量为：\n$$\n\\sigma_{i-1} = \\phi(r_{i-1}) (u_i^n - u_{i-1}^n) = \\frac{4}{3} \\times (0.10) = \\frac{4}{3} \\times \\frac{1}{10} = \\frac{4}{30} = \\frac{2}{15}\n$$\n\n第 5 步：重构界面状态 $u_{i+1/2}^L$ 和 $u_{i-1/2}^L$。\n$$\nu_{i+1/2}^L = u_i^n + \\frac{1}{2}\\sigma_i = 1.10 + \\frac{1}{2}(0) = 1.10\n$$\n$$\nu_{i-1/2}^L = u_{i-1}^n + \\frac{1}{2}\\sigma_{i-1} = 1.00 + \\frac{1}{2}\\left(\\frac{2}{15}\\right) = 1 + \\frac{1}{15} = \\frac{16}{15}\n$$\n\n第 6 步：计算最终更新值 $u_i^{n+1}$。\n将重构的状态和库朗数代入更新公式：\n$$\nu_i^{n+1} = u_i^n - C (u_{i+1/2}^L - u_{i-1/2}^L)\n$$\n$$\nu_i^{n+1} = 1.10 - 0.6 \\left( 1.10 - \\frac{16}{15} \\right)\n$$\n为保持精度，我们使用分数进行计算：$1.10 = \\frac{11}{10}$ 及 $0.6 = \\frac{6}{10} = \\frac{3}{5}$。\n$$\nu_i^{n+1} = \\frac{11}{10} - \\frac{3}{5} \\left( \\frac{11}{10} - \\frac{16}{15} \\right)\n$$\n为括号内的项找一个公分母：\n$$\n\\frac{11}{10} - \\frac{16}{15} = \\frac{11 \\times 3}{30} - \\frac{16 \\times 2}{30} = \\frac{33 - 32}{30} = \\frac{1}{30}\n$$\n现在代回原式：\n$$\nu_i^{n+1} = \\frac{11}{10} - \\frac{3}{5} \\left( \\frac{1}{30} \\right) = \\frac{11}{10} - \\frac{3}{150} = \\frac{11}{10} - \\frac{1}{50}\n$$\n最后，计算结果：\n$$\nu_i^{n+1} = \\frac{11 \\times 5}{50} - \\frac{1}{50} = \\frac{55 - 1}{50} = \\frac{54}{50} = \\frac{27}{25}\n$$\n该精确值的小数形式为 1.08。",
            "answer": "$$\n\\boxed{1.08}\n$$"
        },
        {
            "introduction": "不同的通量限制器具有独特的特性，这些特性直接影响着数值解的锐利度以及产生伪影的倾向。这个高级练习  将通过分析 “superbee” 限制器（一种最具压缩性的限制器）来深入探索总变差递减 (TVD) 格式的理论基础。通过确定该限制器在何处达到 TVD 区域的边界，您将深刻理解在清晰解析地球物理锋面与引入“阶梯状”伪影风险之间的内在权衡。",
            "id": "3618340",
            "problem": "考虑一种被动地球物理示踪剂的一维线性平流，其由偏微分方程 $u_{t} + a\\,u_{x} = 0$ 描述，其中平流速度 $a>0$ 为常数。采用均匀有限体积离散化方法，网格间距为 $\\Delta x$，显式时间步长为 $\\Delta t$，满足 $0  \\nu \\le 1$，其中 $\\nu = a\\,\\Delta t/\\Delta x$ 是库朗数。使用一种高分辨率的守恒律单调上游中心格式 (MUSCL) 重构，其中通量限制器函数 $\\phi(r)$ 应用于受限斜率，光滑度指示器 $r$ 定义为连续梯度的比率，对于单元 i，其定义为 $r_i = (u_i - u_{i-1}) / (u_{i+1} - u_i)$。\n\n从总变差的定义和离散更新的总变差递减 (TVD) 要求 $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^{n})$ 出发，推导在 TVD 约束下，当 $r \\ge 0$ 时，限制器 $\\phi(r)$ 的容许上界 $\\Phi_{\\mathrm{UB}}(r)$。然后，仅使用源自这些 TVD 约束的原理以及限制器在保持 TVD 的同时应最具压缩性的要求，确定对于哪些 $r \\ge 0$ 的值，所谓的“superbee”限制器达到了 TVD 上界饱和，即 $\\phi_{\\mathrm{SB}}(r) = \\Phi_{\\mathrm{UB}}(r)$。\n\n最后，作为你推理的一部分，解释这种饱和对该格式解析陡峭地球物理锋面的能力以及其在平流示踪剂剖面中产生阶梯效应的倾向意味着什么。将最终的 $r$ 值集合表示为关于 $r$ 的闭区间的并集。无需四舍五入，最终答案中没有单位。",
            "solution": "本问题要求推导通量限制器函数 $\\phi(r)$ 的上界以确保格式是总变差递减 (TVD) 的，然后确定 \"superbee\" 限制器在何处达到该上界的饱和。\n\n为了使一个数值格式成为 TVD 格式，解的总变差必须不随时间增加：$\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^{n})$。对于应用于线性平流方程（$a>0$）的高分辨率 MUSCL 类格式，这一要求对通量限制器函数 $\\phi(r)$ 施加了约束，其中 $r$ 是连续梯度的比率。这些约束定义了“Sweby 图”或“TVD 区域”。\n\n对于 $r \\ge 0$，使格式成为 TVD 的充分条件是：\n1.  $\\phi(r) \\ge 0$\n2.  $\\phi(r) \\le 2r$\n3.  $\\phi(r) \\le 2$\n\n这些不等式确保了不会产生新的局部极值，并且现有极值不会被放大。\n\n**1. 推导容许上界 $\\Phi_{\\mathrm{UB}}(r)$**\n\n$\\phi(r)$ 的上界由上述约束中最严格的一个决定。根据条件，$\\phi(r)$ 必须小于或等于 $2r$ 和 $2$。因此，总的上界 $\\Phi_{\\mathrm{UB}}(r)$ 是这两者中的最小值：\n$$\n\\Phi_{\\mathrm{UB}}(r) = \\min(2, 2r)\n$$\n这个上界可以为 $r \\ge 0$ 分段表示：\n-   对于 $0 \\le r  1$，我们有 $2r  2$。因此，$\\Phi_{\\mathrm{UB}}(r) = 2r$。\n-   对于 $r \\ge 1$，我们有 $2r \\ge 2$。因此，$\\Phi_{\\mathrm{UB}}(r) = 2$。\n\n所以，TVD 上界是：\n$$\n\\Phi_{\\mathrm{UB}}(r) = \\begin{cases} 2r  \\text{对于 } 0 \\le r  1 \\\\ 2  \\text{对于 } r \\ge 1 \\end{cases}\n$$\n一个位于此边界上的限制器在保持 TVD 的同时被认为是具有最大“压缩性”的。\n\n**2. 分析 Superbee 限制器的饱和情况**\n\nsuperbee 通量限制器定义为：\n$$\n\\phi_{\\mathrm{SB}}(r) = \\max(0, \\min(1, 2r), \\min(r, 2))\n$$\n我们需要找到使 $\\phi_{\\mathrm{SB}}(r) = \\Phi_{\\mathrm{UB}}(r)$ 成立的 $r \\ge 0$ 的值。由于当 $r \\ge 0$ 时，$\\max$ 函数内的所有项都是非负的，我们可以将表达式简化为：\n$$\n\\phi_{\\mathrm{SB}}(r) = \\max(\\min(1, 2r), \\min(r, 2))\n$$\n让我们分段分析这个函数：\n-   对于 $0 \\le r \\le 1/2$：$\\min(1, 2r) = 2r$ 且 $\\min(r, 2) = r$。因此，$\\phi_{\\mathrm{SB}}(r) = \\max(2r, r) = 2r$。在此区间内，上界为 $\\Phi_{\\mathrm{UB}}(r) = 2r$。所以，$\\phi_{\\mathrm{SB}}(r) = \\Phi_{\\mathrm{UB}}(r)$。\n-   对于 $1/2  r  1$：$\\min(1, 2r) = 1$ 且 $\\min(r, 2) = r$。因此，$\\phi_{\\mathrm{SB}}(r) = \\max(1, r) = 1$。上界为 $\\Phi_{\\mathrm{UB}}(r) = 2r$。由于 $r > 1/2$，所以 $2r > 1$，因此 $\\phi_{\\mathrm{SB}}(r)  \\Phi_{\\mathrm{UB}}(r)$。不发生饱和。\n-   对于 $1 \\le r  2$：$\\min(1, 2r) = 1$ 且 $\\min(r, 2) = r$。因此，$\\phi_{\\mathrm{SB}}(r) = \\max(1, r) = r$。上界为 $\\Phi_{\\mathrm{UB}}(r) = 2$。由于 $r  2$，所以 $\\phi_{\\mathrm{SB}}(r)  \\Phi_{\\mathrm{UB}}(r)$。不发生饱和。\n-   对于 $r \\ge 2$：$\\min(1, 2r) = 1$ 且 $\\min(r, 2) = 2$。因此，$\\phi_{\\mathrm{SB}}(r) = \\max(1, 2) = 2$。上界为 $\\Phi_{\\mathrm{UB}}(r) = 2$。所以，$\\phi_{\\mathrm{SB}}(r) = \\Phi_{\\mathrm{UB}}(r)$。\n\n综合这些结果，superbee 限制器在 $r \\in [0, 1/2]$ 和 $r \\in [2, \\infty)$ 时达到 TVD 上界的饱和。值的集合是这两个闭区间的并集。\n\n**3. 饱和的含义**\n\n当一个限制器达到 TVD 上界饱和时，它在不违反 TVD 属性的前提下，尽可能地具有“压缩性”（或抗扩散性）。这对模拟地球物理示踪剂有两个主要影响：\n\n-   **解析陡峭锋面的能力**：高的压缩性对于解析锋面或间断等陡峭特征非常有效。限制器允许对解的剖面进行最陡峭的重构，这可以抵抗数值扩散的抹平效应。superbee 限制器以其能够在长时间模拟中保持接触间断的尖锐性而闻名，这正是其压缩性质的直接结果，尤其是在它达到饱和的区域（此时梯度变化剧烈，导致 $r$ 值很小或很大）。\n\n-   **产生“阶梯状”伪影的倾向**：这种激进方法的代价是倾向于将光滑的剖面转变为一系列陡峭的梯度和平坦的区域，这种伪影被称为“阶梯效应”。虽然 superbee 限制器是 TVD 的，不会产生过冲，但其强烈的压缩特性会扭曲光滑解，使其看起来呈块状或阶梯状。这是因为限制器试图将任何缓坡都变得陡峭。\n\n总之，superbee 限制器在 $r \\in [0, 1/2] \\cup [2, \\infty)$ 区间内达到 TVD 上界的饱和，这解释了它的双重特性：它非常适合处理尖锐的间断，但也可能在光滑区域引入阶梯状伪影。\n\nsuperbee 限制器达到 TVD 上界饱和时，对应的 $r \\ge 0$ 的值集合为 $[0, 1/2] \\cup [2, \\infty)$。",
            "answer": "$$\\boxed{[0, 1/2] \\cup [2, \\infty)}$$"
        }
    ]
}