{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration of post-glacial rebound, we first address the fundamental physics governing the Earth's response to load changes. This exercise guides you through the derivation of the vertical displacement, $w(t)$, for a simple yet powerful idealization: a Maxwell viscoelastic half-space subjected to an instantaneous change in surface load. By connecting first principles to the classic exponential relaxation model, this practice builds the essential conceptual and mathematical foundation for all subsequent PGR modeling .",
            "id": "3610916",
            "problem": "Consider post-glacial rebound modeled as the quasi-static vertical response of a Maxwell viscoelastic half-space representing the Earth's upper mantle to an instantaneous change in surface load at time $t=0$. Assume the mantle behaves as a linear Maxwell solid with shear viscosity $\\eta$ and shear modulus $\\mu$, and neglect inertial terms so that equilibrium is governed by force balance and compatibility. The removal or application of an ice load can be idealized as a uniform step change in surface pressure $p_{0}$, leading to a finite equilibrium vertical displacement $w_{\\infty}$ determined by isostatic balance. For a small perturbation about equilibrium, linear viscoelastic correspondence implies that the scalar misfit to equilibrium relaxes exponentially with a characteristic Maxwell time $\\tau$ that depends only on the mantle rheology.\n\nStarting from (i) quasi-static linear momentum balance, (ii) linear strain compatibility at the surface, and (iii) the Maxwell constitutive law relating deviatoric stress and strain rate, derive the scalar initial-value problem that governs the vertical displacement $w(t)$ at the surface following the step change in load at $t=0$, and obtain the displacement history $w(t)$ as a function of $t$, $\\eta$, $\\mu$, and $w_{\\infty}$. Then, using the parameters $\\eta = 1 \\times 10^{21} \\,\\mathrm{Pa\\,s}$, $\\mu = 7 \\times 10^{10} \\,\\mathrm{Pa}$, $w_{\\infty} = 10 \\,\\mathrm{m}$, and $t = 3000 \\,\\mathrm{yr}$, evaluate the displacement $w(t)$ numerically. Use the International System of Units for time ($\\mathrm{s}$), and round your final numerical answer to four significant figures. Express the final displacement in meters.",
            "solution": "The goal is to obtain the vertical displacement history $w(t)$ at the surface of a viscoelastic Maxwell half-space subjected to an instantaneous step change in surface pressure $p_{0}$ at $t=0$. We set up the problem using basic principles appropriate for quasi-static viscoelastic deformation.\n\nFirst, we recall the quasi-static linear momentum balance in the absence of inertia,\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{g} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\rho$ is density, and $\\boldsymbol{g}$ is gravitational acceleration. At the free surface, a step change in applied surface pressure $p_{0}$ modifies the boundary traction instantaneously. The post-load vertical displacement $w(t)$ at the surface evolves as the mantle relaxes viscoelastically toward an isostatic equilibrium displacement $w_{\\infty}$ for which the net buoyant restoring force exactly balances the applied surface load change.\n\nTo model the viscoelastic response, we adopt the Maxwell constitutive law for deviatoric stress and strain. In one-dimensional scalar form appropriate for a single relaxation mode, the Maxwell relation between deviatoric stress $\\sigma$ and strain $\\epsilon$ can be written as\n$$\n\\dot{\\epsilon} = \\frac{\\dot{\\sigma}}{\\mu} + \\frac{\\sigma}{\\eta},\n$$\nwhere $\\mu$ is the elastic shear modulus, $\\eta$ is the shear viscosity, and overdots denote time derivatives. This is equivalent to the standard form for a Maxwell element (spring and dashpot in series) in terms of the relaxation of stress under imposed deformation.\n\nThe vertical displacement $w(t)$ at the surface arises from a combination of elastic shear deformation and viscous flow in the mantle. For a uniform axisymmetric response linearized about equilibrium, we can write the scalar misfit between the instantaneous displacement and its equilibrium counterpart as\n$$\n\\delta w(t) \\equiv w_{\\infty} - w(t).\n$$\nBecause $w_{\\infty}$ is the static displacement that balances the step load $p_{0}$ through isostatic restoring forces, $\\delta w$ is proportional to the deviatoric stress that remains to be relaxed. In a linear spring representation, we write\n$$\n\\sigma(t) = k \\,\\delta w(t),\n$$\nwhere $k$ is an effective scalar stiffness summarizing the geometric and elastic coupling in the half-space. The strain rate at the surface is proportional to the rate of change of displacement, $\\dot{\\epsilon} \\propto \\dot{w}$. Under the linearized one-mode approximation, we absorb geometric factors into $k$ so that the Maxwell law becomes a scalar evolution equation for $\\delta w(t)$.\n\nDifferentiating $\\sigma(t) = k \\,\\delta w(t)$ and substituting into the Maxwell relation yields\n$$\n\\dot{\\epsilon} = \\frac{k \\,\\dot{\\delta w}}{\\mu} + \\frac{k \\,\\delta w}{\\eta}.\n$$\nAt the surface, compatibility implies $\\dot{\\epsilon} \\propto -\\dot{\\delta w}$ because increasing $w$ reduces the misfit $\\delta w$. With proportionality constants absorbed into $k$ by linear rescaling, the evolution reduces to the canonical first-order relaxation equation for the misfit:\n$$\n\\dot{\\delta w}(t) = -\\frac{1}{\\tau} \\,\\delta w(t),\n$$\nwhere the characteristic Maxwell time is\n$$\n\\tau = \\frac{\\eta}{\\mu}.\n$$\nThis result can also be derived rigorously via the viscoelastic correspondence principle by replacing the elastic shear modulus in the elastic Green's function with the Maxwell relaxation modulus and taking the step-load limit; the outcome for a single Maxwell mode is exponential relaxation with time constant $\\tau$.\n\nSolving the initial-value problem $\\dot{\\delta w} = -\\delta w/\\tau$ with initial condition $\\delta w(0) = w_{\\infty} - w(0)$ and recognizing that the instantaneous elastic response at $t=0^{+}$ to a step load is bounded while the viscoelastic relaxation drives $w$ to $w_{\\infty}$, we obtain\n$$\n\\delta w(t) = \\delta w(0) \\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right).\n$$\nFor a canonical step-load (or unload) experiment normalized so that the misfit at $t=0^{+}$ equals $w_{\\infty}$, the displacement history takes the standard form\n$$\nw(t) = w_{\\infty} \\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right).\n$$\n\nWe now compute the numerical value of $w(t)$ for the given parameters. The Maxwell time is\n$$\n\\tau = \\frac{\\eta}{\\mu} = \\frac{1 \\times 10^{21} \\,\\mathrm{Pa\\,s}}{7 \\times 10^{10} \\,\\mathrm{Pa}} = \\frac{1}{7} \\times 10^{11} \\,\\mathrm{s} = 1.42857142857 \\times 10^{10} \\,\\mathrm{s}.\n$$\nThe time $t$ must be converted to seconds. One Julian year equals $365.25 \\times 24 \\times 3600 = 31{,}557{,}600 \\,\\mathrm{s}$. Therefore,\n$$\nt = 3000 \\,\\mathrm{yr} = 3000 \\times 31{,}557{,}600 \\,\\mathrm{s} = 9.46728 \\times 10^{10} \\,\\mathrm{s}.\n$$\nCompute the dimensionless ratio\n$$\n\\frac{t}{\\tau} = \\frac{9.46728 \\times 10^{10}}{1.42857142857 \\times 10^{10}} \\approx 6.627096.\n$$\nThen\n$$\n\\exp\\!\\left(-\\frac{t}{\\tau}\\right) = \\exp(-6.627096) \\approx 0.001324,\n$$\nand hence\n$$\nw(t) = 10 \\,\\mathrm{m} \\times \\left(1 - 0.001324\\right) \\approx 9.98676 \\,\\mathrm{m}.\n$$\nRounded to four significant figures, the displacement is\n$$\nw(t) \\approx 9.987 \\,\\mathrm{m}.\n$$",
            "answer": "$$\\boxed{9.987}$$"
        },
        {
            "introduction": "Real-world geophysical modeling always involves a trade-off between physical realism and computational tractability. This practice explores a critical choice in PGR modeling: whether to approximate the Earth as a flat half-space or a full sphere. By analyzing a disk-shaped load, you will determine a quantitative criterion, an effective spherical harmonic degree $\\ell_{\\mathrm{eff}}$, that delineates when the simpler half-space approximation is scientifically justifiable, honing your ability to assess the validity of model assumptions .",
            "id": "3610909",
            "problem": "Consider a uniform, axisymmetric surface load of constant pressure $p$ applied over a circular disk of radius $a$ centered at $r=0$ on two different Earth models: (i) an isotropic, homogeneous, linear elastic half-space and (ii) an isotropic, homogeneous, incompressible, self-gravitating viscoelastic spherical Earth of radius $R$. Assume small deformations throughout and axisymmetry about the disk center. Let $w(r)$ denote the instantaneous vertical surface deflection profile and $u(t)$ denote the subsequent viscoelastic vertical motion at the disk center following an instantaneous removal of the load at time $t=0$ after a long pre-load history. The elastic half-space has Young’s modulus $E$ and Poisson’s ratio $\\nu$ (with shear modulus $\\mu = E/[2(1+\\nu)]$), and the spherical Earth has the same elastic parameters and uniform viscosity $\\eta$ (Maxwell rheology).\n\nStarting from the linear momentum balance, the isotropic linear elastic constitutive law, and the traction boundary condition, proceed as follows:\n\n- Use the axisymmetric Hankel transform to write the elastic half-space solution in spectral form, relating the Hankel transform of $w(r)$ to the Hankel transform of the applied pressure. From this, obtain a closed-form expression for the instantaneous vertical deflection at the disk center, $w(0)$, in terms of $p$, $a$, $E$, and $\\nu$.\n\n- Using small-angle asymptotics that connect plane-wave and spherical-harmonic representations, relate a local radial wavenumber $k$ on the sphere to spherical harmonic degree $\\ell$ via the leading-order mapping $k \\approx (\\ell + 1/2)/R$ for $\\theta \\ll 1$, where $\\theta$ is colatitude.\n\n- The axisymmetric uniform disk load has a Hankel transform with its first spectral zero at $k a = j_{1,1}$, where $j_{1,1}$ is the first positive zero of the Bessel function $J_{1}$. Define the effective spherical degree $\\ell_{\\mathrm{eff}}$ of the disk load as the spherical degree corresponding to this first spectral zero under the small-angle mapping. Express $\\ell_{\\mathrm{eff}}$ as a closed-form expression in terms of $a$, $R$, and $j_{1,1}$.\n\n- Briefly justify why the half-space predictions for both $w(r)$ and the center uplift history $u(t)$ are acceptable when the load is spectrally concentrated at degrees $\\ell \\gg 1$, and explain how your $\\ell_{\\mathrm{eff}}$ quantifies this regime.\n\nProvide the final answer as the single, closed-form analytic expression you obtain for $\\ell_{\\mathrm{eff}}$. No numerical evaluation is required, and no units are needed since $\\ell_{\\mathrm{eff}}$ is dimensionless. If you perform any auxiliary numerical checks, do not include them in the final boxed answer.",
            "solution": "The problem requires the derivation of an effective spherical harmonic degree, $\\ell_{\\mathrm{eff}}$, for a circular disk load, based on a correspondence between planar and spherical geometries. We will proceed by first analyzing the load on an elastic half-space to understand its spectral characteristics, and then map these characteristics to a spherical geometry.\n\nFirst, we address the instantaneous vertical deflection of a linear elastic half-space under the specified load. The load is a uniform pressure $p$ applied over a circular disk of radius $a$. The vertical surface traction is $\\sigma_{zz}(r, z=0) = -p(r)$, where $p(r) = p$ for $r \\le a$ and $p(r) = 0$ for $r > a$. Due to the axial symmetry, we employ the Hankel transform. The order-zero Hankel transform of the pressure distribution $p(r)$ is given by:\n$$ \\hat{p}(k) = \\int_0^\\infty p(r) J_0(kr) r \\, dr = \\int_0^a p J_0(kr) r \\, dr $$\nUsing the identity $\\int x J_0(x) \\, dx = x J_1(x)$, we find:\n$$ \\hat{p}(k) = p \\left[ \\frac{r J_1(kr)}{k} \\right]_0^a = \\frac{p a J_1(ka)}{k} $$\nwhere $k$ is the radial wavenumber and $J_n$ is the Bessel function of the first kind of order $n$.\n\nFor a linear elastic half-space with Young's modulus $E$ and Poisson's ratio $\\nu$, the relationship between the Hankel transform of the vertical surface deflection, $\\hat{w}(k)$, and the Hankel transform of the applied surface pressure, $\\hat{p}(k)$, is given by the spectral Green's function for the Boussinesq problem:\n$$ \\hat{w}(k) = \\frac{2(1-\\nu^2)}{E k} \\hat{p}(k) $$\nSubstituting the expression for $\\hat{p}(k)$, we obtain the spectral representation of the deflection:\n$$ \\hat{w}(k) = \\frac{2(1-\\nu^2)}{E k} \\left( \\frac{p a J_1(ka)}{k} \\right) = \\frac{2(1-\\nu^2) p a}{E} \\frac{J_1(ka)}{k^2} $$\nThe vertical deflection at the center of the load, $w(0)$, is recovered through the inverse Hankel transform evaluated at $r=0$:\n$$ w(0) = \\int_0^\\infty \\hat{w}(k) J_0(k \\cdot 0) k \\, dk = \\int_0^\\infty k \\hat{w}(k) \\, dk $$\nSubstituting our expression for $\\hat{w}(k)$:\n$$ w(0) = \\int_0^\\infty k \\left( \\frac{2(1-\\nu^2) p a}{E} \\frac{J_1(ka)}{k^2} \\right) dk = \\frac{2(1-\\nu^2) p a}{E} \\int_0^\\infty \\frac{J_1(ka)}{k} \\, dk $$\nWe perform a change of variables with $u = ka$, so $du = a \\, dk$ and $k=u/a$. The integral becomes:\n$$ \\int_0^\\infty \\frac{J_1(u)}{u/a} \\frac{du}{a} = \\int_0^\\infty \\frac{J_1(u)}{u} \\, du $$\nThis is a standard definite integral with the value of $1$. Therefore, the deflection at the center is:\n$$ w(0) = \\frac{2(1-\\nu^2) p a}{E} $$\n\nNext, we establish the connection between the planar (half-space) and spherical geometries. The problem provides the small-angle asymptotic relationship between the planar radial wavenumber $k$ and the spherical harmonic degree $\\ell$:\n$$ k \\approx \\frac{\\ell + 1/2}{R} $$\nThis approximation is valid for features with horizontal scales much smaller than the radius of the sphere $R$, i.e., for $\\ell \\gg 1$.\n\nThe problem defines an effective spherical degree, $\\ell_{\\mathrm{eff}}$, based on the spectral characteristics of the disk load. The spectral content of the load is described by its Hankel transform, $\\hat{p}(k) = p a J_1(ka)/k$. The first spectral zero of this load function (excluding the removable singularity at $k=0$) occurs at the first positive zero of the Bessel function $J_1(x)$. Let this zero be denoted by $j_{1,1}$. The wavenumber $k_0$ corresponding to this first spectral zero satisfies the condition:\n$$ k_0 a = j_{1,1} $$\nThis gives the characteristic wavenumber of the load as:\n$$ k_0 = \\frac{j_{1,1}}{a} $$\nThe effective spherical degree $\\ell_{\\mathrm{eff}}$ is defined as the degree $\\ell$ that corresponds to this wavenumber $k_0$ under the given mapping. We substitute $k=k_0$ and $\\ell=\\ell_{\\mathrm{eff}}$ into the mapping equation:\n$$ \\frac{j_{1,1}}{a} = \\frac{\\ell_{\\mathrm{eff}} + 1/2}{R} $$\nSolving this equation for $\\ell_{\\mathrm{eff}}$ yields the desired expression:\n$$ \\ell_{\\mathrm{eff}} + \\frac{1}{2} = \\frac{j_{1,1} R}{a} $$\n$$ \\ell_{\\mathrm{eff}} = \\frac{j_{1,1} R}{a} - \\frac{1}{2} $$\n\nFinally, we justify the use of a half-space model when the load is spectrally concentrated at high degrees, i.e., $\\ell \\gg 1$. High spherical harmonic degrees correspond to short-wavelength features on the sphere. The characteristic wavelength $\\lambda$ of a feature at degree $\\ell$ is approximately $\\lambda \\approx 2\\pi R / \\ell$. The condition $\\ell \\gg 1$ thus implies that the wavelength of the deformation is much smaller than the radius of the sphere, $\\lambda \\ll R$. When the spatial scale of the physical process (here, defined by the load radius $a$) is significantly smaller than the radius of curvature of the surface, the surface can be accurately approximated as a flat plane. The half-space model is precisely this flat-plane approximation.\n\nThe effective degree $\\ell_{\\mathrm{eff}}$ quantifies this condition. The half-space approximation is valid when $\\ell_{\\mathrm{eff}} \\gg 1$. From our derived expression, this means:\n$$ \\frac{j_{1,1} R}{a} - \\frac{1}{2} \\gg 1 \\implies \\frac{j_{1,1} R}{a} \\gg 1 $$\nSince $j_{1,1} \\approx 3.8317$ is a number of order unity, this condition simplifies to $R/a \\gg 1$, or $a \\ll R$. This is the intuitive physical condition that the load radius must be much smaller than the planetary radius for the planet's curvature to be negligible.\nThis reasoning applies to both the instantaneous elastic deflection $w(r)$ and the subsequent viscoelastic uplift history $u(t)$. The spatial pattern of the viscoelastic response is governed by the same spherical harmonic degrees as the initial elastic deformation. Therefore, if the load's spectrum is dominated by high degrees (i.e., $\\ell_{\\mathrm{eff}} \\gg 1$), a viscoelastic half-space model provides a valid approximation for the full spherical viscoelastic response.",
            "answer": "$$\\boxed{\\frac{j_{1,1} R}{a} - \\frac{1}{2}}$$"
        },
        {
            "introduction": "The ultimate goal of geophysical modeling is often to infer the Earth's internal structure from surface observations, a process known as inversion. This advanced practice challenges you to develop and implement a full inversion scheme to determine the lithosphere's spatially varying elastic thickness, $T_e(\\theta, \\phi)$, from synthetic uplift data. By linearizing a complex physical model that couples plate flexure with mantle flow and applying Tikhonov regularization, you will gain hands-on experience with the powerful techniques used to turn geophysical data into quantitative knowledge about our planet .",
            "id": "3610912",
            "problem": "Consider a spherical cap region of the Earth's surface represented by local spherical coordinates $(\\theta,\\phi)$ and approximated as a planar patch over the scale of interest. The goal is to invert for a spatially varying elastic thickness field $T_e(\\theta,\\phi)$ of the lithosphere by exploiting observations of post-glacial uplift residuals and a mechanistic model that couples lithospheric flexure under ice loads with viscoelastic mantle flow. The physically relevant starting points are thin-plate flexure under transverse load and Maxwell viscoelastic relaxation in the mantle. The lithosphere is modeled as a thin elastic plate with flexural rigidity $D(\\theta,\\phi)$ and the mantle as a linear Maxwell material with viscosity $\\eta$ and shear modulus $\\mu$. The ice load is specified as a spatially varying surface pressure $q(\\theta,\\phi)$ over the patch.\n\nYou must derive, justify, and implement an inversion for a two-parameter, piecewise-constant representation of $T_e(\\theta,\\phi)$: region $\\Omega_A$ with unknown elastic thickness $T_e^A$ and region $\\Omega_B$ with unknown elastic thickness $T_e^B$. The partition is defined by a vertical meridian in the local planar approximation: the left half-plane is $\\Omega_A$ and the right half-plane is $\\Omega_B$. Assume the observed uplift residual field $u_{\\mathrm{obs}}(\\theta,\\phi)$ is collected at a single time $t$ after instantaneous deglaciation at $t=0$.\n\nStart from the following valid bases:\n- Thin-plate flexure under a transverse load: the governing equation for a plate of flexural rigidity $D$ and transverse load $q$ is\n$$\nD \\nabla^4 w = q,\n$$\nwhere $w(\\theta,\\phi)$ is the vertical deflection. For spatially varying $D(\\theta,\\phi)$, justify an appropriate approximation that connects the dominant spatial wavenumber of the load to deflection amplitude.\n- Maxwell viscoelastic mantle response: for a Maxwell material with viscosity $\\eta$ and shear modulus $\\mu$, the characteristic Maxwell time is\n$$\n\\tau = \\frac{\\eta}{\\mu}.\n$$\nUnder a step removal of load at $t=0$, the fraction of elastic recovery achieved by time $t$ is\n$$\nf(t) = 1 - e^{-t/\\tau}.\n$$\n\nYour inversion must be formulated in purely mathematical terms, producing a well-posed system for the two unknown parameters $T_e^A$ and $T_e^B$ and regularized to ensure stability. You must enforce physical positivity of the inferred parameters. Use the flexural rigidity definition for the lithosphere,\n$$\nD(\\theta,\\phi) = \\frac{E \\, T_e(\\theta,\\phi)^3}{12 \\left(1-\\nu^2\\right)},\n$$\nwhere $E$ is Young's modulus and $\\nu$ is Poisson's ratio. Clearly state any modeling approximation necessary to connect $q(\\theta,\\phi)$, $D(\\theta,\\phi)$, and $u_{\\mathrm{obs}}(\\theta,\\phi)$.\n\nYou must implement a complete program that constructs synthetic observations $u_{\\mathrm{obs}}(\\theta,\\phi)$ from known true values of $T_e^A$ and $T_e^B$, adds small Gaussian noise to emulate measurement and model error, and then performs the inversion to estimate $T_e^A$ and $T_e^B$. Use a square grid of size $N \\times N$ points with $N = 16$ over a local planar domain with Cartesian coordinates $(x,y) \\in [-1,1] \\times [-1,1]$ mapping the left half-plane $x < 0$ to $\\Omega_A$ and the right half-plane $x \\ge 0$ to $\\Omega_B$. Use a spatially varying ice load defined by a Gaussian pressure hump centered at the origin,\n$$\nq(x,y) = p_0 \\exp\\left(-\\frac{x^2 + y^2}{2\\sigma^2}\\right),\n$$\nwith $p_0$ and $\\sigma$ specified below. Use a single dominant spatial wavenumber $k_0 = \\frac{2\\pi}{L}$ associated with an effective length scale $L$. All parameters must be physically plausible and consistent. Your inversion must incorporate Tikhonov regularization with parameter $\\lambda$ and must enforce non-negativity of the model parameters. The mathematical inversion you design must be derived from the bases above, not from pre-given shortcut formulas.\n\nPhysical and numerical units:\n- Express $T_e$ in $\\mathrm{km}$.\n- Express $q$ in $\\mathrm{Pa}$.\n- Express $u_{\\mathrm{obs}}$ in $\\mathrm{m}$.\n- Express time $t$ in $\\mathrm{s}$ internally; test inputs specify $t$ in $\\mathrm{yr}$, with $1\\,\\mathrm{yr} = 365.25 \\times 24 \\times 3600\\,\\mathrm{s}$.\n- All angles are not required in this local planar approximation.\n\nTest suite and parameters:\n- Common constants across all tests: $N = 16$, $E = 7.0 \\times 10^{10}\\,\\mathrm{Pa}$, $\\nu = 0.25$, $\\mu = 6.7 \\times 10^{10}\\,\\mathrm{Pa}$, $p_0 = 2.0 \\times 10^{7}\\,\\mathrm{Pa}$, $\\sigma = 0.40$ (dimensionless on the $[-1,1]$ grid), $\\lambda = 1.0 \\times 10^{-4}$.\n- Test case $1$ (general case):\n  - True values: $T_e^A = 40\\,\\mathrm{km}$, $T_e^B = 60\\,\\mathrm{km}$.\n  - Mantle viscosity: $\\eta = 1.0 \\times 10^{21}\\,\\mathrm{Pa\\,s}$.\n  - Observation time: $t = 2000\\,\\mathrm{yr}$.\n  - Effective length scale: $L = 200000\\,\\mathrm{m}$.\n  - Noise standard deviation added to $u_{\\mathrm{obs}}$: $0.002\\,\\mathrm{m}$.\n- Test case $2$ (boundary relaxation, equal thickness):\n  - True values: $T_e^A = 30\\,\\mathrm{km}$, $T_e^B = 30\\,\\mathrm{km}$.\n  - Mantle viscosity: $\\eta = 5.0 \\times 10^{22}\\,\\mathrm{Pa\\,s}$.\n  - Observation time: $t = 1000\\,\\mathrm{yr}$.\n  - Effective length scale: $L = 200000\\,\\mathrm{m}$.\n  - Noise standard deviation added to $u_{\\mathrm{obs}}$: $0.001\\,\\mathrm{m}$.\n- Test case $3$ (fast relaxation, strong contrast):\n  - True values: $T_e^A = 35\\,\\mathrm{km}$, $T_e^B = 80\\,\\mathrm{km}$.\n  - Mantle viscosity: $\\eta = 5.0 \\times 10^{20}\\,\\mathrm{Pa\\,s}$.\n  - Observation time: $t = 3000\\,\\mathrm{yr}$.\n  - Effective length scale: $L = 250000\\,\\mathrm{m}$.\n  - Noise standard deviation added to $u_{\\mathrm{obs}}$: $0.003\\,\\mathrm{m}$.\n\nRequired final output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain, in order, the estimated values $[T_e^A(\\mathrm{km}), T_e^B(\\mathrm{km})]$ for Test $1$, followed by Test $2$, followed by Test $3$, each rounded to two decimals, resulting in a flat list of $6$ floats, for example $[t_{1A},t_{1B},t_{2A},t_{2B},t_{3A},t_{3B}]$ where each $t_{ij}$ is in $\\mathrm{km}$ rounded to two decimals.",
            "solution": "**1. Derivation of the Forward Model**\n\nThe objective is to establish a mathematical relationship, the forward model, that predicts the observed uplift residual $u_{\\mathrm{obs}}(x,y)$ based on a given elastic thickness field $T_e(x,y)$ and other physical parameters.\n\nThe lithosphere is modeled as a thin elastic plate. Its initial static deflection, $w(x,y)$, under an ice load $q(x,y)$ is governed by the biharmonic equation of plate flexure:\n$$\n\\nabla \\cdot \\nabla (D(x,y) \\nabla^2 w(x,y)) - (1-\\nu) \\mathcal{L}(D,w) = q(x,y)\n$$\nwhere $D(x,y)$ is the spatially varying flexural rigidity and $\\mathcal{L}$ is a complex differential operator. For a constant $D$, this simplifies to $D \\nabla^4 w = q$. The problem statement gives this simplified form as a starting basis and acknowledges that $D$ is spatially varying. To make the problem tractable, we must employ a simplifying approximation as prompted.\n\nThe prompt requires justification for an approximation connecting the dominant spatial wavenumber of the load to the deflection. A common and physically reasonable approximation, particularly when the load's characteristic wavelength is smaller than the scale of variation in lithospheric properties, is the \"local response\" or \"local lithosphere\" approximation. This assumes that the deflection at a point $(x,y)$ is primarily determined by the local flexural rigidity $D(x,y)$. In the spectral domain, this is equivalent to assuming that the Fourier components of the deflection $W(\\mathbf{k})$ are related to the Fourier components of the load $Q(\\mathbf{k})$ by a local, position-dependent transfer function. For a dominant wavenumber $k_0 = 2\\pi/L$ representing the effective scale of the load, the $\\nabla^4$ operator can be approximated by a multiplication by $k_0^4$. This yields a local algebraic relationship:\n$$\nD(x,y) k_0^4 w(x,y) \\approx q(x,y)\n$$\nFrom this, we can express the initial elastic deflection $w(x,y)$ as:\n$$\nw(x,y) \\approx \\frac{q(x,y)}{D(x,y) k_0^4}\n$$\nThe flexural rigidity $D(x,y)$ is related to the elastic thickness $T_e(x,y)$ by:\n$$\nD(x,y) = \\frac{E \\, T_e(x,y)^3}{12 \\left(1-\\nu^2\\right)}\n$$\nwhere $E$ is Young's modulus and $\\nu$ is Poisson's ratio. Substituting this into the expression for $w(x,y)$:\n$$\nw(x,y) \\approx \\frac{q(x,y)}{k_0^4} \\left( \\frac{12(1-\\nu^2)}{E \\, T_e(x,y)^3} \\right)\n$$\nFollowing instantaneous deglaciation at $t=0$, the lithosphere rebounds due to viscoelastic flow in the mantle. The mantle is modeled as a Maxwell material, for which the characteristic relaxation time is $\\tau = \\eta/\\mu$, where $\\eta$ is viscosity and $\\mu$ is the shear modulus. The fraction of the total initial elastic deflection recovered by time $t$ is given as $f(t) = 1 - e^{-t/\\tau}$. The observed uplift residual $u(x,y,t)$ is this fraction of the initial deflection:\n$$\nu(x,y,t) = w(x,y) f(t) = w(x,y) \\left(1 - e^{-t/\\tau}\\right)\n$$\nCombining these equations yields the complete forward model:\n$$\nu(x,y,t) = \\frac{q(x,y)}{k_0^4} \\left( \\frac{12(1-\\nu^2)}{E} \\right) \\frac{1}{T_e(x,y)^3} \\left(1 - e^{-t/\\tau}\\right)\n$$\nThis equation predicts the uplift at any point $(x,y)$ and time $t$ given the local load, local elastic thickness, and mantle properties.\n\n**2. Formulation of the Inverse Problem**\n\nThe inverse problem aims to estimate the two unknown parameters, $T_e^A$ and $T_e^B$, from a grid of noisy uplift observations, $\\mathbf{d} = \\{u_{\\mathrm{obs}}(x_i, y_i)\\}$. The forward model is non-linear with respect to $T_e$. To formulate a linear inverse problem, we define a new set of model parameters:\n$$\nm_A = \\frac{1}{(T_e^A)^3} \\quad \\text{and} \\quad m_B = \\frac{1}{(T_e^B)^3}\n$$\nThe vector of unknown model parameters is $\\mathbf{m} = [m_A, m_B]^T$.\n\nLet's rewrite the forward model in terms of these new parameters. At each observation point $(x_i, y_i)$, the predicted uplift is:\n$$\nu_i = K_i \\cdot m(x_i)\n$$\nwhere $m(x_i)$ is either $m_A$ or $m_B$ depending on the region, and $K_i$ is a known coefficient encapsulating all other terms:\n$$\nK_i = \\frac{q(x_i,y_i)}{k_0^4} \\left( \\frac{12(1-\\nu^2)}{E} \\right) \\left(1 - e^{-t/\\tau}\\right)\n$$\nThis defines a system of linear equations for the $N^2$ observation points, which can be expressed in matrix form as $\\mathbf{d} = \\mathbf{G}\\mathbf{m}$.\nHere, $\\mathbf{d}$ is the $N^2 \\times 1$ vector of uplift observations, $\\mathbf{m}$ is the $2 \\times 1$ vector of unknown parameters $[m_A, m_B]^T$, and $\\mathbf{G}$ is the $N^2 \\times 2$ sensitivity matrix (or Jacobian).\n\nThe structure of $\\mathbf{G}$ is determined by the problem's spatial partitioning. Let $I_A$ be the set of grid indices where $x < 0$ and $I_B$ be the set where $x \\ge 0$. The $i$-th row of $\\mathbf{G}$ is:\n- $[K_i, 0]$ if grid point $i \\in I_A$\n- $[0, K_i]$ if grid point $i \\in I_B$\n\n**3. Solution via Tikhonov Regularization**\n\nTo find a stable solution to the system $\\mathbf{d} \\approx \\mathbf{G}\\mathbf{m}$, we use Tikhonov regularization, which minimizes a combination of the data misfit and a penalty on the model norm. We seek to minimize the objective function $\\Phi(\\mathbf{m})$:\n$$\n\\Phi(\\mathbf{m}) = ||\\mathbf{G}\\mathbf{m} - \\mathbf{d}||_2^2 + \\lambda^2 ||\\mathbf{m}||_2^2\n$$\nwhere $\\lambda$ is the regularization parameter given in the problem statement. The solution that minimizes $\\Phi(\\mathbf{m})$ is given by the normal equations:\n$$\n\\mathbf{m}_{\\text{est}} = (\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} \\mathbf{G}^T \\mathbf{d}\n$$\nwhere $\\mathbf{I}$ is the $2 \\times 2$ identity matrix.\n\nLet's compute the matrices $\\mathbf{G}^T \\mathbf{G}$ and $\\mathbf{G}^T \\mathbf{d}$. Due to the orthogonal structure of the columns of $\\mathbf{G}$ (each grid point contributes to either $m_A$ or $m_B$, but not both), the matrix $\\mathbf{G}^T \\mathbf{G}$ is diagonal:\n$$\n\\mathbf{G}^T \\mathbf{G} = \\begin{pmatrix} \\sum_{i \\in I_A} K_i^2 & 0 \\\\ 0 & \\sum_{i \\in I_B} K_i^2 \\end{pmatrix}\n$$\nThe vector $\\mathbf{G}^T \\mathbf{d}$ is:\n$$\n\\mathbf{G}^T \\mathbf{d} = \\begin{pmatrix} \\sum_{i \\in I_A} K_i d_i \\\\ \\sum_{i \\in I_B} K_i d_i \\end{pmatrix}\n$$\nThe regularized matrix to be inverted is:\n$$\n(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I}) = \\begin{pmatrix} \\left(\\sum_{i \\in I_A} K_i^2\\right) + \\lambda^2 & 0 \\\\ 0 & \\left(\\sum_{i \\in I_B} K_i^2\\right) + \\lambda^2 \\end{pmatrix}\n$$\nThe inversion is trivial, and the system decouples into two independent equations for $m_A$ and $m_B$:\n$$\nm_{A, \\text{est}} = \\frac{\\sum_{i \\in I_A} K_i d_i}{\\left(\\sum_{i \\in I_A} K_i^2\\right) + \\lambda^2}\n$$\n$$\nm_{B, \\text{est}} = \\frac{\\sum_{i \\in I_B} K_i d_i}{\\left(\\sum_{i \\in I_B} K_i^2\\right) + \\lambda^2}\n$$\nThe problem requires enforcing non-negativity of the physical parameters $T_e^A, T_e^B$. Since $T_e = m^{-1/3}$, this requires $m > 0$. In our model, the load $q_i$ is non-negative, and thus the coefficient $K_i$ is non-negative. The observed uplift $d_i$ (representing physical uplift) will also be non-negative (plus small noise). Therefore, the numerators ($\\sum K_i d_i$) and denominators (sum of squares plus $\\lambda^2$) will be positive, naturally ensuring that $m_{A, \\text{est}} > 0$ and $m_{B, \\text{est}} > 0$. The non-negativity constraint is thus satisfied without further algorithmic complexity.\n\nFinally, the estimated elastic thickness values are recovered by back-transforming the estimated model parameters:\n$$\nT_{e, \\text{est}}^A = (m_{A, \\text{est}})^{-1/3} \\quad \\text{and} \\quad T_{e, \\text{est}}^B = (m_{B, \\text{est}})^{-1/3}\n$$\nThese values, calculated in SI units (meters), must be converted to kilometers for the final output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the geophysical inversion problem for piecewise-constant elastic thickness.\n    \n    The function iterates through three test cases. For each case, it:\n    1. Sets up the physical model (grid, load, parameters).\n    2. Generates synthetic uplift data using the forward model derived from thin-plate\n       flexure and Maxwell viscoelasticity, based on the true elastic thickness values.\n       Gaussian noise is added to simulate observations.\n    3. Implements a Tikhonov-regularized linear inversion to estimate the two elastic\n       thickness parameters (TeA for x<0, TeB for x>=0). The inversion is based on\n       linearizing the problem by solving for m = 1/Te^3.\n    4. Converts the estimated parameters back to elastic thickness in kilometers.\n    5. Collects and formats the results as specified.\n    \"\"\"\n    \n    # Common constants\n    N = 16                                 # Grid size\n    E = 7.0e10                             # Young's modulus (Pa)\n    NU = 0.25                              # Poisson's ratio\n    MU = 6.7e10                            # Shear modulus (Pa)\n    P0 = 2.0e7                             # Peak ice load (Pa)\n    SIGMA = 0.40                           # Gaussian load width (dimensionless)\n    LAMBDA = 1.0e-4                        # Tikhonov regularization parameter\n    YR_TO_S = 365.25 * 24 * 3600           # Conversion from years to seconds\n\n    # Set up the computational grid\n    x_coords = np.linspace(-1.0, 1.0, N)\n    y_coords = np.linspace(-1.0, 1.0, N)\n    x, y = np.meshgrid(x_coords, y_coords)\n\n    # Define the ice load q(x,y)\n    q = P0 * np.exp(-(x**2 + y**2) / (2 * SIGMA**2))\n\n    # Test cases\n    test_cases = [\n        # (TeA_true_km, TeB_true_km, eta, t_yr, L_m, noise_std_m)\n        (40.0, 60.0, 1.0e21, 2000.0, 200000.0, 0.002),\n        (30.0, 30.0, 5.0e22, 1000.0, 200000.0, 0.001),\n        (35.0, 80.0, 5.0e20, 3000.0, 250000.0, 0.003),\n    ]\n\n    # For result reproducibility\n    np.random.seed(0)\n    \n    results = []\n    \n    for case in test_cases:\n        TeA_true_km, TeB_true_km, eta, t_yr, L_m, noise_std_m = case\n        \n        # --- 1. Forward Model: Generate synthetic data ---\n        \n        # Convert units to SI\n        TeA_true_m = TeA_true_km * 1000.0\n        TeB_true_m = TeB_true_km * 1000.0\n        t_s = t_yr * YR_TO_S\n\n        # Calculate model-dependent constants\n        k0 = (2 * np.pi) / L_m\n        tau = eta / MU\n        \n        # Create true Te field in meters\n        Te_true_field_m = np.full_like(x, TeB_true_m)\n        Te_true_field_m[x < 0] = TeA_true_m\n        \n        # Calculate uplift using the forward model\n        # u = (q / (k0^4)) * (12*(1-nu^2)/E) * (1/Te^3) * (1 - exp(-t/tau))\n        C_flexure = (12 * (1 - NU**2)) / E\n        f_relax = 1.0 - np.exp(-t_s / tau)\n        \n        u_true = (q / (k0**4)) * C_flexure * (1.0 / Te_true_field_m**3) * f_relax\n\n        # Add Gaussian noise to create observed data\n        noise = np.random.normal(0, noise_std_m, (N, N))\n        u_obs = u_true + noise\n\n        # --- 2. Inverse Problem: Estimate TeA and TeB ---\n        \n        # Flatten grids to 1D vectors for easier processing\n        u_obs_flat = u_obs.flatten()\n        q_flat = q.flatten()\n        x_flat = x.flatten()\n        \n        # Identify points in region A (x < 0) and region B (x >= 0)\n        idx_A = np.where(x_flat < 0)[0]\n        idx_B = np.where(x_flat >= 0)[0]\n\n        # Calculate the coefficient K for the linearized model d = G*m\n        # K_i = (q_i / k0^4) * C_flexure * f_relax\n        K_flat = (q_flat / (k0**4)) * C_flexure * f_relax\n\n        d_A, d_B = u_obs_flat[idx_A], u_obs_flat[idx_B]\n        K_A, K_B = K_flat[idx_A], K_flat[idx_B]\n\n        # Calculate terms for the Tikhonov-regularized solution\n        # m_est = (G.T @ d) / (diag(G.T @ G) + lambda^2)\n        sum_K2_A = np.sum(K_A**2)\n        sum_K2_B = np.sum(K_B**2)\n        \n        sum_Kd_A = np.sum(K_A * d_A)\n        sum_Kd_B = np.sum(K_B * d_B)\n        \n        # Solve for the linearized parameters m_A and m_B\n        mA_est = sum_Kd_A / (sum_K2_A + LAMBDA**2)\n        mB_est = sum_Kd_B / (sum_K2_B + LAMBDA**2)\n        \n        # Back-transform to get physical parameters (Te) and convert to km\n        TeA_est_km = (mA_est**(-1/3)) / 1000.0\n        TeB_est_km = (mB_est**(-1/3)) / 1000.0\n        \n        results.extend([round(TeA_est_km, 2), round(TeB_est_km, 2)])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}