{
    "hands_on_practices": [
        {
            "introduction": "Theoretical understanding of creeping flow is best solidified by applying the governing equations to a concrete physical system. This first practice focuses on the analytical derivation of squeeze flow, a scenario relevant to many geophysical processes such as magma chamber evacuation or the compaction of sedimentary basins. By working through this problem, you will apply the lubrication approximation—a powerful technique for simplifying the Stokes equations in geometries where one spatial dimension is much smaller than the others—to derive the pressure and velocity fields from first principles .",
            "id": "3582782",
            "problem": "Consider an axisymmetric squeeze-flow of a viscous rock, modeled as an incompressible Newtonian fluid of dynamic viscosity $\\eta$, confined between parallel, rigid, circular boundaries of radius $a$ separated by a gap thickness $h(t)$ that is uniform in the radial coordinate $r$. The flow is in the Stokes (creeping) regime, with negligible inertia, and is driven solely by an imposed normal displacement of the boundaries such that the gap thickness changes at a constant rate $\\partial h/\\partial t$ (with $\\partial h/\\partial t < 0$ corresponding to boundary approach). The rock is assumed to adhere to the boundaries (no-slip and no-penetration), and the pressure at the outer edge $r=a$ is equal to the ambient reference (gauge pressure $p(a)=0$). The geometry is axisymmetric about $r=0$.\n\nUsing the fundamental governing laws for incompressible Stokes flow, namely the momentum balance equations with negligible inertia and the incompressibility condition, derive the leading-order axisymmetric solution for squeeze-flow in a slender gap ($h \\ll a$) and compute:\n- the height-averaged radial velocity $\\overline{u}_r(r)$, and\n- the gauge pressure $p(r)$.\n\nAssume the gap $h$ is uniform in $r$ at any instant, and that $\\partial h/\\partial t$ is spatially uniform. Express your final answers as closed-form analytic functions of $r$, $a$, $h$, $\\eta$, and $\\partial h/\\partial t$. Express the radial velocity in meters per second and the pressure in Pascals. Provide the pair $\\left(\\overline{u}_r(r),\\,p(r)\\right)$ as your final answer. No numerical evaluation is required.",
            "solution": "The problem statement has been critically examined and found to be valid. It is a well-posed, scientifically grounded problem in fluid mechanics, specifically a classic example of lubrication theory applied to Stokes flow. It is self-contained, with all necessary conditions and properties defined, and free of contradictions or ambiguities. We may therefore proceed with a formal derivation.\n\nThe flow is described as an incompressible, Newtonian fluid in the Stokes regime. In a cylindrical coordinate system ($r$, $\\theta$, $z$) with the origin at the center of the gap, and assuming axisymmetry ($\\frac{\\partial}{\\partial\\theta} = 0$) and no swirl velocity ($u_\\theta=0$), the governing equations are the continuity equation and the Stokes momentum equations.\n\nThe continuity equation for an incompressible fluid is:\n$$ \\frac{1}{r}\\frac{\\partial}{\\partial r}(r u_r) + \\frac{\\partial u_z}{\\partial z} = 0 $$\nThe Stokes equations (momentum balance with negligible inertia) are:\n$$ -\\frac{\\partial p}{\\partial r} + \\eta \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u_r}{\\partial r}\\right) - \\frac{u_r}{r^2} + \\frac{\\partial^2 u_r}{\\partial z^2} \\right] = 0 \\quad (r\\text{-momentum}) $$\n$$ -\\frac{\\partial p}{\\partial z} + \\eta \\left[ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{\\partial u_z}{\\partial r}\\right) + \\frac{\\partial^2 u_z}{\\partial z^2} \\right] = 0 \\quad (z\\text{-momentum}) $$\nwhere $u_r$ and $u_z$ are the radial and vertical velocity components, $p$ is the pressure, and $\\eta$ is the dynamic viscosity.\n\nThe problem specifies a slender gap, $h \\ll a$. This allows for the lubrication approximation. We perform a scaling analysis. The characteristic length scales are $a$ in the radial direction and $h$ in the vertical direction. Let $\\dot{h} = \\frac{\\partial h}{\\partial t}$. From the boundary conditions, the characteristic vertical velocity $U_z$ is of the order of $|\\dot{h}|$. From the continuity equation, $\\frac{U_r}{a} \\sim \\frac{U_z}{h}$, which implies the characteristic radial velocity is $U_r \\sim \\frac{a}{h} U_z \\sim \\frac{a}{h}|\\dot{h}|$.\n\nIn the $r$-momentum equation, the radial viscous terms scale as $\\eta \\frac{U_r}{a^2}$, while the vertical viscous term scales as $\\eta \\frac{U_r}{h^2}$. Since $h \\ll a$, we have $\\frac{h^2}{a^2} \\ll 1$, so the vertical term $\\frac{\\partial^2 u_r}{\\partial z^2}$ dominates the radial viscous terms. The $r$-momentum equation simplifies to:\n$$ \\frac{\\partial p}{\\partial r} = \\eta \\frac{\\partial^2 u_r}{\\partial z^2} $$\nIn the $z$-momentum equation, a similar analysis shows that the pressure gradient $\\frac{\\partial p}{\\partial z}$ must balance the viscous term $\\eta \\frac{\\partial^2 u_z}{\\partial z^2}$. The pressure variation across the gap, $\\Delta p_z$, scales as $h \\cdot (\\eta U_z/h^2) = \\eta U_z/h$. The radial pressure variation, $\\Delta p_r$, scales with the terms in the simplified $r$-momentum equation, suggesting $\\frac{\\Delta p_r}{a} \\sim \\eta \\frac{U_r}{h^2}$, so $\\Delta p_r \\sim \\frac{\\eta a U_r}{h^2}$. The ratio of vertical to radial pressure variation is $\\frac{\\Delta p_z}{\\Delta p_r} \\sim \\frac{\\eta U_z/h}{\\eta a U_r/h^2} = \\frac{U_z h}{U_r a}$. Substituting $U_r \\sim U_z \\frac{a}{h}$, this ratio becomes $\\frac{h^2}{a^2} \\ll 1$. Thus, the pressure variation in the $z$ direction is negligible. We can assume $p = p(r)$, which implies $\\frac{\\partial p}{\\partial z} = 0$.\n\nWith $p=p(r)$, the simplified $r$-momentum equation becomes $\\frac{dp}{dr} = \\eta \\frac{\\partial^2 u_r}{\\partial z^2}$. We integrate this twice with respect to $z$:\n$$ \\frac{\\partial u_r}{\\partial z} = \\frac{1}{\\eta}\\frac{dp}{dr}z + C_1(r) $$\n$$ u_r(r,z) = \\frac{1}{2\\eta}\\frac{dp}{dr}z^2 + C_1(r)z + C_2(r) $$\nThe boundary conditions are no-slip at the rigid boundaries $z = \\pm h/2$, i.e., $u_r(r, z=h/2) = 0$ and $u_r(r, z=-h/2) = 0$. By symmetry, the velocity profile must be an even function of $z$, which requires $C_1(r)=0$. Applying the condition at $z=h/2$:\n$$ 0 = \\frac{1}{2\\eta}\\frac{dp}{dr}\\left(\\frac{h}{2}\\right)^2 + C_2(r) \\implies C_2(r) = -\\frac{h^2}{8\\eta}\\frac{dp}{dr} $$\nSubstituting $C_2(r)$ gives the parabolic radial velocity profile:\n$$ u_r(r,z) = \\frac{1}{2\\eta}\\frac{dp}{dr}\\left(z^2 - \\frac{h^2}{4}\\right) $$\nNext, we compute the height-averaged radial velocity, $\\overline{u}_r(r)$:\n$$ \\overline{u}_r(r) = \\frac{1}{h} \\int_{-h/2}^{h/2} u_r(r,z) dz = \\frac{1}{2\\eta h}\\frac{dp}{dr} \\int_{-h/2}^{h/2} \\left(z^2 - \\frac{h^2}{4}\\right) dz $$\n$$ \\int_{-h/2}^{h/2} \\left(z^2 - \\frac{h^2}{4}\\right) dz = \\left[\\frac{z^3}{3} - \\frac{h^2}{4}z\\right]_{-h/2}^{h/2} = 2\\left(\\frac{h^3}{24} - \\frac{h^3}{8}\\right) = -\\frac{h^3}{6} $$\n$$ \\overline{u}_r(r) = \\frac{1}{2\\eta h}\\frac{dp}{dr}\\left(-\\frac{h^3}{6}\\right) = -\\frac{h^2}{12\\eta}\\frac{dp}{dr} $$\nTo find the pressure gradient $\\frac{dp}{dr}$, we use the continuity equation, integrated over the gap height:\n$$ \\int_{-h/2}^{h/2} \\left( \\frac{1}{r}\\frac{\\partial}{\\partial r}(r u_r) + \\frac{\\partial u_z}{\\partial z} \\right) dz = 0 $$\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r \\int_{-h/2}^{h/2} u_r dz \\right) + \\left[u_z\\right]_{-h/2}^{h/2} = 0 $$\nThe integral is $h\\overline{u}_r$. The second term is evaluated using the no-penetration boundary conditions: $u_z(z=h/2) = \\frac{1}{2}\\frac{\\partial h}{\\partial t}$ and $u_z(z=-h/2) = -\\frac{1}{2}\\frac{\\partial h}{\\partial t}$. Thus, $[u_z]_{-h/2}^{h/2} = \\frac{\\partial h}{\\partial t}$. The integrated continuity equation becomes:\n$$ \\frac{1}{r}\\frac{d}{dr}(r h \\overline{u}_r) + \\frac{\\partial h}{\\partial t} = 0 $$\nSubstituting the expression for $\\overline{u}_r$:\n$$ \\frac{1}{r}\\frac{d}{dr}\\left( r h \\left(-\\frac{h^2}{12\\eta}\\frac{dp}{dr}\\right) \\right) = -\\frac{\\partial h}{\\partial t} $$\n$$ -\\frac{h^3}{12\\eta} \\frac{1}{r} \\frac{d}{dr}\\left(r \\frac{dp}{dr}\\right) = -\\frac{\\partial h}{\\partial t} \\implies \\frac{1}{r} \\frac{d}{dr}\\left(r \\frac{dp}{dr}\\right) = \\frac{12\\eta}{h^3}\\frac{\\partial h}{\\partial t} $$\nThis is the Reynolds equation for this problem. We integrate once with respect to $r$:\n$$ r \\frac{dp}{dr} = \\frac{12\\eta}{h^3}\\frac{\\partial h}{\\partial t} \\frac{r^2}{2} + C_3 = \\frac{6\\eta}{h^3}\\frac{\\partial h}{\\partial t} r^2 + C_3 $$\nBy axisymmetry, the pressure gradient must be finite at $r=0$, which requires $C_3=0$.\n$$ \\frac{dp}{dr} = \\frac{6\\eta}{h^3}\\frac{\\partial h}{\\partial t} r $$\nWe integrate again to find $p(r)$:\n$$ p(r) = \\frac{6\\eta}{h^3}\\frac{\\partial h}{\\partial t} \\frac{r^2}{2} + C_4 = \\frac{3\\eta}{h^3}\\frac{\\partial h}{\\partial t} r^2 + C_4 $$\nUsing the boundary condition $p(a)=0$:\n$$ 0 = \\frac{3\\eta}{h^3}\\frac{\\partial h}{\\partial t} a^2 + C_4 \\implies C_4 = -\\frac{3\\eta a^2}{h^3}\\frac{\\partial h}{\\partial t} $$\nThus, the gauge pressure $p(r)$ is:\n$$ p(r) = \\frac{3\\eta}{h^3}\\frac{\\partial h}{\\partial t} (r^2 - a^2) $$\nFinally, we substitute the expression for $\\frac{dp}{dr}$ back into the equation for the averaged radial velocity:\n$$ \\overline{u}_r(r) = -\\frac{h^2}{12\\eta}\\frac{dp}{dr} = -\\frac{h^2}{12\\eta} \\left(\\frac{6\\eta}{h^3}\\frac{\\partial h}{\\partial t} r\\right) $$\n$$ \\overline{u}_r(r) = -\\frac{6\\eta h^2}{12\\eta h^3} r \\frac{\\partial h}{\\partial t} = -\\frac{r}{2h} \\frac{\\partial h}{\\partial t} $$\nThe two sought quantities are the height-averaged radial velocity $\\overline{u}_r(r)$ and the gauge pressure $p(r)$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{r}{2h} \\frac{\\partial h}{\\partial t} & \\frac{3\\eta(r^2 - a^2)}{h^3} \\frac{\\partial h}{\\partial t} \\end{pmatrix} } $$"
        },
        {
            "introduction": "A crucial aspect of mastering any physical model is understanding its limitations. This exercise challenges you to confront Stokes' paradox, a famous failure of the 2D creeping flow equations in an unbounded domain. By analyzing why a solution fails and how it can be \"regularized\" by physical or geometric constraints, you will gain a deeper appreciation for the subtle interplay between dimensionality, boundary conditions, and the resulting physics . This concept is not merely academic; it has direct implications for how we numerically model long, linear geologic features like dikes, subducting slabs, or transform faults.",
            "id": "3582769",
            "problem": "In computational geophysics, slow viscous deformation in the lithosphere is often modeled by creeping flow in the Stokes regime. Consider steady, incompressible flow of a Newtonian fluid with dynamic viscosity $\\mu$ and density $\\rho$ around an infinitely long circular cylinder of radius $a$, representing the cross-section of a long lithospheric inclusion. The flow is assumed two-dimensional ($2$D) in the plane normal to the cylinder axis. The cylinder translates with speed $U$ relative to the far field, or equivalently, the fluid has uniform flow of speed $U$ past a fixed cylinder. The Reynolds number (Re) based on the cylinder radius is $Re = \\rho U a / \\mu$.\n\nStarting from the steady incompressible Navier–Stokes equations,\n$$\n\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right) \\mathbf{u} = - \\nabla p + \\mu \\nabla^2 \\mathbf{u}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\nand the Stokes limit $Re \\to 0$ where $\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right) \\mathbf{u}$ is neglected, reason from first principles why imposing uniform flow at infinity in an unbounded domain fails to admit a steady solution that satisfies no-slip on the cylinder ($\\mathbf{u}=\\mathbf{0}$ at $r=a$) and uniform flow as $r \\to \\infty$. Then consider two regularizations:\n- A finite circular domain of radius $R \\gg a$ with prescribed uniform velocity $U$ on the outer boundary $r=R$.\n- The Oseen linearization that retains the leading-order inertial term about a uniform background velocity $U$, producing an effective outer length scale.\n\nUsing only governing equations, far-field structure, and properties of the two-dimensional Stokes fundamental solution, determine which statements are correct about the nature of the paradox, the scaling of the drag per unit length $f$ on the cylinder, and implications for geophysical modeling of long lithospheric inclusions.\n\nChoose all that apply.\n\nA. In an unbounded domain, the steady $2$D Stokes problem for a cylinder with uniform flow at infinity has no solution because the general biharmonic solution for the streamfunction necessarily contains a logarithmic term in $r$ whose coefficient cannot be chosen to satisfy simultaneously no-slip on $r=a$ and a bounded, uniform velocity as $r \\to \\infty$.\n\nB. Confining the flow to a finite circular domain of radius $R$ regularizes the Stokes problem; at leading order, the drag per unit length scales as $f \\sim \\dfrac{4 \\pi \\mu U}{\\ln \\!\\left( R / a \\right)}$, reflecting the logarithmic sensitivity to the outer scale $R$.\n\nC. Under the Oseen approximation at small $Re$, the effective outer scale is $L_O \\sim a / Re$, and the resulting drag per unit length scales as $f \\sim \\dfrac{4 \\pi \\mu U}{Re}$ as $Re \\to 0$.\n\nD. For geophysical applications to very long lithospheric inclusions (approximated as $2$D cylinders), the Stokes paradox implies that the drag per unit length becomes independent of domain size at small $Re$, so resistance is scale-invariant.\n\nE. In computational models of long inclusions, choosing a domain that is too small (small $R/a$) can systematically overestimate the drag, because the logarithmic dependence on the outer scale is cut off at the box size, increasing $f \\propto 1/\\ln(R/a)$.",
            "solution": "The user wants a critical validation of the problem statement, followed by a detailed solution and evaluation of the provided options.\n\n### Step 1: Extract Givens\n- **System**: Steady, incompressible, 2D flow of a Newtonian fluid around an infinitely long circular cylinder of radius $a$.\n- **Fluid Properties**: Dynamic viscosity $\\mu$, density $\\rho$.\n- **Flow Regime**: Creeping flow, Stokes regime, characterized by the Reynolds number $Re = \\rho U a / \\mu \\to 0$.\n- **Relative Motion**: Cylinder translates with speed $U$ relative to the far field, or fluid flows with speed $U$ past a fixed cylinder.\n- **Governing Equations (Full)**: Steady incompressible Navier–Stokes equations:\n$$ \\rho \\left( \\mathbf{u} \\cdot \\nabla \\right) \\mathbf{u} = - \\nabla p + \\mu \\nabla^2 \\mathbf{u} $$\n$$ \\nabla \\cdot \\mathbf{u} = 0 $$\n- **Governing Equations (Approximation)**: Stokes equations, obtained by neglecting the inertial term $\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right) \\mathbf{u}$.\n- **Question**: Reason from first principles about the failure to find a steady solution for the Stokes flow problem in an unbounded domain subject to no-slip on the cylinder ($\\mathbf{u}=\\mathbf{0}$ at $r=a$) and uniform flow at infinity ($\\mathbf{u} \\to U \\mathbf{\\hat{e}}_x$ as $r \\to \\infty$). Evaluate statements about this paradox (known as Stokes' paradox), two regularization methods (finite domain, Oseen linearization), and implications.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a classic in fluid dynamics and its application to computational geophysics is appropriate. The Navier-Stokes and Stokes equations are fundamental. Stokes' paradox is a well-established concept. All elements are scientifically sound.\n2.  **Well-Posed**: The problem asks for an analysis of a famously ill-posed boundary value problem (the unbounded 2D Stokes flow). The question itself, which is to explain *why* it is ill-posed and analyze its regularizations, is well-posed and a standard topic in advanced fluid mechanics.\n3.  **Objective**: The problem is stated using precise, objective, and formal mathematical and physical language. No ambiguity or subjective elements are present.\n4.  **Completeness**: The problem provides all necessary information to reason about the paradox and evaluate the scaling laws associated with the regularizations. It is self-contained.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. It is a correct and well-posed question about a standard topic in fluid mechanics. I will proceed with the solution.\n\n### Derivation and Option Analysis\n\nThe problem revolves around Stokes' paradox for 2D flow past a cylinder. We begin by analyzing the governing equations.\n\n**1. The 2D Stokes Flow Equations and the Biharmonic Solution**\n\nFor steady, incompressible, 2D flow, the incompressibility condition $\\nabla \\cdot \\mathbf{u} = 0$ is automatically satisfied by introducing a streamfunction $\\psi(r, \\theta)$ such that the velocity components in polar coordinates are:\n$$ u_r = \\frac{1}{r} \\frac{\\partial \\psi}{\\partial \\theta}, \\quad u_\\theta = - \\frac{\\partial \\psi}{\\partial r} $$\nTaking the curl of the Stokes momentum equation ($\\nabla p = \\mu \\nabla^2 \\mathbf{u}$) eliminates the pressure and yields the biharmonic equation for the streamfunction:\n$$ \\nabla^4 \\psi = \\nabla^2(\\nabla^2 \\psi) = 0 $$\nFor flow past a cylinder with a uniform stream $U$ along the $x$-axis at infinity, the flow must be symmetric about the $x$-axis, implying that the streamfunction has a dependence of $\\sin\\theta$. The general solution for $\\psi(r, \\theta)$ with this symmetry is:\n$$ \\psi(r, \\theta) = \\left( \\frac{A}{r} + Br + Cr\\ln r + Dr^3 \\right) \\sin\\theta $$\nThe velocity components are then:\n$$ u_r = \\frac{1}{r} \\frac{\\partial \\psi}{\\partial \\theta} = \\left( \\frac{A}{r^2} + B + C\\ln r + Dr^2 \\right) \\cos\\theta $$\n$$ u_\\theta = - \\frac{\\partial \\psi}{\\partial r} = - \\left( -\\frac{A}{r^2} + B + C(1+\\ln r) + 3Dr^2 \\right) \\sin\\theta $$\n\n**2. The Paradox in an Unbounded Domain**\n\nWe apply the boundary conditions for the unbounded problem:\n-   **Far-field condition**: As $r \\to \\infty$, the flow must approach a uniform stream, $\\mathbf{u} \\to U \\mathbf{\\hat{e}}_x$. In polar coordinates, this is $u_r \\to U\\cos\\theta$ and $u_\\theta \\to -U\\sin\\theta$.\n-   **No-slip condition**: At the cylinder surface $r=a$, the velocity must be zero, $\\mathbf{u}(a, \\theta) = \\mathbf{0}$, so $u_r(a, \\theta) = 0$ and $u_\\theta(a, \\theta) = 0$.\n\nLet's examine the far-field velocity. As $r \\to \\infty$:\n$$ u_r \\sim \\left( C\\ln r + Dr^2 \\right) \\cos\\theta $$\n$$ u_\\theta \\sim - \\left( C\\ln r + 3Dr^2 \\right) \\sin\\theta $$\nFor the velocity to be bounded as $r \\to \\infty$, let alone uniform, the coefficients of the terms that grow with $r$ must be zero. This requires $D=0$ and $C=0$.\nIf $D=0$ and $C=0$, the solution becomes:\n$$ \\psi(r, \\theta) = \\left( \\frac{A}{r} + Br \\right) \\sin\\theta $$\nThe velocities are:\n$$ u_r = \\left( \\frac{A}{r^2} + B \\right) \\cos\\theta, \\quad u_\\theta = - \\left( -\\frac{A}{r^2} + B \\right) \\sin\\theta $$\nApplying the far-field condition ($u_r \\to U\\cos\\theta$, $u_\\theta \\to -U\\sin\\theta$) as $r \\to \\infty$ requires $B=U$.\nSo, $\\psi(r, \\theta) = \\left( \\frac{A}{r} + Ur \\right) \\sin\\theta$.\nNow, we apply the no-slip condition at $r=a$:\n-   $u_r(a, \\theta) = \\left( \\frac{A}{a^2} + U \\right) \\cos\\theta = 0 \\implies A = -Ua^2$.\n-   $u_\\theta(a, \\theta) = - \\left( -\\frac{A}{a^2} + U \\right) \\sin\\theta = 0 \\implies - \\left( - \\frac{(-Ua^2)}{a^2} + U \\right) \\sin\\theta = - (U+U) \\sin\\theta = -2U\\sin\\theta = 0$.\nThis last condition can only be satisfied if $U=0$ (no flow), which is a trivial case. For any $U \\neq 0$, the no-slip condition on $u_\\theta$ is violated.\nThe core of the issue is that to satisfy the far-field condition of uniform flow, we must set $C=0$, but the remaining degrees of freedom are insufficient to satisfy both components of the no-slip condition at the cylinder surface. This is Stokes' paradox.\n\n**3. Regularization by a Finite Domain**\n\nNow consider the flow confined to a finite domain $a \\le r \\le R$, with $\\mathbf{u} = U\\mathbf{\\hat{e}}_x$ at the outer boundary $r=R$. The $Dr^3$ term in the general solution can be neglected as it corresponds to a flow structure not driven by uniform motion at the boundary. We use $\\psi(r, \\theta) = (A/r + Br + Cr \\ln r)\\sin\\theta$. A full solution of the constants is tedious, but the physics can be understood through scaling. The paradox arises from the long-range effect of the cylinder, which manifests as the logarithmic term. Confining the domain provides an outer length scale $R$. Dimensional analysis shows the drag per unit length $f$ must take the form $f = \\mu U g(R/a)$. The logarithmic nature of the 2D fundamental solution (Stokeslet) dictates that this function will be logarithmic. The established result from a full solution (or matched asymptotic expansions) is that for $R \\gg a$:\n$$ f \\sim \\frac{4\\pi \\mu U}{\\ln(R/a) + O(1)} $$\nAt leading order, the drag scales as $f \\propto 1/\\ln(R/a)$.\n\n**4. Regularization by Oseen's Approximation**\n\nThe Oseen approximation partly restores the inertial term: $\\rho (\\mathbf{U} \\cdot \\nabla)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2\\mathbf{u}$. This introduces a new length scale. The inertial term is roughly $\\rho U (U/L)$ while the viscous term is $\\mu (U/L^2)$. The Oseen linearization keeps a term of order $\\rho U (u/L)$. The length scale $L_O$ where this term is comparable to the viscous term $\\mu u/L_O^2$ is found by balancing $\\rho U u/L_O \\sim \\mu u/L_O^2$, which gives $L_O \\sim \\mu/(\\rho U)$.\nUsing the Reynolds number $Re = \\rho U a / \\mu$, this outer scale is $L_O = a/Re$.\nThe solution to the Oseen problem for small $Re$ gives a drag per unit length:\n$$ f = \\frac{4\\pi \\mu U}{\\ln(1/Re) - \\gamma + \\ln(4) + O(Re)} \\approx \\frac{4\\pi \\mu U}{\\ln(1/Re)} $$\nwhere $\\gamma$ is the Euler-Mascheroni constant. This result is analogous to the finite domain result if we identify the outer scale $R$ with $L_O \\sim a/Re$, since $\\ln(R/a) \\sim \\ln((a/Re)/a) = \\ln(1/Re)$.\n\n### Option-by-Option Analysis\n\n**A. In an unbounded domain, the steady 2D Stokes problem for a cylinder with uniform flow at infinity has no solution because the general biharmonic solution for the streamfunction necessarily contains a logarithmic term in $r$ whose coefficient cannot be chosen to satisfy simultaneously no-slip on $r=a$ and a bounded, uniform velocity as $r \\to \\infty$.**\n\nThis statement accurately describes the paradox. As shown in section 2, to obtain a bounded velocity at infinity, the coefficient $C$ of the $r\\ln r$ term in $\\psi$ must be zero. However, with $C=0$, the remaining terms do not provide enough freedom to satisfy the no-slip condition ($u_r=0$ and $u_\\theta=0$) at $r=a$. Conversely, satisfying the no-slip condition would require $C \\neq 0$, leading to a logarithmically divergent velocity at infinity, which violates the uniform flow condition.\n**Verdict: Correct.**\n\n**B. Confining the flow to a finite circular domain of radius $R$ regularizes the Stokes problem; at leading order, the drag per unit length scales as $f \\sim \\dfrac{4 \\pi \\mu U}{\\ln \\!\\left( R / a \\right)}$, reflecting the logarithmic sensitivity to the outer scale $R$.**\n\nThis is the standard result for the confined Stokes flow problem, as discussed in section 3. The introduction of the outer length scale $R$ removes the mathematical inconsistency, but the solution retains a memory of the paradox through its slow, logarithmic decay of dependence on $R$. This scaling is confirmed by more advanced techniques like matched asymptotic expansions and is consistent with the Oseen approximation.\n**Verdict: Correct.**\n\n**C. Under the Oseen approximation at small $Re$, the effective outer scale is $L_O \\sim a / Re$, and the resulting drag per unit length scales as $f \\sim \\dfrac{4 \\pi \\mu U}{Re}$ as $Re \\to 0$.**\n\nThe first part of the statement is correct: the Oseen length scale is $L_O \\sim \\mu/(\\rho U) = a/Re$. The second part, however, claims an incorrect scaling for the drag. As shown in section 4, the drag scales as $f \\propto 1/\\ln(1/Re)$, not as $1/Re$. As $Re \\to 0$, $1/Re$ grows much faster than $\\ln(1/Re)$, so the stated scaling is wrong.\n**Verdict: Incorrect.**\n\n**D. For geophysical applications to very long lithospheric inclusions (approximated as 2D cylinders), the Stokes paradox implies that the drag per unit length becomes independent of domain size at small $Re$, so resistance is scale-invariant.**\n\nThis statement is the opposite of the conclusion from the analysis of Stokes' paradox. The paradox and its regularizations (both finite domain and Oseen) explicitly show that the drag has a persistent, long-range dependence on an outer length scale ($R$ or $a/Re$). The drag is proportional to $1/\\ln(R/a)$, which is critically dependent on the domain size $R$. It is not scale-invariant. This is a key difference from 3D Stokes flow (e.g., past a sphere), where the drag is independent of the far field for an unbounded domain.\n**Verdict: Incorrect.**\n\n**E. In computational models of long inclusions, choosing a domain that is too small (small $R/a$) can systematically overestimate the drag, because the logarithmic dependence on the outer scale is cut off at the box size, increasing $f \\propto 1/\\ln(R/a)$.**\n\nThe drag law is $f \\propto 1/\\ln(R/a)$. The function $g(x) = 1/\\ln(x)$, for $x=R/a > 1$, is a monotonically decreasing function of $x$. This means that as the domain size ratio $R/a$ decreases, $\\ln(R/a)$ decreases, and therefore $1/\\ln(R/a)$ increases. Consequently, using a smaller computational domain (a smaller $R$ for a fixed $a$) will result in a larger calculated drag force. This statement correctly identifies this practical consequence for numerical simulations.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ABE}$$"
        },
        {
            "introduction": "We now transition from analytical and conceptual challenges to a full computational implementation, synthesizing the principles of creeping flow into a working numerical model. This practice guides you in developing a spectral solver for buoyancy-driven Stokes flow, where motion is initiated by density variations from a diffusing compositional field. This scenario is a foundational model for mantle convection and other buoyancy-driven phenomena, and the Fast Fourier Transform (FFT) based spectral method you will use is a cornerstone of modern computational geophysics for periodic systems .",
            "id": "3582751",
            "problem": "Consider a two-dimensional, incompressible, steady Stokes flow in a periodic square domain of side length $L$ (in $\\mathrm{m}$) driven by buoyancy due to a scalar composition field $c(\\mathbf{x})$ governed by steady diffusion with a prescribed source. The Stokes regime implies negligible inertia. The governing fields are velocity $\\mathbf{u}(\\mathbf{x})$, pressure $p(\\mathbf{x})$, and composition $c(\\mathbf{x})$. The physical parameters are dynamic viscosity $\\mu$ (in $\\mathrm{Pa\\cdot s}$), density contrast per unit composition $\\Delta \\rho$ (in $\\mathrm{kg/m^3}$), and gravitational acceleration vector $\\mathbf{g}$ (in $\\mathrm{m/s^2}$). The scalar source $S(\\mathbf{x})$ has units of $\\mathrm{m^{-2}}$ because the steady diffusion equation is non-dimensional in $c$.\n\nAssume periodic boundary conditions for all fields in both spatial directions over the domain $[0,L)\\times[0,L)$. Adopt constant gravity $\\mathbf{g} = (0,-g)$ with $g>0$. The flow satisfies incompressibility. The steady creeping flow and composition fields satisfy, in physical space,\n- incompressibility: $\\nabla \\cdot \\mathbf{u} = 0$,\n- momentum balance: $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\Delta \\rho\\, c\\, \\mathbf{g} = \\mathbf{0}$,\n- composition diffusion: $\\nabla^2 c = - S$.\n\nStarting from these equations and using only fundamental principles (linear momentum balance, incompressibility, and steady diffusion), derive a spectrally accurate numerical method using the Fast Fourier Transform (FFT) to solve for $\\mathbf{u}(\\mathbf{x})$ and $c(\\mathbf{x})$ on a uniform $N\\times N$ grid with grid spacing $L/N$. You must work in a periodic setting and implement the method that is consistent with the above equations, using the wavevector representation appropriate for a periodic domain of side $L$.\n\nFor this problem, take the source in physical space to be\n$$ S(x,y) = S_0 \\cos\\!\\left(\\frac{2\\pi m x}{L}\\right)\\cos\\!\\left(\\frac{2\\pi n y}{L}\\right) $$\nwith integers $m,n \\ge 0$, amplitude $S_0$ (in $\\mathrm{m^{-2}}$), and coordinates $(x,y) \\in [0,L)\\times[0,L)$. The function $S(x,y)$ is periodic and has zero mean when at least one of $m$ or $n$ is nonzero.\n\nYour program must compute, for each specified parameter set, the root-mean-square speed\n$$ U_{\\mathrm{rms}} = \\left( \\frac{1}{L^2}\\int_0^L\\int_0^L \\left\\|\\mathbf{u}(x,y)\\right\\|^2 \\, \\mathrm{d}x\\,\\mathrm{d}y \\right)^{1/2} $$\nusing the spectrally computed velocity field $\\mathbf{u}$. Express $U_{\\mathrm{rms}}$ in $\\mathrm{m/s}$. Round each result to $6$ decimal places.\n\nTest suite. Use the following five parameter sets to test your implementation. In all cases, use a square domain with $L = 1.0$ (in $\\mathrm{m}$) and a uniform grid with $N = 64$. For gravity, take $\\mathbf{g} = (0,-g)$.\n\n- Case A (baseline, nonzero forcing): $\\mu = 100.0$ (in $\\mathrm{Pa\\cdot s}$), $\\Delta \\rho = 10.0$ (in $\\mathrm{kg/m^3}$), $g = 9.81$ (in $\\mathrm{m/s^2}$), $S_0 = 1.0$ (in $\\mathrm{m^{-2}}$), $m=1$, $n=1$.\n- Case B (no source, should yield zero flow): $\\mu = 100.0$, $\\Delta \\rho = 10.0$, $g = 9.81$, $S_0 = 0.0$, $m=1$, $n=1$.\n- Case C (high viscosity, weak flow): $\\mu = 100000.0$, $\\Delta \\rho = 10.0$, $g = 9.81$, $S_0 = 1.0$, $m=1$, $n=1$.\n- Case D (shorter wavelengths, reduced flow amplitude): $\\mu = 100.0$, $\\Delta \\rho = 10.0$, $g = 9.81$, $S_0 = 1.0$, $m=3$, $n=2$.\n- Case E (no gravity, should yield zero flow): $\\mu = 100.0$, $\\Delta \\rho = 10.0$, $g = 0.0$, $S_0 = 1.0$, $m=1$, $n=1$.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5]\"), where each $r_k$ is the $U_{\\mathrm{rms}}$ value for the corresponding case, in $\\mathrm{m/s}$, rounded to exactly $6$ decimal places. No additional text should be printed. The output must be in the order [Case A, Case B, Case C, Case D, Case E].\n\nAssumptions to respect:\n- Work strictly in the Stokes (creeping flow) regime.\n- Use periodic boundary conditions consistent with spectral derivatives.\n- Ensure the mean of $c$ is set so that the $\\mathbf{k}=\\mathbf{0}$ Fourier mode is treated in a manner consistent with the equations and periodicity.\n- Use the appropriate wavevectors for a box of size $L$, i.e., angular wavenumbers $k_x = 2\\pi\\,\\ell_x/L$, $k_y = 2\\pi\\,\\ell_y/L$, where $\\ell_x,\\ell_y$ are integer frequencies consistent with the discrete Fourier transform grid.",
            "solution": "The problem requires the derivation and implementation of a spectral method to solve for buoyancy-driven Stokes flow in a periodic domain. The solution must be computed in Fourier space using the Fast Fourier Transform (FFT).\n\n### **1. Problem Validation**\n\nFirst, the problem statement is validated against the specified criteria.\n\n**Step 1: Extract Givens**\n- **Governing Equations:**\n    - Incompressibility: $\\nabla \\cdot \\mathbf{u} = 0$\n    - Momentum balance: $-\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\Delta \\rho\\, c\\, \\mathbf{g} = \\mathbf{0}$\n    - Composition diffusion: $\\nabla^2 c = -S$\n- **Domain and Boundary Conditions:** A two-dimensional square domain $[0,L)\\times[0,L)$ with periodic boundary conditions for all fields ($\\mathbf{u}$, $p$, $c$).\n- **Physical Parameters:** Dynamic viscosity $\\mu$, density contrast $\\Delta \\rho$, gravitational acceleration vector $\\mathbf{g} = (0,-g)$ with $g>0$.\n- **Source Term:** $S(x,y) = S_0 \\cos\\!\\left(\\frac{2\\pi m x}{L}\\right)\\cos\\!\\left(\\frac{2\\pi n y}{L}\\right)$ with integer modes $m, n \\ge 0$ and amplitude $S_0$.\n- **Numerical Setup:** Uniform $N \\times N$ grid.\n- **Output:** Root-mean-square speed $U_{\\mathrm{rms}} = \\left( \\frac{1}{L^2}\\int_0^L\\int_0^L \\left\\|\\mathbf{u}(x,y)\\right\\|^2 \\, \\mathrm{d}x\\,\\mathrm{d}y \\right)^{1/2}$.\n- **Test Cases:** Five sets of parameters are provided for $(\\mu, \\Delta\\rho, g, S_0, m, n)$ with fixed $L=1.0$ and $N=64$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem describes a canonical Boussinesq-type approximation for buoyancy-driven creeping flow, which is a standard and fundamental model in geophysics and fluid dynamics. The governing equations are the well-established Stokes equations coupled to an advection-diffusion equation (here, simplified to steady diffusion). This is scientifically sound.\n- **Well-Posed:** The problem provides a complete set of linear partial differential equations with periodic boundary conditions and a well-defined forcing term. For the specified source term (with $m$ or $n$ non-zero, ensuring zero mean), the system has a unique solution for the velocity and composition fields (up to a constant for pressure, which does not affect the velocity). The problem is well-posed.\n- **Objective:** The problem is stated using precise mathematical and physical terminology, with no subjective or ambiguous language.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, well-posed, objective, and self-contained. It is therefore deemed **valid**. We may proceed with the solution.\n\n### **2. Derivation of the Spectral Solution**\n\nThe periodic nature of the domain makes the Fourier series an ideal basis for representing the fields. Any field $f(\\mathbf{x})$ can be written as a Fourier series:\n$$\nf(\\mathbf{x}) = \\sum_{\\mathbf{k}} \\hat{f}(\\mathbf{k}) e^{i \\mathbf{k} \\cdot \\mathbf{x}}\n$$\nwhere $\\mathbf{x}=(x,y)$ are the spatial coordinates and $\\mathbf{k}=(k_x, k_y)$ is the wavevector. For a periodic domain of side length $L$, the components of the wavevector are quantized: $k_x = \\frac{2\\pi \\ell_x}{L}$ and $k_y = \\frac{2\\pi \\ell_y}{L}$ for integers $\\ell_x, \\ell_y$.\n\nIn Fourier space, differential operators become algebraic multiplications:\n- Gradient: $\\nabla f \\rightarrow i\\mathbf{k} \\hat{f}(\\mathbf{k})$\n- Divergence: $\\nabla \\cdot \\mathbf{u} \\rightarrow i\\mathbf{k} \\cdot \\hat{\\mathbf{u}}(\\mathbf{k})$\n- Laplacian: $\\nabla^2 f \\rightarrow -|\\mathbf{k}|^2 \\hat{f}(\\mathbf{k}) = -(k_x^2 + k_y^2) \\hat{f}(\\mathbf{k})$\n\nApplying this transformation to the governing equations yields a system of algebraic equations for the Fourier coefficients of each field for each wavevector $\\mathbf{k}$:\n\n1.  **Incompressibility:**\n    $$i\\mathbf{k} \\cdot \\hat{\\mathbf{u}}(\\mathbf{k}) = 0$$\n    This condition implies that the velocity vector $\\hat{\\mathbf{u}}(\\mathbf{k})$ is orthogonal to the wavevector $\\mathbf{k}$ in Fourier space.\n\n2.  **Composition Diffusion:**\n    $$-|\\mathbf{k}|^2 \\hat{c}(\\mathbf{k}) = -\\hat{S}(\\mathbf{k})$$\n    For any non-zero wavevector $\\mathbf{k} \\ne \\mathbf{0}$, the composition coefficient is directly determined by the source:\n    $$\\hat{c}(\\mathbf{k}) = \\frac{\\hat{S}(\\mathbf{k})}{|\\mathbf{k}|^2}$$\n    For the zero wavevector $\\mathbf{k} = \\mathbf{0}$ (corresponding to the spatial mean), the equation becomes $0 = -\\hat{S}(\\mathbf{0})$. The provided source term has a zero mean ($\\hat{S}(\\mathbf{0}) = 0$) for the given test cases (where $m$ or $n$ is non-zero), so this is consistent. The equation does not constrain the mean composition $\\hat{c}(\\mathbf{0})$. However, as shown next, consistency of the momentum equation requires $\\hat{c}(\\mathbf{0})=0$.\n\n3.  **Momentum Balance:**\n    $$-i\\mathbf{k} \\hat{p}(\\mathbf{k}) - \\mu |\\mathbf{k}|^2 \\hat{\\mathbf{u}}(\\mathbf{k}) + \\Delta \\rho\\, \\hat{c}(\\mathbf{k})\\, \\mathbf{g} = \\mathbf{0}$$\n    For $\\mathbf{k} = \\mathbf{0}$, the equation reduces to $\\Delta \\rho\\, \\hat{c}(\\mathbf{0})\\, \\mathbf{g} = \\mathbf{0}$. Given $\\Delta \\rho \\ne 0$ and $\\mathbf{g} \\ne \\mathbf{0}$ in general, we must enforce $\\hat{c}(\\mathbf{0}) = 0$. The mean velocity $\\hat{\\mathbf{u}}(\\mathbf{0})$ is undetermined by this equation, but in the absence of a net external force, we set the mean flow to zero, $\\hat{\\mathbf{u}}(\\mathbf{0})=\\mathbf{0}$.\n\nFor $\\mathbf{k} \\ne \\mathbf{0}$, we can solve for $\\hat{\\mathbf{u}}(\\mathbf{k})$. First, we eliminate the pressure $\\hat{p}(\\mathbf{k})$ by taking the dot product of the momentum equation with $i\\mathbf{k}$ and applying the incompressibility condition $i\\mathbf{k} \\cdot \\hat{\\mathbf{u}}(\\mathbf{k}) = 0$:\n$$i\\mathbf{k} \\cdot (-i\\mathbf{k} \\hat{p}(\\mathbf{k})) - \\mu |\\mathbf{k}|^2 (i\\mathbf{k} \\cdot \\hat{\\mathbf{u}}(\\mathbf{k})) + i\\mathbf{k} \\cdot (\\Delta \\rho\\, \\hat{c}(\\mathbf{k})\\, \\mathbf{g}) = 0$$\n$$|\\mathbf{k}|^2 \\hat{p}(\\mathbf{k}) + i \\Delta \\rho\\, \\hat{c}(\\mathbf{k}) (\\mathbf{k} \\cdot \\mathbf{g}) = 0$$\n$$\\hat{p}(\\mathbf{k}) = -i \\frac{\\Delta \\rho\\, \\hat{c}(\\mathbf{k}) (\\mathbf{k} \\cdot \\mathbf{g})}{|\\mathbf{k}|^2}$$\nSubstituting this back into the momentum equation:\n$$-i\\mathbf{k} \\left(-i \\frac{\\Delta \\rho\\, \\hat{c}(\\mathbf{k}) (\\mathbf{k} \\cdot \\mathbf{g})}{|\\mathbf{k}|^2}\\right) - \\mu |\\mathbf{k}|^2 \\hat{\\mathbf{u}}(\\mathbf{k}) + \\Delta \\rho\\, \\hat{c}(\\mathbf{k})\\, \\mathbf{g} = \\mathbf{0}$$\n$$-\\frac{\\mathbf{k}(\\Delta \\rho\\, \\hat{c}(\\mathbf{k}) (\\mathbf{k} \\cdot \\mathbf{g}))}{|\\mathbf{k}|^2} - \\mu |\\mathbf{k}|^2 \\hat{\\mathbf{u}}(\\mathbf{k}) + \\Delta \\rho\\, \\hat{c}(\\mathbf{k})\\, \\mathbf{g} = \\mathbf{0}$$\nRearranging to solve for $\\hat{\\mathbf{u}}(\\mathbf{k})$:\n$$\\mu |\\mathbf{k}|^2 \\hat{\\mathbf{u}}(\\mathbf{k}) = \\Delta \\rho\\, \\hat{c}(\\mathbf{k}) \\left( \\mathbf{g} - \\frac{\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{g})}{|\\mathbf{k}|^2} \\right)$$\nThe term in parentheses is a projection operator that projects the vector $\\mathbf{g}$ onto the plane perpendicular to $\\mathbf{k}$. Substituting $\\hat{c}(\\mathbf{k}) = \\hat{S}(\\mathbf{k})/|\\mathbf{k}|^2$:\n$$\\hat{\\mathbf{u}}(\\mathbf{k}) = \\frac{\\Delta \\rho\\, \\hat{S}(\\mathbf{k})}{\\mu |\\mathbf{k}|^4} \\left( \\mathbf{g} - \\frac{\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{g})}{|\\mathbf{k}|^2} \\right)$$\nThis provides the velocity spectrum for all $\\mathbf{k} \\ne \\mathbf{0}$.\n\n### **3. Numerical Algorithm and RMS Velocity**\n\nThe problem is solved numerically on an $N \\times N$ grid. The continuous Fourier series coefficients $\\hat{f}(\\mathbf{k})$ are replaced by their discrete counterparts from the FFT, which we denote $F_k$. For a field $f$ sampled on the grid, its 2D DFT is $F_k = \\sum_{j_x, j_y} f_{j_x, j_y} e^{-i(k_x x_{j_x} + k_y y_{j_y})}$. The governing equations retain the same form for these discrete coefficients.\n\nThe algorithm is as follows:\n1.  **Grid Setup:** Define a physical grid $(x_j, y_l)$ and a corresponding wavevector grid $(k_x, k_y)$ for an $N \\times N$ domain of size $L$. The angular wavenumbers are $k_i = 2\\pi f_i$, where $f_i$ are the frequencies given by `numpy.fft.fftfreq`.\n2.  **Source Term:** Evaluate the source $S(x,y)$ on the physical grid.\n3.  **FFT of Source:** Compute the 2D DFT of the source, $S_k = \\text{FFT2}(S(x,y))$.\n4.  **Velocity Spectrum:** Compute the DFT coefficients of the velocity components, $U_{x,k}$ and $U_{y,k}$, using the derived formula. With $\\mathbf{g} = (0, -g)$ and $\\mathbf{k} = (k_x, k_y)$, the components of the projected gravity term are $\\left(\\frac{g k_x k_y}{|\\mathbf{k}|^2}, -\\frac{g k_x^2}{|\\mathbf{k}|^2}\\right)$. This gives the velocity components in Fourier space:\n    $$U_{x,k} = \\frac{\\Delta \\rho\\, S_k}{\\mu |\\mathbf{k}|^4} \\left( \\frac{g k_x k_y}{|\\mathbf{k}|^2} \\right) = \\frac{\\Delta \\rho\\, g}{\\mu} \\frac{S_k k_x k_y}{|\\mathbf{k}|^6}$$\n    $$U_{y,k} = \\frac{\\Delta \\rho\\, S_k}{\\mu |\\mathbf{k}|^4} \\left( -\\frac{g k_x^2}{|\\mathbf{k}|^2} \\right) = -\\frac{\\Delta \\rho\\, g}{\\mu} \\frac{S_k k_x^2}{|\\mathbf{k}|^6}$$\n    These formulae are applied only where $|\\mathbf{k}| \\ne 0$. For $|\\mathbf{k}|=0$, $U_k = 0$.\n\n5.  **RMS Speed Calculation:** The root-mean-square speed $U_{\\mathrm{rms}}$ is computed using Parseval's theorem, which relates the integral of a squared function to the sum of its squared Fourier coefficients. For the 2D DFT as implemented in `numpy`:\n    $$\\sum_{j_x=0}^{N-1} \\sum_{j_y=0}^{N-1} |f(x_{j_x}, y_{j_y})|^2 = \\frac{1}{N^2} \\sum_{k_x, k_y} |F_k|^2$$\n    The definition of $U_{\\mathrm{rms}}^2$ can be approximated by a sum over the grid points:\n    $$U_{\\mathrm{rms}}^2 = \\frac{1}{L^2}\\int_0^L\\int_0^L \\|\\mathbf{u}\\|^2 \\,dx\\,dy \\approx \\frac{1}{L^2} \\sum_{j_x, j_y} \\|\\mathbf{u}(x_{j_x}, y_{j_y})\\|^2 \\left(\\frac{L}{N}\\right)^2 = \\frac{1}{N^2} \\sum_{j_x, j_y} \\|\\mathbf{u}_{j_x, j_y}\\|^2$$\n    Applying Parseval's theorem to each component of the velocity:\n    $$U_{\\mathrm{rms}}^2 = \\frac{1}{N^2} \\left( \\sum_{j_x,j_y} |u_x|^2 + \\sum_{j_x,j_y} |u_y|^2 \\right) = \\frac{1}{N^2} \\left( \\frac{1}{N^2}\\sum_{k} |U_{x,k}|^2 + \\frac{1}{N^2}\\sum_{k} |U_{y,k}|^2 \\right)$$\n    $$U_{\\mathrm{rms}} = \\frac{1}{N^2} \\sqrt{ \\sum_{\\mathbf{k}} \\left( |U_{x,k}|^2 + |U_{y,k}|^2 \\right) }$$\n    This allows for the efficient calculation of $U_{\\mathrm{rms}}$ directly from the computed velocity spectrum, without performing an inverse FFT.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for Stokes flow for all test cases and print results.\n    \"\"\"\n\n    test_cases = [\n        # Case A: (mu, delta_rho, g, S0, m, n)\n        (100.0, 10.0, 9.81, 1.0, 1, 1),\n        # Case B:\n        (100.0, 10.0, 9.81, 0.0, 1, 1),\n        # Case C:\n        (100000.0, 10.0, 9.81, 1.0, 1, 1),\n        # Case D:\n        (100.0, 10.0, 9.81, 1.0, 3, 2),\n        # Case E:\n        (100.0, 10.0, 0.0, 1.0, 1, 1),\n    ]\n\n    results = []\n    for params in test_cases:\n        u_rms = calculate_rms_speed(*params)\n        results.append(f\"{u_rms:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_rms_speed(mu, delta_rho, g, S0, m, n):\n    \"\"\"\n    Calculates the root-mean-square speed for a given set of physical parameters.\n\n    The method solves the steady, incompressible Stokes equations driven by buoyancy\n    in a 2D periodic domain using a spectral (FFT-based) method.\n\n    Parameters:\n    mu (float): Dynamic viscosity (Pa.s)\n    delta_rho (float): Density contrast per unit composition (kg/m^3)\n    g (float): Gravitational acceleration magnitude (m/s^2)\n    S0 (float): Source term amplitude (m^-2)\n    m, n (int): Wavenumbers of the source term\n\n    Returns:\n    float: The root-mean-square speed (U_rms) in m/s.\n    \"\"\"\n    # Grid and domain parameters as specified in the problem\n    L = 1.0  # m\n    N = 64\n    \n    # Handle trivial cases where no flow is expected\n    if S0 == 0.0 or g == 0.0:\n        return 0.0\n\n    # 1. Set up physical and spectral grids\n    # Physical grid coordinates\n    x = (L / N) * np.arange(N)\n    X, Y = np.meshgrid(x, x, indexing='ij')\n\n    # Spectral grid wavenumbers (angular)\n    freq = np.fft.fftfreq(N, d=L / N)\n    k = 2 * np.pi * freq\n    Kx, Ky = np.meshgrid(k, k, indexing='ij')\n    \n    # Squared magnitude of the wavevector\n    K2 = Kx**2 + Ky**2\n\n    # 2. Define source term in physical space and transform to Fourier space\n    S_grid = S0 * np.cos(2 * np.pi * m * X / L) * np.cos(2 * np.pi * n * Y / L)\n    S_dft = np.fft.fft2(S_grid)\n\n    # 3. Compute velocity components in Fourier space\n    \n    # Pre-compute a common factor\n    factor = (delta_rho * g) / mu\n    \n    # To avoid division by zero at k=0, we use np.divide with a `where` clause.\n    # The velocity response at k=0 is zero anyway.\n    K6_inv = np.divide(1.0, K2**3, where=(K2 > 0), out=np.zeros_like(K2))\n\n    # Calculate DFT coefficients for velocity components u_x and u_y.\n    # U_x,k = (Δρ*g/μ) * (S_k * k_x * k_y) / |k|^6\n    # U_y,k = -(Δρ*g/μ) * (S_k * k_x^2) / |k|^6\n    \n    Ukx_dft = factor * S_dft * (Kx * Ky) * K6_inv\n    Uky_dft = -factor * S_dft * (Kx**2) * K6_inv\n\n    # 4. Calculate RMS speed using Parseval's theorem\n    # U_rms^2 = (1/N^4) * Σ_k ( |U_{x,k}|^2 + |U_{y,k}|^2 )\n    sum_sq_U_dft = np.sum(np.abs(Ukx_dft)**2 + np.abs(Uky_dft)**2)\n    \n    u_rms = (1 / N**2) * np.sqrt(sum_sq_U_dft)\n\n    return u_rms\n\nsolve()\n```"
        }
    ]
}