{
    "hands_on_practices": [
        {
            "introduction": "理解卡尔曼滤波的第一步是掌握其核心的预测-分析循环。本练习将引导您对一个简化的低维地球物理系统完成一个完整的同化步骤。通过从第一性原理推导并应用更新方程，您将具体理解滤波器如何将模型预测与新的观测数据进行最优融合，从而修正状态估计并降低其不确定性。",
            "id": "3605721",
            "problem": "考虑一个线性、时间离散的状态空间模型，该模型以标准化的无量纲单位表示一个简化的双站全球定位系统（GPS）地表位移系统。时刻 $k$ 的状态向量 $\\mathbf{x}_{k} \\in \\mathbb{R}^{2}$ 包含了两个耦合的、标准化的水平位移。预报（模型）步骤由下式给出\n$$\n\\mathbf{x}_{k} = A\\,\\mathbf{x}_{k-1} + \\mathbf{w}_{k-1},\n$$\n其中 $\\mathbf{w}_{k-1} \\sim \\mathcal{N}(\\mathbf{0},Q)$ 是零均值高斯模型误差，与过去的状态和观测值无关。通过下式获得一个标量观测值 $y_{k} \\in \\mathbb{R}$\n$$\ny_{k} = H\\,\\mathbf{x}_{k} + v_{k},\n$$\n其中 $v_{k} \\sim \\mathcal{N}(0,R)$ 是零均值高斯观测误差，与 $\\mathbf{w}_{k-1}$ 和 $\\mathbf{x}_{k}$ 无关。给定时刻 $k-1$ 的分析（后验）均值 $\\boldsymbol{\\mu}_{a,k-1}$ 和协方差 $P_{a,k-1}$，以及在时刻 $k$ 进行一次同化步骤所需的系统和数据如下：\n$$\nA = \\begin{pmatrix} 0.9  0.1 \\\\ 0.2  0.8 \\end{pmatrix},\\quad\nH = \\begin{pmatrix} 1  0.5 \\end{pmatrix},\\quad\nQ = \\begin{pmatrix} 0.04  0.01 \\\\ 0.01  0.09 \\end{pmatrix},\\quad\nR = 0.05,\n$$\n$$\n\\boldsymbol{\\mu}_{a,k-1} = \\begin{pmatrix} 1.0 \\\\ 0.5 \\end{pmatrix},\\quad\nP_{a,k-1} = \\begin{pmatrix} 0.2  0.05 \\\\ 0.05  0.3 \\end{pmatrix},\\quad\ny = 1.2.\n$$\n从线性高斯状态空间模型和 Bayes 法则的基本定义出发，且不援引问题陈述中任何预先给出的滤波公式，对时刻 $k$ 的单个（1个）分析循环执行以下操作：\n- 推导并计算时刻 $k$ 的预报（先验）均值 $\\boldsymbol{\\mu}_{f}$ 和协方差 $P_{f}$。\n- 在同化 $y$ 后，推导并计算分析（后验）均值 $\\boldsymbol{\\mu}_{a}$ 和协方差 $P_{a}$。\n- 在线性高斯估计和集合卡尔曼滤波器（EnKF）的大集合极限背景下，简要解释相对于 $Q$ 增加 $R$ 会如何改变分析结果。\n\n作为最终报告的标量，请提供卡尔曼增益向量的第一个分量，记为 $K_{11}$（$2 \\times 1$ 增益向量的第一个元素），并四舍五入到四位有效数字。报告的标量是无量纲的。请勿报告任何其他量作为最终答案。如果计算了中间数值，请展示它们，但最终答案只应报告四舍五入到四位有效数字的 $K_{11}$。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、提法恰当且客观的。它为线性卡尔曼滤波器的单次预报-分析循环提供了一个完整且一致的设定。在标准化的背景下，所有给定的矩阵和数值在数学上都是有效的，在物理上也是合理的。我现在开始解答。\n\n题目要求从第一性原理出发进行推导。根据问题设定，时刻 $k-1$ 的分析（后验）分布为 $\\mathbf{x}_{k-1} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{a,k-1}, P_{a,k-1})$，其中\n$$\n\\boldsymbol{\\mu}_{a,k-1} = \\begin{pmatrix} 1.0 \\\\ 0.5 \\end{pmatrix}, \\quad P_{a,k-1} = \\begin{pmatrix} 0.2  0.05 \\\\ 0.05  0.3 \\end{pmatrix}.\n$$\n\n### 预报步骤\n第一个任务是推导并计算时刻 $k$ 的预报（先验）均值 $\\boldsymbol{\\mu}_{f}$ 和协方差 $P_{f}$。时刻 $k$ 的状态由预报模型给出：\n$$\n\\mathbf{x}_{k} = A\\,\\mathbf{x}_{k-1} + \\mathbf{w}_{k-1}\n$$\n其中 $\\mathbf{w}_{k-1} \\sim \\mathcal{N}(\\mathbf{0}, Q)$。状态 $\\mathbf{x}_{k}$ 是两个独立高斯随机变量的和，因此它本身也是高斯分布的。其分布即为时刻 $k$ 分析步骤的预报（先验）分布。\n\n**预报均值推导：**\n我们记作 $\\boldsymbol{\\mu}_{f}$ 的预报均值是 $\\mathbf{x}_k$ 的期望值。根据期望的线性性质：\n$$\n\\boldsymbol{\\mu}_{f} = E[\\mathbf{x}_{k}] = E[A\\,\\mathbf{x}_{k-1} + \\mathbf{w}_{k-1}] = A\\,E[\\mathbf{x}_{k-1}] + E[\\mathbf{w}_{k-1}]\n$$\n已知 $E[\\mathbf{x}_{k-1}] = \\boldsymbol{\\mu}_{a,k-1}$ 且 $E[\\mathbf{w}_{k-1}] = \\mathbf{0}$，我们有：\n$$\n\\boldsymbol{\\mu}_{f} = A\\,\\boldsymbol{\\mu}_{a,k-1}\n$$\n\n**预报协方差推导：**\n预报协方差 $P_{f}$ 是 $\\mathbf{x}_k$ 的协方差：\n$$\nP_{f} = \\text{Cov}(\\mathbf{x}_k) = E[(\\mathbf{x}_k - \\boldsymbol{\\mu}_{f})(\\mathbf{x}_k - \\boldsymbol{\\mu}_{f})^T]\n$$\n代入 $\\mathbf{x}_k$ 和 $\\boldsymbol{\\mu}_{f}$ 的表达式：\n$$\nP_{f} = E[(A\\,\\mathbf{x}_{k-1} + \\mathbf{w}_{k-1} - A\\,\\boldsymbol{\\mu}_{a,k-1})(A\\,\\mathbf{x}_{k-1} + \\mathbf{w}_{k-1} - A\\,\\boldsymbol{\\mu}_{a,k-1})^T]\n$$\n$$\nP_{f} = E[(A(\\mathbf{x}_{k-1} - \\boldsymbol{\\mu}_{a,k-1}) + \\mathbf{w}_{k-1})(A(\\mathbf{x}_{k-1} - \\boldsymbol{\\mu}_{a,k-1}) + \\mathbf{w}_{k-1})^T]\n$$\n展开乘积并利用期望的线性性质，我们得到：\n$$\nP_{f} = A E[(\\mathbf{x}_{k-1} - \\boldsymbol{\\mu}_{a,k-1})(\\mathbf{x}_{k-1} - \\boldsymbol{\\mu}_{a,k-1})^T] A^T + E[\\mathbf{w}_{k-1}\\mathbf{w}_{k-1}^T] \\\\ + A E[(\\mathbf{x}_{k-1} - \\boldsymbol{\\mu}_{a,k-1})\\mathbf{w}_{k-1}^T] + E[\\mathbf{w}_{k-1}(\\mathbf{x}_{k-1} - \\boldsymbol{\\mu}_{a,k-1})^T]A^T\n$$\n由于 $\\mathbf{x}_{k-1}$ 和 $\\mathbf{w}_{k-1}$ 是独立的，交叉相关项为零。由于 $E[(\\mathbf{x}_{k-1} - \\boldsymbol{\\mu}_{a,k-1})(\\mathbf{x}_{k-1} - \\boldsymbol{\\mu}_{a,k-1})^T] = P_{a,k-1}$ 以及 $E[\\mathbf{w}_{k-1}\\mathbf{w}_{k-1}^T] = Q$，表达式简化为：\n$$\nP_{f} = A P_{a,k-1} A^T + Q\n$$\n\n**计算：**\n使用给定的值：\n$$\n\\boldsymbol{\\mu}_{f} = \\begin{pmatrix} 0.9  0.1 \\\\ 0.2  0.8 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.5 \\end{pmatrix} = \\begin{pmatrix} 0.9(1.0) + 0.1(0.5) \\\\ 0.2(1.0) + 0.8(0.5) \\end{pmatrix} = \\begin{pmatrix} 0.95 \\\\ 0.60 \\end{pmatrix}\n$$\n$$\nA P_{a,k-1} A^T = \\begin{pmatrix} 0.9  0.1 \\\\ 0.2  0.8 \\end{pmatrix} \\begin{pmatrix} 0.2  0.05 \\\\ 0.05  0.3 \\end{pmatrix} \\begin{pmatrix} 0.9  0.2 \\\\ 0.1  0.8 \\end{pmatrix} = \\begin{pmatrix} 0.174  0.097 \\\\ 0.097  0.216 \\end{pmatrix}\n$$\n$$\nP_{f} = A P_{a,k-1} A^T + Q = \\begin{pmatrix} 0.174  0.097 \\\\ 0.097  0.216 \\end{pmatrix} + \\begin{pmatrix} 0.04  0.01 \\\\ 0.01  0.09 \\end{pmatrix} = \\begin{pmatrix} 0.214  0.107 \\\\ 0.107  0.306 \\end{pmatrix}\n$$\n因此，预报均值为 $\\boldsymbol{\\mu}_{f} = \\begin{pmatrix} 0.95 \\\\ 0.60 \\end{pmatrix}$，协方差为 $P_{f} = \\begin{pmatrix} 0.214  0.107 \\\\ 0.107  0.306 \\end{pmatrix}$。\n\n### 分析步骤\n分析步骤使用观测值 $y_k=y$ 将预报分布 $p(\\mathbf{x}_k) \\sim \\mathcal{N}(\\boldsymbol{\\mu}_{f}, P_{f})$ 更新为分析（后验）分布 $p(\\mathbf{x}_k|y_k) \\sim \\mathcal{N}(\\boldsymbol{\\mu}_a, P_a)$。\n\n**分析均值和协方差推导：**\n根据 Bayes 法则，后验概率密度与似然和先验的乘积成正比：$p(\\mathbf{x}_k|y_k) \\propto p(y_k|\\mathbf{x}_k) p(\\mathbf{x}_k)$。\n似然由观测模型 $y_k = H\\mathbf{x}_k + v_k$（其中 $v_k \\sim \\mathcal{N}(0,R)$）导出，得到 $p(y_k|\\mathbf{x}_k) \\sim \\mathcal{N}(H\\mathbf{x}_k, R)$。\n分析分布是高斯的。其负对数是关于 $\\mathbf{x}_k$ 的二次型：\n$$\n-\\ln p(\\mathbf{x}_k|y_k) \\propto \\frac{1}{2}(y_k - H\\mathbf{x}_k)^T R^{-1} (y_k - H\\mathbf{x}_k) + \\frac{1}{2}(\\mathbf{x}_k - \\boldsymbol{\\mu}_{f})^T P_{f}^{-1} (\\mathbf{x}_k - \\boldsymbol{\\mu}_{f})\n$$\n展开并合并关于 $\\mathbf{x}_k$ 的项：\n$$\n\\propto \\frac{1}{2}\\mathbf{x}_k^T(P_{f}^{-1} + H^T R^{-1} H)\\mathbf{x}_k - (\\boldsymbol{\\mu}_{f}^T P_{f}^{-1} + y_k^T R^{-1} H)\\mathbf{x}_k\n$$\n这种二次型对应于一个高斯分布 $\\mathcal{N}(\\boldsymbol{\\mu}_a, P_a)$，其中逆协方差（精度矩阵）是该二次型的 Hessian 矩阵，均值是使其最小化的点。\n因此，分析协方差的逆为：\n$$\nP_a^{-1} = P_{f}^{-1} + H^T R^{-1} H\n$$\n通过将关于 $\\mathbf{x}_k$ 的梯度设为零，可以找到分析均值 $\\boldsymbol{\\mu}_a$：\n$$\nP_a^{-1} \\boldsymbol{\\mu}_a = P_{f}^{-1}\\boldsymbol{\\mu}_{f} + H^T R^{-1}y_k \\implies \\boldsymbol{\\mu}_a = P_a (P_{f}^{-1}\\boldsymbol{\\mu}_{f} + H^T R^{-1}y_k)\n$$\n使用 Woodbury 矩阵恒等式，$P_a = (P_{f}^{-1} + H^T R^{-1} H)^{-1} = P_{f} - P_{f}H^T(R + H P_{f} H^T)^{-1}H P_{f}$。\n我们定义卡尔曼增益 $K = P_{f}H^T(H P_{f} H^T + R)^{-1}$。\n那么，分析协方差变为 $P_a = P_{f} - K H P_{f} = (I - K H)P_{f}$。\n将此代入 $\\boldsymbol{\\mu}_a$ 的方程并简化（如详细的教科书推导所示），即可得到熟悉的更新方程：\n$$\n\\boldsymbol{\\mu}_a = \\boldsymbol{\\mu}_{f} + K(y_k - H\\boldsymbol{\\mu}_{f})\n$$\n\n**计算：**\n我们使用 $y=1.2$，$H=\\begin{pmatrix} 1  0.5 \\end{pmatrix}$ 和 $R=0.05$。\n首先，计算新息（残差）及其协方差：\n$$\n\\text{新息： } d = y - H\\boldsymbol{\\mu}_{f} = 1.2 - (\\begin{pmatrix} 1  0.5 \\end{pmatrix} \\begin{pmatrix} 0.95 \\\\ 0.60 \\end{pmatrix}) = 1.2 - (0.95+0.30) = 1.2 - 1.25 = -0.05\n$$\n$$\nP_{f}H^T = \\begin{pmatrix} 0.214  0.107 \\\\ 0.107  0.306 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0.5 \\end{pmatrix} = \\begin{pmatrix} 0.214+0.0535 \\\\ 0.107+0.153 \\end{pmatrix} = \\begin{pmatrix} 0.2675 \\\\ 0.260 \\end{pmatrix}\n$$\n$$\n\\text{新息协方差： } S = H P_{f} H^T + R = \\begin{pmatrix} 1  0.5 \\end{pmatrix} \\begin{pmatrix} 0.2675 \\\\ 0.260 \\end{pmatrix} + 0.05 = (0.2675+0.13) + 0.05 = 0.3975 + 0.05 = 0.4475\n$$\n现在，计算卡尔曼增益 $K$：\n$$\nK = P_{f}H^T S^{-1} = \\begin{pmatrix} 0.2675 \\\\ 0.260 \\end{pmatrix} (0.4475)^{-1} = \\frac{1}{0.4475} \\begin{pmatrix} 0.2675 \\\\ 0.260 \\end{pmatrix} \\approx \\begin{pmatrix} 0.597765 \\\\ 0.581005 \\end{pmatrix}\n$$\n分析均值 $\\boldsymbol{\\mu}_a$：\n$$\n\\boldsymbol{\\mu}_a = \\begin{pmatrix} 0.95 \\\\ 0.60 \\end{pmatrix} + \\begin{pmatrix} 0.597765 \\\\ 0.581005 \\end{pmatrix}(-0.05) \\approx \\begin{pmatrix} 0.95 - 0.029888 \\\\ 0.60 - 0.029050 \\end{pmatrix} = \\begin{pmatrix} 0.920112 \\\\ 0.570950 \\end{pmatrix}\n$$\n分析协方差 $P_a$：\n$$\nP_a = (I-KH)P_{f}. \\text{ 我们发现 } K \\approx \\begin{pmatrix} 0.5978 \\\\ 0.5810 \\end{pmatrix}, H = \\begin{pmatrix} 1  0.5 \\end{pmatrix}.\n$$\n$$\nP_a \\approx \\begin{pmatrix} 0.0541  -0.0484 \\\\ -0.0484  0.1549 \\end{pmatrix}\n$$\n\n### 改变 $R$ 相对于 $Q$ 的影响\n卡尔曼增益为 $K = P_{f} H^T (H P_{f} H^T + R)^{-1}$。分析更新为 $\\boldsymbol{\\mu}_{a} = \\boldsymbol{\\mu}_{f} + K(y - H\\boldsymbol{\\mu}_{f})$。卡尔曼增益 $K$ 决定了与预报 $\\boldsymbol{\\mu}_{f}$ 相比，观测新息 $(y - H\\boldsymbol{\\mu}_{f})$ 被赋予多大的权重。\n\n模型误差协方差 $Q$ 影响预报误差协方差 $P_{f} = AP_{a,k-1}A^T + Q$。$Q$ 的增加会导致预报不确定性的增加，即 $P_{f}$ 中的元素变大。\n\n观测误差方差 $R$ 出现在增益表达式的分母中。\n\n相对于 $Q$ 增加 $R$ 意味着与模型预报相比，观测值被认为噪声更大、可靠性更低。\n- **对卡尔曼增益 $K$ 的影响**：随着 $R$ 增加， $K$ 的分母中的标量项 $S = H P_{f} H^T + R$ 会增加。这导致卡尔曼增益向量 $K$ 的大小减小。\n- **对分析的影响**：当 $K$ 较小时，应用于预报均值的修正项 $K(y-H\\boldsymbol{\\mu}_{f})$ 会更小。因此，分析均值 $\\boldsymbol{\\mu}_a$ 将更接近预报均值 $\\boldsymbol{\\mu}_{f}$。本质上，系统更信任模型预报，而不是带噪声的观测。分析协方差 $P_a = (I-KH)P_{f}$ 将更接近预报协方差 $P_{f}$，这意味着在同化观测后不确定性的减少量更少。\n\n在大集合极限情况下的集合卡尔曼滤波器（EnKF）背景中，集合协方差矩阵会收敛到标准卡尔曼滤波器的理论协方差矩阵（$P_{f,e} \\to P_{f}$）。因此，由集合导出的卡尔曼增益 $K_e$ 会收敛到 $K$。其解释保持不变：相对于 $Q$（模型噪声的方差）增加 $R$（人工观测扰动的方差）会减小应用于每个集合成员的分析更新的大小。由此产生的分析集合（及其均值）将更接近预报集合，这反映了相对于不确定的测量，系统更信任模型动力学。\n\n最终要求的标量是卡尔曼增益向量的第一个分量 $K_{11}$，四舍五入到四位有效数字。\n$$K_{11} = \\frac{0.2675}{0.4475} = \\frac{107}{179} \\approx 0.59776536...$$\n四舍五入到四位有效数字得到 $0.5978$。",
            "answer": "$$\\boxed{0.5978}$$"
        },
        {
            "introduction": "在计算实践中，理论上等价的公式可能表现出截然不同的数值行为。本练习直面卡尔曼滤波协方差更新中的数值稳定性这一关键问题，这也是实际应用中的一个常见陷阱。通过比较一个简化的更新公式与其数值稳健的对应形式（如 Joseph 稳定形式），您将亲眼见证有限精度算术如何导致灾难性的失败，并理解为何稳定的算法对于可靠的数据同化至关重要。",
            "id": "3605729",
            "problem": "考虑一个线性高斯状态估计问题，该问题在计算地球物理学中模拟了对两个层平均地震慢度的序贯反演。隐藏状态表示为 $x \\in \\mathbb{R}^2$，模型为带有高斯过程噪声的静态恒等动态，并在每次更新时有单个标量观测。该系统遵循标准的线性高斯状态空间模型：\n$$\nx_{k+1} = F x_k + w_k,\\quad y_k = H x_k + v_k,\n$$\n其中 $F \\in \\mathbb{R}^{2 \\times 2}$ 是恒等矩阵（代表静态参数），$H \\in \\mathbb{R}^{1 \\times 2}$ 是将状态映射到观测到的走时残差的行向量，$w_k \\sim \\mathcal{N}(0, Q)$ 是高斯过程噪声，$v_k \\sim \\mathcal{N}(0, R)$ 是高斯观测噪声，其标量方差 $R  0$。先验协方差为 $P_k^- \\in \\mathbb{R}^{2 \\times 2}$，后验协方差为 $P_k^+ \\in \\mathbb{R}^{2 \\times 2}$，为了统计一致性，两者都要求是对称半正定的。\n\n卡尔曼增益 $K_k \\in \\mathbb{R}^{2 \\times 1}$ 由通常的标准线性高斯更新定义，由新息协方差 $S_k = H P_k^- H^\\top + R$ 计算得出：\n$$\nK_k = P_k^- H^\\top S_k^{-1},\\quad S_k = H P_k^- H^\\top + R.\n$$\n\n您将为单个标量观测实现并比较三种协方差更新策略：\n1. 一种刻意过简化的协方差更新（在实践中常被错误使用），定义为\n$$\nP_k^{+,\\mathrm{simp}} = P_k^- - K_k H P_k^-.\n$$\n此更新忽略了来自观测噪声协方差的加性项，并且已知在数值上和统计上都是不安全的。\n\n2. Joseph稳定化协方差更新，定义为\n$$\nP_k^{+,\\mathrm{Joseph}} = (I - K_k H) P_k^- (I - K_k H)^\\top + K_k R K_k^\\top,\n$$\n其中 $I$ 是相应维度的恒等矩阵。\n\n3. 使用Cholesky降阶更新的平方根协方差更新。设 $P_k^- = R_k^\\top R_k$ 是Cholesky分解，其中 $R_k$ 为上三角矩阵，并设 $S_k = H P_k^- H^\\top + R$。定义降阶向量\n$$\nw_k = \\frac{P_k^- H^\\top}{\\sqrt{S_k}}.\n$$\n对 $R_k$ 和 $w_k$ 执行一阶Cholesky降阶更新，以获得 $R_k^+$，使得\n$$\nP_k^{+,\\mathrm{sqrt}} = (R_k^+)^\\top R_k^+ = P_k^- - w_k w_k^\\top.\n$$\n这种平方根形式在温和条件下能保持对称性和半正定性，并使用稳定的正交变换。\n\n从贝叶斯线性高斯定义出发，根据条件高斯分布的第一性原理推导Joseph形式，并证明恒等式\n$$\nP_k^{+} = P_k^- - P_k^- H^\\top S_k^{-1} H P_k^-,\n$$\n该恒等式产生对称的后验协方差，并与标量观测的一阶降阶更新相关联。解释为什么过简化的更新 $P_k^{+,\\mathrm{simp}}$ 会因忽略观测噪声的贡献而可能失去半正定性或导致发散。\n\n您的程序必须实现所有三种更新，执行下方的测试套件，并报告过简化更新的问题行为以及Joseph方法和平方根方法鲁棒性的数值证据。\n\n此问题的最终答案无需报告物理单位，因为输出是无量纲的矩阵属性和标量。\n\n测试套件。对于每个案例，除非另有说明，否则假设 $F = I_{2 \\times 2}$ 且只有一个同化步骤。请使用所提供的确切参数值。\n\n- 案例1（正常路径，良态）：\n    - 先验协方差 $P_0^- = \\begin{bmatrix} 1.0  0.2 \\\\ 0.2  1.0 \\end{bmatrix}$，\n    - 观测算子 $H = \\begin{bmatrix} 1.0  0.5 \\end{bmatrix}$，\n    - 观测噪声方差 $R = 0.1$，\n    - 同化周期数：$1$。\n\n- 案例2（病态，近奇异相关，单次更新）：\n    - 先验协方差 $P_0^- = \\begin{bmatrix} 1.0  0.999999 \\\\ 0.999999  1.0 \\end{bmatrix}$，\n    - 观测算子 $H = \\begin{bmatrix} 1.0  -1.0 \\end{bmatrix}$，\n    - 观测噪声方差 $R = 10^{-12}$，\n    - 同化周期数：$1$。\n\n- 案例3（病态，重复更新导致简化形式发散）：\n    - 先验协方差 $P_0^- = \\begin{bmatrix} 1.0  0.999999 \\\\ 0.999999  1.0 \\end{bmatrix}$，\n    - 观测算子 $H = \\begin{bmatrix} 1.0  -1.0 \\end{bmatrix}$，\n    - 观测噪声方差 $R = 10^{-15}$，\n    - 同化周期数：$3$。\n\n对于每个案例，计算：\n- 在指定数量的同化周期后，$P_k^{+,\\mathrm{simp}}$、$P_k^{+,\\mathrm{Joseph}}$ 和 $P_k^{+,\\mathrm{sqrt}}$ 的最小特征值（在周期中使用最终的 $P^+$）。\n- 每种方法的半正定性布尔指标，定义为 $\\min \\operatorname{eig}(P^+) \\geq -\\tau$，容差 $\\tau = 10^{-12}$。\n- 一个布尔指标，用于指示根据每种方法的后验协方差计算出的下一步新息方差 $S_{\\mathrm{next}} = H P_k^+ H^\\top + R$ 是否严格为正。该量为非正值表示数值发散或出现了不符合物理的负方差。\n\n最终输出格式。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试案例的结果应按以下顺序排列：\n[min_eig_simplified, min_eig_joseph, min_eig_sqrt, is_psd_simplified, is_psd_joseph, is_psd_sqrt, innovation_positive_simplified, innovation_positive_joseph, innovation_positive_sqrt]\n以使整体输出为一个包含三个列表的列表，每个测试案例一个列表。例如：\n[[res_case1],[res_case2],[res_case3]]",
            "solution": "该问题是有效的，因为它在科学上基于估计理论（特别是卡尔曼滤波），并提出了一个在计算科学中常见的、适定的数值比较任务。它是客观、自洽的，所有提供的公式和参数都与该主题的标准文献一致，旨在测试不同协方差更新公式的数值鲁棒性。\n\n这个问题的核心在于理解卡尔曼滤波器协方差更新的不同但数学上等价形式的推导和数值稳定性。我们将首先从贝叶斯原理推导标准更新形式，然后展示其与Joseph稳定化形式的关系，最后解释测试案例旨在揭示的数值失效机制。\n\n**1. 标准对称协方差更新的推导**\n\n状态 $x_k \\in \\mathbb{R}^n$（这里 $n=2$）与观测 $y_k \\in \\mathbb{R}^m$（这里 $m=1$）之间的关系由一个联合高斯分布定义。状态的先验分布为 $p(x_k) = \\mathcal{N}(x_k; \\hat{x}_k^-, P_k^-)$，似然由观测模型 $p(y_k | x_k) = \\mathcal{N}(y_k; H x_k, R)$ 给出。更新步骤的目标是找到后验分布 $p(x_k | y_k) = \\mathcal{N}(x_k; \\hat{x}_k^+, P_k^+)$。\n\n对于联合高斯变量 $\\mathbf{z}_1$ 和 $\\mathbf{z}_2$，其联合分布为\n$$\np(\\mathbf{z}_1, \\mathbf{z}_2) = \\mathcal{N}\\left( \\begin{pmatrix} \\mu_1 \\\\ \\mu_2 \\end{pmatrix}, \\begin{pmatrix} \\Sigma_{11}  \\Sigma_{12} \\\\ \\Sigma_{21}  \\Sigma_{22} \\end{pmatrix} \\right)\n$$\n条件分布 $p(\\mathbf{z}_1 | \\mathbf{z}_2)$ 也是高斯的，其协方差由Schur补给出：\n$$\n\\Sigma_{1|2} = \\Sigma_{11} - \\Sigma_{12} \\Sigma_{22}^{-1} \\Sigma_{21}\n$$\n我们识别 $\\mathbf{z}_1 = x_k$ 和 $\\mathbf{z}_2 = y_k$。我们需要找到联合协方差矩阵 $\\text{Cov}(x_k, y_k)$ 的分块。\n- $\\Sigma_{11} = \\operatorname{Cov}(x_k, x_k) = P_k^-$。\n- $\\Sigma_{12} = \\operatorname{Cov}(x_k, y_k) = \\operatorname{Cov}(x_k, H x_k + v_k) = \\operatorname{Cov}(x_k, H x_k) + \\operatorname{Cov}(x_k, v_k)$。由于状态噪声和观测噪声不相关，$\\operatorname{Cov}(x_k, v_k) = 0$。因此，$\\Sigma_{12} = P_k^- H^\\top$。\n- $\\Sigma_{21} = \\operatorname{Cov}(y_k, x_k) = (P_k^- H^\\top)^\\top = H P_k^-$。\n- $\\Sigma_{22} = \\operatorname{Cov}(y_k, y_k) = \\operatorname{Cov}(H x_k + v_k, H x_k + v_k) = H P_k^- H^\\top + R$。这是新息协方差，$S_k$。\n\n将这些代入条件协方差公式，得到后验协方差 $P_k^+$：\n$$\nP_k^+ = P_k^- - (P_k^- H^\\top) (H P_k^- H^\\top + R)^{-1} (H P_k^-)\n$$\n使用新息协方差 $S_k = H P_k^- H^\\top + R$ 和卡尔曼增益 $K_k = P_k^- H^\\top S_k^{-1}$ 的定义，我们可以将其重写为：\n$$\nP_k^+ = P_k^- - K_k S_k K_k^\\top = P_k^- - P_k^- H^\\top S_k^{-1} H P_k^-\n$$\n这是后验协方差更新的标准对称形式。由于 $P_k^-$ 是对称半正定的（PSD），且 $H P_k^- H^\\top + R$ 是正定的（因为 $R0$），因此得到的 $P_k^+$ 也是对称的。\n\n**2. Joseph形式的等价性与稳定性**\n\n问题提供了两种关键的更新公式：\n1. $P_k^{+,\\mathrm{simp}} = P_k^- - K_k H P_k^-$\n2. $P_k^{+,\\mathrm{Joseph}} = (I - K_k H) P_k^- (I - K_k H)^\\top + K_k R K_k^\\top$\n\n我们首先在精确算术中建立它们的数学等价性。通过代入 $K_k = P_k^- H^\\top S_k^{-1}$，“简化”更新变为：\n$$\nP_k^{+,\\mathrm{simp}} = P_k^- - (P_k^- H^\\top S_k^{-1}) H P_k^- = P_k^- - P_k^- H^\\top S_k^{-1} H P_k^-\n$$\n这与从第一性原理推导出的对称形式完全相同。\n\n现在，让我们展开Joseph形式：\n$$\n\\begin{align*}\nP_k^{+,\\mathrm{Joseph}} = (P_k^- - K_k H P_k^-)(I - H^\\top K_k^\\top) + K_k R K_k^\\top \\\\\n= P_k^- - K_k H P_k^- - P_k^- H^\\top K_k^\\top + K_k H P_k^- H^\\top K_k^\\top + K_k R K_k^\\top \\\\\n= P_k^- - K_k H P_k^- - P_k^- H^\\top K_k^\\top + K_k (H P_k^- H^\\top + R) K_k^\\top \\\\\n= P_k^- - K_k H P_k^- - P_k^- H^\\top K_k^\\top + K_k S_k K_k^\\top\n\\end{align*}\n$$\n由于 $P_k^-$ 是对称的，$S_k$ 是标量，所以 $K_k = P_k^- H^\\top S_k^{-1}$ 意味着 $P_k^- H^\\top = K_k S_k$。取转置得到 $H P_k^- = S_k K_k^\\top$。\n将 $P_k^- H^\\top K_k^\\top = (K_k S_k) K_k^\\top$ 和展开式中的 $K_k S_k K_k^\\top$ 代入，似乎无法直接化简。一种更可靠的方法是代入 $K_k$：\n$$\n\\begin{align*}\nP_k^{+,\\mathrm{Joseph}} = P_k^- - (P_k^- H^\\top S_k^{-1}) H P_k^- - P_k^- H^\\top (S_k^{-1} H P_k^-) + (P_k^- H^\\top S_k^{-1}) S_k (S_k^{-1} H P_k^-) \\\\\n= P_k^- - P_k^- H^\\top S_k^{-1} H P_k^- - P_k^- H^\\top S_k^{-1} H P_k^- + P_k^- H^\\top S_k^{-1} H P_k^- \\\\\n= P_k^- - P_k^- H^\\top S_k^{-1} H P_k^-\n\\end{align*}\n$$\n这证实了 $P_k^{+,\\mathrm{simp}}$ 和 $P_k^{+,\\mathrm{Joseph}}$ 在数学上是等价的。关键区别在于它们的数值实现。简化形式 $P_k^+ = P_k^- - M$ 涉及矩阵减法。如果 $P_k^-$ 是病态的（即条件数非常大），并且更新项 $M = K_k H P_k^-$ 的量级与 $P_k^-$ 相似，有限精度算术中的相减抵消可能导致对称性的丧失，以及更严重的，半正定性的丧失。得到的矩阵可能具有负特征值，这对于协方差矩阵来说在统计上是无意义的。\n\nJoseph形式，$P_k^+ = A P_k^- A^\\top + B R B^\\top$（其中 $A = I - K_k H$，$B = K_k$），的结构是两个PSD矩阵之和。如果 $P_k^-$ 是PSD，则项 $(I - K_k H) P_k^- (I - K_k H)^\\top$ 保证是PSD；项 $K_k R K_k^\\top$ 保证是PSD，因为 $R  0$。两个PSD矩阵之和总是PSD。这种公式固有地防止了半正定性的丧失，使其在数值上是“稳定的”。\n\n**3. 平方根协方差更新**\n\n平方根更新是另一种数值鲁棒的方法。它利用了对称更新方程：\n$$\nP_k^+ = P_k^- - P_k^- H^\\top S_k^{-1} H P_k^-\n$$\n对于标量观测，$S_k$ 是一个标量。我们可以将更新项写成一个向量的外积：\n$$\nP_k^+ = P_k^- - \\left(\\frac{P_k^- H^\\top}{\\sqrt{S_k}}\\right) \\left(\\frac{P_k^- H^\\top}{\\sqrt{S_k}}\\right)^\\top = P_k^- - w_k w_k^\\top\n$$\n其中 $w_k = P_k^- H^\\top / \\sqrt{S_k}$。问题就变成了为 $P_k^+$ 找到一个Cholesky因子 $R_k^+$。给定先验 $P_k^- = R_k^\\top R_k$ 的上三角Cholesky因子 $R_k$，更新 $P_k^+ = R_k^\\top R_k - w_k w_k^\\top$ 是一个一阶降阶更新。专用算法，通常使用像Givens旋转这样的正交变换，可以直接从 $R_k$ 和 $w_k$ 计算 $R_k^+$。这避免了构建完整的协方差矩阵并执行减法，通过构造保持了数值精度和PSD属性。对于此问题，我们将计算降阶更新的结果 $P_k^{+,\\mathrm{sqrt}} = P_k^- - w_k w_k^\\top$，以评估其属性。与Joseph形式一样，这种形式在数值上优于简单的减法形式。\n\n所提供的测试案例旨在突出这些差异。案例1是良态的，所有方法的结果应该一致。案例2和3使用病态的先验协方差和一个对先验最不确定方向高度敏感的观测模型，这创造了简化更新预期会失败的确切条件，尤其是在重复更新的情况下。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigvalsh\n\ndef solve():\n    \"\"\"\n    Implements and compares three Kalman filter covariance update strategies.\n    The problem specifies F=I and Q=0, meaning for assimilation cycles,\n    the posterior covariance from step k becomes the prior for step k+1.\n    \"\"\"\n    test_cases = [\n        {\n            \"P0_minus\": np.array([[1.0, 0.2], [0.2, 1.0]]),\n            \"H\": np.array([[1.0, 0.5]]),\n            \"R\": 0.1,\n            \"n_cycles\": 1,\n        },\n        {\n            \"P0_minus\": np.array([[1.0, 0.999999], [0.999999, 1.0]]),\n            \"H\": np.array([[1.0, -1.0]]),\n            \"R\": 1e-12,\n            \"n_cycles\": 1,\n        },\n        {\n            \"P0_minus\": np.array([[1.0, 0.999999], [0.999999, 1.0]]),\n            \"H\": np.array([[1.0, -1.0]]),\n            \"R\": 1e-15,\n            \"n_cycles\": 3,\n        },\n    ]\n\n    all_results = []\n    \n    # Tolerance for checking positive semidefiniteness.\n    psd_tolerance = 1e-12\n\n    for case in test_cases:\n        H = case[\"H\"]\n        R = case[\"R\"]\n        n_cycles = case[\"n_cycles\"]\n\n        # Initialize covariances for each method\n        P_simp = case[\"P0_minus\"].copy()\n        P_joseph = case[\"P0_minus\"].copy()\n        P_sqrt = case[\"P0_minus\"].copy()\n        \n        for _ in range(n_cycles):\n            # The posterior from the previous step is the prior for the current step.\n            P_minus_simp = P_simp\n            P_minus_joseph = P_joseph\n            P_minus_sqrt = P_sqrt\n\n            # Calculations are based on the Joseph form's prior, as it's the stable one.\n            # In exact math, all priors are the same at each step, but numerically they may diverge.\n            # For a fair comparison of one update step, we must use the same prior for all.\n            # Here, we use the prior from each method's own evolution.\n            \n            # --- Simplified Method ---\n            S_simp = (H @ P_minus_simp @ H.T + R)[0, 0]\n            if S_simp > 0:\n                K_simp = P_minus_simp @ H.T / S_simp\n                P_simp = P_minus_simp - K_simp @ H @ P_minus_simp\n            else: # Diverged\n                P_simp = np.full_like(P_simp, np.nan)\n\n            # --- Joseph Method ---\n            S_joseph = (H @ P_minus_joseph @ H.T + R)[0, 0]\n            if S_joseph > 0:\n                K_joseph = P_minus_joseph @ H.T / S_joseph\n                I = np.identity(P_minus_joseph.shape[0])\n                I_KH = I - K_joseph @ H\n                # K_joseph is 2x1, R is scalar. K @ K.T is outer product.\n                P_joseph = I_KH @ P_minus_joseph @ I_KH.T + (K_joseph @ K_joseph.T) * R\n            else: # Diverged\n                P_joseph = np.full_like(P_joseph, np.nan)\n                \n            # --- Square-Root Method ---\n            S_sqrt = (H @ P_minus_sqrt @ H.T + R)[0, 0]\n            if S_sqrt > 0:\n                # w = P_k^- H^T / sqrt(S_k)\n                w = P_minus_sqrt @ H.T / np.sqrt(S_sqrt)\n                # P_k^+ = P_k^- - w w^T\n                P_sqrt = P_minus_sqrt - w @ w.T\n            else: # Diverged\n                P_sqrt = np.full_like(P_sqrt, np.nan)\n\n        # After all cycles, analyze the final posterior matrices\n        results_case = []\n        matrices = [P_simp, P_joseph, P_sqrt]\n        \n        # Calculate minimum eigenvalues\n        min_eigs = []\n        for P in matrices:\n            if np.any(np.isnan(P)):\n                min_eigs.append(np.nan)\n            else:\n                # Use eigvalsh as matrices should be symmetric\n                min_eigs.append(np.min(eigvalsh(P)))\n        results_case.extend(min_eigs)\n\n        # Check for positive semidefiniteness\n        is_psd = [eig >= -psd_tolerance for eig in min_eigs]\n        results_case.extend(is_psd)\n        \n        # Check if next-step innovation variance is positive\n        innovation_positive = []\n        for P in matrices:\n            if np.any(np.isnan(P)):\n                innovation_positive.append(False)\n            else:\n                S_next = (H @ P @ H.T + R)[0, 0]\n                innovation_positive.append(S_next > 0)\n        results_case.extend(innovation_positive)\n        \n        all_results.append(results_case)\n\n    # Format the final output string\n    # e.g., [[-0.1,0.2,True,False],[...]]\n    outer_list = []\n    for res_list in all_results:\n        # Format each item within the inner list\n        str_items = [f\"{item:.16e}\" if isinstance(item, float) else str(item) for item in res_list]\n        outer_list.append(f\"[{','.join(str_items)}]\")\n    \n    final_output = f\"[{','.join(outer_list)}]\"\n    print(final_output)\n\n\nsolve()\n```"
        },
        {
            "introduction": "集合卡尔曼滤波 (EnKF) 的一个核心挑战是集合倾向于变得离散度不足 (under-dispersive)，从而导致滤波器发散。本练习介绍了协方差膨胀这一关键技术，它被用来解决此问题并维持滤波器的稳定性。您将使用新息统计量和卡方 ($\\chi^2$) 检验来定量地诊断滤波器的不一致性，并确定恢复集合预报与观测之间统计平衡所需的最小膨胀因子。",
            "id": "3605744",
            "problem": "一项地震走时反演采用集成卡尔曼滤波器 (EnKF) 来同化跨孔观测数据。在每个同化时刻，预报状态通过观测算子 $H$ 线性映射到观测空间，新息向量定义为 $d = y - H x^{f}$，其中 $y$ 是观测走时，$x^{f}$ 是预报状态。测量误差被建模为均值为零、协方差矩阵为 $R$ 的高斯分布，预报集合的离散度在观测空间中导出的预报误差协方差由 $C_{f} = H P_{f} H^{\\top}$ 给出，其中 $P_{f}$ 是由集合产生的预报状态误差协方差。假设模型为线性高斯模型，各同化时刻之间相互独立，并且在这些假设下，标准的马氏距离诊断是有效的。\n\n为了校正离散度不足的集合，将一个乘性膨胀因子 $\\lambda \\geq 1$ 应用于集合预报协方差，使得膨胀后的预报协方差变为 $\\lambda P_{f}$，相应的观测空间预报协方差变为 $\\lambda C_{f}$。考虑在 $T = 5$ 个连续同化时刻收集的 $m = 2$ 个观测分量。测量误差协方差为 $R = r I_{2}$，其中 $r = 0.1$；投影到观测空间的预报集合离散度是各向同性的，其协方差为 $C_{f} = s I_{2}$，其中 $s = 0.4$。这五个时刻的新息向量为\n$$\nd_{1} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\\quad\nd_{2} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix},\\quad\nd_{3} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix},\\quad\nd_{4} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix},\\quad\nd_{5} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n使用显著性水平为 $\\alpha = 0.05$ 的卡方检验对聚合新息一致性诊断进行分析，确定最小的膨胀因子 $\\lambda$，使得新息的聚合马氏距离与线性高斯假设所蕴含的 $\\chi^{2}$ 分布一致。将 $\\lambda$ 的最终答案表示为单个实数，并四舍五入到四位有效数字。无需单位。",
            "solution": "首先验证问题，以确保其科学上合理、内容自洽且适定。\n\n**步骤 1：提取已知条件**\n- **方法：**用于地震走时反演的集成卡尔曼滤波器 (EnKF)。\n- **新息向量：**$d = y - H x^{f}$。\n- **测量误差协方差：**$R$，误差为零均值高斯分布。\n- **观测空间预报误差协方差：**$C_{f} = H P_{f} H^{\\top}$。\n- **假设：**线性高斯模型，各同化时刻之间独立。\n- **膨胀因子：**$\\lambda \\geq 1$。\n- **膨胀后的观测空间预报协方差：**$\\lambda C_{f}$。\n- **观测分量数：**$m = 2$。\n- **同化时刻数：**$T = 5$。\n- **测量误差协方差矩阵：**$R = r I_{2}$，其中 $r = 0.1$。\n- **观测空间预报协方差矩阵：**$C_{f} = s I_{2}$，其中 $s = 0.4$。\n- **新息向量：**$d_{1} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, $d_{2} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$, $d_{3} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$, $d_{4} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$, $d_{5} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n- **统计检验：**对聚合新息一致性进行卡方检验。\n- **显著性水平：**$\\alpha = 0.05$。\n- **目标：**为保证一致性，求最小的 $\\lambda$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上基于数据同化和卡尔曼滤波理论，这些是计算地球物理学中的标准工具。使用膨胀因子校正离散度不足的集合，以及对新息统计量（马氏距离）应用 $\\chi^2$ 检验，这些都是标准的诊断程序。该问题是适定的，提供了所有必要的数值和一个明确的目标。语言精确且客观。该问题未违反任何无效标准。\n\n**步骤 3：结论与行动**\n问题有效。将推导解答。\n\n**解题推导**\n在线性高斯模型的假设下，任何给定同化时刻的新息向量 $d$ 是一个零均值的高斯随机变量。其协方差矩阵记为 $S$，是观测空间中的预报误差协方差与测量误差协方差之和。当将乘性膨胀因子 $\\lambda$ 应用于预报误差协方差 $P_f$ 时，相应的观测空间协方差变为 $\\lambda C_f$。因此，新息的理论协方差为：\n$$\nS_{\\lambda} = \\lambda C_{f} + R\n$$\n问题给出 $C_{f} = s I_{2}$ 和 $R = r I_{2}$，其中 $s = 0.4$，$r = 0.1$，且 $I_{2}$ 是 $2 \\times 2$ 的单位矩阵。将这些值代入 $S_{\\lambda}$ 的表达式中，得到：\n$$\nS_{\\lambda} = \\lambda (s I_{2}) + r I_{2} = (\\lambda s + r) I_{2}\n$$\n诊断检验基于新息的马氏距离平方。对于时刻 $k$ 的单个新息向量 $d_k$，其马氏距离平方由下式给出：\n$$\n\\delta_k^2 = d_k^{\\top} S_{\\lambda}^{-1} d_k\n$$\n在新息与协方差 $S_{\\lambda}$ 一致的零假设下，每个 $\\delta_k^2$ 服从自由度为 $m$ 的卡方分布，其中 $m=2$ 是观测向量的维度。\n\n问题要求对 $T=5$ 个同化时刻进行聚合诊断。由于假设新息是独立的，它们的马氏距离平方之和构成了聚合检验统计量 $\\Delta^2$：\n$$\n\\Delta^2 = \\sum_{k=1}^{T} \\delta_k^2 = \\sum_{k=1}^{T} d_k^{\\top} S_{\\lambda}^{-1} d_k\n$$\n这个聚合统计量 $\\Delta^2$ 服从自由度为 $N = T \\times m$ 的卡方分布。这里，$T=5$ 且 $m=2$，所以 $N = 10$。\n\n新息协方差矩阵的逆矩阵是：\n$$\nS_{\\lambda}^{-1} = \\frac{1}{\\lambda s + r} I_{2}\n$$\n将此代入 $\\Delta^2$ 的表达式中：\n$$\n\\Delta^2 = \\sum_{k=1}^{T} d_k^{\\top} \\left(\\frac{1}{\\lambda s + r} I_{2}\\right) d_k = \\frac{1}{\\lambda s + r} \\sum_{k=1}^{T} (d_k^{\\top} d_k)\n$$\n项 $d_k^{\\top} d_k$ 是向量 $d_k$ 的欧几里得范数的平方。我们为给定的 $T=5$ 个新息向量中的每一个计算该值：\n$d_1^{\\top} d_1 = 1^2 + 1^2 = 2$\n$d_2^{\\top} d_2 = 1^2 + (-1)^2 = 2$\n$d_3^{\\top} d_3 = (-1)^2 + 1^2 = 2$\n$d_4^{\\top} d_4 = (-1)^2 + (-1)^2 = 2$\n$d_5^{\\top} d_5 = 1^2 + 1^2 = 2$\n\n这些范数平方的和为：\n$$\n\\sum_{k=1}^{5} (d_k^{\\top} d_k) = 2 + 2 + 2 + 2 + 2 = 10\n$$\n因此，聚合检验统计量变为：\n$$\n\\Delta^2 = \\frac{10}{\\lambda s + r}\n$$\n为了在显著性水平 $\\alpha = 0.05$ 下认为新息与模型一致，观测到的检验统计量 $\\Delta^2$ 不得超过 $\\chi^2_{10}$ 分布的临界值。这个临界值 $\\chi^2_{\\text{crit}}$ 是对应于 $\\alpha$ 的上尾分位数，即满足 $P(\\chi^2_{10}  \\chi^2_{\\text{crit}}) = 0.05$ 的值。这是 $\\chi^2_{10}$ 分布的 $1-\\alpha = 0.95$ 分位数。从标准统计表或函数中，可以查得该值为：\n$$\n\\chi^2_{10, 0.95} \\approx 18.30704\n$$\n我们正在寻找使聚合马氏距离保持一致的最小膨胀因子 $\\lambda \\geq 1$。一致性条件是 $\\Delta^2 \\leq \\chi^2_{\\text{crit}}$。由于 $\\Delta^2$ 是 $\\lambda$ 的递减函数，满足此条件的最小 $\\lambda$ 值可以通过将 $\\Delta^2$ 设置为等于临界值来找到：\n$$\n\\frac{10}{\\lambda s + r} = \\chi^2_{10, 0.95}\n$$\n代入已知值 $s=0.4$ 和 $r=0.1$：\n$$\n\\frac{10}{0.4\\lambda + 0.1} = 18.30704\n$$\n现在，我们求解 $\\lambda$：\n$$\n0.4\\lambda + 0.1 = \\frac{10}{18.30704}\n$$\n$$\n0.4\\lambda = \\frac{10}{18.30704} - 0.1\n$$\n$$\n\\lambda = \\frac{1}{0.4} \\left( \\frac{10}{18.30704} - 0.1 \\right)\n$$\n$$\n\\lambda = 2.5 \\left( \\frac{10}{18.30704} - 0.1 \\right)\n$$\n对表达式进行数值计算：\n$$\n\\lambda \\approx 2.5 (0.546225 - 0.1) = 2.5(0.446225) = 1.1155625\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\lambda \\approx 1.116\n$$\n该值大于 $1$，与问题约束条件 $\\lambda \\geq 1$ 一致。",
            "answer": "$$\\boxed{1.116}$$"
        }
    ]
}