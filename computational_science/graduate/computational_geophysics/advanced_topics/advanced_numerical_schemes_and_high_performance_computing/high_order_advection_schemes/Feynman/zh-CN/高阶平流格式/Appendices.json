{
    "hands_on_practices": [
        {
            "introduction": "数值格式并非凭空出现的公式，而是建立在基本原理之上。本练习将引导您从第一性原理出发，推导著名的Lax-Friedrichs格式 。通过这个过程，您将更深刻地理解物理通量的一致性和数值稳定性的需求是如何被编码到格式的数学结构中的，这对于构建和理解其他更复杂的格式至关重要。",
            "id": "3603380",
            "problem": "考虑均匀介质中被动示踪剂的一维线性平流方程，\n$$\n\\partial_t u(x,t) + a \\,\\partial_x u(x,t) = 0,\n$$\n其波速为常数 $a \\in \\mathbb{R}$。设在均匀网格上定义一个有限体积离散，其网格中心为 $x_j = j\\,\\Delta x$，时间层为 $t^n = n\\,\\Delta t$，其中 $u_j^n$ 表示在时间层 $n$ 上对网格 $j$ 内 $u(x,t)$ 的网格平均近似值。一个守恒更新具有一般的通量差分形式\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{j+1/2}^n - F_{j-1/2}^n\\right),\n$$\n其中 $F_{j+1/2}^n$ 是在界面 $x_{j+1/2}$ 处对物理通量 $f(u) = a\\,u$ 的一个一致的数值近似。\n\n对一个双网格界面数值通量 $F_{j+1/2}^n = \\Phi\\!\\left(u_j^n,u_{j+1}^n\\right)$ 施加以下第一性原理要求：\n- 与物理通量的一致性：对于任意常数状态 $u$，有 $\\Phi(u,u) = f(u) = a\\,u$。\n- 对其参数具有与线性平流定律相适应的线性，并且在没有迎风偏置的情况下，中心输运分量具有对称性。\n- 通过一个与跳跃 $u_{j+1}^n - u_j^n$ 成正比的耗散项进行稳定，使得在零平流极限 $a = 0$ 时，单步更新简化为对相邻值的算术平均，即，\n$$\nu_j^{n+1} = \\frac{u_{j-1}^n + u_{j+1}^n}{2}.\n$$\n\n在这些要求下，确定 Lax–Friedrichs 数值通量 $F_{j+1/2}^n$ 关于 $a$、$\\Delta x$、$\\Delta t$、$u_j^n$ 和 $u_{j+1}^n$ 的闭式解析表达式。你的最终答案必须是 $F_{j+1/2}^n$ 的单个解析表达式。不需要进行数值计算，也无需四舍五入。结果表示中不含单位。",
            "solution": "该问题陈述已经过严格评估，并被认为是有效的。它具有科学依据、适定、客观且内部一致。它提出了一套清晰的公理化要求，可以从中严格推导出特定的数学形式，即 Lax-Friedrichs 数值通量。该问题是偏微分方程数值方法研究中的一个标准练习。\n\n目标是确定一维线性平流方程的数值通量 $F_{j+1/2}^n = \\Phi(u_j^n, u_{j+1}^n)$ 的解析表达式，\n$$\n\\partial_t u + a \\partial_x u = 0.\n$$\n推导将基于所提供的有限体积更新格式和一套三个第一性原理要求。一般的守恒更新由下式给出：\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{j+1/2}^n - F_{j-1/2}^n\\right).\n$$\n这些要求表明，数值通量 $F_{j+1/2}^n$ 可以分解为一个平流（或输运）分量和一个耗散（或稳定）分量。\n\n我们将通量表示为 $F_{j+1/2}^n = F_{\\text{adv}} + F_{\\text{diss}}$。\n\n第二个要求指明了“对其参数的线性……以及在没有迎风偏置的情况下中心输运分量的对称性”。物理通量为 $f(u) = a\\,u$。基于相邻网格中的值 $u_j^n$ 和 $u_{j+1}^n$，在网格界面 $x_{j+1/2}$ 处对通量的最自然、对称且线性的近似是在这些网格中心处计算的物理通量的算术平均值。这定义了中心平流分量：\n$$\nF_{\\text{adv}} = \\frac{f(u_j^n) + f(u_{j+1}^n)}{2} = \\frac{a\\,u_j^n + a\\,u_{j+1}^n}{2} = \\frac{a}{2}(u_j^n + u_{j+1}^n).\n$$\n该分量负责近似偏微分方程的平流部分。\n\n第三个要求规定了稳定项的形式。它必须“与跳跃 $u_{j+1}^n - u_j^n$ 成正比”。因此，我们可以将耗散分量写为：\n$$\nF_{\\text{diss}} = K(u_{j+1}^n - u_j^n),\n$$\n其中 $K$ 是我们必须确定的比例常数。第三个要求进一步提供了找到 $K$ 的条件：在零平流极限 ($a=0$) 下，更新格式必须简化为一个简单的扩散过程，具体为 $u_j^{n+1} = \\frac{1}{2}(u_{j-1}^n + u_{j+1}^n)$。\n\n在极限 $a=0$ 时，平流分量 $F_{\\text{adv}}$ 消失。总通量变为纯耗散通量：$F_{j+1/2}^n|_{a=0} = F_{\\text{diss}} = K(u_{j+1}^n - u_j^n)$。将其代入一般的守恒更新公式得到：\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\left( F_{\\text{diss}, j+1/2} - F_{\\text{diss}, j-1/2} \\right).\n$$\n将 $F_{\\text{diss}}$ 的表达式用网格值代入：\n$$\nF_{\\text{diss}, j+1/2} - F_{\\text{diss}, j-1/2} = K(u_{j+1}^n - u_j^n) - K(u_{j}^n - u_{j-1}^n) = K(u_{j+1}^n - 2u_j^n + u_{j-1}^n).\n$$\n因此，对于 $a=0$ 的更新格式变为：\n$$\nu_j^{n+1} = u_j^n - K \\frac{\\Delta t}{\\Delta x} (u_{j+1}^n - 2u_j^n + u_{j-1}^n).\n$$\n现在，我们将其与问题陈述中对 $a=0$ 所要求的形式等同起来：\n$$\nu_j^{n+1} = \\frac{u_{j-1}^n + u_{j+1}^n}{2}.\n$$\n为了便于比较，我们可以通过加上和减去 $u_j^n$ 来重写这个要求的形式：\n$$\nu_j^{n+1} = u_j^n + \\frac{u_{j-1}^n + u_{j+1}^n}{2} - u_j^n = u_j^n + \\frac{u_{j-1}^n - 2u_j^n + u_{j+1}^n}{2}.\n$$\n比较 $u_j^{n+1}$ 的两个表达式，我们可以看到包含二阶差分的项必须相等：\n$$\n-K \\frac{\\Delta t}{\\Delta x} (u_{j+1}^n - 2u_j^n + u_{j-1}^n) = \\frac{1}{2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n).\n$$\n这意味着系数必须相等：\n$$\n-K \\frac{\\Delta t}{\\Delta x} = \\frac{1}{2}.\n$$\n求解比例常数 $K$：\n$$\nK = -\\frac{\\Delta x}{2\\Delta t}.\n$$\n因此，耗散通量分量是：\n$$\nF_{\\text{diss}} = -\\frac{\\Delta x}{2\\Delta t}(u_{j+1}^n - u_j^n).\n$$\n将平流分量和耗散分量结合起来，得到 Lax-Friedrichs 格式的完整数值通量：\n$$\nF_{j+1/2}^n = F_{\\text{adv}} + F_{\\text{diss}} = \\frac{a}{2}(u_j^n + u_{j+1}^n) - \\frac{\\Delta x}{2\\Delta t}(u_{j+1}^n - u_j^n).\n$$\n最后，我们验证该通量满足第一个要求：与物理通量的一致性。对于常数状态 $u_j^n = u_{j+1}^n = U$，我们有：\n$$\nF_{j+1/2}^n = \\frac{a}{2}(U + U) - \\frac{\\Delta x}{2\\Delta t}(U - U) = \\frac{a}{2}(2U) - 0 = aU.\n$$\n由于物理通量是 $f(U) = aU$，一致性要求得到满足。所推导的表达式是在指定条件下 Lax-Friedrichs 数值通量的完整解析形式。",
            "answer": "$$\\boxed{\\frac{a}{2}(u_j^n + u_{j+1}^n) - \\frac{\\Delta x}{2\\Delta t}(u_{j+1}^n - u_j^n)}$$"
        },
        {
            "introduction": "构建一个数值格式后，我们必须评估其质量。局部截断误差是衡量精度的关键指标，它揭示了数值格式在多大程度上逼近了真实的偏微分方程 。本练习将分析更高阶的Lax-Wendroff格式，以确定其精度阶数和主导误差项的性质，从而解释该格式为何被认为是“色散的”，并深入了解其可能产生的振荡伪影。",
            "id": "3603413",
            "problem": "在一维空间中，考虑常系数线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a>0$ 为常数。设空间网格点为 $x_{j} = j\\,\\Delta x$，时间层为 $t_{n} = n\\,\\Delta t$，Courant数定义为 $\\nu = a\\,\\Delta t / \\Delta x$。两步Lax-Wendroff格式以其标准的单步守恒形式实现：\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\Big(u_{j+1}^{n} - u_{j-1}^{n}\\Big) \\;+\\; \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\Big(u_{j+1}^{n} - 2\\,u_{j}^{n} + u_{j-1}^{n}\\Big).\n$$\n定义局部截断误差 $\\tau_{j}^{n}$ 为\n$$\n\\tau_{j}^{n} \\;=\\; \\frac{1}{\\Delta t}\\,\\Big(u(x_{j},t_{n+1}) \\;-\\; \\Big[u_{j}^{n} \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\big(u_{j+1}^{n} - u_{j-1}^{n}\\big) \\;+\\; \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\big(u_{j+1}^{n} - 2\\,u_{j}^{n} + u_{j-1}^{n}\\big)\\Big]\\Big),\n$$\n其中 $u(x,t)$ 是该偏微分方程的精确解。从该偏微分方程和时空泰勒展开出发，并利用该偏微分方程消去时间导数，进行局部截断误差分析。证明 $\\tau_{j}^{n} = O(\\Delta t^{2}, \\Delta x^{2})$，并且当 $\\nu = O(1)$ 时，主色散项与 $\\Delta x^{2}\\,u_{xxx}$ 成正比。\n\n将最终答案写为 $\\tau_{j}^{n}$ 的主阶项中乘以 $\\Delta x^{2}\\,u_{xxx}$ 的系数 $C(a,\\nu)$，该系数由下式定义\n$$\n\\tau_{j}^{n} \\;=\\; C(a,\\nu)\\,\\Delta x^{2}\\,u_{xxx}(x_{j},t_{n}) \\;+\\; \\text{更高阶项}.\n$$\n你的最终答案必须是仅含 $a$ 和 $\\nu$ 的单个闭式解析表达式。不需要进行数值计算，也不需要单位。",
            "solution": "该问题是有效的，因为它是偏微分方程数值分析领域中一个适定且有科学依据的问题。所有必要信息都已提供，目标也已明确定义。\n\n局部截断误差 $\\tau_{j}^{n}$ 是通过将有限差分算子应用于偏微分方程（PDE）的精确解 $u(x,t)$ 来定义的。给出的定义为\n$$\n\\tau_{j}^{n} = \\frac{1}{\\Delta t} \\left( u(x_{j}, t_{n+1}) - \\left[ u(x_{j},t_{n}) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u(x_{j+1},t_{n}) - u(x_{j-1},t_{n})\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u(x_{j+1},t_{n}) - 2\\,u(x_j, t_n) + u(x_{j-1},t_{n})\\right) \\right] \\right)\n$$\n其中 $u(x,t)$ 是精确解，所有项都在指定的网格点上取值。为简单起见，我们将 $u(x_{j}, t_{n})$ 记为 $u$，并将所有其他项在点 $(x_{j}, t_{n})$ 附近进行泰勒级数展开。关于 $x$ 和 $t$ 的偏导数将用下标表示，例如 $u_{x} = \\frac{\\partial u}{\\partial x}$ 和 $u_{t} = \\frac{\\partial u}{\\partial t}$，所有这些都在 $(x_j, t_n)$ 点求值。\n\n首先，我们将精确解项 $u(x_{j}, t_{n+1})$ 在 $t_{n}$ 附近按时间进行泰勒级数展开：\n$$\nu(x_{j}, t_{n+1}) = u(x_{j}, t_{n} + \\Delta t) = u + \\Delta t \\, u_{t} + \\frac{\\Delta t^{2}}{2} \\, u_{tt} + \\frac{\\Delta t^{3}}{6} \\, u_{ttt} + O(\\Delta t^{4})\n$$\n控制偏微分方程为 $u_{t} + a\\,u_{x} = 0$，即 $u_{t} = -a\\,u_{x}$。我们可以通过对偏微分方程反复求导，并假设 $u(x,t)$ 足够光滑，从而用空间导数来表示高阶时间导数：\n$$\nu_{t} = -a \\, u_{x}\n$$\n$$\nu_{tt} = \\frac{\\partial}{\\partial t}(-a\\,u_{x}) = -a\\,u_{xt} = -a\\,\\frac{\\partial}{\\partial x}(u_{t}) = -a\\,\\frac{\\partial}{\\partial x}(-a\\,u_{x}) = a^{2}\\,u_{xx}\n$$\n$$\nu_{ttt} = \\frac{\\partial}{\\partial t}(a^{2}\\,u_{xx}) = a^{2}\\,u_{xxt} = a^{2}\\,\\frac{\\partial^{2}}{\\partial x^{2}}(u_{t}) = a^{2}\\,\\frac{\\partial^{2}}{\\partial x^{2}}(-a\\,u_{x}) = -a^{3}\\,u_{xxx}\n$$\n将这些代回到 $u(x_{j}, t_{n+1})$ 的展开式中，得到：\n$$\nu(x_{j}, t_{n+1}) = u - a\\,\\Delta t\\,u_{x} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} - \\frac{a^{3}\\,\\Delta t^{3}}{6}\\,u_{xxx} + O(\\Delta t^{4})\n$$\n\n接下来，我们分析误差表达式中的数值格式部分。我们需要 $u(x_{j\\pm 1}, t_{n})$ 在 $x_{j}$ 附近的空间泰勒级数展开：\n$$\nu(x_{j+1}, t_{n}) = u + \\Delta x\\,u_{x} + \\frac{\\Delta x^{2}}{2}\\,u_{xx} + \\frac{\\Delta x^{3}}{6}\\,u_{xxx} + \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} + O(\\Delta x^{5})\n$$\n$$\nu(x_{j-1}, t_{n}) = u - \\Delta x\\,u_{x} + \\frac{\\Delta x^{2}}{2}\\,u_{xx} - \\frac{\\Delta x^{3}}{6}\\,u_{xxx} + \\frac{\\Delta x^{4}}{24}\\,u_{xxxx} + O(\\Delta x^{5})\n$$\n数值格式中的各项可以用这些展开式表示：\n一阶导数的中心差分：\n$$\nu(x_{j+1},t_{n}) - u(x_{j-1},t_{n}) = 2\\,\\Delta x\\,u_{x} + \\frac{\\Delta x^{3}}{3}\\,u_{xxx} + O(\\Delta x^{5})\n$$\n二阶导数的中心差分：\n$$\nu(x_{j+1},t_{n}) - 2\\,u(x_{j},t_{n}) + u(x_{j-1},t_{n}) = \\Delta x^{2}\\,u_{xx} + \\frac{\\Delta x^{4}}{12}\\,u_{xxxx} + O(\\Delta x^{6})\n$$\n令 $L_{\\Delta t}(u)$ 表示作用于精确解的数值算子：\n$$\nL_{\\Delta t}(u) = u - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u(x_{j+1},t_{n}) - u(x_{j-1},t_{n})\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(u(x_{j+1},t_{n}) - 2\\,u(x_j, t_n) + u(x_{j-1},t_{n})\\right)\n$$\n代入空间展开式可得：\n$$\nL_{\\Delta t}(u) = u - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(2\\,\\Delta x\\,u_{x} + \\frac{\\Delta x^{3}}{3}\\,u_{xxx} + \\dots\\right) + \\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\left(\\Delta x^{2}\\,u_{xx} + \\frac{\\Delta x^{4}}{12}\\,u_{xxxx} + \\dots\\right)\n$$\n简化系数：\n$$\nL_{\\Delta t}(u) = u - a\\,\\Delta t\\,u_{x} - \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} + \\frac{a^{2}\\,\\Delta t^{2}\\,\\Delta x^{2}}{24}\\,u_{xxxx} + \\text{H.O.T.}\n$$\n其中 H.O.T. 代表高阶项。\n\n现在我们可以计算截断误差。根据定义，有 $\\Delta t\\,\\tau_{j}^{n} = u(x_{j}, t_{n+1}) - L_{\\Delta t}(u)$。\n$$\n\\Delta t\\,\\tau_{j}^{n} = \\left( u - a\\,\\Delta t\\,u_{x} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} - \\frac{a^{3}\\,\\Delta t^{3}}{6}\\,u_{xxx} + \\dots \\right) - \\left( u - a\\,\\Delta t\\,u_{x} + \\frac{a^{2}\\,\\Delta t^{2}}{2}\\,u_{xx} - \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6}\\,u_{xxx} + \\dots \\right)\n$$\n二阶及以下的项相互抵消，这对于一个二阶格式是符合预期的：\n$$\n\\Delta t\\,\\tau_{j}^{n} = \\left( - \\frac{a^{3}\\,\\Delta t^{3}}{6}\\,u_{xxx} \\right) - \\left( - \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6}\\,u_{xxx} \\right) + \\text{H.O.T.}\n$$\n$$\n\\Delta t\\,\\tau_{j}^{n} = \\left( \\frac{a\\,\\Delta t\\,\\Delta x^{2}}{6} - \\frac{a^{3}\\,\\Delta t^{3}}{6} \\right) u_{xxx} + \\text{H.O.T.}\n$$\n两边除以 $\\Delta t$ 以求得 $\\tau_{j}^{n}$：\n$$\n\\tau_{j}^{n} = \\left( \\frac{a\\,\\Delta x^{2}}{6} - \\frac{a^{3}\\,\\Delta t^{2}}{6} \\right) u_{xxx} + \\text{H.O.T.}\n$$\n这证实了该格式是形式上二阶精确的，即 $\\tau_{j}^{n} = O(\\Delta x^{2}, \\Delta t^{2})$，因为如果 $\\Delta t \\propto \\Delta x$，两项都是 $O(\\Delta x^2)$。主误差项与 $u_{xxx}$ 成正比，这是一个色散误差项。\n\n为了用 $a$ 和Courant数 $\\nu = a\\,\\Delta t/\\Delta x$ 来表示系数，我们从主项中提出因子 $\\frac{a\\,\\Delta x^{2}}{6}$：\n$$\n\\tau_{j}^{n} = \\frac{a\\,\\Delta x^{2}}{6} \\left( 1 - \\frac{a^{2}\\,\\Delta t^{2}}{\\Delta x^{2}} \\right) u_{xxx} + \\text{H.O.T.}\n$$\n注意到 $\\nu^{2} = (a\\,\\Delta t/\\Delta x)^{2} = a^{2}\\,\\Delta t^{2}/\\Delta x^{2}$，我们有：\n$$\n\\tau_{j}^{n} = \\frac{a\\,\\Delta x^{2}}{6} (1 - \\nu^{2}) u_{xxx} + \\text{H.O.T.}\n$$\n问题将主误差项定义为 $C(a,\\nu)\\,\\Delta x^{2}\\,u_{xxx}(x_{j},t_{n})$。通过将此形式与我们推导的表达式进行比较，我们可以确定系数 $C(a,\\nu)$：\n$$\nC(a,\\nu)\\,\\Delta x^{2}\\,u_{xxx} = \\frac{a}{6} (1 - \\nu^{2}) \\Delta x^{2}\\,u_{xxx}\n$$\n因此，该系数为：\n$$\nC(a,\\nu) = \\frac{a}{6}(1 - \\nu^{2})\n$$\n这就是所求的仅含 $a$ 和 $\\nu$ 的闭式解析表达式。当 $\\nu=1$ 时，误差为零，此时Lax-Wendroff格式对于常系数线性平流方程是精确的。",
            "answer": "$$\\boxed{\\frac{a}{6}(1 - \\nu^{2})}$$"
        },
        {
            "introduction": "在地球物理建模中，遵守物理守恒律至关重要，尤其是在速度等物理参数非恒定时，这直接关系到模拟的物理真实性。本练习探讨了守恒与非守恒数值格式之间的关键区别 。通过直接计算两种不同格式的总质量变化，您将亲眼目睹违反平流方程守恒形式所带来的实际后果，并理解为何通量形式的格式对于需要保持质量、能量或其他守恒量的模拟至关重要。",
            "id": "3603345",
            "problem": "考虑一个被动标量 $q(x,t)$ 在周期性区间上由空间变化的（或空间可变的）速度 $a(x)$ 进行的一维平流。物理上正确的守恒律是通量形式 $ \\partial_t q + \\partial_x(a(x)\\,q) = 0$，它表示了周期性区域上示踪物质量的守恒。在计算地球物理学中，守恒和非守恒的高阶平流格式都有使用；然而，当 $a(x)$ 变化时，只有守恒格式才能精确地保持离散质量。\n\n设区域是周期性的，$x \\in [0,2\\pi]$，用一个包含 $N$ 个点的均匀网格进行离散，网格间距为 $\\Delta x$，使得 $N\\,\\Delta x = 2\\pi$ 且对于整数 $j$，$x_j = j\\,\\Delta x$。初始示踪物为 $q(x,0) = \\sin(x)$，精确采样使得 $q_j^0 = \\sin(x_j)$，速度场为 $a(x) = 1 + \\epsilon \\cos(x)$，采样使得 $a_j = 1 + \\epsilon \\cos(x_j)$，其中 $\\epsilon$ 是一个小的无量纲振幅。\n\n将应用两种单步格式进行一个时间步长 $\\Delta t$ 的计算：\n- 一个针对守恒律 $ \\partial_t q + \\partial_x(a\\,q) = 0$ 的守恒局部Lax–Friedrichs（也称为Rusanov）通量形式格式，\n$$\nq_j^{1} = q_j^{0} - \\frac{\\Delta t}{\\Delta x}\\big(F_{j+1/2}^{0} - F_{j-1/2}^{0}\\big), \\quad F_{j+1/2}^{0} = \\frac{1}{2}\\big(a_j q_j^{0} + a_{j+1} q_{j+1}^{0}\\big) - \\frac{1}{2}\\,\\alpha_{j+1/2}\\big(q_{j+1}^{0} - q_j^{0}\\big),\n$$\n其中局部耗散为 $\\alpha_{j+1/2} = \\max\\{|a_j|,|a_{j+1}|\\}$。\n- 一个应用于平流形式 $ \\partial_t q + a(x)\\,\\partial_x q = 0$ 的非守恒二阶Lax–Wendroff格式，通过在时间上进行泰勒展开，同时忽略 $a(x)$ 的空间导数得到，\n$$\nq_j^{1} = q_j^{0} - \\Delta t\\, a_j\\,D_x q_j^{0} + \\frac{(\\Delta t)^2}{2}\\,a_j^{2}\\,D_{xx} q_j^{0},\n$$\n其中 $D_x q_j^{0} = \\frac{q_{j+1}^{0} - q_{j-1}^{0}}{2\\,\\Delta x}$ 和 $D_{xx} q_j^{0} = \\frac{q_{j+1}^{0} - 2 q_j^{0} + q_{j-1}^{0}}{\\Delta x^{2}}$ 分别是中心一阶和二阶差分。\n\n将在时间层 $n$ 的离散质量定义为 $M^{n} = \\Delta x \\sum_{j=0}^{N-1} q_j^{n}$。仅使用基本守恒律、区域的周期性以及网格上的精确离散代数，对给定的初始数据和速度，比较守恒和非守恒更新在一个时间步长 $\\Delta t$ 内的情况。推导由非守恒Lax–Wendroff更新在一个时间步长后产生的净离散质量变化的闭式解析表达式，\n$$\n\\Delta M_{\\text{noncons}} = M^{1} - M^{0},\n$$\n用 $\\epsilon$、$\\Delta t$ 和 $\\Delta x$ 来表示。你可以使用在网格上逐点成立的三角恒等式，但不要用积分代替求和。区域、示踪物和速度都是无量纲的，因此不适用任何物理单位。最终答案只需报告 $\\Delta M_{\\text{noncons}}$ 的单一表达式。无需四舍五入。",
            "solution": "该问题要求分析应用于周期性区域上一维平流方程的两种数值格式的离散质量守恒性。主要目标是推导非守恒Lax-Wendroff格式在一个时间步长后离散质量的变化表达式。\n\n首先，我们将给定时间层 $n$ 的离散质量定义为 $M^n = \\Delta x \\sum_{j=0}^{N-1} q_j^n$。一个时间步长后的质量变化为 $\\Delta M = M^1 - M^0$。\n\n我们先简要分析守恒的Lax-Friedrichs格式。其更新公式为 $q_j^1 = q_j^0 - \\frac{\\Delta t}{\\Delta x}(F_{j+1/2}^0 - F_{j-1/2}^0)$。总质量的变化为：\n$$\n\\Delta M_{\\text{cons}} = M^1 - M^0 = \\Delta x \\sum_{j=0}^{N-1} (q_j^1 - q_j^0) = \\Delta x \\sum_{j=0}^{N-1} \\left[ -\\frac{\\Delta t}{\\Delta x}(F_{j+1/2}^0 - F_{j-1/2}^0) \\right]\n$$\n$$\n\\Delta M_{\\text{cons}} = -\\Delta t \\sum_{j=0}^{N-1} (F_{j+1/2}^0 - F_{j-1/2}^0)\n$$\n这是一个在周期性区域上的伸缩求和。让我们写出各项：\n$$\n\\sum_{j=0}^{N-1} (F_{j+1/2}^0 - F_{j-1/2}^0) = (F_{1/2}^0 - F_{-1/2}^0) + (F_{3/2}^0 - F_{1/2}^0) + \\dots + (F_{N-1/2}^0 - F_{N-3/2}^0) + (F_{N+1/2}^0 - F_{N-1/2}^0)\n$$\n由于周期性，索引 $j+N$ 等价于索引 $j$。因此，$F_{N+1/2}^0 = F_{1/2}^0$ 且 $F_{-1/2}^0 = F_{N-1/2}^0$。该求和可伸缩为 $F_{N-1+1/2}^0 - F_{-1/2}^0 = F_{N-1/2}^0 - F_ {N-1/2}^0 = 0$。\n因此，$\\Delta M_{\\text{cons}} = 0$。守恒格式凭借其通量差分形式，在周期性区域上精确地保持离散质量，而与初始数据或速度场无关。这与守恒律 $\\partial_t q + \\partial_x(aq) = 0$ 的物理意义是一致的。\n\n现在，我们转向非守恒的Lax-Wendroff格式。其更新公式为：\n$$\nq_j^1 = q_j^0 - \\Delta t\\, a_j\\,D_x q_j^0 + \\frac{(\\Delta t)^2}{2}\\,a_j^2\\,D_{xx} q_j^0\n$$\n离散质量的变化为：\n$$\n\\Delta M_{\\text{noncons}} = M^1 - M^0 = \\Delta x \\sum_{j=0}^{N-1} (q_j^1 - q_j^0) = \\Delta x \\sum_{j=0}^{N-1} \\left( -\\Delta t\\, a_j\\,D_x q_j^0 + \\frac{(\\Delta t)^2}{2}\\,a_j^2\\,D_{xx} q_j^0 \\right)\n$$\n我们可以分别分析求和中的两项。关键是在周期性网格上使用分部求和性质。对于任意两个网格函数 $u_j$ 和 $v_j$：\n$$\n\\sum_{j=0}^{N-1} u_j (D_x v_j) = -\\sum_{j=0}^{N-1} (D_x u_j) v_j\n$$\n$$\n\\sum_{j=0}^{N-1} u_j (D_{xx} v_j) = \\sum_{j=0}^{N-1} (D_{xx} u_j) v_j\n$$\n将这些恒等式应用于 $\\Delta M_{\\text{noncons}}$ 的表达式，其中 $u=a_j$ 或 $u=a_j^2$ 且 $v=q_j^0$：\n$$\n\\Delta M_{\\text{noncons}} = \\Delta x \\left( -\\Delta t \\sum_{j=0}^{N-1} a_j D_x q_j^0 + \\frac{(\\Delta t)^2}{2} \\sum_{j=0}^{N-1} a_j^2 D_{xx} q_j^0 \\right)\n$$\n$$\n\\Delta M_{\\text{noncons}} = \\Delta x \\left( -\\Delta t \\left( -\\sum_{j=0}^{N-1} (D_x a_j) q_j^0 \\right) + \\frac{(\\Delta t)^2}{2} \\sum_{j=0}^{N-1} (D_{xx} a_j^2) q_j^0 \\right)\n$$\n$$\n\\Delta M_{\\text{noncons}} = \\Delta t \\Delta x \\sum_{j=0}^{N-1} (D_x a_j) q_j^0 + \\frac{(\\Delta t)^2 \\Delta x}{2} \\sum_{j=0}^{N-1} (D_{xx} a_j^2) q_j^0\n$$\n现在，我们必须计算 $a_j = 1 + \\epsilon \\cos(x_j)$ 和 $a_j^2$ 的离散导数，然后计算这些和。\n\n第一项需要 $D_x a_j$：\n$$\nD_x a_j = \\frac{a_{j+1} - a_{j-1}}{2\\Delta x} = \\frac{(1 + \\epsilon \\cos(x_{j+1})) - (1 + \\epsilon \\cos(x_{j-1}))}{2\\Delta x} = \\frac{\\epsilon}{2\\Delta x} (\\cos(x_j+\\Delta x) - \\cos(x_j-\\Delta x))\n$$\n使用恒等式 $\\cos(A) - \\cos(B) = -2\\sin(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$：\n$$\nD_x a_j = \\frac{\\epsilon}{2\\Delta x}(-2\\sin(x_j)\\sin(\\Delta x)) = -\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x} \\sin(x_j)\n$$\n第二项需要 $D_{xx} a_j^2$：\n$$\na_j^2 = (1 + \\epsilon\\cos(x_j))^2 = 1 + 2\\epsilon\\cos(x_j) + \\epsilon^2 \\cos^2(x_j) = 1 + 2\\epsilon\\cos(x_j) + \\frac{\\epsilon^2}{2}(1 + \\cos(2x_j))\n$$\n我们需要应用二阶差分算子 $D_{xx} f_j = \\frac{f_{j+1} - 2f_j + f_{j-1}}{(\\Delta x)^2}$。对于函数 $f_j = \\cos(kx_j)$：\n$$\nD_{xx}\\cos(kx_j) = \\frac{\\cos(k(x_j+\\Delta x)) - 2\\cos(kx_j) + \\cos(k(x_j-\\Delta x))}{(\\Delta x)^2} = \\frac{2\\cos(kx_j)\\cos(k\\Delta x) - 2\\cos(kx_j)}{(\\Delta x)^2} = \\frac{2\\cos(kx_j)(\\cos(k\\Delta x)-1)}{(\\Delta x)^2}\n$$\n使用恒等式 $\\cos(\\theta) - 1 = -2\\sin^2(\\theta/2)$：\n$$\nD_{xx}\\cos(kx_j) = \\frac{2\\cos(kx_j)(-2\\sin^2(k\\Delta x/2))}{(\\Delta x)^2} = -\\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2}\\cos(kx_j)\n$$\n将其应用于 $a_j^2$：\n$$\nD_{xx} a_j^2 = 2\\epsilon D_{xx}\\cos(x_j) + \\frac{\\epsilon^2}{2}D_{xx}\\cos(2x_j)\n$$\n$$\nD_{xx} a_j^2 = 2\\epsilon\\left(-\\frac{4\\sin^2(\\Delta x/2)}{(\\Delta x)^2}\\cos(x_j)\\right) + \\frac{\\epsilon^2}{2}\\left(-\\frac{4\\sin^2(2\\Delta x/2)}{(\\Delta x)^2}\\cos(2x_j)\\right)\n$$\n$$\nD_{xx} a_j^2 = -\\frac{8\\epsilon \\sin^2(\\Delta x/2)}{(\\Delta x)^2}\\cos(x_j) - \\frac{2\\epsilon^2 \\sin^2(\\Delta x)}{(\\Delta x)^2}\\cos(2x_j)\n$$\n现在将这些导数和 $q_j^0 = \\sin(x_j)$ 代入 $\\Delta M_{\\text{noncons}}$ 的表达式中：\n$$\n\\Delta M_{\\text{noncons}} = \\Delta t \\Delta x \\sum_{j=0}^{N-1} \\left(-\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x} \\sin(x_j)\\right) \\sin(x_j) + \\frac{(\\Delta t)^2 \\Delta x}{2} \\sum_{j=0}^{N-1} (D_{xx} a_j^2) \\sin(x_j)\n$$\n我们来分析这些求和。\n第一个求和项是：\n$$\n\\sum_{j=0}^{N-1} \\left(-\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x}\\right) \\sin^2(x_j) = -\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x} \\sum_{j=0}^{N-1} \\sin^2(x_j)\n$$\n第二个求和是：\n$$\n\\sum_{j=0}^{N-1} \\left(-\\frac{8\\epsilon \\sin^2(\\Delta x/2)}{(\\Delta x)^2}\\cos(x_j) - \\frac{2\\epsilon^2 \\sin^2(\\Delta x)}{(\\Delta x)^2}\\cos(2x_j)\\right) \\sin(x_j)\n$$\n$$\n= -\\frac{8\\epsilon \\sin^2(\\Delta x/2)}{(\\Delta x)^2} \\sum_{j=0}^{N-1} \\cos(x_j)\\sin(x_j) - \\frac{2\\epsilon^2 \\sin^2(\\Delta x)}{(\\Delta x)^2} \\sum_{j=0}^{N-1} \\cos(2x_j)\\sin(x_j)\n$$\n我们需要计算在 $j=0, \\dots, N-1$ 上的离散和 $\\sum \\sin^2(x_j)$、$\\sum \\cos(x_j)\\sin(x_j)$ 和 $\\sum \\cos(2x_j)\\sin(x_j)$。在均匀周期性网格 $x_j=j\\frac{2\\pi}{N}$ 上，对于整数 $k$ 不是 $N/2$ 或 $N$ 的倍数时，离散三角函数是正交的：$\\sum_{j=0}^{N-1}\\sin(kx_j)\\cos(lx_j) = 0$。\n和 $\\sum \\cos(x_j)\\sin(x_j) = \\frac{1}{2}\\sum\\sin(2x_j)$，当 $N>2$ 时为零。\n和 $\\sum \\cos(2x_j)\\sin(x_j) = \\frac{1}{2}\\sum(\\sin(3x_j)-\\sin(x_j))$，当 $N>3$ 时为零。\n因此，整个包含 $(\\Delta t)^2$ 的第二项为零。\n\n唯一非零的贡献来自包含 $\\sum \\sin^2(x_j)$ 的第一项：\n$$\n\\sum_{j=0}^{N-1} \\sin^2(x_j) = \\sum_{j=0}^{N-1} \\frac{1-\\cos(2x_j)}{2} = \\frac{1}{2}\\sum_{j=0}^{N-1} 1 - \\frac{1}{2}\\sum_{j=0}^{N-1}\\cos(2x_j)\n$$\n第一部分是 $N/2$。第二个和 $\\sum \\cos(2x_j)$ 在 $N>2$ 时为零。因此，$\\sum_{j=0}^{N-1} \\sin^2(x_j) = N/2$。\n\n将此结果代回 $\\Delta M_{\\text{noncons}}$ 的表达式中：\n$$\n\\Delta M_{\\text{noncons}} = \\Delta t \\Delta x \\left( -\\frac{\\epsilon \\sin(\\Delta x)}{\\Delta x} \\cdot \\frac{N}{2} \\right)\n$$\n$$\n\\Delta M_{\\text{noncons}} = -\\frac{\\Delta t \\epsilon \\sin(\\Delta x) N \\Delta x}{2 \\Delta x} = - \\frac{N\\Delta x}{2} \\epsilon \\Delta t \\frac{\\sin(\\Delta x)}{\\Delta x}\n$$\n使用给定的关系 $N\\Delta x = 2\\pi$：\n$$\n\\Delta M_{\\text{noncons}} = - \\frac{2\\pi}{2} \\epsilon \\Delta t \\frac{\\sin(\\Delta x)}{\\Delta x} = -\\pi \\epsilon \\Delta t \\frac{\\sin(\\Delta x)}{\\Delta x}\n$$\n这就是离散质量净变化的最终闭式表达式。这种非守恒性之所以产生，是因为平流形式 $\\partial_t q + a \\partial_x q = 0$ 仅在包含源项 $-q \\partial_x a$ 时才等价于真正的守恒律 $\\partial_t q + \\partial_x(aq) = 0$。应用于非守恒形式的Lax-Wendroff格式没有考虑这一项，导致了与 $\\epsilon$（速度变化的幅度）和 $\\Delta t$ 成正比的虚假质量变化。",
            "answer": "$$\\boxed{-\\pi \\epsilon \\Delta t \\frac{\\sin(\\Delta x)}{\\Delta x}}$$"
        }
    ]
}