{
    "hands_on_practices": [
        {
            "introduction": "The efficiency of the finite element method hinges on a powerful concept: performing calculations on a simple, standardized \"reference element\" and then mapping the results to the actual geometric elements of the mesh. This practice solidifies this fundamental workflow. You will construct the core building blocks of a spectral element simulation—the mass and stiffness matrices—on a reference domain and then derive the scaling laws that govern their transformation to a physical element, revealing a key insight about the operator's structure. ",
            "id": "3594501",
            "problem": "Consider the one-dimensional acoustic wave equation $u_{tt} = c^{2} u_{xx}$ posed on a single physical element $\\Omega_{e} = [x_{a}, x_{b}]$ of length $L = x_{b} - x_{a}$, and its standard weak form obtained by multiplying by a test function $v$ and integrating over $\\Omega_{e}$. Using the Spectral Element Method (SEM) with polynomial degree $N=4$ on the reference element $\\hat{\\Omega} = [-1,1]$, construct the element-level mass and stiffness matrices on $\\hat{\\Omega}$ and then map them to $\\Omega_{e}$ via the isoparametric affine transformation $x(\\xi) = \\frac{x_{a}+x_{b}}{2} + \\frac{x_{b}-x_{a}}{2}\\,\\xi$ so that the Jacobian is $J = \\partial x / \\partial \\xi = L/2$.\n\nWork in the collocation formulation with Gauss–Lobatto–Legendre (GLL) nodes and weights. Let $\\{\\xi_{i}\\}_{i=0}^{4}$ denote the five GLL nodes and $\\{w_{i}\\}_{i=0}^{4}$ their GLL quadrature weights for $N=4$. Define the Lagrange interpolants $\\{\\ell_{i}(\\xi)\\}_{i=0}^{4}$ associated with the nodes such that $\\ell_{i}(\\xi_{j}) = \\delta_{ij}$. The SEM element mass and stiffness matrices on $\\hat{\\Omega}$ are given by\n$$\nM_{\\text{ref},ij} = \\int_{-1}^{1} \\ell_{i}(\\xi)\\,\\ell_{j}(\\xi)\\,d\\xi, \\qquad\nK_{\\text{ref},ij} = \\int_{-1}^{1} \\ell'_{i}(\\xi)\\,\\ell'_{j}(\\xi)\\,d\\xi,\n$$\nwhere primes denote differentiation with respect to $\\xi$. In the SEM collocation approach, approximate these integrals with GLL quadrature so that\n$$\nM_{\\text{ref}} = W, \\quad W = \\operatorname{diag}(w_{0},w_{1},w_{2},w_{3},w_{4}), \\qquad\nK_{\\text{ref}} = D^{\\top} W D,\n$$\nwhere $D_{ki} = \\ell'_{i}(\\xi_{k})$ is the differentiation matrix evaluated at the nodes.\n\nFirst, identify explicitly the GLL nodes $\\xi_{i}$ and weights $w_{i}$ for $N=4$ by using properties of Legendre polynomials $P_{4}(\\xi)$. Then, write explicit formulas for the entries of $D$ in terms of barycentric weights, and assemble $M_{\\text{ref}}$ and $K_{\\text{ref}}$ symbolically. Next, use the affine map to express the physical-element matrices $M_{\\text{phys}}$ and $K_{\\text{phys}}$ in terms of $M_{\\text{ref}}$, $K_{\\text{ref}}$, and $J$. Finally, determine the scalar $s$ such that the generalized discrete operator on $\\Omega_{e}$ satisfies\n$$\nM_{\\text{phys}}^{-1} K_{\\text{phys}} \\;=\\; s\\, M_{\\text{ref}}^{-1} K_{\\text{ref}}.\n$$\n\nProvide $s$ as a single closed-form analytic expression in terms of the element length $L$. No rounding is required.",
            "solution": "The problem statement is validated and found to be scientifically grounded, well-posed, objective, and self-contained. It describes a standard procedure in computational mechanics and the Spectral Element Method (SEM). All data and definitions are consistent with established theory. Therefore, we proceed with the solution.\n\nThe objective is to find a scalar constant $s$ such that the relationship $M_{\\text{phys}}^{-1} K_{\\text{phys}} = s\\, M_{\\text{ref}}^{-1} K_{\\text{ref}}$ holds, where $M_{\\text{phys}}$ and $K_{\\text{phys}}$ are the mass and stiffness matrices on a physical element $\\Omega_{e} = [x_a, x_b]$, and $M_{\\text{ref}}$ and $K_{\\text{ref}}$ are the corresponding matrices on the reference element $\\hat{\\Omega} = [-1, 1]$.\n\nThe physical element matrices are defined by integrals over the physical domain $\\Omega_{e}$:\n$$\nM_{\\text{phys},ij} = \\int_{x_{a}}^{x_{b}} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx\n$$\n$$\nK_{\\text{phys},ij} = \\int_{x_{a}}^{x_{b}} \\frac{d\\phi_{i}}{dx}(x)\\,\\frac{d\\phi_{j}}{dx}(x)\\,dx\n$$\nwhere $\\{\\phi_{i}(x)\\}$ are the basis functions on the physical element.\n\nThe problem specifies an isoparametric affine transformation from the reference coordinate $\\xi \\in [-1,1]$ to the physical coordinate $x \\in [x_a, x_b]$:\n$$\nx(\\xi) = \\frac{x_{a}+x_{b}}{2} + \\frac{x_{b}-x_{a}}{2}\\,\\xi\n$$\nThe Jacobian of this transformation, $J$, is a constant:\n$$\nJ = \\frac{dx}{d\\xi} = \\frac{x_{b}-x_{a}}{2} = \\frac{L}{2}\n$$\nwhere $L = x_{b} - x_{a}$ is the length of the physical element.\n\nTo relate the physical matrices to the reference matrices, we perform a change of variables in the integrals. The physical basis functions $\\phi_i(x)$ are related to the reference Lagrange interpolants $\\ell_i(\\xi)$ by the composition $\\phi_i(x(\\xi)) = \\ell_i(\\xi)$.\n\nFirst, let's transform the mass matrix. The differential element transforms as $dx = J\\,d\\xi$.\n$$\nM_{\\text{phys},ij} = \\int_{x_{a}}^{x_{b}} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx = \\int_{-1}^{1} \\phi_{i}(x(\\xi))\\,\\phi_{j}(x(\\xi))\\,J\\,d\\xi\n$$\nSubstituting the basis function relationship, we get:\n$$\nM_{\\text{phys},ij} = J \\int_{-1}^{1} \\ell_{i}(\\xi)\\,\\ell_{j}(\\xi)\\,d\\xi\n$$\nThe integral on the right is the definition of the reference mass matrix entry, $M_{\\text{ref},ij} = \\int_{-1}^{1} \\ell_{i}(\\xi)\\,\\ell_{j}(\\xi)\\,d\\xi$. Thus, the matrix relationship is:\n$$\nM_{\\text{phys}} = J \\cdot M_{\\text{ref}}\n$$\nNext, we transform the stiffness matrix. This requires transforming the derivative operator $d/dx$ using the chain rule:\n$$\n\\frac{d}{dx} = \\frac{d\\xi}{dx} \\frac{d}{d\\xi} = \\left(\\frac{dx}{d\\xi}\\right)^{-1} \\frac{d}{d\\xi} = \\frac{1}{J} \\frac{d}{d\\xi}\n$$\nApplying this to the stiffness matrix integral:\n$$\nK_{\\text{phys},ij} = \\int_{x_{a}}^{x_{b}} \\left(\\frac{d\\phi_{i}}{dx}\\right)\\left(\\frac{d\\phi_{j}}{dx}\\right)\\,dx = \\int_{-1}^{1} \\left(\\frac{1}{J}\\frac{d\\ell_{i}}{d\\xi}\\right)\\left(\\frac{1}{J}\\frac{d\\ell_{j}}{d\\xi}\\right)\\,J\\,d\\xi\n$$\nSince $J$ is a constant, we can factor it out of the integral:\n$$\nK_{\\text{phys},ij} = \\frac{J}{J^2} \\int_{-1}^{1} \\frac{d\\ell_{i}}{d\\xi}\\,\\frac{d\\ell_{j}}{d\\xi}\\,d\\xi = \\frac{1}{J} \\int_{-1}^{1} \\ell'_{i}(\\xi)\\,\\ell'_{j}(\\xi)\\,d\\xi\n$$\nThe integral on the right defines the reference stiffness matrix entry, $K_{\\text{ref},ij} = \\int_{-1}^{1} \\ell'_{i}(\\xi)\\,\\ell'_{j}(\\xi)\\,d\\xi$. The matrix relationship is therefore:\n$$\nK_{\\text{phys}} = \\frac{1}{J} \\cdot K_{\\text{ref}}\n$$\nIt is important to note that these scaling laws are purely geometric and independent of the polynomial degree $N$ or the specific choice of nodes and weights for the quadrature. The problem's definitions, $M_{\\text{ref}} = W$ and $K_{\\text{ref}} = D^{\\top} W D$, are specific instances of reference matrices, but the derived scaling relations hold for any consistent definition.\n\nNow, we construct the operator $M_{\\text{phys}}^{-1} K_{\\text{phys}}$. First, we find the inverse of the physical mass matrix:\n$$\nM_{\\text{phys}} = J \\cdot M_{\\text{ref}} \\implies M_{\\text{phys}}^{-1} = (J \\cdot M_{\\text{ref}})^{-1} = \\frac{1}{J} M_{\\text{ref}}^{-1}\n$$\nwhere we have used the property that the inverse of a scalar-matrix product is the product of the scalar's reciprocal and the matrix's inverse.\n\nNext, we pre-multiply the physical stiffness matrix by this inverse:\n$$\nM_{\\text{phys}}^{-1} K_{\\text{phys}} = \\left(\\frac{1}{J} M_{\\text{ref}}^{-1}\\right) \\left(\\frac{1}{J} K_{\\text{ref}}\\right)\n$$\nSince scalars commute with matrices, we can group the scalar terms:\n$$\nM_{\\text{phys}}^{-1} K_{\\text{phys}} = \\frac{1}{J^2} \\left(M_{\\text{ref}}^{-1} K_{\\text{ref}}\\right)\n$$\nWe are asked to find the scalar $s$ such that $M_{\\text{phys}}^{-1} K_{\\text{phys}} = s\\, M_{\\text{ref}}^{-1} K_{\\text{ref}}$. By direct comparison of the derived expression with the target form, we identify $s$ as:\n$$\ns = \\frac{1}{J^2}\n$$\nFinally, we substitute the given expression for the Jacobian, $J = L/2$:\n$$\ns = \\frac{1}{(L/2)^2} = \\frac{1}{L^2/4} = \\frac{4}{L^2}\n$$\nThis is the final analytical expression for the scalar $s$ in terms of the element length $L$.",
            "answer": "$$\n\\boxed{\\frac{4}{L^2}}\n$$"
        },
        {
            "introduction": "A correct numerical scheme is not only accurate but also stable; otherwise, errors can grow uncontrollably and render the simulation useless. This exercise tackles the crucial concept of stability for explicit time integration schemes by deriving the famous Courant–Friedrichs–Lewy (CFL) condition from first principles. By performing a spectral analysis of a finite element discretization of the wave equation, you will determine the maximum permissible time step, linking the spatial grid size $\\Delta x$ and the physical wave speed $c$ to the temporal step $\\Delta t$. ",
            "id": "3594567",
            "problem": "Consider the one-dimensional scalar acoustic wave equation $u_{tt}(x,t) = c^{2} u_{xx}(x,t)$ on a periodic domain of length $L$, where $c$ is a positive constant wave speed. Discretize the spatial domain with a uniform mesh of $N$ elements and spacing $\\Delta x = L/N$, and approximate $u(x,t)$ using continuous, piecewise-linear ($P1$) finite elements. Use the standard Galerkin formulation in space with the consistent mass matrix. Advance the resulting semi-discrete equations in time using the explicit second-order central difference scheme.\n\nStarting from the variational form of the scalar wave equation and the definitions of the mass and stiffness matrices implied by the chosen basis, perform a spectral (Fourier) analysis on the resulting uniform, periodic discrete system to determine the maximum stable timestep $\\Delta t_{\\max}$ for the explicit time discretization. Your derivation should identify the discrete Fourier symbols and the worst-case discrete angular frequency, and it should lead to an expression for $\\Delta t_{\\max}$ purely in terms of $\\Delta x$ and $c$.\n\nProvide your final answer as a single closed-form symbolic expression in terms of $\\Delta x$ and $c$. Do not include units in your final answer.",
            "solution": "The problem is to determine the maximum stable timestep for a specific numerical scheme applied to the one-dimensional scalar acoustic wave equation. The process involves deriving the semi-discrete equations using the finite element method, and then performing a Fourier stability analysis on the fully discrete system.\n\nThe governing partial differential equation (PDE) is the scalar wave equation:\n$$ \\frac{\\partial^2 u}{\\partial t^2}(x,t) = c^{2} \\frac{\\partial^2 u}{\\partial x^2}(x,t) $$\non a periodic domain of length $L$, where $c$ is the constant wave speed.\n\nFirst, we establish the variational (or weak) formulation. We multiply the PDE by a sufficiently smooth test function $v(x)$ and integrate over the domain $[0, L]$:\n$$ \\int_{0}^{L} \\frac{\\partial^2 u}{\\partial t^2} v \\,dx = c^2 \\int_{0}^{L} \\frac{\\partial^2 u}{\\partial x^2} v \\,dx $$\nIntegrating the right-hand side by parts yields:\n$$ \\int_{0}^{L} \\frac{\\partial^2 u}{\\partial t^2} v \\,dx = c^2 \\left[ \\frac{\\partial u}{\\partial x} v \\right]_{0}^{L} - c^2 \\int_{0}^{L} \\frac{\\partial u}{\\partial x} \\frac{\\partial v}{\\partial x} \\,dx $$\nThe boundary term $\\left[ c^2 \\frac{\\partial u}{\\partial x} v \\right]_{0}^{L}$ vanishes due to the periodic boundary conditions on both $u$ and $v$. This leads to the weak form: find $u(x,t)$ such that for all valid test functions $v(x)$,\n$$ \\int_{0}^{L} \\frac{\\partial^2 u}{\\partial t^2} v \\,dx + c^2 \\int_{0}^{L} \\frac{\\partial u}{\\partial x} \\frac{\\partial v}{\\partial x} \\,dx = 0 $$\n\nNext, we perform the spatial discretization. The domain is divided into $N$ elements of uniform size $\\Delta x = L/N$. We approximate the solution $u(x,t)$ using continuous, piecewise-linear ($P1$) basis functions, $\\phi_j(x)$:\n$$ u_h(x,t) = \\sum_{j=1}^{N} u_j(t) \\phi_j(x) $$\nwhere $u_j(t)$ are the time-dependent coefficients representing the solution at the nodes $x_j = j\\Delta x$, and $u_h(x,t)$ is the finite element approximation. In the Galerkin method, the test functions $v$ are chosen from the same space as the basis functions, so we set $v(x) = \\phi_i(x)$ for $i=1, \\dots, N$. Substituting the expansion for $u_h$ into the weak form gives a system of ordinary differential equations (ODEs):\n$$ \\sum_{j=1}^{N} \\left( \\int_{0}^{L} \\phi_i \\phi_j \\,dx \\right) \\frac{d^2 u_j}{dt^2} + c^2 \\sum_{j=1}^{N} \\left( \\int_{0}^{L} \\frac{d\\phi_i}{dx} \\frac{d\\phi_j}{dx} \\,dx \\right) u_j = 0 \\quad \\text{for } i=1, \\dots, N $$\nThis can be written in matrix form as:\n$$ \\mathbf{M} \\ddot{\\mathbf{u}}(t) + \\mathbf{K} \\mathbf{u}(t) = \\mathbf{0} $$\nwhere $\\mathbf{u}(t)$ is the vector of nodal values $[u_1(t), \\dots, u_N(t)]^T$. The consistent mass matrix $\\mathbf{M}$ and stiffness matrix $\\mathbf{K}$ have entries:\n$$ M_{ij} = \\int_{0}^{L} \\phi_i \\phi_j \\,dx $$\n$$ K_{ij} = c^2 \\int_{0}^{L} \\frac{d\\phi_i}{dx} \\frac{d\\phi_j}{dx} \\,dx $$\n\nFor uniform $P1$ elements, the basis function $\\phi_j(x)$ is a \"hat\" function centered at $x_j$ and non-zero only on $[x_{j-1}, x_{j+1}]$. The integrals evaluate to:\n$M_{j,j} = \\int_{x_{j-1}}^{x_{j+1}} \\phi_j^2 \\,dx = \\frac{2\\Delta x}{3}$\n$M_{j, j\\pm 1} = \\int_{x_{j}}^{x_{j\\pm 1}} \\phi_j \\phi_{j\\pm 1} \\,dx = \\frac{\\Delta x}{6}$\n$K_{j,j} = c^2 \\int_{x_{j-1}}^{x_{j+1}} (\\phi'_j)^2 \\,dx = \\frac{2c^2}{\\Delta x}$\n$K_{j, j\\pm 1} = c^2 \\int_{x_{j}}^{x_{j\\pm 1}} \\phi'_j \\phi'_{j\\pm 1} \\,dx = -\\frac{c^2}{\\Delta x}$\nAll other entries are zero. The $i$-th row of the matrix system corresponds to the stencil operations:\n$$ \\frac{\\Delta x}{6}(\\ddot{u}_{i-1} + 4\\ddot{u}_i + \\ddot{u}_{i+1}) + \\frac{c^2}{\\Delta x}(-u_{i-1} + 2u_i - u_{i+1}) = 0 $$\n\nTo perform a spectral analysis, we seek a grid-scale Fourier mode solution of the form $u_j(t) = \\hat{u}_k(t) e^{i k x_j}$, where $k$ is the wavenumber and $x_j = j \\Delta x$. Substituting this into the stencil equation, we can find the Fourier symbols (eigenvalues) of the matrices $\\mathbf{M}$ and $\\mathbf{K}$.\nFor the mass matrix term:\n$\\frac{\\Delta x}{6}(\\ddot{\\hat{u}}_k e^{ik(j-1)\\Delta x} + 4\\ddot{\\hat{u}}_k e^{ikj\\Delta x} + \\ddot{\\hat{u}}_k e^{ik(j+1)\\Delta x}) = \\ddot{\\hat{u}}_k e^{ikj\\Delta x} \\frac{\\Delta x}{6}(e^{-ik\\Delta x} + 4 + e^{ik\\Delta x}) = \\ddot{\\hat{u}}_k e^{ikj\\Delta x} \\frac{\\Delta x}{3}(2 + \\cos(k\\Delta x))$.\nThe Fourier symbol of the mass matrix operator is $\\hat{M}(k) = \\frac{\\Delta x}{3}(2 + \\cos(k\\Delta x))$.\n\nFor the stiffness matrix term:\n$\\frac{c^2}{\\Delta x}(-u_{i-1} + 2u_i - u_{i+1}) \\to \\hat{u}_k e^{ikj\\Delta x} \\frac{c^2}{\\Delta x}(-e^{-ik\\Delta x} + 2 - e^{ik\\Delta x}) = \\hat{u}_k e^{ikj\\Delta x} \\frac{2c^2}{\\Delta x}(1 - \\cos(k\\Delta x))$.\nThe Fourier symbol of the stiffness matrix operator is $\\hat{K}(k) = \\frac{2c^2}{\\Delta x}(1 - \\cos(k\\Delta x))$.\n\nThe semi-discrete system transforms into a scalar ODE for each mode $k$:\n$$ \\hat{M}(k) \\ddot{\\hat{u}}_k(t) + \\hat{K}(k) \\hat{u}_k(t) = 0 \\implies \\ddot{\\hat{u}}_k(t) + \\omega_d^2(k) \\hat{u}_k(t) = 0 $$\nwhere $\\omega_d(k)$ is the discrete angular frequency, given by the discrete dispersion relation:\n$$ \\omega_d^2(k) = \\frac{\\hat{K}(k)}{\\hat{M}(k)} = \\frac{\\frac{2c^2}{\\Delta x}(1 - \\cos(k\\Delta x))}{\\frac{\\Delta x}{3}(2 + \\cos(k\\Delta x))} = \\frac{6c^2}{(\\Delta x)^2} \\frac{1 - \\cos(k\\Delta x)}{2 + \\cos(k\\Delta x)} $$\n\nNow we discretize in time using the explicit second-order central difference scheme for $\\ddot{\\hat{u}}_k$. Let $\\hat{u}_k^n$ denote the solution at time $t_n = n\\Delta t$:\n$$ \\frac{\\hat{u}_k^{n+1} - 2\\hat{u}_k^n + \\hat{u}_k^{n-1}}{(\\Delta t)^2} + \\omega_d^2(k) \\hat{u}_k^n = 0 $$\nWe analyze stability by assuming a solution of the form $\\hat{u}_k^n = g^n$, where $g$ is the amplification factor.\n$$ g^{n-1}(g^2 - 2g + 1) + \\omega_d^2(k)(\\Delta t)^2 g^n = 0 $$\n$$ g^2 - (2 - (\\omega_d(k)\\Delta t)^2)g + 1 = 0 $$\nFor the scheme to be stable, the magnitude of the roots of this quadratic equation must be no greater than unity, i.e., $|g| \\le 1$. This condition is met if and only if the time step $\\Delta t$ satisfies:\n$$ |\\omega_d(k) \\Delta t| \\le 2 $$\nThis must hold for all possible wavenumbers $k$. To guarantee stability, we must bound the time step based on the maximum possible discrete frequency:\n$$ \\Delta t \\le \\frac{2}{\\max_k |\\omega_d(k)|} \\implies \\Delta t_{\\max} = \\frac{2}{\\omega_{d,\\max}} $$\n\nWe find $\\omega_{d,\\max}$ by maximizing $\\omega_d^2(k)$. Let $\\theta = k\\Delta x$. The range of physically distinct grid-scale modes is $\\theta \\in [-\\pi, \\pi]$. We need to maximize the function:\n$$ f(\\theta) = \\frac{1 - \\cos\\theta}{2 + \\cos\\theta} $$\nThe derivative of $f(\\theta)$ with respect to $\\cos\\theta$ is $\\frac{d}{d(\\cos\\theta)}\\left(\\frac{1 - \\cos\\theta}{2 + \\cos\\theta}\\right) = \\frac{-(2+\\cos\\theta) - (1-\\cos\\theta)(1)}{(2+\\cos\\theta)^2} = \\frac{-3}{(2+\\cos\\theta)^2}$, which is always negative. Thus, $f(\\theta)$ is a monotonically decreasing function of $\\cos\\theta$. The maximum of $f(\\theta)$ occurs at the minimum value of $\\cos\\theta$, which is $-1$ at $\\theta = \\pm\\pi$. This corresponds to the highest frequency mode representable on the grid (wavelength $2\\Delta x$).\nThe maximum value is:\n$$ f_{\\max} = f(\\pi) = \\frac{1 - (-1)}{2 + (-1)} = \\frac{2}{1} = 2 $$\nThe maximum squared discrete angular frequency is:\n$$ \\omega_{d,\\max}^2 = \\frac{6c^2}{(\\Delta x)^2} f_{\\max} = \\frac{6c^2}{(\\Delta x)^2} \\cdot 2 = \\frac{12c^2}{(\\Delta x)^2} $$\nThe maximum discrete angular frequency is:\n$$ \\omega_{d,\\max} = \\sqrt{\\frac{12c^2}{(\\Delta x)^2}} = \\frac{2\\sqrt{3}c}{\\Delta x} $$\nFinally, we substitute this into the stability condition to find the maximum stable timestep:\n$$ \\Delta t_{\\max} = \\frac{2}{\\omega_{d,\\max}} = \\frac{2}{\\frac{2\\sqrt{3}c}{\\Delta x}} = \\frac{\\Delta x}{\\sqrt{3}c} $$\nThis result can also be expressed as a Courant–Friedrichs–Lewy (CFL) number, $\\mathcal{C} = \\frac{c\\Delta t}{\\Delta x}$, where the stability limit is $\\mathcal{C} \\le \\frac{1}{\\sqrt{3}}$.",
            "answer": "$$\\boxed{\\frac{\\Delta x}{\\sqrt{3} c}}$$"
        },
        {
            "introduction": "Moving from linear to nonlinear hyperbolic equations, such as those governing fluid dynamics or complex wave interactions, introduces new and subtle numerical challenges. This practice explores one of the most critical issues in high-order methods: aliasing error, which arises from the inexact representation of nonlinear terms and can violate the conservation of physical quantities like energy. You will analyze the mechanisms of this error and evaluate the effectiveness of common stabilization strategies, such as de-aliasing and split-form discretizations. ",
            "id": "3594444",
            "problem": "Consider the scalar conservation law $u_t + \\partial_x f(u) = 0$ posed on a periodic interval $[0,L]$, with quadratic flux $f(u) = \\tfrac{1}{2}u^2$. Let $u(x,t)$ be smooth. In the continuous setting, define the energy functional $E(t) = \\int_{0}^{L} \\tfrac{1}{2} u^2 \\, dx$.\n\nNow consider a high-order collocation discretization that is representative of Discontinuous Galerkin (DG) and Spectral Element Method (SEM) formulations, specifically a Discontinuous Galerkin Spectral Element Method (DGSEM) with nodal Gauss-Lobatto-Legendre (GLL) quadrature. On each element, the discrete solution $u_h$ is represented in a polynomial space of degree $p$ using $N = p+1$ GLL nodes with corresponding GLL quadrature weights. Volume integrals are approximated by the same GLL quadrature and nonlinear fluxes are evaluated pointwise at the nodes and then interpolated. The discrete inner product is the quadrature-weighted nodal inner product induced by the GLL rule.\n\nLet the numerical surface flux be chosen such that, in the absence of volume contributions, periodicity would yield no net energy change. The volume term is evaluated by the aforementioned GLL quadrature without any over-integration. In this setting, practitioners often observe so-called aliasing errors.\n\nWhich of the following statements about aliasing error from under-integrated nonlinear terms and its impact on discrete energy conservation in such high-order DG/SEM discretizations are correct? Select all that apply.\n\nA. Aliasing error is the difference between the exact $L^2$ inner product of a nonlinear quantity (such as $f(u_h)$) with a test function and its approximation by the chosen quadrature and nodal interpolation; this discrepancy can break discrete energy conservation by injecting or dissipating energy.\n\nB. With standard GLL collocation using $N=p+1$ points (exact for polynomials up to degree $2p-1$), the discrete $L^2$ energy $E_h(t) = \\tfrac{1}{2} \\langle u_h, u_h \\rangle_{\\text{GLL}}$ is exactly conserved for the quadratic flux case on periodic domains, independently of $p$.\n\nC. Under-integration of nonlinear volume terms generally renders the discrete convective operator non-skew with respect to the quadrature-based inner product, so that even with periodic boundaries the semi-discrete scheme can exhibit spurious growth or decay of $E_h(t)$.\n\nD. Choosing an entropy-conservative numerical surface flux at element interfaces is sufficient to guarantee exact discrete energy conservation for periodic problems, even if the nonlinear volume terms are under-integrated.\n\nE. Either over-integration of the nonlinear volume terms (also known as polynomial de-aliasing) or split-form (skew-symmetric) volume discretizations can recover a discrete skew-symmetry that prevents spurious energy growth on periodic problems.\n\nF. Modal filtering that damps high-order modes removes aliasing while exactly preserving the discrete energy $E_h(t)$ for all times on periodic domains.\n\nAnswer choices are independent; there may be more than one correct choice. Provide your selection.",
            "solution": "We start from the continuous conservation law $u_t + \\partial_x f(u) = 0$ with $f(u) = \\tfrac{1}{2}u^2$ on a periodic interval. Define $E(t) = \\int_{0}^{L} \\tfrac{1}{2} u^2 \\, dx$. The continuous energy rate follows from first principles by multiplying the equation by $u$ and integrating over the domain:\n$$\n\\int_{0}^{L} u\\, u_t \\, dx + \\int_{0}^{L} u\\, \\partial_x f(u) \\, dx = 0.\n$$\nThe first term is $\\frac{d}{dt} \\int_{0}^{L} \\tfrac{1}{2} u^2 \\, dx = \\frac{dE}{dt}$. For the second term, use the chain rule and periodicity. Since $f(u) = \\tfrac{1}{2} u^2$, we have $u \\, \\partial_x f(u) = u \\, \\partial_x \\left(\\tfrac{1}{2} u^2\\right) = u^2 \\, \\partial_x u = \\partial_x \\left(\\tfrac{1}{3} u^3\\right)$. Hence\n$$\n\\frac{dE}{dt} + \\int_{0}^{L} \\partial_x \\left(\\tfrac{1}{3} u^3\\right) dx = 0.\n$$\nUnder periodic boundary conditions, $\\int_{0}^{L} \\partial_x \\left(\\tfrac{1}{3} u^3\\right) dx = 0$, so $\\frac{dE}{dt} = 0$. Therefore, in the continuous setting, the $L^2$ energy is conserved for smooth solutions.\n\nWe now examine the discrete setting that typifies a Discontinuous Galerkin Spectral Element Method (DGSEM) with Gauss-Lobatto-Legendre (GLL) collocation and quadrature. On each element, the polynomial approximation $u_h$ has degree $p$ and is represented at $N=p+1$ GLL nodes. The discrete inner product $\\langle \\cdot,\\cdot\\rangle_{\\text{GLL}}$ is defined by the GLL quadrature, which is exact for polynomials up to degree $2p-1$. The semi-discrete strong-form volume term uses pointwise nodal evaluation of the nonlinear flux $f(u_h)$ and the same quadrature for integration.\n\nThe discrete energy is $E_h(t) = \\tfrac{1}{2} \\langle u_h, u_h \\rangle_{\\text{GLL}}$. For linear fluxes, the discrete convective operator induced by the summation-by-parts (SBP) property is skew-symmetric with respect to the quadrature-based inner product for periodic problems, leading to discrete conservation of $E_h(t)$. However, for nonlinear fluxes, evaluating $f(u_h)$ pointwise and integrating with an under-resolved quadrature introduces a discrepancy between the exact inner product of nonlinear terms and its quadrature approximation. This discrepancy is the aliasing error. It manifests as a loss of exact skew-symmetry of the discrete convective operator with respect to the quadrature-based inner product, thereby allowing a nonzero discrete energy rate even under periodic boundary conditions. In practice, this can cause spurious growth or decay of $E_h(t)$.\n\nTo eliminate or mitigate aliasing, one may increase the quadrature accuracy for the nonlinear volume terms (over-integration or de-aliasing) so that the inner products involving nonlinear terms are evaluated exactly (or to a degree sufficient to remove the aliasing error). Alternatively, one may adopt split-form (skew-symmetric) discretizations that algebraically enforce a discrete product rule and restore skew-symmetry, resulting in energy stability or exact conservation (for appropriate choices such as entropy-conservative two-point fluxes) even without increasing quadrature beyond the collocated rule.\n\nWe now evaluate each option:\n\nA. This statement defines aliasing error as the difference between the exact $L^2$ inner product of a nonlinear quantity and its quadrature-based nodal evaluation, and it connects that discrepancy to the loss of discrete energy conservation. This matches the mechanism described above: under-integration of nonlinear products yields a nonzero residual in the discrete energy balance. Verdict: Correct.\n\nB. This asserts that standard GLL collocation with $N=p+1$ points exactly conserves the discrete $L^2$ energy for the quadratic flux on periodic domains for any $p$. This is generally false. The GLL quadrature is exact up to degree $2p-1$, whereas products that arise from nonlinear fluxes in the volume term exceed that degree when $u_h$ has degree $p$, so aliasing is present and discrete energy conservation is not guaranteed. Empirically and analytically, one observes spurious energy production or dissipation unless special measures (over-integration or split forms) are used. Verdict: Incorrect.\n\nC. This connects under-integration of nonlinear volume terms to a loss of skew-symmetry of the discrete convective operator and consequent spurious changes in $E_h(t)$ under periodic boundaries. This accurately reflects the effect of aliasing in DG/SEM collocation discretizations for nonlinear problems. Verdict: Correct.\n\nD. This claims that entropy-conservative numerical surface fluxes alone are sufficient to guarantee exact discrete energy conservation even if the volume terms are under-integrated. While entropy-conservative fluxes remove spurious interface contributions, they do not address the interior aliasing error from under-integrated nonlinear volume terms. Therefore, they are not sufficient to guarantee exact energy conservation. Verdict: Incorrect.\n\nE. This states that either over-integration of nonlinear volume terms (de-aliasing) or split-form (skew-symmetric) volume discretizations can restore a discrete skew-symmetry and prevent spurious energy growth on periodic problems. This is consistent with established approaches: over-integration removes quadrature-induced aliasing, and split forms enforce a discrete product rule and skew-symmetry that yield energy stability or conservation. Verdict: Correct.\n\nF. This claims that modal filtering removes aliasing while exactly preserving discrete energy for all times. Modal filtering introduces artificial dissipation by damping higher modes; it does not preserve energy exactly and in fact reduces it. While it can stabilize computations, it does not satisfy exact energy conservation. Verdict: Incorrect.\n\nTherefore, the correct choices are A, C, and E.",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}