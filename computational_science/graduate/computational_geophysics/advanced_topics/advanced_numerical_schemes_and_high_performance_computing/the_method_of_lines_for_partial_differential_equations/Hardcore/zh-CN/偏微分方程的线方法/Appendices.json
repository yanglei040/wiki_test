{
    "hands_on_practices": [
        {
            "introduction": "在实践中应用线方法（Method of Lines）时，边界条件的处理至关重要。本练习提供了一种最常用技术——“虚拟单元法”（ghost cell method）——的动手实践，用于处理通量（Neumann）边界条件。通过引导您从理论推导到可完全验证的编码实现，本练习将巩固您对这一核心概念的理解 。",
            "id": "3617046",
            "problem": "考虑一维扩散偏微分方程 (PDE)，用于描述闭区间 $x \\in [0,L]$ 和时间 $t \\ge 0$ 上的标量场 $u(x,t)$：\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa \\frac{\\partial^2 u}{\\partial x^2} + s(t),\n$$\n其中 $\\kappa > 0$ 是一个常数扩散系数，$s(t)$ 是一个只依赖于时间的给定源项。边界条件为诺伊曼型（通量规定）：\n$$\n\\frac{\\partial u}{\\partial x}(0,t) = \\alpha, \\quad \\frac{\\partial u}{\\partial x}(L,t) = \\beta,\n$$\n其中 $\\alpha$ 和 $\\beta$ 是给定的实常数。初始条件为 $u(x,0) = u_0(x)$。\n\n您的任务是使用离散纵向法 (MOL)，在均匀网格上通过二阶精度的中心有限差分格式对空间进行离散化，然后对得到的常微分方程 (ODE) 组进行时间积分。为了施加诺伊曼边界条件，请使用虚单元，并推导替代边界节点上标准离散拉普拉斯算子的二阶精度修正边界模板。\n\n从核心定义（中心差分和泰勒展开）出发，完成以下任务：\n\n1.  通过要求在 $x=0$ 和 $x=L$ 处，空间导数的二阶精度中心有限差分近似成立，来推导诺伊曼边界条件所蕴含的虚单元公式。请用内部节点值和给定的通量来表示虚点值 $u_{-1}(t)$ 和 $u_{N}(t)$，其中均匀网格点为 $x_i = i h$（$i=0,1,\\dots,N-1$），间距 $h = L/(N-1)$，虚点索引 $-1$ 和 $N$ 分别指代域外位于 $x=-h$ 和 $x=L+h$ 的虚拟节点。\n\n2.  使用标准的二阶中心离散拉普拉斯算子，\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_i = \\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2},\n$$\n将您在第 1 部分中得到的虚单元公式代入拉普拉斯算子，推导在 $i=0$ 和 $i=N-1$ 处的修正离散边界模板。您的最终表达式必须纯粹用网格值 $u_0, u_1, \\dots, u_{N-1}$ 和边界通量 $\\alpha$ 和 $\\beta$ 来表示。\n\n3.  通过组装半离散常微分方程系统来实施离散纵向法\n$$\n\\frac{d}{dt}\\, \\mathbf{u}(t) = \\kappa\\, \\mathcal{D}_{xx}\\, \\mathbf{u}(t) + s(t)\\, \\mathbf{1},\n$$\n其中 $\\mathbf{u}(t) = \\left[u_0(t), u_1(t), \\dots, u_{N-1}(t)\\right]^\\top$，$\\mathbf{1}$ 是全为 1 的向量。请使用您在第 2 部分中推导的边界修正模板。使用通用常微分方程求解器对该 ODE 系统进行时间积分。\n\n4.  为了验证正确性并量化精度，请使用人造解法。考虑精确解\n$$\nu_{\\text{exact}}(x,t) = C_0 + \\alpha\\, x + \\frac{\\beta - \\alpha}{2L}\\, x^2 + \\sin(\\omega t),\n$$\n其中常数 $C_0 = 0$，角频率 $\\omega > 0$。推导源项 $s(t)$，使得 $u_{\\text{exact}}(x,t)$ 满足具有扩散系数 $\\kappa$ 和诺伊曼边界条件 $\\alpha$、$\\beta$ 的 PDE。使用初始条件 $u(x,0) = u_{\\text{exact}}(x,0)$。\n\n5.  实现您的求解器，并计算在最终时间 $T$ 时的离散均方根 (RMS) 误差：\n$$\nE_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(u_i(T) - u_{\\text{exact}}(x_i,T)\\right)^2}.\n$$\n\n使用以下参数集测试套件。每个测试用例指定 $(L,\\ \\kappa,\\ \\alpha,\\ \\beta,\\ N,\\ T,\\ \\omega)$：\n\n- 测试 A（一般情况）：$(1.0,\\ 0.5,\\ 0.2,\\ -0.1,\\ 41,\\ 0.5,\\ 2.3)$。\n- 测试 B（A 的网格加密版）：$(1.0,\\ 0.5,\\ 0.2,\\ -0.1,\\ 81,\\ 0.5,\\ 2.3)$。\n- 测试 C（零通量对称）：$(1.5,\\ 0.25,\\ 0.0,\\ 0.0,\\ 50,\\ 1.2,\\ 1.7)$。\n- 测试 D（短域，强反向通量）：$(0.1,\\ 0.1,\\ 5.0,\\ -3.0,\\ 21,\\ 0.05,\\ 10.0)$。\n\n无需物理单位；所有量均为无量纲。如适用，角度以弧度为单位。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,result3,result4]”）。在这里，每个结果是对应测试用例的浮点均方根误差 $E_{\\text{RMS}}$，顺序为 A、B、C、D。程序必须是一个完整的、可运行的实现，它能够构建带有您推导的诺伊曼边界模板的半离散算子，进行时间积分，评估人造解，并以指定格式输出四个均方根误差。",
            "solution": "我们从一个具有常数扩散系数 $\\kappa$ 和时间依赖源项 $s(t)$ 的一维扩散偏微分方程 (PDE) 开始：\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa \\frac{\\partial^2 u}{\\partial x^2} + s(t),\n$$\n对于 $x \\in [0,L]$，$t \\ge 0$，诺伊曼边界条件为 $\\frac{\\partial u}{\\partial x}(0,t)=\\alpha$ 和 $\\frac{\\partial u}{\\partial x}(L,t)=\\beta$。\n\n我们构建一个包含 $N$ 个点的均匀空间网格：$x_i = i h$，其中 $i=0,1,\\dots,N-1$，网格间距为 $h = L/(N-1)$。离散纵向法 (MOL) 要求我们仅在空间上进行离散化，以获得一个关于时间的常微分方程 (ODE) 组。令 $u_i(t) \\approx u(x_i,t)$。\n\n内部点处二阶空间导数的二阶中心差分近似为\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_i = \\frac{u_{i+1} - 2 u_i + u_{i-1}}{h^2}, \\quad i=1,2,\\dots,N-2.\n$$\n为了在诺伊曼条件下于边界处达到二阶精度，我们引入位于 $x=-h$ 和 $x=L+h$ 的虚点 $u_{-1}(t)$ 和 $u_{N}(t)$。然后我们强制要求边界位置的中心一阶导数近似与规定的通量匹配。\n\n具体来说，我们在 $x=0$ 处使用一阶导数的二阶中心差分近似：\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=0} \\approx \\frac{u_1 - u_{-1}}{2h} = \\alpha.\n$$\n求解虚点值可得\n$$\nu_{-1} = u_1 - 2 h \\alpha.\n$$\n类似地，在 $x=L$（位于 $i=N-1$ 处），二阶中心一阶导数为\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=L} \\approx \\frac{u_{N} - u_{N-2}}{2h} = \\beta,\n$$\n这给出\n$$\nu_{N} = u_{N-2} + 2 h \\beta.\n$$\n\n现在，我们将这些虚点值代入边界节点处的标准二阶离散拉普拉斯算子中。在左边界 ($i=0$)，带有虚点的离散拉普拉斯算子是\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_0 = \\frac{u_{1} - 2 u_{0} + u_{-1}}{h^2}.\n$$\n使用 $u_{-1} = u_1 - 2 h \\alpha$，\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_0 = \\frac{u_{1} - 2 u_{0} + \\left(u_1 - 2 h \\alpha\\right)}{h^2}\n= \\frac{2 u_1 - 2 u_0}{h^2} - \\frac{2 \\alpha}{h}.\n$$\n这就是左边界处的修正边界模板。在右边界 ($i=N-1$)，\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_{N-1} = \\frac{u_{N} - 2 u_{N-1} + u_{N-2}}{h^2}.\n$$\n使用 $u_{N} = u_{N-2} + 2 h \\beta$，\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_{N-1} = \\frac{\\left(u_{N-2} + 2 h \\beta\\right) - 2 u_{N-1} + u_{N-2}}{h^2}\n= \\frac{2 u_{N-2} - 2 u_{N-1}}{h^2} + \\frac{2 \\beta}{h}.\n$$\n这些边界公式与标准的内部模板一起，构成了通过虚单元与诺伊曼边界条件一致的二阶精度空间离散化方案。\n\n将所有节点汇总，半离散 MOL 系统为\n$$\n\\frac{d}{dt}\\, u_i(t) = \\kappa \\left(\\mathcal{D}_{xx} u\\right)_i + s(t), \\quad i = 0,1,\\dots,N-1,\n$$\n其中\n$$\n\\left(\\mathcal{D}_{xx} u\\right)_i =\n\\begin{cases}\n\\dfrac{2 u_1 - 2 u_0}{h^2} - \\dfrac{2 \\alpha}{h}, & i = 0,\\\\[1.0em]\n\\dfrac{u_{i+1} - 2 u_i + u_{i-1}}{h^2}, & i = 1,2,\\dots,N-2,\\\\[1.0em]\n\\dfrac{2 u_{N-2} - 2 u_{N-1}}{h^2} + \\dfrac{2 \\beta}{h}, & i = N-1.\n\\end{cases}\n$$\n\n为了验证实现，我们采用人造解法。考虑\n$$\nu_{\\text{exact}}(x,t) = C_0 + \\alpha\\, x + \\frac{\\beta - \\alpha}{2L}\\, x^2 + \\sin(\\omega t),\n$$\n其中 $C_0=0$ 且 $\\omega>0$。边界导数为\n$$\n\\left.\\frac{\\partial u_{\\text{exact}}}{\\partial x}\\right|_{x=0} = \\alpha, \\quad\n\\left.\\frac{\\partial u_{\\text{exact}}}{\\partial x}\\right|_{x=L} = \\alpha + \\frac{\\beta - \\alpha}{L} L = \\beta,\n$$\n因此，对于所有 $t$，诺伊曼边界条件通过构造得到满足。时间导数和二阶空间导数为\n$$\n\\frac{\\partial u_{\\text{exact}}}{\\partial t} = \\omega \\cos(\\omega t), \\quad\n\\frac{\\partial^2 u_{\\text{exact}}}{\\partial x^2} = \\frac{\\beta - \\alpha}{L}.\n$$\n将其代入 PDE\n$$\n\\frac{\\partial u_{\\text{exact}}}{\\partial t} = \\kappa \\frac{\\partial^2 u_{\\text{exact}}}{\\partial x^2} + s(t)\n$$\n可得出所需的源项\n$$\ns(t) = \\omega \\cos(\\omega t) - \\kappa \\frac{\\beta - \\alpha}{L}.\n$$\n初始条件为 $u(x,0) = u_{\\text{exact}}(x,0)$。\n\n对于每个测试用例，我们使用高精度的 ODE 求解器将半离散 ODE 系统积分到时间 $T$。离散均方根 (RMS) 误差计算如下\n$$\nE_{\\text{RMS}} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1}\\left(u_i(T) - u_{\\text{exact}}(x_i,T)\\right)^2}.\n$$\n\n测试套件由以下参数集 $(L,\\ \\kappa,\\ \\alpha,\\ \\beta,\\ N,\\ T,\\ \\omega)$ 组成：\n\n- 测试 A: $(1.0,\\ 0.5,\\ 0.2,\\ -0.1,\\ 41,\\ 0.5,\\ 2.3)$,\n- 测试 B: $(1.0,\\ 0.5,\\ 0.2,\\ -0.1,\\ 81,\\ 0.5,\\ 2.3)$,\n- 测试 C: $(1.5,\\ 0.25,\\ 0.0,\\ 0.0,\\ 50,\\ 1.2,\\ 1.7)$,\n- 测试 D: $(0.1,\\ 0.1,\\ 5.0,\\ -3.0,\\ 21,\\ 0.05,\\ 10.0)$。\n\n由于空间离散化是二阶精度的，并且能够精确地重现二次多项式，而人造解在空间上是二次的，因此在这些测试中，主要的数值误差来自于时间积分和求解器的容差。通过使用严格的容差，RMS 误差应该很小，并随着时间分辨率的提高或容差的减小而减小。最终的程序会组装修正后的边界模板，对 ODE 系统进行积分，计算 $u_{\\text{exact}}$，为每个测试用例计算 $E_{\\text{RMS}}$，并按 A、B、C、D 的顺序以 $[e_A,e_B,e_C,e_D]$ 的列表格式打印包含四个 RMS 误差的单行输出。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef manufactured_solution(x, t, L, alpha, beta, omega):\n    # u_exact(x,t) = alpha x + ((beta - alpha)/(2L)) x^2 + sin(omega t)\n    return alpha * x + ((beta - alpha) / (2.0 * L)) * x**2 + np.sin(omega * t)\n\ndef source_term(t, kappa, L, alpha, beta, omega):\n    # s(t) = omega cos(omega t) - kappa * (beta - alpha)/L\n    return omega * np.cos(omega * t) - kappa * (beta - alpha) / L\n\ndef mol_rhs_builder(N, L, kappa, alpha, beta, omega):\n    # Build the RHS function f(t, u) = kappa * Dxx(u) + s(t) * 1\n    h = L / (N - 1)\n\n    def rhs(t, u):\n        du = np.empty_like(u)\n\n        # Interior points\n        # Use vectorized central differences where possible\n        # Boundary at i=0 with modified stencil via ghost cell:\n        # Dxx u_0 = (2 u_1 - 2 u_0)/h^2 - 2 alpha / h\n        du[0] = kappa * ((2.0 * u[1] - 2.0 * u[0]) / (h * h) - 2.0 * alpha / h)\n\n        # Interior nodes\n        if N > 2:\n            du[1:-1] = kappa * (u[2:] - 2.0 * u[1:-1] + u[:-2]) / (h * h)\n        # Right boundary i=N-1:\n        # Dxx u_{N-1} = (2 u_{N-2} - 2 u_{N-1})/h^2 + 2 beta / h\n        du[-1] = kappa * ((2.0 * u[-2] - 2.0 * u[-1]) / (h * h) + 2.0 * beta / h)\n\n        # Add source term s(t) uniformly\n        s = source_term(t, kappa, L, alpha, beta, omega)\n        du += s\n\n        return du\n\n    return rhs\n\ndef run_case(L, kappa, alpha, beta, N, T, omega):\n    x = np.linspace(0.0, L, N)\n    u0 = manufactured_solution(x, 0.0, L, alpha, beta, omega)\n\n    rhs = mol_rhs_builder(N, L, kappa, alpha, beta, omega)\n\n    # Integrate in time with strict tolerances\n    sol = solve_ivp(\n        fun=rhs,\n        t_span=(0.0, T),\n        y0=u0,\n        method=\"RK45\",\n        rtol=1e-10,\n        atol=1e-12,\n        dense_output=False\n    )\n\n    uT = sol.y[:, -1]\n    u_exact_T = manufactured_solution(x, T, L, alpha, beta, omega)\n    err = np.sqrt(np.mean((uT - u_exact_T) ** 2))\n    return float(err)\n\ndef solve():\n    # Define the test cases (L, kappa, alpha, beta, N, T, omega)\n    test_cases = [\n        (1.0, 0.5, 0.2, -0.1, 41, 0.5, 2.3),   # Test A\n        (1.0, 0.5, 0.2, -0.1, 81, 0.5, 2.3),   # Test B\n        (1.5, 0.25, 0.0, 0.0, 50, 1.2, 1.7),   # Test C\n        (0.1, 0.1, 5.0, -3.0, 21, 0.05, 10.0), # Test D\n    ]\n\n    results = []\n    for case in test_cases:\n        L, kappa, alpha, beta, N, T, omega = case\n        err = run_case(L, kappa, alpha, beta, N, T, omega)\n        results.append(err)\n\n    # Print as a single line list of comma-separated floats\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "在上一练习的基础上，我们现在将探讨离散化方法的不同选择如何影响整个模拟，特别是对于波动现象。本练习比较了传统的边界处理方法与现代的基于罚项的方法（SBP-SAT），展示了它们对离散算子谱以及数值稳定性极限（CFL条件）的影响。这是关于数值设计选择如何影响计算效率的关键一课 。",
            "id": "3617036",
            "problem": "考虑闭区间 $[0,L]$ 上的一维声波方程 $u_{tt} = c^2 u_{xx}$，其边界条件为均匀 Dirichlet 边界条件 $u(0,t) = 0$ 和 $u(L,t) = 0$。未知数 $u(x,t)$ 的单位是声位移，$c$ 是波速，单位为米/秒，$x$ 的单位是米，$t$ 的单位是秒。在计算地球物理学中，一种常见的半离散方法是线方法：对空间导数进行离散化，以获得关于时间的有限维常微分方程组。显式时间积分器的稳定性由半离散空间谱通过 Courant-Friedrichs-Lewy (CFL) 条件决定。\n\n您将研究空间离散化中的两种边界处理如何改变半离散谱，进而改变 CFL 条件，然后设计一个基于罚函数的边界闭合参数，以最大化空间算子的最小负特征值（即从下方最接近 0 的特征值）。\n\n空间网格与内部离散化：\n- 设 $N \\in \\mathbb{N}$ 为内部网格点数，在 $(0,L)$ 上定义一个均匀网格，其间距为 $h = \\frac{L}{N+1}$，内部节点为 $x_i = i h$，其中 $i=1,\\dots,N$。\n- 对于内部点 $i=2,\\dots,N-1$，使用标准的二阶中心差分格式来近似 $u_{xx}(x_i,t)$：\n$$\nu_{xx}(x_i,t) \\approx \\frac{u_{i-1}(t) - 2 u_i(t) + u_{i+1}(t)}{h^2}.\n$$\n\n两种边界闭合方法：\n1) 鬼点强 Dirichlet 消除法 (GP-SD)：\n- 通过消除边界贡献来强行施加边界条件。这会产生经典的离散拉普拉斯矩阵 $\\mathbf{A}_{\\mathrm{GP}} \\in \\mathbb{R}^{N \\times N}$，其元素为\n$$\n(\\mathbf{A}_{\\mathrm{GP}})_{i,i} = -\\frac{2}{h^2}, \\quad (\\mathbf{A}_{\\mathrm{GP}})_{i,i+1} = (\\mathbf{A}_{\\mathrm{GP}})_{i+1,i} = \\frac{1}{h^2}, \\quad i=1,\\dots,N-1,\n$$\n其他元素为零。这对应于对称三对角二阶差分算子，其中均匀 Dirichlet 边界条件通过消除边界值（可解释为带有强边界施加的“鬼点”法）被隐式施加。\n\n2) 同步近似项 (SAT) 罚函数边界闭合：\n- 带有对角范数的分部求和 (SBP) 算子提供了一个离散能量框架。一种用于均匀 Dirichlet 条件的实用对称罚函数闭合方法是，在半离散算子中加入一个与边界值成比例的罚函数项。在与上述网格兼容的纯内部格式中，可以得到一个对称的罚函数修正算子 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau) \\in \\mathbb{R}^{N \\times N}$，定义如下\n$$\n\\mathbf{A}_{\\mathrm{SAT}}(\\tau) = \\mathbf{A}_{\\mathrm{GP}} - \\frac{\\tau}{h^2}\\left(\\mathbf{e}_1 \\mathbf{e}_1^\\top + \\mathbf{e}_N \\mathbf{e}_N^\\top\\right),\n$$\n其中 $\\mathbf{e}_1, \\mathbf{e}_N \\in \\mathbb{R}^{N}$ 是第一个和最后一个标准基向量，$\\tau \\ge 0$ 是一个无量纲的罚函数参数。此罚函数项在边界处弱施加 $u=0$，并且在重铸为纯内部设定时，与针对带对角范数的二阶导数算子的能量稳定 SBP-SAT 框架一致。当 $\\tau = 0$ 时，它简化为 GP-SD 算子。\n\nCFL 与半离散谱：\n- 线方法对于选定的空间算子 $\\mathbf{A}$（其谱包含在 $(-\\infty,0]$ 内）产生半离散系统 $\\mathbf{u}''(t) = c^2 \\mathbf{A}\\, \\mathbf{u}(t)$。考虑标准的显式二阶中心差分时间积分器：\n$$\n\\mathbf{u}^{n+1} - 2 \\mathbf{u}^n + \\mathbf{u}^{n-1} = (c \\Delta t)^2 \\mathbf{A}\\, \\mathbf{u}^n,\n$$\n其中 $\\Delta t$ 是时间步长。对于 $\\mathbf{A}$ 的每个特征值 $\\lambda \\le 0$，如果 $(c \\Delta t)^2 \\lambda \\in [-4,0]$，则标量递推关系是稳定的。因此，最大允许时间步长为\n$$\n\\Delta t_{\\max} = \\frac{2}{c \\sqrt{-\\lambda_{\\min}}},\n$$\n其中 $\\lambda_{\\min}$ 是 $\\mathbf{A}$ 的最负特征值。无量纲 Courant 数定义为 $r = \\frac{c \\Delta t}{h}$，因此\n$$\nr_{\\max} = \\frac{2}{h \\sqrt{-\\lambda_{\\min}}}.\n$$\n\n设计目标：\n- 对于 SAT 罚函数算子 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$，在指定的 $\\tau$ 范围内搜索，以最大化最小负特征值（即从下方最接近 0 的特征值），记为 $\\lambda_{\\mathrm{small}}(\\tau) = \\max\\{\\lambda \\in \\mathrm{spec}(\\mathbf{A}_{\\mathrm{SAT}}(\\tau))\\}$。报告使其最大化的值 $\\tau^\\star$，并使用最负特征值 $\\lambda_{\\min}(\\tau^\\star)$ 计算相应的 CFL 限制的 Courant 数 $r_{\\max}$。\n\n任务：\n- 对于下面的每个测试用例，构造 $\\mathbf{A}_{\\mathrm{GP}}$ 和 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$，计算它们的谱，评估 GP-SD 的 $r_{\\max}$，并对 SAT 执行关于 $\\tau$ 的设计优化，以最大化 $\\lambda_{\\mathrm{small}}(\\tau)$ 并计算 $\\tau^\\star$ 处的 $r_{\\max}$。\n- Courant 数 $r_{\\max}$ 是无量纲的，必须以浮点数形式报告。罚函数参数 $\\tau^\\star$ 是无量纲的，必须以浮点数形式报告。特征值必须以浮点数形式报告。\n- 显式时间积分器的单位是秒；不要直接报告 $\\Delta t$。仅报告 Courant 数 $r_{\\max}$。\n\n测试套件：\n- 使用以下测试用例 $(L, c, N)$，其中 $L$ 的单位是米，$c$ 的单位是米/秒，$N$ 是无量纲的：\n    1. $(1.0, 1.5, 64)$\n    2. $(1.0, 0.8, 8)$\n    3. $(2.0, 2.0, 32)$\n    4. $(1.0, 1.2, 3)$\n- 对于 SAT 优化，在离散集合 $\\{0.0, 0.25, 0.5, 0.75, 1.0, 1.5, 2.0, 3.0, 4.0\\}$ 上搜索 $\\tau$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按以下顺序输出一个包含八个浮点数的嵌套列表：\n$\n\\big[\nr_{\\max}^{\\mathrm{GP}},\\; r_{\\max}^{\\mathrm{SAT}}(\\tau^\\star),\\; \\tau^\\star,\\; \\lambda_{\\min}^{\\mathrm{GP}},\\; \\lambda_{\\min}^{\\mathrm{SAT}}(\\tau^\\star),\\; \\lambda_{\\mathrm{small}}^{\\mathrm{GP}},\\; \\lambda_{\\mathrm{small}}^{\\mathrm{SAT}}(\\tau^\\star),\\; h\n\\big]\n$\n其中 $h$ 是网格间距，单位为米。将四个测试用例的列表聚合到一个外部列表中，例如，\n$[\\,[\\dots],\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$.",
            "solution": "用户提供的问题是数值分析领域一个适定的练习，具体涉及线方法在一维声波方程中的应用。所有参数、定义和目标都陈述清晰、科学合理且数学上一致。该问题是有效的，并存在唯一的、可计算的解。因此，我们将着手提供完整的解答。\n\n该问题要求分析一维声波方程 $u_{tt} = c^2 u_{xx}$ 在区域 $x \\in [0,L]$ 上，带有均匀 Dirichlet 边界条件 $u(0,t)=u(L,t)=0$ 的两种空间离散化方案。分析在线方法框架内进行，其中空间导数首先被离散化，从而产生一个关于时间的常微分方程组 (ODEs)，$\\mathbf{u}''(t) = c^2 \\mathbf{A}\\, \\mathbf{u}(t)$。在这里，$\\mathbf{u}(t) \\in \\mathbb{R}^N$ 是在 $N$ 个内部网格点上的近似解向量，而 $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ 是表示离散化后的二阶空间导数 $u_{xx}$ 的矩阵。\n\n显式二阶中心差分时间积分方案的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定，该条件关联了时间步长 $\\Delta t$、波速 $c$、空间网格间距 $h$ 以及算子 $\\mathbf{A}$ 的谱。该条件要求对于 $\\mathbf{A}$ 的所有特征值 $\\lambda$，都有 $(c \\Delta t)^2 \\lambda \\in [-4,0]$。由于所考虑的算子是对称且负半定的，它们的特征值都是非正的，即 $\\lambda \\le 0$。因此，稳定性条件受到最负特征值 $\\lambda_{\\min}$ 的限制，从而得出最大稳定时间步长 $\\Delta t_{\\max} = \\frac{2}{c \\sqrt{-\\lambda_{\\min}}}$。相应的最大稳定 Courant 数为 $r_{\\max} = \\frac{c \\Delta t_{\\max}}{h} = \\frac{2}{h \\sqrt{-\\lambda_{\\min}}}$。\n\n空间网格是均匀的，有 $N$ 个内部点，定义的网格间距为 $h = \\frac{L}{N+1}$。\n\n我们分析矩阵 $\\mathbf{A}$ 的两种定义。\n\n1.  **鬼点强 Dirichlet (GP-SD) 闭合：** 此方法产生标准的对称三对角矩阵，记为 $\\mathbf{A}_{\\mathrm{GP}}$，它近似了二阶导数。其元素由下式给出：\n    $$\n    (\\mathbf{A}_{\\mathrm{GP}})_{i,j} = \\frac{1}{h^2} \\begin{cases} -2 & \\text{if } i=j \\\\ 1 & \\text{if } |i-j|=1 \\\\ 0 & \\text{otherwise} \\end{cases}\n    $$\n    该矩阵的特征值有解析解：\n    $$\n    \\lambda_k(\\mathbf{A}_{\\mathrm{GP}}) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{k \\pi}{2(N+1)}\\right), \\quad k=1, 2, \\ldots, N.\n    $$\n    最小（最不负）的特征值是 $\\lambda_{\\mathrm{small}}^{\\mathrm{GP}} = \\lambda_1$，最负的特征值是 $\\lambda_{\\min}^{\\mathrm{GP}} = \\lambda_N$。\n\n2.  **同步近似项 (SAT) 罚函数闭合：** 此方法通过添加弱施加边界条件的罚函数项来修改 GP-SD 算子。得到的算子 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$ 定义为：\n    $$\n    \\mathbf{A}_{\\mathrm{SAT}}(\\tau) = \\mathbf{A}_{\\mathrm{GP}} - \\frac{\\tau}{h^2}\\left(\\mathbf{e}_1 \\mathbf{e}_1^\\top + \\mathbf{e}_N \\mathbf{e}_N^\\top\\right),\n    $$\n    其中 $\\tau \\ge 0$ 是一个无量纲罚函数参数，$\\mathbf{e}_1, \\mathbf{e}_N$ 是第一个和最后一个标准基向量。此修改仅改变 $\\mathbf{A}_{\\mathrm{GP}}$ 的第一个和最后一个对角元素，使其变为 $(\\mathbf{A}_{\\mathrm{SAT}})_{1,1} = (\\mathbf{A}_{\\mathrm{SAT}})_{N,N} = -\\frac{2+\\tau}{h^2}$。\n\n主要目标是一项设计任务：对于每个测试用例，我们必须从指定的离散集合中找到 $\\tau$ 的值，记为 $\\tau^\\star$，该值能最大化 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$ 的最大特征值（原文为 smallest (least negative) eigenvalue，即最不负的特征值），我们将其记为 $\\lambda_{\\mathrm{small}}(\\tau) = \\max \\mathrm{spec}(\\mathbf{A}_{\\mathrm{SAT}}(\\tau))$。\n\n我们来分析罚函数项的影响。对于 $\\tau \\ge 0$，矩阵 $\\mathbf{P} = \\frac{\\tau}{h^2}(\\mathbf{e}_1\\mathbf{e}_1^\\top + \\mathbf{e}_N\\mathbf{e}_N^\\top)$ 是半正定的。算子为 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau) = \\mathbf{A}_{\\mathrm{GP}} - \\mathbf{P}$。根据关于对称矩阵和的特征值的 Weyl 不等式，$\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$ 的特征值（记为 $\\lambda_k(\\tau)$）受 $\\mathbf{A}_{\\mathrm{GP}}$ 的特征值（记为 $\\lambda_k(0)$）的限制：\n$$\n\\lambda_k(0) + \\lambda_{\\min}(-\\mathbf{P}) \\le \\lambda_k(\\tau) \\le \\lambda_k(0) + \\lambda_{\\max}(-\\mathbf{P}).\n$$\n$-\\mathbf{P}$ 的特征值为 $-\\frac{\\tau}{h^2}$（重数为 2）和 $0$（重数为 $N-2$）。因此，$\\lambda_{\\min}(-\\mathbf{P}) = -\\frac{\\tau}{h^2}$ 且 $\\lambda_{\\max}(-\\mathbf{P}) = 0$。将此应用于最大特征值 $\\lambda_{\\mathrm{small}}$，我们发现：\n$$\n\\lambda_{\\mathrm{small}}^{\\mathrm{GP}} - \\frac{\\tau}{h^2} \\le \\lambda_{\\mathrm{small}}^{\\mathrm{SAT}}(\\tau) \\le \\lambda_{\\mathrm{small}}^{\\mathrm{GP}}.\n$$\n这个不等式表明，对于任何 $\\tau > 0$，SAT 算子的最大特征值将小于或等于 GP-SD 算子的最大特征值。函数 $\\lambda_{\\mathrm{small}}(\\tau)$ 是非增的。因此，它在 $\\tau \\ge 0$ 上的最大值必然出现在 $\\tau=0$ 处。\n\n因此，对于所有测试用例，优化过程预计将得出 $\\tau^\\star = 0$。这意味着在最优 $\\tau^\\star$ 处的 SAT 算子与 GP-SD 算子相同，即 $\\mathbf{A}_{\\mathrm{SAT}}(0) = \\mathbf{A}_{\\mathrm{GP}}$，并且它们所有派生的量都将相同。算法将执行指定的搜索以数值方式确认这一结论。\n\n该解是通过遍历每个测试用例 $(L, c, N)$ 来实现的。对于每个用例：\n1.  计算网格间距 $h = L/(N+1)$。\n2.  构造 $N \\times N$ 矩阵 $\\mathbf{A}_{\\mathrm{GP}}$。\n3.  使用数值线性代数程序计算其特征值。这些特征值的最小值和最大值分别给出 $\\lambda_{\\min}^{\\mathrm{GP}}$ 和 $\\lambda_{\\mathrm{small}}^{\\mathrm{GP}}$。\n4.  计算 $r_{\\max}^{\\mathrm{GP}} = 2 / (h \\sqrt{-\\lambda_{\\min}^{\\mathrm{GP}}})$。\n5.  遍历指定的 $\\tau$ 值集合。对于每个 $\\tau$：\n    a. 构造矩阵 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau)$。\n    b. 计算其特征值并找到 $\\lambda_{\\mathrm{small}}(\\tau)$。\n6.  将产生最大 $\\lambda_{\\mathrm{small}}(\\tau)$ 的 $\\tau$ 值确定为 $\\tau^\\star$。\n7.  使用为 $\\mathbf{A}_{\\mathrm{SAT}}(\\tau^\\star)$ 计算的谱，确定 $\\lambda_{\\min}^{\\mathrm{SAT}}(\\tau^\\star)$ 和 $\\lambda_{\\mathrm{small}}^{\\mathrm{SAT}}(\\tau^\\star)$。\n8.  计算 $r_{\\max}^{\\mathrm{SAT}}(\\tau^\\star) = 2 / (h \\sqrt{-\\lambda_{\\min}^{\\mathrm{SAT}}(\\tau^\\star)})$。\n9.  收集并格式化八个所需的浮点数：$r_{\\max}^{\\mathrm{GP}}$、 $r_{\\max}^{\\mathrm{SAT}}(\\tau^\\star)$、 $\\tau^\\star$、 $\\lambda_{\\min}^{\\mathrm{GP}}$、 $\\lambda_{\\min}^{\\mathrm{SAT}}(\\tau^\\star)$、 $\\lambda_{\\mathrm{small}}^{\\mathrm{GP}}$、 $\\lambda_{\\mathrm{small}}^{\\mathrm{SAT}}(\\tau^\\star)$ 和 $h$。\n\n最终输出是所有测试用例结果的聚合，形式为列表的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite, analyzing GP-SD and SAT\n    discretizations for the 1D wave equation.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (L, c, N)\n    test_cases = [\n        (1.0, 1.5, 64),\n        (1.0, 0.8, 8),\n        (2.0, 2.0, 32),\n        (1.0, 1.2, 3),\n    ]\n\n    # Set of penalty parameters to search over\n    tau_search_set = [0.0, 0.25, 0.5, 0.75, 1.0, 1.5, 2.0, 3.0, 4.0]\n\n    all_results = []\n    \n    for case in test_cases:\n        L, c, N = case\n        h = L / (N + 1)\n        h_sq = h**2\n\n        # 1. GP-SD Analysis\n        # Construct the A_GP matrix\n        main_diag_gp = -2.0 / h_sq * np.ones(N)\n        off_diag_gp = 1.0 / h_sq * np.ones(N - 1)\n        A_gp = np.diag(main_diag_gp) + np.diag(off_diag_gp, k=1) + np.diag(off_diag_gp, k=-1)\n\n        # Compute eigenvalues for the symmetric matrix A_GP\n        eigvals_gp = np.linalg.eigvalsh(A_gp)\n        # All eigenvalues are negative or zero, so min() is most negative\n        lambda_min_gp = np.min(eigvals_gp)\n        # max() is least negative (closest to zero)\n        lambda_small_gp = np.max(eigvals_gp)\n        \n        # Calculate r_max for GP-SD\n        if lambda_min_gp  0:\n            r_max_gp = 2.0 / (h * np.sqrt(-lambda_min_gp))\n        else: # Should not happen for N > 0\n            r_max_gp = np.inf\n            \n        # 2. SAT Optimization\n        best_tau = -1.0\n        max_lambda_small = -np.inf\n        \n        # Variables to store the results for the optimal tau_star\n        lambda_min_sat_star = 0.0\n        lambda_small_sat_star = 0.0\n        r_max_sat_star = 0.0\n\n        for tau in tau_search_set:\n            # Construct the A_SAT(tau) matrix\n            A_sat = np.copy(A_gp)\n            penalty = tau / h_sq\n            A_sat[0, 0] -= penalty\n            A_sat[N - 1, N - 1] -= penalty\n            \n            # Compute eigenvalues for the symmetric matrix A_SAT\n            eigvals_sat = np.linalg.eigvalsh(A_sat)\n            current_lambda_small = np.max(eigvals_sat)\n            \n            # Check if this tau maximizes lambda_small\n            if current_lambda_small > max_lambda_small:\n                max_lambda_small = current_lambda_small\n                best_tau = tau\n                \n                # Store the results for this new best tau\n                lambda_min_sat_star = np.min(eigvals_sat)\n                lambda_small_sat_star = max_lambda_small\n                if lambda_min_sat_star  0:\n                    r_max_sat_star = 2.0 / (h * np.sqrt(-lambda_min_sat_star))\n                else: # Should not happen\n                    r_max_sat_star = np.inf\n        \n        # Assemble the 8 required values for this test case\n        case_results = [\n            r_max_gp,\n            r_max_sat_star,\n            best_tau,\n            lambda_min_gp,\n            lambda_min_sat_star,\n            lambda_small_gp,\n            lambda_small_sat_star,\n            h,\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # Construct the output string manually to match the required format\n    # e.g., [[val1,val2,...],[val1,val2,...]] without extra spaces.\n    outer_list_str = ','.join([f\"[{','.join(map(str, inner_list))}]\" for inner_list in all_results])\n    print(f\"[{outer_list_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的练习转向双曲守恒律问题，这类问题常常伴随着标准线性格式难以处理的陡峭梯度或激波。本练习分步详解了五阶加权基本不振荡（WENO）格式的核心机制，这是解决此类挑战性问题的强大工具。通过计算给定数据集的非线性权，您将具体地洞察WENO格式如何自适应地调整其模板以保持精度并避免振荡 。",
            "id": "3617085",
            "problem": "考虑一维线性守恒律 $\\partial_{t} q(x,t) + \\partial_{x} f\\!\\big(q(x,t)\\big) = 0$，其通量为 $f(q) = a\\,q$，其中 $a0$ 为常数，该方程模拟了地球物理流中无量纲标量属性的平流。使用有限体积法中的线方法（MOL），记 $Q_{i}(t)$ 为 $q$ 在均匀单元 $[x_{i-1/2}, x_{i+1/2}]$ 上的单元平均值，因此半离散演化满足 $\\frac{d Q_{i}}{d t} = -\\frac{1}{\\Delta x}\\big(F_{i+1/2} - F_{i-1/2}\\big)$，其中 $F_{i+1/2}$ 是在单元面 $x_{i+1/2}$ 处的相容数值通量。对于 $a0$，一个迎风相容的选择是 $F_{i+1/2} = a\\,q^{-}_{i+1/2}$，其中 $q^{-}_{i+1/2}$ 是从单元平均值重构的左偏单元面值。\n\n从上述守恒格式和在光滑区域要求五阶精度的要求出发，在有限体积框架下，通过在三个候选模板 $\\{i-2,i-1,i\\}$、$\\{i-1,i,i+1\\}$ 和 $\\{i,i+1,i+2\\}$ 中的每一个上，构造一个其单元平均值与模板中各单元上的 $\\{Q_{j}\\}$ 相匹配的多项式，然后在 $x_{i+1/2}$ 处对这些多项式求值，来推导五阶加权基本无振荡（WENO）单元面值 $q^{-}_{i+1/2}$。使用 Jiang–Shu 非线性权系数公式，其中幂 $p=2$，小参数 $\\epsilon0$，并且选择线性权系数以在光滑区域恢复五阶最优线性格式。\n\n对于间距恒为 $\\Delta x$ 的均匀网格，假设在时间 $t=t_{0}$ 时的局部单元平均值为\n$Q_{i-2} = 1.000$， $Q_{i-1} = 1.100$， $Q_{i} = 1.200$， $Q_{i+1} = 1.300$， $Q_{i+2} = 1.400$，\n并取用于在 $x_{i+1/2}$ 处进行左偏重构的 Jiang–Shu 线性权系数为 $d_{0} = \\frac{1}{10}$， $d_{1} = \\frac{6}{10}$， $d_{2} = \\frac{3}{10}$，其中 $\\epsilon = 10^{-6}$ 且 $p=2$。\n\n进行候选单元面值和光滑度指示子的推导，计算此数据集上的非线性权系数，然后计算将用于数值通量中的重构左偏单元面值 $q^{-}_{i+1/2}$。将最终答案表示为实数，并将结果四舍五入至六位有效数字。变量 $q$ 是无量纲的；报告最终重构的单元面值 $q^{-}_{i+1/2}$，不带单位。",
            "solution": "用户提供的问题经过严格审查，确认其有效。其科学基础在于偏微分方程数值方法的既定理论，特别是针对双曲守恒律的有限体积加权基本无振荡（WENO）方法。该问题是适定的，为求解唯一且有意义的解提供了所有必要的数据、定义和常数。其语言客观而精确。因此，有必要提供完整解。\n\n目标是使用提供的单元平均值数据 $\\{Q_j\\}$，计算在单元交界面 $x_{i+1/2}$ 处的五阶 WENO 重构值 $q^{-}_{i+1/2}$。该过程包括几个步骤：在较小的模板上计算候选重构，为这些模板计算光滑度指示子，形成非线性权系数，最后使用这些权系数组合候选重构。\n\n五阶重构使用一个五点模板 $\\{i-2, i-1, i, i+1, i+2\\}$。这被分解为三个三点候选模板：\n$S_0 = \\{x_{i-2}, x_{i-1}, x_i\\}$\n$S_1 = \\{x_{i-1}, x_i, x_{i+1}\\}$\n$S_2 = \\{x_i, x_{i+1}, x_{i+2}\\}$\n\n**步骤 1：计算候选单元面值**\n对于每个模板 $S_k$，隐式构造一个二次多项式 $p_k(x)$，使其在该模板上的单元平均值与给定的 $Q_j$ 相匹配。然后，在交界面 $x_{i+1/2}$ 处对这些多项式求值，从而为重构得到三个候选值，记为 $q^{(k)}_{i+1/2}$。这些候选值用单元平均值表示的标准公式是：\n$$q^{(0)}_{i+1/2} = \\frac{1}{3}Q_{i-2} - \\frac{7}{6}Q_{i-1} + \\frac{11}{6}Q_{i}$$\n$$q^{(1)}_{i+1/2} = -\\frac{1}{6}Q_{i-1} + \\frac{5}{6}Q_{i} + \\frac{1}{3}Q_{i+1}$$\n$$q^{(2)}_{i+1/2} = \\frac{1}{3}Q_{i} + \\frac{5}{6}Q_{i+1} - \\frac{1}{6}Q_{i+2}$$\n给定的单元平均值数据为：$Q_{i-2} = 1.000$，$Q_{i-1} = 1.100$，$Q_{i} = 1.200$，$Q_{i+1} = 1.300$，$Q_{i+2} = 1.400$。\n代入这些值：\n$q^{(0)}_{i+1/2} = \\frac{1}{3}(1.000) - \\frac{7}{6}(1.100) + \\frac{11}{6}(1.200) = \\frac{2.000 - 7.700 + 13.200}{6} = \\frac{7.500}{6} = 1.250$\n$q^{(1)}_{i+1/2} = -\\frac{1}{6}(1.100) + \\frac{5}{6}(1.200) + \\frac{1}{3}(1.300) = \\frac{-1.100 + 6.000 + 2.600}{6} = \\frac{7.500}{6} = 1.250$\n$q^{(2)}_{i+1/2} = \\frac{1}{3}(1.200) + \\frac{5}{6}(1.300) - \\frac{1}{6}(1.400) = \\frac{2.400 + 6.500 - 1.400}{6} = \\frac{7.500}{6} = 1.250$\n该数据对应于线性函数 $q(x)$ 的单元平均值，对于该函数，所有二次重构都是精确的。因此，所有候选值都相同，且等于 $q(x)$ 在 $x_{i+1/2}$ 处的精确值。\n\n**步骤 2：计算光滑度指示子**\n光滑度指示子 $\\beta_k$ 用于衡量解在每个模板 $S_k$ 上的光滑性。对于五阶格式，Jiang-Shu 公式给出了以下表达式：\n$$\\beta_0 = \\frac{13}{12}(Q_{i-2} - 2Q_{i-1} + Q_i)^2 + \\frac{1}{4}(Q_{i-2} - 4Q_{i-1} + 3Q_i)^2$$\n$$\\beta_1 = \\frac{13}{12}(Q_{i-1} - 2Q_i + Q_{i+1})^2 + \\frac{1}{4}(Q_{i-1} - Q_{i+1})^2$$\n$$\\beta_2 = \\frac{13}{12}(Q_i - 2Q_{i+1} + Q_{i+2})^2 + \\frac{1}{4}(3Q_i - 4Q_{i+1} + Q_{i+2})^2$$\n我们根据给定数据计算必要的差分：\n$Q_{i-2} - 2Q_{i-1} + Q_i = 1.000 - 2(1.100) + 1.200 = 0$\n$Q_{i-1} - 2Q_i + Q_{i+1} = 1.100 - 2(1.200) + 1.300 = 0$\n$Q_i - 2Q_{i+1} + Q_{i+2} = 1.200 - 2(1.300) + 1.400 = 0$\n这些项代表二阶差分，对于线性数据，其值为零。对于其余项：\n$Q_{i-2} - 4Q_{i-1} + 3Q_i = 1.000 - 4(1.100) + 3(1.200) = 1.000 - 4.400 + 3.600 = 0.200$\n$Q_{i-1} - Q_{i+1} = 1.100 - 1.300 = -0.200$\n$3Q_i - 4Q_{i+1} + Q_{i+2} = 3(1.200) - 4(1.300) + 1.400 = 3.600 - 5.200 + 1.400 = -0.200$\n将这些值代入 $\\beta_k$ 的公式中：\n$\\beta_0 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(0.200)^2 = \\frac{1}{4}(0.04) = 0.01$\n$\\beta_1 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-0.200)^2 = \\frac{1}{4}(0.04) = 0.01$\n$\\beta_2 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-0.200)^2 = \\frac{1}{4}(0.04) = 0.01$\n因此，所有三个光滑度指示子都相等：$\\beta_0 = \\beta_1 = \\beta_2 = 0.01$。\n\n**步骤 3：计算非线性权系数**\n非线性权系数 $\\omega_k$ 由光滑度指示子 $\\beta_k$、理想线性权系数 $d_k$、小参数 $\\epsilon$ 和幂 $p$ 计算得出。问题给出了 $d_0 = \\frac{1}{10}$，$d_1 = \\frac{6}{10}$，$d_2 = \\frac{3}{10}$，$\\epsilon = 10^{-6}$，以及 $p=2$。\n首先，计算未归一化的权系数 $\\alpha_k$：\n$$\\alpha_k = \\frac{d_k}{(\\epsilon + \\beta_k)^p}$$\n然后，归一化的权系数 $\\omega_k$ 为：\n$$\\omega_k = \\frac{\\alpha_k}{\\sum_{j=0}^{2} \\alpha_j}$$\n对于我们的数据，$\\beta_0 = \\beta_1 = \\beta_2 = 0.01$。令 $\\beta = 0.01$。每个 $\\alpha_k$ 的分母都相同：\n$(\\epsilon + \\beta)^p = (10^{-6} + 0.01)^2 = (0.010001)^2$。\n所以，我们有：\n$\\alpha_0 = \\frac{d_0}{(0.010001)^2} = \\frac{0.1}{(0.010001)^2}$\n$\\alpha_1 = \\frac{d_1}{(0.010001)^2} = \\frac{0.6}{(0.010001)^2}$\n$\\alpha_2 = \\frac{d_2}{(0.010001)^2} = \\frac{0.3}{(0.010001)^2}$\n总和为 $\\sum_{j=0}^{2} \\alpha_j = \\frac{d_0+d_1+d_2}{(0.010001)^2} = \\frac{0.1+0.6+0.3}{(0.010001)^2} = \\frac{1}{(0.010001)^2}$。\n非线性权系数为：\n$\\omega_0 = \\frac{\\alpha_0}{\\sum \\alpha_j} = \\frac{d_0 / (0.010001)^2}{1 / (0.010001)^2} = d_0 = 0.1$\n$\\omega_1 = \\frac{\\alpha_1}{\\sum \\alpha_j} = \\frac{d_1 / (0.010001)^2}{1 / (0.010001)^2} = d_1 = 0.6$\n$\\omega_2 = \\frac{\\alpha_2}{\\sum \\alpha_j} = \\frac{d_2 / (0.010001)^2}{1 / (0.010001)^2} = d_2 = 0.3$\n这展示了 WENO 的一个关键特性：在非常光滑的区域，当光滑度指示子几乎相等时，非线性权系数 $\\omega_k$ 接近最优线性权系数 $d_k$，从而恢复了底层线性格式的高阶精度。\n\n**步骤 4：计算最终的重构值**\n最终的重构值是使用非线性权系数对候选值进行的加权平均：\n$$q^{-}_{i+1/2} = \\sum_{k=0}^{2} \\omega_k q^{(k)}_{i+1/2}$$\n代入计算出的值：\n$q^{-}_{i+1/2} = \\omega_0 q^{(0)}_{i+1/2} + \\omega_1 q^{(1)}_{i+1/2} + \\omega_2 q^{(2)}_{i+1/2}$\n$q^{-}_{i+1/2} = (0.1)(1.250) + (0.6)(1.250) + (0.3)(1.250)$\n$q^{-}_{i+1/2} = (0.1 + 0.6 + 0.3) \\times 1.250 = (1.0) \\times 1.250 = 1.250$\n结果恰好是 $1.25$。按要求，四舍五入到六位有效数字得到 $1.25000$。",
            "answer": "$$\\boxed{1.25000}$$"
        }
    ]
}