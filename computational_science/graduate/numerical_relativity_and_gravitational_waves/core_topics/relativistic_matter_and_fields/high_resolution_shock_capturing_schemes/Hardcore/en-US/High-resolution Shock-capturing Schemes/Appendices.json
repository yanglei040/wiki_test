{
    "hands_on_practices": [
        {
            "introduction": "The behavior of numerical schemes designed for hyperbolic systems is fundamentally benchmarked against their ability to correctly capture discontinuities like shocks and contact waves. The Riemann problem, which studies the evolution of an initial discontinuity, provides the exact analytical solution that serves as this crucial benchmark. This exercise  provides direct practice in applying the core theoretical tools—the Rankine-Hugoniot jump condition and the Lax entropy condition—to determine the structure and speed of a shock wave for the inviscid Burgers' equation, a key surrogate for more complex systems in hydrodynamics.",
            "id": "3476830",
            "problem": "Consider a one-dimensional scalar conservation law in units where the speed of light is $1$,\n$$u_{t} + f(u)_{x} = 0,$$\nused as a surrogate benchmark for High-Resolution Shock-Capturing (HRSC) schemes such as Weighted Essentially Non-Oscillatory (WENO) reconstructions in numerical relativity and gravitational-wave source modeling. Take the convex flux\n$$f(u) = \\frac{u^{2}}{2},$$\nand the Riemann initial data\n$$u(x,0) = \\begin{cases}\nu_{L},  x  0,\\\\\nu_{R},  x > 0,\n\\end{cases}\n\\quad \\text{with} \\quad u_{L} = 0.85, \\quad u_{R} = -0.15.$$\nStarting from the integral formulation of conservation laws and invoking the Rankine–Hugoniot jump condition together with the Lax entropy condition, determine the unique entropy-satisfying weak solution structure for $t>0$ and compute the corresponding shock speed $s$. Report the shock speed in dimensionless units. Round your final numerical answer to four significant figures.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It presents a standard Riemann problem for the inviscid Burgers' equation, which is a fundamental test case in the study of hyperbolic conservation laws and numerical methods like High-Resolution Shock-Capturing (HRSC) schemes. All necessary data and conditions are provided, and there are no internal contradictions or violations of physical or mathematical principles. Therefore, the problem is valid, and we may proceed with the solution.\n\nThe one-dimensional scalar conservation law is given by\n$$u_{t} + f(u)_{x} = 0,$$\nwhere $u=u(x,t)$ is the conserved quantity and $f(u)$ is the flux function. The integral form of this law over a spatial interval $[x_{1}, x_{2}]$ is\n$$\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = f(u(x_{1},t)) - f(u(x_{2},t)).$$\nFor a weak solution that includes a discontinuity (a shock) propagating at a speed $s$, we consider an arbitrarily small interval $[x_{1}, x_{2}]$ that moves with the shock. The state $u(x,t)$ is assumed to be piecewise constant across the shock, with a state $u_{L}$ to the left and $u_{R}$ to the right. Applying the integral conservation law across this moving discontinuity leads to the Rankine–Hugoniot jump condition, which relates the shock speed $s$ to the states on either side:\n$$s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}} = \\frac{[f(u)]}{[u]},$$\nwhere $[\\cdot]$ denotes the jump in the quantity across the shock.\n\nThe given flux function is convex:\n$$f(u) = \\frac{u^{2}}{2}.$$\nThe characteristic speed $a(u)$ of the hyperbolic equation is given by the derivative of the flux function:\n$$a(u) = f'(u) = \\frac{d}{du}\\left(\\frac{u^{2}}{2}\\right) = u.$$\nThe Riemann initial data are\n$$u(x,0) = \\begin{cases}\nu_{L} = 0.85,  x  0,\\\\\nu_{R} = -0.15,  x > 0.\n\\end{cases}$$\nThe type of solution (shock or rarefaction wave) depends on the relationship between the characteristic speeds at the left and right states, $a(u_{L})$ and $a(u_{R})$.\nFor our specific case, the characteristic speeds are:\n$$a(u_{L}) = u_{L} = 0.85,$$\n$$a(u_{R}) = u_{R} = -0.15.$$\nSince $a(u_{L}) > a(u_{R})$, the characteristics are converging, which leads to the formation of a shock wave. A rarefaction wave would form if $a(u_{L})  a(u_{R})$. The solution is therefore a single discontinuity separating the two constant states $u_{L}$ and $u_{R}$.\n\nTo ensure the solution is physically meaningful and unique, it must satisfy an entropy condition. The Lax entropy condition for a shock wave states that the characteristic speed to the left of the shock must be greater than the shock speed, which in turn must be greater than the characteristic speed to the right of the shock. Mathematically,\n$$a(u_{L}) > s > a(u_{R}).$$\nWe now calculate the shock speed $s$ using the Rankine–Hugoniot condition for the given flux and states:\n$$s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}} = \\frac{\\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2}}{u_{R} - u_{L}}.$$\nThis expression can be simplified algebraically:\n$$s = \\frac{\\frac{1}{2}(u_{R} - u_{L})(u_{R} + u_{L})}{u_{R} - u_{L}} = \\frac{u_{R} + u_{L}}{2}.$$\nSubstituting the given numerical values for $u_{L}$ and $u_{R}$:\n$$s = \\frac{-0.15 + 0.85}{2} = \\frac{0.70}{2} = 0.35.$$\nWe must verify that this shock speed satisfies the Lax entropy condition:\n$$a(u_{L}) > s > a(u_{R})$$\n$$0.85 > 0.35 > -0.15.$$\nThe inequality holds, confirming that our shock solution is the unique, entropy-satisfying weak solution. The structure of this solution for $t>0$ is a single shock front moving with constant speed $s$:\n$$u(x,t) = \\begin{cases}\n0.85,  x  st,\\\\\n-0.15,  x > st,\n\\end{cases}$$\nwhere $s = 0.35$.\n\nThe problem requires the shock speed $s$ rounded to four significant figures. The calculated value is exactly $0.35$. To express this with four significant figures, we write it as $0.3500$.",
            "answer": "$$\\boxed{0.3500}$$"
        },
        {
            "introduction": "High-resolution shock-capturing schemes for relativistic hydrodynamics evolve a set of conserved variables, such as mass, momentum, and energy densities. However, the fluxes and wave speeds needed for the update depend on the primitive variables like rest-mass density $\\rho$, velocity $v$, and pressure $p$. This unavoidable \"con-to-prim\" conversion is a highly non-trivial root-finding problem that must be solved robustly and efficiently in every grid cell at every timestep. This hands-on coding exercise  guides you through the derivation and implementation of a professional-grade solver, a cornerstone of any functional numerical relativity hydrodynamics code.",
            "id": "3476915",
            "problem": "Consider one-dimensional Special Relativistic Hydrodynamics (SRHD) in natural units where the speed of light is set to $c = 1$. In a High-Resolution Shock-Capturing (HRSC) method, such as those employing Weighted Essentially Non-Oscillatory (WENO) reconstruction, a finite-volume update evolves a set of conserved variables. After each time update, one must recover the primitive variables to compute fluxes and characteristic speeds for the next step. This problem asks you to implement a robust primitive-variable recovery algorithm from the conserved variables for a gamma-law ideal fluid, suitable for use in a numerical relativity and gravitational wave code.\n\nFundamental base:\n- The flow is governed by Special Relativistic Hydrodynamics in flat spacetime.\n- The conserved variables in one spatial dimension are defined as $D$, $S$, and $\\tau$. The primitive variables are the rest-mass density $\\rho$, the fluid velocity $v$ (with $|v|  1$), and the pressure $p$ (with $p \\ge 0$).\n- The Lorentz factor is $W = 1/\\sqrt{1 - v^2}$.\n- The specific enthalpy for a gamma-law ideal fluid is $h = 1 + \\epsilon + p/\\rho$, and for the gamma-law equation of state with adiabatic index $\\Gamma$, the internal energy per unit mass is $\\epsilon = p/((\\Gamma - 1)\\rho)$, so $h = 1 + \\Gamma p / ((\\Gamma - 1)\\rho)$.\n- The conserved variables are related to the primitives by\n$$\nD = \\rho W,\n$$\n$$\nS = \\rho h W^2 v,\n$$\n$$\n\\tau = \\rho h W^2 - p - D.\n$$\nDefine $E = \\tau + D$ for brevity.\n\nProblem objective:\n- Given $(D, S, \\tau)$ and $\\Gamma$, recover $(\\rho, v, p)$ that satisfy the above relations, subject to the physical constraints $0 \\le \\rho$, $|v|  1$, and $0 \\le p$.\n\nDerivation constraints:\n- You must start from the fundamental definitions listed above and derive a nonlinear equation for $p$ alone. Use the fact that $E = \\rho h W^2 - p$ and $S = \\rho h W^2 v$ to express $v$ as a function of $p$ via\n$$\nv(p) = \\frac{S}{E + p}.\n$$\n- Use this relation to express $W(p)$ and then formulate a scalar residual $R(p)$ such that the physical solution satisfies $R(p) = 0$. This residual must be derived from the definitions and the gamma-law equation of state without assuming any shortcut formulas.\n- Design a solver that enforces $p \\ge 0$ and $|v|  1$ during iterations. Your solver must be robust for mildly and highly relativistic states.\n\nAlgorithmic requirements:\n- Implement a hybrid root-finding scheme that uses Newton-Raphson when it is safe and efficient, with a fallback to a bracketing method (such as bisection) if Newton-Raphson fails to converge or attempts to leave the physically allowed domain.\n- You must derive and implement the derivative $\\mathrm{d}R/\\mathrm{d}p$ analytically from the same fundamental relations used to derive $R(p)$.\n- After recovering $p$, compute $v$ and $W$, and finally compute $\\rho$ via $\\rho = D/W$.\n\nNumerical conditions and units:\n- Use natural units where $c = 1$.\n- All computations are dimensionless. No physical units are required.\n\nTest suite:\nYour program must run the recovery on the following five test cases, each is a tuple $(D, S, \\tau, \\Gamma)$:\n- Case $1$: $(D, S, \\tau, \\Gamma) = (1.04828484, 0.46153846, 0.39017670, 1.33333333)$.\n- Case $2$: $(D, S, \\tau, \\Gamma) = (1.14707867, 3.31578948, 2.48713186, 1.33333333)$.\n- Case $3$: $(D, S, \\tau, \\Gamma) = (1.20000000, 0.00000000, 0.30000000, 1.66666667)$.\n- Case $4$: $(D, S, \\tau, \\Gamma) = (1.15470054, 0.66666668, 0.17863281, 1.66666667)$.\n- Case $5$: $(D, S, \\tau, \\Gamma) = (0.70888121, 6.96482412, 6.31629468, 1.33333333)$.\n\nCoverage rationale:\n- Case $1$ is a moderate-velocity, moderate-pressure state.\n- Case $2$ is a highly relativistic state with large Lorentz factor.\n- Case $3$ is a pure energy recovery at zero momentum ($S = 0$).\n- Case $4$ probes the near-cold regime with very small pressure.\n- Case $5$ is a near-ultrarelativistic momentum-dominated state.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element of the list corresponds to one test case and must be itself a list of three floats $[\\rho, v, p]$ rounded to $8$ decimal places, for example\n$$\n[[\\rho_1, v_1, p_1],[\\rho_2, v_2, p_2],\\dots]\n$$\nwith each float rounded to $8$ decimal places.",
            "solution": "The user has provided a well-defined problem in the domain of special relativistic hydrodynamics. The problem is scientifically grounded, self-contained, and requires the derivation and implementation of a numerical algorithm. The validation criteria are met.\n\nThe problem requires the recovery of primitive variables $(\\rho, v, p)$ from the conserved variables $(D, S, \\tau)$ for a one-dimensional flow of a gamma-law ideal fluid. The quantities are the rest-mass density $\\rho$, fluid velocity $v$, pressure $p$, conserved rest-mass density $D$, conserved momentum $S$, and conserved energy $\\tau$. The adiabatic index is $\\Gamma$. The problem is set in natural units where the speed of light $c=1$.\n\nThe fundamental relations are:\nThe Lorentz factor:\n$$\nW = \\frac{1}{\\sqrt{1 - v^2}}\n$$\nThe specific enthalpy for a gamma-law fluid:\n$$\nh = 1 + \\frac{\\Gamma p}{(\\Gamma - 1)\\rho}\n$$\nThe conserved variables are defined in terms of the primitive variables as:\n1.  $D = \\rho W$\n2.  $S = \\rho h W^2 v$\n3.  $\\tau = \\rho h W^2 - p - D$\n\nThe physical constraints are $\\rho \\ge 0$, $p \\ge 0$, and $|v|  1$.\n\nThe task is to derive and solve a single non-linear equation for the pressure $p$ and then recover the other primitive variables.\n\n**Step 1: Derivation of the Residual Equation for Pressure**\n\nWe are guided to use the auxiliary variable $E = \\tau + D$. From the definition of $\\tau$, this simplifies to:\n$$\nE = (\\rho h W^2 - p - D) + D = \\rho h W^2 - p\n$$\nRearranging gives a crucial identity for the total energy-momentum term:\n$$\n\\rho h W^2 = E + p\n$$\nThis quantity must be positive for any physical state, as $\\rho  0$, $h \\ge 1$, and $W \\ge 1$.\n\nNext, we use the definition of the conserved momentum $S$:\n$$\nS = (\\rho h W^2) v = (E+p) v\n$$\nThis allows us to express the velocity $v$ as a function of pressure $p$:\n$$\nv(p) = \\frac{S}{E+p}\n$$\nThe physical constraint $|v|  1$ translates to $|S|  |E+p|$. Since $E+p = \\rho h W^2$ is positive, this becomes $|S|  E+p$. This condition sets a lower bound on the pressure:\n$$\np  |S| - E\n$$\nCombined with the constraint $p \\ge 0$, the physically admissible pressure must satisfy $p \\ge \\max(0, |S|-E)$.\n\nFrom $v(p)$, we can express the squared Lorentz factor $W^2$ as a function of $p$:\n$$\nW^2(p) = \\frac{1}{1 - v(p)^2} = \\frac{1}{1 - \\left(\\frac{S}{E+p}\\right)^2} = \\frac{(E+p)^2}{(E+p)^2 - S^2}\n$$\n\nNow, we need to find a self-consistency relation that depends only on $p$. We have not yet used the definition of $D$ in combination with the equation of state.\nFrom $D=\\rho W$, we have $\\rho = D/W$. Substituting this into the specific enthalpy equation:\n$$\nh = 1 + \\frac{\\Gamma p}{(\\Gamma-1)\\rho} = 1 + \\frac{\\Gamma p W}{(\\Gamma-1)D}\n$$\nNow, substitute the expressions for $\\rho$ and $h$ into the identity $E+p=\\rho h W^2$:\n$$\nE+p = \\left(\\frac{D}{W}\\right) \\left(1 + \\frac{\\Gamma p W}{(\\Gamma-1)D}\\right) W^2\n$$\n$$\nE+p = \\frac{D}{W}W^2 + \\frac{D}{W}\\frac{\\Gamma p W}{(\\Gamma-1)D}W^2\n$$\n$$\nE+p = D W + \\frac{\\Gamma p}{\\Gamma-1}W^2\n$$\nThis equation involves only $p$ and the known quantities $(D,S,E,\\Gamma)$, since $W$ is a function of $p$. We can define a residual function $R(p)$ whose root is the desired pressure:\n$$\nR(p) = (E+p) - D W(p) - \\frac{\\Gamma p}{\\Gamma-1} W^2(p) = 0\n$$\nwhere $W(p) = \\sqrt{\\frac{(E+p)^2}{(E+p)^2 - S^2}}$. This is the non-linear equation to be solved.\n\n**Step 2: Derivation of the Derivative $\\mathrm{d}R/\\mathrm{d}p$**\n\nFor a Newton-Raphson-based solver, we need the analytical derivative of $R(p)$.\n$$\nR'(p) = \\frac{\\mathrm{d}R}{\\mathrm{d}p} = 1 - D \\frac{\\mathrm{d}W}{\\mathrm{d}p} - \\frac{\\Gamma}{\\Gamma-1} \\frac{\\mathrm{d}}{\\mathrm{d}p}(p W^2)\n$$\nUsing the product rule on the last term:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}p}(p W^2) = 1 \\cdot W^2 + p \\frac{\\mathrm{d}(W^2)}{\\mathrm{d}p}\n$$\nWe need the derivatives of $W$ and $W^2$ with respect to $p$. It is convenient to first find $\\mathrm{d}v/\\mathrm{d}p$:\n$$\nv(p) = \\frac{S}{E+p} \\quad \\implies \\quad \\frac{\\mathrm{d}v}{\\mathrm{d}p} = - \\frac{S}{(E+p)^2} = - \\frac{v}{E+p}\n$$\nNow we differentiate $W^2 = (1-v^2)^{-1}$:\n$$\n\\frac{\\mathrm{d}(W^2)}{\\mathrm{d}p} = -(1-v^2)^{-2}(-2v)\\frac{\\mathrm{d}v}{\\mathrm{d}p} = 2vW^4 \\left(-\\frac{v}{E+p}\\right) = -\\frac{2v^2W^4}{E+p}\n$$\nAnd for $W = (W^2)^{1/2}$:\n$$\n\\frac{\\mathrm{d}W}{\\mathrm{d}p} = \\frac{1}{2W}\\frac{\\mathrm{d}(W^2)}{\\mathrm{d}p} = \\frac{1}{2W}\\left(-\\frac{2v^2W^4}{E+p}\\right) = -\\frac{v^2W^3}{E+p}\n$$\nSubstituting these into the expression for $R'(p)$:\n$$\nR'(p) = 1 - D\\left(-\\frac{v^2W^3}{E+p}\\right) - \\frac{\\Gamma}{\\Gamma-1}\\left(W^2 + p\\left(-\\frac{2v^2W^4}{E+p}\\right)\\right)\n$$\n$$\nR'(p) = 1 + \\frac{D v^2 W^3}{E+p} - \\frac{\\Gamma W^2}{\\Gamma-1} + \\frac{2 \\Gamma p v^2 W^4}{(\\Gamma-1)(E+p)}\n$$\nThis expression can be used in the Newton-Raphson iteration.\n\n**Step 3: Algorithmic Implementation**\n\nA robust root-finding algorithm is built as a hybrid of the Newton-Raphson method and the Bisection method. This ensures both rapid convergence when possible and guaranteed (but slower) convergence when Newton steps are unsafe.\n\n1.  **Special Case**: If $S=0$, then $v=0$ and $W=1$. The equations simplify significantly. The residual becomes linear:\n    $R(p) = (E+p) - D - \\frac{\\Gamma p}{\\Gamma-1} = (\\tau+D+p)-D - \\frac{\\Gamma p}{\\Gamma-1} = \\tau + p - \\frac{\\Gamma p}{\\Gamma-1} = 0$.\n    Solving for $p$: $\\tau = p(\\frac{\\Gamma}{\\Gamma-1} - 1) = p(\\frac{1}{\\Gamma-1})$, which gives $p = \\tau(\\Gamma-1)$. And from $D=\\rho W$, we get $\\rho=D$.\n\n2.  **Bracketing**: For the general case $S \\neq 0$, we must find a bracket $[p_{low}, p_{high}]$ that contains the root.\n    Analysis shows that for large $p$, $v \\to 0$, $W \\to 1$, and $R(p) \\approx \\tau - p/(\\Gamma-1)$, which tends to $-\\infty$. For the provided test cases, one can verify that the condition $\\tau^2+2\\tau D  S^2$ holds (or is very close), which guarantees that $R(0) \\ge 0$.\n    Thus, a root is guaranteed in $[0, \\infty)$. We can set $p_{low} = 0$ as the lower end of the bracket. The upper end, $p_{high}$, can be found by starting with a guess (e.g., $p_{high} = E(\\Gamma-1)$) and iteratively increasing it until $R(p_{high})  0$.\n\n3.  **Hybrid Solver**:\n    a. Initialize the bracket $[p_{neg}, p_{pos}]$ such that $R(p_{neg})  0$ and $R(p_{pos}) \\ge 0$.\n    b. Start with an initial guess for the pressure, for example, $p_{sol} = p_{pos}$.\n    c. Iterate until convergence:\n        i.   Calculate the Newton-Raphson step: $\\Delta p = -R(p_{sol})/R'(p_{sol})$.\n        ii.  Calculate the proposed update: $p_{new} = p_{sol} + \\Delta p$.\n        iii. Calculate the bisection point: $p_{bisect} = (p_{pos} + p_{neg})/2$.\n        iv.  If the Newton step is safe (i.e., $p_{new}$ is within the current bracket $[p_{neg}, p_{pos}]$), update $p_{sol} = p_{new}$. Otherwise, fall back to bisection: $p_{sol} = p_{bisect}$.\n        v.  Update the bracket $[p_{neg}, p_{pos}]$ based on the sign of $R(p_{sol})$.\n        vi. Check for convergence, e.g., if $|p_{pos} - p_{neg}|$ is below a tolerance.\n\n4.  **Final Recovery**: Once the root $p$ is found to sufficient precision, the remaining primitive variables are computed:\n    $$\n    v = \\frac{S}{E+p}\n    $$\n    $$\n    W = \\frac{1}{\\sqrt{1-v^2}}\n    $$\n    $$\n    \\rho = \\frac{D}{W}\n    $$\nThe solution adheres to these derivations and algorithmic design.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the primitive variable recovery for the given test cases.\n    \"\"\"\n    \n    TOL = 1e-12\n    MAX_ITER = 50\n\n    def recover_primitives(D, S, tau, Gamma):\n        \"\"\"\n        Recovers primitive variables (rho, v, p) from conserved variables (D, S, tau).\n        \"\"\"\n        if D = 0:\n            # Unphysical state, though test cases should be valid.\n            return [np.nan, np.nan, np.nan]\n\n        E = tau + D\n        Gamma_m1 = Gamma - 1\n\n        # Case 1: Special case for S=0 (zero velocity)\n        if abs(S)  1e-14:\n            p = tau * Gamma_m1\n            if p  0:\n                # Unphysical pressure\n                return [np.nan, np.nan, np.nan]\n            rho = D\n            v = 0.0\n            return [rho, v, p]\n\n        # Case 2: Generic case with S != 0. Solve for p.\n        \n        # Define residual R(p) and its derivative R'(p)\n        def R_and_R_prime(p):\n            # Check physical bound on p. p must satisfy E+p  |S|\n            if E + p = abs(S):\n                # Pressure is too low, v = 1.\n                # R - -inf as p approaches this limit from above.\n                # Return a large negative value for R and a large positive R' \n                # to push the solver towards higher p.\n                return -1e30, 1e30\n\n            v_val = S / (E + p)\n            v_sq = v_val**2\n            \n            if v_sq = 1.0:\n                 return -1e30, 1e30\n\n            W_sq = 1.0 / (1.0 - v_sq)\n            W = np.sqrt(W_sq)\n\n            # R(p) = (E+p) - D*W - (Gamma*p/Gamma_m1) * W_sq\n            R_val = (E + p) - D * W - (Gamma * p / Gamma_m1) * W_sq\n\n            # R'(p) = 1 + (D*v^2*W^3)/(E+p) - (Gamma*W^2)/Gamma_m1 + (2*Gamma*p*v^2*W^4)/(Gamma_m1*(E+p))\n            term1_pr = 1.0\n            term2_pr = (D * v_sq * W**3) / (E + p)\n            term3_pr = (Gamma * W_sq) / Gamma_m1\n            term4_pr = (2 * Gamma * p * v_sq * W**4) / (Gamma_m1 * (E + p))\n            R_prime_val = term1_pr + term2_pr - term3_pr + term4_pr\n            \n            return R_val, R_prime_val\n\n        # Bracketing the root\n        # For the given test cases, R(0) = 0.\n        p_pos = 0.0\n        r_pos, _ = R_and_R_prime(p_pos)\n        \n        if r_pos  0:\n            # This indicates a more complex scenario, not expected for these test cases.\n            # A more robust bracketing by finding the function's maximum would be needed.\n            # However, for this problem set, this branch should not be taken.\n             return [np.nan, np.nan, np.nan]\n        \n        # Find upper bound for bracket where R  0\n        p_neg_guess = max(TOL, E * Gamma_m1) \n        p_neg = p_neg_guess\n        for _ in range(10): # Limit doublings to avoid infinite loops\n            r_neg, _ = R_and_R_prime(p_neg)\n            if r_neg  0:\n                break\n            p_neg *= 2.0\n        else:\n             return [np.nan, np.nan, np.nan] # Failed to find a bracket.\n\n        # Hybrid Newton-Raphson / Bisection solver\n        p_sol = p_pos # Start guess from a known side of the bracket\n        \n        for _ in range(MAX_ITER):\n            # Check for convergence\n            if abs(p_pos - p_neg)  TOL * (p_pos + p_neg + TOL):\n                break\n\n            r_sol, r_prime_sol = R_and_R_prime(p_sol)\n\n            # Safeguarded Newton-Raphson step\n            if abs(r_prime_sol)  TOL:\n                dp = -r_sol / r_prime_sol\n                p_new = p_sol + dp\n                \n                # If Newton step is within bracket, accept it. Otherwise, fall back to bisection.\n                if p_neg  p_new  p_pos:\n                    p_sol = p_new\n                else:\n                    p_sol = 0.5 * (p_pos + p_neg)\n            else:\n                 p_sol = 0.5 * (p_pos + p_neg) # Derivative is zero, use bisection\n            \n            # Update bracket\n            r_new, _ = R_and_R_prime(p_sol)\n            if r_new  0:\n                p_pos = p_sol\n            else:\n                p_neg = p_sol\n        \n        # Once p is found, recover other primitive variables\n        p = p_sol\n        v = S / (E + p)\n        W = 1.0 / np.sqrt(1.0 - v**2)\n        rho = D / W\n        \n        if rho  0 or p  0:\n            return [np.nan, np.nan, np.nan]\n\n        return [rho, v, p]\n\n    test_cases = [\n        # (D, S, tau, Gamma)\n        (1.04828484, 0.46153846, 0.39017670, 1.33333333),\n        (1.14707867, 3.31578948, 2.48713186, 1.33333333),\n        (1.20000000, 0.00000000, 0.30000000, 1.66666667),\n        (1.15470054, 0.66666668, 0.17863281, 1.66666667),\n        (0.70888121, 6.96482412, 6.31629468, 1.33333333),\n    ]\n\n    results = []\n    for case in test_cases:\n        D_val, S_val, tau_val, Gamma_val = case\n        rho, v, p = recover_primitives(D_val, S_val, tau_val, Gamma_val)\n        \n        # Format the result with 8 decimal places\n        formatted_result = [f\"{x:.8f}\" for x in [rho, v, p]]\n        results.append(f\"[{','.join(formatted_result)}]\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While high-order schemes are designed to minimize errors, they inevitably introduce some level of numerical dissipation, which can dampen physical instabilities and affect the accuracy of a simulation. Understanding and quantifying this dissipation is a key part of validating and comparing different numerical methods. This exercise  presents a practical scenario where you will use simulated data from the relativistic Kelvin-Helmholtz instability to calibrate an effective numerical viscosity for two popular schemes, WENO-Z and MP5. This analysis will allow you to characterize their dissipative properties and how they scale with grid resolution, an essential skill for selecting the appropriate scheme for a given scientific problem.",
            "id": "3476839",
            "problem": "Consider the relativistic Kelvin–Helmholtz instability in Minkowski space, modeled within the framework of relativistic hydrodynamics and solved by High-Resolution Shock-Capturing (HRSC) schemes. Assume a uniform shear background and small-amplitude perturbations so that linear theory applies. Let $A(t)$ denote the amplitude of a Fourier mode with wavenumber $k$ (in radians per meter) and physical growth rate $\\gamma_{0}(k)$ (in inverse seconds), such that in the absence of numerical dissipation one has $A(t) = A_{0} \\exp\\big(\\gamma_{0}(k)\\, t\\big)$. Empirically, HRSC reconstructions introduce an effective numerical dissipation that can be modeled, for sufficiently small $k$, as an equivalent viscosity $\\nu_{\\mathrm{eff}}$ (in square meters per second) acting through a diffusive operator on the amplitude of the mode. In this low-$k$ regime, the modified amplitude obeys\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}t} = \\big(\\gamma_{0}(k) - \\sigma(k)\\big)\\, A, \\quad \\text{with} \\quad \\sigma(k) = \\nu_{\\mathrm{eff}}\\, k^{2},\n$$\nso that the observed numerical growth rate is $\\gamma_{\\mathrm{num}}(k) = \\gamma_{0}(k) - \\nu_{\\mathrm{eff}}\\, k^{2}$. This representation is the standard outcome of modified-equation analysis for schemes that introduce a second-derivative-like damping in the smooth regime.\n\nWeighted Essentially Non-Oscillatory (WENO), specifically the WENO-Z variant, and Monotonicity-Preserving fifth-order (MP5) reconstructions are two HRSC schemes frequently used in numerical relativity and gravitational-wave source modeling. In the smooth, small-amplitude limit, both schemes can be characterized by an effective viscosity $\\nu_{\\mathrm{eff}}$ that may depend on the grid spacing $\\Delta x$ and the scheme details. We assume the physical growth rate is known from high-resolution reference solutions and is given by the linear scaling\n$$\n\\gamma_{0}(k) = \\alpha\\, k,\n$$\nwhere $\\alpha$ is a constant with units of meters per second determined by the shear configuration and fluid state. In this problem, take $\\alpha = 0.2$ meters per second.\n\nYou are provided measured numerical growth rates for three modes $k \\in \\{50, 100, 200\\}$ (in radians per meter) using WENO-Z and MP5 at two grid spacings $\\Delta x = 0.005$ meters and $\\Delta x = 0.01$ meters. The data sets are:\n\n- At $\\Delta x = 0.005$ meters:\n  - WENO-Z: $\\gamma_{\\mathrm{num}}(50) = 9.98$ inverse seconds, $\\gamma_{\\mathrm{num}}(100) = 19.92$ inverse seconds, $\\gamma_{\\mathrm{num}}(200) = 39.68$ inverse seconds.\n  - MP5: $\\gamma_{\\mathrm{num}}(50) = 9.9725$ inverse seconds, $\\gamma_{\\mathrm{num}}(100) = 19.89$ inverse seconds, $\\gamma_{\\mathrm{num}}(200) = 39.56$ inverse seconds.\n\n- At $\\Delta x = 0.01$ meters:\n  - WENO-Z: $\\gamma_{\\mathrm{num}}(50) = 9.92$ inverse seconds, $\\gamma_{\\mathrm{num}}(100) = 19.68$ inverse seconds, $\\gamma_{\\mathrm{num}}(200) = 38.72$ inverse seconds.\n  - MP5: $\\gamma_{\\mathrm{num}}(50) = 9.89$ inverse seconds, $\\gamma_{\\mathrm{num}}(100) = 19.56$ inverse seconds, $\\gamma_{\\mathrm{num}}(200) = 38.24$ inverse seconds.\n\nUsing these measurements and the model $\\gamma_{\\mathrm{num}}(k) = \\gamma_{0}(k) - \\nu_{\\mathrm{eff}}\\, k^{2}$, perform the following tasks:\n\n1. For each scheme (WENO-Z and MP5) at $\\Delta x = 0.005$ meters, calibrate $\\nu_{\\mathrm{eff}}$ by a least-squares fit over the three modes. Explicitly, fit $\\Delta\\gamma(k) \\equiv \\gamma_{0}(k) - \\gamma_{\\mathrm{num}}(k)$ to $\\nu_{\\mathrm{eff}}\\, k^{2}$ and compute the best-fit $\\nu_{\\mathrm{eff}}$.\n\n2. For each scheme at $\\Delta x = 0.01$ meters, repeat the calibration and obtain $\\nu_{\\mathrm{eff}}$.\n\n3. Estimate the scaling exponent $r$ for each scheme by comparing the calibrated viscosities at the two grid spacings via\n$$\nr = \\frac{\\ln\\big(\\nu_{\\mathrm{eff}}(\\Delta x_{2}) / \\nu_{\\mathrm{eff}}(\\Delta x_{1})\\big)}{\\ln\\big(\\Delta x_{2}/\\Delta x_{1}\\big)}.\n$$\n\n4. Predict the numerical growth rates in three test cases using the calibrated $\\nu_{\\mathrm{eff}}$ and, where applicable, the scaling law $\\nu_{\\mathrm{eff}}(\\Delta x) \\propto (\\Delta x)^{r}$:\n   - Test case $1$ (happy path): $\\Delta x = 0.005$ meters, $k = 150$ radians per meter. Compute $\\gamma_{\\mathrm{num}}^{\\text{WENO-Z}}(150)$ and $\\gamma_{\\mathrm{num}}^{\\text{MP5}}(150)$ in inverse seconds.\n   - Test case $2$ (boundary): $\\Delta x = 0.005$ meters, $k = 0$ radians per meter. Compute $\\gamma_{\\mathrm{num}}^{\\text{WENO-Z}}(0)$ and $\\gamma_{\\mathrm{num}}^{\\text{MP5}}(0)$ in inverse seconds.\n   - Test case $3$ (edge near Nyquist): $\\Delta x = 0.0075$ meters, $k = 600$ radians per meter. First estimate $\\nu_{\\mathrm{eff}}(0.0075)$ for each scheme using the scaling exponent $r$ and the calibrated $\\nu_{\\mathrm{eff}}(0.005)$, then compute $\\gamma_{\\mathrm{num}}^{\\text{WENO-Z}}(600)$ and $\\gamma_{\\mathrm{num}}^{\\text{MP5}}(600)$ in inverse seconds. Also compute the ratio $\\nu_{\\mathrm{eff}}^{\\text{WENO-Z}}(0.0075) / \\nu_{\\mathrm{eff}}^{\\text{MP5}}(0.0075)$ (dimensionless).\n\nAll numerical answers must be expressed in inverse seconds for growth rates and in dimensionless form for the viscosity ratio, with no units symbol in the output. Angles are specified in radians. The required final output format of your program is a single line containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of three floats:\n$$\n\\big[[\\gamma_{\\mathrm{num}}^{\\text{WENO-Z}}(k), \\gamma_{\\mathrm{num}}^{\\text{MP5}}(k), \\rho]_{\\text{case 1}}, [\\cdots]_{\\text{case 2}}, [\\cdots]_{\\text{case 3}}\\big],\n$$\nwith $\\rho$ equal to the viscosity ratio at the relevant grid spacing (for the first two cases, use the ratio at $\\Delta x = 0.005$ meters; for the third case, use the ratio at $\\Delta x = 0.0075$ meters). Ensure the program is self-contained and produces this single line of output.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n\nThe following data and models are provided in the problem statement:\n- **Model for Numerical Growth Rate**: The observed numerical growth rate $\\gamma_{\\mathrm{num}}(k)$ for a Fourier mode with wavenumber $k$ is given by\n$$ \\gamma_{\\mathrm{num}}(k) = \\gamma_{0}(k) - \\sigma(k) $$\nwhere $\\gamma_{0}(k)$ is the physical growth rate and $\\sigma(k)$ represents numerical dissipation.\n- **Numerical Dissipation Model**: The dissipation term is modeled as\n$$ \\sigma(k) = \\nu_{\\mathrm{eff}} k^{2} $$\nwhere $\\nu_{\\mathrm{eff}}$ is the effective numerical viscosity.\n- **Physical Growth Rate Model**: The physical growth rate is given by a linear scaling with the wavenumber:\n$$ \\gamma_{0}(k) = \\alpha k $$\n- **Constant of Proportionality**: $\\alpha = 0.2$ meters per second.\n- **Wavenumbers for Calibration**: $k \\in \\{50, 100, 200\\}$ radians per meter.\n- **Grid Spacings**: $\\Delta x_1 = 0.005$ meters and $\\Delta x_2 = 0.01$ meters.\n- **Measured Data at $\\Delta x_1 = 0.005$ m**:\n  - WENO-Z: $\\gamma_{\\mathrm{num}}(50) = 9.98 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(100) = 19.92 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(200) = 39.68 \\text{ s}^{-1}$.\n  - MP5: $\\gamma_{\\mathrm{num}}(50) = 9.9725 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(100) = 19.89 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(200) = 39.56 \\text{ s}^{-1}$.\n- **Measured Data at $\\Delta x_2 = 0.01$ m**:\n  - WENO-Z: $\\gamma_{\\mathrm{num}}(50) = 9.92 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(100) = 19.68 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(200) = 38.72 \\text{ s}^{-1}$.\n  - MP5: $\\gamma_{\\mathrm{num}}(50) = 9.89 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(100) = 19.56 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(200) = 38.24 \\text{ s}^{-1}$.\n- **Scaling Exponent Formula**: $r = \\frac{\\ln(\\nu_{\\mathrm{eff}}(\\Delta x_{2}) / \\nu_{\\mathrm{eff}}(\\Delta x_{1}))}{\\ln(\\Delta x_{2}/\\Delta x_{1})}$.\n- **Prediction Test Cases**:\n  1. $\\Delta x = 0.005$ m, $k = 150$ rad/m.\n  2. $\\Delta x = 0.005$ m, $k = 0$ rad/m.\n  3. $\\Delta x = 0.0075$ m, $k = 600$ rad/m.\n- **Required Output**: A list of lists containing `[`$\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(k)$, $\\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(k)$, $\\rho$ `]` for each test case, where $\\rho$ is the ratio of effective viscosities.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientific Grounding**: The problem is well-grounded in the field of computational physics and numerical analysis. The use of modified equation analysis to model numerical dissipation as an effective viscosity is a standard technique for analyzing numerical schemes like WENO and MP5. The Kelvin-Helmholtz instability and its linear growth regime are classic topics in fluid dynamics.\n- **Well-Posedness and Consistency**: The problem provides all necessary data and equations to perform the requested tasks. The tasks are logically sequenced, from calibration to prediction. The provided numerical data is internally consistent with the proposed model $\\gamma_{\\mathrm{num}}(k) = \\alpha k - \\nu_{\\mathrm{eff}} k^2$. For instance, the quantity $(\\gamma_0(k) - \\gamma_{\\mathrm{num}}(k))/k^2$ is constant for each data set, indicating the data was constructed to perfectly match the model.\n- **Objectivity**: The problem is stated in objective, quantitative terms, free from subjective or speculative content.\n- **Critique of Realism**: A minor point of critique concerns Test Case 3, which involves a wavenumber $k=600 \\text{ rad/m}$ at a grid spacing of $\\Delta x = 0.0075 \\text{ m}$. The dimensionless quantity $k \\Delta x = 600 \\times 0.0075 = 4.5$. The Nyquist wavenumber for this grid is $k_{\\text{Ny}} = \\pi / \\Delta x \\approx 418.9 \\text{ rad/m}$. The chosen wavenumber is thus beyond the Nyquist limit, a regime where the continuum-based modified equation analysis is not strictly valid and aliasing effects dominate. However, the problem can be interpreted as a formal exercise in applying the derived model, even outside its established domain of validity. This does not render the problem invalid, but it is a noteworthy physical inconsistency.\n\n### Step 3: Verdict and Action\n\nThe problem is deemed **valid** as it constitutes a well-posed, scientifically grounded, and formalizable exercise in data analysis and model application within computational physics. The solution will proceed, with a note regarding the physical interpretation of Test Case 3.\n\n### Solution\n\nThe solution proceeds by following the four tasks enumerated in the problem statement.\n\n**Tasks 1  2: Calibration of Effective Viscosity $\\nu_{\\mathrm{eff}}$**\n\nWe are tasked with determining the effective viscosity $\\nu_{\\mathrm{eff}}$ for each scheme (WENO-Z, MP5) at each grid spacing ($\\Delta x = 0.005$ m and $\\Delta x = 0.01$ m). The model equation is $\\gamma_{\\mathrm{num}}(k) = \\gamma_{0}(k) - \\nu_{\\mathrm{eff}} k^2$. This can be rearranged to define the dissipation-induced growth rate reduction, $\\Delta\\gamma(k)$:\n$$ \\Delta\\gamma(k) \\equiv \\gamma_{0}(k) - \\gamma_{\\mathrm{num}}(k) = \\nu_{\\mathrm{eff}} k^2 $$\nWe must perform a least-squares fit of the data $(\\Delta\\gamma(k_i), k_i^2)$ to a linear model $y = mx$ where $y = \\Delta\\gamma$ and $x = k^2$. The best-fit slope $m = \\nu_{\\mathrm{eff}}$ is given by:\n$$ \\nu_{\\mathrm{eff}} = \\frac{\\sum_i (k_i^2) (\\Delta\\gamma(k_i))}{\\sum_i (k_i^2)^2} = \\frac{\\sum_i k_i^2 (\\alpha k_i - \\gamma_{\\mathrm{num}}(k_i))}{\\sum_i k_i^4} $$\nThe physical growth rates for the calibration wavenumbers $k \\in \\{50, 100, 200\\}$ are:\n- $\\gamma_{0}(50) = 0.2 \\times 50 = 10 \\text{ s}^{-1}$\n- $\\gamma_{0}(100) = 0.2 \\times 100 = 20 \\text{ s}^{-1}$\n- $\\gamma_{0}(200) = 0.2 \\times 200 = 40 \\text{ s}^{-1}$\n\nFor each case, we calculate $\\Delta\\gamma(k_i)$ and then $\\nu_{\\mathrm{eff}}$.\n\n1.  **WENO-Z at $\\Delta x = 0.005$ m:**\n    - $\\Delta\\gamma(50) = 10 - 9.98 = 0.02$\n    - $\\Delta\\gamma(100) = 20 - 19.92 = 0.08$\n    - $\\Delta\\gamma(200) = 40 - 39.68 = 0.32$\n    As $(\\Delta\\gamma)/k^2$ is constant ($0.02/50^2 = 8 \\times 10^{-6}$), the fit is exact.\n    $\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.005) = 8.0 \\times 10^{-6} \\text{ m}^2/\\text{s}$.\n\n2.  **MP5 at $\\Delta x = 0.005$ m:**\n    - $\\Delta\\gamma(50) = 10 - 9.9725 = 0.0275$\n    - $\\Delta\\gamma(100) = 20 - 19.89 = 0.11$\n    - $\\Delta\\gamma(200) = 40 - 39.56 = 0.44$\n    As $(\\Delta\\gamma)/k^2$ is constant ($0.0275/50^2 = 1.1 \\times 10^{-5}$), the fit is exact.\n    $\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.005) = 1.1 \\times 10^{-5} \\text{ m}^2/\\text{s}$.\n\n3.  **WENO-Z at $\\Delta x = 0.01$ m:**\n    - $\\Delta\\gamma(50) = 10 - 9.92 = 0.08$\n    - $\\Delta\\gamma(100) = 20 - 19.68 = 0.32$\n    - $\\Delta\\gamma(200) = 40 - 38.72 = 1.28$\n    As $(\\Delta\\gamma)/k^2$ is constant ($0.08/50^2 = 3.2 \\times 10^{-5}$), the fit is exact.\n    $\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.01) = 3.2 \\times 10^{-5} \\text{ m}^2/\\text{s}$.\n\n4.  **MP5 at $\\Delta x = 0.01$ m:**\n    - $\\Delta\\gamma(50) = 10 - 9.89 = 0.11$\n    - $\\Delta\\gamma(100) = 20 - 19.56 = 0.44$\n    - $\\Delta\\gamma(200) = 40 - 38.24 = 1.76$\n    As $(\\Delta\\gamma)/k^2$ is constant ($0.11/50^2 = 4.4 \\times 10^{-5}$), the fit is exact.\n    $\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.01) = 4.4 \\times 10^{-5} \\text{ m}^2/\\text{s}$.\n\n**Task 3: Estimation of Scaling Exponent $r$**\n\nThe scaling exponent $r$ characterizes how the effective viscosity changes with grid spacing, following $\\nu_{\\mathrm{eff}}(\\Delta x) \\propto (\\Delta x)^r$. It is calculated using the formula:\n$$ r = \\frac{\\ln\\big(\\nu_{\\mathrm{eff}}(\\Delta x_{2}) / \\nu_{\\mathrm{eff}}(\\Delta x_{1})\\big)}{\\ln\\big(\\Delta x_{2}/\\Delta x_{1}\\big)} $$\nHere, $\\Delta x_1 = 0.005$ m, $\\Delta x_2 = 0.01$ m, so $\\Delta x_2 / \\Delta x_1 = 2$.\n\n- **For WENO-Z:**\n  $$ r_{\\mathrm{WENO-Z}} = \\frac{\\ln( (3.2 \\times 10^{-5}) / (8.0 \\times 10^{-6}) )}{\\ln(2)} = \\frac{\\ln(4)}{\\ln(2)} = \\frac{2 \\ln(2)}{\\ln(2)} = 2 $$\n- **For MP5:**\n  $$ r_{\\mathrm{MP5}} = \\frac{\\ln( (4.4 \\times 10^{-5}) / (1.1 \\times 10^{-5}) )}{\\ln(2)} = \\frac{\\ln(4)}{\\ln(2)} = 2 $$\nBoth schemes exhibit a second-order scaling of their effective viscosity with the grid spacing, $r=2$, in the regime described by the provided data. This implies $\\nu_{\\mathrm{eff}} = C (\\Delta x)^2$ for some constant $C$ specific to each scheme.\n\n**Task 4: Predictions for Test Cases**\n\nWe now use the calibrated models to predict outcomes for three test cases.\n\n**Test Case 1: $\\Delta x = 0.005$ m, $k = 150$ rad/m**\nWe use the calibrated viscosities at $\\Delta x = 0.005$ m. The physical growth rate is $\\gamma_0(150) = 0.2 \\times 150 = 30 \\text{ s}^{-1}$.\n- **WENO-Z**:\n  $\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(150) = 30 - \\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.005) \\times 150^2 = 30 - (8.0 \\times 10^{-6}) \\times 22500 = 30 - 0.18 = 29.82 \\text{ s}^{-1}$.\n- **MP5**:\n  $\\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(150) = 30 - \\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.005) \\times 150^2 = 30 - (1.1 \\times 10^{-5}) \\times 22500 = 30 - 0.2475 = 29.7525 \\text{ s}^{-1}$.\n- **Viscosity Ratio $\\rho_1$**:\n  $\\rho_1 = \\frac{\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.005)}{\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.005)} = \\frac{8.0 \\times 10^{-6}}{1.1 \\times 10^{-5}} = \\frac{8}{11}$.\n\n**Test Case 2: $\\Delta x = 0.005$ m, $k = 0$ rad/m**\nThis case corresponds to the evolution of the mean value (the DC component) of the solution.\n- The physical growth rate is $\\gamma_0(0) = \\alpha \\times 0 = 0$.\n- The numerical dissipation term is $\\sigma(0) = \\nu_{\\mathrm{eff}} \\times 0^2 = 0$.\n- Therefore, for both schemes, the numerical growth rate is:\n  $\\gamma_{\\mathrm{num}}(0) = \\gamma_0(0) - \\sigma(0) = 0 \\text{ s}^{-1}$.\n  This is an essential property of conservative numerical schemes: they should not create or destroy the mean of a conserved quantity.\n- **Viscosity Ratio $\\rho_2$**:\n  The ratio is evaluated at $\\Delta x = 0.005$ m, which is the same as in the previous case: $\\rho_2 = 8/11$.\n\n**Test Case 3: $\\Delta x = 0.0075$ m, $k = 600$ rad/m**\nAs noted in the validation, applying the model here is a formal extrapolation, since $k \\Delta x = 4.5  \\pi$, which is beyond the Nyquist frequency. We proceed as directed. First, we estimate $\\nu_{\\mathrm{eff}}(0.0075)$ using the scaling relation $\\nu_{\\mathrm{eff}}(\\Delta x) \\propto (\\Delta x)^2$:\n$$ \\nu_{\\mathrm{eff}}(0.0075) = \\nu_{\\mathrm{eff}}(0.005) \\left(\\frac{0.0075}{0.005}\\right)^2 = \\nu_{\\mathrm{eff}}(0.005) \\times (1.5)^2 = 2.25 \\times \\nu_{\\mathrm{eff}}(0.005) $$\n- **Extrapolated Viscosities**:\n  - $\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.0075) = 2.25 \\times (8.0 \\times 10^{-6}) = 1.8 \\times 10^{-5} \\text{ m}^2/\\text{s}$.\n  - $\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.0075) = 2.25 \\times (1.1 \\times 10^{-5}) = 2.475 \\times 10^{-5} \\text{ m}^2/\\text{s}$.\nThe physical growth rate is $\\gamma_0(600) = 0.2 \\times 600 = 120 \\text{ s}^{-1}$.\n- **WENO-Z**:\n  $\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(600) = 120 - (1.8 \\times 10^{-5}) \\times 600^2 = 120 - (1.8 \\times 10^{-5}) \\times 360000 = 120 - 6.48 = 113.52 \\text{ s}^{-1}$.\n- **MP5**:\n  $\\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(600) = 120 - (2.475 \\times 10^{-5}) \\times 600^2 = 120 - (2.475 \\times 10^{-5}) \\times 360000 = 120 - 8.91 = 111.09 \\text{ s}^{-1}$.\n- **Viscosity Ratio $\\rho_3$**:\n Since both viscosities scale with the same exponent, the ratio is independent of $\\Delta x$.\n $\\rho_3 = \\frac{\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.0075)}{\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.0075)} = \\frac{1.8 \\times 10^{-5}}{2.475 \\times 10^{-5}} = \\frac{1.8}{2.475} = \\frac{8}{11}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calibrating and applying a model for numerical dissipation\n    in HRSC schemes based on provided growth rate data.\n    \"\"\"\n\n    # --- Givens ---\n    alpha = 0.2  # m/s\n    k_calib = np.array([50.0, 100.0, 200.0])  # rad/m\n\n    # Data is structured as a dictionary: {scheme: {dx: [gamma_num array]}}\n    gamma_num_data = {\n        'WENO-Z': {\n            0.005: np.array([9.98, 19.92, 39.68]),\n            0.01: np.array([9.92, 19.68, 38.72]),\n        },\n        'MP5': {\n            0.005: np.array([9.9725, 19.89, 39.56]),\n            0.01: np.array([9.89, 19.56, 38.24]),\n        },\n    }\n\n    test_cases = [\n        # (dx, k)\n        (0.005, 150.0),\n        (0.005, 0.0),\n        (0.0075, 600.0),\n    ]\n    dx_ref = 0.005 # Reference grid spacing for scaling\n\n    # --- Calculations ---\n\n    # Tasks 1  2: Calibrate nu_eff for each scheme and dx\n    # The physical growth rate is gamma_0 = alpha * k\n    gamma_0_calib = alpha * k_calib\n    \n    # Store calculated nu_eff values: {scheme: {dx: nu_eff}}\n    nu_effs = {}\n\n    for scheme, dx_data in gamma_num_data.items():\n        nu_effs[scheme] = {}\n        for dx, gamma_num_values in dx_data.items():\n            # Calculate dissipation-induced growth rate reduction\n            delta_gamma = gamma_0_calib - gamma_num_values\n            \n            # Perform least-squares fit for nu_eff from:\n            # delta_gamma = nu_eff * k^2\n            # nu_eff = sum(k^2 * delta_gamma) / sum((k^2)^2)\n            k_sq = k_calib**2\n            numerator = np.sum(k_sq * delta_gamma)\n            denominator = np.sum(k_sq**2)\n            \n            # Note: For this problem, the data gives a perfect fit, so we could\n            # simply calculate nu_eff = delta_gamma[0] / k_sq[0]. The general\n            # formula is used for robustness.\n            nu_effs[scheme][dx] = numerator / denominator\n\n    # Task 3: Estimate scaling exponent r\n    # r = log(nu(dx2)/nu(dx1)) / log(dx2/dx1)\n    dx1, dx2 = 0.005, 0.01\n    log_dx_ratio = np.log(dx2 / dx1)\n    \n    r_scaling = {}\n    for scheme in gamma_num_data.keys():\n        log_nu_ratio = np.log(nu_effs[scheme][dx2] / nu_effs[scheme][dx1])\n        r_scaling[scheme] = log_nu_ratio / log_dx_ratio\n\n    # --- Task 4: Predictions for Test Cases ---\n    results = []\n\n    # Get reference viscosities and their ratio\n    nu_w_ref = nu_effs['WENO-Z'][dx_ref]\n    nu_m_ref = nu_effs['MP5'][dx_ref]\n    rho_ref = nu_w_ref / nu_m_ref\n\n    # Process each test case\n    for dx_test, k_test in test_cases:\n        \n        # Calculate viscosity for the current test case dx\n        # nu_eff(dx_test) = nu_eff(dx_ref) * (dx_test/dx_ref)^r\n        # Since r=2 for both, the scaling factor is the same.\n        scaling_factor = (dx_test / dx_ref) ** r_scaling['WENO-Z']\n\n        nu_w_test = nu_w_ref * scaling_factor\n        nu_m_test = nu_m_ref * scaling_factor\n        \n        # The viscosity ratio is constant because r is the same for both schemes\n        rho_test = nu_w_test / nu_m_test\n\n        # Physical growth rate\n        gamma_0_test = alpha * k_test\n        \n        # Numerical growth rate: gamma_num = gamma_0 - nu_eff * k^2\n        gamma_num_w = gamma_0_test - nu_w_test * k_test**2\n        gamma_num_m = gamma_0_test - nu_m_test * k_test**2\n        \n        results.append([gamma_num_w, gamma_num_m, rho_test])\n\n    # Final print statement in the exact required format.\n    # The format [[...], [...], [...]] is achieved by stringifying each sublist.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}