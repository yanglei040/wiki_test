{
    "hands_on_practices": [
        {
            "introduction": "状态方程是致密物质的核心物理输入，而声速是其关键属性，决定了物质的“刚度”。本练习将指导您从基本的热力学恒等式出发，通过对一个给定的声速剖面（此处为常数声速，$c_s^2 = \\text{const}$）进行积分，来解析地构建一个完整的中子星物质状态方程。这个过程是理解唯象状态方程构建方法的基础，并深刻揭示了压强$P$、能量密度$\\varepsilon$和声速$c_s^2$之间的内在联系。",
            "id": "3473683",
            "problem": "在用于模拟双中子星并合引力波的数值相对论中，通常需要一个适用于致密核物质的冷、正压状态方程 (EoS)。考虑零温下的冷物质，其被建模为单组分重子流体，由重子数密度 $n_{B}$、压强 $P$、能量密度 $\\varepsilon$ 和重子化学势 $\\mu$ 来表征。相对论声速的平方定义为 $c_s^2 = \\partial P / \\partial \\varepsilon$（在固定组分下）。对于冷物质，基本热力学恒等式意味着 $d\\varepsilon = \\mu \\, dn_B$ 和 $P = n_B \\mu - \\varepsilon$。假设满足微观因果性和稳定性，即 $0  c_s^2(n_B)  1$。\n\n给定一个在 $n_{0}$ 处的低密度边界条件，已知 $P(n_{0}) = P_{0}$ 和 $\\varepsilon(n_{0}) = \\varepsilon_{0}$。边界上的重子化学势满足 $\\mu(n_{0}) = (\\varepsilon_{0} + P_{0}) / n_{0}$。\n\n选择声速剖面为常数，$c_s^2(n_B) = \\alpha$，其中 $0  \\alpha  1$。从上述基本定律和定义出发，通过从边界 $n_{0}$ 积分来构建与热力学一致的状态方程，以获得 $P(n_B)$ 和 $\\varepsilon(n_B)$。将最终结果表示为压强 $P(n_B)$ 的单个闭式解析表达式，用 $n_B$、$n_{0}$、$\\alpha$、$P_{0}$ 和 $\\varepsilon_{0}$ 表示。",
            "solution": "在尝试求解之前，需对问题陈述进行验证。\n\n**步骤1：提取给定条件**\n-   **模型**：零温（$T=0$）下的冷、正压、单组分重子流体。\n-   **变量**：重子数密度 $n_B$、压强 $P$、能量密度 $\\varepsilon$、重子化学势 $\\mu$。\n-   **定义与恒等式**：\n    -   声速的平方：$c_s^2 = \\partial P / \\partial \\varepsilon$（在固定组分下）。\n    -   零温下的热力学第一定律：$d\\varepsilon = \\mu \\, dn_B$。\n    -   零温下的欧拉关系：$P = n_B \\mu - \\varepsilon$。\n-   **假设与约束**：\n    -   声速的平方是常数：$c_s^2(n_B) = \\alpha$，其中 $\\alpha$ 是一个常数。\n    -   因果性和稳定性约束：$0  \\alpha  1$。\n-   **边界条件**：\n    -   在参考密度 $n_0$ 处，压强为 $P(n_0) = P_0$，能量密度为 $\\varepsilon(n_0) = \\varepsilon_0$。\n    -   边界上的化学势由 $\\mu(n_0) = (\\varepsilon_0 + P_0) / n_0$ 给出。这与在 $n_0$ 处求值的欧拉关系一致。\n-   **目标**：推导压强 $P(n_B)$ 的闭式解析表达式，用 $n_B$、$n_0$、$\\alpha$、$P_0$ 和 $\\varepsilon_0$ 表示。\n\n**步骤2：使用提取的给定条件进行验证**\n-   **科学依据**：该问题在应用于核天体物理学的热力学和流体动力学原理方面有充分的科学依据。这些热力学恒等式是零温相对论流体的标准形式。使用常数声速虽然是一种简化，但是是唯象状态方程 (EoS) 中一种常见且有效的参数化方法。\n-   **适定性**：该问题提供了一个具有明确边界条件的微分关系系统。这种设置允许通过积分唯一确定函数 $P(n_B)$ 和 $\\varepsilon(n_B)$。\n-   **目标**：问题以精确、形式化且无偏见的数学语言陈述。\n\n**步骤3：结论与行动**\n该问题被认定为具有科学性、适定性和客观性。它不包含任何矛盾、歧义或无效的前提。因此，该问题是**有效的**，并将构建一个解。\n\n**状态方程的推导**\n\n我们将首先通过建立重子化学势 $\\mu$ 作为重子数密度 $n_B$ 的函数的微分方程来推导解。\n\n给定的基本热力学关系是：\n1.  $d\\varepsilon = \\mu \\, dn_B$\n2.  $P = n_B \\mu - \\varepsilon$\n3.  具体假设是 $dP/d\\varepsilon = \\alpha$，其中 $\\alpha$ 是一个常数。\n\n从关系式(1)，我们可以将关于 $n_B$ 的偏导数写为：\n$$\n\\frac{d\\varepsilon}{dn_B} = \\mu\n$$\n使用链式法则，压强对重子数密度的导数是：\n$$\n\\frac{dP}{dn_B} = \\frac{dP}{d\\varepsilon} \\frac{d\\varepsilon}{dn_B}\n$$\n代入给定的关系，我们发现：\n$$\n\\frac{dP}{dn_B} = \\alpha \\mu\n$$\n现在，对欧拉关系(2) $P = n_B \\mu - \\varepsilon$ 关于 $n_B$ 求导：\n$$\n\\frac{dP}{dn_B} = \\frac{d}{dn_B}(n_B \\mu) - \\frac{d\\varepsilon}{dn_B}\n$$\n对右边的第一项使用乘法法则：\n$$\n\\frac{dP}{dn_B} = \\mu + n_B \\frac{d\\mu}{dn_B} - \\frac{d\\varepsilon}{dn_B}\n$$\n现在我们可以将之前建立的 $dP/dn_B$ 和 $d\\varepsilon/dn_B$ 的表达式代入这个方程：\n$$\n\\alpha \\mu = \\mu + n_B \\frac{d\\mu}{dn_B} - \\mu\n$$\n这可以简化为：\n$$\n\\alpha \\mu = n_B \\frac{d\\mu}{dn_B}\n$$\n这是一个关于 $\\mu(n_B)$ 的一阶可分离常微分方程。我们可以将其重新排列为：\n$$\n\\frac{d\\mu}{\\mu} = \\alpha \\frac{dn_B}{n_B}\n$$\n对两边积分得到：\n$$\n\\int \\frac{d\\mu}{\\mu} = \\int \\alpha \\frac{dn_B}{n_B}\n$$\n$$\n\\ln(\\mu) = \\alpha \\ln(n_B) + C_1\n$$\n其中 $C_1$ 是积分常数。我们可以写成 $C_1 = \\ln(K)$，其中 $K$ 是一个新的常数。\n$$\n\\ln(\\mu) = \\ln(n_B^{\\alpha}) + \\ln(K) = \\ln(K n_B^{\\alpha})\n$$\n对两边取指数，得到化学势的通解：\n$$\n\\mu(n_B) = K n_B^{\\alpha}\n$$\n为了确定常数 $K$，我们在 $n_B=n_0$ 处应用边界条件。问题陈述 $\\mu(n_0) = (\\varepsilon_0 + P_0)/n_0$。\n$$\n\\mu(n_0) = K n_0^{\\alpha} \\implies K = \\frac{\\mu(n_0)}{n_0^{\\alpha}} = \\frac{\\varepsilon_0 + P_0}{n_0 \\cdot n_0^{\\alpha}} = \\frac{\\varepsilon_0 + P_0}{n_0^{1+\\alpha}}\n$$\n将 $K$ 代回 $\\mu(n_B)$ 的表达式中得到：\n$$\n\\mu(n_B) = \\left(\\frac{\\varepsilon_0 + P_0}{n_0^{1+\\alpha}}\\right) n_B^{\\alpha}\n$$\n现在我们可以通过积分关系式 $dP/dn_B = \\alpha \\mu(n_B)$ 来求得压强 $P(n_B)$。\n$$\ndP = \\alpha \\mu(n_B) \\, dn_B\n$$\n我们从边界 $n_0$ 积分到一个任意密度 $n_B$：\n$$\n\\int_{P_0}^{P(n_B)} dP' = \\int_{n_0}^{n_B} \\alpha \\mu(n_B') \\, dn_B'\n$$\n$$\nP(n_B) - P_0 = \\int_{n_0}^{n_B} \\alpha \\left(\\frac{\\varepsilon_0 + P_0}{n_0^{1+\\alpha}}\\right) (n_B')^{\\alpha} \\, dn_B'\n$$\n常数项可以移到积分号外面：\n$$\nP(n_B) - P_0 = \\alpha \\left(\\frac{\\varepsilon_0 + P_0}{n_0^{1+\\alpha}}\\right) \\int_{n_0}^{n_B} (n_B')^{\\alpha} \\, dn_B'\n$$\n进行积分：\n$$\nP(n_B) - P_0 = \\alpha \\left(\\frac{\\varepsilon_0 + P_0}{n_0^{1+\\alpha}}\\right) \\left[ \\frac{(n_B')^{\\alpha+1}}{\\alpha+1} \\right]_{n_0}^{n_B}\n$$\n$$\nP(n_B) - P_0 = \\frac{\\alpha(\\varepsilon_0 + P_0)}{(1+\\alpha)n_0^{1+\\alpha}} \\left( n_B^{1+\\alpha} - n_0^{1+\\alpha} \\right)\n$$\n重新整理各项以分离出 $P(n_B)$ 并提出因子 $n_0^{1+\\alpha}$：\n$$\nP(n_B) = P_0 + \\frac{\\alpha(\\varepsilon_0 + P_0)}{1+\\alpha} \\left( \\frac{n_B^{1+\\alpha}}{n_0^{1+\\alpha}} - \\frac{n_0^{1+\\alpha}}{n_0^{1+\\alpha}} \\right)\n$$\n这就得到了压强作为重子数密度函数的最终闭式表达式：\n$$\nP(n_B) = P_0 + \\frac{\\alpha(\\varepsilon_0 + P_0)}{1+\\alpha} \\left[ \\left(\\frac{n_B}{n_0}\\right)^{1+\\alpha} - 1 \\right]\n$$\n这个表达式只依赖于问题陈述中指定的变量，因此满足了目标。",
            "answer": "$$\n\\boxed{P(n_B) = P_{0} + \\frac{\\alpha(\\varepsilon_{0} + P_{0})}{1+\\alpha} \\left[ \\left(\\frac{n_{B}}{n_{0}}\\right)^{1+\\alpha} - 1 \\right]}\n$$"
        },
        {
            "introduction": "一个实际的中子星状态方程必须包含详细的微观物理过程。本练习要求您编写一个程序，通过求解β平衡和电荷中性条件，来确定在给定重子数密度$n_B$下，中子、质子、电子和$\\mu$子的平衡组分。您将亲手实现一个核心的计算任务：平衡由核对称能驱动的强相互作用与由费米气体模型描述的轻子压力，并处理$\\mu$子出现的阈值效应。",
            "id": "3473660",
            "problem": "考虑由一个最小微观物理模型描述的冷的、催化的中子星物质，该模型将处于β平衡状态的重子与轻子耦合。重子数密度用 $n_B$ 表示，质子分数用 $Y_p = n_p/n_B$ 表示，其中 $n_p$ 是质子数密度，$n_n$ 是中子数密度。假设以下基本定律和定义成立：\n\n- 没有被俘获的中微子的β平衡要求 $\\mu_n = \\mu_p + \\mu_e$，并且当μ子存在时，$\\mu_e = \\mu_\\mu$。\n- 电荷中性要求 $n_p = n_e + n_\\mu$。\n- 重子数守恒意味着 $n_B = n_n + n_p$。\n- 对于核子，采用广泛使用的抛物线近似来描述核对称能对中子和质子化学势之差的贡献，\n$$\n\\mu_n - \\mu_p \\approx 4 S(n_B) (1 - 2 Y_p),\n$$\n其对称能具有幂律形式的密度依赖关系\n$$\nS(n_B) = S_0 \\left( \\frac{n_B}{n_0} \\right)^\\gamma,\n$$\n其中 $S_0 = 32\\,\\mathrm{MeV}$，$n_0 = 0.16\\,\\mathrm{fm}^{-3}$，且 $\\gamma = 0.6$。\n- 电子和μ子被建模为零温相对论性费米气体。它们作为数密度 $n_\\ell$ 函数的化学势为\n$$\n\\mu_\\ell(n_\\ell) = \\sqrt{ (m_\\ell c^2)^2 + (\\hbar c (3\\pi^2 n_\\ell)^{1/3})^2 },\n$$\n对于 $\\ell \\in \\{e,\\mu\\}$，其中 $m_e c^2 = 0.51099895\\,\\mathrm{MeV}$ 和 $m_\\mu c^2 = 105.6583755\\,\\mathrm{MeV}$。使用 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$。在需要时，通过以下方式反转此关系：\n$$\nn_\\ell(\\mu) =\n\\begin{cases}\n0,  \\mu  m_\\ell c^2, \\\\ [6pt]\n\\dfrac{1}{3\\pi^2}\\left(\\dfrac{\\sqrt{\\mu^2 - (m_\\ell c^2)^2}}{\\hbar c}\\right)^3,  \\mu \\ge m_\\ell c^2.\n\\end{cases}\n$$\n\n物质的组分是通过同时强制满足β平衡和电荷中性，以及定义 $n_p = Y_p n_B$ 来确定的。当电子化学势达到μ子静止能量阈值时，即当 $\\mu_e \\ge m_\\mu c^2$ 时，μ子会出现。在阈值以下，$n_\\mu = 0$ 且 $n_e = n_p$；在阈值以上，$\\mu_e = \\mu_\\mu \\equiv \\mu_\\ell$ 且 $n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = n_p$。\n\n你的任务是构建一个程序，对于每个指定的 $n_B$，求解满足以下条件的唯一质子分数 $Y_p(n_B)$：\n$$\n4 S(n_B) (1 - 2 Y_p) = \n\\begin{cases}\n\\mu_e(n_e = n_p),  \\text{如果 } \\mu_e(n_e = n_p)  m_\\mu c^2, \\\\ [6pt]\n\\mu_\\ell \\text{ 使得 } n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = n_p,  \\text{如果 } \\mu_e(n_e = n_p) \\ge m_\\mu c^2,\n\\end{cases}\n$$\n其中 $n_p = Y_p n_B$，并且所有量都以上述单位表示。解的存在性和唯一性应在你的算法设计中通过单调性论证来证明，并且数值方法应在阈值区域保持鲁棒。\n\n全程使用的数值和物理单位：\n- 数密度 $n_B$、$n_p$、$n_e$、$n_\\mu$ 必须以 $\\mathrm{fm}^{-3}$ 为单位。\n- 能量 $\\mu_e$、$\\mu_\\mu$、$S(n_B)$、$m_\\ell c^2$ 和 $\\hbar c$ 必须以 $\\mathrm{MeV}$ 为单位。\n- 质子分数 $Y_p$ 是无量纲的，必须以小数形式输出。\n\n测试套件：\n计算以下五个重子密度（单位为 $\\mathrm{fm}^{-3}$）下的 $Y_p(n_B)$：\n- $n_B = 1.0\\times 10^{-4}$，\n- $n_B = 2.0\\times 10^{-2}$，\n- $n_B = 1.6\\times 10^{-1}$，\n- $n_B = 4.8\\times 10^{-1}$，\n- $n_B = 1.0$。\n\n这些案例旨在探测低密度纯电子物质、接近μ子阈值的情况、近饱和密度以及远超阈值的行为。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表，列表包含五个结果，每个 $Y_p$ 值四舍五入到六位小数，例如 $[0.001234,0.012345,0.034567,0.056789,0.078901]$。",
            "solution": "### 第1步：提取已知条件\n该问题为模拟冷的、催化的中子星物质提供了以下数据、定义和关系：\n\n**基本原理和定义：**\n- β平衡（无被俘获的中微子）：$\\mu_n = \\mu_p + \\mu_e$\n- μ子平衡（当存在时）：$\\mu_e = \\mu_\\mu$\n- 电荷中性：$n_p = n_e + n_\\mu$\n- 重子数守恒：$n_B = n_n + n_p$\n- 质子分数定义：$Y_p = n_p/n_B$\n\n**组分模型（状态方程）：**\n- 核子化学势差（抛物线近似）：\n$$\n\\mu_n - \\mu_p \\approx 4 S(n_B) (1 - 2 Y_p)\n$$\n- 对称能密度依赖关系：\n$$\nS(n_B) = S_0 \\left( \\frac{n_B}{n_0} \\right)^\\gamma\n$$\n- 轻子化学势（相对论性费米气体）：\n$$\n\\mu_\\ell(n_\\ell) = \\sqrt{ (m_\\ell c^2)^2 + (\\hbar c (3\\pi^2 n_\\ell)^{1/3})^2 }, \\quad \\ell \\in \\{e,\\mu\\}\n$$\n- 轻子数密度的反向关系：\n$$\nn_\\ell(\\mu) =\n\\begin{cases}\n0,  \\mu  m_\\ell c^2, \\\\\n\\dfrac{1}{3\\pi^2}\\left(\\dfrac{\\sqrt{\\mu^2 - (m_\\ell c^2)^2}}{\\hbar c}\\right)^3,  \\mu \\ge m_\\ell c^2.\n\\end{cases}\n$$\n\n**物理和数值常数：**\n- 饱和密度下的对称能：$S_0 = 32\\,\\mathrm{MeV}$\n- 核饱和密度：$n_0 = 0.16\\,\\mathrm{fm}^{-3}$\n- 对称能幂律指数：$\\gamma = 0.6$\n- 电子静止能量：$m_e c^2 = 0.51099895\\,\\mathrm{MeV}$\n- μ子静止能量：$m_\\mu c^2 = 105.6583755\\,\\mathrm{MeV}$\n- 普朗克-狄拉克常数乘以光速：$\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$\n\n**任务：**\n对于给定的重子数密度 $n_B$，求解满足平衡条件的质子分数 $Y_p$：\n$$\n4 S(n_B) (1 - 2 Y_p) = \n\\begin{cases}\n\\mu_e(n_e = n_p),  \\text{如果 } \\mu_e(n_e = n_p)  m_\\mu c^2, \\\\ [6pt]\n\\mu_\\ell \\text{ 使得 } n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = n_p,  \\text{如果 } \\mu_e(n_e = n_p) \\ge m_\\mu c^2,\n\\end{cases}\n$$\n其中 $n_p = Y_p n_B$。\n\n**测试套件：**\n- $n_B = 1.0\\times 10^{-4}\\,\\mathrm{fm}^{-3}$\n- $n_B = 2.0\\times 10^{-2}\\,\\mathrm{fm}^{-3}$\n- $n_B = 1.6\\times 10^{-1}\\,\\mathrm{fm}^{-3}$\n- $n_B = 4.8\\times 10^{-1}\\,\\mathrm{fm}^{-3}$\n- $n_B = 1.0\\,\\mathrm{fm}^{-3}$\n\n### 第2步：使用提取的已知条件进行验证\n对该问题进行严格的验证程序。\n\n- **科学上合理（关键）：**该问题描述了一种最简单但标准的冷密核物质β平衡模型（通常称为npeμ物质）。β平衡方程、电荷中性、对称能的抛物线近似以及轻子的相对论性费米气体模型都是核天体物理学和中子星理论的基石。物理常数（$m_e c^2$、$m_\\mu c^2$、$\\hbar c$）和核物理参数（$S_0$、$n_0$、$\\gamma$）的值是标准的，并在文献中被广泛使用。该模型在其适用领域内是科学上可靠且事实正确的。\n- **良定的：**该问题要求在给定参数 $n_B$ 的情况下，求解变量 $Y_p$ 的一个超越方程的根。为评估其是否良定，我们分析所涉及函数的单调性。设方程为 $L(Y_p) = R(Y_p)$。\n    - 对于任何固定的 $n_B > 0$，左侧 $L(Y_p) = 4 S(n_B)(1 - 2Y_p)$ 是一个关于 $Y_p$ 的线性的、严格递减的函数。\n    - 右侧 $R(Y_p)$ 代表平衡状态下的轻子化学势。\n        - 在无μ子的情况下，$R(Y_p) = \\mu_e(n_p) = \\mu_e(Y_p n_B)$。由于 $\\mu_e(n_e)$ 是 $n_e$ 的严格递增函数，而 $n_p$ 是 $Y_p$ 的线性递增函数，因此 $R(Y_p)$ 是严格递增的。\n        - 在有μ子的情况下，$R(Y_p)$ 是求解 $n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = Y_p n_B$ 的值 $\\mu_\\ell$。函数 $N(\\mu_\\ell) = n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell)$ 是 $\\mu_\\ell$ 的严格递增函数。因此，其反函数 $\\mu_\\ell = N^{-1}(Y_p n_B)$ 是其自变量 $Y_p n_B$ 的严格递增函数。因此，在这种情况下 $R(Y_p)$ 也是严格递增的。\n    - 因此，我们正在寻找一个严格递减函数和一个严格递增函数的交点。这样的交点如果存在，则是唯一的。根据介值定理，在物理域 $Y_p \\in [0, 1]$ 内解的存在性得到保证，因为（对于相关密度）$L(0) > R(0)$ 且 $L(0.5) = 0$ 而 $R(0.5) > 0$，这意味着 $L(0.5)  R(0.5)$。因此，在 $Y_p \\in (0, 0.5)$ 内存在唯一解。该问题是良定的。\n- **客观性（关键）：**该问题以精确、定量和客观的科学语言陈述。所有术语都有正式定义。没有主观或基于意见的成分。\n- **无其他缺陷：**问题是自洽的，提供了所有必要的方程和常数。它不是比喻性的、琐碎的或矛盾的。单位一致且已指定。\n\n### 第3步：结论与行动\n该问题是**有效的**。这是一个计算核天体物理学中良定的、有科学依据的问题。将提供一个完整的解决方案。\n\n### 求解方法论\n\n问题的核心是找到在给定重子数密度 $n_B$ 下建立β平衡的质子分数 $Y_p$。这是通过求解一个超越方程来实现的，该方程将由核力驱动的中子和质子之间的化学势差，与由电磁和量子统计决定的轻子化学势相等同。\n\n**1. 控制方程及为求根进行的重构**\n结合β平衡的条件（$\\mu_n - \\mu_p = \\mu_e$）和所提供的模型，我们得到待求解 $Y_p$ 的中心方程：\n$$\n4 S(n_B)(1 - 2 Y_p) = \\mu_{\\text{lepton}}\n$$\n其中 $\\mu_{\\text{lepton}}$ 是带电轻子（电子，可能还有μ子）的平衡化学势。为了数值求解，我们将其重构为一个求根问题。我们定义一个残差函数 $f(Y_p; n_B)$，使其根对应于解：\n$$\nf(Y_p; n_B) = 4 S(n_B)(1 - 2Y_p) - \\mu_{\\text{lepton}}(Y_p, n_B) = 0\n$$\n如在验证中所述，对于任何固定的 $n_B > 0$，此函数关于 $Y_p$ 是严格单调的，这保证了可以用标准数值算法高效地找到唯一的根。\n\n**2. 算法设计**\n该算法通过遍历每个指定的重子密度 $n_B$ 并求解相应的 $Y_p$ 来进行。对于每个 $n_B$，算法的核心是一个数值求根器。我们采用Brent方法，该方法以其鲁棒性和效率而闻名，因为它结合了二分法的保证收敛性和插值法的速度。\n\n关键在于残差函数 $f(Y_p; n_B)$ 的实现，它必须正确评估轻子化学势 $\\mu_{\\text{lepton}}$。此评估取决于条件是否适合μ子的产生。\n\n**3. 轻子化学势 $\\mu_{\\text{lepton}}$ 的评估**\n对于给定的 $Y_p$ 试验值和指定的 $n_B$，质子密度为 $n_p = Y_p n_B$。电荷中性条件为 $n_p = n_e + n_\\mu$。\n\n- **步骤3a：阈值检查。** 我们首先确定是否存在μ子。只有当电子化学势 $\\mu_e$ 达到μ子静止质量能量 $m_\\mu c^2 \\approx 105.7\\,\\mathrm{MeV}$ 时，μ子才会出现。我们通过计算一个假设的电子化学势 $\\mu_e^{\\text{hyp}}$ 来测试这一点，假设所有负电荷都由电子携带（即 $n_e = n_p$ 且 $n_\\mu=0$）：\n$$\n\\mu_e^{\\text{hyp}} = \\mu_e(n_e=n_p) = \\sqrt{(m_e c^2)^2 + (\\hbar c (3\\pi^2 n_p)^{1/3})^2}\n$$\n\n- **步骤3b：情况1 - 无μ子区域 ($\\mu_e^{\\text{hyp}}  m_\\mu c^2$)。** 如果假设的化学势低于μ子阈值，我们的假设就是正确的。不存在μ子（$n_\\mu=0$），系统由中子、质子和电子组成（npe物质）。平衡轻子化学势就是这个假设值：\n$$\n\\mu_{\\text{lepton}} = \\mu_e^{\\text{hyp}}\n$$\n\n- **步骤3c：情况2 - 有μ子区域 ($\\mu_e^{\\text{hyp}} \\ge m_\\mu c^2$)。** 如果假设的化学势达到或超过阈值，则必须存在μ子以建立平衡（npeμ物质）。电子和μ子共享一个共同的化学势，$\\mu_e = \\mu_\\mu \\equiv \\mu_\\ell$。这个共同化学势 $\\mu_\\ell$ 是满足电荷中性条件的值，该条件包含两种轻子的贡献：\n$$\nn_p = n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell)\n$$\n这个关于 $\\mu_\\ell$ 的方程本身就是一个必须求解的超越方程。我们为此子问题定义第二个残差函数 $g(\\mu_\\ell)$：\n$$\ng(\\mu_\\ell) = n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) - n_p = 0\n$$\n函数 $g(\\mu_\\ell)$ 在 $\\mu_\\ell \\ge m_\\mu c^2$ 时是严格递增的。保证根存在于区间 $[m_\\mu c^2, \\mu_e^{\\text{hyp}}]$ 内。我们再次使用Brent方法在此区间内找到唯一的根 $\\mu_\\ell$。这个解出的值成为主问题的平衡轻子势：\n$$\n\\mu_{\\text{lepton}} = \\mu_\\ell\n$$\n\n**4. $Y_p$ 的数值解**\n有了一个可以为任何有效 $Y_p$ 评估残差函数 $f(Y_p; n_B)$ 的完整方法后，我们应用Brent方法来寻找其根。$Y_p$ 的搜索区间被限定在 $[10^{-9}, 0.5]$。下界是一个小的正数，以避免在 $Y_p=0$ 时的数值问题。上界是 $0.5$，因为当 $Y_p > 0.5$ 时，左侧 $4 S(n_B)(1 - 2Y_p)$ 变为负数，而右侧（一个化学势）总是正数，使得解不可能存在。\n\n这种嵌套求根方法提供了一种鲁棒而准确的方法，用于在无μ子和有μ子两种区域中，为任何给定的重子密度 $n_B$ 确定平衡组分 $Y_p$。最终的Python实现封装了这一逻辑，对外部（$Y_p$）和内部（$\\mu_\\ell$）的求根任务都使用了 `scipy.optimize.brentq`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the proton fraction Yp in beta-equilibrated neutron star matter\n    for a given set of baryon number densities.\n    \"\"\"\n\n    #\n    # Step 1: Define physical constants and model parameters\n    # All units are in MeV and fm.\n    #\n\n    # Nuclear physics parameters for the symmetry energy\n    S0 = 32.0          # MeV, symmetry energy at saturation\n    N0 = 0.16          # fm^-3, nuclear saturation density\n    GAMMA = 0.6        # unitless, power-law index for S(n_B)\n\n    # Fundamental constants\n    M_E_C2 = 0.51099895   # MeV, electron rest energy\n    M_MU_C2 = 105.6583755 # MeV, muon rest energy\n    HBAR_C = 197.3269804   # MeV fm\n\n    #\n    # Step 2: Implement the physical model equations as functions\n    #\n\n    def S_func(n_b: float) - float:\n        \"\"\"Calculates the nuclear symmetry energy S as a function of baryon density n_B.\"\"\"\n        return S0 * (n_b / N0)**GAMMA\n\n    def mu_lepton_from_density(n_l: float, m_l_c2: float) - float:\n        \"\"\"\n        Calculates lepton chemical potential from its number density for a relativistic Fermi gas.\n        \"\"\"\n        if n_l = 0:\n            return m_l_c2\n        # Expression: sqrt( (m*c^2)^2 + (hbar*c * k_F)^2 ), where k_F = (3*pi^2*n)^(1/3)\n        kf_term = HBAR_C * (3 * np.pi**2 * n_l)**(1/3)\n        return np.sqrt(m_l_c2**2 + kf_term**2)\n\n    def n_lepton_from_mu(mu: float, m_l_c2: float) - float:\n        \"\"\"\n        Calculates lepton number density from its chemical potential (inverse of the above).\n        \"\"\"\n        if mu  m_l_c2:\n            return 0.0\n        # Expression: (k_F^3) / (3*pi^2), where k_F = sqrt(mu^2 - (m*c^2)^2) / (hbar*c)\n        kf3 = (np.sqrt(mu**2 - m_l_c2**2) / HBAR_C)**3\n        return kf3 / (3 * np.pi**2)\n\n    def equilibrium_residual(y_p: float, n_b: float) - float:\n        \"\"\"\n        The residual function f(Y_p) = LHS - RHS = 0 that we need to solve.\n        LHS = 4 * S(n_B) * (1 - 2*Y_p)\n        RHS = mu_lepton (which depends on Y_p and n_B)\n        \"\"\"\n        # Ensure y_p is strictly positive to avoid division by zero or log of zero issues downstream\n        # if other models were used. For this model, it's just good practice.\n        if y_p = 0:\n            y_p = 1e-15\n\n        # Left-hand side (from nuclear forces)\n        lhs = 4 * S_func(n_b) * (1 - 2 * y_p)\n\n        # Right-hand side (from lepton equilibrium)\n        n_p = y_p * n_b\n\n        # First, calculate hypothetical mu_e assuming no muons (n_e = n_p)\n        # to check if we are above the muon creation threshold.\n        mu_e_hypothetical = mu_lepton_from_density(n_p, M_E_C2)\n\n        if mu_e_hypothetical  M_MU_C2:\n            # Case 1: Muon-free regime.\n            # The lepton chemical potential is simply mu_e_hypothetical.\n            rhs = mu_e_hypothetical\n        else:\n            # Case 2: Muons are present.\n            # We must find the common chemical potential mu_l such that\n            # charge neutrality n_p = n_e(mu_l) + n_mu(mu_l) is satisfied.\n            # This requires solving another root-finding problem for mu_l.\n            \n            def charge_neutrality_residual(mu_l: float, n_p_target: float) - float:\n                \"\"\"Residual for the inner root-finder to find mu_l.\"\"\"\n                return n_lepton_from_mu(mu_l, M_E_C2) + n_lepton_from_mu(mu_l, M_MU_C2) - n_p_target\n\n            # The root mu_l is bracketed by [M_MU_C2, mu_e_hypothetical].\n            # At mu_l=M_MU_C2, n_mu=0 and n_e  n_p, so residual  0.\n            # At mu_l=mu_e_hypothetical, n_e=n_p and n_mu0, so residual  0.\n            try:\n                mu_l_equilibrium = brentq(\n                    charge_neutrality_residual,\n                    a=M_MU_C2,\n                    b=mu_e_hypothetical,\n                    args=(n_p,),\n                    xtol=1e-12, rtol=1e-12\n                )\n            except ValueError:\n                 # This can happen if the bracket endpoints do not have opposite signs,\n                 # which indicates an issue with the model or a very narrow range.\n                 # Let's ensure the upper bound is strictly larger.\n                 mu_l_equilibrium = brentq(\n                    charge_neutrality_residual,\n                    a=M_MU_C2,\n                    b=mu_e_hypothetical * (1 + 1e-9), # Widen bracket slightly\n                    args=(n_p,),\n                    xtol=1e-12, rtol=1e-12\n                )\n\n            rhs = mu_l_equilibrium\n\n        return lhs - rhs\n\n    #\n    # Step 3: Define the test cases and solve for each\n    #\n    test_cases = [1.0e-4, 2.0e-2, 1.6e-1, 4.8e-1, 1.0]\n\n    results = []\n    # Set up bracketing for Y_p. The solution must be in (0, 0.5).\n    # At Y_p - 0, f  0. At Y_p = 0.5, LHS = 0 and RHS  0, so f  0.\n    y_p_bracket_min = 1e-9\n    y_p_bracket_max = 0.5\n\n    for n_b_val in test_cases:\n        y_p_solution = brentq(\n            equilibrium_residual,\n            a=y_p_bracket_min,\n            b=y_p_bracket_max,\n            args=(n_b_val,),\n            xtol=1e-12, rtol=1e-12\n        )\n        results.append(f\"{y_p_solution:.6f}\")\n\n    #\n    # Step 4: Print the final output in the required format\n    #\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在数值相对论模拟中，状态方程通常以表格形式提供，而流体动力学代码必须在每个时间步中可靠地使用这些数据。本练习模拟了相对论流体动力学中的一个关键算法步骤：“守恒量到原始变量的转化”。通过比较两种不同的插值方法（标准三次样条和单调三次Hermite插值），您将亲身体验并理解，对状态方程的数值处理方式如何直接影响模拟的物理真实性，特别是能否保证因果律（即声速$c_s$不超过光速$c$）。",
            "id": "3473680",
            "problem": "你的任务是为稠密核物质的表格化状态方程（EoS）实现一个狭义相对论流体力学中的守恒量到原始变量的反演，并演示单调分段三次Hermite插值如何防止在反演过程中出现伪超光速局域声速。在自然单位制中工作，光速$c=1$，因此所有量纲均为无量纲。EoS被假定为冷的、正压的，由一个能量密度$e$对压强$p$的表格指定，其中$p=p(e)$。你的实现必须从同一个表格构建两个EoS插值器：一个标准的三次样条（非扭结，not-a-knot）和一个单调分段三次Hermite插值多项式（PCHIP）。你将在一个牛顿迭代方案中使用每个插值器，该方案从守恒变量求解压强$p$。在牛顿迭代中，你必须通过当前迭代点处所用插值器的导数来计算局域声速的平方$c_s^2=\\mathrm{d}p/\\mathrm{d}e$。你必须记录一个布尔标志，指示在迭代过程中的任何时刻$c_s^2$是否超过了$1$（因果性破坏）。\n\n用作基础的基本定义和关系：\n- 在一维空间中，使用自然单位制$c=1$的狭义相对论流体力学的守恒变量定义如下：\n  - 实验室参考系中的静质量密度$D=\\rho W$，\n  - 动量密度大小$S = (e+p) W^2 v$，\n  - 不包括$D$的能量密度为$\\tau = (e+p) W^2 - p - D$，\n  其中$\\rho$是流体静止参考系中的静质量密度，$e$是包含静质量能的总能量密度，$p$是压强，$v$是流体三维速度，$W = 1/\\sqrt{1-v^2}$是洛伦兹因子。\n- 定义$Q \\equiv \\tau + D + p$。那么$Q = (e+p) W^2$。根据$Q$和给定的$S$，速度大小满足$v^2 = S^2/Q^2$，能量密度满足恒等式\n  $$ e = \\tau + D - \\frac{S^2}{\\tau + D + p} = \\tau + D - \\frac{S^2}{Q}。$$\n- 正压EoS的声速平方为$c_s^2 = \\frac{\\mathrm{d}p}{\\mathrm{d}e}$。在针对压强$p$的牛顿迭代中，定义残差$f(p) = p - p_{\\mathrm{EOS}}(e(p))$，其中$e(p)$由上式给出。那么\n  $$ \\frac{\\mathrm{d}e}{\\mathrm{d}p} = \\frac{S^2}{(\\tau + D + p)^2} = \\frac{S^2}{Q^2}, \\quad \\frac{\\mathrm{d}f}{\\mathrm{d}p} = 1 - c_s^2 \\frac{S^2}{Q^2}。$$\n\nEoS表格：\n- 对$i \\in \\{1,\\dots,6\\}$，使用以下表格点$(e_i,p_i)$：\n  - $e_1 = 1.0$, $p_1 = 0.05$,\n  - $e_2 = 1.5$, $p_2 = 0.15$,\n  - $e_3 = 2.0$, $p_3 = 0.625$,\n  - $e_4 = 2.5$, $p_4 = 1.1$,\n  - $e_5 = 4.0$, $p_5 = 1.175$,\n  - $e_6 = 5.0$, $p_6 = 1.225$。\n- 这些数据的分段斜率严格小于$1$，以确保在单调插值时底层的正压EoS是符合因果性的。然而，由于非单调的曲率，标准三次样条可能会在节点之间产生$\\mathrm{d}p/\\mathrm{d}e$超过$1$的局部过冲。\n\n需要实现的数值反演任务：\n- 对于给定的守恒变量$(D,S,\\tau)$和选定的$p(e)$插值器，通过牛顿法求解$f(p) = p - p_{\\mathrm{EOS}}(e(p)) = 0$来反演原始变量压强$p$。在每次迭代中：\n  - 计算$Q = \\tau + D + p$，\n  - 计算$e = \\tau + D - S^2/Q$，\n  - 在此$e$处评估$p_{\\mathrm{EOS}}(e)$和$c_s^2 = \\mathrm{d}p_{\\mathrm{EOS}}/\\mathrm{d}e$，\n  - 使用$f'(p) = 1 - c_s^2 S^2/Q^2$更新$p \\leftarrow p - f(p)/f'(p)$。\n- 使用初始猜测值$p^{(0)} = p_{\\mathrm{EOS}}(e^{(0)})$，其中$e^{(0)} = \\tau + D - S^2/(\\tau + D)$，这对应于在$e$的精确表达式的分母中取一个小的$p$。\n- 在迭代过程中，将$p$限制在EOS表格的压强范围内，以保持在插值范围内。当$|f(p)|  10^{-12}$或达到$50$次迭代后终止。记录一个布尔标志，如果在任何迭代中$c_s^2 > 1$（与$1$比较时使用$10^{-12}$的容差），则该标志为真。\n\n测试套件：\n- 通过选择$(e_{\\mathrm{true}}, v_{\\mathrm{true}})$并设置$\\rho_{\\mathrm{true}} = e_{\\mathrm{true}}$来构建三个测试用例。对于每个用例，使用单调PCHIP插值器计算$p_{\\mathrm{true}}$，然后使用上述定义计算守恒变量。使用以下用例：\n  - 用例 1：$e_{\\mathrm{true}} = 1.8$, $v_{\\mathrm{true}} = 0.2$，\n  - 用例 2：$e_{\\mathrm{true}} = 2.3$, $v_{\\mathrm{true}} = 0.5$，\n  - 用例 3：$e_{\\mathrm{true}} = 4.5$, $v_{\\mathrm{true}} = 0.7$。\n- 对每个用例，将守恒量到原始变量的反演运行两次：一次使用标准三次样条插值器，一次使用单调PCHIP插值器。对于每次运行，报告反演得到的压强以及在迭代中是否有$c_s^2 > 1$的情况。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按顺序为三个用例中的每一个连接一个四元组，该四元组由使用三次样条插值器反演的压强、使用单调PCHIP插值器反演的压强、三次插值器迭代过程中出现$c_s^2>1$的布尔标志，以及PCHIP插值器迭代过程中出现$c_s^2>1$的布尔标志组成。因此，输出总共有$12$个条目，看起来像这样\n  $$ [p_{\\mathrm{cubic}}^{(1)}, p_{\\mathrm{pchip}}^{(1)}, \\mathrm{flag}_{\\mathrm{cubic}}^{(1)}, \\mathrm{flag}_{\\mathrm{pchip}}^{(1)}, p_{\\mathrm{cubic}}^{(2)}, p_{\\mathrm{pchip}}^{(2)}, \\mathrm{flag}_{\\mathrm{cubic}}^{(2)}, \\mathrm{flag}_{\\mathrm{pchip}}^{(2)}, p_{\\mathrm{cubic}}^{(3)}, p_{\\mathrm{pchip}}^{(3)}, \\mathrm{flag}_{\\mathrm{cubic}}^{(3)}, \\mathrm{flag}_{\\mathrm{pchip}}^{(3)} ]。$$\n- 所有压强必须以自然单位制$c=1$下的浮点数形式打印，标志为布尔值。不使用角度，因此不需要角度单位。不使用百分比，因此不需要百分比格式。",
            "solution": "该任务是实现并比较一维狭义相对论流体力学（SRHD）中两种守恒量到原始变量的反演方案。问题的核心在于使用一个表格化的正压状态方程（EoS），即$p=p(e)$，从守恒变量$(D, S, \\tau)$求解原始变量，特别是压强$p$。比较的重点是EoS表格的插值方法对数值反演过程中系统物理因果性的影响。具体来说，我们将对比标准三次样条和单调分段三次Hermite插值多项式（PCHIP），并证明前者可能导致伪超光速声速（$c_s > 1$），这是一种对因果性的违背，而后者通过其设计可以防止这个问题。\n\n首先，我们在光速$c=1$的自然单位制中建立理论框架。守恒变量是在实验室参考系中测量的静质量密度$D$、动量密度$S$和能量密度$\\tau$。它们通过原始变量——流体静止参考系中的静质量密度$\\rho$、总能量密度$e$（包括静质量）、压强$p$，以及流体速度$v$——定义如下：\n$$ D = \\rho W $$\n$$ S = (e+p) W^2 v $$\n$$ \\tau = (e+p) W^2 - p - D $$\n其中$W = 1/\\sqrt{1-v^2}$是洛伦兹因子。\n\n守恒量到原始变量反演的目标是，给定$(D, S, \\tau)$，求出$(p, v, e, \\rho)$。我们可以建立一套代数关系来简化这个反演过程。让我们定义一个辅助变量$Q \\equiv \\tau + D + p$。代入$\\tau$的表达式，我们发现：\n$$ Q = ( (e+p) W^2 - p - D ) + D + p = (e+p) W^2 $$\n使用$Q$的这个定义，动量密度$S$可以写为$S = Qv$，这立即给出了速度大小为$v = S/Q$。因为$v^2 = S^2/Q^2$，洛伦兹因子的平方是$W^2 = 1/(1-v^2) = 1/(1 - S^2/Q^2) = Q^2/(Q^2-S^2)$。\n\n此外，我们可以推导出一个仅依赖于守恒变量和未知压强$p$的能量密度$e$的表达式：\n$$ \\tau = Q - p - D \\implies e = \\frac{Q}{W^2} - p = Q(1-v^2) - p = Q\\frac{Q^2-S^2}{Q^2} - p = \\frac{Q^2-S^2}{Q} - p $$\n代入$Q = \\tau + D + p$得到：\n$$ e = \\frac{(\\tau+D+p)^2 - S^2}{\\tau+D+p} - p = \\frac{(\\tau+D)^2 + 2p(\\tau+D) + p^2 - S^2 - p(\\tau+D+p)}{\\tau+D+p} $$\n$$ e = \\frac{(\\tau+D)^2 + p(\\tau+D) - S^2}{\\tau+D+p} = \\frac{(\\tau+D)(\\tau+D+p) - S^2}{\\tau+D+p} = \\tau + D - \\frac{S^2}{\\tau+D+p} $$\n这个最终关系式，$e = \\tau + D - S^2/Q$，表明对于给定的$(D, S, \\tau)$，$e$是$p$的函数。\n\n由于EoS是正压的，$p$仅是$e$的函数，我们将其表示为$p_{\\mathrm{EOS}}(e)$。因此，寻找$p$的问题被简化为求解以下标量非线性方程：\n$$ f(p) = p - p_{\\mathrm{EOS}}(e(p)) = 0 $$\n其中$e(p) = \\tau + D - S^2/(\\tau + D + p)$。这个方程使用牛顿法求解，这是一个迭代求根算法，形式如下：\n$$ p_{k+1} = p_k - \\frac{f(p_k)}{f'(p_k)} $$\n导数$f'(p)$通过应用链式法则求得：\n$$ f'(p) = \\frac{\\mathrm{d}f}{\\mathrm{d}p} = 1 - \\frac{\\mathrm{d}p_{\\mathrm{EOS}}}{\\mathrm{d}e} \\frac{\\mathrm{d}e}{\\mathrm{d}p} $$\n项$\\mathrm{d}p_{\\mathrm{EOS}}/\\mathrm{d}e$是局域声速的平方，$c_s^2$。项$\\mathrm{d}e/\\mathrm{d}p$是：\n$$ \\frac{\\mathrm{d}e}{\\mathrm{d}p} = \\frac{\\mathrm{d}}{\\mathrm{d}p} \\left( \\tau + D - \\frac{S^2}{\\tau + D + p} \\right) = -S^2 \\left( -(\\tau+D+p)^{-2} \\right) = \\frac{S^2}{(\\tau+D+p)^2} = \\frac{S^2}{Q^2} $$\n因此，残差函数的导数是：\n$$ f'(p) = 1 - c_s^2 \\frac{S^2}{Q^2} $$\n\n函数$p_{\\mathrm{EOS}}(e)$和$c_s^2(e) = \\mathrm{d}p_{\\mathrm{EOS}}/\\mathrm{d}e$并非解析已知，而是通过对给定的$(e_i, p_i)$点表格进行插值来构造。插值方案的选择至关重要。标准三次样条在数据点处强制$C^2$连续性（二阶导数连续），这可能导致插值函数的一阶导数在点之间“过冲”或振荡。如果这种过冲导致$c_s^2$超过$1$，它就代表了数值上的因果性破坏，因为任何信号都不能比光速传播得更快。\n\n相比之下，分段三次Hermite插值多项式（PCHIP）被设计用来保持单调性。如果输入数据是单调的（即，$p_i$是$e_i$的非减函数），那么得到的插值函数也将是单调的。这一性质也约束了插值函数的导数，防止了可能导致$c_s^2 > 1$的非物理过冲，前提是底层数据的分段斜率都小于或等于$1$。所提供的EOS表格满足此条件。\n\n需要实现的算法如下：\n1.  从给定的表格构建两个EoS表示：一个使用`scipy.interpolate.CubicSpline`，另一个使用`scipy.interpolate.PchipInterpolator`，以及它们各自的一阶导数函数。\n2.  对于每个由$(e_{\\mathrm{true}}, v_{\\mathrm{true}})$定义的测试用例：\n    a. 使用PCHIP插值器计算“真实”压强$p_{\\mathrm{true}}$。\n    b. 根据问题陈述，假设$\\rho_{\\mathrm{true}} = e_{\\mathrm{true}}$。\n    c. 使用它们的定义计算相应的守恒变量$(D, S, \\tau)$。这些将作为反演方案的输入。\n3.  对于每组$(D, S, \\tau)$和每种插值器：\n    a. 用猜测值$p^{(0)} = p_{\\mathrm{EOS}}(e^{(0)})$来初始化压强$p$，其中$e^{(0)} = \\tau+D-S^2/(\\tau+D)$。\n    b. 开始牛顿法迭代。在每次迭代中，计算$Q$、$e$、$p_{\\mathrm{EOS}}(e)$和$c_s^2(e)$。\n    c. 跟踪在迭代过程中的任何时刻$c_s^2$是否超过$1 + 10^{-12}$。\n    d. 使用牛顿步更新压强$p$。将$p$限制在表格化的压强范围内。同时，在评估插值器之前，将$e$限制在表格化的能量密度范围内，以确保数值稳定性。\n    e. 在收敛（$|f(p)|  10^{-12}$）或达到50次迭代后终止。\n4.  记录每次运行的最终反演压强和因果性破坏标志。整理并以指定格式输出所有12个结果。这个过程将凸显PCHIP在抵抗标准三次样条在物理驱动的数值情境中可能出现的病态问题方面的稳健性。",
            "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import CubicSpline, PchipInterpolator\n\ndef recover_pressure(D, S, tau, p_interp, cs2_interp, e_tab, p_tab):\n    \"\"\"\n    Recovers the primitive variable pressure 'p' from the conserved variables (D, S, tau)\n    using Newton's method with a given EOS interpolant.\n    \"\"\"\n    TOL = 1e-12\n    CAUSALITY_TOL = 1e-12\n    MAX_ITER = 50\n    \n    e_min, e_max = e_tab[0], e_tab[-1]\n    p_min, p_max = p_tab[0], p_tab[-1]\n    \n    causality_violated = False\n\n    # Initial guess for p\n    # Denominator (tau + D) is positive for the given test cases.\n    e0_denom = tau + D\n    if e0_denom = 0:\n        # Fallback for a pathological case, though not expected here.\n        e0 = e_min\n    else:\n        e0 = tau + D - S**2 / e0_denom\n    \n    # Clamp initial e to the interpolator's domain\n    e0_clamped = np.clip(e0, e_min, e_max)\n    p = p_interp(e0_clamped)\n    p = np.clip(p, p_min, p_max)\n\n    for _ in range(MAX_ITER):\n        # Define Q based on current pressure iterate p\n        Q = tau + D + p\n        if Q = 0:  # Physically Q = (e+p)W^2, should be  0.\n            break\n\n        # Calculate energy density e\n        e = tau + D - S**2 / Q\n        \n        # Clamp e to the valid domain of the EOS table before interpolation\n        e_clamped = np.clip(e, e_min, e_max)\n\n        # Evaluate EOS and its derivative (cs^2)\n        p_eos = p_interp(e_clamped)\n        cs2 = cs2_interp(e_clamped)\n        \n        # Check for causality violation\n        if cs2  1.0 + CAUSALITY_TOL:\n            causality_violated = True\n            \n        # P-version of the residual function f(p) = p - p_eos(e(p))\n        f_p = p - p_eos\n        \n        # Check for convergence\n        if abs(f_p)  TOL:\n            break\n            \n        # Derivative of the residual function f'(p)\n        fp_prime = 1.0 - cs2 * S**2 / Q**2\n\n        # Avoid division by zero if stalled\n        if abs(fp_prime)  1e-14:\n            break\n            \n        # Newton-Raphson update\n        p_update = p - f_p / fp_prime\n        \n        # Clamp pressure to remain within the tabulated EOS range\n        p = np.clip(p_update, p_min, p_max)\n        \n    return p, causality_violated\n\n\ndef solve():\n    \"\"\"\n    Main function to set up the problem, run the solvers, and print the results.\n    \"\"\"\n    # EOS Table data provided in the problem\n    e_tab = np.array([1.0, 1.5, 2.0, 2.5, 4.0, 5.0])\n    p_tab = np.array([0.05, 0.15, 0.625, 1.1, 1.175, 1.225])\n\n    # Test cases: (e_true, v_true)\n    test_cases = [\n        (1.8, 0.2),\n        (2.3, 0.5),\n        (4.5, 0.7),\n    ]\n\n    # 1. Construct interpolants and their derivatives\n    # Standard cubic spline\n    p_of_e_cubic = CubicSpline(e_tab, p_tab, bc_type='not-a-knot')\n    cs2_of_e_cubic = p_of_e_cubic.derivative(1)\n    \n    # Monotone PCHIP\n    p_of_e_pchip = PchipInterpolator(e_tab, p_tab)\n    cs2_of_e_pchip = p_of_e_pchip.derivative(1)\n\n    results = []\n    \n    # 2. Loop through test cases\n    for e_true, v_true in test_cases:\n        # a. Calculate \"true\" primitive variables\n        p_true = p_of_e_pchip(e_true)\n        # b. Use prescribed relation rho_true = e_true for test case generation\n        rho_true = e_true\n        \n        # c. Compute conserved variables from true primitives\n        W = 1.0 / np.sqrt(1.0 - v_true**2)\n        D = rho_true * W\n        S = (e_true + p_true) * W**2 * v_true\n        tau = (e_true + p_true) * W**2 - p_true - D\n        \n        # 3. Run recovery for each interpolant\n        p_rec_cubic, flag_cubic = recover_pressure(D, S, tau, p_of_e_cubic, cs2_of_e_cubic, e_tab, p_tab)\n        p_rec_pchip, flag_pchip = recover_pressure(D, S, tau, p_of_e_pchip, cs2_of_e_pchip, e_tab, p_tab)\n        \n        # 4. Append results in the specified order\n        results.append(p_rec_cubic)\n        results.append(p_rec_pchip)\n        results.append(flag_cubic)\n        results.append(flag_pchip)\n\n    # Final print statement in the exact required format\n    # Convert booleans to lowercase 'true'/'false' as per standard JSON/list representation\n    formatted_results = [str(r).lower() if isinstance(r, bool) else str(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}