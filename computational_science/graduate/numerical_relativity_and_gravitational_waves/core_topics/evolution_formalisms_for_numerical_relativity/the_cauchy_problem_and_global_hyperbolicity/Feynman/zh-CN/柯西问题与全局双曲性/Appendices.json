{
    "hands_on_practices": [
        {
            "introduction": "广义相对论中的柯西问题始于在空间切片上设定有效的初始数据。这个练习  专注于在时间对称、共形平坦这一简化但重要的情形下，求解爱因斯坦方程的关键组成部分——哈密顿约束。通过完成这个解析练习，您将深入理解如何从第一性原理出发，为多个黑洞构造初始条件。",
            "id": "3490067",
            "problem": "考虑一个三维流形上的真空爱因斯坦约束方程，该流形具有黎曼度规，并将根据广义相对论的柯西问题进行演化。设初始数据流形为 $\\mathbb{R}^{3}$，并采用共形方法，其中物理度规写作 $\\bar{g}_{ij} = \\phi^{4} \\gamma_{ij}$，物理外曲率写作 $\\bar{K}_{ij} = \\phi^{-2} A_{ij} + \\tfrac{1}{3}\\phi^{4}\\gamma_{ij} K$。这里，$\\gamma_{ij}$ 是一个选定的背景度规，$\\phi$ 是一个正共形因子，$K$ 是平均曲率，$A_{ij}$ 是关于 $\\gamma_{ij}$ 的对称横向无迹张量。假设真空情况，因此约束方程为哈密顿约束 $R(\\bar{g}) + K^{2} - \\bar{K}_{ij}\\bar{K}^{ij} = 0$ 和动量约束 $\\bar{\\nabla}^{j}\\bar{K}_{ij} - \\bar{\\nabla}_{i} K = 0$，其中 $R(\\bar{g})$ 是 $\\bar{g}_{ij}$ 的标量曲率，$\\bar{\\nabla}$ 是 $\\bar{g}_{ij}$ 的 Levi-Civita 联络。在共形方法中，哈密顿约束简化为 Lichnerowicz 方程\n$$\n\\Delta_{\\gamma} \\phi - \\tfrac{1}{8} R(\\gamma)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} A_{ij}A^{ij} - \\tfrac{1}{12}K^{2}\\phi^{5} = 0,\n$$\n其中 $\\Delta_{\\gamma}$ 和 $R(\\gamma)$ 分别是 $\\gamma_{ij}$ 的 Laplace-Beltrami 算子和标量曲率。\n\n处理时间对称数据，即 $K_{ij} = 0$，这意味着 $K = 0$ 且 $A_{ij} = 0$。在 $\\mathbb{R}^{3}$ 上选择一个共形平坦的背景度规 $\\gamma_{ij} = \\delta_{ij}$，使得 $R(\\gamma) = 0$。那么 $\\phi$ 在穿孔区域 $\\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{1},\\dots,\\mathbf{c}_{N}\\}$ 上满足简化后的方程\n$$\n\\Delta \\phi = 0\n$$\n，其中 $\\{\\mathbf{c}_{a}\\}_{a=1}^{N} \\subset \\mathbb{R}^{3}$ 是代表不同渐近平坦端的离散点。施加渐近平坦条件 $\\phi(\\mathbf{x}) \\to 1$ 当 $|\\mathbf{x}| \\to \\infty$ 时，并要求在每个穿孔点 $\\mathbf{c}_{a}$ 附近，共形因子具有局部行为\n$$\n\\phi(\\mathbf{x}) = \\frac{m_{a}}{2\\,|\\mathbf{x} - \\mathbf{c}_{a}|} + \\text{在 } \\mathbf{c}_{a} \\text{ 处正则},\n$$\n其中 $m_{a} > 0$（对于 $a = 1,\\dots,N$）是固定参数。仅使用真空约束和标准椭圆理论作为基本原理，确定在 $\\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{a}\\}$ 上满足这些边界条件的唯一调和函数 $\\phi(\\mathbf{x})$。以 $\\phi(\\mathbf{x})$ 的单个闭式解析表达式的形式给出你的最终答案。不需要数值近似，最终答案中也不应报告任何单位。",
            "solution": "该问题要求在爱因斯坦真空场方程的柯西问题背景下，根据一组特定的简化假设，求解共形因子 $\\phi$ 的唯一解。所提供的框架是用于构造初始数据的共形方法。\n\n控制共形因子 $\\phi$ 的核心方程是哈密顿约束，在共形分解中，它呈现为 Lichnerowicz 方程的形式：\n$$\n\\Delta_{\\gamma} \\phi - \\tfrac{1}{8} R(\\gamma)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} A_{ij}A^{ij} - \\tfrac{1}{12}K^{2}\\phi^{5} = 0.\n$$\n问题指明了几个条件：\n1.  初始数据是时间对称的，这意味着初始切片的外曲率消失，即 $\\bar{K}_{ij} = 0$。这表明其迹（平均曲率 $K=\\bar{g}^{ij}\\bar{K}_{ij}$）为零，其无迹部分 $A_{ij}$ 也为零。因此，$K=0$ 且 $A_{ij}=0$。\n2.  流形 $\\mathbb{R}^3$ 上的背景度规 $\\gamma_{ij}$ 被选为平坦的欧几里得度规，$\\gamma_{ij} = \\delta_{ij}$。平直度规的标量曲率为零，$R(\\gamma) = 0$。相应的 Laplace-Beltrami 算子 $\\Delta_{\\gamma}$ 变为 $\\mathbb{R}^3$ 上的标准拉普拉斯算子，记为 $\\Delta$。\n\n将这些条件 $R(\\gamma)=0$、$A_{ij}=0$ 和 $K=0$ 代入 Lichnerowicz 方程得到：\n$$\n\\Delta \\phi - \\tfrac{1}{8} (0)\\,\\phi + \\tfrac{1}{8}\\phi^{-7} (0) - \\tfrac{1}{12}(0)^{2}\\phi^{5} = 0,\n$$\n该方程简化为三维拉普拉斯方程：\n$$\n\\Delta \\phi(\\mathbf{x}) = 0.\n$$\n这个关于 $\\phi(\\mathbf{x})$ 的方程必须在区域 $\\mathcal{D} = \\mathbb{R}^{3} \\setminus \\{\\mathbf{c}_{1},\\dots,\\mathbf{c}_{N}\\}$ 上求解，其中 $\\{\\mathbf{c}_{a}\\}_{a=1}^{N}$ 是 $N$ 个离散点，并需满足一组边界条件。\n\n边界条件如下：\n1.  渐近平坦性：当 $|\\mathbf{x}| \\to \\infty$ 时，$\\phi(\\mathbf{x}) \\to 1$。此条件施加在区域的“无穷远边界”上。\n2.  穿孔点行为：在每个点 $\\mathbf{c}_{a}$ 附近，函数 $\\phi(\\mathbf{x})$ 必须表现出特定的奇异行为：\n    $$\n    \\phi(\\mathbf{x}) = \\frac{m_{a}}{2\\,|\\mathbf{x} - \\mathbf{c}_{a}|} + \\text{在 } \\mathbf{c}_{a} \\text{ 处正则}。\n    $$\n    术语“在 $\\mathbf{c}_{a}$ 处正则”意味着从 $\\phi(\\mathbf{x})$ 中减去奇异部分后的余项，在一个包含点 $\\mathbf{c}_{a}$ 的邻域内是一个调和函数。\n\n这个设置构成了势论中的一个标准边值问题。由于拉普拉斯方程是线性的偏微分方程，我们可以使用叠加原理来构造解。我们寻找一个在 $\\mathcal{D}$ 上是调和函数，并且在 $\\mathcal{D}$ 的边界（即在无穷远处和穿孔点 $\\mathbf{c}_{a}$ 处）满足指定行为的函数。\n\n让我们从基本调和函数开始构建解。常数函数是调和的。函数 $f(\\mathbf{x}) = 1/|\\mathbf{x}-\\mathbf{y}|$ 是三维拉普拉斯算子的基本解，并且对于所有 $\\mathbf{x} \\neq \\mathbf{y}$ 都是调和的。\n\n考虑解的以下一般形式，它是这些基本调和函数的线性组合：\n$$\n\\phi(\\mathbf{x}) = C + \\sum_{a=1}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|},\n$$\n其中 $C$ 和系数集 $\\{C_a\\}_{a=1}^{N}$ 是待定常数。根据构造，该函数在除了点 $\\mathbf{c}_a$ 之外的所有地方都是调和的，因此在区域 $\\mathcal{D}$ 上满足 $\\Delta\\phi=0$。\n\n现在我们应用边界条件来确定这些常数。首先，考察 $|\\mathbf{x}| \\to \\infty$ 时的渐近行为。在此极限下，求和的每一项都趋于零：\n$$\n\\lim_{|\\mathbf{x}| \\to \\infty} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|} = 0.\n$$\n因此，我们提出的解的极限是：\n$$\n\\lim_{|\\mathbf{x}| \\to \\infty} \\phi(\\mathbf{x}) = C.\n$$\n为了满足渐近平坦条件 $\\phi(\\mathbf{x}) \\to 1$，我们必须设定 $C=1$。候选解变为：\n$$\n\\phi(\\mathbf{x}) = 1 + \\sum_{a=1}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|}.\n$$\n接下来，我们施加每个穿孔点的条件。固定一个索引 $b \\in \\{1, \\dots, N\\}$ 并考察函数在 $\\mathbf{c}_b$ 附近的行为。我们可以将第 $b$ 项从和式中分离出来：\n$$\n\\phi(\\mathbf{x}) = \\frac{C_b}{|\\mathbf{x} - \\mathbf{c}_b|} + \\left( 1 + \\sum_{a=1, a \\neq b}^{N} \\frac{C_a}{|\\mathbf{x} - \\mathbf{c}_a|} \\right).\n$$\n括号内的表达式，我们称之为 $h_b(\\mathbf{x})$，是一个常数和形如 $1/|\\mathbf{x} - \\mathbf{c}_a|$（其中 $a \\neq b$）的函数之和。当 $\\mathbf{x}$ 趋近于 $\\mathbf{c}_b$ 时，对于 $a \\neq b$ 的所有分母 $|\\mathbf{x} - \\mathbf{c}_a|$ 都不趋于零。因此，$h_b(\\mathbf{x})$ 在 $\\mathbf{c}_b$ 的一个邻域内是良定义的、连续可微的和调和的。换句话说，$h_b(\\mathbf{x})$ 是解在 $\\mathbf{c}_b$ 处的“正则部分”。\n\n问题要求 $\\phi(\\mathbf{x})$ 在 $\\mathbf{c}_b$ 处的奇异部分恰好是 $\\frac{m_{b}}{2\\,|\\mathbf{x} - \\mathbf{c}_{b}|}$。通过将其与我们候选解的奇异部分 $\\frac{C_b}{|\\mathbf{x} - \\mathbf{c}_b|}$ 进行比较，我们可以唯一地确定系数 $C_b$：\n$$\nC_b = \\frac{m_b}{2}.\n$$\n这个逻辑适用于每个穿孔点 $a = 1, \\dots, N$。因此，我们确定了所有系数：$C_a = \\frac{m_a}{2}$。\n\n将这些系数代入我们的一般形式，得到唯一解：\n$$\n\\phi(\\mathbf{x}) = 1 + \\sum_{a=1}^{N} \\frac{m_a}{2|\\mathbf{x} - \\mathbf{c}_a|}.\n$$\n该函数在穿孔区域上满足拉普拉斯方程以及所有指定的边界条件。此解的唯一性由势论中关于外边值问题的标准定理保证。这个特定的解在相对论文献中被称为 Bowen-York 解，它对应于 $N$ 个黑洞的时间对称、共形平坦的初始数据。",
            "answer": "$$\n\\boxed{1 + \\sum_{a=1}^{N} \\frac{m_a}{2|\\mathbf{x} - \\mathbf{c}_a|}}\n$$"
        },
        {
            "introduction": "一旦设定了有效的初始数据，下一步就是将其在时间上进行演化。演化过程的稳定性关键取决于控制方程的双曲特性。这个动手数值练习  使用一个玩具模型，生动地展示了失去双曲性所带来的后果，其中一个糟糕的“规范”选择会导致问题变得不适定，并最终使模拟灾难性地崩溃。",
            "id": "3490105",
            "problem": "考虑一个简化的偏微分方程（PDE）模型，旨在模仿广义相对论（GR）中的规范选择如何影响演化方程的双曲性以及柯西问题的适定性。设 $u = u(t,x)$ 为一维空间域上的一个标量场，具有周期性边界条件，并考虑以下PDE\n$$\n\\partial_t^2 u(t,x) \\;=\\; g(t)\\,\\partial_x^2 u(t,x),\n$$\n该方程定义在周期性区间 $x \\in [0,2\\pi]$ 上，角度以弧度为单位。假设初始数据 $u(0,x)$ 和 $\\partial_t u(0,x)$ 是光滑的。\n\n你需要将其视为一个柯西问题，并分析主象征及其对类规范函数 $g(t)$ 的依赖性，展示当 $g(t)$ 变化时，该PDE的分类如何随之改变。其背景是数值相对论和引力波，其中全局双曲性保证了对于具有物理意义的规范，柯西问题是适定的；这个简化模型抽象地说明了选择不当的规范会如何破坏双曲性。\n\n定义与基本原理：\n- 柯西问题旨在探究，给定 $u(0,x)$ 和 $\\partial_t u(0,x)$，是否能得到一个对于 $t \\ge 0$ 连续依赖于初始数据的唯一解 $u(t,x)$。\n- 一个关于两个变量 $t,x$ 的二阶PDE，其主象征具有形式 $p(\\tau,\\xi;t) = A(t)\\,\\tau^2 + B(t)\\,\\tau\\,\\xi + C(t)\\,\\xi^2$，其中 $(\\tau,\\xi)$ 是余向量。该方程被分类为双曲型、抛物型或椭圆型，由判别式 $D(t) = B(t)^2 - 4 A(t) C(t)$ 决定。\n- 对于给定的PDE，$A(t) = 1$，$B(t) = 0$，$C(t) = -g(t)$，因此主象征为 $p(\\tau,\\xi;t) = \\tau^2 - g(t)\\,\\xi^2$。双曲性对应于实的特征速度，因此 $D(t) > 0$；椭圆性对应于 $D(t)  0$；抛物型退化对应于 $D(t) = 0$。\n- 在数值相对论中，全局双曲性确保演化方程以全局一致的方式保持双曲性，从而使得柯西问题在整个时空上是全局适定的。双曲性的丧失在这个简化模型中对应于全局双曲性的破坏。\n\n任务：\n1. 从主象征和判别式的定义出发，在你的解答中说明 $g(t)$ 的符号如何决定该PDE是双曲型、椭圆型还是退化型。然后，解释为什么当 $g(t) > 0$（双曲型）时初值问题是适定的，而当 $g(t)  0$（椭圆型）时是不适定的，并讨论抛物型/退化边界情况 $g(t) = 0$。\n2. 对于具有 $N_x$ 个等距点（角度以弧度为单位）的傅里叶谱方法空间离散，使用二阶精度显式时间步进格式对该PDE进行数值积分。使用初始数据 $u(0,x) = \\sin(x)$ 和 $\\partial_t u(0,x) = 0$。\n3. 为每个测试案例定义一个无量纲规范函数 $g(t)$，并在固定的时间窗口 $t \\in [0,T_{\\text{end}}]$ 内使用均匀的时间步长 $\\Delta t$ 进行模拟。为了数值稳定性和清晰性，请使用 $N_x = 256$，$T_{\\text{end}} = 2$ 和 $\\Delta t = 10^{-3}$。\n4. 追踪 $L^2$ 能量的平方\n$$\nE(t) \\;=\\; \\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)^2\\,dx,\n$$\n并定义能量增长因子 $R(t) = E(t)/E(0)$。将不适定性触发时间 $t_{\\text{onset}}$ 定义为 $R(t)$ 首次超过阈值 $R_{\\text{thr}} = 10$ 的最早时间。如果在 $T_{\\text{end}}$ 之前没有发生这种情况，则设置 $t_{\\text{onset}} = -1$。\n5. 实现以下规范函数 $g(t)$ 的测试套件：\n   - 案例1（全局双曲）：对于所有 $t \\in [0,T_{\\text{end}}]$，$g(t) = 1$。\n   - 案例2（双曲到椭圆的转变）：对于 $t \\in [0,T_{\\text{end}}]$，$g(t) = 1 - t$，该函数在 $t = 1$ 时从正值变为负值。\n   - 案例3（全局椭圆）：对于所有 $t \\in [0,T_{\\text{end}}]$，$g(t) = -1$。\n   - 案例4（退化边界）：对于所有 $t \\in [0,T_{\\text{end}}]$，$g(t) = 0$。\n6. 对每种情况，计算无量纲时间单位下的 $t_{\\text{onset}}$，并将这4个触发时间汇总到单行输出中，形式为一个用方括号括起来的逗号分隔列表。\n\n最终输出格式：\n- 你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[t_1,t_2,t_3,t_4]$），每个 $t_i$ 是一个浮点数，代表无量纲单位下的不适定性触发时间，若在模拟窗口内没有触发，则 $t_i = -1$。\n\n实现必须是自包含的，并且无需任何用户输入或外部文件即可按原样运行。所有角度均以弧度为单位，所有量均为无量纲。通过使用指定的数值参数并处理转变情况来确保科学真实性，以展示当主象征符号改变时不适定性的发生。输出必须严格遵循规定的单行格式。",
            "solution": "该问题提出了一个简化模型，用于分析在数值相对论中出现的偏微分方程（PDE）的柯西问题适定性。我们给定一个二阶线性PDE，$\\partial_t^2 u(t,x) = g(t)\\,\\partial_x^2 u(t,x)$，其中函数 $g(t)$ 作为一个“规范选择”，可以改变方程的基本性质。我们首先将对PDE的分类及其对初值问题的影响进行理论分析。随后，我们将描述用于模拟演化并检测不适定性触发的数值格式。\n\n### 理论分析：PDE分类与适定性\n\n给定的PDE是\n$$ \\partial_t^2 u(t,x) = g(t)\\,\\partial_x^2 u(t,x) $$\n可以重写为\n$$ \\partial_t^2 u(t,x) - g(t)\\,\\partial_x^2 u(t,x) = 0. $$\n为对此PDE进行分类，我们分析其主象征。对于一个关于两个变量 $(t,x)$ 的一般二阶PDE，$\\sum_{i,j} A_{ij} \\partial_i \\partial_j u + \\dots = 0$，其主象征是通过将每个偏导数 $\\partial_i$ 替换为对应的余向量分量 $\\sigma_i$ 来获得的。这里，我们使用 $(\\tau, \\xi)$ 作为与 $(t,x)$ 对偶的余向量。我们将PDE中最高阶项的 $\\partial_t \\rightarrow \\tau$ 和 $\\partial_x \\rightarrow \\xi$ 进行替换。这得到特征多项式：\n$$ p(\\tau, \\xi; t) = \\tau^2 - g(t)\\xi^2. $$\n这是 $(\\tau, \\xi)$ 的一个二次型。它被分类为双曲型、椭圆型或抛物型，取决于其判别式。对于一般形式 $A\\tau^2 + B\\tau\\xi + C\\xi^2$，判别式为 $D = B^2 - 4AC$。在我们的例子中，$A = 1$，$B = 0$，$C = -g(t)$。因此判别式为：\n$$ D(t) = (0)^2 - 4(1)(-g(t)) = 4g(t). $$\n在给定时间 $t$，PDE的分类直接取决于 $g(t)$ 的符号：\n\n1.  **双曲情况 ($g(t) > 0$):** 如果 $g(t) > 0$，则判别式 $D(t) > 0$。特征方程 $p(\\tau, \\xi; t) = 0$ 对于 $\\tau/\\xi$ 有两个不同的实根，由 $\\tau/\\xi = \\pm\\sqrt{g(t)}$ 给出。这些根代表了信息传播的特征速度 $c(t) = \\pm\\sqrt{g(t)}$。由于这些速度是实数且有限，任何点 $(t_0, x_0)$ 的依赖域在初始切片 $t=0$ 上是一个有限区间。这保证了柯西问题是适定的：存在唯一解，并且该解连续依赖于初始数据。这是类波现象的情况。\n\n2.  **椭圆情况 ($g(t)  0$):** 如果 $g(t)  0$，则判别式 $D(t)  0$。特征速度变为纯虚数，$c(t) = \\pm\\sqrt{-|g(t)|} = \\pm i\\sqrt{|g(t)|}$。这表示缺乏实值的“传播速度”。椭圆型PDE不支持适定的初值问题。为了理解原因，考虑一个形如 $u(t,x) \\propto e^{ikx}$ 的傅里叶模解，其中 $k$ 是某个波数。将其代入PDE，得到关于时间相关振幅 $\\hat{u}_k(t)$ 的常微分方程（ODE）：\n    $$ \\frac{d^2\\hat{u}_k}{dt^2} = g(t)(-k^2)\\hat{u}_k = -g(t)k^2\\hat{u}_k. $$\n    当 $g(t)  0$ 时，右侧的系数 $-g(t)k^2$ 为正。该ODE为 $\\ddot{\\hat{u}}_k = \\omega_k(t)^2 \\hat{u}_k$，其中频率 $\\omega_k(t) = k\\sqrt{|g(t)|}$ 为实数。通解包含与 $e^{\\int \\omega_k(t) dt}$ 成比例的项。对于更高的波数 $k$，这个指数增长因子更大。因此，初始数据中的任何高频分量（包括数值舍入误差）将以任意快的速率被放大，导致解的灾难性崩溃。该问题是不适定的。\n\n3.  **抛物型/退化情况 ($g(t) = 0$):** 如果 $g(t) = 0$，则判别式 $D(t) = 0$。PDE简化为 $\\partial_t^2 u = 0$。特征速度为零。解就是 $u(t,x) = u(0,x) + t\\,\\partial_t u(0,x)$。每个空间点 $x$ 的演化都与其邻近点无关。虽然是退化的，但该方程的柯西问题仍然是适定的。\n\n### 数值实现\n\n为了通过数值方法研究这些行为，我们对PDE进行离散化，并针对给定的初始数据和测试案例求解。\n\n**空间离散：** 问题指定了一个周期性域 $x \\in [0, 2\\pi]$，这非常适合使用傅里叶谱方法。我们在由 $N_x$ 个等距点 $x_j = 2\\pi j/N_x$（其中 $j=0, \\dots, N_x-1$）组成的网格上表示解 $u(t,x)$。二阶空间导数 $\\partial_x^2 u$ 在傅里叶空间中可以高效、高精度地计算。令 $\\hat{u}_k(t)$ 为网格值 $u(t, x_j)$ 的离散傅里叶变换（DFT）。那么二阶导数的变换是 $(-k^2)\\hat{u}_k(t)$，其中 $k$ 是整数波数。该操作执行如下：\n1. 计算 $u$ 的DFT：$\\hat{u} = \\text{FFT}(u)$。\n2. 乘以 $-k^2$：$\\widehat{\\partial_x^2 u} = -k^2 \\hat{u}$。\n3. 计算逆DFT：$\\partial_x^2 u = \\text{IFFT}(\\widehat{\\partial_x^2 u})$。\n\n**时间离散：** 我们使用一个二阶精度的显式时间步进格式。蛙跳法是处理时间上二阶方程的标准选择。给定 $u^n \\approx u(n\\Delta t)$，更新规则为：\n$$ u^{n+1} = 2u^n - u^{n-1} + (\\Delta t)^2 \\, g(n\\Delta t) \\, (\\partial_x^2 u)^n, $$\n其中 $(\\partial_x^2 u)^n$ 是在时间 $n\\Delta t$ 处计算的空间导数。这是一个两步法，需要前两个时间层级的解 $u^n$ 和 $u^{n-1}$。a\n为了初始化该格式，我们需要 $u^0$ 和 $u^1$。$u^0 = u(0,x)$ 是给定的。我们使用围绕 $t=0$ 的二阶泰勒展开来计算 $u^1$：\n$$ u^1 \\approx u(0,x) + \\Delta t \\, \\partial_t u(0,x) + \\frac{(\\Delta t)^2}{2} \\partial_t^2 u(0,x). $$\n利用初始数据 $\\partial_t u(0,x) = 0$ 和PDE本身来求得 $\\partial_t^2 u(0,x) = g(0)\\,\\partial_x^2 u(0,x)$，第一步变为：\n$$ u^1 = u^0 + \\frac{(\\Delta t)^2}{2} g(0) (\\partial_x^2 u)^0. $$\n有了 $u^0$ 和 $u^1$ 后，我们设置 $u_{\\text{prev}} = u^0$ 和 $u_{\\text{curr}} = u^1$ 来开始主蛙跳循环。\n\n**不适定性分析：** 我们监控解的 $L^2$ 能量平方，对于周期域，其定义为 $E(t) = \\frac{1}{2\\pi}\\int_0^{2\\pi} u(t,x)^2 dx$。在数值上，这近似为网格值的平方均值：$E(t) \\approx \\frac{1}{N_x} \\sum_{j=0}^{N_x-1} u(t,x_j)^2$。能量增长因子 $R(t) = E(t)/E(0)$ 追踪解的稳定性。不适定性表现为能量的快速、无界增长。我们将触发时间 $t_{\\text{onset}}$ 定义为 $R(t)$ 首次超过阈值 $R_{\\text{thr}} = 10$ 的时间 $t$。如果到最终时间 $T_{\\text{end}} = 2$ 仍未达到该阈值，我们设置 $t_{\\text{onset}} = -1$。\n\n### 测试案例的预期行为\n\n1.  **案例1 ($g(t) = 1$)：** 这是标准波动方程。解析解为 $u(t,x) = \\sin(x)\\cos(t)$。能量为 $E(t) = E(0)\\cos^2(t)$，是有界的。我们预期 $R(t) \\le 1$，因此 $t_{\\text{onset}} = -1$。\n2.  **案例2 ($g(t) = 1 - t$)：** 方程在 $t  1$ 时是双曲型的，在 $t > 1$ 时是椭圆型的。解应在 $t=1$ 之前保持稳定，之后高频数值噪声将开始指数增长。我们预期 $t_{\\text{onset}}$ 会略大于1。\n3.  **案例3 ($g(t) = -1$)：** 方程在所有 $t \\ge 0$ 时都是椭圆型的。高频模式将从一开始就指数增长。触发时间将由增长最快的模式 $k_{\\text{max}} = N_x/2 = 128$ 的增长决定，并且应该非常短。\n4.  **案例4 ($g(t) = 0$)：** 方程为 $\\partial_t^2 u = 0$。在初始速度为零的情况下，解是静态的：$u(t,x) = u(0,x) = \\sin(x)$。能量是恒定的，所以 $t_{\\text{onset}} = -1$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_onset_time(g_func, T_end, dt, Nx, R_thr):\n    \"\"\"\n    Solves the PDE u_tt = g(t) u_xx and finds the onset time of ill-posedness.\n\n    Args:\n        g_func (callable): The gauge function g(t).\n        T_end (float): The end time of the simulation.\n        dt (float): The time step.\n        Nx (int): The number of spatial grid points.\n        R_thr (float): The energy growth ratio threshold.\n\n    Returns:\n        float: The onset time, or -1.0 if no onset occurs.\n    \"\"\"\n    # 1. Setup spatial grid and wavenumbers\n    x = np.linspace(0, 2 * np.pi, Nx, endpoint=False)\n    # Wavenumbers for numpy's FFT\n    k = np.fft.fftfreq(Nx, d=1.0 / Nx)\n\n    # 2. Set initial conditions\n    u_0 = np.sin(x)\n    v_0 = np.zeros(Nx)  # du/dt(0, x) = 0\n\n    # 3. Calculate initial energy\n    E0 = np.mean(u_0**2)\n    # If initial energy is zero, growth factor is ill-defined.\n    if E0  1e-16: # A small tolerance for floating point\n        return -1.0\n\n    # 4. Initialize the time-stepping scheme (Leapfrog)\n    # The leapfrog scheme u_next = 2*u_curr - u_prev + dt^2 * accel\n    # requires a startup step. We use a Taylor expansion to find u(dt).\n    # u(dt) ~= u(0) + dt*v(0) + 0.5*dt^2*a(0)\n    # where a(0) = g(0)*d^2u/dx^2(0).\n\n    # Calculate acceleration at t=0\n    g_val_0 = g_func(0.0)\n    u_hat_0 = np.fft.fft(u_0)\n    d2u_dx2_hat_0 = -(k**2) * u_hat_0\n    d2u_dx2_0 = np.fft.ifft(d2u_dx2_hat_0).real\n    accel_0 = g_val_0 * d2u_dx2_0\n\n    # Compute u at the first time step, t=dt\n    u_1 = u_0 + dt * v_0 + 0.5 * dt**2 * accel_0\n\n    # Setup for the main loop\n    u_prev = u_0  # Solution at time t-dt\n    u_curr = u_1  # Solution at time t\n    t = dt\n\n    num_steps = int(round(T_end / dt))\n\n    # 5. Main evolution loop\n    # We already computed the state at step 1 (t=dt), so we loop from step 2.\n    for i in range(1, num_steps):\n        # Calculate acceleration at the current time t\n        g_val = g_func(t)\n        u_hat = np.fft.fft(u_curr)\n        d2u_dx2_hat = -(k**2) * u_hat\n        d2u_dx2 = np.fft.ifft(d2u_dx2_hat).real\n        accel = g_val * d2u_dx2\n\n        # Perform the leapfrog step to find u at t+dt\n        u_next = 2 * u_curr - u_prev + dt**2 * accel\n\n        # Update state variables for the next iteration\n        u_prev = u_curr\n        u_curr = u_next\n        t += dt\n\n        # 6. Check for ill-posedness onset\n        # Calculate energy and growth factor\n        E = np.mean(u_curr**2)\n        R = E / E0\n\n        if R > R_thr:\n            return t\n\n    # If the loop completes without exceeding the threshold\n    return -1.0\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (globally hyperbolic)\n        {'name': 'Case 1', 'g_func': lambda t: 1.0},\n        # Case 2 (hyperbolic-to-elliptic transition)\n        {'name': 'Case 2', 'g_func': lambda t: 1.0 - t},\n        # Case 3 (globally elliptic)\n        {'name': 'Case 3', 'g_func': lambda t: -1.0},\n        # Case 4 (degenerate boundary)\n        {'name': 'Case 4', 'g_func': lambda t: 0.0}\n    ]\n\n    # Simulation parameters\n    Nx = 256\n    T_end = 2.0\n    dt = 1e-3\n    R_thr = 10.0\n\n    results = []\n    for case in test_cases:\n        t_onset = compute_onset_time(\n            g_func=case['g_func'],\n            T_end=T_end,\n            dt=dt,\n            Nx=Nx,\n            R_thr=R_thr\n        )\n        # Round the result to a reasonable number of decimal places\n        # to match the time step precision for a clean output.\n        if t_onset != -1.0:\n            results.append(round(t_onset, 4))\n        else:\n            results.append(t_onset)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "爱因斯坦方程的稳健双曲形式的一个标志是，它们能以物理上合理的方式处理不完美之处，例如数值误差或残余的约束违反。这个数值实验  让您能够验证这一行为的一个关键方面：约束违反的传播是因果的，其速度从不超过光速。这个实践加强了全局双曲性这一数学属性与数值模拟的物理可预测性之间的联系。",
            "id": "3490117",
            "problem": "要求您在一个全局双曲时空内，对一个简化的爱因斯坦场方程（EFE）模型中的微小约束违背的因果传播进行形式化和测试。任务是从一个具有微小但非零的哈密顿约束和动量约束违背的初始数据切片上的柯西问题开始，并通过数值方法验证，在线性化双曲传播模型下，这些违背被限制在解析光锥之内。\n\n基本的基础包括以下定义和事实：\n- 如果一个时空允许存在一个柯西超曲面，使得任何子集的依赖域都有良好定义，且因果曲线不表现出闭合类时曲线，则该时空是全局双曲的。对于全局双曲时空，双曲系统的柯西问题是适定的。\n- 在广义相对论（GR）的适当双曲表述中，例如 Z4 约束表述（Z4c）或广义谐波表述，围绕闵可夫斯基时空线性化的约束传播系统，在光速归一化为 $c=1$ 的情况下，可简化为针对哈密顿约束违背 $\\mathcal{H}$ 和动量约束违背 $\\mathcal{M}$ 的类波动方程。\n- 在这些表述中，约束的主部可以由一维波动方程建模\n$$\n\\partial_t^2 \\mathcal{H} - c_{\\mathcal{H}}^2 \\, \\partial_x^2 \\mathcal{H} = 0, \\quad\n\\partial_t^2 \\mathcal{M} - c_{\\mathcal{M}}^2 \\, \\partial_x^2 \\mathcal{M} = 0,\n$$\n其中特征速度为 $c_{\\mathcal{H}}, c_{\\mathcal{M}} \\in [0,1]$。限制在解析光锥内要求，在以 $c=1$ 为单位的系统中，测得的传播速度不超过 $1$。\n\n您的程序必须通过以下方式实现一个数值实验来验证这种限制：\n- 使用一个长度为 $L$ 的一维空间域，带有周期性边界条件，并将其离散化为 $N_x$ 个均匀点，间距为 $\\Delta x = L/N_x$。时间积分执行至最终时间 $T$，使用一个稳定的显式格式和满足最大特征速度的 Courant–Friedrichs–Lewy (CFL) 条件的时间步长 $\\Delta t$。\n- 在 $t=0$ 时，用一个以 $x=0$ 为中心、初始时间导数为零的高斯形式的微小、平滑违背来初始化两个约束场：\n$$\n\\mathcal{H}(x,0) = \\varepsilon \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right), \\quad \\partial_t \\mathcal{H}(x,0) = 0,\n$$\n$$\n\\mathcal{M}(x,0) = \\varepsilon \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right), \\quad \\partial_t \\mathcal{M}(x,0) = 0,\n$$\n其中 $\\varepsilon > 0$ 是一个小数，$\\sigma>0$设定了宽度。\n- 根据各自的速度 $c_{\\mathcal{H}}$ 和 $c_{\\mathcal{M}}$，在它们各自的波动方程下演化 $\\mathcal{H}$ 和 $\\mathcal{M}$。\n\n为了量化限制，将场 $u(x,t)$ 在时间 $t$ 时相对于中心 $x_0=0$ 的瞬时支撑半径定义为场振幅超过指定阈值的最大距离：\n$$\nR[u](t) := \\max\\{ |x - x_0| \\, : \\, |u(x,t)| \\ge \\theta \\},\n$$\n其中绝对阈值为 $\\theta = f \\, \\varepsilon$，$f \\in (0,1)$ 是一个固定的分数，对所有测试用例都相同。在区间 $[t_1,t_2]$ 上的传播速度估计为\n$$\nv[u] \\approx \\frac{R[u](t_2) - R[u](t_1)}{t_2 - t_1},\n$$\n其中 $t_1 = T/2$ 且 $t_2 = T$。如果在小的数值容差范围内，$v[\\mathcal{H}] \\le 1$ 且 $v[\\mathcal{M}] \\le 1$ 成立，则验证了在解析光锥内的限制。\n\n您的程序必须：\n- 使用在空间和时间上均为二阶精确、且在标准 CFL 限制下稳定的相容、显式格式来离散化波动方程。确保所选时间 $t_1$ 和 $t_2$ 满足 $0  t_1  t_2 \\le T$，并且波在 $[0,T]$ 期间不会到达周期性边界，以避免环绕效应影响估计。\n- 对所有测试用例使用统一的阈值分数 $f$，并对不等式检查使用统一的数值容差 $\\tau$。\n\n实现上述内容并评估以下测试套件。每个元组为 $(c_{\\mathcal{H}}, c_{\\mathcal{M}}, L, N_x, \\sigma, \\varepsilon, T)$：\n1. $(1.0, 0.8, 100.0, 1200, 1.5, 10^{-3}, 20.0)$\n2. $(0.9, 0.9, 60.0, 900, 1.0, 5\\times 10^{-4}, 20.0)$\n3. $(0.0, 0.8, 80.0, 800, 2.0, 10^{-3}, 25.0)$\n\n使用光速为 $1$ 的单位制，因此所有速度都是无量纲的。不涉及角度。您的程序必须产生唯一的输出，即一行包含一个逗号分隔的 Python 布尔值列表，每个测试用例对应一个布尔结果。如果 $v[\\mathcal{H}] \\le 1$ 和 $v[\\mathcal{M}] \\le 1$ (均在数值容差内) 都成立，则对应的布尔值为真，否则为假。例如，格式必须严格如下所示：\n[True,False,True]",
            "solution": "该问题要求进行一个数值实验，以验证广义相对论简化模型中的约束违背是否进行因果传播，即传播速度不快于光速 $c=1$。该模型基于一维线性波动方程，该方程描述了哈密顿约束违背 $\\mathcal{H}$ 和动量约束违背 $\\mathcal{M}$ 的演化。代表 $\\mathcal{H}$ 或 $\\mathcal{M}$ 的通用场 $u(x,t)$ 的控制方程为：\n$$\n\\partial_t^2 u - c_p^2 \\, \\partial_x^2 u = 0\n$$\n其中 $c_p$ 是与该场相关的特征传播速度（$c_{\\mathcal{H}}$ 或 $c_{\\mathcal{M}}$）。假设时空是全局双曲的，这确保了柯西问题是适定的。\n\n为了数值求解此方程，我们在离散网格上采用二阶精确的有限差分格式。长度为 $L$ 的空间域被离散化为 $N_x$ 个网格点 $x_j = -L/2 + j\\Delta x$（$j=0, \\dots, N_x-1$），均匀网格间距为 $\\Delta x = L/N_x$。时间域被离散化为大小为 $\\Delta t$ 的步长。场在网格点 $(x_j, t_n)$ 的值表示为 $u_j^n$。二阶偏导数使用中心差分近似：\n$$\n\\partial_t^2 u(x_j, t_n) \\approx \\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{\\Delta t^2}\n$$\n$$\n\\partial_x^2 u(x_j, t_n) \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\n$$\n将这些近似值代入波动方程，得到显式的“蛙跳”积分格式：\n$$\nu_j^{n+1} = 2u_j^n - u_j^{n-1} + \\lambda^2 (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n其中 $\\lambda = c_p \\Delta t / \\Delta x$ 是库朗数。该格式在空间和时间上都是二阶精确的。\n\n此显式格式的数值稳定性由 Courant–Friedrichs–Lewy (CFL) 条件决定，该条件要求 $\\lambda \\le 1$。为确保两个场的稳定性并为分析维持一致的时间网格，时间步长 $\\Delta t$ 由每个测试用例的最大特征速度 $c_{max} = \\max(c_{\\mathcal{H}}, c_{\\mathcal{M}})$ 确定：\n$$\n\\Delta t = \\alpha_{\\text{CFL}} \\frac{\\Delta x}{c_{max}}\n$$\n其中 $\\alpha_{\\text{CFL}}$ 是一个小于 $1$ 的安全因子。我们选择 $\\alpha_{\\text{CFL}} = 0.95$。如果 $c_{max}=0$，分母中可以使用任何非零值，因为传播速度 $c_p$ 将为零，无论 $\\Delta t$ 如何，库朗数都为零。\n\n初始条件由 $u(x,0) = \\varepsilon \\exp(-x^2/(2\\sigma^2))$ 和 $\\partial_t u(x,0) = 0$ 给出。由于蛙跳格式是一种三层方法，它需要时间层 $n$ 和 $n-1$ 的数据来计算 $n+1$ 层。为了初始化该格式，我们使用初始速度条件来求解第一个时间步 $t_1 = \\Delta t$ 处的解。用中心差分近似初始速度条件 $\\frac{u_j^1 - u_j^{-1}}{2\\Delta t} = 0$，意味着 $u_j^{-1} = u_j^1$。将此代入 $n=0$ 时的蛙跳更新公式，得到第一个时间步的特殊公式：\n$$\nu_j^1 = u_j^0 + \\frac{1}{2}\\lambda^2 (u_{j+1}^0 - 2u_j^0 + u_{j-1}^0)\n$$\n后续的时间步使用标准的三层公式进行。该域具有周期性边界条件，意味着网格是“环绕”的。这通过使用模运算访问相邻网格点来处理，使得最后一个点（$j=N_x-1$）的右邻居是第一个点（$j=0$），反之亦然。\n\n为了验证因果传播，需要测量波前沿的速度。支撑半径 $R[u](t)$ 定义为场振幅超过某个阈值 $\\theta$ 时，离中心 $x_0=0$ 的最大距离：\n$$\nR[u](t) := \\max\\{ |x_j| \\, : \\, |u(x_j,t)| \\ge \\theta \\}\n$$\n阈值选择为初始峰值振幅的一个小分数 $f$，即 $\\theta = f \\varepsilon$。我们设置 $f=0.01$。在时间区间 $[t_1, t_2]$（其中 $t_1=T/2$ 和 $t_2=T$）上的平均传播速度则估计为：\n$$\nv[u] \\approx \\frac{R[u](t_2) - R[u](t_1)}{t_2 - t_1}\n$$\n如果两个场测得的速度都小于或等于光速 $c=1$，则满足限制条件。为了考虑离散化中固有的数值误差（如数值色散），我们检查条件 $v[u] \\le 1 + \\tau$，其中 $\\tau$ 是一个小的数值容差。此处使用 $\\tau=0.05$ 的值。对于每个测试用例，当且仅当该条件对 $v[\\mathcal{H}]$ 和 $v[\\mathcal{M}]$ 都成立时，最终结果为 `True`。对于传播速度 $c_p$ 恰好为 $0$ 的特殊情况，方程简化为 $\\partial_t^2 u = 0$。在初始速度为零的情况下，解是静态的，$u(x,t) = u(x,0)$，导致测得的传播速度为 $v[u] = 0.0$，这自然满足因果性条件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical experiment for all test cases.\n    \"\"\"\n    \n    # Uniform parameters for all test cases as per the problem description.\n    # f: fraction of initial amplitude for thresholding.\n    F_THRESHOLD_FRACTION = 0.01\n    # tau: numerical tolerance for speed verification.\n    NUMERICAL_TOLERANCE = 0.05\n    # CFL safety factor.\n    CFL_FACTOR = 0.95\n\n    test_cases = [\n        # (c_H, c_M, L, Nx, sigma, epsilon, T)\n        (1.0, 0.8, 100.0, 1200, 1.5, 1e-3, 20.0),\n        (0.9, 0.9, 60.0, 900, 1.0, 5e-4, 20.0),\n        (0.0, 0.8, 80.0, 800, 2.0, 1e-3, 25.0)\n    ]\n\n    def solve_single_wave(c_prop, L, Nx, sigma, epsilon, T, c_max_for_dt):\n        \"\"\"\n        Solves the 1D wave equation for a single field using a leapfrog scheme.\n        \n        Args:\n            c_prop (float): Propagation speed for this specific wave.\n            L (float): Length of the spatial domain.\n            Nx (int): Number of spatial grid points.\n            sigma (float): Width of the initial Gaussian pulse.\n            epsilon (float): Amplitude of the initial Gaussian pulse.\n            T (float): Final evolution time.\n            c_max_for_dt (float): Maximum speed in the test case, to set a common dt.\n\n        Returns:\n            A tuple (u_t1, u_t2) containing the field states at times T/2 and T.\n        \"\"\"\n        x_grid = np.linspace(-L / 2, L / 2, Nx, endpoint=False)\n        dx = L / Nx\n\n        # If propagation speed is zero, the solution is static.\n        if c_prop == 0.0:\n            u_static = epsilon * np.exp(-x_grid**2 / (2 * sigma**2))\n            return u_static, u_static\n\n        # Set time step based on the max speed of the pair (H, M).\n        # Handle edge case where c_max is 0 to avoid division by zero.\n        dt = CFL_FACTOR * dx / c_max_for_dt if c_max_for_dt > 0 else 1.0\n        \n        num_steps = int(np.ceil(T / dt))\n        t1_step = int(np.ceil((T / 2) / dt))\n        t2_step = num_steps\n\n        # Initial conditions: u at t=0 and t=-dt (from du/dt=0)\n        u_prev = epsilon * np.exp(-x_grid**2 / (2 * sigma**2))\n\n        # First time step using du/dt(0) = 0 condition\n        courant_sq = (c_prop * dt / dx)**2\n        laplacian_u_prev = np.roll(u_prev, -1) - 2 * u_prev + np.roll(u_prev, 1)\n        u_curr = u_prev + 0.5 * courant_sq * laplacian_u_prev\n\n        u_at_t1 = None\n\n        # Time evolution loop (Leapfrog)\n        for n in range(1, num_steps + 1):\n            if n == t1_step:\n                u_at_t1 = u_curr.copy()\n\n            laplacian_u_curr = np.roll(u_curr, -1) - 2 * u_curr + np.roll(u_curr, 1)\n            u_next = 2 * u_curr - u_prev + courant_sq * laplacian_u_curr\n            u_prev, u_curr = u_curr, u_next\n        \n        u_at_t2 = u_curr\n        \n        # In case T/2 is less than one time step\n        if u_at_t1 is None:\n            u_at_t1 = u_prev if t1_step == 0 else u_curr\n\n        return u_at_t1, u_at_t2\n\n    def calculate_radius(u_field, x_grid, threshold):\n        \"\"\"Calculates the support radius of the field.\"\"\"\n        above_threshold_indices = np.where(np.abs(u_field) >= threshold)[0]\n        if len(above_threshold_indices) == 0:\n            return 0.0\n        return np.max(np.abs(x_grid[above_threshold_indices]))\n\n    results = []\n    for case in test_cases:\n        cH, cM, L, Nx, sigma, epsilon, T = case\n        \n        c_max = max(cH, cM)\n        x = np.linspace(-L / 2, L / 2, Nx, endpoint=False)\n        t1, t2 = T / 2, T\n        threshold = F_THRESHOLD_FRACTION * epsilon\n\n        # --- Solve for Hamiltonian constraint H ---\n        uH_t1, uH_t2 = solve_single_wave(cH, L, Nx, sigma, epsilon, T, c_max)\n        \n        # --- Solve for Momentum constraint M ---\n        uM_t1, uM_t2 = solve_single_wave(cM, L, Nx, sigma, epsilon, T, c_max)\n\n        # --- Analyze results ---\n        # Calculate radii for H\n        RH_t1 = calculate_radius(uH_t1, x, threshold)\n        RH_t2 = calculate_radius(uH_t2, x, threshold)\n        vH = (RH_t2 - RH_t1) / (t2 - t1) if (t2 - t1) > 0 else 0.0\n        \n        # Calculate radii for M\n        RM_t1 = calculate_radius(uM_t1, x, threshold)\n        RM_t2 = calculate_radius(uM_t2, x, threshold)\n        vM = (RM_t2 - RM_t1) / (t2 - t1) if (t2 - t1) > 0 else 0.0\n        \n        # Verify confinement condition with numerical tolerance\n        is_confined = (vH = 1.0 + NUMERICAL_TOLERANCE) and \\\n                      (vM = 1.0 + NUMERICAL_TOLERANCE)\n        \n        results.append(is_confined)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}