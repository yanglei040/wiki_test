{
    "hands_on_practices": [
        {
            "introduction": "The accuracy of a finite difference simulation is fundamentally determined by the stencils used to approximate derivatives. While low-order stencils are simple, modeling complex phenomena like gravitational waves demands high-order accuracy to minimize numerical errors over long evolutions. This exercise provides direct practice in the foundational technique of constructing a high-order finite difference stencil by systematically matching terms in a Taylor series expansion, a core skill for any developer of numerical relativity codes. ",
            "id": "3474408",
            "problem": "In the method-of-lines (MOL) approach to hyperbolic partial differential equations used in numerical relativity and gravitational wave modeling, spatial derivatives such as $u_{x}$ are approximated by finite differences on a uniform grid. Consider a uniform one-dimensional grid with spacing $\\Delta x$, grid points $x_{i} = x_{0} + i \\,\\Delta x$, and a smooth function $u(x)$ representing, for example, a characteristic field of a linearized gravitational wave propagation model. You will construct a centered finite-difference approximation to the first derivative $u_{x}(x_{i})$ using a symmetric seven-point stencil $\\{x_{i+k}\\}_{k=-3}^{3}$. Assume a representation of the form\n$$\nu_{x}(x_{i}) \\approx \\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_{k} \\, u(x_{i+k}),\n$$\nwhere the coefficients $c_{k}$ are to be chosen to achieve sixth-order accuracy.\n\nStarting from the Taylor series expansion of $u(x_{i+k})$ about $x_{i}$ and imposing the necessary order conditions so that the truncation error in the approximation to $u_{x}(x_{i})$ is $\\mathcal{O}(\\Delta x^{6})$, derive the coefficients $\\{c_{k}\\}_{k=-3}^{3}$ for the symmetric seven-point stencil. Use the fact that the stencil is centered and the derivative is odd to justify that $c_{0} = 0$ and $c_{-k} = -c_{k}$ for $k=1,2,3$. Express your final result as the ordered coefficient row vector\n$$\n\\big(c_{-3},\\, c_{-2},\\, c_{-1},\\, c_{0},\\, c_{1},\\, c_{2},\\, c_{3}\\big)\n$$\nwith the overall factor $1/\\Delta x$ understood to multiply the discrete sum. No rounding is required.",
            "solution": "The problem requires the derivation of the coefficients $\\{c_k\\}$ for a sixth-order accurate, centered finite-difference approximation to the first derivative $u_x(x_i)$. The approximation is defined on a uniform grid with spacing $\\Delta x$ and uses a symmetric seven-point stencil $\\{x_{i+k}\\}_{k=-3}^{3}$. The formula is given as:\n$$\nu_x(x_i) \\approx \\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_k \\, u(x_{i+k})\n$$\nTo determine the coefficients, we expand each term $u(x_{i+k}) = u(x_i + k\\Delta x)$ in a Taylor series around the point $x_i$. Let $u^{(n)}(x_i)$ denote the $n$-th derivative of $u$ at $x_i$. The Taylor series is:\n$$\nu(x_i + k\\Delta x) = \\sum_{n=0}^{\\infty} \\frac{(k\\Delta x)^n}{n!} u^{(n)}(x_i)\n$$\nSubstituting this into the finite-difference formula, we get:\n$$\n\\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_k \\left( \\sum_{n=0}^{\\infty} \\frac{(k\\Delta x)^n}{n!} u^{(n)}(x_i) \\right)\n$$\nBy swapping the order of summation, we can group terms by derivatives of $u$:\n$$\n\\sum_{n=0}^{\\infty} \\left( \\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_k \\frac{(k\\Delta x)^n}{n!} \\right) u^{(n)}(x_i) = \\sum_{n=0}^{\\infty} \\left( \\sum_{k=-3}^{3} c_k k^n \\right) \\frac{(\\Delta x)^{n-1}}{n!} u^{(n)}(x_i)\n$$\nWe want this expression to be an approximation of $u_x(x_i) = u^{(1)}(x_i)$. This means the coefficient of $u^{(1)}(x_i)$ must be $1$, and the coefficients of other derivatives $u^{(n)}(x_i)$ (for $n \\neq 1$) should be zero up to the desired order of accuracy. For sixth-order accuracy, the truncation error must be $\\mathcal{O}(\\Delta x^6)$. This means the coefficients of $(\\Delta x)^{n-1} u^{(n)}(x_i)$ must vanish for $n=0, 2, 3, 4, 5, 6$.\n\nThis leads to the following system of equations for the coefficients $c_k$:\n\\begin{enumerate}\n    \\item Coefficient of $u^{(0)}(x_i)$: $\\sum_{k=-3}^{3} c_k k^0 = 0$\n    \\item Coefficient of $u^{(1)}(x_i)$: $\\frac{(\\Delta x)^{1-1}}{1!} \\sum_{k=-3}^{3} c_k k^1 = 1 \\implies \\sum_{k=-3}^{3} c_k k = 1$\n    \\item Coefficient of $u^{(2)}(x_i)$: $\\sum_{k=-3}^{3} c_k k^2 = 0$\n    \\item Coefficient of $u^{(3)}(x_i)$: $\\sum_{k=-3}^{3} c_k k^3 = 0$\n    \\item Coefficient of $u^{(4)}(x_i)$: $\\sum_{k=-3}^{3} c_k k^4 = 0$\n    \\item Coefficient of $u^{(5)}(x_i)$: $\\sum_{k=-3}^{3} c_k k^5 = 0$\n    \\item Coefficient of $u^{(6)}(x_i)$: $\\sum_{k=-3}^{3} c_k k^6 = 0$\n\\end{enumerate}\nThe first non-vanishing higher-order term will be the coefficient of $u^{(7)}(x_i)$, leading to a truncation error proportional to $(\\Delta x)^6 u^{(7)}(x_i)$.\n\nThe problem states that due to the centered stencil and the odd nature of the first derivative, the coefficients must satisfy the anti-symmetry condition $c_{-k} = -c_k$. This implies $c_0 = -c_0$, which forces $c_0 = 0$. This property significantly simplifies the system of equations.\n\nLet's examine the sums for even and odd powers of $k$:\nFor any even power $n=2m$ (where $m=0, 1, 2, 3, \\dots$):\n$$\n\\sum_{k=-3}^{3} c_k k^{2m} = c_0 \\cdot 0^{2m} + \\sum_{k=1}^{3} (c_k k^{2m} + c_{-k}(-k)^{2m}) = 0 + \\sum_{k=1}^{3} (c_k k^{2m} - c_k k^{2m}) = 0\n$$\nThis demonstrates that equations $1$, $3$, $5$, and $7$ (for $n=0, 2, 4, 6$) are automatically satisfied by the anti-symmetry of the coefficients.\n\nFor any odd power $n=2m+1$ (where $m=0, 1, 2, \\dots$):\n$$\n\\sum_{k=-3}^{3} c_k k^{2m+1} = c_0 \\cdot 0^{2m+1} + \\sum_{k=1}^{3} (c_k k^{2m+1} + c_{-k}(-k)^{2m+1}) = 0 + \\sum_{k=1}^{3} (c_k k^{2m+1} - c_k(-k^{2m+1})) = 2 \\sum_{k=1}^{3} c_k k^{2m+1}\n$$\nApplying this to the remaining equations for odd $n$:\n\\begin{itemize}\n    \\item $n=1$: $2 \\sum_{k=1}^{3} c_k k = 1 \\implies c_1 + 2c_2 + 3c_3 = \\frac{1}{2}$\n    \\item $n=3$: $2 \\sum_{k=1}^{3} c_k k^3 = 0 \\implies c_1 + 8c_2 + 27c_3 = 0$\n    \\item $n=5$: $2 \\sum_{k=1}^{3} c_k k^5 = 0 \\implies c_1 + 32c_2 + 243c_3 = 0$\n\\end{itemize}\nWe now have a system of three linear equations for the three unknown coefficients $c_1, c_2, c_3$:\n$$\n\\begin{array}{rcrcrcr}\nc_1  +  2c_2  +  3c_3  =  1/2 \\\\\nc_1  +  8c_2  +  27c_3  =  0 \\\\\nc_1  +  32c_2  +  243c_3  =  0\n\\end{array}\n$$\nTo solve this system, we use elimination. Subtracting the second equation from the third gives:\n$$\n(32-8)c_2 + (243-27)c_3 = 0 \\implies 24c_2 + 216c_3 = 0\n$$\nDividing by $24$, we find a relationship between $c_2$ and $c_3$:\n$$\nc_2 + 9c_3 = 0 \\implies c_2 = -9c_3\n$$\nNext, subtract the first equation from the second:\n$$\n(8-2)c_2 + (27-3)c_3 = 0 - \\frac{1}{2} \\implies 6c_2 + 24c_3 = -\\frac{1}{2}\n$$\nSubstitute $c_2 = -9c_3$ into this equation:\n$$\n6(-9c_3) + 24c_3 = -\\frac{1}{2} \\implies -54c_3 + 24c_3 = -\\frac{1}{2}\n$$\n$$\n-30c_3 = -\\frac{1}{2} \\implies c_3 = \\frac{1}{60}\n$$\nNow we can find $c_2$:\n$$\nc_2 = -9c_3 = -9 \\left( \\frac{1}{60} \\right) = -\\frac{9}{60} = -\\frac{3}{20}\n$$\nFinally, we find $c_1$ using the first equation:\n$$\nc_1 = \\frac{1}{2} - 2c_2 - 3c_3 = \\frac{1}{2} - 2\\left(-\\frac{3}{20}\\right) - 3\\left(\\frac{1}{60}\\right)\n$$\n$$\nc_1 = \\frac{1}{2} + \\frac{6}{20} - \\frac{3}{60} = \\frac{1}{2} + \\frac{3}{10} - \\frac{1}{20}\n$$\nUsing a common denominator of $20$:\n$$\nc_1 = \\frac{10}{20} + \\frac{6}{20} - \\frac{1}{20} = \\frac{15}{20} = \\frac{3}{4}\n$$\nSo, the coefficients are $c_1 = \\frac{3}{4}$, $c_2 = -\\frac{3}{20}$, and $c_3 = \\frac{1}{60}$.\nThe complete set of coefficients for the symmetric seven-point stencil is:\n$$\nc_3 = \\frac{1}{60}\n$$\n$$\nc_2 = -\\frac{3}{20}\n$$\n$$\nc_1 = \\frac{3}{4}\n$$\n$$\nc_0 = 0\n$$\n$$\nc_{-1} = -c_1 = -\\frac{3}{4}\n$$\n$$\nc_{-2} = -c_2 = \\frac{3}{20}\n$$\n$$\nc_{-3} = -c_3 = -\\frac{1}{60}\n$$\nThe problem asks for the ordered coefficient row vector $(c_{-3}, c_{-2}, c_{-1}, c_0, c_1, c_2, c_3)$. This vector is:\n$$\n\\left(-\\frac{1}{60}, \\frac{3}{20}, -\\frac{3}{4}, 0, \\frac{3}{4}, -\\frac{3}{20}, \\frac{1}{60}\\right)\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{60}  \\frac{3}{20}  -\\frac{3}{4}  0  \\frac{3}{4}  -\\frac{3}{20}  \\frac{1}{60} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A finite difference scheme does not solve the original partial differential equation, but rather a 'modified' equation that includes higher-order terms from the truncation error. This practice introduces the powerful technique of modified equation analysis, which reveals the true continuum behavior of a discrete scheme. By deriving the modified equation for the simple yet ubiquitous upwind scheme, you will uncover the origin of 'numerical viscosity'—a form of artificial dissipation crucial for the stability and qualitative behavior of many numerical methods. ",
            "id": "3474375",
            "problem": "Consider the linear advection of a characteristic scalar field arising from the linearized Einstein equations in a numerical relativity code, modeled by the hyperbolic partial differential equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a0$. Assume a uniform spatial grid with points $x_{i} = i\\,\\Delta x$ and a uniform time step $t_{n} = n\\,\\Delta t$, and let $u_{i}^{n}$ denote the finite difference approximation to $u(x_{i}, t_{n})$. You are to construct the explicit, first-order upwind finite difference scheme that is consistent with causality for $a0$ by using a forward Euler time update and a one-sided backward difference approximation for the spatial derivative $u_{x}$. Define the Courant–Friedrichs–Lewy (CFL) number $\\lambda = a\\,\\Delta t / \\Delta x$.\n\nUsing only standard Taylor expansions about $(x_{i}, t_{n})$ and the continuous equation $u_{t} + a\\,u_{x} = 0$ to eliminate time derivatives in favor of spatial derivatives, derive the leading-order modified equation that the upwind scheme solves. From your derivation, identify the effective numerical viscosity coefficient $\\nu$ multiplying $u_{xx}$ in the modified equation of the form\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx} + \\text{higher-order terms}.\n$$\nProvide $\\nu$ explicitly as a closed-form analytic expression in terms of $a$, $\\Delta x$, and $\\lambda$. Your final answer must be a single analytic expression. Do not round; no units are required.",
            "solution": "The problem requires the derivation of the numerical viscosity coefficient for the first-order upwind finite difference scheme applied to the linear advection equation.\n\nThe governing partial differential equation (PDE) is the linear advection equation:\n$$\nu_{t} + a\\,u_{x} = 0\n$$\nwhere $u$ is a scalar field, $t$ is time, $x$ is the spatial coordinate, and $a0$ is the constant advection speed. Subscripts denote partial differentiation, i.e., $u_{t} = \\frac{\\partial u}{\\partial t}$ and $u_{x} = \\frac{\\partial u}{\\partial x}$.\n\nWe discretize this equation on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$, such that $x_{i} = i\\,\\Delta x$ and $t_{n} = n\\,\\Delta t$. The numerical solution at a grid point is denoted by $u_{i}^{n} \\approx u(x_{i}, t_{n})$.\n\nThe problem specifies the construction of an explicit, first-order upwind scheme. This involves:\n1.  A forward Euler difference for the time derivative, evaluated at $(x_{i}, t_{n})$:\n    $$\n    u_{t} \\approx \\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t}\n    $$\n2.  A one-sided backward difference for the spatial derivative, which is the correct \"upwind\" direction since the advection speed $a$ is positive (information propagates from smaller $x$ to larger $x$):\n    $$\n    u_{x} \\approx \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x}\n    $$\n\nSubstituting these approximations into the original PDE yields the finite difference equation:\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} + a\\left(\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x}\\right) = 0\n$$\n\nTo determine the modified equation that this scheme solves, we perform a Taylor series expansion of each term around the point $(x_{i}, t_{n})$. We let $u$ and its partial derivatives (e.g., $u_{t}$, $u_{x}$, $u_{xx}$) represent the continuous function and its derivatives evaluated at $(x_{i}, t_{n})$.\n\nThe Taylor expansion for $u_{i}^{n+1} = u(x_{i}, t_{n}+\\Delta t)$ in time is:\n$$\nu_{i}^{n+1} = u + \\Delta t\\,u_{t} + \\frac{(\\Delta t)^{2}}{2}u_{tt} + \\mathcal{O}((\\Delta t)^{3})\n$$\nThe Taylor expansion for $u_{i-1}^{n} = u(x_{i}-\\Delta x, t_{n})$ in space is:\n$$\nu_{i-1}^{n} = u - \\Delta x\\,u_{x} + \\frac{(\\Delta x)^{2}}{2}u_{xx} - \\frac{(\\Delta x)^{3}}{6}u_{xxx} + \\mathcal{O}((\\Delta x)^{4})\n$$\n\nNow, we substitute these expansions back into the finite difference equation. For the time derivative term:\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} = \\frac{(u + \\Delta t\\,u_{t} + \\frac{(\\Delta t)^{2}}{2}u_{tt} + \\dots) - u}{\\Delta t} = u_{t} + \\frac{\\Delta t}{2}u_{tt} + \\mathcal{O}((\\Delta t)^{2})\n$$\nFor the spatial derivative term:\n$$\n\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = \\frac{u - (u - \\Delta x\\,u_{x} + \\frac{(\\Delta x)^{2}}{2}u_{xx} + \\dots)}{\\Delta x} = \\frac{\\Delta x\\,u_{x} - \\frac{(\\Delta x)^{2}}{2}u_{xx} + \\dots}{\\Delta x} = u_{x} - \\frac{\\Delta x}{2}u_{xx} + \\mathcal{O}((\\Delta x)^{2})\n$$\nSubstituting these back into the full scheme gives:\n$$\n\\left(u_{t} + \\frac{\\Delta t}{2}u_{tt} + \\dots\\right) + a\\left(u_{x} - \\frac{\\Delta x}{2}u_{xx} + \\dots\\right) = 0\n$$\nRearranging the terms to isolate the original PDE:\n$$\n(u_{t} + a\\,u_{x}) + \\frac{\\Delta t}{2}u_{tt} - a\\frac{\\Delta x}{2}u_{xx} + \\text{H.O.T.} = 0\n$$\nThis is the \"modified equation\" that the numerical scheme actually solves, up to the leading-order truncation error terms. We can write it as:\n$$\nu_{t} + a\\,u_{x} = -\\frac{\\Delta t}{2}u_{tt} + a\\frac{\\Delta x}{2}u_{xx} - \\text{H.O.T.}\n$$\nThe problem requires that time derivatives be eliminated in favor of spatial derivatives using the original continuous PDE, $u_{t} = -a\\,u_{x}$. To find an expression for the $u_{tt}$ term, we differentiate the PDE. Differentiating $u_{t} = -a\\,u_{x}$ with respect to time gives $u_{tt} = -a\\,u_{xt}$. Assuming the solution $u$ is sufficiently smooth, the mixed partial derivatives are equal, i.e., $u_{xt} = u_{tx}$. Differentiating $u_{t} = -a\\,u_{x}$ with respect to space gives $u_{tx} = -a\\,u_{xx}$. Therefore, we have:\n$$\nu_{tt} = -a\\,u_{xt} = -a\\,u_{tx} = -a(-a\\,u_{xx}) = a^{2}u_{xx}\n$$\nSubstituting this result for $u_{tt}$ back into the modified equation:\n$$\nu_{t} + a\\,u_{x} = -\\frac{\\Delta t}{2}(a^{2}u_{xx}) + a\\frac{\\Delta x}{2}u_{xx} - \\text{H.O.T.}\n$$\nWe can now collect the coefficients of the $u_{xx}$ term:\n$$\nu_{t} + a\\,u_{x} = \\left(a\\frac{\\Delta x}{2} - a^{2}\\frac{\\Delta t}{2}\\right)u_{xx} - \\text{H.O.T.}\n$$\nThis equation is of the form $u_{t} + a\\,u_{x} = \\nu\\,u_{xx} + \\text{higher-order terms}$. By comparing the two, we identify the numerical viscosity coefficient $\\nu$ as:\n$$\n\\nu = a\\frac{\\Delta x}{2} - a^{2}\\frac{\\Delta t}{2}\n$$\nThe problem asks for this coefficient to be expressed in terms of $a$, $\\Delta x$, and the Courant–Friedrichs–Lewy (CFL) number, defined as $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$. To do this, we factor $\\frac{a\\,\\Delta x}{2}$ from the expression for $\\nu$:\n$$\n\\nu = \\frac{a\\,\\Delta x}{2}\\left(1 - \\frac{a^{2}\\,\\Delta t}{a\\,\\Delta x}\\right) = \\frac{a\\,\\Delta x}{2}\\left(1 - \\frac{a\\,\\Delta t}{\\Delta x}\\right)\n$$\nSubstituting the definition of $\\lambda$:\n$$\n\\nu = \\frac{a\\,\\Delta x}{2}(1 - \\lambda)\n$$\nThis is the final expression for the numerical viscosity coefficient. This leading-order error term has the form of a diffusion or viscosity term, which is why the scheme is known to be dissipative.",
            "answer": "$$\n\\boxed{\\frac{a\\,\\Delta x}{2}(1 - \\lambda)}\n$$"
        },
        {
            "introduction": "Theoretical design and practical implementation are two different worlds; verifying that a numerical code performs as expected is a non-negotiable step in computational science. This comprehensive exercise guides you through the process of a convergence test, the gold standard for code verification. By implementing a solver for a wave equation, extracting a physically relevant quantity, and measuring the error's convergence rate across multiple grid resolutions, you will put theory into practice and confirm that your numerical model achieves its designed accuracy. ",
            "id": "3474363",
            "problem": "Consider a one-dimensional linear surrogate for gravitational radiation in the far zone, modeled as the scalar wave equation on a periodic domain with nondimensional units: let $x \\in [0,1)$, wave speed $c=1$, and field $u(x,t)$ governed by\n$$\n\\partial_t^2 u(x,t) = \\partial_x^2 u(x,t),\n$$\nwith periodic boundary conditions. Take initial data corresponding to a single Fourier mode with integer wavenumber $m \\in \\mathbb{Z}^+$:\n$$\nu(x,0) = \\cos(2\\pi m x), \\quad \\partial_t u(x,0) = 0.\n$$\nThis setup yields a standing traveling-wave solution with angular frequency $\\omega = 2\\pi m$. In linearized gravity, the Newman–Penrose scalar $\\Psi_4$ is proportional to the second time derivative of the strain. In this scalar surrogate model, define the extracted quantity\n$$\n\\Psi_4(x,t) := \\partial_t^2 u(x,t).\n$$\nAn analytic solution exists for $u(x,t)$ under the stated initial data and boundary conditions, which thereby induces an analytic expression for $\\Psi_4(x,t)$.\n\nYour task is to implement a three-level grid-convergence test for $\\Psi_4$ using second-order accurate finite differencing in space and the classical fourth-order Runge–Kutta time integrator under the method-of-lines approach, with a Courant–Friedrichs–Lewy (CFL) time step constraint enforced by setting the time step $\\Delta t$ to $T/N_t$ with $N_t = \\left\\lceil T / (\\text{CFL}\\,\\Delta x) \\right\\rceil$, where $\\Delta x = 1/N$ for $N$ grid points and $T$ is the final time. Use the discrete second derivative operator with periodic boundary conditions to approximate $\\partial_x^2 u$, and evolve the first-order-in-time system\n$$\n\\partial_t u = v, \\quad \\partial_t v = \\partial_x^2 u.\n$$\nAt the final time $t = T$, approximate the numerical extraction quantity as\n$$\n\\Psi_4^{\\text{num}}(x,T) := \\partial_t v(x,T) \\approx \\partial_x^2 u(x,T),\n$$\nusing the same second-order central finite difference operator applied to the numerically evolved $u(x,T)$. Construct the analytic extraction quantity $\\Psi_4^{\\text{exact}}(x,T)$ from the analytic solution for $u(x,t)$ and compute the spatial discrete $\\ell^2$-norm of the error\n$$\nE(N) := \\left( \\frac{1}{N} \\sum_{j=0}^{N-1} \\left( \\Psi_4^{\\text{num}}(x_j,T) - \\Psi_4^{\\text{exact}}(x_j,T) \\right)^2 \\right)^{1/2},\n$$\nwith grid points $x_j = j \\,\\Delta x$. Perform this for three successively refined grids $N, 2N, 4N$, and compute the observed convergence order from error ratios via\n$$\np_{12} = \\log_2\\!\\left(\\frac{E(N)}{E(2N)}\\right), \\quad p_{23} = \\log_2\\!\\left(\\frac{E(2N)}{E(4N)}\\right),\n$$\nand report the average $p = \\tfrac{1}{2}(p_{12}+p_{23})$ as the measured order.\n\nImplement the above and evaluate the observed order $p$ for each of the following test cases, which together form the test suite:\n- Test 1 (happy path): $m = 1$, $T = 1.0$, $\\text{CFL} = 0.4$, with base grid size $N = 64$.\n- Test 2 (higher wavenumber): $m = 3$, $T = 0.7$, $\\text{CFL} = 0.4$, with base grid size $N = 64$.\n- Test 3 (more oscillatory and shorter run): $m = 5$, $T = 0.3$, $\\text{CFL} = 0.4$, with base grid size $N = 64$.\n\nAll quantities are nondimensional. Your program must compute, for each test case, the three-level observed order $p$ as a floating-point number. The final program output should be a single line containing a comma-separated list of the three measured orders, enclosed in square brackets, in the order of the tests above. For example, the format must be exactly\n\"[p_test1,p_test2,p_test3]\".",
            "solution": "We seek to design and implement a principled three-level convergence test for a hyperbolic equation relevant to gravitational-wave extraction, using only foundational definitions and widely accepted numerical practices. The fundamental base comprises: the linear wave equation as a surrogate for far-zone gravitational radiation, the definition of the Newman–Penrose scalar $\\Psi_4$ as a second time derivative of a strain-like field in the linear regime, second-order centered finite differences for spatial derivatives, and the Courant–Friedrichs–Lewy condition guiding explicit time integration stability.\n\n1. Modeling and analytic solution. In the far zone, the linearized Einstein equations reduce to wave propagation of perturbations. A scalar surrogate $u(x,t)$ satisfies the one-dimensional wave equation\n$$\n\\partial_t^2 u = \\partial_x^2 u,\n$$\non a periodic domain. Choosing initial data $u(x,0) = \\cos(2\\pi m x)$ and $\\partial_t u(x,0) = 0$ yields a separable solution that conserves the mode shape in space with a cosine time factor. Specifically, the angular frequency is $\\omega = 2\\pi m$, so\n$$\nu(x,t) = \\cos(2\\pi m x) \\cos(\\omega t).\n$$\nThe linearized extraction quantity in this model is defined as\n$$\n\\Psi_4(x,t) := \\partial_t^2 u(x,t),\n$$\nhence the analytic extraction quantity is\n$$\n\\Psi_4^{\\text{exact}}(x,t) = \\partial_t^2 \\left[\\cos(2\\pi m x) \\cos(\\omega t)\\right] = -\\omega^2 \\cos(2\\pi m x) \\cos(\\omega t).\n$$\n\n2. Method-of-lines spatial discretization. We rewrite the wave equation as a first-order system,\n$$\n\\partial_t u = v, \\quad \\partial_t v = \\partial_x^2 u.\n$$\nOn a uniform grid with $N$ points, spacing $\\Delta x = 1/N$, and periodic index arithmetic, we define the standard second-order centered discrete Laplacian operator $D_{xx}$ acting on a grid function $w_j \\approx w(x_j)$ as\n$$\n(D_{xx} w)_j = \\frac{w_{j+1} - 2 w_j + w_{j-1}}{\\Delta x^2},\n$$\nwith indices modulo $N$. This operator is consistent with $\\partial_x^2$ and has truncation error of order $\\mathcal{O}(\\Delta x^2)$.\n\n3. Time advancement. The method-of-lines approach uses the spatially discretized right-hand side to form an ordinary differential equation system in time. We employ the classical fourth-order Runge–Kutta integrator to evolve $(u, v)$ from $t=0$ to $t=T$. Stability for explicit schemes for hyperbolic systems is governed by the Courant–Friedrichs–Lewy condition; we enforce a time step of the form $\\Delta t = T/N_t$ with\n$$\nN_t = \\left\\lceil \\frac{T}{\\text{CFL} \\,\\Delta x} \\right\\rceil,\n$$\nso that $\\Delta t \\le \\text{CFL}\\,\\Delta x$, satisfying a conservative stability constraint. Although the time integrator is fourth order, the overall spatial truncation error dominates for smooth solutions when $\\Delta t$ scales linearly with $\\Delta x$, resulting in second-order convergence in space for spatially dependent quantities constructed from $u$.\n\n4. Numerical extraction and error norm. At the final time $t=T$, we approximate the numerical extraction quantity by consistency with the system equation:\n$$\n\\Psi_4^{\\text{num}}(x_j,T) \\approx \\partial_t v(x_j,T) = \\partial_x^2 u(x_j,T) \\approx (D_{xx} u)_j(T).\n$$\nWe compute the discrete spatial $\\ell^2$ error norm\n$$\nE(N) = \\left( \\frac{1}{N} \\sum_{j=0}^{N-1} \\left[ \\Psi_4^{\\text{num}}(x_j,T) - \\Psi_4^{\\text{exact}}(x_j,T) \\right]^2 \\right)^{1/2}.\n$$\n\n5. Three-level convergence measurement. For a consistent second-order method applied to a smooth solution, the error satisfies an asymptotic model $E(N) \\approx C \\,\\Delta x^p$ with $p \\approx 2$. Using three grids with $N, 2N, 4N$ points yields errors $E(N), E(2N), E(4N)$. The observed orders from successive refinements are computed by\n$$\np_{12} = \\log_2\\!\\left(\\frac{E(N)}{E(2N)}\\right), \\quad p_{23} = \\log_2\\!\\left(\\frac{E(N)}{E(4N)}\\right),\n$$\nand we report the average $p = \\tfrac{1}{2}(p_{12}+p_{23})$ to reduce sensitivity to pre-asymptotic effects.\n\n6. Algorithmic steps for each test case.\n- Fix $m$, $T$, and the Courant–Friedrichs–Lewy parameter.\n- For $N \\in \\{N_0, 2N_0, 4N_0\\}$ with $N_0 = 64$, set $\\Delta x = 1/N$, initialize $u_j(0) = \\cos(2\\pi m x_j)$ and $v_j(0) = 0$, and set $N_t = \\left\\lceil T / (\\text{CFL} \\,\\Delta x) \\right\\rceil$, $\\Delta t = T / N_t$.\n- Evolve $(u, v)$ to $t=T$ using the classical fourth-order Runge–Kutta method with the discrete Laplacian.\n- Compute $\\Psi_4^{\\text{num}} = D_{xx} u(T)$ and evaluate $\\Psi_4^{\\text{exact}}(x_j,T) = -\\omega^2 \\cos(2\\pi m x_j) \\cos(\\omega T)$ with $\\omega = 2\\pi m$.\n- Compute $E(N)$ as the discrete $\\ell^2$ norm, then evaluate $p_{12}$ and $p_{23}$ and their average $p$.\n- Repeat for each test case.\n\n7. Expected behavior. Because the spatial operator is second order and the time step is proportional to $\\Delta x$, the global error in $\\Psi_4^{\\text{num}}$ is expected to converge at order $p \\approx 2$ across the test suite, with minor deviations due to dispersion and finite-time integration effects. The higher-wavenumber tests stress resolution and may slightly reduce the observed order if the coarsest grid is not fully in the asymptotic regime, but the average order should remain close to $2$.\n\nThe program implements the above and outputs a single line with the three observed orders for the test suite in the required format.",
            "answer": "```python\nimport numpy as np\n\ndef laplacian_periodic(u, dx):\n    # Second-order centered finite-difference Laplacian with periodic BC\n    return (np.roll(u, -1) - 2.0 * u + np.roll(u, 1)) / (dx * dx)\n\ndef rk4_step(u, v, dt, dx):\n    # Right-hand sides: du/dt = v, dv/dt = lap(u)\n    # Stage 1\n    k1_u = v\n    k1_v = laplacian_periodic(u, dx)\n    # Stage 2\n    u2 = u + 0.5 * dt * k1_u\n    v2 = v + 0.5 * dt * k1_v\n    k2_u = v2\n    k2_v = laplacian_periodic(u2, dx)\n    # Stage 3\n    u3 = u + 0.5 * dt * k2_u\n    v3 = v + 0.5 * dt * k2_v\n    k3_u = v3\n    k3_v = laplacian_periodic(u3, dx)\n    # Stage 4\n    u4 = u + dt * k3_u\n    v4 = v + dt * k3_v\n    k4_u = v4\n    k4_v = laplacian_periodic(u4, dx)\n    # Combine\n    u_next = u + (dt / 6.0) * (k1_u + 2.0 * k2_u + 2.0 * k3_u + k4_u)\n    v_next = v + (dt / 6.0) * (k1_v + 2.0 * k2_v + 2.0 * k3_v + k4_v)\n    return u_next, v_next\n\ndef evolve_and_error(m, T, CFL, N):\n    # Domain [0,1), periodic, nondimensional units, c=1\n    L = 1.0\n    dx = L / N\n    x = np.linspace(0.0, L, N, endpoint=False)\n    # Initial conditions\n    k = 2.0 * np.pi * m\n    omega = k  # c=1\n    u = np.cos(k * x)\n    v = np.zeros_like(u)\n    # Time step via conservative CFL choice\n    Nt = int(np.ceil(T / (CFL * dx)))\n    dt = T / Nt\n    # Time integration to t = T\n    for _ in range(Nt):\n        u, v = rk4_step(u, v, dt, dx)\n    # Numerical Psi4 via dv/dt = lap(u) at final time\n    psi4_num = laplacian_periodic(u, dx)\n    # Analytic Psi4 at final time\n    u_exact = np.cos(k * x) * np.cos(omega * T)\n    psi4_exact = - (omega ** 2) * u_exact\n    # Discrete L2 error\n    err = psi4_num - psi4_exact\n    E = np.sqrt(np.mean(err * err))\n    return E\n\ndef observed_order(m, T, CFL, N0):\n    # Three-level errors\n    E1 = evolve_and_error(m, T, CFL, N0)\n    E2 = evolve_and_error(m, T, CFL, 2 * N0)\n    E3 = evolve_and_error(m, T, CFL, 4 * N0)\n    # Compute observed orders\n    # Guard against division by zero if errors are too small (should not happen here)\n    p12 = np.log2(E1 / E2) if E2 > 0 and E1 > 0 else float('nan')\n    p23 = np.log2(E2 / E3) if E3 > 0 and E2 > 0 else float('nan')\n    p_avg = 0.5 * (p12 + p23)\n    return p_avg\n\ndef solve():\n    # Define the test cases from the problem statement: (m, T, CFL, N0)\n    test_cases = [\n        (1, 1.0, 0.4, 64),  # Test 1\n        (3, 0.7, 0.4, 64),  # Test 2\n        (5, 0.3, 0.4, 64),  # Test 3\n    ]\n    results = []\n    for m, T, CFL, N0 in test_cases:\n        p = observed_order(m, T, CFL, N0)\n        results.append(p)\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}