{
    "hands_on_practices": [
        {
            "introduction": "A critical aspect of any hyperbolic evolution system in numerical relativity is its set of characteristic speeds. These speeds determine the domain of dependence and dictate the maximum stable time step via the Courant-Friedrichs-Lewy (CFL) condition. This exercise  provides practice in the essential skill of performing a linearized characteristic analysis to extract the propagation speeds of gauge modes in the Gamma-driver shift condition, revealing how gauge parameters can influence the stability and causality of a simulation.",
            "id": "3479899",
            "problem": "Consider the Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formulation of the Einstein equations with the moving puncture gauge. Focus on the hyperbolic Gamma-driver shift condition written in first-order-in-time form,\n$$\n\\partial_t \\beta^i = \\mu_S B^i, \n\\qquad\n\\partial_t B^i = \\partial_t \\tilde{\\Gamma}^i - \\eta B^i,\n$$\nwhere $\\beta^i$ is the shift, $B^i$ is an auxiliary field, $\\tilde{\\Gamma}^i$ are the contracted conformal Christoffel symbols, and $\\mu_S > 0$ and $\\eta \\ge 0$ are fixed gauge parameters. Work in geometric units with $c=1$ and linearize about Minkowski spacetime with background lapse $\\alpha=1$, vanishing shift $\\beta^i=0$, and flat spatial metric $\\gamma_{ij}=\\delta_{ij}$. Neglect advection terms and damping for the principal-part analysis.\n\nUse as fundamental starting point the well-tested principal-part relation for the contracted conformal Christoffel symbol in the BSSN formulation linearized about flat space,\n$$\n\\partial_t \\tilde{\\Gamma}^i \\simeq \\Delta \\beta^i + \\frac{1}{3}\\,\\partial^i \\partial_j \\beta^j,\n$$\nwhere $\\Delta$ is the flat-space Laplacian and $\\simeq$ denotes equality at the level of principal parts. Treat the lapse sector as decoupled at principal order for this analysis.\n\nAssume plane-wave perturbations with spatial wave covector $k_i = k\\,n_i$, where $n_i$ is a unit covector, and decompose $\\beta^i$ into components longitudinal and transverse to $n^i$. For the Gamma-driver parameter set $\\mu_S = 1$ (with arbitrary $\\eta \\ge 0$), compute the maximum characteristic speed of the shift gauge subsystem in units of the physical light speed in these coordinates. Express your final answer as a single exact analytic expression without units. This maximum characteristic speed decides whether the shift gauge characteristic speeds can be superluminal relative to the physical light speed in coordinates, but you must report only the value of this maximum speed as your final answer.",
            "solution": "The analysis begins with the validation of the problem statement.\n\n### Step 1: Extract Givens\n- **System**: Baumgarte-Shapiro-Shibata-Nakamura (BSSN) formulation.\n- **Gauge Conditions**: Hyperbolic Gamma-driver shift condition for the moving puncture gauge.\n- **Evolution Equations**:\n  $$\n  \\partial_t \\beta^i = \\mu_S B^i\n  $$\n  $$\n  \\partial_t B^i = \\partial_t \\tilde{\\Gamma}^i - \\eta B^i\n  $$\n- **Variables and Parameters**: $\\beta^i$ (shift), $B^i$ (auxiliary field), $\\tilde{\\Gamma}^i$ (contracted conformal Christoffel symbols), $\\mu_S > 0$, $\\eta \\ge 0$.\n- **Background**: Linearization about Minkowski spacetime with $\\alpha=1$, $\\beta^i=0$, $\\gamma_{ij}=\\delta_{ij}$. Geometric units ($c=1$).\n- **Approximations**: Neglect advection and damping for principal-part analysis. Lapse sector decoupled.\n- **Principal-Part Relation**:\n  $$\n  \\partial_t \\tilde{\\Gamma}^i \\simeq \\Delta \\beta^i + \\frac{1}{3}\\,\\partial^i \\partial_j \\beta^j\n  $$\n- **Analysis Method**: Plane-wave perturbations with wave covector $k_i = k\\,n_i$.\n- **Decomposition**: $\\beta^i$ into longitudinal and transverse components.\n- **Specific Parameter**: $\\mu_S = 1$.\n- **Objective**: Compute the maximum characteristic speed of the shift gauge subsystem in units of the physical light speed in these coordinates.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded in the established theory of numerical relativity, specifically the BSSN formulation and moving puncture gauge conditions. It is well-posed, providing a complete and consistent set of equations and conditions necessary for a unique solution via standard mathematical physics techniques (linearization and Fourier analysis). The language is objective and precise. The approximations requested are standard for a characteristic analysis. The problem is valid.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution follows.\n\nWe are given the first-order system for the shift vector $\\beta^i$ and an auxiliary field $B^i$:\n$$\n\\partial_t \\beta^i = \\mu_S B^i\n$$\n$$\n\\partial_t B^i = \\partial_t \\tilde{\\Gamma}^i - \\eta B^i\n$$\nTo analyze the wave-like behavior of the shift $\\beta^i$, we combine these equations into a single second-order-in-time partial differential equation (PDE). Differentiating the first equation with respect to coordinate time $t$ yields $\\partial_{tt} \\beta^i = \\mu_S \\partial_t B^i$. We substitute the second equation into this expression:\n$$\n\\partial_{tt} \\beta^i = \\mu_S \\left( \\partial_t \\tilde{\\Gamma}^i - \\eta B^i \\right) = \\mu_S \\partial_t \\tilde{\\Gamma}^i - \\eta (\\mu_S B^i)\n$$\nUsing the first evolution equation again to substitute $\\mu_S B^i = \\partial_t \\beta^i$, we arrive at:\n$$\n\\partial_{tt} \\beta^i + \\eta \\partial_t \\beta^i = \\mu_S \\partial_t \\tilde{\\Gamma}^i\n$$\nThe problem supplies the crucial relation for the principal part of $\\partial_t \\tilde{\\Gamma}^i$ in a linearized setting:\n$$\n\\partial_t \\tilde{\\Gamma}^i \\simeq \\Delta \\beta^i + \\frac{1}{3}\\,\\partial^i \\partial_j \\beta^j\n$$\nwhere $\\Delta = \\delta^{jk}\\partial_j \\partial_k$ is the flat-space Laplacian operator. Substituting this into the second-order PDE for $\\beta^i$:\n$$\n\\partial_{tt} \\beta^i + \\eta \\partial_t \\beta^i \\simeq \\mu_S \\left( \\Delta \\beta^i + \\frac{1}{3}\\,\\partial^i \\partial_j \\beta^j \\right)\n$$\nTo determine the characteristic speeds, we must analyze the principal part of this system of equations. The principal part consists of the terms with the highest order of differentiation. The term $\\partial_{tt} \\beta^i$ is second-order in time. The terms on the right-hand side, involving $\\Delta \\beta^i$ and $\\partial^i \\partial_j \\beta^j$, are second-order in space. The damping term $\\eta \\partial_t \\beta^i$ is only first-order in time and is thus a lower-order term. As instructed, we neglect it for the principal-part analysis. The principal part of the evolution system for $\\beta^i$ is:\n$$\n\\partial_{tt} \\beta^i = \\mu_S \\left( \\Delta \\beta^i + \\frac{1}{3}\\,\\partial^i \\partial_j \\beta^j \\right)\n$$\nWe now analyze this system using a plane-wave ansatz, $\\beta^i(t, \\vec{x}) = \\hat{\\beta}^i \\exp(i(\\omega t - k_j x^j))$, where $\\hat{\\beta}^i$ is a constant amplitude vector, $\\omega$ is the angular frequency, and $k_j$ is the wave covector. Under this substitution, the partial derivatives transform into algebraic factors: $\\partial_t \\to i\\omega$ and $\\partial_j \\to -ik_j$. Applying this to the principal-part equation yields:\n$$\n(i\\omega)^2 \\hat{\\beta}^i = \\mu_S \\left( (\\delta^{lm}(-ik_l)(-ik_m)) \\hat{\\beta}^i + \\frac{1}{3}\\,(-ik^i)(-ik_j) \\hat{\\beta}^j \\right)\n$$\n$$\n-\\omega^2 \\hat{\\beta}^i = \\mu_S \\left( -k^2 \\hat{\\beta}^i - \\frac{1}{3}\\,k^i k_j \\hat{\\beta}^j \\right)\n$$\nHere, $k^2 = \\delta^{jk}k_j k_k$. Multiplying the equation by $-1$, we obtain an algebraic eigenvalue problem for $\\omega^2$:\n$$\n\\omega^2 \\hat{\\beta}^i = \\mu_S \\left( k^2 \\hat{\\beta}^i + \\frac{1}{3}\\,k^i (k_j \\hat{\\beta}^j) \\right)\n$$\nTo find the solutions, we decompose the amplitude vector $\\hat{\\beta}^i$ into a longitudinal component parallel to the wave vector $k^i$ and a transverse component orthogonal to $k^i$.\n\nLet $\\hat{\\beta}^i = \\hat{\\beta}^i_L + \\hat{\\beta}^i_T$, where $\\hat{\\beta}^i_L$ is the longitudinal part (parallel to $k^i$) and $\\hat{\\beta}^i_T$ is the transverse part (satisfying $k_i \\hat{\\beta}^i_T = 0$).\n\nFor the transverse modes, where $\\hat{\\beta}^i = \\hat{\\beta}^i_T$, the projection $k_j \\hat{\\beta}^j_T = 0$. The equation simplifies to:\n$$\n\\omega^2 \\hat{\\beta}^i_T = \\mu_S ( k^2 \\hat{\\beta}^i_T )\n$$\nFor a non-trivial solution ($\\hat{\\beta}^i_T \\neq 0$), the dispersion relation must be $\\omega^2 = \\mu_S k^2$. The propagation speed of these modes is the phase velocity $v_T = |\\omega/k|$. Thus, $v_T^2 = \\mu_S$, and the speed of the transverse modes is:\n$$\nv_T = \\sqrt{\\mu_S}\n$$\nFor the longitudinal mode, where $\\hat{\\beta}^i = \\hat{\\beta}^i_L$, the vector is parallel to the wave vector, so we can write $\\hat{\\beta}^i_L = C k^i$ for some scalar amplitude $C$. The projection is $k_j \\hat{\\beta}^j_L = C k_j k^j = C k^2$. Substituting this into the main algebraic equation:\n$$\n\\omega^2 (C k^i) = \\mu_S \\left( k^2 (C k^i) + \\frac{1}{3}\\,k^i (C k^2) \\right)\n$$\nAssuming a non-trivial mode ($C \\neq 0, k^i \\neq 0$), we can factor out $C k^i$:\n$$\n\\omega^2 = \\mu_S \\left( k^2 + \\frac{1}{3}\\,k^2 \\right) = \\frac{4}{3} \\mu_S k^2\n$$\nThe speed of the longitudinal mode is $v_L = |\\omega/k|$, so $v_L^2 = \\frac{4}{3} \\mu_S$. This gives:\n$$\nv_L = \\sqrt{\\frac{4}{3} \\mu_S}\n$$\nThe characteristic speeds of the shift gauge subsystem are therefore $v_T = \\sqrt{\\mu_S}$ and $v_L = \\sqrt{\\frac{4}{3} \\mu_S}$. To find the maximum characteristic speed, we compare these two values. Since $\\frac{4}{3} > 1$, it is clear that $v_L > v_T$ for any $\\mu_S > 0$. The maximum speed is:\n$$\nv_{max} = v_L = \\sqrt{\\frac{4}{3} \\mu_S}\n$$\nThe problem specifies the gauge parameter $\\mu_S = 1$. Substituting this value:\n$$\nv_{max} = \\sqrt{\\frac{4}{3}} = \\frac{2}{\\sqrt{3}}\n$$\nThis speed is calculated in geometric units where the coordinate speed of light in the background Minkowski spacetime is $c=1$. Therefore, the value represents the maximum characteristic speed in units of the physical light speed in these coordinates.",
            "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{3}}}\n$$"
        },
        {
            "introduction": "While linear analysis provides crucial insights, the full behavior of gauge conditions is governed by their non-linear dynamics, which can sometimes lead to pathologies like gauge shocks. This hands-on coding exercise  challenges you to build a numerical solver for a simplified model of the Bona–Massó slicing condition. By implementing and running this model, you will directly investigate how modifications to the slicing function can help suppress the formation of these shocks, a practical concern in modern simulations.",
            "id": "3479920",
            "problem": "You are asked to study the effect of modifying the Bona–Massó slicing in the moving puncture gauge by considering an alternative slicing function of the form $f(\\alpha) = 2/\\alpha + c$, where $c$ is a small constant parameter. You will examine whether a small positive $c$ suppresses gauge shock formation in a one-dimensional toy model without degrading the near-puncture trumpet behavior that is central to the moving puncture method in black hole simulations.\n\nStart from the $3+1$ decomposition of General Relativity (GR), and consider the gauge sector in the Bona–Massó slicing family on a flat background with vanishing shift. Let $\\alpha(x,t)$ denote the lapse function and $K(x,t)$ denote the trace of the extrinsic curvature. Use the standard gauge sector reduction on a flat background, which yields the coupled system\n$$\\partial_t \\alpha = - \\alpha^2 f(\\alpha) K,$$\n$$\\partial_t K = - \\partial_x^2 \\alpha,$$\nwith $f(\\alpha) = 2/\\alpha + c$. This system isolates the gauge dynamics in a $1+1$ dimensional setting and captures the nonlinearity that can lead to gauge steepening and shocks. All angles must be treated in radians.\n\nYour tasks are:\n1. Implement a method-of-lines integrator using a fourth-order Runge–Kutta scheme to evolve the system on a periodic domain $x \\in [0, 2\\pi]$ with $N$ equidistant grid points. Use a Fourier spectral method to compute spatial derivatives: if $\\hat{\\alpha}(k)$ is the Fourier transform of $\\alpha(x)$, then $\\partial_x \\alpha$ and $\\partial_x^2 \\alpha$ are computed in Fourier space using the exact multipliers $ik$ and $-k^2$, respectively, where $k$ are the discrete Fourier wavenumbers. Take $N = 512$ grid points and time step $\\Delta t = 0.2 \\Delta x$ where $\\Delta x = 2\\pi/N$. Evolve until final time $T = 10$. Initialize the fields with\n$$\\alpha(x,0) = 1 + \\epsilon \\sin(k_0 x), \\quad K(x,0) = 0,$$\nwhere $\\epsilon = 0.05$ and $k_0 = 1$. All scalar quantities are dimensionless.\n\n2. Quantify gauge steepening and shock tendency by the steepening factor\n$$R(c) = \\frac{\\max_{0 \\le t \\le T}\\left( \\left| \\min_x \\partial_x \\alpha(x,t) \\right| \\right)}{\\epsilon k_0},$$\nwhich measures the maximal amplification of the most negative slope relative to the initial slope magnitude $|\\partial_x \\alpha(x,0)|_{\\max} = \\epsilon k_0$. A larger $R(c)$ indicates stronger steepening and thus a greater tendency toward gauge shock formation.\n\n3. Define a suppression indicator relative to the baseline $c=0$:\n$$S(c) = \\begin{cases}\n1 & \\text{if } R(c) < R(0) - \\delta R(0), \\\\\n0 & \\text{otherwise},\n\\end{cases}$$\nwith $\\delta = 0.05$. By definition, take $S(0) = 0$.\n\n4. Evaluate whether the late-time trumpet near-puncture property is preserved by $f(\\alpha) = 2/\\alpha + c$ using the diagnostic\n$$D(c) = \\left| \\alpha_{\\min} f(\\alpha_{\\min}) - 2 \\right|,$$\nwhere $\\alpha_{\\min} = 10^{-6}$. This metric tests whether the product $\\alpha f(\\alpha)$ approaches $2$ as $\\alpha \\to 0$, which is the hallmark of the standard $1+\\log$ slicing in the moving puncture method. Define a preservation indicator\n$$T(c) = \\begin{cases}\n1 & \\text{if } D(c) \\le \\tau, \\\\\n0 & \\text{otherwise},\n\\end{cases}$$\nwith tolerance $\\tau = 10^{-4}$.\n\n5. Test suite and output specification:\n- Use the parameter set $c \\in \\{0.0, 0.02, 0.2, 0.8\\}$.\n- For each $c$, compute the triple $[R(c), S(c), T(c)]$ where $R(c)$ is a floating-point number and $S(c), T(c)$ are integers in $\\{0, 1\\}$.\n- Your program should produce a single line of output containing a list of these triples for the ordered test suite values of $c$, with $R(c)$ rounded to six decimal places. For example, the output format must be exactly\n\"[[r0,s0,t0],[r1,s1,t1],[r2,s2,t2],[r3,s3,t3]]\"\nwith no additional text, where each $rj$ is a decimal string with six places after the decimal point and $sj, tj$ are integers.\n\nConstraints and reminders:\n- All computations must be done in dimensionless units. Angles (e.g., in $\\sin(k_0 x)$) must be treated in radians.\n- Use only the method-of-lines in time with fourth-order Runge–Kutta, and exactly the Fourier spectral method in space for derivatives as stated.\n- Do not introduce any artificial viscosity, limiters, or filtering beyond the inherent spectral derivative approach.\n- Ensure numerical stability by adhering to the given $\\Delta t$ and domain discretization.",
            "solution": "The user-provided problem statement has been analyzed and validated.\n\n### Step 1: Extracted Givens\n- **Governing Equations:**\n    - $\\partial_t \\alpha = - \\alpha^2 f(\\alpha) K$\n    - $\\partial_t K = - \\partial_x^2 \\alpha$\n- **Slicing Function:** $f(\\alpha) = 2/\\alpha + c$\n- **Computational Domain:** $x \\in [0, 2\\pi]$, periodic.\n- **Initial Conditions ($t=0$):**\n    - $\\alpha(x,0) = 1 + \\epsilon \\sin(k_0 x)$, with $\\epsilon=0.05$ and $k_0=1$.\n    - $K(x,0) = 0$.\n- **Numerical Discretization:**\n    - Method of Lines with a fourth-order Runge-Kutta integrator for time evolution.\n    - Fourier spectral method for spatial derivatives ($\\partial_x$ and $\\partial_x^2$).\n    - Number of grid points: $N = 512$.\n    - Grid spacing: $\\Delta x = 2\\pi/N$.\n    - Time step: $\\Delta t = 0.2 \\Delta x$.\n- **Simulation Duration:** Final time $T = 10$.\n- **Analysis Metrics:**\n    - **Steepening Factor:** $R(c) = \\frac{\\max_{0 \\le t \\le T}\\left( \\left| \\min_x \\partial_x \\alpha(x,t) \\right| \\right)}{\\epsilon k_0}$.\n    - **Suppression Indicator:** $S(c) = 1$ if $R(c) < R(0) - \\delta R(0)$ with $\\delta = 0.05$; $S(c) = 0$ otherwise. By definition, $S(0) = 0$.\n    - **Trumpet Diagnostic:** $D(c) = \\left| \\alpha_{\\min} f(\\alpha_{\\min}) - 2 \\right|$ with $\\alpha_{\\min} = 10^{-6}$.\n    - **Preservation Indicator:** $T(c) = 1$ if $D(c) \\le \\tau$ with $\\tau=10^{-4}$; $T(c) = 0$ otherwise.\n- **Test Suite:** $c \\in \\{0.0, 0.02, 0.2, 0.8\\}$.\n- **Output Specification:** A list of triples $[R(c), S(c), T(c)]$ for each value of $c$ in the test suite, with $R(c)$ rounded to six decimal places.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established validation criteria.\n- **Scientifically Grounded:** The problem is set in the context of numerical general relativity, a well-established field. The equations are a simplified, but standard, $1+1$ dimensional model used to study the behavior of gauge conditions (specifically, Bona-Massó slicing) used in black hole simulations. The concepts of lapse, extrinsic curvature, moving puncture gauge, and trumpet geometry are all standard in the field. The model is scientifically sound for its intended purpose.\n- **Well-Posed:** The problem describes an initial value problem for a system of partial differential equations. The initial conditions are smooth and well-defined. All necessary parameters and numerical methods are specified, making the setup complete and self-contained. The requested outputs are deterministic functions of the simulation results. A unique numerical solution is expected.\n- **Objective:** The problem is formulated in precise mathematical language. All quantities, conditions, and tasks are defined objectively, with no room for subjective interpretation.\n\nThe problem does not exhibit any of the listed invalidity flaws. It is mathematically and scientifically sound, complete, well-posed, and objective.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe problem requires the numerical solution of a system of coupled partial differential equations and the subsequent analysis of the solution's properties. We will use the method of lines, which decouples the spatial and temporal discretization.\n\n**1. System Formulation**\nLet the state of the system at any time $t$ be represented by a vector of grid-point values for $\\alpha$ and $K$. Let $\\vec{\\alpha}(t) = [\\alpha(x_0, t), \\dots, \\alpha(x_{N-1}, t)]^T$ and $\\vec{K}(t) = [K(x_0, t), \\dots, K(x_{N-1}, t)]^T$. The continuous system can be written in a semi-discrete form as:\n$$\n\\frac{d\\vec{\\alpha}}{dt} = - \\vec{\\alpha}^2 \\circ (\\frac{2}{\\vec{\\alpha}} + c) \\circ \\vec{K} = -(2\\vec{\\alpha} + c\\vec{\\alpha}^2) \\circ \\vec{K}\n$$\n$$\n\\frac{d\\vec{K}}{dt} = - \\mathcal{D}_x^2 \\vec{\\alpha}\n$$\nwhere $\\circ$ denotes the element-wise (Hadamard) product, and $\\mathcal{D}_x^2$ is the operator for the second spatial derivative. We can combine these into a single system for the state vector $\\vec{y} = [\\vec{\\alpha}, \\vec{K}]^T$:\n$$\n\\frac{d\\vec{y}}{dt} = \\vec{F}(\\vec{y}, c)\n$$\nwhere $\\vec{F}$ is the function representing the right-hand sides of the semi-discrete equations.\n\n**2. Spatial Discretization: Fourier Spectral Method**\nThe domain is periodic, making the Fourier spectral method an ideal choice for high-accuracy spatial differentiation. The grid is defined as $x_j = j \\Delta x$ for $j = 0, \\dots, N-1$, where $\\Delta x = 2\\pi/N$. For a function $u(x)$ evaluated on this grid, its spatial derivatives are computed in Fourier space.\nLet $\\hat{u}(k) = \\mathcal{F}\\{u(x_j)\\}$ be the discrete Fourier transform of $u$. The corresponding wavenumbers are given by $k = [0, 1, \\dots, N/2-1, -N/2, \\dots, -1]$. The first and second derivatives are then computed as:\n$$\n\\partial_x u(x_j) = \\mathcal{F}^{-1}\\{ i k \\hat{u}(k) \\}\n$$\n$$\n\\partial_x^2 u(x_j) = \\mathcal{F}^{-1}\\{ (i k)^2 \\hat{u}(k) \\} = \\mathcal{F}^{-1}\\{ -k^2 \\hat{u}(k) \\}\n$$\nwhere $\\mathcal{F}^{-1}$ is the inverse discrete Fourier transform. These operations will be implemented using NumPy's `fft` and `ifft` functions, and the wavenumbers will be generated using `fftfreq`.\n\n**3. Temporal Discretization: Fourth-Order Runge-Kutta (RK4)**\nThe semi-discrete system $\\frac{d\\vec{y}}{dt} = \\vec{F}(t, \\vec{y})$ is an ordinary differential equation (ODE) in time, which we evolve using the explicit RK4 scheme. Given the state $\\vec{y}_n$ at time $t_n$, the state $\\vec{y}_{n+1}$ at time $t_{n+1} = t_n + \\Delta t$ is computed as follows:\n$$\n\\vec{k}_1 = \\vec{F}(t_n, \\vec{y}_n)\n$$\n$$\n\\vec{k}_2 = \\vec{F}(t_n + \\frac{\\Delta t}{2}, \\vec{y}_n + \\frac{\\Delta t}{2} \\vec{k}_1)\n$$\n$$\n\\vec{k}_3 = \\vec{F}(t_n + \\frac{\\Delta t}{2}, \\vec{y}_n + \\frac{\\Delta t}{2} \\vec{k}_2)\n$$\n$$\n\\vec{k}_4 = \\vec{F}(t_n + \\Delta t, \\vec{y}_n + \\Delta t \\vec{k}_3)\n$$\n$$\n\\vec{y}_{n+1} = \\vec{y}_n + \\frac{\\Delta t}{6} (\\vec{k}_1 + 2\\vec{k}_2 + 2\\vec{k}_3 + \\vec{k}_4)\n$$\nThis process is repeated for a number of steps corresponding to the total evolution time $T$.\n\n**4. Calculation of Metrics**\nThe main simulation loop will evolve the system from $t=0$ to $t=T$ for each specified value of $c$.\n\n- **Steepening Factor $R(c)$:** During the evolution, at each time step, we compute the first spatial derivative of the lapse, $\\partial_x \\alpha(x,t)$, using the spectral method. We find its minimum value over the spatial grid, $\\min_x \\partial_x \\alpha(x,t)$. We track the maximum of the absolute value of this minimum over the entire simulation time. After the simulation, this maximum value is normalized by the initial maximum slope magnitude, $|\\partial_x \\alpha(x,0)|_{\\max} = \\epsilon k_0$, to obtain $R(c)$.\nFor the initial condition $\\alpha(x,0) = 1 + \\epsilon \\sin(k_0 x)$, the derivative is $\\partial_x \\alpha(x,0) = \\epsilon k_0 \\cos(k_0 x)$. The maximum magnitude of this initial slope is indeed $\\epsilon k_0$.\n\n- **Suppression Indicator $S(c)$:** This requires the value of $R(0)$, corresponding to the standard $c=0$ case. First, the simulation is run for $c=0$ to determine $R(0)$. Then, for each subsequent $c > 0$, the computed $R(c)$ is compared against the threshold $R(0)(1-\\delta)$. If $R(c)$ is smaller, $S(c)$ is set to $1$, otherwise $0$. Per the problem definition, $S(0)=0$.\n\n- **Trumpet Diagnostic $D(c)$ and Preservation Indicator $T(c)$:** These metrics do not depend on the simulation. The diagnostic $D(c)$ is calculated analytically:\n$$\nD(c) = |\\alpha_{\\min} f(\\alpha_{\\min}) - 2| = |\\alpha_{\\min} (2/\\alpha_{\\min} + c) - 2| = |2 + c\\alpha_{\\min} - 2| = |c\\alpha_{\\min}|\n$$\nSince the given values of $c$ are non-negative, $D(c) = c \\alpha_{\\min}$. Using the given values $\\alpha_{\\min} = 10^{-6}$ and $\\tau = 10^{-4}$, we can compute $D(c)$ and subsequently $T(c)$ for each $c$ in the test suite. Specifically, $T(c)=1$ if $c \\cdot 10^{-6} \\le 10^{-4}$, which simplifies to $c \\le 100$. All tested values of $c$ satisfy this condition.\n\n**5. Algorithm Summary**\n1.  Define all physical and numerical constants: $\\epsilon, k_0, N, T, \\delta, \\tau, \\alpha_{\\min}$.\n2.  Define the test suite of $c$ values.\n3.  For each $c$ in the test suite, calculate $D(c)=c \\alpha_{\\min}$ and $T(c) = 1$ if $D(c) \\le \\tau$ else $0$. All given $c$ values will result in $T(c)=1$.\n4.  Initialize a list to store the results.\n5.  Run the full numerical simulation for $c=0$ to compute $R(0)$.\n6.  For each $c$ value (including $c=0$):\n    a. Run the simulation from $t=0$ to $t=T$.\n    b. In the time loop, continuously track the maximum of $|\\min_x \\partial_x \\alpha(x,t)|$.\n    c. After the simulation, compute $R(c)$ by normalizing the result.\n7.  After obtaining all $R(c)$ values, calculate $S(c)$ for each $c>0$ by comparing $R(c)$ to $R(0)$. Set $S(0)=0$.\n8.  Assemble the final list of triples $[R(c), S(c), T(c)]$ and format it as a string for output.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation and compute the required metrics.\n    \"\"\"\n    # Define problem parameters\n    N = 512\n    EPSILON = 0.05\n    K0 = 1.0\n    T_FINAL = 10.0\n    DELTA = 0.05\n    TAU = 1.0e-4\n    ALPHA_MIN = 1.0e-6\n\n    # Test cases for the parameter c\n    test_cases_c = [0.0, 0.02, 0.2, 0.8]\n\n    # Grid and timestepping setup\n    x = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    dx = 2 * np.pi / N\n    dt = 0.2 * dx\n    num_steps = int(np.ceil(T_FINAL / dt))\n    \n    # Wavenumbers for spectral derivatives\n    # np.fft.fftfreq(N, d=dx) returns the frequency f in cycles/unit_length\n    # Wavenumber k is angular frequency, so k = 2*pi*f\n    # With d = dx = 2*pi/N, k simplifies to N*fftfreq(N)\n    wavenumbers = np.fft.fftfreq(N) * N\n\n    # Initial conditions\n    alpha_0 = 1.0 + EPSILON * np.sin(K0 * x)\n    K_0 = np.zeros(N)\n\n    def rhs(y, k, c_val):\n        \"\"\"\n        Computes the right-hand side of the semi-discrete system dy/dt = F(y).\n        - y: state vector [alpha, K] of size 2*N\n        - k: array of wavenumbers\n        - c_val: value of the parameter c\n        \"\"\"\n        alpha = y[:N]\n        K = y[N:]\n        \n        # d(alpha)/dt = -alpha^2 * (2/alpha + c) * K = -(2*alpha + c*alpha^2) * K\n        d_alpha_dt = -(2.0 * alpha + c_val * alpha**2) * K\n        \n        # d(K)/dt = -d^2(alpha)/dx^2\n        # Tilde indicates Fourier transform\n        alpha_tilde = np.fft.fft(alpha)\n        # d^2(alpha)/dx^2 = IFFT(-k^2 * alpha_tilde)\n        d2_alpha_dx2_tilde = -(k**2) * alpha_tilde\n        d2_alpha_dx2 = np.fft.ifft(d2_alpha_dx2_tilde).real\n        \n        d_K_dt = -d2_alpha_dx2\n        \n        return np.concatenate((d_alpha_dt, d_K_dt))\n\n    def run_simulation(c_val):\n        \"\"\"\n        Runs the full time evolution for a given c and returns the max steepening.\n        \"\"\"\n        y = np.concatenate((alpha_0.copy(), K_0.copy()))\n        max_abs_min_d_alpha_dx = 0.0\n\n        for _ in range(num_steps):\n            # RK4 integrator\n            k1 = rhs(y, wavenumbers, c_val)\n            k2 = rhs(y + 0.5 * dt * k1, wavenumbers, c_val)\n            k3 = rhs(y + 0.5 * dt * k2, wavenumbers, c_val)\n            k4 = rhs(y + dt * k3, wavenumbers, c_val)\n            y += (dt / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n\n            # Compute and track the maximum steepening\n            current_alpha = y[:N]\n            alpha_tilde = np.fft.fft(current_alpha)\n            # d(alpha)/dx = IFFT(i*k * alpha_tilde)\n            d_alpha_dx_tilde = 1j * wavenumbers * alpha_tilde\n            d_alpha_dx = np.fft.ifft(d_alpha_dx_tilde).real\n            \n            min_slope = np.min(d_alpha_dx)\n            if abs(min_slope) > max_abs_min_d_alpha_dx:\n                max_abs_min_d_alpha_dx = abs(min_slope)\n        \n        return max_abs_min_d_alpha_dx\n        \n    results = []\n    r_values = {}\n    \n    # Run simulations and calculate R(c) for all c\n    for c in test_cases_c:\n        max_steepening = run_simulation(c)\n        r_c = max_steepening / (EPSILON * K0)\n        r_values[c] = r_c\n\n    # Get R(0) for S(c) calculation\n    r0 = r_values[0.0]\n\n    for c in test_cases_c:\n        # Get R(c)\n        r_c = r_values[c]\n        \n        # Calculate S(c)\n        if c == 0.0:\n            s_c = 0\n        else:\n            s_c = 1 if r_c  r0 * (1.0 - DELTA) else 0\n\n        # Calculate T(c)\n        d_c = abs(c * ALPHA_MIN)\n        t_c = 1 if d_c = TAU else 0\n\n        # Append formatted triple to results\n        results.append(f\"[{r_c:.6f},{s_c},{t_c}]\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```",
            "answer": "[[12.879743,0,1],[10.970170,1,1],[5.232338,1,1],[2.459341,1,1]]"
        },
        {
            "introduction": "In the complexity of a full 3D numerical relativity simulation, monitoring the health of the gauge is paramount. Rather than inspecting dozens of individual fields, it is often more practical to construct synthetic scalar diagnostics that summarize the overall behavior. This exercise  guides you through the design and implementation of a \"gauge thermometer,\" a tool that combines information from the lapse, shift, and connection functions into a single, dimensionless quantity to flag potentially unhealthy gauge dynamics.",
            "id": "3479919",
            "problem": "Construct a self-contained program that computes, for a set of synthetic one-dimensional fields, a dimensionless scalar diagnostic that flags unhealthy gauge dynamics in the moving puncture gauge conditions used in numerical relativity. Begin from the following foundational elements and definitions.\n\nIn the Baumgarte–Shapiro–Shibata–Nakamura (BSSN) formulation, the moving puncture gauge combines $1+\\log$ slicing for the lapse function $\\,\\alpha\\,$ and a Gamma-driver condition for the shift vector $\\,\\beta^i\\,$. Schematically, $\\,\\partial_t \\alpha\\,$ and $\\,\\partial_t \\beta^i\\,$ encode the time response of gauge degrees of freedom, while the conformal connection functions $\\,\\tilde{\\Gamma}^i\\,$ monitor spatial gauge behavior. A synthetic scalar “gauge thermometer” $\\,T\\,$ shall incorporate these quantities. You must construct $\\,T\\,$ so that it satisfies all of the following properties:\n\n- It is dimensionless.\n- It vanishes when all gauge activity proxies $\\,\\partial_t \\alpha\\,$, $\\,\\partial_t \\beta^i\\,$, and $\\,\\tilde{\\Gamma}^i\\,$ are identically zero.\n- It increases monotonically as the amplitudes of $\\,\\partial_t \\alpha\\,$, $\\,\\partial_t \\beta^i\\,$, and $\\,\\tilde{\\Gamma}^i\\,$ increase.\n- It equals $\\,1\\,$ when the fields match a specified baseline configuration.\n\nUse the discrete $\\,L^2\\,$ norm on a uniform grid to combine components. For a scalar field $\\,f(x)\\,$ sampled on points $\\,x_j\\,$ with spacing $\\,\\Delta x\\,$, define\n$$\n\\|f\\|_2 \\equiv \\sqrt{\\Delta x \\sum_{j=0}^{N-1} f(x_j)^2}.\n$$\nFor a vector field $\\,v^i(x)\\,$ with components $\\,v^x, v^y, v^z\\,$ sampled on the same grid, define\n$$\n\\|v^i\\|_2 \\equiv \\sqrt{\\Delta x \\sum_{j=0}^{N-1} \\left( v^x(x_j)^2 + v^y(x_j)^2 + v^z(x_j)^2 \\right)}.\n$$\n\nConstruct the synthetic fields on a domain of length $\\,L\\,$ with $\\,N\\,$ points:\n- Let $\\,L = 1\\,$ and $\\,N = 10001\\,$, so $\\,\\Delta x = L/(N-1)\\,$ and $\\,x_j = j \\,\\Delta x\\,$ for $\\,j \\in \\{0,1,\\dots,N-1\\}\\,$.\n- Choose wavenumber $\\,k = 2\\pi/L\\,$.\n- For given amplitudes $\\,A_\\alpha\\,$, $\\,A_\\beta\\,$, and $\\,G\\,$, define the synthetic fields:\n  $$\n  \\partial_t \\alpha(x) = A_\\alpha \\,\\sin(k x),\n  $$\n  $$\n  \\partial_t \\beta^x(x) = A_\\beta \\,\\cos(k x), \\quad \\partial_t \\beta^y(x) = A_\\beta \\,\\sin(2 k x), \\quad \\partial_t \\beta^z(x) = 0,\n  $$\n  $$\n  \\tilde{\\Gamma}^x(x) = G \\,\\sin(k x), \\quad \\tilde{\\Gamma}^y(x) = G \\,\\cos(2 k x), \\quad \\tilde{\\Gamma}^z(x) = 0.\n  $$\n- Use weights $\\,w_\\alpha = 2\\,$, $\\,w_\\beta = 1\\,$, and $\\,w_\\Gamma = 0.5\\,$ to form a weighted gauge activity density at each grid point,\n  $$\n  e(x_j) = w_\\alpha \\left[\\partial_t \\alpha(x_j)\\right]^2 + w_\\beta \\left( \\left[\\partial_t \\beta^x(x_j)\\right]^2 + \\left[\\partial_t \\beta^y(x_j)\\right]^2 + \\left[\\partial_t \\beta^z(x_j)\\right]^2 \\right) + w_\\Gamma \\left( \\left[\\tilde{\\Gamma}^x(x_j)\\right]^2 + \\left[\\tilde{\\Gamma}^y(x_j)\\right]^2 + \\left[\\tilde{\\Gamma}^z(x_j)\\right]^2 \\right).\n  $$\n- Define the baseline amplitudes $\\,A_\\alpha^{\\mathrm{ref}} = 1\\,$, $\\,A_\\beta^{\\mathrm{ref}} = 1\\,$, and $\\,G^{\\mathrm{ref}} = 1\\,$, and construct the corresponding baseline density $\\,e_{\\mathrm{ref}}(x_j)\\,$ using the same formulas with the baseline amplitudes.\n\nFrom these definitions, derive and implement a dimensionless thermometer $\\,T\\,$ that satisfies the properties above by comparing the total weighted activity to its baseline value. Let $\\,\\tau = 1.5\\,$ be the threshold; define the unhealthy-gauge flag as $\\,\\text{unhealthy} = (T \\ge \\tau)\\,$.\n\nTest Suite:\nEvaluate the thermometer for the following five amplitude triplets $\\,\\left(A_\\alpha, A_\\beta, G\\right)\\,$:\n1. $\\,\\left(0.8,\\,0.7,\\,0.9\\right)\\,$ (a typical “happy path” case with moderate activity),\n2. $\\,\\left(1.5,\\,1.5,\\,1.5\\right)\\,$ (a boundary case intended to produce $\\,T \\approx \\tau\\,$),\n3. $\\,\\left(0,\\,0,\\,0\\right)\\,$ (an edge case with no activity),\n4. $\\,\\left(3,\\,3,\\,3\\right)\\,$ (a strong-activity case),\n5. $\\,\\left(1.0,\\,1.0,\\,3.0\\right)\\,$ (anisotropic increase in $\\,\\tilde{\\Gamma}^i\\,$ only).\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a boolean indicating whether the corresponding test case is unhealthy (i.e., $\\,T \\ge \\tau\\,$). For example, produce output in the form $\\,\\left[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_5\\right]\\,$. No physical units are involved; all quantities are unitless. Angles are in radians by construction.",
            "solution": "The problem requires the derivation and implementation of a dimensionless gauge thermometer, $T$, for diagnosing gauge dynamics in numerical relativity simulations. The derivation must satisfy a set of specified properties.\n\n**1. Derivation of the Gauge Thermometer $T$**\n\nWe are given the following:\n- A set of gauge activity proxy fields: the time derivative of the lapse, $\\partial_t \\alpha$, the time derivative of the shift vector, $\\partial_t \\beta^i$, and the conformal connection functions, $\\tilde{\\Gamma}^i$.\n- A weighted gauge activity density at each grid point $x_j$:\n$$\ne(x_j) = w_\\alpha \\left[\\partial_t \\alpha(x_j)\\right]^2 + w_\\beta \\left( \\left[\\partial_t \\beta^x(x_j)\\right]^2 + \\left[\\partial_t \\beta^y(x_j)\\right]^2 + \\left[\\partial_t \\beta^z(x_j)\\right]^2 \\right) + w_\\Gamma \\left( \\left[\\tilde{\\Gamma}^x(x_j)\\right]^2 + \\left[\\tilde{\\Gamma}^y(x_j)\\right]^2 + \\left[\\tilde{\\Gamma}^z(x_j)\\right]^2 \\right)\n$$\n- A baseline configuration defined by amplitudes $A_\\alpha^{\\mathrm{ref}} = 1$, $A_\\beta^{\\mathrm{ref}} = 1$, and $G^{\\mathrm{ref}} = 1$.\n\nThe problem states that $T$ should be derived by \"comparing the total weighted activity to its baseline value.\" The total weighted activity, let's call it $\\mathcal{E}$, is the integral of the activity density $e(x)$ over the spatial domain. In its discrete form, this is:\n$$\n\\mathcal{E} = \\Delta x \\sum_{j=0}^{N-1} e(x_j)\n$$\nLet $\\mathcal{E}_{\\mathrm{ref}}$ be the total weighted activity for the baseline configuration. A simple comparison that satisfies the dimensionless property is the ratio $\\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}}$. Let us check if $T = \\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}}$ satisfies all required properties.\n1.  **Dimensionless**: Yes, it's a ratio of two quantities with the same dimensions.\n2.  **Vanishes for zero activity**: If all amplitudes are zero, $e(x_j)=0$ for all $j$, so $\\mathcal{E}=0$ and $T=0$. Yes.\n3.  **Monotonically increasing**: Since $e(x_j)$ is a sum of squares of fields, which are themselves linear in the amplitudes $A_\\alpha, A_\\beta, G$, the total activity $\\mathcal{E}$ is a positive-definite quadratic form of the amplitudes. Thus, it increases as any amplitude increases (assuming positive amplitudes). Yes.\n4.  **$T=1$ at baseline**: When the fields are generated with baseline amplitudes, $\\mathcal{E} = \\mathcal{E}_{\\mathrm{ref}}$, so $T = 1$. Yes.\n\nThis definition appears valid. However, the problem provides a hint: test case $2$, with amplitudes $(1.5, 1.5, 1.5)$, is \"intended to produce $T \\approx \\tau = 1.5$\".\nLet's see what $T = \\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}}$ gives for this case. Since all fields are linear in their respective amplitudes, and $\\mathcal{E}$ is quadratic, if all amplitudes are scaled by a factor $s$ (i.e., $A_\\alpha = s A_\\alpha^{\\mathrm{ref}}$, $A_\\beta = s A_\\beta^{\\mathrm{ref}}$, $G = s G^{\\mathrm{ref}}$), then $\\mathcal{E}$ scales by $s^2$.\n$$\n\\mathcal{E}(s\\mathbf{A}^{\\mathrm{ref}}) = s^2 \\mathcal{E}(\\mathbf{A}^{\\mathrm{ref}}) = s^2 \\mathcal{E}_{\\mathrm{ref}}\n$$\nSo, for this special case, $T = \\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}} = s^2$. For test case $2$, $s=1.5$, which yields $T = 1.5^2 = 2.25$. This is not close to $\\tau=1.5$.\n\nThis suggests an alternative definition for $T$ that also satisfies the four properties. Consider:\n$$\nT = \\sqrt{\\frac{\\mathcal{E}}{\\mathcal{E}_{\\mathrm{ref}}}}\n$$\nLet's re-check the properties for this new definition:\n1.  **Dimensionless**: Yes, the ratio is dimensionless, and so is its square root.\n2.  **Vanishes for zero activity**: If $\\mathcal{E}=0$, then $T=0$. Yes.\n3.  **Monotonically increasing**: Since $\\mathcal{E}$ is monotonic and the square root function is monotonic for non-negative arguments, $T$ is also monotonic. Yes.\n4.  **$T=1$ at baseline**: If $\\mathcal{E} = \\mathcal{E}_{\\mathrm{ref}}$, then $T = \\sqrt{1} = 1$. Yes.\n\nThis definition also satisfies all properties. Now let's check it against the hint for test case $2$. With uniform scaling by $s=1.5$, we have:\n$$\nT = \\sqrt{\\frac{s^2 \\mathcal{E}_{\\mathrm{ref}}}{\\mathcal{E}_{\\mathrm{ref}}}} = \\sqrt{s^2} = |s|\n$$\nFor $s=1.5$, this gives $T=1.5$, which equals $\\tau$. This strongly indicates that $T = \\sqrt{\\mathcal{E}/\\mathcal{E}_{\\mathrm{ref}}}$ is the intended formula. The total activity $\\mathcal{E}$ is an energy-like quantity (quadratic in field amplitudes), while the diagnostic $T$ is normalized to be a field-like quantity (linear in field amplitudes, for uniform scaling).\n\nThe factor $\\Delta x$ in $\\mathcal{E}$ and $\\mathcal{E}_{\\mathrm{ref}}$ cancels in the ratio. Therefore, we can compute $T$ as:\n$$\nT = \\sqrt{\\frac{\\sum_{j=0}^{N-1} e(x_j)}{\\sum_{j=0}^{N-1} e_{\\mathrm{ref}}(x_j)}}\n$$\n\n**2. Implementation Strategy**\n\nThe implementation will follow these steps:\n1.  Define all physical and numerical constants ($L, N, w_\\alpha, w_\\beta, w_\\Gamma, \\tau$, and the baseline amplitudes).\n2.  Create a helper function that, given a set of amplitudes $(A_\\alpha, A_\\beta, G)$, computes the total activity sum $\\sum e(x_j)$. This function will:\n    a.  Generate the spatial grid $x_j$.\n    b.  Calculate the wavenumber $k$.\n    c.  Generate the six synthetic field components as NumPy arrays.\n    d.  Compute the activity density $e(x_j)$ at each grid point.\n    e.  Return the sum of the activity density array.\n3.  Call this helper function with the baseline amplitudes $(1, 1, 1)$ to compute the reference total activity, $\\sum e_{\\mathrm{ref}}(x_j)$.\n4.  Iterate through the specified test cases. For each case:\n    a.  Call the helper function with the test case amplitudes to get its total activity, $\\sum e(x_j)$.\n    b.  Calculate the thermometer $T$ using the derived formula.\n    c.  Compare $T$ with the threshold $\\tau=1.5$ to determine the `unhealthy` flag (True/False).\n5.  Collect the boolean results and format them into the required output string.\n\nThe use of NumPy for array operations will make the implementation concise and efficient.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a gauge health diagnostic for a set of synthetic fields\n    in numerical relativity.\n    \"\"\"\n    # Define physical and numerical parameters from the problem statement.\n    L = 1.0\n    N = 10001\n    w_alpha = 2.0\n    w_beta = 1.0\n    w_gamma = 0.5\n    tau = 1.5\n\n    # Baseline amplitudes for the reference configuration.\n    ref_amplitudes = (1.0, 1.0, 1.0) # (A_alpha^ref, A_beta^ref, G^ref)\n\n    # Test cases: sets of (A_alpha, A_beta, G)\n    test_cases = [\n        (0.8, 0.7, 0.9),\n        (1.5, 1.5, 1.5),\n        (0.0, 0.0, 0.0),\n        (3.0, 3.0, 3.0),\n        (1.0, 1.0, 3.0),\n    ]\n\n    # Grid setup\n    x = np.linspace(0, L, N)\n    k = 2.0 * np.pi / L\n\n    def compute_total_activity(amplitudes):\n        \"\"\"\n        Calculates the total integrated gauge activity for a given set of amplitudes.\n        The integration factor dx cancels in the final ratio for T, so we\n        compute the sum of the density e(x_j).\n        \"\"\"\n        A_alpha, A_beta, G = amplitudes\n\n        # Generate synthetic fields based on the given amplitudes.\n        # Time derivative of lapse alpha\n        dt_alpha = A_alpha * np.sin(k * x)\n\n        # Time derivative of shift vector beta^i\n        dt_betax = A_beta * np.cos(k * x)\n        dt_betay = A_beta * np.sin(2 * k * x)\n        # dt_betaz is zero per problem spec, so it can be omitted from sums.\n\n        # Conformal connection functions Gamma_tilde^i\n        Gamma_tildex = G * np.sin(k * x)\n        Gamma_tildey = G * np.cos(2 * k * x)\n        # Gamma_tildez is zero per problem spec.\n\n        # Calculate the weighted gauge activity density e(x) at each grid point.\n        e_density = (\n            w_alpha * dt_alpha**2\n            + w_beta * (dt_betax**2 + dt_betay**2)\n            + w_gamma * (Gamma_tildex**2 + Gamma_tildey**2)\n        )\n\n        # The total activity is the sum over the grid.\n        return np.sum(e_density)\n\n    # Calculate the total activity for the baseline reference configuration.\n    total_activity_ref = compute_total_activity(ref_amplitudes)\n\n    results = []\n    for case_amplitudes in test_cases:\n        # Calculate total activity for the current test case.\n        total_activity_case = compute_total_activity(case_amplitudes)\n\n        # The denominator cannot be zero given the reference amplitudes are non-zero.\n        if total_activity_ref == 0:\n            # This case should not be reached with the given problem parameters.\n            # If ref activity is zero, any non-zero activity is infinitely unhealthy.\n            T = float('inf') if total_activity_case > 0 else 0.0\n        else:\n            # Define the thermometer T as the square root of the ratio of activities.\n            # This makes T scale linearly with amplitude for uniform scalings.\n            T = np.sqrt(total_activity_case / total_activity_ref)\n\n        # Determine if the gauge condition is unhealthy.\n        is_unhealthy = (T >= tau)\n        results.append(is_unhealthy)\n\n    # Format the final output as a comma-separated list of lowercase booleans.\n    output_str = f\"[{','.join(str(r).lower() for r in results)}]\"\n    print(output_str)\n\nsolve()\n```",
            "answer": "[false,true,false,true,true]"
        }
    ]
}