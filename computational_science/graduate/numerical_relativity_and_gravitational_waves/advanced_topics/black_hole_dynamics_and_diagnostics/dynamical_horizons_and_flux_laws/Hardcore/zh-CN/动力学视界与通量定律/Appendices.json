{
    "hands_on_practices": [
        {
            "introduction": "动态视界理论的基石在于对“边缘捕获面”的精确几何定义。本练习  提供了一个绝佳的实践机会，通过分析一个描述黑洞吸积过程的简化但重要的时空模型——Vaidya时空，来动手计算零法向量的膨胀 $\\theta_{(\\ell)}$ 和 $\\theta_{(n)}$。通过确定向外零膨胀为零的位置，你将亲自验证动态视界的位置，从而将抽象的定义转化为具体的计算技能。",
            "id": "3472237",
            "problem": "考虑用于黑洞增长的数值相对论研究中的球对称内行 Vaidya 时空，\n$$\nds^{2} = -\\left(1 - \\frac{2 M(v)}{r}\\right) dv^{2} + 2\\, dv\\, dr + r^{2} d\\Omega^{2},\n$$\n其中 $M(v)$ 是关于推迟时间 $v$ 的光滑非减质量函数，$d\\Omega^{2}$ 是单位二维球面上的线元。令 $S$ 为一个具有恒定 $v$ 和 $r$ 的圆形二维球面。临界俘获管 (MTT) 是一个由这类球面构成的超曲面，在其上，未来指向向外零法向量的膨胀为零，而未来指向向内零法向量的膨胀为负。\n\n从适用于动力学视界的基本定义出发：\n- 零法向量 $\\ell^{a}$ 和 $n^{a}$ 是未来指向的，与 $S$ 正交，并通过 $\\ell^{a} n_{a} = -1$ 进行归一化。\n- 零法向量 $k^{a}$ 的膨胀 $\\theta_{(k)}$ 定义为沿 $k^{a}$ 方向 $S$ 的面积的分数变化率。\n\n推导 $\\theta_{(\\ell)}$ 和 $\\theta_{(n)}$ 关于 $r$ 和 $M(v)$ 的显式表达式，然后在其超曲面 $r = 2 M(v)$ 上求值。清楚地陈述有序对 $\\left(\\theta_{(\\ell)}\\big|_{r=2M(v)},\\, \\theta_{(n)}\\big|_{r=2M(v)}\\right)$，并用它来识别位于 $r=2M(v)$ 处的 MTT。\n\n在几何单位制（$G = c = 1$）下表达你的最终答案。你的最终答案必须是两个求值后膨胀的有序对，以单行矩阵的形式呈现。无需四舍五入。",
            "solution": "该问题要求推导内行 Vaidya 时空的零膨胀，并在超曲面 $r = 2M(v)$ 上对其进行求值，以将其识别为临界俘获管 (MTT)。\n\n内行 Vaidya 度规在类推迟 Eddington-Finkelstein 坐标 $(v, r, \\theta, \\phi)$ 中给出为\n$$\nds^{2} = -\\left(1 - \\frac{2 M(v)}{r}\\right) dv^{2} + 2\\, dv\\, dr + r^{2} d\\Omega^{2}\n$$\n其中 $d\\Omega^{2} = d\\theta^2 + \\sin^2\\theta \\, d\\phi^2$。协变度规张量分量 $g_{ab}$ 可以直接从线元中读出：\n$g_{vv} = -\\left(1 - \\frac{2M(v)}{r}\\right)$\n$g_{vr} = g_{rv} = 1$\n$g_{\\theta\\theta} = r^2$\n$g_{\\phi\\phi} = r^2 \\sin^2\\theta$\n所有其他分量均为零。\n\n为了找到零法向量，我们首先需要逆变度规张量 $g^{ab}$，它是 $g_{ab}$ 的逆。对应于 $(v, r)$ 坐标的块是 $\\begin{pmatrix} g_{vv}  g_{vr} \\\\ g_{rv}  g_{rr} \\end{pmatrix} = \\begin{pmatrix} -(1 - 2M(v)/r)  1 \\\\ 1  0 \\end{pmatrix}$。其逆矩阵是 $\\begin{pmatrix} 0  1 \\\\ 1  1 - 2M(v)/r \\end{pmatrix}$。角向部分是对角的，很容易求逆。因此，$g^{ab}$ 的非零分量是：\n$g^{vr} = g^{rv} = 1$\n$g^{rr} = 1 - \\frac{2M(v)}{r}$\n$g^{\\theta\\theta} = \\frac{1}{r^2}$\n$g^{\\phi\\phi} = \\frac{1}{r^2 \\sin^2\\theta}$\n\n曲面 $S$ 是一个常数 $v$ 和 $r$ 的二维球面。其切空间由 $\\frac{\\partial}{\\partial\\theta}$ 和 $\\frac{\\partial}{\\partial\\phi}$ 张成。零法向量 $\\ell^a$ 和 $n^a$ 必须与 $S$ 正交。由于度规的块对角结构，任何仅具有 $(v, r)$ 分量的向量都与 $S$ 切空间中的任何向量正交。因此，我们寻找形式为 $k^a = (k^v, k^r, 0, 0)$ 的零向量。零条件是 $g_{ab} k^a k^b = 0$。\n$$\ng_{vv}(k^v)^2 + 2 g_{vr} k^v k^r + g_{rr}(k^r)^2 = 0\n$$\n$$\n-\\left(1 - \\frac{2M(v)}{r}\\right)(k^v)^2 + 2 k^v k^r = 0\n$$\n$$\nk^v \\left[ 2k^r - \\left(1 - \\frac{2M(v)}{r}\\right)k^v \\right] = 0\n$$\n这个方程产生了两族零方向：\n1. $k^v = 0$：这意味着 $k^a$ 与 $(0, 1, 0, 0)$ 成比例。这个向量 $\\frac{\\partial}{\\partial r}$ 与常数 $v$ 的零超曲面相切。它代表内行光线。为了指向内部（$r$ 减小），其 $r$ 分量必须为负。这是我们的向内零法向量 $n^a$。\n2. $2k^r = \\left(1 - \\frac{2M(v)}{r}\\right)k^v$：这给出了一个与 $\\left(1, \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right), 0, 0\\right)$ 成比例的向量。对于 $r  2M(v)$，径向分量为正，表示向外的方向。这是我们的向外零法向量 $\\ell^a$。\n\n两个向量都必须是未来指向的。在这个坐标系中，由于 $v$ 是推迟时间，如果一个向量 $k^a$ 的 $v$ 分量为正，或者在 $k^v=0$ 的极限情况下，如果它与未来的零光锥相切，那么它就是未来指向的。对于 $\\ell^a$，我们可以选择一个缩放使得 $\\ell^v > 0$。对于 $n^a$，我们有 $n^v=0$；与协变未来指向向量 $dv = (1,0,0,0)_a$ 进行缩并，我们发现 $n^a (dv)_a = n^v = 0$，所以它位于边界上。我们可以通过检查它与一个类时向量的缩并来验证它是未来指向的，例如，对于一个四维速度为 $T^a \\propto (\\partial/\\partial v)^a$ 的观察者，条件 $g_{ab}k^a T^b  0$ 必须成立。对于 $n^a \\propto (0,-1,0,0)$，我们有 $g_{ab} n^a T^b \\propto g_{vr}n^r = -1  0$。所以两者都是未来指向的。\n\n现在我们使用归一化条件 $\\ell^a n_a = -1$ 和一个正则选择来固定零向量 $\\ell^a$ 和 $n^a$ 的缩放。一个标准的选择是选择其中一个向量与仿射参数化的零测地线汇相切。让我们分析 $n^a \\propto (0, -1, 0, 0)$。对于具有切向量 $k^a$ 的仿射参数化测地线，其测地线方程为 $k^b \\nabla_b k^a = 0$。对于 $n^a = C_n(0, -1, 0, 0) = (0, -C_n, 0, 0)$，加速度为 $n^b\\nabla_b n^a = n^r\\nabla_r n^a = -C_n (\\partial_r n^a + \\Gamma^a_{rb}n^b) = -C_n \\Gamma^a_{rr} n^r$。Christoffel 符号分量 $\\Gamma^a_{rr}$ 由 $\\Gamma^\\lambda_{rr} = g^{\\lambda\\sigma}\\partial_r g_{r\\sigma}$ 给出。由于 $g_{r\\sigma}$ 的所有分量（即 $g_{rv}=1$, $g_{rr}=0$ 等）都与 $r$ 无关，所以 $\\Gamma^a_{rr}=0$。因此，$n^b \\nabla_b n^a = 0$。我们可以做出正则选择 $C_n=1$，所以 $n^a=(0,-1,0,0)$ 是仿射参数化的。\n\n对于 $n^a = (0, -1, 0, 0)$，我们求其协变形式 $n_a = g_{ab} n^b$。\n$n_v = g_{vv}n^v + g_{vr}n^r = (1)(-1) = -1$。\n$n_r = g_{rv}n^v + g_{rr}n^r = 0$。\n所以，$n_a = (-1, 0, 0, 0)$。\n\n现在我们设 $\\ell^a = C_\\ell \\left(1, \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right), 0, 0\\right)$ 并使用归一化条件：\n$\\ell^a n_a = \\ell^v n_v = C_\\ell(1)(-1) = -C_\\ell = -1$，这意味着 $C_\\ell = 1$。\n因此，我们正则归一化的零向量是：\n$$\n\\ell^a = \\left(1, \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right), 0, 0\\right)\n$$\n$$\nn^a = \\left(0, -1, 0, 0\\right)\n$$\n\n零向量场 $k^a$ 的膨胀 $\\theta_{(k)}$ 是曲面 $S$ 面积 $A$ 的分数变化率。半径为 $r$ 的球面 $S$ 的面积是 $A = 4\\pi r^2$。\n$$\n\\theta_{(k)} = \\frac{1}{A} \\mathcal{L}_k A = \\frac{1}{4\\pi r^2} \\mathcal{L}_k (4\\pi r^2) = \\frac{1}{r^2} k^a \\partial_a (r^2) = \\frac{1}{r^2} (2r k^a \\partial_a r) = \\frac{2}{r} k^r\n$$\n使用这个公式，我们可以计算 $\\ell^a$ 和 $n^a$ 的膨胀。\n对于向外零法向量 $\\ell^a$，其径向分量是 $\\ell^r = \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right)$。膨胀是：\n$$\n\\theta_{(\\ell)} = \\frac{2}{r} \\ell^r = \\frac{2}{r} \\cdot \\frac{1}{2}\\left(1 - \\frac{2M(v)}{r}\\right) = \\frac{1}{r}\\left(1 - \\frac{2M(v)}{r}\\right)\n$$\n对于向内零法向量 $n^a$，其径向分量是 $n^r = -1$。膨胀是：\n$$\n\\theta_{(n)} = \\frac{2}{r} n^r = \\frac{2}{r}(-1) = -\\frac{2}{r}\n$$\n\n最后，我们在由 $r=2M(v)$ 定义的超曲面上计算这些膨胀。\n$$\n\\theta_{(\\ell)}\\bigg|_{r=2M(v)} = \\frac{1}{2M(v)}\\left(1 - \\frac{2M(v)}{2M(v)}\\right) = \\frac{1}{2M(v)}(1 - 1) = 0\n$$\n$$\n\\theta_{(n)}\\bigg|_{r=2M(v)} = -\\frac{2}{2M(v)} = -\\frac{1}{M(v)}\n$$\n临界俘获管的条件是，它是由一些曲面叶构成的，在这些曲面上，向外零膨胀为零（$\\theta_{(\\ell)}=0$），而向内零膨胀为负（$\\theta_{(n)}0$）。由于 $M(v)$ 是一个非减质量函数，我们假设 $M(v)>0$，所以 $\\theta_{(n)}  0$。我们的结果证实了超曲面 $r=2M(v)$ 确实是一个临界俘获管（具体来说，是一个临界外俘获管，它是一种动力学视界）。\n\n两个求值后膨胀的有序对是 $\\left(0, -\\frac{1}{M(v)}\\right)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  -\\frac{1}{M(v)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "控制视界动力学的基本定律，如Raychaudhuri方程和爱因斯坦场方程，将物质的能量-动量张量 $T_{ab}$ 与时空的几何演化紧密联系起来。这个思想实验  深入探讨了当物质通量违反零能量条件（NEC）时视界的行为，这种情况在考虑霍金辐射等量子效应时尤其重要。通过分析这种假设情境，你将能够推断视界的因果结构（类时、类空或类光）如何依赖于能量通量，并理解视界面积为何可能减小，这直接关系到黑洞热力学的第二定律。",
            "id": "3472241",
            "problem": "考虑一个球对称坍缩时空，其中一个携带负能量密度的紧致、内行零壳层局限于高级时间 $v \\in (v_{1}, v_{2})$ 的一个区间内，靠近外部临界捕获区域。在此区间之外，时空满足零能量条件 (NEC)。令 $\\mathcal{S}_{v}$ 是由封闭的、外部临界捕获面 (MOTS) 构成的叶状结构，其向外和向内的未来指向零法向量为 $\\ell^{a}$ 和 $n^{a}$，归一化为 $\\ell^{a} n_{a} = -1$，使得在每个 $\\mathcal{S}_{v}$ 上都有 $\\theta_{(\\ell)} = 0$ 和 $\\theta_{(n)}  0$。假设球对称性，使得出射汇的剪切为零，$\\sigma^{2}_{(\\ell)} = 0$，且扭曲为零。进一步假设，在区间 $v \\in (v_{1}, v_{2})$ 内，内行零能量密度在 MOTS 上及其紧邻外部满足 $T_{ab} \\ell^{a} \\ell^{b}  0$，而在此区间外 $T_{ab} \\ell^{a} \\ell^{b} \\ge 0$。\n\n令临界捕获管 (MTT) 是由叶状结构 $\\{\\mathcal{S}_{v}\\}$ 生成的三维面，并令 $h^{a}$ 表示切于 MTT 并正交于每个 $\\mathcal{S}_{v}$ 的未来指向矢量场。将 $h^{a}$ 沿零法向量分解为 $h^{a} = \\ell^{a} - C\\, n^{a}$，其中 $C$ 是定义在 MTT 上的某个标量。$C$ 的符号通过 $h^{a} h_{a} = 2 C$ 决定 MTT 的号差。\n\n仅使用零 Raychaudhuri 方程、关联 $R_{ab} \\ell^{a} \\ell^{b}$ 与 $T_{ab} \\ell^{a} \\ell^{b}$ 的 Einstein 场方程，以及未来外部 MOTS 的定义属性，分析在 $v \\in (v_{1}, v_{2})$ 期间，局域化的 NEC 违背对 MTT 上的 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}$ 和 $\\mathcal{L}_{n} \\theta_{(\\ell)}$ 符号的影响。根据这些符号，推断此区间内 $C$ 的符号，并确定该 MTT 片段是类空的、类光的还是类时的。最后，推断在 $v \\in (v_{1}, v_{2})$ 期间，截面 $\\mathcal{S}_{v}$ 的面积沿 $h^{a}$ 变化的符号。\n\n选择在区间 $v \\in (v_{1}, v_{2})$ 内正确陈述结论的选项。\n\nA. 在视界附近局域化 $T_{ab} \\ell^{a} \\ell^{b}  0$ 且 $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$（未来外部条件）的情况下，我们有 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} > 0$，因此 $C  0$，所以 MTT 片段是类时的，并且 $\\mathcal{S}_{v}$ 的面积沿 $h^{a}$ 减小。\n\nB. 在视界附近局域化 $T_{ab} \\ell^{a} \\ell^{b}  0$ 且 $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$ 的情况下，我们有 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} > 0$，因此 $C > 0$，所以 MTT 片段是类空的，并且 $\\mathcal{S}_{v}$ 的面积沿 $h^{a}$ 增加。\n\nC. 在视界附近局域化 $T_{ab} \\ell^{a} \\ell^{b}  0$ 且 $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$ 的情况下，我们有 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} = 0$，因此 $C = 0$，所以 MTT 片段是类光的（孤立的），并且 $\\mathcal{S}_{v}$ 的面积沿 $h^{a}$ 保持不变。\n\nD. 无论 $T_{ab} \\ell^{a} \\ell^{b}$ 的符号如何，$\\mathcal{L}_{n} \\theta_{(\\ell)}$ 的符号不影响 MTT 的号差，因此无法从这些数据中推断出 $C$。",
            "solution": "首先将验证问题陈述的科学合理性、一致性和完整性。\n\n### 步骤 1：提取已知条件\n-   **时空与几何**：球对称坍缩时空，包含一个由封闭的、外部临界捕获面 (MOTS) 构成的叶状结构，记为 $\\mathcal{S}_{v}$。该叶状结构生成的三维面为临界捕获管 (MTT)。\n-   **零法向量**：$\\ell^{a}$（向外）和 $n^{a}$（向内）是 $\\mathcal{S}_{v}$ 的未来指向零法向量，归一化为 $\\ell^{a} n_{a} = -1$。\n-   **MOTS 条件**：在每个面 $\\mathcal{S}_{v}$ 上，出射零汇的膨胀为零（$\\theta_{(\\ell)} = 0$），而内行零汇的膨胀为负（$\\theta_{(n)}  0$）。\n-   **对称性条件**：由于球对称性，出射汇的剪切为零（$\\sigma^{2}_{(\\ell)} = 0$），且扭曲为零。\n-   **物质内容与能量条件**：\n    -   在高级时间区间 $v \\in (v_{1}, v_{2})$ 内，一个内行零壳层携带负能量密度，使得在 MOTS 上及其附近满足 $T_{ab} \\ell^{a} \\ell^{b}  0$。\n    -   在此区间之外，零能量条件 (NEC) 成立，即 $T_{ab} \\ell^{a} \\ell^{b} \\ge 0$。\n-   **MTT 切向量**：$h^{a}$ 是一个未来指向矢量场，切于 MTT 并正交于每个 $\\mathcal{S}_{v}$。它被分解为 $h^{a} = \\ell^{a} - C\\, n^{a}$，其中 $C$ 是 MTT 上的一个标量函数。\n-   **MTT 号差**：MTT 的因果性质由 $C$ 的符号通过关系式 $h^{a} h_{a} = 2 C$ 决定。\n-   **未来外部条件**：问题提到了“未来外部 MOTS”。这是动力学视界理论中的一个标准稳定性条件，它意味着 $\\theta_{(\\ell)}$ 在内行零方向上的导数具有特定的符号。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是在广义相对论的既定框架内提出的，特别是动力学视界和捕获面理论。\n-   **科学基础**：所有概念——MOTS、MTT、Raychaudhuri 方程、Einstein 场方程 (EFE) 和零能量条件 (NEC)——都是现代引力物理中的标准概念。NEC 违背的情景由半经典效应（如 Hawking 辐射）提供物理动机。该问题是科学合理的。\n-   **适定性**：问题提供了足够的信息和明确的目标。已知条件足以唯一确定所讨论量的符号。\n-   **客观性**：语言技术性强且精确，没有主观或模棱两可的陈述。\n-   **完整性与一致性**：问题陈述是自洽的，其条件相互一致。该设置描述了一个经过充分研究的物理情景（一个蒸发黑洞模型）。\n\n### 步骤 3：结论与行动\n问题陈述有效。可以从所提供的信息和基本原理中推导出严谨的解。\n\n### 推导\n求解过程通过将零 Raychaudhuri 方程和 Einstein 场方程应用于给定的几何设置来进行。\n\n1.  **分析 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)}$**：\n    膨胀 $\\theta_{(\\ell)}$ 沿由 $\\ell^a$ 生成的出射零汇的演化由零 Raychaudhuri 方程控制：\n    $$ \\mathcal{L}_{\\ell} \\theta_{(\\ell)} = -\\frac{1}{2}\\theta_{(\\ell)}^2 - \\sigma_{ab}^{(\\ell)} \\sigma^{(\\ell)ab} + \\omega_{ab}^{(\\ell)} \\omega^{(\\ell)ab} - R_{ab} \\ell^a \\ell^b $$\n    其中 $\\mathcal{L}_{\\ell}$ 是沿 $\\ell^a$ 的李导数。\n    我们在 MOTS $\\mathcal{S}_v$ 上应用问题中给出的条件：\n    -   临界捕获条件：$\\theta_{(\\ell)} = 0$。\n    -   球对称性意味着零剪切和零扭曲：$\\sigma_{ab}^{(\\ell)} = 0$ 和 $\\omega_{ab}^{(\\ell)} = 0$。\n    将这些代入 Raychaudhuri 方程，简化为：\n    $$ \\mathcal{L}_{\\ell} \\theta_{(\\ell)} = -R_{ab} \\ell^a \\ell^b $$\n    接下来，我们使用 Einstein 场方程，$G_{ab} = R_{ab} - \\frac{1}{2} R g_{ab} = 8 \\pi T_{ab}$（在 $G=c=1$ 的单位制下）。这可以重写为 $R_{ab} = 8 \\pi (T_{ab} - \\frac{1}{2} T g_{ab})$。与 $\\ell^a \\ell^b$ 缩并，并利用 $\\ell^a$ 是零向量（$g_{ab}\\ell^a\\ell^b=0$）的事实，我们得到：\n    $$ R_{ab} \\ell^a \\ell^b = 8 \\pi (T_{ab} \\ell^a \\ell^b - \\frac{1}{2} T g_{ab} \\ell^a \\ell^b) = 8 \\pi T_{ab} \\ell^a \\ell^b $$\n    结合这些结果，得到物质内容与几何之间的直接关系：\n    $$ \\mathcal{L}_{\\ell} \\theta_{(\\ell)} = -8 \\pi T_{ab} \\ell^a \\ell^b $$\n    在区间 $v \\in (v_{1}, v_{2})$ 内，问题陈述 NEC 被违背，使得 $T_{ab} \\ell^a \\ell^b  0$。因此，$\\mathcal{L}_{\\ell} \\theta_{(\\ell)} > 0$。\n\n2.  **确定 $C$ 的符号和 MTT 的号差**：\n    向量 $h^a = \\ell^a - C n^a$ 切于 MTT。根据定义，条件 $\\theta_{(\\ell)} = 0$ 对构成 MTT 的所有曲面 $\\mathcal{S}_v$ 都成立。因此，$\\theta_{(\\ell)}$ 沿任何切于 MTT 的方向的导数必须为零。特别是，沿 $h^a$ 的李导数必须为零：\n    $$ \\mathcal{L}_h \\theta_{(\\ell)} = 0 $$\n    使用 $h^a$ 的分解：\n    $$ \\mathcal{L}_h \\theta_{(\\ell)} = \\mathcal{L}_{\\ell^a - C n^a} \\theta_{(\\ell)} = \\mathcal{L}_{\\ell} \\theta_{(\\ell)} - C \\mathcal{L}_{n} \\theta_{(\\ell)} = 0 $$\n    这给了我们标量 $C$ 的表达式：\n    $$ C = \\frac{\\mathcal{L}_{\\ell} \\theta_{(\\ell)}}{\\mathcal{L}_{n} \\theta_{(\\ell)}} $$\n    如上所示，分子为正。分母的符号来自“未来外部 MOTS”条件。一个未来外部捕获视界（一种动力学视界）由稳定性条件 $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$ 定义。这意味着从 MOTS（其中 $\\theta_{(\\ell)}=0$）沿内行零方向 $n^a$ 无限小移动，会进入一个 $\\theta_{(\\ell)}$ 为负的区域，即这些面变得严格捕获。\n    在 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} > 0$ 和 $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$ 的情况下，$C$ 的符号为：\n    $$ C = \\frac{(+)}{(-)}  0 $$\n    MTT 片段的因果性质（号差）由 $h^a h_a = 2C$ 给出。由于 $C  0$，我们有 $h^a h_a  0$。一个平方范数为负的非零向量是**类时**的。因此，对于 $v \\in (v_{1}, v_{2})$ 的 MTT 片段是类时的。\n\n3.  **确定面积变化**：\n    截面 $\\mathcal{S}_v$ 的面积 $A$ 沿矢量场 $h^a$ 的变化率由 $\\mathcal{L}_h A$ 给出。由于球对称性，面积变化可以用膨胀来表示：\n    $$ \\mathcal{L}_h A = A \\left( \\theta_{(\\ell)} - C \\theta_{(n)} \\right) $$\n    在 MOTS 上，我们有 $\\theta_{(\\ell)} = 0$，所以表达式简化为：\n    $$ \\mathcal{L}_h A = - C \\theta_{(n)} A $$\n    我们可以确定这个表达式的符号：\n    -   我们发现 $C  0$，这意味着 $-C > 0$。\n    -   问题陈述这些面是捕获的，这意味着 $\\theta_{(n)}  0$。\n    -   面积 $A$ 内在地是正的，$A > 0$。\n    结合这些符号：\n    $$ \\mathcal{L}_h A = (-C) \\times (\\theta_{(n)}) \\times (A) = (+) \\times (-) \\times (+)  0 $$\n    因此，在区间 $v \\in (v_{1}, v_{2})$ 内，MOTS 截面的面积沿向量 $h^a$ **减小**。这对应于一个蒸发黑洞的物理图像。\n\n### 逐项分析选项\n\n*   **A. 在视界附近局域化 $T_{ab} \\ell^{a} \\ell^{b}  0$ 且 $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$（未来外部条件）的情况下，我们有 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} > 0$，因此 $C  0$，所以 MTT 片段是类时的，并且 $\\mathcal{S}_{v}$ 的面积沿 $h^{a}$ 减小。**\n    此陈述与从第一性原理推导出的所有结论完全匹配：\n    -   $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} > 0$ 是正确的。\n    -   $C  0$ 是正确的。\n    -   MTT 片段是类时的是正确的。\n    -   面积沿 $h^a$ 减小是正确的。\n    结论：**正确**。\n\n*   **B. 在视界附近局域化 $T_{ab} \\ell^{a} \\ell^{b}  0$ 且 $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$ 的情况下，我们有 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} > 0$，因此 $C > 0$，所以 MTT 片段是类空的，并且 $\\mathcal{S}_{v}$ 的面积沿 $h^{a}$ 增加。**\n    此选项正确地指出了 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} > 0$。然而，它错误地推断出 $C > 0$。鉴于 $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$，$C$ 必须为负。因此，关于 MTT 是类空的以及面积增加的论断也是错误的。\n    结论：**错误**。\n\n*   **C. 在视界附近局域化 $T_{ab} \\ell^{a} \\ell^{b}  0$ 且 $\\mathcal{L}_{n} \\theta_{(\\ell)}  0$ 的情况下，我们有 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} = 0$，因此 $C = 0$，所以 MTT 片段是类光的（孤立的），并且 $\\mathcal{S}_{v}$ 的面积沿 $h^{a}$ 保持不变。**\n    此选项错误地陈述 $\\mathcal{L}_{\\ell} \\theta_{(\\ell)} = 0$。这仅在 $T_{ab} \\ell^a \\ell^b = 0$ 时才成立，而这与 NEC 违背的前提相矛盾。所有后续结论都基于这个错误的前提。\n    结论：**错误**。\n\n*   **D. 无论 $T_{ab} \\ell^{a} \\ell^{b}$ 的符号如何，$\\mathcal{L}_{n} \\theta_{(\\ell)}$ 的符号不影响 MTT 的号差，因此无法从这些数据中推断出 $C$。**\n    这个陈述根本上是错误的。推导表明 $C = \\mathcal{L}_{\\ell} \\theta_{(\\ell)} / \\mathcal{L}_{n} \\theta_{(\\ell)}$。分母 $\\mathcal{L}_{n} \\theta_{(\\ell)}$ 的符号在确定 $C$ 的符号，从而确定 MTT 的号差方面是至关重要的。$C$ 的符号可以并且已经从数据中推断出来了。\n    结论：**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "黑洞力学定律在动态视界框架下被推广为局域的、随时间演化的平衡方程，其中动态视界第一定律尤为核心。该定律指出，视界能量的变化率等于穿过视界的物质能流与引力波能流之和，可表示为 $\\frac{\\kappa}{8\\pi} \\frac{dA}{dv} = \\int_{S_v} (\\mu + \\frac{\\|\\sigma\\|^2}{16\\pi}) dS$。这个编程练习  将此定律转化为一个具体的数值验证任务，要求你通过实现两种独立的方法来计算能量通量，从而检验该平衡律。这个过程不仅能加深你对通量定律物理内涵的理解，还能让你亲身体验数值相对论中验证基本物理守恒律的严谨方法。",
            "id": "3472226",
            "problem": "您的任务是通过比较由独立定义构造的两个时间局域速率，来检验未来外捕获视界上的瞬时第一定律平衡。在$G=c=1$的几何单位制下进行计算。所有角度均以弧度为单位。针对每个给定的案例，实现一个程序，计算叶状剖分参数 $v$ 的两个函数：(i) 乘积 $Q_1(v) = \\left(\\kappa(v)/8\\pi\\right)\\, dA/dv$，其中面积 $A(v)$ 的导数使用数值方法计算；(ii) 速率 $Q_2(v) = dE_{\\mathrm{H}}/dv$，由下文定义的通量积分得到。然后，对每个案例，返回在给定的 $v$ 网格上二者的最大绝对失配 $\\max_v |Q_1(v)-Q_2(v)|$。\n\n您的工作应仅基于以下基本定义和事实：\n- 面积半径为 $R(v)$ 的球面的横截面积为 $A(v)=4\\pi R(v)^2$。\n- 沿视界叶状剖分的表面引力由一个给定的函数 $v\\mapsto \\kappa(v)$ 给出。\n- 沿视界的瞬时能量积累率由通量积分定义\n  $$\\frac{dE_{\\mathrm{H}}}{dv}(v) = \\int_{S_v} \\mu(\\theta,\\phi;v)\\, dS + \\frac{1}{16\\pi}\\int_{S_v} \\|\\sigma\\|^2(\\theta,\\phi;v)\\, dS,$$\n  其中 $\\mu(\\theta,\\phi;v)$ 是物质能量密度 $\\mu=T_{ab}\\,\\ell^a n^b$，$\\|\\sigma\\|^2(\\theta,\\phi;v)$ 是出射零法向量剪切的范数平方，球面横截面上的面积元为 $dS = R(v)^2 \\sin\\theta\\, d\\theta\\, d\\phi$。\n- 数值导数 $dA/dv$ 必须根据采样点 $A(v_i)$ 计算，其中内部点使用二阶中心差分，端点使用一阶单边差分。\n\n您的程序必须为以下三个案例计算上述量。在所有案例中，使用相同的角向求积法则：在具有 $N_\\theta=64$ 个极向采样点和 $N_\\phi=96$ 个方位角采样点的球面网格上，使用张量积中点法则。具体而言，令 $\\Delta\\theta=\\pi/N_\\theta$，$\\Delta\\phi=2\\pi/N_\\phi$，并在 $i=0,\\dots,N_\\theta-1$ 时采样 $\\theta_i = (i+\\tfrac{1}{2})\\Delta\\theta$，在 $j=0,\\dots,N_\\phi-1$ 时采样 $\\phi_j = (j+\\tfrac{1}{2})\\Delta\\phi$。使用权重为 $R(v)^2 \\sin\\theta_i \\Delta\\theta \\Delta\\phi$ 的加权和来近似积分。\n\n在每个案例中，物质和引力波通量密度的角向依赖性通过在球面上平均值为1的正定形状函数来规定。具体来说，定义原始形状函数\n$$G_0(\\theta,\\phi;v) = \\left[1 + a_2(v) P_2(\\cos\\theta) + a_3(v) P_3(\\cos\\theta) + a_4(v) P_4(\\cos\\theta) + b(v)\\,\\sin(m\\phi)\\,\\sin^2\\theta\\right]^2,$$\n$$H_0(\\theta,\\phi;v) = \\left[1 + c_1(v)\\cos\\theta + c_2(v)\\,\\sin^2\\theta\\cos(m'\\phi)\\right]^2,$$\n其中 Legendre 多项式为 $P_2(x)=\\tfrac{1}{2}(3x^2-1)$、$P_3(x)=\\tfrac{1}{2}(5x^3-3x)$ 和 $P_4(x)=\\tfrac{1}{8}(35x^4-30x^2+3)$。使用上述数值求积方法将它们归一化，使其在球面上的平均值为1：\n$$g(\\theta,\\phi;v) = \\frac{G_0(\\theta,\\phi;v)}{\\langle G_0\\rangle(v)}, \\quad h(\\theta,\\phi;v) = \\frac{H_0(\\theta,\\phi;v)}{\\langle H_0\\rangle(v)},$$\n其中 $\\langle X\\rangle(v) = \\frac{1}{A(v)}\\int_{S_v} X(\\theta,\\phi;v)\\, dS$。\n\n对于每个案例，物质和引力波密度则为\n$$\\mu(\\theta,\\phi;v) = M_0(v)\\, h(\\theta,\\phi;v), \\qquad \\|\\sigma\\|^2(\\theta,\\phi;v) = S_0(v)\\, g(\\theta,\\phi;v),$$\n其中 $M_0(v)$ 和 $S_0(v)$ 是下文给定的函数。\n\n案例1（真空，强畸变）：\n- 叶状剖分参数网格：$v\\in[0,10]$，在 $N_v=33$ 个点上均匀采样。\n- 面积半径：$R(v) = 5.0 + 0.4 v + 0.7 \\exp\\!\\left(-\\tfrac{1}{2}(v-6)^2\\right) + 0.05 \\sin(2.2 v)$，因此 $A(v)=4\\pi R(v)^2$。\n- 表面引力：$\\kappa(v) = 0.2 + 0.05 \\cos(0.6 v)$。\n- 物质占比：$p(v) = 0$。\n- 系数：$a_2(v)=0.9\\,\\mathrm{sech}\\!\\left(0.5\\,(v-6)\\right)$, $a_3(v)=0.5\\,\\tanh\\!\\left(0.3\\,(v-4)\\right)$, $a_4(v)=0.4\\,\\sin(1.7 v)$, $b(v)=0.8\\,\\sin(0.4 v)$, $m=3$；对于 $H_0$，设置 $c_1(v)=0.3\\,\\sin(0.9 v)$, $c_2(v)=0.2\\,\\cos(1.1 v)$, $m'=2$（这些不影响真空情况下的积分，但必须按规定构造）。\n- 振幅：设 $A'(v)$ 表示从 $R(v)$ 解析得到的 $A(v)$ 关于 $v$ 的精确导数。定义总期望通量水平 $F_{\\mathrm{tot}}(v) = \\left(\\kappa(v)/8\\pi\\right) A'(v)$。然后设置 $M_0(v)=p(v)\\,F_{\\mathrm{tot}}(v)/A(v)=0$，以及 $S_0(v) = 16\\pi\\,[1-p(v)]\\,F_{\\mathrm{tot}}(v)/A(v) = 16\\pi\\,F_{\\mathrm{tot}}(v)/A(v)$。\n\n案例2（混合物质与引力波通量，边界敏感）：\n- 叶状剖分参数网格：$v\\in[0,3]$，在 $N_v=41$ 个点上均匀采样。\n- 面积半径：$R(v) = 3.0 + 0.7 v + 0.12 \\sin(3.3 v) + 0.1 \\exp\\!\\left(-(v-1.5)^2\\right)$，因此 $A(v)=4\\pi R(v)^2$。\n- 表面引力：$\\kappa(v) = 0.35 - 0.1\\, v/(1+v)$。\n- 物质占比：$p(v) = 0.5 + 0.3 \\sin(v)$。\n- 系数：$a_2(v)=0.6\\,\\cos(0.7 v)$, $a_3(v)=0.4\\,\\sin(1.1 v)$, $a_4(v)=0.5\\,\\tanh\\!\\left(0.5 (v-1.5)\\right)$, $b(v)=0.5\\,\\cos(0.8 v)$, $m=4$；对于 $H_0$，$c_1(v)=0.4\\,\\cos(1.3 v)$, $c_2(v)=0.35\\,\\sin(1.7 v)$, $m'=3$。\n- 振幅：使用与 $R(v)$ 对应的精确导数 $A'(v)$，定义 $F_{\\mathrm{tot}}(v) = \\left(\\kappa(v)/8\\pi\\right) A'(v)$，然后 $M_0(v)=p(v)\\,F_{\\mathrm{tot}}(v)/A(v)$，以及 $S_0(v)=16\\pi\\,[1-p(v)]\\,F_{\\mathrm{tot}}(v)/A(v)$。\n\n案例3（小表面引力，强驱动）：\n- 叶状剖分参数网格：$v\\in[0,5]$，在 $N_v=37$ 个点上均匀采样。\n- 面积半径：$R(v) = 10.0 + 1.5 v + 0.15 \\sin(4.5 v) + 0.3 \\exp\\!\\left(-0.3\\,(v-2.5)^2\\right)$，因此 $A(v)=4\\pi R(v)^2$。\n- 表面引力：$\\kappa(v) = 0.05 + 0.02 \\cos(1.8 v)$。\n- 物质占比：$p(v) = 0.2 + 0.2 \\sin(0.7 v)$。\n- 系数：$a_2(v)=0.7\\,\\mathrm{sech}\\!\\left(0.4\\,(v-2.5)\\right)$, $a_3(v)=0.5\\,\\cos(1.2 v)$, $a_4(v)=0.6\\,\\sin(1.9 v)$, $b(v)=0.7\\,\\sin(0.9 v)$, $m=5$；对于 $H_0$，$c_1(v)=0.25\\,\\sin(0.8 v)$, $c_2(v)=0.3\\,\\cos(1.4 v)$, $m'=4$。\n- 振幅：使用与 $R(v)$ 对应的精确导数 $A'(v)$，定义 $F_{\\mathrm{tot}}(v) = \\left(\\kappa(v)/8\\pi\\right) A'(v)$，然后 $M_0(v)=p(v)\\,F_{\\mathrm{tot}}(v)/A(v)$，以及 $S_0(v)=16\\pi\\,[1-p(v)]\\,F_{\\mathrm{tot}}(v)/A(v)$。\n\n实现要求：\n- 对每个案例，使用指定的有限差分方法，根据采样的 $A(v_i)$ 值计算 $Q_1(v_i) = \\left(\\kappa(v_i)/8\\pi\\right) \\left.dA/dv\\right|_{v_i}$。\n- 对每个案例，通过使用规定的求积方法对通量密度进行数值积分，来计算 $dE_{\\mathrm{H}}/dv(v)$ 定义中的两个积分，从而得出 $Q_2(v_i)$。\n- 对每个案例，计算单个标量值\n  $$\\mathrm{mismatch} = \\max_i \\left| Q_1(v_i) - Q_2(v_i) \\right|,$$\n  以几何单位制下的浮点数形式报告（输出中不含单位符号；在$G=c=1$单位制下，数值是纯数字）。\n- 您的程序应生成单行输出，其中包含三个案例的结果，格式为方括号内以逗号分隔的列表，例如 $[x_1,x_2,x_3]$，其中每个 $x_k$ 是案例 $k$ 的失配值。\n\n测试套件覆盖理由：\n- 案例1测试了具有强时变角向结构的真空、剪切主导的情况。\n- 案例2包含非零物质通量，并要求在 $v$ 网格的端点处正确处理边界有限差分。\n- 案例3探讨了在强驱动下表面引力很小的情况，以确保当 $A'(v)$ 很大而 $\\kappa(v)$ 很小时的数值稳定性。\n\n所有数值必须按规定以 $G=c=1$ 的几何单位制报告，角度以弧度为单位。输出必须是严格符合 $[x_1,x_2,x_3]$ 格式的单行文本。",
            "solution": "用户提供了一个位于数值相对论领域的计算问题，该问题涉及对未来外捕获视界（FOTH），也称为动力学视界，的第一力学定律的验证。该问题提法明确，具有科学依据，并包含了推导唯一、可验证解所需的所有信息。它代表了一项数值验证任务，通过比较两个量来检验一个物理定律，其中一个量通过数值微分计算，另一个通过数值积分计算。该问题的设置旨在使任何差异主要源于数值导数的截断误差。\n\n问题的核心是为三个指定场景中的每一个计算并比较两个变化率。设 $v$ 是一个参数，用于叶状剖分视界的一系列球形横截面。\n\n第一个量 $Q_1(v)$ 是基于视界面积膨胀的能量变化率的近似值。其定义为：\n$$Q_1(v) = \\frac{\\kappa(v)}{8\\pi} \\frac{dA}{dv}$$\n此处，$\\kappa(v)$ 是给定的表面引力，$A(v) = 4\\pi R(v)^2$ 是视界的横截面积，其中 $R(v)$ 是指定的面积半径。导数 $dA/dv$ 是从均匀网格 $v_i$ 上的离散样本集 $A(v_i)$ 数值计算得出的。根据问题规范，网格的内部点使用二阶中心差分方案，两个端点使用一阶单边差分。这可以使用 `numpy.gradient` 并设置 `edge_order=1` 来高效实现。\n\n第二个量 $Q_2(v)$ 代表能量积累率，定义为穿过视界的物质和引力波的总通量。其定义由曲面积分给出：\n$$Q_2(v) = \\frac{dE_{\\mathrm{H}}}{dv}(v) = \\int_{S_v} \\mu(\\theta,\\phi;v)\\, dS + \\frac{1}{16\\pi}\\int_{S_v} \\|\\sigma\\|^2(\\theta,\\phi;v)\\, dS$$\n其中 $\\mu$ 是物质能量密度，$\\|\\sigma\\|^2$ 是出射零法向量剪切的范数平方，代表引力波能量通量。积分是在球形横截面 $S_v$ 上进行的，面积元为 $dS = R(v)^2 \\sin\\theta\\, d\\theta\\, d\\phi$。\n\n问题为通量密度 $\\mu$ 和 $\\|\\sigma\\|^2$ 提供了详细的规定。它们由振幅函数 $M_0(v)$ 和 $S_0(v)$ 以及归一化的角向形状函数 $g(\\theta,\\phi;v)$ 和 $h(\\theta,\\phi;v)$ 构造而成：\n$$\\mu(\\theta,\\phi;v) = M_0(v)\\, h(\\theta,\\phi;v), \\qquad \\|\\sigma\\|^2(\\theta,\\phi;v) = S_0(v)\\, g(\\theta,\\phi;v)$$\n形状函数 $g$ 和 $h$ 是通过将原始形状 $G_0$ 和 $H_0$ 归一化，使其在球面上平均值为1而得到的。平均值定义为 $\\langle X\\rangle(v) = \\frac{1}{A(v)}\\int_{S_v} X dS$。归一化和 $Q_2(v)$ 最终计算所需的积分，都将使用张量积中点法则在指定的球面网格 $(\\theta_i, \\phi_j)$ 上进行数值计算。\n\n问题设计的一个关键方面是振幅 $M_0(v)$ 和 $S_0(v)$ 的定义方式。它们依赖于总通量 $F_{\\mathrm{tot}}(v) = (\\kappa(v)/8\\pi) A'(v)$，其中 $A'(v)$ 是面积函数 $A(v)$ 的**精确解析**导数。然后，振幅被设置为 $M_0(v) = p(v)F_{\\mathrm{tot}}(v)/A(v)$ 和 $S_0(v) = 16\\pi[1-p(v)]F_{\\mathrm{tot}}(v)/A(v)$，其中 $p(v)$ 是给定的物质占比。将这些代入 $Q_2(v)$ 的定义，并利用归一化形状函数在积分后等于面积 $A(v)$（即 $\\int_S g dS = \\int_S h dS = A(v)$）这一事实，我们发现：\n$$Q_2(v) = M_0(v)A(v) + \\frac{1}{16\\pi}S_0(v)A(v) = p(v)F_{\\mathrm{tot}}(v) + [1-p(v)]F_{\\mathrm{tot}}(v) = F_{\\mathrm{tot}}(v)$$\n因此，$Q_2(v)$ 在解析上与 $(\\kappa(v)/8\\pi)A'_{\\text{exact}}(v)$ 是相同的。\n\n最后的任务是计算两个数值计算量之间的最大绝对失配：\n$$\\mathrm{mismatch} = \\max_i | Q_1(v_i) - Q_2(v_i) |$$\n这种失配主要量化了与 $Q_2(v)$ 的值相比，$Q_1(v)$ 中 $dA/dv$ 的有限差分近似所引入的误差，而 $Q_2(v)$ 的构造在数值上非常接近精确的解析表达式。在 $Q_2$ 的计算中，任何微小的偏差都将归因于角向求积的浮点精度，鉴于角向网格很精细，预计该偏差远小于导数的截断误差。\n\n对每个案例，算法流程如下：\n1.  定义所有特定于案例的函数（$R(v)$、$R'(v)$、$\\kappa(v)$等）和参数。\n2.  生成均匀的时间网格 $v_i$。\n3.  计算每个网格点上的面积 $A(v_i)$。\n4.  使用 `numpy.gradient` 计算数值导数 $(dA/dv)_i$，然后计算数组 $Q_1(v_i)$。\n5.  设置角向求积网格 $(\\theta_i, \\phi_j)$ 及相关权重。\n6.  遍历每个时间步 $v_i$：\n    a.  在角向网格上计算角向形状函数 $G_0$ 和 $H_0$。\n    b.  数值计算它们的平均值 $\\langle G_0 \\rangle$ 和 $\\langle H_0 \\rangle$ 并进行归一化以得到 $g$ 和 $h$。\n    c.  计算解析导数 $A'(v_i) = 8\\pi R(v_i) R'(v_i)$。\n    d.  确定振幅 $M_0(v_i)$ 和 $S_0(v_i)$。\n    e.  在角向网格上构造通量密度 $\\mu$ 和 $\\|\\sigma\\|^2$。\n    f.  对通量进行数值积分以求得 $Q_2(v_i)$。\n7.  计算 $Q_1$ 和 $Q_2$ 数组之间的最大绝对差。\n\n对所有三个案例重复此过程，以获得最终的失配值列表。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum mismatch between two calculations of horizon energy flux\n    for three distinct test cases in numerical relativity.\n    \"\"\"\n\n    def P2(x):\n        return 0.5 * (3 * x**2 - 1)\n\n    def P3(x):\n        return 0.5 * (5 * x**3 - 3 * x)\n\n    def P4(x):\n        return 0.125 * (35 * x**4 - 30 * x**2 + 3)\n\n    def sech(x):\n        return 1.0 / np.cosh(x)\n\n    # Define the three cases with all their specific parameters and functions.\n    test_cases = [\n        # Case 1: Vacuum, strong distortions\n        {\n            \"v_range\": [0, 10], \"N_v\": 33,\n            \"R\": lambda v: 5.0 + 0.4 * v + 0.7 * np.exp(-0.5 * (v - 6)**2) + 0.05 * np.sin(2.2 * v),\n            \"R_prime\": lambda v: 0.4 - 0.7 * (v - 6) * np.exp(-0.5 * (v - 6)**2) + 0.05 * 2.2 * np.cos(2.2 * v),\n            \"kappa\": lambda v: 0.2 + 0.05 * np.cos(0.6 * v),\n            \"p\": lambda v: 0.0,\n            \"a2\": lambda v: 0.9 * sech(0.5 * (v - 6)),\n            \"a3\": lambda v: 0.5 * np.tanh(0.3 * (v - 4)),\n            \"a4\": lambda v: 0.4 * np.sin(1.7 * v),\n            \"b\": lambda v: 0.8 * np.sin(0.4 * v), \"m\": 3,\n            \"c1\": lambda v: 0.3 * np.sin(0.9 * v),\n            \"c2\": lambda v: 0.2 * np.cos(1.1 * v), \"m_prime\": 2,\n        },\n        # Case 2: Mixed flux, boundary-sensitive\n        {\n            \"v_range\": [0, 3], \"N_v\": 41,\n            \"R\": lambda v: 3.0 + 0.7 * v + 0.12 * np.sin(3.3 * v) + 0.1 * np.exp(-(v - 1.5)**2),\n            \"R_prime\": lambda v: 0.7 + 0.12 * 3.3 * np.cos(3.3 * v) - 0.2 * (v - 1.5) * np.exp(-(v - 1.5)**2),\n            \"kappa\": lambda v: 0.35 - 0.1 * v / (1 + v),\n            \"p\": lambda v: 0.5 + 0.3 * np.sin(v),\n            \"a2\": lambda v: 0.6 * np.cos(0.7 * v),\n            \"a3\": lambda v: 0.4 * np.sin(1.1 * v),\n            \"a4\": lambda v: 0.5 * np.tanh(0.5 * (v - 1.5)),\n            \"b\": lambda v: 0.5 * np.cos(0.8 * v), \"m\": 4,\n            \"c1\": lambda v: 0.4 * np.cos(1.3 * v),\n            \"c2\": lambda v: 0.35 * np.sin(1.7 * v), \"m_prime\": 3,\n        },\n        # Case 3: Small surface gravity, strong driving\n        {\n            \"v_range\": [0, 5], \"N_v\": 37,\n            \"R\": lambda v: 10.0 + 1.5 * v + 0.15 * np.sin(4.5 * v) + 0.3 * np.exp(-0.3 * (v - 2.5)**2),\n            \"R_prime\": lambda v: 1.5 + 0.15 * 4.5 * np.cos(4.5 * v) - 0.18 * (v - 2.5) * np.exp(-0.3 * (v - 2.5)**2),\n            \"kappa\": lambda v: 0.05 + 0.02 * np.cos(1.8 * v),\n            \"p\": lambda v: 0.2 + 0.2 * np.sin(0.7 * v),\n            \"a2\": lambda v: 0.7 * sech(0.4 * (v - 2.5)),\n            \"a3\": lambda v: 0.5 * np.cos(1.2 * v),\n            \"a4\": lambda v: 0.6 * np.sin(1.9 * v),\n            \"b\": lambda v: 0.7 * np.sin(0.9 * v), \"m\": 5,\n            \"c1\": lambda v: 0.25 * np.sin(0.8 * v),\n            \"c2\": lambda v: 0.3 * np.cos(1.4 * v), \"m_prime\": 4,\n        }\n    ]\n\n    def solve_case(params):\n        # 1. Setup grids\n        v_grid = np.linspace(params[\"v_range\"][0], params[\"v_range\"][1], params[\"N_v\"])\n        dv = v_grid[1] - v_grid[0]\n        \n        N_theta, N_phi = 64, 96\n        d_theta = np.pi / N_theta\n        d_phi = 2 * np.pi / N_phi\n        theta = (np.arange(N_theta) + 0.5) * d_theta\n        phi = (np.arange(N_phi) + 0.5) * d_phi\n        THETA, PHI = np.meshgrid(theta, phi, indexing='ij')\n\n        # 2. Compute Q1(v)\n        R_v = params[\"R\"](v_grid)\n        A_v = 4 * np.pi * R_v**2\n        kappa_v = params[\"kappa\"](v_grid)\n        \n        dA_dv_numerical = np.gradient(A_v, dv, edge_order=1)\n        Q1 = (kappa_v / (8 * np.pi)) * dA_dv_numerical\n\n        # 3. Compute Q2(v)\n        Q2 = np.zeros_like(v_grid)\n        \n        costheta = np.cos(THETA)\n        sintheta = np.sin(THETA)\n        P2_grid = P2(costheta)\n        P3_grid = P3(costheta)\n        P4_grid = P4(costheta)\n        d_area_element = sintheta * d_theta * d_phi\n\n        for i, v in enumerate(v_grid):\n            # Evaluate coefficients at current v\n            a2, a3, a4, b = params[\"a2\"](v), params[\"a3\"](v), params[\"a4\"](v), params[\"b\"](v)\n            c1, c2 = params[\"c1\"](v), params[\"c2\"](v)\n            m, m_prime = params[\"m\"], params[\"m_prime\"]\n\n            # Compute raw shape functions G0, H0\n            G0 = (1 + a2*P2_grid + a3*P3_grid + a4*P4_grid + b*np.sin(m*PHI)*sintheta**2)**2\n            H0 = (1 + c1*costheta + c2*(sintheta**2)*np.cos(m_prime*PHI))**2\n\n            # Compute normalization factors\n            avg_G0 = (1 / (4 * np.pi)) * np.sum(G0 * d_area_element)\n            avg_H0 = (1 / (4 * np.pi)) * np.sum(H0 * d_area_element)\n            \n            # Normalized shape functions\n            g = G0 / avg_G0\n            h = H0 / avg_H0\n\n            # Compute flux amplitudes M0, S0\n            R_i = R_v[i]\n            # A_i = A_v[i]\n            # using R_i simplifies the expression below and avoids re-accessing A_v array\n            A_i = 4 * np.pi * R_i**2\n            \n            Rp_i = params[\"R_prime\"](v)\n            A_prime_exact = 8 * np.pi * R_i * Rp_i\n            kappa_i = kappa_v[i]\n            p_i = params[\"p\"](v)\n\n            F_tot = (kappa_i / (8 * np.pi)) * A_prime_exact\n            M0 = p_i * F_tot / A_i\n            S0 = 16 * np.pi * (1 - p_i) * F_tot / A_i\n\n            # Construct flux densities on the grid\n            mu = M0 * h\n            sigma_sq = S0 * g\n            \n            # Compute flux integrals for Q2\n            integral_mu_dS = np.sum(mu * R_i**2 * d_area_element)\n            integral_sigma_sq_dS = np.sum(sigma_sq * R_i**2 * d_area_element)\n            \n            Q2[i] = integral_mu_dS + (1 / (16 * np.pi)) * integral_sigma_sq_dS\n            \n        # 4. Compute mismatch\n        mismatch = np.max(np.abs(Q1 - Q2))\n        return mismatch\n\n    results = [solve_case(case) for case in test_cases]\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}