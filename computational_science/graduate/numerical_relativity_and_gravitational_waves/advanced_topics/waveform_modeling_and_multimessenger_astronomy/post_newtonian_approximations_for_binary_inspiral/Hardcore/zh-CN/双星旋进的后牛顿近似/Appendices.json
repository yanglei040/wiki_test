{
    "hands_on_practices": [
        {
            "introduction": "后牛顿方法处理双星旋进的基础是绝热近似，即引力波辐射引起的轨道演化远慢于轨道运动本身。本练习将指导您完成一个基础计算，通过比较辐射反作用时标与轨道时标来验证这一原理。掌握这一推导过程将巩固您对后牛顿展开为何是描述漫长旋进阶段的有效且强大工具的理解。",
            "id": "3483842",
            "problem": "考虑一个由分质量 $m_{1}$ 和 $m_{2}$ 组成的致密双星，它在准圆形轨道上运行并发出引力波。设总质量为 $M = m_{1} + m_{2}$，折合质量为 $\\mu = \\frac{m_{1} m_{2}}{M}$，对称质量比为 $\\eta = \\frac{\\mu}{M}$。定义后牛顿（PN）无量纲参数 $x$ 为 $x = \\left(\\frac{G M \\omega}{c^{3}}\\right)^{2/3}$，其中 $G$ 是引力常数，$c$ 是光速，$\\omega$ 是轨道角频率。假设系统处于绝热旋进区，即 $x \\ll 1$。\n\n从以下经过充分检验的领头阶关系出发：\n- 圆形轨道的牛顿结合能 $E = -\\frac{G M \\mu}{2 r}$，\n- 圆周运动的开普勒定律 $\\omega^{2} = \\frac{G M}{r^{3}}$，\n- 领头阶四极引力波（GW）能量流 $\\mathcal{F} = \\frac{32}{5} \\frac{G^{4}}{c^{5}} \\frac{\\mu^{2} M^{3}}{r^{5}}$，\n\n推导领头阶引力波反作用时标 $t_{\\mathrm{rr}} \\sim \\frac{|E|}{\\mathcal{F}}$，并将其与轨道时标 $t_{\\mathrm{orb}} \\sim \\frac{1}{\\omega}$ 进行比较，计算无量纲比值 $\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}}$，且表达式中只包含 $x$ 和 $\\eta$。您的最终答案必须是单一的闭式解析表达式。不需要数值近似或四舍五入。该比值为无量纲，因此最终表达式中不应包含单位。",
            "solution": "用户希望找到一个处于准圆形轨道上的双星系统的辐射反作用时标与轨道时标之比 $\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}}$。最终表达式必须用后牛顿参数 $x$ 和对称质量比 $\\eta$ 来表示。\n\n首先，我们必须验证问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- 分质量: $m_{1}$，$m_{2}$\n- 总质量: $M = m_{1} + m_{2}$\n- 折合质量: $\\mu = \\frac{m_{1} m_{2}}{M}$\n- 对称质量比: $\\eta = \\frac{\\mu}{M}$\n- 后牛顿（PN）参数: $x = \\left(\\frac{G M \\omega}{c^{3}}\\right)^{2/3}$\n- 常数: 引力常数 $G$，光速 $c$\n- 轨道角频率: $\\omega$\n- 假设: 绝热旋进，$x \\ll 1$\n- 牛顿结合能: $E = -\\frac{G M \\mu}{2 r}$\n- 开普勒定律: $\\omega^{2} = \\frac{G M}{r^{3}}$\n- 领头阶引力波能量流（光度）: $\\mathcal{F} = \\frac{32}{5} \\frac{G^{4}}{c^{5}} \\frac{\\mu^{2} M^{3}}{r^{5}}$\n- 辐射反作用时标定义: $t_{\\mathrm{rr}} \\sim \\frac{|E|}{\\mathcal{F}}$\n- 轨道时标定义: $t_{\\mathrm{orb}} \\sim \\frac{1}{\\omega}$\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据。所提供的结合能、开普勒定律和引力波能量流方程是在后牛顿形式体系中用于描述致密双星旋进阶段的标准领头阶表达式。质量参数（$M$, $\\mu$, $\\eta$）和后牛顿展开参数 $x$ 的定义在引力波相关文献中也是标准的。问题是适定的，提供了推导所要求比值的所有必要信息。语言客观而精确。该问题不违反任何无效标准。这是理论天体物理学和广义相对论中的一个标准形式的计算。\n\n### 步骤3：结论与行动\n问题有效。将推导解答。\n\n任务是计算无量纲比值 $\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}}$。我们从给定的定义开始：\n$$\nt_{\\mathrm{rr}} \\sim \\frac{|E|}{\\mathcal{F}}\n$$\n$$\nt_{\\mathrm{orb}} \\sim \\frac{1}{\\omega}\n$$\n因此，该比值为：\n$$\n\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}} \\sim \\frac{|E| / \\mathcal{F}}{1 / \\omega} = \\frac{|E| \\omega}{\\mathcal{F}}\n$$\n接下来，我们代入给定的结合能 $E$ 和能量流 $\\mathcal{F}$ 的表达式。结合能的大小为：\n$$\n|E| = \\left| -\\frac{G M \\mu}{2 r} \\right| = \\frac{G M \\mu}{2 r}\n$$\n能量流为：\n$$\n\\mathcal{F} = \\frac{32}{5} \\frac{G^{4}}{c^{5}} \\frac{\\mu^{2} M^{3}}{r^{5}}\n$$\n将这些代入比值的表达式中，得到：\n$$\n\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}} \\sim \\frac{\\left( \\frac{G M \\mu}{2 r} \\right) \\omega}{\\frac{32}{5} \\frac{G^{4}}{c^{5}} \\frac{\\mu^{2} M^{3}}{r^{5}}}\n$$\n我们可以简化这个代数表达式：\n$$\n\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}} \\sim \\frac{G M \\mu \\omega}{2 r} \\times \\frac{5 c^{5} r^{5}}{32 G^{4} \\mu^{2} M^{3}} = \\frac{5}{64} \\frac{c^{5} r^{4} \\omega}{G^{3} \\mu M^{2}}\n$$\n该表达式目前依赖于轨道间距 $r$。我们必须消去 $r$，并用给定的参数 $x$ 和 $\\eta$ 来表示结果。我们使用开普勒第三定律 $\\omega^{2} = \\frac{G M}{r^{3}}$，将 $r$ 表示为 $\\omega$ 的函数：\n$$\nr^{3} = \\frac{G M}{\\omega^{2}} \\implies r = \\left( \\frac{G M}{\\omega^{2}} \\right)^{1/3}\n$$\n现在，将此代入 $r^{4}$ 项中：\n$$\nr^{4} = \\left( \\left( \\frac{G M}{\\omega^{2}} \\right)^{1/3} \\right)^{4} = \\left( \\frac{G M}{\\omega^{2}} \\right)^{4/3} = \\frac{(G M)^{4/3}}{\\omega^{8/3}}\n$$\n将此代回时标比值的表达式中：\n$$\n\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}} \\sim \\frac{5}{64} \\frac{c^{5} \\omega}{G^{3} \\mu M^{2}} \\left( \\frac{(G M)^{4/3}}{\\omega^{8/3}} \\right) = \\frac{5}{64} \\frac{c^{5} G^{4/3} M^{4/3}}{G^{3} \\mu M^{2} \\omega^{5/3}}\n$$\n合并 $G$ 和 $M$ 的幂次：\n$$\n\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}} \\sim \\frac{5}{64} \\frac{c^{5}}{\\mu G^{3-4/3} M^{2-4/3} \\omega^{5/3}} = \\frac{5}{64} \\frac{c^{5}}{\\mu G^{5/3} M^{2/3} \\omega^{5/3}}\n$$\n现在，我们引入对称质量比 $\\eta = \\frac{\\mu}{M}$，这意味着 $\\mu = \\eta M$。代入 $\\mu$：\n$$\n\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}} \\sim \\frac{5}{64} \\frac{c^{5}}{(\\eta M) G^{5/3} M^{2/3} \\omega^{5/3}} = \\frac{5}{64 \\eta} \\frac{c^{5}}{G^{5/3} M^{5/3} \\omega^{5/3}}\n$$\n我们可以将分母中的项组合起来：\n$$\n\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}} \\sim \\frac{5}{64 \\eta} \\frac{c^{5}}{(G M \\omega)^{5/3}}\n$$\n最后一步是引入无量纲后牛顿参数 $x = \\left(\\frac{G M \\omega}{c^{3}}\\right)^{2/3}$。我们需要将 $(G M \\omega)^{5/3}$ 用 $x$ 来表示。根据 $x$ 的定义：\n$$\nx^{3/2} = \\left( \\left(\\frac{G M \\omega}{c^{3}}\\right)^{2/3} \\right)^{3/2} = \\frac{G M \\omega}{c^{3}}\n$$\n这得到 $G M \\omega = x^{3/2} c^{3}$。现在我们可以求出所需的项 $(G M \\omega)^{5/3}$：\n$$\n(G M \\omega)^{5/3} = (x^{3/2} c^{3})^{5/3} = (x^{3/2})^{5/3} (c^{3})^{5/3} = x^{(3/2)(5/3)} c^{3(5/3)} = x^{5/2} c^{5}\n$$\n将此结果代入我们的时标比值表达式中：\n$$\n\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}} \\sim \\frac{5}{64 \\eta} \\frac{c^{5}}{x^{5/2} c^{5}}\n$$\n因子 $c^{5}$ 消去，得到最终表达式：\n$$\n\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}} \\sim \\frac{5}{64 \\eta x^{5/2}}\n$$\n这个结果展示了时标的分离。由于绝热旋进的特征是 $x \\ll 1$，量 $x^{5/2}$ 非常小，这使得比值 $\\frac{t_{\\mathrm{rr}}}{t_{\\mathrm{orb}}}$ 非常大。这证实了辐射反作用时标（轨道衰减的时标）远长于轨道时标，而这正是绝热近似的基本假设。",
            "answer": "$$\n\\boxed{\\frac{5}{64 \\eta x^{5/2}}}\n$$"
        },
        {
            "introduction": "引力辐射同时带走能量和角动量，导致双星轨道收缩并趋于圆形。本练习从静态分析推进到动态演化，要求您首先推导半长轴 $a$ 和偏心率 $e$ 的经典轨道平均演化方程，然后通过数值积分来追踪它们随时间的变化。这个练习展示了轨道圆化的基本过程，并让您在模拟天体物理双星的长期旋进方面获得实践经验。",
            "id": "3483834",
            "problem": "考虑一个由质量为 $m_1$ 和 $m_2$ 的成员组成的束缚、无自旋的双星系统，该系统在一个半长轴为 $a$、离心率为 $e$ 的开普勒椭圆轨道上运动。在后牛顿 (PN) 展开的主导阶下进行计算（即，在小参数 $v/c$ 下展开，并仅保留由引力辐射引起的主导耗散项），并使用轨道平均的辐射反作用来演化轨道根数。从基本定律和核心定义出发，包括牛顿轨道动力学和引力波四极矩公式，推导半长轴 $a(t)$ 和离心率 $e(t)$ 的轨道平均演化方程，并用系统参数表示。推导过程必须从以下几点出发：\n- 由 $a$ 和 $e$ 表征的椭圆轨道的牛顿轨道能量 $E$ 和角动量 $L$；\n- 通过主导阶质量四极矩近似计算出的引力辐射能量流和角动量流；\n- 对一个开普勒周期的轨道平均；\n- 自洽地消除对轨道相位的依赖性，以获得 $a(t)$ 和 $e(t)$ 的演化方程。\n\n然后，您必须为得到的轨道平均系统实现一个数值积分器，该积分器接受 $(m_1,m_2,a_0,e_0)$ 作为输入，并向前进行时间积分，直到半长轴达到最内稳定圆轨道近似值 $a_{\\min} = 6 G (m_1+m_2)/c^2$ 或达到最大积分时间 $t_{\\max}$。您必须记录：\n- 初始变化率 $\\left.\\frac{da}{dt}\\right|_{t=0}$（单位为 $\\mathrm{m/s}$）和 $\\left.\\frac{de}{dt}\\right|_{t=0}$（单位为 $\\mathrm{s^{-1}}$）；\n- 在演化过程中是否存在任何使 $\\frac{de}{dt} > 0$ 的区间（在数值上解释为在连续采样时间点之间 $e(t)$ 的增加量超出某个微小的数值容差），从而确定是否存在离心率增长的阶段，或者离心率是否单调衰减。\n\n所有量都必须使用国际单位制 (SI)：质量单位为千克，距离单位为米，时间单位为秒。角度不是必需的。最终所要求的变化率 $\\frac{da}{dt}$ 必须严格以 $\\mathrm{m/s}$ 表示，$\\frac{de}{dt}$ 必须以 $\\mathrm{s^{-1}}$ 表示。布尔值应表示为字面逻辑值。\n\n实现程序以运行一个固定测试集，包含以下参数集（每个案例以 $(m_1,m_2,a_0,e_0)$ 形式给出）：\n- 案例 1: $m_1 = 30\\,M_{\\odot}$, $m_2 = 30\\,M_{\\odot}$, $a_0 = 10^9\\,\\mathrm{m}$, $e_0 = 0.3$,\n- 案例 2: $m_1 = 10\\,M_{\\odot}$, $m_2 = 8\\,M_{\\odot}$, $a_0 = 5\\times 10^8\\,\\mathrm{m}$, $e_0 = 0.3$,\n- 案例 3: $m_1 = 10\\,M_{\\odot}$, $m_2 = 10\\,M_{\\odot}$, $a_0 = 3\\times 10^8\\,\\mathrm{m}$, $e_0 = 0.9$,\n- 案例 4: $m_1 = 30\\,M_{\\odot}$, $m_2 = 30\\,M_{\\odot}$, $a_0 = 10^8\\,\\mathrm{m}$, $e_0 = 0.01$,\n其中 $M_{\\odot}$ 表示一个太阳质量，在计算前必须使用 $M_{\\odot} = 1.98847\\times 10^{30}\\,\\mathrm{kg}$ 将其转换为千克。\n\n对于每个案例，输出一个包含三个条目的列表：浮点数 $\\left.\\frac{de}{dt}\\right|_{t=0}$（单位 $\\mathrm{s^{-1}}$），浮点数 $\\left.\\frac{da}{dt}\\right|_{t=0}$（单位 $\\mathrm{m/s}$），以及一个指示在积分过程中 $e$ 是否曾增加的布尔值。您的程序应生成单行输出，其中包含所有案例的结果，形式为一个由这三个条目的列表组成的、用逗号分隔的列表，并用方括号括起来。例如，输出格式必须为\n$[\\,[x_{11},x_{12},b_1],[x_{21},x_{22},b_2],[x_{31},x_{32},b_3],[x_{41},x_{42},b_4]\\,]$,\n其中 $x_{ij}$ 是浮点数，$b_j$ 是布尔值。\n\n您的推导过程不得引用超出上述基本基础的任何捷径公式，并且数值模型必须在主导阶后牛顿辐射反作用的框架内符合科学实际且自洽。使用 $G = 6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$ 和 $c = 299792458\\,\\mathrm{m/s}$。设置 $t_{\\max} = 10^{10}\\,\\mathrm{s}$ 并在积分过程中确定停止条件 $a(t) \\le a_{\\min}$。",
            "solution": "该问题要求推导在主导阶引力辐射影响下，一个无自旋双星系统的半长轴 $a$ 和离心率 $e$ 的轨道平均演化方程。随后，必须对这些方程进行数值积分，以确定初始衰减率，并查明是否存在任何离心率增长的阶段。\n\n### 1. 问题验证\n根据要求准则对问题陈述进行严格评估。\n\n**步骤 1：提取给定条件**\n- **系统：** 束缚、无自旋的双星系统，成员质量为 $m_1$ 和 $m_2$。\n- **轨道：** 开普勒椭圆轨道，半长轴为 $a$，离心率为 $e$。\n- **近似：** 主导阶后牛顿 (PN) 展开，保留主导耗散项（四极辐射反作用）。\n- **方法：** 轨道根数的轨道平均演化。\n- **推导基础：**\n    1. 牛顿轨道能量 $E$ 和角动量 $L$。\n    2. 通过主导阶质量四极矩近似计算的引力波能量流和角动量流。\n    3. 对一个开普勒周期的轨道平均。\n    4. 消除对轨道相位的依赖性。\n- **数值任务：**\n    - 从初始条件 $(a_0, e_0)$ 开始对推导出的 $a(t)$ 和 $e(t)$ 方程进行积分。\n    - 输入：$(m_1, m_2, a_0, e_0)$。\n- **终止条件：**\n    1. $a(t) \\le a_{\\min}$，其中 $a_{\\min} = 6 G (m_1+m_2)/c^2$。\n    2. $t \\ge t_{\\max}$，其中 $t_{\\max} = 10^{10}\\,\\mathrm{s}$。\n- **每个案例的必需输出：**\n    1. 初始变化率 $\\left.\\frac{da}{dt}\\right|_{t=0}$（单位 $\\mathrm{m/s}$）。\n    2. 初始变化率 $\\left.\\frac{de}{dt}\\right|_{t=0}$（单位 $\\mathrm{s^{-1}}$）。\n    3. 一个指示在演化过程中 $\\frac{de}{dt} > 0$ 是否发生的布尔值。\n- **常量：**\n    - $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$。\n    - $c = 299792458\\,\\mathrm{m/s}$。\n    - $M_{\\odot} = 1.98847 \\times 10^{30}\\,\\mathrm{kg}$。\n- **测试案例：**\n    1. $(m_1, m_2, a_0, e_0) = (30\\,M_{\\odot}, 30\\,M_{\\odot}, 10^9\\,\\mathrm{m}, 0.3)$\n    2. $(m_1, m_2, a_0, e_0) = (10\\,M_{\\odot}, 8\\,M_{\\odot}, 5\\times 10^8\\,\\mathrm{m}, 0.3)$\n    3. $(m_1, m_2, a_0, e_0) = (10\\,M_{\\odot}, 10\\,M_{\\odot}, 3\\times 10^8\\,\\mathrm{m}, 0.9)$\n    4. $(m_1, m_2, a_0, e_0) = (30\\,M_{\\odot}, 30\\,M_{\\odot}, 10^8\\,\\mathrm{m}, 0.01)$\n\n**步骤 2：使用提取的给定条件进行验证**\n- **科学依据：** 该问题是广义相对论中的一个经典练习，基于已完善的双星系统引力辐射理论，该理论最早由 Peters 和 Mathews (1963) 及 Peters (1964) 定量阐述。该问题在科学上是合理的。\n- **适定性：** 问题定义清晰。它要求进行标准推导，然后对具有指定初始条件和终止准则的一阶常微分方程组进行数值积分。存在唯一解。\n- **客观性：** 语言正式、精确，且无主观内容。\n- **完整性与一致性：** 提供了所有必要的常量、参数和边界条件。没有矛盾之处。\n- **现实性与可行性：** 双星系统的物理参数对于恒星级致密天体是天体物理学上现实的。积分任务在计算上是可行的。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n### 2. 演化方程的推导\n\n轨道根数的演化由引力波发射导致的能量和角动量损失所决定。我们将轨道参数的长期变化与轨道平均的能量流和角动量流联系起来。\n\n**2.1. 牛顿轨道力学**\n对于一个质量分别为 $m_1$ 和 $m_2$ 的双体系统，我们定义总质量 $M = m_1 + m_2$ 和约化质量 $\\mu = \\frac{m_1 m_2}{M}$。在质心系中，该系统表现为一个质量为 $\\mu$ 的物体围绕一个中心质量 $M$ 运动。\n对于半长轴为 $a$、离心率为 $e$ 的开普勒椭圆轨道，其轨道能量 $E$ 和轨道角动量大小 $L$ 由以下公式给出：\n$$E = -\\frac{G m_1 m_2}{2a} = -\\frac{G M \\mu}{2a}$$\n$$L = \\mu \\sqrt{G M a (1-e^2)}$$\n这些量仅是 $a$ 和 $e$ 的函数。\n\n**2.2. 引力波发射流**\n引力波的发射会从双星系统中带走能量和角动量。在主导（四极）阶，能量和角动量的轨道平均变化率由以下公式给出 (Peters & Mathews, 1963)：\n$$\\left\\langle \\frac{dE}{dt} \\right\\rangle = -\\frac{32}{5} \\frac{G^4 m_1^2 m_2^2 (m_1+m_2)}{c^5 a^5 (1-e^2)^{7/2}} \\left(1 + \\frac{73}{24}e^2 + \\frac{37}{96}e^4\\right)$$\n$$\\left\\langle \\frac{dL}{dt} \\right\\rangle = -\\frac{32}{5} \\frac{G^{7/2} m_1^2 m_2^2 \\sqrt{m_1+m_2}}{c^5 a^{7/2} (1-e^2)^2} \\left(1 + \\frac{7}{8}e^2\\right)$$\n此处，$\\left\\langle \\cdot \\right\\rangle$ 表示对一个轨道周期的平均。轨道的长期演化可以通过将轨道能量和角动量的变化率与这些辐射损失相等来找到：$\\frac{dE_{\\text{orb}}}{dt} = \\left\\langle \\frac{dE}{dt} \\right\\rangle$ 和 $\\frac{dL_{\\text{orb}}}{dt} = \\left\\langle \\frac{dL}{dt} \\right\\rangle$。\n\n**2.3. 连接动力学与辐射**\n通过对 $E(a, e)$ 和 $L(a, e)$ 应用链式法则，可以找到 $a$ 和 $e$ 的变化率：\n$$\\frac{dE}{dt} = \\frac{\\partial E}{\\partial a} \\frac{da}{dt} + \\frac{\\partial E}{\\partial e} \\frac{de}{dt}$$\n$$\\frac{dL}{dt} = \\frac{\\partial L}{\\partial a} \\frac{da}{dt} + \\frac{\\partial L}{\\partial e} \\frac{de}{dt}$$\n我们计算必要的偏导数：\n$$\\frac{\\partial E}{\\partial a} = \\frac{G m_1 m_2}{2a^2}$$\n$$\\frac{\\partial E}{\\partial e} = 0$$\n$$\\frac{\\partial L}{\\partial a} = \\mu \\sqrt{G M(1-e^2)} \\left( \\frac{1}{2\\sqrt{a}} \\right) = \\frac{L}{2a}$$\n$$\\frac{\\partial L}{\\partial e} = \\mu \\sqrt{G M a} \\left( \\frac{-2e}{2\\sqrt{1-e^2}} \\right) = -\\frac{L e}{1-e^2}$$\n\n将这些代入链式法则方程，得到一个关于 $\\frac{da}{dt}$ 和 $\\frac{de}{dt}$ 的线性系统：\n$$ \\left\\langle \\frac{dE}{dt} \\right\\rangle = \\left(\\frac{G m_1 m_2}{2a^2}\\right) \\frac{da}{dt} $$\n$$ \\left\\langle \\frac{dL}{dt} \\right\\rangle = \\left(\\frac{L}{2a}\\right) \\frac{da}{dt} - \\left(\\frac{L e}{1-e^2}\\right) \\frac{de}{dt} $$\n\n**2.4. 求解演化方程**\n从第一个方程，我们可以直接解出 $\\frac{da}{dt}$：\n$$\\frac{da}{dt} = \\frac{2a^2}{G m_1 m_2} \\left\\langle \\frac{dE}{dt} \\right\\rangle$$\n代入 $\\left\\langle \\frac{dE}{dt} \\right\\rangle$ 的表达式：\n$$\\frac{da}{dt} = \\frac{2a^2}{G m_1 m_2} \\left(-\\frac{32}{5} \\frac{G^4 m_1^2 m_2^2 M}{c^5 a^5 (1-e^2)^{7/2}} \\left(1 + \\frac{73}{24}e^2 + \\frac{37}{96}e^4\\right)\\right)$$\n$$\\boxed{\\frac{da}{dt} = -\\frac{64}{5} \\frac{G^3 m_1 m_2 (m_1+m_2)}{c^5 a^3 (1-e^2)^{7/2}} \\left(1 + \\frac{73}{24}e^2 + \\frac{37}{96}e^4\\right)}$$\n\n接下来，我们从第二个方程求解 $\\frac{de}{dt}$：\n$$\\left(\\frac{L e}{1-e^2}\\right) \\frac{de}{dt} = \\left(\\frac{L}{2a}\\right) \\frac{da}{dt} - \\left\\langle \\frac{dL}{dt} \\right\\rangle$$\n$$\\frac{de}{dt} = \\frac{1-e^2}{Le} \\left[ \\left(\\frac{L}{2a}\\right) \\frac{da}{dt} - \\left\\langle \\frac{dL}{dt} \\right\\rangle \\right] = \\frac{1-e^2}{2ae} \\frac{da}{dt} - \\frac{1-e^2}{Le} \\left\\langle \\frac{dL}{dt} \\right\\rangle$$\n代入已推导出的 $\\frac{da}{dt}$ 的表达式以及已知的 $\\left\\langle \\frac{dL}{dt} \\right\\rangle$ 和 $L$ 的表达式：\n$$\\frac{de}{dt} = \\frac{1-e^2}{2ae} \\left(-\\frac{64}{5} \\frac{G^3 m_1 m_2 M}{c^5 a^3} \\frac{f(e)}{(1-e^2)^{7/2}}\\right) - \\frac{1-e^2}{Le} \\left(-\\frac{32}{5} \\frac{G^{7/2} m_1^2 m_2^2 \\sqrt{M}}{c^5 a^{7/2}} \\frac{g(e)}{(1-e^2)^2}\\right)$$\n其中 $f(e) = (1 + \\frac{73}{24}e^2 + \\frac{37}{96}e^4)$ 且 $g(e) = (1 + \\frac{7}{8}e^2)$。这可以简化为：\n$$\\frac{de}{dt} = -\\frac{32}{5} \\frac{G^3 m_1 m_2 M}{c^5 a^4 e} \\frac{f(e)}{(1-e^2)^{5/2}} + \\frac{1-e^2}{Le} \\frac{32}{5} \\frac{G^{7/2} \\mu^2 M^{3/2}}{c^5 a^{7/2}} \\frac{g(e)}{(1-e^2)^2}$$\n使用 $L = \\mu \\sqrt{GMa(1-e^2)}$ 并进行进一步的代数处理，可以得到：\n$$\\frac{de}{dt} = -\\frac{e}{a^4} \\frac{G^3 m_1 m_2 M}{c^5} \\left[ \\frac{64}{5} \\frac{f(e)}{(1-e^2)^{5/2}} - \\frac{32}{5} \\frac{a^{1/2}(1-e^2)^{1/2}}{\\mu \\sqrt{GM(1-e^2)}} \\frac{G^{1/2} \\mu^2 M^{1/2}}{a^{1/2}} \\frac{g(e)}{(1-e^2)} \\right]$$\n方括号中的项会显著简化。一个稳健的代数路径是将 $\\langle\\dot{L}\\rangle$ 与 $\\langle\\dot{E}\\rangle$ 关联起来，从而得到由 Peters (1964) 推导出的典范结果：\n$$\\boxed{\\frac{de}{dt} = -\\frac{304}{15} \\frac{G^3 m_1 m_2 (m_1+m_2)}{c^5 a^4} \\frac{e}{(1-e^2)^{5/2}} \\left(1 + \\frac{121}{304}e^2\\right)}$$\n\n### 3. 离心率演化分析\n推导出的 $\\frac{de}{dt}$ 方程形式如下：\n$$\\frac{de}{dt} = -(\\text{正常量}) \\times \\frac{e}{(1-e^2)^{5/2}} \\times \\left(1 + \\frac{121}{304}e^2\\right)$$\n对于束缚轨道，$0 \\le e  1$。此表达式中的所有项均为非负。\n- 常数前置因子 $\\frac{304}{15} \\frac{G^3 m_1 m_2 (m_1+m_2)}{c^5 a^4}$ 是严格为正的。\n- $\\frac{e}{(1-e^2)^{5/2}}$ 项是非负的。\n- $(1 + \\frac{121}{304}e^2)$ 项是严格为正的。\n\n因此，对于所有有效的 $e$，$\\frac{de}{dt} \\le 0$。等号仅在 $e=0$ 时成立。这意味着在主导阶引力辐射反作用下，离心率是时间的单调递减函数。轨道总是趋向圆化。任何 $e(t_{i+1}) > e(t_i)$ 的数值结果都必须归因于数值积分误差，而不是此模型内的物理效应。问题中对此进行检查的要求，可作为对该理论理解和实现方案数值稳定性的检验。\n\n### 4. 数值实现策略\n问题的数值部分涉及求解关于 $a(t)$ 和 $e(t)$ 的耦合常微分方程组。\n1.  **定义常微分方程(ODE)系统：** 将创建一个 Python 函数，根据状态向量 $[a, e]$ 和系统参数 $m_1, m_2$ 来计算向量 $[\\frac{da}{dt}, \\frac{de}{dt}]$。\n2.  **积分器：** 将使用 `scipy.integrate.solve_ivp` 函数。这是一个稳健的自适应步长积分器，适用于此类问题。\n3.  **终止条件：**\n    - 积分将在时间区间 $[0, t_{\\max}]$ 上进行。\n    - 将向 `solve_ivp` 传递一个事件函数，以检测 $a(t)$ 何时穿过阈值 $a_{\\min}$。当 $a(t) - a_{\\min} = 0$ 时，积分将终止。\n4.  **数据记录：** 对于每个测试案例，将直接根据推导出的方程计算初始变化率 $\\left.\\frac{da}{dt}\\right|_{t=0}$ 和 $\\left.\\frac{de}{dt}\\right|_{t=0}$。将扫描数值解得到的 $e(t)$ 历史记录，以检查是否存在任何超出微小数值容差的增加，正如问题陈述所要求。",
            "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the binary inspiral problem for a set of test cases.\n    It derives and implements the orbit-averaged evolution equations for\n    the semi-major axis 'a' and eccentricity 'e' under leading-order\n    gravitational radiation.\n    \"\"\"\n    \n    # Constants in SI units\n    G = 6.67430e-11  # Gravitational constant in m^3 kg^-1 s^-2\n    c = 299792458.0    # Speed of light in m/s\n    M_sun = 1.98847e30 # Solar mass in kg\n    t_max = 1e10       # Maximum integration time in seconds\n\n    # Test cases: (m1_solar, m2_solar, a0_m, e0)\n    test_cases = [\n        (30.0, 30.0, 1e9, 0.3),\n        (10.0, 8.0, 5e8, 0.3),\n        (10.0, 10.0, 3e8, 0.9),\n        (30.0, 30.0, 1e8, 0.01),\n    ]\n\n    def odes(t, y, params):\n        \"\"\"\n        Defines the system of ordinary differential equations for a(t) and e(t).\n        y = [a, e]\n        params = (m1, m2, M, K) where K is a pre-computed constant.\n        \"\"\"\n        a, e = y\n        m1, m2, M, K = params\n\n        if a = 0 or e  0 or e >= 1:\n            # Return zero rates to halt integration for unphysical states\n            return [0.0, 0.0]\n\n        # Common factors\n        a_inv = 1.0 / a\n        e2 = e * e\n        one_minus_e2 = 1.0 - e2\n        \n        # da/dt calculation\n        f_e = (1.0 + (73.0 / 24.0) * e2 + (37.0 / 96.0) * e2 * e2)\n        da_dt = - (64.0 / 5.0) * K * (a_inv**3) * (one_minus_e2**-3.5) * f_e\n\n        # de/dt calculation\n        g_e = (1.0 + (121.0 / 304.0) * e2)\n        de_dt = - (304.0 / 15.0) * K * (a_inv**4) * e * (one_minus_e2**-2.5) * g_e\n        \n        return [da_dt, de_dt]\n\n    results = []\n    for m1_solar, m2_solar, a0, e0 in test_cases:\n        # Convert masses to kg\n        m1 = m1_solar * M_sun\n        m2 = m2_solar * M_sun\n        M = m1 + m2\n        \n        # Pre-compute the constant factor K = G^3 * m1 * m2 * M / c^5\n        K = (G**3 * m1 * m2 * M) / (c**5)\n        \n        # Calculate a_min (ISCO proxy) for this system\n        a_min = 6.0 * G * M / (c**2)\n\n        # Calculate initial rates\n        y0 = [a0, e0]\n        params = (m1, m2, M, K)\n        initial_rates = odes(0, y0, params)\n        da_dt_0 = initial_rates[0]\n        de_dt_0 = initial_rates[1]\n\n        # Set up the event for stopping at a_min\n        def event_amin(t, y, params):\n            return y[0] - a_min\n        event_amin.terminal = True\n        event_amin.direction = -1\n\n        # Perform the numerical integration\n        sol = integrate.solve_ivp(\n            fun=odes,\n            t_span=[0, t_max],\n            y0=y0,\n            args=(params,),\n            events=event_amin,\n            method='RK45',\n            rtol=1e-8,\n            atol=1e-10\n        )\n        \n        # Check for eccentricity growth\n        # This is expected to be False based on the derived equations.\n        # This check is performed as requested by the problem statement.\n        e_history = sol.y[1]\n        e_grew = False\n        if len(e_history) > 1:\n            # Check if any e[i+1] is numerically greater than e[i] beyond a tolerance\n            tolerance = 1e-15\n            if np.any(np.diff(e_history) > tolerance):\n                e_grew = True\n\n        # Store results in the specified order: de/dt, da/dt, e_grew\n        results.append([de_dt_0, da_dt_0, e_grew])\n\n    # Format the final output string exactly as required\n    output_str = \"[\"\n    for i, res in enumerate(results):\n        de_dt_val, da_dt_val, e_grew_val = res\n        # Format boolean as a lowercase literal\n        bool_str = 'true' if e_grew_val else 'false'\n        output_str += f\"[{de_dt_val},{da_dt_val},{bool_str}]\"\n        if i  len(results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    \n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "有效单体（EOB）形式通过重求和技术改进了标准的后牛顿展开，是现代波形建模的基石，其自由参数通常通过与数值相对论（NR）模拟进行比对来校准。本练习模拟了这一研究前沿，要求您实现一个简化的EOB模型，并量化一个高阶校准参数如何影响累积的引力波相位。这项实践让您深入了解理论模型如何被精炼，以达到引力波探测和参数估计所需的高精度。",
            "id": "3483845",
            "problem": "实现一个独立的数值实验，以评估在有效单体（EOB）映射中添加一个校准的伪五阶后牛顿（pseudo-5PN）项，如何影响等质量、自旋对齐双星在晚期旋进阶段与数值相对论（NR）的一致性。使用几何单位制，其中 $G = c = 1$，并将总质量归一化为 $M = 1$，以使所有量均为无量纲；角度必须以弧度为单位报告。\n\n评估应仅限于对称质量比为 $\\eta = 1/4$ 的等质量双星。假设自旋与轨道角动量对齐，但在保守动力学中未被显式建模；相反，假设残余的自旋效应被校准的伪5PN项有效地吸收了。考虑从有效径向势 $A(u)$ 构建的EOB保守哈密顿量，其中 $u = 1/r$，$r$ 是EOB的径向坐标。对于本实验，使用截断势\n$$\nA(u) = 1 - 2 u + 2 \\eta u^3 + a_5 u^5,\n$$\n其中 $a_5$ 是一个无量纲的校准参数。从有效哈密顿量到真实哈密顿量的映射遵循标准的EOB构造：\n- 有效哈密顿量为\n$$\nH_{\\text{eff}}(r, p_\\phi) = \\sqrt{ A(r) \\left(1 + \\frac{p_\\phi^2}{r^2} \\right) }.\n$$\n- 真实（EOB）哈密顿量为\n$$\nH(r, p_\\phi) = \\sqrt{ 1 + 2 \\eta \\left( H_{\\text{eff}}(r, p_\\phi) - 1 \\right) }.\n$$\n对于圆形轨道，角动量 $p_\\phi(r)$ 由有效势的平稳性条件确定，\n$$\n\\frac{\\partial H_{\\text{eff}}}{\\partial r}\\bigg|_{p_\\phi} = 0 \\quad \\Rightarrow \\quad\np_\\phi^2(r) = \\frac{ r^3 A'(r) }{ 2 A(r) - r A'(r) },\n$$\n其中 $A'(r) = dA/dr$ 且 $A(r) \\equiv A(u = 1/r)$。轨道频率由哈密顿方程得到，\n$$\n\\Omega(r) = \\frac{\\partial H}{\\partial p_\\phi}\n= \\frac{ \\eta }{ H(r, p_\\phi) } \\cdot \\frac{ A(r) \\, p_\\phi(r) }{ r^2 \\, H_{\\text{eff}}(r, p_\\phi) }.\n$$\n定义单位总质量的结合能为\n$$\nE(r) = H(r, p_\\phi(r)) - 1.\n$$\n\n假设绝热准圆形演化由能量平衡方程控制。取引力波能量流的主导（四极，牛顿）阶，\n$$\n\\mathcal{F}(x) = \\frac{32}{5} \\, \\eta^2 \\, x^5, \\quad \\text{with} \\quad x = \\Omega^{2/3}.\n$$\n能量平衡给出 $dE/dt = -\\mathcal{F}(x)$。使用链式法则配合 $E(r)$，在晚期旋进的径向区间 $r \\in [6, 8]$ 上进行演化。相位演化满足 $d\\phi/dt = \\Omega(r)$，径向演化满足 $dr/dt = (dE/dt)/(dE/dr)$。因此，\n$$\n\\frac{d\\phi}{dr} = \\frac{d\\phi/dt}{dr/dt} = \\frac{\\Omega(r)}{dr/dt} = - \\Omega(r) \\, \\frac{ dE/dr }{ \\mathcal{F}(x) }.\n$$\n在晚期旋进阶段累积的引力波相位是 $d\\phi/dr$ 从 $r=8$ 到 $r=6$ 的积分。以弧度表示此累积相位。\n\n通过选择一个固定的校准值 $a^{\\text{true}}_5 = 30$ 来定义一个参考的“类数值相对论”（NR-like）基准。对于任何测试值 $a_5$，生成在 $r \\in [8, 6]$ 上的累积相位 $\\phi(a_5)$，并与基准值 $\\phi(a^{\\text{true}}_5)$ 进行比较。将差异量化为区间内累积相位的绝对差，\n$$\n\\Delta \\phi(a_5) = \\left| \\phi(a_5) - \\phi(a^{\\text{true}}_5) \\right| \\, .\n$$\n所有角度必须以弧度报告，并四舍五入到六位小数。\n\n数值要求：\n- 在 $r$ 上使用一个均匀网格，包含恰好 $N = 5001$ 个点，范围为 $[6, 8]$（包含端点），即 $r_0 = 6$，$r_{N-1} = 8$，且间距恒定。\n- 通过在均匀网格上对 $d\\phi/dr$ 应用梯形法则来计算 $r \\in [8, 6]$ 上的 $\\phi$ 积分，注意积分方向以确保累积相位为正。\n- 通过使用链式法则和 $u = 1/r$ 从 $A(u)$ 精确计算 $A'(r)$。在相同的 $r$ 网格上，使用二阶精确的中心差分数值计算 $dE/dr$；在边界处使用二阶精确的单边有限差分。\n- 在整个计算中使用 $\\eta = 1/4$ 和 $M = 1$。\n\n测试套件：\n- 使用以下五个 $a_5$ 的测试值：$[0.0, 15.0, 30.0, 60.0, -10.0]$。\n- 对于列表中的每个 $a_5$，计算如上定义的 $\\Delta \\phi(a_5)$，以弧度为单位，并四舍五入到六位小数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含五个结果的列表，格式为用方括号括起来的逗号分隔列表，例如，“[r1,r2,r3,r4,r5]”。每个 $r_k$ 必须是浮点数，小数点后恰好有六位数字，代表对应测试值 $a_5$ 的 $\\Delta \\phi(a_5)$（以弧度为单位）。",
            "solution": "该问题要求实现一个数值实验，以评估一个伪五阶后牛顿（pseudo-5PN）校准参数 $a_5$ 对等质量、无自旋双星系统在晚期旋进阶段累积的引力波相位的影响。该分析在有效单体（EOB）形式体系内使用一个简化模型进行。我们将首先建立理论基础，然后概述从参考模型计算相位偏差的数值步骤。所有计算均在几何单位制中进行，其中 $G = c = 1$ 且总质量归一化为 $M=1$。\n\n该双星系统的保守动力学由一个EOB哈密顿量描述。该哈密顿量的一个关键组成部分是有效径向势 $A(u)$，其中 $u = 1/r$ 是EOB径向分离 $r$ 的倒数。对于此问题，使用了一个截断势，它包括高达3PN的标准后牛顿项（对于无自旋部分）和一个校准的伪5PN项：\n$$\nA(u) = 1 - 2 u + 2 \\eta u^3 + a_5 u^5\n$$\n问题指定了一个等质量双星，其对称质量比为 $\\eta = m_1 m_2 / (m_1+m_2)^2 = (M/2 \\cdot M/2) / M^2 = 1/4$。因此，势变为：\n$$\nA(u) = 1 - 2 u + \\frac{1}{2} u^3 + a_5 u^5\n$$\n\nEOB框架将二体问题映射为一个质量为 $\\mu = \\eta M = 1/4$ 的有效粒子在变形的外部度规中的运动。该粒子的有效哈密顿量为：\n$$\nH_{\\text{eff}}(r, p_\\phi) = \\sqrt{ A(r) \\left(1 + \\frac{p_\\phi^2}{r^2} \\right) }\n$$\n其中 $p_\\phi$ 是轨道角动量。然后，双星系统的真实哈密顿量 $H$ 通过EOB映射与有效哈密顿量相关联：\n$$\nH(r, p_\\phi) = \\sqrt{ 1 + 2 \\eta \\left( H_{\\text{eff}}(r, p_\\phi) - 1 \\right) } = \\sqrt{ 1 + \\frac{1}{2} \\left( H_{\\text{eff}}(r, p_\\phi) - 1 \\right) }\n$$\n\n我们考虑准圆形轨道，它们是有效径向势的稳定点。条件 $\\partial H_{\\text{eff}} / \\partial r = 0$ 给出了圆形轨道的角动量与半径之间的关系：\n$$\np_\\phi^2(r) = \\frac{ r^3 A'(r) }{ 2 A(r) - r A'(r) }\n$$\n其中 $A'(r) = dA/dr$。该导数使用链式法则进行解析计算：$A'(r) = (dA/du)(du/dr)$。给定 $u=1/r$，我们有 $du/dr = -1/r^2 = -u^2$。$A(u)$ 对 $u$ 的导数是 $dA/du = -2 + (3/2)u^2 + 5a_5 u^4$。因此，\n$$\nA'(r) = \\left( -2 + \\frac{3}{2}u^2 + 5a_5 u^4 \\right) (-u^2) = 2u^2 - \\frac{3}{2}u^4 - 5a_5 u^6\n$$\n通过代入这些表达式，可以计算出任何半径 $r$ 的 $p_\\phi(r)$。对于顺行轨道，我们取正根 $p_\\phi(r) = \\sqrt{p_\\phi^2(r)}$。\n\n确定了 $p_\\phi(r)$ 后，就可以找到半径为 $r$ 的圆形轨道的所有其他动力学量。轨道频率 $\\Omega(r)$ 由哈密顿方程给出：\n$$\n\\Omega(r) = \\frac{\\partial H}{\\partial p_\\phi} = \\frac{ \\eta }{ H(r) } \\cdot \\frac{\\partial H_{\\text{eff}}}{\\partial p_\\phi} = \\frac{ \\eta }{ H(r) } \\frac{1}{H_{\\text{eff}}(r)} \\frac{ A(r) p_\\phi(r) }{ r^2 }\n$$\n单位总质量的结合能 $E(r)$ 是哈密顿量的值减去系统在无限分离时的静止质量能：\n$$\nE(r) = H(r, p_\\phi(r)) - 1\n$$\n\n旋进是由引力波的发射驱动的，引力波会带走能量。这种能量损失由能量平衡方程 $dE/dt = -\\mathcal{F}$ 建模，其中 $\\mathcal{F}$ 是引力波能量流。我们使用能量流的主导阶（牛顿，或四极）公式：\n$$\n\\mathcal{F}(x) = \\frac{32}{5} \\eta^2 x^5, \\quad \\text{where} \\quad x = \\Omega^{2/3}\n$$\n轨道相位 $\\phi$ 和半径 $r$ 的演化是耦合的。相位的变化率是 $d\\phi/dt = \\Omega(r)$，半径的变化率是 $dr/dt = (dE/dt)/(dE/dr) = -\\mathcal{F}/(dE/dr)$。我们感兴趣的量是作为半径函数的累积相位，它由两者的比率给出：\n$$\n\\frac{d\\phi}{dr} = \\frac{d\\phi/dt}{dr/dt} = \\frac{\\Omega(r)}{-\\mathcal{F}(r)/(dE/dr)} = - \\Omega(r) \\frac{dE/dr}{\\mathcal{F}(r)}\n$$\n从 $r=8$ 到 $r=6$ 的晚期旋进阶段的总累积相位是积分：\n$$\n\\phi(a_5) = \\int_{r=8}^{r=6} \\frac{d\\phi}{dr} dr = -\\int_{r=6}^{r=8} \\left( - \\Omega(r) \\frac{dE/dr}{\\mathcal{F}(r)} \\right) dr = \\int_{r=6}^{r=8} \\Omega(r) \\frac{dE/dr}{\\mathcal{F}(r)} dr\n$$\n\n数值实现过程如下：\n1.  建立一个从 $r=6$ 到 $r=8$ 的均匀径向网格，包含 $N=5001$ 个点。\n2.  对于给定的 $a_5$ 值，所有依赖于半径的量（$A(r)$, $A'(r)$, $p_\\phi(r)$, $H_{\\text{eff}}(r)$, $H(r)$, $E(r)$, $\\Omega(r)$, $\\mathcal{F}(r)$）都在此网格上作为数组进行计算。\n3.  结合能的导数 $dE/dr$ 进行数值计算。根据要求，我们对内部网格点使用二阶精确的中心差分，在边界使用二阶精确的单边（前向/后向）差分。这可以方便地通过 `numpy.gradient` 函数并设置 `edge_order=2` 选项来处理。\n4.  在网格上将被积函数 $d\\phi/dr$ 构建为一个数组。\n5.  通过对 $d\\phi/dr$ 从 $r=8$ 到 $r=6$ 进行数值积分来计算总相位 $\\phi(a_5)$。这等同于取从 $r=6$ 到 $r=8$ 积分的负值。我们使用梯形法则进行积分，如 `numpy.trapz` 中所实现的。\n6.  使用校准值 $a^{\\text{true}}_5=30$ 计算一个参考（“类数值相对论”）相位 $\\phi(a^{\\text{true}}_5)$。\n7.  对于每个 $a_5$ 测试值，计算相位 $\\phi(a_5)$，并将差异量化为绝对差 $\\Delta\\phi(a_5) = |\\phi(a_5) - \\phi(a^{\\text{true}}_5)|$。\n8.  收集并格式化指定 $a_5$ 值测试套件的结果。\n\n此过程提供了一个定量度量，说明伪5PN参数 $a_5$ 的变化如何在这个简化的EOB模型中影响引力波波形的相位，这模仿了相对于更精确的数值相对论模拟的校准过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a numerical experiment to assess the effect of a pseudo-5PN term\n    in an EOB model on gravitational wave phase for equal-mass, spin-aligned binaries.\n    \"\"\"\n    # System and numerical parameters\n    ETA = 1.0 / 4.0\n    N_POINTS = 5001\n    R_MIN = 6.0\n    R_MAX = 8.0\n    A5_TRUE = 30.0\n    TEST_CASES_A5 = [0.0, 15.0, 30.0, 60.0, -10.0]\n\n    def calculate_phase(a5_val: float) -> float:\n        \"\"\"\n        Calculates the accumulated gravitational wave phase over a radial interval\n        for a given calibration parameter a5.\n\n        Args:\n            a5_val: The value of the pseudo-5PN calibration parameter.\n\n        Returns:\n            The accumulated phase in radians.\n        \"\"\"\n        # 1. Setup grid\n        r = np.linspace(R_MIN, R_MAX, N_POINTS)\n        u = 1.0 / r\n\n        # 2. Calculate quantities on the grid\n        # EOB potential A(u)\n        A = 1.0 - 2.0 * u + 2.0 * ETA * u**3 + a5_val * u**5\n\n        # Analytical derivative A'(r) = dA/dr\n        A_prime_r = 2.0 * u**2 - 6.0 * ETA * u**4 - 5.0 * a5_val * u**6\n\n        # Angular momentum squared for circular orbits, p_phi^2(r)\n        p_phi_sq_num = r**3 * A_prime_r\n        p_phi_sq_den = 2.0 * A - r * A_prime_r\n        \n        # Check for potential division by zero or negative arguments for sqrt\n        if np.any(p_phi_sq_den = 0):\n            raise ValueError(f\"Invalid denominator for p_phi^2 with a5={a5_val}\")\n        \n        p_phi_sq = p_phi_sq_num / p_phi_sq_den\n        if np.any(p_phi_sq  0):\n            raise ValueError(f\"Invalid p_phi^2 (negative) with a5={a5_val}\")\n        p_phi = np.sqrt(p_phi_sq)\n\n        # Effective Hamiltonian H_eff\n        H_eff_sq_arg = A * (1.0 + p_phi_sq / r**2)\n        if np.any(H_eff_sq_arg  0):\n            raise ValueError(f\"Invalid argument for sqrt in H_eff with a5={a5_val}\")\n        H_eff = np.sqrt(H_eff_sq_arg)\n\n        # Real Hamiltonian H\n        H_sq_arg = 1.0 + 2.0 * ETA * (H_eff - 1.0)\n        if np.any(H_sq_arg  0):\n            raise ValueError(f\"Invalid argument for sqrt in H with a5={a5_val}\")\n        H = np.sqrt(H_sq_arg)\n\n        # Binding energy E\n        E = H - 1.0\n\n        # Orbital frequency Omega\n        Omega = (ETA / H) * (A * p_phi) / (r**2 * H_eff)\n        \n        # Gravitational wave energy flux F\n        x = Omega**(2.0 / 3.0)\n        Flux = (32.0 / 5.0) * ETA**2 * x**5\n\n        # 3. Numerical derivative dE/dr\n        h = r[1] - r[0]  # Grid spacing\n        dE_dr = np.gradient(E, h, edge_order=2)\n\n        # 4. Assemble the integrand d(phi)/dr\n        integrand = -Omega * dE_dr / Flux\n        \n        # 5. Numerical integration for accumulated phase\n        # Integral from r=8 to r=6 is -integral from r=6 to r=8.\n        # np.trapz integrates over the array from its start to end.\n        accumulated_phase = -np.trapz(integrand, x=r)\n        \n        return accumulated_phase\n\n    # Calculate the reference (\"true\") phase\n    phi_true = calculate_phase(A5_TRUE)\n\n    results = []\n    # Loop through test cases, calculate phase difference, and store\n    for a5 in TEST_CASES_A5:\n        phi_test = calculate_phase(a5)\n        delta_phi = np.abs(phi_test - phi_true)\n        results.append(delta_phi)\n\n    # Format the final output string as required\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}