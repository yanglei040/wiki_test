{
    "hands_on_practices": [
        {
            "introduction": "数值相对论波形目录功能强大，但其生成过程的计算成本极高。为了使其具有实用性，我们利用了广义相对论的一个基本对称性：标度不变性。本练习旨在探讨单个无量纲波形如何能够代表一整个系列的物理系统，这些系统仅在总质量上有所不同。通过推导啁啾质量、总质量和对称质量比之间的关系，您将对波形目录如何实现其广泛适用性有一个核心的理解。",
            "id": "3481818",
            "problem": "考虑一个用于构建数值相对论 (NR) 波形目录条目的准圆形双黑洞系统。设组分质量为 $m_1$ 和 $m_2$，总质量 $M$ 和对称质量比 $\\eta$ 定义为 $M = m_1 + m_2$ 和 $\\eta = \\frac{m_1 m_2}{M^2}$。在引力波数据分析中广泛使用的啁啾质量定义为 $\\mathcal{M} = \\frac{(m_1 m_2)^{3/5}}{(m_1 + m_2)^{1/5}}$。仅使用这些定义以及在几何单位制（其中 $G = c = 1$）中真空广义相对论 (GR) 的无标度特性，推导 $\\mathcal{M}$ 关于 $\\eta$ 和 $M$ 的显式表达式。然后，解释为什么当波形用无量纲时间 $\\hat{t} = t/M$ 表示时，对于任意正常数 $\\alpha$ 进行重标度 $M \\to \\alpha M$ 会使无量纲 NR 波形 $h$ 在时间坐标的重标度和相位原点的平移下保持不变。对于最终答案，仅提供 $\\mathcal{M}$ 关于 $\\eta$ 和 $M$ 的显式解析表达式。",
            "solution": "该问题要求完成两项主要任务：首先，推导啁啾质量 $\\mathcal{M}$ 关于总质量 $M$ 和对称质量比 $\\eta$ 的表达式；其次，基于真空广义相对论的无标度性质，解释双黑洞引力波形的标度特性。\n\n首先，我们来推导 $\\mathcal{M}$、$M$ 和 $\\eta$ 之间的关系。给定的定义如下：\n总质量：\n$$M = m_1 + m_2$$\n对称质量比：\n$$\\eta = \\frac{m_1 m_2}{M^2}$$\n啁啾质量：\n$$\\mathcal{M} = \\frac{(m_1 m_2)^{3/5}}{(m_1 + m_2)^{1/5}}$$\n\n我们可以通过将总质量 $M$ 的定义代入啁啾质量 $\\mathcal{M}$ 表达式的分母来开始推导：\n$$\\mathcal{M} = \\frac{(m_1 m_2)^{3/5}}{M^{1/5}}$$\n接下来，我们重新整理对称质量比 $\\eta$ 的定义，以用 $\\eta$ 和 $M$ 表示组分质量的乘积 $m_1 m_2$：\n$$m_1 m_2 = \\eta M^2$$\n现在，我们将这个关于乘积 $m_1 m_2$ 的表达式代入我们关于 $\\mathcal{M}$ 的方程的分子中：\n$$\\mathcal{M} = \\frac{(\\eta M^2)^{3/5}}{M^{1/5}}$$\n利用指数的性质，我们可以简化这个表达式。分子中的项变为 $(\\eta M^2)^{3/5} = \\eta^{3/5} (M^2)^{3/5} = \\eta^{3/5} M^{6/5}$。将其代回可得：\n$$\\mathcal{M} = \\frac{\\eta^{3/5} M^{6/5}}{M^{1/5}}$$\n最后，我们合并包含 $M$ 的项，方法是将分母中的指数从分子中的指数中减去：\n$$\\mathcal{M} = \\eta^{3/5} M^{(6/5 - 1/5)} = \\eta^{3/5} M^{5/5} = \\eta^{3/5} M$$\n这就给出了啁啾质量 $\\mathcal{M}$ 关于对称质量比 $\\eta$ 和总质量 $M$ 的显式表达式。\n\n其次，我们解释数值相对论 (NR) 波形的标度性质。该问题设置在真空广义相对论 (GR) 和几何单位制（其中 $G=c=1$）的框架内。其控制方程是真空爱因斯坦场方程 (EFE)：\n$$R_{\\mu\\nu} = 0$$\n其中 $R_{\\mu\\nu}$ 是里奇曲率张量，它取决于时空度规 $g_{\\mu\\nu}$ 及其导数。真空 EFE 的一个关键特性是它们是无标度的。这意味着，如果度规 $g_{\\mu\\nu}(x^\\alpha)$ 是一个描述具有特征质量（因而有特征长度）标度 $M$ 的系统的解，那么对于任意正常数 $\\alpha$，度规 $\\tilde{g}_{\\mu\\nu}(x^\\alpha) = g_{\\mu\\nu}(x^\\alpha / \\alpha)$ 也是 EFE 的一个解。这个新解 $\\tilde{g}_{\\mu\\nu}$ 描述了一个物理上与原系统相同，但其所有特征长度和时间标度都被因子 $\\alpha$ 拉伸了的系统。因此，它对应于一个总质量为 $\\alpha M$ 的系统。\n\n引力波波形 $h$ 代表了远离源的时空度规的微扰。对于一个位于光度距离 $r$ 处的源，物理应变 $h_{\\text{phys}}$ 的振幅与总质量 $M$ 成正比，与距离 $r$ 成反比。波形的时间演化（例如，轨道频率及其变化率）由系统的特征时间尺度决定，该尺度与总质量 $M$ 成正比。\n因此，对于一个由总质量 $M$ 和像对称质量比 $\\eta$ 这样的内禀参数表征的双黑洞系统，其物理波形必须具有以下结构形式：\n$$h_{\\text{phys}}(t, r; M, \\eta) = \\frac{M}{r} \\mathcal{F}\\left(\\frac{t}{M}, \\eta\\right)$$\n在这里，$\\mathcal{F}$ 是一个无量纲函数，它捕捉了旋进、并合和铃振的复杂动力学过程。它的形式仅取决于质量比 $\\eta$（如果包含自旋，也取决于自旋）和无量纲时间 $\\hat{t} = t/M$。\n\n现在，考虑在保持 $\\eta$ 不变的情况下，对总质量进行重标度 $M \\to M' = \\alpha M$ 的影响。新的物理波形 $h'_{\\text{phys}}$ 将由下式给出：\n$$h'_{\\text{phys}}(t', r; M', \\eta) = \\frac{M'}{r} \\mathcal{F}\\left(\\frac{t'}{M'}, \\eta\\right) = \\frac{\\alpha M}{r} \\mathcal{F}\\left(\\frac{t'}{\\alpha M}, \\eta\\right)$$\n这表明新的波形只是原始波形的一个放大且时间拉伸的版本。\n\n数值相对论目录的设计正是为了利用这一性质。它们通过分解掉对 $M$ 和 $r$ 的显式依赖，提供了一个“无量纲 NR 波形”，我们可以将其表示为 $h_{\\text{NR}}$。这通常定义为：\n$$h_{\\text{NR}} = \\frac{r}{M} h_{\\text{phys}}$$\n将此定义应用于我们的 $h_{\\text{phys}}$ 表达式可得：\n$$h_{\\text{NR}}(t; M, \\eta) = \\frac{r}{M} \\left( \\frac{M}{r} \\mathcal{F}\\left(\\frac{t}{M}, \\eta\\right) \\right) = \\mathcal{F}\\left(\\frac{t}{M}, \\eta\\right) = \\mathcal{F}(\\hat{t}, \\eta)$$\n最终的表达式表明，当无量纲 NR 波形表示为无量纲时间 $\\hat{t} = t/M$ 的函数时，它是一个普适函数 $\\mathcal{F}$，仅依赖于双星的内禀参数（如 $\\eta$），而完全独立于整体质量标度 $M$。这就是为什么重标度 $M \\to \\alpha M$ 会使这种无量纲表示保持不变。问题陈述中的短语“在时间坐标的重标度下”指的是这样一个事实：对于质量为 $M$ 的系统，其物理时间 $t$ 对应于质量为 $\\alpha M$ 的系统达到相同演化状态所需的物理时间 $t'=\\alpha t$。一旦两者都映射到各自的无量纲时间 $\\hat{t}=t/M$ 和 $\\hat{t}'=t'/(\\alpha M)$，波形就是相同的。“平移相位原点”的自由度是与双星的初始轨道相位相关的额外自由度，该相位是任意的，在比较任何两个波形时都必须加以考虑，这与质量标度无关。",
            "answer": "$$\\boxed{\\eta^{3/5} M}$$"
        },
        {
            "introduction": "原始的数值相对论模拟并不直接输出引力波应变 $h(t)$，而是输出曲率分量，例如纽曼-彭罗斯标量 $\\Psi_4$。应变与 $\\Psi_4$ 通过两次时间积分相关联（$\\Psi_4 = \\ddot{h}$），但数值积分是出了名的不稳定且容易产生漂移。这个编码练习将提供处理信号的实践经验，通过稳健的信号处理流程，从原始模拟数据中可靠地恢复物理应变，这是为目录准备波形的关键步骤。您将处理现实世界中的问题，如数值噪声和积分伪影。",
            "id": "3481826",
            "problem": "给定一个复数时间序列，代表来自数值相对论 (NR) 波形的 Newman–Penrose 标量 $\\Psi_4(t)$，其中复应变 $h(t) = h_+(t) - i h_\\times(t)$。连接这些量的基本关系是 $\\Psi_4(t) = \\ddot{h}(t)$，其中上方的点表示对时间的微分。在一个时域处理流程中，从 $\\Psi_4(t)$ 恢复 $h(t)$ 需要两次数值积分和对积分常数的原则性选择，以抑制長期漂移。您的任务是实现并测试一个稳健的时域方法，该方法需要：\n- 对 $\\Psi_4(t)$ 应用边缘加窗，以减少后续处理中的频谱泄漏。\n- 使用梯形法则执行两次时域积分，以获得初步应变 $h_0(t)$。\n- 选择积分常数，通过在最小二乘意义上从 $h_0(t)$ 中最优地移除线性趋势，来最小化长期漂移。\n- 对去趋势后的 $h_0(t)$ 应用零相位高通滤波器，以抑制残留的低频污染，而不扭曲感兴趣的物理频带。\n\n起始点与约束条件：\n- 复应变定义为 $h(t) = h_+(t) - i h_\\times(t)$，且 $\\Psi_4(t) = \\ddot{h}(t)$。输出的应变必须是无量纲的。\n- 时间 $t$ 的单位是秒，频率 $f$ 的单位是赫兹，角相位 $\\phi(t)$ 的单位是弧度。所有角度都必须以弧度处理。\n- 数值积分必须在时域中使用累积梯形法则进行。\n- 边缘窗口必须是一个平滑的锥形窗（例如 Tukey 窗），由一个分数锥度参数 $\\alpha \\in [0,1]$ 表征，该参数控制两端的余弦锥化部分。\n- 高通滤波器必须是 Butterworth 设计，具有指定的阶数和截止频率 $f_c$ (单位赫兹)，并应用零相位滤波。\n- 必须选择积分常数以最小化二次积分信号的线性趋势的 $L^2$ 范数，方法是从 $h_0(t)$ 中移除最佳拟合直线 $a t + b$，并分别对实部和虚部执行此操作。\n\n用于测试的合成数据生成：\n- 对于每个测试案例，构建一个物理上合理的复应变 $h_{\\text{true}}(t)$，然后通过两次解析时间求导从 $h_{\\text{true}}(t)$ 计算出 $\\Psi_4(t)$。用低频伪影（一个恒定偏移、一个线性趋势和一个低频正弦波）污染 $\\Psi_4(t)$，以模拟 NR 目录中典型的提取误差和数值误差。然后应用您的方法从被污染的 $\\Psi_4(t)$ 中恢复 $h(t)$。\n\n$h_{\\text{true}}(t)$ 的模型族：\n1. 线性频率啁啾：$A(t) = A_0\\,(1 + \\beta t)$ 和 $f(t) = f_0 + \\alpha t$，相位为 $\\phi(t) = 2\\pi \\left(f_0 t + \\tfrac{1}{2}\\alpha t^2\\right)$。定义 $h_+(t) = A(t)\\cos\\phi(t)$ 和 $h_\\times(t) = A(t)\\sin\\phi(t)$，使得 $h(t) = A(t)e^{-i \\phi(t)}$。\n2. 阻尼正弦波（类似铃振）：$A(t) = A_0 e^{-t/\\tau}$ 和 $\\phi(t) = 2\\pi f t$，极化约定同上。\n\n$\\Psi_4(t)$ 的解析计算：\n- 对于 $h(t) = A(t)e^{-i\\phi(t)}$，其二阶导数为\n$$\n\\ddot{h}(t) = \\left[A''(t) - 2 i A'(t)\\,\\phi'(t) - i A(t)\\,\\phi''(t) - A(t)\\,(\\phi'(t))^2\\right] e^{-i\\phi(t)},\n$$\n其中撇号表示时间导数。使用此表达式从 $h_{\\text{true}}(t)$ 生成未受污染的 $\\Psi_4(t)$。\n\n$\\Psi_4(t)$ 的污染模型：\n- 将一个恒定偏移 $c_0$、一个线性趋势 $c_1 t$ 和一个低频正弦波 $s_A \\sin(2\\pi f_{\\text{low}} t)$ 添加到复数 $\\Psi_4(t)$ 中，以模拟真实的低频污染。\n\n质量度量：\n- 对于每个测试案例，分别为 plus 和 cross 极化计算恢复的 $h(t)$ 的相对均方根 (RMS) 误差，并报告两者的平均值：\n$$\n\\varepsilon_+(t) = \\frac{\\sqrt{\\tfrac{1}{N}\\sum_{k=1}^N \\left(h_{+,k}^{\\text{rec}} - h_{+,k}^{\\text{true}}\\right)^2}}{\\sqrt{\\tfrac{1}{N}\\sum_{k=1}^N \\left(h_{+,k}^{\\text{true}}\\right)^2}}, \\quad\n\\varepsilon_\\times(t) = \\frac{\\sqrt{\\tfrac{1}{N}\\sum_{k=1}^N \\left(h_{\\times,k}^{\\text{rec}} - h_{\\times,k}^{\\text{true}}\\right)^2}}{\\sqrt{\\tfrac{1}{N}\\sum_{k=1}^N \\left(h_{\\times,k}^{\\text{true}}\\right)^2}},\n$$\n并返回 $\\varepsilon = \\tfrac{1}{2}\\left(\\varepsilon_+ + \\varepsilon_\\times\\right)$ 作为每个测试案例的单个浮点数。\n\n测试套件：\n- 实现以下参数集。所有量均使用所述单位，振幅是无量纲的。\n1. 啁啾案例：时长 $T = 4.0$，采样率 $f_s = 2048$， $f_0 = 30$, $\\alpha = 40$, $A_0 = 1\\times 10^{-22}$, $\\beta = 0.2$，污染 $(c_0 = 5\\times 10^{-24}, c_1 = 1\\times 10^{-24}, s_A = 1\\times 10^{-23}, f_{\\text{low}} = 2)$，窗口参数 $\\alpha_{\\text{win}} = 0.1$，高通截止频率 $f_c = 10$，滤波器阶数 $n = 4$。\n2. 阻尼正弦波：时长 $T = 2.0$，采样率 $f_s = 4096$， $f = 150$, $\\tau = 0.5$, $A_0 = 1\\times 10^{-22}$，污染 $(c_0 = 1\\times 10^{-24}, c_1 = -2\\times 10^{-24}, s_A = 5\\times 10^{-25}, f_{\\text{low}} = 1)$，窗口参数 $\\alpha_{\\text{win}} = 0.05$，高通截止频率 $f_c = 10$，滤波器阶数 $n = 4$。\n3. 低频边界：时长 $T = 3.0$，采样率 $f_s = 1024$， $f_0 = 5$, $\\alpha = 0$, $A_0 = 5\\times 10^{-22}$, $\\beta = 0.0$，污染 $(c_0 = 5\\times 10^{-24}, c_1 = 2\\times 10^{-24}, s_A = 2\\times 10^{-23}, f_{\\text{low}} = 0.5)$，窗口参数 $\\alpha_{\\text{win}} = 0.1$，高通截止频率 $f_c = 2$，滤波器阶数 $n = 4$。\n4. 短时段：时长 $T = 0.5$，采样率 $f_s = 1024$， $f_0 = 50$, $\\alpha = 0$, $A_0 = 2\\times 10^{-22}$, $\\beta = 0.0$，污染 $(c_0 = 1\\times 10^{-24}, c_1 = 1\\times 10^{-24}, s_A = 1\\times 10^{-23}, f_{\\text{low}} = 1)$，窗口参数 $\\alpha_{\\text{win}} = 0.2$，高通截止频率 $f_c = 5$，滤波器阶数 $n = 4$。\n\n程序要求：\n- 对于每个测试案例，根据指定的模型构建 $h_{\\text{true}}(t)$，解析计算未受污染的 $\\Psi_4(t)$，添加污染，并应用上述稳健的恢复流程以获得 $h^{\\text{rec}}(t)$。\n- 为每个测试案例计算定义的平均相对 RMS 误差 $\\varepsilon$。\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$），每个值都以浮点数形式打印。\n\n所有量均使用所述单位作答：时间单位为秒，频率单位为赫兹，应变为无量纲，角度单位为弧度。将最终数值输出表示为浮点数。",
            "solution": "所述问题具有科学依据、提法明确且客观。它提出了一个引力波数据分析领域的标准（尽管不简单）信号处理任务，具体涉及从数值相对论模拟中获得的 Newman–Penrose 标量 $\\Psi_4(t)$ 恢复复应变 $h(t)$。所有参数、模型和程序都规定得足够清晰和精确，可以得到唯一且可验证的解。\n\n问题的核心是微分方程 $\\ddot{h}(t) = \\Psi_4(t)$ 的数值积分，其中上方的点表示对时间 $t$ 的微分。对含噪数据进行朴素的二次积分在数值上是不稳定的，会导致大的长期漂移。问题指定了一个稳健的处理流程来缓解这些问题，我们将予以实现。该过程涉及生成合成测试数据、应用恢复流程并评估结果的准确性。\n\n**1. 合成数据生成**\n\n为了测试恢复算法，我们首先生成一个真实基准复应变 $h_{\\text{true}}(t)$，并由此生成相应的 $\\Psi_4(t)$。\n\n**1.1. 真实波形模型 ($h_{\\text{true}}(t)$)**\n复应变定义为 $h(t) = h_+(t) - i h_\\times(t)$，并由振幅 $A(t)$ 和相位 $\\phi(t)$ 建模为 $h(t) = A(t)e^{-i\\phi(t)}$。指定了两种模型：\n- 线性频率啁啾，代表双星系统的旋进阶段：\n  - 振幅: $A(t) = A_0(1 + \\beta t)$\n  - 瞬时频率: $f(t) = f_0 + \\alpha t$\n  - 相位: $\\phi(t) = \\int_0^t 2\\pi f(\\tau) d\\tau = 2\\pi \\left(f_0 t + \\frac{1}{2}\\alpha t^2\\right)$\n- 阻尼正弦波，代表铃振阶段：\n  - 振幅: $A(t) = A_0 e^{-t/\\tau}$\n  - 相位: $\\phi(t) = 2\\pi f t$\n\n**1.2. $\\Psi_4(t)$ 的解析计算**\n未受污染的 Newman-Penrose 标量是 $h(t)$ 的二阶时间导数，由下式给出：\n$$\n\\Psi_4(t) = \\ddot{h}(t) = \\left[ A''(t) - A(t)(\\phi'(t))^2 - i \\left( 2A'(t)\\phi'(t) + A(t)\\phi''(t) \\right) \\right] e^{-i\\phi(t)}\n$$\n其中撇号表示对时间的导数。我们为每个模型解析地计算这些导数：\n- 对于啁啾模型：\n  - $A'(t) = A_0\\beta$\n  - $A''(t) = 0$\n  - $\\phi'(t) = 2\\pi(f_0 + \\alpha t)$\n  - $\\phi''(t) = 2\\pi\\alpha$\n- 对于阻尼正弦波模型：\n  - $A'(t) = -A(t)/\\tau$\n  - $A''(t) = A(t)/\\tau^2$\n  - $\\phi'(t) = 2\\pi f$\n  - $\\phi''(t) = 0$\n\n**1.3. 污染**\n数值相对论波形通常包含来自提取过程和数值伪影的低频误差。我们通过向真实的 $\\Psi_4(t)$ 添加一个实值污染信号 $C(t)$ 来模拟这种情况：\n$$\nC(t) = c_0 + c_1 t + s_A \\sin(2\\pi f_{\\text{low}} t)\n$$\n那么，受污染的信号是 $\\Psi_{4, \\text{cont}}(t) = \\Psi_{4, \\text{true}}(t) + C(t)$。这将污染项添加到了 $\\Psi_4(t)$ 的实部，而虚部保持不变。\n\n**2. 波形恢复流程**\n\n核心任务是从受污染的 $\\Psi_{4, \\text{cont}}(t)$ 中恢复 $h(t)$。\n\n**2.1. 加窗**\n第一步是向数据应用 Tukey 窗 $w(t)$。这是一个平滑的锥削函数，它将其边界处的信号振幅平缓地降至零。其目的是减少因傅里葉方法所假定的隐式周期性而可能产生的光谱泄漏，并抑制后续积分和滤波步骤产生的边界伪影。加窗后的信号是 $\\Psi_{4, \\text{win}}(t) = \\Psi_{4, \\text{cont}}(t) \\cdot w(t)$。该窗口由一个分数锥度参数 $\\alpha_{\\text{win}}$ 表征。\n\n**2.2. 数值积分**\n我们使用累积梯形法则执行两次连续的时域积分。这近似于函数 $y(t)$ 的积分 $\\int_0^t y(\\tau) d\\tau$。\n$$\n\\dot{h}_0(t) = \\int_0^t \\Psi_{4, \\text{win}}(\\tau) d\\tau\n$$\n$$\nh_0(t) = \\int_0^t \\dot{h}_0(\\tau) d\\tau\n$$\n这些数值积分是在假定零初始条件的情况下执行的，从而得到一个初步应变 $h_0(t)$。\n\n**2.3. 通过去趋势移除漂移**\n从 $\\ddot{h}(t) = \\Psi_4(t)$ 得到的 $h(t)$ 的精确解仅在两个积分常数 $C_1$ 和 $C_2$ 的意义上是确定的，这两个常数引入了 $C_1 t + C_2$ 形式的任意线性漂移。目标是确定这些常数，使得恢复的波形具有物理意义（即，不漂移）。指定的方法是从初步应变 $h_0(t)$ 中移除最佳拟合的线性趋势。这等同于找到系数 $a$ 和 $b$ 以最小化 $L^2$ 范数 $\\|h_0(t) - (at+b)\\|^2$。此过程分别应用于 $h_0(t)$ 的实部和虚部。去趋势后的信号是 $h_{\\text{detrend}}(t) = h_0(t) - (a_{\\text{Re}}t + b_{\\text{Re}}) - i(a_{\\text{Im}}t + b_{\\text{Im}})$。\n\n**2.4. 高通滤波**\n即使在去趋势之后，低频伪影仍然存在。这些伪影源于所添加污染 $C(t)$ 的积分（例如，$c_0$ 积分得到一个二次项，$c_1 t$ 积分得到一个三次项）以及低频正弦波。应用高通滤波器来移除这种残留污染。指定了一个阶数为 $n$、截止频率为 $f_c$ 的 Butterworth 滤波器。为了防止在波形中引入相位失真，使用了零相位滤波技术 (`filtfilt`)。这是通过向前应用一次滤波器然后再向后应用一次来实现的，这样可以抵消相位移。这样就得到了最终恢复的复应变 $h^{\\text{rec}}(t)$。\n\n**3. 质量度量**\n\n为了评估恢复的保真度，我们计算平均相对均方根 (RMS) 误差。首先，我们使用指定的约定 $h(t) = h_+(t) - i h_\\times(t)$ 从真实和恢复的复应变中提取 plus ($h_+$) 和 cross ($h_\\times$) 极化，这意味着 $h_+(t) = \\text{Re}\\{h(t)\\}$ 和 $h_\\times(t) = -\\text{Im}\\{h(t)\\}$。相对 RMS 误差为：\n$$\n\\varepsilon_+ = \\frac{\\text{RMS}(h_{+}^{\\text{rec}} - h_{+}^{\\text{true}})}{\\text{RMS}(h_{+}^{\\text{true}})} \\quad \\text{and} \\quad \\varepsilon_\\times = \\frac{\\text{RMS}(h_{\\times}^{\\text{rec}} - h_{\\times}^{\\text{true}})}{\\text{RMS}(h_{\\times}^{\\text{true}})}\n$$\n其中 $\\text{RMS}(x) = \\sqrt{\\frac{1}{N}\\sum_{k=1}^N x_k^2}$。最终报告的度量是这两个误差的平均值，$\\varepsilon = \\frac{1}{2}(\\varepsilon_+ + \\varepsilon_\\times)$。\n\n这个全面的过程构成了一个从数值相对論数据中恢复引力波波形的稳健算法，该算法在提供的代码中得以实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\nfrom scipy.signal import windows, detrend, butter, filtfilt\n\ndef process_case(params):\n    \"\"\"\n    Processes a single test case for waveform recovery.\n    - Generates true waveform and Psi4.\n    - Adds contamination.\n    - Applies the recovery pipeline.\n    - Computes and returns the error metric.\n    \"\"\"\n    T = params['T']\n    fs = params['fs']\n    N = int(T * fs)\n    t = np.linspace(0.0, T, N, endpoint=False)\n\n    # 1. Generate true waveform h_true and its derivatives\n    if params['model'] == 'chirp':\n        f0, alpha_f, A0, beta = params['model_params']\n        \n        # Amplitude and its derivatives\n        A = A0 * (1.0 + beta * t)\n        A_d = A0 * beta * np.ones_like(t)\n        A_dd = np.zeros_like(t)\n\n        # Phase and its derivatives\n        phi = 2.0 * np.pi * (f0 * t + 0.5 * alpha_f * t**2)\n        phi_d = 2.0 * np.pi * (f0 + alpha_f * t)\n        phi_dd = 2.0 * np.pi * alpha_f * np.ones_like(t)\n\n    elif params['model'] == 'damped_sinusoid':\n        f, tau, A0 = params['model_params']\n        \n        # Amplitude and its derivatives\n        A = A0 * np.exp(-t / tau)\n        A_d = -A / tau\n        A_dd = A / (tau**2)\n\n        # Phase and its derivatives\n        phi = 2.0 * np.pi * f * t\n        phi_d = 2.0 * np.pi * f * np.ones_like(t)\n        phi_dd = np.zeros_like(t)\n\n    h_true = A * np.exp(-1j * phi)\n\n    # 2. Compute true Psi4 from analytic derivatives\n    psi4_true = (A_dd - A * (phi_d**2) - 1j * (2 * A_d * phi_d + A * phi_dd)) * np.exp(-1j * phi)\n\n    # 3. Add contamination\n    c0, c1, sA, f_low = params['cont']\n    contamination = c0 + c1 * t + sA * np.sin(2 * np.pi * f_low * t)\n    \n    # As per interpretation, the real-valued contamination is added to the complex signal.\n    # This effectively adds it to the real part: Re(z+r) = Re(z)+r, Im(z+r) = Im(z).\n    psi4_cont = psi4_true + contamination\n\n    # 4. Recovery Pipeline\n    # 4a. Windowing\n    win = windows.tukey(N, alpha=params['alpha_win'])\n    psi4_win = psi4_cont * win\n\n    # 4b. Integration (twice)\n    # The 'initial=0' argument ensures the output array has the same length N.\n    h_dot_0 = cumulative_trapezoid(psi4_win, x=t, initial=0)\n    h0 = cumulative_trapezoid(h_dot_0, x=t, initial=0)\n\n    # 4c. Detrending (removes linear trend from real and imag parts)\n    h0_detrend_real = detrend(h0.real, type='linear')\n    h0_detrend_imag = detrend(h0.imag, type='linear')\n    h0_detrend = h0_detrend_real + 1j * h0_detrend_imag\n\n    # 4d. High-pass filtering (zero-phase)\n    nyquist = 0.5 * fs\n    Wn = params['fc'] / nyquist\n    b, a = butter(params['n_order'], Wn, btype='highpass')\n    h_rec_real = filtfilt(b, a, h0_detrend.real)\n    h_rec_imag = filtfilt(b, a, h0_detrend.imag)\n    h_rec = h_rec_real + 1j * h_rec_imag\n\n    # 5. Calculate Quality Metric\n    # Extract polarizations: h = h_plus - i*h_cross\n    h_plus_true = h_true.real\n    h_cross_true = -h_true.imag\n    h_plus_rec = h_rec.real\n    h_cross_rec = -h_rec.imag\n\n    # RMS of true signals\n    rms_plus_true = np.sqrt(np.mean(h_plus_true**2))\n    rms_cross_true = np.sqrt(np.mean(h_cross_true**2))\n\n    # Relative RMS errors\n    if rms_plus_true > 0:\n        err_plus = np.sqrt(np.mean((h_plus_rec - h_plus_true)**2)) / rms_plus_true\n    else:\n        err_plus = 0.0\n\n    if rms_cross_true > 0:\n        err_cross = np.sqrt(np.mean((h_cross_rec - h_cross_true)**2)) / rms_cross_true\n    else:\n        err_cross = 0.0\n\n    return 0.5 * (err_plus + err_cross)\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Chirp\n        {\n            'T': 4.0, 'fs': 2048,\n            'model': 'chirp',\n            'model_params': (30, 40, 1e-22, 0.2), # f0, alpha, A0, beta\n            'cont': (5e-24, 1e-24, 1e-23, 2), # c0, c1, sA, f_low\n            'alpha_win': 0.1, 'fc': 10, 'n_order': 4\n        },\n        # Case 2: Damped sinusoid\n        {\n            'T': 2.0, 'fs': 4096,\n            'model': 'damped_sinusoid',\n            'model_params': (150, 0.5, 1e-22), # f, tau, A0\n            'cont': (1e-24, -2e-24, 5e-25, 1), # c0, c1, sA, f_low\n            'alpha_win': 0.05, 'fc': 10, 'n_order': 4\n        },\n        # Case 3: Low-frequency boundary (chirp model with alpha=0, beta=0)\n        {\n            'T': 3.0, 'fs': 1024,\n            'model': 'chirp',\n            'model_params': (5, 0.0, 5e-22, 0.0), # f0, alpha, A0, beta\n            'cont': (5e-24, 2e-24, 2e-23, 0.5), # c0, c1, sA, f_low\n            'alpha_win': 0.1, 'fc': 2, 'n_order': 4\n        },\n        # Case 4: Short-duration segment (chirp model with alpha=0, beta=0)\n        {\n            'T': 0.5, 'fs': 1024,\n            'model': 'chirp',\n            'model_params': (50, 0.0, 2e-22, 0.0), # f0, alpha, A0, beta\n            'cont': (1e-24, 1e-24, 1e-23, 1), # c0, c1, sA, f_low\n            'alpha_win': 0.2, 'fc': 5, 'n_order': 4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        error = process_case(case)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "对于自旋不共线的双星系统，其轨道平面会发生进动。这使得波形变得复杂，将能量分散到许多球谐模式中。通过将波形转换到一个随轨道平面一同旋转的“共进动”参考系，我们可以简化波形。在这个参考系中，物理过程更简单，波形主要由少数几个模式主导。本练习将介绍执行此转换所需的数学工具——欧拉角和维格纳D矩阵。掌握这项技术对于分析进动系统和建立精确的波形模型至关重要。",
            "id": "3481744",
            "problem": "来自数值相对论 (NR) 的引力波波形通常以复应变 $h(t,\\theta,\\phi)$ 的球谐模目录形式提供，其定义为分解为自旋权重 $s=-2$ 的自旋权重球谐函数 (SWSH)：\n$$\nh(t,\\theta,\\phi)=\\sum_{\\ell,m}h_{\\ell m}(t)\\,{}_{-2}Y_{\\ell m}(\\theta,\\phi).\n$$\n对于进动双星源，构造一个共进动参考系是有利的，在该参考系中，主辐射轴是瞬时 $z$ 轴，并且参考系围绕该轴的旋转最小。令 $\\hat{n}(t)$ 表示通过最大化瞬时四极矩辐射（例如，通过最大化 $\\ell=2$ 模的功率）确定的辐射轴，并令 $R(t)\\in\\mathrm{SO}(3)$ 是一个随时间变化的旋转，它将 $\\hat{n}(t)$ 映射到固定的 $\\hat{z}$ 轴，并且在其他方面最小化参考系的时间变化。你可以用单位四元数或具有 ZYZ 欧拉角 $(\\alpha(t),\\beta(t),\\gamma(t))$ 的旋转矩阵来表示 $R(t)$。\n\n从刚体运动学的第一性原理和辐射轴的定义出发，推导关于 $(\\alpha(t),\\beta(t),\\gamma(t))$ 的最小旋转条件，该条件强制要求参考系在 $R(t)$ 作用下具有最小的时间变化。然后，使用旋转在 SWSH 基上的标准表示，推导模系数 $h_{\\ell m}(t)$ 如何通过维格纳 D 矩阵在 $R(t)$ 下进行变换。\n\n最后，考虑从 NR 波形目录中提取的 $t_0$ 时刻的以下瞬时构型：\n- 唯一非零的四极模为 $h_{2,2}(t_0)=1$ 和 $h_{2,-2}(t_0)=1$，所有其他 $h_{2,m}(t_0)=0$（对于 $m\\in\\{-1,0,1\\}$）。\n- $t_0$ 时刻的共进动参考系旋转由 ZYZ 欧拉角 $(\\alpha,\\beta,\\gamma)=\\left(\\frac{\\pi}{4},\\frac{\\pi}{6},\\frac{\\pi}{3}\\right)$ 指定，该旋转是通过对 $(\\alpha(t),\\beta(t),\\gamma(t))$ 施加最小旋转条件得到的。\n\n使用你推导出的带有维格纳 D 矩阵的模旋转公式，计算在 $t_0$ 时刻，旋转后的共进动参考系模 $h'_{2,2}(t_0)$ 的幅值，结果应为一个精确的实数。不要四舍五入；报告精确值，不带单位。",
            "solution": "所述问题具有科学依据、良定且自洽。它描述了引力波数据分析中处理进动双星系统的标准流程，并要求推导基本公式并将其应用于一个具体例子。所有必要的数据和定义均已提供。因此，我们可以开始求解。\n\n问题包括三个部分：1) 推导最小旋转条件，2) 推导球谐模在旋转下的变换法则，3) 应用这些公式计算一个特定量。\n\n**第一部分：最小旋转条件**\n\n问题要求一个共进动参考系来跟踪主辐射轴，记为 $\\hat{n}(t)$，使得在这个新参考系中，该轴始终与 $\\hat{z}$ 方向对齐。设从初始惯性系（“实验室”参考系）到这个共进动参考系的旋转为 $R(t) \\in \\mathrm{SO}(3)$。我们使用 ZYZ 欧拉角 $(\\alpha(t), \\beta(t), \\gamma(t))$ 来表示这个旋转。\n\n在此约定中，旋转 $R(\\alpha, \\beta, \\gamma)$ 可以看作是将实验室参考系的 $\\hat{z}$ 轴与球坐标 $(\\theta, \\phi) = (\\beta, \\alpha)$ 指定的方向对齐，然后围绕这个新轴旋转 $\\gamma$。问题指出 $R(t)$ 将 $\\hat{n}(t)$ 映射到 $\\hat{z}$。这意味着我们应该考虑逆旋转。一个更标准的约定，我们在此采用，是这样定义欧拉角：共进动参考系是通过旋转 $R(\\alpha, \\beta, \\gamma)$ 到达的，其中 $\\alpha(t)$ 和 $\\beta(t)$ 分别是辐射轴 $\\hat{n}(t)$ 在实验室参考系中的球坐标（方位角和极角）。\n\n共进动参考系的角速度矢量 $\\vec{\\omega}$ 可以用欧拉角的时间导数来表示。当在共进动（体固）参考系的基上分解时，其分量 $(\\omega'_x, \\omega'_y, \\omega'_z)$ 由 ZYZ 欧拉角的标准运动学关系给出：\n$$\n\\omega'_x = \\dot{\\alpha}(t) \\sin\\beta(t) \\sin\\gamma(t) + \\dot{\\beta}(t) \\cos\\gamma(t)\n$$\n$$\n\\omega'_y = \\dot{\\alpha}(t) \\sin\\beta(t) \\cos\\gamma(t) - \\dot{\\beta}(t) \\sin\\gamma(t)\n$$\n$$\n\\omega'_z = \\dot{\\alpha}(t) \\cos\\beta(t) + \\dot{\\gamma}(t)\n$$\n共进动参考系跟踪辐射轴 $\\hat{n}(t)$ 的条件决定了角度 $\\alpha(t)$ 和 $\\beta(t)$。具体来说，如果 $\\hat{n}(t)$ 的球坐标为 $(\\theta_n(t), \\phi_n(t))$，那么我们设置 $\\beta(t) = \\theta_n(t)$ 和 $\\alpha(t) = \\phi_n(t)$。这固定了三个旋转自由度中的两个。\n\n剩下的自由度是围绕轴 $\\hat{n}(t)$ 本身的旋转，这对应于第三个欧拉角 $\\gamma(t)$。“最小旋转”条件是用于固定这个规范自由度的规定。它要求参考系除了保持指向 $\\hat{n}(t)$ 所需的旋转外，不围绕瞬时辐射轴进行任何额外旋转。在共进动参考系中，根据构造，辐射轴是 $\\hat{z}'$ 轴。因此，最小旋转条件通过将参考系沿该轴的角速度分量设置为零来强制执行。\n$$\n\\omega'_z = 0\n$$\n代入 $\\omega'_z$ 的表达式，得到最小旋转条件：\n$$\n\\dot{\\alpha}(t) \\cos\\beta(t) + \\dot{\\gamma}(t) = 0\n$$\n这个关于 $\\gamma(t)$ 的一阶微分方程通常写为 $\\dot{\\gamma} = -\\dot{\\alpha} \\cos\\beta$。它也被称为平行输运或准运动学条件。\n\n**第二部分：模系数的变换**\n\n复应变 $h(t, \\theta, \\phi)$ 在自旋权重 $s=-2$ 的自旋权重球谐函数 ${}_{-2}Y_{\\ell m}(\\theta, \\phi)$ 的基上展开。设 $h_{\\ell m}(t)$ 为实验室参考系中的模系数，$h'_{\\ell m}(t)$ 为共进动参考系中的系数。物理场是不变量，因此其在空间中某物理点的值与用于描述它的坐标系无关。\n\n设天球上的一个点由单位矢量 $\\vec{n}$ 表示。在实验室参考系中，其坐标为 $(\\theta, \\phi)$，在共进动参考系中其坐标为 $(\\theta', \\phi')$。两者通过旋转 $R(t)$ 相关联，使得 $\\vec{n}_{\\text{lab}} = R^{-1}(t) \\vec{n}_{\\text{coproc}}$。\n在共进动参考系中表示的应变场 $h'(t, \\theta', \\phi')$ 必须等于在相应点求值的实验室参考系中的场：\n$$\nh'(t, \\theta', \\phi') = h(t, \\theta, \\phi) = h(t, R^{-1}(t)(\\theta', \\phi'))\n$$\n我们在各自的基上展开两边：\n$$\n\\sum_{\\ell, m} h'_{\\ell m}(t) \\,{}_{-2}Y_{\\ell m}(\\theta', \\phi') = \\sum_{\\ell, m'} h_{\\ell m'}(t) \\,{}_{-2}Y_{\\ell m'}(R^{-1}(t)(\\theta', \\phi'))\n$$\n旋转对自旋权重球谐函数的作用由维格纳D矩阵给出：\n$$\n{}_{s}Y_{\\ell m'}(R^{-1}(\\theta', \\phi')) = \\sum_{m=-\\ell}^{\\ell} D^{\\ell}_{m m'}(R(t)) \\,{}_{s}Y_{\\ell m}(\\theta', \\phi')\n$$\n将此代入等式的右侧：\n$$\n\\sum_{\\ell, m} h'_{\\ell m}(t) \\,{}_{-2}Y_{\\ell m}(\\theta', \\phi') = \\sum_{\\ell, m'} h_{\\ell m'}(t) \\sum_{m} D^{\\ell}_{m m'}(R(t)) \\,{}_{-2}Y_{\\ell m}(\\theta', \\phi')\n$$\n通过交换右侧的求和顺序，我们得到：\n$$\n\\sum_{\\ell, m} h'_{\\ell m}(t) \\,{}_{-2}Y_{\\ell m}(\\theta', \\phi') = \\sum_{\\ell, m} \\left( \\sum_{m'} D^{\\ell}_{m m'}(R(t)) h_{\\ell m'}(t) \\right) \\,{}_{-2}Y_{\\ell m}(\\theta', \\phi')\n$$\n由于自旋权重球谐函数的正交性和完备性，我们可以令两边每个 ${}_{-2}Y_{\\ell m}$ 项的系数相等。这得出了模系数的变换法则：\n$$\nh'_{\\ell m}(t) = \\sum_{m'=-\\ell}^{\\ell} D^{\\ell}_{m m'}(R(t)) h_{\\ell m'}(t)\n$$\n这里，$D^{\\ell}_{m m'}(R(t))$ 是旋转 $R(t)$ 的维格纳D矩阵元，它由欧拉角 $(\\alpha(t), \\beta(t), \\gamma(t))$ 参数化为 $D^{\\ell}_{m m'}(\\alpha, \\beta, \\gamma) = e^{-i m \\alpha} d^{\\ell}_{m m'}(\\beta) e^{-i m' \\gamma}$。\n\n**第三部分：计算**\n\n我们被要求计算在瞬时 $t_0$ 时旋转后的模 $h'_{2,2}(t_0)$ 的幅值。\n给定的实验室参考系四极模 ($\\ell=2$) 是 $h_{2,2}(t_0)=1$，$h_{2,-2}(t_0)=1$，以及所有其他 $h_{2,m}(t_0)=0$。\n旋转由 ZYZ 欧拉角 $(\\alpha, \\beta, \\gamma) = \\left(\\frac{\\pi}{4}, \\frac{\\pi}{6}, \\frac{\\pi}{3}\\right)$ 给出。\n\n使用第二部分为 $\\ell=2$ 和 $m=2$ 推导的变换公式：\n$$\nh'_{2,2}(t_0) = \\sum_{m'=-2}^{2} D^{2}_{2, m'}(\\alpha, \\beta, \\gamma) h_{2, m'}(t_0)\n$$\n因为只有 $h_{2,2}$ 和 $h_{2,-2}$ 非零，所以求和简化为：\n$$\nh'_{2,2}(t_0) = D^{2}_{2, 2}(\\alpha, \\beta, \\gamma) h_{2,2}(t_0) + D^{2}_{2, -2}(\\alpha, \\beta, \\gamma) h_{2,-2}(t_0)\n$$\n$$\nh'_{2,2}(t_0) = D^{2}_{2, 2}\\left(\\frac{\\pi}{4}, \\frac{\\pi}{6}, \\frac{\\pi}{3}\\right) \\cdot (1) + D^{2}_{2, -2}\\left(\\frac{\\pi}{4}, \\frac{\\pi}{6}, \\frac{\\pi}{3}\\right) \\cdot (1)\n$$\n我们需要使用 $D^{\\ell}_{m m'}(\\alpha, \\beta, \\gamma) = e^{-i m \\alpha} d^{\\ell}_{m m'}(\\beta) e^{-i m' \\gamma}$ 来计算维格纳D矩阵元。\n所需的 $\\ell=2$ 的维格纳小d矩阵元是：\n$d^{2}_{2,2}(\\beta) = \\left(\\cos\\frac{\\beta}{2}\\right)^4 = \\left(\\frac{1+\\cos\\beta}{2}\\right)^2$\n$d^{2}_{2,-2}(\\beta) = \\left(\\sin\\frac{\\beta}{2}\\right)^4 = \\left(\\frac{1-\\cos\\beta}{2}\\right)^2$\n\n对于 $\\beta = \\frac{\\pi}{6}$，我们有 $\\cos\\beta = \\frac{\\sqrt{3}}{2}$。\n$d^{2}_{2,2}\\left(\\frac{\\pi}{6}\\right) = \\left(\\frac{1+\\frac{\\sqrt{3}}{2}}{2}\\right)^2 = \\left(\\frac{2+\\sqrt{3}}{4}\\right)^2 = \\frac{4+3+4\\sqrt{3}}{16} = \\frac{7+4\\sqrt{3}}{16}$。\n$d^{2}_{2,-2}\\left(\\frac{\\pi}{6}\\right) = \\left(\\frac{1-\\frac{\\sqrt{3}}{2}}{2}\\right)^2 = \\left(\\frac{2-\\sqrt{3}}{4}\\right)^2 = \\frac{4+3-4\\sqrt{3}}{16} = \\frac{7-4\\sqrt{3}}{16}$。\n\n角度因子是：\n$e^{-i m \\alpha} = e^{-i 2 (\\pi/4)} = e^{-i\\pi/2} = -i$。\n$m'=2$ 时的 $e^{-i m' \\gamma}$：$e^{-i 2 (\\pi/3)} = e^{-i2\\pi/3} = \\cos\\left(\\frac{2\\pi}{3}\\right) - i\\sin\\left(\\frac{2\\pi}{3}\\right) = -\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}$。\n$m'=-2$ 时的 $e^{-i m' \\gamma}$：$e^{-i (-2) (\\pi/3)} = e^{i2\\pi/3} = \\cos\\left(\\frac{2\\pi}{3}\\right) + i\\sin\\left(\\frac{2\\pi}{3}\\right) = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$。\n\n现在我们组合 D 矩阵元：\n$D^{2}_{2, 2} = (-i) \\left(\\frac{7+4\\sqrt{3}}{16}\\right) \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right)$。\n$D^{2}_{2, -2} = (-i) \\left(\\frac{7-4\\sqrt{3}}{16}\\right) \\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right)$。\n\n我们将这两项相加得到 $h'_{2,2}(t_0)$：\n$h'_{2,2} = \\frac{-i}{16} \\left[ (7+4\\sqrt{3})\\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) + (7-4\\sqrt{3})\\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right) \\right]$。\n设 $A = 7+4\\sqrt{3}$ 和 $B = 7-4\\sqrt{3}$。方括号中的表达式为 $A(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}) + B(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2})$。\n这简化为 $-\\frac{1}{2}(A+B) -i\\frac{\\sqrt{3}}{2}(A-B)$。\n$A+B = (7+4\\sqrt{3}) + (7-4\\sqrt{3}) = 14$。\n$A-B = (7+4\\sqrt{3}) - (7-4\\sqrt{3}) = 8\\sqrt{3}$。\n方括号中的和为 $-\\frac{1}{2}(14) - i\\frac{\\sqrt{3}}{2}(8\\sqrt{3}) = -7 - i\\frac{8 \\cdot 3}{2} = -7 - 12i$。\n所以，$h'_{2,2} = \\frac{-i}{16}(-7 - 12i) = \\frac{7i + 12i^2}{16} = \\frac{-12 + 7i}{16}$。\n\n最后，我们计算幅值 $|h'_{2,2}(t_0)|$：\n$|h'_{2,2}| = \\left|\\frac{-12 + 7i}{16}\\right| = \\frac{1}{16} \\sqrt{(-12)^2 + 7^2} = \\frac{1}{16}\\sqrt{144+49} = \\frac{\\sqrt{193}}{16}$。\n数字 193 是一个质数，所以该表达式不能进一步简化。",
            "answer": "$$\\boxed{\\frac{\\sqrt{193}}{16}}$$"
        }
    ]
}