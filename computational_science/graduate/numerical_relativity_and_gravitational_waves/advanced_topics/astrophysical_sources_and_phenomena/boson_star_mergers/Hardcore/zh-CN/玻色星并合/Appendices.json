{
    "hands_on_practices": [
        {
            "introduction": "在深入研究动态的并合过程之前，理解单个静态玻色星的性质至关重要。这项练习  是一项广义相对论中的基础性计算，要求你关联质量的两种不同定义——托尔曼（Tolman）质量和 ADM 质量。通过这项实践，你将深化对标量场的压力如何贡献于恒星总引力质量的理解。",
            "id": "3466680",
            "problem": "考虑一个孤立、球对称的玻色子星，其源是一个处于静态、渐近平坦时空中的单个复标量场。采用光速 $c=1$ 的单位制，但保留牛顿常数 $G$。采用度规符号 $(+,-,-,-)$ 和线元\n$$\nds^{2} = \\alpha(r)^{2}\\,dt^{2} - a(r)^{2}\\,dr^{2} - r^{2}\\,d\\Omega^{2},\n$$\n其中 $\\alpha(r)$ 是递减函数，$a(r)$ 是径向度规函数。该复标量场具有标准的谐波拟设\n$$\n\\phi(t,r) = \\Phi(r)\\,\\exp\\!\\left(- i \\omega t\\right),\n$$\n其中振幅 $\\Phi(r)$ 和频率 $\\omega$ 均为实数。物质拉格朗日量密度为\n$$\n\\mathcal{L} = g^{\\mu \\nu}\\,\\partial_{\\mu}\\phi^{\\ast}\\,\\partial_{\\nu}\\phi - V\\!\\left(|\\phi|^{2}\\right),\n$$\n其中 $V$ 是一个仅依赖于 $|\\phi|^{2}$ 的非负势，总应力-能量张量为\n$$\nT_{\\mu \\nu} = \\partial_{\\mu}\\phi^{\\ast}\\,\\partial_{\\nu}\\phi + \\partial_{\\nu}\\phi^{\\ast}\\,\\partial_{\\mu}\\phi - g_{\\mu \\nu}\\,\\mathcal{L}.\n$$\n\n定义 Tolman 质量\n$$\nM_{\\mathrm{T}} \\equiv \\int_{\\Sigma_{t}} \\left(T^{0}{}_{0} - T^{i}{}_{i}\\right)\\sqrt{-g}\\,d^{3}x,\n$$\n其中 $\\Sigma_{t}$ 是一个常数 $t$ 切片，$g$ 是时空度规的行列式，空间指标 $i$ 遍历 $r,\\theta,\\varphi$。通过与渐近时间平移相关的空间无穷远处的标准渐近荷来定义 Arnowitt–Deser–Misner (ADM) 质量 $M_{\\mathrm{ADM}}$。\n\n从爱因斯坦场方程和上述定义出发，完成以下任务：\n- 显式计算复标量场的 Tolman 被积函数 $T^{0}{}_{0} - T^{i}{}_{i}$，用 $\\alpha(r)$、$a(r)$、$\\Phi(r)$、$\\omega$ 和 $V\\!\\left(\\Phi^{2}\\right)$ 表示，并尽可能地化简。\n- 利用静态 Killing 对称性、与递减函数 $\\alpha(r)$ 相关的 Gauss 定律以及渐近平坦性，将得到的体积分与无穷远处的 ADM 曲面积分联系起来，以推断 $M_{\\mathrm{T}}$ 和 $M_{\\mathrm{ADM}}$ 之间的相等或不等关系。\n- 在推导中，强调标量场压力项如何进入 $T^{i}{}_{i}$ 并影响 Tolman 被积函数，并找出梯度项之间发生的任何抵消。\n\n最后，以单个实数或单个闭式解析表达式的形式，报告差值 $M_{\\mathrm{T}} - M_{\\mathrm{ADM}}$ 的精确值。不需要数值近似，最终报告的值中不应包含任何单位。",
            "solution": "该问题要求我们确定静态球对称玻色子星的 Tolman 质量 $M_{\\mathrm{T}}$ 与 ADM 质量 $M_{\\mathrm{ADM}}$ 之间的关系。我们将首先验证问题陈述，然后进行推导。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 时空度规：$ds^{2} = \\alpha(r)^{2}\\,dt^{2} - a(r)^{2}\\,dr^{2} - r^{2}\\,d\\Omega^{2}$，符号为 $(+,-,-,-)$。\n- 时空性质：孤立、球对称、静态、渐近平坦。\n- 标量场拟设：$\\phi(t,r) = \\Phi(r)\\,\\exp(-i \\omega t)$，其中 $\\Phi(r)$ 和 $\\omega$ 为实数。\n- 物质拉格朗日量密度：$\\mathcal{L} = g^{\\mu \\nu}\\,\\partial_{\\mu}\\phi^{\\ast}\\,\\partial_{\\nu}\\phi - V(|\\phi|^{2})$。\n- 应力-能量张量：$T_{\\mu \\nu} = \\partial_{\\mu}\\phi^{\\ast}\\,\\partial_{\\nu}\\phi + \\partial_{\\nu}\\phi^{\\ast}\\,\\partial_{\\mu}\\phi - g_{\\mu \\nu}\\,\\mathcal{L}$。\n- Tolman 质量定义：$M_{\\mathrm{T}} \\equiv \\int_{\\Sigma_{t}} (T^{0}{}_{0} - T^{i}{}_{i})\\sqrt{-g}\\,d^{3}x$。\n- ADM 质量定义：$M_{\\mathrm{ADM}}$ 是空间无穷远处的标准渐近荷。\n- 单位：$c=1$，$G$ 是显式的。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是理论天体物理学和数值相对论中的一个标准课题。问题陈述清晰，提供了执行所需计算和推论的所有必要定义（度规、场、拉格朗日量、质量形式）。语言客观正式。设定自洽且一致。该问题是广义相对论中质量定义的一个非平凡应用。未发现任何缺陷。\n\n**步骤 3：结论与行动**\n问题有效。我们将继续进行解答。\n\n### 详细解答\n\n**1. 应力-能量张量和 Tolman 被积函数的计算**\n\n首先，我们计算应力-能量张量 $T_{\\mu\\nu}$ 的分量和混合张量 $T^\\mu{}_\\nu$ 的分量。时空度规为 $g_{\\mu\\nu} = \\mathrm{diag}(\\alpha(r)^2, -a(r)^2, -r^2, -r^2\\sin^2\\theta)$。其逆为 $g^{\\mu\\nu} = \\mathrm{diag}(\\alpha(r)^{-2}, -a(r)^{-2}, -r^{-2}, -r^{-2}\\sin^{-2}\\theta)$。\n标量场为 $\\phi = \\Phi(r)e^{-i\\omega t}$。其非零导数为 $\\partial_t \\phi = -i\\omega\\phi$ 和 $\\partial_r \\phi = \\Phi'(r)e^{-i\\omega t}$。注意 $|\\phi|^2 = \\Phi^2(r)$。\n\n拉格朗日量密度 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L} = g^{tt}(\\partial_t\\phi^*)(\\partial_t\\phi) + g^{rr}(\\partial_r\\phi^*)(\\partial_r\\phi) - V(\\Phi^2) = \\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V(\\Phi^2)\n$$\n\n现在我们计算应力-能量张量 $T_{\\mu\\nu} = (\\partial_\\mu\\phi^*)(\\partial_\\nu\\phi) + (\\partial_\\nu\\phi^*)(\\partial_\\mu\\phi) - g_{\\mu\\nu}\\mathcal{L}$ 的分量：\n- $T_{tt} = 2|\\partial_t\\phi|^2 - g_{tt}\\mathcal{L} = 2\\omega^2\\Phi^2 - \\alpha^2\\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V\\right) = \\omega^2\\Phi^2 + \\frac{\\alpha^2(\\Phi')^2}{a^2} + \\alpha^2 V$。\n- $T_{rr} = 2|\\partial_r\\phi|^2 - g_{rr}\\mathcal{L} = 2(\\Phi')^2 + a^2\\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V\\right) = (\\Phi')^2 + \\frac{a^2\\omega^2\\Phi^2}{\\alpha^2} - a^2 V$。\n- $T_{\\theta\\theta} = -g_{\\theta\\theta}\\mathcal{L} = r^2\\mathcal{L} = r^2\\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V\\right)$。\n- $T_{\\varphi\\varphi} = -g_{\\varphi\\varphi}\\mathcal{L} = r^2\\sin^2\\theta \\mathcal{L} = T_{\\theta\\theta}\\sin^2\\theta$。\n- 非对角分量为零。\n\n由此，我们求出混合张量的分量 $T^\\mu{}_\\nu = g^{\\mu\\rho}T_{\\rho\\nu}$：\n能量密度为 $\\rho = T^0{}_0 = g^{00}T_{00} = \\alpha^{-2}T_{tt} = \\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{(\\Phi')^2}{a^2} + V(\\Phi^2)$。\n径向压力为 $P_r = -T^r{}_r = -g^{rr}T_{rr} = a^{-2}T_{rr} = \\frac{(\\Phi')^2}{a^2} + \\frac{\\omega^2\\Phi^2}{\\alpha^2} - V(\\Phi^2)$。\n切向压力为 $P_\\perp = -T^\\theta{}_\\theta = -g^{\\theta\\theta}T_{\\theta\\theta} = r^{-2}T_{\\theta\\theta} = \\mathcal{L} = \\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V(\\Phi^2)$。\n注意 $T^\\varphi{}_\\varphi = T^\\theta{}_\\theta = -P_\\perp$。\n\nTolman 被积函数为 $T^{0}{}_{0} - T^{i}{}_{i} = T^0{}_0 - (T^r{}_r + T^\\theta{}_\\theta + T^\\varphi{}_\\varphi)$。使用能量密度和压力的定义，这等于：\n$$\nT^{0}{}_{0} - T^{i}{}_{i} = \\rho - (-P_r - P_\\perp - P_\\perp) = \\rho + P_r + 2P_\\perp\n$$\n代入 $\\rho$、$P_r$ 和 $P_\\perp$ 的表达式：\n$$\n\\rho + P_r + 2P_\\perp = \\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{(\\Phi')^2}{a^2} + V\\right) + \\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{(\\Phi')^2}{a^2} - V\\right) + 2\\left(\\frac{\\omega^2\\Phi^2}{\\alpha^2} - \\frac{(\\Phi')^2}{a^2} - V\\right)\n$$\n我们将各项分组以找出抵消项。\n- 梯度项：$\\frac{(\\Phi')^2}{a^2} + \\frac{(\\Phi')^2}{a^2} - \\frac{2(\\Phi')^2}{a^2} = 0$。\n- 时间导数动能项：$\\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{\\omega^2\\Phi^2}{\\alpha^2} + \\frac{2\\omega^2\\Phi^2}{\\alpha^2} = \\frac{4\\omega^2\\Phi^2}{\\alpha^2}$。\n- 势能项：$V - V - 2V = -2V$。\n\n压力 $P_r$ 和 $P_\\perp$ 是各向异性的，即 $P_r \\neq P_\\perp$。它们对标量场梯度 $\\Phi'$ 的不同依赖性是至关重要的。在特定的组合 $\\rho + P_r + 2P_\\perp$ 中，标量场梯度对能量密度 ($\\rho$) 和径向压力 ($P_r$) 的贡献被切向压力 ($P_\\perp$) 的相应贡献所抵消。这种抵消是一个关键特征。\n\n化简后的 Tolman 被积函数为：\n$$\nT^{0}{}_{0} - T^{i}{}_{i} = \\frac{4\\omega^2\\Phi(r)^2}{\\alpha(r)^2} - 2V(\\Phi(r)^2)\n$$\n\n**2. Tolman 质量 ($M_{\\mathrm{T}}$) 与 ADM 质量 ($M_{\\mathrm{ADM}}$) 之间的关系**\n\nTolman 质量由体积分定义：\n$$\nM_{\\mathrm{T}} = \\int_{\\Sigma_{t}} (T^{0}{}_{0} - T^{i}{}_{i})\\sqrt{-g}\\,d^{3}x\n$$\n其中 $\\Sigma_t$ 是一个常数时间 $t$ 的切片，$d^3x = dr\\,d\\theta\\,d\\varphi$。度规行列式为 $g = -\\alpha^2 a^2 r^4 \\sin^2\\theta$，因此 $\\sqrt{-g} = \\alpha a r^2\\sin\\theta$。对角向变量积分（$4\\pi$ 球面度），我们得到：\n$$\nM_{\\mathrm{T}} = 4\\pi \\int_0^\\infty \\left( T^{0}{}_{0} - T^{i}{}_{i} \\right) \\alpha(r) a(r) r^2 dr = 4\\pi \\int_0^\\infty (\\rho + P_r + 2P_\\perp) \\alpha(r) a(r) r^2 dr\n$$\n问题要求使用静态 Killing 对称性。这表明应将 $M_{\\mathrm{T}}$ 与 Komar 质量 $M_{\\mathrm{K}}$ 联系起来，后者是通过时间平移 Killing 矢量场 $\\xi^\\mu = (1,0,0,0)$ 内在地定义的。对于静态时空，Komar 质量可以表示为空间超曲面 $\\Sigma$ 上的一个体积分：\n$$\nM_{\\mathrm{K}} = \\int_\\Sigma (2T_{\\mu\\nu} - g_{\\mu\\nu}T) n^\\mu \\xi^\\nu dV\n$$\n此处，$n^\\mu = \\alpha^{-1}\\xi^\\mu = (\\alpha^{-1}, 0, 0, 0)$ 是指向未来的 $\\Sigma$ 的单位法矢量，$dV = \\sqrt{\\gamma}\\,d^3x = a r^2 \\sin\\theta dr d\\theta d\\varphi$ 是 $\\Sigma$ 上的固有体积元，而 $T=T^\\lambda{}_\\lambda=\\rho - P_r - 2P_\\perp$ 是应力-能量张量的迹。被积函数变为：\n$$\n(2T_{00} - g_{00}T)n^0 = (2\\alpha^2\\rho - \\alpha^2(\\rho-P_r-2P_\\perp))\\alpha^{-1} = \\alpha(\\rho+P_r+2P_\\perp)\n$$\n将此代入 Komar 积分并对角向部分积分：\n$$\nM_{\\mathrm{K}} = 4\\pi \\int_0^\\infty \\alpha(\\rho+P_r+2P_\\perp) a r^2 dr\n$$\n将其与 Tolman 质量的表达式进行比较，我们发现它们是相同的：\n$$\nM_{\\mathrm{T}} = M_{\\mathrm{K}}\n$$\n这个等式成立，因为当应用于静态时空时，Tolman 质量的定义与 Komar 质量的体积分形式相吻合。\n\n最后一步是将其与 ADM 质量联系起来。广义相对论中的一个基本定理指出，对于任何具有在空间无穷远处衰减足够快的应力-能量张量的稳态、渐近平坦时空，Komar 质量等于 ADM 质量。\n玻色子星是一个局域化的物体，意味着标量场 $\\Phi(r)$ 及其导数在大的 $r$ 处指数衰减。这确保了 $T_{\\mu\\nu}$ 的所有分量都快速衰减，满足该定理的条件。“与递减函数相关的 Gauss 定律”是对该定理证明的一个提示，该证明涉及使用爱因斯坦场方程和 Stokes 定理将 Komar 体积分转换为无穷远处的曲面积分。这个曲面积分正是定义 ADM 质量的积分，ADM 质量通过度规的渐近行为（$g_{tt} \\approx 1 - 2GM_{\\mathrm{ADM}}/r$）来度量总引力质量。\n\n因此，对于所描述的静态玻色子星构型，我们有一系列等式：\n$$\nM_{\\mathrm{T}} = M_{\\mathrm{K}} = M_{\\mathrm{ADM}}\n$$\n这意味着 Tolman 质量完全等于 ADM 质量。\n\n因此，差值 $M_{\\mathrm{T}} - M_{\\mathrm{ADM}}$ 为零。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "玻色星独特的内部结构会在其引力波信号中留下显著的特征。这项实践  挑战你构建一个简化模型，用以预测由包含激发态玻色星的并合所产生的引力波信号谱线。通过实现这个模型，你将探索非线性效应和模式混合如何产生独特的频率，从而在理论模型与潜在的可观测数据之间建立直接联系。",
            "id": "3466788",
            "problem": "您的任务是设计一个自包含程序，用于预测玻色子星并合后的引力波应变谱 $h(f)$ 中的特征谱线。其中一个玻色子星初始处于激发径向态，其标量场 $ \\phi $ 呈现一个节点。该建模必须基于与数值相对论和引力波相关的基本原理，并采用最小的、有物理依据的近似。从广义相对论 (GR) 的线性化极限出发，在该极限下，度规微扰很小，引力波源于质量四极矩的二阶时间导数；并从最小耦合复标量场的典则应力-能量张量出发。您的程序必须实现以下要求。\n\n1. 基本原理和建模假设：\n   - 采用线性化广义相对论 (LGR)：远处的引力辐射由质量四极矩的二阶时间导数主导。具体而言，对远方观测者来说，主导阶次的应变取决于四极矩的二阶时间导数，这对于一个双星系统，会在两倍轨道频率处产生一条主导谱线。\n   - 将玻色子星的标量场表示为一个径向基模和一个带节点的径向激发模的叠加。设标量场近似为一个实值有效场 $ \\phi(t) $，其时间依赖性是角频率为 $ \\omega_0 $ (基频) 和 $ \\omega_e $ (激发频) 的正弦分量的和。应力-能量张量 $ T_{\\mu\\nu} $ 是 $ \\phi $ 及其导数的二次方，这意味着通过乘积会产生二次谐波及和/差频，从而出现混频现象。\n   - 设双星轨道动力学以角频率 $ \\Omega $ 贡献一个四极调制。在弱场、慢速机制下，主导引力波谱线的循环频率为 $ 2 \\Omega $，轨道四极矩和标量场振荡之间的混合会产生组合频率处的边带。\n   - 通过一个无量纲系数 $ C_2 $ 来模拟标量应力-能量在 $\\ell=2$ (四极) 引力波通道上的投影，该系数编码了与几何相关的耦合。激发径向模中的节点使其有效的 $\\ell=2$ 投影相对于基模减小了一个因子 $ \\eta $，其中 $ 0  \\eta \\leq 1 $。\n   - 包含一个模式转换效率 $ \\chi $，用于调节与基模和激发标量模之间交叉项相关的和/差频分量的强度；以及一个轨道-标量边带混合系数 $ \\beta $，用于调节由轨道四极矩和标量振荡的乘积产生的边带振幅。\n\n2. 需要预测的频率内容：\n   - 对应于 $ 2\\Omega $ 的主导双星四极谱线（以循环频率表示）。\n   - 由 $ T_{\\mu\\nu} $ 的二次结构产生的二次谐波和交叉项对应的标量二次谱线：角频率为 $ 2\\omega_0 $、$ 2\\omega_e $ 和 $ \\omega_e \\pm \\omega_0 $ 的分量。\n   - 由轨道-标量混合产生的边带：角频率为 $ 2\\Omega \\pm \\omega_0 $ 和 $ 2\\Omega \\pm \\omega_e $ 的分量。\n   - 使用 $ f = \\omega/(2\\pi) $ 将所有角频率转换为循环频率。所有输出频率必须以赫兹 (Hz) 表示，并四舍五入到三位小数。\n\n3. 振幅建模与滤波：\n   - 为候选谱线分配与上述耦合一致的相对无量纲振幅：\n     - 主导四极谱线的振幅 $ A_{\\mathrm{orb}} $ 作为输入标量提供。\n     - 基频标量二次谐波的振幅与 $ C_2 $ 和基模振幅 $ a_0 $ 成正比，关系为 $ A_{2\\omega_0} \\propto C_2 a_0^2 $。\n     - 激发频标量二次谐波的振幅关系为 $ A_{2\\omega_e} \\propto C_2 \\eta a_e^2 $，其中 $ a_e $ 是激发模振幅，$ \\eta $ 编码了节点抑制效应。\n     - 和/差频交叉项的振幅关系为 $ A_{\\mathrm{sum/diff}} \\propto C_2 \\chi a_0 a_e $。\n     - 轨道-标量边带的振幅关系分别为：基模为 $ A_{\\mathrm{sb},0} \\propto \\beta C_2 a_0 $，激发模为 $ A_{\\mathrm{sb},e} \\propto \\beta C_2 \\eta a_e $。\n   - 您的程序必须应用一个振幅阈值 $ A_{\\mathrm{th}} $ 和一个最小频率阈值 $ f_{\\min} $ (两者均已提供)，以丢弃任何振幅低于 $ A_{\\mathrm{th}} $ 或频率低于 $ f_{\\min} $ 的谱线。\n   - 滤波后，通过排序和贪心聚类对预测的谱线进行去重，将任何在容差 $ \\delta f $ 内的频率合并为一个代表值。\n\n4. 输出规范：\n   - 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身也是一个用方括号括起来的逗号分隔列表，包含预测的循环频率（单位：Hz），按升序排序并四舍五入到三位小数。例如，$ [ [f_1,f_2], [g_1,g_2,g_3] ] $，不含空格。\n   - 不允许用户输入。仅使用下面提供的参数。\n\n5. 单位和角度规范：\n   - 所有类角度量均为角频率，单位为弧度/秒。所有输出的循环频率必须以赫兹 (Hz) 为单位。将每个数值频率值四舍五入到三位小数。\n   - 没有以度为单位的角度；所有角量均使用弧度。\n\n6. 测试套件：\n   请为以下测试用例实现您的程序，这些用例涵盖了一般情景、对称性受限情况和近共振边缘情况。每个测试用例都提供了如上所述的参数。\n   - 测试用例 $ 1 $ (一般激发模并合):\n     - $ \\omega_0 = 2\\pi \\times 8000 \\ \\mathrm{rad/s} $, $ \\omega_e = 2\\pi \\times 12000 \\ \\mathrm{rad/s} $, $ \\Omega = 2\\pi \\times 150 \\ \\mathrm{rad/s} $.\n     - 模式振幅: $ a_0 = 1.0 $, $ a_e = 0.7 $.\n     - 耦合系数: $ C_2 = 0.6 $, $ \\eta = 0.5 $, $ \\chi = 0.3 $, $ \\beta = 0.1 $.\n     - 轨道谱线振幅: $ A_{\\mathrm{orb}} = 1.0 $.\n     - 阈值: $ A_{\\mathrm{th}} = 0.05 $, $ f_{\\min} = 10.0 \\ \\mathrm{Hz} $, $ \\delta f = 0.5 \\ \\mathrm{Hz} $.\n   - 测试用例 $ 2 $ (标量-四极投影被抑制):\n     - $ \\omega_0 = 2\\pi \\times 8000 \\ \\mathrm{rad/s} $, $ \\omega_e = 2\\pi \\times 12000 \\ \\mathrm{rad/s} $, $ \\Omega = 2\\pi \\times 150 \\ \\mathrm{rad/s} $.\n     - 模式振幅: $ a_0 = 1.0 $, $ a_e = 0.7 $.\n     - 耦合系数: $ C_2 = 0.0 $, $ \\eta = 0.5 $, $ \\chi = 0.3 $, $ \\beta = 0.0 $.\n     - 轨道谱线振幅: $ A_{\\mathrm{orb}} = 1.0 $.\n     - 阈值: $ A_{\\mathrm{th}} = 0.05 $, $ f_{\\min} = 10.0 \\ \\mathrm{Hz} $, $ \\delta f = 0.5 \\ \\mathrm{Hz} $.\n   - 测试用例 $ 3 $ (近共振的激发模和基模):\n     - $ \\omega_0 = 2\\pi \\times 10000 \\ \\mathrm{rad/s} $, $ \\omega_e = 2\\pi \\times 10020 \\ \\mathrm{rad/s} $, $ \\Omega = 2\\pi \\times 80 \\ \\mathrm{rad/s} $.\n     - 模式振幅: $ a_0 = 0.9 $, $ a_e = 0.9 $.\n     - 耦合系数: $ C_2 = 0.5 $, $ \\eta = 0.5 $, $ \\chi = 0.4 $, $ \\beta = 0.05 $.\n     - 轨道谱线振幅: $ A_{\\mathrm{orb}} = 0.5 $.\n     - 阈值: $ A_{\\mathrm{th}} = 0.05 $, $ f_{\\min} = 50.0 \\ \\mathrm{Hz} $, $ \\delta f = 0.3 \\ \\mathrm{Hz} $.\n\n您的程序必须实现上述具有物理动机的选择和滤波过程，为所有测试用例生成一个聚合结果的单行输出，其格式需严格符合描述：一个由方括号括起的列表，其内是多个由方括号括起、逗号分隔的子列表，不含空格，且每个数值条目均以赫兹为单位四舍五入到三位小数。",
            "solution": "该问题陈述经评估为**有效**。它提出了一个定义明确的计算任务，该任务基于一个简化的、但有物理基础的玻色子星并合引力波发射模型。问题是自包含的，所有必要的参数、常数和程序规则都已明确指定。\n\n1.  **科学依据**：该模型基于已确立的物理学原理。它使用线性化广义相对论 ($GR$) 中的主导阶四极矩公式来描述引力波发射。在谐波 ($2\\omega_0, 2\\omega_e$)、和/差频 ($\\omega_e \\pm \\omega_0$) 和边带 ($2\\Omega \\pm \\omega_0, 2\\Omega \\pm \\omega_e$) 处预测谱线，是为一个具有二次非线性（标量场应力-能量张量 $T_{\\mu\\nu}$）和混合现象（轨道运动与内部振荡耦合）的系统进行引力辐射建模的直接结果。这些是物理学中微扰理论和信号分析的标准概念。\n\n2.  **适定性**：该问题是明确的。它为所有相关谱线的频率和振幅提供了具体的数学关系。滤波标准 ($A_{\\mathrm{th}}$, $f_{\\min}$) 和去重程序（排序后使用容差 $\\delta f$ 进行贪心聚类）都有明确定义，确保可以为每个测试用例计算出唯一的、确定性的解。\n\n3.  **客观性**：该问题以客观、定量的语言表述，没有主观或模糊的陈述。使用无量纲耦合系数 ($C_2, \\eta, \\chi, \\beta$) 是在简化模型中参数化复杂物理相互作用的标准且客观的方法。\n\n该问题不违反任何无效性标准。因此，有必要提供一个解决方案。\n\n解决方案是一个将所提供的物理模型转化为计算程序的算法。对于每个测试用例，此程序分三个阶段展开：候选生成、滤波和去重。\n\n**阶段 1：候选生成**\n\n首先，使用基本关系 $f = \\omega / (2\\pi)$，将以弧度/秒为单位的输入角频率 ($\\omega_0, \\omega_e, \\Omega$) 转换为以赫兹为单位的循环频率 ($f_0, f_e, F_{\\mathrm{orb}}$)。\n\n接下来，根据模型生成所有潜在谱线（频率和振幅对）的列表：\n\n-   **轨道四极谱线**：这是来自双星轨道运动的主要引力波信号。\n    -   频率：$f_{\\mathrm{orb}} = 2 F_{\\mathrm{orb}}$\n    -   振幅：$A_{\\mathrm{orb}}$ (直接提供)\n\n-   **标量自相互作用谱线**：这些谱线源于应力-能量张量 $T_{\\mu\\nu}$ 中关于标量场 $\\phi$ 的二次项。这导致了二次谐波和混合项。\n    -   基模的二次谐波：频率 $f = 2f_0$，振幅 $A_{2f_0} = C_2 a_0^2$。\n    -   激发模的二次谐波：频率 $f = 2f_e$，振幅 $A_{2f_e} = C_2 \\eta a_e^2$。因子 $\\eta$ 模拟了激发态因其径向节点而减弱的四极耦合。\n    -   和/差频：频率 $f = f_e \\pm f_0$，两者振幅均为 $A_{f_e \\pm f_0} = C_2 \\chi a_0 a_e$。频率计算为 $|f_e - f_0|$ 以确保其为正值。\n\n-   **轨道-标量边带**：这些谱线由轨道四极振荡与标量场的内部振荡的非线性混合产生。\n    -   基模的边带：频率 $f = 2 F_{\\mathrm{orb}} \\pm f_0$，振幅 $A_{2F_{\\mathrm{orb}} \\pm f_0} = \\beta C_2 a_0$。\n    -   激发模的边带：频率 $f = 2 F_{\\mathrm{orb}} \\pm f_e$，振幅 $A_{2F_{\\mathrm{orb}} \\pm f_e} = \\beta C_2 \\eta a_e$。\n    -   对于所有边带差频，都取绝对值，例如 $|2 F_{\\mathrm{orb}} - f_0|$，以确保其为正值。\n\n**阶段 2：滤波**\n\n在阶段 1 中生成的每个候选谱线都根据两个阈值进行评估：\n$1$. 谱线的振幅必须大于或等于振幅阈值，$A \\geq A_{\\mathrm{th}}$。\n$2$. 谱线的频率必须大于或等于最小频率阈值，$f \\geq f_{\\min}$。\n\n任何未能同时满足这两个标准的候选谱线都将被丢弃。\n\n**阶段 3：去重与格式化**\n\n将所有幸存谱线的频率收集到一个列表中。然后处理此列表以生成该测试用例的最终输出：\n$1$. 将频率列表按数值升序排序。\n$2$. 应用贪心聚类算法进行去重。初始化一个空的最终频率列表。将排序列表中的第一个频率添加到最终列表中。然后，算法遍历剩余的已排序频率。只有当一个频率的值超过最近添加的频率的值且差值大于容差 $\\delta f$ 时，才将其添加到最终列表中。此过程确保了位于 $\\delta f$ 带宽内的频率由单个条目（该带宽中的最低频率）表示。\n$3$. 最终去重列表中的频率按要求四舍五入到三位小数。\n\n对三个测试用例中的每一个都重复此整个过程。然后将生成的频率列表格式化为问题指定的最终单行字符串。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It processes each test case, collects the results, and prints them\n    in the specified final format.\n    \"\"\"\n    test_cases = [\n        # Test Case 1 (general excited-mode merger)\n        {\n            \"w0\": 2 * np.pi * 8000, \"we\": 2 * np.pi * 12000, \"W\": 2 * np.pi * 150,\n            \"a0\": 1.0, \"ae\": 0.7,\n            \"C2\": 0.6, \"eta\": 0.5, \"chi\": 0.3, \"beta\": 0.1,\n            \"A_orb\": 1.0,\n            \"A_th\": 0.05, \"f_min\": 10.0, \"df\": 0.5\n        },\n        # Test Case 2 (suppressed scalar-quadrupole projection)\n        {\n            \"w0\": 2 * np.pi * 8000, \"we\": 2 * np.pi * 12000, \"W\": 2 * np.pi * 150,\n            \"a0\": 1.0, \"ae\": 0.7,\n            \"C2\": 0.0, \"eta\": 0.5, \"chi\": 0.3, \"beta\": 0.0,\n            \"A_orb\": 1.0,\n            \"A_th\": 0.05, \"f_min\": 10.0, \"df\": 0.5\n        },\n        # Test Case 3 (near-resonant excited and fundamental modes)\n        {\n            \"w0\": 2 * np.pi * 10000, \"we\": 2 * np.pi * 10020, \"W\": 2 * np.pi * 80,\n            \"a0\": 0.9, \"ae\": 0.9,\n            \"C2\": 0.5, \"eta\": 0.5, \"chi\": 0.4, \"beta\": 0.05,\n            \"A_orb\": 0.5,\n            \"A_th\": 0.05, \"f_min\": 50.0, \"df\": 0.3\n        }\n    ]\n\n    results = [process_case(params) for params in test_cases]\n\n    # Format the final output string as specified: [[f1,f2],[g1],[h1,h2,...]]\n    # with no spaces and frequencies rounded to three decimal places.\n    formatted_results = []\n    for res_list in results:\n        str_freqs = [f\"{freq:.3f}\" for freq in res_list]\n        formatted_results.append(f\"[{','.join(str_freqs)}]\")\n    \n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\ndef process_case(params):\n    \"\"\"\n    Calculates the predicted spectral lines for a single test case based on\n    the provided physical model.\n    \n    Args:\n        params (dict): A dictionary containing all parameters for the test case.\n        \n    Returns:\n        list: A sorted and deduplicated list of predicted frequencies in Hz.\n    \"\"\"\n    # Unpack parameters from the dictionary for clarity\n    w0, we, W = params[\"w0\"], params[\"we\"], params[\"W\"]\n    a0, ae = params[\"a0\"], params[\"ae\"]\n    C2, eta, chi, beta = params[\"C2\"], params[\"eta\"], params[\"chi\"], params[\"beta\"]\n    A_orb = params[\"A_orb\"]\n    A_th, f_min, df = params[\"A_th\"], params[\"f_min\"], params[\"df\"]\n\n    # Convert angular frequencies (rad/s) to cyclic frequencies (Hz)\n    f0 = w0 / (2 * np.pi)\n    fe = we / (2 * np.pi)\n    F_orb = W / (2 * np.pi)\n\n    candidates = []\n\n    # 1. Orbital line from binary dynamics\n    candidates.append({'freq': 2 * F_orb, 'amp': A_orb})\n\n    # 2. Scalar quadratic lines (from T_munu being quadratic in phi)\n    if C2 > 0:\n        candidates.append({'freq': 2 * f0, 'amp': C2 * a0**2})\n        candidates.append({'freq': 2 * fe, 'amp': C2 * eta * ae**2})\n        \n        amp_sumdiff = C2 * chi * a0 * ae\n        candidates.append({'freq': fe + f0, 'amp': amp_sumdiff})\n        diff_freq = abs(fe - f0)\n        if diff_freq > 1e-9: # Avoid adding a 0 Hz line\n            candidates.append({'freq': diff_freq, 'amp': amp_sumdiff})\n\n    # 3. Sidebands from orbital-scalar mixing\n    if beta > 0 and C2 > 0:\n        amp_sb0 = beta * C2 * a0\n        candidates.append({'freq': 2 * F_orb + f0, 'amp': amp_sb0})\n        candidates.append({'freq': abs(2 * F_orb - f0), 'amp': amp_sb0})\n        \n        amp_sbe = beta * C2 * eta * ae\n        candidates.append({'freq': 2 * F_orb + fe, 'amp': amp_sbe})\n        candidates.append({'freq': abs(2 * F_orb - fe), 'amp': amp_sbe})\n\n    # Apply amplitude and frequency thresholds\n    filtered_freqs = [\n        cand['freq'] for cand in candidates \n        if cand['amp'] >= A_th and cand['freq'] >= f_min\n    ]\n\n    # Deduplicate frequencies using sorting and greedy clustering\n    if not filtered_freqs:\n        return []\n\n    filtered_freqs.sort()\n    \n    deduplicated_freqs = [filtered_freqs[0]]\n    for freq in filtered_freqs[1:]:\n        if freq - deduplicated_freqs[-1] > df:\n            deduplicated_freqs.append(freq)\n            \n    return deduplicated_freqs\n\nsolve()\n```"
        }
    ]
}