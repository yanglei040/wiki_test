{
    "hands_on_practices": [
        {
            "introduction": "理解物理自由度与规范自由度之间的区别是线性引力的核心。本练习提供了一种具体的方法来观察这一基本原理。通过对一个纯引力波进行数值规范变换，我们可以直接验证其物理内容（螺旋度为 $\\pm 2$ 的模式）保持不变，而其他非物理分量虽然被引入，但最终会在投影中被消除。这项实践强化了规范不变性的概念，并阐明了为何只有横向无迹 (TT) 张量才携带可观测的引力波信息。",
            "id": "3478825",
            "problem": "考虑平直闵可夫斯基时空中的线性化引力。设度规写作 $g_{\\mu\\nu} = \\eta_{\\mu\\nu} + h_{\\mu\\nu}$，其中 $h_{\\mu\\nu}$ 是一个小微扰。在真空中，使用洛伦兹规范条件 $\\partial^{\\mu} \\bar{h}_{\\mu\\nu} = 0$（其中 $\\bar{h}_{\\mu\\nu} = h_{\\mu\\nu} - \\tfrac{1}{2} \\eta_{\\mu\\nu} h$），线性化爱因斯坦方程简化为波动方程 $\\Box \\bar{h}_{\\mu\\nu} = 0$。在由矢量场 $\\xi_{\\mu}$ 生成的无穷小规范变换下，微扰的变换形式为 $h'_{\\mu\\nu} = h_{\\mu\\nu} + \\partial_{\\mu} \\xi_{\\nu} + \\partial_{\\nu} \\xi_{\\mu}$。对于一个沿 $z$ 方向传播的平面波，其空间波矢为 $\\mathbf{k} = k \\hat{\\mathbf{z}}$，频率为 $\\omega$，在光速 $c$ 等于 1 的单位制下 $k = \\omega$。其空间分量在傅里叶空间中的变换为 $\\delta h_{ij} = i (k_i \\xi_j + k_j \\xi_i)$。\n\n引力波的物理极化内容由 $h_{ij}$ 的横向无迹 (TT) 部分所描述。定义单位传播方向 $\\mathbf{n} = \\hat{\\mathbf{z}}$ 和横向投影算符 $P_{ij} = \\delta_{ij} - n_i n_j$。作用于空间对称张量 $h_{ij}$ 上的 TT 投影算符为\n$$\nh^{\\mathrm{TT}}_{ij} = \\left(P_{ik} h_{kl} P_{lj}\\right) - \\frac{1}{2} P_{ij} \\, \\mathrm{tr}\\left(P h P\\right).\n$$\n螺旋度态是相对于绕 $\\mathbf{n}$ 的旋转定义的。使用笛卡尔基矢 $\\{\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}\\}$，构造对应于螺旋度 $\\lambda \\in \\{+2, -2, +1, -1, 0_{\\mathrm{t}}, 0_{\\mathrm{s}}\\}$ 的六个正交归一的对称张量基元：\n- $\\lambda = +2$：\n$$\ne^{(+2)}_{ij} = \\frac{1}{2} \\left(\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j + i \\left(\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j\\right) \\right),\n$$\n- $\\lambda = -2$：\n$$\ne^{(-2)}_{ij} = \\frac{1}{2} \\left(\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j - i \\left(\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j\\right) \\right),\n$$\n- $\\lambda = +1$：\n$$\ne^{(+1)}_{ij} = \\frac{1}{2} \\left(\\hat{x}_i \\hat{z}_j + \\hat{z}_i \\hat{x}_j + i \\left(\\hat{y}_i \\hat{z}_j + \\hat{z}_i \\hat{y}_j\\right) \\right),\n$$\n- $\\lambda = -1$：\n$$\ne^{(-1)}_{ij} = \\frac{1}{2} \\left(\\hat{x}_i \\hat{z}_j + \\hat{z}_i \\hat{x}_j - i \\left(\\hat{y}_i \\hat{z}_j + \\hat{z}_i \\hat{y}_j\\right) \\right),\n$$\n- $\\lambda = 0_{\\mathrm{t}}$ (无迹轴向)：\n$$\ne^{(0_{\\mathrm{t}})}_{ij} = \\frac{1}{\\sqrt{6}} \\left(\\hat{x}_i \\hat{x}_j + \\hat{y}_i \\hat{y}_j - 2 \\hat{z}_i \\hat{z}_j \\right),\n$$\n- $\\lambda = 0_{\\mathrm{s}}$ (迹标量)：\n$$\ne^{(0_{\\mathrm{s}})}_{ij} = \\frac{1}{\\sqrt{3}} \\left(\\hat{x}_i \\hat{x}_j + \\hat{y}_i \\hat{y}_j + \\hat{z}_i \\hat{z}_j \\right).\n$$\n它们满足正交归一性条件 $\\sum_{i,j} e^{(\\lambda)}_{ij}{}^{*} e^{(\\lambda')}_{ij} = \\delta_{\\lambda \\lambda'}$，其中 ${}^{*}$ 表示复共轭。一个通用的对称 $3 \\times 3$ 张量 $h_{ij}$ 可以通过投影到该基上进行分解，其系数为 $c_{\\lambda} = \\sum_{i,j} e^{(\\lambda)}_{ij}{}^{*} h_{ij}$。\n\n从一个沿 $\\hat{\\mathbf{z}}$ 传播的横向无迹 (TT) 平面引力波微扰开始，该微扰由实振幅 $a_{+}$ (plus) 和 $a_{\\times}$ (cross) 参数化为\n$$\nh^{\\mathrm{TT}}_{ij} = a_{+} \\left(\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j\\right) + a_{\\times} \\left(\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j\\right),\n$$\n施加一个由空间矢量振幅 $\\boldsymbol{\\xi} = (\\xi_x, \\xi_y, \\xi_z)$ 在相同波矢 $\\mathbf{k} = k \\hat{\\mathbf{z}}$ 下生成的平面波规范变换，使得在傅里叶空间中\n$$\n\\delta h_{ij} = i (k_i \\xi_j + k_j \\xi_i), \\quad \\text{with} \\quad \\mathbf{k} = k \\hat{\\mathbf{z}}, \\quad k = \\omega.\n$$\n构成 $h'_{ij} = h^{\\mathrm{TT}}_{ij} + \\delta h_{ij}$，然后投影到物理内容 $h^{\\mathrm{TT}}_{\\mathrm{phys}} = \\mathrm{TT}(h'_{ij})$。将 $h^{\\mathrm{TT}}_{\\mathrm{phys}}$ 分解到螺旋度基上，并数值计算 $\\lambda = 0_{\\mathrm{s}}, 0_{\\mathrm{t}}, +1, -1$ 的系数的模长。在真空中，结论是这些模长必须为零，即规范变换不能在物理 TT 内容中产生 $\\lambda = 0, \\pm 1$ 的分量。\n\n您的任务是实现一个程序，对于一组指定的测试参数，该程序构造 $h^{\\mathrm{TT}}_{ij}$，应用规范变换 $\\delta h_{ij}$，执行 TT 投影，分解到螺旋度基上，并为每个测试用例返回一个布尔值，该值指示在非期望的螺旋度 $\\lambda \\in \\{0_{\\mathrm{s}}, 0_{\\mathrm{t}}, +1, -1\\}$ 中，系数模长的最大值是否小于容差 $\\epsilon$。使用容差 $\\epsilon = 10^{-12}$。\n\n使用以下测试套件，所有情况均沿 $\\hat{\\mathbf{z}}$ 传播，且 $k = \\omega = 1$：\n- 情况 1：$a_{+} = 1$, $a_{\\times} = 0$, $(\\xi_x, \\xi_y, \\xi_z) = (0.3, -0.25, 0.1)$.\n- 情况 2：$a_{+} = -0.7$, $a_{\\times} = 1.1$, $(\\xi_x, \\xi_y, \\xi_z) = (2.0, 3.0, -1.0)$.\n- 情况 3：$a_{+} = 0$, $a_{\\times} = 0$, $(\\xi_x, \\xi_y, \\xi_z) = (5.0, -4.0, 2.0)$.\n- 情况 4：$a_{+} = 1 \\times 10^{-12}$, $a_{\\times} = -1 \\times 10^{-12}$, $(\\xi_x, \\xi_y, \\xi_z) = (1 \\times 10^{6}, -1 \\times 10^{6}, 1 \\times 10^{6})$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $\\texttt{[result1,result2,result3,result4]}$，其中每个 $\\texttt{result}$ 是 $\\texttt{True}$ 或 $\\texttt{False}$，取决于相应测试用例中非期望的螺旋度模长是否低于 $\\epsilon$。本问题中不需要物理单位。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上是合理的、自洽的且定义明确。它提出了一个在线性化广义相对论框架内的标准、可验证的问题。\n\n核心任务是数值验证线性化引力的一个基本原理：无穷小规范变换虽然会改变度规微扰分量 $h_{ij}$，但不会改变引力波的物理、规范不变内容。物理内容完全由度规微扰的横向无迹 (TT) 部分所描述，这对应于无质量自旋-2场的螺旋度 $\\lambda=\\pm 2$ 模式。\n\n在概述数值实现之前，我们首先对这一原理进行解析确认。\n\n一个广义的无穷小坐标变换 $x'^{\\mu} = x^{\\mu} - \\xi^{\\mu}(x)$ 引起的度规微扰变化为 $\\delta h_{\\mu\\nu} = \\mathcal{L}_{\\xi} g_{\\mu\\nu} \\approx \\partial_{\\mu}\\xi_{\\nu} + \\partial_{\\nu}\\xi_{\\mu}$，其中 $\\mathcal{L}_{\\xi}$ 是沿矢量场 $\\xi^{\\mu}$ 的李导数。对于一个四维波矢为 $k^{\\mu}$ 的平面波，其生成场也可以写成平面波形式 $\\xi_{\\mu}(x) = \\xi_{\\mu} e^{i k_{\\alpha}x^{\\alpha}}$，其中右侧的 $\\xi_{\\mu}$ 是常数振幅矢量。因此，在傅里叶空间中，偏导数变为乘以 $i k_{\\mu}$。因此，度规微扰的空间分量变化为 $\\delta h_{ij} = i (k_i \\xi_j + k_j \\xi_i)$。\n\n问题陈述指出，这个规范部分 $\\delta h_{ij}$ 不应对最终的物理张量 $h^{\\mathrm{TT}}_{\\mathrm{phys}}$ 有贡献。物理张量是通过将 TT 投影算符应用于完整微扰 $h'_{ij} = h^{\\mathrm{TT}}_{ij} + \\delta h_{ij}$ 得到的。TT 投影算符是线性的，因此我们有：\n$$\nh^{\\mathrm{TT}}_{\\mathrm{phys}} = \\mathrm{TT}(h'_{ij}) = \\mathrm{TT}(h^{\\mathrm{TT}}_{ij} + \\delta h_{ij}) = \\mathrm{TT}(h^{\\mathrm{TT}}_{ij}) + \\mathrm{TT}(\\delta h_{ij})\n$$\n初始张量 $h^{\\mathrm{TT}}_{ij}$ 根据定义已经是横向且无迹的。对于这样的张量，TT 投影是一个恒等操作，即 $\\mathrm{TT}(h^{\\mathrm{TT}}_{ij}) = h^{\\mathrm{TT}}_{ij}$。因此，核心论点等价于证明规范项的 TT 投影为零：\n$$\n\\mathrm{TT}(\\delta h_{ij}) = 0\n$$\n我们来证明这一点。设 $S_{ij} = k_i \\xi_j + k_j \\xi_i$。$iS_{ij}$ 的 TT 投影定义为：\n$$\n\\mathrm{TT}(iS_{ij}) = i \\left[ \\left(P_{ik} S_{kl} P_{lj}\\right) - \\frac{1}{2} P_{ij} \\, \\mathrm{tr}\\left(P S P\\right) \\right]\n$$\n波沿 $\\hat{\\mathbf{z}}$ 方向传播，因此单位传播矢量为 $\\mathbf{n} = (0, 0, 1)$，空间波矢为 $\\mathbf{k} = k \\mathbf{n}$，这意味着 $k_i = k n_i$。横向投影算符为 $P_{ij} = \\delta_{ij} - n_i n_j$。横向投影算符的一个关键性质是它会湮灭任何与 $\\mathbf{n}$ 共线的矢量，例如 $\\mathbf{k}$：$P_{ij} k_j = P_{ij} (k n_j) = k(P_{ij} n_j) = k(\\delta_{ij}n_j - n_i(n_j n_j)) = k(n_i - n_i) = 0$。\n\n我们来计算 $P_{ik} S_{kl}$ 项：\n$$\nP_{ik} S_{kl} = P_{ik} (k_k \\xi_l + k_l \\xi_k) = (P_{ik} k_k) \\xi_l + k_l (P_{ik} \\xi_k)\n$$\n由于 $P_{ik} k_k = 0$，第一项为零。我们剩下：\n$$\nP_{ik} S_{kl} = k_l (P_{ik} \\xi_k) = (k n_l) (P_{ik} \\xi_k)\n$$\n现在，我们计算完整的横向部分，$(PSP)_{ij} = (P S)_{il} P_{lj}$：\n$$\n(P S P)_{ij} = \\left[ (k n_l) (P_{ik} \\xi_k) \\right] P_{lj} = (k P_{ik} \\xi_k) (n_l P_{lj})\n$$\n我们再次使用相同的性质：$n_l P_{lj} = n_l (\\delta_{lj} - n_l n_j) = n_j - (n_l n_l)n_j = n_j - n_j = 0$。\n因此，$(P S P)_{ij} = 0$。规范项的横向部分恒等于零。这立即意味着它的迹也为零，$\\mathrm{tr}(PSP) = 0$。\n将此代入 TT 投影公式可得：\n$$\n\\mathrm{TT}(\\delta h_{ij}) = i [ 0 - \\frac{1}{2} P_{ij} \\cdot 0 ] = 0\n$$\n这从解析上证实了规范变换项被完全投影掉了。因此，最终的物理张量与初始张量相同：\n$$\nh^{\\mathrm{TT}}_{\\mathrm{phys}} = h^{\\mathrm{TT}}_{ij}\n$$\n初始张量 $h^{\\mathrm{TT}}_{ij}$ 是由 plus ($e^{+}_{ij} = \\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j$) 和 cross ($e^{\\times}_{ij} = \\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j$) 极化张量的线性组合构成的。这些可以用螺旋度 $\\pm 2$ 的基张量表示：\n$$\ne^{+}_{ij} = e^{(+2)}_{ij} + e^{(-2)}_{ij} \\quad \\text{and} \\quad e^{\\times}_{ij} = -i(e^{(+2)}_{ij} - e^{(-2)}_{ij})\n$$\n这意味着 $h^{\\mathrm{TT}}_{ij}$ 完全由螺旋度 $\\lambda=\\pm 2$ 的模式构成。螺旋度基是正交归一的，所以当我们将 $h^{\\mathrm{TT}}_{ij}$ 投影到这个基上进行分解时，系数 $c_{\\lambda} = \\sum_{i,j} e^{(\\lambda)}_{ij}{}^{*} h^{\\mathrm{TT}}_{ij}$ 将仅在 $\\lambda = \\pm 2$ 时非零。对于任何其他螺旋度 $\\lambda \\in \\{+1, -1, 0_{\\mathrm{t}}, 0_{\\mathrm{s}}\\}$，由于正交性，系数 $c_{\\lambda}$ 必须精确为零。\n\n数值计算过程将涉及浮点运算，因此计算出的非期望螺旋度的系数预计会接近于零，处于机器精度的量级，而不是精确为零。问题正确地要求检查它们的模长是否小于一个小的容差 $\\epsilon = 10^{-12}$。\n\n要实现的算法如下：\n1. 对于每个测试用例 $(a_{+}, a_{\\times}, \\boldsymbol{\\xi})$：\n2. 定义笛卡尔基矢 $\\hat{\\mathbf{x}}, \\hat{\\mathbf{y}}, \\hat{\\mathbf{z}}$ 和波矢 $\\mathbf{k} = (0, 0, 1)$。\n3. 构造初始实张量 $h^{\\mathrm{TT}}_{ij} = a_{+} (\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j) + a_{\\times} (\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j)$。\n4. 构造复规范变换张量 $\\delta h_{ij} = i (k_i \\xi_j + k_j \\xi_i)$。\n5. 形成变换后的张量 $h'_{ij} = h^{\\mathrm{TT}}_{ij} + \\delta h_{ij}$。\n6. 构造横向投影算符 $P_{ij} = \\delta_{ij} - n_i n_j$，其中 $\\mathbf{n} = \\mathbf{k}$。\n7. 对 $h'_{ij}$ 应用 TT 投影以求得 $h^{\\mathrm{TT}}_{\\mathrm{phys}} = (P h' P)_{ij} - \\frac{1}{2} P_{ij} \\mathrm{tr}(P h' P)$。\n8. 构造 $\\lambda \\in \\{+1, -1, 0_{\\mathrm{t}}, 0_{\\mathrm{s}}\\}$ 的基张量 $e^{(\\lambda)}_{ij}$。\n9. 对于每个“非期望的”螺旋度模式，计算投影系数的模长：$| c_{\\lambda} | = |\\sum_{i,j} e^{(\\lambda)}_{ij}{}^{*} (h^{\\mathrm{TT}}_{\\mathrm{phys}})_{ij}|$。\n10. 找出这些系数中的最大模长，并检查它是否小于 $\\epsilon = 10^{-12}$。测试用例的结果即为这个布尔值。\n根据解析证明，所有测试用例的预期结果均为 `True`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the gravitational wave gauge transformation problem.\n\n    Numerically verifies that gauge transformations on a Transverse-Traceless (TT)\n    plane wave do not introduce physical content into non-TT helicity modes\n    after TT projection.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a_plus, a_cross, (xi_x, xi_y, xi_z))\n        (1.0, 0.0, (0.3, -0.25, 0.1)),\n        (-0.7, 1.1, (2.0, 3.0, -1.0)),\n        (0.0, 0.0, (5.0, -4.0, 2.0)),\n        (1e-12, -1e-12, (1e6, -1e6, 1e6)),\n    ]\n    \n    # Define tolerance\n    epsilon = 1e-12\n    \n    # Define Cartesian basis vectors\n    x_hat = np.array([1., 0., 0.])\n    y_hat = np.array([0., 1., 0.])\n    z_hat = np.array([0., 0., 1.])\n    \n    # Define wavevector k (k=1, propagating along z)\n    k_vec = z_hat.copy()\n    n_vec = k_vec.copy()\n\n    # Construct the helicity basis tensors\n    e_p2 = 0.5 * (np.outer(x_hat, x_hat) - np.outer(y_hat, y_hat) + 1j * (np.outer(x_hat, y_hat) + np.outer(y_hat, x_hat)))\n    e_m2 = e_p2.conj()\n    e_p1 = 0.5 * (np.outer(x_hat, z_hat) + np.outer(z_hat, x_hat) + 1j * (np.outer(y_hat, z_hat) + np.outer(z_hat, y_hat)))\n    e_m1 = e_p1.conj()\n    e_0t = (1. / np.sqrt(6.)) * (np.outer(x_hat, x_hat) + np.outer(y_hat, y_hat) - 2. * np.outer(z_hat, z_hat))\n    e_0s = (1. / np.sqrt(3.)) * np.identity(3)\n    \n    # Select the \"unwanted\" helicity modes to check against\n    unwanted_basis_tensors = {\n        \"0s\": e_0s,\n        \"0t\": e_0t,\n        \"+1\": e_p1,\n        \"-1\": e_m1,\n    }\n\n    # Construct the transverse projector P_ij = delta_ij - n_i n_j\n    P = np.identity(3) - np.outer(n_vec, n_vec)\n\n    results = []\n    for case in test_cases:\n        a_plus, a_cross, xi = case\n        xi_vec = np.array(xi)\n        \n        # 1. Construct the initial Transverse-Traceless (TT) tensor h_TT\n        e_plus = np.outer(x_hat, x_hat) - np.outer(y_hat, y_hat)\n        e_cross = np.outer(x_hat, y_hat) + np.outer(y_hat, x_hat)\n        h_TT = a_plus * e_plus + a_cross * e_cross\n        \n        # 2. Construct the gauge transformation term delta_h\n        # delta_h_ij = i * (k_i * xi_j + k_j * xi_i)\n        delta_h = 1j * (np.outer(k_vec, xi_vec) + np.outer(xi_vec, k_vec))\n\n        # 3. Form the new tensor h_prime\n        h_prime = h_TT + delta_h\n\n        # 4. Perform the TT projection on h_prime\n        # T(h) = (P h P) - 1/2 * P * tr(P h P)\n        PhP = P @ h_prime @ P\n        tr_PhP = np.trace(PhP)\n        h_TT_phys = PhP - 0.5 * P * tr_PhP\n\n        # 5. Decompose the physical tensor onto the unwanted helicity basis\n        unwanted_magnitudes = []\n        for key, e_lambda in unwanted_basis_tensors.items():\n            # Coefficient c_lambda = sum_{i,j} e_lambda^*_{ij} * h_phys_{ij}\n            # This is the Frobenius inner product: tr(A^H B)\n            c_lambda = np.sum(e_lambda.conj() * h_TT_phys)\n            unwanted_magnitudes.append(np.abs(c_lambda))\n            \n        # 6. Check if the maximum magnitude is below the tolerance\n        max_mag = np.max(unwanted_magnitudes)\n        is_below_tolerance = max_mag  epsilon\n        results.append(is_below_tolerance)\n\n    # Final print statement in the exact required format.\n    # The output format for booleans in Python's str() is 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在理想的连续理论基础上，这项实践将我们带入数值模拟的现实挑战。虽然规范约束在连续理论中是精确满足的，但离散化不可避免地会引入误差。本练习旨在量化有限差分近似如何违反洛伦兹规范条件。通过这项动手操作，你将探索数值精度（例如，差分格式的阶数）与这些非物理规范误差的增长之间的关系，这对于在数值相对论模拟中诊断和控制伪影至关重要。",
            "id": "3478829",
            "problem": "考虑在闵可夫斯基背景上的线性化引力，其度规为 $\\,\\eta_{\\mu\\nu}=\\mathrm{diag}(-1,+1,+1,+1)\\,$，指标 $\\,\\mu,\\nu\\in\\{0,1,2,3\\}\\,$，其中 $\\,0\\,$ 表示时间，$\\,1\\,$ 表示数值求解的单一空间维度。令反迹度规微扰为 $\\,\\bar h_{\\mu\\nu}=h_{\\mu\\nu}-\\frac{1}{2}\\eta_{\\mu\\nu}h\\,$，其中 $\\,h=\\eta^{\\alpha\\beta}h_{\\alpha\\beta}\\,$。由规范矢量 $\\,\\xi_\\mu\\,$ 生成的纯规范微扰具有以下形式：\n$$\n\\bar h_{\\mu\\nu}=-\\partial_\\mu\\xi_\\nu-\\partial_\\nu\\xi_\\mu+\\eta_{\\mu\\nu}\\,\\partial^\\alpha\\xi_\\alpha,\n$$\n其洛伦兹规范约束为 $\\,\\partial^\\mu\\bar h_{\\mu\\nu}=0\\,$，其中 $\\,\\partial^\\mu=\\eta^{\\mu\\alpha}\\partial_\\alpha\\,$。在连续谱下，经过一次规范变换，我们有\n$$\n\\partial^\\mu\\bar h'_{\\mu\\nu}=\\partial^\\mu\\bar h_{\\mu\\nu}-\\Box\\,\\xi_\\nu,\n$$\n因此从 $\\,\\bar h_{\\mu\\nu}=0\\,$ 出发并选择满足 $\\,\\Box\\,\\xi_\\nu=0\\,$ 的 $\\,\\xi_\\nu\\,$，将精确地得到 $\\,\\partial^\\mu\\bar h_{\\mu\\nu}=0\\,$。\n\n在本任务中，您将量化在一维周期性区域中，由有限差分近似和可选滤波引起的洛伦兹规范 $\\,\\partial^\\mu\\bar h_{\\mu\\nu}=0\\,$ 的离散违背程度。使用一个由单一非零规范分量 $\\,\\xi_1(t,x)\\,$ 构造的纯规范构型，且 $\\,\\xi_0=\\xi_2=\\xi_3=0\\,$。选择\n$$\n\\xi_1(t,x)=A\\cos(k\\,x-\\omega\\,t),\n$$\n其中 $\\,A=1\\,$，$\\,\\omega=|k|\\,$，光速 $\\,c=1\\,$，空间区域为周期性 $\\,x\\in[0,2\\pi)\\,$。在连续谱下，当 $\\,\\omega=|k|\\,$ 时，$\\,\\Box\\,\\xi_1=0\\,$，因此 $\\,\\partial^\\mu\\bar h_{\\mu\\nu}=0\\,$。\n\n使用 $\\,N\\,$ 个均匀间隔的网格点将空间离散化，$\\,\\Delta x=2\\pi/N\\,$，并使用 $\\,p\\in\\{2,4,6\\}\\,$ 阶的中心有限差分来近似空间导数：\n- 一阶导数 $\\,\\partial_x u\\,$：\n  - 对于 $\\,p=2\\,$：$\\,D_x^{(2)}u_i=\\dfrac{u_{i+1}-u_{i-1}}{2\\,\\Delta x}\\,$.\n  - 对于 $\\,p=4\\,$：$\\,D_x^{(4)}u_i=\\dfrac{-u_{i+2}+8u_{i+1}-8u_{i-1}+u_{i-2}}{12\\,\\Delta x}\\,$.\n  - 对于 $\\,p=6\\,$：$\\,D_x^{(6)}u_i=\\dfrac{-u_{i+3}+9u_{i+2}-45u_{i+1}+45u_{i-1}-9u_{i-2}+u_{i-3}}{60\\,\\Delta x}\\,$.\n- 二阶导数 $\\,\\partial_x^2 u\\,$：\n  - 对于 $\\,p=2\\,$：$\\,D_{xx}^{(2)}u_i=\\dfrac{u_{i-1}-2u_i+u_{i+1}}{\\Delta x^2}\\,$.\n  - 对于 $\\,p=4\\,$：$\\,D_{xx}^{(4)}u_i=\\dfrac{-u_{i-2}+16u_{i-1}-30u_i+16u_{i+1}-u_{i+2}}{12\\,\\Delta x^2}\\,$.\n  - 对于 $\\,p=6\\,$：$\\,D_{xx}^{(6)}u_i=\\dfrac{2u_{i-3}-27u_{i-2}+270u_{i-1}-490u_i+270u_{i+1}-27u_{i+2}+2u_{i+3}}{180\\,\\Delta x^2}\\,$.\n使用周期性环绕索引。\n\n使用中心差分来近似时间导数，其中 $\\,\\Delta t=\\mathrm{CFL}\\cdot\\Delta x\\,$，$\\,\\mathrm{CFL}=0.4\\,$。令评估时间为 $\\,t_n=T\\,$，并使用三个时间层：$\\,t_{n-1}=T-\\Delta t\\,$、$\\,t_n=T\\,$ 和 $\\,t_{n+1}=T+\\Delta t\\,$。定义离散时间导数\n$$\n\\partial_t u\\big|_{t_n}\\approx \\frac{u(t_{n+1})-u(t_{n-1})}{2\\,\\Delta t},\\qquad\n\\partial_t^2 u\\big|_{t_n}\\approx \\frac{u(t_{n+1})-2\\,u(t_n)+u(t_{n-1})}{\\Delta t^2}.\n$$\n\n可选择在每个时间快照上应用一次单次 Kreiss–Oliger (KO) 滤波器，以模拟数值耗散。定义 KO 算子\n$$\nQ(u)_i=u_{i-3}-6u_{i-2}+15u_{i-1}-20u_i+15u_{i+1}-6u_{i+2}+u_{i+3},\n$$\n使用周期性索引，滤波后的场为 $\\,u\\leftarrow u-\\sigma\\,Q(u)\\,$，其中 $\\,\\sigma\\ge 0\\,$ 是一个无量纲的滤波强度。当 $\\,\\sigma=0\\,$ 时，不应用滤波。\n\n构建 $\\,\\xi_1\\,$ 的离散反迹纯规范分量：\n$$\n\\bar h_{00}=-\\partial_x \\xi_1,\\quad \\bar h_{01}=\\bar h_{10}=-\\partial_t \\xi_1,\\quad \\bar h_{11}=-\\partial_x \\xi_1,\n$$\n所有其他的 $\\,\\bar h_{\\mu\\nu}\\,$ 分量均为零。计算在 $\\,t_n=T\\,$ 时的离散洛伦兹规范散度分量：\n$$\n\\mathcal{G}_0=-\\partial_t \\bar h_{00}+\\partial_x \\bar h_{10},\\qquad\n\\mathcal{G}_1=-\\partial_t \\bar h_{01}+\\partial_x \\bar h_{11}=\\partial_t^2\\xi_1-\\partial_x^2\\xi_1.\n$$\n将违背的量级测量为网格上的均方根 (RMS)，\n$$\n\\mathcal{V}=\\sqrt{\\left\\langle \\mathcal{G}_0^2+\\mathcal{G}_1^2\\right\\rangle},\n$$\n其中 $\\,\\langle\\cdot\\rangle\\,$ 表示对所有网格点的平均。所有量均为无量纲。\n\n实现一个程序，对于每个指定的测试用例，该程序在三个时间层上构建 $\\,\\xi_1\\,$，应用可选的 KO 滤波器，使用指定的模板阶数计算离散导数，形成 $\\,\\bar h_{\\mu\\nu}\\,$，评估 $\\,\\mathcal{G}_\\nu\\,$ 并返回 $\\,\\mathcal{V}\\,$。\n\n使用以下测试套件，最终时间 $\\,T=2\\pi\\,$，波数 $\\,k=8\\,$：\n- 测试 $\\,1\\,$：$\\,N=64\\,$, $\\,p=2\\,$, $\\,\\sigma=0.0\\,$.\n- 测试 $\\,2\\,$：$\\,N=64\\,$, $\\,p=4\\,$, $\\,\\sigma=0.0\\,$.\n- 测试 $\\,3\\,$：$\\,N=64\\,$, $\\,p=6\\,$, $\\,\\sigma=0.0\\,$.\n- 测试 $\\,4\\,$：$\\,N=64\\,$, $\\,p=4\\,$, $\\,\\sigma=0.02\\,$.\n- 测试 $\\,5\\,$：$\\,N=64\\,$, $\\,p=4\\,$, $\\,\\sigma=0.05\\,$.\n- 测试 $\\,6\\,$：$\\,N=256\\,$, $\\,p=2\\,$, $\\,\\sigma=0.0\\,$.\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如 $\\,\\left[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3\\right]\\,$），其中每个 $\\,\\mathrm{result}_i\\,$ 是对应测试用例的浮点数 $\\,\\mathcal{V}\\,$，以十进制数表示。不涉及任何物理单位。",
            "solution": "该问题是有效的。它提出了一个数值相对论中定义明确的任务：量化由于数值离散化导致的守恒律（洛伦兹规范条件）的违背。所有参数、方程和离散化方案都得到了明确的指定，从而可以得到唯一且可验证的解。其物理和数学框架是研究线性化引力和偏微分方程数值方法中的标准内容。\n\n问题的核心是计算在离散化时空网格上，纯规范度规微扰 $\\bar{h}_{\\mu\\nu}$ 的洛伦兹规范散度 $\\mathcal{G}_\\nu = \\partial^\\mu \\bar{h}_{\\mu\\nu}$ 的离散表示。在连续谱下，对于指定的规范矢量 $\\xi_\\mu$，该散度恒等于零。由于导数的有限差分近似所产生的截断误差，以及（可选的）数值滤波器的应用，数值结果将不为零。\n\n分析在 (1+1) 维时空中进行，坐标为 $(t,x)$，即一个时间坐标 $t$ 和一个单一周期性空间坐标 $x \\in [0, 2\\pi)$。背景度规为 $\\eta_{\\mu\\nu} = \\mathrm{diag}(-1, +1)$。纯规范构型由矢量 $\\xi_\\mu = (0, \\xi_1(t,x), 0, 0)$ 生成，除了第一个空间分量外，其他分量均为零。其具体形式为 $\\xi_1(t,x) = A\\cos(k x - \\omega t)$，其中 $A=1$ 且 $\\omega=|k|$，以满足连续谱波动方程 $\\Box \\xi_1 = (-\\partial_t^2 + \\partial_x^2)\\xi_1 = 0$。\n\n反迹度规微扰 $\\bar{h}_{\\mu\\nu}$ 的非零分量给出如下：\n$$\n\\bar{h}_{00} = -\\partial_x \\xi_1, \\quad \\bar{h}_{01} = \\bar{h}_{10} = -\\partial_t \\xi_1, \\quad \\bar{h}_{11} = -\\partial_x \\xi_1\n$$\n洛伦兹规范散度有两个非平凡分量 $\\mathcal{G}_0$ 和 $\\mathcal{G}_1$，需要在特定时间 $t_n=T$ 在一个包含 $N$ 个点的均匀空间网格上计算它们。\n$$\n\\mathcal{G}_0 = -\\partial_t \\bar{h}_{00} + \\partial_x \\bar{h}_{10} \\\\\n\\mathcal{G}_1 = -\\partial_t \\bar{h}_{01} + \\partial_x \\bar{h}_{11}\n$$\n让我们在离散层面上分析这些分量，使用 $D_t$ 和 $D_{tt}$ 表示离散的一阶和二阶时间导数，使用 $D_x^{(p)}$ 和 $D_{xx}^{(p)}$ 表示 $p$ 阶离散空间导数。\n\n对于 $\\mathcal{G}_1$，代入 $\\bar{h}_{01}$ 和 $\\bar{h}_{11}$ 的表达式：\n$$\n\\mathcal{G}_1 = -\\partial_t (-\\partial_t \\xi_1) + \\partial_x (-\\partial_x \\xi_1) = \\partial_t^2 \\xi_1 - \\partial_x^2 \\xi_1\n$$\n其离散对应项在时间 $t_n=T$ 的每个网格点 $x_i$ 上计算：\n$$\n(\\mathcal{G}_1)_i = D_{tt}(\\xi_1)_i - D_{xx}^{(p)}(\\xi_1)_i = \\frac{\\xi_1(t_{n+1}, x_i) - 2\\xi_1(t_n, x_i) + \\xi_1(t_{n-1}, x_i)}{\\Delta t^2} - D_{xx}^{(p)}(\\boldsymbol{\\xi}_1^n)_i\n$$\n其中 $\\boldsymbol{\\xi}_1^n$ 是时间 $t_n$ 时空间网格上 $\\xi_1$ 值的矢量。该表达式是作用于 $\\xi_1$ 的波动方程算子的离散模拟。由于离散算子引入了截断误差，该项将不为零。\n\n对于 $\\mathcal{G}_0$，代入 $\\bar{h}_{00}$ 和 $\\bar{h}_{10}$ 的表达式：\n$$\n\\mathcal{G}_0 = -\\partial_t (-\\partial_x \\xi_1) + \\partial_x (-\\partial_t \\xi_1) = \\partial_t\\partial_x \\xi_1 - \\partial_x\\partial_t \\xi_1\n$$\n在连续谱下，根据偏导数的可交换性，此项为零。让我们研究其离散版本。离散算子 $D_t$ 和 $D_x^{(p)}$ 是线性的。按规定的顺序应用它们：\n$$\n(\\mathcal{G}_0)_i = -D_t(\\bar{\\mathbf{h}}_{00})_i + D_x^{(p)}(\\bar{\\mathbf{h}}_{10})_i\n$$\n这里，$\\bar{\\mathbf{h}}_{10} = -D_t(\\boldsymbol{\\xi}_1)$，并且我们需要在时间 $t_{n-1}$ 和 $t_{n+1}$ 的 $\\bar{\\mathbf{h}}_{00}$ 来计算其时间导数。因此，$\\bar{\\mathbf{h}}_{00}^{n\\pm1} = -D_x^{(p)}(\\boldsymbol{\\xi}_1^{n\\pm1})$。\n$$\n(\\mathcal{G}_0)_i = -\\frac{(\\bar{\\mathbf{h}}_{00}^{n+1})_i - (\\bar{\\mathbf{h}}_{00}^{n-1})_i}{2\\Delta t} + D_x^{(p)}( (-D_t(\\boldsymbol{\\xi}_1))_i )\n$$\n$$\n(\\mathcal{G}_0)_i = -\\frac{[-D_x^{(p)}(\\boldsymbol{\\xi}_1^{n+1})]_i - [-D_x^{(p)}(\\boldsymbol{\\xi}_1^{n-1})]_i}{2\\Delta t} + D_x^{(p)}\\left(-\\frac{\\boldsymbol{\\xi}_1^{n+1} - \\boldsymbol{\\xi}_1^{n-1}}{2\\Delta t}\\right)_i\n$$\n由于 $D_x^{(p)}$ 算子的线性性质，这两项大小相等、方向相反：\n$$\n(\\mathcal{G}_0)_i = \\frac{1}{2\\Delta t} D_x^{(p)}(\\boldsymbol{\\xi}_1^{n+1} - \\boldsymbol{\\xi}_1^{n-1})_i - \\frac{1}{2\\Delta t} D_x^{(p)}(\\boldsymbol{\\xi}_1^{n+1} - \\boldsymbol{\\xi}_1^{n-1})_i = 0\n$$\n因此，离散分量 $\\mathcal{G}_0$ 恒等于零。整个规范违背完全来自于 $\\mathcal{G}_1$。\n\n总违背量级 $\\mathcal{V}$ 简化为 $\\mathcal{G}_1$ 的均方根 (RMS)：\n$$\n\\mathcal{V} = \\sqrt{\\langle \\mathcal{G}_0^2 + \\mathcal{G}_1^2 \\rangle} = \\sqrt{\\langle \\mathcal{G}_1^2 \\rangle} = \\sqrt{\\frac{1}{N}\\sum_{i=0}^{N-1} (\\mathcal{G}_1)_i^2}\n$$\n\n可选的 Kreiss-Oliger (KO) 滤波步骤 $u \\leftarrow u - \\sigma Q(u)$，在计算任何导数之前，应用于所需三个时间层（$t_{n-1}, t_n, t_{n+1}$）中每一个的 $\\xi_1$ 数据。此步骤会引入耗散，这可能影响整体计算的准确性，从而改变测量的违背量级 $\\mathcal{V}$。\n\n解决该问题的算法如下：\n1. 对于由（$N, p, \\sigma$）指定的每个测试用例：\n2. 设置常数：$T=2\\pi$， $k=8$， $\\omega=|k|=8$， $A=1$ 和 $\\mathrm{CFL}=0.4$。\n3. 定义空间网格：$\\Delta x = 2\\pi/N$ 和 $x_i = i\\Delta x$ 对于 $i=0, \\dots, N-1$。\n4. 定义时间离散化：$\\Delta t = \\mathrm{CFL} \\cdot \\Delta x$。在时间层 $t_n=T$、$t_{n-1}=T-\\Delta t$ 和 $t_{n+1}=T+\\Delta t$ 进行评估。\n5. 在三个时间层中的每一个上生成网格函数 $\\xi_1(t,x)$，创建三个数组：$\\boldsymbol{\\xi}_1^{n-1}$、$\\boldsymbol{\\xi}_1^{n}$ 和 $\\boldsymbol{\\xi}_1^{n+1}$。\n6. 如果滤波强度 $\\sigma > 0$，则对这三个数组中的每一个应用 KO 滤波器算子。算子 $Q$ 使用周期性边界条件实现。\n7. 使用三个（可能已滤波的）时间层数组计算离散二阶时间导数 $D_{tt}(\\boldsymbol{\\xi}_1)$。\n8. 使用指定的 p 阶模板，对时间 $t_n$ 的（可能已滤波的）数据计算离散二阶空间导数 $D_{xx}^{(p)}(\\boldsymbol{\\xi}_1^{n})$。模板使用周期性索引实现。\n9. 计算规范违背分量 $\\boldsymbol{\\mathcal{G}}_1 = D_{tt}(\\boldsymbol{\\xi}_1) - D_{xx}^{(p)}(\\boldsymbol{\\xi}_1^{n})$。\n10. 计算最终违背量级 $\\mathcal{V}$ 为矢量 $\\boldsymbol{\\mathcal{G}}_1$ 的 RMS。\n11. 收集所有测试用例的 $\\mathcal{V}$ 值。\n\n此过程将使用 Python 的 `numpy` 库来实现，以进行高效的数组操作。将为空间导数算子和 KO 滤波器定义辅助函数，并使用 `numpy.roll` 来处理区域的周期性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef apply_ko_filter(u, sigma):\n    \"\"\"Applies the Kreiss-Oliger filter to a 1D array with periodic boundaries.\"\"\"\n    # Q(u)_i = u_{i-3}-6u_{i-2}+15u_{i-1}-20u_i+15u_{i+1}-6u_{i+2}+u_{i+3}\n    q_u = (np.roll(u, 3) - 6 * np.roll(u, 2) + 15 * np.roll(u, 1) - 20 * u +\n           15 * np.roll(u, -1) - 6 * np.roll(u, -2) + np.roll(u, -3))\n    return u - sigma * q_u\n\ndef dxx_2(u, dx):\n    \"\"\"Computes the 2nd-order centered finite difference for the second derivative.\"\"\"\n    # (u_{i-1} - 2u_i + u_{i+1}) / dx^2\n    return (np.roll(u, 1) - 2 * u + np.roll(u, -1)) / (dx**2)\n\ndef dxx_4(u, dx):\n    \"\"\"Computes the 4th-order centered finite difference for the second derivative.\"\"\"\n    # (-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}) / (12dx^2)\n    return (-np.roll(u, 2) + 16 * np.roll(u, 1) - 30 * u + 16 * np.roll(u, -1) - np.roll(u, -2)) / (12 * dx**2)\n\ndef dxx_6(u, dx):\n    \"\"\"Computes the 6th-order centered finite difference for the second derivative.\"\"\"\n    # (2u_{i-3} - 27u_{i-2} + 270u_{i-1} - 490u_i + 270u_{i+1} - 27u_{i+2} + 2u_{i+3}) / (180dx^2)\n    return (2 * np.roll(u, 3) - 27 * np.roll(u, 2) + 270 * np.roll(u, 1) - 490 * u +\n            270 * np.roll(u, -1) - 27 * np.roll(u, -2) + 2 * np.roll(u, -3)) / (180 * dx**2)\n\ndef calculate_violation(N, p, sigma, T, k, cfl):\n    \"\"\"\n    Calculates the discrete Lorenz gauge violation for a given test case.\n    \"\"\"\n    # Constants\n    A = 1.0\n    omega = float(k)  # omega = |k| since c=1\n\n    # Spatial grid setup\n    dx = 2.0 * np.pi / N\n    x = np.linspace(0.0, 2.0 * np.pi, N, endpoint=False)\n\n    # Time grid setup\n    dt = cfl * dx\n    t_n = T\n    t_nm1 = T - dt\n    t_np1 = T + dt\n\n    # Evaluate xi_1 at the three time levels\n    xi1_tm1 = A * np.cos(k * x - omega * t_nm1)\n    xi1_t = A * np.cos(k * x - omega * t_n)\n    xi1_tp1 = A * np.cos(k * x - omega * t_np1)\n\n    # Apply KO filter if requested\n    if sigma > 0.0:\n        xi1_tm1 = apply_ko_filter(xi1_tm1, sigma)\n        xi1_t = apply_ko_filter(xi1_t, sigma)\n        xi1_tp1 = apply_ko_filter(xi1_tp1, sigma)\n\n    # As derived in the solution, G_0 is numerically zero.\n    # The violation comes entirely from G_1 = d^2_t(xi_1) - d^2_x(xi_1).\n\n    # Compute second time derivative: D_tt(xi_1)\n    dtt_xi1 = (xi1_tp1 - 2.0 * xi1_t + xi1_tm1) / (dt**2)\n\n    # Compute second spatial derivative: D_xx(xi_1)\n    if p == 2:\n        dxx_xi1 = dxx_2(xi1_t, dx)\n    elif p == 4:\n        dxx_xi1 = dxx_4(xi1_t, dx)\n    elif p == 6:\n        dxx_xi1 = dxx_6(xi1_t, dx)\n    else:\n        raise ValueError(f\"Unsupported finite difference order p={p}\")\n\n    # Compute G_1\n    G1 = dtt_xi1 - dxx_xi1\n    \n    # The violation magnitude is the RMS of G_1\n    violation_rms = np.sqrt(np.mean(G1**2))\n    \n    return violation_rms\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Global parameters for all tests\n    T_final = 2.0 * np.pi\n    k_wavenumber = 8.0\n    CFL_factor = 0.4\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, p, sigma)\n        (64, 2, 0.0),    # Test 1\n        (64, 4, 0.0),    # Test 2\n        (64, 6, 0.0),    # Test 3\n        (64, 4, 0.02),   # Test 4\n        (64, 4, 0.05),   # Test 5\n        (256, 2, 0.0),   # Test 6\n    ]\n\n    results = []\n    for N_grid, p_order, sigma_filter in test_cases:\n        result = calculate_violation(\n            N=N_grid,\n            p=p_order,\n            sigma=sigma_filter,\n            T=T_final,\n            k=k_wavenumber,\n            cfl=CFL_factor\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在我们已经了解数值误差如何污染规范约束之后，现在我们来探索一种现代数值相对论中用来控制这些误差的强大技术：约束阻尼。这项实践涉及分析一个简化模型，该模型描述了规范违例如何传播并被抑制。通过求解这些受阻尼的规范模式的色散关系，你将计算它们的衰减率，从而深入了解数值相对论学家如何确保其模拟的稳定性和物理保真度。",
            "id": "3478758",
            "problem": "考虑在平直背景 $\\eta_{ab}$ 上，围绕闵可夫斯基时空的线性化广义相对论 (GR)，其度规微扰为 $h_{ab}$。在由矢量场 $\\xi_{a}$ 生成的无穷小微分同胚下，一个纯规范微扰的形式为 $h_{ab} = \\partial_{a}\\xi_{b} + \\partial_{b}\\xi_{a}$。在广义和谐 (GH) 形式中，规范约束 $C_{a}$ 衡量了与精确和谐坐标的偏离程度。数值相对论中一个广泛使用的修改是在演化方程中引入约束阻尼项，这样，在闵可夫斯基背景上并在线性阶，约束传播由一个阻尼波偏微分方程 (PDE) 建模，其形式为\n$$(\\partial_{t}^{2} - c^{2}\\nabla^{2}) C_{a} + 2\\kappa\\, \\partial_{t} C_{a} + \\eta\\, C_{a} = 0,$$\n其中 $c$ 是特征传播速度，$\\kappa \\ge 0$ 和 $\\eta \\ge 0$ 是常数阻尼参数。在 $c = 1$ 的自然单位制下进行计算。考虑 $C_{a}$ 的单个笛卡尔分量，并假设一个平面波拟设 $C(t,x) = \\varepsilon \\exp\\{i(k x - \\omega t)\\}$，其波数 $k \\ge 0$，复角频率为 $\\omega$。$\\omega$ 的虚部控制着随时间的指数阻尼。\n\n您的任务是：\n- 从给定的偏微分方程和平面波拟设出发，推导 $\\omega$ 作为 $k$、$\\kappa$ 和 $\\eta$ 的函数的色散关系。将渐近阻尼率 $\\gamma_{\\star}$ 定义为色散关系两个分支上 $\\{-\\operatorname{Im}(\\omega_{1}), -\\operatorname{Im}(\\omega_{2})\\}$ 中的最小非负数。将 $\\gamma_{\\star}$ 解释为控制两个分支叠加的晚期行为的最慢指数衰减率。\n- 设计一个算法，在给定 $(k,\\kappa,\\eta)$ 的情况下，通过求解关于 $\\omega$ 的二次色散关系并选择适当的分支，来稳健地计算 $\\gamma_{\\star}$。您的算法必须处理以下情况：振荡持续的欠阻尼波、振荡与非振荡行为之间过渡的临界阻尼传播、具有纯衰减模式的过阻尼传播，以及如零波数或零阻尼等退化或无阻尼情况。\n\n实现一个程序，为一组固定的测试参数计算 $\\gamma_{\\star}$ 并打印结果。使用 $c = 1$ 的自然单位制，并且不要在输出中附加任何物理单位。对于每个测试用例，将 $\\gamma_{\\star}$ 报告为四舍五入到 $8$ 位小数的浮点数。\n\n测试集（每个元组为 $(k,\\kappa,\\eta)$）：\n- 情况 A（一般欠阻尼）：$(1.0, 0.5, 0.0)$\n- 情况 B（临界边界）：$(1.0, 1.0, 0.0)$\n- 情况 C（过阻尼，长寿命模式）：$(0.2, 1.0, 0.0)$\n- 情况 D（零波数处的临界情况，具有非零线性阻尼）：$(0.0, 0.3, 0.09)$\n- 情况 E（无阻尼）：$(2.5, 0.0, 0.0)$\n- 情况 F（零波数处的非零线性阻尼）：$(0.0, 0.5, 1.0)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果列表，形式为用方括号括起来的逗号分隔列表。例如，输出必须采用 $[\\gamma_{\\star,A},\\gamma_{\\star,B},\\gamma_{\\star,C},\\gamma_{\\star,D},\\gamma_{\\star,E},\\gamma_{\\star,F}]$ 的形式，每个值四舍五入到 $8$ 位小数，且无附加文本。",
            "solution": "所述问题具有科学依据，提法恰当且自成体系。它提出了对阻尼波方程的标准分析——这是物理学和工程学许多领域的基石——并将其置于数值相对论的有效背景下。参数和目标都已明确定义。因此，该问题是有效的，我将着手解决它。\n\n任务是从给定的偏微分方程 (PDE) 推导出色散关系，并根据该关系制定一个算法来计算渐近阻尼率 $\\gamma_{\\star}$。\n\n规范约束的单个分量 $C$ 的控制偏微分方程是阻尼波方程：\n$$\n(\\partial_{t}^{2} - c^{2}\\nabla^{2}) C + 2\\kappa\\, \\partial_{t} C + \\eta\\, C = 0\n$$\n给定自然单位制，其中特征速度 $c=1$。对于沿 $x$ 轴传播的一维平面波，拉普拉斯算子简化为 $\\nabla^2 \\rightarrow \\partial_x^2$。偏微分方程变为：\n$$\n(\\partial_{t}^{2} - \\partial_{x}^{2}) C + 2\\kappa\\, \\partial_{t} C + \\eta\\, C = 0\n$$\n我们代入平面波拟设 $C(t,x) = \\varepsilon \\exp\\{i(k x - \\omega t)\\}$，其中 $k$ 是实波数，$\\omega$ 是可能为复数的角频率。该拟设的导数是：\n$$\n\\partial_t C = -i\\omega C\n$$\n$$\n\\partial_t^2 C = (-i\\omega)^2 C = -\\omega^2 C\n$$\n$$\n\\partial_x^2 C = (ik)^2 C = -k^2 C\n$$\n将这些表达式代入偏微分方程，得到：\n$$\n(-\\omega^2 - (-k^2)) C + 2\\kappa (-i\\omega) C + \\eta C = 0\n$$\n对于非平凡解（$C \\neq 0$），我们可以两边同除以 $C$，得到代数色散关系：\n$$\n-\\omega^2 + k^2 - 2i\\kappa\\omega + \\eta = 0\n$$\n将其重新排列成关于 $\\omega$ 的标准二次方程形式 $a\\omega^2 + b\\omega + c = 0$，得到：\n$$\n\\omega^2 + (2i\\kappa)\\omega - (k^2 + \\eta) = 0\n$$\n这就是连接角频率 $\\omega$ 与波数 $k$ 及阻尼参数 $\\kappa$ 和 $\\eta$ 的色散关系。为了求出 $\\omega$ 的解，我们使用二次公式，其中系数为 $a=1$、$b=2i\\kappa$ 和 $c=-(k^2 + \\eta)$：\n$$\n\\omega = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} = \\frac{-2i\\kappa \\pm \\sqrt{(2i\\kappa)^2 - 4(1)(-(k^2 + \\eta))}}{2}\n$$\n$$\n\\omega = \\frac{-2i\\kappa \\pm \\sqrt{-4\\kappa^2 + 4(k^2 + \\eta)}}{2} = -i\\kappa \\pm \\sqrt{k^2 + \\eta - \\kappa^2}\n$$\n波的时间演化由因子 $e^{-i\\omega t} = e^{-i(\\operatorname{Re}(\\omega) + i\\operatorname{Im}(\\omega))t} = e^{\\operatorname{Im}(\\omega)t} e^{-i\\operatorname{Re}(\\omega)t}$ 控制。要使振幅随时间衰减，必须有 $\\operatorname{Im}(\\omega)  0$。指数阻尼率由 $-\\operatorname{Im}(\\omega)$ 给出。问题将渐近阻尼率 $\\gamma_{\\star}$ 定义为色散关系两个分支对应的模式中最慢的非负衰减率。\n\n让我们将平方根内的项定义为 $\\Delta = k^2 + \\eta - \\kappa^2$。解的性质取决于 $\\Delta$ 的符号。\n\n_情况1：欠阻尼或临界阻尼机制 ($\\Delta \\ge 0$)_\n在这种情况下，$\\sqrt{\\Delta}$ 是一个实的非负数。$\\omega$ 的两个解是：\n$$\n\\omega_{1,2} = \\pm\\sqrt{\\Delta} - i\\kappa\n$$\n实部 $\\operatorname{Re}(\\omega) = \\pm\\sqrt{\\Delta}$ 给出振荡频率，而两个分支的虚部相同：\n$$\n\\operatorname{Im}(\\omega_1) = \\operatorname{Im}(\\omega_2) = -\\kappa\n$$\n相应的阻尼率为 $-\\operatorname{Im}(\\omega_1) = \\kappa$ 和 $-\\operatorname{Im}(\\omega_2) = \\kappa$。由于给定 $\\kappa \\ge 0$，两个率都是非负的。这两个相同率的最小值是：\n$$\n\\gamma_{\\star} = \\min\\{\\kappa, \\kappa\\} = \\kappa\n$$\n\n_情况2：过阻尼机制 ($\\Delta  0$)_\n在这种情况下，$\\Delta$ 是负数，所以它的平方根是虚数。令 $\\sqrt{\\Delta} = i\\sqrt{-\\Delta} = i\\sqrt{\\kappa^2 - k^2 - \\eta}$。$\\omega$ 的两个解是：\n$$\n\\omega_1 = -i\\kappa - i\\sqrt{\\kappa^2 - k^2 - \\eta} = -i \\left( \\kappa + \\sqrt{\\kappa^2 - k^2 - \\eta} \\right)\n$$\n$$\n\\omega_2 = -i\\kappa + i\\sqrt{\\kappa^2 - k^2 - \\eta} = -i \\left( \\kappa - \\sqrt{\\kappa^2 - k^2 - \\eta} \\right)\n$$\n两个解都是纯虚数，对应于非振荡的纯衰减模式。虚部分别为：\n$$\n\\operatorname{Im}(\\omega_1) = -\\left(\\kappa + \\sqrt{\\kappa^2 - k^2 - \\eta}\\right)\n$$\n$$\n\\operatorname{Im}(\\omega_2) = -\\left(\\kappa - \\sqrt{\\kappa^2 - k^2 - \\eta}\\right)\n$$\n相应的阻尼率为 $-\\operatorname{Im}(\\omega_1)$ 和 $-\\operatorname{Im}(\\omega_2)$：\n$$\n\\text{rate}_1 = \\kappa + \\sqrt{\\kappa^2 - k^2 - \\eta}\n$$\n$$\n\\text{rate}_2 = \\kappa - \\sqrt{\\kappa^2 - k^2 - \\eta}\n$$\n在过阻尼机制中，$\\kappa^2  k^2 + \\eta$。由于 $\\kappa \\ge 0$，因此有 $\\kappa  \\sqrt{k^2+\\eta}$，从而 $\\kappa  \\sqrt{\\kappa^2 - (k^2 + \\eta)}$。这保证了两个阻尼率都是正的。渐近（最慢）阻尼率 $\\gamma_{\\star}$ 是这两个率中的最小值。\n$$\n\\gamma_{\\star} = \\min\\{\\text{rate}_1, \\text{rate}_2\\} = \\kappa - \\sqrt{\\kappa^2 - k^2 - \\eta}\n$$\n\n_算法总结_\n对于给定的参数 $(k, \\kappa, \\eta)$，计算 $\\gamma_{\\star}$ 的算法如下：\n1.  计算类判别式项 $\\Delta = k^2 + \\eta - \\kappa^2$。\n2.  如果 $\\Delta \\ge 0$（欠阻尼或临界阻尼），则渐近阻尼率为 $\\gamma_{\\star} = \\kappa$。\n3.  如果 $\\Delta  0$（过阻尼），则渐近阻尼率为 $\\gamma_{\\star} = \\kappa - \\sqrt{\\kappa^2 - k^2 - \\eta}$。\n这为任何有效的输入参数集提供了一个完整而稳健的方法来确定最慢的衰减率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the asymptotic damping rate for a damped wave equation\n    based on a provided test suite of parameters.\n    \"\"\"\n    # Test suite of parameters (k, kappa, eta)\n    test_cases = [\n        # Case A (generic underdamped)\n        (1.0, 0.5, 0.0),\n        # Case B (critical boundary)\n        (1.0, 1.0, 0.0),\n        # Case C (overdamped, long-lived mode)\n        (0.2, 1.0, 0.0),\n        # Case D (critical at zero wave number with nonzero linear damping)\n        (0.0, 0.3, 0.09),\n        # Case E (no damping)\n        (2.5, 0.0, 0.0),\n        # Case F (nonzero linear damping at zero wave number)\n        (0.0, 0.5, 1.0),\n    ]\n\n    results = []\n    for k, kappa, eta in test_cases:\n        # Calculate the discriminant-like term from the dispersion relation\n        # omega = -i*kappa +/- sqrt(k^2 + eta - kappa^2)\n        delta = k**2 + eta - kappa**2\n\n        # The asymptotic damping rate gamma_star is the slowest non-negative\n        # decay rate, given by -Im(omega).\n\n        if delta >= 0:\n            # Underdamped or critically damped case.\n            # The two modes have the same damping rate, kappa.\n            # omega = +/-sqrt(delta) - i*kappa\n            # -Im(omega) = kappa.\n            # Since kappa >= 0, this is the non-negative damping rate.\n            gamma_star = kappa\n        else:\n            # Overdamped case.\n            # The two modes are purely decaying.\n            # omega = -i*kappa +/- i*sqrt(-delta)\n            # -Im(omega)_1 = kappa + sqrt(-delta)\n            # -Im(omega)_2 = kappa - sqrt(-delta)\n            # gamma_star is the minimum of these two positive rates.\n            # -delta = kappa^2 - k^2 - eta\n            gamma_star = kappa - np.sqrt(kappa**2 - k**2 - eta)\n\n        # Format the result to 8 decimal places as a string.\n        results.append(f\"{gamma_star:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}