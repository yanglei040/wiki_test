{
    "hands_on_practices": [
        {
            "introduction": "在3+1分解中，我们将时空视为一个演化的三维几何。标量函数 $\\alpha$ 和移位矢量 $\\beta^i$ 是“规范”量，它们规定了坐标系的演化方式。本练习将探讨“逆问题”：从给定的四维时空度规 $g_{\\mu\\nu}$ 中重构 $\\alpha$ 和 $\\beta^i$ 。通过应用一个微小的坐标变换（微分同胚）并观察重构出的标量函数和移位矢量如何变化，您将亲身体验该形式体系中固有的规范自由度，这是理解为何没有唯一时空切片方式的关键。",
            "id": "3492610",
            "problem": "在适应于 $3+1$ 分解的坐标卡中，给定单个事件上的时空度规 $g_{\\mu\\nu}$。$3+1$ 分解引入了 lapse 函数 $\\alpha$、shift 矢量 $\\beta^i$ 和空间度规 $\\gamma_{ij}$，它们通过以下关系与线元相关联\n$$\nds^2 = -\\alpha^2 dt^2 + \\gamma_{ij} \\left(dx^i + \\beta^i dt\\right)\\left(dx^j + \\beta^j dt\\right).\n$$\n反问题要求：给定 $g_{\\mu\\nu}$，重构 $\\alpha$ 和 $\\beta^i$。然后分析一个微小微分同胚（坐标变换）对重构的 $\\alpha$ 和 $\\beta^i$ 的影响，并讨论由此产生的非唯一性。\n\n基本依据与假设：\n- 在几何化单位制（$c = G = 1$）中进行计算（无量纲单位）。\n- 假设度规符号差为 $(-,+,+,+)$，且在该事件上分解是良定义的（即，度规的空间块是正定的且 $g_{00}  0$）。\n- 考虑一个由 $t' = t + \\epsilon(\\vec{x})$ 和 $x'^i = x^i$ 定义的微小微分同胚，其中 $\\epsilon$ 是微小且光滑的，并使用空间梯度 $\\partial_i \\epsilon$ 在该事件上评估其影响。\n\n任务：\n- 对于下面列出的每个测试用例度规 $g_{\\mu\\nu}$，在该事件上重构 $\\alpha$ 和 $\\beta^i$。\n- 应用微小微分同胚到 $\\epsilon$ 的一阶，以获得该事件上变换后的度规分量 $g'_{\\mu\\nu}$，仅使用 $\\partial_i \\epsilon$ 并忽略 $\\left(\\partial \\epsilon\\right)^2$ 及更高阶的项。\n- 从变换后的度规 $g'_{\\mu\\nu}$ 重构 $\\alpha'$ 和 $\\beta'^i$。\n- 通过报告 $\\alpha'$ 和 $\\beta'^i$ 是否在数值容差之外与 $\\alpha$ 和 $\\beta^i$ 不同，来分析非唯一性，从而展示微小微分同胚下的规范自由度。\n- 通过检查 $\\det(g') \\approx \\det(g)$ 是否在指定容差范围内，来验证度规的行列式在微小微分同胚下一阶近似下保持不变。\n\n数值容差：\n- 行列式不变性容差：若 $\\left|\\det(g') - \\det(g)\\right| \\leq 10^{-12}$，则认为行列式不变。\n- 非唯一性容差：若 $\\left|\\alpha' - \\alpha\\right|  10^{-12}$ 或 $\\|\\beta' - \\beta\\|_2  10^{-12}$，则认为 lapse/shift 在微分同胚下发生了改变。\n\n测试套件（所有值均采用几何化单位）：\n- 测试用例 1（标准坐标下的 Minkowski 时空）：\n  - $g_{00} = -1$, $g_{0i} = 0$ for $i \\in \\{1,2,3\\}$, $g_{ij} = \\delta_{ij}$。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[1\\times 10^{-3}, -2\\times 10^{-3}, 1.5\\times 10^{-3}\\right]$。\n- 测试用例 2（带均匀平移的 Minkowski 时空）：\n  - Shift $\\beta^i = \\left[0.3, -0.2, 0.1\\right]$，lapse $\\alpha = 1$，空间度规 $\\gamma_{ij} = \\delta_{ij}$。\n  - 根据这些，构造 $g_{00} = -1 + \\beta^i \\beta^j \\delta_{ij}$，$g_{0i} = \\delta_{ij} \\beta^j$，$g_{ij} = \\delta_{ij}$。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[2\\times 10^{-3}, 0, -1\\times 10^{-3}\\right]$。\n- 测试用例 3（Transverse-Traceless 规范下的线性化引力波，加极化）：\n  - 事件处的振幅 $h = 1\\times 10^{-2}$，相位经选择以使 $h$ 如所述。\n  - $g_{00} = -1$, $g_{0i} = 0$, $g_{ij} = \\mathrm{diag}\\left(1 + h, 1 - h, 1\\right)$。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[1\\times 10^{-3}, 1\\times 10^{-3}, 0\\right]$。\n- 测试用例 4（各向同性坐标下的 Schwarzschild 时空，位于半径 $r = 10 M$ 处，其中 $M = 1$）：\n  - 定义 $\\phi = 1 + \\frac{M}{2r} = 1 + \\frac{1}{20} = 1.05$。\n  - $g_{00} = -\\left(\\frac{1 - \\frac{M}{2r}}{1 + \\frac{M}{2r}}\\right)^2 = -\\left(\\frac{0.95}{1.05}\\right)^2$, $g_{0i} = 0$, $g_{ij} = \\phi^4 \\delta_{ij}$。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[5\\times 10^{-4}, -5\\times 10^{-4}, 2.5\\times 10^{-4}\\right]$。\n- 测试用例 5（边界情况：带均匀平移但无微分同胚的 Minkowski 时空）：\n  - $g_{\\mu\\nu}$ 与测试用例 2 相同。\n  - 空间梯度：$\\partial_i \\epsilon = \\left[0, 0, 0\\right]$。\n\n输出规范：\n- 对于每个测试用例，您的程序必须计算并返回以下四项内容：\n  - 从 $g_{\\mu\\nu}$ 重构的 $\\alpha$，四舍五入到六位小数。\n  - 从 $g'_{\\mu\\nu}$ 重构的 $\\alpha'$，四舍五入到六位小数。\n  - 一个表示行列式不变性的布尔值：若 $\\left|\\det(g') - \\det(g)\\right| \\leq 10^{-12}$ 则为 $True$，否则为 $False$。\n  - 一个表示非唯一性的布尔值：若 $\\left|\\alpha' - \\alpha\\right|  10^{-12}$ 或 $\\|\\beta' - \\beta\\|_2  10^{-12}$ 则为 $True$，否则为 $False$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$），该列表由测试用例 1 的四项内容、接着测试用例 2 的四项内容、依此类推直到测试用例 5 的结果串联而成。",
            "solution": "该问题是适定的，其科学依据植根于广义相对论及其 $3+1$ (ADM) 分解的原理，并为严谨求解提供了一套完整的数据和定义。任务是从给定的时空度规 $g_{\\mu\\nu}$ 中重构 lapse 函数 $\\alpha$ 和 shift 矢量 $\\beta^i$，然后分析这些量在特定的微小坐标变换（微分同胚）下如何变化。这展示了时空描述中固有的规范自由度。该问题是有效的。\n\n每个测试用例的求解过程分为三个主要阶段：\n1.  从给定的度规 $g_{\\mu\\nu}$ 重构初始的 lapse 和 shift $(\\alpha, \\beta^i)$。\n2.  在指定的微小微分同胚下计算变换后的度规 $g'_{\\mu\\nu}$。\n3.  从 $g'_{\\mu\\nu}$ 重构变换后的 lapse 和 shift $(\\alpha', \\beta'^i)$ 并与初始值进行比较。\n\n**1. 从度规重构 Lapse 和 Shift**\n\n$3+1$ 分解中的线元由下式给出\n$$\nds^2 = g_{\\mu\\nu}dx^\\mu dx^\\nu = -\\alpha^2 dt^2 + \\gamma_{ij} (dx^i + \\beta^i dt)(dx^j + \\beta^j dt)\n$$\n展开右侧并与 $g_{\\mu\\nu}dx^\\mu dx^\\nu$ 的系数进行匹配，可以得到用 ADM 变量 $(\\alpha, \\beta^i, \\gamma_{ij})$ 表示的时空度规分量：\n$$\ng_{00} = -\\alpha^2 + \\beta_k \\beta^k \\quad , \\quad g_{0i} = \\beta_i \\quad , \\quad g_{ij} = \\gamma_{ij}\n$$\n其中 $\\beta_i = \\gamma_{ij}\\beta^j$。\n\n为了执行逆向操作——即从 $g_{\\mu\\nu}$ 重构 $(\\alpha, \\beta^i, \\gamma_{ij})$——我们可以使用逆度规 $g^{\\mu\\nu}$ 的分量。空间超曲面 $t=\\text{const}$ 的法向量为 $n_\\mu = (-\\alpha, 0, 0, 0)$，其逆变形式为 $n^\\mu = g^{\\mu\\nu} n_\\nu = (-\\alpha g^{\\mu 0})$。归一化条件 $n_\\mu n^\\mu = -1$ 给出 $(-\\alpha)(-\\alpha g^{00}) = -1$，这导致 $g^{00} = -1/\\alpha^2$。由此，我们可以直接找到 lapse 函数：\n$$\n\\alpha = \\frac{1}{\\sqrt{-g^{00}}}\n$$\n逆变法向量的分量也由 $n^\\mu = (1/\\alpha, -\\beta^i/\\alpha)$ 给出。将其与 $n^\\mu = (-\\alpha g^{\\mu 0})$ 进行比较，对于空间分量 $(\\mu=i)$ 我们发现：\n$$\n-\\frac{\\beta^i}{\\alpha} = -\\alpha g^{i0} \\implies \\beta^i = \\alpha^2 g^{i0}\n$$\n代入 $\\alpha^2$ 的表达式，我们得到 shift 矢量：\n$$\n\\beta^i = \\frac{-1}{g^{00}} g^{0i}\n$$\n因此，重构算法如下：\n1.  给定 $g_{\\mu\\nu}$，计算其逆 $g^{\\mu\\nu}$。\n2.  提取 $g^{00}$ 和 $g^{0i}$。\n3.  使用上述公式计算 $\\alpha$ 和 $\\beta^i$。\n\n**2. 微小微分同胚下的度规变换**\n\n问题指定了一个对应于时间坐标平移的微小微分同胚：\n$$\nt' = t + \\epsilon(\\vec{x}) \\quad, \\quad x'^i = x^i\n$$\n度规张量按照 $(0,2)$ 阶张量的规则进行变换。我们可以通过强制线元的不变性 $ds^2 = g_{\\mu\\nu}dx^\\mu dx^\\nu = g'_{\\alpha\\beta}dx'^\\alpha dx'^\\beta$ 来找到变换后的分量 $g'_{\\mu\\nu}$。对变换方程取微分：\n$$\ndt' = dt + \\partial_i \\epsilon\\, dx^i \\quad, \\quad dx'^i = dx^i\n$$\n我们将用 $dx'^\\alpha$ 表示的 $dx^\\mu$ 代入原始线元表达式并识别新的度规分量。然而，更直接的方法是将 $dx'^\\alpha$ 用 $dx^\\mu$ 表示，并将得到的二次型与 $g_{\\mu\\nu}dx^\\mu dx^\\nu$ 进行比较。对于微小量 $\\partial_i \\epsilon$ 的一阶，这给出了事件处度规分量的以下变换规则：\n$$\ng'_{00} = g_{00}\n$$\n$$\ng'_{0i} = g_{0i} - g_{00} \\partial_i \\epsilon\n$$\n$$\ng'_{ij} = g_{ij} - (g_{0i} \\partial_j \\epsilon + g_{0j} \\partial_i \\epsilon)\n$$\n这些关系等价于度规相对于矢量场 $\\xi^\\mu = (\\epsilon, 0, 0, 0)$ 的李导数所给出的一阶变化，即 $\\delta g_{\\mu\\nu} = \\mathcal{L}_\\xi g_{\\mu\\nu}$，在 $\\epsilon=0$ 但其梯度非零的点上求值。\n\n**3. 非唯一性与行列式不变性分析**\n\n在使用上述规则计算出变换后的度规 $g'_{\\mu\\nu}$ 后，我们应用第 1 节中描述的相同重构算法来找到新的 lapse $\\alpha'$ 和 shift $\\beta'^i$。\n\n通过比较变换前后的重构值来确定非唯一性。如果 lapse 或 shift 的变化超过了指定的数值容差，就表明 $3+1$ 分解不是唯一的，而是依赖于坐标系的选择（即它是“规范依赖的”）。\n$$\n\\text{如果 } |\\alpha' - \\alpha|  10^{-12} \\text{ 或 } \\|\\beta' - \\beta\\|_2  10^{-12} \\text{ 则为非唯一}\n$$\n\n度规的行列式变换规则为 $\\det(g') = (\\det(J))^{-2} \\det(g)$，其中 $J$ 是坐标变换的雅可比矩阵。对于给定的变换，雅可比行列式为 $\\det(\\partial x'^\\alpha / \\partial x^\\beta) = 1$。这意味着 $\\det(g') = \\det(g)$ 应该精确成立。由于我们对度规分量的变换使用了一阶近似，我们将通过检查行列式的绝对差是否在小的容差范围内，来通过计算验证此属性。\n$$\n\\text{如果 } |\\det(g') - \\det(g)| \\leq 10^{-12} \\text{ 则行列式不变}\n$$\n\n实现将对每个测试用例应用此三阶段过程。\n对于测试用例 2 和 5，其初始度规通过 ADM 变量定义，我们首先使用 $g_{00} = -\\alpha^2 + \\gamma_{ij}\\beta^i\\beta^j$，$g_{0i} = \\gamma_{ij}\\beta^j$ 和 $g_{ij} = \\gamma_{ij}$ 来构造度规 $g_{\\mu\\nu}$。\n整个过程将在提供的 Python 代码中自动化。",
            "answer": "```python\nimport numpy as np\n\ndef construct_g_from_adm(alpha, beta_vec, gamma_mat):\n    \"\"\"Constructs the 4D metric g_munu from ADM variables.\"\"\"\n    g = np.zeros((4, 4))\n    beta_vec = np.array(beta_vec)\n    gamma_mat = np.array(gamma_mat)\n    \n    beta_down = gamma_mat @ beta_vec\n    beta_sq = beta_vec @ beta_down\n    \n    g[0, 0] = -alpha**2 + beta_sq\n    g[0, 1:] = beta_down\n    g[1:, 0] = beta_down\n    g[1:, 1:] = gamma_mat\n    \n    return g\n\ndef reconstruct_adm(g):\n    \"\"\"Reconstructs alpha and beta from the 4D metric g_munu.\"\"\"\n    try:\n        g_inv = np.linalg.inv(g)\n    except np.linalg.LinAlgError:\n        return np.nan, np.array([np.nan, np.nan, np.nan])\n\n    g00_inv = g_inv[0, 0]\n    g0i_inv = g_inv[0, 1:]\n    \n    if g00_inv >= 0:\n        return np.nan, np.array([np.nan, np.nan, np.nan])\n\n    alpha = (-g00_inv)**(-0.5)\n    beta = -g0i_inv / g00_inv\n    \n    return alpha, beta\n\ndef transform_metric(g, grad_eps):\n    \"\"\"Applies the small diffeomorphism to the metric g_munu.\"\"\"\n    g_prime = np.zeros((4, 4))\n    grad_eps = np.array(grad_eps)\n    \n    g00 = g[0, 0]\n    g0i = g[0, 1:]\n    gij = g[1:, 1:]\n    \n    # g'_00 = g_00\n    g_prime[0, 0] = g00\n    \n    # g'_0i = g_0i - g_00 * grad_eps\n    gp_0i = g0i - g00 * grad_eps\n    g_prime[0, 1:] = gp_0i\n    g_prime[1:, 0] = gp_0i\n    \n    # g'_ij = g_ij - (g_0i * grad_eps_j + g_0j * grad_eps_i)\n    gp_ij = gij - (np.outer(g0i, grad_eps) + np.outer(grad_eps, g0i))\n    g_prime[1:, 1:] = gp_ij\n    \n    return g_prime\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print results.\n    \"\"\"\n    \n    # Define test cases\n    test_cases = [\n        # Case 1: Minkowski\n        {\n            \"g_mu_nu\": np.array([[-1., 0., 0., 0.],\n                                 [0., 1., 0., 0.],\n                                 [0., 0., 1., 0.],\n                                 [0., 0., 0., 1.]]),\n            \"grad_eps\": [1e-3, -2e-3, 1.5e-3]\n        },\n        # Case 2: Minkowski with shift\n        {\n            \"g_mu_nu\": construct_g_from_adm(alpha=1.0, beta_vec=[0.3, -0.2, 0.1], gamma_mat=np.identity(3)),\n            \"grad_eps\": [2e-3, 0., -1e-3]\n        },\n        # Case 3: Linearized GW\n        {\n            \"g_mu_nu\": np.array([[-1.0, 0., 0., 0.],\n                                 [0., 1.01, 0., 0.],\n                                 [0., 0., 0.99, 0.],\n                                 [0., 0., 0., 1.0]]),\n            \"grad_eps\": [1e-3, 1e-3, 0.]\n        },\n        # Case 4: Schwarzschild in isotropic coordinates\n        {\n            \"g_mu_nu\": {\n                'g00': -((1 - 1./20.) / (1 + 1./20.))**2,\n                 'gij_diag': (1 + 1./20.)**4\n            },\n            \"grad_eps\": [5e-4, -5e-4, 2.5e-4]\n        },\n        # Case 5: Edge case (Minkowski with shift, no diffeomorphism)\n        {\n            \"g_mu_nu\": construct_g_from_adm(alpha=1.0, beta_vec=[0.3, -0.2, 0.1], gamma_mat=np.identity(3)),\n            \"grad_eps\": [0., 0., 0.]\n        }\n    ]\n    \n    # Special handling for case 4 construction\n    g_case4_data = test_cases[3][\"g_mu_nu\"]\n    g_case4 = np.diag([g_case4_data['g00'], \n                       g_case4_data['gij_diag'], \n                       g_case4_data['gij_diag'], \n                       g_case4_data['gij_diag']])\n    test_cases[3][\"g_mu_nu\"] = g_case4\n\n    # Tolerances\n    det_tol = 1e-12\n    non_unique_tol = 1e-12\n    \n    results = []\n    \n    for case in test_cases:\n        g = case[\"g_mu_nu\"]\n        grad_eps = case[\"grad_eps\"]\n        \n        # 1. Reconstruct initial alpha, beta\n        alpha, beta = reconstruct_adm(g)\n        \n        # 2. Transform the metric\n        g_prime = transform_metric(g, grad_eps)\n        \n        # 3. Reconstruct transformed alpha', beta'\n        alpha_prime, beta_prime = reconstruct_adm(g_prime)\n        \n        # 4. Analyze non-uniqueness and determinant invariance\n        det_g = np.linalg.det(g)\n        det_g_prime = np.linalg.det(g_prime)\n        \n        det_invariant = abs(det_g_prime - det_g) = det_tol\n        \n        alpha_diff = abs(alpha_prime - alpha)\n        beta_diff_norm = np.linalg.norm(beta_prime - beta)\n        non_unique = (alpha_diff > non_unique_tol) or (beta_diff_norm > non_unique_tol)\n        \n        # Append results for this case\n        results.extend([\n            f\"{alpha:.6f}\",\n            f\"{alpha_prime:.6f}\",\n            str(det_invariant),\n            str(non_unique)\n        ])\n\n    formatted_results = [r.replace('True', 'True').replace('False', 'False') for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "尽管标量函数和移位矢量是规范量，但在数值模拟中它们的选择并非任意，不当的选择可能导致灾难性的不稳定性。本练习使用一个简化的线性平流-扩散-反应方程来模拟约束违背（即对爱因斯坦方程的偏离）的增长。通过这个模型，您将看到不同的规范选择，例如像 $1+\\log$ 切片和伽马驱动器（Gamma-driver）移位这样的“动态”规范，如何转化为模型中的稳定或不稳定项 。这个练习将抽象的规范条件与在复杂数值相对论模拟中维持稳定性的具体目标联系起来。",
            "id": "3492624",
            "problem": "要求您在 ADM $3+1$ 分解下，对一维非线性规范波测试中的约束违背增长进行建模和量化，重点关注 \"lapse\" 函数 $\\alpha$ 和 \"shift\" 向量 $\\beta^{i}$ 的选择如何影响这种增长。哈密顿约束 $\\mathcal{H}$ 和动量约束 $\\mathcal{M}_{i}$ 应当在 Arnowitt-Deser-Misner (ADM) 形式体系以及诸如 Baumgarte-Shapiro-Shibata-Nakamura (BSSN) 和协变共形 Z4 (CCZ4) 等广泛使用的形式化方法的背景下进行理解。您必须从第一性原理和标准的、广为接受的事实出发。不要假设或使用任何可以简化推导过程的目标公式。\n\n假设：\n- 考虑一个一维周期性区域 $x \\in [0,L)$，其中 $L$ 为常数。背景时空为非线性规范波，即在非平凡坐标规范下的闵可夫斯基时空，因此在连续统中，爱因斯坦约束得到精确满足。\n- 关注由离散化和不良规范控制引起的微小约束违背。围绕精确背景对约束传播进行线性化。对于哈密顿约束 $\\mathcal{H}$ 或动量约束的分量 $\\mathcal{M}_{x}$，使用一个常系数线性平流-扩散-反应偏微分方程 (PDE) 来近似一个微小约束违背 $c(x,t)$ 的主阶演化：\n$$\n\\partial_{t} c = - v\\,\\partial_{x} c + \\sigma\\, c + \\nu\\, \\partial_{x}^{2} c,\n$$\n其中 $v$ 是继承自 \"shift\" 向量 $\\beta^{x}$ 的有效平流速度，$\\nu \\ge 0$ 是一个捕捉约束阻尼和数值耗散的有效扩散系数，$\\sigma$ 是一个有效反应率，它聚合了由 \"lapse\" 函数 $\\alpha$ 和 \"shift\" 向量 $\\beta^{i}$ 的规范选择以及依赖于形式化方法的约束阻尼所引起的失稳或稳定耦合。假设采用周期性边界条件。所有物理量均为无量纲。\n- 将域上的 $L^{2}$-范数定义为 $\\lVert c(\\cdot,t)\\rVert_{2} = \\left(\\int_{0}^{L} c(x,t)^{2}\\,dx\\right)^{1/2}$，增长因子定义为 $G(t) = \\lVert c(\\cdot,t)\\rVert_{2} / \\lVert c(\\cdot,0)\\rVert_{2}$ (对于 $\\lVert c(\\cdot,0)\\rVert_{2} \\neq 0$ )。如果 $\\lVert c(\\cdot,0)\\rVert_{2} = 0$，则报告的增长因子定义为 $0.0$。\n\n任务：\n- 从 $3+1$ 分裂以及哈密顿和动量约束是必须由演化方程保持的椭圆关系的观点出发，为光滑背景上的微小违背证明上述线性平流-扩散-反应模型的合理性。解释 \"shift\" 向量 $\\beta^{x}$ 如何提供平流项，用于 \"lapse\" 函数的 Bona-Massó 型切片条件和用于 \"shift\" 向量的 Gamma-driver 条件如何能被解释为对系数 $(\\sigma,\\nu)$ 的修正，以及为什么周期性边界条件适用于非线性规范波测试。\n- 推导一种计算周期域上单傅里叶模式初始数据 $c(x,0) = \\varepsilon \\sin\\left(2\\pi m x / L\\right)$（其中模式指数 $m \\in \\mathbb{Z}^{+}$，振幅为 $\\varepsilon$）的 $c(x,t)$ 的 $L^{2}$-范数随时间演化的方法，推导过程不得依赖任何预先给定的简化公式。您的推导必须明确利用周期域上的线性微分算子性质，并且必须指明每个系数 $(v,\\sigma,\\nu)$ 在确定 $G(t)$ 中所起的作用。\n- 基于您的推导，提出对 \"lapse\" 函数和 \"shift\" 向量的具体、广泛使用的规范修正，这些修正在有效模型中可被解释为使 $\\sigma$ 为负、$\\nu$ 为正，从而减少增长。例如，讨论用于 $\\alpha$ 的 Bona-Massó $1+\\log$ 切片和用于 $\\beta^{i}$ 的双曲 Gamma-driver，并定性地将其参数与模型中的 $(\\sigma,\\nu)$ 联系起来。\n\n计算要求：\n- 实现一个程序，为以下测试套件计算哈密顿和动量约束的增长因子。每个测试用例提供 $(L,m,\\varepsilon,v,\\sigma_{\\mathcal{H}},\\nu_{\\mathcal{H}},\\sigma_{\\mathcal{M}},\\nu_{\\mathcal{M}},T)$，其中 $T$ 是报告增长因子时的最终时间。所有量都是无量纲的：\n    1. 不良规范（类测地线切片，冻结 \"shift\"）：$L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0$, $\\sigma_{\\mathcal{H}} = 0.15$, $\\nu_{\\mathcal{H}} = 0.00005$, $\\sigma_{\\mathcal{M}} = 0.10$, $\\nu_{\\mathcal{M}} = 0.00005$, $T = 10$。\n    2. 带有非零常数 \"shift\" 的不良规范：$L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0.5$, $\\sigma_{\\mathcal{H}} = 0.10$, $\\nu_{\\mathcal{H}} = 0.00005$, $\\sigma_{\\mathcal{M}} = 0.08$, $\\nu_{\\mathcal{M}} = 0.00005$, $T = 10$。\n    3. 改进规范（$1+\\log$ 切片和 Gamma-driver \"shift\"，轻度阻尼）：$L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0$, $\\sigma_{\\mathcal{H}} = -0.05$, $\\nu_{\\mathcal{H}} = 0.005$, $\\sigma_{\\mathcal{M}} = -0.08$, $\\nu_{\\mathcal{M}} = 0.005$, $T = 10$。\n    4. 带有非零 \"shift\" 的改进规范（平流加更强阻尼）：$L = 1$, $m = 1$, $\\varepsilon = 10^{-6}$, $v = 0.8$, $\\sigma_{\\mathcal{H}} = -0.10$, $\\nu_{\\mathcal{H}} = 0.005$, $\\sigma_{\\mathcal{M}} = -0.12$, $\\nu_{\\mathcal{M}} = 0.005$, $T = 10$。\n    5. 初始约束违背为零的边缘情况：$L = 1$, $m = 1$, $\\varepsilon = 0$, $v = 0.3$, $\\sigma_{\\mathcal{H}} = 0.05$, $\\nu_{\\mathcal{H}} = 0.001$, $\\sigma_{\\mathcal{M}} = 0.02$, $\\nu_{\\mathcal{M}} = 0.001$, $T = 10$。根据定义，哈密顿和动量增长因子均报告为 $0.0$。\n    6. 高波数边缘情况（强耗散占主导）：$L = 1$, $m = 16$, $\\varepsilon = 10^{-6}$, $v = 0.2$, $\\sigma_{\\mathcal{H}} = 0.05$, $\\nu_{\\mathcal{H}} = 0.001$, $\\sigma_{\\mathcal{M}} = 0.03$, $\\nu_{\\mathcal{M}} = 0.001$, $T = 10$。\n- 您的程序必须为每个测试用例计算一个有序浮点数对 $(G_{\\mathcal{H}}, G_{\\mathcal{M}})$，其中 $G_{\\mathcal{H}}$ 是哈密顿约束在时间 $T$ 的增长因子，$G_{\\mathcal{M}}$ 是动量约束在时间 $T$ 的增长因子。\n- 角度单位不适用。不使用物理单位；所有变量均为无量纲。\n- 最终输出格式：您的程序应生成单行输出，其中包含结果，格式为由双元素列表组成的列表，按测试套件的顺序排列，每个浮点数四舍五入到六位小数，例如：\n$[[G_{\\mathcal{H},1},G_{\\mathcal{M},1}],[G_{\\mathcal{H},2},G_{\\mathcal{M},2}],\\dots]$。",
            "solution": "该问题陈述经评估有效。它在科学上基于数值相对论和爱因斯坦方程组的 $3+1$ 分解原理。该问题是适定的，提供了一个具有常系数的线性偏微分方程、一个清晰的初始条件和周期性边界条件，这构成了一个可解的初边值问题。参数和目标定义得足够精确，任务要求理论论证、数学推导和计算实现的结合，所有这些都是计算物理学的标准实践。\n\n### 模型 PDE 的合理性论证\n\n在 Arnowitt-Deser-Misner (ADM) $3+1$ 形式体系中，时空的演化由一组关于空间度规 $\\gamma_{ij}$ 和外在曲率 $K_{ij}$ 的演化方程控制，并受哈密顿约束 $\\mathcal{H}=0$ 和动量约束 $\\mathcal{M}_{i}=0$ 的制约。在连续统中，如果约束在初始时间切片上得到满足，则演化方程保证它们在所有时间都得到满足。然而，在数值模拟中，离散化误差和规范选择（\"lapse\" 函数 $\\alpha$ 和 \"shift\" 向量 $\\beta^i$）可能导致约束违背的增长。\n\n令 $C$ 代表哈密顿约束 $\\mathcal{H}$ 或动量约束的一个分量，例如 $\\mathcal{M}_x$。约束的时间演化可以示意性地写为 $\\partial_t C = L(C, \\phi)$，其中 $L$ 是一个复杂的微分算子，它依赖于时空场 $\\phi = \\{\\gamma_{ij}, K_{ij}, \\alpha, \\beta^i\\}$ 以及约束 $C$ 本身。\n\n该问题考虑的是一个非线性规范波，它是真空爱因斯坦方程的一个精确解，对应于非平凡规范下的闵可夫斯基时空。在此背景下，约束恒为零，$C_{bg} = 0$。我们关心的是由数值误差引起的微小约束违背 $c(x,t)$ 的演化。我们可以在精确背景解周围对约束演化方程进行线性化：\n$$\n\\partial_t c \\approx \\delta(\\partial_t C)|_{C=0} = \\left.\\frac{\\delta L}{\\delta C}\\right|_{C=0} c\n$$\n算子 $\\delta L/\\delta C$ 是一个线性微分算子，其系数取决于背景解和所选的规范。在一维空间 $x$ 中，对于光滑背景，该算子可以近似为一个通用的常系数线性算子。给定的模型，\n$$\n\\partial_{t} c = - v\\,\\partial_{x} c + \\sigma\\, c + \\nu\\, \\partial_{x}^{2} c\n$$\n代表了这种线性化的主阶项。\n\n*   **平流项 ($-v\\,\\partial_x c$)：** 在 $3+1$ 分裂中，时间导数是垂直于空间超曲面的导数（由 \"lapse\" 函数 $\\alpha$ 控制）和沿超曲面的“拖拽”（由 \"shift\" 向量 $\\beta^i$ 控制）的组合。一个标量场 $c$ 对于沿时间坐标线移动的观察者所测量的时间导数是 $\\partial_t c = \\alpha (\\text{法向导数}) + \\mathcal{L}_{\\beta} c$，其中 $\\mathcal{L}_{\\beta}$ 是沿 \"shift\" 向量的李导数。对于一个标量，$\\mathcal{L}_{\\beta} c = \\beta^i \\partial_i c$。在一维中，这便是 $\\beta^x \\partial_x c$。该项直接以 \"shift\" 定义的坐标速度平流标量场 $c$。因此，模型中的平流速度 $v$ 与 $-\\beta^x$ 直接对应（符号是一种约定）。\n\n*   **反应项 ($\\sigma\\,c$)：** 该项源于线性化算子中对约束 $c$ 呈代数关系的部分。这些项至关重要地取决于规范选择，特别是 \"lapse\" 函数 $\\alpha$ 的演化方程。例如，对于“测地线切片”（其中观察者沿垂直于切片的测地线运动），众所周知约束违背可以呈指数增长。这对应于一个正的反应率，$\\sigma  0$。动态调整的切片条件，如 Bona-Massó 族（例如“$1+\\log$”切片），定义了一个与外在曲率迹 $K$ 耦合的 $\\alpha$ 的演化方程。由于 $K$ 与哈密顿约束 $\\mathcal{H}$ 相关，这种耦合创建了一个反馈机制。增长的 $\\mathcal{H}$ 会改变 $K$，这反过来又以抵消该增长的方式驱动 $\\alpha$，从而有效地使 $\\sigma$ 为负并稳定演化。\n\n*   **扩散项 ($\\nu\\,\\partial_x^2 c$)：** 二阶导数项 $\\partial_x^2 c$ 可以从约束演化方程中的曲率项自然产生。更重要的是，像 BSSN 和 CCZ4 这样的现代数值相对论形式化方法通常包含明确的“约束阻尼”项。这些是人为添加到演化方程中的项，它们与约束的空间导数成比例（例如，形式为 $\\nabla_i C$）。当线性化时，这些项表现为一个扩散项 $\\nu \\nabla^2 c$，在一维中即为 $\\nu \\partial_x^2 c$。一个正系数 $\\nu  0$ 会阻尼高波数（短波长）的约束违背，这些违背在数值上通常是最成问题的。该项也模拟了许多有限差分格式中固有的数值耗散效应。\n\n*   **周期性边界条件：** 非线性规范波是一种解，其中度规分量是行波坐标（例如 $f(x-t)$）的周期函数。因此，对于模拟此类波并分析其上的扰动，具有周期性边界条件的计算域是自然且物理上合适的选择。\n\n### 增长因子 $G(t)$ 的推导\n\n我们需要在周期域 $x \\in [0,L)$ 上求解 PDE $\\partial_{t} c = - v\\,\\partial_{x} c + \\sigma\\, c + \\nu\\, \\partial_{x}^{2} c$，初始条件为单傅里叶模式 $c(x,0) = \\varepsilon \\sin(k x)$，其中 $k = 2\\pi m / L$ 是整数模式指数 $m \\ge 1$ 对应的波数。\n\n由于 PDE 在周期域上是线性的且系数为常数，我们可以使用傅里叶分析。在这个域上，空间微分算子 $\\partial_x$ 和 $\\partial_x^2$ 的特征函数是复指数函数 $e^{i k_n x}$，其波数为 $k_n = 2\\pi n / L$，$n \\in \\mathbb{Z}$。\n让我们考虑一个单一复傅里叶模式作为解的拟设：$c(x,t) = \\hat{c}(t) e^{ikx}$。将其代入 PDE，得到一个关于时间依赖振幅 $\\hat{c}(t)$ 的常微分方程 (ODE)：\n$$\n\\frac{d\\hat{c}(t)}{dt} e^{ikx} = -v \\hat{c}(t) (ik) e^{ikx} + \\sigma \\hat{c}(t) e^{ikx} + \\nu \\hat{c}(t) (ik)^2 e^{ikx}\n$$\n两边同除以 $e^{ikx}$，我们得到：\n$$\n\\frac{d\\hat{c}(t)}{dt} = (-ikv + \\sigma - \\nu k^2) \\hat{c}(t)\n$$\n这是一个一阶线性 ODE，其解为：\n$$\n\\hat{c}(t) = \\hat{c}(0) \\exp\\left((\\sigma - \\nu k^2 - ikv)t\\right)\n$$\n初始条件为 $c(x,0) = \\varepsilon \\sin(kx)$。我们可以使用欧拉公式将其写为：\n$$\nc(x,0) = \\varepsilon \\left(\\frac{e^{ikx} - e^{-ikx}}{2i}\\right) = \\left(\\frac{\\varepsilon}{2i}\\right) e^{ikx} + \\left(\\frac{-\\varepsilon}{2i}\\right) e^{-ikx}\n$$\n这表明初始条件是波数为 $k$ 和 $-k$ 的两个复傅里叶模式的叠加。初始振幅为 $\\hat{c}_{k}(0) = \\varepsilon / (2i)$ 和 $\\hat{c}_{-k}(0) = -\\varepsilon / (2i)$。根据线性性质，时间 $t$ 的解是演化后的模式的叠加：\n$$\nc(x,t) = \\hat{c}_{k}(t) e^{ikx} + \\hat{c}_{-k}(t) e^{-ikx}\n$$\n波数为 $-k$ 的模式振幅演化如下：\n$$\n\\hat{c}_{-k}(t) = \\hat{c}_{-k}(0) \\exp\\left((\\sigma - \\nu (-k)^2 - i(-k)v)t\\right) = \\hat{c}_{-k}(0) \\exp\\left((\\sigma - \\nu k^2 + ikv)t\\right)\n$$\n代入初始振幅和演化因子：\n$$\nc(x,t) = \\frac{\\varepsilon}{2i} e^{(\\sigma - \\nu k^2 - ikv)t} e^{ikx} - \\frac{\\varepsilon}{2i} e^{(\\sigma - \\nu k^2 + ikv)t} e^{-ikx}\n$$\n$$\nc(x,t) = \\frac{\\varepsilon}{2i} e^{(\\sigma - \\nu k^2)t} \\left( e^{i(kx - kvt)} - e^{-i(kx - kvt)} \\right)\n$$\n$$\nc(x,t) = \\varepsilon e^{(\\sigma - \\nu k^2)t} \\sin(k(x-vt))\n$$\n解是一个正弦波，其振幅以 $(\\sigma - \\nu k^2)$ 的速率指数演化，并以速度 $v$ 平流。\n\n现在我们计算 $L^2$-范数，$\\lVert c(\\cdot,t)\\rVert_{2} = \\left(\\int_{0}^{L} c(x,t)^{2}\\,dx\\right)^{1/2}$。\n$$\n\\lVert c(\\cdot,t)\\rVert_{2}^2 = \\int_{0}^{L} \\left( \\varepsilon e^{(\\sigma - \\nu k^2)t} \\sin(k(x-vt)) \\right)^2 dx\n$$\n$$\n\\lVert c(\\cdot,t)\\rVert_{2}^2 = \\varepsilon^2 e^{2(\\sigma - \\nu k^2)t} \\int_{0}^{L} \\sin^2(k(x-vt)) dx\n$$\n$\\sin^2$ 在整数个周期上的积分值为 $L/2$。由于 $k = 2\\pi m/L$，被积函数 $\\sin^2(\\frac{2\\pi m}{L}(x-vt))$ 在区域 $[0,L)$ 上完成了 $m$ 个完整周期，所以积分值确实是 $L/2$。\n$$\n\\lVert c(\\cdot,t)\\rVert_{2}^2 = \\varepsilon^2 e^{2(\\sigma - \\nu k^2)t} \\frac{L}{2}\n$$\n取平方根，假设 $\\varepsilon  0$：\n$$\n\\lVert c(\\cdot,t)\\rVert_{2} = \\varepsilon e^{(\\sigma - \\nu k^2)t} \\sqrt{\\frac{L}{2}}\n$$\n初始范数为 $\\lVert c(\\cdot,0)\\rVert_{2} = \\varepsilon \\sqrt{L/2}$。增长因子 $G(t)$ 是其比值：\n$$\nG(t) = \\frac{\\lVert c(\\cdot,t)\\rVert_{2}}{\\lVert c(\\cdot,0)\\rVert_{2}} = \\frac{\\varepsilon e^{(\\sigma - \\nu k^2)t} \\sqrt{L/2}}{\\varepsilon \\sqrt{L/2}} = e^{(\\sigma - \\nu k^2)t}\n$$\n代入 $k = 2\\pi m / L$：\n$$\nG(t) = \\exp\\left(\\left(\\sigma - \\nu \\left(\\frac{2\\pi m}{L}\\right)^2\\right)t\\right)\n$$\n这是增长因子的最终表达式。请注意，平流速度 $v$ 不影响 $L^2$-范数的增长，因为范数在空间平移下是不变的。如果 $\\varepsilon=0$，则初始范数为 $0$，解保持为 $c(x,t)=0$，因此增长因子被正确定义为 $0.0$。\n\n### 稳定性的规范条件\n\n“良好”规范选择的目标是确保约束违背不会增长；理想情况下，它们应该被阻尼掉。在我们的模型背景下，这意味着设计整个系统，使得约束的有效系数满足 $\\sigma  0$ 和 $\\nu  0$。\n\n*   **Lapse 条件（$1+\\log$ 切片）：** $1+\\log$ 切片条件是 Bona-Massó 切片条件族的一个成员。一种常见的形式是 $\\partial_t \\alpha = -\\alpha^2 f(\\alpha) K + \\beta^i \\partial_i \\alpha$，其中一个流行的选择是 $f(\\alpha)=2/\\alpha$。关键在于包含 $K$（外在曲率的迹）的项。哈密顿约束 $\\mathcal{H}$ 与 $K$ 有代数关系（例如，$\\mathcal{H} = R + K^2 - K_{ij}K^{ij} - 16\\pi\\rho$）。当 $\\mathcal{H}$ 偏离零时，$K$ 也偏离其“在壳”值。切片条件将此偏差反馈到 \"lapse\" 函数 $\\alpha$ 的演化中。这种反馈被专门设计为负反馈：增长的约束违背会驱动 \"lapse\" 函数以抵消该增长。这将迫使约束遵循一个类波动方程，而不是指数增长，这在我们的有效模型中对应于为 $\\sigma_{\\mathcal{H}}$ 贡献一个负项，从而促进稳定性。\n\n*   **Shift 条件 (Gamma-driver)：** \"shift\" 向量 $\\beta^i$ 控制坐标漂移。静态 \"shift\" 或简单的选择可能导致动量约束 $\\mathcal{M}_i$ 的不稳定性。“Gamma-driver” \"shift\" 条件是一组关于 $\\beta^i$ 的动力学演化方程。一个典型的形式是 $\\partial_t \\beta^i = B^i$ 和 $\\partial_t B^i = \\frac{3}{4}\\partial_t \\tilde{\\Gamma}^i - \\eta B^i$，其中 $\\tilde{\\Gamma}^i$ 是共形连接函数（本质上是度规的空间导数），$\\eta$ 是一个阻尼参数。源项 $\\tilde{\\Gamma}^i$ 与动量约束 $\\mathcal{M}_i$ 密切相关。当 $\\mathcal{M}_i$ 非零时，它充当 \"shift\" 演化的源。然后 \"shift\" 动态调整以将 $\\tilde{\\Gamma}^i$（并因此将 $\\mathcal{M}_i$）驱动回零。这将约束演化转变为一个阻尼双曲系统。这对应于使 $\\sigma_{\\mathcal{M}}$ 为负，并且也可以被解释为对扩散/阻尼项 $\\nu_{\\mathcal{M}}$ 有贡献。\n\n总而言之，现代的“动态”规范条件旨在将约束子系统从一个不适定或不稳定的系统转变为一个适定的、稳定的、有阻尼的双曲系统。这是通过在规范演化方程中引入提供负反馈的项来实现的，这在有效模型中转化为 $\\sigma  0$ 和 $\\nu  0$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Hamiltonian and momentum constraint growth factors for a\n    series of test cases based on a linearized 1D constraint evolution model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, m, ε, v, σ_H, ν_H, σ_M, ν_M, T)\n    test_cases = [\n        # 1. Poor gauge (geodesic-like slicing, frozen shift)\n        (1.0, 1, 1e-6, 0.0, 0.15, 0.00005, 0.10, 0.00005, 10.0),\n        # 2. Poor gauge with constant nonzero shift\n        (1.0, 1, 1e-6, 0.5, 0.10, 0.00005, 0.08, 0.00005, 10.0),\n        # 3. Improved gauge (1+log slicing and Gamma-driver shift, mild damping)\n        (1.0, 1, 1e-6, 0.0, -0.05, 0.005, -0.08, 0.005, 10.0),\n        # 4. Improved gauge with nonzero shift (advection plus stronger damping)\n        (1.0, 1, 1e-6, 0.8, -0.10, 0.005, -0.12, 0.005, 10.0),\n        # 5. Edge case with zero initial constraint violation\n        (1.0, 1, 0.0, 0.3, 0.05, 0.001, 0.02, 0.001, 10.0),\n        # 6. High-wavenumber edge case (strong dissipation dominates)\n        (1.0, 16, 1e-6, 0.2, 0.05, 0.001, 0.03, 0.001, 10.0),\n    ]\n\n    all_results_formatted = []\n    \n    for case in test_cases:\n        L, m, epsilon, v, sigma_H, nu_H, sigma_M, nu_M, T = case\n\n        # Handle the special case of zero initial violation as per problem description.\n        if epsilon == 0.0:\n            G_H = 0.0\n            G_M = 0.0\n        else:\n            # The derived growth factor G(t) = exp((σ - ν * k^2) * t)\n            # where k = 2 * pi * m / L.\n            \n            # Calculate the square of the wavenumber k.\n            k_squared = (2 * np.pi * m / L)**2\n\n            # Calculate the growth factor for the Hamiltonian constraint.\n            exponent_H = (sigma_H - nu_H * k_squared) * T\n            G_H = np.exp(exponent_H)\n\n            # Calculate the growth factor for the momentum constraint.\n            exponent_M = (sigma_M - nu_M * k_squared) * T\n            G_M = np.exp(exponent_M)\n\n        # Format the result pair as a string '[val1,val2]'\n        formatted_pair = f\"[{G_H:.6f},{G_M:.6f}]\"\n        all_results_formatted.append(formatted_pair)\n\n    # Final print statement in the exact required format.\n    # Joins the formatted strings and wraps them in an outer list bracket.\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "即使采用旨在增强稳定性的复杂规范条件，规范量本身也可能表现出复杂的非线性行为，“规范激波”的形成就是这样一种病态现象。本练习为在广泛使用的 $1+\\log$ 切片条件下陡峭化的规范脉冲建立了一个有效模型，该模型最终可化为标量守恒律。通过实施数值解，您将研究一个光滑的初始规范脉冲如何非线性地陡峭化，在其梯度中形成不连续性，即规范激波 。这个练习揭示了规范动力学本身可能产生的复杂非线性现象，并让您实践处理双曲守恒律的数值方法。",
            "id": "3492657",
            "problem": "考虑数值相对論中使用的三加一（$3+1$）分解，其中时空度规被分解为一个空间度规、一个控制空间超曲面之间坐标时间推进的lapse函数 $\\alpha$，以及一个控制空间坐标运动的shift矢量 $\\beta^i$。在Bona-Massó类型的规范条件下，lapse函数通过一个给定的切片条件进行演化。在$1+\\log$切片的特定情况下，选择的切片函数旨在促进避免奇点的行为。由于规范脉冲的非线性陡峭化，可能會发展出称为规范激波的规范病态，其表现为lapse函数空间导数（如 $\\partial_i \\alpha$）的不连续性。\n\n您的任务是为$1+\\log$切片下lapse函数中的陡峭规范脉冲，构建、推导并实现一个一维、无量纲的有效模型，该模型能分离出规范陡峭化的动力学过程。请按以下步骤进行：\n\n1. 从三加一分解和Bona-Massó切片条件出发，在一个合适的几何光学（短波）和曲率冻结近似下，论证lapse函数 $\\alpha(x,t)$ 中局域规范脉冲的演化可以用一个形如下式的一阶拟线性双曲偏微分方程来建模\n   $$ \\partial_t \\alpha + v(\\alpha)\\,\\partial_x \\alpha = 0, $$\n   其中 $v(\\alpha)$ 是由切片选择决定的规范模式的特征速度。假设shift矢量为零（$\\beta^x=0$），以清晰地分离出lapse函数的陡峭化过程。\n\n2. 对于$1+\\log$切片，推导 $v(\\alpha)$ 的显式函数形式，并将演化方程重写为标量守恒律\n   $$ \\partial_t \\alpha + \\partial_x F(\\alpha) = 0, $$\n   识别出通量函数 $F(\\alpha)$。\n\n3. 使用特征线法，推导对于初始剖面 $\\alpha_0(x)$ 的最早激波形成时间\n   $$ t_{\\star} = -\\frac{1}{\\min_{x} \\left[ v'(\\alpha_0(x))\\,\\partial_x \\alpha_0(x) \\right] }, $$\n   并假设该最小值为负且解在激波形成前保持单值。解释为什么激波对应于 $\\partial_x \\alpha$ 的不连续性。\n\n4. 在均匀网格上，为规范lapse模型的守恒律形式实现一个带周期性边界条件的一维有限体积Godunov格式。使用由Courant–Friedrichs–Lewy (CFL) 条件确定的时间步长\n   $$ \\Delta t = \\text{CFL}\\,\\frac{\\Delta x}{\\max_x |v(\\alpha(x,t))|}, $$\n   并通过在必要时裁剪到一个小的正数下限来数值上保证演化过程维持 $\\alpha \\ge 0$，以保持实的特征速度。通过追踪陡峭化过程来数值检测激波的出现：定义一个阈值因子 $\\theta0$，在每个时间点计算最大绝对离散梯度 $\\max_x |\\partial_x \\alpha|$，并记录该最大值首次超过其初始值 $\\theta$ 倍的时间 $t_{\\theta}$。如果在最终时间 $T$ 之前此条件未被满足，则报告 $t_{\\theta}=-1$。\n\n5. 使用以下无量纲单位的初始数据和参数，构建一个包含三种情况的测试套件。每种情况下的初始lapse剖面是一个在恒定背景上的高斯脉冲，\n   $$ \\alpha_0(x) = \\alpha_{\\text{base}} + A \\exp\\!\\left(-\\frac{(x-x_0)^2}{\\sigma^2}\\right), $$\n   定义在周期性区域 $x\\in[0,L)$上，并在$N$个均匀单元上采样。在CFL条件下演化到指定的最终时间 $T$，并使用阈值 $\\theta$ 检测 $t_{\\theta}$。\n\n   将结果以单行形式提供，格式为一个用方括号括起来的逗号分隔列表，按情况的顺序排列，其中每个条目是对应情况的浮点数 $t_{\\theta}$（如果在时间 $T$ 内从未超过阈值，则使用 $-1$）。\n\n   测试套件：\n   - 情况 A: $L=1.0$, $N=512$, $\\alpha_{\\text{base}}=0.3$, $A=0.6$, $\\sigma=0.06$, $x_0=0.5$, $\\text{CFL}=0.45$, $T=0.30$, $\\theta=50$.\n   - 情况 B: $L=1.0$, $N=512$, $\\alpha_{\\text{base}}=0.8$, $A=0.2$, $\\sigma=0.20$, $x_0=0.5$, $\\text{CFL}=0.45$, $T=0.30$, $\\theta=50$.\n   - 情况 C: $L=1.0$, $N=512$, $\\alpha_{\\text{base}}=0.1$, $A=0.9$, $\\sigma=0.03$, $x_0=0.5$, $\\text{CFL}=0.45$, $T=0.15$, $\\theta=50$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[t_A,t_B,t_C]$）。所有量都是无量纲的，因此输出中不需要物理单位。",
            "solution": "任务是推导并实现一个在$1+\\log$切片下描述lapse函数 $\\alpha$ 中规范脉冲陡峭化的有效模型，并数值确定激波形成的时间。\n\n首先，我们推导lapse函数 $\\alpha(x, t)$ 的有效演化方程。在爱因斯坦方程的$3+1$分解中，lapse函数 $\\alpha$ 和外曲率的迹 $K$ 通过切片条件相关联。对于一般的Bona-Massó族切片条件，lapse的演化由 $\\partial_t \\alpha = -\\alpha^2 f(\\alpha) K$ 给出，其中函数 $f(\\alpha)$ 的选择决定了具体的规范。外曲率迹 $K$ 的演化由外曲率演化方程的迹给出，在真空中且shift矢量为零（$\\beta^i=0$）时，该方程为 $\\partial_t K = -D^i D_i \\alpha + \\alpha K_{ij} K^{ij}$。这里，$D_i$ 是空间超曲面上的协变导数。为了分离出规范模式的动力学，我们采用几何光学（或程函）近似，该近似对短波扰动有效。在此极限下，我们可以忽略项 $\\alpha K_{ij}K^{ij}$，因为它在扰动中是更高阶的，并且涉及被假定为“冻结”的、缓慢变化的背景时空曲率。为简单起见，在一维空间并假设空间度规是平坦的（即 $D_x = \\partial_x$），该系统简化为一个关于 $\\alpha$ 和 $K$ 的耦合方程组：\n$$ \\partial_t \\alpha = -\\alpha^2 f(\\alpha) K $$\n$$ \\partial_t K = -\\partial_x^2 \\alpha $$\n对第一个方程取时间导数并代入第二个方程，假设 $\\alpha$ 和 $f(\\alpha)$ 相对于波的动力学是缓变的，我们得到 $\\partial_t^2 \\alpha \\approx -\\alpha^2 f(\\alpha) \\partial_t K = \\alpha^2 f(\\alpha) \\partial_x^2 \\alpha$。这是一个波动方程 $\\partial_t^2 \\alpha - c^2 \\partial_x^2 \\alpha = 0$，其特征速度为 $c = \\alpha \\sqrt{f(\\alpha)}$。几何光学近似允许我们用一个一阶拟线性双曲方程来模拟单个波族（例如右行波）的演化，其中的传播速度是局域特征速度。这就得出了所要求的形式：\n$$ \\partial_t \\alpha + v(\\alpha)\\,\\partial_x \\alpha = 0 $$\n其特征速度为 $v(\\alpha) = \\alpha \\sqrt{f(\\alpha)}$。\n\n其次，我们为$1+\\log$切片具体化这个模型。该切片条件由选择 $f(\\alpha) = 2/\\alpha$ 定义。这个选择在避免奇点方面特别有效，因为当 $\\alpha \\to 0$ 时，$f(\\alpha)$ 发散，从而强烈地将lapse函数推离零值。将此代入我们的特征速度表达式中得到：\n$$ v(\\alpha) = \\alpha \\sqrt{\\frac{2}{\\alpha}} = \\sqrt{2\\alpha} $$\n因此，演化方程为 $\\partial_t \\alpha + \\sqrt{2\\alpha} \\, \\partial_x \\alpha = 0$。为了将其写成标量守恒律 $\\partial_t \\alpha + \\partial_x F(\\alpha) = 0$ 的形式，我们必须找到一个通量函数 $F(\\alpha)$ 使得 $dF/d\\alpha = v(\\alpha)$。对 $v(\\alpha)$ 关于 $\\alpha$ 积分得到：\n$$ F(\\alpha) = \\int \\sqrt{2\\alpha} \\, d\\alpha = \\sqrt{2} \\int \\alpha^{1/2} \\, d\\alpha = \\frac{2\\sqrt{2}}{3} \\alpha^{3/2} $$\n其中我们已将积分常数设为零。这给出了守恒律 $\\partial_t \\alpha + \\partial_x \\left(\\frac{2\\sqrt{2}}{3} \\alpha^{3/2}\\right) = 0$。\n\n第三，我们推导激波形成时间。对于方程 $\\partial_t \\alpha + v(\\alpha)\\,\\partial_x \\alpha = 0$，特征线法表明 $\\alpha$ 的值沿着由 $dx/dt = v(\\alpha)$ 定义的特征曲线是恒定的。因此，这些特征线是在 $(x,t)$ 平面上的直线，其斜率由其起点 $x_0$ 处的 $\\alpha$ 初始值决定：$x(t) = x_0 + v(\\alpha_0(x_0))t$。当两条无限接近的特征线相交时，就会形成激波，或称梯度灾变。这个相交时间由 $t = -1/\\frac{d}{dx_0}[v(\\alpha_0(x_0))]$ 给出。使用链式法则，这变为 $t = -1/[v'(\\alpha_0(x_0))\\partial_x\\alpha_0(x_0)]$。只有当这个时间是正的，即分母必须为负时，才会形成激波。第一个激波出现在时间 $t_\\star$，对应于所有初始位置 $x_0$ 上这种正时间的最小值：\n$$ t_{\\star} = -\\frac{1}{\\min_{x} \\left[ v'(\\alpha_0(x))\\,\\partial_x \\alpha_0(x) \\right] } $$\n在这个时间 $t_\\star$，空间导数 $\\partial_x \\alpha$ 变为无穷大，这是 $\\alpha$ 梯度中激波的数学表现。发生这种情况是因为波中具有较大 $\\alpha$ 的部分具有更高的速度 $v(\\alpha) = \\sqrt{2\\alpha}$ （因为 $v'(\\alpha) = 1/\\sqrt{2\\alpha}  0$），它们追上了具有较小 $\\alpha$ 的较慢移动部分。\n\n第四和第五，我们实现一个数值解。我们对守恒律 $\\partial_t \\alpha + \\partial_x F(\\alpha) = 0$ 使用一阶有限体积Godunov格式。对于单元宽度为 $\\Delta x$ 的均匀网格，单元 $i$ 中的单元平均值 $\\bar{\\alpha}_i$ 通过 $\\bar{\\alpha}_i^{n+1} = \\bar{\\alpha}_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2})$ 进行更新，其中 $F_{i\\pm 1/2}$ 是单元界面处的数值通量。由于特征速度 $v(\\alpha)=\\sqrt{2\\alpha}$ 总是非负的，信号总是向右传播。因此，任何界面处的迎风值是左侧单元的状态。Godunov通量简化为迎风通量：$F_{i+1/2} = F(\\bar{\\alpha}_i)$。更新格式变为 $\\bar{\\alpha}_i^{n+1} = \\bar{\\alpha}_i^n - \\frac{\\Delta t}{\\Delta x} (F(\\bar{\\alpha}_i^n) - F(\\bar{\\alpha}_{i-1}^n))$。时间步长 $\\Delta t$ 根据CFL条件动态调整。当最大绝对离散梯度 $\\max_x |\\partial_x \\alpha|$ 超过其初始值的 $\\theta$ 倍时，就数值上检测到了激波。初始剖面是在周期性区域上演化的、位于恒定背景上的高斯脉冲。以下代码实现了这个过程并运行指定的测试用例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the gauge pulse steepening problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'L': 1.0, 'N': 512, 'alpha_base': 0.3, 'A': 0.6, 'sigma': 0.06, 'x0': 0.5, 'CFL': 0.45, 'T': 0.30, 'theta': 50},\n        # Case B\n        {'L': 1.0, 'N': 512, 'alpha_base': 0.8, 'A': 0.2, 'sigma': 0.20, 'x0': 0.5, 'CFL': 0.45, 'T': 0.30, 'theta': 50},\n        # Case C\n        {'L': 1.0, 'N': 512, 'alpha_base': 0.1, 'A': 0.9, 'sigma': 0.03, 'x0': 0.5, 'CFL': 0.45, 'T': 0.15, 'theta': 50},\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        # Unpack parameters\n        L = params['L']\n        N = params['N']\n        alpha_base = params['alpha_base']\n        A = params['A']\n        sigma = params['sigma']\n        x0 = params['x0']\n        CFL = params['CFL']\n        T = params['T']\n        theta = params['theta']\n\n        # Grid setup\n        dx = L / N\n        x_centers = (np.arange(N) + 0.5) * dx\n\n        # Initial condition (cell-averaged alpha)\n        alpha = alpha_base + A * np.exp(-((x_centers - x0)**2) / sigma**2)\n        \n        # Small positive floor to maintain real characteristic speeds\n        alpha_floor = 1e-12\n        alpha = np.maximum(alpha, alpha_floor)\n\n        # Initial max gradient for shock detection threshold\n        # Using a second-order centered difference with periodic boundaries\n        grad_alpha_initial = (np.roll(alpha, -1) - np.roll(alpha, 1)) / (2 * dx)\n        max_grad_initial = np.max(np.abs(grad_alpha_initial))\n        \n        if max_grad_initial  1e-9: # Guard against flat initial data\n            results.append(-1.0)\n            continue\n\n        threshold_grad = theta * max_grad_initial\n\n        t = 0.0\n        t_shock = -1.0\n        \n        # Main evolution loop\n        while t  T:\n            # Enforce floor\n            alpha = np.maximum(alpha, alpha_floor)\n            \n            # CFL condition to determine time step\n            v = np.sqrt(2 * alpha)\n            v_max = np.max(v)\n\n            if v_max  1e-9:\n                 dt = T - t # If speed is zero, take one large step to the end\n            else:\n                 dt = CFL * dx / v_max\n            \n            # Ensure the final time T is not overstepped\n            if t + dt > T:\n                dt = T - t\n            \n            # Godunov scheme (first-order upwind for v>0)\n            # F(alpha) = (2*sqrt(2)/3) * alpha^(3/2)\n            flux = (2 * np.sqrt(2) / 3) * alpha**1.5\n\n            # Flux at left interface of cell i is flux from cell i-1\n            flux_left = np.roll(flux, 1)\n            \n            # Update alpha using finite volume formula\n            alpha -= (dt / dx) * (flux - flux_left)\n            \n            t += dt\n\n            # Check for shock formation by monitoring the gradient\n            grad_alpha_current = (np.roll(alpha, -1) - np.roll(alpha, 1)) / (2 * dx)\n            max_grad_current = np.max(np.abs(grad_alpha_current))\n\n            if max_grad_current > threshold_grad:\n                t_shock = t\n                break\n        \n        results.append(t_shock)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}