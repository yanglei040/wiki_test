{
    "hands_on_practices": [
        {
            "introduction": "The power of the ADM formalism lies in its ability to cast Einstein's equations into a dynamic, initial-value problem. A fundamental test of this framework is to recover the well-known physics of gravitational waves. This practice guides you through the essential process of linearizing the ADM equations around flat spacetime to isolate the propagating, physical degrees of freedom from pure gauge artifacts .",
            "id": "3489095",
            "problem": "Consider vacuum General Relativity in the $3+1$ decomposition due to Arnowitt, Deser, and Misner (ADM). Let the spatial metric be $\\gamma_{ij}$, the extrinsic curvature be $K_{ij}$, the lapse be $\\alpha$, and the shift be $\\beta^{i}$. Work in a neighborhood of Minkowski space with background fields $\\gamma_{ij} = \\delta_{ij}$, $K_{ij} = 0$, $\\alpha = 1$, and $\\beta^{i} = 0$. Introduce a perturbative expansion with $\\gamma_{ij} = \\delta_{ij} + h_{ij}$, $K_{ij} = \\kappa_{ij}$, $\\alpha = 1$, and $\\beta^{i} = 0$, retaining only terms linear in the small fields $h_{ij}$ and $\\kappa_{ij}$. Starting from the vacuum Einstein equations written in the ADM form (Hamiltonian and momentum constraints together with the evolution equations for $\\gamma_{ij}$ and $K_{ij}$), perform the linearization about this Minkowski background to obtain the linearized ADM system. Using the linearized constraints and evolution, decompose the spatial metric perturbation into its transverse-traceless sector and the complementary pure-gauge sectors, and identify which sector represents physical gravitational radiation and which sectors are gauge. For the physical transverse-traceless sector $h^{\\mathrm{TT}}_{ij}$, assume a plane-wave ansatz $h^{\\mathrm{TT}}_{ij}(t,\\mathbf{x}) = \\epsilon_{ij} \\exp\\!\\big(i(k_{m} x^{m} - \\omega t)\\big)$ with $\\epsilon^{i}{}_{i} = 0$ and $k^{j} \\epsilon_{ij} = 0$, and derive the dispersion relation $\\omega(|\\mathbf{k}|)$ of the physical mode. Express your final answer as a single closed-form analytic expression for $\\omega$ in units where the speed of light is normalized to unity. No numerical approximation or rounding is required.",
            "solution": "The problem asks for the derivation of the dispersion relation for physical gravitational waves within the linearized Arnowitt-Deser-Misner (ADM) formalism of General Relativity. This requires starting from the vacuum ADM equations, linearizing them about a Minkowski background, identifying the physical degrees of freedom, and then analyzing their propagation.\n\n### Step 1: The Vacuum ADM Equations\nThe $3+1$ decomposition of spacetime results in a set of four constraint equations and twelve evolution equations. In a vacuum spacetime ($T_{\\mu\\nu}=0$), and using units where the speed of light $c=1$, the ADM equations are:\n\n1.  **Hamiltonian Constraint:**\n    $$R + K^2 - K_{ij} K^{ij} = 0$$\n    where $R$ is the Ricci scalar of the spatial metric $\\gamma_{ij}$, and $K = \\gamma^{ij} K_{ij}$ is the trace of the extrinsic curvature $K_{ij}$.\n\n2.  **Momentum Constraint:**\n    $$D_j (K^{ij} - \\gamma^{ij} K) = 0$$\n    where $D_j$ is the covariant derivative compatible with the spatial metric $\\gamma_{ij}$.\n\n3.  **Evolution of the Spatial Metric:**\n    $$\\frac{\\partial}{\\partial t} \\gamma_{ij} = -2\\alpha K_{ij} + D_i \\beta_j + D_j \\beta_i$$\n    where $\\alpha$ is the lapse function and $\\beta^i$ is the shift vector.\n\n4.  **Evolution of the Extrinsic Curvature:**\n    $$\\frac{\\partial}{\\partial t} K_{ij} = -D_i D_j \\alpha + \\alpha(R_{ij} + K K_{ij} - 2 K_{ik} K^k_j) + \\beta^k D_k K_{ij} + K_{ik} D_j \\beta^k + K_{jk} D_i \\beta^k$$\n    where $R_{ij}$ is the Ricci tensor of the spatial metric $\\gamma_{ij}$.\n\n### Step 2: Linearization about Minkowski Spacetime\nWe linearize these equations around a background Minkowski spacetime, characterized by flat spatial slices and no time evolution. The background fields are $\\gamma_{ij} = \\delta_{ij}$, $K_{ij} = 0$, $\\alpha = 1$, and $\\beta^i = 0$.\n\nWe introduce small perturbations:\n$\\gamma_{ij} = \\delta_{ij} + h_{ij}$\n$K_{ij} = \\kappa_{ij}$\nFor the lapse and shift, the problem specifies a gauge choice by keeping them at their background values:\n$\\alpha = 1$\n$\\beta^i = 0$\n\nWe retain only terms that are first-order in the perturbation fields $h_{ij}$ and $\\kappa_{ij}$. In this approximation, spatial indices are raised and lowered with the background metric $\\delta_{ij}$, and the spatial covariant derivative $D_i$ becomes the partial derivative $\\partial_i$.\n\nThe linearized Ricci tensor $R_{ij}^{(1)}$ and Ricci scalar $R^{(1)}$ are given by:\n$$R_{ij}^{(1)} = \\frac{1}{2}(\\partial_k \\partial_i h^k_j + \\partial_k \\partial_j h^k_i - \\partial_i \\partial_j h - \\nabla^2 h_{ij})$$\n$$R^{(1)} = \\delta^{ij}R_{ij}^{(1)} = \\partial_i \\partial_j h^{ij} - \\nabla^2 h$$\nwhere $h = \\delta^{ij} h_{ij}$ is the trace of the metric perturbation and $\\nabla^2 = \\delta^{ij}\\partial_i\\partial_j$ is the flat-space Laplacian.\n\nApplying this linearization to the ADM equations yields:\n\n1.  **Linearized Hamiltonian Constraint:** All terms in the original equation are quadratic in $K_{ij}$, except for $R$. Thus, we are left with the linearized Ricci scalar:\n    $$R^{(1)} = \\partial_i \\partial_j h^{ij} - \\nabla^2 h = 0$$\n\n2.  **Linearized Momentum Constraint:** The term $K^{ij} - \\gamma^{ij}K$ linearizes to $\\kappa^{ij} - \\delta^{ij}\\kappa$. The covariant derivative becomes a partial derivative:\n    $$\\partial_j (\\kappa^{ij} - \\delta^{ij} \\kappa) = 0$$\n    where $\\kappa = \\delta^{ij}\\kappa_{ij}$.\n\n3.  **Linearized Metric Evolution:** With $\\dot{\\gamma}_{ij} = \\dot{h}_{ij}$, $\\alpha=1$, and $\\beta^i=0$, the equation becomes:\n    $$\\dot{h}_{ij} = -2\\kappa_{ij}$$\n    where the dot represents a partial derivative with respect to time $t$. This equation directly relates the perturbation of the extrinsic curvature to the time derivative of the metric perturbation. Taking the trace gives $\\dot{h} = -2\\kappa$.\n\n4.  **Linearized Curvature Evolution:** With $\\dot{K}_{ij} = \\dot{\\kappa}_{ij}$, $\\alpha=1$, and $\\beta^i=0$, and noting that all terms involving $K_{ij}$ in the original equation are at least quadratic, the equation simplifies to:\n    $$\\dot{\\kappa}_{ij} = R^{(1)}_{ij}$$\n\n### Step 3: The Linearized Wave Equation and Identification of Physical Modes\nWe can combine the evolution equations to obtain a second-order equation for $h_{ij}$. Differentiating the metric evolution equation with respect to time gives $\\ddot{h}_{ij} = -2\\dot{\\kappa}_{ij}$. Substituting the curvature evolution equation yields:\n$$\\ddot{h}_{ij} = -2 R^{(1)}_{ij}$$\nSubstituting the expression for the linearized Ricci tensor gives the general linearized wave equation for $h_{ij}$ in this gauge:\n$$\\ddot{h}_{ij} = -(\\partial_k \\partial_i h^k_j + \\partial_k \\partial_j h^k_i - \\partial_i \\partial_j h - \\nabla^2 h_{ij})$$\nrearranging this gives:\n$$\\ddot{h}_{ij} - \\nabla^2 h_{ij} = -\\partial_i(\\partial^k h_{kj}) - \\partial_j(\\partial^k h_{ki}) + \\partial_i \\partial_j h$$\n\nA general spatial metric perturbation $h_{ij}$ has $6$ independent components. However, not all of these correspond to physical degrees of freedom. The theory of General Relativity is gauge-invariant, meaning that some components of the metric can be changed by a coordinate transformation without altering the physical situation. These are called gauge modes.\n\nA spatial symmetric tensor field $h_{ij}$ can be decomposed into parts with different transformation properties under spatial rotations. The decomposition relevant here is into a transverse-traceless part, and parts constructed from a vector and scalars. The parts of $h_{ij}$ that can be written as $\\partial_i \\zeta_j + \\partial_j \\zeta_i$ for some vector field $\\zeta_i$ are pure gauge, as they can be removed by an infinitesimal coordinate transformation $x^i \\rightarrow x^i - \\zeta^i$.\n\nThe physical degrees of freedom of the gravitational field are those that cannot be removed by such a transformation. These are contained in the **transverse-traceless (TT)** sector of the metric perturbation, denoted $h^{\\mathrm{TT}}_{ij}$. This sector is defined by two conditions:\n1.  **Transverse:** $\\partial^j h^{\\mathrm{TT}}_{ij} = 0$\n2.  **Traceless:** $\\delta^{ij} h^{\\mathrm{TT}}_{ij} = 0$ (so $h^{\\mathrm{TT}}=0$)\n\nA symmetric $3 \\times 3$ tensor has $6$ components. The transverse condition imposes $3$ constraints, and the traceless condition imposes $1$. However, one constraint is redundant, leaving $6-4=2$ independent components in $h^{\\mathrm{TT}}_{ij}$. These two components correspond to the two polarization states of a gravitational wave. The remaining $4$ components of $h_{ij}$ are gauge modes.\n\nLet us verify that this TT sector is consistent with the linearized dynamics. If we consider a solution that is purely transverse-traceless, $h_{ij} = h^{\\mathrm{TT}}_{ij}$:\n- The wave equation $\\ddot{h}_{ij} - \\nabla^2 h_{ij} = -\\partial_i(\\partial^k h_{kj}) - \\partial_j(\\partial^k h_{ki}) + \\partial_i \\partial_j h$ simplifies because $\\partial^k h_{kj}=0$ and $h=0$. The entire right-hand side vanishes, leaving a simple wave equation:\n  $$\\ddot{h}^{\\mathrm{TT}}_{ij} - \\nabla^2 h^{\\mathrm{TT}}_{ij} = 0$$\n- The linearized Hamiltonian constraint $\\partial_i \\partial_j h^{ij} - \\nabla^2 h = 0$ is satisfied: $\\partial_i(\\partial_j h^{ij}) - \\nabla^2(0) = 0$.\n- The linearized momentum constraint $\\partial_j (\\kappa^{ij} - \\delta^{ij}\\kappa) = 0$ becomes, using $\\kappa_{ij} = -\\frac{1}{2}\\dot{h}_{ij}$, $\\partial_j (-\\frac{1}{2}\\dot{h}^{ij} - \\delta^{ij}(-\\frac{1}{2}\\dot{h})) = 0$. For a TT mode, this simplifies to $\\partial_j(-\\frac{1}{2}\\dot{h}^{ij}) = -\\frac{1}{2}\\frac{\\partial}{\\partial t}(\\partial_j h^{ij}) = 0$.\n\nThus, the transverse-traceless sector represents the physical, propagating gravitational waves. The remaining sectors are the non-physical gauge modes.\n\n### Step 4: Derivation of the Dispersion Relation\nWe now seek the dispersion relation for these physical modes by using the plane-wave ansatz provided for $h^{\\mathrm{TT}}_{ij}$:\n$$h^{\\mathrm{TT}}_{ij}(t,\\mathbf{x}) = \\epsilon_{ij} \\exp\\big(i(k_{m} x^{m} - \\omega t)\\big)$$\nwhere $\\epsilon_{ij}$ is the constant polarization tensor, $\\mathbf{k}$ is the wave-vector with components $k_m$, and $\\omega$ is the angular frequency. The properties of the TT mode are encoded in $\\epsilon_{ij}$:\n- Traceless: $\\delta^{ij}\\epsilon_{ij} = 0$\n- Transverse: $k^j \\epsilon_{ij} = 0$\n\nWe substitute this ansatz into the wave equation for the TT modes, $\\ddot{h}^{\\mathrm{TT}}_{ij} - \\nabla^2 h^{\\mathrm{TT}}_{ij} = 0$.\nFirst, we compute the necessary derivatives:\n- Time derivatives: $\\frac{\\partial}{\\partial t} h^{\\mathrm{TT}}_{ij} = -i\\omega h^{\\mathrm{TT}}_{ij}$, which implies $\\ddot{h}^{\\mathrm{TT}}_{ij} = (-i\\omega)^2 h^{\\mathrm{TT}}_{ij} = -\\omega^2 h^{\\mathrm{TT}}_{ij}$.\n- Spatial derivatives: $\\partial_l h^{\\mathrm{TT}}_{ij} = ik_l h^{\\mathrm{TT}}_{ij}$. The Laplacian is $\\nabla^2 h^{\\mathrm{TT}}_{ij} = \\delta^{lm}\\partial_l\\partial_m h^{\\mathrm{TT}}_{ij} = \\delta^{lm}(ik_l)(ik_m)h^{\\mathrm{TT}}_{ij} = -(\\delta^{lm}k_l k_m)h^{\\mathrm{TT}}_{ij} = -|\\mathbf{k}|^2 h^{\\mathrm{TT}}_{ij}$.\n\nSubstituting these results into the wave equation:\n$$(-\\omega^2) h^{\\mathrm{TT}}_{ij} - (-|\\mathbf{k}|^2) h^{\\mathrm{TT}}_{ij} = 0$$\n$$(|\\mathbf{k}|^2 - \\omega^2) h^{\\mathrm{TT}}_{ij} = 0$$\nFor a non-trivial wave solution ($h^{\\mathrm{TT}}_{ij} \\neq 0$), the coefficient must be zero:\n$$|\\mathbf{k}|^2 - \\omega^2 = 0$$\n$$\\omega^2 = |\\mathbf{k}|^2$$\nAssuming a positive frequency $\\omega > 0$, we find the dispersion relation:\n$$\\omega = |\\mathbf{k}|$$\nThis linear dispersion relation signifies that the waves are non-dispersive and propagate at a speed $\\frac{\\omega}{|\\mathbf{k}|} = 1$. This corresponds to the speed of light, as expected for gravitational waves in vacuum General Relativity, consistent with our choice of units where $c=1$.",
            "answer": "$$\\boxed{\\omega = |\\mathbf{k}|}$$"
        },
        {
            "introduction": "In numerical relativity, the choice of coordinates, or gauge, is not a passive decision but an active component that determines the stability of a long-term evolution. This exercise delves into the crucial topic of slicing conditions, which govern the time-flow of the spatial hypersurfaces. By analyzing the propagation speeds of gauge modes under different lapse-setting prescriptions, you will gain insight into the mathematical conditions required for a well-posed and stable simulation .",
            "id": "3489081",
            "problem": "Consider the vacuum Einstein equations written in the Arnowitt-Deser-Misner (ADM) formalism. The canonical variables are the spatial metric $\\gamma_{ij}$, its extrinsic curvature $K_{ij}$, the lapse $\\alpha$, and the shift $\\beta^{i}$. In vacuum, the fundamental evolution equations are\n$$\n\\partial_t \\gamma_{ij} = -2 \\alpha K_{ij} + \\nabla_i \\beta_j + \\nabla_j \\beta_i,\n$$\n$$\n\\partial_t K_{ij} = -\\nabla_i \\nabla_j \\alpha + \\alpha \\left( R_{ij} + K K_{ij} - 2 K_{ik} K^{k}{}_{j} \\right),\n$$\nwhere $R_{ij}$ is the Ricci tensor of $\\gamma_{ij}$, $K = \\gamma^{ij} K_{ij}$ is the trace of $K_{ij}$, and $\\nabla_i$ denotes the spatial covariant derivative compatible with $\\gamma_{ij}$.\n\nAssume a Minkowski background with $\\gamma_{ij} = \\delta_{ij}$, $\\alpha = 1$, $\\beta^{i} = 0$, and $K_{ij} = 0$, and consider small perturbations. Define the lapse perturbation $a$ by $\\alpha = 1 + a$ with $|a| \\ll 1$, and let $k$ denote the perturbation of the trace $K$.\n\nAdopt a slicing condition from the Bona-Massó family, specified by\n$$\n\\partial_t \\alpha - \\beta^{i} \\partial_i \\alpha = - \\alpha^{2} f(\\alpha) K,\n$$\nwhere $f(\\alpha)$ is a smooth positive function, and where the special case of harmonic slicing is recovered by $f(\\alpha) = 1$. Linearize this slicing condition around the Minkowski background and derive the coupled linearized evolution equations for $a$ and $k$. Using these, determine the dispersion relation for plane-wave gauge perturbations $a$ of the form $a \\propto \\exp(i k_j x^j - i \\omega t)$, and hence compute the characteristic speed $c_g = \\omega/|\\mathbf{k}|$ of the gauge mode in the coordinate frame.\n\nReport your final answer as a single $1\\times 2$ row matrix containing the two characteristic speeds: first for harmonic slicing, and second for the general Bona-Massó family expressed in terms of $f_0 = f(1)$. No units are required. If any stability condition arises from the requirement that the characteristic speeds be real, explain it in your derivation, but do not include it in the final reported values.",
            "solution": "The problem requires the derivation of the characteristic speed of gauge perturbations within the Arnowitt-Deser-Misner (ADM) formalism, under a specific family of slicing conditions. The procedure involves linearizing the relevant evolution equations around a Minkowski background, forming a wave equation for the gauge perturbations, and then extracting the dispersion relation and propagation speed.\n\nThe starting point is the set of vacuum ADM evolution equations and the Bona-Massó slicing condition. The fundamental variables are the spatial metric $\\gamma_{ij}$, its extrinsic curvature $K_{ij}$, the lapse function $\\alpha$, and the shift vector $\\beta^i$. The provided equations are:\n$$\n\\partial_t \\gamma_{ij} = -2 \\alpha K_{ij} + \\nabla_i \\beta_j + \\nabla_j \\beta_i\n$$\n$$\n\\partial_t K_{ij} = -\\nabla_i \\nabla_j \\alpha + \\alpha \\left( R_{ij} + K K_{ij} - 2 K_{ik} K^{k}{}_{j} \\right)\n$$\nAnd the Bona-Massó slicing condition:\n$$\n\\partial_t \\alpha - \\beta^{i} \\partial_i \\alpha = - \\alpha^{2} f(\\alpha) K\n$$\nwhere $K = \\gamma^{ij} K_{ij}$ is the trace of the extrinsic curvature and $R_{ij}$ is the Ricci tensor of the spatial metric $\\gamma_{ij}$.\n\nWe linearize these equations around a flat Minkowski background, which is specified by $\\gamma_{ij} = \\delta_{ij}$, $K_{ij} = 0$, $\\alpha = 1$, and $\\beta^i = 0$. We introduce small perturbations: the lapse perturbation $a$ is defined by $\\alpha = 1 + a$ with $|a| \\ll 1$, and $k$ is the first-order perturbation of the trace of the extrinsic curvature, so $K \\approx k$. All other perturbations, such as the metric perturbation $h_{ij}$ (where $\\gamma_{ij} = \\delta_{ij} + h_{ij}$), the shift $\\beta^i$, and the extrinsic curvature $K_{ij}$ itself, are considered first-order quantities.\n\nFirst, we linearize the Bona-Massó slicing condition.\n$$\n\\partial_t (1+a) - \\beta^{i} \\partial_i (1+a) = - (1+a)^{2} f(1+a) k\n$$\nThe term $\\beta^i \\partial_i(1+a) = \\beta^i \\partial_i a$ is a product of two first-order quantities, so it is of second order and vanishes in the linearization. The left side becomes $\\partial_t a$.\nOn the right side, we expand to first order: $(1+a)^2 \\approx 1+2a$, and $f(1+a) \\approx f(1) + f'(1)a$.\nThe right side is $-(1+2a)(f(1) + f'(1)a)k$. Since $a$ and $k$ are both first-order quantities, their product is second-order. Retaining only the first-order terms, we get $-(1)(f(1))k$.\nLet's define $f_0 = f(1)$. The linearized slicing condition is:\n$$\n\\partial_t a = -f_0 k\n$$\nThis provides the first of two coupled equations for the gauge variables $a$ and $k$.\n\nNext, we linearize the evolution equation for $K_{ij}$ and then take its trace to find an evolution equation for $k$.\n$$\n\\partial_t K_{ij} = -\\nabla_i \\nabla_j \\alpha + \\alpha \\left( R_{ij} + K K_{ij} - 2 K_{ik} K^{k}{}_{j} \\right)\n$$\nThe terms $K K_{ij}$ and $K_{ik} K^k_j$ are products of first-order quantities, making them second-order. They vanish in the linearization.\nThe term $\\alpha R_{ij} = (1+a)R_{ij}$. The Ricci tensor $R_{ij}$ of the perturbed metric is itself a first-order quantity. Thus, the product $a R_{ij}$ is second-order and vanishes. The term linearizes to $R_{ij}$.\nThe term $-\\nabla_i \\nabla_j \\alpha = -\\nabla_i \\nabla_j (1+a) = -\\nabla_i \\nabla_j a$. In a perturbed geometry, $\\nabla_i\\nabla_j a = \\partial_i\\partial_j a - \\Gamma^l_{ij}\\partial_l a$. The Christoffel symbols $\\Gamma^l_{ij}$ are first-order in the metric perturbation $h_{ij}$. Thus, the term $\\Gamma^l_{ij}\\partial_l a$ is second-order. To first order, we have $\\nabla_i \\nabla_j a \\approx \\partial_i \\partial_j a$.\nSo, the linearized evolution equation for $K_{ij}$ is:\n$$\n\\partial_t K_{ij} = -\\partial_i \\partial_j a + R_{ij}\n$$\nNow we take the trace to get an equation for $k$. The trace is $K = \\gamma^{ij} K_{ij}$. Its time derivative is $\\partial_t K = (\\partial_t \\gamma^{ij}) K_{ij} + \\gamma^{ij} (\\partial_t K_{ij})$. The term $(\\partial_t \\gamma^{ij}) K_{ij}$ is second-order, so to first order, $\\partial_t k \\approx \\delta^{ij} \\partial_t K_{ij}$.\nTaking the trace of the linearized equation for $K_{ij}$:\n$$\n\\partial_t k \\approx \\delta^{ij} (\\partial_t K_{ij}) = \\delta^{ij}(-\\partial_i \\partial_j a + R_{ij}) = -\\nabla^2 a + R\n$$\nwhere $\\nabla^2 = \\delta^{ij}\\partial_i\\partial_j$ is the flat-space Laplacian and $R = \\delta^{ij}R_{ij}$ is the linearized Ricci scalar of the spatial metric. The Ricci scalar $R$ depends on the physical metric perturbations $h_{ij}$ and couples the gauge dynamics to the gravitational wave dynamics. The problem asks for the properties of the \"gauge perturbations\". To isolate the dynamics of the gauge sector, it is standard to assume the absence of physical perturbations, which corresponds to setting $R=0$. This reduces the system to a self-contained set of equations for the gauge variables $a$ and $k$. With this well-justified assumption, our second linearized equation is:\n$$\n\\partial_t k = -\\nabla^2 a\n$$\nWe now have a closed system of two coupled first-order linear partial differential equations:\n\n1.  $\\partial_t a = -f_0 k$\n2.  $\\partial_t k = -\\nabla^2 a$\n\nTo find the dispersion relation, we combine these into a single second-order equation. We differentiate the first equation with respect to time $t$:\n$$\n\\partial_t^2 a = -f_0 \\partial_t k\n$$\nSubstituting the second equation into this gives:\n$$\n\\partial_t^2 a = -f_0(-\\nabla^2 a) = f_0 \\nabla^2 a\n$$\nThis gives the wave equation for the lapse perturbation $a$:\n$$\n\\partial_t^2 a - f_0 \\nabla^2 a = 0\n$$\nThis is a standard wave equation of the form $\\frac{1}{c^2}\\partial_t^2 \\phi - \\nabla^2 \\phi = 0$. By comparison, the squared propagation speed is $c^2=f_0$.\n\nTo formally derive the speed, we assume a plane-wave solution for the gauge mode $a$ of the form $a \\propto \\exp(i k_j x^j - i \\omega t)$. Substituting this ansatz into the wave equation yields:\n$$\n(-i\\omega)^2 a - f_0 (i k_j)(i k^j) a = 0\n$$\n$$\n-\\omega^2 a - f_0 (-|\\mathbf{k}|^2) a = 0\n$$\n$$\n(-\\omega^2 + f_0 |\\mathbf{k}|^2) a = 0\n$$\nFor a non-trivial solution ($a \\neq 0$), the expression in the parenthesis must be zero. This gives the dispersion relation:\n$$\n\\omega^2 = f_0 |\\mathbf{k}|^2\n$$\nThe characteristic speed of the gauge mode is $c_g = \\frac{\\omega}{|\\mathbf{k}|}$. From the dispersion relation, we find:\n$$\nc_g^2 = \\frac{\\omega^2}{|\\mathbf{k}|^2} = f_0 \\quad \\implies \\quad c_g = \\sqrt{f_0}\n$$\nThe problem statement specifies that $f(\\alpha)$ is a \"smooth positive function\". This means $f_0 = f(1) > 0$. Consequently, the characteristic speed $c_g$ is always real, and the corresponding gauge system is stable (its evolution equations are hyperbolic).\n\nWe can now find the specific speeds requested.\n1.  For harmonic slicing, $f(\\alpha)=1$. This implies $f_0 = f(1) = 1$. The characteristic speed is:\n    $$\n    c_g = \\sqrt{1} = 1\n    $$\n    This is the speed of light, as expected for perturbations in the harmonic gauge.\n2.  For the general Bona-Massó family, the characteristic speed is expressed in terms of $f_0 = f(1)$:\n    $$\n    c_g = \\sqrt{f_0}\n    $$\nThe final answer is presented as a $1 \\times 2$ row matrix containing these two speeds.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & \\sqrt{f_0} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond evolving the spacetime geometry, the ADM formalism provides tools to compute fundamental physical quantities. This exercise focuses on calculating one of the most important invariants of an asymptotically flat spacetime: the total mass-energy, or ADM mass. You will translate the formal surface integral definition of the ADM mass into a concrete numerical algorithm and apply it to the Kerr black hole spacetime, providing a direct link between the metric components and a key physical observable .",
            "id": "3489121",
            "problem": "You will implement and verify the Arnowitt–Deser–Misner (ADM) energy (ADM) surface integral for an asymptotically flat, vacuum black hole spacetime represented in Kerr–Schild coordinates. The target quantity is the ADM mass, defined by the surface integral at spatial infinity, which is a global invariant of the metric. Work strictly in geometric units with $G=c=1$, so masses, lengths, and times are all measured in the same unit and are dimensionless in these units. Angles must be treated in radians.\n\nFundamental base and definitions:\n- The ADM mass for an asymptotically flat three-metric $\\gamma_{ij}$ on a constant time slice is given by\n$$\nM_{\\mathrm{ADM}} = \\frac{1}{16\\pi}\\lim_{r\\to\\infty}\\oint_{S_r} \\left(\\partial_j \\gamma_{ij} - \\partial_i \\gamma_{jj}\\right)n^i\\,dS,\n$$\nwhere $n^i$ is the outward unit normal to the sphere $S_r$, $dS$ is the area element, and $\\partial_i$ is the spatial partial derivative with respect to the Cartesian coordinate $x^i$.\n- In Kerr–Schild coordinates, the spacetime metric takes the form\n$$\ng_{\\mu\\nu} = \\eta_{\\mu\\nu} + 2H\\,\\ell_{\\mu}\\ell_{\\nu},\n$$\nwhere $\\eta_{\\mu\\nu}$ is the Minkowski metric, $H$ is a scalar function, and $\\ell_\\mu$ is a null covector field with respect to both $g_{\\mu\\nu}$ and $\\eta_{\\mu\\nu}$. On a constant time slice, the induced three-metric is\n$$\n\\gamma_{ij} = \\delta_{ij} + 2H\\,\\ell_i \\ell_j,\n$$\nwhere $\\delta_{ij}$ is the Euclidean three-metric.\n- For the Kerr black hole of mass $M$ and specific angular momentum $a$ (spin parameter), define\n$$\n\\rho^2 = x^2 + y^2 + z^2,\n\\qquad\nr^2 = \\frac{1}{2}\\left(\\rho^2 - a^2\\right) + \\frac{1}{2}\\sqrt{\\left(\\rho^2 - a^2\\right)^2 + 4a^2 z^2},\n$$\n$$\nH = \\frac{M r^3}{r^4 + a^2 z^2},\n\\qquad\n\\ell_i = \\left(\\frac{r x + a y}{r^2 + a^2},\\ \\frac{r y - a x}{r^2 + a^2},\\ \\frac{z}{r}\\right).\n$$\nFor the Schwarzschild limit $a=0$, these reduce to $r = \\sqrt{x^2+y^2+z^2}$, $H = M/r$, and $\\ell_i = (x/r, y/r, z/r)$.\n\nYour task:\n1. Starting from the ADM mass surface integral definition, design a discrete approximation on a spherical surface of coordinate radius $R$ using a uniform angular grid of $N_\\theta$ points in polar angle $\\theta\\in[0,\\pi]$ and $N_\\phi$ points in azimuthal angle $\\phi\\in[0,2\\pi)$. Use the midpoint rule\n$$\n\\theta_k = \\left(k+\\frac{1}{2}\\right)\\frac{\\pi}{N_\\theta},\\quad k=0,\\ldots,N_\\theta-1,\n\\qquad\n\\phi_m = \\left(m+\\frac{1}{2}\\right)\\frac{2\\pi}{N_\\phi},\\quad m=0,\\ldots,N_\\phi-1,\n$$\nwith angular increments $\\Delta\\theta = \\pi/N_\\theta$ and $\\Delta\\phi = 2\\pi/N_\\phi$.\n2. For each surface point at Cartesian coordinates\n$$\nx = R \\sin\\theta \\cos\\phi,\\quad y = R \\sin\\theta \\sin\\phi,\\quad z = R \\cos\\theta,\n$$\ncompute the three-metric $\\gamma_{ij}(x,y,z)$ by the Kerr–Schild formula above. Approximate the required spatial derivatives by second-order central finite differences with a step size $h=\\epsilon R$ in each Cartesian direction, where $\\epsilon$ is a small dimensionless parameter. Specifically, approximate\n$$\n\\partial_x \\gamma_{ij} \\approx \\frac{\\gamma_{ij}(x+h,y,z) - \\gamma_{ij}(x-h,y,z)}{2h},\n\\quad\n\\partial_y \\gamma_{ij} \\approx \\frac{\\gamma_{ij}(x,y+h,z) - \\gamma_{ij}(x,y-h,z)}{2h},\n\\quad\n\\partial_z \\gamma_{ij} \\approx \\frac{\\gamma_{ij}(x,y,z+h) - \\gamma_{ij}(x,y,z-h)}{2h}.\n$$\nUse these to form the discrete approximation of the integrand\n$$\n\\mathcal{I}(x,y,z) \\approx \\left[\\sum_{j\\in\\{x,y,z\\}} \\partial_j \\gamma_{ij}\\, \\hat{n}^i\\right] - \\left[\\sum_{i\\in\\{x,y,z\\}} \\partial_i \\left(\\sum_{j\\in\\{x,y,z\\}} \\gamma_{jj}\\right)\\, \\hat{n}^i\\right],\n$$\nwhere $\\hat{n}^i = x^i / R$ is the outward unit normal, and indices $i$ and $j$ correspond to Cartesian components $(x,y,z)$.\n3. Approximate the surface integral by\n$$\n\\oint_{S_R} \\left(\\partial_j \\gamma_{ij} - \\partial_i \\gamma_{jj}\\right)\\hat{n}^i\\,dS\n\\approx\n\\sum_{k=0}^{N_\\theta-1}\\sum_{m=0}^{N_\\phi-1} \\mathcal{I}(\\theta_k,\\phi_m)\\, R^2 \\sin\\theta_k\\,\\Delta\\theta\\,\\Delta\\phi.\n$$\nFinally compute\n$$\nM_{\\mathrm{ADM}}(R, N_\\theta, N_\\phi, \\epsilon) = \\frac{1}{16\\pi}\\times\\text{(discrete surface integral above)}.\n$$\n\nScientific realism and derivation requirement:\n- Begin from the provided ADM definition and the Kerr–Schild metric form; no other shortcut formulas are allowed.\n- Justify the angular and finite difference discretizations as consistent second-order approximations.\n- Explain, for the Schwarzschild case $a=0$, how the analytic derivatives imply the integrand is constant over the sphere and why this yields the exact ADM mass independent of $R$, while numerically the result will converge with angular and finite difference resolution.\n\nUnits and output:\n- Use geometric units with $G=c=1$; all quantities are dimensionless in these units. Angles must be in radians.\n- For each test case, output the absolute error $|M_{\\mathrm{ADM}} - M|$ as a float.\n\nTest suite and required final output format:\n- Implement the program for the following five test cases, each specified by the tuple $(M,a,R,N_\\theta,N_\\phi,\\epsilon)$:\n    1. $(1.0, 0.0, 10.0, 64, 128, 10^{-3})$.\n    2. $(1.0, 0.7, 2.0, 64, 128, 10^{-3})$.\n    3. $(1.0, 0.7, 10.0, 64, 128, 10^{-3})$.\n    4. $(1.0, 0.7, 50.0, 64, 128, 10^{-3})$.\n    5. $(1.0, 0.0, 2.0, 64, 128, 10^{-3})$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[result1,result2,result3,result4,result5]\"), where each result corresponds to the absolute error for the respective test case in the order listed above.",
            "solution": "` tag):**\n    *   **Introduction:** I will begin by stating the problem's objective: to numerically compute the ADM mass of a Kerr black hole using a surface integral at a finite radius, based on the provided Kerr-Schild form of the metric and a specified discretization scheme.\n    *   **Analytic Foundation and Schwarzschild Case:**\n        *   The ADM mass is defined as $M_{\\mathrm{ADM}} = \\frac{1}{16\\pi}\\lim_{r\\to\\infty}\\oint_{S_r} V_i n^i\\,dS$, where the vector field $V_i = \\partial_j \\gamma_{ij} - \\partial_i \\gamma_{jj}$. The indices $i,j$ are Cartesian and run from $1$ to $3$, with summation over repeated indices implied.\n        *   As required, I will first analyze the Schwarzschild case ($a=0$). In this limit, the Kerr-Schild quantities simplify: $r=\\rho=\\sqrt{x^2+y^2+z^2}$, $H = M/r$, and the null vector components are $\\ell_i = x_i/r$.\n        *   The three-metric is $\\gamma_{ij} = \\delta_{ij} + 2H \\ell_i \\ell_j = \\delta_{ij} + \\frac{2M}{r} \\frac{x_i x_j}{r^2} = \\delta_{ij} + \\frac{2M x_i x_j}{r^3}$.\n        *   I will compute the derivatives required for the integrand. The partial derivative of the metric is $\\partial_k \\gamma_{ij} = \\frac{2M}{r^3}(\\delta_{ki}x_j + \\delta_{kj}x_i) - \\frac{6M x_i x_j x_k}{r^5}$.\n        *   Then, compute the two terms of the vector $V_i$.\n            *   The first term is the divergence-like term $\\partial_j \\gamma_{ij} = \\sum_j \\partial_j \\gamma_{ij}$. Using the derivative above, this simplifies to $\\partial_j \\gamma_{ij} = \\frac{2M x_i}{r^3}$.\n            *   The second term requires the trace $\\gamma_{jj} = \\sum_j \\gamma_{jj} = 3 + 2H \\ell_j \\ell_j = 3 + 2M/r$. Its gradient is $\\partial_i \\gamma_{jj} = \\partial_i (3 + 2M/r) = - \\frac{2M x_i}{r^3}$.\n        *   Combining these gives the vector field $V_i = \\frac{2M x_i}{r^3} - (-\\frac{2M x_i}{r^3}) = \\frac{4M x_i}{r^3}$.\n        *   The integrand is the projection of $V_i$ onto the outward normal $n^i = x^i/R$ of a sphere of coordinate radius $R$. On this sphere, $r=R$, and the integrand is $V_i n^i = (\\frac{4M x_i}{R^3})(\\frac{x_i}{R}) = \\frac{4M}{R^4}\\sum_i x_i^2 = \\frac{4M R^2}{R^4} = \\frac{4M}{R^2}$.\n        *   Since the integrand is constant over the sphere, the integral is simply the integrand times the area of the sphere ($4\\pi R^2$): $\\oint_{S_R} V_i n^i dS = \\frac{4M}{R^2} (4\\pi R^2) = 16\\pi M$.\n        *   Finally, $M_{\\mathrm{ADM}} = \\frac{1}{16\\pi} (16\\pi M) = M$.\n        *   This derivation shows that for the Schwarzschild metric in these coordinates, the ADM integral yields the exact mass $M$ at any finite radius $R$, not just at infinity. This provides a crucial benchmark for the numerical code. Numerical errors (from finite differences and a finite grid) will cause the computed value to deviate from $M$, but it should converge to $M$ as the numerical resolution increases.\n    *   **Numerical Implementation Strategy:**\n        *   The goal is to approximate $M_{\\mathrm{ADM}}(R) = \\frac{1}{16\\pi} \\sum_{k=0}^{N_\\theta-1}\\sum_{m=0}^{N_\\phi-1} \\mathcal{I}(\\theta_k,\\phi_m)\\, R^2 \\sin\\theta_k\\,\\Delta\\theta\\,\\Delta\\phi$, where $\\mathcal{I}$ is the integrand.\n        *   The algorithm proceeds as follows:\n            1.  Define the angular grid points $(\\theta_k, \\phi_m)$ using the midpoint rule and the increments $\\Delta\\theta, \\Delta\\phi$.\n            2.  Iterate through each point on the grid. For each $(\\theta_k, \\phi_m)$, calculate the corresponding Cartesian coordinates $(x,y,z)$.\n            3.  At each point $(x,y,z)$, calculate the integrand $\\mathcal{I}$. This is the most intensive step.\n            4.  To calculate $\\mathcal{I} = (\\partial_j \\gamma_{ij} - \\partial_i \\gamma_{jj})n^i$, the spatial derivatives are approximated using second-order central finite differences with step size $h = \\epsilon R$. This requires evaluating the metric $\\gamma_{ij}$ at points $(x\\pm h, y, z)$, $(x, y\\pm h, z)$, and $(x, y, z\\pm h)$.\n            5.  A helper function will be designed to compute $\\gamma_{ij}(x,y,z)$ from the given Kerr-Schild formulas. This involves calculating $\\rho^2, r^2, H$, and the vector $\\ell_i$.\n            6.  The derivative approximations will be used to compute the two vector quantities: $A_i = \\partial_j \\gamma_{ij}$ and $B_i = \\partial_i \\gamma_{jj}$. The integrand vector is $V_i = A_i - B_i$.\n            7.  The scalar integrand is then found by dotting $V_i$ with the normal vector $n^i = x^i/R$.\n            8.  The contribution from the current grid point, $\\mathcal{I}(\\theta_k, \\phi_m) \\times R^2 \\sin\\theta_k\\,\\Delta\\theta\\,\\Delta\\phi$, is added to a running sum.\n            9.  After iterating over all grid points, the final sum is multiplied by $1/(16\\pi)$ to yield the numerical approximation $M_{\\mathrm{ADM}}$.\n    *   **Justification of Discretization:** The method's consistency is ensured by the choice of second-order schemes. The midpoint rule for numerical integration offers second-order accuracy in the angular step sizes, i.e., error $\\propto (\\Delta\\theta)^2, (\\Delta\\phi)^2$. The central finite difference scheme for derivatives provides second-order accuracy in the spatial step size, i.e., error $\\propto h^2$. The overall numerical error is thus expected to have second-order convergence as grid resolution is increased and the finite difference step size is decreased.\n\nThis structured approach, founded on the analytic properties of the solution and implemented via a consistent numerical scheme, will be used to generate the required Python program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for ADM mass calculation.\n    \"\"\"\n    # Test cases: (M, a, R, N_theta, N_phi, epsilon)\n    test_cases = [\n        (1.0, 0.0, 10.0, 64, 128, 1e-3),\n        (1.0, 0.7, 2.0, 64, 128, 1e-3),\n        (1.0, 0.7, 10.0, 64, 128, 1e-3),\n        (1.0, 0.7, 50.0, 64, 128, 1e-3),\n        (1.0, 0.0, 2.0, 64, 128, 1e-3),\n    ]\n\n    results = []\n    for M, a, R, N_theta, N_phi, epsilon in test_cases:\n        m_adm = calculate_adm_mass(M, a, R, N_theta, N_phi, epsilon)\n        error = abs(m_adm - M)\n        results.append(error)\n    \n    # Format the output as a comma-separated list in brackets.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef get_gamma(x: float, y: float, z: float, M: float, a: float) -> np.ndarray:\n    \"\"\"\n    Calculates the 3-metric gamma_ij at a given Cartesian point (x, y, z)\n    for a Kerr black hole with mass M and spin a.\n    \"\"\"\n    rho2 = x**2 + y**2 + z**2\n    a2 = a**2\n    \n    if a == 0:\n        # Schwarzschild case\n        if rho2 == 0:\n            return np.identity(3) # Origin, not hit on integration surface\n        r = np.sqrt(rho2)\n        H = M / r\n        l_vec = np.array([x, y, z]) / r\n    else:\n        # Kerr case\n        term = rho2 - a2\n        # The term inside sqrt is non-negative.\n        sq_term = np.sqrt(term**2 + 4 * a2 * z**2)\n        r2 = 0.5 * (term + sq_term)\n        \n        # Avoid division by zero at the ring singularity, though not expected on surface.\n        if r2 == 0 and a2 * z**2 == 0:\n             return np.identity(3)\n        \n        r = np.sqrt(r2)\n        \n        # Denominator in H can be zero only at r=0 and z=0 (singularity).\n        H = M * r**3 / (r**4 + a2 * z**2)\n        \n        # Denominator in l_vec components can be zero if r=0 and a=0. Handled by a==0 case.\n        l0 = (r * x + a * y) / (r2 + a2)\n        l1 = (r * y - a * x) / (r2 + a2)\n        l2 = z / r\n        l_vec = np.array([l0, l1, l2])\n        \n    # gamma_ij = delta_ij + 2*H*l_i*l_j\n    gamma = np.identity(3) + 2 * H * np.outer(l_vec, l_vec)\n    return gamma\n\ndef calculate_adm_mass(M: float, a: float, R: float, N_theta: int, N_phi: int, epsilon: float) -> float:\n    \"\"\"\n    Numerically computes the ADM mass using a surface integral on a sphere\n    of coordinate radius R.\n    \"\"\"\n    h = epsilon * R\n    d_theta = np.pi / N_theta\n    d_phi = 2 * np.pi / N_phi\n    \n    integral_sum = 0.0\n    \n    dir_vectors = np.array([[h, 0, 0], [0, h, 0], [0, 0, h]])\n\n    # Loop over the spherical grid points (midpoint rule)\n    for k in range(N_theta):\n        theta = (k + 0.5) * d_theta\n        for m in range(N_phi):\n            phi = (m + 0.5) * d_phi\n            \n            # Cartesian coordinates of the grid point\n            x = R * np.sin(theta) * np.cos(phi)\n            y = R * np.sin(theta) * np.sin(phi)\n            z = R * np.cos(theta)\n            \n            p = np.array([x, y, z])\n            \n            # Calculate numerical derivatives_\n            # dgamma[i, j, k] will hold the numerical approximation of partial_k(gamma_ij)\n            dgamma = np.zeros((3, 3, 3))\n            \n            # grad_trace_gamma[k] will hold partial_k(trace(gamma))\n            grad_trace_gamma = np.zeros(3)\n\n            for k_dim in range(3):  # Corresponds to derivatives w.r.t. x, y, z\n                p_plus = p + dir_vectors[k_dim]\n                p_minus = p - dir_vectors[k_dim]\n                \n                gamma_plus = get_gamma(p_plus[0], p_plus[1], p_plus[2], M, a)\n                gamma_minus = get_gamma(p_minus[0], p_minus[1], p_minus[2], M, a)\n                \n                # Finite difference for the tensor gamma_ij\n                dgamma[:, :, k_dim] = (gamma_plus - gamma_minus) / (2 * h)\n                \n                # Finite difference for the trace of gamma\n                trace_plus = np.trace(gamma_plus)\n                trace_minus = np.trace(gamma_minus)\n                grad_trace_gamma[k_dim] = (trace_plus - trace_minus) / (2 * h)\n\n            # Construct the integrand vector V_i = partial_j(gamma_ij) - partial_i(gamma_jj)\n            # A_i = partial_j(gamma_ij) summed over j\n            # A = np.einsum('ijj->i', dgamma)\n            A = np.array([np.sum(dgamma[i, j, j] for j in range(3)) for i in range(3)])\n\n            # B_i = partial_i(gamma_jj)\n            B = grad_trace_gamma\n            \n            V = A - B\n            \n            # Dot product with the unit normal vector n_hat\n            n_hat = p / R\n            integrand_val = np.dot(V, n_hat)\n            \n            # Surface element dS\n            dS = R**2 * np.sin(theta) * d_theta * d_phi\n            \n            integral_sum += integrand_val * dS\n            \n    # Final ADM mass calculation\n    M_adm = integral_sum / (16 * np.pi)\n    \n    return M_adm\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}