{
    "hands_on_practices": [
        {
            "introduction": "最简单的有限差分格式精度有限。理查森外推法 (Richardson extrapolation) 是一种强大而通用的方法，它通过将低阶精度的计算结果进行线性组合，来构造一个更高阶精度的估计值，从而有效地消除了主截断误差项。这项实践将引导你从头推导并实现这一技术，让你亲手实践如何利用泰勒级数分析来提高数值计算的实际精度。",
            "id": "3525596",
            "problem": "在计算天体物理学中，当解析表达式不可用或计算成本过高时，通常需要对无量纲模型函数的梯度进行数值估算。考虑无量纲标量函数 $f(x) = \\ln(1+x)$，以及在点 $x_0 = 1$ 处估算其导数 $f'(x)$ 的任务。数值微分的基本依据是导数的定义和泰勒级数展开。从导数定义 $f'(x_0) = \\lim_{h \\to 0} \\frac{f(x_0+h) - f(x_0-h)}{2h}$ 和在 $x_0$ 点的泰勒展开出发，推导 $f'(x_0)$ 的二阶中心差分公式，确定其主截断误差项，并解释为什么该误差与步长 $h$ 的幂成比例。然后，使用在两个步长 $h_1$ 和 $h_2$（其中 $h_1 = 2 h_2$）下计算的两个二阶中心差分近似值，通过构造这两个近似值的适当线性组合，推导出一个能够消去主截断误差项的单一组合估计值。该组合估计值的获得不依赖于任何预先给定的简化公式。\n\n编写一个程序，实现所推导的流程，使用以下步长测试套件来计算函数 $f(x) = \\ln(1+x)$ 在 $x=1$ 处的改进导数估计值 $f'(1)$：\n- 情况 A (中等步长): $h_1 = 10^{-2}$ 且 $h_2 = 5 \\times 10^{-3}$。\n- 情况 B (粗步长): $h_1 = 10^{-1}$ 且 $h_2 = 5 \\times 10^{-2}$。\n- 情况 C (极细步长): $h_1 = 10^{-6}$ 且 $h_2 = 5 \\times 10^{-7}$。\n\n对每种情况，计算：\n1. 在 $h_1$ 和 $h_2$ 处的二阶中心差分近似值。\n2. 在 $x_0=1$ 处，使用推导的线性组合消去主截断误差项后的改进导数估计值。\n3. 改进估计值相对于在 $x_0=1$ 处计算的精确解析导数 $f'(x) = \\frac{1}{1+x}$（其值为 $\\frac{1}{2}$）的绝对误差。\n\n本问题中所有量均为无量纲；以无量纲单位报告绝对误差。您的程序应生成单行输出，其中包含三种情况下改进估计值的绝对误差，四舍五入到十二位小数，格式为方括号括起来的逗号分隔列表（例如，$[e_A,e_B,e_C]$，其中 $e_A$、$e_B$ 和 $e_C$ 分别是情况 A、B 和 C 的绝对误差）。",
            "solution": "## 问题验证\n\n### 第 1 步：提取已知条件\n- **函数：** 无量纲标量函数为 $f(x) = \\ln(1+x)$。\n- **任务：** 在点 $x_0 = 1$ 处估算导数 $f'(x)$。\n- **起点 1 (公式)：** 中心差分的定义以极限形式给出：$f'(x_0) = \\lim_{h \\to 0} \\frac{f(x_0+h) - f(x_0-h)}{2h}$。\n- **起点 2 (方法)：** 使用关于 $x_0$ 的泰勒展开来推导数值公式。\n- **要求 1：** 推导 $f'(x_0)$ 的二阶中心差分公式。\n- **要求 2：** 确定其主截断误差项，并解释其与步长 $h$ 的缩放关系。\n- **要求 3：** 使用在步长 $h_1$ 和 $h_2$（其中 $h_1 = 2 h_2$）下的两个近似值，推导出一个能够消去主截断误差项的组合估计值。\n- **测试用例：**\n    - 情况 A: $h_1 = 10^{-2}$, $h_2 = 5 \\times 10^{-3}$。\n    - 情况 B: $h_1 = 10^{-1}$, $h_2 = 5 \\times 10^{-2}$。\n    - 情况 C: $h_1 = 10^{-6}$, $h_2 = 5 \\times 10^{-7}$。\n- **比较值：** 精确解析导数为 $f'(x) = \\frac{1}{1+x}$，在 $x_0 = 1$ 处为 $f'(1) = \\frac{1}{2}$。\n- **输出：** 三种情况下改进估计值的绝对误差，四舍五入到十二位小数，格式为 `[e_A,e_B,e_C]`。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学性：** 该问题牢固地植根于数值分析的基本原理，特别是使用有限差分和理查森外推法的数值微分。使用泰勒级数分析截断误差是该领域的标准核心概念。函数 $f(x) = \\ln(1+x)$ 是一个标准的、性质良好的解析函数。该问题是计算科学中的一个经典例子。它在科学上和事实上都是合理的。\n2.  **适定性：** 问题定义清晰。它要求推导一种特定的数值方法，并将其应用于具有指定参数的具体函数。保证存在唯一、稳定且有意义的解。\n3.  **客观性：** 问题以精确、客观、形式化的数学语言陈述。它没有任何歧义、主观性或观点。\n4.  **完整性与一致性：** 问题是自洽的。它提供了函数、求值点、步长、步长之间的关系、用于误差计算的精确值以及精确的输出格式。所有提供的信息都是一致的。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。这是一个数值方法领域中适定的、有科学依据的问题。我将继续进行解答。\n\n## 理论推导与求解\n\n目标是首先推导二阶中心差分公式及其误差项，然后利用此结果通过理查森外推法推导更高阶的近似。\n\n### 第 1 部分：二阶中心差分公式的推导\n\n我们从函数 $f(x_0 + h)$ 和 $f(x_0 - h)$ 在点 $x_0$ 附近的泰勒级数展开开始。假设函数 $f$ 足够光滑（对于 $x>-1$，$f(x)=\\ln(1+x)$ 满足此条件），我们可以写出：\n$$\nf(x_0 + h) = f(x_0) + h f'(x_0) + \\frac{h^2}{2!} f''(x_0) + \\frac{h^3}{3!} f'''(x_0) + \\frac{h^4}{4!} f^{(4)}(x_0) + \\frac{h^5}{5!} f^{(5)}(x_0) + O(h^6)\n$$\n$$\nf(x_0 - h) = f(x_0) - h f'(x_0) + \\frac{h^2}{2!} f''(x_0) - \\frac{h^3}{3!} f'''(x_0) + \\frac{h^4}{4!} f^{(4)}(x_0) - \\frac{h^5}{5!} f^{(5)}(x_0) + O(h^6)\n$$\n为了分离出一阶导数项 $f'(x_0)$，我们将第二个展开式从第一个展开式中减去。注意，所有 $h$ 的偶数次幂项（包括 $f(x_0)$ 项，即 $h^0$ 项）都将抵消。\n$$\nf(x_0 + h) - f(x_0 - h) = 2h f'(x_0) + 2 \\frac{h^3}{3!} f'''(x_0) + 2 \\frac{h^5}{5!} f^{(5)}(x_0) + O(h^7)\n$$\n现在，我们重新整理这个方程来求解 $f'(x_0)$：\n$$\n2h f'(x_0) = \\left( f(x_0 + h) - f(x_0 - h) \\right) - \\frac{h^3}{3} f'''(x_0) - \\frac{h^5}{60} f^{(5)}(x_0) - O(h^7)\n$$\n$$\nf'(x_0) = \\frac{f(x_0 + h) - f(x_0 - h)}{2h} - \\frac{h^2}{6} f'''(x_0) - \\frac{h^4}{120} f^{(5)}(x_0) - O(h^6)\n$$\n这个方程揭示了两个关键信息：\n1.  **二阶中心差分公式**是近似式 $D_c(h) = \\frac{f(x_0 + h) - f(x_0 - h)}{2h}$。\n2.  真实导数 $f'(x_0)$ 等于这个近似值加上一系列误差项。**主截断误差项**是 $- \\frac{h^2}{6} f'''(x_0)$。因为这个主误差与 $h^2$ 成正比，所以该近似被称为“二阶精确”。误差的阶数为 $O(h^2)$。\n\n### 第 2 部分：通过理查森外推法推导改进估计值\n\n令 $A$ 为导数的精确值，即 $A = f'(x_0)$，并令 $D(h)$ 表示中心差分近似 $D_c(h)$。根据上一步，我们可以将该近似表示为 $h^2$ 的幂级数：\n$$\nD(h) = A + C_1 h^2 + C_2 h^4 + C_3 h^6 + \\dots\n$$\n其中 $C_1 = \\frac{1}{6} f'''(x_0)$，$C_2 = \\frac{1}{120} f^{(5)}(x_0)$，依此类推。我们有两个用步长 $h_1$ 和 $h_2$ 计算的近似值，其中 $h_1 = 2h_2$：\n$$\nD(h_1) = A + C_1 h_1^2 + C_2 h_1^4 + \\dots\n$$\n$$\nD(h_2) = A + C_1 h_2^2 + C_2 h_2^4 + \\dots\n$$\n我们的目标是找到 $D(h_1)$ 和 $D(h_2)$ 的一个线性组合，以消除与 $C_1 h^2$ 成正比的主误差项。令改进后的估计值为 $A_{imp}$。\n我们可以将 $h_1 = 2h_2$ 代入第一个方程：\n$$\nD(h_1) = A + C_1 (2h_2)^2 + C_2 (2h_2)^4 + \\dots = A + 4C_1 h_2^2 + 16C_2 h_2^4 + \\dots\n$$\n我们现在得到一个包含两个“未知数”（$A$ 和 $C_1$）的方程组：\n1.  $D(h_1) \\approx A + 4C_1 h_2^2$\n2.  $D(h_2) \\approx A + C_1 h_2^2$\n\n为了消去 $C_1$ 项，我们可以将第二个方程乘以 4，然后从中减去第一个方程：\n$$\n4D(h_2) - D(h_1) \\approx (4A + 4C_1 h_2^2) - (A + 4C_1 h_2^2)\n$$\n$$\n4D(h_2) - D(h_1) \\approx 3A\n$$\n解出 $A$，我们得到改进估计值的公式：\n$$\nA \\approx A_{imp} = \\frac{4D(h_2) - D(h_1)}{3}\n$$\n这就是所求的组合估计值。让我们分析其误差。代入完整的级数展开式：\n$$\nA_{imp} = \\frac{4(A + C_1 h_2^2 + C_2 h_2^4 + \\dots) - (A + C_1 h_1^2 + C_2 h_1^4 + \\dots)}{3}\n$$\n使用 $h_1 = 2h_2$：\n$$\nA_{imp} = \\frac{4(A + C_1 h_2^2 + C_2 h_2^4 + \\dots) - (A + 4C_1 h_2^2 + 16C_2 h_2^4 + \\dots)}{3}\n$$\n$$\nA_{imp} = \\frac{(4A - A) + (4C_1 - 4C_1)h_2^2 + (4C_2 - 16C_2)h_2^4 + \\dots}{3}\n$$\n$$\nA_{imp} = \\frac{3A - 12C_2 h_2^4 + \\dots}{3} = A - 4C_2 h_2^4 + \\dots\n$$\n现在主误差项为 $-4C_2 h_2^4$，与 $h^4$ 成正比。该方法现在是四阶精确的。\n\n### 第 3 部分：算法实现\n\n程序将实现这个推导出的过程。对于每个测试用例 $(h_1, h_2)$：\n1.  定义函数 $f(x) = \\ln(1+x)$ 和点 $x_0 = 1$。精确导数为 $f'(1) = 0.5$。\n2.  定义一个函数来计算中心差分近似 $D(h) = \\frac{f(x_0+h) - f(x_0-h)}{2h}$。\n3.  计算两个二阶近似值：$D_1 = D(h_1)$ 和 $D_2 = D(h_2)$。\n4.  使用推导出的公式计算改进的四阶估计值：$A_{imp} = \\frac{4D_2 - D_1}{3}$。\n5.  计算绝对误差：$E = |A_{imp} - 0.5|$。\n6.  收集所有三种情况的误差，并按指定格式打印，四舍五入到 12 位小数。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies a fourth-order finite difference scheme to estimate\n    the derivative of f(x) = ln(1+x) at x=1.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (moderate steps)\n        (1e-2, 5e-3),\n        # Case B (coarse steps)\n        (1e-1, 5e-2),\n        # Case C (very fine steps)\n        (1e-6, 5e-7),\n    ]\n\n    # Define the point of interest and the function.\n    x0 = 1.0\n    # The function f(x) = ln(1+x)\n    f = lambda x: np.log(1.0 + x)\n\n    # The exact value of the derivative f'(x) = 1/(1+x) at x_0 = 1.\n    exact_derivative = 0.5\n\n    # Helper function for the second-order central difference approximation.\n    def central_difference(h, x_val, func):\n        \"\"\"\n        Computes the second-order central difference approximation for f'(x_val).\n        \"\"\"\n        return (func(x_val + h) - func(x_val - h)) / (2.0 * h)\n\n    # List to store the absolute errors of the improved estimates.\n    absolute_errors = []\n\n    for h1, h2 in test_cases:\n        # 1. Compute the two second-order central difference approximations.\n        # D(h1) is the approximation with the larger step size.\n        d1 = central_difference(h1, x0, f)\n        # D(h2) is the approximation with the smaller step size.\n        d2 = central_difference(h2, x0, f)\n\n        # 2. Compute the improved derivative estimate (Richardson Extrapolation).\n        # This formula was derived to cancel the O(h^2) error term,\n        # resulting in an O(h^4) approximation.\n        improved_estimate = (4.0 * d2 - d1) / 3.0\n\n        # 3. Compute the absolute error of the improved estimate.\n        error = np.abs(improved_estimate - exact_derivative)\n        absolute_errors.append(error)\n\n    # Final print statement in the exact required format.\n    # The errors are rounded to 12 decimal places.\n    print(f\"[{','.join(f'{err:.12f}' for err in absolute_errors)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在理想化的数学世界中，我们可以通过减小步长 $h$ 来无限逼近真实导数，但在处理充满噪声的天体物理观测数据时，情况变得复杂。虽然减小步长可以降低截断误差，但它往往会放大测量数据中的噪声成分。本练习将从第一性原理出发，解析推导噪声方差如何通过一个有限差分算子进行传播，从而揭示在截断误差和噪声放大之间存在的基本权衡。",
            "id": "3525628",
            "problem": "一个天文台使用星载光度计以均匀采样间隔 $\\Delta t$ 监测一个变活动星系核的比光度时间序列 $L(t)$。每个离散样本 $L_{i} \\equiv L(t_{i})$ 都受到仪器主导的白光子噪声的污染，该噪声是零均值的，样本间独立，且每个样本的方差为 $\\sigma^{2}$。为了估计在时间 $t_{i}$ 的瞬时时间导数 $\\frac{dL}{dt}$，你采用由下式定义的5点4阶中心有限差分算子：\n$$\n\\left.\\frac{dL}{dt}\\right|_{t_{i}} \\approx \\frac{-L_{i+2} + 8 L_{i+1} - 8 L_{i-1} + L_{i-2}}{12\\,\\Delta t}.\n$$\n从关于独立、零均值随机变量方差的第一性原理以及有限差分估计器的线性结构出发，量化方差为 $\\sigma^{2}$ 的白噪声如何通过此导数算子传播，并推导一个关于导数估计方差的闭式解析表达式，该表达式仅用 $\\sigma$ 和 $\\Delta t$ 表示。请将你的最终答案表示为仅含 $\\sigma$ 和 $\\Delta t$ 的单个简化符号表达式；不要包含单位。",
            "solution": "该问题是有效的。这是一个在计算天体物理学和统计学中提法恰当、有科学依据的问题，要求将误差传播的第一性原理应用于一个标准的数值微分公式。所有必要信息均已提供，且术语精确。\n\n任务是确定时间导数估计的方差，我们将其记为 $\\hat{D}_{i}$。该估计器由应用于带噪声测量值 $L_j$ 的5点4阶中心有限差分算子给出：\n$$\n\\hat{D}_{i} = \\left.\\frac{dL}{dt}\\right|_{t_{i}} \\approx \\frac{-L_{i+2} + 8 L_{i+1} - 8 L_{i-1} + L_{i-2}}{12\\,\\Delta t}\n$$\n每个测量值 $L_j$ 是一个随机变量。它可以被建模为真实的、确定性的比光度 $L_{\\text{true}}(t_j)$ 与一个随机噪声项 $\\epsilon_j$ 的和：\n$$\nL_j = L_{\\text{true}}(t_j) + \\epsilon_j\n$$\n问题陈述，噪声 $\\epsilon_j$ 是零均值的，样本间独立，并具有恒定方差 $\\sigma^2$。也就是说，对于任意索引 $j$ 和 $k$：\n$$\nE[\\epsilon_j] = 0\n$$\n$$\n\\text{Var}(\\epsilon_j) = E[\\epsilon_j^2] - (E[\\epsilon_j])^2 = E[\\epsilon_j^2] = \\sigma^2\n$$\n$$\n\\text{Cov}(\\epsilon_j, \\epsilon_k) = 0 \\quad \\text{for} \\quad j \\neq k\n$$\n因此，一个测量样本 $L_j$ 的方差为：\n$$\n\\text{Var}(L_j) = \\text{Var}(L_{\\text{true}}(t_j) + \\epsilon_j)\n$$\n由于 $L_{\\text{true}}(t_j)$ 是一个确定性（非随机）量，它在方差计算中充当一个常数。一个随机变量加上一个常数的方差等于该随机变量自身的方差。因此：\n$$\n\\text{Var}(L_j) = \\text{Var}(\\epsilon_j) = \\sigma^2\n$$\n导数估计器 $\\hat{D}_{i}$ 是随机变量 $L_{i+2}$、$L_{i+1}$、$L_{i-1}$ 和 $L_{i-2}$ 的线性组合。我们可以将 $\\hat{D}_{i}$ 写成：\n$$\n\\hat{D}_{i} = c_{i+2} L_{i+2} + c_{i+1} L_{i+1} + c_{i-1} L_{i-1} + c_{i-2} L_{i-2}\n$$\n其中系数为：\n$$\nc_{i+2} = \\frac{-1}{12\\,\\Delta t}, \\quad c_{i+1} = \\frac{8}{12\\,\\Delta t}, \\quad c_{i-1} = \\frac{-8}{12\\,\\Delta t}, \\quad c_{i-2} = \\frac{1}{12\\,\\Delta t}\n$$\n方差传播的基本原理指出，对于具有系数 $a_j$ 的独立随机变量 $X_j$ 的线性组合 $Y = \\sum_j a_j X_j$，$Y$ 的方差由下式给出：\n$$\n\\text{Var}(Y) = \\sum_j a_j^2 \\text{Var}(X_j)\n$$\n在我们的情况下，随机变量是测量值 $L_j$，它们是独立的，因为它们的噪声分量 $\\epsilon_j$ 是独立的。每个 $L_j$ 的方差是 $\\sigma^2$。将此原理应用于我们的估计器 $\\hat{D}_{i}$：\n$$\n\\text{Var}(\\hat{D}_{i}) = c_{i+2}^2 \\text{Var}(L_{i+2}) + c_{i+1}^2 \\text{Var}(L_{i+1}) + c_{i-1}^2 \\text{Var}(L_{i-1}) + c_{i-2}^2 \\text{Var}(L_{i-2})\n$$\n代入系数和方差 $\\sigma^2$：\n$$\n\\text{Var}(\\hat{D}_{i}) = \\left(\\frac{-1}{12\\,\\Delta t}\\right)^2 \\sigma^2 + \\left(\\frac{8}{12\\,\\Delta t}\\right)^2 \\sigma^2 + \\left(\\frac{-8}{12\\,\\Delta t}\\right)^2 \\sigma^2 + \\left(\\frac{1}{12\\,\\Delta t}\\right)^2 \\sigma^2\n$$\n我们可以提出公因式 $\\frac{\\sigma^2}{(12\\,\\Delta t)^2}$：\n$$\n\\text{Var}(\\hat{D}_{i}) = \\frac{\\sigma^2}{(12\\,\\Delta t)^2} \\left[ (-1)^2 + 8^2 + (-8)^2 + 1^2 \\right]\n$$\n现在，我们计算系数的平方和：\n$$\n(-1)^2 + 8^2 + (-8)^2 + 1^2 = 1 + 64 + 64 + 1 = 130\n$$\n将这个和代回方差的表达式中：\n$$\n\\text{Var}(\\hat{D}_{i}) = \\frac{\\sigma^2}{(12\\,\\Delta t)^2} (130) = \\frac{130 \\sigma^2}{144 (\\Delta t)^2}\n$$\n最后，我们简化数值分数 $\\frac{130}{144}$。分子和分母都可以被2整除：\n$$\n\\frac{130}{144} = \\frac{65}{72}\n$$\n数字65和72是互质的，所以这个分数是最简形式。导数估计方差的最终表达式为：\n$$\n\\text{Var}(\\hat{D}_{i}) = \\frac{65 \\sigma^2}{72 (\\Delta t)^2}\n$$\n这个表达式量化了输入样本的方差 $\\sigma^2$ 如何通过指定的有限差分算子传播，表明所得方差被一个数值因子放大，并与时间步长 $\\Delta t$ 的平方成反比。",
            "answer": "$$\\boxed{\\frac{65 \\sigma^2}{72 \\Delta t^2}}$$"
        },
        {
            "introduction": "我们的讨论从一阶导数推进到拉普拉斯算子 ($\\nabla^2$)，它是引力、扩散等众多物理模型的基石。这项实践要求你从基本原理出发，构建一个高阶精度的三维离散拉普拉斯算子。更重要的是，它引入了各向同性 (isotropy) 的概念——这是一个至关重要的属性，因为在物理模拟中，物理定律不应依赖于计算网格的方向。你将通过分析该算子对平面波的作用来量化这种“各向同性误差”。",
            "id": "3525603",
            "problem": "在许多计算天体物理应用中，例如在均匀笛卡尔网格上求解用于自引力的牛顿泊松方程 $\\nabla^{2}\\Phi = 4\\pi G \\rho$，最小化离散微分算子中的方向偏差对于保持类波扰动在不同尺度和方向上的物理对称性至关重要。考虑一个三维 ($3$D) 均匀笛卡尔网格，其在每个坐标方向上的间距均为 $h$。设 $u(\\boldsymbol{x})$ 是一个足够光滑的标量场，在网格点 $\\boldsymbol{x}_{i,j,k} = (x_{i},y_{j},z_{k})$ 上进行采样。\n\n从泰勒展开和二阶导数作为差商极限的核心定义出发，并且不使用预先计算好的模板系数，推导一个三维空间中的四阶精度离散拉普拉斯算子 $\\Delta_{h}$。该算子使用沿每个坐标轴方向上最多相距两个步长的网格点，并满足以下性质：(i) 常数映射为零，以及 (ii) 截断误差为 $\\mathcal{O}(h^{4})$。\n\n然后，为了量化该离散算子的方向性（各向同性）误差，将 $\\Delta_{h}$ 应用于平面波 $u(\\boldsymbol{x}) = \\exp\\!\\left(i\\,\\boldsymbol{k}\\cdot\\boldsymbol{x}\\right)$（其中 $\\boldsymbol{k} = (k_{x},k_{y},k_{z})$），并将各向同性误差定义为\n$$\n\\epsilon(\\boldsymbol{k};h) \\equiv \\frac{\\Delta_{h}\\,\\exp\\!\\left(i\\,\\boldsymbol{k}\\cdot\\boldsymbol{x}\\right)}{-\\,|\\boldsymbol{k}|^{2}\\,\\exp\\!\\left(i\\,\\boldsymbol{k}\\cdot\\boldsymbol{x}\\right)} - 1,\n$$\n其中 $|\\boldsymbol{k}|^{2} = k_{x}^{2}+k_{y}^{2}+k_{z}^{2}$。请以仅包含 $k_{x}$、$k_{y}$、$k_{z}$ 和 $h$ 的单个闭式解析表达式给出 $\\epsilon(\\boldsymbol{k};h)$。不需要进行数值计算，也不需要取整。请将最终答案表示为单个解析表达式。",
            "solution": "该问题要求在三维均匀笛卡尔网格上推导一个四阶精度的离散拉普拉斯算子 $\\Delta_h$，并随后计算其各向同性误差 $\\epsilon(\\boldsymbol{k};h)$。推导过程必须基于泰勒级数展开。\n\n首先，我们推导该算子。拉普拉斯算子为 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}$。由于笛卡尔网格的对称性，我们可以先推导关于单个坐标（例如 $x$）的二阶偏导数的有限差分近似，然后将所有三个坐标的算子相加。设 $D_{xx}$ 为近似 $\\frac{\\partial^2}{\\partial x^2}$ 的离散算子。\n\n问题指定使用距离中心点最多两个步长的网格点。对于一个对称中心差分格式，我们考虑在点 $x_i-2h$、$x_i-h$、$x_i$、$x_i+h$ 和 $x_i+2h$ 处的函数值的线性组合。设 $u_j = u(x_i+jh)$。该算子可以写成：\n$$ D_{xx} u_i = \\frac{1}{h^2} \\left( c_{-2}u_{-2} + c_{-1}u_{-1} + c_0 u_0 + c_1 u_1 + c_2 u_2 \\right) $$\n对于一个对称（无偏）模板，我们必须有 $c_{-j} = c_j$。表达式简化为：\n$$ D_{xx} u_i = \\frac{1}{h^2} \\left( c_2(u_{-2} + u_2) + c_1(u_{-1} + u_1) + c_0 u_0 \\right) $$\n我们使用泰勒级数将 $u(x_i + \\delta x)$ 在 $x_i$ 处展开：\n$u(x_i \\pm sh) = u_i \\pm (sh)u'_i + \\frac{(sh)^2}{2!}u''_i \\pm \\frac{(sh)^3}{3!}u'''_i + \\frac{(sh)^4}{4!}u^{(4)}_i + \\frac{(sh)^5}{5!}u^{(5)}_i + \\frac{(sh)^6}{6!}u^{(6)}_i + \\mathcal{O}(h^7)$。\n对称和为：\n$$ u_{1} + u_{-1} = 2u_i + h^2 u''_i + \\frac{h^4}{12}u^{(4)}_i + \\frac{h^6}{360}u^{(6)}_i + \\mathcal{O}(h^8) $$\n$$ u_{2} + u_{-2} = 2u_i + 4h^2 u''_i + \\frac{16h^4}{12}u^{(4)}_i + \\frac{64h^6}{360}u^{(6)}_i + \\mathcal{O}(h^8) = 2u_i + 4h^2 u''_i + \\frac{4h^4}{3}u^{(4)}_i + \\frac{8h^6}{45}u^{(6)}_i + \\mathcal{O}(h^8) $$\n将这些代入 $D_{xx} u_i$ 的表达式中：\n$$ D_{xx} u_i = \\frac{1}{h^2} \\left[ c_2(2u_i + 4h^2 u''_i + \\frac{4h^4}{3}u^{(4)}_i + \\dots) + c_1(2u_i + h^2 u''_i + \\frac{h^4}{12}u^{(4)}_i + \\dots) + c_0 u_i \\right] $$\n按 $u$ 在 $x_i$ 处的导数项分组：\n$$ D_{xx} u_i = \\frac{1}{h^2}(2c_2+2c_1+c_0)u_i + (4c_2+c_1)u''_i + h^2\\left(\\frac{4}{3}c_2+\\frac{1}{12}c_1\\right)u^{(4)}_i + \\mathcal{O}(h^4) $$\n为了使该算子成为 $u''_i$ 的一个四阶精度近似，我们必须匹配各阶导数的系数：\n1. $u_i$ 的系数：$\\frac{1}{h^2}(2c_2+2c_1+c_0) = 0 \\implies 2c_2+2c_1+c_0 = 0$。这确保了常数场映射为零。\n2. $u''_i$ 的系数：$4c_2+c_1 = 1$。这对算子进行归一化，以近似二阶导数。\n3. $u^{(4)}_i$ 的系数：$\\frac{4}{3}c_2+\\frac{1}{12}c_1 = 0 \\implies 16c_2+c_1 = 0$。这消除了 $\\mathcal{O}(h^2)$ 误差项，从而得到 $\\mathcal{O}(h^4)$ 的精度。\n\n我们求解这个关于 $c_0, c_1, c_2$ 的三元线性方程组。\n从 (3) 式可得，$c_1 = -16c_2$。\n代入 (2) 式：$4c_2 + (-16c_2) = 1 \\implies -12c_2 = 1 \\implies c_2 = -\\frac{1}{12}$。\n则 $c_1 = -16(-\\frac{1}{12}) = \\frac{16}{12} = \\frac{4}{3}$。\n代入 (1) 式：$2(-\\frac{1}{12}) + 2(\\frac{4}{3}) + c_0 = 0 \\implies -\\frac{1}{6} + \\frac{8}{3} + c_0 = 0 \\implies -\\frac{1}{6} + \\frac{16}{6} + c_0 = 0 \\implies \\frac{15}{6} + c_0 = 0 \\implies c_0 = -\\frac{15}{6} = -\\frac{5}{2}$。\n\n由此得到的关于 $\\frac{\\partial^2 u}{\\partial x^2}$ 的四阶算子为：\n$$ D_{xx} u_i = \\frac{1}{h^2} \\left[ -\\frac{1}{12}(u_{i-2}+u_{i+2}) + \\frac{4}{3}(u_{i-1}+u_{i+1}) - \\frac{5}{2}u_i \\right] $$\n$$ D_{xx} u_{i,j,k} = \\frac{1}{12h^2} \\left[ -u_{i-2,j,k} + 16u_{i-1,j,k} - 30u_{i,j,k} + 16u_{i+1,j,k} - u_{i+2,j,k} \\right] $$\n$3$D 离散拉普拉斯算子 $\\Delta_h$ 是每个坐标方向上此类算子的和：\n$$ \\Delta_h = D_{xx} + D_{yy} + D_{zz} $$\n接下来，我们将此算子应用于平面波 $u(\\boldsymbol{x}) = \\exp(i\\,\\boldsymbol{k}\\cdot\\boldsymbol{x})$，其中 $\\boldsymbol{k}=(k_x, k_y, k_z)$ 且 $\\boldsymbol{x}=(x,y,z)$。在移位的网格点上，场的值为：\n$$ u(\\boldsymbol{x} + s h \\hat{e}_x) = \\exp(i \\boldsymbol{k} \\cdot (\\boldsymbol{x} + s h \\hat{e}_x)) = \\exp(i(\\boldsymbol{k}\\cdot\\boldsymbol{x} + s k_x h)) = u(\\boldsymbol{x}) \\exp(i s k_x h) $$\n将 $D_{xx}$ 应用于 $u(\\boldsymbol{x})$：\n$$ D_{xx} u(\\boldsymbol{x}) = \\frac{u(\\boldsymbol{x})}{12h^2} \\left[ -\\exp(-i2k_x h) + 16\\exp(-ik_x h) - 30 + 16\\exp(ik_x h) - \\exp(i2k_x h) \\right] $$\n使用欧拉恒等式 $\\cos\\theta = \\frac{e^{i\\theta} + e^{-i\\theta}}{2}$，我们对各项进行分组：\n$$ D_{xx} u(\\boldsymbol{x}) = \\frac{u(\\boldsymbol{x})}{12h^2} \\left[ 16(\\exp(ik_x h) + \\exp(-ik_x h)) - (\\exp(i2k_x h) + \\exp(-i2k_x h)) - 30 \\right] $$\n$$ D_{xx} u(\\boldsymbol{x}) = \\frac{u(\\boldsymbol{x})}{12h^2} \\left[ 32\\cos(k_x h) - 2\\cos(2k_x h) - 30 \\right] $$\n使用二倍角恒等式 $\\cos(2\\theta) = 2\\cos^2\\theta - 1$：\n$$ D_{xx} u(\\boldsymbol{x}) = \\frac{u(\\boldsymbol{x})}{12h^2} \\left[ 32\\cos(k_x h) - 2(2\\cos^2(k_x h) - 1) - 30 \\right] $$\n$$ D_{xx} u(\\boldsymbol{x}) = \\frac{u(\\boldsymbol{x})}{12h^2} \\left[ -4\\cos^2(k_x h) + 32\\cos(k_x h) - 28 \\right] $$\n$$ \\frac{D_{xx} u(\\boldsymbol{x})}{u(\\boldsymbol{x})} = \\frac{1}{3h^2} \\left[ -\\cos^2(k_x h) + 8\\cos(k_x h) - 7 \\right] $$\n完整拉普拉斯算子 $\\Delta_h$ 的作用是各方向算子作用之和：\n$$ \\frac{\\Delta_h u(\\boldsymbol{x})}{u(\\boldsymbol{x})} = \\sum_{\\alpha \\in \\{x,y,z\\}} \\frac{1}{3h^2} \\left[ -\\cos^2(k_\\alpha h) + 8\\cos(k_\\alpha h) - 7 \\right] $$\n各向同性误差定义为 $\\epsilon(\\boldsymbol{k};h) = \\frac{\\Delta_{h}\\,u(\\boldsymbol{x})}{-\\,|\\boldsymbol{k}|^{2}\\,u(\\boldsymbol{x})} - 1$，其中 $|\\boldsymbol{k}|^2 = k_x^2+k_y^2+k_z^2$。代入推导出的表达式：\n$$ \\epsilon(\\boldsymbol{k};h) = \\frac{1}{-|\\boldsymbol{k}|^2} \\left( \\sum_{\\alpha \\in \\{x,y,z\\}} \\frac{1}{3h^2} [-\\cos^2(k_\\alpha h) + 8\\cos(k_\\alpha h) - 7] \\right) - 1 $$\n$$ \\epsilon(\\boldsymbol{k};h) = -\\frac{1}{3h^2(k_x^2+k_y^2+k_z^2)} \\sum_{\\alpha \\in \\{x,y,z\\}} (8\\cos(k_\\alpha h) - \\cos^2(k_\\alpha h) - 7) - 1 $$\n展开求和即可得到用 $k_x$、$k_y$、$k_z$ 和 $h$ 表示的各向同性误差的最终表达式：\n$$ \\epsilon(\\boldsymbol{k};h) = -\\frac{(8\\cos(k_x h) - \\cos^2(k_x h) - 7) + (8\\cos(k_y h) - \\cos^2(k_y h) - 7) + (8\\cos(k_z h) - \\cos^2(k_z h) - 7)}{3h^2(k_x^2+k_y^2+k_z^2)} - 1 $$\n这就是所要求的单个闭式解析表达式。",
            "answer": "$$ \\boxed{-\\frac{(8\\cos(k_x h) - \\cos^2(k_x h) - 7) + (8\\cos(k_y h) - \\cos^2(k_y h) - 7) + (8\\cos(k_z h) - \\cos^2(k_z h) - 7)}{3h^2(k_x^2+k_y^2+k_z^2)} - 1} $$"
        }
    ]
}