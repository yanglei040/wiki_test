{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握一个数值概念，我们必须从其基本原理入手。本练习  将带你回顾柯朗-弗里德里希斯-列维（CFL）条件的物理起源，即物理依赖域必须被数值依赖域所包含。通过推导并计算一个简单双曲问题的最大稳定时间步长，你将巩固对柯朗数核心定义的理解，为处理更复杂的问题打下坚实基础。",
            "id": "3442602",
            "problem": "考虑一维双曲守恒律 $u_{t} + f(u)_{x} = 0$，该方程在一个间距为 $\\Delta x = 0.01$ 的均匀网格上使用二阶总变差递减 (TVD) 激波捕捉格式进行离散。设显式时间积分器为二阶TVD Runge–Kutta方法，并假设最大特征波速满足 $|a| = \\max |f^{\\prime}(u)| = 3$。为保证稳定性和TVD性质，Courant–Friedrichs–Lewy (CFL) 条件对库朗数 $\\lambda$ 进行了约束，其定义为 $\\lambda = |a|\\,\\Delta t / \\Delta x$。您需要强制执行 $\\lambda \\le 0.9$，以在TVD稳定域内保持一个安全裕度。\n\n请从双曲方程和激波捕捉有限体积离散的依赖域原理推导CFL限制条件，并计算满足所述CFL约束的最大时间步长 $\\Delta t$。请将 $\\Delta t$ 的最终数值以单个实数的形式给出。无需四舍五入。",
            "solution": "该问题经验证是适定的、有科学依据的，并包含得出唯一解所需的所有信息。\n\n该问题要求做两件事：首先，从依赖域原理推导 Courant–Friedrichs–Lewy (CFL) 条件；其次，根据给定的约束条件计算允许的最大时间步长 $\\Delta t$。\n\n首先，我们来解决推导部分。\n控制方程为一维双曲守恒律 $u_{t} + f(u)_{x} = 0$。通过对通量项 $f(u)_{x}$ 应用链式法则，我们可以将方程写成其拟线性形式：$u_{t} + f^{\\prime}(u) u_{x} = 0$。项 $a(u) = f^{\\prime}(u)$ 是局部特征波速，描述了信息在系统中的传播速度。方程 $u_{t} + a(u) u_{x} = 0$ 意味着解 $u$ 沿着 $x-t$ 平面中的特征曲线为常数，这些特征曲线由常微分方程 $\\frac{dx}{dt} = a(u)$ 定义。\n\nCourant–Friedrichs–Lewy (CFL) 条件是求解双曲型偏微分方程的显式数值格式保持稳定性的一个必要条件。它可以通过比较偏微分方程解的物理依赖域与有限差分或有限体积格式的数值依赖域得出。\n\n考虑我们计算网格上的一个点 $(x_j, t^{n+1})$，其中 $x_j$ 是一个空间网格点，$t^{n+1} = t^n + \\Delta t$ 是下一时刻的时间。该点的精确解 $u(x_j, t^{n+1})$ 依赖于前一时刻 $t^n$ 在某一空间区间内的数据。这个区间就是物理依赖域。信息以有限速度传播，其最大值由 $|a|_{\\max} = \\max_u |f^{\\prime}(u)|$ 给出。一个波要在时刻 $t^{n+1}$ 到达点 $x_j$，它必须在时刻 $t^n$ 从某个点 $x_0$ 出发，且传播时间为 $\\Delta t$。传播的距离为 $|x_j - x_0| \\le |a|_{\\max} \\Delta t$。因此，点 $(x_j, t^{n+1})$ 的物理依赖域是 $t=t^n$ 这条线上区间 $[x_j - |a|_{\\max} \\Delta t, x_j + |a|_{\\max} \\Delta t]$。\n\n现在，我们来考虑数值格式。一个激波捕捉格式，例如有限体积格式，使用时刻 $t^n$ 时相邻单元的值来计算单元 $j$ 的更新值 $u_j^{n+1}$。对于一个典型的二阶TVD格式，计算 $u_j^{n+1}$ 的数值模板至少涉及单元 $j-1$、$j$ 和 $j+1$。在时刻 $t^n$ 影响 $u_j^{n+1}$ 计算的网格点集合是数值依赖域。对于一个以 $j$ 为中心的标准三点模板，在间距为 $\\Delta x$ 的均匀网格上，该区域覆盖了空间区间 $[x_{j-1}, x_{j+1}]$，即区间 $[x_j - \\Delta x, x_j + \\Delta x]$。\n\nCFL条件的基本原理是，为了使数值格式有机会产生收敛的解，其数值依赖域必须包含偏微分方程的物理依赖域。如果违反此条件，数值格式将无法获取正确计算下一时间步状态所需的所有物理信息，从而导致不稳定。\n\n因此，我们必须有：\n$$[x_j - |a|_{\\max} \\Delta t, x_j + |a|_{\\max} \\Delta t] \\subseteq [x_j - \\Delta x, x_j + \\Delta x]$$\n当且仅当物理依赖域的范围小于或等于数值依赖域的范围时，此包含关系才成立。这导出了不等式：\n$$|a|_{\\max} \\Delta t \\le \\Delta x$$\n两边同除以 $\\Delta x$（其为严格正数），我们得到经典的CFL条件：\n$$\\frac{|a|_{\\max} \\Delta t}{\\Delta x} \\le 1$$\n无量纲群 $\\lambda = \\frac{|a|_{\\max} \\Delta t}{\\Delta x}$ 被称为库朗数。因此，稳定性条件是 $\\lambda \\le 1$。对于某些多步或高阶格式，保证稳定性的 $\\lambda$ 上限可能小于1。题目陈述提供了一个实用的稳定性和TVD性质约束 $\\lambda \\le 0.9$，这符合该理论框架。\n\n接下来，我们计算满足给定约束的最大时间步长 $\\Delta t$。\n已知信息如下：\n最大特征波速 $|a| = \\max |f^{\\prime}(u)| = 3$。我们记作 $|a|_{\\max} = 3$。\n网格间距 $\\Delta x = 0.01$。\n库朗数 $\\lambda = \\frac{|a|_{\\max} \\Delta t}{\\Delta x}$。\n需要强制执行的CFL约束：$\\lambda \\le 0.9$。\n\n我们将库朗数的定义代入约束条件：\n$$\\frac{|a|_{\\max} \\Delta t}{\\Delta x} \\le 0.9$$\n我们正在寻找可能的最大时间步长 $\\Delta t$，我们将其记为 $\\Delta t_{\\max}$。当等式成立时，可以得到这个值：\n$$\\frac{|a|_{\\max} \\Delta t_{\\max}}{\\Delta x} = 0.9$$\n求解 $\\Delta t_{\\max}$，我们得到：\n$$\\Delta t_{\\max} = \\frac{0.9 \\cdot \\Delta x}{|a|_{\\max}}$$\n现在，我们将给定的数值代入此表达式：\n$$\\Delta t_{\\max} = \\frac{0.9 \\times 0.01}{3}$$\n进行计算：\n$$0.9 \\times 0.01 = 0.009$$\n$$\\Delta t_{\\max} = \\frac{0.009}{3} = 0.003$$\n因此，满足所述CFL约束的最大时间步长是 $0.003$。",
            "answer": "$$\\boxed{0.003}$$"
        },
        {
            "introduction": "在真实的宇宙环境中，物理过程往往比理想模型复杂得多，例如，在恒星日冕的磁化等离子体中，沿着磁力线的高效热传导会导致波速具有各向异性。本练习  旨在挑战你分析这种物理复杂性如何改变 CFL 条件的应用。你需要推导在各向异性介质中沿不同坐标轴的特征波速，并将其应用于方向分裂格式，这体现了计算天体物理学家在模拟现实问题时必须具备的关键技能。",
            "id": "3538584",
            "problem": "考虑一个二维、平面平行、引力分层、完全电离的氢氦等离子体，它代表了恒星大气的一个日冕部分。大小为 $g$ 的引力是均匀的，并指向 $z$ 轴负方向。温度是均匀的，等于 $T$，因此大气是等温的。平均分子量为 $\\mu$。等离子体中贯穿着一个均匀磁场，该磁场与 $x$ 轴成 $\\phi$ 角（在 $x$-$z$ 平面内测量）。热传导沿着磁场线非常高效，而垂直于磁场线的方向上可以忽略不计，因此平行于磁场的压缩是有效的等温过程，而垂直于磁场的压缩是有效的绝热过程，其比热容比为 $\\gamma$。你将分析这种各向异性热力学如何修改方向信号速度，这些速度被用于一个显式、方向分裂、一阶有限体积 Godunov 方法的 Courant-Friedrichs-Lewy (CFL) 条件，该方法使用局部 Lax-Friedrichs (Rusanov) 通量。\n\n在低马赫数、非磁动态极限下进行分析，在该极限下，唯一需要关注的波族是类声学压缩模式，并且磁场仅通过强制实现上述各向异性热力学响应来发挥作用。从可压缩流体的线性化质量和动量守恒方程，以及与上述假设一致的压力-密度关系的各向异性封闭关系出发。通过考虑波矢与 $x$ 轴或 $z$ 轴对齐的平面波微扰，推导控制数值通量中信号传播的方向特征速度 $c_{x}$ 和 $c_{z}$。用沿磁场的等温声速 $c_{\\parallel}$、垂直于磁场的绝热声速 $c_{\\perp}$、角度 $\\phi$ 以及基本常数和参数来表示这些速度。然后，强制要求在每个一维分裂扫描中，数值依赖域必须包含物理依赖域，并根据方向速度、网格间距和流速，求出一个完整的 $x$-$z$ 更新的最大稳定时间步长 $\\Delta t_{\\max}$。\n\n假设以下代表恒星日冕的物理上合理的参数：\n- 均匀温度 $T = 1.00 \\times 10^{6}\\ \\mathrm{K}$。\n- 平均分子量 $\\mu = 0.6$。\n- 比热容比 $\\gamma = \\frac{5}{3}$。\n- 引力加速度 $g = 274\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$。\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$。\n- 质子质量 $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$。\n- 磁场角度 $\\phi = 30^{\\circ}$。\n- 背景速度 $u_{x} = 4.00 \\times 10^{4}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ 和 $u_{z} = 0$。\n- Courant 数 $C = 0.5$。\n\n设等温标高为 $H = \\frac{k_{B} T}{\\mu m_{p} g}$。选择一个各向异性网格，该网格能够解析陡峭的垂直分层，其垂直网格间距为 $\\Delta z = \\frac{H}{2500}$，水平网格间距大十倍，为 $\\Delta x = 10\\,\\Delta z$。\n\n仅使用上面指定或隐含的基本定律和事实，计算所描述的显式、方向分裂方案的 CFL 条件所蕴含的最大稳定时间步长 $\\Delta t_{\\max}$。用秒表示最终答案，并四舍五入到四位有效数字。",
            "solution": "用户提供了一个计算天体物理学问题，要求针对特定的数值方案推导并计算最大稳定时间步长 $\\Delta t_{\\max}$。将首先执行验证过程。\n\n### 步骤 1：提取给定条件\n- **系统描述**：二维（$x$-$z$）、平面平行、引力分层、完全电离的氢氦等离子体。\n- **引力**：大小为 $g$ 的均匀引力，指向 $z$ 轴负方向。\n- **温度**：均匀且恒定，为 $T$。\n- **平均分子量**：$\\mu$。\n- **磁场**：均匀，位于 $x$-$z$ 平面内，与 $x$ 轴成 $\\phi$ 角。\n- **各向异性热力学**：\n    - 平行于磁场的压缩是等温的。\n    - 垂直于磁场的压缩是绝热的，比热容比为 $\\gamma$。\n- **数值方案**：显式、方向分裂、一阶有限体积 Godunov 方法，使用局部 Lax-Friedrichs (Rusanov) 通量。\n- **物理极限**：低马赫数、非磁动态，仅考虑类声学压缩模式。\n- **任务**：\n    1.  推导方向特征速度 $c_x$ 和 $c_z$。\n    2.  获取一个完整的 $x$-$z$ 更新的最大稳定时间步长 $\\Delta t_{\\max}$ 的表达式。\n    3.  计算 $\\Delta t_{\\max}$ 的数值。\n- **物理参数**：\n    - $T = 1.00 \\times 10^{6}\\ \\mathrm{K}$\n    - $\\mu = 0.6$\n    - $\\gamma = \\frac{5}{3}$\n    - $g = 274\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$\n    - $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$\n    - $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$\n    - $\\phi = 30^{\\circ}$\n    - $u_{x} = 4.00 \\times 10^{4}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n    - $u_{z} = 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n    - Courant 数 $C = 0.5$\n- **网格定义**：\n    - 等温标高：$H = \\frac{k_{B} T}{\\mu m_{p} g}$\n    - $z$ 方向网格间距：$\\Delta z = \\frac{H}{2500}$\n    - $x$ 方向网格间距：$\\Delta x = 10\\,\\Delta z$\n\n### 步骤 2：使用提取的给定条件进行验证\n- **科学依据**：该问题在等离子体物理、流体动力学和双曲守恒律的数值方法原理方面有充分的依据。由强磁场引导的各向异性热传导概念是天体物理学的基础，特别是在恒星日冕中。Courant-Friedrichs-Lewy (CFL) 条件是显式数值方法的基石。指定的参数对于恒星日冕是物理上现实的。\n- **适定性**：该问题是适定的。它提供了所有必要的信息，包括物理定律、参数以及对数值方案属性的清晰描述，以唯一确定特征速度和由此产生的最大稳定时间步长。\n- **客观性**：该问题以精确、客观和技术性的语言陈述，没有歧义或主观论断。\n- **一致性与完备性**：问题的设定是自洽且内部一致的。没有缺失任何必要信息，也没有相互矛盾的约束。明确指出了仅考虑类声学模式的简化，这使得问题易于处理，同时专注于各向异性波传播的核心概念。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。这是一个科学上合理、适定且在计算天体物理学中具有一定难度的非平凡问题。将推导完整的解答。\n\n### 解答推导\n解答过程分几步进行：\n1.  根据问题的热力学约束推导各向异性声速。\n2.  确定沿网格轴传播的波的方向特征速度 $c_x$ 和 $c_z$。\n3.  计算所需物理量的数值。\n4.  应用方向分裂方案的 CFL 条件，求出最大稳定时间步长 $\\Delta t_{\\max}$。\n\n**1. 各向异性声速**\n问题指明，等离子体的热响应取决于压缩方向相对于磁场 $\\mathbf{B}$ 的方向。\n设 $\\hat{\\mathbf{b}}$ 为磁场方向的单位矢量。由于 $\\mathbf{B}$ 在 $x$-$z$ 平面内，与 $x$ 轴成 $\\phi$ 角，我们有：\n$$ \\hat{\\mathbf{b}} = (\\cos\\phi, 0, \\sin\\phi) $$\n平行于 $\\mathbf{B}$ 的压缩声速是等温声速 $c_{\\parallel}$，由下式给出：\n$$ c_{\\parallel}^2 = \\frac{P_0}{\\rho_0} = \\frac{k_B T}{\\mu m_p} $$\n其中 $P_0$ 和 $\\rho_0$ 是背景压力和密度。\n垂直于 $\\mathbf{B}$ 的压缩声速是绝热声速 $c_{\\perp}$，由下式给出：\n$$ c_{\\perp}^2 = \\frac{\\gamma P_0}{\\rho_0} = \\gamma c_{\\parallel}^2 $$\n对于具有波矢 $\\mathbf{k}$ 的一般平面波，有效声速的平方 $c_{\\text{eff}}^2$ 是这些速度的组合，由 $\\mathbf{k}$ 相对于 $\\hat{\\mathbf{b}}$ 的方向加权。设 $\\theta$ 为 $\\mathbf{k}$ 和 $\\mathbf{B}$ 之间的夹角。压力微扰 $p'$ 与密度微扰 $\\rho'$ 的关系为 $p' = c_{\\text{eff}}^2 \\rho'$，其中：\n$$ c_{\\text{eff}}^2 = c_{\\parallel}^2 \\cos^2\\theta + c_{\\perp}^2 \\sin^2\\theta $$\n该关系构成了问题所要求的各向异性封闭关系。\n\n**2. 方向特征速度（$c_x$ 和 $c_z$）**\n一个方向分裂的数值方案分别处理沿每个坐标轴的传播。相关的特征速度是纯粹沿这些轴传播的波的速度。\n对于在 $x$ 方向传播的波，波矢为 $\\mathbf{k} = (k_x, 0, 0)$，单位矢量为 $\\hat{\\mathbf{k}} = (1, 0, 0)$。此波矢与磁场 $\\mathbf{B}$ 之间的夹角 $\\theta_x$ 由下式给出：\n$$ \\cos\\theta_x = \\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{b}} = (1, 0, 0) \\cdot (\\cos\\phi, 0, \\sin\\phi) = \\cos\\phi $$\n$x$ 方向的特征速度 $c_x$ 是该方向上的有效声速：\n$$ c_x^2 = c_{\\parallel}^2 \\cos^2\\phi + c_{\\perp}^2 \\sin^2\\phi $$\n对于在 $z$ 方向传播的波，波矢为 $\\mathbf{k} = (0, 0, k_z)$，单位矢量为 $\\hat{\\mathbf{k}} = (0, 0, 1)$。此波矢与 $\\mathbf{B}$ 之间的夹角 $\\theta_z$ 由下式给出：\n$$ \\cos\\theta_z = \\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{b}} = (0, 0, 1) \\cdot (\\cos\\phi, 0, \\sin\\phi) = \\sin\\phi $$\n于是，$z$ 方向的特征速度 $c_z$ 为：\n$$ c_z^2 = c_{\\parallel}^2 \\cos^2\\theta_z + c_{\\perp}^2 \\sin^2\\theta_z = c_{\\parallel}^2 \\sin^2\\phi + c_{\\perp}^2 \\cos^2\\phi $$\n这些就是所要求的方向速度。\n\n**3. 数值计算**\n首先，我们使用给定的参数计算基础声速 $c_{\\parallel}$：$T = 1.00 \\times 10^6\\ \\mathrm{K}$，$\\mu = 0.6$，$k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$，以及 $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$。\n$$ c_{\\parallel}^2 = \\frac{k_B T}{\\mu m_p} = \\frac{(1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}) (1.00 \\times 10^6\\ \\mathrm{K})}{(0.6)(1.6726219 \\times 10^{-27}\\ \\mathrm{kg})} \\approx 1.375763 \\times 10^{10}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2} $$\n$$ c_{\\parallel} = \\sqrt{1.375763 \\times 10^{10}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2}} \\approx 1.17293 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n现在我们用 $\\gamma = \\frac{5}{3}$ 和 $\\phi = 30^{\\circ}$（因此 $\\cos^2\\phi = \\frac{3}{4}$ 和 $\\sin^2\\phi = \\frac{1}{4}$）来求 $c_x$ 和 $c_z$。\n$$ c_x^2 = c_{\\parallel}^2 \\cos^2\\phi + (\\gamma c_{\\parallel}^2) \\sin^2\\phi = c_{\\parallel}^2(\\cos^2\\phi + \\gamma \\sin^2\\phi) = c_{\\parallel}^2 \\left(\\frac{3}{4} + \\frac{5}{3} \\cdot \\frac{1}{4}\\right) = c_{\\parallel}^2 \\left(\\frac{9+5}{12}\\right) = \\frac{7}{6} c_{\\parallel}^2 $$\n$$ c_x = c_{\\parallel} \\sqrt{\\frac{7}{6}} \\approx (1.17293 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}) \\sqrt{\\frac{7}{6}} \\approx 1.26690 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n$$ c_z^2 = c_{\\parallel}^2 \\sin^2\\phi + (\\gamma c_{\\parallel}^2) \\cos^2\\phi = c_{\\parallel}^2(\\sin^2\\phi + \\gamma \\cos^2\\phi) = c_{\\parallel}^2 \\left(\\frac{1}{4} + \\frac{5}{3} \\cdot \\frac{3}{4}\\right) = c_{\\parallel}^2 \\left(\\frac{1+5}{4}\\right) = \\frac{3}{2} c_{\\parallel}^2 $$\n$$ c_z = c_{\\parallel} \\sqrt{\\frac{3}{2}} \\approx (1.17293 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}) \\sqrt{\\frac{3}{2}} \\approx 1.43647 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n接下来，我们计算网格间距。等温标高 $H$ 为：\n$$ H = \\frac{k_B T}{\\mu m_p g} = \\frac{c_{\\parallel}^2}{g} = \\frac{1.375763 \\times 10^{10}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2}}{274\\ \\mathrm{m}\\ \\mathrm{s}^{-2}} \\approx 5.02103 \\times 10^7\\ \\mathrm{m} $$\n网格间距 $\\Delta z$ 和 $\\Delta x$ 为：\n$$ \\Delta z = \\frac{H}{2500} = \\frac{5.02103 \\times 10^7\\ \\mathrm{m}}{2500} \\approx 2.00841 \\times 10^4\\ \\mathrm{m} $$\n$$ \\Delta x = 10 \\Delta z \\approx 2.00841 \\times 10^5\\ \\mathrm{m} $$\n\n**4. CFL 条件与 $\\Delta t_{\\max}$**\n对于一个显式、方向分裂的方案，时间步长 $\\Delta t$ 必须满足每个方向扫描的 CFL 条件。在给定方向上，最快的信号速度是流体速度大小与特征速度之和。\n对于 $x$ 方向扫描：\n$$ \\Delta t \\le C \\frac{\\Delta x}{|u_x| + c_x} $$\n对于 $z$ 方向扫描：\n$$ \\Delta t \\le C \\frac{\\Delta z}{|u_z| + c_z} $$\n对于一个完整的 $x$-$z$ 更新，最大稳定时间步长 $\\Delta t_{\\max}$ 受这两个条件中更严格的那个限制：\n$$ \\Delta t_{\\max} = C \\cdot \\min \\left( \\frac{\\Delta x}{|u_x| + c_x}, \\frac{\\Delta z}{|u_z| + c_z} \\right) $$\n我们现在代入数值：$C = 0.5$，$u_x = 4.00 \\times 10^4\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$，$u_z = 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$。\n$x$ 方向扫描的时间尺度为：\n$$ \\tau_x = \\frac{\\Delta x}{|u_x| + c_x} = \\frac{2.00841 \\times 10^5\\ \\mathrm{m}}{4.00 \\times 10^4\\ \\mathrm{m}\\ \\mathrm{s}^{-1} + 1.26690 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} = \\frac{2.00841 \\times 10^5\\ \\mathrm{m}}{1.66690 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} \\approx 1.20488\\ \\mathrm{s} $$\n$z$ 方向扫描的时间尺度为：\n$$ \\tau_z = \\frac{\\Delta z}{|u_z| + c_z} = \\frac{2.00841 \\times 10^4\\ \\mathrm{m}}{0\\ \\mathrm{m}\\ \\mathrm{s}^{-1} + 1.43647 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} = \\frac{2.00841 \\times 10^4\\ \\mathrm{m}}{1.43647 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} \\approx 0.13981\\ \\mathrm{s} $$\n这两个时间尺度的最小值是 $\\tau_z \\approx 0.13981\\ \\mathrm{s}$。因此，最大稳定时间步长是：\n$$ \\Delta t_{\\max} = C \\cdot \\min(\\tau_x, \\tau_z) = 0.5 \\times 0.13981\\ \\mathrm{s} \\approx 0.069905\\ \\mathrm{s} $$\n按要求四舍五入到四位有效数字，得到 $\\Delta t_{\\max} \\approx 0.06991\\ \\mathrm{s}$。",
            "answer": "$$\n\\boxed{0.06991}\n$$"
        },
        {
            "introduction": "在多物理场模拟中，CFL 条件往往不仅仅是一个需要遵守的规则，更是一个主要的计算瓶颈，尤其是在辐射-磁流体力学（Radiation-MHD）中，光速的巨大数值会极大地限制时间步长。这项高级实践  介绍了一种强大的“降速光近似”（Reduced Speed-of-Light, RSOL）技术来应对这一挑战。你将设计并实施一个自适应的 RSOL 策略，并量化这种近似方法在计算效率和物理精度之间的权衡，这是任何计算科学家都需掌握的核心能力。",
            "id": "3538624",
            "problem": "要求您在 Courant–Friedrichs–Lewy (CFL) 条件的背景下，为显式辐射-磁流体动力学 (MHD) 积分设计并分析一种局域的“降速光速”(RSOL) 策略。目标是构建一个随空间变化的有效光速 $c_{\\mathrm{eff}}(x)$，该光速能适应辐射-物质耦合强度，然后推导、实现并量化随空间变化的 $c_{\\mathrm{eff}}(x)$ 如何改变辐射-MHD 的 CFL 时间步长以及在辐射驱动风中的全局误差。\n\n您的推导和实现必须从以下基本基础出发：\n- Courant–Friedrichs–Lewy (CFL) 条件约束了显式时间步长，使得在单个时间步长内，没有任何物理信号的传播距离超过一个空间单元。\n- 在辐射-MHD中，最快的特征信号速度来自于流体磁声波和辐射输运模式。在磁流体动力学 (MHD) 中，快磁声速结合了声波传播和 Alfvén 波传播。\n- 辐射输运在光学薄（自由传播）和光学厚（扩散）两种不同情况下表现出不同的特征速度。\n\n您必须从这些原理出发，推导出耦合系统的 CFL 约束，不得使用任何预先给定的“快捷”公式。您还必须设计一种局域 RSOL 策略，通过遵守两个约束来确保科学真实性：\n1. 对流安全性：降速后的光速应保持足够大于流体信号速度。引入一个安全因子 $\\lambda  0$ 并确保 $c_{\\mathrm{eff}}(x) \\ge \\lambda \\left( |u(x)| + v_{\\mathrm{ms}}(x) \\right)$。\n2. 扩散极限一致性：在光学厚的单元中，降速后的光速可以安全地降低，其值约与“1+单元光学厚度”的倒数成正比。使用单元光学厚度 $\\tau(x) = \\kappa(x)\\,\\rho(x)\\,\\Delta x(x)$ 来构建此公式。\n\n基于这些约束，定义一个具体的局域 RSOL 策略：\n- 对每个单元，设置\n$$\nc_{\\mathrm{eff}}(x) = \\min\\!\\left( c,\\; \\max\\!\\left( \\lambda \\left( |u(x)| + v_{\\mathrm{ms}}(x) \\right),\\; \\frac{c}{1+\\tau(x)} \\right) \\right).\n$$\n其中 $c$ 是真实光速， $|u(x)|$ 是局域流体速度大小， $v_{\\mathrm{ms}}(x)$ 是局域快磁声速， $\\tau(x)$ 是局域单元光学厚度。\n\n辐射特征速度 $v_{\\mathrm{rad}}(x)$ 必须反映输运机制：\n- 在光学薄单元中（$\\tau(x) \\le 1$），取 $v_{\\mathrm{rad}}(x) = c_{\\mathrm{eff}}(x)$。\n- 在光学厚单元中（$\\tau(x)  1$），取 $v_{\\mathrm{rad}}(x) = c_{\\mathrm{eff}}(x)/\\sqrt{3}$ （这与一阶辐射矩系统的扩散极限传播相一致）。\n\n磁声速由标准 MHD 定义：\n- Alfvén 速度为 $v_A(x) = \\dfrac{|\\boldsymbol{B}(x)|}{\\sqrt{\\mu_0 \\rho(x)}}$，其中 $\\mu_0$ 为真空磁导率。\n- 快磁声速为 $v_{\\mathrm{ms}}(x) = \\sqrt{ c_s(x)^2 + v_A(x)^2 }$，其中 $c_s(x)$ 为声速。\n\n从第一性原理出发，根据网格间距和最大局域信号速度，推导耦合辐射-MHD系统的显式时间步长约束。您的程序必须在给定 CFL 数 $C_{\\mathrm{CFL}}$ 的情况下，计算所有单元中允许的最小时间步长。\n\n为了量化 RSOL 引入的辐射驱动风中的全局误差，采用一个基于物理的弛豫模型来描述单个单元内的辐射-物质动量耦合：\n- 将每个单元的真实辐射加速度定义为 $a_i^{\\mathrm{true}} = \\dfrac{\\kappa_i F_i}{c}$，其中 $F_i$ 是辐射通量。\n- 设真实的辐射-物质耦合时间尺度为 $t_{\\mathrm{rad},i}^{\\mathrm{true}} = \\dfrac{1}{\\kappa_i \\rho_i c}$。\n- 设经 RSOL 修正的耦合时间尺度为 $t_{\\mathrm{rad},i}^{\\mathrm{eff}} = \\dfrac{1}{\\kappa_i \\rho_i c_{\\mathrm{eff},i}}$。\n- 设流体穿越（相互作用）每个单元的时间为 $t_{\\mathrm{dyn},i} = \\dfrac{\\Delta x_i}{|u_i| + v_{\\mathrm{ms},i}}$。\n- 通过一个弛豫因子 $f = 1 - \\exp\\!\\left( - \\dfrac{t_{\\mathrm{dyn}}}{t_{\\mathrm{rad}}} \\right )$ 来模拟在相互作用时间内实现的有效加速度：\n$$\na_i^{\\mathrm{true,eff}} = a_i^{\\mathrm{true}} \\left( 1 - \\exp\\!\\left( - \\frac{t_{\\mathrm{dyn},i}}{t_{\\mathrm{rad},i}^{\\mathrm{true}}} \\right ) \\right),\\quad\na_i^{\\mathrm{RSOL,eff}} = a_i^{\\mathrm{true}} \\left( 1 - \\exp\\!\\left( - \\frac{t_{\\mathrm{dyn},i}}{t_{\\mathrm{rad},i}^{\\mathrm{eff}}} \\right ) \\right).\n$$\n使用一个简单的功能关系估算在穿过长度为 $\\sum_i \\Delta x_i$ 的区域后的终端风速：\n$$\nv_{\\infty}^{\\mathrm{true}} = \\sqrt{ 2 \\sum_i a_i^{\\mathrm{true,eff}} \\Delta x_i },\\quad\nv_{\\infty}^{\\mathrm{RSOL}} = \\sqrt{ 2 \\sum_i a_i^{\\mathrm{RSOL,eff}} \\Delta x_i }.\n$$\n报告分数误差\n$$\nE = \\frac{ v_{\\infty}^{\\mathrm{RSOL}} - v_{\\infty}^{\\mathrm{true}} }{ v_{\\infty}^{\\mathrm{true}} }.\n$$\n\n物理单位：\n- 使用国际单位制 (SI)：距离单位为米，速度单位为米/秒，时间单位为秒，质量密度单位为千克/立方米，磁场单位为特斯拉，不透明度单位为平方米/千克，辐射通量单位为瓦特/平方米。\n- 所有时间步长以秒表示，风速误差以无量纲小数表示（而不是百分比）。\n\n测试组：\n为以下三个多单元域（每个域有 $N = 3$ 个单元）实现您的程序。所有情况通用的常数：\n- 真实光速 $c = 3.0 \\times 10^{8}\\ \\mathrm{m/s}$。\n- 真空磁导率 $\\mu_0 = 4 \\pi \\times 10^{-7}\\ \\mathrm{N/A^2}$。\n- RSOL 安全因子 $\\lambda = 10$。\n- CFL 数 $C_{\\mathrm{CFL}} = 0.4$。\n\n情况 1 (中等耦合，混合光学厚度):\n- $\\Delta x = [1.0\\times 10^{9},\\ 1.0\\times 10^{9},\\ 1.0\\times 10^{9}]$。\n- $\\rho = [1.0\\times 10^{-9},\\ 5.0\\times 10^{-10},\\ 2.0\\times 10^{-10}]$。\n- $\\kappa = [0.34,\\ 0.34,\\ 0.34]$。\n- $|\\boldsymbol{B}| = [1.0\\times 10^{-3},\\ 5.0\\times 10^{-4},\\ 2.0\\times 10^{-4}]$。\n- $c_s = [2.0\\times 10^{4},\\ 2.0\\times 10^{4},\\ 2.0\\times 10^{4}]$。\n- $|u| = [5.0\\times 10^{4},\\ 6.0\\times 10^{4},\\ 7.0\\times 10^{4}]$。\n- $F = [1.0\\times 10^{10},\\ 1.0\\times 10^{10},\\ 1.0\\times 10^{10}]$。\n\n情况 2 (光学薄，较高流速):\n- $\\Delta x = [5.0\\times 10^{9},\\ 5.0\\times 10^{9},\\ 5.0\\times 10^{9}]$。\n- $\\rho = [1.0\\times 10^{-12},\\ 2.0\\times 10^{-12},\\ 1.5\\times 10^{-12}]$。\n- $\\kappa = [0.10,\\ 0.10,\\ 0.10]$。\n- $|\\boldsymbol{B}| = [1.0\\times 10^{-5},\\ 1.0\\times 10^{-5},\\ 1.0\\times 10^{-5}]$。\n- $c_s = [1.0\\times 10^{4},\\ 1.0\\times 10^{4},\\ 1.0\\times 10^{4}]$。\n- $|u| = [1.0\\times 10^{5},\\ 1.2\\times 10^{5},\\ 8.0\\times 10^{4}]$。\n- $F = [5.0\\times 10^{9},\\ 5.0\\times 10^{9},\\ 5.0\\times 10^{9}]$。\n\n情况 3 (光学厚，强耦合):\n- $\\Delta x = [1.0\\times 10^{8},\\ 1.0\\times 10^{8},\\ 1.0\\times 10^{8}]$。\n- $\\rho = [1.0\\times 10^{-5},\\ 2.0\\times 10^{-6},\\ 5.0\\times 10^{-6}]$。\n- $\\kappa = [10.0,\\ 10.0,\\ 10.0]$。\n- $|\\boldsymbol{B}| = [1.0\\times 10^{-3},\\ 1.0\\times 10^{-3},\\ 5.0\\times 10^{-4}]$。\n- $c_s = [5.0\\times 10^{3},\\ 5.0\\times 10^{3},\\ 5.0\\times 10^{3}]$。\n- $|u| = [1.0\\times 10^{3},\\ 2.0\\times 10^{3},\\ 1.5\\times 10^{3}]$。\n- $F = [1.0\\times 10^{8},\\ 1.0\\times 10^{8},\\ 1.0\\times 10^{8}]$。\n\n每种情况所需的输出：\n- CFL 限制的时间步长 $\\Delta t$，单位为秒（通过浮点运算四舍五入，非手动四舍五入）。\n- 终端风速的分数误差 $E$，以小数表示。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个情况的六个结果，按顺序排列，以逗号分隔并用方括号括起来，即 $[\\Delta t_1, E_1, \\Delta t_2, E_2, \\Delta t_3, E_3]$。",
            "solution": "该问题要求在辐射-磁流体动力学 (MHD) 的显式数值积分背景下，设计并分析一种降速光速 (RSOL) 近似方法。主要目标是推导该耦合系统的 Courant–Friedrichs–Lewy (CFL) 时间步长约束，并在一个辐射驱动风的模型中量化 RSOL 方法引入的数值误差。\n\n### 1. CFL 时间步长约束的推导\n\nCourant–Friedrichs–Lewy (CFL) 条件是求解双曲型偏微分方程的显式数值方法的一个基本稳定性判据。它要求数值依赖域必须包含物理依赖域。对于单元大小为 $\\Delta x$ 的一维网格，这意味着时间步长 $\\Delta t$ 必须足够小，以使最快的物理信号在单步内传播不超过一个网格单元。这表示为：\n$$\n\\Delta t \\le C_{\\mathrm{CFL}} \\frac{\\Delta x}{v_{\\text{signal, max}}}\n$$\n其中 $C_{\\mathrm{CFL}} \\le 1$ 是 CFL 数（一个安全因子），$v_{\\text{signal, max}}$ 是系统中存在的最大信号速度。\n\n在耦合的辐射-MHD 系统中，信号通过两个主要渠道传播：流体（MHD 波）和辐射场。给定网格单元中的总体最大信号速度是这两个渠道速度的最大值。\n\n对于一个由 $i$ 索引的多个网格单元组成的系统，整个区域的稳定性要求每个单元都满足 CFL 条件。因此，全局时间步长受制于需要最小时间步长的那个单元，即单元尺寸与最大信号速度之比最小的单元。\n在实验室坐标系中，单元 $i$ 中流体部分的最大信号速度是流体整体速度大小 $|u_i|$ 与最快 MHD 波速（即快磁声速 $v_{\\mathrm{ms},i}$）之和。\n$$\nv_{\\text{fluid}, i} = |u_i| + v_{\\mathrm{ms}, i}\n$$\n快磁声速 $v_{\\mathrm{ms},i}$ 由声速 $c_{s,i}$ 和 Alfvén 速度 $v_{A,i}$ 组合而成：\n$$\nv_{\\mathrm{ms},i} = \\sqrt{c_{s,i}^2 + v_{A,i}^2}\n$$\n其中 Alfvén 速度定义为：\n$$\nv_{A,i} = \\frac{|\\boldsymbol{B}_i|}{\\sqrt{\\mu_0 \\rho_i}}\n$$\n此处，$|\\boldsymbol{B}_i|$ 是磁场强度，$\\rho_i$ 是质量密度，$\\mu_0$ 是真空磁导率。\n\n辐射分量的信号速度 $v_{\\mathrm{rad},i}$ 取决于介质的局域光学厚度。问题指定了一个模型，其中该速度也是有效光速 $c_{\\mathrm{eff},i}$ 的函数：\n- 在光学薄区域 ($\\tau_i \\le 1$): $v_{\\mathrm{rad},i} = c_{\\mathrm{eff},i}$ (自由传播)。\n- 在光学厚区域 ($\\tau_i  1$): $v_{\\mathrm{rad},i} = c_{\\mathrm{eff},i} / \\sqrt{3}$ (扩散传播，与 M1 矩封闭相符)。\n\n单元光学厚度 $\\tau_i$ 由 $\\tau_i = \\kappa_i \\rho_i \\Delta x_i$ 给出，其中 $\\kappa_i$ 是不透明度。\n\n局域有效光速 $c_{\\mathrm{eff},i}$ 被构建为在适应局域条件的同时保持物理真实性。其定义为：\n$$\nc_{\\mathrm{eff},i} = \\min\\!\\left( c,\\; \\max\\!\\left( \\lambda \\left( |u_i| + v_{\\mathrm{ms},i} \\right),\\; \\frac{c}{1+\\tau_i} \\right) \\right)\n$$\n该公式确保 $c_{\\mathrm{eff},i}$ 不会低于流体特征速度的 $\\lambda$ 倍（对流安全性），并在光学厚区域减小，同时永远不超过真实光速 $c$。\n\n因此，单元 $i$ 中的最大总信号速度 $v_{\\max, i}$ 为：\n$$\nv_{\\max,i} = \\max(v_{\\text{fluid}, i}, v_{\\mathrm{rad},i})\n$$\n整个计算域的全局时间步长受所有局域时间步长限制的最小值约束：\n$$\n\\Delta t = C_{\\mathrm{CFL}} \\min_{i} \\left( \\frac{\\Delta x_i}{v_{\\max,i}} \\right)\n$$\n\n### 2. RSOL 引起的误差的量化\n\nRSOL 近似主要通过改变辐射-物质耦合的时间尺度来引入误差。问题提供了一个基于物理的模型来估计这种在辐射驱动风中的误差。\n\n真实辐射加速度为 $a_i^{\\text{true}} = \\frac{\\kappa_i F_i}{c}$，其中 $F_i$ 是辐射通量。这个加速度在一个耦合时间尺度上传递给物质。真实的耦合时间尺度是 $t_{\\text{rad},i}^{\\text{true}} = \\frac{1}{\\kappa_i \\rho_i c}$。使用 RSOL 后，有效光速 $c_{\\mathrm{eff},i}$ 替代了 $c$，导致一个修正后的、更短的耦合时间尺度：$t_{\\text{rad},i}^{\\text{eff}} = \\frac{1}{\\kappa_i \\rho_i c_{\\mathrm{eff},i}}$。\n\n该模型假设在流体包裹穿过一个单元的时间 $t_{\\text{dyn},i} = \\frac{\\Delta x_i}{|u_i| + v_{\\mathrm{ms},i}}$ 内，实际交换的动量遵循一个弛豫过程。实现的最大可能动量转移的分数由 $f = 1 - \\exp(-t_{\\text{dyn}} / t_{\\text{rad}})$ 给出。这导致在每个单元中赋予的有效加速度为：\n- 真实系统：$a_i^{\\text{true,eff}} = a_i^{\\text{true}} \\left( 1 - \\exp\\left( - \\frac{t_{\\text{dyn},i}}{t_{\\text{rad},i}^{\\text{true}}} \\right) \\right)$\n- RSOL 系统：$a_i^{\\text{RSOL,eff}} = a_i^{\\text{true}} \\left( 1 - \\exp\\left( - \\frac{t_{\\text{dyn},i}}{t_{\\text{rad},i}^{\\text{eff}}} \\right) \\right)$\n\n由于 $c_{\\mathrm{eff},i} \\le c$，我们有 $t_{\\mathrm{rad},i}^{\\text{eff}} \\ge t_{\\mathrm{rad},i}^{\\text{true}}$。对于 RSOL，指数的参数变得更负（或保持不变）：$-t_{\\text{dyn},i} / t_{\\mathrm{rad},i}^{\\mathrm{eff}} \\le -t_{\\text{dyn},i} / t_{\\mathrm{rad},i}^{\\mathrm{true}}$。这意味着 $a_i^{\\mathrm{RSOL,eff}} \\ge a_i^{\\mathrm{true,eff}}$。\n\n终端风速 $v_{\\infty}$ 是使用功能定理估算的，假设风从静止开始，并在整个区域上被加速：\n$$\n\\frac{1}{2} v_{\\infty}^2 = \\sum_i (\\text{acceleration in cell } i) \\times (\\text{distance } \\Delta x_i)\n$$\n这给出：\n$$\nv_{\\infty}^{\\text{true}} = \\sqrt{ 2 \\sum_i a_i^{\\text{true,eff}} \\Delta x_i } \\quad \\text{and} \\quad v_{\\infty}^{\\text{RSOL}} = \\sqrt{ 2 \\sum_i a_i^{\\mathrm{RSOL,eff}} \\Delta x_i }\n$$\n由 RSOL 近似引起的终端风速的分数误差 $E$ 则为：\n$$\nE = \\frac{ v_{\\infty}^{\\text{RSOL}} - v_{\\infty}^{\\text{true}} }{ v_{\\infty}^{\\text{true}} }\n$$\n\n### 3. 计算流程\n\n对于每个测试案例，执行以下步骤：\n1. 对每个单元 $i=1, \\dots, N$：\n    a. 计算 Alfvén 速度 $v_{A,i}$ 和快磁声速 $v_{\\mathrm{ms},i}$。\n    b. 计算单元光学厚度 $\\tau_i$。\n    c. 使用 RSOL 公式确定有效光速 $c_{\\mathrm{eff},i}$。\n    d. 基于 $\\tau_i$ 确定辐射特征速度 $v_{\\mathrm{rad},i}$。\n    e. 计算最大局域信号速度 $v_{\\max,i} = \\max(|u_i| + v_{\\mathrm{ms},i}, v_{\\mathrm{rad},i})$。\n    f. 计算局域时间步长限制 $\\Delta t_{\\text{limit},i} = \\Delta x_i / v_{\\max,i}$。\n    g. 为进行误差分析，计算 $t_{\\text{dyn},i}$，$a_i^{\\text{true,eff}}$ 和 $a_i^{\\mathrm{RSOL,eff}}$。\n\n2. 计算全局 CFL 时间步长：$\\Delta t = C_{\\mathrm{CFL}} \\min_i (\\Delta t_{\\text{limit},i})$。\n\n3. 计算总功能项 $\\sum_i a_i^{\\text{true,eff}} \\Delta x_i$ 和 $\\sum_i a_i^{\\mathrm{RSOL,eff}} \\Delta x_i$。\n\n4. 计算终端速度 $v_{\\infty}^{\\text{true}}$ 和 $v_{\\infty}^{\\mathrm{RSOL}}$。\n\n5. 计算最终的分数误差 $E$。\n\n下面的实现是针对三个指定的测试案例的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n    # Define constants common to all cases\n    C = 3.0e8  # True speed of light in m/s\n    MU_0 = 4 * np.pi * 1.0e-7  # Vacuum permeability in N/A^2\n    LAMBDA = 10.0  # RSOL safety factor\n    C_CFL = 0.4  # CFL number\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (moderate coupling, mixed optical depths)\n        {\n            \"dx\": np.array([1.0e9, 1.0e9, 1.0e9]),\n            \"rho\": np.array([1.0e-9, 5.0e-10, 2.0e-10]),\n            \"kappa\": np.array([0.34, 0.34, 0.34]),\n            \"B\": np.array([1.0e-3, 5.0e-4, 2.0e-4]),\n            \"cs\": np.array([2.0e4, 2.0e4, 2.0e4]),\n            \"u\": np.array([5.0e4, 6.0e4, 7.0e4]),\n            \"F\": np.array([1.0e10, 1.0e10, 1.0e10]),\n        },\n        # Case 2 (optically thin, higher flow speeds)\n        {\n            \"dx\": np.array([5.0e9, 5.0e9, 5.0e9]),\n            \"rho\": np.array([1.0e-12, 2.0e-12, 1.5e-12]),\n            \"kappa\": np.array([0.10, 0.10, 0.10]),\n            \"B\": np.array([1.0e-5, 1.0e-5, 1.0e-5]),\n            \"cs\": np.array([1.0e4, 1.0e4, 1.0e4]),\n            \"u\": np.array([1.0e5, 1.2e5, 8.0e4]),\n            \"F\": np.array([5.0e9, 5.0e9, 5.0e9]),\n        },\n        # Case 3 (optically thick, strong coupling)\n        {\n            \"dx\": np.array([1.0e8, 1.0e8, 1.0e8]),\n            \"rho\": np.array([1.0e-5, 2.0e-6, 5.0e-6]),\n            \"kappa\": np.array([10.0, 10.0, 10.0]),\n            \"B\": np.array([1.0e-3, 1.0e-3, 5.0e-4]),\n            \"cs\": np.array([5.0e3, 5.0e3, 5.0e3]),\n            \"u\": np.array([1.0e3, 2.0e3, 1.5e3]),\n            \"F\": np.array([1.0e8, 1.0e8, 1.0e8]),\n        },\n    ]\n\n    results = []\n    for case_data in test_cases:\n        dt, E = calculate_case(case_data, C, MU_0, LAMBDA, C_CFL)\n        results.extend([dt, E])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_case(data, c, mu_0, lambda_r, c_cfl):\n    \"\"\"\n    Calculates the time step and error for a single test case.\n    \n    Args:\n        data (dict): A dictionary containing the physical parameters for the case.\n        c (float): Speed of light.\n        mu_0 (float): Vacuum permeability.\n        lambda_r (float): RSOL safety factor.\n        c_cfl (float): CFL number.\n        \n    Returns:\n        tuple: A tuple containing (time_step, error).\n    \"\"\"\n    # Unpack data for clarity\n    dx = data[\"dx\"]\n    rho = data[\"rho\"]\n    kappa = data[\"kappa\"]\n    B = data[\"B\"]\n    cs = data[\"cs\"]\n    u = data[\"u\"]\n    F = data[\"F\"]\n\n    # --- Part 1: Calculate CFL Time Step ---\n\n    # 1. Calculate MHD speeds for all cells\n    vA = B / np.sqrt(mu_0 * rho)\n    v_ms = np.sqrt(cs**2 + vA**2)\n\n    # 2. Calculate optical depth\n    tau = kappa * rho * dx\n\n    # 3. Calculate effective speed of light c_eff\n    v_fluid_signal = u + v_ms\n    c_conv_safe = lambda_r * v_fluid_signal\n    c_diff_lim = c / (1.0 + tau)\n    c_eff = np.minimum(c, np.maximum(c_conv_safe, c_diff_lim))\n\n    # 4. Calculate radiation characteristic speed v_rad\n    v_rad = np.where(tau = 1, c_eff, c_eff / np.sqrt(3))\n\n    # 5. Calculate maximum local signal speed v_max\n    v_max = np.maximum(v_fluid_signal, v_rad)\n\n    # 6. Calculate local time step limits and find the minimum\n    dt_limits = dx / v_max\n    min_dt_limit = np.min(dt_limits)\n\n    # 7. Apply CFL number to get the final time step\n    delta_t = c_cfl * min_dt_limit\n\n    # --- Part 2: Calculate Fractional Error ---\n    \n    # 1. Calculate various timescales and accelerations\n    t_dyn = dx / v_fluid_signal\n    a_true = (kappa * F) / c\n    \n    t_rad_true = 1.0 / (kappa * rho * c)\n    t_rad_eff = 1.0 / (kappa * rho * c_eff)\n\n    # 2. Calculate effective accelerations using the relaxation model\n    a_true_eff = a_true * (1.0 - np.exp(-t_dyn / t_rad_true))\n    a_rsol_eff = a_true * (1.0 - np.exp(-t_dyn / t_rad_eff))\n    \n    # 3. Calculate total work done (proportional to v_inf^2 / 2)\n    work_true = np.sum(a_true_eff * dx)\n    work_rsol = np.sum(a_rsol_eff * dx)\n\n    # 4. Calculate terminal velocities\n    v_inf_true = np.sqrt(2 * work_true)\n    v_inf_rsol = np.sqrt(2 * work_rsol)\n\n    # 5. Calculate fractional error\n    # Handle case where v_inf_true is zero to avoid division by zero\n    if v_inf_true == 0:\n        error = 0.0 if v_inf_rsol == 0.0 else np.inf\n    else:\n        error = (v_inf_rsol - v_inf_true) / v_inf_true\n\n    return delta_t, error\n\nsolve()\n```"
        }
    ]
}