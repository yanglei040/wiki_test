{
    "hands_on_practices": [
        {
            "introduction": "Modeling magnetized relativistic outflows requires describing the magnetic field in a way that respects Lorentz covariance. This practice introduces the magnetic four-vector, $b^{\\mu}$, which represents the field in the fluid's rest frame, and the crucial Lorentz-invariant scalar $b^2$. Mastering this transformation is the first step toward constructing the relativistic magnetohydrodynamics (RMHD) stress-energy tensor and understanding the jet's magnetization .",
            "id": "3517930",
            "problem": "In Relativistic Magnetohydrodynamics (RMHD), the magnetic field measured in the fluid rest frame is encoded in the magnetic four-vector $b^{\\mu}$, which is defined using the dual electromagnetic field tensor ${^{\\ast}\\!F}^{\\mu \\nu}$ and the fluid four-velocity $u^{\\nu}$ via $b^{\\mu} \\equiv {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$. Work in flat spacetime with Minkowski metric signature $(-,+,+,+)$, adopt units with the speed of light $c=1$, and use Heaviside–Lorentz electromagnetic units. Assume ideal magnetohydrodynamics (perfect conductivity), such that the laboratory-frame electric and magnetic fields satisfy $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$, where $\\mathbf{v}$ is the fluid three-velocity.\n\nStarting only from the definitions above, together with the standard identifications of the field tensor and its dual in terms of the laboratory-frame fields, perform the following:\n\n1. Construct the transformation that expresses $b^{\\mu}$ explicitly in terms of the laboratory-frame magnetic field $\\mathbf{B}$ and the fluid three-velocity $\\mathbf{v}$ and Lorentz factor $\\Gamma \\equiv (1 - v^{2})^{-1/2}$, where $v^{2} \\equiv \\mathbf{v} \\cdot \\mathbf{v}$.\n\n2. From your general expression, derive a simplified scalar expression for $b^{2} \\equiv b^{\\mu} b_{\\mu}$ in terms of $\\mathbf{B}$, $\\mathbf{v}$, and $\\Gamma$.\n\n3. For a jet fluid element with laboratory-frame magnetic field $\\mathbf{B} = (3, 4, 12)$ and velocity $\\mathbf{v} = (0.6, 0.3, 0.0)$, evaluate $b^{2}$ and then compute the magnetization parameter $\\sigma \\equiv b^{2}/w$ given an enthalpy density $w = 50$. Express your final answer for $\\sigma$ as a dimensionless number. Round your final answer to $4$ significant figures.",
            "solution": "The user has provided a problem in Relativistic Magnetohydrodynamics (RMHD) and has asked for a three-part solution involving the magnetic four-vector $b^{\\mu}$.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- Definition of the magnetic four-vector: $b^{\\mu} \\equiv {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$\n- Dual electromagnetic field tensor: ${^{\\ast}\\!F}^{\\mu \\nu}$\n- Fluid four-velocity: $u^{\\nu}$\n- Spacetime: Flat, with Minkowski metric signature $\\eta_{\\mu\\nu} = \\text{diag}(-1, 1, 1, 1)$\n- Units: Speed of light $c=1$, Heaviside–Lorentz electromagnetic units.\n- Ideal MHD condition: $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$, where $\\mathbf{E}$ and $\\mathbf{B}$ are laboratory-frame fields and $\\mathbf{v}$ is the fluid three-velocity.\n- Lorentz factor: $\\Gamma \\equiv (1 - v^{2})^{-1/2}$, with $v^{2} \\equiv \\mathbf{v} \\cdot \\mathbf{v}$.\n- Numerical data for Part 3:\n    - Laboratory-frame magnetic field: $\\mathbf{B} = (3, 4, 12)$\n    - Fluid three-velocity: $\\mathbf{v} = (0.6, 0.3, 0.0)$\n    - Enthalpy density: $w = 50$\n- Definition of magnetization parameter: $\\sigma \\equiv b^{2}/w$\n- Definition of scalar square: $b^2 \\equiv b^{\\mu} b_{\\mu}$\n- Final answer requirement: Round the final value for $\\sigma$ to $4$ significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is firmly rooted in the standard formalism of special relativistic ideal magnetohydrodynamics. The definitions, such as that for $b^{\\mu}$, the Lorentz factor $\\Gamma$, the ideal MHD condition, and the structure of the electromagnetic tensors, are standard textbook material.\n- **Well-Posed**: The problem is structured as a guided derivation followed by a numerical calculation. All necessary information is provided for each step. The tasks are clearly defined, leading to a unique solution.\n- **Objective**: The problem uses precise mathematical and physical terminology without ambiguity or subjective language.\n- **Completeness and Consistency**: The provided definitions and constraints are self-consistent and sufficient to solve the problem. The definition of $b^{\\mu}$ is explicit, avoiding potential convention ambiguities.\n- **Other Flaws**: The problem does not exhibit any of the listed flaws. It is a valid, formal problem in computational astrophysics.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. The solution will now be derived.\n\n### Solution Derivation\n\nThe solution consists of three parts as requested.\n\n**Part 1: Express $b^{\\mu}$ in terms of lab-frame quantities**\n\nWe begin with the definition $b^{\\mu} = {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$. The components of the four-velocity $u^{\\mu}$ and its covariant form $u_{\\mu}$ are:\n$$ u^{\\mu} = (\\Gamma, \\Gamma \\mathbf{v}) = (\\Gamma, \\Gamma v^x, \\Gamma v^y, \\Gamma v^z) $$\n$$ u_{\\mu} = \\eta_{\\mu\\nu}u^{\\nu} = (-\\Gamma, \\Gamma \\mathbf{v}) = (-\\Gamma, \\Gamma v_x, \\Gamma v_y, \\Gamma v_z) $$\nThe dual electromagnetic field tensor ${^{\\ast}\\!F}^{\\mu\\nu}$ in terms of the laboratory-frame electric field $\\mathbf{E}$ and magnetic field $\\mathbf{B}$ is:\n$$ {^{\\ast}\\!F}^{\\mu\\nu} = \\begin{pmatrix} 0 & -B_x & -B_y & -B_z \\\\ B_x & 0 & E_z & -E_y \\\\ B_y & -E_z & 0 & E_x \\\\ B_z & E_y & -E_x & 0 \\end{pmatrix} $$\nWe now compute the components of $b^{\\mu}$ by matrix-vector multiplication.\n\nThe time component, $b^0$:\n$$ b^0 = {^{\\ast}\\!F}^{0\\nu}u_{\\nu} = {^{\\ast}\\!F}^{00}u_0 + {^{\\ast}\\!F}^{01}u_1 + {^{\\ast}\\!F}^{02}u_2 + {^{\\ast}\\!F}^{03}u_3 $$\n$$ b^0 = (0)(-\\Gamma) + (-B_x)(\\Gamma v_x) + (-B_y)(\\Gamma v_y) + (-B_z)(\\Gamma v_z) = -\\Gamma (B_x v_x + B_y v_y + B_z v_z) $$\n$$ b^0 = -\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}) $$\n\nThe spatial components, $b^i$ (where $i=1,2,3$ corresponds to $x,y,z$), form a three-vector $\\mathbf{b}$. Let's compute $b^1$:\n$$ b^1 = {^{\\ast}\\!F}^{1\\nu}u_{\\nu} = {^{\\ast}\\!F}^{10}u_0 + {^{\\ast}\\!F}^{11}u_1 + {^{\\ast}\\!F}^{12}u_2 + {^{\\ast}\\!F}^{13}u_3 $$\n$$ b^1 = (B_x)(-\\Gamma) + (0)(\\Gamma v_x) + (E_z)(\\Gamma v_y) + (-E_y)(\\Gamma v_z) = \\Gamma[-B_x + (E_z v_y - E_y v_z)] = \\Gamma[-B_x + (\\mathbf{v} \\times \\mathbf{E})_x] $$\nGeneralizing to all three spatial components:\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} + \\mathbf{v} \\times \\mathbf{E}) $$\nNow we apply the ideal MHD condition, $\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}$.\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} + \\mathbf{v} \\times (-\\mathbf{v} \\times \\mathbf{B})) = \\Gamma(-\\mathbf{B} - \\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B})) $$\nUsing the vector triple product identity $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A}\\cdot\\mathbf{C}) - \\mathbf{C}(\\mathbf{A}\\cdot\\mathbf{B})$, we get:\n$$ \\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B}) = \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}(\\mathbf{v}\\cdot\\mathbf{v}) = \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}v^2 $$\nSubstituting this back into the expression for $\\mathbf{b}$:\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} - [\\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}v^2]) = \\Gamma(-\\mathbf{B} - \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) + \\mathbf{B}v^2) $$\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B}(1-v^2) - \\mathbf{v}(\\mathbf{B}\\cdot\\mathbf{v})) $$\nUsing the definition $\\Gamma = (1-v^2)^{-1/2}$, we have $1-v^2 = 1/\\Gamma^2$:\n$$ \\mathbf{b} = \\Gamma(-\\frac{\\mathbf{B}}{\\Gamma^2} - (\\mathbf{B}\\cdot\\mathbf{v})\\mathbf{v}) = -\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B}\\cdot\\mathbf{v})\\mathbf{v} $$\nThus, the four-vector $b^{\\mu} = (b^0, \\mathbf{b})$ is expressed as:\n$$ b^{\\mu} = \\left(-\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}), -\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n\n**Part 2: Derive an expression for $b^2 \\equiv b^{\\mu} b_{\\mu}$**\n\nThe scalar square $b^2$ is a Lorentz invariant. With the $(-,+,+,+)$ metric signature, it is computed as:\n$$ b^2 = b^{\\mu} b_{\\mu} = -(b^0)^2 + \\mathbf{b} \\cdot \\mathbf{b} $$\nSubstitute the components derived in Part 1:\n$$ b^2 = -(-\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}))^2 + \\left(-\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) \\cdot \\left(-\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\left(\\frac{\\mathbf{B}}{\\Gamma} + \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) \\cdot \\left(\\frac{\\mathbf{B}}{\\Gamma} + \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\nExpanding the dot product:\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\left(\\frac{\\mathbf{B}}{\\Gamma} \\cdot \\frac{\\mathbf{B}}{\\Gamma}\\right) + 2\\left(\\frac{\\mathbf{B}}{\\Gamma} \\cdot \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) + \\left(\\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v} \\cdot \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + 2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 v^2 $$\nLet's group the terms with $(\\mathbf{B} \\cdot \\mathbf{v})^2$:\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2(-\\Gamma^2 + 2 + \\Gamma^2 v^2) $$\nThe factor multiplying $(\\mathbf{B} \\cdot \\mathbf{v})^2$ simplifies significantly:\n$$ -\\Gamma^2 + 2 + \\Gamma^2 v^2 = -\\Gamma^2(1 - v^2) + 2 $$\nSince $\\Gamma^2(1-v^2) = 1$, this becomes:\n$$ -1 + 2 = 1 $$\nTherefore, the expression for $b^2$ simplifies to:\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2 $$\nThis is the desired scalar expression.\n\n**Part 3: Evaluate $b^2$ and $\\sigma$ for the given numerical values**\n\nWe are given:\n- $\\mathbf{B} = (3, 4, 12)$\n- $\\mathbf{v} = (0.6, 0.3, 0.0)$\n- $w = 50$\n\nFirst, we calculate the required scalar quantities.\nThe squared magnitude of the fluid velocity:\n$$ v^2 = \\mathbf{v} \\cdot \\mathbf{v} = (0.6)^2 + (0.3)^2 + (0.0)^2 = 0.36 + 0.09 = 0.45 $$\nThe squared Lorentz factor:\n$$ \\Gamma^2 = \\frac{1}{1 - v^2} = \\frac{1}{1 - 0.45} = \\frac{1}{0.55} = \\frac{1}{11/20} = \\frac{20}{11} $$\nThe squared magnitude of the magnetic field:\n$$ |\\mathbf{B}|^2 = \\mathbf{B} \\cdot \\mathbf{B} = 3^2 + 4^2 + 12^2 = 9 + 16 + 144 = 169 $$\nThe dot product of $\\mathbf{B}$ and $\\mathbf{v}$:\n$$ \\mathbf{B} \\cdot \\mathbf{v} = (3)(0.6) + (4)(0.3) + (12)(0.0) = 1.8 + 1.2 + 0.0 = 3.0 $$\nThe square of this dot product:\n$$ (\\mathbf{B} \\cdot \\mathbf{v})^2 = (3.0)^2 = 9.0 $$\n\nNow, substitute these values into the expression for $b^2$:\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2 = \\frac{169}{20/11} + 9.0 $$\n$$ b^2 = 169 \\times \\frac{11}{20} + 9.0 = \\frac{1859}{20} + 9.0 = 92.95 + 9.0 = 101.95 $$\nFinally, we compute the magnetization parameter $\\sigma$:\n$$ \\sigma = \\frac{b^2}{w} = \\frac{101.95}{50} = 2.039 $$\nThe problem requires rounding the final answer to $4$ significant figures. The calculated value $2.039$ already has exactly $4$ significant figures, so no further rounding is needed.",
            "answer": "$$\\boxed{2.039}$$"
        },
        {
            "introduction": "A persistent challenge in numerical magnetohydrodynamics is satisfying the solenoidal constraint, $\\nabla \\cdot \\mathbf{B} = 0$, without which unphysical magnetic monopoles can corrupt the simulation. This exercise explores the Constrained Transport (CT) method, a powerful technique that preserves this constraint to machine precision by construction. Understanding the staggered-grid formulation of CT is essential for developing robust and accurate MHD codes for jet simulations .",
            "id": "3517925",
            "problem": "A three-dimensional ideal magnetohydrodynamics (MHD) simulation of magnetically collimated astrophysical jets uses a finite-volume Godunov scheme on a uniform Cartesian grid with cell-centered fluid variables. To avoid spurious magnetic monopoles that can corrupt jet collimation and acceleration, the magnetic field update is required to preserve the divergence constraint to machine precision. Starting from Maxwell’s equations in the magnetohydrodynamic limit, the induction equation is given by Faraday’s law, $\\partial \\mathbf{B}/\\partial t = - \\nabla \\times \\mathbf{E}$, with the ideal Ohm’s law $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$. The divergence constraint is $\\nabla \\cdot \\mathbf{B} = 0$. In a finite-volume discretization, area-averaged magnetic field components are often stored at face centers to align the discrete divergence with the net flux through a closed surface.\n\nWhich option correctly defines the Constrained Transport (CT) method and gives the discrete face-centered update that preserves $\\nabla \\cdot \\mathbf{B} = 0$ to machine precision by construction?\n\nA. Constrained Transport (CT) stores area-averaged magnetic field components at face centers and advances them using a Stokes-theorem-consistent circulation of edge-centered electromotive forces (EMFs). For a uniform grid with spacings $\\Delta x$, $\\Delta y$, $\\Delta z$, the $x$-face update is\n$$\nB_x^{n+1}\\!\\left(i+\\tfrac{1}{2},j,k\\right) = B_x^{n}\\!\\left(i+\\tfrac{1}{2},j,k\\right)\n- \\frac{\\Delta t}{\\Delta y}\\!\\left[E_z\\!\\left(i+\\tfrac{1}{2},j+\\tfrac{1}{2},k\\right) - E_z\\!\\left(i+\\tfrac{1}{2},j-\\tfrac{1}{2},k\\right)\\right]\n+ \\frac{\\Delta t}{\\Delta z}\\!\\left[E_y\\!\\left(i+\\tfrac{1}{2},j,k+\\tfrac{1}{2}\\right) - E_y\\!\\left(i+\\tfrac{1}{2},j,k-\\tfrac{1}{2}\\right)\\right],\n$$\nwith analogous cyclic permutations for $B_y$ and $B_z$. Here $E_\\alpha$ are edge-centered, properly upwinded EMFs consistent with the Godunov fluxes. This discrete curl form guarantees that the discrete divergence, computed as the oriented sum of face fluxes over a cell, is exactly unchanged (hence remains zero if initially zero), because edge contributions cancel pairwise around the closed surface.\n\nB. Constrained Transport (CT) computes a cell-centered provisional $\\mathbf{B}^{*}$ using standard face fluxes, then enforces $\\nabla \\cdot \\mathbf{B} = 0$ by solving a Poisson equation for a scalar potential $\\phi$ and projecting $\\mathbf{B}^{n+1} = \\mathbf{B}^{*} - \\nabla \\phi$. This projection guarantees exact zero divergence in any finite-volume scheme and is equivalent to CT, since the projection explicitly removes monopoles each time step.\n\nC. Constrained Transport (CT) augments the induction equation with a generalized Lagrange multiplier (GLM) cleaning field $\\psi$, evolving $\\partial \\mathbf{B}/\\partial t = - \\nabla \\times \\mathbf{E} - \\nabla \\psi$ and $\\partial \\psi/\\partial t + c_h^2 \\nabla \\cdot \\mathbf{B} = -\\kappa \\psi$, where $c_h$ and $\\kappa$ are constants. Storing $\\mathbf{B}$ at cell centers and updating with these source terms reduces divergence errors and thus preserves $\\nabla \\cdot \\mathbf{B} = 0$ to machine precision in practice in jet simulations.\n\nD. Constrained Transport (CT) keeps magnetic fields at face centers but advances $B_x$ via face-normal fluxes from the Riemann solver as\n$$\nB_x^{n+1}\\!\\left(i+\\tfrac{1}{2},j,k\\right) = B_x^{n}\\!\\left(i+\\tfrac{1}{2},j,k\\right) - \\frac{\\Delta t}{\\Delta x}\\left[F_{B_x}\\!\\left(i+1,j,k\\right) - F_{B_x}\\!\\left(i,j,k\\right)\\right],\n$$\nwith similar formulas for $B_y$ and $B_z$, where $F_{B_x}$ are the induction fluxes. Because flux differences are conservative, this update is sufficient to keep $\\nabla \\cdot \\mathbf{B} = 0$ to machine precision without requiring edge-centered EMFs.",
            "solution": "The problem requires identifying the correct definition and discrete update equation for the Constrained Transport (CT) method, which is a numerical technique in magnetohydrodynamics (MHD) designed to preserve the divergence-free condition of the magnetic field, $\\nabla \\cdot \\mathbf{B} = 0$, to machine precision.\n\nFirst, let us validate the problem statement.\nThe givens are:\n- A three-dimensional ideal MHD simulation of astrophysical jets.\n- A finite-volume Godunov scheme on a uniform Cartesian grid with cell-centered fluid variables.\n- The goal is to preserve $\\nabla \\cdot \\mathbf{B} = 0$ to machine precision.\n- The governing equations are Faraday's law, $\\partial \\mathbf{B}/\\partial t = - \\nabla \\times \\mathbf{E}$, the ideal Ohm's law, $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$, and the divergence constraint, $\\nabla \\cdot \\mathbf{B} = 0$.\n- A hint is provided that area-averaged magnetic fields are often stored at face centers.\n\nThe problem statement is scientifically grounded, well-posed, and objective. It describes a standard scenario in computational astrophysics and asks for the identification of a specific, well-established numerical method (Constrained Transport). The physics and numerical concepts are correct and standard in the field. The problem is self-contained and free of contradictions or ambiguities. Therefore, the problem is valid.\n\nWe will now derive the Constrained Transport update from first principles. The CT method, in its original form by Evans & Hawley (1988), relies on a staggered grid where magnetic field components are defined at the center of the faces to which they are normal. For a Cartesian grid cell indexed by $(i,j,k)$, the components are located as:\n- $B_x$ is at face-center $(i+\\frac{1}{2}, j, k)$\n- $B_y$ is at face-center $(i, j+\\frac{1}{2}, k)$\n- $B_z$ is at face-center $(i, j, k+\\frac{1}{2})$\n\nThe governing equation for the magnetic field is Faraday's law of induction, $\\partial \\mathbf{B}/\\partial t = - \\nabla \\times \\mathbf{E}$. We can write this in integral form using Stokes' theorem. For a surface $S$ with boundary curve $C$:\n$$ \\frac{d}{dt}\\int_S \\mathbf{B} \\cdot d\\mathbf{A} = - \\oint_C \\mathbf{E} \\cdot d\\mathbf{l} $$\nThis states that the rate of change of magnetic flux through a surface is equal to the negative of the line integral of the electric field (the electromotive force, or EMF) around the boundary of that surface.\n\nLet's apply this to the face-centered component $B_x(i+\\frac{1}{2},j,k)$. This component represents the magnetic flux density normal to the cell face located at $x=(i+\\frac{1}{2})\\Delta x$, which has an area of $\\Delta A = \\Delta y \\Delta z$. The magnetic flux through this face is $\\Phi_x = B_x(i+\\frac{1}{2},j,k) \\Delta y \\Delta z$.\nThe boundary $C$ of this face is a rectangle in the $y-z$ plane with corners at $(i+\\frac{1}{2}, j\\pm\\frac{1}{2}, k\\pm\\frac{1}{2})$. The line integral of $\\mathbf{E}$ requires electric field components defined along the edges of this rectangle. This naturally leads to defining electric field components at the center of cell edges. For the face at $(i+\\frac{1}{2}, j, k)$, the relevant components are $E_y$ on edges parallel to the $y$-axis and $E_z$ on edges parallel to the $z$-axis.\n\nThe line integral, with path orientation given by the right-hand rule for a normal in the $+x$ direction, is discretized as:\n$$ \\oint_C \\mathbf{E} \\cdot d\\mathbf{l} \\approx \\left[ E_z(i+\\tfrac{1}{2},j+\\tfrac{1}{2},k) - E_z(i+\\tfrac{1}{2},j-\\tfrac{1}{2},k) \\right]\\Delta z - \\left[ E_y(i+\\tfrac{1}{2},j,k+\\tfrac{1}{2}) - E_y(i+\\tfrac{1}{2},j,k-\\tfrac{1}{2}) \\right]\\Delta y $$\nThe time evolution of the flux, using a first-order Euler forward step, is:\n$$ \\frac{B_x^{n+1}(i+\\tfrac{1}{2},j,k) \\Delta y \\Delta z - B_x^{n}(i+\\tfrac{1}{2},j,k) \\Delta y \\Delta z}{\\Delta t} = - \\oint_C \\mathbf{E} \\cdot d\\mathbf{l} $$\nSubstituting the discretized line integral and simplifying gives the update equation for $B_x$:\n$$ B_x^{n+1}(i+\\tfrac{1}{2},j,k) = B_x^{n}(i+\\tfrac{1}{2},j,k) - \\frac{\\Delta t}{\\Delta y} \\left[ E_z(i+\\tfrac{1}{2},j+\\tfrac{1}{2},k) - E_z(i+\\tfrac{1}{2},j-\\tfrac{1}{2},k) \\right] + \\frac{\\Delta t}{\\Delta z} \\left[ E_y(i+\\tfrac{1}{2},j,k+\\tfrac{1}{2}) - E_y(i+\\tfrac{1}{2},j,k-\\tfrac{1}{2}) \\right] $$\nThis equation is a discrete representation of the $x$-component of the curl, $\\partial B_x / \\partial t = (\\nabla \\times \\mathbf{E})_x = \\partial E_y/\\partial z - \\partial E_z/\\partial y$. The key feature of CT is that a single, consistently computed edge-centered value for an electric field component (e.g., $E_z(i+\\frac{1}{2},j+\\frac{1}{2},k)$) is used to update the magnetic field on all faces that share that edge.\n\nThe discrete divergence in cell $(i,j,k)$ is defined as the net flux through the cell's six faces:\n$$ (\\nabla \\cdot \\mathbf{B})_{i,j,k} = \\frac{B_x(i+\\tfrac{1}{2},j,k) - B_x(i-\\tfrac{1}{2},j,k)}{\\Delta x} + \\frac{B_y(i,j+\\tfrac{1}{2},k) - B_y(i,j-\\tfrac{1}{2},k)}{\\Delta y} + \\frac{B_z(i,j,k+\\tfrac{1}{2}) - B_z(i,j,k-\\tfrac{1}{2})}{\\Delta z} $$\nThe time evolution of the divergence is preserved because the discrete divergence of the discrete curl operator constructed this way is identically zero. That is, $(\\nabla \\cdot)^d ((\\nabla \\times)^d \\mathbf{E}) \\equiv 0$. This can be shown by direct substitution of the update equations for $B_x$, $B_y$, and $B_z$ into the time derivative of the discrete divergence. The terms involving each edge-centered EMF component, such as $E_z(i+\\frac{1}{2},j+\\frac{1}{2},k)$, enter the divergence calculation for adjacent cells with opposite signs and cancel exactly. Consequently, if $(\\nabla \\cdot \\mathbf{B})^n = 0$, then $(\\nabla \\cdot \\mathbf{B})^{n+1} = 0$ to machine precision.\n\nNow we evaluate the given options.\n\nA. This option correctly states that CT uses face-centered magnetic fields and updates them using a circulation of edge-centered EMFs. The update formula for $B_x$ is identical to the one derived above. The explanation for why the divergence is preserved is also correct: it is a direct consequence of the Stokes' theorem-like construction, where the sum of EMF line integrals over the faces of a closed cell volume is zero because each edge integral is counted twice with opposite signs. This is the discrete analogue of the vector identity $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0$. The description is a perfect match for the Constrained Transport method. **Correct**.\n\nB. This option describes the \"projection method\" or \"divergence cleaning\". A provisional field $\\mathbf{B}^{*}$ is computed, which may not be divergence-free. A correction is then applied by solving a Poisson equation $\\nabla^2 \\phi = \\nabla \\cdot \\mathbf{B}^{*}$ and setting $\\mathbf{B}^{n+1} = \\mathbf{B}^{*} - \\nabla \\phi$. This forces $\\nabla \\cdot \\mathbf{B}^{n+1} = 0$. This is a valid technique for controlling divergence, but it is fundamentally different from Constrained Transport. CT is a prevention method, not a correction method. Stating that this method is \"equivalent to CT\" is false. **Incorrect**.\n\nC. This option describes the Generalized Lagrange Multiplier (GLM) method. This approach adds source terms to the induction equation and evolves a new scalar field $\\psi$ to transport and damp divergence errors. While effective, it does not keep $\\nabla \\cdot \\mathbf{B}$ identically zero to machine precision by construction. Instead, it aims to keep the errors small and propagating away. This is a \"divergence-damping\" or \"cleaning\" scheme, not the \"divergence-preserving\" CT method. **Incorrect**.\n\nD. This option suggests updating face-centered fields $B_x$ using a conservative flux difference form along the $x$-direction. This is a misunderstanding of how the induction equation works. The equation $\\partial_t B_x = \\partial_z E_y - \\partial_y E_z$ is not in a simple 1D conservative form $\\partial_t B_x + \\partial_x F_{B_x} = 0$. Using such an update, even if part of an operator-split scheme, does not constitute a discrete curl and will not preserve the divergence-free condition. This type of update, as used in methods like the 8-wave formulation, actually generates divergence error that must then be controlled by another mechanism (like projection or GLM). The claim that this is sufficient is false. **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The interaction between a jet and its surrounding medium is often dominated by the Kelvin-Helmholtz Instability (KHI), which drives mixing and can disrupt the flow. This practice bridges analytical theory and computation by exploring a dispersion relation for the relativistic KHI in a magnetized shear layer. By numerically finding the fastest-growing modes, you will gain direct insight into how jet properties like Lorentz factor ($\\Gamma$), magnetization ($\\sigma$), and field geometry ($P$) control the jet's stability .",
            "id": "3517935",
            "problem": "Consider a cold, cylindrical relativistic jet of radius $r_0$ with a uniform axial bulk flow along the $z$-axis of speed $v_j$ and Lorentz factor $\\Gamma_j = (1 - v_j^2)^{-1/2}$. The jet is embedded in a static ambient medium. We adopt ideal Relativistic Magnetohydrodynamics (RMHD), assume an incompressible, thin shear layer at the jet boundary that can be treated locally as a planar tangential discontinuity of half-thickness $a \\ll r_0$, and focus on axisymmetric surface perturbations with axial wavenumber $k$ in the laboratory frame. The jet carries a helical magnetic field with axial component $B_z$ and azimuthal component $B_\\phi$, characterized by a pitch parameter $P = B_\\phi/(r_0 B_z)$, while the ambient is taken unmagnetized. Throughout, use natural units with the speed of light $c = 1$ and normalize all lengths to $r_0 = 1$, so frequencies and growth rates are in units of the inverse light-crossing time $r_0/c$.\n\nFrom the RMHD energy-momentum tensor with electromagnetic contributions and ideal Ohm’s law, linearize about the base state and consider incompressible perturbations whose amplitude decays away from the interface. For a planar interface between two semi-infinite uniform states labeled by $j \\in \\{1,2\\}$ (jet $j=1$, ambient $j=2$), the linearized normal stress balance for surface modes with wavenumber $k$ and complex frequency $\\omega$ yields a quadratic dispersion relation that can be written in a compact, inertia-tension balance form when the magnetic field is parallel to the flow direction. In the cold-plasma limit, the relativistic inertia per unit volume on side $j$ is $I_j = w_j + b_j^2$, where $w_j$ is the enthalpy density and $b_j^2$ is the magnetic field strength squared in the co-moving frame. The axial magnetic tension entering the surface-mode balance is controlled by the co-moving axial field component $b_{z,j}^2$. For a uniform axial flow and helical laboratory-frame magnetic field components $(B_z, B_\\phi)$, ideal RMHD gives $b_j^2 = (B_z^2 + B_\\phi^2)/\\Gamma_j^2 + v_j^2 B_z^2$ and $b_{z,j}^2 = B_z^2/\\Gamma_j^2$.\n\nAssume the following base state:\n- Jet side ($j=1$): $w_1 = 1$ (cold enthalpy density in units of $c^2$), bulk Lorentz factor $\\Gamma_1 = \\Gamma$, speed $v_1 = \\sqrt{1 - \\Gamma^{-2}}$, magnetization $\\sigma \\equiv b_1^2/w_1$, and pitch $P = B_\\phi/(r_0 B_z)$ with $r_0 = 1$.\n- Ambient side ($j=2$): $w_2 = 1$, $v_2 = 0$, no magnetic field so $b_2^2 = 0$ and $b_{z,2}^2 = 0$.\n\nFor the jet, the above definitions imply\n$$\nb_1^2 = \\sigma w_1 = \\sigma,\\quad b_{z,1}^2 = \\frac{B_z^2}{\\Gamma^2},\\quad \\text{and}\\quad B_z^2 = \\frac{\\sigma}{\\frac{1+P^2}{\\Gamma^2} + v_1^2},\n$$\nwhich reduces to\n$$\nb_{z,1}^2 = \\frac{\\sigma}{P^2 + \\Gamma^2}.\n$$\nTherefore, the effective relativistic inertias are $I_1 = w_1 + b_1^2 = 1 + \\sigma$ and $I_2 = w_2 + b_2^2 = 1$, and the axial magnetic tension contributing to surface-mode balance is fully determined by $b_{z,1}^2$.\n\nUnder the incompressible, planar, surface-wave approximation, the Kelvin–Helmholtz Instability (KHI) dispersion for parallel fields yields a quadratic in $\\omega$ of the form\n$$\n(I_1 + I_2)\\,\\omega^2 - 2k\\,(I_1 v_1 + I_2 v_2)\\,\\omega + k^2 \\Big(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2\\Big) = 0,\n$$\nwhose instability condition and growth rate follow from the discriminant. In particular, the growth rate $\\omega_i(k) \\equiv \\operatorname{Im}(\\omega)$ can be written in terms of the velocity shear and axial tension as\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2}\\,\\sqrt{\\,I_1 I_2\\,(v_1 - v_2)^2 - (I_1 + I_2)\\,(b_{z,1}^2 + b_{z,2}^2)\\,}\\,,\n$$\nand instability requires that the expression under the square root is positive. To heuristically account for a finite shear-layer half-thickness $a$ in an otherwise planar treatment, use the standard replacement of the velocity-shear drive by a factor $\\tanh(ka)$, yielding\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2}\\,\\sqrt{\\,I_1 I_2\\,(v_1 - v_2)^2\\,\\tanh^2(ka) - (I_1 + I_2)\\,(b_{z,1}^2 + b_{z,2}^2)\\,}\\,,\n$$\nwith $\\omega_i(k) = 0$ when the argument of the square root is negative. This approximation reproduces the small-$k$ stabilization and large-$k$ saturation of the shear drive while preserving the axial magnetic tension.\n\nTask:\n1) Starting from the ideal RMHD framework and the above base-state definitions, derive the above incompressible surface-mode dispersion relation and its finite-thickness modification in terms of $I_j$, $v_j$, and $b_{z,j}^2$, expressing explicitly how $b_{z,1}^2$ depends on $\\Gamma$, $\\sigma$, and $P$.\n2) Implement a program that, for specified parameter sets $(\\Gamma,\\sigma,P)$ with $w_1 = w_2 = 1$, $v_2 = 0$, $b_{z,2}^2 = 0$, and shear half-thickness $a = 0.1$, sweeps $k$ uniformly over the range $k \\in [0.01, 10.0]$ (in units of $r_0^{-1}$), evaluates $\\omega_i(k)$ using the formula above, and returns the maximum growth rate over this $k$-range. Express the final growth rate in units of inverse light-crossing time $r_0/c$, rounded to six decimal places.\n\nUse the following test suite of $(\\Gamma,\\sigma,P)$ values:\n- Test 1: $(\\Gamma,\\sigma,P) = (5.0, 0.01, 0.0)$\n- Test 2: $(\\Gamma,\\sigma,P) = (2.0, 5.0, 0.0)$\n- Test 3: $(\\Gamma,\\sigma,P) = (2.0, 2.3, 0.0)$\n- Test 4: $(\\Gamma,\\sigma,P) = (2.0, 2.3, 10.0)$\n- Test 5: $(\\Gamma,\\sigma,P) = (5.0, 0.5, 0.0)$\n- Test 6: $(\\Gamma,\\sigma,P) = (5.0, 0.5, 10.0)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,x3,x4,x5,x6]\"), where each entry is the maximum $\\omega_i$ for the corresponding test in the order above, rounded to six decimal places. All computations must be carried out in the normalized units specified here, and the output units are inverse light-crossing time $r_0/c$.",
            "solution": "The problem requires the derivation of the dispersion relation for Kelvin-Helmholtz Instability (KHI) in a specific relativistic magnetohydrodynamic (RMHD) setup and the subsequent calculation of the maximum instability growth rate for several parameter sets. The validation of the problem statement confirms its scientific soundness, internal consistency, and well-posed nature. We may therefore proceed with a solution.\n\nThe solution is divided into two parts as per the problem's tasks:\n1. Derivation of the physical model equations.\n2. Description of the numerical implementation to compute the maximum growth rates.\n\n**1. Derivation and Theoretical Framework**\n\nThe problem investigates the stability of a planar tangential discontinuity, which is a standard local approximation for a thin shear layer at the boundary of a cylindrical jet. We consider incompressible, axisymmetric surface-wave perturbations of the form $e^{i(kz-\\omega t)}$, where $k$ is the axial wavenumber and $\\omega$ is the complex frequency. The imaginary part of $\\omega$, $\\omega_i = \\operatorname{Im}(\\omega)$, represents the growth rate of the instability.\n\nThe dispersion relation for such waves is found by linearizing the ideal RMHD equations and enforcing the continuity of total pressure perturbation across the displaced interface. For the case where the magnetic field is parallel to the flow velocity, the problem states that the resulting dispersion relation is a quadratic equation in $\\omega$:\n$$\n(I_1 + I_2)\\,\\omega^2 - 2k\\,(I_1 v_1 + I_2 v_2)\\,\\omega + k^2 \\Big(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2\\Big) = 0\n$$\nHere, the subscript $j=1$ refers to the jet and $j=2$ refers to the ambient medium. The terms are defined as follows:\n- $I_j = w_j + b_j^2$ is the effective relativistic inertia density, where $w_j$ is the enthalpy density and $b_j^2$ is the comoving magnetic energy density.\n- $v_j$ is the bulk flow speed along the $z$-axis.\n- $b_{z,j}^2$ is the square of the comoving axial magnetic field, which provides a restoring magnetic tension that can suppress the instability.\n\nThe base state is specified as:\n- Jet ($j=1$): Enthalpy $w_1 = 1$, Lorentz factor $\\Gamma_1 = \\Gamma$, so speed $v_1 = \\sqrt{1 - \\Gamma^{-2}}$. The magnetization is $\\sigma \\equiv b_1^2/w_1 = b_1^2$, and the magnetic pitch is $P = B_\\phi/(r_0 B_z)$ with $r_0=1$. This gives $I_1 = 1 + \\sigma$.\n- Ambient ($j=2$): Enthalpy $w_2 = 1$, static flow $v_2 = 0$, and unmagnetized, so $b_2^2=0$ and $b_{z,2}^2=0$. This gives $I_2 = 1$.\n\nA key part of the task is to derive the expression for the jet's comoving axial magnetic field term, $b_{z,1}^2$. The comoving magnetic field components are related to the laboratory-frame components ($B_z, B_\\phi$) via Lorentz transformations. The problem provides the relevant formulae:\n$b_1^2 = \\frac{B_z^2 + B_\\phi^2}{\\Gamma^2} + v_1^2 B_z^2$\n$b_{z,1}^2 = \\frac{B_z^2}{\\Gamma^2}$\n\nWe are given the magnetization $\\sigma=b_1^2$ and the pitch $P=B_\\phi/B_z$. Substituting $B_\\phi = P B_z$ into the expression for $b_1^2$:\n$$\n\\sigma = b_1^2 = \\frac{B_z^2 + (P B_z)^2}{\\Gamma^2} + v_1^2 B_z^2 = B_z^2 \\left( \\frac{1+P^2}{\\Gamma^2} + v_1^2 \\right)\n$$\nSolving for $B_z^2$ gives:\n$$\nB_z^2 = \\frac{\\sigma}{\\frac{1+P^2}{\\Gamma^2} + v_1^2}\n$$\nThis matches the intermediate expression provided in the problem. Now, substitute this into the formula for $b_{z,1}^2$:\n$$\nb_{z,1}^2 = \\frac{B_z^2}{\\Gamma^2} = \\frac{1}{\\Gamma^2} \\left( \\frac{\\sigma}{\\frac{1+P^2}{\\Gamma^2} + v_1^2} \\right) = \\frac{\\sigma}{(1+P^2) + \\Gamma^2 v_1^2}\n$$\nUsing the relativistic identity $\\Gamma^2_j = (1-v_j^2)^{-1}$, we have $\\Gamma^2 v_1^2 = \\Gamma^2(1 - 1/\\Gamma^2) = \\Gamma^2 - 1$. Substituting this into the denominator:\n$$\nb_{z,1}^2 = \\frac{\\sigma}{(1+P^2) + (\\Gamma^2 - 1)} = \\frac{\\sigma}{P^2 + \\Gamma^2}\n$$\nThis completes the derivation of the expression for $b_{z,1}^2$.\n\nNext, we find the instability growth rate $\\omega_i$. The roots of the quadratic equation $A\\omega^2 + B\\omega + C = 0$ are $\\omega = (-B \\pm \\sqrt{B^2 - 4AC}) / (2A)$. Instability arises when the discriminant $D = B^2 - 4AC$ is negative, leading to complex conjugate roots for $\\omega$. The growth rate is then $\\omega_i = \\operatorname{Im}(\\omega) = \\sqrt{-D}/(2A) = \\sqrt{4AC - B^2}/(2A)$.\nFrom our dispersion relation, we identify the coefficients:\n$A = I_1 + I_2$\n$B = -2k(I_1 v_1 + I_2 v_2)$\n$C = k^2(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2)$\n\nThe term under the square root for $\\omega_i$ is $4AC - B^2$:\n$$\n4AC - B^2 = 4(I_1+I_2)k^2(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2) - [-2k(I_1 v_1 + I_2 v_2)]^2\n$$\n$$\n= 4k^2 \\left[ (I_1+I_2)(I_1 v_1^2 + I_2 v_2^2) - (I_1 v_1 + I_2 v_2)^2 - (I_1+I_2)(b_{z,1}^2 + b_{z,2}^2) \\right]\n$$\nExpanding the velocity-dependent part in the square brackets:\n$I_1^2 v_1^2 + I_1 I_2 v_2^2 + I_2 I_1 v_1^2 + I_2^2 v_2^2 - (I_1^2 v_1^2 + 2I_1 I_2 v_1 v_2 + I_2^2 v_2^2)$\n$= I_1 I_2 v_1^2 + I_1 I_2 v_2^2 - 2I_1 I_2 v_1 v_2 = I_1 I_2(v_1 - v_2)^2$\nThus, $4AC - B^2 = 4k^2 \\left[ I_1 I_2(v_1 - v_2)^2 - (I_1 + I_2)(b_{z,1}^2 + b_{z,2}^2) \\right]$.\nThe growth rate is:\n$$\n\\omega_i(k) = \\frac{\\sqrt{4AC - B^2}}{2A} = \\frac{2k \\sqrt{ I_1 I_2(v_1 - v_2)^2 - (I_1 + I_2)(b_{z,1}^2 + b_{z,2}^2) }}{2(I_1 + I_2)}\n$$\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2} \\sqrt{I_1 I_2(v_1 - v_2)^2 - (I_1 + I_2)(b_{z,1}^2 + b_{z,2}^2)}\n$$\nThis matches the provided growth rate formula for an ideal, infinitely thin discontinuity.\n\nFinally, the problem introduces a heuristic modification to account for a finite shear-layer half-thickness $a$. This is done by recognizing that the KHI is driven by the velocity shear. For wavelengths comparable to or shorter than the shear layer thickness ($ka \\gtrsim 1$), the effective shear is reduced. This effect is commonly modeled by multiplying the shear-driving term, $(v_1 - v_2)^2$, by a factor that decays for large $k$. The problem specifies a standard choice, $\\tanh^2(ka)$. This factor approaches $1$ for long wavelengths ($ka \\ll 1$) and $0$ for short wavelengths ($ka \\gg 1$), but its effect is to reduce the drive at large $k$. The modified growth rate is:\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2}\\,\\sqrt{\\,I_1 I_2\\,(v_1 - v_2)^2\\,\\tanh^2(ka) - (I_1 + I_2)\\,(b_{z,1}^2 + b_{z,2}^2)\\,}\n$$\nBy convention, $\\omega_i(k)=0$ if the expression under the square root is negative, indicating stability at that wavenumber.\n\n**2. Numerical Implementation**\n\nTo complete the task, we must implement a program to find the maximum growth rate, $\\omega_{i, \\text{max}} = \\max_k \\omega_i(k)$, for $k$ in the range $[0.01, 10.0]$ and for several sets of physical parameters $(\\Gamma, \\sigma, P)$.\nThe computational procedure for each test case is as follows:\n1.  Define the constants for the system: $w_1=1$, $w_2=1$, $v_2=0$, $b_{z,2}^2=0$, and $a=0.1$.\n2.  For a given set of jet parameters $(\\Gamma, \\sigma, P)$, calculate the derived physical quantities:\n    - Jet velocity: $v_1 = \\sqrt{1 - \\Gamma^{-2}}$.\n    - Jet inertia: $I_1 = 1 + \\sigma$.\n    - Ambient inertia: $I_2 = 1$.\n    - Jet's comoving axial magnetic field term: $b_{z,1}^2 = \\sigma / (P^2 + \\Gamma^2)$.\n3.  Define the wavenumber range. A fine grid of $k$ values is created, for instance, by sampling $20000$ points uniformly from $k \\in [0.01, 10.0]$.\n4.  For each $k$ in the grid, evaluate the argument of the square root in the $\\omega_i(k)$ formula:\n    $$ \\text{arg} = (1+\\sigma)(1)v_1^2 \\tanh^2(ak) - (1+\\sigma+1)b_{z,1}^2 $$\n5.  If $\\text{arg} < 0$, set the growth rate to $0$. Otherwise, calculate $\\omega_i(k)$ using the derived formula.\n6.  The maximum value of $\\omega_i(k)$ across the grid of $k$ values is identified.\n7.  This maximum value is then rounded to six decimal places.\n8.  The process is repeated for all test cases, and the results are compiled into a comma-separated list.\n\nThis numerical approach robustly handles the possibility of an interior maximum for the growth rate, as well as cases that are stable over the entire or parts of the specified $k$-range.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum Kelvin-Helmholtz instability growth rate\n    for a relativistic magnetized jet for a given set of parameters.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (Gamma, sigma, P)\n    test_cases = [\n        (5.0, 0.01, 0.0),\n        (2.0, 5.0, 0.0),\n        (2.0, 2.3, 0.0),\n        (2.0, 2.3, 10.0),\n        (5.0, 0.5, 0.0),\n        (5.0, 0.5, 10.0),\n    ]\n\n    results = []\n    \n    # Static parameters\n    a = 0.1  # Shear-layer half-thickness\n    v2 = 0.0  # Ambient medium speed\n    I2 = 1.0  # Ambient medium inertia (w2=1, b2=0)\n    bz2_sq = 0.0 # Ambient medium magnetic tension term\n\n    # Wavenumber range for sweeping to find the maximum growth rate\n    k_values = np.linspace(0.01, 10.0, num=20000)\n\n    for case in test_cases:\n        Gamma, sigma, P = case\n        \n        # Calculate derived physical quantities for the jet\n        if Gamma == 1.0:\n            v1 = 0.0\n        else:\n            v1 = np.sqrt(1.0 - 1.0 / (Gamma**2))\n\n        I1 = 1.0 + sigma\n        bz1_sq = sigma / (P**2 + Gamma**2)\n        \n        # Define constants for the growth rate equation for clarity\n        #omega_i(k) = (k / (I1 + I2)) * sqrt(term_A * tanh^2(ka) - term_B)\n        term_A = I1 * I2 * (v1 - v2)**2\n        term_B = (I1 + I2) * (bz1_sq + bz2_sq)\n        \n        # Calculate the argument of the square root for all k values\n        tanh_ka_sq = np.tanh(k_values * a)**2\n        sqrt_arg = term_A * tanh_ka_sq - term_B\n        \n        # Instability exists only where the argument is positive.\n        # Set argument to 0 where it's negative.\n        sqrt_arg[sqrt_arg < 0] = 0.0\n        \n        # Calculate the growth rate omega_i for all k\n        omega_i_k = (k_values / (I1 + I2)) * np.sqrt(sqrt_arg)\n        \n        # Find the maximum growth rate over the k range\n        max_omega_i = np.max(omega_i_k)\n        \n        results.append(f\"{max_omega_i:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}