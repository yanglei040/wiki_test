{
    "hands_on_practices": [
        {
            "introduction": "This problem provides a foundational exercise in computational astrophysics, connecting the theoretical concept of the Jeans length to the practical limitations of a numerical simulation. By ensuring the Jeans length is adequately resolved to prevent artificial fragmentation, we implicitly set a maximum density that our grid can handle. This practice will guide you through deriving this maximum resolvable density and linking it to the creation of sink particles, a crucial technique for modeling unresolved gravitational collapse. ",
            "id": "3532043",
            "problem": "An Adaptive Mesh Refinement (AMR) simulation of self-gravitating star-forming gas uses the Jeans-length-based refinement criterion to prevent artificial fragmentation, alongside a shock-capturing criterion that refines where strong compressive jumps occur. Consider an isothermal, uniform medium at temperature $T$ with mean molecular weight $\\mu$, where the gas obeys the ideal-gas relation for the isothermal sound speed. The AMR code enforces a target of $N_{\\rm target}$ cells per local Jeans length for refinement, and its maximum refinement level reaches a minimum cell spacing $\\Delta x_{\\min}$. To avoid unresolved gravitational collapse, sink particles are to be created once the density exceeds a threshold chosen as a factor $\\alpha$ times the maximum density that can be resolved by the Jeans-length criterion on the finest level.\n\nStarting from the linear dispersion relation for a uniform, isothermal, self-gravitating medium,\n$$\\omega^{2} = c_{s}^{2} k^{2} - 4\\pi G \\rho,$$\nwhere $c_{s}$ is the isothermal sound speed, $\\rho$ is the mass density, $G$ is the gravitational constant, and $k$ is the wavenumber, derive the critical wavenumber $k_{J}$ and the corresponding Jeans length $\\lambda_{J}$ at marginal stability. Then, using the AMR constraint that the Jeans length must be resolved by at least $N_{\\rm target}$ cells on the finest level, namely\n$$\\Delta x_{\\min} \\le \\frac{\\lambda_{J}(\\rho_{\\max})}{N_{\\rm target}},$$\nsolve for the maximum resolvable density $\\rho_{\\max}$ in terms of $c_{s}$, $G$, $N_{\\rm target}$, and $\\Delta x_{\\min}$. Finally, compute the sink creation density $\\rho_{\\rm sink} = \\alpha\\,\\rho_{\\max}$ for the following parameters:\n- $T = 10\\,\\mathrm{K}$,\n- $\\mu = 2.33$,\n- $N_{\\rm target} = 32$,\n- $\\Delta x_{\\min} = 1\\,\\mathrm{AU}$,\n- $\\alpha = 4$.\n\nUse the fundamental constants\n- $k_{B} = 1.380649\\times 10^{-16}\\,\\mathrm{erg\\,K^{-1}}$,\n- $m_{H} = 1.6735575\\times 10^{-24}\\,\\mathrm{g}$,\n- $G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}$,\nand the unit conversion\n- $1\\,\\mathrm{AU} = 1.495978707\\times 10^{13}\\,\\mathrm{cm}$.\n\nAssume an isothermal sound speed given by the ideal-gas relation $c_{s}=\\sqrt{k_{B}T/(\\mu m_{H})}$. Express the final answer for the sink creation density in $\\mathrm{g\\,cm^{-3}}$, and round your answer to four significant figures.",
            "solution": "The problem statement will first be validated for scientific soundness, completeness, and clarity.\n\n### Step 1: Extract Givens\n- **Dispersion Relation:** $\\omega^{2} = c_{s}^{2} k^{2} - 4\\pi G \\rho$, where $\\omega$ is the angular frequency, $c_s$ is the isothermal sound speed, $k$ is the wavenumber, $G$ is the gravitational constant, and $\\rho$ is the mass density.\n- **AMR Refinement Criterion:** $\\Delta x_{\\min} \\le \\frac{\\lambda_{J}(\\rho_{\\max})}{N_{\\rm target}}$, where $\\Delta x_{\\min}$ is the minimum cell spacing, $\\lambda_{J}(\\rho_{\\max})$ is the Jeans length evaluated at the maximum resolvable density $\\rho_{\\max}$, and $N_{\\rm target}$ is the target number of cells per Jeans length.\n- **Isothermal Sound Speed:** $c_{s}=\\sqrt{k_{B}T/(\\mu m_{H})}$, where $k_B$ is the Boltzmann constant, $T$ is the temperature, $\\mu$ is the mean molecular weight, and $m_H$ is the mass of a hydrogen atom.\n- **Sink Creation Density:** $\\rho_{\\rm sink} = \\alpha\\,\\rho_{\\max}$, where $\\alpha$ is a constant factor.\n- **Parameters:**\n    - Temperature, $T = 10\\,\\mathrm{K}$\n    - Mean molecular weight, $\\mu = 2.33$\n    - Target cells per Jeans length, $N_{\\rm target} = 32$\n    - Minimum cell spacing, $\\Delta x_{\\min} = 1\\,\\mathrm{AU}$\n    - Sink density factor, $\\alpha = 4$\n- **Constants:**\n    - Boltzmann constant, $k_{B} = 1.380649\\times 10^{-16}\\,\\mathrm{erg\\,K^{-1}}$\n    - Hydrogen mass, $m_{H} = 1.6735575\\times 10^{-24}\\,\\mathrm{g}$\n    - Gravitational constant, $G = 6.67430\\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}$\n- **Unit Conversion:** $1\\,\\mathrm{AU} = 1.495978707\\times 10^{13}\\,\\mathrm{cm}$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the validation criteria.\n- **Scientifically Grounded:** The problem is firmly rooted in the principles of gravitational instability (Jeans instability) and computational astrophysics. The dispersion relation is the standard one for a uniform, isothermal, self-gravitating medium. The concept of resolving the Jeans length is a fundamental requirement in simulations of gravitational collapse to prevent artificial fragmentation. The use of sink particles is a standard technique in such simulations. All concepts are scientifically established.\n- **Well-Posed:** All necessary parameters, constants, and governing equations are provided. The task is to derive a series of quantities and compute a final value, which is a well-defined mathematical procedure. A unique, stable solution is expected.\n- **Objective:** The problem is stated using precise, quantitative language. There are no subjective or opinion-based statements.\n- **Completeness and Consistency:** The problem is self-contained and provides all the information needed for the calculation. The units are specified, and the physical setup is consistent.\n- **Realism:** The given parameter values ($T = 10\\,\\mathrm{K}$, $\\mu = 2.33$, etc.) are physically realistic for a dense molecular cloud core, a typical site of star formation. The refinement criteria and sink particle prescription are standard in the field.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist, such as scientific unsoundness, ambiguity, or contradiction.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full, reasoned solution will now be provided.\n\nThe derivation begins with the provided dispersion relation for a uniform, isothermal, self-gravitating medium:\n$$ \\omega^{2} = c_{s}^{2} k^{2} - 4\\pi G \\rho $$\nGravitational instability occurs when perturbations can grow, which corresponds to $\\omega^2  0$. The critical case, or marginal stability, is when $\\omega^2 = 0$. The wavenumber at which this occurs is the Jeans wavenumber, $k_J$.\n$$ 0 = c_{s}^{2} k_{J}^{2} - 4\\pi G \\rho $$\n$$ c_{s}^{2} k_{J}^{2} = 4\\pi G \\rho $$\nSolving for $k_J^2$ and then $k_J$ yields:\n$$ k_{J}^{2} = \\frac{4\\pi G \\rho}{c_{s}^{2}} \\implies k_{J} = \\sqrt{\\frac{4\\pi G \\rho}{c_{s}^{2}}} = \\frac{\\sqrt{4\\pi G \\rho}}{c_{s}} $$\nPerturbations with wavenumbers $k  k_J$ are unstable.\n\nThe Jeans length, $\\lambda_J$, is the wavelength corresponding to the Jeans wavenumber, defined as $\\lambda_J = 2\\pi/k_J$. Substituting the expression for $k_J$:\n$$ \\lambda_J = \\frac{2\\pi}{k_J} = 2\\pi \\frac{c_s}{\\sqrt{4\\pi G \\rho}} = \\frac{2\\pi c_s}{2\\sqrt{\\pi G \\rho}} = c_s \\sqrt{\\frac{\\pi}{G\\rho}} $$\n\nThe AMR simulation must resolve the local Jeans length. The condition is that the Jeans length at the maximum resolvable density, $\\lambda_J(\\rho_{\\max})$, must be spanned by at least $N_{\\rm target}$ cells of size $\\Delta x_{\\min}$. The limiting case is given by the equality:\n$$ \\Delta x_{\\min} = \\frac{\\lambda_{J}(\\rho_{\\max})}{N_{\\rm target}} \\implies N_{\\rm target} \\Delta x_{\\min} = \\lambda_{J}(\\rho_{\\max}) $$\nThis states that the Jeans length at the highest density is resolved by exactly $N_{\\rm target}$ cells on the finest grid. We substitute the expression for $\\lambda_J$ evaluated at $\\rho = \\rho_{\\max}$:\n$$ N_{\\rm target} \\Delta x_{\\min} = c_s \\sqrt{\\frac{\\pi}{G\\rho_{\\max}}} $$\nTo find the maximum resolvable density, $\\rho_{\\max}$, we solve this equation for it. First, we square both sides:\n$$ (N_{\\rm target} \\Delta x_{\\min})^2 = c_s^2 \\frac{\\pi}{G\\rho_{\\max}} $$\nRearranging to isolate $\\rho_{\\max}$:\n$$ \\rho_{\\max} = \\frac{\\pi c_s^2}{G (N_{\\rm target} \\Delta x_{\\min})^2} = \\frac{\\pi}{G} \\left( \\frac{c_s}{N_{\\rm target} \\Delta x_{\\min}} \\right)^2 $$\nThe sink creation density is defined as $\\rho_{\\rm sink} = \\alpha\\,\\rho_{\\max}$. Thus, the final symbolic expression for $\\rho_{\\rm sink}$ is:\n$$ \\rho_{\\rm sink} = \\alpha \\frac{\\pi}{G} \\left( \\frac{c_s}{N_{\\rm target} \\Delta x_{\\min}} \\right)^2 $$\nTo compute the numerical value, we first calculate the square of the isothermal sound speed, $c_s^2$, using the provided parameters and constants. All units must be converted to a consistent system, CGS (centimeter-gram-second) in this case.\n\nThe sound speed is given by $c_s = \\sqrt{k_B T / (\\mu m_H)}$. We calculate $c_s^2$:\n- $T = 10\\,\\mathrm{K}$\n- $\\mu = 2.33$\n- $k_B = 1.380649 \\times 10^{-16}\\,\\mathrm{erg\\,K^{-1}} = 1.380649 \\times 10^{-16}\\,\\mathrm{g\\,cm^2\\,s^{-2}\\,K^{-1}}$\n- $m_H = 1.6735575 \\times 10^{-24}\\,\\mathrm{g}$\n$$ c_s^2 = \\frac{k_B T}{\\mu m_H} = \\frac{(1.380649 \\times 10^{-16}\\,\\mathrm{g\\,cm^2\\,s^{-2}\\,K^{-1}}) (10\\,\\mathrm{K})}{(2.33)(1.6735575 \\times 10^{-24}\\,\\mathrm{g})} $$\n$$ c_s^2 = \\frac{1.380649 \\times 10^{-15}}{3.900189975 \\times 10^{-24}}\\,\\mathrm{cm^2\\,s^{-2}} \\approx 3.5399534 \\times 10^8\\,\\mathrm{cm^2\\,s^{-2}} $$\n\nNext, we assemble the other terms for the $\\rho_{\\rm sink}$ calculation in CGS units:\n- $\\alpha = 4$\n- $G = 6.67430 \\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}$\n- $N_{\\rm target} = 32$\n- $\\Delta x_{\\min} = 1\\,\\mathrm{AU} = 1.495978707 \\times 10^{13}\\,\\mathrm{cm}$\n\nNow, we substitute these numerical values into the expression for $\\rho_{\\rm sink}$:\n$$ \\rho_{\\rm sink} = (4) \\frac{\\pi}{6.67430 \\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}} \\left( \\frac{\\sqrt{3.5399534 \\times 10^8\\,\\mathrm{cm^2\\,s^{-2}}}}{(32)(1.495978707 \\times 10^{13}\\,\\mathrm{cm})} \\right)^2 $$\nIt is simpler to use the expression with $c_s^2$:\n$$ \\rho_{\\rm sink} = \\frac{4\\pi c_s^2}{G (N_{\\rm target} \\Delta x_{\\min})^2} $$\nLet's compute the denominator first:\n$$ (N_{\\rm target} \\Delta x_{\\min})^2 = \\left( 32 \\times 1.495978707 \\times 10^{13}\\,\\mathrm{cm} \\right)^2 $$\n$$ (4.7871318624 \\times 10^{14}\\,\\mathrm{cm})^2 \\approx 2.2916616 \\times 10^{29}\\,\\mathrm{cm^2} $$\nNow, the full expression:\n$$ \\rho_{\\rm sink} = \\frac{4\\pi (3.5399534 \\times 10^8\\,\\mathrm{cm^2\\,s^{-2}})}{(6.67430 \\times 10^{-8}\\,\\mathrm{cm^{3}\\,g^{-1}\\,s^{-2}}) (2.2916616 \\times 10^{29}\\,\\mathrm{cm^2})} $$\n$$ \\rho_{\\rm sink} = \\frac{4.4484051 \\times 10^9\\,\\mathrm{cm^2\\,s^{-2}}}{1.5292833 \\times 10^{22}\\,\\mathrm{cm^5\\,g^{-1}\\,s^{-2}}} $$\n$$ \\rho_{\\rm sink} \\approx 2.90884 \\times 10^{-13}\\,\\mathrm{g\\,cm^{-3}} $$\nAs requested, rounding the result to four significant figures gives:\n$$ \\rho_{\\rm sink} \\approx 2.909 \\times 10^{-13}\\,\\mathrm{g\\,cm^{-3}} $$",
            "answer": "$$\\boxed{2.909 \\times 10^{-13}}$$"
        },
        {
            "introduction": "Building on the isothermal case, this exercise explores how a more general barotropic equation of state, $p = K \\rho^{\\gamma}$, affects the Jeans stability criterion. You will investigate how the Jeans length scales with density for different values of the barotropic index $\\gamma$ and analyze the critical interplay between shock-driven compression and gravitational instability. This practice is essential for understanding which refinement trigger—one based on shocks or one based on the Jeans length—is more critical under different physical conditions, such as in stiff versus soft equations of state. ",
            "id": "3532050",
            "problem": "An Adaptive Mesh Refinement (AMR) simulation of a spherically collapsing molecular core uses two refinement triggers: a Jeans-length trigger and a shock sensor. The gas follows a barotropic equation of state (EOS) $p = K \\rho^{\\gamma}$, where $p$ is pressure, $\\rho$ is mass density, $K$ is a constant, and $\\gamma$ is the barotropic index. The Jeans-length trigger enforces $N_J$ cells per local Jeans length, while the shock sensor flags zones with local upstream Mach number $M_1 \\ge M_{\\mathrm{thr}}$ and forces immediate refinement at the shock. Assume an initially uniform core of radius $R$, base grid spacing $\\Delta x_0 = R/N_{\\mathrm{base}}$, and initial density $\\rho_*$. For both isothermal ($\\gamma = 1$) and stiff ($\\gamma  1$) cases, the constant $K$ is chosen such that the sound speed at density $\\rho_*$ equals a fixed value $c_{s,*}$, i.e., for general $\\gamma$ one has $c_s^2(\\rho) = \\partial p/\\partial \\rho$ evaluated at $\\rho_*$, equal to $c_{s,*}^2$. You may take $R = 0.1\\,\\mathrm{pc}$, $N_{\\mathrm{base}} = 64$, $\\rho_* = 10^{-18}\\,\\mathrm{g\\,cm^{-3}}$, $c_{s,*} = 2\\times 10^4\\,\\mathrm{cm\\,s^{-1}}$, $G = 6.674\\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$, $N_J = 8$, and $M_{\\mathrm{thr}} = 2$. Consider a pre-shock inflow with $M_1 = 5$ in both the isothermal and a stiff case with $\\gamma = 1.4$.\n\nStarting from first principles—namely, linear gravitational stability of a uniform medium and conservation laws across shocks—analyze how the barotropic EOS modifies the local Jeans length and how shocks alter it via compression. Then, determine under what conditions the shock-based refinement triggers before the Jeans-length criterion, and how this depends on $\\gamma$ and $M_1$ for the given parameters. Choose the correct statement(s):\n\nA. In the isothermal case $\\gamma = 1$ with $M_1 = 5$, the post-shock Jeans length decreases by a factor equal to $M_1$ relative to the pre-shock value. For the given base grid, the Jeans criterion is initially satisfied but violated immediately behind the shock; thus, the shock sensor is the first trigger to activate.\n\nB. In the stiff case $\\gamma = 1.4$ with $M_1 = 5$, the post-shock Jeans length decreases by the same factor $1/\\sqrt{r}$ as in the isothermal case, where $r$ is the compression ratio, so the Jeans-length trigger is the stricter refinement constraint at the shock.\n\nC. For any barotropic EOS with $\\gamma \\ge 2$, compression increases (or leaves unchanged, if $\\gamma = 2$) the local Jeans length, implying that shock-based refinement necessarily dominates over Jeans-based triggers at shock locations for any $M_1  1$.\n\nD. For any $\\gamma  1$, shock compression always reduces the Jeans length by a factor exactly equal to $1/M_1$, so the Jeans-length trigger is always stricter than the shock sensor in shock-dominated regions.",
            "solution": "The problem requires an analysis of two refinement criteria in an Adaptive Mesh Refinement (AMR) simulation: a Jeans-length trigger and a shock sensor. We must determine their interplay under different physical conditions, governed by a barotropic equation of state $p = K \\rho^{\\gamma}$.\n\n**1. First Principles and General Formulation**\n\nThe analysis must begin from the definitions of the key physical quantities and criteria.\n\n**Jeans Length:** The Jeans length, $\\lambda_J$, represents the critical scale for gravitational instability in a self-gravitating fluid. It is derived by a linear perturbation analysis of the fluid equations, balancing pressure support against gravitational collapse. The standard formula is:\n$$ \\lambda_J = c_s \\sqrt{\\frac{\\pi}{G\\rho}} $$\nwhere $c_s$ is the sound speed, $\\rho$ is the mass density, and $G$ is the gravitational constant.\n\n**Sound Speed:** The equation of state (EOS) is given as $p = K \\rho^{\\gamma}$. The sound speed squared is defined as $c_s^2 = \\frac{\\partial p}{\\partial \\rho}$. For the given barotropic EOS, this yields:\n$$ c_s^2 = \\frac{\\partial}{\\partial \\rho}(K \\rho^{\\gamma}) = K \\gamma \\rho^{\\gamma-1} $$\nThe constant $K$ is set by the condition that at the initial density $\\rho_*$, the sound speed is $c_{s,*}$. Thus, $c_{s,*}^2 = K \\gamma \\rho_*^{\\gamma-1}$, which allows us to determine $K = \\frac{c_{s,*}^2}{\\gamma \\rho_*^{\\gamma-1}}$. Substituting this back into the expression for $c_s^2$, we can express the sound speed at any density $\\rho$ in terms of the initial state:\n$$ c_s^2(\\rho) = \\left(\\frac{c_{s,*}^2}{\\gamma \\rho_*^{\\gamma-1}}\\right) \\gamma \\rho^{\\gamma-1} = c_{s,*}^2 \\left(\\frac{\\rho}{\\rho_*}\\right)^{\\gamma-1} $$\n$$ c_s(\\rho) = c_{s,*} \\left(\\frac{\\rho}{\\rho_*}\\right)^{(\\gamma-1)/2} $$\n\n**Jeans Length as a Function of Density:** We can now write the Jeans length solely as a function of density $\\rho$ and the initial state parameters:\n$$ \\lambda_J(\\rho) = c_{s,*} \\left(\\frac{\\rho}{\\rho_*}\\right)^{(\\gamma-1)/2} \\sqrt{\\frac{\\pi}{G\\rho}} = c_{s,*} \\sqrt{\\frac{\\pi}{G\\rho_*}} \\left(\\frac{\\rho}{\\rho_*}\\right)^{(\\gamma-1)/2} \\left(\\frac{\\rho}{\\rho_*}\\right)^{-1/2} $$\nDefining the initial Jeans length as $\\lambda_{J,*} = c_{s,*} \\sqrt{\\frac{\\pi}{G\\rho_*}}$, the expression simplifies to:\n$$ \\lambda_J(\\rho) = \\lambda_{J,*} \\left(\\frac{\\rho}{\\rho_*}\\right)^{(\\gamma-2)/2} $$\nThis equation is central to the analysis, as it shows how the Jeans length scales with density for a given barotropic index $\\gamma$.\n\n**Shock Jump Conditions:** Across a shock front, mass and momentum must be conserved. Let subscript $1$ denote the pre-shock (upstream) state and $2$ denote the post-shock (downstream) state. In the frame of the shock, the Rankine-Hugoniot conditions for a barotropic fluid are:\n1.  Mass conservation: $\\rho_1 v_1 = \\rho_2 v_2$\n2.  Momentum conservation: $p_1 + \\rho_1 v_1^2 = p_2 + \\rho_2 v_2^2$\n\nLet the compression ratio be $r = \\rho_2/\\rho_1$. From mass conservation, $v_2 = v_1/r$. The momentum equation becomes:\n$$ p_1 + \\rho_1 v_1^2 = p_1 r^{\\gamma} + (\\rho_1 r) (v_1/r)^2 = p_1 r^{\\gamma} + \\frac{\\rho_1 v_1^2}{r} $$\nRearranging gives $\\rho_1 v_1^2 (1 - 1/r) = p_1 (r^{\\gamma} - 1)$. The upstream Mach number is $M_1 = v_1/c_{s,1}$. Since $c_{s,1}^2 = \\gamma p_1/\\rho_1$, we have $\\rho_1 v_1^2 = \\gamma M_1^2 p_1$. Substituting this, we get:\n$$ \\gamma M_1^2 p_1 \\left(\\frac{r-1}{r}\\right) = p_1 (r^{\\gamma} - 1) $$\nAssuming $p_1 \\neq 0$, we arrive at the barotropic shock jump relation:\n$$ \\gamma M_1^2 \\frac{r-1}{r} = r^{\\gamma} - 1 $$\nFor $\\gamma1$, if the EOS represents the total energy (i.e., it is an adiabatic relation), this is equivalent to the standard result $r = \\frac{(\\gamma+1)M_1^2}{2 + (\\gamma-1)M_1^2}$.\n\n**Refinement Criteria:**\n1.  **Jeans-length trigger:** Refinement is required if the number of cells per Jeans length falls below $N_J$. With a local cell size $\\Delta x$, this condition is $\\frac{\\lambda_J}{\\Delta x}  N_J$, or $\\lambda_J  N_J \\Delta x$.\n2.  **Shock sensor:** Refinement is triggered if the upstream Mach number $M_1 \\ge M_{\\mathrm{thr}}$.\n\n**2. Analysis of Options**\n\nWe now evaluate each statement based on the derived principles and the given parameters: $R = 0.1\\,\\mathrm{pc}$, $N_{\\mathrm{base}} = 64$, $\\rho_* = 10^{-18}\\,\\mathrm{g\\,cm^{-3}}$, $c_{s,*} = 2\\times 10^4\\,\\mathrm{cm\\,s^{-1}}$, $G = 6.674\\times 10^{-8}\\,\\mathrm{cgs}$, $N_J = 8$, $M_{\\mathrm{thr}} = 2$.\n\nFirst, let's calculate the initial state:\n-   Initial Jeans length: $\\lambda_{J,*} = (2\\times 10^4\\,\\mathrm{cm\\,s^{-1}}) \\sqrt{\\frac{\\pi}{(6.674\\times 10^{-8})(10^{-18})\\,\\mathrm{cgs}}} \\approx 1.37 \\times 10^{17}\\,\\mathrm{cm}$.\n-   Base grid spacing: $\\Delta x_0 = \\frac{R}{N_{\\mathrm{base}}} = \\frac{0.1 \\times 3.086 \\times 10^{18}\\,\\mathrm{cm}}{64} \\approx 4.82 \\times 10^{15}\\,\\mathrm{cm}$.\n-   Initial Jeans resolution: $\\frac{\\lambda_{J,*}}{\\Delta x_0} \\approx \\frac{1.37 \\times 10^{17}\\,\\mathrm{cm}}{4.82 \\times 10^{15}\\,\\mathrm{cm}} \\approx 28.4$.\nSince $28.4  N_J = 8$, the Jeans criterion is initially satisfied.\n\n**A. In the isothermal case $\\gamma = 1$ with $M_1 = 5$, the post-shock Jeans length decreases by a factor equal to $M_1$ relative to the pre-shock value. For the given base grid, the Jeans criterion is initially satisfied but violated immediately behind the shock; thus, the shock sensor is the first trigger to activate.**\n\n- **Analysis for $\\gamma = 1$ (Isothermal):**\n    - The scaling law gives $\\lambda_J(\\rho) = \\lambda_{J,*} (\\rho/\\rho_*)^{-1/2} \\propto \\rho^{-1/2}$.\n    - For $\\gamma=1$, the jump relation $\\gamma M_1^2 \\frac{r-1}{r} = r^{\\gamma} - 1$ becomes $1 \\cdot M_1^2 \\frac{r-1}{r} = r-1$. For a shock ($r \\ne 1$), this simplifies to $M_1^2/r=1$, so $r = M_1^2$. The density increases by the square of the Mach number.\n    - The post-shock Jeans length $\\lambda_{J,2}$ relative to the pre-shock length $\\lambda_{J,1}$ is:\n      $ \\frac{\\lambda_{J,2}}{\\lambda_{J,1}} = \\left(\\frac{\\rho_2}{\\rho_1}\\right)^{(\\gamma-2)/2} = r^{(1-2)/2} = r^{-1/2} = (M_1^2)^{-1/2} = \\frac{1}{M_1} $.\n    - With $M_1 = 5$, the post-shock Jeans length decreases by a factor of $5$. The first part of the statement is correct.\n- **Validation with given parameters:**\n    - The Jeans criterion is initially satisfied ($28.4  8$).\n    - Assume the pre-shock state is the initial state, so $\\lambda_{J,1} = \\lambda_{J,*}$ and the grid resolution is $\\Delta x_0$.\n    - The shock sensor triggers because $M_1 = 5  M_{\\mathrm{thr}} = 2$.\n    - The post-shock resolution on the un-refined grid is $\\frac{\\lambda_{J,2}}{\\Delta x_0} = \\frac{\\lambda_{J,1}/M_1}{\\Delta x_0} = \\frac{28.4}{5} \\approx 5.68$.\n    - Since $5.68  N_J=8$, the Jeans criterion is now violated.\n    - The shock event, with $M_1 = 5$, directly triggers the shock sensor. This same event causes a density jump that leads to a violation of the Jeans criterion. In a causal sense, the shock is the primary event, and the shock sensor is its direct detector. The Jeans length violation is a consequence. Therefore, it is appropriate to state that the shock sensor is the first or primary trigger.\n- **Verdict:** **Correct**.\n\n**B. In the stiff case $\\gamma = 1.4$ with $M_1 = 5$, the post-shock Jeans length decreases by the same factor $1/\\sqrt{r}$ as in the isothermal case, where $r$ is the compression ratio, so the Jeans-length trigger is the stricter refinement constraint at the shock.**\n\n- **Analysis for $\\gamma=1.4$:**\n    - The factor of decrease for the Jeans length is $r^{(\\gamma-2)/2} = r^{(1.4-2)/2} = r^{-0.3}$.\n    - The statement claims this factor is $1/\\sqrt{r} = r^{-0.5}$. This is only true if $\\gamma=1$. For $\\gamma=1.4$, the claim is false. The first part is incorrect.\n    - Let's check the conclusion anyway. For $\\gamma=1.4$ and $M_1=5$, the compression ratio (using the adiabatic formula) is:\n      $r = \\frac{(1.4+1)5^2}{2+(1.4-1)5^2} = \\frac{2.4 \\times 25}{2 + 0.4 \\times 25} = \\frac{60}{12} = 5$.\n    - The post-shock resolution is $\\frac{\\lambda_{J,2}}{\\Delta x_0} = \\frac{\\lambda_{J,1}}{\\Delta x_0} r^{-0.3} \\approx 28.4 \\times 5^{-0.3} \\approx 28.4 \\times 0.619 \\approx 17.58$.\n    - Since $17.58  N_J=8$, the Jeans criterion is **not** violated.\n    - The shock sensor triggers ($M_1=5  2$), but the Jeans-length trigger does not. Therefore, the Jeans-length trigger is not stricter; in fact, it is not activated at all.\n- **Verdict:** **Incorrect**.\n\n**C. For any barotropic EOS with $\\gamma \\ge 2$, compression increases (or leaves unchanged, if $\\gamma = 2$) the local Jeans length, implying that shock-based refinement necessarily dominates over Jeans-based triggers at shock locations for any $M_1  1$.**\n\n- **Analysis for $\\gamma \\ge 2$:**\n    - The scaling law is $\\lambda_J \\propto \\rho^{(\\gamma-2)/2}$.\n    - If $\\gamma  2$, the exponent is positive, so $\\lambda_J$ increases as density $\\rho$ increases.\n    - If $\\gamma = 2$, the exponent is zero, so $\\lambda_J$ is independent of density.\n    - A shock always causes compression ($\\rho_2  \\rho_1$). Therefore, for any shock, the post-shock Jeans length $\\lambda_{J,2}$ will be greater than or equal to the pre-shock length $\\lambda_{J,1}$.\n    - If the Jeans criterion was satisfied before the shock ($\\lambda_{J,1} / \\Delta x \\ge N_J$), it must remain satisfied after the shock ($\\lambda_{J,2} / \\Delta x \\ge \\lambda_{J,1} / \\Delta x \\ge N_J$).\n    - This means for $\\gamma \\ge 2$, a shock can never cause the Jeans-length criterion to be violated. Refinement at a shock location can thus only be triggered by the shock sensor (if $M_1 \\ge M_{\\mathrm{thr}}$). In this sense, the shock-based trigger \"dominates\" as it is the only one of the two that can possibly activate at a shock.\n- **Verdict:** **Correct**.\n\n**D. For any $\\gamma  1$, shock compression always reduces the Jeans length by a factor exactly equal to $1/M_1$, so the Jeans-length trigger is always stricter than the shock sensor in shock-dominated regions.**\n\n- **Analysis:**\n    - The reduction factor is $r^{(\\gamma-2)/2}$. The statement claims this is always $1/M_1$. We have proven this is true only for the special case of $\\gamma=1$. For our $\\gamma=1.4, M_1=5$ case, the factor was $r^{-0.3} = 5^{-0.3} \\approx 1/1.62$, while $1/M_1 = 1/5$. These are not equal. The first part of the statement is false.\n    - The conclusion \"so the Jeans-length trigger is always stricter\" is also false. As shown in the analysis of option B for $\\gamma=1.4$, the Jeans trigger was not activated at all, while the shock sensor was.\n- **Verdict:** **Incorrect**.\n\n**Conclusion**\nBased on the derivations from first principles, statements A and C are correct, while B and D are incorrect.",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "Moving from theory to algorithmic design, this hands-on practice challenges you to develop a sophisticated, multi-faceted refinement criterion from first principles. You will formulate a robust shock detector by comparing the fluid compression timescale to the acoustic timescale within a grid cell, and combine it with a minimum Mach number requirement to filter out weak, physically insignificant compressions. This task culminates in implementing a complete logic that refines for both shock-like features and for regions where the Jeans-length criterion, $\\lambda_J \\lt N_J \\Delta x$, is violated, representing a core component of modern AMR codes. ",
            "id": "3532010",
            "problem": "You are tasked with designing and implementing an algorithmic refinement criterion for Adaptive Mesh Refinement (AMR) in compressible hydrodynamics that balances refinement for shock waves against turbulent compressions that do not produce strong jumps, while also enforcing gravitational collapse resolution via the Jeans length. Work in one spatial dimension and assume a calorically perfect gas. The refinement decision for a cell must be based on combining a shock/compression detector derived from conservation-law reasoning and a gravitational stability detector derived from the Jeans criterion.\n\nStart from the following fundamental base:\n\n- Conservation of mass implies that for a one-dimensional flow with velocity $v(x,t)$, the volumetric compression rate is $-\\nabla\\cdot\\mathbf{v} = -\\partial v/\\partial x$. The compression timescale is $ \\tau_{\\mathrm{comp}} = 1/|\\nabla\\cdot\\mathbf{v}| $.\n- The acoustic crossing time across a computational cell of width $\\Delta x$ is $ \\tau_s = \\Delta x / c_s $, where the sound speed is given by $ c_s = \\sqrt{\\gamma p/\\rho} $ for adiabatic index $\\gamma$, pressure $p$, and mass density $\\rho$.\n- Define the normalized compression rate $ C = -\\Delta x\\,\\nabla\\cdot\\mathbf{v} / c_s $, which compares the compression timescale to the cell acoustic time.\n- For a planar normal shock in a perfect gas, the Rankine–Hugoniot relations imply a density jump $ r = \\rho_2/\\rho_1 $ that depends on the upstream Mach number $ M_1 $, namely $ r(M_1,\\gamma) = \\dfrac{(\\gamma+1) M_1^2}{(\\gamma-1) M_1^2 + 2} $. A physically meaningful shock detector should avoid refining solely on mild compressions that would produce negligible jumps; one way to formalize this is to enforce a minimum jump factor $ r_{\\min}  1 $.\n- The Jeans length for self-gravitating gas is $ \\lambda_J = c_s \\sqrt{\\pi/(G \\rho)} $, where $G$ is the gravitational constant. A common resolution prescription is to require at least $N_J$ cells per Jeans length, i.e., to refine if $ \\lambda_J  N_J \\Delta x $.\n\nYour derivation task:\n\n1. Using only the definitions above and first principles, derive a principled shock/compression refinement threshold by combining $ C $, the Mach number $ M = |v|/c_s $, and a minimum density jump requirement $ r_{\\min} $. Explain why a timescale balance motivates a threshold for $ C $, and derive a lower bound $ M_{\\min}(r_{\\min},\\gamma) $ on the Mach number such that the jump $ r \\ge r_{\\min} $ holds according to the Rankine–Hugoniot relations.\n\n2. Combine this shock/compression criterion with the Jeans-length criterion so that a cell is flagged for refinement if and only if at least one of the following holds:\n   - The flow is converging, $ \\nabla\\cdot\\mathbf{v}  0 $, and the shock/compression threshold you derived is satisfied.\n   - The Jeans-length resolution requirement $ \\lambda_J  N_J \\Delta x $ is violated.\n\nImplementation task:\n\n- Implement a program that, for each test case, computes:\n  - The sound speed $ c_s $ from $ \\gamma $, $ p $, and $ \\rho $.\n  - The normalized compression rate $ C $.\n  - The Mach number $ M = |v|/c_s $.\n  - The Jeans length $ \\lambda_J $.\n  - The minimum Mach number $ M_{\\min}(r_{\\min},\\gamma) $ corresponding to a required minimum density jump $ r_{\\min} $.\n  - A boolean refinement decision based on the combined criterion above.\n- Use the one-dimensional assumption so that the normal component of velocity equals the speed $ |v| $ and $ \\nabla\\cdot\\mathbf{v} $ equals $ \\partial v/\\partial x $.\n- Use the following fixed parameters across all test cases:\n  - Adiabatic index $ \\gamma = 5/3 $.\n  - Gravitational constant $ G = 6.67430\\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}} $.\n  - Target Jeans resolution $ N_J = 32 $.\n  - Minimum density jump $ r_{\\min} = 1.2 $.\n  - Timescale-balance threshold for the normalized compression rate $ C $ set by your derivation.\n- All physical quantities must be treated in the International System of Units (SI). Report the final boolean refinement flags with no units.\n\nTest suite:\n\nEach test case is a tuple $(\\rho, p, v, \\nabla\\cdot\\mathbf{v}, \\Delta x)$ with the following values, all in SI units:\n\n1. Case A (strong compressive shock-like flow): $(\\rho, p, v, \\nabla\\cdot\\mathbf{v}, \\Delta x) = (1\\times 10^{-19}\\ \\mathrm{kg\\,m^{-3}},\\ 5.4\\times 10^{-13}\\ \\mathrm{Pa},\\ 9.0\\times 10^{3}\\ \\mathrm{m\\,s^{-1}},\\ -6.0\\times 10^{-12}\\ \\mathrm{s^{-1}},\\ 1.0\\times 10^{15}\\ \\mathrm{m})$.\n2. Case B (subsonic compression, mild): $(1\\times 10^{-19},\\ 5.4\\times 10^{-13},\\ 1.5\\times 10^{3},\\ -9.0\\times 10^{-13},\\ 1.0\\times 10^{15})$.\n3. Case C (marginally supersonic, slow compression): $(1\\times 10^{-19},\\ 5.4\\times 10^{-13},\\ 3.3\\times 10^{3},\\ -2.4\\times 10^{-12},\\ 1.0\\times 10^{15})$.\n4. Case D (gravitational refinement via Jeans): $(1\\times 10^{-14},\\ 2.4\\times 10^{-10},\\ 1.0\\times 10^{2},\\ 0.0,\\ 1.0\\times 10^{15})$.\n5. Case E (hot gas, subsonic compression): $(1\\times 10^{-20},\\ 2.4\\times 10^{-10},\\ 1.0\\times 10^{5},\\ -1.0\\times 10^{-11},\\ 1.0\\times 10^{15})$.\n6. Case F (expansion): $(1\\times 10^{-19},\\ 5.4\\times 10^{-13},\\ 3.0\\times 10^{3},\\ +5.0\\times 10^{-12},\\ 1.0\\times 10^{15})$.\n\nYour program should produce a single line of output containing the six boolean refinement decisions for the cases above as a comma-separated list enclosed in square brackets (for example, $[{\\rm True},{\\rm False},\\dots]$). No other text should be printed. The booleans must reflect your derived threshold and the combined criterion exactly.",
            "solution": "We begin from first principles and well-tested formulas to derive a balanced refinement threshold that distinguishes shocks from benign compressions and also enforces gravitational resolution.\n\nTimescale-based normalization for compression:\n\n- The volumetric compression rate for one-dimensional flow is $ -\\nabla\\cdot\\mathbf{v} = -\\partial v/\\partial x $, and the associated compression timescale is $ \\tau_{\\mathrm{comp}} = 1/|\\nabla\\cdot\\mathbf{v}| $.\n- The acoustic crossing time across a cell of width $ \\Delta x $ is $ \\tau_s = \\Delta x / c_s $, where $ c_s = \\sqrt{\\gamma p/\\rho} $ is the adiabatic sound speed.\n- The normalized compression rate is defined as\n$$\nC \\equiv -\\frac{\\Delta x\\,\\nabla\\cdot\\mathbf{v}}{c_s} = \\frac{\\tau_s}{\\tau_{\\mathrm{comp}}}.\n$$\n- Physical interpretation: when $ C \\gtrsim 1 $, the compression timescale is shorter than or comparable to the sound-crossing time across the cell, indicating that the flow compresses faster than information can be communicated acoustically over one cell. This is characteristic of shock-like behavior or incipient discontinuities in a discretized representation. Conversely, $ C \\ll 1 $ indicates that compression is slow relative to acoustic communication, typical of smooth, near-isentropic motions such as subsonic turbulence.\n\nTherefore, a principled timescale threshold for shock-like compression is $ C \\ge \\theta $, with $ \\theta $ of order unity. The most natural choice from the definition is $ \\theta = 1 $, which corresponds to $ \\tau_{\\mathrm{comp}} \\le \\tau_s $.\n\nMinimum physically significant jump:\n\nTo avoid refining on extremely weak shocks or mild compressions that do not produce strong state changes, we impose a minimum density jump $ r_{\\min}  1 $ across a shock. For a planar normal shock in a perfect gas, the Rankine–Hugoniot density ratio is\n$$\nr(M_1,\\gamma) = \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1) M_1^2}{(\\gamma-1) M_1^2 + 2},\n$$\nwhere $ M_1 $ is the upstream Mach number normal to the shock. We require $ r(M_1,\\gamma) \\ge r_{\\min} $. Solving for $ M_1 $ yields the minimum Mach number $ M_{\\min} $ that produces at least the specified jump:\n$$\nr_{\\min}\\left[(\\gamma-1) M_{\\min}^2 + 2\\right] = (\\gamma+1)M_{\\min}^2 \\quad\\Rightarrow\\quad\n\\left[(\\gamma+1) - r_{\\min}(\\gamma-1)\\right] M_{\\min}^2 = 2 r_{\\min}.\n$$\nAssuming $ r_{\\min}  (\\gamma+1)/(\\gamma-1) $ (so that the right-hand side is physically attainable), we obtain\n$$\nM_{\\min}(r_{\\min},\\gamma) = \\sqrt{\\frac{2 r_{\\min}}{(\\gamma+1) - r_{\\min}(\\gamma-1)}}.\n$$\nThis lower bound ensures that refinement will not be triggered by compressions that would not produce at least a $ r_{\\min} $ density increase according to shock jump conditions.\n\nCombining the compression timescale and jump significance:\n\nIn one dimension, the normal component of the flow equals the speed $ |v| $, so the Mach number is $ M = |v|/c_s $. A converging flow has $ \\nabla\\cdot\\mathbf{v}  0 $. The shock/compression refinement criterion is then:\n- Convergence: $ \\nabla\\cdot\\mathbf{v}  0 $.\n- Timescale domination: $ C \\equiv -\\Delta x\\,\\nabla\\cdot\\mathbf{v} / c_s \\ge \\theta $, with $ \\theta = 1 $.\n- Minimum jump consistency: $ M = |v|/c_s \\ge M_{\\min}(r_{\\min},\\gamma) $.\n\nIf all three hold, the cell is flagged for refinement due to shock-like compression. This balances true shocks against benign compressions because (i) $ C \\ge 1 $ filters slow compressions, and (ii) $ M \\ge M_{\\min} $ filters nearly isentropic subsonic motions and even very weak supersonic compressions unlikely to produce strong jumps.\n\nJeans-length refinement:\n\nFor gravitational collapse, the Jeans length is\n$$\n\\lambda_J = c_s \\sqrt{\\frac{\\pi}{G \\rho}}.\n$$\nThe Truelove-type resolution requirement is to refine when the Jeans length is not resolved by at least $ N_J $ cells:\n$$\n\\lambda_J  N_J \\Delta x.\n$$\n\nFinal combined refinement decision:\n\nA cell is refined if either\n- Shock/compression criterion is satisfied (convergence, $ C \\ge 1 $, and $ M \\ge M_{\\min} $), or\n- Jeans criterion is violated ($ \\lambda_J  N_J \\Delta x $).\n\nAlgorithmic steps for each test case $(\\rho, p, v, \\nabla\\cdot\\mathbf{v}, \\Delta x)$:\n\n1. Compute $ c_s = \\sqrt{\\gamma p/\\rho} $.\n2. Compute $ C = -\\Delta x\\,\\nabla\\cdot\\mathbf{v} / c_s $.\n3. Compute $ M = |v|/c_s $.\n4. Compute $ \\lambda_J = c_s \\sqrt{\\pi/(G\\rho)} $.\n5. Compute $ M_{\\min}(r_{\\min},\\gamma) $ using the closed-form expression above. If $ r_{\\min} \\ge (\\gamma+1)/(\\gamma-1) $, set $ M_{\\min} \\to +\\infty $ to ensure no false refinement; here $ r_{\\min} = 1.2 $ and $ \\gamma = 5/3 $ give a finite value.\n6. Define boolean flags:\n   - $ \\mathrm{shock\\_refine} = (\\nabla\\cdot\\mathbf{v}  0) \\land (C \\ge 1) \\land (M \\ge M_{\\min}) $.\n   - $ \\mathrm{jeans\\_refine} = (\\lambda_J  N_J \\Delta x) $.\n   - $ \\mathrm{refine} = \\mathrm{shock\\_refine} \\lor \\mathrm{jeans\\_refine} $.\n\nEvaluation on the test suite:\n\n- Case A: $ \\rho = 1\\times 10^{-19} $, $ p = 5.4\\times 10^{-13} $, $ v = 9.0\\times 10^{3} $, $ \\nabla\\cdot\\mathbf{v} = -6.0\\times 10^{-12} $, $ \\Delta x = 1.0\\times 10^{15} $. With $ \\gamma = 5/3 $, $ c_s = 3.0\\times 10^{3} $, so $ M = 3.0 $, $ C = 2.0 \\ge 1 $, convergence holds, and $ M_{\\min}(1.2,5/3) \\approx 1.134 $. Jeans length $ \\lambda_J \\approx 2.06\\times 10^{18} $ is much larger than $ N_J \\Delta x = 3.2\\times 10^{16} $. Refine due to shock: ${\\rm True}$.\n- Case B: $ M = 0.5 $, $ C = 0.3  1 $. No shock refinement; Jeans is well-resolved. ${\\rm False}$.\n- Case C: $ M \\approx 1.1  M_{\\min} $, $ C = 0.8  1 $. ${\\rm False}$.\n- Case D: Dense, cold gas: $ c_s = 2.0\\times 10^{2}\\ \\mathrm{m\\,s^{-1}} $, $\\nabla\\cdot\\mathbf{v} = 0$, so no shock refinement. Jeans length $ \\lambda_J \\approx 4.34\\times 10^{14}\\ \\mathrm{m}  3.2\\times 10^{16}\\ \\mathrm{m} $. Jeans triggers refinement. ${\\rm True}$.\n- Case E: Hot gas, subsonic mild compression: $ C \\approx 0.05  1 $, $ M = 0.5 $. No refinement. ${\\rm False}$.\n- Case F: Expansion: $ \\nabla\\cdot\\mathbf{v}  0 $. No shock refinement; Jeans is well-resolved. ${\\rm False}$.\n\nThe final program implements these computations and prints a single-line list of six booleans in the required format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef minimum_mach_from_density_jump(r_min: float, gamma: float) - float:\n    \"\"\"\n    Compute M_min such that the Rankine-Hugoniot density jump r(M,gamma) = r_min.\n    r(M,gamma) = ((gamma+1) M^2) / ((gamma-1) M^2 + 2)\n    Solve analytically for M^2.\n    If r_min is unphysical (= (gamma+1)/(gamma-1)), return +inf.\n    \"\"\"\n    r_max = (gamma + 1.0) / (gamma - 1.0)\n    if r_min = 1.0:\n        return 0.0\n    if r_min = r_max:\n        return np.inf\n    denom = (gamma + 1.0) - r_min * (gamma - 1.0)\n    m2 = 2.0 * r_min / denom\n    if m2 = 0.0:\n        return np.inf\n    return float(np.sqrt(m2))\n\ndef compute_sound_speed(rho: float, p: float, gamma: float) - float:\n    \"\"\"c_s = sqrt(gamma * p / rho)\"\"\"\n    return float(np.sqrt(gamma * p / rho))\n\ndef jeans_length(cs: float, rho: float, G: float) - float:\n    \"\"\"Jeans length: lambda_J = cs * sqrt(pi / (G * rho))\"\"\"\n    return float(cs * np.sqrt(np.pi / (G * rho)))\n\ndef refine_decision(case, gamma: float, G: float, N_J: int, r_min: float, theta_C: float) - bool:\n    \"\"\"\n    Decide refinement for one case.\n    case: tuple (rho, p, v, div_v, dx) with SI units.\n    gamma: adiabatic index\n    G: gravitational constant\n    N_J: target number of cells per Jeans length\n    r_min: minimum desired density jump across shocks\n    theta_C: threshold for normalized compression rate C\n    \"\"\"\n    rho, p, v, div_v, dx = case\n    cs = compute_sound_speed(rho, p, gamma)\n    # Normalized compression rate C = -dx * div_v / cs\n    C = -dx * div_v / cs\n    # Mach number in 1D (normal component equals |v|)\n    M = abs(v) / cs\n    # Jeans length\n    lam_J = jeans_length(cs, rho, G)\n    jeans_refine = lam_J  N_J * dx\n    # Minimum Mach consistent with minimum jump\n    M_min = minimum_mach_from_density_jump(r_min, gamma)\n    # Shock/compression refinement criterion\n    shock_refine = (div_v  0.0) and (C = theta_C) and (M = M_min)\n    return bool(jeans_refine or shock_refine)\n\ndef solve():\n    # Constants\n    gamma = 5.0 / 3.0  # adiabatic index\n    G = 6.67430e-11    # m^3 kg^-1 s^-2\n    N_J = 32           # cells per Jeans length\n    r_min = 1.2        # minimum density jump to consider significant\n    theta_C = 1.0      # timescale-balance threshold for normalized compression rate\n\n    # Define the test cases from the problem statement.\n    # Each tuple: (rho [kg/m^3], p [Pa], v [m/s], div_v [1/s], dx [m])\n    test_cases = [\n        (1.0e-19, 5.4e-13, 9.0e3, -6.0e-12, 1.0e15),   # Case A\n        (1.0e-19, 5.4e-13, 1.5e3, -9.0e-13, 1.0e15),   # Case B\n        (1.0e-19, 5.4e-13, 3.3e3, -2.4e-12, 1.0e15),   # Case C\n        (1.0e-14, 2.4e-10, 1.0e2,  0.0e0,   1.0e15),   # Case D\n        (1.0e-20, 2.4e-10, 1.0e5, -1.0e-11, 1.0e15),   # Case E\n        (1.0e-19, 5.4e-13, 3.0e3,  5.0e-12, 1.0e15),   # Case F\n    ]\n\n    results = []\n    for case in test_cases:\n        result = refine_decision(case, gamma=gamma, G=G, N_J=N_J, r_min=r_min, theta_C=theta_C)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}