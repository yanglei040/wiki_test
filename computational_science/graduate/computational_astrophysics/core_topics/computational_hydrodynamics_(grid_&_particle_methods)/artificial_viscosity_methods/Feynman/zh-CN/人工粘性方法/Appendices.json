{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的人工粘性模型之前，我们必须首先从基本原理上理解为什么需要它。本练习将通过一个一维线性平流方程，来揭示在没有粘性项时，数值格式如何产生非物理振荡。通过运用冯·诺依曼稳定性分析和总变差递减(TVD)准则，您将亲自推导出保证数值解单调性所需的最小人工粘性，从而为人工粘性在稳定激波中的作用奠定坚实的理论基础 。",
            "id": "3504913",
            "problem": "考虑在计算天体物理学中用作被动标量输运模型的一维线性平流方程，\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0,\n$$\n增加一个人工粘性项以稳定陡峭梯度附近的数值振荡，\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = \\epsilon\\,\\partial_{xx} u(x,t).\n$$\n假设一个间距为 $\\Delta x$ 的均匀网格和一个时间步长为 $\\Delta t$ 的显式单步时间积分器。考虑以下守恒有限差分格式，该格式对时间步进使用向前欧拉法，对平流项使用中心差分，对粘性项使用二阶差分：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right).\n$$\n引入无量纲参数 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ 和 $\\mu = \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}$。从第一性原理出发，完成以下任务：\n\n- 通过泰勒展开推导该格式的一致性（精度）条件，并用 $\\Delta t$、$\\Delta x$、$a$ 和 $\\epsilon$ 表示局部截断误差中的领头阶项。\n- 使用 Lax–Richtmyer 等价定理（LRET），阐明此线性常系数格式在网格加密下保证收敛的稳定性要求。\n- 将总变差递减（TVD）要求映射为此线性更新的单调性约束，并推导出对所有网格点强制实现TVD的关于 $\\lambda$ 和 $\\mu$ 的不等式。\n- 根据这些不等式，确定在保持一致性的同时，保证给定离散化具有TVD行为的最小人工粘性 $\\epsilon(\\Delta x,\\Delta t)$。\n\n以单个闭式表达式给出最小人工粘性 $\\epsilon$ 关于 $a$ 和 $\\Delta x$ 的最终答案，不进行任何数值代入。如果进行数值计算，则以平方米每秒为单位表示 $\\epsilon$，但最终表达式中不包含单位。无需四舍五入。",
            "solution": "问题陈述是有效的，因为它提出了一个计算流体动力学中的标准适定问题，涉及对平流-扩散方程的有限差分格式的数值分析。该问题在科学上是合理的、客观的且自洽的。我将按要求进行四部分的推导。\n\n控制偏微分方程（PDE）是一维线性平流-扩散方程：\n$$\n\\partial_{t} u + a\\,\\partial_{x} u = \\epsilon\\,\\partial_{xx} u\n$$\n所给的有限差分格式为：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\n使用无量纲参数 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ 和 $\\mu = \\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}$，该格式可以写成：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\lambda}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\mu\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\n\n首先，为推导一致性条件和局部截断误差，我们在点 $(x_j, t_n)$ 周围对格式中的每一项进行泰勒级数展开。我们将格式重新整理为：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} - \\epsilon\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{\\Delta x^{2}} = 0\n$$\n我们展开每一项，其中 $u$ 及其导数均在 $(x_j, t_n)$ 处取值：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{(u + \\Delta t\\,\\partial_t u + \\frac{\\Delta t^2}{2}\\partial_{tt} u + \\dots) - u}{\\Delta t} = \\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u + O(\\Delta t^2)\n$$\n$$\n\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = \\frac{(u + \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u + \\frac{\\Delta x^3}{6}\\partial_{xxx} u + \\dots) - (u - \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u - \\frac{\\Delta x^3}{6}\\partial_{xxx} u + \\dots)}{2\\,\\Delta x} = \\partial_x u + \\frac{\\Delta x^2}{6}\\partial_{xxx} u + O(\\Delta x^4)\n$$\n$$\n\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{\\Delta x^{2}} = \\frac{(u + \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u + \\dots) - 2u + (u - \\Delta x\\,\\partial_x u + \\frac{\\Delta x^2}{2}\\partial_{xx} u + \\dots)}{\\Delta x^2} = \\partial_{xx} u + \\frac{\\Delta x^2}{12}\\partial_{xxxx} u + O(\\Delta x^4)\n$$\n将这些展开式代入重新整理后的格式，得到截断误差 $T_j^n$：\n$$\nT_j^n = \\left(\\partial_t u + \\frac{\\Delta t}{2}\\partial_{tt} u\\right) + a\\left(\\partial_x u + \\frac{\\Delta x^2}{6}\\partial_{xxx} u\\right) - \\epsilon\\left(\\partial_{xx} u + \\frac{\\Delta x^2}{12}\\partial_{xxxx} u\\right) + \\dots\n$$\n$$\nT_j^n = (\\partial_t u + a\\,\\partial_x u - \\epsilon\\,\\partial_{xx} u) + \\frac{\\Delta t}{2}\\partial_{tt} u + a\\,\\frac{\\Delta x^2}{6}\\partial_{xxx} u - \\epsilon\\,\\frac{\\Delta x^2}{12}\\partial_{xxxx} u + O(\\Delta t^2, \\Delta x^4)\n$$\n对于偏微分方程的精确解，第一项 $(\\partial_t u + a\\,\\partial_x u - \\epsilon\\,\\partial_{xx} u)$ 为零。因此，局部截断误差为：\n$$\nT_j^n = \\frac{\\Delta t}{2}\\partial_{tt} u + a\\,\\frac{\\Delta x^2}{6}\\partial_{xxx} u - \\epsilon\\,\\frac{\\Delta x^2}{12}\\partial_{xxxx} u + \\dots\n$$\n由于当 $\\Delta t \\to 0$ 和 $\\Delta x \\to 0$ 时，$T_j^n \\to 0$，所以该格式是一致的。领头阶误差项为 $O(\\Delta t)$ 和 $O(\\Delta x^2)$，因此该格式在时间上具有一阶精度，在空间上具有二阶精度。\n\n其次，根据 Lax–Richtmyer 等价定理，对于应用于适定线性初值问题的一致格式，收敛性等价于稳定性。我们使用 von Neumann 方法分析稳定性。我们寻求形式为 $u_j^n = g^n e^{ikx_j}$ 的解，其中 $g$ 是放大因子，$k$ 是波数。将此代入格式中：\n$$\ng = 1 - \\frac{\\lambda}{2}(e^{ik\\Delta x} - e^{-ik\\Delta x}) + \\mu(e^{ik\\Delta x} - 2 + e^{-ik\\Delta x})\n$$\n使用欧拉公式，并令 $\\theta = k\\Delta x$，我们有 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} + e^{-i\\theta} - 2 = 2\\cos\\theta - 2 = -4\\sin^2(\\theta/2)$。\n$$\ng(\\theta) = 1 - i\\lambda\\sin\\theta - 4\\mu\\sin^2(\\frac{\\theta}{2})\n$$\n稳定性条件为对所有 $\\theta \\in [-\\pi, \\pi]$，都有 $|g| \\le 1$。\n$$\n|g|^2 = \\left(1 - 4\\mu\\sin^2(\\frac{\\theta}{2})\\right)^2 + (-\\lambda\\sin\\theta)^2 \\le 1\n$$\n$$\n1 - 8\\mu\\sin^2(\\frac{\\theta}{2}) + 16\\mu^2\\sin^4(\\frac{\\theta}{2}) + \\lambda^2\\sin^2\\theta \\le 1\n$$\n使用 $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$，我们得到：\n$$\n-8\\mu\\sin^2(\\frac{\\theta}{2}) + 16\\mu^2\\sin^4(\\frac{\\theta}{2}) + 4\\lambda^2\\sin^2(\\frac{\\theta}{2})\\cos^2(\\frac{\\theta}{2}) \\le 0\n$$\n对于 $\\theta \\neq 0$，我们可以除以 $4\\sin^2(\\theta/2)  0$：\n$$\n-2\\mu + 4\\mu^2\\sin^2(\\frac{\\theta}{2}) + \\lambda^2\\cos^2(\\frac{\\theta}{2}) \\le 0\n$$\n由于 $\\cos^2(\\theta/2) = 1 - \\sin^2(\\theta/2)$，该不等式变为：\n$$\n\\lambda^2 - 2\\mu + (4\\mu^2 - \\lambda^2)\\sin^2(\\frac{\\theta}{2}) \\le 0\n$$\n此不等式必须对所有 $\\sin^2(\\theta/2) \\in [0, 1]$ 成立。我们检查端点处的情况。\n在 $\\sin^2(\\theta/2) = 0$（即 $\\theta=0$）时：$\\lambda^2 - 2\\mu \\le 0 \\implies \\lambda^2 \\le 2\\mu$。\n在 $\\sin^2(\\theta/2) = 1$（即 $\\theta=\\pi$）时：$\\lambda^2 - 2\\mu + 4\\mu^2 - \\lambda^2 \\le 0 \\implies 4\\mu^2 - 2\\mu \\le 0 \\implies 2\\mu(2\\mu - 1) \\le 0$。由于 $\\mu = \\epsilon\\Delta t/\\Delta x^2 \\ge 0$，这意味着 $2\\mu - 1 \\le 0$，即 $\\mu \\le 1/2$。\n因此，稳定性要求为 $\\lambda^2 \\le 2\\mu$ 和 $\\mu \\le 1/2$。\n\n第三，我们将总变差递减（TVD）要求映射到单调性约束。线性格式为TVD的一个充分条件是它是单调的，这意味着其显式更新形式中的所有系数都是非负的。我们重写该格式以确定这些系数：\n$$\nu_{j}^{n+1} = \\left(\\mu + \\frac{\\lambda}{2}\\right)u_{j-1}^{n} + (1 - 2\\mu)u_{j}^{n} + \\left(\\mu - \\frac{\\lambda}{2}\\right)u_{j+1}^{n}\n$$\n系数分别为 $C_{j-1} = \\mu + \\lambda/2$, $C_j = 1 - 2\\mu$ 和 $C_{j+1} = \\mu - \\lambda/2$。为满足单调性，所有系数必须为非负。\n1. $C_j = 1 - 2\\mu \\ge 0 \\implies \\mu \\le 1/2$。\n2. 另外两个系数取决于 $\\lambda = a\\Delta t/\\Delta x$ 的符号。\n   情况 $a \\ge 0$ ($\\lambda \\ge 0$)：由于 $\\mu, \\lambda \\ge 0$，$C_{j-1} = \\mu + \\lambda/2 \\ge 0$ 恒成立。$C_{j+1} = \\mu - \\lambda/2 \\ge 0 \\implies \\lambda \\le 2\\mu$。\n   情况 $a  0$ ($\\lambda  0$)：$C_{j-1} = \\mu + \\lambda/2 \\ge 0 \\implies \\mu \\ge -\\lambda/2 \\implies \\mu \\ge |\\lambda|/2 \\implies |\\lambda| \\le 2\\mu$。$C_{j+1} = \\mu - \\lambda/2 = \\mu + |\\lambda|/2 \\ge 0$ 恒成立。\n在两种情况下，单调性（并因此是TVD）的条件都是：\n$$\n|\\lambda| \\le 2\\mu \\quad \\text{and} \\quad \\mu \\le \\frac{1}{2}\n$$\n注意，TVD条件 $|\\lambda| \\le 2\\mu$ 比稳定性条件 $\\lambda^2 \\le 2\\mu$ 更严格，因为对前者平方得到 $\\lambda^2 \\le 4\\mu^2$，又因为 $\\mu \\le 1/2$，所以 $4\\mu^2 = 2\\mu(2\\mu) \\le 2\\mu(1) = 2\\mu$。\n\n第四，我们从这些TVD不等式中确定最小人工粘性 $\\epsilon$。第一个不等式是 $|\\lambda| \\le 2\\mu$。代入 $\\lambda$ 和 $\\mu$ 的定义：\n$$\n\\left|\\frac{a\\,\\Delta t}{\\Delta x}\\right| \\le 2\\left(\\frac{\\epsilon\\,\\Delta t}{\\Delta x^{2}}\\right)\n$$\n假设 $\\Delta t  0$ 且 $\\Delta x  0$，我们可以化简：\n$$\n\\frac{|a|}{\\Delta x} \\le \\frac{2\\epsilon}{\\Delta x^2} \\implies |a|\\Delta x \\le 2\\epsilon\n$$\n这给出了人工粘性系数的一个下界：\n$$\n\\epsilon \\ge \\frac{|a|\\Delta x}{2}\n$$\n因此，能满足此条件的最小人工粘性为 $\\epsilon_{\\min} = \\frac{|a|\\Delta x}{2}$。为了使这一选择能保证TVD，第二个条件 $\\mu \\le 1/2$ 也必须能被满足。代入 $\\epsilon = \\epsilon_{\\min}$：\n$$\n\\mu = \\frac{\\epsilon_{\\min}\\Delta t}{\\Delta x^2} = \\frac{(|a|\\Delta x/2)\\Delta t}{\\Delta x^2} = \\frac{|a|\\Delta t}{2\\Delta x} = \\frac{|\\lambda|}{2}\n$$\n条件 $\\mu \\le 1/2$ 变为 $|\\lambda|/2 \\le 1/2$，化简为 $|\\lambda| \\le 1$。这是平流格式的标准 Courant-Friedrichs-Lewy (CFL) 条件。因此，只有当时间步长的选择满足 $|\\lambda| = |a|\\Delta t / \\Delta x \\le 1$ 时，TVD格式才可能实现。假设该格式在此条件下运行，强制实现TVD行为所需的最小人工粘性由第一个条件中的等式给出。当网格加密时，由于 $\\epsilon \\propto \\Delta x$ 意味着当 $\\Delta x \\to 0$ 时 $\\epsilon \\to 0$，所以这个 $\\epsilon$ 的选择与原始平流方程是一致的。\n\n因此，最小人工粘性 $\\epsilon$ 用 $a$ 和 $\\Delta x$ 表示为：\n$$\n\\epsilon_{\\min} = \\frac{|a|\\Delta x}{2}\n$$",
            "answer": "$$\n\\boxed{\\frac{|a|\\Delta x}{2}}\n$$"
        },
        {
            "introduction": "一个理想的人工粘性应该只在需要的地方（如激波）起作用，而在其他地方（如涡旋或剪切流）保持静默，以避免不必要的能量耗散。本练习将引导您设计一个“智能”粘性开关，这是现代光滑粒子流体动力学(SPH)方法中的一项关键技术。您将根据物理原则，构建一个能够区分压缩流和旋转流的开关函数，并计算其在特定流场中的效果，从而掌握如何使人工粘性更具物理洞察力 。",
            "id": "3465306",
            "problem": "在宇宙学中的光滑粒子流体动力学 (SPH) 中，引入人工粘性是为了捕捉激波，同时避免在涡旋或剪切主导的流中产生伪耗散。一个常见的策略是通过一个开关因子来调节人工粘性系数，该因子在涡度主导压缩的区域抑制粘性。考虑一个开关函数 $f$ 乘以一个基础人工粘性系数 $\\alpha$，使得有效系数为 $f \\alpha$。开关 $f$ 应满足以下从第一性原理和量纲分析中得出的原则：\n\n- 它仅依赖于区分压缩和旋转的运动学不变量，即散度大小 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 和涡度大小 $\\left|\\nabla \\times \\mathbf{v}\\right|$。\n- 它是无量纲的，界于 $0$ 和 $1$ 之间，在固定的 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 下随 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 单调递增，在固定的 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 下随 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 单调递减。\n- 它通过包含一个由局部信号速度 $c$ 和光滑长度 $h$ 构成的正则化项以及一个小的无量纲参数 $\\epsilon0$ 来在静态流中保持良定义，使得该组合项与 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 和 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 具有相同的量纲。\n\n(a) 利用这些要求，构造出 $f$ 的最简容许形式，该形式由容许不变量的非负线性贡献构成，并遵守所述的单调性、有界性和量纲约束。\n\n(b) 对于一个宇宙学 SPH 计算中的局部涡旋流，其中 $\\left|\\nabla \\cdot \\mathbf{v}\\right|=0.01$，$\\left|\\nabla \\times \\mathbf{v}\\right|=10$，$c=1$，$h=0.05$，$\\epsilon=0.1$，以及基础系数 $\\alpha=1$，计算开关 $f$ 和有效人工粘性系数 $f\\alpha$。\n\n将您的 $f$ 和 $f\\alpha$ 的数值结果四舍五入到四位有效数字。按顺序 $\\left(f, f\\alpha\\right)$ 将您的最终答案报告为两个没有单位的数字。",
            "solution": "用户提供了一个问题，要求基于一套物理原则推导用于光滑粒子流体动力学 (SPH) 中人工粘性的开关函数，并进行数值评估。\n\n### 步骤 1：问题验证\n\n首先，我必须验证问题陈述。\n\n#### 1.1. 提取已知条件\n\n- **背景**：宇宙学 SPH 中的人工粘性。\n- **目标**：用一个开关函数 $f$ 调节基础人工粘性系数 $\\alpha$，得到有效系数 $f\\alpha$。\n- **构造 $f$ 的原则**：\n    1.  $f$ 仅依赖于散度大小 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 和涡度大小 $\\left|\\nabla \\times \\mathbf{v}\\right|$。\n    2.  $f$ 是无量纲且有界的，使得 $0 \\le f \\le 1$。\n    3.  $f$ 表现出特定的单调性：它随 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$（在 $\\left|\\nabla \\times \\mathbf{v}\\right|$ 固定时）增加，并随 $\\left|\\nabla \\times \\mathbf{v}\\right|$（在 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 固定时）减少。\n    4.  $f$ 被正则化以在静态流中保持良定义。正则化项由局部信号速度 $c$、光滑长度 $h$ 和一个小的无量纲参数 $\\epsilon  0$ 构成。该项必须与 $\\left|\\nabla \\cdot \\mathbf{v}\\right|$ 具有相同的量纲。\n    5. $f$ 的形式应为由容许不变量的“非负线性贡献”构成的“最简容许形式”。\n- **(a) 部分任务**：构造 $f$ 的数学形式。\n- **(b) 部分任务**：使用以下数值计算 $f$ 和 $f\\alpha$：\n    - $\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$\n    - $\\left|\\nabla \\times \\mathbf{v}\\right| = 10$\n    - $c = 1$\n    - $h = 0.05$\n    - $\\epsilon = 0.1$\n    - $\\alpha = 1$\n- **输出要求**：将数值结果四舍五入到四位有效数字，并以有序对 $(f, f\\alpha)$ 的形式报告。\n\n#### 1.2. 根据标准进行验证\n\n- **科学依据**：该问题在计算流体力学和天体物理学领域有坚实的基础。人工粘性的使用，特别是基于散度与涡度之比来抑制其在剪切流中的开关，是 SPH 中一种标准且有据可查的技术（例如，Balsara 开关）。所述原则在物理上和数学上都是合理的。\n- **适定性**：该问题是适定的。(a) 部分要求基于一组明确的约束推导一个函数形式。“最简形式”是此类推导中的标准启发式方法，并导向一个特定的、常用的函数。(b) 部分是使用推导出的公式进行直接的数值计算。存在唯一解。\n- **客观性**：问题以精确、客观的语言陈述，没有歧义或主观论断。\n- **缺陷检查**：该问题不违反任何不合格的缺陷。它不是科学上不合理的，是可形式化的，是完整的，提出了一个现实可行的任务，结构良好，并且不是琐碎或同义反复的。\n\n#### 1.3. 结论\n\n问题有效。我现在将进行求解。\n\n### 步骤 2：解题推导\n\n#### (a) 部分：开关函数 $f$ 的构造\n\n令散度大小为 $D = \\left|\\nabla \\cdot \\mathbf{v}\\right|$，涡度大小为 $W = \\left|\\nabla \\times \\mathbf{v}\\right|$。在流体力学中，$D$ 和 $W$ 的量纲都是时间的倒数，$[T^{-1}]$。\n\n1.  **量纲性**：函数 $f$ 必须是无量纲的。这要求它是一个由输入量的无量纲组合构成的函数。从 $D$ 和 $W$ 构造无量纲量的最简单方法是取它们的比值，或者具有相同量纲的表达式的比值。\n\n2.  **单调性**：函数 $f$ 必须随 $D$ 增加而随 $W$ 减少。这表明 $D$ 应该在分子中，$W$ 应该在分母中。让我们考虑一个通用形式 $f = g\\left(\\frac{D}{W}\\right)$，其中 $g$ 是某个函数。为了满足单调性，$g$ 必须是其参数的增函数。\n\n3.  **简明性和有界性**：问题要求“由非负线性贡献构成的最简容许形式”。这表明它是一个有理函数，其分子和分母是可用项的线性总和。我们提出一个形式：\n    $$f = \\frac{k_1 D}{k_2 D + k_3 W}$$\n    其中 $k_1, k_2, k_3$ 是正的无量纲常数。这个形式是无量纲的。\n    - 为了满足有界性条件 $f \\le 1$，我们要求 $k_1 D \\le k_2 D + k_3 W$。重新排列得到 $(k_1 - k_2)D \\le k_3 W$。为了让此式对所有非负的 $D$ 和 $W$ 成立，最简单的选择是设置 $k_1 = k_2$。\n    - “最简”形式和“非负线性贡献”的要求意味着我们应该选择尽可能简单的常数，例如 $1$。设置 $k_1 = k_2 = k_3 = 1$ 得到以下形式：\n    $$f = \\frac{D}{D+W} = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right|}$$\n    对于非负的 $D$ 和 $W$，此形式界于 $0$ 和 $1$ 之间，并满足单调性要求。\n\n4.  **正则化**：如果 $D$ 和 $W$ 均为零，则上述形式未定义。问题要求一个正则化项来防止这种情况。这个项，我们称之为 $R$，必须与 $D$ 和 $W$ 具有相同的量纲，即 $[T^{-1}]$。它由信号速度 $c$（量纲 $[L T^{-1}]$）、光滑长度 $h$（量纲 $[L]$）和无量纲参数 $\\epsilon  0$ 构成。$c$ 和 $h$ 的唯一能产生 $[T^{-1}]$ 量纲的组合是 $c/h$。因此，正则化项与此成正比，例如 $R = \\epsilon \\frac{c}{h}$。\n    为了将此正则化项纳入我们的“最简线性贡献”形式中，我们将其添加到分母中以防止除以零。这保持了函数的结构及其无量纲性质。\n\n综合这些原则，开关函数 $f$ 的最简容许形式是：\n$$f = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right| + \\epsilon \\frac{c}{h}}$$\n此形式满足所有陈述的条件：它依赖于正确的不变量，是无量纲的，界于 $0$ 和 $1$ 之间，具有正确的单调行为，并且对静态流进行了正则化。\n\n#### (b) 部分：数值计算\n\n给定以下值：\n- $\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$\n- $\\left|\\nabla \\times \\mathbf{v}\\right| = 10$\n- $c = 1$\n- $h = 0.05$\n- $\\epsilon = 0.1$\n- $\\alpha = 1$\n\n首先，计算正则化项 $R = \\epsilon \\frac{c}{h}$：\n$$R = (0.1) \\frac{1}{0.05} = 0.1 \\times 20 = 2$$\n\n现在，将这些值代入推导出的开关函数 $f$ 的表达式中：\n$$f = \\frac{\\left|\\nabla \\cdot \\mathbf{v}\\right|}{\\left|\\nabla \\cdot \\mathbf{v}\\right| + \\left|\\nabla \\times \\mathbf{v}\\right| + R} = \\frac{0.01}{0.01 + 10 + 2} = \\frac{0.01}{12.01}$$\n$$f \\approx 0.000832639467...$$\n四舍五入到四位有效数字，我们得到：\n$$f \\approx 0.0008326$$\n\n接下来，我们计算有效人工粘性系数 $f\\alpha$。由于基础系数 $\\alpha = 1$，有效系数在数值上等于 $f$：\n$$f\\alpha = (0.0008326) \\times 1 = 0.0008326$$\n\n问题要求两个数 $(f, f\\alpha)$。这两个值为 $(0.0008326, 0.0008326)$。开关函数的这个极低的值是预期的，因为与压缩（$\\left|\\nabla \\cdot \\mathbf{v}\\right| = 0.01$）相比，流动被涡度（$\\left|\\nabla \\times \\mathbf{v}\\right| = 10$）强烈主导，这正是应该抑制人工粘性的情况。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.0008326  0.0008326 \\end{pmatrix} } $$"
        },
        {
            "introduction": "理论和设计最终要落实到实际的代码校准中。本练习将您置于计算天体物理学家的角色，面对一个经典的测试问题：赛道夫-泰勒(Sedov-Taylor)爆炸波。您的任务是推导并实现一个算法，该算法将抽象的冯·诺依曼-里希特迈耶(von Neumann–Richtmyer)人工粘性系数与一个可观测的数值结果——激波在网格单元中的厚度——联系起来。通过这个实践，您将学会如何校准人工粘性参数，以在真实的模拟中精确控制激波的数值形态 。",
            "id": "3504909",
            "problem": "考虑一个在一维球对称均匀介质中的 Sedov-Taylor 冲击波，介质的静止质量密度为 $\\rho_0$，绝热指数为 $\\gamma$。其无粘动力学由可压缩流的欧拉方程以及 Rankine–Hugoniot 激波跳跃条件决定。在强激波极限下，激波半径遵循自相似标度律 $R_s(t) \\propto t^{2/5}$，激波速度 $U_s(t) = \\mathrm{d}R_s/\\mathrm{d}t \\propto t^{-3/5}$。激波后声速 $c_{s,2}$ 与激波速度 $U_s$ 的比值是一个仅依赖于 $\\gamma$ 的常数。将该比值定义为 $\\kappa \\equiv c_{s,2}/U_s$。\n\n为了在数值上捕捉激波同时保持自相似标度，许多格式使用人工粘性 (AV)。一种标准形式是 von Neumann–Richtmyer 人工粘性，它通过以下公式来增强压力项\n$$\nq = \\rho\\left(\\beta\\, \\ell^2 (\\nabla\\cdot \\mathbf{u})^2 + \\alpha\\, c_s\\, \\ell\\, \\lvert \\nabla\\cdot \\mathbf{u}\\rvert\\right),\n$$\n其中 $\\rho$ 是密度，$\\mathbf{u}$ 是速度， $c_s$ 是当地声速，$\\ell$ 是一个特征数值长度 (取 $\\ell = \\Delta x$)，$\\alpha$ 和 $\\beta$ 是无量纲的人工粘性系数。目标是将激波展宽到一个厚度 $\\delta$，该厚度约为 $N$ 个网格单元，即 $\\delta \\approx N \\Delta x$，同时保持自相似标度。\n\n从欧拉方程和强激波极限下的 Rankine–Hugoniot 条件出发，基于第一性原理：\n1) 推导激波后声速 $c_{s,2}$ (用激波速度 $U_s$ 和绝热指数 $\\gamma$ 表示)，并由此证明 $\\kappa \\equiv c_{s,2}/U_s$ 是一个仅依赖于 $\\gamma$ 的常数。\n2) 通过平衡人工粘性引起的应力与穿过激波层的惯性动量通量，推导一个关于无量纲激波厚度 $x \\equiv \\delta/\\ell$ 的方程，其形式为\n$$\n\\beta \\left(\\frac{\\ell}{\\delta}\\right)^2 + \\alpha \\kappa \\left(\\frac{\\ell}{\\delta}\\right) = 1,\n$$\n并证明指定 $x = N$ 意味着 $\\beta$、$\\alpha$、$N$ 和 $\\kappa$ 之间存在一个关系。\n3) 求解步骤2中的关系式，得到用 $\\alpha$、$N$ 和 $\\kappa$ 表示的 $\\beta$，条件是 $\\beta \\ge 0$ 以满足物理可容许性和自相似性（这要求 $x$ 不随时间变化）。对于给定的 $N$ 和 $\\gamma$，明确指出确保 $\\beta \\ge 0$ 时对 $\\alpha$ 的约束。\n4) 提供一个算法，对于给定的 $(\\gamma, \\alpha, N)$，该算法计算 $\\kappa(\\gamma)$、计算 $\\beta$，并通过求解 $x$ 的二次关系式来独立验证所蕴含的厚度 $x$，而无需先验地假设 $x=N$。使用 $\\ell = \\Delta x$，因此 $x = \\delta/\\Delta x$。\n\n您的程序必须实现步骤4中的算法，并在以下测试套件上进行评估。输出中的所有量都是无量纲的，因此不需要物理单位。\n- 测试用例 1 (纯二次人工粘性): $\\gamma = 5/3$, $\\alpha = 0$, $N = 3$。\n- 测试用例 2 (实现 $x=N$ 的纯线性人工粘性): $\\gamma = 5/3$, $N = 4$，并选择 $\\alpha = N/\\kappa(\\gamma)$ 以使 $\\beta = 0$。\n- 测试用例 3 (混合人工粘性): $\\gamma = 1.4$, $\\alpha = 1.0$, $N = 6$。\n- 测试用例 4 (近边界混合人工粘性): $\\gamma = 5/3$, 选择 $\\alpha = 0.95\\, N/\\kappa(\\gamma)$ 且 $N=3$。\n\n对于每个测试用例，您的程序必须按顺序输出两个值：\n- 根据您推导的公式计算出的 $\\beta$。\n- 通过求解无量纲厚度的二次关系式独立验证得到的 $x$，即直接从步骤2的关系式中求解 $x = \\delta/\\Delta x$ 而不假设 $x=N$。\n\n最终输出格式：您的程序应生成单行输出，包含四个测试用例的八个浮点数结果，按如下顺序排列\n$$\n[\\beta_1, x_1, \\beta_2, x_2, \\beta_3, x_3, \\beta_4, x_4],\n$$\n四舍五入到六位小数，用逗号分隔，并用方括号括起来 (例如, \"[1.000000,3.000000,0.000000,4.000000, ...]\")。",
            "solution": "该问题是有效的，因为它科学地基于流体动力学和计算天体物理学的原理，问题定义良好、客观且内部一致。我们逐步进行推导和求解。\n\n### 步骤 1：推导激波后声速比 $\\kappa$\n\n我们使用激波静止坐标系中的 Rankine-Hugoniot 跳跃条件来分析一维强激波。设激波前（上游）状态由下标 $1$ 表示，激波后（下游）状态由下标 $2$ 表示。\n\n给定的条件是：\n- 激波前密度: $\\rho_1 = \\rho_0$\n- 激波前速度: $u_1 = U_s$ (介质进入激波的速度)\n- 强激波极限: 激波前压力 $P_1 \\to 0$ 和比内能 $e_1 \\to 0$。\n\n质量、动量和能量守恒的 Rankine-Hugoniot 条件如下：\n1.  质量: $\\rho_1 u_1 = \\rho_2 u_2$\n    $$ \\rho_0 U_s = \\rho_2 u_2 $$\n2.  动量: $P_1 + \\rho_1 u_1^2 = P_2 + \\rho_2 u_2^2$\n    $$ \\rho_0 U_s^2 = P_2 + \\rho_2 u_2^2 $$\n3.  能量: $e_1 + \\frac{P_1}{\\rho_1} + \\frac{1}{2}u_1^2 = e_2 + \\frac{P_2}{\\rho_2} + \\frac{1}{2}u_2^2$，其中对于理想气体 $e = \\frac{P}{(\\gamma-1)\\rho}$。\n    $$ \\frac{1}{2}U_s^2 = \\frac{P_2}{(\\gamma-1)\\rho_2} + \\frac{P_2}{\\rho_2} + \\frac{1}{2}u_2^2 = \\frac{\\gamma P_2}{(\\gamma-1)\\rho_2} + \\frac{1}{2}u_2^2 $$\n\n从质量守恒方程，我们得到 $u_2 = (\\rho_0/\\rho_2) U_s$。将此代入动量方程：\n$$ P_2 = \\rho_0 U_s^2 - \\rho_2 \\left(\\frac{\\rho_0}{\\rho_2} U_s\\right)^2 = \\rho_0 U_s^2 \\left(1 - \\frac{\\rho_0}{\\rho_2}\\right) $$\n现在，将 $u_2$ 和 $P_2$ 的表达式代入能量方程：\n$$ \\frac{1}{2}U_s^2 = \\frac{\\gamma}{(\\gamma-1)\\rho_2} \\left[\\rho_0 U_s^2 \\left(1 - \\frac{\\rho_0}{\\rho_2}\\right)\\right] + \\frac{1}{2}\\left(\\frac{\\rho_0}{\\rho_2} U_s\\right)^2 $$\n两边同除以 $U_s^2$，并令 $\\xi = \\rho_0/\\rho_2$ 为压缩比的倒数：\n$$ \\frac{1}{2} = \\frac{\\gamma}{\\gamma-1} \\frac{\\rho_0}{\\rho_2} - \\frac{\\gamma}{\\gamma-1} \\left(\\frac{\\rho_0}{\\rho_2}\\right)^2 + \\frac{1}{2}\\left(\\frac{\\rho_0}{\\rho_2}\\right)^2 $$\n$$ \\frac{1}{2} = \\frac{\\gamma}{\\gamma-1} \\xi - \\left(\\frac{\\gamma}{\\gamma-1} - \\frac{1}{2}\\right)\\xi^2 = \\frac{\\gamma}{\\gamma-1} \\xi - \\frac{\\gamma+1}{2(\\gamma-1)} \\xi^2 $$\n两边同乘以 $2(\\gamma-1)$，得到关于 $\\xi$ 的二次方程：\n$$ \\gamma-1 = 2\\gamma \\xi - (\\gamma+1)\\xi^2 \\implies (\\gamma+1)\\xi^2 - 2\\gamma\\xi + (\\gamma-1) = 0 $$\n解为 $\\xi=1$（平凡的无激波情况）和 $\\xi = \\frac{\\gamma-1}{\\gamma+1}$。因此，压缩比为 $\\rho_2/\\rho_0 = \\frac{\\gamma+1}{\\gamma-1}$。\n\n现在我们求激波后压力 $P_2$：\n$$ P_2 = \\rho_0 U_s^2 (1 - \\xi) = \\rho_0 U_s^2 \\left(1 - \\frac{\\gamma-1}{\\gamma+1}\\right) = \\frac{2\\rho_0 U_s^2}{\\gamma+1} $$\n激波后声速 $c_{s,2}$ 由 $c_{s,2}^2 = \\gamma P_2 / \\rho_2$ 给出：\n$$ c_{s,2}^2 = \\gamma \\frac{P_2}{\\rho_2} = \\gamma \\frac{2\\rho_0 U_s^2 / (\\gamma+1)}{ \\rho_0 (\\gamma+1)/(\\gamma-1)} = \\frac{2\\gamma(\\gamma-1)}{(\\gamma+1)^2} U_s^2 $$\n取平方根得到激波后声速：\n$$ c_{s,2} = U_s \\frac{\\sqrt{2\\gamma(\\gamma-1)}}{\\gamma+1} $$\n因此，比值 $\\kappa$ 为：\n$$ \\kappa \\equiv \\frac{c_{s,2}}{U_s} = \\frac{\\sqrt{2\\gamma(\\gamma-1)}}{\\gamma+1} $$\n此表达式仅依赖于绝热指数 $\\gamma$，因此对于给定的介质，$\\kappa$ 是一个常数。\n\n### 步骤 2：推导激波厚度方程\n\nvon Neumann-Richtmyer 人工粘性 (AV) 在压力项上增加了一个项 $q$ 来模拟激波耗散。问题要求我们通过平衡人工粘性引起的应力与惯性动量通量来推导一个关系式。\n\n上游气体的惯性动量通量是冲压 $\\rho_0 U_s^2$。我们假设最大人工粘性应力 $q_{max}$ 必须与此同量级才能阻止来流：\n$$ q_{max} \\approx \\rho_0 U_s^2 $$\n人工粘性应力由下式给出：\n$$ q = \\rho\\left(\\beta\\, \\ell^2 (\\nabla\\cdot \\mathbf{u})^2 + \\alpha\\, c_s\\, \\ell\\, \\lvert \\nabla\\cdot \\mathbf{u}\\rvert\\right) $$\n为了在厚度为 $\\delta$ 的激波层内评估 $q$，我们做以下标度近似：\n- 穿过激波的速度梯度量级为激波速度除以激波厚度：$|\\nabla \\cdot \\mathbf{u}| \\approx U_s/\\delta$。\n- 耗散区域内的特征声速是激波后声速：$c_s \\approx c_{s,2} = \\kappa U_s$。\n- AV 公式中的密度因子 $\\rho$ 通常基于数值便利性和稳定性来选择。为了得到所需的关系式，我们选择激波前的密度 $\\rho_0$。\n\n将这些近似值代入 $q$ 的表达式中：\n$$ q \\approx \\rho_0 \\left( \\beta \\ell^2 \\left(\\frac{U_s}{\\delta}\\right)^2 + \\alpha (\\kappa U_s) \\ell \\left(\\frac{U_s}{\\delta}\\right) \\right) $$\n$$ q \\approx \\rho_0 U_s^2 \\left( \\beta \\left(\\frac{\\ell}{\\delta}\\right)^2 + \\alpha \\kappa \\left(\\frac{\\ell}{\\delta}\\right) \\right) $$\n将其与冲压 $\\rho_0 U_s^2$ 相等：\n$$ \\rho_0 U_s^2 \\approx \\rho_0 U_s^2 \\left( \\beta \\left(\\frac{\\ell}{\\delta}\\right)^2 + \\alpha \\kappa \\left(\\frac{\\ell}{\\delta}\\right) \\right) $$\n这简化为所需的关系式：\n$$ \\beta \\left(\\frac{\\ell}{\\delta}\\right)^2 + \\alpha \\kappa \\left(\\frac{\\ell}{\\delta}\\right) = 1 $$\n根据无量纲激波厚度 $x \\equiv \\delta/\\ell$ 的定义，该关系式变为 $\\beta(1/x)^2 + \\alpha\\kappa(1/x) = 1$。如果我们规定激波厚度跨越 $N$ 个网格单元，即 $x = N$，我们就得到了人工粘性系数和物理参数之间的一个关系：\n$$ \\beta \\left(\\frac{1}{N}\\right)^2 + \\alpha \\kappa \\left(\\frac{1}{N}\\right) = 1 $$\n\n### 步骤 3：$\\beta$ 的表达式和物理约束\n\n我们从步骤 2 的关系式中解出 $\\beta$：\n$$ \\frac{\\beta}{N^2} + \\frac{\\alpha \\kappa}{N} = 1 \\implies \\frac{\\beta}{N^2} = 1 - \\frac{\\alpha \\kappa}{N} $$\n$$ \\beta = N^2 \\left(1 - \\frac{\\alpha \\kappa}{N}\\right) = N^2 - N \\alpha \\kappa $$\n为了使 $\\beta$ 在物理上是可容许的（代表一个耗散过程，而非反耗散过程），我们必须有 $\\beta \\ge 0$。这对 $\\alpha$ 施加了一个约束：\n$$ N^2 - N \\alpha \\kappa \\ge 0 $$\n因为 $N  0$，我们可以两边同除以 $N$：\n$$ N - \\alpha \\kappa \\ge 0 \\implies N \\ge \\alpha \\kappa $$\n因此，对线性粘性系数 $\\alpha$ 的约束是：\n$$ \\alpha \\le \\frac{N}{\\kappa} $$\n\n### 步骤 4：计算 $\\beta$ 和验证 $x$ 的算法\n\n对于给定的参数集 $(\\gamma, \\alpha, N)$，算法按以下步骤进行：\n1.  **计算 $\\kappa$**：使用步骤1中推导的公式：\n    $$ \\kappa(\\gamma) = \\frac{\\sqrt{2\\gamma(\\gamma-1)}}{\\gamma+1} $$\n2.  **计算 $\\beta$**：使用步骤3中推导的公式：\n    $$ \\beta(\\alpha, N, \\kappa) = N^2 - N \\alpha \\kappa $$\n3.  **验证厚度 $x$**：求解步骤2中的二次关系式以得到 $x$，而不假设 $x=N$。令 $y = 1/x$。方程为：\n    $$ \\beta y^2 + (\\alpha\\kappa) y - 1 = 0 $$\n    这是一个关于 $y$ 的二次方程。\n    - 如果 $\\beta \\approx 0$，方程是线性的：$(\\alpha \\kappa) y - 1 = 0$，所以 $y = 1/(\\alpha\\kappa)$，这给出 $x = \\alpha\\kappa$。\n    - 如果 $\\beta  0$，我们使用二次公式求解 $y$。因为 $x$ 必须是正的物理厚度，所以 $y=1/x$ 也必须是正的。\n    $$ y = \\frac{-(\\alpha\\kappa) \\pm \\sqrt{(\\alpha\\kappa)^2 - 4(\\beta)(-1)}}{2\\beta} = \\frac{-\\alpha\\kappa \\pm \\sqrt{(\\alpha\\kappa)^2 + 4\\beta}}{2\\beta} $$\n    由于 $\\beta \\ge 0$，平方根下的项是非负的。为确保 $y  0$，我们必须选择正根：\n    $$ y = \\frac{-\\alpha\\kappa + \\sqrt{(\\alpha\\kappa)^2 + 4\\beta}}{2\\beta} $$\n    独立验证的厚度即为 $x = 1/y$。作为自洽性检查，将 $\\beta$ 的表达式代入这个 $y$ 的公式中，可以恢复出 $y=1/N$，从而 $x=N$（前提是 $\\beta0$）。这个“验证”步骤证实了我们推导的代数一致性。\n\n这就构成了需要实现的完整算法。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements an algorithm to compute artificial viscosity parameters for a\n    Sedov-Taylor blast wave and verifies the resulting shock thickness.\n    \"\"\"\n    \n    # Define test cases: (type, gamma, alpha_parameter, N)\n    # 'const_alpha': alpha_parameter is the value of alpha.\n    # 'beta_zero': alpha is calculated as N/kappa to make beta=0.\n    # 'scaled_alpha': alpha is calculated as alpha_parameter * N/kappa.\n    test_cases = [\n        ('const_alpha', 5/3, 0.0, 3),  # Test case 1\n        ('beta_zero', 5/3, None, 4),   # Test case 2\n        ('const_alpha', 1.4, 1.0, 6),  # Test case 3\n        ('scaled_alpha', 5/3, 0.95, 3) # Test case 4\n    ]\n\n    results = []\n\n    for case_type, gamma, alpha_param, N in test_cases:\n        # Step 1: Compute kappa(gamma)\n        # kappa = c_{s,2} / U_s\n        kappa = np.sqrt(2 * gamma * (gamma - 1)) / (gamma + 1)\n\n        # Step 2: Determine alpha and compute beta\n        alpha = 0.0\n        if case_type == 'const_alpha':\n            alpha = alpha_param\n        elif case_type == 'beta_zero':\n            #\n            # Set alpha such that beta = 0.\n            # beta = N^2 - N * alpha * kappa = 0  =>  alpha = N / kappa\n            #\n            alpha = N / kappa\n        elif case_type == 'scaled_alpha':\n            #\n            # Set alpha as a scaling factor of the beta=0 case.\n            # alpha = scaling_factor * (N / kappa)\n            #\n            alpha = alpha_param * N / kappa\n        \n        # beta = N^2 - N * alpha * kappa\n        beta = N**2 - N * alpha * kappa\n\n        # Step 3: Independently verify the nondimensional thickness x\n        # This is done by solving beta * (1/x)^2 + alpha*kappa * (1/x) - 1 = 0 for x.\n        ak = alpha * kappa\n        x = 0.0\n\n        # Handle the case where beta is numerically close to zero (linear equation for 1/x)\n        if np.isclose(beta, 0.0):\n            # The relation becomes alpha*kappa * (1/x) = 1 => x = alpha*kappa\n            # Note that for this case, N = alpha*kappa by definition of alpha.\n            if np.isclose(ak, 0.0): # Should not happen in these test cases\n                x = np.inf\n            else:\n                x = ak\n        else: # Standard quadratic case for 1/x\n            # Let y = 1/x. Equation is beta*y^2 + ak*y - 1 = 0\n            # Physical solution (y > 0) requires the positive root.\n            discriminant = ak**2 + 4 * beta\n            \n            # Since beta is guaranteed to be >= 0 by the problem setup\n            # for physically meaningful shocks, discriminant is non-negative.\n            sqrt_discriminant = np.sqrt(discriminant)\n            \n            # y = (-ak + sqrt(discriminant)) / (2*beta)\n            y = (-ak + sqrt_discriminant) / (2 * beta)\n\n            if np.isclose(y, 0.0):\n                x = np.inf\n            else:\n                x = 1.0 / y\n        \n        results.extend([beta, x])\n\n    # Print results in the specified format, rounded to 6 decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}