{
    "hands_on_practices": [
        {
            "introduction": "Before building a numerical solver for the Euler equations, we must first understand their fundamental mathematical structure. This foundational exercise guides you through the characteristic analysis of the 1D Euler equations, a crucial step in deriving Godunov-type methods . By computing the system's eigenvalues and eigenvectors, you will directly connect abstract mathematical objects to the physical waves—sound waves and contact discontinuities—that carry information through the fluid.",
            "id": "3513199",
            "problem": "Consider the one-dimensional Euler equations for an inviscid, compressible, ideal gas, written in conservative form for mass, momentum, and energy. Introduce the primitive variable vector $W = (\\rho, u, p)^{\\top}$, where $\\rho$ is the mass density, $u$ is the fluid velocity, and $p$ is the gas pressure. Assume the gas is thermally and calorically perfect with adiabatic index $\\gamma > 1$. In the context of Godunov-type finite-volume methods for hyperbolic conservation laws, the local characteristic structure of the quasi-linear primitive-variable form\n$$\n\\frac{\\partial W}{\\partial t} + B(W)\\,\\frac{\\partial W}{\\partial x} = 0\n$$\ngoverns the wave families arising in the Riemann problem at cell interfaces.\n\nStarting from the conservation laws and the ideal-gas closure, derive the quasi-linear matrix $B(W)$ in primitive variables, compute its eigenvalues and a corresponding set of right eigenvectors, and connect each wave family to a physical mode. You may use the well-tested thermodynamic relation for the adiabatic sound speed $c(W)$ of an ideal gas, $c^{2} = \\gamma p / \\rho$, provided you justify its role in the derivation.\n\nInstructions:\n- Derive $B(W)$ from first principles and then compute all eigenvalues and a complete set of linearly independent right eigenvectors of $B(W)$.\n- Normalize the right eigenvectors so that the first component (the $\\rho$ component) of each eigenvector equals $1$.\n- Explain, in terms of physical wave propagation relevant to the Riemann problem and Godunov-type upwinding, which eigenpairs correspond to acoustic modes and which correspond to the entropy (contact) mode, including how each mode advects or couples $(\\rho, u, p)$.\n\nAnswer specification:\n- Provide your final eigenvalues and the right eigenvector matrix as a single closed-form analytical expression.\n- Use symbols $\\rho$, $u$, $p$, $\\gamma$, and $c$ with $c^{2} = \\gamma p / \\rho$. No numerical evaluation is required.\n- The final answer must not include any explanatory text or units. Represent multiple answers as a row matrix whose first entry is the $1 \\times 3$ row of eigenvalues and whose second entry is the $3 \\times 3$ right eigenvector matrix with columns ordered consistently with the eigenvalues.",
            "solution": "The problem requires the derivation of the quasi-linear primitive-variable form of the one-dimensional Euler equations, and the calculation of the eigenvalues and eigenvectors of the system matrix. This characteristic analysis is fundamental to understanding wave propagation in compressible fluids and forms the basis for Godunov-type numerical methods.\n\nThe one-dimensional Euler equations for an inviscid, compressible gas in conservative form are:\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0\n$$\nwhere $U$ is the vector of conserved variables and $F(U)$ is the flux vector:\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ (E+p)u \\end{pmatrix}\n$$\nHere, $\\rho$ is the mass density, $u$ is the fluid velocity, $p$ is the pressure, and $E$ is the total energy per unit volume. For a calorically perfect ideal gas, the total energy is given by $E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2$, where $\\gamma$ is the adiabatic index. The primitive variables are given by the vector $W = (\\rho, u, p)^{\\top}$.\n\nOur goal is to transform the system into the quasi-linear form $\\frac{\\partial W}{\\partial t} + B(W)\\frac{\\partial W}{\\partial x} = 0$. We achieve this by expanding the derivatives in the conservative equations and re-expressing them in terms of derivatives of the primitive variables.\n\n1.  **Mass Conservation Equation:**\n    $$\n    \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0\n    $$\n    Applying the product rule to the spatial derivative gives:\n    $$\n    \\frac{\\partial \\rho}{\\partial t} + u \\frac{\\partial \\rho}{\\partial x} + \\rho \\frac{\\partial u}{\\partial x} = 0\n    $$\n    This equation provides the first row of our primitive variable system.\n\n2.  **Momentum Conservation Equation:**\n    $$\n    \\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0\n    $$\n    Expanding the derivatives:\n    $$\n    \\rho\\frac{\\partial u}{\\partial t} + u\\frac{\\partial \\rho}{\\partial t} + u^2 \\frac{\\partial \\rho}{\\partial x} + 2\\rho u \\frac{\\partial u}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n    $$\n    We substitute $\\frac{\\partial \\rho}{\\partial t}$ from the mass equation:\n    $$\n    \\rho\\frac{\\partial u}{\\partial t} + u\\left(-u \\frac{\\partial \\rho}{\\partial x} - \\rho \\frac{\\partial u}{\\partial x}\\right) + u^2 \\frac{\\partial \\rho}{\\partial x} + 2\\rho u \\frac{\\partial u}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n    $$\n    Simplifying the expression:\n    $$\n    \\rho\\frac{\\partial u}{\\partial t} - u^2 \\frac{\\partial \\rho}{\\partial x} - \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + 2\\rho u \\frac{\\partial u}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n    $$\n    $$\n    \\rho\\frac{\\partial u}{\\partial t} + \\rho u \\frac{\\partial u}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n    $$\n    Dividing by $\\rho$ (since $\\rho > 0$):\n    $$\n    \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} = 0\n    $$\n    This is the second row of our system.\n\n3.  **Energy Conservation Equation:**\n    Instead of directly manipulating the cumbersome energy equation, we can use the first law of thermodynamics for a fluid parcel, which for an inviscid, non-heat-conducting flow states that entropy is conserved along fluid pathlines: $\\frac{DS}{Dt} = 0$, where $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + u \\frac{\\partial}{\\partial x}$ is the material derivative. For an ideal gas, entropy $S$ is related to $p$ and $\\rho$ by $p = K\\rho^\\gamma \\exp(S/c_v)$, which implies $p/\\rho^\\gamma$ is constant for constant entropy. The material derivative of this quantity is zero:\n    $$\n    \\frac{D}{Dt}\\left(\\frac{p}{\\rho^\\gamma}\\right) = 0 \\implies \\frac{1}{\\rho^\\gamma}\\frac{Dp}{Dt} - \\frac{\\gamma p}{\\rho^{\\gamma+1}}\\frac{D\\rho}{Dt} = 0\n    $$\n    $$\n    \\frac{Dp}{Dt} = \\frac{\\gamma p}{\\rho}\\frac{D\\rho}{Dt}\n    $$\n    From the mass equation, we have $\\frac{D\\rho}{Dt} = -\\rho \\frac{\\partial u}{\\partial x}$. Substituting this in gives:\n    $$\n    \\frac{Dp}{Dt} = -\\frac{\\gamma p}{\\rho} \\left(\\rho \\frac{\\partial u}{\\partial x}\\right) = - \\gamma p \\frac{\\partial u}{\\partial x}\n    $$\n    Expanding the material derivative $\\frac{Dp}{Dt} = \\frac{\\partial p}{\\partial t} + u \\frac{\\partial p}{\\partial x}$:\n    $$\n    \\frac{\\partial p}{\\partial t} + u \\frac{\\partial p}{\\partial x} + \\gamma p \\frac{\\partial u}{\\partial x} = 0\n    $$\n    The problem provides the relation for the adiabatic sound speed, $c^2 = \\gamma p / \\rho$. This quantity naturally appears in the derivation. Its role is to define the characteristic speed of pressure waves. Substituting $c$ into the equation, we get:\n    $$\n    \\frac{\\partial p}{\\partial t} + u \\frac{\\partial p}{\\partial x} + \\rho c^2 \\frac{\\partial u}{\\partial x} = 0\n    $$\n    This is the third row of our system.\n\nAssembling the three derived equations into the matrix form $\\frac{\\partial W}{\\partial t} + B(W)\\frac{\\partial W}{\\partial x} = 0$:\n$$\n\\frac{\\partial}{\\partial t}\\begin{pmatrix} \\rho \\\\ u \\\\ p \\end{pmatrix} + \\begin{pmatrix} u & \\rho & 0 \\\\ 0 & u & 1/\\rho \\\\ 0 & \\rho c^2 & u \\end{pmatrix} \\frac{\\partial}{\\partial x}\\begin{pmatrix} \\rho \\\\ u \\\\ p \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe quasi-linear matrix is therefore:\n$$\nB(W) = \\begin{pmatrix}\nu & \\rho & 0 \\\\\n0 & u & 1/\\rho \\\\\n0 & \\rho c^2 & u\n\\end{pmatrix}\n$$\n\nNext, we compute the eigenvalues $\\lambda$ of $B(W)$ by solving the characteristic equation $\\det(B - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix}\nu-\\lambda & \\rho & 0 \\\\\n0 & u-\\lambda & 1/\\rho \\\\\n0 & \\rho c^2 & u-\\lambda\n\\end{pmatrix} = (u-\\lambda)\\left((u-\\lambda)^2 - (\\rho c^2)(1/\\rho)\\right) = (u-\\lambda)((u-\\lambda)^2 - c^2) = 0\n$$\nThe roots of this equation are the eigenvalues:\n$$\n\\lambda_1 = u - c, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + c\n$$\n\nNow, we find the corresponding right eigenvectors $r_k$ by solving $(B - \\lambda_k I)r_k = 0$ for each eigenvalue, normalizing such that the first component is $1$.\n\nFor $\\lambda_1 = u-c$:\n$$\n\\begin{pmatrix} c & \\rho & 0 \\\\ 0 & c & 1/\\rho \\\\ 0 & \\rho c^2 & c \\end{pmatrix} \\begin{pmatrix} r_\\rho \\\\ r_u \\\\ r_p \\end{pmatrix} = 0 \\implies\n\\begin{cases} c r_\\rho + \\rho r_u = 0 \\\\ c r_u + (1/\\rho) r_p = 0 \\end{cases}\n\\implies\n\\begin{cases} r_u = -(c/\\rho) r_\\rho \\\\ r_p = -\\rho c r_u = c^2 r_\\rho \\end{cases}\n$$\nNormalizing with $r_\\rho = 1$, we get $r_1 = (1, -c/\\rho, c^2)^{\\top}$.\n\nFor $\\lambda_2 = u$:\n$$\n\\begin{pmatrix} 0 & \\rho & 0 \\\\ 0 & 0 & 1/\\rho \\\\ 0 & \\rho c^2 & 0 \\end{pmatrix} \\begin{pmatrix} r_\\rho \\\\ r_u \\\\ r_p \\end{pmatrix} = 0 \\implies\n\\begin{cases} \\rho r_u = 0 \\\\ (1/\\rho) r_p = 0 \\end{cases}\n\\implies\n\\begin{cases} r_u = 0 \\\\ r_p = 0 \\end{cases}\n$$\n$r_\\rho$ is a free parameter. Normalizing with $r_\\rho = 1$, we get $r_2 = (1, 0, 0)^{\\top}$.\n\nFor $\\lambda_3 = u+c$:\n$$\n\\begin{pmatrix} -c & \\rho & 0 \\\\ 0 & -c & 1/\\rho \\\\ 0 & \\rho c^2 & -c \\end{pmatrix} \\begin{pmatrix} r_\\rho \\\\ r_u \\\\ r_p \\end{pmatrix} = 0 \\implies\n\\begin{cases} -c r_\\rho + \\rho r_u = 0 \\\\ -c r_u + (1/\\rho) r_p = 0 \\end{cases}\n\\implies\n\\begin{cases} r_u = (c/\\rho) r_\\rho \\\\ r_p = \\rho c r_u = c^2 r_\\rho \\end{cases}\n$$\nNormalizing with $r_\\rho = 1$, we get $r_3 = (1, c/\\rho, c^2)^{\\top}$.\n\nThe three eigenpairs $(\\lambda_k, r_k)$ represent the three characteristic wave families of the Euler equations.\n\n- **Acoustic Modes ($\\lambda_{1,3} = u \\mp c$):** The eigenvalues $\\lambda_1=u-c$ and $\\lambda_3=u+c$ correspond to sound waves propagating left and right, respectively, relative to the fluid flow. Their eigenvectors are $r_1=(1, -c/\\rho, c^2)^{\\top}$ and $r_3=(1, c/\\rho, c^2)^{\\top}$. Across these waves, density, velocity, and pressure are all coupled. The relation between the perturbations in the primitive variables is $\\Delta p = c^2 \\Delta \\rho$ and $\\Delta u = \\mp (c/\\rho) \\Delta \\rho$. This is characteristic of an isentropic compression or expansion. In the context of the Riemann problem, these waves manifest as either shock waves (discontinuous jumps) or rarefaction waves (smooth transitions).\n\n- **Entropy (Contact) Mode ($\\lambda_2 = u$):** The eigenvalue $\\lambda_2=u$ corresponds to a wave that is passively advected with the fluid velocity. Its eigenvector is $r_2=(1, 0, 0)^{\\top}$. This vector shows that only the density $\\rho$ changes across this wave, while velocity $u$ and pressure $p$ remain constant. This structure describes a contact discontinuity. Since a change in density at constant pressure implies a change in entropy ($S \\propto \\ln(p/\\rho^\\gamma)$ for an ideal gas), this is also an entropy wave. In the Riemann problem, this wave separates the fluid that was initially on the left from the fluid that was initially on the right.\n\nIn Godunov-type schemes, this characteristic decomposition is crucial. The eigenvalues determine the directions of information propagation (upwinding), and the eigenvectors provide the basis onto which the jump between states at a cell interface is projected to determine the strength of each physical wave (acoustic or entropy).\n\nThe final answer consists of the row of eigenvalues and the matrix of corresponding right eigenvectors, ordered consistently.\nThe eigenvalues are $(u-c, u, u+c)$.\nThe right eigenvector matrix $R = (r_1, r_2, r_3)$ is:\n$$\nR = \\begin{pmatrix}\n1 & 1 & 1 \\\\\n-c/\\rho & 0 & c/\\rho \\\\\nc^2 & 0 & c^2\n\\end{pmatrix}\n$$\nThese are provided in the final answer box as a single row matrix.",
            "answer": "$$\n\\boxed{\n\\pmatrix{\n\\begin{pmatrix}\nu - c & u & u + c\n\\end{pmatrix}\n&\n\\begin{pmatrix}\n1 & 1 & 1 \\\\\n-\\frac{c}{\\rho} & 0 & \\frac{c}{\\rho} \\\\\nc^{2} & 0 & c^{2}\n\\end{pmatrix}\n}\n}\n$$"
        },
        {
            "introduction": "First-order Godunov schemes, while robust, are often too diffusive for astrophysical applications. To achieve higher accuracy, we reconstruct the fluid states within each cell, creating sharper inputs for the Riemann problem at each interface . This hands-on coding practice implements the widely used MUSCL (Monotonic Upstream-centered Schemes for Conservation Laws) reconstruction, demonstrating how to use the characteristic decomposition to project and limit slopes, thereby preventing spurious oscillations while maintaining sharp features.",
            "id": "3513180",
            "problem": "You are to implement a characteristic-based Monotonic Upstream-centered Schemes for Conservation Laws (MUSCL) piecewise-linear reconstruction for the one-dimensional Euler equations for an ideal gas. The objective is to reconstruct left and right conservative states at a single interface by projecting primitive-variable slopes onto characteristic fields, applying a Total Variation Diminishing (TVD) limiter, and recovering conservative variables. The reconstruction must be carried out at the interface between two given cells using their immediate neighbors, as is standard in Godunov-type finite volume schemes.\n\nStart from the following fundamental base:\n- The one-dimensional Euler equations for an ideal gas in conservative form with conservative state vector $U = (\\rho, \\rho u, E)^\\top$.\n- Primitive variables $W = (\\rho, u, p)^\\top$, with ideal-gas sound speed $c = \\sqrt{\\gamma p / \\rho}$ and total energy $E = p/(\\gamma - 1) + \\tfrac{1}{2} \\rho u^2$.\n- The quasi-linear form in primitive variables $W$ is $\\partial_t W + A_p(W) \\partial_x W = 0$, where $A_p(W)$ is the Jacobian in primitive variables. The characteristic decomposition of $A_p(W)$ yields three real eigenvalues $u - c$, $u$, and $u + c$ and corresponding right and left eigenvectors collected in matrices $R(W)$ and $L(W)$ such that $L(W) R(W) = I$.\n\nYour reconstruction must follow these steps at an interface between cells $i$ and $i+1$:\n1. For the left state at the interface, use the centered cell $i$ and its neighbors $i-1$ and $i+1$. Compute one-sided primitive differences $\\Delta W_L = W_i - W_{i-1}$ and $\\Delta W_R = W_{i+1} - W_i$. Project these differences into characteristic space using the left eigenvector matrix $L(W_i)$ to obtain $\\Delta \\alpha_L = L(W_i) \\Delta W_L$ and $\\Delta \\alpha_R = L(W_i) \\Delta W_R$.\n2. Apply a component-wise minmod limiter in characteristic space to obtain limited characteristic slopes $\\Delta \\alpha$ at cell $i$:\n   $$\\operatorname{mm}(a,b) = \\begin{cases}\n   \\operatorname{sign}(a) \\min(|a|,|b|) & \\text{if } \\operatorname{sign}(a) = \\operatorname{sign}(b), \\\\\n   0 & \\text{otherwise,}\n   \\end{cases}$$\n   applied to each characteristic component with $a = \\Delta \\alpha_L$ and $b = \\Delta \\alpha_R$.\n3. Recover the limited primitive slope in physical space at $i$ via $R(W_i)$, and form the left state at the interface:\n   $$W_{i+1/2}^L = W_i + \\tfrac{1}{2} R(W_i) \\Delta \\alpha.$$\n4. For the right state at the interface, use the centered cell $i+1$ and its neighbors $i$ and $i+2$. Repeat steps analogous to $1$–$3$ evaluated at $i+1$ to obtain\n   $$W_{i+1/2}^R = W_{i+1} - \\tfrac{1}{2} R(W_{i+1}) \\Delta \\alpha_{i+1},$$\n   where $\\Delta \\alpha_{i+1}$ is the limited characteristic slope computed from $W_{i+1} - W_i$ and $W_{i+2} - W_{i+1}$ after projection by $L(W_{i+1})$ and minmod limiting.\n5. Convert the reconstructed primitive states $W_{i+1/2}^{L}$ and $W_{i+1/2}^{R}$ to conservative states $U_{i+1/2}^{L} = (\\rho^L, \\rho^L u^L, E^L)^\\top$ and $U_{i+1/2}^{R} = (\\rho^R, \\rho^R u^R, E^R)^\\top$ with $E = p/(\\gamma - 1) + \\tfrac{1}{2} \\rho u^2$.\n\nImplement the above reconstruction and apply it to the following test suite. For each case, the interface is between cells with indices $1$ and $2$ (zero-based indexing), and the four provided primitive states correspond to cells $0,1,2,3$ respectively:\n- Test $1$ (smooth subsonic gradient):\n  - $\\gamma = 1.4$\n  - $\\{(\\rho, u, p)\\}_j = [(1.0, 0.1, 1.0), (1.1, 0.12, 1.05), (1.2, 0.14, 1.1), (1.3, 0.16, 1.15)]$.\n- Test $2$ (contact-like density gradient, constant velocity and pressure):\n  - $\\gamma = 1.4$\n  - $\\{(\\rho, u, p)\\}_j = [(1.0, 0.0, 1.0), (2.0, 0.0, 1.0), (3.0, 0.0, 1.0), (4.0, 0.0, 1.0)]$.\n- Test $3$ (strong jump with differing signs in one-sided slopes):\n  - $\\gamma = 1.4$\n  - $\\{(\\rho, u, p)\\}_j = [(1.0, 3.0, 0.1), (1.0, 3.0, 0.1), (3.0, 1.0, 10.0), (3.0, 0.5, 12.0)]$.\n- Test $4$ (near-vacuum smooth variation):\n  - $\\gamma = 1.6666666667$\n  - $\\{(\\rho, u, p)\\}_j = [(0.001, 0.0, 0.000001), (0.002, 0.0, 0.0000015), (0.003, 0.0, 0.0000025), (0.004, 0.0, 0.000004)]$.\n\nYour program must output, for each test in order, the reconstructed conservative left and right interface states concatenated into a single flat list per test:\n- For each test, output $[\\rho^L, \\rho^L u^L, E^L, \\rho^R, \\rho^R u^R, E^R]$.\n- Aggregate all test results into a single line containing a list of these per-test lists with no spaces anywhere. For example, a line of the form $[[\\dots],[\\dots],[\\dots],[\\dots]]$ with comma-separated values, and no additional text.\n\nNo physical units are required; all inputs and outputs are nondimensional. Angles are not involved. All numeric outputs must be real numbers. The final output must be a single line exactly as specified above.",
            "solution": "We seek a high-resolution interface reconstruction suitable for Godunov-type methods. We start from the one-dimensional Euler equations for an ideal gas, in conservative variables $U = (\\rho, \\rho u, E)^\\top$ and primitive variables $W = (\\rho, u, p)^\\top$. The total energy is $E = p/(\\gamma - 1) + \\tfrac{1}{2} \\rho u^2$. The ideal-gas sound speed is $c = \\sqrt{\\gamma p / \\rho}$.\n\nA standard approach to robust slope limiting uses the quasi-linear primitive-variable form\n$$\n\\partial_t W + A_p(W) \\,\\partial_x W = 0,\n$$\nwith the Jacobian in primitive variables\n$$\nA_p(W) =\n\\begin{pmatrix}\nu & \\rho & 0 \\\\\n0 & u & 1/\\rho \\\\\n0 & \\gamma p & u\n\\end{pmatrix}.\n$$\nThis matrix has real eigenvalues $\\lambda_1 = u - c$, $\\lambda_2 = u$, and $\\lambda_3 = u + c$. Its right eigenvectors $r_k$ and left eigenvectors $\\ell_k^\\top$ form matrices $R(W) = [r_1, r_2, r_3]$ and $L(W) = [\\ell_1^\\top; \\ell_2^\\top; \\ell_3^\\top]$ that diagonalize $A_p$ as $A_p = R \\Lambda L$ with $\\Lambda = \\operatorname{diag}(u - c, u, u + c)$ and $L R = I$.\n\nWe derive the right eigenvectors by solving $(A_p - \\lambda I) r = 0$ in primitive variables. For $\\lambda_1 = u - c$, let $r_1 = (a, b, d)^\\top$. From the first row we have $c a + \\rho b = 0$, so $b = - c a / \\rho$. From the second row $c b + (1/\\rho) d = 0$, yielding $d = c^2 a$. The third row is satisfied because $c^2 = \\gamma p / \\rho$. Choosing $a = 1$ gives $r_1 = (1, -c/\\rho, c^2)^\\top$. Repeating this for $\\lambda_2 = u$ yields $r_2 = (1, 0, 0)^\\top$, and for $\\lambda_3 = u + c$, we obtain $r_3 = (1, c/\\rho, c^2)^\\top$. Hence\n$$\nR(W) = \\begin{pmatrix}\n1 & 1 & 1 \\\\\n- c/\\rho & 0 & c/\\rho \\\\\nc^2 & 0 & c^2\n\\end{pmatrix}.\n$$\nThe left eigenvectors are the rows of $R^{-1}(W)$. We solve $L R = I$ explicitly. Let $a = c/\\rho$ and $b = c^2$. Solving the linear systems for rows yields\n$$\n\\ell_1^\\top = \\begin{pmatrix} 0 & -\\tfrac{1}{2} \\tfrac{\\rho}{c} & \\tfrac{1}{2} \\tfrac{1}{c^2} \\end{pmatrix},\\quad\n\\ell_2^\\top = \\begin{pmatrix} 1 & 0 & -\\tfrac{1}{c^2} \\end{pmatrix},\\quad\n\\ell_3^\\top = \\begin{pmatrix} 0 & \\tfrac{1}{2} \\tfrac{\\rho}{c} & \\tfrac{1}{2} \\tfrac{1}{c^2} \\end{pmatrix},\n$$\nso that\n$$\nL(W) = \\begin{pmatrix}\n0 & -\\tfrac{1}{2} \\tfrac{\\rho}{c} & \\tfrac{1}{2} \\tfrac{1}{c^2} \\\\\n1 & 0 & -\\tfrac{1}{c^2} \\\\\n0 & \\tfrac{1}{2} \\tfrac{\\rho}{c} & \\tfrac{1}{2} \\tfrac{1}{c^2}\n\\end{pmatrix}.\n$$\n\nWith this eigenstructure, we perform characteristic-based MUSCL reconstruction at the interface $i + \\tfrac{1}{2}$ as follows.\n\nFor the left state at $i + \\tfrac{1}{2}$:\n- Compute one-sided primitive differences $\\Delta W_L = W_i - W_{i-1}$ and $\\Delta W_R = W_{i+1} - W_i$.\n- Project to characteristic variables using $L(W_i)$:\n$$\n\\Delta \\alpha_L = L(W_i) \\,\\Delta W_L,\\quad \\Delta \\alpha_R = L(W_i)\\, \\Delta W_R.\n$$\n- Apply the component-wise minmod limiter. For each component $k \\in \\{1,2,3\\}$, define\n$$\n\\Delta \\alpha^{(k)} = \\operatorname{mm}\\big(\\Delta \\alpha_L^{(k)}, \\Delta \\alpha_R^{(k)}\\big) =\n\\begin{cases}\n\\operatorname{sign}(\\Delta \\alpha_L^{(k)}) \\min\\big(|\\Delta \\alpha_L^{(k)}|, |\\Delta \\alpha_R^{(k)}|\\big), & \\text{if } \\Delta \\alpha_L^{(k)} \\Delta \\alpha_R^{(k)} > 0, \\\\\n0, & \\text{otherwise.}\n\\end{cases}\n$$\n- Recover the limited primitive slope in physical space and reconstruct the left primitive state:\n$$\nW_{i+1/2}^L = W_i + \\tfrac{1}{2}\\, R(W_i)\\, \\Delta \\alpha.\n$$\n\nFor the right state at $i + \\tfrac{1}{2}$:\n- Compute one-sided differences around $i+1$: $\\Delta W_L^{+} = W_{i+1} - W_i$, $\\Delta W_R^{+} = W_{i+2} - W_{i+1}$.\n- Project with $L(W_{i+1})$ and apply the minmod limiter to obtain $\\Delta \\alpha_{i+1}$.\n- Reconstruct the right primitive state:\n$$\nW_{i+1/2}^R = W_{i+1} - \\tfrac{1}{2}\\, R(W_{i+1})\\, \\Delta \\alpha_{i+1}.\n$$\n\nFinally, convert $W_{i+1/2}^{L,R}$ to conservative variables via\n$$\nU^L = \\big(\\rho^L, \\rho^L u^L, p^L/(\\gamma - 1) + \\tfrac{1}{2}\\rho^L (u^L)^2\\big)^\\top,\\quad\nU^R = \\big(\\rho^R, \\rho^R u^R, p^R/(\\gamma - 1) + \\tfrac{1}{2}\\rho^R (u^R)^2\\big)^\\top.\n$$\n\nAlgorithmic design summary:\n- Compute $c$ at the relevant cell centers from $c = \\sqrt{\\gamma p / \\rho}$.\n- Assemble $R(W)$ and $L(W)$ from the derived formulas at $i$ and $i+1$.\n- Perform the projections and minmod limiting in characteristic space to obtain limited slopes.\n- Reconstruct $W^L$ and $W^R$ and convert to conservative states $U^L$ and $U^R$.\n- Repeat for each test case at the interface between indices $1$ and $2$ (zero-based), and aggregate the results.\n\nThis procedure is strictly based on the conservation form of the equations, the ideal gas law, and the characteristic structure of the quasi-linear primitive-variable system. It separates wave families via projection, enforces monotonicity through minmod limiting, and reconstructs physically meaningful left and right states suitable for a Godunov-type Riemann solver. The outputs are the six conservative quantities per test, concatenated as specified, yielding a single line of comma-separated numerical lists.",
            "answer": "```python\nimport numpy as np\n\ndef sound_speed(gamma, rho, p):\n    return np.sqrt(gamma * p / rho)\n\ndef eigen_matrices_primitive(rho, u, p, gamma):\n    \"\"\"\n    Construct right (R) and left (L) eigenvector matrices of the 1D Euler\n    primitive-variable Jacobian at (rho,u,p) for ideal gas with gamma.\n    W = [rho, u, p]^T\n    A_p(W) has eigenvalues u-c, u, u+c, with:\n      R = [[1, 1, 1],\n           [-c/rho, 0, c/rho],\n           [c^2, 0, c^2]]\n      L rows (inverse of R):\n           [0, -0.5*rho/c, 0.5/c^2]\n           [1, 0, -1/c^2]\n           [0, 0.5*rho/c, 0.5/c^2]\n    \"\"\"\n    c = sound_speed(gamma, rho, p)\n    # Right eigenvectors (columns)\n    R = np.array([\n        [1.0, 1.0, 1.0],\n        [-c / rho, 0.0, c / rho],\n        [c * c, 0.0, c * c]\n    ], dtype=float)\n    # Left eigenvectors (rows)\n    L = np.array([\n        [0.0, -0.5 * rho / c, 0.5 / (c * c)],\n        [1.0, 0.0, -1.0 / (c * c)],\n        [0.0, 0.5 * rho / c, 0.5 / (c * c)]\n    ], dtype=float)\n    return L, R\n\ndef minmod_pair(a, b):\n    \"\"\"\n    Component-wise minmod of two same-shaped arrays a and b.\n    mm(a,b) = sign(a)*min(|a|,|b|) if sign(a)==sign(b) != 0, else 0.\n    \"\"\"\n    s = np.sign(a) * np.sign(b)\n    same_sign = s > 0.0\n    out = np.zeros_like(a)\n    out[same_sign] = np.sign(a[same_sign]) * np.minimum(np.abs(a[same_sign]), np.abs(b[same_sign]))\n    return out\n\ndef reconstruct_interface(Wm, Wi, Wp, Wpp, gamma):\n    \"\"\"\n    Given four primitive states Wm=W_{i-1}, Wi=W_{i}, Wp=W_{i+1}, Wpp=W_{i+2},\n    perform characteristic-based MUSCL reconstruction at interface i+1/2.\n    Returns (UL, UR) as conservative states arrays of length 3: [rho, mom, E].\n    \"\"\"\n    # Left state from cell i\n    rho_i, u_i, p_i = Wi\n    L_i, R_i = eigen_matrices_primitive(rho_i, u_i, p_i, gamma)\n    dWL = Wi - Wm\n    dWR = Wp - Wi\n    daL = L_i @ dWL\n    daR = L_i @ dWR\n    da = minmod_pair(daL, daR)\n    W_L = Wi + 0.5 * (R_i @ da)\n\n    # Right state from cell i+1\n    rho_ip, u_ip, p_ip = Wp\n    L_ip, R_ip = eigen_matrices_primitive(rho_ip, u_ip, p_ip, gamma)\n    dWLp = Wp - Wi\n    dWRp = Wpp - Wp\n    daLp = L_ip @ dWLp\n    daRp = L_ip @ dWRp\n    dap = minmod_pair(daLp, daRp)\n    W_R = Wp - 0.5 * (R_ip @ dap)\n\n    # Convert to conservative variables\n    def prim_to_cons(W, gamma):\n        rho, u, p = W\n        mom = rho * u\n        E = p / (gamma - 1.0) + 0.5 * rho * u * u\n        return np.array([rho, mom, E], dtype=float)\n\n    U_L = prim_to_cons(W_L, gamma)\n    U_R = prim_to_cons(W_R, gamma)\n    return U_L, U_R\n\ndef format_float(x):\n    # Use up to 10 significant digits, strip spaces\n    return f\"{x:.10g}\"\n\ndef format_list(lst):\n    return \"[\" + \",\".join(format_float(x) for x in lst) + \"]\"\n\ndef solve():\n    # Define test cases: each is (gamma, [W0,W1,W2,W3]) with W=(rho,u,p)\n    test_cases = [\n        (1.4, [\n            np.array([1.0, 0.1, 1.0], dtype=float),\n            np.array([1.1, 0.12, 1.05], dtype=float),\n            np.array([1.2, 0.14, 1.1], dtype=float),\n            np.array([1.3, 0.16, 1.15], dtype=float),\n        ]),\n        (1.4, [\n            np.array([1.0, 0.0, 1.0], dtype=float),\n            np.array([2.0, 0.0, 1.0], dtype=float),\n            np.array([3.0, 0.0, 1.0], dtype=float),\n            np.array([4.0, 0.0, 1.0], dtype=float),\n        ]),\n        (1.4, [\n            np.array([1.0, 3.0, 0.1], dtype=float),\n            np.array([1.0, 3.0, 0.1], dtype=float),\n            np.array([3.0, 1.0, 10.0], dtype=float),\n            np.array([3.0, 0.5, 12.0], dtype=float),\n        ]),\n        (1.6666666667, [\n            np.array([0.001, 0.0, 0.000001], dtype=float),\n            np.array([0.002, 0.0, 0.0000015], dtype=float),\n            np.array([0.003, 0.0, 0.0000025], dtype=float),\n            np.array([0.004, 0.0, 0.000004], dtype=float),\n        ]),\n    ]\n\n    results_strs = []\n    for gamma, Wlist in test_cases:\n        Wm, Wi, Wp, Wpp = Wlist\n        UL, UR = reconstruct_interface(Wm, Wi, Wp, Wpp, gamma)\n        combined = np.concatenate([UL, UR])\n        results_strs.append(format_list(combined))\n\n    print(\"[\" + \",\".join(results_strs) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Approximate Riemann solvers are the engine of many modern Godunov-type codes, but they can have subtle failure modes. The popular Roe solver, for instance, can violate the entropy condition in transonic flows, admitting unphysical expansion shocks . This advanced practice addresses this critical issue by having you implement a common \"entropy fix,\" a standard technique to add the necessary dissipation and ensure the numerical solution remains physically valid across all flow regimes.",
            "id": "3513255",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma$ in nondimensional units. A Godunov-type discretization with a Roe linearization uses the Jacobian of the flux evaluated at suitable Roe-averaged states to approximate the solution of the Riemann problem at a cell interface. Near transonic states where the Mach number $M \\approx 1$, Roe linearization can admit non-physical expansion shocks unless an entropy fix is applied. Your task is to design and implement an entropy fix that preserves the contact wave speed while regularizing the acoustic fields in jet-like Riemann problems.\n\nStarting from the conservation laws and the ideal-gas relations as the fundamental base, derive the Roe-averaged state at an interface between left and right primitive states $\\rho_L,u_L,p_L$ and $\\rho_R,u_R,p_R$, the associated eigenvalues and eigenvectors, and the wave strengths obtained by projecting the conservative-state jump onto the eigenbasis. Construct an entropy fix parameterized by a threshold $\\delta$ that modifies only the acoustic fields and leaves the contact field unchanged in the sense that the contact eigenvalue remains equal to the Roe-averaged velocity. The entropy fix must transition continuously for small eigenvalues as a function of $\\delta$ and must not alter the sign of characteristic speeds.\n\nImplement a program that, for a set of jet-like and contact Riemann initial states, computes the corrected absolute values of the acoustic characteristic speeds after applying your entropy fix with specified $\\delta$, verifies that the contact eigenvalue is preserved, and, in the pure contact case, verifies that the acoustic wave strengths vanish.\n\nUse nondimensional units throughout. All floating-point outputs for characteristic speeds must be rounded to six decimal places.\n\nTest suite:\n- Let $\\gamma=1.4$.\n- Test case $1$ (jet-like, baseline without entropy fix): Left state $\\rho_L=1.0$, $p_L=1.0$, $u_L=1.05\\,c_L$, where $c_L=\\sqrt{\\gamma p_L/\\rho_L}$; Right state $\\rho_R=0.8$, $p_R=1.0$, $u_R=0.3\\,c_R$, where $c_R=\\sqrt{\\gamma p_R/\\rho_R}$; entropy fix threshold $\\delta=0.0$.\n- Test case $2$ (jet-like, mild entropy fix): Same left and right states as test case $1$; entropy fix threshold $\\delta=0.1$.\n- Test case $3$ (near-transonic straddling with entropy fix): Left state $\\rho_L=1.0$, $p_L=1.0$, $u_L=1.05\\,c_L$ with $c_L=\\sqrt{\\gamma p_L/\\rho_L}$; Right state $\\rho_R=0.7$, $p_R=0.7$, $u_R=0.95\\,c_R$ with $c_R=\\sqrt{\\gamma p_R/\\rho_R}$; entropy fix threshold $\\delta=0.1$.\n- Test case $4$ (pure contact discontinuity): Left state $\\rho_L=1.0$, $p_L=1.0$, $u_L=0.3$; Right state $\\rho_R=2.0$, $p_R=1.0$, $u_R=0.3$; entropy fix threshold $\\delta=0.5$.\n\nFor each test case:\n- Compute the Roe-averaged velocity and speed of sound.\n- Compute the acoustic eigenvalues and the contact eigenvalue for the Roe matrix.\n- Apply the entropy fix to the acoustic eigenvalues only, leaving the contact eigenvalue unmodified. The entropy fix must satisfy the property that for any acoustic eigenvalue $\\lambda$ the corrected absolute value is a continuous, non-decreasing function of $|\\lambda|$ parameterized by $\\delta$, and equals $|\\lambda|$ for sufficiently large $|\\lambda|$.\n- For test cases $1$–$3$, output a list containing a boolean indicating whether the contact eigenvalue equals the Roe-averaged velocity within a tolerance of $10^{-12}$, and a list of the corrected absolute acoustic eigenvalues $\\{|\\lambda_-|_{\\text{corr}},|\\lambda_+|_{\\text{corr}}\\}$, each rounded to six decimal places.\n- For test case $4$, output a list containing a boolean indicating whether the contact eigenvalue equals the Roe-averaged velocity within the same tolerance, and a boolean indicating whether the acoustic wave strengths are both within $10^{-12}$ of zero.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[[True,[0.123456,1.234567]],[...],...]\").",
            "solution": "The one-dimensional compressible Euler equations for an ideal gas are given in conservative form by\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{bmatrix}\n\\rho\\\\\n\\rho u\\\\\nE\n\\end{bmatrix}\n+\n\\frac{\\partial}{\\partial x}\n\\begin{bmatrix}\n\\rho u\\\\\n\\rho u^2 + p\\\\\nu(E+p)\n\\end{bmatrix}\n= 0,\n$$\nwhere $\\rho$ is the mass density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy density. For an ideal gas with ratio of specific heats $\\gamma$, the thermodynamic closure is $p=(\\gamma-1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right)$, and the speed of sound is $c=\\sqrt{\\gamma p/\\rho}$.\n\nIn a Godunov-type method, the numerical flux at an interface is obtained by solving or approximating the Riemann problem posed by left and right states. Roe linearization constructs a constant-coefficient Jacobian matrix $\\mathbf{A}_{\\mathrm{Roe}}$ that approximates the flux Jacobian in a manner that preserves certain conservation and consistency properties. The construction uses Roe averages derived from the fundamental conservation laws and ideal-gas relations.\n\nDefine the primitive states $(\\rho_L,u_L,p_L)$ and $(\\rho_R,u_R,p_R)$ and the corresponding total energy densities\n$$\nE_L = \\frac{p_L}{\\gamma-1} + \\frac{1}{2}\\rho_L u_L^2,\\quad\nE_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2,\n$$\nand total specific enthalpies\n$$\nH_L = \\frac{E_L + p_L}{\\rho_L},\\quad\nH_R = \\frac{E_R + p_R}{\\rho_R}.\n$$\nThe Roe averages are constructed using density-based weights. Let $\\tilde{\\rho}=\\sqrt{\\rho_L \\rho_R}$ and define weights $w_L=\\sqrt{\\rho_L}$ and $w_R=\\sqrt{\\rho_R}$. The Roe-averaged velocity and enthalpy are\n$$\n\\tilde{u} = \\frac{w_L u_L + w_R u_R}{w_L + w_R},\\quad\n\\tilde{H} = \\frac{w_L H_L + w_R H_R}{w_L + w_R}.\n$$\nFrom these, the Roe-averaged speed of sound is obtained via the ideal-gas relation,\n$$\n\\tilde{c} = \\sqrt{(\\gamma - 1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)}.\n$$\nThe eigenvalues of $\\mathbf{A}_{\\mathrm{Roe}}$ are the characteristic speeds\n$$\n\\lambda_1 = \\tilde{u} - \\tilde{c},\\quad\n\\lambda_2 = \\tilde{u},\\quad\n\\lambda_3 = \\tilde{u} + \\tilde{c}.\n$$\nThe corresponding right eigenvectors form a basis in which the conservative-state jump $\\Delta \\mathbf{U} = \\mathbf{U}_R - \\mathbf{U}_L$ can be decomposed. Using the Roe-averaged quantities and the primitive jumps $\\Delta \\rho = \\rho_R - \\rho_L$, $\\Delta u = u_R - u_L$, and $\\Delta p = p_R - p_L$, the wave strengths $\\alpha_i$ that project $\\Delta \\mathbf{U}$ onto the Roe eigenbasis are derived by solving the linear system given by the eigenvector matrix. A well-tested set of formulas (consistent with the ideal-gas Euler system and Roe averaging) is\n$$\n\\alpha_1 = \\frac{1}{2}\\frac{\\Delta p - \\tilde{\\rho}\\,\\tilde{c}\\,\\Delta u}{\\tilde{c}^2},\\quad\n\\alpha_2 = \\Delta \\rho - \\frac{\\Delta p}{\\tilde{c}^2},\\quad\n\\alpha_3 = \\frac{1}{2}\\frac{\\Delta p + \\tilde{\\rho}\\,\\tilde{c}\\,\\Delta u}{\\tilde{c}^2}.\n$$\nThese expressions follow from matching the jumps in mass, momentum, and energy along the characteristic fields, with $\\tilde{\\rho}$ serving as the Roe density scaling that ensures consistency.\n\nNear transonic states with Mach number $M\\approx 1$, the Roe scheme without an entropy fix can admit non-physical expansion shocks because the absolute values $|\\lambda_1|$ and $|\\lambda_3|$ may vanish or change abruptly as states cross sonic conditions. An entropy fix modifies the viscosity associated with small characteristic speeds to enforce entropy consistency. A common construction is due to Harten and Hyman. For each acoustic eigenvalue $\\lambda\\in\\{\\lambda_1,\\lambda_3\\}$, define a corrected absolute value\n$$\n|\\lambda|_{\\mathrm{corr}} =\n\\begin{cases}\n\\frac{1}{2}\\left(\\frac{\\lambda^2}{\\delta} + \\delta\\right), & \\text{if } |\\lambda| < \\delta,\\\\\n|\\lambda|, & \\text{if } |\\lambda| \\ge \\delta,\n\\end{cases}\n$$\nwith threshold $\\delta\\ge 0$. This function is continuous, non-decreasing in $|\\lambda|$, preserves the sign of $\\lambda$ when reconstructing dissipation, and reduces to the original $|\\lambda|$ for sufficiently large characteristic speeds. Importantly, to preserve the contact wave, this fix is applied only to the acoustic fields, leaving $\\lambda_2=\\tilde{u}$ unchanged. Preserving $\\lambda_2$ maintains the contact-wave speed and ensures that pure contact discontinuities are not inadvertently smeared by an artificial adjustment of the contact characteristic speed.\n\nA pure contact discontinuity has equal velocity and pressure across the interface, but different densities, i.e., $\\Delta u=0$ and $\\Delta p=0$ with $\\Delta \\rho\\ne 0$. Substituting these conditions into the wave strengths shows\n$$\n\\alpha_1 = 0,\\quad \\alpha_3 = 0,\\quad \\alpha_2 = \\Delta \\rho,\n$$\nso only the contact wave is present. Because the entropy fix does not modify $\\lambda_2$, the contact wave speed remains $\\tilde{u}$, and there is no entropy-induced viscosity on the acoustic fields. For a stationary contact ($\\tilde{u}=0$), the numerical viscosity associated with the contact wave vanishes, preserving the discontinuity exactly in the Roe framework; for a moving contact, the Roe solver still introduces contact dissipation proportional to $|\\lambda_2|$, but this is independent of the entropy fix when the fix is restricted to the acoustic fields.\n\nAlgorithmic steps for each test case:\n1. Compute $E_L$, $E_R$, $H_L$, and $H_R$ from the given primitive states and $\\gamma$.\n2. Compute Roe averages $\\tilde{u}$ and $\\tilde{H}$ using density-based weights and $\\tilde{\\rho}=\\sqrt{\\rho_L\\rho_R}$.\n3. Compute the Roe-averaged sound speed $\\tilde{c}$ and the eigenvalues $\\lambda_1$, $\\lambda_2$, $\\lambda_3$.\n4. Apply the Harten–Hyman entropy fix with threshold $\\delta$ to the acoustic eigenvalues only, obtaining $|\\lambda_1|_{\\mathrm{corr}}$ and $|\\lambda_3|_{\\mathrm{corr}}$ as above; leave $\\lambda_2$ unchanged.\n5. For test case $4$ (pure contact), compute $\\alpha_1$ and $\\alpha_3$ and verify they are within $10^{-12}$ of zero; for all cases, verify that $\\lambda_2=\\tilde{u}$ within $10^{-12}$.\n6. Round the corrected absolute acoustic eigenvalues to six decimal places for output.\n\nThe final output aggregates, for test cases $1$–$3$, a boolean for contact-eigenvalue preservation and the list of corrected absolute speeds, and for test case $4$, a boolean for contact-eigenvalue preservation and a boolean for acoustic-strength vanishing. The program prints a single line containing these results as a comma-separated list enclosed in square brackets.",
            "answer": "```python\nimport numpy as np\n\n# Constants\nGAMMA = 1.4\n\ndef primitive_to_conservative(rho, u, p, gamma=GAMMA):\n    E = p / (gamma - 1.0) + 0.5 * rho * u * u\n    return np.array([rho, rho * u, E])\n\ndef sound_speed(rho, p, gamma=GAMMA):\n    return np.sqrt(gamma * p / rho)\n\ndef roe_averages(prim_L, prim_R, gamma=GAMMA):\n    rhoL, uL, pL = prim_L\n    rhoR, uR, pR = prim_R\n    # Conservative variables\n    UL = primitive_to_conservative(rhoL, uL, pL, gamma)\n    UR = primitive_to_conservative(rhoR, uR, pR, gamma)\n    EL, _, EL_tot = UL[0], UL[1], UL[2]\n    ER, _, ER_tot = UR[0], UR[1], UR[2]\n    # Specific total enthalpy H = (E + p)/rho\n    HL = (EL_tot + pL) / rhoL\n    HR = (ER_tot + pR) / rhoR\n    # Roe weights\n    wL = np.sqrt(rhoL)\n    wR = np.sqrt(rhoR)\n    u_tilde = (wL * uL + wR * uR) / (wL + wR)\n    H_tilde = (wL * HL + wR * HR) / (wL + wR)\n    c_tilde = np.sqrt((gamma - 1.0) * (H_tilde - 0.5 * u_tilde * u_tilde))\n    rho_tilde = np.sqrt(rhoL * rhoR)\n    return u_tilde, c_tilde, rho_tilde\n\ndef eigenvalues(u_tilde, c_tilde):\n    lam1 = u_tilde - c_tilde\n    lam2 = u_tilde\n    lam3 = u_tilde + c_tilde\n    return lam1, lam2, lam3\n\ndef harten_hyman_entropy_fix_abs(lam, delta):\n    a = abs(lam)\n    if delta <= 0.0:\n        return a\n    if a < delta:\n        return 0.5 * (a * a / delta + delta)\n    else:\n        return a\n\ndef wave_strengths(prim_L, prim_R, u_tilde, c_tilde, rho_tilde):\n    rhoL, uL, pL = prim_L\n    rhoR, uR, pR = prim_R\n    drho = rhoR - rhoL\n    du = uR - uL\n    dp = pR - pL\n    denom = c_tilde * c_tilde\n    alpha1 = 0.5 * (dp - rho_tilde * c_tilde * du) / denom\n    alpha2 = drho - dp / denom\n    alpha3 = 0.5 * (dp + rho_tilde * c_tilde * du) / denom\n    return alpha1, alpha2, alpha3\n\ndef round6(x):\n    return float(f\"{x:.6f}\")\n\ndef test_case_results(prim_L, prim_R, delta):\n    # Compute Roe averages\n    u_tilde, c_tilde, rho_tilde = roe_averages(prim_L, prim_R)\n    # Eigenvalues\n    lam1, lam2, lam3 = eigenvalues(u_tilde, c_tilde)\n    # Entropy fix applied only to acoustic eigenvalues\n    l1_corr_abs = harten_hyman_entropy_fix_abs(lam1, delta)\n    l3_corr_abs = harten_hyman_entropy_fix_abs(lam3, delta)\n    # Contact preservation check (lambda_2 = u_tilde, unmodified)\n    contact_preserved = np.isclose(lam2, u_tilde, rtol=0.0, atol=1e-12)\n    # For pure contact case, check acoustic strengths vanish\n    alpha1, alpha2, alpha3 = wave_strengths(prim_L, prim_R, u_tilde, c_tilde, rho_tilde)\n    acoustic_strengths_zero = (np.isclose(alpha1, 0.0, rtol=0.0, atol=1e-12) and\n                               np.isclose(alpha3, 0.0, rtol=0.0, atol=1e-12))\n    return contact_preserved, [round6(l1_corr_abs), round6(l3_corr_abs)], acoustic_strengths_zero\n\ndef build_test_cases():\n    gamma = GAMMA\n    # Test case 1: jet-like, no entropy fix (delta=0.0)\n    rhoL1, pL1 = 1.0, 1.0\n    cL1 = sound_speed(rhoL1, pL1, gamma)\n    uL1 = 1.05 * cL1\n    rhoR1, pR1 = 0.8, 1.0\n    cR1 = sound_speed(rhoR1, pR1, gamma)\n    uR1 = 0.3 * cR1\n    prim_L1 = (rhoL1, uL1, pL1)\n    prim_R1 = (rhoR1, uR1, pR1)\n    delta1 = 0.0\n\n    # Test case 2: jet-like, mild entropy fix (delta=0.1)\n    prim_L2 = prim_L1\n    prim_R2 = prim_R1\n    delta2 = 0.1\n\n    # Test case 3: near-transonic straddling with entropy fix\n    rhoL3, pL3 = 1.0, 1.0\n    cL3 = sound_speed(rhoL3, pL3, gamma)\n    uL3 = 1.05 * cL3\n    rhoR3, pR3 = 0.7, 0.7\n    cR3 = sound_speed(rhoR3, pR3, gamma)\n    uR3 = 0.95 * cR3\n    prim_L3 = (rhoL3, uL3, pL3)\n    prim_R3 = (rhoR3, uR3, pR3)\n    delta3 = 0.1\n\n    # Test case 4: pure contact discontinuity\n    prim_L4 = (1.0, 0.3, 1.0)\n    prim_R4 = (2.0, 0.3, 1.0)\n    delta4 = 0.5\n\n    return [\n        (prim_L1, prim_R1, delta1),\n        (prim_L2, prim_R2, delta2),\n        (prim_L3, prim_R3, delta3),\n        (prim_L4, prim_R4, delta4)\n    ]\n\ndef solve():\n    test_cases = build_test_cases()\n    results = []\n    for idx, (prim_L, prim_R, delta) in enumerate(test_cases):\n        contact_preserved, corrected_acoustic, acoustic_strengths_zero = test_case_results(prim_L, prim_R, delta)\n        if idx < 3:\n            # For test cases 1-3: output [contact_preserved, [|lambda_-|_corr, |lambda_+|_corr]]\n            results.append([bool(contact_preserved), corrected_acoustic])\n        else:\n            # For test case 4: output [contact_preserved, acoustic_strengths_zero]\n            results.append([bool(contact_preserved), bool(acoustic_strengths_zero)])\n    # Print in the exact required format: single line as a comma-separated list enclosed in square brackets\n    print(str(results).replace(\" \", \"\"))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}