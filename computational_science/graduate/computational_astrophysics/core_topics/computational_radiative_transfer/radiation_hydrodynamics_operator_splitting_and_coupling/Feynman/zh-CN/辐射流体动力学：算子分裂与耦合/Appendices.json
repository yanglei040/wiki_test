{
    "hands_on_practices": [
        {
            "introduction": "算子分裂方法常将刚性的物质-辐射能量交换过程分离成一个独立的子步骤，这一步需要使用隐式求解器。本练习  提供了一个单步牛顿-拉弗森（Newton-Raphson）更新的具体例子，这是此类求解器的核心。通过这个练习，学生可以实践线性化和求解该系统的力学过程，从而加深对隐式方法的理解。",
            "id": "3530860",
            "problem": "在算子分裂下的灰色辐射流体动力学 (RHD) 中，单个计算网格内的刚性物质-辐射能量交换在一个时间步内进行隐式推进。设耦合的未知数为辐射能量密度 $E_{r}$ 和气体温度 $T$。在隐式源项求解的牛顿-拉夫逊 (NR) 迭代第 $k$ 次时，非线性残差向量 $\\mathbf{R}(E_{r},T)$ 及其雅可比矩阵 $\\mathbf{J}(E_{r},T)$ 已经在当前迭代点 $(E_{r}^{(k)},T^{(k)})$ 处组装好。\n\n假设在某个特定的网格和迭代中，给定\n$$\n\\mathbf{R}\\big(E_{r}^{(k)},T^{(k)}\\big)\n=\n\\begin{pmatrix}\n2.0\\times 10^{10} \\\\\n-1.0\\times 10^{11}\n\\end{pmatrix}\n\\quad\\text{和}\\quad\n\\mathbf{J}\\big(E_{r}^{(k)},T^{(k)}\\big)\n=\n\\begin{pmatrix}\n101  -3.024\\times 10^{6} \\\\\n-100  1.3024\\times 10^{7}\n\\end{pmatrix},\n$$\n当前迭代点为\n$$\nE_{r}^{(k)} = 1.0\\times 10^{12}, \\qquad T^{(k)} = 1.0\\times 10^{6}.\n$$\n在这里，$\\mathbf{R}$ 的所有分量的单位都是 $\\mathrm{erg}\\,\\mathrm{cm}^{-3}$，$\\mathbf{J}$ 的第一列的单位与 $\\partial \\mathbf{R}/\\partial E_{r}$ 一致，第二列的单位与 $\\partial \\mathbf{R}/\\partial T$ 一致。\n\n使用隐式源项方程的牛顿-拉夫逊线性化，计算一个牛顿步更新向量 $\\Delta \\mathbf{U} = \\big(\\Delta E_{r},\\,\\Delta T\\big)$，该向量将 $(E_{r}^{(k)},T^{(k)})$ 推进到 $(E_{r}^{(k+1)},T^{(k+1)}) = (E_{r}^{(k)},T^{(k)}) + \\Delta \\mathbf{U}$。报告分量 $\\Delta E_{r}$ 和 $\\Delta T$ 的值，四舍五入到四位有效数字。将 $\\Delta E_{r}$ 以 $\\mathrm{erg}\\,\\mathrm{cm}^{-3}$ 为单位表示，$\\Delta T$ 以 $\\mathrm{K}$ 为单位表示。\n\n然后，陈述适用于 RHD 中刚性源项耦合的数学上精确的收敛准则，该准则使用基于物理动机的缩放来同时控制残差和更新步长的大小，并强制保证 $E_{r}^{(k+1)}$ 和 $T^{(k+1)}$ 的正性。你的准则应该用范数来表述，并清楚地指明绝对和相对容差，但你不需要为这些容差赋予定量值。\n\n按要求将报告的 $\\Delta E_{r}$ 和 $\\Delta T$ 四舍五入到四位有效数字。",
            "solution": "用户要求我解决一个与计算天体物理学背景下的牛顿-拉夫逊更新步相关的问题。\n\n### 步骤 1：提取给定条件\n-   当前迭代状态向量：$(E_{r}^{(k)}, T^{(k)})$，其中 $E_{r}^{(k)} = 1.0 \\times 10^{12}$ 且 $T^{(k)} = 1.0 \\times 10^{6}$。\n-   当前迭代点的残差向量：\n    $$\n    \\mathbf{R}\\big(E_{r}^{(k)},T^{(k)}\\big)\n    =\n    \\begin{pmatrix}\n    2.0\\times 10^{10} \\\\\n    -1.0\\times 10^{11}\n    \\end{pmatrix}\n    $$\n-   当前迭代点的雅可比矩阵：\n    $$\n    \\mathbf{J}\\big(E_{r}^{(k)},T^{(k)}\\big)\n    =\n    \\begin{pmatrix}\n    101  -3.024\\times 10^{6} \\\\\n    -100  1.3024\\times 10^{7}\n    \\end{pmatrix}\n    $$\n-   $\\mathbf{R}$ 的单位是 $\\mathrm{erg}\\,\\mathrm{cm}^{-3}$。$\\mathbf{J}$ 各列的单位与 $\\mathbf{R}$ 分别对 $E_r$ 和 $T$ 的偏导数一致。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题具有科学依据，是牛顿-拉夫逊方法的直接应用，这是一种在包括辐射流体动力学在内的许多科学和工程领域中用于求解非线性方程组的标准数值技术。该问题是适定的；它要求解一个 $2 \\times 2$ 线性系统，只要雅可比矩阵非奇异，就存在唯一解。该问题是客观的，并提供了计算所需更新向量的所有必要数据。这些量及其量级对于天体物理场景（例如，恒星内部或吸积盘）是合理的。问题的第二部分，关于收敛准则，是数值分析中的一个标准概念性问题。该问题是自洽的，一致的，并且没有说明中列出的无效缺陷。\n\n### 步骤 3：结论与行动\n该问题有效。我将继续进行解答。\n\n牛顿-拉夫逊方法是用于求解非线性方程组 $\\mathbf{F}(\\mathbf{U}) = \\mathbf{0}$ 根的迭代过程。给定一个迭代点 $\\mathbf{U}^{(k)}$，下一个迭代点 $\\mathbf{U}^{(k+1)}$ 通过求解在 $\\mathbf{U}^{(k)}$ 处对 $\\mathbf{F}$ 的切线近似所代表的线性系统来找到。在隐式时间积分方案的背景下，需要归零的函数是残差 $\\mathbf{R}(\\mathbf{U}) = \\mathbf{0}$。更新步 $\\Delta \\mathbf{U} = \\mathbf{U}^{(k+1)} - \\mathbf{U}^{(k)}$ 通过求解以下线性系统来找到：\n$$\n\\mathbf{J}(\\mathbf{U}^{(k)}) \\Delta \\mathbf{U} = -\\mathbf{R}(\\mathbf{U}^{(k)})\n$$\n其中 $\\mathbf{J}$ 是在 $\\mathbf{U}^{(k)}$ 处计算的 $\\mathbf{R}$ 的雅可比矩阵。状态向量是 $\\mathbf{U} = (E_r, T)^T$。\n\n我们被要求计算更新向量 $\\Delta \\mathbf{U} = (\\Delta E_r, \\Delta T)^T$。\n线性系统是：\n$$\n\\begin{pmatrix}\n101  -3.024\\times 10^{6} \\\\\n-100  1.3024\\times 10^{7}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\Delta E_{r} \\\\\n\\Delta T\n\\end{pmatrix}\n=\n-\n\\begin{pmatrix}\n2.0\\times 10^{10} \\\\\n-1.0\\times 10^{11}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-2.0\\times 10^{10} \\\\\n1.0\\times 10^{11}\n\\end{pmatrix}\n$$\n为了求解这个 $2 \\times 2$ 系统，我们可以使用矩阵求逆公式。对于一个矩阵 $\\mathbf{A} = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆矩阵为 $\\mathbf{A}^{-1} = \\frac{1}{\\det(\\mathbf{A})} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n首先，我们计算雅可比矩阵 $\\mathbf{J}$ 的行列式：\n$$\n\\det(\\mathbf{J}) = (101)(1.3024\\times 10^{7}) - (-3.024\\times 10^{6})(-100)\n$$\n$$\n\\det(\\mathbf{J}) = 1.315424\\times 10^{9} - 3.024\\times 10^{8}\n$$\n$$\n\\det(\\mathbf{J}) = 13.15424\\times 10^{8} - 3.024\\times 10^{8} = 10.13024\\times 10^{8} = 1.013024\\times 10^{9}\n$$\n由于行列式非零，该矩阵可逆，因此存在 $\\Delta\\mathbf{U}$ 的唯一解。\n现在我们可以求解更新向量 $\\Delta \\mathbf{U} = \\mathbf{J}^{-1} (-\\mathbf{R})$：\n$$\n\\begin{pmatrix}\n\\Delta E_{r} \\\\\n\\Delta T\n\\end{pmatrix}\n=\n\\frac{1}{1.013024\\times 10^{9}}\n\\begin{pmatrix}\n1.3024\\times 10^{7}  3.024\\times 10^{6} \\\\\n100  101\n\\end{pmatrix}\n\\begin{pmatrix}\n-2.0\\times 10^{10} \\\\\n1.0\\times 10^{11}\n\\end{pmatrix}\n$$\n我们分别计算分量 $\\Delta E_r$ 和 $\\Delta T$。\n对于 $\\Delta E_r$：\n$$\n\\Delta E_r = \\frac{ (1.3024\\times 10^{7})(-2.0\\times 10^{10}) + (3.024\\times 10^{6})(1.0\\times 10^{11}) }{1.013024\\times 10^{9}}\n$$\n$$\n\\Delta E_r = \\frac{ -2.6048\\times 10^{17} + 3.024\\times 10^{17} }{1.013024\\times 10^{9}}\n$$\n$$\n\\Delta E_r = \\frac{ 0.4192\\times 10^{17} }{1.013024\\times 10^{9}} = \\frac{ 4.192\\times 10^{16} }{1.013024\\times 10^{9}} \\approx 4.13813 \\times 10^7\n$$\n四舍五入到四位有效数字，我们得到 $\\Delta E_r \\approx 4.138 \\times 10^{7} \\, \\mathrm{erg}\\,\\mathrm{cm}^{-3}$。\n\n对于 $\\Delta T$：\n$$\n\\Delta T = \\frac{ (100)(-2.0\\times 10^{10}) + (101)(1.0\\times 10^{11}) }{1.013024\\times 10^{9}}\n$$\n$$\n\\Delta T = \\frac{ -2.0\\times 10^{12} + 10.1\\times 10^{12} }{1.013024\\times 10^{9}}\n$$\n$$\n\\Delta T = \\frac{ 8.1\\times 10^{12} }{1.013024\\times 10^{9}} \\approx 7995.89 \\, \\mathrm{K}\n$$\n四舍五入到四位有效数字，我们得到 $\\Delta T \\approx 7996 \\, \\mathrm{K}$，或 $7.996 \\times 10^{3} \\, \\mathrm{K}$。\n\n问题的第二部分要求给出适用于此背景的数学上精确的收敛准则。对于一个刚性的耦合系统，收敛准则必须是鲁棒的。它们通常涉及监测残差的大小（方程被满足的程度）和更新步长的大小（解仍在变化的程度）。基于物理动机的缩放是必不可少的，因为变量（$E_r$ 和 $T$）具有不同的单位，并且可以跨越许多数量级。正性是一个关键的物理约束。\n\n令 $\\mathbf{U}^{(k)} = (E_r^{(k)}, T^{(k)})^T$ 为迭代 k 次时的状态，$\\Delta\\mathbf{U}^{(k)} = \\mathbf{U}^{(k+1)} - \\mathbf{U}^{(k)}$ 为更新量。令 $\\epsilon_{r}$ 为用户定义的相对容差，$\\epsilon_{abs,E_r}$、$\\epsilon_{abs,T}$ 和 $\\epsilon_{abs,R}$ 为用户定义的绝对容差。当同时满足以下条件时，迭代过程被认为收敛：\n\n1.  **更新步长准则：** 每个变量的变化量与其值相比很小。这表明解已经稳定。混合的相对-绝对误差准则是鲁棒的：\n    $$\n    |\\Delta E_r^{(k)}| \\le \\epsilon_{r} E_r^{(k+1)} + \\epsilon_{abs,E_r}\n    $$\n    $$\n    |\\Delta T^{(k)}| \\le \\epsilon_{r} T^{(k+1)} + \\epsilon_{abs,T}\n    $$\n    这对解向量的每个分量进行检查。绝对容差项可防止当解分量接近于零时停滞。\n\n2.  **残差大小准则：** 残差向量 $\\mathbf{R}(\\mathbf{U}^{(k+1)})$ 接近于零，表明新状态 $\\mathbf{U}^{(k+1)}$ 近似地求解了非线性方程。由于 $\\mathbf{R}$ 的分量（例如 $R_{E_r}$ 和 $R_T$）具有能量密度的单位，它们应与网格中的特征能量密度进行比较。一个合适的尺度是辐射能量密度 $E_r$ 或辐射与气体能量密度之和。将 $E_r$ 作为两者的共同尺度是一种常见的简化方法。\n    $$\n    |R_{E_r}(\\mathbf{U}^{(k+1)})| \\le \\epsilon_{r} E_r^{(k+1)} + \\epsilon_{abs,R}\n    $$\n    $$\n    |R_T(\\mathbf{U}^{(k+1)})| \\le \\epsilon_{r} E_r^{(k+1)} + \\epsilon_{abs,R}\n    $$\n    对更新和残差准则使用相同的相对容差 $\\epsilon_r$ 是常见做法，但也可以使用不同的容差。\n\n3.  **正性强制：** 物理量 $E_r$ 和 $T$ 必须保持正值。牛顿-拉夫逊步可能会过冲并产生负的、非物理的值。这不是一个收敛性测试，而是一个必须在每次迭代中强制执行的约束。这通常通过阻尼牛顿步来实现。如果完整的牛顿步 $\\Delta\\mathbf{U}_{NR} = -\\mathbf{J}^{-1}\\mathbf{R}$ 导致负状态，即 $E_r^{(k)} + \\Delta E_{r,NR} \\le 0$ 或 $T^{(k)} + \\Delta T_{NR} \\le 0$，则更新量会乘以一个因子 $\\alpha \\in (0, 1)$，使得 $\\Delta \\mathbf{U}^{(k)} = \\alpha \\Delta \\mathbf{U}_{NR}$。选择因子 $\\alpha$ 为能保持所有分量正性的最大值，通常带有一个小的安全裕度：\n    $$\n    E_r^{(k+1)} = E_r^{(k)} + \\Delta E_r^{(k)} > 0\n    $$\n    $$\n    T^{(k+1)} = T^{(k)} + \\Delta T^{(k)} > 0\n    $$\n    一个收敛的解必须内在地满足这种正性。只有对于物理上有效的状态，才能宣布收敛。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.138 \\times 10^{7}  7.996 \\times 10^{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在不同光学深度下准确地模拟辐射输运是一个关键挑战。本练习  探讨了通量限制扩散（Flux-Limited Diffusion, FLD）方法，这是一种广泛使用的近似。通过计算一个界面上的通量并分析其极限行为，学生将深入理解 FLD 方法如何连接光学厚和光学薄这两种物理状态。",
            "id": "3530849",
            "problem": "考虑一个用于辐射流体力学的一维均匀笛卡尔网格，其中辐射能量密度 $E_{r}$ 存储在间距为 $\\Delta x$ 的网格中心 $x_{i}$ 处。在算子分裂辐射更新中，需要界面处的辐射通量 $F_{r}$ 来将辐射与气体耦合。假设为各向同性灰色不透明度，质量吸收系数为 $\\kappa$，质量密度为 $\\rho$，并采用通量限制扩散 (FLD) 闭合，其中光深参数 $R$ 定义为 $R = \\frac{|\\nabla E_{r}|}{\\kappa \\rho E_{r}}$。使用由 $\\lambda(R) = \\frac{2 + R}{6 + 3 R + R^{2}}$ 定义的 Levermore–Pomraning 通量限制器 $\\lambda(R)$，以及与辐射矩方程和闭合关系一致的辐射通量标准 FLD 形式。\n\n在网格单元 $i$ 和 $i+1$ 之间的界面 $x_{i+\\frac{1}{2}}$ 上，辐射能量密度通过算术平均 $E_{r,\\mathrm{int}} = \\frac{E_{r,i} + E_{r,i+1}}{2}$ 近似，离散梯度通过中心差分 $\\nabla E_{r}\\big|_{i+\\frac{1}{2}} \\approx \\frac{E_{r,i+1} - E_{r,i}}{\\Delta x}$ 近似。取光速为 $c$。网格和材料参数如下：\n- $E_{r,i} = 1.0 \\times 10^{5}$ 单位 $\\mathrm{erg}\\,\\mathrm{cm}^{-3}$，\n- $E_{r,i+1} = 8.0 \\times 10^{4}$ 单位 $\\mathrm{erg}\\,\\mathrm{cm}^{-3}$，\n- $\\Delta x = 1.0 \\times 10^{7}$ 单位 $\\mathrm{cm}$，\n- $\\kappa = 0.34$ 单位 $\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$，\n- $\\rho = 1.0 \\times 10^{-7}$ 单位 $\\mathrm{g}\\,\\mathrm{cm}^{-3}$，\n- $c = 3.0 \\times 10^{10}$ 单位 $\\mathrm{cm}\\,\\mathrm{s}^{-1}$。\n\n从带有 FLD 闭合的辐射矩方程出发，推导离散界面辐射通量 $F_{r,i+\\frac{1}{2}}$ 并使用上述数据进行数值计算。然后，仅使用 $R$ 和 $\\lambda(R)$ 的定义以及与 FLD 闭合相关的极限行为，推导在扩散极限 $R \\to 0$ 和自由流极限 $R \\to \\infty$ 下的极限辐射通量的闭式表达式，用 $\\kappa$、$\\rho$、 $c$、$\\Delta x$ 和 $E_{r}$ 的离散值表示。将计算出的界面通量以 $\\mathrm{erg}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$ 为单位表示，并将您的数值结果四舍五入到四位有效数字。",
            "solution": "用户要求我解决一个辐射流体力学领域的数值问题。我必须首先验证问题陈述。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- 背景是用于辐射流体力学的一维均匀笛卡尔网格。\n- 辐射能量密度 $E_r$ 存储在间距为 $\\Delta x$ 的网格中心 $x_i$ 处。\n- 不透明度是各向同性灰色的，具有质量吸收系数 $\\kappa$ 和质量密度 $\\rho$。\n- 闭合方案是通量限制扩散 (FLD)。\n- 光深参数定义为 $R = \\frac{|\\nabla E_{r}|}{\\kappa \\rho E_{r}}$。\n- Levermore–Pomraning 通量限制器为 $\\lambda(R) = \\frac{2 + R}{6 + 3 R + R^{2}}$。\n- 在界面 $x_{i+\\frac{1}{2}}$ 处，辐射能量密度通过算术平均近似：$E_{r,\\mathrm{int}} = \\frac{E_{r,i} + E_{r,i+1}}{2}$。\n- 在界面 $x_{i+\\frac{1}{2}}$ 处，离散梯度为中心差分：$\\nabla E_{r}\\big|_{i+\\frac{1}{2}} \\approx \\frac{E_{r,i+1} - E_{r,i}}{\\Delta x}$。\n- 光速为 $c$。\n- 网格和材料参数：\n    - $E_{r,i} = 1.0 \\times 10^{5} \\, \\mathrm{erg}\\,\\mathrm{cm}^{-3}$\n    - $E_{r,i+1} = 8.0 \\times 10^{4} \\, \\mathrm{erg}\\,\\mathrm{cm}^{-3}$\n    - $\\Delta x = 1.0 \\times 10^{7} \\, \\mathrm{cm}$\n    - $\\kappa = 0.34 \\, \\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$\n    - $\\rho = 1.0 \\times 10^{-7} \\, \\mathrm{g}\\,\\mathrm{cm}^{-3}$\n    - $c = 3.0 \\times 10^{10} \\, \\mathrm{cm}\\,\\mathrm{s}^{-1}$\n\n任务是：\n1.  推导离散界面辐射通量 $F_{r,i+\\frac{1}{2}}$ 并进行数值计算。\n2.  推导在扩散极限（$R \\to 0$）和自由流极限（$R \\to \\infty$）下的极限辐射通量的闭式表达式。\n3.  将最终数值结果四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它基于计算天体物理学中成熟的通量限制扩散（FLD）方法。方程、定义（$\\lambda(R)$, $R$）和数值近似（算术平均、中心差分）在该领域都是标准的。该问题是适定的；它提供了所有必要的数据和一组明确的任务，可以导出一个唯一的解。给定的数值对于某些天体物理环境（例如，恒星包层或吸积盘）是物理上合理的。该问题是客观的，没有歧义或矛盾。因此，该问题是有效的。\n\n### 步骤3：结论与行动\n该问题有效。我现在开始进行求解。\n\n###\n在通量限制扩散（FLD）近似中，辐射通量 $\\mathbf{F}_r$ 的基本方程由菲克扩散定律给出，其中扩散系数由通量限制器 $\\lambda$ 修正：\n$$\n\\mathbf{F}_r = -D \\nabla E_r = -\\frac{c \\lambda(R)}{\\kappa \\rho} \\nabla E_r\n$$\n在这里，$E_r$ 是辐射能量密度，$c$ 是光速，$\\kappa$ 是质量吸收系数，$\\rho$ 是质量密度，$\\lambda(R)$ 是通量限制器，它依赖于无量纲参数 $R = \\frac{|\\nabla E_{r}|}{\\kappa \\rho E_{r}}$。\n\n问题要求计算网格单元 $i$ 和 $i+1$ 之间界面 $x_{i+\\frac{1}{2}}$ 处的通量。我们将使用提供的离散近似来计算该界面上的各物理量。\n\n**1. 界面通量 $F_{r,i+\\frac{1}{2}}$ 的数值计算**\n\n首先，我们计算评估通量所需的各项。问题指定的是一维网格，因此通量 $F_{r,i+\\frac{1}{2}}$ 是一个标量。\n\n界面处辐射能量密度的梯度由中心差分近似：\n$$\n\\nabla E_{r}\\big|_{i+\\frac{1}{2}} \\approx \\frac{E_{r,i+1} - E_{r,i}}{\\Delta x}\n$$\n代入给定值：\n$$\n\\nabla E_{r}\\big|_{i+\\frac{1}{2}} = \\frac{8.0 \\times 10^{4} - 1.0 \\times 10^{5}}{1.0 \\times 10^{7}} = \\frac{-2.0 \\times 10^{4}}{1.0 \\times 10^{7}} = -2.0 \\times 10^{-3} \\, \\mathrm{erg}\\,\\mathrm{cm}^{-4}\n$$\n梯度的量值为 $|\\nabla E_{r}|_{i+\\frac{1}{2}} = 2.0 \\times 10^{-3} \\, \\mathrm{erg}\\,\\mathrm{cm}^{-4}$。\n\n接下来，我们使用算术平均来评估界面处的辐射能量密度：\n$$\nE_{r,i+\\frac{1}{2}} = \\frac{E_{r,i} + E_{r,i+1}}{2} = \\frac{1.0 \\times 10^{5} + 8.0 \\times 10^{4}}{2} = \\frac{1.8 \\times 10^{5}}{2} = 9.0 \\times 10^{4} \\, \\mathrm{erg}\\,\\mathrm{cm}^{-3}\n$$\n\n现在我们可以计算界面处的无量纲参数 $R$：\n$$\nR_{i+\\frac{1}{2}} = \\frac{|\\nabla E_{r}|_{i+\\frac{1}{2}}}{(\\kappa \\rho E_{r})_{i+\\frac{1}{2}}} = \\frac{|\\nabla E_{r}|_{i+\\frac{1}{2}}}{\\kappa \\rho E_{r,i+\\frac{1}{2}}}\n$$\n乘积 $\\kappa \\rho$ 为：\n$$\n\\kappa \\rho = (0.34 \\, \\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}) \\times (1.0 \\times 10^{-7} \\, \\mathrm{g}\\,\\mathrm{cm}^{-3}) = 3.4 \\times 10^{-8} \\, \\mathrm{cm}^{-1}\n$$\n将数值代入 $R_{i+\\frac{1}{2}}$ 的表达式：\n$$\nR_{i+\\frac{1}{2}} = \\frac{2.0 \\times 10^{-3}}{ (3.4 \\times 10^{-8}) \\times (9.0 \\times 10^{4}) } = \\frac{2.0 \\times 10^{-3}}{3.06 \\times 10^{-3}} \\approx 0.65359477\n$$\n\n有了 $R$ 的值，我们可以使用给定的 Levermore–Pomraning 公式来求出通量限制器 $\\lambda(R)$：\n$$\n\\lambda(R) = \\frac{2 + R}{6 + 3R + R^2}\n$$\n$$\n\\lambda(R_{i+\\frac{1}{2}}) = \\frac{2 + 0.65359477}{6 + 3(0.65359477) + (0.65359477)^2} = \\frac{2.65359477}{6 + 1.96078431 + 0.42718615} = \\frac{2.65359477}{8.38797046} \\approx 0.3163560\n$$\n\n最后，我们计算界面处的辐射通量 $F_{r,i+\\frac{1}{2}}$：\n$$\nF_{r,i+\\frac{1}{2}} = -\\frac{c \\lambda(R_{i+\\frac{1}{2}})}{\\kappa \\rho} \\nabla E_{r}\\big|_{i+\\frac{1}{2}}\n$$\n代入所有计算出的数值：\n$$\nF_{r,i+\\frac{1}{2}} = -\\frac{(3.0 \\times 10^{10}) \\times (0.3163560)}{3.4 \\times 10^{-8}} \\times (-2.0 \\times 10^{-3})\n$$\n两个负号相消，得到一个正的通量，这在物理上是正确的，因为能量从能量密度较高的单元（$i$）流向能量密度较低的单元（$i+1$）：\n$$\nF_{r,i+\\frac{1}{2}} = \\frac{(3.0 \\times 10^{10}) \\times (0.3163560) \\times (2.0 \\times 10^{-3})}{3.4 \\times 10^{-8}} = \\frac{1.898136 \\times 10^{7}}{3.4 \\times 10^{-8}} \\approx 5.58275 \\times 10^{14} \\, \\mathrm{erg}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}\n$$\n按照要求四舍五入到四位有效数字，我们得到：\n$$\nF_{r,i+\\frac{1}{2}} = 5.583 \\times 10^{14} \\, \\mathrm{erg}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}\n$$\n\n**2. 极限通量表达式的推导**\n\n现在我们推导在扩散极限和自由流极限下的通量表达式。\n\n**a) 扩散极限 ($R \\to 0$)**\n扩散极限对应于光学厚介质，其中辐射能量的梯度相对于能量密度本身很小。我们考察通量限制器 $\\lambda(R)$ 在 $R \\to 0$ 时的行为：\n$$\n\\lim_{R \\to 0} \\lambda(R) = \\lim_{R \\to 0} \\frac{2 + R}{6 + 3R + R^2} = \\frac{2+0}{6+0+0} = \\frac{1}{3}\n$$\n在此极限下，通量限制器变为常数爱丁顿因子 $1/3$。辐射通量，我们记作 $F_{r,i+\\frac{1}{2}}^{(\\text{diff})}$，变为：\n$$\nF_{r,i+\\frac{1}{2}}^{(\\text{diff})} = -\\frac{c (1/3)}{\\kappa \\rho} \\nabla E_{r}\\big|_{i+\\frac{1}{2}} = -\\frac{c}{3 \\kappa \\rho} \\frac{E_{r,i+1} - E_{r,i}}{\\Delta x}\n$$\n这是扩散近似中辐射通量的标准表达式。\n\n**b) 自由流极限 ($R \\to \\infty$)**\n自由流极限对应于光学薄介质，其中光子几乎不受阻碍地传播。在这种情况下，$|\\nabla E_r|$ 很大。为了找到极限通量，我们考察乘积 $R \\lambda(R)$ 在 $R \\to \\infty$ 时的行为：\n$$\nR \\lambda(R) = R \\left( \\frac{2 + R}{6 + 3R + R^2} \\right) = \\frac{2R + R^2}{6 + 3R + R^2}\n$$\n通过将分子和分母除以 $R^2$ 来取 $R \\to \\infty$ 的极限：\n$$\n\\lim_{R \\to \\infty} R \\lambda(R) = \\lim_{R \\to \\infty} \\frac{2/R + 1}{6/R^2 + 3/R + 1} = \\frac{0+1}{0+0+1} = 1\n$$\n现在，让我们用 $R \\lambda(R)$ 来重写通量表达式。通量的量值为：\n$$\n|F_r| = \\left|-\\frac{c \\lambda(R)}{\\kappa \\rho} \\nabla E_r\\right| = \\frac{c \\lambda(R)}{\\kappa \\rho} |\\nabla E_r|\n$$\n使用 $R$ 的定义，我们有 $|\\nabla E_r| = R \\kappa \\rho E_r$。将其代入：\n$$\n|F_r| = \\frac{c \\lambda(R)}{\\kappa \\rho} (R \\kappa \\rho E_r) = c (R \\lambda(R)) E_r\n$$\n在 $R \\to \\infty$ 的极限下，通量的量值变为：\n$$\n\\lim_{R \\to \\infty} |F_r| = c \\left( \\lim_{R \\to \\infty} R \\lambda(R) \\right) E_r = c \\times 1 \\times E_r = c E_r\n$$\n通量矢量 $\\mathbf{F}_r$ 的方向与梯度 $\\nabla E_r$ 的方向相反。所以，$\\mathbf{F}_r = -|F_r| \\frac{\\nabla E_r}{|\\nabla E_r|}$。\n极限通量矢量为 $\\mathbf{F}_{r}^{(\\text{stream})} = -c E_r \\frac{\\nabla E_r}{|\\nabla E_r|}$。\n使用界面 $x_{i+\\frac{1}{2}}$ 处的离散近似：\n$$\nE_r \\to E_{r,i+\\frac{1}{2}} = \\frac{E_{r,i} + E_{r,i+1}}{2}\n$$\n$$\n\\frac{\\nabla E_r}{|\\nabla E_r|} \\to \\frac{(E_{r,i+1} - E_{r,i})/\\Delta x}{|(E_{r,i+1} - E_{r,i})/\\Delta x|} = \\frac{E_{r,i+1} - E_{r,i}}{|E_{r,i+1} - E_{r,i}|}\n$$\n将这些结合起来，界面通量的自由流极限为：\n$$\nF_{r,i+\\frac{1}{2}}^{(\\text{stream})} = -c \\left(\\frac{E_{r,i} + E_{r,i+1}}{2}\\right) \\frac{E_{r,i+1} - E_{r,i}}{|E_{r,i+1} - E_{r,i}|}\n$$\n这个表达式正确地捕捉了物理过程：辐射以光速传播，其量值与局部能量密度成正比，从高能量密度区域流向低能量密度区域。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.583 \\times 10^{14} & -\\frac{c}{3 \\kappa \\rho} \\frac{E_{r,i+1} - E_{r,i}}{\\Delta x} & -c \\left(\\frac{E_{r,i} + E_{r,i+1}}{2}\\right) \\frac{E_{r,i+1} - E_{r,i}}{|E_{r,i+1} - E_{r,i}|}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "数值方法，尤其是在处理强冷却过程时，有时会产生非物理的结果，例如负温度。本练习  直面这种“冷却灾难”问题。学生将推导出现这种失效的条件，并设计一个限制器来强制实施正定性这一物理约束，这是开发稳健模拟代码的一项关键技能。",
            "id": "3530807",
            "problem": "考虑一个单区辐射流体力学 (RHD) 算子分裂更新，其中流体力学平流步已经完成，在时间 $t^{n}$ 产生了一个临时温度 $T^{n}$。在随后的源项步中，单位质量内能 $e$ 仅因光学薄辐射冷却在一个时间增量 $\\Delta t$ 内演化，该冷却过程由温度幂律建模。假设存在以下物理上标准的关系和闭合关系：\n- 单位质量内能通过 $e = c_{v}\\,T$ 与温度成线性比例，其中 $c_{v}$ 是一个严格为正的定容比热常数。\n- 单位质量冷却源项为 $S(T) = C\\,T^{\\alpha}$，其中 $C>0$ 且指数 $\\alpha$ 为实数，因此在源项步中 $\\mathrm{d}e/\\mathrm{d}t = -S(T)$。\n- 在源项步中，密度和组分是冻结的（与算子分裂一致），因此 $c_{v}$ 和 $C$ 是常数。\n\n为避免昂贵的非线性求解，许多实用代码使用关于 $T^{n}$ 的 $S(T)$ 的一阶泰勒线性化，通过隐式后向欧拉离散来更新源项步：\n$$\nc_{v}\\,T^{n+1} = c_{v}\\,T^{n} - \\Delta t\\,\\big(S(T^{n}) + S'(T^{n})\\,(T^{n+1}-T^{n})\\big),\n$$\n其中 $S'(T)$ 表示 $S(T)$ 对 $T$ 的导数。此更新以分裂方式使用：首先是流体力学步，然后是上述源项步。\n\n从基本能量演化定律和所述模型假设出发，完成以下任务：\n1. 根据 $\\alpha$、$c_{v}$、$C$、$\\Delta t$ 和 $T^{n}$，确定线性化隐式源项步何时会产生负的更新温度 $T^{n+1} < 0$（“冷却灾难”过冲），并解释这种失效模式的物理和数学根源。\n2. 提出一个保正限制器，该限制器仅重缩放源项步内的冷却减量，与分裂更新兼容（即不改变流体力学阶段），并在步长足够小时恢复为未修改的隐式更新。具体来说，定义一个应用于冷却减量的标量限制器因子 $\\varphi \\in (0,1]$，使得 $T^{n+1}_{\\mathrm{lim}} = T^{n} - \\varphi\\,\\delta T$，其中 $\\delta T$ 是线性化隐式源项步预测的温度下降值。推导 $\\varphi$ 关于 $\\alpha$、$c_{v}$、$C$、$\\Delta t$ 和 $T^{n}$ 的闭式表达式，以保证 $T^{n+1}_{\\mathrm{lim}} \\ge 0$，同时在 $\\Delta t \\to 0$ 时保持一阶相容性。\n\n你的最终答案必须仅为限制器因子 $\\varphi(\\alpha,c_{v},C,\\Delta t,T^{n})$ 的单个闭式解析表达式。不要在最终的方框结果中包含任何不等式或方程。不需要进行数值评估。",
            "solution": "首先根据指定标准验证问题。\n\n### 步骤 1：提取已知条件\n-   单位质量内能 $e$ 的演化：在源项步中 $\\mathrm{d}e/\\mathrm{d}t = -S(T)$。\n-   状态方程：$e = c_{v}\\,T$，其中 $c_{v} > 0$ 是一个定容比热常数。\n-   冷却源项：$S(T) = C\\,T^{\\alpha}$，其中 $C>0$ 且 $\\alpha$ 为实数指数。\n-   密度和组分是常数，因此 $c_{v}$ 和 $C$ 是常数。\n-   源项步开始时的临时温度是 $T^{n}$。时间增量 $\\Delta t$ 结束时的更新温度是 $T^{n+1}$。\n-   线性化隐式后向欧拉离散由下式给出：\n    $$\n    c_{v}\\,T^{n+1} = c_{v}\\,T^{n} - \\Delta t\\,\\big(S(T^{n}) + S'(T^{n})\\,(T^{n+1}-T^{n})\\big)\n    $$\n    其中 $S'(T) = \\mathrm{d}S/\\mathrm{d}T$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学基础：** 该问题描述了在处理刚性源项（如辐射冷却）时，使用算子分裂方法在数值天体物理学和计算流体力学中一个标准的、众所周知的问题。冷却定律的形式 $S(T) \\propto T^{\\alpha}$ 是各种物理体系（例如，韧致辐射、原子线冷却）的常见近似。线性化隐式更新是一种广泛使用的技术。该问题在科学上是现实的，并以偏微分方程数值方法的原理为基础。\n-   **适定的：** 问题陈述清晰，要求进行两项具体推导：（1）数值失效的条件和（2）一个修正限制器。所提供的信息足以推导出这些结果。存在一个唯一的、有意义的解。\n-   **客观的：** 语言精确，没有主观或偏颇的陈述。所有术语在该领域内都是标准的。\n-   **其他缺陷：** 该问题不存在任何其他列出的缺陷。它不是不健全、不可形式化、不完整、矛盾、不现实、不适定、伪深刻或不可验证的。它是应用数学中一个具体的、与其所述领域相关的问题。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。将提供完整解答。\n\n### 解答推导\n\n根据要求，分析分两部分进行。\n\n#### 第 1 部分：负温度过冲的条件\n\n出发点是给定的线性化隐式更新方程：\n$$\nc_{v}\\,T^{n+1} = c_{v}\\,T^{n} - \\Delta t\\,\\big(S(T^{n}) + S'(T^{n})\\,(T^{n+1}-T^{n})\\big)\n$$\n这是一个关于未知更新温度 $T^{n+1}$ 的线性方程。我们首先求解 $T^{n+1}$ 以分析其性质。\n$$\nc_{v}\\,T^{n+1} = c_{v}\\,T^{n} - \\Delta t\\,S(T^{n}) - \\Delta t\\,S'(T^{n})\\,T^{n+1} + \\Delta t\\,S'(T^{n})\\,T^{n}\n$$\n将包含 $T^{n+1}$ 的项收集到左侧：\n$$\nT^{n+1}\\,(c_{v} + \\Delta t\\,S'(T^{n})) = T^{n}\\,(c_{v} + \\Delta t\\,S'(T^{n})) - \\Delta t\\,S(T^{n})\n$$\n求解 $T^{n+1}$：\n$$\nT^{n+1} = T^{n} - \\frac{\\Delta t\\,S(T^{n})}{c_{v} + \\Delta t\\,S'(T^{n})}\n$$\n该问题描述的是冷却过程，因此我们期望 $T^{n+1} \\le T^{n}$。当更新的温度变得非物理地为负值，即 $T^{n+1} < 0$ 时，就会发生“冷却灾难”。使用上面的表达式，这个条件是：\n$$\nT^{n} - \\frac{\\Delta t\\,S(T^{n})}{c_{v} + \\Delta t\\,S'(T^{n})} < 0 \\implies T^{n} < \\frac{\\Delta t\\,S(T^{n})}{c_{v} + \\Delta t\\,S'(T^{n})}\n$$\n假设分母为正（这是该方法稳定性的要求，防止冷却导致温度升高），我们可以将两边同乘以它：\n$$\nT^{n}\\,(c_{v} + \\Delta t\\,S'(T^{n})) < \\Delta t\\,S(T^{n})\n$$\n$$\nc_{v}\\,T^{n} + \\Delta t\\,T^{n}\\,S'(T^{n}) < \\Delta t\\,S(T^{n})\n$$\n$$\nc_{v}\\,T^{n} < \\Delta t\\,(S(T^{n}) - T^{n}\\,S'(T^{n}))\n$$\n现在，我们代入 $S(T)$ 及其导数 $S'(T)$ 的给定形式：\n$S(T^{n}) = C\\,(T^{n})^{\\alpha}$\n$S'(T^{n}) = \\frac{\\mathrm{d}}{\\mathrm{d}T}\\left(C\\,T^{\\alpha}\\right)\\bigg|_{T=T^{n}} = \\alpha\\,C\\,(T^{n})^{\\alpha-1}$\n括号中的项变为：\n$$\nS(T^{n}) - T^{n}\\,S'(T^{n}) = C\\,(T^{n})^{\\alpha} - T^{n}\\,(\\alpha\\,C\\,(T^{n})^{\\alpha-1}) = C\\,(T^{n})^{\\alpha} - \\alpha\\,C\\,(T^{n})^{\\alpha} = C\\,(T^{n})^{\\alpha}\\,(1-\\alpha)\n$$\n将此代回不等式，过冲的条件是：\n$$\nc_{v}\\,T^{n} < \\Delta t\\,C\\,(T^{n})^{\\alpha}\\,(1-\\alpha)\n$$\n为使该不等式可能成立，右侧必须为正，因为左侧是严格为正的（$c_{v}>0, T^{n}>0$）。由于 $\\Delta t>0$、$C>0$ 和 $(T^{n})^{\\alpha}>0$，这要求 $(1-\\alpha) > 0$，即 $\\alpha < 1$。如果 $\\alpha \\ge 1$，则右侧非正，不等式永远不能满足，意味着不会发生过冲。\n\n因此，线性化隐式格式产生负温度的条件是 $\\alpha < 1$ 并且时间步长 $\\Delta t$ 足够大：\n$$\n\\Delta t > \\frac{c_{v}\\,T^{n}}{C\\,(T^{n})^{\\alpha}\\,(1-\\alpha)} = \\frac{c_{v}}{C\\,(T^{n})^{\\alpha-1}\\,(1-\\alpha)}\n$$\n**物理和数学根源：**\n失效源于使用一阶泰勒级数在可能很大的区间上近似非线性函数。线性化更新为 $c_{v}(T^{n+1} - T^{n})/\\Delta t = -S_{\\mathrm{lin}}(T^{n+1})$，其中 $S_{\\mathrm{lin}}(T) = S(T^n) + S'(T^n)(T-T^n)$。这种近似仅在 $T^{n+1}$ 非常接近 $T^n$ 时才准确。当使用大的时间步长 $\\Delta t$ 时，得到的 $T^{n+1}$ 可能远离 $T^n$。\n\n对于 $\\alpha < 1$ 的冷却定律，$S(T)$ 函数随 $T$ 亚线性增长或减少。具体来说，对于 $0 < \\alpha < 1$，冷却函数 $S(T)$ 是凹函数（$S''(T) = \\alpha(\\alpha-1)CT^{\\alpha-2} < 0$）。切线 $S_{\\mathrm{lin}}(T)$位于 $S(T)$ 曲线之上，这意味着线性化模型高估了真实的冷却率。对于 $\\alpha \\leq 0$，函数是凸函数，但随着 $T \\to 0$，冷却率急剧增加。在 $\\alpha < 1$ 的任何一种情况下，基于 $T^n$ 状态外推冷却的线性模型，都未能考虑到冷却会随着温度下降而减弱这一事实。这种对 $\\Delta t$ 时间内积分冷却效应的高估，可能消耗比物理上可用的内能（$c_v T^n$）更多的能量，导致 $T^{n+1} < 0$。\n\n#### 第 2 部分：保正限制器的推导\n\n问题提出了一种形式为 $T^{n+1}_{\\mathrm{lim}} = T^{n} - \\varphi\\,\\delta T$ 的限制性更新，其中 $\\delta T$ 是原始无限制格式的温度下降量。根据我们在第 1 部分的分析，我们确定：\n$$\n\\delta T = T^{n} - T^{n+1} = \\frac{\\Delta t\\,S(T^{n})}{c_{v} + \\Delta t\\,S'(T^{n})}\n$$\n我们要求限制后的温度为非负：\n$$\nT^{n+1}_{\\mathrm{lim}} \\ge 0 \\implies T^{n} - \\varphi\\,\\delta T \\ge 0\n$$\n假设发生冷却，则 $\\delta T > 0$。因此，对限制器 $\\varphi$ 的条件是：\n$$\n\\varphi \\le \\frac{T^{n}}{\\delta T}\n$$\n此外，限制器的设计必须能在原始格式已经安全的情况下恢复该格式。对应于 $\\varphi = 1$ 的原始格式，如果 $T^{n+1} \\ge 0$ 则是安全的，这等价于 $\\delta T \\le T^{n}$。\n一个满足所有要求——保正性、$\\varphi \\in (0,1]$ 以及对小 $\\Delta t$ 的相容性——的限制器由下式给出：\n$$\n\\varphi = \\min\\left(1, \\frac{T^{n}}{\\delta T}\\right)\n$$\n这种选择确保了如果步长是安全的（$T^{n}/\\delta T \\ge 1$），我们使用 $\\varphi=1$（原始方法）。如果步长不安全（$T^{n}/\\delta T < 1$），我们将 $\\varphi$ 减小到恰好使最终温度为非负所需的值（在最极端的情况下，它会将 $T^{n+1}_{\\mathrm{lim}}$ 设为 0）。\n\n为了获得最终表达式，我们代入 $\\delta T$、$S(T^n)$ 和 $S'(T^n)$ 的公式：\n$$\n\\frac{T^{n}}{\\delta T} = T^{n} \\left( \\frac{c_{v} + \\Delta t\\,S'(T^{n})}{\\Delta t\\,S(T^{n})} \\right) = \\frac{c_{v}\\,T^{n} + \\Delta t\\,T^{n}\\,S'(T^{n})}{\\Delta t\\,S(T^{n})}\n$$\n代入 $S(T^{n}) = C\\,(T^{n})^{\\alpha}$ 和 $S'(T^{n}) = \\alpha\\,C\\,(T^{n})^{\\alpha-1}$：\n$$\n\\frac{T^{n}}{\\delta T} = \\frac{c_{v}\\,T^{n} + \\Delta t\\,T^{n}\\,\\left(\\alpha\\,C\\,(T^{n})^{\\alpha-1}\\right)}{\\Delta t\\,C\\,(T^{n})^{\\alpha}} = \\frac{c_{v}\\,T^{n} + \\Delta t\\,\\alpha\\,C\\,(T^{n})^{\\alpha}}{\\Delta t\\,C\\,(T^{n})^{\\alpha}}\n$$\n将分数拆分为两项：\n$$\n\\frac{T^{n}}{\\delta T} = \\frac{c_{v}\\,T^{n}}{\\Delta t\\,C\\,(T^{n})^{\\alpha}} + \\frac{\\Delta t\\,\\alpha\\,C\\,(T^{n})^{\\alpha}}{\\Delta t\\,C\\,(T^{n})^{\\alpha}} = \\frac{c_{v}}{\\Delta t\\,C\\,(T^{n})^{\\alpha-1}} + \\alpha\n$$\n因此，限制器 $\\varphi$ 的最终表达式是：\n$$\n\\varphi = \\min\\left(1, \\alpha + \\frac{c_{v}}{\\Delta t\\,C\\,(T^{n})^{\\alpha-1}}\\right)\n$$\n该表达式仅依赖于所要求的参数，并满足所有陈述的条件。当 $\\Delta t \\to 0$ 时，$\\min$ 函数中的第二项趋于无穷大，因此 $\\varphi \\to \\min(1, \\infty) = 1$，确保该方法恢复为未修改的一阶隐式格式，以满足相容性要求。",
            "answer": "$$\\boxed{\\min\\left(1, \\alpha + \\frac{c_{v}}{\\Delta t\\,C\\,(T^{n})^{\\alpha-1}}\\right)}$$"
        }
    ]
}