{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in running any explicit numerical simulation is ensuring its stability. The Courant–Friedrichs–Lewy (CFL) condition provides the fundamental constraint, dictating that the numerical time step, $\\Delta t$, must be small enough that information does not propagate across more than one computational cell per step. This exercise  provides concrete practice in applying this principle to determine a stable time step for a 3D magnetohydrodynamics (MHD) simulation, highlighting the important practical implications of using an anisotropic computational grid.",
            "id": "3520095",
            "problem": "Consider the three-dimensional ideal magnetohydrodynamics (MHD) equations, which form a system of hyperbolic conservation laws. You are using an explicit, unsplit, finite-volume Godunov-type update with an approximate Riemann solver such as Harten–Lax–van Leer (HLL). The background flow is negligible, so wave propagation is dominated by the fast magnetosonic mode. The Courant–Friedrichs–Lewy (CFL) number adopted for time stepping is $C_{\\mathrm{CFL}} = 0.4$. The computational mesh is anisotropic with spacings $\\Delta x = 1.0 \\times 10^{9}\\ \\mathrm{m}$, $\\Delta y = 5.0 \\times 10^{8}\\ \\mathrm{m}$, and $\\Delta z = 2.0 \\times 10^{9}\\ \\mathrm{m}$. A robust characteristic analysis and limiter estimate have produced maximum directional fast magnetosonic signal speeds along the grid axes of $c_{f,x} = 1.5 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $c_{f,y} = 2.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, and $c_{f,z} = 1.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\nStarting from the principle that the numerical domain of dependence of an explicit scheme must contain the physical domain of dependence of the underlying hyperbolic system, derive the functional form of the stability-limiting time step $\\Delta t$ for an unsplit update in terms of the directional signal speeds and grid spacings. Then, evaluate the stable $\\Delta t$ for the given values. Round your answer to four significant figures and express the time step in seconds.\n\nFinally, discuss qualitatively how anisotropic cells (unequal $\\Delta x$, $\\Delta y$, $\\Delta z$) impact the stability-limiting $\\Delta t$ under an unsplit flux divergence compared to an isotropic grid with the same minimum spacing. Your discussion should be grounded in the same first-principles CFL reasoning; do not rely on shortcut formulas.",
            "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information to derive and compute the stability-limiting time step for an explicit, unsplit numerical scheme for the ideal magnetohydrodynamics (MHD) equations. The provided physical parameters are consistent and within plausible ranges for astrophysical simulations. We may therefore proceed with a formal solution.\n\nThe problem requires the derivation of the stability-limiting time step, $\\Delta t$, for a three-dimensional explicit, unsplit finite-volume scheme. The governing principle is the Courant–Friedrichs–Lewy (CFL) condition, which states that for an explicit time-marching scheme to be stable, the numerical domain of dependence of a computational cell must contain the physical domain of dependence.\n\nFor a first-order, cell-centered finite-volume scheme, the solution in a cell $(i,j,k)$ at time $t^{n+1} = t^n + \\Delta t$ is computed using the solution at time $t^n$ in cell $(i,j,k)$ and the fluxes across its faces. These fluxes are determined using data from the immediate neighboring cells. Thus, in a single time step $\\Delta t$, information propagates from the centers of adjacent cells. The fastest physical signal must not travel further than this numerical stencil allows.\n\nIn one spatial dimension, say $x$, the fastest signal with speed $c_{f,x}$ travels a distance $c_{f,x} \\Delta t$. The CFL condition requires this distance to be less than or equal to the grid spacing $\\Delta x$ (multiplied by a safety factor, the CFL number $C_{\\mathrm{CFL}} \\le 1$).\n$$\nc_{f,x} \\Delta t \\le C_{\\mathrm{CFL}} \\Delta x \\implies \\Delta t \\le C_{\\mathrm{CFL}} \\frac{\\Delta x}{c_{f,x}}\n$$\nFor an unsplit scheme in three dimensions, we must consider the propagation of waves simultaneously in all directions. The update for a cell depends on fluxes through all of its faces. The stability condition for a multi-dimensional linear hyperbolic system solved with a first-order upwind or Godunov-type scheme is a generalization of the one-dimensional case. The Courant numbers for each dimension, $\\nu_i = c_{f,i} \\frac{\\Delta t}{\\Delta i}$ for $i \\in \\{x, y, z\\}$, are summed. The stability constraint is:\n$$\n\\nu_x + \\nu_y + \\nu_z \\le C_{\\mathrm{CFL}}\n$$\nSubstituting the expressions for the directional Courant numbers, we have:\n$$\nc_{f,x} \\frac{\\Delta t}{\\Delta x} + c_{f,y} \\frac{\\Delta t}{\\Delta y} + c_{f,z} \\frac{\\Delta t}{\\Delta z} \\le C_{\\mathrm{CFL}}\n$$\nFactoring out $\\Delta t$ yields the functional form for the stability-limiting time step:\n$$\n\\Delta t \\left( \\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z} \\right) \\le C_{\\mathrm{CFL}}\n$$\nTherefore, the maximum stable time step $\\Delta t$ is given by:\n$$\n\\Delta t = \\frac{C_{\\mathrm{CFL}}}{\\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z}}\n$$\nThis expression shows that the inverse of the time step is determined by the sum of the inverse characteristic times for the fastest wave to cross the cell in each respective dimension.\n\nNext, we evaluate this expression using the provided values:\nCFL number: $C_{\\mathrm{CFL}} = 0.4$\nGrid spacings: $\\Delta x = 1.0 \\times 10^{9}\\ \\mathrm{m}$, $\\Delta y = 5.0 \\times 10^{8}\\ \\mathrm{m}$, $\\Delta z = 2.0 \\times 10^{9}\\ \\mathrm{m}$\nSignal speeds: $c_{f,x} = 1.5 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $c_{f,y} = 2.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$, $c_{f,z} = 1.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}$\n\nWe compute the terms in the denominator, which have units of inverse seconds ($\\mathrm{s}^{-1}$):\n$$\n\\frac{c_{f,x}}{\\Delta x} = \\frac{1.5 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}}{1.0 \\times 10^{9}\\ \\mathrm{m}} = 1.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\frac{c_{f,y}}{\\Delta y} = \\frac{2.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}}{5.0 \\times 10^{8}\\ \\mathrm{m}} = 0.4 \\times 10^{-2}\\ \\mathrm{s}^{-1} = 4.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\frac{c_{f,z}}{\\Delta z} = \\frac{1.0 \\times 10^{6}\\ \\mathrm{m}\\,\\mathrm{s}^{-1}}{2.0 \\times 10^{9}\\ \\mathrm{m}} = 0.5 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\nThe sum of these terms is:\n$$\n\\sum_{i \\in \\{x,y,z\\}} \\frac{c_{f,i}}{\\Delta i} = (1.5 + 4.0 + 0.5) \\times 10^{-3}\\ \\mathrm{s}^{-1} = 6.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}\n$$\nNow, we calculate the stable time step $\\Delta t$:\n$$\n\\Delta t = \\frac{0.4}{6.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}} = \\frac{4 \\times 10^{-1}}{6 \\times 10^{-3}}\\ \\mathrm{s} = \\frac{2}{3} \\times 10^{2}\\ \\mathrm{s} \\approx 66.666... \\mathrm{s}\n$$\nRounding the result to four significant figures, we get $\\Delta t = 66.67\\ \\mathrm{s}$.\n\nFinally, we discuss qualitatively the impact of anisotropic cells. The given grid is anisotropic, with the minimum spacing being $\\Delta_{\\min} = \\Delta y = 5.0 \\times 10^{8}\\ \\mathrm{m}$. An equivalent isotropic grid with the same minimum spacing would have $\\Delta x' = \\Delta y' = \\Delta z' = \\Delta_{\\min}$.\n\nThe stability condition for the anisotropic grid is:\n$$\n\\Delta t_{\\text{aniso}} = \\frac{C_{\\mathrm{CFL}}}{\\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z}}\n$$\nFor the hypothetical isotropic grid with spacing $\\Delta_{\\min}$, the condition would be:\n$$\n\\Delta t_{\\text{iso}} = \\frac{C_{\\mathrm{CFL}}}{\\frac{c_{f,x}}{\\Delta_{\\min}} + \\frac{c_{f,y}}{\\Delta_{\\min}} + \\frac{c_{f,z}}{\\Delta_{\\min}}}\n$$\nLet us compare the denominators. In the anisotropic case, the grid spacings in the $x$ and $z$ directions are larger than the minimum spacing: $\\Delta x > \\Delta_{\\min}$ and $\\Delta z > \\Delta_{\\min}$. Consequently, the corresponding terms in the denominator's sum are smaller:\n$$\n\\frac{c_{f,x}}{\\Delta x}  \\frac{c_{f,x}}{\\Delta_{\\min}} \\quad \\text{and} \\quad \\frac{c_{f,z}}{\\Delta z}  \\frac{c_{f,z}}{\\Delta_{\\min}}\n$$\nThe term for the $y$-direction is identical in both cases, since $\\Delta y = \\Delta_{\\min}$. Therefore, the sum in the denominator for the anisotropic case is strictly smaller than the sum for the isotropic case:\n$$\n\\left(\\frac{c_{f,x}}{\\Delta x} + \\frac{c_{f,y}}{\\Delta y} + \\frac{c_{f,z}}{\\Delta z}\\right)  \\left(\\frac{c_{f,x}}{\\Delta_{\\min}} + \\frac{c_{f,y}}{\\Delta_{\\min}} + \\frac{c_{f,z}}{\\Delta_{\\min}}\\right)\n$$\nSince the time step $\\Delta t$ is inversely proportional to this sum, the anisotropic grid permits a larger, less restrictive time step compared to an isotropic grid refined to the same minimum resolution in all directions: $\\Delta t_{\\text{aniso}} > \\Delta t_{\\text{iso}}$. This demonstrates a significant computational advantage of using anisotropic meshing for problems where high resolution is required only along certain axes, as the time step is not as severely penalized by the smallest cell dimension as it would be on a uniformly refined isotropic grid.",
            "answer": "$$\n\\boxed{66.67}\n$$"
        },
        {
            "introduction": "Beyond ensuring stability within the computational domain, a physically meaningful simulation depends critically on how it interacts with its boundaries. Improperly chosen boundary conditions can introduce spurious wave reflections that contaminate the solution and lead to unphysical results. This thought experiment  challenges you to analyze how several common numerical boundary conditions affect an outgoing Alfvén wave, developing your intuition for selecting the right boundary treatment for a given physical problem.",
            "id": "3520091",
            "problem": "Consider the equations of ideal magnetohydrodynamics (MHD): mass conservation, momentum conservation with the Lorentz force, the induction equation in the ideal limit (no resistivity), and the solenoidal constraint on the magnetic field. In Cartesian coordinates, with velocity $\\mathbf{u}$, magnetic field $\\mathbf{B}$, density $\\rho$, pressure $p$, and total energy density $E$, the governing laws are, respectively, the continuity equation $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$, the momentum equation $\\partial_t (\\rho \\mathbf{u}) + \\nabla \\cdot \\left[\\rho \\mathbf{u}\\mathbf{u} + \\left(p + \\frac{B^2}{8\\pi}\\right)\\mathbf{I} - \\frac{\\mathbf{B}\\mathbf{B}}{4\\pi}\\right] = 0$, the induction equation $\\partial_t \\mathbf{B} - \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = 0$ with $\\nabla \\cdot \\mathbf{B} = 0$, and a thermodynamic closure such as an ideal-gas law for $p$. Linearize these equations about a uniform, static background with constant density $\\rho_0$, pressure $p_0$, and constant magnetic field $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{x}}$ in a one-dimensional domain $x \\in [0,L]$ with uniform grid and no mean flow ($\\mathbf{u}_0 = \\mathbf{0}$). Focus on small-amplitude, linear Alfvén waves propagating along the background field direction: transverse perturbations $u_y(x,t)$ and $B_y(x,t)$, with Alfvén speed $c_a = B_0/\\sqrt{4\\pi \\rho_0}$, and phase relation $B_y = \\pm \\sqrt{4\\pi \\rho_0}\\, u_y$ depending on propagation direction.\n\nA plane Alfvén wave of frequency $\\omega$ and wavenumber $k$ approaches the boundary at $x=0$ from the interior ($x>0$), so the incident disturbance has dependence $e^{i(\\omega t - k x)}$ for a leftward-propagating wave with group velocity $-c_a$; the reflected disturbance, if present, has dependence $e^{i(\\omega t + k x)}$. The total transverse velocity at $x$ is then $u_y(x,t) = \\text{Re}\\left\\{\\hat{u}\\,e^{i\\omega t} \\left[e^{-ikx} + R\\,e^{ikx}\\right]\\right\\}$, and the transverse magnetic field is $B_y(x,t) = \\text{Re}\\left\\{\\hat{b}\\,e^{i\\omega t} \\left[e^{-ikx} - R\\,e^{ikx}\\right]\\right\\}$ for the leftward Alfvén branch, where $\\hat{b} = \\sqrt{4\\pi \\rho_0}\\,\\hat{u}$ and $R$ is the complex reflection coefficient.\n\nAt $x=0$, consider five common numerical boundary treatments used in computational astrophysics MHD:\n\n- Periodic boundary conditions: identify $x=0$ with $x=L$ so that all fields satisfy periodicity and waves exiting at $x=0$ re-enter at $x=L$ without modification in a uniform medium.\n\n- Reflective, perfectly conducting wall: impose kinematic reflection and perfect conductor constraints at $x=0$ consistent with ideal MHD, which for small-amplitude, field-aligned Alfvén waves lead to $u_y(0,t) = 0$ and vanishing tangential electric field $E_y(0,t) = 0$.\n\n- Inflow boundary: prescribe fixed primitive variables $\\rho$, $p$, $\\mathbf{u}$, and $\\mathbf{B}$ at $x=0$ corresponding to a steady inflow state, independent of time.\n\n- Outflow boundary: impose zero normal gradient at $x=0$ on primitive variables, for example $\\partial_x (\\rho,p,u_y,B_y) = 0$.\n\n- Characteristic-based boundary: decompose the linearized MHD system into characteristic variables and impose only the incoming characteristic amplitudes at $x=0$ to steady background values, leaving outgoing characteristics free, to construct non-reflecting boundary conditions in the linear limit.\n\nWhich of the following statements about the reflection of the incident Alfvén wave at $x=0$ in this setup are correct? Select all that apply.\n\nA. In a periodic domain with uniform background and identical grid, a rightward-exiting wave at $x=L$ re-enters at $x=0$ without any reflection; at $x=0$ the reflection coefficient for the incident Alfvén wave is $R = 0$.\n\nB. A reflective, perfectly conducting wall at $x=0$ enforces $u_y(0,t) = 0$ for the transverse velocity perturbation of a field-aligned Alfvén wave, yielding a reflected wave with unit magnitude and phase inversion ($R = -1$), so that energy is trapped and the disturbance reflects.\n\nC. A simple zero-gradient outflow boundary at $x=0$ is strictly non-reflecting for all linear MHD modes at any angle between wavevector and magnetic field, regardless of whether the flow is subcritical or supercritical.\n\nD. A characteristic-based boundary that sets incoming Alfvén characteristics to steady background values while leaving outgoing characteristics unconstrained eliminates first-order reflections for outgoing linear perturbations in a uniform medium; for the Alfvén wave here, one obtains $R = 0$.\n\nE. A prescribed inflow boundary with fixed primitive variables at $x=0$ generally causes strong reflection of an outgoing linear wave approaching the boundary; it is appropriate (and non-reflecting from the interior perspective) only when the net characteristic flux is into the domain, i.e., the wave is entering rather than leaving.",
            "solution": "The user has provided a problem concerning the reflection of a linear Alfvén wave at various numerical boundaries in a one-dimensional ideal magnetohydrodynamics (MHD) setup.\n\n### Step 1: Problem Validation\n\n**Givens Extraction:**\n-   **Governing Equations:** Ideal MHD equations for density $\\rho$, velocity $\\mathbf{u}$, pressure $p$, and magnetic field $\\mathbf{B}$.\n    -   $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{u}) = 0$\n    -   $\\partial_t (\\rho \\mathbf{u}) + \\nabla \\cdot \\left[\\rho \\mathbf{u}\\mathbf{u} + \\left(p + \\frac{B^2}{8\\pi}\\right)\\mathbf{I} - \\frac{\\mathbf{B}\\mathbf{B}}{4\\pi}\\right] = 0$\n    -   $\\partial_t \\mathbf{B} - \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) = 0$\n    -   $\\nabla \\cdot \\mathbf{B} = 0$\n-   **Coordinates and Domain:** Cartesian, $x \\in [0,L]$.\n-   **Background State:** Uniform and static: $\\rho_0 = \\text{const}$, $p_0 = \\text{const}$, $\\mathbf{u}_0 = \\mathbf{0}$, $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{x}}$.\n-   **Wave Properties:**\n    -   A plane, small-amplitude, linear Alfvén wave propagating along $\\mathbf{B}_0$.\n    -   Perturbations are transverse: $u_y(x,t)$, $B_y(x,t)$.\n    -   Alfvén speed: $c_a = B_0/\\sqrt{4\\pi \\rho_0}$.\n    -   Incident wave: Approaches $x=0$ from $x>0$, with dependence $e^{i(\\omega t - k x)}$, described as \"leftward-propagating with group velocity $-c_a$\". This implies an unconventional but consistent choice of signs where, for $\\omega>0$, the wavenumber $k$ is negative.\n    -   Reflected wave: Has dependence $e^{i(\\omega t + k x)}$. With $k0$, this corresponds to rightward propagation.\n    -   Total transverse velocity: $u_y(x,t) = \\text{Re}\\left\\{\\hat{u}\\,e^{i\\omega t} \\left[e^{-ikx} + R\\,e^{ikx}\\right]\\right\\}$\n    -   Total transverse magnetic field: $B_y(x,t) = \\text{Re}\\left\\{\\hat{b}\\,e^{i\\omega t} \\left[e^{-ikx} - R\\,e^{ikx}\\right]\\right\\}$\n    -   Amplitude relation: $\\hat{b} = \\sqrt{4\\pi \\rho_0}\\,\\hat{u}$. The relative sign between $u_y$ and $B_y$ depends on the direction of propagation. The provided expression for the total $B_y$ correctly accounts for this: the incident wave has $B_{y,I}$ and $u_{y,I}$ in phase (for leftward propagation along $\\mathbf{B}_0$), while the reflected wave has $B_{y,R}$ and $u_{y,R}$ in anti-phase (for rightward propagation).\n-   **Boundary conditions at $x=0$**: Five types are described: Periodic, Reflective (perfectly conducting wall), Inflow, Outflow (zero-gradient), and Characteristic-based.\n\n**Validation Verdict:**\nThe problem statement is scientifically grounded, well-posed, and objective. It describes a standard test problem used in computational astrophysics to verify the implementation of boundary conditions in MHD codes. The governing equations, wave properties, and descriptions of the boundary conditions are standard. The chosen convention for the wave's functional form, while potentially confusing, is internally consistent. The problem is well-defined and contains sufficient information to determine the reflection coefficient $R$ for each case presented. The problem is valid.\n\n### Step 2: Derivation and Option Analysis\n\nWe analyze the reflection of the incident Alfvén wave at the boundary $x=0$. The complex amplitudes of the total transverse velocity and magnetic field at any point $x$ are given by:\n$$ u_y(x) = \\hat{u} \\left(e^{-ikx} + R\\,e^{ikx}\\right) $$\n$$ B_y(x) = \\hat{b} \\left(e^{-ikx} - R\\,e^{ikx}\\right) $$\nwhere $\\hat{b} = \\sqrt{4\\pi \\rho_0}\\,\\hat{u}$. We apply the specified boundary conditions at $x=0$ to determine the reflection coefficient $R$. At $x=0$, these expressions simplify to:\n$$ u_y(0) = \\hat{u} (1+R) $$\n$$ B_y(0) = \\hat{b} (1-R) $$\n\n**A. Periodic boundary conditions**\nPeriodic boundary conditions connect the domain edges, such that $x=0$ is identified with $x=L$. In a uniform medium, this topology implies that there is no physical interface at $x=0$ or $x=L$ to cause reflection. A wave packet propagating towards $x=0$ from the interior (i.e., a left-propagating wave) will pass through $x=0$ seamlessly and reappear at $x=L$, continuing its propagation. The absence of a physical discontinuity or an imposed constraint that would scatter the wave means there is no reflected wave generated. The amplitude of the reflected wave is zero, which corresponds to a reflection coefficient $R=0$. The statement text correctly concludes that $R=0$. While the descriptive clause about a \"rightward-exiting wave\" describes a different scenario, the essential claim about the given incident wave is correct.\n**Verdict: Correct.**\n\n**B. Reflective, perfectly conducting wall**\nA perfectly conducting wall cannot sustain a tangential electric field. In ideal MHD, the electric field is $\\mathbf{E} = -\\mathbf{u} \\times \\mathbf{B}$. For the given wave, with $\\mathbf{u} = u_y \\hat{\\mathbf{y}}$ and $\\mathbf{B} \\approx B_0 \\hat{\\mathbf{x}}$, the electric field is $\\mathbf{E} \\approx - (u_y \\hat{\\mathbf{y}}) \\times (B_0 \\hat{\\mathbf{x}}) = u_y B_0 \\hat{\\mathbf{z}}$. The tangential components of $\\mathbf{E}$ at the wall $x=0$ are $E_y$ and $E_z$. For this wave, $E_y=0$ trivially. The condition $E_z(0,t) = 0$ implies $u_y(0,t) B_0 = 0$. Since $B_0 \\neq 0$, the physical boundary condition is $u_y(0,t) = 0$.\nApplying this condition to the total velocity at $x=0$:\n$$ u_y(0) = \\hat{u} (1+R) = 0 $$\nFor a non-trivial incident wave ($\\hat{u} \\neq 0$), this requires $1+R = 0$, which yields $R=-1$.\nThis means the reflected wave has the same amplitude as the incident wave but is inverted in phase. The reflection is total ($|R|^2=1$), so all incident energy is reflected, and energy is trapped in the domain. The statement is entirely accurate.\n**Verdict: Correct.**\n\n**C. Simple zero-gradient outflow boundary**\nThis boundary condition imposes that the normal derivative of the primitive variables is zero. For the perturbations $u_y$ and $B_y$, this means $\\partial_x u_y = 0$ and $\\partial_x B_y = 0$ at $x=0$.\nFirst, let's compute the spatial derivatives:\n$$ \\frac{\\partial u_y}{\\partial x} = \\hat{u} \\left(-ik e^{-ikx} + ikR e^{ikx}\\right) = ik\\hat{u}\\left(-e^{-ikx} + R e^{ikx}\\right) $$\n$$ \\frac{\\partial B_y}{\\partial x} = \\hat{b} \\left(-ik e^{-ikx} - ikR e^{ikx}\\right) = -ik\\hat{b}\\left(e^{-ikx} + R e^{ikx}\\right) $$\nApplying the conditions at $x=0$:\n$$ \\frac{\\partial u_y}{\\partial x}\\bigg|_{x=0} = ik\\hat{u}(-1 + R) = 0 \\implies R=1 $$\n$$ \\frac{\\partial B_y}{\\partial x}\\bigg|_{x=0} = -ik\\hat{b}(1 + R) = 0 \\implies R=-1 $$\nThe conditions $\\partial_x u_y = 0$ and $\\partial_x B_y = 0$ lead to contradictory requirements for the reflection coefficient ($R=1$ and $R=-1$). This means no solution in the form of a simple reflected wave can satisfy these boundary conditions simultaneously. The problem is overconstrained, and such a boundary condition is known to be highly reflective for MHD waves in the sub-critical regime. The statement that it is \"strictly non-reflecting\" is false.\n**Verdict: Incorrect.**\n\n**D. Characteristic-based boundary**\nThese boundary conditions are specifically designed to be non-reflecting. They operate by decomposing the MHD wave modes into those entering the domain (incoming characteristics) and those leaving the domain (outgoing characteristics). For a boundary at $x=0$ and a domain at $x>0$, outgoing waves have negative propagation speeds. The incident Alfvén wave in this problem is propagating leftward with velocity $-c_a$, so it is an outgoing characteristic at the $x=0$ boundary. A non-reflecting boundary condition is achieved by specifying the amplitudes of incoming characteristics (e.g., to match a steady external state) while using an extrapolation or other numerical technique that allows outgoing characteristics to leave the domain unimpeded. By design, this prevents the generation of spurious reflected waves from the boundary. In the ideal, linear limit, this results in a reflection coefficient of $R=0$ for the outgoing wave. The statement accurately describes this principle and its outcome.\n**Verdict: Correct.**\n\n**E. Prescribed inflow boundary**\nThis boundary condition fixes the primitive variables at the boundary, typically to their background values for a problem involving perturbations. For the given setup, this implies that all perturbations must vanish at $x=0$. In particular, $u_y(0,t)=0$ and $B_y(0,t)=0$.\nApplying these conditions:\n1.  $u_y(0) = \\hat{u} (1+R) = 0 \\implies R=-1$\n2.  $B_y(0) = \\hat{b} (1-R) = 0 \\implies R=1$\nAs with the zero-gradient condition, we find contradictory requirements for $R$. Physically, this means that the boundary condition is over-specified for an outgoing wave and cannot be satisfied. The result in a numerical simulation is strong, spurious reflection. The first part of the statement, \"generally causes strong reflection of an outgoing linear wave approaching the boundary,\" is therefore correct. The second part explains the context where this boundary is appropriate: when the flow of information is into the domain (i.e., for incoming waves). In that case, the boundary condition serves to specify the properties of the incoming flow, and there is no \"reflection\" from the interior. This is a correct and complete physical description.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ABDE}$$"
        },
        {
            "introduction": "Once a code can be run in a stable manner with appropriate boundary conditions, the essential task of verification begins. A computational scientist must demonstrate that their code produces correct and reliable results across a range of physical regimes. This final practice  puts you in the role of a code developer, tasking you with designing a comprehensive verification suite using a suite of canonical MHD test problems. You will learn to systematically disentangle and assess a code's formal accuracy on smooth flows, its robustness in handling shocks and discontinuities, and its ability to maintain the critical divergence-free constraint on the magnetic field.",
            "id": "3520099",
            "problem": "Consider the ideal equations of Magnetohydrodynamics (MHD), which in conservation form consist of the mass conservation, momentum conservation, induction, and total energy equations together with the solenoidal constraint. With primitive variables density $\\rho$, velocity $\\mathbf{v}$, magnetic field $\\mathbf{B}$, gas pressure $p$, and adiabatic index $\\gamma$, the system can be summarized as:\n$$\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{v}) = 0,$$\n$$\\partial_t (\\rho \\mathbf{v}) + \\nabla \\cdot \\left[\\rho \\mathbf{v}\\mathbf{v} + \\left(p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{I} - \\mathbf{B}\\mathbf{B}\\right] = 0,$$\n$$\\partial_t E + \\nabla \\cdot \\left[\\left(E + p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{B})\\mathbf{B}\\right] = 0,$$\n$$\\partial_t \\mathbf{B} + \\nabla \\cdot (\\mathbf{v}\\mathbf{B} - \\mathbf{B}\\mathbf{v}) = 0,$$\nsubject to the divergence-free condition\n$$\\nabla \\cdot \\mathbf{B} = 0,$$\nand with total energy $E = \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho \\|\\mathbf{v}\\|^2 + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2.$\n\nA computational astrophysics code claims to be high-order accurate for smooth flows, robust for discontinuities, and capable of controlling divergence errors in the magnetic field. You are asked to select a verification plan that uses a combination of linear wave propagation, the Brio–Wu shock tube, the magnetic rotor, and the Orszag–Tang vortex to separately assess:\n(i) accuracy on smooth solutions,\n(ii) robustness when strong discontinuities and rotational structures form,\n(iii) control of magnetic divergence errors, i.e., maintenance of the constraint $\\nabla\\cdot\\mathbf{B}=0$ and mitigation of the spurious magnetic-monopole forces that arise when $\\nabla\\cdot\\mathbf{B}\\neq 0$.\n\nThe plan should define scientifically consistent initial and boundary conditions, specify diagnostics tied to first principles of the above system, and avoid conflating objectives. Choose the option that correctly separates the objectives and uses appropriate diagnostics for each test.\n\nA. Accuracy is assessed using small-amplitude linear MHD waves on a periodic cube $[0,1]^3$: initialize three families (Alfvén, slow magnetosonic, fast magnetosonic) with amplitude $A = 10^{-6}$ and a normalized wavevector $\\mathbf{k} \\propto (1,2,3)$ to avoid grid alignment. Compute the error in $(\\rho,\\mathbf{v},\\mathbf{B},p)$ after one period $T = 2\\pi/\\omega_{\\text{mode}}$, comparing to the corresponding linear solution, and measure $L_1$, $L_2$, and $L_\\infty$ norms as functions of resolution $N = 64, 128, 256$ to confirm the expected order for smooth solutions. Robustness to discontinuities is assessed with the 1D Brio–Wu shock tube on $[0,1]$ with outflow (non-reflecting) boundaries and standard left/right states $(\\rho_L,p_L,\\mathbf{v}_L,\\mathbf{B}_L)=(1,1,(0,0,0),(0.75,1,0))$, $(\\rho_R,p_R,\\mathbf{v}_R,\\mathbf{B}_R)=(0.125,0.1,(0,0,0),(0.75,-1,0))$, and with the 2D magnetic rotor on $[0,1]^2$ (periodic) using a dense rotating disk of radius $r_0=0.1$ at the domain center with $\\rho_{\\text{in}}=10$, $\\rho_{\\text{out}}=1$, $p=1$, angular velocity $\\omega=20$, and a uniform background field $\\mathbf{B}_0=(5,0,0)$; diagnostics include shock/rarefaction locations, $L_1$ errors against a high-resolution reference, and preservation of angular momentum and peak vorticity. Control of divergence errors is evaluated with the Orszag–Tang vortex on $[0,1]^2$ (periodic) with $\\gamma=5/3$, $\\rho=1$, $p=5/3$, $\\mathbf{v} = (-\\sin(2\\pi y), \\sin(2\\pi x), 0)$, $\\mathbf{B} = (-\\sin(2\\pi y), \\sin(4\\pi x), 0)$; record $\\|\\nabla\\cdot\\mathbf{B}\\|_2/\\|\\mathbf{B}\\|_2$ and the maximum $|\\nabla\\cdot\\mathbf{B}|$ versus time for two algorithmic variants: Constrained Transport (CT) and Generalized Lagrange Multiplier (GLM) cleaning, plus a control run with cleaning disabled to demonstrate divergence growth and its impact on momentum/energy residuals.\n\nB. Accuracy is assessed with large-amplitude Alfvén waves of $A=0.1$ in 1D using inflow/outflow boundaries, comparing the total energy at $t=1$ at a single resolution $N=128$. Robustness to discontinuities is assessed by using the Orszag–Tang vortex as a proxy for a shock tube and computing shock widths, while divergence control is inferred indirectly from near-constancy of total energy without explicitly monitoring $\\nabla\\cdot\\mathbf{B}$; no periodic boundaries are used to avoid artificial constraints.\n\nC. Accuracy is assessed only on a grid-aligned 1D Alfvén wave with periodic boundaries and amplitude $A=10^{-6}$ at a single resolution $N=128$ using $L_1$ error. Robustness to discontinuities is evaluated with the rotor test using reflective boundaries, and divergence control is folded into the rotor by examining $\\nabla\\cdot\\mathbf{v}$ rather than $\\nabla\\cdot\\mathbf{B}$, supplemented by an Orszag–Tang run without tracking divergence norms or comparing different divergence-control algorithms.\n\nD. Accuracy is evaluated via the Brio–Wu shock tube by measuring shock widths at $t=0.2$ for increasing $N$, assuming smooth-convergence extends to discontinuities; robustness to discontinuities is assessed with linear waves at $A=10^{-6}$ on $[0,1]^3$; divergence control is assessed by monitoring $\\nabla\\cdot\\mathbf{v}$ and by requiring the mean magnetic field $\\langle \\mathbf{B} \\rangle$ to remain constant on the Orszag–Tang vortex with outflow boundaries.\n\nWhich option provides a scientifically sound plan that correctly separates accuracy on smooth solutions, robustness to discontinuities, and control of divergence errors, with appropriate initial/boundary conditions and diagnostics rooted in the governing equations?",
            "solution": "The task is to select the most scientifically sound verification plan for a computational astrophysics code designed to solve the ideal Magnetohydrodynamics (MHD) equations. The plan must separately assess three key capabilities: (i) accuracy on smooth solutions, (ii) robustness in the presence of strong discontinuities, and (iii) control of the magnetic field divergence error.\n\nFirst, we must confirm the validity of the problem statement. The problem provides the standard conservative form of the ideal MHD equations:\n$$ \\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{v}) = 0 $$\n$$ \\partial_t (\\rho \\mathbf{v}) + \\nabla \\cdot \\left[\\rho \\mathbf{v}\\mathbf{v} + \\left(p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{I} - \\mathbf{B}\\mathbf{B}\\right] = 0 $$\n$$ \\partial_t E + \\nabla \\cdot \\left[\\left(E + p + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2\\right)\\mathbf{v} - (\\mathbf{v}\\cdot\\mathbf{B})\\mathbf{B}\\right] = 0 $$\n$$ \\partial_t \\mathbf{B} + \\nabla \\cdot (\\mathbf{v}\\mathbf{B} - \\mathbf{B}\\mathbf{v}) = 0 $$\nThe total energy is defined as $E = \\tfrac{p}{\\gamma - 1} + \\tfrac{1}{2}\\rho \\|\\mathbf{v}\\|^2 + \\tfrac{1}{2}\\|\\mathbf{B}\\|^2$, and the system is subject to the solenoidal constraint $\\nabla \\cdot \\mathbf{B} = 0$. These equations are the fundamental and correct basis of ideal MHD. The specified test problems—linear wave propagation, the Brio–Wu shock tube, the magnetic rotor, and the Orszag–Tang vortex—are canonical benchmarks in the field of computational MHD. The three verification objectives are distinct and crucial for qualifying a modern MHD code. The problem is therefore scientifically grounded, well-posed, objective, and internally consistent. We may proceed to evaluate the proposed plans.\n\nA sound verification plan must employ specific tests tailored to each objective, with appropriate initial conditions, boundary conditions, and diagnostics.\n\n1.  **Objective (i): Accuracy on smooth solutions.** This requires a test problem with a known, smooth, analytic or semi-analytic solution. The numerical solution's convergence to the true solution as a function of grid resolution ($N$) is measured. For a scheme of order $m$, the error should decrease as $N^{-m}$.\n    -   **Methodology**: The propagation of small-amplitude linear waves is the ideal test. The amplitude must be small (e.g., $A \\sim 10^{-6}$) to ensure the system remains in the linear regime, preventing wave steepening and shock formation. To avoid artificially favorable results, the wavevector $\\mathbf{k}$ should not be aligned with the grid axes. A convergence study across multiple resolutions is mandatory to measure the order of accuracy.\n\n2.  **Objective (ii): Robustness to discontinuities.** This tests the code's ability to handle shocks, rarefactions, and contact discontinuities without generating fatal errors or excessive, unphysical oscillations. This is a test of stability and qualitative correctness in the highly nonlinear regime.\n    -   **Methodology**: Standard shock-tube problems, such as the Brio–Wu test, are designed to generate a complex fan of one-dimensional discontinuities. Higher-dimensional tests like the magnetic rotor or Orszag–Tang vortex test the interaction of strong shocks, shear flows, and vortices. Formal accuracy is not the primary diagnostic; rather, one compares the solution's structure to high-resolution reference solutions and checks for the preservation of physical principles (e.g., conservation laws).\n\n3.  **Objective (iii): Control of magnetic divergence errors.** This verifies the efficacy of the numerical algorithm in maintaining the $\\nabla \\cdot \\mathbf{B} = 0$ constraint. Failure to do so introduces a non-physical force proportional to $\\nabla \\cdot \\mathbf{B}$, which can corrupt the solution and lead to instability.\n    -   **Methodology**: A test problem with complex, evolving magnetic field structures, like the Orszag–Tang vortex, is ideal. The initial state has $\\nabla \\cdot \\mathbf{B} = 0$, but numerical error can cause it to grow. The primary diagnostic is the direct measurement of a discrete version of $\\nabla \\cdot \\mathbf{B}$ across the grid, often monitored via its $L_2$ or $L_\\infty$ norm, and comparing different divergence-control strategies (e.g., Constrained Transport, Powell's source terms, projection, or GLM cleaning).\n\nWe now evaluate each option against these principles.\n\n**Option A:**\n-   **Accuracy**: This plan correctly uses small-amplitude ($A = 10^{-6}$) linear MHD waves. The choice of a non-grid-aligned wavevector $\\mathbf{k} \\propto (1,2,3)$ is crucial for a rigorous test. It properly specifies a convergence study over multiple resolutions ($N = 64, 128, 256$) using standard error norms ($L_1, L_2, L_\\infty$). This constitutes a textbook procedure for verifying the formal order of accuracy.\n-   **Robustness**: It uses both the 1D Brio–Wu shock tube and the 2D magnetic rotor. These are standard, challenging tests for discontinuities and complex flows. The specified initial and boundary conditions are standard. The diagnostics—shock locations, $L_1$ errors against a reference, and conservation laws—are appropriate for this objective.\n-   **Divergence Control**: It correctly employs the Orszag–Tang vortex, a classic problem for this purpose. The diagnostics are direct and quantitative: monitoring norms of $\\nabla \\cdot \\mathbf{B}$ over time. Critically, it proposes comparing dedicated divergence-control algorithms (CT, GLM) against a run with no cleaning, which is the definitive method to demonstrate both the existence of the problem and the effectiveness of the solution.\n-   **Verdict**: This option correctly separates the three objectives and assigns the appropriate test, boundary conditions, and diagnostics to each. It represents a state-of-the-art verification plan. **Correct**.\n\n**Option B:**\n-   **Accuracy**: Uses large-amplitude ($A=0.1$) waves. This is incorrect, as non-linear effects will dominate, making it unsuitable for a clean accuracy test. It also lacks a convergence study (single resolution $N=128$), rendering it useless for determining the order of accuracy.\n-   **Robustness**: Uses Orszag–Tang as a \"proxy for a shock tube,\" which is an imprecise framing.\n-   **Divergence Control**: Relies on \"indirect\" inference from energy conservation. This is unreliable and unacceptable; the divergence of $\\mathbf{B}$ must be measured directly.\n-   **Verdict**: This plan is fundamentally flawed due to its use of incorrect methodologies and diagnostics. **Incorrect**.\n\n**Option C:**\n-   **Accuracy**: Uses a grid-aligned 1D wave and a single resolution. This is a weak, non-rigorous test that can hide errors and does not measure convergence.\n-   **Robustness**: Uses reflective boundaries for the rotor test, which is non-standard and complicates the physics with boundary interactions, making comparisons to established results difficult.\n-   **Divergence Control**: Proposes to examine $\\nabla \\cdot \\mathbf{v}$ instead of $\\nabla \\cdot \\mathbf{B}$. This is a nonsensical substitution, as the solenoidal constraint applies to the magnetic field, not the velocity field (which is non-solenoidal in compressible MHD).\n-   **Verdict**: This plan demonstrates a critical misunderstanding of the physics and the verification objectives. **Incorrect**.\n\n**Option D:**\n-   **Accuracy**: Conflates objectives by using a shock tube (Brio–Wu) to assess accuracy. Shock-capturing schemes are not high-order accurate at discontinuities, so this test cannot measure the formal accuracy for smooth flows.\n-   **Robustness**: Uses small-amplitude linear waves to assess robustness. This is incorrect. Linear waves are smooth and do not test the code's behavior with shocks or strong non-linearities.\n-   **Divergence Control**: Proposes monitoring $\\nabla \\cdot \\mathbf{v}$ (incorrect, as noted for C) and the mean magnetic field $\\langle \\mathbf{B} \\rangle$. Conservation of $\\langle \\mathbf{B} \\rangle$ on a periodic domain is trivial and provides no information about local divergence errors, which are the source of the unphysical forces.\n-   **Verdict**: This plan completely inverts the roles of accuracy and robustness tests and uses irrelevant diagnostics for divergence control. **Incorrect**.\n\nBased on this rigorous analysis, Option A is the only plan that is scientifically sound, methodologically correct, and separates the verification objectives without conflation. It employs the correct tests with the correct parameters and diagnostics for each objective.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}