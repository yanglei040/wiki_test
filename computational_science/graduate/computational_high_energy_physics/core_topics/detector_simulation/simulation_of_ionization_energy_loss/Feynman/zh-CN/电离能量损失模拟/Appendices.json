{
    "hands_on_practices": [
        {
            "introduction": "将物理公式直接转化为代码是计算模拟的第一步，但这其中常常隐藏着数值稳定性的陷阱。Bethe-Bloch公式在天真的计算实现下，当粒子能量非常高时，会因大数相减而导致灾难性的精度损失。本练习旨在引导你通过代数重构，推导并实现一个在整个能量范围内都保持数值稳定性的Bethe-Bloch公式版本，这是开发可靠模拟软件的一项核心技能。",
            "id": "3534698",
            "problem": "考虑一个静止质量为 $M$、动能为 $T$ 的带电粒子，穿过一种均匀介质。该介质的特性由平均激发能 $I$ 和由 Sternheimer 参数化描述的密度效应修正 $\\delta$ 决定。任务是，以高数值稳定性计算平均电离能损率公式中出现的无量纲方括号因子，即一个对数项与多个运动学减项之差。仅从相对论运动学和给定的材料响应模型出发，设计并实现一个程序来计算该方括号\n$B \\equiv \\frac{1}{2}\\ln(\\mathcal{L}) - \\beta^2 - \\frac{\\delta}{2}$，\n其中 $\\mathcal{L}$ 是将单次碰撞中最大能量转移的运动学与电子质量 $m_e$ 和由 $I$ 设定的标度相结合时出现的对数宗量。您的程序必须构造计算过程，以避免在乘积 $\\beta\\gamma$ 值很大时发生灾难性抵消。唯一允许的计算捷径是基于第一性原理的代数重排和标准数值技术（例如，在适当时使用像 $\\ln(1+x)$ 这样的数值稳定对数函数）。所有量必须在单一单位制下处理：能量使用兆电子伏特 (MeV)，其中 $I$ 以电子伏特 (eV) 为单位提供，并在内部转换为 MeV。方括号 $B$ 的输出值是无量纲的。\n\n推导中使用的基本原理和定义：\n- 相对论运动学：在光速 $c$ 设为 1 的单位制中，定义 $E = M + T$，$\\gamma = E/M$，$\\beta^2 = 1 - 1/\\gamma^2$，以及 $\\beta\\gamma = \\sqrt{\\gamma^2 - 1}$。\n- 对静止质量为 $m_e$ 的电子在单次碰撞中发生最大能量转移的两体弹性散射运动学。\n- 介质的 Sternheimer 密度效应参数化：令 $x = \\log_{10}(\\beta\\gamma)$，并由已知的介质经验常数分段定义 $\\delta(x)$。\n\n材料模型（液态水）和常数：\n- 电子静止能量 $m_e c^2 = 0.510\\,998\\,95\\,\\text{MeV}$。\n- 平均激发能 $I = 75.0\\,\\text{eV}$（内部转换为 MeV）。\n- 液态水的 Sternheimer 密度效应参数：$x_0 = 0.240$，$x_1 = 2.800$，$C = 0.260$，$a = 0.09116$，$k = 3.477$。修正是\n$\\delta(x) =\n\\begin{cases}\n0,   x  x_0,\\\\\n2\\ln(10)\\,x - C + a\\,(x_1 - x)^k,   x_0 \\le x  x_1,\\\\\n2\\ln(10)\\,x - C,   x \\ge x_1.\n\\end{cases}\n$\n\n数值稳定性要求：\n- 方括号 $B$ 的朴素计算在 $\\beta\\gamma$ 很大时会遭受严重的有效数字损失，因为对数项和 $\\delta/2$ 都随 $\\ln(\\beta\\gamma)$ 缩放。推导一个代数等价的表达式，该表达式能显式地抵消共同的增长项，只留下较小的残差项，并在代码中实现此表达式。使用推导中的恒等式，将 $\\frac{1}{2}\\ln(\\mathcal{L})$ 表示为 $\\ln(\\beta\\gamma)$、重粒子与电子的质量比以及材料常数的函数。在计算接近 1 的项的对数时，使用 $\\ln(1+x)$ 以提高稳定性。\n- 使用 $\\beta^2 = 1 - 1/\\gamma^2$ 计算 $\\beta^2$，而不是通过直接对两个相近的大数作差来计算，并通过 $\\sqrt{\\gamma^2 - 1}$ 计算 $\\beta\\gamma$。\n\n测试套件和要求输出：\n设介质为具有给定参数的液态水。使用以下粒子案例和能量：\n1. 质子：$M = 938.2720813\\,\\text{MeV}$，$T = 5.0\\,\\text{MeV}$（低 $\\beta\\gamma$ 值，$\\delta=0$ 区域）。\n2. μ子：$M = 105.6583755\\,\\text{MeV}$，$T = 3.0\\times 10^3\\,\\text{MeV}$（中等 $\\beta\\gamma$ 值，$x_0 \\le x  x_1$）。\n3. μ子：$M = 105.6583755\\,\\text{MeV}$，$T = 6.65\\times 10^4\\,\\text{MeV}$（接近跃迁点 $x \\approx x_1$）。\n4. μ子：$M = 105.6583755\\,\\text{MeV}$，$T = 1.0\\times 10^6\\,\\text{MeV}$（极大 $\\beta\\gamma$ 值，$x \\ge x_1$）。\n\n对每种情况，使用数值稳定的策略计算无量纲方括号 $B$。您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表（例如，“[result1,result2,result3,result4]”）。每个结果必须是一个浮点数（无量纲）。不应打印任何其他文本。",
            "solution": "该问题要求计算一个无量纲的方括号因子 $B$，它出现在描述带电粒子在介质中平均电离能损的 Bethe-Bloch 公式中。任务强调高数值稳定性，尤其是在高粒子能量下，朴素的计算方法可能导致精度损失。\n\n整个过程包括三个主要阶段：\n1.  从第一性原理推导方括号 $B$ 的完整表达式。\n2.  分析表达式的数值稳定性，并推导出一个代数等价的稳定形式。\n3.  设计一个实现该稳定公式的计算算法。\n\n### 1. 方括号因子表达式的推导\n\n方括号因子定义为：\n$$ B \\equiv \\frac{1}{2}\\ln(\\mathcal{L}) - \\beta^2 - \\frac{\\delta}{2} $$\n此处，$\\beta$ 是粒子相对于光速 $c$ 的速度，$\\delta$ 是密度效应修正。$\\mathcal{L}$ 项必须从提供的物理背景中推导出来：“将单次碰撞中最大能量转移的运动学与电子质量 $m_e$ 和由 $I$ 设定的标度相结合”。一个重的自旋 1/2 粒子（如质子或 μ子）的平均能量损失的完整表达式包含一个对数项，该项取决于对自由电子的最大可能能量转移 $W_{max}$。Bethe-Bloch 公式中的方括号精确地为：\n$$ B = \\frac{1}{2}\\ln\\left(\\frac{2m_e c^2 \\beta^2 \\gamma^2 W_{max}}{I^2}\\right) - \\beta^2 - \\frac{\\delta}{2} $$\n将此与问题中的定义进行比较，我们确定：\n$$ \\mathcal{L} = \\frac{2m_e \\beta^2 \\gamma^2 W_{max}}{I^2} $$\n此处我们根据问题的约定设置 $c=1$。\n\n在质量为 $M$、总能量为 $E=\\gamma M$ 的入射粒子与质量为 $m_e$ 的静止电子之间的碰撞中，最大能量转移 $W_{max}$ 由相对论运动学给出：\n$$ W_{max} = \\frac{2 m_e p^2}{M^2 + m_e^2 + 2 m_e E} $$\n使用相对论关系式 $p^2 = E^2 - M^2 = M^2(\\gamma^2-1) = M^2\\beta^2\\gamma^2$ 和 $E=\\gamma M$，我们可以用 $\\gamma$ 和质量比 $m_e/M$ 来表示 $W_{max}$：\n$$ W_{max} = \\frac{2 m_e M^2 \\beta^2 \\gamma^2}{M^2 + m_e^2 + 2 m_e \\gamma M} = \\frac{2 m_e \\beta^2 \\gamma^2}{1 + 2(m_e/M)\\gamma + (m_e/M)^2} $$\n将这个 $W_{max}$ 代入 $\\mathcal{L}$ 的表达式中，得到：\n$$ \\mathcal{L} = \\frac{2m_e \\beta^2 \\gamma^2}{I^2} \\cdot \\frac{2 m_e \\beta^2 \\gamma^2}{1 + 2(m_e/M)\\gamma + (m_e/M)^2} = \\frac{(2 m_e \\beta^2 \\gamma^2)^2}{I^2(1 + 2(m_e/M)\\gamma + (m_e/M)^2)} $$\n现在可以通过应用对数恒等式将 $\\frac{1}{2}\\ln(\\mathcal{L})$ 项显式地写出：\n$$ \\frac{1}{2}\\ln(\\mathcal{L}) = \\frac{1}{2} \\left[ \\ln((2 m_e \\beta^2 \\gamma^2)^2) - \\ln(I^2(1 + 2(m_e/M)\\gamma + (m_e/M)^2)) \\right] $$\n$$ \\frac{1}{2}\\ln(\\mathcal{L}) = \\ln(2 m_e \\beta^2 \\gamma^2) - \\ln(I) - \\frac{1}{2}\\ln(1 + 2(m_e/M)\\gamma + (m_e/M)^2) $$\n$$ \\frac{1}{2}\\ln(\\mathcal{L}) = \\ln\\left(\\frac{2 m_e \\beta^2 \\gamma^2}{I}\\right) - \\frac{1}{2}\\ln\\left(1 + 2\\frac{m_e}{M}\\gamma + \\left(\\frac{m_e}{M}\\right)^2\\right) $$\n将此代入 $B$ 的定义中，我们得到完整但可能不稳定的表达式：\n$$ B = \\ln\\left(\\frac{2 m_e \\beta^2 \\gamma^2}{I}\\right) - \\frac{1}{2}\\ln\\left(1 + 2\\frac{m_e}{M}\\gamma + \\left(\\frac{m_e}{M}\\right)^2\\right) - \\beta^2 - \\frac{\\delta}{2} $$\n\n### 2. 数值稳定性分析与重新表述\n\n问题在于，当 $\\beta\\gamma$ 值很大时，存在灾难性抵消的可能。让我们分析当 $\\gamma \\to \\infty$ 时的行为。乘积 $\\beta\\gamma = \\sqrt{\\gamma^2-1}$ 近似按 $\\gamma$ 增长。变量 $x = \\log_{10}(\\beta\\gamma)$ 也无界增长。\n\n对于大的 $x$（具体来说，$x \\ge x_1$），密度修正为 $\\delta(x) = 2\\ln(10)x - C = 2\\ln(\\beta\\gamma) - C$。\n$B$ 的“朴素”表达式包含两个随能量对数增长的项：\n1.  主要对数项：$\\ln\\left(\\frac{2 m_e \\beta^2 \\gamma^2}{I}\\right) = \\ln(2m_e/I) + 2\\ln(\\beta\\gamma)$。该项按 $2\\ln(\\beta\\gamma)$ 增长。\n2.  密度修正项：$-\\frac{\\delta}{2} = -\\frac{1}{2}(2\\ln(\\beta\\gamma) - C) = -\\ln(\\beta\\gamma) + C/2$。该项按 $-\\ln(\\beta\\gamma)$ 增长。\n\n朴素计算会通过分别计算这些项然后求和来得到 $B$。这涉及到两个相近大数的相减：$(... + 2\\ln(\\beta\\gamma)) - (... + \\ln(\\beta\\gamma))$。虽然这并非完全抵消为一个小数，但此操作会降低数值精度。稳定的方法是在计算*之前*解析地进行这种抵消。\n\n让我们通过展开主对数项来重写 $B$：\n$$ B = \\left[ \\ln\\left(\\frac{2m_e}{I}\\right) + 2\\ln(\\beta\\gamma) \\right] - \\frac{1}{2}\\ln\\left(1 + 2\\frac{m_e}{M}\\gamma + \\left(\\frac{m_e}{M}\\right)^2\\right) - \\beta^2 - \\frac{\\delta}{2} $$\n现在，我们将不同能量区域的 $\\delta/2$ 表达式代入。\n\n**高能区域 ($x \\ge x_1$)：**\n在此区域，$\\delta/2 = \\ln(\\beta\\gamma) - C/2$。将其代入 $B$ 的表达式：\n$$ B = \\ln\\left(\\frac{2m_e}{I}\\right) + 2\\ln(\\beta\\gamma) - \\frac{1}{2}\\ln\\left(1+...\\right) - \\beta^2 - \\left(\\ln(\\beta\\gamma) - \\frac{C}{2}\\right) $$\n$2\\ln(\\beta\\gamma)$ 和 $-\\ln(\\beta\\gamma)$ 两项被解析地合并：\n$$ B_{stable} = \\ln\\left(\\frac{2m_e}{I}\\right) + \\ln(\\beta\\gamma) - \\frac{1}{2}\\ln\\left(1+...\\right) - \\beta^2 + \\frac{C}{2} $$\n这个表达式在数值上更优越，因为大的对数增长由单个项 $\\ln(\\beta\\gamma)$ 处理，从而消除了大数值的相减。为了获得更好的稳定性，剩余的对数项可以合并：\n$$ B_{stable} = \\ln\\left(\\frac{2m_e}{I}\\right) - \\beta^2 + \\frac{C}{2} + \\frac{1}{2}\\ln\\left(\\frac{(\\beta\\gamma)^2}{1 + 2\\frac{m_e}{M}\\gamma + \\left(\\frac{m_e}{M}\\right)^2}\\right) $$\n\n**中能区域 ($x_0 \\le x  x_1$)：**\n在此区域，$\\delta/2 = \\ln(\\beta\\gamma) - C/2 + \\frac{a}{2}(x_1 - x)^k$。遵循相同的步骤：\n$$ B = \\ln\\left(\\frac{2m_e}{I}\\right) + 2\\ln(\\beta\\gamma) - \\frac{1}{2}\\ln\\left(1+...\\right) - \\beta^2 - \\left(\\ln(\\beta\\gamma) - \\frac{C}{2} + \\frac{a}{2}(x_1-x)^k\\right) $$\n$$ B_{stable} = \\ln\\left(\\frac{2m_e}{I}\\right) - \\beta^2 + \\frac{C}{2} - \\frac{a}{2}(x_1-x)^k + \\frac{1}{2}\\ln\\left(\\frac{(\\beta\\gamma)^2}{1 + 2\\frac{m_e}{M}\\gamma + \\left(\\frac{m_e}{M}\\right)^2}\\right) $$\n\n**低能区域 ($x  x_0$)：**\n在此区域，$\\delta = 0$。没有大项需要相减，因此原始的朴素公式已经足够稳定，可以直接使用。\n$$ B = \\ln\\left(\\frac{2 m_e \\beta^2 \\gamma^2}{I}\\right) - \\frac{1}{2}\\ln\\left(1 + 2\\frac{m_e}{M}\\gamma + \\left(\\frac{m_e}{M}\\right)^2\\right) - \\beta^2 $$\n\n### 3. 计算算法\n\n为质量为 $M$、动能为 $T$ 的粒子计算 $B$ 的算法如下：\n\n1.  **定义常数**：存储 $m_e c^2$、$I$ 和 Sternheimer 参数（$x_0, x_1, C, a, k$）的值。将 $I$ 从 eV 转换为 MeV。\n2.  **计算运动学变量**：对于每个输入 $(M, T)$：\n    a.  总能量 $E = M + T$。\n    b.  洛伦兹因子 $\\gamma = E / M$。\n    c.  $\\beta^2 = 1 - 1/\\gamma^2$。\n    d.  $\\beta\\gamma = \\sqrt{\\gamma^2 - 1}$。\n3.  **计算方括号 $B$**：\n    a.  计算 $x = \\log_{10}(\\beta\\gamma)$。\n    b.  根据 $x$ 的值使用条件结构：\n        i.  **如果 $x  x_0$**：使用低能公式。\n        ii. **如果 $x_0 \\le x  x_1$**：使用稳定的中能公式。\n        iii. **如果 $x \\ge x_1$**：使用稳定的高能公式。\n    c.  项 $\\frac{1}{2}\\ln\\left(\\frac{(\\beta\\gamma)^2}{1 + 2\\frac{m_e}{M}\\gamma + \\left(\\frac{m_e}{M}\\right)^2}\\right)$ 涉及对一个可能的大数之比取对数。这在计算上是合理的；关键是先计算分子和分母，然后计算它们的比值，最后再取对数。\n\n这种结构化的方法确保了方括号因子 $B$ 的计算在所有能量区域都具有数值鲁棒性，符合要求。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless bracket factor from the Bethe-Bloch formula\n    for several test cases using a numerically stable algorithm.\n    \"\"\"\n    # Fundamental constants and material properties\n    # All energies are in MeV\n    \n    # Electron rest energy (MeV)\n    m_e = 0.51099895\n    \n    # Mean excitation energy for liquid water (MeV)\n    # Given as 75.0 eV, converted to MeV\n    I = 75.0e-6\n    \n    # Sternheimer density-effect parameters for liquid water\n    x0 = 0.240\n    x1 = 2.800\n    C_bar = 0.260 # Renamed to avoid conflict with kinetic energy variable T\n    a = 0.09116\n    k = 3.477\n    \n    # Pre-calculated constant for convenience\n    ln_10 = np.log(10)\n\n    test_cases = [\n        # Case 1: Proton (low energy)\n        {\"particle\": \"proton\", \"M\": 938.2720813, \"T\": 5.0},\n        # Case 2: Muon (intermediate energy)\n        {\"particle\": \"muon\", \"M\": 105.6583755, \"T\": 3.0e3},\n        # Case 3: Muon (near transition energy)\n        {\"particle\": \"muon\", \"M\": 105.6583755, \"T\": 6.65e4},\n        # Case 4: Muon (high energy)\n        {\"particle\": \"muon\", \"M\": 105.6583755, \"T\": 1.0e6},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M = case[\"M\"]\n        T = case[\"T\"]\n\n        # 1. Relativistic kinematics\n        # Total energy E = M + T\n        gamma = 1.0 + T / M\n        gamma_sq = gamma * gamma\n        \n        # Guard against non-physical inputs, though not expected here\n        if gamma_sq  1.0:\n            # This case corresponds to T  0, which is unphysical.\n            # Handle appropriately if necessary, e.g., by returning NaN.\n            # For this problem, all T > 0, so gamma_sq > 1.\n            pass\n\n        beta_sq = 1.0 - 1.0 / gamma_sq\n        beta_gamma = np.sqrt(gamma_sq - 1.0)\n        \n        # 2. Compute x = log10(beta*gamma) for density effect\n        x = np.log10(beta_gamma)\n\n        # 3. Calculate the bracket factor B based on the energy regime\n        \n        if x  x0:\n            # Low-energy regime (delta = 0). The naive formula is stable here.\n            # B = 1/2*ln(L) - beta^2\n            # where L = (2*me*beta^2*gamma^2)^2 / (I^2 * (1 + 2(me/M)gamma + (me/M)^2))\n            \n            w_max_denom = 1.0 + 2.0 * (m_e / M) * gamma + (m_e / M)**2\n            w_max = 2.0 * m_e * beta_gamma**2 / w_max_denom\n            \n            log_arg_L = (2.0 * m_e * beta_gamma**2 * w_max) / (I**2)\n            \n            bracket = 0.5 * np.log(log_arg_L) - beta_sq\n        \n        else:\n            # Intermediate and high-energy regimes. Use the stable formulation.\n            # This form analytically cancels the large ln(beta*gamma) terms.\n            log_term_arg_num = beta_gamma**2\n            log_term_arg_den = 1.0 + 2.0 * (m_e / M) * gamma + (m_e / M)**2\n            combined_log_term = 0.5 * np.log(log_term_arg_num / log_term_arg_den)\n\n            if x  x1: # Intermediate energy\n                # delta/2 = ln(beta*gamma) - C/2 + a/2 * (x1-x)^k\n                delta_rem_div_2 = - (a / 2.0) * (x1 - x)**k\n                \n                bracket = np.log(2.0 * m_e / I) - beta_sq + C_bar / 2.0 + combined_log_term + delta_rem_div_2\n\n            else: # High energy\n                # delta/2 = ln(beta*gamma) - C/2\n                # The remainder term is zero.\n                bracket = np.log(2.0 * m_e / I) - beta_sq + C_bar / 2.0 + combined_log_term\n\n        results.append(bracket)\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个精确的电离能损模型不仅需要一个数值稳定的核心，还必须包含对复杂物理过程的修正。在高能区，带电粒子产生的横向电场会被介质的极化效应所屏蔽，这种“密度效应”是Bethe-Bloch理论不可或缺的一部分。本练习将带你探究密度效应的渐近行为，并通过量化不同模型导致的偏差，来深刻理解它如何塑造了能损曲线在超相对论区间的“费米平台”。",
            "id": "3534727",
            "problem": "要求您设计并实现一个计算研究，探讨在超相对论性运动学条件下，密度效应修正（记作 $\\delta(\\beta\\gamma)$）如何改变重带电粒子在物质中电离能量损失的平台区。您的研究必须量化 $\\delta(\\beta\\gamma)$ 的两个不正确模型相对于一个从介质的介电极化推导出的、有物理依据的渐近模型，对渐近电离损失平台区造成的偏差。\n\n基本出发点是重带电粒子穿过物质的标准高能阻止本領表达式，该表达式由二元库仑碰撞和介质的介电响应推导得出，其中传递给电子的最大动能 $T_{\\max}$ 在重入射粒子极限下近似为 $T_{\\max} \\approx 2\\,m_e c^2\\,\\beta^2\\gamma^2$。密度效应修正 $\\delta(\\beta\\gamma)$ 源于介质对入射粒子横向电场的屏蔽效应。在超相对论性区域，$\\delta(\\beta\\gamma)$ 的领头阶渐近形式由材料的等离子体频率（通过 $\\hbar\\omega_p$）和平均激发能 $I$ 控制，并且由于远处碰撞的极化抑制作用增强，它会随 $\\beta\\gamma$ 对数增长。\n\n您必须实现 $\\delta(\\beta\\gamma)$ 的三个模型：\n- 从介质介电响应中得到的、有物理依据的高能渐近模型 $\\delta_{\\text{asym}}(\\beta\\gamma)$（需在您的解法中推导并使用）。\n- 一个不正确的模型 $\\delta_{\\text{zero}}(\\beta\\gamma) = 0$，该模型完全忽略了密度效应。\n- 一个不正确的模型 $\\delta_{\\text{frozen}}(\\beta\\gamma) = \\delta_{\\text{asym}}(\\beta\\gamma_{\\text{ref}})$，其中 $\\beta\\gamma_{\\text{ref}} = 100$，该模型将密度效应“冻结”在超相对论性区域的边界值上。\n\n对于重入射粒子极限下的单电荷 μ子（$z=1$），使用包含密度效应修正的标准高能表达式计算质量阻止本领，在超相对论性运动学条件下忽略壳层修正和 Bloch 修正。使用以下常量和约定：\n- $K = 0.307075\\,\\text{MeV}\\,\\text{mol}^{-1}\\,\\text{cm}^2\\,\\text{g}^{-1}$，\n- $m_e c^2 = 0.51099895\\,\\text{MeV}$，\n- $T_{\\max} \\approx 2\\,m_e c^2\\,\\beta^2\\gamma^2$，\n- $\\beta = \\frac{\\beta\\gamma}{\\sqrt{1+(\\beta\\gamma)^2}}$ 且 $\\gamma = \\sqrt{1+(\\beta\\gamma)^2}$，\n- 取 $z=1$，\n- 当 $I$ 和 $\\hbar\\omega_p$ 出现在 $\\delta(\\beta\\gamma)$ 中时，使用电子伏特 (eV) 单位；当 $I$ 出现在阻止本领表达式的对数函数内部时，需将其转换为兆电子伏特 (MeV) 单位，以确保宗量为无量纲，\n- 在指定的超相对论性 $\\beta\\gamma$ 值下，忽略壳层修正及更高阶项。\n\n由不正确的密度效应模型引起的质量阻止本领的相对偏差定义为\n$$\n\\text{bias}(\\beta\\gamma) \\equiv \\frac{S_{\\text{model}}(\\beta\\gamma)-S_{\\text{asym}}(\\beta\\gamma)}{S_{\\text{asym}}(\\beta\\gamma)},\n$$\n结果以纯小数（而非百分比）表示，其中 $S_{\\text{asym}}$ 使用 $\\delta_{\\text{asym}}$，$S_{\\text{model}}$ 使用 $\\delta_{\\text{zero}}$ 或 $\\delta_{\\text{frozen}}$。\n\n测试套件。使用以下材料，这些材料涵盖了一系列等离子体频率和激发能，其中 $Z/A$ 为原子序数与质量数之比，$I$ 为平均激发能，$\\hbar\\omega_p$ 为等离激元能量：\n- 碳（金刚石）：$Z/A = 0.499$，$I = 81$ eV，$\\hbar\\omega_p = 27$ eV，\n- 硅：$Z/A = 0.499$，$I = 173$ eV，$\\hbar\\omega_p = 16.7$ eV，\n- 铁：$Z/A = 0.465$，$I = 286$ eV，$\\hbar\\omega_p = 22$ eV，\n- 铅：$Z/A = 0.396$，$I = 823$ eV，$\\hbar\\omega_p = 13.5$ eV。\n\n在以下超相对论性运动学条件下评估偏差：\n- $\\beta\\gamma \\in \\{200,\\,10000,\\,1000000\\}$。\n\n算法要求与数值细节：\n- 实现重入射粒子阻止本领表达式时，应与领头阶高能形式保持一致，并通过 $\\delta(\\beta\\gamma)$ 包含密度效应。\n- 在解法中，使用 $\\hbar\\omega_p$ 和 $I$，从高能极限下介电极化的基本原理出发，实现 $\\delta_{\\text{asym}}(\\beta\\gamma)$。\n- 对于每种材料和每个 $\\beta\\gamma$ 值，按给定顺序计算两个偏差值：首先是 $\\delta_{\\text{zero}}$ 的偏差，其次是 $\\delta_{\\text{frozen}}$（其中 $\\beta\\gamma_{\\text{ref}}=100$）的偏差。\n- 将每个偏差值四舍五入至6位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个扁平列表，内含 $2\\times 4 \\times 3 = 24$ 个四舍五入后的偏差值，以逗号分隔，并用方括号括起来。\n- 迭代顺序必须是材料主序、运动学次序：碳在 $\\beta\\gamma=200,10000,1000000$ 时的值；硅在 $\\beta\\gamma=200,10000,1000000$ 时的值；铁在 $\\beta\\gamma=200,10000,1000000$ 时的值；铅在 $\\beta\\gamma=200,10000,1000000$ 时的值。对于每种情况，首先输出 $\\delta_{\\text{zero}}$ 的偏差，然后输出 $\\delta_{\\text{frozen}}$ 的偏差。\n- 仅为格式示例：$[b_{1},b_{2},\\dots,b_{24}]$，其中每个 $b_i$ 是一个四舍五入到6位小数的小数值。\n\n所有输出均为无量纲小数。输出中不应出现物理单位。本问题不使用角度。",
            "solution": "用户要求进行一项计算研究，探讨在超相对论能量下，密度效应修正 $\\delta(\\beta\\gamma)$ 的不同模型对重带电粒子电离能量损失的影响。这需要首先验证问题陈述，然后依循物理原理推导必要的公式，并描述计算实现过程。\n\n### 步骤1：提取已知条件\n- **任务**：计算两种不正确的密度效应修正模型相对于一个有物理依据的渐近模型所导致的质量阻止本领的相对偏差。\n- **粒子**：重入射粒子极限下的单电荷 μ子（$z=1$）。\n- **主要表达式**：标准高能阻止本領表达式。\n- **常量**：\n    - $K = 0.307075$ MeV mol$^{-1}$ cm$^2$ g$^{-1}$\n    - $m_e c^2 = 0.51099895$ MeV\n- **近似**：\n    - $T_{\\max} \\approx 2\\,m_e c^2\\,\\beta^2\\gamma^2$\n    - 忽略壳层修正和 Bloch 修正。\n- **运动学关系**：$\\beta = \\frac{\\beta\\gamma}{\\sqrt{1+(\\beta\\gamma)^2}}$，$\\gamma = \\sqrt{1+(\\beta\\gamma)^2}$\n- **单位约定**：$I$ 和 $\\hbar\\omega_p$ 以 eV 给出。当 $I$ 与其他 MeV 量一同出现在对数函数中时，必须将其转换为 MeV。\n- **密度效应模型**：\n    1. $\\delta_{\\text{asym}}(\\beta\\gamma)$：待推导的、有物理依据的高能渐近模型。\n    2. $\\delta_{\\text{zero}}(\\beta\\gamma) = 0$\n    3. $\\delta_{\\text{frozen}}(\\beta\\gamma) = \\delta_{\\text{asym}}(\\beta\\gamma_{\\text{ref}})$，其中 $\\beta\\gamma_{\\text{ref}} = 100$。\n- **偏差定义**：\n    $$\n    \\text{bias}(\\beta\\gamma) \\equiv \\frac{S_{\\text{model}}(\\beta\\gamma)-S_{\\text{asym}}(\\beta\\gamma)}{S_{\\text{asym}}(\\beta\\gamma)}\n    $$\n- **材料与性质**（$Z/A$，$I$ 单位 eV，$\\hbar\\omega_p$ 单位 eV）：\n    - 碳（金刚石）：$Z/A = 0.499$，$I = 81$ eV，$\\hbar\\omega_p = 27$ eV\n    - 硅：$Z/A = 0.499$，$I = 173$ eV，$\\hbar\\omega_p = 16.7$ eV\n    - 铁：$Z/A = 0.465$，$I = 286$ eV，$\\hbar\\omega_p = 22$ eV\n    - 铅：$Z/A = 0.396$，$I = 823$ eV，$\\hbar\\omega_p = 13.5$ eV\n- **运动学测试点**：$\\beta\\gamma \\in \\{200,\\,10000,\\,1000000\\}$\n- **输出要求**：\n    - 将偏差值四舍五入至6位小数。\n    - 输出包含24个偏差值的单个扁平列表。\n    - 迭代顺序：材料主序，运动学次序。对于每种情况，先是 $\\delta_{\\text{zero}}$ 的偏差，然后是 $\\delta_{\\text{frozen}}$ 的偏差。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学或事实上的不健全性**：该问题基于电离能量损失的 Bethe-Bloch 理论和完善确立的密度效应修正。引用的所有物理原理和常量都是高能物理领域的标准。该问题在科学上是合理的。\n2.  **不可形式化或不相关**：该问题是计算高能物理领域内一个形式化的计算任务，并非隐喻或不相关。\n3.  **不完整或矛盾的设置**：所有必要的常量、材料性质和运动学点都已提供。推导渐近密度效应模型的要求是一项标准任务，而非信息遗漏。问题设置是完整且一致的。\n4.  **不切实际或不可行**：所给的材料、常量和运动学区间对于高能 μ子（例如，在宇宙射线或粒子加速器中）的研究是物理上现实的。该问题是现实的。\n5.  **不适定或结构不良**：该问题要求进行具体的、确定性的计算。对于每个定义的情况，所用公式都能导出一个唯一的、稳定的数值解。该问题是适定的。\n6.  **伪深刻、琐碎或同义反复**：该问题需要正确理解和应用 Bethe-Bloch 公式及密度效应，包括推导其渐近形式。不同模型的比较为一种物理效应提供了有意义的定量分析。这并非一个琐碎的问题。\n7.  **超出科学可验证范围**：计算基于已确立的物理理论，并且可通过直接计算来验证。\n\n### 步骤3：结论与行动\n问题有效。这是一个适定的、有科学依据的计算物理问题。将提供解决方案。\n\n### 基于原理的设计与求解\n\n这个问题的核心是计算重带电粒子的质量阻止本领 $S = -(1/\\rho) dE/dx$。我们将使用 Bethe-Bloch 方程的标准高能形式。\n\n**1. 质量阻止本领表达式**\n\n问题指定使用 $T_{\\max} \\approx 2\\,m_e c^2\\,\\beta^2\\gamma^2$ 的“标准高能阻止本領表达式”。文献中质量阻止本领的标准公式为：\n$$\nS(\\beta\\gamma) = K z^2 \\frac{Z}{A} \\frac{1}{\\beta^2} \\left[ \\frac{1}{2}\\ln\\left(\\frac{2 m_e c^2 \\beta^2 \\gamma^2 T_{\\max}}{I^2}\\right) - \\beta^2 - \\frac{\\delta(\\beta\\gamma)}{2} \\right]\n$$\n将给定的 $T_{\\max}$ 近似代入，可以简化对数项：\n$$\n\\frac{1}{2}\\ln\\left(\\frac{2 m_e c^2 \\beta^2 \\gamma^2 (2 m_e c^2 \\beta^2 \\gamma^2)}{I^2}\\right) = \\frac{1}{2}\\ln\\left(\\left(\\frac{2 m_e c^2 \\beta^2 \\gamma^2}{I}\\right)^2\\right) = \\ln\\left(\\frac{2 m_e c^2 \\beta^2 \\gamma^2}{I}\\right)\n$$\n因此，对于单电荷粒子（$z=1$），表达式为：\n$$\nS(\\beta\\gamma) = K \\frac{Z}{A} \\frac{1}{\\beta^2} \\left[ \\ln\\left(\\frac{2 m_e c^2 (\\beta\\gamma)^2}{I}\\right) - \\beta^2 - \\frac{\\delta(\\beta\\gamma)}{2} \\right]\n$$\n其中 $\\beta^2 = (\\beta\\gamma)^2 / (1+(\\beta\\gamma)^2)$。平均激发能 $I$ 必须以 MeV 表示，以确保对数的宗量是无量纲的，因为 $m_e c^2$ 是以 MeV 为单位的。\n\n**2. 渐近密度效应修正 $\\delta_{\\text{asym}}(\\beta\\gamma)$**\n\n密度效应修正 $\\delta(\\beta\\gamma)$ 解释了由于入射粒子电场引起的介质极化，导致对远处原子的能量损失减少的现象。在超相对论能量下，横向电场延伸至很远的距离，但介质的集体响应（等离子体振荡）会在等离子体屏蔽距离 $c/\\omega_p$ 之外屏蔽该电场。这有效地截断了相互作用的范围，从而阻止了阻止本领像 $\\ln(\\gamma^2)$ 那样增长。\n\n可以从介质的介电性质推导出的密度效应修正的标准高能渐近形式为：\n$$\n\\delta_{\\text{asym}}(\\beta\\gamma) = \\ln\\left(\\frac{(\\hbar\\omega_p)^2}{I^2}\\right) + \\ln((\\beta\\gamma)^2) - 1\n$$\n这可以重写为：\n$$\n\\delta_{\\text{asym}}(\\beta\\gamma) = 2\\ln(\\beta\\gamma) + 2\\ln\\left(\\frac{\\hbar\\omega_p}{I}\\right) - 1\n$$\n这里，$\\hbar\\omega_p$ 是等离子体能量，$I$ 是平均激发能。比率 $\\hbar\\omega_p/I$ 是无量纲的，因此它们的单位 (eV) 会消掉。这个模型表明 $\\delta$ 随 $2\\ln(\\beta\\gamma)$ 增长，这部分抵消了阻止本领主对数项中 $2\\ln(\\beta\\gamma)$ 的增长，从而导致了“费米平台区”特有的缓慢对数上升。这就是问题所要求的有物理依据的模型 $\\delta_{\\text{asym}}$。\n\n**3. 计算模型**\n\n我们为密度效应实现三个不同的模型：\n- **渐近模型**：$\\delta_{\\text{asym}}(\\beta\\gamma) = 2\\ln(\\beta\\gamma) + 2\\ln(\\hbar\\omega_p/I) - 1$。这作为超相对论区域中物理正确描述的基准。\n- **零模型**：$\\delta_{\\text{zero}}(\\beta\\gamma) = 0$。该模型完全忽略密度效应，这应导致在高 $\\beta\\gamma$ 值下显著高估阻止本领。\n- **冻结模型**：$\\delta_{\\text{frozen}}(\\beta\\gamma) = \\delta_{\\text{asym}}(\\beta\\gamma_{\\text{ref}})$，其中 $\\beta\\gamma_{\\text{ref}} = 100$。该模型错误地假设密度效应饱和于一个固定值，这应导致对于 $\\beta\\gamma > \\beta\\gamma_{\\text{ref}}$ 的情况，修正值被低估（从而高估了阻止本领）。\n\n**4. 偏差计算**\n\n相对偏差定义为 $\\text{bias} = (S_{\\text{model}} - S_{\\text{asym}}) / S_{\\text{asym}}$。为了计算效率和稳定性，我们来简化这个表达式。\n设 $S(\\delta) = C_p \\left[ L - \\frac{\\delta}{2} \\right]$，其中 $C_p = K \\frac{Z}{A} \\frac{1}{\\beta^2}$ 是一个预因子，$L = \\ln\\left(\\frac{2 m_e c^2 (\\beta\\gamma)^2}{I}\\right) - \\beta^2$。\n那么偏差为：\n$$\n\\text{bias} = \\frac{C_p \\left[ L - \\frac{\\delta_{\\text{model}}}{2} \\right] - C_p \\left[ L - \\frac{\\delta_{\\text{asym}}}{2} \\right]}{C_p \\left[ L - \\frac{\\delta_{\\text{asym}}}{2} \\right]} = \\frac{-\\frac{\\delta_{\\text{model}}}{2} + \\frac{\\delta_{\\text{asym}}}{2}}{L - \\frac{\\delta_{\\text{asym}}}{2}}\n$$\n$$\n\\text{bias} = \\frac{\\delta_{\\text{asym}} - \\delta_{\\text{model}}}{2 \\left( \\ln\\left(\\frac{2 m_e c^2 (\\beta\\gamma)^2}{I}\\right) - \\beta^2 - \\frac{\\delta_{\\text{asym}}}{2} \\right)}\n$$\n这个简化后的公式在数值上是稳健的，并且避免了重复计算完整的阻止本领值。分母是使用渐近模型时阻止本领表达式主括号中项的 $2$ 倍。\n\n**5. 算法**\n\n计算流程如下：\n1.  定义所有物理常量和材料性质。\n2.  创建运动学点（$\\beta\\gamma$ 值）的列表。\n3.  为材料（$Z/A$，$I$，$\\hbar\\omega_p$）建立数据结构。\n4.  遍历每种材料。\n5.  在材料循环内部，遍历每个 $\\beta\\gamma$ 值。\n6.  对每个（材料, $\\beta\\gamma$）对，执行以下操作：\n    a. 计算 $\\beta^2 = (\\beta\\gamma)^2 / (1+(\\beta\\gamma)^2)$ 并将 $I$ 转换为 MeV。\n    b. 计算三个密度修正值：$\\delta_{\\text{asym}}(\\beta\\gamma)$，$\\delta_{\\text{zero}}(\\beta\\gamma)=0$ 和 $\\delta_{\\text{frozen}}(\\beta\\gamma)=\\delta_{\\text{asym}}(100)$。\n    c. 计算偏差公式的分母项：$D = 2 \\left( \\ln\\left(\\frac{2 m_e c^2 (\\beta\\gamma)^2}{I_{\\text{MeV}}}\\right) - \\beta^2 - \\frac{\\delta_{\\text{asym}}}{2} \\right)$。\n    d. 计算零模型的偏差：$\\text{bias}_{\\text{zero}} = (\\delta_{\\text{asym}} - \\delta_{\\text{zero}}) / D$。\n    e. 计算冻结模型的偏差：$\\text{bias}_{\\text{frozen}} = (\\delta_{\\text{asym}} - \\delta_{\\text{frozen}}) / D$。\n    f. 将两个偏差都四舍五入到6位小数，并按指定顺序附加到结果列表中。\n7.  将最终列表格式化为所需的字符串输出：`[value1,value2,...,value24]`。\n\n这种结构化的方法确保了精确满足问题的所有要求，并且计算基于可靠的物理和数值原理。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fractional bias in mass stopping power due to incorrect\n    density effect models at ultrarelativistic energies.\n    \"\"\"\n\n    # Physical constants\n    K = 0.307075  # MeV mol^-1 cm^2 g^-1\n    MEC2 = 0.51099895  # MeV\n\n    # Test suite: Materials and their properties\n    # (Name, Z/A, I in eV, hbar*omega_p in eV)\n    materials = [\n        ('Carbon (diamond)', 0.499, 81.0, 27.0),\n        ('Silicon', 0.499, 173.0, 16.7),\n        ('Iron', 0.465, 286.0, 22.0),\n        ('Lead', 0.396, 823.0, 13.5),\n    ]\n\n    # Kinematic points\n    beta_gammas = [200.0, 10000.0, 1000000.0]\n    \n    # Frozen model reference kinematics\n    beta_gamma_ref = 100.0\n\n    def delta_asym(beta_gamma, hw_p_eV, I_eV):\n        \"\"\"Asymptotic density effect correction model.\"\"\"\n        if beta_gamma = 0:\n            # log is undefined for non-positive values\n            return -np.inf \n        \n        # del = 2*ln(bg) + 2*ln(hw_p/I) - 1\n        return 2 * np.log(beta_gamma) + 2 * np.log(hw_p_eV / I_eV) - 1\n\n    def delta_zero(beta_gamma, hw_p_eV, I_eV):\n        \"\"\"Zero density effect correction model.\"\"\"\n        return 0.0\n\n    def delta_frozen(beta_gamma, hw_p_eV, I_eV):\n        \"\"\"Frozen density effect correction model.\"\"\"\n        return delta_asym(beta_gamma_ref, hw_p_eV, I_eV)\n\n    results = []\n    \n    # Main loop: Iterate through materials and kinematics\n    # Iteration order: Material-major, kinematics-minor\n    for _, Z_A, I_eV, hw_p_eV in materials:\n        for bg in beta_gammas:\n            # Convert I to MeV for consistency in the logarithm argument\n            I_MeV = I_eV / 1e6\n            \n            # Calculate beta^2\n            bg_sq = bg**2\n            beta_sq = bg_sq / (1 + bg_sq)\n\n            # Calculate the three density effect values for the current bg\n            d_asym_val = delta_asym(bg, hw_p_eV, I_eV)\n            d_zero_val = delta_zero(bg, hw_p_eV, I_eV)\n            d_frozen_val = delta_frozen(bg, hw_p_eV, I_eV)\n            \n            # The simplified bias formula is:\n            # bias = (delta_asym - delta_model) / (2 * bracket_term_asym)\n            # where bracket_term_asym is the term in [...] of the stopping power\n            # formula using delta_asym.\n            \n            # Calculate the bracket term for the asymptotic model\n            log_term = np.log((2 * MEC2 * bg_sq) / I_MeV)\n            bracket_asym = log_term - beta_sq - d_asym_val / 2.0\n            \n            # Denominator for the bias formula\n            bias_denominator = 2 * bracket_asym\n            \n            # --- Bias for delta_zero model ---\n            # Numerator for delta_zero model bias\n            bias_numerator_zero = d_asym_val - d_zero_val\n            bias_zero = bias_numerator_zero / bias_denominator\n            results.append(round(bias_zero, 6))\n\n            # --- Bias for delta_frozen model ---\n            # Numerator for delta_frozen model bias\n            bias_numerator_frozen = d_asym_val - d_frozen_val\n            bias_frozen = bias_numerator_frozen / bias_denominator\n            results.append(round(bias_frozen, 6))\n\n    # Format and print the final output as a single-line comma-separated list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "模拟的最终价值在于其预测与现实的吻合程度。在开发和优化了电离能损模型之后，下一步便是对照权威的参考数据对其进行严格的验证。本练习将指导你使用$\\chi^2$（卡方）检验这一高能物理学中标准的拟合优度检验方法，来量化你的模拟结果与粒子数据组（PDG）参考值之间的一致性，并学习如何处理数据中的不确定性及其相关性。",
            "id": "3534700",
            "problem": "一个基于贝特-布洛赫机制的电离能量损失计算高能物理模拟，预测了μ子穿过多种材料在两个运动学点上的质量阻止本领。为评估该模拟与经过充分检验的参考数据之间的一致性，请考虑以下科学上真实的设定。参考值由粒子数据组 (PDG) 汇编，以 $\\mathrm{MeV}\\,\\mathrm{cm}^{2}\\,\\mathrm{g}^{-1}$ 为单位的质量阻止本领及其一倍标准差不确定度的形式给出。模拟值由一个蒙特卡洛 (MC) 代码生成，该代码使用了对相关过程的物理精确实现。\n\n给定两个相对论运动学参数 $\\beta\\gamma$ 的值，即 $\\beta\\gamma = 3$ 和 $\\beta\\gamma = 10$，以及三种材料：硅、氩和铅。对于每种材料 $m$ 和运动学点 $e \\in \\{3, 10\\}$：\n- PDG 参考质量阻止本领为 $R_{m,e}$。\n- PDG 参考不确定度为 $\\sigma_{m,e}$。\n- MC 预测的质量阻止本领为 $S_{m,e}$。\n- 对于固定材料，两个运动学点的 PDG 参考不确定度之间存在一个相关系数 $\\rho_{m}$，该系数源于共同的密度效应和校准系统误差。\n\n数据：\n- 硅 (Silicon)：$R_{\\mathrm{Si},3} = 1.664$，$\\sigma_{\\mathrm{Si},3} = 0.010$；$R_{\\mathrm{Si},10} = 1.700$，$\\sigma_{\\mathrm{Si},10} = 0.010$；$\\rho_{\\mathrm{Si}} = 0.3$。MC：$S_{\\mathrm{Si},3} = 1.680$，$S_{\\mathrm{Si},10} = 1.690$。\n- 氩 (Argon)：$R_{\\mathrm{Ar},3} = 2.060$，$\\sigma_{\\mathrm{Ar},3} = 0.030$；$R_{\\mathrm{Ar},10} = 2.120$，$\\sigma_{\\mathrm{Ar},10} = 0.030$；$\\rho_{\\mathrm{Ar}} = 0.3$。MC：$S_{\\mathrm{Ar},3} = 2.030$，$S_{\\mathrm{Ar},10} = 2.150$。\n- 铅 (Lead)：$R_{\\mathrm{Pb},3} = 1.120$，$\\sigma_{\\mathrm{Pb},3} = 0.020$；$R_{\\mathrm{Pb},10} = 1.150$，$\\sigma_{\\mathrm{Pb},10} = 0.020$；$\\rho_{\\mathrm{Pb}} = 0.3$。MC：$S_{\\mathrm{Pb},3} = 1.100$，$S_{\\mathrm{Pb},10} = 1.170$。\n\n从残差的基本统计定义和带相关性的高斯误差传播出发，按以下步骤进行：\n1. 定义残差 $\\Delta_{m,e} = S_{m,e} - R_{m,e}$。\n2. 对每种材料 $m$，使用不确定度 $\\sigma_{m,3}$ 和 $\\sigma_{m,10}$ 以及相关性 $\\rho_{m}$ 构建 $2 \\times 2$ 协方差矩阵 $C_{m}$。\n3. 按照 $(\\mathrm{Si},3)$、$(\\mathrm{Si},10)$、$(\\mathrm{Ar},3)$、$(\\mathrm{Ar},10)$、$(\\mathrm{Pb},3)$、$(\\mathrm{Pb},10)$ 的顺序，构成堆叠残差向量 $\\Delta$ 和相应的以 $C_{m}$ 为块的块对角协方差矩阵 $C$。\n4. 使用高斯似然框架，计算所有材料和运动学点的总卡方值 $\\chi^{2} = \\Delta^{\\top} C^{-1} \\Delta$。\n\n将最终的 $\\chi^{2}$ 值四舍五入到四位有效数字。将最终值表示为一个无量纲数。",
            "solution": "该问题经验证具有科学依据、提法明确且客观。它提供了一套完整且一致的数据，以及一个计算 $\\chi^2$ 统计量的清晰步骤，这是物理学中进行拟合优度检验的标准方法。所有提供的值对于μ子能量损失而言都是物理上真实的。我们着手进行解答。\n\n该问题要求计算总卡方统计量 $\\chi^2$，以评估蒙特卡洛 (MC) 模拟数据与粒子数据组 (PDG) 参考数据之间的一致性。总 $\\chi^2$ 定义为 $\\chi^2 = \\Delta^{\\top} C^{-1} \\Delta$，其中 $\\Delta$ 是残差向量，而 $C$ 是参考数据不确定度的总协方差矩阵。\n\n该过程按规定的四个步骤执行。\n\n首先，我们计算每种材料 $m \\in \\{\\mathrm{Si}, \\mathrm{Ar}, \\mathrm{Pb}\\}$ 和每个运动学点 $e \\in \\{3, 10\\}$ 的残差 $\\Delta_{m,e} = S_{m,e} - R_{m,e}$。\n对于硅 (Si)：\n$$\n\\Delta_{\\mathrm{Si},3} = S_{\\mathrm{Si},3} - R_{\\mathrm{Si},3} = 1.680 - 1.664 = 0.016\n$$\n$$\n\\Delta_{\\mathrm{Si},10} = S_{\\mathrm{Si},10} - R_{\\mathrm{Si},10} = 1.690 - 1.700 = -0.010\n$$\n对于氩 (Ar)：\n$$\n\\Delta_{\\mathrm{Ar},3} = S_{\\mathrm{Ar},3} - R_{\\mathrm{Ar},3} = 2.030 - 2.060 = -0.030\n$$\n$$\n\\Delta_{\\mathrm{Ar},10} = S_{\\mathrm{Ar},10} - R_{\\mathrm{Ar},10} = 2.150 - 2.120 = 0.030\n$$\n对于铅 (Pb)：\n$$\n\\Delta_{\\mathrm{Pb},3} = S_{\\mathrm{Pb},3} - R_{\\mathrm{Pb},3} = 1.100 - 1.120 = -0.020\n$$\n$$\n\\Delta_{\\mathrm{Pb},10} = S_{\\mathrm{Pb},10} - R_{\\mathrm{Pb},10} = 1.170 - 1.150 = 0.020\n$$\n\n其次，我们为每种材料构建 $2 \\times 2$ 协方差矩阵 $C_{m}$。协方差矩阵的元素由 $(C_m)_{ij} = \\rho \\sigma_i \\sigma_j$ 给出，对于我们的两点系统，即为：\n$$\nC_{m} = \\begin{pmatrix} \\sigma_{m,3}^2  \\rho_{m} \\sigma_{m,3} \\sigma_{m,10} \\\\ \\rho_{m} \\sigma_{m,3} \\sigma_{m,10}  \\sigma_{m,10}^2 \\end{pmatrix}\n$$\n对于硅，$\\sigma_{\\mathrm{Si},3} = 0.010$，$\\sigma_{\\mathrm{Si},10} = 0.010$，以及 $\\rho_{\\mathrm{Si}} = 0.3$：\n$$\nC_{\\mathrm{Si}} = \\begin{pmatrix} (0.010)^2  (0.3)(0.010)(0.010) \\\\ (0.3)(0.010)(0.010)  (0.010)^2 \\end{pmatrix} = \\begin{pmatrix} 0.0001  0.00003 \\\\ 0.00003  0.0001 \\end{pmatrix}\n$$\n对于氩，$\\sigma_{\\mathrm{Ar},3} = 0.030$，$\\sigma_{\\mathrm{Ar},10} = 0.030$，以及 $\\rho_{\\mathrm{Ar}} = 0.3$：\n$$\nC_{\\mathrm{Ar}} = \\begin{pmatrix} (0.030)^2  (0.3)(0.030)(0.030) \\\\ (0.3)(0.030)(0.030)  (0.030)^2 \\end{pmatrix} = \\begin{pmatrix} 0.0009  0.00027 \\\\ 0.00027  0.0009 \\end{pmatrix}\n$$\n对于铅，$\\sigma_{\\mathrm{Pb},3} = 0.020$，$\\sigma_{\\mathrm{Pb},10} = 0.020$，以及 $\\rho_{\\mathrm{Pb}} = 0.3$：\n$$\nC_{\\mathrm{Pb}} = \\begin{pmatrix} (0.020)^2  (0.3)(0.020)(0.020) \\\\ (0.3)(0.020)(0.020)  (0.020)^2 \\end{pmatrix} = \\begin{pmatrix} 0.0004  0.00012 \\\\ 0.00012  0.0004 \\end{pmatrix}\n$$\n\n第三，我们构成堆叠残差向量 $\\Delta$ 和块对角总协方差矩阵 $C$。不同材料的测量是不相关的，因此 $C$ 是块对角的。\n$$\n\\Delta = \\begin{pmatrix} \\Delta_{\\mathrm{Si},3} \\\\ \\Delta_{\\mathrm{Si},10} \\\\ \\Delta_{\\mathrm{Ar},3} \\\\ \\Delta_{\\mathrm{Ar},10} \\\\ \\Delta_{\\mathrm{Pb},3} \\\\ \\Delta_{\\mathrm{Pb},10} \\end{pmatrix} = \\begin{pmatrix} 0.016 \\\\ -0.010 \\\\ -0.030 \\\\ 0.030 \\\\ -0.020 \\\\ 0.020 \\end{pmatrix}\n\\quad \\text{和} \\quad\nC = \\begin{pmatrix} C_{\\mathrm{Si}}  0  0 \\\\ 0  C_{\\mathrm{Ar}}  0 \\\\ 0  0  C_{\\mathrm{Pb}} \\end{pmatrix}\n$$\n\n第四，我们计算总卡方值 $\\chi^2 = \\Delta^{\\top} C^{-1} \\Delta$。由于 $C$ 的块对角结构，总 $\\chi^2$ 是每种材料的 $\\chi^2$ 值之和：$\\chi^2 = \\sum_{m} \\chi_m^2$，其中 $\\chi_m^2 = \\Delta_m^{\\top} C_m^{-1} \\Delta_m$ 且 $\\Delta_m = (\\Delta_{m,3}, \\Delta_{m,10})^\\top$。\n对于一个具有残差 $\\delta_1, \\delta_2$，不确定度 $\\sigma_1, \\sigma_2$ 和相关性 $\\rho$ 的二维问题，通用公式为：\n$$\n\\chi^2 = \\frac{1}{1-\\rho^2} \\left[ \\left(\\frac{\\delta_1}{\\sigma_1}\\right)^2 + \\left(\\frac{\\delta_2}{\\sigma_2}\\right)^2 - 2\\rho\\left(\\frac{\\delta_1}{\\sigma_1}\\right)\\left(\\frac{\\delta_2}{\\sigma_2}\\right) \\right]\n$$\n对于所有材料，$\\rho = 0.3$，所以 $1-\\rho^2 = 1 - (0.3)^2 = 1 - 0.09 = 0.91$。\n\n对于硅：\n$$\n\\chi_{\\mathrm{Si}}^2 = \\frac{1}{0.91} \\left[ \\left(\\frac{0.016}{0.010}\\right)^2 + \\left(\\frac{-0.010}{0.010}\\right)^2 - 2(0.3)\\left(\\frac{0.016}{0.010}\\right)\\left(\\frac{-0.010}{0.010}\\right) \\right]\n$$\n$$\n\\chi_{\\mathrm{Si}}^2 = \\frac{1}{0.91} \\left[ (1.6)^2 + (-1)^2 - 2(0.3)(1.6)(-1) \\right] = \\frac{1}{0.91} [2.56 + 1 + 0.96] = \\frac{4.52}{0.91}\n$$\n\n对于氩：\n$$\n\\chi_{\\mathrm{Ar}}^2 = \\frac{1}{0.91} \\left[ \\left(\\frac{-0.030}{0.030}\\right)^2 + \\left(\\frac{0.030}{0.030}\\right)^2 - 2(0.3)\\left(\\frac{-0.030}{0.030}\\right)\\left(\\frac{0.030}{0.030}\\right) \\right]\n$$\n$$\n\\chi_{\\mathrm{Ar}}^2 = \\frac{1}{0.91} \\left[ (-1)^2 + (1)^2 - 2(0.3)(-1)(1) \\right] = \\frac{1}{0.91} [1 + 1 + 0.6] = \\frac{2.6}{0.91}\n$$\n\n对于铅：\n$$\n\\chi_{\\mathrm{Pb}}^2 = \\frac{1}{0.91} \\left[ \\left(\\frac{-0.020}{0.020}\\right)^2 + \\left(\\frac{0.020}{0.020}\\right)^2 - 2(0.3)\\left(\\frac{-0.020}{0.020}\\right)\\left(\\frac{0.020}{0.020}\\right) \\right]\n$$\n$$\n\\chi_{\\mathrm{Pb}}^2 = \\frac{1}{0.91} \\left[ (-1)^2 + (1)^2 - 2(0.3)(-1)(1) \\right] = \\frac{1}{0.91} [1 + 1 + 0.6] = \\frac{2.6}{0.91}\n$$\n\n总 $\\chi^2$ 是这些贡献的总和：\n$$\n\\chi^2 = \\chi_{\\mathrm{Si}}^2 + \\chi_{\\mathrm{Ar}}^2 + \\chi_{\\mathrm{Pb}}^2 = \\frac{4.52}{0.91} + \\frac{2.6}{0.91} + \\frac{2.6}{0.91} = \\frac{4.52 + 5.2}{0.91} = \\frac{9.72}{0.91}\n$$\n$$\n\\chi^2 \\approx 10.68131868...\n$$\n按照要求将结果四舍五入到四位有效数字，我们得到 $10.68$。",
            "answer": "$$\\boxed{10.68}$$"
        }
    ]
}