{
    "hands_on_practices": [
        {
            "introduction": "本练习提供了弦强子化核心原理的一个具体的、分步的应用。通过计算一个特定的、有序的强子序列的产生概率，你将直接运用到诸如味道抑制和自旋态选择等概念，这些都是类似Lund模型等模型中的基本参数。这项实践旨在建立一种直观的理解，即这些概率性规则如何结合起来，从而产生在高能碰撞中观察到的复杂末态。",
            "id": "3516046",
            "problem": "在量子色动力学（QCD）中，一根色弦连接着一个初始的左端点夸克 $u$ 和一个初始的右端点反夸克 $\\bar{u}$。在一个简化的弦强子化模型中，该弦经历恰好两次断裂，每次断裂产生一个夸克-反夸克对 $q\\bar{q}$ 或一个双夸克-反双夸克对 $(qq)(\\overline{qq})$。强子从左至右依次形成，规则是在每一步，当前的左端点夸克与新产生的反夸克结合形成一个介子；新产生的夸克则成为下一步新的左端点。经过两次断裂后，形成三个介子：第一个使用初始的 $u$ 夸克，第二个使用第一次断裂后留下的夸克，第三个使用第二次断裂后留下的夸克与原始的右端点反夸克 $\\bar{u}$ 结合。\n\n假设使用以下经过充分检验的模型要素：\n- 在每次断裂时，产生夸克-反夸克对而非双夸克-反双夸克对的概率为 $P(q\\bar{q}) = \\frac{1}{1+\\lambda_{qq}}$，其中 $\\lambda_{qq}$ 是双夸克压低因子。在本问题中，取 $\\lambda_{qq} = 0.07$。\n- 在产生夸克-反夸克对的条件下，不同味的权重对于 $u$ 和 $d$ 是同位旋对称的，对于 $s$ 是奇异压低的，其权重为 $w(u) = 1$、$w(d) = 1$ 和 $w(s) = \\gamma_{s}$，由 $Z = w(u)+w(d)+w(s) = 2 + \\gamma_{s}$ 归一化。在本问题中，取 $\\gamma_{s} = 0.32$。因此，在一次断裂中选择不同味的概率为 $P(u\\bar{u}\\mid q\\bar{q}) = \\frac{1}{Z}$、$P(d\\bar{d}\\mid q\\bar{q}) = \\frac{1}{Z}$ 和 $P(s\\bar{s}\\mid q\\bar{q}) = \\frac{\\gamma_{s}}{Z}$。\n- 对于介子的量子数，假设对于给定的味组分 $q\\bar{q}'$，模型会在一个赝标量态（用 $P$ 表示）和一个矢量态（用 $V$ 表示）之间进行选择，其矢量态与赝标量态的产额之比 $r_{V/P}$ 是普适的。相应的概率为 $p_{V} = \\frac{r_{V/P}}{1+r_{V/P}}$ 和 $p_{P} = \\frac{1}{1+r_{V/P}}$。在本问题中，取 $r_{V/P} = 0.6$，因此 $p_{V} = \\frac{0.6}{1.6}$ 且 $p_{P} = \\frac{1}{1.6}$。\n- 忽略中性味混合效应以及除上述概率之外的任何额外动力学质量或相空间权重。\n\n对于相关的味夸克对，可生成的介子种类如下：\n- 对于 $u\\bar{d}$：$\\pi^{+}$（赝标量），$\\rho^{+}$（矢量）。\n- 对于 $d\\bar{u}$：$\\pi^{-}$（赝标量），$\\rho^{-}$（矢量）。\n- 对于 $u\\bar{s}$：$K^{+}$（赝标量），$K^{*+}$（矢量）。\n- 对于 $d\\bar{s}$：$K^{0}$（赝标量），$K^{*0}$（矢量）。\n- 对于 $s\\bar{u}$：$K^{-}$（赝标量），$K^{*-}$（矢量）。\n- 对于 $s\\bar{d}$：$\\bar{K}^{0}$（赝标量），$\\bar{K}^{*0}$（矢量）。\n\n考虑有序的强子序列\n$$\nK^{+},\\ \\bar{K}^{0},\\ \\rho^{-},\n$$\n该序列由从 $u$–$\\bar{u}$ 端点开始的弦经过两次断裂，并使用上述从左到右的顺序形成规则而产生。在指定的模型和参数下，并强制要求总的味与电荷守恒，计算生成这个精确有序序列的概率。将你的答案表示为一个无量纲数，并四舍五入到六位有效数字。",
            "solution": "用户希望我解决一个计算高能物理问题。\n\n### 第一步：提取已知条件\n-   初始弦端点：左端夸克 $u$，右端反夸克 $\\bar{u}$。\n-   弦断裂次数：恰好 $2$ 次。\n-   强子形成规则：从左至右依次形成；左端点夸克与新产生的反夸克结合形成介子；新产生的夸克成为下一个左端点。\n-   总共形成的介子数：$3$。\n-   双夸克压低因子：$\\lambda_{qq} = 0.07$。\n-   夸克-反夸克对产生概率：$P(q\\bar{q}) = \\frac{1}{1+\\lambda_{qq}}$。\n-   奇异夸克压低因子：$\\gamma_{s} = 0.32$。\n-   味归一化因子：$Z = 2 + \\gamma_{s}$。\n-   味选择概率：$P(u\\bar{u}\\mid q\\bar{q}) = \\frac{1}{Z}$、$P(d\\bar{d}\\mid q\\bar{q}) = \\frac{1}{Z}$、$P(s\\bar{s}\\mid q\\bar{q}) = \\frac{\\gamma_{s}}{Z}$。\n-   矢量介子与赝标量介子产额之比：$r_{V/P} = 0.6$。\n-   矢量态和赝标量态形成概率：$p_{V} = \\frac{r_{V/P}}{1+r_{V/P}} = \\frac{0.6}{1.6}$，$p_{P} = \\frac{1}{1+r_{V/P}} = \\frac{1}{1.6}$。\n-   已提供相关味夸克对可生成的介子种类。\n-   目标有序强子序列：$K^{+},\\ \\bar{K}^{0},\\ \\rho^{-}$。\n-   约束条件：强制要求总的味和电荷守恒。\n-   最终答案格式：无量纲数，四舍五入到六位有效数字。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了一个简化的 Lund 弦碎裂模型，这是高能物理中强子化建模的基石。所有概念，如弦断裂、味压低（$\\gamma_s$）、双夸克压低（$\\lambda_{qq}$）和自旋态概率（$r_{V/P}$），都是该领域的标准和成熟概念。参数值在唯象上是现实的。该问题是这些原理的有效应用。\n-   **问题定义良好**：该问题提供了计算特定概率所需的所有必要参数和规则。问题是明确的。我们可以追踪夸克流并验证其一致性。\n    -   初始状态：$u\\bar{u}$。净味为零，净电荷为 $Q(u)+Q(\\bar{u}) = \\frac{2}{3} - \\frac{2}{3} = 0$。\n    -   最终状态：$K^{+}(u\\bar{s})$、$\\bar{K}^{0}(s\\bar{d})$、$\\rho^{-}(d\\bar{u})$。\n    -   味守恒：最终状态的夸克组分为 $(u\\bar{s}) + (s\\bar{d}) + (d\\bar{u})$。将夸克和反夸克相加得到 $(u+\\bar{u})+(s+\\bar{s})+(d+\\bar{d})$，这意味着净味为零，与初始状态一致。\n    -   电荷守恒：最终状态的总电荷为 $Q(K^{+}) + Q(\\bar{K}^{0}) + Q(\\rho^{-}) = (+1) + (0) + (-1) = 0$，与初始状态一致。\n-   **客观性**：问题以精确、定量的术语陈述，没有主观语言。\n-   该问题没有列出的任何无效标准所指的缺陷。它是一个基于已建立的科学模型的完整、一致且可解的问题。\n\n### 第三步：结论与行动\n该问题有效。将提供解答。\n\n该问题要求计算从初始 $u\\bar{u}$ 弦通过两次断裂产生特定有序强子序列 $K^{+},\\ \\bar{K}^{0},\\ \\rho^{-}$ 的概率。我们必须根据指定的模型规则，计算产生此最终状态所需的一系列事件的概率。总概率 $P_{total}$ 将是序列中每一步概率的乘积。\n\n强子化过程可以分解如下：\n初始弦：$u_{L} \\cdots \\bar{u}_{R}$\n\n**第一步：形成第一个介子 $M_1 = K^{+}$**\n-   第一个介子 $K^{+}$ 的夸克组分为 $u\\bar{s}$。\n-   它由初始的左端点夸克 $u$ 和第一次弦断裂中产生的反夸克形成。这个反夸克必须是 $\\bar{s}$。\n-   因此，第一次弦断裂必须产生一个 $s\\bar{s}$ 对。新的夸克 $s$ 成为下一步的新左端点。\n-   这次断裂的概率有两个组成部分：\n    1.  断裂必须产生一个夸克-反夸克对（$q\\bar{q}$）而不是双夸克-反双夸克对。概率为 $P(q\\bar{q}) = \\frac{1}{1+\\lambda_{qq}}$。\n    2.  给定一次 $q\\bar{q}$ 断裂，产生的味必须是 $s\\bar{s}$。概率为 $P(s\\bar{s}\\mid q\\bar{q}) = \\frac{\\gamma_{s}}{Z} = \\frac{\\gamma_{s}}{2+\\gamma_{s}}$。\n-   第一次断裂类型为 $s\\bar{s}$ 的概率是 $P_{\\text{break 1}} = P(q\\bar{q}) \\times P(s\\bar{s}\\mid q\\bar{q}) = \\frac{1}{1+\\lambda_{qq}} \\frac{\\gamma_{s}}{2+\\gamma_{s}}$。\n-   产生的 $u\\bar{s}$ 对必须形成一个 $K^{+}$ 介子，这是一个赝标量态（$P$）。另一种可能是矢量介子 $K^{*+}$。形成赝标量的概率是 $p_P = \\frac{1}{1+r_{V/P}}$。\n\n第一个强子是 $K^{+}$ 的总概率是 $P_1 = P_{\\text{break 1}} \\times p_P = \\frac{1}{1+\\lambda_{qq}} \\frac{\\gamma_{s}}{2+\\gamma_{s}} \\frac{1}{1+r_{V/P}}$。\n\n**第二步：形成第二个介子 $M_2 = \\bar{K}^{0}$**\n-   第一次断裂后，传播的左端点夸克是 $s$。\n-   第二个介子 $\\bar{K}^{0}$ 的夸克组分为 $s\\bar{d}$。它必须由当前的左端点夸克 $s$ 和第二次断裂产生的反夸克形成。这个反夸克必须是 $\\bar{d}$。\n-   因此，第二次弦断裂必须产生一个 $d\\bar{d}$ 对。新的夸克 $d$ 成为最终的左端点夸克。\n-   这次断裂的概率计算方式与第一次类似：\n    1.  断裂必须是 $q\\bar{q}$ 类型：$P(q\\bar{q}) = \\frac{1}{1+\\lambda_{qq}}$。\n    2.  味必须是 $d\\bar{d}$：$P(d\\bar{d}\\mid q\\bar{q}) = \\frac{1}{Z} = \\frac{1}{2+\\gamma_{s}}$。\n-   第二次断裂类型为 $d\\bar{d}$ 的概率是 $P_{\\text{break 2}} = P(q\\bar{q}) \\times P(d\\bar{d}\\mid q\\bar{q}) = \\frac{1}{1+\\lambda_{qq}} \\frac{1}{2+\\gamma_{s}}$。\n-   产生的 $s\\bar{d}$ 对必须形成一个 $\\bar{K}^{0}$ 介子，这是一个赝标量态（$P$）。另一种可能是矢量介子 $\\bar{K}^{*0}$。概率是 $p_P = \\frac{1}{1+r_{V/P}}$。\n\n第二个强子是 $\\bar{K}^{0}$ 的总概率是 $P_2 = P_{\\text{break 2}} \\times p_P = \\frac{1}{1+\\lambda_{qq}} \\frac{1}{2+\\gamma_{s}} \\frac{1}{1+r_{V/P}}$。\n\n**第三步：形成第三个介子 $M_3 = \\rho^{-}$**\n-   第二次断裂后，最终的左端点夸克是 $d$。\n-   这个 $d$ 夸克与原始的右端点反夸克 $\\bar{u}$ 结合，形成第三个也是最后一个介子。\n-   该介子的夸克组分为 $d\\bar{u}$。问题指出这个介子是 $\\rho^{-}$。\n-   $\\rho^{-}$ 是一个矢量介子（$V$）。另一种可能是赝标量介子 $\\pi^{-}$。形成矢量介子的概率是 $p_V = \\frac{r_{V/P}}{1+r_{V/P}}$。这一步不涉及新的弦断裂。\n\n第三个强子是 $\\rho^{-}$ 的概率是 $P_3 = p_V = \\frac{r_{V/P}}{1+r_{V/P}}$。\n\n**总概率**\n有序序列 $K^{+},\\ \\bar{K}^{0},\\ \\rho^{-}$ 的总概率 $P_{total}$ 是每个独立步骤概率的乘积：\n$$P_{total} = P_1 \\times P_2 \\times P_3$$\n$$P_{total} = \\left( \\frac{1}{1+\\lambda_{qq}} \\frac{\\gamma_{s}}{2+\\gamma_{s}} \\frac{1}{1+r_{V/P}} \\right) \\times \\left( \\frac{1}{1+\\lambda_{qq}} \\frac{1}{2+\\gamma_{s}} \\frac{1}{1+r_{V/P}} \\right) \\times \\left( \\frac{r_{V/P}}{1+r_{V/P}} \\right)$$\n合并各项，我们得到：\n$$P_{total} = \\frac{\\gamma_{s} r_{V/P}}{(1+\\lambda_{qq})^2 (2+\\gamma_{s})^2 (1+r_{V/P})^3}$$\n现在，我们代入给定的数值：$\\lambda_{qq} = 0.07$、$\\gamma_{s} = 0.32$ 和 $r_{V/P} = 0.6$。\n-   $1 + \\lambda_{qq} = 1 + 0.07 = 1.07$\n-   $2 + \\gamma_{s} = 2 + 0.32 = 2.32$\n-   $1 + r_{V/P} = 1 + 0.6 = 1.6$\n\n将这些值代入 $P_{total}$ 的表达式中：\n$$P_{total} = \\frac{(0.32) (0.6)}{(1.07)^2 (2.32)^2 (1.6)^3}$$\n$$P_{total} = \\frac{0.192}{(1.1449) (5.3824) (4.096)}$$\n$$P_{total} = \\frac{0.192}{6.16246976 \\times 4.096}$$\n$$P_{total} = \\frac{0.192}{25.23891404...}$$\n$$P_{total} \\approx 0.0076072979$$\n问题要求答案四舍五入到六位有效数字。\n$$P_{total} \\approx 0.00760730$$\n这可以用科学记数法写为 $7.60730 \\times 10^{-3}$。",
            "answer": "$$\\boxed{0.00760730}$$"
        },
        {
            "introduction": "从单个序列的产生概率转向统计描述，本练习探讨了“爆米花机制”，即在重子-反重子对之间产生介子的过程。你将需要论证为何这种现象可以被建模为一个均匀泊松过程，并从第一性原理出发推导出其概率分布。这个练习为你搭建了一座桥梁，连接了弦碎裂的物理图像和用于描述其集体行为的强大统计工具。",
            "id": "3516069",
            "problem": "在量子色动力学（QCD）的 Lund 弦碎裂图像中，强子化被建模为一根具有弦张力 $\\kappa$ 的相对论性色流管的断裂。在此过程中，夸克-反夸克对通过量子隧穿（Schwinger 机制）产生，其单位时空面积的产生率受到横向质量平方的指数抑制，即与 $\\exp(-\\pi m_{\\perp}^{2}/\\kappa)$ 成正比。在重子产生过程中，一次双夸克-反双夸克断裂可导致沿弦产生一对相邻的重子-反重子。“爆米花机制”指的是在双夸克和反双夸克之间额外产生夸克-反夸克对，从而在产生的重子和反重子之间的弦段上辐射出一个或多个介子。\n\n假设以下建模假定，与上述物理图像一致：\n- 产生爆米花介子的额外夸克-反夸克对由相同的隧穿过程驱动，并且对于固定的弦张力 $\\kappa$ 下的轻味夸克，这会在弦快度坐标 $y$ 上引发一个均匀的断裂强度。将此恒定强度（单位快度内产生爆米花的平均断裂次数）表示为“爆米花参数” $\\lambda$。\n- 重子和反重子端点之间可用的弦快度长度为 $\\Delta y$，被视为 $y$ 上的一个无量纲区间。\n- 插入爆米花介子的断裂事件沿 $y$ 独立发生，具有恒定的强度 $\\lambda$，并且互不影响（稀疏极限）。在这些条件下，区间 $\\Delta y$ 内的爆米花介子数量是一个服从泊松分布的随机变量。\n\n根据隧穿起源和独立性假设，解释为什么爆米花介子的插入可以被建模为沿弦快度的均匀泊松过程。然后，仅从均匀泊松过程作为沿 $\\Delta y$ 的独立伯努利试验的连续极限的定义出发，推导在区间 $\\Delta y$ 内恰好产生一个爆米花介子的概率的解析表达式，用 $\\lambda$ 和 $\\Delta y$ 表示。将你的最终答案表示为一个闭合形式的解析表达式。由于这是一个概率，它是无量纲的，不需要单位。不需要四舍五入。",
            "solution": "该问题陈述被评估为具有科学依据、问题明确且客观。它描述了高能物理学中的一个标准唯象模型（带有爆米花机制的 Lund 弦模型），并基于此物理背景提出了一个定义明确的概率论问题。所有必要的参数和假设都已提供，不存在内部矛盾或逻辑缺陷。该问题是有效的。\n\n该问题包括两部分：首先，从概念上解释为何将爆米花介子的插入建模为均匀泊松过程；其次，从第一性原理出发，对该过程的一个特定结果的概率进行数学推导。\n\n**第一部分：均匀泊松过程模型的概念性论证**\n\n一个随机过程如果满足两个关键性质：事件的独立性和恒定的速率（均匀性），就可以被建模为均匀泊松过程。本问题要求基于所提供的弦碎裂物理图像来论证这两个性质。\n\n1.  **独立性：** 问题陈述指出，沿弦快度坐标 $y$ 的断裂是独立发生且互不影响的。这在物理上源于夸克-反夸克 ($q\\bar{q}$) 对产生的基本机制，即强色场中的量子隧穿（Schwinger 机制）。每个隧穿事件都是一个局域的、概率性的量子涨落。在所假设的“稀疏极限”下，一次 $q\\bar{q}$ 创生所涉及的时空区域很小，且相继创生之间的时间间隔足够大，以至于一个事件不会显著消耗局部场能量或以其他方式改变弦上其他地方后续、因果不相关的事件的发生条件。因此，在不同快度值处产生爆米花介子的事件可以被视为统计上独立的事件。\n\n2.  **均匀性（恒定速率）：** 问题陈述指出，该过程具有均匀的强度 $\\lambda$（单位快度内的平均断裂次数）。这种均匀性是理想化相对论弦对称性的结果。弦的动力学是纵向洛伦兹不变的。快度 $y$ 是在纵向洛伦兹变换下加性变换的运动学变量（$y \\to y + \\text{constant}$）。如果弦本身是物理上均匀的——意味着其张力 $\\kappa$ 和其他内禀属性沿其长度是恒定的——并且产生夸克对的真空态也是均匀的，那么断裂的发生就没有优选位置。在小的快度区间 $\\delta y$ 内发生断裂的概率应仅取决于区间的大小 $\\delta y$，而与它在弦上的绝对位置无关。这意味着单位快度的断裂速率或强度 $\\lambda$ 是恒定的。\n\n总之，独立的、局域化的量子隧穿事件的假设（证明了独立性）与物理上均匀、洛伦兹不变的弦（证明了在快度上的均匀性）相结合，直接导出了沿弦产生爆米花介子的过程可以被建模为快度坐标 $y$ 上的均匀泊松过程的结论。\n\n**第二部分：恰好产生一个爆米花介子概率的推导**\n\n我们的任务是从均匀泊松过程作为独立伯努利试验的连续极限这一定义出发，推导在长度为 $\\Delta y$ 的快度区间内恰好产生一个爆米花介子的概率 $P(k=1)$。该过程具有恒定的强度 $\\lambda$。\n\n首先，我们将连续的快度区间 $\\Delta y$ 离散化为 $n$ 个长度相等的不相交小区间 $\\delta y = \\frac{\\Delta y}{n}$。我们选择一个很大的 $n$，使得 $\\delta y$ 无穷小。\n\n对于每个小区间 $\\delta y$，我们定义一个伯努利试验：要么发生一次断裂（“成功”），要么不发生断裂（“失败”）。此步骤的关键假设是：\n- 在一个小区间 $\\delta y$ 内发生一次断裂的概率与该区间的长度成正比。我们将此概率定义为 $p = \\lambda \\delta y$。\n- 因为 $\\delta y$ 是无穷小，在同一子区间内发生一次以上断裂的概率是 $(\\delta y)^2$ 或更高阶的无穷小，即 $O((\\delta y)^2)$。与发生一次断裂的概率 $p$ 相比，这个概率可以忽略不计，并在 $\\delta y \\to 0$ 的极限下被忽略。\n\n基于这些假设，在任何给定子区间内成功的概率是 $p = \\lambda \\delta y = \\lambda \\frac{\\Delta y}{n}$，失败的概率是 $1-p$。\n\n由于不同子区间内的断裂是相互独立的，整个区间 $\\Delta y$ 内的总断裂次数 $k$（即在 $n$ 次试验中）服从二项分布。二项分布的概率质量函数为：\n$$P_n(k) = \\binom{n}{k} p^k (1-p)^{n-k}$$\n\n我们关心的是恰好发生一次断裂的情况，因此我们设 $k=1$：\n$$P_n(k=1) = \\binom{n}{1} p^1 (1-p)^{n-1} = n p (1-p)^{n-1}$$\n\n现在，我们将 $p = \\lambda \\frac{\\Delta y}{n}$ 代入此表达式：\n$$P_n(k=1) = n \\left(\\lambda \\frac{\\Delta y}{n}\\right) \\left(1 - \\lambda \\frac{\\Delta y}{n}\\right)^{n-1}$$\n$$P_n(k=1) = (\\lambda \\Delta y) \\left(1 - \\frac{\\lambda \\Delta y}{n}\\right)^{n-1}$$\n\n为了求得连续过程的概率，我们取子区间数量 $n$ 趋于无穷大（$n \\to \\infty$）的极限，这对应于每个子区间的长度趋于零（$\\delta y \\to 0$）。\n$$P(k=1) = \\lim_{n \\to \\infty} P_n(k=1) = \\lim_{n \\to \\infty} \\left[ (\\lambda \\Delta y) \\left(1 - \\frac{\\lambda \\Delta y}{n}\\right)^{n-1} \\right]$$\n\n项 $\\lambda \\Delta y$ 是一个与 $n$ 无关的常数，所以我们可以将其从极限中提出：\n$$P(k=1) = (\\lambda \\Delta y) \\lim_{n \\to \\infty} \\left(1 - \\frac{\\lambda \\Delta y}{n}\\right)^{n-1}$$\n\n为了计算这个极限，我们使用指数函数的标准定义 $\\lim_{m \\to \\infty} (1 + \\frac{x}{m})^m = \\exp(x)$。让我们重写极限内的项：\n$$\\left(1 - \\frac{\\lambda \\Delta y}{n}\\right)^{n-1} = \\frac{\\left(1 - \\frac{\\lambda \\Delta y}{n}\\right)^n}{\\left(1 - \\frac{\\lambda \\Delta y}{n}\\right)^1}$$\n\n现在我们可以分别计算分子和分母的极限：\n$$\\lim_{n \\to \\infty} \\left(1 - \\frac{\\lambda \\Delta y}{n}\\right)^n = \\lim_{n \\to \\infty} \\left(1 + \\frac{-\\lambda \\Delta y}{n}\\right)^n = \\exp(-\\lambda \\Delta y)$$\n$$\\lim_{n \\to \\infty} \\left(1 - \\frac{\\lambda \\Delta y}{n}\\right) = 1 - 0 = 1$$\n\n结合这些结果，完整的极限是：\n$$\\lim_{n \\to \\infty} \\left(1 - \\frac{\\lambda \\Delta y}{n}\\right)^{n-1} = \\frac{\\exp(-\\lambda \\Delta y)}{1} = \\exp(-\\lambda \\Delta y)$$\n\n将此结果代回我们关于 $P(k=1)$ 的表达式：\n$$P(k=1) = (\\lambda \\Delta y) \\exp(-\\lambda \\Delta y)$$\n\n这就是在快度区间 $\\Delta y$ 内产生恰好一个爆米花介子的概率的解析表达式。这个结果与均值为 $\\Lambda = \\lambda \\Delta y$ 的泊松分布的一般公式一致，该公式给出 $P(k=1) = \\frac{\\Lambda^1 \\exp(-\\Lambda)}{1!} = \\Lambda \\exp(-\\Lambda)$。我们的推导展示了这个特例是如何从泊松过程的基本构造中产生的。",
            "answer": "$$\n\\boxed{\\lambda \\Delta y \\exp(-\\lambda \\Delta y)}\n$$"
        },
        {
            "introduction": "高能物理学中的一个关键挑战是区分直接由碎裂过程产生的主强子，与那些源于共振态衰变的次级强子。本练习模拟了这一真实的据分析任务，将该问题处理为一个正则化逆问题。通过使用线性模型实现一个“解卷”过程，你将能够量化共振态污染的影响并恢复出潜在的主强子分布，从而在这一至关重要的实验技术方面获得实践技能。",
            "id": "3516057",
            "problem": "给定一个用于强子化和共振态衰变的最小离散化线性正演模型，该模型在一个横向动量和快度的二维网格中构建，旨在模拟高能碰撞中诸如弦模型和团簇模型等强子化模型的聚合效应。横向动量用 $p_T$ 表示，必须以 $\\mathrm{GeV}/c$ 为单位处理，而快度 $y$ 是无量纲的。离散化在 $p_T$ 上使用 $2$ 个区间，在 $y$ 上使用 $2$ 个区间，因此所有的谱都由 $4$ 分量的非负向量表示。令 $p \\in \\mathbb{R}_{\\ge 0}^4$ 表示每个区间的初级强子产额向量，令 $o \\in \\mathbb{R}_{\\ge 0}^4$ 表示共振态衰变后对应的观测到的总强子产额。共振态的产生具有按区间的产额，该产额被建模为初级强子的线性函数 $r = K p$，其中 $K \\in \\mathbb{R}_{\\ge 0}^{4 \\times 4}$ 是一个对角矩阵，编码了按区间的共振态与初级强子产额之比。共振态衰变通过一个衰变混合矩阵 $R \\in \\mathbb{R}_{\\ge 0}^{4 \\times 4}$ 将运动学信息重新分配到观测到的总谱中，而探测器接受度和初级强子的区间迁移由 $M \\in \\mathbb{R}_{\\ge 0}^{4 \\times 4}$ 描述。正演模型为\n$$\no \\;=\\; M\\,p \\;+\\; R\\,K\\,p \\;=\\; A_{\\mathrm{eff}}\\,p,\n$$\n其中 $A_{\\mathrm{eff}} = M + R K$。所有矩阵都将在下文中针对每个测试案例直接给出，所有向量都应解释为按区间的产额，它们是无量纲的计数。\n\n您的任务有两部分：首先，量化观测谱中共振态衰变所造成的污染，以占总 inclusive 产额的分数表示；其次，通过求解一个带约束的正则化反演问题，进行解卷以分离出初级强子分布 $p$。\n\n您必须使用的基本原理和定义：\n- 线性和叠加原理意味着产生和衰变过程的按区间卷积可以表示为对离散化谱的矩阵-向量乘法。\n- 在高计数极限下，最小二乘估计量近似于泊松过程的最大似然估计。\n- Tikhonov 正则化通过增加一个平滑度惩罚项来稳定病态反演。\n- 非负最小二乘 (NNLS) 强制执行物理约束 $p \\ge 0$。\n\n将解卷问题表述为以下带非负性约束的惩罚最小二乘问题：\n$$\n\\min_{p \\in \\mathbb{R}_{\\ge 0}^4} \\;\\; \\left\\|A_{\\mathrm{eff}}\\,p - o\\right\\|_2^2 \\;+\\; \\lambda\\,\\left\\|L\\,p\\right\\|_2^2,\n$$\n其中 $\\lambda \\ge 0$ 是每个测试案例给定的正则化强度，而 $L \\in \\mathbb{R}^{4 \\times 4}$ 是一个在 $2 \\times 2$ 网格上的一阶离散差分算子，用于强制 $p$ 沿着 $p_T$ 和 $y$ 方向的平滑性。使用 $2 \\times 2$ 区间排序 $(p_T^{\\mathrm{low}},y^{\\mathrm{low}})$, $(p_T^{\\mathrm{low}},y^{\\mathrm{high}})$, $(p_T^{\\mathrm{high}},y^{\\mathrm{low}})$, $(p_T^{\\mathrm{high}},y^{\\mathrm{high}})$，并定义\n$$\nL \\;=\\; \\begin{pmatrix}\n1  -1  0  0 \\\\\n1  0  -1  0 \\\\\n0  1  0  -1 \\\\\n0  0  1  -1\n\\end{pmatrix}.\n$$\n对于每个测试案例，计算：\n1. 总共振态污染分数\n$$\nf \\;=\\; \\frac{\\mathbf{1}^\\top\\,R\\,K\\,p^{\\mathrm{true}}}{\\mathbf{1}^\\top\\,o},\n$$\n其中 $\\mathbf{1} \\in \\mathbb{R}^4$ 是全一向量，$p^{\\mathrm{true}}$ 是为测试构建给定的真实初级分布，且 $o = A_{\\mathrm{eff}}\\,p^{\\mathrm{true}}$。\n2. 通过求解上述正则化 NNLS 问题得到的解卷估计 $\\hat p$，其中只给定 $o$、$M$、$R$ 和 $K$，以及提供的 $\\lambda$。\n3. 解卷后初级强子的归一化均方根误差，\n$$\n\\mathrm{nRMSE} \\;=\\; \\frac{\\sqrt{\\frac{1}{4}\\sum_{i=1}^4 \\left(\\hat p_i - p^{\\mathrm{true}}_i\\right)^2}}{\\overline{p^{\\mathrm{true}}}}, \\quad \\overline{p^{\\mathrm{true}}} \\;=\\; \\frac{1}{4}\\sum_{i=1}^4 p^{\\mathrm{true}}_i.\n$$\n将 $f$ 和 $\\mathrm{nRMSE}$ 报告为无量纲的小数。\n\n测试套件：\n- 案例 1 (中等共振态污染，良态)：\n  - $p^{\\mathrm{true}}_1 = \\begin{pmatrix} 1000 \\\\ 800 \\\\ 500 \\\\ 300 \\end{pmatrix}$。\n  - $M_1 = \\begin{pmatrix}\n  0.90  0.02  0.03  0.00 \\\\\n  0.02  0.92  0.00  0.03 \\\\\n  0.03  0.00  0.88  0.02 \\\\\n  0.00  0.03  0.02  0.90\n  \\end{pmatrix}$。\n  - $R_1$ 的列向量为\n  $\n  \\begin{pmatrix}0.65\\\\0.25\\\\0.10\\\\0.00\\end{pmatrix},\\;\n  \\begin{pmatrix}0.25\\\\0.65\\\\0.00\\\\0.10\\end{pmatrix},\\;\n  \\begin{pmatrix}0.35\\\\0.25\\\\0.35\\\\0.05\\end{pmatrix},\\;\n  \\begin{pmatrix}0.20\\\\0.30\\\\0.20\\\\0.30\\end{pmatrix}.\n  $\n  - $K_1 = \\mathrm{diag}\\!\\left(0.60,\\,0.60,\\,0.50,\\,0.50\\right)$。\n  - $\\lambda_1 = 10^{-4}$。\n- 案例 2 (高共振态污染，病态性增加)：\n  - $p^{\\mathrm{true}}_2 = \\begin{pmatrix} 400 \\\\ 400 \\\\ 400 \\\\ 400 \\end{pmatrix}$。\n  - $M_2 = \\begin{pmatrix}\n  0.85  0.07  0.06  0.00 \\\\\n  0.07  0.85  0.00  0.06 \\\\\n  0.06  0.00  0.85  0.07 \\\\\n  0.00  0.06  0.07  0.85\n  \\end{pmatrix}$。\n  - $R_2$ 的列向量为\n  $\n  \\begin{pmatrix}0.30\\\\0.30\\\\0.20\\\\0.20\\end{pmatrix},\\;\n  \\begin{pmatrix}0.32\\\\0.30\\\\0.18\\\\0.20\\end{pmatrix},\\;\n  \\begin{pmatrix}0.28\\\\0.32\\\\0.20\\\\0.20\\end{pmatrix},\\;\n  \\begin{pmatrix}0.31\\\\0.29\\\\0.20\\\\0.20\\end{pmatrix}.\n  $\n  - $K_2 = \\mathrm{diag}\\!\\left(1.50,\\,1.50,\\,1.20,\\,1.20\\right)$。\n  - $\\lambda_2 = 10^{-1}$。\n- 案例 3 (无共振态污染的边界情况)：\n  - $p^{\\mathrm{true}}_3 = \\begin{pmatrix} 1200 \\\\ 600 \\\\ 300 \\\\ 150 \\end{pmatrix}$。\n  - $M_3 = \\begin{pmatrix}\n  0.95  0.01  0.02  0.00 \\\\\n  0.01  0.95  0.00  0.02 \\\\\n  0.02  0.00  0.95  0.01 \\\\\n  0.00  0.02  0.01  0.95\n  \\end{pmatrix}$。\n  - $R_3$ 的列向量为\n  $\n  \\begin{pmatrix}0.70\\\\0.20\\\\0.10\\\\0.00\\end{pmatrix},\\;\n  \\begin{pmatrix}0.20\\\\0.70\\\\0.00\\\\0.10\\end{pmatrix},\\;\n  \\begin{pmatrix}0.30\\\\0.30\\\\0.35\\\\0.05\\end{pmatrix},\\;\n  \\begin{pmatrix}0.25\\\\0.25\\\\0.20\\\\0.30\\end{pmatrix}.\n  $\n  - $K_3 = \\mathrm{diag}\\!\\left(0.00,\\,0.00,\\,0.00,\\,0.00\\right)$。\n  - $\\lambda_3 = 10^{-6}$。\n\n观测向量的构建是确定性的，由 $o_j = A_{\\mathrm{eff},j}\\,p^{\\mathrm{true}}_j$ 给出（对于每个案例 $j \\in \\{1,2,3\\}$），其中 $A_{\\mathrm{eff},j} = M_j + R_j K_j$。您不能添加任何额外噪声。\n\n最终输出规范：\n- 对于每个案例 $j \\in \\{1,2,3\\}$，计算如上定义的 $f_j$ 和 $\\mathrm{nRMSE}_j$。\n- 您的程序应生成一行输出，其中包含连接起来的结果，形式为方括号内的逗号分隔列表，顺序为 $[f_1,\\mathrm{nRMSE}_1,f_2,\\mathrm{nRMSE}_2,f_3,\\mathrm{nRMSE}_3]$，每个值格式化为标准浮点表示法的小数。由于所有要求的输出都是无量纲小数，请勿附加任何单位。为确保评分的确定性，请在打印输出中将每个值精确到 $6$ 位小数。",
            "solution": "问题陈述被评估为有效。它在科学上基于粒子物理建模和数值分析的公认原理，利用一个简化但连贯的线性模型来描述强子化、共振态衰变和探测器效应。该问题是适定的，为指定的优化任务提供了唯一解所需的所有数据和定义。语言客观，要求明确。\n\n任务是为三个不同的测试案例计算两个量：共振态污染分数 $f$ 和解卷后的初级强子谱的归一化均方根误差 $\\mathrm{nRMSE}$。这首先需要使用正演模型进行直接计算，其次需要求解一个正则化反演问题。\n\n正演模型通过线性方程将初级强子产额 $p \\in \\mathbb{R}_{\\ge 0}^4$ 与观测到的总产额 $o \\in \\mathbb{R}_{\\ge 0}^4$ 关联起来：\n$$\no \\;=\\; M\\,p \\;+\\; R\\,K\\,p \\;=\\; (M + R\\,K)\\,p \\;=\\; A_{\\mathrm{eff}}\\,p\n$$\n这里，$M$ 代表探测器效应和初级强子的区间迁移，$K$ 是共振态产生比例的对角矩阵，$R$ 是衰变混合矩阵。所有量都在横向动量 $p_T$ 和快度 $y$ 的 $2 \\times 2$ 网格上进行离散化，从而得到 $4$ 分量向量和 $4 \\times 4$ 矩阵。\n\n**第 1 部分：共振态污染分数 $f$ 的计算**\n\n共振态污染分数 $f$ 定义为共振态衰变产生的总产额与观测到的总 inclusive 产额之比。任何分布向量的总产额是其分量的总和，可以表示为与全一向量 $\\mathbf{1} = (1, 1, 1, 1)^\\top$ 的点积。\n\n由共振态衰变产生的产额向量由项 $R\\,K\\,p$ 给出。对于此计算，我们使用每个案例提供的真实初级分布 $p^{\\mathrm{true}}$。因此，共振态衰变产生的总产额为 $\\mathbf{1}^\\top (R\\,K\\,p^{\\mathrm{true}})$。\n\n观测到的总 inclusive 产额向量 $o$是通过将完整的正演模型应用于真实初级粒子生成的：$o = A_{\\mathrm{eff}}\\,p^{\\mathrm{true}} = (M+R\\,K)p^{\\mathrm{true}}$。观测到的总产额为 $\\mathbf{1}^\\top o$。\n\n因此，分数 $f$ 对每个案例 $j$ 的计算如下：\n$$\nf_j \\;=\\; \\frac{\\mathbf{1}^\\top\\,R_j\\,K_j\\,p^{\\mathrm{true}}_j}{\\mathbf{1}^\\top\\,o_j} \\;=\\; \\frac{\\sum_{i=1}^4 (R_j\\,K_j\\,p^{\\mathrm{true}}_j)_i}{\\sum_{i=1}^4 o_{ji}}\n$$\n这是一个涉及矩阵-向量乘法和求和的直接计算。\n\n**第 2 部分：解卷和 nRMSE 的计算**\n\n任务的第二部分是执行“解卷”，这意味着在仅给定观测分布 $o$ 和系统矩阵 $M$、$R$ 和 $K$ 的情况下，估计初级分布 $p$。这是一个反演问题。由于此类问题通常是病态的（对小扰动敏感），因此采用 Tikhonov 正则化来稳定解。此外，产额的物理性质要求解向量 $p$ 的分量必须是非负的，$p_i \\ge 0$。\n\n该问题被表述为一个惩罚性的非负最小二乘优化问题：\n$$\n\\min_{p \\in \\mathbb{R}_{\\ge 0}^4} \\;\\; \\left\\|A_{\\mathrm{eff}}\\,p - o\\right\\|_2^2 \\;+\\; \\lambda\\,\\left\\|L\\,p\\right\\|_2^2\n$$\n第一项 $\\left\\|A_{\\mathrm{eff}}\\,p - o\\right\\|_2^2$ 是标准的最小二乘数据保真项，它寻求一个能通过正演模型最好地重建观测值 $o$ 的 $p$。第二项 $\\lambda\\,\\left\\|L\\,p\\right\\|_2^2$ 是 Tikhonov 正则化惩罚项。矩阵 $L$ 是一个离散差分算子，它惩罚相邻区间之间的巨大变化，从而对解 $p$ 强制施加平滑性。标量 $\\lambda \\ge 0$ 控制此正则化的强度。\n\n为了使用标准数值库解决此问题，我们将其重构为一个常规的非负最小二乘 (NNLS) 问题。两个平方范数之和可以表示为单个更大的块向量的平方范数：\n$$\n\\left\\|A_{\\mathrm{eff}}\\,p - o\\right\\|_2^2 \\;+\\; \\lambda\\,\\left\\|L\\,p\\right\\|_2^2 \\;=\\; \\left\\|A_{\\mathrm{eff}}\\,p - o\\right\\|_2^2 \\;+\\; \\left\\|\\sqrt{\\lambda}\\,L\\,p - \\mathbf{0}\\right\\|_2^2 \\;=\\; \\left\\| \\begin{pmatrix} A_{\\mathrm{eff}} \\\\ \\sqrt{\\lambda} L \\end{pmatrix} p - \\begin{pmatrix} o \\\\ \\mathbf{0} \\end{pmatrix} \\right\\|_2^2\n$$\n其中 $\\mathbf{0}$ 是一个 $4 \\times 1$ 的零向量。我们定义增广的 $8 \\times 4$ 矩阵 $\\tilde{A}$ 和增广的 $8 \\times 1$ 向量 $\\tilde{b}$：\n$$\n\\tilde{A} \\;=\\; \\begin{pmatrix} A_{\\mathrm{eff}} \\\\ \\sqrt{\\lambda} L \\end{pmatrix}, \\quad \\tilde{b} \\;=\\; \\begin{pmatrix} o \\\\ \\mathbf{0} \\end{pmatrix}\n$$\n优化问题现在处于标准的 NNLS 形式：\n$$\n\\min_{p \\in \\mathbb{R}_{\\ge 0}^4} \\;\\; \\left\\|\\tilde{A}\\,p - \\tilde{b}\\right\\|_2^2\n$$\n此问题可以使用诸如 `scipy.optimize.nnls` 之类的数值例程轻松求解，以找到我们记为 $\\hat{p}$ 的估计初级分布。\n\n最后，通过计算解卷估计 $\\hat{p}$ 与已知的真实分布 $p^{\\mathrm{true}}$ 之间的归一化均方根误差 ($\\mathrm{nRMSE}$) 来评估解卷的质量：\n$$\n\\mathrm{nRMSE} \\;=\\; \\frac{\\sqrt{\\frac{1}{4}\\sum_{i=1}^4 \\left(\\hat p_i - p^{\\mathrm{true}}_i\\right)^2}}{\\overline{p^{\\mathrm{true}}}}\n$$\n其中 $\\overline{p^{\\mathrm{true}}} = \\frac{1}{4}\\sum_{i=1}^4 p^{\\mathrm{true}}_i$ 是真实初级产額的平均值。\n\n每个测试案例的总体算法如下：\n1.  构建矩阵 $M_j$、$R_j$ 和 $K_j$。\n2.  计算有效矩阵 $A_{\\mathrm{eff},j} = M_j + R_j K_j$。\n3.  生成观测数据 $o_j = A_{\\mathrm{eff},j}\\,p^{\\mathrm{true}}_j$。\n4.  计算共振态污染分数 $f_j = (\\sum (R_j K_j p^{\\mathrm{true}}_j)_i) / (\\sum (o_j)_i)$。\n5.  使用 $A_{\\mathrm{eff},j}$、$o_j$、$\\lambda_j$ 和预定义的矩阵 $L$ 构建增广矩阵 $\\tilde{A}_j$ 和向量 $\\tilde{b}_j$。\n6.  求解 NNLS 问题 $\\min_{p \\ge 0} \\|\\tilde{A}_j p - \\tilde{b}_j\\|_2^2$ 以获得估计值 $\\hat{p}_j$。\n7.  使用 $\\hat{p}_j$ 和给定的 $p^{\\mathrm{true}}_j$ 计算 $\\mathrm{nRMSE}_j$。\n8.  收集并格式化结果 $f_j$ 和 $\\mathrm{nRMSE}_j$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves the hadronization unfolding problem for three test cases.\n    For each case, it calculates the resonance contamination fraction (f)\n    and the normalized root-mean-squared error (nRMSE) of the unfolded result.\n    \"\"\"\n\n    # Define the discrete difference operator L, constant for all cases.\n    L = np.array([\n        [1.0, -1.0, 0.0, 0.0],\n        [1.0, 0.0, -1.0, 0.0],\n        [0.0, 1.0, 0.0, -1.0],\n        [0.0, 0.0, 1.0, -1.0]\n    ])\n\n    test_cases = [\n        # Case 1 (moderate resonance contamination, well-conditioned)\n        {\n            \"p_true\": np.array([1000.0, 800.0, 500.0, 300.0]),\n            \"M\": np.array([\n                [0.90, 0.02, 0.03, 0.00],\n                [0.02, 0.92, 0.00, 0.03],\n                [0.03, 0.00, 0.88, 0.02],\n                [0.00, 0.03, 0.02, 0.90]\n            ]),\n            \"R\": np.array([\n                [0.65, 0.25, 0.35, 0.20],\n                [0.25, 0.65, 0.25, 0.30],\n                [0.10, 0.00, 0.35, 0.20],\n                [0.00, 0.10, 0.05, 0.30]\n            ]),\n            \"K_diag\": np.array([0.60, 0.60, 0.50, 0.50]),\n            \"lambda\": 1e-4\n        },\n        # Case 2 (high resonance contamination, increased ill-conditioning)\n        {\n            \"p_true\": np.array([400.0, 400.0, 400.0, 400.0]),\n            \"M\": np.array([\n                [0.85, 0.07, 0.06, 0.00],\n                [0.07, 0.85, 0.00, 0.06],\n                [0.06, 0.00, 0.85, 0.07],\n                [0.00, 0.06, 0.07, 0.85]\n            ]),\n            \"R\": np.array([\n                [0.30, 0.32, 0.28, 0.31],\n                [0.30, 0.30, 0.32, 0.29],\n                [0.20, 0.18, 0.20, 0.20],\n                [0.20, 0.20, 0.20, 0.20]\n            ]),\n            \"K_diag\": np.array([1.50, 1.50, 1.20, 1.20]),\n            \"lambda\": 1e-1\n        },\n        # Case 3 (no resonance contamination boundary case)\n        {\n            \"p_true\": np.array([1200.0, 600.0, 300.0, 150.0]),\n            \"M\": np.array([\n                [0.95, 0.01, 0.02, 0.00],\n                [0.01, 0.95, 0.00, 0.02],\n                [0.02, 0.00, 0.95, 0.01],\n                [0.00, 0.02, 0.01, 0.95]\n            ]),\n            \"R\": np.array([  # Not used since K is zero, but defined for completeness\n                [0.70, 0.20, 0.30, 0.25],\n                [0.20, 0.70, 0.30, 0.25],\n                [0.10, 0.00, 0.35, 0.20],\n                [0.00, 0.10, 0.05, 0.30]\n            ]),\n            \"K_diag\": np.array([0.00, 0.00, 0.00, 0.00]),\n            \"lambda\": 1e-6\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        p_true = case[\"p_true\"]\n        M = case[\"M\"]\n        R = case[\"R\"]\n        K = np.diag(case[\"K_diag\"])\n        lambda_val = case[\"lambda\"]\n        \n        # Calculate the effective matrix and the observed spectrum\n        A_eff = M + R @ K\n        o = A_eff @ p_true\n\n        # --- Part 1: Calculate resonance contamination fraction f ---\n        resonance_contribution = R @ K @ p_true\n        total_resonance_yield = np.sum(resonance_contribution)\n        total_observed_yield = np.sum(o)\n        \n        f = 0.0\n        if total_observed_yield > 0:\n            f = total_resonance_yield / total_observed_yield\n        \n        # --- Part 2: Perform unfolding and calculate nRMSE ---\n        # Set up the augmented system for regularized NNLS\n        sqrt_lambda_L = np.sqrt(lambda_val) * L\n        A_tilde = np.vstack([A_eff, sqrt_lambda_L])\n        b_tilde = np.concatenate([o, np.zeros(L.shape[0])])\n\n        # Solve the NNLS problem to find the unfolded estimate p_hat\n        p_hat, _ = nnls(A_tilde, b_tilde)\n        \n        # Calculate the normalized root-mean-squared error (nRMSE)\n        p_true_mean = np.mean(p_true)\n        rmse = np.sqrt(np.mean((p_hat - p_true)**2))\n        \n        nrmse = 0.0\n        if p_true_mean > 0:\n            nrmse = rmse / p_true_mean\n\n        results.extend([f, nrmse])\n\n    # Format results for the final output string\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}