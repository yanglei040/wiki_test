{
    "hands_on_practices": [
        {
            "introduction": "这个练习将指导你分析逻辑斯谛损失函数。通过推导其梯度和Hessian矩阵，你不仅可以验证其凸性，还将为其梯度计算一个全局Lipschitz常数。这个常数，通常表示为 $L$，对于设置基于梯度的优化方法的步长和推导其收敛保证至关重要。",
            "id": "3439608",
            "problem": "考虑在压缩感知领域的稀疏逻辑斯谛回归中使用的二元逻辑斯谛模型，其中测量矩阵为 $A \\in \\mathbb{R}^{m \\times n}$，其行向量为 $a_{i}^{\\top}$，标签为 $b \\in \\{-1, +1\\}^{m}$。定义逻辑斯谛损失函数\n$$\n\\ell(x) = \\sum_{i=1}^{m} \\ln\\!\\big(1 + \\exp(- b_{i} a_{i}^{\\top} x)\\big),\n$$\n其中 $x \\in \\mathbb{R}^{n}$。从自然对数和指数函数的定义出发，利用多元微积分中的链式法则，并结合通过海森矩阵为半正定（Positive Semidefinite, PSD）来定义的凸性，执行以下任务：\n\n- 用 $A$、$b$ 和 $x$ 显式地推导出梯度 $\\nabla \\ell(x)$。\n- 推导海森矩阵 $\\nabla^{2}\\ell(x)$，并将其写成 $A^{\\top} W(x) A$ 的形式，其中 $W(x)$ 是一个对角矩阵，您必须指明其对角线元素。利用此表示，通过证明 $W(x)$ 是一个对角元素非负的对角矩阵，从而验证其凸性，因为这意味着 $\\nabla^{2}\\ell(x)$ 是半正定的（PSD）。\n- 仅使用基本不等式和逻辑斯谛函数的性质，为梯度映射 $x \\mapsto \\nabla \\ell(x)$ 推导一个全局利普希茨常数 $L$，并用 $A$ 的谱范数 $\\|A\\|_{2}$ 表示。\n\n您的最终答案必须是单个闭式解析表达式或包含所求的 $\\nabla \\ell(x)$、$\\nabla^{2}\\ell(x)$ 和 $L$ 三个表达式的单行矩阵。无需四舍五入。最终答案中不要包含任何单位。",
            "solution": "该问题需经过验证。\n\n### 第一步：提取已知条件\n- 测量矩阵为 $A \\in \\mathbb{R}^{m \\times n}$，其行向量为 $a_{i}^{\\top}$。\n- 标签为 $b \\in \\{-1, +1\\}^{m}$。\n- 逻辑斯谛损失函数定义为 $\\ell(x) = \\sum_{i=1}^{m} \\ln(1 + \\exp(- b_{i} a_{i}^{\\top} x))$，其中 $x \\in \\mathbb{R}^{n}$。\n- 任务是：\n    1. 推导梯度 $\\nabla \\ell(x)$。\n    2. 以 $A^{\\top} W(x) A$ 的形式推导海森矩阵 $\\nabla^{2}\\ell(x)$，指明矩阵 $W(x)$ 的对角线元素，并以此验证凸性。\n    3. 以谱范数 $\\|A\\|_{2}$ 表示，推导梯度 $\\nabla \\ell(x)$ 的全局利普希茨常数 $L$。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于机器学习和统计学中使用的标准逻辑斯谛损失函数。梯度、海森矩阵、凸性和利普希茨连续性等概念是数学优化领域中基础且完善的概念。该问题在科学和数学上是合理的。\n- **适定性：** 函数 $\\ell(x)$ 对所有 $x \\in \\mathbb{R}^n$ 都是无限可微的。推导其梯度、海森矩阵和梯度的利普希茨常数的任务是具有唯一解的、定义明确的数学问题。\n- **客观性：** 该问题使用精确的数学语言和符号进行表述，没有任何主观性或模糊性。\n- **缺陷检查：** 该问题不违反任何无效性标准。它是优化领域一个标准的、自洽的、可形式化的问题。\n\n### 第三步：结论与行动\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 解题推导\n\n损失函数是各个分量函数之和：\n$$\n\\ell(x) = \\sum_{i=1}^{m} \\ell_i(x) \\quad \\text{其中} \\quad \\ell_i(x) = \\ln(1 + \\exp(-b_i a_i^\\top x))\n$$\n梯度和海森矩阵可以通过逐项微分计算。\n\n**1. 梯度 $\\nabla \\ell(x)$ 的推导**\n\n我们使用链式法则计算每个分量 $\\ell_i(x)$ 的梯度。令 $u(y) = \\ln(y)$ 和 $v_i(x) = 1 + \\exp(-b_i a_i^\\top x)$。那么 $\\ell_i(x) = u(v_i(x))$。其梯度为 $\\nabla \\ell_i(x) = u'(v_i(x)) \\nabla v_i(x)$。\n\n首先，$u'(y) = \\frac{1}{y}$，所以 $u'(v_i(x)) = \\frac{1}{1 + \\exp(-b_i a_i^\\top x)}$。\n其次，我们求 $v_i(x)$ 的梯度。令 $w_i(x) = -b_i a_i^\\top x$。\n$$\n\\nabla v_i(x) = \\nabla_x (1 + \\exp(w_i(x))) = \\exp(w_i(x)) \\nabla_x w_i(x) = \\exp(-b_i a_i^\\top x) (-b_i a_i)\n$$\n结合这些结果：\n$$\n\\nabla \\ell_i(x) = \\frac{1}{1 + \\exp(-b_i a_i^\\top x)} \\cdot \\exp(-b_i a_i^\\top x) \\cdot (-b_i a_i)\n$$\n我们可以简化标量系数：\n$$\n\\frac{\\exp(-b_i a_i^\\top x)}{1 + \\exp(-b_i a_i^\\top x)} = \\frac{1}{\\exp(b_i a_i^\\top x)(1 + \\exp(-b_i a_i^\\top x))} = \\frac{1}{\\exp(b_i a_i^\\top x) + 1}\n$$\n所以，第 $i$ 个分量的梯度是：\n$$\n\\nabla \\ell_i(x) = \\frac{-b_i}{1 + \\exp(b_i a_i^\\top x)} a_i\n$$\n总梯度是所有分量之和：\n$$\n\\nabla \\ell(x) = \\sum_{i=1}^{m} \\nabla \\ell_i(x) = \\sum_{i=1}^{m} \\frac{-b_i a_i}{1 + \\exp(b_i a_i^\\top x)}\n$$\n\n**2. 海森矩阵 $\\nabla^2 \\ell(x)$ 的推导与凸性验证**\n\n海森矩阵是梯度的雅可比矩阵。我们对 $\\nabla \\ell(x)$ 关于 $x$ 求导。同样，我们可以逐项进行。\n$$\n\\nabla^2 \\ell(x) = \\sum_{i=1}^{m} \\nabla^2 \\ell_i(x) = \\sum_{i=1}^{m} \\nabla_x \\left( \\frac{-b_i}{1 + \\exp(b_i a_i^\\top x)} a_i \\right)\n$$\n令标量函数为 $c_i(x) = \\frac{-b_i}{1 + \\exp(b_i a_i^\\top x)}$。我们需要计算 $\\nabla_x(c_i(x) a_i)$。对标量函数乘以常数向量的情况使用梯度乘积法则，结果为 $(\\nabla_x c_i(x)) a_i^\\top$。\n\n我们来求 $\\nabla_x c_i(x)$。令 $z_i(x) = b_i a_i^\\top x$。则 $c_i(x) = -b_i (1 + \\exp(z_i(x)))^{-1}$。\n$$\n\\nabla_x c_i(x) = -b_i (-1)(1 + \\exp(z_i(x)))^{-2} \\cdot \\exp(z_i(x)) \\cdot \\nabla_x z_i(x)\n$$\n$$\n\\nabla_x c_i(x) = b_i \\frac{\\exp(b_i a_i^\\top x)}{(1 + \\exp(b_i a_i^\\top x))^2} (b_i a_i)\n$$\n因为 $b_i \\in \\{-1, +1\\}$，所以 $b_i^2 = 1$。\n$$\n\\nabla_x c_i(x) = \\frac{\\exp(b_i a_i^\\top x)}{(1 + \\exp(b_i a_i^\\top x))^2} a_i\n$$\n所以，第 $i$ 个分量的海森矩阵是：\n$$\n\\nabla^2 \\ell_i(x) = (\\nabla_x c_i(x)) a_i^\\top = \\frac{\\exp(b_i a_i^\\top x)}{(1 + \\exp(b_i a_i^\\top x))^2} a_i a_i^\\top\n$$\n我们定义标量权重 $w_i(x) = \\frac{\\exp(b_i a_i^\\top x)}{(1 + \\exp(b_i a_i^\\top x))^2}$。\n总海森矩阵是各项之和：\n$$\n\\nabla^2 \\ell(x) = \\sum_{i=1}^{m} w_i(x) a_i a_i^\\top\n$$\n这个表达式可以写成 $A^\\top W(x) A$ 的形式。令 $W(x)$ 为一个对角矩阵，其对角线元素为 $[W(x)]_{ii} = w_i(x)$。那么：\n$$\nA^\\top W(x) A = \\sum_{i=1}^{m} w_i(x) a_i a_i^\\top\n$$\n因此，海森矩阵为 $\\nabla^2 \\ell(x) = A^\\top W(x) A$，其中 $W(x)$ 的对角线元素由下式给出：\n$$\n[W(x)]_{ii} = w_i(x) = \\frac{\\exp(b_i a_i^\\top x)}{(1 + \\exp(b_i a_i^\\top x))^2}\n$$\n为了验证凸性，我们必须证明海森矩阵 $\\nabla^2 \\ell(x)$ 对所有 $x \\in \\mathbb{R}^n$ 都是半正定的（PSD）。如果对于所有向量 $v$都有 $v^\\top M v \\ge 0$，则矩阵 $M$ 是半正定的。\n对于任意 $v \\in \\mathbb{R}^n$：\n$$\nv^\\top \\nabla^2 \\ell(x) v = v^\\top (A^\\top W(x) A) v = (Av)^\\top W(x) (Av)\n$$\n令 $y = Av$。则 $y \\in \\mathbb{R}^m$ 且 $y_i = a_i^\\top v$。表达式变为：\n$$\ny^\\top W(x) y = \\sum_{i=1}^{m} y_i^2 [W(x)]_{ii} = \\sum_{i=1}^{m} (a_i^\\top v)^2 w_i(x)\n$$\n对于每个 $i$，项 $(a_i^\\top v)^2$ 是非负的。\n可以分析权重 $w_i(x)$。令 $z = \\exp(b_i a_i^\\top x)$。由于 $b_i a_i^\\top x \\in \\mathbb{R}$，所以 $z > 0$。权重为 $w_i(x) = \\frac{z}{(1+z)^2}$。因为 $z>0$，分子和分母都为正，所以 $w_i(x) > 0$。\n和 $\\sum_{i=1}^{m} (a_i^\\top v)^2 w_i(x)$ 是非负项的和，所以它也是非负的。\n$$\nv^\\top \\nabla^2 \\ell(x) v \\ge 0\n$$\n由于这对所有 $v \\in \\mathbb{R}^n$ 都成立，海森矩阵 $\\nabla^2 \\ell(x)$ 是半正定的。这证明了函数 $\\ell(x)$ 是凸函数。\n\n**3. 梯度 $\\nabla \\ell(x)$ 的利普希茨常数 $L$ 的推导**\n\n一个具有有界海森矩阵的可微函数的梯度是利普希茨连续的。具体来说，如果对所有 $z \\in \\mathbb{R}^n$ 都有 $\\|\\nabla^2 \\ell(z)\\|_2 \\le L$，那么 $\\|\\nabla \\ell(x) - \\nabla \\ell(y)\\|_2 \\le L \\|x - y\\|_2$。我们通过寻找海森矩阵谱范数的上界来求得这样一个常数 $L$。\n$$\nL = \\sup_{z \\in \\mathbb{R}^n} \\|\\nabla^2 \\ell(z)\\|_2 = \\sup_{z \\in \\mathbb{R}^n} \\|A^\\top W(z) A\\|_2\n$$\n我们有这样一个性质：对于一个半正定矩阵 $M$ 和任意矩阵 $B$，$\\|B^\\top M B\\|_2 \\le \\|M\\|_2 \\|B^\\top B\\|_2 = \\|M\\|_2 \\|B\\|_2^2$。\n应用这个性质，我们得到：\n$$\n\\|A^\\top W(x) A\\|_2 \\le \\|W(x)\\|_2 \\|A\\|_2^2\n$$\n$W(x)$ 是一个对角元素为非负项 $w_i(x)$ 的对角矩阵。其谱范数是最大的对角元素：\n$$\n\\|W(x)\\|_2 = \\max_{i=1, \\dots, m} w_i(x)\n$$\n我们必须找到 $w_i(x)$ 在所有 $x$ 和 $i$ 上的最大值。令 $u = b_i a_i^\\top x$。需要最大化的函数是 $f(u) = \\frac{\\exp(u)}{(1+\\exp(u))^2}$。为了找到其最大值，我们计算它关于 $u$ 的导数并令其为零。\n$$\nf'(u) = \\frac{\\exp(u)(1+\\exp(u))^2 - \\exp(u) \\cdot 2(1+\\exp(u))\\exp(u)}{(1+\\exp(u))^4} = \\frac{\\exp(u)(1+\\exp(u)) - 2\\exp(2u)}{(1+\\exp(u))^3} = \\frac{\\exp(u) - \\exp(2u)}{(1+\\exp(u))^3}\n$$\n令 $f'(u)=0$ 需要 $\\exp(u) - \\exp(2u) = 0$，这意味着 $\\exp(u) = 1$，所以 $u=0$。\n在 $u=0$ 时，值为 $f(0) = \\frac{\\exp(0)}{(1+\\exp(0))^2} = \\frac{1}{(1+1)^2} = \\frac{1}{4}$。\n这是一个最大值，因为当 $u0$ 时 $f'(u) > 0$，当 $u>0$ 时 $f'(u)0$。\n所以，对任意的 $i$ 和 $x$，$w_i(x) \\le \\frac{1}{4}$。这意味着 $\\sup_x \\|W(x)\\|_2 \\le \\frac{1}{4}$。\n因此，我们得到了海森矩阵范数的一个界：\n$$\n\\|\\nabla^2 \\ell(x)\\|_2 \\le \\frac{1}{4} \\|A\\|_2^2\n$$\n这给出了梯度 $\\nabla \\ell(x)$ 的一个全局利普希茨常数：\n$$\nL = \\frac{1}{4} \\|A\\|_2^2\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sum_{i=1}^{m} \\frac{-b_i a_i}{1 + \\exp(b_i a_i^\\top x)}  \\sum_{i=1}^{m} \\frac{\\exp(b_i a_i^\\top x)}{(1+\\exp(b_i a_i^\\top x))^2} a_i a_i^\\top  \\frac{1}{4} \\|A\\|_2^2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "我们现在从分析目标函数转向构建基本的算法组件。这个练习专注于推导到 $\\ell_1$ 球上的投影算子，这是许多稀疏恢复算法中的一个关键步骤。通过应用Karush-Kuhn-Tucker (KKT) 条件，你将揭示解的著名软阈值结构，并证明投影映射是非扩张的，这一性质保证了迭代方法的稳定性和收敛性。",
            "id": "3439613",
            "problem": "令 $z \\in \\mathbb{R}^{n}$ 且 $\\tau  0$。考虑将 $z$ 投影到 $\\ell_{1}$ 球 $\\{x \\in \\mathbb{R}^{n} : \\|x\\|_{1} \\le \\tau\\}$ 上的投影 $P_{\\tau}(z)$，其定义为以下强凸优化问题的唯一最小化子\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\;\\; \\frac{1}{2}\\|x - z\\|_{2}^{2} \\quad \\text{subject to} \\quad \\|x\\|_{1} \\le \\tau.\n$$\n该投影出现在压缩感知和稀疏优化中使用的投影梯度算法和近端算法中，例如在基追踪（Basis Pursuit）和最小绝对收缩和选择算子（LASSO）类型的方法中。\n\n任务：\n1. 从凸函数、次梯度和约束凸规划最优性的基本定义出发，推导 $P_{\\tau}(z)$ 的结构，并确定阈值参数 $\\theta \\ge 0$，使得 $P_{\\tau}(z)$ 是通过对 $z$ 的各分量在水平 $\\theta$ 上进行软阈值化得到的。然后，仅使用 $z$ 的分量和 $\\tau$ 以闭式形式表示 $\\theta$。您的推导必须从 Karush-Kuhn-Tucker (KKT) 条件开始，并且必须是自洽的。\n2. 证明投影映射 $P_{\\tau} : \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$ 对于 $\\ell_{2}$ 范数是非扩张的，即对于所有 $z, z' \\in \\mathbb{R}^{n}$，\n$$\n\\|P_{\\tau}(z) - P_{\\tau}(z')\\|_{2} \\le \\|z - z'\\|_{2}.\n$$\n您的证明必须基于投影到闭凸集的第一性原理，并应明确引用平方欧几里得距离目标的强凸性以及 $\\ell_{1}$ 球约束的凸性。\n\n请以关于 $z$ 的排序后幅值和 $\\tau$ 的单个闭式解析表达式的形式提供阈值参数 $\\theta$ 的最终答案。最终答案不需要进行数值舍入。",
            "solution": "此问题包含两个与投影到 $\\ell_{1}$ 球相关的任务。该问题是适定的、有科学依据的，并包含足够的信息以获得唯一解。我将继续进行推导和证明。\n\n该优化问题是找到 $x^* = P_{\\tau}(z)$，即以下问题的解：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\;\\; \\frac{1}{2}\\|x - z\\|_{2}^{2} \\quad \\text{subject to} \\quad \\|x\\|_{1} \\le \\tau\n$$\n这是一个凸优化问题，因为目标函数 $f(x) = \\frac{1}{2}\\|x-z\\|_2^2$ 是严格凸的（因此是强凸的），并且约束集 $C = \\{x \\in \\mathbb{R}^{n} : \\|x\\|_{1} \\le \\tau\\}$ 是一个闭凸集。因此，最小化子 $x^*$ 的存在性和唯一性得到保证。\n\n**任务1：推导 $P_{\\tau}(z)$ 的结构**\n\n我们使用 Karush-Kuhn-Tucker (KKT) 条件来推导解。设目标函数为 $f(x) = \\frac{1}{2}\\|x-z\\|_2^2$，不等式约束为 $g(x) = \\|x\\|_1 - \\tau \\le 0$。该问题的拉格朗日函数为：\n$$\n\\mathcal{L}(x, \\lambda) = f(x) + \\lambda g(x) = \\frac{1}{2}\\|x-z\\|_2^2 + \\lambda(\\|x\\|_1 - \\tau)\n$$\n其中 $\\lambda \\in \\mathbb{R}$ 是与不等式约束相关的拉格朗日乘子。\n\n最优解 $x^*$ 的 KKT 条件是：\n1.  **原始可行性**：$\\|x^*\\|_1 \\le \\tau$。\n2.  **对偶可行性**：$\\lambda \\ge 0$。\n3.  **互补松弛性**：$\\lambda(\\|x^*\\|_1 - \\tau) = 0$。\n4.  **平稳性**：拉格朗日函数关于 $x$ 的梯度（或次梯度，因为 $\\|x\\|_1$ 是不可微的）在 $x^*$ 处必须包含 $0$。\n    $$\n    0 \\in \\partial_x \\mathcal{L}(x^*, \\lambda) = \\nabla_x \\left(\\frac{1}{2}\\|x^*-z\\|_2^2\\right) + \\lambda \\partial \\|x^*\\|_1\n    $$\n二次项的梯度是 $\\nabla_x f(x^*) = x^* - z$。$\\ell_1$ 范数在 $x^*$ 处的次微分是向量集合 $s \\in \\mathbb{R}^n$，其分量 $s_i$ 满足：\n$$\ns_i =\n\\begin{cases}\n    \\text{sign}(x_i^*)  \\text{if } x_i^* \\ne 0 \\\\\n    \\in [-1, 1]  \\text{if } x_i^* = 0\n\\end{cases}\n$$\n平稳性条件变为，对于某个 $s \\in \\partial \\|x^*\\|_1$，有 $0 \\in (x^* - z) + \\lambda s$，这可以重写为 $z - x^* \\in \\lambda \\partial \\|x^*\\|_1$。\n\n让我们对 $i=1, \\dots, n$ 分量逐一分析此条件：\n$z_i - x_i^* \\in \\lambda [\\partial \\|x^*\\|_1]_i$。\n-   若 $x_i^*  0$，则 $[\\partial \\|x^*\\|_1]_i = \\{1\\}$，所以 $z_i - x_i^* = \\lambda$，这意味着 $x_i^* = z_i - \\lambda$。为了使 $x_i^*$ 为正，我们必须有 $z_i  \\lambda$。\n-   若 $x_i^*  0$，则 $[\\partial \\|x^*\\|_1]_i = \\{-1\\}$，所以 $z_i - x_i^* = -\\lambda$，这意味着 $x_i^* = z_i + \\lambda$。为了使 $x_i^*$ 为负，我们必须有 $z_i  -\\lambda$。\n-   若 $x_i^* = 0$，则 $[\\partial \\|x^*\\|_1]_i = [-1, 1]$，所以 $z_i - x_i^* = z_i \\in [-\\lambda, \\lambda]$，这意味着 $|z_i| \\le \\lambda$。\n\n结合这三种情况，我们可以将每个分量的解 $x_i^*$ 表示为：\n$$\nx_i^* =\n\\begin{cases}\n    z_i - \\lambda  \\text{if } z_i  \\lambda \\\\\n    z_i + \\lambda  \\text{if } z_i  -\\lambda \\\\\n    0  \\text{if } |z_i| \\le \\lambda\n\\end{cases}\n$$\n这是软阈值算子，可以紧凑地写作 $x_i^* = \\text{sign}(z_i)\\max(0, |z_i| - \\lambda)$。问题将阈值参数确定为 $\\theta \\ge 0$。因此我们可以设定 $\\theta = \\lambda$。解为 $x^* = S_{\\theta}(z)$。\n\n现在，我们使用互补松弛性条件 $\\theta(\\|x^*\\|_1 - \\tau) = 0$ 来确定 $\\theta$ 的值。\n-   **情况1：$\\|z\\|_1 \\le \\tau$**。如果我们设置 $\\theta=0$，解变为 $x^* = S_0(z) = z$。该解是原始可行的，因为 $\\|x^*\\|_1 = \\|z\\|_1 \\le \\tau$。当 $\\theta=\\lambda=0$ 时，对偶可行性和互补松弛性条件均得到满足。因此，如果原始向量 $z$ 已经位于 $\\ell_1$ 球内部或边界上，则其投影为 $z$ 本身，对应的阈值为 $\\theta=0$。\n\n-   **情况2：$\\|z\\|_1  \\tau$**。在这种情况下，无约束最小值 $z$ 位于可行集之外。解 $x^*$ 必须位于边界上，因此 $\\|x^*\\|_1 = \\tau$。根据互补松弛性，这意味着 $\\theta = \\lambda  0$。$\\theta$ 的值通过求解方程 $\\|S_{\\theta}(z)\\|_1 = \\tau$ 来确定：\n    $$\n    \\sum_{i=1}^n |x_i^*| = \\sum_{i=1}^n \\max(0, |z_i| - \\theta) = \\tau\n    $$\n令 $u_i = |z_i|$ (对于 $i=1, \\dots, n$)，并令 $|z|_{(1)} \\ge |z|_{(2)} \\ge \\dots \\ge |z|_{(n)}$ 为 $z$ 的分量幅值按降序排列的结果。函数 $h(\\theta) = \\sum_{i=1}^n \\max(0, |z_i| - \\theta)$ 是一个关于 $\\theta$ 的连续、单调递减、分段线性的函数。由于 $h(0) = \\|z\\|_1  \\tau$ 且 $\\lim_{\\theta \\to \\infty} h(\\theta) = 0$，因此存在唯一的 $\\theta  0$ 解 $h(\\theta)=\\tau$。\n\n为求此 $\\theta$，我们首先需要找到 $z$ 有多少个分量的幅值大于 $\\theta$。设这个数量为 $k$。则 $|z|_{(k)}  \\theta \\ge |z|_{(k+1)}$（约定 $|z|_{(n+1)} = 0$）。关于 $\\theta$ 的方程变为：\n$$\n\\sum_{i=1}^k (|z|_{(i)} - \\theta) = \\tau\n$$\n$$\n\\left(\\sum_{i=1}^k |z|_{(i)}\\right) - k\\theta = \\tau\n$$\n解出 $\\theta$ 可得：\n$$\n\\theta = \\frac{1}{k}\\left(\\sum_{i=1}^k |z|_{(i)} - \\tau\\right)\n$$\n整数 $k \\in \\{1, \\dots, n\\}$ 本身依赖于 $\\theta$，并且是满足一致性条件 $|z|_{(k)}  \\theta \\ge |z|_{(k+1)}$ 的唯一值，其中 $\\theta$ 由上述公式给出。这个 $k$ 可以通过搜索高效地找到，但 $\\theta$ 的解析表达式依赖于这个整数 $k$。问题要求 $\\theta$ 的一个闭式表达式。上述表达式是该非平凡阈值的标准表示形式。\n\n**任务2：非扩张性证明**\n\n我们需要证明投影映射 $P_{\\tau}$ 对于 $\\ell_2$ 范数是非扩张的，即对于任意 $z, z' \\in \\mathbb{R}^n$：\n$$\n\\|P_{\\tau}(z) - P_{\\tau}(z')\\|_{2} \\le \\|z - z'\\|_{2}\n$$\n算子 $P_{\\tau}$ 是到闭凸集 $C = \\{x \\in \\mathbb{R}^n : \\|x\\|_1 \\le \\tau\\}$ 上的投影。对于任意点 $z \\in \\mathbb{R}^n$，这种投影的存在性和唯一性由目标函数 $f(x) = \\frac{1}{2}\\|x-z\\|_2^2$ 的强凸性和集合 $C$ 的凸性保证。\n\n投影到闭凸集 $C$ 上的一个基本性质是其变分不等式刻画。对于任意点 $w \\in \\mathbb{R}^n$，其投影 $P_C(w)$ 满足：\n$$\n\\langle w - P_C(w), y - P_C(w) \\rangle \\le 0, \\quad \\forall y \\in C\n$$\n这个不等式是一个“第一性原理”，源自于在凸集 $C$ 上最小化凸函数 $\\|x-w\\|_2^2$ 的最优性条件。\n\n令 $x = P_{\\tau}(z)$ 和 $x' = P_{\\tau}(z')$。$x$ 和 $x'$ 都属于凸集 $C$。\n将变分不等式应用于 $z$ 的投影：由于 $x' \\in C$，我们可以设置 $y=x'$ 得到：\n$$\n\\langle z - x, x' - x \\rangle \\le 0 \\quad (1)\n$$\n将变分不等式应用于 $z'$ 的投影：由于 $x \\in C$，我们可以设置 $y=x$ 得到：\n$$\n\\langle z' - x', x - x' \\rangle \\le 0 \\quad (2)\n$$\n将不等式 (1) 和 (2) 相加：\n$$\n\\langle z - x, x' - x \\rangle + \\langle z' - x', x - x' \\rangle \\le 0\n$$\n利用内积的线性性质并重写各项：\n$$\n-\\langle z - x, x - x' \\rangle + \\langle z' - x', x - x' \\rangle \\le 0\n$$\n$$\n\\langle (z' - x') - (z - x), x - x' \\rangle \\le 0\n$$\n$$\n\\langle (z' - z) - (x' - x), x - x' \\rangle \\le 0\n$$\n$$\n\\langle z' - z, x - x' \\rangle - \\langle x' - x, x - x' \\rangle \\le 0\n$$\n$$\n-\\langle z - z', x - x' \\rangle + \\|x - x'\\|_2^2 \\le 0\n$$\n这给了我们不等式：\n$$\n\\|x - x'\\|_2^2 \\le \\langle z - z', x - x' \\rangle\n$$\n根据柯西-施瓦茨不等式，$\\langle z - z', x - x' \\rangle \\le \\|z - z'\\|_2 \\|x - x'\\|_2$。\n将此代入前面的结果：\n$$\n\\|x - x'\\|_2^2 \\le \\|z - z'\\|_2 \\|x - x'\\|_2\n$$\n如果 $\\|x - x'\\|_2 = 0$，非扩张性显然成立。如果 $\\|x - x'\\|_2  0$，我们可以将两边同除以 $\\|x - x'\\|_2$ 得到：\n$$\n\\|x - x'\\|_2 \\le \\|z - z'\\|_2\n$$\n代入 $x=P_{\\tau}(z)$ 和 $x'=P_{\\tau}(z')$：\n$$\n\\|P_{\\tau}(z) - P_{\\tau}(z')\\|_{2} \\le \\|z - z'\\|_{2}\n$$\n这完成了对投影映射 $P_{\\tau}$ 是非扩张的的证明。这个性质对于希尔伯特空间中到任意闭凸集上的投影都是普适的。",
            "answer": "$$\\boxed{\\theta = \\frac{1}{k}\\left(\\sum_{i=1}^k |z|_{(i)} - \\tau\\right)}$$"
        },
        {
            "introduction": "最后的这个练习将超越欧几里得几何，探索如何根据问题结构定制不同的距离度量函数。你将研究负熵函数，它是镜像下降算法的核心，非常适合在概率单纯形上进行优化。你的任务是推导与该函数在 $\\ell_1$ 范数下的光滑性和强凸性相关的常数，揭示能够为特定问题类别（如非负稀疏恢复）带来更高效算法的几何基础。",
            "id": "3439643",
            "problem": "考虑压缩感知中的非负稀疏恢复问题，其目标是在一个模拟非负性和质量守恒的约束集上最小化凸数据保真函数 $f(x)$。假设 $f(x)$ 是可微和凸的，可行集是缩放单纯形 $\\mathcal{S}_{R}=\\{x\\in\\mathbb{R}^{n}_{+}:\\sum_{i=1}^{n}x_{i}=R\\}$，其中 $R0$ 是一个固定的常数。考虑两种一阶方法：使用由负熵势函数 $\\phi(x)=\\sum_{i=1}^{n}x_{i}\\log x_{i}-\\sum_{i=1}^{n}x_{i}$ 导出的 Bregman 几何的镜像下降法 (MD)，以及欧几里得投影梯度下降法 (PGD)。镜像映射为 $\\nabla \\phi(x)=(1+\\log x_{1},\\dots,1+\\log x_{n})$，相关的 Bregman 散度为 $D_{\\phi}(y,x)=\\phi(y)-\\phi(x)-\\langle \\nabla \\phi(x),y-x\\rangle$。\n\n我们在子集 $\\mathcal{S}_{R,\\alpha}=\\{x\\in\\mathcal{S}_{R}:\\min_{i}x_{i}\\ge \\alpha\\}$ 上进行研究，其中 $\\alpha\\in(0,R/n]$ 是一个固定常数，它确保所有坐标都有正下界。从关于范数的 Lipschitz 连续性和强凸性的定义，以及关于 $\\phi$ 的 Hessian 矩阵和 Kullback-Leibler (KL) 散度的标准事实出发，推导以下几何常数：\n\n1. 最小常数 $L_{\\phi}0$，使得镜像映射在 $\\mathcal{S}_{R,\\alpha}$ 上是从 $\\ell_{1}$ 到 $\\ell_{\\infty}$ 的 Lipschitz 连续的，即对于所有 $x,y\\in\\mathcal{S}_{R,\\alpha}$，都有 $ \\|\\nabla\\phi(x)-\\nabla\\phi(y)\\|_{\\infty}\\le L_{\\phi}\\|x-y\\|_{1}$。\n\n2. 最大常数 $\\sigma0$，使得 $\\phi$ 在 $\\mathcal{S}_{R}$ 上是关于 $\\ell_1$ 范数的 $\\sigma$-强凸的，即对于所有 $x,y\\in\\mathcal{S}_{R}$，都有 $D_{\\phi}(y,x)\\ge \\frac{\\sigma}{2}\\|y-x\\|_{1}^{2}$。\n\n定义镜像几何条件比 $\\kappa:=\\frac{L_{\\phi}}{\\sigma}$。给出 $\\kappa$ 关于 $R$ 和 $\\alpha$ 的闭式表达式。将最终答案表示为单个解析表达式。无需四舍五入。",
            "solution": "该问题要求推导与缩放单纯形上的负熵势函数相关的两个几何常数 $L_{\\phi}$ 和 $\\sigma$，然后计算它们的比值 $\\kappa$。\n\n让我们首先将给定的信息形式化。\n势函数为 $\\phi(x) = \\sum_{i=1}^{n}x_{i}\\log x_{i}-\\sum_{i=1}^{n}x_{i}$。其定义域为 $\\mathbb{R}^n_{++}$，即分量严格为正的向量集合。\n问题中给出的镜像映射分量为 $[\\nabla \\phi(x)]_i = 1+\\log x_{i}$。而对于给定的势函数 $\\phi(x)$，其实际梯度分量为 $[\\nabla\\phi(x)]_i = \\log x_i$。由于这两个梯度定义相差一个常数向量，并且在单纯形上有 $\\sum y_i = \\sum x_i$，因此这个差异在计算Bregman散度时会被抵消，不影响后续推导。\n在单纯形 $\\mathcal{S}_R = \\{x\\in\\mathbb{R}^{n}_{+}:\\sum_{i=1}^{n}x_{i}=R\\}$ 上，Bregman 散度简化为 Kullback-Leibler (KL) 散度：\n$$D_{\\phi}(y,x) = \\phi(y) - \\phi(x) - \\langle \\nabla\\phi(x), y-x \\rangle = \\sum_{i=1}^n y_i \\log\\left(\\frac{y_i}{x_i}\\right) = D_{KL}(y||x)$$\n这对于任何形如 $\\sum_i \\psi(x_i) + c^T x + d$ 的势函数都成立，其 Bregman 散度在超平面上可以方便地简化。\n\n问题的两个部分需要在两个不同的集合上计算常数：\n1.  $L_\\phi$ 在截断单纯形 $\\mathcal{S}_{R,\\alpha}=\\{x\\in\\mathcal{S}_{R}:\\min_{i}x_{i}\\ge \\alpha\\}$ 上计算，其中 $\\alpha\\in(0,R/n]$。\n2.  $\\sigma$ 在完整缩放单纯形 $\\mathcal{S}_{R}$ 上计算。\n\n**1. Lipschitz 常数 $L_{\\phi}$ 的推导**\n\n我们的任务是找到最小常数 $L_{\\phi}0$，使得对于所有 $x,y\\in\\mathcal{S}_{R,\\alpha}$，以下不等式成立：\n$$ \\|\\nabla\\phi(x)-\\nabla\\phi(y)\\|_{\\infty}\\le L_{\\phi}\\|x-y\\|_{1} $$\n我们正在分析其 Lipschitz 连续性的函数是 $g(x) = \\nabla\\phi(x)$。由于此函数可微，其在凸集上的 Lipschitz 常数是其 Jacobian 矩阵（即 $\\phi(x)$ 的 Hessian 矩阵 $\\nabla^2\\phi(x)$）的算子范数的上确界。\n该算子范数是从空间 $(\\mathbb{R}^n, \\|\\cdot\\|_1)$ 到空间 $(\\mathbb{R}^n, \\|\\cdot\\|_\\infty)$ 的。因此，\n$$ L_{\\phi} = \\sup_{z \\in \\mathcal{S}_{R,\\alpha}} \\|\\nabla^2\\phi(z)\\|_{1\\to\\infty} $$\nHessian 矩阵是 $\\nabla^2\\phi(z) = \\text{diag}(1/z_1, 1/z_2, \\dots, 1/z_n)$。对于一个对角矩阵 $D = \\text{diag}(d_1, \\dots, d_n)$，算子范数 $\\|D\\|_{1\\to\\infty}$ 由下式给出：\n$$ \\|D\\|_{1\\to\\infty} = \\sup_{v\\neq 0} \\frac{\\|Dv\\|_{\\infty}}{\\|v\\|_1} = \\sup_{v\\neq 0} \\frac{\\max_i |d_i v_i|}{\\sum_j|v_j|} = \\max_i |d_i| $$\n最后一个等式可以通过选择与最大 $|d_k|$ 对应的标准基向量 $e_k$ 作为 $v$ 来得到。\n\n在我们的情况下，对角元素是 $1/z_i$，它们是正的，因为 $z \\in \\mathcal{S}_{R,\\alpha}$ 意味着 $z_i \\ge \\alpha  0$。因此，\n$$ \\|\\nabla^2\\phi(z)\\|_{1\\to\\infty} = \\max_{i=1,\\dots,n} \\frac{1}{z_i} $$\n为了求得 $L_\\phi$，我们必须对所有 $z \\in \\mathcal{S}_{R,\\alpha}$ 取这个量的上确界：\n$$ L_{\\phi} = \\sup_{z \\in \\mathcal{S}_{R,\\alpha}} \\left( \\max_{i=1,\\dots,n} \\frac{1}{z_i} \\right) $$\n根据集合 $\\mathcal{S}_{R,\\alpha}$ 的定义，对于任何 $z \\in \\mathcal{S}_{R,\\alpha}$，我们有 $z_i \\ge \\alpha$ 对于所有 $i=1,\\dots,n$。这意味着对于所有 $i$，$1/z_i \\le 1/\\alpha$。因此，$\\max_i(1/z_i) \\le 1/\\alpha$。\n为了证明这个上确界确实是 $1/\\alpha$，我们必须证明存在一个点 $z \\in \\mathcal{S}_{R,\\alpha}$，使得 $\\max_i(1/z_i) = 1/\\alpha$。这需要找到一个 $z \\in \\mathcal{S}_{R,\\alpha}$，使其至少有一个分量（比如说 $z_k$）等于 $\\alpha$。\n让我们构造这样一个点。令 $z_1 = \\alpha$。剩余的质量 $R-\\alpha$ 必须分配给其他 $n-1$ 个分量，并且每个分量也必须至少为 $\\alpha$。如果剩余质量足够，这是可能的，即 $R-\\alpha \\ge (n-1)\\alpha$，简化后为 $R \\ge n\\alpha$。这个条件由问题陈述中的 $\\alpha \\in (0, R/n]$ 保证。\n例如，如果 $n1$ 且 $\\alpha  R/n$，我们可以设 $z_1 = \\alpha$，$z_2 = R-(n-1)\\alpha$，以及对于 $i=3,\\dots,n$ 设 $z_i = \\alpha$。所有分量都大于或等于 $\\alpha$，它们的和是 $\\alpha + (R-(n-1)\\alpha) + (n-2)\\alpha = R$。这个点在 $\\mathcal{S}_{R,\\alpha}$ 中。\n对于这个点 $z$，我们有 $\\max_i(1/z_i) = 1/\\alpha$。\n因此，上确界是可达的，我们得出结论：\n$$ L_{\\phi} = \\frac{1}{\\alpha} $$\n\n**2. 强凸性常数 $\\sigma$ 的推导**\n\n我们需要找到最大的常数 $\\sigma0$，使得 $\\phi$ 在集合 $\\mathcal{S}_R$ 上是关于 $\\ell_1$ 范数的 $\\sigma$-强凸的。提供的定义是：\n$$ D_{\\phi}(y,x) \\ge \\frac{\\sigma}{2}\\|y-x\\|_{1}^{2} \\quad \\forall x,y\\in\\mathcal{S}_{R} $$\n如前所述，$D_{\\phi}(y,x) = D_{KL}(y||x)$。问题归结为在缩放单纯形 $\\mathcal{S}_R$ 上找到 KL 散度的 $\\ell_1$-强凸性参数。\n我们可以利用著名的 Pinsker 不等式，它将 KL 散度与概率分布的全变差距离的平方联系起来。对于 $\\{1, \\dots, n\\}$ 上的任意两个概率分布 $p, q$（即标准单纯形 $\\mathcal{S}_1$ 中的向量），Pinsker 不等式表明：\n$$ D_{KL}(q||p) \\ge \\frac{1}{2}\\|q-p\\|_1^2 $$\n常数 $1/2$ 是最佳可能值。这意味着函数 $\\psi(p) = \\sum p_i \\log p_i$ 在 $\\mathcal{S}_1$ 上是关于 $\\ell_1$ 范数的 $1$-强凸的。\n\n我们的问题是在缩放单纯形 $\\mathcal{S}_R$ 上。我们可以通过一个缩放因子 $R$ 将我们的向量 $x, y \\in \\mathcal{S}_R$ 与概率向量 $p, q \\in \\mathcal{S}_1$ 联系起来：\n$$ p = \\frac{x}{R}, \\quad q = \\frac{y}{R} $$\n现在，我们用 $p$ 和 $q$ 来表示 $D_{KL}(y||x)$ 和 $\\|y-x\\|_1$：\n$$ D_{KL}(y||x) = \\sum_{i=1}^n y_i \\log\\left(\\frac{y_i}{x_i}\\right) = \\sum_{i=1}^n (Rq_i) \\log\\left(\\frac{Rq_i}{Rp_i}\\right) = R \\sum_{i=1}^n q_i \\log\\left(\\frac{q_i}{p_i}\\right) = R \\cdot D_{KL}(q||p) $$\n$$ \\|y-x\\|_1 = \\sum_{i=1}^n |y_i - x_i| = \\sum_{i=1}^n |Rq_i - Rp_i| = R \\sum_{i=1}^n |q_i - p_i| = R\\|q-p\\|_1 $$\n将这些代入目标不等式 $D_{\\phi}(y,x) \\ge \\frac{\\sigma}{2}\\|y-x\\|_{1}^{2}$ 中：\n$$ R \\cdot D_{KL}(q||p) \\ge \\frac{\\sigma}{2} (R\\|q-p\\|_1)^2 = \\frac{\\sigma R^2}{2} \\|q-p\\|_1^2 $$\n两边同除以 $R$ (因为 $R0$)，我们得到：\n$$ D_{KL}(q||p) \\ge \\frac{\\sigma R}{2} \\|q-p\\|_1^2 $$\n这个不等式必须对所有 $p,q \\in \\mathcal{S}_1$ 成立。通过将其与 Pinsker 不等式 $D_{KL}(q||p) \\ge \\frac{1}{2}\\|q-p\\|_1^2$ 进行比较，我们必须有：\n$$ \\frac{\\sigma R}{2} \\le \\frac{1}{2} $$\n这意味着 $\\sigma R \\le 1$，或者 $\\sigma \\le 1/R$。因为我们寻求最大的这样的常数 $\\sigma$，并且 Pinsker 不等式中的常数是锐的（即不可改进的），所以 $\\sigma$ 的最大可能值为：\n$$ \\sigma = \\frac{1}{R} $$\n\n**3. 条件比 $\\kappa$ 的计算**\n\n镜像几何条件比 $\\kappa$ 定义为我们推导出的两个常数的比值：\n$$ \\kappa = \\frac{L_{\\phi}}{\\sigma} $$\n代入值 $L_{\\phi} = 1/\\alpha$ 和 $\\sigma = 1/R$：\n$$ \\kappa = \\frac{1/\\alpha}{1/R} = \\frac{R}{\\alpha} $$\n这个最终表达式给出了用给定参数 $R$ 和 $\\alpha$ 表示的条件比。",
            "answer": "$$\\boxed{\\frac{R}{\\alpha}}$$"
        }
    ]
}