{
    "hands_on_practices": [
        {
            "introduction": "对于组 LASSO，许多优化算法依赖于一个核心操作，即近端映射（proximal mapping）。这个练习将引导您从凸分析的基本原理出发，推导出与组 LASSO 惩罚项相关的近端算子，即块软阈值算子（block soft-thresholding operator）。通过亲手推导并将其应用于一个具体的数值例子，您将能深刻理解该算子是如何通过“收缩或归零”的机制来实现组稀疏性的 。",
            "id": "3449689",
            "problem": "考虑与组最小绝对收缩和选择算子 (LASSO) 相关的近端映射，其中惩罚项为非重叠组上欧几里得范数的加权和。设组为不重叠的，并定义为 $G_1=\\{1,2\\}$ 和 $G_2=\\{3\\}$。设数据向量为 $v \\in \\mathbb{R}^3$，其块为 $v_{G_1}=(3,4)$ 和 $v_{G_2}=(3)$，正权重为 $w_1=2$ 和 $w_2=1$。考虑在步长 $\\lambda=1$ 时计算近端点的凸优化问题：\n$$\n\\min_{x \\in \\mathbb{R}^3}\\ \\frac{1}{2}\\|x-v\\|_2^2 + \\lambda \\sum_{g=1}^2 w_g \\|x_{G_g}\\|_2.\n$$\n从凸分析和优化的基本原理出发，即不相交组上和的可分离性、通过次微分的一阶最优性条件以及欧几里得范数的次微分，逐块推导唯一最小化子的形式，而不引用任何预先给出的收缩公式。然后，计算 $x_{G_1}$ 和 $x_{G_2}$ 的显式块输出，并确定组支撑集，该支撑集定义为使得 $\\|x_{G_g}\\|_2 \\neq 0$ 的组索引 $g$ 的集合。给出该支撑集的基数作为最终答案。无需四舍五入。",
            "solution": "用户希望我解决一个关于组 LASSO 的近端映射问题。\n\n### 第一步：提取已知条件\n问题提供了以下信息：\n-   要最小化的目标函数：$\\frac{1}{2}\\|x-v\\|_2^2 + \\lambda \\sum_{g=1}^2 w_g \\|x_{G_g}\\|_2$\n-   向量 $x \\in \\mathbb{R}^3$。\n-   数据向量 $v \\in \\mathbb{R}^3$。\n-   不重叠的组：$G_1=\\{1,2\\}$ 和 $G_2=\\{3\\}$。\n-   数据向量的块：$v_{G_1}=(3,4)$ 和 $v_{G_2}=(3)$。\n-   正权重：$w_1=2$ 和 $w_2=1$。\n-   步长：$\\lambda=1$。\n-   任务是找到最小化子 $x$，确定组支撑集（使得 $\\|x_{G_g}\\|_2 \\neq 0$ 的索引 $g$），并提供该支撑集的基数。\n-   推导必须从基本原理出发：可分离性、通过次微分的一阶最优性以及欧几里得范数的次微分。\n\n### 第二步：使用提取的已知条件进行验证\n该问题是一个标准的凸优化问题，具体来说是计算组 LASSO 惩罚项的近端算子。\n-   **科学依据：** 组 LASSO 及其近端映射是高维统计、机器学习和信号处理中的基本概念。该问题基于凸分析中成熟的数学原理，具有科学合理性。\n-   **适定性：** 目标函数是一个严格凸函数 ($\\frac{1}{2}\\|x-v\\|_2^2$) 和一个凸函数 ($\\lambda \\sum w_g \\|x_{G_g}\\|_2$) 的和。这确保了存在唯一的最小化子。该问题是适定的。\n-   **客观性：** 问题以精确的数学语言陈述，没有歧义或主观陈述。\n-   **完整性和一致性：** 所有必要的参数（$v$、组、$w$、$\\lambda$）都已提供。维度是一致的：$v \\in \\mathbb{R}^3$，并且组 $G_1, G_2$ 划分了索引集 $\\{1, 2, 3\\}$。\n\n### 第三步：结论与行动\n问题有效。将提供完整的解答。\n\n### 解题推导\n优化问题是：\n$$ \\min_{x \\in \\mathbb{R}^3} F(x) = \\min_{x \\in \\mathbb{R}^3} \\left( \\frac{1}{2}\\|x-v\\|_2^2 + \\lambda \\sum_{g=1}^2 w_g \\|x_{G_g}\\|_2 \\right) $$\n组 $G_1 = \\{1,2\\}$ 和 $G_2 = \\{3\\}$ 不重叠，其并集为 $\\{1,2,3\\}$。这意味着问题是可分离的。平方欧几里得范数项可以按组分解：\n$$ \\|x-v\\|_2^2 = \\sum_{i=1}^3 (x_i - v_i)^2 = \\sum_{i \\in G_1} (x_i - v_i)^2 + \\sum_{i \\in G_2} (x_i - v_i)^2 = \\|x_{G_1}-v_{G_1}\\|_2^2 + \\|x_{G_2}-v_{G_2}\\|_2^2 $$\n因此，目标函数可以写成关于不相交变量集的函数之和：\n$$ F(x) = \\left( \\frac{1}{2}\\|x_{G_1}-v_{G_1}\\|_2^2 + \\lambda w_1 \\|x_{G_1}\\|_2 \\right) + \\left( \\frac{1}{2}\\|x_{G_2}-v_{G_2}\\|_2^2 + \\lambda w_2 \\|x_{G_2}\\|_2 \\right) $$\n$$ F(x) = F_1(x_{G_1}) + F_2(x_{G_2}) $$\n为了最小化 $F(x)$，我们可以独立地最小化 $F_1(x_{G_1})$ 和 $F_2(x_{G_2})$。让我们推导一个通用组子问题的解：\n$$ \\min_{x_g} F_g(x_g) = \\min_{x_g} \\left( \\frac{1}{2}\\|x_g-v_g\\|_2^2 + \\alpha_g \\|x_g\\|_2 \\right) $$\n其中 $x_g \\equiv x_{G_g}$，$v_g \\equiv v_{G_g}$，且 $\\alpha_g = \\lambda w_g$。\n\n根据凸函数的费马法则，一个点 $x_g^*$ 是最小化子当且仅当零向量位于目标函数在 $x_g^*$ 处的次微分中：\n$$ 0 \\in \\partial F_g(x_g^*) $$\n$F_g$ 的次微分由其各项的次微分之和给出：\n$$ \\partial F_g(x_g) = (x_g - v_g) + \\alpha_g \\partial \\|x_g\\|_2 $$\n欧几里得范数 $\\|z\\|_2$ 的次微分是：\n$$ \\partial \\|z\\|_2 = \\begin{cases} \\{z / \\|z\\|_2\\}  \\text{若 } z \\neq 0 \\\\ \\{u : \\|u\\|_2 \\le 1\\}  \\text{若 } z = 0 \\end{cases} $$\n最优性条件为 $0 \\in (x_g^* - v_g) + \\alpha_g \\partial \\|x_g^*\\|_2$，可重写为：\n$$ v_g - x_g^* \\in \\alpha_g \\partial \\|x_g^*\\|_2 $$\n我们对解 $x_g^*$ 分两种情况进行分析。\n\n情况1：$x_g^* \\neq 0$。\n在这种情况下，$\\partial \\|x_g^*\\|_2 = \\{x_g^* / \\|x_g^*\\|_2\\}$。最优性条件变为：\n$$ v_g - x_g^* = \\alpha_g \\frac{x_g^*}{\\|x_g^*\\|_2} $$\n对 $v_g$ 进行整理：\n$$ v_g = x_g^* + \\alpha_g \\frac{x_g^*}{\\|x_g^*\\|_2} = x_g^* \\left(1 + \\frac{\\alpha_g}{\\|x_g^*\\|_2}\\right) $$\n这表明 $v_g$ 和 $x_g^*$ 必须共线且同向。因此，$\\frac{x_g^*}{\\|x_g^*\\|_2} = \\frac{v_g}{\\|v_g\\|_2}$。\n对关于 $v_g$ 的方程两边取欧几里得范数：\n$$ \\|v_g\\|_2 = \\left\\| x_g^* \\left(1 + \\frac{\\alpha_g}{\\|x_g^*\\|_2}\\right) \\right\\|_2 = \\|x_g^*\\|_2 \\left(1 + \\frac{\\alpha_g}{\\|x_g^*\\|_2}\\right) = \\|x_g^*\\|_2 + \\alpha_g $$\n由此，我们得到解的范数：$\\|x_g^*\\|_2 = \\|v_g\\|_2 - \\alpha_g$。\n因为我们假设 $x_g^* \\neq 0$，所以必须有 $\\|x_g^*\\|_2 > 0$，这意味着 $\\|v_g\\|_2 - \\alpha_g > 0$，即 $\\|v_g\\|_2 > \\alpha_g$。\n如果这个条件成立，解就是：\n$$ x_g^* = \\|x_g^*\\|_2 \\frac{v_g}{\\|v_g\\|_2} = (\\|v_g\\|_2 - \\alpha_g) \\frac{v_g}{\\|v_g\\|_2} = \\left(1 - \\frac{\\alpha_g}{\\|v_g\\|_2}\\right) v_g $$\n\n情况2：$x_g^* = 0$。\n在这种情况下，$\\partial \\|x_g^*\\|_2$ 是闭单位球 $\\{u : \\|u\\|_2 \\le 1\\}$。最优性条件变为：\n$$ v_g - 0 \\in \\alpha_g \\{u : \\|u\\|_2 \\le 1\\} $$\n这等价于 $\\|v_g\\|_2 \\le \\alpha_g$。\n\n结合两种情况，唯一的最小化子 $x_g^*$ 是：\n$$ x_g^* = \\begin{cases} \\left(1 - \\frac{\\alpha_g}{\\|v_g\\|_2}\\right) v_g  \\text{若 } \\|v_g\\|_2 > \\alpha_g \\\\ 0  \\text{若 } \\|v_g\\|_2 \\le \\alpha_g \\end{cases} $$\n这就是块软阈值算子。\n\n### 针对具体问题的计算\n现在我们将此推导出的公式应用于每个组，使用给定的值：$\\lambda=1$，$v_{G_1}=(3,4)$，$v_{G_2}=(3)$，$w_1=2$，$w_2=1$。\n\n**对于组1：**\n-   $g=1$，$x_{G_1} \\in \\mathbb{R}^2$。\n-   $v_{G_1} = (3,4)$。\n-   $\\alpha_1 = \\lambda w_1 = 1 \\times 2 = 2$。\n-   $v_{G_1}$ 的范数是 $\\|v_{G_1}\\|_2 = \\sqrt{3^2 + 4^2} = \\sqrt{9+16} = \\sqrt{25} = 5$。\n-   我们比较 $\\|v_{G_1}\\|_2$ 和 $\\alpha_1$：$5 > 2$。\n-   由于 $\\|v_{G_1}\\|_2 > \\alpha_1$，我们属于第一种情况。解 $x_{G_1}$ 非零。\n-   $x_{G_1} = \\left(1 - \\frac{\\alpha_1}{\\|v_{G_1}\\|_2}\\right) v_{G_1} = \\left(1 - \\frac{2}{5}\\right) (3,4) = \\frac{3}{5} (3,4) = \\left(\\frac{9}{5}, \\frac{12}{5}\\right)$。\n-   解块的范数是 $\\|x_{G_1}\\|_2 = \\sqrt{(\\frac{9}{5})^2 + (\\frac{12}{5})^2} = \\frac{1}{5}\\sqrt{81+144} = \\frac{\\sqrt{225}}{5} = \\frac{15}{5} = 3$。\n-   由于 $\\|x_{G_1}\\|_2 = 3 \\neq 0$，组1在支撑集中。\n\n**对于组2：**\n-   $g=2$，$x_{G_2} \\in \\mathbb{R}^1$。\n-   $v_{G_2} = (3)$。\n-   $\\alpha_2 = \\lambda w_2 = 1 \\times 1 = 1$。\n-   $v_{G_2}$ 的范数是 $\\|v_{G_2}\\|_2 = |3| = 3$。\n-   我们比较 $\\|v_{G_2}\\|_2$ 和 $\\alpha_2$：$3 > 1$。\n-   由于 $\\|v_{G_2}\\|_2 > \\alpha_2$，我们再次属于第一种情况。解 $x_{G_2}$ 非零。\n-   $x_{G_2} = \\left(1 - \\frac{\\alpha_2}{\\|v_{G_2}\\|_2}\\right) v_{G_2} = \\left(1 - \\frac{1}{3}\\right) (3) = \\frac{2}{3} \\times 3 = 2$。\n-   解块的范数是 $\\|x_{G_2}\\|_2 = |2| = 2$。\n-   由于 $\\|x_{G_2}\\|_2 = 2 \\neq 0$，组2也在支撑集中。\n\n### 组支撑集\n组支撑集定义为使得 $\\|x_{G_g}\\|_2 \\neq 0$ 的组索引 $g$ 的集合。\n-   对于 $g=1$，我们得到 $\\|x_{G_1}\\|_2 = 3 \\neq 0$。\n-   对于 $g=2$，我们得到 $\\|x_{G_2}\\|_2 = 2 \\neq 0$。\n两个组都被激活。组支撑集为 $\\{1, 2\\}$。\n该支撑集的基数是其中元素的数量，即 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "理解一个优化问题的解，不仅在于如何求出它，还在于如何验证其最优性。这个练习将带您深入探索组 LASSO 的 Karush-Kuhn-Tucker (KKT) 最优性条件 。您需要为一个给定的候选解，通过检验其在每个组上的KKT条件，反向推导出使其成为最优解的唯一正则化参数 $\\lambda$ 值，从而加深对残差、模型系数和正则化强度之间内在平衡的认识。",
            "id": "3449680",
            "problem": "考虑具有非重叠组的组最小绝对收缩和选择算子（group LASSO），其定义如下：对于一个响应向量 $y \\in \\mathbb{R}^n$，一个设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$（其列为 $\\{x_j\\}_{j=1}^p$），一个对 $\\{1,\\dots,p\\}$ 进行划分的分组 $\\{G_1,\\dots,G_m\\}$，一组正权重 $\\{w_g\\}_{g=1}^m$，以及一个正则化参数 $\\lambda > 0$，其目标函数为\n$$\n\\min_{\\beta \\in \\mathbb{R}^p} \\ \\frac{1}{2} \\|y - X \\beta\\|_2^2 + \\lambda \\sum_{g=1}^m w_g \\|\\beta_g\\|_2,\n$$\n其中 $\\beta_g \\in \\mathbb{R}^{|G_g|}$ 表示由 $G_g$ 索引的 $\\beta$ 的子向量。\n\n请使用凸优化的基本一阶最优性理论和欧几里得范数的次微分（不调用任何预封装的公式），通过在所声称的解处检查块相关性和次梯度隶属关系，来验证以下具体实例的 Karush-Kuhn-Tucker (KKT) 条件，并确定使该解成为最优解的唯一 $\\lambda$ 值。\n\n该实例具体说明如下：\n- 维度：$n = 5$，$p = 6$，有三个非重叠的组 $G_1 = \\{1,2\\}$，$G_2 = \\{3,4\\}$ 和 $G_3 = \\{5,6\\}$。\n- 权重：$w_1 = 1$，$w_2 = 2$，$w_3 = 1$。\n- $X$ 的列向量：\n$$\nx_1 = (1,0,0,0,0)^\\top,\\quad\nx_2 = (0,1,0,0,0)^\\top,\\quad\nx_3 = (0,0,1,0,0)^\\top,\\quad\nx_4 = (0,0,0,1,0)^\\top,\\quad\nx_5 = (0,0,0,0,1)^\\top,\\quad\nx_6 = \\frac{1}{\\sqrt{2}}(0,0,1,1,0)^\\top.\n$$\n- 响应：$y = (3,3,2,0,0)^\\top$。\n- 声称的最优解：\n$$\n\\beta^\\star = (2,2,0,0,0,0)^\\top,\n$$\n该解具有活跃块 $G_1$ 和非活跃块 $G_2$、$G_3$。\n\n任务：\n1. 仅从目标函数的定义以及凸函数和次梯度的基本性质出发，写出 $\\beta^\\star$ 为最优解的充要一阶最优性条件。\n2. 评估块相关向量 $X_{G_g}^\\top r$（其中 $g \\in \\{1,2,3\\}$，$r = y - X \\beta^\\star$ 是所声称解处的残差），并使用欧几里得范数的次梯度隶属关系来检验每个块的 KKT 条件。\n3. 确定与活跃块 $G_1$ 的条件一致的唯一 $\\lambda > 0$，并验证非活跃块在此 $\\lambda$ 值下满足各自的条件。\n\n将 $\\lambda$ 的最终值表示为精确的闭式表达式。无需四舍五入。",
            "solution": "该问题陈述是有效的，因为它具有科学依据、良定、客观，并为凸优化中的一个标准问题提供了完整且一致的设置。\n\n组 LASSO 目标函数由两个凸函数之和给出：\n$$\nF(\\beta) = f(\\beta) + h(\\beta) = \\frac{1}{2} \\|y - X \\beta\\|_2^2 + \\lambda \\sum_{g=1}^m w_g \\|\\beta_g\\|_2\n$$\n其中 $f(\\beta) = \\frac{1}{2} \\|y - X \\beta\\|_2^2$ 是可微的，而 $h(\\beta) = \\lambda \\sum_{g=1}^m w_g \\|\\beta_g\\|_2$ 是不可微的。由于 $F(\\beta)$ 是凸函数，向量 $\\beta^\\star \\in \\mathbb{R}^p$ 是 $F(\\beta)$ 的全局最小化子，当且仅当零向量是其次微分的一个元素，即 $0 \\in \\partial F(\\beta^\\star)$。\n\n使用次微分的求和法则，该条件变为：\n$$\n0 \\in \\nabla f(\\beta^\\star) + \\partial h(\\beta^\\star)\n$$\n其中 $\\nabla f(\\beta^\\star)$ 是 $f$ 在 $\\beta^\\star$ 处的梯度，$\\partial h(\\beta^\\star)$ 是 $h$ 在 $\\beta^\\star$ 处的次微分。最小二乘项 $f(\\beta)$ 的梯度是 $\\nabla f(\\beta) = -X^\\top(y - X\\beta)$。因此，最优性条件可以写成：\n$$\nX^\\top(y - X\\beta^\\star) \\in \\partial h(\\beta^\\star)\n$$\n惩罚项 $h(\\beta)$ 在非重叠组 $G_g$ 上是可分的，因此其次微分是每一项次微分的笛卡尔积：\n$$\n\\partial h(\\beta^\\star) = \\lambda w_1 \\partial \\|\\beta_{G_1}^\\star\\|_2 \\times \\lambda w_2 \\partial \\|\\beta_{G_2}^\\star\\|_2 \\times \\dots \\times \\lambda w_m \\partial \\|\\beta_{G_m}^\\star\\|_2\n$$\n这里，$\\partial \\|\\cdot\\|_2$ 表示欧几里得范数的次微分。对于向量 $u$，\n$$\n\\partial \\|u\\|_2 = \\begin{cases} \\{u / \\|u\\|_2\\}  \\text{if } u \\neq 0 \\\\ \\{v \\mid \\|v\\|_2 \\le 1\\}  \\text{if } u = 0 \\end{cases}\n$$\n令 $r = y - X\\beta^\\star$ 为解 $\\beta^\\star$ 处的残差向量。最优性条件可以分解为分块的 Karush-Kuhn-Tucker (KKT) 条件。对于每个组 $g \\in \\{1, \\dots, m\\}$：\n$$\nX_{G_g}^\\top r \\in \\lambda w_g \\partial \\|\\beta_{G_g}^\\star\\|_2\n$$\n这导致了两种不同的情况：\n1.  对于一个**活跃块**，其中 $\\beta_{G_g}^\\star \\neq 0$：\n    $$\n    X_{G_g}^\\top r = \\lambda w_g \\frac{\\beta_{G_g}^\\star}{\\|\\beta_{G_g}^\\star\\|_2}\n    $$\n2.  对于一个**非活跃块**，其中 $\\beta_{G_g}^\\star = 0$：\n    $$\n    \\|X_{G_g}^\\top r\\|_2 \\le \\lambda w_g\n    $$\n\n现在，我们将这些条件应用于所提供的具体实例。\n设计矩阵 $X$ 由其列向量构成：\n$$\nX = \\begin{pmatrix} 1  0  0  0  0  0 \\\\ 0  1  0  0  0  0 \\\\ 0  0  1  0  0  \\frac{1}{\\sqrt{2}} \\\\ 0  0  0  1  0  \\frac{1}{\\sqrt{2}} \\\\ 0  0  0  0  1  0 \\end{pmatrix}\n$$\n响应为 $y = (3, 3, 2, 0, 0)^\\top$，声称的解为 $\\beta^\\star = (2, 2, 0, 0, 0, 0)^\\top$。\n首先，我们计算预测响应 $X\\beta^\\star$：\n$$\nX\\beta^\\star = \\beta_1^\\star x_1 + \\beta_2^\\star x_2 = 2 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + 2 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n残差向量 $r$ 为：\n$$\nr = y - X\\beta^\\star = \\begin{pmatrix} 3 \\\\ 3 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 2 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n接下来，我们计算块相关向量 $X_{G_g}^\\top r$。\n-   **组 $G_1 = \\{1, 2\\}$** （活跃，$\\beta_{G_1}^\\star = (2, 2)^\\top \\neq 0$）：\n    $$\n    X_{G_1}^\\top r = \\begin{pmatrix} 1  0  0  0  0 \\\\ 0  1  0  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n    $$\n-   **组 $G_2 = \\{3, 4\\}$** （非活跃，$\\beta_{G_2}^\\star = (0, 0)^\\top = 0$）：\n    $$\n    X_{G_2}^\\top r = \\begin{pmatrix} 0  0  1  0  0 \\\\ 0  0  0  1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}\n    $$\n-   **组 $G_3 = \\{5, 6\\}$** （非活跃，$\\beta_{G_3}^\\star = (0, 0)^\\top = 0$）：\n    $$\n    X_{G_3}^\\top r = \\begin{pmatrix} 0  0  0  0  1 \\\\ 0  0  \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{2}{\\sqrt{2}} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\sqrt{2} \\end{pmatrix}\n    $$\n\n为了找到 $\\lambda$ 的唯一值，我们使用活跃块 $G_1$ 的等式条件，其中 $w_1 = 1$。\n子向量为 $\\beta_{G_1}^\\star = (2, 2)^\\top$。其欧几里得范数为 $\\|\\beta_{G_1}^\\star\\|_2 = \\sqrt{2^2 + 2^2} = \\sqrt{8} = 2\\sqrt{2}$。\n$G_1$ 的 KKT 条件为：\n$$\n\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\lambda w_1 \\frac{\\beta_{G_1}^\\star}{\\|\\beta_{G_1}^\\star\\|_2} = \\lambda (1) \\frac{\\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}}{2\\sqrt{2}} = \\frac{\\lambda}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n比较向量的分量，我们得到方程 $1 = \\frac{\\lambda}{\\sqrt{2}}$，这唯一地确定了 $\\lambda$：\n$$\n\\lambda = \\sqrt{2}\n$$\n最后，我们必须验证这个 $\\lambda$ 值是否满足非活跃块 $G_2$ 和 $G_3$ 的 KKT 条件。\n-   **对组 $G_2$ 的验证**：\n    条件是 $\\|X_{G_2}^\\top r\\|_2 \\le \\lambda w_2$。其中 $w_2 = 2$：\n    $$\n    \\|X_{G_2}^\\top r\\|_2 = \\left\\| \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} \\right\\|_2 = \\sqrt{2^2 + 0^2} = 2\n    $$\n    我们检查 $2 \\le \\lambda w_2 = (\\sqrt{2})(2) = 2\\sqrt{2}$ 是否成立。这是成立的，因为 $1 \\le \\sqrt{2}$。条件满足。\n-   **对组 $G_3$ 的验证**：\n    条件是 $\\|X_{G_3}^\\top r\\|_2 \\le \\lambda w_3$。其中 $w_3 = 1$：\n    $$\n    \\|X_{G_3}^\\top r\\|_2 = \\left\\| \\begin{pmatrix} 0 \\\\ \\sqrt{2} \\end{pmatrix} \\right\\|_2 = \\sqrt{0^2 + (\\sqrt{2})^2} = \\sqrt{2}\n    $$\n    我们检查 $\\sqrt{2} \\le \\lambda w_3 = (\\sqrt{2})(1) = \\sqrt{2}$ 是否成立。这也成立。条件满足。\n\n所有 KKT 条件在 $\\lambda = \\sqrt{2}$ 时都得到满足。因此，使得所声称的解 $\\beta^\\star$ 为最优解的唯一 $\\lambda$ 值为 $\\sqrt{2}$。",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "组 LASSO 的一个强大之处在于它能通过调节正则化参数 $\\lambda$ 生成一系列具有不同稀疏程度的解，这构成了所谓的“正则化路径”。本练习专注于分析模型在 $\\lambda$ 变化时的行为，特别是在一个简化的正交设计下 。您的任务是确定那些导致模型中活跃组集合发生改变的关键 $\\lambda$ 临界值，从而直观地揭示正则化是如何控制组选择过程的。",
            "id": "3449709",
            "problem": "考虑用于非重叠组的组最小绝对收缩和选择算子 (Group LASSO)，其定义为以下问题的解：\n$$\n\\min_{x \\in \\mathbb{R}^{p}} \\; \\frac{1}{2}\\|y - A x\\|_{2}^{2} + \\lambda \\sum_{g=1}^{G} w_{g} \\|x_{G_{g}}\\|_{2},\n$$\n其中 $A \\in \\mathbb{R}^{m \\times p}$ 是一个设计矩阵，其列被划分为 $G$ 个不相交的索引集 $G_{1},\\dots,G_{G}$，$x_{G_{g}}$ 表示 $x$ 中限于组 $G_{g}$ 内索引的子向量，$w_{g} > 0$ 是组权重，$\\lambda \\geq 0$ 是一个正则化参数。如果在最小化子中 $\\|x_{G_{g}}\\|_{2} > 0$，则称组 $G_{g}$ 是激活的，否则为非激活的。\n\n处理以下具体实例：\n- 两个组 $G_{1} = \\{1,2\\}$ 和 $G_{2} = \\{3,4\\}$，因此 $G = 2$ 且 $p = 4$。\n- 矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$ 在每个组内具有标准正交列，并且各组是相互正交的子空间；具体来说，令\n$$\nA = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1\n\\end{pmatrix},\n$$\n因此其列是 $\\mathbb{R}^{4}$ 中的标准基向量，且 $A^{\\top}A = I_{4}$。\n- 权重为 $w_{1} = \\frac{3}{2}$ 和 $w_{2} = 1$。\n- 观测向量为 $y = \\begin{pmatrix} 3 \\\\ 4 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n\n仅从凸优化、范数的次微分和标准正交性的核心定义出发，推导最小化子 $x^{\\star}(\\lambda)$ 的精确刻画，并确定作为 $\\lambda$ 的函数，哪些组是激活的。然后计算激活集发生变化的两个临界值 $\\lambda$（即组在激活和非激活状态之间切换的 $\\lambda$ 值）。按升序报告这两个临界值作为你的最终答案。以精确值表示最终结果，不要四舍五入。",
            "solution": "用户想要解决一个组 LASSO 优化问题，并找到正则化参数 $\\lambda$ 的临界值，在这些临界值处激活组的集合会发生变化。\n\n该优化问题由下式给出：\n$$\n\\min_{x \\in \\mathbb{R}^{p}} \\; L(x) = \\frac{1}{2}\\|y - A x\\|_{2}^{2} + \\lambda \\sum_{g=1}^{G} w_{g} \\|x_{G_{g}}\\|_{2}\n$$\n函数 $L(x)$ 是凸函数，因为它是一个凸二次函数（最小二乘项）和一个凸函数之和（由非负权重缩放的欧几里得范数）的和。因此，一个向量 $x^{\\star}$ 是全局最小化子的充要条件是，零向量属于在 $x^{\\star}$ 处计算的 $L(x)$ 的次微分。这是一阶最优性条件：\n$$\n0 \\in \\partial L(x^{\\star})\n$$\n使用次微分的求和法则，我们有：\n$$\n\\partial L(x) = \\nabla \\left( \\frac{1}{2}\\|y - A x\\|_{2}^{2} \\right) + \\lambda \\partial \\left( \\sum_{g=1}^{G} w_{g} \\|x_{G_{g}}\\|_{2} \\right)\n$$\n可微的最小二乘项的梯度是：\n$$\n\\nabla \\left( \\frac{1}{2}\\|y - A x\\|_{2}^{2} \\right) = A^{\\top}(Ax - y)\n$$\n惩罚项 $\\sum_{g=1}^{G} w_{g} \\|x_{G_{g}}\\|_{2}$ 关于不相交的变量组 $x_{G_g}$ 是可分的。其次微分是每项次微分的笛卡尔积。这使我们能够分别为每个变量块 $x_{G_g}$ 写出最优性条件：\n$$\n0_{|G_g|} \\in [A^{\\top}(Ax - y)]_{G_g} + \\lambda w_g \\partial \\|x_{G_g}\\|_{2}\n$$\n其中 $0_{|G_g|}$ 是适当维度的零向量，$[v]_{G_g}$ 表示向量 $v$ 中对应于组 $G_g$ 索引的子向量。\n\n问题陈述 $A$ 的列在每个组内是标准正交的，并且各组是相互正交的。这意味着，如果 $A_{G_g}$ 是由 $G_g$ 索引的列组成的 $A$ 的子矩阵，则 $A_{G_g}^{\\top}A_{G_h} = \\delta_{gh}I_{|G_g|}$，其中 $\\delta_{gh}$ 是克罗内克 δ，$I$ 是单位矩阵。这个性质极大地简化了梯度项：\n$$\n[A^{\\top}(Ax - y)]_{G_g} = [A^{\\top}Ax]_{G_g} - [A^{\\top}y]_{G_g}\n$$\n项 $[A^{\\top}Ax]_{G_g}$ 变为：\n$$\n[A^{\\top}Ax]_{G_g} = \\sum_{h=1}^{G} (A_{G_g}^{\\top}A_{G_h}) x_{G_h} = (A_{G_g}^{\\top}A_{G_g}) x_{G_g} = I_{|G_g|} x_{G_g} = x_{G_g}\n$$\n项 $[A^{\\top}y]_{G_g}$ 是 $A_{G_g}^{\\top}y$。\n将这些代回分块最优性条件，我们发现问题对每个组是解耦的：\n$$\n0 \\in x_{G_g} - A_{G_g}^{\\top}y + \\lambda w_g \\partial \\|x_{G_g}\\|_{2}\n$$\n我们定义 $z_g \\equiv A_{G_g}^{\\top}y$。条件变为：\n$$\nz_g - x_{G_g} \\in \\lambda w_g \\partial \\|x_{G_g}\\|_{2}\n$$\n为求解 $x_{G_g}$，我们分析欧几里得范数的次微分 $\\partial \\|u\\|_2$：\n- 如果 $u \\neq 0$，$\\partial \\|u\\|_2 = \\{ \\frac{u}{\\|u\\|_2} \\}$。\n- 如果 $u = 0$，$\\partial \\|u\\|_2 = \\{ v \\in \\mathbb{R}^{|G_g|} : \\|v\\|_2 \\leq 1 \\}$。\n\n我们考虑解 $x_{G_g}^\\star$ 的两种情况。\n\n情况 1：组是激活的，即 $x_{G_g}^\\star \\neq 0$。\n次微分是一个单点集，最优性条件是一个方程：\n$$\nz_g - x_{G_g}^\\star = \\lambda w_g \\frac{x_{G_g}^\\star}{\\|x_{G_g}^\\star\\|_2}\n$$\n对 $z_g$ 进行整理：\n$$\nz_g = x_{G_g}^\\star \\left( 1 + \\frac{\\lambda w_g}{\\|x_{G_g}^\\star\\|_2} \\right)\n$$\n这意味着 $x_{G_g}^\\star$ 是 $z_g$ 的一个正标量倍数。对两边取范数：\n$$\n\\|z_g\\|_2 = \\|x_{G_g}^\\star\\|_2 \\left( 1 + \\frac{\\lambda w_g}{\\|x_{G_g}^\\star\\|_2} \\right) = \\|x_{G_g}^\\star\\|_2 + \\lambda w_g\n$$\n这给出了解的范数：$\\|x_{G_g}^\\star\\|_2 = \\|z_g\\|_2 - \\lambda w_g$。为使范数为正，我们必须有 $\\|z_g\\|_2 > \\lambda w_g$。如果此条件成立，我们可以求得 $x_{G_g}^\\star$：\n$$\nx_{G_g}^\\star = z_g \\left( \\frac{\\|x_{G_g}^\\star\\|_2}{\\|z_g\\|_2} \\right) = z_g \\left( \\frac{\\|z_g\\|_2 - \\lambda w_g}{\\|z_g\\|_2} \\right) = \\left( 1 - \\frac{\\lambda w_g}{\\|z_g\\|_2} \\right) z_g\n$$\n\n情况 2：组是非激活的，即 $x_{G_g}^\\star = 0$。\n最优性条件变为一个包含关系：\n$$\nz_g - 0 \\in \\lambda w_g \\{ v : \\|v\\|_2 \\leq 1 \\}\n$$\n这等价于 $\\|z_g\\|_2 \\leq \\lambda w_g$。当此条件成立时，$x_{G_g}^\\star = 0$ 是解。\n\n一个组 $G_g$ 是激活的，如果 $\\|z_g\\|_2 > \\lambda w_g$；是非激活的，如果 $\\|z_g\\|_2 \\le \\lambda w_g$。当 $\\lambda$ 穿过一个临界值 $\\lambda_g^c$ 时，激活集会发生变化，此时一个组在激活和非激活状态之间转换。这恰好发生在 $\\|z_g\\|_2 = \\lambda_g^c w_g$ 时。因此，组 $g$ 的临界值是：\n$$\n\\lambda_g^c = \\frac{\\|z_g\\|_2}{w_g}\n$$\n\n现在我们将这个一般性结果应用于所给的具体实例：\n- 组：$G_{1} = \\{1,2\\}$ 和 $G_{2} = \\{3,4\\}$。\n- 矩阵：$A = I_{4}$，$4 \\times 4$ 单位矩阵。此矩阵满足正交性条件。\n- 权重：$w_{1} = \\frac{3}{2}$ 和 $w_{2} = 1$。\n- 观测向量：$y = \\begin{pmatrix} 3 \\\\ 4 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n\n对于组 $G_1 = \\{1,2\\}$：\n子矩阵 $A_{G_1}$ 由 $I_4$ 的前两列组成。我们计算 $z_1 = A_{G_1}^{\\top}y$：\n$$\nz_1 = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix}\n$$\n范数是 $\\|z_1\\|_2 = \\sqrt{3^2 + 4^2} = \\sqrt{9+16} = \\sqrt{25} = 5$。\n组 1 的临界值是：\n$$\n\\lambda_1^c = \\frac{\\|z_1\\|_2}{w_1} = \\frac{5}{3/2} = \\frac{10}{3}\n$$\n\n对于组 $G_2 = \\{3,4\\}$：\n子矩阵 $A_{G_2}$ 由 $I_4$ 的后两列组成。我们计算 $z_2 = A_{G_2}^{\\top}y$：\n$$\nz_2 = \\begin{pmatrix} 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}\n$$\n范数是 $\\|z_2\\|_2 = \\sqrt{2^2 + 2^2} = \\sqrt{4+4} = \\sqrt{8} = 2\\sqrt{2}$。\n组 2 的临界值是：\n$$\n\\lambda_2^c = \\frac{\\|z_2\\|_2}{w_2} = \\frac{2\\sqrt{2}}{1} = 2\\sqrt{2}\n$$\n\n激活集发生变化的两个临界值 $\\lambda$ 是 $\\lambda_1^c = \\frac{10}{3}$ 和 $\\lambda_2^c = 2\\sqrt{2}$。我们必须按升序报告它们。\n$\\frac{10}{3} \\approx 3.333$\n$2\\sqrt{2} \\approx 2 \\times 1.414 = 2.828$\n因此，$2\\sqrt{2}  \\frac{10}{3}$。\n\n作为 $\\lambda \\ge 0$ 的函数的激活集：\n- 对于 $0 \\le \\lambda  2\\sqrt{2}$：两个组都是激活的。\n- 对于 $2\\sqrt{2} \\le \\lambda  \\frac{10}{3}$：组 2 变为非激活的，组 1 保持激活。\n- 对于 $\\lambda \\ge \\frac{10}{3}$：两个组都是非激活的。\n\n激活集构成发生变化的两个临界值是 $2\\sqrt{2}$ 和 $\\frac{10}{3}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\sqrt{2} \\\\ \\frac{10}{3}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}