{
    "hands_on_practices": [
        {
            "introduction": "核范数最小化问题通常是非光滑的，这使得基于梯度的标准方法难以直接应用。近端算子（proximal operator）是处理这类问题的核心工具。本练习旨在推导核范数的近端算子，我们将看到其解具有一个优美的封闭形式——奇异值阈值（Singular Value Thresholding, SVT）算子，它构成了许多现代低秩矩阵恢复算法的基石。",
            "id": "3458273",
            "problem": "设 $X \\in \\mathbb{R}^{m \\times n}$ 为任意矩阵，其奇异值分解 (singular value decomposition, SVD) 为 $X = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma = \\mathrm{diag}(\\sigma_{1},\\dots,\\sigma_{r})$，其中 $r = \\min\\{m,n\\}$ 且 $\\sigma_{1} \\ge \\cdots \\ge \\sigma_{r} \\ge 0$。考虑对于 $\\tau > 0$ 定义的核范数的邻近算子：\n$$\n\\mathrm{prox}_{\\tau \\|\\cdot\\|_{*}}(X) \\equiv \\arg\\min_{M \\in \\mathbb{R}^{m \\times n}} \\left\\{ \\tau \\|M\\|_{*} + \\frac{1}{2} \\|M - X\\|_{F}^{2} \\right\\},\n$$\n其中 $\\|\\cdot\\|_{*}$ 是核范数，$\\|\\cdot\\|_{F}$ 是 Frobenius 范数。\n\n从核范数、Frobenius 范数和邻近算子的基本定义出发，仅使用关于这些范数的正交不变性和基本谱不等式的熟知事实，推导 $\\mathrm{prox}_{\\tau \\|\\cdot\\|_{*}}(X)$ 关于 $U$、$V$ 和奇异值 $\\{\\sigma_{i}\\}_{i=1}^{r}$ 的闭式表达式。使用应用于奇异值的软阈值算子 $(a)_{+} \\equiv \\max\\{a,0\\}$ 来表示你的最终结果。\n\n以关于 $U$、$V$、$\\{\\sigma_{i}\\}$ 和 $\\tau$ 的单个闭式解析表达式的形式给出你的最终答案。最终答案中不要提供中间步骤。",
            "solution": "所述问题是有效的。这是一个凸优化中的适定问题，具体涉及核范数的邻近算子，这是低秩矩阵恢复中的一个基本概念。所有术语在数学上都有明确定义，并且问题是自洽和一致的。\n\n我们被要求找到以下优化问题的解，该问题定义了核范数 $\\|\\cdot\\|_{*}$ 的邻近算子：\n$$\nM^* = \\mathrm{prox}_{\\tau \\|\\cdot\\|_{*}}(X) = \\arg\\min_{M \\in \\mathbb{R}^{m \\times n}} \\left\\{ \\tau \\|M\\|_{*} + \\frac{1}{2} \\|M - X\\|_{F}^{2} \\right\\}\n$$\n设目标函数为 $F(M) = \\tau \\|M\\|_{*} + \\frac{1}{2} \\|M - X\\|_{F}^{2}$。我们已知 $X$ 的奇异值分解 (SVD) 为 $X = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是一个矩形对角矩阵，其主对角线上的奇异值为 $\\sigma_1 \\ge \\dots \\ge \\sigma_r \\ge 0$，其中 $r = \\min\\{m, n\\}$。\n\n核范数和 Frobenius 范数的一个关键性质是它们在正交变换下的不变性。对于任意矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和任意正交矩阵 $Q_1 \\in \\mathbb{R}^{m \\times m}$ 和 $Q_2 \\in \\mathbb{R}^{n \\times n}$，我们有：\n$$\n\\|Q_1 A Q_2^{\\top}\\|_{*} = \\|A\\|_{*} \\quad \\text{和} \\quad \\|Q_1 A Q_2^{\\top}\\|_{F} = \\|A\\|_{F}\n$$\n我们可以利用这个性质来简化目标函数。首先分析 Frobenius 范数项：\n$$\n\\|M - X\\|_{F}^{2} = \\|M - U \\Sigma V^{\\top}\\|_{F}^{2}\n$$\n由于 $U$ 和 $V$ 是正交的，所以 $U^\\top U = I_m$ 且 $V^\\top V = I_n$。我们可以在范数内的参数左侧乘以 $U^{\\top}$，右侧乘以 $V$，而不会改变范数的值：\n$$\n\\|M - X\\|_{F}^{2} = \\|U^{\\top} (M - U \\Sigma V^{\\top}) V\\|_{F}^{2} = \\|U^{\\top} M V - U^{\\top} U \\Sigma V^{\\top} V\\|_{F}^{2} = \\|U^{\\top} M V - \\Sigma\\|_{F}^{2}\n$$\n现在，我们来考虑核范数项。我们可以应用相同的变换：\n$$\n\\|M\\|_{*} = \\|U (U^{\\top} M V) V^{\\top}\\|_{*} = \\|U^{\\top} M V\\|_{*}\n$$\n我们定义一个新的矩阵变量 $\\tilde{M} = U^{\\top} M V$。由于 $U$ 和 $V$ 是可逆的，映射 $M \\mapsto \\tilde{M}$ 是 $\\mathbb{R}^{m \\times n}$ 上的一个双射。因此，相对于 $M$ 最小化目标函数等价于相对于 $\\tilde{M}$ 最小化其变换后的版本。优化问题变为：\n$$\n\\min_{\\tilde{M} \\in \\mathbb{R}^{m \\times n}} \\left\\{ \\tau \\|\\tilde{M}\\|_{*} + \\frac{1}{2} \\|\\tilde{M} - \\Sigma\\|_{F}^{2} \\right\\}\n$$\n设 $\\tilde{M}$ 的 SVD 为 $\\tilde{M} = P \\tilde{\\Sigma} Q^{\\top}$，其中 $\\tilde{\\Sigma}$ 是一个对角矩阵，奇异值为 $\\tilde{\\sigma}_i$。核范数为 $\\|\\tilde{M}\\|_{*} = \\sum_{i=1}^r \\tilde{\\sigma}_i$。Frobenius 范数项可以展开为：\n$$\n\\|\\tilde{M} - \\Sigma\\|_{F}^{2} = \\langle \\tilde{M} - \\Sigma, \\tilde{M} - \\Sigma \\rangle = \\|\\tilde{M}\\|_{F}^{2} - 2\\langle \\tilde{M}, \\Sigma \\rangle + \\|\\Sigma\\|_{F}^{2}\n$$\n其中 $\\langle A, B \\rangle = \\mathrm{Tr}(A^{\\top} B)$ 是 Frobenius 内积。我们有 $\\|\\tilde{M}\\|_{F}^{2} = \\sum_{i=1}^r \\tilde{\\sigma}_i^2$ 和 $\\|\\Sigma\\|_{F}^{2} = \\sum_{i=1}^r \\sigma_i^2$。内积项是 $\\langle \\tilde{M}, \\Sigma \\rangle = \\mathrm{Tr}(\\tilde{M}^{\\top} \\Sigma)$。\n根据 von Neumann 迹不等式，$\\mathrm{Tr}(A^{\\top} B) \\le \\sum_i \\sigma_i(A) \\sigma_i(B)$。当且仅当 $A$ 和 $B$ 可以被同一对正交矩阵同时对角化时，等号成立。\n$$\n\\langle \\tilde{M}, \\Sigma \\rangle = \\mathrm{Tr}(\\tilde{M}^{\\top} \\Sigma) \\le \\sum_{i=1}^r \\tilde{\\sigma}_i \\sigma_i\n$$\n为了最小化目标函数，我们必须最大化项 $\\langle \\tilde{M}, \\Sigma \\rangle$。当 $\\tilde{M}$ 和 $\\Sigma$ 共享相同的奇异向量时，达到这个最大值。由于 $\\Sigma$ 是对角矩阵，其奇异向量是标准基向量。这意味着最优的 $\\tilde{M}$ 也必须是一个对角矩阵。我们将这个最优对角矩阵表示为 $\\tilde{\\Sigma}_{\\mathrm{opt}} = \\mathrm{diag}(\\tilde{\\sigma}_1, \\dots, \\tilde{\\sigma}_r)$，其中 $\\tilde{\\sigma}_i \\ge 0$ 是待确定的奇异值。\n\n当 $\\tilde{M}$ 是一个对角矩阵 $\\mathrm{diag}(\\tilde{\\sigma}_1, \\dots, \\tilde{\\sigma}_r)$ 时，问题分解为 $r$ 个独立的标量优化问题，每个奇异值对应一个：\n$$\n\\min_{\\tilde{\\sigma}_1, \\dots, \\tilde{\\sigma}_r \\ge 0} \\left\\{ \\tau \\sum_{i=1}^r \\tilde{\\sigma}_i + \\frac{1}{2} \\sum_{i=1}^r (\\tilde{\\sigma}_i - \\sigma_i)^2 \\right\\} = \\sum_{i=1}^r \\min_{\\tilde{\\sigma}_i \\ge 0} \\left\\{ \\tau \\tilde{\\sigma}_i + \\frac{1}{2} (\\tilde{\\sigma}_i - \\sigma_i)^2 \\right\\}\n$$\n对于每个 $i \\in \\{1, \\dots, r\\}$，我们必须求解：\n$$\n\\min_{\\tilde{\\sigma}_i \\ge 0} g(\\tilde{\\sigma}_i) \\quad \\text{其中} \\quad g(\\tilde{\\sigma}_i) = \\tau \\tilde{\\sigma}_i + \\frac{1}{2} (\\tilde{\\sigma}_i - \\sigma_i)^2\n$$\n这是一个带非负约束的简单二次优化问题。首先，我们通过将导数设为零来找到无约束最小值：\n$$\n\\frac{dg}{d\\tilde{\\sigma}_i} = \\tau + (\\tilde{\\sigma}_i - \\sigma_i) = 0 \\implies \\tilde{\\sigma}_i = \\sigma_i - \\tau\n$$\n由于奇异值必须是非负的，我们必须考虑约束 $\\tilde{\\sigma}_i \\ge 0$。\n情况 1：如果 $\\sigma_i - \\tau \\ge 0$，无约束最小化点是非负的，因此是约束问题的解。所以，$\\tilde{\\sigma}_i^* = \\sigma_i - \\tau$。\n情况 2：如果 $\\sigma_i - \\tau  0$，无约束最小化点是负的。函数 $g(\\tilde{\\sigma}_i)$ 是一个开口向上的抛物线，所以在定义域 $[0, \\infty)$ 上，最小值必定出现在边界点 $\\tilde{\\sigma}_i = 0$。所以，$\\tilde{\\sigma}_i^* = 0$。\n\n结合这两种情况，我们得到每个奇异值的解：\n$$\n\\tilde{\\sigma}_i^* = \\max\\{0, \\sigma_i - \\tau\\}\n$$\n这个操作被称为软阈值，并用 $(\\sigma_i - \\tau)_+$ 表示。\n因此，最优矩阵 $\\tilde{M}^*$ 是一个对角矩阵，其对角线元素是 $X$ 的软阈值化奇异值：\n$$\n\\tilde{M}^* = \\mathrm{diag}\\left((\\sigma_1 - \\tau)_+, (\\sigma_2 - \\tau)_+, \\dots, (\\sigma_r - \\tau)_+\\right)\n$$\n为了获得最终解 $M^*$，我们必须使用关系式 $M = U \\tilde{M} V^{\\top}$ 从 $\\tilde{M}$ 坐标变换回原始的 $M$ 坐标：\n$$\nM^* = U \\tilde{M}^* V^{\\top} = U \\ \\mathrm{diag}\\left((\\sigma_1 - \\tau)_+, (\\sigma_2 - \\tau)_+, \\dots, (\\sigma_r - \\tau)_+\\right) \\ V^{\\top}\n$$\n这个表达式为核范数的邻近算子提供了闭式解。它的运算过程是：计算输入矩阵 $X$ 的 SVD，对其奇异值应用软阈值算子，然后重构矩阵。这个过程也称为奇异值阈值（SVT）。",
            "answer": "$$\n\\boxed{U \\ \\mathrm{diag}\\left((\\sigma_1 - \\tau)_+, (\\sigma_2 - \\tau)_+, \\dots, (\\sigma_r - \\tau)_+\\right) \\ V^{\\top}}\n$$"
        },
        {
            "introduction": "掌握了奇异值阈值（SVT）这一基本计算单元后，我们便可以将其应用于构建解决低秩恢复问题的完整算法。交替方向乘子法（ADMM）是一种功能强大且广泛应用的约束优化算法，它能有效地将复杂问题分解为一系列更简单的子问题。在本练习中，你将为典型的核范数最小化问题推导ADMM的迭代更新步骤，并亲手完成一次迭代计算，从而体验如何将SVT算子嵌入到实际的算法流程中。",
            "id": "3458294",
            "problem": "考虑通过带有显式一致性副本的核范数最小化来恢复低秩矩阵的凸优化问题：\n最小化 $\\|Z\\|_{*}$，满足约束 $\\mathcal{A}(X)=b$ 和 $X=Z$，\n其中 $\\|\\cdot\\|_{*}$ 表示核范数，$\\mathcal{A}:\\mathbb{R}^{n\\times n}\\to\\mathbb{R}^{m}$ 是一个线性传感算子，且 $b\\in\\mathbb{R}^{m}$。从等式约束凸问题的拉格朗日函数和增广拉格朗日函数的核心定义以及近端算子的定义出发。利用这些定义，完成以下任务：\n\n1. 通过为一致性约束 $X=Z$ 引入一个矩阵值的拉格朗日乘子和一个参数为 $\\rho0$ 的二次惩罚项，同时将测量约束 $\\mathcal{A}(X)=b$ 表示为一个仿射集上的指示函数，来构建该问题的增广拉格朗日函数。\n\n2. 推导交替方向乘子法 (ADMM; Alternating Direction Method of Multipliers) 对变量 $X$、$Z$ 以及与约束 $X=Z$ 相关联的对偶变量的更新步骤（以其非标度形式）。你的推导必须从第1项中的增广拉格朗日函数开始，并且只使用欧几里得空间中投影的基本性质以及凸函数的近端算子。\n\n3. 将你的更新步骤应用于以下具体实例：\n- 维度 $n=2$。\n- 传感算子 $\\mathcal{A}:\\mathbb{R}^{2\\times 2}\\to\\mathbb{R}^{2}$ 定义为 $\\mathcal{A}(X)=\\begin{bmatrix}X_{11}+X_{22}\\\\ X_{12}\\end{bmatrix}$。\n- 测量值 $b=\\begin{bmatrix}2\\\\ 1\\end{bmatrix}$。\n- 惩罚参数 $\\rho=1$。\n- 初始化 $Z^{0}=0_{2\\times 2}$ 和对偶变量 $Y^{0}=0_{2\\times 2}$。\n\n执行一次完整的ADMM迭代，显式地计算出 $X^{1}$ 和 $Z^{1}$。然后，仅使用这第一次迭代的结果，以精确的闭式形式计算核范数 $\\|Z^{1}\\|_{*}$。\n\n你的最终答案必须是 $\\|Z^{1}\\|_{*}$ 的唯一精确表达式（无数值四舍五入）。不需要单位。",
            "solution": "该问题是有效的，因为它在凸优化领域，特别是低秩矩阵恢复方面有科学依据。它适定、客观，并包含得出唯一解所需的所有信息。\n\n该优化问题可以写成一致性形式：\n$$\n\\text{minimize} \\quad f(X) + g(Z) \\quad \\text{subject to} \\quad X - Z = 0\n$$\n其中 $f(X) = \\mathcal{I}_{\\mathcal{C}}(X)$ 是仿射集 $\\mathcal{C} = \\{X \\in \\mathbb{R}^{n \\times n} \\mid \\mathcal{A}(X) = b\\}$ 的指示函数，而 $g(Z) = \\|Z\\|_{*}$ 是 $Z$ 的核范数。\n\n**1. 增广拉格朗日函数的构建**\n\n该等式约束问题的标准拉格朗日函数是：\n$$\nL(X, Z, Y) = f(X) + g(Z) + \\langle Y, X - Z \\rangle\n$$\n其中 Y 是拉格朗日乘子矩阵（对偶变量），$\\langle A, B \\rangle = \\text{tr}(A^T B)$ 表示弗罗贝尼乌斯内积。\n\n增广拉格朗日函数是通过为约束违反添加一个二次惩罚项来形成的：\n$$\nL_{\\rho}(X, Z, Y) = f(X) + g(Z) + \\langle Y, X - Z \\rangle + \\frac{\\rho}{2}\\|X - Z\\|_F^2\n$$\n其中 $\\rho  0$ 是惩罚参数，$\\|\\cdot\\|_F$ 是弗罗贝尼乌斯范数。代入 $f(X)$ 和 $g(Z)$ 的定义，我们得到：\n$$\nL_{\\rho}(X, Z, Y) = \\mathcal{I}_{\\mathcal{C}}(X) + \\|Z\\|_{*} + \\langle Y, X - Z \\rangle + \\frac{\\rho}{2}\\|X - Z\\|_F^2\n$$\n\n**2. ADMM 更新步骤的推导**\n\n交替方向乘子法 (ADMM) 是一种迭代算法，它依次针对每个原始变量最小化增广拉格朗日函数，然后更新对偶变量。\n\n**$X$-更新：** 在第 $k+1$ 次迭代中，我们通过最小化 $L_{\\rho}(X, Z^k, Y^k)$ 来更新 $X$：\n$$\nX^{k+1} = \\arg\\min_{X} L_{\\rho}(X, Z^k, Y^k) = \\arg\\min_{X} \\left( \\mathcal{I}_{\\mathcal{C}}(X) + \\langle Y^k, X - Z^k \\rangle + \\frac{\\rho}{2}\\|X - Z^k\\|_F^2 \\right)\n$$\n我们忽略不依赖于 $X$ 的项。最小化是在满足 $\\mathcal{A}(X)=b$ 的 $X$ 上进行的。需要最小化的表达式变为：\n$$\n\\langle Y^k, X \\rangle + \\frac{\\rho}{2}\\|X - Z^k\\|_F^2 = \\frac{\\rho}{2} \\left( \\frac{2}{\\rho}\\langle Y^k, X \\rangle + \\|X\\|_F^2 - 2\\langle X, Z^k \\rangle + \\|Z^k\\|_F^2 \\right)\n$$\n对包含 $X$ 的项进行配方：\n$$\n\\frac{\\rho}{2} \\left( \\|X\\|_F^2 - 2\\langle X, Z^k - \\frac{1}{\\rho}Y^k \\rangle + \\text{const} \\right) = \\frac{\\rho}{2} \\|X - (Z^k - \\frac{1}{\\rho}Y^k)\\|_F^2 + \\text{const}\n$$\n因此，$X$ 的最小化问题等价于找到矩阵 $Z^k - \\frac{1}{\\rho}Y^k$ 在仿射集 $\\mathcal{C}$ 上的欧几里得投影：\n$$\nX^{k+1} = \\arg\\min_{X} \\left( \\mathcal{I}_{\\mathcal{C}}(X) + \\frac{\\rho}{2} \\|X - (Z^k - \\frac{1}{\\rho}Y^k)\\|_F^2 \\right) = \\mathcal{P}_{\\mathcal{C}}\\left(Z^k - \\frac{1}{\\rho}Y^k\\right)\n$$\n\n**$Z$-更新：** 接下来，我们通过最小化 $L_{\\rho}(X^{k+1}, Z, Y^k)$ 来更新 $Z$：\n$$\nZ^{k+1} = \\arg\\min_{Z} L_{\\rho}(X^{k+1}, Z, Y^k) = \\arg\\min_{Z} \\left( \\|Z\\|_{*} + \\langle Y^k, X^{k+1} - Z \\rangle + \\frac{\\rho}{2}\\|X^{k+1} - Z\\|_F^2 \\right)\n$$\n类似地，我们对包含 $Z$ 的项进行配方：\n$$\n\\|Z\\|_{*} - \\langle Y^k, Z \\rangle + \\frac{\\rho}{2}\\|X^{k+1} - Z\\|_F^2 = \\|Z\\|_{*} + \\frac{\\rho}{2} \\left( \\|Z\\|_F^2 - 2\\langle Z, X^{k+1} + \\frac{1}{\\rho}Y^k \\rangle + \\text{const} \\right)\n$$\n$$\n= \\|Z\\|_{*} + \\frac{\\rho}{2} \\|Z - (X^{k+1} + \\frac{1}{\\rho}Y^k)\\|_F^2 + \\text{const}\n$$\n$Z$ 的最小化问题是：\n$$\nZ^{k+1} = \\arg\\min_{Z} \\left( \\|Z\\|_{*} + \\frac{\\rho}{2} \\|Z - (X^{k+1} + \\frac{1}{\\rho}Y^k)\\|_F^2 \\right)\n$$\n这对应于函数 $\\frac{1}{\\rho}\\|\\cdot\\|_{*}$ 的近端算子的定义。具体来说，它是阈值为 $\\lambda = 1/\\rho$ 的奇异值阈值 (SVT) 算子：\n$$\nZ^{k+1} = \\text{prox}_{\\frac{1}{\\rho}\\|\\cdot\\|_{*}}\\left(X^{k+1} + \\frac{1}{\\rho}Y^k\\right) = \\text{SVT}_{1/\\rho}\\left(X^{k+1} + \\frac{1}{\\rho}Y^k\\right)\n$$\nSVT 算子作用于一个矩阵 $M$，通过计算其奇异值分解 (SVD)，$M = U\\Sigma V^T$，对奇异值进行软阈值处理，$\\hat{\\Sigma}_{ii} = \\max(0, \\Sigma_{ii} - \\lambda)$，然后重构矩阵，$\\text{SVT}_{\\lambda}(M) = U\\hat{\\Sigma}V^T$。\n\n**$Y$-更新：** 最后，使用对偶问题上的梯度上升步骤来更新对偶变量：\n$$\nY^{k+1} = Y^k + \\rho(X^{k+1} - Z^{k+1})\n$$\n\n**3. 具体实例与第一次迭代**\n\n给定：\n- $n=2$\n- $\\mathcal{A}(X) = \\begin{bmatrix} X_{11}+X_{22} \\\\ X_{12} \\end{bmatrix}$ （即，迹和 (1,2) 元素）\n- $b = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$\n- $\\rho = 1$\n- $Z^0 = 0_{2\\times 2}$ （零矩阵）\n- $Y^0 = 0_{2\\times 2}$\n\n我们执行第一次迭代 ($k=0$)：\n\n**计算 $X^1$**：\n$$\nX^1 = \\mathcal{P}_{\\mathcal{C}}\\left(Z^0 - \\frac{1}{\\rho}Y^0\\right) = \\mathcal{P}_{\\mathcal{C}}\\left(0_{2\\times 2} - \\frac{1}{1}0_{2\\times 2}\\right) = \\mathcal{P}_{\\mathcal{C}}(0_{2\\times 2})\n$$\n我们需要找到矩阵 $X \\in \\mathbb{R}^{2\\times 2}$，使其在满足约束 $\\text{tr}(X) = X_{11}+X_{22}=2$ 和 $X_{12}=1$ 的条件下最小化 $\\|X-0_{2\\times 2}\\|_F^2 = \\|X\\|_F^2$。\n$$\n\\|X\\|_F^2 = X_{11}^2 + X_{12}^2 + X_{21}^2 + X_{22}^2\n$$\n代入 $X_{12}=1$，我们在约束 $X_{11}+X_{22}=2$ 下最小化 $X_{11}^2 + 1^2 + X_{21}^2 + X_{22}^2$。\n为了最小化该表达式，我们必须有 $X_{21}=0$。问题简化为在约束 $X_{11}+X_{22}=2$ 下最小化 $X_{11}^2 + X_{22}^2$。使用代换 $X_{22}=2-X_{11}$，我们最小化 $h(X_{11}) = X_{11}^2 + (2-X_{11})^2$。对 $X_{11}$ 求导并设为零得到 $2X_{11} - 2(2-X_{11}) = 4X_{11}-4 = 0$，因此 $X_{11}=1$。这意味着 $X_{22}=2-1=1$。\n因此，得到的矩阵是：\n$$\nX^1 = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}\n$$\n\n**计算 $Z^1$**：\n$$\nZ^1 = \\text{SVT}_{1/\\rho}\\left(X^1 + \\frac{1}{\\rho}Y^0\\right) = \\text{SVT}_{1}\\left(X^1 + \\frac{1}{1}0_{2\\times 2}\\right) = \\text{SVT}_{1}(X^1)\n$$\n我们需要 $X^1 = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$ 的 SVD。奇异值 $\\sigma_i$ 是 $X^{1T}X^1$ 的特征值的平方根。\n$$\nX^{1T}X^1 = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  2 \\end{pmatrix}\n$$\n特征方程为 $\\det(X^{1T}X^1 - \\lambda I) = (1-\\lambda)(2-\\lambda) - 1 = \\lambda^2 - 3\\lambda + 1 = 0$。\n特征值为 $\\lambda = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$。\n$X^1$ 的奇异值为：\n$$\n\\sigma_1 = \\sqrt{\\frac{3+\\sqrt{5}}{2}} = \\frac{1+\\sqrt{5}}{2} \\quad (\\approx 1.618)\n$$\n$$\n\\sigma_2 = \\sqrt{\\frac{3-\\sqrt{5}}{2}} = \\frac{\\sqrt{5}-1}{2} \\quad (\\approx 0.618)\n$$\n我们应用阈值为 $\\lambda=1$ 的软阈值处理：\n$$\n\\hat{\\sigma}_1 = \\max(0, \\sigma_1 - 1) = \\frac{1+\\sqrt{5}}{2} - 1 = \\frac{\\sqrt{5}-1}{2}\n$$\n$$\n\\hat{\\sigma}_2 = \\max(0, \\sigma_2 - 1) = \\max\\left(0, \\frac{\\sqrt{5}-1}{2} - 1\\right) = \\max\\left(0, \\frac{\\sqrt{5}-3}{2}\\right) = 0\n$$\n$Z^1$ 的奇异值为 $\\hat{\\sigma}_1 = \\frac{\\sqrt{5}-1}{2}$ 和 $\\hat{\\sigma}_2=0$。\n为了显式计算 $Z^1$，我们需要用新的奇异值从其 SVD 重构矩阵。然而，为了求出核范数 $\\|Z^1\\|_{*}$，我们只需要将其奇异值求和。\n\n**计算 $\\|Z^1\\|_{*}$**：\n核范数是奇异值之和。\n$$\n\\|Z^1\\|_{*} = \\hat{\\sigma}_1 + \\hat{\\sigma}_2 = \\frac{\\sqrt{5}-1}{2} + 0 = \\frac{\\sqrt{5}-1}{2}\n$$\n为完整起见，$Z^1$ 的显式形式是 $Z^1 = \\frac{5-\\sqrt{5}}{10} \\begin{pmatrix} 1  \\frac{1+\\sqrt{5}}{2} \\\\ \\frac{\\sqrt{5}-1}{2}  1 \\end{pmatrix}$。它的秩是 $1$，其唯一的非零奇异值确实是 $\\frac{\\sqrt{5}-1}{2}$。",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{5}-1}{2}}\n$$"
        },
        {
            "introduction": "尽管核范数最小化是一个强大的工具，但它的成功并非无条件的，其恢复性能很大程度上依赖于待恢复矩阵的内在结构。本练习将通过一个经典的反例来揭示“非相干性”（incoherence）这一关键假设的重要性。你将分析一个高度“尖峰化”的矩阵，并证明当采样数量不足时，即使理论上采样率满足一般要求，恢复仍会失败，从而深刻理解为何非相干性是矩阵补全理论的支柱之一。",
            "id": "3458274",
            "problem": "考虑一个秩为 $r$ 的未知矩阵 $M^{\\star} \\in \\mathbb{R}^{n_{1} \\times n_{2}}$ 的矩阵补全问题，其中从 $[n_{1}] \\times [n_{2}]$ 中无放回地均匀随机观测到一组包含 $m$ 个条目的集合 $\\Omega$。恢复方法是核范数最小化 (NNM)，其寻求\n$$\n\\min_{X \\in \\mathbb{R}^{n_{1} \\times n_{2}}} \\|X\\|_{*} \\quad \\text{subject to} \\quad \\mathcal{P}_{\\Omega}(X) = \\mathcal{P}_{\\Omega}(M^{\\star}),\n$$\n其中 $\\|X\\|_{*}$ 表示核范数，定义为 $X$ 的奇异值之和，$\\mathcal{P}_{\\Omega}$ 是采样算子，它保留由 $\\Omega$ 索引的条目并将所有其他条目置零。设 $M^{\\star}$ 的奇异值分解 (SVD) 为 $M^{\\star} = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{n_{1} \\times r}$，$V \\in \\mathbb{R}^{n_{2} \\times r}$，以及 $\\Sigma \\in \\mathbb{R}^{r \\times r}$。一个标准的非相干性条件要求奇异向量是分散的，例如通过\n$$\n\\max_{i \\in [n_{1}]} \\|U^{\\top} e_{i}\\|_{2}^{2} \\leq \\frac{\\mu r}{n_{1}}, \\qquad \\max_{j \\in [n_{2}]} \\|V^{\\top} e_{j}\\|_{2}^{2} \\leq \\frac{\\mu r}{n_{2}},\n$$\n来满足，其中 $\\mu$ 是一个适度的非相干性参数，$e_{i}$ 和 $e_{j}$ 表示标准基向量。\n\n构造秩为 $1$ 的矩阵\n$$\nM^{\\star} = \\alpha \\, e_{1} e_{1}^{\\top},\n$$\n其中 $\\alpha  0$，该矩阵违反了非相干性条件，因为其奇异向量是最大程度集中的。假设采样预算按以下方式扩展\n$$\nm = C \\, r \\, (n_{1} + n_{2}) \\, \\ln(n_{1} + n_{2}),\n$$\n其中 $C  0$ 是一个固定常数，$\\ln(\\cdot)$ 是自然对数。在无放回均匀采样模型和精确（无噪声）观测下：\n\n- 从上述定义出发，解释当条目 $(1,1)$ 未包含在 $\\Omega$ 中时，NNM 恢复 $M^{\\star}$ 失败的机制。\n- 推导失败的确切概率（即 NNM 返回一个与 $M^{\\star}$ 不同的解的概率），该概率是 $n_{1}$、$n_{2}$ 和 $m$ 的函数。\n\n最后，将给定 $m$ 的扩展公式中 $r=1$ 代入您的表达式，并以 $n_{1}$、$n_{2}$、$C$ 和自然对数的形式提供失败概率的单一闭式解析表达式。您的最终答案必须是单一的解析表达式。不需要四舍五入，也不涉及单位。",
            "solution": "问题陈述需经过验证。\n\n**第 1 步：提取已知条件**\n- 未知矩阵：$M^{\\star} \\in \\mathbb{R}^{n_{1} \\times n_{2}}$，秩为 $r$。\n- 恢复方法：核范数最小化 (NNM)，$\\min_{X} \\|X\\|_{*} \\text{ s.t. } \\mathcal{P}_{\\Omega}(X) = \\mathcal{P}_{\\Omega}(M^{\\star})$。\n- 采样：集合 $\\Omega$ 包含从 $[n_1] \\times [n_2]$ 中无放回地均匀随机采样的 $m$ 个条目。\n- 特定矩阵：$M^{\\star} = \\alpha \\, e_{1} e_{1}^{\\top}$，其中 $\\alpha  0$。这意味着 $M^{\\star}$ 只有一个非零条目，$M^{\\star}_{11} = \\alpha$。秩为 $r=1$。\n- 采样预算：$m = C \\, r \\, (n_{1} + n_{2}) \\, \\ln(n_{1} + n_{2})$，对于某个常数 $C  0$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- 该问题在科学上是有根据的，是在低秩矩阵恢复的标准数学理论框架内提出的。\n- 该问题是良构的，所有术语和条件在该领域都是标准的且定义清晰。对于矩形矩阵，记号 $M^{\\star} = \\alpha e_1 e_1^{\\top}$ 是一种常见且明确的简写，表示只有一个条目 $(1,1)$ 为非零的矩阵。\n- 问题是客观的，不含非形式化主张。\n- 所提供的设置是自洽且一致的。该问题突出了 NNM 对于违反非相干性条件的矩阵的一个已知失效模式，而非相干性条件是该理论中的一个关键概念。\n\n**第 3 步：结论与行动**\n问题有效。详细解答如下。\n\n该问题要求解释核范数最小化 (NNM) 对于一个特定秩-1矩阵的失败机制，推导失败概率，并根据给定的样本量扩展公式给出该概率的最终表达式。\n\n所讨论的矩阵是 $M^{\\star} = \\alpha \\, e_{1} e_{1}^{\\top}$，其中 $\\alpha  0$。这是一个在 $\\mathbb{R}^{n_{1} \\times n_{2}}$ 中的矩阵，只有一个非零条目：$M^{\\star}_{11} = \\alpha$，而对于所有 $(i,j) \\neq (1,1)$，$M^{\\star}_{ij} = 0$。该矩阵的秩为 $r=1$，其唯一的非零奇异值为 $\\alpha$。其核范数为 $\\|M^{\\star}\\|_{*} = \\alpha$。\n\n我们根据唯一的非零条目 $(1,1)$ 是否被观测到来分析 NNM 的恢复情况。\n\n**情况 1：条目 $(1,1)$ 未被观测，即 $(1,1) \\notin \\Omega$。**\n\n这是发生失败的情景。NNM 问题是\n$$ \\min_{X \\in \\mathbb{R}^{n_{1} \\times n_{2}}} \\|X\\|_{*} \\quad \\text{subject to} \\quad \\mathcal{P}_{\\Omega}(X) = \\mathcal{P}_{\\Omega}(M^{\\star}). $$\n由于 $(1,1) \\notin \\Omega$，由 $\\Omega$ 索引的 $M^{\\star}$ 的每个条目都为零。因此，$\\mathcal{P}_{\\Omega}(M^{\\star})$ 是零矩阵。约束条件简化为 $\\mathcal{P}_{\\Omega}(X) = \\mathbf{0}$，这意味着对于所有 $(i,j) \\in \\Omega$，$X_{ij} = 0$。\n\n优化问题变为：\n$$ \\min_{X \\in \\mathbb{R}^{n_{1} \\times n_{2}}} \\|X\\|_{*} \\quad \\text{subject to} \\quad X_{ij} = 0 \\text{ for all } (i,j) \\in \\Omega. $$\n考虑候选解 $X = \\mathbf{0}$（零矩阵）。它显然满足约束条件，因为其所有条目都为 $0$。零矩阵的核范数是 $\\|\\mathbf{0}\\|_{*} = 0$。\n\n任何矩阵 $X$ 的核范数是其奇异值之和，奇异值是非负的。因此，对于所有 $X$，$ \\|X\\|_{*} \\ge 0$。零矩阵达到了绝对最小的可能核范数。由于它是一个可行解，它必定是该问题的最小值点。由于任何非零矩阵的核范数都严格为正，零矩阵是唯一的解。\n\n因此，如果 $(1,1) \\notin \\Omega$，NNM 算法返回 $X = \\mathbf{0}$。由于 $M^{\\star} \\ne \\mathbf{0}$，恢复失败。失败的机制是，在没有观测到唯一非零条目的情况下，优化问题没有关于真实矩阵的任何信息，因此默认选择具有最小可能核范数的平凡解。\n\n**情况 2：条目 $(1,1)$ 被观测，即 $(1,1) \\in \\Omega$。**\n\n在这种情况下，我们将证明恢复是成功的。约束条件是 $\\mathcal{P}_{\\Omega}(X) = \\mathcal{P}_{\\Omega}(M^{\\star})$。这意味着：\n$$ X_{11} = M^{\\star}_{11} = \\alpha $$\n$$ X_{ij} = M^{\\star}_{ij} = 0 \\quad \\text{for all } (i,j) \\in \\Omega \\setminus \\{(1,1)\\}. $$\n真实矩阵 $M^{\\star}$ 是该问题的一个可行解。其目标函数的值是 $\\|M^{\\star}\\|_{*} = \\alpha$。\n\n设 $X$ 是任意可行解。我们必须有 $X_{11} = \\alpha$。我们可以建立其核范数的下界。核范数是算子范数的对偶范数，即 $\\|X\\|_{*} = \\sup_{\\|Z\\|_{2} \\le 1} \\langle X, Z \\rangle$。我们选择测试矩阵 $Z = e_1 e_1^{\\top}$，其中 $e_1 \\in \\mathbb{R}^{n_1}$ 和 $e_1 \\in \\mathbb{R}^{n_2}$ 是标准基向量。这个秩-1矩阵的算子范数是 $\\|e_1 e_1^{\\top}\\|_2 = 1$。使用这个 $Z$ 提供了一个下界：\n$$ \\|X\\|_{*} \\ge \\langle X, e_1 e_1^{\\top} \\rangle = \\mathrm{Tr}(X^{\\top}e_1 e_1^{\\top}) = (X^{\\top})_{11} = X_{11}. $$\n因为任何可行解 $X$ 都必须满足 $X_{11} = \\alpha$，我们有 $\\|X\\|_{*} \\ge \\alpha$。\n\n这表明对于任何可行点，目标函数的最小可能值是 $\\alpha$。真实矩阵 $M^{\\star}$ 是一个可行点，并且达到了这个最小值，所以它是 NNM 问题的一个解。可以进一步证明 $M^{\\star}$ 是唯一的解。因此，当且仅当条目 $(1,1)$ 被观测到时，恢复是成功的。\n\n**失败概率**\n\n根据以上分析，NNM 失败当且仅当 $(1,1) \\notin \\Omega$。我们需要计算这个事件的概率。采样是均匀且无放回的。\n- 矩阵中的总条目数：$N = n_1 n_2$。\n- 采样的条目数：$m$。\n选择 $m$ 个条目的集合 $\\Omega$ 的总方式数是 $\\binom{n_1 n_2}{m}$。\n要发生失败，集合 $\\Omega$ 必须从不包括 $(1,1)$ 的 $n_1 n_2 - 1$ 个条目中选择。这样做的总方式数是 $\\binom{n_1 n_2 - 1}{m}$。\n\n失败的概率是这个比率：\n$$ P(\\text{失败}) = P((1,1) \\notin \\Omega) = \\frac{\\binom{n_1 n_2 - 1}{m}}{\\binom{n_1 n_2}{m}}. $$\n我们简化这个表达式：\n$$ \\frac{\\binom{n_1 n_2 - 1}{m}}{\\binom{n_1 n_2}{m}} = \\frac{\\frac{(n_1 n_2 - 1)!}{m!(n_1 n_2 - 1 - m)!}}{\\frac{(n_1 n_2)!}{m!(n_1 n_2 - m)!}} = \\frac{(n_1 n_2 - 1)!}{(n_1 n_2)!} \\cdot \\frac{(n_1 n_2 - m)!}{(n_1 n_2 - 1 - m)!} $$\n$$ = \\frac{1}{n_1 n_2} \\cdot (n_1 n_2 - m) = \\frac{n_1 n_2 - m}{n_1 n_2} = 1 - \\frac{m}{n_1 n_2}. $$\n\n**最终表达式**\n\n最后，我们代入给定的样本量 $m$ 的扩展公式。我们矩阵的秩是 $r=1$。\n$$ m = C \\, r \\, (n_{1} + n_{2}) \\, \\ln(n_{1} + n_{2}) \\quad \\xrightarrow{r=1} \\quad m = C (n_{1} + n_{2}) \\ln(n_{1} + n_{2}). $$\n将这个 $m$ 的表达式代入我们的失败概率公式，得到最终结果：\n$$ P(\\text{失败}) = 1 - \\frac{C (n_{1} + n_{2}) \\ln(n_{1} + n_{2})}{n_{1} n_{2}}. $$\n这是以 $n_1$、$n_2$ 和 $C$ 表示的失败概率的闭式解析表达式。",
            "answer": "$$\n\\boxed{1 - \\frac{C (n_{1} + n_{2}) \\ln(n_{1} + n_{2})}{n_{1} n_{2}}}\n$$"
        }
    ]
}