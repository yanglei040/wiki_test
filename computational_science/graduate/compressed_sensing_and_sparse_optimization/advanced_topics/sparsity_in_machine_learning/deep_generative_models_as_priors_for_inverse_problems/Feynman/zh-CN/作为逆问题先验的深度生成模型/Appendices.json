{
    "hands_on_practices": [
        {
            "introduction": "在将生成模型用作逆问题先验时，第一步是构建一个恰当的目标函数。这个目标函数通常由两部分组成：确保解与测量数据一致的数据保真项，以及确保解符合先验模型的正则化项。这个练习将通过从最大似然估计（MLE）的基本原理出发，展示如何针对不同的噪声假设（高斯噪声与拉普拉斯噪声）推导出相应的数据保真项，从而将概率建模与优化目标直接联系起来。",
            "id": "3442929",
            "problem": "考虑一个带有深度生成先验的线性逆问题。设未知信号被约束在生成器 $G$ 的值域内，具体而言，$x = G(z) \\in \\mathbb{R}^{n}$，其中潜在编码 $z \\in \\mathbb{R}$ 是一维的，生成器是线性的 $G(z) = b z$，且 $b \\in \\mathbb{R}^{n}$ 是固定的已知向量。通过已知的正向算子 $A \\in \\mathbb{R}^{m \\times n}$ 获得测量值，得到 $y = A x + \\varepsilon \\in \\mathbb{R}^{m}$，其中 $\\varepsilon$ 是随机测量噪声模型。假设潜在编码 $z$ 是唯一的未知量（即，除了约束 $x \\in \\mathrm{range}(G)$ 外，对 $z$ 没有显式的先验分布），我们寻求在给定观测值 $y$ 的情况下 $z$ 的最大似然估计 (MLE)。\n\n从两种不同噪声模型下似然函数 $p(y \\mid x)$ 的基本定义出发，推导相应的负对数似然（数据保真）项作为 $z$ 的函数（忽略不依赖于 $z$ 的加性常数），以及相应的关于 $z$ 的最大似然估计问题：\n- 独立同分布 (i.i.d.) 高斯噪声：$\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2} I)$。\n- 独立同分布 (i.i.d.) 拉普拉斯噪声，尺度为 $\\beta$：$\\varepsilon$ 的每个分量的密度为 $(2 \\beta)^{-1} \\exp(-|e|/\\beta)$。\n\n然后，使用 $m = 4$ 和 $n = 3$ 的具体数值实例，\n- $$A = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 1  1  0 \\\\ 2  0  1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix}, \\quad y = \\begin{pmatrix} 5 \\\\ 7 \\\\ 9 \\\\ 6 \\end{pmatrix},$$\n执行以下操作：\n- 用 $A$、$b$ 和 $y$ 表示高斯噪声下 $z$ 的最大似然估计的闭式解，并对给定的 $A$、$b$ 和 $y$ 进行数值计算。\n- 将拉普拉斯噪声下 $z$ 的最大似然估计表示为一个单变量凸优化问题的解，并使用次微分对其进行刻画。然后对给定的 $A$、$b$ 和 $y$进行显式计算。\n\n最后，计算高斯噪声 MLE 和拉普拉斯噪声 MLE 之间的差值，\n$$z_{\\mathrm{G}} - z_{\\mathrm{L}},$$\n并将此最终量报告为一个简化的精确分数。不要四舍五入。不需要单位。",
            "solution": "*   从问题验证步骤开始。列出已知条件。声明这是一个有效的问题。\n*   进入求解过程。\n*   **一般推导**：\n    *   定义带有生成先验的测量模型：$y = A(bz) + \\varepsilon = (Ab)z + \\varepsilon$。\n    *   引入 $v = Ab$。\n    *   **高斯情况**：推导似然函数 $p(y|z)$、负对数似然 $\\mathcal{L}_G(z)$，并陈述由此产生的优化问题 $\\min_z \\|y - vz\\|_2^2$。\n    *   **拉普拉斯情况**：推导似然函数 $p(y|z)$、负对数似然 $\\mathcal{L}_L(z)$，并陈述由此产生的优化问题 $\\min_z \\|y - vz\\|_1$。\n*   **具体求解**：\n    *   使用给定的 $A$ 和 $b$ 的数值计算向量 $v = Ab$。\n    *   **高斯 MLE, $z_G$**：\n        *   陈述目标函数 $f_G(z) = \\|y - vz\\|_2^2$。\n        *   通过将导数设为零来找到其最小值。展示闭式解 $z_G = \\frac{v^T y}{v^T v}$。\n        *   计算 $v^T y$ 和 $v^T v$。\n        *   计算 $z_G$。\n    *   **拉普拉斯 MLE, $z_L$**：\n        *   陈述目标函数 $f_L(z) = \\|y - vz\\|_1$。\n        *   解释这是一个单变量凸优化问题，具体来说是一个加权中位数问题。\n        *   使用次微分来刻画解。最小化子 $z_L$ 必须满足 $0 \\in \\partial f_L(z_L)$。\n        *   写出次微分：$\\partial f_L(z) = \\sum_{i=1}^m \\partial|y_i - v_i z| = \\sum_{i=1}^m -v_i \\cdot \\partial|z - y_i/v_i|$。\n        *   最优性条件是 $0 \\in \\sum_{i=1}^m -v_i \\text{sign}(y_i - v_i z_L)$。\n        *   识别“节点” $z_i^* = y_i / v_i$ 和权重 $w_i = |v_i|$。\n        *   找到带有权重 $\\{w_i\\}$ 的节点 $\\{z_i^*\\}$ 的加权中位数。这就得到了 $z_L$。\n        *   通过检查次微分条件区间来确认解。\n*   **最终计算**：\n    *   计算差值 $z_G - z_L$。\n    *   展示获得最终分数的算术过程。",
            "answer": "$$\n\\boxed{\\frac{11}{93}}\n$$"
        },
        {
            "introduction": "虽然深度生成模型提供了强大的先验，但将解限制在一个低维流形上会带来固有的统计权衡。这个练习通过一个简化的线性子空间模型，揭示了偏差-方差权衡这一基本概念。通过从第一性原理推导，您将量化模型失配（偏差）和测量噪声（方差）对重建误差的贡献，从而深刻理解模型复杂性选择的核心挑战。",
            "id": "3442952",
            "problem": "考虑一个深度生成模型先验，它由一个确定性映射 $G : \\mathbb{R}^{k} \\to \\mathbb{R}^{n}$ 表示，其像为集合 $S = \\mathrm{Range}(G) \\subset \\mathbb{R}^{n}$，维度为 $k$。您在去噪设定下观测到带噪测量值 $y = x^{\\star} + w$，其中未知的真实信号为 $x^{\\star} \\in \\mathbb{R}^{n}$，噪声 $w \\sim \\mathcal{N}(0, \\sigma^{2} I_{n})$ 是一个零均值高斯分布，其协方差为 $\\sigma^{2} I_{n}$，且与 $x^{\\star}$ 独立。您通过选择最小距离估计量 $x^{\\wedge} = \\arg\\min_{x \\in S} \\|x - y\\|_{2}^{2}$ 将重建约束在 $S$ 上，这等同于正交投影 $x^{\\wedge} = P_{S} y$，其中 $P_{S}$ 是到 $S$ 上的正交投影算子。\n\n假设真实信号并不完全在 $S$ 中，并且可以分解为 $x^{\\star} = G(z^{\\star}) + x_{\\perp}$，其中 $G(z^{\\star}) \\in S$ 且 $x_{\\perp} \\in S^{\\perp}$。$x_{\\perp}$ 与 $w$ 独立，其分布为 $x_{\\perp} \\sim \\mathcal{N}(0, \\tau^{2} I_{n-k})$，支撑在 $n-k$ 维的正交补空间 $S^{\\perp}$ 上。仅使用正交投影、高斯期望和均方误差定义的基本性质，从第一性原理推导当约束到 $S$ 上时偏差-方差权衡是如何产生的，并计算在 $w$ 和 $x_{\\perp}$ 的联合随机性下，期望平方重建误差 $\\mathbb{E}\\big[\\|x^{\\wedge} - x^{\\star}\\|_{2}^{2}\\big]$。\n\n请以 $n$、$k$、$\\sigma$ 和 $\\tau$ 的单个闭式解析表达式形式提供您的最终答案。无需进行四舍五入。",
            "solution": "该问题已经过验证，被认为是有效的。我们现在开始对期望平方重建误差进行形式化推导。\n\n我们的目标是计算均方误差 (MSE)，其定义为 $\\mathbb{E}\\big[\\|x^{\\wedge} - x^{\\star}\\|_{2}^{2}\\big]$。该期望是针对噪声 $w$ 和子空间外分量 $x_{\\perp}$ 的联合分布计算的。\n\n估计量 $x^{\\wedge}$ 是测量值 $y$ 在信号子空间 $S$ 上的正交投影：\n$$x^{\\wedge} = P_{S} y$$\n给定测量模型为 $y = x^{\\star} + w$。将此代入 $x^{\\wedge}$ 的表达式中，得到：\n$$x^{\\wedge} = P_{S}(x^{\\star} + w)$$\n真实信号 $x^{\\star}$ 被分解为一个在 $S$ 中的分量和一个在其正交补空间 $S^{\\perp}$ 中的分量：$x^{\\star} = x_{\\parallel} + x_{\\perp}$，其中为了记法清晰，我们定义 $x_{\\parallel} = G(z^{\\star}) \\in S$ 且 $x_{\\perp} \\in S^{\\perp}$。代入此分解得到：\n$$x^{\\wedge} = P_{S}(x_{\\parallel} + x_{\\perp} + w)$$\n根据投影算子 $P_{S}$ 的线性性质，我们有：\n$$x^{\\wedge} = P_{S}x_{\\parallel} + P_{S}x_{\\perp} + P_{S}w$$\n现在我们使用正交投影的基本性质。由于 $x_{\\parallel}$ 在 $S$ 中，它在 $S$ 上的投影是其自身，即 $P_{S}x_{\\parallel} = x_{\\parallel}$。由于 $x_{\\perp}$ 在正交补空间 $S^{\\perp}$ 中，它在 $S$ 上的投影是零向量，即 $P_{S}x_{\\perp} = 0$。这将估计量的表达式简化为：\n$$x^{\\wedge} = x_{\\parallel} + P_{S}w$$\n现在我们构建重建误差向量 $x^{\\wedge} - x^{\\star}$：\n$$x^{\\wedge} - x^{\\star} = (x_{\\parallel} + P_{S}w) - (x_{\\parallel} + x_{\\perp}) = P_{S}w - x_{\\perp}$$\n平方重建误差是该向量的欧几里得范数的平方：\n$$\\|x^{\\wedge} - x^{\\star}\\|_{2}^{2} = \\|P_{S}w - x_{\\perp}\\|_{2}^{2}$$\n根据投影算子的定义，向量 $P_{S}w$ 位于子空间 $S$ 中。向量 $x_{\\perp}$ 位于正交补空间 $S^{\\perp}$ 中。因此，向量 $P_{S}w$ 和 $-x_{\\perp}$ 是正交的。根据勾股定理，它们和（或差）的范数平方等于它们各自范数平方的和：\n$$\\|x^{\\wedge} - x^{\\star}\\|_{2}^{2} = \\|P_{S}w\\|_{2}^{2} + \\|-x_{\\perp}\\|_{2}^{2} = \\|P_{S}w\\|_{2}^{2} + \\|x_{\\perp}\\|_{2}^{2}$$\n为了求期望平方误差，我们对此表达式取期望。根据期望的线性性质：\n$$\\mathbb{E}\\big[\\|x^{\\wedge} - x^{\\star}\\|_{2}^{2}\\big] = \\mathbb{E}\\big[\\|P_{S}w\\|_{2}^{2}\\big] + \\mathbb{E}\\big[\\|x_{\\perp}\\|_{2}^{2}\\big]$$\n这两项分别对应于估计量的方差和偏差平方。我们分别计算每一项。\n\n第一项（方差）：$\\mathbb{E}\\big[\\|P_{S}w\\|_{2}^{2}\\big]$。\n设 $\\{u_1, \\dots, u_k\\}$ 是 $k$ 维子空间 $S$ 的一组标准正交基。$w$ 在 $S$ 上的投影可以写为 $P_{S}w = \\sum_{i=1}^{k} \\langle w, u_i \\rangle u_i$。其范数平方则为：\n$$\\|P_{S}w\\|_{2}^{2} = \\sum_{i=1}^{k} \\langle w, u_i \\rangle^2$$\n期望为 $\\mathbb{E}\\big[\\|P_{S}w\\|_{2}^{2}\\big] = \\sum_{i=1}^{k} \\mathbb{E}\\big[\\langle w, u_i \\rangle^2\\big]$。噪声向量 $w$ 的分布为 $\\mathcal{N}(0, \\sigma^{2}I_n)$。随机变量 $\\langle w, u_i \\rangle$ 是高斯向量的线性变换，因此也是高斯分布的。其均值为 $\\mathbb{E}[\\langle w, u_i \\rangle] = \\langle \\mathbb{E}[w], u_i \\rangle = \\langle 0, u_i \\rangle = 0$。其方差为 $\\mathrm{Var}(\\langle w, u_i \\rangle) = u_i^T \\mathrm{Cov}(w) u_i = u_i^T (\\sigma^2 I_n) u_i = \\sigma^2 u_i^T u_i = \\sigma^2 \\|u_i\\|_2^2 = \\sigma^2$。对于一个零均值随机变量，其平方的期望等于其方差。因此，$\\mathbb{E}[\\langle w, u_i \\rangle^2] = \\sigma^2$。\n对 $k$ 个基向量求和，我们得到：\n$$\\mathbb{E}\\big[\\|P_{S}w\\|_{2}^{2}\\big] = \\sum_{i=1}^{k} \\sigma^2 = k \\sigma^2$$\n这一项表示由测量噪声 $w$ 带来的误差贡献。一个更高维度的信号模型（即更大的 $k$）更灵活，会“拟合”更多的噪声，从而导致重建的方差更高。\n\n第二项（偏差平方）：$\\mathbb{E}\\big[\\|x_{\\perp}\\|_{2}^{2}\\big]$。\n这一项表示由于模型无法表示真实信号中位于子空间 $S$ 之外的分量而产生的系统误差。我们已知 $x_{\\perp}$ 在 $(n-k)$ 维子空间 $S^{\\perp}$ 上服从高斯分布，具体为 $x_{\\perp} \\sim \\mathcal{N}(0, \\tau^{2}I_{n-k})$。\n设 $\\{v_1, \\dots, v_{n-k}\\}$ 是 $S^{\\perp}$ 的一组标准正交基。我们可以将 $x_{\\perp}$ 写为 $x_{\\perp} = \\sum_{j=1}^{n-k} c_j v_j$，其中系数 $c = (c_1, \\dots, c_{n-k})^T$ 服从 $\\mathcal{N}(0, \\tau^2 I_{n-k})$ 分布。其范数平方为：\n$$\\|x_{\\perp}\\|_{2}^{2} = \\sum_{j=1}^{n-k} c_j^2$$\n期望为 $\\mathbb{E}\\big[\\|x_{\\perp}\\|_{2}^{2}\\big] = \\sum_{j=1}^{n-k} \\mathbb{E}[c_j^2]$。每个系数 $c_j$ 服从 $\\mathcal{N}(0, \\tau^2)$ 分布。和之前一样，$\\mathbb{E}[c_j^2] = \\mathrm{Var}(c_j) + (\\mathbb{E}[c_j])^2 = \\tau^2 + 0^2 = \\tau^2$。\n对 $n-k$ 个基向量求和，我们得到：\n$$\\mathbb{E}\\big[\\|x_{\\perp}\\|_{2}^{2}\\big] = \\sum_{j=1}^{n-k} \\tau^2 = (n-k)\\tau^2$$\n这一项表示来自模型失配的误差。一个更高维度的模型（即更大的 $k$）会留下一个更低维度的正交补空间，从而减少了这个偏差项。\n\n结合这两项，总的期望平方重建误差为：\n$$\\mathbb{E}\\big[\\|x^{\\wedge} - x^{\\star}\\|_{2}^{2}\\big] = k \\sigma^2 + (n-k)\\tau^2$$\n这个表达式清晰地展示了偏差-方差权衡。增加由维度 $k$ 表示的模型复杂度，会增加方差项 $k \\sigma^2$，同时减少偏差项 $(n-k)\\tau^2$。最优的模型复杂度将取决于噪声方差 $\\sigma^2$ 和模型失配方差 $\\tau^2$ 的相对大小。",
            "answer": "$$\n\\boxed{k \\sigma^{2} + (n-k) \\tau^{2}}\n$$"
        },
        {
            "introduction": "在实践中，求解基于生成先验的逆问题通常是一个具有挑战性的非凸优化问题，其收敛速度可能非常缓慢。此问题通常源于目标函数景观的病态条件。本练习旨在介绍一种强大的加速技术——曲率感知预处理，通过分析一个线性化的潜在空间模型，您将亲手计算并比较预处理前后优化问题的条件数和收敛率，从而直观地理解预处理如何重塑优化问题并加快求解速度。",
            "id": "3442832",
            "problem": "考虑一个在潜空间中线性化的、带有深度生成先验的线性逆问题。设潜变量为 $z \\in \\mathbb{R}^{2}$，生成器是局部线性的，其雅可比矩阵为 $J_{G} = W \\in \\mathbb{R}^{2 \\times 2}$。测量值遵循 $y \\approx A x$，其中 $x = G(z)$ 且 $A \\in \\mathbb{R}^{2 \\times 2}$。假设 $z$ 服从高斯先验，其密度为 $p(z) \\propto \\exp\\!\\left(-\\tfrac{1}{2} z^{\\top} \\Sigma^{-1} z\\right)$，因此 $-\\log p(z) = \\tfrac{1}{2} z^{\\top} \\Sigma^{-1} z + \\text{const}$ 且 $\\nabla^{2}(-\\log p) = \\Sigma^{-1}$。潜空间中的最大后验 (MAP) 目标函数为\n$$\nf(z) = \\tfrac{1}{2} \\|A G(z) - y\\|_{2}^{2} + \\tfrac{\\lambda}{2} z^{\\top} \\Sigma^{-1} z,\n$$\n其中 $\\lambda > 0$，并且在局部线性化 $G(z) \\approx W z$ 的假设下，其 (高斯-牛顿) 曲率为\n$$\nB \\;=\\; J_{G}^{\\top} A^{\\top} A J_{G} \\;+\\; \\lambda \\,\\nabla^{2}(-\\log p) \\;=\\; W^{\\top} A^{\\top} A W \\;+\\; \\lambda \\,\\Sigma^{-1}.\n$$\n我们考虑对 $z$ 进行一阶优化，并使用一个由度量 $P \\succ 0$ 给出的曲率感知预条件子，以右预处理梯度步长 $\\Delta z = - \\alpha \\, P^{-1} \\nabla f(z)$ 的形式应用。\n\n假设以下具体的、数值上一致的设置：\n- $W = \\mathrm{diag}(2,\\,1)$,\n- $A = \\mathrm{diag}(3,\\,1)$,\n- $\\Sigma = \\mathrm{diag}\\!\\left(\\tfrac{1}{4},\\,1\\right)$，因此 $\\Sigma^{-1} = \\mathrm{diag}(4,\\,1)$,\n- $\\lambda = 1$。\n\n1. 利用线性最小二乘、高斯先验和高斯-牛顿曲率的基础知识，显式地构建 $B$ 并计算其谱条件数 $\\kappa_{0} = \\lambda_{\\max}(B)/\\lambda_{\\min}(B)$。\n2. 使用先验预条件子 $P = \\lambda \\,\\Sigma^{-1}$，分析预处理后的二次模型并确定有效曲率。计算有效曲率对应的条件数 $\\kappa_{1}$。\n3. 对于梯度下降法，使用强凸二次收敛界，并采用极小化极大最优常数步长 $\\alpha^{\\star} = \\tfrac{2}{L + \\mu}$（其中 $L$ 和 $\\mu$ 分别是曲率的最大和最小特征值），最坏情况下的线性收缩因子为 $q = \\tfrac{\\kappa - 1}{\\kappa + 1}$。令 $q_{0}$ 为无预处理时的收缩因子（使用 $\\kappa_{0}$），$q_{1}$ 为使用先验预处理时的收缩因子（使用 $\\kappa_{1}$）。计算精确比率\n$$\nr \\;=\\; \\frac{q_{0}}{q_{1}}.\n$$\n\n以单个简化的精确有理数形式提供 $r$。无需四舍五入。没有需要报告的物理单位。",
            "solution": "该问题要求计算一个特定潜空间优化问题的收敛速率之比，比较了无预处理方法与使用基于先验的预条件子方法。解题过程如问题陈述中所述，分为三个步骤。\n\n首先，我们定义问题中提供的矩阵和参数。\n生成器的雅可比矩阵是 $W = \\mathrm{diag}(2, 1)$，可写作：\n$$\nW = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}\n$$\n测量矩阵是 $A = \\mathrm{diag}(3, 1)$：\n$$\nA = \\begin{pmatrix} 3  0 \\\\ 0  1 \\end{pmatrix}\n$$\n潜变量 $z$ 的高斯先验的逆协方差矩阵是 $\\Sigma^{-1} = \\mathrm{diag}(4, 1)$：\n$$\n\\Sigma^{-1} = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}\n$$\n正则化参数是 $\\lambda = 1$。\n\n**1. 未预处理的曲率和条件数**\n\n(高斯-牛顿) 曲率矩阵 $B$ 由以下公式给出：\n$$\nB = W^{\\top} A^{\\top} A W + \\lambda \\Sigma^{-1}\n$$\n由于 $W$ 和 $A$ 都是对角矩阵，所以它们是对称的，即 $W^{\\top} = W$ 且 $A^{\\top} = A$。\n首先，我们计算数据保真项 $W^{\\top} A^{\\top} A W$：\n$$\nW^{\\top} A^{\\top} A W = W A A W = W A^2 W\n$$\n$$\nA^2 = \\begin{pmatrix} 3  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 3  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 3^2  0 \\\\ 0  1^2 \\end{pmatrix} = \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\nW A^2 W = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2 \\cdot 9 \\cdot 2  0 \\\\ 0  1 \\cdot 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 36  0 \\\\ 0  1 \\end{pmatrix}\n$$\n接下来，我们计算先验项 $\\lambda \\Sigma^{-1}$：\n$$\n\\lambda \\Sigma^{-1} = 1 \\cdot \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}\n$$\n现在，我们将这两个矩阵相加得到 $B$：\n$$\nB = \\begin{pmatrix} 36  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 36+4  0 \\\\ 0  1+1 \\end{pmatrix} = \\begin{pmatrix} 40  0 \\\\ 0  2 \\end{pmatrix}\n$$\n对于对角矩阵，其特征值即为对角线上的元素。因此，$B$ 的特征值为 $\\lambda_{\\max}(B) = 40$ 和 $\\lambda_{\\min}(B) = 2$。\n谱条件数 $\\kappa_0$ 是最大特征值与最小特征值之比：\n$$\n\\kappa_0 = \\frac{\\lambda_{\\max}(B)}{\\lambda_{\\min}(B)} = \\frac{40}{2} = 20\n$$\n\n**2. 预处理后的曲率和条件数**\n\n问题定义了一个先验预条件子 $P = \\lambda \\Sigma^{-1}$。根据给定值：\n$$\nP = 1 \\cdot \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}\n$$\n右预处理梯度步长涉及到矩阵 $P^{-1} B$。这是预处理后系统的有效曲率。首先，我们求 $P^{-1}$：\n$$\nP^{-1} = \\begin{pmatrix} 4  0 \\\\ 0  1 \\end{pmatrix}^{-1} = \\begin{pmatrix} \\frac{1}{4}  0 \\\\ 0  1 \\end{pmatrix}\n$$\n现在我们计算有效曲率矩阵，记为 $H_{\\text{eff}}$：\n$$\nH_{\\text{eff}} = P^{-1} B = \\begin{pmatrix} \\frac{1}{4}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 40  0 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\cdot 40  0 \\\\ 0  1 \\cdot 2 \\end{pmatrix} = \\begin{pmatrix} 10  0 \\\\ 0  2 \\end{pmatrix}\n$$\n有效曲率矩阵 $H_{\\text{eff}}$ 的特征值是其对角元素，即 $10$ 和 $2$。\n令 $L$ 和 $\\mu$ 分别为 $H_{\\text{eff}}$ 的最大和最小特征值，所以 $L = 10$ 且 $\\mu = 2$。预处理后系统的条件数 $\\kappa_1$ 为：\n$$\n\\kappa_1 = \\frac{L}{\\mu} = \\frac{10}{2} = 5\n$$\n\n**3. 收缩因子之比**\n\n对于一个条件数为 $\\kappa$ 的强凸二次目标函数，梯度下降的最坏情况线性收缩因子 $q$ 由下式给出：\n$$\nq = \\frac{\\kappa - 1}{\\kappa + 1}\n$$\n对于未预处理的系统，收缩因子 $q_0$ 基于 $\\kappa_0 = 20$ 计算：\n$$\nq_0 = \\frac{\\kappa_0 - 1}{\\kappa_0 + 1} = \\frac{20 - 1}{20 + 1} = \\frac{19}{21}\n$$\n对于使用先验预处理的系统，收缩因子 $q_1$ 基于 $\\kappa_1 = 5$ 计算：\n$$\nq_1 = \\frac{\\kappa_1 - 1}{\\kappa_1 + 1} = \\frac{5 - 1}{5 + 1} = \\frac{4}{6} = \\frac{2}{3}\n$$\n最后，我们计算所要求的比率 $r$：\n$$\nr = \\frac{q_0}{q_1} = \\frac{\\frac{19}{21}}{\\frac{2}{3}} = \\frac{19}{21} \\cdot \\frac{3}{2} = \\frac{19 \\cdot 3}{21 \\cdot 2}\n$$\n由于 $21 = 7 \\cdot 3$，我们可以简化表达式：\n$$\nr = \\frac{19 \\cdot 3}{7 \\cdot 3 \\cdot 2} = \\frac{19}{7 \\cdot 2} = \\frac{19}{14}\n$$\n最终结果是一个精确有理数。",
            "answer": "$$\n\\boxed{\\frac{19}{14}}\n$$"
        }
    ]
}