{
    "hands_on_practices": [
        {
            "introduction": "The graph Laplacian is central to signal processing on graphs, primarily because the quadratic form $x^{\\top} L x$ quantifies a signal's total variation. To build a solid intuition for this fundamental concept, this practice  guides you through decomposing this global measure into a sum of local variations at each vertex. By working through a concrete example, you will see precisely how the differences between signal values on connected nodes contribute to the overall smoothness metric.",
            "id": "3448891",
            "problem": "Consider a connected, undirected, weighted graph with vertex set $\\{1,2,3,4,5\\}$ and symmetric edge weights given by $w_{12}=3$, $w_{23}=1$, $w_{24}=2$, $w_{35}=4$, $w_{45}=1$, and $w_{ij}=0$ otherwise. Let $W$ denote the weighted adjacency matrix with entries $W_{ij}=w_{ij}$, let $D$ be the diagonal degree matrix with $D_{ii}=\\sum_{j} w_{ij}$, and let the combinatorial graph Laplacian be $L=D-W$. Consider the graph signal $x\\in\\mathbb{R}^{5}$ with entries $x=\\begin{pmatrix}2  -1  0  3  -2\\end{pmatrix}^{\\top}$. Define the per-vertex local variation by $V_{i}(x)=\\sum_{j:\\, w_{ij}0} w_{ij}\\,(x_{i}-x_{j})^{2}$.\n\nStarting only from the definitions above, derive a decomposition of the quadratic form $x^{\\top} L x$ into symmetric contributions associated with edges, and use it to interpret $x^{\\top} L x$ as a sum of vertex-local contributions built from incident edges via $V_{i}(x)$. Then, for the specific graph and signal given, compute $V_{i}(x)$ for each $i\\in\\{1,2,3,4,5\\}$, and use your decomposition to obtain the exact value of $x^{\\top} L x$. Report as your final answer the exact value of $x^{\\top} L x$ (no rounding is required and no units are involved).",
            "solution": "We begin from the fundamental definitions for a weighted, undirected graph: the weighted adjacency matrix $W$ is symmetric with $W_{ij}=w_{ij}\\ge 0$, the diagonal degree matrix is $D$ with diagonal entries $D_{ii}=\\sum_{j} w_{ij}$, and the combinatorial graph Laplacian is $L=D-W$. For any $x\\in\\mathbb{R}^{n}$, the quadratic form is\n$$\nx^{\\top} L x \\;=\\; x^{\\top} D x \\;-\\; x^{\\top} W x \\;=\\; \\sum_{i=1}^{n} D_{ii} x_{i}^{2} \\;-\\; \\sum_{i=1}^{n}\\sum_{j=1}^{n} W_{ij} x_{i} x_{j}.\n$$\nSubstituting $D_{ii}=\\sum_{j} w_{ij}$ and $W_{ij}=w_{ij}$,\n$$\nx^{\\top} L x \\;=\\; \\sum_{i=1}^{n}\\Big(\\sum_{j=1}^{n} w_{ij}\\Big) x_{i}^{2} \\;-\\; \\sum_{i=1}^{n}\\sum_{j=1}^{n} w_{ij} x_{i} x_{j}.\n$$\nBecause the graph is undirected, $w_{ij}=w_{ji}$ and $w_{ii}=0$. Rearranging terms and exploiting symmetry,\n$$\nx^{\\top} L x \\;=\\; \\frac{1}{2}\\sum_{i=1}^{n}\\sum_{j=1}^{n} w_{ij}\\big(x_{i}^{2}+x_{j}^{2}-2 x_{i} x_{j}\\big)\n\\;=\\; \\frac{1}{2}\\sum_{i=1}^{n}\\sum_{j=1}^{n} w_{ij}\\,(x_{i}-x_{j})^{2}.\n$$\nThis expresses $x^{\\top} L x$ as a symmetric sum over unordered edges $\\{i,j\\}$:\n$$\nx^{\\top} L x \\;=\\; \\sum_{\\{i,j\\}} w_{ij}\\,(x_{i}-x_{j})^{2},\n$$\nwhere the sum is over each undirected edge once. Equivalently, if we aggregate edge contributions at vertices, define the local variation\n$$\nV_{i}(x) \\;=\\; \\sum_{j:\\,w_{ij}0} w_{ij}\\,(x_{i}-x_{j})^{2}.\n$$\nThen each undirected edge $\\{i,j\\}$ appears exactly twice in $\\sum_{i} V_{i}(x)$, once in $V_{i}(x)$ and once in $V_{j}(x)$. Therefore,\n$$\n\\sum_{i=1}^{n} V_{i}(x) \\;=\\; 2 \\sum_{\\{i,j\\}} w_{ij}\\,(x_{i}-x_{j})^{2} \\;=\\; 2\\, x^{\\top} L x,\n$$\nwhich yields the decomposition\n$$\nx^{\\top} L x \\;=\\; \\frac{1}{2}\\sum_{i=1}^{n} V_{i}(x).\n$$\n\nWe now compute the local variations $V_{i}(x)$ for the given graph and signal. The nonzero weights are $w_{12}=3$, $w_{23}=1$, $w_{24}=2$, $w_{35}=4$, $w_{45}=1$. The signal entries are $x_{1}=2$, $x_{2}=-1$, $x_{3}=0$, $x_{4}=3$, $x_{5}=-2$.\n\n- For $i=1$, the neighbors are $\\{2\\}$:\n$$\nV_{1}(x) \\;=\\; w_{12}\\,(x_{1}-x_{2})^{2} \\;=\\; 3\\,(2-(-1))^{2} \\;=\\; 3\\cdot 3^{2} \\;=\\; 27.\n$$\n\n- For $i=2$, the neighbors are $\\{1,3,4\\}$:\n$$\n\\begin{aligned}\nV_{2}(x) \\;=\\; w_{12}\\,(x_{2}-x_{1})^{2} \\;+\\; w_{23}\\,(x_{2}-x_{3})^{2} \\;+\\; w_{24}\\,(x_{2}-x_{4})^{2} \\\\\n=\\; 3\\,(-1-2)^{2} \\;+\\; 1\\,(-1-0)^{2} \\;+\\; 2\\,(-1-3)^{2} \\\\\n=\\; 3\\cdot (-3)^{2} \\;+\\; 1\\cdot (-1)^{2} \\;+\\; 2\\cdot (-4)^{2} \\\\\n=\\; 27 \\;+\\; 1 \\;+\\; 32 \\;=\\; 60.\n\\end{aligned}\n$$\n\n- For $i=3$, the neighbors are $\\{2,5\\}$:\n$$\n\\begin{aligned}\nV_{3}(x) \\;=\\; w_{23}\\,(x_{3}-x_{2})^{2} \\;+\\; w_{35}\\,(x_{3}-x_{5})^{2} \\\\\n=\\; 1\\,(0-(-1))^{2} \\;+\\; 4\\,(0-(-2))^{2} \\\\\n=\\; 1\\cdot 1^{2} \\;+\\; 4\\cdot 2^{2} \\\\\n=\\; 1 \\;+\\; 16 \\;=\\; 17.\n\\end{aligned}\n$$\n\n- For $i=4$, the neighbors are $\\{2,5\\}$:\n$$\n\\begin{aligned}\nV_{4}(x) \\;=\\; w_{24}\\,(x_{4}-x_{2})^{2} \\;+\\; w_{45}\\,(x_{4}-x_{5})^{2} \\\\\n=\\; 2\\,(3-(-1))^{2} \\;+\\; 1\\,(3-(-2))^{2} \\\\\n=\\; 2\\cdot 4^{2} \\;+\\; 1\\cdot 5^{2} \\\\\n=\\; 32 \\;+\\; 25 \\;=\\; 57.\n\\end{aligned}\n$$\n\n- For $i=5$, the neighbors are $\\{3,4\\}$:\n$$\n\\begin{aligned}\nV_{5}(x) \\;=\\; w_{35}\\,(x_{5}-x_{3})^{2} \\;+\\; w_{45}\\,(x_{5}-x_{4})^{2} \\\\\n=\\; 4\\,(-2-0)^{2} \\;+\\; 1\\,(-2-3)^{2} \\\\\n=\\; 4\\cdot (-2)^{2} \\;+\\; 1\\cdot (-5)^{2} \\\\\n=\\; 16 \\;+\\; 25 \\;=\\; 41.\n\\end{aligned}\n$$\n\nSumming the local variations,\n$$\n\\sum_{i=1}^{5} V_{i}(x) \\;=\\; 27 \\;+\\; 60 \\;+\\; 17 \\;+\\; 57 \\;+\\; 41 \\;=\\; 202.\n$$\nBy the decomposition $x^{\\top} L x=\\frac{1}{2}\\sum_{i} V_{i}(x)$, we obtain\n$$\nx^{\\top} L x \\;=\\; \\frac{1}{2}\\cdot 202 \\;=\\; 101.\n$$\nAs a consistency check, we can also sum edge contributions once per undirected edge:\n$$\nw_{12}(x_{1}-x_{2})^{2} \\;+\\; w_{23}(x_{2}-x_{3})^{2} \\;+\\; w_{24}(x_{2}-x_{4})^{2} \\;+\\; w_{35}(x_{3}-x_{5})^{2} \\;+\\; w_{45}(x_{4}-x_{5})^{2}\n$$\n$$\n=\\; 3\\cdot 3^{2} \\;+\\; 1\\cdot 1^{2} \\;+\\; 2\\cdot 4^{2} \\;+\\; 4\\cdot 2^{2} \\;+\\; 1\\cdot 5^{2} \\;=\\; 27 \\;+\\; 1 \\;+\\; 32 \\;+\\; 16 \\;+\\; 25 \\;=\\; 101,\n$$\nwhich matches the value computed from vertex-local aggregation.",
            "answer": "$$\\boxed{101}$$"
        },
        {
            "introduction": "The Graph Fourier Transform (GFT) extends classical Fourier analysis to the irregular domain of graphs by using the eigenvectors of the graph Laplacian as a basis. Building on the understanding of signal variation, this exercise  demystifies the GFT by analyzing it on the cycle graph, a structure where graph signal processing concepts align perfectly with our intuition from standard discrete signals. You will derive the GFT basis for the cycle graph and see firsthand how the Laplacian eigenvalues correspond to the notion of frequency or signal oscillation.",
            "id": "3448867",
            "problem": "Consider the undirected cycle graph $C_{n}$ on $n$ nodes with node set $\\{0,1,\\dots,n-1\\}$ and edges between $j$ and $(j+1)\\bmod n$. Let $A$ denote the adjacency matrix and $D$ the diagonal degree matrix, and define the combinatorial graph Laplacian $L = D - A$. The Graph Fourier Transform (GFT) of a signal $x \\in \\mathbb{C}^{n}$ on $C_{n}$ is defined with respect to an orthonormal eigenbasis of $L$. The notion of graph frequency is tied to the Dirichlet energy $x^{\\top} L x$, and the eigenvalue associated with a Laplacian eigenvector quantifies its graph frequency.\n\nStarting from the definitions of $A$, $D$, and $L$ for $C_{n}$, derive the Laplacian eigenpairs in closed form and explain why ordering eigenvectors by increasing eigenvalues corresponds to ordering by increasing graph frequency. Then, form the GFT matrix $U$ whose columns are the normalized eigenvectors of $L$, and consider the canonical basis $\\{e_{i}\\}_{i=0}^{n-1}$ of $\\mathbb{C}^{n}$. Define the mutual coherence of these two bases by\n$$\n\\mu \\triangleq \\max_{0 \\leq i \\leq n-1} \\max_{0 \\leq m \\leq n-1} \\left| \\langle e_{i}, u_{m} \\rangle \\right|,\n$$\nwhere $u_{m}$ is the $m$-th column of $U$ and $\\langle \\cdot, \\cdot \\rangle$ is the standard inner product on $\\mathbb{C}^{n}$.\n\nCompute $\\mu$ in exact closed form as a symbolic expression of $n$. No rounding is required, and no units are involved. Provide only the final expression for $\\mu$ as your answer.",
            "solution": "For the cycle graph $C_n$ (with $n \\ge 3$), each node is connected to two neighbors, so the degree of every node is $2$. The degree matrix is $D = 2I$, where $I$ is the $n \\times n$ identity matrix. The adjacency matrix $A$ has elements $A_{ij}=1$ if $|i-j| \\equiv 1 \\pmod{n}$, making it a circulant matrix. The Laplacian is $L = D - A = 2I - A$.\n\nAll circulant matrices are diagonalized by the Discrete Fourier Transform (DFT) matrix. The normalized eigenvectors $\\{u_m\\}_{m=0}^{n-1}$ are the DFT basis vectors, with components:\n$$ (u_m)_j = \\frac{1}{\\sqrt{n}} \\exp\\left(i \\frac{2\\pi mj}{n}\\right) \\quad \\text{for } j=0, 1, \\dots, n-1 $$\nThese form an orthonormal basis. To find the eigenvalues of $L$, we first find the eigenvalues of $A$. The $j$-th component of the vector $A u_m$ is:\n$$ (A u_m)_j = (u_m)_{(j-1)\\bmod n} + (u_m)_{(j+1)\\bmod n} = \\frac{1}{\\sqrt{n}} \\exp\\left(i \\frac{2\\pi mj}{n}\\right) \\left[ \\exp\\left(-i \\frac{2\\pi m}{n}\\right) + \\exp\\left(i \\frac{2\\pi m}{n}\\right) \\right] $$\n$$ (A u_m)_j = (u_m)_j \\left[ 2\\cos\\left(\\frac{2\\pi m}{n}\\right) \\right] $$\nSo, $u_m$ is an eigenvector of $A$ with eigenvalue $\\lambda_m(A) = 2\\cos\\left(\\frac{2\\pi m}{n}\\right)$. Since $L = 2I - A$, the eigenvectors of $L$ are the same vectors $u_m$, and the corresponding eigenvalues $\\lambda_m$ are:\n$$ \\lambda_m = 2 - \\lambda_m(A) = 2 - 2\\cos\\left(\\frac{2\\pi m}{n}\\right) = 4\\sin^2\\left(\\frac{\\pi m}{n}\\right) $$\nThe eigenpairs $(\\lambda_m, u_m)$ of $L$ are therefore given by $\\lambda_m = 4\\sin^2\\left(\\frac{\\pi m}{n}\\right)$ and $(u_m)_j = \\frac{1}{\\sqrt{n}} \\exp\\left(i \\frac{2\\pi mj}{n}\\right)$ for $m, j \\in \\{0, 1, \\dots, n-1\\}$.\n\nThe Dirichlet energy of a signal $x$ is $x^* L x = \\sum_{(j,k) \\in E} |x_j - x_k|^2$, which measures the signal's total variation. A \"low frequency\" signal has low variation and thus small Dirichlet energy. For a normalized eigenvector $u_m$, its Dirichlet energy is $u_m^* L u_m = u_m^* (\\lambda_m u_m) = \\lambda_m$. Thus, the eigenvalue $\\lambda_m$ is the graph frequency of the mode $u_m$. Ordering the eigenvectors by their eigenvalues corresponds to ordering them by increasing oscillation or frequency.\n\nThe mutual coherence $\\mu$ between the GFT basis $\\{u_m\\}$ and the canonical basis $\\{e_i\\}$ is $\\mu = \\max_{i, m} \\left| \\langle e_{i}, u_{m} \\rangle \\right|$. The inner product is:\n$$ \\langle e_i, u_m \\rangle = \\sum_{j=0}^{n-1} \\overline{(u_m)_j} (e_i)_j = \\overline{(u_m)_i} = \\overline{\\left(\\frac{1}{\\sqrt{n}} \\exp\\left(i \\frac{2\\pi mi}{n}\\right)\\right)} = \\frac{1}{\\sqrt{n}} \\exp\\left(-i \\frac{2\\pi mi}{n}\\right) $$\nThe magnitude of this complex number is:\n$$ \\left| \\langle e_i, u_m \\rangle \\right| = \\left| \\frac{1}{\\sqrt{n}} \\right| \\cdot \\left| \\exp\\left(-i \\frac{2\\pi mi}{n}\\right) \\right| = \\frac{1}{\\sqrt{n}} \\cdot 1 = \\frac{1}{\\sqrt{n}} $$\nThis value is constant for all $i$ and $m$. Therefore, the maximum value is this constant.\n$$ \\mu = \\max_{i, m} \\frac{1}{\\sqrt{n}} = \\frac{1}{\\sqrt{n}} $$",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{n}}}\n$$"
        },
        {
            "introduction": "While the GFT provides a global frequency perspective, graph wavelets offer a powerful tool for analyzing signals at multiple scales and locations. This practice  introduces the concept of spectral graph wavelets, which are designed as filters in the graph Fourier domain established in earlier exercises. By calculating the wavelet coefficients for a localized signal on a a cycle graph, you will explore how the wavelet's shape and localization change with scale, mirroring the behavior of classical wavelets in a graph setting.",
            "id": "3448884",
            "problem": "Consider the cycle graph $C_n$ with $n \\geq 3$ vertices labeled $\\{0,1,\\dots,n-1\\}$, edges between $j$ and $j \\pm 1 \\pmod{n}$, adjacency matrix $A$, and combinatorial Laplacian $L = D - A$ where $D$ is the degree matrix. The graph Fourier basis of $C_n$ is given by the Discrete Fourier Transform (DFT) eigenvectors $u_k(j) = \\frac{1}{\\sqrt{n}} \\exp\\left(\\frac{2 \\pi \\mathrm{i} k j}{n}\\right)$ with corresponding Laplacian eigenvalues $\\lambda_k = 2 - 2 \\cos\\left(\\frac{2 \\pi k}{n}\\right)$ for $k = 0,1,\\dots,n-1$. The graph Fourier transform of a signal $x \\in \\mathbb{R}^n$ is $\\hat{x}(k) = \\sum_{j=0}^{n-1} x(j) \\overline{u_k(j)}$.\n\nDefine the spectral graph wavelet transform at scale $s  0$ by applying the spectral filter $g(x) = x \\exp(-x)$ in the Laplacian spectrum at the scaled argument $s \\lambda$, i.e., for $x \\in \\mathbb{R}^n$ the wavelet coefficients at node $i$ are\n$$\nW_s x(i) = \\sum_{k=0}^{n-1} g\\!\\big(s \\lambda_k\\big)\\, \\hat{x}(k)\\, u_k(i).\n$$\nLet the input signal be the Kronecker delta localized at node $0$, i.e., $x = \\delta_0$ with $\\delta_0(j) = 1$ if $j=0$ and $\\delta_0(j) = 0$ otherwise.\n\nStarting from the provided definitions and well-tested facts, derive a closed-form analytical expression for the real-valued wavelet coefficient $W_s \\delta_0(i)$ at an arbitrary node index $i \\in \\{0,1,\\dots,n-1\\}$ and scale $s  0$, expressed as a finite sum over frequencies. Use radian measure for all trigonometric function arguments.\n\nIn addition, use your derived expression to briefly and rigorously explain how the coefficients vary with $s$ (small versus large scales) and how this behavior parallels the intuition from standard discrete wavelets on the Euclidean line (e.g., localization, band-pass behavior, and vanishing moments), but do not provide any intermediate shortcut formulas beyond the definitions above.\n\nYour final answer must be a single closed-form analytic expression for $W_s \\delta_0(i)$ as a function of $n$, $s$, and $i$. No numerical approximation or rounding is required.",
            "solution": "The wavelet coefficient at node $i$ for a signal $x$ is $W_s x(i) = \\sum_{k=0}^{n-1} g(s \\lambda_k) \\hat{x}(k) u_k(i)$.\nThe input signal is the Kronecker delta at node 0, $x = \\delta_0$. Its graph Fourier transform is:\n$$\n\\hat{\\delta_0}(k) = \\sum_{j=0}^{n-1} \\delta_0(j) \\overline{u_k(j)} = \\overline{u_k(0)} = \\frac{1}{\\sqrt{n}}\n$$\nSubstituting this into the wavelet definition:\n$$\nW_s \\delta_0(i) = \\sum_{k=0}^{n-1} g(s \\lambda_k) \\left(\\frac{1}{\\sqrt{n}}\\right) u_k(i) = \\frac{1}{n} \\sum_{k=0}^{n-1} g(s \\lambda_k) \\exp\\left(\\frac{2 \\pi \\mathrm{i} k i}{n}\\right)\n$$\nSince the wavelet coefficients are real-valued, we can take the real part of the sum. Using Euler's formula, this yields:\n$$\nW_s \\delta_0(i) = \\frac{1}{n} \\sum_{k=0}^{n-1} g(s \\lambda_k) \\cos\\left(\\frac{2 \\pi k i}{n}\\right)\n$$\nFinally, we substitute the filter function $g(y) = y \\exp(-y)$ and the eigenvalues $\\lambda_k = 2 - 2 \\cos\\left(\\frac{2 \\pi k}{n}\\right)$. The argument to the filter is $s\\lambda_k = 2s\\left(1 - \\cos\\left(\\frac{2 \\pi k}{n}\\right)\\right)$.\nThe final closed-form expression is:\n$$\nW_s \\delta_0(i) = \\frac{1}{n} \\sum_{k=0}^{n-1} 2s\\left(1 - \\cos\\left(\\frac{2 \\pi k}{n}\\right)\\right) \\exp\\left(-2s\\left(1 - \\cos\\left(\\frac{2 \\pi k}{n}\\right)\\right)\\right) \\cos\\left(\\frac{2 \\pi k i}{n}\\right)\n$$\n\nThis expression represents the wavelet atom centered at node 0, evaluated at node $i$. Its behavior with respect to the scale parameter $s$ can be understood by analyzing the spectral filter kernel $g(s\\lambda_k)$.\n1.  **Band-pass Behavior and Vanishing Moments:** The kernel $g(y) = y \\exp(-y)$ is zero at $y=0$. Since $\\lambda_0 = 0$, the filter response $g(s\\lambda_0)$ is always zero. This means the wavelet transform filters out the constant (DC) component of any signal, which is analogous to the vanishing moment property of classical wavelets.\n2.  **Scale Parameter $s$:** The kernel function peaks at $y=1$. Thus, the wavelet filter $g(s\\lambda_k)$ is centered on frequencies $\\lambda_k$ where $s\\lambda_k \\approx 1$, or $\\lambda_k \\approx 1/s$.\n    -   For small values of $s$, the filter passes high-frequency content, as $\\lambda_k$ must be large.\n    -   For large values of $s$, the filter passes low-frequency content, as $\\lambda_k$ must be small.\n3.  **Localization:** The graph-domain localization of the wavelet is determined by the spectral width of the filter, due to the uncertainty principle.\n    -   For large $s$ (low frequencies), the filter $g(s\\lambda_k)$ has narrow spectral support, resulting in a wavelet that is spread out in the vertex domain.\n    -   For small $s$ (high frequencies), the filter has wide spectral support, resulting in a wavelet that is localized in the vertex domain.\nThis behavior—achieving best localization for small values of $s$ (corresponding to high frequencies)—is a key characteristic of this wavelet construction.",
            "answer": "$$\n\\boxed{\\frac{2s}{n} \\sum_{k=0}^{n-1} \\left(1 - \\cos\\left(\\frac{2 \\pi k}{n}\\right)\\right) \\exp\\left(-2s\\left(1 - \\cos\\left(\\frac{2 \\pi k}{n}\\right)\\right)\\right) \\cos\\left(\\frac{2 \\pi k i}{n}\\right)}\n$$"
        }
    ]
}