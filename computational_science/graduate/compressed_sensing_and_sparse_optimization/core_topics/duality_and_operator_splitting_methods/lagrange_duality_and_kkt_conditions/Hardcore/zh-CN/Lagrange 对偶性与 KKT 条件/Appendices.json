{
    "hands_on_practices": [
        {
            "introduction": "我们首先对标准的LASSO问题做一个关键的修改。通过引入非负性约束，我们将探讨这个看似简单的改变如何深刻地影响问题的卡鲁什-库恩-塔克 (Karush-Kuhn-Tucker, KKT) 条件及其对偶问题。这个练习  至关重要，它不仅能让你练习推导KKT系统，还能让你深入理解原始约束（primal constraints）如何在对偶可行域（dual feasibility region）中得到反映，以及这如何改变了变量选择的机制。",
            "id": "3456248",
            "problem": "考虑在压缩感知中带有非负约束的稀疏优化问题，\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\;\\; \\frac{1}{2}\\|A x - b\\|_{2}^{2} + \\lambda \\|x\\|_{1} \\quad \\text{subject to} \\quad x \\ge 0,\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^{m}$，$\\lambda  0$，并且不等式 $x \\ge 0$ 逐元素成立。由于非负约束，在可行集上 $\\|x\\|_{1} = \\mathbf{1}^{\\top}x$，其中 $\\mathbf{1}$ 表示 $\\mathbb{R}^{n}$ 中的全1向量。从拉格朗日函数和不等式约束凸规划的卡鲁什-库恩-塔克 (KKT) 条件的定义出发，并利用芬克尔-洛克菲勒对偶 (Fenchel–Rockafellar duality)，执行以下操作：\n\n- 推导上述问题的 KKT 系统（原始可行性、对偶可行性、平稳性和互补松弛性）。明确定义残差 $r := A x - b$，并根据相关性 $A^{\\top} r$ 总结每个坐标的最优性条件。\n- 通过其凸共轭处理最小二乘项来推导拉格朗日对偶问题，并刻画对偶可行域。解释相对于无约束的最小绝对收缩和选择算子 (LASSO)，非负性如何改变对偶可行性，特别是它如何改变决定支撑集可识别性的相关性阈值条件。\n- 利用您对KKT条件的刻画，确定最小的实数 $\\lambda_{\\star}$，使得对于给定的数据 $x^{\\star} = 0$ 是最优解\n$$\nA \\;=\\; \\begin{pmatrix}\n1  0  1  0 \\\\\n0  1  1  1 \\\\\n1  1  0  1\n\\end{pmatrix}, \n\\quad\nb \\;=\\; \\begin{pmatrix}\n3 \\\\ 2 \\\\ 4\n\\end{pmatrix}.\n$$\n\n您的最终答案必须是 $\\lambda_{\\star}$ 的一个单一实数，精确表示（无需四舍五入）。",
            "solution": "给定的优化问题是\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\;\\; \\frac{1}{2}\\|A x - b\\|_{2}^{2} + \\lambda \\|x\\|_{1} \\quad \\text{subject to} \\quad x \\ge 0,\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$，$b \\in \\mathbb{R}^{m}$ 且 $\\lambda  0$。约束 $x \\ge 0$ 意味着对所有 $i \\in \\{1, \\dots, n\\}$ 都有 $x_i \\ge 0$。在可行集 $x \\ge 0$ 上，$\\ell_1$-范数简化为 $\\|x\\|_{1} = \\sum_{i=1}^{n} x_i = \\mathbf{1}^{\\top}x$。因此，该问题可以重写为：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\;\\; f(x) := \\frac{1}{2}\\|A x - b\\|_{2}^{2} + \\lambda \\mathbf{1}^{\\top}x \\quad \\text{subject to} \\quad -x_i \\le 0 \\text{ for } i=1, \\dots, n.\n$$\n这是一个凸优化问题，因为目标函数 $f(x)$ 是一个凸二次函数和一个线性函数的和，因此是凸的，并且约束是线性的，定义了一个凸可行集。由于 Slater 条件成立（例如，$x = \\mathbf{1}$ 是一个严格可行点），强对偶性成立，并且卡鲁什-库恩-塔克 (KKT) 条件是最优性的充分必要条件。\n\n首先，我们推导这个问题的 KKT 系统。通过为每个约束 $-x_i \\le 0$ 引入拉格朗日乘子 $\\mu_i \\ge 0$ 来构造拉格朗日函数：\n$$\nL(x, \\mu) = f(x) + \\sum_{i=1}^{n} \\mu_i(-x_i) = \\frac{1}{2}\\|A x - b\\|_{2}^{2} + \\lambda \\mathbf{1}^{\\top}x - \\mu^{\\top}x.\n$$\n对于最优解 $x^{\\star}$ 及其对应的对偶变量 $\\mu^{\\star}$，KKT 条件为：\n1.  **原始可行性**：$x^{\\star} \\ge 0$。\n2.  **对偶可行性**：$\\mu^{\\star} \\ge 0$。\n3.  **互补松弛性**：对所有 $i=1, \\dots, n$ 都有 $\\mu_i^{\\star} x_i^{\\star} = 0$。\n4.  **平稳性**：拉格朗日函数关于 $x$ 的梯度在 $x^{\\star}$ 处必须为零：$\\nabla_x L(x^{\\star}, \\mu^{\\star}) = 0$。\n\n我们来计算平稳性条件的梯度：\n$$\n\\nabla_x L(x, \\mu) = \\nabla_x \\left( \\frac{1}{2}(Ax-b)^{\\top}(Ax-b) + \\lambda \\mathbf{1}^{\\top}x - \\mu^{\\top}x \\right) = A^{\\top}(Ax-b) + \\lambda\\mathbf{1} - \\mu.\n$$\n设残差记为 $r = Ax-b$。平稳性条件是 $A^{\\top}r + \\lambda\\mathbf{1} - \\mu = 0$，或 $\\mu = A^{\\top}r + \\lambda\\mathbf{1}$。\n\n现在我们可以用原始变量 $x$ 和残差 $r = Ax-b$ 来总结 KKT 系统：\n-   对所有 $i$，$x_i \\ge 0$。\n-   对所有 $i$，$[A^{\\top}r]_i + \\lambda \\ge 0$ （由 $\\mu_i \\ge 0$ 得出）。\n-   对所有 $i$，$([A^{\\top}r]_i + \\lambda)x_i = 0$。\n\n这些条件可以按坐标 $i$ 分解：\n-   如果 $x_i  0$（该坐标在激活集中），互补松弛性要求 $[A^{\\top}r]_i + \\lambda = 0$，这意味着相关性 $[A^{\\top}r]_i = -\\lambda$。\n-   如果 $x_i = 0$（该坐标非激活），互补松弛性得到满足。剩下的条件是对偶可行性，即 $[A^{\\top}r]_i + \\lambda \\ge 0$，这意味着 $[A^{\\top}r]_i \\ge -\\lambda$。\n向量 $A^{\\top}r$ 包含了 $A$ 的列与残差之间的相关性。\n\n接下来，我们使用芬克尔-洛克菲勒对偶框架推导拉格朗日对偶问题。我们将原始问题表示为 $\\min_{x} h(Ax) + g(x)$，其中 $h(y) = \\frac{1}{2}\\|y-b\\|_2^2$，$g(x) = \\lambda \\|x\\|_1 + I_+(x)$，$I_+(x)$ 是非负象限 $\\{x \\mid x \\ge 0\\}$ 的指示函数。对偶问题是 $\\max_{\\nu} -h^{\\star}(\\nu) - g^{\\star}(-A^{\\top}\\nu)$。\n$h(y)$ 的凸共轭是：\n$$\nh^{\\star}(\\nu) = \\sup_{y} (\\nu^{\\top}y - h(y)) = \\sup_{y} \\left(\\nu^{\\top}y - \\frac{1}{2}\\|y-b\\|_2^2\\right).\n$$\n通过将梯度设为零来找到最大化点：$\\nu - (y-b) = 0 \\implies y = \\nu+b$。将其代回可得 $h^{\\star}(\\nu) = \\nu^{\\top}(\\nu+b) - \\frac{1}{2}\\|\\nu\\|_2^2 = \\frac{1}{2}\\|\\nu\\|_2^2 + \\nu^{\\top}b$。\n$g(x)$ 的凸共轭是：\n$$\ng^{\\star}(z) = \\sup_{x} (z^{\\top}x - g(x)) = \\sup_{x \\ge 0} (z^{\\top}x - \\lambda\\mathbf{1}^{\\top}x) = \\sup_{x \\ge 0} (z - \\lambda\\mathbf{1})^{\\top}x.\n$$\n如果 $z - \\lambda\\mathbf{1} \\le 0$（即对所有 $i$ 都有 $z_i \\le \\lambda$），这个上确界为 $0$，否则为 $+\\infty$。因此，$g^{\\star}(z)$ 是集合 $\\{z \\mid z \\le \\lambda\\mathbf{1}\\}$ 的指示函数。\n那么，如果 $-A^{\\top}\\nu \\le \\lambda\\mathbf{1}$（等价于 $A^{\\top}\\nu \\ge -\\lambda\\mathbf{1}$），$g^{\\star}(-A^{\\top}\\nu)$ 为 $0$，否则为 $+\\infty$。\n对偶问题是最大化：\n$$\n\\max_{\\nu} \\quad -h^{\\star}(\\nu) - g^{\\star}(-A^{\\top}\\nu) = \\max_{\\nu} \\quad -\\left(\\frac{1}{2}\\|\\nu\\|_2^2 + \\nu^{\\top}b\\right) \\quad \\text{subject to} \\quad A^{\\top}\\nu \\ge -\\lambda\\mathbf{1}.\n$$\n这等价于最小化目标函数的负数：\n$$\n\\min_{\\nu} \\quad \\frac{1}{2}\\|\\nu\\|_2^2 + \\nu^{\\top}b \\quad \\text{subject to} \\quad A^{\\top}\\nu \\ge -\\lambda\\mathbf{1}.\n$$\n通过配方法，这等价于在相同约束下求 $\\min_{\\nu} \\frac{1}{2}\\|\\nu+b\\|_2^2$。对偶变量 $\\nu$ 可以被看作是原始残差 $r = Ax-b$ 的负值，即 $\\nu = -(Ax-b) = b-Ax$。对偶可行域由 $A^{\\top}\\nu \\ge -\\lambda\\mathbf{1}$ 定义。\n\n作为比较，无约束 LASSO 问题（$\\min_x \\frac{1}{2}\\|Ax-b\\|_2^2 + \\lambda\\|x\\|_1$）的对偶问题的可行性条件是 $\\|A^{\\top}\\nu\\|_{\\infty} \\le \\lambda$，这等价于 $-\\lambda\\mathbf{1} \\le A^{\\top}\\nu \\le \\lambda\\mathbf{1}$。\n非负约束 $x \\ge 0$ 将每个相关性 $[A^{\\top}\\nu]_i$ 的对偶可行性条件从一个对称区间 $[-\\lambda, \\lambda]$ 放宽到一个单边条件 $[A^{\\top}\\nu]_i \\ge -\\lambda$。这改变了阈值机制：要使一个变量 $x_i$ 变为激活（即 $x_i>0$），其对应的相关性 $[A^{\\top}r]_i$ 必须达到下界 $-\\lambda$。而在无约束 LASSO 中，相关性的*绝对值* $|[A^{\\top}r]_i|$ 必须达到阈值 $\\lambda$。\n\n最后，我们确定使 $x^{\\star}=0$ 成为给定数据的最优解的最小 $\\lambda_{\\star}$ 值。\n要使 $x^{\\star}=0$ 最优，它必须满足 KKT 条件。设 $x=0$，则对于所有 $i=1, \\dots, n$，非激活坐标的条件必须成立：\n$$\n[A^{\\top}(A(0)-b)]_i + \\lambda \\ge 0 \\quad \\implies \\quad [-A^{\\top}b]_i + \\lambda \\ge 0 \\quad \\implies \\quad [A^{\\top}b]_i \\le \\lambda.\n$$\n这个不等式必须对所有 $i=1, \\dots, n$ 成立。这要求 $\\lambda$ 大于或等于这些相关性值的最大值：\n$$\n\\lambda \\ge \\max_{i} \\left\\{ [A^{\\top}b]_i \\right\\}.\n$$\n因此，确保 $x^{\\star} = 0$ 是最优解的最小 $\\lambda_{\\star}$ 值是这些相关性的最大值（前提是这个最大值是正数，这意味着 $\\lambda_{\\star}  0$，符合要求）。\n给定的数据是：\n$$\nA \\;=\\; \\begin{pmatrix}\n1  0  1  0 \\\\\n0  1  1  1 \\\\\n1  1  0  1\n\\end{pmatrix}, \n\\quad\nb \\;=\\; \\begin{pmatrix}\n3 \\\\ 2 \\\\ 4\n\\end{pmatrix}.\n$$\n我们计算相关性向量 $A^{\\top}b$：\n$$\nA^{\\top}b \\;=\\; \\begin{pmatrix}\n1  0  1 \\\\\n0  1  1 \\\\\n1  1  0 \\\\\n0  1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n3 \\\\\n2 \\\\\n4\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1(3) + 0(2) + 1(4) \\\\\n0(3) + 1(2) + 1(4) \\\\\n1(3) + 1(2) + 0(4) \\\\\n0(3) + 1(2) + 1(4)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n7 \\\\\n6 \\\\\n5 \\\\\n6\n\\end{pmatrix}.\n$$\n$\\lambda$ 的最小值必须是该向量的最大分量：\n$$\n\\lambda_{\\star} = \\max\\{7, 6, 5, 6\\} = 7.\n$$",
            "answer": "$$\\boxed{7}$$"
        },
        {
            "introduction": "接下来，我们将探索对偶框架的通用性，考察在稀疏回归中改变数据保真项（即损失函数）所带来的影响。我们将比较标准的平方损失、对鲁棒性更强的绝对值损失以及综合两者优点的Huber损失。这个练习  将揭示损失函数的凸共轭（convex conjugate）在构造对偶问题和塑造其约束条件中的核心作用，并阐明不同损失函数如何通过KKT条件实现对残差的隐式裁剪或约束。",
            "id": "3456196",
            "problem": "考虑以下形式的 $\\ell_1$-正则化回归问题族\n$$\\min_{\\beta \\in \\mathbb{R}^p} \\;\\; \\sum_{i=1}^n \\ell\\!\\left(y_i - x_i^\\top \\beta\\right) \\;+\\; \\lambda \\|\\beta\\|_1,$$\n其中 $X \\in \\mathbb{R}^{n \\times p}$ 的行是 $x_i^\\top$，$y \\in \\mathbb{R}^n$，$\\lambda  0$，并且损失函数 $\\ell$ 是以下凸函数之一，逐分量地应用于残差 $r = y - X\\beta$：\n- 平方损失 $\\ell(t) = \\tfrac{1}{2} t^2$，\n- 绝对值损失 $\\ell(t) = |t|$，\n- 参数为 $\\delta  0$ 的 Huber 损失，由 $\\ell(t) = \\rho_\\delta(t)$ 给出，其中当 $|t| \\le \\delta$ 时 $\\rho_\\delta(t) = \\tfrac{1}{2} t^2$，当 $|t|  \\delta$ 时 $\\rho_\\delta(t) = \\delta |t| - \\tfrac{1}{2}\\delta^2$。\n\n仅使用凸分析的基本定义（Fenchel 共轭 $f^*(u) = \\sup_{z} \\{ u^\\top z - f(z)\\}$、次微分 $\\partial f$ 和卡鲁什-库恩-塔克 (KKT) 条件），结合线性代数操作，推导每种损失对应的拉格朗日对偶问题和对偶可行集，并描述连接对偶变量与残差的 KKT 关系。基于此原理性推导，以下哪些陈述正确地比较了三种损失的对偶可行集，并正确地解释了损失共轭如何通过 KKT 关系来约束或裁剪残差？\n\n选择所有适用项。\n\n- A. 对于平方损失，其对偶问题是 $\\max_{\\theta \\in \\mathbb{R}^n} \\; y^\\top \\theta - \\tfrac{1}{2}\\|\\theta\\|_2^2$，约束条件为 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$。KKT 条件给出 $\\theta = r := y - X\\beta$。损失共轭没有对 $\\theta$ 施加逐点界限，因此残差不受损失的逐分量限制；只有由设计矩阵施加的约束 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$ 出现在对偶可行集中。\n\n- B. 对于绝对值损失，其对偶问题是 $\\max_{\\theta \\in \\mathbb{R}^n} \\; y^\\top \\theta$，约束条件为 $\\|\\theta\\|_\\infty \\le 1$ 和 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$。KKT 条件给出 $\\theta_i \\in \\partial |r_i|$，即当 $r_i \\ne 0$ 时 $\\theta_i = \\operatorname{sign}(r_i)$，当 $r_i = 0$ 时 $\\theta_i \\in [-1,1]$。因此，损失共轭施加了逐分量界限 $\\|\\theta\\|_\\infty \\le 1$，这迫使对偶变量在残差非零时饱和在 $\\pm 1$。\n\n- C. 对于参数为 $\\delta  0$ 的 Huber 损失，其对偶问题是 $\\max_{\\theta \\in \\mathbb{R}^n} \\; y^\\top \\theta - \\tfrac{1}{2}\\|\\theta\\|_2^2$，约束条件为 $\\|\\theta\\|_\\infty \\le \\delta$ 和 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$。KKT 关系是 $\\theta_i = \\mathrm{clip}(r_i,[-\\delta,\\delta])$，即当 $|r_i| \\le \\delta$ 时 $\\theta_i = r_i$，当 $|r_i|  \\delta$ 时 $\\theta_i = \\delta \\,\\operatorname{sign}(r_i)$。因此，损失共轭施加了界限 $\\|\\theta\\|_\\infty \\le \\delta$，它将对偶变量（从而也是次梯度）在水平 $\\delta$ 处进行裁剪。\n\n- D. 对于平方损失，对偶可行集必然包含约束 $\\|\\theta\\|_\\infty \\le 1$，并且 KKT 条件意味着 $\\theta_i \\in \\partial |r_i|$，因此残差分量的绝对值以 $1$ 为界。\n\n- E. 对于绝对值损失，对偶目标是 $y^\\top \\theta - \\tfrac{1}{2}\\|\\theta\\|_2^2$，只有一个约束 $\\|\\theta\\|_\\infty \\le 1$，并且 KKT 条件给出 $\\theta = r$，这意味着 $\\|r\\|_\\infty \\le 1$。\n\n- F. 对于 Huber 损失，对偶可行集仅为 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$（对 $\\|\\theta\\|_\\infty$ 没有约束），因为 Huber 共轭处处有限，并且 KKT 条件得出 $\\theta = r$，与平方损失的情况完全相同。",
            "solution": "用户要求我验证问题陈述，如果有效，则通过推导三种不同损失函数的 $\\ell_1$-正则化回归的拉格朗日对偶和 KKT 条件来解决该问题。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n问题是分析以下优化问题：\n$$ \\min_{\\beta \\in \\mathbb{R}^p} \\;\\; \\sum_{i=1}^n \\ell\\!\\left(y_i - x_i^\\top \\beta\\right) \\;+\\; \\lambda \\|\\beta\\|_1 $$\n其中：\n-   优化变量是 $\\beta \\in \\mathbb{R}^p$。\n-   数据是设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$（其行为 $x_i^\\top$）和响应向量 $y \\in \\mathbb{R}^n$。\n-   正则化参数为 $\\lambda  0$。\n-   损失函数 $\\ell(t)$ 是应用于残差向量 $r = y - X\\beta$ 各分量的三个凸函数之一：\n    1.  平方损失：$\\ell(t) = \\tfrac{1}{2} t^2$。\n    2.  绝对值损失：$\\ell(t) = |t|$。\n    3.  Huber 损失：$\\ell(t) = \\rho_\\delta(t)$，定义为当 $|t| \\le \\delta$ 时 $\\rho_\\delta(t) = \\tfrac{1}{2} t^2$，当 $|t|  \\delta$ 时 $\\rho_\\delta(t) = \\delta |t| - \\tfrac{1}{2}\\delta^2$，参数为 $\\delta  0$。\n-   分析必须使用基本定义：Fenchel 共轭 $f^*(u) = \\sup_{z} \\{ u^\\top z - f(z)\\}$、次微分 $\\partial f$ 和卡鲁什-库恩-塔克 (KKT) 条件。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n-   **科学性：** 该问题是现代统计学、机器学习和信号处理的基石，特别是在稀疏建模和高维数据分析领域（例如 LASSO）。其表述基于凸优化的既定原则。这是一项关键要求，并且已得到满足。\n-   **适定性：** 问题陈述的结构清晰，要求基于标准理论进行数学推导和比较。底层的优化问题是凸的，因此具有明确定义的对偶问题和 KKT 条件。推导任务存在唯一的解。\n-   **客观性：** 问题以精确的数学语言陈述，没有主观性或歧义。这是一项关键要求，并且已得到满足。\n-   **其他缺陷：** 该问题不违反任何其他有效性标准。它是完整的、一致的、可形式化的，并且并非无足轻重。\n\n**第 3 步：结论与行动**\n\n问题陈述是**有效的**。现在开始求解过程。\n\n### 对偶问题和 KKT 条件的推导\n\n我们从原始问题开始。为了方便推导对偶问题，我们为残差引入一个辅助变量 $r = y - X\\beta$。问题变为：\n$$ \\min_{\\beta \\in \\mathbb{R}^p, r \\in \\mathbb{R}^n} \\;\\; \\sum_{i=1}^n \\ell(r_i) + \\lambda \\|\\beta\\|_1 \\quad \\text{subject to} \\quad r + X\\beta = y $$\n目标函数是凸的，约束是仿射的。我们通过引入对偶变量 $\\theta \\in \\mathbb{R}^n$ 来构造拉格朗日函数：\n$$ L(\\beta, r; \\theta) = \\sum_{i=1}^n \\ell(r_i) + \\lambda \\|\\beta\\|_1 - \\theta^\\top(r + X\\beta - y) $$\n拉格朗日对偶函数 $g(\\theta)$ 是拉格朗日函数关于原始变量 $\\beta$ 和 $r$ 的下确界：\n$$ g(\\theta) = \\inf_{\\beta, r} L(\\beta, r; \\theta) = y^\\top\\theta + \\inf_{r} \\left( \\sum_{i=1}^n \\ell(r_i) - \\theta^\\top r \\right) + \\inf_{\\beta} \\left( \\lambda \\|\\beta\\|_1 - (X^\\top\\theta)^\\top \\beta \\right) $$\n我们分别分析这两个下确界项。\n\n关于 $r$ 的下确界与总损失 $L_{total}(r) = \\sum_{i=1}^n \\ell(r_i)$ 的 Fenchel 共轭有关。其共轭是 $L_{total}^*(\\theta) = \\sup_r(\\theta^\\top r - L_{total}(r))$。由于损失的可分离性，$L_{total}^*(\\theta) = \\sum_{i=1}^n \\ell^*(\\theta_i)$，其中 $\\ell^*$ 是标量损失函数 $\\ell$ 的共轭。\n因此，第一项是：\n$$ \\inf_{r} \\left( \\sum_{i=1}^n \\ell(r_i) - \\theta^\\top r \\right) = - \\sup_{r} \\left( \\theta^\\top r - \\sum_{i=1}^n \\ell(r_i) \\right) = - \\sum_{i=1}^n \\ell^*(\\theta_i) $$\n\n关于 $\\beta$ 的下确界与 $\\ell_1$-范数的共轭有关。令 $h(\\beta) = \\lambda \\|\\beta\\|_1$。其共轭是 $h^*(v) = \\sup_\\beta(v^\\top\\beta - \\lambda\\|\\beta\\|_1)$。如果 $\\|v\\|_\\infty \\le \\lambda$，该共轭为 $0$，否则为 $+\\infty$。它可以写成指示函数 $I_{\\{\\|\\cdot\\|_\\infty \\le \\lambda\\}}(v)$。\n第二项是：\n$$ \\inf_{\\beta} \\left( \\lambda \\|\\beta\\|_1 - (X^\\top\\theta)^\\top \\beta \\right) = - \\sup_{\\beta} \\left( (X^\\top\\theta)^\\top \\beta - \\lambda \\|\\beta\\|_1 \\right) = -h^*(X^\\top\\theta) $$\n如果 $\\|X^\\top\\theta\\|_\\infty \\le \\lambda$，该表达式的值为 $0$，否则为 $-\\infty$。\n\n结合这些结果，对偶函数为：\n$$ g(\\theta) = y^\\top\\theta - \\sum_{i=1}^n \\ell^*(\\theta_i) \\quad \\text{if } \\|X^\\top\\theta\\|_\\infty \\le \\lambda $$\n否则 $g(\\theta) = -\\infty$。共轭函数 $\\ell^*(\\theta_i)$ 的定义域可能会引入额外的约束。对偶问题是最大化 $g(\\theta)$：\n$$ \\max_{\\theta \\in \\mathbb{R}^n} \\;\\; y^\\top\\theta - \\sum_{i=1}^n \\ell^*(\\theta_i) \\quad \\text{subject to} \\quad \\|X^\\top\\theta\\|_\\infty \\le \\lambda \\text{ and } \\theta \\in \\text{dom}(L_{total}^*) $$\n关于 $r$ 的 KKT 平稳性条件是 $\\partial_r L(\\beta^*, r^*; \\theta^*) \\ni 0$。这意味着 $\\partial_r (\\sum_i \\ell(r_i^*)) - \\theta^* \\ni 0$，可简化为对每个分量 $i=1, \\dots, n$ 都有 $\\theta_i^* \\in \\partial \\ell(r_i^*)$。\n\n我们现在将这个通用框架应用于三种损失函数中的每一种。\n\n**情况 1：平方损失**\n-   损失：$\\ell(t) = \\tfrac{1}{2}t^2$。这是可微的，所以 $\\partial\\ell(t) = \\{\\ell'(t)\\} = \\{t\\}$。\n-   共轭：$\\ell^*(u) = \\sup_t(ut - \\tfrac{1}{2}t^2)$。通过将导数设为零找到上确界：$u - t = 0 \\implies t=u$。因此，$\\ell^*(u) = u^2 - \\tfrac{1}{2}u^2 = \\tfrac{1}{2}u^2$。$\\ell^*$ 的定义域是整个 $\\mathbb{R}$。\n-   对偶问题：项 $\\sum \\ell^*(\\theta_i)$ 变为 $\\tfrac{1}{2}\\sum \\theta_i^2 = \\tfrac{1}{2}\\|\\theta\\|_2^2$。由于 $\\text{dom}(\\ell^*) = \\mathbb{R}$，没有对 $\\theta$ 施加额外的约束。对偶问题是：\n    $$ \\max_{\\theta \\in \\mathbb{R}^n} \\;\\; y^\\top \\theta - \\tfrac{1}{2}\\|\\theta\\|_2^2 \\quad \\text{subject to} \\quad \\|X^\\top \\theta\\|_\\infty \\le \\lambda $$\n-   关于 $r$ 的 KKT 条件：关系 $\\theta_i \\in \\partial\\ell(r_i)$ 变为 $\\theta_i = r_i$。因此，在最优解处，对偶变量等于残差向量：$\\theta = r = y-X\\beta$。\n\n**情况 2：绝对值损失**\n-   损失：$\\ell(t) = |t|$。当 $t \\ne 0$ 时，次微分是 $\\partial|t| = \\{\\text{sign}(t)\\}$，而 $\\partial|0| = [-1,1]$。\n-   共轭：$\\ell^*(u) = \\sup_t(ut - |t|)$。仅当 $|u| \\le 1$ 时，此上确界是有限的，此时其值为 $0$。因此，$\\ell^*(u)$ 是区间 $[-1,1]$ 的指示函数，即如果 $|u|\\le 1$，则 $\\ell^*(u)=0$，否则为 $+\\infty$。\n-   对偶问题：如果 $\\|\\theta\\|_\\infty \\le 1$，则项 $\\sum \\ell^*(\\theta_i)$ 为 $0$，否则为 $+\\infty$。这对对偶可行集施加了约束 $\\|\\theta\\|_\\infty \\le 1$。对偶问题变为：\n    $$ \\max_{\\theta \\in \\mathbb{R}^n} \\;\\; y^\\top \\theta \\quad \\text{subject to} \\quad \\|X^\\top \\theta\\|_\\infty \\le \\lambda \\text{ and } \\|\\theta\\|_\\infty \\le 1 $$\n-   关于 $r$ 的 KKT 条件：关系 $\\theta_i \\in \\partial|r_i|$ 意味着如果 $r_i \\ne 0$，则 $\\theta_i = \\text{sign}(r_i)$；如果 $r_i=0$，则 $\\theta_i \\in [-1,1]$。\n\n**情况 3：Huber 损失**\n-   损失：$\\ell(t) = \\rho_\\delta(t)$。此函数处处可微，其导数为 $\\ell'(t) = \\text{clip}(t, [-\\delta, \\delta]) = \\max(-\\delta, \\min(\\delta, t))$。\n-   共轭：$\\ell^*(u) = \\sup_t(ut - \\rho_\\delta(t))$。如果 $|u|  \\delta$，则上确界是无界的。如果 $|u| \\le \\delta$，则上确界在 $t=u$ 处达到，此时 $\\rho_\\delta(u) = \\tfrac{1}{2}u^2$。所以 $\\ell^*(u) = u^2 - \\tfrac{1}{2}u^2 = \\tfrac{1}{2}u^2$。因此，如果 $|u|\\le\\delta$，则 $\\ell^*(u) = \\tfrac{1}{2}u^2$，否则为 $+\\infty$。\n-   对偶问题：如果 $\\|\\theta\\|_\\infty \\le \\delta$，则项 $\\sum \\ell^*(\\theta_i)$ 为 $\\tfrac{1}{2}\\|\\theta\\|_2^2$，否则为 $+\\infty$。这对对偶可行集施加了约束 $\\|\\theta\\|_\\infty \\le \\delta$。对偶问题是：\n    $$ \\max_{\\theta \\in \\mathbb{R}^n} \\;\\; y^\\top \\theta - \\tfrac{1}{2}\\|\\theta\\|_2^2 \\quad \\text{subject to} \\quad \\|X^\\top \\theta\\|_\\infty \\le \\lambda \\text{ and } \\|\\theta\\|_\\infty \\le \\delta $$\n-   关于 $r$ 的 KKT 条件：关系 $\\theta_i \\in \\partial\\ell(r_i)$ 变为 $\\theta_i = \\ell'(r_i) = \\text{clip}(r_i, [-\\delta, \\delta])$。这意味着如果 $|r_i| \\le \\delta$，则 $\\theta_i = r_i$；如果 $|r_i|  \\delta$，则 $\\theta_i = \\delta \\cdot \\text{sign}(r_i)$。\n\n### 逐项分析\n\n-   **A. 对于平方损失，其对偶问题是 $\\max_{\\theta \\in \\mathbb{R}^n} \\; y^\\top \\theta - \\tfrac{1}{2}\\|\\theta\\|_2^2$，约束条件为 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$。KKT 条件给出 $\\theta = r := y - X\\beta$。损失共轭没有对 $\\theta$ 施加逐点界限，因此残差不受损失的逐分量限制；只有由设计矩阵施加的约束 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$ 出现在对偶可行集中。**\n    我们的推导与此陈述完全相符。对偶问题、KKT 关系以及可行集的描述都是正确的。平方损失共轭的定义域是 $\\mathbb{R}$，因此它不对 $\\theta$ 施加任何约束。\n    **结论：正确。**\n\n-   **B. 对于绝对值损失，其对偶问题是 $\\max_{\\theta \\in \\mathbb{R}^n} \\; y^\\top \\theta$，约束条件为 $\\|\\theta\\|_\\infty \\le 1$ 和 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$。KKT 条件给出 $\\theta_i \\in \\partial |r_i|$，即当 $r_i \\ne 0$ 时 $\\theta_i = \\operatorname{sign}(r_i)$，当 $r_i = 0$ 时 $\\theta_i \\in [-1,1]$。因此，损失共轭施加了逐分量界限 $\\|\\theta\\|_\\infty \\le 1$，这迫使对偶变量在残差非零时饱和在 $\\pm 1$。**\n    我们的推导与此陈述完全相符。对偶问题、KKT 关系和解释都是正确的。绝对值损失的共轭施加了约束 $\\|\\theta\\|_\\infty \\le 1$。对于非零残差，KKT 条件 $\\theta_i = \\text{sign}(r_i)$ 意味着 $\\theta_i$ 在 $\\{-1, 1\\}$ 中取值，即它饱和了。\n    **结论：正确。**\n\n-   **C. 对于参数为 $\\delta  0$ 的 Huber 损失，其对偶问题是 $\\max_{\\theta \\in \\mathbb{R}^n} \\; y^\\top \\theta - \\tfrac{1}{2}\\|\\theta\\|_2^2$，约束条件为 $\\|\\theta\\|_\\infty \\le \\delta$ 和 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$。KKT 关系是 $\\theta_i = \\mathrm{clip}(r_i,[-\\delta,\\delta])$，即当 $|r_i| \\le \\delta$ 时 $\\theta_i = r_i$，当 $|r_i|  \\delta$ 时 $\\theta_i = \\delta \\,\\operatorname{sign}(r_i)$。因此，损失共轭施加了界限 $\\|\\theta\\|_\\infty \\le \\delta$，它将对偶变量（从而也是次梯度）在水平 $\\delta$ 处进行裁剪。**\n    推导出的对偶问题和 KKT 关系与陈述中的相同。Huber 共轭确实施加了约束 $\\|\\theta\\|_\\infty \\le \\delta$。KKT 关系被正确地识别为裁剪函数。最后一句“将对偶变量...在水平 $\\delta$ 处进行裁剪”的措辞稍有不精确，因为对偶变量 $\\theta_i$ 是对残差 $r_i$ 进行裁剪的*结果*，而不是裁剪函数的输入。然而，所呈现的核心数学事实（对偶形式、KKT 方程以及由此产生的 $\\theta$ 的界限）都是正确的。在比较不同损失的背景下，这个陈述准确地描述了 Huber 损失的行为。\n    **结论：正确。**\n\n-   **D. 对于平方损失，对偶可行集必然包含约束 $\\|\\theta\\|_\\infty \\le 1$，并且 KKT 条件意味着 $\\theta_i \\in \\partial |r_i|$，因此残差分量的绝对值以 $1$ 为界。**\n    这个陈述是不正确的。约束 $\\|\\theta\\|_\\infty \\le 1$ 和 KKT 关系 $\\theta_i \\in \\partial|r_i|$ 与绝对值损失相关，而不是平方损失。\n    **结论：不正确。**\n\n-   **E. 对于绝对值损失，对偶目标是 $y^\\top \\theta - \\tfrac{1}{2}\\|\\theta\\|_2^2$，只有一个约束 $\\|\\theta\\|_\\infty \\le 1$，并且 KKT 条件给出 $\\theta = r$，这意味着 $\\|r\\|_\\infty \\le 1$。**\n    这个陈述是不正确的。绝对值损失的对偶目标是 $y^\\top \\theta$。二次项 $-\\tfrac{1}{2}\\|\\theta\\|_2^2$ 属于平方损失和 Huber 损失。此外，KKT 关系 $\\theta=r$ 属于平方损失。\n    **结论：不正确。**\n\n-   **F. 对于 Huber 损失，对偶可行集仅为 $\\|X^\\top \\theta\\|_\\infty \\le \\lambda$（对 $\\|\\theta\\|_\\infty$ 没有约束），因为 Huber 共轭处处有限，并且 KKT 条件得出 $\\theta = r$，与平方损失的情况完全相同。**\n    这个陈述是不正确的。Huber 损失的共轭并非处处有限；其定义域是 $\\{u : |u| \\le \\delta\\}$，这为对偶可行集增加了约束 $\\|\\theta\\|_\\infty \\le \\delta$。KKT 关系是 $\\theta_i = \\text{clip}(r_i, [-\\delta, \\delta])$，而不是 $\\theta=r$。\n    **结论：不正确。**",
            "answer": "$$\\boxed{ABC}$$"
        },
        {
            "introduction": "作为总结性练习，我们将把KKT条件的应用推向一个动态的视角。我们不再为固定的正则化参数 $\\lambda$ 求解一个孤立的问题，而是利用KKT条件来追踪当 $\\lambda$ 连续变化时整个解的路径。这个练习  将生动地展示LASSO是如何进行变量选择的，揭示了活动集（active set）如何随 $\\lambda$ 演化，并最终描绘出著名的分段线性解路径。",
            "id": "3456230",
            "problem": "考虑最小绝对收缩和选择算子 (LASSO) 问题，该问题旨在寻找 $x \\in \\mathbb{R}^{n}$ 以最小化目标函数\n$$\n\\frac{1}{2}\\|A x - y\\|_{2}^{2} + \\lambda \\|x\\|_{1},\n$$\n其中 $A \\in \\mathbb{R}^{m \\times n}$，$y \\in \\mathbb{R}^{m}$，且 $\\lambda \\geq 0$ 是正则化参数。假设 $A$ 的列具有单位欧几里得范数。从凸优化和卡鲁什-库恩-塔克 (KKT) 条件的基本定义出发，您将推导解路径 $x^{\\star}(\\lambda)$ 的结构，并确定 $x^{\\star}(\\lambda)$ 的支撑集发生变化的条件。\n\n设 $m = 2$ 且 $n = 2$，其中\n$$\na_{1} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}, \\quad a_{2} = \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2}\\end{pmatrix}, \\quad A = \\begin{pmatrix}1  \\frac{1}{2} \\\\ 0  \\frac{\\sqrt{3}}{2}\\end{pmatrix}, \\quad y = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}.\n$$\n$A$ 的两列都具有单位范数，且相关性为 $a_{1}^{\\top} a_{2} = \\frac{1}{2}$。定义残差 $r(\\lambda) = y - A x^{\\star}(\\lambda)$，并回顾 $\\ell_{1}$ 范数的次梯度是按分量给出的 $z_{j} \\in \\partial |x_{j}|$: 若 $x_{j} \\neq 0$，则 $z_{j} = \\operatorname{sign}(x_{j})$；若 $x_{j} = 0$，则 $z_{j} \\in [-1, 1]$。\n\n任务：\n- 推导刻画此 LASSO 问题最优性的 KKT 条件。\n- 仅使用这些条件以及凸可微目标和次梯度的基本性质，分析当 $\\lambda$ 从一个足够大的值减小到 $0$ 时，$x^{\\star}(\\lambda)$ 的支撑集和符号模式如何演变。识别出支撑集发生变化时 $\\lambda$ 的确切断点值，并确定相应的符号模式。\n- 对于给定的 $A$ 和 $y$，计算解路径 $x^{\\star}(\\lambda)$ 在整个范围 $\\lambda \\in [0, \\infty)$ 上的显式分段线性表达式。\n- 解释在每个断点处，哪些 KKT 条件变为紧致（即不等式取等号），以及为什么这些紧致事件会触发支撑集的变化。\n\n您的最终答案必须是分段定义向量 $x^{\\star}(\\lambda)$ 作为 $\\lambda$ 的函数在所有 $\\lambda \\geq 0$ 上的完整解析表达式。不需要进行数值舍入；请给出精确表达式。",
            "solution": "该问题是寻找最小绝对收缩和选择算子 (LASSO) 问题的解路径 $x^{\\star}(\\lambda)$，该问题定义为最小化以下目标函数：\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\left( \\frac{1}{2}\\|A x - y\\|_{2}^{2} + \\lambda \\|x\\|_{1} \\right)\n$$\n对于给定的数据 $A \\in \\mathbb{R}^{m \\times n}$、$y \\in \\mathbb{R}^{m}$ 以及正则化参数 $\\lambda \\ge 0$。该目标函数是凸函数，是一个可微凸函数 $f(x) = \\frac{1}{2}\\|A x - y\\|_{2}^{2}$ 和一个不可微凸函数 $g(x) = \\lambda \\|x\\|_{1}$ 的和。\n\n点 $x^{\\star}$ 成为最小值点的一阶充要条件是，零向量必须是目标函数在 $x^{\\star}$ 处次微分的元素。和的次微分是次微分的和：\n$$\n0 \\in \\partial \\left( \\frac{1}{2}\\|A x^{\\star} - y\\|_{2}^{2} + \\lambda \\|x^{\\star}\\|_{1} \\right) = \\nabla \\left( \\frac{1}{2}\\|A x^{\\star} - y\\|_{2}^{2} \\right) + \\lambda \\partial \\|x^{\\star}\\|_{1}\n$$\n最小二乘项的梯度是 $\\nabla f(x^{\\star}) = A^{T}(A x^{\\star} - y)$。设残差为 $r(x^{\\star}) = y - A x^{\\star}$。则 $\\nabla f(x^{\\star}) = -A^{T} r(x^{\\star})$。$\\ell_{1}$ 范数的次微分 $\\partial \\|x^{\\star}\\|_{1}$ 是向量 $z \\in \\mathbb{R}^{n}$ 的集合，其分量 $z_{j}$ 满足：若 $x^{\\star}_{j} \\neq 0$，则 $z_{j} = \\operatorname{sign}(x^{\\star}_{j})$；若 $x^{\\star}_{j} = 0$，则 $z_{j} \\in [-1, 1]$。\n\n因此，最优性条件为：对于某个 $z \\in \\partial \\|x^{\\star}\\|_{1}$，有 $-A^{T} r(x^{\\star}) + \\lambda z = 0$，这可以重写为 $A^{T} r(x^{\\star}) = \\lambda z$。由此可得每个分量 $j \\in \\{1, \\dots, n\\}$ 的卡鲁什-库恩-塔克 (KKT) 条件：\n1.  如果 $x^{\\star}_{j} \\neq 0$，则 $a_{j}^{T} r(x^{\\star}) = \\lambda \\operatorname{sign}(x^{\\star}_{j})$。列 $a_j$ 与残差的相关性达到最大值，且其符号与 $x^\\star_j$ 的符号一致。\n2.  如果 $x^{\\star}_{j} = 0$，则 $|a_{j}^{T} r(x^{\\star})| \\le \\lambda$。列 $a_j$ 与残差的相关性未达到最大值。\n\n我们现在将这些条件应用于具体的 $n=2$，$m=2$ 的问题，其中\n$$\nA = \\begin{pmatrix}1  \\frac{1}{2} \\\\ 0  \\frac{\\sqrt{3}}{2}\\end{pmatrix}, \\quad y = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}.\n$$\n列向量为 $a_{1} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$ 和 $a_{2} = \\begin{pmatrix}\\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2}\\end{pmatrix}$。\n\n我们追踪当 $\\lambda$ 从 $\\infty$ 减小到 $0$ 时的解路径 $x^{\\star}(\\lambda)$。\n\n**第一阶段：大的 $\\lambda$ 与第一个断点 $\\lambda_{1}$**\n对于足够大的 $\\lambda$，$\\ell_{1}$ 惩罚项非常强，使得最优解为 $x^{\\star} = 0$。此时，残差为 $r(0) = y$。对于非活跃变量（$x^{\\star}_{1}=0, x^{\\star}_{2}=0$），KKT 条件要求对 $j=1, 2$ 都有 $|a_{j}^{T} y| \\le \\lambda$。\n我们计算相关性：\n$c_{1} = a_{1}^{T} y = \\begin{pmatrix}1  0\\end{pmatrix} \\begin{pmatrix}1 \\\\ 1\\end{pmatrix} = 1$。\n$c_{2} = a_{2}^{T} y = \\begin{pmatrix}\\frac{1}{2}  \\frac{\\sqrt{3}}{2}\\end{pmatrix} \\begin{pmatrix}1 \\\\ 1\\end{pmatrix} = \\frac{1+\\sqrt{3}}{2}$。\n只要 $\\lambda \\ge |c_1|$ 且 $\\lambda \\ge |c_2|$，解 $x^{\\star}=0$ 就是最优的。由于 $\\frac{1+\\sqrt{3}}{2} \\approx 1.366  1$，此条件在 $\\lambda \\ge \\frac{1+\\sqrt{3}}{2}$ 时成立。\n第一个断点 $\\lambda_1$ 出现在解从 $0$ 开始转变时。这发生在使得某个非活跃变量的 KKT 条件变为等式的最大 $\\lambda$ 值处：\n$\\lambda_{1} = \\max_{j} |a_{j}^{T} y| = \\frac{1+\\sqrt{3}}{2}$。\n在 $\\lambda = \\lambda_{1}$ 处，条件 $|a_{2}^{T} r| \\le \\lambda$ 变为紧致。对于 $\\lambda  \\lambda_{1}$，$x_2$ 必须变为非零以保持最优性。$x_2$ 的符号将是 $\\operatorname{sign}(a_{2}^{T} y) = +1$。\n因此，对于 $\\lambda \\in [\\frac{1+\\sqrt{3}}{2}, \\infty)$，$x^{\\star}(\\lambda) = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$。\n\n**第二阶段：$\\lambda \\in [\\lambda_{2}, \\lambda_{1})$ 与第二个断点 $\\lambda_{2}$**\n在此 $\\lambda$ 范围内，活跃索引集为 $\\mathcal{A}=\\{2\\}$，因此 $x_{1}=0$ 且 $x_{2}  0$。KKT 条件为：\n-   $|a_{1}^{T} r(x^{\\star})| \\le \\lambda$ (对于 $x_{1}=0$)\n-   $a_{2}^{T} r(x^{\\star}) = \\lambda$ (对于 $x_{2}0$)\n这里 $x^{\\star} = (0, x_{2})^{T}$，所以 $A x^{\\star} = a_{2} x_{2}$。第二个条件给出 $a_{2}^{T}(y - a_{2} x_{2}) = \\lambda$。由于 $\\|a_{2}\\|_{2}=1$，所以 $a_{2}^{T} a_{2}=1$。这可以简化为 $a_{2}^{T} y - x_{2} = \\lambda$。\n解出 $x_{2}$：$x_{2}(\\lambda) = a_{2}^{T} y - \\lambda = \\frac{1+\\sqrt{3}}{2} - \\lambda$。对于 $\\lambda  \\lambda_{1}$，此值为正。\n现在我们检查非活跃变量 $x_1$ 的条件：\n$a_{1}^{T} r(x^{\\star}) = a_{1}^{T} (y - a_{2} x_{2}(\\lambda)) = a_{1}^{T} y - (a_{1}^{T} a_{2}) x_{2}(\\lambda)$。\n我们有 $a_{1}^{T} y = 1$ 和 $a_{1}^{T} a_{2} = \\frac{1}{2}$。\n$a_{1}^{T} r(x^{\\star}) = 1 - \\frac{1}{2}\\left(\\frac{1+\\sqrt{3}}{2} - \\lambda\\right) = 1 - \\frac{1+\\sqrt{3}}{4} + \\frac{\\lambda}{2} = \\frac{3-\\sqrt{3}}{4} + \\frac{\\lambda}{2}$。\n条件是 $|\\frac{3-\\sqrt{3}}{4} + \\frac{\\lambda}{2}| \\le \\lambda$。由于 $3  \\sqrt{3}$ 且 $\\lambda0$，绝对值内的表达式为正。\n$\\frac{3-\\sqrt{3}}{4} + \\frac{\\lambda}{2} \\le \\lambda \\implies \\frac{3-\\sqrt{3}}{4} \\le \\frac{\\lambda}{2} \\implies \\lambda \\ge \\frac{3-\\sqrt{3}}{2}$。\n这个解在 $\\lambda \\in [\\frac{3-\\sqrt{3}}{2}, \\frac{1+\\sqrt{3}}{2})$ 区间内有效。下一个断点 $\\lambda_2$ 出现在这个不等式变为紧致时：\n$\\lambda_{2} = \\frac{3-\\sqrt{3}}{2}$。\n在 $\\lambda=\\lambda_2$ 处，$|a_{1}^{T} r| = \\lambda_2$，表明 $x_1$ 进入模型。它的符号将是 $\\operatorname{sign}(a_{1}^{T} r(\\lambda_2)) = \\operatorname{sign}(\\lambda_2) = +1$。\n\n**第三阶段：$\\lambda \\in [0, \\lambda_{2})$**\n对于 $\\lambda  \\lambda_2$，活跃集为 $\\mathcal{A}=\\{1, 2\\}$，其中 $x_{1}0, x_{2}0$。两个 KKT 条件都为等式：\n-   $a_{1}^{T} (y - A x^{\\star}) = \\lambda$\n-   $a_{2}^{T} (y - A x^{\\star}) = \\lambda$\n这构成一个线性系统：$A^{T} (y - A x^{\\star}) = \\lambda \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，或 $A^{T} A x^{\\star} = A^{T} y - \\lambda \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$。\n解为 $x^{\\star}(\\lambda) = (A^{T}A)^{-1} \\left( A^{T}y - \\lambda \\begin{pmatrix}1 \\\\ 1\\end{pmatrix} \\right)$。\n首先，我们计算所需的矩阵：\n$A^{T}A = \\begin{pmatrix}1  0 \\\\ \\frac{1}{2}  \\frac{\\sqrt{3}}{2}\\end{pmatrix} \\begin{pmatrix}1  \\frac{1}{2} \\\\ 0  \\frac{\\sqrt{3}}{2}\\end{pmatrix} = \\begin{pmatrix}1  \\frac{1}{2} \\\\ \\frac{1}{2}  1\\end{pmatrix}$。\n$(A^{T}A)^{-1} = \\frac{1}{1 - 1/4} \\begin{pmatrix}1  -\\frac{1}{2} \\\\ -\\frac{1}{2}  1\\end{pmatrix} = \\frac{4}{3} \\begin{pmatrix}1  -\\frac{1}{2} \\\\ -\\frac{1}{2}  1\\end{pmatrix} = \\begin{pmatrix}\\frac{4}{3}  -\\frac{2}{3} \\\\ -\\frac{2}{3}  \\frac{4}{3}\\end{pmatrix}$。\n$A^{T}y = \\begin{pmatrix}1 \\\\ \\frac{1+\\sqrt{3}}{2}\\end{pmatrix}$。\n现在我们求解 $x^{\\star}(\\lambda)$：\n$x^{\\star}(\\lambda) = \\begin{pmatrix}\\frac{4}{3}  -\\frac{2}{3} \\\\ -\\frac{2}{3}  \\frac{4}{3}\\end{pmatrix} \\left( \\begin{pmatrix}1 \\\\ \\frac{1+\\sqrt{3}}{2}\\end{pmatrix} - \\begin{pmatrix}\\lambda \\\\ \\lambda\\end{pmatrix} \\right) = \\begin{pmatrix}\\frac{4}{3}  -\\frac{2}{3} \\\\ -\\frac{2}{3}  \\frac{4}{3}\\end{pmatrix} \\begin{pmatrix}1-\\lambda \\\\ \\frac{1+\\sqrt{3}}{2}-\\lambda\\end{pmatrix}$。\n各分量为：\n$x_{1}(\\lambda) = \\frac{4}{3}(1-\\lambda) - \\frac{2}{3}(\\frac{1+\\sqrt{3}}{2}-\\lambda) = \\frac{4}{3} - \\frac{4}{3}\\lambda - \\frac{1+\\sqrt{3}}{3} + \\frac{2}{3}\\lambda = \\frac{3-\\sqrt{3}}{3} - \\frac{2}{3}\\lambda = 1 - \\frac{\\sqrt{3}}{3} - \\frac{2}{3}\\lambda$。\n$x_{2}(\\lambda) = -\\frac{2}{3}(1-\\lambda) + \\frac{4}{3}(\\frac{1+\\sqrt{3}}{2}-\\lambda) = -\\frac{2}{3} + \\frac{2}{3}\\lambda + \\frac{2+2\\sqrt{3}}{3} - \\frac{4}{3}\\lambda = \\frac{2\\sqrt{3}}{3} - \\frac{2}{3}\\lambda$。\n只要 $x_{1}(\\lambda)0$ 且 $x_{2}(\\lambda)0$，这个解就有效。\n$x_{1}(\\lambda)  0 \\implies 1 - \\frac{\\sqrt{3}}{3}  \\frac{2}{3}\\lambda \\implies \\lambda  \\frac{3-\\sqrt{3}}{2} = \\lambda_{2}$。\n$x_{2}(\\lambda)  0 \\implies \\frac{2\\sqrt{3}}{3}  \\frac{2}{3}\\lambda \\implies \\lambda  \\sqrt{3}$。\n由于 $\\lambda_2  \\sqrt{3}$，所以 $x^{\\star}(\\lambda)$ 的表达式在 $\\lambda \\in [0, \\lambda_2)$ 内有效。当 $\\lambda \\to 0$ 时，$x^{\\star}(\\lambda)$ 趋近于普通最小二乘解。没有其他断点出现。\n\n对于 $\\lambda \\ge 0$ 的完整解路径 $x^{\\star}(\\lambda)$ 是一个定义在三个区间上的分段线性函数。\n令 $\\lambda_{1} = \\frac{1+\\sqrt{3}}{2}$ 且 $\\lambda_{2} = \\frac{3-\\sqrt{3}}{2}$：\n- 当 $\\lambda \\ge \\lambda_{1}$ 时，支撑集为 $\\emptyset$。\n- 当 $\\lambda \\in [\\lambda_{2}, \\lambda_{1})$ 时，支撑集为 $\\{2\\}$。\n- 当 $\\lambda \\in [0, \\lambda_{2})$ 时，支撑集为 $\\{1, 2\\}$。\n\n$x^{\\star}(\\lambda)$ 的表达式由这三段组合而成。",
            "answer": "$$\n\\boxed{\nx^{\\star}(\\lambda) = \n\\begin{cases}\n\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}   \\text{当 } \\lambda \\ge \\frac{1+\\sqrt{3}}{2} \\\\\n\\begin{pmatrix} 0 \\\\ \\frac{1+\\sqrt{3}}{2} - \\lambda \\end{pmatrix}   \\text{当 } \\frac{3-\\sqrt{3}}{2} \\le \\lambda  \\frac{1+\\sqrt{3}}{2} \\\\\n\\begin{pmatrix} 1 - \\frac{\\sqrt{3}}{3} - \\frac{2}{3}\\lambda \\\\ \\frac{2\\sqrt{3}}{3} - \\frac{2}{3}\\lambda \\end{pmatrix}   \\text{当 } 0 \\le \\lambda  \\frac{3-\\sqrt{3}}{2}\n\\end{cases}\n}\n$$"
        }
    ]
}