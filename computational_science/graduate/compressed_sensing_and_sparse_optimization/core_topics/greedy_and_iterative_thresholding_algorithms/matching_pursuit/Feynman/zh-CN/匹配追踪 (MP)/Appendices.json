{
    "hands_on_practices": [
        {
            "introduction": "匹配追踪 (Matching Pursuit) 算法的直观吸引力在于其贪婪地、迭代地选择与残差最相关原子的策略。然而，该算法的性能在很大程度上取决于字典的几何结构。本练习将构建一个“病态”字典，以揭示一种经典的算法失败模式：即使在最简单的二维空间中，由于原子间的高度相关性和不规范化，算法也可能在一次又一次的迭代中重复选择同一个原子，导致残差无法有效收敛。通过这个具体的例子，我们将亲手计算并观察到算法是如何被“困住”的，从而深刻理解字典属性对贪婪算法行为的决定性影响。",
            "id": "3458955",
            "problem": "考虑一个实希尔伯特空间 $\\mathcal{H} = \\mathbb{R}^{2}$，其具有标准欧几里得内积 $\\langle x, y \\rangle = x^{\\top} y$ 和诱导范数 $\\|x\\|_{2} = \\sqrt{\\langle x, x \\rangle}$。一个字典是 $\\mathcal{H}$ 中原子（向量）的集合 $\\mathcal{D} = \\{ g_{j} \\}_{j}$。在匹配追踪（Matching Pursuit）算法中，给定第 $t$ 次迭代时的残差 $r^{(t)}$，选择一个使内积的绝对值最大化的索引 $j_{t}$，即 $j_{t} \\in \\arg\\max_{j} |\\langle r^{(t)}, g_{j} \\rangle|$，并通过 $r^{(t+1)} = r^{(t)} - \\langle r^{(t)}, g_{j_{t}} \\rangle g_{j_{t}}$ 更新残差。\n\n按如下方式构造一个字典和信号。令 $u = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $v = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。固定一个标量 $\\alpha > 1$，并定义字典 $\\mathcal{D} = \\{ g_{1}, g_{2} \\}$，其中 $g_{1} = \\alpha u$ 且 $g_{2} = v$。设初始信号为 $x = u$，因此初始残差为 $r^{(0)} = x$。\n\n从上述基本定义出发，分析针对此字典和信号的匹配追踪迭代过程。从第一性原理出发，证明对于所有 $t \\geq 0$，所选索引始终为 $j_{t} = 1$，因此支撑集永远不会超出第一个元素。通过推导 $k$ 次迭代后残差 $r^{(k)}$ 及其欧几里得范数 $\\| r^{(k)} \\|_{2}$ 关于 $\\alpha$ 和 $k$ 的闭式表达式，来展示迭代过程中残差的精确行为。你最终报告的量必须是 $\\| r^{(k)} \\|_{2}$ 作为 $\\alpha$ 和 $k$ 的函数的闭式表达式。无需四舍五入。",
            "solution": "我们从指定的希尔伯特空间 $\\mathcal{H} = \\mathbb{R}^{2}$ 开始，其内积为标准内积 $\\langle x, y \\rangle = x^{\\top} y$，范数为 $\\|x\\|_{2} = \\sqrt{\\langle x, x \\rangle}$。字典为 $\\mathcal{D} = \\{ g_{1}, g_{2} \\}$，其中 $g_{1} = \\alpha u$ 且 $g_{2} = v$，而 $u = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，$v = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。初始残差为 $r^{(0)} = x = u$。\n\n在第 $t$ 次迭代时，匹配追踪的选择规则是\n$$\nj_{t} \\in \\arg\\max_{j \\in \\{1,2\\}} \\left| \\langle r^{(t)}, g_{j} \\rangle \\right|,\n$$\n残差更新规则是\n$$\nr^{(t+1)} = r^{(t)} - \\langle r^{(t)}, g_{j_{t}} \\rangle g_{j_{t}}.\n$$\n\n我们将用归纳法证明，对于所有 $t \\geq 0$，残差始终与 $u$ 共线，即存在一个标量 $\\beta_{t}$ 使得 $r^{(t)} = \\beta_{t} u$，并且在每次迭代中所选的索引都是 $j_{t} = 1$。这将意味着支撑集永远不会扩展到第一个原子 $g_{1}$ 之外。\n\n基础情况 ($t = 0$)：我们有 $r^{(0)} = u = 1 \\cdot u$，所以形式 $r^{(0)} = \\beta_{0} u$ 成立，其中 $\\beta_{0} = 1$。\n\n在 $t=0$ 时的选择：\n- 与 $g_{1}$ 的相关性为\n$$\n\\left| \\langle r^{(0)}, g_{1} \\rangle \\right| = \\left| \\langle u, \\alpha u \\rangle \\right| = \\left| \\alpha \\langle u, u \\rangle \\right| = \\alpha,\n$$\n因为 $\\|u\\|_{2} = 1$。\n- 与 $g_{2}$ 的相关性为\n$$\n\\left| \\langle r^{(0)}, g_{2} \\rangle \\right| = \\left| \\langle u, v \\rangle \\right| = \\left| 0 \\right| = 0,\n$$\n因为 $u$ 和 $v$ 是正交的。\n\n因此 $j_{0} = 1$ 是唯一的最大化索引，因为 $\\alpha > 1$ 意味着 $\\alpha > 0$。\n\n在 $t=0$ 时的残差更新：\n$$\nr^{(1)} = r^{(0)} - \\langle r^{(0)}, g_{1} \\rangle g_{1} = u - \\langle u, \\alpha u \\rangle \\alpha u = u - (\\alpha)(\\alpha u) = u - \\alpha^{2} u = (1 - \\alpha^{2}) u.\n$$\n因此 $r^{(1)}$ 与 $u$ 共线，即 $r^{(1)} = \\beta_{1} u$，其中 $\\beta_{1} = 1 - \\alpha^{2}$。\n\n归纳步骤：假设对于某个 $t \\geq 1$，我们有 $r^{(t)} = \\beta_{t} u$，其中 $\\beta_{t}$ 是一个标量。那么在第 $t$ 次迭代时的相关性为\n$$\n\\left| \\langle r^{(t)}, g_{1} \\rangle \\right| = \\left| \\langle \\beta_{t} u, \\alpha u \\rangle \\right| = \\left| \\beta_{t} \\alpha \\langle u, u \\rangle \\right| = \\left| \\beta_{t} \\alpha \\right|,\n$$\n和\n$$\n\\left| \\langle r^{(t)}, g_{2} \\rangle \\right| = \\left| \\langle \\beta_{t} u, v \\rangle \\right| = \\left| \\beta_{t} \\langle u, v \\rangle \\right| = 0.\n$$\n因此 $j_{t} = 1$ 仍然是最大化索引。残差更新得出\n$$\nr^{(t+1)} = r^{(t)} - \\langle r^{(t)}, g_{1} \\rangle g_{1} = \\beta_{t} u - \\left( \\beta_{t} \\alpha \\right) \\alpha u = \\beta_{t} u - \\beta_{t} \\alpha^{2} u = \\beta_{t} (1 - \\alpha^{2}) u.\n$$\n因此 $r^{(t+1)} = \\beta_{t+1} u$，其中 $\\beta_{t+1} = \\beta_{t} (1 - \\alpha^{2})$。\n\n通过归纳法，对于所有 $k \\geq 0$，\n$$\nr^{(k)} = \\beta_{k} u \\quad \\text{其中} \\quad \\beta_{k} = (1 - \\alpha^{2})^{k}.\n$$\n因此，支撑集永远不会超出第一个元素，因为对于所有的 $t$，都有 $j_{t} = 1$。\n\n最后，经过 $k$ 次迭代后残差的欧几里得范数是\n$$\n\\| r^{(k)} \\|_{2} = \\| \\beta_{k} u \\|_{2} = | \\beta_{k} | \\| u \\|_{2} = | 1 - \\alpha^{2} |^{k} \\cdot 1 = | 1 - \\alpha^{2} |^{k}.\n$$\n由于 $\\alpha > 1$，我们有 $|1 - \\alpha^{2}| = \\alpha^{2} - 1$，因此\n$$\n\\| r^{(k)} \\|_{2} = (\\alpha^{2} - 1)^{k}.\n$$\n这明确地展示了迭代过程中的残差行为，并表明对于这个病态的、非归一化的字典，匹配追踪选择永远不会在第一个元素之外添加新的支撑集元素。",
            "answer": "$$\\boxed{(\\alpha^{2}-1)^{k}}$$"
        },
        {
            "introduction": "在上一个练习的基础上，我们将探讨一个更微妙但却非常著名的反例，它揭示了贪婪算法的深层次局限性。本练习构建了一个场景，在该场景中，匹配追踪在第一步就做出了错误的选择——挑选了一个不属于真实信号支撑集的原子——尽管该字典满足一个看似良好的“受限等距性质 (Restricted Isometry Property, RIP)”条件。这个实践旨在阐明，为什么相互干涉性 (mutual coherence) 是预测贪婪选择成功与否的更直接指标，而满足某些RIP条件本身并不足以保证贪婪算法能够成功识别正确的原子。",
            "id": "3458968",
            "problem": "考虑一个传感矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其列为单位范数列，以及一个 $k$-稀疏信号 $x^{\\star} \\in \\mathbb{R}^{n}$，其支撑集 $S \\subset \\{1,2,\\dots,n\\}$ 满足 $|S|=k$。设匹配追踪（MP）为一个贪婪过程，在第一次迭代中，它选择与残差 $r^{(0)}=y$（其中 $y = A x^{\\star}$）的内积绝对值最大的 $A$ 的列。将互相关性（MC）$\\mu(A)$ 定义为 $\\mu(A)=\\max_{i \\neq j} |\\langle a_{i}, a_{j} \\rangle|$，将阶数为 $s$ 的限制等距性质（RIP）常数 $\\delta_{s}$ 定义为最小的非负数，使得对于所有 $s$-稀疏向量 $z$，都有 $(1-\\delta_{s})\\|z\\|_{2}^{2} \\leq \\|A z\\|_{2}^{2} \\leq (1+\\delta_{s})\\|z\\|_{2}^{2}$，以及将限制正交常数 $\\theta_{s,t}$ 定义为最小的非负数，使得对于所有支撑集不相交且 $| \\operatorname{supp}(u) | \\leq s$，$| \\operatorname{supp}(v) | \\leq t$ 的向量 $u,v$，都有 $|\\langle A u, A v \\rangle| \\leq \\theta_{s,t} \\|u\\|_{2} \\|v\\|_{2}$。已知 $\\theta_{s,t} \\leq \\delta_{s+t}$。\n\n按如下方式构造 $A$ 和 $x^{\\star}$：\n- 设 $S$ 是一个包含 $k$ 个索引的集合，且 $\\{a_{i}\\}_{i \\in S}$ 是 $A$ 的正交归一列，即对于所有 $i \\in S$，当 $i \\neq j$ 时 $\\langle a_{i}, a_{j} \\rangle = 0$，且 $\\|a_{i}\\|_{2}=1$。\n- 设存在一个索引 $\\ell \\notin S$，使得 $a_{\\ell} = \\frac{1}{\\sqrt{k}} \\sum_{i \\in S} a_{i}$。\n- 设对于所有 $i \\in S$，$x^{\\star}_{i} = \\alpha$（其中 $\\alpha > 0$），而对于所有 $j \\notin S$，$x^{\\star}_{j} = 0$。\n\n任务：\n1. 使用上述定义，根据与 $y$ 的内积推导出MP的首次迭代选择准则，并证明对于你所构造的情况，MP会选择 $a_{\\ell}$ 而不是任何 $i \\in S$ 的 $a_{i}$。\n2. 计算你所构造的 $A$ 的限制等距性质常数 $\\delta_{k}$ 和限制等距性质常数 $\\delta_{k+1}$。确定它们的值。\n3. 计算你所构造的 $A$ 的互相关性 $\\mu(A)$。\n4. 一个标准的、基于相关性的、用于MP在首次迭代中选择正确原子（在等幅情况下）的充分条件可以写成关于 $\\mu(A)$ 和 $k$ 的形式：$\\mu(A)  \\frac{1}{2k-1}$。定义因子\n$$\nG(k) \\triangleq \\frac{\\mu(A)}{\\frac{1}{2k-1}},\n$$\n该因子量化了你所构造的矩阵的实际互相关性比基于相关性的成功阈值大多少。提供一个关于 $k$ 的 $G(k)$ 的闭式表达式。\n\n你的最终答案必须是 $G(k)$ 的解析表达式，以精确形式写出。不需要四舍五入，也不涉及单位。",
            "solution": "问题陈述被评估为是有效的，因为它在压缩感知理论中有科学依据，是适定的，具有明确的目标，并且内部一致。所提供的定义和构造的实体在分析如匹配追踪等贪婪算法时是标准的。这种构造是一个著名的反例，用来说明此类算法的局限性。我们将按照概述的四个任务进行。\n\n所提供的构造隐含地要求稀疏度 $k$ 大于1。如果 $k=1$，设 $S=\\{j\\}$。根据构造，$a_\\ell = \\frac{1}{\\sqrt{1}} \\sum_{i \\in \\{j\\}} a_i = a_j$。然而，问题指明 $\\ell \\notin S$，这导致了 $\\ell \\neq j$ 和 $\\ell=j$ 的矛盾。因此，我们必须有 $k > 1$。\n\n**任务1：匹配追踪的首次迭代选择**\n\n匹配追踪（MP）算法在第一次迭代时，选择一个与测量向量 $y$ 最相关的原子（即 $A$ 的一列）。选择准则是找到使内积 $|\\langle a_j, y \\rangle|$ 的绝对值最大的索引 $j$。初始残差为 $r^{(0)} = y$。\n\n测量向量 $y$ 由 $y = A x^{\\star}$ 给出。考虑到 $x^{\\star}$ 的结构，其非零项仅存在于支撑集 $S$ 上，我们可以写出：\n$$\ny = \\sum_{j=1}^{n} x^{\\star}_j a_j = \\sum_{i \\in S} x^{\\star}_i a_i\n$$\n因为对于所有 $i \\in S$，$x^{\\star}_i = \\alpha$，这可以简化为：\n$$\ny = \\sum_{i \\in S} \\alpha a_i = \\alpha \\sum_{i \\in S} a_i\n$$\n现在，我们分两种情况计算内积：当原子在真实支撑集 $S$ 中时，以及当原子是构造的错误原子 $a_{\\ell}$ 时。\n\n情况1：原子 $a_j$ 在支撑集中，即 $j \\in S$。\n内积为：\n$$\n\\langle a_j, y \\rangle = \\left\\langle a_j, \\alpha \\sum_{i \\in S} a_i \\right\\rangle = \\alpha \\sum_{i \\in S} \\langle a_j, a_i \\rangle\n$$\n根据构造，列集合 $\\{a_i\\}_{i \\in S}$ 是正交归一的。这意味着 $\\langle a_j, a_i \\rangle = \\delta_{ji}$，其中 $\\delta_{ji}$ 是克罗内克δ函数。因此，求和简化为 $i=j$ 的那一项：\n$$\n\\langle a_j, y \\rangle = \\alpha \\langle a_j, a_j \\rangle = \\alpha \\|a_j\\|_2^2\n$$\n由于 $A$ 的所有列都是单位范数的，$\\|a_j\\|_2 = 1$。因此，对于任何 $j \\in S$：\n$$\n|\\langle a_j, y \\rangle| = \\alpha\n$$\n\n情况2：原子是 $a_{\\ell}$，其中 $\\ell \\notin S$。\n内积为：\n$$\n\\langle a_{\\ell}, y \\rangle = \\left\\langle a_{\\ell}, \\alpha \\sum_{i \\in S} a_i \\right\\rangle\n$$\n代入 $a_{\\ell} = \\frac{1}{\\sqrt{k}} \\sum_{j \\in S} a_j$ 的定义：\n$$\n\\langle a_{\\ell}, y \\rangle = \\left\\langle \\frac{1}{\\sqrt{k}} \\sum_{j \\in S} a_j, \\alpha \\sum_{i \\in S} a_i \\right\\rangle = \\frac{\\alpha}{\\sqrt{k}} \\left\\langle \\sum_{j \\in S} a_j, \\sum_{i \\in S} a_i \\right\\rangle\n$$\n内积项为 $\\left\\langle \\sum_{j \\in S} a_j, \\sum_{i \\in S} a_i \\right\\rangle = \\sum_{j \\in S} \\sum_{i \\in S} \\langle a_j, a_i \\rangle = \\sum_{j \\in S} \\sum_{i \\in S} \\delta_{ji} = \\sum_{j \\in S} 1 = k$。\n所以，内积变为：\n$$\n\\langle a_{\\ell}, y \\rangle = \\frac{\\alpha}{\\sqrt{k}} \\cdot k = \\alpha \\sqrt{k}\n$$\n其幅值为：\n$$\n|\\langle a_{\\ell}, y \\rangle| = \\alpha \\sqrt{k}\n$$\n为了证明MP选择了 $a_{\\ell}$，我们比较它们的幅值。我们必须证明 $|\\langle a_{\\ell}, y \\rangle|  |\\langle a_j, y \\rangle|$ 对于 $j \\in S$ 成立。\n$$\n\\alpha \\sqrt{k}  \\alpha\n$$\n由于 $\\alpha  0$，我们可以两边除以 $\\alpha$ 得到 $\\sqrt{k}  1$，这对所有 $k1$ 都成立。如前所述，问题设置要求 $k1$。因此，MP会选择错误的原子 $a_{\\ell}$，而不是真实支撑集 $S$ 中的任何正确原子 $a_j$。\n\n**任务2：RIP常数的计算**\n\n矩阵 $A$ 的性质由其构造的列决定。我们分析由 $k+1$ 个列 $\\{a_i\\}_{i \\in S} \\cup \\{a_\\ell\\}$ 组成的子矩阵 $A'$。RIP常数由 $A'$ 的子矩阵的格拉姆矩阵的特征值决定。\n\n计算 $\\delta_k$：\n常数 $\\delta_k$ 由所有 $k \\times k$ 格拉姆子矩阵的极值特征值定义。我们考虑两种大小为 $k$ 的子矩阵：\n1. 由列 $\\{a_i\\}_{i \\in S}$ 组成的子矩阵 $A_S$。其格拉姆矩阵为 $A_S^T A_S = I_k$，因为这些列是正交归一的。所有特征值都为1。\n2. 任何通过用 $a_\\ell$ 替换 $A_S$ 中的一列 $a_j$ 而形成的子矩阵 $A_{T_j}$。设对于任何 $j \\in S$，$T_j = (S \\setminus \\{j\\}) \\cup \\{\\ell\\}$。格拉姆矩阵 $G_{T_j} = A_{T_j}^T A_{T_j}$ 的元素为 $\\langle a_p, a_q \\rangle$（对于 $p, q \\in T_j$）。这些内积为 $\\langle a_p, a_q \\rangle = \\delta_{pq}$（对于 $p,q \\in S \\setminus \\{j\\}$），$\\|a_\\ell\\|_2^2=1$，以及对于 $p \\in S \\setminus \\{j\\}$，$\\langle a_p, a_\\ell \\rangle = \\langle a_p, \\frac{1}{\\sqrt{k}} \\sum_{i \\in S} a_i \\rangle = \\frac{1}{\\sqrt{k}}$。\n格拉姆矩阵的形式为 $G = \\begin{pmatrix} I_{k-1}  \\mathbf{v} \\\\ \\mathbf{v}^T  1 \\end{pmatrix}$，其中 $\\mathbf{v}$ 是一个大小为 $k-1$ 的向量，所有元素都等于 $1/\\sqrt{k}$。该矩阵的特征值为 1（重数为 $k-2$）和 $1 \\pm \\|\\mathbf{v}\\|_2$。这里，$\\|\\mathbf{v}\\|_2^2 = (k-1) (1/\\sqrt{k})^2 = \\frac{k-1}{k}$。所以另外两个特征值是 $1 \\pm \\sqrt{\\frac{k-1}{k}}$。\n为了找到 $\\delta_k$，我们取所有 $k \\times k$ 子矩阵的最极端的特征值。\n$1+\\delta_k = \\max(1, 1+\\sqrt{\\frac{k-1}{k}}) = 1+\\sqrt{\\frac{k-1}{k}}$。\n$1-\\delta_k = \\min(1, 1-\\sqrt{\\frac{k-1}{k}}) = 1-\\sqrt{\\frac{k-1}{k}}$。\n两个方程都得出 $\\delta_k = \\sqrt{\\frac{k-1}{k}}$。\n\n计算 $\\delta_{k+1}$：\n只有一个大小为 $k+1$ 的子矩阵，即 $A'$ 本身。我们需要其格拉姆矩阵 $G' = (A')^T A'$ 的特征值。设列的顺序为 $\\{a_i\\}_{i \\in S}$，后跟 $a_\\ell$。格拉姆矩阵为 $G' = \\begin{pmatrix} I_k  \\mathbf{c} \\\\ \\mathbf{c}^T  1 \\end{pmatrix}$，其中 $\\mathbf{c}$ 是一个大小为 $k$ 的向量，其元素为 $\\langle a_i, a_\\ell \\rangle = 1/\\sqrt{k}$（对于 $i \\in S$）。\n特征值为 1（重数为 $k-1$）和 $1 \\pm \\|\\mathbf{c}\\|_2$。这里，$\\|\\mathbf{c}\\|_2^2 = k (1/\\sqrt{k})^2 = 1$。另外两个特征值是 $1 \\pm 1$，即 2 和 0。\n$G'$ 的特征值为 2（重数为1）、0（重数为1）和 1（重数为 $k-1$）。\n那么 $1+\\delta_{k+1} = \\lambda_{\\max}(G') = 2$，这给出 $\\delta_{k+1}=1$。\n并且 $1-\\delta_{k+1} = \\lambda_{\\min}(G') = 0$，这也给出 $\\delta_{k+1}=1$。\n因此，$\\delta_{k+1}=1$。这表示在 $A$ 的零空间中存在一个非零的 $(k+1)$-稀疏向量。\n\n**任务3：互相关性的计算**\n\n互相关性 $\\mu(A)$ 是 $A$ 的不同列之间内积绝对值的最大值。我们为构造的列计算这个值。\n我们检查集合 $\\{a_i\\}_{i \\in S} \\cup \\{a_\\ell\\}$ 中列对之间的内积。\n1. 对于不同的 $i,j \\in S$：由于正交归一性，$|\\langle a_i, a_j \\rangle| = |0| = 0$。\n2. 对于任何 $i \\in S$：\n$$\n|\\langle a_i, a_\\ell \\rangle| = \\left| \\left\\langle a_i, \\frac{1}{\\sqrt{k}} \\sum_{j \\in S} a_j \\right\\rangle \\right| = \\left| \\frac{1}{\\sqrt{k}} \\sum_{j \\in S} \\langle a_i, a_j \\rangle \\right| = \\left| \\frac{1}{\\sqrt{k}} \\langle a_i, a_i \\rangle \\right| = \\frac{1}{\\sqrt{k}}\n$$\n这些值的最大值决定了所构造子矩阵的互相关性。\n$$\n\\mu(A) = \\max(\\{0, \\frac{1}{\\sqrt{k}}\\}) = \\frac{1}{\\sqrt{k}}\n$$\n\n**任务4：因子 G(k) 的计算**\n\n问题将因子 $G(k)$ 定义为我们构造的矩阵的实际互相关性与一个标准的MP成功充分条件阈值的比率：\n$$\nG(k) \\triangleq \\frac{\\mu(A)}{\\frac{1}{2k-1}}\n$$\n使用我们在任务3中找到的 $\\mu(A)$ 的值：\n$$\nG(k) = \\frac{\\frac{1}{\\sqrt{k}}}{\\frac{1}{2k-1}} = \\frac{2k-1}{\\sqrt{k}}\n$$\n这就是 $G(k)$ 的闭式表达式。",
            "answer": "$$\n\\boxed{\\frac{2k-1}{\\sqrt{k}}}\n$$"
        },
        {
            "introduction": "理论模型通常是无噪声的，但实际应用必须面对测量噪声的挑战。本练习将我们的关注点从理想化的无噪声世界转移到充满噪声的现实场景中，并提出了一个根本性问题：当存在噪声时，我们如何区分由真实信号引起的相关性与由随机波动产生的相关性？通过本练习，您将从第一性原理出发，推导出一个基于统计原理的阈值 $t$，用于判断何时应停止算法的迭代。这个阈值是避免算法“过拟合”噪声、确保恢复结果可靠性的关键工具。",
            "id": "3458934",
            "problem": "考虑压缩感知和稀疏优化中的一个含噪线性模型，该模型由 $y = D x^\\star + w$ 给出，其中 $D \\in \\mathbb{R}^{m \\times p}$ 的列原子 $\\{d_j\\}_{j=1}^p$ 对所有 $j \\in \\{1,\\dots,p\\}$ 满足 $\\|d_j\\|_2 = 1$，且 $w \\sim \\mathcal{N}(0,\\sigma^2 I_m)$ 是方差参数为 $\\sigma^2 > 0$ 的高斯噪声。在诸如匹配追踪 (Matching Pursuit, MP) 等贪婪选择规则的第一步中，我们会考虑统计量 $M := \\max_{1 \\le j \\le p} |\\langle w, d_j \\rangle|$ 来评估纯噪声相关性的大小。您的目标是刻画 $M$ 的分布规律，并推导出一个能够控制错误选择的高概率停止阈值。\n\n仅从关于高斯向量及其线性泛函的基本事实出发，并且除了所述的归一化之外，不假设任何特殊结构，完成以下任务：\n\n1. 证明对于每个 $j$，标量 $\\langle w, d_j \\rangle$ 是一个均值为零、方差为 $\\sigma^2$ 的高斯变量，并通过协方差 $\\mathrm{Cov}(\\langle w, d_i \\rangle, \\langle w, d_j \\rangle)$ 确定不同索引 $j$ 之间的依赖结构。\n\n2. 在原子是标准正交的特殊情况下，即 $D^\\top D = I_p$，因此这些标量是独立的，推导 $M$ 的精确累积分布函数。\n\n3. 对于一个通用的归一化字典 $D$（不一定是标准正交的），使用高斯最大值原理和基本的概率不等式，得出一个形式为 $\\mathbb{P}(M \\ge t) \\le \\varepsilon(t)$ 的通用界，该界不依赖于 $D$ 的具体相关性，并求解满足 $\\mathbb{P}(M \\ge t) \\le \\delta$ 的最小 $t$ 的闭式解，其中 $\\delta \\in (0,1)$ 是用户指定的容差。将这个 $t$ 解释为纯噪声的 MP 停止阈值。\n\n以通用阈值 $t$ 关于 $\\sigma$、$p$ 和 $\\delta$ 的显式符号表达式的形式给出最终答案。不需要进行数值计算。最终答案中不要包含任何不等式；只报告 $t(\\sigma,p,\\delta)$ 的闭式解。",
            "solution": "问题陈述在稀疏优化和压缩感知领域提供了一个有效、适定且有科学依据的问题。我们可以进行完整解答。\n\n问题要求对统计量 $M := \\max_{1 \\le j \\le p} |\\langle w, d_j \\rangle|$ 进行三部分分析，其中 $w$ 是一个高斯噪声向量。我们定义随机变量 $Z_j := \\langle w, d_j \\rangle = d_j^\\top w$，其中 $j \\in \\{1,\\dots,p\\}$。那么该统计量就是 $M = \\max_{1 \\le j \\le p} |Z_j|$。\n\n**第 1 部分：$Z_j$ 的分布特性**\n\n我们已知噪声向量 $w$ 服从多元正态分布，$w \\sim \\mathcal{N}(0, \\sigma^2 I_m)$，其中 $I_m$ 是 $m \\times m$ 的单位矩阵。量 $Z_j = d_j^\\top w$ 是高斯向量 $w$ 的线性泛函。多元高斯分布的一个基本性质是，高斯向量的任何线性变换结果仍然是高斯向量。因此，向量 $(Z_1, \\dots, Z_p)^\\top = D^\\top w$ 是一个多元高斯向量。\n\n首先，我们确定每个 $Z_j$ 的均值：\n$$\n\\mathbb{E}[Z_j] = \\mathbb{E}[d_j^\\top w] = d_j^\\top \\mathbb{E}[w]\n$$\n由于 $\\mathbb{E}[w] = 0$，我们有：\n$$\n\\mathbb{E}[Z_j] = d_j^\\top 0 = 0\n$$\n因此，每个 $Z_j$ 都是一个均值为零的随机变量。\n\n接下来，我们求 $Z_j$ 的方差。$w$ 的协方差矩阵是 $\\mathrm{Cov}(w) = \\mathbb{E}[ww^\\top] - \\mathbb{E}[w]\\mathbb{E}[w]^\\top = \\sigma^2 I_m$。\n$$\n\\mathrm{Var}(Z_j) = \\mathbb{E}[(Z_j - \\mathbb{E}[Z_j])^2] = \\mathbb{E}[Z_j^2] = \\mathbb{E}[(d_j^\\top w)(w^\\top d_j)] = d_j^\\top \\mathbb{E}[ww^\\top] d_j\n$$\n代入 $\\mathbb{E}[ww^\\top] = \\sigma^2 I_m$：\n$$\n\\mathrm{Var}(Z_j) = d_j^\\top (\\sigma^2 I_m) d_j = \\sigma^2 (d_j^\\top d_j) = \\sigma^2 \\|d_j\\|_2^2\n$$\n问题陈述所有原子都是归一化的，即对所有 $j$ 都有 $\\|d_j\\|_2 = 1$。因此，\n$$\n\\mathrm{Var}(Z_j) = \\sigma^2\n$$\n所以，对于每个 $j$，$Z_j$ 是一个均值为零、方差为 $\\sigma^2$ 的高斯变量，即 $Z_j \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n最后，我们通过计算任意 $i,j \\in \\{1,\\dots,p\\}$ 对应的 $Z_i$ 和 $Z_j$ 之间的协方差来确定其依赖结构：\n$$\n\\mathrm{Cov}(Z_i, Z_j) = \\mathbb{E}[(Z_i - \\mathbb{E}[Z_i])(Z_j - \\mathbb{E}[Z_j])] = \\mathbb{E}[Z_i Z_j] = \\mathbb{E}[(d_i^\\top w)(w^\\top d_j)]\n$$\n$$\n\\mathrm{Cov}(Z_i, Z_j) = d_i^\\top \\mathbb{E}[ww^\\top] d_j = d_i^\\top (\\sigma^2 I_m) d_j = \\sigma^2 (d_i^\\top d_j)\n$$\n协方差为 $\\sigma^2 \\langle d_i, d_j \\rangle$。这表明随机变量 $Z_i$ 和 $Z_j$ 之间的相关性与相应字典原子 $d_i$ 和 $d_j$ 的内积（即余弦相似度）成正比。\n\n**第 2 部分：标准正交原子情况下 $M$ 的精确累积分布函数**\n\n在原子是标准正交的特殊情况下，字典矩阵 $D$ 满足 $D^\\top D = I_p$。这意味着当 $i=j$ 时内积 $\\langle d_i, d_j \\rangle$ 等于 1，当 $i \\ne j$ 时等于 0。设 $\\delta_{ij}$ 为克罗内克 δ (Kronecker delta)。\n根据第 1 部分的协方差结果：\n$$\n\\mathrm{Cov}(Z_i, Z_j) = \\sigma^2 \\langle d_i, d_j \\rangle = \\sigma^2 \\delta_{ij}\n$$\n这意味着随机变量 $\\{Z_j\\}_{j=1}^p$ 是不相关的。由于它们是联合高斯的，这也意味着它们是统计上独立的。此外，根据第 1 部分，它们服从相同的分布 $\\mathcal{N}(0, \\sigma^2)$。\n\n我们希望找到 $M = \\max_{1 \\le j \\le p} |Z_j|$ 的累积分布函数 (CDF)，即 $F_M(t) = \\mathbb{P}(M \\le t)$。\n$$\nF_M(t) = \\mathbb{P}(\\max_{1 \\le j \\le p} |Z_j| \\le t) = \\mathbb{P}(|Z_1| \\le t, |Z_2| \\le t, \\dots, |Z_p| \\le t)\n$$\n由于 $Z_j$ 变量的独立性，联合概率是边际概率的乘积：\n$$\nF_M(t) = \\prod_{j=1}^p \\mathbb{P}(|Z_j| \\le t)\n$$\n由于所有的 $Z_j$ 都是同分布的，这可以简化为：\n$$\nF_M(t) = \\left( \\mathbb{P}(|Z_1| \\le t) \\right)^p\n$$\n设 $\\Phi(\\cdot)$ 表示标准正态变量 $\\mathcal{N}(0,1)$ 的累积分布函数。一个变量 $Z_1 \\sim \\mathcal{N}(0, \\sigma^2)$ 可以写成 $Z_1 = \\sigma X$，其中 $X \\sim \\mathcal{N}(0,1)$。对于 $t \\ge 0$，概率 $\\mathbb{P}(|Z_1| \\le t)$ 为：\n$$\n\\mathbb{P}(|Z_1| \\le t) = \\mathbb{P}(-t \\le Z_1 \\le t) = \\mathbb{P}\\left(-\\frac{t}{\\sigma} \\le X \\le \\frac{t}{\\sigma}\\right)\n$$\n$$\n= \\Phi\\left(\\frac{t}{\\sigma}\\right) - \\Phi\\left(-\\frac{t}{\\sigma}\\right)\n$$\n利用对称性质 $\\Phi(-x) = 1 - \\Phi(x)$，这变为：\n$$\n\\mathbb{P}(|Z_1| \\le t) = \\Phi\\left(\\frac{t}{\\sigma}\\right) - \\left(1 - \\Phi\\left(\\frac{t}{\\sigma}\\right)\\right) = 2\\Phi\\left(\\frac{t}{\\sigma}\\right) - 1\n$$\n将其代回，在标准正交情况下，对于 $t \\ge 0$，$M$ 的精确累积分布函数为：\n$$\nF_M(t) = \\left( 2\\Phi\\left(\\frac{t}{\\sigma}\\right) - 1 \\right)^p\n$$\n\n**第 3 部分：通用字典的通用阈值**\n\n对于一个通用字典 $D$，其中原子不一定正交，变量 $\\{Z_j\\}$ 是相关的，其最大值的精确累积分布函数通常是难以处理的。我们寻求 $M$ 的一个通用高概率界，即一个与 $D$ 的具体相关结构无关的界。\n\n我们的目标是找到最小的阈值 $t$，使得对于给定的容差 $\\delta \\in (0,1)$，有 $\\mathbb{P}(M \\ge t) \\le \\delta$。我们首先应用并集界（布尔不等式），这是一个基本的概率不等式：\n$$\n\\mathbb{P}(M \\ge t) = \\mathbb{P}(\\max_{1 \\le j \\le p} |Z_j| \\ge t) = \\mathbb{P}\\left(\\bigcup_{j=1}^p \\{|Z_j| \\ge t\\}\\right) \\le \\sum_{j=1}^p \\mathbb{P}(|Z_j| \\ge t)\n$$\n如第 1 部分所述，所有的 $Z_j \\sim \\mathcal{N}(0, \\sigma^2)$ 都具有相同的分布。因此，该界简化为：\n$$\n\\mathbb{P}(M \\ge t) \\le p \\cdot \\mathbb{P}(|Z_1| \\ge t)\n$$\n接下来，我们对尾部概率 $\\mathbb{P}(|Z_1| \\ge t)$ 进行界定。根据高斯分布的对称性，对于 $t0$：\n$$\n\\mathbb{P}(|Z_1| \\ge t) = \\mathbb{P}(Z_1 \\ge t) + \\mathbb{P}(Z_1 \\le -t) = 2\\mathbb{P}(Z_1 \\ge t)\n$$\n设 $X = Z_1/\\sigma \\sim \\mathcal{N}(0,1)$。则 $\\mathbb{P}(Z_1 \\ge t) = \\mathbb{P}(X \\ge t/\\sigma)$。我们使用标准的切诺夫界 (Chernoff bound) 来界定标准高斯分布的尾部。对于任意 $x \\ge 0$ 和任意 $\\lambda  0$，马尔可夫不等式 (Markov's inequality) 表明 $\\mathbb{P}(X \\ge x) = \\mathbb{P}(e^{\\lambda X} \\ge e^{\\lambda x}) \\le e^{-\\lambda x}\\mathbb{E}[e^{\\lambda X}]$。标准正态分布的矩生成函数是 $\\mathbb{E}[e^{\\lambda X}] = e^{\\lambda^2/2}$。在 $\\lambda  0$ 上优化界 $e^{\\lambda^2/2 - \\lambda x}$，在 $\\lambda = x$ 处得到最紧的指数，从而给出：\n$$\n\\mathbb{P}(X \\ge x) \\le e^{-x^2/2}\n$$\n应用此界，令 $x = t/\\sigma$：\n$$\n\\mathbb{P}(Z_1 \\ge t) \\le \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right)\n$$\n因此，双边尾部概率的界为：\n$$\n\\mathbb{P}(|Z_1| \\ge t) \\le 2\\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right)\n$$\n将此代入我们的并集界表达式，得到通用界 $\\varepsilon(t)$：\n$$\n\\mathbb{P}(M \\ge t) \\le 2p \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right)\n$$\n为了找到所需的阈值 $t$，我们强制要求这个上界小于或等于期望的容差 $\\delta$。满足条件的最小 $t$ 将满足等式：\n$$\n2p \\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right) = \\delta\n$$\n我们现在求解 $t$：\n$$\n\\exp\\left(-\\frac{t^2}{2\\sigma^2}\\right) = \\frac{\\delta}{2p}\n$$\n对两边取自然对数：\n$$\n-\\frac{t^2}{2\\sigma^2} = \\ln\\left(\\frac{\\delta}{2p}\\right) = -\\ln\\left(\\frac{2p}{\\delta}\\right)\n$$\n$$\nt^2 = 2\\sigma^2 \\ln\\left(\\frac{2p}{\\delta}\\right)\n$$\n假设 $2p/\\delta \\ge 1$，这是合理的，因为通常 $p \\gg 1$ 且 $\\delta \\ll 1$，我们可以对两边取平方根，得到阈值的最终表达式：\n$$\nt = \\sigma \\sqrt{2 \\ln\\left(\\frac{2p}{\\delta}\\right)}\n$$\n这个阈值通常被称为通用阈值，它确保最大噪声相关性超过 $t$ 的概率不大于 $\\delta$。它随噪声水平 $\\sigma$ 正确缩放，随原子数 $p$ 的增加而增加（以考虑多重比较），并随着容差 $\\delta$ 变得更严格（更小）而增加。",
            "answer": "$$\\boxed{\\sigma \\sqrt{2 \\ln\\left(\\frac{2p}{\\delta}\\right)}}$$"
        }
    ]
}