{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of signal processing's uncertainty principles is the trade-off between a signal's concentration in the time domain and its concentration in the frequency domain. This first exercise  guides you through a foundational calculation to make this trade-off precise. You will compute the mutual coherence between the standard (time) and Fourier (frequency) bases, a measure of their 'dissimilarity', and then use this result to derive the famous inequality that governs simultaneous sparsity in these two domains.",
            "id": "3491665",
            "problem": "Consider the complex vector space $\\mathbb{C}^{n}$ with the standard orthonormal basis $I=\\{e_{0},e_{1},\\dots,e_{n-1}\\}$, where each $e_{i}$ has a $1$ in index $i$ and $0$ elsewhere. Let $F=\\{f_{0},f_{1},\\dots,f_{n-1}\\}$ denote the discrete Fourier basis associated with the unitary Discrete Fourier Transform (DFT), where each $f_{k}\\in\\mathbb{C}^{n}$ has entries $f_{k}[j] = n^{-1/2}\\exp(2\\pi \\mathrm{i} j k / n)$ for $j=0,1,\\dots,n-1$, and the collection $\\{f_{k}\\}$ forms an orthonormal basis. The mutual coherence $\\mu(U,V)$ between two orthonormal bases $U=\\{u_{i}\\}$ and $V=\\{v_{j}\\}$ in $\\mathbb{C}^{n}$ is defined as\n$$\n\\mu(U,V) \\triangleq \\max_{i,j} \\left| \\langle u_{i}, v_{j} \\rangle \\right|,\n$$\nwhere $\\langle \\cdot, \\cdot \\rangle$ is the standard inner product on $\\mathbb{C}^{n}$.\n\nCompute the mutual coherence $\\mu(I,F)$ as a closed-form analytic expression in terms of $n$. Then, starting from the above core definitions of orthonormal bases, inner products, and mutual coherence, explain how this value quantifies the uncertainty principle for sparse signals represented in $I$ and $F$, in particular the trade-off between the number of nonzero coefficients in the time domain and the number of nonzero coefficients in the frequency domain. Your final computed coherence must be expressed symbolically in $n$; no numerical approximation or rounding is required.",
            "solution": "The problem as stated is formally sound, self-contained, and grounded in established principles of linear algebra and signal processing. All terms are well-defined, and the tasks are procedurally clear. The problem is therefore deemed valid and a solution will be provided.\n\nThe problem consists of two parts. First, we must compute the mutual coherence $\\mu(I,F)$ between the standard orthonormal basis $I$ and the discrete Fourier basis $F$ in the complex vector space $\\mathbb{C}^{n}$. Second, we must explain how this value quantifies the uncertainty principle governing sparse signal representations.\n\nLet us begin with the first part: the computation of the mutual coherence $\\mu(I,F)$.\nThe standard orthonormal basis is $I=\\{e_{0},e_{1},\\dots,e_{n-1}\\}$, where each vector $e_{i} \\in \\mathbb{C}^{n}$ is defined by its components $e_{i}[j] = \\delta_{ij}$ for $j=0,1,\\dots,n-1$. Here, $\\delta_{ij}$ is the Kronecker delta, which is $1$ if $i=j$ and $0$ otherwise.\nThe discrete Fourier basis is $F=\\{f_{0},f_{1},\\dots,f_{n-1}\\}$, where each vector $f_{k} \\in \\mathbb{C}^{n}$ is defined by its components $f_{k}[j] = n^{-1/2}\\exp(2\\pi \\mathrm{i} j k / n)$ for $j=0,1,\\dots,n-1$.\nThe mutual coherence between these two orthonormal bases is defined as\n$$\n\\mu(I,F) \\triangleq \\max_{i,k} \\left| \\langle e_{i}, f_{k} \\rangle \\right|\n$$\nwhere the indices $i$ and $k$ range from $0$ to $n-1$. The inner product $\\langle \\cdot, \\cdot \\rangle$ on $\\mathbb{C}^{n}$ is the standard complex inner product, given by $\\langle x, y \\rangle = \\sum_{j=0}^{n-1} x[j] \\overline{y[j]}$.\n\nTo compute $\\mu(I,F)$, we must first evaluate the inner product $\\langle e_{i}, f_{k} \\rangle$ for arbitrary basis vectors $e_i \\in I$ and $f_k \\in F$.\n$$\n\\langle e_{i}, f_{k} \\rangle = \\sum_{j=0}^{n-1} e_{i}[j] \\overline{f_{k}[j]}\n$$\nSubstituting the component definitions, we have:\n$$\n\\langle e_{i}, f_{k} \\rangle = \\sum_{j=0}^{n-1} \\delta_{ij} \\overline{\\left( n^{-1/2}\\exp\\left(\\frac{2\\pi \\mathrm{i} j k}{n}\\right) \\right)}\n$$\nThe complex conjugate of $f_k[j]$ is $\\overline{f_{k}[j]} = n^{-1/2}\\exp\\left(-\\frac{2\\pi \\mathrm{i} j k}{n}\\right)$. The sum is non-zero only at the term where $j=i$, due to the Kronecker delta $\\delta_{ij}$. This simplifies the summation to a single term:\n$$\n\\langle e_{i}, f_{k} \\rangle = 1 \\cdot \\left( n^{-1/2}\\exp\\left(-\\frac{2\\pi \\mathrm{i} i k}{n}\\right) \\right) = n^{-1/2}\\exp\\left(-\\frac{2\\pi \\mathrm{i} i k}{n}\\right)\n$$\nNext, we take the absolute value of this complex number:\n$$\n\\left| \\langle e_{i}, f_{k} \\rangle \\right| = \\left| n^{-1/2}\\exp\\left(-\\frac{2\\pi \\mathrm{i} i k}{n}\\right) \\right|\n$$\nThe magnitude of a product of complex numbers is the product of their magnitudes. Since $n$ is a positive integer, $|n^{-1/2}| = n^{-1/2}$. The exponential term is of the form $\\exp(\\mathrm{i}\\theta)$ where $\\theta$ is a real number. The magnitude of such a term is always $1$, since $|\\exp(\\mathrm{i}\\theta)| = |\\cos(\\theta) + \\mathrm{i}\\sin(\\theta)| = \\sqrt{\\cos^2(\\theta) + \\sin^2(\\theta)} = 1$.\nTherefore, for any choice of $i, k \\in \\{0, 1, \\dots, n-1\\}$:\n$$\n\\left| \\langle e_{i}, f_{k} \\rangle \\right| = n^{-1/2} \\cdot 1 = \\frac{1}{\\sqrt{n}}\n$$\nThe mutual coherence is the maximum of these values over all $i$ and $k$. Since the value $1/\\sqrt{n}$ is constant for all pairs of basis vectors, the maximum is this value itself.\n$$\n\\mu(I,F) = \\max_{i,k} \\left( \\frac{1}{\\sqrt{n}} \\right) = \\frac{1}{\\sqrt{n}}\n$$\n\nNow, for the second part, we explain how this result quantifies the uncertainty principle for sparse signals.\nA signal $x \\in \\mathbb{C}^{n}$ is said to be sparse if most of its components are zero. The sparsity of a signal is measured by the $\\ell_0$ pseudo-norm, $\\|x\\|_0$, which counts the number of non-zero entries in the vector $x$. Let the representation of $x$ in the standard basis $I$ be the vector of coefficients $\\alpha$, where $\\alpha_i = \\langle x, e_i \\rangle$. This is just the vector $x$ itself, so the number of non-zero \"time-domain\" coefficients is $\\|x\\|_0$. Let the representation of $x$ in the Fourier basis $F$ be the vector of coefficients $\\beta$, where $\\beta_k = \\langle x, f_k \\rangle$. This is the Discrete Fourier Transform (DFT) of $x$, commonly denoted $\\hat{x}$. The number of non-zero \"frequency-domain\" coefficients is $\\|\\hat{x}\\|_0$.\n\nThe uncertainty principle, in this context, states that a non-zero signal cannot be simultaneously sparse in both the time domain (basis $I$) and the frequency domain (basis $F$). The mutual coherence provides a precise, quantitative formulation of this principle. A well-known result by Donoho and Stark establishes a lower bound on the product of the sparsities in two different orthonormal bases. For any non-zero signal $x \\in \\mathbb{C}^n$, its sparsity in basis $I$ (denoted $\\|x\\|_0$) and its sparsity in basis $F$ (denoted $\\|\\hat{x}\\|_0$) are related by the inequality:\n$$\n\\|x\\|_0 \\cdot \\|\\hat{x}\\|_0 \\ge \\frac{1}{\\mu(I,F)^2}\n$$\nTo demonstrate this, let $S_I = \\mathrm{supp}(x) = \\{i \\mid x_i \\neq 0\\}$ be the support of $x$ in the time domain, so $\\|x\\|_0 = |S_I|$. Let $S_F = \\mathrm{supp}(\\hat{x}) = \\{k \\mid \\hat{x}_k \\neq 0\\}$ be the support of $\\hat{x}$ in the frequency domain, so $\\|\\hat{x}\\|_0 = |S_F|$.\nThe signal $x$ can be expressed in the basis $F$ as $x = \\sum_{k \\in S_F} \\hat{x}_k f_k$.\nThe components of $x$ in the time domain are $x_i = \\langle x, e_i \\rangle$. For any $i \\in S_I$:\n$$\nx_i = \\left\\langle \\sum_{k \\in S_F} \\hat{x}_k f_k, e_i \\right\\rangle = \\sum_{k \\in S_F} \\hat{x}_k \\langle f_k, e_i \\rangle\n$$\nBy Parseval's identity, the energy of the signal is the same in both domains: $\\|x\\|_2^2 = \\sum_{i \\in S_I} |x_i|^2 = \\|\\hat{x}\\|_2^2 = \\sum_{k \\in S_F} |\\hat{x}_k|^2$.\nLet's consider the sum of squared magnitudes of the time-domain components:\n$$\n\\sum_{i \\in S_I} |x_i|^2 = \\sum_{i \\in S_I} \\left| \\sum_{k \\in S_F} \\hat{x}_k \\langle f_k, e_i \\rangle \\right|^2\n$$\nApplying the Cauchy-Schwarz inequality to the inner sum over $k$:\n$$\n\\left| \\sum_{k \\in S_F} \\hat{x}_k \\langle f_k, e_i \\rangle \\right|^2 \\le \\left( \\sum_{k \\in S_F} |\\hat{x}_k|^2 \\right) \\left( \\sum_{k \\in S_F} |\\langle f_k, e_i \\rangle|^2 \\right) = \\|\\hat{x}\\|_2^2 \\sum_{k \\in S_F} |\\langle f_k, e_i \\rangle|^2\n$$\nSumming over $i \\in S_I$ and using $\\|x\\|_2^2 = \\|\\hat{x}\\|_2^2$:\n$$\n\\|x\\|_2^2 \\le \\sum_{i \\in S_I} \\left( \\|\\hat{x}\\|_2^2 \\sum_{k \\in S_F} |\\langle f_k, e_i \\rangle|^2 \\right)\n$$\nSince $x$ is non-zero, $\\|x\\|_2^2 > 0$, so we can divide by it:\n$$\n1 \\le \\sum_{i \\in S_I} \\sum_{k \\in S_F} |\\langle f_k, e_i \\rangle|^2\n$$\nBy definition, $|\\langle f_k, e_i \\rangle| = |\\langle e_i, f_k \\rangle| \\le \\mu(I,F)$. Substituting this upper bound:\n$$\n1 \\le \\sum_{i \\in S_I} \\sum_{k \\in S_F} \\mu(I,F)^2 = |S_I| \\cdot |S_F| \\cdot \\mu(I,F)^2 = \\|x\\|_0 \\cdot \\|\\hat{x}\\|_0 \\cdot \\mu(I,F)^2\n$$\nRearranging gives the desired inequality.\nSubstituting our computed value $\\mu(I,F) = 1/\\sqrt{n}$:\n$$\n\\|x\\|_0 \\cdot \\|\\hat{x}\\|_0 \\ge \\frac{1}{(1/\\sqrt{n})^2} = n\n$$\nThis result, $\\|x\\|_0 \\cdot \\|\\hat{x}\\|_0 \\ge n$, is a powerful statement of the uncertainty principle. It shows that the product of the number of non-zero time coefficients and non-zero frequency coefficients for any non-trivial signal is bounded below by the dimension $n$ of the signal space. If a signal is highly localized in one domain (e.g., $\\|x\\|_0$ is small), it must be highly spread out, or delocalized, in the other domain (i.e., $\\|\\hat{x}\\|_0$ must be large) to satisfy this inequality.\nFor example, if a signal is a single spike in the time domain, $x=e_i$, then $\\|x\\|_0=1$. The uncertainty principle requires $\\|\\hat{x}\\|_0 \\ge n$. Indeed, the DFT of $e_i$ has components of constant magnitude $1/\\sqrt{n}$ across all frequencies, so $\\|\\hat{x}\\|_0=n$. Conversely, a pure frequency signal $x=f_k$ has $\\|\\hat{x}\\|_0=1$, which forces $\\|x\\|_0 \\ge n$, and indeed all its time-domain components have magnitude $1/\\sqrt{n}$. The mutual coherence $\\mu(I,F)$ precisely sets the scale of this fundamental trade-off. The value of $1/\\sqrt{n}$ is the minimum possible coherence between any two orthonormal bases in $\\mathbb{C}^n$, signifying that the standard and Fourier bases are maximally incoherent, which in turn leads to the strongest possible uncertainty principle of this form.",
            "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{n}}}\n$$"
        },
        {
            "introduction": "After establishing a theoretical bound, it is crucial to understand if it is a tight limit or merely a loose approximation. This practice  challenges you to construct a signal that perfectly achieves the equality in the time-frequency uncertainty principle. By building this signal from first principles, you will discover the specific periodic structure required to saturate the bound, providing a concrete example of a signal that is maximally concentrated in both domains to the extent the principle allows.",
            "id": "3491677",
            "problem": "Let $n \\in \\mathbb{N}$ be composite and let $d \\in \\mathbb{N}$ be a divisor of $n$. Define $m := n/d$. Consider the cyclic index set $\\{0,1,\\dots,n-1\\}$ and the Discrete Fourier Transform (DFT) on $\\mathbb{C}^{n}$, defined for $x \\in \\mathbb{C}^{n}$ by\n$$\n\\hat{x}_{k} := \\sum_{j=0}^{n-1} x_{j} \\exp\\!\\left(-2 \\pi \\mathrm{i} \\frac{j k}{n}\\right), \\quad k \\in \\{0,1,\\dots,n-1\\}.\n$$\nThe support of a vector $x \\in \\mathbb{C}^{n}$ is $\\operatorname{supp}(x) := \\{j \\in \\{0,\\dots,n-1\\} : x_{j} \\neq 0\\}$, and its cardinality is $|\\operatorname{supp}(x)|$. Starting only from the above definitions and the fundamental geometric-series identity, construct an explicit $x \\in \\mathbb{C}^{n}$ such that $|\\operatorname{supp}(x)| = d$ and $|\\operatorname{supp}(\\hat{x})| = n/d$, and verify the exact product equality $|\\operatorname{supp}(x)| \\cdot |\\operatorname{supp}(\\hat{x})|$. Do not assume or invoke any specialized uncertainty principle formulas; derive everything from first principles. Provide the closed-form value of the product $|\\operatorname{supp}(x)| \\cdot |\\operatorname{supp}(\\hat{x})|$ as your final answer. No rounding is required, and no units are involved.",
            "solution": "The problem is first subjected to validation.\n\n### Step 1: Extract Givens\n- $n \\in \\mathbb{N}$ is a composite number.\n- $d \\in \\mathbb{N}$ is a divisor of $n$.\n- $m := n/d$.\n- The index set is $\\{0,1,\\dots,n-1\\}$.\n- The Discrete Fourier Transform (DFT) on $\\mathbb{C}^{n}$ is defined for $x \\in \\mathbb{C}^{n}$ by $\\hat{x}_{k} := \\sum_{j=0}^{n-1} x_{j} \\exp(-2 \\pi \\mathrm{i} \\frac{j k}{n})$ for $k \\in \\{0,1,\\dots,n-1\\}$.\n- The support of a vector $x \\in \\mathbb{C}^{n}$ is $\\operatorname{supp}(x) := \\{j \\in \\{0,\\dots,n-1\\} : x_{j} \\neq 0\\}$.\n- The task is to construct an explicit $x \\in \\mathbb{C}^{n}$ such that $|\\operatorname{supp}(x)| = d$ and $|\\operatorname{supp}(\\hat{x})| = n/d$, using only the given definitions and the geometric-series identity.\n- The task includes verifying the product equality $|\\operatorname{supp}(x)| \\cdot |\\operatorname{supp}(\\hat{x})|$.\n- The final answer is the closed-form value of this product.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It deals with standard concepts in signal processing and Fourier analysis, namely the Discrete Fourier Transform and vector sparsity. The definitions provided are standard. The problem is well-posed, asking for the construction of a specific mathematical object with verifiable properties. It is self-contained, providing all necessary definitions and specifying the allowed tools (first principles and the geometric series identity). The problem is objective and free of ambiguity, contradictions, or unstated assumptions. It represents a valid and formalizable mathematical challenge.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe objective is to construct a vector $x \\in \\mathbb{C}^{n}$ such that its support size is $|\\operatorname{supp}(x)| = d$ and the support size of its DFT, $|\\operatorname{supp}(\\hat{x})|$, is $m = n/d$.\n\nLet us define the vector $x$ by specifying its components $x_j$ for $j \\in \\{0, 1, \\dots, n-1\\}$. We construct a signal that is non-zero only at indices that are multiples of $m=n/d$. Specifically, we set these non-zero values to $1$.\nLet the components of $x$ be defined as:\n$$\nx_j :=\n\\begin{cases}\n1  \\text{if } j \\text{ is a multiple of } m, \\text{ i.e., } j \\in \\{0, m, 2m, \\dots, (d-1)m\\} \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nThis can be written more formally using a sum of Kronecker delta functions: $x_j = \\sum_{l=0}^{d-1} \\delta_{j, l \\cdot m}$.\n\nFirst, we determine the support of $x$. By definition, the support of $x$ is the set of indices $j$ where $x_j \\neq 0$. Based on our construction:\n$$\n\\operatorname{supp}(x) = \\{l \\cdot m \\mid l \\in \\{0, 1, \\dots, d-1\\}\\} = \\{0, m, 2m, \\dots, (d-1)m\\}\n$$\nSince $d$ is a divisor of $n$, $m=n/d$ is an integer. The largest index in this set is $(d-1)m = (d-1)\\frac{n}{d} = n - \\frac{n}{d} = n - m$. As $d$ divides $n$ and $n$ is composite, we have $d \\ge 2$ or $d=1$. If $d=1$, $m=n$, the set is just $\\{0\\}$. If $d1$, then $m  n$. In all cases, all indices in the set are distinct and belong to $\\{0, 1, \\dots, n-1\\}$. The number of elements in this set is $d$. Therefore, we have verified that\n$$\n|\\operatorname{supp}(x)| = d\n$$\n\nNext, we compute the DFT of $x$, denoted by $\\hat{x}$. The $k$-th component of $\\hat{x}$ is given by the definition:\n$$\n\\hat{x}_k = \\sum_{j=0}^{n-1} x_j \\exp\\left(-2 \\pi \\mathrm{i} \\frac{j k}{n}\\right)\n$$\nSubstituting our constructed $x$, the sum is non-zero only for indices $j$ in the support of $x$. We can re-index the sum over $l$ from $0$ to $d-1$, where $j = l \\cdot m$:\n$$\n\\hat{x}_k = \\sum_{l=0}^{d-1} x_{l \\cdot m} \\exp\\left(-2 \\pi \\mathrm{i} \\frac{(l \\cdot m) k}{n}\\right)\n$$\nSince $x_{l \\cdot m} = 1$ and $m = n/d$, this simplifies to:\n$$\n\\hat{x}_k = \\sum_{l=0}^{d-1} \\exp\\left(-2 \\pi \\mathrm{i} \\frac{l \\cdot (n/d) \\cdot k}{n}\\right) = \\sum_{l=0}^{d-1} \\exp\\left(-2 \\pi \\mathrm{i} \\frac{lk}{d}\\right)\n$$\nThis is a finite geometric series with first term $a=1$, ratio $r = \\exp(-2 \\pi \\mathrm{i} \\frac{k}{d})$, and $d$ terms. We analyze this sum based on the value of $r$.\n\nCase 1: $r = 1$.\nThis occurs if the exponent is an integer multiple of $2 \\pi \\mathrm{i}$.\n$$\n\\exp\\left(-2 \\pi \\mathrm{i} \\frac{k}{d}\\right) = 1 \\iff \\frac{k}{d} \\in \\mathbb{Z}\n$$\nThis means $k$ must be a multiple of $d$. Let $k = q \\cdot d$ for some integer $q$. Since $k \\in \\{0, 1, \\dots, n-1\\}$, the possible values of $q$ are $\\{0, 1, \\dots, m-1\\}$, where $m=n/d$. For these values of $k$, the ratio $r=1$, and the sum becomes the number of terms:\n$$\n\\hat{x}_k = \\sum_{l=0}^{d-1} 1 = d\n$$\nSo, for $k \\in \\{0, d, 2d, \\dots, (m-1)d\\}$, we have $\\hat{x}_k = d \\neq 0$.\n\nCase 2: $r \\neq 1$.\nThis occurs when $k$ is not a multiple of $d$. In this case, we use the formula for the sum of a geometric series: $\\sum_{l=0}^{N-1} r^l = \\frac{r^N - 1}{r - 1}$. Here, $N=d$.\n$$\n\\hat{x}_k = \\frac{\\left(\\exp\\left(-2 \\pi \\mathrm{i} \\frac{k}{d}\\right)\\right)^d - 1}{\\exp\\left(-2 \\pi \\mathrm{i} \\frac{k}{d}\\right) - 1} = \\frac{\\exp(-2 \\pi \\mathrm{i} k) - 1}{\\exp\\left(-2 \\pi \\mathrm{i} \\frac{k}{d}\\right) - 1}\n$$\nSince $k$ is an integer, Euler's formula gives $\\exp(-2 \\pi \\mathrm{i} k) = \\cos(-2\\pi k) + \\mathrm{i}\\sin(-2\\pi k) = 1$. Thus, the numerator is $1 - 1 = 0$. The denominator is non-zero because we are in the case where $r \\neq 1$.\nTherefore, for all $k$ that are not multiples of $d$, we have:\n$$\n\\hat{x}_k = 0\n$$\n\nCombining both cases, the components of $\\hat{x}$ are:\n$$\n\\hat{x}_k =\n\\begin{cases}\nd  \\text{if } k \\text{ is a multiple of } d \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nThe support of $\\hat{x}$ is the set of indices $k$ where $\\hat{x}_k \\neq 0$.\n$$\n\\operatorname{supp}(\\hat{x}) = \\{k \\in \\{0, 1, \\dots, n-1\\} \\mid k \\text{ is a multiple of } d\\} = \\{q \\cdot d \\mid q \\in \\{0, 1, \\dots, m-1\\}\\}\n$$\nThis set is $\\{0, d, 2d, \\dots, (m-1)d\\}$. The number of elements in this set is $m$. Therefore, we have verified that\n$$\n|\\operatorname{supp}(\\hat{x})| = m = \\frac{n}{d}\n$$\nWe have successfully constructed a vector $x$ and shown that $|\\operatorname{supp}(x)| = d$ and $|\\operatorname{supp}(\\hat{x})| = n/d$.\n\nFinally, we are asked to verify the product equality and provide the value of the product.\n$$\n|\\operatorname{supp}(x)| \\cdot |\\operatorname{supp}(\\hat{x})| = d \\cdot \\frac{n}{d} = n\n$$\nThe product is exactly $n$. This result is a specific instance of a discrete uncertainty principle for the DFT.\n\nThe final answer is the closed-form value of this product. The product is $n$.",
            "answer": "$$\n\\boxed{n}\n$$"
        },
        {
            "introduction": "To bridge the gap between abstract theory and practical reality, this final exercise  uses computational simulation to explore the landscape of the uncertainty principle. You will compare randomly generated sparse signals, which represent 'typical' cases, against the specially structured signal from the previous exercise that achieves the uncertainty bound. This hands-on coding practice provides powerful numerical confirmation that while all signals obey the principle, only those with very specific structures come close to the theoretical limit.",
            "id": "3491550",
            "problem": "Consider the discrete uncertainty principle for sparse signals in a finite-dimensional complex vector space. Let $n \\in \\mathbb{N}$ and let $F \\in \\mathbb{C}^{n \\times n}$ denote the unitary discrete Fourier transform matrix with entries $F_{k,\\ell} = \\frac{1}{\\sqrt{n}} e^{-2\\pi i k \\ell / n}$ for $k,\\ell \\in \\{0,1,\\dots,n-1\\}$. For any vector $x \\in \\mathbb{C}^n$, define the support $\\operatorname{supp}(x) = \\{j \\in \\{0,\\dots,n-1\\} : x_j \\ne 0\\}$ and let $s = |\\operatorname{supp}(x)|$. Let $\\hat{x} = Fx$ and $t = |\\operatorname{supp}(\\hat{x})|$. The discrete uncertainty principle for the Fourier transform asserts a nontrivial lower bound on $s t$.\n\nYour task is to write a program that, for a synthetic test with $n = 512$, $U = F$, and $s \\in \\{4, 8, 16\\}$, computes observed values of $t$ under randomized trials and compares them to the lower bound. The required steps are:\n\n- Implement the unitary discrete Fourier transform via a fast Fourier transform with the $1/\\sqrt{n}$ normalization so that $F$ is unitary.\n- For each sparsity level $s \\in \\{4, 8, 16\\}$:\n  1. Randomized trials:\n     - Use a fixed pseudo-random seed equal to $2025$.\n     - Perform $50$ independent trials. In each trial, draw a random $s$-sparse vector $x \\in \\mathbb{C}^n$ by choosing a support of size $s$ uniformly at random from $\\{0,1,\\dots,n-1\\}$ without replacement, and assigning independent complex Gaussian nonzero entries with real and imaginary parts distributed as $\\mathcal{N}(0,1)$.\n     - Compute $\\hat{x} = F x$ and estimate $t$ by counting the number of indices $k$ for which $|\\hat{x}_k|  \\tau$, where the numerical tolerance is $\\tau = 10^{-10}$.\n     - For each trial, record whether the inequality $s \\cdot t \\ge n$ holds.\n     - Over the $50$ trials, report the minimum observed $t$ and whether the inequality held in all trials for that $s$.\n  2. Boundary (equality) case:\n     - Construct a deterministic $s$-sparse vector $x \\in \\mathbb{C}^n$ with support equal to the subgroup $H = \\{0, n/s, 2n/s, \\dots, (s-1)n/s\\}$ of $\\mathbb{Z}_n$ and with $x_j = 1$ on $H$ and $x_j = 0$ otherwise.\n     - Compute $\\hat{x} = F x$ and count $t$ via the threshold $|\\hat{x}_k|  \\tau$ with $\\tau = 10^{-10}$.\n     - Check whether the product $s \\cdot t$ equals $n$ exactly (as integers) under the thresholding rule.\n- Final output specification:\n  - For each $s \\in \\{4, 8, 16\\}$ in ascending order, produce a list of four values:\n    - The minimum observed $t$ across the $50$ randomized trials (an integer).\n    - A boolean indicating whether $s \\cdot t \\ge n$ held for all randomized trials (a boolean).\n    - The $t$ computed for the subgroup-based equality construction (an integer).\n    - A boolean indicating whether the equality $s \\cdot t = n$ was observed for the subgroup construction (a boolean).\n  - Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one $s$ in ascending order and is itself a comma-separated list in square brackets. For example, the overall format is $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot]]$.\n\nFoundational base to use in your reasoning and implementation:\n- The matrix $F$ is unitary, so $\\|F x\\|_2 = \\|x\\|_2$ for all $x \\in \\mathbb{C}^n$.\n- The magnitude of each entry of $F$ is bounded by $\\mu = 1/\\sqrt{n}$.\n- The Cauchyâ€“Schwarz inequality and the relation between $\\ell_{\\infty}$, $\\ell_2$, and support size: for any $z \\in \\mathbb{C}^n$ with support size $t$, $\\|z\\|_2^2 \\le t \\|z\\|_{\\infty}^2$.\n\nTest suite parameters that must be used:\n- Dimension: $n = 512$.\n- Transform: $U = F$ as defined above.\n- Sparsities: $s \\in \\{4,8,16\\}$.\n- Random trials per $s$: $50$.\n- Random seed: $2025$.\n- Numerical threshold: $\\tau = 10^{-10}$.\n\nThere are no physical units involved in this problem. Angles are in radians by definition of the exponential in the Fourier transform. Percentages must not be used anywhere; any ratios must be expressed as decimals or fractions if needed.",
            "solution": "The problem asks for an empirical investigation of the discrete uncertainty principle for the Fourier transform in a finite-dimensional space $\\mathbb{C}^n$. This principle establishes a fundamental trade-off between the sparsity of a vector $x$ and the sparsity of its discrete Fourier transform $\\hat{x}$. Specifically, for a non-zero vector $x \\in \\mathbb{C}^n$ with sparsity $s = |\\operatorname{supp}(x)|$, and its transform $\\hat{x} = Fx$ with sparsity $t = |\\operatorname{supp}(\\hat{x})|$, the Donoho-Stark uncertainty principle asserts that $s \\cdot t \\ge n$. Here, $F$ is the unitary discrete Fourier transform (DFT) matrix, whose entries are $F_{k,\\ell} = \\frac{1}{\\sqrt{n}} e^{-2\\pi i k \\ell / n}$. The unitary nature of $F$ implies energy preservation, i.e., $\\|x\\|_2 = \\|\\hat{x}\\|_2$, but this by itself does not constrain the \"spread\" or support size of the signal and its transform. The uncertainty principle provides this crucial constraint.\n\nOur task is to verify this principle computationally for dimension $n=512$ and for signal sparsities $s \\in \\{4, 8, 16\\}$. The verification involves two components for each value of $s$: a series of randomized trials to observe typical behavior and the analysis of a specific deterministic construction that represents a boundary case where equality is achieved. All numerical determinations of support size will use a threshold $\\tau = 10^{-10}$ to account for floating-point inaccuracies, meaning a component $z_j$ is considered non-zero if $|z_j|  \\tau$.\n\nThe algorithmic procedure is as follows:\n\nFirst, we address the randomized trials. For each sparsity $s \\in \\{4, 8, 16\\}$, we perform a set of $50$ independent trials. Reproducibility is ensured by seeding the pseudo-random number generator to $2025$. In each trial:\n1.  An $s$-sparse vector $x \\in \\mathbb{C}^n$ is generated. This is achieved by first selecting a support set of size $s$ uniformly at random from the indices $\\{0, 1, \\dots, n-1\\}$ without replacement.\n2.  The $s$ non-zero entries of $x$ on this support are then populated with independent complex Gaussian random numbers. Each such number is of the form $a+ib$, where the real part $a$ and imaginary part $b$ are independent draws from the standard normal distribution $\\mathcal{N}(0,1)$. This construction models a generic, unstructured sparse signal.\n3.  The DFT of this vector, $\\hat{x} = Fx$, is computed efficiently using a Fast Fourier Transform (FFT) algorithm, normalized by $1/\\sqrt{n}$ to match the unitary definition of $F$. The `scipy.fft.fft` function with the `norm='ortho'` option performs this computation directly.\n4.  The sparsity $t$ of the resulting vector $\\hat{x}$ is estimated by counting the number of its components whose magnitude exceeds the threshold $\\tau=10^{-10}$.\n5.  The inequality $s \\cdot t \\ge n$ is checked for the observed $t$. For a generic random signal, we expect its transform to be delocalized, meaning its energy is spread across most frequencies. Consequently, we anticipate that $t$ will be close to $n$, and the inequality will be satisfied with a large margin.\nAfter $50$ trials, we record the minimum observed value of $t$ and a boolean indicating whether the inequality $s \\cdot t \\ge n$ held true for all trials.\n\nSecond, we analyze the deterministic boundary case. This case demonstrates that the lower bound $s \\cdot t = n$ is tight and can be achieved by signals with a specific structure. For each $s \\in \\{4, 8, 16\\}$, we construct a vector $x$ whose support is the additive subgroup $H = \\{0, n/s, 2n/s, \\dots, (s-1)n/s\\}$ of the cyclic group $\\mathbb{Z}_n$. The values of $x$ on this support are set to $1$, and are $0$ elsewhere. The size of this support is $s$.\nA key property of the DFT is that the transform of a signal supported on a subgroup is, in turn, supported on the dual subgroup. The dual subgroup of $H$ is $H^\\perp = \\{k \\in \\mathbb{Z}_n : k \\cdot h = 0 \\pmod{n} \\text{ for all } h \\in H\\}$, which can be shown to be $\\{0, s, 2s, \\dots, (n/s-1)s\\}$. The size of this dual subgroup is precisely $n/s$.\nTherefore, for this specific construction, the theoretical sparsity of $\\hat{x}$ is $t = n/s$. This leads to the equality $s \\cdot t = s \\cdot (n/s) = n$. We compute $\\hat{x}$ for this vector, determine its numerical sparsity $t$ using the threshold $\\tau$, and verify whether the equality $s \\cdot t = n$ holds.\n\nFinally, for each $s$ value, we collate the four computed results: the minimum $t$ from the random trials, the boolean for the inequality holding in all trials, the $t$ from the subgroup construction, and the boolean for the equality holding in that case. These results are then formatted into the specified nested list structure for the final output.",
            "answer": "```python\nimport numpy as np\nfrom scipy import fft\n\ndef solve():\n    \"\"\"\n    Empirically investigates the discrete uncertainty principle for the Fourier transform.\n    \"\"\"\n    # Problem parameters\n    n = 512\n    s_values = [4, 8, 16]\n    num_trials = 50\n    seed = 2025\n    tau = 1e-10\n\n    # Initialize a modern pseudo-random number generator for reproducibility\n    rng = np.random.default_rng(seed)\n\n    # List to store the results for each s\n    final_results = []\n\n    for s in s_values:\n        # --- Part 1: Randomized Trials ---\n        \n        t_random_values = []\n        all_trials_passed_inequality = True\n\n        for _ in range(num_trials):\n            # 1. Create a random s-sparse vector x\n            x = np.zeros(n, dtype=complex)\n            \n            # Choose a support of size s uniformly at random without replacement\n            support = rng.choice(n, size=s, replace=False)\n            \n            # Assign independent complex Gaussian entries on the support\n            # Real and imaginary parts are drawn from N(0,1)\n            real_parts = rng.standard_normal(s)\n            imag_parts = rng.standard_normal(s)\n            values = real_parts + 1j * imag_parts\n            x[support] = values\n\n            # 2. Compute the unitary Discrete Fourier Transform\n            # The norm='ortho' option ensures the transform is unitary (1/sqrt(n) scaling)\n            hat_x = fft.fft(x, norm='ortho')\n\n            # 3. Estimate the support size t of hat_x numerically\n            t = np.sum(np.abs(hat_x)  tau)\n            t_random_values.append(t)\n\n            # 4. Check if the uncertainty principle inequality s*t = n holds\n            if s * t  n:\n                all_trials_passed_inequality = False\n\n        # 5. Determine the minimum observed t over all trials\n        min_t_random = int(np.min(t_random_values))\n        \n        # --- Part 2: Boundary (Equality) Case ---\n\n        # 1. Construct the deterministic vector with subgroup support\n        x_subgroup = np.zeros(n, dtype=complex)\n        \n        # Support is the subgroup H = {0, n/s, 2n/s, ...}\n        # Since n is a multiple of s, n//s is an integer.\n        support_subgroup = np.arange(0, n, n // s, dtype=int)\n        x_subgroup[support_subgroup] = 1.0\n\n        # 2. Compute the unitary DFT\n        hat_x_subgroup = fft.fft(x_subgroup, norm='ortho')\n\n        # 3. Count the support size t\n        t_subgroup = int(np.sum(np.abs(hat_x_subgroup)  tau))\n\n        # 4. Check if the equality s*t = n holds\n        subgroup_passed_equality = (s * t_subgroup == n)\n\n        # Collate the four results for the current s\n        current_s_results = [\n            min_t_random,\n            all_trials_passed_inequality,\n            t_subgroup,\n            subgroup_passed_equality\n        ]\n        final_results.append(current_s_results)\n\n    # Format the final output according to the problem specification\n    # e.g., [[val,bool,val,bool],[...],[...]]\n    # The str() function on a list provides the required '[...]' formatting.\n    output_string = f\"[{','.join(map(str, final_results))}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}