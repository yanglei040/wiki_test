{
    "hands_on_practices": [
        {
            "introduction": "理解跳跃条件的物理起源至关重要。本练习将指导您通过对跨越界面的控制体应用动量守恒原理，推导出著名的杨-拉普拉斯（Young-Laplace）方程，该方程描述了弯曲界面上的压力跳跃。这项实践有助于巩固对宏观界面现象（如表面张力）与基本守恒定律之间联系的理解。",
            "id": "3510796",
            "problem": "考虑一个由不可压缩牛顿流体组成的半径为 $R$ 的静态球形液滴，浸没在静止的、不可压缩的牛顿环境流体中。两种流体之间的界面是光滑的，并具有恒定的各向同性表面张力 $\\gamma$。不存在体力、温度梯度或表面活性剂效应，并且界面上没有质量传递。令单位法向量 $\\boldsymbol{n}$ 的方向为从环境流体（外部，用 $-$ 表示）指向液滴内部（内部，用 $+$ 表示）。定义界面上的压力跳跃为 $[p] = p^{+} - p^{-}$。\n\n使用跨越界面的“药丸盒”控制体的线性动量守恒，以及球体平均曲率的几何特征，推导法向应力的界面跳跃关系，并获得压力跳跃 $[p]$ 关于 $\\gamma$ 和 $R$ 的闭式表达式。然后，确定当 $R \\to \\infty$ 时此压力跳跃的极限。\n\n答案要求：\n- 如果代入数值，压力差应以帕斯卡（Pascal）表示，但最终报告的答案中不应包含单位。\n- 将最终答案报告为一个双元素行矩阵，其中包含 $[p]$ 的解析表达式和 $\\lim_{R \\to \\infty} [p]$ 的值。",
            "solution": "问题要求推导静态球形流体液滴的界面压力跳跃，并确定当液滴半径变为无穷大时其极限。推导必须基于线性动量守恒。\n\n我们首先将线性动量守恒原理应用于一个跨越液滴流体（“$+$”相）和环境流体（“$-$”相）之间界面的控制体。对于一个没有体力且处于静态平衡状态的系统，动量方程的积分形式规定，作用于任何控制体上的所有表面力的总和必须为零。\n\n我们构建一个小的“药丸盒”控制体，该控制体与界面的局部法线 $\\boldsymbol{n}$ 对齐，并被界面平分。设此药丸盒为一个高度为 $h$、底面积为 $\\delta A$ 的小圆柱体。圆柱体的顶盖位于液滴流体（$+$）中，底盖位于环境流体（$-$）中。当我们考虑高度 $h \\to 0$ 的极限时，作用在药丸盒侧壁上的力与作用在顶盖和底盖上的力相比可以忽略不计。需要平衡的剩余力是作用在顶盖和底盖上的压力，以及作用在界面与药丸盒侧壁相交的周线上的表面张力。\n\n我们设定坐标系，使得我们药丸盒中心的法向量 $\\boldsymbol{n}$ 指向 $z$ 方向。在 $\\boldsymbol{n}$ 方向上，作用于控制体内流体的力有：\n$1$. 位于 $z>0$ 的顶盖上，由内部流体压力 $p^{+}$ 产生的力。该力为 $F_{top} = -p^{+} \\delta A$。负号表示该力作用于 $-\\boldsymbol{n}$ 方向（压力是压缩性的）。\n$2$. 位于 $z0$ 的底盖上，由外部流体压力 $p^{-}$ 产生的力。该力为 $F_{bot} = p^{-} \\delta A$。该力作用于 $+\\boldsymbol{n}$ 方向。\n$3$. 由表面张力产生的力 $\\boldsymbol{F}_{\\gamma}$。该力作用于界面的周线上，对于我们切过球形液滴的药丸盒来说，这是一条圆形周线。表面张力 $\\gamma$ 施加一个与表面相切的力。由于界面的曲率，沿周线的这些切向力的总和会产生一个沿法线 $\\boldsymbol{n}$ 的净分力。这个净力将表面向内拉，朝向其曲率中心。\n对于半径为 $R$ 的球形液滴，曲率中心就是球心。法向量 $\\boldsymbol{n}$ 定义为从环境流体指向液滴内部，因此它指向曲率中心。所以，作用在控制体内流体上的表面张力沿着 $\\boldsymbol{n}$ 方向。\n\n为了计算这个力，考虑一个由距离极点的小角度 $\\alpha$ 定义的小球冠。周线的半径为 $r_{cap} = R \\sin\\alpha$。沿此周线的总张力为 $\\gamma (2\\pi r_{cap})$。该力沿表面切向作用，与垂直于 $\\boldsymbol{n}$ 的平面成 $\\alpha$ 角。该力在 $\\boldsymbol{n}$ 方向上的分量为 $(\\gamma 2\\pi R \\sin\\alpha)\\sin\\alpha$。控制体顶盖的面积，投影到垂直于 $\\boldsymbol{n}$ 的平面上，是 $\\delta A = \\pi r_{cap}^2 = \\pi (R\\sin\\alpha)^2 = \\pi R^2 \\sin^2\\alpha$。\n因此，表面张力为 $F_{\\gamma} = 2\\pi\\gamma R \\sin^2\\alpha = \\frac{2\\gamma}{R} (\\pi R^2 \\sin^2\\alpha) = \\frac{2\\gamma}{R} \\delta A$。该力作用于 $+\\boldsymbol{n}$ 方向。\n\n药丸盒内流体在 $\\boldsymbol{n}$ 方向上的力平衡方程为：\n$$\nF_{top} + F_{bot} + F_{\\gamma} = 0\n$$\n代入力学的表达式：\n$$\n-p^{+} \\delta A + p^{-} \\delta A + \\frac{2\\gamma}{R} \\delta A = 0\n$$\n两边同除以面积 $\\delta A$（非零）：\n$$\n-p^{+} + p^{-} + \\frac{2\\gamma}{R} = 0\n$$\n整理该方程可得：\n$$\np^{+} - p^{-} = \\frac{2\\gamma}{R}\n$$\n根据问题对压力跳跃的定义 $[p] = p^{+} - p^{-}$，我们得到第一个要求的表达式：\n$$\n[p] = \\frac{2\\gamma}{R}\n$$\n这就是球形界面的杨-拉普拉斯方程。\n\n问题还要求法向应力的界面跳跃关系。法向量为 $\\boldsymbol{n}$ 的表面上的法向应力 $\\sigma_{nn}$ 由 $\\sigma_{nn} = \\boldsymbol{n} \\cdot \\boldsymbol{\\sigma} \\cdot \\boldsymbol{n}$ 给出，其中 $\\boldsymbol{\\sigma}$ 是总应力张量。对于静态不可压缩牛顿流体，速度场为零，因此粘性应力张量 $\\boldsymbol{\\tau}$ 为零。总应力张量是纯各向同性的：$\\boldsymbol{\\sigma} = -p\\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是单位张量。\n法向应力的跳跃为 $[\\sigma_{nn}] = \\sigma_{nn}^{+} - \\sigma_{nn}^{-}$。我们来计算每一项：\n$\\sigma_{nn}^{+} = \\boldsymbol{n} \\cdot \\boldsymbol{\\sigma}^{+} \\cdot \\boldsymbol{n} = \\boldsymbol{n} \\cdot (-p^{+}\\boldsymbol{I}) \\cdot \\boldsymbol{n} = -p^{+}(\\boldsymbol{n}\\cdot\\boldsymbol{n}) = -p^{+}$.\n$\\sigma_{nn}^{-} = \\boldsymbol{n} \\cdot \\boldsymbol{\\sigma}^{-} \\cdot \\boldsymbol{n} = \\boldsymbol{n} \\cdot (-p^{-}\\boldsymbol{I}) \\cdot \\boldsymbol{n} = -p^{-}(\\boldsymbol{n}\\cdot\\boldsymbol{n}) = -p^{-}$.\n因此，法向应力的跳跃为：\n$$\n[\\sigma_{nn}] = (-p^{+}) - (-p^{-}) = p^{-} - p^{+} = -(p^{+} - p^{-}) = -[p]\n$$\n半径为 $R$ 的球体的平均曲率 $H$ 由 $H = \\frac{1}{2}(\\frac{1}{R} + \\frac{1}{R}) = \\frac{1}{R}$ 给出。\n我们可以用平均曲率来表示压力跳跃的结果：$[p] = 2\\gamma H$。\n将此与关系式 $[\\sigma_{nn}] = -[p]$ 结合，我们得到法向应力的界面跳跃关系：\n$$\n[\\sigma_{nn}] = -2\\gamma H = -\\frac{2\\gamma}{R}\n$$\n这个关系表明，跨界面的法向应力跳跃由表面张力和曲率引起的力来平衡。\n\n最后，我们必须确定当半径 $R$ 趋于无穷大时压力跳跃 $[p]$ 的极限。这在物理上对应于一个平坦的界面。\n$$\n\\lim_{R \\to \\infty} [p] = \\lim_{R \\to \\infty} \\frac{2\\gamma}{R}\n$$\n由于表面张力 $\\gamma$ 是一个常数，当 $R \\to \\infty$ 时，分母变得无限大，表达式趋近于零。\n$$\n\\lim_{R \\to \\infty} [p] = 0\n$$\n这证实了物理直觉，即在没有其他效应的情况下，平坦界面上不存在压力跳跃。\n\n问题要求一个包含 $[p]$ 的解析表达式及其在 $R \\to \\infty$ 时极限值的双元素行矩阵。这两个元素是 $\\frac{2\\gamma}{R}$ 和 $0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2\\gamma}{R}   0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了物理原理之后，下一步是在数值模拟中正确地表示这些界面条件。本练习专注于有限体积法，要求您为一个具有不连续扩散系数的扩散问题设计一个数值通量格式。推导出的结果是计算输运现象中广泛使用的调和平均近似法，它确保了离散格式能正确施加通量连续性，这对于保证数值解的准确性和稳定性至关重要。",
            "id": "3510797",
            "problem": "考虑一维稳态扩散方程，其在材料界面上具有不连续、分段常数的扩散系数，并由守恒定律和傅里叶/菲克通量定律控制。设标量场为 $u(x)$，扩散系数为 $k(x)$。在间距为 $h$ 的均匀网格中，两个相邻的控制体索引为 $i$ 和 $i+1$，其单元中心分别位于 $x_{i}$ 和 $x_{i+1}$。公共面位于 $x_{i+\\frac{1}{2}} = \\frac{x_{i}+x_{i+1}}{2}$。假设对于 $x \\in [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}})$ 有 $k(x) = k_{i}$，对于 $x \\in (x_{i+\\frac{1}{2}}, x_{i+\\frac{3}{2}}]$ 有 $k(x) = k_{i+1}$，其中 $k_{i}  0$ 且 $k_{i+1}  0$，并且 $u(x)$ 在 $x_{i+\\frac{1}{2}}$ 处是连续的。设有限体积未知数 $u_{i}$ 和 $u_{i+1}$ 代表单元 $i$ 和 $i+1$ 中单元中心的值。\n\n定义穿过界面 $x_{i+\\frac{1}{2}}$ 的数值法向通量为 $F_{i+\\frac{1}{2}}$，从单元 $i$ 指向单元 $i+1$ 的方向为正。设计一个面通量 $F_{i+\\frac{1}{2}} = \\mathcal{F}(u_{i}, u_{i+1}, k_{i}, k_{i+1}, h)$，该通量满足：\n- 在有限体积意义下是守恒的，即在两个相邻控制体的平衡方程中使用相同的 $F_{i+\\frac{1}{2}}$；\n- 精确满足由界面跳跃关系所隐含的离散法向通量连续性；\n- 在均匀网格上保持二阶精度。\n\n通过从局部守恒和扩散通量的本构定律出发，并使用与均匀网格上每个单元内的线性解一致的面值重构方法来推导此通量。您的最终答案必须是关于 $u_{i}$、$u_{i+1}$、$k_{i}$、$k_{i+1}$ 和 $h$ 的单一、闭式解析表达式。请以符号表达式的形式给出答案；不要包含单位。",
            "solution": "无源项的一维稳态扩散方程由下式给出：\n$$\n\\frac{d}{dx} \\left( -k(x) \\frac{du}{dx} \\right) = 0\n$$\n该方程意味着，定义为 $F(x) = -k(x) \\frac{du}{dx}$ 的扩散通量对所有 $x$ 都是一个常数。我们的任务是找到这个常数通量在界面 $x_{i+\\frac{1}{2}}$ 处的数值近似，记为 $F_{i+\\frac{1}{2}}$。根据有限体积法的定义，这个数值通量必须是守恒的。\n\n问题陈述 $u(x)$ 在界面 $x_{i+\\frac{1}{2}}$ 处是连续的。设界面处的场值为 $u_{i+\\frac{1}{2}}$。法向通量 $F = -k \\frac{du}{dx}$ 也必须跨界面连续。我们的推导必须满足此条件。\n\n我们遵循提示，假设在单元中心和界面之间定义的子域内，$u(x)$ 具有线性解分布。由于网格是均匀的，间距为 $h$，单元中心位于 $x_i$ 和 $x_{i+1} = x_i + h$。界面位于 $x_{i+\\frac{1}{2}} = x_i + h/2$。\n\n考虑单元中心 $x_i$ 和界面 $x_{i+\\frac{1}{2}}$ 之间的区域。距离为 $\\Delta x = h/2$，扩散系数为 $k_i$。应用通量定律并对梯度进行线性近似，可得：\n$$\nF_{i+\\frac{1}{2}} = -k_i \\frac{u_{i+\\frac{1}{2}} - u_i}{x_{i+\\frac{1}{2}} - x_i} = -k_i \\frac{u_{i+\\frac{1}{2}} - u_i}{h/2}\n$$\n\n接下来，考虑界面 $x_{i+\\frac{1}{2}}$ 和单元中心 $x_{i+1}$ 之间的区域。距离也是 $\\Delta x = h/2$，扩散系数为 $k_{i+1}$。应用通量定律，可得：\n$$\nF_{i+\\frac{1}{2}} = -k_{i+1} \\frac{u_{i+1} - u_{i+\\frac{1}{2}}}{x_{i+1} - x_{i+\\frac{1}{2}}} = -k_{i+1} \\frac{u_{i+1} - u_{i+\\frac{1}{2}}}{h/2}\n$$\n两个表达式中的通量 $F_{i+\\frac{1}{2}}$ 是相同的，这反映了所要求的通量连续性。我们现在得到一个关于两个未知数 $F_{i+\\frac{1}{2}}$ 和 $u_{i+\\frac{1}{2}}$ 的两个线性方程组成的方程组。我们的目标是消去未知的界面值 $u_{i+\\frac{1}{2}}$。\n\n从第一个方程，我们可以表示从 $u_i$ 到 $u_{i+\\frac{1}{2}}$ 的“势降”：\n$$\nu_i - u_{i+\\frac{1}{2}} = F_{i+\\frac{1}{2}} \\frac{h}{2k_i}\n$$\n从第二个方程，我们表示从 $u_{i+\\frac{1}{2}}$ 到 $u_{i+1}$ 的势降：\n$$\nu_{i+\\frac{1}{2}} - u_{i+1} = F_{i+\\frac{1}{2}} \\frac{h}{2k_{i+1}}\n$$\n将这两个方程相加可以消去 $u_{i+\\frac{1}{2}}$：\n$$\n(u_i - u_{i+\\frac{1}{2}}) + (u_{i+\\frac{1}{2}} - u_{i+1}) = F_{i+\\frac{1}{2}} \\frac{h}{2k_i} + F_{i+\\frac{1}{2}} \\frac{h}{2k_{i+1}}\n$$\n左边简化为单元中心之间的总势降，$u_i - u_{i+1}$。右边可以进行因式分解：\n$$\nu_i - u_{i+1} = F_{i+\\frac{1}{2}} \\left( \\frac{h}{2k_i} + \\frac{h}{2k_{i+1}} \\right)\n$$\n我们可以将括号中的项解释为两个串联的半单元的“扩散阻力”。现在我们求解通量 $F_{i+\\frac{1}{2}}$：\n$$\nu_i - u_{i+1} = F_{i+\\frac{1}{2}} \\frac{h}{2} \\left( \\frac{1}{k_i} + \\frac{1}{k_{i+1}} \\right) = F_{i+\\frac{1}{2}} \\frac{h}{2} \\left( \\frac{k_{i+1} + k_i}{k_i k_{i+1}} \\right)\n$$\n分离出 $F_{i+\\frac{1}{2}}$ 得到最终表达式：\n$$\nF_{i+\\frac{1}{2}} = (u_i - u_{i+1}) \\frac{2}{h} \\frac{k_i k_{i+1}}{k_i + k_{i+1}}\n$$\n这可以写成：\n$$\nF_{i+\\frac{1}{2}} = \\frac{2 k_i k_{i+1}}{k_i + k_{i+1}} \\frac{u_i - u_{i+1}}{h}\n$$\n此表达式代表从单元 $i$ 到单元 $i+1$ 的通量。如果 $u_i  u_{i+1}$，通量为正，正如所预期的。界面处的有效扩散系数 $\\frac{2 k_i k_{i+1}}{k_i + k_{i+1}}$ 是相邻系数的调和平均值的两倍。这种构造方法在离散层面上正确地满足了通量的连续性，是内在地守恒的，并且已知其可为均匀网格上的单元中心值提供二阶精度的离散化。",
            "answer": "$$\n\\boxed{\\frac{2 k_i k_{i+1}}{k_i + k_{i+1}} \\frac{u_i - u_{i+1}}{h}}\n$$"
        },
        {
            "introduction": "在复杂的数值代码中施加界面条件可能具有挑战性。本练习探讨了一种常见的弱施加技术——罚函数法，并分析其在施加界面连续性约束时的行为。您将发现，这种近似施加会导致非物理的人为现象，例如虚假的电势跳跃，并通过理论推导和编程实践来量化这一误差，从而对数值方法的权衡（如精度与实现简易性）有更具体的理解。",
            "id": "3510848",
            "problem": "考虑一个一维静电界面问题，该问题存在于一个由两个均匀、各向同性的电介质子域组成的平面分层介质中。设左子域为 $\\Omega_1 = [-L_1, 0]$，其介电常数为 $\\epsilon_1$；右子域为 $\\Omega_2 = [0, L_2]$，其介电常数为 $\\epsilon_2$。静电势用 $\\phi(x)$ 表示，并在每个子域中满足静电学高斯定律 $\\nabla \\cdot (\\epsilon \\nabla \\phi) = 0$。狄利克雷边界条件规定为 $\\phi(-L_1) = V_1$ 和 $\\phi(L_2) = V_2$。在界面 $x=0$ 处，均匀的表面电荷密度 $\\sigma_s$ 引起电位移场法向分量的跳变，该跳变必须满足跳变关系 $[\\epsilon \\partial_n \\phi] = \\sigma_s$，其中 $[\\cdot]$ 表示穿过界面的跳变，单位法向量从 $\\Omega_1$ 指向 $\\Omega_2$。在物理上一致的模型中，电势是连续的，因此 $[\\phi]=0$。\n\n假设在每个子域中使用最低阶近似：对于 $x \\in [-L_1,0]$，$\\phi_1(x) = a_1 x + b_1$；对于 $x \\in [0,L_2]$，$\\phi_2(x) = a_2 x + b_2$。在精确的界面强制下，连续性 $[\\phi]=0$ 和跳变条件 $[\\epsilon \\partial_n \\phi] = \\sigma_s$ 对未知数 $a_1$、$a_2$、$b_1$ 和 $b_2$ 施加了两个线性约束，此外还有边界条件 $\\phi_1(-L_1) = V_1$ 和 $\\phi_2(L_2) = V_2$。求解这些方程可以得到物理上一致的解，其中 $[\\phi]=0$。\n\n在许多数值格式中，界面条件是弱施加的。考虑以下两种策略：\n\n- 对 $[\\phi]=0$ 进行罚函数强制：该方法在满足边界值和强施加通量跳变条件的约束下，最小化一个离散泛函，但用一个罚函数项代替了电势的精确连续性。定义泛函\n$$\nJ(a_1,a_2) = \\int_{-L_1}^{0} \\epsilon_1 \\left(\\frac{\\mathrm{d}\\phi_1}{\\mathrm{d}x}\\right)^2 \\,\\mathrm{d}x + \\int_{0}^{L_2} \\epsilon_2 \\left(\\frac{\\mathrm{d}\\phi_2}{\\mathrm{d}x}\\right)^2 \\,\\mathrm{d}x + \\frac{\\gamma}{2} \\left(b_2 - b_1\\right)^2,\n$$\n约束条件为 $\\phi_1(-L_1) = V_1$、$\\phi_2(L_2) = V_2$ 和 $\\epsilon_2 a_2 - \\epsilon_1 a_1 = \\sigma_s$。此处 $\\gamma0$ 是控制连续性强制强度的罚参数。当 $\\gamma$ 为有限值时（欠罚），罚方法通常会引起一个伪势跳变 $[\\phi] = b_2 - b_1 \\neq 0$。\n\n- Nitsche 界面条件强制：对称 Nitsche 方法向双线性形式中添加一致性项，以一种一致且稳定的方式弱施加电势的连续性和通量跳变关系。在本文所考虑的一维分段线性设置中，对称 Nitsche 方法重现了精确的界面条件，并且对于在该方法的稳定范围内选择的所有稳定化参数，都能得到 $[\\phi]=0$。因此，在这种设置下，它不会引起伪 $[\\phi]$。\n\n从静电学的基本定律和定义出发（高斯定律和边界/界面条件），推导出其解能产生罚函数引起的伪跳变 $[\\phi] = b_2 - b_1$（对于有限 $\\gamma$）的代数系统，并将其与能得到 $[\\phi]=0$ 的 Nitsche/强施加方法进行对比。然后实现一个程序，对以下测试套件计算两种强制策略下的伪势跳变 $[\\phi]$。\n\n所有物理量必须在国际单位制（SI）下处理。使用：\n- $\\epsilon_1$ 和 $\\epsilon_2$ 的单位为法拉每米，\n- $L_1$ 和 $L_2$ 的单位为米，\n- $V_1$ 和 $V_2$ 的单位为伏特，\n- $\\sigma_s$ 的单位为库仑每平方米，\n- 报告的伪 $[\\phi]$ 单位为伏特。\n\n对于罚方法，使用上述离散泛函及其在通量跳变约束下的驻定条件，罚参数 $\\gamma$ 在测试套件中给出。对于 Nitsche 方法，在此一维分段线性设置下，报告 $[\\phi]=0$，因为它重现了界面条件的强施加。\n\n测试套件（每个元组为 $(\\epsilon_1,\\epsilon_2,L_1,L_2,V_1,V_2,\\sigma_s,\\gamma)$）：\n1. $(8.854\\times 10^{-12},\\, 3.5416\\times 10^{-11},\\, 0.05,\\, 0.05,\\, 0.0,\\, 1.0,\\, 1.0\\times 10^{-6},\\, 1.0\\times 10^{2})$ — 正常情况，具有中等对比度和中等惩罚。\n2. $(8.854\\times 10^{-12},\\, 3.5416\\times 10^{-11},\\, 0.05,\\, 0.05,\\, 0.0,\\, 1.0,\\, 1.0\\times 10^{-6},\\, 1.0\\times 10^{-3})$ — 欠罚情况。\n3. $(8.854\\times 10^{-12},\\, 3.5416\\times 10^{-11},\\, 0.05,\\, 0.05,\\, 0.0,\\, 1.0,\\, 1.0\\times 10^{-6},\\, 1.0\\times 10^{8})$ — 接近强施加的重罚情况。\n4. $(8.854\\times 10^{-12},\\, 8.854\\times 10^{-10},\\, 0.01,\\, 0.2,\\, 0.0,\\, 5.0,\\, 5.0\\times 10^{-6},\\, 1.0\\times 10^{1})$ — 高介电常数对比度和不对称长度。\n\n你的程序应该为每个测试用例计算两个数：\n- 由罚函数强制（有限 $\\gamma$）引起的伪 $[\\phi]$（单位：伏特），\n- Nitsche/强施加的伪 $[\\phi]$（单位：伏特）（在此设置下应为零）。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于上述四个测试用例，输出必须是按顺序排列的扁平列表\n$$\n[\\,[\\phi]_{\\text{penalty},1},\\,[\\phi]_{\\text{nitsche},1},\\,[\\phi]_{\\text{penalty},2},\\,[\\phi]_{\\text{nitsche},2},\\,[\\phi]_{\\text{penalty},3},\\,[\\phi]_{\\text{nitsche},3},\\,[\\phi]_{\\text{penalty},4},\\,[\\phi]_{\\text{nitsche},4}\\,],\n$$\n其中每个条目都是一个以伏特为单位的浮点数。",
            "solution": "该问题要求推导和计算在两个电介质界面处，由基于罚函数的界面条件弱施加所引起的伪势跳变。这与 Nitsche 方法形成对比，后者在这种特定的一维设置下，重现了没有电势跳变的精确解。\n\n### 罚方法伪势跳变的推导\n\n目标是找到系数 $a_1, a_2, b_1, b_2$，使得泛函 $J$ 在给定约束下最小化。\n电势的线性近似为 $\\phi_1(x) = a_1 x + b_1$ 和 $\\phi_2(x) = a_2 x + b_2$。梯度是常数：$\\frac{\\mathrm{d}\\phi_1}{\\mathrm{d}x} = a_1$ 和 $\\frac{\\mathrm{d}\\phi_2}{\\mathrm{d}x} = a_2$。\n\n在每个子域中的控制方程为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\epsilon \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) = 0\n$$\n由于 $\\epsilon$ 在每个子域中是常数，这意味着 $\\frac{\\mathrm{d}^2\\phi}{\\mathrm{d}x^2}=0$，这与分段线性近似是一致的。\n\n精确的界面条件是：\n$$\n[\\phi] \\equiv \\phi(0^+) - \\phi(0^-) = 0\n$$\n$$\n[\\epsilon \\partial_n \\phi] \\equiv \\epsilon_2 \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\rvert_{x=0^+} - \\epsilon_1 \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\rvert_{x=0^-} = \\sigma_s\n$$\n\n对于罚方法，我们最小化以下泛函：\n$$J(a_1, a_2, b_1, b_2) = \\epsilon_1 a_1^2 L_1 + \\epsilon_2 a_2^2 L_2 + \\frac{\\gamma}{2} (b_2 - b_1)^2$$\n并受到以下约束：\n1. $\\phi_1(-L_1) = V_1 \\implies-a_1 L_1 + b_1 = V_1 \\implies b_1 = V_1 + a_1 L_1$\n2. $\\phi_2(L_2) = V_2 \\implies a_2 L_2 + b_2 = V_2 \\implies b_2 = V_2 - a_2 L_2$\n3. $\\epsilon_2 a_2 - \\epsilon_1 a_1 = \\sigma_s$\n\n将 $b_1$ 和 $b_2$ 的表达式代入泛函，我们得到一个只依赖于 $a_1$ 和 $a_2$ 的泛函 $J$。伪势跳变项 $b_2-b_1$ 变为：\n$$b_2 - b_1 = (V_2 - a_2 L_2) - (V_1 + a_1 L_1) = (V_2 - V_1) - (a_1 L_1 + a_2 L_2)$$\n要最小化的泛函是：\n$$J(a_1, a_2) = \\epsilon_1 a_1^2 L_1 + \\epsilon_2 a_2^2 L_2 + \\frac{\\gamma}{2} ((V_2 - V_1) - (a_1 L_1 + a_2 L_2))^2$$\n这是一个在约束 $g(a_1, a_2) = \\epsilon_2 a_2 - \\epsilon_1 a_1 - \\sigma_s = 0$ 下的约束优化问题。我们使用拉格朗日乘子法，拉格朗日量 $\\mathcal{L}$ 为：\n$$\\mathcal{L}(a_1, a_2, \\lambda) = J(a_1, a_2) - \\lambda g(a_1, a_2)$$\n通过将 $\\mathcal{L}$ 对 $a_1, a_2,$ 和 $\\lambda$ 的偏导数设为零来找到驻定条件。\n设 $[\\phi]_p = b_2 - b_1$ 为罚方法产生的伪势跳变。驻定条件为：\n$$\\frac{\\partial \\mathcal{L}}{\\partial a_1} = 2 \\epsilon_1 a_1 L_1 - \\gamma L_1 [\\phi]_p + \\lambda \\epsilon_1 = 0$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial a_2} = 2 \\epsilon_2 a_2 L_2 - \\gamma L_2 [\\phi]_p - \\lambda \\epsilon_2 = 0$$\n$$\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -(\\epsilon_2 a_2 - \\epsilon_1 a_1 - \\sigma_s) = 0$$\n从前两个方程中解出 $\\lambda$：\n$$\\lambda = -2 a_1 L_1 + \\frac{\\gamma L_1}{\\epsilon_1} [\\phi]_p$$\n$$\\lambda = 2 a_2 L_2 - \\frac{\\gamma L_2}{\\epsilon_2} [\\phi]_p$$\n令两个 $\\lambda$ 表达式相等：\n$$-2 a_1 L_1 + \\frac{\\gamma L_1}{\\epsilon_1} [\\phi]_p = 2 a_2 L_2 - \\frac{\\gamma L_2}{\\epsilon_2} [\\phi]_p$$\n整理后得到：\n$$2 a_1 L_1 + 2 a_2 L_2 = \\gamma \\left(\\frac{L_1}{\\epsilon_1} + \\frac{L_2}{\\epsilon_2}\\right) [\\phi]_p$$\n根据 $[\\phi]_p$ 的定义 $([\\phi]_p = (V_2 - V_1) - (a_1 L_1 + a_2 L_2))$，我们有 $a_1 L_1 + a_2 L_2 = (V_2 - V_1) - [\\phi]_p$。将其代入上式：\n$$2((V_2 - V_1) - [\\phi]_p) = \\gamma \\left(\\frac{L_1}{\\epsilon_1} + \\frac{L_2}{\\epsilon_2}\\right) [\\phi]_p$$\n求解 $[\\phi]_p$：\n$$2(V_2 - V_1) = [\\phi]_p \\left(2 + \\gamma \\left(\\frac{L_1}{\\epsilon_1} + \\frac{L_2}{\\epsilon_2}\\right)\\right)$$\n伪势跳变的最终表达式为：\n$$[\\phi]_p = \\frac{2 (V_2 - V_1)}{2 + \\gamma \\left(\\frac{L_1}{\\epsilon_1} + \\frac{L_2}{\\epsilon_2}\\right)}$$\n这个结果表明，跳变与施加的电势差 $V_2-V_1$ 成正比，与罚参数 $\\gamma$ 和子域的“电阻”项 $(L_1/\\epsilon_1 + L_2/\\epsilon_2)$ 成反比。值得注意的是，跳变与表面电荷密度 $\\sigma_s$ 无关，因为通量跳变条件被强施加为一个硬约束。\n\n### Nitsche/强施加\n问题文本正确地指出，对于这个一维分段线性问题，对称 Nitsche 方法重现了精确解，这等同于对所有界面条件进行强施加。根据定义，强施加意味着 $[\\phi] = 0$。因此，对于所有测试用例，Nitsche 方法的伪跳变为 0。\n\n### 实现\n我们将实现一个 Python 程序，该程序使用推导出的公式计算每个测试用例的罚函数跳变 $[\\phi]_p$，并将 Nitsche 跳变设为 0。所有结果将被收集到一个单一的扁平列表中并打印出来。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the spurious potential jump at an electrostatic interface for two\n    different numerical enforcement schemes: Penalty and Nitsche.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (epsilon_1, epsilon_2, L_1, L_2, V_1, V_2, sigma_s, gamma)\n    # Units are SI: F/m, m, V, C/m^2, and gamma's units are such that the penalty\n    # term has units of energy (Joules).\n    test_cases = [\n        # (Parameter set 1)\n        (8.854e-12, 3.5416e-11, 0.05, 0.05, 0.0, 1.0, 1.0e-6, 1.0e2),\n        # (Parameter set 2)\n        (8.854e-12, 3.5416e-11, 0.05, 0.05, 0.0, 1.0, 1.0e-6, 1.0e-3),\n        # (Parameter set 3)\n        (8.854e-12, 3.5416e-11, 0.05, 0.05, 0.0, 1.0, 1.0e-6, 1.0e8),\n        # (Parameter set 4)\n        (8.854e-12, 8.854e-10, 0.01, 0.2, 0.0, 5.0, 5.0e-6, 1.0e1),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        eps1, eps2, L1, L2, V1, V2, sigma_s, gamma = case\n\n        # Calculate the spurious potential jump for the Penalty method.\n        # The derived formula is:\n        # [phi]_penalty = 2 * (V2 - V1) / (2 + gamma * (L1/eps1 + L2/eps2))\n        \n        v_diff = V2 - V1\n        \n        # The term R_eff = L1/eps1 + L2/eps2 can be seen as an effective\n        # resistance-like term for the 1D geometry.\n        resistance_term = L1 / eps1 + L2 / eps2\n        \n        denominator = 2.0 + gamma * resistance_term\n        \n        # Handle the case where the denominator might be close to zero,\n        # although physically it should be positive.\n        if denominator == 0:\n            # This case is physically not expected with gamma > 0.\n            # It would imply an infinite jump, which we represent as NaN.\n            phi_jump_penalty = np.nan\n        else:\n            phi_jump_penalty = (2.0 * v_diff) / denominator\n            \n        results.append(phi_jump_penalty)\n\n        # For the Nitsche method, as stated in the problem for this 1D\n        # piecewise linear case, it reproduces strong enforcement, so the\n        # potential jump is exactly zero.\n        phi_jump_nitsche = 0.0\n        results.append(phi_jump_nitsche)\n\n    # Format the final output as a comma-separated list of floating-point numbers\n    # enclosed in square brackets.\n    print(f\"[{','.join(f'{r:.18e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}