{
    "hands_on_practices": [
        {
            "introduction": "在求解复杂的流固耦合问题之前，我们必须掌握用连续介质力学的语言来描述流体运动。本练习  侧重于将速度梯度张量分解为其对称部分（变形率张量）和反对称部分（自旋张量）。掌握这一基本计算，有助于将流体的速度场与引起结构变形的应力联系起来，这是流固耦合“相互作用”的核心。",
            "id": "3508120",
            "problem": "考虑在流固耦合（FSI）环境中，一个与柔性壁面相邻的变形域内的二维流体流动。流体速度场由 $\\mathbf{v}(\\mathbf{x}) = (a\\,x,\\, b\\,y,\\, 0)$ 给出，其中 $a$ 和 $b$ 是单位为 $\\mathrm{s}^{-1}$ 的常数参数。在连续介质运动学中，速度梯度定义为 $\\mathbf{L} = \\nabla \\mathbf{v}$，其相关的对称和反对称部分分别定义为形变率张量 $\\mathbf{D}$ 和自旋张量 $\\mathbf{W}$，使得 $\\mathbf{L} = \\mathbf{D} + \\mathbf{W}$，$\\mathbf{D}^{\\mathsf{T}} = \\mathbf{D}$，以及 $\\mathbf{W}^{\\mathsf{T}} = -\\mathbf{W}$。\n\n使用连续介质力学的基本定义，不借助任何预先推导的快捷公式，计算给定 $\\mathbf{v}(\\mathbf{x})$ 的 $\\mathbf{D}$ 和 $\\mathbf{W}$ 的精确形式。然后，在流固耦合的背景下解释它们的物理意义，重点关注 $\\mathbf{D}$ 和 $\\mathbf{W}$ 如何与柔性壁面附近流体元的局部拉伸/压缩和刚体旋转相关联，并陈述流动在何种条件下是运动学上不可压缩的。\n\n将您的最终答案表示为对 $(\\mathbf{D}, \\mathbf{W})$，使用 $\\mathrm{pmatrix}$ 环境将其写成一个行矩阵中的两个 $3\\times 3$ 矩阵。最终的方框表达式中不需要四舍五入，也不应包含任何单位。",
            "solution": "首先根据所需标准对问题进行验证。\n\n**第一步：提取已知条件**\n-   背景是与柔性壁面相邻的变形域中的二维流体流动（流固耦合）。\n-   流体速度场为 $\\mathbf{v}(\\mathbf{x}) = (a\\,x,\\, b\\,y,\\, 0)$。\n-   $a$ 和 $b$ 是单位为 $\\mathrm{s}^{-1}$ 的常数参数。\n-   速度梯度张量定义为 $\\mathbf{L} = \\nabla \\mathbf{v}$。\n-   形变率张量 $\\mathbf{D}$ 是 $\\mathbf{L}$ 的对称部分，使得 $\\mathbf{D}^{\\mathsf{T}} = \\mathbf{D}$。\n-   自旋张量 $\\mathbf{W}$ 是 $\\mathbf{L}$ 的反对称部分，使得 $\\mathbf{W}^{\\mathsf{T}} = -\\mathbf{W}$。\n-   速度梯度的分解为 $\\mathbf{L} = \\mathbf{D} + \\mathbf{W}$。\n-   任务是：\n    1.  根据基本定义计算 $\\mathbf{D}$ 和 $\\mathbf{W}$ 的精确形式。\n    2.  在流固耦合的背景下解释它们的物理意义。\n    3.  陈述运动学上不可压缩的条件。\n-   最终答案格式被指定为对 $(\\mathbf{D}, \\mathbf{W})$，表示为一个行矩阵中的两个 $3\\times 3$ 矩阵。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题基于连续介质力学的基本原理，特别是流体流动的运动学。速度梯度张量、形变率张量和自旋张量的定义都是标准的。给定的速度场是线性流的一个经典例子。FSI的背景是恰当的，因为这些运动学量对于确定作用在结构上的流体应力至关重要。该问题是科学上合理的。\n-   **提法恰当：** 所有必要信息都已提供。速度场被明确定义，任务清晰明确。根据所提供的数据和定义，存在一个关于 $\\mathbf{D}$、$\\mathbf{W}$ 和不可压缩条件的唯一解。\n-   **客观性：** 问题以精确、客观的语言陈述，没有任何主观或推测性元素。\n-   **完整性与一致性：** 问题是自洽的。使用三分量向量 $\\mathbf{v} = (v_x, v_y, 0)$ 表示二维流动是一种标准且一致的做法，这意味着分析将在一个三维笛卡尔坐标系 $(x,y,z)$ 中进行，其中流动在 $z$ 方向上没有分量或变化。\n-   **现实性与可行性：** 该速度场是某些流动类型（如角区流或拉伸流）的简化但物理上合理的表示。常数 $a$ 和 $b$ 的单位对于应变率而言在量纲上是正确的。\n-   **结论：** 该问题有效，因为它具有科学依据，提法恰当，客观，完整，并且没有可识别的缺陷。\n\n**第三步：判定与行动**\n-   该问题被判定为**有效**。将继续进行求解过程。\n\n**求解推导**\n\n该问题要求计算并解释给定速度场 $\\mathbf{v}(\\mathbf{x})$ 的形变率张量 $\\mathbf{D}$ 和自旋张量 $\\mathbf{W}$。\n\n在笛卡尔坐标系 $\\mathbf{x} = (x, y, z)$ 中，速度场为 $\\mathbf{v} = (v_x, v_y, v_z) = (a\\,x, b\\,y, 0)$。参数 $a$ 和 $b$ 是常数。\n\n第一步是计算速度梯度张量 $\\mathbf{L}$，其分量定义为 $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$。我们将它表示为一个 $3 \\times 3$ 矩阵。\n\n各分量为：\n$L_{11} = \\frac{\\partial v_x}{\\partial x} = \\frac{\\partial(a\\,x)}{\\partial x} = a$\n$L_{12} = \\frac{\\partial v_x}{\\partial y} = \\frac{\\partial(a\\,x)}{\\partial y} = 0$\n$L_{13} = \\frac{\\partial v_x}{\\partial z} = \\frac{\\partial(a\\,x)}{\\partial z} = 0$\n\n$L_{21} = \\frac{\\partial v_y}{\\partial x} = \\frac{\\partial(b\\,y)}{\\partial x} = 0$\n$L_{22} = \\frac{\\partial v_y}{\\partial y} = \\frac{\\partial(b\\,y)}{\\partial y} = b$\n$L_{23} = \\frac{\\partial v_y}{\\partial z} = \\frac{\\partial(b\\,y)}{\\partial z} = 0$\n\n$L_{31} = \\frac{\\partial v_z}{\\partial x} = \\frac{\\partial(0)}{\\partial x} = 0$\n$L_{32} = \\frac{\\partial v_z}{\\partial y} = \\frac{\\partial(0)}{\\partial y} = 0$\n$L_{33} = \\frac{\\partial v_z}{\\partial z} = \\frac{\\partial(0)}{\\partial z} = 0$\n\n将这些分量组合成一个矩阵，得到速度梯度张量：\n$$\n\\mathbf{L} = \\nabla \\mathbf{v} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n$\\mathbf{L}$ 的转置为：\n$$\n\\mathbf{L}^{\\mathsf{T}} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n在这个特定情况下，$\\mathbf{L}$ 是一个对称矩阵，即 $\\mathbf{L} = \\mathbf{L}^{\\mathsf{T}}$。\n\n形变率张量 $\\mathbf{D}$ 是 $\\mathbf{L}$ 的对称部分，定义为 $\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})$。\n$$\n\\mathbf{D} = \\frac{1}{2} \\left( \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 2a & 0 & 0 \\\\ 0 & 2b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\n自旋张量 $\\mathbf{W}$ 是 $\\mathbf{L}$ 的反对称部分，定义为 $\\mathbf{W} = \\frac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}})$。\n$$\n\\mathbf{W} = \\frac{1}{2} \\left( \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n由于 $\\mathbf{L}$ 被发现是对称的，所以 $\\mathbf{W} = \\mathbf{0}$ 的结果是预料之中的。自旋张量为零的流动被称为无旋流。\n\n**在流固耦合背景下的物理意义**\n\n1.  **形变率张量 $\\mathbf{D}$**：此张量描述了流体元被拉伸、压缩和剪切的速率。\n    -   对角分量 $D_{11}=a$ 和 $D_{22}=b$ 分别表示沿 $x$ 轴和 $y$ 轴的拉伸应变率（拉伸或压缩）。如果 $a>0$，流体元在 $x$ 方向上拉伸；如果 $a<0$，则在压缩。同样的情况也适用于 $b$ 和 $y$ 方向。\n    -   非对角分量表示剪切应变率。在这种情况下，它们都为零，这意味着初始边与坐标轴对齐的流体元没有角变形。\n    -   在流固耦合问题中，$\\mathbf{D}$ 与流体施加在柔性壁面上的粘性应力有根本联系。对于牛顿流体，粘性应力张量 $\\boldsymbol{\\tau}$ 与 $\\mathbf{D}$ 成线性比例（即 $\\boldsymbol{\\tau} = 2\\mu\\mathbf{D} + \\lambda(\\mathrm{tr}(\\mathbf{D}))\\mathbf{I}$，其中 $\\mu$ 和 $\\lambda$ 是粘度系数）。因此，速率为 $a$ 和 $b$ 的拉伸应变会在壁面上产生法向粘性应力，从而对导致结构变形的压力和力产生贡献。剪切应变率的缺失意味着在坐标方向上没有粘性剪切应力。\n\n2.  **自旋张量 $\\mathbf{W}$**：此张量描述了流体元的刚体旋转速率。它与流动的涡量 $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$ 直接相关。\n    -   在这种情况下，$\\mathbf{W}$ 是零矩阵。这表示流动是无旋的（$\\boldsymbol{\\omega} = \\mathbf{0}$）。流体元平移和变形，但它们不经历任何局部的、类似刚体的旋转。\n    -   在流固耦合的背景下，无旋转简化了流固相互作用。旋转流可以在柔性结构上引起复杂的非定常载荷和扭矩，可能导致诸如涡激振动等现象。对于这个特定的流场，不存在这种旋转效应。相互作用纯粹由压力和拉伸粘性应力驱动。\n\n**不可压缩性条件**\n\n如果任何给定流体元的体积在其移动和变形过程中保持不变，则该流动是运动学上不可压缩的。这个数学条件表示为速度场的散度处处为零。\n$$\n\\nabla \\cdot \\mathbf{v} = 0\n$$\n该条件也等同于形变率张量的迹为零，即 $\\mathrm{tr}(\\mathbf{D}) = 0$，因为 $\\mathrm{tr}(\\mathbf{D}) = \\mathrm{tr}(\\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})) = \\mathrm{tr}(\\mathbf{L}) = \\nabla \\cdot \\mathbf{v}$。\n\n我们来计算给定速度场的散度：\n$$\n\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} + \\frac{\\partial v_z}{\\partial z} = \\frac{\\partial(a\\,x)}{\\partial x} + \\frac{\\partial(b\\,y)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = a + b\n$$\n为了使流动不可压缩，散度必须为零。因此，条件是：\n$$\na + b = 0\n$$\n这意味着，为了使流动保持体积，一个方向上的任何拉伸速率（例如 $a$）必须被另一个方向上的压缩速率（$b = -a$）精确平衡。这是经历纯应变的不可压缩二维流的一个典型特征。",
            "answer": "$$\n\\boxed{\n\\left( \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}, \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right)\n}\n$$"
        },
        {
            "introduction": "在使用分区格式模拟流固耦合时，数值稳定性是一个主要问题。本练习  通过一个简化的 FSI 系统一维模型，来探究著名的“附加质量不稳定性”。通过解析推导一种交错耦合格式的稳定性极限，您将深刻理解为何这类方法会失效，以及结构质量和附加质量等物理参数如何决定这种行为。",
            "id": "3508151",
            "problem": "流固耦合（FSI）的一个一维模拟是一个位移为 $x(t)$ 的活塞状界面，由一个刚度为 $k_s$ 的线性弹簧驱动，该弹簧连接到一个点质量 $m_s$ 上，该界面移动一列不可压缩的无粘性流体。对于小振幅运动，流体响应可以通过作用在界面上的附加质量 $m_a$ 来建模。根据牛顿第二定律得到的半离散常微分方程（ODE）系统是\n- 结构：$m_s \\ddot{x}(t) + k_s x(t) = t_{f \\rightarrow s}(t)$，\n- 流体施加于结构的牵引力：$t_{f \\rightarrow s}(t) = - m_a \\ddot{x}(t)$，\n因此，耦合的单体方程为 $(m_s + m_a)\\ddot{x}(t) + k_s x(t) = 0$。\n\n考虑一个具有恒定时间步长 $\\Delta t$ 的松耦合交错格式，在每个整数时间层 $t^n = n \\Delta t$ 上按如下方式顺序推进流体和结构：\n1) 流体步（耦合显式）：使用基于过去结构位移的界面加速度的二阶后向差分近似，在时间层 $n$ 评估流体牵引力，\n$$t_{f \\rightarrow s}^n \\equiv - m_a a^{n,*}, \\quad a^{n,*} := \\frac{x^n - 2 x^{n-1} + x^{n-2}}{\\Delta t^2}。$$\n2) 结构步（中心差分更新）：在区间 $[t^n,t^{n+1}]$ 上保持 $t_{f \\rightarrow s}^n$ 不变，通过以下方式推进结构\n$$m_s \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2} + k_s x^n = t_{f \\rightarrow s}^n。$$\n\n假设 $m_s > m_a > 0$ 且 $k_s > 0$。从上述半离散常微分方程和指定的交错格式出发，推导控制 $\\{x^n\\}$ 的线性递推关系，并进行正规模态分析以确定关于 $\\Delta t$ 的线性稳定性条件。然后，用 $m_s$、$m_a$ 和 $k_s$ 将最大稳定时间步长 $\\Delta t_{\\max}$ 表示为以秒为单位的闭式解析表达式。不需要进行数值计算。请以解析表达式的形式提供最终答案；不要四舍五入。答案必须是单个表达式，而不是不等式。",
            "solution": "该问题陈述是流固耦合（FSI）数值分析中一个有效的、适定的问题。它要求对一个简化的一维FSI模型的标准松耦合显式交错格式进行稳定性分析。所有参数和控制方程都有明确定义并具有科学依据。\n\n求解过程首先推导控制离散界面位移 $x^n$ 的单一线性递推关系。随后，对该递推关系进行正规模态（或冯·诺依曼）稳定性分析，以确定数值解保持有界的条件。该条件得出了最大允许时间步长 $\\Delta t_{\\max}$。\n\n交错格式由每个时间层 $t^n = n \\Delta t$ 上的两个方程定义。\n第一个是基于过去结构位移的流体牵引力的显式计算：\n$$t_{f \\rightarrow s}^n = - m_a a^{n,*} = - m_a \\frac{x^n - 2 x^{n-1} + x^{n-2}}{\\Delta t^2} \\quad (1)$$\n第二个是结构位移的半隐式更新，使用中心差分近似加速度：\n$$m_s \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2} + k_s x^n = t_{f \\rightarrow s}^n \\quad (2)$$\n\n为了推导位移序列 $\\{x^n\\}$ 的完整递推关系，我们将流体牵引力的表达式，即方程 $(1)$，代入结构动力学方程，即方程 $(2)$：\n$$m_s \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2} + k_s x^n = - m_a \\frac{x^n - 2 x^{n-1} + x^{n-2}}{\\Delta t^2}$$\n为消去分数，我们将整个方程乘以 $\\Delta t^2$：\n$$m_s (x^{n+1} - 2 x^n + x^{n-1}) + k_s \\Delta t^2 x^n = -m_a (x^n - 2 x^{n-1} + x^{n-2})$$\n现在，我们将所有项收集到左侧，并按其时间层索引（$n+1$、$n$、$n-1$、$n-2$）进行分组：\n$$m_s x^{n+1} + (-2 m_s x^n + k_s \\Delta t^2 x^n + m_a x^n) + (m_s x^{n-1} - 2 m_a x^{n-1}) + m_a x^{n-2} = 0$$\n将位移项提出公因式，得到最终的三阶齐次线性递推关系：\n$$m_s x^{n+1} + (m_a - 2 m_s + k_s \\Delta t^2) x^n + (m_s - 2 m_a) x^{n-1} + m_a x^{n-2} = 0 \\quad (3)$$\n\n对于正规模态分析，我们假设解的形式为 $x^n = G^n \\hat{x}$，其中 $G$ 是复放大因子，$\\hat{x}$ 是初始振幅。将此假设代入递推关系 (3)：\n$$m_s G^{n+1} \\hat{x} + (m_a - 2 m_s + k_s \\Delta t^2) G^n \\hat{x} + (m_s - 2 m_a) G^{n-1} \\hat{x} + m_a G^{n-2} \\hat{x} = 0$$\n假设存在非平凡解（$\\hat{x} \\neq 0$），并除以公因子 $G^{n-2} \\hat{x}$，我们得到放大因子 $G$ 的特征多项式：\n$$P(G) = m_s G^3 + (m_a - 2 m_s + k_s \\Delta t^2) G^2 + (m_s - 2 m_a) G + m_a = 0$$\n为使数值格式线性稳定，该多项式的所有根 $G_i$ 都必须满足条件 $|G_i| \\leq 1$。如果任何根的模大于1，解 $x^n$ 将在 $n \\rightarrow \\infty$ 时无界增长，格式是不稳定的。\n\n从稳定到不稳定的转变发生于至少一个根在复平面上穿过单位圆时。对于这种类型的显式耦合格式，不稳定性通常是由一个实根穿过 $G = -1$ 所表现出来的高频数值伪影。我们可以通过在特征多项式中令 $G = -1$ 来找到稳定性边界上的临界时间步长：\n$$P(-1) = m_s (-1)^3 + (m_a - 2 m_s + k_s \\Delta t^2) (-1)^2 + (m_s - 2 m_a) (-1) + m_a = 0$$\n$$m_s(-1) + (m_a - 2 m_s + k_s \\Delta t^2)(1) - (m_s - 2 m_a) + m_a = 0$$\n$$-m_s + m_a - 2 m_s + k_s \\Delta t^2 - m_s + 2 m_a + m_a = 0$$\n合并各项得到：\n$$k_s \\Delta t^2 - 4 m_s + 4 m_a = 0$$\n这个方程定义了稳定性边界。我们求解 $\\Delta t^2$：\n$$k_s \\Delta t^2 = 4 (m_s - m_a)$$\n$$\\Delta t^2 = \\frac{4 (m_s - m_a)}{k_s}$$\n稳定性的条件是 $\\Delta t$ 必须小于或等于满足此等式的值。因此，最大稳定时间步长 $\\Delta t_{\\max}$ 通过取正平方根得到：\n$$\\Delta t_{\\max} = \\sqrt{\\frac{4 (m_s - m_a)}{k_s}}$$\n$$\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_s - m_a}{k_s}}$$\n问题陈述中 $m_s > m_a > 0$ 且 $k_s > 0$，这确保了平方根内的参数为正，且存在实值的稳定时间步长。在分区FSI模拟中，这种现象被称为“附加质量不稳定性”，而推导出的稳定性极限是该模型问题的一个经典结果。稳定性条件是 $\\Delta t \\le \\Delta t_{\\max}$。问题要求的是 $\\Delta t_{\\max}$ 本身的表达式。",
            "answer": "$$\\boxed{2 \\sqrt{\\frac{m_s - m_a}{k_s}}}$$"
        },
        {
            "introduction": "在前一个练习的解析洞察基础上，我们现在转向计算方法，以评估更一般情况下的数值稳定性。这个动手编程任务  要求您基于系统放大矩阵的谱半径进行稳定性分析。这项练习将理论与实践相结合，让您能够量化分区格式的稳定性极限，并直接观察到附加质量比 $m_a/m_s$ 的关键作用，这是设计和调试 FSI 模拟的一项基本技能。",
            "id": "3508137",
            "problem": "考虑一个浸没在静止不可压缩流体中的二维柔性梁的单自由度模态表示，其中结构位移表示为 $x(t)$，结构质量为 $m_s$，结构刚度为 $k$，结构阻尼为 $c_s$。流体施加的流体动力反作用力采用类似莫里森型惯性耦合的方法进行建模，即一个乘以结构加速度的附加质量项 $m_a$ 和一个乘以结构速度的线性辐射阻尼项 $c_f$。本文旨在分析在流体反作用力存在一个时间步延迟的 Dirichlet-Neumann 型分区格式下，该耦合系统的动力学行为。\n\n推导的基本依据是 Newton 第二运动定律和标准的线性本构关系：\n- Newton 第二定律：$m \\, \\ddot{x} = \\sum F$。\n- 线性弹性恢复力：$F_{\\text{spring}} = -k \\, x$。\n- 线性粘性结构阻尼力：$F_{\\text{structural}} = -c_s \\, \\dot{x}$。\n- 流体动力惯性反作用力：$F_{\\text{added mass}} = -m_a \\, \\ddot{x}$。\n- 流体动力辐射阻尼：$F_{\\text{fluid damping}} = -c_f \\, \\dot{x}$。\n\n我们采用以下与上述定律一致的显式分区耦合算法：\n- 在大小为 $\\Delta t$ 的时间步上，使用匀加速更新来预测运动学：\n  $x_{n+1} = x_n + \\Delta t \\, v_n + \\tfrac{1}{2} \\Delta t^2 \\, a_n$ 且 $v_{n+1} = v_n + \\Delta t \\, a_n$，其中 $v = \\dot{x}$ 且 $a = \\ddot{x}$。\n- 使用结构运动方程更新结构加速度，其中流体反作用力在上一时间步进行评估：\n  $m_s \\, a_{n+1} + c_s \\, v_{n+1} + k \\, x_{n+1} = - m_a \\, a_n - c_f \\, v_n$。\n\n定义状态向量 $s_n = [x_n, v_n, a_n]^\\top$。上述算法导出一个线性时不变更新 $s_{n+1} = A(\\Delta t) \\, s_n$，其中 $3 \\times 3$ 的放大矩阵 $A(\\Delta t)$ 取决于参数 $m_s$、$m_a$、$k$、$c_s$、$c_f$ 和时间步长 $\\Delta t$。时间推进格式的稳定性由 $A(\\Delta t)$ 的谱半径决定，记为 $\\rho(A(\\Delta t))$，该格式稳定的充分必要条件是 $\\rho(A(\\Delta t)) \\leq 1$。\n\n您的任务是实现一个程序，对于每个指定的测试用例，构造上述算法所隐含的放大矩阵 $A(\\Delta t)$，计算其谱半径 $\\rho(A(\\Delta t))$，并根据条件 $\\rho(A(\\Delta t)) \\leq 1$ 确定使格式保持稳定的最大时间步 $\\Delta t_{\\text{crit}}$（单位为秒）。如果没有正的时间步满足稳定性条件，则报告 $\\Delta t_{\\text{crit}} = 0$。\n\n所有物理量必须使用国际单位制：$m_s$ 和 $m_a$ 的单位为千克 (kg)，$k$ 的单位为牛顿/米 (N/m)，$c_s$ 和 $c_f$ 的单位为牛顿·秒/米 (N·s/m)，时间单位为秒 (s)。每个测试用例的输出必须是表示 $\\Delta t_{\\text{crit}}$（单位为秒）的浮点数，四舍五入到六位小数。\n\n测试套件：\n- 案例1 (真空中的基准结构)：$m_s = 1.0$ kg, $m_a/m_s = 0.0$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 0.0$ N·s/m，$\\Delta t$ 的搜索域：$[10^{-6}, 5.0 \\times 10^{-2}]$ s。\n- 案例2 (中等附加质量和流体阻尼)：$m_s = 1.0$ kg, $m_a/m_s = 0.5$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 30.0$ N·s/m，$\\Delta t$ 的搜索域：$[10^{-6}, 5.0 \\times 10^{-2}]$ s。\n- 案例3 (接近相等的附加质量)：$m_s = 1.0$ kg, $m_a/m_s = 0.9$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 30.0$ N·s/m，$\\Delta t$ 的搜索域：$[10^{-6}, 5.0 \\times 10^{-2}]$ s。\n- 案例4 (相等的附加质量)：$m_s = 1.0$ kg, $m_a/m_s = 1.0$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 30.0$ N·s/m，$\\Delta t$ 的搜索域：$[10^{-6}, 5.0 \\times 10^{-2}]$ s。\n- 案例5 (流体比结构重)：$m_s = 1.0$ kg, $m_a/m_s = 1.5$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 30.0$ N·s/m，$\\Delta t$ 的搜索域：$[10^{-6}, 5.0 \\times 10^{-2}]$ s。\n\n算法要求：\n- 对于每个案例，根据指定的分区耦合算法和参数构造 $A(\\Delta t)$。\n- 将谱半径 $\\rho(A(\\Delta t))$ 计算为 $A(\\Delta t)$ 特征值中的最大模。\n- 通过在指定域中找到满足 $\\rho(A(\\Delta t)) \\leq 1$ 的最大 $\\Delta t$ 来确定 $\\Delta t_{\\text{crit}}$。如果存在满足条件的非空 $\\Delta t$ 区间，则使用区间限定和二分法程序来优化 $\\Delta t_{\\text{crit}}$ 的估计值，使其在四舍五入到六位小数之前达到 $10^{-9}$ 秒的绝对分辨率。如果不存在这样的 $\\Delta t$，则设置 $\\Delta t_{\\text{crit}} = 0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3]”），每个条目对应案例1到5的 $\\Delta t_{\\text{crit}}$（单位为秒），四舍五入到六位小数。",
            "solution": "问题陈述经过严格审查，被确定为有效。它在科学上基于经典力学和线性系统理论的原理，在数学上是适定的，并以客观、明确的语言表述。唯一解所需的所有必要参数和条件均已提供。该问题是流固耦合分区耦合算法数值稳定性分析中的一个标准练习。\n\n任务是为应用于流体中柔性结构的单自由度模型的给定显式分区时间推进格式确定临界时间步 $\\Delta t_{\\text{crit}}$。稳定性要求放大矩阵的谱半径 $\\rho(A(\\Delta t))$ 小于或等于1。我们将首先从给定的控制方程推导放大矩阵 $A(\\Delta t)$，然后制定一个数值程序来找到 $\\Delta t_{\\text{crit}}$。\n\n在时间步 $n$ 时，系统的状态由向量 $s_n = [x_n, v_n, a_n]^\\top$ 定义，其中 $x_n$、$v_n$ 和 $a_n$ 分别是位移、速度和加速度。时间演化是一个线性更新 $s_{n+1} = A(\\Delta t) s_n$。我们必须找到 $3 \\times 3$ 矩阵 $A(\\Delta t)$ 的分量。\n\n矩阵的前两行直接从显式运动学预测规则推导得出：\n1. $x_{n+1} = x_n + \\Delta t \\, v_n + \\frac{1}{2} \\Delta t^2 \\, a_n$\n2. $v_{n+1} = v_n + \\Delta t \\, a_n$\n\n这些方程对应于矩阵方程的前两行：\n$$\nx_{n+1} = (1)x_n + (\\Delta t)v_n + (\\tfrac{1}{2} \\Delta t^2)a_n\n$$\n$$\nv_{n+1} = (0)x_n + (1)v_n + (\\Delta t)a_n\n$$\n\n第三行从结构运动方程推导得出，其中流体反作用力在上一时间步 $n$ 进行评估：\n$$\nm_s \\, a_{n+1} + c_s \\, v_{n+1} + k \\, x_{n+1} = - m_a \\, a_n - c_f \\, v_n\n$$\n为了用第 $n$ 步的状态表示 $a_{n+1}$，我们首先分离出 $m_s \\, a_{n+1}$：\n$$\nm_s \\, a_{n+1} = -k \\, x_{n+1} - c_s \\, v_{n+1} - c_f \\, v_n - m_a \\, a_n\n$$\n接下来，我们代入 $x_{n+1}$ 和 $v_{n+1}$ 的表达式：\n$$\nm_s \\, a_{n+1} = -k (x_n + \\Delta t \\, v_n + \\tfrac{1}{2} \\Delta t^2 \\, a_n) - c_s (v_n + \\Delta t \\, a_n) - c_f \\, v_n - m_a \\, a_n\n$$\n我们按 $x_n$、$v_n$ 和 $a_n$ 对各项进行分组：\n$$\nm_s \\, a_{n+1} = (-k) x_n + (-k \\Delta t - c_s - c_f) v_n + (-\\tfrac{1}{2} k \\Delta t^2 - c_s \\Delta t - m_a) a_n\n$$\n除以结构质量 $m_s$ 得到 $a_{n+1}$ 的最终表达式：\n$$\na_{n+1} = \\left(-\\frac{k}{m_s}\\right) x_n + \\left(-\\frac{k \\Delta t}{m_s} - \\frac{c_s + c_f}{m_s}\\right) v_n + \\left(-\\frac{k \\Delta t^2}{2m_s} - \\frac{c_s \\Delta t}{m_s} - \\frac{m_a}{m_s}\\right) a_n\n$$\n综合这些结果，放大矩阵 $A(\\Delta t)$ 是：\n$$\nA(\\Delta t) =\n\\begin{pmatrix}\n1 & \\Delta t & \\frac{1}{2} \\Delta t^2 \\\\\n0 & 1 & \\Delta t \\\\\n-\\frac{k}{m_s} & -\\frac{k \\Delta t}{m_s} - \\frac{c_s+c_f}{m_s} & -\\frac{k \\Delta t^2}{2m_s} - \\frac{c_s \\Delta t}{m_s} - \\frac{m_a}{m_s}\n\\end{pmatrix}\n$$\n该格式的稳定性由该矩阵的谱半径 $\\rho(A(\\Delta t))$ 控制，即其特征值的最大绝对值。该格式稳定的充分必要条件是 $\\rho(A(\\Delta t)) \\le 1$。\n\n通过考察矩阵在极限 $\\Delta t \\to 0$ 下的情况，可以获得一个重要的见解：\n$$\nA(0) = \\lim_{\\Delta t \\to 0} A(\\Delta t) =\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n-\\frac{k}{m_s} & -\\frac{c_s+c_f}{m_s} & -\\frac{m_a}{m_s}\n\\end{pmatrix}\n$$\n这是一个下三角矩阵，所以其特征值是其对角线元素：$\\lambda_1 = 1$，$\\lambda_2 = 1$，以及 $\\lambda_3 = -m_a/m_s$。谱半径为 $\\rho(A(0)) = \\max(|\\lambda_i|) = \\max(1, |m_a/m_s|)$。\n如果质量比 $m_a/m_s > 1$，则 $\\rho(A(0)) > 1$。根据连续性，对于任何足够小的正 $\\Delta t$，都有 $\\rho(A(\\Delta t)) > 1$。这表明该格式是无条件不稳定的。对于这种情况，确保稳定性的最大时间步是 $\\Delta t_{crit} = 0$。这种现象是显式分区流固耦合（FSI）格式中“附加质量不稳定性”的一个经典例子。\n\n对于 $m_a/m_s \\le 1$ 的情况，该格式对于无穷小的时间步是稳定的。谱半径 $\\rho(A(\\Delta t))$ 通常会随着 $\\Delta t$ 的增加而增加，最终超过 $1$。我们必须找到临界时间步 $\\Delta t_{crit}$，使得 $\\rho(A(\\Delta t_{crit})) = 1$。这是一个关于函数 $f(\\Delta t) = \\rho(A(\\Delta t)) - 1$ 的求根问题。\n找到 $\\Delta t_{crit}$ 的数值算法如下：\n1. 对于每个测试用例，首先检查是否 $m_a/m_s > 1$。如果为真，则设置 $\\Delta t_{crit} = 0$。\n2. 如果 $m_a/m_s \\le 1$，则使用二分法算法在指定的搜索域 $[\\Delta t_{min}, \\Delta t_{max}]$ 内找到 $f(\\Delta t) = 0$ 的根。\n3. 二分法需要一个区间 $[t_{low}, t_{high}]$，使得 $f(t_{low}) \\le 0$（稳定）且 $f(t_{high}) > 0$（不稳定）。我们使用给定的搜索域作为初始区间。\n4. 二分法迭代地缩小区间 $[t_{low}, t_{high}]$，直到其宽度小于指定的容差 $10^{-9}$ s。$t_{low}$ 的最终值被取为 $\\Delta t_{crit}$。\n5. 对于给定的 $\\Delta t$，谱半径通过构造矩阵 $A(\\Delta t)$ 并使用标准数值线性代数例程找到其特征值的最大模来计算。\n\n此过程将对每个测试用例实施，以确定其对应的 $\\Delta t_{crit}$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for the critical time step for each test case.\n    \"\"\"\n\n    def get_spectral_radius(dt, ms, ma, k, cs, cf):\n        \"\"\"\n        Constructs the amplification matrix A(dt) and computes its spectral radius.\n        \"\"\"\n        if dt < 0 or ms <= 0:\n            return float('inf')  # Unstable\n\n        A = np.zeros((3, 3), dtype=np.float64)\n        \n        # Row 1 from x_{n+1} update\n        A[0, 0] = 1.0\n        A[0, 1] = dt\n        A[0, 2] = 0.5 * dt**2\n        \n        # Row 2 from v_{n+1} update\n        A[1, 0] = 0.0\n        A[1, 1] = 1.0\n        A[1, 2] = dt\n        \n        # Row 3 from a_{n+1} update\n        A[2, 0] = -k / ms\n        A[2, 1] = -(k * dt / ms) - (cs + cf) / ms\n        A[2, 2] = -(k * dt**2 / (2.0 * ms)) - (cs * dt / ms) - (ma / ms)\n        \n        eigenvalues = np.linalg.eigvals(A)\n        spectral_radius = np.max(np.abs(eigenvalues))\n        \n        return spectral_radius\n\n    def find_critical_dt(params):\n        \"\"\"\n        Finds the critical time step for a given set of physical parameters.\n        \"\"\"\n        ms, ma_ratio, k, cs, cf, search_domain = params\n        ma = ma_ratio * ms\n        \n        # As derived, if ma/ms > 1, the scheme is unconditionally unstable.\n        if ma / ms > 1.0:\n            return 0.0\n            \n        # For ma/ms == 1.0, the scheme is unstable for any dt > 0.\n        if np.isclose(ma / ms, 1.0):\n            return 0.0\n        \n        dt_min, dt_max = search_domain\n        \n        # Function to find the root for: rho(dt) - 1 = 0.\n        def stability_func(dt):\n            return get_spectral_radius(dt, ms, ma, k, cs, cf) - 1.0\n\n        # Check the boundaries of the search domain.\n        if stability_func(dt_min) > 0:\n            return 0.0\n\n        if stability_func(dt_max) <= 0:\n            return dt_max\n\n        # Bisection method to find dt_crit.\n        low = dt_min\n        high = dt_max\n        tolerance = 1e-9\n\n        while (high - low) > tolerance:\n            mid = low + (high - low) / 2.0\n            if mid == low or mid == high:\n                break\n\n            if stability_func(mid) <= 0:\n                low = mid\n            else:\n                high = mid\n        \n        return low\n    \n    test_cases = [\n        # (m_s, m_a/m_s, k, c_s, c_f, search_domain)\n        (1.0, 0.0, 1.0e4, 5.0, 0.0, [1e-6, 5.0e-2]),\n        (1.0, 0.5, 1.0e4, 5.0, 30.0, [1e-6, 5.0e-2]),\n        (1.0, 0.9, 1.0e4, 5.0, 30.0, [1e-6, 5.0e-2]),\n        (1.0, 1.0, 1.0e4, 5.0, 30.0, [1e-6, 5.0e-2]),\n        (1.0, 1.5, 1.0e4, 5.0, 30.0, [1e-6, 5.0e-2]),\n    ]\n    \n    results = []\n    for case in test_cases:\n        dt_crit = find_critical_dt(case)\n        results.append(f\"{dt_crit:.6f}\")\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}