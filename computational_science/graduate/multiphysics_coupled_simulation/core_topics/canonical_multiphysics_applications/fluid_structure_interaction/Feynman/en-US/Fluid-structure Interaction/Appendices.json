{
    "hands_on_practices": [
        {
            "introduction": "The interaction between a fluid and a structure is fundamentally about the transfer of momentum, which occurs through stresses at the interface. To understand these stresses, we must first master the language of continuum kinematics. This exercise  takes you back to first principles, asking you to analyze a simple but illuminating velocity field. By decomposing the velocity gradient tensor $\\mathbf{L}$ into its symmetric rate-of-deformation part $\\mathbf{D}$ and its antisymmetric spin part $\\mathbf{W}$, you will gain a direct physical intuition for how a fluid deforms and rotates locally, which is the precursor to generating the viscous forces that drive structural motion.",
            "id": "3508120",
            "problem": "Consider a two-dimensional fluid flow within a deforming domain adjacent to a compliant wall in a Fluid-Structure Interaction (FSI) setting. The fluid velocity field is given by $\\mathbf{v}(\\mathbf{x}) = (a\\,x,\\, b\\,y,\\, 0)$ where $a$ and $b$ are constant parameters with units of $\\mathrm{s}^{-1}$. In continuum kinematics, the velocity gradient is defined as $\\mathbf{L} = \\nabla \\mathbf{v}$, with associated symmetric and antisymmetric parts defined as the rate-of-deformation tensor $\\mathbf{D}$ and the spin tensor $\\mathbf{W}$, respectively, such that $\\mathbf{L} = \\mathbf{D} + \\mathbf{W}$, $\\mathbf{D}^{\\mathsf{T}} = \\mathbf{D}$, and $\\mathbf{W}^{\\mathsf{T}} = -\\mathbf{W}$.\n\nUsing fundamental definitions from continuum mechanics and without invoking any pre-derived shortcut formulas, compute the exact forms of $\\mathbf{D}$ and $\\mathbf{W}$ for the given $\\mathbf{v}(\\mathbf{x})$. Then, explain their physical meaning in the context of FSI, focusing on how $\\mathbf{D}$ and $\\mathbf{W}$ relate to local stretching/compression and rigid-body rotation of fluid elements near a compliant wall, and state the condition under which the flow is kinematically incompressible.\n\nExpress your final answer as the pair $(\\mathbf{D}, \\mathbf{W})$ written as two $3\\times 3$ matrices in a single row matrix using the $\\mathrm{pmatrix}$ environment. No rounding is needed and no units should be included in the final boxed expression.",
            "solution": "The problem is first validated against the required criteria.\n\n**Step 1: Extract Givens**\n-   The setting is a two-dimensional fluid flow in a deforming domain adjacent to a compliant wall (Fluid-Structure Interaction).\n-   The fluid velocity field is $\\mathbf{v}(\\mathbf{x}) = (a\\,x,\\, b\\,y,\\, 0)$.\n-   $a$ and $b$ are constant parameters with units of $\\mathrm{s}^{-1}$.\n-   The velocity gradient tensor is defined as $\\mathbf{L} = \\nabla \\mathbf{v}$.\n-   The rate-of-deformation tensor $\\mathbf{D}$ is the symmetric part of $\\mathbf{L}$, such that $\\mathbf{D}^{\\mathsf{T}} = \\mathbf{D}$.\n-   The spin tensor $\\mathbf{W}$ is the antisymmetric part of $\\mathbf{L}$, such that $\\mathbf{W}^{\\mathsf{T}} = -\\mathbf{W}$.\n-   The decomposition of the velocity gradient is $\\mathbf{L} = \\mathbf{D} + \\mathbf{W}$.\n-   The tasks are to:\n    1.  Compute the exact forms of $\\mathbf{D}$ and $\\mathbf{W}$ from fundamental definitions.\n    2.  Explain their physical meaning in the context of FSI.\n    3.  State the condition for kinematic incompressibility.\n-   The final answer format is specified as the pair $(\\mathbf{D}, \\mathbf{W})$ as two $3\\times 3$ matrices in a row matrix.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is based on fundamental principles of continuum mechanics, specifically the kinematics of fluid flow. The definitions of the velocity gradient tensor, rate-of-deformation tensor, and spin tensor are standard. The given velocity field is a classic example of a linear flow. The context of FSI is appropriate as these kinematic quantities are essential for determining the fluid stresses that act upon the structure. The problem is scientifically sound.\n-   **Well-Posed:** All necessary information is provided. The velocity field is explicitly defined, and the tasks are clear and unambiguous. A unique solution for $\\mathbf{D}$, $\\mathbf{W}$, and the incompressibility condition exists based on the provided data and definitions.\n-   **Objective:** The problem is stated in precise, objective language without any subjective or speculative elements.\n-   **Completeness and Consistency:** The problem is self-contained. The representation of a two-dimensional flow using a three-component vector $\\mathbf{v} = (v_x, v_y, 0)$ is a standard and consistent practice, implying that the analysis is to be performed in a three-dimensional Cartesian coordinate system $(x,y,z)$ where the flow has no component or variation in the $z$-direction.\n-   **Realism and Feasibility:** The velocity field is a simplified but physically plausible representation of certain flow types, such as flow in a corner or a stretching flow. The units for the constants $a$ and $b$ are dimensionally correct for strain rates.\n-   **Conclusion:** The problem is valid, as it is scientifically grounded, well-posed, objective, complete, and contains no identifiable flaws.\n\n**Step 3: Verdict and Action**\n-   The problem is deemed **valid**. The solution process will proceed.\n\n**Solution Derivation**\n\nThe problem asks for the computation and interpretation of the rate-of-deformation tensor $\\mathbf{D}$ and the spin tensor $\\mathbf{W}$ for a given velocity field $\\mathbf{v}(\\mathbf{x})$.\n\nThe velocity field is given in Cartesian coordinates $\\mathbf{x} = (x, y, z)$ as $\\mathbf{v} = (v_x, v_y, v_z) = (a\\,x, b\\,y, 0)$. The parameters $a$ and $b$ are constants.\n\nThe first step is to compute the velocity gradient tensor, $\\mathbf{L}$, whose components are defined as $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$. We will represent this as a $3 \\times 3$ matrix.\n\nThe components are:\n$L_{11} = \\frac{\\partial v_x}{\\partial x} = \\frac{\\partial(a\\,x)}{\\partial x} = a$\n$L_{12} = \\frac{\\partial v_x}{\\partial y} = \\frac{\\partial(a\\,x)}{\\partial y} = 0$\n$L_{13} = \\frac{\\partial v_x}{\\partial z} = \\frac{\\partial(a\\,x)}{\\partial z} = 0$\n\n$L_{21} = \\frac{\\partial v_y}{\\partial x} = \\frac{\\partial(b\\,y)}{\\partial x} = 0$\n$L_{22} = \\frac{\\partial v_y}{\\partial y} = \\frac{\\partial(b\\,y)}{\\partial y} = b$\n$L_{23} = \\frac{\\partial v_y}{\\partial z} = \\frac{\\partial(b\\,y)}{\\partial z} = 0$\n\n$L_{31} = \\frac{\\partial v_z}{\\partial x} = \\frac{\\partial(0)}{\\partial x} = 0$\n$L_{32} = \\frac{\\partial v_z}{\\partial y} = \\frac{\\partial(0)}{\\partial y} = 0$\n$L_{33} = \\frac{\\partial v_z}{\\partial z} = \\frac{\\partial(0)}{\\partial z} = 0$\n\nAssembling these components into a matrix gives the velocity gradient tensor:\n$$\n\\mathbf{L} = \\nabla \\mathbf{v} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe transpose of $\\mathbf{L}$ is:\n$$\n\\mathbf{L}^{\\mathsf{T}} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nIn this specific case, $\\mathbf{L}$ is a symmetric matrix, i.e., $\\mathbf{L} = \\mathbf{L}^{\\mathsf{T}}$.\n\nThe rate-of-deformation tensor, $\\mathbf{D}$, is the symmetric part of $\\mathbf{L}$, defined as $\\mathbf{D} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})$.\n$$\n\\mathbf{D} = \\frac{1}{2} \\left( \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 2a & 0 & 0 \\\\ 0 & 2b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\nThe spin tensor, $\\mathbf{W}$, is the antisymmetric part of $\\mathbf{L}$, defined as $\\mathbf{W} = \\frac{1}{2}(\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}})$.\n$$\n\\mathbf{W} = \\frac{1}{2} \\left( \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\nThe result $\\mathbf{W} = \\mathbf{0}$ is expected since $\\mathbf{L}$ was found to be symmetric. A flow for which the spin tensor is zero is known as an irrotational flow.\n\n**Physical Meaning in the Context of FSI**\n\n1.  **Rate-of-Deformation Tensor $\\mathbf{D}$**: This tensor describes the rate at which fluid elements are stretched, compressed, and sheared.\n    -   The diagonal components, $D_{11}=a$ and $D_{22}=b$, represent the rates of extensional strain (stretching or compression) along the $x$ and $y$ axes, respectively. If $a>0$, the fluid element is stretching in the $x$-direction; if $a<0$, it is compressing. The same applies to $b$ in the $y$-direction.\n    -   The off-diagonal components represent shearing strain rates. In this case, they are all zero, which means there is no angular distortion of fluid elements whose sides are initially aligned with the coordinate axes.\n    -   In an FSI problem, $\\mathbf{D}$ is fundamentally linked to the viscous stresses exerted by the fluid on the compliant wall. For a Newtonian fluid, the viscous stress tensor $\\boldsymbol{\\tau}$ is linearly proportional to $\\mathbf{D}$ (i.e., $\\boldsymbol{\\tau} = 2\\mu\\mathbf{D} + \\lambda(\\mathrm{tr}(\\mathbf{D}))\\mathbf{I}$, where $\\mu$ and $\\lambda$ are viscosity coefficients). Therefore, the extensional strains with rates $a$ and $b$ generate normal viscous stresses on the wall, contributing to the pressure and forces that cause the structure to deform. The absence of shear strain rates means there are no viscous shear stresses in the coordinate directions.\n\n2.  **Spin Tensor $\\mathbf{W}$**: This tensor describes the rate of rigid-body rotation of a fluid element. It is directly related to the vorticity of the flow, $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}$.\n    -   In this case, $\\mathbf{W}$ is the zero matrix. This signifies that the flow is irrotational ($\\boldsymbol{\\omega} = \\mathbf{0}$). Fluid elements translate and deform, but they do not experience any local, rigid-body-like spinning.\n    -   In an FSI context, the absence of rotation simplifies the fluid-structure interaction. Rotational flows can induce complex unsteady loads and torques on flexible structures, potentially leading to phenomena like vortex-induced vibrations. For this particular flow field, such rotational effects are absent. The interaction is purely driven by pressure and the extensional viscous stresses.\n\n**Condition for Incompressibility**\n\nA flow is kinematically incompressible if the volume of any given fluid element remains constant as it moves and deforms. This mathematical condition is expressed as the divergence of the velocity field being zero everywhere.\n$$\n\\nabla \\cdot \\mathbf{v} = 0\n$$\nThis condition is also equivalent to the trace of the rate-of-deformation tensor being zero, $\\mathrm{tr}(\\mathbf{D}) = 0$, since $\\mathrm{tr}(\\mathbf{D}) = \\mathrm{tr}(\\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})) = \\mathrm{tr}(\\mathbf{L}) = \\nabla \\cdot \\mathbf{v}$.\n\nLet's compute the divergence for the given velocity field:\n$$\n\\nabla \\cdot \\mathbf{v} = \\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y} + \\frac{\\partial v_z}{\\partial z} = \\frac{\\partial(a\\,x)}{\\partial x} + \\frac{\\partial(b\\,y)}{\\partial y} + \\frac{\\partial(0)}{\\partial z} = a + b\n$$\nFor the flow to be incompressible, the divergence must be zero. Therefore, the condition is:\n$$\na + b = 0\n$$\nThis means that for the flow to be volume-preserving, any rate of stretching in one direction (e.g., $a$) must be exactly balanced by a rate of compression in the other direction ($b = -a$). This is a characteristic feature of incompressible two-dimensional flows undergoing pure strain.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} a & 0 & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} & \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While continuum equations describe the physics, practical FSI problems are solved numerically. A common approach is a 'partitioned' scheme, where the fluid and structure equations are solved sequentially. This exercise  reveals a critical pitfall of this intuitive approach: the added-mass instability. By analyzing a simplified one-dimensional model, you will perform a linear stability analysis to derive the exact theoretical limit on the time step, discovering how the ratio of fluid 'added mass' to structural mass can render an explicit simulation unconditionally unstable.",
            "id": "3508151",
            "problem": "A one-dimensional analogue of fluid-structure interaction (FSI) is a piston-like interface of displacement $x(t)$ driven by a linear spring of stiffness $k_s$ attached to a point mass $m_s$, moving a column of incompressible inviscid fluid. For small-amplitude motions, the fluid response can be modeled by an added mass $m_a$ acting at the interface. The semi-discrete ordinary differential equation (ODE) system obtained from Newton's second law is\n- Structure: $m_s \\ddot{x}(t) + k_s x(t) = t_{f \\rightarrow s}(t)$,\n- Fluid traction on the structure: $t_{f \\rightarrow s}(t) = - m_a \\ddot{x}(t)$,\nso that the coupled monolithic equation is $(m_s + m_a)\\ddot{x}(t) + k_s x(t) = 0$.\n\nConsider a loosely coupled staggered scheme with constant time step $\\Delta t$ that advances the fluid and structure sequentially at each integer time level $t^n = n \\Delta t$ as follows:\n1) Fluid step (explicit in coupling): evaluate the fluid traction at time level $n$ using a second-order backward difference approximation of the interface acceleration based on past structural displacements,\n$$t_{f \\rightarrow s}^n \\equiv - m_a a^{n,*}, \\quad a^{n,*} := \\frac{x^n - 2 x^{n-1} + x^{n-2}}{\\Delta t^2}.$$\n2) Structure step (central-difference update): with $t_{f \\rightarrow s}^n$ held fixed over the interval $[t^n,t^{n+1}]$, advance the structure via\n$$m_s \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2} + k_s x^n = t_{f \\rightarrow s}^n.$$\n\nAssume $m_s > m_a > 0$ and $k_s > 0$. Starting from the above semi-discrete ODEs and the specified staggered scheme, derive the linear recurrence governing $\\{x^n\\}$ and perform a normal-mode analysis to determine the condition for linear stability in terms of $\\Delta t$. Then, express the maximum stable time step $\\Delta t_{\\max}$ as a closed-form analytic expression in seconds in terms of $m_s$, $m_a$, and $k_s$. No numerical evaluation is required. Provide your final answer as an analytic expression; do not round. The answer must be a single expression and not an inequality.",
            "solution": "The problem statement is a valid, well-posed problem in the numerical analysis of fluid-structure interaction (FSI). It asks for the stability analysis of a standard loosely coupled, explicit staggered scheme for a simplified one-dimensional FSI model. All parameters and governing equations are clearly defined and scientifically grounded.\n\nThe solution proceeds by first deriving the single linear recurrence relation that governs the discrete interface displacement, $x^n$. Subsequently, a normal-mode (or von Neumann) stability analysis is performed on this recurrence relation to determine the condition for which the numerical solution remains bounded. This condition yields the maximum permissible time step, $\\Delta t_{\\max}$.\n\nThe staggered scheme is defined by two equations at each time level $t^n = n \\Delta t$.\nThe first is the explicit evaluation of the fluid traction based on past structural displacements:\n$$t_{f \\rightarrow s}^n = - m_a a^{n,*} = - m_a \\frac{x^n - 2 x^{n-1} + x^{n-2}}{\\Delta t^2} \\quad (1)$$\nThe second is the semi-implicit update for the structure's displacement, using a central-difference approximation for acceleration:\n$$m_s \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2} + k_s x^n = t_{f \\rightarrow s}^n \\quad (2)$$\n\nTo derive the complete recurrence relation for the sequence of displacements $\\{x^n\\}$, we substitute the expression for the fluid traction, Equation $(1)$, into the structural dynamics equation, Equation $(2)$:\n$$m_s \\frac{x^{n+1} - 2 x^n + x^{n-1}}{\\Delta t^2} + k_s x^n = - m_a \\frac{x^n - 2 x^{n-1} + x^{n-2}}{\\Delta t^2}$$\nTo eliminate the fractions, we multiply the entire equation by $\\Delta t^2$:\n$$m_s (x^{n+1} - 2 x^n + x^{n-1}) + k_s \\Delta t^2 x^n = -m_a (x^n - 2 x^{n-1} + x^{n-2})$$\nNow, we collect all terms on the left-hand side and group them by their time-level indices ($n+1$, $n$, $n-1$, $n-2$):\n$$m_s x^{n+1} + (-2 m_s x^n + k_s \\Delta t^2 x^n + m_a x^n) + (m_s x^{n-1} - 2 m_a x^{n-1}) + m_a x^{n-2} = 0$$\nFactoring out the displacement terms gives the final third-order homogeneous linear recurrence relation:\n$$m_s x^{n+1} + (m_a - 2 m_s + k_s \\Delta t^2) x^n + (m_s - 2 m_a) x^{n-1} + m_a x^{n-2} = 0 \\quad (3)$$\n\nFor the normal-mode analysis, we assume a solution of the form $x^n = G^n \\hat{x}$, where $G$ is the complex amplification factor and $\\hat{x}$ is the initial amplitude. Substituting this ansatz into the recurrence relation (3):\n$$m_s G^{n+1} \\hat{x} + (m_a - 2 m_s + k_s \\Delta t^2) G^n \\hat{x} + (m_s - 2 m_a) G^{n-1} \\hat{x} + m_a G^{n-2} \\hat{x} = 0$$\nAssuming a non-trivial solution ($\\hat{x} \\neq 0$) and dividing by the common factor $G^{n-2} \\hat{x}$, we obtain the characteristic polynomial for the amplification factor $G$:\n$$P(G) = m_s G^3 + (m_a - 2 m_s + k_s \\Delta t^2) G^2 + (m_s - 2 m_a) G + m_a = 0$$\nFor the numerical scheme to be linearly stable, all roots $G_i$ of this polynomial must satisfy the condition $|G_i| \\leq 1$. If any root has a magnitude greater than $1$, the solution $x^n$ will grow unboundedly as $n \\rightarrow \\infty$, and the scheme is unstable.\n\nThe transition from stability to instability occurs when at least one root crosses the unit circle in the complex plane. For this type of explicit coupling scheme, the instability is typically a high-frequency numerical artifact manifested by a real root passing through $G = -1$. We can find the critical time step at the boundary of stability by setting $G = -1$ in the characteristic polynomial:\n$$P(-1) = m_s (-1)^3 + (m_a - 2 m_s + k_s \\Delta t^2) (-1)^2 + (m_s - 2 m_a) (-1) + m_a = 0$$\n$$m_s(-1) + (m_a - 2 m_s + k_s \\Delta t^2)(1) - (m_s - 2 m_a) + m_a = 0$$\n$$-m_s + m_a - 2 m_s + k_s \\Delta t^2 - m_s + 2 m_a + m_a = 0$$\nCombining the terms yields:\n$$k_s \\Delta t^2 - 4 m_s + 4 m_a = 0$$\nThis equation defines the stability boundary. We solve for $\\Delta t^2$:\n$$k_s \\Delta t^2 = 4 (m_s - m_a)$$\n$$\\Delta t^2 = \\frac{4 (m_s - m_a)}{k_s}$$\nThe condition for stability is that $\\Delta t$ must be less than or equal to the value that satisfies this equality. Therefore, the maximum stable time step, $\\Delta t_{\\max}$, is given by taking the positive square root:\n$$\\Delta t_{\\max} = \\sqrt{\\frac{4 (m_s - m_a)}{k_s}}$$\n$$\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_s - m_a}{k_s}}$$\nThe problem states that $m_s > m_a > 0$ and $k_s > 0$, which ensures that the argument of the square root is positive and a real-valued stable time step exists. This phenomenon is known as the \"added mass instability\" in partitioned FSI simulations, and the derived stability limit is a classic result for this model problem. The stability condition is $\\Delta t \\le \\Delta t_{\\max}$. The problem asks for the expression for $\\Delta t_{\\max}$ itself.",
            "answer": "$$\\boxed{2 \\sqrt{\\frac{m_s - m_a}{k_s}}}$$"
        },
        {
            "introduction": "Building on the theoretical insight from the previous analysis, this practice  moves from analytical derivation to a computational laboratory. You will implement a program to numerically investigate the added-mass instability for a single-degree-of-freedom model, exploring how stability is affected by the fluid-to-structure mass ratio. This hands-on coding exercise requires you to construct the system's amplification matrix and use its spectral radius, $\\rho(A)$, to precisely map the stability boundary, reinforcing the theoretical concepts with practical, quantitative results.",
            "id": "3508137",
            "problem": "Consider a single-degree-of-freedom modal representation of a two-dimensional flexible beam immersed in a quiescent incompressible fluid, where the structural displacement is denoted by $x(t)$, the structural mass is $m_s$, the structural stiffness is $k$, and the structural damping is $c_s$. The fluid exerts a hydrodynamic reaction force that is modeled, in the spirit of Morison-type inertial coupling, as an added-mass term $m_a$ multiplying the structural acceleration and a linear radiation damping term $c_f$ multiplying the structural velocity. The coupled dynamics under a Dirichlet-Neumann type partitioned scheme with one-time-step lag in the fluid reaction are to be analyzed.\n\nThe fundamental basis for the derivation is Newton's second law of motion and standard linear constitutive relations:\n- Newton's second law: $m \\, \\ddot{x} = \\sum F$.\n- Linear elastic restoring force: $F_{\\text{spring}} = -k \\, x$.\n- Linear viscous structural damping force: $F_{\\text{structural}} = -c_s \\, \\dot{x}$.\n- Hydrodynamic inertial reaction: $F_{\\text{added mass}} = -m_a \\, \\ddot{x}$.\n- Hydrodynamic radiation damping: $F_{\\text{fluid damping}} = -c_f \\, \\dot{x}$.\n\nWe adopt the following explicit partitioned coupling algorithm consistent with the above laws:\n- Predict kinematics using a constant-acceleration update over a time step of size $\\Delta t$: \n  $x_{n+1} = x_n + \\Delta t \\, v_n + \\tfrac{1}{2} \\Delta t^2 \\, a_n$ and $v_{n+1} = v_n + \\Delta t \\, a_n$, where $v = \\dot{x}$ and $a = \\ddot{x}$.\n- Update the structural acceleration using the structural equation of motion with fluid reaction evaluated from the previous time step:\n  $m_s \\, a_{n+1} + c_s \\, v_{n+1} + k \\, x_{n+1} = - m_a \\, a_n - c_f \\, v_n$.\n\nDefine the state vector $s_n = [x_n, v_n, a_n]^\\top$. The above algorithm induces a linear time-invariant update $s_{n+1} = A(\\Delta t) \\, s_n$ with a $3 \\times 3$ amplification matrix $A(\\Delta t)$ that depends on the parameters $m_s$, $m_a$, $k$, $c_s$, $c_f$, and the time step $\\Delta t$. Stability of the time-marching scheme is determined by the spectral radius of $A(\\Delta t)$, denoted $\\rho(A(\\Delta t))$, where the scheme is stable if and only if $\\rho(A(\\Delta t)) \\leq 1$.\n\nYour task is to implement a program that, for each specified test case, constructs the amplification matrix $A(\\Delta t)$ implied by the algorithm above, computes its spectral radius $\\rho(A(\\Delta t))$, and determines the largest time step $\\Delta t_{\\text{crit}}$ in seconds for which the scheme is stable according to the condition $\\rho(A(\\Delta t)) \\leq 1$. If no positive time step satisfies the stability condition, report $\\Delta t_{\\text{crit}} = 0$.\n\nAll physical quantities must be treated in International System of Units: $m_s$ and $m_a$ in kilograms (kg), $k$ in newtons per meter (N/m), $c_s$ and $c_f$ in newton-seconds per meter (N·s/m), time in seconds (s). The output for each test case must be a float representing $\\Delta t_{\\text{crit}}$ in seconds, rounded to six decimal places.\n\nTest suite:\n- Case 1 (baseline structure in vacuum): $m_s = 1.0$ kg, $m_a/m_s = 0.0$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 0.0$ N·s/m, search domain for $\\Delta t$: $[10^{-6}, 5.0 \\times 10^{-2}]$ s.\n- Case 2 (moderate added mass and fluid damping): $m_s = 1.0$ kg, $m_a/m_s = 0.5$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 30.0$ N·s/m, search domain for $\\Delta t$: $[10^{-6}, 5.0 \\times 10^{-2}]$ s.\n- Case 3 (near-equal added mass): $m_s = 1.0$ kg, $m_a/m_s = 0.9$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 30.0$ N·s/m, search domain for $\\Delta t$: $[10^{-6}, 5.0 \\times 10^{-2}]$ s.\n- Case 4 (equal added mass): $m_s = 1.0$ kg, $m_a/m_s = 1.0$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 30.0$ N·s/m, search domain for $\\Delta t$: $[10^{-6}, 5.0 \\times 10^{-2}]$ s.\n- Case 5 (fluid heavier than structure): $m_s = 1.0$ kg, $m_a/m_s = 1.5$, $k = 1.0 \\times 10^4$ N/m, $c_s = 5.0$ N·s/m, $c_f = 30.0$ N·s/m, search domain for $\\Delta t$: $[10^{-6}, 5.0 \\times 10^{-2}]$ s.\n\nAlgorithmic requirements:\n- For each case, construct $A(\\Delta t)$ implied by the specified coupling algorithm and parameters.\n- Compute the spectral radius $\\rho(A(\\Delta t))$ as the largest magnitude of the eigenvalues of $A(\\Delta t)$.\n- Determine $\\Delta t_{\\text{crit}}$ by identifying the largest $\\Delta t$ in the specified domain for which $\\rho(A(\\Delta t)) \\leq 1$. If there exists a nonempty interval of $\\Delta t$ satisfying the condition, refine the estimate of $\\Delta t_{\\text{crit}}$ using a bracketing and bisection procedure to achieve an absolute resolution of $10^{-9}$ s before rounding to six decimals. If no such $\\Delta t$ exists, set $\\Delta t_{\\text{crit}} = 0$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\"), where each entry corresponds to $\\Delta t_{\\text{crit}}$ in seconds for Cases 1 through 5, rounded to six decimal places.",
            "solution": "The problem statement is critically reviewed and determined to be valid. It is scientifically grounded in the principles of classical mechanics and linear systems theory, mathematically well-posed, and expressed in objective, unambiguous language. All necessary parameters and conditions for a unique solution are provided. The problem is a standard exercise in the numerical stability analysis of partitioned coupling algorithms for fluid-structure interaction.\n\nThe task is to determine the critical time step, $\\Delta t_{\\text{crit}}$, for a given explicit partitioned time-marching scheme applied to a single-degree-of-freedom model of a flexible structure in a fluid. Stability requires that the spectral radius of the amplification matrix, $\\rho(A(\\Delta t))$, be less than or equal to one. We will first derive the amplification matrix $A(\\Delta t)$ from the provided governing equations and then formulate a numerical procedure to find $\\Delta t_{crit}$.\n\nThe state of the system at time step $n$ is defined by the vector $s_n = [x_n, v_n, a_n]^\\top$, where $x_n$, $v_n$, and $a_n$ are the displacement, velocity, and acceleration, respectively. The time evolution is a linear update $s_{n+1} = A(\\Delta t) s_n$. We must find the components of the $3 \\times 3$ matrix $A(\\Delta t)$.\n\nThe first two rows of the matrix are derived directly from the explicit kinematic prediction rules:\n1. $x_{n+1} = x_n + \\Delta t \\, v_n + \\frac{1}{2} \\Delta t^2 \\, a_n$\n2. $v_{n+1} = v_n + \\Delta t \\, a_n$\n\nThese equations correspond to the first two rows of the matrix equation:\n$$\nx_{n+1} = (1)x_n + (\\Delta t)v_n + (\\tfrac{1}{2} \\Delta t^2)a_n\n$$\n$$\nv_{n+1} = (0)x_n + (1)v_n + (\\Delta t)a_n\n$$\n\nThe third row is derived from the structural equation of motion, where the fluid reaction forces are evaluated at the previous time step, $n$:\n$$\nm_s \\, a_{n+1} + c_s \\, v_{n+1} + k \\, x_{n+1} = - m_a \\, a_n - c_f \\, v_n\n$$\nTo express $a_{n+1}$ in terms of the state at step $n$, we first isolate $m_s \\, a_{n+1}$:\n$$\nm_s \\, a_{n+1} = -k \\, x_{n+1} - c_s \\, v_{n+1} - c_f \\, v_n - m_a \\, a_n\n$$\nNext, we substitute the expressions for $x_{n+1}$ and $v_{n+1}$:\n$$\nm_s \\, a_{n+1} = -k (x_n + \\Delta t \\, v_n + \\tfrac{1}{2} \\Delta t^2 \\, a_n) - c_s (v_n + \\Delta t \\, a_n) - c_f \\, v_n - m_a \\, a_n\n$$\nWe group the terms by $x_n$, $v_n$, and $a_n$:\n$$\nm_s \\, a_{n+1} = (-k) x_n + (-k \\Delta t - c_s - c_f) v_n + (-\\tfrac{1}{2} k \\Delta t^2 - c_s \\Delta t - m_a) a_n\n$$\nDividing by the structural mass $m_s$ gives the final expression for $a_{n+1}$:\n$$\na_{n+1} = \\left(-\\frac{k}{m_s}\\right) x_n + \\left(-\\frac{k \\Delta t}{m_s} - \\frac{c_s + c_f}{m_s}\\right) v_n + \\left(-\\frac{k \\Delta t^2}{2m_s} - \\frac{c_s \\Delta t}{m_s} - \\frac{m_a}{m_s}\\right) a_n\n$$\nCombining these results, the amplification matrix $A(\\Delta t)$ is:\n$$\nA(\\Delta t) =\n\\begin{pmatrix}\n1 & \\Delta t & \\frac{1}{2} \\Delta t^2 \\\\\n0 & 1 & \\Delta t \\\\\n-\\frac{k}{m_s} & -\\frac{k \\Delta t}{m_s} - \\frac{c_s+c_f}{m_s} & -\\frac{k \\Delta t^2}{2m_s} - \\frac{c_s \\Delta t}{m_s} - \\frac{m_a}{m_s}\n\\end{pmatrix}\n$$\nThe stability of the scheme is governed by the spectral radius of this matrix, $\\rho(A(\\Delta t))$, which is the maximum absolute value of its eigenvalues. The scheme is stable if and only if $\\rho(A(\\Delta t)) \\le 1$.\n\nAn important insight is gained by examining the matrix in the limit $\\Delta t \\to 0$:\n$$\nA(0) = \\lim_{\\Delta t \\to 0} A(\\Delta t) =\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n-\\frac{k}{m_s} & -\\frac{c_s+c_f}{m_s} & -\\frac{m_a}{m_s}\n\\end{pmatrix}\n$$\nThis is a lower triangular matrix, so its eigenvalues are its diagonal entries: $\\lambda_1 = 1$, $\\lambda_2 = 1$, and $\\lambda_3 = -m_a/m_s$. The spectral radius is $\\rho(A(0)) = \\max(|\\lambda_i|) = \\max(1, |m_a/m_s|)$.\nIf the mass ratio $m_a/m_s > 1$, then $\\rho(A(0)) > 1$. By continuity, $\\rho(A(\\Delta t)) > 1$ for any sufficiently small positive $\\Delta t$. This indicates that the scheme is unconditionally unstable. For such cases, the largest time step ensuring stability is $\\Delta t_{crit} = 0$. This phenomenon is a classic example of \"added mass instability\" in explicit partitioned FSI schemes.\n\nFor cases where $m_a/m_s \\le 1$, the scheme is stable for infinitesimal time steps. The spectral radius $\\rho(A(\\Delta t))$ will typically increase with $\\Delta t$, eventually exceeding $1$. We must find the critical time step $\\Delta t_{crit}$ where $\\rho(A(\\Delta t_{crit})) = 1$. This is a root-finding problem for the function $f(\\Delta t) = \\rho(A(\\Delta t)) - 1$.\nThe numerical algorithm to find $\\Delta t_{crit}$ is as follows:\n1. For each test case, first check if $m_a/m_s > 1$. If true, set $\\Delta t_{crit} = 0$.\n2. If $m_a/m_s \\le 1$, use a bisection algorithm to find the root of $f(\\Delta t) = 0$ within the specified search domain $[\\Delta t_{min}, \\Delta t_{max}]$.\n3. The bisection requires a bracket $[t_{low}, t_{high}]$ such that $f(t_{low}) \\le 0$ (stable) and $f(t_{high}) > 0$ (unstable). We use the given search domain for the initial bracket.\n4. The bisection iteratively narrows the interval $[t_{low}, t_{high}]$ until its width is less than the specified tolerance of $10^{-9}$ s. The final value of $t_{low}$ is taken as $\\Delta t_{crit}$.\n5. The spectral radius for a given $\\Delta t$ is computed by constructing the matrix $A(\\Delta t)$ and finding the maximum magnitude of its eigenvalues using standard numerical linear algebra routines.\n\nThis procedure will be implemented for each test case to determine its corresponding $\\Delta t_{crit}$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for the critical time step for each test case.\n    \"\"\"\n\n    def get_spectral_radius(dt, ms, ma, k, cs, cf):\n        \"\"\"\n        Constructs the amplification matrix A(dt) and computes its spectral radius.\n\n        Args:\n            dt (float): Time step size.\n            ms (float): Structural mass.\n            ma (float): Added mass.\n            k (float): Structural stiffness.\n            cs (float): Structural damping.\n            cf (float): Fluid radiation damping.\n\n        Returns:\n            float: The spectral radius of the amplification matrix.\n        \"\"\"\n        # Ensure dt is not negative and ms is positive\n        if dt  0 or ms = 0:\n            return float('inf') # Unstable\n\n        A = np.zeros((3, 3), dtype=np.float64)\n        \n        # Row 1 from x_{n+1} update\n        A[0, 0] = 1.0\n        A[0, 1] = dt\n        A[0, 2] = 0.5 * dt**2\n        \n        # Row 2 from v_{n+1} update\n        A[1, 0] = 0.0\n        A[1, 1] = 1.0\n        A[1, 2] = dt\n        \n        # Row 3 from a_{n+1} update\n        A[2, 0] = -k / ms\n        A[2, 1] = -(k * dt / ms) - (cs + cf) / ms\n        A[2, 2] = -(k * dt**2 / (2.0 * ms)) - (cs * dt / ms) - (ma / ms)\n        \n        eigenvalues = np.linalg.eigvals(A)\n        spectral_radius = np.max(np.abs(eigenvalues))\n        \n        return spectral_radius\n\n    def find_critical_dt(params):\n        \"\"\"\n        Finds the critical time step for a given set of physical parameters.\n        \n        Args:\n            params (tuple): A tuple containing ms, ma_ratio, k, cs, cf, and the search domain.\n\n        Returns:\n            float: The critical time step dt_crit.\n        \"\"\"\n        ms, ma_ratio, k, cs, cf, search_domain = params\n        ma = ma_ratio * ms\n        \n        # As derived, if ma/ms > 1, the scheme is unconditionally unstable.\n        if ma / ms > 1.0:\n            return 0.0\n        \n        dt_min, dt_max = search_domain\n        \n        # The function for which we seek the root dt_crit where f(dt_crit) = 0.\n        # We are looking for rho(dt) - 1 = 0.\n        def stability_func(dt):\n            return get_spectral_radius(dt, ms, ma, k, cs, cf) - 1.0\n\n        # Check the boundaries of the search domain to establish a bracket for bisection.\n        # We expect stability_func(dt_min) = 0 and stability_func(dt_max) > 0.\n        if stability_func(dt_min) > 0:\n            # Unstable even at the start of the search interval.\n            # This implies unconditional instability for practical purposes.\n            return 0.0\n\n        if stability_func(dt_max) = 0:\n            # The entire search domain is stable. The problem implies dt_crit\n            # is to be found within this domain. This case suggests dt_crit >= dt_max.\n            # However, the problem setup for the given test cases ensures a root is found\n            # within the domain. For a general problem, one might need to expand the search.\n            # Following the implicit problem constraints, we proceed, but this is a\n            # notable edge case.\n            return dt_max\n\n        # Bisection method to find dt_crit where rho(dt_crit) = 1.\n        low = dt_min\n        high = dt_max\n        tolerance = 1e-9\n\n        while (high - low) > tolerance:\n            mid = low + (high - low) / 2.0\n            if mid == low or mid == high: # Reached floating-point precision limit\n                break\n\n            if stability_func(mid) = 0:\n                # mid is in the stable region, so the critical dt could be larger.\n                low = mid\n            else:\n                # mid is in the unstable region, so the critical dt must be smaller.\n                high = mid\n        \n        # 'low' represents the largest dt for which the system is stable within the tolerance.\n        return low\n    \n    # Test suite from the problem statement\n    test_cases = [\n        # (m_s, m_a/m_s, k, c_s, c_f, search_domain)\n        (1.0, 0.0, 1.0e4, 5.0, 0.0, [1e-6, 5.0e-2]),\n        (1.0, 0.5, 1.0e4, 5.0, 30.0, [1e-6, 5.0e-2]),\n        (1.0, 0.9, 1.0e4, 5.0, 30.0, [1e-6, 5.0e-2]),\n        (1.0, 1.0, 1.0e4, 5.0, 30.0, [1e-6, 5.0e-2]),\n        (1.0, 1.5, 1.0e4, 5.0, 30.0, [1e-6, 5.0e-2]),\n    ]\n    \n    results = []\n    for case in test_cases:\n        dt_crit = find_critical_dt(case)\n        results.append(f\"{dt_crit:.6f}\") # Round to six decimal places for output\n        \n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}