{
    "hands_on_practices": [
        {
            "introduction": "The most fundamental consequence of immersing a structure in a dense fluid is the alteration of its inherent dynamic properties. This first practice explores this principle by quantifying how added mass changes the natural frequency of a simple oscillator and modifies the vibration modes in a more complex system. Mastering this analysis  is the first step toward building a robust physical intuition for the added-mass effect.",
            "id": "3527967",
            "problem": "A rigid structure executing one-dimensional motion is immersed in an incompressible, inviscid fluid so that the fluid exerts an inertial reaction that can be represented by an added mass. Consider two settings.\n\n(a) Single-degree-of-freedom setting: A point mass with structural mass $m_{s}$ connected to a linear spring of stiffness $k$ moves with displacement $x(t)$ in a quiescent fluid. The hydrodynamic reaction is modeled as an added mass $m_{a}$ that multiplies the structural acceleration. Starting from Newton’s second law and the definition of linear elastic force, derive the undamped free-vibration equation of motion and obtain the natural frequency as a function of $m_{s}$, $m_{a}$, and $k$.\n\n(b) Multi-degree-of-freedom setting: Two colinear point masses with structural masses $m_{1}$ and $m_{2}$ are connected by linear springs so that the first mass is connected to ground by a spring of stiffness $k_{1}$ and the two masses are connected by a spring of stiffness $k_{2}$. The system undergoes small-amplitude motion in an incompressible, inviscid fluid. The fluid-induced inertia is represented by a symmetric added-mass matrix. Using Newton’s second law for each degree of freedom and assembling the undamped free-vibration equations, explain qualitatively how the presence of a non-proportional added-mass matrix modifies the mode shapes and modal participation factors relative to the in-vacuo system.\n\nThen, for the specific parameter values\n- $m_{1} = 10\\,\\mathrm{kg}$, $m_{2} = 10\\,\\mathrm{kg}$,\n- $k_{1} = 4000\\,\\mathrm{N/m}$, $k_{2} = 2000\\,\\mathrm{N/m}$,\n- added-mass matrix $M_{a}$ with entries $m_{a,11} = 5\\,\\mathrm{kg}$, $m_{a,22} = 5\\,\\mathrm{kg}$, and $m_{a,12} = m_{a,21} = 2\\,\\mathrm{kg}$,\n\ncompute the lowest natural frequency of the coupled fluid-structure system in radians per second by seeking nontrivial harmonic solutions. Round your answer to four significant figures and express the frequency in radians per second.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. It presents a standard analysis of the added-mass effect in structural dynamics for both single-degree-of-freedom (SDOF) and multi-degree-of-freedom (MDOF) systems. All provided parameters are physically realistic and dimensionally consistent.\n\n**Part (a): Single-Degree-of-Freedom System**\n\nWe consider a point mass $m_s$ attached to a spring of stiffness $k$. The displacement of the mass is $x(t)$. The system is submerged in a quiescent, incompressible, and inviscid fluid.\n\nAccording to Newton's second law, the sum of external forces acting on the mass equals its mass times its acceleration.\n$$ \\sum F_{\\text{ext}} = m_s \\ddot{x}(t) $$\nThe external forces are the spring restoring force, $F_k$, and the hydrodynamic force from the fluid, $F_f$.\n\nThe spring force is given by Hooke's law:\n$$ F_k = -k x(t) $$\n\nThe problem states that the hydrodynamic reaction is modeled as an added mass, $m_a$, that multiplies the structural acceleration, $\\ddot{x}(t)$. This force opposes the acceleration of the body relative to the stationary fluid. The force exerted by the fluid on the structure is therefore:\n$$ F_f = -m_a \\ddot{x}(t) $$\n\nSubstituting the external forces into Newton's second law:\n$$ F_k + F_f = m_s \\ddot{x}(t) $$\n$$ -k x(t) - m_a \\ddot{x}(t) = m_s \\ddot{x}(t) $$\n\nRearranging the terms to form the standard equation of motion for free vibration:\n$$ m_s \\ddot{x}(t) + m_a \\ddot{x}(t) + k x(t) = 0 $$\n$$ (m_s + m_a) \\ddot{x}(t) + k x(t) = 0 $$\n\nThis is the equation of motion for an undamped SDOF system. It is of the form $M_{\\text{eff}} \\ddot{x} + K_{\\text{eff}} x = 0$, where the effective mass is $M_{\\text{eff}} = m_s + m_a$ and the effective stiffness is $K_{\\text{eff}} = k$. The natural frequency, $\\omega_n$, of such a system is given by:\n$$ \\omega_n = \\sqrt{\\frac{K_{\\text{eff}}}{M_{\\text{eff}}}} $$\nSubstituting the expressions for the effective mass and stiffness, we obtain the natural frequency of the fluid-structure system:\n$$ \\omega_n = \\sqrt{\\frac{k}{m_s + m_a}} $$\n\n**Part (b): Multi-Degree-of-Freedom System - Qualitative Explanation**\n\nFor the MDOF system, the undamped free-vibration equation of motion in matrix form is:\n$$ M \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} $$\nwhere $\\mathbf{x} = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$ is the displacement vector, $M$ is the mass matrix, and $K$ is the stiffness matrix.\n\nFor the in-vacuo system, the mass matrix, $M_s$, is diagonal, containing only the structural masses:\n$$ M_s = \\begin{pmatrix} m_1 & 0 \\\\ 0 & m_2 \\end{pmatrix} $$\nThe stiffness matrix, $K$, is derived from the forces in the springs. The force on mass $1$ is $-k_1 x_1 + k_2(x_2-x_1)$, and the force on mass $2$ is $-k_2(x_2-x_1)$. This yields:\n$$ K = \\begin{pmatrix} k_1+k_2 & -k_2 \\\\ -k_2 & k_2 \\end{pmatrix} $$\nThe in-vacuo equation of motion is $M_s \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0}$. The mode shapes are the eigenvectors of the generalized eigenvalue problem $(K - \\omega^2 M_s) \\mathbf{\\phi} = \\mathbf{0}$.\n\nWhen the system is immersed in the fluid, the total mass matrix becomes the sum of the structural mass matrix $M_s$ and the added-mass matrix $M_a$:\n$$ M_{\\text{total}} = M_s + M_a $$\nThe added-mass matrix $M_a$ is given as symmetric and non-diagonal:\n$$ M_a = \\begin{pmatrix} m_{a,11} & m_{a,12} \\\\ m_{a,21} & m_{a,22} \\end{pmatrix}, \\quad m_{a,12} = m_{a,21} \\neq 0 $$\nThe equation of motion for the coupled system is:\n$$ (M_s + M_a) \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} \\quad \\implies \\quad M_{\\text{total}} \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0} $$\nThe total mass matrix $M_{\\text{total}}$ is non-diagonal due to the off-diagonal terms $m_{a,12}$ and $m_{a,21}$. These terms represent hydrodynamic (inertial) coupling: the acceleration of mass $1$ induces an inertial fluid force on mass $2$, and vice-versa.\n\nThe presence of a non-proportional added-mass matrix modifies the system's modal properties as follows:\n1.  **Mode Shapes**: The mode shapes of the coupled system are the eigenvectors of the modified eigenvalue problem $(K - \\omega^2 M_{\\text{total}}) \\mathbf{\\phi} = \\mathbf{0}$. Since the total mass matrix $M_{\\text{total}}$ is not proportional to the structural mass matrix $M_s$ (i.e., $M_{\\text{total}} \\neq c M_s$ for any scalar $c$), the eigenvectors of the coupled system will be different from the eigenvectors (mode shapes) of the in-vacuo system. The inertial coupling fundamentally alters the dynamic relationships between the degrees of freedom, resulting in different characteristic patterns of vibration. The new mode shapes are orthogonal with respect to both $M_{\\text{total}}$ and $K$, but they are generally not orthogonal with respect to the original structural mass matrix $M_s$.\n\n2.  **Modal Participation Factors**: Modal participation factors, $\\Gamma_i$, quantify how much each mode contributes to the system's response under a given external load pattern. For a load vector $\\mathbf{f}(t) = \\mathbf{p} f(t)$, the participation factor for mode $i$ is $\\Gamma_i = \\mathbf{\\phi}_i^T M \\mathbf{p} / (\\mathbf{\\phi}_i^T M \\mathbf{\\phi}_i)$. Both the mode shapes $\\mathbf{\\phi}_i$ and the mass matrix $M$ (changing from $M_s$ to $M_{\\text{total}}$) are altered by the fluid. Therefore, the modal participation factors will change. The hydrodynamic coupling redistributes the effective inertia of the system, which in turn alters how each mode participates in the response to external loads.\n\n**Part (c): MDOF System - Numerical Calculation**\n\nWe are given the following parameter values:\n$m_1 = 10\\,\\mathrm{kg}$, $m_2 = 10\\,\\mathrm{kg}$\n$k_1 = 4000\\,\\mathrm{N/m}$, $k_2 = 2000\\,\\mathrm{N/m}$\n$M_a = \\begin{pmatrix} 5 & 2 \\\\ 2 & 5 \\end{pmatrix}\\,\\mathrm{kg}$\n\nFirst, we assemble the structural and total mass matrices and the stiffness matrix.\nThe structural mass matrix is:\n$$ M_s = \\begin{pmatrix} 10 & 0 \\\\ 0 & 10 \\end{pmatrix}\\,\\mathrm{kg} $$\nThe total mass matrix is:\n$$ M_{\\text{total}} = M_s + M_a = \\begin{pmatrix} 10 & 0 \\\\ 0 & 10 \\end{pmatrix} + \\begin{pmatrix} 5 & 2 \\\\ 2 & 5 \\end{pmatrix} = \\begin{pmatrix} 15 & 2 \\\\ 2 & 15 \\end{pmatrix}\\,\\mathrm{kg} $$\nThe stiffness matrix is:\n$$ K = \\begin{pmatrix} k_1+k_2 & -k_2 \\\\ -k_2 & k_2 \\end{pmatrix} = \\begin{pmatrix} 4000+2000 & -2000 \\\\ -2000 & 2000 \\end{pmatrix} = \\begin{pmatrix} 6000 & -2000 \\\\ -2000 & 2000 \\end{pmatrix}\\,\\mathrm{N/m} $$\n\nTo find the natural frequencies, we seek non-trivial harmonic solutions of the form $\\mathbf{x}(t) = \\mathbf{\\phi} e^{i\\omega t}$. Substituting this into the equation of motion $M_{\\text{total}} \\ddot{\\mathbf{x}} + K \\mathbf{x} = \\mathbf{0}$ yields the generalized eigenvalue problem:\n$$ (K - \\omega^2 M_{\\text{total}}) \\mathbf{\\phi} = \\mathbf{0} $$\nThis requires the determinant of the coefficient matrix to be zero. Let $\\lambda = \\omega^2$.\n$$ \\det(K - \\lambda M_{\\text{total}}) = 0 $$\n$$ \\det\\left( \\begin{pmatrix} 6000 & -2000 \\\\ -2000 & 2000 \\end{pmatrix} - \\lambda \\begin{pmatrix} 15 & 2 \\\\ 2 & 15 \\end{pmatrix} \\right) = 0 $$\n$$ \\det\\begin{pmatrix} 6000 - 15\\lambda & -2000 - 2\\lambda \\\\ -2000 - 2\\lambda & 2000 - 15\\lambda \\end{pmatrix} = 0 $$\nExpanding the determinant gives the characteristic equation:\n$$ (6000 - 15\\lambda)(2000 - 15\\lambda) - (-2000 - 2\\lambda)^2 = 0 $$\n$$ (12 \\times 10^6 - 90000\\lambda - 30000\\lambda + 225\\lambda^2) - (4 \\times 10^6 + 8000\\lambda + 4\\lambda^2) = 0 $$\n$$ 225\\lambda^2 - 120000\\lambda + 12 \\times 10^6 - 4\\lambda^2 - 8000\\lambda - 4 \\times 10^6 = 0 $$\nCombining terms, we get a quadratic equation in $\\lambda$:\n$$ 221\\lambda^2 - 128000\\lambda + 8 \\times 10^6 = 0 $$\nWe solve for $\\lambda$ using the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{(-128000)^2 - 4(221)(8 \\times 10^6)}}{2(221)} $$\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{16.384 \\times 10^9 - 7.072 \\times 10^9}}{442} $$\n$$ \\lambda = \\frac{128000 \\pm \\sqrt{9.312 \\times 10^9}}{442} $$\n$$ \\lambda = \\frac{128000 \\pm 96498.7046...}{442} $$\nThe two eigenvalues $\\lambda = \\omega^2$ are:\n$$ \\lambda_1 = \\frac{128000 - 96498.7046...}{442} \\approx 71.2699... \\ (\\text{rad/s})^2 $$\n$$ \\lambda_2 = \\frac{128000 + 96498.7046...}{442} \\approx 507.9156... \\ (\\text{rad/s})^2 $$\nThe lowest natural frequency corresponds to the smaller eigenvalue, $\\lambda_1$.\n$$ \\omega_{lowest} = \\sqrt{\\lambda_1} \\approx \\sqrt{71.2699...} \\approx 8.442150... \\ \\text{rad/s} $$\nRounding the result to four significant figures gives:\n$$ \\omega_{lowest} \\approx 8.442 \\ \\text{rad/s} $$",
            "answer": "$$ \\boxed{8.442} $$"
        },
        {
            "introduction": "Building on the fundamental dynamic analysis, this exercise connects the physics of added mass to the practical decisions required in computational Fluid-Structure Interaction (FSI). You will implement a parametric study  to classify systems into regimes where added mass is negligible, comparable, or dominant. This skill is critical for selecting appropriate numerical coupling strategies and anticipating challenges related to numerical stability and accuracy.",
            "id": "3527931",
            "problem": "Consider a one-degree-of-freedom linear structural oscillator immersed in an inviscid, incompressible flow, representing a canonical Fluid-Structure Interaction (FSI) setting for assessing the added-mass effect. The structure is modeled as a rigid mass attached to a linear spring, moving normal to the fluid, and the fluid is characterized solely by its added mass. Let the structural mass be $m_s = \\rho_s V$, and the fluid added mass be $m_a = C_a \\rho_f V$, where $\\rho_s$ is the structural density, $\\rho_f$ is the fluid density, $V$ is a characteristic displaced volume, and $C_a$ is a dimensionless added-mass coefficient determined by geometry. The effective mass is $m_{\\text{eff}} = m_s + m_a$. The linear spring has stiffness $k$. Assume zero structural damping.\n\nStarting from Newton's second law and the definition of effective inertia, your task is to derive, implement, and evaluate a parameterized study across the density ratio $\\beta = \\rho_s/\\rho_f$ to identify regimes where added mass is negligible, comparable to, or dominant over the structural inertia, and to extract implications for numerical coupling strategies in multiphysics solvers.\n\nUse the following foundational modeling assumptions and requirements:\n- Fundamental base: Newton's second law, linear oscillator dynamics, and the definition of added mass. The fluid contribution is purely inertial: $m_a = C_a \\rho_f V$.\n- Dry natural frequency: $\\omega_{\\text{dry}} = \\sqrt{k/m_s}$.\n- Wet (coupled) natural frequency: $\\omega = \\sqrt{k/(m_s + m_a)}$.\n- Mass ratio: $r = m_a/m_s = C_a/\\beta$.\n- Frequency ratio: $\\omega/\\omega_{\\text{dry}} = \\sqrt{m_s/(m_s + m_a)} = 1/\\sqrt{1 + r}$.\n\nDefine the regime classification using a principled, quantitative criterion:\n- Added-mass negligible (code $0$): the relative frequency reduction is small, that is $1 - \\omega/\\omega_{\\text{dry}} \\le \\varepsilon_{\\text{negl}}$, with $\\varepsilon_{\\text{negl}} = 0.05$. Show that this corresponds to $r \\le r_{\\text{negl}}$, where $r_{\\text{negl}} = \\dfrac{1}{(1 - \\varepsilon_{\\text{negl}})^2} - 1$.\n- Added-mass dominant (code $2$): the added mass overwhelms the structural mass by at least one order of magnitude, that is $r \\ge \\tau_{\\text{dom}}$, with $\\tau_{\\text{dom}} = 10$.\n- Added-mass comparable (code $1$): the intermediate regime $r_{\\text{negl}} < r < \\tau_{\\text{dom}}$.\n\nNumerical coupling implication (to be computed and reported as a boolean): define the fluid inertia fraction $\\gamma = \\dfrac{m_a}{m_s + m_a} = \\dfrac{r}{1 + r}$. Recommend strong (implicit) coupling if $\\gamma \\ge \\gamma_{\\text{crit}}$, with $\\gamma_{\\text{crit}} = 0.3$. Otherwise, weak (explicit) coupling may be acceptable. This criterion must be computed and reported as a boolean for each test case.\n\nAdditionally, compute the explicit central-difference stability time-step limit for the linear oscillator,\n$$\\Delta t_{\\text{crit}} = \\dfrac{2}{\\omega},$$\nand report it in seconds.\n\nUse the following fixed parameters for all cases:\n- Stiffness $k = 1.0 \\times 10^5\\,\\mathrm{N/m}$,\n- Volume $V = 1.0\\,\\mathrm{m^3}$.\n\nTest suite:\nFor each test case, the inputs are $(\\rho_s,\\ \\rho_f,\\ C_a)$ in $\\mathrm{kg/m^3}$ and dimensionless, respectively.\n\n- Case $1$: $(10.0,\\ 1000.0,\\ 1.0)$.\n- Case $2$: $(1000.0,\\ 1000.0,\\ 1.0)$.\n- Case $3$: $(10000.0,\\ 1000.0,\\ 1.0)$, which corresponds to $r = 0.1$.\n- Case $4$: $(8333.333333333333,\\ 1000.0,\\ 1.0)$, which corresponds to $r = 0.12$.\n- Case $5$: $(111.11111111111111,\\ 1000.0,\\ 1.0)$, which corresponds to $r = 9.0$.\n- Case $6$: $(50.0,\\ 1000.0,\\ 0.5)$, which corresponds to $r = 10.0$.\n- Case $7$: $(8000.0,\\ 1000.0,\\ 2.0)$, which corresponds to $r = 0.25$.\n\nFor each test case, your program must output a list with four entries:\n- The regime code as an integer: $0$ (negligible), $1$ (comparable), or $2$ (dominant).\n- The frequency ratio $\\omega/\\omega_{\\text{dry}}$ as a floating-point number.\n- The strong-coupling recommendation as a boolean, based on $\\gamma \\ge \\gamma_{\\text{crit}}$.\n- The critical explicit time step $\\Delta t_{\\text{crit}}$ in seconds as a floating-point number.\n\nFinal output format:\nYour program should produce a single line of output containing the results for all seven cases as a comma-separated list enclosed in square brackets. Each element must itself be a list of the four values for the corresponding test case, in the order specified above. For example:\n$[\\,[\\text{code}_1,\\ \\text{fr}_1,\\ \\text{bool}_1,\\ \\Delta t_1],\\ [\\text{code}_2,\\ \\text{fr}_2,\\ \\text{bool}_2,\\ \\Delta t_2],\\ \\ldots\\,]$.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of classical mechanics and fluid dynamics, specifically the modeling of linear oscillators and the added-mass effect in fluid-structure interaction (FSI). The problem is well-posed, with all necessary parameters, definitions, and criteria clearly specified, ensuring that a unique and meaningful solution can be determined. The setup is self-contained and logically consistent.\n\nThe solution proceeds by first establishing the theoretical framework and then applying it to the specified test cases.\n\nThe system under consideration is a single-degree-of-freedom (SDOF) structural oscillator immersed in a fluid. The motion of the structure is governed by Newton's second law. In a vacuum (or \"dry\" condition), the equation of motion for the undamped oscillator with mass $m_s$ and spring stiffness $k$ is:\n$$m_s \\ddot{x} + kx = 0$$\nwhere $x$ is the displacement and $\\ddot{x}$ is the acceleration. The natural frequency of this \"dry\" system is given by:\n$$\\omega_{\\text{dry}} = \\sqrt{\\frac{k}{m_s}}$$\n\nWhen the oscillator is immersed in a fluid, its motion accelerates the surrounding fluid, which in turn exerts an inertial force back on the structure. For an inviscid, incompressible fluid, this effect can be modeled as an \"added mass,\" $m_a$, which is conceptually a mass of fluid that moves with the structure. The total effective mass of the system becomes the sum of the structural mass and the added mass:\n$$m_{\\text{eff}} = m_s + m_a$$\nThe equation of motion for the \"wet\" system is then:\n$$(m_s + m_a) \\ddot{x} + kx = 0$$\nThe natural frequency of this coupled FSI system, or the \"wet\" frequency, is:\n$$\\omega = \\sqrt{\\frac{k}{m_s + m_a}}$$\n\nThe problem provides the following definitions:\n- Structural mass: $m_s = \\rho_s V$, where $\\rho_s$ is the structural density and $V$ is a characteristic volume.\n- Added mass: $m_a = C_a \\rho_f V$, where $\\rho_f$ is the fluid density and $C_a$ is the added-mass coefficient.\n\nA key dimensionless parameter governing the system's behavior is the mass ratio, $r$, defined as the ratio of the added mass to the structural mass:\n$$r = \\frac{m_a}{m_s} = \\frac{C_a \\rho_f V}{\\rho_s V} = \\frac{C_a \\rho_f}{\\rho_s}$$\nUsing the definition of the density ratio, $\\beta = \\rho_s/\\rho_f$, the mass ratio can be expressed as $r = C_a/\\beta$.\n\nThe added mass reduces the system's natural frequency. The extent of this reduction is quantified by the frequency ratio:\n$$\\frac{\\omega}{\\omega_{\\text{dry}}} = \\frac{\\sqrt{k/(m_s + m_a)}}{\\sqrt{k/m_s}} = \\sqrt{\\frac{m_s}{m_s + m_a}} = \\sqrt{\\frac{1}{1 + m_a/m_s}} = \\frac{1}{\\sqrt{1 + r}}$$\nThis relationship shows that the frequency ratio, and thus the entire dynamic behavior of the system, is uniquely determined by the mass ratio $r$.\n\nThe problem requires a regime classification based on the significance of the added-mass effect. The criterion is based on the relative frequency reduction, $1 - \\omega/\\omega_{\\text{dry}}$.\n- **Added-mass negligible (code $0$)**: This regime is defined by a small frequency reduction: $1 - \\omega/\\omega_{\\text{dry}} \\le \\varepsilon_{\\text{negl}}$, with $\\varepsilon_{\\text{negl}} = 0.05$. We can translate this into a condition on $r$:\n$$1 - \\frac{1}{\\sqrt{1+r}} \\le \\varepsilon_{\\text{negl}} \\implies 1 - \\varepsilon_{\\text{negl}} \\le \\frac{1}{\\sqrt{1+r}} \\implies \\sqrt{1+r} \\le \\frac{1}{1 - \\varepsilon_{\\text{negl}}}$$\n$$1+r \\le \\frac{1}{(1 - \\varepsilon_{\\text{negl}})^2} \\implies r \\le \\frac{1}{(1 - \\varepsilon_{\\text{negl}})^2} - 1$$\nThis defines the threshold $r_{\\text{negl}}$. Substituting $\\varepsilon_{\\text{negl}} = 0.05$:\n$$r_{\\text{negl}} = \\frac{1}{(1 - 0.05)^2} - 1 = \\frac{1}{0.95^2} - 1 = \\frac{1}{0.9025} - 1 \\approx 1.108033 - 1 = 0.108033$$\nSo, the negligible regime corresponds to $r \\le 0.108033$.\n\n- **Added-mass dominant (code $2$)**: This regime is defined by the added mass being significantly larger than the structural mass, specifically by a factor of at least $10$. The criterion is $r \\ge \\tau_{\\text{dom}}$, with $\\tau_{\\text{dom}} = 10$.\n\n- **Added-mass comparable (code $1$)**: This regime covers all intermediate cases where $r_{\\text{negl}} < r < \\tau_{\\text{dom}}$.\n\nFor multiphysics simulations, the strength of the coupling between fluid and solid domains is crucial. A key indicator is the fluid inertia fraction, $\\gamma$, which measures the proportion of the total effective mass contributed by the fluid:\n$$\\gamma = \\frac{m_a}{m_s + m_a} = \\frac{m_a/m_s}{1 + m_a/m_s} = \\frac{r}{1+r}$$\nThe problem states that strong (implicit) coupling is recommended if the fluid inertia fraction is significant, specifically if $\\gamma \\ge \\gamma_{\\text{crit}}$, with $\\gamma_{\\text{crit}} = 0.3$. This condition is equivalent to:\n$$\\frac{r}{1+r} \\ge 0.3 \\implies r \\ge 0.3(1+r) \\implies 0.7r \\ge 0.3 \\implies r \\ge \\frac{3}{7} \\approx 0.42857$$\nA boolean value (True/False) will represent this recommendation.\n\nFinally, for time-domain simulations using explicit methods like the central-difference scheme, the numerical stability is limited by the system's highest frequency. The critical time-step limit for a linear oscillator is:\n$$\\Delta t_{\\text{crit}} = \\frac{2}{\\omega}$$\nwhere $\\omega = \\sqrt{k/m_{\\text{eff}}}$. This value will be computed for each case.\n\nThe algorithmic procedure for each test case $(\\rho_s, \\rho_f, C_a)$ with fixed parameters $k=1.0 \\times 10^5\\,\\mathrm{N/m}$ and $V=1.0\\,\\mathrm{m^3}$ is as follows:\n1.  Calculate the mass ratio: $r = (C_a \\rho_f) / \\rho_s$.\n2.  Determine the regime code:\n    - If $r \\le r_{\\text{negl}} \\approx 0.108033$, code is $0$.\n    - If $r \\ge \\tau_{\\text{dom}} = 10$, code is $2$.\n    - Otherwise, code is $1$.\n3.  Calculate the frequency ratio: $\\omega/\\omega_{\\text{dry}} = 1/\\sqrt{1+r}$.\n4.  Determine the strong coupling recommendation: True if $r \\ge 3/7$, False otherwise.\n5.  Calculate the wet natural frequency: $\\omega = \\sqrt{k / ((\\rho_s + C_a \\rho_f)V)}$.\n6.  Calculate the critical time step: $\\Delta t_{\\text{crit}} = 2/\\omega$.\n7.  Assemble the four results: [regime code, frequency ratio, coupling recommendation, critical time step].\nThis procedure is now implemented for all specified test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FSI added-mass problem for a set of test cases.\n    \"\"\"\n    \n    # Define fixed parameters and criteria from the problem statement.\n    k = 1.0e5  # Stiffness in N/m\n    V = 1.0    # Characteristic volume in m^3\n\n    epsilon_negl = 0.05\n    tau_dom = 10.0\n    gamma_crit = 0.3\n\n    # Calculate the threshold for the negligible regime.\n    r_negl = 1 / (1 - epsilon_negl)**2 - 1\n\n    # Calculate the mass ratio threshold for strong coupling.\n    # gamma = r / (1 + r) >= gamma_crit  => r >= gamma_crit / (1 - gamma_crit)\n    r_strong_coupling_threshold = gamma_crit / (1 - gamma_crit)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (rho_s, rho_f, C_a).\n    test_cases = [\n        (10.0, 1000.0, 1.0),                  # Case 1\n        (1000.0, 1000.0, 1.0),                # Case 2\n        (10000.0, 1000.0, 1.0),               # Case 3 (r=0.1)\n        (25000.0/3.0, 1000.0, 1.0),           # Case 4 (r=0.12)\n        (1000.0/9.0, 1000.0, 1.0),            # Case 5 (r=9.0)\n        (50.0, 1000.0, 0.5),                  # Case 6 (r=10.0)\n        (8000.0, 1000.0, 2.0),                # Case 7 (r=0.25)\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_s, rho_f, C_a = case\n\n        # 1. Calculate the mass ratio r.\n        # Ensure rho_s is not zero to avoid division errors, though not expected here.\n        if rho_s == 0:\n            # Handle theoretically infinite mass ratio\n            r = float('inf')\n        else:\n            r = (C_a * rho_f) / rho_s\n        \n        # 2. Determine the regime code.\n        if r <= r_negl:\n            regime_code = 0  # Negligible\n        elif r >= tau_dom:\n            regime_code = 2  # Dominant\n        else:\n            regime_code = 1  # Comparable\n\n        # 3. Calculate the frequency ratio omega / omega_dry.\n        freq_ratio = 1 / np.sqrt(1 + r)\n\n        # 4. Determine the strong coupling recommendation.\n        # gamma = r / (1 + r)\n        # strong_coupling = gamma >= gamma_crit\n        # Using the pre-calculated threshold on r is more direct.\n        strong_coupling = r >= r_strong_coupling_threshold\n\n        # 5. Calculate the effective mass and wet natural frequency.\n        m_s = rho_s * V\n        m_a = C_a * rho_f * V\n        m_eff = m_s + m_a\n        \n        # Check for m_eff <= 0 to avoid domain errors in sqrt, though physically not expected.\n        if m_eff > 0:\n            omega = np.sqrt(k / m_eff)\n            # 6. Calculate the critical explicit time step.\n            dt_crit = 2 / omega\n        else:\n            omega = float('inf')\n            dt_crit = 0.0\n\n        # Assemble the results for the current case.\n        case_result = [regime_code, freq_ratio, strong_coupling, dt_crit]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list of lists matches the required format.\n    # Using \", \".join() to have spaces after commas between inner lists.\n    # Example format: [[c1, f1, b1, t1], [c2, f2, b2, t2], ...]\n    output_str = \"[\" + \", \".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "This advanced practice tackles the most critical numerical challenge posed by the added-mass effect: the severe instability that can plague partitioned FSI simulations. You will derive and implement a robust predictor-corrector algorithm  that enforces acceleration continuity at the fluid-structure interface, thereby stabilizing the solution. Completing this exercise provides direct experience with the techniques that enable accurate and stable simulations of challenging FSI problems, particularly those involving light structures and dense fluids.",
            "id": "3527976",
            "problem": "You are asked to study the added-mass effect in Fluid–Structure Interaction (FSI) within a partitioned coupling scheme and to design a numerically robust time-integration strategy that suppresses added-mass instabilities by enforcing a discrete acceleration continuity condition at the fluid–structure interface. Start from first principles and proceed by modeling, derivation, discretization, and implementation.\n\nConsider a one-dimensional, incompressible fluid “slug” of length $L$ and cross-sectional area $A$ moving in a straight channel and interacting with the tip of a flexible beam, reduced to a single generalized coordinate $x(t)$ representing the beam’s first-mode tip displacement in meters. The fluid density is $\\rho_f$ (in $\\mathrm{kg/m^3}$). The structural model has mass $m_s$ (in $\\mathrm{kg}$), linear damping $c_s$ (in $\\mathrm{N\\cdot s/m}$), and stiffness $k_s$ (in $\\mathrm{N/m}$). Linear fluid drag is modeled by $c_f$ (in $\\mathrm{N\\cdot s/m}$). The interface between the fluid and the structure is at the beam tip; the interface kinematics enforce that the fluid slug and the beam share the same interface velocity and acceleration. The fluid experiences an outlet pressure $p_{\\text{out}}(t)$ prescribed at the far end. You may assume $p_{\\text{out}}(t)=0$ for all $t$ in the numerical tests.\n\nUsing only fundamental laws and core definitions, derive and implement the following:\n\n1) Governing equations from Newton’s second law:\n- For the structure: \n  $$ m_s\\,\\ddot{x}(t) + c_s\\,\\dot{x}(t) + k_s\\,x(t) = A\\,p(t), $$\n  where $p(t)$ is the interface pressure acting on the structure over area $A$.\n- For the fluid slug (control volume of mass $m_f=\\rho_f A L$):\n  $$ m_f\\,\\ddot{x}(t) = -A\\left(p(t)-p_{\\text{out}}(t)\\right) - c_f\\,\\dot{x}(t). $$\n\n2) Interface kinematics and the discrete acceleration continuity condition:\n- The interface kinematics enforce that the interface velocity and acceleration are common to both subsystems, i.e., $\\dot{x}_f(t)=\\dot{x}_s(t)=\\dot{x}(t)$ and $\\ddot{x}_f(t)=\\ddot{x}_s(t)=\\ddot{x}(t)$ at all times. Using a backward-Euler discretization of the fluid momentum for the time interval $[t_n,t_{n+1}]$ with time step $\\Delta t$, combine this kinematic constraint with the fluid momentum equation to derive a discrete Robin-type interface condition that expresses the interface pressure at the new time as a function of the interface acceleration and velocity at the new time. Your derivation must start from:\n  $$ m_f \\frac{\\dot{x}_{n+1}-\\dot{x}_n}{\\Delta t} = -A\\left(p_{n+1}-p_{\\text{out},n+1}\\right) - c_f\\,\\dot{x}_{n+1}, $$\n  together with $\\ddot{x}_{n+1}=\\frac{\\dot{x}_{n+1}-\\dot{x}_n}{\\Delta t}$, and must not assume any pre-known coupling formula.\n\n3) Time discretization and predictor–corrector scheme:\n- Discretize the structure with the Newmark family using parameters $\\beta=\\tfrac{1}{4}$ and $\\gamma=\\tfrac{1}{2}$, so that\n  $$ x_{n+1} = x_n + \\Delta t\\,\\dot{x}_n + \\Delta t^2\\left(\\tfrac{1}{2}-\\beta\\right)\\ddot{x}_n + \\beta\\,\\Delta t^2\\,\\ddot{x}_{n+1}, $$\n  $$ \\dot{x}_{n+1} = \\dot{x}_n + \\Delta t\\left(1-\\gamma\\right)\\ddot{x}_n + \\gamma\\,\\Delta t\\,\\ddot{x}_{n+1}. $$\n- Form a predictor–corrector loop at each time step:\n  a) Predictor: compute the kinematic predictors\n     $$ x_{n+1}^{\\text{pred}} = x_n + \\Delta t\\,\\dot{x}_n + \\Delta t^2\\left(\\tfrac{1}{2}-\\beta\\right)\\ddot{x}_n, \\quad \\dot{x}_{n+1}^{\\text{pred}} = \\dot{x}_n + \\Delta t\\left(1-\\gamma\\right)\\ddot{x}_n. $$\n  b) Corrector: enforce the structure equilibrium at $t_{n+1}$ together with the discrete interface condition from item $2)$ to eliminate $p_{n+1}$ and solve directly for $\\ddot{x}_{n+1}$. Then recover $x_{n+1}$ and $\\dot{x}_{n+1}$ from the Newmark relations. Explicitly provide the linear algebraic equation (scalar) for $\\ddot{x}_{n+1}$ that results from these steps, in terms of known quantities at time $t_n$ and the predictors.\n  c) Optionally, you may evaluate $p_{n+1}$ afterward using the discrete interface relation from item $2)$.\n\n4) Initial conditions and units:\n- Use initial displacement $x(0)=x_0$ in meters, initial velocity $\\dot{x}(0)=0$ in meters per second, and determine the initial acceleration $\\ddot{x}(0)$ by enforcing the coupled equilibrium at $t=0$ with $p_{\\text{out}}(0)=0$.\n- All inputs and outputs must be in International System of Units (SI). Express all requested outputs in meters.\n\n5) Implementation task:\n- Implement the above predictor–corrector time integrator for the coupled fluid–structure model. Your implementation must be a complete, runnable program. It should simulate up to time $T$ with uniform time step $\\Delta t$ and return the final displacement $x(T)$, in meters, rounded to six decimal places for each test case.\n\n6) Test suite and required program output format:\n- Use the following set of four test cases that probe different added-mass regimes and numerical conditions. For each case, define $m_f=\\rho_f A L$.\n  a) Case $1$ (heavy structure, fine time step):\n     - $\\rho_f=1000$, $A=0.01$, $L=1$, $m_s=100$, $k_s=100000$, $c_s=100$, $c_f=50$, $\\Delta t=0.001$, $T=1.0$, $x_0=0.001$, $\\dot{x}_0=0$.\n  b) Case $2$ (light structure, fine time step):\n     - $\\rho_f=1000$, $A=0.01$, $L=1$, $m_s=1$, $k_s=100000$, $c_s=100$, $c_f=50$, $\\Delta t=0.001$, $T=1.0$, $x_0=0.001$, $\\dot{x}_0=0$.\n  c) Case $3$ (massless structural limit):\n     - $\\rho_f=1000$, $A=0.01$, $L=1$, $m_s=0$, $k_s=100000$, $c_s=100$, $c_f=50$, $\\Delta t=0.001$, $T=1.0$, $x_0=0.001$, $\\dot{x}_0=0$.\n  d) Case $4$ (coarse time step, lightly damped, strong added mass):\n     - $\\rho_f=1000$, $A=0.01$, $L=1$, $m_s=0.5$, $k_s=5000$, $c_s=0$, $c_f=0$, $\\Delta t=0.05$, $T=2.0$, $x_0=0.001$, $\\dot{x}_0=0$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry being the final displacement $x(T)$ for the corresponding case, in meters, rounded to six decimal places, in the same order as listed above (for example, $[x_1,x_2,x_3,x_4]$).\n\nYour derivation must remain grounded in fundamental principles such as Newton’s laws and standard time-discretization formulas, without assuming any pre-derived FSI coupling relations. All scenarios should be scientifically sound and self-consistent. The variable symbols, operators, and numbers in this problem description are mathematical entities and are thus to be presented in LaTeX notation as done here.",
            "solution": "We begin with first principles for the coupled fluid–structure system and proceed to a discrete, stable interface condition that suppresses added-mass instabilities.\n\nGoverning equations. For the structure, Newton’s second law with linear damping and stiffness yields\n$$ m_s\\,\\ddot{x}(t) + c_s\\,\\dot{x}(t) + k_s\\,x(t) = A\\,p(t). \\quad (1) $$\nFor the fluid slug of mass $m_f=\\rho_f A L$, a one-dimensional momentum balance for the control volume gives\n$$ m_f\\,\\ddot{x}(t) = -A\\left(p(t)-p_{\\text{out}}(t)\\right) - c_f\\,\\dot{x}(t). \\quad (2) $$\nThe interface kinematics require that the structure and fluid share the same displacement $x(t)$, velocity $\\dot{x}(t)$, and acceleration $\\ddot{x}(t)$ at the interface.\n\nDiscrete interface acceleration continuity and Robin pressure relation. We now discretize the fluid momentum with backward Euler for the momentum term over the time interval $[t_n,t_{n+1}]$ with time step $\\Delta t$:\n$$ m_f \\frac{\\dot{x}_{n+1}-\\dot{x}_n}{\\Delta t} = -A\\left(p_{n+1}-p_{\\text{out},n+1}\\right) - c_f\\,\\dot{x}_{n+1}. \\quad (3) $$\nBy the definition of discrete acceleration under backward Euler,\n$$ \\ddot{x}_{n+1} = \\frac{\\dot{x}_{n+1}-\\dot{x}_n}{\\Delta t}. \\quad (4) $$\nSubstituting equation $(4)$ into $(3)$ gives\n$$ m_f \\ddot{x}_{n+1} = -A\\left(p_{n+1}-p_{\\text{out},n+1}\\right) - c_f\\,\\dot{x}_{n+1}. \\quad (5) $$\nSolving equation $(5)$ for the interface pressure $p_{n+1}$ yields the discrete Robin-type interface condition:\n$$ p_{n+1} = p_{\\text{out},n+1} - \\frac{m_f}{A}\\,\\ddot{x}_{n+1} - \\frac{c_f}{A}\\,\\dot{x}_{n+1}. \\quad (6) $$\nThis is the discrete interface acceleration continuity condition expressed as a pressure condition: it enforces that the fluid momentum balance at the new time uses the same interface acceleration and velocity as the structure, thereby avoiding an explicit time lag between subsystems. Relation $(6)$ is the key to suppressing added-mass instabilities in a partitioned scheme; it couples the pressure implicitly to the structural kinematics at time level $n+1$.\n\nTime discretization for the structure and coupling elimination. We use the Newmark family with parameters $\\beta=\\tfrac{1}{4}$ and $\\gamma=\\tfrac{1}{2}$. The standard Newmark kinematic updates are\n$$ x_{n+1} = x_n + \\Delta t\\,\\dot{x}_n + \\Delta t^2\\left(\\tfrac{1}{2}-\\beta\\right)\\ddot{x}_n + \\beta\\,\\Delta t^2\\,\\ddot{x}_{n+1}, \\quad (7) $$\n$$ \\dot{x}_{n+1} = \\dot{x}_n + \\Delta t\\left(1-\\gamma\\right)\\ddot{x}_n + \\gamma\\,\\Delta t\\,\\ddot{x}_{n+1}. \\quad (8) $$\nDefine the kinematic predictors\n$$ x_{n+1}^{\\text{pred}} = x_n + \\Delta t\\,\\dot{x}_n + \\Delta t^2\\left(\\tfrac{1}{2}-\\beta\\right)\\ddot{x}_n, \\quad (9) $$\n$$ \\dot{x}_{n+1}^{\\text{pred}} = \\dot{x}_n + \\Delta t\\left(1-\\gamma\\right)\\ddot{x}_n. \\quad (10) $$\nThen the corrector forms are\n$$ x_{n+1} = x_{n+1}^{\\text{pred}} + \\beta\\,\\Delta t^2\\,\\ddot{x}_{n+1}, \\quad (11) $$\n$$ \\dot{x}_{n+1} = \\dot{x}_{n+1}^{\\text{pred}} + \\gamma\\,\\Delta t\\,\\ddot{x}_{n+1}. \\quad (12) $$\n\nAt time $t_{n+1}$, the structural equilibrium $(1)$ reads\n$$ m_s\\,\\ddot{x}_{n+1} + c_s\\,\\dot{x}_{n+1} + k_s\\,x_{n+1} = A\\,p_{n+1}. \\quad (13) $$\nSubstitute $(6)$ for $p_{n+1}$ and substitute $(11)$–$(12)$ for $x_{n+1}$ and $\\dot{x}_{n+1}$. With $p_{\\text{out},n+1}$ prescribed, this yields a single scalar linear equation for the unknown $\\ddot{x}_{n+1}$:\n$$ \\big(m_s + m_f\\big)\\ddot{x}_{n+1} + \\big(c_s + c_f\\big)\\left(\\dot{x}_{n+1}^{\\text{pred}} + \\gamma\\,\\Delta t\\,\\ddot{x}_{n+1}\\right) + k_s\\left(x_{n+1}^{\\text{pred}} + \\beta\\,\\Delta t^2\\,\\ddot{x}_{n+1}\\right) = A\\,p_{\\text{out},n+1}. \\quad (14) $$\nCollecting the $\\ddot{x}_{n+1}$ terms on the left-hand side, we obtain\n$$ \\left[\\big(m_s+m_f\\big) + \\gamma\\,\\Delta t\\,\\big(c_s+c_f\\big) + \\beta\\,\\Delta t^2\\,k_s\\right]\\ddot{x}_{n+1} = A\\,p_{\\text{out},n+1} - \\big(c_s+c_f\\big)\\dot{x}_{n+1}^{\\text{pred}} - k_s x_{n+1}^{\\text{pred}}. \\quad (15) $$\nThis explicit formula shows that the effective inertia is augmented by $m_f$, the fluid “added mass,” and the effective damping by $c_f$. Equation $(15)$, together with $(11)$–$(12)$, completes the corrector step.\n\nPredictor–corrector loop. At each time step:\n\n- Predictor: compute $x_{n+1}^{\\text{pred}}$ and $\\dot{x}_{n+1}^{\\text{pred}}$ by equations $(9)$–$(10)$.\n\n- Corrector: compute $\\ddot{x}_{n+1}$ from $(15)$, then update $x_{n+1}$ and $\\dot{x}_{n+1}$ using $(11)$–$(12)$. Optionally recover $p_{n+1}$ from $(6)$:\n  $$ p_{n+1} = p_{\\text{out},n+1} - \\frac{m_f}{A}\\,\\ddot{x}_{n+1} - \\frac{c_f}{A}\\,\\dot{x}_{n+1}. \\quad (16) $$\n\nInitial conditions. With $x(0)=x_0$ and $\\dot{x}(0)=0$, and $p_{\\text{out}}(0)=0$, the coupled equilibrium from $(1)$–$(2)$ at $t=0$ implies\n$$ \\big(m_s+m_f\\big)\\ddot{x}(0) + \\big(c_s+c_f\\big)\\dot{x}(0) + k_s x(0) = A\\,p_{\\text{out}}(0) = 0, $$\nhence\n$$ \\ddot{x}(0) = -\\frac{\\big(c_s+c_f\\big)\\dot{x}(0) + k_s x(0)}{m_s+m_f}. \\quad (17) $$\n\nStability and suppression of added-mass instabilities. The discrete interface relation $(6)$ enforces that the fluid pressure at the new time depends on the same interface acceleration and velocity that enter the structural corrector. This implicit-in-time coupling prevents the explicit time lag that, in light-structure/heavy-fluid regimes, produces the classical added-mass instability in partitioned FSI schemes. The Newmark average-acceleration choice $\\beta=\\tfrac{1}{4}$, $\\gamma=\\tfrac{1}{2}$ is unconditionally stable for linear problems; combined with $(6)$, it yields a robust scheme even for $m_s \\to 0$.\n\nTest suite and output. For each specified test case, we compute the final displacement $x(T)$ in meters, rounded to six decimal places. The program aggregates the four results into a single line in the format $[x_1,x_2,x_3,x_4]$.\n\nImplementation details. The algorithm proceeds as:\n- For each case, compute $m_f=\\rho_f A L$ and initialize $x_0$, $\\dot{x}_0$, then compute $\\ddot{x}_0$ via $(17)$.\n- For $n=0,\\dots,N-1$ with $N=\\text{round}\\left(\\frac{T}{\\Delta t}\\right)$:\n  - Compute predictors $(9)$–$(10)$.\n  - Compute $\\ddot{x}_{n+1}$ from $(15)$ with $p_{\\text{out},n+1}=0$.\n  - Update $(x_{n+1},\\dot{x}_{n+1})$ via $(11)$–$(12)$.\n- Return $x_N$.\n\nAll variables and numbers in the derivations are given in LaTeX. The final code implements the above equations verbatim and produces the requested outputs.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_case(rho_f, A, L, m_s, k_s, c_s, c_f, dt, T, x0, v0, p_out_func=None):\n    \"\"\"\n    Simulate the coupled 1D fluid-structure system using:\n    - Newmark (beta=1/4, gamma=1/2) for the structure kinematics\n    - Discrete acceleration-continuity-based Robin interface condition\n      p_{n+1} = p_out - (m_f/A) * a_{n+1} - (c_f/A) * v_{n+1}\n    Returns final displacement x(T).\n    \"\"\"\n    beta = 1/4\n    gamma = 1/2\n\n    # Derived fluid mass\n    m_f = rho_f * A * L\n\n    # Time steps\n    n_steps = int(round(T / dt))\n\n    # Initial conditions\n    x_n = x0\n    v_n = v0\n    # p_out at initial time\n    p_out0 = 0.0 if p_out_func is None else p_out_func(0.0)\n    # Coupled initial acceleration from (m_s + m_f) * a0 + (c_s + c_f) * v0 + k_s * x0 = A * p_out0\n    a_n = (A * p_out0 - (c_s + c_f) * v_n - k_s * x_n) / (m_s + m_f)\n\n    # Time stepping\n    for i in range(n_steps):\n        t_np1 = (i + 1) * dt\n        p_out_np1 = 0.0 if p_out_func is None else p_out_func(t_np1)\n\n        # Predictors\n        x_pred = x_n + dt * v_n + dt * dt * (0.5 - beta) * a_n\n        v_pred = v_n + dt * (1 - gamma) * a_n\n\n        # Effective coefficients for acceleration solve:\n        # [(m_s + m_f) + gamma*dt*(c_s + c_f) + beta*dt^2*k_s] * a_{n+1} = A*p_out_np1 - (c_s + c_f)*v_pred - k_s*x_pred\n        lhs = (m_s + m_f) + gamma * dt * (c_s + c_f) + beta * dt * dt * k_s\n        rhs = A * p_out_np1 - (c_s + c_f) * v_pred - k_s * x_pred\n\n        a_np1 = rhs / lhs\n\n        # Corrector updates\n        v_np1 = v_pred + gamma * dt * a_np1\n        x_np1 = x_pred + beta * dt * dt * a_np1\n\n        # Advance state\n        x_n, v_n, a_n = x_np1, v_np1, a_np1\n\n    return x_n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (rho_f, A, L, m_s, k_s, c_s, c_f, dt, T, x0, v0)\n    test_cases = [\n        # Case 1: heavy structure, fine dt\n        (1000.0, 0.01, 1.0, 100.0, 100000.0, 100.0, 50.0, 0.001, 1.0, 0.001, 0.0),\n        # Case 2: light structure, fine dt\n        (1000.0, 0.01, 1.0, 1.0, 100000.0, 100.0, 50.0, 0.001, 1.0, 0.001, 0.0),\n        # Case 3: massless structural limit\n        (1000.0, 0.01, 1.0, 0.0, 100000.0, 100.0, 50.0, 0.001, 1.0, 0.001, 0.0),\n        # Case 4: coarse dt, lightly damped, strong added mass\n        (1000.0, 0.01, 1.0, 0.5, 5000.0, 0.0, 0.0, 0.05, 2.0, 0.001, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_f, A, L, m_s, k_s, c_s, c_f, dt, T, x0, v0 = case\n        xT = simulate_case(rho_f, A, L, m_s, k_s, c_s, c_f, dt, T, x0, v0)\n        results.append(xT)\n\n    # Final print statement in the exact required format, rounded to six decimal places.\n    print(\"[\" + \",\".join(f\"{val:.6f}\" for val in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}