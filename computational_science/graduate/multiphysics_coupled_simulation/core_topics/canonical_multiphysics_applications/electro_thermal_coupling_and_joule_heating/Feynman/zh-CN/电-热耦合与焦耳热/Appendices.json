{
    "hands_on_practices": [
        {
            "introduction": "在理想导体中，电阻为零。然而在现实世界中，即使是连接点（即接触界面）也存在电阻。当一种材料趋近于完美导体时，热量主要在哪里产生？本练习通过一个思想实验，探讨了体电阻和接触电阻之间的竞争关系，通过在电导率趋于无穷大（$ \\sigma \\to \\infty $）的极限下进行渐近分析，您将揭示一个关键现象：功率耗散会集中在界面处。这项练习旨在培养您对界面在电气系统中重要性的深刻物理直觉，并阐明在高性能电子设备中，管理接触电阻及其产生的热量可能比关注材料本身更为重要。",
            "id": "3505254",
            "problem": "考虑一个长度为 $L$、均匀横截面积为 $A$ 的一维均匀导体。该导体中存在稳恒直流电，其电流密度 $j$ 沿 $x$ 轴从 $x=0$ 到 $x=L$ 在空间上是均匀的。导体的体电导率为 $\\sigma$，两端通过具有相同有限电接触电阻率（单位面积）$\\rho_{c}$ 的接触点连接到电极。每个接触点上的电势降定义为 $j\\,\\rho_{c}$。假设系统处于稳态，位移电流可忽略不计，且电场是准静态和一维的。导体内部的焦耳热是体积性的，其密度为 $q(x)$；每个界面上的接触耗散是界面性的，其单位面积功率为 $p_{c}$。\n\n从电荷守恒基本定律和欧姆传导的本构关系出发，推导导体内部电场和电势的控制方程，以及由有限接触电阻率所决定的一致边界条件。使用焦耳热是电能转化为热能的定义，推导单位面积的总的体焦耳功率和单位面积的总的界面（接触）焦耳功率的表达式。然后，定义在导体内部产生的焦耳功率占总焦耳功率的比例 $f_{\\text{bulk}}(\\sigma)$，并确定在 $j$、$L$ 和 $\\rho_{c}$ 保持不变的情况下，当 $\\sigma \\to \\infty$ 时的领头阶渐近标度。你的最终答案必须是该极限下 $f_{\\text{bulk}}(\\sigma)$ 领头阶项的单一闭式解析表达式。不需要进行数值计算，且最终表达式中不应包含任何单位。",
            "solution": "首先验证问题以确保其是自洽的、有科学依据且良定的。\n\n### 步骤 1：提取已知条件\n- 导体是一维、均匀的，长度为 $L$，均匀横截面积为 $A$。\n- 稳恒直流电以空间均匀的电流密度 $j$ 沿 $x$ 轴从 $x=0$ 到 $x=L$ 流动。\n- 体电导率为 $\\sigma$。\n- 在两端 $x=0$ 和 $x=L$ 处存在相同的有限电接触电阻率（单位面积）$\\rho_{c}$。\n- 每个接触点上的电势降为 $j\\,\\rho_{c}$。\n- 系统处于稳态。\n- 位移电流可忽略不计。\n- 电场是准静态和一维的。\n- 导体内部的体积焦耳热密度为 $q(x)$。\n- 界面接触耗散的单位面积功率为 $p_{c}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，基于稳态电荷输运（欧姆定律）和焦耳热的基本原理。体电导率和接触电阻率的概念在物理学和电气工程中是标准概念。该问题是良定的，有足够的信息来推导所要求的量和唯一的渐近标度。语言客观而精确。该设置是分析真实导体中电阻和功率耗散的标准简化模型。因此，该问题被认为是有效的。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n### 解答推导\n推导过程首先建立电场和电势的控制方程，然后计算导体内部和接触点处的功率耗散，最后确定在导体内部耗散的功率分数的渐近行为。\n\n1.  **电场和电势的控制方程**\n    在稳态下，电荷守恒定律要求电流密度 $\\vec{J}$ 的散度为零：$\\nabla \\cdot \\vec{J} = 0$。对于沿 $x$ 轴具有电流密度 $j$ 的一维系统，这变为 $\\frac{dj}{dx} = 0$。由于问题陈述 $j$ 是空间均匀的，此条件得到满足。\n\n    欧姆导体的本构关系是欧姆定律，$\\vec{J} = \\sigma \\vec{E}$，其中 $\\vec{E}$ 是电场。在我们的一维情况下，$j = \\sigma E_{x}$，其中 $E_x$ 是沿 $x$ 轴的电场分量。由于 $j$ 和 $\\sigma$ 在导体内部是常数，导体内部（$0  x  L$）的电场也是恒定的：\n    $$E_x = \\frac{j}{\\sigma}$$\n    电场通过 $\\vec{E} = -\\nabla V$ 与电势 $V(x)$ 相关。在一维中，即为 $E_x = -\\frac{dV}{dx}$。结合这些，我们得到导体内部电势的控制常微分方程：\n    $$-\\frac{dV}{dx} = \\frac{j}{\\sigma}$$\n\n2.  **边界条件和电势降**\n    问题指明在两个接触点上各有 $\\Delta V_c = j \\rho_c$ 的电势降。让我们将导体两端内部的电势表示为 $V(0)$ 和 $V(L)$。导体内部的电势降为 $\\Delta V_{\\text{bulk}} = V(0) - V(L)$。我们可以通过对电场从 $x=0$ 到 $x=L$ 积分来求得：\n    $$\\Delta V_{\\text{bulk}} = V(0) - V(L) = -\\int_L^0 E_x \\, dx = \\int_0^L E_x \\, dx = \\int_0^L \\frac{j}{\\sigma} \\, dx = \\frac{jL}{\\sigma}$$\n    整个系统（包括两个接触点）的总电势降是导体内部电势降和两个接触点电势降之和：\n    $$\\Delta V_{\\text{total}} = \\Delta V_{\\text{bulk}} + 2 \\Delta V_c = \\frac{jL}{\\sigma} + 2 j \\rho_c$$\n    边界条件由这些界面上的电势降隐含定义。\n\n3.  **焦耳功率耗散**\n    由焦耳热产生的体积功率密度（热生成率）由 $q = \\vec{J} \\cdot \\vec{E}$ 给出。在导体内部：\n    $$q = j E_x = j \\left(\\frac{j}{\\sigma}\\right) = \\frac{j^2}{\\sigma}$$\n    在导体内部耗散的总焦耳功率 $P_{\\text{bulk}}$ 是该密度在导体体积 $V = A L$ 上的积分：\n    $$P_{\\text{bulk}} = \\int_{\\text{Volume}} q \\, dV = q \\cdot (A L) = \\frac{j^2 A L}{\\sigma}$$\n    问题要求的是单位面积的总的体焦耳功率，我们将其表示为 $P'_{\\text{bulk}}$：\n    $$P'_{\\text{bulk}} = \\frac{P_{\\text{bulk}}}{A} = \\frac{j^2 L}{\\sigma}$$\n    对于接触点，单个界面上耗散的功率是总电流 $I=jA$ 与电势降 $\\Delta V_c = j \\rho_c$ 的乘积。\n    $$P_{\\text{contact, one}} = I \\Delta V_c = (jA)(j\\rho_c) = j^2 A \\rho_c$$\n    单个接触点上单位面积耗散的功率为 $p_c = P_{\\text{contact, one}}/A = j^2 \\rho_c$。由于有两个相同的接触点，总的界面焦耳功率为 $P_{\\text{contact, total}} = 2 j^2 A \\rho_c$。单位面积的总的界面功率 $P'_{\\text{contact}}$ 为：\n    $$P'_{\\text{contact}} = \\frac{P_{\\text{contact, total}}}{A} = 2 j^2 \\rho_c$$\n    系统中单位面积耗散的总功率是体贡献和接触贡献之和：\n    $$P'_{\\text{total}} = P'_{\\text{bulk}} + P'_{\\text{contact}} = \\frac{j^2 L}{\\sigma} + 2 j^2 \\rho_c$$\n\n4.  **内部功率分数**\n    在导体内部产生的焦耳功率占总焦耳功率的比例 $f_{\\text{bulk}}(\\sigma)$ 是体功率与总功率之比：\n    $$f_{\\text{bulk}}(\\sigma) = \\frac{P'_{\\text{bulk}}}{P'_{\\text{total}}} = \\frac{\\frac{j^2 L}{\\sigma}}{\\frac{j^2 L}{\\sigma} + 2 j^2 \\rho_c}$$\n    分子和分母中的 $j^2$ 项相互抵消：\n    $$f_{\\text{bulk}}(\\sigma) = \\frac{\\frac{L}{\\sigma}}{\\frac{L}{\\sigma} + 2 \\rho_c}$$\n    分子和分母同时乘以 $\\sigma$ 得到简化表达式：\n    $$f_{\\text{bulk}}(\\sigma) = \\frac{L}{L + 2 \\rho_c \\sigma}$$\n\n5.  **$\\sigma \\to \\infty$ 时的渐近标度**\n    我们需要的 $j$、$L$ 和 $\\rho_c$ 保持不变的情况下，找出 $f_{\\text{bulk}}(\\sigma)$ 在 $\\sigma \\to \\infty$ 极限下的领头阶渐近标度。\n    当 $\\sigma \\to \\infty$ 时，分母中的项 $2 \\rho_c \\sigma$ 变得远大于常数项 $L$。\n    $$L + 2 \\rho_c \\sigma \\sim 2 \\rho_c \\sigma \\quad \\text{for } \\sigma \\to \\infty$$\n    因此，$f_{\\text{bulk}}(\\sigma)$ 的渐近行为是：\n    $$f_{\\text{bulk}}(\\sigma) \\approx \\frac{L}{2 \\rho_c \\sigma}$$\n    这个表达式表示了在大 $\\sigma$ 时 $f_{\\text{bulk}}(\\sigma)$ 的领头阶项。它表明在导体内部耗散的功率分数随 $\\sigma^{-1}$ 衰减。这在物理上是直观的：当导体变得理想（$\\sigma \\to \\infty$）时，其内部电阻消失，所有功率耗散都转移到非理想的接触点上。\n\n$f_{\\text{bulk}}(\\sigma)$ 在 $\\sigma \\to \\infty$ 时的领头阶渐近表达式为 $\\frac{L}{2 \\rho_c \\sigma}$。",
            "answer": "$$\\boxed{\\frac{L}{2 \\rho_{c} \\sigma}}$$"
        },
        {
            "introduction": "真实世界中的材料很少是完全均匀的，制造过程中的变化可能导致材料属性（如电导率）随空间位置而变化。本练习要求您超越解析解的范畴，首先为具有空间变化的电导率 $\\sigma(x)$ 的导体推导出温度控制方程，然后通过编写代码实现数值方法来求解。这项计算实践将理论与实际工程问题联系起来，通过开发数值求解器，您将掌握分析复杂异构系统中电热行为的技能，这对于现代设备（如电池和集成电路）的设计和可靠性分析至关重要。",
            "id": "3505229",
            "problem": "考虑一个一维模型，其中长度为 $L$ 的锂离子 (Li-ion) 电池集流体箔沿其厚度方向与多孔电极粘合。我们仅关注箔内由焦耳热产生的热量，并忽略电极中的化学效应和对流效应。该箔具有恒定的横截面积 $A$、恒定的热导率 $k$，以及因制造变异性而沿长度方向空间变化的电导率 $\\sigma(x)$。一个恒定的总电流 $I$ 沿 $x$ 方向从 $x=0$ 流向 $x=L$。两端保持在指定的温度，模拟两端的等温极耳。\n\n从以下基本原理出发：\n- 稳态下的电荷守恒（无累积），意味着一维电流密度的守恒，即 $dJ_x/dx = 0$。\n- 电流密度和电场之间的本构关系，$J_x = \\sigma(x)\\,E_x$，结合静电关系 $E_x = -d\\phi/dx$。\n- 焦耳热的定义，$\\dot{q}(x) = \\mathbf{J}\\cdot\\mathbf{E}$。\n- 恒定热导率下的一维稳态热传导方程，$-\\dfrac{d}{dx}\\left(k\\,\\dfrac{dT}{dx}\\right)=\\dot{q}(x)$。\n- 狄利克雷边界条件 $T(0)=T_{\\mathrm{left}}$ 和 $T(L)=T_{\\mathrm{right}}$。\n\n请从第一性原理出发，并且不使用任何预先推导的简化公式，推导如何仅使用上述基本定律和定义，根据 $I$、$A$、$k$、$\\sigma(x)$ 和边界温度来计算箔内的温度场 $T(x)$ 和温度梯度 $dT/dx$。\n\n您的程序必须实现一种数值方法，该方法适用于任意光滑的 $\\sigma(x)0$，用于计算每个指定测试用例的以下值：\n- 箔内的最高温度 $T_{\\max}$，单位为 $\\mathrm{K}$。\n- 最高温度的位置 $x_{\\max}$，单位为 $\\mathrm{m}$。\n- 左边界的温度梯度 $\\left.\\dfrac{dT}{dx}\\right|_{x=0}$，单位为 $\\mathrm{K/m}$。\n- 右边界的温度梯度 $\\left.\\dfrac{dT}{dx}\\right|_{x=L}$，单位为 $\\mathrm{K/m}$。\n\n所有输出必须使用国际单位制 (SI) 表示。所有浮点数结果均四舍五入到六位小数。\n\n测试套件（四个用例），每个用例都有一个域长度 $L$、横截面积 $A$、电流 $I$、热导率 $k$、左侧和右侧温度 $T_{\\mathrm{left}}$、$T_{\\mathrm{right}}$，以及一个空间变化的电导率 $\\sigma(x)$，具体如下所述。对于每个用例，请使用给定的参数和 $\\sigma(x)$ 的定义：\n\n- 用例 1（基准情况，近乎均匀的铜箔）：\n  - $L = 0.1\\,\\mathrm{m}$，$A = 1.0\\times 10^{-5}\\,\\mathrm{m^2}$，$I = 10.0\\,\\mathrm{A}$，$k = 200.0\\,\\mathrm{W/(m\\,K)}$，$T_{\\mathrm{left}}=300.0\\,\\mathrm{K}$，$T_{\\mathrm{right}}=300.0\\,\\mathrm{K}$。\n  - $\\sigma(x) = \\sigma_0$，其中 $\\sigma_0 = 5.8\\times 10^{7}\\,\\mathrm{S/m}$。\n\n- 用例 2（电导率的线性制造梯度）：\n  - $L = 0.1\\,\\mathrm{m}$，$A = 1.0\\times 10^{-5}\\,\\mathrm{m^2}$，$I = 10.0\\,\\mathrm{A}$，$k = 200.0\\,\\mathrm{W/(m\\,K)}$，$T_{\\mathrm{left}}=300.0\\,\\mathrm{K}$，$T_{\\mathrm{right}}=300.0\\,\\mathrm{K}$。\n  - $\\sigma(x) = \\sigma_0 \\left(1 + \\alpha\\left(\\dfrac{2x}{L}-1\\right)\\right)$，其中 $\\sigma_0 = 5.8\\times 10^{7}\\,\\mathrm{S/m}$ 且 $\\alpha=0.2$。\n\n- 用例 3（正弦变化和较低的热导率）：\n  - $L = 0.1\\,\\mathrm{m}$，$A = 1.0\\times 10^{-5}\\,\\mathrm{m^2}$，$I = 15.0\\,\\mathrm{A}$，$k = 90.0\\,\\mathrm{W/(m\\,K)}$，$T_{\\mathrm{left}}=300.0\\,\\mathrm{K}$，$T_{\\mathrm{right}}=300.0\\,\\mathrm{K}$。\n  - $\\sigma(x) = \\sigma_0 \\left(1 + \\varepsilon \\sin\\left(\\dfrac{4\\pi x}{L}\\right)\\right)$，其中 $\\sigma_0 = 3.5\\times 10^{7}\\,\\mathrm{S/m}$ 且 $\\varepsilon=0.5$。\n\n- 用例 4（由高斯衰减模拟的局部电导率缺陷）：\n  - $L = 0.05\\,\\mathrm{m}$，$A = 8.0\\times 10^{-6}\\,\\mathrm{m^2}$，$I = 8.0\\,\\mathrm{A}$，$k = 235.0\\,\\mathrm{W/(m\\,K)}$，$T_{\\mathrm{left}}=298.15\\,\\mathrm{K}$，$T_{\\mathrm{right}}=298.15\\,\\mathrm{K}$。\n  - $\\sigma(x) = \\dfrac{\\sigma_0}{1 + \\beta \\exp\\left(-\\dfrac{(x-x_0)^2}{2 w^2}\\right)}$，其中 $\\sigma_0 = 3.7\\times 10^{7}\\,\\mathrm{S/m}$，$\\beta=4.0$，$x_0 = \\dfrac{L}{2}$，且 $w = 0.05L$。\n\n您的算法应该是通用的，不依赖于任何针对 $\\sigma(x)$ 的闭合形式原语。您可以假设 $\\sigma(x)$ 在 $[0,L]$ 上是严格正值且足够光滑的。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果都以 $[T_{\\max}, x_{\\max}, (dT/dx)|_{x=0}, (dT/dx)|_{x=L}]$ 的顺序生成自己的子列表。例如，最终输出格式必须类似于 $[[v_{1,1},v_{1,2},v_{1,3},v_{1,4}],[v_{2,1},v_{2,2},v_{2,3},v_{2,4}],\\dots]$，所有值均四舍五入到六位小数。",
            "solution": "该问题要求推导一种计算一维箔片在焦耳热作用下温度分布 $T(x)$ 的方法，并进行数值实现。推导将从所提供的基本原理出发。\n\n### 第1部分：从第一性原理推导\n\n**1. 热源公式化**\n\n分析首先建立由焦耳热引起的体积生热率 $\\dot{q}(x)$。\n- **电荷守恒：** 在稳态下，电流是守恒的。问题将其表述为 $\\dfrac{dJ_x}{dx} = 0$，其中 $J_x$ 是 $x$ 方向的电流密度。这意味着 $J_x$ 沿着箔的长度是恒定的。\n- **电流密度和总电流：** 总电流 $I$ 与电流密度 $J_x$ 和恒定的横截面积 $A$ 通过关系 $I = J_x A$ 相关联。因此，恒定的电流密度为 $J_x = \\dfrac{I}{A}$。\n- **电场：** 本构关系（欧姆定律）通过空间变化的电导率 $\\sigma(x)$ 将电流密度 $J_x$ 与电场 $E_x$ 联系起来：$J_x = \\sigma(x) E_x(x)$。代入恒定的 $J_x$，我们可以将电场表示为位置的函数：\n$$E_x(x) = \\dfrac{J_x}{\\sigma(x)} = \\dfrac{I}{A \\sigma(x)}$$\n- **焦耳热：** 体积生热率 $\\dot{q}(x)$ 定义为电流密度矢量和电场矢量的点积，即 $\\dot{q} = \\mathbf{J} \\cdot \\mathbf{E}$。在我们的以为情况下，这简化为 $\\dot{q}(x) = J_x E_x(x)$。代入 $J_x$ 和 $E_x(x)$ 的表达式：\n$$\\dot{q}(x) = \\left(\\dfrac{I}{A}\\right) \\left(\\dfrac{I}{A \\sigma(x)}\\right) = \\dfrac{I^2}{A^2 \\sigma(x)}$$\n这是热传导方程的源项。\n\n**2. 温度的控制方程**\n\n具有恒定热导率 $k$ 和热源 $\\dot{q}(x)$ 的一维稳态热传导方程如下：\n$$-\\dfrac{d}{dx}\\left(k\\,\\dfrac{dT}{dx}\\right) = \\dot{q}(x)$$\n由于 $k$ 是常数，方程变为：\n$$-k \\dfrac{d^2T}{dx^2} = \\dot{q}(x)$$\n代入推导出的 $\\dot{q}(x)$ 表达式，我们得到温度场 $T(x)$ 的控制二阶常微分方程 (ODE)：\n$$\\dfrac{d^2T}{dx^2} = -\\dfrac{I^2}{k A^2 \\sigma(x)}$$\n该方程受狄利克雷边界条件 $T(0) = T_{\\mathrm{left}}$ 和 $T(L) = T_{\\mathrm{right}}$ 的约束。为方便起见，我们定义源函数 $S(x) = \\dfrac{I^2}{k A^2 \\sigma(x)}$，因此常微分方程为 $\\dfrac{d^2T}{dx^2} = -S(x)$。\n\n**3. 通过积分求解通解**\n\n我们通过对 $x$ 进行两次积分来求解该常微分方程。\n- **第一次积分：** 对 $\\dfrac{d^2T}{dx^2}$ 进行一次积分，得到温度梯度 $\\dfrac{dT}{dx}$：\n$$\\dfrac{dT}{dx}(x) = \\int_{0}^{x} (-S(\\xi)) d\\xi + C_1 = C_1 - \\int_{0}^{x} S(\\xi) d\\xi$$\n这里，$C_1$ 是积分常数，它等于 $x=0$ 处的温度梯度，即 $C_1 = \\left.\\dfrac{dT}{dx}\\right|_{x=0}$。\n\n- **第二次积分：** 对 $\\dfrac{dT}{dx}(x)$ 进行积分，得到温度场 $T(x)$：\n$$T(x) = \\int_{0}^{x} \\left( C_1 - \\int_{0}^{\\eta} S(\\xi) d\\xi \\right) d\\eta + C_2 = C_2 + C_1 x - \\int_{0}^{x} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\n常数 $C_2$ 由 $x=0$ 处的边界条件确定：$T(0) = C_2 = T_{\\mathrm{left}}$。因此：\n$$T(x) = T_{\\mathrm{left}} + C_1 x - \\int_{0}^{x} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\n\n- **确定积分常数 $C_1$：** 常数 $C_1$ 通过应用在 $x=L$ 处的第二个边界条件来找到：\n$$T(L) = T_{\\mathrm{right}} = T_{\\mathrm{left}} + C_1 L - \\int_{0}^{L} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\n解出 $C_1$：\n$$C_1 = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{1}{L} \\int_{0}^{L} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta$$\n该二重积分可以使用分部积分法简化，得到 $\\int_{0}^{L} \\int_{0}^{\\eta} S(\\xi) d\\xi d\\eta = \\int_{0}^{L} (L-x) S(x) dx$。代入此式，得到 $C_1$ 的单积分表达式：\n$$C_1 = \\left.\\dfrac{dT}{dx}\\right|_{x=0} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{1}{L} \\int_{0}^{L} (L-x) S(x) dx$$\n将 $S(x) = \\dfrac{I^2}{k A^2 \\sigma(x)}$ 代回：\n$$\\left.\\dfrac{dT}{dx}\\right|_{x=0} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{I^2}{k A^2 L} \\int_{0}^{L} \\dfrac{L-x}{\\sigma(x)} dx$$\n\n**4. 用于计算的最终表达式**\n\n确定了 $C_1$ 后，我们就有了所有必要的组成部分。\n- **边界处的温度梯度：**\n  - 在 $x=0$ 处：即为上面推导的 $C_1$。\n  - 在 $x=L$ 处：我们计算在 $x=L$ 处的梯度表达式：\n  $$\\left.\\dfrac{dT}{dx}\\right|_{x=L} = C_1 - \\int_{0}^{L} S(\\xi) d\\xi$$\n  代入 $C_1$ 的完整表达式并简化，得到：\n  $$\\left.\\dfrac{dT}{dx}\\right|_{x=L} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} - \\dfrac{1}{L} \\int_{0}^{L} x S(x) dx = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} - \\dfrac{I^2}{k A^2 L} \\int_{0}^{L} \\dfrac{x}{\\sigma(x)} dx$$\n\n- **最高温度及其位置：**\n由于 $T''(x) = -S(x) \\le 0$（因为 $\\sigma(x)0$ 且所有其他参数均为正），温度分布 $T(x)$ 是一个严格凹函数。其在区间 $[0,L]$ 上的最大值要么出现在 $\\dfrac{dT}{dx}=0$ 的内部点，要么出现在某个边界上。\n潜在内部最大值的位置 $x_{\\max}$ 通过将梯度设为零来找到：\n$$\\dfrac{dT}{dx}(x_{\\max}) = C_1 - \\int_{0}^{x_{\\max}} S(\\xi) d\\xi = 0 \\implies \\int_{0}^{x_{\\max}} S(\\xi) d\\xi = C_1$$\n这是一个关于 $x_{\\max}$ 的隐式方程。\n寻找位置 $x_{\\max}$ 和值 $T_{\\max}$ 的算法如下：\n1. 计算 $C_1 = \\left.\\dfrac{dT}{dx}\\right|_{x=0}$ 和 $\\left.\\dfrac{dT}{dx}\\right|_{x=L}$。\n2. 如果 $C_1 \\le 0$，则函数是非增的。最大值在左边界：$x_{\\max}=0$，$T_{\\max}=T_{\\mathrm{left}}$。\n3. 如果 $\\left.\\dfrac{dT}{dx}\\right|_{x=L} \\ge 0$，则函数是非减的。最大值在右边界：$x_{\\max}=L$，$T_{\\max}=T_{\\mathrm{right}}$。\n4. 如果 $C_1  0$ 且 $\\left.\\dfrac{dT}{dx}\\right|_{x=L}  0$，则存在一个唯一的内部最大值。位置 $x_{\\max}$ 是方程 $\\int_{0}^{x} S(\\xi) d\\xi - C_1 = 0$ 在区间 $(0,L)$ 内的根。\n5. 最高温度 $T_{\\max}$ 则为 $T(x_{\\max})$。$T(x)$ 的表达式可以写为：\n$$T(x) = T_{\\mathrm{left}} + C_1 x - \\int_{0}^{x} (x-\\xi) S(\\xi) d\\xi$$\n$$T(x) = T_{\\mathrm{left}} + \\left(\\left.\\dfrac{dT}{dx}\\right|_{x=0}\\right) x - \\dfrac{I^2}{k A^2} \\int_{0}^{x} \\dfrac{x-\\xi}{\\sigma(\\xi)} d\\xi$$\n\n### 第2部分：数值算法设计\n\n推导出的解析表达式包含积分，对于任意的 $\\sigma(x)$，这些积分必须进行数值计算。算法流程如下：\n\n1.  **定义常数和函数：** 对于每个测试用例，定义物理常数（$L, A, I, k, T_{\\mathrm{left}}, T_{\\mathrm{right}}$）和函数 $\\sigma(x)$。预先计算常数因子 $C_S = \\dfrac{I^2}{k A^2}$。\n\n2.  **计算边界梯度：**\n    - 使用数值求积方法（例如 `scipy.integrate.quad`）计算积分 $I_1 = \\int_{0}^{L} \\dfrac{L-x}{\\sigma(x)} dx$。\n    - 计算左边界的梯度：$\\left.\\dfrac{dT}{dx}\\right|_{x=0} = \\dfrac{T_{\\mathrm{right}} - T_{\\mathrm{left}}}{L} + \\dfrac{C_S}{L} I_1$。\n    - 使用数值求积计算积分 $I_2 = \\int_{0}^{L} \\dfrac{1}{\\sigma(x)} dx$。\n    - 计算右边界的梯度：$\\left.\\dfrac{dT}{dx}\\right|_{x=L} = \\left.\\dfrac{dT}{dx}\\right|_{x=0} - C_S I_2$。\n\n3.  **寻找最高温度和位置：**\n    - 检查边界梯度的符号，以确定最大值是否在端点，如前所述。\n    - 如果存在内部最大值，则通过求解函数 $f(x) = \\left(\\int_{0}^{x} \\dfrac{1}{\\sigma(\\xi)} d\\xi \\right) - \\dfrac{1}{C_S} \\left.\\dfrac{dT}{dx}\\right|_{x=0} = 0$ 的根来求解 $x_{\\max}$。这可以使用数值求根算法（例如 `scipy.optimize.brentq`）在区间 $(0,L)$ 上完成。$f(x)$ 中的积分在每一步都使用数值求积计算。\n    - 找到 $x_{\\max}$ 后，使用 $T(x)$ 的公式计算 $T_{\\max} = T(x_{\\max})$。这需要通过数值求积计算最后一个积分 $I_3 = \\int_{0}^{x_{\\max}} \\dfrac{x_{\\max}-\\xi}{\\sigma(\\xi)} d\\xi$。\n\n4.  **输出格式化：** 将计算出的四个值（$T_{\\max}, x_{\\max}, \\left.\\dfrac{dT}{dx}\\right|_{x=0}, \\left.\\dfrac{dT}{dx}\\right|_{x=L}$）整理起来，四舍五入到六位小数，并按指定格式格式化。对每个测试用例重复此过程。\n\n该方法是通用的，依赖于鲁棒的数值库函数进行积分和求根，使其适用于任何光滑、严格正值的电导率函数 $\\sigma(x)$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the electro-thermal problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: Baseline\n        {\n            \"L\": 0.1, \"A\": 1.0e-5, \"I\": 10.0, \"k\": 200.0,\n            \"T_left\": 300.0, \"T_right\": 300.0,\n            \"sigma\": lambda x, p: p[\"sigma0\"],\n            \"sigma_params\": {\"sigma0\": 5.8e7}\n        },\n        # Case 2: Linear Gradient\n        {\n            \"L\": 0.1, \"A\": 1.0e-5, \"I\": 10.0, \"k\": 200.0,\n            \"T_left\": 300.0, \"T_right\": 300.0,\n            \"sigma\": lambda x, p: p[\"sigma0\"] * (1 + p[\"alpha\"] * (2 * x / p[\"L\"] - 1)),\n            \"sigma_params\": {\"sigma0\": 5.8e7, \"alpha\": 0.2, \"L\": 0.1}\n        },\n        # Case 3: Sinusoidal Variability\n        {\n            \"L\": 0.1, \"A\": 1.0e-5, \"I\": 15.0, \"k\": 90.0,\n            \"T_left\": 300.0, \"T_right\": 300.0,\n            \"sigma\": lambda x, p: p[\"sigma0\"] * (1 + p[\"epsilon\"] * np.sin(4 * np.pi * x / p[\"L\"])),\n            \"sigma_params\": {\"sigma0\": 3.5e7, \"epsilon\": 0.5, \"L\": 0.1}\n        },\n        # Case 4: Localized Defect\n        {\n            \"L\": 0.05, \"A\": 8.0e-6, \"I\": 8.0, \"k\": 235.0,\n            \"T_left\": 298.15, \"T_right\": 298.15,\n            \"sigma\": lambda x, p: p[\"sigma0\"] / (1 + p[\"beta\"] * np.exp(-(x - p[\"x0\"])**2 / (2 * p[\"w\"]**2))),\n            \"sigma_params\": {\n                \"sigma0\": 3.7e7, \"beta\": 4.0, \n                \"x0\": 0.05 / 2, \"w\": 0.05 * 0.05\n            }\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = process_case(case)\n        all_results.append(result)\n\n    # Format the final output string as specified\n    str_cases = []\n    for case_res in all_results:\n        # Format each value to 6 decimal places\n        str_vals = [f\"{v:.6f}\" for v in case_res]\n        str_cases.append(f\"[{','.join(str_vals)}]\")\n    \n    print(f\"[{','.join(str_cases)}]\")\n\ndef process_case(params):\n    \"\"\"\n    Computes the required quantities for a single test case.\n    \"\"\"\n    L = params[\"L\"]\n    A = params[\"A\"]\n    I = params[\"I\"]\n    k = params[\"k\"]\n    T_left = params[\"T_left\"]\n    T_right = params[\"T_right\"]\n    \n    # Create a simple callable for sigma(x) for this case\n    sigma = lambda x: params[\"sigma\"](x, params[\"sigma_params\"])\n\n    # Constant factor for the source term S(x) = C_S / sigma(x)\n    C_S = I**2 / (k * A**2)\n\n    # Calculate grad_T_left (C1) = (T_right - T_left)/L + (C_S / L) * integral((L-x)/sigma(x), 0, L)\n    integrand_C1 = lambda x: (L - x) / sigma(x)\n    integral_val_C1, _ = quad(integrand_C1, 0, L, epsabs=1e-12, epsrel=1e-12)\n    grad_T_left = (T_right - T_left) / L + (C_S / L) * integral_val_C1\n\n    # Calculate grad_T_right = grad_T_left - C_S * integral(1/sigma(x), 0, L)\n    integrand_grad_R = lambda x: 1 / sigma(x)\n    integral_val_grad_R, _ = quad(integrand_grad_R, 0, L, epsabs=1e-12, epsrel=1e-12)\n    grad_T_right = grad_T_left - C_S * integral_val_grad_R\n    \n    # Determine the location and value of the maximum temperature\n    if grad_T_left = 0:\n        # Temperature is non-increasing, max is at the left boundary.\n        x_max = 0.0\n        T_max = T_left\n    elif grad_T_right >= 0:\n        # Temperature is non-decreasing, max is at the right boundary.\n        x_max = L\n        T_max = T_right\n    else:\n        # An interior maximum exists. Find its location x_max by solving a root problem.\n        # We need to find x where integral(S(xi), 0, x) = grad_T_left.\n        # This is equivalent to finding the root of:\n        # integral(1/sigma(xi), 0, x) - grad_T_left / C_S = 0\n        target_integral_val = grad_T_left / C_S\n        \n        def root_func(x):\n            val, _ = quad(lambda xi: 1 / sigma(xi), 0, x, epsabs=1e-12, epsrel=1e-12)\n            return val - target_integral_val\n\n        # Find the root x_max in the interval (0, L).\n        # brentq is a robust choice as we have a bracketed root.\n        x_max = brentq(root_func, 0, L)\n\n        # Calculate T_max = T(x_max) using the derived formula:\n        # T(x) = T_left + grad_T_left * x - C_S * integral((x-xi)/sigma(xi), 0, x)\n        integrand_T_max = lambda xi: (x_max - xi) / sigma(xi)\n        integral_val_T, _ = quad(integrand_T_max, 0, x_max, epsabs=1e-12, epsrel=1e-12)\n        T_max = T_left + grad_T_left * x_max - C_S * integral_val_T\n\n    return [T_max, x_max, grad_T_left, grad_T_right]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}