{
    "hands_on_practices": [
        {
            "introduction": "在许多工程和科学问题中，模型的输入参数（如材料属性或边界条件）并非精确已知，而是具有不确定性。这个练习将带你实践一种关键的前向不确定性传播技术：非侵入式随机配置法。你将学习如何使用稀疏网格来高效地计算一个耦合模型输出（在本例中为结构状态）的期望值，这是理解不确定性如何通过系统传播的基础。",
            "id": "3531582",
            "problem": "考虑一个包含热模块和结构模块的双模块稳态多物理场耦合问题。热模块计算标量状态 $u$，结构模块计算标量状态 $v$。这两个模块非线性耦合，并依赖于独立的不确定输入 $\\xi_1$ 和 $\\xi_2$，两者均在区间 $[-1,1]$ 上服从均匀分布。对于任意实现 $(\\xi_1,\\xi_2)$，耦合代数系统为\n$$\nu \\;=\\; 1 \\;+\\; 0.5\\,\\xi_1 \\;+\\; 0.1\\,v,\n$$\n$$\nv \\;=\\; 2 \\;+\\; 0.25\\,\\xi_2 \\;+\\; 0.2\\,u^{2}.\n$$\n假设当系统被简化为关于 $v$ 的标量多项式时，物理上允许的解分支对应于较小的实根。\n\n你需要使用非侵入式随机配置法来近似计算结构状态 $v$ 的期望。该方法采用一个二维 2 级 Smolyak 稀疏网格，此网格由区间 $[-1,1]$ 上的一维 Gauss–Legendre 法则构建。一维求积法则如下：\n- 1 阶：节点为 $0$，权重为 $2$。\n- 3 阶：节点为 $-\\sqrt{3/5}$、$0$ 和 $\\sqrt{3/5}$，权重分别为 $5/9$、$8/9$ 和 $5/9$。\n\n使用二维 2 级的 Smolyak 组合公式，构建五个配置节点及其面积分权重。然后，将这些面积分权重转换为适用于在 $[-1,1]^2$ 上均匀分布的期望计算的概率权重，注意到该正方形上的联合概率密度为 $1/4$。在每个稀疏网格节点上，通过求解耦合系统以获得该配置输入对应的 $u$ 和 $v$ 来非侵入式地处理模块，然后计算加权和以近似 $\\mathbb{E}[v]$。\n\n计算所得的期望值，并将最终答案表示为一个无量纲实数。将答案四舍五入至四位有效数字。",
            "solution": "用户希望使用非侵入式随机配置法，求出结构状态变量 $v$ 的期望值，记作 $\\mathbb{E}[v]$。该方法基于一个 2 级、2 维的 Smolyak 稀疏网格。\n\n首先，我们必须验证问题陈述。\n\n### 步骤 1：提取已知条件\n问题提供了以下信息：\n- 一个关于标量状态 $u$ 和 $v$ 的两个非线性代数方程的耦合系统：\n  $$u = 1 + 0.5\\xi_1 + 0.1v$$\n  $$v = 2 + 0.25\\xi_2 + 0.2u^2$$\n- 两个独立不确定输入 $\\xi_1$ 和 $\\xi_2$，均在区间 $[-1, 1]$ 上服从均匀分布。\n- 一个解的选择条件：当系统简化为关于 $v$ 的标量多项式时，物理上允许的分支对应于较小的实根。\n- 数值积分方法为二维（$d=2$）2级（$L=2$）的 Smolyak 稀疏网格。\n- 使用的一维求积法则是 Gauss-Legendre 法则：\n    - 1 阶（1 级）：1 个节点位于 $x=0$，权重 $w=2$。我们称此法则为 $\\mathcal{Q}_1$。\n    - 3 阶（2 级）：3 个节点位于 $x \\in \\{-\\sqrt{3/5}, 0, \\sqrt{3/5}\\}$，权重分别为 $w \\in \\{5/9, 8/9, 5/9\\}$。我们称此法则为 $\\mathcal{Q}_2$。\n- 步骤如下：\n    1. 构建五个配置节点及其面积分权重。\n    2. 将这些权重转换为概率权重。\n    3. 在每个节点上求解耦合系统，得到 $v(\\boldsymbol{\\xi}_i)$。\n    4. 计算加权和以近似 $\\mathbb{E}[v]$。\n- 最终答案应四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是计算科学中不确定性量化的一个标准应用。问题是适定的，因为它指定了需要遵循的唯一解分支。语言客观、精确。所有必要的数据和定义都已提供，且没有矛盾之处。该问题不简单，需要多步骤、严格地应用一种标准的数值方法。因此，该问题被认定为有效。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行求解。\n\n### 求解推导\n\n目标是近似计算期望 $\\mathbb{E}[v]$：\n$$ \\mathbb{E}[v] = \\int_{-1}^{1}\\int_{-1}^{1} v(\\xi_1, \\xi_2) p(\\xi_1, \\xi_2) \\,d\\xi_1 d\\xi_2 $$\n由于 $\\xi_1$ 和 $\\xi_2$ 是独立的，并且在 $[-1, 1]$ 上均匀分布，因此在定义域 $[-1, 1]^2$ 上的联合概率密度函数 (PDF) 为 $p(\\xi_1, \\xi_2) = p_1(\\xi_1)p_2(\\xi_2) = \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}$。\n因此，期望为：\n$$ \\mathbb{E}[v] = \\frac{1}{4} \\int_{-1}^{1}\\int_{-1}^{1} v(\\xi_1, \\xi_2) \\,d\\xi_1 d\\xi_2 $$\n该积分将使用 Smolyak 稀疏网格求积法则进行近似。\n\n**1. 构建 Smolyak 稀疏网格求积法则**\n\n问题指定了一个 2 级（$L=2$）、2 维（$d=2$）的 Smolyak 网格，它由一个 1 级法则 $\\mathcal{Q}_1$（1 点 Gauss-Legendre）和一个 2 级法则 $\\mathcal{Q}_2$（3 点 Gauss-Legendre）构建。Smolyak 求积算子 $\\mathcal{A}_{L,d}$ 使用组合技巧构建：\n$$ \\mathcal{A}_{L,d} = \\mathcal{A}_{2,2} = \\mathcal{Q}_1 \\otimes \\mathcal{Q}_2 + \\mathcal{Q}_2 \\otimes \\mathcal{Q}_1 - \\mathcal{Q}_1 \\otimes \\mathcal{Q}_1 $$\n这个稀疏网格的节点是构成的张量积网格节点的并集。令 $\\alpha = \\sqrt{3/5}$。\n- $\\mathcal{Q}_1$ 的节点：$\\{0\\}$\n- $\\mathcal{Q}_2$ 的节点：$\\{-\\alpha, 0, \\alpha\\}$\n来自 $\\mathcal{X}_1 \\!\\times\\! \\mathcal{X}_2$、$\\mathcal{X}_2 \\!\\times\\! \\mathcal{X}_1$ 和 $\\mathcal{X}_1 \\!\\times\\! \\mathcal{X}_1$ 的节点并集给出了 5 点集：\n$$ \\mathcal{H}_{2,2} = \\{ (0,0), (\\pm \\alpha, 0), (0, \\pm \\alpha) \\} $$\n面积分权重 $w_i^{\\text{area}}$ 是从组合公式推导出来的。对于一个函数 $f(\\xi_1, \\xi_2)$：\n$$ \\int_{-1}^{1}\\int_{-1}^{1} f(\\xi_1, \\xi_2) \\,d\\xi_1 d\\xi_2 \\approx \\sum_{i} w_i^{\\text{area}} f(\\boldsymbol{\\xi}_i) $$\n将组合公式应用于权重：\n- 对于点 $(0,0)$：权重为 $w_1(0)w_2(0) + w_2(0)w_1(0) - w_1(0)w_1(0) = (2)(\\frac{8}{9}) + (\\frac{8}{9})(2) - (2)(2) = \\frac{16}{9} + \\frac{16}{9} - 4 = \\frac{32-36}{9} = -\\frac{4}{9}$。\n- 对于点 $(\\pm \\alpha, 0)$：权重为 $w_2(\\pm \\alpha)w_1(0) = (\\frac{5}{9})(2) = \\frac{10}{9}$。\n- 对于点 $(0, \\pm \\alpha)$：权重为 $w_1(0)w_2(\\pm \\alpha) = (2)(\\frac{5}{9}) = \\frac{10}{9}$。\n\n五个配置节点 $\\boldsymbol{\\xi}_i = (\\xi_{1,i}, \\xi_{2,i})$ 及其面积分权重 $w_i^{\\text{area}}$ 如下：\n1. $\\boldsymbol{\\xi}_1 = (-\\sqrt{3/5}, 0)$，$w_1^{\\text{area}} = 10/9$\n2. $\\boldsymbol{\\xi}_2 = (\\sqrt{3/5}, 0)$，$w_2^{\\text{area}} = 10/9$\n3. $\\boldsymbol{\\xi}_3 = (0, -\\sqrt{3/5})$，$w_3^{\\text{area}} = 10/9$\n4. $\\boldsymbol{\\xi}_4 = (0, \\sqrt{3/5})$，$w_4^{\\text{area}} = 10/9$\n5. $\\boldsymbol{\\xi}_5 = (0, 0)$，$w_5^{\\text{area}} = -4/9$\n\n概率权重 $w_i^{\\text{prob}}$ 是通过将面积分权重除以定义域的面积（即 $4$）得到的：\n$$ w_i^{\\text{prob}} = \\frac{w_i^{\\text{area}}}{4} $$\n1. $w_{1,2,3,4}^{\\text{prob}} = \\frac{10/9}{4} = \\frac{10}{36} = \\frac{5}{18}$\n2. $w_5^{\\text{prob}} = \\frac{-4/9}{4} = -\\frac{4}{36} = -\\frac{1}{9}$\n这些权重的总和为 $4 \\cdot (5/18) - 1/9 = 20/18 - 2/18 = 18/18 = 1$，符合要求。\n\n**2. 在每个节点上求解耦合系统**\n\n首先，我们将系统简化为关于 $v$ 的一个一元二次方程。将第一个方程中的 $u$ 代入第二个方程：\n$$ v = 2 + 0.25\\xi_2 + 0.2(1 + 0.5\\xi_1 + 0.1v)^2 $$\n$$ v = 2 + 0.25\\xi_2 + 0.2[ (1 + 0.5\\xi_1)^2 + 0.2(1 + 0.5\\xi_1)v + 0.01v^2 ] $$\n$$ v = 2 + 0.25\\xi_2 + 0.2(1 + \\xi_1 + 0.25\\xi_1^2) + 0.04(1 + 0.5\\xi_1)v + 0.002v^2 $$\n重新排列成 $Av^2 + Bv + C = 0$ 的形式：\n$$ 0.002v^2 + [0.04 + 0.02\\xi_1 - 1]v + [2.2 + 0.2\\xi_1 + 0.05\\xi_1^2 + 0.25\\xi_2] = 0 $$\n系数为：\n$$ A = 0.002 $$\n$$ B = -0.96 + 0.02\\xi_1 $$\n$$ C = 2.2 + 0.2\\xi_1 + 0.05\\xi_1^2 + 0.25\\xi_2 $$\n$v$ 的解由二次方程求根公式 $v = \\frac{-B \\pm \\sqrt{B^2-4AC}}{2A}$ 给出。问题指定使用较小的实根，由于 $A > 0$，这对应于分子中的减号。\n$$ v(\\xi_1, \\xi_2) = \\frac{-B - \\sqrt{B^2 - 4AC}}{2A} $$\n我们现在计算 $v$ 在五个配置节点处的值。令 $\\alpha = \\sqrt{3/5} \\approx 0.77459667$。\n\n- **节点 1: $\\boldsymbol{\\xi}_1 = (-\\alpha, 0)$**\n  $\\xi_1 = -\\alpha, \\xi_2 = 0$.\n  $B = -0.96 - 0.02\\alpha \\approx -0.975492$\n  $C = 2.2 - 0.2\\alpha + 0.05\\alpha^2 = 2.2 - 0.2\\alpha + 0.05(0.6) = 2.23 - 0.2\\alpha \\approx 2.075081$\n  $v_1 \\approx \\frac{0.975492 - \\sqrt{(-0.975492)^2 - 4(0.002)(2.075081)}}{0.004} \\approx 2.136577$\n\n- **节点 2: $\\boldsymbol{\\xi}_2 = (\\alpha, 0)$**\n  $\\xi_1 = \\alpha, \\xi_2 = 0$.\n  $B = -0.96 + 0.02\\alpha \\approx -0.944508$\n  $C = 2.2 + 0.2\\alpha + 0.05\\alpha^2 = 2.23 + 0.2\\alpha \\approx 2.384919$\n  $v_2 \\approx \\frac{0.944508 - \\sqrt{(-0.944508)^2 - 4(0.002)(2.384919)}}{0.004} \\approx 2.538684$\n\n- **节点 3: $\\boldsymbol{\\xi}_3 = (0, -\\alpha)$**\n  $\\xi_1 = 0, \\xi_2 = -\\alpha$.\n  $B = -0.96$\n  $C = 2.2 - 0.25\\alpha \\approx 2.006351$\n  $v_3 \\approx \\frac{0.96 - \\sqrt{(-0.96)^2 - 4(0.002)(2.006351)}}{0.004} \\approx 2.099129$\n\n- **节点 4: $\\boldsymbol{\\xi}_4 = (0, \\alpha)$**\n  $\\xi_1 = 0, \\xi_2 = \\alpha$.\n  $B = -0.96$\n  $C = 2.2 + 0.25\\alpha \\approx 2.393649$\n  $v_4 \\approx \\frac{0.96 - \\sqrt{(-0.96)^2 - 4(0.002)(2.393649)}}{0.004} \\approx 2.506473$\n\n- **节点 5: $\\boldsymbol{\\xi}_5 = (0, 0)$**\n  $\\xi_1 = 0, \\xi_2 = 0$.\n  $B = -0.96$\n  $C = 2.2$\n  $v_5 \\approx \\frac{0.96 - \\sqrt{(-0.96)^2 - 4(0.002)(2.2)}}{0.004} \\approx 2.302714$\n\n**3. 计算期望值**\n\n$v$ 的期望值的近似值是 $v_i$ 值的加权和：\n$$ \\mathbb{E}[v] \\approx \\sum_{i=1}^{5} w_i^{\\text{prob}} v_i $$\n$$ \\mathbb{E}[v] \\approx \\frac{5}{18}(v_1 + v_2 + v_3 + v_4) - \\frac{1}{9}v_5 $$\n代入计算出的值：\n$$ \\mathbb{E}[v] \\approx \\frac{5}{18}(2.136577 + 2.538684 + 2.099129 + 2.506473) - \\frac{1}{9}(2.302714) $$\n$$ \\mathbb{E}[v] \\approx \\frac{5}{18}(9.280863) - \\frac{1}{9}(2.302714) $$\n$$ \\mathbb{E}[v] \\approx 2.577906 - 0.255857 $$\n$$ \\mathbb{E}[v] \\approx 2.322049 $$\n使用更高精度的中间计算得出：\n$$ \\mathbb{E}[v] \\approx 2.32216035 $$\n将结果四舍五入至四位有效数字，得到 $2.322$。",
            "answer": "$$\\boxed{2.322}$$"
        },
        {
            "introduction": "在解决了不确定性的前向传播问题后，我们转向更具挑战性的逆问题：如何利用实验数据来推断模型中未知的参数。本练习将引导你应用贝叶斯推断框架来校准一个线性化耦合模型中的参数。通过从基本原理出发，你将推导出参数的后验分布，这是在存在不确定性的情况下进行参数估计和模型更新的核心方法。",
            "id": "3531589",
            "problem": "考虑一个稳态设置下热场和机械位移场之间的线性化多物理场耦合，其中界面耦合强度是一个未知标量参数 $\\theta \\in \\mathbb{R}$。设状态向量为 $u \\in \\mathbb{R}^{2}$，其中第一个分量表示温度的粗略离散，第二个分量表示界面附近位移的粗略离散。给定状态和参数的高斯先验，假设它们是独立的：$u \\sim \\mathcal{N}(0, C_{u})$ 和 $\\theta \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$。观测算子将两个物理场耦合到一个数据向量 $y \\in \\mathbb{R}^{2}$ 中，作为 $u$ 和 $\\theta$ 的线性函数，并带有加性高斯噪声，而线性化的物理残差作为带有加性模型误差的“软”约束。具体来说，数据和物理模型是\n$$y = H u + \\theta\\, b + e,$$\n$$0 = A u - \\theta\\, G + w,$$\n其中 $e \\sim \\mathcal{N}(0, R)$ 是观测噪声，$w \\sim \\mathcal{N}(0, Q)$ 是模型误差，且 $e$ 和 $w$ 相互独立，并与 $(u,\\theta)$ 独立。所有分布都是高斯分布，所有算子都是线性的，因此后验分布也是高斯分布。\n\n从贝叶斯定理出发，仅使用高斯密度和线性代数恒等式的定义，推导出 $\\theta$ 的边际后验方差，作为 $(u, \\theta)$ 联合后验精度矩阵的舒尔补。然后，对于以下具体的、科学上合理的多物理场设置，\n$$C_{u} = \\begin{pmatrix} 1  0 \\\\ 0  4 \\end{pmatrix}, \\quad \\mu_{0} = 0, \\quad \\sigma_{0}^{2} = 1,$$\n$$H = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\quad R = \\begin{pmatrix} \\tfrac{1}{4}  0 \\\\ 0  \\tfrac{1}{4} \\end{pmatrix},$$\n$$A = \\begin{pmatrix} 2  -1 \\\\ 0  1 \\end{pmatrix}, \\quad G = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 1  0 \\\\ 0  \\tfrac{1}{2} \\end{pmatrix},$$\n计算 $\\theta$ 的边际后验方差的精确值。将你的最终答案表示为一个精确的有理数。不需要四舍五入。陈述你构建的任何中间矩阵，并根据高斯条件化和分块矩阵求逆的第一性原理证明每一步。\n\n注意：该任务是多物理场耦合不确定性量化（UQ）背景下耦合模拟的贝叶斯逆问题。你可以将物理残差方程视为一个具有已知误差统计的额外“数据”方程。最终答案必须是一个无量纲的实数。不要在最终答案中包含任何单位。",
            "solution": "用户要求我解决一个贝叶斯逆问题。\n\n### 步骤1：提取已知条件\n问题提供了以下信息：\n- 状态向量：$u \\in \\mathbb{R}^{2}$，表示温度和位移。\n- 未知标量参数：$\\theta \\in \\mathbb{R}$，表示界面耦合强度。\n- 先验分布（独立）：\n    - $u \\sim \\mathcal{N}(0, C_{u})$，其中 $C_{u} = \\begin{pmatrix} 1  0 \\\\ 0  4 \\end{pmatrix}$。\n    - $\\theta \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$，其中 $\\mu_{0} = 0$ 且 $\\sigma_{0}^{2} = 1$。\n- 数据模型方程：$y = H u + \\theta\\, b + e$，其中 $y \\in \\mathbb{R}^{2}$ 是数据向量。\n    - $H = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n    - $b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n    - 观测噪声：$e \\sim \\mathcal{N}(0, R)$，其中 $R = \\begin{pmatrix} \\tfrac{1}{4}  0 \\\\ 0  \\tfrac{1}{4} \\end{pmatrix}$。\n- 物理模型方程（软约束）：$0 = A u - \\theta\\, G + w$。\n    - $A = \\begin{pmatrix} 2  -1 \\\\ 0  1 \\end{pmatrix}$。\n    - $G = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n    - 模型误差：$w \\sim \\mathcal{N}(0, Q)$，其中 $Q = \\begin{pmatrix} 1  0 \\\\ 0  \\tfrac{1}{2} \\end{pmatrix}$。\n- 噪声项 $e$ 和 $w$ 相互独立，并与 $(u, \\theta)$ 独立。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是一个定义明确的贝叶斯逆问题，用于具有高斯先验和噪声的线性系统。\n- **科学依据**：该问题使用了贝叶斯推断的框架，这是科学和工程模型中不确定性量化的标准和严谨方法。具有不确定参数的线性化耦合物理问题的设置是计算科学和工程中常见且现实的场景。没有违反数学逻辑或科学原理的地方。\n- **适定性**：问题是适定的。先验信息和数据（包括物理约束）的结合对问题进行了正则化，确保存在唯一的后验分布。模型的线性性质和所有分布的高斯性质保证了后验也是高斯的，其均值和协方差是明确定义的。\n- **目标**：问题使用精确的数学语言（矩阵、向量、概率分布）陈述。所有术语都已定义，任务具体且明确。\n- **自洽与一致性**：所有必需的矩阵、参数和分布都已提供。设置中没有矛盾。所有矩阵和向量的维度对于所定义的操作都是一致的。\n- **相关性**：如说明中所述，该问题直接关系到耦合多物理场模拟中的不确定性量化（UQ）主题。\n\n### 步骤3：结论与行动\n问题是有效的和自洽的。我将继续进行完整解答。\n\n### 第1部分：理论推导\n\n目标是找到参数 $\\theta$ 的边际后验方差。我们从贝叶斯定理开始，该定理指出后验概率密度函数 (PDF) 与似然和先验 PDF 的乘积成正比：\n$$ p(u, \\theta | y) \\propto p(y | u, \\theta) p(u, \\theta) $$\n问题是在一个线性高斯框架内设置的。我们首先将状态向量 $u$ 和参数 $\\theta$ 组合成一个单一的增广状态向量 $x \\in \\mathbb{R}^{3}$：\n$$ x = \\begin{pmatrix} u \\\\ \\theta \\end{pmatrix} $$\n$u$ 和 $\\theta$ 的先验分布是独立的高斯分布：$u \\sim \\mathcal{N}(0, C_u)$ 和 $\\theta \\sim \\mathcal{N}(\\mu_0, \\sigma_0^2)$。因此，增广状态 $x$ 的先验也是一个高斯分布，$x \\sim \\mathcal{N}(\\mu_{prior}, C_{prior})$，其均值向量和协方差矩阵由下式给出：\n$$ \\mu_{prior} = \\begin{pmatrix} 0 \\\\ \\mu_0 \\end{pmatrix}, \\quad C_{prior} = \\begin{pmatrix} C_u  0 \\\\ 0  \\sigma_0^2 \\end{pmatrix} $$\n先验的 PDF 正比于 $\\exp\\left(-\\frac{1}{2}(x - \\mu_{prior})^T P_{prior} (x - \\mu_{prior})\\right)$，其中 $P_{prior} = C_{prior}^{-1}$ 是先验精度矩阵。\n\n接下来，我们将数据模型和物理约束合并成一个单一的线性系统。问题陈述建议将物理残差视为额外的数据。让我们重写给定的方程：\n$$ y = H u + \\theta b + e \\implies y - (H u + \\theta b) = e $$\n$$ 0 = A u - \\theta G + w \\implies 0 - (A u - \\theta G) = w $$\n这可以表示为一个统一的矩阵-向量形式：\n$$ \\begin{pmatrix} y \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} H  b \\\\ A  -G \\end{pmatrix} \\begin{pmatrix} u \\\\ \\theta \\end{pmatrix} + \\begin{pmatrix} e \\\\ w \\end{pmatrix} $$\n我们定义增广数据向量 $d = \\begin{pmatrix} y \\\\ 0 \\end{pmatrix}$，增广正演算子 $\\mathcal{M} = \\begin{pmatrix} H  b \\\\ A  -G \\end{pmatrix}$，以及增广噪声向量 $\\xi = \\begin{pmatrix} e \\\\ w \\end{pmatrix}$。现在系统是一个标准的线性模型：\n$$ d = \\mathcal{M} x + \\xi $$\n由于 $e$ 和 $w$ 是独立的高斯随机向量，$\\xi$ 也是一个零均值高斯向量，$\\xi \\sim \\mathcal{N}(0, C_{\\xi})$，其协方差矩阵为块对角形式：\n$$ C_{\\xi} = \\begin{pmatrix} R  0 \\\\ 0  Q \\end{pmatrix} $$\n似然函数 $p(d|x)$ 是噪声 $\\xi = d - \\mathcal{M}x$ 的 PDF，它正比于 $\\exp\\left(-\\frac{1}{2}(d - \\mathcal{M}x)^T P_{\\xi} (d - \\mathcal{M}x)\\right)$，其中 $P_{\\xi} = C_{\\xi}^{-1}$ 是噪声精度矩阵。\n\n根据贝叶斯定理，后验 PDF $p(x|d)$ 与似然和先验 PDF 的乘积成正比：\n$$ p(x|d) \\propto \\exp\\left(-\\frac{1}{2}(d - \\mathcal{M}x)^T P_{\\xi} (d - \\mathcal{M}x)\\right) \\exp\\left(-\\frac{1}{2}(x - \\mu_{prior})^T P_{prior} (x - \\mu_{prior})\\right) $$\n后验正比于 $\\exp(-\\frac{1}{2} J(x))$，其中 $J(x)$ 是二次型之和：\n$$ J(x) = (d - \\mathcal{M}x)^T P_{\\xi} (d - \\mathcal{M}x) + (x - \\mu_{prior})^T P_{prior} (x - \\mu_{prior}) $$\n展开这些项，我们得到：\n$$ J(x) = x^T (\\mathcal{M}^T P_{\\xi} \\mathcal{M} + P_{prior}) x - 2 x^T (\\mathcal{M}^T P_{\\xi} d + P_{prior} \\mu_{prior}) + \\text{const.} $$\n这是 $x$ 的一个二次型，这意味着后验分布也是高斯分布，$x|d \\sim \\mathcal{N}(\\mu_{post}, C_{post})$。通过配方法，我们确定后验精度矩阵 $P_{post} = C_{post}^{-1}$ 是乘以 $x^T(\\dots)x$ 的项：\n$$ P_{post} = \\mathcal{M}^T P_{\\xi} \\mathcal{M} + P_{prior} $$\n后验协方差 $C_{post}$ 是后验精度的逆，即 $C_{post} = P_{post}^{-1}$。请注意，后验协方差与观测数据 $d$ 无关。\n\n为了找到 $\\theta$ 的边际后验方差，我们根据 $x = (u^T, \\theta)^T$ 的分量对后验精度矩阵 $P_{post}$ 及其逆 $C_{post}$ 进行分块：\n$$ P_{post} = \\begin{pmatrix} P_{uu}  P_{u\\theta} \\\\ P_{\\theta u}  P_{\\theta\\theta} \\end{pmatrix}, \\quad C_{post} = \\begin{pmatrix} C_{uu}  C_{u\\theta} \\\\ C_{\\theta u}  C_{\\theta\\theta} \\end{pmatrix} $$\n$\\theta$ 的边际协方差是标量块 $C_{\\theta\\theta}$。使用分块矩阵的求逆公式，这个块由下式给出：\n$$ C_{\\theta\\theta} = (P_{\\theta\\theta} - P_{\\theta u} P_{uu}^{-1} P_{u\\theta})^{-1} $$\n项 $S_u = P_{\\theta\\theta} - P_{\\theta u} P_{uu}^{-1} P_{u\\theta}$ 是块 $P_{uu}$ 在精度矩阵 $P_{post}$ 中的舒尔补。因此，$\\theta$ 的边际后验方差（记为 $\\sigma_{\\theta|d}^2$）是这个舒尔补的逆。这完成了所需的推导。\n\n### 第2部分：数值计算\n\n我们现在代入给定的值来计算 $\\theta$ 的后验方差。\n\n1.  **先验精度矩阵 ($P_{prior}$)**\n    $C_u = \\begin{pmatrix} 1  0 \\\\ 0  4 \\end{pmatrix} \\implies C_u^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  1/4 \\end{pmatrix}$。\n    $\\sigma_0^2 = 1 \\implies 1/\\sigma_0^2 = 1$。\n    状态向量为 $x = (u_1, u_2, \\theta)^T$。先验精度矩阵为：\n    $$ P_{prior} = C_{prior}^{-1} = \\begin{pmatrix} C_u^{-1}  0 \\\\ 0  1/\\sigma_0^2 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{4}  0 \\\\ 0  0  1 \\end{pmatrix} $$\n\n2.  **增广算子 ($\\mathcal{M}, P_{\\xi}$)**\n    $$ \\mathcal{M} = \\begin{pmatrix} H  b \\\\ A  -G \\end{pmatrix} = \\begin{pmatrix} 1  0  1 \\\\ 0  1  2 \\\\ 2  -1  -1 \\\\ 0  1  1 \\end{pmatrix} $$\n    $R = \\begin{pmatrix} 1/4  0 \\\\ 0  1/4 \\end{pmatrix} \\implies R^{-1} = \\begin{pmatrix} 4  0 \\\\ 0  4 \\end{pmatrix}$。\n    $Q = \\begin{pmatrix} 1  0 \\\\ 0  1/2 \\end{pmatrix} \\implies Q^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}$。\n    噪声精度矩阵为：\n    $$ P_{\\xi} = C_{\\xi}^{-1} = \\begin{pmatrix} R^{-1}  0 \\\\ 0  Q^{-1} \\end{pmatrix} = \\begin{pmatrix} 4  0  0  0 \\\\ 0  4  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  2 \\end{pmatrix} $$\n\n3.  **似然精度项 ($\\mathcal{M}^T P_{\\xi} \\mathcal{M}$)**\n    我们计算来自似然的贡献，记为 $P_{like}$。\n    $$ \\mathcal{M}^T P_{\\xi} = \\begin{pmatrix} 1  0  2  0 \\\\ 0  1  -1  1 \\\\ 1  2  -1  1 \\end{pmatrix} \\begin{pmatrix} 4  0  0  0 \\\\ 0  4  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  2 \\end{pmatrix} = \\begin{pmatrix} 4  0  2  0 \\\\ 0  4  -1  2 \\\\ 4  8  -1  2 \\end{pmatrix} $$\n    $$ P_{like} = (\\mathcal{M}^T P_{\\xi}) \\mathcal{M} = \\begin{pmatrix} 4  0  2  0 \\\\ 0  4  -1  2 \\\\ 4  8  -1  2 \\end{pmatrix} \\begin{pmatrix} 1  0  1 \\\\ 0  1  2 \\\\ 2  -1  -1 \\\\ 0  1  1 \\end{pmatrix} = \\begin{pmatrix} 8  -2  2 \\\\ -2  7  11 \\\\ 2  11  23 \\end{pmatrix} $$\n\n4.  **后验精度矩阵 ($P_{post}$)**\n    $$ P_{post} = P_{like} + P_{prior} = \\begin{pmatrix} 8  -2  2 \\\\ -2  7  11 \\\\ 2  11  23 \\end{pmatrix} + \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{4}  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 9  -2  2 \\\\ -2  7+\\frac{1}{4}  11 \\\\ 2  11  24 \\end{pmatrix} $$\n    $$ P_{post} = \\begin{pmatrix} 9  -2  2 \\\\ -2  \\frac{29}{4}  11 \\\\ 2  11  24 \\end{pmatrix} $$\n\n5.  **舒尔补计算**\n    我们将 $P_{post}$ 分块为 $u$ 和 $\\theta$ 的块：\n    $$ P_{uu} = \\begin{pmatrix} 9  -2 \\\\ -2  \\frac{29}{4} \\end{pmatrix}, \\quad P_{u\\theta} = \\begin{pmatrix} 2 \\\\ 11 \\end{pmatrix}, \\quad P_{\\theta u} = \\begin{pmatrix} 2  11 \\end{pmatrix}, \\quad P_{\\theta\\theta} = 24 $$\n    首先，我们计算 $P_{uu}$ 的逆：\n    $$ \\det(P_{uu}) = 9 \\left(\\frac{29}{4}\\right) - (-2)(-2) = \\frac{261}{4} - 4 = \\frac{261 - 16}{4} = \\frac{245}{4} $$\n    $$ P_{uu}^{-1} = \\frac{1}{\\det(P_{uu})} \\begin{pmatrix} \\frac{29}{4}  2 \\\\ 2  9 \\end{pmatrix} = \\frac{4}{245} \\begin{pmatrix} \\frac{29}{4}  2 \\\\ 2  9 \\end{pmatrix} = \\frac{1}{245} \\begin{pmatrix} 29  8 \\\\ 8  36 \\end{pmatrix} $$\n    现在我们计算项 $P_{\\theta u} P_{uu}^{-1} P_{u\\theta}$：\n    $$ P_{\\theta u} P_{uu}^{-1} = \\begin{pmatrix} 2  11 \\end{pmatrix} \\frac{1}{245} \\begin{pmatrix} 29  8 \\\\ 8  36 \\end{pmatrix} = \\frac{1}{245} \\begin{pmatrix} 2(29)+11(8)  2(8)+11(36) \\end{pmatrix} $$\n    $$ = \\frac{1}{245} \\begin{pmatrix} 58+88  16+396 \\end{pmatrix} = \\frac{1}{245} \\begin{pmatrix} 146  412 \\end{pmatrix} $$\n    $$ P_{\\theta u} P_{uu}^{-1} P_{u\\theta} = \\frac{1}{245} \\begin{pmatrix} 146  412 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 11 \\end{pmatrix} = \\frac{146(2) + 412(11)}{245} = \\frac{292 + 4532}{245} = \\frac{4824}{245} $$\n    舒尔补（即 $\\theta$ 的边际精度）为：\n    $$ S_u = P_{\\theta\\theta} - P_{\\theta u} P_{uu}^{-1} P_{u\\theta} = 24 - \\frac{4824}{245} = \\frac{24 \\times 245 - 4824}{245} $$\n    $$ = \\frac{5880 - 4824}{245} = \\frac{1056}{245} $$\n\n6.  **$\\theta$ 的边际后验方差**\n    边际方差是舒尔补的逆：\n    $$ \\sigma_{\\theta|d}^2 = S_u^{-1} = \\left(\\frac{1056}{245}\\right)^{-1} = \\frac{245}{1056} $$\n    分子的质因数分解为 $245 = 5 \\times 7^2$。分母的质因数分解为 $1056 = 32 \\times 33 = 2^5 \\times 3 \\times 11$。没有公因数，所以分数是最简形式。",
            "answer": "$$\\boxed{\\frac{245}{1056}}$$"
        },
        {
            "introduction": "参数推断并不仅仅是计算它们的最佳估计值，评估这些估计的不确定性同样重要。这个练习介绍了“模型懈怠性”（model sloppiness）的概念，这是一种分析多参数模型中参数可辨识性的强大工具。你将通过分析后验精度矩阵的特征谱来量化哪些参数组合能被数据很好地约束，哪些则不能，这是验证模型和指导未来实验设计的关键一步。",
            "id": "3531587",
            "problem": "考虑一个稳态、双向耦合的热流体仿真，其中一个带强制对流的加热通道通过固体壁面内的热传导方程和流体内的动量-能量平衡方程进行建模。两个材料/耦合参数是不确定的：壁面中的热导率 $k$ 和一个无量纲的热流体耦合系数 $c$，该系数用于缩放由壁面-流体相互作用产生的流体中的体积热源。在一个标称工作点附近，该模型对参数进行线性化，并测量三个实验级输出：平均壁面热通量、体积流量和出口整体温度。这些输出在三种工况下被汇总成测量向量 $y \\in \\mathbb{R}^{3}$。线性化映射为 $y \\approx y_{0} + J\\,\\delta\\theta$，其中 $\\delta\\theta = \\begin{pmatrix} \\delta k \\\\ \\delta c \\end{pmatrix}$，灵敏度矩阵 $J \\in \\mathbb{R}^{3 \\times 2}$ 由下式给出\n$$\nJ \\;=\\; \\begin{pmatrix}\n1.6  0.3 \\\\\n0.8  0.2 \\\\\n2.4  0.7\n\\end{pmatrix}.\n$$\n测量噪声被建模为零均值高斯分布，其协方差矩阵为 $\\Sigma \\in \\mathbb{R}^{3 \\times 3}$，\n$$\n\\Sigma \\;=\\; \\begin{pmatrix}\n0.09  0.03  0.00 \\\\\n0.03  0.16  0.04 \\\\\n0.00  0.04  0.25\n\\end{pmatrix},\n$$\n这反映了由于共享仪器和耦合物理过程而产生的跨实验相关性。参数的先验分布是高斯分布，$\\delta\\theta$ 的均值为零，协方差矩阵为对角阵\n$$\nC_{0} \\;=\\; \\begin{pmatrix}\n0.5^{2}  0 \\\\\n0  1.0^{2}\n\\end{pmatrix}.\n$$\n仅使用高斯推断和不确定性量化中灵敏度分析的基本定义，在线性-高斯假设下构建 $\\delta\\theta$ 的后验精度矩阵，并通过后验精度矩阵的最小特征值与最大特征值之比来量化参数的“松散度”（sloppiness）。将最终答案表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题要求在线性-高斯设置下，对耦合参数估计进行可识别性和“松散度”（sloppiness）评估。其基础是线性化的前向映射和高斯统计。对于一个线性模型 $y \\approx y_{0} + J\\,\\delta\\theta$，其中高斯噪声 $\\varepsilon \\sim \\mathcal{N}(0,\\Sigma)$，高斯先验 $\\delta\\theta \\sim \\mathcal{N}(0,C_{0})$，$\\delta\\theta$ 的对数后验分布（不计加法常数）为：\n$$\n\\mathcal{L}(\\delta\\theta) \\;=\\; -\\frac{1}{2}(y - y_{0} - J\\,\\delta\\theta)^{\\top}\\Sigma^{-1}(y - y_{0} - J\\,\\delta\\theta) - \\frac{1}{2}\\,\\delta\\theta^{\\top}C_{0}^{-1}\\delta\\theta.\n$$\n$\\delta\\theta$ 的二次型定义了后验精度（也称为信息）矩阵\n$$\nH \\;=\\; J^{\\top}\\Sigma^{-1}J \\;+\\; C_{0}^{-1}.\n$$\n所要求的“松散度”度量是比率 $s = \\lambda_{\\min}(H)/\\lambda_{\\max}(H)$，其中 $\\lambda_{\\min}(H)$ 和 $\\lambda_{\\max}(H)$ 分别是 $H$ 的最小和最大特征值。我们接下来计算 $H$ 及其特征值。\n\n步骤1：计算 $\\Sigma^{-1}$。对于\n$$\n\\Sigma \\;=\\; \\begin{pmatrix}\n0.09  0.03  0.00 \\\\\n0.03  0.16  0.04 \\\\\n0.00  0.04  0.25\n\\end{pmatrix},\n$$\n其行列式为\n$$\n\\det(\\Sigma) \\;=\\; 0.09\\,(0.16\\cdot 0.25 - 0.04^{2}) - 0.03\\,(0.03\\cdot 0.25 - 0\\cdot 0.04) \\;=\\; 0.003231.\n$$\n代数余子式矩阵是\n$$\n\\operatorname{cof}(\\Sigma) \\;=\\; \\begin{pmatrix}\n0.0384  -0.0075  0.0012 \\\\\n-0.0075  0.0225  -0.0036 \\\\\n0.0012  -0.0036  0.0135\n\\end{pmatrix},\n$$\n所以伴随矩阵等于代数余子式矩阵的转置（此处为对称阵），且\n$$\n\\Sigma^{-1} \\;=\\; \\frac{1}{\\det(\\Sigma)}\\,\\operatorname{adj}(\\Sigma) \\;=\\; \\frac{1}{0.003231}\\,\\begin{pmatrix}\n0.0384  -0.0075  0.0012 \\\\\n-0.0075  0.0225  -0.0036 \\\\\n0.0012  -0.0036  0.0135\n\\end{pmatrix}.\n$$\n数值上，\n$$\n\\Sigma^{-1} \\;\\approx\\; \\begin{pmatrix}\n11.8848  -2.32125  0.37140 \\\\\n-2.32125  6.96375  -1.11420 \\\\\n0.37140  -1.11420  4.17825\n\\end{pmatrix}.\n$$\n\n步骤2：计算数据信息矩阵 $J^{\\top}\\Sigma^{-1}J$。已知\n$$\nJ \\;=\\; \\begin{pmatrix}\n1.6  0.3 \\\\\n0.8  0.2 \\\\\n2.4  0.7\n\\end{pmatrix},\n$$\n我们首先计算 $\\Sigma^{-1}J$：\n$$\n\\Sigma^{-1}J \\;\\approx\\; \\begin{pmatrix}\n18.05004  3.36117 \\\\\n-0.81708  -0.083565 \\\\\n9.73068  2.813355\n\\end{pmatrix}.\n$$\n然后\n$$\nJ^{\\top}(\\Sigma^{-1}J) \\;\\approx\\; \\begin{pmatrix}\n51.580032  12.063072 \\\\\n12.063072  2.960987\n\\end{pmatrix}.\n$$\n\n步骤3：加上先验精度。先验协方差为\n$$\nC_{0} \\;=\\; \\begin{pmatrix}\n0.5^{2}  0 \\\\\n0  1.0^{2}\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n0.25  0 \\\\\n0  1.0\n\\end{pmatrix},\n$$\n所以\n$$\nC_{0}^{-1} \\;=\\; \\begin{pmatrix}\n4  0 \\\\\n0  1\n\\end{pmatrix}.\n$$\n因此后验精度为\n$$\nH \\;=\\; J^{\\top}\\Sigma^{-1}J + C_{0}^{-1} \\;\\approx\\; \\begin{pmatrix}\n51.580032  12.063072 \\\\\n12.063072  2.960987\n\\end{pmatrix} \\;+\\; \\begin{pmatrix}\n4  0 \\\\\n0  1\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n55.580032  12.063072 \\\\\n12.063072  3.960987\n\\end{pmatrix}.\n$$\n\n步骤4：计算 $H$ 的特征值。对于一个对称的 $2\\times 2$ 矩阵 $H = \\begin{pmatrix} a  b \\\\ b  d \\end{pmatrix}$，其特征值为\n$$\n\\lambda_{\\pm} \\;=\\; \\frac{(a+d) \\pm \\sqrt{(a+d)^{2} - 4(ad - b^{2})}}{2}.\n$$\n这里，\n$$\na = 55.580032,\\quad b = 12.063072,\\quad d = 3.960987,\n$$\n所以\n$$\nT \\equiv a+d = 59.541019,\\quad D \\equiv ad - b^{2} \\approx 74.6340781264.\n$$\n然后\n$$\n\\Delta \\equiv T^{2} - 4D \\;\\approx\\; 3246.5876310524,\\quad \\sqrt{\\Delta} \\;\\approx\\; 56.978835,\n$$\n且\n$$\n\\lambda_{\\max} \\;\\approx\\; \\frac{59.541019 + 56.978835}{2} \\;=\\; 58.259927,\\qquad\n\\lambda_{\\min} \\;\\approx\\; \\frac{59.541019 - 56.978835}{2} \\;=\\; 1.281092.\n$$\n\n步骤5：计算“松散度”比率。根据定义，\n$$\ns \\;=\\; \\frac{\\lambda_{\\min}(H)}{\\lambda_{\\max}(H)} \\;\\approx\\; \\frac{1.281092}{58.259927} \\;\\approx\\; 0.021989.\n$$\n四舍五入到四位有效数字，所要求的无量纲“松散度”指数为 $0.02199$。\n\n从概念上讲，一个小的 $s$ 值表明，与最小特征值对应的特征向量对齐的参数组合相对于与最大特征值对应的特征向量对齐的“刚性”、可识别方向是“松散的”（即约束性差）。$J$ 中的耦合以及 $\\Sigma$ 中的相关噪声在 $H$ 中产生了非对角结构，这些结构控制了这些可识别性方向，而先验精度则对极端情况进行了正则化。",
            "answer": "$$\\boxed{0.02199}$$"
        }
    ]
}