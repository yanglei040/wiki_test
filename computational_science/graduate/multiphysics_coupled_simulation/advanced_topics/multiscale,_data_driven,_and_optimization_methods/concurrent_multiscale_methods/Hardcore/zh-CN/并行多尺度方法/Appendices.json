{
    "hands_on_practices": [
        {
            "introduction": "这项练习是理解并发多尺度方法的基础。它将引导您从第一性原理出发，为一个简单的复合材料推导其等效力学性能。然后，通过将粗粒度的FE²模拟结果与高保真度的直接数值模拟（DNS）进行比较，您将能够定量地评估均匀化理论的准确性及其内含的假设 。",
            "id": "3498314",
            "problem": "考虑一根一维小应变线性弹性杆，其刚度在空间上非均匀分布，承受分布体力作用并受端部位移约束。设空间坐标为 $x \\in [0,L]$，横截面积为 $A$，位移场为 $u(x)$，应变为 $\\varepsilon(x)$，柯西应力为 $\\sigma(x)$。假设准静态平衡，无惯性，无阻尼。其控制关系为：线性动量守恒 $\\dfrac{\\mathrm{d}}{\\mathrm{d}x} \\left( A \\sigma(x) \\right) + b = 0$，几何关系 $\\varepsilon(x) = \\dfrac{\\mathrm{d}u}{\\mathrm{d}x}$，以及胡克型本构律 $\\sigma(x) = E(x) \\varepsilon(x)$，其中 $E(x)$ 是空间变化的杨氏模量。设边界条件为 $u(0) = 0$ 和 $u(L) = U$，其中 $U$ 是一个给定的端部位移。设体力密度 $b$ 沿 $x$ 恒定。\n\n您将设计一个验证基准，用以比较并发多尺度有限元平方 (FE$^{2}$) 方法和一个在完全解析的非均匀域上的直接数值模拟 (DNS) 的结果。在 FE$^{2}$ 方法中，宏观问题在一个粗网格上求解，其等效本构响应通过一个相关的微观非均匀介质的代表性体积单元 (RVE) 获得。对于此基准，考虑沿 $x$ 方向的周期性两相微观结构，其周期为 $p$，相应相的模量为 $E_{1}$ 和 $E_{2}$，相分数为 $f \\in (0,1)$，使得在每个周期内，长度为 $fp$ 的区间模量为 $E_{1}$，长度为 $(1-f)p$ 的区间模量为 $E_{2}$。该微观非均匀性在 $[0,L]$ 上重复。\n\n任务：\n1. 仅从动量守恒律、几何关系和本构律出发，形式化适用于具有尺度分离的一维周期性非均匀杆的均匀化概念。在所述条件下，推导该杆的均匀化宏观本构关系及等效模量 $E_{\\mathrm{eff}}$。请勿使用任何预先给定的均匀化公式；利用周期性微观结构和在微观层面保证与宏观场能量一致的适当边界条件，从第一性原理推导 $E_{\\mathrm{eff}}$ 的形式。\n2. 通过将杆离散为 $N$ 个长度为 $h = L/N$ 的均匀有限元来实现 DNS，其中 $E(x)$ 根据周期性微观结构被完全解析为每个单元上的分段常数函数。使用线性有限元和通过弱形式得到的恒定体力密度 $b$ 来组装全局刚度矩阵。施加狄利克雷边界条件 $u(0) = 0$ 和 $u(L) = U$，求解节点位移，并计算单元应变 $\\varepsilon_{e}$、单元应力 $\\sigma_{e}$ 和总应变能 $W_{\\mathrm{DNS}} = \\sum_{e} \\tfrac{1}{2} E_{e} A \\varepsilon_{e}^{2} h$。\n3. 通过将同一杆离散为 $M$ 个均匀有限元来实现 FE$^{2}$ 宏观问题，用任务1中推导的均匀化等效模量 $E_{\\mathrm{eff}}$ 替代 $E(x)$。在相同的体力密度 $b$ 和边界条件下，组装并求解宏观有限元系统，以获得宏观节点位移 $u_{\\mathrm{FE^{2}}}(x)$、单元应变、应力 $\\sigma_{\\mathrm{FE^{2}}}(x)$ 和总应变能 $W_{\\mathrm{FE^{2}}}$。\n4. 定义定量误差度量以比较 FE$^{2}$ 和 DNS：\n   - 应力误差：相对 $L^{2}$ 范数 $e_{\\sigma} = \\dfrac{\\left\\| \\sigma_{\\mathrm{FE^{2}}} - \\sigma_{\\mathrm{DNS}} \\right\\|_{L^{2}(0,L)}}{\\left\\| \\sigma_{\\mathrm{DNS}} \\right\\|_{L^{2}(0,L)}}$，通过在 DNS 单元中心采样 $\\sigma_{\\mathrm{FE^{2}}}(x)$ 并使用单元宽度为 $h$ 的复合矩形法则计算。\n   - 位移误差：相对 $L^{2}$ 范数 $e_{u} = \\dfrac{\\left\\| u_{\\mathrm{FE^{2}}} - u_{\\mathrm{DNS}} \\right\\|_{L^{2}(0,L)}}{\\left\\| u_{\\mathrm{DNS}} \\right\\|_{L^{2}(0,L)}}$，通过在 DNS 节点上对两种位移进行采样并使用复合梯形法则进行积分计算。\n   - 能量误差：相对差异 $e_{W} = \\dfrac{\\left| W_{\\mathrm{FE^{2}}} - W_{\\mathrm{DNS}} \\right|}{W_{\\mathrm{DNS}}}$。\n所有应力必须以帕斯卡（pascals）计算，位移以米（meters）计算，能量以焦耳（joules）计算。误差度量必须以小数形式表示。\n\n您的程序必须实现上述内容，并为以下测试套件中的每个参数集生成误差度量。请一致使用以下单位：$L$ 单位为米， $A$ 单位为平方米， $U$ 单位为米， $b$ 单位为牛顿/米， $E_{1}$ 和 $E_{2}$ 单位为帕斯卡， $p$ 单位为米。\n\n测试套件：\n- 情况 1 (正常路径): $L = 1.0$, $A = 1.0$, $U = 1.0 \\times 10^{-3}$, $b = 1000.0$, $E_{1} = 100.0 \\times 10^{9}$, $E_{2} = 50.0 \\times 10^{9}$, $f = 0.5$, $p = 0.02$, $M = 10$, $N = 500$。\n- 情况 2 (近均匀边界情况): $L = 1.0$, $A = 1.0$, $U = 1.0 \\times 10^{-3}$, $b = 1000.0$, $E_{1} = 80.0 \\times 10^{9}$, $E_{2} = 80.0 \\times 10^{9}$, $f = 0.5$, $p = 0.02$, $M = 10$, $N = 500$。\n- 情况 3 (强对比度): $L = 1.0$, $A = 1.0$, $U = 2.0 \\times 10^{-3}$, $b = 5000.0$, $E_{1} = 200.0 \\times 10^{9}$, $E_{2} = 10.0 \\times 10^{9}$, $f = 0.7$, $p = 0.05$, $M = 8$, $N = 800$。\n- 情况 4 (尺度分离不良): $L = 1.0$, $A = 1.0$, $U = 1.0 \\times 10^{-3}$, $b = 2000.0$, $E_{1} = 120.0 \\times 10^{9}$, $E_{2} = 30.0 \\times 10^{9}$, $f = 0.4$, $p = 0.25$, $M = 4$, $N = 400$。\n\n您的程序应生成一行输出，其中包含一个以逗号分隔的列表，该列表被方括号括起，其中每个条目是针对一个测试用例的三元素列表 $[e_{\\sigma}, e_{u}, e_{W}]$，其顺序与测试套件相同（例如， $[[e_{\\sigma 1}, e_{u 1}, e_{W 1}],[e_{\\sigma 2}, e_{u 2}, e_{W 2}],\\dots]$）。",
            "solution": "该问题提出了一个系统性的验证基准，用于将一维（1D）多尺度有限元平方（FE²）模型与高保真度的直接数值模拟（DNS）进行比较。物理系统是一根具有周期性非均匀微观结构的线性弹性杆，承受恒定的体力作用和给定的端部位移。该问题具有科学依据，是适定的，并为唯一的数值解提供了所有必要的信息。因此，它被认为是一个有效的问题。解决方案首先从第一性原理推导等效材料属性，然后为DNS和FE²建立数值模型，最后定义并计算用于比较的误差度量。\n\n### 任务1：均匀化等效模量（$E_{\\mathrm{eff}}$）的推导\n\n均匀化理论允许用一个等效的均匀材料替换复杂的非均匀材料，前提是宏观结构和微观非均匀性之间存在明确的尺度分离。这种等效介质的等效属性是通过分析一个代表性体积单元（RVE）的响应来推导的。对于给定的一维周期性微观结构，RVE是一个长度为 $p$ 的单周期。\n\n宏观应力 $\\Sigma$ 和宏观应变 $\\mathcal{E}$ 定义为它们的微观对应物 $\\sigma(y)$ 和 $\\varepsilon(y)$ 在RVE上的体积平均值，其中 $y \\in [0,p]$ 是微观坐标：\n$$ \\Sigma = \\langle \\sigma \\rangle = \\frac{1}{p} \\int_0^p \\sigma(y) \\, dy $$\n$$ \\mathcal{E} = \\langle \\varepsilon \\rangle = \\frac{1}{p} \\int_0^p \\varepsilon(y) \\, dy $$\n\n在微观尺度上，我们假设体力项与平衡弹性力的应力梯度相比可以忽略不计。RVE内的线性动量守恒简化为：\n$$ \\frac{d\\sigma(y)}{dy} = 0 $$\n这意味着微观应力 $\\sigma(y)$ 在整个RVE中必须是恒定的。这就是**等应力条件**。设这个恒定应力为 $\\sigma_0$。因此，$\\sigma(y) = \\sigma_0$。\n\n微观应变 $\\varepsilon(y)$ 通过空间变化的杨氏模量 $E(y)$ 与应力相关联：$\\varepsilon(y) = \\sigma(y)/E(y) = \\sigma_0/E(y)$。该材料由两相组成：\n$$\n\\varepsilon(y) =\n\\begin{cases}\n    \\sigma_0/E_1  \\text{for } y \\in [0, fp) \\\\\n    \\sigma_0/E_2  \\text{for } y \\in [fp, p)\n\\end{cases}\n$$\n\n宏观应变 $\\mathcal{E}$ 是微观应变在RVE上的平均值：\n$$ \\mathcal{E} = \\frac{1}{p} \\int_0^p \\varepsilon(y) \\, dy = \\frac{1}{p} \\left[ \\int_0^{fp} \\frac{\\sigma_0}{E_1} \\, dy + \\int_{fp}^{p} \\frac{\\sigma_0}{E_2} \\, dy \\right] $$\n$$ \\mathcal{E} = \\frac{\\sigma_0}{p} \\left( \\frac{fp}{E_1} + \\frac{(p-fp)}{E_2} \\right) = \\sigma_0 \\left( \\frac{f}{E_1} + \\frac{1-f}{E_2} \\right) $$\n\n由于微观应力是恒定的，宏观应力 $\\Sigma = \\langle \\sigma \\rangle = \\sigma_0$。用 $\\Sigma$ 替换 $\\sigma_0$ 得到宏观应变-应力关系：\n$$ \\mathcal{E} = \\Sigma \\left( \\frac{f}{E_1} + \\frac{1-f}{E_2} \\right) $$\n\n等效本构律为 $\\Sigma = E_{\\mathrm{eff}} \\mathcal{E}$。通过重新排列上述方程，我们找到了等效模量的倒数：\n$$ \\frac{1}{E_{\\mathrm{eff}}} = \\frac{\\mathcal{E}}{\\Sigma} = \\frac{f}{E_1} + \\frac{1-f}{E_2} $$\n因此，等效模量是各相模量的调和平均值，并由它们各自的体积分数加权：\n$$ E_{\\mathrm{eff}} = \\left( \\frac{f}{E_1} + \\frac{1-f}{E_2} \\right)^{-1} $$\n这个结果是材料沿加载方向串联分层的典型特征。\n\n### 任务2和3：有限元离散化\n\n将几何关系和本构关系代入动量守恒方程，得到边值问题的控制强形式：\n$$ \\frac{d}{dx} \\left( A E(x) \\frac{du}{dx} \\right) + b = 0 \\quad \\text{for } x \\in (0,L) $$\n边界条件为 $u(0)=0$ 和 $u(L)=U$。\n\n弱形式通过乘以一个测试函数 $v(x)$ (其中 $v(0)=v(L)=0$) 并在域上积分来推导。分部积分后，我们寻找一个满足边界条件且对所有有效测试函数 $v(x)$ 都满足以下方程的位移场 $u(x)$：\n$$ \\int_0^L A E(x) \\frac{du}{dx} \\frac{dv}{dx} \\, dx = \\int_0^L v(x) b \\, dx $$\n\n该方程使用有限元方法（FEM）进行离散化。将域划分为单元，在每个单元内，使用线性形函数来近似位移场。对于一个长度为 $h_e$ 且具有恒定属性 $A_e$ 和 $E_e$ 的一维线性单元 $e$，其单元刚度矩阵 $K_e$ 和单元体力向量 $F_e$ 为：\n$$ K_e = \\frac{A_e E_e}{h_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad F_e = \\frac{b h_e}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n\n这些单元级矩阵和向量被组装成一个全局线性方程组 $\\mathbf{K}\\mathbf{u} = \\mathbf{F}$。施加狄利克雷边界条件 $u(0)=0$ 和 $u(L)=U$ 后，求解该系统以获得未知节点位移向量 $\\mathbf{u}$。\n\n**DNS 实现 (任务 2):**\n将域 $[0,L]$ 离散为 $N$ 个精细单元。对于每个单元 $e$，模量 $E_e$ 被赋予与单元中心处的材料相对应的微观值（$E_1$ 或 $E_2$）。这创建了一个解析了材料非均匀性的高保真模型。\n\n**FE² 宏观实现 (任务 3):**\n将域 $[0,L]$ 离散为 $M$ 个粗单元（$M \\ll N$）。对于所有单元，模量被设置为在任务1中推导的恒定等效模量 $E_{\\mathrm{eff}}$。该模型代表了杆的均匀化宏观行为。\n\n### 任务4：误差度量公式\n\n为了量化FE²近似的准确性，将其解与高保真度的DNS解进行比较。\n\n**应力误差 ($e_{\\sigma}$):** FE² 应力场 $\\sigma_{\\mathrm{FE²}}$ 在粗网格上是分段常数，而DNS应力 $\\sigma_{\\mathrm{DNS}}$ 在细网格上是分段常数。为了比较它们，FE²应力在每个DNS单元的中心被采样。然后使用复合矩形法则计算相对 $L^2$ 误差：\n$$ e_{\\sigma} = \\frac{\\left\\| \\sigma_{\\mathrm{FE^{2}}} - \\sigma_{\\mathrm{DNS}} \\right\\|_{L^{2}}}{\\left\\| \\sigma_{\\mathrm{DNS}} \\right\\|_{L^{2}}} \\approx \\sqrt{ \\frac{\\sum_{i=1}^N (\\sigma_{\\mathrm{FE²}}(x_{c,i}) - \\sigma_{\\mathrm{DNS},i})^2 h}{\\sum_{i=1}^N (\\sigma_{\\mathrm{DNS},i})^2 h} } = \\sqrt{ \\frac{\\sum_{i=1}^N (\\sigma_{\\mathrm{FE²}}(x_{c,i}) - \\sigma_{\\mathrm{DNS},i})^2}{\\sum_{i=1}^N (\\sigma_{\\mathrm{DNS},i})^2} } $$\n其中 $\\sigma_{\\mathrm{DNS},i}$ 是DNS单元 $i$ 中的应力， $x_{c,i}$ 是其中心。\n\n**位移误差 ($e_{u}$):** FE² 节点位移定义在粗网格上。通过线性插值可以获得一个连续的、分段线性的位移场 $u_{\\mathrm{FE²}}(x)$。然后在DNS节点处对该场进行采样。使用复合梯形法则计算相对 $L^2$ 误差：\n$$ e_{u} = \\frac{\\left\\| u_{\\mathrm{FE^{2}}} - u_{\\mathrm{DNS}} \\right\\|_{L^{2}}}{\\left\\| u_{\\mathrm{DNS}} \\right\\|_{L^{2}}} = \\sqrt{ \\frac{\\int_0^L (u_{\\mathrm{FE²}}(x) - u_{\\mathrm{DNS}}(x))^2 dx}{\\int_0^L (u_{\\mathrm{DNS}}(x))^2 dx} } $$\n其中积分使用细DNS网格上的节点值进行数值计算。\n\n**能量误差 ($e_{W}$):** 每个模型的总应变能 $W_{\\mathrm{DNS}}$ 和 $W_{\\mathrm{FE²}}$ 通过对其各自单元中的能量求和来计算： $W = \\sum_{e} \\frac{1}{2} \\int_e A E_e \\varepsilon_e^2 dx = \\sum_e \\frac{1}{2} A_e E_e \\varepsilon_e^2 h_e$。相对误差是用DNS能量归一化的绝对差：\n$$ e_{W} = \\frac{\\left| W_{\\mathrm{FE^{2}}} - W_{\\mathrm{DNS}} \\right|}{W_{\\mathrm{DNS}}} $$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import trapezoid\n\ndef solve_fem(L, A, E_vals, n_elem, b, U_bc):\n    \"\"\"\n    Solves a 1D bar problem using the linear Finite Element Method.\n\n    Args:\n        L (float): Length of the bar.\n        A (float): Cross-sectional area.\n        E_vals (np.array): Array of Young's moduli for each element.\n        n_elem (int): Number of elements.\n        b (float): Constant body force density.\n        U_bc (float): Prescribed displacement at x=L.\n\n    Returns:\n        tuple: A tuple containing:\n            - u (np.array): Nodal displacements of size (n_elem + 1).\n            - sigma (np.array): Element-wise constant stresses of size (n_elem).\n            - W (float): Total strain energy.\n    \"\"\"\n    n_nodes = n_elem + 1\n    h = L / n_elem\n\n    K = np.zeros((n_nodes, n_nodes))\n    F = np.zeros(n_nodes)\n\n    for e in range(n_elem):\n        E_e = E_vals[e]\n        k_e = (A * E_e / h) * np.array([[1, -1], [-1, 1]])\n        f_e = (b * h / 2) * np.array([1, 1])\n        \n        nodes = np.array([e, e + 1])\n        K[np.ix_(nodes, nodes)] += k_e\n        F[nodes] += f_e\n\n    prescribed_dofs = [0, n_nodes - 1]\n    all_dofs = list(range(n_nodes))\n    free_dofs = [dof for dof in all_dofs if dof not in prescribed_dofs]\n    \n    u_bc_vals = np.array([0.0, U_bc])\n    \n    # K_fp @ U_p term\n    F_mod = K[np.ix_(free_dofs, prescribed_dofs)] @ u_bc_vals\n    F_reduced = F[free_dofs] - F_mod\n    K_reduced = K[np.ix_(free_dofs, free_dofs)]\n    \n    u_free = np.linalg.solve(K_reduced, F_reduced)\n    \n    u = np.zeros(n_nodes)\n    u[free_dofs] = u_free\n    u[prescribed_dofs] = u_bc_vals\n    \n    epsilon = (u[1:] - u[:-1]) / h\n    sigma = E_vals * epsilon\n    W = 0.5 * np.sum(A * E_vals * epsilon**2 * h)\n    \n    return u, sigma, W\n\ndef run_benchmark(params):\n    \"\"\"\n    Runs the DNS vs FE^2 benchmark for a given set of parameters.\n    \"\"\"\n    L, A, U, b, E1, E2, f, p, M, N = params\n    \n    # Task 1: Calculate effective modulus\n    if E1 == 0 or E2 == 0:\n        E_eff = 0\n    else:\n        E_eff = 1.0 / (f / E1 + (1 - f) / E2)\n    \n    # Task 2: Direct Numerical Simulation (DNS)\n    h_dns = L / N\n    E_dns = np.zeros(N)\n    for i in range(N):\n        x_center = (i + 0.5) * h_dns\n        if (x_center % p)  f * p:\n            E_dns[i] = E1\n        else:\n            E_dns[i] = E2\n            \n    u_dns, sigma_dns, W_dns = solve_fem(L, A, E_dns, N, b, U)\n\n    # Task 3: FE^2 Macroscopic Simulation\n    E_fe2 = np.full(M, E_eff)\n    u_fe2, sigma_fe2, W_fe2 = solve_fem(L, A, E_fe2, M, b, U)\n\n    # Task 4: Compute Error Metrics\n    h_fe2 = L / M\n\n    # Stress error e_sigma\n    sigma_fe2_sampled = np.zeros(N)\n    for i in range(N):\n        x_center = (i + 0.5) * h_dns\n        macro_elem_idx = min(int(x_center / h_fe2), M - 1)\n        sigma_fe2_sampled[i] = sigma_fe2[macro_elem_idx]\n    \n    num_sigma = np.sum((sigma_fe2_sampled - sigma_dns)**2)\n    den_sigma = np.sum(sigma_dns**2)\n    e_sigma = np.sqrt(num_sigma / den_sigma) if den_sigma  1e-15 else 0.0\n\n    # Displacement error e_u\n    x_dns = np.linspace(0, L, N + 1)\n    x_fe2 = np.linspace(0, L, M + 1)\n    u_fe2_interp = np.interp(x_dns, x_fe2, u_fe2)\n    \n    num_u = trapezoid((u_fe2_interp - u_dns)**2, x_dns)\n    den_u = trapezoid(u_dns**2, x_dns)\n    e_u = np.sqrt(num_u / den_u) if den_u  1e-15 else 0.0\n    \n    # Energy error e_W\n    e_W = np.abs(W_fe2 - W_dns) / W_dns if W_dns  1e-15 else 0.0\n\n    return [e_sigma, e_u, e_W]\n\ndef solve():\n    \"\"\"Main function to run the test suite and print results.\"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path)\n        (1.0, 1.0, 1.0e-3, 1000.0, 100.0e9, 50.0e9, 0.5, 0.02, 10, 500),\n        # Case 2 (near-homogeneous boundary case)\n        (1.0, 1.0, 1.0e-3, 1000.0, 80.0e9, 80.0e9, 0.5, 0.02, 10, 500),\n        # Case 3 (strong contrast)\n        (1.0, 1.0, 2.0e-3, 5000.0, 200.0e9, 10.0e9, 0.7, 0.05, 8, 800),\n        # Case 4 (poor scale separation)\n        (1.0, 1.0, 1.0e-3, 2000.0, 120.0e9, 30.0e9, 0.4, 0.25, 4, 400),\n    ]\n\n    results = []\n    for params in test_cases:\n        errors = run_benchmark(params)\n        results.append(errors)\n\n    # Format output as a list of lists of decimals.\n    result_str = \",\".join([f\"[{','.join(map(str, err))}]\" for err in results])\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实世界的材料往往表现出非线性行为。这项实践将多尺度概念扩展到了弹塑性，这是一种常见的非线性力学行为。这里的关键挑战是从微观尺度响应中推导出宏观的*一致性切线模量*，这对于宏观模拟的数值收敛性至关重要。本练习将展示微观尺度的算法（如返回映射算法）如何直接影响宏观计算的性能 。",
            "id": "3498329",
            "problem": "考虑一个通过平方有限元 (FE$^2$) 求解的双尺度小应变弹塑性问题，其中宏观尺度问题使用通过在每个宏观尺度积分点求解微观尺度代表性体积元 (RVE) 边值问题获得的均质化本构响应。假设设置如下。\n\n- 宏观尺度运动学为一维单轴小应变，宏观应变表示为 $\\varepsilon^{M}$，宏观应力表示为 $\\sigma^{M}$。\n- 微观尺度 RVE 是均匀的、一维的，并遵循适用于一维情况的相关联 $J_{2}$ 型塑性（因此符号效应由屈服函数中的绝对值捕捉）。微观本构方程为：\n  - 运动学：$\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$，其中 $\\varepsilon$、$\\varepsilon^{e}$ 和 $\\varepsilon^{p}$ 分别表示总应变、弹性应变和塑性应变。\n  - 弹性定律：$\\sigma = E\\,\\varepsilon^{e}$，其中 $E$ 是微观弹性模量。\n  - 屈服函数：$f(\\sigma,\\alpha) = |\\sigma| - \\sigma_{y} - H\\,\\alpha$，其中 $\\sigma_{y}$ 是初始屈服应力，$H$ 是与线性各向同性硬化相关的（标量）算法塑性模量，$\\alpha$ 是等效塑性应变。\n  - 流动法则和硬化：$\\dot{\\varepsilon}^{p} = \\dot{\\lambda}\\,\\mathrm{sign}(\\sigma)$ 和 $\\dot{\\alpha} = \\dot{\\lambda}$，其中 $\\dot{\\lambda} \\ge 0$，$f \\le 0$ 和 $\\dot{\\lambda}\\,f = 0$。\n- 在每个宏观尺度增量步，微观尺度问题通过后向欧拉返回映射算法在运动学均匀边界条件下求解（因此施加的边界位移场强制产生一个等于宏观应变的均匀微观应变：$\\varepsilon = \\varepsilon^{M}$）。当前状态处于塑性加载中，且 $\\sigma  0$（因此 $\\mathrm{sign}(\\sigma) = +1$）。\n\n从这些基本原理出发，执行以下操作：\n1. 使用应用于微观尺度的后向欧拉返回映射格式和通过应力体积平均的均质化方法，推导当前积分点宏观一致性切线模量 $E_{\\mathrm{M,alg}} = \\dfrac{\\partial \\sigma^{M}}{\\partial \\varepsilon^{M}}$ 关于微观弹性模量 $E$ 和微观算法塑性模量 $H$ 的标量表达式。\n2. 使用您推导的表达式，计算当 $E = 210~\\mathrm{GPa}$ 和 $H = 1.5~\\mathrm{GPa}$ 时的 $E_{\\mathrm{M,alg}}$。将最终数值四舍五入至四位有效数字。以 $\\mathrm{GPa}$ 为单位表示最终答案。\n3. 仅根据您的推导，解释算法塑性模量 $H$ 如何影响 FE$^2$ 中宏观牛顿迭代的收敛行为，并确定当 $H \\to 0$ 和 $H \\to \\infty$ 时的极限行为。\n\n您最终报告的答案必须是第 2 项中指定的单个实数。最终答案中不要包含任何中间量。",
            "solution": "该问题是有效的，因为它在科学上基于计算塑性力学和多尺度力学的原理，问题提法良好，信息充分，可得到唯一解，并且以客观、正式的语言表述。我们可以开始求解。\n\n问题要求三项内容：推导宏观一致性切线模量 $E_{\\mathrm{M,alg}}$，对其进行数值计算，并解释硬化模量 $H$ 对宏观求解器收敛性的影响。\n\n**1. 宏观一致性切线模量 $E_{\\mathrm{M,alg}}$ 的推导**\n\n宏观一致性切线模量定义为 $E_{\\mathrm{M,alg}} = \\frac{\\partial \\sigma^{M}}{\\partial \\varepsilon^{M}}$。在 FE² 框架中，对于均匀代表性体积元 (RVE) 上的运动学均匀边界条件 (KUBC)，宏观尺度上的体积平均量与微观尺度上的均匀场直接相关。具体而言，宏观应变 $\\varepsilon^{M}$ 等于微观应变 $\\varepsilon$，宏观应力 $\\sigma^{M}$ 等于微观应力 $\\sigma$。因此，我们需要推导微观一致性切线模量 $E_{\\mathrm{alg}} = \\frac{\\partial \\sigma}{\\partial \\varepsilon}$。\n\n推导从一个通用时间步 $n+1$ 处的后向欧拉返回映射算法的时间离散方程开始。对于给定的总应变增量，状态变量从它们在步骤 $n$ 的已知值更新到在步骤 $n+1$ 的未知值。\n在步骤 $n+1$ 的控制方程为：\n1.  加性应变分解：$\\varepsilon_{n+1} = \\varepsilon_{n+1}^e + \\varepsilon_{n+1}^p$。\n2.  弹性定律：$\\sigma_{n+1} = E\\,\\varepsilon_{n+1}^e$。\n3.  流动法则（后向欧拉）：$\\varepsilon_{n+1}^p = \\varepsilon_n^p + \\Delta\\lambda\\,\\mathrm{sign}(\\sigma_{n+1})$。\n4.  硬化定律（后向欧拉）：$\\alpha_{n+1} = \\alpha_n + \\Delta\\lambda$。\n5.  塑性加载下的屈服条件：$f(\\sigma_{n+1}, \\alpha_{n+1}) = 0$。\n\n问题指明当前状态处于塑性加载中，且 $\\sigma  0$。这意味着 $\\mathrm{sign}(\\sigma_{n+1}) = +1$，屈服条件变为 $|\\sigma_{n+1}| - \\sigma_y - H\\alpha_{n+1} = \\sigma_{n+1} - \\sigma_y - H\\alpha_{n+1} = 0$。\n\n结合这些方程，我们可以用总应变 $\\varepsilon_{n+1}$ 和步骤 $n$ 的状态来表示最终状态 $(\\sigma_{n+1}, \\varepsilon_{n+1}^p, \\alpha_{n+1})$。为了求得一致性切线模量，我们对这些隐式关系求导。最直接的方法是对该方程组关于总应变 $\\varepsilon_{n+1}$ 进行微分。令 $\\partial(\\cdot)$ 表示微分算子 $\\partial(\\cdot)/\\partial\\varepsilon_{n+1}$。\n\n从弹性定律和应变分解可得：\n$\\sigma_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon_{n+1}^p)$\n关于 $\\varepsilon_{n+1}$ 微分，得到：\n$\\partial\\sigma_{n+1} = E (1 - \\partial\\varepsilon_{n+1}^p)$\n\n从流动法则，针对 $\\sigma  0$ 的情况：\n$\\varepsilon_{n+1}^p = \\varepsilon_n^p + \\Delta\\lambda$\n关于 $\\varepsilon_{n+1}$ 微分（注意 $\\varepsilon_n^p$ 是上一步的常数）：\n$\\partial\\varepsilon_{n+1}^p = \\partial(\\Delta\\lambda)$\n\n从屈服条件，针对 $\\sigma  0$ 的情况：\n$\\sigma_{n+1} - \\sigma_y - H\\alpha_{n+1} = 0$\n代入硬化定律 $\\alpha_{n+1} = \\alpha_n + \\Delta\\lambda$：\n$\\sigma_{n+1} - \\sigma_y - H(\\alpha_n + \\Delta\\lambda) = 0$\n关于 $\\varepsilon_{n+1}$ 微分（注意 $\\sigma_y$ 和 $\\alpha_n$ 是常数）：\n$\\partial\\sigma_{n+1} - H\\,\\partial(\\Delta\\lambda) = 0 \\implies \\partial\\sigma_{n+1} = H\\,\\partial(\\Delta\\lambda)$\n\n现在我们得到一个由三个微分关系组成的系统：\n(i) $\\partial\\sigma_{n+1} = E (1 - \\partial\\varepsilon_{n+1}^p)$\n(ii) $\\partial\\varepsilon_{n+1}^p = \\partial(\\Delta\\lambda)$\n(iii) $\\partial\\sigma_{n+1} = H\\,\\partial(\\Delta\\lambda)$\n\n由 (ii) 和 (iii)，我们可以将塑性应变的微分与应力的微分联系起来：\n$\\partial\\varepsilon_{n+1}^p = \\frac{1}{H}\\partial\\sigma_{n+1}$\n\n将此代入方程 (i)：\n$\\partial\\sigma_{n+1} = E \\left(1 - \\frac{1}{H}\\partial\\sigma_{n+1}\\right) = E - \\frac{E}{H}\\partial\\sigma_{n+1}$\n\n现在，我们求解 $\\partial\\sigma_{n+1}$：\n$\\partial\\sigma_{n+1} + \\frac{E}{H}\\partial\\sigma_{n+1} = E$\n$\\partial\\sigma_{n+1} \\left(1 + \\frac{E}{H}\\right) = E$\n$\\partial\\sigma_{n+1} \\left(\\frac{H+E}{H}\\right) = E$\n$\\partial\\sigma_{n+1} = \\frac{EH}{E+H}$\n\n一致性切线模量是应力变化与应变变化之比，即 $\\partial\\sigma_{n+1}/\\partial\\varepsilon_{n+1}$。\n因此，微观算法切线模量为 $E_{\\mathrm{alg}} = \\frac{\\partial\\sigma_{n+1}}{\\partial\\varepsilon_{n+1}} = \\frac{EH}{E+H}$。\n由于这个简单问题的均质化规则（$\\sigma^M = \\sigma$, $\\varepsilon^M = \\varepsilon$），宏观一致性切线模量与微观一致性切线模量相同：\n$E_{\\mathrm{M,alg}} = \\frac{EH}{E+H}$。\n\n该表达式是弹性模量 $E$ 和算法塑性模量 $H$ 的调和平均数。\n\n**2. $E_{\\mathrm{M,alg}}$ 的数值计算**\n\n给定值 $E = 210~\\mathrm{GPa}$ 和 $H = 1.5~\\mathrm{GPa}$，我们将其代入推导出的表达式中：\n$$E_{\\mathrm{M,alg}} = \\frac{(210~\\mathrm{GPa})(1.5~\\mathrm{GPa})}{210~\\mathrm{GPa} + 1.5~\\mathrm{GPa}} = \\frac{315}{211.5}~\\mathrm{GPa}$$\n$$E_{\\mathrm{M,alg}} \\approx 1.4893617...~\\mathrm{GPa}$$\n四舍五入到四位有效数字，我们得到：\n$$E_{\\mathrm{M,alg}} = 1.489~\\mathrm{GPa}$$\n\n**3. $H$ 对宏观收敛性的影响**\n\n宏观有限元问题是一个非线性代数方程组，通常使用 Newton-Raphson 方法求解。这种迭代方法的收敛速度关键取决于所使用的切线刚度矩阵。为实现二次收敛，该矩阵必须由一致性切线模量构建，而一致性切线模量是残差向量相对于节点自由度的精确导数。在这个问题中，$E_{\\mathrm{M,alg}} = \\frac{EH}{E+H}$ 正是该材料点的一致性切线模量。\n\n算法塑性模量 $H$ 直接影响 $E_{\\mathrm{M,alg}}$ 的值，因此决定了塑性变形过程中的宏观刚度。其值对 FE² 模拟的数值性能至关重要。\n\n- **当 $H \\to 0$ 时的极限行为（理想塑性）：**\n当 $H$ 趋近于 $0$ 时，宏观切线模量变为：\n$$\\lim_{H \\to 0} E_{\\mathrm{M,alg}} = \\lim_{H \\to 0} \\frac{EH}{E+H} = 0$$\n零切线模量意味着宏观刚度矩阵在正在经历塑性流动的积分点处变为奇异（或近奇异）。这会导致标准 Newton-Raphson 求解器出现严重的数值困难，从而无法找到解。这种行为对应于达到极限载荷，需要专门的求解器（例如，弧长法）才能继续进行。\n\n- **当 $H \\to \\infty$ 时的极限行为：**\n当 $H$ 趋近于无穷大时，宏观切线模量变为：\n$$\\lim_{H \\to \\infty} E_{\\mathrm{M,alg}} = \\lim_{H \\to \\infty} \\frac{EH}{E+H} = \\lim_{H \\to \\infty} \\frac{E}{\\frac{E}{H}+1} = \\frac{E}{0+1} = E$$\n无限大的硬化模量意味着需要无限大的应力才能引起进一步的塑性应变。材料实际上表现得像纯弹性体。宏观切线模量恢复为弹性模量 $E$。宏观问题变为线性问题，Newton-Raphson 求解器在一次迭代中收敛。\n\n总之，$H$ 的值控制着材料的屈服后刚度。使用正确的、依赖于 $H$ 的 $E_{\\mathrm{M,alg}}$ 可以确保宏观牛顿迭代的二次收敛性。$H \\to 0$ 和 $H \\to \\infty$ 的极端情况分别导致病态（奇异）和良态（线弹性）问题。",
            "answer": "$$\\boxed{1.489}$$"
        },
        {
            "introduction": "对于出现软化行为（例如损伤）的材料，标准的均匀化方法可能会失效，导致不符合物理实际且依赖于网格的计算结果。这项高级实践通过引入非局部正则化方法来解决这一问题。它将在微观物理属性（断裂能，$G_f$）与必要的宏观正则化参数（非局部特征长度，$\\ell$）之间建立关键联系，从而展示如何为复杂的材料失效过程建立基于物理的宏观模型 。",
            "id": "3498292",
            "problem": "考虑一个一维拉伸杆，采用并发多尺度平方有限元 (FE²) 公式进行建模，其中每个宏观积分点都与一个微观代表性体积单元 (RVE) 耦合，该 RVE 表现出各向同性标量损伤和拉伸状态下的线性软化。宏观本构行为通过等效应变的非局部积分平均进行正则化。目标是计算由微观损伤模型产生的表观特征长度，并量化该长度如何影响非局部 FE² 公式中的宏观局部化预测。\n\n微观尺度模型假设与定义：\n- 微观弹性模量为 $E$ (单位 $\\mathrm{Pa}$)，损伤起始时的微观等效应变为 $\\varepsilon_0$ (无量纲)，完全失效时的等效应变为 $\\varepsilon_f$ (无量纲)，且 $\\varepsilon_f  \\varepsilon_0$。\n- 微观抗拉强度为 $\\sigma_0 = E \\varepsilon_0$ (单位 $\\mathrm{Pa}$)。\n- 每单位面积的微观断裂能为 $G_f$ (单位 $\\mathrm{N/m}$)，定义为在软化过程中积分得到的、完全形成一个无牵引力裂纹所需的能量。\n- 损伤起始后，在单调拉伸加载下，微观应力在应变为 $\\varepsilon_f$ 时线性软化至零。\n- 假设在微观尺度上存在一个在其宽度范围内具有均匀应变的局部化带：带内等效应变为 $\\varepsilon_f$，带外则保持为 $\\varepsilon_0$。\n\n宏观非局部正则化：\n- 位置 $x$ 处的宏观等效应变，记为 $\\varepsilon_{\\mathrm{nl}}(x)$ (无量纲)，通过使用归一化指数核对局部等效应变场 $\\varepsilon_{\\mathrm{loc}}(\\xi)$ 进行积分平均来定义，\n$$\nw(r;\\ell) = \\frac{1}{2\\ell} \\exp\\left(-\\frac{|r|}{\\ell}\\right),\n$$\n其中 $r = x - \\xi$，$\\ell$ 是宏观非局部核长度 (单位 $\\mathrm{m}$)。非局部等效应变为\n$$\n\\varepsilon_{\\mathrm{nl}}(x) = \\int_{-\\infty}^{\\infty} w(|x-\\xi|;\\ell)\\,\\varepsilon_{\\mathrm{loc}}(\\xi)\\, \\mathrm{d}\\xi.\n$$\n- 在 FE² 设置中，核长度 $\\ell$ 可以通过从 RVE 损伤响应计算出的表观特征长度与微观尺度联系起来。在实践中，$\\ell$ 可以通过一个无量纲乘数 $c  0$ 相对于表观长度进行缩放，即 $\\ell = c\\,\\ell_{\\mathrm{app}}$。\n\n任务：\n1. 从能量平衡和上述定义出发，推导表观特征长度 $\\ell_{\\mathrm{app}}$ (单位 $\\mathrm{m}$)。该长度使得每单位面积的微观断裂能 $G_f$ 等于一个宽度为 $\\ell_{\\mathrm{app}}$ 的一维局部化带在假定的线性软化定律下从 $\\varepsilon_0$ 完全软化到 $\\varepsilon_f$ 时所耗散的能量。您的推导必须从微观应力-应变表征和断裂能定义开始，并且不得假设任何关于 $\\ell_{\\mathrm{app}}$ 的既有公式。\n2. 使用推导出的 $\\ell_{\\mathrm{app}}$，考虑一个以 $x=0$ 为中心、宽度为 $\\ell_{\\mathrm{app}}$ 的顶帽形局部等效应变场，其中当 $|x| \\le \\ell_{\\mathrm{app}}/2$ 时 $\\varepsilon_{\\mathrm{loc}}(x) = \\varepsilon_f$，否则 $\\varepsilon_{\\mathrm{loc}}(x) = \\varepsilon_0$。对于上面定义的指数核，在 $\\ell = c\\,\\ell_{\\mathrm{app}}$ 的情况下，计算中心点的非局部等效应变 $\\varepsilon_{\\mathrm{nl}}(0)$。由此推导一个无量纲影响度量\n$$\nr = \\frac{\\varepsilon_{\\mathrm{nl}}(0) - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0},\n$$\n该度量用于量化非局部模型对局部化高应变区域的加权强度（其中 $r \\in (0,1)$）。请用非局部核长度与表观特征长度之比来表示 $r$。\n\n3. 实现一个完整、可运行的程序，对下面列出的每个测试用例，计算并返回浮点数对 $\\left[\\ell_{\\mathrm{app}}, r\\right]$。使用国际单位制 (SI)：以 $\\mathrm{m}$ 为单位报告 $\\ell_{\\mathrm{app}}$，以十进制形式报告 $r$。将两个输出都四舍五入到六位小数。\n\n测试组：\n- A例（一般情况）：$E = 50\\times 10^9\\,\\mathrm{Pa}$，$\\varepsilon_0 = 0.002$，$\\varepsilon_f = 0.02$， $G_f = 1200\\,\\mathrm{N/m}$，$c = 1.0$。\n- B例（边界情况：核长度相对于表观长度较小）：$E = 70\\times 10^9\\,\\mathrm{Pa}$，$\\varepsilon_0 = 0.0015$，$\\varepsilon_f = 0.004$，$G_f = 250\\,\\mathrm{N/m}$，$c = 0.25$。\n- C例（边缘情况：软化窗口较窄）：$E = 30\\times 10^9\\,\\mathrm{Pa}$，$\\varepsilon_0 = 0.002$，$\\varepsilon_f = 0.0024$，$G_f = 800\\,\\mathrm{N/m}$，$c = 1.5$。\n- D例（具有更大韧性和更强平滑效果的一般情况）：$E = 40\\times 10^9\\,\\mathrm{Pa}$，$\\varepsilon_0 = 0.0025$，$\\varepsilon_f = 0.015$，$G_f = 5000\\,\\mathrm{N/m}$，$c = 2.0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由四个项目组成的逗号分隔列表，每个测试用例对应一个项目，每个项目都是 $\\left[\\ell_{\\mathrm{app}}, r\\right]$ 形式的双元素列表。例如：\n[[l_app_A,r_A],[l_app_B,r_B],[l_app_C,r_C],[l_app_D,r_D]]",
            "solution": "该问题是有效的。这是一个在计算连续介质力学领域内提出来的、适定的、有科学依据的问题，特别关注于应变软化材料多尺度建模中使用的正则化技术。我们将提供完整的解答。\n\n主要目标是为一个一维非局部损伤模型推导两个关键量，然后根据一组给定的材料参数计算它们。第一个量是表观特征长度 $\\ell_{\\mathrm{app}}$，它将微观断裂能与局部化带中耗散的能量联系起来。第二个量是无量纲影响度量 $r$，它量化了非局部正则化的程度。\n\n推导过程按照问题任务的要求分为两部分。\n\n**第1部分：表观特征长度 $\\ell_{\\mathrm{app}}$ 的推导**\n\n表观特征长度 $\\ell_{\\mathrm{app}}$ 是通过假设能量等效来推导的。唯象的材料属性，即每单位面积的断裂能 $G_f$，必须等于一个局部化带在形成并完全软化过程中每单位面积耗散的总能量。该带的宽度被定义为 $\\ell_{\\mathrm{app}}$。\n\n首先，我们描述每单位体积耗散的能量，记为 $g_f$。问题陈述了微观应力 $\\sigma$ 作为等效应变 $\\varepsilon$ 的函数的线性软化定律。在应变为 $\\varepsilon_0$ 时，应力达到峰值 $\\sigma_0 = E \\varepsilon_0$ 之前是线弹性的。对于介于损伤起始应变 $\\varepsilon_0$ 和完全失效应变 $\\varepsilon_f$ 之间的应变 $\\varepsilon$，应力线性减小至零。软化过程中的应力-应变关系 ($\\varepsilon_0 \\le \\varepsilon \\le \\varepsilon_f$) 由下式给出：\n$$\n\\sigma(\\varepsilon) = \\sigma_0 \\frac{\\varepsilon_f - \\varepsilon}{\\varepsilon_f - \\varepsilon_0}\n$$\n在软化过程中，每单位体积耗散的能量 $g_f$ 是应力对应变从 $\\varepsilon_0$ 到 $\\varepsilon_f$ 的积分。这对应于应力-应变曲线软化部分的面积。\n$$\ng_f = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma(\\varepsilon) \\, \\mathrm{d}\\varepsilon = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma_0 \\frac{\\varepsilon_f - \\varepsilon}{\\varepsilon_f - \\varepsilon_0} \\, \\mathrm{d}\\varepsilon\n$$\n我们可以从积分中提取常数项：\n$$\ng_f = \\frac{\\sigma_0}{\\varepsilon_f - \\varepsilon_0} \\int_{\\varepsilon_0}^{\\varepsilon_f} (\\varepsilon_f - \\varepsilon) \\, \\mathrm{d}\\varepsilon\n$$\n计算该积分得到：\n$$\ng_f = \\frac{\\sigma_0}{\\varepsilon_f - \\varepsilon_0} \\left[ \\varepsilon_f\\varepsilon - \\frac{\\varepsilon^2}{2} \\right]_{\\varepsilon_0}^{\\varepsilon_f} = \\frac{\\sigma_0}{\\varepsilon_f - \\varepsilon_0} \\left( \\left(\\varepsilon_f^2 - \\frac{\\varepsilon_f^2}{2}\\right) - \\left(\\varepsilon_f\\varepsilon_0 - \\frac{\\varepsilon_0^2}{2}\\right) \\right)\n$$\n$$\ng_f = \\frac{\\sigma_0}{\\varepsilon_f - \\varepsilon_0} \\left( \\frac{\\varepsilon_f^2}{2} - \\varepsilon_f\\varepsilon_0 + \\frac{\\varepsilon_0^2}{2} \\right) = \\frac{\\sigma_0}{2(\\varepsilon_f - \\varepsilon_0)} (\\varepsilon_f^2 - 2\\varepsilon_f\\varepsilon_0 + \\varepsilon_0^2) = \\frac{\\sigma_0}{2(\\varepsilon_f - \\varepsilon_0)} (\\varepsilon_f - \\varepsilon_0)^2\n$$\n这可以简化为：\n$$\ng_f = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0)\n$$\n这个结果是直观的，因为它代表了底为 $(\\varepsilon_f - \\varepsilon_0)$、高为 $\\sigma_0$ 的直角三角形的面积。\n\n接下来，我们建立能量平衡。在宽度为 $\\ell_{\\mathrm{app}}$ 的局部化带中，每单位横截面积耗散的总能量是能量密度 $g_f$ 与宽度 $\\ell_{\\mathrm{app}}$ 的乘积。该量必须等于材料的断裂能 $G_f$。\n$$\nG_f = g_f \\cdot \\ell_{\\mathrm{app}}\n$$\n代入 $g_f$ 的表达式并求解 $\\ell_{\\mathrm{app}}$：\n$$\nG_f = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0) \\ell_{\\mathrm{app}} \\implies \\ell_{\\mathrm{app}} = \\frac{2 G_f}{\\sigma_0 (\\varepsilon_f - \\varepsilon_0)}\n$$\n使用给定的定义 $\\sigma_0 = E \\varepsilon_0$，我们得到表观特征长度的最终表达式：\n$$\n\\ell_{\\mathrm{app}} = \\frac{2 G_f}{E \\varepsilon_0 (\\varepsilon_f - \\varepsilon_0)}\n$$\n\n**第2部分：影响度量 $r$ 的推导**\n\n第二个任务是通过计算无量纲度量 $r$ 来量化非局部模型的正则化效应。这需要计算指定局部应变场中心的非局部应变 $\\varepsilon_{\\mathrm{nl}}(0)$。\n\n非局部应变 $\\varepsilon_{\\mathrm{nl}}(x)$ 通过局部应变场 $\\varepsilon_{\\mathrm{loc}}(\\xi)$ 与权重核 $w(|x - \\xi|; \\ell)$ 的卷积定义：\n$$\n\\varepsilon_{\\mathrm{nl}}(x) = \\int_{-\\infty}^{\\infty} w(|x-\\xi|;\\ell)\\,\\varepsilon_{\\mathrm{loc}}(\\xi)\\, \\mathrm{d}\\xi\n$$\n给定一个以 $x=0$ 为中心、宽度为 $\\ell_{\\mathrm{app}}$ 的顶帽形局部应变场：\n$$\n\\varepsilon_{\\mathrm{loc}}(\\xi) = \\begin{cases} \\varepsilon_f  \\text{for } |\\xi| \\le \\ell_{\\mathrm{app}}/2 \\\\ \\varepsilon_0  \\text{for } |\\xi|  \\ell_{\\mathrm{app}}/2 \\end{cases}\n$$\n我们计算中心点 $x=0$ 处的非局部应变：\n$$\n\\varepsilon_{\\mathrm{nl}}(0) = \\int_{-\\infty}^{\\infty} w(|\\xi|;\\ell)\\,\\varepsilon_{\\mathrm{loc}}(\\xi)\\, \\mathrm{d}\\xi\n$$\n我们可以将 $\\varepsilon_{\\mathrm{loc}}(\\xi)$ 重写为一个恒定的基线应变 $\\varepsilon_0$ 加上在区间 $[-\\ell_{\\mathrm{app}}/2, \\ell_{\\mathrm{app}}/2]$ 上的一个扰动 $\\Delta\\varepsilon = \\varepsilon_f - \\varepsilon_0$。\n$$\n\\varepsilon_{\\mathrm{nl}}(0) = \\int_{-\\infty}^{\\infty} w(|\\xi|; \\ell) \\varepsilon_0 \\,d\\xi + \\int_{-\\ell_{\\mathrm{app}}/2}^{\\ell_{\\mathrm{app}}/2} w(|\\xi|; \\ell)(\\varepsilon_f - \\varepsilon_0) \\,d\\xi\n$$\n核函数 $w(r;\\ell) = \\frac{1}{2\\ell} \\exp(-|r|/\\ell)$ 是归一化的，意味着 $\\int_{-\\infty}^{\\infty} w(|\\xi|;\\ell) \\,d\\xi = 1$。因此，第一项的计算结果为 $\\varepsilon_0$。\n$$\n\\varepsilon_{\\mathrm{nl}}(0) = \\varepsilon_0 + (\\varepsilon_f - \\varepsilon_0) \\int_{-\\ell_{\\mathrm{app}}/2}^{\\ell_{\\mathrm{app}}/2} \\frac{1}{2\\ell} \\exp\\left(-\\frac{|\\xi|}{\\ell}\\right) \\, \\mathrm{d}\\xi\n$$\n被积函数是偶函数，因此我们可以简化积分：\n$$\n\\int_{-\\ell_{\\mathrm{app}}/2}^{\\ell_{\\mathrm{app}}/2} \\frac{1}{2\\ell} e^{-|\\xi|/\\ell} \\, \\mathrm{d}\\xi = 2 \\int_{0}^{\\ell_{\\mathrm{app}}/2} \\frac{1}{2\\ell} e^{-\\xi/\\ell} \\, \\mathrm{d}\\xi = \\frac{1}{\\ell} \\left[-\\ell e^{-\\xi/\\ell}\\right]_{0}^{\\ell_{\\mathrm{app}}/2}\n$$\n$$\n= -\\left(e^{-\\ell_{\\mathrm{app}}/(2\\ell)} - e^0\\right) = 1 - e^{-\\ell_{\\mathrm{app}}/(2\\ell)}\n$$\n将此结果代回 $\\varepsilon_{\\mathrm{nl}}(0)$ 的表达式中：\n$$\n\\varepsilon_{\\mathrm{nl}}(0) = \\varepsilon_0 + (\\varepsilon_f - \\varepsilon_0) \\left(1 - e^{-\\ell_{\\mathrm{app}}/(2\\ell)}\\right)\n$$\n影响度量 $r$ 定义为中心点处归一化的非局部应变增量：\n$$\nr = \\frac{\\varepsilon_{\\mathrm{nl}}(0) - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0}\n$$\n代入我们得到的 $\\varepsilon_{\\mathrm{nl}}(0)$ 的结果：\n$$\nr = \\frac{\\left[ \\varepsilon_0 + (\\varepsilon_f - \\varepsilon_0) \\left(1 - e^{-\\ell_{\\mathrm{app}}/(2\\ell)}\\right) \\right] - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0} = 1 - e^{-\\ell_{\\mathrm{app}}/(2\\ell)}\n$$\n最后，问题陈述了宏观核长度 $\\ell$ 通过一个缩放因子 $c  0$ 与表观特征长度 $\\ell_{\\mathrm{app}}$ 相关联，即 $\\ell = c\\,\\ell_{\\mathrm{app}}$。将此关系代入 $r$ 的表达式中：\n$$\nr = 1 - \\exp\\left(-\\frac{\\ell_{\\mathrm{app}}}{2(c\\,\\ell_{\\mathrm{app}})}\\right) = 1 - e^{-1/(2c)}\n$$\n这个简洁的结果表明，影响度量 $r$ 仅取决于两个特征长度的无量纲比率 $c$。\n\n**用于实现的公式总结：**\n需要实现的两个最终公式是：\n1.  表观特征长度：$\\ell_{\\mathrm{app}} = \\frac{2 G_f}{E \\varepsilon_0 (\\varepsilon_f - \\varepsilon_0)}$\n2.  影响度量：$r = 1 - e^{-1/(2c)}$\n\n这些公式将用于为每个测试用例计算所需的数对 $[\\ell_{\\mathrm{app}}, r]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the apparent characteristic length (l_app) and a dimensionless\n    influence metric (r) for a nonlocal damage model based on several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E, eps0, epsf, Gf, c)\n    # E: Young's Modulus (Pa)\n    # eps0: Strain at damage initiation (dimensionless)\n    # epsf: Strain at complete failure (dimensionless)\n    # Gf: Fracture energy per unit area (N/m)\n    # c: Nonlocal length scale multiplier (dimensionless)\n    test_cases = [\n        # Case A\n        (50e9, 0.002, 0.02, 1200, 1.0),\n        # Case B\n        (70e9, 0.0015, 0.004, 250, 0.25),\n        # Case C\n        (30e9, 0.002, 0.0024, 800, 1.5),\n        # Case D\n        (40e9, 0.0025, 0.015, 5000, 2.0),\n    ]\n\n    results = []\n    for E, eps0, epsf, Gf, c in test_cases:\n        # Task 1: Calculate the apparent characteristic length, l_app.\n        # Formula: l_app = (2 * Gf) / (E * eps0 * (epsf - eps0))\n        # This is derived from equating the fracture energy Gf to the energy\n        # dissipated in a localization band of width l_app.\n        denominator_l_app = E * eps0 * (epsf - eps0)\n        if denominator_l_app == 0:\n            # Avoid division by zero, though problem constraints ensure epsf > eps0.\n            l_app = float('inf')\n        else:\n            l_app = (2 * Gf) / denominator_l_app\n\n        # Task 2: Calculate the dimensionless influence metric, r.\n        # Formula: r = 1 - exp(-1 / (2 * c))\n        # This metric quantifies the smoothing effect of the nonlocal kernel.\n        if c == 0:\n            # Avoid division by zero and invalid input for c.\n            r = float('nan')\n        else:\n            r = 1 - np.exp(-1 / (2 * c))\n\n        # Round both results to six decimal places as required.\n        l_app_rounded = round(l_app, 6)\n        r_rounded = round(r, 6)\n\n        results.append([l_app_rounded, r_rounded])\n\n    # Final print statement in the exact required format.\n    # The format is [[l_app_A,r_A],[l_app_B,r_B],[l_app_C,r_C],[l_app_D,r_D]]\n    # Using str.replace to remove spaces for precise formatting.\n    # Example: str([[1.0, 2.0]]) becomes '[[1.0, 2.0]]'\n    # .replace(' ', '') makes it '[[1.0,2.0]]'\n    output_string = str(results).replace(\" \", \"\")\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}