{
    "hands_on_practices": [
        {
            "introduction": "Schwarz方法的效率在很大程度上取决于在子域界面上交换信息的传输条件（TCs）。本练习将通过一个经典的理论分析来探讨如何优化这些条件。通过在频域中分析一维热方程，您将推导出能最小化子域间误差传播的最优Robin传输参数，从而为波形松弛法（waveform relaxation）的收敛性分析建立一个基本而深刻的理解。",
            "id": "3519545",
            "problem": "考虑在全直线 $\\mathbb{R}$ 上的一维热方程 $u_{t}-\\nu u_{xx}=0$，其中 $\\nu>0$ 是一个常数热扩散系数。将空间域分割为两个不重叠的子区域 $\\Omega_{1}=(-\\infty,0)$ 和 $\\Omega_{2}=(0,\\infty)$，并考虑在界面 $x=0$ 上使用 Robin 传输条件的 Schwarz 波形松弛迭代。具体来说，设 $\\Omega_{1}$ 的单位外法线为 $n_{1}=+1$，$\\Omega_{2}$ 的单位外法线为 $n_{2}=-1$，并在每次迭代中，在 $x=0$ 处施加从相邻子区域传递过来的形式为 $\\partial_{n} u + \\alpha u$ 的 Robin 条件，其中 $\\alpha>0$ 是一个实数 Robin 参数。\n\n假设零强迫项，并专注于误差传播。在时间-傅里叶域中分析迭代：对时间进行角频率为 $\\omega\\ge 0$ 的傅里叶变换，使得变换后的场 $\\widehat{u}(x,\\omega)$ 满足一个关于 $x$ 的二阶齐次常微分方程。在每个半无限子区域中选择衰减解，并推导出界面 $x=0$ 处的标量误差传播因子 $r(\\omega,\\alpha)$，用 $\\alpha$、$\\nu$ 和 $\\omega$ 表示。\n\n确定使误差传播因子模 $|r(\\omega,\\alpha)|$ 对 $\\alpha\\in\\mathbb{R}_{+}$ 最小化的值 $\\alpha^{\\star}(\\omega)$，并将 $\\alpha^{\\star}(\\omega)$ 表示为 $\\omega$ 和 $\\nu$ 的闭合形式函数。您的最终答案必须是 $\\alpha^{\\star}(\\omega)$ 的单个解析表达式。不需要四舍五入。最终答案框中不要包含单位。",
            "solution": "用户希望找到应用于一维热方程的 Schwarz 波形松弛法的最优 Robin 参数。\n\n### 第 1 步：提取已知信息\n-   **方程**：一维热方程，$u_{t}-\\nu u_{xx}=0$，对于 $x \\in \\mathbb{R}$。\n-   **参数**：$\\nu > 0$ 是常数热扩散系数。\n-   **区域分解**：$\\Omega_{1}=(-\\infty,0)$ 和 $\\Omega_{2}=(0,\\infty)$。界面位于 $x=0$。\n-   **方法**：Schwarz 波形松弛。\n-   **传输条件 (TCs)**：在界面 $x=0$ 处，传递形式为 $\\partial_{n} u + \\alpha u$ 的 Robin 条件，其中 $\\alpha > 0$ 是一个实参数。\n-   **外法线**：对于 $\\Omega_{1}$ 在 $x=0$ 处，$n_{1}=+1$。对于 $\\Omega_{2}$ 在 $x=0$ 处，$n_{2}=-1$。\n-   **分析**：分析将在角频率为 $\\omega \\ge 0$ 的时间-傅里叶域中进行。\n-   **边界条件**：解 $\\widehat{u}(x, \\omega)$ 必须在 $|x| \\to \\infty$ 时衰减。\n-   **目标**：推导误差传播因子 $r(\\omega,\\alpha)$，并找到使 $|r(\\omega,\\alpha)|$ 对 $\\alpha \\in \\mathbb{R}_{+}$ 最小化的值 $\\alpha^{\\star}(\\omega)$。\n\n### 第 2 步：使用提取的已知信息进行验证\n该问题在科学上是合理的、适定的和客观的。它涉及对一个基本偏微分方程（热方程）的区域分解方法（Schwarz 波形松弛）的标准分析。使用傅里叶分析来确定收敛性质和优化参数是该领域中一种成熟的技术。所有必要的信息都已提供，定义一致且明确。该问题并非微不足道，需要严谨的数学推导。因此，该问题被认为是**有效的**。\n\n### 第 3 步：结论与行动\n问题有效。现在开始求解过程。\n\n### 最优 Robin 参数的推导\n\n我们从实直线上的的一维热方程开始：\n$$\nu_{t} - \\nu u_{xx} = 0, \\quad x \\in \\mathbb{R}, t > 0\n$$\n其中 $\\nu > 0$ 是热扩散系数。我们考虑误差的传播，它满足相同的齐次方程。\n\n分析在时间傅里叶域中进行。设 $\\widehat{u}(x,\\omega)$ 是 $u(x,t)$ 的时间傅里叶变换，定义为 $\\widehat{u}(x,\\omega) = \\int_{-\\infty}^{\\infty} u(x,t) e^{-i\\omega t} dt$。将该变换应用于热方程，时间导数 $\\partial_t$ 变为乘以 $i\\omega$。这产生了一个关于空间变量 $x$ 的齐次二阶常微分方程 (ODE)：\n$$\ni\\omega \\widehat{u}(x,\\omega) - \\nu \\frac{d^2\\widehat{u}}{dx^2}(x,\\omega) = 0\n$$\n$$\n\\frac{d^2\\widehat{u}}{dx^2} - \\frac{i\\omega}{\\nu} \\widehat{u} = 0\n$$\n该 ODE 的特征方程是 $\\lambda^2 - \\frac{i\\omega}{\\nu} = 0$。其根为 $\\lambda = \\pm \\sqrt{\\frac{i\\omega}{\\nu}}$。\n为简化根，我们使用虚数单位 $i$ 的极坐标表示，$i = e^{i\\pi/2}$。因此，$\\sqrt{i} = e^{i\\pi/4} = \\cos(\\frac{\\pi}{4}) + i\\sin(\\frac{\\pi}{4}) = \\frac{1+i}{\\sqrt{2}}$。根变为：\n$$\n\\lambda = \\pm \\sqrt{\\frac{\\omega}{\\nu}} \\left( \\frac{1+i}{\\sqrt{2}} \\right) = \\pm \\sqrt{\\frac{\\omega}{2\\nu}}(1+i)\n$$\n我们定义 $k(\\omega) = \\sqrt{\\frac{\\omega}{2\\nu}}(1+i)$。$k(\\omega)$ 的实部是 $\\operatorname{Re}(k(\\omega)) = \\sqrt{\\frac{\\omega}{2\\nu}}$，对于 $\\omega \\ge 0$ 是非负的。该 ODE 的通解是 $\\widehat{u}(x,\\omega) = C_1 e^{k(\\omega)x} + C_2 e^{-k(\\omega)x}$。\n\n问题要求解在 $|x| \\to \\infty$ 时是衰减的。\n-   在子区域 $\\Omega_1 = (-\\infty, 0)$ 中，解必须在 $x \\to -\\infty$ 时衰减。项 $e^{-k(\\omega)x}$ 的模在 $x \\to -\\infty$ 时增长，因此其系数必须为零。所以解的形式为 $\\widehat{u}_1(x,\\omega) = A_1 e^{k(\\omega)x}$。\n-   在子区域 $\\Omega_2 = (0, \\infty)$ 中，解必须在 $x \\to +\\infty$ 时衰减。项 $e^{k(\\omega)x}$ 的模在 $x \\to +\\infty$ 时增长，因此其系数必须为零。所以解的形式为 $\\widehat{u}_2(x,\\omega) = A_2 e^{-k(\\omega)x}$。\n\nSchwarz 波形松弛迭代涉及在界面 $x=0$ 交换 Robin 边界数据。设迭代索引为 $j$。$\\Omega_1$ 的外法线是 $n_1=+1$，所以 $\\partial_{n_1}=\\partial_x$。$\\Omega_2$ 的外法线是 $n_2=-1$，所以 $\\partial_{n_2}=-\\partial_x$。迭代格式为：\n$$\n(\\partial_{n_1} + \\alpha) u_1^j(0,t) = (\\partial_{n_1} + \\alpha) u_2^{j-1}(0,t)\n$$\n$$\n(\\partial_{n_2} + \\alpha) u_2^j(0,t) = (\\partial_{n_2} + \\alpha) u_1^{j-1}(0,t)\n$$\n用空间导数 $\\partial_x$ 表示，即：\n$$\n(\\partial_x + \\alpha) u_1^j(0,t) = (\\partial_x + \\alpha) u_2^{j-1}(0,t)\n$$\n$$\n(-\\partial_x + \\alpha) u_2^j(0,t) = (-\\partial_x + \\alpha) u_1^{j-1}(0,t)\n$$\n对这些传输条件进行傅里叶变换，得到：\n$$\n\\left(\\frac{d}{dx} + \\alpha\\right) \\widehat{u}_1^j(0,\\omega) = \\left(\\frac{d}{dx} + \\alpha\\right) \\widehat{u}_2^{j-1}(0,\\omega)\n$$\n$$\n\\left(-\\frac{d}{dx} + \\alpha\\right) \\widehat{u}_2^j(0,\\omega) = \\left(-\\frac{d}{dx} + \\alpha\\right) \\widehat{u}_1^{j-1}(0,\\omega)\n$$\n我们现在将解的形式 $\\widehat{u}_1^j(x,\\omega) = A_1^j e^{k(\\omega)x}$ 和 $\\widehat{u}_2^j(x,\\omega) = A_2^j e^{-k(\\omega)x}$ 以及它们在 $x=0$ 处的导数代入：\n-   $\\widehat{u}_1^j(0,\\omega) = A_1^j$ 和 $\\frac{d\\widehat{u}_1^j}{dx}(0,\\omega) = k(\\omega) A_1^j$。\n-   $\\widehat{u}_2^j(0,\\omega) = A_2^j$ 和 $\\frac{d\\widehat{u}_2^j}{dx}(0,\\omega) = -k(\\omega) A_2^j$。\n\n将这些代入第一个变换后的传输条件：\n$$\nk(\\omega) A_1^j + \\alpha A_1^j = -k(\\omega) A_2^{j-1} + \\alpha A_2^{j-1} \\implies (k(\\omega)+\\alpha) A_1^j = (\\alpha-k(\\omega)) A_2^{j-1}\n$$\n代入第二个变换后的传输条件：\n$$\n-(-k(\\omega) A_2^j) + \\alpha A_2^j = -(k(\\omega) A_1^{j-1}) + \\alpha A_1^{j-1} \\implies (k(\\omega)+\\alpha) A_2^j = (\\alpha-k(\\omega)) A_1^{j-1}\n$$\n这些方程表明系数按如下方式更新：\n$$\nA_1^j = \\frac{\\alpha - k(\\omega)}{\\alpha + k(\\omega)} A_2^{j-1} \\quad \\text{和} \\quad A_2^j = \\frac{\\alpha - k(\\omega)}{\\alpha + k(\\omega)} A_1^{j-1}\n$$\n子区域间交换的误差传播因子定义为：\n$$\nr(\\omega, \\alpha) = \\frac{\\alpha - k(\\omega)}{\\alpha + k(\\omega)}\n$$\n我们希望找到使模 $|r(\\omega, \\alpha)|$ 最小化的 $\\alpha > 0$ 值。这等价于最小化 $|r(\\omega, \\alpha)|^2$。\n设 $k(\\omega) = a+ib$，其中 $a = \\operatorname{Re}(k(\\omega)) = \\sqrt{\\frac{\\omega}{2\\nu}}$ 和 $b = \\operatorname{Im}(k(\\omega)) = \\sqrt{\\frac{\\omega}{2\\nu}}$。\n$$\n|r(\\omega, \\alpha)|^2 = \\left| \\frac{\\alpha - (a+ib)}{\\alpha + (a+ib)} \\right|^2 = \\frac{|\\alpha-a-ib|^2}{|\\alpha+a+ib|^2} = \\frac{(\\alpha-a)^2 + b^2}{(\\alpha+a)^2 + b^2}\n$$\n设 $f(\\alpha) = |r(\\omega, \\alpha)|^2$。为了找到最小值，我们对 $f(\\alpha)$ 关于 $\\alpha$ 求导并令其为零，假设 $\\omega > 0$（因此 $a>0$）。\n$$\nf'(\\alpha) = \\frac{ d }{ d\\alpha } \\left( \\frac{\\alpha^2 - 2a\\alpha + a^2 + b^2}{\\alpha^2 + 2a\\alpha + a^2 + b^2} \\right)\n$$\n使用商法则，$f'(\\alpha) = \\frac{(2\\alpha-2a)(\\alpha^2+2a\\alpha+a^2+b^2) - (\\alpha^2-2a\\alpha+a^2+b^2)(2\\alpha+2a)}{(\\alpha^2+2a\\alpha+a^2+b^2)^2}$。\n令分子为零：\n$$\n(2\\alpha-2a)(\\alpha^2+2a\\alpha+a^2+b^2) - (\\alpha^2-2a\\alpha+a^2+b^2)(2\\alpha+2a) = 0\n$$\n$$\n2(\\alpha-a)(\\alpha^2+2a\\alpha+a^2+b^2) - 2(\\alpha+a)(\\alpha^2-2a\\alpha+a^2+b^2) = 0\n$$\n展开并化简得到：\n$$\n(\\alpha^3+a\\alpha^2+(b^2-a^2)\\alpha - a(a^2+b^2)) - (\\alpha^3-a\\alpha^2+(b^2-a^2)\\alpha + a(a^2+b^2)) = 0\n$$\n$$\n2a\\alpha^2 - 2a(a^2+b^2) = 0\n$$\n因为我们考虑的是 $\\omega > 0$，所以有 $a > 0$，我们可以除以 $2a$：\n$$\n\\alpha^2 - (a^2+b^2) = 0 \\implies \\alpha^2 = a^2+b^2\n$$\n由于 $\\alpha > 0$，最优值为 $\\alpha^{\\star} = \\sqrt{a^2+b^2}$。这对应于复数 $k(\\omega)$ 的模，所以 $\\alpha^{\\star} = |k(\\omega)|$。\n\n现在，我们用给定的参数 $\\omega$ 和 $\\nu$ 来表示 $\\alpha^{\\star}$。\n$$\na^2 = \\left(\\sqrt{\\frac{\\omega}{2\\nu}}\\right)^2 = \\frac{\\omega}{2\\nu}\n$$\n$$\nb^2 = \\left(\\sqrt{\\frac{\\omega}{2\\nu}}\\right)^2 = \\frac{\\omega}{2\\nu}\n$$\n$$\n\\alpha^{\\star}(\\omega)^2 = a^2 + b^2 = \\frac{\\omega}{2\\nu} + \\frac{\\omega}{2\\nu} = \\frac{2\\omega}{2\\nu} = \\frac{\\omega}{\\nu}\n$$\n取平方根（并记住 $\\alpha > 0, \\omega \\ge 0$），我们得到最优 Robin 参数的最终表达式：\n$$\n\\alpha^{\\star}(\\omega) = \\sqrt{\\frac{\\omega}{\\nu}}\n$$\n此表达式对 $\\omega \\ge 0$ 有效。对于 $\\omega=0$，$\\alpha^{\\star}(0)=0$，这超出了指定的定义域 $\\alpha \\in \\mathbb{R}_+$。在这种情况下，对于任何 $\\alpha>0$，都有 $|r|=1$，因此没有最优选择。然而，导出的公式给出了当 $\\omega \\to 0^+$ 时最优参数的极限。",
            "answer": "$$\\boxed{\\sqrt{\\frac{\\omega}{\\nu}}}$$"
        },
        {
            "introduction": "当处理如对流扩散等更复杂的物理问题时，设计传输条件不仅要考虑收敛速度，还必须尊重潜在的物理原理。本练习将挑战您基于通量守恒的概念，为对流占优的问题构建一个物理上一致的“迎风”格式传输条件。通过对问题进行离散化，您将学习如何将连续的物理原理转化为在人工界面上稳定而精确的数值格式，这是计算多物理场中的一项关键技能。",
            "id": "3519548",
            "problem": "考虑一维稳态对流扩散算子 $-\\varepsilon u'' + c\\,u'$，其参数 $\\varepsilon > 0$ 和 $c > 0$ 为常数。该算子作用的区域被分解为两个不重叠的子区域，它们在一个称为 $x_{\\Gamma}$ 的人工交界面点相遇。在采用 Robin 传输条件的并行 Schwarz 方法 (PSM) 中，选择界面算子以强制施加物理上有意义的通量在 $x_{\\Gamma}$ 处的连续性，并对对流部分使用迎风原理。\n\n从算子的守恒形式出发，定义连续通量 $f(x)$，使得控制方程可以写成关于 $f(x)$ 的守恒律。利用此定义，推导出一个在 $x_{\\Gamma}$ 处的迎风 Robin 传输算子，该算子包含了局部流动方向 ($c>0$)。同时，论证一个合适的 Robin 系数，该系数能在通量连续性的意义上产生一个一致的界面条件。\n\n在间距为 $h$ 的均匀网格上，从左子区域出发在交界面处的向外单边离散导数为\n$$\nD^{-}u(x_{\\Gamma}^{-}) \\approx \\frac{u_{m}^{(L)} - u_{m-1}^{(L)}}{h},\n$$\n从右子区域出发的为\n$$\nD^{+}u(x_{\\Gamma}^{+}) \\approx \\frac{u_{m+1}^{(R)} - u_{m}^{(R)}}{h},\n$$\n其中 $u_{m-1}^{(L)}$、$u_{m}^{(L)}$ 是左子区域的最后两个网格值，$u_{m}^{(R)}$、$u_{m+1}^{(R)}$ 是右子区域的最初两个网格值，且 $x_{\\Gamma}$ 与索引为 $m$ 的网格点重合。当 $c>0$ 时，对交界面处的对流贡献使用一阶迎风处理，计算来自每一侧的离散通量，并构成离散通量跳跃 $\\Delta f := f^{+} - f^{-}$。\n\n给定数值\n$$\n\\varepsilon = 5.0 \\times 10^{-2}, \\quad c = 2, \\quad h = 1.0 \\times 10^{-1},\n$$\n以及交界面附近的网格值\n$$\nu_{m-1}^{(L)} = 1.0, \\quad u_{m}^{(L)} = 9.0 \\times 10^{-1}, \\quad u_{m}^{(R)} = 8.8 \\times 10^{-1}, \\quad u_{m+1}^{(R)} = 8.2 \\times 10^{-1},\n$$\n计算由迎风 Robin 传输在 $x_{\\Gamma}$ 处引起的离散通量跳跃 $\\Delta f$，并将您的最终数值结果表示为一个纯数字。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算一维稳态对流扩散问题在区域分解交界面处的离散通量跳跃。整个过程首先从控制算子中识别物理通量，然后推导界面条件，最后应用指定的离散化和迎风规则。\n\n控制算子为 $\\mathcal{L}u = -\\varepsilon u'' + c u'$，其中常数 $\\varepsilon > 0$ 且 $c > 0$。该算子可以写成通量函数 $f(x)$ 导数的守恒形式。通过对算子关于 $x$ 积分，我们确定通量为：\n$$\nf(x) = -\\varepsilon u'(x) + c u(x)\n$$\n因此，齐次控制方程 $\\mathcal{L}u = 0$ 等价于守恒律 $f'(x) = 0$，这意味着在任何无源区域内，通量 $f(x)$ 是一个常数。在交界面 $x_{\\Gamma}$ 处一个物理上一致的条件是该通量的连续性，即 $[f]_{x_{\\Gamma}} = f(x_{\\Gamma}^{+}) - f(x_{\\Gamma}^{-}) = 0$。\n\n在采用 Robin 传输条件的并行 Schwarz 方法中，在每个子区域的边界上施加形式为 $-\\varepsilon u' + p u = \\text{RHS}$ 的条件。问题要求推导出一个“迎风 Robin 传输算子”。对于 Robin 参数 $p$ 的一个自然且物理上一致的选择是 $p=c$。通过此选择，Robin 算子 $-\\varepsilon u' + c u$ 变得与物理通量算子 $f(x)$ 完全相同。这个选择直接强制了物理通量的连续性，并将对流输运的方向性 ($c>0$) 纳入了传输条件本身。\n\n接下来，问题要求计算在交界面点 $x_{\\Gamma}$（与索引为 $m$ 的网格点重合）处的离散通量跳跃 $\\Delta f = f^{+} - f^{-}$。这需要对交界面两侧的通量表达式 $f(x)$ 进行离散化。\n\n通量的扩散部分为 $-\\varepsilon u'$。问题提供了以下使用来自左 ($L$) 和右 ($R$) 子区域数据的在 $x_{\\Gamma}$ 处导数 $u'$ 的单边有限差分近似：\n$$\nu'^{(L)}(x_{\\Gamma}) \\approx d_L = \\frac{u_{m}^{(L)} - u_{m-1}^{(L)}}{h}\n$$\n$$\nu'^{(R)}(x_{\\Gamma}) \\approx d_R = \\frac{u_{m+1}^{(R)} - u_{m}^{(R)}}{h}\n$$\n\n通量的对流部分为 $c u$。问题指定对“交界面处的对流贡献进行一阶迎风处理”。由于对流系数 $c > 0$，信息流是从左到右的。因此，对流项在交界面处的 $u$ 值应取自迎风（左）侧。其离散值为 $u_{m}^{(L)}$。为确保一致性，这个相同的迎风值被用来计算交界面左侧和右侧的对流项贡献。\n\n使用这些离散化方法，我们可以表示出交界面每一侧的离散通量。来自左侧的离散通量 $f_h^{-}$ 为：\n$$\nf_h^{-} = -\\varepsilon d_L + c u_{m}^{(L)} = -\\varepsilon \\frac{u_{m}^{(L)} - u_{m-1}^{(L)}}{h} + c u_{m}^{(L)}\n$$\n来自右侧的离散通量 $f_h^{+}$ 使用右侧的导数，但使用相同的迎风对流项：\n$$\nf_h^{+} = -\\varepsilon d_R + c u_{m}^{(L)} = -\\varepsilon \\frac{u_{m+1}^{(R)} - u_{m}^{(R)}}{h} + c u_{m}^{(L)}\n$$\n离散通量跳跃 $\\Delta f$ 是这两个量之差：\n$$\n\\Delta f = f_h^{+} - f_h^{-} = \\left(-\\varepsilon \\frac{u_{m+1}^{(R)} - u_{m}^{(R)}}{h} + c u_{m}^{(L)}\\right) - \\left(-\\varepsilon \\frac{u_{m}^{(L)} - u_{m-1}^{(L)}}{h} + c u_{m}^{(L)}\\right)\n$$\n迎风对流项相同并相互抵消：\n$$\n\\Delta f = -\\varepsilon \\frac{u_{m+1}^{(R)} - u_{m}^{(R)}}{h} + \\varepsilon \\frac{u_{m}^{(L)} - u_{m-1}^{(L)}}{h} = \\frac{\\varepsilon}{h} \\left[ (u_{m}^{(L)} - u_{m-1}^{(L)}) - (u_{m+1}^{(R)} - u_{m}^{(R)}) \\right]\n$$\n我们被给予以下数值：\n$\\varepsilon = 5.0 \\times 10^{-2}$\n$c = 2$\n$h = 1.0 \\times 10^{-1}$\n$u_{m-1}^{(L)} = 1.0$\n$u_{m}^{(L)} = 9.0 \\times 10^{-1} = 0.9$\n$u_{m}^{(R)} = 8.8 \\times 10^{-1} = 0.88$\n$u_{m+1}^{(R)} = 8.2 \\times 10^{-1} = 0.82$\n\n我们将这些值代入 $\\Delta f$ 的表达式中：\n$$\n\\Delta f = \\frac{5.0 \\times 10^{-2}}{1.0 \\times 10^{-1}} \\left[ (0.9 - 1.0) - (0.82 - 0.88) \\right]\n$$\n$$\n\\Delta f = 0.5 \\left[ (-0.1) - (-0.06) \\right]\n$$\n$$\n\\Delta f = 0.5 \\left[ -0.1 + 0.06 \\right]\n$$\n$$\n\\Delta f = 0.5 \\left[ -0.04 \\right]\n$$\n$$\n\\Delta f = -0.02\n$$\n问题要求答案四舍五入到四位有效数字。数字 $-0.02$ 可以写成 $-2.000 \\times 10^{-2}$，所以用四位有效数字的小数形式表示为 $-0.02000$。",
            "answer": "$$\\boxed{-0.02000}$$"
        },
        {
            "introduction": "区域分解方法的真正威力通常在求解大规模非线性问题时得以体现，这需要将Schwarz方法作为非线性框架（如牛顿法）中强大的预条件子来集成。这个高级练习深入探讨了加性Schwarz预条件非精确牛顿（ASPIN）方法的内部机制。您将为ASPIN非线性预条件子推导其雅可比-向量积的解析形式，这是牛顿-克雷洛夫求解器中的核心计算，从而从根本上深刻理解现代区域分解方法是如何处理非线性问题的。",
            "id": "3519539",
            "problem": "考虑在区间 $[0,1]$ 上具有齐次狄利克雷边界条件的一维稳态非线性扩散问题，\n$$\n-\\frac{d}{dx}\\Big(k(u)\\frac{du}{dx}\\Big)=0,\\quad u(0)=0,\\quad u(1)=0,\n$$\n其中扩散系数由 $k(u)=1+u^{2}$ 给出。用包含5个节点的均匀网格对区域进行离散，节点位于 $x_{j}=j h$，其中 $j=0,1,2,3,4$，$h=\\frac{1}{4}$。令未知量为内部节点值 $u=\\begin{pmatrix}u_{1}  u_{2}  u_{3}\\end{pmatrix}^{\\top}$。使用标准的双点通量有限差分法，其中界面电导率为 $k_{i+\\frac{1}{2}}=k\\!\\big(\\frac{u_{i}+u_{i+1}}{2}\\big)$，按分量定义离散残差 $F(u)\\in\\mathbb{R}^{3}$：\n$$\nF_{i}(u)=-\\frac{1}{h}\\left(k_{i+\\frac{1}{2}}\\frac{u_{i+1}-u_{i}}{h}-k_{i-\\frac{1}{2}}\\frac{u_{i}-u_{i-1}}{h}\\right),\\quad i=1,2,3,\n$$\n其中 $u_{0}=0$ 且 $u_{4}=0$。\n\n将内部自由度划分为两个重叠的子域 $\\Omega_{1}=\\{1,2\\}$ 和 $\\Omega_{2}=\\{2,3\\}$。令限制算子 $R_{1},R_{2}\\in\\mathbb{R}^{2\\times 3}$ 提取子域向量，\n$$\nR_{1}=\\begin{pmatrix}1  0  0 \\\\ 0  1  0\\end{pmatrix},\\qquad R_{2}=\\begin{pmatrix}0  1  0 \\\\ 0  0  1\\end{pmatrix}.\n$$\n定义延拓算子 $P_{1},P_{2}\\in\\mathbb{R}^{3\\times 2}$ 来实现受限的加性组合：将子域 $\\Omega_{1}$ 的两个分量都注入到全局分量1和2中，并且只将子域 $\\Omega_{2}$ 的第二个分量注入到全局分量3中，即：\n$$\nP_{1}=\\begin{pmatrix}1  0 \\\\ 0  1 \\\\ 0  0\\end{pmatrix},\\qquad P_{2}=\\begin{pmatrix}0  0 \\\\ 0  0 \\\\ 0  1\\end{pmatrix}.\n$$\n\n加性Schwarz预处理非精确牛顿（ASPIN）非线性预条件子由非线性映射 $M:\\mathbb{R}^{3}\\to\\mathbb{R}^{3}$ 定义，\n$$\nM(u)=\\sum_{i=1}^{2}P_{i}\\,\\delta u_{i}(u),\n$$\n其中子域校正量 $\\delta u_{i}(u)\\in\\mathbb{R}^{2}$ 被隐式地定义为局部非线性问题的唯一解\n$$\nR_{i}F\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)=0,\\qquad i=1,2.\n$$\n在应用于预处理系统 $M(u)=0$ 的Newton-Krylov方法中，Krylov方法需要在给定状态 $u$ 下，雅可比矩阵 $M$ 对任意向量 $v\\in\\mathbb{R}^{3}$ 的作用。\n\n仅从上述定义和Fréchet导数的链式法则出发，完成以下任务：\n\n1. 推导雅可比-向量积 $J_{M}(u)v$ 的显式解析表达式，用全局雅可比矩阵 $J(u)=\\nabla F(u)$、在适当局部状态下求值的子域雅可比块 $R_{i}J(\\cdot)R_{i}^{\\top}$ 以及限制/延拓算子来表示。\n\n2. 将你的表达式具体化到状态 $u=\\begin{pmatrix}0  \\alpha  0\\end{pmatrix}^{\\top}$（其中 $\\alpha$ 为任意实数参数），并证明所需的雅可比矩阵应在零状态下求值。然后，使用 $v=\\begin{pmatrix}1  2  -1\\end{pmatrix}^{\\top}$，计算标量瑞利商\n$$\nq(v;u)=v^{\\top}\\big(J_{M}(u)v\\big).\n$$\n\n提供 $q(v;u)$ 的一个无舍入的封闭形式精确值。你的最终答案必须是一个实数。",
            "solution": "我们首先回顾用于非线性系统 $F(u)=0$ 的牛顿法，其迭代公式为 $u^{(k+1)}=u^{(k)}+s^{(k)}$，其中 $J(u^{(k)})s^{(k)}=-F(u^{(k)})$，$J(u)=\\nabla F(u)$ 是雅可比矩阵。在Newton-Krylov方法中，线性系统通过仅使用雅可比-向量积的Krylov子空间法求解。\n\n加性Schwarz预处理非精确牛顿（ASPIN）方法通过组合局部非线性子域求解来构建一个非线性预条件子 $M(u)$。对于每个子域 $i\\in\\{1,2\\}$，将局部校正量 $\\delta u_{i}(u)\\in\\mathbb{R}^{2}$ 定义为隐式方程的解\n$$\nH_{i}\\big(\\delta u_{i}(u);u\\big)\\equiv R_{i}F\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)=0.\n$$\n全局非线性预条件子则为\n$$\nM(u)=\\sum_{i=1}^{2}P_{i}\\,\\delta u_{i}(u).\n$$\n将牛顿法应用于 $M(u)=0$ 需要雅可比矩阵 $J_{M}(u)=\\nabla M(u)$，特别是它在方向 $v\\in\\mathbb{R}^{3}$ 上的作用。我们通过隐式微分来推导 $J_{M}(u)v$。\n\n使用Fréchet导数的链式法则，在方向 $v$ 上对 $H_{i}\\big(\\delta u_{i}(u);u\\big)=0$ 进行微分：\n$$\nD\\!H_{i}\\big[\\delta u_{i}(u);u\\big]\\cdot\\big(D\\delta u_{i}(u)\\cdot v,\\,v\\big)=0.\n$$\n根据链式法则和 $R_{i}$ 的线性性，\n$$\nD\\!H_{i}\\big[\\delta u_{i}(u);u\\big]\\cdot\\big(\\eta,\\,v\\big)=R_{i}J\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)\\Big(v+R_{i}^{\\top}\\eta\\Big),\n$$\n对于任意 $\\eta\\in\\mathbb{R}^{2}$。令 $\\eta=D\\delta u_{i}(u)\\cdot v$，我们得到\n$$\nR_{i}J\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)\\Big(v+R_{i}^{\\top}\\big(D\\delta u_{i}(u)\\cdot v\\big)\\Big)=0.\n$$\n不进行左乘并重新整理，得到校正量方向导数的局部线性化子域问题：\n$$\n\\Big(R_{i}J\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)R_{i}^{\\top}\\Big)\\,\\big(D\\delta u_{i}(u)\\cdot v\\big)=-\\,R_{i}J\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)\\,v.\n$$\n假设子域雅可比块 $R_{i}J(\\cdot)R_{i}^{\\top}$ 是非奇异的，我们求解 $D\\delta u_{i}(u)\\cdot v$：\n$$\nD\\delta u_{i}(u)\\cdot v=-\\Big(R_{i}J\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)R_{i}^{\\top}\\Big)^{-1}R_{i}J\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)\\,v.\n$$\n最后，对 $M(u)=\\sum_{i}P_{i}\\delta u_{i}(u)$ 进行微分得到\n$$\nJ_{M}(u)v=\\sum_{i=1}^{2}P_{i}\\,\\big(D\\delta u_{i}(u)\\cdot v\\big)=-\\sum_{i=1}^{2}P_{i}\\Big(R_{i}J\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)R_{i}^{\\top}\\Big)^{-1}R_{i}J\\!\\big(u+R_{i}^{\\top}\\delta u_{i}(u)\\big)\\,v.\n$$\n该表达式显示了非线性预条件子如何修改Krylov方法所使用的雅可比-向量积：全局作用 $J(\\cdot)\\,v$ 被限制，在每个子域上通过 $R_{i}(\\cdot)R_{i}^{\\top}$ 进行狄利克雷耦合的局部求逆，然后由 $P_{i}$ 延拓。\n\n我们现在将问题具体化到给定的离散化和状态 $u=\\begin{pmatrix}0  \\alpha  0\\end{pmatrix}^{\\top}$，其中 $\\alpha$ 为任意实数。子域 $\\Omega_{1}=\\{1,2\\}$ 和 $\\Omega_{2}=\\{2,3\\}$ 的局部非线性问题施加了等于 $u$ 中值的外部（非子域）值，即对于 $\\Omega_{1}$，$u_{0}=0$, $u_{4}=0$, $u_{3}=0$，对于 $\\Omega_{2}$，$u_{1}=0$, $u_{4}=0$。在齐次狄利克雷边界值和零源项的情况下，每个子域上稳态扩散方程的唯一解是平凡解。因此，对于两个子域，局部解都用零覆盖了子域内部，因此计算雅可比矩阵的“拼接”状态为\n$$\nu+R_{1}^{\\top}\\delta u_{1}(u)=\\begin{pmatrix}0  0  0\\end{pmatrix}^{\\top},\\qquad u+R_{2}^{\\top}\\delta u_{2}(u)=\\begin{pmatrix}0  0  0\\end{pmatrix}^{\\top}.\n$$\n因此，表达式 $J_{M}(u)v$ 中的所有雅可比矩阵都在零状态下求值。在 $u\\equiv 0$ 时，扩散系数为常数 $k(u)\\equiv 1$，离散残差简化为标准的线性二阶差分算子。全局雅可比矩阵 $J(0)$ 是\n$$\nJ(0)=\\frac{1}{h^{2}}\\begin{pmatrix}\n2  -1  0\\\\\n-1  2  -1\\\\\n0  -1  2\n\\end{pmatrix}=\\;16\\begin{pmatrix}\n2  -1  0\\\\\n-1  2  -1\\\\\n0  -1  2\n\\end{pmatrix},\n$$\n因为 $h=\\frac{1}{4}$，所以 $\\frac{1}{h^{2}}=16$。子域雅可比块是主 $2\\times 2$ 子式\n$$\nR_{1}J(0)R_{1}^{\\top}=16\\begin{pmatrix}2  -1\\\\ -1  2\\end{pmatrix},\\qquad R_{2}J(0)R_{2}^{\\top}=16\\begin{pmatrix}2  -1\\\\ -1  2\\end{pmatrix}.\n$$\n\n对于给定的方向 $v=\\begin{pmatrix}1  2  -1\\end{pmatrix}^{\\top}$，计算全局积\n$$\nJ(0)\\,v=16\\begin{pmatrix}\n2\\cdot 1+(-1)\\cdot 2+0\\cdot(-1)\\\\\n(-1)\\cdot 1+2\\cdot 2+(-1)\\cdot(-1)\\\\\n0\\cdot 1+(-1)\\cdot 2+2\\cdot(-1)\n\\end{pmatrix}=16\\begin{pmatrix}0\\\\4\\\\-4\\end{pmatrix}=\\begin{pmatrix}0\\\\64\\\\-64\\end{pmatrix}.\n$$\n限制到每个子域：\n$$\nR_{1}J(0)v=\\begin{pmatrix}0\\\\64\\end{pmatrix},\\qquad R_{2}J(0)v=\\begin{pmatrix}64\\\\-64\\end{pmatrix}.\n$$\n使用 $\\begin{pmatrix}2  -1\\\\ -1  2\\end{pmatrix}^{-1}=\\frac{1}{3}\\begin{pmatrix}2  1\\\\ 1  2\\end{pmatrix}$ 对子域块求逆：\n$$\n\\big(R_{1}J(0)R_{1}^{\\top}\\big)^{-1}=\\frac{1}{16}\\cdot\\frac{1}{3}\\begin{pmatrix}2  1\\\\ 1  2\\end{pmatrix}=\\frac{1}{48}\\begin{pmatrix}2  1\\\\ 1  2\\end{pmatrix},\n$$\n对于 $R_{2}J(0)R_{2}^{\\top}$ 也类似。因此，校正量的局部方向导数为\n$$\nD\\delta u_{1}(u)\\cdot v=-\\frac{1}{48}\\begin{pmatrix}2  1\\\\ 1  2\\end{pmatrix}\\begin{pmatrix}0\\\\64\\end{pmatrix}=-\\frac{1}{48}\\begin{pmatrix}64\\\\128\\end{pmatrix}=\\begin{pmatrix}-\\frac{4}{3}\\\\-\\frac{8}{3}\\end{pmatrix},\n$$\n$$\nD\\delta u_{2}(u)\\cdot v=-\\frac{1}{48}\\begin{pmatrix}2  1\\\\ 1  2\\end{pmatrix}\\begin{pmatrix}64\\\\-64\\end{pmatrix}=-\\frac{1}{48}\\begin{pmatrix}64\\\\-64\\end{pmatrix}=\\begin{pmatrix}-\\frac{4}{3}\\\\\\frac{4}{3}\\end{pmatrix}.\n$$\n用受限的 $P_{i}$ 进行延拓得到\n$$\nP_{1}\\big(D\\delta u_{1}(u)\\cdot v\\big)=\\begin{pmatrix}-\\frac{4}{3}\\\\-\\frac{8}{3}\\\\0\\end{pmatrix},\\qquad\nP_{2}\\big(D\\delta u_{2}(u)\\cdot v\\big)=\\begin{pmatrix}0\\\\0\\\\\\frac{4}{3}\\end{pmatrix}.\n$$\n因此，\n$$\nJ_{M}(u)v=\\sum_{i=1}^{2}P_{i}\\big(D\\delta u_{i}(u)\\cdot v\\big)=\\begin{pmatrix}-\\frac{4}{3}\\\\-\\frac{8}{3}\\\\\\frac{4}{3}\\end{pmatrix}.\n$$\n最后，所求的瑞利商为\n$$\nq(v;u)=v^{\\top}\\big(J_{M}(u)v\\big)=\\begin{pmatrix}1  2  -1\\end{pmatrix}\\begin{pmatrix}-\\frac{4}{3}\\\\-\\frac{8}{3}\\\\\\frac{4}{3}\\end{pmatrix}=-\\frac{4}{3}-\\frac{16}{3}-\\frac{4}{3}=-\\frac{24}{3}=-8.\n$$\n这个值是精确的，并且不依赖于 $\\alpha$，这与推导出的作用中所有雅可比矩阵都是在指定 $u$ 的零状态下求值的事实相符。",
            "answer": "$$\\boxed{-8}$$"
        }
    ]
}