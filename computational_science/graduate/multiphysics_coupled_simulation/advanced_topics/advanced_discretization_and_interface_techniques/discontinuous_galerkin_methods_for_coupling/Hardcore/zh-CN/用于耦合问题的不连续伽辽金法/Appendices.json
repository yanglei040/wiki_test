{
    "hands_on_practices": [
        {
            "introduction": "在间断伽辽金（DG）方法中，数值通量是连接单元边界并确保稳定性的核心机制。本练习将通过一个经典的非线性守恒律——伯格斯方程（Burgers' equation），来深入探讨哥德诺夫（Godunov）通量，它通过求解局部黎曼问题得到，并引入物理耗散以保证格式的稳定性。这是一个基础性的“纸笔”练习，旨在帮助你理解DG方法如何处理间断和确保解的物理正确性。",
            "id": "3401198",
            "problem": "考虑标量守恒律伯格斯方程 $u_{t} + (f(u))_{x} = 0$，其中 $f(u) = \\frac{u^{2}}{2}$。在一维间断伽辽金（DG）方法中，单元间的耦合是通过每个界面上的数值通量来实现的。戈杜诺夫数值通量的定义是：对于初始数据 $u(x,0) = u^{-}$（当 $x0$ 时）和 $u(x,0) = u^{+}$（当 $x>0$ 时），在界面 $x=0$ 处，取精确自相似黎曼解的状态所对应的物理通量值。从标量守恒律的基本原理出发，即 (i) 适用于激波的郎肯-雨果尼奥跳跃条件，(ii) 适用于允许间断的拉克斯熵条件，以及 (iii) 适用于稀疏波的特征线法，推导伯格斯方程的戈杜诺夫通量 $F_{G}(u^{-},u^{+})$ 关于 $u^{-}$ 和 $u^{+}$ 的显式解析表达式。然后，解释在DG方法中于界面处使用此通量如何产生一个离散熵（二次熵）不等式，并通过耗散单元间的跳跃来稳定半离散格式。\n\n你的最终答案必须是 $F_{G}(u^{-},u^{+})$ 的单一闭式解析表达式。无需进行数值计算。",
            "solution": "该问题要求推导伯格斯方程的戈杜诺夫数值通量，然后解释其在间断伽辽金（DG）框架中确保熵稳定性的作用。\n\n我们所考虑的标量守恒律是伯格斯方程：\n$$\nu_{t} + \\left(\\frac{u^2}{2}\\right)_x = 0\n$$\n其中通量函数为 $f(u) = \\frac{u^2}{2}$。特征速度由 $c(u) = f'(u) = u$ 给出。\n\n戈杜诺夫数值通量 $F_{G}(u^{-},u^{+})$ 定义为在界面位置 $x=0$ 处，黎曼问题的自相似解所对应的物理通量值。该黎曼问题由以下初始条件定义：\n$$\nu(x,0) = \\begin{cases} u^{-},  x  0 \\\\ u^{+},  x > 0 \\end{cases}\n$$\n此问题的解 $u(x,t)$ 是相似变量 $\\xi = x/t$ 的函数。因此，戈杜诺夫通量为 $F_{G}(u^{-},u^{+}) = f(u(0,t)) = f(u(\\xi=0))$。我们必须根据 $u^{-}$ 和 $u^{+}$ 之间的关系来分析该解。\n\n**第一部分：戈杜诺夫通量 $F_{G}(u^{-},u^{+})$ 的推导**\n\n黎曼解的性质取决于特征线是发散还是汇聚。\n\n**情况1：稀疏波 ($u^{-}  u^{+}$)**\n速度为 $c(u)=u$ 的特征线从原点发散，形成一个称为稀疏波的连续解。该解由下式给出：\n$$\nu(x,t) = \\begin{cases} u^{-},  x/t  u^{-} \\\\ x/t,  u^{-} \\le x/t \\le u^{+} \\\\ u^{+},  x/t > u^{+} \\end{cases}\n$$\n界面处的状态 $u(\\xi=0)$ 是通过计算该解在 $x/t=0$ 处的值得到的。\n- 如果 $u^{-}  0  u^{+}$，界面状态为 $u(0,t)=0$。通量为 $F_{G} = f(0) = 0$。\n- 如果 $0 \\le u^{-}  u^{+}$，特征线具有正速度，因此它们都向右移动。$x0$ 的区域保持状态 $u^{-}$，因此界面状态为 $u(0,t)=u^{-}$。通量为 $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$。\n- 如果 $u^{-}  u^{+} \\le 0$，特征线具有负速度，因此它们都向左移动。$x>0$ 的区域保持状态 $u^{+}$，因此界面状态为 $u(0,t)=u^{+}$。通量为 $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$。\n\n这三种稀疏波的子情况可以优雅地总结。通量函数 $f(u) = u^2/2$ 是凸函数，在 $u=0$ 处有全局最小值。稀疏波情况下的戈杜诺夫通量值对应于在区间 $[u^{-}, u^{+}]$ 上使 $f(u)$ 最小的点处的物理通量值。即，对于 $u^{-}  u^{+}$，\n$$\nF_{G}(u^{-},u^{+}) = \\min_{u \\in [u^{-}, u^{+}]} f(u)\n$$\n\n**情况2：激波 ($u^{-} > u^{+}$)**\n特征线汇聚，导致形成不连续面，即激波。此激波的速度 $s$ 由郎肯-雨果尼奥跳跃条件确定：\n$$\ns = \\frac{[f]}{[u]} = \\frac{f(u^{+}) - f(u^{-})}{u^{+} - u^{-}}\n$$\n对于伯格斯方程，这得到：\n$$\ns = \\frac{\\frac{(u^{+})^2}{2} - \\frac{(u^{-})^2}{2}}{u^{+} - u^{-}} = \\frac{(u^{+} - u^{-})(u^{+} + u^{-})}{2(u^{+} - u^{-})} = \\frac{u^{-} + u^{+}}{2}\n$$\n一个激波只有在满足拉克斯熵条件时才是物理上允许的，该条件规定特征线必须从两侧进入激波：$f'(u^{-}) > s > f'(u^{+})$。对于伯格斯方程，即为 $u^{-} > s > u^{+}$。\n- $u^{-} > \\frac{u^{-} + u^{+}}{2} \\implies 2u^{-} > u^{-} + u^{+} \\implies u^{-} > u^{+}$\n- $\\frac{u^{-} + u^{+}}{2} > u^{+} \\implies u^{-} + u^{+}> 2u^{+} \\implies u^{-} > u^{+}$\n对于任何 $u^{-} > u^{+}$，该条件都满足，因此所有此类激波都是允许的。\n\n界面 $x=0$ 处的状态取决于激波传播的方向，该方向由 $s$ 的符号决定。\n- 如果 $s > 0$（即 $u^{-} + u^{+} > 0$），激波向右传播。对于 $t>0$， $x=0$ 处的状态是左状态 $u^{-}$。通量为 $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$。\n- 如果 $s \\le 0$（即 $u^{-} + u^{+} \\le 0$），激波向左传播。对于 $t>0$， $x=0$ 处的状态是右状态 $u^{+}$。通量为 $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$。\n- 如果 $s = 0$（即 $u^{-} + u^{+} = 0$），激波在 $x=0$ 处是静止的。郎肯-雨果尼奥条件意味着 $f(u^{+}) - f(u^{-}) = 0$，所以 $f(u^{-}) = f(u^{+})$。通量在激波两侧是连续的，我们可以取任意一侧的值。注意 $f(u^{-}) = f(-u^{+}) = \\frac{(-u^{+})^2}{2} = \\frac{(u^{+})^2}{2} = f(u^{+})$。我们对 $s \\le 0$ 的约定正确地选择了 $f(u^{+})$。\n\n我们可以用一种紧凑的形式来表示激波的这些子情况。$f(u^{-}) - f(u^{+}) = \\frac{1}{2}(u^{-}-u^{+})(u^{-}+u^{+})$ 的符号取决于 $u^{-}+u^{+}$ 的符号，因为 $u^{-}-u^{+}>0$。\n- 如果 $u^{-}+u^{+} > 0$，则 $f(u^{-}) > f(u^{+})$，所以 $F_{G} = f(u^{-}) = \\max(f(u^{-}), f(u^{+}))$。\n- 如果 $u^{-}+u^{+} \\le 0$，则 $f(u^{-}) \\le f(u^{+})$，所以 $F_{G} = f(u^{+}) = \\max(f(u^{-}), f(u^{+}))$。\n由于 $f(u)=u^2/2$ 是凸函数，其在区间 $[u^{+}, u^{-}]$ 上的最大值必定出现在端点处。因此，对于 $u^{-} > u^{+}$，\n$$\nF_{G}(u^{-},u^{+}) = \\max(f(u^{-}), f(u^{+}))\n$$\n\n**$F_{G}(u^{-},u^{+})$ 的显式解析表达式**\n综合所有情况，我们得到伯格斯方程的戈杜诺夫通量的显式分段定义：\n$$\nF_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right),  \\text{if } u^{-} > u^{+} \\\\ \\frac{(u^{-})^2}{2},  \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0,  \\text{if } u^{-}  0  u^{+} \\\\ \\frac{(u^{+})^2}{2},  \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}\n$$\n注意 $u^{-}=u^{+}$ 的情况是一致的，因为 $F_G(u,u) = f(u)$。\n\n**第二部分：熵稳定性与格式稳定**\n\n在DG格式中使用戈杜诺夫通量可确保满足熵不等式的离散版本，从而保证半离散格式的非线性稳定性。\n\n对于一个凸熵函数 $U(u)$ 和相应的熵通量 $Q(u)$（其中 $Q'(u) = U'(u)f'(u)$），连续熵不等式为 $U(u)_t + Q(u)_x \\le 0$。对于伯格斯方程，二次熵为 $U(u) = u^2/2$，其对应的 $U'(u)=u$，熵通量为 $Q(u) = u^3/3$。\n\n在DG格式中，将所有单元上的局部弱形式相加，并选择测试函数 $v_h = U'(u_h) = u_h$，会得到总熵 $\\mathcal{E}(t) = \\int_{\\Omega} U(u_h) dx$ 的演化方程。总熵的变化率由每个单元间界面的贡献之和决定。状态 $u^{-}$ 和 $u^{+}$ 之间界面的贡献是数值熵耗散：\n$$\n\\mathcal{D}(u^{-}, u^{+}) = F_G(u^{-}, u^{+}) [U'] - [Q] = F_G(u^{-}, u^{+})(u^{+} - u^{-}) - \\left(\\frac{(u^{+})^3}{3} - \\frac{(u^{-})^3}{3}\\right)\n$$\n如果该项在每个界面上都非正，即 $\\mathcal{D}(u^{-}, u^{+}) \\le 0$，则半离散格式是熵稳定的。这将意味着 $\\frac{d\\mathcal{E}}{dt} \\le 0$。\n\n戈杜诺夫通量是一种“E-通量”，这是一类已知的满足熵条件的数值通量。一个E-通量满足属性 $(u^{-} - u^{+})(F_G(u^{-},u^{+}) - f(u)) \\ge 0$，对于 $u^{-}$ 和 $u^{+}$ 之间路径上的所有 $u$ 值均成立。可以证明，戈杜诺夫通量是一个E-通量，它确保了数值熵耗散项 $\\mathcal{D}(u^{-}, u^{+})$ 在每个界面上都是非正的，从而保证了总熵随时间不增，使半离散格式稳定。",
            "answer": "$$\n\\boxed{F_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right),  \\text{if } u^{-} > u^{+} \\\\ \\frac{(u^{-})^2}{2},  \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0,  \\text{if } u^{-}  0  u^{+} \\\\ \\frac{(u^{+})^2}{2},  \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}}\n$$"
        },
        {
            "introduction": "“人造解方法”（Method of Manufactured Solutions, MMS）是验证数值代码正确性和收敛阶的黄金标准。本练习将提供构造一个非平凡“精确解”的实践机会，该解用于一个耦合的多物理场问题。通过精确满足边界和界面耦合条件，这个构造出的人造解可以被用来严格测试DG方法中界面耦合条件的实现是否准确无误。",
            "id": "3504002",
            "problem": "考虑一个定义在复合域 $\\Omega = \\Omega_{1} \\cup \\Omega_{2}$ 上的一维双场扩散模型，其中 $\\Omega_{1} = [-1,0]$ 且 $\\Omega_{2} = [0,1]$。每个子域承载一个标量场 $u_{i}(x)$，该场由稳态扩散-反应方程控制：\n$$\n- \\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(k_{i}\\,\\frac{\\mathrm{d}u_{i}}{\\mathrm{d}x}\\right) + r_{i}\\,u_{i} = f_{i}(x) \\quad \\text{在 } \\Omega_{i} \\text{ 中}, \\quad i \\in \\{1,2\\},\n$$\n其中 $k_{i} > 0$ 是恒定扩散系数，$r_{i} \\ge 0$ 是恒定反应系数。在界面 $x=0$ 处，两个场通过一个线性的 Robin 型条件进行交换，该条件以界面传导系数 $h>0$ 强制实现通量连续：\n$$\n- k_{1}\\,u_{1}'(0^{-}) \\,=\\, h\\big(u_{1}(0) - u_{2}(0)\\big), \n\\qquad\nk_{2}\\,u_{2}'(0^{+}) \\,=\\, h\\big(u_{1}(0) - u_{2}(0)\\big).\n$$\n在外部边界上，施加 Dirichlet 条件 $u_{1}(-1) = 0.3$ 和 $u_{2}(1) = -0.1$。您的任务是构造一对精确满足这些界面和边界条件的人造解，以便用于验证一个间断伽辽金 (DG) 耦合方法（例如，对称内部罚分 (SIPG) 格式）在异质子域间的通量一致性和罚参数缩放特性。\n\n设扩散系数和界面传导系数固定为 $k_{1} = 2$、$k_{2} = 5$ 和 $h = 4$。考虑以下带有未知常数 $A, B, C, D$ 的人造解拟设：\n$$\nu_{1}(x) = \\exp(x) + A\\,x + C \\quad \\text{对于 } x \\in [-1,0], \n\\qquad\nu_{2}(x) = \\cosh(x) + B\\,x + D \\quad \\text{对于 } x \\in [0,1].\n$$\n确定唯一的常数 $A, B, C, D$，使得在 $x=0$ 处的界面交换条件以及在 $x=-1$ 和 $x=1$ 处的边界条件精确成立。这些值定义了一对人造交叉耦合解，适用于关于界面通量一致性和罚参数缩放的 DG 验证研究。\n\n答案格式要求：将最终结果以单行矩阵 $\\big[A \\;\\; B \\;\\; C \\;\\; D\\big]$ 的形式给出。无需进行数值计算；请报告精确表达式。",
            "solution": "用户要求我解决一个涉及为双场扩散模型构造人造解的问题。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n\n-   **域**: $\\Omega = \\Omega_{1} \\cup \\Omega_{2}$，其中 $\\Omega_{1} = [-1,0]$ 和 $\\Omega_{2} = [0,1]$。\n-   **控制方程**:\n    $$\n    - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(k_{i}\\,\\frac{\\mathrm{d}u_{i}}{\\mathrm{d}x}\\right) + r_{i}\\,u_{i} = f_{i}(x) \\quad \\text{在 } \\Omega_{i} \\text{ 中}, \\quad i \\in \\{1,2\\}\n    $$\n-   **系数**:\n    -   扩散系数: $k_{1} = 2$, $k_{2} = 5$。\n    -   反应系数: $r_{i} \\ge 0$。\n    -   界面传导系数: $h = 4$。\n-   **$x=0$ 处的界面条件**:\n    $$\n    - k_{1}\\,u_{1}'(0^{-}) \\,=\\, h\\big(u_{1}(0) - u_{2}(0)\\big) \\\\\n    k_{2}\\,u_{2}'(0^{+}) \\,=\\, h\\big(u_{1}(0) - u_{2}(0)\\big)\n    $$\n-   **外部边界条件**:\n    -   $u_{1}(-1) = 0.3$\n    -   $u_{2}(1) = -0.1$\n-   **人造解拟设**:\n    $$\n    u_{1}(x) = \\exp(x) + A\\,x + C \\quad \\text{对于 } x \\in [-1,0] \\\\\n    u_{2}(x) = \\cosh(x) + B\\,x + D \\quad \\text{对于 } x \\in [0,1]\n    $$\n-   **未知数**: 常数 $A, B, C, D$。\n\n#### 步骤2：使用提取的已知条件进行验证\n\n对问题的有效性进行严格评估。\n\n1.  **科学上合理**: 该问题基于成熟的扩散-反应现象物理学和界面耦合的标准数学描述（Robin 型条件）。人造解的概念是人造解方法（MMS）的基石，这是一种用于计算科学与工程领域软件验证的严谨技术。该问题在科学和数学上是合理的。\n2.  **适定的**: 任务是通过应用四个独立的线性条件（两个边界条件和两个界面条件）来确定四个未知常数（$A, B, C, D$）。这种设置会得到一个 $4 \\times 4$ 的线性方程组。如下文所示，该系统非奇异，因此存在唯一解。该问题是适定的。\n3.  **客观的**: 问题以精确、无歧义的数学语言陈述。所有参数、函数和条件都已明确定义。不存在主观或基于观点的陈述。\n4.  **完整且一致**: 求解这些常数所需的所有必要信息（参数 $k_1, k_2, h$；边界值；拟设的函数形式）均已提供。设置中没有矛盾之处。请注意，问题正确地没有要求 $r_i$ 或 $f_i(x)$ 的知识，因为这些是在人造解 $u_i(x)$ 完全确定*之后*才确定的。\n5.  **相关的**: 该问题与指定主题“间断伽辽金耦合方法”直接相关，因为在此类问题上验证数值方法是一项标准且关键的任务。\n\n#### 步骤3：结论与行动\n\n问题陈述是**有效的**。它在科学上是合理的，是适定的，并包含了进行求解所需的所有必要信息。\n\n### 求解\n\n目标是找到唯一的常数 $A, B, C, D$，使其满足给定人造解形式的边界和界面条件。\n\n人造解为：\n$$\nu_{1}(x) = \\exp(x) + A\\,x + C \\\\\nu_{2}(x) = \\cosh(x) + B\\,x + D\n$$\n它们的导数为：\n$$\nu_{1}'(x) = \\exp(x) + A \\\\\nu_{2}'(x) = \\sinh(x) + B\n$$\n我们应用四个给定条件，推导出一个关于 $A, B, C, D$ 的线性方程组。\n\n1.  **$x=-1$ 处的边界条件**：\n    $u_{1}(-1) = 0.3 = \\frac{3}{10}$。\n    $$\n    \\exp(-1) - A + C = \\frac{3}{10} \\implies -A + C = \\frac{3}{10} - \\exp(-1) \\quad \\text{(I)}\n    $$\n\n2.  **$x=1$ 处的边界条件**：\n    $u_{2}(1) = -0.1 = -\\frac{1}{10}$。\n    $$\n    \\cosh(1) + B + D = -\\frac{1}{10} \\implies B + D = -\\frac{1}{10} - \\cosh(1) \\quad \\text{(II)}\n    $$\n\n3.  **$x=0$ 处的第一个界面条件**：\n    $- k_{1}\\,u_{1}'(0) = h\\big(u_{1}(0) - u_{2}(0)\\big)$，其中 $k_{1}=2$ 且 $h=4$。\n    首先，计算在 $x=0$ 处的各项值：\n    $u_{1}(0) = \\exp(0) + A(0) + C = 1+C$\n    $u_{2}(0) = \\cosh(0) + B(0) + D = 1+D$\n    $u_{1}'(0) = \\exp(0) + A = 1+A$\n    将这些代入条件：\n    $$\n    -2(1+A) = 4\\big((1+C) - (1+D)\\big) \\\\\n    -2(1+A) = 4(C-D) \\\\\n    -(1+A) = 2(C-D) \\implies A + 2C - 2D = -1 \\quad \\text{(III)}\n    $$\n\n4.  **$x=0$ 处的第二个界面条件**：\n    $k_{2}\\,u_{2}'(0) = h\\big(u_{1}(0) - u_{2}(0)\\big)$，其中 $k_{2}=5$ 且 $h=4$。\n    我们需要导数 $u_{2}'(0)$：\n    $u_{2}'(0) = \\sinh(0) + B = B$。\n    将这些代入条件：\n    $$\n    5B = 4\\big((1+C) - (1+D)\\big) \\\\\n    5B = 4(C-D) \\implies 5B - 4C + 4D = 0 \\quad \\text{(IV)}\n    $$\n\n我们现在得到一个包含四个线性方程的方程组：\n(I)   $-A + C = \\frac{3}{10} - \\exp(-1)$\n(II)  $B + D = -\\frac{1}{10} - \\cosh(1)$\n(III) $A + 2C - 2D = -1$\n(IV)  $5B - 4C + 4D = 0$\n\n从(III)和(IV)可得 $2(-1-A) = 5B$，简化为：\n$$\n2A + 5B = -2 \\quad \\text{(V)}\n$$\n现在，我们根据(I)式和(II)式，用 A 和 B 表示 C 和 D：\n$C = A + \\frac{3}{10} - \\exp(-1)$\n$D = -B - \\frac{1}{10} - \\cosh(1)$\n\n将这些代入方程(III) $A + 2C - 2D = -1$：\n$A + 2(A+\\frac{3}{10}-\\exp(-1)) - 2(-B-\\frac{1}{10}-\\cosh(1)) = -1$\n$A + 2A + \\frac{6}{10} - 2\\exp(-1) + 2B + \\frac{2}{10} + 2\\cosh(1) = -1$\n$3A + 2B + \\frac{8}{10} - 2\\exp(-1) + 2\\cosh(1) = -1$\n$3A + 2B = -1 - \\frac{4}{5} + 2\\exp(-1) - 2\\cosh(1)$\n$$3A + 2B = -\\frac{9}{5} + 2\\exp(-1) - 2\\cosh(1) \\quad \\text{(VI')}$$\n我们现在求解方程组：\n(V)   $2A + 5B = -2$\n(VI') $3A + 2B = -\\frac{9}{5} + 2\\exp(-1) - 2\\cosh(1)$\n\n将(V)式乘以3，(VI')式乘以-2：\n$6A + 15B = -6$\n$-6A - 4B = \\frac{18}{5} - 4\\exp(-1) + 4\\cosh(1)$\n将这两个方程相加：\n$11B = -6 + \\frac{18}{5} - 4\\exp(-1) + 4\\cosh(1)$\n$11B = -\\frac{30}{5} + \\frac{18}{5} - 4\\exp(-1) + 4\\cosh(1)$\n$11B = -\\frac{12}{5} - 4\\exp(-1) + 4\\cosh(1)$\n$$B = -\\frac{12}{55} - \\frac{4}{11}\\exp(-1) + \\frac{4}{11}\\cosh(1)$$\n将(V)式乘以2，(VI')式乘以-5：\n$4A + 10B = -4$\n$-15A - 10B = 9 - 10\\exp(-1) + 10\\cosh(1)$\n将这两个方程相加：\n$-11A = -4 + 9 - 10\\exp(-1) + 10\\cosh(1)$\n$-11A = 5 - 10\\exp(-1) + 10\\cosh(1)$\n$$A = -\\frac{5}{11} + \\frac{10}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1)$$\n现在我们求解 C 和 D。\n$C = A + \\frac{3}{10} - \\exp(-1)$\n$C = -\\frac{5}{11} + \\frac{10}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1) + \\frac{3}{10} - \\exp(-1)$\n$C = (-\\frac{5}{11} + \\frac{3}{10}) + (\\frac{10}{11} - 1)\\exp(-1) - \\frac{10}{11}\\cosh(1)$\n$C = \\frac{-50+33}{110} - \\frac{1}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1)$\n$$C = -\\frac{17}{110} - \\frac{1}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1)$$\n$D = -B - \\frac{1}{10} - \\cosh(1)$\n$D = -(-\\frac{12}{55} - \\frac{4}{11}\\exp(-1) + \\frac{4}{11}\\cosh(1)) - \\frac{1}{10} - \\cosh(1)$\n$D = \\frac{12}{55} + \\frac{4}{11}\\exp(-1) - \\frac{4}{11}\\cosh(1) - \\frac{1}{10} - \\cosh(1)$\n$D = (\\frac{12}{55} - \\frac{1}{10}) + \\frac{4}{11}\\exp(-1) + (-\\frac{4}{11} - 1)\\cosh(1)$\n$D = (\\frac{24-11}{110}) + \\frac{4}{11}\\exp(-1) - \\frac{15}{11}\\cosh(1)$\n$$D = \\frac{13}{110} + \\frac{4}{11}\\exp(-1) - \\frac{15}{11}\\cosh(1)$$\n因此，唯一的常数是：\n$A = -\\frac{5}{11} + \\frac{10}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1)$\n$B = -\\frac{12}{55} - \\frac{4}{11}\\exp(-1) + \\frac{4}{11}\\cosh(1)$\n$C = -\\frac{17}{110} - \\frac{1}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1)$\n$D = \\frac{13}{110} + \\frac{4}{11}\\exp(-1) - \\frac{15}{11}\\cosh(1)$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{5}{11} + \\frac{10}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1)  -\\frac{12}{55} - \\frac{4}{11}\\exp(-1) + \\frac{4}{11}\\cosh(1)  -\\frac{17}{110} - \\frac{1}{11}\\exp(-1) - \\frac{10}{11}\\cosh(1)  \\frac{13}{110} + \\frac{4}{11}\\exp(-1) - \\frac{15}{11}\\cosh(1) \\end{pmatrix} } $$"
        },
        {
            "introduction": "可杂交间断伽辽金（Hybridizable Discontinuous Galerkin, HDG）方法是一种先进的DG变体，它将全局耦合的自由度减少到网格骨架上，从而显著提高计算效率。本练习将深入分析HDG方法产生的线性系统的代数结构。你将探索如何利用这种独特的块状结构来设计基于舒尔补（Schur complement）的高效预条件子，这是区域分解和可扩展求解器中的一个关键概念。",
            "id": "3504028",
            "problem": "考虑一个定义在有界利普希茨域 $\\Omega \\subset \\mathbb{R}^{d}$ 上的稳态耦合扩散-反应模型，该域被划分为两个不重叠的子域 $\\Omega_{1}$ 和 $\\Omega_{2}$，公共界面为 $\\Gamma := \\partial \\Omega_{1} \\cap \\partial \\Omega_{2}$。每个子域的控制方程为通量守恒和线性反应：\n- 在 $\\Omega_{1}$ 上：$\\nabla \\cdot \\left(-\\kappa_{1} \\nabla u_{1}\\right) + \\alpha_{1} u_{1} = f_{1}$，\n- 在 $\\Omega_{2}$ 上：$\\nabla \\cdot \\left(-\\kappa_{2} \\nabla u_{2}\\right) + \\alpha_{2} u_{2} = f_{2}$，\n其中 $\\kappa_{i} > 0$ 是对称正定扩散张量，$\\alpha_{i} \\ge 0$ 是反应系数，$f_{i} \\in L^{2}(\\Omega_{i})$ 是源项。在界面 $\\Gamma$ 上，通过一个骨架迹场 $\\hat{u}$ 和大小为 $\\eta > 0$ 的数值通量稳定项来施加连续性条件：\n- 在 $\\Gamma$ 上（从 $\\Omega_{1}$ 侧）：$-\\kappa_{1} \\nabla u_{1} \\cdot n_{1} + \\eta \\left(u_{1} - \\hat{u}\\right) = 0$，\n- 在 $\\Gamma$ 上（从 $\\Omega_{2}$ 侧）：$-\\kappa_{2} \\nabla u_{2} \\cdot n_{2} + \\eta \\left(u_{2} - \\hat{u}\\right) = 0$，\n其中 $n_{i}$ 是 $\\Omega_{i}$ 在 $\\Gamma$ 上的单位外法向量。在 $\\partial \\Omega \\setminus \\Gamma$ 上，假设有与可杂交间断伽辽金 (HDG) 方法兼容的适当边界条件，此处无需明确给出。\n\n使用可杂交间断伽辽金 (HDG) 方法，在一个在 $\\Gamma$ 上匹配的协调单纯形网格上对该模型进行离散化。引入单元内部未知量 $u_{1}$ 和 $u_{2}$ 及其通量（统称为局部向量），以及存在于网格骨架（包括 $\\Gamma$）上的骨架迹未知量 $\\lambda$。在组装线性系统并对单元内部自由度进行静态凝聚后，全局耦合代数系统可以写成关于未知向量 $(x_{1}, x_{2}, y)$ 的以下分块形式，其中 $x_{i}$ 是 $\\Omega_{i}$ 上的凝聚内部向量，$y$ 是骨架迹自由度：\n$$\n\\begin{pmatrix}\nA_{1}  0  B_{1}^{\\top} \\\\\n0  A_{2}  B_{2}^{\\top} \\\\\nB_{1}  B_{2}  D\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1} \\\\\nx_{2} \\\\\ny\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb_{1} \\\\\nb_{2} \\\\\nc\n\\end{pmatrix},\n$$\n其中 $A_{i}$ 是子域局部的凝聚刚度矩阵（对称正定），$B_{i}$ 是局部到骨架的耦合矩阵，$D$ 是由数值通量和边界条件引起的骨架稳定化和界面耦合矩阵。假设所有分块矩阵维度兼容，且该系统是对称的。\n\n从控制偏微分方程和可杂交间断伽辽金 (HDG) 方法的定义出发，首先通过从局部变分问题和骨架耦合中识别每个分块的作用，推导出上述分块结构。然后，分析杂交化如何通过构造关于骨架迹未知量 $y$ 的精确舒尔补，来实现以界面为中心的预处理。利用此分析，提出一个利用 HDG 迹未知量的域-界面预条件子，该预条件子由精确的局域子域逆和精确的骨架舒尔补构成。将您提出的预条件子表示为关于 $A_{1}$、$A_{2}$、$B_{1}$、$B_{2}$ 和 $D$ 的单一闭式解析矩阵表达式。您的最终答案必须仅为此表达式。如果在推导过程中引入了辅助算子，请通过用给定的分块显式写出它们，在最终表达式中将其消去。无需进行数值近似。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n在域 $\\Omega \\subset \\mathbb{R}^{d}$ 的两个不重叠子域 $\\Omega_{1}$ 和 $\\Omega_{2}$ 上的控制偏微分方程为：\n- 在 $\\Omega_{1}$ 上：$\\nabla \\cdot \\left(-\\kappa_{1} \\nabla u_{1}\\right) + \\alpha_{1} u_{1} = f_{1}$，其中 $\\kappa_{1} > 0$ 是一个对称正定张量，$\\alpha_{1} \\ge 0$，$f_{1} \\in L^{2}(\\Omega_{1})$。\n- 在 $\\Omega_{2}$ 上：$\\nabla \\cdot \\left(-\\kappa_{2} \\nabla u_{2}\\right) + \\alpha_{2} u_{2} = f_{2}$，其中 $\\kappa_{2} > 0$ 是一个对称正定张量，$\\alpha_{2} \\ge 0$，$f_{2} \\in L^{2}(\\Omega_{2})$。\n\n在公共界面 $\\Gamma := \\partial \\Omega_{1} \\cap \\partial \\Omega_{2}$ 上的界面条件为：\n- 在 $\\Gamma$ 上（从 $\\Omega_{1}$ 侧）：$-\\kappa_{1} \\nabla u_{1} \\cdot n_{1} + \\eta \\left(u_{1} - \\hat{u}\\right) = 0$。\n- 在 $\\Gamma$ 上（从 $\\Omega_{2}$ 侧）：$-\\kappa_{2} \\nabla u_{2} \\cdot n_{2} + \\eta \\left(u_{2} - \\hat{u}\\right) = 0$。\n此处，$n_{i}$ 是 $\\Omega_{i}$ 的单位外法向量，$\\hat{u}$ 是一个骨架迹场，$\\eta > 0$ 是一个稳定化参数。\n\n通过 HDG 离散化，并在对单元内部自由度进行静态凝聚后得到的全局代数系统，以分块形式给出，其未知向量为 $(x_{1}, x_{2}, y)^{\\top}$：\n$$\n\\begin{pmatrix}\nA_{1}  0  B_{1}^{\\top} \\\\\n0  A_{2}  B_{2}^{\\top} \\\\\nB_{1}  B_{2}  D\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1} \\\\\nx_{2} \\\\\ny\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nb_{1} \\\\\nb_{2} \\\\\nc\n\\end{pmatrix}\n$$\n- $x_{i}$ 是 $\\Omega_{i}$ 上的凝聚内部向量。\n- $y$ 是骨架迹自由度。\n- $A_{i}$ 是子域局部的凝聚刚度矩阵，它们是对称正定的。\n- $B_{i}$ 是局部到骨架的耦合矩阵。\n- $D$ 是骨架稳定化和界面耦合矩阵。\n- 全局系统矩阵是对称的。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学基础**：该问题描述了一个耦合扩散-反应模型，这是众多STEM领域（包括热传导、化学工程和材料科学）中一个基础且广泛使用的系统。可杂交间断伽辽金 (HDG) 方法的使用是解决此类问题的标准、前沿的数值技术。界面条件是在间断伽辽金框架中弱施加连续性的一种行之有效的方法。该问题牢固地植根于连续介质力学和数值分析的原理之中。\n2.  **适定性**：该问题是适定的。关于矩阵的先验信息（$A_{i}$ 是对称正定，整个系统是对称的）与椭圆算子的HDG离散化性质是一致的。任务是推导和分析一个特定的代数结构，这将导出一个唯一的解析结果。\n3.  **客观性**：问题陈述使用了精确的数学和数值分析术语。所有术语在科学计算领域都是标准的。该任务是分析性的，不需要主观解释。\n4.  **完整性**：问题提供了执行推导和提出预条件子所需的所有必要信息。矩阵的分块结构及其各组成部分的属性都已明确给出。\n\n### 步骤 3：结论与行动\n该问题被判定为有效。它在科学上是合理的、适定的、客观的和完整的。我将继续进行推导和求解。\n\n该问题要求进行两部分的推导，然后构建一个预条件子。首先，我们阐明系统矩阵中各分块的来源和作用；其次，我们分析舒尔补；第三，我们构建预条件子。\n\n令全局系统矩阵表示为 $\\mathcal{A}$。\n$$\n\\mathcal{A} =\n\\begin{pmatrix}\nA_{1}  0  B_{1}^{\\top} \\\\\n0  A_{2}  B_{2}^{\\top} \\\\\nB_{1}  B_{2}  D\n\\end{pmatrix}\n$$\n未知量向量被划分为每个子域的内部未知量 $x_{1}$ 和 $x_{2}$，以及骨架迹未知量 $y$。\n\n**1. 矩阵分块的作用**\n\nHDG 方法通过在每个网格单元内为解及其通量引入独立的未知量，并在网格骨架（单元的面）上引入一个单值迹变量来离散化问题。\n- 矩阵 $A_{1}$ 和 $A_{2}$ 分别表示在每个子域 $\\Omega_1$ 和 $\\Omega_2$ 内离散化的偏微分算子。它们相对于网格单元是块对角的，这反映了单元内部的未知量仅与同一单元内的其他未知量耦合。$\\mathcal{A}$ 左上角 $2 \\times 2$ 部分的零块表示 $\\Omega_1$ 中的内部问题不直接与 $\\Omega_2$ 中的内部问题耦合；所有耦合都通过骨架进行。问题陈述 $A_i$ 是对称正定的，这是此类离散化的一个标准属性。\n- 矩阵 $B_{1}$ 和 $B_{2}$ (及其转置) 表示单元内部未知量 ($x_{i}$) 与骨架迹未知量 ($y$) 之间的耦合。这些分块源于弱形式中分部积分时出现的单元边界上的积分项。例如，它们将内部解和通量的迹与杂交迹变量 $\\hat{u}$ (由 $y$ 表示) 联系起来。\n- 矩阵 $D$ 表示骨架迹未知量之间的直接耦合。这些项源于在单元面之间施加的传输条件，包括通量连续性和在 $\\Gamma$ 上的特定界面条件。例如，当与迹测试函数进行测试时，$\\Gamma$ 上的罚项 $\\eta(u_i - \\hat{u})$ 贡献了仅涉及骨架未知量 $y$ 的项。\n\n**2. 杂交化与舒尔补**\n\nHDG 方法的关键优势，即“杂交化”，是单元内部未知量可以在局部被消除，这个过程称为静态凝聚。这导致一个仅关于骨架迹未知量 $y$ 的更小的全局系统。这从线性系统的前两个分块行中可以明显看出：\n$$ A_{1} x_{1} + B_{1}^{\\top} y = b_{1} $$\n$$ A_{2} x_{2} + B_{2}^{\\top} y = b_{2} $$\n由于矩阵 $A_{1}$ 和 $A_{2}$ 是可逆的 (因为它们是对称正定的)，我们可以用迹未知量 $y$ 来表示内部未知量 $x_{1}$ 和 $x_{2}$：\n$$ x_{1} = A_{1}^{-1} (b_{1} - B_{1}^{\\top} y) $$\n$$ x_{2} = A_{2}^{-1} (b_{2} - B_{2}^{\\top} y) $$\n$A_i$ 的求逆在计算上是廉价的，因为它对应于在每个网格单元上求解小的、独立的线性系统。\n\n将这些表达式代入第三个分块行 $B_{1} x_{1} + B_{2} x_{2} + D y = c$ 中，得到：\n$$ B_{1} \\left( A_{1}^{-1} (b_{1} - B_{1}^{\\top} y) \\right) + B_{2} \\left( A_{2}^{-1} (b_{2} - B_{2}^{\\top} y) \\right) + D y = c $$\n重新整理各项以分离出未知向量 $y$，得到舒尔补系统：\n$$ \\left( D - B_{1} A_{1}^{-1} B_{1}^{\\top} - B_{2} A_{2}^{-1} B_{2}^{\\top} \\right) y = c - B_{1} A_{1}^{-1} b_{1} - B_{2} A_{2}^{-1} b_{2} $$\n令 $S = D - B_{1} A_{1}^{-1} B_{1}^{\\top} - B_{2} A_{2}^{-1} B_{2}^{\\top}$ 为舒尔补矩阵。原始大系统的求解被简化为求解关于界面未知量的更小、更稠密的系统 $S y = \\tilde{c}$，然后通过局部的、可并行的回代来恢复内部解 $x_1$ 和 $x_2$。这种“以界面为中心”的过程是区域分解方法的核心。\n\n**3. 域-界面预条件子**\n\n问题要求为完整系统 $\\mathcal{A}$ 构建一个预条件子，该预条件子由精确的局部逆 $A_{i}^{-1}$ 和精确的舒尔补 $S$ 构成。一个理想的预条件子 $\\mathcal{P}$ 是 $\\mathcal{A}$ 的一个近似，且其求逆要容易得多。对于此类鞍点系统，一类高效的预条件子是基于 $\\mathcal{A}$ 的分块 LDU 分解。\n\n$\\mathcal{A}$ 的精确分块 LDU 分解为 $\\mathcal{A} = L \\Delta U$，其中：\n$$\nL = \\begin{pmatrix} I  0  0 \\\\ 0  I  0 \\\\ B_{1} A_{1}^{-1}  B_{2} A_{2}^{-1}  I \\end{pmatrix},\n\\quad\n\\Delta = \\begin{pmatrix} A_{1}  0  0 \\\\ 0  A_{2}  0 \\\\ 0  0  S \\end{pmatrix},\n\\quad\nU = \\begin{pmatrix} I  0  A_{1}^{-1}B_{1}^{\\top} \\\\ 0  I  A_{2}^{-1}B_{2}^{\\top} \\\\ 0  0  I \\end{pmatrix}\n$$\n一个强大的预条件子可以通过取该分解的一部分来构成。一个标准的选择是分块上三角矩阵 $\\mathcal{P} = \\Delta U$。这个预条件子在前两个分块行中是精确的，并在第三个分块行中使用精确的舒尔补。\n$$\n\\mathcal{P} = \\Delta U = \\begin{pmatrix} A_{1}  0  0 \\\\ 0  A_{2}  0 \\\\ 0  0  S \\end{pmatrix} \\begin{pmatrix} I  0  A_{1}^{-1}B_{1}^{\\top} \\\\ 0  I  A_{2}^{-1}B_{2}^{\\top} \\\\ 0  0  I \\end{pmatrix} = \\begin{pmatrix} A_{1}  0  B_{1}^{\\top} \\\\ 0  A_{2}  B_{2}^{\\top} \\\\ 0  0  S \\end{pmatrix}\n$$\n应用此预条件子得到 $\\mathcal{P}^{-1}\\mathcal{A} = U^{-1} \\Delta^{-1} (L \\Delta U) = (U^{-1}L) U = L$。由于 $L$ 是一个对角线上为 1 的下三角矩阵，预处理系统 $\\mathcal{P}^{-1} \\mathcal{A} z = d$ 的迭代求解器会非常快速地收敛。\n\n最后一步是通过代入舒尔补 $S$ 的表达式，将预条件子 $\\mathcal{P}$ 写成关于给定分块 $A_1, A_2, B_1, B_2, D$ 的单一矩阵表达式。\n\n所提出的预条件子是：\n$$\n\\mathcal{P} =\n\\begin{pmatrix}\nA_{1}  0  B_{1}^{\\top} \\\\\n0  A_{2}  B_{2}^{\\top} \\\\\n0  0  D - B_{1} A_{1}^{-1} B_{1}^{\\top} - B_{2} A_{2}^{-1} B_{2}^{\\top}\n\\end{pmatrix}\n$$\n该矩阵表达式满足了问题的所有要求。它是一个域-界面预条件子的闭式解析表达式，由精确的局部子域逆和精确的骨架舒尔补构成。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nA_{1}  0  B_{1}^{\\top} \\\\\n0  A_{2}  B_{2}^{\\top} \\\\\n0  0  D - B_{1} A_{1}^{-1} B_{1}^{\\top} - B_{2} A_{2}^{-1} B_{2}^{\\top}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}