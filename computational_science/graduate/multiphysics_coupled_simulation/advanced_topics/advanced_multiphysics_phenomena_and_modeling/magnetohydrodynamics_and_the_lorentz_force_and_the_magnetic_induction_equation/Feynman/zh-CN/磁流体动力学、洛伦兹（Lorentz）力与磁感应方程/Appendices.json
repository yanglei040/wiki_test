{
    "hands_on_practices": [
        {
            "introduction": "磁流体动力学（MHD）方程组描述了多种波动现象，例如阿尔芬波和磁声波，它们是等离子体和导电流体中能量传输的基本机制。然而，当使用数值方法求解这些方程时，离散化过程会不可避免地引入误差，导致数值色散和各向异性。这项练习旨在通过实践，量化这些在模拟MHD波时产生的数值误差，帮助你深入理解不同数值格式如何影响波的传播速度和方向。",
            "id": "3343359",
            "problem": "考虑一个均匀平衡的线性化、无粘性、理想导电、可压缩的理想磁流体力学（MHD）系统，其具有均匀的质量密度 $ \\rho_0 $、压强 $ p_0 $ 和背景磁场矢量 $ \\mathbf{B}_0 $。设比热比为 $ \\gamma $，真空磁导率为 $ \\mu_0 $。在物理波矢为 $ \\mathbf{k} $、角频率为 $ \\omega $ 的平面波拟设下，Alfvén 波和磁声波的连续相速度由阿尔芬速度 $ V_A = \\|\\mathbf{B}_0\\| / \\sqrt{\\mu_0 \\rho_0} $ 和绝热声速 $ c_s = \\sqrt{\\gamma p_0 / \\rho_0} $ 定义。对于 $ \\mathbf{k} $ 和 $ \\mathbf{B}_0 $ 之间的夹角 $ \\theta $，沿着物理波矢方向的连续相速度为：\n- Alfvén 波：$ c_A^{\\text{exact}} = V_A \\cos \\theta $，\n- 快磁声波和慢磁声波：\n$$\nc_{f,s}^{\\text{exact}} = \\sqrt{ \\tfrac{1}{2} \\left( V_A^2 + c_s^2 \\pm \\sqrt{(V_A^2 + c_s^2)^2 - 4 V_A^2 c_s^2 \\cos^2 \\theta} \\right) }.\n$$\n\n在笛卡尔网格上的半离散空间离散化中，由于离散微分算子不能精确复现连续梯度算子 $ \\nabla $，会出现数值色散和各向异性。对于网格间距为 $ (\\Delta x, \\Delta y, \\Delta z) $ 的网格上的平面波 $ e^{i \\mathbf{k} \\cdot \\mathbf{x}} $，将连续符号 $ i \\mathbf{k} $ 替换为离散符号 $ i \\tilde{\\mathbf{k}} $，每个分量 $ \\tilde{k}_j $（对于 $ j \\in \\{x,y,z\\} $）由下式给出：\n- 二阶中心差分（CD2）：$ \\tilde{k}_j = \\dfrac{\\sin(k_j \\Delta_j)}{\\Delta_j} $，\n- 四阶中心差分（CD4）：$ \\tilde{k}_j = \\dfrac{8 \\sin(k_j \\Delta_j) - \\sin(2 k_j \\Delta_j)}{12 \\Delta_j} $。\n\n定义 $ \\hat{\\mathbf{b}} = \\mathbf{B}_0 / \\|\\mathbf{B}_0\\| $，精确波矢大小 $ \\|\\mathbf{k}\\| $，以及离散波矢大小 $ \\|\\tilde{\\mathbf{k}}\\| $。设 $ \\theta_{\\text{exact}} $ 为 $ \\mathbf{k} $ 与 $ \\mathbf{B}_0 $ 之间的夹角， $ \\theta_{\\text{num}} $ 为 $ \\tilde{\\mathbf{k}} $ 与 $ \\mathbf{B}_0 $ 之间的夹角。Alfvén 波的半离散角频率为 $ \\omega_A^{\\text{num}} = V_A (\\hat{\\mathbf{b}} \\cdot \\tilde{\\mathbf{k}}) $，由此得到沿物理波矢方向的数值相速度 $ c_A^{\\text{num}} = \\omega_A^{\\text{num}} / \\|\\mathbf{k}\\| $。对于磁声波，半离散角频率为 $ \\omega_{f,s}^{\\text{num}} = c_{f,s}(\\theta_{\\text{num}}) \\, \\|\\tilde{\\mathbf{k}}\\| $，其中 $ c_{f,s}(\\theta) $ 的函数形式与上文相同，但在 $ \\theta_{\\text{num}} $ 处求值。沿物理波矢方向的数值相速度为 $ c_{f,s}^{\\text{num}} = \\omega_{f,s}^{\\text{num}} / \\|\\mathbf{k}\\| $。\n\n定义归一化速度 $ c_{\\text{ref}} = \\max(V_A, c_s) $。需要报告的归一化相速度误差为：\n$$\n\\varepsilon_A = \\frac{c_A^{\\text{num}} - c_A^{\\text{exact}}}{c_{\\text{ref}}}, \\quad\n\\varepsilon_f = \\frac{c_f^{\\text{num}} - c_f^{\\text{exact}}}{c_{\\text{ref}}}, \\quad\n\\varepsilon_s = \\frac{c_s^{\\text{num}} - c_s^{\\text{exact}}}{c_{\\text{ref}}}.\n$$\n这些误差是无量纲的。最终结果中不需要物理单位。\n\n你的任务是实现一个程序，对以下测试套件中的每个案例计算 $ (\\varepsilon_A, \\varepsilon_f, \\varepsilon_s) $。在国际单位制（SI）中使用 $ \\mu_0 = 4 \\pi \\times 10^{-7} $。角度通过 $ \\mathbf{k} $ 和 $ \\mathbf{B}_0 $ 的分量直接指定；不要转换单位。\n\n测试套件（每个案例是一个参数元组 $ (\\rho_0, p_0, \\gamma, \\mathbf{B}_0, \\mathbf{k}, \\Delta x, \\Delta y, \\Delta z, \\text{scheme}) $）：\n1. $ (1.0, 1.0 \\times 10^5, 5/3, (0.5, 0.0, 0.0), (80 \\cos 35^\\circ, 80 \\sin 35^\\circ, 0.0), 0.02, 0.02, 0.02, \\text{CD2}) $，\n2. $ (1.0, 1.0 \\times 10^5, 5/3, (0.5, 0.0, 0.0), (80 \\cos 35^\\circ, 80 \\sin 35^\\circ, 0.0), 0.02, 0.02, 0.02, \\text{CD4}) $，\n3. $ (1.0, 1.0 \\times 10^5, 5/3, (0.5, 0.0, 0.0), (10 \\cos 60^\\circ, 10 \\sin 60^\\circ, 0.0), 0.02, 0.02, 0.02, \\text{CD2}) $，\n4. $ (1.0, 1.0 \\times 10^5, 5/3, (0.5, 0.0, 0.0), (10 \\cos 60^\\circ, 10 \\sin 60^\\circ, 0.0), 0.02, 0.02, 0.02, \\text{CD4}) $，\n5. $ (1.0, 1.0 \\times 10^5, 5/3, (0.5, 0.0, 0.0), (50 \\cos 60^\\circ, 50 \\sin 60^\\circ, 0.0), 0.05, 0.02, 0.02, \\text{CD2}) $，\n6. $ (1.0, 1.0 \\times 10^5, 5/3, (0.5, 0.0, 0.0), (50 \\cos 60^\\circ, 50 \\sin 60^\\circ, 0.0), 0.05, 0.02, 0.02, \\text{CD4}) $，\n7. $ (1.0, 1.0 \\times 10^5, 5/3, (0.5/\\sqrt{2}, 0.5/\\sqrt{2}, 0.0), (70 \\cos 25^\\circ \\cos 30^\\circ, 70 \\cos 25^\\circ \\sin 30^\\circ, 70 \\sin 25^\\circ), 0.03, 0.02, 0.025, \\text{CD2}) $，\n8. $ (1.0, 1.0 \\times 10^5, 5/3, (0.5/\\sqrt{2}, 0.5/\\sqrt{2}, 0.0), (70 \\cos 25^\\circ \\cos 30^\\circ, 70 \\cos 25^\\circ \\sin 30^\\circ, 70 \\sin 25^\\circ), 0.03, 0.02, 0.025, \\text{CD4}) $。\n\n对于每个案例，计算上文定义的 $ \\varepsilon_A $、$ \\varepsilon_f $ 和 $ \\varepsilon_s $。你的程序应产生单行输出，其中包含结果，格式为逗号分隔的列表之列表，每个内部列表对应一个测试案例并包含三个浮点数 $ [\\varepsilon_A, \\varepsilon_f, \\varepsilon_s] $。例如：\n$ [[e_{A,1}, e_{f,1}, e_{s,1}], [e_{A,2}, e_{f,2}, e_{s,2}], \\ldots, [e_{A,8}, e_{f,8}, e_{s,8}]] $。",
            "solution": "用户的请求是通过计算 MHD 波的数值色散误差来解决一个计算磁流体力学（MHD）中的问题。\n\n### 步骤 1：问题验证\n\n**提取已知条件：**\n-   **物理系统：** 线性化、无粘性、理想导电、可压缩的理想 MHD。\n-   **平衡态：** 具有均匀密度 $ \\rho_0 $、压强 $ p_0 $ 和磁场 $ \\mathbf{B}_0 $ 的均匀介质。\n-   **常量：** 比热比 $ \\gamma $，真空磁导率 $ \\mu_0 = 4 \\pi \\times 10^{-7} $ SI 单位。\n-   **基本速度：** Alfvén 速度 $ V_A = \\|\\mathbf{B}_0\\| / \\sqrt{\\mu_0 \\rho_0} $ 和声速 $ c_s = \\sqrt{\\gamma p_0 / \\rho_0} $。\n-   **精确相速度：** 对于与 $ \\mathbf{B}_0 $ 成 $ \\theta $ 角的波矢为 $ \\mathbf{k} $ 的平面波：\n    -   Alfvén 波：$ c_A^{\\text{exact}} = V_A \\cos \\theta $。\n    -   快/慢磁声波：$ c_{f,s}^{\\text{exact}} = \\sqrt{ \\tfrac{1}{2} \\left( V_A^2 + c_s^2 \\pm \\sqrt{(V_A^2 + c_s^2)^2 - 4 V_A^2 c_s^2 \\cos^2 \\theta} \\right) } $。\n-   **数值离散化：** 在网格间距为 $ (\\Delta x, \\Delta y, \\Delta z) $ 的笛卡尔网格上，连续微分符号 $ i \\mathbf{k} $ 被离散符号 $ i \\tilde{\\mathbf{k}} $ 替代。\n-   **离散波矢 $ \\tilde{\\mathbf{k}} $ 的分量：** 对于每个分量 $ j \\in \\{x,y,z\\} $：\n    -   CD2（二阶中心）：$ \\tilde{k}_j = \\dfrac{\\sin(k_j \\Delta_j)}{\\Delta_j} $。\n    -   CD4（四阶中心）：$ \\tilde{k}_j = \\dfrac{8 \\sin(k_j \\Delta_j) - \\sin(2 k_j \\Delta_j)}{12 \\Delta_j} $。\n-   **数值相速度：** 定义为 $ c^{\\text{num}} = \\omega^{\\text{num}} / \\|\\mathbf{k}\\| $，其中 $ \\omega^{\\text{num}} $ 是半离散角频率。\n    -   Alfvén 波：$ \\omega_A^{\\text{num}} = V_A (\\hat{\\mathbf{b}} \\cdot \\tilde{\\mathbf{k}}) $，其中 $ \\hat{\\mathbf{b}} = \\mathbf{B}_0 / \\|\\mathbf{B}_0\\| $。\n    -   磁声波：$ \\omega_{f,s}^{\\text{num}} = c_{f,s}(\\theta_{\\text{num}}) \\, \\|\\tilde{\\mathbf{k}}\\| $，其中 $ c_{f,s}(\\theta_{\\text{num}}) $ 是在 $ \\tilde{\\mathbf{k}} $ 和 $ \\mathbf{B}_0 $ 之间的夹角 $ \\theta_{\\text{num}} $ 处求值的精确速度函数。\n-   **误差度量：** 归一化误差 $ \\varepsilon_A = \\frac{c_A^{\\text{num}} - c_A^{\\text{exact}}}{c_{\\text{ref}}} $，$ \\varepsilon_f = \\frac{c_f^{\\text{num}} - c_f^{\\text{exact}}}{c_{\\text{ref}}} $，$ \\varepsilon_s = \\frac{c_s^{\\text{num}} - c_s^{\\text{exact}}}{c_{\\text{ref}}} $，其中 $ c_{\\text{ref}} = \\max(V_A, c_s) $。\n-   **任务：** 对提供的一套 8 个测试案例，计算误差三元组 $ (\\varepsilon_A, \\varepsilon_f, \\varepsilon_s) $。\n\n**验证结论：**\n该问题是**有效的**。\n1.  **有科学依据：** 该问题基于 MHD 波的标准色散关系及其由有限差分法产生的数值对应物。这些是计算等离子体物理和流体动力学中的核心概念。\n2.  **适定性：** 所有必需的常量、参数和公式均已提供。每个测试案例的输入是完整的，所需的输出被明确定义，从而得到唯一解。\n3.  **客观性：** 问题陈述完全是定量的，并用精确的数学语言表达。\n该问题是自洽的、计算上可行的，并且没有说明中列出的任何使其无效的缺陷。为“CD4”格式提供的公式，虽然其分母为 $ 12 \\Delta_j $ 而不是更标准的 $ 6 \\Delta_j $，但在数学上是适定的，必须按所述实现。这不构成缺陷，而是针对该问题背景的特定指令。\n\n### 步骤 2：解决方案设计\n\n解决方案将通过创建一个程序来实现，该程序遍历每个测试案例并执行以下计算序列：\n\n1.  **初始化：** 对每个案例，解析输入参数：$ \\rho_0, p_0, \\gamma, \\mathbf{B}_0, \\mathbf{k}, (\\Delta x, \\Delta y, \\Delta z) $ 和数值格式（CD2 或 CD4）。根据给定的三角表达式计算 $ \\mathbf{k} $ 的分量。\n\n2.  **计算基本量：**\n    -   计算模 $ \\|\\mathbf{B}_0\\| $ 和 $ \\|\\mathbf{k}\\| $。\n    -   计算 Alfvén 速度 $ V_A = \\|\\mathbf{B}_0\\| / \\sqrt{\\mu_0 \\rho_0} $ 和声速 $ c_s = \\sqrt{\\gamma p_0 / \\rho_0} $。\n    -   确定参考速度 $ c_{\\text{ref}} = \\max(V_A, c_s) $。\n\n3.  **计算精确相速度：**\n    -   计算物理波矢和磁场之间夹角的余弦：$ \\cos \\theta_{\\text{exact}} = (\\mathbf{k} \\cdot \\mathbf{B}_0) / (\\|\\mathbf{k}\\| \\|\\mathbf{B}_0\\|) $。\n    -   计算 $ c_A^{\\text{exact}} = V_A \\cos \\theta_{\\text{exact}} $。\n    -   使用提供的公式和 $ \\cos \\theta_{\\text{exact}} $ 计算 $ c_f^{\\text{exact}} $ 和 $ c_s^{\\text{exact}} $。\n\n4.  **计算数值波矢：**\n    -   根据指定的格式（CD2 或 CD4）构建离散波矢 $ \\tilde{\\mathbf{k}} $。分量 $ \\tilde{k}_j $ 使用各自的公式计算。\n    -   计算其模 $ \\|\\tilde{\\mathbf{k}}\\| $。\n\n5.  **计算数值相速度：**\n    -   对于 Alfvén 波，计算数值角频率 $ \\omega_A^{\\text{num}} = V_A ( (\\mathbf{B}_0/\\|\\mathbf{B}_0\\|) \\cdot \\tilde{\\mathbf{k}}) $，然后计算相速度 $ c_A^{\\text{num}} = \\omega_A^{\\text{num}} / \\|\\mathbf{k}\\| $。\n    -   对于磁声波，首先计算数值夹角的余弦：$ \\cos \\theta_{\\text{num}} = (\\tilde{\\mathbf{k}} \\cdot \\mathbf{B}_0) / (\\|\\tilde{\\mathbf{k}}\\| \\|\\mathbf{B}_0\\|) $。\n    -   在磁声速度公式中使用 $ \\cos \\theta_{\\text{num}} $ 得到中间速度 $ c_{f,s}(\\theta_{\\text{num}}) $。\n    -   计算数值角频率 $ \\omega_{f,s}^{\\text{num}} = c_{f,s}(\\theta_{\\text{num}}) \\, \\|\\tilde{\\mathbf{k}}\\| $。\n    -   最后，计算数值相速度 $ c_{f,s}^{\\text{num}} = \\omega_{f,s}^{\\text{num}} / \\|\\mathbf{k}\\| $。\n\n6.  **计算归一化误差：**\n    -   通过将精确速度从数值速度中减去，并用 $ c_{\\text{ref}} $ 进行归一化，计算三个误差度量 $ \\varepsilon_A, \\varepsilon_f, \\varepsilon_s $。\n\n7.  **最终输出：**\n    -   收集所有测试案例的误差三元组 $ [\\varepsilon_A, \\varepsilon_f, \\varepsilon_s] $。\n    -   将收集的结果格式化为问题中指定的单行字符串，表示为列表之列表。\n该实现将使用 `numpy` 库进行高效的向量运算和数学函数计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the numerical dispersion errors for MHD waves for a given test suite.\n    \"\"\"\n    # Define physical constants\n    mu_0 = 4.0 * np.pi * 1e-7\n\n    # Define test cases. The components of k are evaluated from the given expressions.\n    test_cases = [\n        # (rho0, p0, gamma, B0, k, dx, dy, dz, scheme)\n        (1.0, 1.0e5, 5.0/3.0, (0.5, 0.0, 0.0), (80.0 * np.cos(np.deg2rad(35)), 80.0 * np.sin(np.deg2rad(35)), 0.0), 0.02, 0.02, 0.02, \"CD2\"),\n        (1.0, 1.0e5, 5.0/3.0, (0.5, 0.0, 0.0), (80.0 * np.cos(np.deg2rad(35)), 80.0 * np.sin(np.deg2rad(35)), 0.0), 0.02, 0.02, 0.02, \"CD4\"),\n        (1.0, 1.0e5, 5.0/3.0, (0.5, 0.0, 0.0), (10.0 * np.cos(np.deg2rad(60)), 10.0 * np.sin(np.deg2rad(60)), 0.0), 0.02, 0.02, 0.02, \"CD2\"),\n        (1.0, 1.0e5, 5.0/3.0, (0.5, 0.0, 0.0), (10.0 * np.cos(np.deg2rad(60)), 10.0 * np.sin(np.deg2rad(60)), 0.0), 0.02, 0.02, 0.02, \"CD4\"),\n        (1.0, 1.0e5, 5.0/3.0, (0.5, 0.0, 0.0), (50.0 * np.cos(np.deg2rad(60)), 50.0 * np.sin(np.deg2rad(60)), 0.0), 0.05, 0.02, 0.02, \"CD2\"),\n        (1.0, 1.0e5, 5.0/3.0, (0.5, 0.0, 0.0), (50.0 * np.cos(np.deg2rad(60)), 50.0 * np.sin(np.deg2rad(60)), 0.0), 0.05, 0.02, 0.02, \"CD4\"),\n        (1.0, 1.0e5, 5.0/3.0, (0.5/np.sqrt(2), 0.5/np.sqrt(2), 0.0), (70.0 * np.cos(np.deg2rad(25)) * np.cos(np.deg2rad(30)), 70.0 * np.cos(np.deg2rad(25)) * np.sin(np.deg2rad(30)), 70.0 * np.sin(np.deg2rad(25))), 0.03, 0.02, 0.025, \"CD2\"),\n        (1.0, 1.0e5, 5.0/3.0, (0.5/np.sqrt(2), 0.5/np.sqrt(2), 0.0), (70.0 * np.cos(np.deg2rad(25)) * np.cos(np.deg2rad(30)), 70.0 * np.cos(np.deg2rad(25)) * np.sin(np.deg2rad(30)), 70.0 * np.sin(np.deg2rad(25))), 0.03, 0.02, 0.025, \"CD4\"),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho0, p0, gamma, B0_tuple, k_tuple, dx, dy, dz, scheme = case\n\n        B0_vec = np.array(B0_tuple)\n        k_vec = np.array(k_tuple)\n        delta_vec = np.array([dx, dy, dz])\n\n        # --- Calculate Fundamental Quantities ---\n        B0_mag = np.linalg.norm(B0_vec)\n        V_A = B0_mag / np.sqrt(mu_0 * rho0)\n        c_s = np.sqrt(gamma * p0 / rho0)\n        c_ref = max(V_A, c_s)\n        \n        k_mag = np.linalg.norm(k_vec)\n        \n        # Handle trivial cases\n        if B0_mag == 0 or k_mag == 0:\n            results.append([0.0, 0.0, 0.0])\n            continue\n            \n        b_hat = B0_vec / B0_mag\n\n        # --- Calculate Exact Phase Speeds ---\n        cos_theta_exact = np.dot(k_vec, b_hat) / k_mag\n\n        # Alfven Wave\n        c_A_exact = V_A * cos_theta_exact\n        \n        # Magnetosonic Waves\n        term1 = V_A**2 + c_s**2\n        # Ensure argument of sqrt is non-negative due to potential floating point inaccuracies\n        discriminant_val = term1**2 - 4 * V_A**2 * c_s**2 * cos_theta_exact**2\n        discriminant = np.sqrt(max(0, discriminant_val))\n        \n        c_f_exact = np.sqrt(0.5 * (term1 + discriminant))\n        c_s_exact = np.sqrt(0.5 * (term1 - discriminant))\n        \n        # --- Calculate Numerical Wavevector and Phase Speeds ---\n        k_tilde_vec = np.zeros(3)\n        if scheme == \"CD2\":\n            args = k_vec * delta_vec\n            # Handle k_j = 0 case where delta_j might be non-zero\n            k_tilde_vec = np.divide(np.sin(args), delta_vec, out=np.zeros_like(args), where=delta_vec!=0)\n        elif scheme == \"CD4\":\n            args1 = k_vec * delta_vec\n            args2 = 2 * k_vec * delta_vec\n            numerator = 8 * np.sin(args1) - np.sin(args2)\n            denominator = 12 * delta_vec\n            k_tilde_vec = np.divide(numerator, denominator, out=np.zeros_like(numerator), where=denominator!=0)\n        \n        k_tilde_mag = np.linalg.norm(k_tilde_vec)\n        \n        # Alfven Wave\n        omega_A_num = V_A * np.dot(b_hat, k_tilde_vec)\n        c_A_num = omega_A_num / k_mag\n\n        # Magnetosonic Waves\n        if k_tilde_mag == 0:\n            c_f_num = 0.0\n            c_s_num = 0.0\n        else:\n            cos_theta_num = np.dot(k_tilde_vec, b_hat) / k_tilde_mag\n            \n            discriminant_val_num = term1**2 - 4 * V_A**2 * c_s**2 * cos_theta_num**2\n            discriminant_num = np.sqrt(max(0, discriminant_val_num))\n\n            c_f_tilde = np.sqrt(0.5 * (term1 + discriminant_num))\n            c_s_tilde = np.sqrt(0.5 * (term1 - discriminant_num))\n            \n            omega_f_num = c_f_tilde * k_tilde_mag\n            omega_s_num = c_s_tilde * k_tilde_mag\n            \n            c_f_num = omega_f_num / k_mag\n            c_s_num = omega_s_num / k_mag\n            \n        # --- Calculate Normalized Errors ---\n        eps_A = (c_A_num - c_A_exact) / c_ref\n        eps_f = (c_f_num - c_f_exact) / c_ref\n        eps_s = (c_s_num - c_s_exact) / c_ref\n        \n        results.append([eps_A, eps_f, eps_s])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在磁流体动力学中，维持磁场的无散约束（$\\nabla \\cdot \\mathbf{B} = 0$）对于保证数值模拟的物理真实性和稳定性至关重要。由于离散化误差的累积，这一约束在计算中很容易被破坏，从而产生非物理力。本练习将引导你实现并分析一种先进的“散度清理”技术，即广义拉格朗日乘子（GLM）方法，它通过引入一个辅助标量场来主动地传输和耗散散度误差。",
            "id": "3513686",
            "problem": "您的任务是在一个多物理场耦合模拟环境中，为磁流体动力学 (MHD) 提出、推导并数值分析一种散度清理机制。该机制应为双曲-抛物线型，并应解决由空间离散化引起的磁场散度误差如何传播和衰减的问题。您的推导和计算必须从一个有效的基础出发，该基础由核心定义和经过充分检验的公式组成，包括磁感应方程、无散度约束、洛伦兹力以及用于散度清理的数学上一致的增广。问题陈述中不得出现任何简化公式；您的推理必须从第一性原理出发。\n\n使用的基本原理：\n- 磁流体动力学 (MHD) 将导电流体的动力学与电磁场耦合起来。磁感应方程源于法拉第定律和电场的本构关系，而动量方程则包含洛伦兹力作为源项。无散度约束对磁场 $\\,\\mathbf{B}\\,$ 施加 $\\,\\nabla \\cdot \\mathbf{B} = 0\\,$ 的条件。\n- 考虑引入一个广义拉格朗日乘子 (GLM) 标量场 $\\,\\psi\\,$ 来增广感应方程，使得散度误差 $\\,\\delta = \\nabla \\cdot \\mathbf{B}\\,$ 得以传播和衰减。在一个暂时忽略流动平流和电阻效应以孤立出散度清理动力学的背景下进行研究，但需保持与MHD的科学一致性。\n\n您的任务：\n1. 提出一种双曲-抛物线型散度清理增广方案，该方案引入一个标量场 $\\,\\psi\\,$，使得散度误差 $\\,\\delta = \\nabla \\cdot \\mathbf{B}\\,$ 随时间被输运和衰减。该增广必须在数学上与感应方程和散度约束一致，并且对于导电流体必须具有物理意义。定义双曲清理速度 $\\,c_h\\,$ (单位 $\\mathrm{m/s}$) 和抛物线阻尼系数 $\\,\\sigma\\,$ (单位 $\\mathrm{s^{-1}}$)，并解释它们的作用。\n2. 从增广系统和散度约束出发，推导散度误差场 $\\,\\delta(\\mathbf{x},t)\\,$ 的闭式演化方程，以展示散度误差如何传播和衰减。然后，在一维域上论证形式为 $\\,\\delta(x,t) = \\hat{\\delta}\\,e^{i k x}\\,e^{-\\omega t}\\,$ 的简正模解的存在性，其中波数为 $\\,k\\,$ (单位 $\\mathrm{rad/m}$)，复速率为 $\\,\\omega\\,$ (单位 $\\mathrm{s^{-1}}$)。仅使用基本原理和数学上正确的操作，得出 $\\,\\omega\\,$ 作为 $\\,k\\,$, $\\,c_h\\,$ 和 $\\,\\sigma\\,$ 函数的相应色散关系。不得引入未从基础推导出的简化公式或结果。\n3. 考虑在一个间距为 $\\,\\Delta x\\,$ (单位 $\\mathrm{m}$) 且具有周期性边界条件的均匀一维网格上，对拉普拉斯算子进行二阶中心差分空间离散化。展示与连续情况相比，该离散空间算子如何改变散度误差演化的波数响应，并推导相应的 $\\,\\omega\\,$ 的离散色散关系。所有三角函数参数必须使用弧度。\n4. 设计并实现一个程序，为每个指定的测试用例计算以下量（单位为 $\\mathrm{s^{-1}}$）：\n   - 连续简正模速率 $\\,\\omega_-(k)\\,$ 和 $\\,\\omega_+(k)\\,$ 的两个分支，以其实部和虚部的形式报告。\n   - 离散简正模速率 $\\,\\omega_-^{\\mathrm{disc}}(k,\\Delta x)\\,$ 和 $\\,\\omega_+^{\\mathrm{disc}}(k,\\Delta x)\\,$ 的两个分支，以其实部和虚部的形式报告。\n   所有角度均以弧度为单位，所有速率必须以 $\\mathrm{s^{-1}}$ 表示。虚部代表振荡频率，而实部代表阻尼率。\n5. 通过计算值解释，相对于连续模型，离散化如何改变传播速度和阻尼，尤其是在网格的奈奎斯特波数附近。\n\n测试套件：\n为以下参数集提供计算，每个参数集以元组 $\\,\\left(c_h,\\,\\sigma,\\,\\Delta x,\\,k\\right)\\,$ 的形式给出，其中 $\\,c_h\\,$ 单位为 $\\mathrm{m/s}$，$\\,\\sigma\\,$ 单位为 $\\mathrm{s^{-1}}$，$\\,\\Delta x\\,$ 单位为 $\\mathrm{m}$，$\\,k\\,$ 单位为 $\\mathrm{rad/m}$：\n- A情况（理想路径，振荡区域）：$\\,\\left(1.0 \\times 10^{3},\\,5.0 \\times 10^{1},\\,1.0 \\times 10^{-2},\\,1.0 \\times 10^{2}\\right)\\,$。\n- B情况（边界条件，零波数）：$\\,\\left(5.0 \\times 10^{2},\\,2.0 \\times 10^{1},\\,1.0 \\times 10^{-1},\\,0\\right)\\,$。\n- C情况（连续模型中的临界阻尼）：$\\,\\left(2,\\,4,\\,1.0 \\times 10^{-1},\\,1\\right)\\,$。\n- D情况（离散奈奎斯特波数附近的边缘情况）：$\\,\\left(1.0 \\times 10^{1},\\,3.0 \\times 10^{1},\\,5.0 \\times 10^{-2},\\,\\pi / \\Delta x\\right)\\,$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个以逗号分隔的 Python 风格列表形式的结果。列表中的每个元素对应一个测试用例，并且其本身是一个包含八个浮点数的列表，顺序如下：\n$\\,\\left[\\Re\\omega_-,\\,\\Im\\omega_-,\\,\\Re\\omega_+,\\,\\Im\\omega_+,\\,\\Re\\omega_-^{\\mathrm{disc}},\\,\\Im\\omega_-^{\\mathrm{disc}},\\,\\Re\\omega_+^{\\mathrm{disc}},\\,\\Im\\omega_+^{\\mathrm{disc}}\\right]\\,$。\n例如，输出应类似于 $\\,\\left[\\left[\\dots\\right],\\left[\\dots\\right],\\left[\\dots\\right],\\left[\\dots\\right]\\right]\\,$，所有数值条目的单位均为 $\\mathrm{s^{-1}}$，角度单位为弧度。",
            "solution": "用户提供的问题陈述是有效的。它在科学上基于计算磁流体动力学 (MHD) 的原理，问题适定，具有明确的目标和充分的数据，并以客观、正式的语言表达。该问题要求推导和分析一种标准的双曲-抛物线型散度清理机制（广义拉格朗日乘子或 GLM 方法），这是该领域的经典课题。满足有效问题的所有条件。\n\n以下是完整的、带推理过程的解答。\n\n### 第一部分：提出的用于散度清理的增广系统\n\nMHD 数值模拟中的基本挑战是维持无散度约束 $\\nabla \\cdot \\mathbf{B} = 0$。离散化误差不可避免地会引入非零散度 $\\delta = \\nabla \\cdot \\mathbf{B} \\neq 0$，这可能导致非物理力和数值不稳定性。双曲-抛物线型广义拉格朗日乘子 (GLM) 方法通过增广 MHD 方程组来解决此问题。我们引入一个与散度误差耦合的标量场 $\\psi$。\n\n为孤立出清理机制的动力学，我们考虑一个忽略流体速度和磁阻率的简化情境。标准的感应方程 $\\partial \\mathbf{B} / \\partial t = \\mathbf{0}$ 被增广。所提出的系统由一个修正的感应方程和一个新的关于 $\\psi$ 的演化方程组成：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} + \\nabla \\psi = \\mathbf{0}\n$$\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 (\\nabla \\cdot \\mathbf{B}) = -\\sigma \\psi\n$$\n此处，$\\mathbf{B}(\\mathbf{x}, t)$ 是磁场，$\\psi(\\mathbf{x}, t)$ 是辅助标量场。该系统引入了两个参数：\n1.  $c_h$：双曲清理速度，单位为 $\\mathrm{m/s}$。此参数决定了散度误差 $\\delta$ 以波的形式从其源头传播出去的特征速度。较大的 $c_h$ 会导致这些误差的输运更快。\n2.  $\\sigma$：抛物线阻尼系数，单位为 $\\mathrm{s^{-1}}$。此参数引入了一个耗散项，导致散度误差 $\\delta$ 和辅助场 $\\psi$ 的振幅都随时间呈指数衰减。\n\n双曲输运项（涉及 $c_h$）和抛物线阻尼项（涉及 $\\sigma$）的结合确保了散度误差被主动地从计算域中移除。\n\n### 第二部分：连续散度误差演化的推导\n\n为了理解散度误差 $\\delta = \\nabla \\cdot \\mathbf{B}$ 在此增广系统下如何演化，我们寻求一个关于 $\\delta$ 的单一闭式方程。\n\n首先，对增广的感应方程取散度：\n$$\n\\nabla \\cdot \\left( \\frac{\\partial \\mathbf{B}}{\\partial t} \\right) + \\nabla \\cdot (\\nabla \\psi) = 0\n$$\n假设 $\\mathbf{B}$ 足够光滑，我们可以交换空间和时间导数的顺序。此外，根据定义，$\\delta = \\nabla \\cdot \\mathbf{B}$ 且 $\\nabla \\cdot (\\nabla \\psi) = \\nabla^2 \\psi$。这得到：\n$$\n\\frac{\\partial (\\nabla \\cdot \\mathbf{B})}{\\partial t} + \\nabla^2 \\psi = 0 \\implies \\frac{\\partial \\delta}{\\partial t} + \\nabla^2 \\psi = 0\n\\quad \\quad (1)\n$$\n接下来，对 $\\psi$ 的演化方程取时间导数：\n$$\n\\frac{\\partial^2 \\psi}{\\partial t^2} + c_h^2 \\frac{\\partial (\\nabla \\cdot \\mathbf{B})}{\\partial t} = -\\sigma \\frac{\\partial \\psi}{\\partial t}\n$$\n代入 $\\delta = \\nabla \\cdot \\mathbf{B}$，我们得到：\n$$\n\\frac{\\partial^2 \\psi}{\\partial t^2} + c_h^2 \\frac{\\partial \\delta}{\\partial t} = -\\sigma \\frac{\\partial \\psi}{\\partial t}\n\\quad \\quad (2)\n$$\n现在我们得到了一个关于 $\\delta$ 和 $\\psi$ 的双方程系统。为了消去 $\\psi$，我们可以使用方程 (1) 将涉及 $\\psi$ 的项用 $\\delta$ 表示。由 (1) 可知 $\\nabla^2 \\psi = -\\partial \\delta / \\partial t$。对 方程 (1) 关于时间求导得到 $\\partial^2 \\delta / \\partial t^2 = -\\nabla^2 (\\partial \\psi / \\partial t)$。为了使用此式，我们从原始的 $\\psi$ 演化方程中解出 $\\partial \\psi / \\partial t$：$\\partial \\psi / \\partial t = -c_h^2 \\delta - \\sigma \\psi$。然而，对 (2) 进行操作更为直接。\n\n将拉普拉斯算子 $\\nabla^2$ 应用于原始的 $\\psi$ 演化方程：\n$$\n\\nabla^2 \\left(\\frac{\\partial \\psi}{\\partial t}\\right) + c_h^2 \\nabla^2 \\delta = -\\sigma \\nabla^2 \\psi\n$$\n交换求导顺序，得到：\n$$\n\\frac{\\partial}{\\partial t}(\\nabla^2 \\psi) + c_h^2 \\nabla^2 \\delta = -\\sigma \\nabla^2 \\psi\n$$\n现在，将方程 (1) 中的 $\\nabla^2 \\psi = -\\partial \\delta / \\partial t$ 代入此表达式：\n$$\n\\frac{\\partial}{\\partial t}\\left(-\\frac{\\partial \\delta}{\\partial t}\\right) + c_h^2 \\nabla^2 \\delta = -\\sigma \\left(-\\frac{\\partial \\delta}{\\partial t}\\right)\n$$\n这可以简化为散度误差 $\\delta$ 的最终演化方程：\n$$\n\\frac{\\partial^2 \\delta}{\\partial t^2} + \\sigma \\frac{\\partial \\delta}{\\partial t} - c_h^2 \\nabla^2 \\delta = 0\n$$\n这是一个阻尼波动方程，也称为电报方程。它表明散度误差以速度 $c_h$ 传播，同时其振幅被与 $\\sigma$ 成正比的项所阻尼。\n\n为求出色散关系，我们分析一维简正模解 $\\delta(x, t) = \\hat{\\delta} e^{i k x} e^{-\\omega t}$，其中 $k$ 是波数，$\\omega$ 是复速率。将此解代入方程：\n- $\\partial^2 \\delta / \\partial t^2 = (-\\omega)^2 \\delta = \\omega^2 \\delta$\n- $\\partial \\delta / \\partial t = -\\omega \\delta$\n- $\\nabla^2 \\delta = \\partial^2 \\delta / \\partial x^2 = (ik)^2 \\delta = -k^2 \\delta$\n\n将这些代入演化方程得到：\n$$\n\\omega^2 \\delta - \\sigma \\omega \\delta - c_h^2 (-k^2 \\delta) = 0\n$$\n除以 $\\delta$（对于非平凡解），我们得到关于 $\\omega$ 的代数方程：\n$$\n\\omega^2 - \\sigma \\omega + c_h^2 k^2 = 0\n$$\n这是一个关于 $\\omega$ 的二次方程。其根构成了连续色散关系，由二次方程求根公式给出：\n$$\n\\omega_{\\pm}(k) = \\frac{\\sigma \\pm \\sqrt{\\sigma^2 - 4 c_h^2 k^2}}{2}\n$$\n$\\omega$ 的实部是阻尼率，虚部是振荡频率。\n\n### 第三部分：离散色散关系的推导\n\n当系统在间距为 $\\Delta x$ 的均匀网格上进行数值求解时，连续的空间导数被有限差分近似所取代。一维拉普拉斯算子 $\\nabla^2 = \\partial^2/\\partial x^2$ 的二阶中心差分近似为：\n$$\n\\nabla^2 \\delta(x) \\approx \\frac{\\delta(x+\\Delta x) - 2\\delta(x) + \\delta(x-\\Delta x)}{(\\Delta x)^2}\n$$\n将此离散算子应用于简正模 $e^{ikx}$ 得到：\n$$\n\\frac{e^{ik(x+\\Delta x)} - 2e^{ikx} + e^{ik(x-\\Delta x)}}{(\\Delta x)^2} = \\frac{e^{ikx} (e^{ik\\Delta x} - 2 + e^{-ik\\Delta x})}{(\\Delta x)^2}\n$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，上式变为：\n$$\ne^{ikx} \\frac{2\\cos(k\\Delta x) - 2}{(\\Delta x)^2} = -e^{ikx} \\frac{2(1 - \\cos(k\\Delta x))}{(\\Delta x)^2}\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$\n-e^{ikx} \\frac{4}{(\\Delta x)^2} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\n$$\n因此，作用在模 $e^{ikx}$ 上的离散拉普拉斯算子等效于乘以 $-k_{\\mathrm{eff}}^2$，其中有效波数的平方为：\n$$\nk_{\\mathrm{eff}}^2 = \\frac{4}{(\\Delta x)^2} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\n$$\n为了找到离散色散关系，我们将连续关系二次方程中的 $k^2$ 替换为 $k_{\\mathrm{eff}}^2$：\n$$\n\\omega^2 - \\sigma \\omega + c_h^2 k_{\\mathrm{eff}}^2 = 0\n$$\n其根给出了离散色散关系：\n$$\n\\omega_{\\pm}^{\\mathrm{disc}}(k, \\Delta x) = \\frac{\\sigma \\pm \\sqrt{\\sigma^2 - 4 c_h^2 k_{\\mathrm{eff}}^2}}{2} = \\frac{\\sigma \\pm \\sqrt{\\sigma^2 - 4 c_h^2 \\frac{4}{(\\Delta x)^2} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)}}{2}\n$$\n\n### 第五部分：离散化效应的解释\n\n推导出的 $\\omega(k)$ 和 $\\omega^{\\mathrm{disc}}(k, \\Delta x)$ 关系式允许我们直接比较连续模型及其离散对应物。\n\n1.  **数值色散**：散度波的相速度会因离散化而改变。对于长波长（$k\\Delta x \\ll 1$），我们有 $\\sin(k\\Delta x/2) \\approx k\\Delta x/2$，这使得 $k_{\\mathrm{eff}}^2 \\approx k^2$。在此极限下，离散模型能准确再现连续模型的行为。然而，对于较短的波长（较大的 $k$），$k_{\\mathrm{eff}}$ 总是小于 $k$。这种现象被称为数值色散。离散系统中的波传播速度与 $k_{\\mathrm{eff}}$ 成正比，因此低于连续系统中的速度。在奈奎斯特波数 $k = \\pi/\\Delta x$ 处，有效波数为 $k_{\\mathrm{eff}} = 2/\\Delta x = (2/\\pi)k$。传播速度降低至大约为连续速度的 $64\\%$。\n\n2.  **阻尼行为**：离散化也可能改变阻尼状态。在振荡（复数 $\\omega$）和过阻尼（实数 $\\omega$）行为之间的转换发生在判别式为零时。在连续情况下，条件是 $\\sigma^2 = 4c_h^2 k^2$。在离散情况下，条件是 $\\sigma^2 = 4c_h^2 k_{\\mathrm{eff}}^2$。由于 $k_{\\mathrm{eff}}^2 \\le k^2$，在连续模型中是振荡的模，在离散模型中可能会变成过阻尼或临界阻尼。例如，如果一个模在连续模型中是临界阻尼的（$\\sigma^2=4c_h^2k^2$），其离散对应物将是过阻尼的，因为 $4c_h^2k_{\\mathrm{eff}}^2  \\sigma^2$。这在测试用例 C 中可以观察到。反之，在振荡区域，连续和离散模型的阻尼率均为 $\\Re(\\omega) = \\sigma/2$，与波数无关，因此只要系统保持振荡，振幅衰减率就不受数值色散的影响。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the continuous and discrete normal-mode rates for the\n    hyperbolic-parabolic divergence-cleaning mechanism in MHD.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (c_h, sigma, delta_x, k)\n    test_cases = [\n        # Case A: Happy path, oscillatory regime\n        (1.0e3, 5.0e1, 1.0e-2, 1.0e2),\n        # Case B: Boundary condition, zero wavenumber\n        (5.0e2, 2.0e1, 1.0e-1, 0.0),\n        # Case C: Critical damping in the continuous model\n        (2.0, 4.0, 1.0e-1, 1.0),\n        # Case D: Edge case near the discrete Nyquist wavenumber\n        (1.0e1, 3.0e1, 5.0e-2, np.pi / 5.0e-2),\n    ]\n\n    results = []\n    for case in test_cases:\n        ch, sigma, dx, k = case\n        \n        # --- Continuous Case ---\n        # The dispersion relation is ω² - σω + (ch*k)² = 0\n        # Roots are ω = [σ ± sqrt(σ² - 4(ch*k)²)] / 2\n        discriminant_cont = sigma**2 - 4 * ch**2 * k**2\n        \n        if discriminant_cont >= 0:\n            sqrt_disc_cont = np.sqrt(discriminant_cont)\n            omega_minus_cont_val = (sigma - sqrt_disc_cont) / 2.0\n            omega_plus_cont_val = (sigma + sqrt_disc_cont) / 2.0\n        else:\n            sqrt_disc_cont = np.sqrt(-discriminant_cont)\n            # The roots are complex conjugates\n            real_part = sigma / 2.0\n            imag_part = sqrt_disc_cont / 2.0\n            omega_minus_cont_val = complex(real_part, -imag_part)\n            omega_plus_cont_val = complex(real_part, imag_part)\n\n        # --- Discrete Case ---\n        # We replace k² with k_eff² = (4/dx²) * sin²(k*dx/2)\n        # The dispersion relation is ω² - σω + (ch*k_eff)² = 0\n        if dx == 0: # Avoid division by zero, though not in test cases\n             k_eff_sq = k**2\n        else:\n            k_eff_sq = (4.0 / dx**2) * (np.sin(k * dx / 2.0))**2\n\n        discriminant_disc = sigma**2 - 4 * ch**2 * k_eff_sq\n        \n        if discriminant_disc >= 0:\n            sqrt_disc_disc = np.sqrt(discriminant_disc)\n            omega_minus_disc_val = (sigma - sqrt_disc_disc) / 2.0\n            omega_plus_disc_val = (sigma + sqrt_disc_disc) / 2.0\n        else:\n            sqrt_disc_disc = np.sqrt(-discriminant_disc)\n            real_part = sigma / 2.0\n            imag_part = sqrt_disc_disc / 2.0\n            omega_minus_disc_val = complex(real_part, -imag_part)\n            omega_plus_disc_val = complex(real_part, imag_part)\n\n        # Append the 8 required float values for the current test case.\n        # Order: Re(ω-), Im(ω-), Re(ω+), Im(ω+), Re(ω_disc-), Im(ω_disc-), Re(ω_disc+), Im(ω_disc+)\n        case_results = [\n            float(np.real(omega_minus_cont_val)),\n            float(np.imag(omega_minus_cont_val)),\n            float(np.real(omega_plus_cont_val)),\n            float(np.imag(omega_plus_cont_val)),\n            float(np.real(omega_minus_disc_val)),\n            float(np.imag(omega_minus_disc_val)),\n            float(np.real(omega_plus_disc_val)),\n            float(np.imag(omega_plus_disc_val)),\n        ]\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The format is a Python-style list of lists.\n    list_of_lists_str = \"[\" + \",\".join(str(res) for res in results) + \"]\"\n    print(list_of_lists_str)\n\nsolve()\n```"
        },
        {
            "introduction": "磁流体动力学的核心在于流体动力学与电磁学的耦合。这个实践项目将通过一个具体的物理场景——声波与磁场的相互作用，来探索这种耦合。你将研究在一个被外磁场穿透的导电流体腔中，一个驻声波模式如何通过磁感应方程激发磁场扰动。通过从基本定律出发推导控制方程并求解，你将最终量化一个关键的无量纲参数——磁声耦合系数，从而深入理解MHD在多物理场耦合问题中的应用。",
            "id": "3513668",
            "problem": "一种可压缩的导电流体被容纳在长度为 $L$ 的一维腔体中，腔体两端为完美导电壁。一个均匀的静态磁场 $\\mathbf{B}_0$ 沿 $z$ 方向施加，$\\mathbf{B}_0 = B_0 \\,\\hat{\\mathbf{e}}_z$。流体由沿 $x$ 方向的驻声学波模驱动，其速度场为 $\\mathbf{u}(x,t) = u_x(x,t)\\,\\hat{\\mathbf{e}}_x$，其中基模被规定为 $u_x(x,t) = U_0 \\sin(k x)\\cos(\\omega t)$，其中 $k = \\pi/L$ 且 $\\omega = c_s k$。这里，$c_s$ 是（恒定的）绝热声速。假设由流动引起的磁场线性微扰为 $\\delta \\mathbf{B}(x,t) = b(x,t)\\,\\hat{\\mathbf{e}}_z$，并忽略 $\\delta \\mathbf{B}$ 对流动的反作用（运动学机制）。磁扩散率为 $\\eta$，磁导率为 $\\mu_0$。质量密度 $\\rho$ 是恒定的。\n\n从以下基本基础出发：\n- 麦克斯韦-法拉第定律：$\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}$。\n- 移动导体欧姆定律：$\\mathbf{J} = \\sigma \\left(\\mathbf{E} + \\mathbf{u}\\times \\mathbf{B}\\right)$，其中 $\\eta = 1/(\\mu_0 \\sigma)$。\n- 磁场无散性：$\\nabla \\cdot \\mathbf{B} = 0$。\n- 驻波模的声学色散关系：$\\omega = c_s k$。\n- 关于声学波模尺度 $\\ell = 1/k$ 的关键无量纲群的定义：马赫数 $Ma = U_0/c_s$ 和磁雷诺数 $Rm = U_0/(\\eta k)$。\n\n在这些假设下，具有适当边界条件的一维 $b(x,t)$ 磁感应方程存在唯一解。将声学波模的时间和空间平均动能密度定义为 $\\langle E_{\\mathrm{kin}}\\rangle = \\frac{1}{2}\\rho \\langle u_x^2\\rangle$，将时间和空间平均的磁扰动能量密度定义为 $\\langle E_{\\mathrm{mag}}\\rangle = \\frac{1}{2\\mu_0}\\langle b^2\\rangle$，其中 $\\langle\\cdot\\rangle$ 表示在一个声学周期 $T = 2\\pi/\\omega$ 和腔体长度 $L$ 上的平均。磁声耦合系数定义为无量纲比率 $C = \\langle E_{\\mathrm{mag}}\\rangle/\\langle E_{\\mathrm{kin}}\\rangle$。\n\n您的任务是：\n- 基于上述基本基础、给定的几何形状和驱动，推导出一个在瞬态衰减后的长时间周期性状态下有效的，关于 $Ma$ 和 $Rm$（以及给定的物理参数）的 $C$ 的闭式表达式。\n- 使用推导出的表达式，实现一个程序来为一组测试用例评估 $C$。除无量纲的 $Ma$、$Rm$ 和 $C$ 外，所有输入和输出必须采用国际单位制 (SI)。\n\n对所有测试用例使用以下固定的物理参数：\n- 流体质量密度 $\\rho = 0.1~\\mathrm{kg/m^3}$。\n- 磁导率 $\\mu_0 = 4\\pi\\times 10^{-7}~\\mathrm{H/m}$。\n- 均匀磁场强度 $B_0 = 0.5~\\mathrm{T}$。\n- 绝热声速 $c_s = 10^4~\\mathrm{m/s}$。\n- 腔体长度 $L = 1.0~\\mathrm{m}$，因此 $k = \\pi/L$ 且 $\\omega = c_s k$。\n\n对于每个测试用例，声学振幅为 $U_0 = Ma \\, c_s$，磁扩散率为 $\\eta = U_0/(k\\,Rm)$，这由 $Rm$ 的定义所隐含。\n\n测试套件（每个测试用例是一对 $(Ma,Rm)$）：\n- 用例 1：$(Ma,Rm) = (0.1, 10)$。\n- 用例 2：$(Ma,Rm) = (0.1, 0.1)$。\n- 用例 3：$(Ma,Rm) = (0.01, 1000)$。\n- 用例 4：$(Ma,Rm) = (0.5, 50)$。\n- 用例 5：$(Ma,Rm) = (0.2, 1)$。\n\n您的程序应为每个用例计算 $C$，并生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。每个值都应四舍五入到六位小数，并表示为无量纲的十进制数（无单位），按用例 1 到 5 的顺序排列。例如，输出格式必须为 $[c_1,c_2,c_3,c_4,c_5]$ 的形式，其中每个 $c_i$ 是用例 $i$ 的四舍五入值。",
            "solution": "该问题被认为是有效的，因为它科学地基于磁流体力学原理，信息充分、问题明确，足以推导出唯一解，并且陈述规范。分析过程如下。\n\n我们的第一步是从给定的基本定律中推导磁场微扰 $b(x,t)$ 的控制偏微分方程。磁感应方程是通过结合麦克斯韦-法拉第定律 $\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}$ 和移动导体欧姆定律 $\\mathbf{J} = \\sigma(\\mathbf{E} + \\mathbf{u} \\times \\mathbf{B})$ 推导出来的。对欧姆定律求解电场 $\\mathbf{E}$ 得到 $\\mathbf{E} = \\mathbf{J}/\\sigma - \\mathbf{u} \\times \\mathbf{B}$。将其代入法拉第定律得到 $\\partial_t \\mathbf{B} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B} - \\mathbf{J}/\\sigma)$。我们使用安培定律（在低频磁流体力学极限下）$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$ 来替换电流密度 $\\mathbf{J}$，并使用磁扩散率的定义 $\\eta = 1/(\\mu_0\\sigma)$，从而得到广义磁感应方程：\n$$\n\\partial_t \\mathbf{B} = \\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) - \\nabla \\times (\\eta \\nabla \\times \\mathbf{B})\n$$\n总磁场为 $\\mathbf{B}(x,t) = \\mathbf{B}_0 + \\delta \\mathbf{B}(x,t) = (B_0 + b(x,t))\\,\\hat{\\mathbf{e}}_z$，速度场为 $\\mathbf{u}(x,t) = u_x(x,t)\\,\\hat{\\mathbf{e}}_x$。问题指定了具有线性微扰的运动学机制，因此我们通过只保留微扰量 $u_x$ 和 $b$ 的一阶项来线性化方程。项 $\\mathbf{u} \\times \\mathbf{B}$ 变为：\n$$\n\\mathbf{u} \\times \\mathbf{B} = (u_x \\hat{\\mathbf{e}}_x) \\times ((B_0 + b) \\hat{\\mathbf{e}}_z) = -u_x(B_0 + b)\\hat{\\mathbf{e}}_y \\approx -u_x B_0 \\hat{\\mathbf{e}}_y\n$$\n其中乘积 $u_x b$ 是一个二阶项，被忽略了。该项的旋度是：\n$$\n\\nabla \\times (\\mathbf{u} \\times \\mathbf{B}) \\approx \\nabla \\times (-u_x B_0 \\hat{\\mathbf{e}}_y) = -B_0 \\frac{\\partial u_x}{\\partial x} \\hat{\\mathbf{e}}_z\n$$\n扩散项是：\n$$\n\\nabla \\times (\\eta \\nabla \\times \\mathbf{B}) = \\nabla \\times \\left(\\eta \\nabla \\times (B_0 \\hat{\\mathbf{e}}_z + b \\hat{\\mathbf{e}}_z)\\right) = \\nabla \\times \\left(\\eta \\frac{\\partial b}{\\partial x} \\hat{\\mathbf{e}}_y\\right) = \\eta \\frac{\\partial^2 b}{\\partial x^2} \\hat{\\mathbf{e}}_z\n$$\n假设磁扩散率 $\\eta$ 是均匀的。时间导数就是 $\\partial_t \\mathbf{B} = \\frac{\\partial b}{\\partial t} \\hat{\\mathbf{e}}_z$。将完整的感应方程投影到 $\\hat{\\mathbf{e}}_z$ 方向，得到 $b(x,t)$ 的一维标量偏微分方程：\n$$\n\\frac{\\partial b}{\\partial t} - \\eta \\frac{\\partial^2 b}{\\partial x^2} = -B_0 \\frac{\\partial u_x}{\\partial x}\n$$\n速度由 $u_x(x,t) = U_0 \\sin(kx)\\cos(\\omega t)$ 给出，因此其空间导数为 $\\partial_x u_x = U_0 k \\cos(kx)\\cos(\\omega t)$。偏微分方程变为：\n$$\n\\frac{\\partial b}{\\partial t} - \\eta \\frac{\\partial^2 b}{\\partial x^2} = -B_0 U_0 k \\cos(kx)\\cos(\\omega t)\n$$\n在 $x=0$ 和 $x=L$ 的完美导电壁上的边界条件要求电场的切向分量为零。电场为 $\\mathbf{E} \\approx - \\mathbf{u} \\times \\mathbf{B} + \\eta \\nabla \\times \\mathbf{B} = (u_x B_0 + \\eta \\partial_x b)\\hat{\\mathbf{e}}_y$。由于在 $x=0$ 和 $x=L$ 处 $u_x = 0$（因为 $kL=\\pi$），条件 $E_y=0$ 意味着微扰的诺伊曼边界条件：在 $x=0,L$ 处 $\\partial_x b = 0$。\n\n我们寻求瞬态衰减后的周期性稳态解。我们使用复数表示法，设 $u_x(x,t) = \\mathrm{Re}\\{U_0 \\sin(kx) e^{i\\omega t}\\}$ 并寻求形式为 $b(x,t) = \\mathrm{Re}\\{\\hat{b}(x)e^{i\\omega t}\\}$ 的解。代入偏微分方程，得到复振幅 $\\hat{b}(x)$ 的常微分方程：\n$$\ni\\omega \\hat{b}(x) - \\eta \\frac{d^2 \\hat{b}}{d x^2} = -B_0 U_0 k \\cos(kx)\n$$\n$$\n\\frac{d^2 \\hat{b}}{d x^2} - \\frac{i\\omega}{\\eta} \\hat{b}(x) = \\frac{B_0 U_0 k}{\\eta} \\cos(kx)\n$$\n边界条件为在 $x=0,L$ 处 $d\\hat{b}/dx = 0$。我们提出一个形式为 $\\hat{b}_p(x) = A \\cos(kx)$ 的特解。将其代入常微分方程：\n$$\n-A k^2 \\cos(kx) - \\frac{i\\omega}{\\eta} A \\cos(kx) = \\frac{B_0 U_0 k}{\\eta} \\cos(kx)\n$$\n求解复数常数 $A$：\n$$\nA \\left(-k^2 - \\frac{i\\omega}{\\eta}\\right) = \\frac{B_0 U_0 k}{\\eta} \\implies A = -\\frac{B_0 U_0 k}{\\eta k^2 + i\\omega}\n$$\n所提出的解 $\\hat{b}_p(x) = A \\cos(kx)$ 的导数为 $d\\hat{b}_p/dx = -Ak\\sin(kx)$，它在 $x=0$ 和 $x=L$ 处为零（因为 $kL=\\pi$）。因此，这个特解满足边界条件，并且由于问题必须有唯一解，这就是完整的稳态解。\n所以，$\\hat{b}(x) = -\\frac{B_0 U_0 k}{\\eta k^2 + i\\omega} \\cos(kx)$。\n\n接下来，我们计算时间和空间平均的能量密度。平均操作为 $\\langle f \\rangle = \\frac{1}{LT} \\int_0^L \\int_0^T f(x,t) \\,dt\\,dx$，其中 $T=2\\pi/\\omega$ 且 $k=\\pi/L$。\n动能密度为 $\\langle E_{\\mathrm{kin}}\\rangle = \\frac{1}{2}\\rho \\langle u_x^2\\rangle$。\n$$\n\\langle u_x^2 \\rangle = \\langle U_0^2 \\sin^2(kx) \\cos^2(\\omega t) \\rangle = U_0^2 \\left(\\frac{1}{L}\\int_0^L \\sin^2(kx) dx\\right) \\left(\\frac{1}{T}\\int_0^T \\cos^2(\\omega t) dt\\right)\n$$\n标准积分对两个平均都得出 $\\frac{1}{2}$。因此，$\\langle u_x^2 \\rangle = U_0^2 (1/2)(1/2) = U_0^2/4$。\n$$\n\\langle E_{\\mathrm{kin}}\\rangle = \\frac{1}{2}\\rho \\left(\\frac{U_0^2}{4}\\right) = \\frac{1}{8}\\rho U_0^2\n$$\n磁能密度为 $\\langle E_{\\mathrm{mag}}\\rangle = \\frac{1}{2\\mu_0} \\langle b^2 \\rangle$。对于一个复振幅 $\\hat{b}(x)$，实信号平方的时间平均值为 $\\langle (\\mathrm{Re}\\{\\hat{b}e^{i\\omega t}\\})^2 \\rangle_t = \\frac{1}{2}|\\hat{b}|^2$。\n$$\n|\\hat{b}(x)|^2 = \\left| -\\frac{B_0 U_0 k}{\\eta k^2 + i\\omega} \\cos(kx) \\right|^2 = \\frac{B_0^2 U_0^2 k^2}{(\\eta k^2)^2 + \\omega^2} \\cos^2(kx)\n$$\n现在，我们进行空间平均：\n$$\n\\langle b^2 \\rangle = \\left\\langle \\frac{1}{2}|\\hat{b}(x)|^2 \\right\\rangle_x = \\frac{B_0^2 U_0^2 k^2}{2((\\eta k^2)^2 + \\omega^2)} \\left(\\frac{1}{L}\\int_0^L \\cos^2(kx) dx\\right) = \\frac{B_0^2 U_0^2 k^2}{2((\\eta k^2)^2 + \\omega^2)} \\left(\\frac{1}{2}\\right) = \\frac{B_0^2 U_0^2 k^2}{4((\\eta k^2)^2 + \\omega^2)}\n$$\n平均磁能密度为：\n$$\n\\langle E_{\\mathrm{mag}}\\rangle = \\frac{1}{2\\mu_0} \\langle b^2 \\rangle = \\frac{B_0^2 U_0^2 k^2}{8\\mu_0 ((\\eta k^2)^2 + \\omega^2)}\n$$\n最后，磁声耦合系数 $C$ 是这些能量的比率：\n$$\nC = \\frac{\\langle E_{\\mathrm{mag}}\\rangle}{\\langle E_{\\mathrm{kin}}\\rangle} = \\frac{\\frac{B_0^2 U_0^2 k^2}{8\\mu_0 ((\\eta k^2)^2 + \\omega^2)}}{\\frac{1}{8}\\rho U_0^2} = \\frac{B_0^2 k^2}{\\mu_0 \\rho ((\\eta k^2)^2 + \\omega^2)}\n$$\n为了用马赫数 $Ma = U_0/c_s$ 和磁雷诺数 $Rm = U_0/(\\eta k)$ 来表示它，我们代入 $\\omega=c_s k$ 和 $\\eta = U_0/(k \\cdot Rm) = (Ma \\cdot c_s)/(k \\cdot Rm)$。\n分母是：\n$$\n(\\eta k^2)^2 + \\omega^2 = \\left(\\frac{Ma \\cdot c_s}{k \\cdot Rm} k^2\\right)^2 + (c_s k)^2 = (c_s k)^2 \\left( \\left(\\frac{Ma}{Rm}\\right)^2 + 1 \\right)\n$$\n将此代入 $C$ 的表达式中：\n$$\nC = \\frac{B_0^2 k^2}{\\mu_0 \\rho (c_s k)^2 (1 + (Ma/Rm)^2)} = \\frac{B_0^2}{\\mu_0 \\rho c_s^2} \\frac{1}{1 + (Ma/Rm)^2}\n$$\n这是耦合系数的最终闭式表达式。项 $B_0^2/(\\mu_0 \\rho)$ 是阿尔芬速度 $v_A^2$ 的平方。因此，$C$ 可以解释为特征磁能密度与声能密度的比值，$C = (v_A/c_s)^2 / (1 + (Ma/Rm)^2)$，此比值受到磁场平流和扩散之间竞争的修正。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the magnetoacoustic coupling coefficient C for a set of test cases.\n    \"\"\"\n    \n    # Define the fixed physical parameters from the problem statement.\n    # All values are in SI units.\n    rho = 0.1  # kg/m^3, Fluid mass density\n    mu0 = 4 * np.pi * 1e-7  # H/m, Magnetic permeability of free space\n    B0 = 0.5  # T, Uniform magnetic field magnitude\n    cs = 1e4  # m/s, Adiabatic sound speed\n    \n    # Cavity length L is not needed for the final expression of C, but it is a given.\n    # The wave number k and frequency omega are also absorbed into dimensionless numbers.\n    # L = 1.0  # m\n    # k = np.pi / L\n    # omega = cs * k\n\n    # Define the test suite. Each case is a tuple (Ma, Rm).\n    test_cases = [\n        (0.1, 10.0),\n        (0.1, 0.1),\n        (0.01, 1000.0),\n        (0.5, 50.0),\n        (0.2, 1.0)\n    ]\n\n    results = []\n\n    # The derived formula for the coupling coefficient C is:\n    # C = (B0^2 / (mu0 * rho * cs^2)) / (1 + (Ma / Rm)^2)\n    # The first term is a constant prefactor.\n    \n    prefactor = B0**2 / (mu0 * rho * cs**2)\n\n    for Ma, Rm in test_cases:\n        # Calculate C for the current test case.\n        # The problem statement implies Rm will be non-zero as it is computed\n        # from U0, k, and eta which are all non-zero.\n        C = prefactor / (1 + (Ma / Rm)**2)\n        \n        # Append the result formatted to six decimal places.\n        results.append(f\"{C:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}