{
    "hands_on_practices": [
        {
            "introduction": "To build a robust understanding of species transport, we begin with the fundamental case of pure advection, where a substance is simply carried by a bulk flow. This exercise  challenges you to solve the classic one-dimensional advection equation using the powerful method of characteristics, revealing how an initial concentration profile and an inflow boundary condition shape the solution in space and time. By then tracking the conservation of mass, this practice reinforces one of the most critical principles underlying all transport phenomena.",
            "id": "3497291",
            "problem": "Consider the one-dimensional transport of a passive chemical species with constant advective velocity. Let the concentration field be denoted by $c(x,t)$ on the spatial interval $x \\in [0,L]$ for time $t \\ge 0$. Suppose the species obeys the advection equation (a special case of the advection-diffusion-reaction balance) with no diffusion and no reaction,\n$$\n\\partial_{t} c + U \\,\\partial_{x} c = 0,\n$$\nwhere $U0$ is a constant velocity. The problem is completed by an inflow boundary specification at the left boundary and a prescribed initial condition,\n$$\nc(0,t) = g(t), \\quad t \\ge 0, \\qquad c(x,0) = c_{0}(x), \\quad x \\in [0,L].\n$$\nAssume all quantities are nondimensional and that $g$ and $c_{0}$ are sufficiently regular to ensure a unique weak solution.\n\n1. Starting from the statement of local conservation of scalar mass and the definition of characteristics for first-order hyperbolic partial differential equations (PDEs), derive the general solution $c(x,t)$ using the method of characteristics. Clearly identify the regions of the space-time domain influenced by the inflow boundary and by the initial condition, and express $c(x,t)$ explicitly in terms of $g$ and $c_{0}$.\n\n2. Define the total mass in the domain at time $t$ by\n$$\nM(t) = \\int_{0}^{L} c(x,t)\\,dx.\n$$\nBy integrating the PDE over the spatial domain and using the Fundamental Theorem of Calculus, derive the global mass balance relation for $M(t)$ in terms of the boundary fluxes at $x=0$ and $x=L$. Then, using your characteristic solution from part 1, evaluate $M(t)$ explicitly for times $0 \\le t \\le L/U$.\n\n3. Let the data be\n$$\nc_{0}(x) = A\\,\\exp(-\\alpha x), \\qquad g(t) = C\\,\\exp(-\\beta t),\n$$\nwith $A0$, $C0$, $\\alpha0$, $\\beta0$, and take $U0$ and $L0$. Specialize your expression for $M(t)$ to the parameter values\n$$\nA=1.5,\\quad C=1.5,\\quad \\alpha=3,\\quad \\beta=2,\\quad U=0.4,\\quad L=1,\n$$\nvalid for times $0 \\le t \\le L/U$. Provide your final result for $M(t)$ as a single closed-form analytic expression in $t$ without units. No rounding is required.",
            "solution": "The problem statement is first subjected to a rigorous validation process before a solution is attempted.\n\n### Step 1: Extract Givens\nThe following data and conditions are provided in the problem statement:\n- **Governing Equation**: The one-dimensional advection equation for concentration $c(x,t)$ is $\\partial_{t} c + U \\,\\partial_{x} c = 0$, for $x \\in [0,L]$ and $t \\ge 0$. The advective velocity $U$ is a positive constant ($U0$).\n- **Boundary Condition**: An inflow boundary condition is prescribed at $x=0$: $c(0,t) = g(t)$ for $t \\ge 0$.\n- **Initial Condition**: An initial concentration profile is given: $c(x,0) = c_{0}(x)$ for $x \\in [0,L]$.\n- **Regularity**: The functions $g(t)$ and $c_{0}(x)$ are assumed to be sufficiently regular.\n- **Definition of Total Mass**: The total mass in the domain at time $t$ is $M(t) = \\int_{0}^{L} c(x,t)\\,dx$.\n- **Specific Data for Part 3**:\n  - Initial condition function: $c_{0}(x) = A\\,\\exp(-\\alpha x)$\n  - Boundary condition function: $g(t) = C\\,\\exp(-\\beta t)$\n  - Parameter values: $A=1.5$, $C=1.5$, $\\alpha=3$, $\\beta=2$, $U=0.4$, $L=1$.\n  - All constants ($A, C, \\alpha, \\beta, U, L$) are specified as positive.\n- **Tasks**:\n  1. Derive the general solution $c(x,t)$ using the method of characteristics and identify regions of influence.\n  2. Derive the global mass balance for $M(t)$ and evaluate $M(t)$ explicitly for $0 \\le t \\le L/U$ using the characteristic solution.\n  3. Specialize the expression for $M(t)$ using the given data and parameters for $0 \\le t \\le L/U$ and provide a final closed-form expression.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The advection equation is a fundamental and canonical PDE in transport phenomena, representing the transport of a conserved scalar quantity by a constant velocity field. The method of characteristics is the standard mathematical technique for its solution. The concept of local and global mass conservation is central to physics and engineering. The problem is scientifically sound.\n- **Well-Posed**: The problem is a first-order hyperbolic initial-boundary value problem. For a positive velocity $U0$, information propagates from left to right ($x$ increasing). A boundary condition at the inflow boundary ($x=0$) and an initial condition are required and provided. This constitutes a well-posed setup. Note that for consistency at the point $(x,t) = (0,0)$, the initial and boundary data must agree, i.e., $c_0(0) = g(0)$. For the specific data given in part $3$, we have $c_0(0) = A\\,\\exp(0) = A = 1.5$ and $g(0) = C\\,\\exp(0) = C = 1.5$. Since $A=C$, the data are consistent.\n- **Objective**: The problem is stated using precise, unambiguous mathematical language. It is free from subjectivity.\n- **Completeness and Consistency**: The problem provides all necessary elements (PDE, domain, initial/boundary conditions, definitions) to proceed with a unique solution. There are no internal contradictions.\n- **Other Criteria**: The problem is not unrealistic, ill-structured, trivial, or reliant on unverifiable claims. It is a standard, solvable problem in applied mathematics and physics.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is well-posed, scientifically grounded, and internally consistent. A full solution is developed below, addressing each part of the problem sequentially.\n\n### Part 1: General Solution via Method of Characteristics\nThe governing PDE is a first-order linear hyperbolic equation:\n$$\n\\partial_{t} c + U \\,\\partial_{x} c = 0\n$$\nThe method of characteristics seeks curves $(x(s), t(s))$ in the space-time domain along which the PDE simplifies to an ordinary differential equation. The characteristic equations are:\n$$\n\\frac{dt}{ds} = 1, \\quad \\frac{dx}{ds} = U, \\quad \\frac{dc}{ds} = \\partial_{t} c \\frac{dt}{ds} + \\partial_{x} c \\frac{dx}{ds} = \\partial_{t} c + U \\partial_{x} c = 0\n$$\nFrom these, we deduce that $c$ is constant along the characteristic curves. The characteristics themselves are straight lines defined by $\\frac{dx}{dt} = U$, which integrates to $x - Ut = \\xi$, where $\\xi$ is a constant. Each characteristic is uniquely identified by its parameter $\\xi$.\n\nTo find the solution $c(x,t)$ at a point $(x,t)$, we trace the characteristic line $X(\\tau) - U \\tau = x - Ut$ back until it intersects the boundary of the domain, which for $t0$ consists of the initial line ($t=0$, $x \\ge 0$) and the inflow boundary ($x=0$, $t \\ge 0$).\n\n**Case 1: Characteristic originates from the initial line ($t=0$)**\nThe characteristic through $(x,t)$ intersects the initial line at time $\\tau=0$ at position $X(0) = x - Ut$. This intersection point is within the physical domain $[0,L]$ only if $x - Ut \\ge 0$, or $x \\ge Ut$. In this region, the concentration $c$ remains constant and equal to its initial value at that point.\n$$\nc(x,t) = c(x-Ut, 0) = c_0(x-Ut) \\quad \\text{for } x \\ge Ut\n$$\nThis region of the space-time domain is influenced by the initial condition $c_0(x)$.\n\n**Case 2: Characteristic originates from the inflow boundary ($x=0$)**\nThe characteristic through $(x,t)$ intersects the inflow boundary $X(\\tau) = 0$ at time $\\tau_0$ such that $0 - U\\tau_0 = x - Ut$, which gives $\\tau_0 = t - x/U$. This intersection occurs for $\\tau_0 \\ge 0$, which implies $t - x/U \\ge 0$, or $x \\le Ut$. In this region, the concentration $c$ remains constant and equal to the value prescribed at the boundary at the time of entry.\n$$\nc(x,t) = c(0, t - x/U) = g(t - x/U) \\quad \\text{for } x  Ut\n$$\nThis region of the space-time domain is influenced by the inflow boundary condition $g(t)$.\n\nCombining these two cases, the general solution is:\n$$\nc(x,t) = \\begin{cases}\ng(t-x/U)  \\text{if } x  Ut \\\\\nc_0(x-Ut)  \\text{if } x \\ge Ut\n\\end{cases}\n$$\nThe domain is partitioned by the characteristic line $x=Ut$ emanating from the origin.\n\n### Part 2: Global Mass Balance and Evaluation of $M(t)$\nThe total mass in the domain is $M(t) = \\int_{0}^{L} c(x,t)\\,dx$. To find the global mass balance, we differentiate $M(t)$ with respect to time and use the governing PDE. Assuming sufficient regularity to interchange differentiation and integration (Leibniz rule):\n$$\n\\frac{dM(t)}{dt} = \\frac{d}{dt} \\int_{0}^{L} c(x,t)\\,dx = \\int_{0}^{L} \\partial_{t} c(x,t)\\,dx\n$$\nSubstitute $\\partial_{t} c = -U \\partial_{x} c$ from the PDE:\n$$\n\\frac{dM(t)}{dt} = \\int_{0}^{L} -U \\partial_{x} c(x,t)\\,dx = -U \\int_{0}^{L} \\partial_{x} c(x,t)\\,dx\n$$\nUsing the Fundamental Theorem of Calculus:\n$$\n\\frac{dM(t)}{dt} = -U [c(x,t)]_{x=0}^{x=L} = -U(c(L,t) - c(0,t)) = U(c(0,t) - c(L,t))\n$$\nThis is the global mass balance relation. The rate of change of total mass is the net flux of mass into the domain, which is the mass flux in at $x=0$ ($U c(0,t)$) minus the mass flux out at $x=L$ ($U c(L,t)$).\n\nNext, we evaluate $M(t)$ for the time interval $0 \\le t \\le L/U$. In this interval, the dividing characteristic $x=Ut$ lies within the spatial domain, i.e., $0 \\le Ut \\le L$. We must split the integral for $M(t)$ at $x=Ut$:\n$$\nM(t) = \\int_{0}^{L} c(x,t)\\,dx = \\int_{0}^{Ut} c(x,t)\\,dx + \\int_{Ut}^{L} c(x,t)\\,dx\n$$\nSubstituting the piecewise solution for $c(x,t)$ from Part 1:\n$$\nM(t) = \\int_{0}^{Ut} g\\left(t-\\frac{x}{U}\\right)\\,dx + \\int_{Ut}^{L} c_0(x-Ut)\\,dx\n$$\nWe evaluate each integral using a change of variables.\nFor the first integral, let $s = t - x/U$. Then $ds = -dx/U$, implying $dx = -U\\,ds$. The limits of integration become $s=t$ for $x=0$, and $s=t - (Ut)/U = 0$ for $x=Ut$.\n$$\n\\int_{0}^{Ut} g\\left(t-\\frac{x}{U}\\right)\\,dx = \\int_{t}^{0} g(s)(-U\\,ds) = U \\int_{0}^{t} g(s)\\,ds\n$$\nFor the second integral, let $y = x - Ut$. Then $dy = dx$. The limits become $y=0$ for $x=Ut$, and $y=L-Ut$ for $x=L$.\n$$\n\\int_{Ut}^{L} c_0(x-Ut)\\,dx = \\int_{0}^{L-Ut} c_0(y)\\,dy\n$$\nCombining these results gives the explicit expression for the total mass for $0 \\le t \\le L/U$:\n$$\nM(t) = U \\int_{0}^{t} g(s)\\,ds + \\int_{0}^{L-Ut} c_0(y)\\,dy\n$$\n\n### Part 3: Specialization for Given Data\nWe are given $c_{0}(x) = A\\,\\exp(-\\alpha x)$ and $g(t) = C\\,\\exp(-\\beta t)$. We substitute these into the integral expression for $M(t)$:\n$$\nM(t) = U \\int_{0}^{t} C\\,\\exp(-\\beta s)\\,ds + \\int_{0}^{L-Ut} A\\,\\exp(-\\alpha y)\\,dy\n$$\nPerforming the integrations:\n$$\n\\int_{0}^{t} C\\,\\exp(-\\beta s)\\,ds = C \\left[ -\\frac{1}{\\beta}\\exp(-\\beta s) \\right]_{0}^{t} = -\\frac{C}{\\beta}(\\exp(-\\beta t) - 1) = \\frac{C}{\\beta}(1-\\exp(-\\beta t))\n$$\n$$\n\\int_{0}^{L-Ut} A\\,\\exp(-\\alpha y)\\,dy = A \\left[ -\\frac{1}{\\alpha}\\exp(-\\alpha y) \\right]_{0}^{L-Ut} = -\\frac{A}{\\alpha}(\\exp(-\\alpha(L-Ut)) - 1) = \\frac{A}{\\alpha}(1-\\exp(-\\alpha(L-Ut)))\n$$\nCombining these, the symbolic expression for $M(t)$ is:\n$$\nM(t) = \\frac{UC}{\\beta}(1-\\exp(-\\beta t)) + \\frac{A}{\\alpha}(1-\\exp(-\\alpha(L-Ut)))\n$$\nNow, we substitute the given numerical parameter values: $A=1.5$, $C=1.5$, $\\alpha=3$, $\\beta=2$, $U=0.4$, and $L=1$. The expression is valid for $0 \\le t \\le L/U = 1/0.4 = 2.5$.\nFirst, calculate the constant coefficients:\n$$\n\\frac{UC}{\\beta} = \\frac{(0.4)(1.5)}{2} = \\frac{0.6}{2} = 0.3\n$$\n$$\n\\frac{A}{\\alpha} = \\frac{1.5}{3} = 0.5\n$$\nSubstituting these values back into the expression for $M(t)$:\n$$\nM(t) = 0.3(1 - \\exp(-2t)) + 0.5(1 - \\exp(-3(1-0.4t)))\n$$\nExpanding and simplifying the expression:\n$$\nM(t) = 0.3 - 0.3\\exp(-2t) + 0.5 - 0.5\\exp(-3 + 1.2t)\n$$\n$$\nM(t) = 0.8 - 0.3\\exp(-2t) - 0.5\\exp(1.2t-3)\n$$\nThis is the final closed-form analytic expression for the total mass $M(t)$ in the specified time interval.",
            "answer": "$$\n\\boxed{0.8 - 0.3\\exp(-2t) - 0.5\\exp(1.2t - 3)}\n$$"
        },
        {
            "introduction": "Having explored pure advection, we now introduce diffusion and its interplay with reactive surfaces, a common scenario in catalysis and membrane science. This practice  guides you through a first-principles derivation of a reactive boundary condition from a local mass balance, a crucial skill for modeling interfacial phenomena. You will then apply this condition to solve for the steady-state concentration profile, directly connecting the macroscopic diffusive flux to the microscopic rate of surface reaction.",
            "id": "3497247",
            "problem": "A dilute solute diffuses in a quiescent liquid occupying the one-dimensional region $0 \\le x \\le L$ adjacent to a planar, catalytically active wall located at $x=0$. The solute has bulk concentration $c(x,t)$ and molecular diffusivity $D$, which can be taken as constant. There is no advection and no homogeneous (bulk) chemical reaction in the liquid. At the wall, the solute undergoes a first-order surface reaction with intrinsic surface rate constant $k_{s}$, consuming solute at a rate proportional to the wall concentration. Far from the wall, at $x=L$, the liquid is maintained at a fixed solute concentration $c(L,t)=c_{L}$ by a well-stirred reservoir.\n\nStarting from the species conservation law and Fick’s law of diffusion, use a pillbox control volume that straddles the interface at $x=0$ to derive the partially absorbing “radiation boundary condition” (Radiation Boundary Condition (RBC)) that relates the normal diffusive flux to the interfacial solute concentration. Carefully define the outward unit normal used in your derivation.\n\nThen, under steady conditions, solve for the concentration field $c(x)$ in $0\\le x\\le L$ and compute the steady molar flux of solute into the wall. Express the final flux in $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$. No rounding is required; provide your answer as a closed-form analytic expression in terms of $D$, $L$, $k_{s}$, and $c_{L}$.",
            "solution": "The problem is divided into three parts: first, the derivation of the boundary condition at the catalytic wall; second, the solution for the steady-state concentration profile; and third, the calculation of the steady-state flux into the wall.\n\n### Part 1: Derivation of the Radiation Boundary Condition\n\nWe begin with the integral form of the species conservation law for a constant-volume system without homogeneous reaction:\n$$ \\frac{d}{dt} \\int_{V} c \\, dV = -\\oint_{S} \\mathbf{N} \\cdot \\mathbf{n} \\, dS $$\nwhere $c$ is the molar concentration of the solute, $V$ is the control volume, $S$ is the surface enclosing the volume, $\\mathbf{N}$ is the molar flux vector, and $\\mathbf{n}$ is the outward-pointing unit normal vector on the surface $S$.\n\nThe problem states there is no advection, so the molar flux $\\mathbf{N}$ is purely diffusive and is described by Fick's first law. For a one-dimensional system along the $x$-axis, the flux vector is:\n$$ \\mathbf{N} = N_x \\mathbf{i}_x = -D \\frac{\\partial c}{\\partial x} \\mathbf{i}_x $$\nwhere $D$ is the constant molecular diffusivity and $\\mathbf{i}_x$ is the unit vector in the positive $x$-direction.\n\nTo derive the boundary condition at the catalytic wall at $x=0$, we apply the conservation law to a \"pillbox\" control volume. A rigorous approach involves considering a thin control volume within the fluid domain, adjacent to the boundary, and then taking the limit as the thickness of this volume approaches zero. Let the control volume be a thin slab of cross-sectional area $A$ extending from $x=0$ to $x=\\epsilon$, where $\\epsilon$ is a small positive length. The liquid occupies the domain $x \\ge 0$.\n\nFor this control volume, the surface $S$ consists of three parts: a face at $x=0$, a face at $x=\\epsilon$, and the side walls. We assume no flux through the side walls. The outward unit normal vector $\\mathbf{n}$ is $-\\mathbf{i}_x$ at the face $x=0$ and $+\\mathbf{i}_x$ at the face $x=\\epsilon$.\n\nThe surface integral of the flux becomes:\n$$ \\oint_{S} \\mathbf{N} \\cdot \\mathbf{n} \\, dS = \\int_{A_{\\epsilon}} (\\mathbf{N}|_{x=\\epsilon}) \\cdot (\\mathbf{i}_x) \\, dA + \\int_{A_0} (\\mathbf{N}|_{x=0}) \\cdot (-\\mathbf{i}_x) \\, dA $$\n$$ \\oint_{S} \\mathbf{N} \\cdot \\mathbf{n} \\, dS = (N_x|_{x=\\epsilon}) A - (N_x|_{x=0}) A $$\nHere, $N_x|_{x=0}$ represents the flux from the boundary surface *into* the fluid control volume. At this surface, there is a first-order reaction that consumes the solute. The rate of consumption per unit area is given as $k_s c(0,t)$. This consumption of solute at the wall constitutes a flux of solute *out of* the fluid. Therefore, the flux entering the fluid from the boundary at $x=0$ is the negative of the reaction rate.\n$$ N_x|_{x=0} = -k_s c(0,t) $$\nThe term $N_x|_{x=\\epsilon}$ is the flux within the fluid at position $x=\\epsilon$.\n\nThe conservation equation for our control volume is:\n$$ \\frac{d}{dt} \\int_{0}^{\\epsilon} c(x,t) A \\, dx = - \\left[ (N_x|_{x=\\epsilon}) A - (N_x|_{x=0}) A \\right] $$\nDividing by the area $A$ and substituting the expression for $N_x|_{x=0}$:\n$$ \\frac{d}{dt} \\int_{0}^{\\epsilon} c(x,t) \\, dx = - N_x|_{x=\\epsilon} + (-k_s c(0,t)) $$\n$$ \\frac{d}{dt} \\int_{0}^{\\epsilon} c(x,t) \\, dx = -N_x|_{x=\\epsilon} - k_s c(0,t) $$\nNow, we take the limit as the thickness of the pillbox goes to zero, $\\epsilon \\to 0$. Assuming the concentration $c(x,t)$ is a continuous function, the integral on the left-hand side vanishes:\n$$ \\lim_{\\epsilon \\to 0} \\frac{d}{dt} \\int_{0}^{\\epsilon} c(x,t) \\, dx = 0 $$\nThe flux $N_x(x,t)$ is also assumed to be continuous for $x  0$, so $\\lim_{\\epsilon \\to 0} N_x|_{x=\\epsilon} = N_x|_{x=0^+}$, which is the flux at the fluid side of the boundary. The equation becomes:\n$$ 0 = -N_x|_{x=0^+} - k_s c(0,t) \\implies N_x|_{x=0^+} = -k_s c(0,t) $$\nSubstituting Fick's law, $N_x = -D \\frac{\\partial c}{\\partial x}$, we obtain the boundary condition at $x=0$:\n$$ -D \\frac{\\partial c}{\\partial x} \\bigg|_{x=0} = -k_s c(0,t) $$\n$$ D \\frac{\\partial c}{\\partial x} \\bigg|_{x=0} = k_s c(0,t) $$\nThis is the required partially absorbing or \"radiation\" boundary condition (more commonly known as a Robin boundary condition in this context).\n\n### Part 2: Steady-State Concentration Profile\n\nUnder steady conditions, all time derivatives are zero. The governing equation for the concentration in the bulk liquid ($0  x  L$) is the steady, one-dimensional diffusion equation with no homogeneous reaction:\n$$ \\frac{d}{dx} \\left( -D \\frac{dc}{dx} \\right) = 0 $$\nSince $D$ is constant, this simplifies to:\n$$ \\frac{d^2c}{dx^2} = 0 $$\nThe general solution is obtained by integrating twice with respect to $x$:\n$$ \\frac{dc}{dx} = C_1 $$\n$$ c(x) = C_1 x + C_2 $$\nwhere $C_1$ and $C_2$ are constants of integration. These are determined by the boundary conditions.\n\nThe boundary conditions for the steady-state problem are:\n1. At $x=0$: $D \\frac{dc}{dx} \\bigg|_{x=0} = k_s c(0)$\n2. At $x=L$: $c(L) = c_L$\n\nApplying these to the general solution $c(x) = C_1 x + C_2$:\nFrom the solution, we have $\\frac{dc}{dx} = C_1$ and $c(0) = C_2$.\nApplying the first boundary condition:\n$$ D(C_1) = k_s(C_2) \\implies C_1 = \\frac{k_s}{D} C_2 $$\nApplying the second boundary condition:\n$$ c(L) = C_1 L + C_2 = c_L $$\nNow we have a system of two algebraic equations for $C_1$ and $C_2$. Substitute the expression for $C_1$ into the second equation:\n$$ \\left(\\frac{k_s}{D} C_2\\right) L + C_2 = c_L $$\n$$ C_2 \\left( \\frac{k_s L}{D} + 1 \\right) = c_L $$\n$$ C_2 = \\frac{c_L}{1 + \\frac{k_s L}{D}} = \\frac{D c_L}{D + k_s L} $$\nNow solve for $C_1$:\n$$ C_1 = \\frac{k_s}{D} C_2 = \\frac{k_s}{D} \\left( \\frac{D c_L}{D + k_s L} \\right) = \\frac{k_s c_L}{D + k_s L} $$\nSubstituting the constants $C_1$ and $C_2$ back into the general solution gives the steady-state concentration profile:\n$$ c(x) = \\left( \\frac{k_s c_L}{D + k_s L} \\right) x + \\left( \\frac{D c_L}{D + k_s L} \\right) $$\n$$ c(x) = \\frac{c_L (k_s x + D)}{D + k_s L} $$\n\n### Part 3: Steady Molar Flux into the Wall\n\nThe steady molar flux of the solute is given by $N_x = -D \\frac{dc}{dx}$. Since $\\frac{dc}{dx} = C_1$ is constant, the flux $N_x$ is independent of position $x$, as expected for a steady 1D diffusion problem without bulk reaction.\n$$ N_x = -D C_1 = -D \\left( \\frac{k_s c_L}{D + k_s L} \\right) = -\\frac{D k_s c_L}{D + k_s L} $$\nThe question asks for the \"molar flux of solute *into* the wall\". The wall is at $x=0$, and the liquid is in $x0$. Therefore, the direction \"into the wall\" corresponds to the $-x$ direction. The scalar flux into the wall, let's call it $J_{wall}$, is the projection of the flux vector $\\mathbf{N} = N_x \\mathbf{i}_x$ onto the inward normal vector $(-\\mathbf{i}_x)$:\n$$ J_{wall} = \\mathbf{N}|_{x=0} \\cdot (-\\mathbf{i}_x) = (N_x \\mathbf{i}_x) \\cdot (-\\mathbf{i}_x) = -N_x $$\n$$ J_{wall} = - \\left( -\\frac{D k_s c_L}{D + k_s L} \\right) = \\frac{D k_s c_L}{D + k_s L} $$\nAlternatively, at steady state, the flux of solute to the wall must equal the rate of consumption by the surface reaction. The rate of consumption is $k_s c(0)$.\n$$ c(0) = C_2 = \\frac{D c_L}{D + k_s L} $$\n$$ J_{wall} = k_s c(0) = k_s \\left( \\frac{D c_L}{D + k_s L} \\right) = \\frac{D k_s c_L}{D + k_s L} $$\nBoth methods yield the same result. The expression is positive, indicating a net flux of solute from the liquid into the wall, consistent with consumption. The units are $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$.",
            "answer": "$$ \\boxed{\\frac{D k_s c_L}{D + k_s L}} $$"
        },
        {
            "introduction": "We now integrate all three core mechanisms—advection, diffusion, and reaction—into a single, comprehensive problem that reflects many real-world systems. This hands-on practice  involves solving the full steady-state transport equation, including both bulk reaction and realistic boundary conditions that describe mass transfer with an external environment. By analyzing the solution's dependence on key dimensionless parameters like the Biot number, you will gain a quantitative understanding of how these competing processes determine the final concentration profile in a reactive flow.",
            "id": "3497253",
            "problem": "Consider a one-dimensional, steady transport of a single chemical species in a bounded domain $x \\in [0,L]$ with uniform advection velocity $U$, molecular diffusivity $D$, and first-order bulk reaction rate $\\lambda$. The interfacial mass transfer at both ends of the domain is governed by a reactive Robin boundary condition derived from a linear interfacial law, namely $-D \\nabla c \\cdot n = k (c - c_\\infty)$, where $k$ is an interfacial transfer coefficient and $c_\\infty$ is the reservoir concentration. The outward unit normal $n$ points to $-x$ at $x=0$ and to $+x$ at $x=L$. The Biot number $\\mathrm{Bi}$ is defined by $\\mathrm{Bi} = \\dfrac{k L}{D}$. Starting from the species conservation principle (no volumetric source other than the bulk reaction) and the standard constitutive relation for the advective-diffusive flux, derive the steady boundary-value problem that determines $c(x)$ under uniform $U$, constant $D$, and constant $\\lambda$, together with the reactive boundary conditions at $x=0$ and $x=L$. Then, compute how the Biot number $\\mathrm{Bi}$ alters the steady-state concentration profile under advection by evaluating three quantitative metrics for several parameter sets: the inlet-normalized concentration $c(0)/c_\\infty$, the outlet-normalized concentration $c(L)/c_\\infty$, and the domain-average-normalized concentration $\\left(\\dfrac{1}{L} \\int_0^L c(x)\\,dx\\right)/c_\\infty$.\n\nAll variables and parameters are to be treated as dimensionless for this exercise. Use $L=1$, $D=1$, and $c_\\infty=1$ in all computations, so that $\\mathrm{Bi} = k$. Your program must solve the steady boundary-value problem exactly (not approximately) for the specified parameter sets, leveraging closed-form analysis of the linear ordinary differential equation with constant coefficients and applying the specified reactive Robin boundary conditions at both ends.\n\nTest suite specification:\n- Case $1$ (happy path, moderate advection, moderate reaction, moderate interfacial transfer): $U=1$, $\\lambda=0.5$, $k=1$, $L=1$, $D=1$, $c_\\infty=1$.\n- Case $2$ (edge case with insulating boundaries, positive reaction): $U=1$, $\\lambda=0.5$, $k=0$, $L=1$, $D=1$, $c_\\infty=1$.\n- Case $3$ (strong advection, weak reaction, strong interfacial transfer): $U=20$, $\\lambda=0.1$, $k=5$, $L=1$, $D=1$, $c_\\infty=1$.\n- Case $4$ (no advection, diffusion-reaction balance, finite interfacial transfer): $U=0$, $\\lambda=0.2$, $k=2$, $L=1$, $D=1$, $c_\\infty=1$.\n- Case $5$ (degenerate bulk dynamics, reactive boundaries only): $U=0$, $\\lambda=0$, $k=3$, $L=1$, $D=1$, $c_\\infty=1$.\n\nAnswer specification:\n- For each case, compute the list $[c(0)/c_\\infty,\\;c(L)/c_\\infty,\\;\\left(\\dfrac{1}{L}\\int_0^L c(x)\\,dx\\right)/c_\\infty]$ as dimensionless floats.\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list of these three-element lists, enclosed in square brackets, with no spaces. For example: $[[r_{11},r_{12},r_{13}],[r_{21},r_{22},r_{23}],\\dots]$ where each $r_{ij}$ is a float.\n\nEnsure scientific realism by deriving the governing equation and boundary conditions from conservation and constitutive laws, and by using the reactive Robin boundary condition consistently with outward normals at each boundary. Do not assume any shortcut formulas; derive from first principles. All outputs are dimensionless floats, and no physical units are required.",
            "solution": "The problem requires the derivation and analytical solution of a one-dimensional, steady-state advection-diffusion-reaction boundary-value problem (BVP), followed by the computation of specific concentration metrics for a given set of parameters.\n\n### Step 1: Derivation of the Governing Equation and Boundary Conditions\n\nThe derivation begins with the principle of mass conservation for a chemical species with concentration $c(x,t)$. In a control volume, the rate of change of the species' mass is balanced by the net flux across the boundaries and the rate of production or consumption by chemical reactions. For a steady state ($\\partial c / \\partial t = 0$) and a one-dimensional domain $x \\in [0, L]$, the conservation law is:\n$$\n\\frac{dJ}{dx} + R = 0\n$$\nwhere $J(x)$ is the total mass flux and $R$ is the volumetric reaction rate.\n\nThe flux $J$ is composed of an advective component, $J_a = Uc$, due to bulk fluid motion with velocity $U$, and a diffusive component, $J_d = -D \\frac{dc}{dx}$, described by Fick's first law, where $D$ is the molecular diffusivity. The total flux is:\n$$\nJ(x) = Uc(x) - D \\frac{dc}{dx}\n$$\nThe problem specifies a first-order bulk reaction, so the consumption rate is proportional to the local concentration: $R = \\lambda c$, where $\\lambda$ is the reaction rate constant.\n\nSubstituting the expressions for $J$ and $R$ into the conservation equation yields:\n$$\n\\frac{d}{dx} \\left( Uc(x) - D \\frac{dc}{dx} \\right) + \\lambda c(x) = 0\n$$\nAssuming uniform velocity $U$ and constant diffusivity $D$, the equation becomes:\n$$\nU \\frac{dc}{dx} - D \\frac{d^2c}{dx^2} + \\lambda c = 0\n$$\nRearranging into the standard form for a second-order linear ordinary differential equation (ODE) gives the governing equation:\n$$\nD \\frac{d^2c}{dx^2} - U \\frac{dc}{dx} - \\lambda c = 0\n$$\n\nThe boundary conditions are of the reactive Robin type, given by $-D \\nabla c \\cdot \\mathbf{n} = k(c - c_\\infty)$, where $k$ is an interfacial mass transfer coefficient, $c_\\infty$ is a constant reservoir concentration, and $\\mathbf{n}$ is the outward unit normal vector.\n\nAt the inlet, $x=0$, the outward normal is $\\mathbf{n} = -\\mathbf{e}_x$. The gradient is $\\nabla c = \\frac{dc}{dx} \\mathbf{e}_x$. Thus, $\\nabla c \\cdot \\mathbf{n} = -\\frac{dc}{dx}$. The boundary condition at $x=0$ becomes:\n$$\n-D \\left(-\\frac{dc}{dx}\\right)\\Big|_{x=0} = k(c(0) - c_\\infty) \\implies D \\frac{dc}{dx}\\Big|_{x=0} = k(c(0) - c_\\infty)\n$$\n\nAt the outlet, $x=L$, the outward normal is $\\mathbf{n} = +\\mathbf{e}_x$. Thus, $\\nabla c \\cdot \\mathbf{n} = \\frac{dc}{dx}$. The boundary condition at $x=L$ becomes:\n$$\n-D \\frac{dc}{dx}\\Big|_{x=L} = k(c(L) - c_\\infty)\n$$\n\n### Step 2: Analytical Solution of the Boundary-Value Problem\n\nThe governing ODE, $D c'' - U c' - \\lambda c = 0$, is a homogeneous linear second-order ODE with constant coefficients. We seek a solution of the form $c(x) = e^{rx}$, which leads to the characteristic equation:\n$$\nDr^2 - Ur - \\lambda = 0\n$$\nThe roots of this quadratic equation are:\n$$\nr = \\frac{U \\pm \\sqrt{U^2 + 4D\\lambda}}{2D}\n$$\nSince $D0$ and $\\lambda \\ge 0$, the discriminant $\\Delta^2 = U^2 + 4D\\lambda$ is always non-negative.\n\n**Case A: Distinct Real Roots ($\\Delta^2  0$)**\nThis occurs unless $U=0$ and $\\lambda=0$ simultaneously. The two distinct real roots are:\n$$\nr_1 = \\frac{U + \\sqrt{U^2 + 4D\\lambda}}{2D}, \\quad r_2 = \\frac{U - \\sqrt{U^2 + 4D\\lambda}}{2D}\n$$\nThe general solution is a linear combination of the exponential functions corresponding to these roots:\n$$\nc(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x}\n$$\nThe derivative is $c'(x) = C_1 r_1 e^{r_1 x} + C_2 r_2 e^{r_2 x}$. The constants $C_1$ and $C_2$ are determined by applying the two boundary conditions, which results in a $2 \\times 2$ system of linear equations:\n$$\n\\begin{cases}\nD(C_1 r_1 + C_2 r_2) = k(C_1 + C_2 - c_\\infty) \\\\\n-D(C_1 r_1 e^{r_1 L} + C_2 r_2 e^{r_2 L}) = k(C_1 e^{r_1 L} + C_2 e^{r_2 L} - c_\\infty)\n\\end{cases}\n$$\nRearranging this system:\n$$\n\\begin{pmatrix}\nDr_1 - k  Dr_2 - k \\\\\ne^{r_1 L}(Dr_1 + k)  e^{r_2 L}(Dr_2 + k)\n\\end{pmatrix}\n\\begin{pmatrix} C_1 \\\\ C_2 \\end{pmatrix}\n=\n\\begin{pmatrix} -k c_\\infty \\\\ k c_\\infty \\end{pmatrix}\n$$\nThis system can be solved for $C_1$ and $C_2$ using standard methods such as Cramer's rule, provided the determinant of the matrix is non-zero. For the given test cases where this form applies, the system is non-singular.\n\n**Case B: Repeated Root ($\\Delta^2 = 0$)**\nThis degenerate case occurs only if $U=0$ and $\\lambda=0$. The characteristic equation becomes $Dr^2=0$, with a repeated root $r=0$. The governing ODE simplifies to $D c'' = 0$.\nThe general solution is a linear function:\n$$\nc(x) = C_1 x + C_2\n$$\nApplying the boundary conditions with $U=0, \\lambda=0$:\n$D C_1 = k(C_2 - c_\\infty)$ at $x=0$.\n$-D C_1 = k(C_1 L + C_2 - c_\\infty)$ at $x=L$.\nAdding these two equations gives $0 = k(C_1 L + 2C_2 - 2c_\\infty)$. Substituting $C_2 = DC_1/k + c_\\infty$ from the first equation into this sum yields $A(kL+2D)=0$. Since $k,L,D$ are positive, this forces $C_1=0$. Substituting back gives $C_2=c_\\infty$. The unique solution is $c(x) = c_\\infty$.\n\n### Step 3: Calculation of Quantitative Metrics\n\nThe problem requires three dimensionless metrics, calculated using $L=1$, $D=1$, and $c_\\infty=1$:\n1.  **Inlet-normalized concentration:** $c(0)/c_\\infty = (C_1 + C_2)/c_\\infty$\n2.  **Outlet-normalized concentration:** $c(L)/c_\\infty = (C_1 e^{r_1 L} + C_2 e^{r_2 L})/c_\\infty$\n3.  **Domain-average-normalized concentration:** $\\left(\\dfrac{1}{L} \\int_0^L c(x)\\,dx\\right)/c_\\infty$\n\nFor the general solution $c(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x}$, the integral is:\n$$\n\\int_0^L c(x)\\,dx = \\int_0^L (C_1 e^{r_1 x} + C_2 e^{r_2 x}) \\,dx\n$$\nIf neither root is zero ($r_1, r_2 \\neq 0$):\n$$\n\\int_0^L c(x)\\,dx = C_1 \\left[\\frac{e^{r_1 x}}{r_1}\\right]_0^L + C_2 \\left[\\frac{e^{r_2 x}}{r_2}\\right]_0^L = C_1 \\frac{e^{r_1 L}-1}{r_1} + C_2 \\frac{e^{r_2 L}-1}{r_2}\n$$\nIf one root is zero (e.g., $r_2=0$, which occurs if $\\lambda=0, U \\neq 0$), the integral for that term becomes $\\int_0^L C_2 \\,dx = C_2 L$. The computational algorithm must account for this possibility.\n\nThe calculation for each test case proceeds by determining the solution form (general or degenerate), solving for the coefficients $C_1$ and $C_2$, and then evaluating the three metrics using the expressions above. The special case where $k=0$ and $\\lambda0$ (insulating boundaries with consumption) leads to a homogeneous BVP whose only solution is the trivial one, $c(x)=0$, resulting in all metrics being $0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_metrics(U, lamb, k, L, D, c_inf):\n    \"\"\"\n    Solves the 1D steady-state advection-diffusion-reaction BVP and computes metrics.\n\n    The BVP is:\n    D * c'' - U * c' - lambda * c = 0\n    BC at x=0: D * c'(0) = k * (c(0) - c_inf)\n    BC at x=L: -D * c'(L) = k * (c(L) - c_inf)\n\n    Args:\n        U (float): Advection velocity.\n        lamb (float): First-order reaction rate.\n        k (float): Interfacial transfer coefficient.\n        L (float): Domain length.\n        D (float): Diffusivity.\n        c_inf (float): Reservoir concentration.\n\n    Returns:\n        list: A list of three floats: [c(0)/c_inf, c(L)/c_inf, c/c_inf].\n    \"\"\"\n    # Handle the degenerate bulk dynamics case: pure diffusion, no reaction.\n    if np.isclose(U, 0.0) and np.isclose(lamb, 0.0):\n        # In this case, the ODE is D*c'' = 0, so c(x) = C1*x + C2.\n        # The boundary conditions enforce C1 = 0 and C2 = c_inf.\n        # Thus, c(x) = c_inf for all x.\n        return [1.0, 1.0, 1.0]\n\n    # For all other cases, solve the characteristic equation: D*r^2 - U*r - lamb = 0\n    discriminant = U**2 + 4 * D * lamb\n    \n    # The discriminant is always non-negative. The roots are real.\n    delta = np.sqrt(discriminant)\n    r1 = (U + delta) / (2 * D)\n    r2 = (U - delta) / (2 * D)\n\n    # The general solution is c(x) = A*exp(r1*x) + B*exp(r2*x).\n    # The coefficients A and B are determined by the boundary conditions,\n    # leading to a 2x2 linear system: M * [A, B]^T = RHS.\n    \n    # Equation 1 from BC at x=0: M_11*A + M_12*B = RHS_1\n    M11 = D * r1 - k\n    M12 = D * r2 - k\n    RHS1 = -k * c_inf\n    \n    # Equation 2 from BC at x=L: M_21*A + M_22*B = RHS_2\n    exp_r1L = np.exp(r1 * L)\n    exp_r2L = np.exp(r2 * L)\n    M21 = exp_r1L * (D * r1 + k)\n    M22 = exp_r2L * (D * r2 + k)\n    RHS2 = k * c_inf\n\n    # Solve the 2x2 system using Cramer's rule. The determinant is det_M.\n    det_M = M11 * M22 - M12 * M21\n    \n    # For a physically well-posed problem, det_M should not be zero,\n    # except for cases where the solution is trivial (A=B=0).\n    if np.isclose(det_M, 0):\n        # This occurs if k=0, where RHS is zero. A=B=0 is the only solution\n        # if the homogeneous system has a non-zero determinant, which it does for lambda  0.\n        # Thus, if k=0 and lambda  0 (insulating boundaries, bulk consumption), c(x)=0.\n        A = 0.0\n        B = 0.0\n    else:\n        A = (RHS1 * M22 - RHS2 * M12) / det_M\n        B = (RHS2 * M11 - RHS1 * M21) / det_M\n    \n    # Metric 1: Inlet-normalized concentration c(0)/c_inf\n    c0 = A + B\n    c0_norm = c0 / c_inf\n    \n    # Metric 2: Outlet-normalized concentration c(L)/c_inf\n    cL = A * exp_r1L + B * exp_r2L\n    cL_norm = cL / c_inf\n\n    # Metric 3: Domain-average-normalized concentration c/c_inf\n    # We must calculate the integral of c(x) from 0 to L. A small tolerance is used\n    # to handle cases where a root is numerically close to zero.\n    integral = 0.0\n    if np.isclose(r1, 0.0):\n        integral += A * L\n    else:\n        integral += A * (exp_r1L - 1.0) / r1\n        \n    if np.isclose(r2, 0.0):\n        integral += B * L\n    else:\n        integral += B * (exp_r2L - 1.0) / r2\n        \n    avg_c = integral / L\n    avg_c_norm = avg_c / c_inf\n    \n    return [c0_norm, cL_norm, avg_c_norm]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Format: (U, lambda, k, L, D, c_inf)\n    test_cases = [\n        (1.0, 0.5, 1.0, 1.0, 1.0, 1.0),  # Case 1\n        (1.0, 0.5, 0.0, 1.0, 1.0, 1.0),  # Case 2\n        (20.0, 0.1, 5.0, 1.0, 1.0, 1.0), # Case 3\n        (0.0, 0.2, 2.0, 1.0, 1.0, 1.0),  # Case 4\n        (0.0, 0.0, 3.0, 1.0, 1.0, 1.0),  # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        U, lamb, k, L, D, c_inf = case\n        metrics = calculate_metrics(U, lamb, k, L, D, c_inf)\n        results.append(metrics)\n\n    # Format the final output string exactly as specified.\n    inner_strings = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}