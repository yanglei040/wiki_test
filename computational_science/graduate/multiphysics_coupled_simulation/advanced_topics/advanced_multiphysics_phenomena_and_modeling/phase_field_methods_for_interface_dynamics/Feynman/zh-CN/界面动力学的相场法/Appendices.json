{
    "hands_on_practices": [
        {
            "introduction": "理论与物理现实之间的桥梁是理解任何物理模型的关键。本实践将通过一个基础理论推导，将相场模型中的抽象参数与一个可测量的物理量——表面张力联系起来。我们将从亥姆霍兹自由能泛函出发，通过变分原理推导出静态一维界面轮廓所满足的方程，并最终计算出表面张力 $\\sigma$ 与模型梯度能系数 $\\kappa$ 及双势阱高度 $\\lambda$ 之间的解析关系。这项练习不仅能加深你对相场模型物理内涵的理解，也为如何根据实验数据标定模型参数提供了理论基础。",
            "id": "3521619",
            "problem": "考虑一个二元体系中的一维平面平衡界面，该界面由相场序参量 $\\,\\phi(x)\\,$ 建模，且满足边界条件 $\\,\\phi(-\\infty)=-1\\,$ 和 $\\,\\phi(+\\infty)=+1\\,$. 单位面积的亥姆霍兹自由能泛函为\n$$\n\\mathcal{F}[\\phi] \\;=\\; \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\;+\\; \\lambda\\,W(\\phi) \\right]\\,dx,\n$$\n其中 $\\,\\kappa0\\,$ 是梯度能量系数，$\\,\\lambda0\\,$ 是体能量尺度，双阱势为\n$$\nW(\\phi) \\;=\\; \\frac{1}{4}\\left(\\phi^{2}-1\\right)^{2}.\n$$\n假设系统处于力学平衡状态，且界面是静止且平面的，因此平衡剖面 $\\,\\phi(x)\\,$ 在满足边界条件下使 $\\,\\mathcal{F}\\,$ 最小化。表面张力 $\\,\\sigma\\,$ 定义为与界面相关的单位面积过剩自由能，由下式给出\n$$\n\\sigma \\;=\\; \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\;+\\; \\lambda\\,W(\\phi) \\right]\\,dx,\n$$\n由于 $\\,W(\\pm 1)=0\\,$，均匀体相的贡献已被隐式地减去。\n\n从基本变分原理和一维静态剖面中的能量守恒出发，推导平衡剖面 $\\,\\phi(x)\\,$ 的必要关系式，并以 $\\,\\kappa\\,$ 和 $\\,\\lambda\\,$ 的解析表达式形式，计算 $\\,\\sigma\\,$ 的闭合解。然后，解释该值与在保持相同体相热力学性质的同时，取界面厚度为零的极限所得到的相应尖锐界面表面张力相比如何。\n\n请以 $\\,\\kappa\\,$ 和 $\\,\\lambda\\,$ 的单一、简化的解析表达式形式给出 $\\,\\sigma\\,$ 的最终答案。无需四舍五入。不要在最终的方框答案中包含单位。",
            "solution": "该问题要求推导一维相场模型的平衡剖面方程，并计算相应的表面张力 $\\sigma$。该问题陈述经证实具有科学依据、是适定的且客观的。它代表了扩散界面理论中的一个典型问题。\n\n单位面积的亥姆霍兹自由能泛函由下式给出\n$$\n\\mathcal{F}[\\phi] = \\int_{-\\infty}^{+\\infty} \\mathcal{L}(\\phi, \\phi') \\,dx = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + \\lambda\\,W(\\phi) \\right]\\,dx\n$$\n其中 $\\phi' = \\frac{d\\phi}{dx}$，双阱势为 $W(\\phi) = \\frac{1}{4}(\\phi^2-1)^2$。参数 $\\kappa$ 和 $\\lambda$ 是正常数。边界条件为 $\\phi(x \\to -\\infty) = -1$ 和 $\\phi(x \\to +\\infty) = +1$。\n\n平衡剖面 $\\phi(x)$ 是使该泛函最小化的函数。根据变分法，极小值函数必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi} - \\frac{d}{dx}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\phi'}\\right) = 0\n$$\n首先，我们计算被积函数 $\\mathcal{L}(\\phi, \\phi') = \\frac{\\kappa}{2}(\\phi')^2 + \\lambda W(\\phi)$ 所需的偏导数：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi} = \\lambda \\frac{dW}{d\\phi} = \\lambda \\frac{d}{d\\phi}\\left[\\frac{1}{4}(\\phi^4 - 2\\phi^2 + 1)\\right] = \\lambda (\\phi^3 - \\phi)\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\phi'} = \\kappa \\phi' = \\kappa \\frac{d\\phi}{dx}\n$$\n将这些代入欧拉-拉格朗日方程，得到平衡剖面的控制常微分方程：\n$$\n\\lambda (\\phi^3 - \\phi) - \\frac{d}{dx}\\left(\\kappa \\frac{d\\phi}{dx}\\right) = 0\n$$\n$$\n\\kappa \\frac{d^2\\phi}{dx^2} = \\lambda (\\phi^3 - \\phi)\n$$\n这就是静态一维平衡剖面 $\\phi(x)$ 的必要关系式。\n\n为了计算表面张力 $\\sigma = \\mathcal{F}[\\phi_{\\text{eq}}]$，我们可以先求出欧拉-拉格朗日方程的首次积分。这类似于经典力学问题中的能量守恒。我们将平衡方程乘以 $\\frac{d\\phi}{dx}$：\n$$\n\\kappa \\frac{d^2\\phi}{dx^2}\\frac{d\\phi}{dx} - \\lambda (\\phi^3 - \\phi)\\frac{d\\phi}{dx} = 0\n$$\n认识到每一项都是关于 $x$ 的全导数：\n$$\n\\frac{d}{dx}\\left[\\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2\\right] - \\frac{d}{dx}[\\lambda W(\\phi)] = 0\n$$\n$$\n\\frac{d}{dx}\\left[\\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 - \\lambda W(\\phi)\\right] = 0\n$$\n这意味着方括号中的量沿着剖面是一个常数。我们可以利用在 $x \\to \\pm\\infty$ 处的边界条件来计算这个常数。在无穷远处，系统处于体相，因此剖面是平坦的，$\\frac{d\\phi}{dx} \\to 0$。同时，$\\phi \\to \\pm 1$，根据定义，$W(\\pm 1) = \\frac{1}{4}((\\pm 1)^2 - 1)^2 = 0$。因此，该常数为零。这为平衡剖面提供了一个关键关系：\n$$\n\\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^2 = \\lambda W(\\phi)\n$$\n此关系表明，在界面内的每一点 $x$，梯度能量密度和体势能密度之间存在均分关系。\n\n现在我们可以计算表面张力 $\\sigma$，即平衡剖面对应的泛函 $\\mathcal{F}$ 的值：\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + \\lambda W(\\phi) \\right]\\,dx\n$$\n使用均分关系 $\\lambda W(\\phi) = \\frac{\\kappa}{2}(\\frac{d\\phi}{dx})^2$，我们可以简化被积函数：\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} + \\frac{\\kappa}{2}\\left(\\frac{d\\phi}{dx}\\right)^{2} \\right]\\,dx = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\phi}{dx}\\right)^2 dx\n$$\n一种无需显式求解 $\\phi(x)$ 就能计算此积分的巧妙方法是，将积分变量从 $x$ 更改为 $\\phi$。从均分关系我们得到：\n$$\n\\frac{d\\phi}{dx} = \\sqrt{\\frac{2\\lambda W(\\phi)}{\\kappa}}\n$$\n（我们取正根，因为当 $x$ 从 $-\\infty$ 增加到 $+\\infty$ 时，$\\phi$ 从 $-1$ 增加到 $+1$）。\n我们可以将 $\\sigma$ 的积分写为：\n$$\n\\sigma = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\phi}{dx}\\right) \\left(\\frac{d\\phi}{dx} dx\\right) = \\int_{\\phi(-\\infty)}^{\\phi(+\\infty)} \\kappa \\left(\\frac{d\\phi}{dx}\\right) d\\phi\n$$\n代入 $\\frac{dphi}{dx}$ 的表达式：\n$$\n\\sigma = \\int_{-1}^{+1} \\kappa \\sqrt{\\frac{2\\lambda W(\\phi)}{\\kappa}} d\\phi = \\int_{-1}^{+1} \\sqrt{2\\kappa\\lambda W(\\phi)} d\\phi\n$$\n现在，代入 $W(\\phi) = \\frac{1}{4}(\\phi^2-1)^2$ 的形式。对于 $\\phi \\in [-1, +1]$，$\\sqrt{W(\\phi)} = \\frac{1}{2}(1-\\phi^2)$。\n$$\n\\sigma = \\sqrt{2\\kappa\\lambda} \\int_{-1}^{+1} \\frac{1}{2}(1-\\phi^2) d\\phi\n$$\n该积分很容易计算：\n$$\n\\int_{-1}^{+1} (1-\\phi^2) d\\phi = \\left[\\phi - \\frac{\\phi^3}{3}\\right]_{-1}^{+1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\left(\\frac{2}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n将此结果代回 $\\sigma$ 的表达式中：\n$$\n\\sigma = \\sqrt{2\\kappa\\lambda} \\cdot \\frac{1}{2} \\cdot \\frac{4}{3} = \\frac{2}{3}\\sqrt{2\\kappa\\lambda}\n$$\n这可以写成最终的简化形式：\n$$\n\\sigma = \\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa\\lambda}\n$$\n\n关于与尖锐界面极限的比较：此处推导出的 $\\sigma$ 值是特定扩散界面模型的精确表面张力。在经典的尖銳界面模型中，表面张力（比如 $\\sigma_{\\text{si}}$）是一个给定的热力学参数，代表一个零厚度数学表面的过剩能量。为了连接这两个模型，我们将相场表面张力与尖锐界面值等同起来：$\\sigma = \\sigma_{\\text{si}}$。这个方程为模型参数 $\\kappa$ 和 $\\lambda$ 提供了一个约束。第二个约束来自于定义一个特征界面厚度 $l$。通过对平衡方程进行无量纲化，可以发现 $l$ 的标度关系为 $l \\propto \\sqrt{\\kappa/\\lambda}$。\n“尖锐界面极限”指的是在 $\\sigma_{\\text{si}}$ 保持不变的情况下，$l \\to 0$ 的极限。根据标度关系，如果 $\\sigma \\propto \\sqrt{\\kappa\\lambda}$ 且 $l \\propto \\sqrt{\\kappa/\\lambda}$，我们可以发现 $\\kappa \\propto \\sigma l$ 和 $\\lambda \\propto \\sigma/l$。因此，在保持 $\\sigma$ 恒定的情况下，$l \\to 0$ 的极限对应于 $\\kappa \\to 0$ 和 $\\lambda \\to \\infty$，使得乘积 $\\kappa\\lambda$ 保持不变。我们的表达式正确地表明，如果保持 $\\kappa\\lambda$ 恒定，相场模型的表面张力也保持不变，从而即使界面剖面变得无限陡峭，也能与尖锐界面值保持一致。",
            "answer": "$$\\boxed{\\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa\\lambda}}$$"
        },
        {
            "introduction": "在理解了模型参数的物理意义之后，下一步自然是让界面“动”起来，观察其动态演化过程。本实践将指导你利用高效的半隐式傅里叶谱方法，编写一个求解一维艾伦-卡恩（Allen-Cahn）方程的数值模拟程序。通过该程序，你将亲手研究迁移率函数 $M(\\phi)$（一个关键的动力学参数）的不同形式（常数迁移率与简并迁移率）如何影响界面迁移速度，从而获得对相变动力学直观而深刻的认识。",
            "id": "3521556",
            "problem": "要求您实现并分析一个一维 Allen–Cahn 相场模型，其迁移率在体相中为常数或退化。您的目标是通过从第一性原理计算界面速度，来量化迁移率退化在小热力学驱动力下如何改变界面动力学。完整的程序必须是自包含的，对指定的测试套件执行所需计算，并以本问题末尾描述的精确格式打印聚合结果。\n\n考虑一个标量序参量场 $ \\phi(x,t) \\in [0,1] $，定义在一个周期性一维域 $ x \\in [0,L) $上。该场在 Ginzburg–Landau 自由能驱动下进行 Allen–Cahn 动力学演化，该自由能包含一个双势阱势和一个引起界面运动的微小线性倾斜。自由能泛函为\n$$\n\\mathcal{F}[\\phi] = \\int_{0}^{L} \\left( \\frac{\\epsilon^2}{2} \\left| \\frac{\\partial \\phi}{\\partial x} \\right|^2 + W(\\phi) - h \\, \\phi \\right) \\, dx,\n$$\n其中 $ \\epsilon  0 $ 设定了界面厚度，$ W(\\phi) = \\phi^2 (1-\\phi)^2 $ 是双势阱势，$ h \\in \\mathbb{R} $ 是一个偏置两个势阱的微小常数倾斜。变分导数（化学势）为\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = - \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} + W'(\\phi) - h,\n$$\n其中 $ W'(\\phi) = 2 \\phi (1-\\phi)(1-2\\phi) $。Allen–Cahn 演化是弛豫动力学\n$$\n\\frac{\\partial \\phi}{\\partial t} = - M(\\phi) \\, \\mu = M(\\phi) \\left( \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} - W'(\\phi) + h \\right),\n$$\n其中 $ M(\\phi) $ 是迁移率。您将研究两种情况：\n- 恒定迁移率：$ M(\\phi) = M_0 $，其中 $ M_0  0 $ 是常数。\n- 退化迁移率：$ M(\\phi) = M_0 \\, \\phi^2 (1-\\phi)^2 $，该迁移率在体相 $ \\phi = 0 $ 和 $ \\phi = 1 $ 中为零，在界面附近 $ \\phi \\approx 1/2 $ 处达到最大值。\n\n初始条件：一个位于 $ x_0 = L/2 $ 中心的弥散界面，\n$$\n\\phi(x,0) = \\frac{1}{2} \\left[ 1 - \\tanh \\left( \\frac{x - x_0}{\\sqrt{2} \\, w} \\right) \\right],\n$$\n其平滑宽度 $ w $ 与 $ \\epsilon $ 成比例选取，以确保界面被良好地解析。\n\n您必须从第一性原理推导出一个数值稳定的半隐式时间步进格式，其中线性扩散项使用常数算子进行隐式处理，而非线性项和变系数项则进行显式处理。使用周期性空间离散化和快速傅里叶变换（FFT），通过在傅里叶空间中对角化来高效地实现隐式线性求解。具体来说，写出以下形式的更新方程\n$$\n\\left( I - \\Delta t \\, M_0 \\, \\epsilon^2 \\, \\frac{\\partial^2}{\\partial x^2} \\right) \\phi^{n+1} = \\phi^n + \\Delta t \\left[ \\left( M(\\phi^n) - M_0 \\right) \\epsilon^2 \\frac{\\partial^2 \\phi^n}{\\partial x^2} - M(\\phi^n) W'(\\phi^n) + M(\\phi^n) h \\right],\n$$\n其中 $ \\Delta t $ 是时间步长，上标表示时间层级。在周期性边界条件下，左侧的算子在傅里叶空间中是对角的。\n\n将瞬时界面位置 $ x_\\ast(t) $ 定义为最接近 $ x_0 $ 且满足 $ \\phi(x_\\ast(t),t) = 1/2 $ 的唯一位置。使用格点间的线性插值从离散场 $ \\phi(x,t) $ 估计 $ x_\\ast(t) $。由于域是周期性的，使用最小镜像约定计算净位移：\n$$\n\\Delta x = \\mathrm{wrap}( x_\\ast(T) - x_\\ast(0) )\n$$\n其中 $\\mathrm{wrap}(d)$ 定义为\n$$\n\\mathrm{wrap}(d) = \n\\begin{cases}\nd - L  \\text{if } d  L/2, \\\\\nd + L  \\text{if } d  -L/2, \\\\\nd      \\text{otherwise.}\n\\end{cases}\n$$\n则平均界面速度为\n$$\nv = \\frac{\\Delta x}{T},\n$$\n其中 $ T $ 是最终模拟时间。\n\n实现上述数值格式，并对下面的每个测试用例，分别计算在恒定和退化迁移率下获得的速度对 $ v_{\\mathrm{const}} $ 和 $ v_{\\mathrm{deg}} $，以及比率 $R$：\n$$\nR = \n\\begin{cases}\n\\frac{v_{\\mathrm{deg}}}{v_{\\mathrm{const}}},  \\text{if } |v_{\\mathrm{const}}| \\ge \\delta, \\\\\n0,  \\text{if } |v_{\\mathrm{const}}|  \\delta,\n\\end{cases}\n$$\n其中 $ \\delta = 10^{-8} $。\n\n所有模拟都是无量纲的。通过选择时间步长 $ \\Delta t $ 和格点数 $ N $ 以确保界面被充分解析且格式稳定，来保证数值稳定性。\n\n测试套件。所有情况均使用周期域 $ [0,L) $，其中 $ L = 1 $，并在初始条件中设置 $ w = 2 \\epsilon $。使用以下参数集：\n- 情况A（有驱动，薄界面）：$ \\epsilon = 0.01 $, $ h = 0.05 $, $ M_0 = 1.0 $, $ N = 1024 $, $ \\Delta t = 10^{-4} $, $ T = 0.2 $。\n- 情况B（无驱动对照）：$ \\epsilon = 0.01 $, $ h = 0.0 $, $ M_0 = 1.0 $, $ N = 1024 $, $ \\Delta t = 10^{-4} $, $ T = 0.2 $。\n- 情况C（有驱动，宽界面）：$ \\epsilon = 0.02 $, $ h = 0.05 $, $ M_0 = 1.0 $, $ N = 1024 $, $ \\Delta t = 10^{-4} $, $ T = 0.2 $。\n\n对每种情况，计算三个浮点数 $ [v_{\\mathrm{const}}, v_{\\mathrm{deg}}, R] $。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。按顺序连接情况A的三个浮点数，然后是情况B的三个浮点数，再然后是情况C的三个浮点数，从而产生一个包含九个浮点数的扁平列表。在打印输出中，将每个浮点数四舍五入到小数点后恰好六位。例如，打印的行必须具有以下形式\n$$\n[\\text{A1},\\text{A2},\\text{A3},\\text{B1},\\text{B2},\\text{B3},\\text{C1},\\text{C2},\\text{C3}],\n$$\n其中每个占位符都是一个小数点后恰好有六位数的十进制数。",
            "solution": "用户提供了一个计算物理学中定义明确的问题，具体涉及 Allen-Cahn 方程的数值解。该问题具有科学依据，无矛盾之处，并包含了获得唯一解所需的所有必要信息。我将继续进行解的推导和实现。\n\n### 1. 理论框架与数值格式\n\n标量相场 $\\phi(x,t)$ 的演化由 Allen-Cahn 方程控制，这是一种针对 Ginzburg-Landau 自由能泛函 $\\mathcal{F}[\\phi]$ 的梯度下降动力学：\n$$\n\\frac{\\partial \\phi}{\\partial t} = -M(\\phi) \\frac{\\delta \\mathcal{F}}{\\delta \\phi}\n$$\n自由能泛函由下式给出：\n$$\n\\mathcal{F}[\\phi] = \\int_{0}^{L} \\left( \\frac{\\epsilon^2}{2} \\left| \\frac{\\partial \\phi}{\\partial x} \\right|^2 + W(\\phi) - h \\, \\phi \\right) \\, dx\n$$\n其中 $W(\\phi) = \\phi^2 (1-\\phi)^2$ 是双势阱势。变分导数，即化学势 $\\mu$，为：\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta \\phi} = - \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} + W'(\\phi) - h\n$$\n其中 $W'(\\phi) = 2\\phi(1-\\phi)(1-2\\phi)$。这导出了偏微分方程（PDE）：\n$$\n\\frac{\\partial \\phi}{\\partial t} = M(\\phi) \\left( \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} - W'(\\phi) + h \\right)\n$$\n我们分析迁移率 $M(\\phi)$ 的两种形式：常数（$M(\\phi) = M_0$）和退化（$M(\\phi) = M_0 \\phi^2(1-\\phi)^2$）。\n\n为了处理扩散项 $\\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2}$ 的刚性问题，我们采用一个指定的半隐式时间积分格式。该格式将 PDE 分解为一个具有常系数的线性部分（隐式处理）和其余的非线性/变系数部分（显式处理）。我们将 PDE 重写为：\n$$\n\\frac{\\partial \\phi}{\\partial t} = M_0 \\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} + \\left[ (M(\\phi) - M_0)\\epsilon^2 \\frac{\\partial^2 \\phi}{\\partial x^2} - M(\\phi)W'(\\phi) + M(\\phi)h \\right]\n$$\n对显式部分应用前向欧拉步，对隐式部分应用后向欧拉步，得到：\n$$\n\\frac{\\phi^{n+1} - \\phi^n}{\\Delta t} = M_0 \\epsilon^2 \\frac{\\partial^2 \\phi^{n+1}}{\\partial x^2} + \\left[ (M(\\phi^n) - M_0)\\epsilon^2 \\frac{\\partial^2 \\phi^n}{\\partial x^2} - M(\\phi^n)W'(\\phi^n) + M(\\phi^n)h \\right]\n$$\n对 $\\phi^{n+1}$ 进行整理，得到问题中指定的更新方程：\n$$\n\\left( I - \\Delta t \\, M_0 \\, \\epsilon^2 \\, \\frac{\\partial^2}{\\partial x^2} \\right) \\phi^{n+1} = \\text{RHS}(\\phi^n)\n$$\n其中 $I$ 是单位算子，$\\text{RHS}(\\phi^n)$ 集合了所有在当前时间步 $n$ 计算的项：\n$$\n\\text{RHS}(\\phi^n) = \\phi^n + \\Delta t \\left[ \\left( M(\\phi^n) - M_0 \\right) \\epsilon^2 \\frac{\\partial^2 \\phi^n}{\\partial x^2} - M(\\phi^n) W'(\\phi^n) + M(\\phi^n) h \\right]\n$$\n\n### 2. 谱方法实现\n\n问题设置在周期域 $x \\in [0,L)$ 上，这使得基于快速傅里叶变换（FFT）的谱方法非常高效。空间域被离散化为 $N$ 个格点 $x_j = j \\cdot \\Delta x$，其中 $j = 0, \\dots, N-1$，$\\Delta x = L/N$。\n\n在傅里叶空间中，二阶导数算子 $\\frac{\\partial^2}{\\partial x^2}$ 变为乘以 $-q^2$，其中 $q$ 是角波数。对于离散网格，这些是 $q = 2\\pi k$，其中 $k$ 是由 `numpy.fft.fftfreq(N, d=dx)` 给出的空间频率。\n\n令 $\\hat{\\phi}$ 为 $\\phi$ 的 FFT。傅里叶空间中的更新方程变为：\n$$\n\\left( 1 + \\Delta t \\, M_0 \\, \\epsilon^2 \\, q^2 \\right) \\hat{\\phi}^{n+1} = \\widehat{\\text{RHS}}(\\phi^n)\n$$\n我们可以通过简单的逐元素除法来求解 $\\hat{\\phi}^{n+1}$：\n$$\n\\hat{\\phi}^{n+1} = \\frac{\\widehat{\\text{RHS}}(\\phi^n)}{1 + \\Delta t \\, M_0 \\, \\epsilon^2 \\, q^2}\n$$\n然后通过逆 FFT 获得新时间步的场 $\\phi^{n+1}$。\n\n一个时间步的算法如下：\n1.  从实空间的 $\\phi^n$ 和傅里叶空间的 $\\hat{\\phi}^n$ 开始。\n2.  通过对 $-q^2 \\hat{\\phi}^n$ 应用逆 FFT 来计算显式项 $\\frac{\\partial^2 \\phi^n}{\\partial x^2}$。\n3.  在实空间中计算 $W'(\\phi^n)$ 和 $M(\\phi^n)$。\n4.  在实空间中组装完整的 $\\text{RHS}(\\phi^n)$ 表达式。\n5.  计算右侧项的 FFT，即 $\\widehat{\\text{RHS}}$。\n6.  除以分母 $(1 + \\Delta t M_0 \\epsilon^2 q^2)$ 以求得 $\\hat{\\phi}^{n+1}$。\n7.  $\\hat{\\phi}^{n+1}$ 的逆 FFT 的实部即为 $\\phi^{n+1}$。\n\n### 3. 界面速度计算\n\n界面的瞬时位置 $x_*(t)$ 定义为 $\\phi(x,t) = 1/2$ 处的位置。给定离散场 $\\phi_j$，通过识别发生穿越的网格单元 $[x_j, x_{j+1}]$（即 $(\\phi_j - 0.5)(\\phi_{j+1} - 0.5) \\le 0$）并使用线性插值来找到该位置：\n$$\nx_* = x_j + \\Delta x \\frac{0.5 - \\phi_j}{\\phi_{j+1} - \\phi_j}\n$$\n通过检查最后一个和第一个格点之间的穿越来处理域的周期性。如果存在多个穿越点，则选择最接近初始中心 $x_0 = L/2$ 的那个。\n\n在总模拟时间 $T$ 内的净位移 $\\Delta x$ 计算为 $\\Delta x = x_*(T) - x_*(0)$，并使用最小镜像约定进行周期性调整：\n$$\n\\Delta x \\to \\Delta x - L \\quad \\text{if } \\Delta x  L/2\n$$\n$$\n\\Delta x \\to \\Delta x + L \\quad \\text{if } \\Delta x  -L/2\n$$\n平均速度则为 $v = \\Delta x / T$。\n\n对于每个测试用例，我们计算恒定迁移率下的速度 $v_{\\mathrm{const}}$ 和退化迁移率下的速度 $v_{\\mathrm{deg}}$。比率 $R$ 计算为 $v_{\\mathrm{deg}}/v_{\\mathrm{const}}$，并设置一个阈值以防止在界面静止时出现除以零的情况。\n\n实现将包括一个主函数，用于遍历测试套件，并调用一个执行时间步进循环和计算速度的模拟函数。问题陈述中提供的所有参数都将直接使用。",
            "answer": "```python\n#\n# Meticulous and Exacting Professor: STEM Fields\n# Final Answer: Allen-Cahn Phase-Field Simulation\n#\nimport numpy as np\n\ndef W_prime(phi):\n    \"\"\"Derivative of the double-well potential W(phi) = phi^2 * (1-phi)^2.\"\"\"\n    return 2.0 * phi * (1.0 - phi) * (1.0 - 2.0 * phi)\n\ndef M_const(phi, M0):\n    \"\"\"Constant mobility function.\"\"\"\n    return np.full_like(phi, M0)\n\ndef M_degen(phi, M0):\n    \"\"\"Degenerate mobility function.\"\"\"\n    return M0 * phi**2 * (1.0 - phi)**2\n\ndef find_interface_position(x, phi, L, x0_center):\n    \"\"\"\n    Finds the interface position (phi=0.5) using linear interpolation.\n    Handles periodic boundaries and selects the crossing nearest to x0_center.\n    \"\"\"\n    N = len(x)\n    dx = L / N\n    \n    phi_shifted = np.roll(phi, -1)\n    # Find indices j where a sign change occurs for phi-0.5\n    indices = np.where((phi - 0.5) * (phi_shifted - 0.5) = 0)[0]\n\n    if indices.size == 0:\n        center_idx = np.argmin(np.abs(phi - 0.5))\n        return x[center_idx]\n        \n    crossings = []\n    for j in indices:\n        phi_j = phi[j]\n        phi_j1 = phi_shifted[j]\n        \n        delta_phi = phi_j1 - phi_j\n        if np.abs(delta_phi)  1e-12:\n            if np.abs(phi_j - 0.5)  1e-9: # Point is on the crossing\n                crossings.append(x[j])\n            continue\n        \n        pos = x[j] + dx * (0.5 - phi_j) / delta_phi\n        crossings.append(pos)\n    \n    if not crossings:\n        center_idx = np.argmin(np.abs(phi - 0.5))\n        return x[center_idx]\n        \n    crossings = np.array(crossings)\n    crossings = crossings % L\n    \n    dist = np.abs(crossings - x0_center)\n    dist = np.minimum(dist, L - dist)\n    \n    return crossings[np.argmin(dist)]\n\ndef run_simulation(L, N, T, dt, eps, h, M0, mobility_type):\n    \"\"\"Runs a single Allen-Cahn simulation.\"\"\"\n    dx = L / N\n    x = np.arange(N) * dx\n    q = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n    laplacian_k = -q**2\n\n    w = 2.0 * eps\n    x0_center = L / 2.0\n    phi_initial = 0.5 * (1.0 - np.tanh((x - x0_center) / (np.sqrt(2.0) * w)))\n    \n    pos0 = find_interface_position(x, phi_initial, L, x0_center)\n\n    mobility_map = {'const': M_const, 'degen': M_degen}\n    M_func = mobility_map[mobility_type]\n\n    num_steps = int(round(T / dt))\n    phi_k = np.fft.fft(phi_initial)\n    \n    denominator = 1.0 - dt * M0 * eps**2 * laplacian_k\n    denominator[np.abs(denominator)  1e-12] = 1.0\n\n    for _ in range(num_steps):\n        phi = np.fft.ifft(phi_k).real\n        M_phi = M_func(phi, M0)\n        W_p = W_prime(phi)\n        \n        if mobility_type == 'const':\n            rhs = phi + dt * (-M_phi * W_p + M_phi * h)\n        else:\n            lap_phi = np.fft.ifft(laplacian_k * phi_k).real\n            rhs = phi + dt * ((M_phi - M0) * eps**2 * lap_phi - M_phi * W_p + M_phi * h)\n        \n        rhs_k = np.fft.fft(rhs)\n        phi_k = rhs_k / denominator\n\n    phi_final = np.fft.ifft(phi_k).real\n    \n    pos_final = find_interface_position(x, phi_final, L, x0_center)\n    \n    delta_x = pos_final - pos0\n    if delta_x > L / 2.0:\n        delta_x -= L\n    elif delta_x  -L / 2.0:\n        delta_x += L\n        \n    velocity = delta_x / T\n    \n    return velocity\n\ndef solve():\n    \"\"\"Main function to run the test suite and print results.\"\"\"\n    test_suite = [\n        # Case A (driven, thin interface)\n        {'eps': 0.01, 'h': 0.05, 'T': 0.2, 'N': 1024, 'dt': 1e-4},\n        # Case B (undriven control)\n        {'eps': 0.01, 'h': 0.0, 'T': 0.2, 'N': 1024, 'dt': 1e-4},\n        # Case C (driven, wider interface)\n        {'eps': 0.02, 'h': 0.05, 'T': 0.2, 'N': 1024, 'dt': 1e-4},\n    ]\n    \n    common_params = {'L': 1.0, 'M0': 1.0}\n    delta_R = 1e-8\n    \n    results = []\n    for case_params in test_suite:\n        params = {**common_params, **case_params}\n        \n        v_const = run_simulation(**params, mobility_type='const')\n        v_deg = run_simulation(**params, mobility_type='degen')\n        \n        R = 0.0\n        if abs(v_const) >= delta_R:\n            R = v_deg / v_const\n            \n        results.extend([v_const, v_deg, R])\n\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver\nsolve()\n```"
        }
    ]
}