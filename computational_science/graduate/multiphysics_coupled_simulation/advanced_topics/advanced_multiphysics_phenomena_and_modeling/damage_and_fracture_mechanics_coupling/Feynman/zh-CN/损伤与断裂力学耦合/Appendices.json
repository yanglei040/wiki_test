{
    "hands_on_practices": [
        {
            "introduction": "本练习为您提供了进入连续介质损伤力学的实用切入点，重点关注一种关键的物理行为：材料对拉伸和压缩的不同响应。通过实现一个带有应力谱分解的局部损伤模型，您将学习如何捕捉这种不对称性，并理解其在不同加载条件下对材料应力-应变响应的影响。这项实践对于模拟混凝土或陶瓷等准脆性材料至关重要。",
            "id": "3501250",
            "problem": "考虑一个在无侧限压缩试验及相关加载路径下的小应变、线性弹性、各向同性材料。标量损伤变量 $d \\in [0,1]$ 通过拉压分离与弹性力学耦合，该分离仅降低与拉伸相关的能量和应力贡献。控制基础是各向同性线弹性的柯西应力-应变关系、对称张量的谱分解以及基于能量的（局部）损伤演化法则。使用以下基本事实作为出发点：\n- 柯西应力 $\\boldsymbol{\\sigma}$ 与无穷小应变 $\\boldsymbol{\\varepsilon}$ 通过胡克定律相关联：$\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$，其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，$\\boldsymbol{I}$ 是二阶单位张量。\n- 拉梅参数满足 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 和 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$，其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n- 对称张量的谱分解使用其主值和标准正交特征向量。对于任意标量 $x$，其正部和负部分别定义为 $\\langle x \\rangle_{+} = \\max(x,0)$ 和 $\\langle x \\rangle_{-} = \\min(x,0)$。\n\n拉压分离模型假设：\n- 根据胡克定律计算无损应力 $\\boldsymbol{\\sigma}^{0}$。\n- 通过对 $\\boldsymbol{\\sigma}^{0}$ 的主应力应用 $\\langle \\cdot \\rangle_{+}$ 和 $\\langle \\cdot \\rangle_{-}$，并将 $\\boldsymbol{\\sigma}^{0}$ 谱分解为 $\\boldsymbol{\\sigma}^{0}_{+}$ 和 $\\boldsymbol{\\sigma}^{0}_{-}$，然后用相应的特征向量重构。\n- 损伤驱动的正应变能密度定义为 $\\psi_{+} = \\dfrac{1}{2} \\sum_{i=1}^{3} \\langle \\sigma^{0}_{i} \\rangle_{+} \\, \\varepsilon_{i}$，其中 $\\sigma^{0}_{i}$ 和 $\\varepsilon_{i}$ 是共轴状态下应力和应变的第 $i$ 个主值。只有正应力部分对 $\\psi_{+}$ 有贡献。\n- 总应力为 $\\boldsymbol{\\sigma} = (1-d) \\boldsymbol{\\sigma}^{0}_{+} + \\boldsymbol{\\sigma}^{0}_{-}$。\n- 损伤变量 $d$ 通过一个光滑的局部法则 $d = 1 - \\exp\\!\\left( - \\dfrac{\\psi_{+}}{R} \\right)$ 从正能量演化而来，其中 $R$ 是一个材料损伤能量标度，单位为单位体积的能量。\n\n无侧限（自由侧面）单轴加载运动学：\n- 对于在零侧向应力 $\\sigma_{y} = \\sigma_{z} = 0$ 条件下施加的轴向工程应变 $\\varepsilon_{x}$，必须根据本构律和边界条件一致地确定侧向应变 $\\varepsilon_{y}$ 和 $\\varepsilon_{z}$。\n- 对于静水加载，应变由 $\\boldsymbol{\\varepsilon} = \\varepsilon_{h} \\boldsymbol{I}$ 指定。\n\n所有测试案例的材料和数值参数：\n- 杨氏模量 $E = 30 \\times 10^{9} \\ \\mathrm{Pa}$。\n- 泊松比 $\\nu = 0.25$。\n- 损伤能量标度 $R = 2 \\times 10^{5} \\ \\mathrm{J/m^{3}}$。\n- 零损伤验证容差 $\\tau = 10^{-12}$。\n\n需要实现的任务：\n1. 使用胡克定律和边界条件，为每个测试案例计算 $\\boldsymbol{\\sigma}^{0}$ 和应变主值。\n2. 对 $\\boldsymbol{\\sigma}^{0}$ 进行谱分解的拉压分离，构造 $\\boldsymbol{\\sigma}^{0}_{+}$ 和 $\\boldsymbol{\\sigma}^{0}_{-}$，并评估正能量 $\\psi_{+}$。\n3. 计算标量损伤 $d$ 和最终应力 $\\boldsymbol{\\sigma} = (1-d)\\boldsymbol{\\sigma}^{0}_{+} + \\boldsymbol{\\sigma}^{0}_{-}$。\n4. 报告轴向柯西应力分量 $\\sigma_{x}$（单位为帕斯卡）和损伤标量 $d$。同时报告一个布尔标志，指示是否满足 $|d| \\le \\tau$。\n\n测试套件：\n- 案例 $\\mathrm{T1}$（无侧限单轴压缩，“理想路径”）：轴向应变 $\\varepsilon_{x} = -5 \\times 10^{-3}$，侧面无牵引力（$\\sigma_{y}=\\sigma_{z}=0$）。\n- 案例 $\\mathrm{T2}$（无侧限单轴拉伸）：轴向应变 $\\varepsilon_{x} = +5 \\times 10^{-3}$，侧面无牵引力（$\\sigma_{y}=\\sigma_{z}=0$）。\n- 案例 $\\mathrm{T3}$（边界情况，零轴向应变）：轴向应变 $\\varepsilon_{x} = 0$，侧面无牵引力（$\\sigma_{y}=\\sigma_{z}=0$）。\n- 案例 $\\mathrm{T4}$（边缘情况，静水压缩）：静水应变 $\\varepsilon_{h} = -2 \\times 10^{-3}$。\n\n对于每个测试案例，程序必须输出一个列表 $[\\sigma_{x}, d, \\mathrm{is\\_zero}]$，其中 $\\sigma_{x}$ 是轴向柯西应力（单位为 $\\mathrm{Pa}$），$d$ 是计算出的损伤标量，$\\mathrm{is\\_zero}$ 是一个指示 $|d| \\le \\tau$ 的布尔值。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[[\\sigma_{x}^{(1)}, d^{(1)}, \\mathrm{is\\_zero}^{(1)}],[\\sigma_{x}^{(2)}, d^{(2)}, \\mathrm{is\\_zero}^{(2)}],\\ldots]$）。数值结果中，应力的单位必须是 $\\mathrm{Pa}$，$d$ 必须是无量纲的浮点数。",
            "solution": "问题陈述已经过严格验证，被认为是科学合理的、适定的、客观的且内部一致的。它在连续介质损伤力学领域内提供了一个清晰、可形式化的任务。所有必需的材料参数、本构律和加载条件都已指定，从而使得每个测试案例都有一个唯一且有意义的解。\n\n求解过程包括将线弹性原理和指定的损伤模型应用于四个不同的加载案例。我们首先根据给定的杨氏模量 $E$ 和泊松比 $\\nu$ 计算材料的拉梅参数。\n\n给定材料参数：\n- 杨氏模量 $E = 30 \\times 10^{9} \\ \\mathrm{Pa}$。\n- 泊松比 $\\nu = 0.25$。\n- 损伤能量标度 $R = 2 \\times 10^{5} \\ \\mathrm{J/m^{3}}$。\n\n拉梅参数 $\\mu$ 和 $\\lambda$ 计算如下：\n$$ \\mu = \\dfrac{E}{2(1+\\nu)} = \\dfrac{30 \\times 10^{9} \\ \\mathrm{Pa}}{2(1+0.25)} = 12 \\times 10^{9} \\ \\mathrm{Pa} $$\n$$ \\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)} = \\dfrac{(30 \\times 10^{9} \\ \\mathrm{Pa}) \\times 0.25}{(1+0.25)(1-2 \\times 0.25)} = \\dfrac{7.5 \\times 10^{9} \\ \\mathrm{Pa}}{1.25 \\times 0.5} = 12 \\times 10^{9} \\ \\mathrm{Pa} $$\n\n每个测试案例的分析过程如下。\n\n**无侧限单轴加载分析（案例 T1、T2、T3）**\n\n在这些案例中，施加了轴向应变 $\\varepsilon_{x}$，且侧面无牵引力，意味着最终的柯西应力 $\\sigma_{y}$ 和 $\\sigma_{z}$ 为零。总应力由 $\\boldsymbol{\\sigma} = (1-d) \\boldsymbol{\\sigma}^{0}_{+} + \\boldsymbol{\\sigma}^{0}_{-}$ 给出，其中 $\\boldsymbol{\\sigma}^{0}_{+}$ 和 $\\boldsymbol{\\sigma}^{0}_{-}$ 是通过对无损应力 $\\boldsymbol{\\sigma}^{0}$ 进行谱分解得到的。由于加载的轴对称性，应力和应变的主轴与坐标系对齐，我们可以假设 $\\varepsilon_y = \\varepsilon_z$。无损主应力为 $\\sigma^0_x, \\sigma^0_y, \\sigma^0_z$。\n\n条件 $\\sigma_y=0$ 可写为：\n$$ \\sigma_y = (1-d) \\langle \\sigma^0_y \\rangle_{+} + \\langle \\sigma^0_y \\rangle_{-} = 0 $$\n如果 $\\sigma^0_y > 0$，则变为 $(1-d)\\sigma^0_y = 0$，这要求 $\\sigma^0_y = 0$（假设 $d1$）。如果 $\\sigma^0_y \\le 0$，则变为 $\\sigma^0_y = 0$。因此，为使最终侧向应力为零，无损侧向应力也必须为零：$\\sigma^0_y = \\sigma^0_z = 0$。\n\n这确定了该状态对应于无损构型中的单轴应力。根据单轴应力的胡克定律：\n$$ \\sigma^0_x = E \\varepsilon_x $$\n$$ \\varepsilon_y = \\varepsilon_z = -\\nu \\varepsilon_x $$\n应变主值为 $(\\varepsilon_x, -\\nu\\varepsilon_x, -\\nu\\varepsilon_x)$。\n无损应力主值为 $(E\\varepsilon_x, 0, 0)$。\n\n损伤驱动的正应变能密度 $\\psi_{+}$ 为：\n$$ \\psi_{+} = \\dfrac{1}{2} \\sum_{i=1}^{3} \\langle \\sigma^{0}_{i} \\rangle_{+} \\, \\varepsilon_{i} = \\dfrac{1}{2} \\left( \\langle E\\varepsilon_x \\rangle_{+} \\varepsilon_x + \\langle 0 \\rangle_{+} \\varepsilon_y + \\langle 0 \\rangle_{+} \\varepsilon_z \\right) = \\dfrac{1}{2} \\langle E\\varepsilon_x \\rangle_{+} \\varepsilon_x $$\n损伤标量 $d$ 则为 $d = 1 - \\exp(-\\psi_{+}/R)$。\n最终轴向应力 $\\sigma_x$ 为：\n$$ \\sigma_x = (1-d)\\langle E\\varepsilon_x \\rangle_{+} + \\langle E\\varepsilon_x \\rangle_{-} $$\n\n**案例 T1：无侧限压缩 ($\\varepsilon_{x} = -5 \\times 10^{-3}$)**\n- 轴向应变：$\\varepsilon_{x} = -0.005$。\n- 侧向应变：$\\varepsilon_{y} = \\varepsilon_{z} = -0.25 \\times (-0.005) = 0.00125$。\n- 无损轴向应力：$\\sigma^{0}_{x} = (30 \\times 10^{9}) \\times (-0.005) = -150 \\times 10^{6} \\ \\mathrm{Pa}$。这是压缩状态。\n- 正能量密度：由于 $\\sigma^0_x$ 为负，$\\langle \\sigma^0_x \\rangle_{+} = 0$。因此，$\\psi_{+} = 0$。\n- 损伤：$d = 1 - \\exp(0) = 0$。\n- 最终轴向应力：$\\sigma_x = (1-0)\\langle -150 \\times 10^6 \\rangle_{+} + \\langle -150 \\times 10^6 \\rangle_{-} = 0 + (-150 \\times 10^6) = -150 \\times 10^6 \\ \\mathrm{Pa}$。\n- 损伤检查：$|d| = 0 \\le 10^{-12}$ 为真。\n- 结果：$[\\sigma_x, d, \\text{is\\_zero}] = [-150000000.0, 0.0, \\text{True}]$。\n\n**案例 T2：无侧限拉伸 ($\\varepsilon_{x} = +5 \\times 10^{-3}$)**\n- 轴向应变：$\\varepsilon_{x} = 0.005$。\n- 侧向应变：$\\varepsilon_{y} = \\varepsilon_{z} = -0.25 \\times (0.005) = -0.00125$。\n- 无损轴向应力：$\\sigma^{0}_{x} = (30 \\times 10^{9}) \\times (0.005) = 150 \\times 10^{6} \\ \\mathrm{Pa}$。这是拉伸状态。\n- 正能量密度：$\\psi_{+} = \\dfrac{1}{2} (150 \\times 10^{6}) \\times (0.005) = 375000 \\ \\mathrm{J/m^{3}}$。\n- 损伤：$d = 1 - \\exp\\left(-\\dfrac{375000}{200000}\\right) = 1 - \\exp(-1.875) \\approx 0.84664$。\n- 最终轴向应力：$\\sigma_x = (1-d)\\langle 150 \\times 10^6 \\rangle_{+} + \\langle 150 \\times 10^6 \\rangle_{-} = (1-0.84664) \\times (150 \\times 10^6) + 0 \\approx 23004051.5 \\ \\mathrm{Pa}$。\n- 损伤检查：$|d| \\approx 0.84664 > 10^{-12}$ 为假。\n- 结果：$[\\sigma_x, d, \\text{is\\_zero}] \\approx [23004051.5, 0.84664, \\text{False}]$。\n\n**案例 T3：零轴向应变 ($\\varepsilon_{x} = 0$)**\n- 轴向应变：$\\varepsilon_{x} = 0$。\n- 所有应变分量均为零：$\\varepsilon_x = \\varepsilon_y = \\varepsilon_z = 0$。\n- 无损应力张量为零：$\\boldsymbol{\\sigma}^0 = \\boldsymbol{0}$。\n- 正能量密度：$\\psi_{+} = 0$。\n- 损伤：$d = 0$。\n- 最终轴向应力：$\\sigma_x = 0 \\ \\mathrm{Pa}$。\n- 损伤检查：$|d| = 0 \\le 10^{-12}$ 为真。\n- 结果：$[\\sigma_x, d, \\text{is\\_zero}] = [0.0, 0.0, \\text{True}]$。\n\n**静水加载分析（案例 T4）**\n\n在此案例中，应变张量为 $\\boldsymbol{\\varepsilon} = \\varepsilon_{h} \\boldsymbol{I}$，其中 $\\varepsilon_h$ 是静水应变。\n主应变为 $\\varepsilon_1 = \\varepsilon_2 = \\varepsilon_3 = \\varepsilon_h$。\n迹为 $\\mathrm{tr}(\\boldsymbol{\\varepsilon}) = 3\\varepsilon_h$。\n无损应力张量由胡克定律计算得出：\n$$ \\boldsymbol{\\sigma}^{0} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon} = \\lambda (3\\varepsilon_h) \\boldsymbol{I} + 2 \\mu (\\varepsilon_h \\boldsymbol{I}) = (3\\lambda + 2\\mu)\\varepsilon_h \\boldsymbol{I} $$\n应力状态也是静水状态。令 $\\sigma^0_h = (3\\lambda + 2\\mu)\\varepsilon_h$。无损主应力为 $\\sigma^0_1 = \\sigma^0_2 = \\sigma^0_3 = \\sigma^0_h$。\n正能量密度为：\n$$ \\psi_{+} = \\dfrac{1}{2} \\sum_{i=1}^{3} \\langle \\sigma^{0}_{i} \\rangle_{+} \\, \\varepsilon_{i} = \\dfrac{1}{2} \\left( 3 \\times \\langle \\sigma^0_h \\rangle_{+} \\varepsilon_h \\right) $$\n\n**案例 T4：静水压缩 ($\\varepsilon_{h} = -2 \\times 10^{-3}$)**\n- 静水应变：$\\varepsilon_h = -0.002$。\n- 无损静水应力：$\\sigma^{0}_{h} = (3 \\times 12 \\times 10^{9} + 2 \\times 12 \\times 10^{9}) \\times (-0.002) = (60 \\times 10^{9}) \\times (-0.002) = -120 \\times 10^{6} \\ \\mathrm{Pa}$。这是压缩状态。所有主应力均为负。\n- 正能量密度：由于 $\\sigma^0_h$ 为负，$\\langle \\sigma^0_h \\rangle_{+} = 0$。因此，$\\psi_{+} = 0$。\n- 损伤：$d = 1 - \\exp(0) = 0$。\n- 最终应力：$\\boldsymbol{\\sigma} = (1-0)\\boldsymbol{\\sigma}^0_{+} + \\boldsymbol{\\sigma}^0_{-} = \\boldsymbol{0} + \\boldsymbol{\\sigma}^0 = \\boldsymbol{\\sigma}^0$。最终轴向应力为 $\\sigma_x = \\sigma^0_h = -120 \\times 10^6 \\ \\mathrm{Pa}$。\n- 损伤检查：$|d| = 0 \\le 10^{-12}$ 为真。\n- 结果：$[\\sigma_x, d, \\text{is\\_zero}] = [-120000000.0, 0.0, \\text{True}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the damage mechanics problem for the specified test cases.\n    \"\"\"\n    \n    # Material and numerical parameters\n    E = 30e9  # Young's modulus in Pa\n    nu = 0.25  # Poisson's ratio\n    R = 2e5   # Damage energy scale in J/m^3\n    tau = 1e-12 # Zero-damage verification tolerance\n    \n    # Test suite definition\n    # Structure: (case_type, strain_value)\n    test_cases = [\n        ('uniaxial', -5e-3), # Case T1\n        ('uniaxial', 5e-3), # Case T2\n        ('uniaxial', 0.0),    # Case T3\n        ('hydrostatic', -2e-3) # Case T4\n    ]\n\n    # Calculate Lamé parameters\n    lame_mu = E / (2 * (1 + nu))\n    lame_lambda = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n\n    final_results = []\n    \n    for case_type, strain_val in test_cases:\n        d = 0.0\n        sigma_x = 0.0\n        \n        if case_type == 'uniaxial':\n            eps_x = strain_val\n            sigma0_x = E * eps_x\n            psi_plus = 0.5 * max(sigma0_x, 0) * eps_x\n            \n            if psi_plus > 0:\n                d = 1.0 - np.exp(-psi_plus / R)\n            \n            sigma_x = (1.0 - d) * max(sigma0_x, 0) + min(sigma0_x, 0)\n\n        elif case_type == 'hydrostatic':\n            eps_h = strain_val\n            sigma0_h = (3 * lame_lambda + 2 * lame_mu) * eps_h\n            psi_plus = 0.5 * 3 * max(sigma0_h, 0) * eps_h\n\n            if psi_plus > 0:\n                d = 1.0 - np.exp(-psi_plus / R)\n\n            sigma_x = (1.0 - d) * max(sigma0_h, 0) + min(sigma0_h, 0)\n        \n        is_zero = abs(d) = tau\n        final_results.append([float(sigma_x), float(d), bool(is_zero)])\n\n    # Format the output as a single string of a list of lists, without spaces.\n    output_str = str(final_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "局部损伤模型可能会遭受病态的网格依赖性；相场（或梯度损伤）模型通过引入一个特征长度尺度来解决这个问题。本练习在一个简化的1D环境中介绍了基本的Ambrosio-Tortorelli相场模型，让您能从第一性原理推导出控制能量平衡方程。通过计算损伤起始的临界条件，您将深入理解变分原理和能量最小化如何在这类正则化模型中控制断裂的萌生。",
            "id": "3501236",
            "problem": "考虑一根一维（$1$D）细长杆，其长度为 $L$，横截面积为 $A$，由杨氏模量为 $E$ 的线性弹性固体制成。该杆在单轴拉伸下被准静态加载，通过规定端部位移 $u(L)=\\bar{u}$ 和固定 $u(0)=0$ 实现，应变为小应变 $\\varepsilon(x)=u'(x)$。令 $d(x)\\in[0,1]$ 为一个标量损伤（相场）变量，其中 $d=0$ 表示完好状态，$d=1$ 表示完全损伤状态。假设弹性刚度通过一个标量退化函数 $g(d)=(1-d)^{2}+\\kappa$ 进行标准的相场（PF）退化，其中一个小的正数 $\\kappa\\to 0^{+}$ 用于在完全损伤极限下保持椭圆性。未损伤的弹性储能密度为 $\\psi_{0}(\\varepsilon)=\\tfrac{1}{2}E\\,\\varepsilon^{2}$。为正则化裂纹面，使用 Ambrosio–Tortorelli AT$1$ 型裂纹面密度泛函\n$$\n\\gamma(d,d')=\\frac{d}{\\ell}+\\frac{\\ell}{2}\\,(d')^{2},\n$$\n其中内禀长度参数 $\\ell0$，$d'=\\tfrac{dd}{dx}$。材料韧性（临界能量释放率）为 $G_{c}0$。假设为拉伸主导加载（不需要拉压分离）以及等温、无惯性条件。\n\n任务 $1$（能量平衡）：从第一性原理（自由能不平衡/Clausius–Duhem 不等式和虚功率原理）出发，写出一个时间间隔内的准静态能量平衡方程，该方程需清晰地分离出三个贡献：(i) 弹性储能，(ii) 由 $G_{c}$ 加权的裂纹面能，以及 (iii) 不可逆损伤耗散。清晰地指出这三个贡献各自的表达式，用 $u$、$d$、$E$、$G_{c}$、$A$、$L$ 和 $\\ell$ 表示。\n\n任务 $2$（均匀拉伸下的损伤萌生）：将问题特化为损伤萌生时的均匀单轴拉伸状态，此时应变在空间上是均匀的，$d(x)$ 是无穷小且空间均匀的（因此 $d'\\approx 0$）。利用与能量平衡相关的平稳性（最优性）条件和率无关演化的 Kuhn–Tucker 不可逆约束，推导出损伤萌生的临界端部位移 $\\bar{u}_{c}$ 的闭式表达式，用 $L$、$E$、$G_{c}$ 和 $\\ell$ 表示。以仅包含这些参数的符号表达式形式报告你的最终结果 $\\bar{u}_{c}$；在最终的方框答案中不要包含单位。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、是适定的且客观的。\n\n### 步骤 1：提取已知条件\n- **几何与材料：** 一根一维（$1$D）杆，长度为 $L$，均匀横截面积为 $A$，杨氏模量为 $E$。\n- **运动学与加载：** 准静态单轴拉伸，小应变 $\\varepsilon(x) = u'(x)$。边界条件为 $u(0)=0$ 和 $u(L)=\\bar{u}$。\n- **损伤模型：**\n  - 损伤变量：$d(x) \\in [0,1]$，其中 $d=0$ 为完好状态，$d=1$ 为完全损伤状态。\n  - 刚度退化函数：$g(d) = (1-d)^2 + \\kappa$，其中 $\\kappa \\to 0^+$。\n  - 未损伤弹性储能密度：$\\psi_{0}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^2$。\n  - 退化弹性储能密度：$\\psi(\\varepsilon, d) = g(d) \\psi_0(\\varepsilon)$。\n- **断裂模型：**\n  - Ambrosio-Tortorelli (AT$1$) 裂纹面密度泛函：$\\gamma(d, d') = \\frac{d}{\\ell} + \\frac{\\ell}{2} (d')^2$，其中 $d' = \\frac{dd}{dx}$，$\\ell0$ 是一个内禀长度参数。\n  - 材料韧性（临界能量释放率）：$G_c  0$。\n- **假设：** 拉伸主导加载，等温和无惯性条件。\n- **任务 1：** 推导一个时间间隔内的准静态能量平衡，并将其分离为三个贡献：(i) 弹性储能，(ii) 裂纹面能，和 (iii) 不可逆损伤耗散。\n- **任务 2：** 对于损伤萌生时的均匀拉伸情况（$d(x) \\approx 0$，$d'(x) \\approx 0$，均匀应变），推导临界端部位移 $\\bar{u}_c$，用 $L$、$E$、$G_c$ 和 $\\ell$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了一个用于准静态断裂的标准变分相场模型（一个梯度损伤模型）。其公式基于连续介质力学的既定原理，包括自由能泛函和虚功率原理。所有术语和概念，如杨氏模量、能量释放率和刚度退化，都是标准的。问题是适定的、客观的和自洽的，为获得唯一解提供了所有必要信息。在模型的背景下，所作的假设是明确陈述且物理上合理的。未发现任何缺陷。\n\n### 步骤 3：结论与行动\n问题有效。有必要给出完整解答。\n\n### 任务 1：能量平衡\n\n系统的准静态演化由总势能泛函 $\\Pi$ 控制，该泛函包括弹性储能和与裂纹面形成相关的能量。对于整个杆，该泛函为：\n$$\n\\Pi[u, d] = \\int_0^L A \\left( \\psi(\\varepsilon, d) + G_c \\gamma(d, d') \\right) dx\n$$\n其中 $A$ 是横截面积。代入给定的 $\\psi$ 和 $\\gamma$ 的形式：\n$$\n\\Pi[u, d] = \\int_0^L A \\left[ \\left( (1-d)^2 + \\kappa \\right) \\frac{1}{2} E \\varepsilon^2 + G_c \\left( \\frac{d}{\\ell} + \\frac{\\ell}{2} (d')^2 \\right) \\right] dx\n$$\n问题是等温且无惯性的。热力学第一定律，即能量平衡，指出外力所做的功 $W_{ext}$ 等于系统储存能量的变化量加上耗散的能量 $W_{diss}$。在一个时间间隔 $[t_1, t_2]$ 内，这可以写为：\n$$\nW_{ext} = \\Delta E_{stored} + W_{diss}\n$$\n在此相场模型的背景下，总势能泛函的变化量 $\\Delta\\Pi = \\Pi(t_2)-\\Pi(t_1)$ 解释了可恢复弹性储能和不可恢复断裂能的变化。率无关断裂的变分框架被构建为外力所做的功恰好由这个总势能的变化来平衡，包含了所有的能量成本。\n$$\nW_{ext} = \\Delta \\Pi = \\Delta \\Psi_{el} + \\Delta \\Psi_{crack}\n$$\n其中 $\\Psi_{el}$ 是储存在物体中的总弹性储能，$\\Psi_{crack}$ 是总的正则化裂纹面能。\n\n问题要求将能量平衡分离为三个贡献。我们可以通过识别第三个项，“不可逆损伤耗散” $W_{dissipation}$，然后在这个特定的理论框架内展示其值来表达总的平衡。在一个时间间隔 $[t_1, t_2]$ 内的全局能量平衡是：\n$$\n\\int_{t_1}^{t_2} P_{ext}(t) dt = \\Delta \\Psi_{el} + \\Delta \\Psi_{crack} + W_{dissipation}\n$$\n其中 $P_{ext}$ 是外力的功率，$P_{ext} = A \\sigma(L,t) \\dot{\\bar{u}}(t)$。\n\n让我们识别这三个贡献中的每一项：\n\n(i) **弹性储能：** 这是由于弹性变形而储存在材料中的可恢复能量。在时间间隔 $[t_1, t_2]$ 内，弹性储能的变化量是 $\\Delta \\Psi_{el} = \\Psi_{el}(t_2) - \\Psi_{el}(t_1)$，其中在给定时间 $t$ 的总弹性储能为：\n$$\n\\Psi_{el}(t) = \\int_0^L A g(d(x,t)) \\psi_0(\\varepsilon(x,t)) dx = \\int_0^L A \\left( (1-d(x,t))^2 + \\kappa \\right) \\frac{1}{2} E (\\varepsilon(x,t))^2 dx\n$$\n\n(ii) **裂纹面能：** 这是根据相场模型定义，创建新的（正则化的）裂纹面所需的能量。在此时间间隔内，该能量的变化量是 $\\Delta \\Psi_{crack} = \\Psi_{crack}(t_2) - \\Psi_{crack}(t_1)$，其中在时间 $t$ 的总裂纹面能为：\n$$\n\\Psi_{crack}(t) = \\int_0^L A G_c \\gamma(d(x,t), d'(x,t)) dx = \\int_0^L A G_c \\left( \\frac{d(x,t)}{\\ell} + \\frac{\\ell}{2} (d'(x,t))^2 \\right) dx\n$$\n根据其物理性质，这一项是耗散能的一种形式，因为它是不可恢复的。\n\n(iii) **不可逆损伤耗散：** 这一项代表了裂纹面能泛函尚未计入的任何耗散。在一般的热力学框架中，这是损伤驱动热力学力与损伤演化率的乘积。该耗散的速率为 $\\mathcal{D} = \\int_0^L A \\mathcal{F}_d \\dot{d} dx$。损伤的热力学驱动力 $\\mathcal{F}_d$ 从总势能 $\\Pi$ 中导出。损伤的演化由率无关、不可逆过程的 Karush-Kuhn-Tucker (KKT) 条件控制：\n$$\n\\mathcal{F}_d \\le 0, \\quad \\dot{d} \\ge 0, \\quad \\mathcal{F}_d \\dot{d} = 0\n$$\n驱动力是 $\\Pi$ 相对于 $d$ 的变分导数的负值：$\\mathcal{F}_d = -\\frac{1}{A} \\frac{\\delta \\Pi}{\\delta d}$。\n$$\n\\frac{\\delta \\Pi}{\\delta d} = A \\left[ \\frac{\\partial \\psi}{\\partial d} + G_c \\frac{\\partial \\gamma}{\\partial d} - G_c \\frac{d}{dx}\\left(\\frac{\\partial \\gamma}{\\partial d'}\\right) \\right] = A \\left[ g'(d)\\psi_0 + G_c \\left( \\frac{1}{\\ell} - \\ell d'' \\right) \\right]\n$$\n使用 $g'(d) = -2(1-d)$ 并定义弹性储能释放率 $Y = -g'(d)\\psi_0 = 2(1-d)\\psi_0$：\n$$\n\\frac{\\delta \\Pi}{\\delta d} = A \\left[ -Y + G_c \\left( \\frac{1}{\\ell} - \\ell d'' \\right) \\right]\n$$\n因此，驱动力为 $\\mathcal{F}_d = Y - G_c \\left( \\frac{1}{\\ell} - \\ell d'' \\right)$。KKT 条件 $\\mathcal{F}_d \\dot{d} = 0$ 意味着这种特定形式的耗散速率在任何时候和杆中的任何点都为零：$\\mathcal{D}(t) = 0$。因此，在任何时间间隔内，来自此源的总耗散也为零。\n$$\nW_{dissipation} = \\int_{t_1}^{t_2} \\mathcal{D}(t) dt = 0\n$$\n这是断裂变分模型的一个基本特征，其中所有耗散都包含在断裂能项中。因此，能量平衡简化为 $W_{ext} = \\Delta \\Psi_{el} + \\Delta \\Psi_{crack}$。\n\n### 任务 2：均匀拉伸下的损伤萌生\n\n对于此任务，我们特化为均匀单轴拉伸状态。\n- 应变是均匀的：$\\varepsilon(x) = \\varepsilon_0$。位移场为 $u(x) = \\varepsilon_0 x$。给定 $u(L) = \\bar{u}$，我们有 $\\varepsilon_0 = \\bar{u}/L$。\n- 在损伤萌生时，材料仍处于其完好状态，因此 $d(x) = 0$。\n- 我们考虑均匀损伤的萌生，这意味着出现的任何无穷小损伤 $d$ 也是空间均匀的，因此 $d(x) = d_0 \\approx 0$ 且 $d'(x) = 0, d''(x) = 0$。\n\n当完好状态 $d=0$ 变得不稳定时，损伤将开始萌生。这发生在总势能 $\\Pi$ 可以通过损伤的无穷小增加而减小时。在数学上，这对应于势能相对于均匀损伤变量 $d_0$ 的导数变为负值的点。损伤萌生的阈值是该导数首次达到零的时刻。\n\n对于一个均匀状态 $(u(x)=\\varepsilon_0 x, d(x)=d_0)$，总势能泛函简化为关于 $\\varepsilon_0$ 和 $d_0$ 的代数函数：\n$$\n\\Pi(\\varepsilon_0, d_0) = \\int_0^L A \\left[ ((1-d_0)^2+\\kappa) \\frac{1}{2} E \\varepsilon_0^2 + G_c \\frac{d_0}{\\ell} \\right] dx\n$$\n$$\n\\Pi(\\varepsilon_0, d_0) = A L \\left[ ((1-d_0)^2+\\kappa) \\frac{1}{2} E \\varepsilon_0^2 + G_c \\frac{d_0}{\\ell} \\right]\n$$\n为了找到损伤萌生的条件，我们计算 $\\Pi$ 关于 $d_0$ 的偏导数，并在完好状态 $d_0=0$ 处对其求值。\n$$\n\\frac{\\partial \\Pi}{\\partial d_0} = A L \\left[ 2(1-d_0)(-1) \\frac{1}{2} E \\varepsilon_0^2 + \\frac{G_c}{\\ell} \\right] = A L \\left[ -(1-d_0) E \\varepsilon_0^2 + \\frac{G_c}{\\ell} \\right]\n$$\n从全局势能导出的损伤演化 KKT 条件是 $\\frac{\\partial \\Pi}{\\partial d_0} \\le 0$（因为 $\\dot{d}_0 \\ge 0$）。损伤萌生发生在阈值应变 $\\varepsilon_c$ 处，此时该不等式首次满足，即取等号时：\n$$\n\\frac{\\partial \\Pi}{\\partial d_0} \\bigg|_{d_0=0, \\varepsilon_0=\\varepsilon_c} = 0\n$$\n将 $d_0=0$ 和 $\\varepsilon_0=\\varepsilon_c$ 代入导数中：\n$$\nA L \\left[ -(1-0) E \\varepsilon_c^2 + \\frac{G_c}{\\ell} \\right] = 0\n$$\n$$\n-E \\varepsilon_c^2 + \\frac{G_c}{\\ell} = 0\n$$\n这给出了均匀损伤萌生的临界应变：\n$$\nE \\varepsilon_c^2 = \\frac{G_c}{\\ell} \\implies \\varepsilon_c = \\sqrt{\\frac{G_c}{E \\ell}}\n$$\n（由于杆处于拉伸状态，我们取正根）。\n与此临界应变相对应的临界端部位移 $\\bar{u}_c$ 可通过运动学关系 $\\varepsilon_c = \\bar{u}_c/L$ 求得。\n$$\n\\bar{u}_c = L \\varepsilon_c = L \\sqrt{\\frac{G_c}{E \\ell}}\n$$\n这是根据给定参数得出的损伤萌生临界位移的闭式表达式。残余刚度 $\\kappa$ 不影响损伤的萌生，只影响损伤后的行为。",
            "answer": "$$\n\\boxed{L \\sqrt{\\frac{G_c}{E \\ell}}}\n$$"
        },
        {
            "introduction": "材料损伤的一个关键特征是其不可逆性——损伤会累积，并且在卸载时不会愈合，这是一个简单模型在循环载荷下难以捕捉的现象。本练习介绍了功能强大的历史场方法，这是变分损伤模型中用以强制实现不可逆性的标准技术。通过为一个承受循环载荷的杆件实现该方法，您将看到模型如何正确预测损伤的累积和饱和，为疲劳和耐久性分析提供了一个鲁棒的工具。",
            "id": "3501246",
            "problem": "考虑一个承受循环轴向载荷的一维棱柱杆，该杆被建模为空间均匀状态，并使用一个标量损伤变量 $d \\in [0,1]$，该变量仅退化储存彈性能的拉伸部分。设杆的杨氏模量为 $E$（单位为 $\\mathrm{Pa}$），损伤演化由 Ambrosio-Tortorelli 类型的断裂相场控制，其断裂韧性为 $G_c$（单位为 $\\mathrm{N/m}$），内禀长度尺度参数为 $l$（单位为 $\\mathrm{m}$）。单位体积的总自由能密度由退化的拉伸弹性部分、未退化的压缩弹性部分以及裂纹表面密度贡献组成。具体而言，应变能密度的分解定义为\n$$\n\\psi(\\varepsilon,d) = (1-d)^2\\,\\psi^+(\\varepsilon) + \\psi^-(\\varepsilon),\n$$\n其中轴向应变 $\\varepsilon$ 是无量纲的，拉伸能密度为 $\\psi^+(\\varepsilon) = \\tfrac{1}{2} E\\,\\langle \\varepsilon \\rangle_+^2$，压缩能密度为 $\\psi^-(\\varepsilon) = \\tfrac{1}{2} E\\,\\langle \\varepsilon \\rangle_-^2$，其中采用了标准的正负分解 $\\langle \\varepsilon \\rangle_+ = \\max(\\varepsilon,0)$ 和 $\\langle \\varepsilon \\rangle_- = \\min(\\varepsilon,0)$。断裂正则化能量密度由下式给出\n$$\n\\gamma(d,\\nabla d) = G_c \\left( \\frac{d^2}{2l} + \\frac{l}{2} |\\nabla d|^2 \\right).\n$$\n假设解在空间上是均匀的，因此 $|\\nabla d| = 0$。损伤的不可逆性通过历史场方法强制执行：引入历史场 $H(t)$ 作为拉伸能密度的运行时最大值，\n$$\nH(t) = \\max_{s \\in [0,t]} \\psi^+(\\varepsilon(s)),\n$$\n该历史场满足 Kuhn-Tucker 类型的不可逆约束 $H(t) \\ge \\psi^+(\\varepsilon(t))$，$\\dot{H}(t) \\ge 0$ 和 $\\left(H(t) - \\psi^+(\\varepsilon(t))\\right)\\dot{H}(t) = 0$。仅从上述能量定义和最小势能原理出发，推导在均匀情况下基于历史场方法的 $d$ 的局部平稳性条件，并用它来计算给定应变历史下 $d(t)$ 的时间演化。\n\n您的程序必须实现以下任务：\n- 根据规定的序列构建循环应变历史 $\\varepsilon(t)$，计算 $\\psi^+(\\varepsilon(t))$，更新历史场 $H(t)$，并根据推导出的均匀平稳性条件在每个时间步计算 $d(t)$。通过验证在应变减小或为压缩状态时 $d(t)$ 不会减小，以算法方式证明损伤在卸载过程中不会愈合。\n- 对于每个测试用例，报告两个输出：最终损伤水平 $d_\\mathrm{final}$（无量纲，四舍五入至六位小数）和一个布尔值，该布尔值当且仅当在整个历史中损伤在卸载下不愈合时为真，这是通过检查在 $\\varepsilon(t)$ 减小的任何时间区间内 $d(t)$ 均未减小来确定的。该布尔值必须使用物理上合理的数值容差进行计算。\n\n物理单位：$E$ 的单位为 $\\mathrm{Pa}$，$G_c$ 的单位为 $\\mathrm{N/m}$，$l$ 的单位为 $\\mathrm{m}$，应变为无量纲。计算出的 $d$ 是无量纲的。\n\n测试套件规范：\n1. 增幅循环重载的正常路径：\n   - $E = 70 \\times 10^9\\,\\mathrm{Pa}$，$G_c = 1000\\,\\mathrm{N/m}$，$l = 0.01\\,\\mathrm{m}$。\n   - 三角应变循环，幅值为 $[0.004, 0.006]$，每个循环由线性段 $0 \\to A \\to -A \\to 0$ 组成，每段有 $50$ 个点。\n2. 低幅重复循环：\n   - $E = 70 \\times 10^9\\,\\mathrm{Pa}$，$G_c = 1000\\,\\mathrm{N/m}$，$l = 0.01\\,\\mathrm{m}$。\n   - 三角应变循环，幅值为 $[0.0005, 0.0005, 0.0005, 0.0005, 0.0005]$，分段定义相同，每段 $50$ 个点。\n3. 纯压缩历史（边界情况）：\n   - $E = 70 \\times 10^9\\,\\mathrm{Pa}$，$G_c = 1000\\,\\mathrm{N/m}$，$l = 0.01\\,\\mathrm{m}$。\n   - 恒定压缩应变历史 $\\varepsilon(t) = -0.004$，共 $150$ 个点。\n4. 增加断裂韧性：\n   - $E = 70 \\times 10^9\\,\\mathrm{Pa}$，$G_c = 5000\\,\\mathrm{N/m}$，$l = 0.01\\,\\mathrm{m}$。\n   - 三角应变循环，幅值为 $[0.006, 0.006]$，每段 $50$ 个点。\n5. 减小内禀长度尺度：\n   - $E = 70 \\times 10^9\\,\\mathrm{Pa}$，$G_c = 1000\\,\\mathrm{N/m}$，$l = 0.001\\,\\mathrm{m}$。\n   - 三角应变循环，幅值为 $[0.006]$，每段 $50$ 个点。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个逗号分隔的列表，列表用方括号括起来。每个测试用例的结果必须格式化为列表 $[d_\\mathrm{final},\\text{boolean}]$，不含空格，例如 $\\big[[0.123456,\\text{True}],[0.000000,\\text{True}],\\dots\\big]$。",
            "solution": "该问题要求基于相场断裂模型，推导循环载荷下一维杆的损伤演化规律，并随后进行数值实现以分析特定的载荷历史。\n\n### 1. 控制原理与模型构建\n对于空间均匀的材料状态，单位体积的总自由能密度 $\\Pi$ 是机械应变能密度 $\\psi(\\varepsilon,d)$ 与断裂正则化能量密度 $\\gamma(d, \\nabla d)$ 的和。\n\n已知条件如下：\n- 具有拉伸/压缩分解的机械应变能密度：\n$$\n\\psi(\\varepsilon,d) = (1-d)^2\\,\\psi^+(\\varepsilon) + \\psi^-(\\varepsilon)\n$$\n其中 $\\psi^+(\\varepsilon) = \\tfrac{1}{2} E\\,\\langle \\varepsilon \\rangle_+^2$ 是拉伸部分，$\\psi^-(\\varepsilon) = \\tfrac{1}{2} E\\,\\langle \\varepsilon \\rangle_-^2$ 是压缩部分。损伤变量 $d \\in [0,1]$ 仅降低拉伸刚度。\n- 断裂正则化能量密度：\n$$\n\\gamma(d,\\nabla d) = G_c \\left( \\frac{d^2}{2l} + \\frac{l}{2} |\\nabla d|^2 \\right)\n$$\n其中 $G_c$ 是断裂韧性，$l$ 是内禀长度尺度。\n- 我们假设状态在空间上是均匀的，这意味着损伤梯度为零：$|\\nabla d| = 0$。\n\n综合这些，均匀状态下的总能量密度为：\n$$\n\\Pi(\\varepsilon, d) = (1-d)^2\\,\\psi^+(\\varepsilon) + \\psi^-(\\varepsilon) + G_c \\frac{d^2}{2l}\n$$\n\n### 2. 损伤演化规律的推导\n损伤力学的一个关键方面是不可逆性：损伤不能愈合。这通过使用一个历史场 $H(t)$ 来强制执行，该历史场跟踪材料直到时间 $t$ 所经历的最大拉伸能密度：\n$$\nH(t) = \\max_{s \\in [0,t]} \\psi^+(\\varepsilon(s))\n$$\n根据定义，该历史场是时间的非递减函数，即 $\\dot{H}(t) \\ge 0$。在耗散过程的变分框架中，内部变量 $d$ 的演化由一个有效势能的平稳性控制，其中损伤的驱动力 $\\psi^+(\\varepsilon)$ 被其历史最大值 $H$ 替代。这确保了损伤只能增长或保持不变，绝不会减小。\n\n因此，控制当前损伤状态的有效势能为：\n$$\n\\Pi_\\mathrm{eff}(d, H) = (1-d)^2 H + \\psi^-(\\varepsilon) + G_c \\frac{d^2}{2l}\n$$\n损伤状态 $d$ 的演化会使该势能最小化。我们通过对 $d$ 求偏导数并将其设为零来找到平稳点。项 $\\psi^-(\\varepsilon)$ 与 $d$ 无关，不影响最小化过程。\n$$\n\\frac{\\partial \\Pi_\\mathrm{eff}}{\\partial d} = \\frac{\\partial}{\\partial d} \\left( (1-d)^2 H + G_c \\frac{d^2}{2l} \\right) = 0\n$$\n$$\n2(1-d)(-1)H + G_c \\frac{2d}{2l} = 0\n$$\n$$\n-2H(1-d) + \\frac{G_c}{l}d = 0\n$$\n求解这个关于 $d$ 的代数方程：\n$$\n\\frac{G_c}{l}d = 2H(1-d)\n$$\n$$\nG_c d = 2lH - 2lHd\n$$\n$$\nd(G_c + 2lH) = 2lH\n$$\n这得出了损伤变量作为历史场 $H$ 函数的显式表达式：\n$$\nd(t) = \\frac{2lH(t)}{G_c + 2lH(t)}\n$$\n该方程构成了局部损伤演化规律。由于 $l, G_c  0$ 且 $H(t) \\ge 0$，可以保证 $d(t) \\in [0, 1)$。此外，由于 $H(t)$ 是时间的非递减函数，$d(t)$ 也是非递减的，从而满足了损伤的不可逆性。\n\n### 3. 算法实现\n对于给定的应变历史 $\\varepsilon(t)$，损伤的时间演化 $d(t)$ 可以通过离散时间步进算法计算。对于初始状态下的 pristine 材料，在时间 $t_0=0$ 初始化 $H(t_0)=0$ 和 $d(t_0)=0$。对于每个后续的时间步 $t_i$：\n\n1.  **更新应变：** 从给定的历史中获取应变 $\\varepsilon_i = \\varepsilon(t_i)$。\n2.  **计算拉伸能：** 计算当前的拉伸彈性能密度：$\\psi^+_i = \\frac{1}{2} E \\max(\\varepsilon_i, 0)^2$。\n3.  **更新历史场：** 根据其定义更新历史场：$H_i = \\max(H_{i-1}, \\psi^+_i)$，其中 $H_{i-1}$ 是前一个时间步的值。\n4.  **计算损伤：** 使用推导出的规律计算当前损伤值：$d_i = \\frac{2lH_i}{G_c + 2lH_i}$。\n\n对整个应变历史中的所有时间步重复此过程。\n\n### 4. 应变历史生成\n问题定义了幅值为 $A$ 的三角应变循环，路径为 $0 \\to A \\to -A \\to 0$，其中三个分段（$0 \\to A$，$A \\to -A$，$-A \\to 0$）中的每一段都离散为指定数量的点，$N_p=50$。这被解释为每个循环总共有 $3 \\times N_p = 150$ 个点。我们使用线性间距为每个分段生成点，并将它们连接起来形成完整的历史。对于具有多个循环的测试用例，将生成的循环数组连接起来。\n\n### 5. 不愈合验证\n问题要求进行算法检查以验证损伤不会愈合。推导出的模型内在就强制执行了这一点，因为 $d(t)$ 是非递减历史场 $H(t)$ 的单调递增函数。数值验证算法遍历计算出的历史，并检查在任何时间步 $t_i$，条件 $\\varepsilon_i  \\varepsilon_{i-1}$（卸载）是否伴随着 $d_i  d_{i-1}$（愈合）。由于浮点运算，此检查必须使用一个小的数值容差 $\\tau$。检查的表述为：如果 $\\varepsilon_i  \\varepsilon_{i-1}$ 且 $d_i  d_{i-1} - \\tau$，则发生了愈合。如果在整个历史中未检测到此类愈合，则布尔标志设置为 `True`。对于涉及损伤 $d \\in [0,1]$ 的计算，容差 $\\tau=10^{-9}$ 在物理上是合理的。",
            "answer": "```python\nimport numpy as np\n\ndef generate_strain_history(amplitudes, n_points_per_segment):\n    \"\"\"\n    Generates a cyclic strain history based on given amplitudes.\n    Each cycle follows 0 -> A -> -A -> 0, with n_points_per_segment on each\n    of the three linear segments, for a total of 3 * n_points_per_segment points.\n    \"\"\"\n    histories = []\n    for A in amplitudes:\n        s1 = np.linspace(0, A, n_points_per_segment)\n        s2 = np.linspace(A, -A, n_points_per_segment)\n        s3 = np.linspace(-A, 0, n_points_per_segment)\n        cycle = np.concatenate((s1, s2, s3))\n        histories.append(cycle)\n    \n    if not histories:\n        return np.array([])\n        \n    strain_history = np.concatenate(histories)\n    return strain_history\n\ndef compute_damage_evolution(params, strain_history):\n    \"\"\"\n    Computes the time evolution of damage based on the derived model.\n    \"\"\"\n    E, Gc, l = params['E'], params['Gc'], params['l']\n    \n    num_steps = len(strain_history)\n    d_history = np.zeros(num_steps)\n    H_history = np.zeros(num_steps)\n    \n    H_current = 0.0\n    \n    for i in range(num_steps):\n        epsilon = strain_history[i]\n        \n        # Calculate tensile elastic energy density\n        psi_plus = 0.5 * E * (max(epsilon, 0.0))**2\n        \n        # Update history field\n        H_current = max(H_current, psi_plus)\n        H_history[i] = H_current\n        \n        # Compute damage\n        denominator = Gc + 2.0 * l * H_current\n        if denominator > 1e-12: # Avoid division by zero, though physically impossible\n            d_history[i] = (2.0 * l * H_current) / denominator\n        else:\n            d_history[i] = 0.0\n            \n    return d_history\n\ndef check_no_healing(strain_history, d_history):\n    \"\"\"\n    Checks if damage decreases during any unloading phase.\n    A small numerical tolerance is used to account for floating point errors.\n    \"\"\"\n    tolerance = 1e-9  # Physically reasonable tolerance for damage in [0,1]\n    is_non_healing = True\n    for i in range(1, len(strain_history)):\n        # Check for unloading condition\n        if strain_history[i]  strain_history[i-1]:\n            # Check if damage has decreased (healed)\n            if d_history[i]  d_history[i-1] - tolerance:\n                is_non_healing = False\n                break\n    return is_non_healing\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # 1. Happy path cyclic reloading with increasing amplitude\n        {'E': 70e9, 'Gc': 1000, 'l': 0.01, 'amplitudes': [0.004, 0.006], 'n_points_per_segment': 50, 'special_case': None},\n        # 2. Low-amplitude repeated cycles\n        {'E': 70e9, 'Gc': 1000, 'l': 0.01, 'amplitudes': [0.0005]*5, 'n_points_per_segment': 50, 'special_case': None},\n        # 3. Pure compression history (edge case)\n        {'E': 70e9, 'Gc': 1000, 'l': 0.01, 'amplitudes': [], 'n_points_per_segment': 0, 'special_case': 'compression'},\n        # 4. Increased fracture toughness\n        {'E': 70e9, 'Gc': 5000, 'l': 0.01, 'amplitudes': [0.006, 0.006], 'n_points_per_segment': 50, 'special_case': None},\n        # 5. Reduced internal length scale\n        {'E': 70e9, 'Gc': 1000, 'l': 0.001, 'amplitudes': [0.006], 'n_points_per_segment': 50, 'special_case': None},\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        if case['special_case'] == 'compression':\n            strain_history = np.full(150, -0.004)\n        else:\n            strain_history = generate_strain_history(case['amplitudes'], case['n_points_per_segment'])\n        \n        # If strain history is empty (e.g. no cycles), avoid error\n        if len(strain_history) == 0:\n            d_final = 0.0\n            is_non_healing = True\n        else:\n            d_history = compute_damage_evolution(case, strain_history)\n            d_final = d_history[-1]\n            is_non_healing = check_no_healing(strain_history, d_history)\n        \n        # Format result string without spaces as per specification\n        result_str = f\"[{d_final:.6f},{is_non_healing}]\"\n        results.append(result_str)\n        \n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}