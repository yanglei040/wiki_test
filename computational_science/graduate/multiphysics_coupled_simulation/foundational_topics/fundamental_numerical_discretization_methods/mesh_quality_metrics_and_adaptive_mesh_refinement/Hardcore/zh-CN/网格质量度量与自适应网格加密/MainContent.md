## 引言
在复杂的科学与工程计算中，精确且高效的数值模拟是推动创新与发现的关键。[有限元分析](@entry_id:138109)作为其中最强大的工具之一，其成功与否在很大程度上依赖于一个看似基础却至关重要的环节：计算网格的质量与分辨率。传统的均匀[网格划分](@entry_id:269463)方法虽然简单，但在面对具有复杂局部特征（如[边界层](@entry_id:139416)、[奇异点](@entry_id:199525)或冲击波）的多物理场问题时，往往会导致计算资源的巨大浪费或关键物理现象的捕捉失败。如何智能地评估网格并动态地优化其[分布](@entry_id:182848)，将计算力精确地“投放”到最需要的区域，是提升现代[数值模拟](@entry_id:137087)能力的核心挑战。本文旨在系统性地解决这一挑战，为读者提供关于[网格质量度量](@entry_id:273880)与自适应网格加密（AMR）的全面知识框架。我们将首先在 **“原理与机制”** 中建立评估[网格质量](@entry_id:151343)的数学框架，并深入剖析驱动自[适应过程](@entry_id:187710)的核心理论。接着，在 **“应用与交叉学科联系”** 中展示这些理论如何在[流体力学](@entry_id:136788)、[固体力学](@entry_id:164042)等前沿领域中解决实际问题。最后，通过 **“动手实践”** 环节，您将有机会将理论知识应用于具体的计算问题。通过这三部分的学习，您将掌握在[多物理场耦合](@entry_id:171389)仿真中实现高精度与高效率的关键策略。

## 原理与机制

本章旨在深入探讨控制[网格质量](@entry_id:151343)与[自适应加密](@entry_id:746260)背后的一系列核心原理与机制。我们首先建立一套量化评估网格单元有效性与形状质量的数学框架，并阐明不良网格对[数值模拟](@entry_id:137087)稳定性的影响。随后，我们将介绍[自适应网格加密](@entry_id:143852)（[AMR](@entry_id:204220)）的理论依据，即[后验误差估计](@entry_id:167288)，并详细阐述几种主要的自适应策略。最后，本章将讨论面向[多物理场耦合](@entry_id:171389)仿真的高级主题，包括[目标导向自适应](@entry_id:749945)、[各向异性网格生成](@entry_id:746452)以及多物理域间的自适应资源分配。

### [网格质量](@entry_id:151343)的量化

在有限元方法中，计算域被离散为一系列称作“单元”的简单几何形状。计算通常在规则的“[参考单元](@entry_id:168425)”上进行，再通过数学变换映射到物理空间中的实际单元。这一变换的性质，直接决定了离散单元的“质量”，并深刻影响着数值解的精度和计算过程的稳定性。

#### [等参变换](@entry_id:750863)与[雅可比矩阵](@entry_id:264467)

等参有限元方法利用相同的形函数（Shape Functions）来描述单元的几何形状和单元上的物理场。具体而言，物理单元 $\Omega_e$ 内任意一点的坐标 $\boldsymbol{x}$，可以通过[参考单元](@entry_id:168425) $\hat{\Omega}$ 内的坐标 $\boldsymbol{\xi}$ 和单元的节点坐标 $\{\boldsymbol{x}_a\}$ 来表示：

$$
\boldsymbol{x}(\boldsymbol{\xi}) = \sum_{a=1}^{n_n} N_a(\boldsymbol{\xi}) \boldsymbol{x}_a
$$

其中，$n_n$ 是单元的节点数，$N_a(\boldsymbol{\xi})$ 是定义在[参考单元](@entry_id:168425)上的形函数。

这个从参考坐标 $\boldsymbol{\xi}$到物理坐标 $\boldsymbol{x}$ 的映射 $F_e: \hat{\Omega} \to \Omega_e$ 的[局部线性化](@entry_id:169489)由**[雅可比矩阵](@entry_id:264467)**（Jacobian Matrix）$J$ 描述：

$$
J(\boldsymbol{\xi}) = \frac{\partial \boldsymbol{x}}{\partial \boldsymbol{\xi}} = \sum_{a=1}^{n_n} \boldsymbol{x}_a \otimes \nabla_{\boldsymbol{\xi}} N_a(\boldsymbol{\xi})
$$

[雅可比矩阵](@entry_id:264467)是有限[元理论](@entry_id:638043)的基石。它不仅关联了物理空间和参考空间中的[梯度算子](@entry_id:275922)，其[行列式](@entry_id:142978) $\det J$ 还给出了两个空间中[微分](@entry_id:158718)体积（或面积）元之间的关系：$d\Omega_e = \det J(\boldsymbol{\xi}) d\hat{\Omega}$。这是在单元上进行数值积分时必须使用的变换因子。

#### 有效性：单元反转与雅可比行列式

一个有效的[有限元网格](@entry_id:174862)要求每个单元的映射都是[一一对应](@entry_id:143935)的，即非奇异的。如果在一个单元的任何位置，映射发生“折叠”或“缠绕”，就会导致物理空间中的不同点被映射到参考空间中的同一点，这是不符合物理直观的。这种现象被称为**单元反转**（Element Inversion）。

在数学上，保持映射方向性的条件是[雅可比行列式](@entry_id:137120)在整个单元上严格为正，即 $\det J(\boldsymbol{\xi}) > 0$ 对所有 $\boldsymbol{\xi} \in \hat{\Omega}$ 成立。一旦某处出现 $\det J(\boldsymbol{\xi}) \le 0$，就意味着单元在该点发生了反转或退化。因此，$\det J > 0$ 是衡量网格有效性的首要和最基本的判据。任何导致 $\det J \le 0$ 的网格单元在计算开始前都必须被修正。

值得注意的是，对于[高阶单元](@entry_id:750328)（即形函数为二次或更高次多项式的单元），即使所有节点处的 $\det J$ 均为正，也不能保证单元内部不发生反转。因为 $\det J$ 本身是一个高次多项式，其最小值可能出现在单元内部的非节点位置。因此，对[高阶单元](@entry_id:750328)的有效性检查需要更复杂的算法。

#### 质量：形状畸变及其度量

一个有效的单元（$\det J > 0$）仍然可能因为形状不佳而成为“坏”单元。例如，一个极度扁平的三角形，其内角接近 $180^\circ$，虽然并未反转，但其几何形状的严重畸变会引发数值问题。

这类形状畸变可以通过雅可比矩阵的谱特性来量化。一个矩阵的**[条件数](@entry_id:145150)**（Condition Number），即其最大[奇异值](@entry_id:152907)与最小奇异值之比 $\kappa(J) = \sigma_{\max}(J) / \sigma_{\min}(J)$，是衡量其接近奇异程度的指标。对于一个形状理想的单元（如等边三角形），[雅可比矩阵](@entry_id:264467)是良态的（well-conditioned），其条件数接近于1。而对于一个形状严重畸变的单元，例如一个内角接近 $180^\circ$ 的三角形，其雅可比矩阵的列向量会变得几近共线。这导致其最小奇异值 $\sigma_{\min}(J)$ 趋近于零，从而条件数 $\kappa(J)$ 趋于无穷大。即使此时其[行列式](@entry_id:142978) $\det J = \sigma_{\max}(J) \sigma_{\min}(J)$ 仍然为正，但可能已非常接近零。

为了将单元的形状质量与尺寸效应分离开来，通常会采用[标准化](@entry_id:637219)的度量指标。一个常用的指标是**缩放[雅可比](@entry_id:264467)**（Scaled Jacobian），其定义为：

$$
\sigma(\boldsymbol{\xi}) = \frac{\det J(\boldsymbol{\xi})}{\prod_{i=1}^{d} \|\boldsymbol{g}_i(\boldsymbol{\xi})\|}
$$

其中 $\boldsymbol{g}_i$ 是[雅可比矩阵](@entry_id:264467) $J$ 的列向量。根据阿达马不等式（Hadamar[d'](@entry_id:189153)s inequality），该指标的取值范围为 $[-1, 1]$。当 $\sigma = \pm 1$ 时，意味着雅可比矩阵的列向量相互正交，对应局部完美的正交映射。当 $\sigma$ 趋近于0时，即使 $\det J$ 可能因为单元尺寸大而取值不小，这也表明单元存在严重的角度扭曲或被压扁。因此，$\det J$ 主要用于检测单元反转，而缩放[雅可比](@entry_id:264467)则主要用于评估单元的形状质量。

#### 质量不佳的后果：[数值病态](@entry_id:169044)

我们之所以关注单元的形状质量，是因为它直接关系到最终形成的全局[代数方程](@entry_id:272665)组的健康状况。以典型的[扩散](@entry_id:141445)问题为例，其[单元刚度矩阵](@entry_id:139369) $K_e$ 的计算涉及如下[形式的积分](@entry_id:158607)：

$$
(K_e)_{ij} \propto \int_{\hat{\Omega}} (\nabla_{\hat{\boldsymbol{\xi}}} \hat{\phi}_i)^T \left( \det(J_e) J_e^{-1} J_e^{-T} \right) (\nabla_{\hat{\boldsymbol{\xi}}} \hat{\phi}_j) d\hat{\boldsymbol{\xi}}
$$

核心在于矩阵项 $C_e = \det(J_e) J_e^{-1} J_e^{-T}$。可以证明，该[矩阵的条件数](@entry_id:150947) $\kappa(C_e)$ 与雅可比矩阵条件数的平方成正比，即 $\kappa(C_e) = \kappa(J_e)^2$。这意味着雅可比矩阵的病态性会被平方放大后传递给[单元刚度矩阵](@entry_id:139369)。

当网格中包含一个形状严重畸变的单元时，其对应的[单元刚度矩阵](@entry_id:139369)将具有非常大的[条件数](@entry_id:145150)（即其最大和最小特征值之比极大）。根据瑞利商理论，这个具有极大[特征值](@entry_id:154894)的局部刚度矩阵在组装到[全局刚度矩阵](@entry_id:138630) $K$ 后，会显著增大 $K$ 的最大[特征值](@entry_id:154894)，从而导致[全局刚度矩阵](@entry_id:138630)的[条件数](@entry_id:145150) $\kappa(K)$ 急剧恶化。一个病态的全局系统对[迭代求解器](@entry_id:136910)的收敛性是致命的，并且会放大计算过程中的舍入误差，最终损害解的可靠性。因此，维持良好的[网格质量](@entry_id:151343)是确保数值仿真稳健性的前提。

### 自适应网格加密的原理

在实际问题中，解的行为通常在空间上极不均匀。例如，在[边界层](@entry_id:139416)附近，解的梯度可能非常剧烈；在裂纹尖端，解可能存在奇异性；而在远离这些特征的区域，解可能非常光滑。在这种情况下，采用全局一致的均匀细化网格是一种巨大的浪费。**[自适应网格加密](@entry_id:143852)**（Adaptive Mesh Refinement, [AMR](@entry_id:204220)）的核心思想是：根据计算得到的数值解来估计误差的[分布](@entry_id:182848)，并将计算资源（即更精细的网格）集中投放到误差较大的区域。

#### [后验误差估计](@entry_id:167288)：自适应的向导

驱动自[适应过程](@entry_id:187710)的关键是**[后验误差估计](@entry_id:167288)**（A Posteriori Error Estimation）。它利用已求得的有限元解 $u_h$ 来估算真实解 $u$ 与 $u_h$ 之间的误差。这种估计为网格加密提供了“地图”，指明了哪些区域需要被细化。

#### 示例：基于残差的[误差估计子](@entry_id:749080)

最经典的一类[后验误差估计](@entry_id:167288)子是基于残差的。让我们以带有诺伊曼（Neumann）边界条件的泊松（Poisson）问题为例来具体说明其构造过程。问题描述如下：

$$
-\Delta u = f \quad \text{in } \Omega, \qquad \nabla u \cdot \boldsymbol{n} = g \quad \text{on } \partial \Omega
$$

其[有限元近似](@entry_id:166278)解 $u_h$ 满足伽辽金（Galerkin）正交性。通过一系列数学推导，可以得到误差 $e = u - u_h$ 的[能量范数](@entry_id:274966)由一系列局部残差项控制。一个可靠的[误差估计子](@entry_id:749080) $\eta$ 通常由每个单元 $K$ 上的局部[误差指标](@entry_id:173250) $\eta_K$ 组合而成，其形式为：

$$
\eta^2 = \sum_{K \in \mathcal{T}_h} \eta_K^2
$$

其中，局部[误差指标](@entry_id:173250) $\eta_K^2$ 包括两个主要部分：

1.  **单元内部残差**: $h_K^2 \| f + \Delta u_h \|_{L^2(K)}^2$
2.  **单元边界法向通量跳跃残差**: $\frac{1}{2} \sum_{e \subset \partial K, e \in \mathcal{E}_{\mathrm{int}}} h_e \| \llbracket \nabla u_h \cdot \boldsymbol{n}_e \rrbracket \|_{L^2(e)}^2 + \sum_{e \subset \partial K, e \in \mathcal{E}_{\partial}} h_e \| g - \nabla u_h \cdot \boldsymbol{n} \|_{L^2(e)}^2$

这里，$h_K$ 和 $h_e$ 分别是单元和边的尺寸。$\llbracket \cdot \rrbracket$ 表示在共享内边 $e$ 的两个相邻单元间的通量跳跃值。第一项度量了有限元解在单元内部多大程度上违反了原始的[偏微分方程](@entry_id:141332)。第二项度量了在单元边界上法向通量的[不连续性](@entry_id:144108)（对于内部边）或与给定边界条件的不匹配程度（对于边界边）。这些残差项前面的网格尺寸因子 $h_K^2$ 和 $h_e$ 源于在推导过程中使用的[迹不等式](@entry_id:756082)和[庞加莱不等式](@entry_id:142086)，它们确保了[误差估计子](@entry_id:749080)的量纲正确性和可靠性。在自适应循环中，计算机会计算所有单元的 $\eta_K$，并将那些 $\eta_K$ 值最大的单元标记出来进行加密。

### [网格自适应](@entry_id:751899)的策略

一旦确定了需要加密的区域，就需要选择具体的加密策略。主流的自适应方法可以分为几类，每种方法都有其独特的优势和适用场景。

#### 自适应方法分类：h, p, r, hp

根据有限元逼近理论，误差同时受单元尺寸 $h$ 和多项式次数 $p$ 的影响。自适应策略正是通过调整这两个参数来控制误差。

*   **$h$-自适应**：保持单元上的多项式次数 $p$ 不变，通过**分裂**单元来减小其尺寸 $h$（加密），或通过**合并**单元来增大 $h$（粗化）。这是最常用和最成熟的自适应方法。
    *   在实现 $h$-自适应时，一个常见的问题是**[悬挂节点](@entry_id:149024)**（Hanging Nodes）的出现。例如，在二维的“红绿”加密策略中，当一个单元被加密而其相邻单元未被加密时，加密单元的边中点会成为新节点，但它并不是相邻粗单元的顶点。这个节点就是[悬挂节点](@entry_id:149024)。为了保证整个[解空间](@entry_id:200470)的 $C^0$ 连续性，必须对[悬挂节点](@entry_id:149024)上的自由度施加约束。对于线性元，该约束非常直观：[悬挂节点](@entry_id:149024)的值必须等于其所在粗边两个端点值的[线性插值](@entry_id:137092)。例如，对于边 $\overline{\mathbf{ab}}$ 上的中点[悬挂节点](@entry_id:149024) $\mathbf{m}$，约束为 $u_{\mathbf{m}} = \frac{1}{2}(u_{\mathbf{a}} + u_{\mathbf{b}})$。这个约束消除了[悬挂节点](@entry_id:149024)处的独立自由度，从而恢复了跨单元边界的连续性。
*   **$p$-自适应**：保持[网格拓扑](@entry_id:167986)和单元尺寸 $h$ 不变，通过在误差较大的单元上**提高**多项式次数 $p$ 来提升逼近精度。
*   **$r$-自适应**：保持[网格拓扑](@entry_id:167986)（单元和节点的数量及连接关系）和多项式次数 $p$ 不变，通过**移动**网格节点的位置来重新分配空间分辨率。节点被移动到误差或解的梯度较大的区域。
*   **$hp$-自适应**：这是最强大但也最复杂的策略，它**同时**调整单元尺寸 $h$ 和多项式次数 $p$，以期达到对特定问题最优的[收敛率](@entry_id:146534)。

#### 策略与解特征的匹配

选择何种自适应策略，取决于待求解问题的特征。

*   对于具有**奇异性**（如裂纹尖端）或**陡峭[边界层](@entry_id:139416)/内层**的解，其局部光滑性很差。在这种情况下，提高多项式次数的效率不高，甚至可能引入伪震荡（[吉布斯现象](@entry_id:138701)）。最有效的方法是采用 **$h$-自适应**，通过在[奇异点](@entry_id:199525)或梯度剧烈变化的区域密集地布置小尺寸单元来捕捉这些特征。特别是对于各向异性的[边界层](@entry_id:139416)（在一个方向梯度剧烈，另一方向平缓），采用**各向异性 $h$-自适应**（使用高展弦比的单元）尤为高效。
*   对于在某些区域解非常**光滑**（例如[解析函数](@entry_id:139584)）的情况，逼近理论表明，采用 **$p$-自适应**可以获得指数级的收敛速度。即误差随多项式次数 $p$ 的增加呈指数衰减 $e \sim \exp(-\beta p)$，这远快于 $h$-自适应所能达到的代数[收敛率](@entry_id:146534)。
*   对于**移动特征**（如传播的冲击波或热锋），如果采用固定的网格，要么需要全局加密（非常昂贵），要么当特征移动到粗网格区域时会丢失精度。**$r$-自适应**（也称为[移动网格法](@entry_id:752194)）是为此类问题量身定做的。它通过移动节点来追踪特征，使高分辨率区域始终跟随着特征移动，从而在保持节点总数不变的情况下高效地求解。

因此，一个理想的自适应多物理场求解器应能根据局部解的特征，灵活地选用最合适的自适应策略。

#### 定量化比较：h-p 决策

在 $hp$-自适应中，一个核心问题是在一个给定的单元上，究竟是该进行 $h$-加密还是 $p$-加密？这个决策可以基于一个更定量的分析。

假设在一个单元上，通过 $p$-加密，误差随多项式次数的衰减行为可以被建模为 $e_p \sim (p+1)^{-s}$，其中 $s$ 是一个反映局部解**光滑性**的指数。而通过 $h$-加密，误差随单元尺寸的衰减行为是 $e_h \sim h^{p+1}$。我们再假设计算工作量 $W$ 与自由度总数成正比，即 $W \propto E(p+1)^d$，其中 $E$ 是单元数，$d$ 是空间维度。

现在考虑两种消耗相同额外计算资源的加密方案：一是将当前单元的次数从 $p$ 提高到 $p'$；二是在保持次数 $p$ 不变的情况下，将单元分裂为 $r^d$ 个子单元。通过施加“等量工作增长”的约束，可以推导出一个联系 $p'$ 和 $r$ 的关系。将此关系代入两种策略的误差衰减模型，可以发现，当两种策略的误差缩减效果相同时，光滑性指数 $s$ 满足一个临界条件。这个临界[光滑性](@entry_id:634843)指数为：

$$
s_{\star}(p) = p+1
$$

这个简洁而深刻的结果为 $hp$-自适应的“预言机”（oracle）提供了一个基本准则：
*   如果通过某种方式估计出局部解的[光滑性](@entry_id:634843) $s > p+1$，这意味着解比当前多项式次数所能最优逼近的还要光滑，此时采用 **$p$-加密**更为高效。
*   如果 $s  p+1$，这意味着解的光滑性有限，无法从高次多项式中充分受益，此时采用 **$h$-加密**是更好的选择。



### [网格自适应](@entry_id:751899)的高级主题

在现代[多物理场仿真](@entry_id:145294)中，研究者们发展了更为复杂和强大的自适应技术，以应对更具挑战性的问题。

#### [目标导向自适应](@entry_id:749945)：[对偶加权残差法](@entry_id:748715)

在许多工程应用中，我们关心的可能不是解的[全局误差](@entry_id:147874)，而是某个特定的工程量，例如结构某处的最大应力、流过某个界面的总通量等。这类量被称为**关心量**（Quantity of Interest, QoI），通常可以表示为解的泛函 $J(u)$。

**[目标导向自适应](@entry_id:749945)**（Goal-Oriented Adaptivity）的目标是，在给定的计算成本下，最小化关心量的误差 $|J(u) - J(u_h)|$，而不是全局[能量范数](@entry_id:274966)下的误差。**[对偶加权残差法](@entry_id:748715)**（Dual-Weighted Residual, DWR）是实现这一目标的主流方法。

[DWR方法](@entry_id:748715)的核心思想是引入一个伴随问题，也称为**[对偶问题](@entry_id:177454)**（Dual Problem）。这个对偶问题的解 $z$（称为对偶解或伴随解）具有明确的物理意义：它量化了关心量 $J(u)$ 对局部残差的敏感性。[误差估计子](@entry_id:749080)随后被构造成原始问题的残差与对偶解的乘积的积分。这样，只有那些发生在对偶解数值较大区域的残差，才对关心量的误差有显著贡献。

以一个耦合[热弹性](@entry_id:158447)问题为例，其原始问题（Primal Problem）由力学[平衡方程](@entry_id:172166)和[热传导方程](@entry_id:194763)耦合而成。假设我们关心的量是位移场 $u$ 在某区域 $D$ 内的加权平均值 $J(u,T) = \int_D w \cdot u \, d\Omega$。通过严谨的数学推导，可以得到对应的对偶问题。这个对偶问题在结构上与原始问题相关，其算子是原始问题算子的[转置](@entry_id:142115)（或伴随）。原始问题中从温度场 $T$ 到力学场的耦合项，在对偶问题中会转变为一个从对偶力学解 $p_u$ 到对偶温度场 $p_T$ 的源项。具体来说，对偶温度方程的[源项](@entry_id:269111)将正比于对偶位移解的[应变张量](@entry_id:193332)的迹 $\mathrm{tr}(\varepsilon(p_u))$。通过求解这个[对偶问题](@entry_id:177454)，我们就能知道在域内的每一点，局部误差对最终我们关心的位移平均值有多大的影响，从而实现真正“目标导向”的[自适应加密](@entry_id:746260)。

#### [各向异性自适应](@entry_id:167272)：[黎曼度量](@entry_id:754359)

对于具有强烈[方向性](@entry_id:266095)特征的解（如[边界层](@entry_id:139416)、[剪切层](@entry_id:274623)），各向同性的加密（生成接近等边形状的单元）是低效的。例如，为了解析一个薄[边界层](@entry_id:139416)，我们只需要在垂直于边界的方向上加密，而在平行于边界的方向上则可以保持较粗的网格。

**[各向异性自适应](@entry_id:167272)**（Anisotropic Adaptivity）通过在空间中每一点定义一个**[黎曼度量张量](@entry_id:198086)**（Riemannian Metric Tensor）$M(\boldsymbol{x})$ 来实现这一点。$M(\boldsymbol{x})$ 是一个[对称正定](@entry_id:145886)（SPD）矩阵，它定义了一个新的、弯曲的[度量空间](@entry_id:138860)。在这个[度量空间](@entry_id:138860)中，理想的单元是边长为1的“正”单元（如等边三角形）。当这些理想单元被映射回物理空间时，它们就会自动地被拉伸和旋转，形成具有特定尺寸、形状和方向的各向异性单元。

度量张量 $M(\boldsymbol{x})$ 的几何意义可以通过其[特征分解](@entry_id:181333) $M = Q \Lambda Q^T$ 来理解。[特征向量](@entry_id:151813)矩阵 $Q$ 的列向量定义了单元被拉伸的[主方向](@entry_id:276187)，而[特征值](@entry_id:154894)对角阵 $\Lambda$ 中的[特征值](@entry_id:154894) $\lambda_i$ 则定义了在这些主方向上的分辨率要求：大的[特征值](@entry_id:154894)对应短的轴长（即高的分辨率要求）。

在[多物理场](@entry_id:164478)问题中，每个物理场（如 $u$ 和 $v$）可能都需要不同的[各向异性网格](@entry_id:746450)，由各自的度量张量 $M_u$ 和 $M_v$ 描述。为了生成一个对所有场都足够精确的单一网格，需要将这些度量进行合并。一个严谨且常用的方法是计算**度量交集**（Metric Intersection），这对应于寻找在**洛纳[偏序](@entry_id:145467)**（Loewner Partial Order）意义下的[最小上界](@entry_id:142911) $M = \max(M_u, M_v)$。这个合并后的度量 $M$ 能够保证，由它生成的单元在任何方向上的尺寸都不会超过任何一个单一物理场度量所要求的尺寸。也就是说，$h_M(\hat{e}) \le \min(h_u(\hat{e}), h_v(\hat{e}))$ 对所有方向 $\hat{e}$ 成立。这确保了最终的网格能够同时满足所有耦合物理场的精度要求。 

#### 分区系统中的自适应：预算分配

在处理通过[界面耦合](@entry_id:750728)的、定义在不同计算域 $\Omega^1$ 和 $\Omega^2$ 上的分区多物理场问题时，一个实际的挑战是如何分配有限的计算预算（例如，允许增加的总自由度数）来进行[自适应加密](@entry_id:746260)。

DWR框架同样为解决此问题提供了理论指导。总的关心量误差可以近似表示为两个子域中所有单元的[对偶加权残差](@entry_id:748692)之和。这意味着两个子域的误差贡献是相互关联且需要同时控制的。为了在固定的总预算 $B$ 下最大化关心量误差的降低量，一个理性的策略是根据每个[子域](@entry_id:155812)对总误差降低的“性价比”来分配预算。

具体而言，我们可以在每个子域 $\Omega^\alpha$ 中，计算所有单元的“效率”总和 $S^\alpha$。每个单元的效率被定义为其预期的误差降低量（正比于其[对偶加权残差](@entry_id:748692) $\eta_e^\alpha$ 和[网格质量](@entry_id:151343)因子 $\theta_e^\alpha$）与其加密成本 $c_e^\alpha$ 之比。于是，分配给子域 $\Omega^\alpha$ 的预算 $B^\alpha$ 应该与其总效率 $S^\alpha$ 成正比：

$$
B^{\alpha} = B \frac{S^{\alpha}}{S^{1} + S^{2}}, \quad \text{其中} \quad S^{\alpha} = \sum_{e \in \mathcal{T}^{\alpha}} \frac{\theta_{e}^{\alpha} |\eta_{e}^{\alpha}|}{c_{e}^{\alpha}}
$$

这种策略确保了计算资源被优先分配到那些能够以最低成本带来最大关心量误差削减的物理域中，从而实现了在耦合系统层面上最高效的自适应。