{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of the Finite Element Method is the transformation of a differential equation into an equivalent integral, or \"weak,\" form. This practice guides you through this fundamental process, starting from a governing PDE and using integration by parts to derive the weak statement. You will see firsthand how Robin-type boundary conditions, which mix the field value and its derivative, are naturally incorporated into the stiffness matrix and load vector, a key insight into the elegance and power of the method .",
            "id": "3507555",
            "problem": "Consider a scalar field $u$ governed in a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{2}$ by the second-order Partial Differential Equation (PDE) $-\\nabla \\cdot \\left(a \\nabla u\\right) = s$ with $a > 0$ and $s$ sufficiently smooth, where $\\nabla$ denotes the gradient and $\\nabla \\cdot$ denotes the divergence. The boundary $\\partial \\Omega$ is partitioned into a Dirichlet portion $\\Gamma_{D}$ and a Robin portion $\\Gamma_{R}$, on which the Robin boundary condition $a \\, \\partial_{n} u + \\alpha \\, u = g$ holds, with outward normal derivative $\\partial_{n} u$, and with $\\alpha \\ge 0$ and $g$ prescribed. Using the Galerkin form of the Finite Element Method (FEM), start from first principles by multiplying the governing PDE by a test function $v$ and integrating over $\\Omega$, then apply the divergence theorem and enforce the Robin boundary condition on $\\Gamma_{R}$ to obtain the weak form in which the Robin data contributes.\n\nNow, restrict attention to a single boundary edge $e \\subset \\Gamma_{R}$ shared by one boundary triangle, with edge length $L_{e}$ and two end nodes with associated $C^{0}$ linear shape functions $N_{i}$ and $N_{j}$. Assume $a$, $\\alpha$, and $g$ are constant along $e$. Parameterize the edge by the arc-length coordinate $s \\in [0, L_{e}]$ and use the linear shape functions $N_{i}(s) = 1 - s/L_{e}$ and $N_{j}(s) = s/L_{e}$. Derive the explicit $2 \\times 2$ local boundary stiffness matrix contribution $K_{e}^{(R)}$ and the explicit $2 \\times 1$ local boundary load vector contribution $f_{e}^{(R)}$ arising solely from the Robin boundary condition on $e$, expressing your final result in terms of $\\alpha$, $g$, and $L_{e}$.\n\nYour final answer must be given as closed-form analytic expressions. No rounding is required. Express the pair of the stiffness-matrix contribution and the load-vector contribution in a single composite answer.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, objective, and contains a complete and consistent setup for a standard derivation in the Finite Element Method.\n\nWe begin with the governing second-order partial differential equation (PDE) in a domain $\\Omega$:\n$$\n-\\nabla \\cdot \\left(a \\nabla u\\right) = s\n$$\nThe Galerkin method requires deriving the weak form of this equation. We multiply the PDE by a suitable test function $v$ and integrate over the domain $\\Omega$:\n$$\n-\\int_{\\Omega} v \\left( \\nabla \\cdot (a \\nabla u) \\right) \\, d\\Omega = \\int_{\\Omega} v s \\, d\\Omega\n$$\nTo reduce the order of the derivatives on the unknown field $u$, we apply the divergence theorem (or Green's first identity). The general vector identity is $\\nabla \\cdot (\\phi \\mathbf{F}) = (\\nabla \\phi) \\cdot \\mathbf{F} + \\phi (\\nabla \\cdot \\mathbf{F})$. Let $\\phi = v$ and $\\mathbf{F} = a \\nabla u$. Then $\\nabla \\cdot (v (a \\nabla u)) = (\\nabla v) \\cdot (a \\nabla u) + v (\\nabla \\cdot (a \\nabla u))$. Rearranging gives $v(\\nabla \\cdot(a \\nabla u)) = \\nabla \\cdot (v(a \\nabla u)) - (\\nabla v) \\cdot (a \\nabla u)$. Substituting this into the integral and applying the divergence theorem $\\int_{\\Omega} \\nabla \\cdot \\mathbf{G} \\, d\\Omega = \\int_{\\partial \\Omega} \\mathbf{G} \\cdot \\mathbf{n} \\, dS$, we get:\n$$\n-\\int_{\\partial\\Omega} v (a \\nabla u) \\cdot \\mathbf{n} \\, dS + \\int_{\\Omega} (\\nabla v) \\cdot (a \\nabla u) \\, d\\Omega = \\int_{\\Omega} v s \\, d\\Omega\n$$\nRecognizing that $\\nabla u \\cdot \\mathbf{n}$ is the outward normal derivative $\\partial_n u$, the equation becomes:\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega - \\int_{\\partial\\Omega} v (a \\, \\partial_n u) \\, dS = \\int_{\\Omega} v s \\, d\\Omega\n$$\nThe boundary $\\partial\\Omega$ is partitioned into a Dirichlet part $\\Gamma_D$ and a Robin part $\\Gamma_R$. On $\\Gamma_D$, the value of $u$ is prescribed, and we typically choose test functions $v$ that are zero on $\\Gamma_D$. Thus, the boundary integral over $\\Gamma_D$ vanishes. The boundary integral reduces to an integral over $\\Gamma_R$:\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega - \\int_{\\Gamma_R} v (a \\, \\partial_n u) \\, dS = \\int_{\\Omega} v s \\, d\\Omega\n$$\nNow, we enforce the Robin boundary condition, $a \\, \\partial_n u + \\alpha u = g$, which can be rewritten as $a \\, \\partial_n u = g - \\alpha u$. Substituting this into the boundary integral term yields:\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega - \\int_{\\Gamma_R} v (g - \\alpha u) \\, dS = \\int_{\\Omega} v s \\, d\\Omega\n$$\nRearranging the terms to group those involving the unknown $u$ on the left-hand side and the known source terms on the right-hand side, we obtain the weak form:\n$$\n\\int_{\\Omega} a \\nabla v \\cdot \\nabla u \\, d\\Omega + \\int_{\\Gamma_R} \\alpha v u \\, dS = \\int_{\\Omega} v s \\, d\\Omega + \\int_{\\Gamma_R} v g \\, dS\n$$\nIn the finite element discretization, the field $u$ is approximated by $u_h = \\sum_{k} u_k N_k(x)$, where $u_k$ are the nodal degrees of freedom and $N_k(x)$ are the basis (shape) functions. The Galerkin method chooses the test function $v$ to be one of the basis functions, $v = N_i$. For a single boundary edge $e \\subset \\Gamma_R$ with nodes $i$ and $j$, the restriction of the approximation is $u_h|_e = u_i N_i + u_j N_j$. The problem asks for the contributions to the elemental stiffness matrix and load vector that arise *solely* from the Robin boundary condition. These are the terms integrated over $\\Gamma_R$.\n\nThe contribution to the stiffness matrix is from the term $\\int_{\\Gamma_R} \\alpha v u \\, dS$. For a single edge $e$, this becomes:\n$$\nK_{e}^{(R)} = \\int_{e} \\alpha \\begin{pmatrix} N_i \\\\ N_j \\end{pmatrix} \\begin{pmatrix} N_i & N_j \\end{pmatrix} \\, dS\n$$\nThe contribution to the load vector is from the term $\\int_{\\Gamma_R} v g \\, dS$. For a single edge $e$, this becomes:\n$$\nf_{e}^{(R)} = \\int_{e} g \\begin{pmatrix} N_i \\\\ N_j \\end{pmatrix} \\, dS\n$$\nWe are given that $\\alpha$ and $g$ are constant along the edge $e$, which has length $L_e$. The edge is parameterized by arc-length $s \\in [0, L_e]$, so $dS = ds$. The linear shape functions are given as $N_i(s) = 1 - s/L_e$ and $N_j(s) = s/L_e$.\n\nWe now compute the components of the $2 \\times 2$ local boundary stiffness matrix $K_{e}^{(R)}$:\nThe $(1,1)$ component is:\n$$\n(K_{e}^{(R)})_{ii} = \\int_{0}^{L_e} \\alpha N_i(s) N_i(s) \\, ds = \\alpha \\int_{0}^{L_e} \\left(1 - \\frac{s}{L_e}\\right)^2 \\, ds = \\alpha \\left[ -L_e \\frac{(1 - s/L_e)^3}{3} \\right]_0^{L_e} = \\alpha \\left( 0 - \\left(-\\frac{L_e}{3}\\right) \\right) = \\frac{\\alpha L_e}{3}\n$$\nThe $(2,2)$ component is:\n$$\n(K_{e}^{(R)})_{jj} = \\int_{0}^{L_e} \\alpha N_j(s) N_j(s) \\, ds = \\alpha \\int_{0}^{L_e} \\left(\\frac{s}{L_e}\\right)^2 \\, ds = \\alpha \\left[ \\frac{s^3}{3L_e^2} \\right]_0^{L_e} = \\alpha \\left( \\frac{L_e^3}{3L_e^2} - 0 \\right) = \\frac{\\alpha L_e}{3}\n$$\nThe off-diagonal components $(1,2)$ and $(2,1)$ are equal due to symmetry:\n$$\n(K_{e}^{(R)})_{ij} = (K_{e}^{(R)})_{ji} = \\int_{0}^{L_e} \\alpha N_i(s) N_j(s) \\, ds = \\alpha \\int_{0}^{L_e} \\left(1 - \\frac{s}{L_e}\\right)\\left(\\frac{s}{L_e}\\right) \\, ds = \\frac{\\alpha}{L_e} \\int_{0}^{L_e} \\left(s - \\frac{s^2}{L_e}\\right) \\, ds\n$$\n$$\n= \\frac{\\alpha}{L_e} \\left[ \\frac{s^2}{2} - \\frac{s^3}{3L_e} \\right]_0^{L_e} = \\frac{\\alpha}{L_e} \\left( \\left(\\frac{L_e^2}{2} - \\frac{L_e^3}{3L_e}\\right) - 0 \\right) = \\frac{\\alpha}{L_e} \\left(\\frac{L_e^2}{2} - \\frac{L_e^2}{3}\\right) = \\frac{\\alpha L_e}{6}\n$$\nAssembling these components, the local boundary stiffness matrix contribution is:\n$$\nK_{e}^{(R)} = \\begin{pmatrix} \\frac{\\alpha L_e}{3} & \\frac{\\alpha L_e}{6} \\\\ \\frac{\\alpha L_e}{6} & \\frac{\\alpha L_e}{3} \\end{pmatrix} = \\frac{\\alpha L_e}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\nNext, we compute the components of the $2 \\times 1$ local boundary load vector $f_{e}^{(R)}$:\nThe first component is:\n$$\n(f_{e}^{(R)})_{i} = \\int_{0}^{L_e} g N_i(s) \\, ds = g \\int_{0}^{L_e} \\left(1 - \\frac{s}{L_e}\\right) \\, ds = g \\left[ s - \\frac{s^2}{2L_e} \\right]_0^{L_e} = g \\left( (L_e - \\frac{L_e^2}{2L_e}) - 0 \\right) = \\frac{g L_e}{2}\n$$\nThe second component is:\n$$\n(f_{e}^{(R)})_{j} = \\int_{0}^{L_e} g N_j(s) \\, ds = g \\int_{0}^{L_e} \\frac{s}{L_e} \\, ds = g \\left[ \\frac{s^2}{2L_e} \\right]_0^{L_e} = g \\left( \\frac{L_e^2}{2L_e} - 0 \\right) = \\frac{g L_e}{2}\n$$\nAssembling these components, the local boundary load vector contribution is:\n$$\nf_{e}^{(R)} = \\begin{pmatrix} \\frac{g L_e}{2} \\\\ \\frac{g L_e}{2} \\end{pmatrix} = \\frac{g L_e}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nThe pair of the stiffness-matrix contribution and the load-vector contribution represents the complete influence of the Robin boundary condition on the local system for edge $e$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\alpha L_{e}}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} & \\frac{g L_{e}}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "After establishing the weak form, we face the practical task of computing the resulting integrals, which is typically done numerically using quadrature rules on a standard reference element. This exercise will sharpen your understanding of this process by asking you to determine the exact number of Gauss quadrature points needed to integrate the stiffness matrix for a biquadratic ($Q_2$) element without error . This analysis is critical for writing efficient and accurate finite element code, ensuring that numerical integration does not introduce avoidable errors.",
            "id": "3507547",
            "problem": "Consider the scalar Poisson equation $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a single quadrilateral element $\\Omega_e$ with a constant diffusion coefficient $\\kappa$ on $\\Omega_e$. Let the element be obtained from the reference square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ via an affine mapping $\\mathbf{x}(\\xi,\\eta)$ with constant Jacobian matrix $\\mathbf{J}$ and determinant $\\det(\\mathbf{J}) \\neq 0$. The element uses isoparametric biquadratic Lagrange shape functions, that is, $Q_2$ shape functions on $\\hat{\\Omega}$, where $Q_2$ denotes the space of polynomials that are of degree at most $2$ in each variable separately.\n\nThe element stiffness matrix entries are\n$$\nK_{ij} \\;=\\; \\int_{\\Omega_e} \\kappa \\,\\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, d\\Omega \\,,\n$$\nwhere $N_i$ and $N_j$ are the $Q_2$ shape functions pulled back from $\\hat{\\Omega}$ to $\\Omega_e$ by the affine map. You may assume the standard relations for an affine map: $\\nabla N = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N$ and $d\\Omega = |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}$, with $\\hat{\\nabla}$ denoting derivatives with respect to $(\\xi,\\eta)$.\n\nDetermine the smallest integer $n$ such that the tensor-product Gauss–Legendre quadrature rule with $n$ points per direction on $\\hat{\\Omega}$ integrates every stiffness entry $K_{ij}$ exactly. Your justification must be based solely on identifying the bivariate polynomial degree of the integrand on $\\hat{\\Omega}$ and on the exactness property of one-dimensional Gauss–Legendre quadrature. State your final answer as the integer $n$ (no units).",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Governing Equation**: The scalar Poisson equation is $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a single quadrilateral element $\\Omega_e$.\n- **Material Property**: The diffusion coefficient $\\kappa$ is a constant on $\\Omega_e$.\n- **Element Mapping**: The element $\\Omega_e$ is related to the reference square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ by an affine mapping $\\mathbf{x}(\\xi,\\eta)$.\n- **Jacobian Properties**: The Jacobian matrix $\\mathbf{J}$ of the mapping is constant, and its determinant $\\det(\\mathbf{J})$ is non-zero.\n- **Finite Element Space**: The element uses isoparametric biquadratic Lagrange shape functions, denoted as $Q_2$ shape functions on $\\hat{\\Omega}$. The space $Q_2$ consists of bivariate polynomials with a degree of at most $2$ in each variable, $\\xi$ and $\\eta$, separately.\n- **Stiffness Matrix Definition**: The entries of the element stiffness matrix are given by the integral $K_{ij} = \\int_{\\Omega_e} \\kappa \\,\\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, d\\Omega$.\n- **Integral Transformation Rules**: The relationship between gradients in the physical and reference coordinates is $\\nabla N = \\mathbf{J}^{-T} \\,\\hat{\\nabla} N$. The differential area element transforms as $d\\Omega = |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}$. Here, $\\hat{\\nabla}$ represents the gradient operator with respect to the reference coordinates $(\\xi,\\eta)$.\n- **Numerical Integration**: A tensor-product Gauss–Legendre quadrature rule with $n$ points per direction is used to evaluate the integrals on $\\hat{\\Omega}$.\n- **Objective**: Determine the smallest integer $n$ that guarantees exact integration of every stiffness entry $K_{ij}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-defined and scientifically sound. It represents a standard analysis in the field of the finite element method (FEM). All concepts, including the Poisson equation, affine mapping, $Q_2$ elements, and Gauss-Legendre quadrature, are fundamental to computational engineering and applied mathematics. The problem is self-contained, providing all necessary information to deduce the answer. The specification of an \"affine mapping\" and \"constant Jacobian matrix\" is precise and avoids the complexities of a more general isoparametric mapping where the Jacobian would not be constant. The slight ambiguity in using \"isoparametric\" alongside \"affine mapping\" is resolved by the explicit statement that the Jacobian is constant. Therefore, the problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Solution\n\nThe objective is to find the minimum number of quadrature points, $n$, for a tensor-product Gauss-Legendre rule on the reference square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ that will exactly integrate the stiffness matrix entries $K_{ij}$.\n\nThe expression for a stiffness matrix entry is\n$$\nK_{ij} \\;=\\; \\int_{\\Omega_e} \\kappa \\,\\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, d\\Omega\n$$\nTo evaluate this integral, we transform it to the reference element $\\hat{\\Omega}$ using the provided rules. Let $\\hat{N}_i(\\xi, \\eta)$ denote the shape functions on the reference element. The shape functions on the physical element are $N_i(\\mathbf{x}) = \\hat{N}_i(\\xi(\\mathbf{x}), \\eta(\\mathbf{x}))$. The gradient transformation is $\\nabla N_i = \\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i$, and the area element transformation is $d\\Omega = |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}$.\n\nSubstituting these into the integral for $K_{ij}$:\n$$\nK_{ij} \\;=\\; \\int_{\\hat{\\Omega}} \\kappa \\, (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j) \\, |\\det(\\mathbf{J})| \\, d\\hat{\\Omega}\n$$\nThe integrand on the reference element is $I(\\xi, \\eta) = \\kappa |\\det(\\mathbf{J})| \\, (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j)$.\n\nAccording to the problem statement, $\\kappa$ is a constant. The mapping is affine, which implies that the Jacobian matrix $\\mathbf{J}$ is constant. Consequently, its inverse transpose $\\mathbf{J}^{-T}$ and its determinant $\\det(\\mathbf{J})$ are also constant. Therefore, the term $\\kappa |\\det(\\mathbf{J})|$ is a constant scalar.\n\nThe analysis thus reduces to determining the polynomial degree of the dot product term $(\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j)$. This can be expressed as a quadratic form:\n$$\n(\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_i) \\cdot (\\mathbf{J}^{-T} \\hat{\\nabla} \\hat{N}_j) = (\\hat{\\nabla} \\hat{N}_i)^T (\\mathbf{J}^{-1} \\mathbf{J}^{-T}) (\\hat{\\nabla} \\hat{N}_j)\n$$\nLet the constant matrix $\\mathbf{C} = \\mathbf{J}^{-1} \\mathbf{J}^{-T}$ be denoted by its components $\\begin{pmatrix} C_{11} & C_{12} \\\\ C_{21} & C_{22} \\end{pmatrix}$. The expression becomes:\n$$\nC_{11} \\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\xi} + C_{12} \\left( \\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\eta} + \\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\xi} \\right) + C_{22} \\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\eta}\n$$\nThe shape functions $\\hat{N}_k(\\xi, \\eta)$ for a $Q_2$ element are polynomials of degree at most $2$ in $\\xi$ and at most $2$ in $\\eta$. Let $P_d(t)$ denote the space of polynomials in variable $t$ of degree at most $d$. Then $\\hat{N}_k \\in P_2(\\xi) \\otimes P_2(\\eta)$.\n\nThe derivatives of the shape functions are:\n- $\\frac{\\partial \\hat{N}_k}{\\partial \\xi}$: The degree in $\\xi$ is reduced by $1$, while the degree in $\\eta$ is unchanged. Thus, $\\frac{\\partial \\hat{N}_k}{\\partial \\xi} \\in P_1(\\xi) \\otimes P_2(\\eta)$.\n- $\\frac{\\partial \\hat{N}_k}{\\partial \\eta}$: The degree in $\\eta$ is reduced by $1$, while the degree in $\\xi$ is unchanged. Thus, $\\frac{\\partial \\hat{N}_k}{\\partial \\eta} \\in P_2(\\xi) \\otimes P_1(\\eta)$.\n\nNow, we determine the polynomial degree of each product in the integrand:\n1.  For the term $\\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\xi}$:\n    The maximum degree in $\\xi$ is $1 + 1 = 2$.\n    The maximum degree in $\\eta$ is $2 + 2 = 4$.\n    This term belongs to the space $P_2(\\xi) \\otimes P_4(\\eta)$.\n\n2.  For the term $\\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\eta}$:\n    The maximum degree in $\\xi$ is $2 + 2 = 4$.\n    The maximum degree in $\\eta$ is $1 + 1 = 2$.\n    This term belongs to the space $P_4(\\xi) \\otimes P_2(\\eta)$.\n\n3.  For the terms $\\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\frac{\\partial \\hat{N}_j}{\\partial \\eta}$ and $\\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\frac{\\partial \\hat{N}_j}{\\partial \\xi}$:\n    The maximum degree in $\\xi$ is $1 + 2 = 3$.\n    The maximum degree in $\\eta$ is $2 + 1 = 3$.\n    These terms belong to the space $P_3(\\xi) \\otimes P_3(\\eta)$.\n\nThe total integrand $I(\\xi, \\eta)$ is a linear combination of these polynomial terms. The maximum degree of $I(\\xi, \\eta)$ in each variable is the maximum of the degrees of the individual terms.\n- Maximum degree in $\\xi$: $\\max(2, 4, 3) = 4$.\n- Maximum degree in $\\eta$: $\\max(4, 2, 3) = 4$.\n\nThus, the integrand $I(\\xi, \\eta)$ is a bivariate polynomial with maximum degree $4$ in $\\xi$ and maximum degree $4$ in $\\eta$.\n\nTo integrate this polynomial exactly using a tensor-product Gauss-Legendre quadrature rule, we consider the one-dimensional integrations. An $n$-point 1D Gauss-Legendre quadrature rule can integrate any polynomial of degree up to $2n-1$ exactly.\n\nFor the integration with respect to $\\xi$, we must be able to exactly integrate a polynomial of degree up to $p=4$. This requires the number of quadrature points $n$ to satisfy:\n$$\n2n - 1 \\ge 4\n$$\n$$\n2n \\ge 5\n$$\n$$\nn \\ge 2.5\n$$\nSince $n$ must be an integer, the smallest acceptable value is $n=3$.\n\nSimilarly, for the integration with respect to $\\eta$, the integrand is a polynomial of degree up to $4$. The same condition applies:\n$$\n2n - 1 \\ge 4 \\implies n \\ge 2.5\n$$\nThe minimum integer value for $n$ is again $3$.\n\nSince the problem describes a tensor-product rule with $n$ points in each direction, the same value of $n$ applies to both the $\\xi$ and $\\eta$ directions. Therefore, the smallest integer $n$ that guarantees exact integration of all stiffness matrix entries is $3$. This corresponds to a $3 \\times 3$ quadrature grid on the reference element.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "Higher-order elements often contain internal nodes that are not shared with adjacent elements, introducing \"bubble\" degrees of freedom. This practice introduces static condensation, a powerful algebraic technique to eliminate these internal variables at the element level before global assembly . By deriving the condensed stiffness operator, or Schur complement, you will gain insight into how the computational efficiency of the finite element method can be significantly enhanced without sacrificing accuracy.",
            "id": "3507536",
            "problem": "Consider a two-dimensional steady diffusion subproblem representative of a thermoelastic or electrothermal multiphysics coupling, posed on a single isoparametric nine-node biquadratic quadrilateral element ($Q_2$) whose reference domain is the square $\\{(\\xi,\\eta)\\in[-1,1]^2\\}$. The governing partial differential equation (PDE) is $-\\nabla\\cdot(k\\nabla u)=0$ with constant isotropic conductivity $k>0$, and the mapping from the reference to the physical element is the identity. Using the standard Galerkin Finite Element Method (FEM), the element stiffness entries are defined by\n$$\nK_{ab} \\;=\\; \\int_{-1}^{1}\\int_{-1}^{1} k\\, \\nabla N_a(\\xi,\\eta)\\cdot \\nabla N_b(\\xi,\\eta)\\, d\\xi\\, d\\eta,\n$$\nwhere $N_a$ and $N_b$ are the nine-node biquadratic Lagrange shape functions. Denote the unique internal node at the element center by $i$ with shape function $N_i(\\xi,\\eta) = (1-\\xi^2)(1-\\eta^2)$, and collect the eight boundary degrees of freedom (corner and midside nodes) into a block $b$. The element system can be partitioned into the block form\n$$\n\\begin{pmatrix}\nK_{bb} & K_{bi} \\\\\nK_{ib} & K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_b \\\\\nu_i\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\nf_b \\\\\nf_i\n\\end{pmatrix},\n$$\nwith $K_{ii}\\in\\mathbb{R}$, $K_{bi}\\in\\mathbb{R}^{8\\times 1}$, $K_{ib}\\in\\mathbb{R}^{1\\times 8}$, and $K_{bb}\\in\\mathbb{R}^{8\\times 8}$. Starting from the weak form and the definition of the biquadratic shape functions, and without invoking any pre-stated result about static condensation, derive how exact elimination of the internal degree of freedom $u_i$ leads to a condensed operator on the boundary block $u_b$. In particular:\n\n- Compute $K_{ii}$ exactly from first principles using $N_i(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$ and the identity mapping.\n- Perform the algebraic elimination of $u_i$ to obtain the condensed boundary operator written solely in terms of the blocks $K_{bb}$, $K_{bi}$, $K_{ib}$, and the conductivity $k$.\n\nExpress your final answer as a single closed-form analytical expression for the condensed boundary operator, with no units and no rounding.",
            "solution": "The problem statement is found to be valid as it is scientifically grounded in the principles of the Finite Element Method (FEM) applied to a standard steady diffusion problem, is well-posed with sufficient information for a unique derivation, and is expressed in objective, unambiguous language.\n\nThe task is to derive the condensed boundary operator for a nine-node biquadratic quadrilateral element by eliminating the internal degree of freedom. This process involves two main steps: first, computing the stiffness matrix entry $K_{ii}$ corresponding to the internal node, and second, performing the algebraic elimination.\n\nThe element stiffness matrix entries are given by the formula:\n$$\nK_{ab} = \\int_{-1}^{1}\\int_{-1}^{1} k\\, \\nabla N_a(\\xi,\\eta)\\cdot \\nabla N_b(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\nThe problem specifies that the mapping from the reference domain $(\\xi, \\eta)$ to the physical domain $(x, y)$ is the identity. This implies that the Jacobian matrix of the transformation is the identity matrix, and thus the gradient operator in physical coordinates is identical to the gradient operator in reference coordinates, i.e., $\\nabla = \\left( \\frac{\\partial}{\\partial\\xi}, \\frac{\\partial}{\\partial\\eta} \\right)$.\n\nFirst, we compute the diagonal entry $K_{ii}$ corresponding to the internal node, whose shape function is given as $N_i(\\xi,\\eta) = (1-\\xi^2)(1-\\eta^2)$.\nThe formula for $K_{ii}$ is:\n$$\nK_{ii} = \\int_{-1}^{1}\\int_{-1}^{1} k\\, \\nabla N_i(\\xi,\\eta)\\cdot \\nabla N_i(\\xi,\\eta)\\, d\\xi\\, d\\eta\n$$\nWe begin by calculating the gradient of $N_i$:\n$$\n\\nabla N_i(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial\\xi} \\\\ \\frac{\\partial N_i}{\\partial\\eta} \\end{pmatrix} = \\begin{pmatrix} -2\\xi(1-\\eta^2) \\\\ -2\\eta(1-\\xi^2) \\end{pmatrix}\n$$\nNext, we compute the dot product $\\nabla N_i \\cdot \\nabla N_i$:\n$$\n\\nabla N_i \\cdot \\nabla N_i = (-2\\xi(1-\\eta^2))^2 + (-2\\eta(1-\\xi^2))^2 = 4\\xi^2(1-\\eta^2)^2 + 4\\eta^2(1-\\xi^2)^2\n$$\nNow, we substitute this expression into the integral for $K_{ii}$:\n$$\nK_{ii} = k \\int_{-1}^{1}\\int_{-1}^{1} \\left( 4\\xi^2(1-\\eta^2)^2 + 4\\eta^2(1-\\xi^2)^2 \\right) \\,d\\xi\\,d\\eta\n$$\nWe can separate the integral into two parts:\n$$\nK_{ii} = 4k \\int_{-1}^{1}\\int_{-1}^{1} \\xi^2(1-\\eta^2)^2 \\,d\\xi\\,d\\eta + 4k \\int_{-1}^{1}\\int_{-1}^{1} \\eta^2(1-\\xi^2)^2 \\,d\\xi\\,d\\eta\n$$\nDue to the symmetry of the integrand and the domain, the two integrals are equal. We can write:\n$$\nK_{ii} = 8k \\int_{-1}^{1}\\int_{-1}^{1} \\xi^2(1-\\eta^2)^2 \\,d\\xi\\,d\\eta\n$$\nThe integral is separable with respect to $\\xi$ and $\\eta$:\n$$\nK_{ii} = 8k \\left( \\int_{-1}^{1} \\xi^2 \\,d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta^2)^2 \\,d\\eta \\right)\n$$\nWe evaluate each one-dimensional integral:\nThe first integral is:\n$$\n\\int_{-1}^{1} \\xi^2 \\,d\\xi = \\left[ \\frac{\\xi^3}{3} \\right]_{-1}^{1} = \\frac{1^3}{3} - \\frac{(-1)^3}{3} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}\n$$\nThe second integral is:\n$$\n\\int_{-1}^{1} (1-\\eta^2)^2 \\,d\\eta = \\int_{-1}^{1} (1 - 2\\eta^2 + \\eta^4) \\,d\\eta = \\left[ \\eta - \\frac{2\\eta^3}{3} + \\frac{\\eta^5}{5} \\right]_{-1}^{1}\n$$\n$$\n= \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) - \\left( -1 - \\frac{2(-1)^3}{3} + \\frac{(-1)^5}{5} \\right) = \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) - \\left( -1 + \\frac{2}{3} - \\frac{1}{5} \\right)\n$$\n$$\n= 2 \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) = 2 \\left( \\frac{15 - 10 + 3}{15} \\right) = 2 \\left( \\frac{8}{15} \\right) = \\frac{16}{15}\n$$\nSubstituting these results back into the expression for $K_{ii}$:\n$$\nK_{ii} = 8k \\left( \\frac{2}{3} \\right) \\left( \\frac{16}{15} \\right) = \\frac{256k}{45}\n$$\nThis completes the first part of the task.\n\nSecond, we perform the algebraic elimination of the internal degree of freedom $u_i$. The partitioned system of linear equations is given as:\n$$\n\\begin{pmatrix}\nK_{bb} & K_{bi} \\\\\nK_{ib} & K_{ii}\n\\end{pmatrix}\n\\begin{pmatrix}\nu_b \\\\ u_i\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nf_b \\\\ f_i\n\\end{pmatrix}\n$$\nThis block matrix equation corresponds to two equations:\n$1.$ $K_{bb} u_b + K_{bi} u_i = f_b$\n$2.$ $K_{ib} u_b + K_{ii} u_i = f_i$\n\nFrom the second equation, we solve for the internal degree of freedom $u_i$:\n$$\nK_{ii} u_i = f_i - K_{ib} u_b\n$$\nSince $K_{ii}$ is a non-zero scalar ($K_{ii} = \\frac{256k}{45}$ with $k>0$), its inverse $K_{ii}^{-1} = \\frac{1}{K_{ii}}$ exists.\n$$\nu_i = K_{ii}^{-1} (f_i - K_{ib} u_b)\n$$\nNow, we substitute this expression for $u_i$ into the first equation:\n$$\nK_{bb} u_b + K_{bi} \\left( K_{ii}^{-1} (f_i - K_{ib} u_b) \\right) = f_b\n$$\nExpanding the terms:\n$$\nK_{bb} u_b + K_{bi} K_{ii}^{-1} f_i - K_{bi} K_{ii}^{-1} K_{ib} u_b = f_b\n$$\nTo obtain the condensed system for the boundary degrees of freedom $u_b$, we group all terms involving $u_b$ on the left-hand side:\n$$\n(K_{bb} - K_{bi} K_{ii}^{-1} K_{ib}) u_b = f_b - K_{bi} K_{ii}^{-1} f_i\n$$\nThe matrix pre-multiplying the boundary degrees of freedom vector $u_b$ is the condensed boundary operator, often denoted as the Schur complement of the block $K_{ii}$. This operator is:\n$$\n\\hat{K}_{bb} = K_{bb} - K_{bi} K_{ii}^{-1} K_{ib}\n$$\nFinally, we substitute the previously computed value for $K_{ii}$:\n$$\nK_{ii}^{-1} = \\left(\\frac{256k}{45}\\right)^{-1} = \\frac{45}{256k}\n$$\nThe resulting condensed boundary operator is:\n$$\n\\hat{K}_{bb} = K_{bb} - K_{bi} \\left( \\frac{45}{256k} \\right) K_{ib} = K_{bb} - \\frac{45}{256k} K_{bi} K_{ib}\n$$\nThis is the final expression for the condensed operator, written in terms of the stiffness matrix blocks and the conductivity $k$.",
            "answer": "$$\n\\boxed{K_{bb} - \\frac{45}{256k} K_{bi} K_{ib}}\n$$"
        }
    ]
}