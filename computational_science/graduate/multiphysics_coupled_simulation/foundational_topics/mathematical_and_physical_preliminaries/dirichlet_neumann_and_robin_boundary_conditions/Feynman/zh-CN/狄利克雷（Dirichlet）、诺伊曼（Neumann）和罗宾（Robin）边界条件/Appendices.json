{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个练习将引导您在一个统一的框架内同时实施狄利克雷（Dirichlet）和诺伊曼（Neumann）边界条件，为您提供一个坚实的实践起点。通过为一维泊松方程应用切比雪夫配置法，您将掌握修改离散系统矩阵以强形式施加不同类型边界条件的核心技术。这项实践旨在巩固您对谱方法数值实现的基本理解。",
            "id": "3379366",
            "problem": "考虑在区间 $(0,1)$ 上的一维泊松方程 $-\\Delta u = f$，其中 $\\Delta$ 表示关于 $x$ 的二阶导数算子，该方程服从混合边界条件：在 $x=0$ 处为狄利克雷（Dirichlet）边界条件，在 $x=1$ 处为诺伊曼（Neumann）边界条件。具体而言，强制施加 $u(0) = g_D$ 和 $\\partial_x u(1) = g_N$。目标是构造解析解 $u$ 及其关联的右端项 $f$，使用基于切比雪夫-高斯-洛巴托（Chebyshev–Gauss–Lobatto）点的切比雪夫配置法对问题进行离散化，并数值验证谱（指数）收敛性。\n\n必须遵循谱配置法的基本定义。使用在 $[-1,1]$ 上的切比雪夫-高斯-洛巴托点 $\\{\\xi_j\\}_{j=0}^N$，由 $\\xi_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$ 给出，以及在 $[-1,1]$ 上的标准切比雪夫微分矩阵 $D$，该矩阵由经过充分测试的显式公式定义，其元素为\n$$\nD_{ij} = \\begin{cases}\n\\frac{c_i}{c_j}\\frac{(-1)^{i+j}}{\\xi_i - \\xi_j},  i \\neq j, \\\\\n-\\sum_{k \\neq i} D_{ik},  i=j,\n\\end{cases}\n$$\n其中 $c_0 = 2$，$c_N = 2$，且对于 $j=1,\\dots,N-1$ 有 $c_j = 1$。使用 $x = \\frac{\\xi+1}{2}$ 映射计算域，使得 $\\xi = -1$ 对应于 $x=0$，$\\xi=1$ 对应于 $x=1$。在此映射下，$d/dx = 2\\,d/d\\xi$ 且 $d^2/dx^2 = 4\\,d^2/d\\xi^2$。构造关于 $x$ 的离散二阶导数算子为 $D^{(2)}_x = 4 D^2$。\n\n按如下方式建立配置线性系统。对于内部配置点（$j=1,\\dots,N-1$），使用 $-D^{(2)}_x u = f$ 来强制施加强形式 $-u''(x_j) = f(x_j)$。在右端点（$j=0$，对应于 $x=1$），使用离散算子 $2 D u = g_N$ 来强制施加诺伊曼边界条件 $\\partial_x u(1) = g_N$。在左端点（$j=N$，对应于 $x=0$），通过将相应行替换为单位约束来强制施加狄利克雷边界条件 $u(0) = g_D$。\n\n所有三角函数的角度必须以弧度为单位。\n\n构造的解析解：\n- 选择 $u_1(x) = e^{x} \\sin(2\\pi x)$，其 $f_1(x) = -u_1''(x)$，边界数据为 $g_{D,1} = u_1(0)$ 和 $g_{N,1} = u_1'(1)$。\n- 选择 $u_2(x) = \\cosh(3x) + \\cos(5x)$，其 $f_2(x) = -u_2''(x)$，边界数据为 $g_{D,2} = u_2(0)$ 和 $g_{N,2} = u_2'(1)$。\n\n验证目标：\n- 对于解析解 $u$，切比雪夫配置法预期会产生随 $N$ 指数衰减的误差。通过为一系列 $N$ 值计算 $\\log_{10}(\\text{error})$ 相对于 $N$ 的最小二乘斜率 $b$ 和决定系数 $R^2$ 来量化此特性。指数收敛的数值证据是显著的负斜率 $b0$ 和接近 $1$ 的高 $R^2$ 值。\n\n误差定义：\n- 在配置网格上使用点态最大范数：$\\|e\\|_{\\infty} = \\max_j |u_{\\text{num}}(x_j) - u_{\\text{exact}}(x_j)|$。\n\n测试套件与必需输出：\n- 测试用例 $\\mathsf{A}$（正常路径）：使用 $u_1$ 和 $N \\in \\{8,16,32,64\\}$。计算 $y = \\log_{10}(\\|e\\|_{\\infty})$ 相对于 $N$ 的最小二乘斜率 $b_{\\mathsf{A}}$ 和 $R^2_{\\mathsf{A}}$，并报告在最大 $N=64$ 时的 $\\|e\\|_{\\infty}$。\n- 测试用例 $\\mathsf{B}$（备选解析解）：使用 $u_2$ 和 $N \\in \\{6,12,24,48\\}$。计算 $b_{\\mathsf{B}}$ 和 $R^2_{\\mathsf{B}}$。\n- 测试用例 $\\mathsf{C}$（边界条件验证）：对于 $u_1$ 和 $N=32$，使用离散算子计算边界处的绝对残差，即 $r_D = |u_{\\text{num}}(0) - g_{D,1}|$ 和 $r_N = |\\partial_x u_{\\text{num}}(1) - g_{N,1}|$，其中 $\\partial_x u_{\\text{num}}(1)$ 是通过在右端点行计算 $2\\,D u$ 得到的。\n- 测试用例 $\\mathsf{D}$（边界情况小 $N$）：对于 $u_1$ 和 $N=4$，计算最大范数误差 $\\|e\\|_{\\infty}$。\n\n您的程序必须数值地组装并求解配置线性系统，并按此确切顺序生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，内含以下八个结果：\n$$[b_{\\mathsf{A}}, R^2_{\\mathsf{A}}, \\|e\\|_{\\infty}\\text{ at }N=64, b_{\\mathsf{B}}, R^2_{\\mathsf{B}}, r_D, r_N, \\|e\\|_{\\infty}\\text{ at }N=4].$$\n所有值必须是实数。$\\sin$ 和 $\\cos$ 中的角度必须以弧度为单位。由于所有量都是无量纲的，因此不需要单位。最终输出必须是确切要求格式的单行文本。",
            "solution": "该问题是有效的。它提出了一个清晰、独立且科学上合理的任务：使用切比雪夫配置谱方法求解具有混合边界条件的一维泊松方程。该方法论，包括使用构造解进行验证，是计算科学和工程领域的标准实践。所有必需的数据、定义和程序都得到了明确无误的规定，没有歧义或矛盾。\n\n该方法的核心是在一组配置点上对微分方程和边界条件进行离散化，将问题转化为一个线性代数方程组。然后通过求解该方程组获得解。\n\n首先，我们定义计算域和物理域。问题指定物理域为区间 $x \\in [0, 1]$。我们使用标准的仿射映射将其与经典的切比雪夫域 $\\xi \\in [-1, 1]$ 关联起来：\n$$x(\\xi) = \\frac{\\xi + 1}{2}$$\n配置点是切比雪夫-高斯-洛巴托（CGL）点，由 $\\xi_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$ 给出，其中 $j=0, 1, \\dots, N$。请注意，在此标准索引下，$\\xi_0=1$ 对应于 $x=1$，而 $\\xi_N=-1$ 对应于 $x=0$。\n\n关于 $x$ 的导数通过链式法则与关于 $\\xi$ 的导数相关联：\n$$ \\frac{d}{dx} = \\frac{d\\xi}{dx} \\frac{d}{d\\xi} = 2 \\frac{d}{d\\xi} $$\n$$ \\frac{d^2}{dx^2} = 4 \\frac{d^2}{d\\xi^2} $$\n在谱配置法中，微分是通过矩阵-向量乘法来执行的。我们在 CGL 网格 $\\{\\xi_j\\}$ 上构造 $(N+1) \\times (N+1)$ 的切比雪夫微分矩阵 $D$。问题为其元素 $D_{ij}$ 提供了显式公式。物理域中的离散一阶和二阶导数算子 $D^{(1)}_x$ 和 $D^{(2)}_x$ 则由以下公式给出：\n$$ D^{(1)}_x = 2D $$\n$$ D^{(2)}_x = 4D^2 $$\n\n任务是找到一个近似解值向量 $U$，其元素 $U_j \\approx u(x_j)$ 对应于配置点 $x_j = x(\\xi_j)$ 上的值。该向量是线性系统 $A U = b$ 的解，其中矩阵 $A$ 和向量 $b$ 在配置点上强制施加控制方程和边界条件。\n\n该系统按如下方式构造：\n1.  **内部点 ($j=1, \\dots, N-1$)：** 在这些点上，我们强制施加泊松方程 $-\\Delta u = f$，即 $-u''(x_j) = f(x_j)$。其离散形式为 $-[D^{(2)}_x U]_j = f(x_j)$。这些方程填充了系统 $A U = b$ 的第 $1$ 行到第 $N-1$ 行。\n\n2.  **$x=1$ 处的诺伊曼边界 ($j=0$)：** 在此点，我们强制施加条件 $\\partial_x u(1) = g_N$。其离散形式为 $[D^{(1)}_x U]_0 = g_N$。此方程填充了系统的第 $0$ 行。\n\n3.  **$x=0$ 处的狄利克雷边界 ($j=N$)：** 在此点，我们强制施加 $u(0) = g_D$。这是通过直接设置未知数值 $U_N = g_D$ 来实现的。具体做法是将矩阵 $A$ 的第 $N$ 行替换为一个单位行（除第 $N$ 列为 $1$ 外，其余全为零），并将右端向量 $b$ 的相应元素设置为 $g_D$。\n\n在组装完 $(N+1) \\times (N+1)$ 矩阵 $A$ 和右端向量 $b$ 后，使用标准的线性求解器求解系统 $A U = b$，以获得未知向量 $U$。\n\n为验证该方法，我们使用构造解法。我们选择一个光滑函数 $u(x)$，然后推导出相应的源项 $f(x) = -u''(x)$ 以及边界数据 $g_D = u(0)$ 和 $g_N=u'(1)$。然后可以将数值解 $U$ 与在配置点上求值的已知精确解 $u(x)$ 进行比较。对于解析解 $u(x)$，谱方法预期会展现出指数收敛性，即误差 $\\|e\\|_\\infty = \\max_j |U_j - u(x_j)|$ 会随 $N$ 呈指数衰减。通过观察到 $\\log_{10}(\\|e\\|_\\infty)$ 近似为 $N$ 的线性函数，可以对此进行验证。我们通过执行最小二乘线性回归来量化此关系，以找到斜率 $b$ 和决定系数 $R^2$。一个大的负斜率和接近 $1$ 的 $R^2$ 值证实了指数收敛性。\n\n指定的测试用例涉及两种不同的构造解、收敛度量计算、边界条件残差检查以及对小 $N$ 值的误差评估。边界残差 $r_D = |u_{\\text{num}}(0) - g_D|$ 和 $r_N = |\\partial_x u_{\\text{num}}(1) - g_N|$ 用作健全性检查，以确保线性系统正确地施加了边界条件。考虑到强制施加的方法，这些残差预期会接近机器精度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef linear_regression(x_data, y_data):\n    \"\"\"\n    Performs a linear regression y = a + b*x and calculates R^2.\n    \"\"\"\n    x_data = np.asarray(x_data)\n    y_data = np.asarray(y_data)\n\n    # Use numpy.polyfit to get slope and intercept\n    slope, intercept = np.polyfit(x_data, y_data, 1)\n    \n    # Calculate R-squared value\n    y_mean = np.mean(y_data)\n    y_predicted = slope * x_data + intercept\n    ss_total = np.sum((y_data - y_mean)**2)\n    ss_residual = np.sum((y_data - y_predicted)**2)\n    \n    if ss_total == 0:\n        # Handle case where all y_data points are the same\n        r_squared = 1.0 if ss_residual == 0 else 0.0\n    else:\n        r_squared = 1.0 - (ss_residual / ss_total)\n        \n    return slope, r_squared\n\ndef chebyshev_diff_matrix(N):\n    \"\"\"\n    Constructs the Chebyshev differentiation matrix D on N+1 CGL points.\n    \"\"\"\n    if N == 0:\n        return np.zeros((1, 1))\n    \n    j = np.arange(N + 1)\n    xi = np.cos(np.pi * j / N)\n    \n    c = np.ones(N + 1)\n    c[0] = 2.\n    c[N] = 2.\n    \n    # Off-diagonal entries\n    c_i = c[:, np.newaxis]\n    c_j = c[np.newaxis, :]\n    xi_i = xi[:, np.newaxis]\n    xi_j = xi[np.newaxis, :]\n    d_xi = xi_i - xi_j\n    \n    signs = (-1)**(np.arange(N + 1)[:, np.newaxis] + np.arange(N + 1)[np.newaxis, :])\n    \n    D = (c_i / c_j) * signs / (d_xi + np.eye(N + 1))\n    np.fill_diagonal(D, 0.)\n    \n    # Diagonal entries\n    np.fill_diagonal(D, -np.sum(D, axis=1))\n    \n    return D\n\ndef solve_poisson_1d(N, u_func, f_func, g_D_val, g_N_val):\n    \"\"\"\n    Solves the 1D Poisson BVP using Chebyshev collocation.\n    \"\"\"\n    j = np.arange(N + 1)\n    xi = np.cos(np.pi * j / N)\n    x = (xi + 1.0) / 2.0\n    \n    D = chebyshev_diff_matrix(N)\n    D1x = 2.0 * D\n    D2x = 4.0 * np.dot(D, D)\n\n    A = np.zeros((N + 1, N + 1))\n    b = np.zeros(N + 1)\n    \n    # Interior points: -u'' = f\n    A[1:N, :] = -D2x[1:N, :]\n    b[1:N] = f_func(x[1:N])\n    \n    # Neumann BC at x=1 (j=0)\n    A[0, :] = D1x[0, :]\n    b[0] = g_N_val\n    \n    # Dirichlet BC at x=0 (j=N)\n    A[N, :] = 0.0\n    A[N, N] = 1.0\n    b[N] = g_D_val\n    \n    U_num = np.linalg.solve(A, b)\n    U_exact = u_func(x)\n    \n    error = np.max(np.abs(U_num - U_exact))\n    \n    return {\n        \"error\": error,\n        \"U_num\": U_num,\n        \"D1x\": D1x,\n    }\n\ndef solve():\n    \"\"\"\n    Main function to execute all test cases and print results.\n    \"\"\"\n    # Manufactured solution 1\n    u1 = lambda x: np.exp(x) * np.sin(2. * np.pi * x)\n    u1_prime = lambda x: np.exp(x) * (np.sin(2. * np.pi * x) + 2. * np.pi * np.cos(2. * np.pi * x))\n    f1 = lambda x: -np.exp(x) * ( (1. - 4. * np.pi**2) * np.sin(2. * np.pi * x) + 4. * np.pi * np.cos(2. * np.pi * x) )\n    g_D1 = u1(0.0)\n    g_N1 = u1_prime(1.0)\n\n    # Manufactured solution 2\n    u2 = lambda x: np.cosh(3. * x) + np.cos(5. * x)\n    u2_prime = lambda x: 3. * np.sinh(3. * x) - 5. * np.sin(5. * x)\n    f2 = lambda x: -(9. * np.cosh(3. * x) - 25. * np.cos(5. * x))\n    g_D2 = u2(0.0)\n    g_N2 = u2_prime(1.0)\n    \n    # Test case A: u1, N = {8, 16, 32, 64}\n    Ns_A = np.array([8, 16, 32, 64])\n    errors_A = []\n    for N in Ns_A:\n        result = solve_poisson_1d(N, u1, f1, g_D1, g_N1)\n        errors_A.append(result[\"error\"])\n    log_errors_A = np.log10(np.array(errors_A))\n    b_A, R2_A = linear_regression(Ns_A, log_errors_A)\n    error_N64_A = errors_A[-1]\n\n    # Test case B: u2, N = {6, 12, 24, 48}\n    Ns_B = np.array([6, 12, 24, 48])\n    errors_B = []\n    for N in Ns_B:\n        result = solve_poisson_1d(N, u2, f2, g_D2, g_N2)\n        errors_B.append(result[\"error\"])\n    log_errors_B = np.log10(np.array(errors_B))\n    b_B, R2_B = linear_regression(Ns_B, log_errors_B)\n    \n    # Test case C: u1, N=32, boundary residuals\n    N_C = 32\n    result_C = solve_poisson_1d(N_C, u1, f1, g_D1, g_N1)\n    U_num_C = result_C[\"U_num\"]\n    D1x_C = result_C[\"D1x\"]\n    # Dirichlet residual at x=0 (index N)\n    r_D = np.abs(U_num_C[-1] - g_D1)\n    # Neumann residual at x=1 (index 0)\n    du_dx_at_1_num = (D1x_C @ U_num_C)[0]\n    r_N = np.abs(du_dx_at_1_num - g_N1)\n    \n    # Test case D: u1, N=4, error\n    N_D = 4\n    result_D = solve_poisson_1d(N_D, u1, f1, g_D1, g_N1)\n    error_N4_D = result_D[\"error\"]\n    \n    final_results = [b_A, R2_A, error_N64_A, b_B, R2_B, r_D, r_N, error_N4_D]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在之前练习的基础上，本次实践将处理更具一般性的罗宾（Robin）边界条件，该条件同时包含了函数值及其导数的信息。您将学习如何修改切比雪夫配置格式中的边界方程，以精确反映罗宾条件的数学结构。这项练习对于掌握如何模拟多物理场问题中常见的、更为复杂的边界相互作用至关重要。",
            "id": "3379336",
            "problem": "实现一个用于求解含 Robin 边界条件的一维线性边值问题的切比雪夫配置求解器，并用它来评估谱精度。请从以下基本概念着手：Chebyshev–Gauss–Lobatto (CGL) 节点的定义、根据这些节点构建切比雪夫一阶导数矩阵，以及通过替换配置系统中的方程来施加边界条件的原理。\n\n考虑常微分方程 (ODE)\n$$\n-\\,u''(x) + \\lambda\\,u(x) = f(x), \\quad x \\in [-1,1],\n$$\n其在两个端点均满足 Robin 边界条件，\n$$\nu'(1) + \\alpha_L\\,u(1) = g_L, \\qquad u'(-1) + \\alpha_R\\,u(-1) = g_R.\n$$\n您将使用谱配置方法，在 Chebyshev–Gauss–Lobatto (CGL) 节点上对问题进行离散化\n$$\nx_j = \\cos\\!\\left(\\frac{\\pi j}{N}\\right), \\quad j=0,1,\\dots,N,\n$$\n这些节点包括端点 $x_0=1$ 和 $x_N=-1$。设 $D \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 为这些节点上的切比雪夫一阶导数微分矩阵，并令 $D^{(2)} = D^2$ 表示二阶导数矩阵。为节点值向量 $\\mathbf{u} = \\big(u(x_0),\\dots,u(x_N)\\big)^\\top$ 构建线性系统：\n- 对于内部索引 $i=1,2,\\dots,N-1$，通过配置法施加常微分方程：\n$$\n\\left(-D^{(2)} + \\lambda I\\right)_{i,:}\\,\\mathbf{u} = f(x_i).\n$$\n- 在第一个和最后一个索引处，替换方程以施加离散形式的 Robin 条件：\n$$\n\\big(D_{0,:} + \\alpha_L\\,\\mathbf{e}_0^\\top\\big)\\,\\mathbf{u} = g_L, \\qquad \\big(D_{N,:} + \\alpha_R\\,\\mathbf{e}_N^\\top\\big)\\,\\mathbf{u} = g_R,\n$$\n其中 $\\mathbf{e}_0$ 和 $\\mathbf{e}_N$ 是 $\\mathbb{R}^{N+1}$ 中的标准基向量。\n\n为了使问题完全明确且可测试，我们根据一个选定的光滑精确解 $u_{\\text{exact}}$ 来定义 $f$、$g_L$ 和 $g_R$：\n$$\nf(x) = -u_{\\text{exact}}''(x) + \\lambda\\,u_{\\text{exact}}(x), \\quad g_L = u_{\\text{exact}}'(1) + \\alpha_L\\,u_{\\text{exact}}(1), \\quad g_R = u_{\\text{exact}}'(-1) + \\alpha_R\\,u_{\\text{exact}}(-1).\n$$\n对于每个测试用例，计算最大范数误差\n$$\nE_N = \\max_{0 \\le j \\le N} \\left|u_{\\text{num}}(x_j) - u_{\\text{exact}}(x_j)\\right|,\n$$\n对于若干个 $N$ 值，然后通过最小二乘法将 $\\log E_N$ 作为 $N$ 的函数拟合成一条直线来评估谱精度。具体来说，给定一组大小 $\\{N_k\\}$ 和相应的误差 $\\{E_{N_k}\\}$，计算使\n$$\n\\sum_k \\left(\\log E_{N_k} - (a + s\\,N_k)\\right)^2\n$$\n相对于 $a$ 和 $s$ 最小化的斜率 $s$，并报告这个拟合斜率 $s$。对于形如 $E_N \\approx C\\,\\rho^{-N}$（其中 $\\rho>1$）的指数（谱）收敛，我们预期 $\\log E_N \\approx \\log C - N \\log \\rho$，因此随着 $N$ 的增长，拟合斜率 $s \\approx -\\log \\rho$ 为负且有界地远离 0。\n\n请实现上述方法，并在以下三个测试用例上运行。在每个用例中，使用指定的精确解 $u_{\\text{exact}}$、参数 $(\\lambda,\\alpha_L,\\alpha_R)$以及 $N$ 值列表。\n\n- 测试用例 A (一般 Robin)：\n  - $u_{\\text{exact}}(x) = e^{x} + \\cos(3x)$,\n  - $\\lambda = 1$, $\\alpha_L = 0.7$, $\\alpha_R = 1.3$,\n  - $N \\in \\{16,24,32,40\\}$。\n\n- 测试用例 B (Robin 条件下 $\\alpha_L=\\alpha_R=0$ 时的 Neumann 极限)：\n  - $u_{\\text{exact}}(x) = \\sinh(2x) + \\sin(5x)$,\n  - $\\lambda = 1$, $\\alpha_L = 0$, $\\alpha_R = 0$,\n  - $N \\in \\{16,24,32,40\\}$。\n\n- 测试用例 C (更强的反应项和 Robin 条件)：\n  - $u_{\\text{exact}}(x) = \\cosh(x) + \\sin(2x)$,\n  - $\\lambda = 10$, $\\alpha_L = 5$, $\\alpha_R = 2$,\n  - $N \\in \\{16,32,48,64\\}$。\n\n您的程序必须：\n- 为每个 $N$ 构建 CGL 节点和切比雪夫微分矩阵 $D$，\n- 按照规定，通过替换第一个和最后一个方程来组装和求解带有 Robin 边界条件的配置系统，\n- 为每个测试用例中的每个 $N$ 计算 $E_N$，\n- 将 $\\log E_N$ 作为 $N$ 的函数进行最小二乘直线拟合，并返回每个测试用例的斜率 $s$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用逗号分隔的三个拟合斜率列表，按 A、B、C 的顺序排列，并用方括号括起来，例如 $[s_A,s_B,s_C]$。不使用角度，也无需报告物理单位。输出中的所有数值必须是纯十进制数。每个测试用例的答案必须是浮点数。因此，测试套件由上述三个用例组成，输出必须将它们的拟合斜率聚合到所要求的单行中。",
            "solution": "用户希望实现一个用于求解含 Robin 边界条件的一维线性边值问题的切比雪夫配置求解器。\n\n### 1. 问题验证\n\n在尝试任何解决方案之前，该问题都经过了严格的验证过程。\n\n#### 步骤 1：提取已知条件\n- **控制方程**：常微分方程 (ODE) 为 $-\\,u''(x) + \\lambda\\,u(x) = f(x)$，$x \\in [-1,1]$。\n- **边界条件 (BCs)**：在端点指定了 Robin 条件：\n  - $u'(1) + \\alpha_L\\,u(1) = g_L$\n  - $u'(-1) + \\alpha_R\\,u(-1) = g_R$\n- **离散化**：使用 $N+1$ 个 Chebyshev–Gauss–Lobatto (CGL) 节点对域进行离散化：$x_j = \\cos(\\frac{\\pi j}{N})$，$j=0,1,\\dots,N$。\n- **数值方法**：将使用谱配置方法。一阶导数算子由切比雪夫微分矩阵 $D$ 近似，二阶导数由 $D^{(2)} = D^2$ 近似。未知向量为 $\\mathbf{u}$，表示函数在 CGL 节点上的值。\n- **系统组装**：$\\mathbf{u}$ 的线性系统构建如下：\n  - 对于内部节点 ($i=1,\\dots,N-1$)，施加 ODE：$\\left(-D^{(2)} + \\lambda I\\right)_{i,:}\\,\\mathbf{u} = f(x_i)$。\n  - 替换第一个方程（行 $i=0$）以在 $x_0=1$ 处施加边界条件：$\\big(D_{0,:} + \\alpha_L\\,\\mathbf{e}_0^\\top\\big)\\,\\mathbf{u} = g_L$。\n  - 替换最后一个方程（行 $i=N$）以在 $x_N=-1$ 处施加边界条件：$\\big(D_{N,:} + \\alpha_R\\,\\mathbf{e}_N^\\top\\big)\\,\\mathbf{u} = g_R$。\n- **验证（人造解方法）**：源项 $f(x)$ 和边界数据 $g_L, g_R$ 基于选定的精确解 $u_{\\text{exact}}(x)$ 定义：\n  - $f(x) = -u_{\\text{exact}}''(x) + \\lambda\\,u_{\\text{exact}}(x)$\n  - $g_L = u_{\\text{exact}}'(1) + \\alpha_L\\,u_{\\text{exact}}(1)$\n  - $g_R = u_{\\text{exact}}'(-1) + \\alpha_R\\,u_{\\text{exact}}(-1)$\n- **误差分析**：对于给定序列 $\\{N_k\\}$ 中的每个 $N$，计算最大范数误差 $E_N = \\max_{j} |u_{\\text{num}}(x_j) - u_{\\text{exact}}(x_j)|$。\n- **收敛率**：通过找到拟合点 $(N_k, \\log E_{N_k})$ 的最小二乘直线的斜率 $s$ 来评估谱精度。\n- **测试用例**：提供了三个特定的测试用例（A、B、C），每个用例都有唯一的 $u_{\\text{exact}}(x)$、参数 $(\\lambda, \\alpha_L, \\alpha_R)$ 和一个 $N$ 值列表。\n\n#### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题是偏微分方程数值分析中的一个标准、典型的练习。使用切比雪夫多项式的谱配置方法是科学计算中的一个基础课题。该问题在数学上是合理的，并基于既定原则。\n- **适定性**：该问题是适定的。它描述了一个方形线性方程组的完整构造。对于给定的具有 Robin 边界条件的 Helmholtz 型方程（以及具体参数），连续问题存在唯一解。按所述实现的谱配置方法会产生一个非奇异的系统矩阵，从而确保唯一的数值解。\n- **客观性**：问题陈述具有数学精度。所有函数、参数和过程都得到了明确的定义。\n- **完整性和一致性**：问题是自洽的，并提供了构建求解器和运行测试所需的所有必要信息。人造解方法确保了一个一致的设置，其中精确解是通过构造得知的。边界条件的表示法（$x=1$ 处为 $L$，$x=-1$ 处为 $R$）虽然不常规，但已明确定义，必须遵守。\n- **可行性**：所需的计算，包括构建微分矩阵、求解线性系统和执行最小二乘拟合，都是标准且计算上可行的。\n\n#### 步骤 3：结论和行动\n问题是有效的。将提供完整的解决方案。\n\n### 2. 求解方法\n\n解决方案涉及按所述实现切比雪夫配置方法。每个测试用例的总体流程如下：\n\n1.  **遍历 $N$ 值**：对于测试用例中指定的每个多项式阶数 $N$，计算一个数值解。\n2.  **构建切比雪夫网格和微分矩阵**：对于给定的 $N$，生成 $N+1$ 个 CGL 节点 $x_j$。使用标准的、数值稳定的公式构建相应的一阶导数矩阵 $D$（大小为 $(N+1) \\times (N+1)$）。然后计算二阶导数矩阵 $D^{(2)} = D^2$。\n3.  **组装线性系统**：组装一个 $(N+1) \\times (N+1)$ 的矩阵 $A$ 和一个大小为 $N+1$ 的向量 $\\mathbf{b}$。\n    -   最初，矩阵 $A$ 设置为 $-D^{(2)} + \\lambda I$，代表所有节点上的微分算子。\n    -   向量 $\\mathbf{b}$ 由源函数在节点上的评价值 $f(x_j) = -u_{\\text{exact}}''(x_j) + \\lambda u_{\\text{exact}}(x_j)$ 填充。\n    -   $A$ 和 $\\mathbf{b}$ 的第一行（$j=0$，对应于 $x_0=1$）被替换，以在 $x=1$ 处施加 Robin 条件。新行源自边界算子的离散形式 $D_{0,:} + \\alpha_L \\mathbf{e}_0^\\top$。这意味着 $A$ 的第一行变为 $D$ 的第一行，并在对角元素 $A_{0,0}$ 上加上 $\\alpha_L$。$\\mathbf{b}$ 的第一个元素设置为 $g_L = u_{\\text{exact}}'(1) + \\alpha_L u_{\\text{exact}}(1)$。\n    -   类似地，最后一行（$j=N$，对应于 $x_N=-1$）被替换，以在 $x=-1$ 处施加条件。$A$ 的最后一行变为 $D$ 的最后一行，并在对角元素 $A_{N,N}$ 上加上 $\\alpha_R$。$\\mathbf{b}$ 的最后一个元素设置为 $g_R = u_{\\text{exact}}'(-1) + \\alpha_R u_{\\text{exact}}(-1)$。\n4.  **求解并计算误差**：求解线性系统 $A\\mathbf{u} = \\mathbf{b}$，得到数值解向量 $\\mathbf{u}$。计算数值解与节点上精确解值之间的最大绝对误差 $E_N$。\n5.  **评估收敛性**：在为所有指定的 $\\{N_k\\}$ 计算出误差 $\\{E_{N_k}\\}$ 后，取误差的自然对数 $\\{\\log E_{N_k}\\}$。对点 $(N_k, \\log E_{N_k})$ 进行线性回归，以找到最佳拟合直线。该直线的斜率 $s$ 是指数收敛率的度量。这个斜率是该测试用例的最终结果。\n\n对所有三个测试用例重复此过程，并收集得到的斜率。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a Chebyshev collocation solver for a 1D linear BVP with Robin boundary conditions,\n    and assesses its spectral accuracy.\n    \"\"\"\n\n    def chebyshev_cgl(N):\n        \"\"\"\n        Computes the Chebyshev-Gauss-Lobatto (CGL) nodes and the \n        first-derivative differentiation matrix.\n        \n        Args:\n            N (int): The polynomial degree. Number of nodes is N+1.\n            \n        Returns:\n            tuple: A tuple containing:\n                - x (np.ndarray): The N+1 CGL nodes.\n                - D (np.ndarray): The (N+1)x(N+1) differentiation matrix.\n        \"\"\"\n        if N == 0:\n            return np.array([0.0]), np.array([[0.0]])\n        \n        # CGL nodes\n        j = np.arange(N + 1)\n        x = np.cos(np.pi * j / N)\n        \n        # Assemble differentiation matrix D\n        c = np.ones(N + 1)\n        c[0] = 2.0\n        c[N] = 2.0\n        \n        # Off-diagonal entries\n        X = np.tile(x, (N + 1, 1))\n        dX = X - X.T\n        \n        # Formula: D_ij = c_i/c_j * (-1)^(i+j) / (x_i - x_j) for i != j\n        # We combine c_i and (-1)^i terms for a compact form\n        c_i_term = c * (-1)**j\n        D = (c_i_term[:, None] / c_i_term[None, :]) / (dX + np.eye(N + 1))\n        \n        # Diagonal entries (using the sum-to-zero property for stability)\n        D -= np.diag(np.sum(D, axis=1))\n        \n        return x, D\n\n    def compute_slope(u_exact, u_prime, u_double_prime, lambda_val, alpha_L, alpha_R, N_vals):\n        \"\"\"\n        Solves the BVP for a range of N, computes errors, and fits a line\n        to (N, log(error)) to find the convergence rate (slope).\n        \"\"\"\n        errors = []\n        for N in N_vals:\n            # Get nodes and differentiation matrices\n            x, D = chebyshev_cgl(N)\n            D2 = D @ D\n\n            # Assemble system matrix A and RHS vector b\n            # Start with the interior equation operator everywhere\n            A = -D2 + lambda_val * np.eye(N + 1)\n            f_vals = -u_double_prime(x) + lambda_val * u_exact(x)\n            b = f_vals.copy()\n\n            # Enforce boundary conditions by replacing rows\n            # Boundary at x = 1 (node j=0)\n            A[0, :] = D[0, :]\n            A[0, 0] += alpha_L\n            g_L = u_prime(1.0) + alpha_L * u_exact(1.0)\n            b[0] = g_L\n\n            # Boundary at x = -1 (node j=N)\n            A[-1, :] = D[-1, :]\n            A[-1, -1] += alpha_R\n            g_R = u_prime(-1.0) + alpha_R * u_exact(-1.0)\n            b[-1] = g_R\n            \n            # Solve the linear system\n            u_num = np.linalg.solve(A, b)\n            \n            # Compute the maximum norm error\n            u_ex_vals = u_exact(x)\n            error = np.max(np.abs(u_num - u_ex_vals))\n            errors.append(error)\n            \n        # Perform least-squares fit on log(error) vs N\n        log_errors = np.log(errors)\n        coeffs = np.polyfit(N_vals, log_errors, 1)\n        slope = coeffs[0]\n        \n        return slope\n\n    test_cases = [\n        # Test Case A\n        {\n            'u_exact': lambda x: np.exp(x) + np.cos(3 * x),\n            'u_prime': lambda x: np.exp(x) - 3 * np.sin(3 * x),\n            'u_double_prime': lambda x: np.exp(x) - 9 * np.cos(3 * x),\n            'lambda_val': 1.0, 'alpha_L': 0.7, 'alpha_R': 1.3,\n            'N_vals': [16, 24, 32, 40]\n        },\n        # Test Case B\n        {\n            'u_exact': lambda x: np.sinh(2 * x) + np.sin(5 * x),\n            'u_prime': lambda x: 2 * np.cosh(2 * x) + 5 * np.cos(5 * x),\n            'u_double_prime': lambda x: 4 * np.sinh(2 * x) - 25 * np.sin(5 * x),\n            'lambda_val': 1.0, 'alpha_L': 0.0, 'alpha_R': 0.0,\n            'N_vals': [16, 24, 32, 40]\n        },\n        # Test Case C\n        {\n            'u_exact': lambda x: np.cosh(x) + np.sin(2 * x),\n            'u_prime': lambda x: np.sinh(x) + 2 * np.cos(2 * x),\n            'u_double_prime': lambda x: np.cosh(x) - 4 * np.sin(2 * x),\n            'lambda_val': 10.0, 'alpha_L': 5.0, 'alpha_R': 2.0,\n            'N_vals': [16, 32, 48, 64]\n        }\n    ]\n\n    slopes = []\n    for case in test_cases:\n        slope = compute_slope(\n            u_exact=case['u_exact'],\n            u_prime=case['u_prime'],\n            u_double_prime=case['u_double_prime'],\n            lambda_val=case['lambda_val'],\n            alpha_L=case['alpha_L'],\n            alpha_R=case['alpha_R'],\n            N_vals=case['N_vals']\n        )\n        slopes.append(slope)\n        \n    print(f\"[{','.join(map(str, slopes))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后的这项实践将视角从强施加法转向弱形式，后者是有限元法（FEM）等现代数值方法的核心。您将深入探索在弯曲边界上如何以弱形式处理诺伊曼和罗宾条件，并推导法向量和坐标变换雅可比（Jacobian）等几何因素如何影响边界积分的计算。这项高级练习揭示了在复杂几何模型中准确应用边界条件所需的关键理论和实用技术。",
            "id": "3379337",
            "problem": "考虑一个二维域中的标量泊松问题 $-\\nabla \\cdot (\\nabla u) = f$，该域包含一个作为等参谱元一部分的弯曲边界段。设该边界段是参考边参数 $\\xi \\in [-1,1]$ 在映射 $\\boldsymbol{x}(\\xi) = (x(\\xi), y(\\xi))$ 下的像，该映射定义为 $x(\\xi) = \\xi$ 和 $y(\\xi) = 1 + \\varepsilon \\, P_{2}(\\xi)$，其中 $P_{2}(\\xi) = \\frac{3 \\xi^{2} - 1}{2}$ 是 2 次 Legendre 多项式。该单元是等参的，意味着几何形状和解的近似共享相同的多项式阶数。设单位外法向量定义为 $\\boldsymbol{n}(\\xi) = \\frac{(-y'(\\xi), x'(\\xi))}{\\sqrt{(x'(\\xi))^{2} + (y'(\\xi))^{2}}}$，其中 $\\boldsymbol{t}(\\xi) = (x'(\\xi), y'(\\xi))$ 是切向量，边界线元为 $ds = \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi$。在边界上取单个测试函数等于 $v(\\xi) = P_{2}(\\xi)$。\n\n从变分形式 $\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega - \\int_{\\partial \\Omega} v \\, \\boldsymbol{n} \\cdot \\nabla u \\, ds = \\int_{\\Omega} f v \\, d\\Omega$ 以及等参映射和单位外法向量的定义出发，推导在弯曲段 $\\Gamma$ 上的弱诺伊曼边界贡献项的参数表达式（用几何导数 $x'(\\xi)$ 和 $y'(\\xi)$ 表示），并展示边界雅可比和法向量如何结合。然后，对于 $\\Gamma$ 上的罗宾边界条件 $\\boldsymbol{n} \\cdot \\nabla u + \\alpha u = r$，推导在变分形式中替代 $-\\int_{\\Gamma} v \\, \\boldsymbol{n} \\cdot \\nabla u \\, ds$ 的净弱边界贡献项。使用以下特定数据来获得闭式值：\n- 选择 $\\varepsilon = \\frac{1}{3}$，使得 $y'(\\xi) = \\xi$ 且因此 $\\|\\boldsymbol{t}(\\xi)\\| = \\sqrt{1 + \\xi^{2}}$。\n- 设精确解为 $u(x,y) = x^{2} + y^{3}$，因此 $\\nabla u = (2x, 3y^{2})$。\n- 对于诺伊曼条件，设 $g(\\xi) := \\boldsymbol{n}(\\xi) \\cdot \\nabla u(\\boldsymbol{x}(\\xi))$ 并计算 $\\Gamma$ 上的弱边界贡献项 $I_{N} := \\int_{-1}^{1} v(\\xi) \\, g(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi$。\n- 对于罗宾条件，取常数 $\\alpha = 2$ 并定义 $r(\\xi) := \\boldsymbol{n}(\\xi) \\cdot \\nabla u(\\boldsymbol{x}(\\xi)) + \\alpha \\, u(\\boldsymbol{x}(\\xi))$。计算净弱边界贡献项 $I_{R} := \\left(\\int_{-1}^{1} \\alpha \\, u(\\boldsymbol{x}(\\xi)) \\, v(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi\\right) - \\left(\\int_{-1}^{1} r(\\xi) \\, v(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi\\right)$。\n\n将最终数值 $I_{N}$ 和 $I_{R}$ 精确表示（不进行四舍五入）。以 $1 \\times 2$ 行矩阵 $\\begin{pmatrix} I_{N}  I_{R} \\end{pmatrix}$ 的形式提供您的最终答案。",
            "solution": "问题陈述经过验证。\n\n### 第 1 步：提取已知条件\n- **问题**：二维域 $\\Omega$ 中的标量泊松问题 $-\\nabla \\cdot (\\nabla u) = f$。\n- **边界映射**：弯曲边界段 $\\Gamma$ 是 $\\xi \\in [-1,1]$ 在映射 $\\boldsymbol{x}(\\xi) = (x(\\xi), y(\\xi))$ 下的像，其中 $x(\\xi) = \\xi$ 且 $y(\\xi) = 1 + \\varepsilon \\, P_{2}(\\xi)$。\n- **多项式**：$P_{2}(\\xi) = \\frac{3 \\xi^{2} - 1}{2}$ 是 2 次 Legendre 多项式。\n- **几何**：单位外法向量是 $\\boldsymbol{n}(\\xi) = \\frac{(-y'(\\xi), x'(\\xi))}{\\sqrt{(x'(\\xi))^{2} + (y'(\\xi))^{2}}}$，切向量是 $\\boldsymbol{t}(\\xi) = (x'(\\xi), y'(\\xi))$，边界线元是 $ds = \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi$。\n- **测试函数**：边界上的测试函数为 $v(\\xi) = P_{2}(\\xi)$。\n- **变分形式**：$\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega - \\int_{\\partial \\Omega} v \\, \\boldsymbol{n} \\cdot \\nabla u \\, ds = \\int_{\\Omega} f v \\, d\\Omega$。\n- **罗宾条件**：$\\Gamma$ 上的 $\\boldsymbol{n} \\cdot \\nabla u + \\alpha u = r$。\n- **特定数据**：\n    - $\\varepsilon = \\frac{1}{3}$。\n    - 题目声明这可推得 $y'(\\xi) = \\xi$ 和 $\\|\\boldsymbol{t}(\\xi)\\| = \\sqrt{1 + \\xi^{2}}$。\n    - 精确解：$u(x,y) = x^{2} + y^{3}$，其梯度 $\\nabla u = (2x, 3y^{2})$。\n- **待计算量**：\n    - 对于诺伊曼条件，$g(\\xi) := \\boldsymbol{n}(\\xi) \\cdot \\nabla u(\\boldsymbol{x}(\\xi))$。计算 $I_{N} := \\int_{-1}^{1} v(\\xi) \\, g(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi$。\n    - 对于罗宾条件，$\\alpha = 2$ 且 $r(\\xi) := \\boldsymbol{n}(\\xi) \\cdot \\nabla u(\\boldsymbol{x}(\\xi)) + \\alpha \\, u(\\boldsymbol{x}(\\xi))$。计算 $I_{R} := \\left(\\int_{-1}^{1} \\alpha \\, u(\\boldsymbol{x}(\\xi)) \\, v(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi\\right) - \\left(\\int_{-1}^{1} r(\\xi) \\, v(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi\\right)$。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题设置在求解偏微分方程的成熟数学框架内，即有限元方法（特别是等参谱元）和向量微积分。所有使用的概念在这些领域都是标准的。\n2.  **适定性**：该问题是适定的。它提供了计算所要求量所需的所有函数、参数和定义。任务定义清晰。\n3.  **客观性**：语言精确且数学化。所有术语都有形式化定义。没有主观或基于观点的陈述。\n4.  **完整性与一致性**：问题是自洽的。所提供的数据是一致的。例如，当 $\\varepsilon = \\frac{1}{3}$ 时，$y(\\xi) = 1 + \\frac{1}{3} \\frac{3\\xi^2-1}{2} = 1 + \\frac{\\xi^2}{2} - \\frac{1}{6} = \\frac{5}{6} + \\frac{1}{2}\\xi^2$。求导得到 $y'(\\xi) = \\xi$。然后 $\\|\\boldsymbol{t}(\\xi)\\| = \\sqrt{(x'(\\xi))^2 + (y'(\\xi))^2} = \\sqrt{1^2 + \\xi^2} = \\sqrt{1+\\xi^2}$。数据是内部一致的。\n\n### 第 3 步：结论与行动\n问题是有效的。这是一个标准的谱元方法应用练习，尽管计算量较大。将提供解答。\n\n***\n\n### 解答\n该问题要求推导弱边界项，并针对涉及等参单元的特定情况进行计算。\n\n**1. 弱诺伊曼边界贡献项的参数表达式**\n\n变分形式中的弱诺伊曼边界贡献项是 $-\\int_{\\Gamma} v \\, \\boldsymbol{n} \\cdot \\nabla u \\, ds$。边界段 $\\Gamma$ 由 $\\xi \\in [-1, 1]$ 参数化。我们代入给定的等参定义：\n- 边界上的测试函数为 $v(\\boldsymbol{x}(\\xi)) = v(\\xi)$。\n- 微分线元为 $ds = \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi$，其中 $\\|\\boldsymbol{t}(\\xi)\\| = \\sqrt{(x'(\\xi))^2 + (y'(\\xi))^2}$ 是边界雅可比。\n- 单位外法向量为 $\\boldsymbol{n}(\\xi) = \\frac{(-y'(\\xi), x'(\\xi))}{\\|\\boldsymbol{t}(\\xi)\\|}$。\n\n将这些代入积分可得：\n$$\n-\\int_{\\Gamma} v \\, \\boldsymbol{n} \\cdot \\nabla u \\, ds = -\\int_{-1}^{1} v(\\xi) \\left( \\frac{(-y'(\\xi), x'(\\xi))}{\\|\\boldsymbol{t}(\\xi)\\|} \\cdot \\nabla u(\\boldsymbol{x}(\\xi)) \\right) \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi\n$$\n测度 $ds$ 中的边界雅可比 $\\|\\boldsymbol{t}(\\xi)\\|$ 与单位法向量 $\\boldsymbol{n}(\\xi)$ 定义中的归一化因子相消。这就是边界雅可比与法向量的结合。该表达式简化为：\n$$\n-\\int_{\\Gamma} v \\, \\boldsymbol{n} \\cdot \\nabla u \\, ds = -\\int_{-1}^{1} v(\\xi) \\left( -y'(\\xi) \\frac{\\partial u}{\\partial x}(\\boldsymbol{x}(\\xi)) + x'(\\xi) \\frac{\\partial u}{\\partial y}(\\boldsymbol{x}(\\xi)) \\right) d\\xi\n$$\n这是弱诺伊曼边界贡献项的参数表达式。\n\n**2. 罗宾边界条件的净弱贡献项**\n\n对于罗宾边界条件 $\\boldsymbol{n} \\cdot \\nabla u + \\alpha u = r$，我们可以将通量表示为 $\\boldsymbol{n} \\cdot \\nabla u = r - \\alpha u$。我们将其代入弱诺伊曼项：\n$$\n-\\int_{\\Gamma} v \\, \\boldsymbol{n} \\cdot \\nabla u \\, ds = -\\int_{\\Gamma} v (r - \\alpha u) \\, ds = \\int_{\\Gamma} \\alpha u v \\, ds - \\int_{\\Gamma} r v \\, ds\n$$\n这就是替换原始项的净弱边界贡献项。其参数形式为：\n$$\n\\int_{-1}^{1} \\alpha \\, u(\\boldsymbol{x}(\\xi)) \\, v(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi - \\int_{-1}^{1} r(\\xi) \\, v(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi\n$$\n\n**3. 诺伊曼积分 $I_N$ 的计算**\n\n问题定义了 $I_N := \\int_{-1}^{1} v(\\xi) \\, g(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi$，其中 $g(\\xi) = \\boldsymbol{n}(\\xi) \\cdot \\nabla u(\\boldsymbol{x}(\\xi))$。根据我们之前的分析，这等于：\n$$\nI_N = \\int_{-1}^{1} v(\\xi) \\left( -y'(\\xi) \\frac{\\partial u}{\\partial x}(\\boldsymbol{x}(\\xi)) + x'(\\xi) \\frac{\\partial u}{\\partial y}(\\boldsymbol{x}(\\xi)) \\right) d\\xi\n$$\n我们使用所提供的特定数据：\n- $v(\\xi) = P_{2}(\\xi) = \\frac{3\\xi^2 - 1}{2}$。\n- $x(\\xi) = \\xi$，所以 $x'(\\xi) = 1$。\n- 当 $\\varepsilon = \\frac{1}{3}$ 时，$y(\\xi) = 1 + \\frac{1}{3}P_2(\\xi) = 1 + \\frac{1}{3}\\left(\\frac{3\\xi^2 - 1}{2}\\right) = \\frac{5}{6} + \\frac{1}{2}\\xi^2$，所以 $y'(\\xi) = \\xi$。\n- $u(x,y) = x^2 + y^3$，所以 $\\nabla u = (2x, 3y^2)$。\n- 在边界上求值：$\\frac{\\partial u}{\\partial x}(\\boldsymbol{x}(\\xi)) = 2x(\\xi) = 2\\xi$ 且 $\\frac{\\partial u}{\\partial y}(\\boldsymbol{x}(\\xi)) = 3(y(\\xi))^2 = 3\\left(\\frac{5}{6} + \\frac{1}{2}\\xi^2\\right)^2$。\n\n$I_N$ 的被积函数是 $v(\\xi)$ 与括号中项的乘积：\n$$\n\\text{Integrand} = \\left(\\frac{3\\xi^2 - 1}{2}\\right) \\left[ -(\\xi)(2\\xi) + (1) \\cdot 3\\left(\\frac{5}{6} + \\frac{1}{2}\\xi^2\\right)^2 \\right]\n$$\n让我们简化第二个因子：\n$$\n-2\\xi^2 + 3\\left( \\frac{25}{36} + \\frac{10}{12}\\xi^2 + \\frac{1}{4}\\xi^4 \\right) = -2\\xi^2 + \\frac{25}{12} + \\frac{5}{2}\\xi^2 + \\frac{3}{4}\\xi^4 = \\frac{3}{4}\\xi^4 + \\frac{1}{2}\\xi^2 + \\frac{25}{12}\n$$\n现在乘以 $v(\\xi)$：\n$$\n\\text{Integrand} = \\frac{1}{2}(3\\xi^2 - 1) \\left(\\frac{3}{4}\\xi^4 + \\frac{1}{2}\\xi^2 + \\frac{25}{12}\\right)\n$$\n$$\n= \\frac{1}{2} \\left[ 3\\xi^2\\left(\\frac{3}{4}\\xi^4 + \\frac{1}{2}\\xi^2 + \\frac{25}{12}\\right) - \\left(\\frac{3}{4}\\xi^4 + \\frac{1}{2}\\xi^2 + \\frac{25}{12}\\right) \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ \\left(\\frac{9}{4}\\xi^6 + \\frac{3}{2}\\xi^4 + \\frac{25}{4}\\xi^2\\right) - \\frac{3}{4}\\xi^4 - \\frac{1}{2}\\xi^2 - \\frac{25}{12} \\right]\n$$\n$$\n= \\frac{1}{2} \\left[ \\frac{9}{4}\\xi^6 + \\left(\\frac{3}{2} - \\frac{3}{4}\\right)\\xi^4 + \\left(\\frac{25}{4} - \\frac{1}{2}\\right)\\xi^2 - \\frac{25}{12} \\right] = \\frac{1}{2} \\left[ \\frac{9}{4}\\xi^6 + \\frac{3}{4}\\xi^4 + \\frac{23}{4}\\xi^2 - \\frac{25}{12} \\right]\n$$\n被积函数是一个偶函数，所以 $\\int_{-1}^{1} f(\\xi) d\\xi = 2 \\int_{0}^{1} f(\\xi) d\\xi$：\n$$\nI_N = \\int_{0}^{1} \\left( \\frac{9}{4}\\xi^6 + \\frac{3}{4}\\xi^4 + \\frac{23}{4}\\xi^2 - \\frac{25}{12} \\right) d\\xi\n$$\n$$\n= \\left[ \\frac{9}{4} \\frac{\\xi^7}{7} + \\frac{3}{4} \\frac{\\xi^5}{5} + \\frac{23}{4} \\frac{\\xi^3}{3} - \\frac{25}{12}\\xi \\right]_{0}^{1} = \\frac{9}{28} + \\frac{3}{20} + \\frac{23}{12} - \\frac{25}{12}\n$$\n$$\n= \\frac{9}{28} + \\frac{3}{20} - \\frac{2}{12} = \\frac{9}{28} + \\frac{3}{20} - \\frac{1}{6}\n$$\n$28$、$20$ 和 $6$ 的最小公倍数是 $420$。\n$$\nI_N = \\frac{9 \\cdot 15}{420} + \\frac{3 \\cdot 21}{420} - \\frac{1 \\cdot 70}{420} = \\frac{135 + 63 - 70}{420} = \\frac{198 - 70}{420} = \\frac{128}{420} = \\frac{32}{105}\n$$\n\n**4. 罗宾积分 $I_R$ 的计算**\n\n问题将 $I_R$ 定义为：\n$$\nI_{R} := \\left(\\int_{-1}^{1} \\alpha \\, u(\\boldsymbol{x}(\\xi)) \\, v(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi\\right) - \\left(\\int_{-1}^{1} r(\\xi) \\, v(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi\\right)\n$$\n它还使用给定的精确解 $u$ 定义了 $r(\\xi)$：\n$$\nr(\\xi) := \\boldsymbol{n}(\\xi) \\cdot \\nabla u(\\boldsymbol{x}(\\xi)) + \\alpha \\, u(\\boldsymbol{x}(\\xi))\n$$\n让我们将 $r(\\xi)$ 的这个定义代入 $I_R$ 的表达式中：\n$$\nI_R = \\int_{-1}^{1} \\alpha \\, u \\, v \\, \\|\\boldsymbol{t}\\| \\, d\\xi - \\int_{-1}^{1} (\\boldsymbol{n} \\cdot \\nabla u + \\alpha \\, u) \\, v \\, \\|\\boldsymbol{t}\\| \\, d\\xi\n$$\n我们可以合并积分：\n$$\nI_R = \\int_{-1}^{1} \\left[ \\alpha \\, u \\, v - (\\boldsymbol{n} \\cdot \\nabla u + \\alpha \\, u)v \\right] \\|\\boldsymbol{t}\\| \\, d\\xi\n$$\n$$\nI_R = \\int_{-1}^{1} \\left[ \\alpha u v - (\\boldsymbol{n} \\cdot \\nabla u)v - \\alpha u v \\right] \\|\\boldsymbol{t}\\| \\, d\\xi\n$$\n包含 $\\alpha u v$ 的项相消：\n$$\nI_R = -\\int_{-1}^{1} (\\boldsymbol{n} \\cdot \\nabla u) \\, v \\, \\|\\boldsymbol{t}\\| \\, d\\xi\n$$\n回顾定义 $g(\\xi) = \\boldsymbol{n}(\\xi) \\cdot \\nabla u(\\boldsymbol{x}(\\xi))$，这等于：\n$$\nI_R = -\\int_{-1}^{1} g(\\xi) \\, v(\\xi) \\, \\|\\boldsymbol{t}(\\xi)\\| \\, d\\xi\n$$\n这恰好是 $I_N$ 定义的负值。\n$$\nI_R = -I_N\n$$\n因此，使用为 $I_N$ 计算出的值：\n$$\nI_R = -\\frac{32}{105}\n$$\n最终答案需要 $I_N$ 和 $I_R$ 的值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{32}{105}  -\\frac{32}{105} \\end{pmatrix}}\n$$"
        }
    ]
}