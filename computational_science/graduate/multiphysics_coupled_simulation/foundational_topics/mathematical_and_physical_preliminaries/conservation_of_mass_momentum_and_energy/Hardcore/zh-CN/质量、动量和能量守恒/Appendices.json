{
    "hands_on_practices": [
        {
            "introduction": "在许多物理和工程领域，激波等间断流动是核心研究对象。本练习将指导您从质量、动量和能量守恒三大基本定律出发，推导出描述理想气体中正激波前后状态变化的朗金-雨贡纽（Rankine-Hugoniot）关系。通过这个经典的解析推导，您将深入理解如何将积分形式的守恒定律应用于流场中的不连续面，这是计算流体动力学和气体动力学的一项基本功。",
            "id": "3521200",
            "problem": "考虑一个绝热指数为 $\\gamma$ 的可压缩理想气体中的一维、平面、定常激波，该激波由守恒形式的可压缩欧拉方程建模。激波远左侧的上游状态是均匀的，其压强为 $p_1$，密度为 $\\rho_1$，速度为 $u_1$，方向指向激波。上游马赫数定义为 $M_1 = u_1 / c_1$，其中上游声速为 $c_1 = \\sqrt{\\gamma p_1 / \\rho_1}$。假设在所选参考系中激波是定常的，并且气体满足理想气体状态方程。\n\n从跨越定常间断面的质量、动量和能量守恒定律（朗金-雨贡纽条件，RH）出发，并仅使用理想气体状态方程和马赫数的定义，推导下游压强 $p_2$、速度 $u_2$ 和密度 $\\rho_2$ 关于 $p_1$、$u_1$、$\\rho_1$、$M_1$ 和 $\\gamma$ 的闭式表达式。在推导过程中请明确说明您使用的任何物理允许条件。不要假设跨越激波的流动是等熵的。\n\n将您的最终答案表示为仅依赖于 $(p_1, u_1, \\rho_1, M_1, \\gamma)$ 的 $(p_2, u_2, \\rho_2)$ 的解析表达式。无需进行数值计算，也无需四舍五入。答案必须以单行矩阵的形式给出，按顺序包含 $p_2$、$u_2$ 和 $\\rho_2$。",
            "solution": "问题陈述已经过验证，被认为是有效的。这是一个来自气体动力学领域的适定的、有科学依据的问题，气体动力学是计算天体物理学的核心组成部分。该问题是自洽的，并提供了推导所需表达式的所有必要信息。\n\n推导始于朗金-雨贡纽（Rankine-Hugoniot）条件，该条件表示了跨越一个定常、一维激波波前的质量、动量和能量守恒。在激波静止的参考系中，这些条件是：\n1. 质量守恒：\n$$ \\rho_1 u_1 = \\rho_2 u_2 \\quad (1) $$\n2. 动量守恒：\n$$ p_1 + \\rho_1 u_1^2 = p_2 + \\rho_2 u_2^2 \\quad (2) $$\n3. 能量守恒：\n$$ \\rho_1 u_1 \\left( e_1 + \\frac{p_1}{\\rho_1} + \\frac{1}{2}u_1^2 \\right) = \\rho_2 u_2 \\left( e_2 + \\frac{p_2}{\\rho_2} + \\frac{1}{2}u_2^2 \\right) \\quad (3) $$\n其中 $\\rho$、$u$、$p$ 和 $e$ 分别是密度、速度、压强和比内能。下标 $1$ 和 $2$ 分别表示上游（波前）和下游（波后）的状态。\n\n使用质量守恒方程 $(1)$，能量方程 $(3)$ 可以简化为比总焓守恒：\n$$ h_1 + \\frac{1}{2}u_1^2 = h_2 + \\frac{1}{2}u_2^2 \\quad (4) $$\n其中 $h = e + p/\\rho$ 是比焓。\n\n对于理想气体，比内能为 $e = \\frac{p}{(\\gamma-1)\\rho}$，其中 $\\gamma$ 是绝热指数。因此比焓为：\n$$ h = \\frac{p}{(\\gamma-1)\\rho} + \\frac{p}{\\rho} = \\frac{\\gamma p}{(\\gamma-1)\\rho} $$\n\n为了关联激波两侧的热力学状态，我们首先对守恒定律进行变换。令恒定的质量通量为 $J = \\rho_1 u_1 = \\rho_2 u_2$。\n从 $(1)$，可得 $u_2 = u_1 (\\rho_1/\\rho_2)$。\n从 $(2)$，压强差为 $p_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 u_2^2 = J u_1 - J u_2 = J(u_1 - u_2)$。\n同样从 $(2)$，可得 $p_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 (\\frac{\\rho_1 u_1}{\\rho_2})^2 = \\rho_1 u_1^2 - \\frac{(\\rho_1 u_1)^2}{\\rho_2} = (\\rho_1 u_1)^2 (\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2}) = J^2 (\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2})$。\n\n从 $(4)$ 可知，比焓的变化是 $h_2 - h_1 = \\frac{1}{2}(u_1^2 - u_2^2) = \\frac{1}{2}(u_1 - u_2)(u_1 + u_2)$。\n代入 $u_1 = J/\\rho_1$ 和 $u_2 = J/\\rho_2$，我们有 $u_1 - u_2 = J(\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2})$ 和 $u_1 + u_2 = J(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2})$。\n因此，$h_2 - h_1 = \\frac{1}{2} J^2 (\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2})(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2})$。\n代入 $J^2(\\frac{1}{\\rho_1} - \\frac{1}{\\rho_2}) = p_2 - p_1$，我们得到热力学变量的朗金-雨贡纽关系：\n$$ h_2 - h_1 = \\frac{1}{2} (p_2 - p_1)\\left(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2}\\right) $$\n代入理想气体焓 $h = \\frac{\\gamma p}{(\\gamma-1)\\rho}$：\n$$ \\frac{\\gamma}{\\gamma-1}\\left(\\frac{p_2}{\\rho_2} - \\frac{p_1}{\\rho_1}\\right) = \\frac{1}{2}(p_2 - p_1)\\left(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_2}\\right) $$\n为了找到密度比 $\\rho_2/\\rho_1$ 和压强比 $p_2/p_1$ 之间的关系，我们重新整理这个方程。令 $Y = p_2/p_1$ 和 $X = \\rho_2/\\rho_1$。\n$$ \\frac{\\gamma}{\\gamma-1}\\left(\\frac{p_1 Y}{\\rho_1 X} - \\frac{p_1}{\\rho_1}\\right) = \\frac{1}{2}(p_1 Y - p_1)\\left(\\frac{1}{\\rho_1} + \\frac{1}{\\rho_1 X}\\right) $$\n除以 $p_1/\\rho_1$，我们得到：\n$$ \\frac{\\gamma}{\\gamma-1}\\left(\\frac{Y}{X} - 1\\right) = \\frac{1}{2}(Y-1)\\left(1 + \\frac{1}{X}\\right) $$\n$$ \\frac{2\\gamma}{\\gamma-1}\\frac{Y-X}{X} = (Y-1)\\frac{X+1}{X} $$\n$$ 2\\gamma(Y-X) = (\\gamma-1)(Y-1)(X+1) $$\n求解 $X$ 关于 $Y$ 的表达式：\n$$ 2\\gamma Y - 2\\gamma X = (\\gamma-1)(YX + Y - X - 1) $$\n$$ X[-2\\gamma - (\\gamma-1)Y + (\\gamma-1)] = -2\\gamma Y + (\\gamma-1)Y - (\\gamma-1) $$\n$$ X[-(\\gamma+1) - (\\gamma-1)Y] = -(\\gamma+1)Y - (\\gamma-1) $$\n$$ X[(\\gamma-1)Y + (\\gamma+1)] = (\\gamma+1)Y + (\\gamma-1) $$\n这就得到了用压强比表示的密度比的表达式：\n$$ \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)}{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)} \\quad (5) $$\n接下来，我们将压强比与上游马赫数 $M_1 = u_1/c_1$ 联系起来，其中 $c_1^2 = \\gamma p_1 / \\rho_1$。从动量方程 $(2)$ 可得：\n$$ p_2 - p_1 = \\rho_1 u_1^2 - \\rho_2 u_2^2 = \\rho_1 u_1^2 \\left(1 - \\frac{\\rho_2 u_2^2}{\\rho_1 u_1^2}\\right) $$\n使用 $\\rho_1 u_1 = \\rho_2 u_2$，我们可以写出 $\\frac{\\rho_2 u_2^2}{\\rho_1 u_1^2} = \\frac{(\\rho_2 u_2)u_2}{(\\rho_1 u_1)u_1} = \\frac{u_2}{u_1} = \\frac{\\rho_1}{\\rho_2}$。\n$$ p_2 - p_1 = \\rho_1 u_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) $$\n除以 $p_1$：\n$$ \\frac{p_2}{p_1} - 1 = \\frac{\\rho_1 u_1^2}{p_1} \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) $$\n项 $\\frac{\\rho_1 u_1^2}{p_1}$ 可以使用 $M_1$ 和 $c_1$ 的定义重写：\n$$ \\frac{\\rho_1 u_1^2}{p_1} = \\frac{\\gamma \\rho_1 u_1^2}{\\gamma p_1} = \\gamma \\frac{u_1^2}{c_1^2} = \\gamma M_1^2 $$\n所以，我们有：\n$$ \\frac{p_2}{p_1} - 1 = \\gamma M_1^2 \\left(1 - \\frac{\\rho_1}{\\rho_2}\\right) \\quad (6) $$\n现在我们求解方程组 $(5)$ 和 $(6)$，得到 $p_2/p_1$ 和 $\\rho_2/\\rho_1$。从 $(6)$ 中，我们表达出 $\\rho_1/\\rho_2$ 并将其代入 $(5)$ 的倒数形式：\n$$ \\frac{\\rho_1}{\\rho_2} = \\frac{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)}{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)} $$\n$$ 1 - \\frac{1}{\\gamma M_1^2}\\left(\\frac{p_2}{p_1} - 1\\right) = \\frac{(\\gamma-1)\\frac{p_2}{p_1} + (\\gamma+1)}{(\\gamma+1)\\frac{p_2}{p_1} + (\\gamma-1)} $$\n令 $Y = p_2/p_1$。\n$$ 1 - \\frac{Y-1}{\\gamma M_1^2} = \\frac{(\\gamma-1)Y + \\gamma+1}{(\\gamma+1)Y + \\gamma-1} $$\n物理激波要求 $p_2 > p_1$ 且 $\\rho_2 > \\rho_1$。这意味着熵增加，对于压缩激波来说，这只有在上游流动是超音速（即 $M_1 > 1$）时才可能发生。这就是物理允许条件。平凡解 $M_1=1$ 导致 $p_2=p_1$, $\\rho_2=\\rho_1$, $u_2=u_1$，即没有激波。\n假设 $Y \\neq 1$，我们可以求解 $Y$。从 $(6)$，可得 $1-\\frac{\\rho_1}{\\rho_2} = \\frac{Y-1}{\\gamma M_1^2}$。将此代入用压强比表示密度比的方程中：\n$$ \\frac{\\rho_2}{\\rho_1} = \\frac{1}{1 - \\frac{Y-1}{\\gamma M_1^2}} = \\frac{(\\gamma+1)Y + (\\gamma-1)}{(\\gamma-1)Y + (\\gamma+1)} $$\n交叉相乘：\n$$ \\gamma M_1^2 [(\\gamma-1)Y + (\\gamma+1)] = (\\gamma M_1^2 - Y + 1)[(\\gamma+1)Y + (\\gamma-1)] $$\n这个代数运算很繁瑣。一个更直接的途径是将 $(5)$ 中的 $\\rho_2/\\rho_1$ 代入 $(6)$。\n$$ Y-1 = \\gamma M_1^2 \\left(1 - \\frac{(\\gamma-1)Y + (\\gamma+1)}{(\\gamma+1)Y + (\\gamma-1)}\\right) = \\gamma M_1^2 \\left(\\frac{(\\gamma+1)Y + (\\gamma-1) - ((\\gamma-1)Y + (\\gamma+1))}{(\\gamma+1)Y + (\\gamma-1)}\\right) $$\n$$ Y-1 = \\gamma M_1^2 \\left(\\frac{2Y - 2}{(\\gamma+1)Y + (\\gamma-1)}\\right) = \\frac{2\\gamma M_1^2(Y-1)}{(\\gamma+1)Y + \\gamma-1} $$\n对于激波，$Y \\neq 1$，所以我们可以除以 $(Y-1)$:\n$$ 1 = \\frac{2\\gamma M_1^2}{(\\gamma+1)Y + \\gamma-1} $$\n$$ (\\gamma+1)Y + \\gamma-1 = 2\\gamma M_1^2 $$\n$$ (\\gamma+1)Y = 2\\gamma M_1^2 - (\\gamma-1) $$\n$$ \\frac{p_2}{p_1} = \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} $$\n因此，下游压强为：\n$$ p_2 = p_1 \\left( \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} \\right) $$\n为了求出密度 $\\rho_2$，我们使用方程 $(6)$:\n$$ \\frac{\\rho_1}{\\rho_2} = 1 - \\frac{1}{\\gamma M_1^2}\\left(\\frac{p_2}{p_1} - 1\\right) $$\n$$ \\frac{p_2}{p_1} - 1 = \\frac{2\\gamma M_1^2 - (\\gamma-1) - (\\gamma+1)}{\\gamma+1} = \\frac{2\\gamma M_1^2 - 2\\gamma}{\\gamma+1} = \\frac{2\\gamma(M_1^2-1)}{\\gamma+1} $$\n$$ \\frac{\\rho_1}{\\rho_2} = 1 - \\frac{1}{\\gamma M_1^2}\\frac{2\\gamma(M_1^2-1)}{\\gamma+1} = 1 - \\frac{2(M_1^2-1)}{M_1^2(\\gamma+1)} = \\frac{M_1^2(\\gamma+1) - 2M_1^2 + 2}{M_1^2(\\gamma+1)} = \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} $$\n将其取倒数得到密度比：\n$$ \\frac{\\rho_2}{\\rho_1} = \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} $$\n所以下游密度为：\n$$ \\rho_2 = \\rho_1 \\left( \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} \\right) $$\n最后，从质量守恒方程 $(1)$ 中求出下游速度 $u_2$：\n$$ u_2 = u_1 \\left( \\frac{\\rho_1}{\\rho_2} \\right) = u_1 \\left( \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} \\right) $$\n这三个表达式提供了用上游状态 $(p_1, u_1, \\rho_1)$、马赫数 $M_1$ 和绝热指数 $\\gamma$ 表示的下游状态 $(p_2, u_2, \\rho_2)$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} p_1 \\left( \\frac{2\\gamma M_1^2 - (\\gamma-1)}{\\gamma+1} \\right) & u_1 \\left( \\frac{(\\gamma-1)M_1^2 + 2}{(\\gamma+1)M_1^2} \\right) & \\rho_1 \\left( \\frac{(\\gamma+1)M_1^2}{(\\gamma-1)M_1^2 + 2} \\right) \\end{pmatrix}} $$"
        },
        {
            "introduction": "能量守恒是物理学的第一性原理，但它并未揭示过程的方向性。本练习将能量守恒与热力学第二定律联系起来，通过分析一个一维稳态热传导问题，推导总熵产率的表达式。您将从傅里叶热传导定律和熵平衡方程出发，证明不可逆过程必然导致熵增，并理解熵产是如何量化系统中因热量传递而产生的不可逆性的。",
            "id": "3499241",
            "problem": "一根长度为 $L$、横截面积恒为 $A$ 的刚性均质杆，沿 $x$ 轴从 $x=0$ 到 $x=L$ 进行一维 (1D) 稳态导热。杆的侧表面是完美绝热的。两端的温度固定为 $T(0)=T_{0}$ 和 $T(L)=T_{L}$，且满足 $T_{0}>T_{L}>0$。随温度变化的热导率 $k(T)$ 是一个已知的正函数，并且在 $T_{L}$ 和 $T_{0}$ 之间的闭区间上是连续的。系统中没有内部热源，没有质量流动，也没有机械功；介质处于静止状态。\n\n请仅从局域能量守恒定律、傅里叶热传导定律以及熵流定义为热通量除以温度的第二定律熵平衡出发，推导杆内稳态下的总熵产率的闭式解析表达式。然后，验证该表达式对于所有允许的数据均为非负，并确定其在何种情况下恰好为零。最终的熵产率以瓦特每开尔文 (W/K) 为单位表示。最终结果应以 $A$、$L$、$T_{0}$、$T_{L}$ 和 $k(T)$ 表示的单一闭式解析表达式形式给出。无需进行数值计算，且最终答案不应以不等式形式给出。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、问题适定且客观，其设置基于热力学和传热学的既定原理，是完整和一致的。\n\n我们首先对指定系统应用局域能量守恒定律。问题陈述中指出，热传导是一维的（沿 $x$ 轴），处于稳态，且没有内部热源、质量流和机械功。对于一个微元控制体 $dV = A\\,dx$，能量守恒方程简化为热流率 $\\dot{Q}$ 沿杆是恒定的。热流率是热通量 $\\dot{q}_x$ 与横截面积 $A$ 的乘积。因此，$\\dot{Q} = A \\dot{q}_x = \\text{常数}$。\n\n傅里叶热传导定律将热通量与温度梯度关联起来。在一维情况下，其表达式为：\n$$\n\\dot{q}_x = -k(T) \\frac{dT}{dx}\n$$\n其中 $k(T)$ 是随温度变化的热导率。因此，总热流率为：\n$$\n\\dot{Q} = -A k(T) \\frac{dT}{dx}\n$$\n由于 $\\dot{Q}$ 和 $A$ 是常数，我们可以通过分离变量法来求解 $\\dot{Q}$。我们将方程重排为：\n$$\n\\dot{Q} \\, dx = -A k(T) \\, dT\n$$\n我们对该表达式沿杆的长度（从 $x=0$ 到 $x=L$）进行积分。相应的温度积分限为从 $T(0)=T_0$ 到 $T(L)=T_L$：\n$$\n\\int_{0}^{L} \\dot{Q} \\, dx = \\int_{T_0}^{T_L} -A k(T) \\, dT\n$$\n由于 $\\dot{Q}$ 是常数，可以将其从左侧的积分中提出。我们也可以反转右侧的积分限，这会改变其符号：\n$$\n\\dot{Q} \\int_{0}^{L} dx = A \\int_{T_L}^{T_0} k(T) \\, dT\n$$\n对左侧进行积分得到：\n$$\n\\dot{Q}L = A \\int_{T_L}^{T_0} k(T) \\, dT\n$$\n由此，我们得到恒定热流率的表达式：\n$$\n\\dot{Q} = \\frac{A}{L} \\int_{T_L}^{T_0} k(T) \\, dT\n$$\n接下来，我们将整根杆视为一个单一的控制体，并对其应用第二定律熵平衡。对于稳态过程，控制体内熵的变化率为零。熵平衡方程为：\n$$\n\\frac{dS_{CV}}{dt} = \\sum_{\\text{in}} \\dot{S} - \\sum_{\\text{out}} \\dot{S} + \\dot{S}_{gen, total} = 0\n$$\n其中 $\\dot{S}_{gen, total}$ 是杆内的总熵产率。由于没有质量流动，熵传递 $\\dot{S}$ 仅通过边界的热传递发生。问题陈述将熵流定义为热通量除以温度。因此，在温度为 $T$ 的边界上，与热流率 $\\dot{Q}$ 相关的熵传递率为 $\\frac{\\dot{Q}}{T}$。\n\n热量从热端流向冷端，因此 $\\dot{Q}$ 在 $x=0$（温度为 $T_0$）处进入控制体，在 $x=L$（温度为 $T_L$）处流出。杆的熵平衡为：\n$$\n0 = \\frac{\\dot{Q}}{T_0} - \\frac{\\dot{Q}}{T_L} + \\dot{S}_{gen, total}\n$$\n解出总熵产率，我们得到：\n$$\n\\dot{S}_{gen, total} = \\frac{\\dot{Q}}{T_L} - \\frac{\\dot{Q}}{T_0} = \\dot{Q} \\left( \\frac{1}{T_L} - \\frac{1}{T_0} \\right)\n$$\n这个表达式是根据全局熵平衡得出的基本结果。现在，我们代入先前推导的热流率 $\\dot{Q}$ 的表达式：\n$$\n\\dot{S}_{gen, total} = \\left( \\frac{A}{L} \\int_{T_L}^{T_0} k(T) \\, dT \\right) \\left( \\frac{1}{T_L} - \\frac{1}{T_0} \\right)\n$$\n这就是杆内总熵产率的最终闭式解析表达式。\n\n最后，我们必须根据热力学第二定律的要求，验证该表达式是非负的。我们分析表达式中每一项的符号：\n1. 物理尺寸 $A$ 和 $L$ 均为正数，所以 $\\frac{A}{L} > 0$。\n2. 问题陈述指出，热导率 $k(T)$ 是一个正函数。积分区间为从 $T_L$ 到 $T_0$。根据问题陈述，$T_0 > T_L > 0$。由于被积函数 $k(T)$ 在整个积分区间 $[T_L, T_0]$ 上为正，且该区间的宽度为正 ($T_0-T_L > 0$)，因此定积分 $\\int_{T_L}^{T_0} k(T) \\, dT$ 必定为正。\n3. 对于项 $\\left(\\frac{1}{T_L} - \\frac{1}{T_0}\\right)$，因为 $T_0 > T_L > 0$，所以 $\\frac{1}{T_L} > \\frac{1}{T_0}$。因此，这一项也为正。\n\n总熵产率 $\\dot{S}_{gen, total}$ 是几个正项的乘积。因此，只要存在温差，就有 $\\dot{S}_{gen, total} > 0$。\n\n熵产率恰好为零，即 $\\dot{S}_{gen, total}=0$，当且仅当其中一个乘法因子为零。由于 $A>0$ 且 $L>0$，这只可能在 $\\int_{T_L}^{T_0} k(T) \\, dT = 0$ 或 $\\left(\\frac{1}{T_L} - \\frac{1}{T_0}\\right) = 0$ 时发生。由于 $k(T)$ 是正的连续函数，其积分仅在积分区间宽度为零时才为零，即 $T_0 = T_L$。第二项也仅在 $T_0 = T_L$ 时为零。这个物理条件对应于热平衡状态，此时没有温度梯度，没有热流（$\\dot{Q}=0$），因此没有熵产生，这与热力学原理是一致的。",
            "answer": "$$\n\\boxed{\\left( \\frac{A}{L} \\int_{T_L}^{T_0} k(T) \\, dT \\right) \\left( \\frac{1}{T_L} - \\frac{1}{T_0} \\right)}\n$$"
        },
        {
            "introduction": "将理论守恒定律转化为精确的数值算法是多物理场仿真的关键挑战。本练习聚焦于带有相变的多相流问题，要求您在移动界面上应用质量和能量守恒的界面跳跃条件（Stefan条件），并处理水平集方法（Level Set Method）中常见的数值质量损失问题。通过这个实践，您不仅能掌握界面动力学的物理原理，还能学会如何设计和实施保持守恒性的数值修正方案，这对于确保仿真结果的物理真实性至关重要。",
            "id": "3499248",
            "problem": "考虑一个长度为 $L$（单位为 $\\mathrm{m}$）、单位横截面积为 $A = 1\\,\\mathrm{m}^2$ 的一维两相域，其中包含由一个移动的尖锐界面分隔的液相和气相。该界面通过水平集方法 (LSM) 进行追踪，水平集函数为 $\\phi(x,t)$，它在液相中为负，在气相中为正，初始时等于有符号距离 $\\phi(x,0) = x - x_0$，其中 $x_0$（单位为 $\\mathrm{m}$）表示初始界面位置。单位法向量 $\\mathbf{n}$ 从液相指向气相。液相具有恒定密度 $\\rho_l$（单位为 $\\mathrm{kg}/\\mathrm{m}^3$），气相具有恒定密度 $\\rho_v$（单位为 $\\mathrm{kg}/\\mathrm{m}^3$）。液相整体速度满足 $u_l = 0$（单位为 $\\mathrm{m}/\\mathrm{s}$）。汽化潜热为 $h_{lv}$（单位为 $\\mathrm{J}/\\mathrm{kg}$）。界面上气相侧和液相侧的法向热通量为给定的常数 $q_v$ 和 $q_l$（单位为 $\\mathrm{W}/\\mathrm{m}^2$）。单位面积的界面传质速率为 $\\dot{m}$（单位为 $\\mathrm{kg}/(\\mathrm{m}^2\\,\\mathrm{s})$），界面法向速度为 $V_n$（单位为 $\\mathrm{m}/\\mathrm{s}$）。假设一个很短的时间步长 $\\Delta t$（单位为 $\\mathrm{s}$），使得界面保持在域内。水平集平流由与有符号距离一致的 Hamilton-Jacobi 形式建模，$\\phi_t + V_n \\lvert \\nabla \\phi \\rvert = 0$，对于有符号距离初始条件，可以使用 $\\lvert \\nabla \\phi \\rvert = 1$ 将 $\\phi$ 更新为 $\\phi^{n+1}(x) = \\phi^n(x) - \\Delta t\\, V_n$，从而将界面位置从 $x_{\\mathrm{int}}^n$ 更新为 $x_{\\mathrm{int}}^{n+1} = x_{\\mathrm{int}}^n + \\Delta t\\, V_n$。气相侧速度 $u_v$（单位为 $\\mathrm{m}/\\mathrm{s}$）是未知的，且必须与质量守恒一致。已知平流后，重新初始化步骤会通过扰动零水平集而导致虚假的质量损失。为模拟此现象，定义一个重新初始化的水平集为 $\\phi^{\\mathrm{re}}(x) = \\phi^{n+1}(x) + \\gamma$，其中 $\\gamma$（单位为 $\\mathrm{m}$）是一个小的常数偏移。这将界面位置移动到 $x_{\\mathrm{int}}^{\\mathrm{re}} = x_{\\mathrm{int}}^{n+1} - \\gamma$，可能会改变总质量。\n\n从应用于跨越界面的无穷小控制体的能量守恒和质量守恒，以及汽化潜热的定义出发，推导与给定数据一致的 $\\dot{m}$ 和 $V_n$ 的表达式，并确定 $u_v$ 以满足界面质量守恒条件。使用这些表达式，执行一个水平集平流步骤以计算 $x_{\\mathrm{int}}^{n+1}$，然后应用重新初始化 $\\gamma$ 并计算重新初始化前后的总质量：\n- $M_{\\mathrm{before}} = \\rho_l\\, x_{\\mathrm{int}}^{n+1}\\, A + \\rho_v\\, \\left(L - x_{\\mathrm{int}}^{n+1}\\right) A$，\n- $M_{\\mathrm{after}} = \\rho_l\\, x_{\\mathrm{int}}^{\\mathrm{re}}\\, A + \\rho_v\\, \\left(L - x_{\\mathrm{int}}^{\\mathrm{re}}\\right) A$，\n\n并量化质量误差 $\\Delta M = M_{\\mathrm{after}} - M_{\\mathrm{before}}$（单位为 $\\mathrm{kg}$）。提出并实施一个守恒修正，该修正对重新初始化的水平集应用一个恒定位移 $\\delta_c$（单位为 $\\mathrm{m}$）（即用 $\\phi^{\\mathrm{re}}(x) - \\delta_c$ 替换 $\\phi^{\\mathrm{re}}(x)$），使得修正后的总质量 $M_{\\mathrm{corr}}$ 精确等于 $M_{\\mathrm{before}}$。报告修正后的质量误差 $\\Delta M_{\\mathrm{corr}} = M_{\\mathrm{corr}} - M_{\\mathrm{before}}$（单位为 $\\mathrm{kg}$）。\n\n您的程序必须为每个测试案例计算三个量：\n- 界面传质速率 $\\dot{m}$，单位为 $\\mathrm{kg}/(\\mathrm{m}^2\\,\\mathrm{s})$，\n- 由重新初始化引起的未修正质量误差 $\\Delta M$，单位为 $\\mathrm{kg}$，\n- 应用守恒修正后的修正质量误差 $\\Delta M_{\\mathrm{corr}}$，单位为 $\\mathrm{kg}$。\n\n将所有三个输出表示为十进制浮点数。法向方向是从液相到气相；蒸发对应于 $\\dot{m} > 0$，冷凝对应于 $\\dot{m}  0$。\n\n测试套件参数集：\n- 案例1（常规路径，蒸发）：$L = 0.1\\,\\mathrm{m}$，$x_0 = 0.06\\,\\mathrm{m}$，$\\rho_l = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$，$\\rho_v = 0.6\\,\\mathrm{kg}/\\mathrm{m}^3$，$h_{lv} = 2.26\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$，$q_v = 1200\\,\\mathrm{W}/\\mathrm{m}^2$，$q_l = 200\\,\\mathrm{W}/\\mathrm{m}^2$，$\\Delta t = 0.01\\,\\mathrm{s}$，$\\gamma = 1\\times 10^{-4}\\,\\mathrm{m}$。\n- 案例2（边界：零能量跳跃）：$L = 0.12\\,\\mathrm{m}$，$x_0 = 0.05\\,\\mathrm{m}$，$\\rho_l = 950\\,\\mathrm{kg}/\\mathrm{m}^3$，$\\rho_v = 0.7\\,\\mathrm{kg}/\\mathrm{m}^3$，$h_{lv} = 2.26\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$，$q_v = 1000\\,\\mathrm{W}/\\mathrm{m}^2$，$q_l = 1000\\,\\mathrm{W}/\\mathrm{m}^2$，$\\Delta t = 0.01\\,\\mathrm{s}$，$\\gamma = 5\\times 10^{-4}\\,\\mathrm{m}$。\n- 案例3（冷凝：负能量跳跃）：$L = 0.2\\,\\mathrm{m}$，$x_0 = 0.15\\,\\mathrm{m}$，$\\rho_l = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$，$\\rho_v = 0.6\\,\\mathrm{kg}/\\mathrm{m}^3$，$h_{lv} = 2.26\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$，$q_v = 500\\,\\mathrm{W}/\\mathrm{m}^2$，$q_l = 1000\\,\\mathrm{W}/\\mathrm{m}^2$，$\\Delta t = 0.02\\,\\mathrm{s}$，$\\gamma = 2\\times 10^{-4}\\,\\mathrm{m}$。\n- 案例4（密度接近）：$L = 0.08\\,\\mathrm{m}$，$x_0 = 0.04\\,\\mathrm{m}$，$\\rho_l = 10\\,\\mathrm{kg}/\\mathrm{m}^3$，$\\rho_v = 8\\,\\mathrm{kg}/\\mathrm{m}^3$，$h_{lv} = 1.0\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$，$q_v = 300\\,\\mathrm{W}/\\mathrm{m}^2$，$q_l = 0\\,\\mathrm{W}/\\mathrm{m}^2$，$\\Delta t = 0.005\\,\\mathrm{s}$，$\\gamma = 1\\times 10^{-4}\\,\\mathrm{m}$。\n- 案例5（边缘：无重新初始化扰动）：$L = 0.1\\,\\mathrm{m}$，$x_0 = 0.03\\,\\mathrm{m}$，$\\rho_l = 1000\\,\\mathrm{kg}/\\mathrm{m}^3$，$\\rho_v = 0.6\\,\\mathrm{kg}/\\mathrm{m}^3$，$h_{lv} = 2.26\\times 10^6\\,\\mathrm{J}/\\mathrm{kg}$，$q_v = 1100\\,\\mathrm{W}/\\mathrm{m}^2$，$q_l = 900\\,\\mathrm{W}/\\mathrm{m}^2$，$\\Delta t = 0.01\\,\\mathrm{s}$，$\\gamma = 0\\,\\mathrm{m}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，元素按测试案例排序，并且对于每个案例，三个量按顺序为 $\\left[\\dot{m}, \\Delta M, \\Delta M_{\\mathrm{corr}}\\right]$。具体而言，打印\n$[\\dot{m}_1, \\Delta M_1, \\Delta M_{\\mathrm{corr},1}, \\dot{m}_2, \\Delta M_2, \\Delta M_{\\mathrm{corr},2}, \\ldots, \\dot{m}_5, \\Delta M_5, \\Delta M_{\\mathrm{corr},5}]$，\n其中 $\\dot{m}$ 的单位为 $\\mathrm{kg}/(\\mathrm{m}^2\\,\\mathrm{s})$，两个质量误差的单位均为 $\\mathrm{kg}$，均表示为十进制数。",
            "solution": "该问题要求分析一个正在经历相变的一维两相系统中的质量守恒问题，特别是在水平集方法 (LSM) 引入数值误差的背景下。我们必须首先从基本守恒原理推导出控制界面动力学的物理量，然后量化一个由数值方法引起的质量误差，最后设计并应用一个修正来恢复质量守恒。域的横截面积指定为 $A = 1\\,\\mathrm{m}^2$。\n\n### 1. 界面守恒定律\n\n液相和气相之间尖锐界面的动力学由 Rankine-Hugoniot 跳跃条件决定，这些条件表示跨界面的质量、动量和能量守恒。我们考虑一个一维域，其中界面位于 $x=x_{\\mathrm{int}}(t)$。单位法向量 $\\mathbf{n}$ 从液相（相 $l$）指向气相（相 $v$），并取为正 $x$ 方向。\n\n### 2. 能量守恒和传质速率\n\n第一步是确定单位面积的传质速率 $\\dot{m}$。这可以从界面的能量平衡中推导出来。该平衡表明，进入界面的净热通量被转化为汽化潜热。设 $q_l$ 和 $q_v$ 分别为液相侧和气相侧垂直于界面的热通量，法向 $\\mathbf{n}$ 方向的通量为正。一个常见的约定（与问题的测试案例标签一致，例如案例1为蒸发）将能量平衡建立为：\n$$\n\\dot{m} h_{lv} = q_v - q_l\n$$\n其中 $h_{lv}$ 是汽化潜热。正的 $\\dot{m}$ 表示蒸发（液相到气相），负的 $\\dot{m}$ 表示冷凝（气相到液相）。此方程允许直接计算传质速率：\n$$\n\\dot{m} = \\frac{q_v - q_l}{h_{lv}}\n$$\n单位为 $(\\mathrm{W}/\\mathrm{m}^2) / (\\mathrm{J}/\\mathrm{kg}) = (\\mathrm{J}/(\\mathrm{s} \\cdot \\mathrm{m}^2)) / (\\mathrm{J}/\\mathrm{kg}) = \\mathrm{kg}/(\\mathrm{m}^2 \\cdot \\mathrm{s})$，符合要求。\n\n### 3. 质量守恒和界面速度\n\n跨界面的质量守恒将传质速率 $\\dot{m}$ 与流体速度和界面速度联系起来。一维质量跳跃条件是：\n$$\n\\rho_l (u_l - V_n) = \\rho_v (u_v - V_n)\n$$\n其中 $u_l$ 和 $u_v$ 是液相和气相在 $x$ 方向的物质速度，而 $V_n$ 是界面本身的法向速度。这个共同的量也与 $\\dot{m}$ 相关。离开液相并进入气相的质量通量定义为 $\\dot{m}$。因此，我们有：\n$$\n\\dot{m} = \\rho_l(V_n - u_l) = \\rho_v(V_n - u_v)\n$$\n鉴于液相是静止的，$u_l = 0\\,\\mathrm{m/s}$，第一个等式给出了界面速度 $V_n$ 的直接表达式：\n$$\n\\dot{m} = \\rho_l V_n \\implies V_n = \\frac{\\dot{m}}{\\rho_l}\n$$\n这决定了界面移动的速度。为保持一致性，气相速度 $u_v$ 必须满足第二个等式：\n$$\n\\dot{m} = \\rho_v(V_n - u_v) \\implies u_v = V_n - \\frac{\\dot{m}}{\\rho_v} = \\frac{\\dot{m}}{\\rho_l} - \\frac{\\dot{m}}{\\rho_v} = \\dot{m} \\left( \\frac{1}{\\rho_l} - \\frac{1}{\\rho_v} \\right)\n$$\n虽然为完整性确定了 $u_v$，但其值对于直接计算质量误差不是必需的。\n\n### 4. 界面平流和质量计算\n\n问题描述了追踪界面的数值过程。从初始界面位置 $x_{\\mathrm{int}}^n = x_0$ 开始，经过一个时间步长 $\\Delta t$ 后，使用计算出的界面速度 $V_n$ 更新位置：\n$$\nx_{\\mathrm{int}}^{n+1} = x_{\\mathrm{int}}^n + \\Delta t \\cdot V_n = x_0 + \\Delta t \\frac{\\dot{m}}{\\rho_l}\n$$\n在任何数值校正之前，域中的总质量是液相和气相质量之和。液相占据从 $x=0$ 到 $x=x_{\\mathrm{int}}^{n+1}$ 的体积，气相占据域的其余部分，从 $x=x_{\\mathrm{int}}^{n+1}$ 到 $x=L$。\n$$\nM_{\\mathrm{before}} = \\rho_l \\cdot (x_{\\mathrm{int}}^{n+1} \\cdot A) + \\rho_v \\cdot (L - x_{\\mathrm{int}}^{n+1}) \\cdot A\n$$\n由于 $A=1\\,\\mathrm{m}^2$，这简化为 $M_{\\mathrm{before}} = \\rho_l x_{\\mathrm{int}}^{n+1} + \\rho_v (L - x_{\\mathrm{int}}^{n+1})$。\n\n### 5. 重新初始化引入的数值质量误差\n\nLSM 模拟中的一个常见问题是由重新初始化步骤引入的数值误差，该步骤对于维持 $\\phi$ 的有符号距离属性是必需的。问题将此误差建模为应用于水平集函数的恒定位移 $\\gamma$，这导致界面位置的移动：\n$$\nx_{\\mathrm{int}}^{\\mathrm{re}} = x_{\\mathrm{int}}^{n+1} - \\gamma\n$$\n这种位移改变了两相的计算体积，导致总质量发生变化。这种人为位移后的总质量为：\n$$\nM_{\\mathrm{after}} = \\rho_l \\cdot (x_{\\mathrm{int}}^{\\mathrm{re}} \\cdot A) + \\rho_v \\cdot (L - x_{\\mathrm{int}}^{\\mathrm{re}}) \\cdot A\n$$\n未修正的质量误差 $\\Delta M$ 是重新初始化步骤之后和之前的质量之差：\n$$\n\\Delta M = M_{\\mathrm{after}} - M_{\\mathrm{before}}\n$$\n代入质量的表达式：\n$$\n\\Delta M = \\left[ \\rho_l x_{\\mathrm{int}}^{\\mathrm{re}} + \\rho_v (L - x_{\\mathrm{int}}^{\\mathrm{re}}) \\right] A - \\left[ \\rho_l x_{\\mathrm{int}}^{n+1} + \\rho_v (L - x_{\\mathrm{int}}^{n+1}) \\right] A\n$$\n$$\n\\Delta M = \\left( (x_{\\mathrm{int}}^{\\mathrm{re}} - x_{\\mathrm{int}}^{n+1}}) \\rho_l - (x_{\\mathrm{int}}^{\\mathrm{re}} - x_{\\mathrm{int}}^{n+1}}) \\rho_v \\right) A\n$$\n$$\n\\Delta M = (x_{\\mathrm{int}}^{\\mathrm{re}} - x_{\\mathrm{int}}^{n+1}}) (\\rho_l - \\rho_v) A\n$$\n由于 $x_{\\mathrm{int}}^{\\mathrm{re}} - x_{\\mathrm{int}}^{n+1}} = -\\gamma$，我们得到了质量误差的直接表达式：\n$$\n\\Delta M = -\\gamma (\\rho_l - \\rho_v) A\n$$\n\n### 6. 守恒修正\n\n为了强制质量守恒，一个修正位移 $\\delta_c$ 被应用于重新初始化的水平集，从而得到一个修正后的界面位置 $x_{\\mathrm{int}}^{\\mathrm{corr}} = x_{\\mathrm{int}}^{\\mathrm{re}} + \\delta_c$。目标是选择 $\\delta_c$，使得修正后的质量 $M_{\\mathrm{corr}}$ 与重新初始化前的质量 $M_{\\mathrm{before}}$ 完全相同。\n$$\nM_{\\mathrm{corr}} = \\rho_l \\cdot (x_{\\mathrm{int}}^{\\mathrm{corr}} \\cdot A) + \\rho_v \\cdot (L - x_{\\mathrm{int}}^{\\mathrm{corr}}) \\cdot A\n$$\n设置 $M_{\\mathrm{corr}} = M_{\\mathrm{before}}$：\n$$\n\\left( \\rho_l x_{\\mathrm{int}}^{\\mathrm{corr}} + \\rho_v (L - x_{\\mathrm{int}}^{\\mathrm{corr}}) \\right) A = \\left( \\rho_l x_{\\mathrm{int}}^{n+1} + \\rho_v (L - x_{\\mathrm{int}}^{n+1}) \\right) A\n$$\n假设 $\\rho_l \\neq \\rho_v$，当且仅当 $x_{\\mathrm{int}}^{\\mathrm{corr}} = x_{\\mathrm{int}}^{n+1}$ 时，此等式成立。代入修正后位置的定义：\n$$\nx_{\\mathrm{int}}^{\\mathrm{re}} + \\delta_c = x_{\\mathrm{int}}^{n+1}\n$$\n$$\n(x_{\\mathrm{int}}^{n+1} - \\gamma) + \\delta_c = x_{\\mathrm{int}}^{n+1}\n$$\n这得出了所需的修正位移：\n$$\n\\delta_c = \\gamma\n$$\n应用此修正将界面恢复到其物理上正确的平流位置，从而完美地守恒质量。根据构造，修正后的质量误差为：\n$$\n\\Delta M_{\\mathrm{corr}} = M_{\\mathrm{corr}} - M_{\\mathrm{before}} = 0\n$$\n\n### 7. 计算摘要\n\n对于每个测试案例，所需的三个量按如下方式计算：\n1.  **传质速率**：$\\dot{m} = \\frac{q_v - q_l}{h_{lv}}$。\n2.  **未修正的质量误差**：$\\Delta M = -\\gamma (\\rho_l - \\rho_v) A$，其中 $A=1\\,\\mathrm{m}^2$。虽然可以使用这个直接公式，但我们将遵循问题的程序描述，明确计算 $x_{\\mathrm{int}}^{n+1}$ 和质量，以展示完整过程。\n3.  **修正后的质量误差**：$\\Delta M_{\\mathrm{corr}} = 0$，根据修正的定义。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the multiphysics problem for conservation of mass, momentum, and energy\n    at a moving phase-change interface, including a model for numerical mass error\n    and its correction.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, x0, rho_l, rho_v, h_lv, q_v, q_l, dt, gamma)\n    test_cases = [\n        # Case 1 (happy path, evaporation)\n        (0.1, 0.06, 1000, 0.6, 2.26e6, 1200, 200, 0.01, 1e-4),\n        # Case 2 (boundary: zero energy jump)\n        (0.12, 0.05, 950, 0.7, 2.26e6, 1000, 1000, 0.01, 5e-4),\n        # Case 3 (condensation: negative energy jump)\n        (0.2, 0.15, 1000, 0.6, 2.26e6, 500, 1000, 0.02, 2e-4),\n        # Case 4 (near-density match)\n        (0.08, 0.04, 10, 8, 1.0e6, 300, 0, 0.005, 1e-4),\n        # Case 5 (edge: no reinitialization perturbation)\n        (0.1, 0.03, 1000, 0.6, 2.26e6, 1100, 900, 0.01, 0.0),\n    ]\n\n    results = []\n    A = 1.0  # Unit cross-sectional area in m^2\n\n    for case in test_cases:\n        L, x0, rho_l, rho_v, h_lv, q_v, q_l, dt, gamma = case\n\n        # 1. Calculate the interfacial mass transfer rate per unit area (m_dot)\n        # Based on the energy jump condition: m_dot * h_lv = q_v - q_l\n        m_dot = (q_v - q_l) / h_lv\n\n        # 2. Calculate the interface velocity (V_n)\n        # Based on the mass jump condition: m_dot = rho_l * V_n (since u_l = 0)\n        V_n = m_dot / rho_l\n\n        # 3. Perform one advection step to find the new interface position\n        # x_int^{n+1} = x_int^n + dt * V_n\n        # Here, x_int^n is the initial position x0\n        x_int_n1 = x0 + dt * V_n\n\n        # 4. Calculate total mass before reinitialization (M_before)\n        # M = rho_l * V_l + rho_v * V_v = rho_l * (x_int * A) + rho_v * ((L - x_int) * A)\n        M_before = rho_l * x_int_n1 * A + rho_v * (L - x_int_n1) * A\n\n        # 5. Apply the artificial reinitialization shift gamma to the interface\n        x_int_re = x_int_n1 - gamma\n\n        # 6. Calculate total mass after reinitialization (M_after)\n        M_after = rho_l * x_int_re * A + rho_v * (L - x_int_re) * A\n\n        # 7. Quantify the uncorrected mass error (Delta M)\n        delta_M = M_after - M_before\n        \n        # Analytically, delta_M = -gamma * (rho_l - rho_v) * A. \n        # The procedural calculation above is used to strictly follow the problem description.\n\n        # 8. Define the corrected mass error (Delta M_corr)\n        # The correction is designed to make the corrected mass exactly equal to M_before.\n        # Therefore, the corrected mass error is zero by definition.\n        delta_M_corr = 0.0\n\n        results.extend([m_dot, delta_M, delta_M_corr])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}