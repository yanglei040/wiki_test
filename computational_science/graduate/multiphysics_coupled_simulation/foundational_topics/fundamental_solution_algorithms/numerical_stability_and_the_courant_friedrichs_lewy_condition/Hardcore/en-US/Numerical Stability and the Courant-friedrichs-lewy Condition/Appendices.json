{
    "hands_on_practices": [
        {
            "introduction": "In numerical modeling, the most straightforward discretization is not always the correct one. This exercise explores the Forward-Time Central-Space (FTCS) scheme for the linear advection equation, $u_{t} + a u_{x} = 0$, a method that seems intuitive but harbors a fatal flaw. By performing a von Neumann stability analysis, you will discover why this scheme is unconditionally unstable, providing a crucial first-hand lesson on the importance of analyzing the stability properties of any numerical method before its application .",
            "id": "3518829",
            "problem": "A linear advection substep appears inside a partitioned multiphysics solver that alternates between fluid advection and passive scalar transport. Consider the scalar advection equation in a single spatial dimension with constant wave speed,\n$$\nu_{t} + a\\,u_{x} = 0,\n$$\nposed on a periodic domain with period $L$, where $a>0$ is constant. On a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, the advection substep is approximated by a forward Euler update in time and a central difference in space. Denote by $u_{j}^{n}$ the numerical solution at spatial index $j$ and time level $n$. Assume the solution and the discrete operator are both periodic and shift-invariant.\n\nStarting from the definitions of the forward Euler method and the central difference operator, and using spatial Fourier modes compatible with the periodic domain, perform a von Neumann (Fourier) stability analysis to determine the discrete amplification factor and its magnitude. Introduce the Courant-Friedrichs-Lewy (CFL) number $C$ defined by $C = a\\,\\Delta t / \\Delta x$ and a nondimensional phase $\\theta$ associated with a spatial Fourier mode. Use the fact that for linear, constant-coefficient, shift-invariant schemes on periodic grids, complex exponentials are eigenfunctions of the discrete spatial derivative.\n\nExplain, based on first principles and your derived magnitude of the amplification factor, why this time-space discretization is unconditionally unstable in the sense of von Neumann. Your final answer should be a single, closed-form analytic expression for the magnitude of the amplification factor as a function of $\\theta$ and $C$. Do not include any units in the final answer. No numerical rounding is required.",
            "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- **Governing Equation:** $u_{t} + a\\,u_{x} = 0$\n- **Wave Speed:** $a > 0$, constant.\n- **Domain:** Periodic with period $L$.\n- **Discretization:**\n  - Time: Forward Euler method.\n  - Space: Central difference method.\n  - Grid: Uniform with spatial step $\\Delta x$ and time step $\\Delta t$.\n- **Numerical Solution Notation:** $u_{j}^{n}$ at spatial index $j$ and time level $n$.\n- **Assumptions:** Solution and discrete operator are periodic and shift-invariant.\n- **Analysis Method:** von Neumann (Fourier) stability analysis.\n- **Definitions:**\n  - Courant-Friedrichs-Lewy (CFL) number: $C = a\\,\\Delta t / \\Delta x$.\n  - Nondimensional phase: $\\theta$ for a spatial Fourier mode.\n- **Task:** Derive the discrete amplification factor and its magnitude, and use the result to explain why the scheme is unconditionally unstable.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a classic exercise in the numerical analysis of partial differential equations. The governing equation is the fundamental linear advection equation. The numerical scheme (Forward Time, Central Space, or FTCS) is a standard, albeit flawed, discretization. The method of analysis, von Neumann stability analysis, is the canonical tool for linear, constant-coefficient problems on periodic domains. All definitions and terms ($C$, $\\theta$) are standard. The problem is self-contained, scientifically sound, and well-posed. It does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe given partial differential equation (PDE) is the one-dimensional linear advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nWe are instructed to discretize this equation using a forward difference in time (Forward Euler) and a central difference in space. The forward difference approximation for the time derivative at grid point $(j, n)$ is:\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n$$\nThe central difference approximation for the spatial derivative is:\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x}\n$$\nSubstituting these approximations into the PDE yields the finite difference equation:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a \\left( \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x} \\right) = 0\n$$\nTo find the update rule for $u_{j}^{n+1}$, we solve for this term:\n$$\nu_{j}^{n+1} = u_{j}^{n} - a \\frac{\\Delta t}{2 \\Delta x} (u_{j+1}^{n} - u_{j-1}^{n})\n$$\nWe introduce the Courant-Friedrichs-Lewy (CFL) number, defined as $C = a\\,\\Delta t / \\Delta x$. Substituting $C$ into the equation gives the final form of the discrete scheme:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2} (u_{j+1}^{n} - u_{j-1}^{n})\n$$\nFor the von Neumann stability analysis, we consider a single spatial Fourier mode as a solution. On a grid with points $x_j = j \\Delta x$, a general Fourier mode has the form $e^{i k x_j} = e^{i k j \\Delta x}$, where $k$ is the wavenumber. We define the nondimensional phase angle $\\theta = k \\Delta x$. The solution at a given time level $n$ is represented as a superposition of such modes. Due to the linearity of the scheme, we can analyze the behavior of a single mode:\n$$\nu_{j}^{n} = \\hat{u}^{n}(k) e^{i j \\theta}\n$$\nwhere $\\hat{u}^{n}(k)$ is the amplitude of the mode with phase $\\theta$ at time level $n$. Substituting this ansatz into the discrete scheme gives:\n$$\n\\hat{u}^{n+1} e^{i j \\theta} = \\hat{u}^{n} e^{i j \\theta} - \\frac{C}{2} \\left( \\hat{u}^{n} e^{i (j+1) \\theta} - \\hat{u}^{n} e^{i (j-1) \\theta} \\right)\n$$\nWe can factor out the common term $\\hat{u}^{n} e^{i j \\theta}$:\n$$\n\\hat{u}^{n+1} e^{i j \\theta} = \\hat{u}^{n} e^{i j \\theta} \\left( 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta}) \\right)\n$$\nDividing by $e^{i j \\theta}$ gives the evolution of the mode's amplitude:\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n} \\left( 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta}) \\right)\n$$\nThe amplification factor, $G(\\theta)$, is defined as the ratio of the amplitudes at successive time steps, $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^{n}$. Therefore:\n$$\nG(\\theta) = 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta})\n$$\nUsing Euler's identity, $e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$, we can simplify the expression for $G(\\theta)$:\n$$\nG(\\theta) = 1 - \\frac{C}{2} (2i \\sin(\\theta)) = 1 - iC\\sin(\\theta)\n$$\nThis is the complex amplification factor. To assess stability, we must find its magnitude, $|G(\\theta)|$. For a complex number $z = x + iy$, its magnitude is $|z| = \\sqrt{x^2 + y^2}$. In our case, the real part is $1$ and the imaginary part is $-C\\sin(\\theta)$.\n$$\n|G(\\theta)| = \\sqrt{1^2 + (-C\\sin(\\theta))^2}\n$$\n$$\n|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}\n$$\nThis expression gives the magnitude of the amplification factor as a function of the CFL number $C$ and the nondimensional phase $\\theta$.\n\n**Explanation of Unconditional Instability**\nThe von Neumann stability criterion for a numerical scheme requires that the magnitude of the amplification factor must be less than or equal to one for all possible Fourier modes, i.e., $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. If this condition is violated for any mode, that mode's amplitude will grow exponentially with each time step, leading to a numerical instability that quickly overwhelms the true solution.\n\nLet's examine our derived magnitude, $|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}$.\nAccording to the problem statement, the wave speed $a$ is positive. The grid spacing $\\Delta x$ and time step $\\Delta t$ are also positive physical quantities. Therefore, the CFL number $C = a \\Delta t / \\Delta x$ is strictly positive ($C > 0$).\nThe term $\\sin^2(\\theta)$ is always non-negative, $\\sin^2(\\theta) \\ge 0$.\nThe product $C^2 \\sin^2(\\theta)$ is therefore also non-negative.\n\nThe only cases where $C^2 \\sin^2(\\theta) = 0$ are:\n1.  If $C = 0$. This is a trivial case where $\\Delta t = 0$, meaning the simulation does not advance in time.\n2.  If $\\sin(\\theta) = 0$. This occurs when $\\theta = n\\pi$ for any integer $n$. These modes correspond to constant values ($\\theta=0$) or the Nyquist frequency mode ($\\theta=\\pi$) on the grid, which have infinite or minimal wavelength, respectively. For these specific modes, $|G(\\theta)| = \\sqrt{1+0} = 1$, so they do not grow.\n\nHowever, for any other Fourier mode, where $\\sin(\\theta) \\neq 0$, the term $C^2 \\sin^2(\\theta)$ is strictly positive. Consequently, for any such mode:\n$$\n1 + C^2 \\sin^2(\\theta) > 1\n$$\nTaking the square root, we find:\n$$\n|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)} > 1\n$$\nThis inequality holds for any non-zero value of the CFL number $C$ and for any mode $\\theta$ that is not an integer multiple of $\\pi$. Since the stability criterion must be satisfied for all modes, and it fails for almost all of them regardless of the choice of $\\Delta t$ and $\\Delta x$ (as long as $C > 0$), the scheme is unstable for any choice of time step. This is the definition of unconditional instability. The imaginary term $iC\\sin(\\theta)$ in the amplification factor, which arises from the central difference operator, acts purely to add energy to the system at each time step without any corresponding dissipative mechanism, causing the solution to grow without bound.",
            "answer": "$$\n\\boxed{\\sqrt{1 + C^2 \\sin^2(\\theta)}}\n$$"
        },
        {
            "introduction": "Having seen how a seemingly reasonable scheme can fail, we now turn to a method designed with the physics of wave propagation in mind. The first-order upwind scheme uses information from the direction of flow, a simple change that has profound implications for stability. In this practice, you will derive the celebrated Courant-Friedrichs-Lewy (CFL) condition for the upwind method, establishing the fundamental relationship between wave speed, grid spacing, and the maximum stable time step .",
            "id": "3518897",
            "problem": "Consider a one-dimensional passive scalar $u(x,t)$ being advected at a constant velocity $a$ in a partitioned multiphysics setting, where the scalar $u$ represents a field exchanged with a second physics module through an explicit, lagged coupling. The governing partial differential equation (PDE) for the transport step is $u_{t} + a\\,u_{x} = 0$ on a periodic domain of length $L$ with a uniform grid spacing $\\Delta x = L/N$, where $N$ is a positive integer. The coupling to the second physics module is algebraic and lagged in time, so that during the explicit transport update it does not alter the spatial operator acting on $u$.\n\nYou discretize the transport equation using a first-order upwind finite difference in space and a forward Euler update in time with step $\\Delta t$. The upwind stencil must be chosen according to the sign of $a$ to ensure physical upwinding. Assume periodic boundary conditions and represent grid values by $u_{j}^{n} \\approx u(j\\,\\Delta x, n\\,\\Delta t)$ for all integer indices $j$ and time levels $n$.\n\nUsing von Neumann (Fourier) stability analysis, derive the amplification factor for this scheme and determine the condition on $\\Delta t$ such that the magnitude of the amplification factor does not exceed unity for any Fourier mode admitted by the periodic grid. From this, extract the maximum allowable time step for stability as a closed-form expression in terms of $a$ and $\\Delta x$. Report this maximum stable time step, and express your final answer in seconds. Do not quote any pre-existing Courant-Friedrichs-Lewy (CFL) condition; instead, derive it directly from the discrete update and the Fourier-mode ansatz. The final answer must be a single analytic expression.",
            "solution": "The problem is first validated to ensure it is scientifically sound, self-contained, and well-posed.\n\n### Step 1: Extract Givens\n- **Governing PDE**: $u_{t} + a\\,u_{x} = 0$, where $u(x,t)$ is a passive scalar and $a$ is a constant advection velocity.\n- **Domain**: Periodic with length $L$.\n- **Grid**: Uniform spacing $\\Delta x = L/N$ for positive integer $N$.\n- **Temporal Discretization**: Forward Euler with time step $\\Delta t$.\n- **Spatial Discretization**: First-order upwind finite difference.\n- **Boundary Conditions**: Periodic.\n- **Notation**: $u_{j}^{n} \\approx u(j\\,\\Delta x, n\\,\\Delta t)$.\n- **Analysis Method**: von Neumann stability analysis.\n- **Objective**: Derive the amplification factor and find the maximum stable time step $\\Delta t_{max}$ as a function of $a$ and $\\Delta x$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem addresses the stability of a standard numerical scheme (Forward Time, Upwind Space) for the linear advection equation, a cornerstone of computational fluid dynamics. The use of von Neumann analysis is the correct and standard procedure for this type of problem. The setup is scientifically rigorous.\n- **Well-Posedness**: The problem is clearly defined with all necessary components: the PDE, discretization method, boundary conditions, and the question to be answered. A unique, well-defined stability criterion exists for this scheme.\n- **Objectivity**: The problem is stated in precise, objective, and standard mathematical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a classic and well-posed problem in numerical analysis. The solution process will now proceed.\n\n### Derivation of the Stability Condition\n\nThe governing partial differential equation is:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nWe discretize this equation using a forward difference in time (Forward Euler) and a first-order upwind difference in space. The choice of the upwind stencil depends on the sign of the advection velocity $a$.\n\nThe time derivative is approximated as:\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n$$\nThe spatial derivative, $\\frac{\\partial u}{\\partial x}$, is approximated based on the direction from which information is \"upwind\".\n\n**Case 1: $a > 0$**\nIf the velocity $a$ is positive, the wave propagates from left to right. The upwind direction is to the left, so we use a backward difference for the spatial derivative:\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x}\n$$\nSubstituting these approximations into the PDE, $u_t = -a u_x$, yields the discrete update equation:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = -a \\left( \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x} \\right)\n$$\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a \\Delta t}{\\Delta x} (u_{j}^{n} - u_{j-1}^{n})\n$$\n\n**Case 2: $a < 0$**\nIf the velocity $a$ is negative, the wave propagates from right to left. The upwind direction is to the right, so we use a forward difference for the spatial derivative:\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x}\n$$\nSubstituting into the PDE gives the discrete update equation:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = -a \\left( \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x} \\right)\n$$\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a \\Delta t}{\\Delta x} (u_{j+1}^{n} - u_{j}^{n})\n$$\n\nNow, we perform von Neumann stability analysis. We consider a single Fourier mode of the solution on the grid:\n$$\nu_{j}^{n} = G^{n} e^{i k x_{j}} = G^{n} e^{i k j \\Delta x}\n$$\nwhere $k$ is the wavenumber, $i = \\sqrt{-1}$, and $G$ is the amplification factor per time step. For the scheme to be stable, the magnitude of the amplification factor must not exceed unity for any possible wavenumber, i.e., $|G| \\le 1$.\n\nLet's re-analyze both cases using this ansatz.\n\n**Stability Analysis for $a > 0$**\nWe substitute the Fourier mode into the discrete equation for $a > 0$:\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{\\Delta x} \\left( G^{n} e^{i k j \\Delta x} - G^{n} e^{i k (j-1) \\Delta x} \\right)\n$$\nLet's define the Courant number $\\sigma = \\frac{a \\Delta t}{\\Delta x}$. Since $a > 0$, $\\sigma$ is positive. Dividing the entire equation by $G^n e^{i k j \\Delta x}$ gives the amplification factor $G$:\n$$\nG = 1 - \\sigma \\left( 1 - e^{-i k \\Delta x} \\right)\n$$\nLet $\\theta = k \\Delta x$ be the dimensionless wavenumber.\n$$\nG = 1 - \\sigma (1 - (\\cos\\theta - i\\sin\\theta)) = (1 - \\sigma + \\sigma\\cos\\theta) + i\\sigma\\sin\\theta\n$$\nThe squared magnitude of the amplification factor is $|G|^2$:\n$$\n|G|^2 = (1 - \\sigma + \\sigma\\cos\\theta)^2 + (\\sigma\\sin\\theta)^2\n$$\n$$\n|G|^2 = (1 - \\sigma(1 - \\cos\\theta))^2 + \\sigma^2 \\sin^2\\theta\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)^2 + \\sigma^2\\sin^2\\theta\n$$\nUsing $\\sin^2\\theta = (1-\\cos\\theta)(1+\\cos\\theta)$:\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)^2 + \\sigma^2(1 - \\cos\\theta)(1 + \\cos\\theta)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta) [ (1 - \\cos\\theta) + (1 + \\cos\\theta) ]\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)(2)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + 2\\sigma^2(1 - \\cos\\theta)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\sigma)(1 - \\cos\\theta)\n$$\nFor stability, we require $|G|^2 \\le 1$. This implies $1 - 2\\sigma(1 - \\sigma)(1 - \\cos\\theta) \\le 1$, which simplifies to:\n$$\n-2\\sigma(1 - \\sigma)(1 - \\cos\\theta) \\le 0\n$$\nSince $\\sigma = \\frac{a \\Delta t}{\\Delta x} > 0$ and $(1 - \\cos\\theta) \\ge 0$ for all real $\\theta$, the inequality holds if and only if:\n$$\n1 - \\sigma \\ge 0 \\implies \\sigma \\le 1\n$$\nSo, for $a > 0$, the stability condition is $\\frac{a \\Delta t}{\\Delta x} \\le 1$.\n\n**Stability Analysis for $a < 0$**\nWe substitute the Fourier mode into the discrete equation for $a < 0$:\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{\\Delta x} \\left( G^{n} e^{i k (j+1) \\Delta x} - G^{n} e^{i k j \\Delta x} \\right)\n$$\nAgain, let $\\sigma = \\frac{a \\Delta t}{\\Delta x}$. Since $a < 0$, $\\sigma$ is negative. Dividing by $G^n e^{i k j \\Delta x}$ gives:\n$$\nG = 1 - \\sigma (e^{i k \\Delta x} - 1)\n$$\nLet's define a non-negative Courant number $C = \\frac{|a| \\Delta t}{\\Delta x}$. Then $\\sigma = -C$. Substituting this into the expression for $G$:\n$$\nG = 1 - (-C) (e^{i\\theta} - 1) = 1 + C(e^{i\\theta} - 1)\n$$\n$$\nG = 1 + C(\\cos\\theta - 1 + i\\sin\\theta) = (1 - C + C\\cos\\theta) + iC\\sin\\theta\n$$\nThis expression for $G$ is identical in form to the one derived for $a > 0$ with $\\sigma$ replaced by $C$. The subsequent derivation for $|G|^2$ is therefore identical, replacing $\\sigma$ with $C$:\n$$\n|G|^2 = 1 - 2C(1 - C)(1 - \\cos\\theta)\n$$\nFor stability, $|G|^2 \\le 1$, which requires $-2C(1 - C)(1 - \\cos\\theta) \\le 0$.\nSince $C = \\frac{|a| \\Delta t}{\\Delta x} > 0$ and $(1 - \\cos\\theta) \\ge 0$, the inequality holds if and only if:\n$$\n1 - C \\ge 0 \\implies C \\le 1\n$$\nSo, for $a < 0$, the stability condition is $\\frac{|a| \\Delta t}{\\Delta x} \\le 1$.\n\n**Conclusion**\nBoth cases lead to the same stability requirement, which can be expressed compactly using the absolute value of the velocity:\n$$\n\\frac{|a| \\Delta t}{\\Delta x} \\le 1\n$$\nThis is the Courant-Friedrichs-Lewy (CFL) condition for the first-order upwind scheme. The problem asks for the maximum allowable time step, $\\Delta t_{max}$, for which the scheme is stable. This is obtained when the condition is at its limit:\n$$\n\\frac{|a| \\Delta t_{max}}{\\Delta x} = 1\n$$\nSolving for $\\Delta t_{max}$ gives the final expression.\n$$\n\\Delta t_{max} = \\frac{\\Delta x}{|a|}\n$$\nThis expression represents the maximum time step that ensures numerical stability for any Fourier mode that the grid can resolve. It has the physical interpretation that in a single time step, information cannot travel further than a single grid cell.",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "Real-world multiphysics simulations often involve coupling domains with vastly different characteristic speeds, such as in fluid-structure interaction. A single global time step dictated by the fastest region is computationally wasteful, making such simulations intractable. This advanced practice introduces local time-stepping (or subcycling) as an efficient solution, challenging you to adapt the fundamental CFL constraint to a multi-rate system and determine the maximum stable global time step for a coupled problem .",
            "id": "3518854",
            "problem": "A one-dimensional coupled hyperbolic transport problem consists of two subdomains, $\\Omega_{1}$ for $x<0$ and $\\Omega_{2}$ for $x>0$, coupled at the interface $x=0$. Each subdomain is governed by a linear conservation law of the form $\\partial_{t} u + \\partial_{x} f(u) = 0$, where, over the time interval of interest, the characteristic wave speed magnitude is bounded by a constant $c_{i}$ in $\\Omega_{i}$, $i \\in \\{1,2\\}$. The spatial discretization in each $\\Omega_{i}$ is a uniform grid with cell size $\\Delta x_{i}$, and the temporal discretization is an explicit first-order finite volume method (FVM) with forward-Euler time stepping and an upwind numerical flux. To limit numerical dissipation while ensuring stability, a Courant-Friedrichs-Lewy (CFL) safety factor $C^{\\star}$ with $0<C^{\\star}\\leq 1$ is imposed on all local updates.\n\nTo accommodate different wave speeds and mesh resolutions, you will employ local time stepping (subcycling): introduce a global macro time step $\\Delta T$ and choose integers $n_{1}$ and $n_{2}$ so that the local time steps are $\\Delta t_{1}=\\Delta T/n_{1}$ in $\\Omega_{1}$ and $\\Delta t_{2}=\\Delta T/n_{2}$ in $\\Omega_{2}$. At the interface, the numerical flux is evaluated consistently on a partition of $[t^{m},t^{m}+\\Delta T]$ obtained by taking the ordered union of the substep boundaries in $\\Omega_{1}$ and $\\Omega_{2}$; over each sub-interval, the interface states are piecewise constant, a Riemann solver is used to compute a single interface flux for that sub-interval, and equal-and-opposite flux contributions are accumulated into the adjacent control volumes on both sides to preserve conservation.\n\nStarting from the finite volume update for a linear advection law, and the definition of the CFL condition for an explicit upwind method, derive a stability constraint on $\\Delta T$ that ensures the subdomain Courant numbers remain bounded by $C^{\\star}$ in both subdomains while preserving global conservation at the interface under the subcycling strategy described above. Then, under the additional computational constraint that the subcycling factors are bounded by $n_{1} \\leq N_{1}^{\\max}$ and $n_{2} \\leq N_{2}^{\\max}$, determine the maximal admissible macro time step $\\Delta T_{\\max}$.\n\nUse the following data:\n- $c_{1} = 2500\\,\\mathrm{m/s}$, $c_{2} = 600\\,\\mathrm{m/s}$,\n- $\\Delta x_{1} = 0.5\\,\\mathrm{m}$, $\\Delta x_{2} = 0.2\\,\\mathrm{m}$,\n- $C^{\\star} = 0.9$,\n- $N_{1}^{\\max} = 8$, $N_{2}^{\\max} = 10$.\n\nExpress the final answer for $\\Delta T_{\\max}$ in milliseconds, and round your answer to four significant figures.",
            "solution": "The problem requires the derivation of a stability constraint for a coupled system solved with local time stepping (subcycling), and subsequently finding the maximum possible global time step, $\\Delta T_{\\max}$, under given constraints.\n\nThe numerical scheme is an explicit first-order finite volume method with an upwind flux for a linear conservation law. The stability of such a scheme is governed by the Courant-Friedrichs-Lewy (CFL) condition. For a one-dimensional problem in a subdomain $\\Omega_i$ with characteristic wave speed $c_i$, uniform grid spacing $\\Delta x_i$, and time step $\\Delta t_i$, the Courant number is defined as:\n$$\n\\text{Cr}_i = \\frac{c_i \\Delta t_i}{\\Delta x_i}\n$$\nThe problem states that for stability, the Courant number in each subdomain must be bounded by a safety factor $C^{\\star}$, where $0 < C^{\\star} \\leq 1$. This imposes two conditions, one for each subdomain $\\Omega_i$, $i \\in \\{1,2\\}$:\n$$\n\\frac{c_1 \\Delta t_1}{\\Delta x_1} \\leq C^{\\star}\n$$\n$$\n\\frac{c_2 \\Delta t_2}{\\Delta x_2} \\leq C^{\\star}\n$$\nThe local time stepping strategy relates the local time steps, $\\Delta t_1$ and $\\Delta t_2$, to a global macro time step, $\\Delta T$, via integer subcycling factors, $n_1$ and $n_2$:\n$$\n\\Delta t_1 = \\frac{\\Delta T}{n_1} \\quad \\text{and} \\quad \\Delta t_2 = \\frac{\\Delta T}{n_2}\n$$\nSubstituting these expressions into the stability inequalities gives:\n$$\n\\frac{c_1 (\\Delta T / n_1)}{\\Delta x_1} \\leq C^{\\star} \\implies \\Delta T \\leq n_1 \\frac{C^{\\star} \\Delta x_1}{c_1}\n$$\n$$\n\\frac{c_2 (\\Delta T / n_2)}{\\Delta x_2} \\leq C^{\\star} \\implies \\Delta T \\leq n_2 \\frac{C^{\\star} \\Delta x_2}{c_2}\n$$\nFor the overall method to be stable, the global time step $\\Delta T$ must satisfy both conditions simultaneously for a chosen pair of integers $(n_1, n_2)$. This leads to the combined stability constraint on $\\Delta T$:\n$$\n\\Delta T \\leq \\min \\left( n_1 \\frac{C^{\\star} \\Delta x_1}{c_1}, n_2 \\frac{C^{\\star} \\Delta x_2}{c_2} \\right)\n$$\nThis expression is the general stability constraint on $\\Delta T$ for any valid pair of subcycling factors $(n_1, n_2)$. The description of the interface flux calculation confirms a conservative coupling which does not introduce more restrictive stability constraints than those arising from the explicit updates within each subdomain.\n\nThe second part of the problem is to find the maximal admissible macro time step, $\\Delta T_{\\max}$, given the bounds on the subcycling factors: $1 \\leq n_1 \\leq N_1^{\\max}$ and $1 \\leq n_2 \\leq N_2^{\\max}$. We need to maximize the upper bound on $\\Delta T$ over all permitted integer pairs $(n_1, n_2)$:\n$$\n\\Delta T_{\\max} = \\max_{\\substack{1 \\leq n_1 \\leq N_1^{\\max} \\\\ 1 \\leq n_2 \\leq N_2^{\\max}}} \\left\\{ \\min \\left( n_1 \\frac{C^{\\star} \\Delta x_1}{c_1}, n_2 \\frac{C^{\\star} \\Delta x_2}{c_2} \\right) \\right\\}\n$$\nLet us define the characteristic stable time steps for unitary subcycling ($n_i=1$) as $\\Delta \\tau_i = \\frac{C^{\\star} \\Delta x_i}{c_i}$. The function to maximize is $F(n_1, n_2) = \\min(n_1 \\Delta \\tau_1, n_2 \\Delta \\tau_2)$. Since $\\Delta \\tau_1 > 0$ and $\\Delta \\tau_2 > 0$, the function $F(n_1, n_2)$ is a non-decreasing function of both $n_1$ and $n_2$. Therefore, its maximum value over the rectangular domain of integers $[1, N_1^{\\max}] \\times [1, N_2^{\\max}]$ must occur at the corner where both variables are maximal, i.e., at $(n_1, n_2) = (N_1^{\\max}, N_2^{\\max})$.\n\nThus, the maximal macro time step is found by setting $n_1 = N_1^{\\max}$ and $n_2 = N_2^{\\max}$:\n$$\n\\Delta T_{\\max} = \\min \\left( N_1^{\\max} \\frac{C^{\\star} \\Delta x_1}{c_1}, N_2^{\\max} \\frac{C^{\\star} \\Delta x_2}{c_2} \\right)\n$$\nNow, we substitute the given numerical values:\n- $c_1 = 2500\\,\\mathrm{m/s}$\n- $c_2 = 600\\,\\mathrm{m/s}$\n- $\\Delta x_1 = 0.5\\,\\mathrm{m}$\n- $\\Delta x_2 = 0.2\\,\\mathrm{m}$\n- $C^{\\star} = 0.9$\n- $N_1^{\\max} = 8$\n- $N_2^{\\max} = 10$\n\nWe calculate the two arguments of the minimum function:\nThe term for the first subdomain is:\n$$\nN_1^{\\max} \\frac{C^{\\star} \\Delta x_1}{c_1} = 8 \\times \\frac{0.9 \\times 0.5}{2500} = 8 \\times \\frac{0.45}{2500} = \\frac{3.6}{2500} = 0.00144\\,\\mathrm{s}\n$$\nThe term for the second subdomain is:\n$$\nN_2^{\\max} \\frac{C^{\\star} \\Delta x_2}{c_2} = 10 \\times \\frac{0.9 \\times 0.2}{600} = 10 \\times \\frac{0.18}{600} = \\frac{1.8}{600} = 0.003\\,\\mathrm{s}\n$$\nNow, we find the minimum of these two values to determine $\\Delta T_{\\max}$:\n$$\n\\Delta T_{\\max} = \\min(0.00144\\,\\mathrm{s}, 0.003\\,\\mathrm{s}) = 0.00144\\,\\mathrm{s}\n$$\nThe problem requires the answer to be in milliseconds (ms) and rounded to four significant figures.\n$$\n\\Delta T_{\\max} = 0.00144\\,\\mathrm{s} \\times \\frac{1000\\,\\mathrm{ms}}{1\\,\\mathrm{s}} = 1.44\\,\\mathrm{ms}\n$$\nTo express $1.44$ with four significant figures, we add a trailing zero, which is significant in this context.\n$$\n\\Delta T_{\\max} = 1.440\\,\\mathrm{ms}\n$$",
            "answer": "$$\\boxed{1.440}$$"
        }
    ]
}