{
    "hands_on_practices": [
        {
            "introduction": "我们从一个基础但极具启发性的问题开始，探索带电粒子在正交电磁场中的运动。通过计算粒子在一个完整摆线周期内走过的路径弧长，我们不仅能验证其运动轨迹，还能对回旋运动和 $\\mathbf{E} \\times \\mathbf{B}$ 漂移的叠加有一个具体的、几何上的直观理解。这个问题为我们更复杂的分析奠定了坚实的运动学基础 。",
            "id": "327804",
            "problem": "一个质量为 $m$、电荷为 $q  0$ 的非相对论性粒子位于笛卡尔坐标系的原点。在时间 $t=0$ 时，该粒子处于静止状态。该区域存在均匀静磁场 $\\mathbf{B} = B \\hat{\\mathbf{z}}$ 和均匀静电场 $\\mathbf{E} = E \\hat{\\mathbf{y}}$，其中 $E$ 和 $B$ 为正常数。\n\n粒子的运动由洛伦兹力 $\\mathbf{F} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$ 控制。在这些场的作用下，粒子开始运动，在 $x-y$ 平面内描绘出一条摆线路径。当它沿着这条路径运动时，其速率会发生变化，周期性地从零增加到最大值，然后再回到零。\n\n你的任务是推导一个闭合形式的表达式，表示粒子从 $t=0$ 开始运动到第一次 $t  0$ 时再次瞬间静止所经过的总路程（弧长）$S$。请仅用参数 $m$、$q$、$E$ 和 $B$ 来表示你的答案。",
            "solution": "我们从 $x$–$y$ 平面内，在以下场中的运动所对应的洛伦兹力方程开始：\n$$\\mathbf{B}=B\\,\\hat{\\mathbf{z}},\\quad\\mathbf{E}=E\\,\\hat{\\mathbf{y}}.$$\n因此\n$$m\\frac{dv_x}{dt}=q\\,(v_yB),\\qquad m\\frac{dv_y}{dt}=q\\,(E - v_xB).$$\n定义回旋频率\n$$\\omega_c=\\frac{qB}{m},$$\n并注意到稳恒的“$\\mathbf{E}\\times\\mathbf{B}$”漂移速度\n$$v_d=\\frac{E}{B}\\,\\hat{\\mathbf{x}}\\,. $$\n设\n$$u_x=v_x-v_d,\\quad u_y=v_y$$\n这样齐次方程组变为\n$$\\frac{du_x}{dt}=\\omega_cu_y,\\qquad\\frac{du_y}{dt}=-\\omega_cu_x,$$\n其通解为圆周运动。根据初始条件 $v_x(0)=0,\\;v_y(0)=0$，可以得到\n$$v_x(t)=\\frac{E}{B}\\bigl[1-\\cos(\\omega_ct)\\bigr],\\qquad\nv_y(t)=\\frac{E}{B}\\sin(\\omega_ct).$$\n粒子第一次回到静止状态发生在 $\\omega_ct=2\\pi$ 时，即 $T=2\\pi/\\omega_c$。速率为\n$$|\\mathbf{v}|=\\sqrt{v_x^2+v_y^2}\n=\\frac{2E}{B}\\,\\sin\\!\\bigl(\\tfrac12\\omega_ct\\bigr).$$\n因此，弧长为\n$$\nS=\\int_0^T|\\mathbf{v}|\\,dt\n=\\frac{2E}{B}\\int_0^{2\\pi/\\omega_c}\\sin\\!\\bigl(\\tfrac12\\omega_ct\\bigr)\\,dt\n=\\frac{2E}{B\\,\\omega_c}\\int_0^{2\\pi}\\sin\\!\\bigl(\\tfrac\\theta2\\bigr)\\,d\\theta\n=\\frac{8E}{B\\,\\omega_c}\n=\\frac{8mE}{qB^2}\\,. $$",
            "answer": "$$\\boxed{\\frac{8mE}{qB^2}}$$"
        },
        {
            "introduction": "在解析地理解了基本运动之后，下一步是利用计算方法来验证和深化我们的认识。这个问题引导我们从基本的洛伦兹力定律出发，通过数值模拟来展示 $\\mathbf{E}\\times\\mathbf{B}$ 漂移现象，这是现代等离子体物理研究中的一项核心技能。通过实现欧拉法并引入导心坐标来滤除快速的回旋运动，我们能从复杂的粒子轨迹中精确地提取出漂移速度，从而验证理论的正确性 。",
            "id": "2390224",
            "problem": "一个电荷为 $q$、质量为 $m$ 的非相对论性点状粒子在均匀且相互垂直的电场和磁场中运动。设粒子的位置为 $\\mathbf{r}(t)$（单位：米），速度为 $\\mathbf{v}(t)$（单位：米/秒）。基本依据是牛顿第二定律和洛伦兹力定律：总力为 $\\mathbf{F} = q\\left(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}\\right)$，因此运动方程为耦合常微分方程 (ODEs)：$\\dfrac{d\\mathbf{r}}{dt} = \\mathbf{v}$ 和 $m\\dfrac{d\\mathbf{v}}{dt} = q\\left(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}\\right)$。假设所有场在空间和时间上都是恒定的，并以国际单位制 (SI) 给出。\n\n您的任务是实现并使用欧拉方法求解常微分方程，以数值方式证明 $\\mathbf{E}\\times\\mathbf{B}$ 漂移的存在。具体而言：\n\n1. 仅从牛顿第二定律和洛伦兹力（上述基本依据）出发，推导当一个恒定的垂直电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$ 作用于粒子时所产生的连续时间漂移速度的形式。解释为什么此漂移与 $q$ 和 $m$ 无关。\n2. 为上述常微分方程系统推导前向欧拉法和一种半隐式欧拉变体（先更新速度，然后使用更新后的速度更新位置）。您必须明确陈述您将要实现的更新规则。\n3. 为了在有限时间内稳健地数值提取漂移，而无需等待多次回旋，请使用导心位置来滤除回旋运动并分离出漂移。定义导心坐标\n   $$\\mathbf{R}(t) = \\mathbf{r}(t) - \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B},$$\n   并将漂移速度估算为有限时间差商\n   $$\\widehat{\\mathbf{v}}_{\\text{drift}} = \\frac{\\mathbf{R}(T) - \\mathbf{R}(0)}{T}.$$\n   解释这如何从连续时间动力学中得出，以及为什么它能消除快速的回旋运动。\n4. 实现这两种方法，并针对下述每个测试用例，计算您的数值估算漂移速度 $\\widehat{\\mathbf{v}}_{\\text{drift}}$ 与您在第一部分中从连续方程解析推导出的漂移速度之间的差值（单位：米/秒）的欧几里得范数。对于每个测试用例，报告两个浮点数：使用前向欧拉法得到的误差，后跟使用半隐式欧拉变体得到的误差。\n\n物理和数值单位：$\\mathbf{E}$ 的所有矢量分量单位为伏特/米，$\\mathbf{B}$ 的单位为特斯拉，时间单位为秒，$\\mathbf{r}$ 的单位为米，$\\mathbf{v}$ 的单位为米/秒，电荷 $q$ 的单位为库仑，质量 $m$ 的单位为千克。将所有要求的误差大小（单位：米/秒）以浮点数形式表示。\n\n测试套件和初始条件：\n- 所有情况均使用初始位置 $\\mathbf{r}(0) = (0,0,0)$（单位：米）。\n- 使用以下四组参数，涵盖一般情况、边界情况、磁场极小的边缘情况以及电荷符号反转的情况：\n  1. 情况 A (理想路径)：$q = 1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (2.0,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,0.5)$，$T = 10.0$，$\\Delta t = 0.05$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n  2. 情况 B (边界，无电场)：$q = 1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (0.0,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,0.5)$，$T = 1.0$，$\\Delta t = 0.1$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n  3. 情况 C (边缘，磁场极小)：$q = 1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (0.01,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,1.0\\times 10^{-4})$，$T = 50.0$，$\\Delta t = 0.5$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n  4. 情况 D (电荷符号反转)：$q = -1.0\\times 10^{-15}$，$m = 1.0\\times 10^{-12}$，$\\mathbf{E} = (2.0,0.0,0.0)$，$\\mathbf{B} = (0.0,0.0,0.5)$，$T = 10.0$，$\\Delta t = 0.05$，以及 $\\mathbf{v}(0) = (0.0,0.0,0.0)$。\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。\n- 列表必须按顺序为每个情况包含两个浮点数：首先是前向欧拉误差（单位：米/秒），然后是半隐式欧拉误差（单位：米/秒）。对于这四个情况，输出必须总共包含8个数字，顺序为 $\\left[\\text{A-FE},\\text{A-SE},\\text{B-FE},\\text{B-SE},\\text{C-FE},\\text{C-SE},\\text{D-FE},\\text{D-SE}\\right]$。",
            "solution": "所提出的问题是有效的。它基于经典电动力学的基本原理，即洛伦兹力定律和牛顿第二定律，并在计算物理学中构成了一个定义明确的初值问题。所有必要的参数和条件均已提供，且不存在科学或逻辑上的矛盾。我们将着手进行严谨的求解。\n\n带电粒子在正交电磁场中的运动是一个典型问题。其轨迹是平行于磁场的匀速运动、垂直于磁场平面内的圆周回旋运动，以及该回旋中心的稳定漂移（也垂直于磁场）的叠加。我们的目标是首先解析地推导出该漂移速度，然后使用欧拉方法的两种变体在数值上证明其存在。\n\n**1. 漂移速度的解析推导**\n\n一个电荷为 $q$、质量为 $m$ 的粒子的运动方程由牛顿第二定律和洛伦兹力组合给出：\n$$m\\frac{d\\mathbf{v}}{dt} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$$\n我们寻求速度 $\\mathbf{v}$ 的解。让我们将速度分解为平行于磁场 $\\mathbf{B}$ 和垂直于磁场 $\\mathbf{B}$ 的分量：$\\mathbf{v} = \\mathbf{v}_{\\|} + \\mathbf{v}_{\\perp}$。电场也同样分解为 $\\mathbf{E} = \\mathbf{E}_{\\|} + \\mathbf{E}_{\\perp}$。运动方程可以分解为两部分：\n$$m\\frac{d\\mathbf{v}_{\\|}}{dt} = q\\mathbf{E}_{\\|}$$\n$$m\\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\n问题陈述了场是相互垂直的，所以 $\\mathbf{E} \\cdot \\mathbf{B} = 0$，这意味着 $\\mathbf{E}_{\\|} = 0$。因此，$\\frac{d\\mathbf{v}_{\\|}}{dt} = 0$，平行于 $\\mathbf{B}$ 的速度分量是恒定的。\n\n垂直方向的运动更为复杂。我们假设垂直速度 $\\mathbf{v}_{\\perp}$ 可以表示为一个恒定的漂移速度 $\\mathbf{v}_D$ 和一个随时间变化的回旋速度 $\\mathbf{u}(t)$ 的和：$\\mathbf{v}_{\\perp} = \\mathbf{v}_D + \\mathbf{u}(t)$。漂移速度代表一个稳态解，在该解中，垂直平面内的合力平均为零。存在一个特定的恒定速度 $\\mathbf{v}_D$，使得电场力和磁场力完全平衡。我们通过将垂直加速度设为零并将 $\\mathbf{v}_{\\perp}$ 替换为 $\\mathbf{v}_D$ 来求得此速度：\n$$0 = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_D \\times \\mathbf{B})$$\n$$\\mathbf{E}_{\\perp} = -(\\mathbf{v}_D \\times \\mathbf{B})$$\n为了解出 $\\mathbf{v}_D$，我们对该方程与 $\\mathbf{B}$ 作叉积：\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -(\\mathbf{v}_D \\times \\mathbf{B}) \\times \\mathbf{B}$$\n使用矢量三重积恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$，我们得到：\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -[\\mathbf{B}(\\mathbf{v}_D \\cdot \\mathbf{B}) - \\mathbf{v}_D(\\mathbf{B} \\cdot \\mathbf{B})]$$\n漂移速度 $\\mathbf{v}_D$ 是对垂直力的响应，因此它必须垂直于 $\\mathbf{B}$，即 $\\mathbf{v}_D \\cdot \\mathbf{B} = 0$。方程简化为：\n$$\\mathbf{E}_{\\perp} \\times \\mathbf{B} = -[-\\mathbf{v}_D(\\mathbf{B} \\cdot \\mathbf{B})] = \\mathbf{v}_D \\|\\mathbf{B}\\|^2$$\n由于 $\\mathbf{E}_{\\perp} = \\mathbf{E}$，我们得到 $\\mathbf{E} \\times \\mathbf{B}$ 漂移速度的表达式：\n$$\\mathbf{v}_D = \\frac{\\mathbf{E} \\times \\mathbf{B}}{\\|\\mathbf{B}\\|^2}$$\n此推导表明，漂移速度 $\\mathbf{v}_D$ 仅取决于电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$。它从根本上与粒子的电荷 $q$ 和质量 $m$ 无关。电荷和质量的大小仅影响叠加的回旋运动的特性（其频率和半径），而不影响导心漂移的速度。电荷 $q$ 的符号会反转回旋的方向，但漂移方向保持不变。\n\n**2. 数值积分方案的推导**\n\n待求解的方程组是一组两个耦合的一阶常微分方程 (ODEs)：\n$$ \\frac{d\\mathbf{r}}{dt} = \\mathbf{v} $$\n$$ \\frac{d\\mathbf{v}}{dt} = \\frac{q}{m}(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) = \\mathbf{a}(\\mathbf{v}) $$\n我们用一个恒定的步长 $\\Delta t$ 将时间离散化，使得 $t_n = n\\Delta t$。系统在时间 $t_n$ 的状态为 $(\\mathbf{r}_n, \\mathbf{v}_n)$。\n\n**前向欧拉 (FE) 法**是一种显式一阶方法。它使用在第 $n$ 步计算的导数来近似第 $n+1$ 步的状态：\n$$ \\mathbf{v}_{n+1} = \\mathbf{v}_n + \\Delta t \\cdot \\mathbf{a}(\\mathbf{v}_n) = \\mathbf{v}_n + \\Delta t \\frac{q}{m}(\\mathbf{E} + \\mathbf{v}_n \\times \\mathbf{B}) $$\n$$ \\mathbf{r}_{n+1} = \\mathbf{r}_n + \\Delta t \\cdot \\mathbf{v}_n $$\n这种方法很简单，但以其较差的稳定性而闻名，特别是对于振荡系统，它会人为地增加系统的能量。\n\n**半隐式欧拉 (SE) 法**，也称为欧拉-克罗默方法，是一种提高稳定性的变体。按照规定，我们首先更新速度，然后使用这个新计算出的速度来更新位置。这引入了一种隐式成分，对于哈密顿系统，它能显著改善能量守恒。更新规则如下：\n$$ \\mathbf{v}_{n+1} = \\mathbf{v}_n + \\Delta t \\cdot \\mathbf{a}(\\mathbf{v}_n) = \\mathbf{v}_n + \\Delta t \\frac{q}{m}(\\mathbf{E} + \\mathbf{v}_n \\times \\mathbf{B}) $$\n$$ \\mathbf{r}_{n+1} = \\mathbf{r}_n + \\Delta t \\cdot \\mathbf{v}_{n+1} $$\n与前向欧拉法相比，这种辛积分器预期能为回旋粒子产生更准确的长期轨迹。\n\n**3. 用于漂移估算的导心位置**\n\n完整的粒子轨迹 $\\mathbf{r}(t)$ 是一条复杂的摆线路径，它是快速回旋运动叠加在较慢的导心漂移之上产生的结果。为了在数值上提取漂移速度，我们必须滤除振荡的回旋运动。导心位置 $\\mathbf{R}(t)$ 代表了粒子圆周回旋的中心。在问题中它被定义为：\n$$\\mathbf{R}(t) = \\mathbf{r}(t) - \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B}$$\n第二项 $\\boldsymbol{\\rho}_{est}(t) = \\frac{m}{q\\|\\mathbf{B}\\|^2}\\,\\mathbf{v}(t) \\times \\mathbf{B}$ 是回旋半径矢量的近似，该矢量是从导心指向粒子位置的矢量。通过从粒子的瞬时位置 $\\mathbf{r}(t)$ 中减去这一项，我们得到了导心位置的估计值。这种减法有效地从位置数据中移除了振荡运动的最大分量。\n\n这个估算的导心的瞬时速度 $\\frac{d\\mathbf{R}}{dt}$ 并非完全恒定。它包含真实的导心速度（在我们的例子中是 $\\mathbf{v}_D$，因为 $\\mathbf{v}_{\\|}(0)=0$）以及一个以回旋频率振荡的残余项。为了消除这种残余振荡，我们在总模拟时间 $T$ 上对导心速度进行平均。这通过计算有限差分商来实现：\n$$\\widehat{\\mathbf{v}}_{\\text{drift}} = \\frac{\\mathbf{R}(T) - \\mathbf{R}(0)}{T}$$\n这个计算等效于 $\\frac{1}{T}\\int_0^T \\frac{d\\mathbf{R}}{dt'} dt'$。当时间 $T$ 远大于回旋周期时，振荡部分的积分与恒定漂移的积分相比变得可以忽略不计，从而得出一个数值上稳健的平均漂移速度估计。对于给定的初始条件 $\\mathbf{r}(0) = \\mathbf{0}$ 和 $\\mathbf{v}(0) = \\mathbf{0}$，初始导心位置为 $\\mathbf{R}(0) = \\mathbf{0}$，从而将估计简化为 $\\widehat{\\mathbf{v}}_{\\text{drift}} = \\mathbf{R}(T)/T$。\n\n**4. 计算流程**\n\n对于每个测试用例，我们执行以下步骤：\n1.  计算解析漂移速度 $\\mathbf{v}_D = \\frac{\\mathbf{E} \\times \\mathbf{B}}{\\|\\mathbf{B}\\|^2}$。\n2.  使用前向欧拉法运行从 $t=0$ 到 $t=T$ 的模拟，以找到最终状态 $(\\mathbf{r}_{FE}(T), \\mathbf{v}_{FE}(T))$。\n3.  计算最终导心位置 $\\mathbf{R}_{FE}(T)$ 和数值漂移 $\\widehat{\\mathbf{v}}_{\\text{drift, FE}} = (\\mathbf{R}_{FE}(T) - \\mathbf{R}(0))/T$。\n4.  计算前向欧拉法的误差，即欧几里得范数 $E_{FE} = \\|\\widehat{\\mathbf{v}}_{\\text{drift, FE}} - \\mathbf{v}_D\\|$。\n5.  使用半隐式欧拉法重复步骤 2-4，以找到 $(\\mathbf{r}_{SE}(T), \\mathbf{v}_{SE}(T))$、$\\widehat{\\mathbf{v}}_{\\text{drift, SE}}$ 和相应的误差 $E_{SE} = \\|\\widehat{\\mathbf{v}}_{\\text{drift, SE}} - \\mathbf{v}_D\\|$。\n6.  计算出的误差对 $(E_{FE}, E_{SE})$ 构成了该测试用例的结果。对所有指定的用例重复此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the error in numerically estimated E x B drift velocity\n    using Forward Euler and Semi-Implicit Euler methods.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([2.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 10.0, \"dt\": 0.05,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case B (boundary, no electric field)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([0.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 1.0, \"dt\": 0.1,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case C (edge, very small magnetic field)\n        {\n            \"q\": 1.0e-15, \"m\": 1.0e-12, \"E\": np.array([0.01, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 1.0e-4]), \"T\": 50.0, \"dt\": 0.5,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        },\n        # Case D (sign reversal of charge)\n        {\n            \"q\": -1.0e-15, \"m\": 1.0e-12, \"E\": np.array([2.0, 0.0, 0.0]),\n            \"B\": np.array([0.0, 0.0, 0.5]), \"T\": 10.0, \"dt\": 0.05,\n            \"v0\": np.array([0.0, 0.0, 0.0]), \"r0\": np.array([0.0, 0.0, 0.0])\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        q, m, E, B = case[\"q\"], case[\"m\"], case[\"E\"], case[\"B\"]\n        T, dt, v0, r0 = case[\"T\"], case[\"dt\"], case[\"v0\"], case[\"r0\"]\n\n        B_norm_sq = np.dot(B, B)\n\n        # Calculate analytical drift velocity\n        if B_norm_sq  0:\n            v_drift_analytical = np.cross(E, B) / B_norm_sq\n        else:\n            v_drift_analytical = np.array([0.0, 0.0, 0.0])\n            \n        num_steps = int(round(T / dt))\n\n        # --- Forward Euler Method ---\n        r = np.copy(r0)\n        v = np.copy(v0)\n        \n        for _ in range(num_steps):\n            a = (q / m) * (E + np.cross(v, B))\n            r_next = r + v * dt\n            v_next = v + a * dt\n            r, v = r_next, v_next\n        \n        r_final_fe, v_final_fe = r, v\n        \n        # --- Semi-Implicit Euler Method ---\n        r = np.copy(r0)\n        v = np.copy(v0)\n        \n        for _ in range(num_steps):\n            a = (q / m) * (E + np.cross(v, B))\n            v_next = v + a * dt\n            r_next = r + v_next * dt\n            r, v = r_next, v_next\n            \n        r_final_se, v_final_se = r, v\n\n        # --- Calculate errors ---\n        # Guiding center position R_0 at t=0 is r0 since v0 is zero\n        R0 = r0\n        \n        # Error for Forward Euler\n        if B_norm_sq  0:\n            R_T_fe = r_final_fe - (m / (q * B_norm_sq)) * np.cross(v_final_fe, B)\n        else: # Handle B=0 case, though not in test suite\n            R_T_fe = r_final_fe\n            \n        v_drift_fe_numerical = (R_T_fe - R0) / T\n        error_fe = np.linalg.norm(v_drift_fe_numerical - v_drift_analytical)\n        results.append(error_fe)\n\n        # Error for Semi-Implicit Euler\n        if B_norm_sq  0:\n            R_T_se = r_final_se - (m / (q * B_norm_sq)) * np.cross(v_final_se, B)\n        else: # Handle B=0 case\n            R_T_se = r_final_se\n\n        v_drift_se_numerical = (R_T_se - R0) / T\n        error_se = np.linalg.norm(v_drift_se_numerical - v_drift_analytical)\n        results.append(error_se)\n\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后，我们将粒子动力学的研究推向一个高潮，将其与聚变等离子体中至关重要的能量交换和加热问题联系起来。这个问题不再仅仅关注轨迹的描述，而是要求我们量化粒子从电场中获取能量的平均速率。通过推导回旋周期平均的功率输入，我们可以揭示即使在强磁场约束下，电场依然能够对粒子进行有效加热的物理机制，其结果直接对应着欧姆加热等真实世界中的等离子体加热方式 。",
            "id": "3710047",
            "problem": "一个质量为 $m$、电荷为 $q$ 的带电聚变离子，在均匀且不随时间变化的电场 $\\mathbf{E}$ 和磁场 $\\mathbf{B}$ 中运动。磁场大小为 $B$，并定义了一个单位矢量 $\\mathbf{b} = \\mathbf{B}/B$。电场大小为 $E$，其方向与 $\\mathbf{B}$ 成任意角度 $\\theta$，因此其平行分量为 $E_{\\parallel} = E \\cos\\theta$，垂直分量为 $E_{\\perp} = E \\sin\\theta$。在时间 $t=0$ 时，粒子的平行速度为 $v_{\\parallel 0}$，垂直速度是围绕 $\\mathbf{b}$ 的任意回旋运动。\n\n从洛伦兹力定律 $m\\,d\\mathbf{v}/dt = q\\left(\\mathbf{E} + \\mathbf{v}\\times\\mathbf{B}\\right)$ 和运动学定义 $d\\mathbf{r}/dt = \\mathbf{v}$ 出发，推导瞬时输入功率 $q\\,\\mathbf{E}\\cdot\\mathbf{v}$ 在一个回旋周期 $\\displaystyle T_c = \\frac{2\\pi m}{|q| B}$ 内的回旋周期平均值，对于任意 $\\theta$。将你的最终答案表示为一个关于 $q$、$m$、$B$、$E$、$\\theta$ 和 $v_{\\parallel 0}$ 的单一闭合形式解析表达式，然后简要解释结果中每一项在核聚变等离子体背景下的物理意义。无需进行数值计算。最终答案必须是单一的解析表达式；不要在最终答案框中包含单位。",
            "solution": "所述问题具有科学依据，提法恰当，客观且内部一致。它代表了等离子体物理学中一个基于洛伦兹力定律的，关于带电粒子在均匀电磁场中运动的基本计算。没有发现任何缺陷。因此，我们可以进行推导。\n\n目标是计算施加于带电粒子的瞬时输入功率的回旋周期平均值 $\\langle P \\rangle$。电场 $\\mathbf{E}$ 施加于一个电荷为 $q$、速度为 $\\mathbf{v}$ 的粒子的瞬时功率 $P(t)$ 由下式给出：\n$$P(t) = q \\mathbf{E} \\cdot \\mathbf{v}(t)$$\n回旋周期平均值定义为\n$$\\langle P \\rangle = \\frac{1}{T_c} \\int_0^{T_c} P(t) \\,dt = \\frac{q}{T_c} \\int_0^{T_c} \\mathbf{E} \\cdot \\mathbf{v}(t) \\,dt$$\n其中 $T_c = \\frac{2\\pi m}{|q| B}$ 是回旋周期。\n\n为解决此问题，我们将矢量分解为平行于 ($\\parallel$) 和垂直于 ($\\perp$) 磁场 $\\mathbf{B} = B\\mathbf{b}$ 的分量。\n电场为 $\\mathbf{E} = \\mathbf{E}_{\\parallel} + \\mathbf{E}_{\\perp}$，其中 $\\mathbf{E}_{\\parallel} = (E \\cos\\theta) \\mathbf{b}$ 且 $|\\mathbf{E}_{\\perp}| = E \\sin\\theta$。\n粒子的速度为 $\\mathbf{v}(t) = \\mathbf{v}_{\\parallel}(t) + \\mathbf{v}_{\\perp}(t)$，其中 $\\mathbf{v}_{\\parallel}(t) = v_{\\parallel}(t) \\mathbf{b}$。\n\n功率表达式可以使用这些分量展开：\n$$P(t) = q (\\mathbf{E}_{\\parallel} + \\mathbf{E}_{\\perp}) \\cdot (\\mathbf{v}_{\\parallel}(t) + \\mathbf{v}_{\\perp}(t))$$\n由于平行矢量和垂直矢量相互正交（即 $\\mathbf{E}_{\\parallel} \\cdot \\mathbf{v}_{\\perp} = 0$ 和 $\\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\parallel} = 0$），上式简化为：\n$$P(t) = q (\\mathbf{E}_{\\parallel} \\cdot \\mathbf{v}_{\\parallel}(t) + \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t)) = q(E_{\\parallel} v_{\\parallel}(t) + \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t))$$\n平均功率是这两项平均值的和：\n$$\\langle P \\rangle = \\frac{q}{T_c} \\int_0^{T_c} E_{\\parallel} v_{\\parallel}(t) \\,dt + \\frac{q}{T_c} \\int_0^{T_c} \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t) \\,dt$$\n\n让我们通过首先考虑从洛伦兹力定律 $m\\frac{d\\mathbf{v}}{dt} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B})$ 推导出的运动方程来分别分析每一项。\n\n运动方程的平行分量是：\n$$m \\frac{d\\mathbf{v}_{\\parallel}}{dt} \\cdot \\mathbf{b} = q(\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{b}$$\n$$m \\frac{dv_{\\parallel}}{dt} = q(\\mathbf{E}_{\\parallel} \\cdot \\mathbf{b}) + q(\\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{b}$$\n由于 $\\mathbf{v} \\times \\mathbf{B}$ 垂直于 $\\mathbf{B}$（因此也垂直于 $\\mathbf{b}$），第二项为零。剩下：\n$$m \\frac{dv_{\\parallel}}{dt} = q E_{\\parallel}$$\n这描述了在平行于 $\\mathbf{B}$ 方向上的匀加速运动。使用初始条件 $v_{\\parallel}(0) = v_{\\parallel 0}$ 进行积分，得到：\n$$v_{\\parallel}(t) = v_{\\parallel 0} + \\frac{q E_{\\parallel}}{m} t$$\n来自平行分量的平均功率是：\n$$\\langle P_{\\parallel} \\rangle = \\frac{q E_{\\parallel}}{T_c} \\int_0^{T_c} \\left(v_{\\parallel 0} + \\frac{q E_{\\parallel}}{m} t\\right) \\,dt = \\frac{q E_{\\parallel}}{T_c} \\left[ v_{\\parallel 0} t + \\frac{q E_{\\parallel}}{2m} t^2 \\right]_0^{T_c}$$\n$$\\langle P_{\\parallel} \\rangle = \\frac{q E_{\\parallel}}{T_c} \\left( v_{\\parallel 0} T_c + \\frac{q E_{\\parallel}}{2m} T_c^2 \\right) = q E_{\\parallel} v_{\\parallel 0} + \\frac{q^2 E_{\\parallel}^2 T_c}{2m}$$\n\n运动方程的垂直分量是：\n$$m \\frac{d\\mathbf{v}_{\\perp}}{dt} = q(\\mathbf{E}_{\\perp} + \\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\n与该运动相关的功率为 $P_{\\perp}(t) = q\\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t)$。让我们考虑垂直动能的变化率，$K_{\\perp} = \\frac{1}{2} m v_{\\perp}^2 = \\frac{1}{2} m (\\mathbf{v}_{\\perp} \\cdot \\mathbf{v}_{\\perp})$。\n$$\\frac{dK_{\\perp}}{dt} = m \\mathbf{v}_{\\perp} \\cdot \\frac{d\\mathbf{v}_{\\perp}}{dt} = \\mathbf{v}_{\\perp} \\cdot \\left( q\\mathbf{E}_{\\perp} + q(\\mathbf{v}_{\\perp} \\times \\mathbf{B}) \\right)$$\n$$\\frac{dK_{\\perp}}{dt} = q \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp} + q \\mathbf{v}_{\\perp} \\cdot (\\mathbf{v}_{\\perp} \\times \\mathbf{B})$$\n标量三重积 $\\mathbf{v}_{\\perp} \\cdot (\\mathbf{v}_{\\perp} \\times \\mathbf{B})$ 为零，因为矢量 $(\\mathbf{v}_{\\perp} \\times \\mathbf{B})$ 与 $\\mathbf{v}_{\\perp}$ 正交。因此：\n$$\\frac{dK_{\\perp}}{dt} = q \\mathbf{E}_{\\perp} \\cdot \\mathbf{v}_{\\perp}(t) = P_{\\perp}(t)$$\n因此，平均垂直功率 $\\langle P_{\\perp} \\rangle$ 为：\n$$\\langle P_{\\perp} \\rangle = \\frac{1}{T_c} \\int_0^{T_c} P_{\\perp}(t) \\,dt = \\frac{1}{T_c} \\int_0^{T_c} \\frac{dK_{\\perp}}{dt} \\,dt = \\frac{K_{\\perp}(T_c) - K_{\\perp}(0)}{T_c}$$\n垂直速度 $\\mathbf{v}_{\\perp}(t)$ 是恒定的 $\\mathbf{E} \\times \\mathbf{B}$ 漂移速度 $\\mathbf{v}_D = \\frac{\\mathbf{E}_{\\perp} \\times \\mathbf{B}}{B^2}$ 和一个以回旋频率 $\\omega_c = |q|B/m$ 旋转的回旋速度 $\\mathbf{u}_{\\perp}(t)$ 的和。经过一个完整的回旋周期 $T_c$后，回旋分量返回其初始状态，$\\mathbf{u}_{\\perp}(T_c) = \\mathbf{u}_{\\perp}(0)$。因此，总的垂直速度也是周期性的，周期为 $T_c$，所以 $\\mathbf{v}_{\\perp}(T_c) = \\mathbf{v}_{\\perp}(0)$。这意味着垂直动能也是周期性的，$K_{\\perp}(T_c) = K_{\\perp}(0)$。\n因此，在一个回旋周期内垂直动能的变化为零，来自垂直电场的平均功率为零：\n$$\\langle P_{\\perp} \\rangle = 0$$\n\n总平均功率就是来自平行运动的平均功率：\n$$\\langle P \\rangle = \\langle P_{\\parallel} \\rangle = q E_{\\parallel} v_{\\parallel 0} + \\frac{q^2 E_{\\parallel}^2 T_c}{2m}$$\n为了用要求的变量表示，我们代入 $E_{\\parallel} = E \\cos\\theta$ 和 $T_c = \\frac{2\\pi m}{|q| B}$：\n$$\\langle P \\rangle = q (E \\cos\\theta) v_{\\parallel 0} + \\frac{q^2 (E \\cos\\theta)^2}{2m} \\left( \\frac{2\\pi m}{|q| B} \\right)$$\n由于 $q^2 = |q|^2$，项 $\\frac{q^2}{|q|}$ 简化为 $|q|$。质量 $m$ 从第二项中消去。\n$$\\langle P \\rangle = q v_{\\parallel 0} E \\cos\\theta + \\frac{|q| \\pi E^2 \\cos^2\\theta}{B}$$\n\n这个最终表达式有两个不同的项。我们被要求在核聚变等离子体的背景下解释它们的物理意义。\n1.  第一项，$q v_{\\parallel 0} E \\cos\\theta = q v_{\\parallel 0} E_{\\parallel}$，代表平行电场传递给粒子导引中心的功率，导引中心是其沿磁场运动的初始分量。这是电荷通过电势差时标准的功率输入。在聚变背景下，这对应于欧姆加热，其中平行于磁场的电场驱动电流并加热等离子体。\n2.  第二项，$\\frac{\\pi |q| E^2 \\cos^2\\theta}{B}$，是由于粒子在一个回旋周期过程中被平行电场持续加速而产生的。该项始终为非负，表示无论 $q$、$E_{\\parallel}$ 或 $v_{\\parallel 0}$ 的符号如何，都存在净加热效应。它与平行电场强度的平方成正比。这种加热形式是一种渡越时间加热，即粒子在渡越过程中与场相互作用而获得能量。对 $1/B$ 的依赖性表明，对于较弱的磁场，回旋周期更长，从而使平行电场有更多时间来加速粒子，因此每个回旋周期能传递更多能量。",
            "answer": "$$\n\\boxed{q v_{\\parallel 0} E \\cos\\theta + \\frac{\\pi |q| E^2 \\cos^2\\theta}{B}}\n$$"
        }
    ]
}