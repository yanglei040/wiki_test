{
    "hands_on_practices": [
        {
            "introduction": "A central task in fusion plasma physics is to interpret experimental measurements to identify the underlying physical mechanisms responsible for anomalous transport. This exercise simulates this scientific process by providing a set of characteristic experimental trends observed in a hypothetical tokamak discharge. Your goal is to act as a physicist, using your knowledge of microinstability theory to deduce which type of turbulence is most consistent with the evidence, a crucial step toward controlling and mitigating transport .",
            "id": "3691190",
            "problem": "A medium-sized tokamak with major radius $R = 1.7\\,\\mathrm{m}$, minor radius $a = 0.5\\,\\mathrm{m}$, toroidal magnetic field $B = 2.5\\,\\mathrm{T}$, and safety factor $q \\approx 2$ operates in a stationary high-confinement regime. Local charge balance and quasineutrality hold, and turbulent transport is inferred from steady-state power balance using $Q_\\alpha \\approx - n_\\alpha \\chi_\\alpha \\nabla T_\\alpha$ for species $\\alpha \\in \\{e, i\\}$, where $Q_\\alpha$ is the heat flux, $n_\\alpha$ the density, $\\chi_\\alpha$ the thermal diffusivity, and $T_\\alpha$ the temperature. The following robust experimental trends are observed at mid-radius ($r/a \\approx 0.5$), under scans that keep macroscopic equilibrium and geometry approximately fixed:\n\n- The electron thermal diffusivity $\\chi_e$ increases strongly with normalized plasma pressure $\\beta \\equiv 2 \\mu_0 p / B^2$ in the low-$\\beta$ range from $\\beta \\approx 0.5\\%$ to $\\beta \\approx 2\\%$, with a near-linear proportionality $\\chi_e \\propto \\beta$ over this range. The ion thermal diffusivity $\\chi_i$ shows only weak variation with $\\beta$.\n- The electron thermal diffusivity $\\chi_e$ increases monotonically with effective electron collisionality $\\nu_* \\equiv \\nu_{\\text{ei}} q R / (\\epsilon^{3/2} v_{\\text{te}})$ (with inverse aspect ratio $\\epsilon \\equiv a/R$ and electron thermal speed $v_{\\text{te}}$), over $\\nu_* \\approx 0.02$ to $\\nu_* \\approx 0.3$. The ion thermal diffusivity $\\chi_i$ remains roughly flat over this collisionality range.\n- Varying the normalized electron temperature gradient $R/L_{T_e}$ produces a clear threshold and strong amplification of $\\chi_e$ once $R/L_{T_e}$ exceeds a critical value, while varying the ion temperature gradient $R/L_{T_i}$ at fixed $R/L_{T_e}$ causes negligible change in $\\chi_e$.\n- Varying the normalized density gradient $R/L_n$ has only a weak effect on $\\chi_e$ when $R/L_{T_e}$ is held constant, whereas $\\chi_e$ is highly sensitive to $R/L_{T_e}$ itself.\n- Increasing the electric field cross magnetic field shear rate $\\gamma_E$ suppresses $\\chi_e$ significantly once $\\gamma_E$ approaches the inferred linear growth rates from fluctuation decorrelation estimates. The suppression of $\\chi_i$ is minor because $\\chi_i \\ll \\chi_e$ in these conditions.\n- Magnetic fluctuation measurements show finite perpendicular magnetic perturbations with $\\delta B_\\perp / B \\sim 10^{-4}$ in the same radial region where $\\chi_e$ peaks, while electrostatic fluctuation levels are comparable or smaller. The heat transport is dominantly in the electron channel, $Q_e \\gg Q_i$.\n\nAssume standard drift-wave free-energy sources from equilibrium gradients, and that electromagnetic effects scale with $\\beta$ through parallel vector potential fluctuations. Using first-principles reasoning about the character of microinstabilities and their expected dependencies on $\\beta$, collisionality, drive gradients, transport channels, and shear suppression, which microinstability is most consistent with the above trends?\n\nA. Ion Temperature Gradient (ITG) mode\n\nB. Trapped Electron Mode (TEM)\n\nC. Electron Temperature Gradient (ETG) mode\n\nD. Microtearing Mode (MTM)\n\nE. Kinetic Ballooning Mode (KBM)",
            "solution": "The user requires an identification of a plasma microinstability based on a detailed set of experimental observations in a tokamak. The process involves validating the problem statement and then performing a systematic analysis of the given trends against the known characteristics of several candidate instabilities.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n- **Device Parameters:** Major radius $R = 1.7\\,\\mathrm{m}$, minor radius $a = 0.5\\,\\mathrm{m}$, toroidal magnetic field $B = 2.5\\,\\mathrm{T}$, safety factor $q \\approx 2$. This implies an inverse aspect ratio $\\epsilon = a/R \\approx 0.294$.\n- **Plasma Conditions:** Stationary high-confinement regime, mid-radius ($r/a \\approx 0.5$), local charge balance and quasineutrality.\n- **Transport Model:** Heat flux is described by $Q_\\alpha \\approx - n_\\alpha \\chi_\\alpha \\nabla T_\\alpha$ for electrons ($\\alpha=e$) and ions ($\\alpha=i$).\n- **Experimental Trend 1 ($\\beta$ dependence):** The electron thermal diffusivity $\\chi_e$ increases strongly with normalized plasma pressure $\\beta \\equiv 2 \\mu_0 p / B^2$, approximately as $\\chi_e \\propto \\beta$ for $\\beta \\in [0.5\\%, 2\\%]$. The ion thermal diffusivity $\\chi_i$ shows weak variation.\n- **Experimental Trend 2 (Collisionality dependence):** $\\chi_e$ increases monotonically with effective electron collisionality $\\nu_* \\equiv \\nu_{\\text{ei}} q R / (\\epsilon^{3/2} v_{\\text{te}})$ over the range $\\nu_* \\in [0.02, 0.3]$. $\\chi_i$ remains roughly flat.\n- **Experimental Trend 3 (Temperature gradient dependence):** $\\chi_e$ exhibits a critical gradient threshold in the normalized electron temperature gradient $R/L_{T_e}$ and is strongly amplified above it. Variation of the ion temperature gradient $R/L_{T_i}$ has a negligible effect on $\\chi_e$.\n- **Experimental Trend 4 (Density gradient dependence):** Variation of the normalized density gradient $R/L_n$ has a weak effect on $\\chi_e$ compared to the strong sensitivity to $R/L_{T_e}$.\n- **Experimental Trend 5 (Shear flow suppression):** Increasing the $\\mathbf{E} \\times \\mathbf{B}$ shear rate $\\gamma_E$ strongly suppresses $\\chi_e$.\n- **Experimental Trend 6 (Fluctuation characteristics):** The turbulence is characterized by finite perpendicular magnetic perturbations ($\\delta B_\\perp / B \\sim 10^{-4}$), with electrostatic fluctuations being of comparable or smaller amplitude. The heat transport is predominantly in the electron channel ($Q_e \\gg Q_i$).\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically sound and well-posed for a physics-based inference task.\n- **Scientifically Grounded:** The context is anomalous transport in tokamaks, a central topic in fusion research. All parameters ($R, a, B, q, \\beta, \\nu_*$) are within realistic ranges for a medium-sized device. The definitions are standard. The described trends, while curated to be discriminatory, are phenomenologically realistic and consistent with published experimental results. The candidate instabilities are the primary ones studied in this field.\n- **Well-Posed:** The problem provides a comprehensive set of constraints and asks to identify the instability that is *most consistent* with them. This is a standard method of scientific reasoning.\n- **Objective:** The language is technical, precise, and devoid of subjectivity.\n\nThe problem does not violate any of the specified invalidity criteria. The parameters are consistent, the physics is established, and the question is clear and solvable through physical reasoning.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution proceeds by systematically comparing the properties of each candidate instability against the given experimental evidence.\n\n### Derivation and Option Evaluation\n\nThe goal is to find the microinstability that best matches all six experimental trends observed for the electron thermal diffusivity $\\chi_e$.\n\n**A. Ion Temperature Gradient (ITG) mode**\n- **Drive:** ITG modes are driven by a steep ion temperature gradient, $R/L_{T_i}$. The observation that $\\chi_e$ is insensitive to $R/L_{T_i}$ (Trend 3) is a direct contradiction.\n- **Transport Channel:** ITG turbulence primarily drives ion heat transport ($Q_i$), with electron heat transport being secondary. This contradicts Trend 6 ($Q_e \\gg Q_i$).\n- **$\\beta$ Dependence:** Pure ITG is an electrostatic mode. At finite $\\beta$, it couples to shear-Alfvén waves, but it is typically stabilized by increasing $\\beta$ (the \"$\\beta$-stabilization\" effect), which contradicts Trend 1 ($\\chi_e \\propto \\beta$).\n- **Collisionality:** ITG modes are generally weakened (damped) by increasing ion-ion or electron-ion collisions. This contradicts Trend 2 ($\\chi_e$ increases with $\\nu_*$).\n- **Conclusion:** ITG is inconsistent with at least four of the key trends.\n**Verdict: Incorrect**\n\n**B. Trapped Electron Mode (TEM)**\n- **Drive:** TEMs are driven by the gradients of electron density ($R/L_n$) and/or electron temperature ($R/L_{T_e}$). The observation that $\\chi_e$ has only a weak dependence on $R/L_n$ (Trend 4) is strong evidence against the common density-gradient-driven TEM. While a temperature-gradient-driven TEM exists, it is usually accompanied by some density gradient sensitivity.\n- **Collisionality:** The most virulent TEMs are collisionless ($\\nu_* \\ll 1$). They are stabilized by electron collisions, which detrap the electrons and destroy the drive mechanism. An increase of $\\chi_e$ with $\\nu_*$ is the opposite of the expected behavior for collisionless TEMs. While a *dissipative* TEM (DTEM) is driven by collisions, its transport contribution is usually sub-dominant, and it does not explain the other trends, especially the strong $\\beta$ scaling. This contradicts Trend 2.\n- **$\\beta$ Dependence and Fluctuation Type:** TEMs are primarily electrostatic. While they have an electromagnetic component at finite $\\beta$, it does not typically lead to a strong linear scaling of $\\chi_e \\propto \\beta$, nor does it usually result in magnetic fluctuations being the dominant component of the turbulence. This contradicts Trends 1 and 6.\n- **Conclusion:** TEM is inconsistent with the observed collisionality dependence, density gradient insensitivity, and electromagnetic character.\n**Verdict: Incorrect**\n\n**C. Electron Temperature Gradient (ETG) mode**\n- **Drive:** ETG modes are driven by the electron temperature gradient, $R/L_{T_e}$, and are insensitive to $R/L_{T_i}$. This is consistent with Trend 3. They also have a weaker dependence on $R/L_n$, matching Trend 4.\n- **Transport Channel:** ETG turbulence drives electron heat transport, consistent with $Q_e \\gg Q_i$ (Trend 6).\n- **Collisionality:** Like TEMs, ETG modes are destabilized by electron trapping and are stabilized by collisions that inhibit the kinetic resonance. An increase of transport with $\\nu_*$ is a direct contradiction to the standard ETG model. This contradicts Trend 2.\n- **$\\beta$ Dependence and Fluctuation Type:** ETG modes are fundamentally high-wavenumber ($k_\\perp \\rho_e \\sim 1$), short-wavelength instabilities that are considered overwhelmingly electrostatic. Transport arises from electrostatic $\\mathbf{E} \\times \\mathbf{B}$ advection. They do not generate significant magnetic flutter transport and are not expected to show a strong, linear increase in transport with $\\beta$. This contradicts Trends 1 and 6.\n- **Conclusion:** ETG is inconsistent with the observed collisionality and $\\beta$ dependencies.\n**Verdict: Incorrect**\n\n**D. Microtearing Mode (MTM)**\n- **$\\beta$ Dependence and Fluctuation Type:** MTMs are intrinsically electromagnetic instabilities that arise from the parallel electron current perturbation coupled with the parallel vector potential ($A_\\parallel$). They tear and reconnect magnetic field lines, forming small magnetic islands. The growth rate and the resulting heat transport, which occurs via stochastic magnetic field lines, scale strongly with $\\beta$. A near-linear dependence $\\chi_e \\propto \\beta$ is a classic signature. The dominance of magnetic fluctuations ($\\delta B_\\perp$) is the defining characteristic. This perfectly matches Trends 1 and 6.\n- **Collisionality:** MTMs are resistive instabilities. The mechanism relies on electron inertia and resistivity (proportional to electron-ion collision frequency, $\\nu_{\\text{ei}}$) to break the frozen-in law and allow field line reconnection. Consequently, their growth rate and the transport they cause are expected to increase with collisionality in the specified low-collisionality regime ($\\nu_* \\ll 1$). This perfectly matches Trend 2 and is a key distinguishing feature of MTMs.\n- **Drive:** The free energy for MTMs is supplied by the electron temperature gradient, $\\nabla T_e$. They are thus driven by $R/L_{T_e}$ and have a critical gradient for onset. They have minimal dependence on $\\nabla T_i$. This perfectly matches Trend 3.\n- **Density Gradient Dependence:** MTMs have a weak dependence on the density gradient, which is consistent with Trend 4.\n- **Shear Suppression:** As an ion-scale mode ($k_\\perp \\rho_i \\sim 1$), MTMs have growth rates that can be comparable to $\\gamma_E$, and they are known to be suppressed by $\\mathbf{E} \\times \\mathbf{B}$ shear. This matches Trend 5.\n- **Conclusion:** MTM is consistent with every single experimental trend provided.\n**Verdict: Correct**\n\n**E. Kinetic Ballooning Mode (KBM)**\n- **Drive:** KBMs are the kinetic extension of ideal MHD ballooning modes, driven by the total pressure gradient, $\\nabla p = \\nabla p_e + \\nabla p_i$. They are therefore sensitive to both $R/L_{T_e}$ and $R/L_{T_i}$ (as well as $R/L_n$). The observed insensitivity of $\\chi_e$ to changes in $R/L_{T_i}$ is a strong contradiction. This contradicts Trend 3.\n- **Transport Channel:** As an ion-scale mode driven by the total pressure gradient, KBMs are expected to drive transport in both the ion and electron channels. The observation that $\\chi_i$ is small and $Q_e \\gg Q_i$ is inconsistent with KBM being the dominant instability. This is inconsistent with Trend 6 and the associated description of $\\chi_i$.\n- **Collisionality:** KBMs are typically most unstable in the collisionless limit and are stabilized by resistivity (collisionality). An increase of transport with $\\nu_*$ is the opposite of the expected behavior. This contradicts Trend 2.\n- **$\\beta$ Dependence:** KBMs are electromagnetic and have a threshold in $\\beta$, with transport increasing with $\\beta$ above the threshold. This aspect is consistent with Trend 1, but this single point of agreement is insufficient.\n- **Conclusion:** KBM is inconsistent with the observed drive source, transport channel characteristics, and collisionality dependence.\n**Verdict: Incorrect**\n\n**Summary**\nThe Microtearing Mode (MTM) is the only candidate that successfully explains the entire set of observations: its electromagnetic nature and drive mechanism explain the strong $\\beta$ scaling and dominant magnetic fluctuations; its resistive nature explains the increase with collisionality; its free energy source explains the dependence on $\\nabla T_e$ and insensitivity to $\\nabla T_i$ and $\\nabla n$; and its scale makes it susceptible to $\\mathbf{E} \\times \\mathbf{B}$ shear. All other modes fail on multiple crucial points.",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "Turbulent transport is not a smooth, continuous process; it is often characterized by intermittent, burst-like events that can carry a significant fraction of the total flux. To properly model and predict this behavior, we must move beyond simple averages and employ statistical tools that can capture this non-Gaussian nature. This problem guides you through a hands-on derivation to quantify the \"burstiness\" of a turbulent signal using a simplified but insightful statistical model, introducing the key concepts of intermittency and higher-order moments like kurtosis .",
            "id": "3691191",
            "problem": "In a magnetically confined fusion plasma (tokamak), the instantaneous radial heat flux $q_r(t)$ can be expressed at leading order as $q_r(t) = - n_e k_B \\chi_t(t) \\partial_r T$, where $n_e$ is the electron density, $k_B$ is the Boltzmann constant, $\\partial_r T$ is the radial temperature gradient (assumed stationary on the timescale of fluctuations), and $\\chi_t(t)$ is the turbulent thermal diffusivity arising from advection by the electric field cross magnetic field (E$\\times$B) drift and correlated thermodynamic fluctuations. Consider a dimensionless fluctuation variable $X$ constructed from the instantaneous flux that isolates the turbulent statistics, such that $X$ is a sum of two statistically independent contributions:\n- A background contribution $G$ representing the aggregate effect of many weakly correlated eddies, modeled as a Gaussian random variable with zero mean and variance $\\sigma^2$.\n- An intermittent contribution $S$ representing the sporadic appearance of coherent structures (blobs/avalanches) that produce one-sided bursty transport. The random variable $S$ equals $0$ with probability $1-p$ and, with probability $p$, equals a positive amplitude $A$ drawn from an exponential distribution with mean $\\mu$, that is, with probability density function $f_A(a) = \\frac{1}{\\mu} \\exp\\!\\left(-\\frac{a}{\\mu}\\right)$ for $a \\ge 0$.\n\nThus $X = G + S$, with $G$, $S$, and $A$ mutually independent. Starting from the definitions of moments and cumulants for random variables, and using only the additivity of cumulants for independent sums, derive a closed-form expression for the kurtosis $\\mathcal{K}$ of $X$, defined by\n$$\n\\mathcal{K} \\equiv \\frac{\\langle (X - \\langle X \\rangle)^{4} \\rangle}{\\langle (X - \\langle X \\rangle)^{2} \\rangle^{2}} \\, .\n$$\nThen evaluate this expression for $p = 0.1$, $\\mu = 1$, and $\\sigma^{2} = 1$. Express your final numerical answer as a dimensionless number, rounded to four significant figures.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n-   Instantaneous radial heat flux: $q_r(t) = - n_e k_B \\chi_t(t) \\partial_r T$.\n-   Assumed stationary terms: $n_e$ (electron density), $k_B$ (Boltzmann constant), $\\partial_r T$ (radial temperature gradient).\n-   Fluctuating term: $\\chi_t(t)$ (turbulent thermal diffusivity).\n-   Dimensionless fluctuation variable: $X = G + S$.\n-   $G$ is a Gaussian random variable with mean $\\langle G \\rangle = 0$ and variance $\\text{Var}(G) = \\sigma^2$.\n-   $S$ is an intermittent random variable defined as:\n    -   $S = 0$ with probability $1-p$.\n    -   $S = A$ with probability $p$.\n-   $A$ is a random variable following an exponential distribution with mean $\\mu$.\n-   The probability density function (PDF) of $A$ is $f_A(a) = \\frac{1}{\\mu} \\exp\\!\\left(-\\frac{a}{\\mu}\\right)$ for $a \\ge 0$.\n-   $G$, $S$, and $A$ are mutually independent random variables.\n-   The definition of kurtosis is given as $\\mathcal{K} \\equiv \\frac{\\langle (X - \\langle X \\rangle)^{4} \\rangle}{\\langle (X - \\langle X \\rangle)^{2} \\rangle^{2}}$.\n-   The required task is to derive a closed-form expression for $\\mathcal{K}$ and then evaluate it for the specific parameter values $p = 0.1$, $\\mu = 1$, and $\\sigma^2 = 1$. The final numerical answer must be rounded to four significant figures.\n-   The derivation must use the additivity of cumulants for independent sums.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is well-grounded in the phenomenology of anomalous transport in magnetically confined fusion plasmas. The representation of a fluctuating quantity as a sum of a continuous Gaussian background and a sporadic, one-sided intermittent component is a standard and physically motivated model for turbulence that exhibits bursty events (e.g., avalanches or blobs).\n-   **Well-Posedness**: The problem is mathematically well-posed. The statistical properties of the random variables $G$ and $S$ are fully specified, enabling the calculation of the moments and cumulants of their sum, $X$. The question is precise and has a unique, stable solution.\n-   **Objectivity**: The problem is stated in objective, formal language.\n-   **No Flaws Identified**: The problem does not violate any fundamental principles, is not incomplete or contradictory, its model is a valid simplification, and it is a non-trivial but solvable problem in statistical analysis.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\nThe kurtosis $\\mathcal{K}$ is defined in terms of the central moments $\\mu_n = \\langle (X - \\langle X \\rangle)^n \\rangle$ as $\\mathcal{K}(X) = \\mu_4(X) / (\\mu_2(X))^2$. The problem requires using cumulants, $\\kappa_n$. The relationship between the first four central moments and cumulants is:\n$\\mu_1 = \\langle X \\rangle = \\kappa_1$\n$\\mu_2 = \\text{Var}(X) = \\kappa_2$\n$\\mu_3 = \\kappa_3$\n$\\mu_4 = \\kappa_4 + 3\\kappa_2^2$\n\nUsing these relations, the kurtosis can be expressed in terms of cumulants as:\n$$\n\\mathcal{K}(X) = \\frac{\\kappa_4(X) + 3(\\kappa_2(X))^2}{(\\kappa_2(X))^2} = 3 + \\frac{\\kappa_4(X)}{(\\kappa_2(X))^2}\n$$\nThe problem states that $X = G + S$, where $G$ and $S$ are independent random variables. A fundamental property of cumulants is their additivity for sums of independent random variables:\n$$\n\\kappa_n(X) = \\kappa_n(G) + \\kappa_n(S)\n$$\nWe will now compute the required cumulants for $G$ and $S$ separately.\n\n**Cumulants of G:**\nThe variable $G$ is a Gaussian random variable with mean $0$ and variance $\\sigma^2$. The cumulants of a Gaussian distribution are particularly simple:\n-   $\\kappa_1(G) = \\langle G \\rangle = 0$\n-   $\\kappa_2(G) = \\text{Var}(G) = \\sigma^2$\n-   $\\kappa_n(G) = 0$ for all $n > 2$.\nTherefore, $\\kappa_3(G) = 0$ and $\\kappa_4(G) = 0$.\n\n**Cumulants of S:**\nThe variable $S$ is a mixed random variable. To find its cumulants, we first calculate its raw moments, $\\mu_n'(S) = \\langle S^n \\rangle$. By definition of $S$:\n$$\n\\mu_n'(S) = \\langle S^n \\rangle = (1-p) \\cdot (0)^n + p \\cdot \\langle A^n \\rangle\n$$\nFor $n \\ge 1$, this simplifies to $\\mu_n'(S) = p \\langle A^n \\rangle$. We need the raw moments of the exponential distribution with PDF $f_A(a) = \\frac{1}{\\mu} \\exp(-a/\\mu)$.\n$$\n\\langle A^n \\rangle = \\int_0^\\infty a^n f_A(a) \\, da = \\frac{1}{\\mu} \\int_0^\\infty a^n \\exp(-a/\\mu) \\, da\n$$\nUsing the substitution $u = a/\\mu$, which gives $a=u\\mu$ and $da = \\mu du$:\n$$\n\\langle A^n \\rangle = \\frac{1}{\\mu} \\int_0^\\infty (u\\mu)^n \\exp(-u) (\\mu du) = \\mu^n \\int_0^\\infty u^n \\exp(-u) \\, du\n$$\nThe integral is the Gamma function $\\Gamma(n+1)$, which equals $n!$ for integer $n$.\n$$\n\\langle A^n \\rangle = n! \\mu^n\n$$\nThe first four raw moments of $S$ are thus:\n-   $\\mu_1'(S) = p \\langle A \\rangle = p (1! \\mu^1) = p\\mu$\n-   $\\mu_2'(S) = p \\langle A^2 \\rangle = p (2! \\mu^2) = 2p\\mu^2$\n-   $\\mu_3'(S) = p \\langle A^3 \\rangle = p (3! \\mu^3) = 6p\\mu^3$\n-   $\\mu_4'(S) = p \\langle A^4 \\rangle = p (4! \\mu^4) = 24p\\mu^4$\n\nNow, we convert these raw moments of $S$ to the cumulants of $S$:\n-   $\\kappa_1(S) = \\mu_1'(S) = p\\mu$\n-   $\\kappa_2(S) = \\mu_2'(S) - (\\mu_1'(S))^2 = 2p\\mu^2 - (p\\mu)^2 = p\\mu^2 (2-p)$\n-   $\\kappa_3(S) = \\mu_3'(S) - 3\\mu_2'(S)\\mu_1'(S) + 2(\\mu_1'(S))^3 = 6p\\mu^3 - 3(2p\\mu^2)(p\\mu) + 2(p\\mu)^3 = p\\mu^3(6 - 6p + 2p^2)$\n-   $\\kappa_4(S) = \\mu_4'(S) - 4\\mu_3'(S)\\mu_1'(S) - 3(\\mu_2'(S))^2 + 12\\mu_2'(S)(\\mu_1'(S))^2 - 6(\\mu_1'(S))^4$\n$$\n\\kappa_4(S) = 24p\\mu^4 - 4(6p\\mu^3)(p\\mu) - 3(2p\\mu^2)^2 + 12(2p\\mu^2)(p\\mu)^2 - 6(p\\mu)^4\n$$\n$$\n\\kappa_4(S) = \\mu^4 [24p - 24p^2 - 3(4p^2) + 12(2p^3) - 6p^4]\n$$\n$$\n\\kappa_4(S) = \\mu^4 [24p - 24p^2 - 12p^2 + 24p^3 - 6p^4]\n$$\n$$\n\\kappa_4(S) = p\\mu^4 (24 - 36p + 24p^2 - 6p^3)\n$$\n\n**Cumulants and Kurtosis of X:**\nUsing the additivity property, the second and fourth cumulants of $X=G+S$ are:\n-   $\\kappa_2(X) = \\kappa_2(G) + \\kappa_2(S) = \\sigma^2 + p\\mu^2(2-p)$\n-   $\\kappa_4(X) = \\kappa_4(G) + \\kappa_4(S) = 0 + p\\mu^4(24 - 36p + 24p^2 - 6p^3) = p\\mu^4(24 - 36p + 24p^2 - 6p^3)$\n\nSubstituting these into the expression for kurtosis gives the general closed-form expression:\n$$\n\\mathcal{K}(X) = 3 + \\frac{\\kappa_4(X)}{(\\kappa_2(X))^2} = 3 + \\frac{p\\mu^4(24 - 36p + 24p^2 - 6p^3)}{[\\sigma^2 + p\\mu^2(2-p)]^2}\n$$\n\n**Numerical Evaluation:**\nWe are given the parameters $p = 0.1$, $\\mu=1$, and $\\sigma^2=1$.\nFirst, we evaluate $\\kappa_2(X)$ and $\\kappa_4(X)$:\n$$\n\\kappa_2(X) = 1 + (0.1)(1)^2(2-0.1) = 1 + 0.1(1.9) = 1 + 0.19 = 1.19\n$$\n$$\n\\kappa_4(X) = (0.1)(1)^4(24 - 36(0.1) + 24(0.1)^2 - 6(0.1)^3)\n$$\n$$\n\\kappa_4(X) = 0.1(24 - 3.6 + 24(0.01) - 6(0.001))\n$$\n$$\n\\kappa_4(X) = 0.1(24 - 3.6 + 0.24 - 0.006) = 0.1(20.4 + 0.234) = 0.1(20.634) = 2.0634\n$$\nNow we compute the kurtosis:\n$$\n\\mathcal{K} = 3 + \\frac{\\kappa_4(X)}{(\\kappa_2(X))^2} = 3 + \\frac{2.0634}{(1.19)^2} = 3 + \\frac{2.0634}{1.4161}\n$$\n$$\n\\mathcal{K} \\approx 3 + 1.45709907... = 4.45709907...\n$$\nRounding the final result to four significant figures yields $4.457$.",
            "answer": "$$\\boxed{4.457}$$"
        },
        {
            "introduction": "Modern turbulence research is inextricably linked with large-scale numerical simulations, with codes like those based on gyrokinetics providing profound insights. However, the output of a complex code is only as reliable as the code itself, making verification and validation indispensable practices. This exercise provides a hands-on introduction to these crucial skills, asking you to implement and analyze a simplified transport model to assess numerical accuracy, convergence, and dissipation—foundational techniques for any computational physicist in the field .",
            "id": "3691188",
            "problem": "You are tasked with verifying energy-balance closure, estimating numerical dissipation, and assessing spatial convergence of a simplified two-dimensional electrostatic turbulence surrogate that emulates key gyrokinetic conservation properties relevant to anomalous transport and turbulence phenomenology in nuclear fusion. Work in dimensionless normalized units with periodic boundary conditions on a square domain. The physics base is an advection–diffusion conservation law for a passive scalar surrogate of the electrostatic potential-related quantity, constructed to share the quadratic free-energy conservation structure of the gyrokinetic system. The derivations and computations must begin from fundamental definitions of conservation and transport for this surrogate.\n\nFundamental base:\n- Consider a scalar field $\\psi(x,y,t)$ on a periodic domain $x\\in[0,L_x], y\\in[0,L_y]$ advected by a divergence-free velocity field $\\mathbf{v}(x,y)=(v_x(x,y),v_y(x,y))$ and subject to collisional diffusion with coefficient $\\nu$ and external forcing $f(x,y,t)$. The governing equation is\n$$\n\\partial_t \\psi + \\mathbf{v}\\cdot\\nabla\\psi = \\nu\\nabla^2 \\psi + f.\n$$\n- Define the quadratic free energy\n$$\nE(t) = \\frac{1}{2}\\int_{0}^{L_x}\\!\\!\\int_{0}^{L_y} \\psi^2(x,y,t)\\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n- Using incompressibility $\\nabla\\cdot\\mathbf{v}=0$ and periodic boundaries, the continuum energy balance is\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int \\psi f\\,\\mathrm{d}x\\,\\mathrm{d}y - \\nu \\int \\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y,\n$$\nwhere the advection term integrates to zero.\n\nManufactured solution for verification:\n- Take $L_x=L_y=2\\pi$, $\\psi(x,y,t)=\\sin(k_x x)\\sin(k_y y)\\cos(\\omega t)$ with given integers $k_x,k_y$ and angular frequency $\\omega$.\n- Use the divergence-free velocity from a streamfunction $\\chi(x,y)=\\sin(x)\\cos(y)$, so that\n$$\nv_x=\\partial_y\\chi=-\\sin(x)\\sin(y),\\qquad v_y=-\\partial_x\\chi=-\\cos(x)\\cos(y).\n$$\n- Choose $\\nu$ and define $f$ such that the partial differential equation holds exactly in the continuum, i.e.\n$$\nf(x,y,t) = \\partial_t\\psi + \\mathbf{v}\\cdot\\nabla\\psi - \\nu\\nabla^2\\psi,\n$$\nwith $\\partial_t\\psi=-\\omega\\sin(k_x x)\\sin(k_y y)\\sin(\\omega t)$, $\\nabla\\psi=(\\partial_x\\psi,\\partial_y\\psi)$ where $\\partial_x\\psi=k_x\\cos(k_x x)\\sin(k_y y)\\cos(\\omega t)$, $\\partial_y\\psi=k_y\\sin(k_x x)\\cos(k_y y)\\cos(\\omega t)$, and $\\nabla^2\\psi=-(k_x^2+k_y^2)\\psi$.\n\nDiscrete verification and diagnostics to implement:\n- Approximate spatial integrals by the periodic trapezoidal rule on a uniform grid of $N_x\\times N_y$ points, with $\\Delta x=L_x/N_x$ and $\\Delta y=L_y/N_y$.\n- Approximate spatial derivatives for $\\lvert\\nabla\\psi\\rvert^2$ and the Laplacian in the collisional dissipation term using second-order central differences with periodic boundary conditions. Use analytic expressions only to construct $f$.\n- Approximate the time derivative of the energy by a forward difference $(E(t+\\Delta t)-E(t))/\\Delta t$.\n- Define the discrete energy-balance residual (numerical dissipation diagnostic)\n$$\n\\mathcal{N} = \\frac{E(t+\\Delta t)-E(t)}{\\Delta t} - \\left(\\int \\psi f\\,\\mathrm{d}x\\,\\mathrm{d}y - \\nu \\int \\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y\\right),\n$$\nand the effective numerical dissipation coefficient\n$$\n\\nu_{\\mathrm{num}} = \\frac{\\mathcal{N}}{\\int \\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y}.\n$$\n- For spatial convergence, assess the order $p$ of the discrete closure by measuring the error\n$$\n\\varepsilon(N_x) = \\left|\\left(\\int \\psi f\\,\\mathrm{d}x\\,\\mathrm{d}y - \\nu \\int \\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y\\right) - \\int \\psi\\,\\partial_t\\psi\\,\\mathrm{d}x\\,\\mathrm{d}y\\right|,\n$$\nand estimate\n$$\np \\approx \\frac{\\log\\left(\\varepsilon(N_1)/\\varepsilon(N_2)\\right)}{\\log\\left((L_x/N_1)/(L_x/N_2)\\right)}\n$$\nbetween successive refinements $N_1\\to N_2$, then average the two estimates from a three-level refinement.\n\nYour program must compute the following test suite and produce a single line of output containing the results as a comma-separated list enclosed in square brackets:\n\nTest suite parameters:\n1. Happy-path numerical dissipation coefficient: $N_x=N_y=32$, $k_x=2$, $k_y=3$, $\\omega=0.7$, $\\nu=0.05$, $\\Delta t=10^{-3}$, $t_0=0.314$. Output the float $\\nu_{\\mathrm{num}}$.\n2. Stationary boundary case: $N_x=N_y=32$, $k_x=1$, $k_y=1$, $\\omega=0$, $\\nu=0$, $\\Delta t=10^{-3}$, $t_0=0.0$, and set $\\mathbf{v}=\\mathbf{0}$. Output the boolean indicating whether $\\lvert\\mathcal{N}\\rvert<10^{-12}$.\n3. Spatial convergence order: use $N_x=N_y\\in\\{16,32,64\\}$ with $k_x=2$, $k_y=3$, $\\omega=0.7$, $\\nu=0.05$, $\\Delta t=10^{-4}$, $t_0=0.314$. Compute $\\varepsilon(N_x)$ for each grid and return the averaged order $p$ as a float.\n4. High-collisional edge case: $N_x=N_y=32$, $k_x=2$, $k_y=3$, $\\omega=0.7$, $\\nu=0.5$, $\\Delta t=10^{-3}$, $t_0=0.314$. Output the float ratio $\\mathcal{N}/\\left(\\nu\\int\\lvert\\nabla\\psi\\rvert^2\\,\\mathrm{d}x\\,\\mathrm{d}y\\right)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$). All quantities are dimensionless and therefore require no physical unit conversion.",
            "solution": "The problem is valid. It constitutes a well-posed, scientifically grounded exercise in the verification of numerical methods for partial differential equations, a standard practice in computational science and specifically relevant to turbulence modeling in fusion research. All required data, definitions, and constraints are provided, and there are no internal contradictions or violations of physical principles.\n\nThe task is to implement and analyze a numerical scheme for a two-dimensional advection-diffusion equation, using a manufactured solution to verify the code's correctness. This involves discretizing the domain and operators, calculating terms of the energy balance equation, and evaluating diagnostic quantities that measure numerical error and convergence.\n\nThe governing equation for the scalar field $\\psi(x,y,t)$ on the periodic domain $[0, L_x] \\times [0, L_y]$ is:\n$$\n\\partial_t \\psi + \\mathbf{v}\\cdot\\nabla\\psi = \\nu\\,\\nabla^2 \\psi + f\n$$\nHere, $\\mathbf{v}$ is a divergence-free velocity field, $\\nu$ is a diffusion coefficient, and $f$ is a source term. The associated quadratic free energy is defined as:\n$$\nE(t) = \\frac{1}{2}\\int_{0}^{L_x}\\!\\!\\int_{0}^{L_y} \\psi^2(x,y,t)\\,\\mathrm{d}x\\,\\mathrm{d}y\n$$\nTaking the time derivative of $E(t)$ and substituting $\\partial_t \\psi$ from the governing equation leads to the continuum energy balance equation:\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int \\psi f\\,\\mathrm{d}A - \\nu \\int |\\nabla\\psi|^2\\,\\mathrm{d}A\n$$\nwhere $\\mathrm{d}A = \\mathrm{d}x\\,\\mathrm{d}y$. The advection term $\\int \\psi (\\mathbf{v}\\cdot\\nabla\\psi)\\,\\mathrm{d}A$ integrates to zero due to the incompressibility of $\\mathbf{v}$ and periodic boundary conditions.\n\nTo verify a numerical implementation, we discretize the equations and evaluate them for a known, manufactured solution. The domain is discretized into a uniform grid of $N_x \\times N_y$ points, $(x_i, y_j)$, where $x_i = i\\Delta x$ for $i \\in \\{0, \\dots, N_x-1\\}$ and $y_j = j\\Delta y$ for $j \\in \\{0, \\dots, N_y-1\\}$. The grid spacings are $\\Delta x = L_x/N_x$ and $\\Delta y = L_y/N_y$.\n\nNumerical approximations for the operators are defined as follows:\n\n1.  **Integration**: Surface integrals are approximated using the periodic trapezoidal rule, which for a grid function $g_{i,j}$ simplifies to a sum over all grid points multiplied by the cell area:\n    $$\n    \\int g(x,y)\\,\\mathrm{d}A \\approx \\Delta x \\Delta y \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-1} g_{i,j}\n    $$\n2.  **Differentiation**: Spatial derivatives are approximated using second-order central differences with periodic boundary conditions. For a grid function $\\psi_{i,j}$:\n    $$\n    (\\partial_x \\psi)_{i,j} \\approx \\frac{\\psi_{i+1, j} - \\psi_{i-1, j}}{2\\Delta x}, \\quad (\\partial_y \\psi)_{i,j} \\approx \\frac{\\psi_{i, j+1} - \\psi_{i, j-1}}{2\\Delta y}\n    $$\n    The indices are handled periodically, e.g., $\\psi_{N_x, j} = \\psi_{0, j}$ and $\\psi_{-1, j} = \\psi_{N_x-1, j}$.\n\nThe discrete energy balance equation is constructed by replacing each term in the continuum equation with its numerical approximation. The time derivative of energy is approximated by a forward difference:\n$$\n\\left(\\frac{\\mathrm{d}E}{\\mathrm{d}t}\\right)_h \\approx \\frac{E_h(t+\\Delta t) - E_h(t)}{\\Delta t}\n$$\nwhere the subscript $h$ denotes a discrete quantity. The discrete energy is $E_h(t) = \\frac{1}{2}\\Delta x \\Delta y \\sum_{i,j} \\psi_{i,j}^2(t)$. The terms on the right-hand side of the energy balance are computed at time $t$. The power input from forcing is:\n$$\nP_{f,h}(t) = \\Delta x \\Delta y \\sum_{i,j} \\psi_{i,j}(t) f_{i,j}(t)\n$$\nThe collisional dissipation term requires the discrete gradient:\n$$\nD_{\\nu,h}(t) = \\nu \\Delta x \\Delta y \\sum_{i,j} \\left[ \\left(\\frac{\\psi_{i+1, j} - \\psi_{i-1, j}}{2\\Delta x}\\right)^2 + \\left(\\frac{\\psi_{i, j+1} - \\psi_{i, j-1}}{2\\Delta y}\\right)^2 \\right]\n$$\nThe source term $f$ is evaluated using its exact analytical expression derived from the manufactured solution, as specified.\n\nThe diagnostics to be computed are:\n\n-   **Energy-balance residual ($\\mathcal{N}$)**: This measures the extent to which the numerical scheme fails to conserve energy exactly. It is the numerical equivalent of numerical dissipation.\n    $$\n    \\mathcal{N} = \\frac{E_h(t+\\Delta t) - E_h(t)}{\\Delta t} - \\left( P_{f,h}(t) - D_{\\nu,h}(t) \\right)\n    $$\n-   **Effective numerical dissipation coefficient ($\\nu_{\\mathrm{num}}$)**: This normalizes the residual by the enstrophy-like term $\\int |\\nabla\\psi|^2\\,\\mathrm{d}A$.\n    $$\n    \\nu_{\\mathrm{num}} = \\frac{\\mathcal{N}}{\\int_h |\\nabla_h\\psi(t)|^2\\,\\mathrm{d}A} = \\frac{\\mathcal{N}}{D_{\\nu,h}(t) / \\nu}\n    $$\n-   **Spatial convergence error ($\\varepsilon$)**: This error measures how well the discretized spatial operators in the energy balance equation approximate their continuum counterparts. It compares the numerically computed RHS of the energy balance, $P_{f,h} - D_{\\nu,h}$, to the discrete integral of the exact power input into the energy, $\\int_h \\psi(\\partial_t\\psi)\\,\\mathrm{d}A$.\n    $$\n    \\varepsilon(N_x) = \\left| \\left( P_{f,h} - D_{\\nu,h} \\right) - \\left( \\Delta x \\Delta y \\sum_{i,j} \\psi_{i,j}(\\partial_t\\psi)_{i,j} \\right) \\right|\n    $$\n    Here, $(\\partial_t\\psi)_{i,j}$ is the analytically given time derivative.\n-   **Convergence order ($p$)**: For a scheme with error $\\varepsilon \\propto (\\Delta x)^p$, the order $p$ can be estimated from results at two different resolutions, $N_1$ and $N_2$, with grid spacings $h_1 = L_x/N_1$ and $h_2 = L_x/N_2$.\n    $$\n    p \\approx \\frac{\\log\\left(\\varepsilon(N_1)/\\varepsilon(N_2)\\right)}{\\log(h_1/h_2)} = \\frac{\\log\\left(\\varepsilon(N_1)/\\varepsilon(N_2)\\right)}{\\log(N_2/N_1)}\n    $$\n    The final result is obtained by averaging the order computed from the refinement sequence $16 \\to 32$ and $32 \\to 64$.\n\nThe implementation will use `numpy` for efficient array operations. A uniform grid is generated using `numpy.linspace` and `numpy.meshgrid`. Periodic finite differences are implemented efficiently using `numpy.roll`. The overall logic is encapsulated in a function that takes the physical and numerical parameters as input and returns the requested diagnostic quantities.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_diagnostics(Nx, Ny, kx, ky, w, nu, t0, dt, v_is_zero=False):\n    \"\"\"\n    Computes all specified diagnostics for the given set of parameters.\n    \"\"\"\n    # 1. Grid setup\n    Lx, Ly = 2 * np.pi, 2 * np.pi\n    dx, dy = Lx / Nx, Ly / Ny\n    x = np.linspace(0, Lx, Nx, endpoint=False)\n    y = np.linspace(0, Ly, Ny, endpoint=False)\n    xx, yy = np.meshgrid(x, y, indexing='ij')\n\n    # Helper function for numerical integration\n    def integrate(field):\n        return np.sum(field) * dx * dy\n\n    # 2. Evaluate fields and their analytic derivatives at t=t0\n    psi0 = np.sin(kx * xx) * np.sin(ky * yy) * np.cos(w * t0)\n\n    # Analytic forcing term f = ∂tψ + v⋅∇ψ - ν∇²ψ\n    dpsi_dt_analytic = -w * np.sin(kx * xx) * np.sin(ky * yy) * np.sin(w * t0)\n    dpsi_dx_analytic = kx * np.cos(kx * xx) * np.sin(ky * yy) * np.cos(w * t0)\n    dpsi_dy_analytic = ky * np.sin(kx * xx) * np.cos(ky * yy) * np.cos(w * t0)\n\n    if v_is_zero:\n        vx, vy = np.zeros_like(xx), np.zeros_like(yy)\n    else:\n        vx = -np.sin(xx) * np.sin(yy)\n        vy = -np.cos(xx) * np.cos(yy)\n        \n    advection_term = vx * dpsi_dx_analytic + vy * dpsi_dy_analytic\n    laplacian_psi_analytic_term = -nu * (-(kx**2 + ky**2) * psi0)\n\n    f0 = dpsi_dt_analytic + advection_term + laplacian_psi_analytic_term\n\n    # 3. Compute discrete RHS of energy balance at t=t0\n    # Power from forcing\n    Pf0 = integrate(psi0 * f0)\n    \n    # Dissipation from physical diffusion (using numerical derivatives)\n    dpsi_dx_numeric = (np.roll(psi0, -1, axis=0) - np.roll(psi0, 1, axis=0)) / (2 * dx)\n    dpsi_dy_numeric = (np.roll(psi0, -1, axis=1) - np.roll(psi0, 1, axis=1)) / (2 * dy)\n    \n    grad_psi_sq_numeric = dpsi_dx_numeric**2 + dpsi_dy_numeric**2\n    int_grad_psi_sq = integrate(grad_psi_sq_numeric)\n    D_nu0 = nu * int_grad_psi_sq\n    \n    RHS_balance = Pf0 - D_nu0\n    \n    # 4. Compute discrete LHS of energy balance\n    # Energy at t0 and t0+dt\n    psi_dt = np.sin(kx * xx) * np.sin(ky * yy) * np.cos(w * (t0 + dt))\n    E0 = 0.5 * integrate(psi0**2)\n    E_dt = 0.5 * integrate(psi_dt**2)\n    dE_dt_numeric = (E_dt - E0) / dt\n    \n    # 5. Compute final diagnostics\n    # Energy balance residual\n    N_residual = dE_dt_numeric - RHS_balance\n    \n    # Effective numerical dissipation coefficient\n    nu_num = N_residual / int_grad_psi_sq if int_grad_psi_sq != 0 else 0.0\n        \n    # Spatial convergence error epsilon\n    analytic_power_into_energy = integrate(psi0 * dpsi_dt_analytic)\n    epsilon = np.abs(RHS_balance - analytic_power_into_energy)\n\n    return {\n        'nu_num': nu_num,\n        'N_residual': N_residual,\n        'epsilon': epsilon,\n        'D_nu0': D_nu0,\n    }\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases_params = [\n        # Case 1: Happy-path numerical dissipation coefficient\n        {'type': 'nu_num', 'params': {'Nx': 32, 'Ny': 32, 'kx': 2, 'ky': 3, 'w': 0.7, 'nu': 0.05, 't0': 0.314, 'dt': 1e-3}},\n        # Case 2: Stationary boundary case\n        {'type': 'residual_check', 'params': {'Nx': 32, 'Ny': 32, 'kx': 1, 'ky': 1, 'w': 0, 'nu': 0, 't0': 0.0, 'dt': 1e-3, 'v_is_zero': True}},\n        # Case 3: Spatial convergence order\n        {'type': 'convergence', 'params': {'grids': [16, 32, 64], 'kx': 2, 'ky': 3, 'w': 0.7, 'nu': 0.05, 't0': 0.314, 'dt': 1e-4}},\n        # Case 4: High-collisional edge case\n        {'type': 'residual_ratio', 'params': {'Nx': 32, 'Ny': 32, 'kx': 2, 'ky': 3, 'w': 0.7, 'nu': 0.5, 't0': 0.314, 'dt': 1e-3}},\n    ]\n\n    results = []\n\n    for case in test_cases_params:\n        if case['type'] == 'nu_num':\n            diag = calculate_diagnostics(**case['params'])\n            results.append(diag['nu_num'])\n        \n        elif case['type'] == 'residual_check':\n            diag = calculate_diagnostics(**case['params'])\n            results.append(np.abs(diag['N_residual']) < 1e-12)\n            \n        elif case['type'] == 'convergence':\n            grids = case['params']['grids']\n            base_params = {k: v for k, v in case['params'].items() if k != 'grids'}\n            epsilons = []\n            for N in grids:\n                p = base_params.copy()\n                p.update({'Nx': N, 'Ny': N})\n                diag = calculate_diagnostics(**p)\n                epsilons.append(diag['epsilon'])\n            \n            p12 = np.log(epsilons[0] / epsilons[1]) / np.log(grids[1] / grids[0])\n            p23 = np.log(epsilons[1] / epsilons[2]) / np.log(grids[2] / grids[1])\n            p_avg = (p12 + p23) / 2\n            results.append(p_avg)\n            \n        elif case['type'] == 'residual_ratio':\n            diag = calculate_diagnostics(**case['params'])\n            ratio = diag['N_residual'] / diag['D_nu0'] if diag['D_nu0'] != 0 else 0.0\n            results.append(ratio)\n    \n    # Format results for final output string.\n    def format_result(r):\n        if isinstance(r, (bool, np.bool_)):\n            return str(r).lower()\n        return f\"{r:.16g}\"\n\n    print(f\"[{','.join(map(format_result, results))}]\")\n\nsolve()\n```"
        }
    ]
}