{
    "hands_on_practices": [
        {
            "introduction": "To understand transport in a stochastic magnetic field, we must first learn how to quantify the chaos itself. The Chirikov-Taylor standard map serves as a fundamental model for the behavior of magnetic field lines near resonant surfaces in a tokamak. In this exercise (), you will implement this map to compute two key metrics of chaos: the finite-time diffusion coefficient, which measures the field lines' radial wandering, and the maximal Lyapunov exponent, which quantifies the exponential separation of nearby field lines.",
            "id": "3720048",
            "problem": "Consider a mathematical model for stochastic magnetic field transport in nuclear fusion devices in which magnetic field lines are treated as trajectories of a Hamiltonian system. In action-angle coordinates $(\\theta,I)$, with the toroidal angle as the evolution parameter, magnetostatic field lines obey canonical Hamiltonian equations $d\\theta/d\\phi = \\partial H/\\partial I$ and $dI/d\\phi = -\\partial H/\\partial \\theta$, where $H(\\theta,I,\\phi)$ is $2\\pi$-periodic in the toroidal angle $\\phi$. For a single dominant resonant perturbation, the stroboscopic Poincaré map taken once per toroidal period reduces to the area-preserving, twist mapping known as the Chirikov–Taylor standard map, which serves as a mapping model for field lines near a rational surface. The standard map on the cylinder is defined by the canonical update rules\n$$\nI_{n+1} = I_n + K \\sin(\\theta_n), \\quad \\theta_{n+1} = \\theta_n + I_{n+1} \\mod 2\\pi,\n$$\nwhere $n$ indexes the crossings on the Poincaré section, $K$ is a nonnegative parameter proportional to the perturbation strength, $\\theta_n \\in [0,2\\pi)$ is an angle variable, and $I_n \\in \\mathbb{R}$ is an action-like variable proportional to the radial excursion. In this model, field-line transport is quantified by two measures:\n1. A finite-time diffusion coefficient\n$$\nD_N(K) = \\frac{1}{2N}\\left\\langle (I_N - I_0)^2 \\right\\rangle,\n$$\nwhere $\\langle \\cdot \\rangle$ denotes an average over a specified ensemble of initial conditions, and $N$ is the number of map iterations.\n2. A finite-time maximal Lyapunov exponent\n$$\n\\lambda_N(K) = \\left\\langle \\frac{1}{N}\\sum_{n=0}^{N-1} \\ln \\frac{\\left\\|\\delta \\mathbf{v}_{n+1}\\right\\|}{\\left\\|\\delta \\mathbf{v}_{n}\\right\\|} \\right\\rangle,\n$$\ncomputed from the tangent map that evolves an infinitesimal perturbation $\\delta \\mathbf{v}_n = (\\delta \\theta_n, \\delta I_n)$ via the Jacobian\n$$\nJ(\\theta_n) = \n\\begin{pmatrix}\n1 + K \\cos(\\theta_n)  1 \\\\\nK \\cos(\\theta_n)  1\n\\end{pmatrix},\n$$\nwith the norm $\\|\\cdot\\|$ taken to be the Euclidean norm. This Lyapunov exponent measures the average exponential rate of separation between nearby field lines and is a canonical indicator of chaos. The map is area-preserving with $\\det J(\\theta_n) = 1$, and the system exhibits Kolmogorov–Arnold–Moser (KAM) invariant curves at sufficiently small $K$, which progressively break up as $K$ increases.\n\nTask: Starting from the canonical Hamiltonian structure of magnetostatic field lines and the stroboscopic reduction to a discrete, area-preserving map, implement a program that for each test case listed below:\n- Evolves the standard map for $N$ iterations for an ensemble of $M$ deterministic initial conditions defined by $\\theta_0$ uniformly spaced in $[0,2\\pi)$ and $I_0 = 0$ for all ensemble members. Use angles in radians.\n- Computes $D_N(K)$ by averaging $(I_N - I_0)^2$ over the ensemble and dividing by $2N$.\n- Computes $\\lambda_N(K)$ by simultaneously evolving the tangent dynamics under $J(\\theta_n)$ for each member of the ensemble. Initialize the tangent vector as $(\\delta \\theta_0,\\delta I_0) = (1,0)$ for all members, and at each step, accumulate the logarithm of the norm increase and renormalize the tangent vector to unit norm to prevent numerical overflow. Average the finite-time exponent over the ensemble to obtain $\\lambda_N(K)$.\n\nAngles must be treated in radians. There are no physical units to report for $D_N(K)$ or $\\lambda_N(K)$ since the model is dimensionless.\n\nTest Suite:\n- Case 1 (integrable boundary): $K = 0.0$, $N = 4000$, $M = 128$.\n- Case 2 (near-integrable): $K = 0.5$, $N = 4000$, $M = 128$.\n- Case 3 (near critical KAM breakup): $K = 0.971635$, $N = 8000$, $M = 128$.\n- Case 4 (strongly chaotic): $K = 3.0$, $N = 4000$, $M = 128$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list $[D_N(K),\\lambda_N(K)]$ with both entries formatted as decimal floats rounded to six places. The final output must have no spaces. For example, an output for two cases would look like $[[0.000000,0.000000],[1.234567,0.890123]]$.\n\nThe objectives are:\n- Ensure scientific realism by using the canonical structure of field-line dynamics and an area-preserving map to model the Poincaré transport.\n- Demonstrate first-principles reasoning by basing the map and tangent dynamics on Hamiltonian formalism and Jacobian propagation without invoking ad hoc transport formulas.\n- Provide numerically stable and deterministic computations using the specified ensemble and renormalization protocol.",
            "solution": "The problem requires the implementation of a numerical simulation to compute two key transport metrics—the finite-time diffusion coefficient $D_N(K)$ and the finite-time maximal Lyapunov exponent $\\lambda_N(K)$—for the Chirikov-Taylor standard map. This map is a paradigmatic model in Hamiltonian dynamics, representing the stroboscopic evolution of magnetic field lines near a resonant magnetic surface in a toroidal fusion device. The solution is founded on the direct numerical integration of the map equations and the associated tangent map for a statistical ensemble of initial conditions.\n\nThe entire process is rooted in first principles, beginning with the canonical Hamiltonian structure of magnetostatic field lines, which guarantees that their evolution preserves phase-space volume. The reduction to a discrete, area-preserving map like the standard map is a standard technique in plasma physics and nonlinear dynamics. The area-preserving property, mathematically expressed as $\\det(J)=1$ where $J$ is the map's Jacobian, is a direct consequence of the underlying Hamiltonian formalism.\n\nThe algorithm is designed as follows:\n\n**1. Ensemble Initialization**\n\nTo obtain statistically meaningful transport coefficients, we simulate an ensemble of $M$ trajectories. The problem specifies deterministic initial conditions.\n- The initial action-like variable is set to $I_0 = 0$ for all $M$ members of the ensemble. This corresponds to starting all field lines on the unperturbed resonant surface.\n- The initial angle variable $\\theta_0$ is distributed uniformly over the interval $[0, 2\\pi)$. For a deterministic, reproducible computation, we generate $M$ equally spaced points using the formula $\\theta_{0,j} = \\frac{2\\pi j}{M}$ for $j=0, 1, \\dots, M-1$.\n\n**2. State Vector Evolution**\n\nFor each of the $M$ initial conditions $(\\theta_{0,j}, I_{0,j})$, the standard map is iterated for $N$ steps. The state at step $n+1$ is computed from the state at step $n$ using the canonical update rules:\n$$\nI_{n+1} = I_n + K \\sin(\\theta_n)\n$$\n$$\n\\theta_{n+1} = (\\theta_n + I_{n+1}) \\pmod{2\\pi}\n$$\nHere, the modulo operation ensures that the angle $\\theta$ remains in the fundamental domain $[0, 2\\pi)$. These equations are applied iteratively for $n = 0, 1, \\dots, N-1$ to obtain the final states $(\\theta_{N,j}, I_{N,j})$.\n\n**3. Computation of the Diffusion Coefficient $D_N(K)$**\n\nThe diffusion coefficient $D_N(K)$ quantifies the mean-square displacement of the action variable $I$ over $N$ iterations, averaged over the ensemble. It is a measure of the radial transport of the field lines. Its definition is:\n$$\nD_N(K) = \\frac{1}{2N}\\left\\langle (I_N - I_0)^2 \\right\\rangle\n$$\nThe angle brackets $\\langle \\cdot \\rangle$ denote the ensemble average. With our specific ensemble where $I_0 = 0$ for all members, the computation simplifies to:\n$$\nD_N(K) = \\frac{1}{2N} \\left( \\frac{1}{M} \\sum_{j=1}^{M} (I_{N,j})^2 \\right) = \\frac{1}{2NM} \\sum_{j=1}^{M} I_{N,j}^2\n$$\nThis is computed after the $N$ iterations are complete by calculating the mean of the squared final action values $I_{N,j}^2$ and scaling by the factor $1/(2N)$.\n\n**4. Computation of the Lyapunov Exponent $\\lambda_N(K)$**\n\nThe maximal Lyapunov exponent $\\lambda_N(K)$ measures the average exponential rate of divergence of nearby trajectories, a fundamental indicator of chaos. It is calculated by evolving an infinitesimal tangent vector $\\delta \\mathbf{v}_n = (\\delta \\theta_n, \\delta I_n)$ along a trajectory. The evolution of this vector is governed by the tangent map, which is a linear transformation defined by the Jacobian matrix $J(\\theta_n)$:\n$$\n\\delta \\mathbf{v}_{n+1} = J(\\theta_n) \\delta \\mathbf{v}_n, \\quad \\text{where} \\quad J(\\theta_n) =\n\\begin{pmatrix}\n1 + K \\cos(\\theta_n)  1 \\\\\nK \\cos(\\theta_n)  1\n\\end{pmatrix}\n$$\nDirectly iterating this linear map would lead to numerical overflow, as the norm of $\\delta \\mathbf{v}_n$ grows exponentially in chaotic regions. To ensure numerical stability, a standard renormalization procedure is employed at each step of the iteration for each trajectory in the ensemble.\n\nThe procedure is as follows:\n- **Initialization**: For each trajectory $j$, the initial tangent vector is set to a unit vector, specified as $\\delta \\mathbf{v}_{0,j} = (1, 0)$. A running sum for the logarithms of the growth factors, $S_j$, is initialized to $0$.\n- **Iteration ($n=0, \\dots, N-1$)**:\n    1. Evolve the tangent vector one step using the Jacobian evaluated at the trajectory's current position $\\theta_{n,j}$: $\\delta \\mathbf{v}'_{n+1,j} = J(\\theta_{n,j}) \\delta \\mathbf{v}_{n,j}$.\n    2. Compute the Euclidean norm of the resulting vector: $d_{n+1,j} = \\|\\delta \\mathbf{v}'_{n+1,j}\\|$. This represents the local stretching factor at step $n+1$.\n    3. Add the natural logarithm of this factor to the running sum: $S_j \\leftarrow S_j + \\ln(d_{n+1,j})$.\n    4. Renormalize the tangent vector to unit length for the next iteration: $\\delta \\mathbf{v}_{n+1,j} = \\delta \\mathbf{v}'_{n+1,j} / d_{n+1,j}$.\n- **Final Calculation**: After $N$ iterations, the finite-time Lyapunov exponent for each trajectory is $\\lambda_{N,j} = S_j / N$. The final value is the average over the ensemble:\n$$\n\\lambda_N(K) = \\langle \\lambda_{N,j} \\rangle = \\frac{1}{M} \\sum_{j=1}^{M} \\frac{S_j}{N}\n$$\nThis algorithm correctly implements the definition of the Lyapunov exponent, $\\lambda_N(K) = \\frac{1}{N} \\langle \\sum_{n=0}^{N-1} \\ln (\\|\\delta \\mathbf{v}_{n+1}\\| / \\|\\delta \\mathbf{v}_n\\|) \\rangle$, because the renormalization at each step ensures that $\\|\\delta \\mathbf{v}_n\\|$ is always $1$.\n\nThe implementation will utilize `numpy` for vectorized operations across the ensemble, greatly improving computational efficiency. Each test case will be processed sequentially, applying the above algorithms to generate the pair $[D_N(K), \\lambda_N(K)]$ which are then formatted into the required output string.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_transport_coeffs(K, N, M):\n    \"\"\"\n    Computes the finite-time diffusion coefficient and Lyapunov exponent for the standard map.\n\n    Args:\n        K (float): The stochasticity parameter of the standard map.\n        N (int): The number of map iterations.\n        M (int): The number of ensemble members.\n\n    Returns:\n        tuple[float, float]: A tuple containing (D_N, lambda_N).\n    \"\"\"\n    # 1. Initialize ensemble and state variables\n    # Initial angles are uniformly spaced in [0, 2*pi).\n    thetas = np.linspace(0.0, 2.0 * np.pi, M, endpoint=False)\n    # Initial actions are all zero.\n    Is = np.zeros(M, dtype=np.float64)\n\n    # 2. Initialize tangent vectors and Lyapunov exponent accumulator\n    # Initial tangent vectors are (1, 0) for all ensemble members.\n    delta_thetas = np.ones(M, dtype=np.float64)\n    delta_Is = np.zeros(M, dtype=np.float64)\n    # Accumulator for the sum of logarithms of norms for each trajectory.\n    log_norm_sum = np.zeros(M, dtype=np.float64)\n\n    # 3. Evolve the map and tangent vectors for N steps\n    for _ in range(N):\n        # Store current theta for Jacobian calculation\n        theta_n = thetas\n        \n        # Update state vector (I, theta) according to the standard map equations\n        I_next = Is + K * np.sin(theta_n)\n        theta_next = np.mod(theta_n + I_next, 2.0 * np.pi)\n        \n        # Update states for the next iteration\n        thetas = theta_next\n        Is = I_next\n        \n        # Evolve the tangent vector using the Jacobian matrix\n        # J(theta_n) = [[1 + K*cos(theta_n), 1], [K*cos(theta_n), 1]]\n        K_cos_theta = K * np.cos(theta_n)\n        \n        d_theta_prime = (1.0 + K_cos_theta) * delta_thetas + delta_Is\n        d_I_prime = K_cos_theta * delta_thetas + delta_Is\n        \n        # Calculate the Euclidean norm of the new tangent vector\n        norms = np.sqrt(d_theta_prime**2 + d_I_prime**2)\n        \n        # Add the log of the norm to the accumulator.\n        # Handle cases where norm might be zero to avoid log(0).\n        # For this problem, with initial vector (1,0), norms will be = 1 for K=0.\n        log_norm_sum += np.log(norms)\n        \n        # Renormalize the tangent vector to unit length\n        # Add a small epsilon to avoid division by zero, although not strictly necessary here.\n        # As norms = 1, we can safely divide.\n        delta_thetas = d_theta_prime / norms\n        delta_Is = d_I_prime / norms\n\n    # 4. Calculate final transport coefficients\n    # Diffusion coefficient: D_N = (I_N - I_0)^2 / (2*N)\n    # Since I_0 = 0, this simplifies to I_N^2 / (2*N)\n    I_N_squared = Is**2\n    D_N = np.mean(I_N_squared) / (2.0 * N)\n    \n    # Lyapunov exponent: lambda_N =  (1/N) * sum(log(norms)) \n    lambda_N = np.mean(log_norm_sum) / N\n    \n    return D_N, lambda_N\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (K, N, M)\n        (0.0, 4000, 128),\n        (0.5, 4000, 128),\n        (0.971635, 8000, 128),\n        (3.0, 4000, 128),\n    ]\n\n    results = []\n    for K, N, M in test_cases:\n        D_N, lambda_N = compute_transport_coeffs(K, N, M)\n        results.append(f\"[{D_N:.6f},{lambda_N:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "The chaotic wandering of magnetic field lines, which we quantified in the previous exercise, directly causes particles and heat to be transported across the confining field. The Green-Kubo formalism provides a powerful theoretical bridge connecting the microscopic statistical properties of these fluctuations to macroscopic transport coefficients. This practice () guides you through the derivation of the renowned Rechester-Rosenbluth heat diffusivity, starting from first principles and incorporating the combined effects of the magnetic field's stochastic structure and turbulent plasma scattering.",
            "id": "3705786",
            "problem": "In a toroidal magnetic confinement device, overlapping magnetic islands produce a stochastic magnetic field that drives electron heat transport via the Rechester–Rosenbluth mechanism (Rechester–Rosenbluth (RR)). Consider electrons moving along stochastic magnetic field lines with an instantaneous radial velocity modeled as $v_{r}(t) = v_{\\parallel}(t)\\, b_{r}(s(t))$, where $v_{\\parallel}$ is the parallel speed and $b_{r} \\equiv \\delta B_{r}/B$ is the normalized radial magnetic perturbation. Assume the following physically motivated statistical properties for the fluctuating quantities:\n- The electron parallel velocity autocorrelation decays exponentially due to turbulent pitch-angle scattering with a finite parallel correlation time $\\tau_{\\parallel}$, i.e., $\\langle v_{\\parallel}(0)\\, v_{\\parallel}(t)\\rangle = v_{\\text{th},e}^{2}\\, \\exp(-t/\\tau_{\\parallel})$, where $v_{\\text{th},e} = \\sqrt{2 T_{e}/m_{e}}$ is the electron thermal speed, $T_{e}$ is the electron temperature expressed in energy units, and $m_{e}$ is the electron mass.\n- The normalized radial magnetic perturbation correlation along the field line decays exponentially with parallel arc length $s$ over a correlation length $L_{c}$, i.e., $\\langle b_{r}(0)\\, b_{r}(s)\\rangle = (\\delta B/B)^{2}\\, \\exp(-|s|/L_{c})$, where $\\delta B/B$ is the root-mean-square fractional magnetic perturbation amplitude.\n- Over a correlation interval, the parallel motion is approximately ballistic, so that $s(t) \\approx v_{\\text{th},e}\\, t$.\n\nStarting from the Green–Kubo definition of the cross-field heat diffusivity,\n$$\n\\chi_{e} = \\int_{0}^{\\infty} \\langle v_{r}(0)\\, v_{r}(t)\\rangle \\, dt,\n$$\nderive a closed-form expression for the effective electron heat diffusivity $\\chi_{e,\\text{eff}}$ that accounts for both magnetic decorrelation along the field line and finite parallel correlation time due to turbulent scattering. Then, evaluate $\\chi_{e,\\text{eff}}$ numerically for the following parameters representative of a tokamak plasma with island overlap:\n- Major radius $R = 1.8\\,\\text{m}$, safety factor $q = 2.7$, so that $L_{c} = \\pi q R$,\n- Electron temperature $T_{e} = 2.5\\,\\text{keV}$,\n- Fractional magnetic perturbation amplitude $\\delta B/B = 7.0 \\times 10^{-4}$,\n- Parallel correlation time $\\tau_{\\parallel} = 3.0\\,\\mu\\text{s}$.\n\nRound your final numerical answer for $\\chi_{e,\\text{eff}}$ to three significant figures. Express the value of $\\chi_{e,\\text{eff}}$ in $\\text{m}^{2}\\,\\text{s}^{-1}$.",
            "solution": "The problem is deemed valid as it is scientifically grounded in the principles of plasma physics and statistical mechanics, is well-posed with sufficient information and clear definitions to permit a unique solution, and is stated in objective, formal language. We may proceed with the solution.\n\nThe problem asks for the derivation of the effective electron heat diffusivity $\\chi_{e,\\text{eff}}$ and its subsequent numerical evaluation. We begin with the provided Green–Kubo definition of the cross-field heat diffusivity:\n$$\n\\chi_{e} = \\int_{0}^{\\infty} \\langle v_{r}(0)\\, v_{r}(t)\\rangle \\, dt\n$$\nThe instantaneous radial velocity is given by the model $v_{r}(t) = v_{\\parallel}(t)\\, b_{r}(s(t))$, where $v_{\\parallel}(t)$ is the parallel speed, $b_{r}(s(t))$ is the normalized radial magnetic perturbation, and $s(t)$ is the parallel arc length coordinate. The integrand of the Green-Kubo formula is the autocorrelation function of this radial velocity:\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = \\langle [v_{\\parallel}(0)\\, b_{r}(s(0))] \\cdot [v_{\\parallel}(t)\\, b_{r}(s(t))] \\rangle\n$$\nAt time $t=0$, the arc length is $s(0)=0$. The expression becomes:\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = \\langle v_{\\parallel}(0)\\, b_{r}(0) \\, v_{\\parallel}(t)\\, b_{r}(s(t)) \\rangle\n$$\nA standard and physically motivated assumption in such models is that the fluctuations in the parallel velocity, driven by turbulent pitch-angle scattering, are statistically independent of the spatial fluctuations of the magnetic field, which are caused by distinct physical phenomena like magnetohydrodynamic (MHD) instabilities or external resonant fields. This statistical independence allows the four-point correlation function to be decomposed into a product of two-point correlation functions:\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = \\langle v_{\\parallel}(0)\\, v_{\\parallel}(t)\\rangle \\langle b_{r}(0)\\, b_{r}(s(t)) \\rangle\n$$\nThe problem provides the explicit forms for these correlation functions:\n$$\n\\langle v_{\\parallel}(0)\\, v_{\\parallel}(t)\\rangle = v_{\\text{th},e}^{2}\\, \\exp(-t/\\tau_{\\parallel})\n$$\n$$\n\\langle b_{r}(0)\\, b_{r}(s)\\rangle = (\\delta B/B)^{2}\\, \\exp(-|s|/L_{c})\n$$\nSubstituting these into the expression for the radial velocity autocorrelation yields:\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = \\left( v_{\\text{th},e}^{2}\\, \\exp(-t/\\tau_{\\parallel}) \\right) \\left( (\\delta B/B)^{2}\\, \\exp(-|s(t)|/L_{c}) \\right)\n$$\nThe problem states to use the approximation of ballistic parallel motion for an electron over a correlation interval, which is expressed as $s(t) \\approx v_{\\text{th},e}\\, t$. For the integral domain $t \\ge 0$, this implies $|s(t)| = v_{\\text{th},e}\\, t$. Substituting this into the correlation function gives:\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = v_{\\text{th},e}^{2} (\\delta B/B)^{2} \\exp(-t/\\tau_{\\parallel}) \\exp(-v_{\\text{th},e} t / L_{c})\n$$\nBy combining the exponential terms, we obtain:\n$$\n\\langle v_{r}(0)\\, v_{r}(t)\\rangle = v_{\\text{th},e}^{2} (\\delta B/B)^{2} \\exp\\left( -t \\left( \\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}} \\right) \\right)\n$$\nWe can now perform the integration required by the Green–Kubo formula to find the effective heat diffusivity, which we denote $\\chi_{e,\\text{eff}}$:\n$$\n\\chi_{e,\\text{eff}} = \\int_{0}^{\\infty} v_{\\text{th},e}^{2} (\\delta B/B)^{2} \\exp\\left( -t \\left( \\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}} \\right) \\right) dt\n$$\nThe terms independent of the integration variable $t$ can be factored out:\n$$\n\\chi_{e,\\text{eff}} = v_{\\text{th},e}^{2} (\\delta B/B)^{2} \\int_{0}^{\\infty} \\exp\\left( -t \\left( \\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}} \\right) \\right) dt\n$$\nThe integral is of the standard form $\\int_{0}^{\\infty} \\exp(-at)\\,dt = 1/a$, where the rate constant is $a = \\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}}$. Performing the integration yields the final closed-form expression for the effective electron heat diffusivity:\n$$\n\\chi_{e,\\text{eff}} = \\frac{v_{\\text{th},e}^{2} (\\delta B/B)^{2}}{\\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}}}\n$$\nThis expression correctly incorporates the combined decorrelation effects from both parallel velocity scattering (with timescale $\\tau_{\\parallel}$) and magnetic field structure (with an effective transit timescale $L_c / v_{\\text{th},e}$).\n\nNext, we evaluate this expression numerically using the provided parameters and fundamental physical constants. All calculations will be performed in SI units. The given parameters are:\n- Major radius: $R = 1.8\\,\\text{m}$\n- Safety factor: $q = 2.7$\n- Electron temperature: $T_{e} = 2.5\\,\\text{keV}$\n- Magnetic perturbation amplitude: $\\delta B/B = 7.0 \\times 10^{-4}$\n- Parallel correlation time: $\\tau_{\\parallel} = 3.0\\,\\mu\\text{s} = 3.0 \\times 10^{-6}\\,\\text{s}$\n\nWe also use the following fundamental constants:\n- Electron mass: $m_{e} \\approx 9.10938 \\times 10^{-31}\\,\\text{kg}$\n- Elementary charge: $e \\approx 1.60218 \\times 10^{-19}\\,\\text{C}$, leading to the conversion $1\\,\\text{keV} \\approx 1.60218 \\times 10^{-16}\\,\\text{J}$.\n\nFirst, we calculate the necessary derived quantities:\n$1$. The magnetic field correlation length $L_{c}$:\n$$L_{c} = \\pi q R = \\pi \\times 2.7 \\times 1.8\\,\\text{m} \\approx 15.2681\\,\\text{m}$$\n$2$. The electron temperature in Joules, noting that $T_e$ is given in energy units:\n$$T_{e} = 2.5\\,\\text{keV} \\times \\frac{1.60218 \\times 10^{-16}\\,\\text{J}}{1\\,\\text{keV}} \\approx 4.00545 \\times 10^{-16}\\,\\text{J}$$\n$3$. The electron thermal speed $v_{\\text{th},e}$:\n$$v_{\\text{th},e} = \\sqrt{\\frac{2 T_{e}}{m_{e}}} = \\sqrt{\\frac{2 \\times (4.00545 \\times 10^{-16}\\,\\text{J})}{9.10938 \\times 10^{-31}\\,\\text{kg}}} \\approx \\sqrt{8.7940 \\times 10^{14}\\,\\text{m}^{2}\\,\\text{s}^{-2}} \\approx 2.96547 \\times 10^{7}\\,\\text{m}\\,\\text{s}^{-1}$$\n\nNow, we compute the numerator and denominator of the expression for $\\chi_{e,\\text{eff}}$.\n- Numerator, $v_{\\text{th},e}^{2} (\\delta B/B)^{2}$:\n$$v_{\\text{th},e}^{2} (\\delta B/B)^{2} = (2.96547 \\times 10^{7}\\,\\text{m}\\,\\text{s}^{-1})^{2} \\times (7.0 \\times 10^{-4})^{2}$$\n$$\\approx (8.7940 \\times 10^{14}\\,\\text{m}^{2}\\,\\text{s}^{-2}) \\times (4.9 \\times 10^{-7}) \\approx 4.30906 \\times 10^{8}\\,\\text{m}^{2}\\,\\text{s}^{-2}$$\n- Denominator, which is the sum of two decorrelation rates, $\\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}}$:\n  - The scattering rate: $\\frac{1}{\\tau_{\\parallel}} = \\frac{1}{3.0 \\times 10^{-6}\\,\\text{s}} \\approx 3.33333 \\times 10^{5}\\,\\text{s}^{-1}$\n  - The magnetic structure transit rate: $\\frac{v_{\\text{th},e}}{L_{c}} = \\frac{2.96547 \\times 10^{7}\\,\\text{m}\\,\\text{s}^{-1}}{15.2681\\,\\text{m}} \\approx 1.94228 \\times 10^{6}\\,\\text{s}^{-1}$\n  - The total rate in the denominator is their sum:\n    $$\\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}} \\approx (3.33333 \\times 10^{5} + 1.94228 \\times 10^{6})\\,\\text{s}^{-1} \\approx 2.27561 \\times 10^{6}\\,\\text{s}^{-1}$$\n\nFinally, we calculate $\\chi_{e,\\text{eff}}$ by dividing the numerator by the denominator:\n$$\n\\chi_{e,\\text{eff}} = \\frac{v_{\\text{th},e}^{2} (\\delta B/B)^{2}}{\\frac{1}{\\tau_{\\parallel}} + \\frac{v_{\\text{th},e}}{L_{c}}} \\approx \\frac{4.30906 \\times 10^{8}\\,\\text{m}^{2}\\,\\text{s}^{-2}}{2.27561 \\times 10^{6}\\,\\text{s}^{-1}} \\approx 189.359\\,\\text{m}^{2}\\,\\text{s}^{-1}\n$$\nThe problem requires the final numerical answer to be rounded to three significant figures.\n$$\n\\chi_{e,\\text{eff}} \\approx 189\\,\\text{m}^{2}\\,\\text{s}^{-1}\n$$",
            "answer": "$$\\boxed{189}$$"
        },
        {
            "introduction": "Armed with an understanding of how to calculate transport coefficients, the final step is to use them in predictive models of plasma behavior. Real plasmas exhibit complex spatial structures, including regions of strong and weak transport, and may contain transport barriers that impede heat flow. This capstone exercise () challenges you to build a steady-state heat transport model for a system with piecewise-constant diffusivity and a partial thermal barrier, demonstrating how the fundamental physics of stochastic transport informs practical models of heat flux in a fusion device.",
            "id": "3720082",
            "problem": "Consider steady radial heat transport in a toroidally confined plasma in which the magnetic field lines are stochastic. Assume that, in the collisionless limit, rapid parallel conduction makes the temperature nearly constant along a stochastic field line and that cross-field heat transport arises from the field-line radial wandering. Use the following foundational facts as the starting point:\n\n- The effective heat flux density across magnetic surfaces satisfies $q_{r} = - H \\, \\chi_{\\mathrm{eff}}(r) \\, \\frac{dT}{dr}$, where $H = n C_{v}$ is the volumetric heat capacity (in $\\mathrm{J}/(\\mathrm{m}^{3}\\,\\mathrm{K})$), and $\\chi_{\\mathrm{eff}}$ is the cross-field thermal diffusivity (in $\\mathrm{m}^{2}/\\mathrm{s}$).\n- For stochastic field lines with parallel arclength $s$ and mean-square radial displacement $\\langle \\Delta r^{2} \\rangle = 2 D_{\\mathrm{fl}} \\, s$, where $D_{\\mathrm{fl}}$ is the field-line diffusion coefficient (in $\\mathrm{m}$), the ballistic parallel motion $s \\approx v_{\\parallel} t$ with characteristic parallel speed $v_{\\parallel}$ (in $\\mathrm{m}/\\mathrm{s}$) implies an effective cross-field diffusivity $\\chi_{\\mathrm{eff}} \\approx v_{\\parallel} D_{\\mathrm{fl}}$ (in $\\mathrm{m}^{2}/\\mathrm{s}$).\n- For a single-scale magnetic perturbation with parallel correlation length $L_{c}$ (in $\\mathrm{m}$) and normalized magnetic fluctuation amplitude $\\delta B/B$ (dimensionless), a well-tested estimate for the field-line diffusion is $D_{\\mathrm{fl}} \\approx (\\delta B/B)^{2} L_{c}$.\n- A partial barrier to radial heat flow located at radius $r = r_{b}$ can be modeled as an interface thermal resistance per unit area $R_{b}$ (in $\\mathrm{m}^{2}\\,\\mathrm{K}/\\mathrm{W}$), producing a temperature jump $\\Delta T_{\\mathrm{barrier}} = q_{r} \\, R_{b}$ under steady, one-dimensional conditions.\n\nAssume a cylindrical radial domain $r \\in [0,a]$ with $a > 0$, steady state with no internal sources, and a boundary temperature $T(0) = T_{0}$ and $T(a) = T_{a}$. Let $H$ be radially constant. Let the effective cross-field diffusivity be piecewise constant: $\\chi_{\\mathrm{eff}}(r) = \\chi_{\\mathrm{L}}$ for $0 \\le r  r_{b}$ and $\\chi_{\\mathrm{eff}}(r) = \\chi_{\\mathrm{R}}$ for $r_{b}  r \\le a$, with a single barrier of resistance $R_{b}$ at $r = r_{b}$. The diffusivities $\\chi_{\\mathrm{L}}$ and $\\chi_{\\mathrm{R}}$ must be computed from the given magnetic parameters using the relations above.\n\nYour task is to compute the steady, uniform radial heat flux $q_{r}$ for several parameter sets. By integrating the one-dimensional steady conduction law and enforcing the interface condition at the barrier, the result can be expressed in terms of the boundary temperatures, the material property $H$, the piecewise diffusivities, and the barrier resistance. You must:\n\n- Derive the needed expressions starting only from the items listed above.\n- Implement a program that, for each test case, computes $q_{r}$ and reports it in $\\mathrm{W}/\\mathrm{m}^{2}$, rounded to the nearest integer.\n\nUse the following fixed global parameters (identical for all test cases):\n\n- Domain size: $a = 1.0\\,\\mathrm{m}$.\n- Barrier location: $r_{b} = 0.5\\,\\mathrm{m}$.\n- Volumetric heat capacity: $H = 4.0 \\times 10^{-3}\\,\\mathrm{J}/(\\mathrm{m}^{3}\\,\\mathrm{K})$.\n- Inner boundary temperature: $T_{0} = 1.5 \\times 10^{7}\\,\\mathrm{K}$.\n- Outer boundary temperature: $T_{a} = 1.0 \\times 10^{7}\\,\\mathrm{K}$.\n- Parallel speed: $v_{\\parallel} = 1.5 \\times 10^{7}\\,\\mathrm{m}/\\mathrm{s}$.\n\nFor each test case $i$, you are given:\n- Left correlation length $L_{c,\\mathrm{L}}$ (in $\\mathrm{m}$).\n- Right correlation length $L_{c,\\mathrm{R}}$ (in $\\mathrm{m}$).\n- Left fluctuation amplitude $(\\delta B/B)_{\\mathrm{L}}$ (dimensionless).\n- Right fluctuation amplitude $(\\delta B/B)_{\\mathrm{R}}$ (dimensionless).\n- Barrier resistance $R_{b}$ (in $\\mathrm{m}^{2}\\,\\mathrm{K}/\\mathrm{W}$).\n\nCompute:\n- $D_{\\mathrm{fl},\\mathrm{L}} = [(\\delta B/B)_{\\mathrm{L}}]^{2} \\, L_{c,\\mathrm{L}}$ and $D_{\\mathrm{fl},\\mathrm{R}} = [(\\delta B/B)_{\\mathrm{R}}]^{2} \\, L_{c,\\mathrm{R}}$.\n- $\\chi_{\\mathrm{L}} = v_{\\parallel} D_{\\mathrm{fl},\\mathrm{L}}$ and $\\chi_{\\mathrm{R}} = v_{\\parallel} D_{\\mathrm{fl},\\mathrm{R}}$.\n- The steady flux $q_{r}$ in $\\mathrm{W}/\\mathrm{m}^{2}$, rounded to the nearest integer.\n\nTest suite (four cases that probe typical, no-barrier, strong-barrier, and asymmetric-transport regimes):\n\n- Case $1$ (typical, moderate barrier):\n  - $L_{c,\\mathrm{L}} = 10.0\\,\\mathrm{m}$, $L_{c,\\mathrm{R}} = 10.0\\,\\mathrm{m}$,\n  - $(\\delta B/B)_{\\mathrm{L}} = 1.0 \\times 10^{-3}$, $(\\delta B/B)_{\\mathrm{R}} = 1.0 \\times 10^{-3}$,\n  - $R_{b} = 0.3\\,\\mathrm{m}^{2}\\,\\mathrm{K}/\\mathrm{W}$.\n\n- Case $2$ (no barrier):\n  - $L_{c,\\mathrm{L}} = 10.0\\,\\mathrm{m}$, $L_{c,\\mathrm{R}} = 10.0\\,\\mathrm{m}$,\n  - $(\\delta B/B)_{\\mathrm{L}} = 1.0 \\times 10^{-3}$, $(\\delta B/B)_{\\mathrm{R}} = 1.0 \\times 10^{-3}$,\n  - $R_{b} = 0.0\\,\\mathrm{m}^{2}\\,\\mathrm{K}/\\mathrm{W}$.\n\n- Case $3$ (strong barrier):\n  - $L_{c,\\mathrm{L}} = 10.0\\,\\mathrm{m}$, $L_{c,\\mathrm{R}} = 10.0\\,\\mathrm{m}$,\n  - $(\\delta B/B)_{\\mathrm{L}} = 1.0 \\times 10^{-3}$, $(\\delta B/B)_{\\mathrm{R}} = 1.0 \\times 10^{-3}$,\n  - $R_{b} = 10.0\\,\\mathrm{m}^{2}\\,\\mathrm{K}/\\mathrm{W}$.\n\n- Case $4$ (asymmetric stochasticity and moderate barrier):\n  - $L_{c,\\mathrm{L}} = 10.0\\,\\mathrm{m}$, $L_{c,\\mathrm{R}} = 5.0\\,\\mathrm{m}$,\n  - $(\\delta B/B)_{\\mathrm{L}} = 5.0 \\times 10^{-4}$, $(\\delta B/B)_{\\mathrm{R}} = 2.0 \\times 10^{-3}$,\n  - $R_{b} = 0.1\\,\\mathrm{m}^{2}\\,\\mathrm{K}/\\mathrm{W}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"). Each result must be the integer value of $q_{r}$ in $\\mathrm{W}/\\mathrm{m}^{2}$ for the corresponding test case, rounded to the nearest integer.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of plasma physics and heat transfer, well-posed with a clear path to a unique solution, and all terms and conditions are sufficiently defined. The apparent conflict between \"cylindrical radial domain\" and \"uniform radial heat flux\" is interpreted as a standard pedagogical simplification, directing the use of a one-dimensional slab geometry model where the heat flux density is constant, which is a common approach in such problems.\n\nThe solution is derived by applying the principles of steady-state heat conduction across a multi-layered medium with an interface resistance.\n\nThe foundational equation for the radial heat flux density, $q_r$, is given as:\n$$\nq_{r} = - H \\, \\chi_{\\mathrm{eff}}(r) \\, \\frac{dT}{dr}\n$$\nHere, $H$ is the constant volumetric heat capacity, $\\chi_{\\mathrm{eff}}(r)$ is the piecewise constant effective thermal diffusivity, and $T(r)$ is the temperature profile. We are given that the problem is in a steady state with no internal heat sources, and the radial heat flux $q_r$ is uniform (constant with respect to $r$). This allows us to rearrange the equation to solve for the temperature gradient:\n$$\n\\frac{dT}{dr} = - \\frac{q_r}{H \\, \\chi_{\\mathrm{eff}}(r)}\n$$\nThe total temperature drop across the domain from $r=0$ to $r=a$ is $T(0) - T(a) = T_0 - T_a$. This total drop is the sum of the temperature drops across the three distinct thermal barriers: the inner region ($0 \\le r  r_b$), the interface at $r=r_b$, and the outer region ($r_b  r \\le a$).\n\n1.  **Temperature drop in the inner region ($0 \\le r  r_b$):**\n    In this region, $\\chi_{\\mathrm{eff}}(r) = \\chi_{\\mathrm{L}}$. The temperature drop, $\\Delta T_L$, is found by integrating the temperature gradient from $r=0$ to $r_b^{-}$ (the inner side of the barrier):\n    $$\n    \\Delta T_L = T(0) - T(r_b^{-}) = \\int_{0}^{r_b} \\left( - \\frac{dT}{dr} \\right) dr = \\int_{0}^{r_b} \\frac{q_r}{H \\chi_{\\mathrm{L}}} dr\n    $$\n    Since $q_r$, $H$, and $\\chi_{\\mathrm{L}}$ are constants within this region, we have:\n    $$\n    \\Delta T_L = \\frac{q_r r_b}{H \\chi_{\\mathrm{L}}}\n    $$\n\n2.  **Temperature drop at the interface barrier ($r=r_b$):**\n    The problem states that the barrier introduces a temperature jump, $\\Delta T_b$, proportional to the flux and the interface thermal resistance $R_b$:\n    $$\n    \\Delta T_b = T(r_b^{-}) - T(r_b^{+}) = q_r R_b\n    $$\n\n3.  **Temperature drop in the outer region ($r_b  r \\le a$):**\n    In this region, $\\chi_{\\mathrm{eff}}(r) = \\chi_{\\mathrm{R}}$. The temperature drop, $\\Delta T_R$, is found by integrating from $r=r_b^{+}$ (the outer side of the barrier) to $r=a$:\n    $$\n    \\Delta T_R = T(r_b^{+}) - T(a) = \\int_{r_b}^{a} \\left( - \\frac{dT}{dr} \\right) dr = \\int_{r_b}^{a} \\frac{q_r}{H \\chi_{\\mathrm{R}}} dr\n    $$\n    Again, treating the terms as constant within the region:\n    $$\n    \\Delta T_R = \\frac{q_r (a-r_b)}{H \\chi_{\\mathrm{R}}}\n    $$\n\nThe total temperature drop $T_0 - T_a$ is the sum of these individual drops:\n$$\nT_0 - T_a = \\Delta T_L + \\Delta T_b + \\Delta T_R = \\frac{q_r r_b}{H \\chi_{\\mathrm{L}}} + q_r R_b + \\frac{q_r (a-r_b)}{H \\chi_{\\mathrm{R}}}\n$$\nThis expression is analogous to Ohm's law, $V = I R_{\\text{total}}$, where $T_0 - T_a$ is the potential difference, $q_r$ is the current, and the term in parentheses is the total thermal resistance. Factoring out $q_r$:\n$$\nT_0 - T_a = q_r \\left( \\frac{r_b}{H \\chi_{\\mathrm{L}}} + R_b + \\frac{a-r_b}{H \\chi_{\\mathrm{R}}} \\right)\n$$\nSolving for the steady, uniform heat flux $q_r$ yields the final analytical expression:\n$$\nq_r = \\frac{T_0 - T_a}{\\frac{r_b}{H \\chi_{\\mathrm{L}}} + R_b + \\frac{a-r_b}{H \\chi_{\\mathrm{R}}}}\n$$\nThe diffusivities $\\chi_{\\mathrm{L}}$ and $\\chi_{\\mathrm{R}}$ are computed from the provided magnetic turbulence parameters:\nThe field-line diffusion coefficient, $D_{\\mathrm{fl}}$, is estimated as:\n$$\nD_{\\mathrm{fl}} \\approx \\left(\\frac{\\delta B}{B}\\right)^{2} L_{c}\n$$\nThe effective thermal diffusivity, $\\chi_{\\mathrm{eff}}$, is then given by:\n$$\n\\chi_{\\mathrm{eff}} \\approx v_{\\parallel} D_{\\mathrm{fl}} = v_{\\parallel} \\left(\\frac{\\delta B}{B}\\right)^{2} L_{c}\n$$\nSo, for the left and right regions, we compute:\n$$\n\\chi_{\\mathrm{L}} = v_{\\parallel} \\left[\\left(\\frac{\\delta B}{B}\\right)_{\\mathrm{L}}\\right]^{2} L_{c,\\mathrm{L}}\n$$\n$$\n\\chi_{\\mathrm{R}} = v_{\\parallel} \\left[\\left(\\frac{\\delta B}{B}\\right)_{\\mathrm{R}}\\right]^{2} L_{c,\\mathrm{R}}\n$$\nThese expressions are implemented in the following program to calculate the numerical value of $q_r$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are needed.\n\ndef solve():\n    \"\"\"\n    Computes the steady, uniform radial heat flux q_r for several parameter sets\n    related to stochastic magnetic field transport in a plasma.\n    \"\"\"\n    # Define the fixed global parameters.\n    a = 1.0  # Domain size in meters\n    rb = 0.5  # Barrier location in meters\n    H = 4.0e-3  # Volumetric heat capacity in J/(m^3 K)\n    T0 = 1.5e7  # Inner boundary temperature in K\n    Ta = 1.0e7  # Outer boundary temperature in K\n    v_parallel = 1.5e7  # Characteristic parallel speed in m/s\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: typical, moderate barrier\n        {'Lc_L': 10.0, 'Lc_R': 10.0, 'dB_B_L': 1.0e-3, 'dB_B_R': 1.0e-3, 'Rb': 0.3},\n        # Case 2: no barrier\n        {'Lc_L': 10.0, 'Lc_R': 10.0, 'dB_B_L': 1.0e-3, 'dB_B_R': 1.0e-3, 'Rb': 0.0},\n        # Case 3: strong barrier\n        {'Lc_L': 10.0, 'Lc_R': 10.0, 'dB_B_L': 1.0e-3, 'dB_B_R': 1.0e-3, 'Rb': 10.0},\n        # Case 4: asymmetric stochasticity and moderate barrier\n        {'Lc_L': 10.0, 'Lc_R': 5.0, 'dB_B_L': 5.0e-4, 'dB_B_R': 2.0e-3, 'Rb': 0.1},\n    ]\n\n    results = []\n    \n    # Calculate the total temperature difference, which is constant for all cases.\n    delta_T = T0 - Ta\n\n    for case in test_cases:\n        # Unpack parameters for the current case.\n        Lc_L = case['Lc_L']\n        Lc_R = case['Lc_R']\n        dB_B_L = case['dB_B_L']\n        dB_B_R = case['dB_B_R']\n        Rb = case['Rb']\n\n        # Step 1: Compute the field-line diffusion coefficients for each region.\n        # D_fl = (delta_B/B)^2 * L_c\n        D_fl_L = (dB_B_L**2) * Lc_L\n        D_fl_R = (dB_B_R**2) * Lc_R\n\n        # Step 2: Compute the effective cross-field thermal diffusivities.\n        # chi_eff = v_parallel * D_fl\n        chi_L = v_parallel * D_fl_L\n        chi_R = v_parallel * D_fl_R\n\n        # Step 3: Calculate the thermal resistances of the two diffusive regions.\n        # R_diffusive = (layer_thickness) / (H * chi)\n        # Using if condition to avoid division by zero, although not expected with given data.\n        R_L = rb / (H * chi_L) if chi_L  0 else float('inf')\n        R_R = (a - rb) / (H * chi_R) if chi_R  0 else float('inf')\n\n        # Step 4: Calculate the total thermal resistance.\n        # This is the sum of the left region, barrier, and right region resistances.\n        R_total = R_L + Rb + R_R\n\n        # Step 5: Compute the steady radial heat flux.\n        # q_r = Delta_T / R_total\n        q_r = delta_T / R_total\n\n        # Step 6: Round the result to the nearest integer and append to the list.\n        results.append(int(round(q_r)))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}