{
    "hands_on_practices": [
        {
            "introduction": "在托卡马克中，一种主要的逃逸电子缓解策略是通过快速注入大量杂质气体或破碎靶丸来提高等离子体密度。密度的增加会增强对逃逸电子的碰撞阻力，从而有效减缓其加速。本练习将指导您完成一个基本但至关重要的匡算，将缓解所需的电子密度目标与注入系统的工程参数（如所需杂质质量）联系起来，这是评估和设计缓解系统的第一步。",
            "id": "3709741",
            "problem": "在托卡马克破裂中，抑制逃逸电子依赖于快速增加自由电子密度以增强碰撞阻力。考虑一个破裂前的国际热核聚变实验堆（ITER）等离子体，其体积为 $V = 8.30 \\times 10^{2}\\ \\mathrm{m^3}$，电子密度为 $n_{e,0} = 1.0 \\times 10^{20}\\ \\mathrm{m^{-3}}$。为了缓解逃逸电子，在电流猝灭（CQ）期间的操作目标是 $n_{e,\\mathrm{target}} = 1.0 \\times 10^{21}\\ \\mathrm{m^{-3}}$。计划通过破碎弹丸注入（SPI）的方式注入氖杂质，其吸收份额为 $f_{a} = 0.30$（意味着只有一部分注入的原子在等离子体中烧蚀和电离），并且在 CQ 时间间隔内，每个电离的氖原子平均产生 $q_{e} = 8$ 个自由电子。假设氖的原子质量数为 $A = 20$，原子质量单位为 $m_{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$。CQ 的时间尺度为 $t_{\\mathrm{CQ}} = 4.0 \\times 10^{-2}\\ \\mathrm{s}$。单次 SPI 发射可以在 $t_{\\mathrm{dep}} = 8.0 \\times 10^{-3}\\ \\mathrm{s}$ 的沉积持续时间内输运质量为 $M_{\\mathrm{SPI}} = 2.0 \\times 10^{-1}\\ \\mathrm{kg}$ 的氖。\n\n从粒子数守恒和电子密度定义 $n_{e} = N_{e}/V$ 出发，在给定的吸收和电离假设下，推导将自由电子密度从 $n_{e,0}$ 提高到 $n_{e,\\mathrm{target}}$ 所需的杂质质量 $M_{\\mathrm{req}}$。然后，计算在 $t_{\\mathrm{CQ}}$ 内实现这一增长所需的最小质量注入率 $R_{\\mathrm{req}}$，并将其与 SPI 的能力 $R_{\\mathrm{SPI}} = M_{\\mathrm{SPI}}/t_{\\mathrm{dep}}$ 进行比较，以评估 SPI 是否能在 CQ 时间尺度内输运所需的质量。\n\n最终答案以所需杂质质量 $M_{\\mathrm{req}}$ 的形式表示，单位为 $\\mathrm{kg}$。将最终数值结果四舍五入至3位有效数字。",
            "solution": "用户请求解答一个关于托卡马克中缓解逃逸电子的等离子体物理问题。我将首先验证问题陈述，如果问题被认为是有效的，则提供一个完整的、有理有据的解法。\n\n### 第1步：提取已知条件\n- 等离子体体积：$V = 8.30 \\times 10^{2}\\ \\mathrm{m^3}$\n- 初始电子密度：$n_{e,0} = 1.0 \\times 10^{20}\\ \\mathrm{m^{-3}}$\n- 目标电子密度：$n_{e,\\mathrm{target}} = 1.0 \\times 10^{21}\\ \\mathrm{m^{-3}}$\n- 杂质：氖\n- 吸收份额：$f_{a} = 0.30$\n- 每个电离氖原子产生的平均自由电子数：$q_{e} = 8$\n- 氖原子质量数：$A = 20$\n- 原子质量单位：$m_{u} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$\n- 电流猝灭（CQ）时间尺度：$t_{\\mathrm{CQ}} = 4.0 \\times 10^{-2}\\ \\mathrm{s}$\n- 单次 SPI 发射质量：$M_{\\mathrm{SPI}} = 2.0 \\times 10^{-1}\\ \\mathrm{kg}$\n- SPI 的沉积持续时间：$t_{\\mathrm{dep}} = 8.0 \\times 10^{-3}\\ \\mathrm{s}$\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，因为它涉及聚变等离子体中一种标准的逃逸电子缓解技术（杂质注入）。所涉及的物理原理是粒子守恒以及密度和质量的基本定义。给定的等离子体参数值（体积、密度）与像 ITER 这样的大型托卡马克是一致的。该问题是定量陈述的、适定的、客观的和自洽的，提供了所有必要的信息。没有矛盾、科学缺陷或模糊之处。\n\n### 第3步：结论和行动\n问题是有效的。将提供一个完整的解法。\n\n### 解法推导\n\n该问题要求推导和计算增加等离子体电子密度所需的杂质质量，然后评估注入系统的能力。\n\n1.  **计算所需的额外电子数量**\n    电子密度 $n_e$ 定义为单位体积 $V$ 内的自由电子总数 $N_e$，即 $n_e = N_e / V$。\n    等离子体中初始的自由电子数为 $N_{e,0} = n_{e,0} V$。\n    目标自由电子数为 $N_{e,\\mathrm{target}} = n_{e,\\mathrm{target}} V$。\n    所需增加的自由电子数 $\\Delta N_e$ 是目标数量与初始数量之差：\n    $$ \\Delta N_e = N_{e,\\mathrm{target}} - N_{e,0} = (n_{e,\\mathrm{target}} - n_{e,0})V $$\n    代入给定值：\n    $$ \\Delta N_e = (1.0 \\times 10^{21}\\ \\mathrm{m^{-3}} - 1.0 \\times 10^{20}\\ \\mathrm{m^{-3}}) \\times (8.30 \\times 10^{2}\\ \\mathrm{m^3}) $$\n    $$ \\Delta N_e = (9.0 \\times 10^{20}\\ \\mathrm{m^{-3}}) \\times (8.30 \\times 10^{2}\\ \\mathrm{m^3}) = 7.47 \\times 10^{23} $$\n\n2.  **推导所需的杂质质量 $M_{\\mathrm{req}}$**\n    额外的电子 $\\Delta N_e$ 由注入的氖原子电离提供。\n    设 $N_{\\mathrm{Ne, injected}}$ 是注入到等离子体中的氖原子总数。\n    吸收份额 $f_a$ 是这些原子中成功被吸收（烧蚀和电离）的比例。被吸收的氖原子数量为 $N_{\\mathrm{Ne, assim}} = f_a N_{\\mathrm{Ne, injected}}$。\n    每个被吸收的氖原子平均贡献 $q_e$ 个自由电子。因此，增加的总电子数为：\n    $$ \\Delta N_e = q_e N_{\\mathrm{Ne, assim}} = q_e f_a N_{\\mathrm{Ne, injected}} $$\n    我们现在可以解出所需的注入氖原子数量：\n    $$ N_{\\mathrm{Ne, injected}} = \\frac{\\Delta N_e}{q_e f_a} = \\frac{(n_{e,\\mathrm{target}} - n_{e,0})V}{q_e f_a} $$\n    单个氖原子的质量 $m_{\\mathrm{Ne}}$ 是其原子质量数 $A$ 乘以原子质量单位 $m_u$：\n    $$ m_{\\mathrm{Ne}} = A m_u $$\n    所需的氖总质量 $M_{\\mathrm{req}}$ 是注入的原子数乘以每个原子的质量：\n    $$ M_{\\mathrm{req}} = N_{\\mathrm{Ne, injected}} \\times m_{\\mathrm{Ne}} = \\frac{(n_{e,\\mathrm{target}} - n_{e,0})V A m_u}{q_e f_a} $$\n    将数值代入此表达式：\n    $$ M_{\\mathrm{req}} = \\frac{(9.0 \\times 10^{20}\\ \\mathrm{m^{-3}}) \\times (8.30 \\times 10^{2}\\ \\mathrm{m^3}) \\times 20 \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg})}{8 \\times 0.30} $$\n    $$ M_{\\mathrm{req}} = \\frac{(7.47 \\times 10^{23}) \\times 20 \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg})}{2.4} $$\n    $$ M_{\\mathrm{req}} = \\frac{2.48085... \\times 10^{-2}\\ \\mathrm{kg}}{2.4} \\approx 1.0336875 \\times 10^{-2}\\ \\mathrm{kg} $$\n    按要求四舍五入到3位有效数字，所需的杂质质量为：\n    $$ M_{\\mathrm{req}} \\approx 1.03 \\times 10^{-2}\\ \\mathrm{kg} $$\n\n3.  **评估注入能力**\n    接下来，我们计算在电流猝灭（CQ）时间尺度 $t_{\\mathrm{CQ}} = 4.0 \\times 10^{-2}\\ \\mathrm{s}$ 内输运此质量所需的最小质量注入率 $R_{\\mathrm{req}}$：\n    $$ R_{\\mathrm{req}} = \\frac{M_{\\mathrm{req}}}{t_{\\mathrm{CQ}}} = \\frac{1.0336875 \\times 10^{-2}\\ \\mathrm{kg}}{4.0 \\times 10^{-2}\\ \\mathrm{s}} \\approx 0.258\\ \\mathrm{kg/s} $$\n    现在，我们计算破碎弹丸注入（SPI）系统的能力。单次发射输运的质量为 $M_{\\mathrm{SPI}} = 2.0 \\times 10^{-1}\\ \\mathrm{kg}$，沉积持续时间为 $t_{\\mathrm{dep}} = 8.0 \\times 10^{-3}\\ \\mathrm{s}$。SPI系统的质量注入率为：\n    $$ R_{\\mathrm{SPI}} = \\frac{M_{\\mathrm{SPI}}}{t_{\\mathrm{dep}}} = \\frac{2.0 \\times 10^{-1}\\ \\mathrm{kg}}{8.0 \\times 10^{-3}\\ \\mathrm{s}} = 25\\ \\mathrm{kg/s} $$\n    为了评估SPI系统是否足够，我们将需求与能力进行比较：\n    -   **质量比较**：$M_{\\mathrm{req}} \\approx 1.03 \\times 10^{-2}\\ \\mathrm{kg}$ 对比 $M_{\\mathrm{SPI}} = 2.0 \\times 10^{-1}\\ \\mathrm{kg}$。由于 $M_{\\mathrm{SPI}} > M_{\\mathrm{req}}$，单次 SPI 发射包含足够的质量。\n    -   **速率比较**：$R_{\\mathrm{req}} \\approx 0.258\\ \\mathrm{kg/s}$ 对比 $R_{\\mathrm{SPI}} = 25\\ \\mathrm{kg/s}$。由于 $R_{\\mathrm{SPI}} \\gg R_{\\mathrm{req}}$，SPI 系统可以以远超所需最小速率的速率注入质量。\n    SPI 系统注入所需质量将花费的时间是 $t_{\\mathrm{inject}} = M_{\\mathrm{req}} / R_{\\mathrm{SPI}} \\approx (1.03 \\times 10^{-2}\\ \\mathrm{kg}) / (25\\ \\mathrm{kg/s}) \\approx 4.1 \\times 10^{-4}\\ \\mathrm{s}$。这个时间远短于允许的 CQ 时间尺度（$t_{\\mathrm{inject}} \\ll t_{\\mathrm{CQ}}$）。因此，SPI 系统完全有能力在指定的 CQ 时间尺度内输运所需的质量。\n\n最终答案是所需的杂质质量 $M_{\\mathrm{req}}$。",
            "answer": "$$\n\\boxed{1.03 \\times 10^{-2}}\n$$"
        },
        {
            "introduction": "除了通过增强碰撞阻尼来缓解逃逸电子外，另一种关键策略是增强它们的径向输运，使它们在造成损害之前就从等离子体中被快速排出。这通常通过施加外部扰动磁场来实现，这些磁场会使磁力线变得随机化。本练习将引导您使用一个简化的随机漫步模型，来估算由磁场扰动引起的径向扩散系数和约束时间，从而定量地理解磁场随机性如何影响逃逸电子的损失速率。",
            "id": "3709752",
            "problem": "在磁约束聚变等离子体中，逃逸电子（REs）会因用于缓解目的而产生的随机磁扰动而经历跨场输运。考虑一个等离子体，其具有小振幅磁扰动，特征为相对涨落 $\\delta B / B$ 和平行相关长度 $L_{c}$。逃逸电子主要沿磁场以速度 $v_{\\parallel} \\approx c$ 运动，其中 $c$ 为真空中的光速。将径向输运建模为由沿磁场、长度为 $L_{c}$ 的去相关磁力线段产生的随机游走，每一步产生的径向位移由扰动磁场与总磁场的局部比值决定。\n\n从以下基本依据出发：\n- 沿场导心运动，满足 $ds/dt = v_{\\parallel}$，其中 $s$ 是沿磁场的坐标。\n- 场径向分量的小波纹近似，即 $dr/ds \\sim B_{r}/B \\sim \\delta B/B$，因此在一个平行相关长度上累积的典型径向步长量级为 $\\Delta r \\sim (\\delta B/B)\\,L_{c}$。\n- 一维扩散系数的非关联步长随机游走关系，即 $D \\sim (\\Delta r)^{2}/(2\\,\\tau_{c})$，其中 $\\tau_{c}$ 是步长去相关时间。\n\n推导逃逸电子径向扩散系数 $D_{r}$ 关于 $v_{\\parallel}$、$L_{c}$ 和 $\\delta B/B$ 的表达式。然后，使用一维均方位移关系 $\\langle r^{2}\\rangle = 2 D_{r} t$，得到穿越一个量级为小半径 $a$ 的径向距离所需的特征扩散约束时间 $\\tau_{\\mathrm{conf}}$。\n\n数值计算请使用：\n- $\\delta B/B = 10^{-3}$,\n- $L_{c} = 5\\ \\mathrm{m}$,\n- $a = 0.5\\ \\mathrm{m}$,\n- $c = 2.998 \\times 10^{8}\\ \\mathrm{m/s}$,\n- 一个代表性的雪崩倍增增长率 $\\gamma_{\\mathrm{ava}} = 3.0 \\times 10^{3}\\ \\mathrm{s}^{-1}$。\n\n计算以下各项，并将结果四舍五入至四位有效数字：\n1. 扩散系数 $D_{r}$ (以 $\\mathrm{m^{2}/s}$ 为单位)。\n2. 约束时间 $\\tau_{\\mathrm{conf}}$ (以 $\\mathrm{s}$ 为单位)。\n3. 无量纲比较度量 $\\gamma_{\\mathrm{ava}}\\,\\tau_{\\mathrm{conf}}$。\n\n将最终答案以单行矩阵的形式给出，其中包含按上述顺序列出的这三个量。矩阵内不包含单位；在计算过程中请使用指定的单位。",
            "solution": "此问题经评估有效。其科学基础是随机磁场中粒子输运的既定理论，这是聚变等离子体物理学的一个关键课题。该问题提法恰当，目标明确，并提供了足够的数据来推导出唯一解。语言客观且无歧义。\n\n推导和计算过程如下。\n\n首先，我们推导逃逸电子径向扩散系数 $D_{r}$ 的表达式。该问题提供了一个基于随机游走的模型。三个基本依据是：\n$1.$ 去相关时间 $\\tau_{c}$ 是速度为 $v_{\\parallel}$ 的逃逸电子行进一个平行相关长度 $L_{c}$ 所需的时间。根据关系式 $ds/dt = v_{\\parallel}$，对于距离 $\\Delta s = L_{c}$，时间间隔为 $\\Delta t = \\tau_{c} = \\frac{L_{c}}{v_{\\parallel}}$。\n$2.$ 在此长度上的特征径向步长 $\\Delta r$ 由 $\\Delta r \\sim (\\delta B/B)\\,L_{c}$ 给出。我们通过将此比例关系视为等式来形式化该模型：$\\Delta r = \\left(\\frac{\\delta B}{B}\\right)L_{c}$。\n$3.$ 径向扩散系数由一维随机游走关系 $D \\sim (\\Delta r)^{2}/(2\\,\\tau_{c})$ 给出。同样，我们为模型将其视为等式：$D_{r} = \\frac{(\\Delta r)^{2}}{2\\tau_{c}}$。\n\n将 $\\Delta r$ 和 $\\tau_{c}$ 的表达式代入 $D_{r}$ 的公式中：\n$$\nD_{r} = \\frac{\\left[ \\left(\\frac{\\delta B}{B}\\right)L_{c} \\right]^{2}}{2\\left(\\frac{L_{c}}{v_{\\parallel}}\\right)} = \\frac{\\left(\\frac{\\delta B}{B}\\right)^{2}L_{c}^{2}}{\\frac{2L_{c}}{v_{\\parallel}}}\n$$\n简化表达式得到：\n$$\nD_{r} = \\frac{1}{2} L_{c} v_{\\parallel} \\left(\\frac{\\delta B}{B}\\right)^{2}\n$$\n问题指出，逃逸电子主要以速度 $v_{\\parallel} \\approx c$ 沿磁场运动，其中 $c$ 是光速。因此，我们代入 $v_{\\parallel} = c$：\n$$\nD_{r} = \\frac{1}{2} L_{c} c \\left(\\frac{\\delta B}{B}\\right)^{2}\n$$\n这就是所求的逃逸电子径向扩散系数的表达式。\n\n接下来，我们推导特征扩散约束时间 $\\tau_{\\mathrm{conf}}$。给定一维均方位移关系 $\\langle r^{2}\\rangle = 2 D_{r} t$。约束时间 $\\tau_{\\mathrm{conf}}$ 定义为均方根位移 $\\sqrt{\\langle r^{2}\\rangle}$ 达到小半径 $a$ 所需的时间 $t$。\n$$\n\\sqrt{\\langle r^{2}\\rangle} = a \\implies \\langle r^{2}\\rangle = a^{2}\n$$\n将此代入 $t = \\tau_{\\mathrm{conf}}$ 时的位移关系式中：\n$$\na^{2} = 2 D_{r} \\tau_{\\mathrm{conf}}\n$$\n求解 $\\tau_{\\mathrm{conf}}$：\n$$\n\\tau_{\\mathrm{conf}} = \\frac{a^{2}}{2D_{r}}\n$$\n代入我们先前推导的 $D_{r}$ 表达式：\n$$\n\\tau_{\\mathrm{conf}} = \\frac{a^{2}}{2 \\left[ \\frac{1}{2} L_{c} c \\left(\\frac{\\delta B}{B}\\right)^{2} \\right]} = \\frac{a^{2}}{L_{c} c \\left(\\frac{\\delta B}{B}\\right)^{2}}\n$$\n这就是所求的约束时间的表达式。\n\n最后，我们使用给定的数据计算 $D_{r}$、$\\tau_{\\mathrm{conf}}$ 和无量纲度量 $\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}}$ 的数值：\n- $\\delta B/B = 10^{-3}$\n- $L_{c} = 5\\ \\mathrm{m}$\n- $a = 0.5\\ \\mathrm{m}$\n- $c = 2.998 \\times 10^{8}\\ \\mathrm{m/s}$\n- $\\gamma_{\\mathrm{ava}} = 3.0 \\times 10^{3}\\ \\mathrm{s}^{-1}$\n\n$1.$ 扩散系数 $D_{r}$ 的计算：\n$$\nD_{r} = \\frac{1}{2} (5) (2.998 \\times 10^{8}) (10^{-3})^{2} = (2.5) (2.998 \\times 10^{8}) (10^{-6}) = 7.495 \\times 10^{2} = 749.5\\ \\mathrm{m^{2}/s}\n$$\n四舍五入到四位有效数字， $D_{r} = 749.5\\ \\mathrm{m^{2}/s}$。\n\n$2.$ 约束时间 $\\tau_{\\mathrm{conf}}$ 的计算：\n为保证精度，使用以 $D_r$ 表示的表达式：\n$$\n\\tau_{\\mathrm{conf}} = \\frac{a^{2}}{2D_{r}} = \\frac{(0.5)^{2}}{2(749.5)} = \\frac{0.25}{1499} \\approx 1.6677785 \\times 10^{-4}\\ \\mathrm{s}\n$$\n四舍五入到四位有效数字，$\\tau_{\\mathrm{conf}} = 1.668 \\times 10^{-4}\\ \\mathrm{s}$。\n\n$3.$ 无量纲比较度量 $\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}}$ 的计算：\n$$\n\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}} = (3.0 \\times 10^{3}) \\times (1.6677785 \\times 10^{-4}) \\approx 0.50033355\n$$\n四舍五入到四位有效数字，$\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}} = 0.5003$。该度量比较了逃逸损失的时间尺度（$\\tau_{\\mathrm{conf}}$）与雪崩倍增的时间尺度（$1/\\gamma_{\\mathrm{ava}}$）。值小于1表明缓解措施是有效的。\n\n最终的数值结果，四舍五入到四位有效数字，为：\n- $D_{r} = 749.5\\ \\mathrm{m^{2}/s}$\n- $\\tau_{\\mathrm{conf}} = 1.668 \\times 10^{-4}\\ \\mathrm{s}$\n- $\\gamma_{\\mathrm{ava}}\\tau_{\\mathrm{conf}} = 0.5003$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 749.5 & 1.668 \\times 10^{-4} & 0.5003 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "为了有效设计缓解策略，我们不仅需要了解损失机制，还必须精确量化逃逸电子的主要来源——雪崩倍增过程。雪崩增长率直接决定了逃逸电子束流的增长速度，是评估任何缓解方案有效性的核心。本练习是一个计算实践，要求您实现一个基于 Rosenbluth-Putvinski 理论的雪崩增长率随时间演化的模型，从而深入理解在聚变堆破裂过程中，逃逸电子的产生动力学是如何受变化的电场和密度影响的。",
            "id": "3709726",
            "problem": "考虑一个空间均匀的完全电离等离子体柱，其中背景电场 $E(t)$ 和电子数密度 $n_e(t)$ 随时间变化但在空间上是均匀的。假设新产生的逃逸电子一旦生成，就以速度 $c$ 沿电场方向进行超相对论性运动，并忽略投掷角动力学、辐射反作用、部分屏蔽和空间输运。从洛伦兹力和相对论性电子的经典库仑碰撞图像出发，在 Rosenbluth–Putvinski 雪崩机制的假设下，推导随时间变化的雪崩倍增率 $\\gamma_{\\mathrm{ava}}(t)$，用基本常数、库仑对数、经典电子半径以及通过平衡电场加速和碰撞阻力得到的临界电场来表示。使用推导出的 $\\gamma_{\\mathrm{ava}}(t)$ 计算初始种子逃逸电子布居的指数放大。\n\n使用的定义和假设：\n- 元电荷为 $e$，电子质量为 $m_e$，真空介电常数为 $\\varepsilon_0$，光速为 $c$。\n- 经典电子半径为 $r_e = \\dfrac{e^2}{4\\pi \\varepsilon_0 m_e c^2}$。\n- 库仑对数 $\\ln\\Lambda$ 是一个给定的常数。\n- 临界电场 $E_c(t)$ 的定义是使电场加速力 $e E(t)$ 等于以速度 $c$ 运动的电子所受的相对论性碰撞阻力。\n- 设初始逃逸电子份额为 $f_{\\mathrm{seed}}$，定义为 $f_{\\mathrm{seed}} = \\dfrac{n_{\\mathrm{RE}}(0)}{n_e(0)}$。\n- 在雪崩机制下，逃逸电子数演化为 $n_{\\mathrm{RE}}(t) = n_{\\mathrm{RE}}(0)\\exp\\left(\\int_0^t \\gamma_{\\mathrm{ava}}(t')\\,\\mathrm{d}t'\\right)$；如果 $E(t) \\le E_c(t)$，雪崩源不应放大，这与推导的表达式一致。\n- 定义末态时刻 $T$ 的最终逃逸电流份额为 $f_I(T) = \\dfrac{j_{\\mathrm{RE}}(T)}{e n_e(T) c}$，在超相对论性假设下，这简化为 $f_I(T) = \\dfrac{n_{\\mathrm{RE}}(T)}{n_e(T)}$。将 $f_I(T)$ 表示为一个无量纲小数。\n\n数值要求：\n- 所有输入和计算必须使用国际单位制 (SI)。电场 $E$ 的单位必须是 $\\mathrm{V/m}$，时间单位是 $\\mathrm{s}$，密度单位是 $\\mathrm{m^{-3}}$，最终输出 $f_I(T)$ 是无量纲的。\n- 使用提供的时间离散网格 $\\{t_k\\}_{k=0}^{N-1}$（可以是均匀或非均匀间距）和一致的求积方案进行数值时间积分，以评估 $\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t$。\n- 对每个测试用例，计算 $f_I(T)$ 为一个浮点数。\n\n测试套件：\n实现以下三个测试用例。每个测试用例提供 $t_k$、$E(t_k)$、$n_e(t_k)$、$\\ln\\Lambda$ 和 $f_{\\mathrm{seed}}$。在每个用例中，最终时间为 $T = t_{N-1}$。\n\n- 测试用例 1（通过密度尖峰和电场降低进行缓解）：\n  - 时间网格：$t_k$ 在 $[0, 10^{-2}]\\,\\mathrm{s}$ 上均匀分布，有 $N = 1001$ 个点。\n  - 电场 $E(t)$：当 $t  4\\times 10^{-3}\\,\\mathrm{s}$ 时，$E(t) = 1.0\\,\\mathrm{V/m}$；当 $t \\ge 4\\times 10^{-3}\\,\\mathrm{s}$ 时，$E(t) = 0.1\\,\\mathrm{V/m}$。\n  - 电子密度 $n_e(t)$：当 $t  4\\times 10^{-3}\\,\\mathrm{s}$ 时，$n_e(t) = 5\\times 10^{19}\\,\\mathrm{m^{-3}}$；当 $4\\times 10^{-3}\\,\\mathrm{s} \\le t  8\\times 10^{-3}\\,\\mathrm{s}$ 时，$n_e(t) = 1\\times 10^{21}\\,\\mathrm{m^{-3}}$；当 $t \\ge 8\\times 10^{-3}\\,\\mathrm{s}$ 时，$n_e(t) = 7\\times 10^{20}\\,\\mathrm{m^{-3}}$。\n  - 库仑对数：$\\ln\\Lambda = 15.0$。\n  - 初始种子份额：$f_{\\mathrm{seed}} = 1.0\\times 10^{-8}$。\n\n- 测试用例 2（亚临界电场，无雪崩增长）：\n  - 时间网格：$t_k$ 在 $[0, 5\\times 10^{-3}]\\,\\mathrm{s}$ 上均匀分布，有 $N = 1001$ 个点。\n  - 电场 $E(t)$：对所有 $t$，$E(t) = 2.0\\times 10^{-2}\\,\\mathrm{V/m}$。\n  - 电子密度 $n_e(t)$：对所有 $t$，$n_e(t) = 5\\times 10^{19}\\,\\mathrm{m^{-3}}$。\n  - 库仑对数：$\\ln\\Lambda = 15.0$。\n  - 初始种子份额：$f_{\\mathrm{seed}} = 1.0\\times 10^{-6}$。\n\n- 测试用例 3（无种子，超临界场）：\n  - 时间网格：$t_k$ 在 $[0, 10^{-2}]\\,\\mathrm{s}$ 上均匀分布，有 $N = 1001$ 个点。\n  - 电场 $E(t)$：对所有 $t$，$E(t) = 1.0\\,\\mathrm{V/m}$。\n  - 电子密度 $n_e(t)$：对所有 $t$，$n_e(t) = 1\\times 10^{20}\\,\\mathrm{m^{-3}}$。\n  - 库仑对数：$\\ln\\Lambda = 15.0$。\n  - 初始种子份额：$f_{\\mathrm{seed}} = 0.0$。\n\n计算细节和最终输出：\n- 对每个测试用例，计算随时间变化的雪崩增长率 $\\gamma_{\\mathrm{ava}}(t_k)$ 并数值评估 $\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t$。用此结果计算 $n_{\\mathrm{RE}}(T)$，然后计算 $f_I(T) = \\dfrac{n_{\\mathrm{RE}}(T)}{n_e(T)}$。因为 $f_{\\mathrm{seed}} = \\dfrac{n_{\\mathrm{RE}}(0)}{n_e(0)}$，所以在所述假设下，可得 $f_I(T) = f_{\\mathrm{seed}}\\exp\\left(\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t\\right)\\dfrac{n_e(0)}{n_e(T)}$。\n- 您的程序应生成单行输出，其中包含三个测试用例的最终份额，以逗号分隔并用方括号括起来，顺序与上述测试用例相同（例如，[result_1,result_2,result_3]）。每个 $\\text{result}_i$ 必须是一个浮点数。",
            "solution": "推导过程从基本电动力学和碰撞动力学开始。一个受到电场 $E$ 作用的电子会经历电场加速力 $F_E = e E$。在等离子体中，一个快电子由于与背景电子和离子的库仑相互作用，还会经历碰撞减速力。在相对论极限下，当速度 $v \\approx c$ 时，碰撞阻力可以表示为有效减速频率 $\\nu_s$ 的形式：$F_{\\mathrm{drag}} \\approx m_e c\\,\\nu_s$，其中频率 $\\nu_s$ 由库仑散射决定。\n\n在小角度库仑碰撞近似下，并使用 Fokker–Planck 描述，相对论性电子由于电子-电子碰撞的有效减速频率为\n$$\n\\nu_s \\approx \\frac{n_e e^4 \\ln\\Lambda}{4\\pi \\varepsilon_0^2 m_e^2 c^3}.\n$$\n该表达式通过将卢瑟福微分截面在最小碰撞参数 $b_{\\min}$ 和最大碰撞参数 $b_{\\max}$ 之间积分得到，从而引出库仑对数 $\\ln\\Lambda = \\ln(b_{\\max}/b_{\\min})$。在临界条件下，令电场加速力与碰撞阻力相等，即 $e E_c = m_e c\\,\\nu_s$，得到 Connor–Hastie 临界电场\n$$\nE_c(t) = \\frac{n_e(t) e^3 \\ln\\Lambda}{4\\pi \\varepsilon_0^2 m_e c^2}.\n$$\n这个 $E_c(t)$ 划分了不同的区域：当 $E(t)  E_c(t)$ 时，摩擦力超过电场加速力，雪崩无法持续；当 $E(t) > E_c(t)$ 时，电场加速力可以克服阻力，雪崩倍增过程得以进行。\n\nRosenbluth–Putvinski 雪崩机制考虑了通过现有逃逸电子与热电子之间的近距离碰撞来产生次级逃逸电子。在该机制中，雪崩源率与碰撞相遇通量成正比，后者是背景密度 $n_e$、特征相对速度 $c$ 和有效库仑（Møller）散射截面的乘积。将小角度库仑截面对散射角和碰撞参数进行积分，得到的有效截面与 $4\\pi r_e^2 \\ln\\Lambda$ 成比例，其中经典电子半径 $r_e$ 为\n$$\nr_e = \\frac{e^2}{4\\pi \\varepsilon_0 m_e c^2}.\n$$\n因此，雪崩增长率（每个现有逃逸电子的逃逸密度倍增率）为\n$$\n\\gamma_{\\mathrm{ava}}(t) = n_e(t)\\,c\\,\\left(4\\pi r_e^2 \\ln\\Lambda\\right)\\,\\left[\\frac{E(t)}{E_c(t)} - 1\\right]_+,\n$$\n其中 $[x]_+ = \\max(x,0)$ 是 Heaviside 门控的线性依赖关系，它强制在 $E(t) \\le E_c(t)$ 时增长为零。该表达式的物理量纲为 $\\mathrm{s^{-1}}$，因为 $n_e$ 的单位是 $\\mathrm{m^{-3}}$，$c$ 的单位是 $\\mathrm{m/s}$，$r_e^2$ 的单位是 $\\mathrm{m^2}$，使得 $n_e c r_e^2$ 的单位为 $\\mathrm{s^{-1}}$；$\\ln\\Lambda$ 和 $\\frac{E}{E_c}-1$ 是无量纲的。\n\n给定 $\\gamma_{\\mathrm{ava}}(t)$，逃逸电子数密度 $n_{\\mathrm{RE}}(t)$ 作为一个乘法过程演化：\n$$\nn_{\\mathrm{RE}}(t) = n_{\\mathrm{RE}}(0)\\,\\exp\\left(\\int_0^t \\gamma_{\\mathrm{ava}}(t')\\,\\mathrm{d}t'\\right),\n$$\n其中 $n_{\\mathrm{RE}}(0) = f_{\\mathrm{seed}}\\,n_e(0)$。在超相对论性假设下，逃逸电子电流密度为 $j_{\\mathrm{RE}}(t) \\approx e\\,n_{\\mathrm{RE}}(t)\\,c$。在时刻 $T$ 的最终逃逸电流份额（相对于所有电子都成为逃逸电子时的最大电流密度）为\n$$\nf_I(T) = \\frac{j_{\\mathrm{RE}}(T)}{e\\,n_e(T)\\,c} = \\frac{n_{\\mathrm{RE}}(T)}{n_e(T)} = f_{\\mathrm{seed}}\\,\\exp\\left(\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t\\right)\\,\\frac{n_e(0)}{n_e(T)}.\n$$\n程序的算法步骤：\n- 为每个测试用例构建离散时间网格 $\\{t_k\\}$ 以及数组 $E_k = E(t_k)$ 和 $n_{e,k} = n_e(t_k)$。\n- 使用 $E_c(t) = \\dfrac{n_e(t) e^3 \\ln\\Lambda}{4\\pi \\varepsilon_0^2 m_e c^2}$ 计算 $E_{c,k} = E_c(t_k)$。\n- 计算 $\\gamma_k = n_{e,k}\\,c\\,\\left(4\\pi r_e^2 \\ln\\Lambda\\right)\\,\\max\\left(\\dfrac{E_k}{E_{c,k}} - 1, 0\\right)$。\n- 使用一致的求积方法（如应用于 $(t_k,\\gamma_k)$ 的梯形法则）数值积分 $\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t$。\n- 计算 $f_I(T) = f_{\\mathrm{seed}}\\,\\exp\\left(\\int_0^T \\gamma_{\\mathrm{ava}}(t)\\,\\mathrm{d}t\\right)\\,\\dfrac{n_e(0)}{n_e(T)}$。\n- 按照要求的单行输出格式报告每个测试用例的 $f_I(T)$。\n\n测试套件的定性预期：\n- 在测试用例 1 中，初始阶段 $E(t) > E_c(t)$ 会产生一些雪崩倍增。随后的密度尖峰增加了 $E_c(t)$，而降低的 $E(t)$ 确保了 $E(t)  E_c(t)$，从而终止了雪崩增长；由于积分增长量不大以及 $n_e(T)$ 的增加，最终份额仍然很小。\n- 在测试用例 2 中，电场在所有时间内都是亚临界的，因此 $\\gamma_{\\mathrm{ava}}(t) = 0$，最终份额等于 $f_{\\mathrm{seed}}$。\n- 在测试用例 3 中，电场是超临界的，但由于种子为零（$f_{\\mathrm{seed}} = 0$），纯乘法雪崩模型从零开始不会产生增长，因此最终份额为零。\n\n所有计算均使用 $\\mathrm{SI}$ 单位制，最终份额是无量纲小数，单行输出按顺序列表形式给出三个浮点数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants in SI units\ne = 1.602176634e-19       # Coulomb\nm_e = 9.1093837015e-31    # kg\nepsilon0 = 8.854187817e-12  # F/m\nc = 299792458.0           # m/s\n\ndef classical_electron_radius():\n    # r_e = e^2 / (4*pi*epsilon0*m_e*c^2)\n    return e**2 / (4.0 * np.pi * epsilon0 * m_e * c**2)\n\ndef critical_field(n_e, lnLambda):\n    # E_c = n_e * e^3 * lnLambda / (4*pi*epsilon0^2 * m_e * c^2)\n    return n_e * e**3 * lnLambda / (4.0 * np.pi * (epsilon0**2) * m_e * c**2)\n\ndef avalanche_growth_rate(E, n_e, lnLambda):\n    # gamma_ava(t) = n_e * c * (4*pi*r_e^2 * lnLambda) * max(E/E_c - 1, 0)\n    # Handle E_c safely even if extremely small.\n    r_e = classical_electron_radius()\n    E_c = critical_field(n_e, lnLambda)\n    ratio = np.zeros_like(E)\n    # Avoid division by zero: where E_c == 0, ratio stays 0\n    mask = E_c > 0\n    ratio[mask] = E[mask] / E_c[mask] - 1.0\n    ratio = np.maximum(ratio, 0.0)\n    prefactor = n_e * c * (4.0 * np.pi * (r_e**2) * lnLambda)\n    return prefactor * ratio\n\ndef integrate_trapezoid(y, x):\n    # Robust trapezoidal integration for arrays\n    return np.trapz(y, x)\n\ndef final_runaway_fraction(times, E_t, ne_t, lnLambda, f_seed):\n    # Compute gamma_ava(t)\n    gamma_t = avalanche_growth_rate(E_t, ne_t, lnLambda)\n    # Integrate over time\n    integral_gamma = integrate_trapezoid(gamma_t, times)\n    # n_RE(0) = f_seed * n_e(0); f_I(T) = n_RE(T)/n_e(T)\n    # => f_I(T) = f_seed * exp(integral_gamma) * n_e(0)/n_e(T)\n    ne0 = float(ne_t[0])\n    neT = float(ne_t[-1])\n    # If final density is zero (unphysical here), guard against division by zero\n    if neT == 0.0:\n        return 0.0\n    f_final = f_seed * np.exp(integral_gamma) * (ne0 / neT)\n    return float(f_final)\n\ndef build_test_case_1():\n    # Test case 1: mitigation via density spike and E reduction\n    T = 10e-3\n    N = 1001\n    times = np.linspace(0.0, T, N)\n    # Electric field profile\n    E = np.where(times  4e-3, 1.0, 0.1)  # V/m\n    # Density profile\n    ne = np.zeros_like(times)\n    ne[times  4e-3] = 5e19\n    mask_mid = (times >= 4e-3)  (times  8e-3)\n    ne[mask_mid] = 1e21\n    ne[times >= 8e-3] = 7e20\n    lnLambda = 15.0\n    f_seed = 1e-8\n    return times, E, ne, lnLambda, f_seed\n\ndef build_test_case_2():\n    # Test case 2: subcritical field, no avalanche\n    T = 5e-3\n    N = 1001\n    times = np.linspace(0.0, T, N)\n    E = np.full_like(times, 2.0e-2)  # V/m\n    ne = np.full_like(times, 5e19)   # m^-3\n    lnLambda = 15.0\n    f_seed = 1e-6\n    return times, E, ne, lnLambda, f_seed\n\ndef build_test_case_3():\n    # Test case 3: no seed, supercritical field\n    T = 10e-3\n    N = 1001\n    times = np.linspace(0.0, T, N)\n    E = np.full_like(times, 1.0)     # V/m\n    ne = np.full_like(times, 1e20)   # m^-3\n    lnLambda = 15.0\n    f_seed = 0.0\n    return times, E, ne, lnLambda, f_seed\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        build_test_case_1(),\n        build_test_case_2(),\n        build_test_case_3(),\n    ]\n\n    results = []\n    for times, E, ne, lnLambda, f_seed in test_cases:\n        result = final_runaway_fraction(times, E, ne, lnLambda, f_seed)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}