{
    "hands_on_practices": [
        {
            "introduction": "The foundation of nonlinear tearing mode theory is the classical Rutherford equation, which describes the growth of a magnetic island in a resistive plasma. This first practice guides you through a first-principles derivation of this seminal equation, starting from the fundamental laws of resistive magnetohydrodynamics (MHD). By completing this exercise, you will develop a deep understanding of how the balance between the available free energy, quantified by the tearing stability index $\\Delta'$, and plasma resistivity $\\eta$ dictates the linear-in-time growth of the island width.",
            "id": "3721659",
            "problem": "Consider a two-dimensional, single-helicity tearing perturbation in resistive magnetohydrodynamics (MHD), in a slab model with equilibrium magnetic field given by $ \\mathbf{B}_0 = B_z \\hat{\\mathbf{z}} + B_y(x) \\hat{\\mathbf{y}} $, where $ B_y(x) \\simeq B'_s x $ in the vicinity of the resonant surface at $ x = 0 $, and $ B'_s = \\left. dB_y/dx \\right|_{x=0} $. Let the helical magnetic flux function be $ \\psi(x,y,t) = \\psi_0(x) + \\tilde{\\psi}(x,t) \\cos(ky) $, with $ \\psi_0(x) = \\int^x B_y(x') \\, dx' \\simeq \\tfrac{1}{2} B'_s x^2 $ near $ x=0 $. Assume uniform resistivity $ \\eta $, negligible inertia and viscosity, and no equilibrium flow, so that the parallel component of Ohm’s law reduces to $ E_{\\parallel} = \\eta J_{\\parallel} $, with $ E_z = - \\partial \\psi / \\partial t $ in an appropriate gauge and $ J_z = - \\nabla^2 \\psi / \\mu_0 $ by Ampère’s law.\n\nDefine the island half-width $ w(t) $ by the separatrix condition in the constant-flux (constant-$ \\psi $) approximation, which yields the standard geometric relation $ \\tilde{\\psi}(0,t) = \\psi_s(t) = \\tfrac{B'_s}{16} w^2(t) $ for $ kw \\ll 1 $. The tearing stability index $ \\Delta' $ is defined by the ideal outer-region matching as $ \\Delta' = \\left[ \\tilde{\\psi}'/\\tilde{\\psi} \\right]_{0^+}^{0^-} $ and is taken to be a given positive constant, $ \\Delta'  0 $, set by the equilibrium profiles and mode number.\n\nWorking in the late-time Rutherford regime (small growth rate, negligible inertia, constant-$ \\psi $ island interior), start from the stated fundamental laws and definitions and derive the nonlinear evolution of the island half-width $ w(t) $ by balancing the reconnecting electric field with the resistive drop across the inner region. You may introduce a dimensionless, order-unity constant $ C_R $ to parameterize the inner-layer current profile and geometric details that are not resolved by the slab scaling analysis.\n\nCarry out the following steps:\n\n1. Use $ E_z = - \\partial_t \\psi_s $ and $ E_z = \\eta J_z $ at the X-point, together with $ J_z \\sim - C_R \\Delta' \\psi_s / (\\mu_0 w) $ obtained by integrating Ampère’s law across the inner region and using the outer matching relation for the jump in $ \\partial_x \\tilde{\\psi} $.\n2. Use the geometric relation between $ \\psi_s $ and $ w $ to obtain a first-order ordinary differential equation for $ w(t) $.\n3. Integrate the evolution equation to find $ w(t) $ for $ t \\ge 0 $, given the initial condition $ w(0) = w_0  0 $.\n\nThen, quantify the sensitivity of the solution to the initial seed width by computing both $ \\partial w(t) / \\partial w_0 $ and the time $ T $ required for the island to grow from $ w_0 $ to a specified $ w_1  w_0 $ (express $ T $ as a closed-form analytic expression in terms of the given parameters). No numerical evaluation is required.\n\nExpress your final answer as a single closed-form analytic expression for $ w(t) $ in terms of $ w_0 $, $ \\eta $, $ \\mu_0 $, $ \\Delta' $, and $ C_R $. Do not include units in your final boxed answer.",
            "solution": "The problem asks for the derivation of the nonlinear evolution equation for the magnetic island half-width $w(t)$ in the Rutherford regime, its solution given an initial condition, and an analysis of the solution's sensitivity and characteristic growth time.\n\nThe derivation begins by equating the reconnecting electric field with the resistive potential drop at the magnetic X-point. In the given gauge, the electric field is related to the time derivative of the reconnected magnetic flux, $ \\psi_s(t) = \\tilde{\\psi}(0,t) $. At the X-point, this gives:\n$$\nE_z = - \\frac{\\partial \\psi_s}{\\partial t}\n$$\nAccording to the provided parallel Ohm's law, this electric field is sustained by a parallel current density $ J_z $ flowing in a layer of uniform resistivity $ \\eta $:\n$$\nE_z = \\eta J_z\n$$\nEquating these two expressions for $ E_z $ yields a relationship between the rate of flux reconnection and the current density:\n$$\n- \\frac{d\\psi_s}{dt} = \\eta J_z\n$$\nThe problem specifies the current density at the X-point based on an integration of Ampère's law across the resistive layer and matching to the outer ideal region. This relationship, which incorporates the tearing stability index $ \\Delta' $, is given as:\n$$\nJ_z = - \\frac{C_R \\Delta' \\psi_s}{\\mu_0 w}\n$$\nwhere $ C_R $ is a dimensionless constant of order unity, and $ \\mu_0 $ is the vacuum permeability. Substituting this expression for $ J_z $ into the previous equation gives:\n$$\n- \\frac{d\\psi_s}{dt} = \\eta \\left( - \\frac{C_R \\Delta' \\psi_s}{\\mu_0 w} \\right)\n$$\nThis simplifies to an evolution equation for the reconnected flux $ \\psi_s $:\n$$\n\\frac{d\\psi_s}{dt} = \\frac{\\eta C_R \\Delta'}{\\mu_0} \\frac{\\psi_s}{w}\n$$\nTo obtain an equation solely for the island half-width $w(t)$, we use the provided geometric relation between $ \\psi_s $ and $ w $ in the constant-$\\psi$ approximation for small islands ($kw \\ll 1$):\n$$\n\\psi_s(t) = \\frac{B'_s}{16} w^2(t)\n$$\nwhere $ B'_s $ is the magnetic shear at the resonant surface. We differentiate this relation with respect to time $t$:\n$$\n\\frac{d\\psi_s}{dt} = \\frac{B'_s}{16} \\frac{d}{dt} (w^2) = \\frac{B'_s}{16} \\left( 2w \\frac{dw}{dt} \\right) = \\frac{B'_s w}{8} \\frac{dw}{dt}\n$$\nNow we equate the two derived expressions for $ d\\psi_s/dt $:\n$$\n\\frac{B'_s w}{8} \\frac{dw}{dt} = \\frac{\\eta C_R \\Delta'}{\\mu_0} \\frac{\\psi_s}{w}\n$$\nWe substitute the expression for $ \\psi_s $ in terms of $ w $ into the right-hand side of the equation:\n$$\n\\frac{B'_s w}{8} \\frac{dw}{dt} = \\frac{\\eta C_R \\Delta'}{\\mu_0 w} \\left( \\frac{B'_s}{16} w^2 \\right) = \\frac{\\eta C_R \\Delta' B'_s}{16 \\mu_0} w\n$$\nAssuming a non-trivial island ($ w  0 $) and non-zero magnetic shear ($ B'_s \\neq 0 $), we can cancel the term $ B'_s w $ from both sides of the equation:\n$$\n\\frac{1}{8} \\frac{dw}{dt} = \\frac{\\eta C_R \\Delta'}{16 \\mu_0}\n$$\nThis yields the first-order ordinary differential equation for the island half-width $ w(t) $:\n$$\n\\frac{dw}{dt} = \\frac{8}{16} \\frac{\\eta C_R \\Delta'}{\\mu_0} = \\frac{\\eta C_R \\Delta'}{2 \\mu_0}\n$$\nThis is the Rutherford equation for the nonlinear growth of a tearing mode, showing that the island width grows linearly with time. The growth rate is constant and determined by the plasma resistivity and the tearing stability parameter.\n\nNext, we integrate this differential equation to find $ w(t) $. The equation is separable:\n$$\ndw = \\left( \\frac{\\eta C_R \\Delta'}{2 \\mu_0} \\right) dt\n$$\nWe integrate both sides from the initial state ($ t=0 $, $ w=w_0 $) to a general state ($ t $, $ w(t) $):\n$$\n\\int_{w_0}^{w(t)} dw' = \\int_0^t \\left( \\frac{\\eta C_R \\Delta'}{2 \\mu_0} \\right) dt'\n$$\nSince the integrand on the right is constant, the integration is straightforward:\n$$\nw(t) - w_0 = \\left( \\frac{\\eta C_R \\Delta'}{2 \\mu_0} \\right) t\n$$\nSolving for $ w(t) $, we obtain the analytical solution for the island width evolution:\n$$\nw(t) = w_0 + \\left( \\frac{\\eta C_R \\Delta'}{2 \\mu_0} \\right) t\n$$\n\nThe problem then asks to quantify the sensitivity of the solution to the initial seed width $ w_0 $. This is found by computing the partial derivative of $ w(t) $ with respect to $ w_0 $:\n$$\n\\frac{\\partial w(t)}{\\partial w_0} = \\frac{\\partial}{\\partial w_0} \\left[ w_0 + \\left( \\frac{\\eta C_R \\Delta'}{2 \\mu_0} \\right) t \\right] = 1\n$$\nThis result indicates that the solution $ w(t) $ at any time $ t $ changes by exactly the same amount as any change in the initial condition $ w_0 $. The growth is additive and independent of the current island size.\n\nFinally, we compute the time $ T $ required for the island to grow from an initial width $ w_0 $ to a specified final width $ w_1  w_0 $. We set $ w(T) = w_1 $ in our solution:\n$$\nw_1 = w_0 + \\left( \\frac{\\eta C_R \\Delta'}{2 \\mu_0} \\right) T\n$$\nSolving for $ T $:\n$$\nw_1 - w_0 = \\left( \\frac{\\eta C_R \\Delta'}{2 \\mu_0} \\right) T\n$$\n$$\nT = \\frac{2 \\mu_0 (w_1 - w_0)}{\\eta C_R \\Delta'}\n$$\nThis is the closed-form expression for the growth time.\n\nThe final answer requested is the single closed-form analytic expression for $ w(t) $.",
            "answer": "$$\n\\boxed{w_0 + \\frac{\\eta C_R \\Delta' t}{2 \\mu_0}}\n$$"
        },
        {
            "introduction": "In high-performance tokamaks, the classical model is often insufficient to describe magnetic island stability, as neoclassical effects become dominant. This practice introduces the physics of the Neoclassical Tearing Mode (NTM), a critical performance-limiting instability. You will calculate the critical island width $w_c$, which represents a threshold that a seed perturbation must exceed to trigger a large, self-sustained NTM. This exercise illuminates the delicate balance between the destabilizing bootstrap current deficit and stabilizing polarization current effects, which is at the heart of the *modified* Rutherford equation.",
            "id": "3721698",
            "problem": "A large aspect ratio, circular cross-section tokamak has major radius $R_0=3.0\\,\\mathrm{m}$ and minor radius $a=0.60\\,\\mathrm{m}$. The safety factor and total pressure profiles are\n$$\nq(r)=1+2\\left(\\frac{r}{a}\\right)^{2},\\qquad p(r)=p_0\\left[1-\\left(\\frac{r}{a}\\right)^{2}\\right]^{2},\n$$\nwith $0\\le r\\le a$ and $p_00$ a constant. Consider neoclassical tearing modes (NTMs) at rational surfaces $(m/n)=(2/1)$ and $(3/2)$. Let $r_{s}^{(m/n)}$ denote the radius of each rational surface defined by $q(r_{s}^{(m/n)})=m/n$. Define the magnetic shear length $L_q\\equiv q/(dq/dr)$ and the pressure gradient scale length $L_p\\equiv -p/(dp/dr)$, both evaluated locally at each rational surface. The ion poloidal Larmor radius is $\\rho_{pi}=2.5\\,\\mathrm{mm}$.\n\nIn the banana regime with weak collisionality and steady rotation, the evolution of the island half-width $w$ is governed by a modified Rutherford equation whose neoclassical contributions are dominated by a destabilizing helical bootstrap current deficit and a stabilizing neoclassical polarization current. Assume that, to leading order, the neoclassical bootstrap drive and polarization current contributions near marginality produce a small-island threshold such that the critical island width $w_c$ at each rational surface satisfies\n$$\nw_c^{2}=\\rho_{pi}^{2}\\,\\frac{C_{\\mathrm{pol}}^{(m/n)}}{C_{\\mathrm{bs}}^{(m/n)}\\,\\left(L_q/L_p\\right)_{r_s^{(m/n)}}},\n$$\nwhere $C_{\\mathrm{bs}}^{(m/n)}$ and $C_{\\mathrm{pol}}^{(m/n)}$ are dimensionless order-unity coefficients that encapsulate, respectively, the strength of the neoclassical bootstrap drive and the polarization current for the $(m/n)$ harmonic, including the appropriate collisionality and rotation dependences. For this discharge, measurements and kinetic closures yield\n$$\nC_{\\mathrm{bs}}^{(2/1)}=0.75,\\quad C_{\\mathrm{pol}}^{(2/1)}=0.30,\\qquad C_{\\mathrm{bs}}^{(3/2)}=0.65,\\quad C_{\\mathrm{pol}}^{(3/2)}=0.25.\n$$\n\nTasks:\n- Using the given $q(r)$ and $p(r)$, compute $r_{s}^{(2/1)}$ and $r_{s}^{(3/2)}$, and then evaluate $\\left(L_q/L_p\\right)$ at each rational surface.\n- Using the threshold relation above, compute the critical island widths $w_c^{(2/1)}$ and $w_c^{(3/2)}$. Express each critical width in millimeters and round to three significant figures.\n- Under the same seed island amplitude, a mode with smaller $w_c$ is more susceptible to triggering. Define the relative susceptibility ratio\n$$\nS\\equiv \\frac{w_c^{(3/2)}}{w_c^{(2/1)}}.\n$$\nReport $S$ in exact analytic form as your final answer (no numerical rounding).\n\nProvide clear reasoning starting from resistive magnetohydrodynamics with neoclassical corrections to establish the threshold relation and to determine all requested quantities. The final reported answer must be the single exact expression for $S$ with no units.",
            "solution": "The problem requires an analysis of neoclassical tearing mode (NTM) stability at two different rational surfaces in a tokamak. The central concept is the critical island width, $w_c$, which represents a threshold that a seed magnetic island must overcome to grow into a macroscopic NTM.\n\nThe evolution of the magnetic island half-width, $w$, is governed by the modified Rutherford equation. In a simplified form relevant to NTMs, this equation can be written as:\n$$\n\\frac{d w}{d t} \\propto \\Delta' + a_{bs} \\frac{L_q}{L_p} \\frac{1}{w} - a_{pol} \\frac{\\rho_{pi}^2}{w^3}\n$$\nHere, $\\Delta'$ is the classical tearing stability index, which is typically negative (stable) for NTMs. The second term represents the destabilizing drive from the helical deficit in the bootstrap current within the island, where $a_{bs}$ is a positive coefficient, and $L_q/L_p$ is the ratio of the magnetic shear length to the pressure gradient scale length, which quantifies the strength of the pressure-driven bootstrap current. This term scales as $w^{-1}$. The third term represents the stabilizing effect of the ion polarization current, which becomes significant for small islands. Here, $a_{pol}$ is a positive coefficient, and $\\rho_{pi}$ is the ion poloidal Larmor radius. This term scales as $w^{-3}$.\n\nFor a small seed island to grow, the total drive must be positive. The critical island width $w_c$ is determined by the condition $dw/dt=0$ at the point where the stabilizing polarization current term balances the destabilizing bootstrap current term (ignoring the typically smaller $\\Delta'$ term for the small island threshold). This balance yields:\n$$\na_{bs} \\frac{L_q}{L_p} \\frac{1}{w_c} \\approx a_{pol} \\frac{\\rho_{pi}^2}{w_c^3} \\implies w_c^2 \\approx \\frac{a_{pol}}{a_{bs}} \\rho_{pi}^2 \\left(\\frac{L_q}{L_p}\\right)^{-1}\n$$\nThe problem provides a precise form of this relation, encapsulating the coefficients $a_{bs}$ and $a_{pol}$ into dimensionless factors $C_{\\mathrm{bs}}$ and $C_{\\mathrm{pol}}$. We will now proceed with the quantitative analysis based on the given information.\n\nFirst, we determine the locations of the rational surfaces for the $(m/n)=(2/1)$ and $(3/2)$ modes. A rational surface $r_s$ exists where the safety factor $q(r)$ equals the mode ratio $m/n$.\nThe safety factor profile is $q(r)=1+2\\left(\\frac{r}{a}\\right)^2$.\n\nFor the $(m/n)=(2/1)$ mode:\n$$\nq(r_s^{(2/1)}) = 2 \\implies 1+2\\left(\\frac{r_s^{(2/1)}}{a}\\right)^2 = 2\n$$\n$$\n2\\left(\\frac{r_s^{(2/1)}}{a}\\right)^2 = 1 \\implies \\left(\\frac{r_s^{(2/1)}}{a}\\right)^2 = \\frac{1}{2} \\implies r_s^{(2/1)} = \\frac{a}{\\sqrt{2}}\n$$\n\nFor the $(m/n)=(3/2)$ mode:\n$$\nq(r_s^{(3/2)}) = \\frac{3}{2} \\implies 1+2\\left(\\frac{r_s^{(3/2)}}{a}\\right)^2 = \\frac{3}{2}\n$$\n$$\n2\\left(\\frac{r_s^{(3/2)}}{a}\\right)^2 = \\frac{1}{2} \\implies \\left(\\frac{r_s^{(3/2)}}{a}\\right)^2 = \\frac{1}{4} \\implies r_s^{(3/2)} = \\frac{a}{2}\n$$\n\nNext, we derive expressions for the magnetic shear length $L_q$ and the pressure gradient scale length $L_p$.\n$$\n\\frac{dq}{dr} = \\frac{d}{dr}\\left[1+2\\frac{r^2}{a^2}\\right] = \\frac{4r}{a^2}\n$$\n$$\nL_q(r) = \\frac{q(r)}{dq/dr} = \\frac{1+2(r/a)^2}{4r/a^2}\n$$\nFor the pressure profile $p(r)=p_0[1-(r/a)^2]^2$:\n$$\n\\frac{dp}{dr} = p_0 \\cdot 2\\left[1-\\left(\\frac{r}{a}\\right)^2\\right] \\cdot \\left(-\\frac{2r}{a^2}\\right) = -\\frac{4p_0 r}{a^2}\\left[1-\\left(\\frac{r}{a}\\right)^2\\right]\n$$\n$$\nL_p(r) = -\\frac{p(r)}{dp/dr} = -\\frac{p_0[1-(r/a)^2]^2}{-4p_0 r/a^2 [1-(r/a)^2]} = \\frac{a^2[1-(r/a)^2]}{4r}\n$$\n\nNow we compute the ratio $L_q/L_p$:\n$$\n\\frac{L_q}{L_p} = \\frac{\\left(\\frac{1+2(r/a)^2}{4r/a^2}\\right)}{\\left(\\frac{a^2[1-(r/a)^2]}{4r}\\right)} = \\frac{1+2(r/a)^2}{1-(r/a)^2} = \\frac{q(r)}{1-(r/a)^2}\n$$\nWe evaluate this ratio at each rational surface.\n\nAt $r_s^{(2/1)}$:\nWe have $q(r_s^{(2/1)}) = 2$ and $(r_s^{(2/1)}/a)^2 = 1/2$.\n$$\n\\left(\\frac{L_q}{L_p}\\right)_{r_s^{(2/1)}} = \\frac{2}{1 - 1/2} = \\frac{2}{1/2} = 4\n$$\n\nAt $r_s^{(3/2)}$:\nWe have $q(r_s^{(3/2)}) = 3/2$ and $(r_s^{(3/2)}/a)^2 = 1/4$.\n$$\n\\left(\\frac{L_q}{L_p}\\right)_{r_s^{(3/2)}} = \\frac{3/2}{1 - 1/4} = \\frac{3/2}{3/4} = 2\n$$\n\nNow we compute the critical island widths, $w_c$, using the given relation:\n$$\nw_c^2 = \\rho_{pi}^2 \\, \\frac{C_{\\mathrm{pol}}^{(m/n)}}{C_{\\mathrm{bs}}^{(m/n)} \\, (L_q/L_p)_{r_s^{(m/n)}}}\n$$\nGiven $\\rho_{pi} = 2.5\\,\\mathrm{mm}$.\n\nFor the $(2/1)$ mode:\n$$\n(w_c^{(2/1)})^2 = (2.5\\,\\mathrm{mm})^2 \\cdot \\frac{C_{\\mathrm{pol}}^{(2/1)}}{C_{\\mathrm{bs}}^{(2/1)} \\cdot (L_q/L_p)_{r_s^{(2/1)}}} = (6.25\\,\\mathrm{mm}^2) \\cdot \\frac{0.30}{0.75 \\cdot 4} = (6.25)\\frac{0.30}{3.0}\\,\\mathrm{mm}^2\n$$\n$$\n(w_c^{(2/1)})^2 = 6.25 \\cdot 0.1 = 0.625\\,\\mathrm{mm}^2\n$$\n$$\nw_c^{(2/1)} = \\sqrt{0.625}\\,\\mathrm{mm} \\approx 0.790569... \\,\\mathrm{mm}\n$$\nRounding to three significant figures, $w_c^{(2/1)} \\approx 0.791\\,\\mathrm{mm}$.\n\nFor the $(3/2)$ mode:\n$$\n(w_c^{(3/2)})^2 = (2.5\\,\\mathrm{mm})^2 \\cdot \\frac{C_{\\mathrm{pol}}^{(3/2)}}{C_{\\mathrm{bs}}^{(3/2)} \\cdot (L_q/L_p)_{r_s^{(3/2)}}} = (6.25\\,\\mathrm{mm}^2) \\cdot \\frac{0.25}{0.65 \\cdot 2} = (6.25)\\frac{0.25}{1.3}\\,\\mathrm{mm}^2\n$$\nUsing fractions for precision: $6.25 = 25/4$, $0.25 = 1/4$, $1.3 = 13/10$.\n$$\n(w_c^{(3/2)})^2 = \\frac{25}{4} \\cdot \\frac{1/4}{13/10}\\,\\mathrm{mm}^2 = \\frac{25}{4} \\cdot \\frac{1}{4} \\cdot \\frac{10}{13} = \\frac{250}{208} = \\frac{125}{104}\\,\\mathrm{mm}^2\n$$\n$$\nw_c^{(3/2)} = \\sqrt{\\frac{125}{104}}\\,\\mathrm{mm} \\approx 1.0963... \\,\\mathrm{mm}\n$$\nRounding to three significant figures, $w_c^{(3/2)} \\approx 1.10\\,\\mathrm{mm}$.\n\nFinally, we compute the relative susceptibility ratio $S \\equiv w_c^{(3/2)}/w_c^{(2/1)}$ in its exact analytic form.\n$$\nS^2 = \\frac{(w_c^{(3/2)})^2}{(w_c^{(2/1)})^2} = \\frac{\\rho_{pi}^2 \\, \\frac{C_{\\mathrm{pol}}^{(3/2)}}{C_{\\mathrm{bs}}^{(3/2)} \\, (L_q/L_p)_{r_s^{(3/2)}}}}{\\rho_{pi}^2 \\, \\frac{C_{\\mathrm{pol}}^{(2/1)}}{C_{\\mathrm{bs}}^{(2/1)} \\, (L_q/L_p)_{r_s^{(2/1)}}}}\n$$\nThe $\\rho_{pi}^2$ terms cancel.\n$$\nS^2 = \\frac{C_{\\mathrm{pol}}^{(3/2)} \\cdot C_{\\mathrm{bs}}^{(2/1)} \\cdot (L_q/L_p)_{r_s^{(2/1)}}}{C_{\\mathrm{bs}}^{(3/2)} \\cdot C_{\\mathrm{pol}}^{(2/1)} \\cdot (L_q/L_p)_{r_s^{(3/2)}}}\n$$\nSubstituting the derived and given values:\n$C_{\\mathrm{pol}}^{(3/2)} = 0.25 = 1/4$, $C_{\\mathrm{bs}}^{(2/1)} = 0.75 = 3/4$, $(L_q/L_p)_{r_s^{(2/1)}} = 4$.\n$C_{\\mathrm{bs}}^{(3/2)} = 0.65 = 13/20$, $C_{\\mathrm{pol}}^{(2/1)} = 0.30 = 3/10$, $(L_q/L_p)_{r_s^{(3/2)}} = 2$.\n$$\nS^2 = \\frac{(1/4) \\cdot (3/4) \\cdot 4}{(13/20) \\cdot (3/10) \\cdot 2} = \\frac{3/4}{39/100} = \\frac{3}{4} \\cdot \\frac{100}{39} = \\frac{300}{156}\n$$\nSimplifying the fraction:\n$$\nS^2 = \\frac{300 \\div 12}{156 \\div 12} = \\frac{25}{13}\n$$\nTherefore, the susceptibility ratio $S$ is:\n$$\nS = \\sqrt{\\frac{25}{13}} = \\frac{5}{\\sqrt{13}}\n$$",
            "answer": "$$\n\\boxed{\\frac{5}{\\sqrt{13}}}\n$$"
        },
        {
            "introduction": "To accurately predict and control magnetic islands in a realistic fusion environment, we must often turn to numerical modeling. This final practice bridges the gap between analytical theory and computational practice by tasking you with building a flexible time-dependent solver for the complete Modified Rutherford Equation (MRE). This exercise involves assembling the various physical terms—the classical drive, neoclassical bootstrap and polarization currents, and external current drive—into a single ordinary differential equation and solving it numerically. By validating your code against known analytical limits, you will gain invaluable skills in building and verifying computational tools used in modern fusion research.",
            "id": "3721702",
            "problem": "Consider the time evolution of a magnetic island in a toroidal plasma described by the Modified Rutherford Equation (MRE). The MRE is an ordinary differential equation in which the magnetic island half-width $w(t)$ evolves due to a combination of resistive tearing instability, neoclassical bootstrap current effects, polarization current effects, and externally driven current. The goal is to derive, implement, and validate a time-dependent solver for $w(t)$ starting from a physically grounded base and using user-specified functions for the additional physics beyond the classical tearing term.\n\nStarting base and definitions:\n- Resistive Magnetohydrodynamics (MHD) uses Ohm's law $E + v \\times B = \\eta J$, Faraday's law $\\partial_t B = -\\nabla \\times E$, and Ampère's law $\\mu_0 J = \\nabla \\times B$.\n- The classical tearing stability index $\\Delta'$ quantifies the jump of the logarithmic derivative of the perturbed magnetic flux across the resistive layer and has units of inverse length.\n- The Modified Rutherford Equation (MRE) augments the classical Rutherford equation by including neoclassical bootstrap current effects $G_{bs}$, polarization current effects $G_{pol}$, and external current drive effects $G_{CD}$, each expressed as functions of the island width $w$ and a relevant parameter: the effective collisionality $\\nu^*$ for $G_{bs}$, the island rotation frequency $\\omega$ for $G_{pol}$, and the radial misalignment $\\Delta r$ for $G_{CD}$.\n\nTasks:\n1. From the fundamental resistive MHD relations and dimensional consistency, derive a scalar ordinary differential equation for the island half-width $w(t)$ of the form $\\dot{w} = F(w, t)$ where the right-hand side combines a classical tearing contribution proportional to the tearing stability index and additional user-specified functions $G_{bs}(w,\\nu^*)$, $G_{pol}(w,\\omega)$, and $G_{CD}(w,\\Delta r)$, each multiplied by physically consistent coefficients. Your derivation must ensure $w(t) \\ge 0$ for all $t$ and must explicitly state each coefficient and its physical units to guarantee $F$ has units of $\\mathrm{m}/\\mathrm{s}$. Do not include any shortcut formulas; present the reasoning from the base laws to the final ordinary differential equation form.\n2. Implement a time-dependent solver for $\\dot{w} = F(w,t)$ using a stable numerical method for stiff or non-stiff ordinary differential equations, enforcing $w(t) \\ge 0$ at all times by regularizing divisions by $w$ if needed. Use $w$ in $\\mathrm{m}$ and time $t$ in $\\mathrm{s}$ throughout. The solver must integrate from a specified initial condition $w(0) = w_0$ over a specified time interval $[0, T]$.\n3. Validate the solver against known analytic limits by defining specific user-specified functions $G_{bs}$, $G_{pol}$, and $G_{CD}$ that reduce the MRE to forms with closed-form solutions. Use the following test suite, where each case specifies parameters, functions, and the expected analytic behavior. For numerical stability, whenever a division by $w$ appears, use a regularized width $w_{\\mathrm{eff}} = \\sqrt{w^2 + w_{\\min}^2}$ with $w_{\\min} = 1.0 \\times 10^{-6}\\,\\mathrm{m}$.\n\nCoefficient specification (use these numerical values in your implementation):\n- Classical tearing coefficient $C_{\\Delta} = 1.0 \\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$ multiplying the tearing stability index $\\Delta'$ (in $\\mathrm{m}^{-1}$).\n- Bootstrap coefficient $C_{bs} = 1.0 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$ multiplying $G_{bs}$.\n- Polarization coefficient $C_{pol} = 0.0$ (unused for the provided tests).\n- Current drive coefficient $C_{CD} = 1.0$ multiplying $G_{CD}$.\n\nTest suite:\n- Test case $1$ (constant classical drive, linear growth): Use $w_0 = 1.0 \\times 10^{-2}\\,\\mathrm{m}$, $T = 0.5\\,\\mathrm{s}$, $\\Delta'(t) = \\Delta'_0$ with $\\Delta'_0 = 50\\,\\mathrm{m}^{-1}$, $G_{bs}(w,\\nu^*) = 0$, $G_{pol}(w,\\omega) = 0$, and $G_{CD}(w,\\Delta r) = 0$. In this limit, the solution exhibits linear-in-time behavior for $w(t)$. Your program must compute the numerical solution $w_{\\mathrm{num}}(t)$ and compare it to the analytic reference $w_{\\mathrm{ref}}(t)$ implied by a constant right-hand side. Report the maximum absolute deviation over the interval $[0,T]$ in $\\mathrm{m}$ as a float.\n- Test case $2$ (pure current-drive stabilization, exponential behavior): Use $w_0 = 1.0 \\times 10^{-2}\\,\\mathrm{m}$, $T = 0.5\\,\\mathrm{s}$, $\\Delta'(t) = 0$, $G_{bs}(w,\\nu^*) = 0$, $G_{pol}(w,\\omega) = 0$, and $G_{CD}(w,\\Delta r) = -\\gamma w$ with $\\gamma = 2.0\\,\\mathrm{s}^{-1}$. In this limit, the solution exhibits exponential decay. Your program must compute $w_{\\mathrm{num}}(t)$ and compare it to the analytic reference $w_{\\mathrm{ref}}(t)$ implied by an ordinary differential equation proportional to $-w$. Report the maximum absolute deviation over $[0,T]$ in $\\mathrm{m}$ as a float.\n- Test case $3$ (bootstrap drive inversely proportional to width, square-root-in-time behavior): Use $w_0 = 1.0 \\times 10^{-2}\\,\\mathrm{m}$, $T = 5.0\\,\\mathrm{s}$, $\\Delta'(t) = 0$, $G_{bs}(w,\\nu^*) = A / w$ with $A = 1.0$ (dimensionless), $G_{pol}(w,\\omega) = 0$, and $G_{CD}(w,\\Delta r) = 0$. In this limit, the solution exhibits square-root-in-time behavior. Your program must compute $w_{\\mathrm{num}}(t)$ and compare it to the analytic reference $w_{\\mathrm{ref}}(t)$ implied by an ordinary differential equation proportional to $1/w$. Report the maximum absolute deviation over $[0,T]$ in $\\mathrm{m}$ as a float.\n\nNumerical implementation details:\n- Integrate using a robust ordinary differential equation solver over $N$ evenly spaced times in $[0,T]$ with $N \\ge 100$ for test cases $1$ and $2$, and $N \\ge 200$ for test case $3$.\n- Use the regularized width $w_{\\mathrm{eff}} = \\sqrt{w^2 + w_{\\min}^2}$ with $w_{\\min} = 1.0 \\times 10^{-6}\\,\\mathrm{m}$ wherever $1/w$ appears.\n- Ensure dimensional consistency so that $\\dot{w}$ has units of $\\mathrm{m}/\\mathrm{s}$. Express all quantities of length in $\\mathrm{m}$ and time in $\\mathrm{s}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the maximum absolute deviations for the three test cases as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3]$, where each $x_i$ is a float in $\\mathrm{m}$.",
            "solution": "The problem of determining the time evolution of a magnetic island half-width $w(t)$ is a critical aspect of stability analysis in toroidal fusion plasmas, such as tokamaks. The governing equation is the Modified Rutherford Equation (MRE), an ordinary differential equation (ODE) that extends the classical model of resistive tearing modes to include other important physical effects. This solution will first derive the form of the MRE based on physical principles and dimensional consistency, and then implement a numerical solver to validate it against known analytic limits.\n\n### Part 1: Derivation of the Modified Rutherford Equation\n\nThe objective is to derive a scalar ODE of the form $\\dot{w} = F(w, t)$ where the island half-width $w$ is in meters ($\\mathrm{m}$) and time $t$ is in seconds ($\\mathrm{s}$), ensuring the right-hand side $F(w, t)$ has units of meters per second ($\\mathrm{m}/\\mathrm{s}$).\n\n1.  **Classical Tearing Mode Contribution**: The fundamental instability driving magnetic island formation is the resistive tearing mode. This mode grows by tapping the free energy in the plasma current gradient at a rational magnetic surface. The growth is enabled by finite plasma resistivity, $\\eta$, which allows magnetic field lines to break and reconnect.\n    -   The key parameter quantifying the available free energy is the tearing stability index, $\\Delta'$. It represents the jump in the logarithmic derivative of the perturbed magnetic flux across the resistive layer and has units of inverse length, $\\mathrm{m}^{-1}$. A positive $\\Delta'$ indicates instability.\n    -   The physical process of reconnection is diffusive, governed by the resistive diffusivity, $D_R = \\eta / \\mu_0$, where $\\mu_0$ is the vacuum permeability. The units of $D_R$ are $\\mathrm{m}^2/\\mathrm{s}$.\n    -   The rate of change of the island width, $\\dot{w}$, must be a function of the drive ($\\Delta'$) and the dissipative mechanism ($D_R$). From dimensional analysis, the simplest combination of $D_R$ and $\\Delta'$ that yields a velocity ($\\mathrm{m}/\\mathrm{s}$) is their product:\n        $$[\\dot{w}] = [D_R] \\times [\\Delta'] = \\left(\\frac{\\mathrm{m}^2}{\\mathrm{s}}\\right) \\times \\left(\\frac{1}{\\mathrm{m}}\\right) = \\frac{\\mathrm{m}}{\\mathrm{s}}$$\n    -   Therefore, the classical Rutherford theory for the nonlinear growth of an island posits that $\\dot{w}$ is proportional to $\\Delta'$. We can write this term as:\n        $$\\dot{w}_{\\text{classical}} = k_1 \\frac{\\eta}{\\mu_0} \\Delta'$$\n        where $k_1$ is a dimensionless constant of order unity. The problem provides a consolidated coefficient, $C_{\\Delta} = 1.0 \\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, which encapsulates the physical constants ($k_1$, $\\eta$, $\\mu_0$). The classical contribution to the MRE is thus:\n        $$F_{\\text{classical}} = C_{\\Delta} \\Delta'(t)$$\n        The units are $[C_{\\Delta}][\\Delta'] = (\\mathrm{m}^2/\\mathrm{s})(\\mathrm{m}^{-1}) = \\mathrm{m}/\\mathrm{s}$, as required.\n\n2.  **Neoclassical Bootstrap Current Contribution**: In toroidal geometry, the pressure gradient drives a current parallel to the magnetic field, known as the bootstrap current. The formation of a magnetic island flattens the pressure profile within it, leading to a local deficit of bootstrap current. This current perturbation modifies island stability.\n    -   This effect is modeled by a function $G_{bs}(w, \\nu^*)$, multiplied by a coefficient $C_{bs}$. The full term is $C_{bs} G_{bs}$.\n    -   The problem specifies $[C_{bs}] = \\mathrm{m}^2/\\mathrm{s}$. To maintain dimensional consistency, $[G_{bs}]$ must be $\\mathrm{m}^{-1}$.\n    -   A common model for this effect, which is stabilizing for small islands, involves a term proportional to $1/w$. Test case $3$ uses the form $G_{bs}(w, \\nu^*) = A/w$, where $A$ is a dimensionless constant. This form has units of $\\mathrm{m}^{-1}$, consistent with our analysis. The full term is $F_{bs} = C_{bs} A/w$.\n\n3.  **Polarization Current Contribution**: Island rotation relative to the bulk plasma induces a time-varying electric field, which drives a polarization current. This effect is generally stabilizing for small islands.\n    -   Its contribution is given as $C_{pol} G_{pol}(w, \\omega)$. For the provided tests, $C_{pol} = 0.0$, so this term is not active.\n\n4.  **External Current Drive Contribution**: External sources, such as radio-frequency waves (e.g., Electron Cyclotron Current Drive, ECCD), can be used to drive current locally within the plasma. By carefully aligning this driven current with the island's location, one can directly counteract the current perturbation causing the island, leading to stabilization.\n    -   This effect is modeled by a term $C_{CD} G_{CD}(w, \\Delta r)$.\n    -   The problem specifies $C_{CD} = 1.0$, which is dimensionless. Therefore, for the term to have units of $\\mathrm{m}/\\mathrm{s}$, the function $G_{CD}$ must also have units of $\\mathrm{m}/\\mathrm{s}$.\n    -   Test case $2$ provides a stabilization scheme modeled by $G_{CD}(w, \\Delta r) = -\\gamma w$, where $\\gamma$ is a rate constant with units of $\\mathrm{s}^{-1}$. The units of this function are $[\\gamma][w] = (\\mathrm{s}^{-1})(\\mathrm{m}) = \\mathrm{m}/\\mathrm{s}$, consistent with our analysis.\n\n5.  **Assembled Modified Rutherford Equation**: Combining all the contributing terms, we arrive at the full MRE:\n    $$ \\frac{dw}{dt} = C_{\\Delta} \\Delta'(t) + C_{bs} G_{bs}(w, \\nu^*) + C_{pol} G_{pol}(w, \\omega) + C_{CD} G_{CD}(w, \\Delta r) $$\n    This is the ODE to be solved.\n\n6.  **Regularization and Non-negativity**: The island half-width $w$ must be non-negative, i.e., $w(t) \\ge 0$. Terms like $1/w$ in $G_{bs}$ diverge as $w \\to 0$. To prevent numerical singularities and model the fact that for very small islands the physics changes (e.g., the pressure profile is not fully flattened), we introduce a regularized width, $w_{\\mathrm{eff}}$. As specified, for any term involving division by $w$, we shall use:\n    $$ w_{\\mathrm{eff}} = \\sqrt{w^2 + w_{\\min}^2} $$\n    where $w_{\\min}$ is a small, physically motivated minimum width. For example, the bootstrap term becomes $F_{bs} = C_{bs} A / w_{\\mathrm{eff}}$. This regularization ensures the RHS of the ODE is well-behaved for all $w \\ge 0$.\n\n### Part 2  3: Numerical Implementation and Validation\n\nThe derived MRE is now implemented in a Python script. We use `scipy.integrate.solve_ivp`, a robust general-purpose ODE solver. The implementation follows the structure required by the problem, validating the solver against three test cases with known analytic solutions. For each case, we compute the maximum absolute deviation between the numerical solution and the exact analytic reference over the integration interval.\n\n-   **Test Case 1 (Linear Growth)**: The ODE is $\\dot{w} = C_{\\Delta} \\Delta'_0$, which is a constant. The solution is linear in time: $w(t) = w_0 + (C_{\\Delta} \\Delta'_0)t$.\n-   **Test Case 2 (Exponential Decay)**: The ODE is $\\dot{w} = -C_{CD} \\gamma w$. The solution is an exponential decay: $w(t) = w_0 e^{-C_{CD}\\gamma t}$.\n-   **Test Case 3 (Square-Root Growth)**: The ODE is $\\dot{w} = C_{bs} A / w$. This is a separable equation, leading to the solution $w(t) = \\sqrt{w_0^2 + 2 C_{bs} A t}$. The numerical solver integrates the regularized form $\\dot{w} = C_{bs} A / \\sqrt{w^2 + w_{\\min}^2}$, which is compared against the ideal analytic solution.\n\nThe code below defines the MRE's right-hand side, configures each test case, calls the solver, computes the analytic reference, and reports the maximum absolute deviation for each case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the Modified Rutherford Equation for three validation test cases\n    and reports the maximum absolute deviation from the analytic solution for each.\n    \"\"\"\n    # Define universal constants from the problem statement\n    C_DELTA = 1.0e-4  # m^2/s\n    C_BS = 1.0e-5     # m^2/s\n    C_POL = 0.0       # Coefficient is zero for these tests\n    C_CD = 1.0        # dimensionless\n    W_MIN = 1.0e-6    # m, for regularization\n\n    def mre_rhs(t, w_arr, delta_prime_func, g_bs_func, g_pol_func, g_cd_func):\n        \"\"\"\n        Calculates the right-hand side of the Modified Rutherford Equation.\n        dw/dt = F(t, w)\n        \"\"\"\n        w = w_arr[0]\n        # Physically, w must be non-negative.\n        w = max(0.0, w)\n        \n        # Regularized width for terms with 1/w dependence\n        w_eff = np.sqrt(w**2 + W_MIN**2)\n        \n        # Evaluate each term in the MRE\n        term_delta = C_DELTA * delta_prime_func(t, w)\n        term_bs = C_BS * g_bs_func(w, w_eff)\n        term_pol = C_POL * g_pol_func(t, w) # Included for completeness, but C_POL=0\n        term_cd = C_CD * g_cd_func(t, w)\n        \n        dw_dt = term_delta + term_bs + term_pol + term_cd\n        return [dw_dt]\n\n    # --- Test Case 1: Constant classical drive, linear growth ---\n    case1_params = {\n        'w0': 1.0e-2, 'T': 0.5, 'N': 101, 'name': 'Linear Growth',\n        'delta_prime_func': lambda t, w: 50.0,\n        'g_bs_func': lambda w, w_eff: 0.0,\n        'g_pol_func': lambda t, w: 0.0,\n        'g_cd_func': lambda t, w: 0.0,\n        'analytic_func': lambda t, w0: w0 + C_DELTA * 50.0 * t,\n    }\n\n    # --- Test Case 2: Pure current-drive stabilization, exponential behavior ---\n    gamma = 2.0  # s^-1\n    case2_params = {\n        'w0': 1.0e-2, 'T': 0.5, 'N': 101, 'name': 'Exponential Decay',\n        'delta_prime_func': lambda t, w: 0.0,\n        'g_bs_func': lambda w, w_eff: 0.0,\n        'g_pol_func': lambda t, w: 0.0,\n        'g_cd_func': lambda t, w: -gamma * w,\n        'analytic_func': lambda t, w0: w0 * np.exp(-gamma * C_CD * t),\n    }\n\n    # --- Test Case 3: Bootstrap drive, square-root-in-time behavior ---\n    A = 1.0  # dimensionless\n    case3_params = {\n        'w0': 1.0e-2, 'T': 5.0, 'N': 201, 'name': 'Sqrt Growth',\n        'delta_prime_func': lambda t, w: 0.0,\n        'g_bs_func': lambda w, w_eff: A / w_eff,  # Use regularized width in numerical part\n        'g_pol_func': lambda t, w: 0.0,\n        'g_cd_func': lambda t, w: 0.0,\n        # Analytic solution is for the unregularized equation\n        'analytic_func': lambda t, w0: np.sqrt(w0**2 + 2 * C_BS * A * t),\n    }\n\n    test_cases = [case1_params, case2_params, case3_params]\n    results = []\n\n    for params in test_cases:\n        t_eval = np.linspace(0, params['T'], params['N'])\n        \n        # Define the arguments for the RHS function for this specific case\n        rhs_args = (\n            params['delta_prime_func'],\n            params['g_bs_func'],\n            params['g_pol_func'],\n            params['g_cd_func']\n        )\n        \n        # Solve the ODE using a high-precision solver\n        sol = solve_ivp(\n            fun=mre_rhs,\n            t_span=(0, params['T']),\n            y0=[params['w0']],\n            method='RK45',\n            t_eval=t_eval,\n            args=rhs_args,\n            rtol=1e-9,\n            atol=1e-12,\n        )\n        \n        # Extract numerical solution and calculate analytic reference\n        w_numerical = sol.y[0]\n        w_analytical = params['analytic_func'](t_eval, params['w0'])\n        \n        # Calculate the maximum absolute deviation\n        max_abs_dev = np.max(np.abs(w_numerical - w_analytical))\n        results.append(max_abs_dev)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}