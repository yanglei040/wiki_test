{
    "hands_on_practices": [
        {
            "introduction": "Before one can control the heat flux, one must first understand the fundamental physics governing how heat flows along the open magnetic field lines in the scrape-off layer (SOL). In many scenarios, this process is dominated by classical heat conduction through the electron channel, a highly nonlinear process where thermal conductivity is a strong function of temperature. This exercise  provides essential practice in applying the steady-state, one-dimensional heat conduction model to determine the temperature profile between the hot upstream plasma and the cold divertor target, a foundational skill for analyzing SOL transport.",
            "id": "3705555",
            "problem": "An island divertor in a stellarator is used to control heat flux by increasing the magnetic field-line connection length along helical strike lines. Consider a single helical flux tube linking an upstream location in the scrape-off layer to a divertor target plate. Assume steady state, one-dimensional (1D) transport along the magnetic field, no volumetric sources or sinks along the leg, and classical, collisional, electron heat conduction dominates. Start from steady-state energy conservation along a magnetic field line and the constitutive relation for classical parallel electron heat conduction in a collisional plasma. The coordinate along the field line is $s$, the target is at $s=0$, and the upstream location is at $s=L_\\parallel$.\n\nA field-line tracing measurement gives a connection length of $L_\\parallel = 125\\,\\mathrm{m}$. Independent diagnostics measure the upstream electron temperature and the target electron temperature to be $T_u = 120\\,\\mathrm{eV}$ and $T_t = 8\\,\\mathrm{eV}$, respectively.\n\nUnder the stated assumptions for conduction-limited transport, compute the magnitude of the upstream parallel temperature gradient $\\left|\\partial_\\parallel T\\right|$ evaluated at $s=L_\\parallel$. Express your final answer in $\\mathrm{eV\\,m^{-1}}$ and round to three significant figures.",
            "solution": "The user has provided a problem to be validated and solved.\n\n### Step 1: Extract Givens\n-   **System**: A single helical flux tube in a stellarator's island divertor.\n-   **Model**: Steady-state, one-dimensional ($1$D) transport along the magnetic field.\n-   **Physics**: Dominated by classical, collisional, electron heat conduction.\n-   **Assumptions**: No volumetric sources or sinks of energy.\n-   **Coordinate System**: $s$ is the coordinate along the field line. The divertor target is at $s=0$. The upstream location is at $s=L_\\parallel$.\n-   **Given Data**:\n    -   Connection length: $L_\\parallel = 125\\,\\mathrm{m}$.\n    -   Upstream electron temperature: $T_u = T(s=L_\\parallel) = 120\\,\\mathrm{eV}$.\n    -   Target electron temperature: $T_t = T(s=0) = 8\\,\\mathrm{eV}$.\n-   **Objective**: Compute the magnitude of the upstream parallel temperature gradient, $\\left|\\partial_\\parallel T\\right|$, evaluated at $s=L_\\parallel$. The result should be in units of $\\mathrm{eV\\,m^{-1}}$ and rounded to three significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem describes a standard, simplified model of heat transport in the scrape-off layer of a magnetic confinement fusion device. This is a common textbook problem in plasma physics.\n\n-   **Scientifically Grounded**: The problem is based on the well-established principles of plasma heat transport and the Spitzer-Härm theory for classical parallel electron heat conduction. All assumptions are standard for a first-order analysis. The given values for temperatures and connection length are physically realistic for a stellarator divertor. The problem is scientifically sound.\n-   **Well-Posed**: The problem is formulated as a boundary value problem for a second-order ordinary differential equation. The two temperature boundary conditions, $T(0)=T_t$ and $T(L_\\parallel)=T_u$, are sufficient to determine a unique temperature profile $T(s)$ and its gradient. The problem requests a specific, computable quantity.\n-   **Objective**: The language is precise, quantitative, and free of any subjective or ambiguous terminology.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or infeasibility. It is a valid, well-posed physics problem.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be provided.\n\n### Solution Derivation\n\nThe problem requires solving the steady-state, one-dimensional energy transport equation under the assumption that heat flux is dominated by classical electron conduction.\n\n1.  **Energy Conservation**: In steady state and with no volumetric sources or sinks, the divergence of the heat flux vector $\\mathbf{q}$ is zero, $\\nabla \\cdot \\mathbf{q} = 0$. For one-dimensional transport along the magnetic field line coordinate $s$, this simplifies to:\n    $$ \\frac{d}{ds} q_\\parallel = 0 $$\n    This implies that the parallel heat flux, $q_\\parallel$, is constant along the magnetic field line between the upstream location and the target.\n\n2.  **Constitutive Relation**: The parallel heat flux is determined by classical, collisional electron heat conduction, as described by the Spitzer-Härm law. The electron heat flux $q_\\parallel$ is proportional to the temperature gradient $\\frac{dT}{ds}$ (which we can denote as $\\partial_\\parallel T$ in this $1$D context):\n    $$ q_\\parallel = -\\kappa_\\parallel \\frac{dT}{ds} $$\n    The classical parallel electron heat conductivity, $\\kappa_\\parallel$, is a strong function of the electron temperature $T$:\n    $$ \\kappa_\\parallel = \\kappa_0 T^{5/2} $$\n    Here, $\\kappa_0$ is the Spitzer conductivity coefficient, which is a constant dependent on fundamental physical constants and the Coulomb logarithm. Its value is not needed as it will cancel out. The temperature $T$ is the electron temperature.\n\n3.  **Governing Equation**: Combining these two principles, we obtain a differential equation for the temperature profile $T(s)$:\n    $$ q_\\parallel = -\\kappa_0 T(s)^{5/2} \\frac{dT}{ds} = \\text{constant} $$\n\n4.  **Integration of the Equation**: We can solve this ordinary differential equation by separation of variables. We integrate along the field line from the target plate ($s=0$, $T=T_t$) to the upstream location ($s=L_\\parallel$, $T=T_u$).\n    $$ \\int_{0}^{L_\\parallel} q_\\parallel ds = \\int_{T(0)}^{T(L_\\parallel)} -\\kappa_0 T^{5/2} dT $$\n    Since $q_\\parallel$ is constant, the left-hand side is simply $q_\\parallel L_\\parallel$. The right-hand side is integrated with respect to temperature:\n    $$ q_\\parallel L_\\parallel = -\\kappa_0 \\int_{T_t}^{T_u} T^{5/2} dT $$\n    $$ q_\\parallel L_\\parallel = -\\kappa_0 \\left[ \\frac{T^{7/2}}{7/2} \\right]_{T_t}^{T_u} $$\n    $$ q_\\parallel L_\\parallel = -\\frac{2\\kappa_0}{7} \\left( T_u^{7/2} - T_t^{7/2} \\right) $$\n    This equation allows us to determine the constant heat flux $q_\\parallel$ in terms of the boundary temperatures and the connection length.\n\n5.  **Calculate the Temperature Gradient**: The problem asks for the magnitude of the parallel temperature gradient at the upstream location, $s=L_\\parallel$. We can express the gradient $\\frac{dT}{ds}$ by rearranging the constitutive relation:\n    $$ \\frac{dT}{ds} = -\\frac{q_\\parallel}{\\kappa_\\parallel} = -\\frac{q_\\parallel}{\\kappa_0 T^{5/2}} $$\n    We evaluate this at $s=L_\\parallel$, where $T = T_u$:\n    $$ \\left. \\frac{dT}{ds} \\right|_{s=L_\\parallel} = -\\frac{q_\\parallel}{\\kappa_0 T_u^{5/2}} $$\n    Now, we substitute the expression for $q_\\parallel L_\\parallel$ from the previous step. It is more convenient to substitute for the product $-q_\\parallel$:\n    $$ -q_\\parallel = \\frac{2\\kappa_0}{7L_\\parallel} \\left( T_u^{7/2} - T_t^{7/2} \\right) $$\n    Substituting this into the expression for the gradient:\n    $$ \\left. \\frac{dT}{ds} \\right|_{s=L_\\parallel} = \\frac{1}{\\kappa_0 T_u^{5/2}} \\left( \\frac{2\\kappa_0}{7L_\\parallel} \\left( T_u^{7/2} - T_t^{7/2} \\right) \\right) $$\n    The constant $\\kappa_0$ cancels out, as expected.\n    $$ \\left. \\frac{dT}{ds} \\right|_{s=L_\\parallel} = \\frac{2}{7L_\\parallel} \\frac{T_u^{7/2} - T_t^{7/2}}{T_u^{5/2}} $$\n    This expression can be simplified by factoring out $T_u^{7/2}$ from the numerator:\n    $$ \\left. \\frac{dT}{ds} \\right|_{s=L_\\parallel} = \\frac{2}{7L_\\parallel} \\frac{T_u^{7/2} \\left( 1 - \\left(\\frac{T_t}{T_u}\\right)^{7/2} \\right)}{T_u^{5/2}} $$\n    $$ \\left. \\frac{dT}{ds} \\right|_{s=L_\\parallel} = \\frac{2T_u}{7L_\\parallel} \\left( 1 - \\left(\\frac{T_t}{T_u}\\right)^{7/2} \\right) $$\n    The problem asks for the magnitude $|\\partial_\\parallel T| = |\\frac{dT}{ds}|$. Since $T_u > T_t > 0$, the calculated gradient is positive, so its magnitude is the value itself.\n\n6.  **Numerical Calculation**: Substitute the given values into the final expression.\n    -   $L_\\parallel = 125\\,\\mathrm{m}$\n    -   $T_u = 120\\,\\mathrm{eV}$\n    -   $T_t = 8\\,\\mathrm{eV}$\n\n    $$ \\left| \\frac{dT}{ds} \\right|_{s=L_\\parallel} = \\frac{2 \\times 120}{7 \\times 125} \\left( 1 - \\left(\\frac{8}{120}\\right)^{7/2} \\right) $$\n    The units are automatically $\\mathrm{eV\\,m^{-1}}$ as required.\n    $$ \\left| \\frac{dT}{ds} \\right|_{s=L_\\parallel} = \\frac{240}{875} \\left( 1 - \\left(\\frac{1}{15}\\right)^{3.5} \\right) $$\n    First, evaluate the term in the parenthesis:\n    $$ \\left(\\frac{1}{15}\\right)^{3.5} \\approx (0.06666...)^{3.5} \\approx 0.00007655 $$\n    So, the term in parenthesis is:\n    $$ 1 - 0.00007655 \\approx 0.99992345 $$\n    Now, calculate the pre-factor:\n    $$ \\frac{240}{875} \\approx 0.2742857 $$\n    Finally, multiply the two parts:\n    $$ \\left| \\frac{dT}{ds} \\right|_{s=L_\\parallel} \\approx 0.2742857 \\times 0.99992345 \\approx 0.2742647\\,\\mathrm{eV\\,m^{-1}} $$\n    Rounding the result to three significant figures, we get $0.274\\,\\mathrm{eV\\,m^{-1}}$.",
            "answer": "$$\\boxed{0.274}$$"
        },
        {
            "introduction": "A crucial skill in fusion science is connecting theoretical models to experimental observables. The island divertor concept manipulates the magnetic topology to spread the heat load, but how do we confirm the size and properties of the magnetic island we've created? This practice  challenges you to work as a plasma diagnostician, starting from a measured heat flux pattern on the divertor—specifically, the separation between strike points—and working backwards. You will use principles of magnetic flux conservation and the Hamiltonian model of island formation to infer both the radial width of the magnetic island ($w$) and the amplitude of the resonant magnetic perturbation ($b_r$) required to generate it.",
            "id": "3705598",
            "problem": "A single-null tokamak uses externally applied Resonant Magnetic Perturbations (RMP) to control edge heat flux via an island divertor topology. A heat-flux imaging diagnostic on the outer divertor target measures a primary footprint splitting: the arclength separation between the two dominant maxima along the strike-line coordinate is $\\Delta s = 0.180~\\text{m}$. The local magnetic incidence angle of the field lines on the target is $\\beta = 5.0^\\circ$. The poloidal magnetic field magnitude at the outboard midplane is $B_{p}^{\\mathrm{mid}} = 0.12~\\text{T}$, and at the divertor target in the strike region it is $B_{p}^{\\mathrm{div}} = 0.020~\\text{T}$.\n\nNear the resonant surface, the edge field-line dynamics can be modeled in a straight-field-line slab with Cartesian coordinates $(x,y,z)$, where $x$ is the radial-like coordinate with the rational surface at $x=0$, $y$ is the binormal coordinate, and $z$ is the coordinate along the equilibrium field-line direction. The equilibrium parallel field varies linearly as $B_{z}(x) \\approx B_{z}'\\,x$, and an $m$-poloidal-mode helical perturbation produces a radial field component $b_{x}(x,y,z) = b_{r} \\sin(k_{y} y - k_{z} z)$ with $k_{y} = m/r_{s}$. Here $m=27$ and the resonant surface major radius is $r_{s} = 0.85~\\text{m}$. The effective linear parallel-field gradient is $B_{z}' = 3.2~\\text{T/m}$. Assume the resonance is satisfied so that the field-line equations reduce to the standard pendulum form near $x=0$.\n\nStarting from first principles applicable to magnetized plasmas and field-line mapping, do the following:\n\n1. Use magnetic flux conservation for a thin flux tube and the geometric projection at the divertor target to derive the relation between a small radial displacement at the outboard midplane, $\\delta r$, and the corresponding arclength displacement along the strike line at the divertor, $\\delta s$. Show that this implies a mapping $ds/dr$ in terms of the flux expansion and the incidence angle.\n\n2. Interpret the measured splitting $\\Delta s$ as the mapped island full-width and obtain the island width $w$ at the resonant surface.\n\n3. Starting from the slab field-line equations in the vicinity of the rational surface and the single-harmonic perturbation, derive the magnetic island width in terms of the perturbation amplitude $b_{r}$, the binormal wavenumber $k_{y}$, and the parallel-field gradient $B_{z}'$. Invert this relation to compute $b_{r}$ from your inferred $w$.\n\nCarry out the full derivation symbolically before substituting the given numerical values. Round your final numerical results to four significant figures. Express $b_{r}$ in $\\text{T}$ and $w$ in $\\text{m}$. Provide your final answer as the ordered pair $\\left(b_{r},\\,w\\right)$.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\nThe following data and definitions are provided in the problem statement:\n- Arclength separation between dominant heat flux maxima: $\\Delta s = 0.180~\\text{m}$\n- Local magnetic incidence angle on the divertor target: $\\beta = 5.0^\\circ$\n- Poloidal magnetic field magnitude at the outboard midplane: $B_{p}^{\\mathrm{mid}} = 0.12~\\text{T}$\n- Poloidal magnetic field magnitude at the divertor target: $B_{p}^{\\mathrm{div}} = 0.020~\\text{T}$\n- Slab coordinates: $(x,y,z)$ for radial-like, binormal, and parallel directions, respectively.\n- Equilibrium parallel field variation near resonance ($x=0$): $B_{z}(x) \\approx B_{z}'\\,x$\n- Radial magnetic field perturbation: $b_{x}(x,y,z) = b_{r} \\sin(k_{y} y - k_{z} z)$\n- Binormal wavenumber: $k_{y} = m/r_{s}$\n- Poloidal mode number: $m=27$\n- Major radius of the resonant surface: $r_{s} = 0.85~\\text{m}$\n- Effective linear parallel-field gradient: $B_{z}' = 3.2~\\text{T/m}$\n- The resonance condition is satisfied.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed based on the established criteria.\n- **Scientifically Grounded:** The problem is based on standard, well-established principles of plasma physics and magnetic confinement fusion. The concepts of resonant magnetic perturbations (RMPs), island divertors, magnetic flux conservation, flux expansion, magnetic shear, and the pendulum model for magnetic island formation are all central to the field of tokamak physics. The provided numerical values are physically plausible for a medium-sized tokamak.\n- **Well-Posed:** The problem is clearly structured into three distinct parts that guide the derivation and calculation. It provides a complete set of parameters necessary to arrive at a unique solution for the requested quantities, the magnetic island width $w$ and the perturbation amplitude $b_{r}$.\n- **Objective:** The problem is stated in precise, quantitative, and objective scientific language, free of any subjective or non-formalizable content.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, self-contained, and well-posed. No flaws are identified. Therefore, the problem is deemed **valid**, and a full solution will be provided.\n\n### Solution Derivation\n\nThe solution will be developed in three parts as requested by the problem statement.\n\n**Part 1: Derivation of the Midplane-to-Divertor Mapping**\n\nWe begin by considering the conservation of magnetic flux for a thin flux tube connecting the outboard midplane to the divertor target. In a tokamak, the poloidal magnetic flux $\\Psi_p$ is conserved along the flux tube. For a narrow tube bounded by two adjacent flux surfaces separated by a small radial distance $\\delta r$ at the midplane, the enclosed poloidal flux is approximately:\n$$ \\delta\\Psi_p \\approx B_{p}^{\\mathrm{mid}} \\delta A_{\\perp, \\mathrm{mid}} $$\nwhere $\\delta A_{\\perp, \\mathrm{mid}}$ is the cross-sectional area of the tube perpendicular to the poloidal magnetic field. Assuming a toroidal length $L_T$, this area is $\\delta A_{\\perp, \\mathrm{mid}} = L_T \\delta r$.\n\nAt the divertor, the same amount of poloidal flux $\\delta\\Psi_p$ is contained between the strike points of the same two flux surfaces. Here, the poloidal field is $B_{p}^{\\mathrm{div}}$ and the perpendicular separation of the surfaces is $\\delta r_{\\mathrm{div}}$. The corresponding area is $\\delta A_{\\perp, \\mathrm{div}} = L_T \\delta r_{\\mathrm{div}}$.\nConservation of poloidal flux, $\\delta\\Psi_p$, implies:\n$$ B_{p}^{\\mathrm{mid}} (L_T \\delta r) = B_{p}^{\\mathrm{div}} (L_T \\delta r_{\\mathrm{div}}) $$\n$$ B_{p}^{\\mathrm{mid}} \\delta r = B_{p}^{\\mathrm{div}} \\delta r_{\\mathrm{div}} $$\nThis gives the mapping of a radial separation from the midplane to a perpendicular separation at the divertor:\n$$ \\delta r_{\\mathrm{div}} = \\left(\\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}}}\\right) \\delta r $$\nThe term $f_{exp} = B_{p}^{\\mathrm{mid}}/B_{p}^{\\mathrm{div}}$ is known as the magnetic flux expansion factor.\n\nThe quantity $\\delta r_{\\mathrm{div}}$ is the separation between the field lines in the poloidal plane, perpendicular to the poloidal field direction at the divertor. The problem asks for the displacement $\\delta s$ along the surface of the divertor target. The magnetic field lines strike the target at a shallow incidence angle $\\beta$. The relationship between the perpendicular separation $\\delta r_{\\mathrm{div}}$ and the arclength separation $\\delta s$ along the target surface is given by simple trigonometry:\n$$ \\sin(\\beta) = \\frac{\\delta r_{\\mathrm{div}}}{\\delta s} $$\n$$ \\delta s = \\frac{\\delta r_{\\mathrm{div}}}{\\sin(\\beta)} $$\nSubstituting the expression for $\\delta r_{\\mathrm{div}}$:\n$$ \\delta s = \\frac{1}{\\sin(\\beta)} \\left(\\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}}}\\right) \\delta r $$\nThis gives the desired relation between a small radial displacement $\\delta r$ at the midplane and the corresponding arclength displacement $\\delta s$ at the divertor. The mapping differential is:\n$$ \\frac{ds}{dr} = \\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}} \\sin(\\beta)} $$\n\n**Part 2: Calculation of the Magnetic Island Width $w$**\n\nThe measured splitting $\\Delta s$ between the two dominant heat flux maxima at the divertor is interpreted as the mapping of the full radial width of the magnetic island, $w$, from the resonant surface near the midplane. Therefore, we set $\\delta r = w$ and $\\delta s = \\Delta s$ in the relation derived in Part 1:\n$$ \\Delta s = \\frac{w}{\\sin(\\beta)} \\frac{B_{p}^{\\mathrm{mid}}}{B_{p}^{\\mathrm{div}}} $$\nSolving for the island width $w$:\n$$ w = \\Delta s \\left(\\frac{B_{p}^{\\mathrm{div}}}{B_{p}^{\\mathrm{mid}}}\\right) \\sin(\\beta) $$\nSubstituting the given numerical values:\n$ \\Delta s = 0.180~\\text{m} $, $ B_{p}^{\\mathrm{div}} = 0.020~\\text{T} $, $ B_{p}^{\\mathrm{mid}} = 0.12~\\text{T} $, and $ \\beta = 5.0^\\circ $.\n$$ w = (0.180~\\text{m}) \\left(\\frac{0.020~\\text{T}}{0.12~\\text{T}}\\right) \\sin(5.0^\\circ) $$\n$$ w = (0.030~\\text{m}) \\sin(5.0^\\circ) \\approx 0.00261467~\\text{m} $$\nRounding to four significant figures, the island width is $w \\approx 0.002615~\\text{m}$.\n\n**Part 3: Derivation and Calculation of Perturbation Amplitude $b_r$**\n\nWe derive the magnetic island width in the specified slab model. The formation of magnetic islands is governed by a Hamiltonian system describing the field-line trajectories. In the vicinity of a rational surface, the field-line equations can be cast into a pendulum-like form. A constant of motion, or Hamiltonian, for the field lines can be written as:\n$$ H(x, \\alpha) = \\frac{1}{2} k_y B_z' x^2 + b_r \\cos(\\alpha) $$\nwhere $\\alpha = k_y y - k_z z$ is the helical phase angle, $x$ is the radial coordinate from the resonant surface, $B_z'$ is the magnetic shear parameter (given as the parallel-field gradient), $k_y$ is the binormal wavenumber, and $b_r$ is the amplitude of the radial magnetic field perturbation.\n\nThe magnetic surfaces are contours of constant $H$. The island separatrix is the special contour that passes through the X-points (unstable fixed points). The fixed points occur where the \"forces\" are zero, which corresponds to the stationary points of the Hamiltonian. These are found at $x=0$, where $\\partial H / \\partial x = 0$. The X-points correspond to the maximum of the potential energy term, i.e., at $\\cos(\\alpha)=1$, so $\\alpha=0, 2\\pi, ...$. The Hamiltonian value on the separatrix is thus:\n$$ H_{\\mathrm{sep}} = H(x=0, \\alpha=0) = \\frac{1}{2} k_y B_z' (0)^2 + b_r \\cos(0) = b_r $$\nThe full width of the island, $w$, is the maximum radial separation of the separatrix, which is $2$ times the maximum radial extent, $x_{\\mathrm{max}}$. This maximum extent occurs at the phase of the O-point (stable fixed point), where $\\cos(\\alpha)=-1$, so $\\alpha=\\pi, 3\\pi, ...$. Setting the Hamiltonian on this trajectory equal to $H_{\\mathrm{sep}}$:\n$$ H(x_{\\mathrm{max}}, \\alpha=\\pi) = \\frac{1}{2} k_y B_z' x_{\\mathrm{max}}^2 + b_r \\cos(\\pi) = H_{\\mathrm{sep}} $$\n$$ \\frac{1}{2} k_y B_z' x_{\\mathrm{max}}^2 - b_r = b_r $$\n$$ \\frac{1}{2} k_y B_z' x_{\\mathrm{max}}^2 = 2 b_r $$\n$$ x_{\\mathrm{max}}^2 = \\frac{4 b_r}{k_y B_z'} \\implies x_{\\mathrm{max}} = 2\\sqrt{\\frac{b_r}{k_y B_z'}} $$\nThe full island width $w$ is twice the half-width $x_{\\mathrm{max}}$:\n$$ w = 2 x_{\\mathrm{max}} = 4\\sqrt{\\frac{b_r}{k_y B_z'}} $$\nThis is the desired expression for the island width. To find the perturbation amplitude $b_r$, we invert this relation:\n$$ w^2 = 16 \\frac{b_r}{k_y B_z'} $$\n$$ b_r = \\frac{w^2 k_y B_z'}{16} $$\nNow we substitute the numerical values. First, we compute the binormal wavenumber $k_y$:\n$ m=27 $ and $ r_s = 0.85~\\text{m} $.\n$$ k_y = \\frac{m}{r_s} = \\frac{27}{0.85~\\text{m}} \\approx 31.7647~\\text{m}^{-1} $$\nUsing the unrounded value for $w \\approx 0.00261467~\\text{m}$ and the given $B_z' = 3.2~\\text{T/m}$:\n$$ b_r = \\frac{(0.00261467~\\text{m})^2 (31.7647~\\text{m}^{-1}) (3.2~\\text{T/m})}{16} $$\n$$ b_r \\approx \\frac{(6.8365 \\times 10^{-6}~\\text{m}^2) (31.7647~\\text{m}^{-1}) (3.2~\\text{T/m})}{16} \\approx \\frac{6.9508 \\times 10^{-4}~\\text{T}}{16} $$\n$$ b_r \\approx 4.34427 \\times 10^{-5}~\\text{T} $$\nRounding to four significant figures, the required perturbation amplitude is $b_r \\approx 4.344 \\times 10^{-5}~\\text{T}$.\n\n### Final Numerical Results\n- Perturbation amplitude: $b_r = 4.344 \\times 10^{-5}~\\text{T}$\n- Island width: $w = 0.002615~\\text{m}$\nThe final answer is presented as the ordered pair $(b_r, w)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.344 \\times 10^{-5} & 0.002615 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "To create a realistic model of an island divertor, we must account for the plasma's active response to the external fields applied by control coils. A time-varying magnetic field cannot penetrate a conductive plasma perfectly; it is \"screened\" by currents induced in the plasma itself, a phenomenon analogous to the electromagnetic skin effect in a normal conductor. This advanced computational exercise  integrates this critical physics, guiding you through a complete workflow from the externally applied coil spectrum to the final heat flux on the target, providing a comprehensive view of the entire control chain.",
            "id": "3705560",
            "problem": "Consider a sheared-slab edge model for an Island Divertor configuration in a nuclear fusion device. The aim is to quantify how externally applied coil spectra are plasma-screened, how the resultant magnetic islands form, and how these islands modify the divertor target heat-flux density. Use the following physically grounded approximations that start from Resistive Magnetohydrodynamics (MHD), Faraday's law, Ampère's law, and Ohm's law, and a local sheared slab approximation for field-line geometry.\n\nFundamental base:\n- Faraday's law: $\\nabla \\times \\mathbf{E} = - \\partial \\mathbf{B}/\\partial t$.\n- Ampère's law (magnetostatic form for the perturbation current density): $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$.\n- Resistive Ohm's law in the plasma: $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\eta \\mathbf{J}$, where $\\eta$ is the Spitzer resistivity.\n- In a uniform conductor subject to a harmonic magnetic perturbation of angular frequency $\\omega$ (representing the field's rotation relative to the plasma), electromagnetic diffusion yields a skin depth $\\delta = \\sqrt{2 \\eta / (\\mu_0 \\omega)}$, which controls exponential attenuation of the perturbation amplitude with depth.\n\nGeometry and island formation model:\n- Adopt a local sheared slab with guide field $\\mathbf{B}_0 = B_0 \\hat{z}$ and constant magnetic shear $s$ such that field lines have local pitch variation characterized by $s$.\n- An externally applied resonant radial field harmonic with poloidal wavenumber $k_y$ produces a perturbed flux function $\\tilde{\\psi}$ related to the radial field amplitude $b_r$ via $b_r \\approx k_y \\tilde{\\psi}$.\n- Near a rational surface, the field-line Hamiltonian reduces to a pendulum-like form, leading to the standard sheared-slab island full width $W_h$ for a harmonic $h$ is given by\n$$\nW_h = 4 \\sqrt{\\frac{|b_{r,\\mathrm{scr}}|}{k_y B_0 s}} .\n$$\n\nScreening and heat-flux model:\n- Let a harmonic at the plasma boundary have edge amplitude $b_{r,\\mathrm{edge}}$ and angular frequency $\\omega$. The distance from the boundary to the rational surface is $L$. Plasma screening (skin effect) yields the screened amplitude at the rational surface:\n$$\nb_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}} \\exp\\!\\left(-\\frac{L}{\\delta}\\right), \\quad \\delta = \\begin{cases}\n\\sqrt{\\dfrac{2 \\eta}{\\mu_0 \\omega}}, & \\omega > 0, \\\\\n\\infty, & \\omega = 0,\n\\end{cases}\n$$\nso that static perturbations ($\\omega = 0$) are unscreened in this approximation.\n- For a harmonic with poloidal mode number $m$ and rational surface radius $r_s$, take $k_y = m/r_s$.\n- For multiple harmonics, assume additive broadening of the divertor heat-flux width by a geometric mapping factor $\\gamma$ times the sum of island half-widths ($w_h = W_h/2$), giving an effective target width\n$$\n\\lambda_{\\mathrm{eff}} = \\lambda_q + \\gamma \\sum_h w_h ,\n$$\nwhere $\\lambda_q$ is the baseline heat-flux width without islands.\n- The divertor target heat-flux density is modeled as the axisymmetric input power $P_{\\mathrm{in}}$ spread over an effective area $2 \\pi R \\lambda_{\\mathrm{eff}}$, yielding\n$$\nq_t = \\frac{P_{\\mathrm{in}}}{2 \\pi R \\lambda_{\\mathrm{eff}}} .\n$$\n\nTask:\n- Implement a program that, for each test case described below, computes for each harmonic the plasma-screened $b_{r,\\mathrm{scr}}$, the island half-width $w_h$, and then the effective width $\\lambda_{\\mathrm{eff}}$ and the target heat flux $q_t$.\n- Use $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\n- The final numeric answers for $q_t$ must be expressed in $\\mathrm{W/m^2}$.\n- Angle units do not appear; do not introduce angles.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\mathrm{[result1,result2,result3]}$), in the order of the test cases below.\n\nTest suite:\n- Test case $\\#1$ (general, moderate screening):\n  - Coil harmonics: $\\{(m = 8,\\ b_{r,\\mathrm{edge}} = 3.0 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 800\\,\\mathrm{s^{-1}}),\\ (m = 10,\\ b_{r,\\mathrm{edge}} = 2.0 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 1200\\,\\mathrm{s^{-1}})\\}$.\n  - Plasma and geometry: $\\eta = 1.2 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.15\\,\\mathrm{m}$, $r_s = 1.05\\,\\mathrm{m}$, $B_0 = 2.5\\,\\mathrm{T}$, $s = 3.5\\,\\mathrm{m^{-1}}$, $\\gamma = 1.8$, $\\lambda_q = 6.5 \\times 10^{-3}\\,\\mathrm{m}$, $R = 3.2\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 6.5 \\times 10^{6}\\,\\mathrm{W}$.\n- Test case $\\#2$ (high-frequency, strong screening):\n  - Coil harmonics: $\\{(m = 9,\\ b_{r,\\mathrm{edge}} = 2.5 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 6000\\,\\mathrm{s^{-1}}),\\ (m = 12,\\ b_{r,\\mathrm{edge}} = 1.5 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 9000\\,\\mathrm{s^{-1}})\\}$.\n  - Plasma and geometry: $\\eta = 8.0 \\times 10^{-7}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.20\\,\\mathrm{m}$, $r_s = 1.00\\,\\mathrm{m}$, $B_0 = 3.0\\,\\mathrm{T}$, $s = 4.0\\,\\mathrm{m^{-1}}$, $\\gamma = 2.0$, $\\lambda_q = 5.0 \\times 10^{-3}\\,\\mathrm{m}$, $R = 3.0\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 5.5 \\times 10^{6}\\,\\mathrm{W}$.\n- Test case $\\#3$ (static perturbation, no screening):\n  - Coil harmonics: $\\{(m = 7,\\ b_{r,\\mathrm{edge}} = 4.0 \\times 10^{-4}\\,\\mathrm{T},\\ \\omega = 0\\,\\mathrm{s^{-1}})\\}$.\n  - Plasma and geometry: $\\eta = 1.0 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.12\\,\\mathrm{m}$, $r_s = 0.95\\,\\mathrm{m}$, $B_0 = 2.2\\,\\mathrm{T}$, $s = 3.0\\,\\mathrm{m^{-1}}$, $\\gamma = 1.5$, $\\lambda_q = 7.5 \\times 10^{-3}\\,\\mathrm{m}$, $R = 2.8\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 4.8 \\times 10^{6}\\,\\mathrm{W}$.\n- Test case $\\#4$ (short penetration distance, weak screening):\n  - Coil harmonics: $\\{(m = 10,\\ b_{r,\\mathrm{edge}} = 5.0 \\times 10^{-5}\\,\\mathrm{T},\\ \\omega = 400\\,\\mathrm{s^{-1}})\\}$.\n  - Plasma and geometry: $\\eta = 2.0 \\times 10^{-6}\\,\\Omega\\cdot\\mathrm{m}$, $L = 0.03\\,\\mathrm{m}$, $r_s = 1.10\\,\\mathrm{m}$, $B_0 = 2.7\\,\\mathrm{T}$, $s = 2.5\\,\\mathrm{m^{-1}}$, $\\gamma = 1.7$, $\\lambda_q = 4.5 \\times 10^{-3}\\,\\mathrm{m}$, $R = 3.1\\,\\mathrm{m}$, $P_{\\mathrm{in}} = 7.0 \\times 10^{6}\\,\\mathrm{W}$.\n\nYour program should implement the computations exactly as defined above and output a single line containing a Python-style list of the four $q_t$ values in $\\mathrm{W/m^2}$ for the test cases in the order given, with no additional text.",
            "solution": "The problem is valid as it is scientifically grounded in established plasma physics principles (resistive MHD, magnetic island theory), well-posed with all necessary data provided, and formulated objectively. The provided parameters are within physically plausible ranges for nuclear fusion devices.\n\nThe task is to calculate the peak heat flux density $q_t$ on a divertor target, considering the broadening effect of magnetic islands induced by external resonant magnetic perturbations (RMPs). The calculation proceeds by applying a series of physics-based models for plasma screening, island formation, and heat flux deposition. The procedure is executed for each test case, which may involve one or more RMP harmonics.\n\nThe core physical principle governing the penetration of time-varying magnetic fields into a conducting plasma is the skin effect. An externally applied magnetic perturbation with angular frequency $\\omega$ relative to the plasma is attenuated as it penetrates. The characteristic length scale for this attenuation is the electromagnetic skin depth $\\delta$. For a plasma with resistivity $\\eta$ and vacuum permeability $\\mu_0$, the skin depth is given by\n$$\n\\delta = \\sqrt{\\frac{2 \\eta}{\\mu_0 \\omega}}\n$$\nThis formula is applicable for non-static perturbations, where $\\omega > 0$. For a static perturbation, $\\omega = 0$, the skin depth is effectively infinite, $\\delta \\to \\infty$, meaning the field is not screened by this mechanism. A harmonic with amplitude $b_{r,\\mathrm{edge}}$ at the plasma edge, located a distance $L$ from the resonant rational surface, will have its amplitude screened to $b_{r,\\mathrm{scr}}$ at the rational surface according to:\n$$\nb_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}} \\exp\\left(-\\frac{L}{\\delta}\\right)\n$$\nFor the static case ($\\omega=0$), the exponential term becomes $\\exp(0) = 1$, and thus $b_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}}$.\n\nOnce the screened radial magnetic field amplitude $b_{r,\\mathrm{scr}}$ is known at the rational surface, the size of the resulting magnetic island can be calculated. In a sheared-slab geometry with a uniform guide field $B_0$ and constant magnetic shear $s$, the full island width $W_h$ for a single harmonic is given by:\n$$\nW_h = 4 \\sqrt{\\frac{|b_{r,\\mathrm{scr}}|}{k_y B_0 s}}\n$$\nHere, $k_y$ is the poloidal wavenumber of the perturbation. For a harmonic with poloidal mode number $m$ at a rational surface of radius $r_s$, the wavenumber is approximated as $k_y = m/r_s$.\n\nThe presence of these magnetic islands alters the transport of heat to the divertor target. The model assumes that the intrinsic heat-flux width, $\\lambda_q$, is broadened by the islands. The total effective heat-flux width, $\\lambda_{\\mathrm{eff}}$, is calculated by summing the contributions from the half-widths of all applied harmonics $h$:\n$$\n\\lambda_{\\mathrm{eff}} = \\lambda_q + \\gamma \\sum_h w_h\n$$\nwhere $w_h = W_h/2$ is the half-width of the island created by harmonic $h$, and $\\gamma$ is a geometric mapping factor that relates the island width in the plasma core to its footprint on the divertor target.\n\nFinally, the peak heat-flux density on the target, $q_t$, is determined by assuming the total input power $P_{\\mathrm{in}}$ is distributed over an effective area defined by the major radius $R$ and the effective width $\\lambda_{\\mathrm{eff}}$. This yields the expression:\n$$\nq_t = \\frac{P_{\\mathrm{in}}}{2 \\pi R \\lambda_{\\mathrm{eff}}}\n$$\n\nThe computational procedure for each test case is as follows:\n1.  Initialize a variable for the total island half-width contribution, $\\sum_h w_h = 0$.\n2.  For each harmonic $h$ specified in the test case:\n    a.  Retrieve the harmonic's parameters: mode number $m$, edge amplitude $b_{r,\\mathrm{edge}}$, and angular frequency $\\omega$.\n    b.  If $\\omega > 0$, calculate the skin depth $\\delta$ using the plasma resistivity $\\eta$ and $\\mu_0 = 4 \\pi \\times 10^{-7}\\,\\mathrm{H/m}$. Then, compute the screened amplitude $b_{r,\\mathrm{scr}}$ using the penetration depth $L$.\n    c.  If $\\omega = 0$, set $b_{r,\\mathrm{scr}} = b_{r,\\mathrm{edge}}$.\n    d.  Calculate the poloidal wavenumber $k_y = m/r_s$.\n    e.  Calculate the island full width $W_h$ using $b_{r,\\mathrm{scr}}$, $k_y$, the guide field $B_0$, and the magnetic shear $s$.\n    f.  Calculate the island half-width $w_h = W_h/2$.\n    g.  Add $w_h$ to the running sum $\\sum_h w_h$.\n3.  After iterating through all harmonics, calculate the effective heat-flux width $\\lambda_{\\mathrm{eff}}$ using the baseline width $\\lambda_q$ and the geometric factor $\\gamma$.\n4.  Compute the final target heat-flux density $q_t$ using the input power $P_{\\mathrm{in}}$ and major radius $R$.\n5.  This value of $q_t$ is the result for the test case. The process is repeated for all test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to solve the island divertor heat flux problem for all test cases.\n    \"\"\"\n    \n    # Define the constant mu_0\n    MU_0 = 4 * np.pi * 1e-7\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case #1 (general, moderate screening)\n        {\n            \"harmonics\": [\n                {\"m\": 8, \"b_r_edge\": 3.0e-4, \"omega\": 800},\n                {\"m\": 10, \"b_r_edge\": 2.0e-4, \"omega\": 1200},\n            ],\n            \"params\": {\n                \"eta\": 1.2e-6, \"L\": 0.15, \"r_s\": 1.05, \"B0\": 2.5, \"s\": 3.5,\n                \"gamma\": 1.8, \"lambda_q\": 6.5e-3, \"R\": 3.2, \"P_in\": 6.5e6,\n            }\n        },\n        # Test case #2 (high-frequency, strong screening)\n        {\n            \"harmonics\": [\n                {\"m\": 9, \"b_r_edge\": 2.5e-4, \"omega\": 6000},\n                {\"m\": 12, \"b_r_edge\": 1.5e-4, \"omega\": 9000},\n            ],\n            \"params\": {\n                \"eta\": 8.0e-7, \"L\": 0.20, \"r_s\": 1.00, \"B0\": 3.0, \"s\": 4.0,\n                \"gamma\": 2.0, \"lambda_q\": 5.0e-3, \"R\": 3.0, \"P_in\": 5.5e6,\n            }\n        },\n        # Test case #3 (static perturbation, no screening)\n        {\n            \"harmonics\": [\n                {\"m\": 7, \"b_r_edge\": 4.0e-4, \"omega\": 0},\n            ],\n            \"params\": {\n                \"eta\": 1.0e-6, \"L\": 0.12, \"r_s\": 0.95, \"B0\": 2.2, \"s\": 3.0,\n                \"gamma\": 1.5, \"lambda_q\": 7.5e-3, \"R\": 2.8, \"P_in\": 4.8e6,\n            }\n        },\n        # Test case #4 (short penetration distance, weak screening)\n        {\n            \"harmonics\": [\n                {\"m\": 10, \"b_r_edge\": 5.0e-5, \"omega\": 400},\n            ],\n            \"params\": {\n                \"eta\": 2.0e-6, \"L\": 0.03, \"r_s\": 1.10, \"B0\": 2.7, \"s\": 2.5,\n                \"gamma\": 1.7, \"lambda_q\": 4.5e-3, \"R\": 3.1, \"P_in\": 7.0e6,\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        harmonics = case[\"harmonics\"]\n        params = case[\"params\"]\n\n        # Unpack parameters for clarity\n        eta = params[\"eta\"]\n        L = params[\"L\"]\n        r_s = params[\"r_s\"]\n        B0 = params[\"B0\"]\n        s = params[\"s\"]\n        gamma = params[\"gamma\"]\n        lambda_q = params[\"lambda_q\"]\n        R = params[\"R\"]\n        P_in = params[\"P_in\"]\n        \n        total_island_half_width = 0.0\n\n        for h in harmonics:\n            m = h[\"m\"]\n            b_r_edge = h[\"b_r_edge\"]\n            omega = h[\"omega\"]\n\n            # Step 1: Calculate the plasma-screened radial field amplitude b_r_scr\n            if omega == 0:\n                # Static case: no screening by this mechanism\n                b_r_scr = b_r_edge\n            else:\n                # Skin depth delta\n                delta = np.sqrt(2 * eta / (MU_0 * omega))\n                # Screened field amplitude\n                b_r_scr = b_r_edge * np.exp(-L / delta)\n\n            # Step 2: Calculate the island full width W_h and half-width w_h\n            # Poloidal wavenumber k_y\n            k_y = m / r_s\n            \n            numerator = np.abs(b_r_scr)\n            denominator = np.abs(k_y) * B0 * s\n            \n            if denominator == 0:\n                 full_width_h = 0.0\n            else:\n                 # Calculate full island width W_h\n                 full_width_h = 4 * np.sqrt(numerator / denominator)\n            \n            # The sum requires the half-width w_h\n            half_width_h = full_width_h / 2\n            total_island_half_width += half_width_h\n\n        # Step 3: Calculate the effective target width lambda_eff\n        lambda_eff = lambda_q + gamma * total_island_half_width\n\n        # Step 4: Calculate the target heat flux q_t\n        q_t = P_in / (2 * np.pi * R * lambda_eff)\n        \n        results.append(q_t)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}