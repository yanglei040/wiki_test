{
    "hands_on_practices": [
        {
            "introduction": "The fundamental distinction between the sheath-limited and conduction-limited regimes lies in the plasma's collisionality. This first practice focuses on quantifying this property using the dimensionless collisionality parameter, $\\nu_*$, defined as the ratio of the magnetic connection length to the electron mean free path. By deriving and calculating $\\nu_*$ from fundamental plasma parameters, you will gain a concrete understanding of how density and temperature determine which transport mechanism dominates in the Scrape-Off Layer (SOL) .",
            "id": "3718591",
            "problem": "A tokamak edge plasma in the scrape-off layer (SOL) is characterized by parallel transport along magnetic field lines of length $L_{\\parallel}$. One commonly used measure of electron collisionality along the field is the dimensionless parameter $\\nu_{*}$, defined as the ratio of the connection length to the electron mean free path for electron–ion Coulomb collisions. Starting from kinetic theory and Coulomb collision physics, derive an expression for the electron collisionality\n$$\\nu_{*} \\equiv \\frac{L_{\\parallel}}{\\lambda_{ei}} = \\frac{L_{\\parallel}\\,\\nu_{ei}}{v_{\\mathrm{th},e}},$$\nwhere $v_{\\mathrm{th},e}$ is the electron thermal speed and $\\nu_{ei}$ is the electron–ion collision frequency. You may assume quasi-neutrality ($n_{e} \\simeq n_{i}$) and a singly ionized plasma with charge number $Z=1$.\n\nAs a fundamental base, use:\n- The electron thermal speed $v_{\\mathrm{th},e} = \\sqrt{2 k_B T_e / m_e}$,\n- The Spitzer electron–ion collision frequency scaling for small-angle Coulomb collisions, $\\nu_{ei} \\propto n_e Z^{2} \\ln\\Lambda\\, T_e^{-3/2}$, where $\\ln\\Lambda$ is the Coulomb logarithm,\n- Conservation of particle number and momentum parallel to the field, and that the mean free path is $\\lambda_{ei} = v_{\\mathrm{th},e}/\\nu_{ei}$.\n\nFor numerical evaluation, you may use the standard Spitzer coefficient (for $Z=1$ and $n_e$ in $\\mathrm{cm^{-3}}$, $T_e$ in $\\mathrm{eV}$)\n$$\\nu_{ei} \\approx 2.91\\times 10^{-6}\\,\\frac{n_e\\,\\ln\\Lambda}{T_e^{3/2}},$$\nin $\\mathrm{s^{-1}}$. Compute $\\nu_{*}$ for the parameters $n_e = 2\\times 10^{19}\\ \\mathrm{m^{-3}}$, $T_e = 60\\ \\mathrm{eV}$, $L_{\\parallel} = 15\\ \\mathrm{m}$, and $\\ln\\Lambda = 15$. Express your final $\\nu_{*}$ as a pure number and round your answer to three significant figures.\n\nFinally, based on the magnitude of $\\nu_{*}$, argue qualitatively which SOL regime is expected: sheath-limited or conduction-limited.",
            "solution": "### Derivation of the Collisionality Expression\nThe electron collisionality, $\\nu_{*}$, is defined as the ratio of the parallel connection length, $L_{\\parallel}$, to the electron-ion mean free path, $\\lambda_{ei}$.\n$$\n\\nu_{*} \\equiv \\frac{L_{\\parallel}}{\\lambda_{ei}}\n$$\nGiven that the mean free path is the typical distance an electron travels between collisions, it can be expressed as the ratio of the electron thermal speed, $v_{\\mathrm{th},e}$, to the electron-ion collision frequency, $\\nu_{ei}$:\n$$\n\\lambda_{ei} = \\frac{v_{\\mathrm{th},e}}{\\nu_{ei}}\n$$\nSubstituting this into the definition of $\\nu_{*}$ gives:\n$$\n\\nu_{*} = \\frac{L_{\\parallel}}{v_{\\mathrm{th},e} / \\nu_{ei}} = \\frac{L_{\\parallel} \\nu_{ei}}{v_{\\mathrm{th},e}}\n$$\nThe problem provides the scaling relations for $\\nu_{ei}$ and $v_{\\mathrm{th},e}$. The electron thermal speed is $v_{\\mathrm{th},e} = \\sqrt{2 k_B T_e / m_e}$, which scales as $v_{\\mathrm{th},e} \\propto T_e^{1/2}$. The electron-ion collision frequency scales as $\\nu_{ei} \\propto n_e Z^{2} \\ln\\Lambda\\, T_e^{-3/2}$. For a given plasma species ($m_e$ constant) and charge state ($Z=1$), we can write the proportionality of $\\nu_{*}$.\n$$\n\\nu_{*} \\propto \\frac{L_{\\parallel} \\left( n_e \\ln\\Lambda\\, T_e^{-3/2} \\right)}{T_e^{1/2}}\n$$\nCombining the terms involving the electron temperature, $T_e$, yields the final expression for the scaling of electron collisionality:\n$$\n\\nu_{*} \\propto L_{\\parallel} n_e \\ln\\Lambda\\, T_e^{-2}\n$$\nThis expression shows how collisionality depends on the key plasma parameters in the SOL.\n\n### Numerical Calculation of $\\nu_{*}$\nWe are asked to compute the value of $\\nu_{*}$ for the given parameters: $n_e = 2\\times 10^{19}\\ \\mathrm{m^{-3}}$, $T_e = 60\\ \\mathrm{eV}$, $L_{\\parallel} = 15\\ \\mathrm{m}$, and $\\ln\\Lambda = 15$.\n\nFirst, we calculate the electron-ion collision frequency, $\\nu_{ei}$. The provided formula requires the electron density $n_e$ in units of $\\mathrm{cm^{-3}}$. We convert the given value:\n$$\nn_e = 2 \\times 10^{19}\\ \\mathrm{m^{-3}} = 2 \\times 10^{19} \\times (10^{-2}\\ \\mathrm{m/cm})^3 = 2 \\times 10^{19} \\times 10^{-6}\\ \\mathrm{cm^{-3}} = 2 \\times 10^{13}\\ \\mathrm{cm^{-3}}\n$$\nNow, we substitute the values into the formula for $\\nu_{ei}$:\n$$\n\\nu_{ei} \\approx 2.91\\times 10^{-6}\\,\\frac{n_e[\\mathrm{cm^{-3}}]\\,\\ln\\Lambda}{(T_e[\\mathrm{eV}])^{3/2}} = 2.91\\times 10^{-6}\\,\\frac{(2 \\times 10^{13}) \\times 15}{(60)^{3/2}} \\ \\mathrm{s^{-1}}\n$$\n$$\n\\nu_{ei} \\approx \\frac{8.73 \\times 10^8}{60\\sqrt{60}} \\approx \\frac{8.73 \\times 10^8}{464.758} \\approx 1.8784 \\times 10^6\\ \\mathrm{s^{-1}}\n$$\nNext, we calculate the electron thermal speed, $v_{\\mathrm{th},e}$, using SI units. The quantity $T_e$ given in $\\mathrm{eV}$ represents an energy. We convert it to Joules: $E_e = 60\\ \\mathrm{eV} \\times (1.60218 \\times 10^{-19}\\ \\mathrm{J/eV}) = 9.61308 \\times 10^{-18}\\ \\mathrm{J}$. The electron mass is $m_e \\approx 9.10938 \\times 10^{-31}\\ \\mathrm{kg}$. The formula for thermal speed is interpreted as $v_{\\mathrm{th},e} = \\sqrt{2 E_e / m_e}$.\n$$\nv_{\\mathrm{th},e} = \\sqrt{\\frac{2 \\times (9.61308 \\times 10^{-18}\\ \\mathrm{J})}{9.10938 \\times 10^{-31}\\ \\mathrm{kg}}} \\approx \\sqrt{2.1106 \\times 10^{13}}\\ \\mathrm{m/s} \\approx 4.5941 \\times 10^6\\ \\mathrm{m/s}\n$$\nFinally, we compute $\\nu_{*}$:\n$$\n\\nu_{*} = \\frac{L_{\\parallel} \\nu_{ei}}{v_{\\mathrm{th},e}} = \\frac{(15\\ \\mathrm{m}) \\times (1.8784 \\times 10^6\\ \\mathrm{s^{-1}})}{4.5941 \\times 10^6\\ \\mathrm{m/s}}\n$$\n$$\n\\nu_{*} \\approx \\frac{15 \\times 1.8784}{4.5941} \\approx 6.1329\n$$\nRounding to three significant figures, we get $\\nu_{*} \\approx 6.13$.\n\n### Determination of the SOL Regime\nThe SOL transport regime is determined by the electron collisionality, $\\nu_{*}$. This dimensionless parameter compares the system size, $L_{\\parallel}$, to the characteristic length scale for collisions, $\\lambda_{ei}$.\nThere are two primary regimes:\n1.  **Sheath-limited regime**: This occurs when collisionality is low, i.e., $\\nu_{*} \\ll 1$. In this case, the electron mean free path is much longer than the connection length ($\\lambda_{ei} \\gg L_{\\parallel}$). Electrons travel along the field lines to the divertor plates with few or no collisions. The parallel heat flux is limited by the rate at which the plasma can flow into the electrostatic sheath that forms at the material surface, which is governed by the ion sound speed.\n2.  **Conduction-limited regime**: This occurs when collisionality is high, i.e., $\\nu_{*} \\gg 1$. The electron mean free path is much shorter than the connection length ($\\lambda_{ei} \\ll L_{\\parallel}$). Electrons undergo many collisions as they move toward the divertor. This frequent scattering makes the transport process diffusive, similar to heat conduction in a solid. The parallel heat flux is limited by the classical (Spitzer-Härm) thermal conductivity of the electrons.\n\nOur calculated value is $\\nu_{*} \\approx 6.13$. Since this value is significantly greater than $1$, the plasma is in the high-collisionality regime. Therefore, the SOL is expected to be **conduction-limited**.",
            "answer": "$$\n\\boxed{6.13}\n$$"
        },
        {
            "introduction": "When the SOL is highly collisional ($\\nu_* \\gg 1$), a significant temperature gradient must develop to conduct heat towards the divertor target. This exercise delves into the physics of this conduction-limited regime by applying the Spitzer–Härm law for electron heat conductivity. Your task is to integrate the heat flux equation to derive a critical scaling law that relates the upstream temperature $T_u$ to the connection length $L_{\\parallel}$, revealing how SOL temperatures respond to changes in magnetic geometry .",
            "id": "3718554",
            "problem": "A tokamak edge plasma scrape-off layer (SOL) is operated in a regime where parallel heat transport is conduction-limited. Consider a single magnetic field line segment connecting an upstream location at the outboard midplane to a divertor target, with parallel coordinate $s \\in [0, L_{\\parallel}]$, where $s = 0$ corresponds to the target and $s = L_{\\parallel}$ corresponds to the upstream location. Assume steady-state, $1$-dimensional energy balance along the field line with negligible volumetric sources and sinks, so that the parallel heat flux $q_{\\parallel}$ is spatially constant. Let electron heat conduction obey Spitzer–Härm transport with thermal conductivity $\\kappa_{e}(T) = \\kappa_{0} T^{5/2}$, where $\\kappa_{0}$ is a constant. In the conduction-limited SOL regime, the target electron temperature $T_{t}$ is small compared to the upstream electron temperature $T_{u}$, but nonzero.\n\nSuppose a strike point shift doubles the parallel connection length, $L_{\\parallel} \\rightarrow 2 L_{\\parallel}$, while $q_{\\parallel}$ remains fixed. Starting from the stated physical assumptions and transport laws, derive the scaling of $T_{u}$ with $L_{\\parallel}$ at fixed $q_{\\parallel}$ and predict the multiplicative change in $T_{u}$ caused by the doubling of $L_{\\parallel}$. Express your final answer as a single analytic factor equal to $T_{u}^{(\\text{new})} / T_{u}^{(\\text{old})}$, with no units.",
            "solution": "The problem addresses steady-state, one-dimensional heat transport along a magnetic field line. The fundamental principle is energy conservation. With negligible volumetric sources and sinks, the divergence of the heat flux is zero. In one dimension, this implies that the parallel heat flux is constant along the coordinate $s$. The problem statement correctly identifies this consequence, stating $q_{\\parallel}$ is spatially constant.\n\nThe relationship between heat flux and the temperature gradient is given by Fourier's law of heat conduction. In one dimension, the heat flux along the $s$-direction is given by:\n$$ q_{s}(s) = -\\kappa_e(T) \\frac{dT}{ds} $$\nHeat flows from the hot upstream region ($s=L_{\\parallel}$, $T=T_u$) to the cold target region ($s=0$, $T=T_t$). Therefore, heat flows in the negative $s$-direction, and the heat flux component $q_{s}(s)$ is negative. Let $q_{\\parallel}$ represent the magnitude of the heat flux, which is a positive constant. Thus, $q_{s}(s) = -q_{\\parallel}$. The governing equation becomes:\n$$ -q_{\\parallel} = -\\kappa_e(T) \\frac{dT}{ds} $$\nSubstituting the given Spitzer–Härm conductivity, $\\kappa_{e}(T) = \\kappa_{0} T^{5/2}$, we obtain:\n$$ q_{\\parallel} = \\kappa_{0} T^{5/2} \\frac{dT}{ds} $$\nThis is a first-order ordinary differential equation for the temperature profile $T(s)$. We can solve this equation by separation of variables:\n$$ \\kappa_{0} T^{5/2} dT = q_{\\parallel} ds $$\nTo find the relationship between the upstream and target temperatures, we integrate this equation along the entire length of the field line. The integration limits are from the target ($s=0$, $T=T_t$) to the upstream location ($s=L_{\\parallel}$, $T=T_u$):\n$$ \\int_{T_{t}}^{T_{u}} \\kappa_{0} T^{5/2} dT = \\int_{0}^{L_{\\parallel}} q_{\\parallel} ds $$\nSince $\\kappa_{0}$ and $q_{\\parallel}$ are constants, they can be moved outside the integrals:\n$$ \\kappa_{0} \\int_{T_{t}}^{T_{u}} T^{5/2} dT = q_{\\parallel} \\int_{0}^{L_{\\parallel}} ds $$\nPerforming the integrations yields:\n$$ \\kappa_{0} \\left[ \\frac{T^{7/2}}{7/2} \\right]_{T_{t}}^{T_{u}} = q_{\\parallel} [s]_{0}^{L_{\\parallel}} $$\n$$ \\frac{2}{7} \\kappa_{0} (T_{u}^{7/2} - T_{t}^{7/2}) = q_{\\parallel} L_{\\parallel} $$\nThis equation provides the general relationship between the temperatures, heat flux, and connection length for Spitzer–Härm conduction.\n\nThe problem specifies that the SOL is in a conduction-limited regime, which is characterized by the condition $T_t \\ll T_u$. Under this assumption, the term $T_t^{7/2}$ is negligible compared to $T_u^{7/2}$. The equation simplifies to:\n$$ \\frac{2}{7} \\kappa_{0} T_{u}^{7/2} \\approx q_{\\parallel} L_{\\parallel} $$\nThis is the characteristic relationship for the conduction-limited SOL. To derive the scaling of $T_u$ with $L_{\\parallel}$, we rearrange this expression to solve for $T_u$:\n$$ T_{u}^{7/2} \\approx \\frac{7 q_{\\parallel} L_{\\parallel}}{2 \\kappa_{0}} $$\n$$ T_{u} \\approx \\left( \\frac{7 q_{\\parallel} L_{\\parallel}}{2 \\kappa_{0}} \\right)^{2/7} $$\nThe problem states that $q_{\\parallel}$ is held fixed. The quantities $7$, $2$, and $\\kappa_{0}$ are constants. Therefore, the scaling relationship between the upstream temperature $T_u$ and the connection length $L_{\\parallel}$ is:\n$$ T_{u} \\propto L_{\\parallel}^{2/7} $$\nThis completes the first part of the objective.\n\nFor the second part, we must find the multiplicative change in $T_u$ when $L_{\\parallel}$ is doubled. Let the initial state be denoted by $(T_{u}^{(\\text{old})}, L_{\\parallel}^{(\\text{old})})$ and the new state by $(T_{u}^{(\\text{new})}, L_{\\parallel}^{(\\text{new})})$. We are given $L_{\\parallel}^{(\\text{new})} = 2 L_{\\parallel}^{(\\text{old})}$.\n\nUsing the derived scaling law, we can write the ratio of the new upstream temperature to the old upstream temperature:\n$$ \\frac{T_{u}^{(\\text{new})}}{T_{u}^{(\\text{old})}} = \\frac{ \\left( C \\cdot L_{\\parallel}^{(\\text{new})} \\right)^{2/7} }{ \\left( C \\cdot L_{\\parallel}^{(\\text{old})} \\right)^{2/7} } $$\nwhere $C = \\frac{7 q_{\\parallel}}{2 \\kappa_{0}}$ is the constant of proportionality. The constant $C$ cancels out:\n$$ \\frac{T_{u}^{(\\text{new})}}{T_{u}^{(\\text{old})}} = \\left( \\frac{L_{\\parallel}^{(\\text{new})}}{L_{\\parallel}^{(\\text{old})}} \\right)^{2/7} $$\nSubstituting $L_{\\parallel}^{(\\text{new})} = 2 L_{\\parallel}^{(\\text{old})}$ into the ratio:\n$$ \\frac{T_{u}^{(\\text{new})}}{T_{u}^{(\\text{old})}} = \\left( \\frac{2 L_{\\parallel}^{(\\text{old})}}{L_{\\parallel}^{(\\text{old})}} \\right)^{2/7} = 2^{2/7} $$\nThus, doubling the connection length while keeping the parallel heat flux constant results in the upstream temperature increasing by a factor of $2^{2/7}$.",
            "answer": "$$\n\\boxed{2^{2/7}}\n$$"
        },
        {
            "introduction": "Real-world plasma profiles exist on a continuum between the idealized sheath- and conduction-limited extremes. This capstone exercise challenges you to construct a unified one-dimensional model that incorporates both Spitzer–Härm conduction along the field line and the physics of sheath heat transmission at the target boundary. By solving this coupled system, you will determine the upstream and target temperatures and derive a dimensionless parameter that quantitatively describes the transition from one regime to the other, providing a powerful tool for interpreting experimental data .",
            "id": "3718553",
            "problem": "Consider a one-dimensional steady-state model of the Scrape-Off Layer (SOL) in a magnetically confined fusion plasma. Let the spatial coordinate along a magnetic field line be $s \\in [0,L_{\\parallel}]$, where $s=0$ is the upstream (near the separatrix/midplane) and $s=L_{\\parallel}$ is the divertor target. Assume:\n\n- The parallel electron heat flux $q(s)$ is constant along $s$ because volumetric sources and sinks are negligible in the SOL segment of interest, so energy conservation implies $\\mathrm{d}q/\\mathrm{d}s = 0$.\n- The electron parallel heat conduction obeys Spitzer-Härm scaling, with $q = -\\kappa(T)\\,\\mathrm{d}T/\\mathrm{d}s$ and $\\kappa(T) = \\kappa_0\\,T^{5/2}$, where $T$ is the electron temperature measured in electronvolt (eV), and $\\kappa_0$ is a constant prefactor with units $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$.\n- At the target sheath ($s=L_{\\parallel}$), the sheath heat transmission sets the boundary condition for the heat flux. The target parallel heat flux is given by $q = \\gamma\\,n_e\\,k_B T\\,c_s$, where $n_e$ is the electron density, $k_B$ is the Boltzmann constant, $T$ is the electron temperature, and $c_s$ is the sound speed. The sound speed is $c_s = \\sqrt{k_B T/m_i}$ with ion mass $m_i$. In this problem, $T$ must be handled consistently: conduction uses $T$ in eV, while $k_B T$ must be in Joule, which requires the conversion $k_B T = e\\,T_{\\mathrm{eV}}$, where $e$ is the elementary charge and $T_{\\mathrm{eV}}$ denotes temperature in eV.\n\nStarting from these principles, derive the relationship between upstream temperature $T_u = T(0)$, target temperature $T_t = T(L_{\\parallel})$, and the constant heat flux $q$, by integrating the conduction law along $s$. Combine this with the sheath boundary condition to obtain a closed system for $T_u$, $T_t$, and $q$ when $q$ equals a specified incoming heat flux $q_{\\mathrm{in}}$ at $s=0$.\n\nDefine a dimensionless regime parameter $D$ that compares the conduction-induced temperature drop along $L_{\\parallel}$ to the sheath term at the target. Explicitly derive $D$ from the above laws without introducing any new empirical closures. Based on $D$, classify the regime as sheath-limited or conduction-limited. The classification must be algorithmic: return $0$ for sheath-limited and $1$ for conduction-limited, using a threshold you justify from your derivation.\n\nYour task is to implement a numerical experiment that, for a set of test cases where $\\kappa_0$ and $L_{\\parallel}$ are varied while $n_e$ and other parameters are held fixed, computes the following observables:\n\n1. $T_t$ in electronvolt (eV).\n2. $T_u$ in electronvolt (eV).\n3. $q_{\\mathrm{in}}$ in $\\mathrm{W}/\\mathrm{m}^2$.\n4. The derived dimensionless regime parameter $D$ (unitless).\n5. The regime classification as an integer ($0$ for sheath-limited, $1$ for conduction-limited).\n\nExpress all temperatures in eV and all heat fluxes in $\\mathrm{W}/\\mathrm{m}^2$. The outputs for $T_t$, $T_u$, $q_{\\mathrm{in}}$, and $D$ must be rounded to three decimal places.\n\nUse the following physical constants in SI units:\n- Elementary charge $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$.\n- Boltzmann constant $k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J}/\\mathrm{K}$.\n- Deuterium ion mass $m_i = 3.343583719\\times 10^{-27}\\ \\mathrm{kg}$.\n\nUse the following fixed parameters:\n- Sheath transmission factor $\\gamma = 7.0$.\n- Electron density $n_e = 1.0\\times 10^{19}\\ \\mathrm{m}^{-3}$.\n\nImplement the experiment for the following test suite of $(\\kappa_0, L_{\\parallel}, q_{\\mathrm{in}})$ values:\n- Test 1 (happy path, long connection): $\\kappa_0 = 2000\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$, $L_{\\parallel} = 20\\ \\mathrm{m}$, $q_{\\mathrm{in}} = 5.0\\times 10^{6}\\ \\mathrm{W}/\\mathrm{m}^2$.\n- Test 2 (sheath-limited bias: large $\\kappa_0$, short $L_{\\parallel}$): $\\kappa_0 = 5000\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$, $L_{\\parallel} = 2\\ \\mathrm{m}$, $q_{\\mathrm{in}} = 5.0\\times 10^{6}\\ \\mathrm{W}/\\mathrm{m}^2$.\n- Test 3 (near transition): $\\kappa_0 = 2000\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$, $L_{\\parallel} = 5\\ \\mathrm{m}$, $q_{\\mathrm{in}} = 5.0\\times 10^{6}\\ \\mathrm{W}/\\mathrm{m}^2$.\n- Test 4 (low heat flux): $\\kappa_0 = 2000\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$, $L_{\\parallel} = 20\\ \\mathrm{m}$, $q_{\\mathrm{in}} = 1.0\\times 10^{5}\\ \\mathrm{W}/\\mathrm{m}^2$.\n- Test 5 (strong sheath-limited): $\\kappa_0 = 20000\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$, $L_{\\parallel} = 1\\ \\mathrm{m}$, $q_{\\mathrm{in}} = 1.0\\times 10^{7}\\ \\mathrm{W}/\\mathrm{m}^2$.\n- Test 6 (strong conduction-limited): $\\kappa_0 = 500\\ \\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{eV}^{-7/2}$, $L_{\\parallel} = 30\\ \\mathrm{m}$, $q_{\\mathrm{in}} = 1.0\\times 10^{7}\\ \\mathrm{W}/\\mathrm{m}^2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must be a list in the order $[T_t, T_u, q_{\\mathrm{in}}, D, \\text{regime}]$, where the first four entries are floats rounded to three decimal places, and the last entry is an integer. For example, the overall output should look like:\n[[Tt1,Tu1,q1,D1,regime1],[Tt2,Tu2,q2,D2,regime2],...].",
            "solution": "The core of the problem is to relate the upstream plasma temperature, $T_u$, to the temperature at the divertor target, $T_t$, under a constant parallel heat flux, $q$. This is governed by two fundamental principles: heat conduction along the magnetic field line and heat transmission through the sheath at the target.\n\nFirst, we consider the electron parallel heat conduction, which is described by the Spitzer-Härm law:\n$$q = -\\kappa(T) \\frac{dT}{ds}$$\nwhere $q$ is the heat flux in $\\mathrm{W}/\\mathrm{m}^2$, $s$ is the coordinate along the magnetic field line from the upstream point ($s=0$) to the target ($s=L_{\\parallel}$), and $T$ is the electron temperature in electronvolts (eV). The thermal conductivity $\\kappa(T)$ is given by $\\kappa(T) = \\kappa_0 T^{5/2}$, with $\\kappa_0$ being a constant. Since the problem states that volumetric energy sources and sinks are negligible, the heat flux $q$ is constant along $s$.\n\nWe can integrate this equation to find the temperature profile. We separate variables and integrate over the length of the SOL, $L_{\\parallel}$:\n$$q \\int_{0}^{L_{\\parallel}} ds = -\\kappa_0 \\int_{T(0)}^{T(L_{\\parallel})} T^{5/2} dT$$\nWith $T_u = T(0)$ and $T_t = T(L_{\\parallel})$, the integration yields:\n$$q L_{\\parallel} = -\\kappa_0 \\left[ \\frac{2}{7} T^{7/2} \\right]_{T_u}^{T_t} = -\\frac{2}{7} \\kappa_0 (T_t^{7/2} - T_u^{7/2})$$\nRearranging this gives the fundamental relation of the two-point model:\n$$T_u^{7/2} = T_t^{7/2} + \\frac{7 q L_{\\parallel}}{2 \\kappa_0}$$\nThis equation connects the upstream and target temperatures via the heat flux, connection length, and conductivity.\n\nSecond, we apply the boundary condition at the divertor target ($s=L_{\\parallel}$), which is determined by sheath physics. The heat flux entering the sheath is given by:\n$$q = \\gamma n_e k_B T_t c_s$$\nwhere $\\gamma$ is the sheath heat transmission factor, $n_e$ is the electron density, and $c_s$ is the ion sound speed, $c_s = \\sqrt{k_B T_t / m_i}$. The term $k_B T_t$ represents thermal energy and must be in Joules. Since our temperature $T$ is in eV, we must use the conversion $k_B T_t \\rightarrow e T_t$, where $e$ is the elementary charge. Substituting this and the expression for $c_s$:\n$$q = \\gamma n_e (e T_t) \\sqrt{\\frac{e T_t}{m_i}} = \\gamma n_e e^{3/2} m_i^{-1/2} T_t^{3/2}$$\nFor convenience, let's define the sheath coefficient $C_{sh} = \\gamma n_e e^{3/2} m_i^{-1/2}$, so the sheath boundary condition simplifies to:\n$$q = C_{sh} T_t^{3/2}$$\n\nWith these two equations, we have a closed system. For a given incoming heat flux $q_{\\mathrm{in}}$, we set $q = q_{\\mathrm{in}}$ and solve for the temperatures.\n1.  From the sheath equation, we solve for the target temperature $T_t$:\n    $$T_t = \\left( \\frac{q_{\\mathrm{in}}}{C_{sh}} \\right)^{2/3}$$\n2.  With $T_t$ and $q_{\\mathrm{in}}$ known, we use the integrated conduction equation to find the upstream temperature $T_u$:\n    $$T_u = \\left( T_t^{7/2} + \\frac{7 q_{\\mathrm{in}} L_{\\parallel}}{2 \\kappa_0} \\right)^{2/7}$$\n\nThe problem requires defining a dimensionless regime parameter, $D$, to distinguish between sheath-limited and conduction-limited regimes. We look at the equation for $T_u^{7/2}$:\n$$T_u^{7/2} = T_t^{7/2} + \\frac{7 q L_{\\parallel}}{2 \\kappa_0}$$\nThe term $T_t^{7/2}$ represents the temperature scale set by the sheath boundary condition. The term $\\frac{7 q L_{\\parallel}}{2 \\kappa_0}$ represents the temperature drop due to conduction over the distance $L_{\\parallel}$. A natural dimensionless parameter is the ratio of these two terms:\n$$D = \\frac{7 q L_{\\parallel} / (2 \\kappa_0)}{T_t^{7/2}} = \\frac{7 q L_{\\parallel}}{2 \\kappa_0 T_t^{7/2}}$$\nThe physical interpretation of $D$ is as follows:\n-   If conduction is very efficient (large $\\kappa_0$) or the connection length $L_{\\parallel}$ is short, the temperature profile is nearly flat ($T_u \\approx T_t$). In this case, the conduction term is small compared to the sheath term, so $D \\ll 1$. This is the **sheath-limited regime**.\n-   If conduction is poor (small $\\kappa_0$) or the connection length $L_{\\parallel}$ is long, a large temperature gradient is required to drive the heat flux, resulting in $T_u \\gg T_t$. The conduction term dominates, so $D \\gg 1$. This is the **conduction-limited regime**.\n\nFor algorithmic classification, a threshold must be chosen. The natural choice is $D=1$, which represents the point where the conduction-induced temperature drop is of the same order as the target temperature itself (in this $T^{7/2}$ scaling). At $D=1$, $T_u^{7/2} = 2T_t^{7/2}$, which means $T_u = 2^{2/7}T_t \\approx 1.22 T_t$. This represents a reasonable transition point between a \"flat\" and a \"steep\" temperature profile. We therefore set the classification rule:\n-   Regime is sheath-limited (return $0$) if $D < 1$.\n-   Regime is conduction-limited (return $1$) if $D \\ge 1$.\n\nThe numerical implementation will follow this logic. For each test case $(\\kappa_0, L_{\\parallel}, q_{\\mathrm{in}})$, we will calculate $C_{sh}$ using the provided constants, then compute $T_t$, $T_u$, and $D$ using the derived formulas, and finally classify the regime. The results will be formatted as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady-state SOL heat transport problem for a series of test cases.\n    \"\"\"\n    # Physical constants in SI units\n    e_charge = 1.602176634e-19  # Elementary charge in Coulombs\n    m_ion_d = 3.343583719e-27   # Deuterium ion mass in kg\n\n    # Fixed plasma parameters\n    gamma_sh = 7.0             # Sheath heat transmission factor\n    n_electron = 1.0e19        # Electron density in m^-3\n\n    # Test suite of parameters: (kappa_0, L_parallel, q_in)\n    # kappa_0: W m^-1 eV^-7/2\n    # L_parallel: m\n    # q_in: W/m^2\n    test_cases = [\n        (2000.0, 20.0, 5.0e6),   # Test 1: Happy path, long connection\n        (5000.0, 2.0, 5.0e6),    # Test 2: Sheath-limited bias\n        (2000.0, 5.0, 5.0e6),    # Test 3: Near transition\n        (2000.0, 20.0, 1.0e5),   # Test 4: Low heat flux\n        (20000.0, 1.0, 1.0e7),   # Test 5: Strong sheath-limited\n        (500.0, 30.0, 1.0e7)     # Test 6: Strong conduction-limited\n    ]\n\n    all_results = []\n\n    # Pre-calculate the sheath coefficient C_sh = gamma * n_e * e^(3/2) * m_i^(-1/2)\n    # T_t will be in eV, q in W/m^2.\n    C_sh = gamma_sh * n_electron * (e_charge**1.5) * (m_ion_d**-0.5)\n\n    for case in test_cases:\n        kappa_0, L_parallel, q_in = case\n\n        # 1. Calculate target temperature T_t from the sheath boundary condition\n        # q = C_sh * T_t^(3/2)\n        T_t = (q_in / C_sh)**(2.0 / 3.0)\n\n        # 2. Calculate upstream temperature T_u from the integrated conduction law\n        # T_u^(7/2) = T_t^(7/2) + (7 * q * L_parallel) / (2 * kappa_0)\n        # We calculate the term in parenthesis first\n        conduction_term = (7.0 * q_in * L_parallel) / (2.0 * kappa_0)\n        T_u_pow_7_2 = T_t**3.5 + conduction_term\n        T_u = T_u_pow_7_2**(2.0 / 7.0)\n\n        # 3. Calculate the dimensionless regime parameter D\n        # D = (conduction term) / (sheath term)\n        # where sheath term is T_t^(7/2)\n        if T_t == 0:\n            # Avoid division by zero, though physically T_t > 0 for q_in > 0\n            D = float('inf')\n        else:\n            D = conduction_term / (T_t**3.5)\n\n        # 4. Classify the regime based on D\n        # 0 for sheath-limited (D < 1), 1 for conduction-limited (D >= 1)\n        regime = 1 if D >= 1.0 else 0\n\n        # 5. Store the results for this case. q_in is also an \"observable\".\n        # Formatting to 3 decimal places occurs in the final print statement.\n        result_list = [T_t, T_u, q_in, D, regime]\n        all_results.append(result_list)\n\n    # Format the final output string as a list of lists, with no spaces\n    # and with specified rounding for float values.\n    outer_parts = []\n    for res in all_results:\n        # res = [T_t, T_u, q_in, D, regime]\n        inner_parts = [\n            f\"{res[0]:.3f}\",\n            f\"{res[1]:.3f}\",\n            f\"{float(res[2]):.3f}\",\n            f\"{res[3]:.3f}\",\n            str(res[4])\n        ]\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n\n    final_output_string = f\"[{','.join(outer_parts)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}