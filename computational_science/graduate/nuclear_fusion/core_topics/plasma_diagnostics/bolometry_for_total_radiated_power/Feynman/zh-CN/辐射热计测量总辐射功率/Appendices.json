{
    "hands_on_practices": [
        {
            "introduction": "上手实践的第一步是理解单个辐射热测量计探头的基本工作原理。这个练习将辐射热测量计箔片简化为一个集总热容模型，其温度变化取决于吸收的辐射功率与传导到散热器的功率之间的平衡。通过建立和求解能量守恒方程，您将能够推导出探头对功率阶跃变化的瞬态响应，并理解决定其测量速度的关键参数——热时间常数$\\tau = C/G$。",
            "id": "3692180",
            "problem": "用于测量环形磁约束装置中总辐射功率的电阻箔式热辐射计被建模为具有热容 $C$ 的单一热节点，通过热导 $G$ 连接到温度为 $T_{\\mathrm{s}}$ 的热沉。吸收的辐射功率 $P_{\\mathrm{abs}}(t)$ 加热箔片，温度 $T(t)$ 根据能量守恒演变。吸收功率与入射辐射功率 $P_{\\mathrm{inc}}(t)$ 的关系由吸收效率 $\\eta$ 给出，即 $P_{\\mathrm{abs}}(t)=\\eta\\,P_{\\mathrm{inc}}(t)$。\n\n假设系统在时间 $t0$ 时最初处于稳态，具有恒定的入射功率 $P_{\\mathrm{inc},0}$ 和相应的吸收功率 $P_{\\mathrm{abs},0}=\\eta P_{\\mathrm{inc},0}$。在 $t=0$ 时，入射功率阶跃到一个新的恒定值，使得吸收功率增加一个已知量 $\\Delta P_{\\mathrm{abs}}=10 \\mathrm{mW}$。取 $G=1 \\mathrm{mW/K}$，$C=10^{-3} \\mathrm{J/K}$，以及 $\\eta=0.8$。\n\n从第一性原理出发，用初始温度 $T(0^{-})$ 和给定参数推导 $t\\ge 0$ 时的瞬态温度 $T(t)$。然后确定 $T(t)$ 在阶跃后达到其新平衡温度的 $5\\%$ 范围内所需的时间。将最终时间以秒为单位表示，并四舍五入到四位有效数字。",
            "solution": "用户希望我解决一个关于电阻箔式热辐射计的热力学问题。\n\n**1. 问题验证**\n\n*   **步骤 1：提取已知条件**\n    *   系统模型：具有热容 $C$ 和至温度为 $T_{\\mathrm{s}}$ 的热沉的热导 $G$ 的单一热节点。\n    *   吸收功率关系：$P_{\\mathrm{abs}}(t) = \\eta P_{\\mathrm{inc}}(t)$。\n    *   初始条件 ($t0$)：系统处于稳态，具有恒定的吸收功率 $P_{\\mathrm{abs},0}$。箔片温度为 $T(0^{-})$。\n    *   事件 ($t=0$)：吸收功率阶跃增加 $\\Delta P_{\\mathrm{abs}} = 10 \\, \\mathrm{mW}$。\n    *   参数：\n        *   $G = 1 \\, \\mathrm{mW/K} = 1 \\times 10^{-3} \\, \\mathrm{W/K}$\n        *   $C = 10^{-3} \\, \\mathrm{J/K}$\n        *   $\\eta = 0.8$\n        *   $\\Delta P_{\\mathrm{abs}} = 10 \\, \\mathrm{mW} = 1 \\times 10^{-2} \\, \\mathrm{W}$\n    *   任务 1：用 $T(0^{-})$ 和给定参数推导 $t \\ge 0$ 时的瞬态温度 $T(t)$。\n    *   任务 2：确定 $T(t)$ 达到其新平衡温度的 $5\\%$ 范围内所需的时间。\n    *   输出要求：最终时间以秒为单位，四舍五入到四位有效数字。\n\n*   **步骤 2：使用提取的已知条件进行验证**\n    *   **科学依据：** 该问题基于能量守恒原理和牛顿冷却定律，这是热力学和传热学的基础。这里使用的“集总电容模型”是薄箔热辐射计的一个标准且有效的近似。其在聚变诊断中的应用是科学正确的。\n    *   **适定性：** 该问题建立了一个具有确定初始条件的一阶线性常微分方程，构成了一个具有唯一、稳定解的适定初值问题。求解所需的所有参数（$C$，$G$，$\\Delta P_{\\mathrm{abs}}$）都已提供。\n    *   **客观性与清晰度：** 问题使用精确、客观的科学语言陈述。“达到其新平衡温度的 $5\\%$ 范围内”在瞬态系统响应的语境下有标准解释（指瞬态变化的完成度），这使得问题没有歧义。\n    *   **完整性与一致性：** 问题是自洽的。提供的数值及其单位在物理上是一致的。请注意，吸收效率 $\\eta$ 和热沉温度 $T_{\\mathrm{s}}$ 对最终计算并非必需，但它们在问题描述中的出现是为了提供物理背景，并不会造成矛盾。\n    *   **现实性：** 给定的热容、热导和功率变化值对于等离子体物理实验中使用的微加工热辐射计是物理上合理的。\n\n*   **步骤 3：结论与行动**\n    *   问题被判定为**有效**，因为它是科学合理、适定且内部一致的。我将继续进行求解。\n\n**2. 求解推导**\n\n热辐射计箔片的瞬态热行为遵循能量守恒原理。箔片内能的变化率等于吸收的功率减去损失到热沉的功率。\n\n内能的变化率由 $C \\frac{dT(t)}{dt}$ 给出，其中 $C$ 是热容，$T(t)$ 是箔片的温度。根据牛顿冷却定律，损失到温度为 $T_{\\mathrm{s}}$ 的热沉的功率为 $P_{\\mathrm{loss}}(t) = G(T(t) - T_{\\mathrm{s}})$，其中 $G$ 是热导。吸收的功率为 $P_{\\mathrm{abs}}(t)$。\n\n因此，能量平衡方程为：\n$$\nC \\frac{dT(t)}{dt} = P_{\\mathrm{abs}}(t) - G(T(t) - T_{\\mathrm{s}})\n$$\n\n首先，我们分析稳态条件。\n对于 $t  0$，系统处于初始稳态。温度恒定，$T(t) = T(0^{-}) \\equiv T_0$，所以 $\\frac{dT}{dt} = 0$。吸收功率为 $P_{\\mathrm{abs}}(t) = P_{\\mathrm{abs},0}$。能量平衡方程变为：\n$$\n0 = P_{\\mathrm{abs},0} - G(T_0 - T_{\\mathrm{s}}) \\implies P_{\\mathrm{abs},0} = G(T_0 - T_{\\mathrm{s}})\n$$\n\n在 $t=0$ 时，吸收功率阶跃到一个新的恒定值 $P_{\\mathrm{abs, new}} = P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}}$。当 $t \\to \\infty$ 时，系统最终将达到一个新的最终稳态。在此最终状态下，温度恒定，$T(t) = T_f$，所以 $\\frac{dT}{dt} = 0$。能量平衡为：\n$$\n0 = (P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}}) - G(T_f - T_{\\mathrm{s}}) \\implies P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}} = G(T_f - T_{\\mathrm{s}})\n$$\n\n现在，我们求解 $t \\ge 0$ 时的瞬态行为。控制微分方程是：\n$$\nC \\frac{dT}{dt} = (P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}}) - G(T - T_{\\mathrm{s}})\n$$\n我们可以将最终平衡条件的表达式 $P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}} = G T_f - G T_{\\mathrm{s}}$ 代入微分方程：\n$$\nC \\frac{dT}{dt} = (G T_f - G T_{\\mathrm{s}}) - (G T - G T_{\\mathrm{s}}) = G(T_f - T)\n$$\n这是一个一阶线性常微分方程。我们可以将其重新排列为：\n$$\n\\frac{dT}{T_f - T} = \\frac{G}{C} dt\n$$\n对两边积分，初始条件为 $T(0) = T_0$，我们得到：\n$$\n\\int_{T_0}^{T(t)} \\frac{dT'}{T_f - T'} = \\int_0^t \\frac{G}{C} dt'\n$$\n$$\n[-\\ln|T_f - T'|]_{T_0}^{T(t)} = \\frac{G}{C} t\n$$\n$$\n-\\ln|T_f - T(t)| + \\ln|T_f - T_0| = \\frac{G}{C} t\n$$\n由于温度 $T(t)$ 从 $T_0$ 开始并从下方接近 $T_f$（因为功率增加），我们有 $T_f  T(t)  T_0$。因此，绝对值符号可以去掉。\n$$\n\\ln\\left(\\frac{T_f - T_0}{T_f - T(t)}\\right) = \\frac{G}{C} t\n$$\n我们定义热时间常数 $\\tau = C/G$。方程变为：\n$$\n\\frac{T_f - T_0}{T_f - T(t)} = \\exp(t/\\tau)\n$$\n求解 $T(t)$:\n$$\nT_f - T(t) = (T_f - T_0) \\exp(-t/\\tau)\n$$\n$$\nT(t) = T_f - (T_f - T_0) \\exp(-t/\\tau)\n$$\n这可以改写为用初始温度 $T_0 = T(0^{-})$ 表示：\n$$\nT(t) = T_0 + (T_f - T_0)(1 - \\exp(-t/\\tau))\n$$\n为了用给定参数表示此式，我们求总温升 $T_f - T_0$。用最终稳态方程减去初始稳态方程：\n$$\n(P_{\\mathrm{abs},0} + \\Delta P_{\\mathrm{abs}}) - P_{\\mathrm{abs},0} = G(T_f - T_{\\mathrm{s}}) - G(T_0 - T_{\\mathrm{s}})\n$$\n$$\n\\Delta P_{\\mathrm{abs}} = G(T_f - T_0) \\implies T_f - T_0 = \\frac{\\Delta P_{\\mathrm{abs}}}{G}\n$$\n将此代入 $T(t)$ 的表达式，我们得到 $t \\ge 0$ 时用 $T(0^{-})$ 和给定参数表示的瞬态温度，正如题目所要求：\n$$\nT(t) = T(0^{-}) + \\frac{\\Delta P_{\\mathrm{abs}}}{G} \\left(1 - \\exp\\left(-\\frac{G}{C}t\\right)\\right)\n$$\n\n接下来，我们必须确定 $T(t)$ 达到其新平衡温度 $T_f$ 的 $5\\%$ 范围内所需的时间 $t$。这通常意味着剩余温差 $T_f - T(t)$ 是总温度变化 $T_f - T_0$ 的 $5\\%$。\n条件是：\n$$\nT_f - T(t) \\le 0.05 \\times (T_f - T_0)\n$$\n从我们的解 $T_f - T(t) = (T_f - T_0) \\exp(-t/\\tau)$，我们可以将其代入该条件：\n$$\n(T_f - T_0) \\exp(-t/\\tau) \\le 0.05 (T_f - T_0)\n$$\n由于 $\\Delta P_{\\mathrm{abs}} > 0$，因此 $T_f > T_0$，所以我们可以除以正量 $(T_f - T_0)$：\n$$\n\\exp(-t/\\tau) \\le 0.05\n$$\n为了求所需时间，我们求解等式：\n$$\n\\exp(-t/\\tau) = 0.05\n$$\n对两边取自然对数：\n$$\n-\\frac{t}{\\tau} = \\ln(0.05)\n$$\n$$\nt = -\\tau \\ln(0.05) = \\tau \\ln\\left(\\frac{1}{0.05}\\right) = \\tau \\ln(20)\n$$\n现在，我们计算数值。首先，我们求热时间常数 $\\tau$：\n$$\n\\tau = \\frac{C}{G} = \\frac{10^{-3} \\, \\mathrm{J/K}}{1 \\times 10^{-3} \\, \\mathrm{W/K}} = \\frac{10^{-3} \\, \\mathrm{J/K}}{10^{-3} \\, \\mathrm{J/(s \\cdot K)}} = 1 \\, \\mathrm{s}\n$$\n因此，时间 $t$ 为：\n$$\nt = (1 \\, \\mathrm{s}) \\times \\ln(20) \\approx 2.995732 \\, \\mathrm{s}\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\nt \\approx 2.996 \\, \\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{2.996}\n$$"
        },
        {
            "introduction": "在理解了单个探头的工作原理后，我们必须考虑其所处的复杂环境。在聚变装置中，辐射热测量计的信号并非仅来自等离子体的直接视线辐射，真空室壁的反射起着至关重要的作用。本练习  引导您通过建立一个考虑壁反射率（反照率）和探测器视场立体角的简化物理模型，来量化这种多重反射效应。通过对直接辐射和无限次反射贡献求和，您将推导出一个修正因子，这对于从测量信号中准确推断总辐射功率至关重要。",
            "id": "3692237",
            "problem": "考虑一个用于核聚变实验的闭合环形真空室，其上装有一个宽带电阻式热辐射计，用于测量等离子体的总辐射功率。该热辐射计通过一个由其视场（FOV）定义的锥形接收区域来观测等离子体，该视场的半角为 $\\theta$。假设采用以下物理上现实的模型：\n\n- 等离子体在真空室内各向同性地辐射，且等离子体本身没有再吸收。\n- 真空室的内壁是一个漫反射（朗伯）反射体，其特征由光谱平均反照率 $A$ 描述，即入射辐射功率的一部分（比例为 $A$）被各向同性地反射回真空室内，而另一部分（比例为 $1-A$）被吸收。\n- 热辐射计探测任何进入其锥形视场的辐射，所有未进入视场的光线要么撞击到壁上，要么继续传播直至撞击到壁上。\n- 真空室是封闭的，因此辐射的唯一汇（sink）是壁吸收和热辐射计探测。\n\n利用能量守恒和立体角定义，从第一性原理推导，由于多次壁面反射，探测到的功率相对于直接视线探测（即不计反射）所增加的倍增因子 $M$。然后，对于反照率 $A = 0.72$ 和视场半角 $\\theta = 14^\\circ$（角度必须以度为单位处理），对 $M$ 进行数值计算。将您的最终答案 $M$ 四舍五入至四位有效数字。将 $M$ 表示为一个无量纲数。",
            "solution": "在尝试求解之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 系统：一个用于核聚变实验的闭合环形真空室。\n- 仪器：一个宽带电阻式热辐射计。\n- 热辐射计视场（FOV）：一个锥形接收区域，半角为 $\\theta$。\n- 等离子体辐射：各向同性辐射，无再吸收。\n- 真空室壁属性：漫反射（朗伯）反射体，光谱平均反照率为 $A$。入射功率的一部分（比例为 $A$）被各向同性地反射；一部分（比例为 $1-A$）被吸收。\n- 探测条件：热辐射计探测所有进入其视场的辐射。未进入视场的光线撞击到壁上。\n- 能量汇：壁吸收和热辐射计探测。\n- 要求推导：由于多次壁面反射，探测到的功率相对于直接视线探测所增加的倍增因子 $M$。\n- 数值：$A = 0.72$，$\\theta = 14^\\circ$。\n- 最终答案要求：将 $M$ 的数值四舍五入至四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了一个简化但标准的模型，用于等离子体诊断中解读托卡马克等聚变装置中的热辐射计测量数据。各向同性辐射、朗伯反射、反照率和立体角的概念都是基础性的且应用正确。该设置在科学上是现实的。\n- **适定性**：该问题提供了一个清晰的物理模型，并包含了推导所要求的无量纲因子 $M$ 所需的所有必要参数（$A$, $\\theta$）。目标定义明确，预期有唯一解。\n- **客观性**：问题以精确的技术语言陈述，没有主观性或模糊性。\n- **缺陷**：\n    1.  **科学上不健全**：无。该模型是一个有效的物理近似。\n    2.  **无法形式化/不相关**：无。该问题可直接使用辐射度学和几何学原理进行形式化，并且与其所述领域高度相关。\n    3.  **不完整/矛盾**：无。假设系统是封闭的，且具有各向同性源（初级和次级），这使得解与具体真空室几何形状无关，因此没有信息缺失。条件是自洽的。\n    4.  **不现实/不可行**：无。给定的反照率和视场角值是典型且物理上合理的。\n    5.  **病态/结构不良**：无。待推导的量定义清晰。\n    6.  **伪深刻/琐碎**：无。该问题需要一个涉及几何级数的严谨推导，这是一个标准但非平凡的物理问题。\n    7.  **超出科学可验证范围**：无。该推导在数学上是可验证的。\n\n### 步骤3：结论与行动\n该问题有效、适定且科学上健全。将进行求解推导。\n\n### 解答推导\n\n设 $P_{rad}$ 为等离子体各向同性辐射的总功率。设 $\\Omega_{bolo}$ 为热辐射计锥形视场（FOV）所对的立体角。对于一个半角为 $\\theta$ 的锥体，该立体角由下式给出：\n$$\n\\Omega_{bolo} = 2\\pi(1 - \\cos\\theta)\n$$\n各向同性辐射的总立体角为 $4\\pi$ 球面度。直接入射到热辐射计上的总辐射功率份额 $f_{bolo}$ 是热辐射计立体角与总立体角之比。\n$$\nf_{bolo} = \\frac{\\Omega_{bolo}}{4\\pi} = \\frac{2\\pi(1 - \\cos\\theta)}{4\\pi} = \\frac{1 - \\cos\\theta}{2}\n$$\n剩余的功率份额 $f_{wall}$ 最初入射到真空室壁上。由于系统是封闭的，唯一的汇是热辐射计和壁。\n$$\nf_{wall} = 1 - f_{bolo} = 1 - \\frac{1 - \\cos\\theta}{2} = \\frac{2 - (1 - \\cos\\theta)}{2} = \\frac{1 + \\cos\\theta}{2}\n$$\n热辐射计探测到的总功率 $P_{bolo}$ 是直接从等离子体探测到的功率与经过一次或多次壁面反射后探测到的功率之和。\n\n1.  **直接探测到的功率 ($P_0$)**：这是从等离子体直接辐射到热辐射计视场内的功率。\n    $$\n    P_0 = P_{rad} f_{bolo}\n    $$\n2.  **经过一次反射后探测到的功率 ($P_1$)**：\n    -   最初撞击到壁上的功率为 $P_{rad} f_{wall}$。\n    -   这部分功率的一部分（比例为 $A$）被反射。总反射功率为 $A P_{rad} f_{wall}$。\n    -   由于反射是朗伯型（漫反射），这部分反射功率从壁表面各向同性地辐射出去。覆盖了总 $4\\pi$ 立体角中 $f_{bolo}$ 份额的热辐射计将探测到这部分反射功率的 $f_{bolo}$ 份额。\n    -   因此，经过一次反射后探测到的功率为 $P_1 = (A P_{rad} f_{wall}) f_{bolo}$。\n\n3.  **经过两次反射后探测到的功率 ($P_2$)**：\n    -   在第一次反射中反射的功率（$A P_{rad} f_{wall}$）中，一部分（比例为 $f_{wall}$）将再次撞击到壁上。\n    -   这部分功率 $(A P_{rad} f_{wall}) f_{wall}$ 以反照率 $A$ 反射，产生第二次反射的功率 $A (A P_{rad} f_{wall} f_{wall}) = P_{rad} (A f_{wall})^2$。\n    -   这部分功率也各向同性地辐射，热辐射计探测到其中的 $f_{bolo}$ 份额。\n    -   因此，经过两次反射后探测到的功率为 $P_2 = P_{rad} (A f_{wall})^2 f_{bolo}$。\n\n4.  **总探测功率 ($P_{bolo}$)**：总探测功率是一个无穷几何级数的和：\n    $$\n    P_{bolo} = P_0 + P_1 + P_2 + \\dots = P_{rad} f_{bolo} + P_{rad} f_{bolo} (A f_{wall}) + P_{rad} f_{bolo} (A f_{wall})^2 + \\dots\n    $$\n    $$\n    P_{bolo} = P_{rad} f_{bolo} \\sum_{n=0}^{\\infty} (A f_{wall})^n\n    $$\n    该级数的公比是 $r = A f_{wall}$。由于 $0 \\le A  1$ 且 $0  f_{wall}  1$，条件 $|r|1$ 得到满足，级数收敛于 $\\frac{1}{1-r}$。\n    $$\n    P_{bolo} = P_{rad} f_{bolo} \\left(\\frac{1}{1 - A f_{wall}}\\right)\n    $$\n问题将倍增因子 $M$ 定义为总探测功率 ($P_{bolo}$) 与直接视线探测功率 ($P_0$) 之比。\n$$\nM = \\frac{P_{bolo}}{P_0} = \\frac{P_{rad} f_{bolo} \\left(\\frac{1}{1 - A f_{wall}}\\right)}{P_{rad} f_{bolo}} = \\frac{1}{1 - A f_{wall}}\n$$\n代入 $f_{wall}$ 的表达式：\n$$\nM = \\frac{1}{1 - A \\left(\\frac{1 + \\cos\\theta}{2}\\right)}\n$$\n这是倍增因子 $M$ 的最终解析表达式。\n\n### 数值计算\n\n给定 $A = 0.72$ 和 $\\theta = 14^\\circ$。计算需要以度为单位的角度的余弦值。\n$$\n\\cos(14^\\circ) \\approx 0.970295726\n$$\n现在，将数值代入 $M$ 的表达式：\n$$\nM = \\frac{1}{1 - 0.72 \\left(\\frac{1 + 0.970295726}{2}\\right)}\n$$\n$$\nM = \\frac{1}{1 - 0.72 \\left(\\frac{1.970295726}{2}\\right)}\n$$\n$$\nM = \\frac{1}{1 - 0.72 \\times 0.985147863}\n$$\n$$\nM = \\frac{1}{1 - 0.709306461}\n$$\n$$\nM = \\frac{1}{0.290693539}\n$$\n$$\nM \\approx 3.4396788\n$$\n将结果四舍五入到四位有效数字，我们得到 $3.440$。",
            "answer": "$$\n\\boxed{3.440}\n$$"
        },
        {
            "introduction": "辐射热测量的最终目标之一是重建辐射在空间中的分布，这需要结合来自多个视线探头的测量数据，即所谓的“层析成像”或“断层重建”。这个过程本质上是一个数学上的“反问题”，即从一组线积分信号$\\mathbf{s}$中反演出体辐射率分布$\\boldsymbol{\\varepsilon}$。本高级练习  深入探讨了Tikhonov正则化这一关键的重建技术。您将通过构建和分析分辨率矩阵$\\mathbf{R}$，来量化诊断系统的空间分辨能力，并深刻理解探测器几何布局和正则化参数的选择如何影响重建结果的准确性和平滑度。",
            "id": "3692195",
            "problem": "给定一个用于计算核聚变等离子体中总辐射功率的辐射热计线积分一维离散化模型。其测量模型为：每个辐射热计通道记录一个线积分信号，该信号是局域发射率沿其视线的路径积分。在空间坐标为 $x \\in [0,X]$ 的一维板状表示中，对于通道索引 $k$，其连续正向模型为 $s_k = \\int_{0}^{X} S_k(x)\\,\\varepsilon(x)\\,dx$，其中 $S_k(x)$ 是沿弦的仪器灵敏度（在此视作已知函数），$\\varepsilon(x)$ 是体积发射率。将区域 $[0,X]$ 离散化为 $N$ 个不重叠的均匀体素，其中心为 $\\{x_i\\}_{i=1}^{N}$，宽度为 $\\Delta x = X/N$。将 $\\varepsilon(x)$ 近似为在各体素上的分段常数，从而构成离散线性系统 $\\mathbf{s} = \\mathbf{A}\\,\\boldsymbol{\\varepsilon}$，其中 $\\mathbf{A} \\in \\mathbb{R}^{M \\times N}$ 是由体素平均的弦灵敏度构建的几何/灵敏度矩阵，$\\boldsymbol{\\varepsilon} \\in \\mathbb{R}^N$ 是发射率值向量。考虑 Tikhonov 正则化最小二乘估计器，它最小化 $\\|\\mathbf{A}\\boldsymbol{\\varepsilon} - \\mathbf{s}\\|_2^2 + \\lambda \\| \\mathbf{L}\\boldsymbol{\\varepsilon} \\|_2^2$，其中 $\\lambda0$ 是正则化参数，$\\mathbf{L} \\in \\mathbb{R}^{(N-1)\\times N}$ 是强制平滑的一阶差分算子。\n\n根据第一性原理，构建分辨率矩阵 $\\mathbf{R} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1}\\,\\mathbf{A}^\\top \\mathbf{A}$。在没有测量噪声的情况下进行拟合时，该矩阵通过 $\\widehat{\\boldsymbol{\\varepsilon}} = \\mathbf{R}\\,\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$ 将真实的离散化发射率 $\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$ 映射到重建发射率 $\\widehat{\\boldsymbol{\\varepsilon}}$。分辨率矩阵的空间展宽可作如下解释：对于每个体素索引 $j \\in \\{1,\\dots,N\\}$，考虑 $\\mathbf{R}$ 的第 $j$ 列，记为 $\\mathbf{r}^{(j)} \\in \\mathbb{R}^{N}$。通过 $w_i^{(j)} = \\max(r^{(j)}_i,0)\\big/\\sum_{\\ell=1}^{N}\\max(r^{(j)}_\\ell,0)$ 定义非负归一化权重，并将体素 $j$ 的空间分辨率长度定义为其中心周围的均方根展宽，\n$$\n\\ell_j = \\sqrt{\\sum_{i=1}^{N} \\big(x_i - x_j\\big)^2\\, w_i^{(j)}} \\quad \\text{单位：米}。\n$$\n最后，通过平均分辨率长度来总结给定配置的空间分辨率，\n$$\n\\overline{\\ell} = \\frac{1}{N}\\sum_{j=1}^{N} \\ell_j \\quad \\text{单位：米}。\n$$\n\n使用以下基本依据来推导和实现计算：\n- 线积分测量的线性正向模型 $s_k = \\int_{0}^{X} S_k(x)\\,\\varepsilon(x)\\,dx$，及其使用体素平均弦灵敏度的离散化形式 $\\mathbf{s} = \\mathbf{A}\\,\\boldsymbol{\\varepsilon}$，\n- 最小化 $\\|\\mathbf{A}\\boldsymbol{\\varepsilon} - \\mathbf{s}\\|_2^2 + \\lambda \\| \\mathbf{L}\\boldsymbol{\\varepsilon} \\|_2^2$ 的 Tikhonov 正则化最小二乘估计器，\n- 分辨率矩阵 $\\mathbf{R}$ 的定义及其作为映射 $\\widehat{\\boldsymbol{\\varepsilon}} = \\mathbf{R}\\,\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$ 的解释。\n\n在此问题中，对于每个通道 $k \\in \\{1,\\dots,M\\}$，设弦灵敏度为中心是 $c_k$、宽度是 $\\sigma_k$ 的高斯函数 $S_k(x) = \\exp\\!\\big(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\big)$，并通过体素平均定义离散灵敏度矩阵的元素，\n$$\nA_{k,i} = \\frac{1}{\\Delta x}\\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} \\exp\\!\\left(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\right)\\,dx,\n$$\n其中 $x_i$ 是均匀分布在 $[0,X]$ 上的体素中心位置，且 $\\Delta x = X/N$。\n\n定义一阶差分正则化算子 $\\mathbf{L}$ 为 $(\\mathbf{L}\\boldsymbol{\\varepsilon})_j = \\varepsilon_{j} - \\varepsilon_{j+1}$，其中 $j \\in \\{1,\\dots,N-1\\}$，即，\n$$\n\\mathbf{L} =\n\\begin{bmatrix}\n1  -1  0  \\cdots  0\\\\\n0  1  -1  \\cdots  0\\\\\n\\vdots   \\ddots  \\ddots  \\vdots\\\\\n0  \\cdots  0  1  -1\n\\end{bmatrix} \\in \\mathbb{R}^{(N-1)\\times N}.\n$$\n\n实现一个程序来完成以下任务：\n- 为每个测试用例构建 $\\mathbf{A}$ 和 $\\mathbf{L}$，\n- 计算 $\\mathbf{R}$，\n- 计算所有 $j$ 的 $\\ell_j$，然后计算 $\\overline{\\ell}$。\n\n你的程序必须使用下方的测试套件，并以所需的格式和单位生成最终输出。所有空间长度必须以米为单位表示。最终输出必须四舍五入到小数点后四位。\n\n测试套件：\n- 案例 1（正常路径，中度超定，弱正则化）：$X=1.0\\,\\mathrm{m}$，$N=8$，$M=12$，$c_k$ 在 $[0,1]$ 内均匀分布（对于 $k=1,\\dots,M$），所有 $k$ 的 $\\sigma_k = 0.15\\,\\mathrm{m}$，$\\lambda = 10^{-3}$。\n- 案例 2（欠定，较强正则化）：$X=1.0\\,\\mathrm{m}$，$N=8$，$M=4$，$c_k \\in \\{0.2, 0.4, 0.6, 0.8\\}\\,\\mathrm{m}$，所有 $k$ 的 $\\sigma_k = 0.20\\,\\mathrm{m}$，$\\lambda = 5\\times 10^{-2}$。\n- 案例 3（过平滑，强正则化）：$X=1.0\\,\\mathrm{m}$，$N=8$，$M=12$，$c_k$ 在 $[0,1]$ 内均匀分布（对于 $k=1,\\dots,M$），所有 $k$ 的 $\\sigma_k = 0.15\\,\\mathrm{m}$，$\\lambda = 1.0$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是相应测试用例的平均分辨率长度 $\\overline{\\ell}$，单位为米，四舍五入到小数点后四位。",
            "solution": "在尝试给出解决方案之前，需对问题进行验证。\n\n### 步骤 1：提取已知信息\n\n- **区域**：一维空间坐标 $x \\in [0,X]$。\n- **连续正向模型**：$s_k = \\int_{0}^{X} S_k(x)\\,\\varepsilon(x)\\,dx$，其中 $s_k$ 是通道 $k$ 的信号，$S_k(x)$ 是灵敏度函数，$\\varepsilon(x)$ 是发射率。\n- **离散化**：区域 $[0,X]$ 被离散化为 $N$ 个均匀、不重叠的体素。体素宽度为 $\\Delta x = X/N$，体素中心为 $\\{x_i\\}_{i=1}^{N}$。发射率 $\\varepsilon(x)$ 假定在每个体素上为分段常数。\n- **离散线性系统**：$\\mathbf{s} = \\mathbf{A}\\,\\boldsymbol{\\varepsilon}$，其中 $\\mathbf{s} \\in \\mathbb{R}^M$ 是测量向量，$\\boldsymbol{\\varepsilon} \\in \\mathbb{R}^N$ 是离散化发射率向量，$\\mathbf{A} \\in \\mathbb{R}^{M \\times N}$ 是几何/灵敏度矩阵。\n- **Tikhonov 正则化**：通过最小化代价函数 $\\|\\mathbf{A}\\boldsymbol{\\varepsilon} - \\mathbf{s}\\|_2^2 + \\lambda \\| \\mathbf{L}\\boldsymbol{\\varepsilon} \\|_2^2$ 来估计发射率，其中 $\\lambda0$ 是正则化参数。\n- **一阶差分算子**：$\\mathbf{L} \\in \\mathbb{R}^{(N-1)\\times N}$ 由 $(\\mathbf{L}\\boldsymbol{\\varepsilon})_j = \\varepsilon_{j} - \\varepsilon_{j+1}$ 定义，其中 $j \\in \\{1,\\dots,N-1\\}$。\n- **分辨率矩阵**：定义为 $\\mathbf{R} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1}\\,\\mathbf{A}^\\top \\mathbf{A}$，它在无噪声情况下将真实发射率映射到重建发射率：$\\widehat{\\boldsymbol{\\varepsilon}} = \\mathbf{R}\\,\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$。\n- **空间分辨率定义**：\n    - 对于 $\\mathbf{R}$ 的第 $j$ 列，记为 $\\mathbf{r}^{(j)}$，非负归一化权重定义为 $w_i^{(j)} = \\max(r^{(j)}_i,0)\\big/\\sum_{\\ell=1}^{N}\\max(r^{(j)}_\\ell,0)$。\n    - 体素 $j$ 的分辨率长度为 $\\ell_j = \\sqrt{\\sum_{i=1}^{N} \\big(x_i - x_j\\big)^2\\, w_i^{(j)}}$。\n    - 平均分辨率长度为 $\\overline{\\ell} = \\frac{1}{N}\\sum_{j=1}^{N} \\ell_j$。\n- **灵敏度函数**：高斯分布，$S_k(x) = \\exp\\!\\big(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\big)$。\n- **矩阵元素定义**：$A_{k,i} = \\frac{1}{\\Delta x}\\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} \\exp\\!\\left(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\right)\\,dx$。\n- **测试用例**：\n    - **案例 1**：$X=1.0\\,\\mathrm{m}$，$N=8$，$M=12$，$c_k$ 在 $[0,1]$ 内均匀分布（对于 $k=1,\\dots,M$），所有 $k$ 的 $\\sigma_k = 0.15\\,\\mathrm{m}$，$\\lambda = 10^{-3}$。\n    - **案例 2**：$X=1.0\\,\\mathrm{m}$，$N=8$，$M=4$，$c_k \\in \\{0.2, 0.4, 0.6, 0.8\\}\\,\\mathrm{m}$，所有 $k$ 的 $\\sigma_k = 0.20\\,\\mathrm{m}$，$\\lambda = 5\\times 10^{-2}$。\n    - **案例 3**：$X=1.0\\,\\mathrm{m}$，$N=8$，$M=12$，$c_k$ 在 $[0,1]$ 内均匀分布（对于 $k=1,\\dots,M$），所有 $k$ 的 $\\sigma_k = 0.15\\,\\mathrm{m}$，$\\lambda = 1.0$。\n\n### 步骤 2：使用提取的已知信息进行验证\n\n该问题在逆问题这一成熟领域具有科学依据，特别是在等离子体物理诊断学中，带有 Tikhonov 正则化的层析重建是一种标准技术。该问题是适定的；它提供了构建唯一且有意义的解所需的所有方程、参数和定义。对于 $\\lambda>0$，矩阵 $\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L}$ 是可逆的，因为 $\\mathbf{A}$ 的元素（一个正函数的积分）是严格为正的，这确保了 $\\mathbf{A}$ 的零空间与 $\\mathbf{L}$ 的零空间（常数向量）不相交。该问题是客观的、可形式化的，并且是计算上可验证的。虽然像体素中心“均匀分布在 $[0,X]$ 上”这样的短语需要采用一种标准约定，但这并不构成关键性的歧义。标准约定是 $N$ 个体素连续地铺满区间 $[0,X]$，从而得到体素中心位于 $x_i = (i-1/2)\\Delta x$（对于 $i=1,\\dots,N$）。这种解释是合理且一致的。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。将着手开发解决方案。\n\n---\n\n### 解法推导\n\n目标是为三种不同的仪器和正则化配置计算平均空间分辨率长度 $\\overline{\\ell}$。整个过程基于所提供的第一性原理。\n\n**1. 空间离散化**\n区域 $[0,X]$ 被离散化为 $N$ 个体素。每个体素的宽度为 $\\Delta x = X/N$。为确保体素完美地覆盖该区域，我们将第 $i$ 个体素的中心（理论上使用基于 1 的索引，实现中用基于 0 的索引）定义为 $x_i = (i - 1/2)\\Delta x$，其中 $i=1, \\dots, N$。因此，第 $i$ 个体素覆盖的空间范围是 $[(i-1)\\Delta x, i\\Delta x]$。\n\n**2. 灵敏度矩阵 $\\mathbf{A}$ 的构建**\n灵敏度矩阵的元素 $A_{k,i}$ 由体素平均的灵敏度函数给出：\n$$\nA_{k,i} = \\frac{1}{\\Delta x}\\int_{(i-1)\\Delta x}^{i\\Delta x} \\exp\\!\\left(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\right)\\,dx\n$$\n高斯函数的积分与误差函数 $\\mathrm{erf}(z) = \\frac{2}{\\sqrt{\\pi}}\\int_0^z e^{-t^2} dt$ 有关。我们可以证明 $\\int e^{-ax^2}dx = \\sqrt{\\frac{\\pi}{a}}\\frac{1}{2}\\mathrm{erf}(\\sqrt{a}x)$。通过变量替换，我们特定的高斯函数的定积分为：\n$$\n\\int_{a}^{b} \\exp\\!\\left(-\\frac{(x-c_k)^2}{2\\sigma_k^2}\\right)\\,dx = \\sigma_k\\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{b-c_k}{\\sigma_k\\sqrt{2}}\\right) - \\mathrm{erf}\\left(\\frac{a-c_k}{\\sigma_k\\sqrt{2}}\\right) \\right]\n$$\n代入体素积分限 $a = (i-1)\\Delta x$ 和 $b = i\\Delta x$，我们得到 $A_{k,i}$ 的解析表达式：\n$$\nA_{k,i} = \\frac{\\sigma_k\\sqrt{\\pi/2}}{\\Delta x} \\left[ \\mathrm{erf}\\left(\\frac{i\\Delta x - c_k}{\\sigma_k\\sqrt{2}}\\right) - \\mathrm{erf}\\left(\\frac{(i-1)\\Delta x - c_k}{\\sigma_k\\sqrt{2}}\\right) \\right]\n$$\n此公式将用于填充 $M \\times N$ 矩阵 $\\mathbf{A}$。\n\n**3. 正则化算子 $\\mathbf{L}$ 的构建**\n一阶差分算子 $\\mathbf{L}$ 是一个 $(N-1) \\times N$ 的矩阵，用于计算相邻发射率值之间的差异。根据定义，其形式如下：\n$$\n\\mathbf{L} =\n\\begin{bmatrix}\n1  -1  0  \\cdots  0  0\\\\\n0  1  -1  \\cdots  0  0\\\\\n\\vdots   \\ddots  \\ddots   \\vdots\\\\\n0  0  0  \\cdots  1  -1\n\\end{bmatrix}\n$$\n该矩阵可以通过创建一个单位矩阵并减去其移位后的版本来高效地构建。\n\n**4. 分辨率矩阵 $\\mathbf{R}$ 的计算**\n分辨率矩阵 $\\mathbf{R}$ 描述了“真实”的离散化发射率分布 $\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$ 是如何通过反演过程被涂抹或模糊，从而产生重建估计值 $\\widehat{\\boldsymbol{\\varepsilon}}$ 的。Tikhonov 正则化最小二乘解的表达式为 $\\widehat{\\boldsymbol{\\varepsilon}} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1} \\mathbf{A}^\\top \\mathbf{s}$。假设没有测量噪声，则测量数据为 $\\mathbf{s} = \\mathbf{A}\\boldsymbol{\\varepsilon}_{\\mathrm{true}}$。将此代入解中，得到 $\\widehat{\\boldsymbol{\\varepsilon}} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1} \\mathbf{A}^\\top (\\mathbf{A}\\boldsymbol{\\varepsilon}_{\\mathrm{true}})$。这直接导出了分辨率矩阵的定义：\n$$\n\\mathbf{R} = (\\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L})^{-1}\\,\\mathbf{A}^\\top \\mathbf{A}\n$$\n计算涉及矩阵乘法、转置和求逆。矩阵 $\\mathbf{H} = \\mathbf{A}^\\top \\mathbf{A} + \\lambda\\,\\mathbf{L}^\\top \\mathbf{L}$ 是代价函数的海森矩阵，并且当 $\\lambda > 0$ 时是可逆的。\n\n**5. 空间分辨率长度的计算**\n每个体素 $j$ 的分辨率长度 $\\ell_j$ 量化了其重建的空间展宽。它是基于分辨率矩阵的第 $j$ 列 $\\mathbf{r}^{(j)}$ 计算的。\n首先，通过取列元素的正部并进行归一化来形成非负权重：\n$$\nw_i^{(j)} = \\frac{\\max(r^{(j)}_i, 0)}{\\sum_{\\ell=1}^{N} \\max(r^{(j)}_\\ell, 0)}\n$$\n该权重衡量了体素 $i$ 中的真实发射率对体素 $j$ 中重建发射率的贡献程度。\n接下来，使用权重 $w_i^{(j)}$，将体素 $j$ 的空间分辨率长度计算为体素位置 $x_i$ 围绕中心 $x_j$ 的均方根展宽：\n$$\n\\ell_j = \\sqrt{\\sum_{i=1}^{N} \\big(x_i - x_j\\big)^2\\, w_i^{(j)}}\n$$\n这是与体素 $j$ 相关的点扩散函数宽度的度量。\n\n**6. 平均**\n最后，整个系统的特征空间分辨率取为单个体素分辨率长度的算术平均值：\n$$\n\\overline{\\ell} = \\frac{1}{N}\\sum_{j=1}^{N} \\ell_j\n$$\n对所提供的三个测试用例中的每一个都执行这整个过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the bolometry resolution problem for a given set of test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"X\": 1.0, \"N\": 8, \"M\": 12,\n            \"c_k_def\": (\"linspace\", (0.0, 1.0)),\n            \"sigma_k\": 0.15, \"lambda_val\": 1e-3,\n        },\n        {\n            \"X\": 1.0, \"N\": 8, \"M\": 4,\n            \"c_k_def\": (\"array\", [0.2, 0.4, 0.6, 0.8]),\n            \"sigma_k\": 0.20, \"lambda_val\": 5e-2,\n        },\n        {\n            \"X\": 1.0, \"N\": 8, \"M\": 12,\n            \"c_k_def\": (\"linspace\", (0.0, 1.0)),\n            \"sigma_k\": 0.15, \"lambda_val\": 1.0,\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        X = case[\"X\"]\n        N = case[\"N\"]\n        M = case[\"M\"]\n        c_k_def = case[\"c_k_def\"]\n        sigma_k_val = case[\"sigma_k\"]\n        lambda_val = case[\"lambda_val\"]\n\n        # 1. Spatial Discretization\n        dx = X / N\n        # Voxel centers x_i at (i+0.5)*dx for i=0..N-1\n        x_coords = (np.arange(N) + 0.5) * dx\n        \n        # Channel centers c_k\n        if c_k_def[0] == \"linspace\":\n            c_k = np.linspace(c_k_def[1][0], c_k_def[1][1], M)\n        else:\n            c_k = np.array(c_k_def[1])\n            \n        sigma_k = np.full(M, sigma_k_val)\n\n        # 2. Construction of the Sensitivity Matrix A\n        A = np.zeros((M, N))\n        for k in range(M):  # Iterate over channels\n            for i in range(N):  # Iterate over voxels\n                # Voxel i spans from i*dx to (i+1)*dx\n                lower_bound = i * dx\n                upper_bound = (i + 1) * dx\n                \n                # Arguments for the error function\n                arg1 = (upper_bound - c_k[k]) / (sigma_k[k] * np.sqrt(2))\n                arg2 = (lower_bound - c_k[k]) / (sigma_k[k] * np.sqrt(2))\n                \n                integral_val = sigma_k[k] * np.sqrt(np.pi / 2.0) * (erf(arg1) - erf(arg2))\n                \n                A[k, i] = integral_val / dx\n\n        # 3. Construction of the Regularization Operator L\n        L = np.zeros((N - 1, N))\n        for j in range(N - 1):\n            L[j, j] = 1.0\n            L[j, j+1] = -1.0\n        \n        # 4. Computation of the Resolution Matrix R\n        AtA = A.T @ A\n        LtL = L.T @ L\n        \n        # Hessian of the cost function\n        H = AtA + lambda_val * LtL\n        \n        # Inverse of Hessian\n        H_inv = np.linalg.inv(H)\n        \n        R = H_inv @ AtA\n\n        # 5. Calculation of Spatial Resolution Lengths\n        ell_j_values = np.zeros(N)\n        for j in range(N):\n            # Get j-th column of R\n            r_j_col = R[:, j]\n            \n            # Form non-negative weights\n            r_j_pos = np.maximum(r_j_col, 0)\n            sum_r_j_pos = np.sum(r_j_pos)\n            \n            if sum_r_j_pos  0:\n                w_j = r_j_pos / sum_r_j_pos\n            else:\n                # This case is unlikely but would result in undefined resolution.\n                # A resolution of 0 is a safe fallback if all contributions are non-positive.\n                w_j = np.zeros(N)\n\n            # RMS spread around voxel center x_j\n            x_j = x_coords[j]\n            squared_diffs = (x_coords - x_j)**2\n            \n            ell_j = np.sqrt(np.sum(squared_diffs * w_j))\n            ell_j_values[j] = ell_j\n        \n        # 6. Averaging\n        ell_bar = np.mean(ell_j_values)\n        results.append(ell_bar)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.4f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}