{
    "hands_on_practices": [
        {
            "introduction": "The foundation of magnetic diagnostics lies in quantifying the coupling between a current source, such as the plasma, and a sensor, like a flux loop. This exercise () provides essential practice in calculating this coupling, defined by the mutual inductance $M$, from first principles. By applying the Biot-Savart law to a simplified but representative geometry, you will develop the fundamental skill needed to model and design any magnetic diagnostic system.",
            "id": "3707844",
            "problem": "A circular tokamak plasma column can be locally approximated as a thin circular current filament. Consider a thin circular plasma current filament of radius $a$ lying in the $x\\text{–}y$ plane and centered at the origin, carrying a steady toroidal current $I_{\\mathrm{p}}$. A rectangular single-turn flux loop used for magnetic diagnostics is mounted outside the vacuum vessel, centered on the symmetry axis ($z$-axis), with its plane perpendicular to the $z$-axis. The flux loop has width $w$ and height $h$, so its area is $A = w h$, and its center is located on the $z$-axis at $z = z_{0}$. Assume free space permeability and that the flux loop dimensions are sufficiently small compared to the axial variation length scale of the magnetic field so that the axial field is approximately uniform over the loop area.\n\nUsing the Biot–Savart law and the definition of mutual inductance $M$ as the flux linkage per unit current, derive the expression for $M$ between the circular plasma current filament and the rectangular flux loop under the stated assumptions, and then evaluate it numerically for\n$a = 0.60\\,\\mathrm{m}$, $z_{0} = 1.50\\,\\mathrm{m}$, $w = 0.25\\,\\mathrm{m}$, $h = 0.10\\,\\mathrm{m}$, and $\\mu_{0} = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$.\nExpress your final answer for the mutual inductance in microhenries ($\\mu\\mathrm{H}$) and round to four significant figures. Use the International System of Units (SI).",
            "solution": "The magnetic field produced by a steady current distribution can be obtained from the Biot–Savart law,\n$$\n\\mathbf{B}(\\mathbf{r}) = \\frac{\\mu_{0}}{4\\pi}\\,I_{\\mathrm{p}} \\oint \\frac{d\\boldsymbol{\\ell}' \\times \\hat{\\mathbf{R}}}{R^{2}} \\,,\n$$\nwhere $\\mathbf{R} = \\mathbf{r} - \\mathbf{r}'$ is the displacement from a source point $\\mathbf{r}'$ on the filament to the field point $\\mathbf{r}$, $R = |\\mathbf{R}|$, and $\\hat{\\mathbf{R}} = \\mathbf{R}/R$. For a circular filament of radius $a$ lying in the $x\\text{–}y$ plane, we parametrize the source point as\n$$\n\\mathbf{r}'(\\phi) = a\\cos\\phi\\,\\hat{\\mathbf{x}} + a\\sin\\phi\\,\\hat{\\mathbf{y}} \\,,\n$$\nwith line element\n$$\nd\\boldsymbol{\\ell}' = \\frac{d\\mathbf{r}'}{d\\phi}\\,d\\phi = \\left(-a\\sin\\phi\\,\\hat{\\mathbf{x}} + a\\cos\\phi\\,\\hat{\\mathbf{y}}\\right)d\\phi \\,.\n$$\nWe seek the magnetic field along the axis ($\\mathbf{r} = z\\,\\hat{\\mathbf{z}}$). Along the axis by symmetry the magnetic field points in the $\\hat{\\mathbf{z}}$ direction, and the standard evaluation (performing the integral over $\\phi$) yields the axial component\n$$\nB_{z}(z) = \\frac{\\mu_{0} I_{\\mathrm{p}} a^{2}}{2\\left(a^{2} + z^{2}\\right)^{3/2}} \\,.\n$$\nThis result can be derived directly from the Biot–Savart integral using the above parametrization and noting that all transverse components cancel by symmetry.\n\nThe magnetic flux through the rectangular loop of area $A = w h$ whose normal is $\\hat{\\mathbf{z}}$ is\n$$\n\\Phi = \\iint_{\\text{loop}} \\mathbf{B}\\cdot d\\mathbf{A} = \\iint_{\\text{loop}} B_{z}(z)\\,dA \\,.\n$$\nUnder the stated assumption that the loop is small enough for $B_{z}$ to be approximately uniform over its area, with the loop centered at $z=z_{0}$ on the axis, we take $B_{z}$ at the center and obtain\n$$\n\\Phi \\approx B_{z}(z_{0})\\,A = \\frac{\\mu_{0} I_{\\mathrm{p}} a^{2}}{2\\left(a^{2} + z_{0}^{2}\\right)^{3/2}}\\,A \\,.\n$$\nThe mutual inductance $M$ between the filament and the loop is defined as the flux linkage per unit current,\n$$\nM \\equiv \\frac{\\Phi}{I_{\\mathrm{p}}} = \\frac{\\mu_{0} a^{2} A}{2\\left(a^{2} + z_{0}^{2}\\right)^{3/2}} \\,.\n$$\n\nWe now evaluate $M$ numerically for the given parameters. First compute the geometric factor in the denominator:\n$$\na^{2} + z_{0}^{2} = (0.60)^{2} + (1.50)^{2} = 0.36 + 2.25 = 2.61 \\,,\n$$\nso\n$$\n\\left(a^{2} + z_{0}^{2}\\right)^{3/2} = \\left(2.61\\right)^{3/2} = 2.61\\,\\sqrt{2.61} \\approx 2.61 \\times 1.615549 \\approx 4.216583 \\,.\n$$\nThe loop area is\n$$\nA = w h = 0.25 \\times 0.10 = 0.025 \\,.\n$$\nInsert all values into the mutual inductance formula:\n$$\nM = \\frac{\\left(4\\pi \\times 10^{-7}\\right)\\times (0.60)^{2} \\times 0.025}{2 \\times 4.216583} = \\frac{\\left(4\\pi \\times 10^{-7}\\right)\\times 0.36 \\times 0.025}{2 \\times 4.216583} \\,.\n$$\nCompute the numerator factor:\n$$\n\\left(4\\pi \\times 10^{-7}\\right)\\times 0.36 \\times 0.025 = \\left(4\\pi \\times 10^{-7}\\right)\\times 0.009 = 3.6\\pi \\times 10^{-9} \\,,\n$$\nand the factor of $2$ in the denominator gives\n$$\n\\frac{3.6\\pi \\times 10^{-9}}{2} = 1.8\\pi \\times 10^{-9} \\,.\n$$\nTherefore,\n$$\nM = \\frac{1.8\\pi \\times 10^{-9}}{4.216583} \\,\\mathrm{H} \\approx 1.3411 \\times 10^{-9} \\,\\mathrm{H} \\,.\n$$\nConvert to microhenries using $1\\,\\mu\\mathrm{H} = 10^{-6}\\,\\mathrm{H}$:\n$$\nM \\approx 1.3411 \\times 10^{-9}\\,\\mathrm{H} = 1.3411 \\times 10^{-3}\\,\\mu\\mathrm{H} \\,.\n$$\nRounded to four significant figures,\n$$\nM \\approx 1.341 \\times 10^{-3}\\,\\mu\\mathrm{H} \\,.\n$$\n\nRegarding the uniform-field assumption over the loop area: because the field is evaluated on the symmetry axis, the leading-order radial variation of $B_{z}$ vanishes by symmetry, and the first nonzero correction is quadratic in the off-axis displacement with a characteristic scale of order $\\left(a^{2} + z_{0}^{2}\\right)$. With the loop’s half-diagonal $\\approx \\frac{1}{2}\\sqrt{w^{2} + h^{2}} \\approx \\frac{1}{2}\\sqrt{0.25^{2} + 0.10^{2}} \\approx 0.141$, this is small compared to $\\sqrt{a^{2} + z_{0}^{2}} \\approx 1.616$, making the fractional nonuniformity across the loop negligible for the present calculation at the stated level of precision.",
            "answer": "$$\\boxed{1.341 \\times 10^{-3}}$$"
        },
        {
            "introduction": "An ideal measurement would perfectly recover the magnetic flux from the induced voltage, but real electronic components introduce errors. This practice () focuses on a critical non-ideality in op-amp integrators: the input bias current $I_b$. You will analyze how this small, steady current leads to a cumulative error, or \"baseline drift,\" in the measured flux, a crucial consideration for long-duration fusion experiments where high-fidelity equilibrium reconstruction is paramount.",
            "id": "3707854",
            "problem": "A toroidal confinement device employs both poloidal flux loops and magnetic pickup (Mirnov) coils to reconstruct evolving magnetic fields during long-duration discharges. A flux loop with $N$ turns encircles a region of time-varying poloidal magnetic flux $\\Phi(t)$ and produces an induced voltage according to Faraday's law. The loop signal is processed by an operational-amplifier integrator whose input is through a resistor of resistance $R$ and whose feedback element is a capacitor of capacitance $C$. The integrator is designed so that its output directly estimates the poloidal magnetic flux $\\Phi(t)$ over the duration of the pulse. Real operational amplifiers have a nonzero input bias current $I_b$ at the summing node, which, when flowing through the input resistor, produces a direct-current offset voltage at the integrator input. Over long times, this offset leads to a baseline drift in the inferred flux.\n\nStarting from Faraday's law and the ideal operational-amplifier integrator equation, derive the relationship between the integrator output and $\\Phi(t)$ under the calibration that the output equals the flux. Then, model the effect of the input bias current $I_b$ at the summing node as an equivalent input offset and determine the resulting time-dependent error in the inferred flux. For a flux loop with $N=20$ turns, an integrator input resistor $R=100~\\text{k}\\Omega$, and an amplifier input bias current $I_b=20~\\text{nA}$, compute the magnitude of the flux error after a discharge duration of $T=300~\\text{s}$. Express the final flux error in webers and round your answer to three significant figures. Assume the integrator is otherwise ideal, the summing node potential is approximately zero, and neglect any parallel leakage paths or additional compensation networks.",
            "solution": "The problem requires the derivation of an expression for the flux error in an integrated magnetic diagnostic signal due to op-amp input bias current, and a subsequent calculation of this error for a long-duration discharge. The solution proceeds in three stages: first, an analysis of the ideal integrator circuit; second, the introduction of the error source; and third, the calculation of the resulting error.\n\nFirst, we analyze the ideal system. A flux loop with $N$ turns is subject to a time-varying poloidal magnetic flux $\\Phi(t)$. According to Faraday's law of induction, the voltage $V_{in}(t)$ induced in the loop is given by:\n$$V_{in}(t) = -N \\frac{d\\Phi(t)}{dt}$$\nThis voltage serves as the input to an operational-amplifier integrator. In an ideal inverting integrator circuit with input resistor $R$ and feedback capacitor $C$, the relationship between the input voltage $V_{in}(t)$ and the output voltage $V_{out}(t)$ is:\n$$V_{out}(t) = -\\frac{1}{RC} \\int_{0}^{t} V_{in}(t') dt'$$\nwhere we assume the integrator output is zero at time $t=0$. Substituting the expression for $V_{in}(t)$ from Faraday's law into the integrator equation yields:\n$$V_{out}(t) = -\\frac{1}{RC} \\int_{0}^{t} \\left(-N \\frac{d\\Phi(t')}{dt'}\\right) dt' = \\frac{N}{RC} \\int_{0}^{t} \\frac{d\\Phi(t')}{dt'} dt'$$\nAssuming the magnetic flux is zero at $t=0$, i.e., $\\Phi(0)=0$, the integral evaluates to:\n$$V_{out}(t) = \\frac{N}{RC} \\left[ \\Phi(t') \\right]_0^t = \\frac{N}{RC} \\Phi(t)$$\nThe problem states that the integrator is calibrated such that its output directly estimates the flux. We interpret this to mean that the numerical value of the output voltage in volts is equal to the numerical value of the flux in webers, which implies a scaling factor of $1$.\n$$V_{out}(t) = \\Phi(t)$$\nFor this condition to hold, the pre-factor must be unity:\n$$\\frac{N}{RC} = 1 \\implies RC = N$$\nThis calibration equation relates the integrator's time constant $RC$ to the number of turns $N$ in the flux loop.\n\nNext, we model the effect of the input bias current $I_b$. This current flows into the inverting input terminal of the operational amplifier. The summing node (the inverting input) is a virtual ground, so its potential is approximately zero. We can write Kirchhoff's Current Law for the summing node. The current from the input source through resistor $R$ is $I_R = V_{in}(t)/R$. The current through the feedback capacitor is $I_C = C \\frac{d(0 - V_{out})}{dt} = -C \\frac{dV_{out}}{dt}$. The bias current $I_b$ flows into the op-amp, hence out of the node. The sum of currents entering the node is zero:\n$$I_R - I_C - I_b = 0$$\n$$\\frac{V_{in}(t)}{R} - \\left(-C \\frac{dV_{out}(t)}{dt}\\right) - I_b = 0$$\n$$\\frac{V_{in}(t)}{R} + C \\frac{dV_{out}(t)}{dt} - I_b = 0$$\nRearranging for the rate of change of the output voltage gives:\n$$ \\frac{dV_{out}(t)}{dt} = -\\frac{1}{RC}V_{in}(t) + \\frac{I_b}{C}$$\nIntegrating with respect to time from $0$ to $t$ yields the total output voltage, $V_{out,total}(t)$:\n$$V_{out,total}(t) = \\int_0^t \\left(-\\frac{1}{RC}V_{in}(t') + \\frac{I_b}{C}\\right) dt' = \\left(-\\frac{1}{RC}\\int_0^t V_{in}(t') dt'\\right) + \\left(\\frac{I_b}{C}\\int_0^t dt'\\right)$$\nThe first term is the ideal output, which under our calibration is equal to the true flux $\\Phi(t)$. The second term is the error in the output voltage, which we identify as the error in the inferred flux, $\\Phi_{error}(t)$.\n$$\\Phi_{error}(t) = \\frac{I_b}{C} t$$\nThis shows that the input bias current causes a linear drift in the integrated signal over time.\n\nFinally, we compute the magnitude of this flux error. To eliminate the capacitance $C$ from the error expression, we use the calibration condition $RC = N$, which implies $C = N/R$. Substituting this into the error equation:\n$$\\Phi_{error}(t) = \\frac{I_b}{N/R} t = \\frac{I_b R}{N} t$$\nWe are asked to compute the magnitude of this error after a discharge duration of $T = 300~\\text{s}$. The given values are:\nNumber of turns, $N = 20$.\nInput resistance, $R = 100~\\text{k}\\Omega = 100 \\times 10^3~\\Omega = 10^5~\\Omega$.\nInput bias current, $I_b = 20~\\text{nA} = 20 \\times 10^{-9}~\\text{A}$.\nDischarge duration, $T = 300~\\text{s}$.\n\nThe magnitude of the flux error, $|\\Phi_{error}(T)|$, is:\n$$|\\Phi_{error}(T)| = \\left| \\frac{I_b R}{N} T \\right| = \\frac{(20 \\times 10^{-9}~\\text{A})(10^5~\\Omega)}{20} (300~\\text{s})$$\n$$|\\Phi_{error}(T)| = \\frac{20 \\times 10^{-4}~\\text{V}}{20} (300~\\text{s})$$\n$$|\\Phi_{error}(T)| = (1 \\times 10^{-4}~\\text{V}) (300~\\text{s})$$\n$$|\\Phi_{error}(T)| = 300 \\times 10^{-4}~\\text{V} \\cdot \\text{s} = 0.03~\\text{V} \\cdot \\text{s}$$\nSince $1$ Weber ($Wb$) is equal to $1$ Volt-second ($V \\cdot s$), the error is $0.03~\\text{Wb}$.\nThe problem requires the answer to be rounded to three significant figures.\n$$|\\Phi_{error}(T)| = 0.0300~\\text{Wb} = 3.00 \\times 10^{-2}~\\text{Wb}$$",
            "answer": "$$\\boxed{3.00 \\times 10^{-2}}$$"
        },
        {
            "introduction": "Before a measured signal can be analyzed, it must be faithfully converted from an analog voltage to a digital dataset. This critical step requires careful filtering to prevent high-frequency noise from corrupting the signal of interest through a process called aliasing. This problem () guides you through the practical design of an anti-aliasing filter, connecting the physics of plasma fluctuations to the engineering principles of digital signal processing and ensuring the integrity of the final data.",
            "id": "3707806",
            "problem": "A toroidal array of Mirnov coils and a poloidal flux loop on a medium-sized tokamak are used to monitor magnetic fluctuations and slow equilibrium evolution. Each Mirnov coil produces a voltage proportional to the time derivative of the magnetic field by Faraday’s law, and a low-noise analog integrator is used to reconstruct the magnetic field prior to digitization. To prevent high-frequency noise and out-of-band magnet power supply harmonics from aliasing into the sampled bandwidth, the signals are passed through an analog anti-aliasing low-pass filter before the analog-to-digital converter (ADC).\n\nAssume the following design constraints and choices:\n- The useful magnetohydrodynamic (MHD) fluctuation content is negligible above $f_{\\text{use}} = 20\\,\\text{kHz}$.\n- The sampling rate is $f_{s} = 400\\,\\text{kHz}$.\n- To preserve the passband while providing margin to the MHD spectral edge, the anti-aliasing filter cutoff is chosen as $f_{c} = 2 f_{\\text{use}}$ and the filter is selected to be a $n=5$ order maximally flat (Butterworth) analog low-pass with its cutoff defined at the $-3\\,\\text{dB}$ point.\n- The data acquisition (DAQ) chain requires attenuation of out-of-band components at least at the Nyquist frequency $f_{s}/2$ to limit aliasing.\n\nStarting only from fundamental principles of sampling (Nyquist-Shannon sampling theorem), linear time-invariant filter theory, and standard properties of maximally flat (Butterworth) low-pass filters, derive an expression for the magnitude attenuation at the Nyquist frequency and evaluate it numerically for the specified design. Compute the attenuation at $f_{s}/2$ relative to the passband in decibels, i.e., compute $A = 20 \\log_{10} |H(j 2\\pi f_{s}/2)|$ for the chosen $f_{c}$ and $n$.\n\nExpress your final answer in decibels (dB) and round to four significant figures.",
            "solution": "The fundamental principle governing the behavior of an $n$-th order maximally flat (Butterworth) low-pass filter is its magnitude-squared frequency response, given by:\n$$|H(j\\omega)|^2 = \\frac{1}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^{2n}}$$\nwhere $\\omega$ is the angular frequency, $\\omega_c$ is the cutoff angular frequency (at which the power is attenuated by a factor of $1/2$, or $-3\\,\\text{dB}$), and $n$ is the order of the filter.\n\nThe attenuation in decibels, $A$, as a function of frequency is defined as:\n$$A(\\omega) = 20 \\log_{10}(|H(j\\omega)|)$$\nThis can be expressed in terms of the magnitude-squared response:\n$$A(\\omega) = 10 \\log_{10}(|H(j\\omega)|^2)$$\nSubstituting the Butterworth response into this expression yields:\n$$A(\\omega) = 10 \\log_{10}\\left(\\frac{1}{1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^{2n}}\\right) = -10 \\log_{10}\\left(1 + \\left(\\frac{\\omega}{\\omega_c}\\right)^{2n}\\right)$$\nThe frequencies are given in Hertz ($f$), so we use the relationship $\\omega = 2\\pi f$. The expression for attenuation in terms of frequency $f$ is:\n$$A(f) = -10 \\log_{10}\\left(1 + \\left(\\frac{f}{f_c}\\right)^{2n}\\right)$$\nThe problem requires us to evaluate this attenuation at the Nyquist frequency, which is half the sampling rate, $f_s$. The frequency of interest is thus $f = \\frac{f_s}{2}$.\n\nWe now substitute the given parameters to find the numerical value.\nThe given values are:\n-   Order of the filter, $n = 5$.\n-   Sampling frequency, $f_s = 400\\,\\text{kHz} = 4 \\times 10^5\\,\\text{Hz}$.\n-   Useful signal frequency upper limit, $f_{\\text{use}} = 20\\,\\text{kHz} = 2 \\times 10^4\\,\\text{Hz}$.\n\nFirst, we calculate the filter's cutoff frequency, $f_c$:\n$$f_c = 2 f_{\\text{use}} = 2 \\times (2 \\times 10^4\\,\\text{Hz}) = 4 \\times 10^4\\,\\text{Hz}$$\nNext, we calculate the Nyquist frequency, at which the attenuation is to be determined:\n$$f_{Nyquist} = \\frac{f_s}{2} = \\frac{4 \\times 10^5\\,\\text{Hz}}{2} = 2 \\times 10^5\\,\\text{Hz}$$\nNow, we can compute the ratio of the Nyquist frequency to the cutoff frequency:\n$$\\frac{f_{Nyquist}}{f_c} = \\frac{2 \\times 10^5\\,\\text{Hz}}{4 \\times 10^4\\,\\text{Hz}} = 5$$\nWe substitute this ratio and the filter order $n=5$ into the attenuation formula:\n$$A = -10 \\log_{10}\\left(1 + (5)^{2 \\times 5}\\right)$$\n$$A = -10 \\log_{10}\\left(1 + 5^{10}\\right)$$\nWe evaluate the term $5^{10}$:\n$$5^{10} = 9,765,625$$\nSubstituting this value back into the expression for $A$:\n$$A = -10 \\log_{10}(1 + 9,765,625) = -10 \\log_{10}(9,765,626)$$\nUsing a calculator for the base-10 logarithm:\n$$\\log_{10}(9,765,626) \\approx 6.98970004$$\nTherefore, the attenuation is:\n$$A \\approx -10 \\times 6.98970004 \\approx -69.8970004\\,\\text{dB}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$A \\approx -69.90\\,\\text{dB}$$\nThis shows that at the Nyquist frequency, the filter provides approximately $70\\,\\text{dB}$ of attenuation, which is a substantial reduction of signal amplitude, effectively preventing aliasing from components at this frequency.",
            "answer": "$$\\boxed{-69.90}$$"
        }
    ]
}