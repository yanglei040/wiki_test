{
    "hands_on_practices": [
        {
            "introduction": "Understanding how a plasma responds to magnetic fields is the first step in designing any control system. This exercise explores the fundamental dynamics of plasma position control, focusing on the interplay between active Poloidal Field (PF) coils and the passive eddy currents they induce in the tokamak's conducting vessel. By solving for the plasma's movement following a sudden change in coil current, you will gain insight into how the vessel \"shields\" the plasma from fast changes, a critical concept that dictates the design of feedback controllers. ",
            "id": "3716535",
            "problem": "Consider an axisymmetric tokamak plasma modeled as a rigid column with centroid displacement $x(t)$ in the horizontal direction. The centroid responds quasi-statically to the externally applied radial magnetic field at the plasma boundary. Assume that, for time scales slow compared to the Alfvén time and fast compared to mechanical inertia, the linearized relation $x(t) = \\chi B_{\\text{ext}}(t)$ holds, where $\\chi$ is a constant susceptibility with units of meters per tesla. The external field $B_{\\text{ext}}(t)$ is a superposition of contributions from a Poloidal Field (PF) coil and eddy currents in the conducting vacuum vessel. Let $B_{\\text{ext}}(t) = k_c i_c(t) + k_v i_v(t)$, where $i_c(t)$ is the PF coil current, $i_v(t)$ is the vessel current, and $k_c$ and $k_v$ are geometry-dependent coefficients with units of tesla per ampere.\n\nModel the vessel as a single-turn equivalent conducting loop with inductance $L_v$ and resistance $R_v$, with eddy current time constant $\\tau_v = L_v / R_v$. The PF coil couples magnetically to the vessel with mutual inductance $M_{cv}$. Starting from Faraday’s law and the definition of flux linkage for coupled circuits, derive the vessel current evolution. The PF coil current is commanded by the real-time control system to undergo a step change of magnitude $\\Delta i$ at $t = 0$, so that $i_c(t) = i_0 + \\Delta i\\, u(t)$, where $i_0$ is a constant pre-step value and $u(t)$ is the unit step function. Assume $i_v(0^{-}) = 0$ and the plasma current is constant so that its contribution to vessel flux does not change during the step.\n\nUsing only fundamental laws and the above definitions, solve the coupled coil–vessel dynamics and compute the resulting linearized plasma centroid response $x(t)$. From this, determine the incremental displacement immediately after the step and at steady state, namely $\\Delta x_{0^{+}} = x(0^{+}) - x(0^{-})$ and $\\Delta x_{\\infty} = x(\\infty) - x(0^{-})$, expressed in terms of $\\chi$, $k_c$, $k_v$, $M_{cv}$, $L_v$, and $\\Delta i$.\n\nProvide your final expressions for $\\Delta x_{0^{+}}$ and $\\Delta x_{\\infty}$ in meters. No numerical rounding is required; give closed-form expressions.",
            "solution": "### Step 1: Extract Givens\n-   Plasma centroid displacement: $x(t)$\n-   Linearized plasma response model: $x(t) = \\chi B_{\\text{ext}}(t)$, where $\\chi$ is a constant susceptibility.\n-   External magnetic field: $B_{\\text{ext}}(t) = k_c i_c(t) + k_v i_v(t)$, where $k_c$ and $k_v$ are coefficients.\n-   PF coil current: $i_c(t) = i_0 + \\Delta i\\, u(t)$, where $i_0$ is a constant, $\\Delta i$ is the step magnitude, and $u(t)$ is the unit step function.\n-   Vessel current: $i_v(t)$.\n-   Vessel circuit parameters: inductance $L_v$, resistance $R_v$.\n-   Vessel eddy current time constant: $\\tau_v = L_v / R_v$.\n-   Coil-vessel mutual inductance: $M_{cv}$.\n-   Initial condition for vessel current: $i_v(0^{-}) = 0$.\n-   Constraint: The plasma current is constant, so its contribution to the flux change in the vessel is zero.\n-   Quantities to find: $\\Delta x_{0^{+}} = x(0^{+}) - x(0^{-})$ and $\\Delta x_{\\infty} = x(\\infty) - x(0^{-})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a well-defined exercise in magnetohydrodynamics and circuit theory as applied to tokamak plasma control.\n-   **Scientifically Grounded:** The model is a standard, simplified representation of plasma radial position response to external magnetic fields in a tokamak. It uses fundamental principles like Faraday's law of induction and linear circuit theory. The concept of eddy currents in a conducting vacuum vessel and their effect on plasma control is a real and critical aspect of tokamak operation. The model is scientifically sound.\n-   **Well-Posed:** The problem provides a first-order linear ordinary differential equation with a specified forcing function and a clear initial condition. This structure guarantees a unique and stable solution for the vessel current and, consequently, for the plasma position.\n-   **Objective:** The problem is stated using precise, standard terminology from physics and engineering. There are no subjective or ambiguous statements.\n-   **Completeness and Consistency:** All necessary parameters ($\\chi, k_c, k_v, L_v, M_{cv}, \\Delta i, i_0$) and initial conditions ($i_v(0^{-})=0$) are provided to derive a unique solution. The givens are internally consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a scientifically grounded, well-posed, and objective problem based on fundamental physical laws. I will proceed with the solution.\n\nThe evolution of the vessel current $i_v(t)$ is governed by Faraday's law of induction applied to the vessel loop. The induced electromotive force (EMF), which drives the current through the vessel's resistance $R_v$, is equal to the negative time derivative of the total magnetic flux $\\Phi_v$ passing through the loop.\n$$\ni_v(t) R_v = -\\frac{d\\Phi_v}{dt}\n$$\nThe total magnetic flux $\\Phi_v$ is linked from three sources: the vessel current $i_v(t)$ itself (self-inductance $L_v$), the PF coil current $i_c(t)$ (mutual inductance $M_{cv}$), and the plasma current $i_p(t)$. The flux linkage is given by:\n$$\n\\Phi_v(t) = L_v i_v(t) + M_{cv} i_c(t) + \\Phi_{pv}(t)\n$$\nwhere $\\Phi_{pv}(t)$ is the flux from the plasma current. The problem states that the plasma current is constant, so its contribution to the *change* in flux is zero, i.e., $\\frac{d\\Phi_{pv}}{dt} = 0$.\nSubstituting the expression for $\\Phi_v(t)$ into Faraday's law yields:\n$$\ni_v(t) R_v = -\\frac{d}{dt} \\left( L_v i_v(t) + M_{cv} i_c(t) \\right)\n$$\n$$\nR_v i_v(t) = -L_v \\frac{di_v}{dt} - M_{cv} \\frac{di_c}{dt}\n$$\nRearranging this gives the first-order linear ordinary differential equation for the vessel current:\n$$\nL_v \\frac{di_v}{dt} + R_v i_v(t) = -M_{cv} \\frac{di_c}{dt}\n$$\nDividing by $R_v$ and using the definition of the vessel time constant $\\tau_v = L_v / R_v$, we get:\n$$\n\\tau_v \\frac{di_v}{dt} + i_v(t) = -\\frac{M_{cv}}{R_v} \\frac{di_c}{dt}\n$$\nWe can also express the coefficient on the right-hand side using $\\tau_v$ and $L_v$: $\\frac{M_{cv}}{R_v} = \\frac{M_{cv}}{L_v/\\tau_v} = \\frac{M_{cv} \\tau_v}{L_v}$.\n$$\n\\tau_v \\frac{di_v}{dt} + i_v(t) = -\\frac{M_{cv} \\tau_v}{L_v} \\frac{di_c}{dt}\n$$\nThe PF coil current is a step function: $i_c(t) = i_0 + \\Delta i\\, u(t)$. Its time derivative is proportional to the Dirac delta function, $\\delta(t)$:\n$$\n\\frac{di_c}{dt} = \\Delta i\\, \\delta(t)\n$$\nSubstituting this into the vessel current equation gives:\n$$\n\\tau_v \\frac{di_v}{dt} + i_v(t) = -\\frac{M_{cv} \\tau_v}{L_v} \\Delta i\\, \\delta(t)\n$$\nTo find the initial value $i_v(0^{+})$ just after the step, we integrate this equation from $t=0^{-}$ to $t=0^{+}$:\n$$\n\\int_{0^{-}}^{0^{+}} \\left( \\tau_v \\frac{di_v}{dt} + i_v(t) \\right) dt = \\int_{0^{-}}^{0^{+}} \\left( -\\frac{M_{cv} \\tau_v}{L_v} \\Delta i\\, \\delta(t) \\right) dt\n$$\n$$\n\\tau_v [i_v(0^{+}) - i_v(0^{-})] + \\int_{0^{-}}^{0^{+}} i_v(t) dt = -\\frac{M_{cv} \\tau_v}{L_v} \\Delta i \\int_{0^{-}}^{0^{+}} \\delta(t) dt\n$$\nGiven $i_v(0^{-}) = 0$, and assuming $i_v(t)$ is at most a step-discontinuous function, its integral over an infinitesimally small interval is $0$. The integral of the delta function is $1$.\n$$\n\\tau_v [i_v(0^{+}) - 0] + 0 = -\\frac{M_{cv} \\tau_v}{L_v} \\Delta i\n$$\nThis gives the initial condition for $t0$:\n$$\ni_v(0^{+}) = -\\frac{M_{cv}}{L_v} \\Delta i\n$$\nFor $t0$, the delta function is zero, and the differential equation becomes homogeneous:\n$$\n\\tau_v \\frac{di_v}{dt} + i_v(t) = 0\n$$\nThe solution to this equation is an exponential decay:\n$$\ni_v(t) = A \\exp(-t/\\tau_v)\n$$\nUsing the initial condition $i_v(0^{+}) = A$, we find $A = -\\frac{M_{cv}}{L_v} \\Delta i$.\nThus, the vessel current for $t \\ge 0$ is:\n$$\ni_v(t) = -\\frac{M_{cv}}{L_v} \\Delta i \\exp(-t/\\tau_v) \\quad \\text{for } t  0, \\text{ and } i_v(0^+) = -\\frac{M_{cv}}{L_v}\\Delta i\n$$\nNow we can compute the plasma position $x(t)$. First, we find the behavior of $B_{\\text{ext}}(t) = k_c i_c(t) + k_v i_v(t)$.\n\nAt $t=0^{-}$ (pre-step steady state):\n$i_c(0^{-}) = i_0$\n$i_v(0^{-}) = 0$\n$B_{\\text{ext}}(0^{-}) = k_c i_0 + k_v (0) = k_c i_0$\n$x(0^{-}) = \\chi B_{\\text{ext}}(0^{-}) = \\chi k_c i_0$\n\nAt $t=0^{+}$ (immediately after the step):\n$i_c(0^{+}) = i_0 + \\Delta i$\n$i_v(0^{+}) = -\\frac{M_{cv}}{L_v} \\Delta i$\n$B_{\\text{ext}}(0^{+}) = k_c (i_0 + \\Delta i) + k_v \\left(-\\frac{M_{cv}}{L_v} \\Delta i\\right) = k_c i_0 + \\Delta i \\left(k_c - \\frac{k_v M_{cv}}{L_v}\\right)$\n$x(0^{+}) = \\chi B_{\\text{ext}}(0^{+}) = \\chi k_c i_0 + \\chi \\Delta i \\left(k_c - \\frac{k_v M_{cv}}{L_v}\\right)$\n\nThe incremental displacement immediately after the step is $\\Delta x_{0^{+}} = x(0^{+}) - x(0^{-})$:\n$$\n\\Delta x_{0^{+}} = \\left[ \\chi k_c i_0 + \\chi \\Delta i \\left(k_c - \\frac{k_v M_{cv}}{L_v}\\right) \\right] - \\left[ \\chi k_c i_0 \\right]\n$$\n$$\n\\Delta x_{0^{+}} = \\chi \\Delta i \\left(k_c - \\frac{k_v M_{cv}}{L_v}\\right)\n$$\n\nAt $t=\\infty$ (new steady state):\nThe vessel eddy current decays to zero: $i_v(\\infty) = \\lim_{t \\to \\infty} \\left(-\\frac{M_{cv}}{L_v} \\Delta i \\exp(-t/\\tau_v)\\right) = 0$.\nThe coil current remains at its new value: $i_c(\\infty) = i_0 + \\Delta i$.\n$B_{\\text{ext}}(\\infty) = k_c (i_0 + \\Delta i) + k_v (0) = k_c(i_0 + \\Delta i)$\n$x(\\infty) = \\chi B_{\\text{ext}}(\\infty) = \\chi k_c(i_0 + \\Delta i)$\n\nThe incremental displacement at steady state is $\\Delta x_{\\infty} = x(\\infty) - x(0^{-})$:\n$$\n\\Delta x_{\\infty} = \\left[ \\chi k_c(i_0 + \\Delta i) \\right] - \\left[ \\chi k_c i_0 \\right]\n$$\n$$\n\\Delta x_{\\infty} = \\chi k_c i_0 + \\chi k_c \\Delta i - \\chi k_c i_0\n$$\n$$\n\\Delta x_{\\infty} = \\chi k_c \\Delta i\n$$\nThe required expressions are therefore derived.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\chi \\Delta i \\left(k_c - \\frac{k_v M_{cv}}{L_v}\\right)  \\chi k_c \\Delta i \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A real-time controller is only as good as the measurements it receives. This practice delves into the crucial concept of observability: can we uniquely determine the plasma's state from our available sensors? By applying principles of linear systems theory to a model of plasma shape and position, you will analyze whether a given set of magnetic diagnostics can distinguish between different modes of plasma behavior, a foundational step in designing a reliable state estimator. ",
            "id": "3716533",
            "problem": "Consider a large-aspect-ratio, axisymmetric tokamak plasma with a conducting wall instrumented for real-time plasma control by two segmented flux loops and four magnetic probes. The plasma boundary perturbation is represented, to leading order in small amplitude, by a vertical displacement mode and an $m=2$ shaping mode. In cylindrical poloidal angle coordinates, the boundary displacement is parameterized by the modal amplitudes $z$ (vertical), $a_{2}$ (even $m=2$ cosine-lobe mode), and $b_{2}$ (odd $m=2$ sine-lobe mode). Angles are measured in radians.\n\nOn the time scale of interest, assume linear, time-invariant dynamics for the state vector $x = \\begin{pmatrix} z  \\dot{z}  a_{2}  b_{2} \\end{pmatrix}^{\\top}$ governed by\n$$\n\\dot{x} = A x,\n$$\nwith\n$$\nA = \\begin{pmatrix}\n0  1  0  0 \\\\\n-\\omega_{z}^{2}  0  0  0 \\\\\n0  0  -\\gamma_{a}  0 \\\\\n0  0  0  -\\gamma_{b}\n\\end{pmatrix},\n$$\nwhere $\\omega_{z}  0$ is the natural frequency of the vertical motion, and $\\gamma_{a}  0$, $\\gamma_{b}  0$ are damping rates for the $m=2$ modes. The external actuator inputs are held constant during the measurement interval and are not explicitly modeled.\n\nThe segmented flux loops measure perturbations of the poloidal magnetic flux linked near their poloidal locations $\\theta_{f1} = \\pi/4$ and $\\theta_{f2} = 3\\pi/4$. For small boundary perturbations, the local poloidal flux perturbation admits a Fourier expansion whose leading contributions from the considered modes scale as\n$$\n\\delta\\psi(\\theta) \\approx k_{z}\\, z \\sin(\\theta) + k_{a}\\, a_{2} \\cos(2\\theta) + k_{b}\\, b_{2} \\sin(2\\theta),\n$$\nwith geometry-dependent constants $k_{z} = \\frac{4}{5}$, $k_{a} = \\frac{3}{5}$, $k_{b} = \\frac{1}{2}$. The flux-loop outputs are $y_{f1} = \\delta\\psi(\\theta_{f1})$ and $y_{f2} = \\delta\\psi(\\theta_{f2})$.\n\nThe magnetic probes measure the radial magnetic field at the wall, which to leading order is proportional to the poloidal derivative of the poloidal flux. Thus, each probe at poloidal angle $\\theta$ measures\n$$\ny_{p}(\\theta) \\propto \\frac{\\partial}{\\partial\\theta} \\delta\\psi(\\theta) = k_{z}\\, z \\cos(\\theta) - 2 k_{a}\\, a_{2} \\sin(2\\theta) + 2 k_{b}\\, b_{2} \\cos(2\\theta).\n$$\nAssume unit proportionality and probe locations $\\theta_{p1} = 0$, $\\theta_{p2} = \\frac{\\pi}{2}$, $\\theta_{p3} = \\pi$, $\\theta_{p4} = \\frac{3\\pi}{2}$. The measurement vector is\n$$\ny = \\begin{pmatrix}\ny_{f1} \\\\\ny_{f2} \\\\\ny_{p1} \\\\\ny_{p2} \\\\\ny_{p3} \\\\\ny_{p4}\n\\end{pmatrix} = C x,\n$$\nfor an appropriate matrix $C$ that follows from these relations.\n\nStarting from these definitions and the fundamental linear time-invariant state-space framework for observability, construct the measurement matrix $C$ implied by the described sensor geometry, form the associated observability matrix for the autonomous system, and compute its rank. Based on the rank and the structure of the observability matrix, identify any unobservable linear combinations of the boundary modes and report one unit-norm vector of state coefficients $\\begin{pmatrix} c_{z}  c_{\\dot{z}}  c_{a_{2}}  c_{b_{2}} \\end{pmatrix}^{\\top}$ spanning the unobservable subspace (if it exists). Express your final answer as a single row matrix containing, in order, the rank (unitless) and the four components of the unit-norm unobservable vector. If no unobservable combination exists, use the zero vector for the last four entries. No rounding is required, and no physical units are to be included in your final numeric answer.",
            "solution": "The problem is subjected to validation.\n\n**Step 1: Extract Givens**\n-   State vector: $x = \\begin{pmatrix} z  \\dot{z}  a_{2}  b_{2} \\end{pmatrix}^{\\top}$.\n-   State-space dynamics: $\\dot{x} = A x$.\n-   State matrix: $A = \\begin{pmatrix} 0  1  0  0 \\\\ -\\omega_{z}^{2}  0  0  0 \\\\ 0  0  -\\gamma_{a}  0 \\\\ 0  0  0  -\\gamma_{b} \\end{pmatrix}$, with $\\omega_{z}  0$, $\\gamma_{a}  0$, $\\gamma_{b}  0$.\n-   Poloidal flux perturbation: $\\delta\\psi(\\theta) \\approx k_{z}\\, z \\sin(\\theta) + k_{a}\\, a_{2} \\cos(2\\theta) + k_{b}\\, b_{2} \\sin(2\\theta)$.\n-   Flux perturbation constants: $k_{z} = \\frac{4}{5}$, $k_{a} = \\frac{3}{5}$, $k_{b} = \\frac{1}{2}$.\n-   Flux loop measurements: $y_{f1} = \\delta\\psi(\\theta_{f1})$ at $\\theta_{f1} = \\frac{\\pi}{4}$; $y_{f2} = \\delta\\psi(\\theta_{f2})$ at $\\theta_{f2} = \\frac{3\\pi}{4}$.\n-   Magnetic probe measurement: $y_{p}(\\theta) = \\frac{\\partial}{\\partial\\theta} \\delta\\psi(\\theta) = k_{z}\\, z \\cos(\\theta) - 2 k_{a}\\, a_{2} \\sin(2\\theta) + 2 k_{b}\\, b_{2} \\cos(2\\theta)$.\n-   Magnetic probe locations: $\\theta_{p1} = 0$, $\\theta_{p2} = \\frac{\\pi}{2}$, $\\theta_{p3} = \\pi$, $\\theta_{p4} = \\frac{3\\pi}{2}$.\n-   Total measurement vector: $y = \\begin{pmatrix} y_{f1}  y_{f2}  y_{p1}  y_{p2}  y_{p3}  y_{p4} \\end{pmatrix}^{\\top} = C x$.\n-   Task: Construct $C$, form the observability matrix $\\mathcal{O}$, find its rank, and find a unit-norm vector spanning the unobservable subspace.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, using standard models from plasma physics (MHD modes) and control theory (LTI state-space, observability). The formulation is well-posed, providing all necessary information to construct the matrices and perform the required analysis. The language is objective and precise. The physical model is a common simplification and is not unrealistic. The requested calculations are standard procedures in linear systems analysis. The problem is self-contained and free of contradictions.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A solution will be constructed.\n\nThe fundamental task is to assess the observability of the given linear time-invariant (LTI) system. Observability determines whether the internal state of the system can be uniquely determined from its external outputs. For an LTI system described by $\\dot{x} = Ax$ and $y=Cx$, the system is completely observable if and only if the observability matrix $\\mathcal{O}$ has full column rank. The state space has dimension $n=4$, so full rank is $4$. The observability matrix is defined as\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\end{pmatrix}\n$$\n\nFirst, we must construct the measurement matrix $C$. The matrix $C$ relates the measurement vector $y$ to the state vector $x = \\begin{pmatrix} z  \\dot{z}  a_2  b_2 \\end{pmatrix}^\\top$. The $i$-th row of $C$ is given by the coefficients of the states in the expression for the $i$-th measurement $y_i$.\n\nThe measurements are:\n$y_{f1} = \\delta\\psi(\\frac{\\pi}{4}) = k_{z}z\\sin(\\frac{\\pi}{4}) + k_{a}a_{2}\\cos(\\frac{\\pi}{2}) + k_{b}b_{2}\\sin(\\frac{\\pi}{2}) = \\frac{4}{5}z\\frac{\\sqrt{2}}{2} + \\frac{3}{5}a_2(0) + \\frac{1}{2}b_2(1) = \\frac{2\\sqrt{2}}{5}z + \\frac{1}{2}b_2$.\n$y_{f2} = \\delta\\psi(\\frac{3\\pi}{4}) = k_{z}z\\sin(\\frac{3\\pi}{4}) + k_{a}a_{2}\\cos(\\frac{3\\pi}{2}) + k_{b}b_{2}\\sin(\\frac{3\\pi}{2}) = \\frac{4}{5}z\\frac{\\sqrt{2}}{2} + \\frac{3}{5}a_2(0) + \\frac{1}{2}b_2(-1) = \\frac{2\\sqrt{2}}{5}z - \\frac{1}{2}b_2$.\n$y_{p1} = y_p(0) = k_z z \\cos(0) - 2k_a a_2 \\sin(0) + 2k_b b_2 \\cos(0) = \\frac{4}{5}z(1) - 2\\frac{3}{5}a_2(0) + 2\\frac{1}{2}b_2(1) = \\frac{4}{5}z + b_2$.\n$y_{p2} = y_p(\\frac{\\pi}{2}) = k_z z \\cos(\\frac{\\pi}{2}) - 2k_a a_2 \\sin(\\pi) + 2k_b b_2 \\cos(\\pi) = \\frac{4}{5}z(0) - 2\\frac{3}{5}a_2(0) + 2\\frac{1}{2}b_2(-1) = -b_2$.\n$y_{p3} = y_p(\\pi) = k_z z \\cos(\\pi) - 2k_a a_2 \\sin(2\\pi) + 2k_b b_2 \\cos(2\\pi) = \\frac{4}{5}z(-1) - 2\\frac{3}{5}a_2(0) + 2\\frac{1}{2}b_2(1) = -\\frac{4}{5}z + b_2$.\n$y_{p4} = y_p(\\frac{3\\pi}{2}) = k_z z \\cos(\\frac{3\\pi}{2}) - 2k_a a_2 \\sin(3\\pi) + 2k_b b_2 \\cos(3\\pi) = \\frac{4}{5}z(0) - 2\\frac{3}{5}a_2(0) + 2\\frac{1}{2}b_2(-1) = -b_2$.\n\nNone of the measurements depend on the state $\\dot{z}$. Furthermore, due to the specific placement of the sensors, all terms involving $a_2$ evaluate to zero. The flux loops are at $\\theta=\\frac{\\pi}{4}$ and $\\theta=\\frac{3\\pi}{4}$, where $\\cos(2\\theta)=0$. The magnetic probes are at $\\theta=0, \\frac{\\pi}{2}, \\pi, \\frac{3\\pi}{2}$, where $\\sin(2\\theta)=0$. Consequently, the state $a_2$ does not contribute to any of the six measurements. This implies that the second and third columns of the matrix $C$ are zero vectors.\n\nThe $6 \\times 4$ measurement matrix $C$ is therefore:\n$$\nC = \\begin{pmatrix}\n\\frac{\\partial y_1}{\\partial z}  \\frac{\\partial y_1}{\\partial \\dot{z}}  \\frac{\\partial y_1}{\\partial a_2}  \\frac{\\partial y_1}{\\partial b_2} \\\\\n\\vdots  \\vdots  \\vdots  \\vdots\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{2\\sqrt{2}}{5}  0  0  \\frac{1}{2} \\\\\n\\frac{2\\sqrt{2}}{5}  0  0  -\\frac{1}{2} \\\\\n\\frac{4}{5}  0  0  1 \\\\\n0  0  0  -1 \\\\\n-\\frac{4}{5}  0  0  1 \\\\\n0  0  0  -1\n\\end{pmatrix}\n$$\nLet the columns of $C$ be denoted $c_1, c_2, c_3, c_4$. We have $c_2 = \\mathbf{0}$ and $c_3 = \\mathbf{0}$.\n\nNow we analyze the structure of the observability matrix $\\mathcal{O}$.\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\end{pmatrix}\n$$\nThe columns of $\\mathcal{O}$ are related to the columns of $C$. The $j$-th column of $\\mathcal{O}$ is given by\n$$\n\\mathcal{O}_j = \\begin{pmatrix} C e_j \\\\ C A e_j \\\\ C A^2 e_j \\\\ C A^3 e_j \\end{pmatrix}\n$$\nwhere $e_j$ is the $j$-th standard basis vector.\nGiven $C = \\begin{pmatrix} c_1  \\mathbf{0}  \\mathbf{0}  c_4 \\end{pmatrix}$, we look at the third column of $\\mathcal{O}$, which corresponds to the state $a_2$.\n$$\n\\mathcal{O}_3 = \\begin{pmatrix} Ce_3 \\\\ CAe_3 \\\\ CA^2e_3 \\\\ CA^3e_3 \\end{pmatrix} = \\begin{pmatrix} c_3 \\\\ C(A e_3) \\\\ C(A^2 e_3) \\\\ C(A^3 e_3) \\end{pmatrix}\n$$\nSince $A$ is block-diagonal, it maps $e_3$ to a multiple of itself: $A e_3 = -\\gamma_a e_3$. Thus, $A^k e_3 = (-\\gamma_a)^k e_3$.\n$$\n\\mathcal{O}_3 = \\begin{pmatrix} c_3 \\\\ C(-\\gamma_a e_3) \\\\ C((-\\gamma_a)^2 e_3) \\\\ C((-\\gamma_a)^3 e_3) \\end{pmatrix} = \\begin{pmatrix} c_3 \\\\ -\\gamma_a c_3 \\\\ \\gamma_a^2 c_3 \\\\ -\\gamma_a^3 c_3 \\end{pmatrix}\n$$\nSince we found that $c_3 = \\mathbf{0}$, the entire third column of the observability matrix, $\\mathcal{O}_3$, is a zero vector.\n$$\n\\mathcal{O}_3 = \\mathbf{0}\n$$\nA matrix with a zero column cannot have full column rank. Therefore, the rank of $\\mathcal{O}$ is less than $4$, and the system is not observable.\n\nTo find the rank, we check the linear independence of the remaining three columns, $\\mathcal{O}_1, \\mathcal{O}_2, \\mathcal{O}_4$.\nThe block structure of $A$ for the $(z, \\dot{z})$ subsystem is $A_z = \\begin{pmatrix} 0  1 \\\\ -\\omega_z^2  0 \\end{pmatrix}$.\nThe columns of $\\mathcal{O}$ are:\n$$\n\\mathcal{O} = \\begin{pmatrix}\nc_1  c_2  c_3  c_4 \\\\\n-\\omega_z^2 c_2  c_1  -\\gamma_a c_3  -\\gamma_b c_4 \\\\\n-\\omega_z^2 c_1  -\\omega_z^2 c_2  \\gamma_a^2 c_3  \\gamma_b^2 c_4 \\\\\n\\omega_z^4 c_2  -\\omega_z^2 c_1  -\\gamma_a^3 c_3  -\\gamma_b^3 c_4\n\\end{pmatrix}\n$$\nSubstituting $c_2=\\mathbf{0}$ and $c_3=\\mathbf{0}$:\n$$\n\\mathcal{O} = \\begin{pmatrix}\nc_1  \\mathbf{0}  \\mathbf{0}  c_4 \\\\\n\\mathbf{0}  c_1  \\mathbf{0}  -\\gamma_b c_4 \\\\\n-\\omega_z^2 c_1  \\mathbf{0}  \\mathbf{0}  \\gamma_b^2 c_4 \\\\\n\\mathbf{0}  -\\omega_z^2 c_1  \\mathbf{0}  -\\gamma_b^3 c_4\n\\end{pmatrix}\n$$\nThe columns are:\n$$\n\\mathcal{O}_1 = \\begin{pmatrix} c_1 \\\\ \\mathbf{0} \\\\ -\\omega_z^2 c_1 \\\\ \\mathbf{0} \\end{pmatrix}, \\quad \\mathcal{O}_2 = \\begin{pmatrix} \\mathbf{0} \\\\ c_1 \\\\ \\mathbf{0} \\\\ -\\omega_z^2 c_1 \\end{pmatrix}, \\quad \\mathcal{O}_3 = \\mathbf{0}, \\quad \\mathcal{O}_4 = \\begin{pmatrix} c_4 \\\\ -\\gamma_b c_4 \\\\ \\gamma_b^2 c_4 \\\\ -\\gamma_b^3 c_4 \\end{pmatrix}\n$$\nThe vectors $c_1$ and $c_4$ are the first and fourth columns of $C$:\n$$\nc_1 = \\begin{pmatrix} 2\\sqrt{2}/5 \\\\ 2\\sqrt{2}/5 \\\\ 4/5 \\\\ 0 \\\\ -4/5 \\\\ 0 \\end{pmatrix}, \\quad c_4 = \\begin{pmatrix} 1/2 \\\\ -1/2 \\\\ 1 \\\\ -1 \\\\ 1 \\\\ -1 \\end{pmatrix}\n$$\nThese two vectors are linearly independent, as one is not a scalar multiple of the other. Also, $\\omega_z, \\gamma_a, \\gamma_b$ are given as positive, and $c_1, c_4$ are non-zero.\nConsider a linear combination of the non-zero columns set to zero: $\\alpha_1 \\mathcal{O}_1 + \\alpha_2 \\mathcal{O}_2 + \\alpha_4 \\mathcal{O}_4 = \\mathbf{0}$.\nThis expands into a system of vector equations:\n$1. \\quad \\alpha_1 c_1 + \\alpha_4 c_4 = \\mathbf{0}$\n$2. \\quad \\alpha_2 c_1 - \\alpha_4 \\gamma_b c_4 = \\mathbf{0}$\n$3. \\quad -\\alpha_1 \\omega_z^2 c_1 + \\alpha_4 \\gamma_b^2 c_4 = \\mathbf{0}$\n$4. \\quad -\\alpha_2 \\omega_z^2 c_1 - \\alpha_4 \\gamma_b^3 c_4 = \\mathbf{0}$\n\nFrom equation $1$, since $c_1$ and $c_4$ are linearly independent, we must have $\\alpha_1 = 0$ and $\\alpha_4 = 0$.\nSubstituting these into equation $2$ gives $\\alpha_2 c_1 = \\mathbf{0}$, which implies $\\alpha_2 = 0$ since $c_1 \\neq \\mathbf{0}$.\nThus, the only solution is $\\alpha_1=\\alpha_2=\\alpha_4=0$, which proves that the columns $\\mathcal{O}_1, \\mathcal{O}_2, \\mathcal{O}_4$ are linearly independent.\nThe rank of $\\mathcal{O}$ is the number of linearly independent columns, which is $3$.\n\nThe unobservable subspace is the null space of $\\mathcal{O}$. An unobservable state is a vector $v$ such that $\\mathcal{O}v = \\mathbf{0}$. Since the third column $\\mathcal{O}_3$ is zero, the vector $v = e_3 = \\begin{pmatrix} 0  0  1  0 \\end{pmatrix}^\\top$ is in the null space of $\\mathcal{O}$. This vector corresponds to the state combination $0 \\cdot z + 0 \\cdot \\dot{z} + 1 \\cdot a_2 + 0 \\cdot b_2$, meaning the state $a_2$ is unobservable.\nThe problem requests a unit-norm vector of coefficients $\\begin{pmatrix} c_z  c_{\\dot{z}}  c_{a_2}  c_{b_2} \\end{pmatrix}^\\top$ spanning the unobservable subspace. The vector $\\begin{pmatrix} 0  0  1  0 \\end{pmatrix}^\\top$ spans this subspace. Its Euclidean norm is $\\sqrt{0^2+0^2+1^2+0^2} = 1$, so it is already a unit-norm vector.\n\nThe rank of the observability matrix is $3$, and the unit-norm vector of coefficients for the unobservable combination is $\\begin{pmatrix} 0  0  1  0 \\end{pmatrix}^\\top$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  0  0  1  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Theory often assumes instantaneous measurements and continuous control, but real-world systems are digital, with inherent delays and discrete sampling. This exercise bridges that gap by analyzing the stability of a digital density controller, accounting for measurement latency and the sample-and-hold nature of the actuator. By determining the maximum stable gain, you will develop a critical understanding of how the parameters of a digital system impact closed-loop performance and stability. ",
            "id": "3716477",
            "problem": "A tokamak plasma’s line-averaged density feedback loop is implemented digitally with a Zero-Order Hold (ZOH) actuator and an interferometer sensor. The linearized particle balance around a steady state yields a single-input single-output plant for the normalized density deviation $x(t)$ and the normalized actuator command $u(t)$ of the form $dx/dt = -x/\\tau_{p} + g\\,u$, where $\\tau_{p}  0$ is the particle confinement time constant and $g  0$ is the input gain. The interferometer measurement has a fixed latency $\\Delta t$, and the controller samples at period $T_{s}  0$. Assume sampling and hold are ideal and that the actuator holds $u(t)$ constant over each sampling period. The controller uses proportional feedback $u[k] = -K\\,x_{m}[k]$ about zero setpoint, where $x_{m}[k] = x[k-d]$ is the delayed measurement with integer delay $d$ satisfying $\\Delta t = d\\,T_{s}$. \n\nStarting from the continuous-time plant and ideal ZOH sampling, derive the closed-loop difference equation in terms of the sampling factor $\\alpha = \\exp(-T_{s}/\\tau_{p})$ and the ZOH input coefficient $b = g\\,\\tau_{p}\\,(1-\\alpha)$. Then, using a discrete-time stability analysis for the polynomial obtained by the exponential trial $x[k] = \\lambda^{k}$, determine the maximum proportional gain $K_{\\max}$ that guarantees closed-loop stability when the interferometer latency equals one sampling period, i.e., $\\Delta t = T_{s}$ so that $d = 1$. \n\nUse the parameter values $\\tau_{p} = 0.050$ s, $g = 80.0$ s$^{-1}$, and $T_{s} = 0.0020$ s. Round your answer for $K_{\\max}$ to four significant figures. Express the final gain value as dimensionless (no units).",
            "solution": "The problem requires the derivation of the maximum stable proportional gain $K_{\\max}$ for a digital feedback control loop for a tokamak plasma's density. The process involves discretizing the continuous-time plant, formulating the closed-loop difference equation including the measurement delay, and performing a discrete-time stability analysis.\n\n### Step 1: Problem Validation\nThe problem statement provides a well-defined, scientifically-grounded scenario in control engineering applied to plasma physics.\n\n**Givens:**\n-   Continuous-time plant model: $\\frac{dx}{dt} = -\\frac{x}{\\tau_{p}} + g\\,u$, with $\\tau_{p}  0$ and $g  0$.\n-   Controller: Proportional feedback $u[k] = -K\\,x_{m}[k]$ with zero setpoint.\n-   Measurement: Delayed by an integer number of samples, $x_{m}[k] = x[k-d]$.\n-   Latency: $\\Delta t = d\\,T_{s}$. The specific case to be analyzed is $\\Delta t = T_{s}$, which implies $d=1$.\n-   Sampling: Ideal Zero-Order Hold (ZOH) with sampling period $T_{s}  0$.\n-   Definitions: $\\alpha = \\exp(-T_{s}/\\tau_{p})$ and $b = g\\,\\tau_{p}\\,(1-\\alpha)$.\n-   Parameter values: $\\tau_{p} = 0.050$ s, $g = 80.0$ s$^{-1}$, $T_{s} = 0.0020$ s.\n\n**Validation:**\n-   **Scientific Grounding:** The model is a standard first-order linear time-invariant (LTI) system, a common representation for physical processes around an equilibrium. The use of ZOH, sampling, transport delay, and proportional control are fundamental concepts in digital control systems theory. The application to tokamak plasma control is a valid and active area of research in fusion engineering. The problem is scientifically and factually sound.\n-   **Well-Posed:** The problem is self-contained, providing all necessary equations, parameters, and relationships. It asks for a specific quantity ($K_{\\max}$) and outlines the required derivation steps. A unique solution exists.\n-   **Objective:** The problem is stated using precise, unambiguous technical language.\n-   **Consistency and Completeness:** The provided information is internally consistent and sufficient for a solution.\n\n**Verdict:** The problem is valid.\n\n### Step 2: Derivation of the Discrete-Time Plant Model\n\nThe continuous-time plant is described by the linear first-order differential equation:\n$$\n\\frac{dx(t)}{dt} + \\frac{1}{\\tau_p}x(t) = g u(t)\n$$\nFor a digital control system with a Zero-Order Hold (ZOH), the control input $u(t)$ is held constant over each sampling interval, such that $u(t) = u[k]$ for $t \\in [kT_s, (k+1)T_s)$. The solution to the differential equation over this interval, starting from the initial condition $x(kT_s)$, is:\n$$\nx(t) = x(kT_s)\\exp\\left(-\\frac{t-kT_s}{\\tau_p}\\right) + \\int_{kT_s}^{t} \\exp\\left(-\\frac{t-\\tau}{\\tau_p}\\right) g u[k] d\\tau\n$$\nWe want to find the state at the next sampling instant, $t = (k+1)T_s$. Let $x[k] \\equiv x(kT_s)$.\n$$\nx[k+1] = x[k]\\exp\\left(-\\frac{T_s}{\\tau_p}\\right) + g u[k] \\int_{kT_s}^{(k+1)T_s} \\exp\\left(-\\frac{(k+1)T_s - \\tau}{\\tau_p}\\right) d\\tau\n$$\nTo solve the integral, we use the substitution $s = (k+1)T_s - \\tau$, which gives $ds = -d\\tau$. The limits of integration change from $\\tau=kT_s \\to s=T_s$ and $\\tau=(k+1)T_s \\to s=0$.\n$$\n\\int_{T_s}^{0} \\exp\\left(-\\frac{s}{\\tau_p}\\right) (-ds) = \\int_{0}^{T_s} \\exp\\left(-\\frac{s}{\\tau_p}\\right) ds = \\left[-\\tau_p \\exp\\left(-\\frac{s}{\\tau_p}\\right)\\right]_0^{T_s} = -\\tau_p\\left( \\exp\\left(-\\frac{T_s}{\\tau_p}\\right) - 1 \\right) = \\tau_p\\left(1 - \\exp\\left(-\\frac{T_s}{\\tau_p}\\right)\\right)\n$$\nSubstituting this result back into the equation for $x[k+1]$:\n$$\nx[k+1] = x[k]\\exp\\left(-\\frac{T_s}{\\tau_p}\\right) + g \\tau_p\\left(1 - \\exp\\left(-\\frac{T_s}{\\tau_p}\\right)\\right) u[k]\n$$\nUsing the given definitions $\\alpha = \\exp(-T_s/\\tau_p)$ and $b = g\\tau_p(1-\\alpha)$, the discrete-time plant model is:\n$$\nx[k+1] = \\alpha x[k] + b u[k]\n$$\n\n### Step 3: Derivation of the Closed-Loop Difference Equation\n\nThe proportional controller is given by $u[k] = -K x_m[k]$. The measurement latency is specified as $\\Delta t = T_s$, which means the delay integer is $d=1$. Therefore, the measured value at sample $k$ is the actual state from the previous sample: $x_m[k] = x[k-1]$.\nThe control law is thus:\n$$\nu[k] = -K x[k-1]\n$$\nSubstituting this into the discrete-time plant model yields the closed-loop difference equation:\n$$\nx[k+1] = \\alpha x[k] + b(-K x[k-1])\n$$\nRearranging the terms, we get:\n$$\nx[k+1] - \\alpha x[k] + bK x[k-1] = 0\n$$\n\n### Step 4: Stability Analysis\n\nTo analyze the stability of this second-order linear homogeneous difference equation, we use the trial solution $x[k] = \\lambda^k$, as suggested. Substituting this into the equation gives:\n$$\n\\lambda^{k+1} - \\alpha \\lambda^k + bK \\lambda^{k-1} = 0\n$$\nAssuming $\\lambda \\neq 0$, we can divide by $\\lambda^{k-1}$ to obtain the characteristic polynomial of the closed-loop system:\n$$\nP(\\lambda) = \\lambda^2 - \\alpha \\lambda + bK = 0\n$$\nFor a discrete-time system to be stable, all roots $\\lambda$ of its characteristic polynomial must lie inside the unit circle in the complex plane, i.e., $|\\lambda|  1$. For a second-order polynomial of the form $P(\\lambda) = \\lambda^2 + a_1\\lambda + a_0 = 0$, the Jury stability criteria are:\n1.  $P(1)  0$\n2.  $P(-1)  0$\n3.  $|a_0|  1$\n\nHere, the coefficients are $a_1 = -\\alpha$ and $a_0 = bK$. Let's apply the criteria:\n1.  $P(1) = 1^2 - \\alpha(1) + bK  0 \\implies 1 - \\alpha + bK  0 \\implies bK  \\alpha - 1 \\implies K  \\frac{\\alpha - 1}{b}$.\n2.  $P(-1) = (-1)^2 - \\alpha(-1) + bK  0 \\implies 1 + \\alpha + bK  0 \\implies bK  -(1 + \\alpha) \\implies K  -\\frac{1 + \\alpha}{b}$.\n3.  $|a_0|  1 \\implies |bK|  1$. As we are seeking the maximum positive gain $K  0$, and $b = g\\tau_p(1-\\alpha)  0$, this simplifies to $bK  1 \\implies K  \\frac{1}{b}$.\n\nThe stability condition for $K$ is thus given by the intersection of these inequalities. The lower bound on $K$ is the maximum of the two lower bounds: $\\max\\left(\\frac{\\alpha-1}{b}, -\\frac{1+\\alpha}{b}\\right)$. Since $\\alpha = \\exp(-T_s/\\tau_p) \\in (0, 1)$ and $b0$, we have $\\alpha-1  0$ and $1+\\alpha  0$. Therefore $\\frac{\\alpha-1}{b}$ is negative and $-\\frac{1+\\alpha}{b}$ is also negative. Comparing the numerators, $\\alpha-1  -(1+\\alpha)$ because $2\\alpha  0$. Thus, $\\frac{\\alpha-1}{b}$ is the more restrictive (larger) lower bound.\nThe full stability range for $K$ is:\n$$\n\\frac{\\alpha - 1}{b}  K  \\frac{1}{b}\n$$\nThe maximum proportional gain that guarantees stability, $K_{\\max}$, is the supremum of this interval.\n$$\nK_{\\max} = \\frac{1}{b}\n$$\n\n### Step 5: Numerical Calculation\n\nWe are given the parameter values:\n-   $\\tau_{p} = 0.050$ s\n-   $g = 80.0$ s$^{-1}$\n-   $T_{s} = 0.0020$ s\n\nFirst, we calculate the dimensionless parameter $\\alpha$:\n$$\n\\alpha = \\exp\\left(-\\frac{T_s}{\\tau_p}\\right) = \\exp\\left(-\\frac{0.0020}{0.050}\\right) = \\exp(-0.04)\n$$\nNext, we calculate the dimensionless coefficient $b$:\n$$\nb = g \\tau_p (1 - \\alpha) = (80.0)(0.050)(1 - \\exp(-0.04)) = 4.0(1 - \\exp(-0.04))\n$$\nNow, we can find $K_{\\max}$:\n$$\nK_{\\max} = \\frac{1}{b} = \\frac{1}{4.0(1 - \\exp(-0.04))}\n$$\nUsing a calculator for the numerical value:\n$$\n\\exp(-0.04) \\approx 0.960789439\n$$\n$$\n1 - \\exp(-0.04) \\approx 1 - 0.960789439 = 0.039210561\n$$\n$$\nb \\approx 4.0 \\times 0.039210561 = 0.156842244\n$$\n$$\nK_{\\max} = \\frac{1}{b} \\approx \\frac{1}{0.156842244} \\approx 6.3757884\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nK_{\\max} \\approx 6.376\n$$\nThe gain $K$ relates the dimensionless normalized command $u[k]$ to the dimensionless normalized density $x[k-1]$, so $K$ is dimensionless, which is consistent with the calculation.",
            "answer": "$$\n\\boxed{6.376}\n$$"
        }
    ]
}