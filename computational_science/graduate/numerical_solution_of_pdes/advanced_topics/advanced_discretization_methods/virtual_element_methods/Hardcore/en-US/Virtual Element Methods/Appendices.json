{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any finite element-type method lies in its discrete function space. In the Virtual Element Method, this space is defined implicitly through a carefully chosen set of Degrees of Freedom (DoFs). This exercise provides hands-on practice in understanding this fundamental construction by systematically counting the DoFs, which reveals the dimension and structure of the local VEM space. ",
            "id": "3461335",
            "problem": "Consider a single simply connected polygonal element $E \\subset \\mathbb{R}^{2}$ with $n_{E}$ straight edges and hence $n_{E}$ vertices, used in a conforming Virtual Element Method (VEM) of polynomial degree $k \\ge 2$ for a second-order elliptic partial differential equation. The local trial space on $E$ is designed so that: (i) traces on each edge lie in the space of polynomials of degree at most $k$, and (ii) the space contains all polynomials of total degree at most $k$ on $E$. The canonical degrees of freedom on $E$ are defined by:\n- Vertex values: pointwise evaluations of the function at each polygon vertex.\n- Edge moments up to degree $k-2$: for each edge $e \\subset \\partial E$, line integrals of the function against all monomials on $e$ of total degree at most $k-2$.\n- Internal moments up to degree $k-2$: over $E$, area integrals of the function against all monomials on $E$ of total degree at most $k-2$.\n\nStarting from first principles about the structure and dimension of polynomial spaces on one-dimensional segments and two-dimensional domains, enumerate these categories of degrees of freedom and derive a closed-form expression in terms of $k$ and $n_{E}$ for the total number of independent local degrees of freedom on $E$. Your final answer must be a single closed-form analytic expression in $k$ and $n_{E}$.",
            "solution": "The problem asks for the total number of independent local degrees of freedom (DoFs) for a specific Virtual Element Method (VEM) construction on a polygonal element $E$. The problem statement is valid, scientifically grounded in the theory of numerical methods for PDEs, and well-posed. We can therefore proceed with a systematic derivation.\n\nThe total number of degrees of freedom, which we denote by $N_{DoF}$, is the sum of the number of DoFs in each of the three categories defined in the problem:\n1.  Vertex values ($N_{vertex}$).\n2.  Edge moments ($N_{edge}$).\n3.  Internal moments ($N_{internal}$).\n\nThus, we have the relation:\n$$N_{DoF} = N_{vertex} + N_{edge} + N_{internal}$$\n\nWe will now derive an expression for the number of DoFs in each category based on first principles concerning the dimension of polynomial spaces.\n\n**1. Enumeration of Vertex Degrees of Freedom ($N_{vertex}$)**\n\nThe problem defines these DoFs as \"pointwise evaluations of the function at each polygon vertex.\" A polygonal element $E$ with $n_E$ edges is defined by its $n_E$ vertices. Since each vertex provides a single degree of freedom (the value of the function at that point), the total number of vertex DoFs is simply equal to the number of vertices.\n$$N_{vertex} = n_E$$\n\n**2. Enumeration of Edge Degrees of Freedom ($N_{edge}$)**\n\nThese DoFs are defined as \"for each edge $e \\subset \\partial E$, line integrals of the function against all monomials on $e$ of total degree at most $k-2$.\"\n\nLet us consider a single straight edge $e$. An edge is a one-dimensional domain. We can set up a local coordinate system on this edge, for instance, by a variable $s$ that varies along its length. A monomial on this edge is of the form $s^j$, where $j$ is a non-negative integer representing the degree.\n\nThe problem specifies using all monomials of total degree at most $k-2$. For a one-dimensional domain, this corresponds to the set of monomials $\\{s^0, s^1, s^2, \\dots, s^{k-2}\\}$. The number of such monomials is the dimension of the space of polynomials of degree at most $k-2$ on a line segment, which we denote $\\mathcal{P}_{k-2}(e)$. The dimension is given by the highest degree plus one.\n$$\\text{Number of monomials per edge} = \\dim(\\mathcal{P}_{k-2}(e)) = (k-2) + 1 = k-1$$\nThis count is valid since the problem states $k \\ge 2$, which ensures that the maximum degree $k-2$ is non-negative.\n\nSince there are $n_E$ edges on the boundary of the polygon $E$, and each edge contributes $k-1$ degrees of freedom, the total number of edge DoFs is the product:\n$$N_{edge} = n_E \\times (k-1)$$\n\n**3. Enumeration of Internal Degrees of Freedom ($N_{internal}$)**\n\nThese DoFs are defined as \"over $E$, area integrals of the function against all monomials on $E$ of total degree at most $k-2$.\"\n\nThe element $E$ is a two-dimensional domain in $\\mathbb{R}^2$. A monomial in two variables, say $x$ and $y$, is of the form $x^i y^j$, where $i$ and $j$ are non-negative integers. The total degree of this monomial is $i+j$.\n\nWe need to count the number of such monomials for which the total degree is at most $k-2$. This is equivalent to finding the dimension of the space of polynomials of total degree at most $k-2$ in two variables, denoted $\\mathcal{P}_{k-2}(E)$. The dimension of the space of polynomials in $m$ variables of degree at most $d$ is given by the formula $\\binom{m+d}{m}$.\n\nIn our case, the number of variables is $m=2$ and the maximum degree is $d=k-2$. Substituting these values into the formula, we get:\n$$N_{internal} = \\dim(\\mathcal{P}_{k-2}(E)) = \\binom{2 + (k-2)}{2} = \\binom{k}{2}$$\nUsing the definition of the binomial coefficient, $\\binom{n}{r} = \\frac{n!}{r!(n-r)!}$, we can write this as:\n$$N_{internal} = \\frac{k(k-1)}{2 \\cdot 1} = \\frac{k(k-1)}{2}$$\nThis is valid for $k \\ge 2$. If $k=2$, the degree is at most $0$, so there is only one monomial (the constant $1$), and the formula correctly gives $\\binom{2}{2} = 1$.\n\n**4. Total Number of Degrees of Freedom ($N_{DoF}$)**\n\nFinally, we sum the counts from the three categories to obtain the total number of local degrees of freedom on the element $E$.\n$$N_{DoF} = N_{vertex} + N_{edge} + N_{internal}$$\nSubstituting the expressions we derived:\n$$N_{DoF} = n_E + n_E(k-1) + \\frac{k(k-1)}{2}$$\nWe can simplify this expression:\n$$N_{DoF} = n_E + n_E k - n_E + \\frac{k(k-1)}{2}$$\n$$N_{DoF} = n_E k + \\frac{k(k-1)}{2}$$\nThis is the closed-form expression for the total number of independent local degrees of freedom on the element $E$ in terms of the number of vertices $n_E$ and the polynomial degree $k$. The independence of these DoFs is a cornerstone of the VEM construction, ensuring that they uniquely determine a function within the local VEM space, the dimension of which is precisely $N_{DoF}$.",
            "answer": "$$\\boxed{n_{E} k + \\frac{k(k-1)}{2}}$$"
        },
        {
            "introduction": "A central challenge in VEM is working with functions whose analytical form is not explicitly known inside an element. The $L^2$ projector is the primary tool to overcome this, providing a computable polynomial approximation that is essential for constructing the stiffness matrix and load vector. This practice demystifies the projection by guiding you through the setup and solution of the local linear system required to compute it, a fundamental skill for implementing VEM. ",
            "id": "3461308",
            "problem": "Consider a polygonal element $E \\subset \\mathbb{R}^2$ with Lipschitz boundary and let $\\mathbb{P}_m(E)$ denote the space of polynomials on $E$ of total degree at most $m \\in \\mathbb{N}$. The $L^2$ projector $\\Pi^0_m : L^2(E) \\to \\mathbb{P}_m(E)$ is defined by the condition\n$$(\\Pi^0_m w, p)_E = (w, p)_E \\quad \\text{for all } p \\in \\mathbb{P}_m(E),$$\nwhere $(u,v)_E := \\int_E u v \\, \\mathrm{d}\\boldsymbol{x}$ denotes the $L^2$ inner product on $E$. In the Virtual Element Method (VEM), a discrete function is characterized by Degrees of Freedom (DoFs), and the projector $\\Pi^0_m$ is computable by solving a small, elementwise linear system built from the Gram matrix of a polynomial basis in $\\mathbb{P}_m(E)$ and the right-hand side moments $(w,p)_E$, which, for smooth or polynomial $w$, can be evaluated by exact integration.\n\nStarting from the definition of the $L^2$ projector and the polynomial moment DoFs, derive the linear system for the coefficients of $\\Pi^0_m f$ in a chosen basis of $\\mathbb{P}_m(E)$ and explain why exact integration suffices when $f$ is smooth or polynomial. Then, let $E = [0,1]^2 \\subset \\mathbb{R}^2$, let $m = 1$, choose the centered basis $\\{p_0, p_1, p_2\\}$ of $\\mathbb{P}_1(E)$ with $p_0(x,y) = 1$, $p_1(x,y) = x - \\tfrac{1}{2}$, and $p_2(x,y) = y - \\tfrac{1}{2}$, and take $f(x,y) = x^2 + y$. Using the above framework and exact integration on $E$, compute the explicit expression of $\\Pi^0_1 f$ and simplify it as a single polynomial in $x$ and $y$. Provide your final answer as a single analytic expression. No rounding is required.",
            "solution": "The problem requires the derivation of the linear system to compute an $L^2$ projection onto a polynomial space, followed by an explicit calculation for a specific case. We begin by addressing the general framework.\n\nLet $E \\subset \\mathbb{R}^2$ be a polygonal domain and let $\\mathbb{P}_m(E)$ be the space of polynomials on $E$ of total degree at most $m$. The dimension of this space is $N = \\dim(\\mathbb{P}_m(E)) = \\frac{(m+1)(m+2)}{2}$. Let $\\{\\phi_j\\}_{j=1}^{N}$ be a basis for $\\mathbb{P}_m(E)$. The $L^2$ projector, $\\Pi^0_m$, maps a function $f \\in L^2(E)$ to its best approximation in $\\mathbb{P}_m(E)$, denoted as $\\Pi^0_m f$. By definition, $\\Pi^0_m f \\in \\mathbb{P}_m(E)$, and it satisfies the orthogonality condition:\n$$ (\\Pi^0_m f, p)_E = (f, p)_E \\quad \\text{for all } p \\in \\mathbb{P}_m(E) $$\nwhere $(u,v)_E = \\int_E u v \\, \\mathrm{d}\\boldsymbol{x}$ is the standard $L^2(E)$ inner product.\n\nSince $\\Pi^0_m f$ is an element of $\\mathbb{P}_m(E)$, it can be expressed as a unique linear combination of the basis functions:\n$$ \\Pi^0_m f = \\sum_{j=1}^{N} c_j \\phi_j $$\nfor some unknown scalar coefficients $\\{c_j\\}_{j=1}^{N}$. To find these coefficients, we can use the defining property of the projector. Since the condition must hold for any polynomial $p \\in \\mathbb{P}_m(E)$, it must hold for each basis function $\\phi_i$ where $i \\in \\{1, \\dots, N\\}$. Substituting the expression for $\\Pi^0_m f$ into the defining equation with $p = \\phi_i$ yields:\n$$ \\left( \\sum_{j=1}^{N} c_j \\phi_j, \\phi_i \\right)_E = (f, \\phi_i)_E \\quad \\text{for } i = 1, \\dots, N $$\nBy the linearity of the inner product in the first argument, we can write:\n$$ \\sum_{j=1}^{N} c_j (\\phi_j, \\phi_i)_E = (f, \\phi_i)_E \\quad \\text{for } i = 1, \\dots, N $$\nThis constitutes a system of $N$ linear equations for the $N$ unknown coefficients $c_j$. This system can be written in matrix form as $G \\boldsymbol{c} = \\boldsymbol{b}$, where:\n- $\\boldsymbol{c} = (c_1, c_2, \\dots, c_N)^T$ is the vector of coefficients.\n- $G$ is the $N \\times N$ Gram matrix, with entries $G_{ij} = (\\phi_j, \\phi_i)_E = \\int_E \\phi_i \\phi_j \\, \\mathrm{d}\\boldsymbol{x}$.\n- $\\boldsymbol{b}$ is the right-hand side vector of moments, with entries $b_i = (f, \\phi_i)_E = \\int_E f \\phi_i \\, \\mathrm{d}\\boldsymbol{x}$.\nThe Gram matrix $G$ is symmetric and positive definite because the basis functions $\\{\\phi_j\\}$ are linearly independent. Consequently, $G$ is invertible, and a unique solution $\\boldsymbol{c}$ exists for any given $f \\in L^2(E)$.\n\nThe computability of this system depends on our ability to evaluate the integrals that form the matrix $G$ and the vector $\\boldsymbol{b}$. The entries of $G$ are integrals of products of basis polynomials, i.e., $G_{ij} = \\int_E \\phi_i \\phi_j \\, \\mathrm{d}\\boldsymbol{x}$. Since $\\phi_i$ and $\\phi_j$ are polynomials, their product $\\phi_i \\phi_j$ is also a polynomial. The integral of any polynomial over a polygonal domain can be computed exactly, for instance by using Green's theorem to convert the area integral into a line integral over the boundary of the polygon, which consists of straight line segments. Therefore, the Gram matrix can always be computed exactly. The entries of the right-hand side vector are $b_i = \\int_E f \\phi_i \\, \\mathrm{d}\\boldsymbol{x}$. If the function $f$ is a polynomial, then the integrand $f \\phi_i$ is also a polynomial, and the integral can be computed exactly. If $f$ is a more general smooth function, exact integration might not be possible unless the function has a structure amenable to symbolic integration. The problem statement refers to \"smooth or polynomial\" functions, acknowledging that for the polynomial case, which is fundamental in many VEM applications, exactness is guaranteed.\n\nNow, we apply this framework to the specific problem. We are given:\n- The domain $E = [0,1]^2$.\n- The polynomial degree $m = 1$. The space $\\mathbb{P}_1(E)$ has dimension $N=3$.\n- The basis $\\{p_0, p_1, p_2\\}$ for $\\mathbb{P}_1(E)$:\n  - $p_0(x,y) = 1$\n  - $p_1(x,y) = x - \\frac{1}{2}$\n  - $p_2(x,y) = y - \\frac{1}{2}$\n- The function to project: $f(x,y) = x^2 + y$.\n\nWe seek $\\Pi^0_1 f = c_0 p_0 + c_1 p_1 + c_2 p_2$. We must compute the Gram matrix $G$ and the moment vector $\\boldsymbol{b}$. The matrix entries are $G_{ij} = (p_i, p_j)_E$.\n\n- $G_{00} = \\int_0^1 \\int_0^1 (1)(1) \\, \\mathrm{d}x \\mathrm{d}y = 1$.\n- $G_{01} = G_{10} = \\int_0^1 \\int_0^1 (1)(x - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\left[\\frac{x^2}{2} - \\frac{x}{2}\\right]_0^1 \\mathrm{d}y = \\int_0^1 0 \\, \\mathrm{d}y = 0$.\n- $G_{02} = G_{20} = \\int_0^1 \\int_0^1 (1)(y - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 (y - \\frac{1}{2}) \\mathrm{d}y = \\left[\\frac{y^2}{2} - \\frac{y}{2}\\right]_0^1 = 0$.\n- $G_{11} = \\int_0^1 \\int_0^1 (x - \\frac{1}{2})^2 \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\left[\\frac{(x - \\frac{1}{2})^3}{3}\\right]_0^1 \\mathrm{d}y = \\int_0^1 \\frac{(\\frac{1}{2})^3 - (-\\frac{1}{2})^3}{3} \\mathrm{d}y = \\int_0^1 \\frac{\\frac{1}{8} + \\frac{1}{8}}{3} \\mathrm{d}y = \\int_0^1 \\frac{1}{12} \\mathrm{d}y = \\frac{1}{12}$.\n- $G_{12} = G_{21} = \\int_0^1 \\int_0^1 (x - \\frac{1}{2})(y - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\left(\\int_0^1 (x - \\frac{1}{2}) \\mathrm{d}x\\right) \\left(\\int_0^1 (y - \\frac{1}{2}) \\mathrm{d}y\\right) = (0)(0) = 0$.\n- $G_{22} = \\int_0^1 \\int_0^1 (y - \\frac{1}{2})^2 \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 (y - \\frac{1}{2})^2 \\mathrm{d}y = \\left[\\frac{(y - \\frac{1}{2})^3}{3}\\right]_0^1 = \\frac{1}{12}$.\n\nThe Gram matrix for this basis is diagonal, confirming the basis is orthogonal.\n$$ G = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{12}  0 \\\\ 0  0  \\frac{1}{12} \\end{pmatrix} $$\nNext, we compute the right-hand side vector $\\boldsymbol{b}$ with entries $b_i = (f, p_i)_E$.\n\n- $b_0 = \\int_0^1 \\int_0^1 (x^2+y)(1) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\left[\\frac{x^3}{3} + yx\\right]_0^1 \\mathrm{d}y = \\int_0^1 (\\frac{1}{3} + y) \\mathrm{d}y = \\left[\\frac{y}{3} + \\frac{y^2}{2}\\right]_0^1 = \\frac{1}{3} + \\frac{1}{2} = \\frac{5}{6}$.\n- $b_1 = \\int_0^1 \\int_0^1 (x^2+y)(x - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\int_0^1 (x^3 - \\frac{1}{2}x^2 + yx - \\frac{1}{2}y) \\, \\mathrm{d}x \\mathrm{d}y$.\nThe inner integral with respect to $x$ is $\\int_0^1 (x^3 - \\frac{1}{2}x^2 + yx - \\frac{1}{2}y) \\, \\mathrm{d}x = \\left[\\frac{x^4}{4} - \\frac{x^3}{6} + \\frac{yx^2}{2} - \\frac{yx}{2}\\right]_0^1 = \\frac{1}{4} - \\frac{1}{6} + \\frac{y}{2} - \\frac{y}{2} = \\frac{1}{12}$.\nThen, $\\int_0^1 \\frac{1}{12} \\mathrm{d}y = \\frac{1}{12}$. So, $b_1 = \\frac{1}{12}$.\n- $b_2 = \\int_0^1 \\int_0^1 (x^2+y)(y - \\frac{1}{2}) \\, \\mathrm{d}x \\mathrm{d}y = \\int_0^1 \\int_0^1 (x^2y - \\frac{1}{2}x^2 + y^2 - \\frac{1}{2}y) \\, \\mathrm{d}x \\mathrm{d}y$.\nThe inner integral with respect to $x$ is $\\int_0^1 (x^2y - \\frac{1}{2}x^2 + y^2 - \\frac{1}{2}y) \\, \\mathrm{d}x = \\left[\\frac{x^3y}{3} - \\frac{x^3}{6} + y^2x - \\frac{y}{2}x\\right]_0^1 = \\frac{y}{3} - \\frac{1}{6} + y^2 - \\frac{y}{2} = y^2 - \\frac{y}{6} - \\frac{1}{6}$.\nThen, $\\int_0^1 (y^2 - \\frac{y}{6} - \\frac{1}{6}) \\mathrm{d}y = \\left[\\frac{y^3}{3} - \\frac{y^2}{12} - \\frac{y}{6}\\right]_0^1 = \\frac{1}{3} - \\frac{1}{12} - \\frac{1}{6} = \\frac{4-1-2}{12} = \\frac{1}{12}$. So, $b_2 = \\frac{1}{12}$.\n\nThe linear system $G \\boldsymbol{c} = \\boldsymbol{b}$ is:\n$$ \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{1}{12}  0 \\\\ 0  0  \\frac{1}{12} \\end{pmatrix} \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{6} \\\\ \\frac{1}{12} \\\\ \\frac{1}{12} \\end{pmatrix} $$\nSolving for the coefficients is straightforward:\n- $c_0 = \\frac{5}{6}$.\n- $\\frac{1}{12} c_1 = \\frac{1}{12} \\implies c_1 = 1$.\n- $\\frac{1}{12} c_2 = \\frac{1}{12} \\implies c_2 = 1$.\n\nFinally, we construct the projected polynomial $\\Pi^0_1 f$:\n$$ \\Pi^0_1 f(x,y) = c_0 p_0(x,y) + c_1 p_1(x,y) + c_2 p_2(x,y) \\\\ = \\frac{5}{6}(1) + 1\\left(x - \\frac{1}{2}\\right) + 1\\left(y - \\frac{1}{2}\\right) \\\\ = \\frac{5}{6} + x - \\frac{1}{2} + y - \\frac{1}{2} \\\\ = x + y + \\frac{5}{6} - 1 \\\\ = x + y - \\frac{1}{6} $$\nThe explicit expression for the $L^2$ projection of $f(x,y)=x^2+y$ onto the space of linear polynomials on the unit square is $x+y-\\frac{1}{6}$.",
            "answer": "$$\\boxed{x + y - \\frac{1}{6}}$$"
        },
        {
            "introduction": "For any numerical method to be reliable, it must pass the patch testâ€”the ability to exactly reproduce basic polynomial solutions. This exercise explores the theoretical core of VEM that guarantees this property. You will derive the energy projector $\\Pi^{\\nabla}$ and see precisely how its interplay with the stabilization term ensures that the method is exact for linear solutions, thus satisfying this crucial convergence criterion. ",
            "id": "3456377",
            "problem": "Consider the lowest-order conforming Virtual Element Method (VEM) for the model elliptic Partial Differential Equation (PDE) on a single polygonal element $K \\subset \\mathbb{R}^{2}$, where $K$ is an arbitrary star-shaped polygon with respect to a ball. Let $K$ have boundary $\\partial K$ consisting of straight edges $e$, with outward unit normal vector $n_{e}$, edge length $\\ell_{e}$, and edge midpoint $m_{e} \\in \\mathbb{R}^{2}$. Denote the area of $K$ by $|K|$ and the perimeter by $L_{K} = \\sum_{e \\subset \\partial K} \\ell_{e}$. The local discrete trial space for the lowest-order VEM, $V_{h}(K)$, consists of functions $u_{h}$ that are harmonic in $K$ in the weak sense and whose trace on each edge $e$ is a polynomial of degree at most $1$ (piecewise linear). The degrees of freedom are the nodal values at the vertices of $K$, and along each edge $e$ with endpoint vertices $i_{e}$ and $j_{e}$ the trace is the unique linear function matching those nodal degrees of freedom.\n\nThe local energy bilinear form of the VEM is constructed from the exact element bilinear form $a^{K}(u,v) = \\int_{K} \\nabla u \\cdot \\nabla v \\, dx$ via the decomposition\n$$\na^{K}_{h}(u_{h}, v_{h}) = a^{K}\\big(\\Pi^{\\nabla}_{1} u_{h}, \\Pi^{\\nabla}_{1} v_{h}\\big) + S\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, \\, v_{h} - \\Pi^{\\nabla}_{1} v_{h}\\big),\n$$\nwhere $\\Pi^{\\nabla}_{1}: V_{h}(K) \\to \\mathbb{P}_{1}(K)$ is the polynomial consistency projector onto linear polynomials, and $S(\\cdot,\\cdot)$ is a stabilization bilinear form that is symmetric, positive definite on the kernel of $\\Pi^{\\nabla}_{1}$, and vanishes on $\\mathbb{P}_{1}(K)$ when applied to arguments in $\\mathbb{P}_{1}(K)$.\n\nStarting from the fundamental definitions and the requirement of polynomial consistency for the patch test (i.e., exact reproduction of linear fields), derive the explicit closed-form expression of the projector $\\Pi^{\\nabla}_{1} u_{h}(x)$ for $x \\in K$ in terms of:\n- the geometric quantities $\\{|K|, L_{K}, n_{e}, \\ell_{e}, m_{e}\\}_{e \\subset \\partial K}$, and\n- the vertex degrees of freedom $\\{u_{i}\\}$, assembled along edges via the edgewise linear trace.\n\nYou must use only edgewise linear information to evaluate boundary integrals; interior moments of $u_{h}$ are not available. Impose the projector by the following defining conditions:\n- Energy orthogonality: $\\int_{K} \\nabla\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\cdot \\nabla q \\, dx = 0$ for all $q \\in \\mathbb{P}_{1}(K)$,\n- Mean boundary value matching: $\\int_{\\partial K} \\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\, ds = 0$.\n\nThen, for the exact linear field $u(x) = a + b x + c y$ with constants $a$, $b$, $c \\in \\mathbb{R}$, quantify the contribution of the stabilization term $S(u_{h}, u_{h})$ to $a^{K}_{h}(u_{h}, u_{h})$ when $u_{h}$ is the VEM interpolant of $u$ on $K$.\n\nYour final answer must be a single row matrix with two entries: the explicit expression for $\\Pi^{\\nabla}_{1} u_{h}(x)$ derived under the above conditions and evaluated using edgewise linear data, and the exact value of $S(u_{h}, u_{h})$ for $u(x) = a + b x + c y$. No rounding is required. The final answer must be a closed-form analytic expression.",
            "solution": "The problem asks for two results concerning the lowest-order conforming Virtual Element Method (VEM) on a polygonal element $K$: first, the derivation of the explicit formula for the $\\mathbb{P}_{1}$ consistency projector $\\Pi^{\\nabla}_{1}$; second, the evaluation of the stabilization term for a linear function.\n\nThe problem statement has been validated and found to be scientifically grounded, well-posed, and objective. It represents a standard exercise in the theoretical underpinnings of VEM. We may proceed with the solution.\n\n### Part 1: Derivation of the Projector $\\Pi^{\\nabla}_{1} u_{h}$\n\nThe projector $\\Pi^{\\nabla}_{1} u_{h}$ is a linear polynomial in $\\mathbb{P}_{1}(K)$. Let $x = (x, y)$ denote the spatial coordinates in $\\mathbb{R}^{2}$. We can write $\\Pi^{\\nabla}_{1} u_h$ as:\n$$\np(x,y) = \\Pi^{\\nabla}_{1} u_{h}(x,y) = c_{0} + c_{1}x + c_{2}y\n$$\nwhere the coefficients $c_{0}, c_{1}, c_{2} \\in \\mathbb{R}$ are to be determined. The defining conditions for this projector are provided.\n\n**Condition 1: Energy Orthogonality**\nThe first condition states that the projection error is orthogonal to $\\mathbb{P}_{1}(K)$ in the sense of the seminorm induced by the bilinear form $a^{K}(\\cdot, \\cdot)$.\n$$\n\\int_{K} \\nabla\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\cdot \\nabla q \\, dx = 0 \\quad \\forall q \\in \\mathbb{P}_{1}(K)\n$$\nThis is equivalent to:\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla q \\, dx = \\int_{K} \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\nabla q \\, dx \\quad \\forall q \\in \\mathbb{P}_{1}(K)\n$$\nThe space $\\mathbb{P}_{1}(K)$ is spanned by the basis functions $\\{1, x, y\\}$. Testing with $q=1$ yields a trivial identity since $\\nabla(1) = 0$. We test with $q=x$ and $q=y$.\nThe gradient of the projector is $\\nabla p = (c_{1}, c_{2})^{T}$.\n\nFor $q(x,y) = x$, we have $\\nabla q = (1, 0)^{T}$. The right-hand side becomes:\n$$\n\\int_{K} \\nabla p \\cdot (1, 0)^{T} \\, dx = \\int_{K} c_{1} \\, dx = c_{1} |K|\n$$\nFor $q(x,y) = y$, we have $\\nabla q = (0, 1)^{T}$. The right-hand side becomes:\n$$\n\\int_{K} \\nabla p \\cdot (0, 1)^{T} \\, dx = \\int_{K} c_{2} \\, dx = c_{2} |K|\n$$\nThe left-hand side integrals involve $u_{h}$, which is known only through its boundary values and its property of being harmonic in $K$. We use Green's first identity. For a vector field $F$ and a scalar field $\\phi$, $\\int_K F \\cdot \\nabla \\phi \\, dx = \\int_{\\partial K} \\phi (F \\cdot n) \\, ds - \\int_K \\phi (\\nabla \\cdot F) \\, dx$. Alternatively, and more directly, for scalar fields $u$ and $v$ where $v$ is harmonic ($\\Delta v = 0$):\n$$\n\\int_{K} \\nabla u \\cdot \\nabla v \\, dx = \\int_{\\partial K} u (\\nabla v \\cdot n) \\, ds\n$$\nSince any $q \\in \\mathbb{P}_{1}(K)$ is harmonic ($\\Delta q = 0$), this identity applies.\nFor $q=x$, $\\nabla q \\cdot n = (1, 0)^{T} \\cdot (n_{x}, n_{y})^{T} = n_{x}$.\nFor $q=y$, $\\nabla q \\cdot n = (0, 1)^{T} \\cdot (n_{x}, n_{y})^{T} = n_{y}$.\nTherefore, we have:\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla x \\, dx = \\int_{\\partial K} u_{h} n_{x} \\, ds\n$$\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla y \\, dx = \\int_{\\partial K} u_{h} n_{y} \\, ds\n$$\nEquating the expressions for the left- and right-hand sides, we find the coefficients $c_{1}$ and $c_{2}$:\n$$\nc_{1} = \\frac{1}{|K|} \\int_{\\partial K} u_{h} n_{x} \\, ds \\quad \\text{and} \\quad c_{2} = \\frac{1}{|K|} \\int_{\\partial K} u_{h} n_{y} \\, ds\n$$\nThe boundary integral $\\int_{\\partial K}$ is a sum of integrals over the edges $e$ of the polygon. On each edge $e$, the outward normal vector $n_{e} = (n_{e,x}, n_{e,y})^{T}$ is constant. The trace of $u_{h}$ on $e$ is a linear function determined by the nodal values $u_{i_{e}}$ and $u_{j_{e}}$ at the edge's endpoints. The integral of a linear function over the edge is its length $\\ell_{e}$ times its value at the midpoint $m_{e}$. Let $u_{h}(m_{e})$ denote this value, which is simply the average of the endpoint values: $u_{h}(m_{e}) = \\frac{1}{2}(u_{i_{e}} + u_{j_{e}})$.\n$$\n\\int_{e} u_{h} \\, ds = \\ell_{e} u_{h}(m_{e})\n$$\nSo, the coefficients become:\n$$\nc_{1} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\int_{e} u_{h} n_{e,x} \\, ds = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e,x} \\ell_{e} u_{h}(m_{e})\n$$\n$$\nc_{2} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\int_{e} u_{h} n_{e,y} \\, ds = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e,y} \\ell_{e} u_{h}(m_{e})\n$$\nIn vector form, the gradient of the projector is:\n$$\n\\nabla(\\Pi^{\\nabla}_{1} u_{h}) = (c_{1}, c_{2})^{T} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) n_{e}\n$$\n\n**Condition 2: Mean Boundary Value Matching**\nThe second condition is used to determine the constant term $c_{0}$:\n$$\n\\int_{\\partial K} \\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\, ds = 0 \\quad \\implies \\quad \\int_{\\partial K} u_{h} \\, ds = \\int_{\\partial K} \\Pi^{\\nabla}_{1} u_{h} \\, ds\n$$\nWe evaluate both sides. The left-hand side is:\n$$\n\\int_{\\partial K} u_{h} \\, ds = \\sum_{e \\subset \\partial K} \\int_{e} u_{h} \\, ds = \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e})\n$$\nThe right-hand side involves the integral of the polynomial $p(x,y) = c_{0} + c_{1}x + c_{2}y$:\n$$\n\\int_{\\partial K} p(x,y) \\, ds = \\int_{\\partial K} (c_{0} + c_{1}x + c_{2}y) \\, ds = c_{0} \\int_{\\partial K} ds + c_{1} \\int_{\\partial K} x \\, ds + c_{2} \\int_{\\partial K} y \\, ds\n$$\nThe integrals are evaluated as sums of edge integrals:\n$\\int_{\\partial K} ds = \\sum_{e} \\ell_{e} = L_{K}$, the perimeter.\n$\\int_{\\partial K} x \\, ds = \\sum_{e} \\int_{e} x \\, ds = \\sum_{e} \\ell_{e} x_{m,e}$, where $m_{e}=(x_{m,e}, y_{m,e})$ is the midpoint of edge $e$.\n$\\int_{\\partial K} y \\, ds = \\sum_{e} \\int_{e} y \\, ds = \\sum_{e} \\ell_{e} y_{m,e}$.\nEquating the two sides gives:\n$$\n\\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) = c_{0}L_{K} + c_{1} \\sum_{e \\subset \\partial K} \\ell_{e} x_{m,e} + c_{2} \\sum_{e \\subset \\partial K} \\ell_{e} y_{m,e}\n$$\nSolving for $c_{0}$:\n$$\nc_{0} = \\frac{1}{L_{K}} \\left( \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) - \\left( c_{1} \\sum_{e \\subset \\partial K} \\ell_{e} x_{m,e} + c_{2} \\sum_{e \\subset \\partial K} \\ell_{e} y_{m,e} \\right) \\right)\n$$\nThis can be written more compactly using vector notation:\n$$\nc_{0} = \\frac{1}{L_{K}} \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) - \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\left( \\frac{1}{L_{K}} \\sum_{e \\subset \\partial K} \\ell_{e} m_{e} \\right)\n$$\n\n**Final Expression for $\\Pi^{\\nabla}_{1} u_{h}$**\nCombining the expressions for $c_0, c_1, c_2$, we obtain the final form of the projector evaluated at a point $x \\in K$:\n$$\n\\Pi^{\\nabla}_{1} u_{h}(x) = c_{0} + \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot x = \\frac{1}{L_{K}} \\sum_{e' \\subset \\partial K} \\ell_{e'} u_{h}(m_{e'}) + \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\left( x - \\frac{1}{L_{K}} \\sum_{e'' \\subset \\partial K} \\ell_{e''} m_{e''} \\right)\n$$\nSubstituting the expression for the gradient and expanding the term $u_{h}(m_{e})$:\n$$\n\\Pi^{\\nabla}_{1} u_{h}(x) = \\frac{1}{L_{K}}\\sum_{e' \\subset \\partial K} \\ell_{e'} \\left(\\frac{u_{i_{e'}} + u_{j_{e'}}}{2}\\right) + \\left(\\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e} \\ell_{e} \\left(\\frac{u_{i_{e}} + u_{j_{e}}}{2}\\right)\\right) \\cdot \\left(x - \\frac{1}{L_{K}}\\sum_{e'' \\subset \\partial K} \\ell_{e''} m_{e''}\\right)\n$$\nThis is the explicit closed-form expression for the projector.\n\n### Part 2: Contribution of the Stabilization Term\n\nThe second task is to quantify the contribution of the stabilization term for an exact linear field $u(x,y) = a + bx + cy$, where $a, b, c$ are real constants. Let $u_{h}$ be the VEM interpolant of $u$ on the element $K$.\n\nFor the lowest-order VEM, the degrees of freedom are the function values at the vertices of the element. Thus, the VEM interpolant $u_{h} \\in V_{h}(K)$ is the function satisfying:\n$1.$ $u_{h}$ is harmonic in $K$.\n$2.$ $u_{h}(v_{i}) = u(v_{i})$ for every vertex $v_{i}$ of $K$.\n\nSince $u(x,y) = a + bx + cy$ is a linear polynomial, it is a harmonic function, i.e., $\\Delta u = 0$. The trace of $u_{h}$ on any edge $e$ (connecting vertices $v_{i}$ and $v_{j}$) is, by definition of the VEM space, the unique linear function that interpolates the vertex values $u_{h}(v_{i}) = u(v_{i})$ and $u_{h}(v_{j}) = u(v_{j})$. The function $u(x,y)$ itself is linear and interpolates these values on the edge. By uniqueness, the trace of $u_{h}$ on every edge is identical to the trace of $u$. Thus, $u_{h}|_{\\partial K} = u|_{\\partial K}$.\n\nWe now have two functions, $u_{h}$ and $u$, that are both harmonic in the domain $K$ and have identical values on the boundary $\\partial K$. By the uniqueness theorem for the Dirichlet problem for the Laplace equation, these two functions must be identical throughout the domain $K$. Therefore, $u_{h}(x) = u(x)$ for all $x \\in K$.\n\nThis means that the VEM interpolant of a linear polynomial is the polynomial itself. So, $u_{h}$ is an element of $\\mathbb{P}_{1}(K)$.\n\nNext, we must evaluate the projector $\\Pi^{\\nabla}_{1}$ applied to $u_{h} = u \\in \\mathbb{P}_{1}(K)$. The projector is defined to be consistent with polynomials in $\\mathbb{P}_{1}(K)$. We can verify this from its defining conditions. If we set $u_{h} = p \\in \\mathbb{P}_{1}(K)$ and test the projector candidate $\\Pi^{\\nabla}_{1} p = p$, we find:\n$1.$ $\\int_{K} \\nabla(p-p) \\cdot \\nabla q \\, dx = 0$ for all $q \\in \\mathbb{P}_{1}(K)$.\n$2.$ $\\int_{\\partial K} (p-p) \\, ds = 0$.\nBoth conditions are trivially satisfied. Since the projector is unique, it must be that $\\Pi^{\\nabla}_{1} p = p$ for any $p \\in \\mathbb{P}_{1}(K)$.\nThis is the \"polynomial consistency\" property mentioned in the problem statement, which is a crucial feature for passing the patch test.\n\nIn our case, $u_{h}(x) = u(x) \\in \\mathbb{P}_{1}(K)$, so $\\Pi^{\\nabla}_{1} u_{h} = u_{h}$.\n\nThe contribution of the stabilization to the energy $a^{K}_{h}(u_{h}, u_{h})$ is given by the term $S(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, u_{h} - \\Pi^{\\nabla}_{1} u_{h})$.\nSubstituting our findings:\n$$\nu_{h} - \\Pi^{\\nabla}_{1} u_{h} = u_{h} - u_{h} = 0\n$$\nThe stabilization term is therefore:\n$$\nS(0, 0)\n$$\nSince $S(\\cdot, \\cdot)$ is a bilinear form, it must satisfy $S(0, 0) = 0$.\n\nThus, for any linear field $u$, the stabilization term for its VEM interpolant $u_{h}$ is exactly zero. This confirms that the method exactly reproduces the energy of linear solutions, as required by the patch test. The question text contains a slight imprecision, referring to the term as \"$S(u_h, u_h)$\" whereas the stabilization added to the energy is $S(u_h - \\Pi^\\nabla_1 u_h, u_h - \\Pi^\\nabla_1 u_h)$. Our analysis addresses the latter, which represents the actual contribution.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{L_{K}}\\sum\\limits_{e' \\subset \\partial K} \\ell_{e'} \\left(\\frac{u_{i_{e'}} + u_{j_{e'}}}{2}\\right) + \\left(\\frac{1}{|K|} \\sum\\limits_{e \\subset \\partial K} n_{e} \\ell_{e} \\left(\\frac{u_{i_{e}} + u_{j_{e}}}{2}\\right)\\right) \\cdot \\left(x - \\frac{1}{L_{K}}\\sum\\limits_{e'' \\subset \\partial K} \\ell_{e''} m_{e''}\\right)  0 \\end{pmatrix}}\n$$"
        }
    ]
}