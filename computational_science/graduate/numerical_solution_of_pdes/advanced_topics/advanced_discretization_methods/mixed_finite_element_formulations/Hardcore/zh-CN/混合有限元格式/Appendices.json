{
    "hands_on_practices": [
        {
            "introduction": "本练习提供了一种具体理解inf-sup（或LBB）稳定性条件的方法。通过在一个单元上使用特定的测试函数族，我们将直接计算稳定性常数的一个下界。这个实践旨在揭开这个抽象概念的神秘面纱，并展示它如何与函数空间的选择直接相关，这是分析新型混合元稳定性的基础技能。",
            "id": "3422179",
            "problem": "考虑在偏微分方程（PDEs）的混合格式中出现的双线性形式 $b(v,q)=\\int_{\\Omega} (\\nabla\\cdot v)\\,q\\,dx$。在单位参考单元 $K=(0,1)^{2}$ 上，定义空间 $V=H(\\mathrm{div},K)$ 和 $Q=\\mathbb{P}_{0}(K)$，其中 $\\mathbb{P}_{0}(K)$ 表示在 $K$ 上为常数的函数空间。为 $V$ 配备 $H(\\mathrm{div})$ 范数 $\\|v\\|_{H(\\mathrm{div},K)}=\\left(\\|v\\|_{L^{2}(K)}^{2}+\\|\\nabla\\cdot v\\|_{L^{2}(K)}^{2}\\right)^{1/2}$，为 $Q$ 配备 $L^{2}$ 范数。单元上的 inf-sup 常数定义为\n$$\n\\beta_{K}=\\inf_{0\\neq q\\in Q}\\ \\sup_{0\\neq v\\in V}\\ \\frac{b(v,q)}{\\|v\\|_{H(\\mathrm{div},K)}\\,\\|q\\|_{L^{2}(K)}}.\n$$\n从范数和散度算子的基本定义出发，并且不引用任何预先组合的离散稳定性结果，使用一种宏单元式的构造方法，将上确界限制在单参数矢量场族\n$$\nv_{\\alpha}(x,y)=\\alpha\\,q\\,(x-\\tfrac{1}{2},\\,y-\\tfrac{1}{2}),\\quad \\alpha\\in\\mathbb{R},\n$$\n来推导 $\\beta_{K}$ 的一个严格下界。将你的最终答案表示为单个精确的闭式表达式。无需四舍五入。",
            "solution": "该问题要求推导单元 inf-sup 常数 $\\beta_K$ 的一个严格下界。对问题陈述的验证表明，该问题是适定的，有科学依据的，并包含了完整解答所需的所有信息。\n\ninf-sup 常数 $\\beta_K$ 定义为：\n$$\n\\beta_{K}=\\inf_{0\\neq q\\in Q}\\ \\sup_{0\\neq v\\in V}\\ \\frac{b(v,q)}{\\|v\\|_{H(\\mathrm{div},K)}\\,\\|q\\|_{L^{2}(K)}}\n$$\n空间为 $V = H(\\mathrm{div},K)$ 和 $Q = \\mathbb{P}_{0}(K)$，其中 $K=(0,1)^{2}$ 是参考正方形单元。空间 $\\mathbb{P}_{0}(K)$ 由在 $K$ 上为常数的函数组成。\n\n我们取一个任意的非零函数 $q \\in Q$。由于 $q$ 在 $K$ 上是常数，存在一个实数 $c \\neq 0$ 使得对所有 $(x,y) \\in K$ 都有 $q(x,y) = c$。\n\n我们首先计算 $q$ 的 $L^2$-范数：\n$$\n\\|q\\|_{L^{2}(K)}^{2} = \\int_{K} q(x,y)^{2} \\,dx\\,dy = \\int_{0}^{1}\\int_{0}^{1} c^{2} \\,dx\\,dy = c^{2} \\cdot \\mathrm{Area}(K) = c^{2} \\cdot 1^{2} = c^{2}\n$$\n因此，$\\|q\\|_{L^{2}(K)} = \\sqrt{c^{2}} = |c|$。\n\n双线性形式 $b(v,q)$ 由下式给出：\n$$\nb(v,q) = \\int_{K} (\\nabla\\cdot v)\\,q\\,dx\\,dy = \\int_{K} (\\nabla\\cdot v)c \\,dx\\,dy = c \\int_{K} (\\nabla\\cdot v) \\,dx\\,dy\n$$\ninf-sup 定义中的比率可以写成：\n$$\n\\frac{b(v,q)}{\\|v\\|_{H(\\mathrm{div},K)}\\,\\|q\\|_{L^{2}(K)}} = \\frac{c \\int_{K} (\\nabla\\cdot v) \\,dx\\,dy}{\\|v\\|_{H(\\mathrm{div},K)}\\,|c|} = \\frac{c}{|c|} \\frac{\\int_{K} (\\nabla\\cdot v) \\,dx\\,dy}{\\|v\\|_{H(\\mathrm{div},K)}}\n$$\n项 $\\sup_{v} \\frac{b(v,q)}{\\|v\\| \\|q\\|}$ 与 $q \\in Q \\setminus \\{0\\}$ 的具体选择无关。要理解这一点，请注意，对所有 $v \\in V$ 取上确界将使表达式非负，从而有效地消除了符号因子 $\\frac{c}{|c|}$（例如，如果 $\\int \\nabla\\cdot v  0$，可以用 $-v$ 替换 $v$，这不会改变范数 $\\|v\\|$，但会改变积分的符号）。因此，对 $q$ 取下确界是多余的，我们可以将 $q$ 固定为任何非零常数函数。\n\n通过限制取上确界的空间 $V$，可以获得 $\\beta_K$ 的一个下界。问题指定使用单参数矢量场族 $v_{\\alpha}(x,y)=\\alpha\\,q\\,(x-\\tfrac{1}{2},\\,y-\\tfrac{1}{2})$。我们固定 $q(x,y) = c$。那么该族为 $v_{\\alpha}(x,y) = \\alpha c (x-\\frac{1}{2},\\,y-\\frac{1}{2})$，其中 $\\alpha \\in \\mathbb{R}$。\n\n那么下界由下式给出：\n$$\n\\beta_{K} \\ge \\sup_{0\\neq \\alpha \\in \\mathbb{R}}\\ \\frac{b(v_{\\alpha},q)}{\\|v_{\\alpha}\\|_{H(\\mathrm{div},K)}\\,\\|q\\|_{L^{2}(K)}}\n$$\n我们现在计算此表达式所需的各项。参数 $c$ 假定为非零。\n\n1.  **$v_{\\alpha}$ 的散度**：\n    该矢量场为 $v_{\\alpha}(x,y) = \\left( \\alpha c (x-\\frac{1}{2}), \\alpha c (y-\\frac{1}{2}) \\right)$。其散度为：\n    $$\n    \\nabla \\cdot v_{\\alpha} = \\frac{\\partial}{\\partial x}\\left(\\alpha c (x-\\frac{1}{2})\\right) + \\frac{\\partial}{\\partial y}\\left(\\alpha c (y-\\frac{1}{2})\\right) = \\alpha c + \\alpha c = 2\\alpha c\n    $$\n\n2.  **分子 $b(v_{\\alpha}, q)$**：\n    $$\n    b(v_{\\alpha},q) = \\int_{K} (\\nabla\\cdot v_{\\alpha}) q \\,dx\\,dy = \\int_{K} (2\\alpha c) c \\,dx\\,dy = 2\\alpha c^{2} \\int_{K} \\,dx\\,dy = 2\\alpha c^{2}\n    $$\n\n3.  **分母范数 $\\|v_{\\alpha}\\|_{H(\\mathrm{div},K)}$**：\n    该范数定义为 $\\|v_{\\alpha}\\|_{H(\\mathrm{div},K)} = \\left(\\|v_{\\alpha}\\|_{L^{2}(K)}^{2}+\\|\\nabla\\cdot v_{\\alpha}\\|_{L^{2}(K)}^{2}\\right)^{1/2}$。\n    \n    首先，我们计算 $\\|\\nabla\\cdot v_{\\alpha}\\|_{L^{2}(K)}^{2}$：\n    $$\n    \\|\\nabla\\cdot v_{\\alpha}\\|_{L^{2}(K)}^{2} = \\int_{K} (2\\alpha c)^{2} \\,dx\\,dy = 4\\alpha^{2}c^{2} \\int_{K} \\,dx\\,dy = 4\\alpha^{2}c^{2}\n    $$\n    \n    接下来，我们计算 $\\|v_{\\alpha}\\|_{L^{2}(K)}^{2}$：\n    $$\n    \\|v_{\\alpha}\\|_{L^{2}(K)}^{2} = \\int_{K} |v_{\\alpha}(x,y)|^{2} \\,dx\\,dy = \\int_{0}^{1}\\int_{0}^{1} \\left| \\alpha c \\left(x-\\frac{1}{2}, y-\\frac{1}{2}\\right) \\right|^{2} \\,dx\\,dy\n    $$\n    $$\n    = (\\alpha c)^{2} \\int_{0}^{1}\\int_{0}^{1} \\left( \\left(x-\\frac{1}{2}\\right)^{2} + \\left(y-\\frac{1}{2}\\right)^{2} \\right) \\,dx\\,dy\n    $$\n    我们计算这个积分：\n    $$\n    \\int_{0}^{1} \\left(t-\\frac{1}{2}\\right)^{2} \\,dt = \\left[\\frac{\\left(t-\\frac{1}{2}\\right)^{3}}{3}\\right]_{0}^{1} = \\frac{(\\frac{1}{2})^{3}}{3} - \\frac{(-\\frac{1}{2})^{3}}{3} = \\frac{1}{3}\\left(\\frac{1}{8} - \\left(-\\frac{1}{8}\\right)\\right) = \\frac{1}{3}\\left(\\frac{2}{8}\\right) = \\frac{1}{12}\n    $$\n    那么二重积分是：\n    $$\n    \\int_{0}^{1}\\int_{0}^{1} \\left(x-\\frac{1}{2}\\right)^{2} \\,dx\\,dy + \\int_{0}^{1}\\int_{0}^{1} \\left(y-\\frac{1}{2}\\right)^{2} \\,dx\\,dy = \\frac{1}{12} + \\frac{1}{12} = \\frac{2}{12} = \\frac{1}{6}\n    $$\n    所以，$\\|v_{\\alpha}\\|_{L^{2}(K)}^{2} = \\alpha^{2}c^{2}\\frac{1}{6}$。\n    \n    将两部分组合起来得到 $H(\\mathrm{div},K)$ 范数：\n    $$\n    \\|v_{\\alpha}\\|_{H(\\mathrm{div},K)}^{2} = \\frac{1}{6}\\alpha^{2}c^{2} + 4\\alpha^{2}c^{2} = \\alpha^{2}c^{2}\\left(\\frac{1}{6} + 4\\right) = \\alpha^{2}c^{2}\\left(\\frac{1+24}{6}\\right) = \\frac{25}{6}\\alpha^{2}c^{2}\n    $$\n    取平方根得到：\n    $$\n    \\|v_{\\alpha}\\|_{H(\\mathrm{div},K)} = \\sqrt{\\frac{25}{6}\\alpha^{2}c^{2}} = \\frac{5}{\\sqrt{6}}|\\alpha||c|\n    $$\n\n4.  **最终比率与上确界**：\n    我们现在组合分数并进行化简：\n    $$\n    \\frac{b(v_{\\alpha},q)}{\\|v_{\\alpha}\\|_{H(\\mathrm{div},K)}\\,\\|q\\|_{L^{2}(K)}} = \\frac{2\\alpha c^{2}}{\\left(\\frac{5}{\\sqrt{6}}|\\alpha||c|\\right)|c|} = \\frac{2\\alpha c^{2}}{\\frac{5}{\\sqrt{6}}|\\alpha|c^{2}} = \\frac{2\\alpha}{|\\alpha|}\\frac{\\sqrt{6}}{5}\n    $$\n    当 $\\alpha > 0$ 时，此表达式等于 $\\frac{2\\sqrt{6}}{5}$；当 $\\alpha  0$ 时，等于 $-\\frac{2\\sqrt{6}}{5}$。\n    \n    $\\beta_K$ 的下界是该量在所有非零 $\\alpha$ 上的上确界：\n    $$\n    \\sup_{0\\neq \\alpha \\in \\mathbb{R}}\\left(\\frac{2\\alpha}{|\\alpha|}\\frac{\\sqrt{6}}{5}\\right) = \\frac{2\\sqrt{6}}{5}\n    $$\n这个值给出了 inf-sup 常数 $\\beta_K$ 的一个严格下界。\n$$\n\\beta_{K} \\ge \\frac{2\\sqrt{6}}{5}\n$$",
            "answer": "$$\\boxed{\\frac{2\\sqrt{6}}{5}}$$"
        },
        {
            "introduction": "并非所有的有限元组合都是稳定的。本练习将探究一个经典的斯托克斯方程不稳定方法：等阶线性元。通过构造一个离散散度算子“看不见”的“伪压力模式”，你将精确地论证该方法为何失效，并证明其inf-sup常数为零——这是不稳定的一个明确信号。",
            "id": "3422198",
            "problem": "考虑在单位平方域 $\\Omega = (0,1)^{2}$ 上定义的稳态斯托克斯偏微分方程（PDE），其速度满足齐次狄利克雷边界条件，压力满足零均值约束。其混合弱形式旨在寻找 $(\\boldsymbol{u}, p) \\in \\boldsymbol{V} \\times Q$，使得对于所有 $(\\boldsymbol{v}, q) \\in \\boldsymbol{V} \\times Q$ 都满足，\n$$\na(\\boldsymbol{u}, \\boldsymbol{v}) + b(\\boldsymbol{v}, p) = \\ell(\\boldsymbol{v}), \\quad b(\\boldsymbol{u}, q) = 0,\n$$\n其中 $a(\\boldsymbol{u}, \\boldsymbol{v}) = \\nu \\int_{\\Omega} \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\, dx$，$b(\\boldsymbol{v}, p) = - \\int_{\\Omega} p \\, \\nabla \\cdot \\boldsymbol{v} \\, dx$，$\\ell(\\boldsymbol{v}) = \\int_{\\Omega} \\boldsymbol{f} \\cdot \\boldsymbol{v} \\, dx$，$\\boldsymbol{V} = [H_{0}^{1}(\\Omega)]^{2}$，以及 $Q = \\{ q \\in L^{2}(\\Omega) : \\int_{\\Omega} q \\, dx = 0 \\}$。该混合格式的稳定性由 Ladyzhenskaya–Babuška–Brezzi (LBB) 条件来刻画，该条件要求 inf-sup 常数严格为正。\n\n设有限元方法（FEM）离散化在 $\\Omega$ 的一个恰好由2个三角形组成的协调三角剖分 $\\mathcal{T}_{h}$ 上使用同阶连续分片线性空间（$P_{1}/P_{1}$）：\n$$\nT_{1} = \\operatorname{conv}\\{(0,0), (1,0), (1,1)\\}, \\quad T_{2} = \\operatorname{conv}\\{(0,0), (0,1), (1,1)\\}.\n$$\n定义 $S_{h}$ 为在 $\\mathcal{T}_{h}$ 中每个三角形上都是线性函数的全局连续函数空间。设离散速度空间为 $\\boldsymbol{V}_{h} = [S_{h}]^{2} \\cap [H_{0}^{1}(\\Omega)]^{2}$，离散压力空间为 $Q_{h} = \\{ q_{h} \\in S_{h} : \\int_{\\Omega} q_{h} \\, dx = 0 \\}$。离散 inf-sup 常数为\n$$\n\\beta_{h} = \\inf_{q_{h} \\in Q_{h} \\setminus \\{0\\}} \\; \\sup_{\\boldsymbol{v}_{h} \\in \\boldsymbol{V}_{h} \\setminus \\{0\\}} \\; \\frac{b(\\boldsymbol{v}_{h}, q_{h})}{\\|\\boldsymbol{v}_{h}\\|_{H^{1}(\\Omega)} \\, \\|q_{h}\\|_{L^{2}(\\Omega)}}.\n$$\n\n从上述定义出发，构造一个非零离散压力 $p_{h} \\in Q_{h}$，其在两个三角形 $T_{1}$ 和 $T_{2}$ 上的单元积分均为零。利用分片线性函数的性质和散度的局部性，证明对于每一个 $\\boldsymbol{v}_{h} \\in \\boldsymbol{V}_{h}$，都有 $b(\\boldsymbol{v}_{h}, p_{h}) = 0$。然后，利用 $\\beta_{h}$ 的定义，确定它对于此网格和单元对的值。将最终答案表示为一个无单位的实数。",
            "solution": "该问题要求我们确定在单位平方域 $\\Omega = (0,1)^2$ 的一个特定双三角形网格上，使用同阶连续分片线性（$P_1/P_1$）有限元对斯托克斯方程进行离散化后的离散 inf-sup 常数 $\\beta_h$。\n\n首先，我们验证问题陈述。该问题是适定的，其科学基础是不可压缩流混合有限元方法的理论，所有术语和空间都根据标准文献定义。不存在矛盾或歧义。该问题有效。\n\n根据问题陈述的引导，求解过程分为三个步骤：\n$1$. 构造一个满足特定积分性质的非零离散压力 $p_h$。\n$2$. 证明对于这个压力，双线性形式 $b(\\boldsymbol{v}_h, p_h)$ 对所有离散速度 $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$ 均为零。\n$3$. 利用此结果确定 $\\beta_h$ 的值。\n\n让我们从刻画离散压力空间 $Q_h$ 开始。网格 $\\mathcal{T}_h$ 由两个三角形组成，$T_1 = \\operatorname{conv}\\{(0,0), (1,0), (1,1)\\}$ 和 $T_2 = \\operatorname{conv}\\{(0,0), (0,1), (1,1)\\}$。顶点集合为 $\\{(0,0), (1,0), (0,1), (1,1)\\}$。我们将这些顶点标记为 $N_1=(0,0)$，$N_2=(1,0)$，$N_3=(0,1)$ 和 $N_4=(1,1)$。\n空间 $S_h$ 由在 $\\Omega$ 上连续且在每个三角形 $T_k$ 上为线性的函数组成。任何函数 $q_h \\in S_h$ 都由其在四个顶点处的值唯一确定。设这些节点值分别为对应于顶点 $N_1, N_2, N_3, N_4$ 的 $q_1, q_2, q_3, q_4$。\n\n问题要求我们构造一个非零离散压力 $p_h \\in Q_h$，其在两个三角形上的单元积分均为零。对于一个在三角形 $T_k$ 上是线性的函数，其积分等于该三角形的面积乘以其在顶点处值的平均值。$T_1$ 和 $T_2$ 的面积均为 $\\frac{1}{2}$。\n$T_1$ 的顶点是 $N_1(0,0)$、$N_2(1,0)$ 和 $N_4(1,1)$。压力 $p_h$ 对应的节点值是 $p_1, p_2, p_4$。\n在 $T_1$ 上的积分是：\n$$ \\int_{T_1} p_h \\, dx = \\frac{\\text{Area}(T_1)}{3} (p_h(N_1) + p_h(N_2) + p_h(N_4)) = \\frac{1/2}{3} (p_1 + p_2 + p_4) = \\frac{1}{6} (p_1 + p_2 + p_4) $$\n$T_2$ 的顶点是 $N_1(0,0)$、$N_3(0,1)$ 和 $N_4(1,1)$。对应的节点值是 $p_1, p_3, p_4$。\n在 $T_2$ 上的积分是：\n$$ \\int_{T_2} p_h \\, dx = \\frac{\\text{Area}(T_2)}{3} (p_h(N_1) + p_h(N_3) + p_h(N_4)) = \\frac{1/2}{3} (p_1 + p_3 + p_4) = \\frac{1}{6} (p_1 + p_3 + p_4) $$\n我们要求这些积分为零：\n$$ p_1 + p_2 + p_4 = 0 $$\n$$ p_1 + p_3 + p_4 = 0 $$\n用第一个方程减去第二个方程得到 $p_2 - p_3 = 0$，所以 $p_2 = p_3$。\n我们需要找到一组满足这些条件的非零节点值 $(p_1, p_2, p_3, p_4)$。我们选择 $p_1 = 1$ 和 $p_4 = -1$。将其代入第一个方程：$1 + p_2 - 1 = 0$，得到 $p_2 = 0$。因为 $p_2=p_3$，所以我们也有 $p_3=0$。\n因此，我们可以通过节点值 $(p_1, p_2, p_3, p_4) = (1, 0, 0, -1)$ 来定义我们的特定压力 $p_h$。这个压力函数不是恒零的。\n这个 $p_h$ 满足 $\\int_{T_1} p_h \\, dx = 0$ 和 $\\int_{T_2} p_h \\, dx = 0$。这意味着它在整个域上的积分也为零：$\\int_{\\Omega} p_h \\, dx = \\int_{T_1} p_h \\, dx + \\int_{T_2} p_h \\, dx = 0 + 0 = 0$。因此，这个 $p_h$ 是 $Q_h$ 中一个有效的非零元。\n\n接下来，我们证明对于这个 $p_h$ 和每一个 $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$，都有 $b(\\boldsymbol{v}_h, p_h) = 0$。双线性形式 $b$ 定义为 $b(\\boldsymbol{v}_h, p_h) = - \\int_{\\Omega} p_h \\, (\\nabla \\cdot \\boldsymbol{v}_h) \\, dx$。\n我们可以将积分拆分到网格的两个单元上：\n$$ b(\\boldsymbol{v}_h, p_h) = - \\left( \\int_{T_1} p_h \\, (\\nabla \\cdot \\boldsymbol{v}_h) \\, dx + \\int_{T_2} p_h \\, (\\nabla \\cdot \\boldsymbol{v}_h) \\, dx \\right) $$\n离散速度场 $\\boldsymbol{v}_h$ 属于 $\\boldsymbol{V}_h = [S_h]^2 \\cap [H_0^1(\\Omega)]^2$。$\\boldsymbol{v}_h$ 的每个分量都是一个连续分片线性函数。这类函数的一个关键性质是它们的梯度在网格的每个单元上都是常数。因此，散度 $\\nabla \\cdot \\boldsymbol{v}_h$ 在每个单元上也是一个常数。\n设 $(\\nabla \\cdot \\boldsymbol{v}_h)|_{T_1} = c_1$ 和 $(\\nabla \\cdot \\boldsymbol{v}_h)|_{T_2} = c_2$，其中 $c_1$ 和 $c_2$ 是依赖于 $\\boldsymbol{v}_h$ 的常数。\n然后我们可以将这些常数从各自的积分中提出来：\n$$ b(\\boldsymbol{v}_h, p_h) = - \\left( c_1 \\int_{T_1} p_h \\, dx + c_2 \\int_{T_2} p_h \\, dx \\right) $$\n通过我们对 $p_h$ 的构造，我们已经确保了 $\\int_{T_1} p_h \\, dx = 0$ 和 $\\int_{T_2} p_h \\, dx = 0$。\n将这些值代入 $b(\\boldsymbol{v}_h, p_h)$ 的表达式中：\n$$ b(\\boldsymbol{v}_h, p_h) = - (c_1 \\cdot 0 + c_2 \\cdot 0) = 0 $$\n这对每一个 $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$ 都成立。这个特定的压力模式 $p_h$ 是一个“伪压力模式”或“棋盘模式”，它位于离散散度算子转置的核（kernel）中。\n\n最后，我们确定离散 inf-sup 常数 $\\beta_h$ 的值，其定义为：\n$$ \\beta_{h} = \\inf_{q_{h} \\in Q_{h} \\setminus \\{0\\}} \\; \\sup_{\\boldsymbol{v}_{h} \\in \\boldsymbol{V}_{h} \\setminus \\{0\\}} \\; \\frac{b(\\boldsymbol{v}_{h}, q_{h})}{\\|\\boldsymbol{v}_{h}\\|_{H^{1}(\\Omega)} \\, \\|q_{h}\\|_{L^{2}(\\Omega)}} $$\n下确界（infimum）取遍离散压力空间 $Q_h$ 中所有的非零函数。因此，$\\beta_h$ 的值小于或等于对任何特定 $q_h$ 的选择下，下确界内部项的值。让我们选择我们上面构造的特定非零压力模式 $p_h$。对于这个选择，表达式变为：\n$$ \\sup_{\\boldsymbol{v}_{h} \\in \\boldsymbol{V}_{h} \\setminus \\{0\\}} \\; \\frac{b(\\boldsymbol{v}_{h}, p_{h})}{\\|\\boldsymbol{v}_{h}\\|_{H^{1}(\\Omega)} \\, \\|p_{h}\\|_{L^{2}(\\Omega)}} $$\n由于我们已经证明了对于所有的 $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$ 都有 $b(\\boldsymbol{v}_h, p_h) = 0$，所以该分数的分子始终为 $0$。因此，上确界（supremum）为 $0$：\n$$ \\sup_{\\boldsymbol{v}_{h} \\in \\boldsymbol{V}_{h} \\setminus \\{0\\}} \\; \\frac{0}{\\|\\boldsymbol{v}_{h}\\|_{H^{1}(\\Omega)} \\, \\|p_{h}\\|_{L^{2}(\\Omega)}} = 0 $$\n因为下确界是最大下界，我们有不等式：\n$$ \\beta_h \\le 0 $$\n根据定义，inf-sup 常数必须是非负的，即 $\\beta_h \\ge 0$。要使 $\\beta_h \\le 0$ 和 $\\beta_h \\ge 0$ 这两个不等式同时成立，唯一的可能是 $\\beta_h$ 恰好为零。\n$\\beta_h = 0$ 这一事实表明，$P_1/P_1$ 单元对对于此网格上的斯托克斯问题是不稳定的，这是不可压缩流数值分析中的一个经典结果。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在见证了不稳定方法如何失效之后，我们现在转向一个稳定的离散化方案。这个计算实践将理论与代码紧密联系起来，使用著名的交错网格（MAC）格式来求解斯托克斯特征值问题。你将通过数值方式验证该方法的稳定性，检查伪压力模式是否已被消除，并进而评估其谱精度，从而将稳定的混合法理论与具体、准确的数值结果联系起来。",
            "id": "3422164",
            "problem": "考虑二维空间单位环面（双周期单位正方形）上的不可压缩斯托克斯特征值问题。连续问题是：寻找一个非平凡三元组 $\\left(\\boldsymbol{u}, p, \\lambda\\right)$，使得\n$$ -\\Delta \\boldsymbol{u} + \\nabla p = \\lambda \\boldsymbol{u}, \\quad \\nabla \\cdot \\boldsymbol{u} = 0, $$\n其在两个方向上均满足周期性边界条件，且压力 $p$ 受约束 $\\int_{[0,1]^2} p \\, dx = 0$。在此，$\\boldsymbol{u}$ 是速度场，$p$ 是压力，$\\lambda$ 是特征值。粘度归一化为 $1$。\n\n您将研究在交错网格上使用一种具有混合有限元法（MFEM）精神的相容混合离散方法来近似特征值。在一个具有周期性拓扑和网格间距 $h = 1/N$ 的均匀 $N \\times N$ 网格上，使用 Marker-and-Cell (MAC) 交错格式，该格式已知与矩形上的一个稳定混合有限元对代数等价。将 $u_x$ 置于垂直面中心 $(i+1/2,j)$，将 $u_y$ 置于水平面中心 $(i,j+1/2)$，将 $p$ 置于单元中心 $(i,j)$，其中所有整数 $i,j \\in \\{0,\\dots,N-1\\}$（索引对 $N$ 取模以编码周期性）。通过与交错布局一致的中心一阶差分来定义离散梯度 $G: \\mathbb{R}^{N^2} \\to \\mathbb{R}^{2N^2}$ 和离散散度 $D: \\mathbb{R}^{2N^2} \\to \\mathbb{R}^{N^2}$：\n- $G$ 的 $x$ 分量通过 $x$ 方向的向前差分将单元中心的压力映射到垂直面，$G$ 的 $y$ 分量通过 $y$ 方向的向前差分将单元中心的压力映射到水平面。\n- 散度 $D$ 通过对穿过单元边界的离散法向通量求和的向后差分，将面中心的速度映射到单元中心。\n\n令 $L_p = D G$ 表示单元中心上的离散压力拉普拉斯算子（在周期内积下为对称半正定算子），并令 $L_u$ 表示面中心速度上的块对角离散向量拉普拉斯算子，它是通过将标准五点拉普拉斯算子应用于其各自交错网格上的每个速度分量而获得的。考虑作用于速度场的离散亥姆霍兹-霍奇投影算子 $P = I - G L_p^{-1} D$，其中 $L_p^{-1}$ 是 $L_p$ 在零均值压力子空间上的逆。投影离散斯托克斯算子是 $K = P (-L_u)$ 在无散速度子空间上的限制。\n\n从基本原理出发——即连续斯托克斯特征问题、环面上函数的周期傅里叶表示，以及离散梯度和散度的代数相容性——执行以下任务：\n\n$1.$ 使用分部积分的离散模拟（分部求和）和周期性结构，证明为什么当使用上述交错相容对时，$L_p = D G$ 有一个恰好对应于常数压力的一维零空间，并且没有其他零模态。解释为什么此属性消除了在不稳定混合对中可能出现的伪压力模态。\n\n$2.$ 论证离散无散子空间在经过 $P$ 投影后对于 $-L_u$ 是不变的，并且连续问题的特征结构可由此子空间上的离散问题近似。使用周期傅里叶基将连续特征对与其由整数波向量 $\\boldsymbol{k} = (k_x,k_y)$（其中 $k_x, k_y \\in \\mathbb{Z}$, $|\\boldsymbol{k}| \\neq 0$）索引的离散对应项联系起来。\n\n$3.$ 对于给定的整数波向量 $\\boldsymbol{k} = (k_x,k_y)$，定义连续特征值 $\\lambda(\\boldsymbol{k})$ 和一个可计算的离散近似 $\\lambda_h(\\boldsymbol{k};N)$，该近似仅依赖于分辨率 $N$ 和网格间距 $h = 1/N$，并由周期网格上的相容离散算子导出。推导绝对特征值误差 $e_h(\\boldsymbol{k};N) = |\\lambda(\\boldsymbol{k}) - \\lambda_h(\\boldsymbol{k};N)|$ 的表达式。\n\n$4.$ 对于一个固定的非零波向量 $\\boldsymbol{k}$，通过计算两个连续均匀加密 $N$ 和 $2N$ 之间的观测收敛阶，使用推导出的表达式来经验性地评估离散无散子空间的谱精度：\n$$ p_{\\mathrm{obs}} = \\frac{\\log\\left(e_h(\\boldsymbol{k};N) / e_h(\\boldsymbol{k};2N)\\right)}{\\log(2)}. $$\n\n您的程序必须在周期性交错网格上实现算子 $D$ 和 $G$，构造 $L_p = D G$，通过计算 $L_p$ 的一小组代数最小特征值并统计有多少接近于零来数值验证伪压力模态的不存在性，并使用您推导的公式计算 $e_h(\\boldsymbol{k};N)$ 和 $p_{\\mathrm{obs}}$。不涉及物理单位。角度（若在您的推导中出现）必须以弧度为单位。\n\n测试套件：\n- 情况 1：$N = 8$, $\\boldsymbol{k} = (1,1)$。\n- 情况 2：$N = 16$, $\\boldsymbol{k} = (1,1)$。\n- 情况 3：$N = 32$, $\\boldsymbol{k} = (1,1)$。\n- 情况 4：$N = 16$, $\\boldsymbol{k} = (2,1)$。\n- 情况 5：对于 $\\boldsymbol{k} = (1,1)$，在 $N=16$ 和 $N=32$ 之间的观测阶 $p_{\\mathrm{obs}}$。\n\n对于情况 1-4 中的每一种，您的程序必须输出两个值：作为浮点数的绝对特征值误差 $e_h(\\boldsymbol{k};N)$，以及一个布尔值，指示 $L_p$ 是否恰好有一个数值零特征值（在计算一小组代数最小特征值时，解释为绝对值严格小于 $10^{-8}$）。对于情况 5，输出作为浮点数的观测阶 $p_{\\mathrm{obs}}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按此确切顺序聚合在方括号内的逗号分隔列表的结果：\n$$ \\left[ e_h( (1,1); 8 ), \\, \\text{stable}(8), \\, e_h( (1,1); 16 ), \\, \\text{stable}(16), \\, e_h( (1,1); 32 ), \\, \\text{stable}(32), \\, e_h( (2,1); 16 ), \\, \\text{stable}(16), \\, p_{\\mathrm{obs}} \\right]. $$\n此处，$\\text{stable}(N)$ 是在分辨率 $N$ 下用于伪压力模态消除检查的布尔值。不得打印任何额外文本。",
            "solution": "用户提供的问题陈述已经过验证，并被确定为偏微分方程数值分析领域中一个有效、适定且具有科学依据的问题。以下是完整且合理的解答。\n\n### 1. 离散压力拉普拉斯算子 $L_p$ 的分析\n\n问题在交错周期网格上定义了离散梯度 ($G$) 和散度 ($D$) 算子。压力 $p$ 位于单元中心 $(i,j)h$，速度分量 $u_x$ 位于垂直面中心 $(i+1/2,j)h$，$u_y$ 位于水平面中心 $(i,j+1/2)h$，其中 $h = 1/N$ 是网格间距。\n\n令 $p$ 为单元中心压力的网格函数，$\\boldsymbol{u} = (u_x, u_y)$ 为面中心速度的网格函数。在周期域 $[0,1]^2$ 上，压力场和速度场的离散内积定义为：\n$$ \\langle p, q \\rangle_p = h^2 \\sum_{i,j=0}^{N-1} p_{i,j} q_{i,j} \\quad \\text{and} \\quad \\langle \\boldsymbol{u}, \\boldsymbol{v} \\rangle_u = h^2 \\sum_{i,j=0}^{N-1} \\left( u_{x,i+1/2,j} v_{x,i+1/2,j} + u_{y,i,j+1/2} v_{y,i,j+1/2} \\right) $$\n离散梯度 $G$ 由向前差分定义：\n$$ (G p)_{x, i+1/2,j} = \\frac{p_{i+1,j} - p_{i,j}}{h}, \\quad (G p)_{y, i,j+1/2} = \\frac{p_{i,j+1} - p_{i,j}}{h} $$\n离散散度 $D$ 由单元中心的中心差分定义：\n$$ (D \\boldsymbol{u})_{i,j} = \\frac{u_{x,i+1/2,j} - u_{x,i-1/2,j}}{h} + \\frac{u_{y,i,j+1/2} - u_{y,i,j-1/2}}{h} $$\n在周期网格上使用分部求和，我们可以建立 $D$ 和 $G$ 之间的关系。对于任意 $p$ 和 $\\boldsymbol{u}$：\n$$ \\langle D\\boldsymbol{u}, p \\rangle_p = h^2 \\sum_{i,j} p_{i,j} \\left( \\frac{u_{x,i+1/2,j} - u_{x,i-1/2,j}}{h} + \\frac{u_{y,i,j+1/2} - u_{y,i,j-1/2}}{h} \\right) $$\n通过重排求和项并利用周期性（例如 $\\sum_{i} p_{i,j} u_{x,i-1/2,j} = \\sum_{i} p_{i+1,j} u_{x,i+1/2,j}$），我们发现：\n$$ \\langle D\\boldsymbol{u}, p \\rangle_p = -h^2 \\sum_{i,j} \\left( u_{x,i+1/2,j} \\frac{p_{i+1,j}-p_{i,j}}{h} + u_{y,i,j+1/2} \\frac{p_{i,j+1}-p_{i,j}}{h} \\right) = -\\langle \\boldsymbol{u}, Gp \\rangle_u $$\n这表明 $D$ 是 $G$ 的负伴随算子，即 $D = -G^*$。\n\n离散压力拉普拉斯算子是 $L_p = DG$。代入 $D = -G^*$，我们得到 $L_p = -G^*G$。该算子是对称且负半定的。其零空间 $\\text{ker}(L_p)$ 与 $G$ 的零空间相同。\n如果 $Gp=0$，则压力场 $p$ 属于 $\\text{ker}(G)$。这意味着：\n$$ \\frac{p_{i+1,j} - p_{i,j}}{h} = 0 \\quad \\text{and} \\quad \\frac{p_{i,j+1} - p_{i,j}}{h} = 0 \\quad \\forall i,j $$\n这些条件意味着对所有网格点，$p_{i+1,j} = p_{i,j}$ 和 $p_{i,j+1} = p_{i,j}$。由于网格通过周期性边界条件是连通的，这迫使所有的 $p_{i,j}$ 值都相等。因此，$G$ 的零空间仅由常数压力场组成。这是一个由全1向量张成的一维空间。\n\n这个性质至关重要。它是速度-压力对的 inf-sup (或 LBB) 稳定条件的离散体现。$L_p$ 中不存在非常数零向量确保了没有伪振荡压力模态的存在。这类模态是不稳定离散化（例如，像 P1-P1 有限元这样的等阶插值）的产物，会破坏整个数值解。MAC 交错格式是一种稳定格式，本分析证实了它能消除伪压力模态。\n\n为完整起见，我们注意到 $L_p = DG$ 是压力网格上的标准五点有限差分离散拉普拉斯算子：\n$$ (L_p p)_{i,j} = (D(Gp))_{i,j} = \\frac{1}{h^2} \\left[ (p_{i+1,j}-p_{i,j}) - (p_{i,j}-p_{i-1,j}) + (p_{i,j+1}-p_{i,j}) - (p_{i,j}-p_{i,j-1}) \\right] = \\frac{p_{i+1,j}+p_{i-1,j}+p_{i,j+1}+p_{i,j-1}-4p_{i,j}}{h^2} $$\n\n### 2. 通过傅里叶模态进行特征系统分析\n\n离散斯托克斯特征值问题是寻找 $(\\boldsymbol{u}, p, \\lambda_h)$，使得 $-L_u \\boldsymbol{u} + Gp = \\lambda_h \\boldsymbol{u}$ 且 $D\\boldsymbol{u}=0$。算子 $-L_u$ 是标准五点拉普拉斯算子，分量式地作用于各自交错网格上的速度场。离散无散子空间是所有满足 $D\\boldsymbol{u}=0$ 的速度场 $\\boldsymbol{u}$ 的集合。\n\n周期网格上线性、移不变算子的特征函数是离散傅里叶模态。对于一个整数波向量 $\\boldsymbol{k}=(k_x, k_y)$，压力和速度的模态是：\n$$ p_{i,j} = \\hat{p} e^{i 2\\pi (k_x i h + k_y j h)}, \\quad u_{x,i+1/2,j} = \\hat{u}_x e^{i 2\\pi (k_x(i+1/2)h + k_y j h)}, \\quad u_{y,i,j+1/2} = \\hat{u}_y e^{i 2\\pi (k_x i h + k_y(j+1/2)h)} $$\n将离散散度算子 $D$ 应用于这样一个速度模态，得到：\n$$ (D\\boldsymbol{u})_{i,j} = \\left( \\hat{u}_x \\frac{2i}{h}\\sin(\\pi k_x h) + \\hat{u}_y \\frac{2i}{h}\\sin(\\pi k_y h) \\right) e^{i 2\\pi (k_x i h + k_y j h)} $$\n条件 $D\\boldsymbol{u}=0$ 转化为对振幅 $\\hat{\\boldsymbol{u}}=(\\hat{u}_x, \\hat{u}_y)$ 的代数条件：\n$$ \\hat{u}_x \\sin(\\pi k_x h) + \\hat{u}_y \\sin(\\pi k_y h) = 0 $$\n这是不可压缩条件 $\\boldsymbol{k} \\cdot \\hat{\\boldsymbol{u}} = 0$ 的离散模拟。\n\n算子 $-L_u$ 是块对角的，在每个速度分量的网格上都充当相同的标量拉普拉斯算子。五点拉普拉斯算子作用于傅里叶模态 $e^{i2\\pi (k_x x + k_y y)}$ 的结果是乘以一个标量，即其傅里叶符号 $\\hat{L}(\\boldsymbol{k})$。对于定义在位置 $(mh, nh)$ 上的网格函数，其符号为：\n$$ \\hat{L}(\\boldsymbol{k}) = \\frac{2\\cos(2\\pi k_x h) + 2\\cos(2\\pi k_y h) - 4}{h^2} = -\\frac{4}{h^2}\\left(\\sin^2(\\pi k_x h) + \\sin^2(\\pi k_y h)\\right) $$\n由于这对 $u_x$ 和 $u_y$ 的网格都成立，算子 $-L_u$ 在傅里叶空间中变成乘以一个标量 $\\widehat{-L_u}(\\boldsymbol{k}) = -\\hat{L}(\\boldsymbol{k})$。\n离散斯托克斯方程变为关于振幅的代数方程：\n$$ \\widehat{-L_u}(\\boldsymbol{k}) \\hat{\\boldsymbol{u}} + \\hat{G}(\\boldsymbol{k}) \\hat{p} = \\lambda_h \\hat{\\boldsymbol{u}}, \\quad \\hat{D}(\\boldsymbol{k}) \\hat{\\boldsymbol{u}} = 0 $$\n其中 $\\hat{G}$ 和 $\\hat{D}$ 是梯度和散度算子的符号。\n由于离散拉普拉斯算子与散度算子可交换（$L_u D = D L_u$），如果一个速度场 $\\boldsymbol{u}$ 是无散的，那么 $-L_u \\boldsymbol{u}$ 也是无散的。这意味着离散无散子空间在 $-L_u$ 作用下是不变的。因此，分析特征值时不需要亥姆霍兹-霍奇投影算子 $P$；它在特征向量上充当单位算子。特征问题简化为寻找 $-L_u$ 在离散无散子空间上的限制的特征值。\n因此，对于一个非平凡的无散征模 $\\hat{\\boldsymbol{u}} \\neq 0$，特征值直接由 $-L_u$ 的符号给出：\n$$ \\lambda_h(\\boldsymbol{k}) = \\widehat{-L_u}(\\boldsymbol{k}) $$\n\n### 3. 特征值误差表达式\n\n在环面 $[0,1]^2$ 上的连续斯托克斯特征值问题具有特征对 $(\\boldsymbol{u}, p, \\lambda)$，其中对于整数波向量 $\\boldsymbol{k}=(k_x, k_y) \\neq (0,0)$，有 $\\boldsymbol{u}(\\boldsymbol{x}) = \\hat{\\boldsymbol{u}} e^{i2\\pi\\boldsymbol{k}\\cdot\\boldsymbol{x}}$ 和 $p(\\boldsymbol{x})=\\hat{p}e^{i2\\pi\\boldsymbol{k}\\cdot\\boldsymbol{x}}$。代入连续方程可得 $\\lambda(\\boldsymbol{k}) = (2\\pi |\\boldsymbol{k}|)^2 = 4\\pi^2(k_x^2+k_y^2)$，其中 $\\boldsymbol{k}\\cdot\\hat{\\boldsymbol{u}}=0$ 且 $\\hat{p}=0$。\n\n在 $N \\times N$ 网格上，对应波向量 $\\boldsymbol{k}$ 的离散特征值为：\n$$ \\lambda_h(\\boldsymbol{k}; N) = \\frac{4}{h^2}\\left(\\sin^2(\\pi k_x h) + \\sin^2(\\pi k_y h)\\right) = 4N^2\\left(\\sin^2\\left(\\frac{\\pi k_x}{N}\\right) + \\sin^2\\left(\\frac{\\pi k_y}{N}\\right)\\right) $$\n绝对特征值误差 $e_h(\\boldsymbol{k};N)$ 是连续特征值与离散特征值之差：\n$$ e_h(\\boldsymbol{k};N) = |\\lambda(\\boldsymbol{k}) - \\lambda_h(\\boldsymbol{k};N)| = \\left| 4\\pi^2(k_x^2+k_y^2) - 4N^2\\left(\\sin^2\\left(\\frac{\\pi k_x}{N}\\right) + \\sin^2\\left(\\frac{\\pi k_y}{N}\\right)\\right) \\right| $$\n$\\sin^2(x)$ 的泰勒级数展开为 $x^2 - x^4/3 + O(x^6)$。对于小的 $h = 1/N$，误差表现为：\n$$ e_h(\\boldsymbol{k};N) \\approx \\left| 4\\pi^2|\\boldsymbol{k}|^2 - 4N^2\\left( \\frac{\\pi^2|\\boldsymbol{k}|^2}{N^2} - \\frac{\\pi^4(k_x^4+k_y^4)}{3N^4} \\right) \\right| = \\frac{4\\pi^4(k_x^4+k_y^4)}{3N^2} + O(N^{-4}) $$\n这表明特征值近似是二阶精确的，即 $e_h \\propto h^2$。\n\n### 4. 观测收敛阶\n\n理论上的二阶精度可以通过计算两个网格分辨率 $N$ 和 $2N$ 之间的观测收敛阶 $p_{\\mathrm{obs}}$ 来进行数值验证。假设误差形式为 $e_h \\approx C h^p = C N^{-p}$，我们有：\n$$ \\frac{e_h(\\boldsymbol{k};N)}{e_h(\\boldsymbol{k};2N)} \\approx \\frac{C N^{-p}}{C (2N)^{-p}} = 2^p $$\n对两边取对数，得到观测阶的公式：\n$$ p_{\\mathrm{obs}} = \\frac{\\log\\left(e_h(\\boldsymbol{k};N) / e_h(\\boldsymbol{k};2N)\\right)}{\\log(2)} $$\n根据误差分析，我们期望 $p_{\\mathrm{obs}} \\approx 2$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import eigsh\n\ndef construct_Lp(N):\n    \"\"\"\n    Constructs the discrete pressure Laplacian matrix Lp = D @ G\n    for a periodic N x N grid.\n    \n    The function first builds the discrete gradient (G) and divergence (D)\n    matrices based on the staggered MAC grid definitions and then computes\n    their product. This is equivalent to constructing the 5-point\n    finite-difference Laplacian on the pressure grid.\n    \"\"\"\n    N_sq = N * N\n    h = 1.0 / N\n\n    # G: maps N^2 pressures to 2N^2 velocities (Nx, Ny components)\n    G = lil_matrix((2 * N_sq, N_sq), dtype=np.float64)\n    # D: maps 2N^2 velocities to N^2 pressures\n    D = lil_matrix((N_sq, 2 * N_sq), dtype=np.float64)\n\n    for j in range(N):\n        for i in range(N):\n            # Lexicographical indices\n            p_idx = i + j * N\n            \n            # neighbor indices with periodicity\n            ip1 = (i + 1) % N\n            im1 = (i - 1 + N) % N\n            jp1 = (j + 1) % N\n            jm1 = (j - 1 + N) % N\n\n            p_idx_ip1 = ip1 + j * N\n            p_idx_jp1 = i + jp1 * N\n\n            # --- Construct G (Gradient) ---\n            # G maps pressure at cell centers to velocities at face centers\n            # (Gp)_x at face (i+1/2, j)\n            ux_idx_G = i + j * N\n            G[ux_idx_G, p_idx_ip1] = 1.0 / h\n            G[ux_idx_G, p_idx] = -1.0 / h\n            \n            # (Gp)_y at face (i, j+1/2)\n            uy_idx_G = N_sq + i + j * N\n            G[uy_idx_G, p_idx_jp1] = 1.0 / h\n            G[uy_idx_G, p_idx] = -1.0 / h\n\n            # --- Construct D (Divergence) ---\n            # D maps velocities at face centers to pressures at cell centers\n            # (Du) at cell (i, j)\n            # Contribution from u_x at faces (i+1/2,j) and (i-1/2,j)\n            ux_idx_plus = i + j*N        # Corresponds to face (i+1/2, j)\n            ux_idx_minus = im1 + j*N     # Corresponds to face (i-1/2, j)\n            D[p_idx, ux_idx_plus] = 1.0 / h\n            D[p_idx, ux_idx_minus] = -1.0 / h\n\n            # Contribution from u_y at faces (i,j+1/2) and (i,j-1/2)\n            uy_idx_plus = N_sq + i + j*N     # Corresponds to face (i, j+1/2)\n            uy_idx_minus = N_sq + i + jm1*N  # Corresponds to face (i, j-1/2)\n            D[p_idx, uy_idx_plus] = 1.0 / h\n            D[p_idx, uy_idx_minus] = -1.0 / h\n            \n    # Convert to CSC format for efficient matrix multiplication\n    G_csc = G.tocsc()\n    D_csc = D.tocsc()\n\n    Lp = D_csc @ G_csc\n    return Lp\n\ndef check_stability_and_compute_error(N_k_pair):\n    \"\"\"\n    Computes eigenvalue error and checks for spurious pressure modes.\n    \n    k: wave vector tuple (kx, ky)\n    N: grid resolution\n    \n    Returns: A tuple (error, stability_boolean)\n    \"\"\"\n    N, k = N_k_pair\n    kx, ky = k\n\n    # Construct Lp and check for spurious modes\n    Lp = construct_Lp(N)\n    # Get 5 algebraically smallest eigenvalues. For Lp = -G*G, these are the\n    # most negative ones. One should be 0, the rest negative.\n    try:\n        # For small N, eigsh might require k  matrix_size\n        num_eigs_to_check = min(5, N*N - 1)\n        eigenvalues = eigsh(Lp, k=num_eigs_to_check, which='SA', return_eigenvectors=False)\n        num_zero_eigs = np.sum(np.abs(eigenvalues)  1e-8)\n        is_stable = (num_zero_eigs == 1)\n    except Exception:\n        # Fallback for very small N or other issues\n        is_stable = False\n    \n    # Calculate eigenvalue error\n    lambda_exact = 4.0 * np.pi**2 * (kx**2 + ky**2)\n    \n    h = 1.0 / N\n    sin_term_x = np.sin(np.pi * kx * h)\n    sin_term_y = np.sin(np.pi * ky * h)\n    lambda_h = (4.0 / h**2) * (sin_term_x**2 + sin_term_y**2)\n    \n    error = np.abs(lambda_exact - lambda_h)\n    \n    return error, is_stable\n\ndef solve():\n    \"\"\"\n    Main solver function to run test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (8, (1, 1)),   # Case 1\n        (16, (1, 1)),  # Case 2\n        (32, (1, 1)),  # Case 3\n        (16, (2, 1)),  # Case 4\n    ]\n\n    results = []\n    errors = {}\n\n    for i, case in enumerate(test_cases):\n        N, k = case\n        err, stable = check_stability_and_compute_error(case)\n        results.extend([err, stable])\n        \n        # Store errors for p_obs calculation\n        # The key is a string representation to be dictionary-friendly\n        errors[str(case)] = err\n\n    # Case 5: Observed order p_obs\n    k_pobs = (1, 1)\n    N1 = 16\n    N2 = 32\n    \n    e1 = errors[str((N1, k_pobs))]\n    e2 = errors[str((N2, k_pobs))]\n    \n    # With h2 = h1/2, the ratio of resolutions is 2\n    ratio_N = float(N2) / N1\n    p_obs = np.log(e1 / e2) / np.log(ratio_N)\n    \n    results.append(p_obs)\n\n    # Final print statement in the exact required format.\n    print(f\"[{results[0]},{str(results[1]).lower()},{results[2]},{str(results[3]).lower()},{results[4]},{str(results[5]).lower()},{results[6]},{str(results[7]).lower()},{results[8]}]\")\n\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}