## 引言
在[偏微分方程](@entry_id:141332)的数值求解领域，寻找既精确又灵活的方法是持续的追求。传统连续有限元方法虽然强大，但其全局连续性要求在处理复杂几何、[对流](@entry_id:141806)主导问题和局部[自适应加密](@entry_id:746260)时面临挑战。间断伽辽金（Discontinuous Galerkin, DG）方法应运而生，它通过允许解在单元边界上存在间断，突破了这一限制，为数值模拟提供了一种极具潜力的[范式](@entry_id:161181)。这种独特的间断性赋予了[DG方法](@entry_id:748369)无与伦比的局部灵活性，但同时也引出了一个核心问题：如何在一个不连续的[函数空间](@entry_id:143478)中构建稳定且收敛的数值格式？

本文旨在系统性地回答这一问题，并全面介绍间断伽辽金多项式空间。我们将分为三个部分展开：在“原理与机制”中，我们将深入探讨构成[DG方法](@entry_id:748369)基础的[破碎函数空间](@entry_id:746988)、跳跃算子和[数值通量](@entry_id:752791)等核心概念；接着，在“应用与跨学科联系”中，我们将展示DG方法在求解各类[偏微分方程](@entry_id:141332)中的实际威力，并探索其与机器学习等前沿领域的深刻联系；最后，“动手实践”部分将通过具体问题，帮助读者巩固理论知识。通过这趟旅程，读者将不仅理解[DG方法](@entry_id:748369)的“如何做”，更能领会其“为什么”如此设计，从而掌握这一强大的计算工具。

## 原理与机制

在[偏微分方程](@entry_id:141332)的数值求解中，间断伽辽金（Discontinuous Galerkin, DG）方法提供了一个强大而灵活的框架，它结合了[有限元法](@entry_id:749389)和有限体积法的优点。与强制解在整个求解域上连续的传统（连续）有限元方法不同，DG方法允许解在单元边界上存在间断。这种局部性赋予了[DG方法](@entry_id:748369)独特的属性，但也要求我们发展新的机制来确保单元之间的信息能够正确传递。本章将深入探讨构成[DG方法](@entry_id:748369)核心的基本原理和关键机制。

### 基本定义：[破碎函数空间](@entry_id:746988)

DG方法的基础是一种特殊的[函数空间](@entry_id:143478)，它由分片多项式构成，但没有跨单元的连续性约束。为了精确描述这个空间及其分析环境，我们需要引入几个核心概念。

首先，我们考虑一个有界Lipschitz区域 $\Omega \subset \mathbb{R}^d$，它被一个**网格** $\mathcal{T}_h$ 剖分。该网格由不重叠的开单元 $K$ 组成，满足 $\overline{\Omega} = \bigcup_{K \in \mathcal{T}_h} \overline{K}$。为了保证[数值方法的稳定性](@entry_id:165924)和收敛性，我们通常要求网格是**形状规则**（shape-regular）的。一个网格族被称为形状规则的，是指存在一个与网格尺寸 $h := \max_{K \in \mathcal{T}_h} h_K$ 无关的常数 $C_{\mathrm{sr}} \ge 1$，使得对于族中的任意单元 $K$，其直径 $h_K$ 与其最大内切球半径 $\rho_K$ 的比值都有上界，即 $h_K / \rho_K \le C_{\mathrm{sr}}$。这个几何条件防止了单元在网格加密过程中变得过于“扁平”或“细长”，这对于保证某些关键不等式（如[迹不等式](@entry_id:756082)和[逆不等式](@entry_id:750800)）的常数不依赖于 $h$ 至关重要。

在这样的网格上，我们可以定义**间断伽辽金[多项式空间](@entry_id:144410)** $V_h$。对于一个给定的非负整数多项式次数 $p$，该空间定义为：
$$
V_h = \{ v \in L^2(\Omega) : v|_K \in \mathbb{P}_p(K) \ \forall K \in \mathcal{T}_h \}
$$
其中 $L^2(\Omega)$ 是 $\Omega$ 上的[平方可积函数](@entry_id:200316)空间，而 $\mathbb{P}_p(K)$ 表示在单元 $K$ 上总次数至多为 $p$ 的[多项式空间](@entry_id:144410)。此定义的核心在于，函数 $v \in V_h$ 仅被要求全局上是平方可积的，而在每个单元 $K$ 内部，它是次数不超过 $p$ 的多项式。定义中没有施加任何跨单元边界的连续性要求。

由于 $V_h$ 中的函数在单元间可能是间断的，它们通常不属于具有全局可微性定义的标准[索博列夫空间](@entry_id:141995) $H^s(\Omega)$（当 $s \ge 1$ 时）。因此，为了分析DG方法，我们引入**破碎[索博列夫空间](@entry_id:141995)**（broken Sobolev space） $H^s(\mathcal{T}_h)$。对于 $s \ge 0$，该空间定义为：
$$
H^s(\mathcal{T}_h) := \{ v \in L^2(\Omega) : v|_K \in H^s(K) \ \forall K \in \mathcal{T}_h \}
$$
它包含所有在每个单元 $K$ 上的限制都属于标准[索博列夫空间](@entry_id:141995) $H^s(K)$ 的函数。该空间通常配备范数 $\| v \|_{H^s(\mathcal{T}_h)}^2 := \sum_{K \in \mathcal{T}_h} \| v \|_{H^s(K)}^2$。由于在任何单元 $K$ 上，多项式都是无穷次可微的，因此它的限制 $v|_K$ 属于任意阶的 $H^s(K)$。这意味着DG空间 $V_h$ 是任何破碎[索博列夫空间](@entry_id:141995) $H^s(\mathcal{T}_h)$ 的[子空间](@entry_id:150286)，即 $V_h \subset H^s(\mathcal{T}_h)$ 对任意 $s \ge 0$ 成立。

### 间断性的本质：与连续方法的对比

DG空间最显著的特征是其间断性。为了充分理解这一点，我们可以将其与标准的**连续伽辽金（Conforming Galerkin, CG）有限元空间** $V_h^{C^0}$ 进行对比。$V_h^{C^0}$ 通常定义为 $V_h^{C^0} := \{ v \in H^1(\Omega) : v|_K \in \mathbb{P}_p(K) \ \forall K \in \mathcal{T}_h \}$。$H^1(\Omega)$ 的要求隐含了函数在整个区域 $\Omega$ 上是连续的（更准确地说是$C^0$连续的）。这种连续性约束导致了两种方法在理论和实践上的深刻差异。

#### 自由度与空间维度

在CG方法中，为了保证全局连续性，相邻单元必须共享位于其公共边界（如顶点、边或面）上的自由度（Degrees of Freedom, DoFs）。例如，一个顶点的节点值被所有共享该顶点的单元共用。这种共享减少了全局未知量的总数。

相比之下，DG方法中没有这样的共享机制。每个单元的自由度完全独立于其邻居。DG空间 $V_h$ 实际上是定义在每个单元上的局部[多项式空间](@entry_id:144410)的**直和**：
$$
V_h = \bigoplus_{K \in \mathcal{T}_h} V(K)
$$
其中 $V(K)$ 是单元 $K$ 上的局部多项式空间。因此，全局DG空间的维度就是所有局部空间维度之和：
$$
\dim V_h = \sum_{K \in \mathcal{T}_h} \dim V(K)
$$
例如，考虑一个由 $N_T$ 个三角形和 $N_Q$ 个四边形组成的二维网格。若在三角形上使用总次数为 $p$ 的多项式空间 $\mathbb{P}_p$（维度为 $\frac{(p+1)(p+2)}{2}$），在四边形上使用张量积[多项式空间](@entry_id:144410) $\mathbb{Q}_p$（维度为 $(p+1)^2$），则DG空间的总维度为：
$$
\dim V_h = N_T \cdot \frac{(p+1)(p+2)}{2} + N_Q \cdot (p+1)^2
$$
在一个具体的例子中，对于一个由 $N_T=58$ 个三角形和 $N_Q=17$ 个四边形组成的网格，如果使用 $p=4$ 的多项式，$\mathbb{P}_4$ 的维度是 $15$，$\mathbb{Q}_4$ 的维度是 $25$。该DG空间的总自由度数就是 $58 \times 15 + 17 \times 25 = 870 + 425 = 1295$。这清晰地表明，DG空间的自由度数量完全是局部自由度的简单累加，这与CG方法通过共享节点来减少全局自由度数的做法截然不同。

#### 矩阵结构

自由度的局部性直接决定了离散系统所产生的矩阵的结构。

- **质量矩阵**：对于DG方法，全局[质量矩阵](@entry_id:177093) $M$ 的元素为 $M_{ij} = \int_{\Omega} \phi_i \phi_j \, dx$，其中 $\{\phi_i\}$ 是 $V_h$ 的一组[基函数](@entry_id:170178)。一个关键特性是，DG的[基函数](@entry_id:170178)具有局部支撑，每个[基函数](@entry_id:170178) $\phi_i$ 的支撑集仅限于单个单元 $K_i$。因此，如果两个[基函数](@entry_id:170178) $\phi_i$ 和 $\phi_j$ 对应于不同的单元（$K_i \neq K_j$），它们的乘积在整个区域上恒为零，导致 $M_{ij} = 0$。结果是，全局质量矩阵是**块对角**的，每个对角块是对应单元的局部质量矩阵。
$$
M = \begin{pmatrix} M_{K_1} & 0 & \dots & 0 \\ 0 & M_{K_2} & \dots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \dots & M_{K_N} \end{pmatrix}
$$
这种结构在计算上极为有利，尤其是在求解时间相关的演化问题时，因为[块对角矩阵](@entry_id:145530)的[逆矩阵](@entry_id:140380)可以非常高效地计算。

- **刚度矩阵**：对于包含导数的算子（如拉普拉斯算子或[对流](@entry_id:141806)算子），离散化后得到的“刚度”矩阵则表现出不同的结构。单元间的耦合不是通过共享自由度产生的，而是通过**单元界面上的积分**。这些积分项，即所谓的**[数值通量](@entry_id:752791)**，将相邻单元的[解耦](@entry_id:637294)合起来。因此，[刚度矩阵](@entry_id:178659)的稀疏模式遵循网格单元的邻接关系：仅当两个单元 $K_i$ 和 $K_j$ 共享一个公共面时，对应的矩阵块 $A_{ij}$ 才可能为非零。这种结构被称为**单元块稀疏**（element-block sparse）。由于DG的[变分形式](@entry_id:166033)中只包含单元[体积分](@entry_id:171119)和 codimension-1 的[面积分](@entry_id:275394)（即面积分），而更高[余维](@entry_id:273141)度的几何实体（如三维中的边、二维中的顶点）在这些积分中测度为零，因此[DG方法](@entry_id:748369)中不存在仅通过顶点或边相连的单元之间的直接耦合。

### 单元间通信：跳跃、平均与[数值通量](@entry_id:752791)

既然DG函数是间断的，我们必须建立一种机制来让相邻单元“对话”，并以一种一致和稳定的方式传递信息。这是通过在单元界面上定义**跳跃（jump）**和**平均（average）**算子，并利用它们构造**[数值通量](@entry_id:752791)（numerical flux）**来实现的。

考虑一个内部面 $F \in \mathcal{F}_h^i$，它由两个相邻单元 $K^+$ 和 $K^-$ 共享，$F = \partial K^+ \cap \partial K^-$。设 $\boldsymbol{n}^+$ 和 $\boldsymbol{n}^-$ 分别是 $K^+$ 和 $K^-$ 在 $F$ 上的单位外法向量，因此 $\boldsymbol{n}^- = -\boldsymbol{n}^+$。对于一个标量函数 $u \in V_h$，我们用 $u^+$ 和 $u^-$ 表示其从 $K^+$ 和 $K^-$ 内部趋近于 $F$ 的迹（trace）。基于这些量，我们定义（向量）**跳跃**和（标量）**平均**算子：
$$
[u] := u^+ \boldsymbol{n}^+ + u^- \boldsymbol{n}^-
$$
$$
\{u\} := \frac{u^+ + u^-}{2}
$$
这些算子具有一些重要的性质。例如，跳跃算子的定义与标签 $+$ 和 $-$ 的选择无关。如果函数 $u$ 恰好在面 $F$ 上是连续的，即 $u^+ = u^-$，那么它的跳跃为零向量 $[u] = \boldsymbol{0}$，而其平均值就是它在该面上的值 $\{u\} = u$。对于边界上的面，这些定义通常会做一些适应性修改，以统一处理内部面和边界面的公式。

这些算子是构造[数值通量](@entry_id:752791)的基石。数值通量是一个定义在界面上的函数，它近似于真实物理通量，并依赖于界面两侧的解的状态。[数值通量](@entry_id:752791)的设计是[DG方法](@entry_id:748369)的核心，因为它直接决定了方法的稳定性、精度和守恒性。

#### 双曲问题：[对流](@entry_id:141806)方程的例子

考虑一维线性[对流](@entry_id:141806)方程 $u_t + a u_x = 0$（其中 $a>0$）。一个简单的[DG格式](@entry_id:178043)（分片常数）的半离散形式为 $\frac{d u_j}{dt} = -\frac{1}{h}(F_{j+1/2} - F_{j-1/2})$，其中 $u_j$ 是单元 $j$ 上的解， $F$ 是[数值通量](@entry_id:752791)。让我们比较两种常见的通量选择：

- **[中心通量](@entry_id:747204) (Central Flux)**: $F^{\mathrm{cen}}(u^-, u^+) = \frac{a}{2}(u^- + u^+)$。这个通量是对两侧状态的简单平均。
- **[迎风通量](@entry_id:143931) (Upwind Flux)**: $F^{\mathrm{up}}(u^-, u^+) = a u^-$（因为 $a>0$）。这个通量只选择上游（迎风面）的解的状态。

通过对离散能量 $E^n = \frac{h}{2}\sum_j (u_j^n)^2$ 的演化进行分析可以发现，当使用[显式欧拉法](@entry_id:141307)进行时间离散时，[中心通量](@entry_id:747204)格式对于任何非零的时间步长都是无条件不稳定的（能量会增长）。而[迎风通量](@entry_id:143931)格式则引入了必要的[数值耗散](@entry_id:168584)，在[CFL条件](@entry_id:178032) $r = \frac{a \Delta t}{h} \le 1$ 下是能量稳定的（能量不增）。这个经典的例子凸显了数值通量设计的重要性：一个看似合理的选择（[中心通量](@entry_id:747204)）可能导致灾难性的不稳定，而一个考虑了[物理信息](@entry_id:152556)传播方向的选择（[迎风通量](@entry_id:143931)）则能保证稳定性。

#### [椭圆问题](@entry_id:146817)：[扩散方程](@entry_id:170713)的例子

对于[二阶椭圆问题](@entry_id:754613)，如扩散方程 $-\nabla \cdot (\kappa \nabla u) = f$，[DG格式](@entry_id:178043)的推导始于在每个单元上进行分部积分。这会产生单元[体积分](@entry_id:171119)和边界积分。由于解的间断性，边界上的通量 $\kappa \nabla u$ 是双值的。数值通量被引入来替代这个双值通量，从而将相邻单元耦合起来。

**内部罚分（Interior Penalty, IP）**方法是处理此类问题的一类流行[DG方法](@entry_id:748369)。其双线性形式 $a_h(u,v)$ 通常包含三部分：
1.  单元[体积分](@entry_id:171119)：$\sum_K \int_K \kappa \nabla u \cdot \nabla v \, dx$
2.  一致性项：耦合通量的平均值和解的跳跃，如 $-\int_F \{\kappa \nabla u\} \cdot [v] \, dS$。这些项确保当真解足够光滑时，[DG格式](@entry_id:178043)能还原为原始方程的[弱形式](@entry_id:142897)。
3.  罚函数项：惩罚解在界面上的跳跃，如 $\int_F \frac{\sigma_F \kappa}{h_F} [u] \cdot [v] \, dS$。此项强制解在弱意义下趋向于连续，对方法的稳定性至关重要。

通过在一个一致性项中选择不同的符号，可以得到几种经典的IP方法变体：

- **[对称内部罚](@entry_id:755719)分[伽辽金法](@entry_id:749698) (SIPG)**: 
$$
a_h(u,v) = \sum_{K} \int_K \kappa \nabla u \cdot \nabla v - \sum_{F} \int_F \Big( \{\kappa \nabla u\} \cdot [v] + \{\kappa \nabla v\} \cdot [u] \Big) + \sum_{F} \int_F \frac{\sigma_F \kappa}{h_F} [u] \cdot [v]
$$
该形式是对称的，但其[矫顽性](@entry_id:159399)（coercivity）依赖于罚参数 $\sigma_F$ 足够大。

- **非[对称内部罚](@entry_id:755719)分[伽辽金法](@entry_id:749698) (NIPG)**:
$$
a_h(u,v) = \sum_{K} \int_K \kappa \nabla u \cdot \nabla v - \sum_{F} \int_F \{\kappa \nabla u\} \cdot [v] + \sum_{F} \int_F \{\kappa \nabla v\} \cdot [u] + \sum_{F} \int_F \frac{\sigma_F \kappa}{h_F} [u] \cdot [v]
$$
该形式是非对称的，但其一个显著优点是对于任意正的罚参数 $\sigma_F > 0$ 都是无条件矫顽的。

- **不完全内部罚分[伽辽金法](@entry_id:749698) (IIPG)**:
$$
a_h(u,v) = \sum_{K} \int_K \kappa \nabla u \cdot \nabla v - \sum_{F} \int_F \{\kappa \nabla u\} \cdot [v] + \sum_{F} \int_F \frac{\sigma_F \kappa}{h_F} [u] \cdot [v]
$$
该形式也是非对称的，且像SIPG一样，其[矫顽性](@entry_id:159399)也需要足够大的罚参数。

这些变体在对称性、稳定性机制和[收敛性分析](@entry_id:151547)方面各有权衡，为不同的应用场景提供了选择。

### 实践考虑与高级主题

#### [基函数](@entry_id:170178)与数值积分

在实现[DG方法](@entry_id:748369)时，[局部基](@entry_id:151573)函数的选择和[数值积分](@entry_id:136578)的精度是两个关键问题。

- **[基函数](@entry_id:170178)的选择**:
    - 如果我们选择一组在**[加权内积](@entry_id:163877)** $\int_K u v \, dV$ 下**正交**的[局部基](@entry_id:151573)函数（例如，经过[Gram-Schmidt正交化](@entry_id:143035)处理的勒让德多项式），那么局部[质量矩阵](@entry_id:177093) $M^K$ 将自然地成为一个**[对角矩阵](@entry_id:637782)**。对于仿射单元，如果[参考单元](@entry_id:168425)上的[基函数](@entry_id:170178)是正交的，那么物理单元上的[质量矩阵](@entry_id:177093)将是一个与[雅可比行列式](@entry_id:137120)相关的对角阵。
    - 另一种实现[对角化](@entry_id:147016)质量矩阵的流行技术是**[质量集中](@entry_id:175432)**（mass lumping）。通过选择一组特殊的**[节点基](@entry_id:752522)函数**（如[拉格朗日基](@entry_id:751105)函数），其节点与[高斯求积](@entry_id:146011)点重合，离散质量矩阵 $(M_h^K)_{ij} = \sum_m w_m \phi_i(x_m) \phi_j(x_m)$ 会因为[基函数](@entry_id:170178)的插值属性 $\phi_i(x_j) = \delta_{ij}$ 而自动变成对角矩阵。其对角元正比于[求积权重](@entry_id:753910) $w_i$ 和雅可比行列式在节点的值 $J_K(x_i)$。[对角化](@entry_id:147016)的[质量矩阵](@entry_id:177093)对于使用[显式时间积分](@entry_id:165797)方法求解[演化方程](@entry_id:268137)至关重要，因为它极大地简化了每个时间步的求解过程。

- **数值积分精度**:
    双线性形式 $a_h(u,v)$ 中的每个积分项都是多项式，因此原则上可以通过足够高阶的[求积公式](@entry_id:753909)精确计算。为了保证方法的稳定性和最优[收敛阶](@entry_id:146394)，精确积分是必要的。通过分析SIPG格式中各项的被积函数的多项式次数，我们可以确定所需的最低求积精度：
    - **[体积分](@entry_id:171119)**: 项 $\int_K \nabla u_h \cdot \nabla v_h$ 的被积函数次数最高为 $(p-1)+(p-1) = 2p-2$。
    - **面积分**: [罚函数](@entry_id:638029)项 $\int_F [u_h][v_h]$ 的被积函数次数最高为 $p+p=2p$。
    因此，对于仿射单元上的 $p$ 次DG方法，要精确计算SIPG的[双线性形式](@entry_id:746794)，体积[求积公式](@entry_id:753909)需要至少对 $2p-2$ 次多项式精确，而[面积分](@entry_id:275394)求积公式则需要对 $2p$ 次多项式精确。如果使用**欠积分**（under-integration），例如[面积分](@entry_id:275394)只对 $2p-1$ 次多项式精确，可能会导致罚函数项的强度被削弱，从而破坏方法的稳定性（[矫顽性](@entry_id:159399)）并降低收敛精度。

#### 强大的灵活性：[非协调网格](@entry_id:752550)与$hp$自适应

[DG方法](@entry_id:748369)最吸引人的优点之一是其处理复杂几何和实现[自适应加密](@entry_id:746260)的非凡灵活性。

- **[非协调网格](@entry_id:752550)与[悬挂节点](@entry_id:149024)**:
    在CG方法中，网格必须是**协调的**，即一个单元的面不能是另一个单元面的部分。这限制了局部[网格加密](@entry_id:168565)的自由度，因为处理由此产生的“[悬挂节点](@entry_id:149024)”需要复杂的约束方程来维持全局连续性。
    [DG方法](@entry_id:748369)完全没有这个问题。由于单元间不存在连续性要求，一个粗单元的面可以自然地与多个细单元的面相邻。单元间的通信完全通过定义在每个子面上的数值通量来处理。这使得实现具有[悬挂节点](@entry_id:149024)的**局部[网格自适应](@entry_id:751899)（$h$-adaptivity）**变得异常简单和高效。

- **多项式次数自适应（$p$-adaptivity）**:
    类似地，DG方法允许在不同单元上使用不同次数的多项式（$p_K$ 可变）。在粗细单元或不同多项式次数的单元交界面上，[数值通量](@entry_id:752791)自然地“协调”了这种不匹配。例如，[迎风通量](@entry_id:143931)只是简单地从两侧的迹函数中选择一个，而IP方法的通量则接受两个不同次数的多项式作为输入来计算跳跃和平均。这种固有的灵活性使得实现**$hp$-自适应**——同时进行网格加密和提升多项式次数——比在CG框架下要直接得多。

- **$hp$自适应下的稳定性**:
    当使用$hp$自适应时，必须小心处理罚参数的尺度。在[SIPG方法](@entry_id:754927)中，为了保证稳定性，罚参数 $\sigma$ 必须足够大以控制来自界面两侧的梯度。理论分析表明，在非协调界面上，罚参数应与 $\max\{ p_-^2 / h_-, \, p_+^2 / h_+ \}$ 成正比，其中 $(p_-, h_-)$ 和 $(p_+, h_+)$ 分别是界面两侧单元的多项式次数和尺寸。选择两者中的最大值是为了确保罚分足以控制来自更具挑战性一侧（通常是 $p$ 更高或 $h$ 更小的一侧）的项，从而保证整个格式的稳定性。

总之，间断伽辽金空间通过放弃全局连续性，换来了无与伦比的局部灵活性和计算优势。通过精心设计的[数值通量](@entry_id:752791)机制，它能够在完全不连续的函数空间上构建出稳定、精确且守恒的数值方法，为求解复杂的[偏微分方程](@entry_id:141332)问题开辟了一条强大的新途径。