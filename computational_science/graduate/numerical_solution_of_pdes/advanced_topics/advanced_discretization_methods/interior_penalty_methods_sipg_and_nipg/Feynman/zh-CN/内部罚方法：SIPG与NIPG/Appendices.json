{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你完成使用对称内罚伽辽金（SIPG）方法离散化一个微分方程的基本过程。我们将从其弱形式出发，将每个项——体积积分、一致性项和罚项——转化为局部刚度矩阵中相应的元素。这项练习对于揭开抽象公式的神秘面纱，并理解它们如何导出一个具体的、可解的线性系统至关重要 。",
            "id": "3410379",
            "problem": "考虑一维扩散问题 $-\\frac{d}{dx}\\left(\\kappa \\frac{du}{dx}\\right)=f$，在周期性区域 $[0,1]$ 上，扩散系数 $\\kappa>0$ 为常数。设该区域被划分为一个由 $N$ 个单元组成的均匀网格，每个单元的长度为 $h=\\frac{1}{N}$。使用分片线性多项式（多项式阶数 $p=1$）的间断 Galerkin (DG) 离散化方法和对称内部罚 Galerkin (SIPG) 方法。用 $\\eta>0$ 表示无量纲罚参数，并设逐面罚项缩放为 $\\tau=\\eta \\frac{\\kappa}{h}$。\n\n在每个单元 $K_e=[x_e,x_{e+1}]$ 上，采用单元节点基，其局部基函数为 $\\phi_{1}(x)=1-\\frac{x-x_e}{h}$ 和 $\\phi_{2}(x)=\\frac{x-x_e}{h}$。对内部面采用标准的 DG 定义：对于由左单元 $K^{-}$ 和右单元 $K^{+}$ 共享的面，取外法线 $n^{-}=+1$ 和 $n^{+}=-1$，跳跃项 $[w]=w^{-}n^{-}+w^{+}n^{+}=w^{-}-w^{+}$，以及平均项 $\\{q\\}=\\frac{1}{2}(q^{-}+q^{+})$。\n\n仅使用 SIPG 双线性形式的基本定义，\n\n$$\na(u,v)=\\sum_{K}\\int_{K}\\kappa\\,u'(x)\\,v'(x)\\,dx-\\sum_{F}\\left(\\{\\kappa u'\\},[v]\\right)_{F}-\\sum_{F}\\left(\\{\\kappa v'\\},[u]\\right)_{F}+\\sum_{F}\\left(\\tau\\,[u],[v]\\right)_{F},\n$$\n\n推导以下内容：\n\n1. 对于任意单元，在基 $\\{\\phi_{1},\\phi_{2}\\}$ 下的显式 $2\\times 2$ 局部单元体积刚度矩阵 $A^{\\mathrm{vol}}$。\n\n2. 耦合单个内部面两侧相邻两个单元的显式 $4\\times 4$ 内部面贡献矩阵 $A^{\\mathrm{face}}$，写成 $2\\times 2$ 分块形式\n\n$$\nA^{\\mathrm{face}}=\\begin{pmatrix}A^{LL} & A^{LR}\\\\ A^{RL} & A^{RR}\\end{pmatrix},\n$$\n\n其中 $A^{LL}$ 和 $A^{RR}$ 分别是单元上（左和右）的 $2\\times 2$ 分块，而 $A^{LR}$ 和 $A^{RL}$ 是 $2\\times 2$ 耦合分块。清楚地指出罚项部分如何进入这些分块。\n\n3. 在周期性边界条件下，组装全局分块循环刚度矩阵，并构建与单元相位为 $\\theta\\in[-\\pi,\\pi)$ 的离散模态相关的 $2\\times 2$ 分块傅里叶符号 $S(\\theta)$。然后计算行列式 $\\det S(\\theta)$ 关于 $\\kappa$、$\\eta$、$h$ 和 $\\theta$ 的闭式表达式。\n\n将最终答案表示为 $\\det S(\\theta)$ 的单个解析表达式。无需四舍五入。",
            "solution": "我们从对称内部罚 Galerkin (SIPG) 双线性形式的定义开始，对于常数扩散系数 $\\kappa$ 的扩散算子：\n\n$$\na(u,v)=\\sum_{K}\\int_{K}\\kappa\\,u'(x)\\,v'(x)\\,dx-\\sum_{F}\\left(\\{\\kappa u'\\},[v]\\right)_{F}-\\sum_{F}\\left(\\{\\kappa v'\\},[u]\\right)_{F}+\\sum_{F}\\left(\\tau\\,[u],[v]\\right)_{F},\n$$\n\n其中对于由左单元 $K^{-}$ 和右单元 $K^{+}$ 共享的内部面，我们使用 $n^{-}=+1$，$n^{+}=-1$，跳跃项 $[w]=w^{-}n^{-}+w^{+}n^{+}=w^{-}-w^{+}$，平均项 $\\{q\\}=\\frac{1}{2}(q^{-}+q^{+})$，以及面罚项 $\\tau=\\eta \\frac{\\kappa}{h}$，其中 $\\eta>0$。\n\n我们取一个均匀网格，其单元为 $K_e=[x_e,x_{e+1}]$，长度为 $h=\\frac{1}{N}$，并在每个单元上使用局部线性节点基，\n\n$$\n\\phi_{1}(x)=1-\\frac{x-x_e}{h},\\qquad \\phi_{2}(x)=\\frac{x-x_e}{h}.\n$$\n\n它们在 $K_e$ 上的导数是常数：\n\n$$\n\\phi_{1}'(x)=-\\frac{1}{h},\\qquad \\phi_{2}'(x)=\\frac{1}{h}.\n$$\n\n\n1. 局部单元体积刚度矩阵。单元体积贡献为\n\n$$\nA^{\\mathrm{vol}}_{ij}=\\int_{K_e}\\kappa\\,\\phi_{i}'(x)\\,\\phi_{j}'(x)\\,dx=\\kappa\\left(\\frac{1}{h^2}\\right)\\int_{x_e}^{x_{e+1}}(\\pm 1)(\\pm 1)\\,dx=\\frac{\\kappa}{h}\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}_{ij}.\n$$\n\n因此，\n\n$$\nA^{\\mathrm{vol}}=\\frac{\\kappa}{h}\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}.\n$$\n\n\n2. 单个面上的内部面贡献矩阵。考虑一个位于 $x=x_i$ 处的内部面，它在左单元 $K^{-}$ 和右单元 $K^{+}$ 之间。我们在基 $\\{\\phi_{1}^{-},\\phi_{2}^{-},\\phi_{1}^{+},\\phi_{2}^{+}\\}$ 中构建 $4\\times 4$ 的面矩阵，并将其分组为 $2\\times 2$ 的分块形式\n\n$$\nA^{\\mathrm{face}}=\\begin{pmatrix}A^{LL} & A^{LR}\\\\ A^{RL} & A^{RR}\\end{pmatrix},\n$$\n\n其中上标表示左（L）或右（R）单元。\n\n我们需要面上的迹和单元导数：\n\n$$\n\\phi_{1}^{-}(x_i)=0,\\quad \\phi_{2}^{-}(x_i)=1,\\quad \\phi_{1}^{+}(x_i)=1,\\quad \\phi_{2}^{+}(x_i)=0,\n$$\n\n\n$$\n(\\phi_{1}^{-})'=-\\frac{1}{h},\\quad (\\phi_{2}^{-})'=\\frac{1}{h},\\quad (\\phi_{1}^{+})'=-\\frac{1}{h},\\quad (\\phi_{2}^{+})'=\\frac{1}{h}.\n$$\n\n对于每个基函数，其跳跃项和平均导数因子为，对于任何仅在一个单元上具有支撑的测试/试验函数 $w$，其在另一个单元上的迹和导数均为零。因此，定义四个基函数上的跳跃向量和平均导数向量，\n$$\nj=\\begin{pmatrix}[\\phi_{1}^{-}] \\\\ [\\phi_{2}^{-}] \\\\ [\\phi_{1}^{+}] \\\\ [\\phi_{2}^{+}]\\end{pmatrix}\n=\\begin{pmatrix}0\\\\ 1\\\\ -1\\\\ 0\\end{pmatrix},\\qquad\nm=\\begin{pmatrix}\\{\\kappa(\\phi_{1}^{-})'\\} \\\\ \\{\\kappa(\\phi_{2}^{-})'\\} \\\\ \\{\\kappa(\\phi_{1}^{+})'\\} \\\\ \\{\\kappa(\\phi_{2}^{+})'\\}\\end{pmatrix}\n=\\frac{\\kappa}{2h}\\begin{pmatrix}-1\\\\ 1\\\\ -1\\\\ 1\\end{pmatrix}.\n$$\n\n对于试验函数 $\\psi$ 和测试函数 $v$，面双线性形式为\n\n$$\na_{F}(\\psi,v)=-\\{\\kappa \\psi'\\}[v]-\\{\\kappa v'\\}[\\psi]+\\tau[\\psi][v].\n$$\n\n因此，$4\\times 4$ 的面矩阵可以紧凑地写为\n\n$$\nA^{\\mathrm{face}}=-\\,j\\,m^{\\top}-\\,m\\,j^{\\top}+\\tau\\,j\\,j^{\\top}.\n$$\n\n设 $c=\\frac{\\kappa}{2h}$ 和 $\\tau=\\eta\\frac{\\kappa}{h}$，我们通过直接乘法得到四个 $2\\times 2$ 的分块：\n\n$$\nA^{LL}=\\begin{pmatrix}0 & c\\\\ c & -2c+\\tau\\end{pmatrix},\\quad\nA^{LR}=\\begin{pmatrix}-c & 0\\\\ 2c-\\tau & -c\\end{pmatrix},\n$$\n\n\n$$\nA^{RL}=\\begin{pmatrix}-c & 2c-\\tau\\\\ 0 & -c\\end{pmatrix},\\quad\nA^{RR}=\\begin{pmatrix}-2c+\\tau & c\\\\ c & 0\\end{pmatrix}.\n$$\n\n在这些表达式中，罚项部分对应于与 $\\tau\\,j\\,j^{\\top}$ 成比例的秩一更新；具体来说，仅在 $A^{LL}$ 的 $(2,2)$ 项和 $A^{RR}$ 的 $(1,1)$ 项上加上 $\\tau$，并在非对角块 $A^{LR}$ 的 $(2,1)$ 项和 $A^{RL}$ 的 $(1,2)$ 项上减去 $\\tau$（这与外积结构一致）。\n\n3. 全局组装和傅里叶符号。在周期性边界条件下，每个单元将其体积矩阵贡献给对角块，并且单元 $e$（左）和 $e+1$（右）之间的每个内部面将 $A^{LL}$ 贡献给块 $(e,e)$，将 $A^{LR}$ 贡献给块 $(e,e+1)$，将 $A^{RL}$ 贡献给块 $(e+1,e)$，将 $A^{RR}$ 贡献给块 $(e+1,e+1)$。每个单元有两个相邻的面（左和右），因此单元 $e$ 的总对角块为\n\n$$\nK_{0}=A^{\\mathrm{vol}}+A^{LL}+A^{RR}.\n$$\n\n使用 $A^{\\mathrm{vol}}=\\frac{\\kappa}{h}\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}=2c\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}$ 以及 $A^{LL}$ 和 $A^{RR}$ 的表达式，我们发现\n\n$$\nK_{0}=2c\\begin{pmatrix}1 & -1\\\\ -1 & 1\\end{pmatrix}+\\begin{pmatrix}-2c+\\tau & 2c\\\\ 2c & -2c+\\tau\\end{pmatrix}=\\begin{pmatrix}\\tau & 0\\\\ 0 & \\tau\\end{pmatrix}.\n$$\n\n上、下非对角块分别为，\n\n$$\nK_{+1}=A^{LR}=\\begin{pmatrix}-c & 0\\\\ 2c-\\tau & -c\\end{pmatrix},\\qquad\nK_{-1}=A^{RL}=\\begin{pmatrix}-c & 2c-\\tau\\\\ 0 & -c\\end{pmatrix}.\n$$\n\n因此，对于单元相位为 $\\theta$ 的模态，其 $2\\times 2$ 分块傅里叶符号 $S(\\theta)$ 为\n\n$$\nS(\\theta)=K_{0}+K_{+1}\\exp(i\\theta)+K_{-1}\\exp(-i\\theta)=\n\\begin{pmatrix}\n\\tau - c\\left(\\exp(i\\theta)+\\exp(-i\\theta)\\right) & (2c-\\tau)\\exp(-i\\theta)\\\\\n(2c-\\tau)\\exp(i\\theta) & \\tau - c\\left(\\exp(i\\theta)+\\exp(-i\\theta)\\right)\n\\end{pmatrix}.\n$$\n\n使用 $\\exp(i\\theta)+\\exp(-i\\theta)=2\\cos\\theta$，我们重写为\n\n$$\nS(\\theta)=\\begin{pmatrix}\n\\tau-2c\\cos\\theta & (2c-\\tau)\\exp(-i\\theta)\\\\\n(2c-\\tau)\\exp(i\\theta) & \\tau-2c\\cos\\theta\n\\end{pmatrix}.\n$$\n\n一个对角项相等 $a=\\tau-2c\\cos\\theta$ 且非对角项为 $b=(2c-\\tau)\\exp(-i\\theta)$、$\\overline{b}=(2c-\\tau)\\exp(i\\theta)$ 的 $2\\times 2$ 矩阵的行列式为\n\n$$\n\\det S(\\theta)=a^{2}-|b|^{2}=\\left(\\tau-2c\\cos\\theta\\right)^{2}-(2c-\\tau)^{2}.\n$$\n\n代入 $c=\\frac{\\kappa}{2h}$ 和 $\\tau=\\eta\\frac{\\kappa}{h}$ 得到 $2c=\\frac{\\kappa}{h}$ 以及\n\n$$\n\\det S(\\theta)=\\left(\\frac{\\kappa}{h}\\right)^{2}\\left[(\\eta-\\cos\\theta)^{2}-(1-\\eta)^{2}\\right].\n$$\n\n这个表达式可以使用平方差公式进行因式分解：\n\n$$\n(\\eta-\\cos\\theta)^{2}-(1-\\eta)^{2}=\\left((\\eta-\\cos\\theta)-(1-\\eta)\\right)\\left((\\eta-\\cos\\theta)+(1-\\eta)\\right)\n=\\left(2\\eta-1-\\cos\\theta\\right)\\left(1-\\cos\\theta\\right).\n$$\n\n因此，\n\n$$\n\\det S(\\theta)=\\left(\\frac{\\kappa}{h}\\right)^{2}\\left(1-\\cos\\theta\\right)\\left(2\\eta-1-\\cos\\theta\\right).\n$$\n\n这就是所要求的关于 $\\kappa$、$\\eta$、$h$ 和 $\\theta$ 的闭式表达式。",
            "answer": "$$\\boxed{\\left(\\frac{\\kappa}{h}\\right)^{2}\\left(1-\\cos\\theta\\right)\\left(2\\eta-1-\\cos\\theta\\right)}$$"
        },
        {
            "introduction": "现在我们知道了如何构建矩阵，接下来将探索为何罚项是必不可少的。本练习研究一个在标准有限元方法中不允许存在的特定的非物理振荡函数。通过计算它在SIPG形式下的“能量”，你将亲眼看到罚参数如何赋予这种模式巨大的能量，从而有效防止其污染数值解，并确保方法的稳定性 。",
            "id": "3410396",
            "problem": "考虑在一维域 $[0,1]$ 上设定的标量泊松方程 $-u'' = f$，其具有齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。令 $\\mathcal{T}_h$ 是 $[0,1]$ 的一个协调剖分，将其划分为两个相等的子区间（单元），节点位于 $x=0$、$x=1/2$ 和 $x=1$，因此单元尺寸为 $h = 1/2$。令 $V_h$ 为 $\\mathcal{T}_h$ 上的分片常数函数空间，这些函数允许在界面 $x=1/2$ 处不连续。考虑对称内部罚伽辽金 (Symmetric Interior Penalty Galerkin, SIPG) 方法，其中每个面 $e$ 上的内部罚参数取为 $\\sigma/h$（$\\sigma > 0$），并且狄利克雷边界条件通过 Nitsche 方法弱施加。使用标准的间断伽辽金跳跃和平均定义：在内部界面 $x=1/2$ 处，跳跃为 $[u] = u^{-} - u^{+}$，平均为 $\\{u'\\} = (u'^{-} + u'^{+})/2$，其中上标分别表示来自左侧和右侧单元的迹；在边界处，迹 $u$ 取自相邻单元，并使用外法线。\n\n构造振荡离散模式 $u_h \\in V_h$，其在左侧单元 $[0,1/2)$ 上取值为 $u_h(x) = 1$，在右侧单元 $(1/2,1]$ 上取值为 $u_h(x) = -1$。从泊松算子的 SIPG 方法的基本双线性形式以及齐次狄利克雷边界条件的 Nitsche 施加方法出发，推导内部罚能量 $a(u_h,u_h)$——即以 $u_h$ 作为两个参数计算 SIPG 双线性形式的值。您的推导必须从分片梯度、跳跃和平均算子以及罚项缩放的定义出发。最后，对于此 $h = 1/2$ 的网格，提供 $a(u_h,u_h)$ 作为 $\\sigma$ 的函数的封闭解析表达式。\n\n答案格式要求：将 $a(u_h,u_h)$ 报告为仅依赖于 $\\sigma$ 的单个符号表达式。不需要数值舍入。在您的构造和推导中，解释为什么这种振荡模式在连续有限元方法中是不允许的，但在内部罚框架中，当罚不足时其能量可能很小。",
            "solution": "首先验证问题以确保其科学基础扎实、适定且客观。问题陈述描述了对称内部罚伽辽金 (SIPG) 方法在一维泊松方程上的一个标准应用。所有术语，如双线性形式、跳跃和平均算子以及用于边界条件的 Nitsche 方法，都是偏微分方程数值分析领域的标准术语。提供的关于网格、有限元空间和特定函数 $u_h$ 的数据是完整且一致的。因此，该问题被认为是有效的，可以制定解决方案。\n\n对于在 $\\Omega = [0,1]$ 上的泊松问题 $-u'' = f$（在 $\\partial\\Omega$ 上具有齐次狄利克雷边界条件 $u=0$），SIPG 公式旨在寻找一个函数 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$，都有 $a(u_h, v_h) = L(v_h)$。双线性形式 $a(u,v)$ 由下式给出：\n$$\na(u,v) = \\sum_{K \\in \\mathcal{T}_h} \\int_K u' v' \\, dx - \\sum_{e \\in \\mathcal{E}_h^i} \\left( \\{u'\\} [v] + \\{v'\\} [u] \\right)|_e + \\sum_{e \\in \\mathcal{E}_h^i} \\frac{\\sigma}{h_e} [u] [v]|_e - \\sum_{e \\in \\mathcal{E}_h^b} \\left( u' n_K v + v' n_K u \\right)|_e + \\sum_{e \\in \\mathcal{E}_h^b} \\frac{\\sigma}{h_e} u v|_e\n$$\n此处，$\\mathcal{E}_h^i$ 是内部面的集合，$\\mathcal{E}_h^b$ 是边界面的集合。对于我们的具体问题，当 $u=v$ 时，此表达式变为：\n$$\na(u,u) = \\sum_{K \\in \\mathcal{T}_h} \\int_K (u')^2 \\, dx - \\sum_{e \\in \\mathcal{E}_h^i} 2 \\{u'\\} [u]|_e + \\sum_{e \\in \\mathcal{E}_h^i} \\frac{\\sigma}{h_e} [u]^2|_e - \\sum_{e \\in \\mathcal{E}_h^b} 2 u' n_K u|_e + \\sum_{e \\in \\mathcal{E}_h^b} \\frac{\\sigma}{h_e} u^2|_e\n$$\n域 $[0,1]$ 被划分为两个单元，$K_1 = [0, 1/2]$ 和 $K_2 = [1/2, 1]$。单元尺寸为 $h=1/2$。内部面为 $e_i = \\{1/2\\}$，边界面为 $e_{b0} = \\{0\\}$ 和 $e_{b1} = \\{1\\}$。域 $\\Omega$ 的单位外法线在 $x=0$ 处为 $n_K = -1$，在 $x=1$ 处为 $n_K = 1$。\n\n离散函数 $u_h \\in V_h$ 定义为：\n$$\nu_h(x) = \\begin{cases} 1  \\text{for } x \\in K_1 = [0, 1/2] \\\\ -1  \\text{for } x \\in K_2 = (1/2, 1] \\end{cases}\n$$\n由于 $u_h$ 是一个分片常数函数，其在每个单元内的导数为零：对于 $x \\in (0, 1/2)$ 和 $x \\in (1/2, 1)$，$u_h'(x) = 0$。\n\n我们现在计算 $a(u_h, u_h)$ 的每一项：\n\n1.  **体积项**：此项衡量单元内梯度的能量。由于 $u_h'=0$ 几乎处处成立，此项为零。\n    $$\n    \\sum_{K \\in \\mathcal{T}_h} \\int_K (u_h')^2 \\, dx = \\int_{0}^{1/2} (0)^2 \\, dx + \\int_{1/2}^{1} (0)^2 \\, dx = 0\n    $$\n\n2.  **内部面项**：此项在单个内部面 $e_i = \\{1/2\\}$ 处计算。我们首先计算必要的迹、跳跃和平均值。\n    -   来自左侧 ($^-$) 和右侧 ($^+$) 的迹：\n        $$\n        u_h^- = \\lim_{x \\to 1/2^-} u_h(x) = 1\n        $$\n        $$\n        u_h^+ = \\lim_{x \\to 1/2^+} u_h(x) = -1\n        $$\n    -   $u_h$ 的跳跃：\n        $$\n        [u_h]|_{1/2} = u_h^- - u_h^+ = 1 - (-1) = 2\n        $$\n    -   导数的迹：\n        $$\n        (u_h')^- = \\lim_{x \\to 1/2^-} u_h'(x) = 0\n        $$\n        $$\n        (u_h')^+ = \\lim_{x \\to 1/2^+} u_h'(x) = 0\n        $$\n    -   导数的平均值：\n        $$\n        \\{u_h'\\}|_{1/2} = \\frac{(u_h')^- + (u_h')^+}{2} = \\frac{0 + 0}{2} = 0\n        $$\n    内部面的贡献包括一致性/对称性项和罚项。\n    -   一致性/对称性：$- 2 \\{u_h'\\} [u_h]|_{1/2} = -2 \\cdot (0) \\cdot (2) = 0$。\n    -   罚项：$\\frac{\\sigma}{h} [u_h]^2|_{1/2}$。当 $h=1/2$ 时，此项为 $\\frac{\\sigma}{1/2} (2)^2 = 2\\sigma \\cdot 4 = 8\\sigma$。\n    内部面的总贡献为 $0 + 8\\sigma = 8\\sigma$。\n\n3.  **边界项**：这些项在 $e_{b0}=0$ 和 $e_{b1}=1$ 处计算。\n    -   **在 $x=0$ 处**：迹取自单元 $K_1$ 内部。外法线为 $n_K = -1$。\n        -   $u_h$ 的迹：$u_h|_0 = u_h(0^+) = 1$。\n        -   $u_h'$ 的迹：$u_h'|_0 = u_h'(0^+) = 0$。\n        -   贡献为 $-2 u_h' n_K u_h|_0 + \\frac{\\sigma}{h} u_h^2|_0 = -2 \\cdot (0) \\cdot (-1) \\cdot (1) + \\frac{\\sigma}{1/2} (1)^2 = 0 + 2\\sigma = 2\\sigma$。\n    -   **在 $x=1$ 处**：迹取自单元 $K_2$ 内部。外法线为 $n_K = 1$。\n        -   $u_h$ 的迹：$u_h|_1 = u_h(1^-) = -1$。\n        -   $u_h'$ 的迹：$u_h'|_1 = u_h'(1^-) = 0$。\n        -   贡献为 $-2 u_h' n_K u_h|_1 + \\frac{\\sigma}{h} u_h^2|_1 = -2 \\cdot (0) \\cdot (1) \\cdot (-1) + \\frac{\\sigma}{1/2} (-1)^2 = 0 + 2\\sigma = 2\\sigma$。\n    边界面的总贡献为 $2\\sigma + 2\\sigma = 4\\sigma$。\n\n4.  **总内部罚能量**：我们将所有贡献相加。\n    $$\n    a(u_h, u_h) = (\\text{体积项}) + (\\text{内部面项}) + (\\text{边界项})\n    $$\n    $$\n    a(u_h, u_h) = 0 + 8\\sigma + 4\\sigma = 12\\sigma\n    $$\n\n对这一结果的解释如下。在标准的连续有限元方法 (CG-FEM) 中，试探函数和检验函数必须属于索伯列夫空间 $H^1([0,1])$，这要求它们是连续的。函数 $u_h$ 在 $x=1/2$ 处有一个跳跃间断点，因此不属于 $H^1([0,1])$。它在 CG-FEM 空间中根本不是一个可接受的函数，因此是“不被允许的”。\n\n在间断伽辽金 (DG) 框架中，函数空间 $V_h$ 允许此类不连续性。函数 $u_h$ 是分片常数空间的一个有效成员。其由双线性形式 $a(u_h, u_h)$ 度量的“能量”为 $12\\sigma$。由于体项（梯度项）为零，该能量完全来自于内部面和边界面上的罚项。该能量的大小与罚参数 $\\sigma$ 成正比。如果选择一个非常小的 $\\sigma$（这种情况被称为“罚不足”），那么这个高度振荡的模式 $u_h$ 将具有非常小的能量。一个稳定的 DG 方法依赖于足够大的 $\\sigma$ 来确保这类非物理振荡被赋予较大的能量，从而在数值解中有效地抑制它们。存在这样一个能量与 $\\sigma$ 成正比的模式，证明了罚参数在控制单元间跳跃和稳定 DG 方法方面的关键作用。\n\n最终推导出的内部罚能量表达式为 $a(u_h, u_h) = 12\\sigma$。",
            "answer": "$$\\boxed{12\\sigma}$$"
        },
        {
            "introduction": "由于在交界面上重复设置自由度，内罚法会产生大规模的方程组。本练习介绍一种先进的计算效率提升技术——混合化。通过在单元交界面上引入拉格朗日乘子并重构问题，我们可以在代数上消去单元内部的未知数，最终得到一个只包含交界面未知数的、规模更小且更易于管理的系统。这项练习展示了静态凝聚的威力，并有助于深入理解由此产生的舒尔补系统的结构和性质 。",
            "id": "3410430",
            "problem": "考虑单位区间上的一维泊松方程模型问题，即对于 $x \\in (0,1)$，有 $-u''(x) = f(x)$，并带有齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。使用对称内部罚分片伽辽金 (Symmetric Interior Penalty Galerkin, SIPG) 方法的不连续伽辽金框架，并为每个单元设置多项式次数 $p = 1$，以构建离散双线性形式。然后，通过引入代表 $u$ 的单值数值迹的面拉格朗日乘子（每个内面一个标量），来混合 SIPG 方法。凝聚单元内部自由度，并导出仅基于面拉格朗日乘子的舒尔补系统。研究罚参数的选择如何影响此凝聚舒尔补的谱。\n\n从二阶椭圆算子的不连续伽辽金方法的基本定义出发，包括：\n- 包含破碎索伯列夫空间和数值通量的弱形式。\n- 由跨面跳跃 $[\\,\\cdot\\,]$ 和平均 $\\{\\cdot\\}$ 构造的 SIPG 界面项。\n- 每个面上的罚项贡献 $\\sigma/h$，其中 $h$ 是单元尺寸，$\\sigma > 0$ 是罚参数。\n\n在一维空间中，考虑在 $[0,1]$ 上由 $N$ 个单元组成的均匀网格，单元尺寸为 $h = 1/N$。对于每个单元 $E$，使用位于左右端点的局部节点基，从而每个单元产生两个单元内部自由度，记为 $u_L$ 和 $u_R$，并为每个内面引入单个面拉格朗日乘子 $\\lambda$ 来表示混合迹。在混合 SIPG 公式中，可以使用每个面上的数值迹 $\\hat{u}$ 将逐面的 SIPG 项写为逐单元形式：\n$$\n-\\partial_n u_E\\,(v_E - \\hat{v}) - \\partial_n v_E\\,(u_E - \\hat{u}) + \\frac{\\sigma}{h}\\,(u_E - \\hat{u})(v_E - \\hat{v}),\n$$\n其中 $\\partial_n$ 是外法向导数，$u_E, v_E$ 表示试探函数和检验函数在来自单元 $E$ 的面上的值。对于具有齐次狄利克雷数据的边界面，将混合迹设置为边界值，在此问题中为零。\n\n您必须：\n1. 以分块形式组装全局混合 SIPG 系统矩阵\n$$\n\\begin{pmatrix}\nK & B^{\\top} \\\\\nB & C\n\\end{pmatrix},\n$$\n其中 $K$ 耦合单元内部自由度，$B$ 耦合面乘子与单元内部自由度，$C$ 通过罚项耦合面乘子自身。对 $p=1$ 使用单元精确积分，这会产生内部刚度贡献 $\\int_E u' v' \\, dx$ 和上述面项。在一维空间且 $p=1$ 的情况下，基函数的导数在每个单元上是常数，面上的值即为节点自由度。\n2. 执行静态凝聚以消除单元内部自由度，并获得关于面乘子的舒尔补，\n$$\nS = C - B\\,K^{-1}\\,B^{\\top}.\n$$\n3. 计算 $S$ 的特征值，并为每个测试用例报告两个量：最小特征值和定义为最大与最小特征值之比的谱条件数。如果最小特征值非正（小于或等于容差 $10^{-12}$），则报告计算出的最小特征值，并将条件数设置为 $+\\infty$。\n\n从上述基本原理出发，显式地构造算法和计算过程，不使用任何黑箱式的不连续伽辽金组装捷径。确保混合过程和分块结构源自 SIPG 双线性形式，并且凝聚是通过求解以 $K$ 块为系数的线性系统来实现的。\n\n为以下罚参数和网格尺寸的测试套件实现程序：\n- 测试 1：$N = 4$, $\\sigma = 1.0$。\n- 测试 2：$N = 4$, $\\sigma = 0.2$。\n- 测试 3：$N = 8$, $\\sigma = 1.0$。\n- 测试 4：$N = 2$, $\\sigma = 0.01$。\n- 测试 5：$N = 6$, $\\sigma = 10.0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例按顺序贡献一个包含两个条目 $[\\text{min\\_eig}, \\text{cond}]$ 的列表。例如：$[[a,b],[c,d],\\dots]$。此问题中没有物理单位。不涉及角度。不涉及百分比。输出必须是实数（浮点数）。最终的矩阵必须由您的程序进行数值组装和分析；不要硬编码任何解析特征值。",
            "solution": "用户希望分析一维泊松问题的混合对称内部罚分片伽辽金 (SIPG) 离散化的舒尔补。\n\n### 问题验证\n\n#### 第 1 步：提取已知信息\n- **问题：** 一维泊松方程 $-u''(x) = f(x)$，定义域为 $x \\in (0,1)$。\n- **边界条件：** 齐次狄利克雷边界条件，$u(0) = 0$ 和 $u(1) = 0$。\n- **离散化方法：** 不连续伽辽金 (DG) 方法，采用对称内部罚分片伽辽金 (SIPG) 公式。\n- **多项式次数：** 分片线性，$p=1$。\n- **网格：** 由 $N$ 个单元组成的均匀网格，单元尺寸 $h = 1/N$。\n- **混合方法：**\n    - 在内面上引入面拉格朗日乘子 $\\lambda$ 来表示数值迹 $\\hat{u}$。\n    - 在边界面上，迹是固定的：$\\hat{u}(0)=0$ 和 $\\hat{u}(1)=0$。\n    - 每个单元上的局部基由单元左右端点的节点基函数构成。\n- **双线性形式贡献：** 在单元 $E$ 的边界 $\\partial E$ 上，SIPG 对双线性形式的贡献为：\n$$\n\\int_{\\partial E} \\left( -\\partial_n u_E\\,(v_E - \\hat{v}) - \\partial_n v_E\\,(u_E - \\hat{u}) + \\frac{\\sigma}{h}\\,(u_E - \\hat{u})(v_E - \\hat{v}) \\right) dS\n$$\n其中 $\\partial_n$ 是外法向导数，$u_E, v_E$ 是限制在单元 $E$ 上的试探/检验函数，而 $\\hat{u}, \\hat{v}$ 是混合迹变量（乘子）。\n- **任务：**\n    1. 以分块形式组装全局混合系统矩阵：$\\begin{pmatrix} K & B^{\\top} \\\\ B & C \\end{pmatrix}$。\n    2. 执行静态凝聚以获得关于面乘子的舒尔补：$S = C - B K^{-1} B^{\\top}$。\n    3. 对于每个测试用例，计算 $S$ 的最小特征值 ($\\lambda_{min}$) 和谱条件数 ($\\kappa(S) = \\lambda_{max}/\\lambda_{min}$)。如果 $\\lambda_{min} \\le 10^{-12}$，报告计算出的 $\\lambda_{min}$ 并将 $\\kappa(S)$ 设置为 $+\\infty$。\n- **测试用例：**\n    - 测试 1: $N = 4$, $\\sigma = 1.0$。\n    - 测试 2: $N = 4$, $\\sigma = 0.2$。\n    - 测试 3: $N = 8$, $\\sigma = 1.0$。\n    - 测试 4: $N = 2$, $\\sigma = 0.01$。\n    - 测试 5: $N = 6$, $\\sigma = 10.0$。\n- **输出：** 一个单行的逗号分隔列表，包含多个含两个条目的列表：`[[min_eig, cond], ...]`。\n\n#### 第 2 步：使用提取的已知信息进行验证\n该问题有科学依据、良定且客观。它描述了偏微分方程数值分析中的一个标准过程，特别是有限元方法。混合 SIPG 方法的公式以及分析其舒尔补的任务是计算数学中明确定义的主题。该问题是自包含的，提供了所有必要的定义、公式和参数。没有矛盾、歧义或无效的科学前提。\n\n#### 第 3 步：结论与行动\n问题**有效**。将逐步推导并给出解答。\n\n### 解答推导\n目标是构建舒尔补矩阵 $S = C - B K^{-1} B^T$ 并分析其谱。我们将从给定的双线性形式中推导出矩阵 $K、B$ 和 $C$。系统是通过考虑每个单元的贡献来组装的。\n\n设一个单元为 $E_i = (x_{i-1}, x_i)$，尺寸为 $h = 1/N$。对于 $p=1$，局部基函数是线性的：\n- $\\phi_{i,L}(x) = (x_i - x)/h$\n- $\\phi_{i,R}(x) = (x - x_{i-1})/h$\n\n它们的导数是常数：$\\phi'_{i,L}(x) = -1/h$ 和 $\\phi'_{i,R}(x) = 1/h$。在 $E_i$ 上的函数 $u$ 表示为 $u(x) = u_{i,L}\\phi_{i,L}(x) + u_{i,R}\\phi_{i,R}(x)$，其中 $u_{i,L}$ 和 $u_{i,R}$ 是单元左右端点的节点值。\n\n完整的双线性形式是 $A((u,\\lambda), (v,\\mu)) = \\sum_E \\left(\\int_E u'v' dx + \\text{Term}_{\\partial E}\\right)$，其中 $\\text{Term}_{\\partial E}$ 是给定的在单元边界上的积分。系统矩阵由此形式产生。总矩阵是对称的，因为双线性形式关于交换 $((u,\\lambda), (v,\\mu))$ 是对称的。\n\n#### 单元矩阵贡献\n我们通过考虑单个单元 $E_i$ 对全局矩阵 $K、B、C$ 的贡献来确定局部矩阵。\n\n**1. K 块（单元内部耦合）**\nK 块耦合单元内部自由度 $\\mathbf{u}$。局部 $2 \\times 2$ 矩阵 $K_i$ 是从单元 $E_i$ 上的 $A((\\mathbf{u},0), (\\mathbf{v},0))$ 推导出来的。\n$A_i(u,v) = \\int_{E_i} u'v' dx - \\int_{\\partial E_i} (\\partial_n u v + \\partial_n v u) dS + \\int_{\\partial E_i} \\frac{\\sigma}{h} uv dS$。\n矩阵项 $K_{i,ab}$ 是通过设置 $u=\\phi_{i,a}$ 和 $v=\\phi_{i,b}$ 计算的，其中 $a,b \\in \\{L, R\\}$。\n- 体积项：$\\int_{E_i} \\phi'_{i,a}\\phi'_{i,b} dx = \\frac{1}{h^2} \\int_{E_i} (\\pm 1)(\\pm 1) dx = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n- 面项：在 $E_i$ 的两个面上求值后，总的局部刚度矩阵 $K_i$ 为：\n$$ K_i = \\frac{1}{h}\\begin{pmatrix} \\sigma-1 & 1 \\\\ 1 & \\sigma-1 \\end{pmatrix} $$\n全局矩阵 $K$ 是一个 $2N \\times 2N$ 的分块对角矩阵，有 $N$ 个 $K_i$ 块。如果 $\\det(K_i) = \\frac{1}{h^2}((\\sigma-1)^2 - 1) = \\frac{1}{h^2}\\sigma(\\sigma-2) \\neq 0$，则该矩阵可逆。给定的 $\\sigma$ 测试用例满足此条件。其逆矩阵为 $K_i^{-1} = \\frac{h}{\\sigma(\\sigma-2)}\\begin{pmatrix} \\sigma-1 & -1 \\\\ -1 & \\sigma-1 \\end{pmatrix}$。\n\n**2. C 块（面-面耦合）**\nC 块耦合面乘子 $\\boldsymbol{\\lambda}$。它是由 $A((0,\\lambda), (0,\\mu))$ 推导出来的。\n$A_i(\\lambda, \\mu) = \\int_{\\partial E_i} \\frac{\\sigma}{h} \\hat{u}\\hat{v} dS = \\frac{\\sigma}{h} (\\lambda_{i-1}\\mu_{i-1} + \\lambda_i\\mu_i)$。\n每个内面 $j$ 由两个单元 $E_j$ 和 $E_{j+1}$ 共享。对角项 $C_{j-1,j-1}$（对于乘子 $\\lambda_j$）的总贡献是 $\\frac{\\sigma}{h} + \\frac{\\sigma}{h} = \\frac{2\\sigma}{h}$。$C$ 是一个 $(N-1) \\times (N-1)$ 的对角矩阵：\n$$ C = \\text{diag}\\left(\\frac{2\\sigma}{h}, \\frac{2\\sigma}{h}, \\dots, \\frac{2\\sigma}{h}\\right) $$\n\n**3. B 块（单元-面耦合）**\nB 块耦合单元内部自由度与面乘子。它是由 $A((\\mathbf{u},0), (0,\\boldsymbol{\\mu}))$ 推导出来的。对于单元 $E_i$，这给出了一个局部 $2 \\times 2$ 矩阵 $B_i$，耦合局部自由度 $(u_{i,L}, u_{i,R})$ 与局部乘子 $(\\mu_{i-1}, \\mu_i)$：\n$A_i(u,\\mu) = \\int_{\\partial E_i} (\\partial_n u \\hat{v} - \\frac{\\sigma}{h} u \\hat{v}) dS$。\n这导致：\n$$ B_i = \\frac{1}{h}\\begin{pmatrix} 1-\\sigma & -1 \\\\ -1 & 1-\\sigma \\end{pmatrix} $$\n全局矩阵 $B$ 是一个稀疏的 $(N-1) \\times 2N$ 矩阵。对应于面 $j$ 的行在与相邻单元 $E_j$ 和 $E_{j+1}$ 的自由度相对应的位置有非零项。\n\n**4. 舒尔补 S**\n舒尔补为 $S = C - B K^{-1} B^T$。我们可以计算乘积 $S_K = B K^{-1} B^T$ 的项。$S_K$ 是一个三对角矩阵。\n- 对角项 $(S_K)_{j,j}$：这些项从与面 $j$ 相邻的两个单元获得贡献。详细计算表明 $(S_K)_{j,j} = \\frac{2(\\sigma-1)}{h}$。\n- 非对角项 $(S_K)_{j, j+1}$：这些项从面 $j$ 和 $j+1$ 之间的单个单元获得贡献。详细计算表明 $(S_K)_{j, j+1} = \\frac{1}{h}$。\n\n结合这些结果：\n- $S_{j,j} = C_{j,j} - (S_K)_{j,j} = \\frac{2\\sigma}{h} - \\frac{2(\\sigma-1)}{h} = \\frac{2}{h}$。\n- $S_{j,j+1} = - (S_K)_{j,j+1} = -\\frac{1}{h}$。\n\n得到的舒尔补矩阵是一个 $(N-1) \\times (N-1)$ 的三对角矩阵：\n$$ S = \\frac{1}{h} \\begin{pmatrix} 2 & -1 & & \\\\ -1 & 2 & -1 & \\\\ & \\ddots & \\ddots & \\ddots \\\\ & & -1 & 2 \\end{pmatrix} $$\n对于 $p=1$ 的情况，一个显著的结果是，该矩阵与罚参数 $\\sigma$ 无关。因此，$S$ 的谱将仅取决于单元数 $N$（并因此取决于 $h=1/N$），而与 $\\sigma$ 无关。\n\n该矩阵的特征值有解析解：\n$ \\lambda_k = \\frac{2}{h} - \\frac{2}{h}\\cos\\left(\\frac{k\\pi}{N}\\right) = \\frac{4}{h}\\sin^2\\left(\\frac{k\\pi}{2N}\\right)$，其中 $k=1, \\dots, N-1$。\n\n最小和最大特征值为：\n- $\\lambda_{min} = \\lambda_1 = \\frac{4}{h}\\sin^2\\left(\\frac{\\pi}{2N}\\right)$\n- $\\lambda_{max} = \\lambda_{N-1} = \\frac{4}{h}\\sin^2\\left(\\frac{(N-1)\\pi}{2N}\\right) = \\frac{4}{h}\\cos^2\\left(\\frac{\\pi}{2N}\\right)$\n\n谱条件数为 $\\kappa(S) = \\frac{\\lambda_{max}}{\\lambda_{min}} = \\frac{\\cos^2(\\pi/2N)}{\\sin^2(\\pi/2N)} = \\cot^2\\left(\\frac{\\pi}{2N}\\right)$。\n\n程序将不使用这些解析特征值，而是对每个测试用例数值地构造矩阵 $K、B、C$，计算 $S$，然后求其特征值，从而验证这一理论结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_case(N, sigma):\n    \"\"\"\n    Computes the Schur complement eigenvalues and condition number for a given\n    mesh size N and penalty parameter sigma.\n    \"\"\"\n    h = 1.0 / N\n    \n    # 1. Assemble K, B, C matrices\n    \n    # K is a block-diagonal matrix composed of N element stiffness matrices Ki.\n    # Ki couples the 2 degrees of freedom within one element.\n    num_u_dofs = 2 * N\n    K = np.zeros((num_u_dofs, num_u_dofs))\n    Ki = (1.0 / h) * np.array([[sigma - 1.0, 1.0], \n                                 [1.0, sigma - 1.0]])\n    for i in range(N):\n        K[2*i:2*i+2, 2*i:2*i+2] = Ki\n\n    # C couples the face multipliers to themselves.\n    # It is a diagonal matrix for the (N-1) interior faces.\n    num_lambda_dofs = N - 1\n    if num_lambda_dofs == 0: # Case N=1 has no interior faces.\n        return [0.0, 1.0] \n        \n    C = np.diag(np.full(num_lambda_dofs, 2.0 * sigma / h))\n\n    # B couples the face multipliers to the element-interior degrees of freedom.\n    # It is a sparse (N-1)x(2N) matrix.\n    # Row j-1 of B corresponds to interior face j.\n    B = np.zeros((num_lambda_dofs, num_u_dofs))\n    for face_idx in range(1, N): # Iterate over interior faces 1, ..., N-1\n        # The row in B corresponding to face_idx is (face_idx - 1).\n        row_idx = face_idx - 1\n        \n        # Face face_idx is between element face_idx (left) and element face_idx+1 (right).\n        # In 0-based Python indexing, these are elements (face_idx - 1) and face_idx.\n        \n        # Contribution from the right side of the left element (element face_idx-1)\n        # Affects DoFs indexed by 2*(face_idx-1) and 2*(face_idx-1)+1\n        # This corresponds to the second row of the local B matrix.\n        left_elem_dof_start_idx = 2 * (face_idx - 1)\n        B[row_idx, left_elem_dof_start_idx]     = -1.0 / h\n        B[row_idx, left_elem_dof_start_idx + 1] = (1.0 - sigma) / h\n\n        # Contribution from the left side of the right element (element face_idx)\n        # Affects DoFs indexed by 2*(face_idx) and 2*(face_idx)+1\n        # This corresponds to the first row of the local B matrix.\n        right_elem_dof_start_idx = 2 * face_idx\n        B[row_idx, right_elem_dof_start_idx]     = (1.0 - sigma) / h\n        B[row_idx, right_elem_dof_start_idx + 1] = -1.0 / h\n\n    # 2. Perform static condensation to obtain the Schur complement S.\n    # K is invertible for sigma not in {0, 2}, which is true for all test cases.\n    try:\n        K_inv = np.linalg.inv(K)\n    except np.linalg.LinAlgError:\n        # This will happen if K is singular (e.g., sigma=0 or 2)\n        return [0.0, float('inf')]\n        \n    S = C - B @ K_inv @ B.T\n    \n    # 3. Compute eigenvalues and condition number of S.\n    # S is symmetric, so eigvalsh is efficient and returns sorted eigenvalues.\n    if S.shape[0] == 1:\n        eigenvalues = np.array([S[0,0]])\n    else:\n        eigenvalues = np.linalg.eigvalsh(S)\n    \n    min_eig = eigenvalues[0]\n    max_eig = eigenvalues[-1]\n    \n    if min_eig <= 1e-12:\n        cond_num = float('inf')\n    else:\n        cond_num = max_eig / min_eig\n\n    return [min_eig, cond_num]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (4, 1.0),    # Test 1\n        (4, 0.2),    # Test 2\n        (8, 1.0),    # Test 3\n        (2, 0.01),   # Test 4\n        (6, 10.0),   # Test 5\n    ]\n\n    results = []\n    for case in test_cases:\n        N, sigma = case\n        result = solve_case(N, sigma)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Use map and str to handle potential 'inf' correctly.\n    formatted_results = [f\"[{res[0]},{str(res[1])}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}