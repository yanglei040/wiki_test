{
    "hands_on_practices": [
        {
            "introduction": "在设计间断伽辽金（DG）方法中的数值通量时，一个最基本的要求是它必须与原始偏微分方程的物理通量相一致。这个被称为“相容性”的性质确保了数值格式在解是光滑的情况下能够正确地逼近原方程。本练习 () 通过一个精心设计的反例，让您亲手验证当相容性被破坏时会发生什么，从而深刻理解为何它是任何有效数值通量的不可或缺的基石。",
            "id": "3409743",
            "problem": "考虑一维线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，定义域为 $[0,1]$，采用周期性边界条件。将区域离散为两个均匀单元 $I_{1} = [0,\\tfrac{1}{2}]$ 和 $I_{2} = [\\tfrac{1}{2},1]$，每个单元的长度为 $h = \\tfrac{1}{2}$。使用多项式次数为 $p=0$（分段常数试探函数和检验函数）的间断 Galerkin (DG) 方法。\n\n定义在界面处的单元间数值通量，其左迹为 $u^{-}$，右迹为 $u^{+}$，单元外向单位法向量为 $n$（指向正在组装方程的单元的外部），其形式为\n$$\n\\widehat{f}(u^{-},u^{+},n) = a\\,\\frac{u^{-} + u^{+}}{2} + \\beta\\,n,\n$$\n其中 $a$ 和 $\\beta$ 是给定常数。该偏微分方程的物理通量为 $f(u) = a\\,u$。如果对于所有的 $u$ 和所有的界面，都有 $\\widehat{f}(u,u,n) = f(u)n$，则数值通量是一致的。\n\n任务：\n1. 从偏微分方程的局部守恒形式和单个单元上的 DG 弱形式出发，写出当 $p=0$ 且使用常数检验函数时，单元平均解的半离散 DG 方程。\n2. 证明上述 $\\widehat{f}$ 的选择违反了与物理通量的一致性。\n3. 对于常数解 $u(x,t) \\equiv c$，在两个单元上分别计算半离散 DG 方程，并用 $a$、$\\beta$ 和 $h$ 表示单元平均解 $u_{j}(t)$ 的时间导数。\n4. 使用 $a = 3$，$\\beta = 1$， $h = \\tfrac{1}{2}$ 和任意常数 $c$，计算该通量产生的单元平均解时间导数 $u_{j}'(t)$ 的数值。将最终数值答案表示为一个无单位的纯数。无需四舍五入。",
            "solution": "该问题是适定的且科学上合理的，是关于间断 Galerkin (DG) 方法的数值分析课程中的一个标准练习。它检验了对 DG 公式、数值通量一致性概念以及违反此性质的后果的理解。\n\n### 任务1：半离散 DG 方程\n\n我们从守恒形式的一维线性平流方程开始：\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0\n$$\n其中物理通量为 $f(u) = a\\,u$。区域 $[0,1]$ 被离散为单元 $I_j$。DG 弱形式通过将偏微分方程乘以一个检验函数 $v(x)$ 并在一个单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上积分得到：\n$$\n\\int_{I_j} \\frac{\\partial u}{\\partial t} v \\,dx + \\int_{I_j} \\frac{\\partial f(u)}{\\partial x} v \\,dx = 0\n$$\n对于多项式次数 $p=0$，解 $u(x,t)$ 在每个单元 $I_j$ 上被一个分段常数函数 $u_h(x,t) = u_j(t)$（对于 $x \\in I_j$）所近似。我们在 $I_j$ 上使用常数检验函数 $v(x)=1$。\n\n弱形式中的第一项变为：\n$$\n\\int_{I_j} \\frac{\\partial u_j(t)}{\\partial t} (1) \\,dx = \\frac{du_j}{dt} \\int_{I_j} dx = h \\frac{du_j}{dt}\n$$\n其中 $h$ 是单元的长度。\n\n第二项通过分部积分计算：\n$$\n\\int_{I_j} \\frac{\\partial f(u)}{\\partial x} v \\,dx = \\left[ f(u) v \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} f(u) \\frac{\\partial v}{\\partial x} \\,dx\n$$\n由于检验函数 $v$ 是常数（$v=1$），其导数 $\\frac{\\partial v}{\\partial x}$ 为 0，因此右侧的积分消失。该项简化为在单元边界处的通量计算：\n$$\n\\left[ f(u) v \\right]_{x_{j-1/2}}^{x_{j+1/2}} = f(u(x_{j+1/2},t)) - f(u(x_{j-1/2},t))\n$$\n由于解 $u_h$ 在单元界面处是不连续的，通量 $f(u)$ 没有唯一定义。我们用一个数值通量 $\\widehat{f}$ 来代替它，该数值通量依赖于界面左侧（$u^-$）和右侧（$u^+$）的状态解值，以及单元边界的外向单位法向量 $n$。\n\n在单元 $I_j$ 的右边界 $x=x_{j+1/2}$ 处，外向法向量为 $n=+1$。左侧状态为 $u^- = u_j(t)$，右侧状态为 $u^+ = u_{j+1}(t)$。此处的通量项为 $\\widehat{f}(u_j, u_{j+1}, +1)$。\n在单元 $I_j$ 的左边界 $x=x_{j-1/2}$ 处，外向法向量为 $n=-1$。左侧状态为 $u^- = u_{j-1}(t)$，右侧状态为 $u^+ = u_j(t)$。此处的通量项为 $\\widehat{f}(u_{j-1}, u_j, -1)$。\n\n将这些代入分部积分的表达式中，边界项变为：\n$$\n\\widehat{f}(u_j, u_{j+1}, +1) - \\widehat{f}(u_{j-1}, u_j, -1)\n$$\n合并这些项，单元平均解 $u_j$ 的半离散 DG 方程为：\n$$\nh \\frac{du_j}{dt} + \\widehat{f}(u_j, u_{j+1}, +1) - \\widehat{f}(u_{j-1}, u_j, -1) = 0\n$$\n\n### 任务2：违反一致性\n\n如果对于任意状态 $u$，数值通量 $\\widehat{f}(u^-, u^+, n)$ 满足 $\\widehat{f}(u,u,n) = f(u)n$，则它与物理通量 $f(u)$ 是一致的。\n给定的物理通量是 $f(u) = a\\,u$，因此物理通量项为 $f(u)n = aun$。\n给定的数值通量是 $\\widehat{f}(u^-, u^+, n) = a\\,\\frac{u^- + u^+}{2} + \\beta\\,n$。\n为检验一致性，我们设 $u^- = u$ 和 $u^+ = u$：\n$$\n\\widehat{f}(u, u, n) = a\\,\\frac{u + u}{2} + \\beta\\,n = a\\,\\frac{2u}{2} + \\beta\\,n = a\\,u + \\beta\\,n\n$$\n为保证一致性，该式必须等于 $aun$。\n$$\na\\,u + \\beta\\,n = a\\,u n\n$$\n此等式成立当且仅当 $\\beta\\,n = au(n-1)$。如果 $n=1$，则要求 $\\beta=0$。如果 $n=-1$，则要求 $-\\beta = -2au$，即 $\\beta=2au$。因为该条件必须对所有 $u$ 和 $n$ 成立，所以只有当 $\\beta=0$ 且 $a=0$（平凡情况）时才能实现一致性。由于 $\\beta$ 是一个可以为非零的给定常数（例如，在任务4中 $\\beta=1$），因此数值通量 $\\widehat{f}$ 通常与物理通量 $f(u)$ 不一致。\n\n### 任务3：对常数解的计算\n\n我们考虑一个常数解 $u(x,t) \\equiv c$。对于 $p=0$ 的离散化，这意味着两个单元中每个单元的平均解都是 $u_1(t) = c$ 和 $u_2(t) = c$。我们要求解 $j=1,2$ 的时间导数 $\\frac{du_j}{dt}$。\n\n我们有两个单元，$I_1 = [0, \\frac{1}{2}]$ 和 $I_2 = [\\frac{1}{2}, 1]$，并采用周期性边界条件。相邻单元为 $u_0 = u_2$ 和 $u_3 = u_1$。\n\n对单元 $I_1$ ($j=1$)：\n半离散方程为 $h \\frac{du_1}{dt} + \\widehat{f}(u_1, u_2, +1) - \\widehat{f}(u_0, u_1, -1) = 0$。利用周期性，$u_0=u_2$，方程变为：\n$$\nh \\frac{du_1}{dt} + \\widehat{f}(u_1, u_2, +1) - \\widehat{f}(u_2, u_1, -1) = 0\n$$\n代入 $u_1 = c$ 和 $u_2 = c$：\n$$\nh \\frac{du_1}{dt} + \\widehat{f}(c, c, +1) - \\widehat{f}(c, c, -1) = 0\n$$\n使用给定的数值通量公式：\n$\\widehat{f}(c, c, +1) = a\\,\\frac{c+c}{2} + \\beta(+1) = a\\,c + \\beta$。\n$\\widehat{f}(c, c, -1) = a\\,\\frac{c+c}{2} + \\beta(-1) = a\\,c - \\beta$。\n\n将这些代入 $u_1$ 的方程中：\n$$\nh \\frac{du_1}{dt} + (a\\,c + \\beta) - (a\\,c - \\beta) = 0\n$$\n$$\nh \\frac{du_1}{dt} + a\\,c + \\beta - a\\,c + \\beta = 0\n$$\n$$\nh \\frac{du_1}{dt} + 2\\beta = 0\n$$\n$$\n\\frac{du_1}{dt} = -\\frac{2\\beta}{h}\n$$\n对单元 $I_2$ ($j=2$)：\n半离散方程为 $h \\frac{du_2}{dt} + \\widehat{f}(u_2, u_3, +1) - \\widehat{f}(u_1, u_2, -1) = 0$。利用周期性，$u_3=u_1$：\n$$\nh \\frac{du_2}{dt} + \\widehat{f}(u_2, u_1, +1) - \\widehat{f}(u_1, u_2, -1) = 0\n$$\n代入 $u_1 = c$ 和 $u_2 = c$：\n$$\nh \\frac{du_2}{dt} + \\widehat{f}(c, c, +1) - \\widehat{f}(c, c, -1) = 0\n$$\n这与 $u_1$ 的方程相同，得出相同的结果：\n$$\n\\frac{du_2}{dt} = -\\frac{2\\beta}{h}\n$$\n因此，对于任意单元 $j$，单元平均解的时间导数为 $\\frac{du_j}{dt} = -\\frac{2\\beta}{h}$。一个一致的格式会产生 $\\frac{du_j}{dt}=0$，从而保持常数状态。这个非零结果是通量不一致性的直接后果。\n\n### 任务4：数值计算\n\n我们被要求使用给定的常数 $a=3$，$\\beta=1$ 和 $h=\\frac{1}{2}$ 来计算 $\\frac{du_j}{dt}$ 的数值。常数 $c$ 的值与此无关， $a$ 的值也一样。\n使用任务3中导出的公式：\n$$\n\\frac{du_j}{dt} = -\\frac{2\\beta}{h}\n$$\n代入数值：\n$$\n\\frac{du_j}{dt} = -\\frac{2(1)}{\\frac{1}{2}} = -\\frac{2}{0.5} = -4\n$$\n单元平均解时间导数的数值为 -4。",
            "answer": "$$\n\\boxed{-4}\n$$"
        },
        {
            "introduction": "理解了相容性的重要性之后，下一步是掌握如何为一个给定的问题具体计算一个有效的数值通量。本练习 () 将指导您为一个非线性标量守恒律，一步步计算在单元交界面上的 Rusanov 数值通量。通过这个实践，您将把 DG 方法的抽象公式转化为具体的数值，这是应用 DG 方法解决实际问题的核心计算技能。",
            "id": "3409742",
            "problem": "考虑定义在区间 $[-1,1]$ 上的标量守恒律 $u_{t} + f(u)_{x} = 0$，其中 $f(u) = u + \\frac{u^{3}}{3}$。在一个包含两个单元 $E_{L} = [-1,0]$ 和 $E_{R} = [0,1]$ 的网格上应用间断 Galerkin (DG) 方法。在参考区间 $[-1,1]$ 上，使用 Legendre 基进行 2 次多项式展开。从每个物理单元到参考坐标 $\\xi \\in [-1,1]$ 的仿射映射将交界面位置 $x=0$ 映射到 $E_{L}$ 的 $\\xi = +1$ 和 $E_{R}$ 的 $\\xi = -1$。在每个单元上，近似解表示为\n$$\nu_{L}(\\xi) = \\alpha_{0} P_{0}(\\xi) + \\alpha_{1} P_{1}(\\xi) + \\alpha_{2} P_{2}(\\xi), \\quad u_{R}(\\xi) = \\beta_{0} P_{0}(\\xi) + \\beta_{1} P_{1}(\\xi) + \\beta_{2} P_{2}(\\xi),\n$$\n其中 $P_{0}(\\xi) = 1$，$P_{1}(\\xi) = \\xi$ 和 $P_{2}(\\xi) = \\frac{1}{2}(3\\xi^{2} - 1)$ 是前三个 Legendre 多项式，系数为\n$$\n\\alpha_{0} = \\frac{1}{2}, \\quad \\alpha_{1} = -\\frac{3}{4}, \\quad \\alpha_{2} = \\frac{2}{3}, \\qquad \\beta_{0} = \\frac{2}{5}, \\quad \\beta_{1} = \\frac{7}{8}, \\quad \\beta_{2} = -\\frac{1}{3}.\n$$\n在交界面 $x=0$ 处，令内部迹为 $u^{-} = \\lim_{x \\to 0^{-}} u(x)$（来自 $E_{L}$）和 $u^{+} = \\lim_{x \\to 0^{+}} u(x)$（来自 $E_{R}$）。使用一个通过守恒律在交界面处的局部线性化导出的一致单调数值通量，并取耗散参数为跨交界面的最大绝对特征速度 $\\lambda = \\max\\{|f'(u^{-})|, |f'(u^{+})|\\}$，计算在 $x=0$ 处的单元间数值通量。将最终答案表示为一个最简有理数。无需四舍五入。",
            "solution": "首先验证问题以确保其自洽、有科学依据且适定。\n\n### 第 1 步：提取已知条件\n-   **守恒律**：定义在区间 $[-1,1]$ 上的 $u_{t} + f(u)_{x} = 0$。\n-   **通量函数**：$f(u) = u + \\frac{u^{3}}{3}$。\n-   **离散化**：两个单元，$E_{L} = [-1,0]$ 和 $E_{R} = [0,1]$。\n-   **逼近空间**：基于 Legendre 基的 2 次多项式。\n-   **参考映射**：交界面 $x=0$ 映射到 $E_{L}$ 的 $\\xi = +1$ 和 $E_{R}$ 的 $\\xi = -1$。\n-   **基函数**：$P_{0}(\\xi) = 1$, $P_{1}(\\xi) = \\xi$, $P_{2}(\\xi) = \\frac{1}{2}(3\\xi^{2} - 1)$。\n-   **解的表示**：\n    -   在 $E_{L}$上：$u_{L}(\\xi) = \\alpha_{0} P_{0}(\\xi) + \\alpha_{1} P_{1}(\\xi) + \\alpha_{2} P_{2}(\\xi)$，系数为 $\\alpha_{0} = \\frac{1}{2}$，$\\alpha_{1} = -\\frac{3}{4}$，$\\alpha_{2} = \\frac{2}{3}$。\n    -   在 $E_{R}$上：$u_{R}(\\xi) = \\beta_{0} P_{0}(\\xi) + \\beta_{1} P_{1}(\\xi) + \\beta_{2} P_{2}(\\xi)$，系数为 $\\beta_{0} = \\frac{2}{5}$，$\\beta_{1} = \\frac{7}{8}$，$\\beta_{2} = -\\frac{1}{3}$。\n-   **交界面的迹**：$u^{-} = \\lim_{x \\to 0^{-}} u(x)$ 和 $u^{+} = \\lim_{x \\to 0^{+}} u(x)$。\n-   **数值通量**：使用一致单调通量（局部 Lax-Friedrichs 类型），其形式为 $\\hat{f}(u^{-}, u^{+}) = \\frac{1}{2}\\left[f(u^{-}) + f(u^{+}) - \\lambda(u^{+} - u^{-})\\right]$。\n-   **耗散参数**：$\\lambda = \\max\\{|f'(u^{-})|,|f'(u^{+})|\\}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题是使用间断 Galerkin 方法求解偏微分方程数值解的一个标准练习。它提供了所有必要的组成部分：控制方程、离散化设置、基函数、定义解状态的系数，以及待计算数值通量的精确公式。该问题具有科学依据、适定、客观，并且不包含任何矛盾或歧义。\n\n### 第 3 步：结论与操作\n问题有效。将提供完整解答。\n\n### 解\n任务是计算在交界面 $x=0$ 处的单元间数值通量 $\\hat{f}$。指定的通量是局部 Lax-Friedrichs（或 Rusanov）通量，由下式给出：\n$$\n\\hat{f}(u^{-}, u^{+}) = \\frac{1}{2} \\left[ f(u^{-}) + f(u^{+}) - \\lambda (u^{+} - u^{-}) \\right]\n$$\n其中 $\\lambda = \\max\\{|f'(u^{-})|, |f'(u^{+})|\\}$。求解过程分为四个步骤。\n\n**1. 计算迹值 $u^{-}$ 和 $u^{+}$。**\n\n左迹值 $u^{-}$ 是解从单元 $E_{L}$ 逼近 $x \\to 0^{-}$ 的极限。这对应于在 $\\xi = +1$ 处计算 $u_{L}(\\xi)$ 的值。Legendre 多项式在 $\\xi = 1$ 处的值为：\n$P_{0}(1) = 1$\n$P_{1}(1) = 1$\n$P_{2}(1) = \\frac{1}{2}(3(1)^{2} - 1) = 1$\n\n因此，$u^{-}$ 为：\n$$\nu^{-} = u_{L}(1) = \\alpha_{0}P_{0}(1) + \\alpha_{1}P_{1}(1) + \\alpha_{2}P_{2}(1) = \\alpha_{0} + \\alpha_{1} + \\alpha_{2}\n$$\n代入给定的系数：\n$$\nu^{-} = \\frac{1}{2} - \\frac{3}{4} + \\frac{2}{3} = \\frac{6}{12} - \\frac{9}{12} + \\frac{8}{12} = \\frac{5}{12}\n$$\n\n右迹值 $u^{+}$ 是从单元 $E_{R}$ 逼近 $x \\to 0^{+}$ 的极限，对应于在 $\\xi = -1$ 处计算 $u_{R}(\\xi)$ 的值。Legendre 多项式在 $\\xi = -1$ 处的值为：\n$P_{0}(-1) = 1$\n$P_{1}(-1) = -1$\n$P_{2}(-1) = \\frac{1}{2}(3(-1)^{2} - 1) = 1$\n\n因此，$u^{+}$ 为：\n$$\nu^{+} = u_{R}(-1) = \\beta_{0}P_{0}(-1) + \\beta_{1}P_{1}(-1) + \\beta_{2}P_{2}(-1) = \\beta_{0} - \\beta_{1} + \\beta_{2}\n$$\n代入给定的系数：\n$$\nu^{+} = \\frac{2}{5} - \\frac{7}{8} - \\frac{1}{3} = \\frac{48}{120} - \\frac{105}{120} - \\frac{40}{120} = \\frac{48 - 105 - 40}{120} = -\\frac{97}{120}\n$$\n\n**2. 计算特征速度和耗散参数 $\\lambda$。**\n\n特征速度由通量函数的导数 $f'(u)$ 给出。\n$$\nf(u) = u + \\frac{u^{3}}{3} \\implies f'(u) = 1 + u^{2}\n$$\n由于 $u^{2} \\ge 0$，$f'(u) = 1+u^{2}$ 总是正的，所以 $|f'(u)| = f'(u)$。我们在 $u^{-}$ 和 $u^{+}$ 处计算该值：\n$$\nf'(u^{-}) = 1 + (u^{-})^{2} = 1 + \\left(\\frac{5}{12}\\right)^{2} = 1 + \\frac{25}{144} = \\frac{144+25}{144} = \\frac{169}{144}\n$$\n$$\nf'(u^{+}) = 1 + (u^{+})^{2} = 1 + \\left(-\\frac{97}{120}\\right)^{2} = 1 + \\frac{9409}{14400} = \\frac{14400+9409}{14400} = \\frac{23809}{14400}\n$$\n为了比较这两个值，我们使用一个公分母：\n$$\nf'(u^{-}) = \\frac{169 \\times 100}{144 \\times 100} = \\frac{16900}{14400}\n$$\n由于 $23809 > 16900$，我们有 $f'(u^{+}) > f'(u^{-})$。因此，耗散参数为：\n$$\n\\lambda = \\max\\{f'(u^{-}), f'(u^{+})\\} = f'(u^{+}) = \\frac{23809}{14400}\n$$\n\n**3. 计算数值通量的各项。**\n\n我们需要 $f(u^{-})$、$f(u^{+})$ 以及耗散项 $\\lambda(u^{+}-u^{-})$。\n$$\nf(u^{-}) = u^{-} + \\frac{(u^{-})^{3}}{3} = \\frac{5}{12} + \\frac{1}{3}\\left(\\frac{5}{12}\\right)^{3} = \\frac{5}{12} + \\frac{125}{3 \\cdot 1728} = \\frac{5}{12} + \\frac{125}{5184} = \\frac{5 \\cdot 432 + 125}{5184} = \\frac{2160+125}{5184} = \\frac{2285}{5184}\n$$\n$$\nf(u^{+}) = u^{+} + \\frac{(u^{+})^{3}}{3} = -\\frac{97}{120} + \\frac{1}{3}\\left(-\\frac{97}{120}\\right)^{3} = -\\frac{97}{120} - \\frac{912673}{3 \\cdot 1728000} = -\\frac{97}{120} - \\frac{912673}{5184000}\n$$\n为了合并它们，我们找到一个公分母：\n$$\nf(u^{+}) = -\\frac{97 \\cdot 43200}{5184000} - \\frac{912673}{5184000} = \\frac{-4190400 - 912673}{5184000} = -\\frac{5103073}{5184000}\n$$\n接下来，我们计算 $u$ 的跳跃：\n$$\nu^{+} - u^{-} = -\\frac{97}{120} - \\frac{5}{12} = -\\frac{97}{120} - \\frac{50}{120} = -\\frac{147}{120} = -\\frac{49}{40}\n$$\n耗散项为：\n$$\n\\lambda(u^{+} - u^{-}) = \\frac{23809}{14400} \\cdot \\left(-\\frac{49}{40}\\right) = -\\frac{23809 \\cdot 49}{14400 \\cdot 40} = -\\frac{1166641}{576000}\n$$\n\n**4. 组合数值通量并化简。**\n\n现在将这些分量代入通量公式：\n$$\n\\hat{f} = \\frac{1}{2} \\left[ \\frac{2285}{5184} - \\frac{5103073}{5184000} - \\left(-\\frac{1166641}{576000}\\right) \\right]\n$$\n括号内分数式的公分母是 $5184000$。注意 $5184000 = 5184 \\times 1000$ 且 $5184000 = 576000 \\times 9$。\n$$\n\\hat{f} = \\frac{1}{2} \\left[ \\frac{2285 \\cdot 1000}{5184000} - \\frac{5103073}{5184000} + \\frac{1166641 \\cdot 9}{5184000} \\right]\n$$\n$$\n\\hat{f} = \\frac{1}{2 \\cdot 5184000} \\left[ 2285000 - 5103073 + 10499769 \\right]\n$$\n$$\n\\hat{f} = \\frac{1}{10368000} \\left[ 12784769 - 5103073 \\right] = \\frac{7681696}{10368000}\n$$\n为了化简这个分数，我们可以用公因子去除分子和分母。两者都可以被 $32$ 整除：\n$$\n\\hat{f} = \\frac{7681696 \\div 32}{10368000 \\div 32} = \\frac{240053}{324000}\n$$\n分母的质因数是 $2$、$3$ 和 $5$。分子 $240053$ 不能被 $2$ 整除（它是奇数），不能被 $3$ 整除（数字之和为 $14$），也不能被 $5$ 整除（末位不是 $0$ 或 $5$）。因此，该分数已为最简形式。",
            "answer": "$$\n\\boxed{\\frac{240053}{324000}}\n$$"
        },
        {
            "introduction": "一个优秀的数值通量不仅需要保证相容性，还必须确保整个数值格式的稳定性，防止非物理振荡的产生和增长。本练习 () 将带您深入探索数值通量选择与格式稳定性之间的深刻联系。通过对一个使用迎风通量的 DG 格式进行离散傅里叶分析，您将推导出其半离散算子的特征值，并揭示迎风格式是如何通过引入数值耗散来保证稳定性的。",
            "id": "3409756",
            "problem": "考虑一维空间中的常系数线性双曲型偏微分方程组，\n$u_{t} + A\\,u_{x} = 0$ 定义在周期性区域 $x \\in [0,L]$ 上，其中 $u(x,t) \\in \\mathbb{R}^{m}$ 且 $A \\in \\mathbb{R}^{m \\times m}$ 是一个可对角化且具有实特征值的矩阵。假设使用一个包含 $N$ 个单元的均匀周期性网格，每个单元宽度为 $h = L/N$，并采用分片常数（$p=0$）的试探函数和检验函数进行间断伽辽金（Discontinuous Galerkin, DG）离散化。在每个单元交界面上，使用基于特征分解 $A = R \\Lambda R^{-1}$ 构造的矩阵迎风数值通量，其中 $\\Lambda = \\mathrm{diag}(\\lambda_{1},\\dots,\\lambda_{m})$，$\\Lambda^{+} = \\mathrm{diag}(\\max(\\lambda_{1},0),\\dots,\\max(\\lambda_{m},0))$，$\\Lambda^{-} = \\mathrm{diag}(\\min(\\lambda_{1},0),\\dots,\\min(\\lambda_{m},0))$，且 $A^{\\pm} = R \\Lambda^{\\pm} R^{-1}$。令 $u_{j}(t)$ 表示单元 $j$ 内的单元平均未知量，$F^{*}_{j+1/2} = A^{+} u_{j}^{-} + A^{-} u_{j+1}^{+}$ 为交界面 $x_{j+1/2}$ 处的迎风通量，索引采用周期性边界条件。\n\n从弱形式和数值通量的定义出发，推导该 $p=0$ 近似在周期性网格上的半离散 DG 算子。然后，通过寻找形如 $u_{j}(t) = \\hat{u} \\exp(i j \\theta + \\mu t)$ 的标准模态进行离散傅里叶分析，其中 $i^{2} = -1$，波数 $\\theta \\in [-\\pi,\\pi]$，且 $\\hat{u} \\in \\mathbb{C}^{m}$ 是一个常向量幅值。计算所得离散平流算子的特征值 $\\mu(\\theta)$，用 $\\theta$、$h$ 以及 $A$ 的特征信息表示。最后，将每个特征值的实部表示为关于 $\\theta$、$h$ 以及 $A$ 的特征值 $\\lambda_{s}$ 的显式闭式解析表达式。\n\n用一个单一的闭式解析表达式回答每个特征值的实部，该表达式是关于 $\\theta$、$h$ 和一个通用特征值 $\\lambda_{s}$ 的函数。无需四舍五入，也不要包含单位。",
            "solution": "该问题要求推导应用于线性双曲系统的、采用分片常数基函数（$p=0$）的间断伽辽金（Discontinuous Galerkin, DG）方法的放大因子特征值的实部。\n\n我们从偏微分方程（PDE）组开始：\n$$\nu_{t} + A\\,u_{x} = 0\n$$\n其中 $u(x,t) \\in \\mathbb{R}^{m}$ 且 $A \\in \\mathbb{R}^{m \\times m}$ 是一个具有实特征值的常数、可对角化矩阵。\n\n第一步是推导 DG 近似的半离散形式。我们将 PDE 乘以一个检验函数 $v(x)$，并在宽度为 $h$ 的单个计算单元 $I_{j} = [x_{j-1/2}, x_{j+1/2}]$ 上积分：\n$$\n\\int_{I_j} v(x) u_{t}(x,t) \\,dx + \\int_{I_j} v(x) A u_{x}(x,t) \\,dx = 0\n$$\n对于 $p=0$ 的 DG 方法，试探函数 $u(x,t)$ 和检验函数 $v(x)$ 在每个单元内都是常数。令 $u(x,t) = u_j(t)$ 对 $x \\in I_j$ 成立，其中 $u_j(t)$ 是单元平均值。我们选择检验函数为 $v(x) = 1$ 对 $x \\in I_j$ 成立。\n\n第一项变为：\n$$\n\\int_{I_j} 1 \\cdot \\frac{d u_j(t)}{dt} \\,dx = h \\frac{d u_j(t)}{dt}\n$$\n第二项通过分部积分处理：\n$$\n\\int_{I_j} v(x) A u_{x}(x,t) \\,dx = [v(x) A u(x,t)]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} \\frac{dv(x)}{dx} A u(x,t) \\,dx\n$$\n由于 $v(x)$ 在单元内是常数，其导数 $\\frac{dv}{dx}$ 为零，因此右侧的积分消失。边界项涉及函数 $u(x,t)$ 在单元交界面处的值，该函数在此处是不连续的。在 DG 框架中，精确通量 $A u$ 被数值通量 $F^*(u^-, u^+)$ 替代，其中 $u^-$ 和 $u^+$ 分别是交界面左侧和右侧的状态。这得到：\n$$\n[v(x) A u(x,t)]_{x_{j-1/2}}^{x_{j+1/2}} \\approx F^*_{j+1/2} - F^*_{j-1/2}\n$$\n其中 $F^*_{j+1/2} = F^*(u(x_{j+1/2}^-), u(x_{j+1/2}^+))$ 且 $F^*_{j-1/2} = F^*(u(x_{j-1/2}^-), u(x_{j-1/2}^+))$。对于我们的 $p=0$ 近似，$u(x_{j+1/2}^-) = u_j(t)$ 且 $u(x_{j+1/2}^+) = u_{j+1}(t)$。类似地，$u(x_{j-1/2}^-) = u_{j-1}(t)$ 且 $u(x_{j-1/2}^+) = u_j(t)$。\n\n结合这些结果，弱形式导出单元平均值 $u_j(t)$ 的半离散方程：\n$$\nh \\frac{d u_j}{dt} + F^*_{j+1/2} - F^*_{j-1/2} = 0\n$$\n问题指定了矩阵迎风数值通量：\n$$\nF^*_{j+1/2} = A^{+} u_j + A^{-} u_{j+1}\n$$\n使用周期性索引，单元 $j$ 左边界处的通量为：\n$$\nF^*_{j-1/2} = A^{+} u_{j-1} + A^{-} u_{j}\n$$\n将这些通量定义代入半离散方程，得到：\n$$\nh \\frac{d u_j}{dt} = - (F^*_{j+1/2} - F^*_{j-1/2}) = - \\left( (A^{+} u_j + A^{-} u_{j+1}) - (A^{+} u_{j-1} + A^{-} u_j) \\right)\n$$\n根据单元索引重新整理各项：\n$$\n\\frac{d u_j}{dt} = -\\frac{1}{h} \\left( (A^{+} - A^{-}) u_j - A^{+} u_{j-1} + A^{-} u_{j+1} \\right)\n$$\n我们使用定义 $A = R \\Lambda R^{-1}$、$A^{\\pm} = R \\Lambda^{\\pm} R^{-1}$ 以及矩阵绝对值的定义 $|A| = R|\\Lambda|R^{-1}$，其中 $|\\Lambda| = \\mathrm{diag}(|\\lambda_s|)$。一个关键的恒等式是 $\\lambda_s^{+} - \\lambda_s^{-} = \\max(\\lambda_s, 0) - \\min(\\lambda_s, 0) = |\\lambda_s|$。因此，$A^{+} - A^{-} = |A|$。方程变为：\n$$\n\\frac{d u_j}{dt} = -\\frac{1}{h} \\left( |A| u_j - A^{+} u_{j-1} + A^{-} u_{j+1} \\right)\n$$\n接下来，我们通过代入标准模态 ansatz $u_j(t) = \\hat{u} \\exp(i j \\theta + \\mu t)$ 来进行离散傅里叶分析，其中 $\\hat{u}$ 是 $\\mathbb{C}^m$ 中的一个常向量幅值。时间导数为 $\\frac{d u_j}{dt} = \\mu u_j(t)$。相邻单元的项为 $u_{j-1}(t) = \\hat{u} \\exp(i (j-1) \\theta + \\mu t) = u_j(t) \\exp(-i\\theta)$ 和 $u_{j+1}(t) = u_j(t) \\exp(i\\theta)$。\n\n将这些代入半离散方程，得到：\n$$\n\\mu u_j = -\\frac{1}{h} \\left( |A| u_j - A^{+} u_j \\exp(-i\\theta) + A^{-} u_j \\exp(i\\theta) \\right)\n$$\n两边同除以 $u_j(t)$，我们得到关于 $\\mu$ 的矩阵特征值问题：\n$$\n\\mu \\hat{u} = \\left[ -\\frac{1}{h} \\left( |A| - A^{+} \\exp(-i\\theta) + A^{-} \\exp(i\\theta) \\right) \\right] \\hat{u}\n$$\n特征值 $\\mu(\\theta)$ 是放大矩阵 $C(\\theta) = -\\frac{1}{h} \\left( |A| - A^{+} \\exp(-i\\theta) + A^{-} \\exp(i\\theta) \\right)$ 的特征值。为求得这些特征值，我们利用 $A$ 的特征分解来对角化 $C(\\theta)$：\n$$\nR^{-1} C(\\theta) R = -\\frac{1}{h} \\left( R^{-1}|A|R - R^{-1}A^{+}R \\exp(-i\\theta) + R^{-1}A^{-}R \\exp(i\\theta) \\right)\n$$\n使用 $R^{-1}A^{\\pm}R = \\Lambda^{\\pm}$ 和 $R^{-1}|A|R = |\\Lambda|$，对角化后的放大矩阵为：\n$$\nR^{-1} C(\\theta) R = -\\frac{1}{h} \\left( |\\Lambda| - \\Lambda^{+} \\exp(-i\\theta) + \\Lambda^{-} \\exp(i\\theta) \\right)\n$$\n该矩阵是对角矩阵。其对角线元素即为特征值 $\\mu_s(\\theta)$，$s=1, \\dots, m$：\n$$\n\\mu_s(\\theta) = -\\frac{1}{h} \\left( |\\lambda_s| - \\lambda_s^{+} \\exp(-i\\theta) + \\lambda_s^{-} \\exp(i\\theta) \\right)\n$$\n为求其实部，我们使用欧拉公式 $\\exp(i\\phi) = \\cos(\\phi) + i\\sin(\\phi)$：\n$$\n\\mu_s(\\theta) = -\\frac{1}{h} \\left( |\\lambda_s| - \\lambda_s^{+} (\\cos(\\theta) - i\\sin(\\theta)) + \\lambda_s^{-} (\\cos(\\theta) + i\\sin(\\theta)) \\right)\n$$\n实部 $\\mathfrak{Re}(\\mu_s(\\theta))$ 为：\n$$\n\\mathfrak{Re}(\\mu_s(\\theta)) = -\\frac{1}{h} \\left( |\\lambda_s| - \\lambda_s^{+} \\cos(\\theta) + \\lambda_s^{-} \\cos(\\theta) \\right)\n$$\n$$\n\\mathfrak{Re}(\\mu_s(\\theta)) = -\\frac{1}{h} \\left( |\\lambda_s| - (\\lambda_s^{+} - \\lambda_s^{-}) \\cos(\\theta) \\right)\n$$\n回顾 $\\lambda_s^{+} - \\lambda_s^{-} = |\\lambda_s|$，我们将其代入表达式中：\n$$\n\\mathfrak{Re}(\\mu_s(\\theta)) = -\\frac{1}{h} \\left( |\\lambda_s| - |\\lambda_s| \\cos(\\theta) \\right)\n$$\n提出因子 $|\\lambda_s|$ 得到最终结果：\n$$\n\\mathfrak{Re}(\\mu_s(\\theta)) = -\\frac{|\\lambda_s|}{h} (1 - \\cos(\\theta))\n$$\n这也可以写作 $\\frac{|\\lambda_s|}{h} (\\cos(\\theta) - 1)$。该表达式表明，对于 $A$ 的任意实特征值 $\\lambda_s$，半离散算子对应特征值的实部总是非正的，因为 $h > 0$，$|\\lambda_s| \\ge 0$，且 $1 - \\cos(\\theta) \\ge 0$。此性质被称为数值耗散，在与合适的时间积分方案结合时，对方法的稳定性至关重要。",
            "answer": "$$\\boxed{\\frac{|\\lambda_{s}|}{h} (\\cos(\\theta) - 1)}$$"
        }
    ]
}