## 引言
间断伽辽金（DG）方法作为求解偏微分方程的一种强大数值技术，其核心优势在于能够在不连续的单元上使用高阶[多项式逼近](@entry_id:137391)解。然而，这种单元间的“不连续性”也带来了根本性的挑战：我们应如何定义和计算跨越单元边界的通量，以确保信息的正确传递和物理量的守恒？

本文聚焦于解决这一问题的关键机制——单元间[数值通量](@entry_id:752791)。数值通量是连接离散单元、控制格式稳定性和精度的桥梁。通过系统地阐述其设计原理和性质，本文旨在填补DG方法基础理论与实际应用之间的知识鸿沟。

在接下来的内容中，读者将踏上一段从理论到实践的深入学习之旅：

*   **第一章：原理与机制** 将深入剖析[数值通量](@entry_id:752791)的数学基础，从迹、跳跃等基本定义出发，阐明其必须满足的一致性和守恒性原则，并以线性[平流方程](@entry_id:144869)为例，对比[中心通量](@entry_id:747204)与[迎风通量](@entry_id:143931)，揭示数值耗散对稳定性的关键作用。
*   **第二章：应用与交叉学科联系** 将展示数值通量在计算流体动力学、电磁学、地球物理学等多个领域的广泛应用，探讨如何通过[近似黎曼求解器](@entry_id:267136)（如HLL和[Rusanov通量](@entry_id:637224)）处理复杂的[非线性](@entry_id:637147)问题和物理界面。
*   **第三章：动手实践** 提供了一系列精心设计的问题，旨在通过具体的计算和比较，帮助读者将理论知识转化为实际操作能力，从而加深对不同数值通量特性的理解。

通过这三个章节的学习，您将全面掌握单元间数值通量的核心概念，并理解其在现代科学与工程计算中的重要地位。

## 原理与机制

本章旨在深入探讨间断 Galerkin (DG) 方法的核心构件：单元间数值通量。在上一章介绍 DG 方法的基本框架后，我们现在将注意力转向连接离散单元并控制整个系统行为的关键机制。DG 方法的灵活性和强大功能在很大程度上源于其处理单元边界上[不连续性](@entry_id:144108)的方式，而这正是通过精心设计的[数值通量](@entry_id:752791)来实现的。我们将从基本定义出发，系统地阐述数值通量的原理、必要性质，并通过一系列经典案例展示其在确保稳定性、精度和物理真实性方面的关键作用。

### 单元界面的剖析：迹、跳跃与平均

间断 Galerkin 方法的本质特征在于，其解在单元边界上可以是不连续的。为了精确描述和处理这种不连续性，我们需要引入一套专门的数学工具。

考虑一个计算区域，它被划分为一系列单元（如区间、三角形或四面体）。我们关注共享一个公共界面 $F$ 的两个相邻单元，记为 $K^-$ 和 $K^+$。为了明确方向，我们在界面 $F$上定义一个[单位法向量](@entry_id:178851) $\boldsymbol{n}$，其方向约定为从 $K^-$ 指向 $K^+$。因此，对于 $K^-$ 来说，$\boldsymbol{n}$ 是其外[法向量](@entry_id:264185)；而对于 $K^+$，其外法向量则是 $-\boldsymbol{n}$。

由于 DG 解 $u_h$ 在 $F$ 上的值是双值的，我们可以定义从每个单元内部逼近界面时得到的**迹 (trace)**。相对于我们选定的[法向量](@entry_id:264185) $\boldsymbol{n}$（它从 $K^-$ 指出），我们可以定义：

*   **内迹 (interior trace)** $u^-$：从[法向量](@entry_id:264185)始发的单元 $K^-$ 内部逼近界面 $F$ 时 $u_h$ 的极限值。
*   **外迹 (exterior trace)** $u^+$：从法向量指向的单元 $K^+$ 内部逼近界面 $F$ 时 $u_h$ 的极限值。

利用单边极限，这些迹可以被精确地定义为 ：
$$
u^-(\boldsymbol{x}) = \lim_{\epsilon \to 0^+} u_h(\boldsymbol{x} - \epsilon \boldsymbol{n}), \quad \boldsymbol{x} \in F
$$
$$
u^+(\boldsymbol{x}) = \lim_{\epsilon \to 0^+} u_h(\boldsymbol{x} + \epsilon \boldsymbol{n}), \quad \boldsymbol{x} \in F
$$

基于这两个迹，我们可以定义两个至关重要的算子：**跳跃 (jump)** 算子 $[\cdot]$ 和**平均 (average)** 算子 $\{\cdot\}$。
*   **[平均算子](@entry_id:746605)** $\{\cdot\}$ 通常定义为两个迹的算术平均值：
    $$
    \{u\} = \frac{1}{2}(u^- + u^+)
    $$
*   **标量跳跃算子** $[\cdot]$ 定义为两个迹的差。一个常见的约定是：
    $$
    [u] = u^+ - u^-
    $$

这些算子的定义与[法向量](@entry_id:264185) $\boldsymbol{n}$ 的方向选择密切相关。如果我们反转法向量的方向，即选择从 $K^+$ 指向 $K^-$ 的新法向量 $\boldsymbol{n}' = -\boldsymbol{n}$，那么 $K^+$ 就变成了“内部”单元，而 $K^-$ 成了“外部”单元。这将导致内迹和外迹的角色互换：新的内迹 $u'^-$ 等于旧的外迹 $u^+$，新的外迹 $u'^+$ 等于旧的内迹 $u^-$。

这种方向的改变对平均和跳跃算子有不同的影响 ：
*   平均值是**不变的**：$\{u\}' = \frac{1}{2}(u'^- + u'^+) = \frac{1}{2}(u^+ + u^-) = \{u\}$。
*   跳跃值会**改变符号**：$[u]' = u'^+ - u'^- = u^- - u^+ = -(u^+ - u^-) = -[u]$。

[平均算子](@entry_id:746605)的[不变性](@entry_id:140168)与跳跃算子的奇性（关于法向量方向）是 DG 方法离散守恒性的基石。

### 数值通量：跨越不连续性的桥梁

现在我们来探讨为何以及如何引入[数值通量](@entry_id:752791)。在任一单元 $K$ 上应用 DG 方法，我们从[偏微分方程](@entry_id:141332)的弱形式出发，通过[分部积分](@entry_id:136350)得到一个边界积分项。例如，对于守恒律 $\partial_t u + \nabla \cdot \boldsymbol{f}(u) = 0$，其[弱形式](@entry_id:142897)包含边界积分 $\int_{\partial K} (\boldsymbol{f}(u_h) \cdot \boldsymbol{n}_K) v_h \,ds$，其中 $\boldsymbol{n}_K$ 是单元 $K$ 的外法向量。

在单元间的共享界面 $F$ 上，由于 $u_h$ 的不连续性，物理通量 $\boldsymbol{f}(u_h)$ 的值是模糊不清的。我们究竟应该使用 $u^-$ 还是 $u^+$ 来计算通量？DG 方法的精髓在于，它不选择任何一方，而是引入一个全新的量——**[数值通量](@entry_id:752791) (numerical flux)**，记为 $\widehat{f_n}$ 或 $\widehat{\boldsymbol{f}\cdot\boldsymbol{n}}$，来替代这个模糊的物理通量。这个[数值通量](@entry_id:752791)是一个在界面上单值的函数，它同时依赖于界面两侧的状态 $u^-$ 和 $u^+$，以及界面的[法向量](@entry_id:264185) $\boldsymbol{n}$。

一个关键的洞察是，我们只关心跨越界面的输运过程，这由物理通量向量的**法向分量** $\boldsymbol{f}(u) \cdot \boldsymbol{n}$ 决定。通量向量的切向分量描述的是沿界面的流动，对单元间的交换没有贡献。因此，[数值通量](@entry_id:752791) $\widehat{f_n}$ 是一个**标量**函数，其设计目标就是为了近似这个标量物理法向通量 。

为了使 DG 格式有意义，任何一个[数值通量](@entry_id:752791)都必须满足三个基本性质 ：

1.  **一致性 (Consistency)**：如果界面两侧的状态恰好相等，即 $u^- = u^+ = u$，那么数值通量必须退化为物理通量的法向分量。
    $$
    \widehat{f_n}(u, u; \boldsymbol{n}) = \boldsymbol{f}(u) \cdot \boldsymbol{n}
    $$
    这个性质确保了当数值解趋于光滑时，我们的格式能够正确地逼近原始的[偏微分方程](@entry_id:141332)。

2.  **守恒性 (Conservativity)** 或对称性：从单元 $K^-$ 流出界面 $F$ 的通量必须等于流入相邻单元 $K^+$ 的通量。这要求数值通量在交换左右状态并反转[法向量](@entry_id:264185)时，其值也相应地反号。
    $$
    \widehat{f_n}(u^-, u^+; \boldsymbol{n}) = - \widehat{f_n}(u^+, u^-; -\boldsymbol{n})
    $$
    这个性质保证了在整个计算区域内，离散质量（或动量、能量等）是守恒的，这是获得物理真实解的关键。

3.  **正确的映射关系 (Function Signature)**：数值通量是一个将界面两侧的多项式迹函数映射到界面上某个（通常也是多项式的）空间的函数。例如，如果单元 $K^-$ 和 $K^+$ 上的解分别为 $p_{K^-}$ 次和 $p_{K^+}$ 次多项式，那么它们的迹在界面 $F$ 上也分别是 $p_{K^-}$ 次和 $p_{K^+}$ 次多项式。数值通量 $\widehat{f_n}$ 就将这两个迹函数作为输入，并输出一个定义在 $F$ 上的函数，以便与[检验函数](@entry_id:166589)相乘并进行积分 。

### 线性平流方程的基本数值通量

理解不同[数值通量](@entry_id:752791)行为的最佳起点是研究最简单的非平凡双曲方程：一维线性平流方程 $u_t + a u_x = 0$，其中 $a$ 是常数波速。其物理通量为 $f(u) = au$。

#### [中心通量](@entry_id:747204)

最直观的数值通量构造方法之一是对界面两侧的物理通量取平均值，这被称为**[中心通量](@entry_id:747204) (central flux)**。
$$
\widehat{f}(u^-, u^+) = \frac{f(u^-) + f(u^+)}{2} = a \frac{u^- + u^+}{2} = a\{u\}
$$
不难验证，该通量满足一致性和守恒性。然而，它的一个重要特性是缺乏[数值耗散](@entry_id:168584)。通过 $L^2$ 能量分析可以证明，使用[中心通量](@entry_id:747204)的 DG 格式是严格[能量守恒](@entry_id:140514)的，即 $\frac{d}{dt} \int_\Omega u_h^2 dx = 0$ 。虽然听起来不错，但这通常会导致在不连续点附近产生并传播非物理的[数值振荡](@entry_id:163720)，使得格式不够鲁棒。

#### [迎风通量](@entry_id:143931)

另一个基本思想是让通量反映信息的传播方向。在线性平流问题中，信息以速度 $a$ 传播。因此，界面上的通量应该由**上游 (upwind)** 的状态决定。这就是**[迎风通量](@entry_id:143931) (upwind flux)** 的思想。
$$
\widehat{f}(u^-, u^+) = a u^{\text{up}} = \begin{cases} a u^-  \text{if } a > 0 \quad (\text{信息从左向右传播}) \\ a u^+  \text{if } a  0 \quad (\text{信息从右向左传播}) \end{cases}
$$
与[中心通量](@entry_id:747204)形成鲜明对比，[迎风通量](@entry_id:143931)引入了**[数值耗散](@entry_id:168584) (numerical dissipation)**。能量分析表明，使用[迎风通量](@entry_id:143931)的 DG 格式会使离散 $L^2$ 能量随时间衰减 ：
$$
\frac{d}{dt} \left( \frac{1}{2} \int_\Omega u_h^2 dx \right) = -\frac{|a|}{2} \sum_{\text{界面}} [u_h]^2 \le 0
$$
能量的耗散仅发生在解不连续的地方（即 $[u_h] \neq 0$）。这种耗散机制能够有效地抑制[数值振荡](@entry_id:163720)，从而使格式变得稳定和鲁棒。

### [数值耗散](@entry_id:168584)与稳定性

[迎风通量](@entry_id:143931)引入的耗散是 DG 方法稳定性的关键。我们可以将[中心通量](@entry_id:747204)和[迎风通量](@entry_id:143931)纳入一个更广泛的框架中来更深入地理解[数值耗散](@entry_id:168584)。考虑一族通量，形式为 ：
$$
\widehat{f}(u^-, u^+) = a\{u\} - \frac{\alpha}{2}[u]
$$
这里，第一项 $a\{u\}$ 是无耗散的[中心通量](@entry_id:747204)部分，第二项 $-\frac{\alpha}{2}[u]$ 是一个与解的跳跃成正比的耗散项，其中 $\alpha$ 是一个可调参数，控制着耗散的强度。

对这个通量族进行能量分析，可以得到能量变化率的精确表达式 ：
$$
\frac{d}{dt} \left( \int_\Omega u_h^2 dx \right) = -\alpha \sum_{\text{界面}} ([u_h])^2
$$
为了保证能量不增，即格式是 $L^2$ 稳定的，我们必须有 $\alpha \ge 0$。

*   当 $\alpha=0$ 时，我们恢复了[能量守恒](@entry_id:140514)但可能不稳定的[中心通量](@entry_id:747204)。
*   当 $\alpha=|a|$ 时，该通量恰好等价于[迎风通量](@entry_id:143931)，提供了保证稳定性的最小耗散量。

这种耗散项在[偏微分方程](@entry_id:141332)的层面可以被解释为一种**[数值粘性](@entry_id:142854) (numerical viscosity)**。通过修正方程分析 (modified equation analysis) 可以揭示，对于一阶格式，数值通量中的耗散项 $\frac{\alpha}{2}(u^- - u^+)$ 在宏观上表现为一个添加到原方程中的[二阶导数](@entry_id:144508)项 $\nu_{\text{num}} u_{xx}$，其中数值粘性系数 $\nu_{\text{num}}$ 与 $\alpha h$ 成正比（$h$ 为网格尺寸）。因此，$\alpha$ 的选择直接决定了格式的耗散性或粘性。

### 面向[非线性](@entry_id:637147)问题的通量：[黎曼求解器](@entry_id:754362)及其他

对于[非线性](@entry_id:637147)守恒律 $u_t + f(u)_x = 0$，情况变得更加复杂。[波速](@entry_id:186208) $f'(u)$ 不再是常数，而是依赖于解本身。这催生了更精巧的[数值通量](@entry_id:752791)设计。

#### Lax-Friedrichs (Rusanov) 通量

这是[中心通量](@entry_id:747204)思想的一个直接推广，通过添加一个足够强的耗散项来确保稳定性。其形式为：
$$
\widehat{f}(u^-, u^+) = \frac{1}{2}(f(u^-) + f(u^+)) - \frac{s}{2}(u^+ - u^-)
$$
这里的参数 $s$ 必须足够大以稳定格式，通常取为界面两侧最大特征速度（[波速](@entry_id:186208)）的估计值，即 $s \ge \max(|f'(u^-)|, |f'(u^+)|)$。这种自适应的选择方法，如令 $s = \max(|f'(u^-)|, |f'(u^+)|)$，被称为 **Rusanov** 或 **局部 Lax-Friedrichs** 通量 。它足够简单且鲁棒，但往往比必要的耗散更大，可能过度抹平解的细节。例如，对于线性问题，若取 $s  |a|$，它引入的数值粘性就比迎风格式更大，差额为 $\frac{h}{2}(s - |a|)$ 。

#### [近似黎曼求解器](@entry_id:267136)

一种更物理的观点是将数值通量看作是界面上局部**[黎曼问题](@entry_id:171440) (Riemann problem)** 解的体现。黎曼问题是指一个具有阶跃初值的守恒律问题。其解是[自相似](@entry_id:274241)的，依赖于变量 $x/t$。数值通量可以被定义为该[自相似解](@entry_id:164839)在 $x/t=0$ 处（即界面位置）的物理通量值。

由于精确求解[黎曼问题](@entry_id:171440)通常代价高昂，人们开发了各种**[近似黎曼求解器](@entry_id:267136)**。**HLL (Harten-Lax-van Leer) 通量**是其中的一个典型代表。它假设[黎曼问题](@entry_id:171440)的解结构由两个分别以速度 $s_L$ 和 $s_R$ 传播的波和它们之间的一个常数状态 $\boldsymbol{q}^*$ 构成。通过在两个波上强制执行 Rankine-Hugoniot 跳跃关系，可以推导出界面上的通量表达式 ：
$$
\widehat{\boldsymbol{f}}_{\text{HLL}} = \frac{s_R \boldsymbol{f}(\boldsymbol{q}^-) - s_L \boldsymbol{f}(\boldsymbol{q}^+) + s_L s_R (\boldsymbol{q}^+ - \boldsymbol{q}^-)}{s_R - s_L}
$$
其中 $s_L$ 和 $s_R$ 是对最左和最右波速的估计。HLL 通量比 Rusanov 通量更精细，因为它考虑了通量本身的加权平均，而不仅仅是状态的加权平均。

#### [熵条件](@entry_id:166346)与通量选择

当物理通量 $f(u)$ 是**非凸 (nonconvex)** 的（例如在某些[气体动力学](@entry_id:147692)模型中），一个额外的挑战出现了：仅满足守恒律的弱解可能不唯一，其中一些解（如膨胀激波）是物理上不真实的。正确的物理弱解必须满足一个称为**[熵条件](@entry_id:166346) (entropy condition)** 的附加准则。对于[标量守恒律](@entry_id:754532)，这通常由 Kruzhkov [熵不等式](@entry_id:184404)族来刻画。

数值通量的选择直接影响到离散解是否能收敛到满足[熵条件](@entry_id:166346)的物理真实解。
*   一些通量，如简单的 **Roe 通量**，虽然在许多情况下精度很高，但在所谓的“[声速点](@entry_id:755066)”（即特征速度变号处）附近可能产生熵违背的解。
*   另一些通量，如 **Lax-Friedrichs** 和 **HLL**，由于其固有的较高耗散，通常被认为是**满足[熵条件](@entry_id:166346) (entropy-satisfying)** 的。
*   对于像 Roe 通量这样的高精度通量，可以通过引入**[熵修正](@entry_id:749021) (entropy fix)** 来修复其在[声速点](@entry_id:755066)附近的行为。这通常涉及到在波速接近零时局部地增加耗散 。

因此，对于[非线性](@entry_id:637147)问题，尤其是在存在复杂波动现象时，数值通量的选择不仅是关于稳定性和精度的问题，更是保证计算结果物理意义正确性的关键。

### 高级主题：超收敛

在特定条件下，DG 方法的解可以在某些点上表现出比其[全局收敛](@entry_id:635436)阶更高的[收敛速度](@entry_id:636873)，这种现象被称为**超收敛 (superconvergence)**。

一个经典的例子是，对于一维线性[平流方程](@entry_id:144869)，当使用以下特定组合时 ：
1.  均匀网格；
2.  迎风[数值通量](@entry_id:752791)；
3.  一个特殊的初始投影，称为右 Gauss-Radau 投影。

DG 解在每个单元的**下游端点 (downwind node)** 的[误差收敛](@entry_id:137755)阶可以达到 $\mathcal{O}(h^{2p+1})$，其中 $p$ 是多项式的次数。这远高于全局 $L^2$ 误差的收敛阶 $\mathcal{O}(h^{p+1})$。这种“意外的”高精度源于 DG 格式内部误差矩的一种精巧的抵消机制。超收敛现象是 DG 方法理论研究的一个活跃领域，它揭示了该方法深层次的数学结构，并可被用于开发更高效的误差估计和[自适应算法](@entry_id:142170)。