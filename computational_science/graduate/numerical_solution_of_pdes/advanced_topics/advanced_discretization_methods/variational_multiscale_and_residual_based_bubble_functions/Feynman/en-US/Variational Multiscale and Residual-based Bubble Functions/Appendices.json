{
    "hands_on_practices": [
        {
            "introduction": "This exercise is foundational, guiding you through the core algebraic mechanism of Variational Multiscale (VMS) methods known as static condensation. By explicitly deriving the stabilized stiffness matrix for a simple reaction-diffusion problem, you will see exactly how enriching the solution space with a \"bubble\" function and then eliminating its degree of freedom modifies the original coarse-scale equations, introducing a stabilization term naturally. This practice demystifies the origin of stabilization terms by revealing them as the Schur complement of the fine-scale block in the enriched system. ",
            "id": "3460285",
            "problem": "Consider the stationary one-dimensional reaction–diffusion model problem on a single finite element $K=[0,h]$ with constant coefficients: find $u$ such that\n$$\n- \\nu \\frac{d^{2}u}{dx^{2}} + \\lambda u = f \\quad \\text{on } K,\n$$\nwhere $\\nu>0$ is the diffusivity and $\\lambda \\ge 0$ is the reaction coefficient. Use the standard Galerkin method enriched by a single residual-based bubble function in the sense of the Variational Multiscale (VMS) method. On $K$, let the $P_{1}$ (piecewise linear) basis be the nodal functions $N_{1}(x)=1-\\frac{x}{h}$ and $N_{2}(x)=\\frac{x}{h}$, and enrich the trial and test spaces with the element-internal bubble function $b(x)=4 N_{1}(x) N_{2}(x)$ with its scalar degree of freedom $u_{b}$ restricted to $K$.\n\nDenote the element vector of unknowns by\n$$\n\\begin{pmatrix} u_{1} \\\\ u_{2} \\\\ u_{b} \\end{pmatrix},\n$$\nand the corresponding partitioned element stiffness matrix by\n$$\n\\begin{pmatrix}\nK_{hh} & K_{hb} \\\\\nK_{bh} & K_{bb}\n\\end{pmatrix},\n$$\nwhere $K_{hh}\\in\\mathbb{R}^{2\\times 2}$, $K_{hb}\\in\\mathbb{R}^{2\\times 1}$, $K_{bh}=K_{hb}^{\\top}\\in\\mathbb{R}^{1\\times 2}$, and $K_{bb}\\in\\mathbb{R}^{1\\times 1}$. Each block is defined from the bilinear form of the weak statement,\n$$\na(w,u)=\\int_{0}^{h} \\nu \\frac{dw}{dx}\\frac{du}{dx}\\,dx + \\int_{0}^{h} \\lambda\\, w\\,u\\,dx,\n$$\nby taking $w$ and $u$ from the appropriate pairs of basis functions.\n\nPerform static condensation of the bubble degree of freedom to eliminate $u_{b}$ locally and express the two-by-two stabilized Schur complement\n$$\nK_{\\text{stab}} \\;=\\; K_{hh} \\;-\\; K_{hb}\\,K_{bb}^{-1}\\,K_{bh}\n$$\nas a closed-form analytic expression in terms of $\\nu$, $\\lambda$, and $h$, using only the definitions given above and fundamental calculus. Your final answer must be the fully simplified $2\\times 2$ matrix $K_{\\text{stab}}$ written in closed form. Do not introduce any additional approximations. No rounding is required, and no units should be included in the final expression.",
            "solution": "The problem is valid as it is scientifically grounded in the theory of numerical methods for partial differential equations, is well-posed, objective, and contains all necessary information for a unique solution.\n\nThe objective is to compute the stabilized element stiffness matrix $K_{\\text{stab}}$ resulting from the static condensation of a bubble degree of freedom. The formula for the Schur complement is given as:\n$$\nK_{\\text{stab}} = K_{hh} - K_{hb}\\,K_{bb}^{-1}\\,K_{bh}\n$$\nThe analysis is performed on a single element $K=[0,h]$. The finite element space is spanned by the standard linear basis functions $N_1$, $N_2$ and an element-internal bubble function $b$. The basis functions and their derivatives are:\n$$\nN_{1}(x) = 1-\\frac{x}{h}, \\quad N_{1}'(x) = -\\frac{1}{h}\n$$\n$$\nN_{2}(x) = \\frac{x}{h}, \\quad N_{2}'(x) = \\frac{1}{h}\n$$\n$$\nb(x) = 4 N_{1}(x) N_{2}(x) = 4 \\left(1-\\frac{x}{h}\\right) \\frac{x}{h} = \\frac{4}{h^2}(hx - x^2), \\quad b'(x) = \\frac{4}{h^2}(h - 2x)\n$$\nThe stiffness matrix components are derived from the bilinear form:\n$$\na(w,u)=\\int_{0}^{h} \\left( \\nu \\frac{dw}{dx}\\frac{du}{dx} + \\lambda w u \\right) dx\n$$\nWe compute the matrix blocks $K_{hh}$, $K_{bb}$, and $K_{hb}$ by integrating the products of the basis functions and their derivatives. Each block matrix can be written as a sum of a diffusive part (proportional to $\\nu$) and a reactive part (proportional to $\\lambda$).\n\nFirst, we compute the standard $P_1$ element stiffness matrix, $K_{hh} \\in \\mathbb{R}^{2\\times 2}$. The components are $(K_{hh})_{ij} = a(N_i, N_j)$.\nThe diffusive part consists of entries $\\int_0^h N_i' N_j' dx$:\n$$\n\\int_0^h (N_1')^2 dx = \\int_0^h \\left(-\\frac{1}{h}\\right)^2 dx = \\frac{1}{h}\n$$\n$$\n\\int_0^h N_1' N_2' dx = \\int_0^h \\left(-\\frac{1}{h}\\right)\\left(\\frac{1}{h}\\right) dx = -\\frac{1}{h}\n$$\n$$\n\\int_0^h (N_2')^2 dx = \\int_0^h \\left(\\frac{1}{h}\\right)^2 dx = \\frac{1}{h}\n$$\nThe reactive part (mass matrix) consists of entries $\\int_0^h N_i N_j dx$:\n$$\n\\int_0^h N_1^2 dx = \\int_0^h \\left(1-\\frac{x}{h}\\right)^2 dx = \\left[-\\frac{h}{3}\\left(1-\\frac{x}{h}\\right)^3\\right]_0^h = \\frac{h}{3}\n$$\n$$\n\\int_0^h N_1 N_2 dx = \\int_0^h \\left(1-\\frac{x}{h}\\right)\\frac{x}{h} dx = \\left[\\frac{x^2}{2h} - \\frac{x^3}{3h^2}\\right]_0^h = \\frac{h}{2}-\\frac{h}{3}=\\frac{h}{6}\n$$\n$$\n\\int_0^h N_2^2 dx = \\int_0^h \\left(\\frac{x}{h}\\right)^2 dx = \\left[\\frac{x^3}{3h^2}\\right]_0^h = \\frac{h}{3}\n$$\nCombining these gives $K_{hh}$:\n$$\nK_{hh} = \\nu \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} + \\lambda \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\nu}{h} + \\frac{\\lambda h}{3} & -\\frac{\\nu}{h} + \\frac{\\lambda h}{6} \\\\ -\\frac{\\nu}{h} + \\frac{\\lambda h}{6} & \\frac{\\nu}{h} + \\frac{\\lambda h}{3} \\end{pmatrix}\n$$\n\nNext, we compute the bubble-bubble interaction term, $K_{bb} \\in \\mathbb{R}^{1\\times 1}$, which is the scalar $a(b,b)$.\nDiffusive part:\n$$\n\\int_0^h (b')^2 dx = \\int_0^h \\left(\\frac{4}{h^2}(h-2x)\\right)^2 dx = \\frac{16}{h^4} \\int_0^h (h^2 - 4hx + 4x^2) dx = \\frac{16}{h^4} \\left[h^2x - 2hx^2 + \\frac{4}{3}x^3\\right]_0^h = \\frac{16}{h^4} \\left(h^3 - 2h^3 + \\frac{4}{3}h^3\\right) = \\frac{16}{3h}\n$$\nReactive part:\n$$\n\\int_0^h b^2 dx = \\int_0^h \\left(\\frac{4}{h^2}(hx-x^2)\\right)^2 dx = \\frac{16}{h^4} \\int_0^h (h^2x^2 - 2hx^3 + x^4) dx = \\frac{16}{h^4} \\left[\\frac{h^2x^3}{3} - \\frac{2hx^4}{4} + \\frac{x^5}{5}\\right]_0^h = \\frac{16}{h^4} \\left(\\frac{h^5}{3} - \\frac{h^5}{2} + \\frac{h^5}{5}\\right) = \\frac{16h}{30} = \\frac{8h}{15}\n$$\nCombining these gives $K_{bb}$:\n$$\nK_{bb} = \\nu \\frac{16}{3h} + \\lambda \\frac{8h}{15} = \\frac{8}{15h}(10\\nu + \\lambda h^2)\n$$\nSince $\\nu > 0$ and $\\lambda \\ge 0$, $K_{bb} > 0$ and its inverse $K_{bb}^{-1}$ exists.\n$$\nK_{bb}^{-1} = \\frac{1}{\\nu \\frac{16}{3h} + \\lambda \\frac{8h}{15}} = \\frac{15h}{8(10\\nu + \\lambda h^2)}\n$$\n\nNow, we compute the coupling block $K_{hb} \\in \\mathbb{R}^{2\\times 1}$ with entries $(K_{hb})_i = a(N_i, b)$.\nDiffusive part for $N_1$:\n$$\n\\int_0^h N_1' b' dx = \\int_0^h \\left(-\\frac{1}{h}\\right) \\left(\\frac{4}{h^2}(h-2x)\\right) dx = -\\frac{4}{h^3} \\int_0^h (h-2x) dx = -\\frac{4}{h^3} \\left[hx-x^2\\right]_0^h = 0\n$$\nThe integral for $N_2'$ is also zero due to a sign change: $\\int_0^h N_2' b' dx = 0$.\nReactive part for $N_1$:\n$$\n\\int_0^h N_1 b dx = \\int_0^h \\left(1-\\frac{x}{h}\\right) \\frac{4}{h^2}(hx-x^2) dx = \\frac{4}{h^3} \\int_0^h x(h-x)^2 dx = \\frac{4}{h^3} \\left[\\frac{h^2x^2}{2} - \\frac{2hx^3}{3} + \\frac{x^4}{4}\\right]_0^h = \\frac{4}{h^3} \\left(\\frac{h^4}{12}\\right) = \\frac{h}{3}\n$$\nReactive part for $N_2$:\n$$\n\\int_0^h N_2 b dx = \\int_0^h \\frac{x}{h} \\frac{4}{h^2}(hx-x^2) dx = \\frac{4}{h^3} \\int_0^h x^2(h-x) dx = \\frac{4}{h^3} \\left[\\frac{hx^3}{3} - \\frac{x^4}{4}\\right]_0^h = \\frac{4}{h^3} \\left(\\frac{h^4}{12}\\right) = \\frac{h}{3}\n$$\nThe coupling matrix $K_{hb}$ and its transpose $K_{bh}$ are:\n$$\nK_{hb} = \\begin{pmatrix} \\nu(0) + \\lambda \\frac{h}{3} \\\\ \\nu(0) + \\lambda \\frac{h}{3} \\end{pmatrix} = \\frac{\\lambda h}{3} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad K_{bh} = K_{hb}^{\\top} = \\frac{\\lambda h}{3} \\begin{pmatrix} 1 & 1 \\end{pmatrix}\n$$\n\nFinally, we assemble the Schur complement $K_{\\text{stab}}$. The correction term is $K_{hb} K_{bb}^{-1} K_{bh}$:\n$$\nK_{hb} K_{bb}^{-1} K_{bh} = \\left(\\frac{\\lambda h}{3} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\\right) \\left(\\frac{15h}{8(10\\nu + \\lambda h^2)}\\right) \\left(\\frac{\\lambda h}{3} \\begin{pmatrix} 1 & 1 \\end{pmatrix}\\right)\n$$\n$$\n= \\frac{\\lambda^2 h^2}{9} \\frac{15h}{8(10\\nu + \\lambda h^2)} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} = \\frac{15 \\lambda^2 h^3}{72(10\\nu + \\lambda h^2)} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} = \\frac{5 \\lambda^2 h^3}{24(10\\nu + \\lambda h^2)} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\nThe stabilized stiffness matrix is $K_{\\text{stab}} = K_{hh} - K_{hb} K_{bb}^{-1} K_{bh}$:\n$$\nK_{\\text{stab}} = \\begin{pmatrix} \\frac{\\nu}{h} + \\frac{\\lambda h}{3} & -\\frac{\\nu}{h} + \\frac{\\lambda h}{6} \\\\ -\\frac{\\nu}{h} + \\frac{\\lambda h}{6} & \\frac{\\nu}{h} + \\frac{\\lambda h}{3} \\end{pmatrix} - \\frac{5 \\lambda^2 h^3}{24(10\\nu + \\lambda h^2)} \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\nWriting out the components explicitly yields the final result.\n$$\n(K_{\\text{stab}})_{11} = (K_{\\text{stab}})_{22} = \\frac{\\nu}{h} + \\frac{\\lambda h}{3} - \\frac{5 \\lambda^2 h^3}{24(10\\nu + \\lambda h^2)}\n$$\n$$\n(K_{\\text{stab}})_{12} = (K_{\\text{stab}})_{21} = -\\frac{\\nu}{h} + \\frac{\\lambda h}{6} - \\frac{5 \\lambda^2 h^3}{24(10\\nu + \\lambda h^2)}\n$$\nThis gives the fully specified $2 \\times 2$ matrix $K_{\\text{stab}}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\nu}{h} + \\frac{\\lambda h}{3} - \\frac{5 \\lambda^{2} h^{3}}{24(10\\nu + \\lambda h^{2})} & -\\frac{\\nu}{h} + \\frac{\\lambda h}{6} - \\frac{5 \\lambda^{2} h^{3}}{24(10\\nu + \\lambda h^{2})} \\\\\n-\\frac{\\nu}{h} + \\frac{\\lambda h}{6} - \\frac{5 \\lambda^{2} h^{3}}{24(10\\nu + \\lambda h^{2})} & \\frac{\\nu}{h} + \\frac{\\lambda h}{3} - \\frac{5 \\lambda^{2} h^{3}}{24(10\\nu + \\lambda h^{2})}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Real-world problems often feature sharp material interfaces where physical properties, such as diffusion coefficients, change abruptly. This practice explores how residual-based bubbles can be intelligently designed to handle such discontinuities, a task where standard finite element methods often struggle with accuracy. By constructing an \"interface-aware\" bubble and comparing its effect on flux continuity to both the standard and the Extended Finite Element Method (XFEM) solutions, you will gain practical insight into how VMS can be tailored to restore crucial physical conservation laws. ",
            "id": "3460319",
            "problem": "Consider the one-dimensional second-order elliptic boundary value problem on the domain $[0,1]$ given by $- \\frac{d}{dx}\\left(a(x)\\frac{d u(x)}{dx}\\right) = f(x)$ with homogeneous forcing $f(x) = 0$ and Dirichlet boundary conditions $u(0)=0$ and $u(1)=1$. The diffusion coefficient $a(x)$ is piecewise constant with a single discontinuity at an interface location $x = x_{\\mathrm{I}}$, so that $a(x) = a^{-}$ for $x < x_{\\mathrm{I}}$ and $a(x) = a^{+}$ for $x > x_{\\mathrm{I}}$, with $a^{-} > 0$ and $a^{+} > 0$. The exact solution has continuous flux across the interface, i.e., $[a(x)u'(x)]_{x_{\\mathrm{I}}} = 0$ where $[\\cdot]_{x_{\\mathrm{I}}}$ denotes the jump across $x_{\\mathrm{I}}$.\n\nWe discretize the domain using a uniform mesh with $N$ elements of size $h = 1/N$ and standard linear Lagrange finite elements. Assume exact integration of the element stiffnesses, including cut elements that are intersected by the interface, by decomposing such elements into subsegments with the appropriate $a(x)$. The resulting coarse-scale finite element solution $u_{h}(x)$ is piecewise linear per element and globally continuous; on any cut element $[x_{k}, x_{k+1}]$ containing $x_{\\mathrm{I}}$, its slope is constant, $u_{h}'(x) = c_{1}$ for $x \\in (x_{k}, x_{k+1})$, and its flux jump at the interface is $J_{\\mathrm{FE}} = \\left|a^{-} c_{1} - a^{+} c_{1}\\right|$.\n\nIn the variational multiscale framework, consider constructing a residual-based bubble function $b(x)$ supported on the cut element $[x_{k}, x_{k+1}]$, with $b(x_{k}) = b(x_{k+1}) = 0$, and piecewise linear within the subsegments $[x_{k}, x_{\\mathrm{I}}]$ and $[x_{\\mathrm{I}}, x_{k+1}]$. Denote subsegment lengths $\\ell_{-} = x_{\\mathrm{I}} - x_{k}$ and $\\ell_{+} = x_{k+1} - x_{\\mathrm{I}}$. Let $b'(x)$ be constant on each subsegment, with $b'(x) = \\beta_{-}$ for $x \\in (x_{k}, x_{\\mathrm{I}})$ and $b'(x) = -\\beta_{+}$ for $x \\in (x_{\\mathrm{I}}, x_{k+1})$, and enforce continuity of $b(x)$ at $x_{\\mathrm{I}}$. Define the corrected coarse-scale solution on the cut element by $u_{h}^{\\mathrm{bub}}(x) = u_{h}(x) + b(x)$, and choose $\\beta_{-}$ and $\\beta_{+}$ such that the corrected flux is continuous at the interface, i.e., $a^{-}\\left(c_{1} + \\beta_{-}\\right) = a^{+}\\left(c_{1} - \\beta_{+}\\right)$, together with the continuity constraint $\\beta_{-}\\ell_{-} = \\beta_{+}\\ell_{+}$ implied by $b(x_{\\mathrm{I}}^{-}) = b(x_{\\mathrm{I}}^{+})$. This produces a residual-based bubble that restores interface-aware flux continuity. The bubble-corrected flux jump is $J_{\\mathrm{bub}} = \\left|a^{-}\\left(c_{1} + \\beta_{-}\\right) - a^{+}\\left(c_{1} - \\beta_{+}\\right)\\right|$.\n\nFor comparison, consider an Extended Finite Element Method (XFEM) enrichment localized to the cut element that admits independent slopes on either side of the interface while preserving continuity of $u$. Let $u^{\\mathrm{XFEM}}(x)$ be piecewise linear on the two subsegments with slopes $s_{-}$ on $[x_{k}, x_{\\mathrm{I}}]$ and $s_{+}$ on $[x_{\\mathrm{I}}, x_{k+1}]$, constrained by the nodal values at $x_{k}$ and $x_{k+1}$, so that $s_{-}\\ell_{-} + s_{+}\\ell_{+} = \\Delta$, where $\\Delta = u_{h}(x_{k+1}) - u_{h}(x_{k}) = c_{1} h$. The energy-minimizing choice implied by the weak form yields a constant flux $C$ such that $a^{-} s_{-} = a^{+} s_{+} = C$, with $C = \\Delta\\left(\\ell_{-}/a^{-} + \\ell_{+}/a^{+}\\right)^{-1}$. The XFEM flux jump is $J_{\\mathrm{XFEM}} = \\left|a^{-} s_{-} - a^{+} s_{+}\\right|$.\n\nYour task is to implement a program that:\n- Constructs the global stiffness matrix for the coarse-scale linear finite element discretization with exact integration of cut elements, solves for $u_{h}$ under the Dirichlet boundary conditions, and computes $J_{\\mathrm{FE}}$ for the cut element containing the interface. If the interface coincides with a mesh node, define $J_{\\mathrm{FE}} = 0$.\n- Constructs the residual-based bubble on the cut element as described, computes the corrected slopes $(c_{1} + \\beta_{-})$ and $(c_{1} - \\beta_{+})$, and evaluates $J_{\\mathrm{bub}}$. If the interface coincides with a node, define $J_{\\mathrm{bub}} = 0$.\n- Constructs the local XFEM enrichment that admits independent slopes $s_{-}$ and $s_{+}$ satisfying the nodal constraint and the constant flux condition, computes $J_{\\mathrm{XFEM}}$. If the interface coincides with a node, define $J_{\\mathrm{XFEM}} = 0$.\n\nStart from the following fundamental bases:\n- The Galerkin finite element weak form for $f(x) = 0$ yields a symmetric positive definite linear system $K \\mathbf{u} = \\mathbf{0}$ after imposing essential boundary conditions, with element stiffness matrix on $[x_{j}, x_{j+1}]$ given by $\\frac{a_{e}}{h}\\begin{bmatrix}1 & -1 \\\\ -1 & 1\\end{bmatrix}$ under exact integration, where $a_{e} = a^{-}$, $a^{+}$, or the weighted average $a_{e} = \\frac{a^{-}\\ell_{-} + a^{+}\\ell_{+}}{h}$ for cut elements.\n- Interface conditions for diffusion with piecewise constant $a(x)$ are $[u]_{x_{\\mathrm{I}}} = 0$ and $[a u']_{x_{\\mathrm{I}}} = 0$.\n- For the XFEM enrichment localized to the cut element, energy minimization under the nodal constraint implies a constant flux across the interface.\n\nTest Suite:\nUse the following parameter sets $(N, x_{\\mathrm{I}}, a^{-}, a^{+})$:\n1. $(4, 0.37, 1.0, 10.0)$\n2. $(8, 0.126, 5.0, 0.5)$\n3. $(5, 0.399, 2.0, 3.0)$\n4. $(10, 0.6, 7.0, 1.0)$\n5. $(3, 0.5, 1.0, 1000.0)\n\nFor each test case, compute and return the list $\\left[J_{\\mathrm{FE}}, J_{\\mathrm{bub}}, J_{\\mathrm{XFEM}}\\right]$, where each $J$ is a nonnegative real number. The final program output must be a single line containing a list of these per-case lists, formatted as a comma-separated list enclosed in square brackets. For example: $\\left[\\left[J_{\\mathrm{FE},1},J_{\\mathrm{bub},1},J_{\\mathrm{XFEM},1}\\right],\\ldots,\\left[J_{\\mathrm{FE},5},J_{\\mathrm{bub},5},J_{\\mathrm{XFEM},5}\\right]\\right]$. All numbers must be expressed as dimensionless floating-point values.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically sound, well-posed, and self-consistent. The descriptions of the standard finite element method (FEM), the residual-based bubble function correction, and the Extended Finite Element Method (XFEM) enrichment for the given one-dimensional diffusion problem are mathematically correct. The task is to compute the flux jump at the material interface for these three methods. The problem is a standard exercise in numerical methods for partial differential equations with discontinuous coefficients. We will proceed with a full solution.\n\nThe solution is implemented by first discretizing the domain and solving the coarse-scale problem using the standard linear finite element method. Then, the flux jump for this solution is computed. Finally, the bubble and XFEM corrections are constructed, and their respective flux jumps are calculated, which are expected to be zero by design.\n\n**1. Standard Finite Element Method (FEM) and Flux Jump $J_{\\mathrm{FE}}$**\n\nThe governing equation is the one-dimensional diffusion equation:\n$$\n- \\frac{d}{dx}\\left(a(x)\\frac{d u(x)}{dx}\\right) = 0, \\quad x \\in (0, 1)\n$$\nwith Dirichlet boundary conditions $u(0)=0$ and $u(1)=1$. The diffusion coefficient $a(x)$ is piecewise constant with a discontinuity at $x = x_{\\mathrm{I}}$.\n\nThe weak form is found by multiplying by a test function $v(x)$ (with $v(0)=0$) and integrating over the domain:\n$$\n\\int_0^1 a(x) \\frac{du}{dx} \\frac{dv}{dx} dx = 0\n$$\nWe discretize the domain $[0, 1]$ with $N$ uniform elements of size $h = 1/N$. The nodes are located at $x_j = j h$ for $j=0, 1, \\dots, N$. The solution $u(x)$ is approximated by a globally continuous, piecewise linear function $u_h(x) = \\sum_{j=0}^{N} U_j \\phi_j(x)$, where $\\phi_j(x)$ are the standard linear \"hat\" basis functions and $U_j$ are the nodal values.\n\nThis leads to a linear system of equations $K \\mathbf{U} = \\mathbf{F}$, where $\\mathbf{U}$ is the vector of nodal values $[U_0, U_1, \\dots, U_N]^T$. The entries of the global stiffness matrix $K$ are assembled from element stiffness matrices $K^e$. For an element $e = [x_k, x_{k+1}]$, the local stiffness matrix is given by:\n$$\nK^e_{ij} = \\int_{x_k}^{x_{k+1}} a(x) \\frac{d\\phi_i}{dx} \\frac{d\\phi_j}{dx} dx\n$$\nSince the derivatives of the linear basis functions are constant on the element ($\\pm 1/h$), this simplifies.\n- For an element where $a(x)$ is constant (either $a^{-}$ or $a^{+}$), the integral is $\\int_{x_k}^{x_{k+1}} a(x) dx = a \\cdot h$. The stiffness matrix is $K^e = \\frac{a}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n- For a \"cut\" element containing the interface $x_{\\mathrm{I}}$, with sub-segment lengths $\\ell_{-} = x_{\\mathrm{I}} - x_k$ and $\\ell_{+} = x_{k+1} - x_{\\mathrm{I}}$, the integral is $\\int_{x_k}^{x_{k+1}} a(x) dx = a^{-}\\ell_{-} + a^{+}\\ell_{+}$. The stiffness matrix, under the specified exact integration, is $K^e = \\frac{a^{-}\\ell_{-} + a^{+}\\ell_{+}}{h^2} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n\nAfter assembling the global $(N+1) \\times (N+1)$ matrix $K$, we enforce the boundary conditions $U_0 = 0$ and $U_N = 1$. This reduces the system to an $(N-1) \\times (N-1)$ system for the interior nodal values $U_1, \\dots, U_{N-1}$, which is then solved.\n\nOnce the nodal solution $\\mathbf{U}$ is found, we identify the cut element $[x_k, x_{k+1}]$. The slope of the FEM solution $u_h(x)$ on this element is constant, given by $c_1 = (U_{k+1} - U_k)/h$. The flux, $a(x) u_h'(x)$, is discontinuous across $x_{\\mathrm{I}}$. The flux jump for the standard FEM solution is:\n$$\nJ_{\\mathrm{FE}} = \\left| a^{-}c_1 - a^{+}c_1 \\right| = \\left| (a^{-} - a^{+}) c_1 \\right|\n$$\n\n**2. Residual-Based Bubble Correction and Flux Jump $J_{\\mathrm{bub}}$**\n\nThe bubble function method introduces a local correction $b(x)$ to the FEM solution within the cut element, $u_h^{\\mathrm{bub}}(x) = u_h(x) + b(x)$, such that the corrected flux is continuous. The bubble function $b(x)$ is defined to be zero at the element nodes, $b(x_k)=b(x_{k+1})=0$. It is piecewise linear on the sub-segments $[x_k, x_{\\mathrm{I}}]$ and $[x_{\\mathrm{I}}, x_{k+1}]$, with slopes $\\beta_{-}$ and $-\\beta_{+}$ respectively.\n\nTwo conditions determine $\\beta_{-}$ and $\\beta_{+}$:\n1. Continuity of the bubble at the interface: $b(x_{\\mathrm{I}})$ must be continuous. This implies $\\beta_{-}\\ell_{-} = \\beta_{+}\\ell_{+}$.\n2. Continuity of the corrected flux at the interface: $a^{-}(c_1 + \\beta_{-}) = a^{+}(c_1 - \\beta_{+})$.\n\nThese two conditions form a $2 \\times 2$ linear system for $(\\beta_{-}, \\beta_{+})$:\n$$\n\\begin{pmatrix} a^{-} & a^{+} \\\\ \\ell_{-} & -\\ell_{+} \\end{pmatrix} \\begin{pmatrix} \\beta_{-} \\\\ \\beta_{+} \\end{pmatrix} = \\begin{pmatrix} c_1(a^{+} - a^{-}) \\\\ 0 \\end{pmatrix}\n$$\nThis system is solved for $\\beta_{-}$ and $\\beta_{+}$. The flux jump of the bubble-corrected solution is defined as:\n$$\nJ_{\\mathrm{bub}} = \\left| a^{-}(c_1 + \\beta_{-}) - a^{+}(c_1 - \\beta_{+}) \\right|\n$$\nBy construction, the term inside the absolute value is zero. The implementation will compute this value as a verification, which is expected to be numerically zero.\n\n**3. XFEM Enrichment and Flux Jump $J_{\\mathrm{XFEM}}$**\n\nThe XFEM approach enriches the approximation space on the cut element to allow for a gradient discontinuity. The solution $u^{\\mathrm{XFEM}}(x)$ on $[x_k, x_{k+1}]$ is composed of two linear segments with different slopes $s_{-}$ and $s_{+}$.\n\nTwo conditions determine $s_{-}$ and $s_{+}$:\n1. Conforming to nodal values: The total change in displacement across the element must match the FEM solution's nodal values. $s_{-}\\ell_{-} + s_{+}\\ell_{+} = \\Delta U = U_{k+1}-U_k = c_1 h$.\n2. Continuous flux (from energy minimization): The weak form on the enriched element naturally leads to the condition $a^{-}s_{-} = a^{+}s_{+}$.\n\nThe constant flux $C = a^{-}s_{-} = a^{+}s_{+}$ can be found by solving this system. The problem statement provides the direct formula:\n$$\nC = \\Delta U \\left( \\frac{\\ell_{-}}{a^{-}} + \\frac{\\ell_{+}}{a^{+}} \\right)^{-1}\n$$\nFrom this, $s_{-} = C/a^{-}$ and $s_{+} = C/a^{+}$. The flux jump for the XFEM solution is:\n$$\nJ_{\\mathrm{XFEM}} = \\left| a^{-}s_{-} - a^{+}s_{+} \\right|\n$$\nBy construction, this is also zero. Our implementation will compute this value to confirm.\n\nThe provided Python code implements these three distinct calculations for each specified test case. A special check handles the case where the interface coincides with a mesh node, for which all jumps are defined to be zero.",
            "answer": "```python\nimport numpy as np\n\ndef _calculate_jumps(N, xI, a_minus, a_plus):\n    \"\"\"\n    Computes the flux jumps J_FE, J_bub, and J_XFEM for a given problem setup.\n\n    Args:\n        N (int): Number of elements in the mesh.\n        xI (float): Location of the interface.\n        a_minus (float): Diffusion coefficient for x  xI.\n        a_plus (float): Diffusion coefficient for x > xI.\n\n    Returns:\n        list: A list containing [J_FE, J_bub, J_XFEM].\n    \"\"\"\n    h = 1.0 / N\n    nodes = np.linspace(0, 1, N + 1)\n\n    # If the interface coincides with a node, all jumps are 0 by definition.\n    is_on_node = any(np.isclose(xI, node_pos) for node_pos in nodes)\n    if is_on_node:\n        return [0.0, 0.0, 0.0]\n\n    # Find the element that contains the interface\n    k_cut = -1\n    for k in range(N):\n        if nodes[k]  xI  nodes[k + 1]:\n            k_cut = k\n            break\n    \n    if k_cut == -1:\n        # This case should not be reached with the given test data.\n        raise ValueError(\"Interface location is not within any element.\")\n\n    # 1. Standard FEM solution\n    # Assemble the global stiffness matrix K\n    K = np.zeros((N + 1, N + 1))\n    for k in range(N):\n        k_local = np.array([[1, -1], [-1, 1]])\n        \n        if k == k_cut:\n            l_minus = xI - nodes[k]\n            l_plus = nodes[k + 1] - xI\n            # Effective stiffness comes from exact integration of the weak form for P1 elements,\n            # which results in an arithmetic average of the coefficient.\n            a_integrated = a_minus * l_minus + a_plus * l_plus\n            stiffness_factor = a_integrated / (h * h)\n        elif nodes[k + 1] = xI:\n            stiffness_factor = a_minus / h\n        else:  # nodes[k] >= xI\n            stiffness_factor = a_plus / h\n        \n        K[k:k + 2, k:k + 2] += stiffness_factor * k_local\n\n    # Apply boundary conditions u(0)=0, u(1)=1 to solve for interior nodes\n    K_interior = K[1:N, 1:N]\n    b = np.zeros(N - 1)\n    # The last equation is modified by the boundary condition u(N)=1\n    b[-1] = -K[N - 1, N]  # Since u_N = 1\n\n    u_interior = np.linalg.solve(K_interior, b)\n    u_h = np.concatenate(([0], u_interior, [1]))\n\n    # Compute the flux jump J_FE\n    u_k = u_h[k_cut]\n    u_k_plus_1 = u_h[k_cut + 1]\n    c1 = (u_k_plus_1 - u_k) / h\n    J_FE = np.abs((a_minus - a_plus) * c1)\n    \n    # 2. Residual-based bubble function correction\n    # J_bub should be 0 by construction. We compute it explicitly for verification.\n    l_minus_cut = xI - nodes[k_cut]\n    l_plus_cut = nodes[k_cut + 1] - xI\n    \n    # Solve for bubble slopes beta_minus and beta_plus\n    A_beta = np.array([[a_minus, a_plus], [l_minus_cut, -l_plus_cut]])\n    b_beta = np.array([c1 * (a_plus - a_minus), 0])\n    \n    beta_minus, beta_plus = np.linalg.solve(A_beta, b_beta)\n\n    flux_minus_bub = a_minus * (c1 + beta_minus)\n    flux_plus_bub = a_plus * (c1 - beta_plus)\n    J_bub = np.abs(flux_minus_bub - flux_plus_bub)\n\n    # 3. XFEM enrichment\n    # J_XFEM should be 0 by construction. We compute it explicitly for verification.\n    delta_u = u_k_plus_1 - u_k\n    \n    # The constant flux C is derived from energy minimization\n    harmonic_avg_term = l_minus_cut / a_minus + l_plus_cut / a_plus\n    C = delta_u / harmonic_avg_term\n    \n    # Slopes s_minus and s_plus are determined by C\n    s_minus = C / a_minus\n    s_plus = C / a_plus\n    \n    flux_minus_xfem = a_minus * s_minus\n    flux_plus_xfem = a_plus * s_plus\n    J_XFEM = np.abs(flux_minus_xfem - flux_plus_xfem)\n\n    return [J_FE, J_bub, J_XFEM]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (4, 0.37, 1.0, 10.0),\n        (8, 0.126, 5.0, 0.5),\n        (5, 0.399, 2.0, 3.0),\n        (10, 0.6, 7.0, 1.0),\n        (3, 0.5, 1.0, 1000.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        N, xI, a_minus, a_plus = case\n        jumps = _calculate_jumps(N, xI, a_minus, a_plus)\n        results.append(jumps)\n\n    # Format the final output string to match the problem specification\n    # e.g., [[J1,J2,J3],[J4,J5,J6]]\n    output_str = repr(results).replace(' ', '')\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Stabilizing numerical solutions for nonlinear conservation laws, which can develop sharp gradients or shocks, is a central challenge in computational physics. This exercise applies VMS principles to the viscous Burgers' equation, a canonical model for shock formation and wave steepening. You will derive and calibrate a residual-based stabilization term and compare its structure to a different class of stabilization known as entropy viscosity, providing a hands-on understanding of how these advanced methods are engineered to control non-physical oscillations and accurately capture shock structures. ",
            "id": "3460310",
            "problem": "You are asked to compare two artificial diffusion mechanisms for resolving shocks in the one-dimensional viscous Burgers equation and to calibrate their constants to achieve a prescribed shock thickness on specified grids. The focus is on variational multiscale methods with residual-based bubble functions and entropy-viscosity-type models.\n\nConsider the one-dimensional viscous Burgers equation\n$$\nu_t + \\partial_x\\left(\\tfrac{1}{2} u^2\\right) = \\nu\\, u_{xx},\n$$\nwhere $u(x,t)$ is a scalar velocity field, $x \\in \\mathbb{R}$, $t \\ge 0$, and $\\nu  0$ is a constant kinematic viscosity. Assume a steady traveling wave (shock) connecting constant end states $u_L$ and $u_R$, with $u_L  u_R$. The exact viscous traveling wave profile is known to be smooth and monotone, with a characteristic thickness that depends on an effective viscosity.\n\nYour tasks are:\n\n1) Starting from the definition of a steady traveling wave for the viscous Burgers equation, derive the ordinary differential equation satisfied by the wave profile in the shock-attached frame and obtain the monotone analytical solution. From this, derive a closed-form expression for the distance between the points where the solution attains $90\\%$ and $10\\%$ of the jump across the shock (the so-called $10$–$90$ thickness). Express this thickness as\n$$\n\\delta = \\kappa \\frac{\\nu_{\\text{eff}}}{\\Delta u},\n$$\nwhere $\\Delta u = u_L - u_R$, $\\nu_{\\text{eff}}$ is the total effective viscosity at the shock, and $\\kappa$ is a positive constant you must determine exactly from first principles as part of your derivation. State your exact value of $\\kappa$.\n\n2) Consider a variational multiscale (VMS) formulation with residual-based bubble functions applied to the linearized, steady, one-dimensional convection–diffusion operator obtained by linearizing the Burgers flux about a local mean convective speed $\\bar{u}$. Using a one-dimensional element of size $h$ with a bubble subscale that vanishes at the element endpoints, derive the exact subscale solution on the element and show that it leads to an element stabilization parameter $\\tau$ depending on the element Péclet number\n$$\n\\mathrm{Pe} = \\frac{|\\bar{u}|\\, h}{2 \\nu}.\n$$\nFrom this derivation, obtain the explicit one-dimensional expression for $\\tau$ in terms of $\\mathrm{Pe}$ and $h, \\bar{u}, \\nu$. Then, show that the stabilized method is equivalent (in one dimension) to adding a streamline-direction artificial diffusion of the form\n$$\n\\nu_{\\tau} = \\tau\\, \\bar{u}^{2}.\n$$\nIntroduce a scalar calibration factor $C_{\\tau}  0$ that multiplies the reference $\\tau$ so that the induced diffusion becomes $\\nu_{\\tau} = C_{\\tau}\\, \\tau_{\\text{ref}}\\, \\bar{u}^{2}$, and explain why such a factor is used in practice.\n\n3) Define an entropy-viscosity-type artificial diffusion as\n$$\n\\nu_{e} = C_{\\mathrm{ev}}\\, h^{2}\\, |R_h|,\n$$\nwhere $C_{\\mathrm{ev}}  0$ is a scalar calibration constant, $h$ is the uniform grid spacing, and $R_h$ is a consistent discrete residual of the steady Burgers operator evaluated at the shock center, computed using second-order central finite differences applied to the exact traveling wave profile sampled at three points $x=-h, 0, +h$. Specifically, define\n$$\nR_h = D_x\\!\\left(\\tfrac{1}{2} u^2\\right)\\Big|_{x=0} - \\nu\\, D_{xx} u\\Big|_{x=0},\n$$\nwith\n$$\nD_x f\\big|_{x=0} = \\frac{f(h) - f(-h)}{2 h}, \\qquad D_{xx} u\\big|_{x=0} = \\frac{u(h) - 2 u(0) + u(-h)}{h^{2}},\n$$\nand with the exact steady Burgers traveling wave profile connecting $u_L$ and $u_R$ centered at $x=0$ used to evaluate $u(-h), u(0), u(h)$ and $f = \\tfrac{1}{2} u^2$.\n\n4) For a given target shock thickness $\\delta_{\\text{target}} = N h$ (with a prescribed $N  0$), an underlying physical viscosity $\\nu$, and states $u_L, u_R$ with $\\Delta u = u_L - u_R  0$, define the total effective viscosity at the shock center as either\n$$\n\\nu_{\\text{eff}}^{(\\mathrm{ev})} = \\nu + \\nu_e, \\qquad \\text{or} \\qquad \\nu_{\\text{eff}}^{(\\tau)} = \\nu + \\nu_{\\tau},\n$$\nand calibrate $C_{\\mathrm{ev}}$ and $C_{\\tau}$ so that the target thickness is matched for each model:\n$$\n\\delta_{\\text{target}} = \\kappa \\frac{\\nu_{\\text{eff}}^{(\\mathrm{ev})}}{\\Delta u}, \\qquad \\delta_{\\text{target}} = \\kappa \\frac{\\nu_{\\text{eff}}^{(\\tau)}}{\\Delta u}.\n$$\nUse the mean linearization speed at the shock center $\\bar{u} = s = \\tfrac{1}{2}(u_L + u_R)$ in the $\\tau$-based model. If the required artificial diffusion would be negative (because $\\nu$ already exceeds the target), set the corresponding calibration constant to zero. All quantities in this problem are dimensionless; report all numerical answers as floating-point numbers.\n\n5) Implement a program that, for each test case below, computes the pair $\\big(C_{\\mathrm{ev}}, C_{\\tau}\\big)$ using the derivations above. To evaluate $R_h$, use the exact steady traveling wave profile centered at $x=0$:\n$$\nu(x) = s - \\frac{\\Delta u}{2}\\, \\tanh\\!\\left(\\frac{\\Delta u}{4 \\nu}\\, x\\right), \\quad s = \\frac{u_L + u_R}{2}, \\quad \\Delta u = u_L - u_R,\n$$\nsampled at $x=-h, 0, +h$.\n\nTest suite:\n- Case $1$: $u_L = 2.0$, $u_R = 0.0$, $\\nu = 1.0 \\times 10^{-3}$, $h = 1/200$, $\\delta_{\\text{target}} = 6 h$.\n- Case $2$: $u_L = 1.5$, $u_R = 0.1$, $\\nu = 2.0 \\times 10^{-4}$, $h = 1/400$, $\\delta_{\\text{target}} = 8 h$.\n- Case $3$: $u_L = 1.0$, $u_R = 0.5$, $\\nu = 5.0 \\times 10^{-4}$, $h = 1/100$, $\\delta_{\\text{target}} = 4 h$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n\\big[ C_{\\mathrm{ev}}^{(1)}, C_{\\tau}^{(1)}, C_{\\mathrm{ev}}^{(2)}, C_{\\tau}^{(2)}, C_{\\mathrm{ev}}^{(3)}, C_{\\tau}^{(3)} \\big].\n$$\nEach entry must be a floating-point number. No other text should be printed.",
            "solution": "The problem is assessed to be valid as it is scientifically sound, self-contained, well-posed, and objective. It presents a standard set of derivations and calculations within the field of numerical methods for partial differential equations. We proceed with the solution.\n\nThe solution is structured according to the five tasks specified in the problem statement.\n\n### 1. Traveling Wave Solution and Shock Thickness\n\nWe seek a steady traveling wave solution of the form $u(x, t) = U(\\xi)$, where $\\xi = x - st$ for some constant wave speed $s$. Substituting this into the one-dimensional viscous Burgers equation, $u_t + \\partial_x\\left(\\tfrac{1}{2} u^2\\right) = \\nu u_{xx}$, we obtain an ordinary differential equation (ODE) for the profile $U(\\xi)$. The partial derivatives become:\n$u_t = -s \\frac{dU}{d\\xi}$, $\\partial_x(\\frac{1}{2} u^2) = U \\frac{dU}{d\\xi}$, and $u_{xx} = \\frac{d^2U}{d\\xi^2}$.\nThe PDE transforms into:\n$$ -s \\frac{dU}{d\\xi} + U \\frac{dU}{d\\xi} = \\nu \\frac{d^2U}{d\\xi^2} $$\nThis can be written as $\\frac{d}{d\\xi}\\left(\\frac{1}{2}U^2 - sU\\right) = \\nu \\frac{d^2U}{d\\xi^2}$. Integrating with respect to $\\xi$ yields:\n$$ \\nu \\frac{dU}{d\\xi} = \\frac{1}{2}U^2 - sU + C_1 $$\nwhere $C_1$ is an integration constant. The boundary conditions are $U \\to u_L$ as $\\xi \\to -\\infty$ and $U \\to u_R$ as $\\xi \\to +\\infty$. In these limits, the wave profile is flat, so $\\frac{dU}{d\\xi} \\to 0$. Applying these conditions:\n$$ 0 = \\frac{1}{2}u_L^2 - su_L + C_1 $$\n$$ 0 = \\frac{1}{2}u_R^2 - su_R + C_1 $$\nSubtracting the two equations gives $\\frac{1}{2}(u_L^2 - u_R^2) - s(u_L - u_R) = 0$. Since $u_L  u_R$, we have $\\Delta u = u_L - u_R \\neq 0$, so we can divide by it to find the shock speed $s$:\n$$ s = \\frac{1}{2}(u_L + u_R) $$\nSubstituting $s$ back into the first equation yields the constant $C_1 = su_L - \\frac{1}{2}u_L^2 = \\frac{1}{2}(u_L+u_R)u_L - \\frac{1}{2}u_L^2 = \\frac{1}{2}u_L u_R$.\nThe ODE for the profile $U(\\xi)$ is thus:\n$$ \\nu \\frac{dU}{d\\xi} = \\frac{1}{2}U^2 - \\frac{u_L+u_R}{2}U + \\frac{1}{2}u_L u_R = \\frac{1}{2}(U - u_L)(U - u_R) $$\nThis is a separable ODE. We separate variables and integrate:\n$$ \\int \\frac{dU}{(U - u_L)(U - u_R)} = \\int \\frac{1}{2\\nu}d\\xi $$\nUsing partial fraction decomposition, $\\frac{1}{(U - u_L)(U - u_R)} = \\frac{1}{u_L-u_R}\\left(\\frac{1}{U-u_L} - \\frac{1}{U-u_R}\\right)$.\n$$ \\frac{1}{u_L-u_R} \\int \\left(\\frac{1}{U-u_L} - \\frac{1}{U-u_R}\\right) dU = \\frac{\\xi}{2\\nu} + C_2 $$\n$$ \\frac{1}{\\Delta u} \\left( \\ln|U-u_L| - \\ln|U-u_R| \\right) = \\frac{\\xi}{2\\nu} + C_2 $$\nSince $u_R  U  u_L$, we have $|U-u_L|=u_L-U$ and $|U-u_R|=U-u_R$.\n$$ \\ln\\left(\\frac{u_L-U}{U-u_R}\\right) = \\frac{\\Delta u}{2\\nu}\\xi + C_3 $$\nLet the shock be centered at $\\xi=0$, where $U(0) = \\frac{u_L+u_R}{2} = s$. At this point, $\\frac{u_L-s}{s-u_R} = \\frac{(u_L-u_R)/2}{(u_L-u_R)/2} = 1$. Thus, $\\ln(1) = 0 = C_3$.\nSolving for $U$ gives the explicit profile:\n$$ U(\\xi) = s - \\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\Delta u}{4\\nu}\\xi\\right) $$\nThe shock thickness $\\delta$ is the distance between the points $\\xi_1$ and $\\xi_2$ where the profile attains $10\\%$ and $90\\%$ of the total jump $\\Delta u = u_L - u_R$ above the right state $u_R$.\nThe two values are $u_1 = u_R + 0.9(u_L - u_R) = 0.9u_L + 0.1u_R$ and $u_2 = u_R + 0.1(u_L - u_R) = 0.1u_L + 0.9u_R$.\nFor $u_1$: $s - u_1 = \\frac{u_L+u_R}{2} - (0.9u_L + 0.1u_R) = -0.4(u_L-u_R) = -0.4\\Delta u$.\nSubstituting into the solution: $-0.4\\Delta u = -\\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\Delta u}{4\\nu}\\xi_1\\right) \\implies \\tanh\\left(\\frac{\\Delta u}{4\\nu}\\xi_1\\right) = 0.8$.\nFor $u_2$: $s - u_2 = \\frac{u_L+u_R}{2} - (0.1u_L + 0.9u_R) = 0.4(u_L-u_R) = 0.4\\Delta u$.\nSubstituting into the solution: $0.4\\Delta u = -\\frac{\\Delta u}{2}\\tanh\\left(\\frac{\\Delta u}{4\\nu}\\xi_2\\right) \\implies \\tanh\\left(\\frac{\\Delta u}{4\\nu}\\xi_2\\right) = -0.8$.\nThe positions are $\\xi_1 = \\frac{4\\nu}{\\Delta u}\\text{arctanh}(0.8)$ and $\\xi_2 = \\frac{4\\nu}{\\Delta u}\\text{arctanh}(-0.8) = -\\frac{4\\nu}{\\Delta u}\\text{arctanh}(0.8)$.\nThe thickness is $\\delta = \\xi_1 - \\xi_2 = \\frac{8\\nu}{\\Delta u}\\text{arctanh}(0.8)$.\nUsing the identity $\\text{arctanh}(z) = \\frac{1}{2}\\ln\\left(\\frac{1+z}{1-z}\\right)$, we have $\\text{arctanh}(0.8) = \\frac{1}{2}\\ln\\left(\\frac{1.8}{0.2}\\right) = \\frac{1}{2}\\ln(9) = \\ln(3)$.\nThus, the thickness is $\\delta = \\frac{8\\ln(3)}{\\Delta u}\\nu$.\nComparing this to the specified form $\\delta = \\kappa \\frac{\\nu_{\\text{eff}}}{\\Delta u}$, with $\\nu_{\\text{eff}} = \\nu$ for the exact solution, we identify the constant $\\kappa$:\n$$ \\kappa = 8 \\ln(3) $$\n\n### 2. Variational Multiscale Stabilization Parameter\n\nFor the linearized, steady convection-diffusion operator $\\mathcal{L}u = \\bar{u}u_x - \\nu u_{xx}$, the VMS formulation introduces a stabilization term based on the unresolved subgrid scales. On a 1D element of size $h$, the fine-scale (bubble) component $u'$ is the solution to $\\mathcal{L}u' = R_h$ with zero boundary conditions, where $R_h$ is the residual of the coarse-scale solution. For a constant residual $R_K$ on element $K$, the solution for $u'$ can be found analytically. The effect of this subscale on the coarse scales is equivalent to adding a term to the weak formulation. For the 1D problem, this term can be defined through a stabilization parameter $\\tau$.\nThe standard derivation, which produces a nodally exact solution for the linear 1D problem with constant coefficients, yields the following expression for $\\tau$:\n$$ \\tau = \\frac{h}{2|\\bar{u}|} \\left(\\coth(\\mathrm{Pe}) - \\frac{1}{\\mathrm{Pe}}\\right) $$\nwhere $\\mathrm{Pe}$ is the element Péclet number, defined as:\n$$ \\mathrm{Pe} = \\frac{|\\bar{u}|h}{2\\nu} $$\nThis expression for $\\tau$ is the explicit form required.\nThe stabilized finite element method adds a term proportional to $\\int_K \\tau (\\mathcal{L}u_h) (\\mathcal{L}^* v_h) dx$, where $\\mathcal{L}^*$ is the adjoint operator. For the streamline upwind/Petrov-Galerkin (SUPG) method, which is a particular case of VMS, the weighting is simplified, and the additional term in the weak form is $\\int_K \\tau R_h (\\bar{u} v_{h,x}) dx$, where $R_h = \\bar{u}u_{h,x} - \\nu u_{h,xx}$ is the element residual.\nThe part of this term involving the highest order derivative of $u_h$ is $\\int_K \\tau (\\bar{u} u_{h,x})(\\bar{u} v_{h,x}) dx = \\int_K (\\tau \\bar{u}^2) u_{h,x} v_{h,x} dx$. This term has the same form as the standard Galerkin diffusion term, $\\int_K \\nu u_{h,x} v_{h,x} dx$. Therefore, the introduction of the stabilization term is equivalent to adding an artificial diffusion $\\nu_{\\tau}$ along the streamlines (in 1D, this is the only direction):\n$$ \\nu_{\\tau} = \\tau \\bar{u}^2 $$\nThe parameter $\\tau_{\\text{ref}}$ is derived from a simplified linear model problem. In complex, nonlinear applications like the Burgers equation, this reference value may not be optimal. It might provide too much or too little stabilization. The calibration factor $C_{\\tau}$ is introduced to provide a mechanism for adjusting the level of artificial diffusion, allowing one to tune the numerical solution to achieve desired properties, such as capturing a shock with minimal oscillations and a specific thickness. The artificial diffusion is then $\\nu_\\tau = C_{\\tau} \\tau_{\\text{ref}} \\bar{u}^2$.\n\n### 3. Entropy-Viscosity-Type Artificial Diffusion\n\nThe entropy viscosity is defined as $\\nu_e = C_{\\mathrm{ev}} h^2 |R_h|$, where $R_h$ is the discrete residual of the steady Burgers equation, $R_h = D_x(\\frac{1}{2}u^2)|_{x=0} - \\nu D_{xx}u|_{x=0}$.\nThe discrete operators are second-order central differences:\n$D_x f|_{x=0} = \\frac{f(h) - f(-h)}{2h}$ and $D_{xx} u|_{x=0} = \\frac{u(h) - 2u(0) + u(-h)}{h^2}$.\nWe evaluate these using the exact traveling wave solution $u(x) = s - \\frac{\\Delta u}{2}\\tanh(\\frac{\\Delta u}{4\\nu}x)$. The profile $u(x)-s$ is an odd function of $x$. Thus, $u(h)-s = -(u(-h)-s)$, which implies $u(h)+u(-h)=2s$. Also, $u(0)=s$.\nThe discrete Laplacian is:\n$$ D_{xx} u\\big|_{x=0} = \\frac{u(h) + u(-h) - 2u(0)}{h^2} = \\frac{2s - 2s}{h^2} = 0 $$\nThe discrete residual simplifies to the convective part:\n$$ R_h = D_x(\\tfrac{1}{2}u^2)|_{x=0} = \\frac{\\frac{1}{2}u(h)^2 - \\frac{1}{2}u(-h)^2}{2h} = \\frac{u(h)^2 - u(-h)^2}{4h} $$\nUsing $u(h) = s - \\frac{\\Delta u}{2}\\tanh(\\frac{\\Delta u}{4\\nu}h)$ and $u(-h) = s + \\frac{\\Delta u}{2}\\tanh(\\frac{\\Delta u}{4\\nu}h)$:\n$u(h)^2 - u(-h)^2 = (u(h)-u(-h))(u(h)+u(-h)) = (-\\Delta u \\tanh(\\frac{\\Delta u}{4\\nu}h))(2s)$.\n$$ R_h = \\frac{-2s\\Delta u \\tanh(\\frac{\\Delta u}{4\\nu}h)}{4h} = -\\frac{s\\Delta u}{2h}\\tanh\\left(\\frac{\\Delta u h}{4\\nu}\\right) $$\nThe entropy viscosity is then:\n$$ \\nu_e = C_{ev} h^2 |R_h| = C_{ev} h^2 \\frac{s\\Delta u}{2h} \\tanh\\left(\\frac{\\Delta u h}{4\\nu}\\right) = C_{ev} \\frac{hs\\Delta u}{2} \\tanh\\left(\\frac{\\Delta u h}{4\\nu}\\right) $$\n(assuming $s0$ and $\\Delta u0$, which is true for the given test cases).\n\n### 4. Calibration of Constants\n\nThe target shock thickness is $\\delta_{\\text{target}} = N h$. Using the formula from Part 1, $\\delta = \\kappa \\frac{\\nu_{\\text{eff}}}{\\Delta u}$, we find the required total effective viscosity:\n$$ \\nu_{\\text{eff, target}} = \\frac{\\delta_{\\text{target}}\\Delta u}{\\kappa} = \\frac{N h \\Delta u}{8 \\ln(3)} $$\nThe physical viscosity is $\\nu$. The required artificial viscosity is $\\nu_{\\text{art, target}} = \\nu_{\\text{eff, target}} - \\nu$. If $\\nu_{\\text{art, target}} \\le 0$, the physical viscosity is already sufficient or excessive to achieve the target thickness, so no artificial viscosity is needed, and the calibration constants are set to $0$. Otherwise, for $\\nu_{\\text{art, target}}  0$:\n\n**Calibration of $C_{\\mathrm{ev}}$**:\nWe set $\\nu_e = \\nu_{\\text{art, target}}$:\n$$ C_{ev} \\frac{hs\\Delta u}{2} \\tanh\\left(\\frac{\\Delta u h}{4\\nu}\\right) = \\nu_{\\text{art, target}} $$\nSolving for $C_{ev}$:\n$$ C_{\\mathrm{ev}} = \\frac{2 \\nu_{\\text{art, target}}}{h s \\Delta u \\tanh\\left(\\frac{\\Delta u h}{4\\nu}\\right)} $$\n\n**Calibration of $C_{\\tau}$**:\nWe set $\\nu_{\\tau} = \\nu_{\\text{art, target}}$. The expression for $\\nu_{\\tau}$ is $\\nu_{\\tau} = C_{\\tau} \\tau_{\\text{ref}} \\bar{u}^2$. Using $\\bar{u}=s$ and the formula for $\\tau_{\\text{ref}}$:\n$$ \\nu_{\\tau} = C_{\\tau} \\left[ \\frac{h}{2s} \\left(\\coth(\\mathrm{Pe}) - \\frac{1}{\\mathrm{Pe}}\\right) \\right] s^2 = C_{\\tau} \\frac{hs}{2} \\left(\\coth(\\mathrm{Pe}) - \\frac{1}{\\mathrm{Pe}}\\right) $$\nwhere $\\mathrm{Pe} = \\frac{sh}{2\\nu}$ (assuming $s0$). Setting this equal to $\\nu_{\\text{art, target}}$:\n$$ C_{\\tau} \\frac{hs}{2} \\left(\\coth\\left(\\frac{sh}{2\\nu}\\right) - \\frac{2\\nu}{sh}\\right) = \\nu_{\\text{art, target}} $$\nSolving for $C_{\\tau}$:\n$$ C_{\\tau} = \\frac{2 \\nu_{\\text{art, target}}}{hs \\left(\\coth\\left(\\frac{sh}{2\\nu}\\right) - \\frac{2\\nu}{sh}\\right)} $$\nThese formulae are implemented in the following program.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes calibration constants C_ev and C_tau for two artificial diffusion models\n    applied to the 1D viscous Burgers equation to match a target shock thickness.\n    \"\"\"\n    \n    # Test cases: (u_L, u_R, nu, h, N) where delta_target = N * h\n    test_cases = [\n        # Case 1\n        (2.0, 0.0, 1.0e-3, 1.0/200.0, 6.0),\n        # Case 2\n        (1.5, 0.1, 2.0e-4, 1.0/400.0, 8.0),\n        # Case 3\n        (1.0, 0.5, 5.0e-4, 1.0/100.0, 4.0),\n    ]\n\n    results = []\n    \n    # Constant kappa from derivation: kappa = 8 * ln(3)\n    kappa = 8.0 * np.log(3.0)\n\n    for case in test_cases:\n        u_L, u_R, nu, h, N = case\n        \n        # Calculate derived parameters\n        delta_u = u_L - u_R\n        s = 0.5 * (u_L + u_R)\n        delta_target = N * h\n\n        # Calculate the target effective viscosity\n        nu_eff_target = (delta_target * delta_u) / kappa\n        \n        # Calculate the required artificial viscosity\n        nu_art_target = nu_eff_target - nu\n        \n        if nu_art_target = 0.0:\n            C_ev = 0.0\n            C_tau = 0.0\n        else:\n            # --- Calibrate C_ev ---\n            # Argument for the tanh function in the R_h expression\n            arg_tanh_ev = (delta_u * h) / (4.0 * nu)\n            # Denominator for C_ev formula\n            denom_ev = (h * s * delta_u / 2.0) * np.tanh(arg_tanh_ev)\n            \n            if np.abs(denom_ev) > 1e-15:\n                C_ev = nu_art_target / denom_ev\n            else:\n                # This case should not be reached with the given inputs but is good practice\n                C_ev = np.inf \n\n            # --- Calibrate C_tau ---\n            # Element Peclet number\n            # Assuming s > 0, so |s| = s\n            peclet = (s * h) / (2.0 * nu)\n            \n            # The function coth(x) - 1/x\n            if peclet  1e-8:\n                # Taylor expansion for small x: coth(x) - 1/x -> x/3\n                coth_minus_inv_pe = peclet / 3.0\n            else:\n                coth_minus_inv_pe = (1.0 / np.tanh(peclet)) - (1.0 / peclet)\n\n            # Denominator for C_tau formula\n            denom_tau = (h * s / 2.0) * coth_minus_inv_pe\n            \n            if np.abs(denom_tau) > 1e-15:\n                C_tau = nu_art_target / denom_tau\n            else:\n                # This case should not be reached with the given inputs\n                C_tau = np.inf\n\n        results.extend([C_ev, C_tau])\n\n    # Format output as a single comma-separated string in brackets\n    # e.g., [val1,val2,val3,...]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}