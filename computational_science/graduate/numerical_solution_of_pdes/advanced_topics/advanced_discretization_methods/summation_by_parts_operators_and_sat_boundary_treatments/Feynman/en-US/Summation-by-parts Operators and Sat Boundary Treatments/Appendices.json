{
    "hands_on_practices": [
        {
            "introduction": "To truly understand Summation-by-Parts (SBP) operators, we must begin by constructing one from scratch. This first exercise guides you through building the most common second-order accurate SBP operator on a uniform grid. By assembling the differentiation matrix $D$ from familiar finite difference stencils and pairing it with the appropriate diagonal norm matrix $H$, you will perform a direct verification of the fundamental SBP identity, $H D + D^T H = B$. This calculation provides concrete insight into how the algebraic properties of SBP matrices perfectly mimic the continuous integration-by-parts rule. ",
            "id": "3451180",
            "problem": "Consider the first-derivative Summation-by-Parts (SBP) finite-difference operator with a diagonal norm on a uniform grid. Let the computational domain be the interval $[0,1]$, and let there be $N=5$ grid points with uniform spacing $h=\\frac{1}{4}$ and nodes $x_i=(i-1)h$ for $i=1,2,3,4,5$. A first-derivative SBP operator with a diagonal norm consists of a symmetric positive-definite diagonal matrix $H \\in \\mathbb{R}^{N \\times N}$ and a difference operator $D \\in \\mathbb{R}^{N \\times N}$ satisfying the discrete integration-by-parts identity $H D + D^{T} H = B$, where $B$ captures the contribution from the endpoints. The diagonal-norm SBP operator of interior order two (with first-order boundary closures) is the minimal-width choice that is consistent with: (i) first-order accurate one-sided boundary approximations, (ii) second-order accurate centered interior differences, and (iii) the summation-by-parts identity with $B$ equal to the diagonal matrix that extracts endpoint contributions.\n\nConstruct an explicit diagonal matrix $H$ and a matrix $D$ for this second-order diagonal-norm SBP operator on $N=5$ nodes that meet these conditions, and then verify the SBP identity by forming the residual matrix $R := H D + D^{T} H - B$, where $B=\\operatorname{diag}(-1,0,0,0,1)$. Your construction must be self-consistent with the stated accuracy and structural requirements.\n\nWhat is the Frobenius norm of the residual matrix $R$, i.e., the value of $\\|R\\|_{F}$, expressed as an exact number? Express the final answer as an exact number with no rounding.",
            "solution": "The user wants to construct a specific Summation-by-Parts (SBP) operator for the first derivative and then verify its defining property by calculating the Frobenius norm of a residual matrix.\n\n### Step 1: Validation of the Problem Statement\nThe problem is first validated against the required criteria.\n\n**1. Extraction of Givens:**\n*   **Topic:** First-derivative Summation-by-Parts (SBP) finite-difference operator.\n*   **Norm Type:** Diagonal norm.\n*   **Domain:** $[0, 1]$.\n*   **Grid Points:** $N=5$.\n*   **Grid Spacing:** $h = \\frac{1}{4}$.\n*   **Node Locations:** $x_i = (i-1)h$ for $i=1, 2, 3, 4, 5$.\n*   **SBP Identity:** $H D + D^{T} H = B$.\n*   **Operator $H$:** Symmetric positive-definite diagonal matrix, $H \\in \\mathbb{R}^{N \\times N}$.\n*   **Operator $D$:** Difference operator, $D \\in \\mathbb{R}^{N \\times N}$.\n*   **Boundary Matrix $B$:** $B = \\operatorname{diag}(-1, 0, 0, 0, 1)$.\n*   **Accuracy Requirements:**\n    *   Interior accuracy: Second-order ($O(h^2)$), using centered differences.\n    *   Boundary accuracy: First-order ($O(h)$), using one-sided differences.\n*   **Task:** Construct $H$ and $D$, then compute the Frobenius norm $\\|R\\|_F$ of the residual matrix $R := H D + D^{T} H - B$.\n\n**2. Validation using Extracted Givens:**\n*   **Scientific Grounding:** The problem is firmly rooted in the established theory of numerical methods for partial differential equations (PDEs). SBP operators are a standard and well-researched topic in scientific computing.\n*   **Well-Posedness:** The problem is well-posed. The constraints provided (number of points, grid spacing, orders of accuracy, diagonal norm) are sufficient to uniquely specify the minimal-width SBP operator in question. The task is a direct computation.\n*   **Objectivity:** The problem is stated in precise, objective mathematical language.\n*   **Completeness and Consistency:** The problem is self-contained and all its parts are consistent. The definition of an SBP operator, its desired properties, and the boundary term matrix $B$ are all standard and mutually compatible.\n\n**3. Verdict:**\nThe problem is valid. It is a well-defined exercise in constructing and verifying a standard numerical operator.\n\n### Step 2: Solution\nThe solution proceeds by first constructing the differentiation matrix $D$ and the norm matrix $H$ according to the specified properties, and then verifying the SBP identity.\n\n**Construction of the Differentiation Matrix $D$**\nThe matrix $D$ approximates the first derivative. Its rows are determined by the specified finite difference stencils. The grid spacing is $h = \\frac{1}{4}$.\n\n*   **Interior Points ($i=2, 3, 4$):** A second-order accurate centered difference stencil for the derivative of a function $u$ at point $x_i$ is given by $\\frac{u_{i+1} - u_{i-1}}{2h}$. With $h=\\frac{1}{4}$, the prefactor is $\\frac{1}{2h} = 2$.\n    *   At $i=2$, the stencil uses points $1$ and $3$, giving the row vector $[ -2, 0, 2, 0, 0 ]$.\n    *   At $i=3$, the stencil uses points $2$ and $4$, giving the row vector $[ 0, -2, 0, 2, 0 ]$.\n    *   At $i=4$, the stencil uses points $3$ and $5$, giving the row vector $[ 0, 0, -2, 0, 2 ]$.\n\n*   **Boundary Points ($i=1, 5$):** First-order accurate one-sided difference stencils are used.\n    *   At the left boundary, $i=1$, a forward difference is used: $\\frac{u_2 - u_1}{h}$. With $h=\\frac{1}{4}$, the prefactor is $\\frac{1}{h} = 4$. This gives the row vector $[ -4, 4, 0, 0, 0 ]$.\n    *   At the right boundary, $i=5$, a backward difference is used: $\\frac{u_5 - u_4}{h}$. This gives the row vector $[ 0, 0, 0, -4, 4 ]$.\n\nCombining these rows, the matrix $D$ is:\n$$\nD = \\begin{pmatrix}\n-4 & 4 & 0 & 0 & 0 \\\\\n-2 & 0 & 2 & 0 & 0 \\\\\n0 & -2 & 0 & 2 & 0 \\\\\n0 & 0 & -2 & 0 & 2 \\\\\n0 & 0 & 0 & -4 & 4\n\\end{pmatrix}\n$$\n\n**Construction of the Norm Matrix $H$**\nThe matrix $H$ defines the discrete inner product (norm). For a diagonal-norm SBP operator with second-order interior accuracy, the weights on the diagonal of $H$ are derived from the trapezoidal quadrature rule to ensure the discrete norm is a high-order approximation of the continuous $L^2$ norm $\\int_0^1 u(x)^2 dx$. The weights are $h$ for interior points and $h/2$ for boundary points.\n\nWith $h = \\frac{1}{4}$, the diagonal elements of $H$ are:\n$H_{11} = H_{55} = \\frac{h}{2} = \\frac{1}{8}$\n$H_{22} = H_{33} = H_{44} = h = \\frac{1}{4}$\n\nSo, the matrix $H$ is:\n$$\nH = \\operatorname{diag}\\left(\\frac{1}{8}, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{8}\\right)\n$$\n\n**Verification of the SBP Identity**\nThe core of the problem is to verify the SBP identity $H D + D^T H = B$. We compute the left-hand side, $Q = H D + D^T H$.\n\nFirst, we compute $HD$:\n$$\nHD = \\begin{pmatrix}\n1/8 & 0 & 0 & 0 & 0 \\\\\n0 & 1/4 & 0 & 0 & 0 \\\\\n0 & 0 & 1/4 & 0 & 0 \\\\\n0 & 0 & 0 & 1/4 & 0 \\\\\n0 & 0 & 0 & 0 & 1/8\n\\end{pmatrix}\n\\begin{pmatrix}\n-4 & 4 & 0 & 0 & 0 \\\\\n-2 & 0 & 2 & 0 & 0 \\\\\n0 & -2 & 0 & 2 & 0 \\\\\n0 & 0 & -2 & 0 & 2 \\\\\n0 & 0 & 0 & -4 & 4\n\\end{pmatrix}\n= \\begin{pmatrix}\n-1/2 & 1/2 & 0 & 0 & 0 \\\\\n-1/2 & 0 & 1/2 & 0 & 0 \\\\\n0 & -1/2 & 0 & 1/2 & 0 \\\\\n0 & 0 & -1/2 & 0 & 1/2 \\\\\n0 & 0 & 0 & -1/2 & 1/2\n\\end{pmatrix}\n$$\n\nNext, we compute $D^T H$. The transpose of $D$ is:\n$$\nD^T = \\begin{pmatrix}\n-4 & -2 & 0 & 0 & 0 \\\\\n4 & 0 & -2 & 0 & 0 \\\\\n0 & 2 & 0 & -2 & 0 \\\\\n0 & 0 & 2 & 0 & -4 \\\\\n0 & 0 & 0 & 2 & 4\n\\end{pmatrix}\n$$\n$$\nD^T H = \\begin{pmatrix}\n-4 & -2 & 0 & 0 & 0 \\\\\n4 & 0 & -2 & 0 & 0 \\\\\n0 & 2 & 0 & -2 & 0 \\\\\n0 & 0 & 2 & 0 & -4 \\\\\n0 & 0 & 0 & 2 & 4\n\\end{pmatrix}\n\\begin{pmatrix}\n1/8 & 0 & 0 & 0 & 0 \\\\\n0 & 1/4 & 0 & 0 & 0 \\\\\n0 & 0 & 1/4 & 0 & 0 \\\\\n0 & 0 & 0 & 1/4 & 0 \\\\\n0 & 0 & 0 & 0 & 1/8\n\\end{pmatrix}\n= \\begin{pmatrix}\n-1/2 & -1/2 & 0 & 0 & 0 \\\\\n1/2 & 0 & -1/2 & 0 & 0 \\\\\n0 & 1/2 & 0 & -1/2 & 0 \\\\\n0 & 0 & 1/2 & 0 & -1/2 \\\\\n0 & 0 & 0 & 1/2 & 1/2\n\\end{pmatrix}\n$$\n\nNow, we sum the two matrices:\n$$\nQ = HD + D^T H = \\begin{pmatrix}\n-1/2 & 1/2 & 0 & 0 & 0 \\\\\n-1/2 & 0 & 1/2 & 0 & 0 \\\\\n0 & -1/2 & 0 & 1/2 & 0 \\\\\n0 & 0 & -1/2 & 0 & 1/2 \\\\\n0 & 0 & 0 & -1/2 & 1/2\n\\end{pmatrix} + \\begin{pmatrix}\n-1/2 & -1/2 & 0 & 0 & 0 \\\\\n1/2 & 0 & -1/2 & 0 & 0 \\\\\n0 & 1/2 & 0 & -1/2 & 0 \\\\\n0 & 0 & 1/2 & 0 & -1/2 \\\\\n0 & 0 & 0 & 1/2 & 1/2\n\\end{pmatrix}\n$$\n$$\nQ = \\begin{pmatrix}\n-1 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\nThis resulting matrix is precisely the given boundary matrix $B = \\operatorname{diag}(-1, 0, 0, 0, 1)$.\n\n**Calculation of the Residual and its Norm**\nThe residual matrix is defined as $R = H D + D^{T} H - B$.\nFrom the previous step, we have shown that $H D + D^{T} H = B$. Therefore,\n$$\nR = B - B = \\mathbf{0}\n$$\nwhere $\\mathbf{0}$ is the $5 \\times 5$ zero matrix.\n\nThe Frobenius norm of a matrix $R$ is defined as $\\|R\\|_F = \\sqrt{\\sum_{i=1}^N \\sum_{j=1}^N |R_{ij}|^2}$.\nFor the zero matrix, every element $R_{ij}=0$. Thus, the Frobenius norm is:\n$$\n\\|R\\|_F = \\sqrt{\\sum_{i=1}^5 \\sum_{j=1}^5 0^2} = 0\n$$\n\nThe result is exact, as the SBP operator was constructed specifically to satisfy this algebraic identity.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Moving beyond a fixed recipe, this practice explores the systematic design of higher-order SBP operators. Here, you will construct a fourth-order accurate operator by setting up and solving a system of linear equations derived from fundamental principles. This involves enforcing moment conditions to guarantee accuracy and simultaneously satisfying the algebraic constraints imposed by the SBP property. This exercise demystifies the origin of SBP operators, revealing them as the unique result of merging accuracy requirements with the discrete analogue of integration by parts. ",
            "id": "3451184",
            "problem": "Consider the one-dimensional conservation law on a uniform grid of $N+1$ nodes $x_i = i h$ for $i = 0,1,\\dots,N$ with $h = 1/N$, and construct a first-derivative Summation-By-Parts (SBP) operator with diagonal norm suitable for use with the Simultaneous Approximation Term (SAT) boundary treatment. Let the SBP operator be defined as $\\mathbf{D} = \\mathbf{H}^{-1} \\mathbf{Q}$, where $\\mathbf{H} = h \\, \\mathrm{diag}(w_0,w_1,\\dots,w_N)$ is a diagonal positive-definite matrix of quadrature weights and $\\mathbf{Q}$ satisfies the SBP identity $\\mathbf{Q} + \\mathbf{Q}^{\\top} = \\mathbf{B}$ with $\\mathbf{B} = \\mathrm{diag}(-1,0,\\dots,0,1)$. The target interior accuracy is order $2p = 4$ and the boundary accuracy is order $p = 2$.\n\nAssume the interior stencil for $\\mathbf{D}$ on rows $i = 2,3,\\dots,N-2$ is the standard fourth-order accurate central finite difference,\n$$\n(\\mathbf{D} \\mathbf{u})_i \\;=\\; \\frac{1}{12 h} \\left(-\\mathbf{u}_{i+2} + 8 \\mathbf{u}_{i+1} - 8 \\mathbf{u}_{i-1} + \\mathbf{u}_{i-2}\\right).\n$$\nFor the left boundary closure at $i = 0$, let $(\\mathbf{D}\\mathbf{u})_0 = \\frac{1}{h}\\sum_{j=0}^{4} a_j \\mathbf{u}_j$, where the unknown boundary closure coefficients $a_j$ must satisfy the moment conditions that enforce boundary accuracy order $p = 2$. Explicitly, for the monomials $\\mathbf{u}(x) = x^m$ with $m = 0,1,2$,\n$$\n\\sum_{j=0}^{4} a_j \\, j^m \\;=\\; m \\cdot 0^{m-1}\n$$\nwhere $0^{m-1}$ is interpreted as $0$ for $m \\geq 2$ and $1$ for $m=1$. In addition, impose the SBP relation between $\\mathbf{Q}$ and the boundary closure, namely $Q_{0j} = w_0 a_j$ for $j=0,1,2,3,4$, together with $Q_{00} = -\\tfrac{1}{2}$ and skew-symmetry $Q_{0j} + Q_{j0} = 0$ for $j \\geq 1$. Assume a minimal half-bandwidth of three, so $a_4 = 0$, and the interior stencil begins at row $i = 2$. Use the interior stencil on row $i=2$ and the SBP identity to resolve any remaining degrees of freedom in the boundary closure.\n\nStarting from these conditions and the SBP structure, set up and solve the resulting linear-algebraic moment system and SBP constraints to determine the diagonal norm weight $w_0$ at the left boundary for the fourth-order ($2p=4$) diagonal-norm SBP operator. Express your final result for $w_0$ as a reduced exact fraction. No rounding is required, and no units should be reported.",
            "solution": "The objective is to determine the diagonal norm weight $w_0$ at the left boundary for a fourth-order accurate Summation-By-Parts (SBP) operator. The derivation proceeds by establishing a system of linear algebraic equations for the unknown boundary closure coefficients and the weight $w_0$, based on the provided accuracy and SBP conditions.\n\nThe problem specifies a first-derivative SBP operator $\\mathbf{D} = \\mathbf{H}^{-1}\\mathbf{Q}$, where $\\mathbf{H} = h \\, \\mathrm{diag}(w_0, w_1, \\dots, w_N)$ is the diagonal norm matrix, and $\\mathbf{Q}$ is a matrix satisfying the SBP property $\\mathbf{Q} + \\mathbf{Q}^\\top = \\mathbf{B} = \\mathrm{diag}(-1, 0, \\dots, 0, 1)$. The boundary closure at the left boundary ($i=0$) is given by\n$$ (\\mathbf{D}\\mathbf{u})_0 = \\frac{1}{h}\\sum_{j=0}^{4} a_j \\mathbf{u}_j $$\nThe unknown coefficients $a_j$ and the weight $w_0$ must satisfy several conditions.\n\nFirst, the boundary accuracy is of order $p=2$. This implies that the finite difference formula at the boundary must be exact for all monomials $\\mathbf{u}(x) = x^m$ up to degree $m=2$. The condition is that the numerical derivative must match the analytical derivative at $x=0$.\nThe numerical derivative for $u(x) = x^m$ at $x_0=0$ is:\n$$ (\\mathbf{D}u)_0 = \\frac{1}{h} \\sum_{j=0}^{4} a_j (x_j)^m = \\frac{1}{h} \\sum_{j=0}^{4} a_j (jh)^m = h^{m-1} \\sum_{j=0}^{4} a_j j^m $$\nThe analytical derivative at $x=0$ is $u'(0) = [mx^{m-1}]_{x=0}$.\nFor the operator to be exact up to degree $m=2$, we must have $h^{m-1} \\sum_{j=0}^{4} a_j j^m = [mx^{m-1}]_{x=0}$ for $m=0, 1, 2$.\nThis yields the following moment conditions:\n\\begin{itemize}\n    \\item For $m=0$: $u(x)=x^0=1$, $u'(0)=0$. The condition is $\\frac{1}{h}\\sum a_j = 0 \\implies \\sum_{j=0}^{4} a_j = 0$.\n    \\item For $m=1$: $u(x)=x^1=x$, $u'(0)=1$. The condition is $\\sum a_j j = 1$.\n    \\item For $m=2$: $u(x)=x^2$, $u'(0)=0$. The condition is $h \\sum a_j j^2 = 0 \\implies \\sum a_j j^2 = 0$.\n\\end{itemize}\nThe problem states that $a_4=0$, so the sums are effectively from $j=0$ to $j=3$. The moment conditions are:\n\\begin{align}\n    a_0 + a_1 + a_2 + a_3 &= 0 \\quad &(1) \\\\\n    a_1 + 2a_2 + 3a_3 &= 1 \\quad &(2) \\\\\n    a_1 + 4a_2 + 9a_3 &= 0 \\quad &(3)\n\\end{align}\n\nSecond, we incorporate the constraints imposed by the SBP structure. The relation $\\mathbf{D} = \\mathbf{H}^{-1}\\mathbf{Q}$ implies $\\mathbf{Q} = \\mathbf{H}\\mathbf{D}$. The elements of $\\mathbf{Q}$ are $Q_{ij} = H_{ii}D_{ij} = (h w_i)D_{ij}$.\nFrom the boundary closure definition, the elements of the first row of $\\mathbf{D}$ are $D_{0j} = a_j/h$. Thus, for the first row of $\\mathbf{Q}$, we have $Q_{0j} = H_{00} D_{0j} = (h w_0) (a_j/h) = w_0 a_j$.\nThe SBP property $\\mathbf{Q} + \\mathbf{Q}^\\top = \\mathbf{B}$ gives two crucial constraints:\n\\begin{enumerate}\n    \\item For the diagonal element $(0,0)$: $Q_{00} + Q_{00} = B_{00} = -1 \\implies 2Q_{00} = -1 \\implies Q_{00} = -1/2$. Combining with $Q_{00} = w_0 a_0$, we get:\n    $$ w_0 a_0 = -\\frac{1}{2} \\quad (4) $$\n    \\item For the off-diagonal elements, for instance $(0,2)$: $Q_{02} + Q_{20} = B_{02} = 0$. The first term is $Q_{02} = w_0 a_2$. The second term is $Q_{20} = H_{22}D_{20} = (h w_2) D_{20}$. The problem specifies using the fourth-order interior stencil for row $i=2$:\n    $$ (\\mathbf{D} \\mathbf{u})_2 = \\frac{1}{12 h} (\\mathbf{u}_0 - 8 \\mathbf{u}_1 + 8 \\mathbf{u}_3 - \\mathbf{u}_4) $$\n    From the stencil for $(\\mathbf{D} \\mathbf{u})_2$, the coefficient of $\\mathbf{u}_0$ is $D_{20} = \\frac{1}{12h}$. For a standard $2p=4$ SBP operator based on central differences, the interior quadrature weights are $w_i=1$ for $i \\ge p=2$. Thus, we set $w_2=1$.\n    $$ Q_{20} = (h \\cdot 1) \\left(\\frac{1}{12h}\\right) = \\frac{1}{12} $$\n    The constraint $Q_{02} + Q_{20} = 0$ becomes $w_0 a_2 + 1/12 = 0$:\n    $$ w_0 a_2 = -\\frac{1}{12} \\quad (5) $$\n\\end{enumerate}\n\nNow we have a system of five equations for the five unknowns $a_0, a_1, a_2, a_3, w_0$. Let's solve this system.\nFirst, we solve the linear system for $a_1, a_2, a_3$ from equations $(1), (2), (3)$.\nFrom $(2)$ and $(3)$:\nSubtracting $(2)$ from $(3)$: $(a_1 + 4a_2 + 9a_3) - (a_1 + 2a_2 + 3a_3) = 0 - 1 \\implies 2a_2 + 6a_3 = -1$.\nThis gives $a_2 = -3a_3 - \\frac{1}{2}$.\nSubstitute $a_2$ into $(2)$: $a_1 + 2(-3a_3 - \\frac{1}{2}) + 3a_3 = 1 \\implies a_1 - 6a_3 - 1 + 3a_3 = 1 \\implies a_1 - 3a_3 = 2$, so $a_1 = 3a_3 + 2$.\nSubstitute $a_1$ and $a_2$ into $(1)$: $a_0 + (3a_3 + 2) + (-3a_3 - \\frac{1}{2}) + a_3 = 0 \\implies a_0 + a_3 + \\frac{3}{2} = 0$.\nThis gives $a_3$ in terms of $a_0$: $a_3 = -a_0 - \\frac{3}{2}$.\nNow we can express $a_2$ in terms of $a_0$:\n$a_2 = -3a_3 - \\frac{1}{2} = -3(-a_0 - \\frac{3}{2}) - \\frac{1}{2} = 3a_0 + \\frac{9}{2} - \\frac{1}{2} = 3a_0 + \\frac{8}{2} = 3a_0 + 4$.\n\nWe have found a linear relationship between $a_2$ and $a_0$:\n$$ a_2 = 3a_0 + 4 $$\nFrom equations $(4)$ and $(5)$, we can express $a_0$ and $a_2$ in terms of $w_0$:\n$a_0 = -\\frac{1}{2w_0}$\n$a_2 = -\\frac{1}{12w_0}$\n\nSubstituting these into the relationship $a_2 = 3a_0 + 4$:\n$$ -\\frac{1}{12w_0} = 3\\left(-\\frac{1}{2w_0}\\right) + 4 $$\n$$ -\\frac{1}{12w_0} = -\\frac{3}{2w_0} + 4 $$\nTo solve for $w_0$, we can multiply the entire equation by $12w_0$ (which is non-zero as $\\mathbf{H}$ is positive-definite):\n$$ -1 = -3 \\cdot \\frac{12}{2} + 4 \\cdot (12w_0) $$\n$$ -1 = -18 + 48w_0 $$\n$$ 17 = 48w_0 $$\n$$ w_0 = \\frac{17}{48} $$\nThe resulting weight $w_0$ is a positive rational number, as expected for a diagonal-norm SBP operator. The fraction $17/48$ is in its simplest form since $17$ is a prime number and $48$ is not a multiple of $17$.",
            "answer": "$$\\boxed{\\frac{17}{48}}$$"
        },
        {
            "introduction": "The primary motivation for using SBP operators is to prove the stability of numerical schemes. In this final practice, you will apply the SBP framework to analyze a complete semi-discretization of the advection equation, including a Perfectly Matched Layer (PML) and Simultaneous Approximation Term (SAT) boundary penalties. Using the discrete energy method, you will see how the SBP identity elegantly simplifies the analysis, allowing you to prove that the discrete energy decays over time. This exercise demonstrates how SBP and SAT work in concert to control energy at the boundaries, providing a rigorous guarantee that the numerical simulation is stable. ",
            "id": "3451160",
            "problem": "Consider the one-dimensional linear advection equation $u_t + c\\,u_x = 0$ on the spatial domain $[0,1]$ with constant advection speed $c>0$ and dimensionless units. You will construct a semi-discrete approximation using a Summation-By-Parts (SBP) first-derivative operator and Simultaneous Approximation Term (SAT) boundary treatment, and couple it to a Perfectly Matched Layer (PML) modeled via a stretched-coordinate induced damping profile $\\alpha(x)\\ge 0$.\n\nFundamental base and core definitions:\n- Summation-By-Parts (SBP) operators: a diagonal-norm SBP first-derivative matrix $D\\in\\mathbb{R}^{N\\times N}$ with grid spacing $h$ and symmetric positive-definite norm matrix $H\\in\\mathbb{R}^{N\\times N}$ satisfy the discrete integration-by-parts identity $H D + D^\\top H = B$, where $B = \\mathrm{diag}(-1, 0, \\dots, 0, 1)$.\n- Simultaneous Approximation Term (SAT): a penalty that weakly enforces boundary data by adding terms scaled by $H^{-1}$ times boundary point selectors.\n- Perfectly Matched Layer (PML): modeled here by a stretched-coordinate damping profile that adds a diagonal attenuation $-\\alpha(x) u$ to the partial differential equation.\n\nDiscretization setup:\n- Use $N$ equally spaced grid points $x_i = i h$ for $i\\in\\{0,\\dots,N-1\\}$ with $h = 1/(N-1)$ on $[0,1]$.\n- Let $H = \\mathrm{diag}(h/2, h, \\dots, h, h/2)$ be the diagonal SBP norm.\n- Let $D$ be the second-order accurate diagonal-norm SBP first derivative:\n  - At interior points $i \\in \\{1,\\dots,N-2\\}$, $(D u)_i = (u_{i+1} - u_{i-1})/(2h)$.\n  - At the left boundary $i=0$, $(D u)_0 = (u_1 - u_0)/h$.\n  - At the right boundary $i=N-1$, $(D u)_{N-1} = (u_{N-1} - u_{N-2})/h$.\n- Define the PML damping profile with baseline $\\alpha_0>0$ and ramp near the right boundary of width $w\\in(0,1)$:\n  - For $x \\le 1-w$, set $\\alpha(x) = \\alpha_0$.\n  - For $x > 1-w$, set $\\alpha(x) = \\alpha_0 + \\alpha_{\\max}\\,\\left(\\frac{x-(1-w)}{w}\\right)^p$, with exponent $p\\in\\mathbb{N}$.\n- Implement homogeneous Dirichlet inflow at $x=0$ by SAT with penalty coefficient $\\tau_L>0$. For $c>0$ there is no SAT at the outflow $x=1$.\n\nSemi-discrete system:\n- Let $e_0 \\in \\mathbb{R}^N$ be the vector with $(e_0)_0=1$ and zeros elsewhere. Define the semi-discrete operator\n  $$ L = -c\\,D - \\mathrm{diag}(\\alpha) - \\tau_L\\,H^{-1}\\,e_0 e_0^\\top, $$\n  and the ordinary differential equation $u'(t) = L\\,u(t)$.\n- Define the discrete energy $E(t) = u(t)^\\top H u(t)$.\n\nDerivation objective:\n- Starting from the SBP identity, the Semi-discrete energy method, and the definitions above, derive the discrete energy equality\n  $$ \\frac{d}{dt} E(t) = u(t)^\\top \\left(HL + L^\\top H\\right) u(t) $$\n  and prove that for choices $\\tau_L \\ge c$ and baseline damping $\\alpha_0>0$ everywhere, the discrete energy satisfies\n  $$ \\frac{d}{dt}\\|u(t)\\|_H^2 \\le -\\beta\\,\\|u(t)\\|_H^2, \\quad \\text{with} \\quad \\beta = 2\\min_{x\\in[0,1]}\\alpha(x). $$\n  Explain why the PML ramp near $x=1$ does not degrade this bound and how the SAT inflow penalty removes the potentially non-dissipative left boundary contribution.\n\nAlgorithmic task:\n- Implement the matrices $H$, $D$, and $L$ as specified.\n- Form the symmetric matrix $S = HL + L^\\top H$.\n- Compute the smallest generalized eigenvalue of the pencil $(-S, H)$, denoted $\\beta_{\\mathrm{num}} = \\lambda_{\\min}(-S, H)$, which provides the sharpest uniform decay constant in the inequality $\\frac{d}{dt}E(t)\\le -\\beta_{\\mathrm{num}} E(t)$.\n- For each test case in the suite below, output the computed $\\beta_{\\mathrm{num}}$ as a floating-point number.\n\nTest suite:\n- Case $1$: $c=1.0$, $N=50$, $w=0.2$, $\\alpha_0=0.01$, $\\alpha_{\\max}=10.0$, $p=2$, $\\tau_L=c$.\n- Case $2$: $c=1.0$, $N=80$, $w=0.3$, $\\alpha_0=0.05$, $\\alpha_{\\max}=20.0$, $p=3$, $\\tau_L=c$.\n- Case $3$: $c=0.5$, $N=60$, $w=0.1$, $\\alpha_0=0.02$, $\\alpha_{\\max}=5.0$, $p=2$, $\\tau_L=c$.\n- Case $4$: $c=3.0$, $N=100$, $w=0.25$, $\\alpha_0=0.01$, $\\alpha_{\\max}=40.0$, $p=4$, $\\tau_L=c$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases, for example, $[\\beta_{\\mathrm{num},1},\\beta_{\\mathrm{num},2},\\beta_{\\mathrm{num},3},\\beta_{\\mathrm{num},4}]$.\n\nAll quantities are dimensionless. Angles are not used. No physical units are required. The final results must be floating-point numbers.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in the theory of numerical methods for partial differential equations, is self-contained, and is well-posed. We may proceed with the solution.\n\nThe objective is twofold: first, to perform a discrete energy analysis of the given semi-discrete system to derive the specified energy decay inequality, and second, to implement the system numerically to compute the sharpest decay constant for a series of test cases.\n\nLet us begin with the derivation. The discrete energy is defined as $E(t) = u(t)^\\top H u(t)$, where $u(t)$ is the vector of nodal values of the solution and $H$ is the symmetric positive-definite SBP norm matrix. Taking the time derivative of the energy, we have:\n$$\n\\frac{dE}{dt} = \\frac{d}{dt}\\left(u^\\top H u\\right) = u'^\\top H u + u^\\top H u'\n$$\nThe semi-discrete system is given by the ordinary differential equation $u' = Lu$. Substituting this into the energy derivative yields:\n$$\n\\frac{dE}{dt} = (Lu)^\\top H u + u^\\top H (Lu) = u^\\top L^\\top H u + u^\\top H L u = u^\\top (L^\\top H + HL) u\n$$\nThis confirms the first requested identity, with the symmetric matrix $S = L^\\top H + HL$ governing the rate of change of energy.\n\nOur next step is to analyze the structure of $S$. The operator $L$ is defined as:\n$$\nL = -c\\,D - \\mathrm{diag}(\\alpha) - \\tau_L\\,H^{-1}\\,e_0 e_0^\\top\n$$\nwhere $c>0$ is the advection speed, $D$ is the SBP first-derivative operator, $\\mathrm{diag}(\\alpha)$ is the diagonal matrix representing the PML damping, and the final term is the SAT penalty for the inflow boundary at $x=0$.\n\nWe compute $HL$ and $L^\\top H$:\n$$\nHL = H(-c\\,D - \\mathrm{diag}(\\alpha) - \\tau_L\\,H^{-1}\\,e_0 e_0^\\top) = -c\\,HD - H\\,\\mathrm{diag}(\\alpha) - \\tau_L\\,e_0 e_0^\\top\n$$\nNote that since both $H$ and $\\mathrm{diag}(\\alpha)$ are diagonal matrices, they commute: $H\\,\\mathrm{diag}(\\alpha) = \\mathrm{diag}(\\alpha)\\,H$.\nFor the transpose term, since $H$, $\\mathrm{diag}(\\alpha)$, and $e_0 e_0^\\top$ are symmetric matrices:\n$$\nL^\\top = (-c\\,D - \\mathrm{diag}(\\alpha) - \\tau_L\\,H^{-1}\\,e_0 e_0^\\top)^\\top = -c\\,D^\\top - \\mathrm{diag}(\\alpha) - \\tau_L\\,e_0 e_0^\\top H^{-1}\n$$\nAnd so,\n$$\nL^\\top H = (-c\\,D^\\top - \\mathrm{diag}(\\alpha) - \\tau_L\\,e_0 e_0^\\top H^{-1})H = -c\\,D^\\top H - \\mathrm{diag}(\\alpha)\\,H - \\tau_L\\,e_0 e_0^\\top\n$$\nCombining these, we find the energy rate matrix $S$:\n$$\nS = HL + L^\\top H = -c(HD + D^\\top H) - 2\\,\\mathrm{diag}(\\alpha)\\,H - 2\\tau_L\\,e_0 e_0^\\top\n$$\nWe now use the defining property of the SBP operator, $HD + D^\\top H = B = \\mathrm{diag}(-1, 0, \\dots, 0, 1)$. Substituting this identity into the expression for $S$:\n$$\nS = -c\\,\\mathrm{diag}(-1, 0, \\dots, 0, 1) - 2\\,\\mathrm{diag}(\\alpha)\\,H - 2\\tau_L\\,e_0 e_0^\\top\n$$\nAll matrices in this sum are diagonal. The matrix $e_0e_0^\\top$ is a diagonal matrix with a $1$ in the $(0,0)$ position and zeros elsewhere. Therefore, $S$ is a diagonal matrix. Let's find its diagonal entries, $S_{ii}$.\nFor the interior points $i \\in \\{1, \\dots, N-2\\}$:\n$$\nS_{ii} = -c(0) - 2\\,\\alpha_i H_{ii} - 2\\tau_L(0) = -2\\alpha_i h\n$$\nFor the left boundary $i=0$:\n$$\nS_{00} = -c(-1) - 2\\,\\alpha_0 H_{00} - 2\\tau_L(1) = c - 2\\alpha_0(h/2) - 2\\tau_L = c - \\alpha_0 h - 2\\tau_L\n$$\nFor the right boundary $i=N-1$:\n$$\nS_{N-1,N-1} = -c(1) - 2\\,\\alpha_{N-1} H_{N-1,N-1} - 2\\tau_L(0) = -c - 2\\alpha_{N-1}(h/2) = -c - \\alpha_{N-1} h\n$$\nNow, we can write the energy derivative in terms of the components $u_i$ of the vector $u$:\n$$\n\\frac{dE}{dt} = u^\\top S u = \\sum_{i=0}^{N-1} S_{ii} u_i^2 = S_{00}u_0^2 + S_{N-1,N-1}u_{N-1}^2 + \\sum_{i=1}^{N-2} S_{ii}u_i^2\n$$\n$$\n\\frac{dE}{dt} = (c - \\alpha_0 h - 2\\tau_L)u_0^2 - (c + \\alpha_{N-1} h)u_{N-1}^2 - \\sum_{i=1}^{N-2} 2\\alpha_i h u_i^2\n$$\nThe problem specifies the choice $\\tau_L \\ge c$. For this choice, the coefficient of $u_0^2$ is $c - \\alpha_0 h - 2\\tau_L \\le c - \\alpha_0 h - 2c = -c - \\alpha_0 h$. Since $c>0, \\alpha_0>0, h>0$, this coefficient is negative. This demonstrates how the SAT penalty removes the non-dissipative boundary contribution: the term from the SBP operator related to energy influx, $+cu_0^2$, is overwhelmed by the dissipative SAT term, $-2\\tau_L u_0^2$, guaranteeing stability at the inflow boundary.\n\nThe term for the outflow boundary, $-(c + \\alpha_{N-1}h)u_{N-1}^2$, is negative, correctly representing energy leaving the domain. The summation term is also negative since $\\alpha_i \\ge \\alpha_0 > 0$.\nTherefore, dropping all boundary terms, which are non-positive, we can establish an inequality:\n$$\n\\frac{dE}{dt} \\le - \\sum_{i=0}^{N-1} 2\\alpha_i H_{ii} u_i^2\n$$\n(recombining the boundary terms with the summation for a more compact expression).\nLet $\\beta = 2 \\min_{x\\in[0,1]} \\alpha(x)$. From the definition of $\\alpha(x)$, the minimum value is $\\alpha_0$. Thus, $\\beta = 2\\alpha_0$. Since $\\alpha_i \\ge \\alpha_0$ for all $i$:\n$$\n\\frac{dE}{dt} \\le - \\sum_{i=0}^{N-1} (2\\alpha_0) H_{ii} u_i^2 = -2\\alpha_0 \\sum_{i=0}^{N-1} H_{ii} u_i^2 = -2\\alpha_0 (u^\\top H u) = -\\beta E(t)\n$$\nThis proves the desired inequality: $\\frac{d}{dt}\\|u(t)\\|_H^2 \\le -\\beta\\,\\|u(t)\\|_H^2$ with $\\beta = 2\\alpha_0$. The PML ramp for $x > 1-w$ does not degrade this bound because the bound is determined by the minimum value of $\\alpha(x)$, which is $\\alpha_0$ in the region $x \\le 1-w$. The larger values of $\\alpha(x)$ in the ramp region only serve to increase dissipation, they do not affect this lower bound on the decay rate.\n\nFor the algorithmic task, we must compute $\\beta_{\\mathrm{num}} = \\lambda_{\\min}(-S, H)$, the smallest generalized eigenvalue of the pencil $(-S, H)$. By definition, this is the sharpest possible decay rate:\n$$\n\\beta_{\\mathrm{num}} = \\min_{u \\ne 0} \\frac{u^\\top(-S)u}{u^\\top H u}\n$$\nSince both $-S$ and $H$ are diagonal matrices, the generalized eigenvectors are the canonical basis vectors $e_i$. The corresponding generalized eigenvalues $\\lambda_i$ are given by the ratio of the diagonal entries:\n$$\n\\lambda_i = \\frac{-S_{ii}}{H_{ii}}\n$$\nLet's compute these eigenvalues for the case $\\tau_L = c$:\nFor $i=0$: $\\lambda_0 = \\frac{-(c - \\alpha_0 h - 2c)}{h/2} = \\frac{c + \\alpha_0 h}{h/2} = \\frac{2c}{h} + 2\\alpha_0$.\nFor $i \\in \\{1, \\dots, N-2\\}$: $\\lambda_i = \\frac{-(-2\\alpha_i h)}{h} = 2\\alpha_i$.\nFor $i=N-1$: $\\lambda_{N-1} = \\frac{-(-c - \\alpha_{N-1}h)}{h/2} = \\frac{c+\\alpha_{N-1}h}{h/2} = \\frac{2c}{h} + 2\\alpha_{N-1}$.\n\nThe smallest of these eigenvalues is $\\beta_{\\mathrm{num}} = \\min_i \\lambda_i$. The boundary-related eigenvalues $\\lambda_0$ and $\\lambda_{N-1}$ are large due to the $2c/h$ term (since $h$ is small). The minimum must therefore come from the interior eigenvalues $\\{2\\alpha_i\\}_{i=1}^{N-2}$. As established, the minimum value of $\\alpha_i$ is $\\alpha_0$.\nThus, we conclude analytically that:\n$$\n\\beta_{\\mathrm{num}} = \\min\\left( \\frac{2c}{h} + 2\\alpha_0, \\min_{i=1,\\dots,N-2}(2\\alpha_i), \\frac{2c}{h} + 2\\alpha_{N-1} \\right) = 2\\alpha_0\n$$\nThe numerical computation should confirm this analytical result. Any deviation will be attributable to floating-point precision. The computation for each test case should therefore yield a value extremely close to $2\\alpha_0$.",
            "answer": "[0.02000000,0.10000000,0.04000000,0.02000000]"
        }
    ]
}