{
    "hands_on_practices": [
        {
            "introduction": "物理上，扩散过程是一个能量耗散的系统。为了使数值格式稳定，它必须在离散层面准确地模拟这种能量耗散特性，尤其是在边界处。本练习将通过一个经典的例子——带有诺伊曼（Neumann）边界条件的扩散方程——来演示如何利用“鬼点”（ghost-cell）方法构建一个能量稳定的有限差分格式。通过离散能量分析，我们将推导出保证数值解能量不会出现虚假增长的边界处理方式，从而加深对边界条件与稳定性之间内在联系的理解。",
            "id": "3384271",
            "problem": "考虑一维扩散（热）方程 $u_{t} = u_{xx}$，其空间域为 $x \\in [0,1]$，带有齐次诺伊曼边界条件 $u_{x}(0,t) = 0$ 和 $u_{x}(1,t) = 0$。设空间区间被均匀划分为 $x_{i} = i h$，其中 $i = 0, 1, \\dots, N$，$h = 1/N$。在网格点值 $u_{i}(t)$上定义一个半离散有限差分格式\n$$\n\\frac{d}{dt} u_{i} = \\frac{u_{i-1} - 2 u_{i} + u_{i+1}}{h^{2}}, \\quad i = 1, 2, \\dots, N-1,\n$$\n并通过在边界节点 $i=0$ 和 $i=N$ 应用相同的三点模板，引入虚拟单元值 $u_{-1}$ 和 $u_{N+1}$。假设一个双参数仿射虚拟单元闭合\n$$\nu_{-1} = \\alpha\\,u_{0} + \\beta\\,u_{1}, \\qquad u_{N+1} = \\alpha\\,u_{N} + \\beta\\,u_{N-1},\n$$\n其中实数权重 $\\alpha, \\beta \\in \\mathbb{R}$ 待定。\n\n从离散 $L^{2}$ 能量 $\\|u\\|_{h}^{2} := h \\sum_{i=0}^{N} u_{i}^{2}$ 以及扩散通过分部积分耗散能量这一基本事实出发，推导该格式的精确半离散能量平衡。用 $\\alpha$ 和 $\\beta$ 表示内部耗散和边界能量通量。然后，确定 $\\alpha$ 和 $\\beta$ 的值，使得对于任意网格数据，离散能量都是非增的，并且诺伊曼边界条件在边界节点上以一种自然的离散方式被强制执行。用精确值将你的最终答案表示为有序对 $(\\alpha,\\beta)$。不需要四舍五入。",
            "solution": "用户希望找到一维热方程有限差分格式中虚拟单元闭合的参数 $(\\alpha, \\beta)$，使得该格式在离散能量范数下是稳定的，并且满足诺伊曼边界条件。\n\n首先，我们推导半离散能量平衡。离散 $L^2$ 能量定义为 $E(t) = \\|u(t)\\|_{h}^{2} = h \\sum_{i=0}^{N} u_{i}(t)^{2}$。我们计算其时间导数：\n$$\n\\frac{dE}{dt} = \\frac{d}{dt} \\left( h \\sum_{i=0}^{N} u_{i}^{2} \\right) = h \\sum_{i=0}^{N} 2 u_{i} \\frac{du_{i}}{dt} = 2h \\sum_{i=0}^{N} u_{i} \\frac{du_{i}}{dt}\n$$\n对所有节点 $i=0, 1, \\dots, N$，半离散格式为：\n$$\n\\frac{du_{i}}{dt} = \\frac{u_{i-1} - 2u_{i} + u_{i+1}}{h^{2}}\n$$\n将其代入 $\\frac{dE}{dt}$ 的表达式中：\n$$\n\\frac{dE}{dt} = 2h \\sum_{i=0}^{N} u_{i} \\left( \\frac{u_{i-1} - 2u_{i} + u_{i+1}}{h^{2}} \\right) = \\frac{2}{h} \\sum_{i=0}^{N} u_{i} (u_{i-1} - 2u_{i} + u_{i+1})\n$$\n为了分析这个表达式，我们进行分部求和。求和号内的项可以写成 $u_i((u_{i+1}-u_i) - (u_i-u_{i-1}))$。\n$$\n\\sum_{i=0}^{N} u_{i} (u_{i-1} - 2u_{i} + u_{i+1}) = \\sum_{i=0}^{N} u_{i} (u_{i+1}-u_i) - \\sum_{i=0}^{N} u_{i} (u_i-u_{i-1})\n$$\n我们对第二个和式重新索引。令 $j=i-1$，则 $i=j+1$。该和式变为 $\\sum_{j=-1}^{N-1} u_{j+1} (u_{j+1}-u_j)$。\n$$\n= \\sum_{i=0}^{N} u_{i} (u_{i+1}-u_i) - \\left( u_0(u_0-u_{-1}) + \\sum_{j=0}^{N-1} u_{j+1}(u_{j+1}-u_j) \\right)\n$$\n我们将第一个和式在 $i=N-1$ 处拆分：$\\sum_{i=0}^{N-1} u_i(u_{i+1}-u_i) + u_N(u_{N+1}-u_N)$。\n$$\n= u_N(u_{N+1}-u_N) + \\sum_{i=0}^{N-1} u_i(u_{i+1}-u_i) - u_0(u_0-u_{-1}) - \\sum_{i=0}^{N-1} u_{i+1}(u_{i+1}-u_i)\n$$\n合并两个和式得到：\n$$\n= u_N(u_{N+1}-u_N) - u_0(u_0-u_{-1}) + \\sum_{i=0}^{N-1} (u_i - u_{i+1})(u_{i+1}-u_i)\n$$\n$$\n= u_N(u_{N+1}-u_N) + u_0(u_{-1}-u_0) - \\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2\n$$\n将其代回 $\\frac{dE}{dt}$ 的表达式，我们得到能量平衡方程：\n$$\n\\frac{dE}{dt} = \\frac{2}{h} \\left( u_0(u_{-1}-u_0) + u_N(u_{N+1}-u_N) \\right) - \\frac{2}{h} \\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2\n$$\n该方程与连续情况下的方程 $\\frac{d}{dt}\\int_0^1 u^2 dx = 2[uu_x]_0^1 - 2\\int_0^1 (u_x)^2 dx$ 相对应。项\n$$\nD = -\\frac{2}{h} \\sum_{i=0}^{N-1} (u_{i+1}-u_i)^2 = -2h \\sum_{i=0}^{N-1} \\left(\\frac{u_{i+1}-u_i}{h}\\right)^2\n$$\n是**内部耗散**。它总是非正的。项\n$$\nB = \\frac{2}{h} \\left( u_0(u_{-1}-u_0) + u_N(u_{N+1}-u_N) \\right)\n$$\n是**边界能量通量**。\n\n现在，我们必须确定 $\\alpha$ 和 $\\beta$。条件是：\n1. 对于任意网格数据，离散能量是非增的，即 $\\frac{dE}{dt} \\le 0$。\n2. 诺伊曼边界条件以一种自然的离散方式被强制执行。\n\n由于内部耗散 $D$ 已经是非正的，稳定性条件 $\\frac{dE}{dt} \\le 0$ 要求对边界通量 $B$ 施加约束。在连续情况下，诺伊曼条件 $u_x(0,t)=u_x(1,t)=0$ 使得边界通量项 $[uu_x]_0^1$ 为零。对于能量方法而言，一种“自然的离散方式”是对离散边界通量强制执行相同的属性，即 $B=0$。这是稳定性的一个充分条件，因为此时 $\\frac{dE}{dt}$ 将等于非正的耗散项 $D$。\n\n我们设 $B=0$。在代入虚拟单元关系之前，这意味着：\n对于任意 $u_i$，有 $u_0(u_{-1}-u_0) + u_N(u_{N+1}-u_N) = 0$。\n这可以通过将每一部分设为零来保证：\n$u_{-1}-u_0 = 0 \\implies u_{-1}=u_0$\n$u_{N+1}-u_N = 0 \\implies u_{N+1}=u_N$\n\n现在我们使用给定的仿射虚拟单元闭合来求解 $\\alpha$ 和 $\\beta$。\n在左边界：\n$$\nu_{-1} = \\alpha u_0 + \\beta u_1\n$$\n为使其对任意 $u_0$ 和 $u_1$ 都等于 $u_0$，我们必须有：\n$$\nu_0 = \\alpha u_0 + \\beta u_1 \\implies (\\alpha-1)u_0 + \\beta u_1 = 0\n$$\n由于这必须对任意 $u_0$ 和 $u_1$ 的值都成立，所以系数必须为零。这给出 $\\alpha-1=0$ 和 $\\beta=0$，因此 $\\alpha=1$ 和 $\\beta=0$。\n\n在右边界：\n$$\nu_{N+1} = \\alpha u_N + \\beta u_{N-1}\n$$\n为使其对任意 $u_N$ 和 $u_{N-1}$ 都等于 $u_N$：\n$$\nu_N = \\alpha u_N + \\beta u_{N-1} \\implies (\\alpha-1)u_N + \\beta u_{N-1} = 0\n$$\n这同样意味着 $\\alpha=1$ 和 $\\beta=0$。\n\n选择 $(\\alpha, \\beta) = (1,0)$ 满足两个边界要求，并保证边界通量 $B$ 为零，从而确保了稳定性（$\\frac{dE}{dt} \\le 0$）。\n\n这个选择对应于将虚拟单元值设为 $u_{-1}=u_0$ 和 $u_{N+1}=u_N$。这代表了零阶外推。该方法以 $\\frac{u_0-u_{-1}}{h}=0$（在 $x=-h/2$ 处对 $u_x$ 的一阶近似）和 $\\frac{u_{N+1}-u_N}{h}=0$（在 $x=1+h/2$ 处）的形式实现了离散零通量条件，这是一种简单、常见，因此是“自然的”方法。\n\n因此，唯一满足两个条件的有序对 $(\\alpha, \\beta)$ 是 $(1,0)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个稳定的半离散格式是成功数值模拟的第一步，但时间积分方法的选择对全离散格式的稳定性同样至关重要。本练习将半离散的扩散系统抽象为一个常微分方程组，并引导您分析显式龙格-库塔（Runge-Kutta）方法在该系统上的能量演化。您将学习如何将全离散格式的能量稳定性与时间积分方法的稳定性多项式联系起来，并由此推导出著名的 Courant–Friedrichs–Lewy (CFL) 条件，这个练习是连接偏微分方程空间离散化与常微分方程数值求解器理论的关键桥梁。",
            "id": "3384294",
            "problem": "考虑$\\mathbb{R}^{m}$中的线性半离散扩散系统$u'(t)=-K\\,u(t)$，其中$K$是一个实对称半正定矩阵。定义离散能量为$E^{n}=\\tfrac{1}{2}\\|u^{n}\\|_{2}^{2}$，其中$u^{n}$是在时间$t^{n}$的数值近似解。设一个时间步长为$\\Delta t$的$s$阶显式Runge–Kutta (RK)方法应用于该系统。将该方法的稳定性多项式记为$R(z)$，因此对于线性系统，单步更新可以写成$u^{n+1}=R(-\\Delta t\\,K)\\,u^{n}$的形式。Courant–Friedrichs–Lewy (CFL)约束是确保所需稳定性性质的步长限制。\n\n使用实对称矩阵的谱定理、诱导矩阵$2$-范数的定义以及能量方法，推导$z:=\\Delta t\\,\\lambda_{\\max}(K)$的最大容许值，该值仅用稳定性多项式$R$表示，并保证对于任意初始条件$u^{0}$，离散能量在每个时间步都不增加。你的推导必须从关于对称矩阵和诱导范数的基本事实出发，并且必须证明你的条件的必要性和充分性。将你的最终结果表示为仅含$R$的单个解析表达式。不需要进行数值计算。",
            "solution": "问题在于推導$z:=\\Delta t\\,\\lambda_{\\max}(K)$的最大容许值，该值能保证对于任意初始条件，系统的离散能量不增加。该系统由$u'(t)=-K\\,u(t)$描述，其中$K$是一个实、对称、半正定矩阵。所用的数值方法是一种显式Runge-Kutta (RK)方法，其单步更新由$u^{n+1}=R(-\\Delta t\\,K)\\,u^{n}$给出，其中$R$是稳定性多项式。离散能量定义为$E^{n}=\\tfrac{1}{2}\\|u^{n}\\|_{2}^{2}$。\n\n离散能量不增加的条件是对于所有时间步$n \\ge 0$，有$E^{n+1} \\leq E^{n}$。代入能量的定义，我们得到：\n$$\n\\frac{1}{2}\\|u^{n+1}\\|_{2}^{2} \\leq \\frac{1}{2}\\|u^{n}\\|_{2}^{2}\n$$\n这等价于$\\|u^{n+1}\\|_{2} \\leq \\|u^{n}\\|_{2}$。\n\n使用单步更新公式$u^{n+1}=R(-\\Delta t\\,K)\\,u^{n}$，我们可以将该条件改写为：\n$$\n\\|R(-\\Delta t\\,K)\\,u^{n}\\|_{2} \\leq \\|u^{n}\\|_{2}\n$$\n这个不等式必须对所有可能的向量$u^{n} \\in \\mathbb{R}^{m}$和任何实、对称、半正定矩阵$K$成立。该条件成立当且仅当算子$R(-\\Delta t\\,K)$的诱导矩阵$2$-范数小于或等于$1$：\n$$\n\\|R(-\\Delta t\\,K)\\|_{2} \\leq 1\n$$\n为了计算此范数，我们使用实对称矩阵的谱定理。矩阵$K$是实对称的，因此它可以被正交对角化。存在一个正交矩阵$Q$（其中$Q^T Q = Q Q^T = I$）和一个对角矩阵$\\Lambda$，使得$K = Q \\Lambda Q^T$。$\\Lambda$的对角元，记为$\\lambda_{j}$（$j=1, \\dots, m$），是$K$的特征值。由于$K$是半正定的，其特征值为实数且非负：对所有$j$都有$0 \\leq \\lambda_{j} \\leq \\lambda_{\\max}(K)$。\n\n矩阵$R(-\\Delta t\\,K)$是关于对称矩阵$K$的多项式，因此它也是一个对称矩阵。\n$$\nR(-\\Delta t\\,K) = R(-\\Delta t\\,Q \\Lambda Q^T) = Q R(-\\Delta t\\,\\Lambda) Q^T\n$$\n其中$R(-\\Delta t\\,\\Lambda)$是一个对角矩阵，其对角元为$R(-\\Delta t\\,\\lambda_{j})$。\n对于任何对称矩阵$A$，其诱导$2$-范数等于其谱半径，即其特征值绝对值的最大值。$R(-\\Delta t\\,K)$的特征值是$R(-\\Delta t\\,\\Lambda)$的对角元，即$R(-\\Delta t\\,\\lambda_{j})$。因此，范数为：\n$$\n\\|R(-\\Delta t\\,K)\\|_{2} = \\max_{j=1, \\dots, m} |R(-\\Delta t\\,\\lambda_{j})|\n$$\n因此，能量不增加的条件变为：\n$$\n\\max_{j=1, \\dots, m} |R(-\\Delta t\\,\\lambda_{j})| \\leq 1\n$$\n这必须对一个对称半正定矩阵$K$的任何一组特征值$\\{\\lambda_j\\}$都成立。特征值$\\lambda_j$可以在区间$[0, \\lambda_{\\max}(K)]$内取任何值。为确保对于任何具有给定$\\lambda_{\\max}(K)$的矩阵$K$该条件都成立，我们必须要求该不等式对所有可能的缩放后特征值都成立。\n\n令$x = -\\Delta t \\lambda$。由于$\\lambda$覆盖了可能的特征值范围$[0, \\lambda_{\\max}(K)]$，变量$x$覆盖了区间$[-\\Delta t \\lambda_{\\max}(K), 0]$。令$z = \\Delta t \\lambda_{\\max}(K)$。$x$的区间是$[-z, 0]$。\n稳定性条件必须对该区间内的所有值都成立。这导致了以下要求：\n$$\n|R(x)| \\leq 1 \\quad \\text{对于所有} \\quad x \\in [-z, 0]\n$$\n这也可以写成 $\\max_{x \\in [-z, 0]} |R(x)| \\leq 1$。\n\n现在我们证明该条件的必要性和充分性。\n**充分性：** 假设我们选择的时间步长$\\Delta t$使得$z=\\Delta t \\lambda_{\\max}(K)$满足$\\max_{x \\in [-z, 0]} |R(x)| \\leq 1$。对于$K$的任何特征值$\\lambda_j$，我们有$0 \\leq \\lambda_j \\leq \\lambda_{\\max}(K)$，这意味着$-\\Delta t \\lambda_j \\in [-\\Delta t \\lambda_{\\max}(K), 0] = [-z, 0]$。根据我们的假设，可以得出对于所有$j=1, \\dots, m$都有$|R(-\\Delta t \\lambda_j)| \\leq 1$。这确保了$\\|R(-\\Delta t K)\\|_2 = \\max_j |R(-\\Delta t \\lambda_j)| \\leq 1$，从而保证了能量不增加。因此，该条件是充分的。\n\n**必要性：** 必须为每个初始条件$u^0$和每个实、对称、半正定矩阵$K$保证稳定性。令$z = \\Delta t \\lambda_{\\max}(K)$。假设存在一个值$x_0 \\in [-z, 0]$使得$|R(x_0)| > 1$。我们可以构造一个$1 \\times 1$矩阵（一个标量）$K = [-\\frac{x_0}{\\Delta t}]$。这个$K$是对称的，其唯一的特征值是$\\lambda = -\\frac{x_0}{\\Delta t}$。由于$x_0 \\in [-z, 0] = [-\\Delta t \\lambda_{\\max}(K), 0]$，我们有$0 \\le x_0 / (-\\Delta t) \\le \\lambda_{\\max}(K)$，所以这个$K$的选择是有效的。对于这个系统，更新变为$u^{n+1} = R(-\\Delta t \\lambda) u^n = R(x_0)u^n$。能量演化为$E^{n+1} = \\frac{1}{2} |u^{n+1}|^2 = |R(x_0)|^2 (\\frac{1}{2} |u^n|^2) = |R(x_0)|^2 E^n$。由于$|R(x_0)| > 1$，能量将会增长，违反了所需条件。因此，为确保此类所有可能系统的稳定性，必须有$|R(x)| \\leq 1$对所有$x \\in [-z, 0]$成立。\n\n我们寻求$z = \\Delta t \\lambda_{\\max}(K)$的最大容许值。这是使条件$\\max_{x \\in [-z, 0]} |R(x)| \\leq 1$成立的最大的$z \\geq 0$值。\n令$S$为所有此类$z$的容许值的集合：\n$$\nS = \\{z \\geq 0 \\mid \\max_{x \\in [-z, 0]} |R(x)| \\leq 1\\}\n$$\n问题要求的是这个集合中的最大值。由于对于一个显式RK方法，$R(0)=1$，所以集合$S$是非空的，因为它包含$z=0$。如果$z_1 \\in S$且$0 \\leq z_2 \\leq z_1$，则$[-z_2, 0] \\subseteq [-z_1, 0]$，这意味着$\\max_{x \\in [-z_2, 0]} |R(x)| \\leq \\max_{x \\in [-z_1, 0]} |R(x)| \\leq 1$。所以$z_2 \\in S$。这表明$S$是一个形如$[0, z_{\\text{max}}]$的区间。最大容许值是这个集合的上确界。\n\n$z$的最大容许值，我们记为$z_{\\text{stable}}$，因此由以下表达式给出：\n$$\nz_{\\text{stable}} = \\sup \\{z \\geq 0 \\mid \\max_{x \\in [-z, 0]} |R(x)| \\leq 1\\}\n$$\n这个表达式仅用稳定性多项式$R$定义了所求的量。",
            "answer": "$$\n\\boxed{\\sup \\{z \\geq 0 \\mid \\max_{x \\in [-z, 0]} |R(x)| \\leq 1\\}}\n$$"
        },
        {
            "introduction": "对于能量可能守恒或流动的双曲型问题，边界条件的处理对稳定性至关重要。“分部求和”（SBP）算子与“同步近似项”（SAT）惩罚技术共同构成了一种强大而系统的方法，用以构建可证明稳定的高阶数值格式。本练习将 SBP-SAT 能量方法应用于基本的线性平流方程。通过推导能够精确模仿连续能量平衡的惩罚参数，您将掌握如何以弱形式施加边界条件，同时严格保证离散能量的稳定性。",
            "id": "3384333",
            "problem": "考虑常系数线性平流偏微分方程 (PDE) $u_t + a\\,u_x = 0$，该方程定义在空间区间 $x \\in [0,1]$ 上，速度为 $a \\in \\mathbb{R}$。将该偏微分方程乘以 $u$ 并在 $[0,1]$ 上积分，可得到连续能量法，从而得出能量恒等式\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}\\int_{0}^{1} u(x,t)^2\\,\\mathrm{d}x\\right) + \\frac{a}{2}\\left(u(1,t)^2 - u(0,t)^2\\right) = 0,\n$$\n该恒等式清楚地表明，通过边界的能量通量由边界值和 $a$ 的符号决定。对于数值逼近，假设空间导数由分部求和 (SBP) 有限差分算子 $D = H^{-1}Q$ 逼近，该算子作用于网格点 $x_1=0,  x_2,  \\cdots,  x_N=1$ 上的网格函数 $u(t) \\in \\mathbb{R}^{N}$，其中 $H \\in \\mathbb{R}^{N\\times N}$ 是对称正定矩阵，$Q \\in \\mathbb{R}^{N\\times N}$ 满足 SBP 性质 $Q + Q^{\\top} = B$，其中 $B = -e_1 e_1^{\\top} + e_N e_N^{\\top}$，$e_1, e_N \\in \\mathbb{R}^{N}$ 分别是第一个和最后一个标准基向量。为了弱施加边界条件，使用同时逼近项 (SAT)，在左右边界分别引入未知的惩罚系数 $\\sigma_L, \\sigma_R \\in \\mathbb{R}$，得到半离散格式\n$$\nu_t + a\\,H^{-1}Q\\,u = H^{-1}\\,\\sigma_L\\,e_1\\left(g_L(t) - u_1(t)\\right) + H^{-1}\\,\\sigma_R\\,e_N\\left(g_R(t) - u_N(t)\\right),\n$$\n其中 $u_1(t)$ 和 $u_N(t)$ 表示 $u(t)$ 的第一个和最后一个分量，$g_L(t)$ 和 $g_R(t)$ 是与流入边界（特征线进入区域的边界）和流出边界（特征线离开区域的边界）相关的给定边界数据，具体取决于 $a$ 的符号。使用离散能量 $E(t) = \\frac{1}{2}u(t)^{\\top}H\\,u(t)$，确定 SAT 惩罚系数 $\\sigma_L$ 和 $\\sigma_R$ 作为 $a$ 的函数的值，使得：\n- 离散能量法在流入边界处与连续能量通量相匹配，即边界数据的贡献与连续恒等式中的符号和大小相同，并且\n- 离散能量是半有界的，即离散能量导数的上界为一个仅依赖于给定流入数据的项，并且流出边界具有耗散作用。\n\n将您的最终答案表示为 $\\sigma_L$ 和 $\\sigma_R$ 关于 $a$ 的闭式解析表达式，并以单行矩阵的形式呈现。不需要进行数值取整。",
            "solution": "问题是确定半离散格式的惩罚系数 $\\sigma_L$ 和 $\\sigma_R$\n$$\nu_t + a\\,H^{-1}Q\\,u = H^{-1}\\,\\sigma_L\\,e_1\\left(g_L(t) - u_1(t)\\right) + H^{-1}\\,\\sigma_R\\,e_N\\left(g_R(t) - u_N(t)\\right).\n$$\n我们将使用能量法。离散能量定义为 $E(t) = \\frac{1}{2}u(t)^{\\top}H\\,u(t)$。我们要求解其时间导数 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$。\n\n首先，我们将半离散方程左乘矩阵 $H$ 得到：\n$$\nH\\,u_t + a\\,Q\\,u = \\sigma_L\\,e_1\\left(g_L(t) - u_1(t)\\right) + \\sigma_R\\,e_N\\left(g_R(t) - u_N(t)\\right).\n$$\n接下来，我们与解向量 $u(t)$ 做点积（即左乘 $u^{\\top}$）：\n$$\nu^{\\top}H\\,u_t + a\\,u^{\\top}Q\\,u = \\sigma_L\\,u^{\\top}e_1\\left(g_L - u_1\\right) + \\sigma_R\\,u^{\\top}e_N\\left(g_R - u_N\\right).\n$$\n我们逐项分析。\n第一项与能量导数有关。由于 $H$ 是对称且不随时间变化的，我们有\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}u^{\\top}H\\,u\\right) = \\frac{1}{2}\\left(u_t^{\\top}H\\,u + u^{\\top}H\\,u_t\\right) = u^{\\top}H\\,u_t.\n$$\n第二项涉及矩阵 $Q$。利用 SBP 性质 $Q+Q^{\\top}=B$，二次型 $u^{\\top}Qu$ 可以表示为：\n$$\nu^{\\top}Q\\,u = \\frac{1}{2}\\left(u^{\\top}Q\\,u + u^{\\top}Q\\,u\\right) = \\frac{1}{2}\\left(u^{\\top}Q\\,u + u^{\\top}Q^{\\top}u\\right) = \\frac{1}{2}u^{\\top}(Q+Q^{\\top})u = \\frac{1}{2}u^{\\top}B\\,u.\n$$\n代入 $B = -e_1 e_1^{\\top} + e_N e_N^{\\top}$ 并回顾 $u_1 = e_1^{\\top}u$ 和 $u_N = e_N^{\\top}u$，我们得到：\n$$\nu^{\\top}Q\\,u = \\frac{1}{2}u^{\\top}(-e_1 e_1^{\\top} + e_N e_N^{\\top})u = \\frac{1}{2}\\left(-(u^{\\top}e_1)(e_1^{\\top}u) + (u^{\\top}e_N)(e_N^{\\top}u)\\right) = \\frac{1}{2}\\left(-u_1^2 + u_N^2\\right).\n$$\n等式右侧是 SAT 项。注意到 $u^{\\top}e_1 = u_1$ 和 $u^{\\top}e_N = u_N$，右侧变为：\n$$\n\\sigma_L\\,u_1(g_L - u_1) + \\sigma_R\\,u_N(g_R - u_N) = \\sigma_L\\,g_L u_1 - \\sigma_L u_1^2 + \\sigma_R\\,g_R u_N - \\sigma_R u_N^2.\n$$\n结合这些结果，我们得到离散能量演化方程：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} + \\frac{a}{2}\\left(u_N^2 - u_1^2\\right) = \\sigma_L\\,g_L u_1 - \\sigma_L u_1^2 + \\sigma_R\\,g_R u_N - \\sigma_R u_N^2.\n$$\n重新整理，按边界对各项进行分组，我们有：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\left( \\frac{a}{2}u_1^2 + \\sigma_L\\,g_L u_1 - \\sigma_L u_1^2 \\right) + \\left( -\\frac{a}{2}u_N^2 + \\sigma_R\\,g_R u_N - \\sigma_R u_N^2 \\right).\n$$\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\left(\\frac{a}{2} - \\sigma_L\\right)u_1^2 + \\sigma_L\\,g_L u_1 - \\left(\\frac{a}{2} + \\sigma_R\\right)u_N^2 + \\sigma_R\\,g_R u_N.\n$$\n$\\sigma_L$ 和 $\\sigma_R$ 的选择取决于平流速度 $a$ 的符号，该符号决定了流入和流出边界。\n\n情况 1：$a > 0$。\n特征线从左向右传播。流入边界在 $x=0$（左侧），流出边界在 $x=1$（右侧）。\n物理边界条件在 $x=0$ 处给定，即 $u(0,t) = g_L(t)$。\n连续能量恒等式意味着能量流入为 $\\frac{a}{2}g_L^2$。为了匹配这一点，我们分析 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ 的流入项：$(\\frac{a}{2} - \\sigma_L)u_1^2 + \\sigma_L\\,g_L u_1$。为保证半有界性，我们希望其形式为 $-\\text{耗散项} + \\text{流入项}$。我们进行配方：\n$$\n-\\frac{a}{2}(u_1 - g_L)^2 + \\frac{a}{2}g_L^2 = -\\frac{a}{2}(u_1^2 - 2g_L u_1 + g_L^2) + \\frac{a}{2}g_L^2 = -\\frac{a}{2}u_1^2 + a\\,g_L u_1.\n$$\n将 $(\\frac{a}{2} - \\sigma_L)u_1^2 + \\sigma_L\\,g_L u_1$ 与 $-\\frac{a}{2}u_1^2 + a\\,g_L u_1$ 进行比较，我们令系数相等：\n- $u_1^2$ 的系数：$\\frac{a}{2} - \\sigma_L = -\\frac{a}{2} \\implies \\sigma_L = a$。\n- $g_L u_1$ 的系数：$\\sigma_L = a$。\n两个条件都由 $\\sigma_L = a$ 满足。\n在流出边界 ($x=1$)，没有给定数据。流出必须是耗散的。流出项为 $-(\\frac{a}{2} + \\sigma_R)u_N^2 + \\sigma_R g_R u_N$。在没有外部数据的情况下，确保耗散性的最直接方法是使惩罚项为零，这在 $\\sigma_R = 0$ 时发生。这些项随后简化为 $-\\frac{a}{2}u_N^2$，由于 $a>0$，该项为非正数。\n因此，对于 $a>0$，我们有 $\\sigma_L = a$ 和 $\\sigma_R = 0$。能量变化率变为 $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = -\\frac{a}{2}(u_1-g_L)^2 + \\frac{a}{2}g_L^2 - \\frac{a}{2}u_N^2 \\le \\frac{a}{2}g_L^2$，满足要求。\n\n情况 2：$a  0$。\n特征线从右向左传播。流入边界在 $x=1$（右侧），流出边界在 $x=0$（左侧）。\n物理边界条件在 $x=1$ 处，即 $u(1,t) = g_R(t)$。\n连续能量恒等式意味着能量流入为 $-\\frac{a}{2}g_R^2$。我们分析 $\\frac{\\mathrm{d}E}{\\mathrm{d}t}$ 的流入项：$-(\\frac{a}{2} + \\sigma_R)u_N^2 + \\sigma_R\\,g_R u_N$。我们进行配方以匹配所需形式，注意 $a  0$：\n$$\n\\frac{a}{2}(u_N - g_R)^2 - \\frac{a}{2}g_R^2 = \\frac{a}{2}(u_N^2 - 2g_R u_N + g_R^2) - \\frac{a}{2}g_R^2 = \\frac{a}{2}u_N^2 - a\\,g_R u_N.\n$$\n由于 $a  0$，项 $\\frac{a}{2}(u_N-g_R)^2$ 是耗散的。将 $-(\\frac{a}{2} + \\sigma_R)u_N^2 + \\sigma_R\\,g_R u_N$ 与 $\\frac{a}{2}u_N^2 - a\\,g_R u_N$ 进行比较：\n- $u_N^2$ 的系数：$-(\\frac{a}{2} + \\sigma_R) = \\frac{a}{2} \\implies -\\sigma_R = a \\implies \\sigma_R = -a$。\n- $g_R u_N$ 的系数：$\\sigma_R = -a$。\n两个条件都由 $\\sigma_R = -a$ 满足。\n在流出边界 ($x=0$)，我们要求耗散性。流出项为 $(\\frac{a}{2} - \\sigma_L)u_1^2 + \\sigma_L\\,g_L u_1$。设置 $\\sigma_L=0$ 可以消除惩罚项，这些项简化为 $\\frac{a}{2}u_1^2$，由于 $a  0$，该项为非正数。\n因此，对于 $a  0$，我们有 $\\sigma_L = 0$ 和 $\\sigma_R = -a$。能量变化率变为 $\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{a}{2}u_1^2 + \\frac{a}{2}(u_N-g_R)^2 - \\frac{a}{2}g_R^2 \\le -\\frac{a}{2}g_R^2$，满足要求。\n\n情况 3：$a = 0$。\n偏微分方程为 $u_t=0$。不需要边界条件。该格式在没有惩罚项的情况下应该是稳定的。流入和流出分析都表明相应的系数为零。对于 $a=0$，有 $\\sigma_L=a=0$ 和 $\\sigma_R=0$（来自 $a0$ 的情况），以及 $\\sigma_L=0$ 和 $\\sigma_R=-a=0$（来自 $a  0$ 的情况）。两者一致。因此，$\\sigma_L=0, \\sigma_R=0$。\n\n我们可以将这些结果统一为一个适用于任何 $a \\in \\mathbb{R}$ 的单一表达式。\n对于 $\\sigma_L$：如果 $a0$，则 $\\sigma_L=a$；如果 $a \\le 0$，则 $\\sigma_L=0$。这可以写成 $\\sigma_L = \\max(a, 0) = \\frac{a+|a|}{2}$。\n对于 $\\sigma_R$：如果 $a0$，则 $\\sigma_R=0$；如果 $a  0$，则 $\\sigma_R=-a$。注意，如果 $a  0$，则 $-a = |a|$。这可以写成 $\\sigma_R = \\max(-a, 0) = \\frac{-a+|a|}{2}$。\n\n因此，惩罚系数由以下表达式给出：\n$$\n\\sigma_L = \\frac{a+|a|}{2} \\quad \\text{和} \\quad \\sigma_R = \\frac{-a+|a|}{2}.\n$$\n这些是线性平流方程的 SBP-SAT 格式的标准迎风惩罚系数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{a+|a|}{2}  \\frac{-a+|a|}{2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}