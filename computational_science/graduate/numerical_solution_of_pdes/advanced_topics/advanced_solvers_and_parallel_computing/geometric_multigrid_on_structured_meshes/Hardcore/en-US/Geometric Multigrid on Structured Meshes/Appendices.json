{
    "hands_on_practices": [
        {
            "introduction": "Before we can analyze the effectiveness of multigrid smoothers, we must first understand how to characterize the underlying discrete operator in the frequency domain. This exercise introduces Local Fourier Analysis (LFA) by having you derive the Fourier symbol for the standard 5-point discrete Laplacian . Understanding this symbol is crucial, as it represents the eigenvalues of the operator and reveals how it amplifies or diminishes different frequency components of the error.",
            "id": "3399342",
            "problem": "Consider the two-dimensional Poisson equation on a torus (periodic domain) discretized on a structured Cartesian grid with uniform spacing $h$ in both directions. Let the discrete operator $A$ be the standard five-point positive definite Laplacian stencil defined by\n$$\n[A u]_{i,j} \\;=\\; \\frac{1}{h^{2}}\\Big(4\\,u_{i,j} \\;-\\; u_{i+1,j} \\;-\\; u_{i-1,j} \\;-\\; u_{i,j+1} \\;-\\; u_{i,j-1}\\Big),\n$$\nwith periodic indexing in both directions. Because of translation invariance on the periodic grid, complex exponential grid functions of the form\n$$\n\\varphi_{\\theta_{x},\\theta_{y}}(i,j) \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\,i + \\mathrm{i}\\,\\theta_{y}\\,j\\big),\n$$\nwhere $(\\theta_{x},\\theta_{y})$ lie in the first Brillouin zone $(-\\pi,\\pi] \\times (-\\pi,\\pi]$, are eigenfunctions of $A$. \n\nStarting from this definition and the properties of complex exponentials, derive the Fourier symbol $\\widehat{A}(\\theta_{x},\\theta_{y})$ of the operator $A$, and then determine its minimum and maximum values over the Brillouin zone $(-\\pi,\\pi] \\times (-\\pi,\\pi]$. Express your final answer as the ordered pair consisting of the minimum and the maximum values of $\\widehat{A}(\\theta_{x},\\theta_{y})$ over the Brillouin zone. No rounding is required.",
            "solution": "The operator $A$ is a linear, shift-invariant stencil on a periodic grid. On such a grid, complex exponential grid functions\n$$\n\\varphi_{\\theta_{x},\\theta_{y}}(i,j) \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\,i + \\mathrm{i}\\,\\theta_{y}\\,j\\big),\n$$\nare eigenfunctions of any translation-invariant discrete operator. The corresponding eigenvalue is the Fourier symbol of the operator. We compute $[A \\varphi]_{i,j}$ explicitly.\n\nBy definition of $A$,\n$$\n[A \\varphi]_{i,j} \\;=\\; \\frac{1}{h^{2}}\\Big(4\\,\\varphi_{i,j} \\;-\\; \\varphi_{i+1,j} \\;-\\; \\varphi_{i-1,j} \\;-\\; \\varphi_{i,j+1} \\;-\\; \\varphi_{i,j-1}\\Big).\n$$\nUsing the definition of $\\varphi$,\n$$\n\\varphi_{i+1,j} \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}(i+1) + \\mathrm{i}\\,\\theta_{y}\\,j\\big) \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\big)\\,\\varphi_{i,j},\n$$\n$$\n\\varphi_{i-1,j} \\;=\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{x}\\big)\\,\\varphi_{i,j}, \\quad\n\\varphi_{i,j+1} \\;=\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{y}\\big)\\,\\varphi_{i,j}, \\quad\n\\varphi_{i,j-1} \\;=\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{y}\\big)\\,\\varphi_{i,j}.\n$$\nSubstituting these relations yields\n$$\n[A \\varphi]_{i,j} \\;=\\; \\frac{1}{h^{2}}\\Big(4 \\;-\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\big) \\;-\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{x}\\big) \\;-\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{y}\\big) \\;-\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{y}\\big)\\Big)\\,\\varphi_{i,j}.\n$$\nTherefore, the Fourier symbol is\n$$\n\\widehat{A}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{1}{h^{2}}\\Big(4 \\;-\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{x}\\big) \\;-\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{x}\\big) \\;-\\; \\exp\\!\\big(\\mathrm{i}\\,\\theta_{y}\\big) \\;-\\; \\exp\\!\\big(-\\mathrm{i}\\,\\theta_{y}\\big)\\Big).\n$$\nUsing the identity $\\exp\\!\\big(\\mathrm{i}\\,\\theta\\big) + \\exp\\!\\big(-\\mathrm{i}\\,\\theta\\big) = 2\\cos(\\theta)$, we simplify\n$$\n\\widehat{A}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{1}{h^{2}}\\Big(4 \\;-\\; 2\\cos(\\theta_{x}) \\;-\\; 2\\cos(\\theta_{y})\\Big).\n$$\n\nWe now determine the extrema of $\\widehat{A}(\\theta_{x},\\theta_{y})$ over $(\\theta_{x},\\theta_{y}) \\in (-\\pi,\\pi] \\times (-\\pi,\\pi]$. Define\n$$\nf(\\theta_{x},\\theta_{y}) \\;=\\; 4 \\;-\\; 2\\cos(\\theta_{x}) \\;-\\; 2\\cos(\\theta_{y}).\n$$\nSince $\\cos(\\theta) \\in [-1,1]$ for all $\\theta$, the range of each term $-2\\cos(\\theta)$ is $[-2,2]$. Thus, the sum $-2\\cos(\\theta_{x}) - 2\\cos(\\theta_{y})$ ranges from $-4$ (when both cosines are $1$) to $4$ (when both cosines are $-1$). Consequently,\n$$\n\\min f \\;=\\; 4 - 4 \\;=\\; 0, \\quad \\max f \\;=\\; 4 + 4 \\;=\\; 8.\n$$\nMore explicitly, the minimum occurs at $(\\theta_{x},\\theta_{y}) = (0,0)$, yielding $f(0,0) = 0$, and the maximum occurs at $(\\theta_{x},\\theta_{y}) = (\\pi,\\pi)$, yielding $f(\\pi,\\pi) = 8$. Therefore,\n$$\n\\min_{(\\theta_{x},\\theta_{y}) \\in (-\\pi,\\pi]^{2}} \\widehat{A}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{0}{h^{2}} \\;=\\; 0, \\quad\n\\max_{(\\theta_{x},\\theta_{y}) \\in (-\\pi,\\pi]^{2}} \\widehat{A}(\\theta_{x},\\theta_{y}) \\;=\\; \\frac{8}{h^{2}}.\n$$\n\nThe ordered pair consisting of the minimum and maximum values of the Fourier symbol over the Brillouin zone is thus $0$ and $\\frac{8}{h^{2}}$.",
            "answer": "$$\\boxed{\\begin{pmatrix}0  \\frac{8}{h^{2}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "With the ability to analyze the discrete operator, we can now examine the behavior of an iterative smoother. This practice focuses on the weighted Jacobi method, a fundamental building block for many numerical schemes . By deriving the symbol and spectral radius of the Jacobi iteration operator, you will learn how to quantitatively assess the convergence rate of a simple iterative method across all frequency modes.",
            "id": "3399351",
            "problem": "Consider the discrete Poisson equation on the two-dimensional torus (periodic unit square), discretized by a uniform Cartesian grid with $N \\times N$ points and mesh spacing $h = 1/N$. Let $A$ be the $N^{2} \\times N^{2}$ matrix corresponding to the standard five-point finite difference discretization of the negative Laplace operator, defined for a grid function $u_{i,j}$ by\n$$\n(Au)_{i,j} = \\frac{1}{h^{2}}\\left(4\\,u_{i,j} - u_{i+1,j} - u_{i-1,j} - u_{i,j+1} - u_{i,j-1}\\right),\n$$\nwith periodic indexing in both $i$ and $j$. Let $D$ denote the diagonal of $A$, and consider the weighted Jacobi smoothing operator $S_{J} = I - \\omega D^{-1}A$ with weight parameter $\\omega \\in \\mathbb{R}$. \n\nStarting from the definition of the five-point stencil and the periodicity, derive the stencil form of $D^{-1}A$ and of $S_{J}$. Then, using the discrete Fourier basis on the periodic grid and local Fourier analysis (LFA), derive the eigenvalues of $S_{J}$ as functions of the Fourier frequencies and compute the spectral radius of $S_{J}$ on the periodic grid as an explicit function of $\\omega$. Express your final answer as a single closed-form analytic expression in $\\omega$. No rounding is required, and no physical units are involved.",
            "solution": "The weighted Jacobi iteration for the system $Au=f$ is given by $u^{k+1} = u^k + \\omega D^{-1}(f - Au^k)$. The corresponding error propagation operator is $S_J = I - \\omega D^{-1}A$.\n\nFirst, we identify the operator $D$. The matrix $A$ represents the five-point stencil. Its action on a grid function $u_{i,j}$ is:\n$$ (Au)_{i,j} = \\frac{1}{h^{2}}\\left(4\\,u_{i,j} - u_{i+1,j} - u_{i-1,j} - u_{i,j+1} - u_{i,j-1}\\right) $$\nThe diagonal of $A$ corresponds to the term multiplying $u_{i,j}$, which is $4/h^2$ for all points. Thus, $D$ is a scalar multiple of the identity operator, $D = \\frac{4}{h^2}I$. Its inverse is $D^{-1} = \\frac{h^2}{4}I$. The stencil for $S_J$ is $[S_J] = [I] - \\omega[D^{-1}][A] = [I] - \\omega \\frac{h^2}{4} \\frac{1}{h^2} \\begin{pmatrix}  -1  \\\\ -1  4  -1 \\\\  -1  \\end{pmatrix} = \\begin{pmatrix}  \\frac{\\omega}{4}  \\\\ \\frac{\\omega}{4}  1 - \\omega  \\frac{\\omega}{4} \\\\  \\frac{\\omega}{4}  \\end{pmatrix}$.\n\nNext, we use Local Fourier Analysis (LFA) to find the eigenvalues (symbols) of $S_J$. The Fourier modes $\\varphi_{i,j}(\\theta_x, \\theta_y) = \\exp\\big(i(i\\theta_x + j\\theta_y)\\big)$ are eigenfunctions of any linear, translation-invariant operator on a periodic grid. The symbol of an operator is its eigenvalue corresponding to a given Fourier mode.\n\nThe symbol of the operator $A$ is found by applying it to a Fourier mode:\n$$ \\widehat{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\left(4 - e^{i\\theta_x} - e^{-i\\theta_x} - e^{i\\theta_y} - e^{-i\\theta_y}\\right) = \\frac{2}{h^2} \\left(2 - \\cos\\theta_x - \\cos\\theta_y\\right) $$\nUsing the identity $1 - \\cos\\alpha = 2\\sin^2(\\alpha/2)$, this simplifies to:\n$$ \\widehat{A}(\\theta_x, \\theta_y) = \\frac{4}{h^2} \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right) $$\nThe symbol of $D$ is simply the constant $\\widehat{D} = 4/h^2$.\n\nThe symbol of the Jacobi iteration operator $S_J$ is then:\n$$ \\widehat{S}_J(\\theta_x, \\theta_y) = 1 - \\omega \\frac{\\widehat{A}(\\theta_x, \\theta_y)}{\\widehat{D}} = 1 - \\omega \\frac{\\frac{4}{h^2} \\left( \\sin^2(\\theta_x/2) + \\sin^2(\\theta_y/2) \\right)}{4/h^2} $$\n$$ \\widehat{S}_J(\\theta_x, \\theta_y) = 1 - \\omega \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right) $$\nThese are the eigenvalues of $S_J$.\n\nThe spectral radius $\\rho(S_J)$ is the maximum absolute value of these eigenvalues over all possible frequencies. Let $\\mu = \\sin^2(\\theta_x/2) + \\sin^2(\\theta_y/2)$. As $\\theta_x$ and $\\theta_y$ range over $[-\\pi, \\pi]$, the term $\\sin^2(\\theta/2)$ ranges over $[0,1]$. Therefore, the range of $\\mu$ is $[0, 2]$.\nWe need to find the maximum of $|\\lambda(\\mu)| = |1 - \\omega\\mu|$ for $\\mu \\in [0, 2]$. Since this is a linear function of $\\mu$ inside the absolute value, the maximum must occur at the endpoints of the interval:\n\\begin{itemize}\n    \\item At $\\mu = 0$: $|\\lambda(0)| = |1 - 0| = 1$. This corresponds to the zero-frequency mode $(\\theta_x, \\theta_y) = (0,0)$.\n    \\item At $\\mu = 2$: $|\\lambda(2)| = |1 - 2\\omega|$. This corresponds to the highest-frequency mode $(\\theta_x, \\theta_y) = (\\pi, \\pi)$.\n\\end{itemize}\nThe spectral radius is the maximum of these two values:\n$$ \\rho(S_J) = \\max\\big(1, |1 - 2\\omega|\\big) $$\nThis expression gives the spectral radius as a function of the weight $\\omega$.",
            "answer": "$$\n\\boxed{\\max(1, |1 - 2\\omega|)}\n$$"
        },
        {
            "introduction": "While the spectral radius measures overall convergence, a good multigrid smoother only needs to effectively damp high-frequency error components. This practice explores the lexicographic Gauss-Seidel method, a workhorse smoother that outperforms Jacobi in this regard . You will derive its more complex, asymmetric Fourier symbol and compute its smoothing factor, providing a direct measure of its effectiveness in a multigrid context.",
            "id": "3399391",
            "problem": "Consider the two-dimensional Poisson equation $-\\Delta u = f$ on an infinite, structured Cartesian grid with uniform spacing $h$, discretized by the standard five-point finite difference stencil. The resulting discrete operator $A$ acts on grid functions $\\{u_{i,j}\\}$ as $A u_{i,j} = \\frac{1}{h^{2}}\\left(4 u_{i,j} - u_{i+1,j} - u_{i-1,j} - u_{i,j+1} - u_{i,j-1}\\right)$. In geometric multigrid with standard $2$-to-$1$ coarsening in each direction, define the low-frequency set $\\mathcal{L} = \\{(\\theta_{x}, \\theta_{y}) \\in [-\\pi,\\pi]^{2} : |\\theta_{x}| \\leq \\pi/2,\\, |\\theta_{y}| \\leq \\pi/2\\}$ and the high-frequency set $\\mathcal{H} = [-\\pi,\\pi]^{2} \\setminus \\mathcal{L}$. Consider point-wise relaxation with lexicographic Gauss–Seidel ordering, where at grid point $(i,j)$ the newly updated values of the west $(i-1,j)$ and south $(i,j-1)$ neighbors are used and the old values of the east $(i+1,j)$ and north $(i,j+1)$ neighbors are used.\n\nStarting from the matrix splitting $A = D + L + U$, where $D$ is the diagonal, $L$ contains the lexicographically “lower” neighbor couplings (west and south), and $U$ contains the lexicographically “upper” neighbor couplings (east and north), the Gauss–Seidel error-propagation operator $S_{\\mathrm{GS}}$ is given by $S_{\\mathrm{GS}} = -(D+L)^{-1}U$. Use Local Fourier Analysis (LFA) for translation-invariant operators on an infinite grid, where the Fourier mode $\\varphi_{i,j}(\\theta_{x},\\theta_{y}) = \\exp\\big(i(\\theta_{x} i + \\theta_{y} j)\\big)$ is an eigenfunction of all shift operators, to derive the scalar symbol $\\widetilde{S}_{\\mathrm{GS}}(\\theta_{x},\\theta_{y})$ corresponding to lexicographic Gauss–Seidel. Then, using this symbol, compute the smoothing factor\n$$\n\\mu_{\\mathrm{GS}} \\;=\\; \\sup_{(\\theta_{x},\\theta_{y}) \\in \\mathcal{H}} \\left| \\widetilde{S}_{\\mathrm{GS}}(\\theta_{x},\\theta_{y}) \\right|.\n$$\nExplain, from first principles of the iteration and the structure of the symbol, why lexicographic Gauss–Seidel damps high-frequency modes more effectively than unweighted Jacobi on certain oscillatory error components. Finally, report the numerical value of $\\mu_{\\mathrm{GS}}$. Round your answer to four significant figures.",
            "solution": "We use Local Fourier Analysis (LFA) to derive the symbol of the lexicographic Gauss–Seidel smoother. The error-propagation operator is $S_{\\mathrm{GS}} = -(D+L)^{-1}U$. To find its symbol, we analyze the effect of one Gauss-Seidel sweep on a single Fourier mode of the error. The update rule for the error $e_{i,j}$ at grid point $(i,j)$, scaled by $h^2$, is:\n$$\n4 e_{i,j}^{k+1} - e_{i-1,j}^{k+1} - e_{i,j-1}^{k+1} - e_{i+1,j}^k - e_{i,j+1}^k = 0\n$$\nLet the error before the sweep be the Fourier mode $e_{i,j}^k = \\varphi_{i,j} = \\exp\\big(i(\\theta_x i + \\theta_y j)\\big)$ and the error after the sweep be $e_{i,j}^{k+1} = \\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y) \\varphi_{i,j}$. Substituting these into the error equation and applying the shift properties of Fourier modes (e.g., $e_{i-1,j}^{k+1} = \\widetilde{S}_{\\mathrm{GS}} e^{-i\\theta_x}\\varphi_{i,j}$ and $e_{i+1,j}^k = e^{i\\theta_x}\\varphi_{i,j}$):\n$$\n\\widetilde{S}_{\\mathrm{GS}} \\left(4 \\varphi_{i,j} - e^{-i\\theta_x}\\varphi_{i,j} - e^{-i\\theta_y}\\varphi_{i,j}\\right) - \\left(e^{i\\theta_x}\\varphi_{i,j} + e^{i\\theta_y}\\varphi_{i,j}\\right) = 0\n$$\nDividing by $\\varphi_{i,j} \\neq 0$ and solving for the symbol $\\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y)$:\n$$\n\\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y) \\left(4 - e^{-i\\theta_x} - e^{-i\\theta_y}\\right) = e^{i\\theta_x} + e^{i\\theta_y}\n$$\n$$\n\\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y) = \\frac{e^{i\\theta_x} + e^{i\\theta_y}}{4 - e^{-i\\theta_x} - e^{-i\\theta_y}}\n$$\nThis is the complex-valued symbol for the lexicographic Gauss–Seidel smoother.\n\nThe smoothing factor $\\mu_{\\mathrm{GS}}$ is the supremum of the modulus of this symbol over the high-frequency domain $\\mathcal{H} = [-\\pi,\\pi]^2 \\setminus [-\\pi/2, \\pi/2]^2$.\n$$\n\\mu_{\\mathrm{GS}} = \\sup_{(\\theta_x, \\theta_y) \\in \\mathcal{H}} \\left| \\widetilde{S}_{\\mathrm{GS}}(\\theta_x, \\theta_y) \\right|\n$$\nThe maximum of $|\\widetilde{S}_{\\mathrm{GS}}|$ over $\\mathcal{H}$ is attained on the boundary separating low and high frequencies, i.e., where $|\\theta_x| = \\pi/2$ or $|\\theta_y| = \\pi/2$. By symmetry, we analyze the boundary segment $(\\pi/2, \\theta_y)$ for $\\theta_y \\in [-\\pi/2, \\pi/2]$. The squared modulus is:\n$$\n\\left|\\widetilde{S}_{\\mathrm{GS}}(\\pi/2, \\theta_y)\\right|^2 = \\left|\\frac{i + e^{i\\theta_y}}{4 - (-i) - e^{-i\\theta_y}}\\right|^2 = \\frac{|i + \\cos\\theta_y + i\\sin\\theta_y|^2}{|4+i - (\\cos\\theta_y - i\\sin\\theta_y)|^2} = \\frac{|\\cos\\theta_y + i(1+\\sin\\theta_y)|^2}{|(4-\\cos\\theta_y) + i(1+\\sin\\theta_y)|^2}\n$$\n$$\n= \\frac{\\cos^2\\theta_y + (1+\\sin\\theta_y)^2}{(4-\\cos\\theta_y)^2 + (1+\\sin\\theta_y)^2} = \\frac{\\cos^2\\theta_y+1+2\\sin\\theta_y+\\sin^2\\theta_y}{16-8\\cos\\theta_y+\\cos^2\\theta_y+1+2\\sin\\theta_y+\\sin^2\\theta_y} = \\frac{2+2\\sin\\theta_y}{18-8\\cos\\theta_y+2\\sin\\theta_y}\n$$\nThis function of $\\theta_y$ is maximized for $\\theta_y$ in $[-\\pi/2, \\pi/2]$ at $\\theta_y=2\\arctan(1/3)$, where it evaluates to $1/4$. Another local extremum occurs at the corner point $(\\pi/2, \\pi/2)$, where the squared magnitude is $|\\widetilde{S}_{\\mathrm{GS}}(\\pi/2, \\pi/2)|^2 = \\frac{2+2}{18+2} = \\frac{4}{20} = \\frac{1}{5}$. The supremum is thus $\\sqrt{1/4} = 1/2$.\n$$\n\\mu_{\\mathrm{GS}} = \\frac{1}{2} = 0.5\n$$\nLexicographic Gauss–Seidel is a more effective smoother than unweighted Jacobi because it uses updated information within each sweep. The Gauss-Seidel update for the error at point $(i,j)$ depends on the just-computed error values at neighboring points $(i-1,j)$ and $(i,j-1)$. This directional propagation of information is particularly effective at damping high-frequency modes. For the highest-frequency (checkerboard) mode $(\\pi, \\pi)$, where error values alternate in sign, the symbol for Gauss-Seidel is $\\widetilde{S}_{\\mathrm{GS}}(\\pi,\\pi) = \\frac{-1-1}{4-(-1)-(-1)} = -1/3$, showing significant damping. In contrast, the symbol for unweighted Jacobi is $\\widetilde{S}_{\\mathrm{Jac}}(\\pi,\\pi) = \\frac{1}{2}(\\cos\\pi+\\cos\\pi) = -1$, meaning it does not damp this mode at all. The complex nature of the Gauss-Seidel symbol reflects this phase-shifting, asymmetric update, which is absent in the real-valued, symmetric symbol of Jacobi.\n\nThe numerical value of the smoothing factor is $0.5$. To four significant figures, this is $0.5000$.",
            "answer": "$$\n\\boxed{0.5000}\n$$"
        }
    ]
}