{
    "hands_on_practices": [
        {
            "introduction": "在设计一个高效的数值求解器之前，我们必须首先理解我们所求解的离散系统的内在属性。全多重网格（FMG）方法的目标是以最优的计算效率，获得一个与离散化误差同量级的代数误差的解。因此，分析离散化本身产生的截断误差，是理解FMG方法精度目标和评估其性能的第一步。这项练习将通过经典的泰勒级数分析，推导标准五点拉普拉斯算子的截断误差，从而揭示其二阶精度特性 。",
            "id": "3396892",
            "problem": "考虑单位正方形 $\\Omega = (0,1)^{2}$ 上的泊松偏微分方程 (PDE) $-\\Delta u = f$，其在边界 $\\partial \\Omega$ 上具有 Dirichlet 边界数据 $u = g$，其中 $u \\in C^{6}(\\overline{\\Omega})$。设 $\\{ \\mathcal{T}_{h} \\}$ 为一系列嵌套的均匀笛卡尔网格，在两个坐标方向上的网格尺寸均为 $h$，并假设采用完全多重网格 (FMG) 和嵌套迭代 (NI) 方法在最细网格上计算近似解 $u_{h}$。在每个网格 $\\mathcal{T}_{h}$ 上，离散拉普拉斯算子在内部点 $(x_{i}, y_{j})$ 处由标准的 $5$-点差分格式定义\n$$\n(L_{h} u)_{i,j} := \\frac{u(x_{i}+h, y_{j}) - 2 u(x_{i}, y_{j}) + u(x_{i}-h, y_{j})}{h^{2}} + \\frac{u(x_{i}, y_{j}+h) - 2 u(x_{i}, y_{j}) + u(x_{i}, y_{j}-h)}{h^{2}}.\n$$\n从基本定义和熟知的公式（特别是光滑函数的多元泰勒级数和中心差分相容性论证）出发，推导 $L_{h}$ 在一个一般内部点 $(x_{i}, y_{j})$ 处的截断误差，用在 $(x_{i}, y_{j})$ 处计算的 $u$ 的空间导数来表示，并确定阶数 $p$ 使得当 $h \\to 0$ 时，相容性误差 $\\| L_{h} u - \\Delta u \\|_{\\infty} = \\mathcal{O}(h^{p})$。你的推导应清楚地说明主误差项是如何产生的，以及其量级如何为 FMG 与 NI 方法在各层级间传递和加密近似解时所要达到的精度尺度提供信息。\n\n将你的最终答案以两个量的形式报告：在 $(x_{i}, y_{j})$ 处的主阶截断误差和阶数 $p$。不需要进行数值舍入，也不涉及物理单位。使用 LaTeX 的 $\\texttt{pmatrix}$ 环境将最终答案表示为一个单行矩阵，其中第一个元素等于主阶截断误差，第二个元素等于 $p$。",
            "solution": "该问题已经过验证，被认为是有效的，因为它具有科学依据、是适定的、客观的，并符合数值分析中可解问题的所有标准。\n\n目标是推导拉普拉斯算子的标准 $5$-点中心差分近似的局部截断误差，并确定其相容阶。将离散拉普拉斯算子 $L_{h}$ 应用于连续问题的精确解 $u$ 在一个内部网格点 $(x_{i}, y_{j})$ 处。该点的截断误差 $\\tau_{h}$ 定义为将精确解代入离散算子，再减去作用于该解的精确微分算子所得到的残差：\n$$\n\\tau_{h}(x_i, y_j) = (L_{h} u)(x_i, y_j) - (\\Delta u)(x_i, y_j)\n$$\n算子 $L_h$ 由下式给出：\n$$\n(L_{h} u)_{i,j} = \\frac{u(x_{i}+h, y_{j}) - 2 u(x_{i}, y_{j}) + u(x_{i}-h, y_{j})}{h^{2}} + \\frac{u(x_{i}, y_{j}+h) - 2 u(x_{i}, y_{j}) + u(x_{i}, y_{j}-h)}{h^{2}}\n$$\n我们来分别分析右侧的两项。为清晰起见，我们将省略下标 $(i,j)$，用 $(x,y)$ 表示点 $(x_i, y_j)$，并用下标表示偏导数，例如，$u_x = \\frac{\\partial u}{\\partial x}$，$u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$。\n\n问题陈述解 $u$ 属于 $C^{6}(\\overline{\\Omega})$ 类。这种光滑性足以支持对 $u$ 在点 $(x, y)$ 周围进行泰勒级数展开。\n\n首先，考虑 $x$ 方向的各项。$u(x+h, y)$ 和 $u(x-h, y)$ 在 $(x,y)$ 点的泰勒展开式为：\n$$\nu(x+h, y) = u(x,y) + h u_{x}(x,y) + \\frac{h^{2}}{2!} u_{xx}(x,y) + \\frac{h^{3}}{3!} u_{xxx}(x,y) + \\frac{h^{4}}{4!} u_{xxxx}(x,y) + \\frac{h^{5}}{5!} u_{xxxxx}(x,y) + \\mathcal{O}(h^{6})\n$$\n$$\nu(x-h, y) = u(x,y) - h u_{x}(x,y) + \\frac{h^{2}}{2!} u_{xx}(x,y) - \\frac{h^{3}}{3!} u_{xxx}(x,y) + \\frac{h^{4}}{4!} u_{xxxx}(x,y) - \\frac{h^{5}}{5!} u_{xxxxx}(x,y) + \\mathcal{O}(h^{6})\n$$\n$C^6$ 正则性保证了余项是 $\\mathcal{O}(h^6)$ 阶的。将这两个展开式相加，我们观察到所有 $h$ 的奇次幂项都相互抵消：\n$$\nu(x+h, y) + u(x-h, y) = 2 u(x,y) + h^{2} u_{xx}(x,y) + \\frac{2h^{4}}{24} u_{xxxx}(x,y) + \\mathcal{O}(h^{6})\n$$\n整理此和式以构造二阶导数的中心差分，得到：\n$$\n\\frac{u(x+h, y) - 2u(x,y) + u(x-h, y)}{h^{2}} = u_{xx}(x,y) + \\frac{h^{2}}{12} u_{xxxx}(x,y) + \\mathcal{O}(h^{4})\n$$\n通过对 $y$ 方向进行完全相同的论证，我们得到：\n$$\n\\frac{u(x, y+h) - 2u(x,y) + u(x, y-h)}{h^{2}} = u_{yy}(x,y) + \\frac{h^{2}}{12} u_{yyyy}(x,y) + \\mathcal{O}(h^{4})\n$$\n现在，我们将这两个表达式相加以构造离散算子 $L_{h}$ 对 $u$ 的作用：\n$$\n(L_{h} u)(x,y) = \\left( u_{xx}(x,y) + \\frac{h^{2}}{12} u_{xxxx}(x,y) \\right) + \\left( u_{yy}(x,y) + \\frac{h^{2}}{12} u_{yyyy}(x,y) \\right) + \\mathcal{O}(h^{4})\n$$\n合并同类项，我们得到：\n$$\n(L_{h} u)(x,y) = \\left( u_{xx}(x,y) + u_{yy}(x,y) \\right) + \\frac{h^{2}}{12} \\left( u_{xxxx}(x,y) + u_{yyyy}(x,y) \\right) + \\mathcal{O}(h^{4})\n$$\n括号中的第一项正是 $u$ 的拉普拉斯算子，$\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$。因此，我们可以写出：\n$$\n(L_{h} u)(x,y) = (\\Delta u)(x,y) + \\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}}(x,y) + \\frac{\\partial^{4} u}{\\partial y^{4}}(x,y) \\right) + \\mathcal{O}(h^{4})\n$$\n截断误差 $\\tau_{h}$ 是 $(L_{h} u) - (\\Delta u)$ 的差：\n$$\n\\tau_{h}(x,y) = \\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}}(x,y) + \\frac{\\partial^{4} u}{\\partial y^{4}}(x,y) \\right) + \\mathcal{O}(h^{4})\n$$\n截断误差的主阶项是含有 $h$ 的最低次幂的项，即：\n$$\n\\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}} + \\frac{\\partial^{4} u}{\\partial y^{4}} \\right)\n$$\n问题要求相容性误差的阶 $p$，其定义为 $\\|L_h u - \\Delta u\\|_{\\infty} = \\mathcal{O}(h^p)$。这是所有内部网格点上局部截断误差绝对值的最大值。由于 $u \\in C^{6}(\\overline{\\Omega})$，其四阶偏导数在紧集上是连续的，因此是有界的。设 $M$ 是一个常数，使得 $\\sup_{(x,y) \\in \\Omega} \\left| \\frac{1}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}} + \\frac{\\partial^{4} u}{\\partial y^{4}} \\right) \\right| \\leq M  \\infty$。那么：\n$$\n\\|L_h u - \\Delta u\\|_{\\infty} = \\sup_{i,j} |\\tau_h(x_i, y_j)| \\leq M h^{2} + \\mathcal{O}(h^{4})\n$$\n这表明相容性误差是 $\\mathcal{O}(h^{2})$ 阶的。因此，阶数 $p$ 为 $2$。\n\n这个主误差项的量级，特别是其 $\\mathcal{O}(h^{2})$ 的缩放规律，对于完全多重网格 (FMG) 与嵌套迭代 (NI) 的设计和效率至关重要。FMG 的目标是在最细网格（网格尺寸为 $h_k$）上计算一个离散解 $u_h$，使其误差 $\\|u - u_h\\|_{\\infty}$ 与截断误差同阶，在此情况下为 $\\mathcal{O}(h^2_k)$。NI 过程从最粗的网格开始，求得一个解。然后将该解插值到下一个更细的网格上，作为初始猜测。对于一个二阶格式 ($p=2$)，对粗网格解进行足够精确的插值（例如，双线性插值），可以在细网格上提供一个误差已经为 $\\mathcal{O}(h^2)$ 的初始猜测。然后，少量的、固定次数的多重网格循环（例如，一个 V-循环）就足以将代数误差的高频分量降低到离散化误差水平以下。其结果是在计算成本与最细网格上的未知数数量成线性关系的情况下，获得一个精确到 $\\mathcal{O}(h^2)$ 的解 $u_h$，这是渐近最优的。主误差项 $\\frac{h^2}{12}(\\dots)$ 的量级为多重网格层级中每一层的代数求解器设定了所期望的精度尺度。\n\n所要求的两个量是主阶截断误差和阶数 $p$。\n1. 在 $(x_{i},y_{j})$ 处的主阶截断误差：$\\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}} + \\frac{\\partial^{4} u}{\\partial y^{4}} \\right)$\n2. 阶数 $p$：$2$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}} + \\frac{\\partial^{4} u}{\\partial y^{4}} \\right)  2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然多重网格方法在求解各向同性问题（如标准泊松方程）时表现出色，但在实际应用中，我们经常遇到各向异性的挑战，即问题在不同方向上的耦合强度差异巨大。在这种情况下，标准的点松弛光滑器和均匀粗化策略会失效，导致收敛速度急剧恶化。本练习旨在探讨各向异性问题对离散算子和多重网格性能的影响，并引导你识别出构建稳健多重网格方法的关键组件，如行松弛和半粗化 。",
            "id": "3396946",
            "problem": "考虑在矩形区域 $\\Omega = (0,L_x)\\times(0,L_y)$ 上的泊松方程 $-\\Delta u = f$，边界条件为在 $\\partial\\Omega$ 上 $u=0$ 的齐次狄利克雷边界条件。设该区域由一个内部点的张量积网格离散化，其网格间距为 $h_x = L_x/(N_x+1)$ 和 $h_y = L_y/(N_y+1)$，其中 $N_x, N_y \\in \\mathbb{N}$ 分别是 $x$ 和 $y$ 方向上内部网格点的数量，且 $h_x \\neq h_y$。使用标准的五点有限差分法，可以得到一个关于内部未知数的稀疏线性系统 $A \\mathbf{u} = \\mathbf{f}$。\n\n基于有限差分和张量积网格上谱分析的标准原理，确定各向异性离散拉普拉斯矩阵 $A$ 的正确构造，以及当 $L_x,L_y$ 固定时，随着 $h_x,h_y \\to 0$，其条件数 $\\kappa(A)$ 如何随 $h_x$ 和 $h_y$ 变化。此外，评估在存在网格各向异性 $h_x \\neq h_y$ 的情况下，带有嵌套迭代的完全多重网格（FMG）方法行为的陈述。\n\n选择所有正确的选项。\n\nA. 对于 $N_x N_y$ 个内部未知数采用字典序排序，刚度矩阵 $A$ 是克罗内克和\n$A \\;=\\; I_{N_y} \\otimes T_x \\;+\\; T_y \\otimes I_{N_x}$，\n其中 $T_x = \\operatorname{tridiag}(-1,2,-1)/h_x^2$ 且 $T_y = \\operatorname{tridiag}(-1,2,-1)/h_y^2$。对于固定的 $L_x,L_y$，当 $h_x,h_y \\to 0$ 时，其条件数满足 $\\kappa(A) = \\Theta(1/h_x^2 + 1/h_y^2)$。\n\nB. 离散算子矩阵是克罗内克积 $A = T_x \\otimes T_y$，其元素按 $1/(h_x^2 h_y^2)$ 进行缩放；因此 $\\kappa(A) = \\Theta(1/(h_x^2 h_y^2))$。\n\nC. 采用与选项 A 中相同的构造，条件数的变化规律为 $\\kappa(A) = \\Theta(1/h_{\\min}^2)$，其中 $h_{\\min} = \\min\\{h_x,h_y\\}$。\n\nD. 在带有嵌套迭代和逐点高斯-赛德尔光滑化并结合两个方向上标准 $2 \\times 2$ 粗化的完全多重网格（FMG）中，收敛速度相对于宽高比 $h_x/h_y$ 是均匀有界的，因此对于 $h_x \\ll h_y$ 的情况无需修改。\n\nE. 在针对 $h_x \\neq h_y$ 的带有嵌套迭代的完全多重网格（FMG）中，在强耦合方向上采用线松弛，同时在弱耦合方向上采用半粗化，可以得到与网格无关且在宽高比上均匀的收敛速度。",
            "solution": "用户希望我扮演一位严谨苛刻的STEM领域教授，解决一个与泊松方程数值解相关的问题。\n\n### 问题验证\n\n首先，我必须验证问题陈述本身，不包括选项。\n\n**第1步：提取已知条件**\n-   **偏微分方程（PDE）：** $-\\Delta u = f$\n-   **区域：** $\\Omega = (0,L_x)\\times(0,L_y)$\n-   **边界条件：** 在 $\\partial\\Omega$ 上 $u=0$ （齐次狄利克雷）。\n-   **离散化：** 由内部点组成的张量积网格。\n-   **网格间距：** $h_x = L_x/(N_x+1)$ 和 $h_y = L_y/(N_y+1)$。\n-   **网格尺寸：** $N_x, N_y \\in \\mathbb{N}$ 是 $x$ 和 $y$ 方向上的内部网格点数量。\n-   **各向异性：** $h_x \\neq h_y$ 是允许的。\n-   **数值方法：** 标准五点有限差分法。\n-   **线性系统：** $A \\mathbf{u} = \\mathbf{f}$。\n-   **问题：**\n    1.  确定各向异性离散拉普拉斯矩阵 $A$ 的正确构造。\n    2.  确定其条件数 $\\kappa(A)$ 随 $h_x$ 和 $h_y$ 的变化规律。\n    3.  评估关于各向异性网格上使用嵌套迭代的完全多重网格（FMG）的陈述。\n\n**第2步：使用提取的已知条件进行验证**\n-   **科学基础：** 该问题是偏微分方程（PDE）数值分析领域的经典课题。它涉及泊松方程的有限差分离散化以及所得线性系统的分析，包括像各向异性问题的多重网格方法这样的高级主题。所有概念都牢固地植根于成熟的数学和计算科学。\n-   **适定性：** 问题明确了偏微分方程、区域、边界条件和离散化方法。所提出的关于矩阵结构、条件数和多重网格行为的问题定义明确，在数值分析理论中有其唯一、确定的依据。\n-   **客观性：** 问题以精确、客观、形式化的数学语言陈述。没有主观因素。\n-   **完整性与一致性：** 问题提供了推导矩阵 $A$、分析其性质以及评估多重网格算法性能所需的所有必要信息。没有矛盾之处。\n-   **现实性与可行性：** 该设置是用于分析数值方法的标准模型问题。在其理论背景下完全是现实的。\n-   **结构与有效性：** 问题结构良好、不简单，并测试了该学科的基础和高级知识。它不包含循环论证或未定义的术语。\n\n**第3步：结论与行动**\n问题陈述有效。我将进行全面的推导和分析。\n\n### 推导与分析\n\n我们首先推导离散算子矩阵 $A$ 的结构和性质。\n\n**1. 有限差分离散化与矩阵结构**\n泊松方程为 $-\\Delta u = -(\\partial_{xx} u + \\partial_{yy} u) = f$。我们在一个内部网格点 $(x_i, y_j) = (i h_x, j h_y)$ 处使用中心差分来离散化二阶导数，其中 $i \\in \\{1, \\dots, N_x\\}$ 且 $j \\in \\{1, \\dots, N_y\\}$。令 $u_{i,j} \\approx u(x_i, y_j)$。\n$$\n-\\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_x^2} - \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_y^2} = f_{i,j}\n$$\n此方程对 $N_x N_y$ 个内部点中的每一个都成立。为了构建全局刚度矩阵 $A$，我们将未知数 $u_{i,j}$ 排列成一个长度为 $N_x N_y$ 的单一向量 $\\mathbf{u}$。使用字典序排序（其中 $x$ 方向的索引 $i$ 变化最快），未知数向量为 $\\mathbf{u} = [u_{1,1}, \\dots, u_{N_x,1}, u_{1,2}, \\dots, u_{N_x,2}, \\dots, u_{1,N_y}, \\dots, u_{N_x,N_y}]^T$。\n\n离散算子是 $x$ 和 $y$ 方向上离散二阶导数算子 $-\\Delta_h = -\\Delta_x - \\Delta_y$ 的和。在矩阵形式中，这种可分离性使用克罗内克和来表示。\n设 $T_k$ 是用于一维二阶导数的 $N_k \\times N_k$ 矩阵：\n$$\nT_k = \\frac{1}{h_k^2} \\operatorname{tridiag}(-1, 2, -1)\n$$\n对于 $k \\in \\{x, y\\}$。算子 $-\\Delta_x$ 对应于将 $T_x$ 应用于网格的每一行，这由矩阵 $I_{N_y} \\otimes T_x$ 表示。算子 $-\\Delta_y$ 对应于将 $T_y$ 应用于网格的每一列，在字典序下这由矩阵 $T_y \\otimes I_{N_x}$ 表示。因此，总的离散拉普拉斯矩阵 $A$ 是克罗内克和：\n$$\nA = I_{N_y} \\otimes T_x + T_y \\otimes I_{N_x}\n$$\n\n**2. 特征值与条件数**\n$N_k \\times N_k$ 矩阵 $T_k$ 的特征值已知为：\n$$\n\\lambda_p(T_k) = \\frac{2}{h_k^2} \\left(1 - \\cos\\left(\\frac{p\\pi}{N_k+1}\\right)\\right) = \\frac{4}{h_k^2} \\sin^2\\left(\\frac{p\\pi}{2(N_k+1)}\\right), \\quad p=1, \\dots, N_k\n$$\n克罗内克和 $A = I_{N_y} \\otimes T_x + T_y \\otimes I_{N_x}$ 的特征值是其组成矩阵特征值的所有可能和：\n$$\n\\lambda_{p,q}(A) = \\lambda_p(T_x) + \\lambda_q(T_y) = \\frac{4}{h_x^2} \\sin^2\\left(\\frac{p\\pi}{2(N_x+1)}\\right) + \\frac{4}{h_y^2} \\sin^2\\left(\\frac{q\\pi}{2(N_y+1)}\\right)\n$$\n其中 $p \\in \\{1, \\dots, N_x\\}$ 且 $q \\in \\{1, \\dots, N_y\\}$。\n\n条件数为 $\\kappa(A) = \\lambda_{\\max}(A) / \\lambda_{\\min}(A)$。\n-   **最小特征值 ($\\lambda_{\\min}$):** 这发生在 $p=1, q=1$ 时。当 $h_x, h_y \\to 0$ 时，$N_x, N_y \\to \\infty$。使用 $h_x = L_x/(N_x+1)$ 以及对于小 $\\theta$ 的近似 $\\sin(\\theta) \\approx \\theta$：\n    $$\n    \\lambda_{\\min}(A) = \\frac{4}{h_x^2} \\sin^2\\left(\\frac{\\pi h_x}{2L_x}\\right) + \\frac{4}{h_y^2} \\sin^2\\left(\\frac{\\pi h_y}{2L_y}\\right) \\approx \\frac{4}{h_x^2}\\left(\\frac{\\pi h_x}{2L_x}\\right)^2 + \\frac{4}{h_y^2}\\left(\\frac{\\pi h_y}{2L_y}\\right)^2 = \\frac{\\pi^2}{L_x^2} + \\frac{\\pi^2}{L_y^2}\n    $$\n    由于 $L_x$ 和 $L_y$ 是固定的，所以 $\\lambda_{\\min}(A) = \\Theta(1)$。\n\n-   **最大特征值 ($\\lambda_{\\max}$):** 这发生在 $p=N_x, q=N_y$ 时。当 $N_x, N_y \\to \\infty$ 时，正弦函数的参数趋近于 $\\pi/2$。\n    $$\n    \\frac{N_x\\pi}{2(N_x+1)} = \\frac{\\pi}{2}\\left(1 - \\frac{1}{N_x+1}\\right) \\to \\frac{\\pi}{2} \\quad \\implies \\quad \\sin^2\\left(\\frac{N_x\\pi}{2(N_x+1)}\\right) \\to 1\n    $$\n    因此，对于小的 $h_x, h_y$：\n    $$\n    \\lambda_{\\max}(A) \\approx \\frac{4}{h_x^2} + \\frac{4}{h_y^2}\n    $$\n-   **条件数变化规律：**\n    $$\n    \\kappa(A) = \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)} \\approx \\frac{4/h_x^2 + 4/h_y^2}{\\pi^2/L_x^2 + \\pi^2/L_y^2} = \\Theta\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)\n    $$\n    设 $h_{\\min} = \\min\\{h_x, h_y\\}$ 和 $h_{\\max} = \\max\\{h_x, h_y\\}$。该表达式可以重写为：\n    $$\n    \\frac{1}{h_x^2} + \\frac{1}{h_y^2} = \\frac{1}{h_{\\min}^2} + \\frac{1}{h_{\\max}^2}\n    $$\n    由于 $1 \\cdot \\frac{1}{h_{\\min}^2} \\le \\frac{1}{h_{\\min}^2} + \\frac{1}{h_{\\max}^2} \\le 2 \\cdot \\frac{1}{h_{\\min}^2}$，该变化规律为 $\\Theta(1/h_{\\min}^2)$。\n\n**3. 针对各向异性问题的多重网格方法**\n多重网格方法的效率依赖于光滑器衰减高频误差分量的能力，以及粗网格校正处理低频误差分量的能力。\n-   **各向异性：** 如果 $h_x \\ll h_y$，由于 $1/h_x^2$ 的缩放因子， $x$ 方向的耦合远强于 $y$ 方向。\n-   **标准多重网格的失效：** 标准的逐点光滑器（如 Gauss-Seidel）对于在强耦合方向上光滑（$x$ 方向低频）但在弱耦合方向上振荡（$y$ 方向高频）的误差分量是无效的。这些模式对逐点光滑器是“不可见”的。标准粗化（两个方向上 $h \\to 2h$）也无法在粗网格上准确表示这些模式。因此，随着宽高比 $h_x/h_y$ 偏离 1，标准多重网格的收敛速度会灾难性地恶化。收敛速度相对于宽高比不是均匀的。\n-   **稳健的多重网格方法：** 为了处理各向异性，必须使用更复杂的组件。\n    -   **线松弛：** 与逐点松弛不同，可以同时求解整条线上的未知数。对于 $x$ 方向的强耦合（$h_x \\ll h_y$），会使用 $x$-线松弛。这对每条线都像一个精确求解器，有效地衰减 $x$ 方向的误差频率。\n    -   **半粗化：** 仅在弱耦合方向上进行粗化。如果 $x$ 方向耦合强，则仅在 $y$ 方向进行粗化。这确保了在强耦合方向上保持细网格的分辨率，使光滑器能有效工作，而粗网格则处理在 $y$ 方向上光滑的误差。\n    在强耦合方向上使用线松弛和在弱耦合方向上使用半粗化的组合，产生了一种其收敛速度既不依赖于网格尺寸也不依赖于宽高比的多重网格方法。\n\n### 逐项评估\n\n**A. 对于 $N_x N_y$ 个内部未知数采用字典序排序，刚度矩阵 $A$ 是克罗内克和 $A \\;=\\; I_{N_y} \\otimes T_x \\;+\\; T_y \\otimes I_{N_x}$，其中 $T_x = \\operatorname{tridiag}(-1,2,-1)/h_x^2$ 且 $T_y = \\operatorname{tridiag}(-1,2,-1)/h_y^2$。对于固定的 $L_x,L_y$，当 $h_x,h_y \\to 0$ 时，其条件数满足 $\\kappa(A) = \\Theta(1/h_x^2 + 1/h_y^2)$。**\n-   如上所述，使用给定的 $T_x$ 和 $T_y$ 将 $A$ 构造为克罗内克和是正确的。\n-   根据谱分析推导，条件数 $\\kappa(A)$ 的变化规律为 $\\Theta(1/h_x^2 + 1/h_y^2)$ 也是正确的。\n-   **结论：正确。**\n\n**B. 离散算子矩阵是克罗内克积 $A = T_x \\otimes T_y$，其元素按 $1/(h_x^2 h_y^2)$ 进行缩放；因此 $\\kappa(A) = \\Theta(1/(h_x^2 h_y^2))$。**\n-   离散拉普拉斯算子对应于克罗内克和，而不是克罗内克积。克罗内克积将对应于一个不同的、更高阶的算子，产生一个九点模板。矩阵的基本结构陈述错误。\n-   **结论：错误。**\n\n**C. 采用与选项 A 中相同的构造，条件数的变化规律为 $\\kappa(A) = \\Theta(1/h_{\\min}^2)$，其中 $h_{\\min} = \\min\\{h_x,h_y\\}$。**\n-   选项 A 的构造是正确的。变化规律是 $\\kappa(A) = \\Theta(1/h_x^2 + 1/h_y^2)$。\n-   正如推导中所示，$1 \\cdot (1/h_{\\min}^2) \\le (1/h_x^2 + 1/h_y^2) \\le 2 \\cdot (1/h_{\\min}^2)$。\n-   这意味着在大O表示法中，$\\Theta(1/h_x^2 + 1/h_y^2)$ 等价于 $\\Theta(1/h_{\\min}^2)$。该陈述是对变化规律行为的正确简化。\n-   **结论：正确。**\n\n**D. 在带有嵌套迭代和逐点高斯-赛德尔光滑化并结合两个方向上标准 $2 \\times 2$ 粗化的完全多重网格（FMG）中，收敛速度相对于宽高比 $h_x/h_y$ 是均匀有界的，因此对于 $h_x \\ll h_y$ 的情况无需修改。**\n-   这描述了应用于各向异性问题的标准多重网格算法。在多重网格理论中，这是一个众所周知的结果，即这种组合不是稳健的。随着宽高比偏离 1，收敛速度显著下降。关于收敛速度均匀有界的说法是错误的。\n-   **结论：错误。**\n\n**E. 在针对 $h_x \\neq h_y$ 的带有嵌套迭代的完全多重网格（FMG）中，在强耦合方向上采用线松弛，同时在弱耦合方向上采用半粗化，可以得到与网格无关且在宽高比上均匀的收敛速度。**\n-   该陈述准确地描述了针对各向异性问题的标准、稳健的多重网格策略。线松弛（例如，如果 $h_x \\ll h_y$ 则在 $x$ 方向）是一种有效的各向异性光滑器。半粗化（例如，如果 $h_x \\ll h_y$ 则在 $y$ 方向）是与之相应的合适的粗化策略。众所周知，这种组合产生的收敛因子既不依赖于网格尺寸也不依赖于各向异性比率。\n-   **结论：正确。**",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "局部傅里叶分析（Local Fourier Analysis, LFA）是多重网格理论中用于定量预测和设计算法性能的最强大的工具。通过分析多重网格循环的各个组件（光滑、限制和插值）如何作用于误差的不同频率分量，LFA能够精确地计算出方法的收敛因子。这项练习将带你深入LFA的计算细节，通过对一个完整的一维双网格循环进行分析，推导出其误差放大因子，从而让你亲身体验多重网格收敛理论的核心 。",
            "id": "3396909",
            "problem": "考虑单位区间上带周期性边界条件的泊松方程 $-u'' = f$ 的一维模型问题，该问题使用模板为 $\\{-1, 2, -1\\}/h^2$ 的标准二阶中心差分算子 $A_h$ 在步长为 $h$ 的均匀细网格上进行离散。设一个两网格法由以下部分定义：\n- 权重为 $\\omega = 2/3$ 的加权雅可比光滑，应用为一次前光滑和一次后光滑步骤。\n- 因子为 $2$ 的网格粗化。\n- 从细网格到粗网格的全加权限制。\n- 从粗网格到细网格的线性插值（分段线性延拓）。\n- 由 Galerkin 条件 $A_{2h} = R A_h P$ 定义的粗网格算子，并且粗网格问题被精确求解。\n\n使用局部傅里叶分析 (LFA) 来分析该两网格误差传播算子。在由频率角为 $\\theta$ 和 $\\theta+\\pi$ 的细网格傅里叶模式所张成的二维谐波子空间上进行分析，并考虑在粗网格上发生混叠的低频角集合，即 $\\Theta_{\\text{low}} = \\{\\theta \\in (-\\pi, \\pi] : |\\theta| \\le \\pi/2\\}$。从 $A_h$、加权雅可比光滑子、全加权限制和线性插值的傅里叶符号的定义出发，推导在该子空间上的两网格放大因子 $\\rho_{\\text{TG}}(\\theta)$。然后确定在 $\\Theta_{\\text{low}}$ 上的最坏情况两网格放大因子。\n\n将你的最终答案表示为一个精确的实数。无需四舍五入，放大因子没有单位。",
            "solution": "目标是使用局部傅里叶分析（LFA）为一个特定的一维问题找到最坏情况下的两网格放大因子。分析在由对应于频率（角）$\\theta$ 和 $\\theta' = \\theta+\\pi$ 的细网格傅里叶模式所张成的二维谐波子空间上进行。然后，放大因子在低频集合 $\\Theta_{\\text{low}} = \\{\\theta \\in (-\\pi, \\pi] : |\\theta| \\le \\pi/2\\}$ 上进行最大化。\n\n首先，我们确定两网格法每个组成部分的傅里叶符号。细网格上的离散傅里叶模式由 $\\phi(\\theta)_j = \\exp(i j \\theta)$ 给出，其中 $j$ 是网格点索引，$\\theta$ 是频率。\n\n1.  **细网格算子符号 $\\tilde{A}_h(\\theta)$**：\n    算子 $A_h$ 是 $-u''$ 的标准二阶中心差分离散，其模板为 $\\frac{1}{h^2}[-1, 2, -1]$。将 $A_h$ 应用于 $\\phi(\\theta)_j$：\n    $A_h \\phi(\\theta)_j = \\frac{1}{h^2}(-\\exp(i(j-1)\\theta) + 2\\exp(ij\\theta) - \\exp(i(j+1)\\theta))$\n    $= \\frac{\\exp(ij\\theta)}{h^2}(-e^{-i\\theta} + 2 - e^{i\\theta}) = \\frac{\\exp(ij\\theta)}{h^2}(2 - 2\\cos\\theta)$\n    $= \\frac{4}{h^2}\\sin^2(\\frac{\\theta}{2}) \\phi(\\theta)_j$.\n    符号（特征值）是 $\\tilde{A}_h(\\theta) = \\frac{4}{h^2}\\sin^2(\\frac{\\theta}{2})$。在 LFA 中，缩放因子 $1/h^2$ 可以被忽略，因为它会被约掉。我们使用 $\\tilde{A}_h(\\theta) = 4\\sin^2(\\frac{\\theta}{2}) = 2(1-\\cos\\theta)$。\n\n2.  **光滑子符号 $\\tilde{S}_h(\\theta)$**：\n    加权雅可比光滑的误差传播算子是 $S_h = I - \\omega D_h^{-1} A_h$。$A_h$ 的对角线部分是 $D_h = 2/h^2$。光滑子的符号是：\n    $\\tilde{S}_h(\\theta) = 1 - \\omega \\frac{\\tilde{A}_h(\\theta)}{2/h^2} = 1 - \\omega \\frac{4/h^2 \\sin^2(\\theta/2)}{2/h^2} = 1 - 2\\omega \\sin^2(\\frac{\\theta}{2})$。\n    对于给定的权重 $\\omega = 2/3$：\n    $\\tilde{S}_h(\\theta) = 1 - 2(\\frac{2}{3}) \\sin^2(\\frac{\\theta}{2}) = 1 - \\frac{4}{3} \\frac{1-\\cos\\theta}{2} = 1 - \\frac{2}{3}(1-\\cos\\theta) = \\frac{1}{3} + \\frac{2}{3}\\cos\\theta$。\n\n3.  **在二维子空间上的 LFA**：\n    我们在细网格模式基 $\\{\\phi(\\theta), \\phi(\\theta')\\}$（其中 $\\theta'=\\theta+\\pi$）下进行分析。在傅里叶基下对角的算子，在此子空间上成为 $2 \\times 2$ 的对角矩阵。令 $c = \\cos\\theta$。\n    $\\tilde{A}_h(\\theta) = 2(1-c)$.\n    $\\tilde{A}_h(\\theta') = 2(1-\\cos(\\theta+\\pi)) = 2(1+c)$.\n    $\\tilde{S}_h(\\theta) = \\frac{1+2c}{3}$.\n    $\\tilde{S}_h(\\theta') = \\frac{1+2\\cos(\\theta+\\pi)}{3} = \\frac{1-2c}{3}$.\n    矩阵符号为：\n    $$ \\tilde{A}_h(\\theta, \\theta') = \\begin{pmatrix} 2(1-c)  0 \\\\ 0  2(1+c) \\end{pmatrix}, \\quad \\tilde{S}_h(\\theta, \\theta') = \\begin{pmatrix} \\frac{1+2c}{3}  0 \\\\ 0  \\frac{1-2c}{3} \\end{pmatrix} $$\n\n4.  **限制和延拓符号**：\n    -   **全加权限制 ($R$)**：模板是 $\\frac{1}{4}[1, 2, 1]$。其符号是一个 $1 \\times 2$ 矩阵，将 $(\\phi(\\theta), \\phi(\\theta'))$ 映射到粗网格模式 $\\phi(2\\theta)$：\n        $\\tilde{R}(\\theta) = (\\cos^2(\\frac{\\theta}{2}), \\sin^2(\\frac{\\theta}{2})) = (\\frac{1+c}{2}, \\frac{1-c}{2})$.\n    -   **线性插值延拓 ($P$)**：这是全加权限制的共轭转置。其符号是一个 $2 \\times 1$ 矩阵，将 $\\phi(2\\theta)$ 映射到 $\\phi(\\theta)$ 和 $\\phi(\\theta')$ 的线性组合。对于一维中的这个标准配对，有 $\\tilde{P}(\\theta) = \\tilde{R}(\\theta)^T$。\n        $$ \\tilde{P}(\\theta) = \\begin{pmatrix} \\cos^2(\\frac{\\theta}{2}) \\\\ \\sin^2(\\frac{\\theta}{2}) \\end{pmatrix} = \\begin{pmatrix} \\frac{1+c}{2} \\\\ \\frac{1-c}{2} \\end{pmatrix} $$\n\n5.  **粗网格算子符号 $\\tilde{A}_{2h}(2\\theta)$**：\n    粗网格算子由 Galerkin 条件 $A_{2h} = R A_h P$ 定义。其符号是：\n    $$ \\tilde{A}_{2h}(2\\theta) = \\tilde{R}(\\theta) \\tilde{A}_h(\\theta, \\theta') \\tilde{P}(\\theta) $$\n    $$ \\tilde{A}_{2h}(2\\theta) = \\begin{pmatrix} \\frac{1+c}{2}  \\frac{1-c}{2} \\end{pmatrix} \\begin{pmatrix} 2(1-c)  0 \\\\ 0  2(1+c) \\end{pmatrix} \\begin{pmatrix} \\frac{1+c}{2} \\\\ \\frac{1-c}{2} \\end{pmatrix} $$\n    $$ = \\begin{pmatrix} (1+c)(1-c)  (1-c)(1+c) \\end{pmatrix} \\begin{pmatrix} \\frac{1+c}{2} \\\\ \\frac{1-c}{2} \\end{pmatrix} $$\n    $$ = (1-c^2)\\frac{1+c}{2} + (1-c^2)\\frac{1-c}{2} = (1-c^2) \\left(\\frac{1+c+1-c}{2}\\right) = 1-c^2 = \\sin^2\\theta $$\n\n6.  **两网格算子符号 $\\tilde{M}_{\\text{TG}}(\\theta)$**：\n    两网格循环的误差传播算子是 $M_{\\text{TG}} = S_h^{\\nu_2}(I - P A_{2h}^{-1} R A_h)S_h^{\\nu_1}$。\n    当 $\\nu_1=1, \\nu_2=1$ 时，其符号为 $\\tilde{M}_{\\text{TG}}(\\theta) = \\tilde{S}_h(\\theta, \\theta') \\left( I - \\tilde{P}(\\theta) \\tilde{A}_{2h}(2\\theta)^{-1} \\tilde{R}(\\theta) \\tilde{A}_h(\\theta, \\theta') \\right) \\tilde{S}_h(\\theta, \\theta')$。\n    我们来计算粗网格校正算子的符号 $C(\\theta) = I - \\tilde{P}(\\theta) \\tilde{A}_{2h}(2\\theta)^{-1} \\tilde{R}(\\theta) \\tilde{A}_h(\\theta, \\theta')$。\n    首先，计算类投影项 $K(\\theta)=\\tilde{P}(\\theta) \\tilde{A}_{2h}(2\\theta)^{-1} \\tilde{R}(\\theta) \\tilde{A}_h(\\theta, \\theta')$。\n    $$ \\tilde{P}\\tilde{A}_{2h}^{-1}\\tilde{R} = \\begin{pmatrix} \\frac{1+c}{2} \\\\ \\frac{1-c}{2} \\end{pmatrix} \\frac{1}{1-c^2} \\begin{pmatrix} \\frac{1+c}{2}  \\frac{1-c}{2} \\end{pmatrix} = \\frac{1}{4(1-c^2)} \\begin{pmatrix} (1+c)^2  1-c^2 \\\\ 1-c^2  (1-c)^2 \\end{pmatrix} $$\n    乘以 $\\tilde{A}_h(\\theta, \\theta')$：\n    $$ K(\\theta) = \\frac{1}{4(1-c^2)} \\begin{pmatrix} (1+c)^2  1-c^2 \\\\ 1-c^2  (1-c)^2 \\end{pmatrix} \\begin{pmatrix} 2(1-c)  0 \\\\ 0  2(1+c) \\end{pmatrix} $$\n    $$ = \\frac{1}{2(1-c^2)} \\begin{pmatrix} (1+c)^2(1-c)  (1-c^2)(1+c) \\\\ (1-c^2)(1-c)  (1-c)^2(1+c) \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1+c  1+c \\\\ 1-c  1-c \\end{pmatrix} $$\n    所以，$C(\\theta) = I - K(\\theta) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{1}{2}\\begin{pmatrix} 1+c  1+c \\\\ 1-c  1-c \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 1-c  -(1+c) \\\\ -(1-c)  1+c \\end{pmatrix}$。\n    现在我们组装 $\\tilde{M}_{\\text{TG}}(\\theta) = \\tilde{S}_h C \\tilde{S}_h$：\n    $$ \\tilde{M}_{\\text{TG}}(\\theta) = \\begin{pmatrix} \\frac{1+2c}{3}  0 \\\\ 0  \\frac{1-2c}{3} \\end{pmatrix} \\left( \\frac{1}{2}\\begin{pmatrix} 1-c  -(1+c) \\\\ -(1-c)  1+c \\end{pmatrix} \\right) \\begin{pmatrix} \\frac{1+2c}{3}  0 \\\\ 0  \\frac{1-2c}{3} \\end{pmatrix} $$\n    $$ = \\frac{1}{18} \\begin{pmatrix} (1+2c)(1-c)  -(1+2c)(1+c) \\\\ -(1-2c)(1-c)  (1-2c)(1+c) \\end{pmatrix} \\begin{pmatrix} 1+2c  0 \\\\ 0  1-2c \\end{pmatrix}  $$\n    $$ = \\frac{1}{18} \\begin{pmatrix} (1+2c)^2(1-c)  -(1+2c)(1-2c)(1+c) \\\\ -(1+2c)(1-2c)(1-c)  (1-2c)^2(1+c) \\end{pmatrix} $$\n\n7.  **两网格放大因子 $\\rho_{\\text{TG}}(\\theta)$**：\n    放大因子 $\\rho_{\\text{TG}}(\\theta)$ 是 $\\tilde{M}_{\\text{TG}}(\\theta)$ 的谱半径。一个 $2 \\times 2$ 矩阵 $M$ 的特征方程是 $\\lambda^2 - \\text{tr}(M)\\lambda + \\det(M) = 0$。\n    $\\tilde{M}_{\\text{TG}}(\\theta)$ 的行列式是：\n    $$ \\det(\\tilde{M}_{\\text{TG}}) = (\\det(\\tilde{S}_h))^2 \\det(C) $$\n    由于 $C = I-K$ 且 $K$ 是一个秩为1的投影算子 ($K^2=K$)，因此 $C$ 也是一个投影算子，其特征值为 $0$ 和 $1$。所以，$\\det(C) = 0$，这意味着 $\\det(\\tilde{M}_{\\text{TG}}) = 0$。\n    特征方程简化为 $\\lambda(\\lambda - \\text{tr}(\\tilde{M}_{\\text{TG}})) = 0$。特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\text{tr}(\\tilde{M}_{\\text{TG}})$。\n    谱半径是 $\\rho_{\\text{TG}}(\\theta) = |\\text{tr}(\\tilde{M}_{\\text{TG}}(\\theta))|$。\n    $$ \\text{tr}(\\tilde{M}_{\\text{TG}}) = \\frac{1}{18} \\left[ (1+2c)^2(1-c) + (1-2c)^2(1+c) \\right] $$\n    $$ (1+4c+4c^2)(1-c) = 1+4c+4c^2 - c - 4c^2 - 4c^3 = 1+3c-4c^3 $$\n    $$ (1-4c+4c^2)(1+c) = 1-4c+4c^2 + c - 4c^2 + 4c^3 = 1-3c+4c^3 $$\n    $$ \\text{tr}(\\tilde{M}_{\\text{TG}}) = \\frac{1}{18} \\left[ (1+3c-4c^3) + (1-3c+4c^3) \\right] = \\frac{1}{18} (2) = \\frac{1}{9} $$\n    因此，对于分析有效的所有 $\\theta \\in (-\\pi, \\pi]$，两网格放大因子是一个常数：\n    $$ \\rho_{\\text{TG}}(\\theta) = \\frac{1}{9} $$\n\n8.  **最坏情况放大因子**：\n    问题要求在低频集合 $\\Theta_{\\text{low}} = \\{\\theta \\in (-\\pi, \\pi] : |\\theta| \\le \\pi/2\\}$ 上的最坏情况（最大）放大因子。由于 $\\rho_{\\text{TG}}(\\theta)$ 在这整个范围内是常数，因此最大值就是这个常数。\n    $$ \\max_{\\theta \\in \\Theta_{\\text{low}}} \\rho_{\\text{TG}}(\\theta) = \\max_{|\\theta| \\le \\pi/2} \\frac{1}{9} = \\frac{1}{9} $$",
            "answer": "$$\\boxed{\\frac{1}{9}}$$"
        }
    ]
}