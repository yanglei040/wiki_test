{
    "hands_on_practices": [
        {
            "introduction": "在加速求解一个线性方程组之前，我们必须首先理解它的来源及其内在的精度。本练习将引导你对有限差分法进行一次基础分析，要求你通过泰勒展开推导五点拉普拉斯模板的截断误差 。这项实践将帮助你定量地确定离散格式的相容阶，它不仅揭示了近似的准确性，也设定了全多重网格算法旨在以最优计算成本达到的精度基准。",
            "id": "3396892",
            "problem": "考虑单位正方形 $\\Omega = (0,1)^{2}$ 上的泊松偏微分方程 (PDE) $-\\Delta u = f$，其在边界 $\\partial \\Omega$ 上具有狄利克雷 (Dirichlet) 边界数据 $u = g$，其中 $u \\in C^{6}(\\overline{\\Omega})$。设 $\\{ \\mathcal{T}_{h} \\}$ 为一族嵌套的均匀笛卡尔 (Cartesian) 网格，其在两个坐标方向上的网格尺寸均为 $h$，并假设采用全多重网格 (Full Multigrid, FMG) 和嵌套迭代 (Nested Iteration, NI) 方法在最细的网格上计算近似解 $u_{h}$。在每个网格 $\\mathcal{T}_{h}$ 上，内部点 $(x_{i}, y_{j})$ 处的离散拉普拉斯算子由标准的 5 点模板定义：\n$$\n(L_{h} u)_{i,j} := \\frac{u(x_{i}+h, y_{j}) - 2 u(x_{i}, y_{j}) + u(x_{i}-h, y_{j})}{h^{2}} + \\frac{u(x_{i}, y_{j}+h) - 2 u(x_{i}, y_{j}) + u(x_{i}, y_{j}-h)}{h^{2}}.\n$$\n从基本定义和成熟的公式（具体来说，是光滑函数的多元泰勒级数和中心差分相容性论证）出发，推导在一个一般的内部点 $(x_{i}, y_{j})$ 处 $L_{h}$ 的截断误差，用在点 $(x_{i}, y_{j})$ 处求值的 $u$ 的空间导数来表示，并确定阶数 $p$ 使得相容性误差 $\\| L_{h} u - \\Delta u \\|_{\\infty} = \\mathcal{O}(h^{p})$ 在 $h \\to 0$ 时成立。你的推导应清楚地表明领先误差项是如何产生的，以及其大小如何为 FMG 和 NI 在不同层级间传递和优化近似解时所针对的精度尺度提供信息。\n\n将你的最终答案报告为两个量：在 $(x_{i}, y_{j})$ 处的领先阶截断误差和阶数 $p$。无需进行数值四舍五入，也不涉及物理单位。将最终答案表示为单行矩阵，使用 LaTeX 的 $\\pmatrix$ 环境，其中第一个元素等于领先阶截断误差，第二个元素等于 $p$。",
            "solution": "该问题已经过验证，被认为是有效的，因为它具有科学依据、是适定的、客观的，并且符合数值分析中可解问题的所有标准。\n\n目标是推导拉普拉斯算子的标准 5 点中心差分近似的局部截断误差，并确定其相容性阶。将离散拉普拉斯算子 $L_{h}$ 应用于连续问题在内部网格点 $(x_{i}, y_{j})$ 的精确解 $u$。在该点的截断误差 $\\tau_{h}$ 定义为将精确解代入离散算子，再减去作用于该解的精确微分算子所得到的残差：\n$$\n\\tau_{h}(x_i, y_j) = (L_{h} u)(x_i, y_j) - (\\Delta u)(x_i, y_j)\n$$\n算子 $L_h$ 由下式给出：\n$$\n(L_{h} u)_{i,j} = \\frac{u(x_{i}+h, y_{j}) - 2 u(x_{i}, y_{j}) + u(x_{i}-h, y_{j})}{h^{2}} + \\frac{u(x_{i}, y_{j}+h) - 2 u(x_{i}, y_{j}) + u(x_{i}, y_{j}-h)}{h^{2}}\n$$\n让我们分别分析右侧的两项。为清晰起见，我们将省略下标 $(i,j)$ 并用 $(x,y)$ 表示点 $(x_i, y_j)$，并用下标表示偏导数，例如，$u_x = \\frac{\\partial u}{\\partial x}$，$u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$。\n\n问题陈述了解 $u$ 属于 $C^{6}(\\overline{\\Omega})$ 类。这种光滑性足以支持将 $u$ 在点 $(x, y)$ 周围进行泰勒级数展开。\n\n首先，考虑 $x$ 方向的各项。$u(x+h, y)$ 和 $u(x-h, y)$ 在 $(x,y)$ 处的泰勒展开为：\n$$\nu(x+h, y) = u(x,y) + h u_{x}(x,y) + \\frac{h^{2}}{2!} u_{xx}(x,y) + \\frac{h^{3}}{3!} u_{xxx}(x,y) + \\frac{h^{4}}{4!} u_{xxxx}(x,y) + \\frac{h^{5}}{5!} u_{xxxxx}(x,y) + \\mathcal{O}(h^{6})\n$$\n$$\nu(x-h, y) = u(x,y) - h u_{x}(x,y) + \\frac{h^{2}}{2!} u_{xx}(x,y) - \\frac{h^{3}}{3!} u_{xxx}(x,y) + \\frac{h^{4}}{4!} u_{xxxx}(x,y) - \\frac{h^{5}}{5!} u_{xxxxx}(x,y) + \\mathcal{O}(h^{6})\n$$\n$C^6$ 正则性确保了余项的阶为 $\\mathcal{O}(h^6)$。将这两个展开式相加，我们观察到 $h$ 的所有奇次幂项都消掉了：\n$$\nu(x+h, y) + u(x-h, y) = 2 u(x,y) + h^{2} u_{xx}(x,y) + \\frac{2h^{4}}{24} u_{xxxx}(x,y) + \\mathcal{O}(h^{6})\n$$\n重新整理这个和式，得到二阶导数的中心差分形式：\n$$\n\\frac{u(x+h, y) - 2u(x,y) + u(x-h, y)}{h^{2}} = u_{xx}(x,y) + \\frac{h^{2}}{12} u_{xxxx}(x,y) + \\mathcal{O}(h^{4})\n$$\n对 $y$ 方向进行完全相同的论证，我们得到：\n$$\n\\frac{u(x, y+h) - 2u(x,y) + u(x, y-h)}{h^{2}} = u_{yy}(x,y) + \\frac{h^{2}}{12} u_{yyyy}(x,y) + \\mathcal{O}(h^{4})\n$$\n现在，我们将这两个表达式相加，来构建离散算子 $L_{h}$ 对 $u$ 的作用：\n$$\n(L_{h} u)(x,y) = \\left( u_{xx}(x,y) + \\frac{h^{2}}{12} u_{xxxx}(x,y) \\right) + \\left( u_{yy}(x,y) + \\frac{h^{2}}{12} u_{yyyy}(x,y) \\right) + \\mathcal{O}(h^{4})\n$$\n合并同类项，我们得到：\n$$\n(L_{h} u)(x,y) = \\left( u_{xx}(x,y) + u_{yy}(x,y) \\right) + \\frac{h^{2}}{12} \\left( u_{xxxx}(x,y) + u_{yyyy}(x,y) \\right) + \\mathcal{O}(h^{4})\n$$\n括号中的第一项正是 $u$ 的拉普拉斯算子，$\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$。因此，我们可以写出：\n$$\n(L_{h} u)(x,y) = (\\Delta u)(x,y) + \\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}}(x,y) + \\frac{\\partial^{4} u}{\\partial y^{4}}(x,y) \\right) + \\mathcal{O}(h^{4})\n$$\n截断误差 $\\tau_{h}$ 是差值 $(L_{h} u) - (\\Delta u)$：\n$$\n\\tau_{h}(x,y) = \\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}}(x,y) + \\frac{\\partial^{4} u}{\\partial y^{4}}(x,y) \\right) + \\mathcal{O}(h^{4})\n$$\n截断误差的领先阶项是 $h$ 的最低次幂项，即：\n$$\n\\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}} + \\frac{\\partial^{4} u}{\\partial y^{4}} \\right)\n$$\n问题要求解相容性误差的阶数 $p$，其定义为 $\\|L_h u - \\Delta u\\|_{\\infty} = \\mathcal{O}(h^p)$。这是在所有内部网格点上的局部截断误差的绝对值的最大值。由于 $u \\in C^{6}(\\overline{\\Omega})$，四阶偏导数在紧集上是连续的，因此是有界的。设 $M$ 为一个常数，使得 $\\sup_{(x,y) \\in \\Omega} \\left| \\frac{1}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}} + \\frac{\\partial^{4} u}{\\partial y^{4}} \\right) \\right| \\leq M  \\infty$。那么：\n$$\n\\|L_h u - \\Delta u\\|_{\\infty} = \\sup_{i,j} |\\tau_h(x_i, y_j)| \\leq M h^{2} + \\mathcal{O}(h^{4})\n$$\n这表明相容性误差的阶为 $\\mathcal{O}(h^{2})$。因此，阶数 $p$ 为 $2$。\n\n这个领先误差项的大小，特别是其按 $\\mathcal{O}(h^{2})$ 缩放的特性，对于全多重网格 (FMG) 和嵌套迭代 (NI) 的设计和效率至关重要。FMG 的目标是计算一个离散解 $u_h$，使其在网格尺寸为 $h_k$ 的最细网格上的误差 $\\|u - u_h\\|_{\\infty}$ 与截断误差同阶，在本例中为 $\\mathcal{O}(h^2_k)$。NI 过程从最粗的网格开始并获得一个解。然后将该解插值到下一层更细的网格上，作为初始猜测值。对于一个二阶格式 ($p=2$)，对粗网格解进行足够精确的插值（例如，双线性插值）可以在细网格上提供一个误差已经达到 $\\mathcal{O}(h^2)$ 的初始猜测值。然后，少量、固定次数的多重网格循环（例如，一个 V 型循环）就足以将代数误差的高频分量减少到低于离散化误差的水平。结果是一个精度为 $\\mathcal{O}(h^2)$ 的解 $u_h$，其计算成本与最细网格上的未知数数量成线性关系，这是渐近最优的。领先误差项 $\\frac{h^2}{12}(\\dots)$ 的大小为多重网格层次结构的每一层上的代数求解器的期望精度设定了尺度。\n\n所要求的两个量是领先阶截断误差和阶数 $p$。\n1. 在 $(x_{i},y_{j})$ 处的领先阶截断误差：$\\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}} + \\frac{\\partial^{4} u}{\\partial y^{4}} \\right)$\n2. 阶数 $p$：$2$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{h^{2}}{12} \\left( \\frac{\\partial^{4} u}{\\partial x^{4}} + \\frac{\\partial^{4} u}{\\partial y^{4}} \\right)  2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "多重网格方法的卓越效率并非魔法；它可以通过局部傅里叶分析（Local Fourier Analysis, LFA）进行严格的预测和分析。这项挑战性的练习要求你将 LFA 应用于一个典型的双网格循环，计算平滑算子、网格间传递算子和粗网格算子的傅里叶符号 。通过组装这些组件，你将推导出双网格放大因子，从而为算法的收敛速度提供一个精确的定量评估，深刻理解其快速收敛的根源。",
            "id": "3396909",
            "problem": "考虑泊松方程 $-u'' = f$ 在单位区间上的一个一维模型问题，该问题具有周期性边界条件，并在一个步长为 $h$ 的均匀细网格上使用标准二阶中心差分算子 $A_h$（其模板为 $\\{-1, 2, -1\\}/h^2$）进行离散。设一个两网格方法由以下部分定义：\n- 加权雅可比光滑，权重为 $\\omega = 2/3$，施加一次前光滑和一次后光滑步骤。\n- 网格粗化因子为 $2$。\n- 从细网格到粗网格的全加权限制。\n- 从粗网格到细网格的线性插值（分段线性延拓）。\n- 粗网格算子由 Galerkin 条件 $A_{2h} = R A_h P$ 定义，并且粗网格问题被精确求解。\n\n使用局部傅里叶分析 (LFA) 来分析该两网格误差传播算子。在由细网格傅里叶模（角度为 $\\theta$ 和 $\\theta+\\pi$）张成的二维谐波子空间上进行分析，并考虑在粗网格上发生混叠的低频角集合，即 $\\Theta_{\\text{low}} = \\{\\theta \\in (-\\pi, \\pi] : |\\theta| \\le \\pi/2\\}$。从 $A_h$、加权雅可比光滑子、全加权限制和线性插值的傅里叶符号的定义出发，推导在此子空间上的两网格放大因子 $\\rho_{\\text{TG}}(\\theta)$。然后确定在 $\\Theta_{\\text{low}}$ 上的最坏情况两网格放大因子。\n\n将您的最终答案表示为一个精确的实数。无需四舍五入，放大因子没有单位。",
            "solution": "本题要求使用局部傅里叶分析 (LFA) 为一个特定的一维问题找到最坏情况下的两网格放大因子。分析在由细网格傅里叶模（对应于频率（角）$\\theta$ 和 $\\theta' = \\theta+\\pi$）张成的二维谐波子空间上进行。然后，在低频集合 $\\Theta_{\\text{low}} = \\{\\theta \\in (-\\pi, \\pi] : |\\theta| \\le \\pi/2\\}$ 上对放大因子进行最大化。\n\n首先，我们确定两网格方法各组成部分的傅里叶符号。细网格上的离散傅里叶模由 $\\phi(\\theta)_j = \\exp(i j \\theta)$ 给出，其中 $j$ 是网格点索引，$\\theta$ 是频率。\n\n1.  **细网格算子符号 $\\tilde{A}_h(\\theta)$**：\n    算子 $A_h$ 是 $-u''$ 的标准二阶中心差分离散化，其模板为 $\\frac{1}{h^2}[-1, 2, -1]$。将 $A_h$ 应用于 $\\phi(\\theta)_j$：\n    $A_h \\phi(\\theta)_j = \\frac{1}{h^2}(-\\exp(i(j-1)\\theta) + 2\\exp(ij\\theta) - \\exp(i(j+1)\\theta))$\n    $= \\frac{\\exp(ij\\theta)}{h^2}(-e^{-i\\theta} + 2 - e^{i\\theta}) = \\frac{\\exp(ij\\theta)}{h^2}(2 - 2\\cos\\theta)$\n    $= \\frac{4}{h^2}\\sin^2(\\frac{\\theta}{2}) \\phi(\\theta)_j$。\n    符号（特征值）是 $\\tilde{A}_h(\\theta) = \\frac{4}{h^2}\\sin^2(\\frac{\\theta}{2})$。在 LFA 中，缩放因子 $1/h^2$ 可以忽略，因为它会消掉。我们使用 $\\tilde{A}_h(\\theta) = 4\\sin^2(\\frac{\\theta}{2}) = 2(1-\\cos\\theta)$。\n\n2.  **光滑子符号 $\\tilde{S}_h(\\theta)$**：\n    加权雅可比光滑的误差传播算子是 $S_h = I - \\omega D_h^{-1} A_h$。$A_h$ 的对角部分是 $2/h^2$。光滑子的符号为：\n    $\\tilde{S}_h(\\theta) = 1 - \\omega \\frac{\\tilde{A}_h(\\theta)}{2/h^2} = 1 - \\omega \\frac{4/h^2 \\sin^2(\\theta/2)}{2/h^2} = 1 - 2\\omega \\sin^2(\\frac{\\theta}{2})$。\n    使用给定的权重 $\\omega = 2/3$：\n    $\\tilde{S}_h(\\theta) = 1 - 2(\\frac{2}{3}) \\sin^2(\\frac{\\theta}{2}) = 1 - \\frac{4}{3} \\frac{1-\\cos\\theta}{2} = 1 - \\frac{2}{3}(1-\\cos\\theta) = \\frac{1}{3} + \\frac{2}{3}\\cos\\theta$。\n\n3.  **在二维子空间上的 LFA**：\n    我们在细网格模 $\\{\\phi(\\theta), \\phi(\\theta')\\}$（其中 $\\theta'=\\theta+\\pi$）的基中进行计算。在傅里叶基中是对角算子的算子，在此子空间上变为 $2 \\times 2$ 的对角矩阵。令 $c = \\cos\\theta$。\n    $\\tilde{A}_h(\\theta) = 2(1-c)$。\n    $\\tilde{A}_h(\\theta') = 2(1-\\cos(\\theta+\\pi)) = 2(1+c)$。\n    $\\tilde{S}_h(\\theta) = \\frac{1+2c}{3}$。\n    $\\tilde{S}_h(\\theta') = \\frac{1+2\\cos(\\theta+\\pi)}{3} = \\frac{1-2c}{3}$。\n    矩阵符号为：\n    $$ \\tilde{A}_h(\\theta, \\theta') = \\begin{pmatrix} 2(1-c)  0 \\\\ 0  2(1+c) \\end{pmatrix}, \\quad \\tilde{S}_h(\\theta, \\theta') = \\begin{pmatrix} \\frac{1+2c}{3}  0 \\\\ 0  \\frac{1-2c}{3} \\end{pmatrix} $$\n\n4.  **限制和延拓符号**：\n    -   **全加权限制 ($R$)**：模板为 $\\frac{1}{4}[1, 2, 1]$。其符号是一个 $1 \\times 2$ 矩阵，将 $(\\phi(\\theta), \\phi(\\theta'))$ 映射到粗网格模 $\\phi(2\\theta)$：\n        $\\tilde{R}(\\theta) = (\\cos^2(\\frac{\\theta}{2}), \\sin^2(\\frac{\\theta}{2})) = (\\frac{1+c}{2}, \\frac{1-c}{2})$。\n    -   **线性插值延拓 ($P$)**：这是全加权限制的共轭转置。其符号是一个 $2 \\times 1$ 矩阵，将 $\\phi(2\\theta)$ 映射到 $\\phi(\\theta)$ 和 $\\phi(\\theta')$ 的线性组合。对于一维中的这个标准对，$\\tilde{P}(\\theta) = \\tilde{R}(\\theta)^T$。\n        $$ \\tilde{P}(\\theta) = \\begin{pmatrix} \\cos^2(\\frac{\\theta}{2}) \\\\ \\sin^2(\\frac{\\theta}{2}) \\end{pmatrix} = \\begin{pmatrix} \\frac{1+c}{2} \\\\ \\frac{1-c}{2} \\end{pmatrix} $$\n\n5.  **粗网格算子符号 $\\tilde{A}_{2h}(2\\theta)$**：\n    粗网格算子由 Galerkin 条件 $A_{2h} = R A_h P$ 定义。其符号为：\n    $$ \\tilde{A}_{2h}(2\\theta) = \\tilde{R}(\\theta) \\tilde{A}_h(\\theta, \\theta') \\tilde{P}(\\theta) $$\n    $$ \\tilde{A}_{2h}(2\\theta) = \\begin{pmatrix} \\frac{1+c}{2}  \\frac{1-c}{2} \\end{pmatrix} \\begin{pmatrix} 2(1-c)  0 \\\\ 0  2(1+c) \\end{pmatrix} \\begin{pmatrix} \\frac{1+c}{2} \\\\ \\frac{1-c}{2} \\end{pmatrix} $$\n    $$ = \\begin{pmatrix} (1+c)(1-c)  (1-c)(1+c) \\end{pmatrix} \\begin{pmatrix} \\frac{1+c}{2} \\\\ \\frac{1-c}{2} \\end{pmatrix} $$\n    $$ = (1-c^2)\\frac{1+c}{2} + (1-c^2)\\frac{1-c}{2} = (1-c^2) \\left(\\frac{1+c+1-c}{2}\\right) = 1-c^2 = \\sin^2\\theta $$\n\n6.  **两网格算子符号 $\\tilde{M}_{\\text{TG}}(\\theta)$**：\n    两网格循环的误差传播算子是 $M_{\\text{TG}} = S_h^{\\nu_2}(I - P A_{2h}^{-1} R A_h)S_h^{\\nu_1}$。\n    当 $\\nu_1=1, \\nu_2=1$ 时，符号为 $\\tilde{M}_{\\text{TG}}(\\theta) = \\tilde{S}_h(\\theta, \\theta') \\left( I - \\tilde{P}(\\theta) \\tilde{A}_{2h}(2\\theta)^{-1} \\tilde{R}(\\theta) \\tilde{A}_h(\\theta, \\theta') \\right) \\tilde{S}_h(\\theta, \\theta')$.\n    我们来计算粗网格校正算子符号 $C(\\theta) = I - \\tilde{P}(\\theta) \\tilde{A}_{2h}(2\\theta)^{-1} \\tilde{R}(\\theta) \\tilde{A}_h(\\theta, \\theta')$。\n    首先，计算类投影项 $K(\\theta)=\\tilde{P}(\\theta) \\tilde{A}_{2h}(2\\theta)^{-1} \\tilde{R}(\\theta) \\tilde{A}_h(\\theta, \\theta')$。\n    $$ \\tilde{P}\\tilde{A}_{2h}^{-1}\\tilde{R} = \\begin{pmatrix} \\frac{1+c}{2} \\\\ \\frac{1-c}{2} \\end{pmatrix} \\frac{1}{1-c^2} \\begin{pmatrix} \\frac{1+c}{2}  \\frac{1-c}{2} \\end{pmatrix} = \\frac{1}{4(1-c^2)} \\begin{pmatrix} (1+c)^2  1-c^2 \\\\ 1-c^2  (1-c)^2 \\end{pmatrix} $$\n    乘以 $\\tilde{A}_h(\\theta, \\theta')$：\n    $$ K(\\theta) = \\frac{1}{4(1-c^2)} \\begin{pmatrix} (1+c)^2  1-c^2 \\\\ 1-c^2  (1-c)^2 \\end{pmatrix} \\begin{pmatrix} 2(1-c)  0 \\\\ 0  2(1+c) \\end{pmatrix} $$\n    $$ = \\frac{1}{2(1-c^2)} \\begin{pmatrix} (1+c)^2(1-c)  (1-c^2)(1+c) \\\\ (1-c^2)(1-c)  (1-c)^2(1+c) \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1+c  1+c \\\\ 1-c  1-c \\end{pmatrix} $$\n    所以，$C(\\theta) = I - K(\\theta) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{1}{2}\\begin{pmatrix} 1+c  1+c \\\\ 1-c  1-c \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 1-c  -(1+c) \\\\ -(1-c)  1+c \\end{pmatrix}$。\n    现在我们组装 $\\tilde{M}_{\\text{TG}}(\\theta) = \\tilde{S}_h C \\tilde{S}_h$：\n    $$ \\tilde{M}_{\\text{TG}}(\\theta) = \\begin{pmatrix} \\frac{1+2c}{3}  0 \\\\ 0  \\frac{1-2c}{3} \\end{pmatrix} \\left( \\frac{1}{2}\\begin{pmatrix} 1-c  -(1+c) \\\\ -(1-c)  1+c \\end{pmatrix} \\right) \\begin{pmatrix} \\frac{1+2c}{3}  0 \\\\ 0  \\frac{1-2c}{3} \\end{pmatrix} $$\n    $$ = \\frac{1}{18} \\begin{pmatrix} (1+2c)(1-c)  -(1+2c)(1+c) \\\\ -(1-2c)(1-c)  (1-2c)(1+c) \\end{pmatrix} \\begin{pmatrix} 1+2c  0 \\\\ 0  1-2c \\end{pmatrix}  $$\n    $$ = \\frac{1}{18} \\begin{pmatrix} (1+2c)^2(1-c)  -(1+2c)(1-2c)(1+c) \\\\ -(1+2c)(1-2c)(1-c)  (1-2c)^2(1+c) \\end{pmatrix} $$\n\n7.  **两网格放大因子 $\\rho_{\\text{TG}}(\\theta)$**：\n    放大因子 $\\rho_{\\text{TG}}(\\theta)$ 是 $\\tilde{M}_{\\text{TG}}(\\theta)$ 的谱半径。对于一个 $2 \\times 2$ 矩阵 $M$，其特征方程为 $\\lambda^2 - \\text{tr}(M)\\lambda + \\det(M) = 0$。\n    $\\tilde{M}_{\\text{TG}}(\\theta)$ 的行列式为：\n    $$ \\det(\\tilde{M}_{\\text{TG}}) = (\\det(\\tilde{S}_h))^2 \\det(C) $$\n    由于 $C = I-K$ 且 $K$ 是一个秩为1的投影算子 ($K^2=K$)，因此 $C$ 也是一个投影算子，其特征值为 $0$ 和 $1$。从而 $\\det(C) = 0$，这意味着 $\\det(\\tilde{M}_{\\text{TG}}) = 0$。\n    特征方程简化为 $\\lambda(\\lambda - \\text{tr}(\\tilde{M}_{\\text{TG}})) = 0$。特征值为 $\\lambda_1 = 0$ 和 $\\lambda_2 = \\text{tr}(\\tilde{M}_{\\text{TG}})$。\n    谱半径是 $\\rho_{\\text{TG}}(\\theta) = |\\text{tr}(\\tilde{M}_{\\text{TG}}(\\theta))|$。\n    $$ \\text{tr}(\\tilde{M}_{\\text{TG}}) = \\frac{1}{18} \\left[ (1+2c)^2(1-c) + (1-2c)^2(1+c) \\right] $$\n    $$ (1+4c+4c^2)(1-c) = 1+4c+4c^2 - c - 4c^2 - 4c^3 = 1+3c-4c^3 $$\n    $$ (1-4c+4c^2)(1+c) = 1-4c+4c^2 + c - 4c^2 + 4c^3 = 1-3c+4c^3 $$\n    $$ \\text{tr}(\\tilde{M}_{\\text{TG}}) = \\frac{1}{18} \\left[ (1+3c-4c^3) + (1-3c+4c^3) \\right] = \\frac{1}{18} (2) = \\frac{1}{9} $$\n    因此，对于所有分析有效的 $\\theta \\in (-\\pi, \\pi]$，两网格放大因子是常数：\n    $$ \\rho_{\\text{TG}}(\\theta) = \\frac{1}{9} $$\n\n8.  **最坏情况放大因子**：\n    问题要求在低频集合 $\\Theta_{\\text{low}} = \\{\\theta \\in (-\\pi, \\pi] : |\\theta| \\le \\pi/2\\}$ 上的最坏情况（最大）放大因子。由于 $\\rho_{\\text{TG}}(\\theta)$ 在整个范围内是常数，其最大值就是这个常数。\n    $$ \\max_{\\theta \\in \\Theta_{\\text{low}}} \\rho_{\\text{TG}}(\\theta) = \\max_{|\\theta| \\le \\pi/2} \\frac{1}{9} = \\frac{1}{9} $$",
            "answer": "$$\\boxed{\\frac{1}{9}}$$"
        },
        {
            "introduction": "理论分析提供了深刻的见解，但实际的算法设计则需要在各种约束下进行性能优化。这个最终的实践练习将从理论推导转向实际计算，要求你编写一个程序来优化完整多重网格（FMG）循环的关键参数——V循环的深度和平滑步骤的次数 。通过使用成熟的误差缩减和计算成本模型，你将亲身体验如何在精度和效率之间做出权衡，这是设计所有高性能数值求解器时都必须面对的核心挑战。",
            "id": "3396932",
            "problem": "考虑求解在单位正方形上带有齐次狄利克雷边界条件的泊松方程 $-\\Delta u = f$ 的标准二阶中心有限差分离散化所产生的线性系统。得到的刚度矩阵 $A$ 是对称正定 (SPD) 的，我们用能量范数 $\\|e\\|_{A} = \\sqrt{e^{\\top} A e}$ 来衡量代数误差。采用带有嵌套迭代的完全多重网格 (FMG) 算法，在一个周期内生成细网格解，其中对于给定的整数 $n \\ge 3$，细网格间距为 $h = 1/(n-1)$。\n\n您需要在固定的时间预算和目标误差容限的约束下，优化FMG中的V-cycle深度和平滑器强度。V-cycle深度 $k$ 是每个V-cycle遍历的不同网格层级的数量，每层通过因子2进行均匀粗化。平滑器是加权雅可比方法，其松弛参数选择在泊松算子的最优值附近，并在每个访问的层级上应用 $\\nu_1$ 次作为前平滑，$\\nu_2$ 次作为后平滑。\n\n对于二维几何多重网格求解泊松方程，我们作出以下广泛使用且经过充分测试的建模假设：\n\n- 细网格上的离散化（相容性）误差界：存在一个与格式相关的常数 $D  0$，使得离散化误差的能量范数满足 $\\|e_{\\mathrm{disc}}\\|_{A} \\le D\\, h^{p}$，其中 $p \\ge 1$ 为给定的整数阶数。\n- 每次平滑迭代在能量范数下的收缩由一个标量 $\\sigma \\in (0,1)$ 界定，因此对于任意向量 $v$，有 $\\|S v\\|_{A} \\le \\sigma \\|v\\|_{A}$，其中 $S$ 是加权雅可比平滑器。为具体起见，取 $\\sigma = 0.6$。\n- 在 $k$ 个层级上的粗网格校正将低频误差收缩一个因子，该因子由 $\\theta^{k}$ 界定，其中某个 $\\theta \\in (0,1)$。为具体起见，取 $\\theta = 0.25$。\n- 嵌套迭代的初始化确保了細网格上的初始代数误差不大于细网格的离散化误差尺度，即 $\\|e_{\\mathrm{init}}\\|_{A} \\le D\\, h^{p}$。\n\n在这些假设下，一个具有深度为 $k$ 的单个V-cycle和 $(\\nu_1,\\nu_2)$ 次平滑扫描的FMG周期产生的能量范数误差有界，其界为\n$$\n\\|e\\|_{A} \\le D\\, h^{p} \\left(1 + \\sigma^{\\nu_1+\\nu_2}\\, \\theta^{k}\\right).\n$$\n\n工作量（时间）基于每层成本，以无量纲的工作单位进行建模。设细网格上的未知数数量为 $N = n^{2}$。一个深度为 $k$ 且平滑次数为 $(\\nu_1,\\nu_2)$ 的V-cycle的工作量模型为\n$$\nT(k,\\nu_1,\\nu_2;n) = \\left( a_s (\\nu_1+\\nu_2) + a_m \\right)\\; \\sum_{\\ell=0}^{k-1} \\frac{N}{4^{\\ell}},\n$$\n其中 $a_s  0$ 表示每个未知量每次平滑扫描的工作量，$a_m  0$ 表示每层残差计算和传输操作（限制和延拓）的工作量。为具体起见，取 $a_s = 3$ 和 $a_m = 2$。\n\n给定一个目标容差常数 $C  0$ 和一个固定的时间预算 $T_{\\max}  0$。每个测试用例的优化问题是：\n\n寻找整数 $k$、$\\nu_1$ 和 $\\nu_2$ 以最小化 $T(k,\\nu_1,\\nu_2;n)$，约束条件为\n$$\n\\|e\\|_{A} \\le C\\, h^{p}\n\\quad\\text{and}\\quad\nT(k,\\nu_1,\\nu_2;n) \\le T_{\\max},\n$$\n搜索范围为 $k \\in \\{1,2,3,4\\}$ 和 $\\nu_1,\\nu_2 \\in \\{1,2,3,4,5\\}$。如果多个配置达到相同的最小工作量，则按最小的 $k$、然后最小的 $\\nu_1$、最后最小的 $\\nu_2$ 来打破平局。\n\n如果没有配置能同时满足这两个约束条件，则报告该测试用例失败。\n\n使用具体的常数 $D = 0.5$、$\\sigma = 0.6$、$\\theta = 0.25$、$a_s = 3$、$a_m = 2$。\n\n测试套件：\n- 案例 1：$(n, p, C, T_{\\max}) = (129, 2, 0.8, 160000)$。\n- 案例 2：$(n, p, C, T_{\\max}) = (129, 2, 0.53, 160000)$。\n- 案例 3：$(n, p, C, T_{\\max}) = (129, 2, 0.55, 160000)$。\n- 案例 4：$(n, p, C, T_{\\max}) = (257, 2, 0.53, 900000)$。\n- 案例 5：$(n, p, C, T_{\\max}) = (129, 2, 0.53, 300000)$。\n\n对于每个测试用例，您的程序必须输出所选配置及其预测性能，形式为列表 $[k,\\nu_1,\\nu_2,E,T]$，其中 $E$ 是预测的能量范数误差界，$T$ 是预测的工作量。如果不存在可行的配置，则输出失败签名 $[-1,-1,-1,-1.0,-1.0]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按上述用例顺序排列的结果，格式为逗号分隔的列表并用方括号括起。例如，如果有三个用例，输出将类似于 $[[k_1,\\nu_{1,1},\\nu_{2,1},E_1,T_1],[k_2,\\nu_{1,2},\\nu_{2,2},E_2,T_2],[k_3,\\nu_{1,3},\\nu_{2,3},E_3,T_3]]$。",
            "solution": "用户提供了一个定义明確的约束优化问题，该问题与完全多重网格（FMG）算法的参数调整有关。我将首先通过重述目标函数和约束来形式化该问题，然后描述为每个给定的测试用例寻找最优参数集 $(k, \\nu_1, \\nu_2)$ 的方法。\n\n**1. 问题形式化**\n\n给定的量和模型参数如下：\n- 离散化误差常数： $D = 0.5$\n- 平滑器收缩因子： $\\sigma = 0.6$\n- 粗网格校正因子基数： $\\theta = 0.25$\n- 工作量模型常数： $a_s = 3$, $a_m = 2$\n- 细网格间距： $h = 1/(n-1)$\n- 未知数数量： $N = n^2$\n\n优化变量的搜索空间为：\n- V-cycle深度： $k \\in \\{1, 2, 3, 4\\}$\n- 前平滑扫描次数： $\\nu_1 \\in \\{1, 2, 3, 4, 5\\}$\n- 后平滑扫描次数： $\\nu_2 \\in \\{1, 2, 3, 4, 5\\}$\n\n对于给定的配置 $(k, \\nu_1, \\nu_2)$ 和由 $(n, p, C, T_{\\max})$ 定义的测试用例，我们必须评估其可行性和性能。\n\n**误差模型与约束：**\n问题提出了一个FMG周期后误差能量范数 $\\|e\\|_{A}$ 的模型。根据模型的结构和所提供的上下文，此误差被解释为总误差，即离散化误差和最终代数误差之和。其界限由下式给出：\n$$\nE(k, \\nu_1, \\nu_2; n, p) = D h^p \\left(1 + \\sigma^{\\nu_1+\\nu_2} \\theta^k\\right)\n$$\n第一个约束要求该误差不大于目标容限，该容限按离散化误差进行缩放：\n$$\nE(k, \\nu_1, \\nu_2; n, p) \\le C h^p\n$$\n代入 $E$ 的表达式并通过除以正项 $h^p$ 进行简化，得到一个与 $h$ 无关的约束：\n$$\nD \\left(1 + \\sigma^{\\nu_1+\\nu_2} \\theta^k\\right) \\le C\n$$\n\n**工作量模型与约束：**\n计算工作量（时间）被建模为平滑步数和网格层级数的函数。深度为 $k$ 的V-cycle的工作量与所有访问过的网格上的未知数总和成正比：\n$$\nT(k, \\nu_1, \\nu_2; n) = \\left( a_s (\\nu_1+\\nu_2) + a_m \\right) N \\sum_{\\ell=0}^{k-1} \\frac{1}{4^{\\ell}}\n$$\n该几何级数可以以闭合形式计算： $\\sum_{\\ell=0}^{k-1} (1/4)^{\\ell} = \\frac{1 - (1/4)^k}{1 - 1/4} = \\frac{4}{3}(1 - 4^{-k})$。\n第二个约束是对该计算工作量的硬性限制：\n$$\nT(k, \\nu_1, \\nu_2; n) \\le T_{\\max}\n$$\n\n**优化问题：**\n对于每个测试用例，我们必须求解：\n$$\n\\min_{k, \\nu_1, \\nu_2} T(k, \\nu_1, \\nu_2; n)\n$$\n约束条件为：\n$$\n\\begin{cases}\nD \\left(1 + \\sigma^{\\nu_1+\\nu_2} \\theta^k\\right) \\le C \\\\\nT(k, \\nu_1, \\nu_2; n) \\le T_{\\max} \\\\\nk \\in \\{1, 2, 3, 4\\} \\\\\n\\nu_1, \\nu_2 \\in \\{1, 2, 3, 4, 5\\}\n\\end{cases}\n$$\n最小工作量的平局情况通过选择具有最小 $k$、然后最小 $\\nu_1$、最后最小 $\\nu_2$ 的配置来解决。\n\n**2. 求解方法**\n\n搜索空间是有限且小的，总共有 $4 \\times 5 \\times 5 = 100$ 种可能的配置 $(k, \\nu_1, \\nu_2)$。因此，穷举搜索是找到最优解的一种直接且计算成本低的方法。\n\n对于由 $(n, p, C, T_{\\max})$ 指定的每个测试用例：\n1.  创建一个空列表 `valid_configs`，用于存储所有同时满足误差和工作量约束的配置。\n2.  我们遍历各自搜索范围内的所有可能的整数元组 $(k, \\nu_1, \\nu_2)$。\n3.  对于每个元组，我们评估两个约束条件：\n    a. **误差约束检查：** 测试不等式 $D (1 + \\sigma^{\\nu_1+\\nu_2} \\theta^k) \\le C$。\n    b. **工作量约束检查：** 计算工作量 $T(k, \\nu_1, \\nu_2; n)$ 并与预算 $T_{\\max}$ 进行比较。\n4.  如果一个配置同时满足两个约束，则认为它是可行的。将包含配置及其性能指标 $(k, \\nu_1, \\nu_2, E, T)$ 的记录添加到 `valid_configs` 列表中。为报告目的，使用其完整表达式计算误差 $E$。\n5.  遍历完所有 $100$ 个配置后，我们分析 `valid_configs` 列表：\n    a. 如果列表为空，则不存在可行解，并为此案例报告失败签名 `[-1,-1,-1,-1.0,-1.0]`。\n    b. 如果列表包含一个或多个可行配置，则必须做出唯一的最佳选择。这通过对列表进行排序来实现。主排序键是工作量 $T$（升序）。用于打破平局的次要键是 $k$、$\\nu_1$ 和 $\\nu_2$（同样升序）。\n6.  此排序列表的第一个元素代表具有最小工作量 $T^*$ 且满足平局打破规则的最优配置 $(k^*, \\nu_1^*, \\nu_2^*)$。该配置的数据 `[k*, \\nu_1*, \\nu_2*, E*, T*]` 即为该测试用例的结果。\n\n对问题陈述中提供的所有测试用例重复此过程。",
            "answer": "[[1,1,1,3.3265380859375e-05,133128.0],[-1,-1,-1,-1.0,-1.0],[1,1,1,3.3265380859375e-05,133128.0],[2,1,1,7.72149658203125e-06,660490.0],[2,1,1,3.148069381713867e-05,166410.0]]"
        }
    ]
}