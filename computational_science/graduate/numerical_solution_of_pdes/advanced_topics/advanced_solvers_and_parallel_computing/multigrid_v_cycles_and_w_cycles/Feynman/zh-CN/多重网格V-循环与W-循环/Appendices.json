{
    "hands_on_practices": [
        {
            "introduction": "这个练习旨在建立对多重网格方法核心机制的直观理解：在网格之间传递信息。我们将手动对一个简单的函数应用全加权限制（full-weighting restriction）和双线性插值（bilinear interpolation）算子——这是几何多重网格的两个基石。这个练习将阐明这些算子如何工作，并揭示一个完整的限制-插值循环所引入的内在误差，这是理解多重网格效率的关键概念。",
            "id": "3347230",
            "problem": "考虑一个用于计算流体力学 (CFD) 中多重网格 V-循环和 W-循环迭代的典型网格传输步骤，该步骤作用于一个代表偏微分方程 (PDE) 解的光滑标量场。设计算域为 $\\Omega = [0,1] \\times [0,1]$，细网格为均匀的，有 $9 \\times 9$ 个节点（即每个方向有 $8$ 个区间），因此细网格间距为 $h = \\frac{1}{8}$。粗网格通过选取每隔一个细网格节点来定义，从而产生 $5 \\times 5$ 个粗网格节点，其间距为 $2h$。\n\n设连续场为 $u(x,y) = x^{2} + y^{2}$，并假设 $u$ 的细网格采样值是在细网格节点上精确给出的。将在一个粗网格节点 $(x_{0},y_{0})$ 上，从细网格到粗网格的全加权限制算子定义为九点模板\n$$\n\\mathcal{R}_{\\text{FW}}[u] (x_{0},y_{0}) \\;=\\; \\frac{1}{16}\\Big(u(x_{0}-h,y_{0}-h) + 2\\,u(x_{0},y_{0}-h) + u(x_{0}+h,y_{0}-h) \\\\\n+ 2\\,u(x_{0}-h,y_{0}) + 4\\,u(x_{0},y_{0}) + 2\\,u(x_{0}+h,y_{0}) \\\\\n+ u(x_{0}-h,y_{0}+h) + 2\\,u(x_{0},y_{0}+h) + u(x_{0}+h,y_{0}+h)\\Big).\n$$\n然后通过单元双线性插值定义从粗网格到细网格的延拓：在一个角点为 $(X_{0},Y_{0})$、$(X_{0}+2h,Y_{0})$、$(X_{0},Y_{0}+2h)$、$(X_{0}+2h,Y_{0}+2h)$ 的粗网格单元上，对于该单元内局部坐标为 $s,t \\in [0,1]$ 且满足 $x = X_{0} + 2hs$ 和 $y = Y_{0} + 2ht$ 的任意点 $(x,y)$，其插值等于\n$$\n\\mathcal{P}_{\\text{bilinear}}[U_{c}](x,y) \\;=\\; (1-s)(1-t)\\,U_{c}(X_{0},Y_{0}) \\;+\\; s(1-t)\\,U_{c}(X_{0}+2h,Y_{0}) \\\\\n+\\; (1-s)t\\,U_{c}(X_{0},Y_{0}+2h) \\;+\\; s t\\,U_{c}(X_{0}+2h,Y_{0}+2h),\n$$\n其中 $U_{c}$ 表示通过限制得到的粗网格值。使用这些定义，将全加权应用于给定的 $u$ 的细网格采样值以获得粗网格值，然后应用双线性插值在细网格节点上重构近似的细网格值。计算所有细网格节点上的最大逐点插值误差的绝对值，\n$$\nE_{\\max} \\;=\\; \\max_{\\text{fine nodes }(x,y)} \\left|\\mathcal{P}_{\\text{bilinear}}\\big[\\mathcal{R}_{\\text{FW}}[u]\\big](x,y) \\;-\\; u(x,y)\\right|,\n$$\n并以单个实数的精确形式提供您的答案。最终答案不要求四舍五入，也不包含任何单位。",
            "solution": "用户想让我解决一个问题。\n\n这是我的计划：\n1.  **验证问题陈述。**\n    *   **提取已知条件**：\n        *   计算域：$\\Omega = [0,1] \\times [0,1]$。\n        *   细网格：$9 \\times 9$ 个节点，间距 $h = \\frac{1}{8}$。\n        *   粗网格：$5 \\times 5$ 个节点，间距 $2h = \\frac{1}{4}$。\n        *   连续场：$u(x,y) = x^2 + y^2$。\n        *   细网格值是 $u(x,y)$ 的精确采样。\n        *   限制算子：$\\mathcal{R}_{\\text{FW}}$ 是全加权9点模板。\n        *   延拓算子：$\\mathcal{P}_{\\text{bilinear}}$ 是双线性插值。\n        *   目标：计算 $E_{\\max} = \\max_{\\text{fine nodes }(x,y)} |\\mathcal{P}_{\\text{bilinear}}[\\mathcal{R}_{\\text{FW}}[u]](x,y) - u(x,y)|$。\n    *   **验证**：\n        *   **科学依据**：该问题基于多重网格方法（限制、延拓）的标准、基本概念，这些是求解偏微分方程的数值分析的基石。具体的算子（全加权、双线性插值）和测试函数（$u(x,y)=x^2+y^2$）是分析这类方法性质的经典选择。\n        *   **适定性**：问题陈述清晰，包含了所有必要的定义和数值。目标是一个特定的计算，会得出一个唯一的数值答案。\n        *   **客观性**：问题使用精确的数学语言陈述，没有歧义或主观内容。\n        *   **结论**：问题是有效的。提及连续场 $u(x,y)$ 解决了在域边界应用限制模板时可能出现的歧义，因为它暗示了函数的定义延伸到网格之外，这是截断误差分析中的标准做法。\n\n2.  **解决问题。**\n    求解过程包括三个主要步骤：\n    1.  将限制算子 $\\mathcal{R}_{\\text{FW}}$ 应用于 $u(x,y)$ 的细网格表示，以获得粗网格值 $U_c$。\n    2.  将延拓算子 $\\mathcal{P}_{\\text{bilinear}}$ 应用于粗网格值 $U_c$，以获得插值后的细网格值 $u_I$。\n    3.  计算误差 $E(x,y) = u_I(x,y) - u(x,y)$ 并找出其在所有细网格节点上的最大绝对值。\n\n    **步骤 1：限制**\n    设 $(x_0, y_0)$ 为一个粗网格节点。全加权限制算子 $\\mathcal{R}_{\\text{FW}}$ 将粗网格值 $U_c(x_0, y_0)$ 计算为以 $(x_0, y_0)$ 为中心的九个细网格值的加权平均。细网格值由连续函数 $u(x,y) = x^2 + y^2$ 给出。\n    该算子定义为：\n    $$\n    U_c(x_0, y_0) = \\frac{1}{16} \\sum_{i=-1}^{1} \\sum_{j=-1}^{1} w_{ij} u(x_0+ih, y_0+jh)\n    $$\n    其中权重为 $w_{00}=4$，$w_{\\pm 1, 0}=w_{0, \\pm 1}=2$，以及 $w_{\\pm 1, \\pm 1}=1$。\n\n    我们可以通过将 $u(x_0+ih, y_0+jh)$ 在 $(x_0, y_0)$ 周围展开为泰勒级数来分析此算子对 $u(x,y)$ 的作用。由于 $u(x,y)$ 是一个二次多项式，其泰勒展开是精确且有限的：\n    $$\n    u(x_0+ih, y_0+jh) = u(x_0, y_0) + (ih) \\frac{\\partial u}{\\partial x} + (jh) \\frac{\\partial u}{\\partial y} + \\frac{1}{2} \\left( (ih)^2 \\frac{\\partial^2 u}{\\partial x^2} + (jh)^2 \\frac{\\partial^2 u}{\\partial y^2} + 2(ih)(jh) \\frac{\\partial^2 u}{\\partial x \\partial y} \\right)\n    $$\n    对于 $u(x,y) = x^2 + y^2$，在 $(x_0, y_0)$ 处的偏导数为：$\\frac{\\partial u}{\\partial x} = 2x_0$，$\\frac{\\partial u}{\\partial y} = 2y_0$，$\\frac{\\partial^2 u}{\\partial x^2} = 2$，$\\frac{\\partial^2 u}{\\partial y^2} = 2$，以及 $\\frac{\\partial^2 u}{\\partial x \\partial y} = 0$。\n    将这些代入展开式可得：\n    $$\n    u(x_0+ih, y_0+jh) = (x_0^2+y_0^2) + 2x_0 i h + 2y_0 j h + i^2 h^2 + j^2 h^2\n    $$\n    现在，我们计算加权和：\n    $$\n    U_c(x_0, y_0) = \\frac{1}{16} \\sum_{i,j} w_{ij} \\left( u(x_0, y_0) + 2x_0 i h + 2y_0 j h + i^2 h^2 + j^2 h^2 \\right)\n    $$\n    根据求和的线性性质：\n    $$\n    U_c(x_0, y_0) = \\frac{1}{16} \\left( u(x_0, y_0)\\sum_{i,j} w_{ij} + 2x_0 h \\sum_{i,j} w_{ij}i + 2y_0 h \\sum_{i,j} w_{ij}j + h^2 \\sum_{i,j} w_{ij}i^2 + h^2 \\sum_{i,j} w_{ij}j^2 \\right)\n    $$\n    我们计算加权指数的和：\n    $\\sum_{i,j} w_{ij} = 1+2+1+2+4+2+1+2+1 = 16$。\n    由于权重的对称性（$w_{ij} = w_{-i,j}$ 和 $w_{ij}=w_{i,-j}$）：\n    $\\sum_{i,j} w_{ij} i = 0$ 和 $\\sum_{i,j} w_{ij} j = 0$。\n    $i^2$ 项的和为：\n    $\\sum_{i,j} w_{ij} i^2 = \\sum_{j} (w_{-1,j}(-1)^2 + w_{0,j}(0)^2 + w_{1,j}(1)^2) = \\sum_{j} (w_{-1,j} + w_{1,j})$。\n    对于 $j \\in \\{-1, 1\\}$，$w_{-1,j}+w_{1,j} = 1+1=2$。对于 $j=0$，$w_{-1,0}+w_{1,0} = 2+2=4$。\n    因此，$\\sum_{i,j} w_{ij} i^2 = 2 + 4 + 2 = 8$。根据对称性，$\\sum_{i,j} w_{ij} j^2 = 8$。\n\n    将这些和代回 $U_c$ 的表达式中：\n    $$\n    U_c(x_0, y_0) = \\frac{1}{16} \\left( 16 u(x_0, y_0) + 0 + 0 + 8h^2 + 8h^2 \\right) = u(x_0, y_0) + \\frac{16h^2}{16} = u(x_0, y_0) + h^2\n    $$\n    因此，在每个粗网格节点 $(x,y)$ 处，粗网格值为 $U_c(x,y) = x^2+y^2+h^2$。\n\n    **步骤 2：延拓**\n    接下来，我们将双线性插值 $\\mathcal{P}_{\\text{bilinear}}$ 应用于粗网格数据 $U_c$，以在细网格上获得值 $u_I$。该算子是线性的，所以我们可以写成：\n    $$\n    u_I(x,y) = \\mathcal{P}_{\\text{bilinear}}[U_c](x,y) = \\mathcal{P}_{\\text{bilinear}}[u+h^2](x,y) = \\mathcal{P}_{\\text{bilinear}}[u](x,y) + \\mathcal{P}_{\\text{bilinear}}[h^2](x,y)\n    $$\n    对一个常数值（$h^2$）进行双线性插值，结果处处都是该常数值。因此，$\\mathcal{P}_{\\text{bilinear}}[h^2](x,y) = h^2$。\n    该方程简化为：\n    $$\n    u_I(x,y) = \\mathcal{P}_{\\text{bilinear}}[u](x,y) + h^2\n    $$\n\n    **步骤 3：误差计算**\n    在细网格点 $(x,y)$ 处的误差为：\n    $$\n    E(x,y) = u_I(x,y) - u(x,y) = \\left( \\mathcal{P}_{\\text{bilinear}}[u](x,y) - u(x,y) \\right) + h^2\n    $$\n    括号中的项是函数 $u(x,y)=x^2+y^2$ 的标准双线性插值误差。我们来计算这个误差。\n    考虑一个角点为 $(X_0, Y_0)$、$(X_0+2h, Y_0)$、$(X_0, Y_0+2h)$、$(X_0+2h, Y_0+2h)$ 的粗网格单元。该单元中的一个点 $(x,y)$ 由 $x = X_0 + s(2h)$ 和 $y = Y_0 + t(2h)$ 参数化，其中 $s,t \\in [0,1]$。\n    双线性插值算子对于被插值的函数也是线性的，所以 $\\mathcal{P}_{\\text{bilinear}}[x^2+y^2] = \\mathcal{P}_{\\text{bilinear}}[x^2] + \\mathcal{P}_{\\text{bilinear}}[y^2]$。\n    让我们使用在 $[Z_0, Z_0+L]$ 上的一维线性插值来求 $f(z)=z^2$ 的插值误差。插值函数为 $f_I(z) = (1-\\sigma)Z_0^2 + \\sigma(Z_0+L)^2$，其中 $z=Z_0+\\sigma L$。\n    误差为 $f_I(z) - z^2 = ((1-\\sigma)Z_0^2 + \\sigma(Z_0+L)^2) - (Z_0+\\sigma L)^2 = L^2\\sigma(1-\\sigma)$。\n    对于 $u(x,y)=x^2+y^2$ 的双线性插值，我们有：\n    $\\mathcal{P}_{\\text{bilinear}}[x^2](x,y) = x^2 + (2h)^2s(1-s) = x^2+4h^2s(1-s)$。\n    $\\mathcal{P}_{\\text{bilinear}}[y^2](x,y) = y^2 + (2h)^2t(1-t) = y^2+4h^2t(1-t)$。\n    $u$ 的插值误差为：\n    $$\n    \\mathcal{P}_{\\text{bilinear}}[u](x,y) - u(x,y) = (x^2+4h^2s(1-s) + y^2+4h^2t(1-t)) - (x^2+y^2) = 4h^2s(1-s) + 4h^2t(1-t)\n    $$\n    因此，总误差为：\n    $$\n    E(x,y) = \\left( 4h^2s(1-s) + 4h^2t(1-t) \\right) + h^2 = h^2(1 + 4s(1-s) + 4t(1-t))\n    $$\n\n    **步骤 4：最大化**\n    我们必须在所有细网格节点上找到 $|E(x,y)|$ 的最大值。因为 $h0$ 且 $s,t\\in[0,1]$，所以项 $s(1-s)$ 和 $t(1-t)$ 是非负的，因此 $E(x,y)$ 总是正的。于是，$|E(x,y)|=E(x,y)$。\n    细网格节点位于坐标 $(ih, jh)$ 处，其中 $i,j \\in \\{0, 1, \\dots, 8\\}$。一个细网格节点 $(ih, jh)$ 在粗网格单元内的局部坐标 $(s,t)$ 由 $s = (i \\pmod 2)/2$ 和 $t = (j \\pmod 2)/2$ 给出。\n    在细网格节点上，$s$ 和 $t$ 的可能值为 $0$ 和 $1/2$。\n    我们必须在 $(s,t) \\in \\{0, 1/2\\} \\times \\{0, 1/2\\}$ 上最大化 $E(x,y)$。\n    函数 $f(\\sigma) = \\sigma(1-\\sigma)$ 在 $\\sigma=0$ 时为 $0$，在 $\\sigma=1/2$ 时为 $1/4$。\n    当 $s(1-s)$ 和 $t(1-t)$ 最大化时，误差函数 $E$ 也达到最大值，这发生在 $s=1/2$ 和 $t=1/2$ 时。\n    这对应于具有奇数索引 $(i,j)$ 的细网格节点，这些节点是粗网格单元的中心。\n    最大误差为：\n    $$\n    E_{\\max} = h^2\\left(1 + 4\\left(\\frac{1}{2}\\right)\\left(1-\\frac{1}{2}\\right) + 4\\left(\\frac{1}{2}\\right)\\left(1-\\frac{1}{2}\\right)\\right) = h^2\\left(1 + 4\\left(\\frac{1}{4}\\right) + 4\\left(\\frac{1}{4}\\right)\\right)\n    $$\n    $$\n    E_{\\max} = h^2(1 + 1 + 1) = 3h^2\n    $$\n    问题给出 $h = \\frac{1}{8}$。代入此值：\n    $$\n    E_{\\max} = 3 \\left(\\frac{1}{8}\\right)^2 = 3 \\left(\\frac{1}{64}\\right) = \\frac{3}{64}\n    $$",
            "answer": "$$\\boxed{\\frac{3}{64}}$$"
        },
        {
            "introduction": "在我们对传递算子的理解之上，这个练习探讨了如何正式构建粗网格问题。我们将使用Galerkin公式 $A_c = R A_f P$ 来推导粗网格算子，这对于多重网格方法的稳健性至关重要。通过将得到的模板与粗网格上的简单再离散化进行比较，这个练习展示了一个关键原则：Galerkin方法产生的粗网格算子能更好地表示细网格的物理特性，即使它看起来更复杂。",
            "id": "3347238",
            "problem": "考虑二维泊松方程 $-\\nabla^{2} u = f$，其定义在一个无限、均匀的笛卡尔网格上，两个空间方向上的间距均为 $h$。令 $A_{f}$ 表示细网格上的标准五点离散拉普拉斯算子，由以下模板定义：\n$$\n\\frac{1}{h^{2}}\n\\begin{pmatrix}\n0  -1  0 \\\\\n-1  4  -1 \\\\\n0  -1  0\n\\end{pmatrix}.\n$$\n通过均匀粗化定义粗网格，其间距为 $H = 2h$。令延长算子 $P$ 为从粗网格到细网格的双线性插值，限制算子 $R$ 为从细网格到粗网格的全加权算子。具体来说，双线性插值 $P$ 将位于 $(I,J)$ 的粗网格自由度映射为以 $(2I,2J)$ 为中心的 $3 \\times 3$ 细网格块上的值，其权重为\n$$\np_{0,0} = 1,\\quad p_{\\pm1,0} = p_{0,\\pm1} = \\frac{1}{2},\\quad p_{\\pm1,\\pm1} = \\frac{1}{4},\n$$\n其他位置为零；全加权限制算子 $R$ 使用\n$$\n\\frac{1}{16}\n\\begin{pmatrix}\n1  2  1 \\\\\n2  4  2 \\\\\n1  2  1\n\\end{pmatrix}\n$$\n作用于以 $(2I,2J)$ 为中心的 $3 \\times 3$ 细网格块上，将细网格场映射到位于 $(I,J)$ 的粗网格节点上。Galerkin粗网格算子为 $A_{c} = R\\,A_{f}\\,P$。\n\n仅从这些定义出发，推导 $A_{c}$ 的有效粗网格 $3 \\times 3$ 印记（模板），并按顺序 $\\{\\text{NW}, \\text{N}, \\text{NE}, \\text{W}, \\text{C}, \\text{E}, \\text{SW}, \\text{S}, \\text{SE}\\}$ 表示其九个权重，并用粗网格间距 $H$ 进行化简。然后，将得到的五点子集（中心点和四个基本方向上的邻点）与粗网格上重新离散化的五点拉普拉斯算子的权重进行比较，该算子的模板为\n$$\n\\frac{1}{H^{2}}\n\\begin{pmatrix}\n0  -1  0 \\\\\n-1  4  -1 \\\\\n0  -1  0\n\\end{pmatrix}.\n$$\n你的最终答案必须是粗网格 $3 \\times 3$ 模板的权重，表示为单个用 $H$ 表示的 $1 \\times 9$ 行矩阵表达式。无需进行数值四舍五入。",
            "solution": "用户希望我解决这个问题。\n我对问题的分析如下：\n1.  **提取已知条件**：\n    *   方程：二维泊松方程，$-\\nabla^{2} u = f$。\n    *   网格：无限均匀的笛卡尔网格。\n    *   细网格间距：$h$。\n    *   细网格算子 $A_f$：标准五点离散拉普拉斯算子，模板 $\\frac{1}{h^{2}} \\begin{pmatrix} 0  -1  0 \\\\ -1  4  -1 \\\\ 0  -1  0 \\end{pmatrix}$。\n    *   粗网格间距：$H = 2h$。\n    *   延长算子 $P$：双线性插值，对于位于 $(I,J)$ 的粗网格节点，其在以 $(2I, 2J)$ 为中心的 $3 \\times 3$ 细网格块上的权重为 $p_{0,0} = 1$, $p_{\\pm1,0} = p_{0,\\pm1} = \\frac{1}{2}$, $p_{\\pm1,\\pm1} = \\frac{1}{4}$。\n    *   限制算子 $R$：全加权，其在以 $(2I, 2J)$ 为中心的 $3 \\times 3$ 细网格块上的模板为 $\\frac{1}{16} \\begin{pmatrix} 1  2  1 \\\\ 2  4  2 \\\\ 1  2  1 \\end{pmatrix}$。\n    *   粗网格算子：$A_c = R A_f P$。\n    *   任务1：推导 $A_c$ 的 $3 \\times 3$ 模板，并用 $H$ 表示其九个权重。\n    *   任务2：按顺序 $\\{\\text{NW}, \\text{N}, \\text{NE}, \\text{W}, \\text{C}, \\text{E}, \\text{SW}, \\text{S}, \\text{SE}\\}$ 给出权重。\n    *   任务3：将 $A_c$ 模板的五点子集与粗网格上的标准重新离散化拉普拉斯算子（其模板为 $\\frac{1}{H^{2}} \\begin{pmatrix} 0  -1  0 \\\\ -1  4  -1 \\\\ 0  -1  0 \\end{pmatrix}$）进行比较。\n\n2.  **使用提取的已知条件进行验证**：\n    *   该问题具有科学依据，是多重网格方法理论中的一个标准练习，而多重网格方法是数值分析和计算流体力学中的核心课题。\n    *   所有算子（$A_f$、$P$、$R$）和 Galerkin 粗化过程（$A_c = R A_f P$）都使用其标准的教科书形式定义。\n    *   该问题是适定的、客观的、自洽的。它为直接通过代数推导粗网格算子模板提供了所有必要信息。\n    *   该问题不违反任何无效性标准。\n\n3.  **结论与行动**：\n    *   问题是有效的。\n    *   我将继续进行推导。\n\n粗网格算子定义为三重积 $A_c = R A_f P$。为了确定 $A_c$ 的模板，我们可以计算它在粗网格 delta 函数上的作用。设 $u_c$ 是一个粗网格函数，它在单个粗网格节点上为 1，在所有其他粗网格节点上为 0。不失一般性，我们可以将这个节点置于原点 $(I,J)=(0,0)$。$A_c$ 的模板权重就是得到的粗网格函数 $(A_c u_c)(I', J')$ 在 $(I',J') \\in \\{(-1,-1), \\dots, (1,1)\\}$ 处的值。推导分三步进行。\n\n第1步：延长。我们将延长算子 $P$ 应用于粗网格 delta 函数 $u_c$。这将粗网格节点 $(0,0)$ 上的单个非零值映射到细网格上的一片值。根据双线性插值的定义，$u_c(0,0)=1$ 的值会在细网格上生成一个 $3 \\times 3$ 的非零值区域，以对应的细网格节点 $(i,j)=(0,0)$ 为中心。设这个细网格函数为 $u_f = P u_c$。对于 $i,j \\in \\{-1, 0, 1\\}$，$u_f(i,j)$ 的值由 $P$ 的权重给出：\n$$\nu_f(i,j) = \n\\begin{pmatrix}\np_{-1,1}  p_{0,1}  p_{1,1} \\\\\np_{-1,0}  p_{0,0}  p_{1,0} \\\\\np_{-1,-1}  p_{0,-1}  p_{1,-1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/4  1/2  1/4 \\\\\n1/2  1  1/2 \\\\\n1/4  1/2  1/4\n\\end{pmatrix}.\n$$\n对于所有其他细网格点 $(i,j)$，$u_f(i,j) = 0$。\n\n第2步：应用细网格算子。我们现在将细网格拉普拉斯算子 $A_f$ 应用于细网格函数 $u_f$。设结果为 $v_f = A_f u_f$。$A_f$ 在细网格节点 $(i,j)$ 上的作用由其模板给出：\n$$\nv_f(i,j) = \\frac{1}{h^2} \\left[ 4u_f(i,j) - u_f(i-1,j) - u_f(i+1,j) - u_f(i,j-1) - u_f(i,j+1) \\right].\n$$\n由于 $u_f$ 在一个 $3 \\times 3$ 的区域上非零，$v_f$ 将在一个 $5 \\times 5$ 的区域上非零。我们利用对称性计算关键点上 $h^2 v_f(i,j)$ 的值：\n在中心点 $(0,0)$：\n$h^2 v_f(0,0) = 4u_f(0,0) - 4u_f(1,0) = 4(1) - 4(1/2) = 2$。\n在基本方向上的点，例如 $(1,0)$：\n$h^2 v_f(1,0) = 4u_f(1,0) - u_f(0,0) - u_f(2,0) - u_f(1,-1) - u_f(1,1) = 4(1/2) - 1 - 0 - 1/4 - 1/4 = 2-1-1/2 = 1/2$。\n根据对称性，$h^2 v_f(-1,0) = h^2 v_f(0,1) = h^2 v_f(0,-1) = 1/2$。\n在对角线上的点，例如 $(1,1)$：\n$h^2 v_f(1,1) = 4u_f(1,1) - u_f(0,1) - u_f(2,1) - u_f(1,0) - u_f(1,2) = 4(1/4) - 1/2 - 0 - 1/2 - 0 = 1-1 = 0$。\n根据对称性，$h^2 v_f(\\pm 1, \\pm 1) = 0$。\n在外部基本方向上的点，例如 $(2,0)$：\n$h^2 v_f(2,0) = 4u_f(2,0) - u_f(1,0) - u_f(3,0) - u_f(2,-1) - u_f(2,1) = 4(0) - 1/2 - 0 - 0 - 0 = -1/2$。\n根据对称性，$h^2 v_f(-2,0) = h^2 v_f(0,2) = h^2 v_f(0,-2) = -1/2$。\n在外部混合点，例如 $(2,1)$：\n$h^2 v_f(2,1) = 4u_f(2,1) - u_f(1,1) - u_f(3,1) - u_f(2,0) - u_f(2,2) = 4(0) - 1/4 - 0 - 0 - 0 = -1/4$。\n根据对称性，$h^2 v_f(\\pm 2, \\pm 1) = h^2 v_f(\\pm 1, \\pm 2) = -1/4$。\n所有其他 $v_f$ 的值均为零。$h^2 v_f$ 的区域是：\n$$\nh^2 v_f(i,j) = \n\\begin{pmatrix}\n0  -1/4  -1/2  -1/4  0 \\\\\n-1/4  0  1/2  0  -1/4 \\\\\n-1/2  1/2  2  1/2  -1/2 \\\\\n-1/4  0  1/2  0  -1/4 \\\\\n0  -1/4  -1/2  -1/4  0\n\\end{pmatrix}.\n$$\n\n第3步：限制。我们将限制算子 $R$ 应用于 $v_f$ 以获得最终的粗网格函数 $v_c = R v_f$。$v_c$ 在粗网格节点 $(I,J)$ 上的值是以 $(2I, 2J)$ 为中心的 $3 \\times 3$ 细网格区域上 $v_f$ 值的加权平均。权重由全加权模板 $S_R = \\frac{1}{16} \\begin{pmatrix} 1  2  1 \\\\ 2  4  2 \\\\ 1  2  1 \\end{pmatrix}$ 给出。\n值 $v_c(I,J)$ 就是 $A_c$ 的模板权重。\n中心点 (C) 的权重，$(I,J)=(0,0)$：限制模板以细网格点 $(0,0)$ 为中心。\n$v_c(0,0) = \\frac{1}{16} \\sum_{i,j=-1}^{1} w_R(i,j) v_f(i,j) = \\frac{1}{16h^2} \\left[ 4(2) + 2(1/2)\\times4 + 1(0)\\times4 \\right] = \\frac{1}{16h^2}[8+4] = \\frac{12}{16h^2} = \\frac{3}{4h^2}$。\n北方 (N) 的权重，$(I,J)=(0,1)$：限制模板以细网格点 $(0,2)$ 为中心。\n$v_c(0,1) = \\frac{1}{16} \\sum_{i,j=-1}^{1} w_R(i,j) v_f(i, 2+j) = \\frac{1}{16h^2} \\left[ 4(-1/2) + 2(1/2) + 2(-1/4)\\times2 \\right] = \\frac{1}{16h^2}[-2+1-1] = \\frac{-2}{16h^2} = -\\frac{1}{8h^2}$。\n根据对称性，南方 (S)、东方 (E) 和西方 (W) 的权重也为 $-\\frac{1}{8h^2}$。\n西北方 (NW) 的权重，$(I,J)=(-1,1)$：限制模板以细网格点 $(-2,2)$ 为中心。\n$v_c(-1,1) = \\frac{1}{16} \\sum_{i,j=-1}^{1} w_R(i,j) v_f(-2+i, 2+j) = \\frac{1}{16h^2} \\left[ 2(-1/4) + 2(-1/4) \\right] = \\frac{1}{16h^2}[-1/2-1/2] = \\frac{-1}{16h^2}$。\n根据对称性，东北方 (NE)、西南方 (SW) 和东南方 (SE) 的权重也为 $-\\frac{1}{16h^2}$。\n\n已知 $H = 2h$，所以 $h^2 = H^2/4$。我们将此代入推导出的权重中，用 $H$ 表示它们：\n中心 (C)：$\\frac{3}{4(H^2/4)} = \\frac{3}{H^2}$。\n基本方向 (N,S,E,W)：$-\\frac{1}{8(H^2/4)} = -\\frac{4}{8H^2} = -\\frac{1}{2H^2}$。\n对角线方向 (NW,NE,SW,SE)：$-\\frac{1}{16(H^2/4)} = -\\frac{4}{16H^2} = -\\frac{1}{4H^2}$。\n\n得到的 $A_c$ 的 $3 \\times 3$ 模板是：\n$$\nS_{A_c} = \\frac{1}{H^2} \\begin{pmatrix} -1/4  -1/2  -1/4 \\\\ -1/2  3  -1/2 \\\\ -1/4  -1/2  -1/4 \\end{pmatrix}.\n$$\n按指定顺序 $\\{\\text{NW}, \\text{N}, \\text{NE}, \\text{W}, \\text{C}, \\text{E}, \\text{SW}, \\text{S}, \\text{SE}\\}$ 的九个权重是：\n$$\n\\frac{1}{H^2} \\left\\{ -\\frac{1}{4}, -\\frac{1}{2}, -\\frac{1}{4}, -\\frac{1}{2}, 3, -\\frac{1}{2}, -\\frac{1}{4}, -\\frac{1}{2}, -\\frac{1}{4} \\right\\}.\n$$\n与重新离散化算子的比较：\n粗网格上的标准五点拉普拉斯算子是 $A_H \\sim \\frac{1}{H^2} \\begin{pmatrix} 0  -1  0 \\\\ -1  4  -1 \\\\ 0  -1  0 \\end{pmatrix}$。\n我们推导出的 Galerkin 算子 $A_c$ 的五点子集是 $\\frac{1}{H^2} \\begin{pmatrix} 0  -1/2  0 \\\\ -1/2  3  -1/2 \\\\ 0  -1/2  0 \\end{pmatrix}$。\n比较两者，我们观察到两个主要差异。首先，Galerkin 算子 $A_c$ 是一个九点模板，而不是五点模板。其次，对于五点部分，$A_c$ 的权重与 $A_H$ 不同。$A_c$ 的非对角线项的大小是 $A_H$ 的一半，而对角线项是 $3$ 而不是 $4$（以 $1/H^2$ 为单位）。$A_c$ 模板中所有九个权重的总和是 $\\frac{1}{H^2} (3 + 4(-1/2) + 4(-1/4)) = \\frac{1}{H^2}(3 - 2 - 1) = 0$，这是与连续算子保持一致性的必要条件。\n\n最终答案是这九个权重的行矩阵。",
            "answer": "$$ \\boxed{\\frac{1}{H^2} \\begin{pmatrix} -\\frac{1}{4}  -\\frac{1}{2}  -\\frac{1}{4}  -\\frac{1}{2}  3  -\\frac{1}{2}  -\\frac{1}{4}  -\\frac{1}{2}  -\\frac{1}{4} \\end{pmatrix}} $$"
        },
        {
            "introduction": "在掌握了多重网格组件的力学原理之后，我们现在来解决一个更高层次的策略问题：什么时候应该使用V循环，什么时候应该使用更昂贵的W循环？这个思想实验提出了一个具有挑战性的各向异性扩散问题，在这种问题上，标准的V循环表现不佳。分析这个场景将揭示简单光滑子的局限性，并解释为什么W循环中重复的粗网格校正对于处理某些类型的顽固低频误差至关重要。",
            "id": "2415597",
            "problem": "考虑线性系统 $A \\mathbf{u} = \\mathbf{f}$，该系统由偏微分方程(PDE) $-\\nabla \\cdot (K(x,y)\\nabla u) = f$ 在单位正方形 $[0,1]\\times[0,1]$ 上采用均匀网格上的二阶精度有限差分离散，并带有齐次狄利克雷边界条件而产生。其扩散张量为\n$$\nK(x,y) = R(\\theta(y)) \n\\begin{pmatrix}\n\\epsilon  0 \\\\\n0  1\n\\end{pmatrix}\nR(-\\theta(y)),\n$$\n其中 $R(\\theta)$ 是 $2\\times 2$ 旋转矩阵，$\\theta(y) = \\frac{\\pi}{2} y$，且 $0  \\epsilon \\ll 1$。因此，强扩散方向从 $y=0$ 处的 $y$ 轴连续旋转到 $y=1$ 处的 $x$ 轴。\n\n您在一系列网格尺寸为 $h,2h,4h,\\dots$ 的相继变粗的均匀网格上，应用了包含以下要素的几何多重网格(GMG)方法：点状高斯-赛德尔松弛（$\\nu_1$ 步预平滑和 $\\nu_2$ 步后平滑，其中 $\\nu_1, \\nu_2 \\ge 1$ 为固定的较小整数）、标准全加权限制 $R$、双线性插值 $P$ 以及伽辽金粗网格算子 $A_c = R A P$。考虑两种多重网格循环策略：V-循环（每个循环每层进行一次粗网格下降）和W-循环（每个循环每层进行两次粗网格下降）。假设在最粗的网格上进行精确求解。\n\n对于该问题，在给定的GMG选择下，哪种说法最能预测其渐进收敛行为，并解释原因？\n\nA. V-循环将停滞或收敛非常缓慢，而W-循环将收敛得快得多，因为旋转的各向异性使得粗网格校正对于相对于细网格的低频误差分量来说很弱，而W-循环在每个循环中多次应用粗网格校正，从而显著增强了对这些分量的削减。\n\nB. V-循环和W-循环将以基本相同的速率收敛，因为只有平滑器决定收敛性，递归模式不影响渐进因子。\n\nC. V-循环将比W-循环收敛得更快，因为W-循环中额外的粗网格工作会过度平滑已经被点状高斯-赛德尔松弛消除的高频误差。\n\nD. W-循环将会发散，因为当各向异性方向随 $y$ 变化时，重复的粗网格校正会放大低频误差。",
            "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n### 第一步：提取已知条件\n\n-   **线性系统**: $A \\mathbf{u} = \\mathbf{f}$。\n-   **来源**: 偏微分方程(PDE)的二阶精度有限差分离散。\n-   **PDE**: $-\\nabla \\cdot (K(x,y)\\nabla u) = f$。\n-   **区域**: 单位正方形，$[0,1]\\times[0,1]$。\n-   **边界条件**: 齐次狄利克雷。\n-   **扩散张量**: $K(x,y) = R(\\theta(y)) \\begin{pmatrix} \\epsilon  0 \\\\ 0  1 \\end{pmatrix} R(-\\theta(y))$。\n-   **旋转矩阵**: $R(\\theta)$ 是 $2\\times 2$ 的旋转矩阵。\n-   **旋转角度**: $\\theta(y) = \\frac{\\pi}{2} y$。\n-   **各向异性参数**: $0  \\epsilon \\ll 1$。\n-   **问题特征**: 强扩散方向从 $y=0$ 处的 $y$ 方向旋转到 $y=1$ 处的 $x$ 方向。\n-   **方法**: 在一系列网格尺寸为 $h, 2h, 4h, \\dots$ 的均匀网格上的几何多重网格(GMG)。\n-   **GMG要素**:\n    -   **平滑器**: 点状高斯-赛德尔松弛。\n    -   **平滑**: $\\nu_1$ 步预平滑和 $\\nu_2$ 步后平滑，其中 $\\nu_1, \\nu_2 \\ge 1$ 为固定的较小整数。\n    -   **限制**: 标准全加权, $R$。\n    -   **插值**: 双线性插值, $P$。\n    -   **粗网格算子**: 伽辽金算子, $A_c = R A P$。\n-   **循环策略**: V-循环和W-循环。\n-   **最粗网格**: 假设精确求解。\n-   **问题**: 预测V-循环与W-循环的渐进收敛行为并提供理由。\n\n### 第二步：使用提取的已知条件进行验证\n\n1.  **科学合理性**: 该问题描述了一个典型的各向异性扩散方程。这类问题是数值分析和计算工程领域的标准基准测试，用于测试迭代求解器，特别是多重网格方法的鲁棒性。所有指定的要素——PDE、边界条件、离散化以及GMG成分（点状高斯-赛德尔、标准网格间转移算子、伽辽金粗化）——都是公认且科学合理的。\n2.  **适定性**: 该问题是适定的。它要求对两种标准多重网格循环在一个具体、明确定义的数值问题上的收敛性能进行定性比较。给出的设置提供了足够的信息来应用既定的多重网格理论和分析。\n3.  **客观性**: 问题陈述使用精确、客观和技术性的语言表述，没有任何主观的G_x。\n4.  **完整性**: 问题是自洽的。它定义了PDE、区域、边界条件以及数值方法的所有基本要素。\n5.  **现实性**: 该设置是一个经典且现实的测试案例，用于展示标准多重网格方法的局限性以及对更鲁棒的组件或循环的需求。\n6.  **结构**: 问题直接，不涉及循环论证。\n\n### 第三步：结论与行动\n\n问题陈述是有效的。这是一个数值分析中的标准、非平凡问题，需要对多重网格原理有深入的理解。下面将推导解决方案。\n\n### 推导与分析\n\n这个问题的核心在于所选平滑器与偏微分方程算子中各向异性性质之间的相互作用。\n\n1.  **平滑器分析**: 指定的平滑器是点状高斯-赛德尔方法。点状平滑器能有效衰减高频误差分量。如果误差分量相对于网格间距是振荡的，则被认为是高频的。然而，平滑器的效率严重依赖于算子。对于具有强方向依赖各向异性的椭圆算子，如此处给出的 $0  \\epsilon \\ll 1$ 的情况，模板耦合在一个方向（弱扩散方向）上比另一个方向强得多。点状平滑器对这类问题效率极低是出了名的，因为它们无法衰减某些误差模式。这些有问题的模式在强耦合方向上是光滑的（低频），但在弱耦合方向上是振荡的（高频）。这种模式通常被称为“半粗”或“特征”误差模式。点状平滑器不将这些模式“看作”是高振荡的，因为误差在强耦合方向的相邻点之间变化很小，因此无法有效地削减它们。\n\n2.  **旋转各向异性的影响**: 由于各向异性的方向随垂直坐标 $y$ 旋转，问题变得更加复杂。\n    -   在 $y=0$ 附近, $\\theta(0)=0$。强扩散方向沿着 $y$ 轴，而弱扩散($\\epsilon$)方向沿着 $x$ 轴。算子在局部可近似为 $-\\epsilon u_{xx} - u_{yy} = f$。点状高斯-赛德尔将无法平滑在 $y$ 方向振荡但在 $x$ 方向光滑的误差。\n    -   在 $y=1$ 附近, $\\theta(1)=\\pi/2$。强扩散方向沿着 $x$ 轴，而弱扩散方向沿着 $y$ 轴。算子在局部可近似为 $-u_{xx} - \\epsilon u_{yy} = f$。点状高斯-赛德尔将无法平滑在 $x$ 方向振荡但在 $y$ 方向光滑的误差。\n    -   在中间的 $y$ 值处，有问题的模式与旋转后的坐标系对齐。\n\n3.  **粗网格校正(CGC)分析**: CGC的目的是消除平滑器无法处理的光滑误差分量。在标准多重网格理论中，假设任何未被平滑器衰减的误差都足够光滑，可以在更粗的网格上被精确表示和求解。然而，上述的半粗模式并非在所有方向上都光滑。当使用像全加权这样的标准算子将这些模式限制到更粗的网格上时，它们在某个方向上的高频特性会导致混叠。标准的粗网格算子，即使是使用伽辽金构造（$A_c = R A P$），也无法精确表示这些细网格半粗模式的行为。因此，粗网格校正在削减这些特定模式方面非常弱。这导致两层网格收敛因子 $\\rho_{2g}$ 接近于 $1$。\n\n4.  **V-循环和W-循环的比较**: 多重网格循环的渐进收敛因子取决于两层网格因子 $\\rho_{2g}$ 和循环的类型。\n    -   **V-循环**每层执行一次粗网格校正步骤。如果CGC不够有效（即 $\\rho_{2g}$ 不够小），其收敛因子会随着层数的增加而恶化。对于这样的问题，其中 $\\rho_{2g}$ 接近于 $1$，V-循环将表现出非常缓慢的收敛或停滞。在每一层单次应用弱的CGC不足以控制有问题的半粗误差模式。\n    -   **W-循环**每层执行两次粗网格校正步骤。CGC的这种重复应用具有复合效应。如果两层网格过程是一个收缩因子为 $\\rho_{2g}$ 的收缩，那么在W-循环中应用两次大致相当于一个削减因子 $\\rho_{2g}^2$。由于 $\\rho_{2g}  1$（即使接近于 $1$），我们有 $\\rho_{2g}^2 \\ll \\rho_{2g}$。因此，正是在CGC较弱的情况下，W-循环更加鲁棒，并能获得比V-循环好得多的收敛因子。粗网格上的额外工作是针对V-循环无法充分削减的慢收敛误差分量。\n\n### 逐项评估选项\n\n-   **A. V-循环将停滞或收敛非常缓慢，而W-循环将收敛得快得多，因为旋转的各向异性使得粗网格校正对于相对于细网格的低频误差分量来说很弱，而W-循环在每个循环中多次应用粗网格校正，从而显著增强了对这些分量的削减。**\n    -   这个陈述正确地指出V-循环由于弱的粗网格校正而表现不佳。它正确地将弱校正的原因归结为各向异性。它正确地断言W-循环将显著更快，并提供了正确的原因：在每个循环内重复应用（弱的）粗网格校正导致对问题误差模式更有效的削减。术语‘低频误差分量’在多重网格的语境中，用来指代应在粗网格上处理的分量，这对于手头的半粗模式是恰当的。\n    -   **结论：正确。**\n\n-   **B. V-循环和W-循环将以基本相同的速率收敛，因为只有平滑器决定收敛性，递归模式不影响渐进因子。**\n    -   这种说法有根本性错误。多重网格的收敛是平滑和粗网格校正的综合作用。“只有平滑器决定收敛性”的说法是错误的。递归模式（V-循环、W-循环等）直接决定了CGC的应用方式，并且是整体渐进收敛因子的主要决定因素，特别是对于困难问题。\n    -   **结论：不正确。**\n\n-   **C. V-循环将比W-循环收敛得更快，因为W-循环中额外的粗网格工作会过度平滑已经被点状高斯-赛德尔松弛消除的高频误差。**\n    -   这种说法误解了粗网格校正的功能。CGC旨在处理光滑（低频）误差，而非高频误差。高频误差甚至无法在粗网格上表示。额外粗网格工作“过度平滑高频误差”的前提是荒谬的。W-循环的额外工作正是针对平滑器*无法*消除的误差。\n    -   **结论：不正确。**\n\n-   **D. W-循环将会发散，因为当各向异性方向随 $y$ 变化时，重复的粗网格校正会放大低频误差。**\n    -   发散意味着两层网格收敛因子大于或等于 $1$。尽管该方法效率不高，但对于这个问题，一个正确实现的基于伽辽金的多重网格方法通常是收敛的，尽管可能很慢（即 $\\rho_{2g}  1$）。重复一个收敛的过程（CGC）不会导致放大或发散；它会导致误差的更大削减。W-循环应该收敛，并且比V-循环更快。\n    -   **结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}