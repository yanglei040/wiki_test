{
    "hands_on_practices": [
        {
            "introduction": "To build a solid understanding of fractional calculus, it is essential to work directly with the core definitions. This first exercise provides a direct, hands-on comparison between the Riemann-Liouville and Caputo fractional derivatives by applying them to the simple function $f(t) = t$. By calculating each derivative from first principles and examining the difference, you will gain concrete insight into the subtle but crucial distinctions and similarities between these two fundamental operators .",
            "id": "1159327",
            "problem": "The field of fractional calculus generalizes the concept of differentiation and integration to non-integer orders. Two of the most common definitions for the fractional derivative are the Riemann-Liouville and the Caputo definitions. For a given function $f(t)$ defined for $t \\ge 0$, and a fractional order $\\alpha0$, their definitions are constructed based on the Riemann-Liouville fractional integral, ${}_0I_t^\\alpha$.\n\nThe left-sided Riemann-Liouville fractional integral of order $\\alpha0$ is defined as:\n$$\n{}_0I_t^\\alpha f(t) = \\frac{1}{\\Gamma(\\alpha)} \\int_0^t (t-\\tau)^{\\alpha-1} f(\\tau) \\,d\\tau\n$$\nwhere $\\Gamma(\\alpha)$ is the Euler Gamma function.\n\nFor a fractional order $\\alpha$ such that $0  \\alpha  1$, the Riemann-Liouville and Caputo fractional derivatives are defined as follows:\n\n1.  **The Riemann-Liouville (RL) fractional derivative** is defined by first applying the fractional integral of order $1-\\alpha$, and then a standard integer-order derivative:\n    $$\n    {}_0^R D_t^\\alpha f(t) = \\frac{d}{dt} \\left( {}_0I_t^{1-\\alpha} f(t) \\right)\n    $$\n\n2.  **The Caputo fractional derivative** is defined by reversing the order of operations—first applying a standard integer-order derivative, then a fractional integral of order $1-\\alpha$:\n    $$\n    {}_0^C D_t^\\alpha f(t) = {}_0I_t^{1-\\alpha} \\left( \\frac{d}{dt} f(t) \\right)\n    $$\n\nThese two definitions are not generally equivalent, and the choice between them has significant implications in physical and engineering models.\n\n**Problem:**\nFor the function $f(t) = t$ defined on $t0$ and a fractional order $\\alpha \\in(0,1)$, derive from first principles the expression for the difference $\\Delta(t) = {}_0^R D_t^\\alpha f(t) - {}_0^C D_t^\\alpha f(t)$. The final answer should be a simplified expression.",
            "solution": "We use the definitions for $0\\alpha1$ and $f(t)=t$.\n\n1. Riemann–Liouville fractional integral of order $1-\\alpha$:\n$$\n{}_0I_t^{1-\\alpha}t\n=\\frac{1}{\\Gamma(1-\\alpha)}\n\\int_{0}^{t}(t-\\tau)^{-\\alpha} \\tau \\,d\\tau\n=\\frac{1}{\\Gamma(1-\\alpha)} t^{2-\\alpha} B(2,1-\\alpha)\n=\\frac{t^{2-\\alpha}}{\\Gamma(3-\\alpha)}.\n$$\n\n2. Riemann–Liouville derivative:\n$$\n{}_0^R D_t^\\alpha t\n=\\frac{d}{dt}\\left({}_0I_t^{1-\\alpha}t\\right)\n=\\frac{d}{dt}\\left(\\frac{t^{2-\\alpha}}{\\Gamma(3-\\alpha)}\\right)\n=\\frac{2-\\alpha}{\\Gamma(3-\\alpha)} t^{1-\\alpha}.\n$$\n\n3. Caputo derivative:\n$$\n{}_0^C D_t^\\alpha t\n={}_0I_t^{1-\\alpha}(1)\n=\\frac{1}{\\Gamma(1-\\alpha)}\n\\int_{0}^{t}(t-\\tau)^{-\\alpha} \\,d\\tau\n=\\frac{t^{1-\\alpha}}{\\Gamma(2-\\alpha)}.\n$$\n\n4. Difference:\n$$\n\\Delta(t)\n={}_0^R D_t^\\alpha t - {}_0^C D_t^\\alpha t\n=t^{1-\\alpha}\\left(\\frac{2-\\alpha}{\\Gamma(3-\\alpha)}-\\frac{1}{\\Gamma(2-\\alpha)}\\right)\n=0,\n$$\nsince $\\Gamma(3-\\alpha)=(2-\\alpha)\\Gamma(2-\\alpha)$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "After mastering the definitions, the next step is to understand how to approximate these operators numerically and analyze the quality of those approximations. This practice delves into the local truncation error of two common methods—the Grünwald-Letnikov formula and convolution quadrature—revealing how their accuracy is affected by the typical non-smooth behavior of solutions near the initial time . This analysis is crucial for understanding why standard numerical approaches can fail and for motivating the development of more sophisticated algorithms.",
            "id": "3368459",
            "problem": "Consider the approximation of the time-fractional Caputo derivative of order $\\alpha \\in (0,1)$ in the numerical solution of a Partial Differential Equation (PDE). The Caputo derivative of a sufficiently smooth function $u(t)$ is defined by\n$$\n{}^C D_t^\\alpha u(t) = \\frac{1}{\\Gamma(1-\\alpha)} \\int_{0}^{t} (t-\\tau)^{-\\alpha} u'(\\tau) \\,d\\tau,\n$$\nwhere $\\Gamma(\\cdot)$ is the Gamma function. Assume a uniform time grid $t_n=nh$ with $h0$ and integer $n\\ge 1$. Two widely used discrete operators for approximating ${}^C D_t^\\alpha u(t_n)$ are:\n- the backward Grünwald–Letnikov fractional difference, whose weights are the binomial coefficients $(-1)^{k}\\binom{\\alpha}{k}$;\n- the Lubich convolution quadrature generated by the trapezoidal rule, whose symbol is based on the rational approximation $\\delta(\\zeta) = \\frac{2(1-\\zeta)}{1+\\zeta}$.\n\nFor the test function $u(t)=t^{\\mu}$ with $\\mu0$ so that $u(0)=0$ and hence ${}^C D_t^\\alpha u(t)={}^\\text{RL}D_t^\\alpha u(t)$, determine the leading-order local truncation error for each method at $t_n$ as $h\\to 0$. That is, find constants $c_{\\mathrm{GL}}(\\alpha,\\mu)$ and $c_{\\mathrm{CQ}}(\\alpha,\\mu)$ such that\n$$\n\\mathcal{E}_{\\mathrm{GL}}(t_n; h) = c_{\\mathrm{GL}}(\\alpha,\\mu) h t_n^{\\mu-\\alpha-1} + \\mathcal{O}(h^2 t_n^{\\mu-\\alpha-2}),\n$$\nand\n$$\n\\mathcal{E}_{\\mathrm{CQ}}(t_n; h) = c_{\\mathrm{CQ}}(\\alpha,\\mu) h^2 t_n^{\\mu-\\alpha-2} + \\mathcal{O}(h^3 t_n^{\\mu-\\alpha-3}),\n$$\nunder the regularity conditions $\\mu\\alpha$ for the Grünwald–Letnikov approximation and $\\mu\\alpha+1$ for the trapezoidal-rule convolution quadrature. Express $c_{\\mathrm{GL}}(\\alpha,\\mu)$ and $c_{\\mathrm{CQ}}(\\alpha,\\mu)$ in closed form using $\\Gamma(\\cdot)$.\n\nIn addition, explain qualitatively how the exponents of $t_n$ in these leading terms reflect the sensitivity of each method to the regularity of the initial data near $t=0$, and what implications this has for time-step selection or correction strategies in fractional PDE solvers.\n\nProvide your final answer as a single row matrix containing $c_{\\mathrm{GL}}(\\alpha,\\mu)$ and $c_{\\mathrm{CQ}}(\\alpha,\\mu)$, with no units. No numerical rounding is required.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard task in the numerical analysis of fractional differential equations. The definitions, methods, and conditions provided are standard and consistent. Therefore, the problem is valid, and a solution is presented below.\n\nThe local truncation error for a numerical approximation $D_h^\\alpha$ of the continuous operator ${}^C D_t^\\alpha$ is defined as $\\mathcal{E}(t_n;h) = D_h^\\alpha u(t_n) - {}^C D_t^\\alpha u(t_n)$. We analyze the two specified methods for the test function $u(t) = t^{\\mu}$ with $\\mu0$.\n\nFirst, we determine the exact derivative. Since $u(0) = 0$ for $\\mu  0$, the Caputo derivative ${}^C D_t^\\alpha u(t)$ is equivalent to the Riemann-Liouville (RL) derivative ${}^\\text{RL}D_t^\\alpha u(t)$. The standard formula for the RL derivative of a power function is\n$$\n{}^C D_t^\\alpha u(t) = {}^\\text{RL}D_t^\\alpha t^{\\mu} = \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu+1-\\alpha)} t^{\\mu-\\alpha}\n$$\nThis formula is valid for $\\mu  -1$, which is satisfied by the condition $\\mu0$.\n\nNext, we analyze each numerical method by examining the symbol of the corresponding discrete operator in the Laplace domain (with variable $s$) and comparing it to the symbol $s^\\alpha$ of the exact fractional derivative operator $D_t^\\alpha$. The error operator is the difference between the discrete and continuous operators.\n\n**1. Backward Grünwald–Letnikov (GL) Approximation**\n\nThe backward GL operator is defined by its action on the time grid, which can be expressed in terms of the backward shift operator $B$, where $B u(t_n) = u(t_{n-1})$:\n$$\nD_{h,\\mathrm{GL}}^\\alpha u(t_n) = h^{-\\alpha} \\sum_{k=0}^{n} (-1)^k \\binom{\\alpha}{k} u(t_{n-k}) = h^{-\\alpha} (1-B)^\\alpha u(t_n)\n$$\nIn the Laplace domain, the shift operator $B$ corresponds to multiplication by $e^{-sh}$. Thus, the symbol of the GL operator is\n$$\n\\sigma_{\\mathrm{GL}}(s) = \\left(\\frac{1-e^{-sh}}{h}\\right)^{\\alpha}\n$$\nTo find the leading-order error, we expand this symbol for small $s$ (which corresponds to slow variations in time, or large wavelengths):\n$$\ne^{-sh} = 1 - sh + \\frac{(sh)^2}{2} - \\frac{(sh)^3}{6} + \\mathcal{O}((sh)^4)\n$$\nSubstituting this into the symbol's expression gives\n$$\n\\frac{1-e^{-sh}}{h} = \\frac{1 - \\left(1 - sh + \\frac{1}{2}s^2h^2 - \\dots\\right)}{h} = s - \\frac{1}{2} s^2 h + \\mathcal{O}(h^2)\n$$\nNow, we raise this to the power of $\\alpha$ using the generalized binomial theorem $(1+x)^a = 1 + ax + \\mathcal{O}(x^2)$:\n$$\n\\sigma_{\\mathrm{GL}}(s) = \\left(s - \\frac{1}{2} s^2 h + \\mathcal{O}(h^2)\\right)^{\\alpha} = s^\\alpha \\left(1 - \\frac{1}{2} s h + \\mathcal{O}(h^2)\\right)^{\\alpha} = s^\\alpha \\left(1 - \\frac{\\alpha}{2} s h + \\mathcal{O}(h^2)\\right) = s^\\alpha - \\frac{\\alpha h}{2} s^{\\alpha+1} + \\mathcal{O}(h^2)\n$$\nThe symbol of the error operator is $\\sigma_{\\mathrm{GL}}(s) - s^\\alpha = -\\frac{\\alpha h}{2} s^{\\alpha+1} + \\mathcal{O}(h^2)$.\nThis means the leading term of the error operator is $-\\frac{\\alpha h}{2} D_t^{\\alpha+1}$. Applying this operator to the test function $u(t) = t^\\mu$ gives the leading term of the local truncation error:\n$$\n\\mathcal{E}_{\\mathrm{GL}}(t_n;h) \\approx -\\frac{\\alpha h}{2} {}^\\text{RL}D_t^{\\alpha+1} t^{\\mu} \\Big|_{t=t_n}\n$$\nUsing the formula for the RL derivative of a power function:\n$$\n\\mathcal{E}_{\\mathrm{GL}}(t_n;h) \\approx -\\frac{\\alpha h}{2} \\left( \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu+1-(\\alpha+1))} t^{\\mu-(\\alpha+1)} \\right) \\Big|_{t=t_n} = -\\frac{\\alpha h}{2} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha)} t_n^{\\mu-\\alpha-1}\n$$\nThis expression is valid under the condition $\\mu  \\alpha$, ensuring the argument of the Gamma function in the denominator is not a non-positive integer.\nComparing this with the given form $\\mathcal{E}_{\\mathrm{GL}}(t_{n};h) = c_{\\mathrm{GL}}(\\alpha,\\mu) h t_n^{\\mu-\\alpha-1} + \\dots$, we identify the constant as\n$$\nc_{\\mathrm{GL}}(\\alpha,\\mu) = -\\frac{\\alpha}{2} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha)}\n$$\n\n**2. Lubich Convolution Quadrature (CQ) with Trapezoidal Rule**\n\nThe symbol for this approximation is given as $(\\delta(e^{-sh})/h)^\\alpha$, with $\\delta(\\zeta) = \\frac{2(1-\\zeta)}{1+\\zeta}$. The operator symbol is thus\n$$\n\\sigma_{\\mathrm{CQ}}(s) = \\left(\\frac{1}{h} \\frac{2(1-e^{-sh})}{1+e^{-sh}}\\right)^{\\alpha}\n$$\nWe can simplify the fraction using hyperbolic functions:\n$$\n\\frac{1-e^{-sh}}{1+e^{-sh}} = \\frac{e^{sh/2}-e^{-sh/2}}{e^{sh/2}+e^{-sh/2}} = \\tanh\\left(\\frac{sh}{2}\\right)\n$$\nThe symbol becomes\n$$\n\\sigma_{\\mathrm{CQ}}(s) = \\left(\\frac{2}{h} \\tanh\\left(\\frac{sh}{2}\\right)\\right)^{\\alpha}\n$$\nWe expand $\\tanh(z)$ for small $z$: $\\tanh(z) = z - \\frac{z^3}{3} + \\mathcal{O}(z^5)$. With $z=sh/2$, we get\n$$\n\\frac{2}{h} \\tanh\\left(\\frac{sh}{2}\\right) = \\frac{2}{h} \\left( \\frac{sh}{2} - \\frac{1}{3}\\left(\\frac{sh}{2}\\right)^3 + \\mathcal{O}(h^5) \\right) = s - \\frac{s^3 h^2}{12} + \\mathcal{O}(h^4)\n$$\nRaising this to the power of $\\alpha$:\n$$\n\\sigma_{\\mathrm{CQ}}(s) = \\left(s - \\frac{s^3 h^2}{12} + \\mathcal{O}(h^4)\\right)^{\\alpha} = s^\\alpha \\left(1 - \\frac{s^2 h^2}{12} + \\mathcal{O}(h^4)\\right)^{\\alpha} = s^\\alpha \\left(1 - \\frac{\\alpha s^2 h^2}{12} + \\mathcal{O}(h^4)\\right) = s^\\alpha - \\frac{\\alpha h^2}{12} s^{\\alpha+2} + \\mathcal{O}(h^4)\n$$\nThe symbol of the error operator is $\\sigma_{\\mathrm{CQ}}(s) - s^\\alpha = -\\frac{\\alpha h^2}{12} s^{\\alpha+2} + \\mathcal{O}(h^4)$.\nThe leading term of the error operator is therefore $-\\frac{\\alpha h^2}{12} D_t^{\\alpha+2}$. Applying this to $u(t) = t^\\mu$:\n$$\n\\mathcal{E}_{\\mathrm{CQ}}(t_n;h) \\approx -\\frac{\\alpha h^2}{12} {}^\\text{RL}D_t^{\\alpha+2} t^{\\mu} \\Big|_{t=t_n} = -\\frac{\\alpha h^2}{12} \\left( \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu+1-(\\alpha+2))} t^{\\mu-(\\alpha+2)} \\right) \\Big|_{t=t_n} = -\\frac{\\alpha h^2}{12} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha-1)} t_n^{\\mu-\\alpha-2}\n$$\nThis is valid for $\\mu  \\alpha+1$. Comparing with the given form $\\mathcal{E}_{\\mathrm{CQ}}(t_n;h) = c_{\\mathrm{CQ}}(\\alpha,\\mu) h^2 t_n^{\\mu-\\alpha-2} + \\dots$, we find\n$$\nc_{\\mathrm{CQ}}(\\alpha,\\mu) = -\\frac{\\alpha}{12} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha-1)}\n$$\n\n**Qualitative Explanation**\n\nThe leading-order local truncation errors are $\\mathcal{E}_{\\mathrm{GL}} \\propto h t_n^{\\mu-\\alpha-1}$ and $\\mathcal{E}_{\\mathrm{CQ}} \\propto h^2 t_n^{\\mu-\\alpha-2}$. The exponent of $t_n$ in each term provides critical insight into the behavior of the error.\n\n**Sensitivity to Initial Regularity:** The parameter $\\mu$ in $u(t)=t^\\mu$ characterizes the regularity (smoothness) of the function at $t=0$. The exponents of $t_n$ are $\\mu-\\alpha-1$ for the GL method and $\\mu-\\alpha-2$ for the CQ method.\nFor typical solutions to fractional PDEs, the solution regularity $\\mu$ is coupled to the fractional order $\\alpha$. A common scenario is $\\mu \\approx \\alpha$, which models a weak singularity at the initial time.\nUnder the regularity requirement for the GL method, $\\mu  \\alpha$, the exponent $\\mu-\\alpha-1$ can be negative (e.g., if $\\alpha  \\mu  \\alpha+1$). Similarly, for the CQ method, requiring $\\mu  \\alpha+1$ allows the exponent $\\mu-\\alpha-2$ to be negative (e.g., if $\\alpha+1  \\mu  \\alpha+2$).\nA negative exponent $t_n^\\beta$ (with $\\beta  0$) signifies that the local truncation error is largest near $t=0$ (small $n$) and decays as $t_n$ increases. This indicates that both methods are highly sensitive to the low regularity of the solution at the beginning of the time interval. The CQ method's error term contains $t_n^{\\mu-\\alpha-2}$, which decays one power of $t_n$ faster than the GL error but also has a stronger singularity at $t=0$. Even though CQ is formally second-order in $h$, this large initial error can pollute the global solution, potentially negating the benefit of the higher order for a uniform time step.\n\n**Implications for Time-Stepping:** The unbounded nature of the local truncation error as $t \\to 0$ demonstrates that a uniform time step $h$ is suboptimal. The large errors generated in the first few steps can dominate the global error. To maintain accuracy, a much smaller time step is required near $t=0$ than at later times. This motivates two primary strategies in advanced fractional PDE solvers:\n$1$. **Graded Meshes:** The time grid is refined near $t=0$. A common choice is a power-law grid, $t_k = T(k/N)^r$, where $k=1, \\dots, N$ and the grading exponent $r \\ge 1$ is chosen to balance the error across the interval. A higher grading exponent $r$ leads to more refinement near $t=0$.\n$2$. **Starting Corrections:** A special, higher-order numerical method is used for the first few time steps to accurately resolve the initial singularity. After this initial phase, the solver switches back to the computationally cheaper main scheme (like GL or CQ) for the rest of the simulation, as the solution becomes smoother.\n\nIn summary, the exponents of $t_n$ in the error terms are a direct mathematical manifestation of the challenges posed by the non-local nature of the fractional derivative and the typical singular behavior of solutions at $t=0$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\alpha}{2} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha)}  -\\frac{\\alpha}{12} \\frac{\\Gamma(\\mu+1)}{\\Gamma(\\mu-\\alpha-1)} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Building upon the error analysis in the previous exercise, this problem transitions from analysis to design. Having identified that start-up singularities can degrade the convergence of numerical schemes on uniform grids, this practice guides you through engineering a solution: an optimally graded temporal mesh . By balancing the local approximation error with the error arising from the initial singularity, you will derive the precise mesh grading required to restore the method's full theoretical accuracy, a powerful technique used in state-of-the-art fractional PDE solvers.",
            "id": "3368445",
            "problem": "Consider the time-fractional diffusion-type initial value problem\n$$\n{}^C D_t^\\beta u(t) + \\mathcal{A} u(t) = f(t), \\quad t \\in (0,T], \\qquad u(0)=u_0,\n$$\nwhere $0\\beta1$, ${}^C D_t^\\beta$ denotes the Caputo fractional derivative, and $\\mathcal{A}$ is a sectorial spatial operator such that the solution $u$ is uniquely determined and depends continuously on the data. Recall the Caputo derivative of order $\\beta$ is defined by\n$$\n{}^C D_t^\\beta u(t) := \\frac{1}{\\Gamma(1-\\beta)} \\int_{0}^{t} (t-s)^{-\\beta} u'(s)\\,ds,\n$$\nwhich can be written in terms of the Riemann–Liouville fractional integral (order $1-\\beta$) as ${}^C D_t^\\beta u = I^{1-\\beta} u'$, where\n$$\nI^{\\nu}v(t) := \\frac{1}{\\Gamma(\\nu)}\\int_{0}^{t} (t-s)^{\\nu-1} v(s)\\,ds, \\quad \\nu0.\n$$\nAssume that the exact solution exhibits a start-up singularity of the form\n$$\nu(t) = u_0 + c t^{\\alpha} + \\text{higher-order terms as } t \\downarrow 0,\n$$\nfor some constants $c \\neq 0$ and $\\alpha \\in (0,1]$. Consider an L1-type time discretization (based on piecewise-linear reconstruction of $u$) on a graded temporal mesh $0=t_0t_1\\cdotst_N=T$ defined by\n$$\nt_n = T \\left(\\frac{n}{N}\\right)^{\\gamma}, \\quad n=0,1,\\dots,N,\n$$\nwith a grading parameter $\\gamma \\ge 1$. The L1-type approximation at $t_n$ replaces ${}^C D_t^\\beta u(t_n)$ by the Caputo derivative of the piecewise-linear interpolant of $u$ over the mesh, yielding a discrete convolution in time.\n\nStarting only from the definitions above and using first principles of consistency analysis for convolution quadrature based on piecewise-linear interpolation, derive the leading-order scaling of the temporal consistency error contributed by:\n1) the local approximation over the last time step near $t_n$, and\n2) the global accumulation of interpolation errors originating from the start-up singularity near $t=0$ transported by the fractional memory kernel.\n\nThen, by balancing these two contributions, determine the minimal grading parameter $\\gamma$ that recovers the design temporal convergence order of the L1-type scheme for smooth-in-time data, namely order $2-\\beta$ in $N$ at a fixed final time $T$. Your final answer must be a single closed-form analytic expression in terms of $\\alpha$ and $\\beta$ for the optimal $\\gamma$. No numerical evaluation is required, and no units are involved. State the final result for $\\gamma$ explicitly as a function of $\\alpha$ and $\\beta$.",
            "solution": "The problem requires the derivation of the minimal grading parameter $\\gamma$ for a temporal mesh used to solve a time-fractional diffusion equation. The derivation must be based on a consistency analysis that balances two sources of error: the local approximation error and the global error arising from a start-up singularity.\n\nLet the consistency error of the time discretization at time $t_n$ be $\\mathcal{T}_n$. The scheme approximates the Caputo derivative of the exact solution, ${}^C D_t^\\beta u(t_n)$, by the Caputo derivative of its piecewise linear interpolant on the graded mesh, which we denote by $\\Pi_1 u$. The error is thus:\n$$\n\\mathcal{T}_n = {}^C D_t^\\beta u(t_n) - {}^C D_t^\\beta(\\Pi_1 u)(t_n)\n$$\nUsing the definition of the Caputo fractional derivative, ${}^C D_t^\\beta v = I^{1-\\beta} v'$, we can write the error as:\n$$\n\\mathcal{T}_n = \\frac{1}{\\Gamma(1-\\beta)} \\int_{0}^{t_n} (t_n-s)^{-\\beta} \\left( u'(s) - (\\Pi_1 u)'(s) \\right) ds\n$$\nThe term $(\\Pi_1 u)'(s)$ is the derivative of the piecewise linear interpolant. On any given subinterval $[t_{k-1}, t_k]$, it is a constant equal to the slope of the secant line:\n$$\n(\\Pi_1 u)'(s) = \\frac{u(t_k) - u(t_{k-1})}{t_k - t_{k-1}} \\quad \\text{for } s \\in (t_{k-1}, t_k)\n$$\nWe can decompose the integral for $\\mathcal{T}_n$ into a sum over the time steps:\n$$\n\\mathcal{T}_n = \\sum_{k=1}^{n} \\frac{1}{\\Gamma(1-\\beta)} \\int_{t_{k-1}}^{t_k} (t_n-s)^{-\\beta} \\left( u'(s) - \\frac{u(t_k) - u(t_{k-1})}{t_k - t_{k-1}} \\right) ds\n$$\nThe total consistency error $\\mathcal{T}_n$ can be understood as originating from two distinct contributions as outlined in the problem statement. We analyze the scaling of each contribution with respect to the number of time steps, $N$.\n\n1.  **Leading-order scaling of the local consistency error.**\n\nThis contribution arises from the approximation error over the most recent time step, $[t_{n-1}, t_n]$. It reflects the accuracy of the scheme for a smooth solution. Let $\\tau_n = t_n - t_{n-1}$. For a sufficiently smooth function $u(t)$ (specifically, $u \\in C^2([t_{n-1}, t_n])$), the error in approximating the derivative $u'(s)$ by the constant secant slope over $[t_{n-1}, t_n]$ is $O(\\tau_n)$. A more detailed analysis for the integral form of the Caputo derivative approximation via piecewise linear interpolation shows that the local truncation error scales as $O(\\tau_n^{2-\\beta})$.\n\nThe graded mesh is defined by $t_n = T(n/N)^\\gamma$. The time step duration is $\\tau_n = t_n - t_{n-1} = T N^{-\\gamma} (n^\\gamma - (n-1)^\\gamma)$. For large $n$, e.g., $n \\approx N$, we can approximate this using the mean value theorem: $n^\\gamma - (n-1)^\\gamma \\approx \\gamma n^{\\gamma-1}$. Thus, at a fixed time $t_n=t$, where $n = N(t/T)^{1/\\gamma}$, the time step is:\n$$\n\\tau_n \\approx T N^{-\\gamma} \\gamma \\left(N(t/T)^{1/\\gamma}\\right)^{\\gamma-1} = T N^{-\\gamma} \\gamma N^{\\gamma-1} (t/T)^{1 - 1/\\gamma} = \\frac{T\\gamma}{N} \\left(\\frac{t}{T}\\right)^{1 - 1/\\gamma}\n$$\nThis shows that for any fixed time $t \\in (0, T]$, the local time step $\\tau_n$ is of order $O(N^{-1})$. Consequently, the local consistency error, which scales as $O(\\tau_n^{2-\\beta})$, has the following scaling with respect to $N$:\n$$\n\\text{Error (Local)} \\sim O\\left( (N^{-1})^{2-\\beta} \\right) = O\\left(N^{-(2-\\beta)}\\right)\n$$\nThis is the desired convergence order for smooth solutions.\n\n2.  **Leading-order scaling of the global error from the start-up singularity.**\n\nThis contribution arises from the accumulation of interpolation errors, particularly from the region near $t=0$ where the solution exhibits a singularity of the form $u(t) = u_0 + c t^\\alpha + O(t^{\\alpha})$ for $\\alpha \\in (0,1]$. This non-smooth behavior is poorly captured by linear interpolation on a uniform mesh. The graded mesh, with its refined steps near $t=0$, is designed to mitigate this.\n\nThe dominant part of this global error originates from the very first time step, $[t_0, t_1] = [0, t_1]$. The size of this interval is $t_1 = T(1/N)^\\gamma = T N^{-\\gamma}$. Over this interval, the function $u(t) - u_0 \\approx c t^\\alpha$ differs significantly from its linear interpolant, $(\\Pi_1 u)(t) - u_0 = \\frac{u(t_1)-u(t_0)}{t_1}t \\approx c t_1^{\\alpha-1} t$. The maximum difference between the function and its linear interpolant on $[0, t_1]$ is proportional to the overall variation of the function on that interval, which scales with $t_1^\\alpha$.\n$$\n\\max_{s \\in [0, t_1]} | (u(s)-u_0) - ((\\Pi_1 u)(s)-u_0) | \\sim O(t_1^\\alpha)\n$$\nSubstituting $t_1 = T N^{-\\gamma}$, the magnitude of the interpolation error generated in the first time step is of order:\n$$\nO\\left( (N^{-\\gamma})^\\alpha \\right) = O\\left(N^{-\\gamma\\alpha}\\right)\n$$\nThis initial large error is then propagated forward in time by the long-range memory of the fractional derivative kernel $(t_n-s)^{-\\beta}$. While the kernel's influence diminishes over time, the initial error's magnitude, determined by the mesh grading near $t=0$, dictates the scaling of this global error contribution. Therefore, the leading-order scaling of the error originating from the start-up singularity is:\n$$\n\\text{Error (Global/Singularity)} \\sim O\\left(N^{-\\gamma\\alpha}\\right)\n$$\n\n**Balancing the error contributions.**\n\nThe overall temporal consistency error of the L1-type scheme is dominated by the larger of these two error sources. The total error scaling is thus:\n$$\n\\mathcal{T}_{total} \\sim O\\left(N^{-(2-\\beta)}\\right) + O\\left(N^{-\\gamma\\alpha}\\right)\n$$\nTo recover the design convergence order of $2-\\beta$ (which is the best possible for this scheme), the error contribution from the singularity must not be the bottleneck. This requires the singularity error to decay at least as quickly as the local error. In terms of the exponents, this implies:\n$$\n\\gamma\\alpha \\ge 2-\\beta\n$$\nThe problem asks for the minimal grading parameter $\\gamma$ that achieves this. The minimal value corresponds to the case where the two error contributions are balanced, ensuring that the mesh is refined just enough to handle the singularity without being overly fine, which would be computationally inefficient. This balance is achieved when the exponents are equal:\n$$\n\\gamma\\alpha = 2-\\beta\n$$\nSolving for the minimal grading parameter $\\gamma$, we obtain the explicit expression:\n$$\n\\gamma = \\frac{2-\\beta}{\\alpha}\n$$\nThis choice of $\\gamma$ ensures that the error contribution from the start-up singularity matches the inherent local error of the scheme, thereby restoring the optimal convergence order of $2-\\beta$.",
            "answer": "$$\n\\rule{0pt}{2em}\n\\boxed{\\frac{2-\\beta}{\\alpha}}\n$$"
        }
    ]
}