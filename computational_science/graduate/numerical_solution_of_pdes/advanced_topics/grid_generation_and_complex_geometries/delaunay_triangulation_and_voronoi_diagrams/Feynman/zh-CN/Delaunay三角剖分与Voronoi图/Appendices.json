{
    "hands_on_practices": [
        {
            "introduction": "Delaunay三角剖分因其“最大化最小角”特性而在网格生成中备受青睐，该特性倾向于生成形状良好的三角形，避免产生影响数值解精度的“瘦长”单元。然而，在实际工程问题中，我们常常需要强制保留某些特定的边（例如，代表材料界面的边），这就引出了约束Delaunay三角剖分（CDT）的概念。这项实践  将通过一个具体的反例，探讨引入约束条件是否会牺牲Delaunay三角剖分的优良角度特性，从而揭示网格生成中的一个关键权衡。",
            "id": "3377055",
            "problem": "在椭圆偏微分方程的有限元离散化中，平面网格通常通过德劳内三角剖分生成，因为它具有良好的角度质量。回顾以下基本事实：对于平面上处于一般位置（没有四点共圆）的有限点集，德劳内三角剖分是满足空外接圆标准的三角剖分，并且在点集的所有三角剖分中，它能最大化最小角。在许多实际应用中，内部界面、断层或边界必须表示为网格必须包含的线段，这导致了约束德劳内三角剖分（CDT）的使用。在CDT中，每个约束段都必须作为网格边存在，并且德劳内空外接圆测试在有可见性限制的情况下应用；由于这些约束，CDT通常与无约束的德劳内三角剖分不一致。\n\n考虑以下挑战：确定一个具体的平面点集和一条约束边，使得强制包含该边必然会产生一个三角剖分，其最小角严格小于同一点集的无约束德劳内三角剖分所能达到的最小角。您的答案还必须说明最小角恶化的几何原因。请选择最佳选项。\n\nA. 取四个点 $A=(0,0)$, $B=(10,0)$, $C=(10,1)$, $D=(0,10)$，并强制约束线段 $BD$。在没有约束的情况下，用对角线 $AC$ 对凸四边形 $ABCD$ 进行三角剖分，会产生三角形 $ABC$ 和 $ACD$，其最小角约为 $5.71^\\circ$（在三角形 $ABC$ 的顶点 $A$ 处）。强制使用非德劳内对角线 $BD$ 则会产生三角形 $ABD$ 和 $BCD$，其最小角约为 $3.02^\\circ$（在三角形 $BCD$ 的顶点 $D$ 处）。其几何原因是，约束边 $BD$ 阻止了空外接圆标准本应执行的边翻转操作；被强制的对角线穿过一个更大的空圆并导致一个更细长的三角形，因此全局最大化最小角的属性在约束下丢失了。\n\nB. 取任意四个共圆点，并强制任一对角线作为约束边。因为在共圆情况下，两条对角线都通过了空外接圆测试，所以最大化最小角的属性在约束下得以保持。其几何原因是共圆性抵消了约束的影响。\n\nC. 在任何处于一般位置的非退化点集中，添加一条位于凸包边界上的约束线段不会改变三角剖分的最小角。其几何原因是边界边总是局部德劳内的。\n\nD. 取四个点 $A=(0,0)$, $B=(10,0)$, $C=(10,1)$, $D=(0,10)$，并强制约束线段 $AC$。与无约束三角剖分相比，这减小了最小角，因为约束边使得两个相邻三角形的空外接圆测试都失败，证明了在这种配置下，约束总是会使角度恶化。",
            "solution": "用户希望我找出一个正确的例子和解释，说明为什么约束德劳内三角剖分（CDT）的最小角可能小于同一点集的无约束德劳内三角剖分（DT）。\n\n### 步骤1：提取已知条件\n-   **背景**：椭圆偏微分方程有限元离散化的平面网格生成。\n-   **点集**：平面上处于“一般位置”的有限点集，定义为没有四点共圆。\n-   **德劳内三角剖分 (DT)**：定义为满足空外接圆标准的三角剖分。它具有在点集所有可能的三角剖分中最大化最小角的性质（最大最小角性质）。\n-   **约束德劳内三角剖分 (CDT)**：一种必须包含一组预定义线段（约束）作为边的三角剖分。空外接圆测试在有可见性限制的情况下应用。\n-   **核心任务**：确定一个具体的平面点集和一条约束边，使得得到的 CDT 的最小角严格小于无约束 DT 的最小角。提供这种恶化的几何原因。\n\n### 步骤2：使用已知条件进行验证\n问题陈述在科学上是合理的、适定的和客观的。它正确地定义了德劳内三角剖分、其最大最小角性质以及约束德劳内三角剖分的性质等关键概念。CDT 可能不满足最大最小角性质这一前提是计算几何中的一个标准结论。任务是通过一个例子提供一个构造性证明，这是一个有效且可验证的问题结构。对点集（一般位置）的约束已明确说明。该问题没有违反任何指定的无效标准。\n\n### 步骤3：判断与行动\n问题有效。我将继续推导解决方案并评估每个选项。\n\n### 基于原理的推导\n问题的核心在于强制性约束与无约束德劳内三角剖分性质之间的冲突。一个点集的 DT 是唯一的（对于处于一般位置的点），并且它最大化了网格中所有三角形的最小角。这是通过空外接圆标准实现的。一种常见的实现方式是通过边翻转算法：对于由两个相邻三角形组成的任何凸四边形，如果其对角线是“非法”的（即，第四个顶点位于由该对角线和第三个顶点组成的三角形的外接圆内部），则将其“翻转”为另一条对角线。这个过程保证会终止并得到 DT，并且每次翻转都会局部地增加最小角。\n\n约束德劳内三角剖分 (CDT) 必须将某些线段作为边包含在内。如果一个约束线段在无约束 DT 中不是一条边，CDT 算法必须强制将其加入网格。这会阻止任何可能移除该约束线段的边翻转操作。如果该约束线段是点集中一个凸四边形的“非法”对角线，强制包含它会阻止向合法的（德劳内）对角线进行的、能够改善角度的翻转。因此，最终得到的三角剖分不是真正的 DT，其最小角可能（且通常）小于 DT 的最小角。\n\n为了构造所需的例子，我们需要四个点构成一个凸四边形，比如 $A, B, C, D$。我们先确定德劳内对角线（例如 $AC$），然后强制将非德劳内对角线（$BD$）作为约束。根据 DT 的最大最小角性质，使用非德劳内对角线的三角剖分的最小角必须小于或等于 DT 的最小角。在非退化的情况下，它将严格小于。\n\n### 逐项分析\n\n**A. 取四个点 $A=(0,0)$, $B=(10,0)$, $C=(10,1)$, $D=(0,10)$，并强制约束线段 $BD$。在没有约束的情况下，用对角线 $AC$ 对凸四边形 $ABCD$ 进行三角剖分，会产生三角形 $ABC$ 和 $ACD$，其最小角约为 $5.71^\\circ$（在三角形 $ABC$ 的顶点 $A$ 处）。强制使用非德劳内对角线 $BD$ 则会产生三角形 $ABD$ 和 $BCD$，其最小角约为 $3.02^\\circ$（在三角形 $BCD$ 的顶点 $D$ 处）。其几何原因是，约束边 $BD$ 阻止了空外接圆标准本应执行的边翻转操作；被强制的对角线穿过一个更大的空圆并导致一个更“瘦”的三角形，因此全局最大化最小角的属性在约束下丢失了。**\n\n让我们一步步验证这个选项。\n1.  **点集**：$A=(0,0)$, $B=(10,0)$, $C=(10,1)$, $D=(0,10)$。这四个点构成一个凸四边形。\n2.  **无约束 DT**：DT 将使用对角线 $AC$ 或 $BD$。我们必须确定哪一个是德劳内边。如果通过一条边的两个端点可以作一个不包含点集中任何其他点的外接圆，那么这条边就是德劳内边。对于对角线 $AC$，我们分别检查点 $B$ 是否在 $\\triangle ACD$ 的外接圆内，以及点 $D$ 是否在 $\\triangle ABC$ 的外接圆内。\n    -   对于 $\\triangle ABC$：顶点 $A(0,0), B(10,0), C(10,1)$。这是一个直角三角形，直角位于 $B = (10,0)$，因为 $\\vec{BA} = (-10,0)$ 和 $\\vec{BC} = (0,1)$ 正交。外接圆心是斜边 $AC$ 的中点，即 $(5, 0.5)$。外接圆半径的平方是 $R^2 = (5-0)^2 + (0.5-0)^2 = 25 + 0.25 = 25.25$。从外接圆心到点 $D(0,10)$ 的距离平方是 $d^2 = (5-0)^2 + (0.5-10)^2 = 25 + (-9.5)^2 = 25 + 90.25 = 115.25$。由于 $d^2 > R^2$，$D$ 在 $\\triangle ABC$ 的外接圆之外。\n    -   因此，对角线 $AC$ 是一条德劳内边。无约束 DT 由三角形 $\\triangle ABC$ 和 $\\triangle ACD$ 组成。\n3.  **DT的最小角**：\n    -   在 $\\triangle ABC$ 中：这是一个直角三角形。角度分别是 $B$ 处的 $90^\\circ$，$\\angle BAC = \\arctan(|BC|/|AB|) = \\arctan(1/10) \\approx 5.71^\\circ$，以及 $\\angle BCA = \\arctan(|AB|/|BC|) = \\arctan(10) \\approx 84.29^\\circ$。\n    -   在 $\\triangle ACD$ 中：顶点 $A(0,0), C(10,1), D(0,10)$。边长为 $|AC|=\\sqrt{101}$, $|AD|=10$, $|CD|=\\sqrt{(10-0)^2+(1-10)^2}=\\sqrt{100+81}=\\sqrt{181}$。使用余弦定理，可以发现所有角都大于 $5.71^\\circ$ 的锐角。例如，$\\cos(\\angle DAC) = (|AD|^2+|AC|^2-|CD|^2)/(2|AD||AC|) = (100+101-181)/(20\\sqrt{101}) = 20/(20\\sqrt{101}) = 1/\\sqrt{101}$，所以 $\\angle DAC \\approx 84.3^\\circ$。\n    -   因此，DT 的最小角确实约为 $5.71^\\circ$。\n4.  **约束三角剖分**：约束是非德劳内对角线 $BD$。这强制三角剖分为 $\\{\\triangle ABD, \\triangle BCD\\}$。\n5.  **CDT的最小角**：\n    -   在 $\\triangle ABD$ 中：顶点 $A(0,0), B(10,0), D(0,10)$。这是一个等腰直角三角形。角度是 $A$ 处的 $90^\\circ$，以及 $B$ 和 $D$ 处的 $45^\\circ$。\n    -   在 $\\triangle BCD$ 中：顶点 $B(10,0), C(10,1), D(0,10)$。边长为 $|BC|=1$, $|BD|=\\sqrt{(10-0)^2+(0-10)^2}=\\sqrt{200}$, $|CD|=\\sqrt{181}$。我们使用余弦定理来求角度。最小角将与最短边 $|BC|$ 相对，即 $\\angle BDC$。\n    -   $\\cos(\\angle BDC) = (|BD|^2+|CD|^2-|BC|^2)/(2|BD||CD|) = (200+181-1)/(2\\sqrt{200}\\sqrt{181}) = 380/(2\\cdot10\\sqrt{2}\\cdot\\sqrt{181}) = 19/\\sqrt{362}$。\n    -   $\\angle BDC = \\arccos(19/\\sqrt{362}) \\approx \\arccos(0.9986) \\approx 3.01^\\circ$。选项中的 $3.02^\\circ$ 是一个合理的近似值。\n    -   这个 CDT 的最小角约为 $3.02^\\circ$，严格小于 DT 的最小角 $\\approx 5.71^\\circ$。\n6.  **几何原因**：所提供的解释完全正确。强制使用非德劳内边 $BD$ 阻止了三角剖分翻转到具有边 $AC$ 的德劳内构型。这次翻转本可以增加最小角。由于翻转被阻止，三角剖分被困在一个具有较小最小角的状态，从而失去了最大最小角的最优性。\n**结论**：**正确**。\n\n**B. 取任意四个共圆点，并强制任一对角线作为约束边。因为在共圆情况下，两条对角线都通过了空外接圆测试，所以最大化最小角的属性在约束下得以保持。其几何原因是共圆性抵消了约束的影响。**\n问题陈述明确要求点处于“一般位置”，定义为“没有四点共圆”。这个选项违反了这一基本前提。此外，在共圆的情况下，无约束 DT 不是唯一的；两条对角线都有效。约束其中一条只是选择了其中一个可能的 DT。它并没有强制一个非德劳内构型，而这正是问题要求用来证明角度恶化的机制。\n**结论**：**错误**。\n\n**C. 在任何处于一般位置的非退化点集中，添加一条位于凸包边界上的约束线段不会改变三角剖分的最小角。其几何原因是边界边总是局部德劳内的。**\n这个陈述在事实上是正确的。凸包的边总是德劳内三角剖分的一部分。约束这样一条边不会增加任何新信息，也不会改变由无约束 DT 产生的三角剖分。然而，问题要求的是一个最小角*严格变小*的例子。这个选项描述的是一个角度不变的情形。因此，它没有回答所提出的问题。\n**结论**：**错误**。\n\n**D. 取四个点 $A=(0,0), B=(10,0), C=(10,1), D=(0,10)$，并强制约束线段 $AC$。与无约束三角剖分相比，这减小了最小角，因为约束边使得两个相邻三角形的空外接圆测试都失败，证明了在这种配置下，约束总是会使角度恶化。**\n正如在选项A的分析中确定的，对角线 $AC$ 是该点集的德劳内对角线。无约束 DT 是 $\\{\\triangle ABC, \\triangle ACD\\}$。如果我们强制约束 $AC$，得到的 CDT 与无约束 DT 完全相同。因此，最小角没有减小。声称这个约束“使得空外接圆测试失败”是错误的；因为 $AC$ 是一条德劳内边，它通过了测试。其推理有缺陷，主要结论在事实上是错误的。\n**结论**：**错误**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "我们已经知道，非Delaunay三角剖分可能包含角度更差的三角形，但这在数值模拟中究竟会带来什么具体后果呢？这项实践  深入探讨了网格几何形状与对流扩散方程数值格式稳定性之间的深刻联系。你将发现，在对流占主导（即高佩克莱数 $Pe \\gg 1$）的情况下，局部Delaunay条件（即任意共享边所对的两内角之和小于等于 $\\pi$）对于抑制解的非物理振荡至关重要。",
            "id": "3377002",
            "problem": "考虑在一个多边形区域上具有常系数的稳态二维对流扩散方程，\n$$\n- \\varepsilon \\nabla^2 u + \\boldsymbol{b} \\cdot \\nabla u = 0,\n$$\n其中狄利克雷数据在边界的流入部分指定。假设采用间断伽辽金(DG)格式，对扩散项使用对称内部罚，对对流项使用迎风数值通量，每个单元上使用线性多项式阶数。设特征网格尺寸为$h$，扩散系数为$\\varepsilon$，恒定速度为$\\boldsymbol{b}$，单元佩克莱数定义为\n$$\nPe = \\frac{\\lVert \\boldsymbol{b} \\rVert h}{2 \\varepsilon},\n$$\n我们关注的区域是 $Pe \\gg 1$。\n\n从以下基本依据和核心定义出发：\n- 平面点集的德劳内(Delaunay)三角剖分是指这样一种三角剖分，其中每个三角形的开放外接圆不包含该三角剖分的任何顶点。等价地，对于共享一条内部边的两个三角形，局部德劳内准则指出，公共边所对的两个角之和最多为$\\pi$。这与沃罗诺伊(Voronoi)图紧密相关，因为德劳内三角剖分是沃罗诺伊图的直线对偶，并且局部德劳内条件等价于沃罗诺伊边位于相应原始边的垂直平分线段内。\n- 对于二维扩散的分片线性近似，跨越一条内部边的两个节点之间基于边的刚度耦合的对称部分，与该边所对的两个角$\\alpha$和$\\beta$的余切之和成正比，即$\\tfrac{1}{2}(\\cot \\alpha + \\cot \\beta)$。使用三角恒等式，\n$$\n\\cot \\alpha + \\cot \\beta = \\frac{\\sin(\\alpha + \\beta)}{\\sin \\alpha \\, \\sin \\beta},\n$$\n此耦合的符号由$\\sin(\\alpha + \\beta)$决定。特别地，当且仅当$\\alpha + \\beta \\le \\pi$（局部德劳内条件）时，它为非负。\n- 在带有内部罚的DG格式中，用于扩散项的跨内部边的对称内部一致性项再现了与连续分片线性扩散离散相同的符号结构。迎风对流通量在离散算子矩阵中贡献了非正的非对角元。一个充分的边单调性条件（因此也是防止伪振荡的离散极值原理）是，全局矩阵中的每个内部边都具有非正的非对角元。对于$Pe \\gg 1$的情况，如果一条内部边几乎与$\\boldsymbol{b}$切向对齐（因此跨该边的$|\\boldsymbol{b} \\cdot \\boldsymbol{n}|$很小），那么对流的贡献就太弱，无法抵消任何由扩散产生的正非对角元。因此，任何违反局部德劳内条件的情况，即任何满足$\\alpha + \\beta > \\pi$的内部边，都可能引发伪振荡。\n\n任务。您必须：\n- 从上述依据出发，推导出一个在高佩克莱数区域中振荡起始的纯几何阈值。您的推导必须表明，对于由两个三角形共享的一条内部边，其对角分别为$\\alpha$和$\\beta$（以弧度表示），当且仅当$\\alpha + \\beta > \\pi$时，预测会出现伪振荡。\n- 实现一个完整、可运行的程序，该程序给定一个由沿对角线分割四边形形成的平面双三角形网格构成的小型测试套件，为每个测试用例计算：\n  1. 对角线对角之和 $\\alpha + \\beta$（以弧度为单位）。\n  2. 一个布尔指示符，当且仅当 $\\alpha + \\beta > \\pi$（预测有振荡）时为真，否则（无振荡）为假。\n- 您必须在整个过程中使用弧度作为角度单位。您的输出中除了弧度外，不需要其他物理单位。\n\n测试套件。使用以下五个案例，每个案例由四个点和一条选定的对角线定义，该对角线将其分割成两个三角形。在每个案例中，内部边是连接所列第一和第三个点的对角线。点以笛卡尔坐标给出：\n- 案例 1：$\\left(0,0\\right)$、$\\left(1,0\\right)$、$\\left(1,1\\right)$、$\\left(0,1\\right)$；对角线连接$\\left(0,0\\right)$和$\\left(1,1\\right)$。\n- 案例 2：$\\left(0,0\\right)$、$\\left(0.6,0.58\\right)$、$\\left(1,1\\right)$、$\\left(0.4,0.44\\right)$；对角线连接$\\left(0,0\\right)$和$\\left(1,1\\right)$。\n- 案例 3：$\\left(0,0\\right)$、$\\left(1,0.2\\right)$、$\\left(1,1\\right)$、$\\left(0.2,1\\right)$；对角线连接$\\left(0,0\\right)$和$\\left(1,1\\right)$。\n- 案例 4：$\\left(0,0\\right)$、$\\left(0.51,0.49\\right)$、$\\left(1,1\\right)$、$\\left(0.49,0.51\\right)$；对角线连接$\\left(0,0\\right)$和$\\left(1,1\\right)$。\n- 案例 5：$\\left(0,0\\right)$、$\\left(0.75,0.70\\right)$、$\\left(1,1\\right)$、$\\left(0.25,0.30\\right)$；对角线连接$\\left(0,0\\right)$和$\\left(1,1\\right)$。\n\n对于每个测试，将这四个点解释为定义了两个共享对角线 $\\overline{p_0 p_2}$ 的三角形 $\\triangle \\left(p_0,p_1,p_2\\right)$ 和 $\\triangle \\left(p_0,p_3,p_2\\right)$。两个对角分别位于顶点 $p_1$ 和 $p_3$；计算它们的和 $\\alpha + \\beta$（以弧度为单位）。然后评估上面定义的布尔预测振荡指示符。\n\n最终输出格式。您的程序应生成一行输出，其中包含五个案例的布尔结果，格式为逗号分隔的列表，并用方括号括起来，例如 $\\left[\\mathrm{False},\\mathrm{True},\\ldots\\right]$。",
            "solution": "该任务是为稳态对流扩散方程的间断伽辽金(DG)数值格式推导一个用于判断伪振荡起始的纯几何阈值，然后实现一个程序，将此阈值应用于一组测试用例。分析在对流占主导地位的高佩克莱数区域 ($Pe \\gg 1$) 进行。\n\n控制方程为 $- \\varepsilon \\nabla^2 u + \\boldsymbol{b} \\cdot \\nabla u = 0$。数值解没有伪振荡的一个充分条件是它满足离散极值原理。这通常可以通过确保全局系统矩阵（我们称之为 $A$）是一个M-矩阵来保证，这要求其所有非对角元都是非正的。\n\n矩阵 $A$ 由 DG 离散化产生。对于网格中两个单元（三角形）之间共享的任何内部边，跨此边耦合自由度的 $A$ 的非对角元是扩散项贡献 $A_D$ 和对流项贡献 $A_C$ 的总和。我们必须分析总非对角元 $A_{ij} = (A_D)_{ij} + (A_C)_{ij}$ 的符号。\n\n1.  **扩散项的贡献 ($A_D$)**：问题对扩散项 $- \\varepsilon \\nabla^2 u$ 使用对称内部罚伽辽金(SIPG)方法。问题陈述断言，所得矩阵元的符号结构与标准连续分片线性有限元法相同。对于算子 $-\\nabla^2 u$，与两个三角形共享的一条边相对应的非对角刚度矩阵元与 $-(\\cot \\alpha + \\cot \\beta)$ 成正比，其中 $\\alpha$ 和 $\\beta$ 是此公共边所对的角。扩散系数 $\\varepsilon$ 是一个正常数比例因子。因此，扩散项贡献的符号与 $-(\\cot \\alpha + \\cot \\beta)$ 的符号相同。\n\n    使用三角恒等式 $\\cot \\alpha + \\cot \\beta = \\frac{\\sin(\\alpha + \\beta)}{\\sin \\alpha \\sin \\beta}$，由于 $\\alpha, \\beta \\in (0, \\pi)$ 意味着 $\\sin\\alpha > 0$ 和 $\\sin\\beta > 0$，扩散贡献的符号变为 $-\\sin(\\alpha + \\beta)$ 的符号。\n    -   如果局部德劳内条件 $\\alpha + \\beta \\le \\pi$ 成立，则 $\\sin(\\alpha + \\beta) \\ge 0$，这使得扩散贡献 $(A_D)_{ij}$ 为非正。这是一个稳定项。\n    -   如果局部德劳内条件被违反，即 $\\alpha + \\beta > \\pi$，则 $\\sin(\\alpha + \\beta)  0$，这使得扩散贡献 $(A_D)_{ij}$ 为正。正的非对角元违反了M-矩阵条件，可能导致不稳定性。\n\n2.  **对流项的贡献 ($A_C$)**：对流项 $\\boldsymbol{b} \\cdot \\nabla u$ 使用迎风数值通量进行离散化。如问题中所述，这种选择是稳定的，并为系统矩阵的非对角线贡献非正元，即 $(A_C)_{ij} \\le 0$。\n\n3.  **总非对角元和高佩克莱数分析**：总非对角元为 $A_{ij} = (A_D)_{ij} + (A_C)_{ij}$。\n    -   如果 $\\alpha + \\beta \\le \\pi$ (德劳内边)，则 $(A_D)_{ij} \\le 0$ 和 $(A_C)_{ij} \\le 0$，所以 $A_{ij} \\le 0$。该边满足M-矩阵条件，预计不会由此产生振荡。\n    -   如果 $\\alpha + \\beta  \\pi$ (非德劳内边)，则 $(A_D)_{ij}  0$。$A_{ij}$ 的整体符号现在取决于正的扩散项和负的对流项之间的竞争。M-矩阵条件仅在 $|(A_C)_{ij}| \\ge (A_D)_{ij}$ 时成立。\n\n    对于高佩克莱数区域 ($Pe \\gg 1$) 的关键见解在问题陈述中已经给出。跨越一条单位法向量为 $\\boldsymbol{n}_e$ 的边 $e$ 的稳定迎风通量的大小取决于量 $|\\boldsymbol{b} \\cdot \\boldsymbol{n}_e|$。如果流向 $\\boldsymbol{b}$ 几乎与边 $e$ 相切，那么 $\\boldsymbol{b}$ 几乎与 $\\boldsymbol{n}_e$ 正交，因此 $|\\boldsymbol{b} \\cdot \\boldsymbol{n}_e|$ 变得非常小。在这种情况下，无论 $\\lVert\\boldsymbol{b}\\rVert$ 的大小或 $\\varepsilon$ 的小值如何，稳定贡献 $(A_C)_{ij}$ 都可以变得任意弱。\n\n    由于恒定速度 $\\boldsymbol{b}$ 相对于网格的方向是任意的，一个鲁棒的格式应该对任何 $\\boldsymbol{b}$ 都稳定。如果网格包含一条 $\\alpha + \\beta  \\pi$ 的边，总可以选择一个几乎平行于该边的流向 $\\boldsymbol{b}$。对于这样的流动，稳定的迎风项消失，非对角元的符号由正的扩散项主导：$A_{ij} \\approx (A_D)_{ij}  0$。这种对M-矩阵条件的违反是引发伪振荡的众所周知的触发器。\n\n    因此，振荡的可能性从根本上与网格几何本身相关。纯几何条件 $\\alpha + \\beta  \\pi$ 是预测高佩克莱数极限下振荡起始的充分准则，因为它表明存在一种将引发不稳定性的“最坏情况”流向。\n\n计算任务是为每个给定的网格配置计算角 $\\alpha$ 和 $\\beta$ 的和，并检查它是否超过 $\\pi$。这些角是在共享对角线对面的顶点处计算的。对于具有顶点 $P_1, P_2, P_3$ 的三角形，顶点 $P_2$ 处的角 $\\theta$ 可以使用向量 $\\vec{v}_{21} = P_1 - P_2$ 和 $\\vec{v}_{23} = P_3 - P_2$ 的点积公式计算：\n$$\n\\theta = \\arccos\\left( \\frac{\\vec{v}_{21} \\cdot \\vec{v}_{23}}{\\lVert\\vec{v}_{21}\\rVert \\lVert\\vec{v}_{23}\\rVert} \\right)\n$$\n程序将为每个测试用例实现此计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing the geometry of five two-triangle meshes.\n    For each mesh, it computes the sum of the angles opposite the common\n    diagonal and determines if this sum exceeds pi, which is the criterion\n    for predicting numerical oscillations in a high-Peclet number regime.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case has four points p0, p1, p2, p3. The triangles are\n    # (p0, p1, p2) and (p0, p3, p2), sharing the diagonal p0-p2.\n    # The angles of interest, alpha and beta, are at p1 and p3 respectively.\n    test_cases = [\n        # Case 1: Square, Delaunay diagonal.\n        {'p0':_p([0,0]), 'p1':_p([1,0]), 'p2':_p([1,1]), 'p3':_p([0,1])},\n        # Case 2: Convex quad, non-Delaunay diagonal.\n        {'p0':_p([0,0]), 'p1':_p([0.6,0.58]), 'p2':_p([1,1]), 'p3':_p([0.4,0.44])},\n        # Case 3: Concave quad, non-Delaunay diagonal.\n        {'p0':_p([0,0]), 'p1':_p([1,0.2]), 'p2':_p([1,1]), 'p3':_p([0.2,1])},\n        # Case 4: Sliver quad, highly non-Delaunay.\n        {'p0':_p([0,0]), 'p1':_p([0.51,0.49]), 'p2':_p([1,1]), 'p3':_p([0.49,0.51])},\n        # Case 5: Convex quad, non-Delaunay.\n        {'p0':_p([0,0]), 'p1':_p([0.75,0.70]), 'p2':_p([1,1]), 'p3':_p([0.25,0.30])},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        p0, p1, p2, p3 = case['p0'], case['p1'], case['p2'], case['p3']\n        \n        # Calculate angle alpha at p1 for triangle (p0, p1, p2).\n        alpha = _calculate_angle(p0, p1, p2)\n        \n        # Calculate angle beta at p3 for triangle (p0, p3, p2).\n        beta = _calculate_angle(p0, p3, p2)\n        \n        angle_sum = alpha + beta\n        \n        # The geometry-only threshold for predicted oscillations is alpha + beta > pi.\n        # This corresponds to the diagonal violating the local Delaunay condition.\n        oscillation_predicted = angle_sum > np.pi\n        \n        results.append(oscillation_predicted)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _p(coords):\n    \"\"\"Helper function to create a numpy array from coordinates.\"\"\"\n    return np.array(coords, dtype=np.float64)\n\ndef _calculate_angle(pA, pB, pC):\n    \"\"\"\n    Calculates the angle at vertex pB in triangle pA-pB-pC in radians.\n    \n    Args:\n        pA, pB, pC: Numpy arrays representing the coordinates of the vertices.\n        \n    Returns:\n        The angle at pB in radians.\n    \"\"\"\n    # Vectors from pB to pA and pC\n    vec_BA = pA - pB\n    vec_BC = pC - pB\n    \n    # Dot product of the two vectors\n    dot_product = np.dot(vec_BA, vec_BC)\n    \n    # Product of the magnitudes (norms) of the vectors\n    norm_product = np.linalg.norm(vec_BA) * np.linalg.norm(vec_BC)\n    \n    # To prevent domain errors with arccos due to floating point inaccuracies,\n    # clip the value to be within [-1.0, 1.0].\n    cosine_of_angle = np.clip(dot_product / norm_product, -1.0, 1.0)\n    \n    # Calculate the angle using arccos gives the result in radians\n    angle_rad = np.arccos(cosine_of_angle)\n    \n    return angle_rad\n\nsolve()\n```"
        },
        {
            "introduction": "Delaunay三角剖分有一个与之对偶的几何结构——Voronoi图。由于Voronoi单元的边界垂直平分相应的Delaunay边，这使得Voronoi单元成为有限体积法（FVM）中天然的控制体，从而简化了通量计算。本练习  将带领你从理论走向实践，聚焦于有限体积法实施中的一个核心环节：边界条件处理。你将为邻近边界的Voronoi控制体设计一种“虚拟单元”策略，并分析其对数值通量精度和守恒性的影响。",
            "id": "3376977",
            "problem": "考虑定义在光滑有界域 $\\Omega \\subset \\mathbb{R}^{2}$（边界为 $\\partial \\Omega$）上的稳态各向同性扩散偏微分方程 (PDE) $-\\nabla \\cdot (k \\nabla u) = f$，其中 $k  0$ 是常数扩散系数，$u$ 足够光滑。使用点集 $\\{\\boldsymbol{x}_{i}\\}$ 的 Delaunay 三角剖分 (DT) 对 $\\Omega$ 进行离散化，并为有限体积法 (FVM) 构建相关的 Voronoi 图控制体 $\\{V_{i}\\}$。假设跨 Voronoi 面采用标准的二点通量：对于由单元 $i$ 和 $j$ 共享的面，扩散通量近似为 $F_{ij} = -|\\Gamma_{ij}|\\, k \\,\\frac{u_{j} - u_{i}}{d_{ij}}$，其中 $|\\Gamma_{ij}|$ 是面长度，$d_{ij}$ 是 $\\boldsymbol{x}_{i}$ 和 $\\boldsymbol{x}_{j}$ 之间沿垂直于该面的直线的距离。\n\n专注于单个控制体 $V_{i}$，该控制体与 $\\partial \\Omega$ 的一个局部平直部分相邻，该部分具有单位外法向量 $\\boldsymbol{n}$ 和边界面质心 $\\boldsymbol{x}_{\\Gamma} \\in \\partial \\Omega$。设生成点 $\\boldsymbol{x}_{i}$ 位于距 $\\boldsymbol{x}_{\\Gamma}$ 处切线的有向距离为 $d_{i} = h  0$ 的位置，方向沿内法向 $-\\boldsymbol{n}$。设与 $V_{i}$ 相关的边界 Voronoi 面长度为 $|\\Gamma|$。\n\n为了在该边界面上以两点通量形式施加边界条件，引入一个虚拟单元，其虚拟生成点 $\\boldsymbol{x}_{g}$ 放置在距 $\\boldsymbol{x}_{\\Gamma}$ 有向距离为 $d_{g}$ 的位置，方向沿外法向 $+\\boldsymbol{n}$，并使用边界面通量\n$$\nF_{i\\partial} \\;=\\; -|\\Gamma|\\, k \\,\\frac{u_{g} - u_{i}}{d_{i} + d_{g}},\n$$\n其中 $u_{g}$ 是未知的虚拟值。为了与 Voronoi 正交性保持几何一致性，假设 $d_{g} = h$（关于边界的对称反射）。考虑在 $\\boldsymbol{x}_{\\Gamma}$ 处的两种边界条件类型：\n- Dirichlet：$u(\\boldsymbol{x}_{\\Gamma}) = u_{b}$，其中 $u_{b}$ 已知；\n- Neumann：$\\partial_{n} u(\\boldsymbol{x}_{\\Gamma}) = g_{n}$，其中法向导数 $g_{n}$ 已知。\n\n从控制体守恒定律和散度定理出发，并使用沿法向坐标 $s$ 的泰勒展开（其中 $s=0$ 在 $\\boldsymbol{x}_{\\Gamma}$ 处，$s0$ 指向内法向方向 $-\\boldsymbol{n}$），执行以下操作：\n1. 为每种边界条件类型构建一个虚拟单元策略 $u_{g}$，该策略能保证对所有线性函数 $u(s)$ 的精确性，并保证边界面通量 $F_{i\\partial}$ 在 $V_{i}$ 的离散平衡中的守恒性。\n2. 通过推导展开式\n$$\nF_{i\\partial}^{\\text{disc}} \\;-\\; F_{i\\partial}^{\\text{exact}} \\;=\\; \\mathcal{C}\\, h \\;+\\; \\mathcal{O}\\!\\left(h^{2}\\right),\n$$\n中的系数 $\\mathcal{C}$，来量化边界面通量的主阶相容性误差，此过程针对每种边界条件类型，在 $h \\to 0$ 时进行。用 $|\\Gamma|$、$k$ 以及在 $\\boldsymbol{x}_{\\Gamma}$ 处计算的 $u$ 的法向导数来表示 $\\mathcal{C}$。\n\n将分别对应于 Dirichlet 和 Neumann 边界条件的四个量 $\\big(u_{g}^{D},\\, \\mathcal{C}^{D},\\, u_{g}^{N},\\, \\mathcal{C}^{N}\\big)$，以单个封闭形式的解析表达式报告。无需进行数值代入。",
            "solution": "该问题陈述已经过验证，被认为是有效的。其科学基础在于偏微分方程的数值分析领域，问题是适定的，并使用了客观、正式的语言。不存在矛盾、信息缺失或不合理的假设。我们可以开始求解。\n\n该问题要求推导在 Dirichlet 和 Neumann 条件下，边界处有限体积通量近似的虚拟单元值和主阶相容性误差。\n\n让我们建立一个垂直于边界的一维坐标系。问题定义了一个坐标 $s$，表示距边界切线的有向距离，其中 $s=0$ 在边界点 $\\boldsymbol{x}_{\\Gamma}$ 处，$s0$ 指向域 $\\Omega$ 内部（沿内法向 $-\\boldsymbol{n}$）。\n内部节点 $\\boldsymbol{x}_i$ 位于 $s = d_i = h$。\n虚拟节点 $\\boldsymbol{x}_g$ 位于沿外法向 $+\\boldsymbol{n}$ 距离为 $d_g = h$ 的位置，这对应于 $s = -h$。\n解 $u$ 在内部节点的值是 $u_i = u(s=h)$。在边界上的值是 $u(s=0)$。虚拟值是 $u_g$。\n\n流出域的精确通量通过边界面 $\\Gamma$ 由通量向量 $\\boldsymbol{q} = -k\\nabla u$ 的法向分量的积分给出。\n$$\nF_{i\\partial}^{\\text{exact}} = \\int_{\\Gamma} \\boldsymbol{q} \\cdot \\boldsymbol{n} \\, d\\Gamma = \\int_{\\Gamma} (-k \\nabla u) \\cdot \\boldsymbol{n} \\, d\\Gamma = \\int_{\\Gamma} -k \\, \\partial_n u \\, d\\Gamma\n$$\n其中 $\\partial_n u = \\nabla u \\cdot \\boldsymbol{n}$ 是沿外法向 $\\boldsymbol{n}$ 方向的导数。\n由于坐标 $s$ 指向 $-\\boldsymbol{n}$ 方向，我们有关系式 $\\frac{d}{ds} = -\\frac{d}{dn}$，或 $\\partial_n u = -\\frac{du}{ds}$。\n将此代入通量定义中：\n$$\nF_{i\\partial}^{\\text{exact}} = \\int_{\\Gamma} -k \\left(-\\frac{du}{ds}\\right) \\, d\\Gamma = \\int_{\\Gamma} k \\frac{du}{ds} \\, d\\Gamma\n$$\n对于长度为 $|\\Gamma|$ 的小面，我们可以将其近似为：\n$$\nF_{i\\partial}^{\\text{exact}} \\approx |\\Gamma|\\, k \\,\\frac{du}{ds}\\bigg|_{s=0}\n$$\n流出控制体 $V_i$ 的离散通量通过边界面由下式给出：\n$$\nF_{i\\partial}^{\\text{disc}} = -|\\Gamma|\\, k \\,\\frac{u_{g} - u_{i}}{d_{i} + d_{g}} = -|\\Gamma|\\, k \\,\\frac{u_{g} - u_{i}}{2h} = |\\Gamma|\\, k \\,\\frac{u_{i} - u_{g}}{2h}\n$$\n我们对 $u(s)$ 在 $s=0$ 附近进行泰勒级数展开：\n$$\nu(s) = u(0) + s \\frac{du}{ds}\\bigg|_{0} + \\frac{s^2}{2!} \\frac{d^2u}{ds^2}\\bigg|_{0} + \\mathcal{O}(s^3)\n$$\n使用简写 $u_0 = u(0)$，$u'_0 = \\frac{du}{ds}\\bigg|_{0}$，$u''_0 = \\frac{d^2u}{ds^2}\\bigg|_{0}$，我们有：\n$$\nu_i = u(h) = u_0 + h u'_0 + \\frac{h^2}{2} u''_0 + \\mathcal{O}(h^3)\n$$\n\n### 1. Dirichlet 边界条件：$u(\\boldsymbol{x}_{\\Gamma}) = u_b$\n对于此条件，$u(0) = u_b$，所以 $u_0 = u_b$。\n\n首先，我们确定虚拟单元值 $u_g^D$。该策略对于任何线性函数 $u(s) = as+b$ 都必须是精确的。对于这样的函数，$u_b = b$，$u_i = ah+b$。我们需要用 $u_i$ 和 $u_b$ 来表示 $u_g$。一种标准的二阶精度方法是假设边界值是内部值和虚拟值的平均值，这两者相对于边界是对称的：\n$$\nu_b \\approx \\frac{u_i + u_g}{2}\n$$\n解出 $u_g$ 得到虚拟单元策略：\n$$\nu_g^D = 2u_b - u_i\n$$\n这对于线性函数是精确的，因为 $2b - (ah+b) = b-ah = u(-h)$。\n\n接下来，我们分析通量的相容性误差。我们将 $u_g^D$ 代入离散通量公式：\n$$\nF_{i\\partial}^{\\text{disc}, D} = |\\Gamma|\\, k \\,\\frac{u_{i} - u_{g}^D}{2h} = |\\Gamma|\\, k \\,\\frac{u_{i} - (2u_b - u_i)}{2h} = |\\Gamma|\\, k \\,\\frac{2u_i - 2u_b}{2h} = |\\Gamma|\\, k \\,\\frac{u_i - u_b}{h}\n$$\n现在，使用 $u_i$ 在 $s=0$ 附近的泰勒展开，并考虑到 $u_b = u_0$：\n$$\nu_i - u_b = (u_0 + h u'_0 + \\frac{h^2}{2} u''_0 + \\mathcal{O}(h^3)) - u_0 = h u'_0 + \\frac{h^2}{2} u''_0 + \\mathcal{O}(h^3)\n$$\n将此代入离散通量表达式中：\n$$\nF_{i\\partial}^{\\text{disc}, D} = |\\Gamma|\\, k \\,\\frac{h u'_0 + \\frac{h^2}{2} u''_0 + \\mathcal{O}(h^3)}{h} = |\\Gamma|\\, k \\left( u'_0 + \\frac{h}{2} u''_0 + \\mathcal{O}(h^2) \\right)\n$$\n精确通量为 $F_{i\\partial}^{\\text{exact}} = |\\Gamma|\\, k \\,u'_0$。相容性误差是其差值：\n$$\nF_{i\\partial}^{\\text{disc}, D} - F_{i\\partial}^{\\text{exact}} = |\\Gamma|\\, k \\left( u'_0 + \\frac{h}{2} u''_0 \\right) - |\\Gamma|\\, k \\, u'_0 + \\mathcal{O}(h^2) = \\frac{1}{2} |\\Gamma|\\, k \\, u''_0 \\, h + \\mathcal{O}(h^2)\n$$\n将此与形式 $\\mathcal{C}h + \\mathcal{O}(h^2)$ 进行比较，我们得到 Dirichlet 情况下的系数：\n$$\n\\mathcal{C}^D = \\frac{1}{2} |\\Gamma|\\, k \\, u''_0 = \\frac{1}{2} |\\Gamma|\\, k \\, \\frac{d^2u}{ds^2}\\bigg|_{\\boldsymbol{x}_\\Gamma}\n$$\n\n### 2. Neumann 边界条件：$\\partial_n u(\\boldsymbol{x}_{\\Gamma}) = g_n$\n该条件以外法向导数的形式给出。我们将其与我们的坐标 $s$ 相关联：$\\partial_n u = - \\frac{du}{ds}$，所以在 $s=0$ 处的条件是 $-\\frac{du}{ds}\\big|_{0} = g_n$，即 $u'_0 = -g_n$。\n\n首先，我们确定虚拟单元值 $u_g^N$。我们对边界上的导数使用中心差分近似，这是二阶精度的：\n$$\nu'_0 \\approx \\frac{u(h) - u(-h)}{2h} \\approx \\frac{u_i - u_g}{2h}\n$$\n令此近似值等于已知的导数值：\n$$\n\\frac{u_i - u_g}{2h} = u'_0 = -g_n\n$$\n解出 $u_g$ 得到虚拟单元策略：\n$$\nu_i - u_g = -2h g_n \\implies u_g^N = u_i + 2h g_n\n$$\n该策略对于线性函数 $u(s)=as+b$（其中 $u'_0=a=-g_n$）是精确的，因为 $u_g^N = (ah+b) + 2h(-a) = b-ah = u(-h)$。\n\n接下来，我们分析相容性误差。我们将 $u_g^N$ 代入离散通量公式：\n$$\nF_{i\\partial}^{\\text{disc}, N} = |\\Gamma|\\, k \\,\\frac{u_i - u_g^N}{2h} = |\\Gamma|\\, k \\,\\frac{u_i - (u_i + 2h g_n)}{2h} = |\\Gamma|\\, k \\,\\frac{-2h g_n}{2h} = -|\\Gamma|\\, k \\, g_n\n$$\n精确通量由下式给出：\n$$\nF_{i\\partial}^{\\text{exact}} \\approx |\\Gamma|\\, k \\, u'_0 = |\\Gamma|\\, k \\, (-g_n) = -|\\Gamma|\\, k \\, g_n\n$$\n基于给定的边界数据，离散通量的构造使其与精确通量相同。因此，相容性误差为零：\n$$\nF_{i\\partial}^{\\text{disc}, N} - F_{i\\partial}^{\\text{exact}} = (-|\\Gamma|\\, k \\, g_n) - (-|\\Gamma|\\, k \\, g_n) = 0\n$$\n这意味着主阶误差系数 $\\mathcal{C}^N$ 为零。\n\n### 结果总结\n这四个量是：\n- Dirichlet 虚拟值：$u_{g}^{D} = 2u_{b} - u_{i}$\n- Dirichlet 误差系数：$\\mathcal{C}^{D} = \\frac{1}{2}|\\Gamma|k\\frac{d^2u}{ds^2}\\bigg|_{\\boldsymbol{x}_\\Gamma}$\n- Neumann 虚拟值：$u_{g}^{N} = u_{i} + 2hg_{n}$\n- Neumann 误差系数：$\\mathcal{C}^{N} = 0$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2u_{b} - u_{i}  \\frac{1}{2}|\\Gamma|k\\frac{d^{2}u}{ds^{2}}\\bigg|_{\\boldsymbol{x}_\\Gamma}  u_{i} + 2hg_{n}  0 \\end{pmatrix}}\n$$"
        }
    ]
}