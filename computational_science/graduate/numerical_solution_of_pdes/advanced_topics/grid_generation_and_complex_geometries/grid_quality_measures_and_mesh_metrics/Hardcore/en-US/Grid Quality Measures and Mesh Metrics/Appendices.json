{
    "hands_on_practices": [
        {
            "introduction": "In the finite volume method, the accuracy of flux calculations between adjacent cells is directly tied to their geometric relationship. Non-orthogonality and skewness introduce errors that can degrade the solution quality. This first exercise  provides a fundamental workout in quantifying these crucial mesh quality metrics from first principles using basic vector algebra, building a foundation for analyzing any given mesh.",
            "id": "3402357",
            "problem": "Consider the steady diffusion of a scalar field $\\phi$ governed by the conservation law $\\nabla \\cdot \\left( \\Gamma \\nabla \\phi \\right) = 0$, where $\\Gamma$ is a positive constant diffusivity. In a cell-centered Finite Volume (FV) discretization, the diffusive flux across an internal face $f$ shared by two adjacent control volumes $P$ and $N$ is obtained from the surface integral of $\\Gamma \\nabla \\phi \\cdot \\boldsymbol{n}_f$ over the face, with face area vector $\\boldsymbol{S}_f = \\boldsymbol{n}_f \\, |\\boldsymbol{S}_f|$. On non-orthogonal meshes, the canonical two-point approximation can be understood by decomposing $\\boldsymbol{S}_f$ into components parallel and perpendicular to the line joining cell centers, which directly motivates mesh quality metrics associated with orthogonality and skewness.\n\nStart from the following fundamental bases:\n- The diffusive flux definition, the divergence theorem, and the dot product, without assuming any specific discrete formula.\n- The vector decomposition identity $\\boldsymbol{a} = \\left( \\boldsymbol{a} \\cdot \\hat{\\boldsymbol{e}} \\right) \\hat{\\boldsymbol{e}} + \\left[ \\boldsymbol{a} - \\left( \\boldsymbol{a} \\cdot \\hat{\\boldsymbol{e}} \\right) \\hat{\\boldsymbol{e}} \\right]$ for any vector $\\boldsymbol{a}$ and unit vector $\\hat{\\boldsymbol{e}}$.\n\nFor a particular internal face $f$ in two space dimensions, you are given:\n- Cell-center positions $\\boldsymbol{x}_P = (0, 0)$ and $\\boldsymbol{x}_N = \\left(1, \\frac{1}{\\sqrt{3}}\\right)$.\n- Face unit normal $\\boldsymbol{n}_f = (1, 0)$ and face area magnitude $|\\boldsymbol{S}_f| = 1$, so $\\boldsymbol{S}_f = (1, 0)$.\n- Face center $\\boldsymbol{x}_f = \\left(\\frac{1}{2}, \\frac{1}{10}\\right)$.\n- Let $\\boldsymbol{d} = \\boldsymbol{x}_N - \\boldsymbol{x}_P$ and $\\hat{\\boldsymbol{d}} = \\boldsymbol{d} / |\\boldsymbol{d}|$.\n\nUsing only the above bases and the geometry provided, do the following:\n1) Define the orthogonality factor $O$ for face $f$ as the cosine of the angle between $\\boldsymbol{n}_f$ and $\\hat{\\boldsymbol{d}}$, i.e., $O = \\left| \\boldsymbol{n}_f \\cdot \\hat{\\boldsymbol{d}} \\right|$, and derive its value from the data.\n2) Define the skewness vector $\\boldsymbol{s}$ as the vector from the orthogonal intersection point of the line through $\\boldsymbol{x}_P$ and $\\boldsymbol{x}_N$ with the face to the actual face center $\\boldsymbol{x}_f$. Precisely, let $\\boldsymbol{x}_I$ be the unique point on the line segment connecting $\\boldsymbol{x}_P$ and $\\boldsymbol{x}_N$ with the same face-normal coordinate as $\\boldsymbol{x}_f$; then $\\boldsymbol{s} = \\boldsymbol{x}_f - \\boldsymbol{x}_I$. Define the normalized skewness measure $K = \\frac{|\\boldsymbol{s}|}{|\\boldsymbol{d}|}$, and derive its value from the data.\n3) Combine these to form the dimensionless mesh quality index\n$$\nM \\;=\\; \\frac{O^2}{\\,1 + K^2\\,}.\n$$\nCompute $M$ from first principles using your results from steps $1$–$2$.\n\nReport the final value of $M$ as a single dimensionless number, rounded to four significant figures. Do not include any units in your final answer.",
            "solution": "The problem is first subject to validation based on the provided criteria.\n\n**Step 1: Extract Givens**\n-   Governing equation: $\\nabla \\cdot \\left( \\Gamma \\nabla \\phi \\right) = 0$.\n-   Discretization method: Cell-centered Finite Volume (FV).\n-   Cell-center positions: $\\boldsymbol{x}_P = (0, 0)$ and $\\boldsymbol{x}_N = \\left(1, \\frac{1}{\\sqrt{3}}\\right)$.\n-   Face unit normal: $\\boldsymbol{n}_f = (1, 0)$.\n-   Face area magnitude: $|\\boldsymbol{S}_f| = 1$.\n-   Face area vector: $\\boldsymbol{S}_f = (1, 0)$.\n-   Face center: $\\boldsymbol{x}_f = \\left(\\frac{1}{2}, \\frac{1}{10}\\right)$.\n-   Vector between cell centers: $\\boldsymbol{d} = \\boldsymbol{x}_N - \\boldsymbol{x}_P$.\n-   Unit vector along $\\boldsymbol{d}$: $\\hat{\\boldsymbol{d}} = \\boldsymbol{d} / |\\boldsymbol{d}|$.\n-   Orthogonality factor: $O = \\left| \\boldsymbol{n}_f \\cdot \\hat{\\boldsymbol{d}} \\right|$.\n-   Skewness vector: $\\boldsymbol{s} = \\boldsymbol{x}_f - \\boldsymbol{x}_I$, where $\\boldsymbol{x}_I$ is the point on the line segment $\\overline{\\boldsymbol{x}_P \\boldsymbol{x}_N}$ such that $(\\boldsymbol{x}_I - \\boldsymbol{x}_f) \\cdot \\boldsymbol{n}_f = 0$.\n-   Normalized skewness measure: $K = \\frac{|\\boldsymbol{s}|}{|\\boldsymbol{d}|}$.\n-   Mesh quality index: $M = \\frac{O^2}{\\,1 + K^2\\,}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is well-defined within the field of computational fluid dynamics and numerical methods for PDEs. The concepts of orthogonality and skewness are standard mesh quality metrics. All required data are provided, and the definitions of the quantities to be computed ($O$, $K$, $M$) are mathematically precise and unambiguous. The problem is scientifically grounded, objective, complete, and well-posed. There are no contradictions or unrealistic assumptions.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe solution proceeds in three parts as requested: calculation of the orthogonality factor $O$, the normalized skewness measure $K$, and finally the mesh quality index $M$.\n\n**1. Calculation of the Orthogonality Factor $O$**\n\nFirst, we determine the vector $\\boldsymbol{d}$ connecting the cell centers $\\boldsymbol{x}_P$ and $\\boldsymbol{x}_N$:\n$$\n\\boldsymbol{d} = \\boldsymbol{x}_N - \\boldsymbol{x}_P = \\left(1, \\frac{1}{\\sqrt{3}}\\right) - (0, 0) = \\left(1, \\frac{1}{\\sqrt{3}}\\right)\n$$\nNext, we compute the magnitude of $\\boldsymbol{d}$:\n$$\n|\\boldsymbol{d}| = \\sqrt{1^2 + \\left(\\frac{1}{\\sqrt{3}}\\right)^2} = \\sqrt{1 + \\frac{1}{3}} = \\sqrt{\\frac{4}{3}} = \\frac{2}{\\sqrt{3}}\n$$\nThe unit vector $\\hat{\\boldsymbol{d}}$ in the direction of $\\boldsymbol{d}$ is then:\n$$\n\\hat{\\boldsymbol{d}} = \\frac{\\boldsymbol{d}}{|\\boldsymbol{d}|} = \\frac{\\left(1, \\frac{1}{\\sqrt{3}}\\right)}{\\frac{2}{\\sqrt{3}}} = \\frac{\\sqrt{3}}{2} \\left(1, \\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{\\sqrt{3}}{2}, \\frac{1}{2}\\right)\n$$\nThe orthogonality factor $O$ is defined as the absolute value of the dot product of the face unit normal $\\boldsymbol{n}_f$ and the unit vector $\\hat{\\boldsymbol{d}}$:\n$$\nO = |\\boldsymbol{n}_f \\cdot \\hat{\\boldsymbol{d}}| = \\left| (1, 0) \\cdot \\left(\\frac{\\sqrt{3}}{2}, \\frac{1}{2}\\right) \\right| = \\left| 1 \\cdot \\frac{\\sqrt{3}}{2} + 0 \\cdot \\frac{1}{2} \\right| = \\frac{\\sqrt{3}}{2}\n$$\n\n**2. Calculation of the Normalized Skewness Measure $K$**\n\nThe point $\\boldsymbol{x}_I$ lies on the line passing through $\\boldsymbol{x}_P$ and $\\boldsymbol{x}_N$. Any point on this line can be parameterized as $\\boldsymbol{x}(t) = \\boldsymbol{x}_P + t(\\boldsymbol{x}_N - \\boldsymbol{x}_P) = t \\boldsymbol{d}$ for a scalar parameter $t$. Thus, $\\boldsymbol{x}_I = t_I \\boldsymbol{d}$ for some specific value $t_I$.\n\nThe defining condition for $\\boldsymbol{x}_I$ is that it has the same face-normal coordinate as the face center $\\boldsymbol{x}_f$. Mathematically, this is expressed as $\\boldsymbol{x}_I \\cdot \\boldsymbol{n}_f = \\boldsymbol{x}_f \\cdot \\boldsymbol{n}_f$. We substitute the expressions for $\\boldsymbol{x}_I$ and the given vectors:\n$$\n(t_I \\boldsymbol{d}) \\cdot \\boldsymbol{n}_f = \\boldsymbol{x}_f \\cdot \\boldsymbol{n}_f\n$$\n$$\nt_I (\\boldsymbol{d} \\cdot \\boldsymbol{n}_f) = \\boldsymbol{x}_f \\cdot \\boldsymbol{n}_f\n$$\nWe compute the necessary dot products:\n$$\n\\boldsymbol{d} \\cdot \\boldsymbol{n}_f = \\left(1, \\frac{1}{\\sqrt{3}}\\right) \\cdot (1, 0) = 1\n$$\n$$\n\\boldsymbol{x}_f \\cdot \\boldsymbol{n}_f = \\left(\\frac{1}{2}, \\frac{1}{10}\\right) \\cdot (1, 0) = \\frac{1}{2}\n$$\nSubstituting these values back into the equation for $t_I$:\n$$\nt_I (1) = \\frac{1}{2} \\implies t_I = \\frac{1}{2}\n$$\nSince $t_I = \\frac{1}{2}$ is between $0$ and $1$, the point $\\boldsymbol{x}_I$ lies on the line segment $\\overline{\\boldsymbol{x}_P \\boldsymbol{x}_N}$ as required. Now we find the coordinates of $\\boldsymbol{x}_I$:\n$$\n\\boldsymbol{x}_I = \\frac{1}{2} \\boldsymbol{d} = \\frac{1}{2} \\left(1, \\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{1}{2}, \\frac{1}{2\\sqrt{3}}\\right)\n$$\nThe skewness vector $\\boldsymbol{s}$ is the difference between the face center $\\boldsymbol{x}_f$ and the intersection point $\\boldsymbol{x}_I$:\n$$\n\\boldsymbol{s} = \\boldsymbol{x}_f - \\boldsymbol{x}_I = \\left(\\frac{1}{2}, \\frac{1}{10}\\right) - \\left(\\frac{1}{2}, \\frac{1}{2\\sqrt{3}}\\right) = \\left(0, \\frac{1}{10} - \\frac{1}{2\\sqrt{3}}\\right)\n$$\nThe magnitude of the skewness vector is:\n$$\n|\\boldsymbol{s}| = \\left| \\frac{1}{10} - \\frac{1}{2\\sqrt{3}} \\right| = \\left| \\frac{\\sqrt{3} - 5}{10\\sqrt{3}} \\right| = \\frac{5 - \\sqrt{3}}{10\\sqrt{3}}\n$$\nSince $\\sqrt{3} \\approx 1.732  5$, the term inside the absolute value is negative.\nThe normalized skewness measure $K$ is the ratio of $|\\boldsymbol{s}|$ to $|\\boldsymbol{d}|$:\n$$\nK = \\frac{|\\boldsymbol{s}|}{|\\boldsymbol{d}|} = \\frac{\\frac{5 - \\sqrt{3}}{10\\sqrt{3}}}{\\frac{2}{\\sqrt{3}}} = \\frac{(5 - \\sqrt{3})\\sqrt{3}}{10\\sqrt{3} \\cdot 2} = \\frac{5 - \\sqrt{3}}{20}\n$$\n\n**3. Calculation of the Mesh Quality Index $M$**\n\nThe mesh quality index $M$ is given by the formula $M = \\frac{O^2}{1 + K^2}$.\nWe have $O = \\frac{\\sqrt{3}}{2}$, so $O^2 = \\left(\\frac{\\sqrt{3}}{2}\\right)^2 = \\frac{3}{4}$.\nWe have $K = \\frac{5 - \\sqrt{3}}{20}$, so $K^2$ is:\n$$\nK^2 = \\left(\\frac{5 - \\sqrt{3}}{20}\\right)^2 = \\frac{5^2 - 2(5)\\sqrt{3} + (\\sqrt{3})^2}{20^2} = \\frac{25 - 10\\sqrt{3} + 3}{400} = \\frac{28 - 10\\sqrt{3}}{400} = \\frac{14 - 5\\sqrt{3}}{200}\n$$\nNow we compute $1 + K^2$:\n$$\n1 + K^2 = 1 + \\frac{14 - 5\\sqrt{3}}{200} = \\frac{200 + 14 - 5\\sqrt{3}}{200} = \\frac{214 - 5\\sqrt{3}}{200}\n$$\nFinally, we substitute these expressions into the formula for $M$:\n$$\nM = \\frac{O^2}{1 + K^2} = \\frac{\\frac{3}{4}}{\\frac{214 - 5\\sqrt{3}}{200}} = \\frac{3}{4} \\cdot \\frac{200}{214 - 5\\sqrt{3}} = \\frac{3 \\cdot 50}{214 - 5\\sqrt{3}} = \\frac{150}{214 - 5\\sqrt{3}}\n$$\nTo obtain the final numerical value, we use the approximation $\\sqrt{3} \\approx 1.73205$:\n$$\nM \\approx \\frac{150}{214 - 5(1.73205)} = \\frac{150}{214 - 8.66025} = \\frac{150}{205.33975} \\approx 0.730504\n$$\nRounding to four significant figures, we get $M = 0.7305$.",
            "answer": "$$\n\\boxed{0.7305}\n$$"
        },
        {
            "introduction": "Beyond analyzing an existing mesh, a key task is to design a mesh that is optimal for a specific problem, balancing accuracy with computational cost. For solutions with highly directional features, this involves creating anisotropic (stretched) elements aligned with those features. This problem  guides you through a classic optimization exercise to determine the ideal element aspect ratio based on the solution's curvature, a core concept in anisotropic mesh adaptation.",
            "id": "3402345",
            "problem": "Consider a scalar field $u(x,y)$ on a rectangular domain $\\Omega \\subset \\mathbb{R}^{2}$ with side lengths $L_{x}  0$ and $L_{y}  0$, where $u$ is the solution of a second-order elliptic Partial Differential Equation (PDE). Assume that the Hessian of $u$ is spatially constant and diagonal in the coordinate basis, $\\nabla^{2} u = \\operatorname{diag}(\\alpha, \\beta)$, with $\\alpha  0$ and $\\beta  0$. You will design a structured, axis-aligned, rectangular mesh with $n_{x}$ subdivisions in the $x$-direction and $n_{y}$ subdivisions in the $y$-direction. The element edge lengths are $h_{x} = L_{x}/n_{x}$ and $h_{y} = L_{y}/n_{y}$, and the total number of elements is $N = n_{x} n_{y} = A/(h_{x} h_{y})$, where $A = L_{x} L_{y}$ is the domain area. \n\nAs a grid quality measure, consider the leading-order interpolation error surrogate for piecewise linear finite elements on rectangles aligned with the axes, obtained from the Taylor remainder for $u$ with constant Hessian. This surrogate takes the form\n$$\nE(h_{x}, h_{y}) = c \\, A \\left(\\alpha \\, h_{x}^{2} + \\beta \\, h_{y}^{2}\\right),\n$$\nwhere $c  0$ is a constant that depends only on the choice of norm and reference-element scaling. As a computational cost model, consider the element count,\n$$\nC(h_{x}, h_{y}) = N = \\frac{A}{h_{x} h_{y}}.\n$$\nTo articulate quality–cost trade-offs in adaptive meshing, define the composite objective\n$$\nJ(h_{x}, h_{y}) = E(h_{x}, h_{y}) + \\mu \\, C(h_{x}, h_{y}) = c \\, A \\left(\\alpha \\, h_{x}^{2} + \\beta \\, h_{y}^{2}\\right) + \\mu \\, \\frac{A}{h_{x} h_{y}},\n$$\nwith $\\mu  0$ a fixed parameter that represents computational cost per element measured in consistent units with $E$. \n\nStarting from the Taylor remainder characterization of interpolation error on rectangles, the relation between discrete element sizes and element count on structured grids, and the definition of the composite objective above, derive the optimal anisotropy ratio\n$$\nr^{\\star} = \\frac{h_{y}}{h_{x}},\n$$\nthat minimizes $J(h_{x}, h_{y})$ over $h_{x}  0$ and $h_{y}  0$. Express your final answer as a closed-form analytic expression in terms of $\\alpha$ and $\\beta$ only. No numerical rounding is required. Provide your final answer as the formula for $r^{\\star}$ with no units.",
            "solution": "The problem requires finding the optimal anisotropy ratio $r^{\\star} = h_y / h_x$ that minimizes the composite objective function $J(h_x, h_y)$. The objective function is given by:\n$$\nJ(h_{x}, h_{y}) = c A \\left(\\alpha h_{x}^{2} + \\beta h_{y}^{2}\\right) + \\frac{\\mu A}{h_{x} h_{y}}\n$$\nTo find the minimum, we must find the critical points by setting the partial derivatives of $J$ with respect to $h_x$ and $h_y$ to zero. The domain for $(h_x, h_y)$ is $h_x > 0$ and $h_y > 0$.\n\nFirst, we compute the partial derivative with respect to $h_x$:\n$$\n\\frac{\\partial J}{\\partial h_x} = \\frac{\\partial}{\\partial h_x} \\left( c A \\alpha h_x^2 + c A \\beta h_y^2 + \\mu A h_x^{-1} h_y^{-1} \\right) = 2 c A \\alpha h_x - \\mu A h_x^{-2} h_y^{-1} = 2 c A \\alpha h_x - \\frac{\\mu A}{h_x^2 h_y}\n$$\nSetting this to zero gives:\n$$\n2 c A \\alpha h_x = \\frac{\\mu A}{h_x^2 h_y} \\implies \\mu = 2 c \\alpha h_x^3 h_y \\quad (1)\n$$\n\nNext, we compute the partial derivative with respect to $h_y$:\n$$\n\\frac{\\partial J}{\\partial h_y} = \\frac{\\partial}{\\partial h_y} \\left( c A \\alpha h_x^2 + c A \\beta h_y^2 + \\mu A h_x^{-1} h_y^{-1} \\right) = 2 c A \\beta h_y - \\mu A h_x^{-1} h_y^{-2} = 2 c A \\beta h_y - \\frac{\\mu A}{h_x h_y^2}\n$$\nSetting this to zero gives:\n$$\n2 c A \\beta h_y = \\frac{\\mu A}{h_x h_y^2} \\implies \\mu = 2 c \\beta h_x h_y^3 \\quad (2)\n$$\n\nNow, we equate the two expressions for $\\mu$ from equations (1) and (2):\n$$\n2 c \\alpha h_x^3 h_y = 2 c \\beta h_x h_y^3\n$$\nSince $c, h_x, h_y$ are all positive, we can divide both sides by $2c h_x h_y$:\n$$\n\\alpha h_x^2 = \\beta h_y^2\n$$\nWe are looking for the anisotropy ratio $r = h_y / h_x$. Rearranging the equation to solve for this ratio:\n$$\n\\frac{h_y^2}{h_x^2} = \\frac{\\alpha}{\\beta}\n$$\nTaking the square root of both sides (since $h_x, h_y > 0$, the ratio $r$ must also be positive):\n$$\nr = \\frac{h_y}{h_x} = \\sqrt{\\frac{\\alpha}{\\beta}}\n$$\nThis gives the optimal anisotropy ratio, $r^{\\star}$. This result confirms the equidistribution principle: the error contribution from each direction should be equal, i.e., $\\alpha h_x^2 = \\beta h_y^2$. The final answer depends only on $\\alpha$ and $\\beta$, as required.",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{\\alpha}{\\beta}}}\n$$"
        },
        {
            "introduction": "The consequences of poor mesh quality can range from reduced accuracy to catastrophic failure, especially for convection-dominated problems. Misalignment between the grid and the direction of wave propagation can generate severe non-physical oscillations that render a simulation useless. In this hands-on coding exercise , you will implement a numerical experiment to directly observe and quantify this phenomenon, correlating a geometric misalignment metric with the growth of spurious oscillations measured by the solution's total variation.",
            "id": "3402349",
            "problem": "You are asked to design and implement a numerical experiment to test the hypothesis that aligning mesh edges with the gradient direction reduces spurious oscillations in convection-dominated problems. Consider the two-dimensional linear advection Partial Differential Equation (PDE) on the unit square domain with periodic boundaries:\n$$\n\\frac{\\partial u}{\\partial t} + \\boldsymbol{a}\\cdot\\nabla u = 0,\n$$\nwhere $u=u(x,y,t)$, $\\boldsymbol{a}=(a_x,a_y)$ is a constant advection velocity, and $\\nabla u$ is the spatial gradient of $u$. The initial data is a discontinuous Heaviside step aligned along a unit direction vector $\\boldsymbol{n}=(\\cos\\alpha,\\sin\\alpha)$:\n$$\nu(x,y,0) = \\begin{cases}\n1,  \\text{if } x\\cos\\alpha + y\\sin\\alpha \\ge 0.5, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\nThe experiment uses a uniform Cartesian mesh with $N_x=N_y$ points over $[0,1]\\times[0,1]$ and periodic boundary conditions. A single Forward Euler time step with centered differences is used to advance the solution from $t=0$ to $t=\\Delta t$:\n$$\nu^{1}_{i,j} = u^{0}_{i,j} - \\Delta t\\left( a_x \\frac{u^{0}_{i,j+1}-u^{0}_{i,j-1}}{2\\Delta x} + a_y \\frac{u^{0}_{i+1,j}-u^{0}_{i-1,j}}{2\\Delta y} \\right),\n$$\nwhere $(i,j)$ index the grid nodes, $\\Delta x = 1/N_x$, and $\\Delta y = 1/N_y$. The advection velocity is set to align with the gradient direction of the initial data by taking $\\boldsymbol{a} = \\boldsymbol{n} = (\\cos\\alpha,\\sin\\alpha)$ and unit speed $\\|\\boldsymbol{a}\\|=1$. Angles must be expressed in radians.\n\nDefine the misalignment metric at a point $x$ as the acute angle between $\\nabla u$ and the nearest mesh edge direction. Since the initial condition has a constant gradient direction $\\boldsymbol{n}$, this reduces to a global misalignment scalar\n$$\n\\phi = \\min\\left\\{|\\alpha-0|,\\left|\\frac{\\pi}{2}-\\alpha\\right|\\right\\},\n$$\nthe acute angle between $\\boldsymbol{n}$ and the closest coordinate axis direction. Define the two-dimensional discrete total variation of a grid function $U_{i,j}$ as\n$$\n\\mathrm{TV}(U) = \\sum_{i,j}\\left( \\left|U_{i,j+1} - U_{i,j}\\right| + \\left|U_{i+1,j} - U_{i,j}\\right| \\right),\n$$\nwith periodic indexing. After advancing one time step from $u^0$ to $u^1$, compute the fractional change in total variation\n$$\n\\Delta \\mathrm{TV} = \\frac{\\mathrm{TV}(u^1)-\\mathrm{TV}(u^0)}{\\mathrm{TV}(u^0)}.\n$$\nFor the purposes of this experiment, say the scheme exhibits Total Variation Diminishing (TVD) behavior on this single step if and only if both $\\mathrm{TV}(u^1)\\le \\mathrm{TV}(u^0)$ and $u^1$ remains in the bounds $[0,1]$ everywhere on the grid.\n\nYour task is to implement the above and, for a test suite of angles, compute the misalignment $\\phi$, the fractional change in total variation $\\Delta \\mathrm{TV}$, and the boolean TVD flag. Additionally, compute the Pearson correlation coefficient between the list of misalignment values $\\{\\phi_k\\}$ and the corresponding list of fractional total variation changes $\\{\\Delta \\mathrm{TV}_k\\}$ across the test suite.\n\nUse the following parameter values for all test cases:\n- Grid size: $N_x=N_y=200$, hence $\\Delta x=\\Delta y=1/200$.\n- Time step: $\\Delta t = 0.4\\,\\Delta x$.\n- Advection velocity: $\\boldsymbol{a} = (\\cos\\alpha,\\sin\\alpha)$ with unit magnitude.\n- Boundary conditions: periodic on $[0,1]\\times[0,1]$.\n\nThe test suite consists of the angles (in radians):\n- Case 1: $\\alpha = 0$.\n- Case 2: $\\alpha = \\pi/8$.\n- Case 3: $\\alpha = \\pi/4$.\n- Case 4: $\\alpha = 3\\pi/8$.\n- Case 5: $\\alpha = \\pi/2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the following sequence:\n$$\n[\\rho, \\phi_1, \\Delta \\mathrm{TV}_1, \\text{TVD}_1, \\phi_2, \\Delta \\mathrm{TV}_2, \\text{TVD}_2, \\phi_3, \\Delta \\mathrm{TV}_3, \\text{TVD}_3, \\phi_4, \\Delta \\mathrm{TV}_4, \\text{TVD}_4, \\phi_5, \\Delta \\mathrm{TV}_5, \\text{TVD}_5],\n$$\nwhere $\\rho$ is the Pearson correlation coefficient between $\\{\\phi_k\\}$ and $\\{\\Delta \\mathrm{TV}_k\\}$, each $\\phi_k$ and $\\Delta \\mathrm{TV}_k$ are floats, and each $\\text{TVD}_k$ is a boolean. Angles must be reported in radians. No other text may be printed. The output uses the default string representation of floats and booleans in the chosen programming language.",
            "solution": "The problem statement has been validated and is deemed a well-posed and scientifically grounded numerical experiment. It is self-contained, with all necessary parameters, equations, and metrics clearly defined. The objective is to investigate the relationship between the alignment of a computational mesh with a solution's gradient and the generation of spurious oscillations when solving the linear advection equation.\n\nThe core of the experiment lies in numerically solving the two-dimensional linear advection partial differential equation (PDE),\n$$\n\\frac{\\partial u}{\\partial t} + \\boldsymbol{a}\\cdot\\nabla u = 0,\n$$\nfor a single time step and quantifying the numerical error. The problem establishes a specific scenario to test the hypothesis that misalignment between the gradient $\\nabla u$ and the mesh orientation introduces numerical errors, specifically oscillations that manifest as an increase in the total variation of the solution.\n\nThe methodology for the numerical experiment is as follows:\n\n1.  **Discretization of the Domain and Initial Condition**: The continuous domain $[0,1]\\times[0,1]$ is discretized into a uniform Cartesian grid of size $N_x \\times N_y$, where $N_x = N_y = 200$. The grid points $(x_j, y_i)$ are given by $x_j=j\\Delta x$ and $y_i=i\\Delta y$ for $i,j \\in \\{0, 1, ..., N-1\\}$, where $N=200$ and $\\Delta x = \\Delta y = 1/N$. The initial condition is a Heaviside step function defined by\n    $$\n    u(x,y,0) = u^0(x,y) = \\begin{cases} 1,  \\text{if } x\\cos\\alpha + y\\sin\\alpha \\ge 0.5 \\\\ 0,  \\text{otherwise}. \\end{cases}\n    $$\n    The gradient of this initial condition is perpendicular to the discontinuity line $x\\cos\\alpha+y\\sin\\alpha=0.5$, and thus has a constant direction given by the vector $\\boldsymbol{n} = (\\cos\\alpha, \\sin\\alpha)$. This initial condition is evaluated at each grid point $(x_j, y_i)$ to produce the discrete initial data array $u^0_{i,j}$.\n\n2.  **Numerical Time Evolution**: The solution is advanced from time $t=0$ to $t=\\Delta t$ using a Forward Euler method for time integration and a second-order centered difference scheme for spatial derivatives. This is known as the Forward-Time Centered-Space (FTCS) scheme. The update formula is explicitly given as\n    $$\n    u^{1}_{i,j} = u^{0}_{i,j} - \\Delta t\\left( a_x \\frac{u^{0}_{i,j+1}-u^{0}_{i,j-1}}{2\\Delta x} + a_y \\frac{u^{0}_{i+1,j}-u^{0}_{i-1,j}}{2\\Delta y} \\right).\n    $$\n    The advection velocity $\\boldsymbol{a}=(a_x, a_y)$ is chosen to be aligned with the initial gradient, so $\\boldsymbol{a}=\\boldsymbol{n}=(\\cos\\alpha, \\sin\\alpha)$. Periodic boundary conditions are enforced, meaning that indices are treated modulo $N$. For example, $u^0_{i,N}$ is identified with $u^0_{i,0}$, and $u^0_{N,j}$ with $u^0_{0,j}$. This is implemented computationally using circular shift operations on the data arrays.\n\n3.  **Quantification of Misalignment and Numerical Error**:\n    *   **Misalignment Metric ($\\phi$)**: The degree of misalignment between the solution's gradient (which has the constant direction $\\boldsymbol{n}$) and the Cartesian grid is quantified by the acute angle $\\phi$ between $\\boldsymbol{n}$ and the nearest coordinate axis ($\\boldsymbol{e}_x=(1,0)$ or $\\boldsymbol{e}_y=(0,1)$). This is calculated as $\\phi = \\min\\left\\{|\\alpha|,\\left|\\frac{\\pi}{2}-\\alpha\\right|\\right\\}$, for the given angles $\\alpha \\in [0, \\pi/2]$. A value of $\\phi=0$ indicates perfect alignment, while $\\phi=\\pi/4$ indicates maximum misalignment.\n    *   **Total Variation (TV)**: Spurious oscillations are quantified by measuring the change in the total variation of the numerical solution. The discrete total variation for a grid function $U_{i,j}$ is defined as\n      $$\n      \\mathrm{TV}(U) = \\sum_{i,j}\\left( \\left|U_{i,j+1} - U_{i,j}\\right| + \\left|U_{i+1,j} - U_{i,j}\\right| \\right).\n      $$\n      An ideal, non-oscillatory scheme for scalar advection would be Total Variation Diminishing (TVD), meaning $\\mathrm{TV}(u^{n+1}) \\le \\mathrm{TV}(u^n)$. The chosen FTCS scheme is not TVD and is expected to generate non-physical oscillations, which will increase the total variation.\n    *   **Fractional Change in TV ($\\Delta \\mathrm{TV}$)**: The change in TV is normalized by the initial TV to provide a relative measure of the error generated in one time step:\n      $$\n      \\Delta \\mathrm{TV} = \\frac{\\mathrm{TV}(u^1)-\\mathrm{TV}(u^0)}{\\mathrm{TV}(u^0)}.\n      $$\n      A positive value of $\\Delta \\mathrm{TV}$ indicates the generation of new oscillations.\n    *   **TVD Flag**: A boolean flag is computed to check if the scheme behaves in a TVD manner for this single step. This requires two conditions to be met: first, the total variation must not increase ($\\mathrm{TV}(u^1)\\le \\mathrm{TV}(u^0)$), and second, no new extrema may be created (i.e., $u^1$ must remain bounded by the initial minimum and maximum values, $[0,1]$).\n\n4.  **Hypothesis Testing**: The experiment is executed for a suite of angles $\\alpha_k$. For each angle, the pair $(\\phi_k, \\Delta \\mathrm{TV}_k)$ is computed. The hypothesis that increased misalignment leads to more significant oscillations implies a positive correlation between $\\phi_k$ and $\\Delta \\mathrm{TV}_k$. This correlation is quantified by computing the Pearson correlation coefficient $\\rho$ between the set of misalignment values $\\{\\phi_k\\}$ and the corresponding set of fractional TV changes $\\{\\Delta \\mathrm{TV}_k\\}$. A value of $\\rho$ close to $+1$ would strongly support the hypothesis within the context of this specific numerical experiment.\n\nThe provided final code implements this procedure for each specified angle, collects the resulting metrics, computes the correlation coefficient, and formats the results as requested.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the numerical experiment to test the effect of mesh alignment\n    on spurious oscillations for the 2D linear advection equation.\n    \"\"\"\n    # Define parameters from the problem statement.\n    N = 200\n    dx = 1.0 / N\n    dy = 1.0 / N  # N_x = N_y, so dx = dy\n    dt = 0.4 * dx\n\n    # Define the test cases (angles in radians) from the problem statement.\n    test_cases = [\n        0.0,\n        np.pi / 8.0,\n        np.pi / 4.0,\n        3.0 * np.pi / 8.0,\n        np.pi / 2.0,\n    ]\n\n    # Pre-compute the grid coordinates\n    x_coords = np.arange(N) * dx\n    y_coords = np.arange(N) * dy\n    xx, yy = np.meshgrid(x_coords, y_coords, indexing='xy')\n\n    def calculate_total_variation(U):\n        \"\"\"Computes the 2D discrete total variation with periodic boundaries.\"\"\"\n        # Sum of absolute differences in x-direction (along axis 1)\n        tv_x = np.sum(np.abs(np.roll(U, -1, axis=1) - U))\n        # Sum of absolute differences in y-direction (along axis 0)\n        tv_y = np.sum(np.abs(np.roll(U, -1, axis=0) - U))\n        return tv_x + tv_y\n\n    # Lists to store results for all cases\n    case_results = []\n    phi_values = []\n    delta_tv_values = []\n\n    for alpha in test_cases:\n        # Main logic to calculate the result for one case goes here.\n\n        # 1. Define initial condition u^0 based on angle alpha\n        ax, ay = np.cos(alpha), np.sin(alpha)\n        projection = xx * ax + yy * ay\n        u0 = np.zeros_like(xx, dtype=float)\n        u0[projection = 0.5] = 1.0\n\n        # 2. Calculate Total Variation of the initial condition\n        tv0 = calculate_total_variation(u0)\n\n        # 3. Advance one time step using Forward Euler and Centered Differences\n        # Spatial derivative in x (using np.roll for periodic boundaries)\n        du0_dx = (np.roll(u0, -1, axis=1) - np.roll(u0, 1, axis=1)) / (2 * dx)\n        # Spatial derivative in y\n        du0_dy = (np.roll(u0, -1, axis=0) - np.roll(u0, 1, axis=0)) / (2 * dy)\n        \n        # Advection velocity a is (ax, ay)\n        u1 = u0 - dt * (ax * du0_dx + ay * du0_dy)\n\n        # 4. Compute metrics for the current case\n        # Total Variation of the new state u^1\n        tv1 = calculate_total_variation(u1)\n        \n        # Misalignment metric phi\n        phi = min(abs(alpha - 0.0), abs(np.pi / 2.0 - alpha))\n        \n        # Fractional change in Total Variation\n        delta_tv = (tv1 - tv0) / tv0 if tv0 != 0 else 0.0\n\n        # TVD flag\n        is_bounded = np.all((u1 = 0.0)  (u1 = 1.0))\n        is_diminishing = tv1 = tv0\n        tvd_flag = is_bounded and is_diminishing\n\n        # Append individual results for this case to be part of the final output\n        case_results.extend([phi, delta_tv, tvd_flag])\n        \n        # Collect values separately for correlation calculation\n        phi_values.append(phi)\n        delta_tv_values.append(delta_tv)\n\n    # 5. Compute the Pearson correlation coefficient rho\n    # np.corrcoef returns the correlation matrix. The value at [0, 1] is rho(X, Y).\n    if len(phi_values)  1:\n        rho = np.corrcoef(phi_values, delta_tv_values)[0, 1]\n    else:\n        # Correlation is undefined for a single data point.\n        rho = 0.0\n\n    # 6. Assemble the final list in the specified order\n    results = [rho] + case_results\n\n    # Final print statement in the exact required format.\n    # The default string representation of floats and booleans is used as requested.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}