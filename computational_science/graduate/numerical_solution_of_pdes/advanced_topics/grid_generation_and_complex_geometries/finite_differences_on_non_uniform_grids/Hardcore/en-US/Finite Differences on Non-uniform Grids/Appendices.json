{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the finite difference method lies in the approximation of derivatives using values at discrete grid points. While formulas for uniform grids are standard, real-world applications often necessitate non-uniform grids, requiring us to derive these approximations from first principles. This first practice will guide you through the fundamental process of using Taylor series expansions to construct a consistent, second-order accurate central difference approximation for the first derivative on a non-uniform three-point stencil, a core skill for developing and analyzing numerical methods .",
            "id": "3394040",
            "problem": "Consider a one-dimensional discretization of a Partial Differential Equation (PDE), where a sufficiently smooth function $f(x)$ is sampled at three consecutive, non-uniform nodes $x_{i-1} < x_i < x_{i+1}$. Define the local mesh spacings $h_{-} = x_i - x_{i-1}$ and $h_{+} = x_{i+1} - x_i$, with $h_{-} > 0$ and $h_{+} > 0$. Using only the three function values $f_{i-1} = f(x_{i-1})$, $f_i = f(x_i)$, and $f_{i+1} = f(x_{i+1})$, construct a unique linear combination\n$$a_{-1} f_{i-1} + a_{0} f_i + a_{+1} f_{i+1}$$\nthat provides a consistent approximation to the first derivative $f'(x_i)$ with the maximal algebraic order achievable from these three nodes on a non-uniform grid. Starting from first principles, derive the coefficients $a_{-1}$, $a_0$, and $a_{+1}$ in terms of $h_{-}$ and $h_{+}$, determine the order $p$ of the approximation, and compute the leading truncation error coefficient $C$ in the local expansion\n$$a_{-1} f_{i-1} + a_{0} f_i + a_{+1} f_{i+1} = f'(x_i) + C\\, f^{(3)}(x_i) + \\text{higher-order terms}.$$\nExpress your final answer as a closed-form analytic expression. No rounding is required, and no physical units are involved.",
            "solution": "We begin from the Taylor series expansions of the smooth function $f(x)$ around the point $x_i$, evaluated at the neighboring nodes $x_{i-1}$ and $x_{i+1}$. Let $h_{-} = x_i - x_{i-1} > 0$ and $h_{+} = x_{i+1} - x_i > 0$. By Taylor's theorem,\n$$\nf(x_{i-1}) = f(x_i - h_{-}) = f(x_i) - h_{-} f'(x_i) + \\frac{h_{-}^{2}}{2} f''(x_i) - \\frac{h_{-}^{3}}{6} f^{(3)}(x_i) + \\frac{h_{-}^{4}}{24} f^{(4)}(x_i) + \\dots,\n$$\n$$\nf(x_{i+1}) = f(x_i + h_{+}) = f(x_i) + h_{+} f'(x_i) + \\frac{h_{+}^{2}}{2} f''(x_i) + \\frac{h_{+}^{3}}{6} f^{(3)}(x_i) + \\frac{h_{+}^{4}}{24} f^{(4)}(x_i) + \\dots.\n$$\nWe seek coefficients $a_{-1}$, $a_0$, and $a_{+1}$ such that the linear combination\n$$\nS = a_{-1} f(x_{i-1}) + a_{0} f(x_i) + a_{+1} f(x_{i+1})\n$$\napproximates $f'(x_i)$ with maximal order using only these three points. Substituting the Taylor expansions into $S$ and collecting terms by derivatives of $f$ at $x_i$ yields\n$$\nS = (a_{-1} + a_0 + a_{+1}) f(x_i) + \\left(- a_{-1} h_{-} + a_{+1} h_{+}\\right) f'(x_i) + \\left(\\frac{a_{-1} h_{-}^{2}}{2} + \\frac{a_{+1} h_{+}^{2}}{2}\\right) f''(x_i)\n$$\n$$\n\\quad + \\left(- \\frac{a_{-1} h_{-}^{3}}{6} + \\frac{a_{+1} h_{+}^{3}}{6}\\right) f^{(3)}(x_i) + \\dots.\n$$\nTo achieve consistency with the target derivative $f'(x_i)$, we require the coefficient of $f(x_i)$ to vanish and the coefficient of $f'(x_i)$ to equal $1$. To maximize the algebraic order of accuracy using three points, we further eliminate the $f''(x_i)$ term. This gives a linear system for $a_{-1}$, $a_0$, and $a_{+1}$:\n$$\na_{-1} + a_0 + a_{+1} = 0,\n$$\n$$\n- a_{-1} h_{-} + a_{+1} h_{+} = 1,\n$$\n$$\n\\frac{a_{-1} h_{-}^{2}}{2} + \\frac{a_{+1} h_{+}^{2}}{2} = 0.\n$$\nFrom the third equation, we have $a_{-1} h_{-}^{2} + a_{+1} h_{+}^{2} = 0$, which implies\n$$\na_{-1} = - a_{+1} \\frac{h_{+}^{2}}{h_{-}^{2}}.\n$$\nSubstituting into the second equation,\n$$\n- \\left(- a_{+1} \\frac{h_{+}^{2}}{h_{-}^{2}}\\right) h_{-} + a_{+1} h_{+} = 1 \\quad \\Rightarrow \\quad a_{+1} \\left(\\frac{h_{+}^{2}}{h_{-}} + h_{+}\\right) = 1.\n$$\nHence\n$$\na_{+1} = \\frac{1}{\\dfrac{h_{+}^{2}}{h_{-}} + h_{+}} = \\frac{h_{-}}{h_{+} (h_{-} + h_{+})}.\n$$\nThen\n$$\na_{-1} = - a_{+1} \\frac{h_{+}^{2}}{h_{-}^{2}} = - \\frac{h_{+}}{h_{-} (h_{-} + h_{+})}.\n$$\nFinally, using $a_0 = - (a_{-1} + a_{+1})$, we obtain\n$$\na_0 = \\frac{h_{+}^{2} - h_{-}^{2}}{h_{-} h_{+} (h_{-} + h_{+})}.\n$$\nThese coefficients eliminate the $f(x_i)$ and $f''(x_i)$ contributions and normalize the $f'(x_i)$ term to $1$. With three nodes, this is the unique construction that achieves the maximal algebraic order, which is second order. To compute the leading truncation error coefficient, examine the $f^{(3)}(x_i)$ term:\n$$\n\\text{leading error term} = \\left(- \\frac{a_{-1} h_{-}^{3}}{6} + \\frac{a_{+1} h_{+}^{3}}{6}\\right) f^{(3)}(x_i).\n$$\nSubstitute $a_{-1}$ and $a_{+1}$:\n$$\n- \\frac{a_{-1} h_{-}^{3}}{6} = - \\frac{\\left(- \\dfrac{h_{+}}{h_{-} (h_{-} + h_{+})}\\right) h_{-}^{3}}{6} = \\frac{h_{+} h_{-}^{2}}{6 (h_{-} + h_{+})},\n$$\n$$\n\\frac{a_{+1} h_{+}^{3}}{6} = \\frac{\\left(\\dfrac{h_{-}}{h_{+} (h_{-} + h_{+})}\\right) h_{+}^{3}}{6} = \\frac{h_{-} h_{+}^{2}}{6 (h_{-} + h_{+})}.\n$$\nSumming these two contributions gives\n$$\n\\frac{h_{+} h_{-}^{2} + h_{-} h_{+}^{2}}{6 (h_{-} + h_{+})} = \\frac{h_{-} h_{+} (h_{-} + h_{+})}{6 (h_{-} + h_{+})} = \\frac{h_{-} h_{+}}{6}.\n$$\nTherefore the leading truncation error is\n$$\nC\\, f^{(3)}(x_i) \\quad \\text{with} \\quad C = \\frac{h_{-} h_{+}}{6},\n$$\nand the approximation is of order $p = 2$, since the error scales like the product $h_{-} h_{+}$, which is $\\mathcal{O}(h^{2})$ under mesh refinement where $h_{-}$ and $h_{+}$ are both proportional to a small parameter $h$. As a consistency check, in the uniform case $h_{-} = h_{+} = h$, these coefficients reduce to $a_{-1} = - \\dfrac{1}{2 h}$, $a_0 = 0$, $a_{+1} = \\dfrac{1}{2 h}$, and $C = \\dfrac{h^{2}}{6}$, which is the classical second-order central difference for $f'(x_i)$ with the correct leading error term.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n-\\dfrac{h_{+}}{h_{-}\\left(h_{-}+h_{+}\\right)} & \\dfrac{h_{+}^{2}-h_{-}^{2}}{h_{-}h_{+}\\left(h_{-}+h_{+}\\right)} & \\dfrac{h_{-}}{h_{+}\\left(h_{-}+h_{+}\\right)} & 2 & \\dfrac{h_{-}h_{+}}{6}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "Constructing accurate stencils is only the first step; we must also ensure that the resulting numerical scheme produces physically meaningful solutions. When applying finite differences to equations with both diffusion and convection, a naive implementation can lead to spurious, non-physical oscillations, especially when convection dominates. This exercise challenges you to analyze the stability of a discretized convection-diffusion equation, determining the conditions under which the discrete operator fails to be an M-matrix and connecting this failure to the critical cell Peclet number .",
            "id": "3394088",
            "problem": "Consider the steady one-dimensional convectionâ€“diffusion boundary value problem\n$$\n-\\nu\\,u''(x)+\\mu\\,u'(x)=f(x),\\quad x\\in(0,L),\n$$\nwith Dirichlet boundary conditions $u(0)=\\ell_0$ and $u(L)=\\ell_L$, where $\\nu>0$ and $\\mu\\in\\mathbb{R}$ are constants. Let $\\{x_i\\}$ be a strictly increasing non-uniform grid with consecutive spacings $h_-:=x_i-x_{i-1}>0$ and $h_+:=x_{i+1}-x_i>0$ at an interior node $x_i$. Discretize $u''(x_i)$ by quadratic interpolation on $\\{x_{i-1},x_i,x_{i+1}\\}$ and $u'(x_i)$ by the three-point central formula on the same non-uniform stencil. This yields a tridiagonal discrete operator row\n$$\na_{i,i-1}\\,u_{i-1}+a_{i,i}\\,u_i+a_{i,i+1}\\,u_{i+1}=b_i,\n$$\nwith coefficients\n$$\na_{i,i-1}=-\\frac{2\\nu}{h_-(h_-+h_+)}+\\mu\\left(-\\frac{h_+}{h_-(h_-+h_+)}\\right),\\quad\na_{i,i}=\\frac{2\\nu}{h_-h_+}+\\mu\\left(\\frac{h_+-h_-}{h_-h_+}\\right),\n$$\n$$\na_{i,i+1}=-\\frac{2\\nu}{h_+(h_-+h_+)}+\\mu\\left(\\frac{h_-}{h_+(h_-+h_+)}\\right).\n$$\nHere $b_i$ collects the contributions of $f$ and the boundary conditions at $x_{i-1}$ and $x_{i+1}$.\n\nA real tridiagonal matrix is an $M$-matrix (monotone matrix) if each diagonal entry is positive, each off-diagonal entry is nonpositive, and the matrix is weakly diagonally dominant by rows. Focusing on the local row above, determine precisely for which parameter ranges in $(\\nu,\\mu,h_-,h_+)$ the $M$-matrix conditions are violated at node $x_i$. Then construct a concrete counterexample by specifying a grid and parameters $(\\nu,\\mu)$, boundary values, and a right-hand side $f$ for which the resulting discrete solution exhibits a non-monotone interior undershoot or overshoot (a spurious oscillation).\n\nFinally, define the local upwind cell Peclet number\n$$\n\\mathrm{Pe}_{\\mathrm{up}}:=\\frac{|\\mu|\\,h_{\\mathrm{up}}}{\\nu},\n$$\nwhere $h_{\\mathrm{up}}:=h_-$ if $\\mu>0$ and $h_{\\mathrm{up}}:=h_+$ if $\\mu<0$. What is the exact critical threshold value $\\mathrm{Pe}_{\\star}$ such that the $M$-matrix property is violated whenever $\\mathrm{Pe}_{\\mathrm{up}}>\\mathrm{Pe}_{\\star}$? Give your final answer as a single exact number.",
            "solution": "We begin from the standard three-point non-uniform-grid formulas derived by Taylor expansion or Lagrange interpolation. On the stencil $\\{x_{i-1},x_i,x_{i+1}\\}$ with $h_-:=x_i-x_{i-1}$ and $h_+:=x_{i+1}-x_i$, the second derivative at $x_i$ is approximated by\n$$\nu''(x_i)\\approx \\frac{2}{h_-(h_-+h_+)}\\,u_{i-1}-\\frac{2}{h_-h_+}\\,u_i+\\frac{2}{h_+(h_-+h_+)}\\,u_{i+1}.\n$$\nThe first derivative at $x_i$ using the three-point central difference on a non-uniform stencil is\n$$\nu'(x_i)\\approx -\\frac{h_+}{h_-(h_-+h_+)}\\,u_{i-1}+\\frac{h_+-h_-}{h_-h_+}\\,u_i+\\frac{h_-}{h_+(h_-+h_+)}\\,u_{i+1}.\n$$\nInserting these into $-\\nu u''+\\mu u'$ gives the row coefficients\n$$\na_{i,i-1}=-\\frac{2\\nu}{h_-(h_-+h_+)}-\\mu\\,\\frac{h_+}{h_-(h_-+h_+)},\\quad\na_{i,i}=\\frac{2\\nu}{h_-h_+}+\\mu\\,\\frac{h_+-h_-}{h_-h_+},\n$$\n$$\na_{i,i+1}=-\\frac{2\\nu}{h_+(h_-+h_+)}+\\mu\\,\\frac{h_-}{h_+(h_-+h_+)}.\n$$\nWe analyze the $M$-matrix conditions for this row.\n\n1. Off-diagonal signs. For an $M$-matrix we require $a_{i,i\\pm 1}\\le 0$.\n- For $a_{i,i-1}$,\n$$\na_{i,i-1}=-\\frac{1}{h_-(h_-+h_+)}\\bigl(2\\nu+\\mu h_+\\bigr).\n$$\nIf $\\mu\\ge 0$ then $2\\nu+\\mu h_+>0$, so $a_{i,i-1}<0$, always acceptable. If $\\mu<0$, then $2\\nu+\\mu h_+$ can become negative; in that case $a_{i,i-1}>0$ and the $M$-matrix condition is violated when\n$$\n2\\nu+\\mu h_+<0\\quad\\Longleftrightarrow\\quad |\\mu|\\,h_+>2\\nu.\n$$\n- For $a_{i,i+1}$,\n$$\na_{i,i+1}=\\frac{1}{h_+(h_-+h_+)}\\bigl(-2\\nu+\\mu h_-\\bigr).\n$$\nIf $\\mu\\le 0$ then $\\mu h_-\\le 0$ and $-2\\nu+\\mu h_-<0$, so $a_{i,i+1}<0$, always acceptable. If $\\mu>0$, then $a_{i,i+1}>0$ precisely when\n$$\n-2\\nu+\\mu h_->0\\quad\\Longleftrightarrow\\quad \\mu\\,h_->2\\nu.\n$$\nThus, in all cases, the off-diagonal that lies in the downwind direction can flip sign and violate the $M$-matrix condition whenever the upwind cell length $h_{\\mathrm{up}}$ satisfies\n$$\n|\\mu|\\,h_{\\mathrm{up}}>2\\nu,\\quad\\text{where}\\quad h_{\\mathrm{up}}=\\begin{cases}\nh_- & \\mu>0,\\\\\nh_+ & \\mu<0.\n\\end{cases}\n$$\n\n2. Diagonal sign and diagonal dominance. The diagonal entry is\n$$\na_{i,i}=\\frac{2\\nu}{h_-h_+}+\\mu\\,\\frac{h_+-h_-}{h_-h_+}.\n$$\nFor moderate advection $|\\mu|\\le \\frac{2\\nu}{\\min\\{h_-,h_+\\}}$, the diagonal remains positive. Moreover, the diffusion contribution alone satisfies weak diagonal dominance with equality:\n$$\n\\frac{2\\nu}{h_-h_+}=\\frac{2\\nu}{h_-(h_-+h_+)}+\\frac{2\\nu}{h_+(h_-+h_+)},\n$$\nwhile the advection contribution to $a_{i,i}$ is the negative of the sum of the advection contributions to $a_{i,i-1}$ and $a_{i,i+1}$, so weak diagonal dominance by rows continues to hold whenever both off-diagonals are nonpositive. Therefore, the loss of the $M$-matrix property is governed by the sign of the downwind off-diagonal, which is precisely the condition derived above.\n\nEquivalently, defining the local upwind Peclet number\n$$\n\\mathrm{Pe}_{\\mathrm{up}}:=\\frac{|\\mu|\\,h_{\\mathrm{up}}}{\\nu},\n$$\nthe $M$-matrix property is violated at node $x_i$ whenever $\\mathrm{Pe}_{\\mathrm{up}}>2$.\n\nCounterexample exhibiting spurious oscillations. Take the grid $\\{x_0,x_1,x_2,x_3\\}=\\{0,1,2,5\\}$, so that at $x_1$ we have $h_- = x_1-x_0=1$ and $h_+=x_2-x_1=1$, and at $x_2$ we have $h_- = x_2-x_1=1$ and $h_+=x_3-x_2=3$. Choose parameters $\\nu=1$ and $\\mu=10$, so that at $x_2$ the upwind spacing is $h_- = 1$ (because $\\mu>0$) and $\\mu h_-=10>2\\nu=2$, violating the $M$-matrix condition. Impose Dirichlet boundary conditions $u(0)=0$ and $u(5)=1$ and take $f\\equiv 0$.\n\nThe two interior equations (for $u_1$ at $x_1$ and $u_2$ at $x_2$) use the coefficients computed above:\n- At $x_1$ with $h_-=1$, $h_+=1$,\n$$\na_{1,0}=-\\frac{2+\\mu}{2}=-6,\\quad a_{1,1}=2,\\quad a_{1,2}=\\frac{\\mu-2}{2}=4.\n$$\n- At $x_2$ with $h_-=1$, $h_+=3$,\n$$\na_{2,1}=-\\frac{2+3\\mu}{4}=-8,\\quad a_{2,2}=\\frac{2}{3}+\\frac{2\\mu}{3}=\\frac{22}{3},\\quad a_{2,3}=\\frac{\\mu-2}{12}=\\frac{2}{3}.\n$$\nWith $f\\equiv 0$, the right-hand sides reduce to boundary contributions:\n$$\n2\\,u_1+4\\,u_2=-a_{1,0}\\,u_0=0,\\qquad -8\\,u_1+\\frac{22}{3}\\,u_2=-a_{2,3}\\,u_3=-\\frac{2}{3}\\cdot 1=-\\frac{2}{3}.\n$$\nSolving the $2\\times 2$ system gives\n$$\nu_1=-2\\,u_2,\\qquad 16\\,u_2+\\frac{22}{3}\\,u_2=-\\frac{2}{3}\\ \\Longrightarrow\\ 70\\,u_2=-2\\ \\Longrightarrow\\ u_2=-\\frac{1}{35},\\quad u_1=\\frac{2}{35}.\n$$\nThe exact solution of the continuous problem with $f\\equiv 0$ and $\\mu,\\nu>0$ is monotone increasing from $0$ to $1$, but the discrete solution exhibits a spurious oscillation: $u_2<0<u_1$, an interior undershoot below the left boundary value $0$ caused by the violation of the $M$-matrix condition.\n\nIn summary, the $M$-matrix property is violated locally when $|\\mu|\\,h_{\\mathrm{up}}>2\\nu$, i.e., when the local upwind Peclet number exceeds the critical threshold\n$$\n\\mathrm{Pe}_{\\star}=2.\n$$\nThis threshold is independent of the mesh ratio $h_+/h_-$; only the upwind spacing $h_{\\mathrm{up}}$ enters.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "An alternative and powerful approach to designing numerical schemes, particularly for problems governed by conservation laws, is the finite volume method. Instead of approximating derivatives at a point, this method enforces that a physical quantity, like mass or energy, is conserved over discrete control volumes, which often leads to more robust and stable solutions. This final practice asks you to derive a conservative scheme for the diffusion equation on a non-uniform grid, prove that it exactly conserves the total discrete mass, and analyze its correct long-time convergence to a constant state .",
            "id": "3394092",
            "problem": "Consider the linear diffusion partial differential equation (PDE) $u_{t}=\\nu\\,u_{xx}$ with constant diffusivity $\\nu>0$ on a periodic interval $[0,L]$. Let $\\{x_{i}\\}_{i=0}^{N-1}$ be a strictly increasing set of $N$ nodes with periodic wrap-around $x_{i+N}=x_{i}+L$, and denote the nonuniform spacings by $h_{i}=x_{i+1}-x_{i}$ for all $i$ (indices understood modulo $N$). Define midpoints $x_{i+\\frac{1}{2}}=\\frac{x_{i}+x_{i+1}}{2}$ and dual-cell lengths (quadrature weights) $w_{i}=x_{i+\\frac{1}{2}}-x_{i-\\frac{1}{2}}=\\frac{h_{i-1}+h_{i}}{2}$. Using the integral (conservative) form of the PDE over the dual cell $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}}]$, derive a conservative three-point, quadrature-weighted, semi-discrete finite-difference scheme at each node $x_{i}$ of the form\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(w_{i}u_{i}(t)\\right)=F_{i+\\frac{1}{2}}(t)-F_{i-\\frac{1}{2}}(t),\n$$\nwith a consistent numerical flux $F_{i+\\frac{1}{2}}(t)$ computed only from $u_{i}(t)$, $u_{i+1}(t)$, and $x_{i}$, $x_{i+1}$. Write the resulting scheme explicitly as a three-point stencil for $\\frac{\\mathrm{d}}{\\mathrm{d}t}u_{i}(t)$ in terms of $u_{i-1}(t)$, $u_{i}(t)$, $u_{i+1}(t)$ and the grid spacings.\n\nStarting from the conservation law and your semi-discrete scheme, prove that the quadrature-weighted discrete mass $\\sum_{i=0}^{N-1}w_{i}u_{i}(t)$ is invariant in time for all $t\\ge 0$. Then, using periodic boundary conditions and the strict positivity of $\\nu$, argue that the solution of the semi-discrete ordinary differential equation converges as $t\\to\\infty$ to a spatially constant state $u_{i}(t)\\to c$ independent of $i$. Express the constant $c$ solely in terms of the initial data $\\{u_{i}(0)\\}_{i=0}^{N-1}$ and the quadrature weights $\\{w_{i}\\}_{i=0}^{N-1}$.\n\nProvide the final expression for $c$ as your answer. No numerical evaluation is required; give a closed-form expression. Do not include units.",
            "solution": "We start by integrating the PDE $u_t = \\nu u_{xx}$ over the dual cell $[x_{i-1/2}, x_{i+1/2}]$:\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) \\,dx = \\int_{x_{i-1/2}}^{x_{i+1/2}} \\nu u_{xx} \\,dx = [\\nu u_x]_{x_{i-1/2}}^{x_{i+1/2}}\n$$\nWe approximate the integral on the left by $w_i u_i(t)$. The physical flux is $J = \\nu u_x$. We define the numerical flux $F_{i+1/2}$ as an approximation to $J$ at the cell face $x_{i+1/2}$ using a central difference: $F_{i+1/2}(t) = \\nu \\frac{u_{i+1}(t) - u_i(t)}{h_i}$. The semi-discrete scheme then takes the conservative form:\n$$\n\\frac{d}{dt}\\left(w_i u_i\\right) = F_{i+1/2} - F_{i-1/2} = \\nu \\frac{u_{i+1} - u_i}{h_i} - \\nu \\frac{u_i - u_{i-1}}{h_{i-1}}\n$$\nDividing by the constant weight $w_i = (h_{i-1}+h_i)/2$ gives the three-point stencil for $\\frac{du_i}{dt}$:\n$$\n\\frac{du_i}{dt} = \\frac{2\\nu}{h_{i-1}+h_i} \\left( \\frac{1}{h_{i-1}}u_{i-1} - \\left(\\frac{1}{h_{i-1}} + \\frac{1}{h_i}\\right)u_i + \\frac{1}{h_i}u_{i+1} \\right)\n$$\n\nTo prove mass conservation, we sum the conservative form of the scheme over all nodes $i=0, \\dots, N-1$:\n$$\n\\frac{d}{dt} \\sum_{i=0}^{N-1} w_i u_i(t) = \\sum_{i=0}^{N-1} \\left( F_{i+1/2} - F_{i-1/2} \\right)\n$$\nThis is a telescoping sum. Because the indices are periodic (modulo $N$), the sum evaluates to zero. Thus, the total discrete mass $M(t) = \\sum_{i=0}^{N-1} w_i u_i(t)$ is constant in time.\n\nThe discrete diffusion process drives the solution towards a steady state where $\\frac{du_i}{dt}=0$ for all $i$. This implies that the numerical flux must be constant throughout the domain, $F_{i+1/2} = \\text{const}$. On a periodic domain, this constant flux must be zero, which requires $u_{i+1}=u_i$ for all $i$. Therefore, as $t\\to\\infty$, the solution converges to a spatially constant state, $u_i(t) \\to c$.\n\nThe value of the constant $c$ is determined by mass conservation: $M(\\infty) = M(0)$.\nThe initial mass is $M(0) = \\sum_{i=0}^{N-1} w_i u_i(0)$.\nThe final mass is $M(\\infty) = \\sum_{i=0}^{N-1} w_i c = c \\sum_{i=0}^{N-1} w_i$.\nEquating them yields the final state as the weighted average of the initial data:\n$$\nc = \\frac{\\sum_{i=0}^{N-1} w_i u_i(0)}{\\sum_{i=0}^{N-1} w_i}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\sum_{i=0}^{N-1} w_{i} u_{i}(0)}{\\sum_{i=0}^{N-1} w_{i}}}\n$$"
        }
    ]
}