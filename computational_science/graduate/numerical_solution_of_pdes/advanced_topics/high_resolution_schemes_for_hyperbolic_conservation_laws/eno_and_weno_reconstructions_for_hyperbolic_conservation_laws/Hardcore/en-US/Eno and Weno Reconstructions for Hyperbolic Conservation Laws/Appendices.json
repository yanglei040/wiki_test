{
    "hands_on_practices": [
        {
            "introduction": "A primary challenge in developing high-order numerical schemes for hyperbolic conservation laws is preventing the formation of spurious oscillations near sharp features like shocks. The Essentially Non-Oscillatory (ENO) method provides an elegant solution by adaptively selecting the locally smoothest stencil for reconstruction, thereby avoiding interpolation across discontinuities. This practice provides a concrete walkthrough of the ENO stencil selection logic, where you will use divided differences to quantify smoothness and choose the optimal stencil from a set of candidates .",
            "id": "3385596",
            "problem": "Consider the scalar linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a>0$. On a uniform grid with spacing $h=1$, let $x_{j}=j$ and let the available point values be $u_{-2},u_{-1},u_{0},u_{1},u_{2}$, where $u_{j}=u(x_{j})$. You are to approximate the left-biased reconstructed value $u_{i+1/2}^{-}$ at the interface $x_{i+1/2}$ for $i=0$ using a third-order Essentially Non-Oscillatory (ENO) reconstruction based on point values and divided differences. The ENO stencil must be selected explicitly by comparing the magnitudes of the relevant divided differences at each step, starting from the point closest to the interface in the upwind direction.\n\nUse the following data: $u_{-2}=1$, $u_{-1}=2$, $u_{0}=3$, $u_{1}=20$, $u_{2}=25$. Assume $a>0$, so the upwind direction for the reconstruction at $x_{1/2}$ is from the left. Construct the quadratic interpolant on the selected ENO stencil using divided differences and evaluate it at $x_{1/2}$. Provide the resulting numerical value of $u_{1/2}^{-}$ as your final answer. No rounding is required; give an exact value.",
            "solution": "The problem requires the computation of a third-order Essentially Non-Oscillatory (ENO) reconstruction for the value $u_{1/2}^{-}$, the left-biased state at the interface $x_{1/2}$. A third-order scheme uses a quadratic polynomial, which requires a three-point stencil. The ENO algorithm adaptively selects this stencil based on the local smoothness of the data, as measured by divided differences. Since the wave speed $a>0$, the reconstruction is upwind-biased from the left.\n\n**Step 1: Calculate Divided Differences**\nWe start by computing the first and second-order divided differences from the given point values: $u_{-2}=1, u_{-1}=2, u_{0}=3, u_{1}=20, u_{2}=25$. The grid spacing is $h=1$.\n\nFirst-order divided differences:\n$u[x_{-2}, x_{-1}] = \\frac{u_{-1} - u_{-2}}{x_{-1} - x_{-2}} = \\frac{2 - 1}{1} = 1$\n$u[x_{-1}, x_{0}] = \\frac{u_{0} - u_{-1}}{x_{0} - x_{-1}} = \\frac{3 - 2}{1} = 1$\n$u[x_{0}, x_{1}] = \\frac{u_{1} - u_{0}}{x_{1} - x_{0}} = \\frac{20 - 3}{1} = 17$\n\nSecond-order divided differences:\n$u[x_{-2}, x_{-1}, x_{0}] = \\frac{u[x_{-1}, x_{0}] - u[x_{-2}, x_{-1}]}{x_{0} - x_{-2}} = \\frac{1 - 1}{2} = 0$\n$u[x_{-1}, x_{0}, x_{1}] = \\frac{u[x_{0}, x_{1}] - u[x_{-1}, x_{0}]}{x_{1} - x_{-1}} = \\frac{17 - 1}{2} = 8$\n\n**Step 2: ENO Stencil Selection**\nThe stencil is built iteratively, starting with the point in the cell associated with the reconstruction, $x_0$.\n1.  **Initial 1-point stencil**: $S_1 = \\{x_0\\}$.\n2.  **Expand to 2 points**: We compare candidate stencils $\\{x_{-1}, x_0\\}$ and $\\{x_0, x_1\\}$ by the magnitude of their first divided differences.\n    - $|u[x_{-1}, x_0]| = |1| = 1$\n    - $|u[x_0, x_1]| = |17| = 17$\n    Since $|u[x_{-1}, x_0]|$ is smaller, we choose the leftward stencil, resulting in the 2-point stencil $S_2 = \\{x_{-1}, x_0\\}$.\n3.  **Expand to 3 points**: We compare candidate stencils $\\{x_{-2}, x_{-1}, x_0\\}$ and $\\{x_{-1}, x_0, x_1\\}$ by the magnitude of their second divided differences.\n    - $|u[x_{-2}, x_{-1}, x_0]| = |0| = 0$\n    - $|u[x_{-1}, x_0, x_1]| = |8| = 8$\n    Since $|u[x_{-2}, x_{-1}, x_0]|$ is smaller, we again choose the leftward option.\n\nThe final 3-point ENO stencil is $S_{ENO} = \\{x_{-2}, x_{-1}, x_0\\}$.\n\n**Step 3: Polynomial Construction and Evaluation**\nWe construct the unique quadratic polynomial $P(x)$ that interpolates the data on the chosen stencil: $(x_{-2}, u_{-2})=(-2,1)$, $(x_{-1}, u_{-1})=(-1,2)$, and $(x_0, u_0)=(0,3)$.\nUsing the Newton form of the interpolating polynomial with base point $x_{-2}$:\n$$\nP(x) = u[x_{-2}] + u[x_{-2}, x_{-1}](x - x_{-2}) + u[x_{-2}, x_{-1}, x_0](x - x_{-2})(x - x_{-1})\n$$\nSubstituting the pre-calculated values:\n$$\nP(x) = 1 + 1 \\cdot (x - (-2)) + 0 \\cdot (x - (-2))(x - (-1)) = 1 + (x + 2) = x + 3\n$$\nThe interpolant is linear because the data points on the selected stencil are collinear (indicated by the zero second divided difference).\n\nFinally, we evaluate this polynomial at the interface $x_{1/2} = 0.5$ to get the reconstructed value:\n$$\nu_{1/2}^{-} = P(0.5) = 0.5 + 3 = 3.5 = \\frac{7}{2}\n$$",
            "answer": "$$\\boxed{\\frac{7}{2}}$$"
        },
        {
            "introduction": "While ENO methods select a single \"best\" stencil, Weighted Essentially Non-Oscillatory (WENO) schemes achieve higher accuracy by combining reconstructions from several candidate stencils. The brilliance of WENO lies in its nonlinear weighting procedure, which assigns a weight to each stencil based on its smoothness. This requires a robust mathematical measure of smoothness, a role fulfilled by the Jiang-Shu smoothness indicators, denoted as $\\beta_k$. This exercise isolates this crucial component, asking you to compute the $\\beta_k$ values for given reconstruction polynomials, thereby building a foundational understanding of how WENO quantifies smoothness .",
            "id": "3385559",
            "problem": "Consider the one-dimensional scalar hyperbolic conservation law $u_{t} + f(u)_{x} = 0$ discretized by a finite volume method on a uniform mesh with cell centers $x_{i}$ and cell width $\\Delta x$. In a Weighted Essentially Non-Oscillatory (WENO) reconstruction, multiple candidate stencils produce local reconstruction polynomials on a target cell, and their smoothness is measured using the Jiang–Shu smoothness indicators to form nonlinear weights. Let the local coordinate be $\\xi = (x - x_{i}) / \\Delta x \\in [-\\tfrac{1}{2}, \\tfrac{1}{2}]$, and suppose three candidate stencils $S_{0}$, $S_{1}$, $S_{2}$ yield quadratic reconstruction polynomials on cell $i$:\n$$\np_{0}(\\xi) = \\frac{21}{20} + \\frac{1}{5}\\,\\xi + \\frac{1}{50}\\,\\xi^{2}, \\quad\np_{1}(\\xi) = 1 - \\frac{1}{20}\\,\\xi + \\frac{3}{20}\\,\\xi^{2}, \\quad\np_{2}(\\xi) = \\frac{49}{50} + \\frac{1}{100}\\,\\xi - \\frac{1}{25}\\,\\xi^{2}.\n$$\nStarting from the definition that the Jiang–Shu smoothness indicator for a candidate polynomial is obtained by integrating appropriately scaled squared derivatives of the polynomial over the target cell, derive the explicit smoothness indicator $\\,\\beta_{k}\\,$ for each $\\,p_{k}\\,$ and compute the three values $\\,\\beta_{0}, \\beta_{1}, \\beta_{2}\\,$. Identify which stencil is deemed smoother according to this indicator (i.e., the stencil with the smallest $\\,\\beta_{k}\\,$). Express your final numerical results in exact fractional form. Provide, in order, the three smoothness indicators followed by the index $\\,k \\in \\{0,1,2\\}\\,$ of the smoothest stencil, as a single row matrix.",
            "solution": "The problem requires the computation of the Jiang-Shu smoothness indicators, $\\beta_k$, for three given quadratic reconstruction polynomials, $p_k(\\xi)$, and the identification of the smoothest stencil.\n\nThe Jiang-Shu smoothness indicator for a quadratic polynomial (degree 2, so $r-1=2$) is given by the sum of the integrated squared derivatives over the cell. In the normalized coordinate $\\xi \\in [-1/2, 1/2]$, this simplifies to:\n$$\n\\beta_k = \\int_{-1/2}^{1/2} \\left( \\frac{d p_k(\\xi)}{d\\xi} \\right)^2 d\\xi + \\int_{-1/2}^{1/2} \\left( \\frac{d^2 p_k(\\xi)}{d\\xi^2} \\right)^2 d\\xi\n$$\nWe apply this formula to each given polynomial. For integrals over a symmetric interval, $\\int_{-a}^a f(\\xi) d\\xi$, odd parts of the integrand vanish and even parts equal $2\\int_0^a f(\\xi) d\\xi$.\n\n**For stencil $S_0$:** $p_{0}(\\xi) = \\frac{21}{20} + \\frac{1}{5}\\xi + \\frac{1}{50}\\xi^{2}$\nThe derivatives are $\\frac{dp_0}{d\\xi} = \\frac{1}{5} + \\frac{1}{25}\\xi$ and $\\frac{d^2p_0}{d\\xi^2} = \\frac{1}{25}$.\nThe integrals are:\n$\\int_{-1/2}^{1/2} \\left( \\frac{1}{5} + \\frac{1}{25}\\xi \\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left( \\frac{1}{25} + \\frac{2}{125}\\xi + \\frac{1}{625}\\xi^2 \\right) d\\xi = \\left[ \\frac{1}{25}\\xi + \\frac{1}{1875}\\xi^3 \\right]_{-1/2}^{1/2} = \\frac{1}{25} + \\frac{1}{7500} = \\frac{301}{7500}$.\n$\\int_{-1/2}^{1/2} \\left( \\frac{1}{25} \\right)^2 d\\xi = \\frac{1}{625}$.\nThus, $\\beta_0 = \\frac{301}{7500} + \\frac{1}{625} = \\frac{301}{7500} + \\frac{12}{7500} = \\frac{313}{7500}$.\n\n**For stencil $S_1$:** $p_{1}(\\xi) = 1 - \\frac{1}{20}\\xi + \\frac{3}{20}\\xi^{2}$\nThe derivatives are $\\frac{dp_1}{d\\xi} = -\\frac{1}{20} + \\frac{3}{10}\\xi$ and $\\frac{d^2p_1}{d\\xi^2} = \\frac{3}{10}$.\nThe integrals are:\n$\\int_{-1/2}^{1/2} \\left( -\\frac{1}{20} + \\frac{3}{10}\\xi \\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left( \\frac{1}{400} - \\frac{3}{100}\\xi + \\frac{9}{100}\\xi^2 \\right) d\\xi = \\left[ \\frac{1}{400}\\xi + \\frac{3}{100}\\xi^3 \\right]_{-1/2}^{1/2} = \\frac{1}{400} + \\frac{3}{400} = \\frac{4}{400} = \\frac{1}{100}$.\n$\\int_{-1/2}^{1/2} \\left( \\frac{3}{10} \\right)^2 d\\xi = \\frac{9}{100}$.\nThus, $\\beta_1 = \\frac{1}{100} + \\frac{9}{100} = \\frac{10}{100} = \\frac{1}{10}$.\n\n**For stencil $S_2$:** $p_{2}(\\xi) = \\frac{49}{50} + \\frac{1}{100}\\xi - \\frac{1}{25}\\xi^{2}$\nThe derivatives are $\\frac{dp_2}{d\\xi} = \\frac{1}{100} - \\frac{2}{25}\\xi$ and $\\frac{d^2p_2}{d\\xi^2} = -\\frac{2}{25}$.\nThe integrals are:\n$\\int_{-1/2}^{1/2} \\left( \\frac{1}{100} - \\frac{2}{25}\\xi \\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left( \\frac{1}{10000} - \\frac{1}{1250}\\xi + \\frac{4}{625}\\xi^2 \\right) d\\xi = \\left[ \\frac{1}{10000}\\xi + \\frac{4}{1875}\\xi^3 \\right]_{-1/2}^{1/2} = \\frac{1}{10000} + \\frac{4}{7500} = \\frac{19}{30000}$.\n$\\int_{-1/2}^{1/2} \\left( -\\frac{2}{25} \\right)^2 d\\xi = \\frac{4}{625}$.\nThus, $\\beta_2 = \\frac{19}{30000} + \\frac{4}{625} = \\frac{19}{30000} + \\frac{192}{30000} = \\frac{211}{30000}$.\n\n**Comparison and Conclusion**\nWe compare the three smoothness indicators:\n$$\n\\beta_0 = \\frac{313}{7500} \\approx 0.04173, \\quad \\beta_1 = \\frac{1}{10} = 0.1, \\quad \\beta_2 = \\frac{211}{30000} \\approx 0.00703\n$$\nSince $\\beta_2  \\beta_0  \\beta_1$, the polynomial $p_2(\\xi)$ is the smoothest on the cell. Therefore, the smoothest stencil is $S_2$, indexed by $k=2$. The final results are $\\beta_0 = \\frac{313}{7500}$, $\\beta_1 = \\frac{1}{10}$, $\\beta_2 = \\frac{211}{30000}$, and the smoothest stencil index is $2$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{313}{7500}  \\frac{1}{10}  \\frac{211}{30000}  2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "This practice synthesizes the core concepts of the WENO method to demonstrate its effectiveness in handling discontinuities. Starting with data that contains a sharp jump, you will compute the smoothness indicators and then proceed to calculate the final nonlinear weights that determine each stencil's contribution to the reconstruction. By calculating a \"suppression factor,\" you will quantitatively observe how the WENO framework automatically identifies the stencil crossing the discontinuity and reduces its weight to a near-zero value, thus achieving its celebrated non-oscillatory behavior .",
            "id": "3385570",
            "problem": "Consider the scalar hyperbolic conservation law $u_{t} + f(u)_{x} = 0$ discretized on a uniform grid with spacing $\\Delta x$, where one approximates the numerical flux at the interface $x_{i+1/2}$ by a convex combination of candidate polynomial reconstructions selected from upwind-biased three-point stencils. In the Weighted Essentially Non-Oscillatory (WENO) framework of Jiang and Shu (JS), nonlinear weights suppress contributions from stencils that cross a discontinuity by amplifying their smoothness indicators.\n\nYou are given pointwise nodal samples of the physical flux $f(u)$ on the stencil indices $\\{i-2,i-1,i,i+1,i+2\\}$ at a time when the data contain a single jump located between $x_{i+1}$ and $x_{i+2}$:\n$$\nf_{i-2} = 1.0,\\quad f_{i-1} = 1.1,\\quad f_{i} = 1.2,\\quad f_{i+1} = 1.3,\\quad f_{i+2} = 5.0.\n$$\nUse the standard fifth-order finite-difference WENO-JS reconstruction at the interface $x_{i+1/2}$ with ideal linear weights $d_{0} = 0.1$, $d_{1} = 0.6$, $d_{2} = 0.3$, a small positive parameter $\\epsilon = 10^{-6}$ to avoid division by zero, and power $p = 2$ in the nonlinear weight formula. Starting from the foundational definitions of the WENO-JS smoothness indicators and their role in determining the nonlinear weights, compute the three nonlinear weights $w_{0}$, $w_{1}$, and $w_{2}$ for the stencils $\\{i-2,i-1,i\\}$, $\\{i-1,i,i+1\\}$, and $\\{i,i+1,i+2\\}$, respectively. Then quantify the suppression of the discontinuity-crossing stencil by reporting the suppression factor\n$$\nS := \\frac{w_{2}}{d_{2}},\n$$\nwhich measures how small the nonlinear weight $w_{2}$ is relative to its ideal weight $d_{2}$.\n\nRound all entries of your final answer to four significant figures. No physical units are required. Express angles, if any arise, in radians.",
            "solution": "The problem requires computing the nonlinear weights ($w_0, w_1, w_2$) for a fifth-order finite-difference WENO-JS scheme and a suppression factor $S$ for data containing a discontinuity.\n\n**1. Compute Smoothness Indicators ($\\beta_k$)**\nThe Jiang-Shu smoothness indicators for the three stencils $S_0, S_1, S_2$ are calculated using the standard formulas and the given flux values: $f_{i-2}=1.0, f_{i-1}=1.1, f_i=1.2, f_{i+1}=1.3, f_{i+2}=5.0$.\n\nFor $S_0 = \\{i-2, i-1, i\\}$:\n$\\beta_0 = \\frac{13}{12}(f_{i-2} - 2f_{i-1} + f_i)^2 + \\frac{1}{4}(f_{i-2} - 4f_{i-1} + 3f_i)^2$\n$\\beta_0 = \\frac{13}{12}(1.0 - 2(1.1) + 1.2)^2 + \\frac{1}{4}(1.0 - 4(1.1) + 3(1.2))^2$\n$\\beta_0 = \\frac{13}{12}(0.0)^2 + \\frac{1}{4}(0.2)^2 = 0.01$\n\nFor $S_1 = \\{i-1, i, i+1\\}$:\n$\\beta_1 = \\frac{13}{12}(f_{i-1} - 2f_i + f_{i+1})^2 + \\frac{1}{4}(f_{i-1} - f_{i+1})^2$\n$\\beta_1 = \\frac{13}{12}(1.1 - 2(1.2) + 1.3)^2 + \\frac{1}{4}(1.1 - 1.3)^2$\n$\\beta_1 = \\frac{13}{12}(0.0)^2 + \\frac{1}{4}(-0.2)^2 = 0.01$\n\nFor $S_2 = \\{i, i+1, i+2\\}$:\n$\\beta_2 = \\frac{13}{12}(f_i - 2f_{i+1} + f_{i+2})^2 + \\frac{1}{4}(3f_i - 4f_{i+1} + f_{i+2})^2$\n$\\beta_2 = \\frac{13}{12}(1.2 - 2(1.3) + 5.0)^2 + \\frac{1}{4}(3(1.2) - 4(1.3) + 5.0)^2$\n$\\beta_2 = \\frac{13}{12}(3.6)^2 + \\frac{1}{4}(3.4)^2 = 14.04 + 2.89 = 16.93$\n\nAs expected, $\\beta_2$ is much larger, indicating the discontinuity within stencil $S_2$.\n\n**2. Compute Nonlinear Weights ($w_k$)**\nThe nonlinear weights are calculated as $w_k = \\alpha_k / \\sum_j \\alpha_j$, where $\\alpha_k = d_k / (\\beta_k + \\epsilon)^p$.\nWe use the given parameters: $d_0=0.1, d_1=0.6, d_2=0.3$, $\\epsilon=10^{-6}$, and $p=2$.\n\nUn-normalized weights $\\alpha_k$:\n$\\alpha_0 = \\frac{0.1}{(0.01 + 10^{-6})^2} \\approx \\frac{0.1}{0.00010002} \\approx 999.800$\n$\\alpha_1 = \\frac{0.6}{(0.01 + 10^{-6})^2} \\approx \\frac{0.6}{0.00010002} \\approx 5998.800$\n$\\alpha_2 = \\frac{0.3}{(16.93 + 10^{-6})^2} \\approx \\frac{0.3}{286.6249} \\approx 0.00104666$\n\nThe sum is $\\sum_j \\alpha_j \\approx 999.800 + 5998.800 + 0.00104666 = 6998.601$.\n\nNormalized nonlinear weights $w_k$:\n$w_0 = \\frac{999.800}{6998.601} \\approx 0.142857$\n$w_1 = \\frac{5998.800}{6998.601} \\approx 0.857143$\n$w_2 = \\frac{0.00104666}{6998.601} \\approx 1.49553 \\times 10^{-7}$\n\nRounding to four significant figures, we get $w_0 = 0.1429$, $w_1 = 0.8571$, and $w_2 = 1.496 \\times 10^{-7}$.\n\n**3. Compute the Suppression Factor ($S$)**\nThe suppression factor for stencil $S_2$ is $S = w_2 / d_2$.\n$S = \\frac{1.49553 \\times 10^{-7}}{0.3} \\approx 4.98510 \\times 10^{-7}$\n\nRounding to four significant figures, $S = 4.985 \\times 10^{-7}$. This shows that the contribution of the stencil crossing the shock has been suppressed to a tiny fraction of its ideal value.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1429  0.8571  1.496 \\times 10^{-7}  4.985 \\times 10^{-7} \\end{pmatrix}}\n$$"
        }
    ]
}