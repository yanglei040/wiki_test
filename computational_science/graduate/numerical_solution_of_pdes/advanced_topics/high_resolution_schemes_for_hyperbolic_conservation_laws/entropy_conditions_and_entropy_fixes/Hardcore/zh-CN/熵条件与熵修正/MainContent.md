## 引言
在模拟气体动力学、天气预报乃至交通流等众多物理现象时，[双曲守恒律](@entry_id:147752)扮演着核心角色。然而，这些方程的解有一个棘手的特性：即使从光滑的初始状态出发，也可能在有限时间内形成激波等[不连续性](@entry_id:144108)，使得经典的[强解](@entry_id:198344)概念失效。为了处理这种[不连续性](@entry_id:144108)，数学家和工程师转向了更具包容性的弱解框架。但这又引入了一个新的、更为根本的难题——对于同一个问题，[弱解](@entry_id:161732)可能不是唯一的。那么，我们如何从无穷多的数学可能性中，筛选出那个唯一符合物理现实的解呢？

本文旨在系统性地解答这一问题，深入探讨[熵条件](@entry_id:166346)这一关键筛选准则及其在数值计算中的实现，即[熵修正](@entry_id:749021)。在接下来的内容中，我们将分三个部分展开：首先，在**“原理与机制”**一章中，我们将从弱解的非唯一性问题出发，详细阐述Lax、Oleinik及Kruzhkov等不同[熵条件](@entry_id:166346)的数学原理，并揭示为何像Roe格式这样的优秀数值方案会产生熵违反，以及如何通过[熵修正](@entry_id:749021)来纠正它。接着，在**“应用与交叉学科联系”**一章中，我们将展示这些理论如何在气体动力学、水力学、等离子体物理等多个领域找到具体应用，并如何与时间积分、[网格自适应](@entry_id:751899)等计算科学议题深度融合。最后，在**“动手实践”**部分，我们将通过具体的计算和编程练习，让读者亲手实现熵修复，直观感受其在确保数值模拟物理真实性中的强大作用。

## 原理与机制

在“引言”部分，我们已经了解到，[非线性](@entry_id:637147)[双曲守恒律](@entry_id:147752)的解即使从光滑的[初始条件](@entry_id:152863)出发，也可能在有限时间内形成不连续性，即激波。这使得经典的（强）解概念不再适用，迫使我们转向[弱解](@entry_id:161732)的框架。然而，[弱解](@entry_id:161732)的框架本身又带来了新的挑战：对于给定的[初值问题](@entry_id:144620)，[弱解](@entry_id:161732)可能不唯一。本章旨在深入探讨用以筛选出物理上唯一相关解的附加准则——[熵条件](@entry_id:166346)，并阐述在数值计算中如何修正那些可能违反此条件的算法。

### [弱解](@entry_id:161732)的非唯一性问题

我们从一维[标量守恒律](@entry_id:754532)出发：
$$
\partial_t u + \partial_x f(u) = 0
$$
其中 $u(x,t)$ 是[守恒量](@entry_id:150267)，$f(u)$ 是其通量函数。对于可能包含[不连续性](@entry_id:144108)的解，我们使用其积分形式。当一个解 $u(x,t)$ 是分片光滑的，并在一条曲线 $x = \phi(t)$ 上存在跳跃时，通过在不连续点周围取一个无限小的[时空控制](@entry_id:180923)区域并应用[积分守恒律](@entry_id:202878)，可以推导出联系间断两侧状态 ($u_L$ 和 $u_R$) 与间断传播速度 $s = \phi'(t)$ 的关系。这个关系被称为 **Rankine–Hugoniot (RH) [跳跃条件](@entry_id:750965)**  。

其推导过程如下：考虑一个包含激波路径的任意时空区域 $\Omega$，根据散度定理，积分形式的守恒律意味着沿 $\Omega$ 边界的[通量积分](@entry_id:138365)为零。将此思想应用于一个跨越激波的无限小矩形，我们可以得到：
$$
s(u_R - u_L) = f(u_R) - f(u_L)
$$
或者使用跳跃符号 $[g] = g_R - g_L$ 简写为 $s[u] = [f(u)]$。这个代数方程是任何不连续[弱解](@entry_id:161732)必须满足的基本[运动学](@entry_id:173318)关系。

然而，仅凭 RH 条件不足以确定唯一的物理相关解。考虑经典的 **Burgers 方程**，其通量为 $f(u) = \frac{1}{2}u^2$。这是一个严格凸函数，因为 $f''(u) = 1 > 0$。其特征速度为 $c(u) = f'(u) = u$。

现在，我们考察一个[初始条件](@entry_id:152863)为 $u_L  u_R$ 的黎曼问题，例如 $u_L = -1, u_R = 1$ 。由于左侧特征速度 $c(u_L) = -1$ 小于右侧特征速度 $c(u_R) = 1$，特征线是发散的。这表明解应该是连续的，并且随时间扩展。事实上，存在一个连续的[自相似解](@entry_id:164839)，称为**[稀疏波](@entry_id:168428)**（rarefaction wave）：
$$
u(x,t) = \begin{cases} -1,  \frac{x}{t} \le -1, \\ \frac{x}{t},  -1  \frac{x}{t}  1, \\ 1,  \frac{x}{t} \ge 1. \end{cases}
$$
这个解在 $t0$ 时连续，并且逐点满足[偏微分方程](@entry_id:141332)，因此它是一个有效的[弱解](@entry_id:161732)。

但与此同时，我们也可以尝试构建一个满足 RH 条件的不连续解。计算跳跃速度 $s$：
$$
s = \frac{f(u_R) - f(u_L)}{u_R - u_L} = \frac{\frac{1}{2}(1)^2 - \frac{1}{2}(-1)^2}{1 - (-1)} = \frac{0}{2} = 0
$$
这意味着一个速度为零的静止激波也是 RH 条件允许的。这个不连续解的形式为：
$$
u(x,t) = \begin{cases} -1,  x  0, \\ 1,  x > 0. \end{cases}
$$
这是一个在 $x=0$ 处的固定跳跃。由于它也满足 RH 条件，因此它也是一个有效的弱解。

同一个[初值问题](@entry_id:144620)产生了两个截然不同的弱解：一个连续的[稀疏波](@entry_id:168428)和一个不连续的“膨胀激波”（expansion shock）。这种非唯一性表明，必须引入一个额外的物理原则来筛选出正确的解。

### [熵条件](@entry_id:166346)作为筛选原则

在物理世界中，守恒律通常是包含耗散或粘性项的更复杂模型的理想化极限。例如，Burgers 方程可以看作是粘性 Burgers 方程 $u_t + f(u)_x = \epsilon u_{xx}$ 在粘性系数 $\epsilon \to 0^+$ 时的极限。物理上相关的解应该是这个极限下得到的解。这个思想催生了**[熵条件](@entry_id:166346)**。

对于[标量守恒律](@entry_id:754532)，[熵条件](@entry_id:166346)可以通过**熵-熵通量对** $(\eta, q)$ 来表述。其中，**熵函数** $\eta(u)$ 是一个任意的严格凸函数（即 $\eta''(u)  0$），而相应的**熵通量函数** $q(u)$ 通过以下**[相容性关系](@entry_id:157858)**与 $\eta(u)$ 和物理通量 $f(u)$ 相联系 ：
$$
q'(u) = \eta'(u)f'(u)
$$
对于光滑解，$u_t = -f'(u)u_x$。将其代入 $\eta(u)_t + q(u)_x = \eta'(u)u_t + q'(u)u_x = 0$ 中，我们得到 $(q'(u) - \eta'(u)f'(u))u_x = 0$，这便导出了上述[相容性关系](@entry_id:157858)。

例如，对于 Burgers 方程 $f(u) = \frac{1}{2}u^2$ 和最常用的二次熵 $\eta(u) = \frac{1}{2}u^2$，我们有 $\eta'(u) = u$ 和 $f'(u) = u$。因此，$q'(u) = u \cdot u = u^2$。积分可得（取积分常数为零）$q(u) = \frac{1}{3}u^3$ 。

物理上可接受的[弱解](@entry_id:161732) $u$ 必须对任意凸熵 $\eta$ 满足**[熵不等式](@entry_id:184404)** ：
$$
\partial_t \eta(u) + \partial_x q(u) \le 0
$$
该不等式应在[分布](@entry_id:182848)意义下成立。这个不等式表达了物理过程的不可逆性，类似于[热力学第二定律](@entry_id:142732)，即总熵只能增加（或在理想[可逆过程](@entry_id:276625)中保持不变），对应于这里的熵耗散。

对于跨越[不连续面](@entry_id:180188)的情况，这个[分布](@entry_id:182848)不等式等价于一个代数跳跃不等式：
$$
s[\eta] \le [q]
$$
其中 $s$ 是激[波速](@entry_id:186208)度。我们可以定义一个**[熵产生](@entry_id:141771)率** $E = [q] - s[\eta]$，[熵条件](@entry_id:166346)要求 $E \le 0$。一个物理激波必须是熵耗散的，即 $E  0$ 。对于一个 $u_L=2, u_R=0$ 的 Burgers 激波，其速度 $s=1$。使用 $\eta(u)=u^2/2$ 和 $q(u)=u^3/3$，我们计算出 $E = [q] - s[\eta] = (-\frac{8}{3}) - 1 \cdot (-2) = -\frac{2}{3}  0$，表明这是一个耗散的、物理上可接受的激波 。

### 激波的可接受性条件

虽然[熵不等式](@entry_id:184404)是通用的，但在特定情况下可以简化为更易于操作的判据。

#### Lax [熵条件](@entry_id:166346)（针对凸通量）

对于像 Burgers 方程这样具有严格凸通量 $f(u)$ 的情况，[熵不等式](@entry_id:184404)可以简化为著名的 **Lax [熵条件](@entry_id:166346)**。该条件从几何上看，要求特征线必须从两侧“汇入”激波，而不是从激波处“流出”。用数学语言表达为 ：
$$
f'(u_L) > s > f'(u_R)
$$
这个条件直观地描述了一个“压缩”过程。让我们用这个条件来重新审视之前的非唯一性问题：
1.  **压缩激波 ($u_L > u_R$)**: 例如 $u_L=1, u_R=0$。RH 条件给出 $s = \frac{1}{2}(u_L+u_R) = 1/2$。特征速度为 $f'(u_L)=1, f'(u_R)=0$。Lax 条件 $1 > 1/2 > 0$ 成立。因此，这是一个可接受的激波。
2.  **膨胀激波 ($u_L  u_R$)**: 例如 $u_L=-1, u_R=1$。RH 条件给出 $s = 0$。[特征速度](@entry_id:165394)为 $f'(u_L)=-1, f'(u_R)=1$。Lax 条件 $-1 > 0 > 1$ 不成立。因此，这个不连续解（膨胀激波）是不可接受的。正确的解是[稀疏波](@entry_id:168428)。

#### Oleinik [熵条件](@entry_id:166346)（针对非凸通量）

当通量函数非凸时，例如 $f(u) = u^3 - u$（其[二阶导数](@entry_id:144508) $f''(u)=6u$ 变号），Lax 条件不再适用。更一般的 **Oleinik [熵条件](@entry_id:166346)** (或称为E-条件) 要求，对于任意位于 $u_R$ 和 $u_L$ 之间的状态 $u$，连接 $(u_L, f(u_L))$ 和 $(u_R, f(u_R))$ 的弦不能位于 $f(u)$ 图像的下方。

这个条件允许出现更复杂的波结构。例如，对于 $f(u)=u^3-u$ 和 $u_L > 0 > u_R$ 的情况，直接连接 $u_L$ 和 $u_R$ 的单个激波通常会违反 Oleinik 条件。正确的熵解可能是一个**复合波**，它由一个激波和一个[稀疏波](@entry_id:168428)连接而成，其结构由通量函数的[凸包](@entry_id:262864)决定 。例如，解可能包含一个从 $u_L$ 到某个中间状态 $u_*$ 的波，再由一个与 $f(u)$ 图像在 $u_*$ 点相切的激波连接到 $u_R$。

### 一个普适的理论基础：Kruzhkov 条件

前面讨论的[熵条件](@entry_id:166346)虽然有效，但它们依赖于特定的熵函数或通量的凸性。S. N. Kruzhkov 提出了一个更为普适和强大的[熵条件](@entry_id:166346)，它对所有[标量守恒律](@entry_id:754532)都有效，并且是证明熵解存在性和唯一性的关键。

**Kruzhkov [熵条件](@entry_id:166346)** 要求，对于**所有**常数 $k \in \mathbb{R}$，弱解 $u$ 都必须满足以下[熵不等式](@entry_id:184404) ：
$$
\partial_t |u-k| + \partial_x \left( \mathrm{sgn}(u-k)(f(u)-f(k)) \right) \le 0
$$
这里，熵函数族是 $\eta_k(u) = |u-k|$，对应的熵通量族是 $q_k(u) = \mathrm{sgn}(u-k)(f(u)-f(k))$。

这个条件的核心力量在于它对所有 $k$ 都成立。利用这个性质，通过精巧的“变量加倍”技术，可以证明熵解的一个关键性质：**$L^1$ 收缩原理**。即对于任意两个熵解 $u(x,t)$ 和 $v(x,t)$，它们在 $L^1$ 范数下的距离随时间不增：
$$
\|u(\cdot, t) - v(\cdot, t)\|_{L^1(\mathbb{R})} \le \|u(\cdot, s) - v(\cdot, s)\|_{L^1(\mathbb{R})}, \quad \text{对于所有 } 0 \le s \le t.
$$
这个原理直接导出了两个重要推论：
1.  **唯一性**：如果两个熵解的初始条件相同（$u_0 = v_0$），那么它们在任何时刻都相同。
2.  **稳定性**：解在 $L^1$ 范数下连续依赖于初始数据。

Kruzhkov 条件为[标量守恒律](@entry_id:754532)理论提供了坚实的数学基础，保证了我们所寻找的“物理相关解”是良定的。

### [数值格式](@entry_id:752822)中的熵违反与[熵修正](@entry_id:749021)

从连续理论转向离散的数值方法（如有限体积法），一个核心问题是数值解是否收敛到正确的熵解。许多优秀的数值格式，尤其是那些为精确捕捉激波而设计的格式，可能会在某些特定情况下产生违反[熵条件](@entry_id:166346)的解。

**Roe 格式**是一个著名的例子。它是一种[近似黎曼求解器](@entry_id:267136)，通过在每个单元界面上线性化问题来计算[数值通量](@entry_id:752791)。其优点是能够以极高的精度解析单个激波。然而，它有一个致命的缺陷，通常被称为“熵失效”或“熵误差”。

这个问题在所谓的**[跨音速稀疏波](@entry_id:756129)**（transonic rarefaction）情况下尤为突出 。这种情况发生在特征速度跨越零点时，例如对于 Burgers 方程，初值为 $u_L  0  u_R$。此时，Roe 格式所用的平均速度 $\tilde{a}$（对于 Burgers 方程，$\tilde{a} = \frac{u_L+u_R}{2}$）可能非常接近甚至等于零。

Roe 格式的[数值通量](@entry_id:752791)可以写成中心项和耗散项之和：
$$
F(u_L, u_R) = \frac{1}{2} [f(u_L) + f(u_R)] - \frac{1}{2} |\tilde{a}| (u_R - u_L)
$$
其中的耗散项（或称[数值粘性](@entry_id:142854)）正比于 $|\tilde{a}|$。当 $\tilde{a} \to 0$ 时，耗散项消失，Roe 通量退化为一个无耗散的中心格式。这导致[数值格式](@entry_id:752822)无法将解“铺开”形成正确的[稀疏波](@entry_id:168428)，反而会收敛到一个不满足[熵条件](@entry_id:166346)的、错误的静止膨胀激波 。

为了解决这个问题，必须引入**[熵修正](@entry_id:749021)**（entropy fix）。这是一种对原始[数值格式](@entry_id:752822)的修改，旨在人为地在跨音速区域补充必要的数值耗散。一个常见的[熵修正](@entry_id:749021)方法（如 Harten-Hyman 修正）是，当 Roe 速度的[绝对值](@entry_id:147688) $|\tilde{a}|$ 小于某个阈值 $\delta$ 时，用一个恒为正的函数 $\psi(\tilde{a})$ 来代替它 。例如：
$$
\psi(\lambda) = \begin{cases} |\lambda|,  |\lambda| \ge \delta \\ \frac{\lambda^2 + \delta^2}{2\delta},  |\lambda|  \delta \end{cases}
$$
这个修正保证了即使在 $\tilde{a}=0$ 时，耗散项也不会消失，从而阻止了非物理膨胀激波的形成，使得数值解能够正确地逼近[稀疏波](@entry_id:168428)。

### 推广与高级主题

[熵条件](@entry_id:166346)和[熵修正](@entry_id:749021)的概念可以推广到更复杂的情形。

#### [守恒律方程组](@entry_id:755768)

对于 $N \times N$ 的[守恒律方程组](@entry_id:755768) $\mathbf{q}_t + \mathbf{f}(\mathbf{q})_x = 0$，其雅可比矩阵 $A(\mathbf{q}) = D\mathbf{f}(\mathbf{q})$ 有 $N$ 个[特征值](@entry_id:154894)（特征速度）$\lambda_i$ 和对应的右[特征向量](@entry_id:151813) $\mathbf{r}_i$。Lax [熵条件](@entry_id:166346)可以推广到第 $i$ 个特征族上 ：一个第 $i$ 族激波是可接受的，如果：
$$
\lambda_i(\mathbf{q}_L) > s > \lambda_i(\mathbf{q}_R)
$$
并且对于其他特征族 $k \ne i$，特征线必须完全快于或慢于激波。如果一个特征场是**真正[非线性](@entry_id:637147)的**（genuinely nonlinear），即 $\nabla \lambda_i \cdot \mathbf{r}_i \neq 0$，那么[特征速度](@entry_id:165394) $\lambda_i$ 会沿着[积分曲线](@entry_id:161858)严格单调变化，这使得激波和[稀疏波](@entry_id:168428)的区分变得清晰。

#### 多维问题与[熵稳定格式](@entry_id:749017)

在多维空间中，[标量守恒律](@entry_id:754532)及其[熵不等式](@entry_id:184404)可以自然地写为 ：
$$
\partial_t u + \nabla \cdot \mathbf{F}(u) = 0, \quad \partial_t \eta(u) + \nabla \cdot \mathbf{q}(u) \le 0
$$
设计能满足[离散熵不等式](@entry_id:748505)的多维[数值格式](@entry_id:752822)是一个活跃的研究领域。现代方法致力于构建**[熵稳定格式](@entry_id:749017)**。其核心思想是，[数值通量](@entry_id:752791)可以分解为一个**[熵守恒通量](@entry_id:749013)**和一个数值耗散项。通过精心设计耗散项，可以保证在每个单元格内都满足一个离散的[熵不等式](@entry_id:184404)。Tadmor 提出的基于界面（face-based）的[熵不等式](@entry_id:184404)为此类格式的构建和验证提供了坚实的理论基础，确保了数值解的稳定性和对物理相关解的正确收敛。

总结而言，[熵条件](@entry_id:166346)是现代[双曲守恒律](@entry_id:147752)理论的基石。它不仅在连续理论层面解决了弱解的非唯一性问题，也为设计和修正能够鲁棒地计算[复杂流动](@entry_id:747569)现象的数值方法提供了根本性的指导。