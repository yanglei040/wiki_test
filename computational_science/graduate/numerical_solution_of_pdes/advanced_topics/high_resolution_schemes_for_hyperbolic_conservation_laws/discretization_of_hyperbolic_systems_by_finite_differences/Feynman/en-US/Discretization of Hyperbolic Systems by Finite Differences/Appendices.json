{
    "hands_on_practices": [
        {
            "introduction": "The first step in evaluating a numerical scheme is understanding the types of errors it introduces. For hyperbolic equations, these errors primarily manifest as numerical diffusion, which damps wave amplitudes, and numerical dispersion, which causes waves of different frequencies to travel at incorrect speeds. This practice uses Fourier analysis on the first-order upwind scheme, a fundamental building block for many methods, to precisely quantify these two error types. By deriving the leading-order terms for amplitude and phase error , you will gain a concrete understanding of how a discretization choice impacts solution accuracy and develop the analytical tools needed to assess any finite difference scheme.",
            "id": "3380633",
            "problem": "Consider the linear hyperbolic system $q_{t} + A q_{x} = 0$ on a one-dimensional periodic domain, where $A \\in \\mathbb{R}^{m \\times m}$ is a constant, diagonalizable matrix with real spectrum. Let $A = R \\Lambda R^{-1}$ with $\\Lambda = \\operatorname{diag}(a_{1},\\dots,a_{m})$, and focus on a single right-going characteristic field associated with eigenvalue $a > 0$ and eigenvector $r \\in \\mathbb{R}^{m}$, so that the corresponding scalar characteristic variable $u = \\ell^{\\top} q$ (with $\\ell^{\\top} R = e_{j}^{\\top}$ for the chosen field) satisfies the scalar advection equation $u_{t} + a u_{x} = 0$.\n\nOn a uniform grid $x_{i} = i\\,\\Delta x$ and time levels $t^{n} = n\\,\\Delta t$, consider the explicit first-order upwind finite difference scheme applied to the chosen characteristic field,\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda \\left(u_{i}^{n} - u_{i-1}^{n}\\right),\n$$\nwhere $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ is the Courant number. Assume a monochromatic discrete mode aligned with the chosen eigenvector,\n$$\nu_{i}^{n} = \\exp\\!\\left(i\\,\\kappa\\, i - i\\,\\omega\\, n\\right), \\quad \\kappa = k\\,\\Delta x,\n$$\nwith continuous wavenumber $k$ and dimensionless discrete wavenumber $\\kappa$. Define the one-step numerical amplification factor $G(\\kappa)$ by $u_{i}^{n+1} = G(\\kappa)\\,u_{i}^{n}$, and define:\n- the one-step amplitude error by $\\delta A(\\kappa) = |G(\\kappa)| - 1$,\n- the one-step phase error by $\\delta \\phi(\\kappa) = \\phi(\\kappa) + \\lambda\\,\\kappa$, where $\\phi(\\kappa) = \\arg\\!\\left(G(\\kappa)\\right)$ and the exact phase shift per step is $-\\lambda\\,\\kappa$.\n\nStarting from the fundamental definitions above, and using Fourier (von Neumann) analysis together with a Taylor expansion-based modified equation analysis for the finite difference scheme, derive the leading-order expressions in $\\kappa$ for both $\\delta A(\\kappa)$ and $\\delta \\phi(\\kappa)$ as functions of $\\lambda$ and $\\kappa$. Explicitly state the final expressions for the leading-order terms. Express the phase error in radians per time step. The final answer must consist of the pair $\\left(\\delta A(\\kappa),\\,\\delta \\phi(\\kappa)\\right)$ as a closed-form analytic expression.",
            "solution": "The problem asks for the leading-order expressions for the amplitude and phase errors of the first-order upwind scheme for the linear advection equation. We will use Fourier (von Neumann) analysis to derive these expressions.\n\nThe scalar advection equation is given by\n$$u_{t} + a u_{x} = 0$$\nwhere $a > 0$ is the constant wave speed.\nThe first-order upwind finite difference scheme is\n$$u_{i}^{n+1} = u_{i}^{n} - \\lambda \\left(u_{i}^{n} - u_{i-1}^{n}\\right)$$\nwhere $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ is the Courant number.\n\nTo perform the Fourier analysis, we substitute a single monochromatic mode of the form $u_{j}^{m} = G(\\kappa)^m \\exp(i\\kappa j)$ into the scheme. Here, $\\kappa = k\\,\\Delta x$ is the dimensionless wavenumber, and $G(\\kappa)$ is the complex amplification factor.\n$$\nG(\\kappa)^{n+1} e^{i\\kappa i} = G(\\kappa)^{n} e^{i\\kappa i} - \\lambda \\left(G(\\kappa)^{n} e^{i\\kappa i} - G(\\kappa)^{n} e^{i\\kappa (i-1)}\\right)\n$$\nDividing by $G(\\kappa)^{n} e^{i\\kappa i}$, we obtain the expression for the amplification factor:\n$$\nG(\\kappa) = 1 - \\lambda \\left(1 - e^{-i\\kappa}\\right)\n$$\nUsing Euler's formula, $e^{-i\\kappa} = \\cos(\\kappa) - i\\sin(\\kappa)$, we can write $G(\\kappa)$ in terms of its real and imaginary parts:\n$$\nG(\\kappa) = 1 - \\lambda(1 - \\cos(\\kappa) + i\\sin(\\kappa)) = (1 - \\lambda + \\lambda\\cos(\\kappa)) - i\\lambda\\sin(\\kappa)\n$$\n\nThe one-step amplitude error is defined as $\\delta A(\\kappa) = |G(\\kappa)| - 1$. We first compute the squared magnitude of $G(\\kappa)$:\n$$\n|G(\\kappa)|^2 = (1 - \\lambda + \\lambda\\cos(\\kappa))^2 + (-\\lambda\\sin(\\kappa))^2\n$$\n$$\n|G(\\kappa)|^2 = (1-\\lambda)^2 + 2\\lambda(1-\\lambda)\\cos(\\kappa) + \\lambda^2\\cos^2(\\kappa) + \\lambda^2\\sin^2(\\kappa)\n$$\n$$\n|G(\\kappa)|^2 = (1-\\lambda)^2 + 2\\lambda(1-\\lambda)\\cos(\\kappa) + \\lambda^2(\\cos^2(\\kappa) + \\sin^2(\\kappa))\n$$\n$$\n|G(\\kappa)|^2 = 1 - 2\\lambda + \\lambda^2 + 2\\lambda\\cos(\\kappa) - 2\\lambda^2\\cos(\\kappa) + \\lambda^2\n$$\n$$\n|G(\\kappa)|^2 = 1 - 2\\lambda + 2\\lambda^2 + (2\\lambda - 2\\lambda^2)\\cos(\\kappa)\n$$\n$$\n|G(\\kappa)|^2 = 1 + 2\\lambda(\\lambda-1) - 2\\lambda(\\lambda-1)\\cos(\\kappa) = 1 + 2\\lambda(\\lambda-1)(1 - \\cos(\\kappa))\n$$\nFor small $\\kappa$, we use the Taylor series expansion for $\\cos(\\kappa) = 1 - \\frac{\\kappa^2}{2!} + \\frac{\\kappa^4}{4!} - \\dots$.\n$$\n1 - \\cos(\\kappa) = \\frac{\\kappa^2}{2} - \\frac{\\kappa^4}{24} + O(\\kappa^6)\n$$\nSubstituting this into the expression for $|G(\\kappa)|^2$:\n$$\n|G(\\kappa)|^2 = 1 + 2\\lambda(\\lambda-1)\\left(\\frac{\\kappa^2}{2} + O(\\kappa^4)\\right) = 1 + \\lambda(\\lambda-1)\\kappa^2 + O(\\kappa^4)\n$$\nTo find $|G(\\kappa)|$, we take the square root, using the Taylor expansion $\\sqrt{1+x} = 1 + \\frac{x}{2} + O(x^2)$:\n$$\n|G(\\kappa)| = \\sqrt{1 + \\lambda(\\lambda-1)\\kappa^2 + O(\\kappa^4)} = 1 + \\frac{1}{2}\\lambda(\\lambda-1)\\kappa^2 + O(\\kappa^4)\n$$\nThe amplitude error is therefore:\n$$\n\\delta A(\\kappa) = |G(\\kappa)| - 1 = \\frac{\\lambda(\\lambda-1)}{2}\\kappa^2 + O(\\kappa^4)\n$$\nThe leading-order term for the amplitude error is $\\frac{\\lambda(\\lambda-1)}{2}\\kappa^2$. This term corresponds to numerical diffusion. For the scheme to be stable ($|G(\\kappa)|\\le 1$), we require $0 \\le \\lambda \\le 1$. In this range, the amplitude error is non-positive, indicating that the scheme is dissipative.\n\nNext, we analyze the one-step phase error, defined as $\\delta \\phi(\\kappa) = \\phi(\\kappa) + \\lambda\\,\\kappa$, where $\\phi(\\kappa) = \\arg(G(\\kappa))$. The phase of $G(\\kappa)$ is given by:\n$$\n\\phi(\\kappa) = \\arctan\\left(\\frac{\\operatorname{Im}(G(\\kappa))}{\\operatorname{Re}(G(\\kappa))}\\right) = \\arctan\\left(\\frac{-\\lambda\\sin(\\kappa)}{1 - \\lambda + \\lambda\\cos(\\kappa)}\\right)\n$$\nWe expand the argument of the arctan function for small $\\kappa$.\nNumerator: $-\\lambda\\sin(\\kappa) = -\\lambda\\left(\\kappa - \\frac{\\kappa^3}{6} + O(\\kappa^5)\\right)$.\nDenominator: $1 - \\lambda + \\lambda\\cos(\\kappa) = 1 - \\lambda + \\lambda\\left(1 - \\frac{\\kappa^2}{2} + O(\\kappa^4)\\right) = 1 - \\frac{\\lambda\\kappa^2}{2} + O(\\kappa^4)$.\nThe argument of the arctan is:\n$$\n\\frac{-\\lambda\\left(\\kappa - \\frac{\\kappa^3}{6} + \\dots\\right)}{1 - \\frac{\\lambda\\kappa^2}{2} + \\dots} = -\\lambda\\kappa\\left(1 - \\frac{\\kappa^2}{6} + \\dots\\right)\\left(1 + \\frac{\\lambda\\kappa^2}{2} + \\dots\\right)\n$$\n$$\n= -\\lambda\\kappa\\left(1 + \\frac{\\lambda\\kappa^2}{2} - \\frac{\\kappa^2}{6} + \\dots\\right) = -\\lambda\\kappa - \\lambda\\left(\\frac{\\lambda}{2} - \\frac{1}{6}\\right)\\kappa^3 + O(\\kappa^5)\n$$\n$$\n= -\\lambda\\kappa - \\frac{\\lambda(3\\lambda-1)}{6}\\kappa^3 + O(\\kappa^5)\n$$\nNow using the Taylor expansion for $\\arctan(y) = y - \\frac{y^3}{3} + O(y^5)$:\n$$\n\\phi(\\kappa) = \\left(-\\lambda\\kappa - \\frac{\\lambda(3\\lambda-1)}{6}\\kappa^3\\right) - \\frac{1}{3}(-\\lambda\\kappa)^3 + O(\\kappa^5)\n$$\n$$\n\\phi(\\kappa) = -\\lambda\\kappa - \\frac{\\lambda(3\\lambda-1)}{6}\\kappa^3 + \\frac{\\lambda^3}{3}\\kappa^3 + O(\\kappa^5)\n$$\n$$\n\\phi(\\kappa) = -\\lambda\\kappa - \\left(\\frac{3\\lambda^2-\\lambda}{6} - \\frac{2\\lambda^3}{6}\\right)\\kappa^3 + O(\\kappa^5)\n$$\n$$\n\\phi(\\kappa) = -\\lambda\\kappa + \\frac{2\\lambda^3 - 3\\lambda^2 + \\lambda}{6}\\kappa^3 + O(\\kappa^5)\n$$\nFactoring the cubic polynomial in $\\lambda$: $2\\lambda^3 - 3\\lambda^2 + \\lambda = \\lambda(2\\lambda^2 - 3\\lambda + 1) = \\lambda(2\\lambda-1)(\\lambda-1) = \\lambda(1-\\lambda)(1-2\\lambda)$.\n$$\n\\phi(\\kappa) = -\\lambda\\kappa + \\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^3 + O(\\kappa^5)\n$$\nThe phase error is then:\n$$\n\\delta \\phi(\\kappa) = \\phi(\\kappa) + \\lambda\\kappa = \\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^3 + O(\\kappa^5)\n$$\nThe leading-order term for the phase error is $\\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^3$. This term corresponds to numerical dispersion, which causes waves of different wavenumbers to travel at different speeds. The sign of the error depends on whether $\\lambda$ is greater or less than $1/2$.\n\nThe leading-order expressions for the amplitude and phase errors are therefore:\n$\\delta A(\\kappa) \\approx \\frac{\\lambda(\\lambda-1)}{2}\\kappa^2$\n$\\delta \\phi(\\kappa) \\approx \\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^3$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\lambda(\\lambda-1)}{2}\\kappa^{2}  \\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Beyond accuracy, a reliable numerical scheme must be stable, ensuring that errors do not grow uncontrollably. For problems involving sharp gradients or shocks, we also desire monotonicity, which prevents the scheme from creating new, non-physical oscillations. This exercise explores these often-competing demands by analyzing the classic MacCormack scheme, which is second-order accurate but not generally monotone. By determining the conditions for both spectral stability and monotonicity , you will encounter a practical illustration of Godunov's theorem and appreciate the inherent trade-off between higher-order accuracy and oscillation-free solutions.",
            "id": "3380635",
            "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a>0$ on a uniform spatial grid with spacing $\\Delta x$ and time step $\\Delta t$. Define the Courant–Friedrichs–Lewy (CFL) number $\\nu := a\\,\\Delta t/\\Delta x$. Discretize the equation using the MacCormack predictor–corrector finite difference method in the standard forward–backward form appropriate for $a>0$, with predictor\n$$\nu_{j}^{*} = u_{j}^{n} - \\nu\\left(u_{j+1}^{n} - u_{j}^{n}\\right),\n$$\nand corrector\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j}^{n} + u_{j}^{*} - \\nu\\left(u_{j}^{*} - u_{j-1}^{*}\\right)\\right).\n$$\nUsing fundamental principles of von Neumann Fourier stability analysis and the definition of a monotone conservative three-point scheme, perform the following:\n\n1) Derive the discrete amplification factor $G(\\theta;\\nu)$ corresponding to this scheme for a single Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,\\theta\\,j\\right)$, where $\\theta \\in [0,\\pi]$ is the non-dimensional wavenumber. From the requirement of spectral stability, enforce $|G(\\theta;\\nu)| \\leq 1$ for all $\\theta \\in [0,\\pi]$ and determine the resulting constraint on $\\nu$.\n\n2) Rewrite one full time step $u_{j}^{n+1}$ in conservative three-point form $u_{j}^{n+1} = \\alpha(\\nu)\\,u_{j-1}^{n} + \\beta(\\nu)\\,u_{j}^{n} + \\gamma(\\nu)\\,u_{j+1}^{n}$. Impose the nonoscillatory monotonicity condition for scalar linear advection with $a>0$, namely $\\alpha(\\nu) \\geq 0$, $\\beta(\\nu) \\geq 0$, and $\\gamma(\\nu) \\geq 0$, to preclude nonphysical oscillations in the discrete solution. Combine this with the spectral stability constraint from part (1) and determine the largest value of the CFL number $\\nu$ that satisfies both conditions simultaneously.\n\nGive your final answer as a single real number. No rounding is required.",
            "solution": "The problem asks for an analysis of the MacCormack predictor-corrector scheme for the linear advection equation $u_{t} + a\\,u_{x} = 0$, where $a>0$. The scheme is given by:\nPredictor:\n$$\nu_{j}^{*} = u_{j}^{n} - \\nu\\left(u_{j+1}^{n} - u_{j}^{n}\\right) \\quad \\text{where } \\nu = \\frac{a\\Delta t}{\\Delta x}\n$$\nCorrector:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j}^{n} + u_{j}^{*} - \\nu\\left(u_{j}^{*} - u_{j-1}^{*}\\right)\\right)\n$$\n\nTo simplify the analysis for both parts of the problem, we first combine the predictor and corrector steps into a single explicit expression for $u_{j}^{n+1}$ in terms of values at time level $n$.\nSubstitute the predictor expression for $u_{j}^{*}$ and $u_{j-1}^{*}$ into the corrector equation.\nFor $u_{j-1}^{*}$, we have:\n$$\nu_{j-1}^{*} = u_{j-1}^{n} - \\nu\\left(u_{j}^{n} - u_{j-1}^{n}\\right)\n$$\nSubstituting these into the corrector step yields:\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j}^{n} + \\left[u_{j}^{n} - \\nu\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\\right] - \\nu\\left(\\left[u_{j}^{n} - \\nu\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\\right] - \\left[u_{j-1}^{n} - \\nu\\left(u_{j}^{n} - u_{j-1}^{n}\\right)\\right]\\right)\\right)\n$$\nLet's simplify the term inside the large parentheses:\n$$\n2u_{j}^{n} - \\nu(u_{j+1}^{n} - u_{j}^{n}) - \\nu\\left(u_{j}^{n} - u_{j-1}^{n} - \\nu u_{j+1}^{n} + \\nu u_{j}^{n} + \\nu u_{j}^{n} - \\nu u_{j-1}^{n}\\right)\n$$\n$$\n= 2u_{j}^{n} - \\nu u_{j+1}^{n} + \\nu u_{j}^{n} - \\nu(u_{j}^{n} - u_{j-1}^{n}) + \\nu^{2}(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n})\n$$\n$$\n= 2u_{j}^{n} - \\nu u_{j+1}^{n} + \\nu u_{j}^{n} - \\nu u_{j}^{n} + \\nu u_{j-1}^{n} + \\nu^{2}(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n})\n$$\n$$\n= 2u_{j}^{n} - \\nu (u_{j+1}^{n} - u_{j-1}^{n}) + \\nu^{2}(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n})\n$$\nDividing by $2$, we obtain the one-step form of the scheme:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2}\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\nThis is the well-known Lax-Wendroff scheme, to which the specified MacCormack scheme is equivalent for linear problems.\n\n**1) Von Neumann Stability Analysis**\n\nWe perform a von Neumann stability analysis by substituting a single Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,e^{i\\theta j}$ into the one-step scheme. The amplification factor is defined as $G(\\theta;\\nu) = \\hat{u}^{n+1}/\\hat{u}^{n}$.\nSubstituting the mode gives:\n$$\nG e^{i\\theta j} = e^{i\\theta j} - \\frac{\\nu}{2}\\left(e^{i\\theta (j+1)} - e^{i\\theta (j-1)}\\right) + \\frac{\\nu^{2}}{2}\\left(e^{i\\theta (j+1)} - 2e^{i\\theta j} + e^{i\\theta (j-1)}\\right)\n$$\nDividing by $e^{i\\theta j}$:\n$$\nG = 1 - \\frac{\\nu}{2}\\left(e^{i\\theta} - e^{-i\\theta}\\right) + \\frac{\\nu^{2}}{2}\\left(e^{i\\theta} - 2 + e^{-i\\theta}\\right)\n$$\nUsing Euler's identities, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$ and $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we get:\n$$\nG(\\theta;\\nu) = 1 - \\frac{\\nu}{2}\\left(2i\\sin\\theta\\right) + \\frac{\\nu^{2}}{2}\\left(2\\cos\\theta - 2\\right)\n$$\n$$\nG(\\theta;\\nu) = 1 - i\\nu\\sin\\theta + \\nu^{2}(\\cos\\theta - 1)\n$$\nUsing the half-angle identity $\\cos\\theta - 1 = -2\\sin^{2}(\\frac{\\theta}{2})$, the amplification factor becomes:\n$$\nG(\\theta;\\nu) = 1 - 2\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) - i\\nu\\sin\\theta\n$$\nFor spectral stability, we require $|G(\\theta;\\nu)| \\leq 1$, which is equivalent to $|G(\\theta;\\nu)|^{2} \\leq 1$.\n$$\n|G|^{2} = \\left(\\text{Re}(G)\\right)^{2} + \\left(\\text{Im}(G)\\right)^{2} = \\left(1 - 2\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right)\\right)^{2} + (-\\nu\\sin\\theta)^{2}\n$$\nUsing $\\sin\\theta = 2\\sin(\\frac{\\theta}{2})\\cos(\\frac{\\theta}{2})$:\n$$\n|G|^{2} = 1 - 4\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) + 4\\nu^{4}\\sin^{4}\\left(\\frac{\\theta}{2}\\right) + \\nu^{2}\\left(2\\sin\\left(\\frac{\\theta}{2}\\right)\\cos\\left(\\frac{\\theta}{2}\\right)\\right)^{2}\n$$\n$$\n|G|^{2} = 1 - 4\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) + 4\\nu^{4}\\sin^{4}\\left(\\frac{\\theta}{2}\\right) + 4\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right)\\cos^{2}\\left(\\frac{\\theta}{2}\\right)\n$$\nFactoring out $4\\nu^{2}\\sin^{2}(\\frac{\\theta}{2})$ and using $\\cos^{2}(\\frac{\\theta}{2}) = 1-\\sin^{2}(\\frac{\\theta}{2})$:\n$$\n|G|^{2} = 1 - 4\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) \\left(1 - \\cos^{2}\\left(\\frac{\\theta}{2}\\right)\\right) + 4\\nu^{4}\\sin^{4}\\left(\\frac{\\theta}{2}\\right)\n$$\n$$\n|G|^{2} = 1 - 4\\nu^{2}\\sin^{4}\\left(\\frac{\\theta}{2}\\right) + 4\\nu^{4}\\sin^{4}\\left(\\frac{\\theta}{2}\\right)\n$$\n$$\n|G|^{2} = 1 - 4\\nu^{2}(1-\\nu^{2})\\sin^{4}\\left(\\frac{\\theta}{2}\\right)\n$$\nThe stability requirement $|G|^{2} \\leq 1$ becomes:\n$$\n1 - 4\\nu^{2}(1-\\nu^{2})\\sin^{4}\\left(\\frac{\\theta}{2}\\right) \\leq 1\n$$\n$$\n-4\\nu^{2}(1-\\nu^{2})\\sin^{4}\\left(\\frac{\\theta}{2}\\right) \\leq 0\n$$\nSince $\\nu = a\\Delta t/\\Delta x > 0$ and $\\theta \\in [0,\\pi]$, both $\\nu^{2}$ and $\\sin^{4}(\\frac{\\theta}{2})$ are non-negative. The inequality holds if and only if:\n$$\n-(1-\\nu^{2}) \\leq 0 \\implies \\nu^{2} - 1 \\leq 0 \\implies \\nu^{2} \\leq 1\n$$\nAs $\\nu > 0$, the spectral stability constraint is $0  \\nu \\leq 1$.\n\n**2) Monotonicity Condition and Final Result**\n\nWe rewrite the one-step scheme in the conservative three-point form $u_{j}^{n+1} = \\alpha(\\nu)\\,u_{j-1}^{n} + \\beta(\\nu)\\,u_{j}^{n} + \\gamma(\\nu)\\,u_{j+1}^{n}$ by collecting terms from the Lax-Wendroff form:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}u_{j+1}^{n} + \\frac{\\nu}{2}u_{j-1}^{n} + \\frac{\\nu^{2}}{2}u_{j+1}^{n} - \\nu^{2}u_{j}^{n} + \\frac{\\nu^{2}}{2}u_{j-1}^{n}\n$$\nGrouping coefficients for $u_{j-1}^{n}$, $u_{j}^{n}$, and $u_{j+1}^{n}$:\n$$\nu_{j}^{n+1} = \\left(\\frac{\\nu}{2} + \\frac{\\nu^{2}}{2}\\right) u_{j-1}^{n} + \\left(1 - \\nu^{2}\\right) u_{j}^{n} + \\left(-\\frac{\\nu}{2} + \\frac{\\nu^{2}}{2}\\right) u_{j+1}^{n}\n$$\nFrom this, we identify the coefficients:\n$$\n\\alpha(\\nu) = \\frac{\\nu^{2}+\\nu}{2} = \\frac{\\nu(\\nu+1)}{2}\n$$\n$$\n\\beta(\\nu) = 1 - \\nu^{2}\n$$\n$$\n\\gamma(\\nu) = \\frac{\\nu^{2}-\\nu}{2} = \\frac{\\nu(\\nu-1)}{2}\n$$\nThe nonoscillatory monotonicity condition requires that all coefficients be non-negative: $\\alpha(\\nu) \\geq 0$, $\\beta(\\nu) \\geq 0$, and $\\gamma(\\nu) \\geq 0$. We analyze these conditions for $\\nu > 0$.\n\n1.  $\\alpha(\\nu) = \\frac{\\nu(\\nu+1)}{2} \\geq 0$: Since $\\nu > 0$, $\\nu+1$ is also positive. This condition is always satisfied for $\\nu > 0$.\n\n2.  $\\beta(\\nu) = 1 - \\nu^{2} \\geq 0$: This implies $\\nu^{2} \\leq 1$. Since $\\nu > 0$, this yields $0  \\nu \\leq 1$. This is identical to the stability constraint.\n\n3.  $\\gamma(\\nu) = \\frac{\\nu(\\nu-1)}{2} \\geq 0$: Since $\\nu > 0$, this inequality requires $\\nu-1 \\geq 0$, which implies $\\nu \\geq 1$.\n\nTo satisfy all conditions simultaneously, we must satisfy the stability condition from part (1) and all three monotonicity conditions.\n-   Spectral stability: $0  \\nu \\leq 1$.\n-   Monotonicity from $\\beta$: $0  \\nu \\leq 1$.\n-   Monotonicity from $\\gamma$: $\\nu \\geq 1$.\n\nThe intersection of the sets $(0, 1]$ and $[1, \\infty)$ is the single point set $\\{\\nu = 1\\}$. Therefore, the only value of the CFL number $\\nu$ that satisfies both spectral stability and the nonoscillatory monotonicity condition is $\\nu = 1$. The problem asks for the largest such value, which is uniquely determined to be $1$.\n\nAt $\\nu=1$, the scheme simplifies to $u_j^{n+1} = u_{j-1}^n$, which is the exact solution to the advection equation on the grid, transported by one grid cell per time step, and is a first-order upwind scheme, which is known to be monotone. For any $\\nu \\in (0, 1)$, $\\gamma(\\nu)  0$, making the MacCormack (Lax-Wendroff) scheme non-monotone, a property consistent with Godunov's theorem for second-order accurate schemes.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "When advancing from scalar equations to systems, or from simple schemes to higher-order discretizations, our stability analysis must generalize. The stability of the entire semi-discrete system depends on the interaction between the time integrator and the spectral properties of the spatial difference operator. This problem investigates how the choice of spatial discretization—specifically, a second-order versus a fourth-order centered difference—affects the maximum allowable time step $\\Delta t$ for a prescribed Courant–Friedrichs–Lewy (CFL) number. This hands-on analysis  will teach you to use Fourier methods to determine the spectral radius of a difference operator and understand a key practical trade-off: higher-order schemes, while more accurate for well-resolved waves, often impose a stricter stability constraint on the time step.",
            "id": "3380586",
            "problem": "Consider the one-dimensional linear constant-coefficient symmetric hyperbolic system $q_{t} + A\\,q_{x} = 0$ on a periodic domain, where $A \\in \\mathbb{R}^{m \\times m}$ is diagonalizable with real eigenvalues and satisfies the bound $|\\lambda_{k}(A)| \\le \\Lambda$ for all characteristic speeds, with a known constant $\\Lambda > 0$. The domain is discretized by a uniform grid with spacing $h$, and the spatial derivative $q_{x}$ is approximated by a centered finite difference operator of order $p \\in \\{2,4\\}$:\n- For $p=2$: $(D_{2} q)_{j} = \\dfrac{q_{j+1} - q_{j-1}}{2 h}$.\n- For $p=4$: $(D_{4} q)_{j} = \\dfrac{-q_{j+2} + 8 q_{j+1} - 8 q_{j-1} + q_{j-2}}{12 h}$.\nYou intend to use an explicit time integrator whose constraint is to enforce a prescribed Courant–Friedrichs–Lewy (CFL) number $\\nu^{\\star}$ computed from the semi-discrete operator. Take $h = 2.5 \\times 10^{-3}$, $\\Lambda = 4.7$, and target $\\nu^{\\star} = 0.6$. Using Fourier (von Neumann) analysis of the semi-discrete operator composed of $A$ and the chosen $D_{p}$, determine the maximum allowable time step $\\Delta t_{\\max}$ such that the resulting CFL number does not exceed $\\nu^{\\star}$ for both $p=2$ and $p=4$. Then, briefly explain how $\\Delta t_{\\max}$ depends on the spatial order $p$ through the semi-discrete symbol. Express the two numerical values of $\\Delta t_{\\max}$ in seconds and round your answers to four significant figures.",
            "solution": "The problem asks for the maximum allowable time step $\\Delta t_{\\max}$ for a semi-discretization of a hyperbolic system, based on a prescribed semi-discrete Courant–Friedrichs–Lewy (CFL) number. The analysis will be performed using the Fourier (von Neumann) method.\n\nThe given partial differential equation (PDE) is the one-dimensional linear constant-coefficient symmetric hyperbolic system:\n$$q_{t} + A\\,q_{x} = 0$$\nwhere $q \\in \\mathbb{R}^{m}$, $A \\in \\mathbb{R}^{m \\times m}$ is a constant, symmetric, and diagonalizable matrix with real eigenvalues $\\lambda_k(A)$ bounded by $|\\lambda_k(A)| \\le \\Lambda$.\n\nThe spatial domain is periodic and discretized with a uniform grid of spacing $h$. The spatial derivative $q_x$ is approximated by a finite difference operator $D_p$, leading to the semi-discrete system of ordinary differential equations (ODEs):\n$$\\frac{d}{dt} q_j(t) = - A (D_p q)_j(t)$$\nwhere $q_j(t)$ is the solution at grid point $j$.\n\nTo analyze the stability of this system, we apply Fourier analysis. We consider a single Fourier mode $q_j(t) = \\hat{q}(k, t) e^{i k x_j}$, where $x_j = jh$, $k$ is the wavenumber, and $i = \\sqrt{-1}$. Applying the difference operator $D_p$ to this mode yields:\n$$(D_p e^{ikjh})_j = \\hat{D}_p(k) e^{ikjh}$$\nwhere $\\hat{D}_p(k)$ is the symbol of the operator $D_p$. The semi-discrete system in Fourier space becomes:\n$$\\frac{d}{dt} \\hat{q}(k, t) = -A \\hat{D}_p(k) \\hat{q}(k, t)$$\nThe matrix governing the evolution of the Fourier coefficients is $-A \\hat{D}_p(k)$. Since $A$ is diagonalizable, say $A = S \\Sigma S^{-1}$ where $\\Sigma = \\operatorname{diag}(\\lambda_1, \\dots, \\lambda_m)$, the eigenvalues of $-A \\hat{D}_p(k)$ are $-\\lambda_j(A) \\hat{D}_p(k)$ for $j=1, \\dots, m$.\n\nFor centered finite difference schemes applied to a hyperbolic problem, the symbol $\\hat{D}_p(k)$ is purely imaginary. Let $\\theta = kh$.\nFor $p=2$:\n$$(D_2 q)_j = \\frac{q_{j+1} - q_{j-1}}{2h}$$\nApplying this to $e^{ikjh}$:\n$$\\hat{D}_2(k) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2h} = \\frac{2i\\sin(\\theta)}{2h} = \\frac{i\\sin(\\theta)}{h}$$\n\nFor $p=4$:\n$$(D_4 q)_j = \\frac{-q_{j+2} + 8q_{j+1} - 8q_{j-1} + q_{j-2}}{12h}$$\nApplying this to $e^{ikjh}$:\n$$\\hat{D}_4(k) = \\frac{-e^{i2\\theta} + 8e^{i\\theta} - 8e^{-i\\theta} + e^{-i2\\theta}}{12h} = \\frac{-2i\\sin(2\\theta) + 16i\\sin(\\theta)}{12h} = \\frac{i(8\\sin(\\theta) - \\sin(2\\theta))}{6h}$$\nUsing the identity $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$, we can write:\n$$\\hat{D}_4(k) = \\frac{i(8\\sin(\\theta) - 2\\sin(\\theta)\\cos(\\theta))}{6h} = \\frac{i\\sin(\\theta)(4-\\cos(\\theta))}{3h}$$\nThe eigenvalues of the semi-discrete operator $-A D_p$ are purely imaginary, lying on the imaginary axis. The stability of an explicit time integration scheme requires that $\\Delta t$ multiplied by the spectral radius of the operator lies within the method's stability region. For a purely imaginary spectrum, this condition takes the form $\\Delta t \\max|\\text{eigenvalue}| \\le S$, where $S$ is a constant specific to the time integrator.\n\nThe problem defines a semi-discrete CFL number $\\nu^\\star$ such that the stability constraint is met. This implies:\n$$\\nu^\\star = \\Delta t \\max_{k, j} |-\\lambda_j(A) \\hat{D}_p(k)|$$\nThe maximum is taken over all wavenumbers $k$ (or equivalently, all $\\theta \\in [-\\pi, \\pi]$) and all eigenvalues of $A$.\n$$\\nu^\\star = \\Delta t \\left( \\max_j |\\lambda_j(A)| \\right) \\left( \\max_k |\\hat{D}_p(k)| \\right) = \\Delta t \\cdot \\Lambda \\cdot \\max_{\\theta} |\\hat{D}_p(\\theta)|$$\nFrom this, we can solve for the maximum allowable time step:\n$$\\Delta t_{\\max} = \\frac{\\nu^\\star}{\\Lambda \\max_{\\theta} |\\hat{D}_p(\\theta)|}$$\n\nWe must now find the maximum of the symbol's magnitude for each case.\n\nCase 1: $p=2$\n$$|\\hat{D}_2(\\theta)| = \\left|\\frac{i\\sin(\\theta)}{h}\\right| = \\frac{|\\sin(\\theta)|}{h}$$\nThe maximum value of $|\\sin(\\theta)|$ for $\\theta \\in [-\\pi, \\pi]$ is $1$.\n$$\\max_{\\theta} |\\hat{D}_2(\\theta)| = \\frac{1}{h}$$\nThe maximum time step is:\n$$\\Delta t_{\\max, 2} = \\frac{\\nu^\\star}{\\Lambda (1/h)} = \\frac{\\nu^\\star h}{\\Lambda}$$\nUsing the given values $h = 2.5 \\times 10^{-3}$, $\\Lambda = 4.7$, and $\\nu^\\star = 0.6$:\n$$\\Delta t_{\\max, 2} = \\frac{0.6 \\times (2.5 \\times 10^{-3})}{4.7} = \\frac{1.5 \\times 10^{-3}}{4.7} \\approx 3.191489 \\times 10^{-4} \\, \\text{s}$$\nRounding to four significant figures, $\\Delta t_{\\max, 2} \\approx 3.191 \\times 10^{-4} \\, \\text{s}$.\n\nCase 2: $p=4$\n$$|\\hat{D}_4(\\theta)| = \\left|\\frac{i\\sin(\\theta)(4-\\cos(\\theta))}{3h}\\right| = \\frac{|\\sin(\\theta)(4-\\cos(\\theta))|}{3h}$$\nLet $f(\\theta) = \\sin(\\theta)(4-\\cos(\\theta))$. We need to find the maximum of $|f(\\theta)|$. Since $4-\\cos(\\theta)$ is always positive, we can analyze $f(\\theta)$ on $[0, \\pi]$.\n$f'(\\theta) = \\cos(\\theta)(4-\\cos(\\theta)) + \\sin(\\theta)(\\sin(\\theta)) = 4\\cos(\\theta) - \\cos^2(\\theta) + \\sin^2(\\theta) = -2\\cos^2(\\theta) + 4\\cos(\\theta) + 1$.\nSetting $f'(\\theta)=0$ and solving for $u=\\cos(\\theta)$ gives the quadratic equation $2u^2 - 4u - 1 = 0$. The roots are $u = 1 \\pm \\frac{\\sqrt{6}}{2}$. Only $u = 1 - \\frac{\\sqrt{6}}{2}$ is in the range $[-1, 1]$.\nThe maximum value of the numerator function is found to be $\\frac{1}{2}\\sqrt{9+24\\sqrt{6}}$.\nTherefore,\n$$\\max_{\\theta} |\\hat{D}_4(\\theta)| = \\frac{1}{3h} \\left( \\frac{1}{2}\\sqrt{9+24\\sqrt{6}} \\right) = \\frac{\\sqrt{9+24\\sqrt{6}}}{6h}$$\nLet $C_4 = \\frac{\\sqrt{9+24\\sqrt{6}}}{6}$. Numerically, $C_4 \\approx 1.37222$.\nThe maximum time step is:\n$$\\Delta t_{\\max, 4} = \\frac{\\nu^\\star}{\\Lambda \\max_{\\theta} |\\hat{D}_4(\\theta)|} = \\frac{\\nu^\\star h}{\\Lambda C_4}$$\n$$\\Delta t_{\\max, 4} = \\frac{0.6 \\times (2.5 \\times 10^{-3})}{4.7 \\times \\frac{\\sqrt{9+24\\sqrt{6}}}{6}} \\approx \\frac{1.5 \\times 10^{-3}}{4.7 \\times 1.37222} \\approx \\frac{1.5 \\times 10^{-3}}{6.449434} \\approx 2.32578 \\times 10^{-4} \\, \\text{s}$$\nRounding to four significant figures, $\\Delta t_{\\max, 4} \\approx 2.326 \\times 10^{-4} \\, \\text{s}$.\n\nExplanation of dependence on $p$:\nThe maximum time step is given by $\\Delta t_{\\max, p} = \\frac{\\nu^\\star}{\\Lambda \\rho(D_p)}$, where $\\rho(D_p) = \\max_{\\theta} |\\hat{D}_p(\\theta)|$ is the spectral radius of the spatial difference operator. It can be written as $\\rho(D_p) = C_p/h$, where $C_p$ is the maximum of the scaled symbol, $|h \\hat{D}_p(\\theta)/i|$.\nFor $p=2$, $C_2 = \\max_{\\theta}|\\sin(\\theta)| = 1$.\nFor $p=4$, $C_4 = \\max_{\\theta}\\left|\\frac{\\sin(\\theta)(4-\\cos(\\theta))}{3}\\right| \\approx 1.372$.\nSince $C_4 > C_2$, the denominator in the expression for $\\Delta t_{\\max}$ is larger for $p=4$ than for $p=2$. Consequently, $\\Delta t_{\\max, 4}  \\Delta t_{\\max, 2}$. The higher-order scheme has a larger spectral radius for its spatial operator, which arises from its wider stencil. This imposes a more restrictive stability limit on the time step for a given grid spacing $h$, despite the higher order of accuracy for well-resolved modes.\n\nThe numerical values rounded to four significant figures are:\nFor $p=2$: $\\Delta t_{\\max} = 3.191 \\times 10^{-4}$ s\nFor $p=4$: $\\Delta t_{\\max} = 2.326 \\times 10^{-4}$ s",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.191 \\times 10^{-4}  2.326 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}