{
    "hands_on_practices": [
        {
            "introduction": "理解抽象的定义是一回事，但将其付诸实践则是另一回事。第一个实践练习将索博列夫空间的概念带入现实，要求您直接根据积分定义，为一个简单的三角函数计算其 $H^1$ 范数和半范数 。这项基础练习将加深您对这些范数如何量化函数大小及其导数（或振荡行为）的理解。",
            "id": "3397294",
            "problem": "考虑在区间 $(0,1)$ 上的索博列夫空间 $H^{1}(0,1)$，该空间出现在线性椭圆型偏微分方程（PDEs）的弱形式中。设 $u(x)=\\sin(\\pi x)$，其中 $x\\in(0,1)$。仅使用勒贝格空间 $L^{2}(0,1)$ 范数、弱导数、$H^{1}(0,1)$ 半范数和 $H^{1}(0,1)$ 范数的基本定义，计算 $u$ 的 $H^{1}(0,1)$ 半范数和 $H^{1}(0,1)$ 范数。然后，通过计算半范数与范数的比值来比较它们的大小。将你的结果表示为行向量 $\\big(|u|_{H^{1}(0,1)},\\ \\|u\\|_{H^{1}(0,1)},\\ |u|_{H^{1}(0,1)}/\\|u\\|_{H^{1}(0,1)}\\big)$。以精确解析形式表示你的答案，不要进行舍入。",
            "solution": "该问题是适定的，具有科学依据，并为求得唯一解提供了所有必要的信息。所涉及的概念——索博列夫空间、范数和弱导数——在偏微分方程的数学分析中是标准概念。因此，我们可以开始求解。\n\n问题要求计算函数 $u(x) = \\sin(\\pi x)$ 在定义域 $\\Omega = (0,1)$ 上的 $H^{1}(0,1)$ 半范数、$H^{1}(0,1)$ 范数以及它们的比值。我们将按照规定使用基本定义进行计算。\n\n首先，我们回顾一下定义。索博列夫空间 $H^{1}(\\Omega)$ 是这样一个函数空间，其中的函数 $v$ 属于勒贝格空间 $L^{2}(\\Omega)$，且其一阶弱导数也属于 $L^{2}(\\Omega)$。对于我们的一维定义域 $\\Omega=(0,1)$，这可以写成 $H^{1}(0,1) = \\{v \\in L^{2}(0,1) \\mid v' \\in L^{2}(0,1)\\}$。\n\n函数 $v$ 的 $L^{2}(0,1)$ 范数定义为：\n$$ \\|v\\|_{L^{2}(0,1)} = \\left( \\int_{0}^{1} |v(x)|^{2} \\,dx \\right)^{1/2} $$\n\n函数 $v \\in L^{2}(0,1)$ 的弱导数 $v'$ 是一个满足以下关系式的函数：\n$$ \\int_{0}^{1} v'(x) \\phi(x) \\,dx = - \\int_{0}^{1} v(x) \\phi'(x) \\,dx $$\n对所有测试函数 $\\phi \\in C_{c}^{\\infty}(0,1)$（在 $(0,1)$ 上具有紧支集的无穷次可微函数）成立。\n对于给定函数 $u(x) = \\sin(\\pi x)$，它在整个实线上是连续可微的，因此其弱导数与经典导数一致。其经典导数为 $u'(x) = \\pi \\cos(\\pi x)$。由于 $u(x)$ 和 $u'(x)$ 在闭区间 $[0,1]$ 上都是连续有界函数，因此它们是平方可积的，即 $u \\in L^{2}(0,1)$ 且 $u' \\in L^{2}(0,1)$。因此，$u(x) = \\sin(\\pi x)$ 是索博列夫空间 $H^{1}(0,1)$ 中的一个元素。\n\n$H^{1}(0,1)$ 半范数，记为 $|v|_{H^{1}(0,1)}$，是弱导数的 $L^{2}$ 范数：\n$$ |v|_{H^{1}(0,1)} = \\|v'\\|_{L^{2}(0,1)} = \\left( \\int_{0}^{1} |v'(x)|^{2} \\,dx \\right)^{1/2} $$\n$H^{1}(0,1)$ 范数，记为 $\\|v\\|_{H^{1}(0,1)}$，定义为：\n$$ \\|v\\|_{H^{1}(0,1)} = \\left( \\|v\\|_{L^{2}(0,1)}^{2} + |v|_{H^{1}(0,1)}^{2} \\right)^{1/2} = \\left( \\int_{0}^{1} |v(x)|^{2} \\,dx + \\int_{0}^{1} |v'(x)|^{2} \\,dx \\right)^{1/2} $$\n\n现在，我们来计算 $u(x) = \\sin(\\pi x)$ 的这些量。\n\n首先，我们计算 $u(x)$ 的 $L^{2}$ 范数的平方：\n$$ \\|u\\|_{L^{2}(0,1)}^{2} = \\int_{0}^{1} (\\sin(\\pi x))^{2} \\,dx $$\n使用三角恒等式 $\\sin^{2}(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$，我们得到：\n$$ \\|u\\|_{L^{2}(0,1)}^{2} = \\int_{0}^{1} \\frac{1 - \\cos(2\\pi x)}{2} \\,dx = \\frac{1}{2} \\left[ x - \\frac{\\sin(2\\pi x)}{2\\pi} \\right]_{0}^{1} $$\n$$ = \\frac{1}{2} \\left( \\left(1 - \\frac{\\sin(2\\pi)}{2\\pi}\\right) - \\left(0 - \\frac{\\sin(0)}{2\\pi}\\right) \\right) = \\frac{1}{2} ( (1 - 0) - (0 - 0) ) = \\frac{1}{2} $$\n\n接下来，我们计算 $H^{1}$ 半范数的平方，也就是导数 $u'(x) = \\pi \\cos(\\pi x)$ 的 $L^{2}$ 范数的平方：\n$$ |u|_{H^{1}(0,1)}^{2} = \\|u'\\|_{L^{2}(0,1)}^{2} = \\int_{0}^{1} (\\pi \\cos(\\pi x))^{2} \\,dx = \\pi^{2} \\int_{0}^{1} \\cos^{2}(\\pi x) \\,dx $$\n使用三角恒等式 $\\cos^{2}(\\theta) = \\frac{1 + \\cos(2\\theta)}{2}$，我们得到：\n$$ |u|_{H^{1}(0,1)}^{2} = \\pi^{2} \\int_{0}^{1} \\frac{1 + \\cos(2\\pi x)}{2} \\,dx = \\frac{\\pi^{2}}{2} \\left[ x + \\frac{\\sin(2\\pi x)}{2\\pi} \\right]_{0}^{1} $$\n$$ = \\frac{\\pi^{2}}{2} \\left( \\left(1 + \\frac{\\sin(2\\pi)}{2\\pi}\\right) - \\left(0 + \\frac{\\sin(0)}{2\\pi}\\right) \\right) = \\frac{\\pi^{2}}{2} ( (1 + 0) - (0 + 0) ) = \\frac{\\pi^{2}}{2} $$\n由此，我们求得半范数：\n$$ |u|_{H^{1}(0,1)} = \\sqrt{\\frac{\\pi^{2}}{2}} = \\frac{\\pi}{\\sqrt{2}} $$\n\n现在，我们计算 $H^{1}$ 范数。我们使用已经计算出的范数的平方：\n$$ \\|u\\|_{H^{1}(0,1)}^{2} = \\|u\\|_{L^{2}(0,1)}^{2} + |u|_{H^{1}(0,1)}^{2} = \\frac{1}{2} + \\frac{\\pi^{2}}{2} = \\frac{1+\\pi^{2}}{2} $$\n开平方根得到范数：\n$$ \\|u\\|_{H^{1}(0,1)} = \\sqrt{\\frac{1+\\pi^{2}}{2}} = \\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}} $$\n\n最后，我们计算半范数与范数的比值：\n$$ \\frac{|u|_{H^{1}(0,1)}}{\\|u\\|_{H^{1}(0,1)}} = \\frac{\\left(\\frac{\\pi}{\\sqrt{2}}\\right)}{\\left(\\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}}\\right)} = \\frac{\\pi}{\\sqrt{1+\\pi^{2}}} $$\n\n问题要求将结果表示为行向量 $\\big(|u|_{H^{1}(0,1)}, \\|u\\|_{H^{1}(0,1)}, |u|_{H^{1}(0,1)}/\\|u\\|_{H^{1}(0,1)}\\big)$。代入我们计算出的值，得到：\n$$ \\left( \\frac{\\pi}{\\sqrt{2}}, \\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}}, \\frac{\\pi}{\\sqrt{1+\\pi^{2}}} \\right) $$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\pi}{\\sqrt{2}}  \\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}}  \\frac{\\pi}{\\sqrt{1+\\pi^{2}}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "除了在固定区域上计算范数，理解当区域本身发生变化时范数如何表现也至关重要。这个练习聚焦于庞加莱不等式，并要求您推导庞加莱常数如何随区域大小缩放 。掌握这种缩放分析对于数值方法的误差分析至关重要，因为在误差分析中，我们正是在研究当网格尺寸缩小时，计算精度如何提高。",
            "id": "3397255",
            "problem": "设 $\\Omega \\subset \\mathbb{R}^{d}$ 是一个有界 Lipschitz 区域，并令 $H_{0}^{1}(\\Omega)$ 表示 Sobolev 空间，其元素为具有 $L^{2}$ 弱梯度且在迹意义下于 $\\partial \\Omega$ 上为零的 $L^{2}$ 函数。$\\Omega$ 上的 Poincaré 不等式指出，存在一个最小常数 $C_{P}(\\Omega) \\in (0,\\infty)$，使得对于所有 $u \\in H_{0}^{1}(\\Omega)$，都有\n$$\n\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P}(\\Omega)\\,\\|\\nabla u\\|_{L^{2}(\\Omega)}.\n$$\n对于给定的 $h0$，定义缩放后的区域 $\\Omega_{h} := h\\,\\Omega = \\{x \\in \\mathbb{R}^{d} : x = h y \\text{ for some } y \\in \\Omega\\}$。令 $C_{P}(\\Omega_{h})$ 表示在 $\\Omega_{h}$ 上类似定义的最小 Poincaré 常数。\n\n仅使用 Lebesgue 积分的变量替换公式和 Sobolev 函数在线性变量变换下的链式法则，推导由下式定义的精确缩放因子 $S(h,d)$：\n$$\nC_{P}(\\Omega_{h}) = S(h,d)\\,C_{P}(\\Omega).\n$$\n\n你的最终答案应为一个关于 $h$ 和 $d$ 的闭式表达式。无需四舍五入，也不涉及单位。请仅提供 $S(h,d)$ 的表达式作为你的最终答案。",
            "solution": "问题陈述是有效的。这是一个基于 Sobolev 空间和偏微分方程理论的适定数学问题。所有术语都是标准的且定义精确，任务是使用指定的数学工具进行严格的推导。\n\n对于某个给定的常数 $h0$，设 $\\Omega_{h} = h\\,\\Omega = \\{x \\in \\mathbb{R}^{d} : x = hy \\text{ for some } y \\in \\Omega\\}$。区域 $\\Omega_h$ 上的 Poincaré 常数，记为 $C_{P}(\\Omega_{h})$，是使得以下不等式对所有函数 $v \\in H_{0}^{1}(\\Omega_{h})$ 成立的最小常数：\n$$\n\\|v\\|_{L^{2}(\\Omega_{h})} \\leq C_{P}(\\Omega_{h})\\,\\|\\nabla_{x} v\\|_{L^{2}(\\Omega_{h})}\n$$\n其最小性意味着 $C_{P}(\\Omega_{h})$ 由上确界给出：\n$$\nC_{P}(\\Omega_{h}) = \\sup_{v \\in H_{0}^{1}(\\Omega_{h}), v \\neq 0} \\frac{\\|v\\|_{L^{2}(\\Omega_{h})}}{\\|\\nabla_{x} v\\|_{L^{2}(\\Omega_{h})}}\n$$\n其中 $\\nabla_{x}$ 表示关于变量 $x \\in \\Omega_h$ 的梯度。我们的目标是通过变量替换将此表达式与 $C_{P}(\\Omega)$ 联系起来。\n\n考虑由 $x = T(y) = hy$ 定义的线性变换 $T: \\Omega \\to \\Omega_{h}$。对于任何函数 $v \\in H_{0}^{1}(\\Omega_{h})$，我们可以通过复合 $u(y) = v(T(y)) = v(hy)$ 在区域 $\\Omega$ 上定义一个相应的函数 $u$。从 $v$ 到 $u$ 的映射建立了空间 $H_{0}^{1}(\\Omega_{h})$ 和 $H_{0}^{1}(\\Omega)$ 之间的一个同构。这意味着对于每一个 $v \\in H_{0}^{1}(\\Omega_{h})$，都存在一个唯一的 $u \\in H_{0}^{1}(\\Omega)$ 通过此变换与之相关联，反之亦然。因此，对所有非零的 $v \\in H_{0}^{1}(\\Omega_{h})$ 取上确界等价于对所有非零的 $u \\in H_{0}^{1}(\\Omega)$ 取上确界。\n\n现在我们将 $\\Omega_{h}$ 上 $v$ 的范数与 $\\Omega$ 上 $u$ 的范数联系起来。\n\n首先，我们分析函数的 $L^{2}$-范数。范数的定义是：\n$$\n\\|v\\|_{L^{2}(\\Omega_{h})}^{2} = \\int_{\\Omega_{h}} |v(x)|^{2} dx\n$$\n我们应用变量替换 $x=hy$。微分体积元 $dx$ 通过变换的雅可比行列式与 $dy$ 相关联。变换 $x=hy$ 的雅可比矩阵是 $J = hI_{d}$，其中 $I_{d}$ 是 $d \\times d$ 单位矩阵。其行列式为 $|\\det(J)|=h^{d}$。因此，$dx = h^{d}dy$。将此式以及 $v(x) = v(hy) = u(y)$ 代入积分，我们得到：\n$$\n\\|v\\|_{L^{2}(\\Omega_{h})}^{2} = \\int_{\\Omega} |u(y)|^{2} (h^{d} dy) = h^{d} \\int_{\\Omega} |u(y)|^{2} dy = h^{d} \\|u\\|_{L^{2}(\\Omega)}^{2}\n$$\n对两边取平方根，得到范数之间的关系：\n$$\n\\|v\\|_{L^{2}(\\Omega_{h})} = h^{d/2} \\|u\\|_{L^{2}(\\Omega)}\n$$\n其次，我们分析梯度的 $L^{2}$-范数。范数的定义是：\n$$\n\\|\\nabla_{x} v\\|_{L^{2}(\\Omega_{h})}^{2} = \\int_{\\Omega_{h}} |\\nabla_{x} v(x)|^{2} dx\n$$\n我们需要将 $v$ 关于 $x$ 的梯度与 $u$ 关于 $y$ 的梯度联系起来。对 $u(y) = v(hy)$ 使用链式法则：\n$$\n\\nabla_{y} u(y) = \\nabla_{y} (v(hy)) = (J)^{T} (\\nabla_{x} v)(hy) = (hI_{d})^{T} (\\nabla_{x} v)(hy) = h (\\nabla_{x} v)(hy)\n$$\n其中 $\\nabla_{y}$ 是关于 $y$ 的梯度。整理这个方程得到：\n$$\n(\\nabla_{x} v)(hy) = \\frac{1}{h} \\nabla_{y} u(y)\n$$\n现在，我们将此式和变量替换 $x=hy$ 代入梯度范数的积分中：\n$$\n\\|\\nabla_{x} v\\|_{L^{2}(\\Omega_{h})}^{2} = \\int_{\\Omega} |(\\nabla_{x} v)(hy)|^{2} (h^{d} dy) = \\int_{\\Omega} \\left|\\frac{1}{h} \\nabla_{y} u(y)\\right|^{2} h^{d} dy\n$$\n$$\n\\|\\nabla_{x} v\\|_{L^{2}(\\Omega_{h})}^{2} = \\frac{1}{h^{2}} \\int_{\\Omega} |\\nabla_{y} u(y)|^{2} h^{d} dy = h^{d-2} \\int_{\\Omega} |\\nabla_{y} u(y)|^{2} dy = h^{d-2} \\|\\nabla_{y} u\\|_{L^{2}(\\Omega)}^{2}\n$$\n取平方根，我们得到梯度范数的关系：\n$$\n\\|\\nabla_{x} v\\|_{L^{2}(\\Omega_{h})} = h^{(d-2)/2} \\|\\nabla_{y} u\\|_{L^{2}(\\Omega)}\n$$\n现在我们可以用 $\\Omega$ 上 $u$ 的范数来表示 $C_{P}(\\Omega_{h})$。将推导出的表达式代入 $C_{P}(\\Omega_{h})$ 的定义中：\n$$\nC_{P}(\\Omega_{h}) = \\sup_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{h^{d/2} \\|u\\|_{L^{2}(\\Omega)}}{h^{(d-2)/2} \\|\\nabla_{y} u\\|_{L^{2}(\\Omega)}}\n$$\n由于包含 $h$ 的因子相对于函数 $u$ 是常数，它们可以从上确界中提取出来：\n$$\nC_{P}(\\Omega_{h}) = \\frac{h^{d/2}}{h^{(d-2)/2}} \\sup_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^{2}(\\Omega)}}{\\|\\nabla_{y} u\\|_{L^{2}(\\Omega)}}\n$$\n根据定义，这个上确界表达式就是 Poincaré 常数 $C_{P}(\\Omega)$。我们简化缩放前置因子：\n$$\n\\frac{h^{d/2}}{h^{(d-2)/2}} = h^{\\frac{d}{2} - \\frac{d-2}{2}} = h^{\\frac{d - (d-2)}{2}} = h^{\\frac{2}{2}} = h^{1} = h\n$$\n因此，我们得到关系式：\n$$\nC_{P}(\\Omega_{h}) = h \\, C_{P}(\\Omega)\n$$\n通过将此结果与给定关系式 $C_{P}(\\Omega_{h}) = S(h,d)\\,C_{P}(\\Omega)$ 进行比较，我们确定了缩放因子 $S(h,d)$。\n$$\nS(h,d) = h\n$$\n该缩放因子与空间维度 $d$ 无关。",
            "answer": "$$ \\boxed{h} $$"
        },
        {
            "introduction": "现在，我们将缩放分析应用于有限元方法（FEM）的核心场景中。本练习将探讨在将标准“参考单元”映射到实际网格单元的仿射变换下，$H^1$ 半范数的行为 。这项研究的最终目标是推导出一个基本的“反向不等式”，这对于分析有限元近似的稳定性和收敛性是必不可少的工具。",
            "id": "3397300",
            "problem": "设 $\\hat K \\subset \\mathbb{R}^{d}$ 是一个固定的参考单元，其内部非空且直径为1。设 $K \\subset \\mathbb{R}^{d}$ 是一个物理单元，它是通过一个仿射映射 $F:\\hat K \\to K$ 从 $\\hat K$ 得到的，该映射的形式为 $x = F(\\hat x) = B \\hat x + b$，其中 $B \\in \\mathbb{R}^{d \\times d}$ 是可逆矩阵，$b \\in \\mathbb{R}^{d}$。将 $K$ 的直径记为 $h = \\operatorname{diam}(K) = \\sup_{x,y \\in K} |x - y|$。对于 $v \\in H^{1}(K)$，定义 $\\hat v \\in H^{1}(\\hat K)$ 为 $\\hat v(\\hat x) = v(F(\\hat x))$。回顾一下，对于任何可测函数 $g$ 和任何可逆仿射映射 $F$，变量替换公式为 $\\int_{K} g(x)\\,dx = \\int_{\\hat K} g(F(\\hat x))\\,|\\det B|\\,d\\hat x$，且梯度的链式法则给出 $\\nabla_{\\hat x} \\hat v(\\hat x) = B^{T} \\nabla_{x} v(F(\\hat x))$。\n\n假设存在一个形状正则的仿射映射族，其意义如下：存在正常数 $c_{\\min}$ 和 $c_{\\max}$，它们与 $K$ 和 $h$ 无关，使得 $c_{\\min}\\,h \\le \\|B\\| \\le c_{\\max}\\,h$ 和 $c_{\\min}\\,h^{d} \\le |\\det B| \\le c_{\\max}\\,h^{d}$，其中 $\\|\\cdot\\|$ 是由欧几里得范数诱导的算子范数。令 $|\\cdot|_{H^{1}(D)}$ 表示区域 $D$ 上的 $H^{1}$ 半范数，即 $|w|_{H^{1}(D)} := \\|\\nabla w\\|_{L^{2}(D)}$。\n\n任务A。仅从给定的变量替换和链式法则事实出发，推导在仿射映射下 $H^{1}$ 半范数缩放的显式 $h$-依赖关系，即存在一个与 $h$ 无关的形状常数 $C_{\\mathrm{sr}} \\ge 1$，使得\n$$\nC_{\\mathrm{sr}}^{-1}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le C_{\\mathrm{sr}}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)}.\n$$\n将 $S(h,d)$ 确定为关于 $h$ 和 $d$ 的单一表达式。\n\n任务B。令 $V_{h}(K)$ 为一个固定的多项式空间 $V(\\hat K)$ 在映射 $F$ 下的像，该空间由 $\\hat K$ 上所有总次数至多为 $p$ 的多项式组成，其中 $p$ 的取值与 $h$ 无关。仅使用 $V(\\hat K)$ 上的有限维范数等价性和任务A的结果，推导反向不等式\n$$\n\\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)} \\quad \\text{for all } v_{h} \\in V_{h}(K),\n$$\n其中常数 $C$ 与 $h$ 无关。\n\n答案规格：你的最终答案必须是你在任务A中找到的单一闭式表达式。无需单位，也无需四舍五入。请将你的答案表示为仅含 $h$ 和 $d$ 的函数。",
            "solution": "用户提供了一个问题，要求推导仿射映射下 $H^{1}$ 半范数的缩放规律，并随后推导一个有限元反向不等式。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   参考单元：$\\hat K \\subset \\mathbb{R}^{d}$，内部非空，$\\operatorname{diam}(\\hat K) = 1$。\n*   物理单元：$K \\subset \\mathbb{R}^{d}$，$\\operatorname{diam}(K) = h$。\n*   仿射映射：$F:\\hat K \\to K$, $x = F(\\hat x) = B \\hat x + b$，其中 $B \\in \\mathbb{R}^{d \\times d}$ 可逆，$b \\in \\mathbb{R}^{d}$。\n*   函数映射：对于 $v \\in H^{1}(K)$，$\\hat v \\in H^{1}(\\hat K)$ 定义为 $\\hat v(\\hat x) = v(F(\\hat x))$。\n*   变量替换：$\\int_{K} g(x)\\,dx = \\int_{\\hat K} g(F(\\hat x))\\,|\\det B|\\,d\\hat x$。\n*   链式法则：$\\nabla_{\\hat x} \\hat v(\\hat x) = B^{T} \\nabla_{x} v(F(\\hat x))$。\n*   形状正则性假设：存在与 $K$ 和 $h$ 无关的正常数 $c_{\\min}$ 和 $c_{\\max}$，使得：\n    1.  $c_{\\min}\\,h \\le \\|B\\| \\le c_{\\max}\\,h$，其中 $\\|\\cdot\\|$ 是算子范数。\n    2.  $c_{\\min}\\,h^{d} \\le |\\det B| \\le c_{\\max}\\,h^{d}$。\n*   $H^1$ 半范数定义：$|w|_{H^{1}(D)} := \\|\\nabla w\\|_{L^{2}(D)} = \\left(\\int_{D} |\\nabla w(y)|^2 dy\\right)^{1/2}$。\n*   任务A目标：在关系式 $C_{\\mathrm{sr}}^{-1}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le C_{\\mathrm{sr}}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)}$ 中找到 $S(h,d)$。\n*   任务B设置：$V(\\hat K)$ 是总次数至多为 $p$ 的多项式空间。$V_{h}(K)$ 是 $V(\\hat K)$ 在映射 $F$ 下的像。\n*   任务B目标：对所有 $v_{h} \\in V_{h}(K)$，推导反向不等式 $\\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)}$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n该问题是有限元方法数学理论中的一个标准练习。\n*   **科学依据**：该问题基于线性代数、多元微积分（变量替换、链式法则）和泛函分析（$L^2$ 和Sobolev空间）的基本原理。形状正则性和缩放规律的推导是有限元方法收敛性分析的核心。该问题在数学上和科学上都是合理的。\n*   **良定的**：问题陈述清晰，包含了所有必要的定义和假设。如推导过程所示，所给假设足以得出一个唯一的缩放因子 $S(h,d)$ 并证明反向不等式。问题没有欠定或超定。\n*   **客观的**：语言精确且数学化，没有任何主观性或模糊性。\n\n该问题不违反任何无效性标准。所有术语都是标准的或有明确定义。假设是自洽的，并且足以完成任务。\n\n**步骤3：结论与行动**\n\n问题是**有效的**。我将继续进行解答。\n\n### 解答\n\n解答分为两部分，如问题陈述所要求。\n\n**任务A：$H^{1}$ 半范数的缩放**\n\n目标是找到缩放因子 $S(h,d)$，它将物理单元 $K$ 上的函数 $v$ 的 $H^{1}$ 半范数与参考单元 $\\hat{K}$ 上对应函数 $\\hat{v}$ 的半范数联系起来。\n\n$K$ 上 $v$ 的 $H^{1}$ 半范数的平方定义为：\n$$\n|v|_{H^{1}(K)}^{2} = \\int_{K} |\\nabla_{x} v(x)|^{2} dx\n$$\n我们将给定的变量替换公式应用于 $g(x) = |\\nabla_{x} v(x)|^{2}$。\n$$\n|v|_{H^{1}(K)}^{2} = \\int_{\\hat K} |\\nabla_{x} v(F(\\hat x))|^{2} |\\det B| \\,d\\hat x\n$$\n接下来，我们使用给定的链式法则 $\\nabla_{\\hat x} \\hat v(\\hat x) = B^{T} \\nabla_{x} v(F(\\hat x))$。由于 $B$ 可逆，所以 $B^T$ 也可逆。我们可以写出：\n$$\n\\nabla_{x} v(F(\\hat x)) = (B^{T})^{-1} \\nabla_{\\hat x} \\hat v(\\hat x)\n$$\n将此代入积分表达式中，得到：\n$$\n|v|_{H^{1}(K)}^{2} = \\int_{\\hat K} |(B^{T})^{-1} \\nabla_{\\hat x} \\hat v(\\hat x)|^{2} |\\det B| \\,d\\hat x\n$$\n令向量场 $\\hat w(\\hat x) = \\nabla_{\\hat x} \\hat v(\\hat x)$。其范数的平方是点积：\n$$\n|(B^{T})^{-1} \\hat w|^{2} = ((B^{T})^{-1} \\hat w) \\cdot ((B^{T})^{-1} \\hat w) = \\hat w^{T} (B^{T})^{-T} (B^{T})^{-1} \\hat w = \\hat w^{T} (B^{-1}) (B^{T})^{-1} \\hat w = \\hat w^{T} (B B^{T})^{-1} \\hat w\n$$\n矩阵 $(B B^{T})^{-1}$ 是对称正定的。表达式 $\\hat w^{T} (B B^{T})^{-1} \\hat w$ 可以由 $(B B^{T})^{-1}$ 的最小和最大特征值界定。$B B^{T}$ 的特征值是 $B$ 的奇异值 $\\sigma_i(B)$ 的平方。因此，$(B B^{T})^{-1}$ 的特征值是 $1/\\sigma_i(B)^{2}$。\n令 $\\sigma_{\\min}(B)$ 和 $\\sigma_{\\max}(B)$ 分别为 $B$ 的最小和最大奇异值。那么 $(B B^{T})^{-1}$ 的最小和最大特征值分别是 $1/\\sigma_{\\max}(B)^{2}$ 和 $1/\\sigma_{\\min}(B)^{2}$。\n我们知道算子范数是 $\\|B\\| = \\sigma_{\\max}(B)$ 且 $\\|B^{-1}\\| = 1/\\sigma_{\\min}(B)$。因此，瑞利商有界：\n$$\n\\frac{1}{\\|B\\|^{2}} |\\hat w|^{2} \\le \\hat w^{T} (B B^{T})^{-1} \\hat w \\le \\|B^{-1}\\|^{2} |\\hat w|^{2}\n$$\n将这些界应用于我们的积分表达式，我们得到两个不等式。\n\n对于上界：\n$$\n|v|_{H^{1}(K)}^{2} \\le \\int_{\\hat K} \\|B^{-1}\\|^{2} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} |\\det B| \\,d\\hat x = \\|B^{-1}\\|^{2} |\\det B| \\int_{\\hat K} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} \\,d\\hat x = \\|B^{-1}\\|^{2} |\\det B| |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\n对于下界：\n$$\n|v|_{H^{1}(K)}^{2} \\ge \\int_{\\hat K} \\frac{1}{\\|B\\|^{2}} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} |\\det B| \\,d\\hat x = \\frac{|\\det B|}{\\|B\\|^{2}} \\int_{\\hat K} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} \\,d\\hat x = \\frac{|\\det B|}{\\|B\\|^{2}} |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\n现在，我们使用形状正则性假设。首先，我们必须界定 $\\|B^{-1}\\|$。根据奇异值的性质，$\\|B^{-1}\\| = 1/\\sigma_{\\min}(B)$。行列式是奇异值的乘积，即 $|\\det B| = \\prod_{i=1}^d \\sigma_i(B)$。因此， $|\\det B| \\le \\sigma_{\\min}(B) (\\sigma_{\\max}(B))^{d-1} = \\sigma_{\\min}(B) \\|B\\|^{d-1}$。这得出 $\\sigma_{\\min}(B) \\ge \\frac{|\\det B|}{\\|B\\|^{d-1}}$。因此：\n$$\n\\|B^{-1}\\| = \\frac{1}{\\sigma_{\\min}(B)} \\le \\frac{\\|B\\|^{d-1}}{|\\det B|}\n$$\n使用给定的假设 $c_{\\min}\\,h \\le \\|B\\| \\le c_{\\max}\\,h$ 和 $c_{\\min}\\,h^{d} \\le |\\det B| \\le c_{\\max}\\,h^{d}$：\n$$\n\\|B^{-1}\\| \\le \\frac{(c_{\\max}h)^{d-1}}{c_{\\min}h^{d}} = \\frac{c_{\\max}^{d-1}}{c_{\\min}} h^{-1}\n$$\n现在我们可以界定不等式中的各项。\n对于 $|v|_{H^{1}(K)}$ 的上界：\n$$\n|v|_{H^{1}(K)}^{2} \\le \\|B^{-1}\\|^{2} |\\det B| |\\hat v|_{H^{1}(\\hat K)}^{2} \\le \\left(\\frac{c_{\\max}^{d-1}}{c_{\\min}} h^{-1}\\right)^{2} (c_{\\max}h^{d}) |\\hat v|_{H^{1}(\\hat K)}^{2} = \\frac{c_{\\max}^{2d-2+1}}{c_{\\min}^{2}} h^{-2+d} |\\hat v|_{H^{1}(\\hat K)}^{2} = \\frac{c_{\\max}^{2d-1}}{c_{\\min}^{2}} h^{d-2} |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\n对于 $|v|_{H^{1}(K)}$ 的下界：\n$$\n|v|_{H^{1}(K)}^{2} \\ge \\frac{|\\det B|}{\\|B\\|^{2}} |\\hat v|_{H^{1}(\\hat K)}^{2} \\ge \\frac{c_{\\min}h^{d}}{(c_{\\max}h)^{2}} |\\hat v|_{H^{1}(\\hat K)}^{2} = \\frac{c_{\\min}}{c_{\\max}^{2}} h^{d-2} |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\n对两个不等式取平方根，我们得到：\n$$\n\\sqrt{\\frac{c_{\\min}}{c_{\\max}^{2}}} h^{\\frac{d-2}{2}} |\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le \\sqrt{\\frac{c_{\\max}^{2d-1}}{c_{\\min}^{2}}} h^{\\frac{d-2}{2}} |\\hat v|_{H^{1}(\\hat K)}\n$$\n这具有 $C_{\\mathrm{sr}}^{-1}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le C_{\\mathrm{sr}}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)}$ 的形式，其中形状常数 $C_{\\mathrm{sr}}$ 依赖于 $c_{\\min}$、$c_{\\max}$ 和 $d$，但与 $h$ 无关。缩放因子 $S(h,d)$ 被确定为：\n$$\nS(h,d) = h^{\\frac{d-2}{2}}\n$$\n\n**任务B：反向不等式**\n\n我们要对 $v_h \\in V_h(K)$ 推导反向不等式 $\\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)}$。这等价于 $|v_h|_{H^1(K)} \\le C h^{-1} \\|v_h\\|_{L^2(K)}$。\n设 $v_h \\in V_h(K)$。那么存在一个次数至多为 $p$ 的多项式 $\\hat{v}_h \\in V(\\hat{K})$，使得对于 $x = F(\\hat{x})$，有 $v_h(x) = \\hat{v}_h(\\hat{x})$。\n\n1.  **关联 $|v_h|_{H^1(K)}$ 与 $|\\hat{v}_h|_{H^1(\\hat K)}$**：从任务A，我们有上界：\n    $$\n    |v_h|_{H^1(K)} \\le C_1 h^{\\frac{d-2}{2}} |\\hat{v}_h|_{H^1(\\hat K)}\n    $$\n    其中 $C_1 = \\sqrt{c_{\\max}^{2d-1}/c_{\\min}^{2}}$ 是一个与 $h$ 无关的常数。\n\n2.  **关联 $\\|\\hat{v}_h\\|_{H^1(\\hat K)}$ 与 $\\|\\hat{v}_h\\|_{L^2(\\hat K)}$**：空间 $V(\\hat{K})$ 是一个有限维向量空间。在有限维空间上，所有范数都是等价的。算子 $\\nabla: V(\\hat K) \\to [V(\\hat K)]^{d}$ 是有限维空间之间的线性映射，因此是有界的。这意味着存在一个常数 $C_{\\text{equiv}}$，它仅依赖于空间 $V(\\hat K)$（即依赖于 $p$ 和 $\\hat K$ 的几何形状），使得对于任何 $\\hat{v}_h \\in V(\\hat K)$：\n    $$\n    |\\hat{v}_h|_{H^1(\\hat K)} = \\|\\nabla \\hat{v}_h\\|_{L^2(\\hat K)} \\le C_{\\text{equiv}} \\|\\hat{v}_h\\|_{L^2(\\hat K)}\n    $$\n\n3.  **关联 $\\|\\hat{v}_h\\|_{L^2(\\hat K)}$ 与 $\\|v_h\\|_{L^2(K)}$**：我们分析 $L^2$ 范数的缩放。\n    $$\n    \\|v_h\\|_{L^2(K)}^2 = \\int_K |v_h(x)|^2 dx = \\int_{\\hat K} |v_h(F(\\hat x))|^2 |\\det B| d\\hat x = \\int_{\\hat K} |\\hat{v}_h(\\hat x)|^2 |\\det B| d\\hat x\n    $$\n    使用行列式的下界 $|\\det B| \\ge c_{\\min}h^d$：\n    $$\n    \\|v_h\\|_{L^2(K)}^2 \\ge c_{\\min}h^d \\int_{\\hat K} |\\hat{v}_h(\\hat x)|^2 d\\hat x = c_{\\min}h^d \\|\\hat{v}_h\\|_{L^2(\\hat K)}^2\n    $$\n    取平方根并重新整理得：\n    $$\n    \\|\\hat{v}_h\\|_{L^2(\\hat K)} \\le \\frac{1}{\\sqrt{c_{\\min}} h^{d/2}} \\|v_h\\|_{L^2(K)}\n    $$\n\n4.  **组合这些不等式**：\n    从步骤1的结果开始：\n    $$\n    |v_h|_{H^1(K)} \\le C_1 h^{\\frac{d-2}{2}} |\\hat{v}_h|_{H^1(\\hat K)}\n    $$\n    使用步骤2的范数等价性：\n    $$\n    |v_h|_{H^1(K)} \\le C_1 h^{\\frac{d-2}{2}} (C_{\\text{equiv}} \\|\\hat{v}_h\\|_{L^2(\\hat K)})\n    $$\n    最后，使用步骤3的缩放关系：\n    $$\n    |v_h|_{H^1(K)} \\le C_1 C_{\\text{equiv}} h^{\\frac{d-2}{2}} \\left( \\frac{1}{\\sqrt{c_{\\min}} h^{d/2}} \\|v_h\\|_{L^2(K)} \\right)\n    $$\n    化简表达式：\n    $$\n    |v_h|_{H^1(K)} \\le \\left(\\frac{C_1 C_{\\text{equiv}}}{\\sqrt{c_{\\min}}}\\right) h^{\\frac{d-2}{2} - \\frac{d}{2}} \\|v_h\\|_{L^2(K)} = \\left(\\frac{C_1 C_{\\text{equiv}}}{\\sqrt{c_{\\min}}}\\right) h^{-1} \\|v_h\\|_{L^2(K)}\n    $$\n    令 $C = \\frac{C_1 C_{\\text{equiv}}}{\\sqrt{c_{\\min}}}$，我们得到一个与 $h$ 无关的常数，并获得所求的反向不等式：\n    $$\n    \\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)}\n    $$\n要求的最终答案是任务A中得到的 $S(h,d)$ 的表达式。",
            "answer": "$$\\boxed{h^{\\frac{d-2}{2}}}$$"
        }
    ]
}