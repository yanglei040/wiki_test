{
    "hands_on_practices": [
        {
            "introduction": "我们从一个典型案例着手：分析一维拉普拉斯算子离散后产生的矩阵。这个矩阵是数值偏微分方程中的基本构件，其条件数直接影响线性方程组求解的效率和难度。本练习将引导您从第一性原理出发，推导其条件数的渐进行为 ，这是一个在数值分析中具有基石意义的重要结论。",
            "id": "3436714",
            "problem": "考虑单位区间上的的一维泊松方程边值问题，其形式为 $-u''(x) = f(x)$，$x \\in (0,1)$，并带有狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。将该区间离散化为 $n$ 个内部网格点，均匀步长为 $h = \\frac{1}{n+1}$，并使用标准中心有限差分算子来近似 $-u''(x)$。这会得到一个线性系统 $A \\mathbf{u} = \\mathbf{b}$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个三对角矩阵，其元素为 $A_{ii} = \\frac{2}{h^{2}}$ 和 $A_{i,i\\pm 1} = -\\frac{1}{h^{2}}$。矩阵 $A$ 是对称的、对角占优的，并且是对称正定的 (SPD)。\n\n令 $\\kappa_{2}(A)$ 表示 $A$ 的 2-范数条件数，定义为 $\\kappa_{2}(A) = \\|A\\|_{2} \\|A^{-1}\\|_{2}$。从第一性原理出发，包括离散算子的定义和对称矩阵 2-范数的谱特征，推导当 $h \\to 0$ 时 $\\kappa_{2}(A)$ 的渐近尺度，并确定主阶关系 $\\kappa_{2}(A) \\sim C h^{-2}$ 中的精确常数 $C$。将 $C$ 表示为一个闭式解析表达式。你的最终答案必须是 $C$ 的值；无需四舍五入。",
            "solution": "问题要求推导由一维泊松方程的有限差分离散化所产生的矩阵 $A$ 的条件数 $\\kappa_{2}(A)$ 的渐近尺度。我们的任务是找出当网格步长 $h \\to 0$ 时，关系式 $\\kappa_{2}(A) \\sim C h^{-2}$ 中的常数 $C$。\n\n问题陈述了，在具有 $n$ 个内部点和步长 $h = \\frac{1}{n+1}$ 的均匀网格上，使用中心有限差分近似来离散化微分算子 $-u''(x)$，会得到一个 $n \\times n$ 的矩阵 $A$。该矩阵的元素为 $A_{ii} = \\frac{2}{h^2}$ 和 $A_{i, i\\pm 1} = -\\frac{1}{h^2}$。我们可以将矩阵 $A$ 表示为一个更简单的三对角矩阵 $T$ 的缩放，其中 $T$ 的元素为 $T_{ii}=2$ 和 $T_{i, i\\pm 1}=-1$。具体来说，$A = \\frac{1}{h^2} T$，其中 $T \\in \\mathbb{R}^{n \\times n}$ 由下式给出：\n$$\nT = \\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\ddots  \\vdots \\\\\n0  -1  \\ddots  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  2  -1 \\\\\n0  \\cdots  0  -1  2\n\\end{pmatrix}\n$$\n问题陈述了 $A$ 是对称正定的 (SPD)。这是该矩阵的一个熟知的性质。对于一个对称矩阵，其 2-范数 $\\|A\\|_2$ 等于其谱半径 $\\rho(A)$，即其特征值绝对值的最大值。由于 $A$ 是正定的，其所有特征值都是正实数。因此，$\\|A\\|_2 = \\lambda_{\\max}(A)$，即 $A$ 的最大特征值。\n\n逆矩阵 $A^{-1}$ 也是对称正定的。它的特征值是 $A$ 的特征值的倒数。因此，$A^{-1}$ 的最大特征值是 $A$ 的最小特征值的倒数，即 $\\lambda_{\\max}(A^{-1}) = \\frac{1}{\\lambda_{\\min}(A)}$。从而，$\\|A^{-1}\\|_2 = \\frac{1}{\\lambda_{\\min}(A)}$。\n\n2-范数条件数 $\\kappa_2(A)$ 定义为 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。对于对称矩阵，使用谱特征，我们有：\n$$\n\\kappa_2(A) = \\lambda_{\\max}(A) \\cdot \\frac{1}{\\lambda_{\\min}(A)} = \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)}\n$$\n为了求出条件数，我们首先需要确定 $A$ 的特征值。矩阵 $T$ 的特征值是线性代数中的一个标准结果。对于一个如上形式的 $n \\times n$ 矩阵 $T$，其特征值为：\n$$\n\\mu_k = 2 - 2\\cos\\left(\\frac{k\\pi}{n+1}\\right) \\quad \\text{for } k=1, 2, \\ldots, n\n$$\n由于 $A = \\frac{1}{h^2} T$，矩阵 $A$ 的特征值，记作 $\\lambda_k$，就是矩阵 $T$ 的特征值乘以因子 $\\frac{1}{h^2}$：\n$$\n\\lambda_k = \\frac{\\mu_k}{h^2} = \\frac{2}{h^2} \\left(1 - \\cos\\left(\\frac{k\\pi}{n+1}\\right)\\right) \\quad \\text{for } k=1, 2, \\ldots, n\n$$\n我们需要找到这些特征值的最小值和最大值。对于 $k \\in \\{1, \\ldots, n\\}$，项 $\\frac{k\\pi}{n+1}$ 位于区间 $(0, \\pi)$ 内。在此区间内，函数 $\\cos(x)$ 是严格递减的。因此，函数 $1-\\cos(x)$ 是严格递增的。最小特征值 $\\lambda_{\\min}(A)$ 将在 $k$ 取最小值时出现，即 $k=1$。最大特征值 $\\lambda_{\\max}(A)$ 将在 $k$ 取最大值时出现，即 $k=n$。\n\n最小特征值为：\n$$\n\\lambda_{\\min}(A) = \\lambda_1 = \\frac{2}{h^2} \\left(1 - \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)\n$$\n最大特征值为：\n$$\n\\lambda_{\\max}(A) = \\lambda_n = \\frac{2}{h^2} \\left(1 - \\cos\\left(\\frac{n\\pi}{n+1}\\right)\\right)\n$$\n条件数是这两个特征值的比值：\n$$\n\\kappa_2(A) = \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)} = \\frac{\\frac{2}{h^2} \\left(1 - \\cos\\left(\\frac{n\\pi}{n+1}\\right)\\right)}{\\frac{2}{h^2} \\left(1 - \\cos\\left(\\frac{\\pi}{n+1}\\right)\\right)} = \\frac{1 - \\cos\\left(\\frac{n\\pi}{n+1}\\right)}{1 - \\cos\\left(\\frac{\\pi}{n+1}\\right)}\n$$\n我们关心的是当 $h \\to 0$ 时的渐近行为。由于 $h = \\frac{1}{n+1}$，这等价于 $n \\to \\infty$。我们分别分析分子和分母。\n\n对于分子，我们使用恒等式 $\\cos(\\pi - x) = -\\cos(x)$：\n$$\n1 - \\cos\\left(\\frac{n\\pi}{n+1}\\right) = 1 - \\cos\\left(\\frac{(n+1-1)\\pi}{n+1}\\right) = 1 - \\cos\\left(\\pi - \\frac{\\pi}{n+1}\\right) = 1 - \\left(-\\cos\\left(\\frac{\\pi}{n+1}\\right)\\right) = 1 + \\cos\\left(\\frac{\\pi}{n+1}\\right)\n$$\n当 $n \\to \\infty$ 时，$\\frac{\\pi}{n+1} \\to 0$，因此 $\\cos\\left(\\frac{\\pi}{n+1}\\right) \\to \\cos(0) = 1$。分子渐近地趋向于 $1+1=2$。\n\n对于分母，我们分析当 $n \\to \\infty$ 时 $1 - \\cos\\left(\\frac{\\pi}{n+1}\\right)$ 这一项。余弦函数的自变量 $x = \\frac{\\pi}{n+1}$ 很小。我们可以使用 $\\cos(x)$ 在 $x=0$ 附近的泰勒级数展开：$\\cos(x) = 1 - \\frac{x^2}{2!} + O(x^4)$。\n$$\n1 - \\cos\\left(\\frac{\\pi}{n+1}\\right) = 1 - \\left(1 - \\frac{1}{2}\\left(\\frac{\\pi}{n+1}\\right)^2 + O\\left(\\left(\\frac{\\pi}{n+1}\\right)^4\\right)\\right) = \\frac{\\pi^2}{2(n+1)^2} + O\\left(\\frac{1}{(n+1)^4}\\right)\n$$\n代入 $h = \\frac{1}{n+1}$，分母的主阶行为是 $\\frac{\\pi^2 h^2}{2}$。\n\n结合分子和分母的渐近行为，我们得到条件数的渐近尺度：\n$$\n\\kappa_2(A) \\sim \\frac{2}{\\frac{\\pi^2 h^2}{2}} = \\frac{4}{\\pi^2 h^2} = \\frac{4}{\\pi^2} h^{-2}\n$$\n这就是当 $h \\to 0$ 时 $\\kappa_2(A)$ 的主阶关系。问题要求找出关系式 $\\kappa_2(A) \\sim C h^{-2}$ 中的常数 $C$。通过将我们的结果与此形式进行比较，我们可以确定常数 $C$。\n$$\nC = \\frac{4}{\\pi^2}\n$$\n这是一个关于常数 $C$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{4}{\\pi^2}}\n$$"
        },
        {
            "introduction": "在更高级的数值方法（如非协调有限元或稳定化方法）中，我们常会遇到非对称的系统矩阵。本练习旨在剖析这类矩阵，探究其对称和反对称部分如何影响整体性质，特别是与误差分析密切相关的能量范数 。通过这个练习，您将理解为何只有对称部分对能量范数有贡献，这是一个深刻且实用的理论洞见。",
            "id": "3436701",
            "problem": "考虑单位正方形上的二阶椭圆模型问题，其具有齐次狄利克雷边界条件，并以变分形式提出：求 $u \\in H_{0}^{1}(\\Omega)$，使得对于所有 $v \\in H_{0}^{1}(\\Omega)$，双线性形式 $a(u,v)$ 满足 $a(u,v) = \\ell(v)$，其中 $\\Omega = (0,1)^{2}$ 且 $a(u,v) = \\int_{\\Omega} \\kappa(\\boldsymbol{x}) \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\boldsymbol{x}$。假设 $\\kappa(\\boldsymbol{x}) \\in L^{\\infty}(\\Omega)$ 且满足 $0  \\underline{\\kappa} \\leq \\kappa(\\boldsymbol{x}) \\leq \\overline{\\kappa}  \\infty$。令 $V_{h}$ 为一个逼近 $H_{0}^{1}(\\Omega)$ 的非协调有限维子空间，并令 $u_{h} \\in V_{h}$ 表示计算得到的离散解。\n\n假设关于 $u_{h}$ 的组装线性系统为 $A u_{h} = f$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是一个实方阵，可分解为 $A = S + J + K$，且满足以下条件：\n- $S$ 是对称正定的，由离散扩散双线性形式导出（由于 $\\underline{\\kappa} > 0$ 和离散庞加莱不等式而具有强制性）。\n- $J$ 是对称的，源于因非协调性而引入的一致性修正。\n- $K$ 是斜对称的，源于模拟单元间界面上弱迎风通量的稳定化项。\n\n假设谱条件 $\\lambda_{\\min}(S) \\geq \\alpha > 0$ 对某个与 $h$ 无关的常数 $\\alpha$ 成立，并且对称扰动在矩阵谱范数下受 $\\|J\\|_{2} \\leq \\theta \\, \\lambda_{\\min}(S)$ 控制，其中 $0 \\leq \\theta  1$。考虑对称化算子 $A_{s} = \\frac{1}{2}(A + A^{\\top})$。\n\n对 $v \\in \\mathbb{R}^{n}$，定义由 $A$ 和 $A_{s}$ 导出的能量半范数为 $\\|v\\|_{A} = \\sqrt{v^{\\top} A v}$ 和 $\\|v\\|_{A_{s}} = \\sqrt{v^{\\top} A_{s} v}$。从基本原理出发：\n- 阐明 $A_{s}$ 在何种条件下（用 $\\alpha$ 和 $\\theta$ 表示）是对称正定的。\n- 建立能量半范数 $\\|u_{h}\\|_{A}$ 和 $\\|u_{h}\\|_{A_{s}}$ 之间的精确关系。\n\n以单一闭式表达式的形式报告比值\n$$\nr = \\frac{\\|u_{h}\\|_{A_{s}}}{\\|u_{h}\\|_{A}}\n$$\n的精确值。无需四舍五入，不涉及物理单位。",
            "solution": "问题要求我们首先验证对称化矩阵 $A_s$ 在何种条件下是正定的，然后确定由矩阵 $A$ 及其对称部分 $A_s$ 定义的两个能量半范数的比值。我们将通过对给定矩阵性质进行形式化处理来着手。\n\n矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 由分解式 $A = S + J + K$ 给出，其中：\n- $S$ 是对称正定(SPD)的。\n- $J$ 是对称的。\n- $K$ 是斜对称的，即 $K^{\\top} = -K$。\n\n对称化算子 $A_s$ 定义为 $A_s = \\frac{1}{2}(A + A^{\\top})$。让我们用 $S$、$J$ 和 $K$ 来表示 $A_s$。\n$A$ 的转置是 $A^{\\top} = (S + J + K)^{\\top} = S^{\\top} + J^{\\top} + K^{\\top}$。\n根据 $S$、$J$ 和 $K$ 的性质，这可以简化为 $A^{\\top} = S + J - K$。\n将 $A$ 和 $A^{\\top}$ 的表达式代入 $A_s$ 的定义中：\n$$\nA_s = \\frac{1}{2} \\left( (S + J + K) + (S + J - K) \\right) = \\frac{1}{2} (2S + 2J) = S + J\n$$\n所以，对称化算子就是两个对称矩阵 $S$ 和 $J$ 的和。\n\n第一个任务是阐明 $A_s$ 在何种条件下是对称正定的。\n首先，我们检查对称性。由于 $S$ 和 $J$ 都是对称的，它们的和 $A_s = S+J$ 也是对称的：$(S+J)^{\\top} = S^{\\top} + J^{\\top} = S+J$。\n接下来，我们检查正定性。如果对于任何非零向量 $v \\in \\mathbb{R}^n$，相关的二次型 $v^{\\top}A_s v$ 都严格为正，则该对称矩阵是正定的。\n$$\nv^{\\top}A_s v = v^{\\top}(S+J)v = v^{\\top}Sv + v^{\\top}Jv\n$$\n对于对称正定矩阵 $S$，瑞利-里兹定理指出 $v^{\\top}Sv \\geq \\lambda_{\\min}(S) v^{\\top}v$，其中 $\\lambda_{\\min}(S)$ 是 $S$ 的最小特征值。我们已知 $\\lambda_{\\min}(S) \\geq \\alpha > 0$。表达式 $v^{\\top}v$ 是欧几里得范数的平方，即 $\\|v\\|_2^2$。\n所以，$v^{\\top}Sv \\geq \\lambda_{\\min}(S) \\|v\\|_2^2$。\n\n对于对称矩阵 $J$，一个类似的性质成立：$v^{\\top}Jv \\geq \\lambda_{\\min}(J) \\|v\\|_2^2$。对称矩阵的谱范数 $\\|J\\|_2$ 由 $\\max_i |\\lambda_i(J)|$ 给出。这意味着 $\\lambda_{\\min}(J) \\geq -\\|J\\|_2$。\n因此，我们可以从下方界定 $J$ 的二次型：$v^{\\top}Jv \\geq -\\|J\\|_2 \\|v\\|_2^2$。\n\n结合这两个不等式，我们得到 $v^{\\top}A_s v$ 的一个下界：\n$$\nv^{\\top}A_s v \\geq \\lambda_{\\min}(S) \\|v\\|_2^2 - \\|J\\|_2 \\|v\\|_2^2 = \\left(\\lambda_{\\min}(S) - \\|J\\|_2\\right) \\|v\\|_2^2\n$$\n为了使 $A_s$ 是正定的，我们需要 $\\lambda_{\\min}(S) - \\|J\\|_2 > 0$。\n问题给出的条件是 $\\|J\\|_2 \\leq \\theta \\, \\lambda_{\\min}(S)$，其中 $0 \\leq \\theta  1$。利用这个条件，我们有：\n$$\n\\lambda_{\\min}(S) - \\|J\\|_2 \\geq \\lambda_{\\min}(S) - \\theta \\, \\lambda_{\\min}(S) = (1-\\theta) \\lambda_{\\min}(S)\n$$\n由于 $0 \\leq \\theta  1$，因子 $(1-\\theta)$ 严格为正。我们还已知 $\\lambda_{\\min}(S) \\geq \\alpha > 0$。\n因此，对于任何非零向量 $v$：\n$$\nv^{\\top}A_s v \\geq (1-\\theta) \\lambda_{\\min}(S) \\|v\\|_2^2 \\geq (1-\\theta) \\alpha \\|v\\|_2^2 > 0\n$$\n这证明了在指定条件下，$A_s = S+J$ 确实是对称正定的。这些条件确保了对称扰动 $J$ 不会大到足以破坏占主导地位的对称部分 $S$ 的正定性。\n\n第二个任务是建立能量半范数 $\\|u_h\\|_A = \\sqrt{u_h^{\\top} A u_h}$ 和 $\\|u_h\\|_{A_s} = \\sqrt{u_h^{\\top} A_s u_h}$ 之间的关系。让我们分析对于任意向量 $v \\in \\mathbb{R}^n$ 的二次型 $v^{\\top}Av$。\n$$\n\\|v\\|_A^2 = v^{\\top}Av = v^{\\top}(S+J+K)v = v^{\\top}(S+J)v + v^{\\top}Kv\n$$\n项 $v^{\\top}Kv$ 是斜对称矩阵 $K$ 的二次型。对于任何实向量 $v$，该项恒为零。为了证明这一点，令 $c = v^{\\top}Kv$。由于 $c$ 是一个标量，它等于其自身的转置：$c = c^{\\top}$。\n$$\nc = (v^{\\top}Kv)^{\\top} = v^{\\top}K^{\\top}v\n$$\n利用斜对称性质 $K^{\\top}=-K$，我们有：\n$$\nc = v^{\\top}(-K)v = -v^{\\top}Kv = -c\n$$\n唯一满足 $c=-c$ 的标量是 $c=0$。因此，$v^{\\top}Kv = 0$。\n这是一个基本性质：矩阵的斜对称部分对其二次型没有贡献。因此，$\\|v\\|_A^2$ 的表达式简化为：\n$$\n\\|v\\|_A^2 = v^{\\top}(S+J)v\n$$\n现在，我们研究第二个能量半范数 $\\|v\\|_{A_s}$。如前所述，$A_s = S+J$。\n$$\n\\|v\\|_{A_s}^2 = v^{\\top}A_s v = v^{\\top}(S+J)v\n$$\n通过比较两个半范数的平方表达式，我们得出了精确的关系：\n$$\n\\|v\\|_A^2 = \\|v\\|_{A_s}^2\n$$\n这个等式对所有向量 $v \\in \\mathbb{R}^n$ 都成立，特别地，对离散解向量 $u_h$ 也成立。由于 $A_s$ 是正定的，$\\|u_h\\|_A^2$ 和 $\\|u_h\\|_{A_s}^2$ 都是非负的。对两边取主平方根，我们得到：\n$$\n\\|u_h\\|_A = \\|u_h\\|_{A_s}\n$$\n这两个能量半范数是相同的。\n\n最后的任务是报告比值 $r = \\frac{\\|u_h\\|_{A_s}}{\\|u_h\\|_A}$ 的精确值。\n基于上面推导出的等式，并假设存在非平凡解 $u_h \\neq 0$（这意味着 $\\|u_h\\|_{A_s} > 0$，因为 $A_s$ 是正定的），我们可以写出：\n$$\nr = \\frac{\\|u_h\\|_{A_s}}{\\|u_h\\|_A} = \\frac{\\|u_h\\|_{A_s}}{\\|u_h\\|_{A_s}} = 1\n$$\n该比值恰好为 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "理论分析最终要服务于实践，本练习将带您面对一个实际的挑战：各向异性扩散问题。您会发现，即使物理问题本身是良态的，标准的离散格式也可能导致系统矩阵失去宝贵的M-矩阵性质，从而影响离散最大值原理 。这个练习将通过具体计算，验证这一性质的丢失，同时检验矩阵是否仍然保持正定性。",
            "id": "3436749",
            "problem": "考虑在具有均匀狄利克雷边界条件的二维域上的线性二阶各向异性扩散算子，\n$$\n\\mathcal{L} u = - \\nabla \\cdot \\left( \\boldsymbol{K}(x,y) \\nabla u \\right),\n$$\n其中扩散张量由旋转主轴模型定义\n$$\n\\boldsymbol{K}(x,y) = \\boldsymbol{R}\\!\\left(\\theta(x)\\right) \\begin{pmatrix} k_{1}  0 \\\\ 0  k_{2} \\end{pmatrix} \\boldsymbol{R}\\!\\left(\\theta(x)\\right)^{\\top}, \\quad \\boldsymbol{R}(\\theta) = \\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix},\n$$\n其中 $k_{1} = 1$，$k_{2} = 50$，以及一个空间变化的旋转角\n$$\n\\theta(x) = \\frac{\\pi}{4} + \\frac{\\pi}{4}\\, x.\n$$\n假设域为正方形\n$$\n\\Omega = (0,3) \\times (0,3),\n$$\n并考虑一个间距为 $h=1$ 的均匀笛卡尔网格，因此内部未知量位于四个点 $(x_{i},y_{j})$ 上，其中 $(i,j) \\in \\{1,2\\} \\times \\{1,2\\}$（并且在 $\\partial\\Omega$ 上有狄利克雷边界条件 $u=0$）。设未知量按字典序排列如下\n$$\n\\boldsymbol{u} = \\begin{pmatrix} u_{1,1} \\\\ u_{2,1} \\\\ u_{1,2} \\\\ u_{2,2} \\end{pmatrix}.\n$$\n\n使用在单位正方形控制体积上的标准五点有限体积平衡来离散化该算子，并在面上使用两点法向通量和中心切向梯度。具体来说，在每个内部节点 $(i,j)$ 处，通过以下方式近似东 (E)、西 (W)、北 (N) 和南 (S) 面上的出射通量\n$$\nJ_{\\mathrm{E}} = k_{11}^{\\mathrm{E}} \\left( u_{i+1,j} - u_{i,j} \\right) + k_{12}^{\\mathrm{E}} \\frac{u_{i,j+1} - u_{i,j-1}}{2},\n$$\n$$\nJ_{\\mathrm{W}} = - \\left[ k_{11}^{\\mathrm{W}} \\left( u_{i,j} - u_{i-1,j} \\right) + k_{12}^{\\mathrm{W}} \\frac{u_{i,j+1} - u_{i,j-1}}{2} \\right],\n$$\n$$\nJ_{\\mathrm{N}} = k_{12}^{\\mathrm{N}} \\frac{u_{i+1,j} - u_{i-1,j}}{2} + k_{22}^{\\mathrm{N}} \\left( u_{i,j+1} - u_{i,j} \\right),\n$$\n$$\nJ_{\\mathrm{S}} = - \\left[ k_{12}^{\\mathrm{S}} \\frac{u_{i+1,j} - u_{i-1,j}}{2} + k_{22}^{\\mathrm{S}} \\left( u_{i,j} - u_{i,j-1} \\right) \\right],\n$$\n并将 $(i,j)$ 处的离散算子设为出射通量之和，\n$$\n(\\mathcal{L}_{h} u)_{i,j} = J_{\\mathrm{E}} + J_{\\mathrm{W}} + J_{\\mathrm{N}} + J_{\\mathrm{S}}.\n$$\n面系数由 $\\boldsymbol{K}$ 在面心 $x$ 位置处求值得到，并且根据 $\\boldsymbol{K}$ 的对称性，我们有\n$$\nk_{11}(x) = k_{1} \\cos^{2}\\theta(x) + k_{2} \\sin^{2}\\theta(x), \\quad k_{22}(x) = k_{1} \\sin^{2}\\theta(x) + k_{2} \\cos^{2}\\theta(x), \\quad k_{12}(x) = \\left( k_{1} - k_{2} \\right) \\sin\\theta(x) \\cos\\theta(x).\n$$\n\n任务：\n- 组装与 $\\mathcal{L}_{h}$ 及上述 $\\boldsymbol{u}$ 的排列顺序相关的 $4 \\times 4$ 刚度矩阵 $A$。使用在面心位置 $x = 0.5, 1.0, 1.5, 2.0, 2.5$ 处的显式三角函数值，确定至少一个变为正的非对角元素，从而证明五点格式失去了 M-矩阵性质。\n- 使用组装好的矩阵 $A$，对向量\n$$\n\\boldsymbol{x} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix}.\n$$\n计算二次型 $x^{\\top} A x$。\n以单个精确的闭式解析表达式的形式提供您的最终答案。不需要四舍五入，也不涉及单位。",
            "solution": "所提供的问题是关于偏微分方程数值离散化的一个定义明确的练习。它提供了组装刚度矩阵和执行所需计算所需的所有数据、方程和参数。该问题在科学上是合理的，内部是一致的，并且是可形式化的。因此，该问题是有效的，并将提供解答。\n\n任务是为在 $2 \\times 2$ 内部节点网格上离散化的给定各向异性扩散算子组装 $4 \\times 4$ 刚度矩阵 $A$，然后计算二次型 $\\boldsymbol{x}^{\\top} A \\boldsymbol{x}$。\n\n首先，我们建立刚度矩阵 $A$ 的一行的通用形式。在内部节点 $(i,j)$ 处的离散算子由下式给出\n$$(\\mathcal{L}_{h} u)_{i,j} = J_{\\mathrm{E}} + J_{\\mathrm{W}} + J_{\\mathrm{N}} + J_{\\mathrm{S}}$$\n代入给定的通量表达式：\n\\begin{align*}\n(\\mathcal{L}_{h} u)_{i,j} =  \\left( k_{11}^{\\mathrm{E}} ( u_{i+1,j} - u_{i,j} ) + k_{12}^{\\mathrm{E}} \\frac{u_{i,j+1} - u_{i,j-1}}{2} \\right) \\\\\n - \\left( k_{11}^{\\mathrm{W}} ( u_{i,j} - u_{i-1,j} ) + k_{12}^{\\mathrm{W}} \\frac{u_{i,j+1} - u_{i,j-1}}{2} \\right) \\\\\n + \\left( k_{12}^{\\mathrm{N}} \\frac{u_{i+1,j} - u_{i-1,j}}{2} + k_{22}^{\\mathrm{N}} ( u_{i,j+1} - u_{i,j} ) \\right) \\\\\n - \\left( k_{12}^{\\mathrm{S}} \\frac{u_{i+1,j} - u_{i-1,j}}{2} + k_{22}^{\\mathrm{S}} ( u_{i,j} - u_{i,j-1} ) \\right)\n\\end{align*}\n收集每个未知量 $u_{k,l}$ 的系数：\n\\begin{align*}\n(\\mathcal{L}_{h} u)_{i,j} =  (-k_{11}^{\\mathrm{E}} - k_{11}^{\\mathrm{W}} - k_{22}^{\\mathrm{N}} - k_{22}^{\\mathrm{S}}) u_{i,j} \\\\\n + (k_{11}^{\\mathrm{E}} + \\frac{k_{12}^{\\mathrm{N}} - k_{12}^{\\mathrm{S}}}{2}) u_{i+1,j} \\\\\n + (k_{11}^{\\mathrm{W}} - \\frac{k_{12}^{\\mathrm{N}} - k_{12}^{\\mathrm{S}}}{2}) u_{i-1,j} \\\\\n + (k_{22}^{\\mathrm{N}} + \\frac{k_{12}^{\\mathrm{E}} - k_{12}^{\\mathrm{W}}}{2}) u_{i,j+1} \\\\\n + (k_{22}^{\\mathrm{S}} - \\frac{k_{12}^{\\mathrm{E}} - k_{12}^{\\mathrm{W}}}{2}) u_{i,j-1}\n\\end{align*}\n对应于算子方程 $(\\mathcal{L}_{h} u) = f$ 的系统 $A \\boldsymbol{u} = \\boldsymbol{f}$ 的刚度矩阵 $A$ 具有元素 $A_{IJ}$，其中 $I$ 是节点 $(i,j)$ 的索引，$J$ 是相邻节点的索引。根据椭圆算子刚度矩阵的标准惯例，对角元素 $A_{II}$ 是 $u_{i,j}$ 系数的负值，而非对角元素 $A_{IJ}$ 是相应邻居 $u_{J}$ 系数的负值。\n因此，刚度矩阵元素的格式为：\n- 对角项：$k_{11}^{\\mathrm{E}} + k_{11}^{\\mathrm{W}} + k_{22}^{\\mathrm{N}} + k_{22}^{\\mathrm{S}}$\n- 对应 $u_{i+1,j}$ 的非对角项：$-(k_{11}^{\\mathrm{E}} + \\frac{k_{12}^{\\mathrm{N}} - k_{12}^{\\mathrm{S}}}{2})$\n- 对应 $u_{i-1,j}$ 的非对角项：$-(k_{11}^{\\mathrm{W}} - \\frac{k_{12}^{\\mathrm{N}} - k_{12}^{\\mathrm{S}}}{2})$\n- 对应 $u_{i,j+1}$ 的非对角项：$-(k_{22}^{\\mathrm{N}} + \\frac{k_{12}^{\\mathrm{E}} - k_{12}^{\\mathrm{W}}}{2})$\n- 对应 $u_{i,j-1}$ 的非对角项：$-(k_{22}^{\\mathrm{S}} - \\frac{k_{12}^{\\mathrm{E}} - k_{12}^{\\mathrm{W}}}{2})$\n\n接下来，我们在所需的面心位置计算张量分量 $k_{ab}(x)$。我们有 $k_{1}=1$，$k_{2}=50$，以及 $\\theta(x) = \\frac{\\pi}{4}(1+x)$。\n分量为 $k_{11}(x) = 1 + 49 \\sin^2\\theta(x)$，$k_{22}(x) = 1 + 49 \\cos^2\\theta(x)$，以及 $k_{12}(x) = -49 \\sin\\theta(x)\\cos\\theta(x) = -\\frac{49}{2}\\sin(2\\theta(x))$。\n\n所需的 $x$ 位置为 $x \\in \\{0.5, 1, 1.5, 2, 2.5\\}$。\n- $x=0.5: \\theta = 3\\pi/8$。 $k_{11}(0.5) = \\frac{102+49\\sqrt{2}}{4}$，$k_{22}(0.5) = \\frac{102-49\\sqrt{2}}{4}$，$k_{12}(0.5) = -\\frac{49\\sqrt{2}}{4}$。\n- $x=1.0: \\theta = \\pi/2$。 $k_{11}(1) = 50$，$k_{22}(1) = 1$，$k_{12}(1) = 0$。\n- $x=1.5: \\theta = 5\\pi/8$。 $k_{11}(1.5) = \\frac{102+49\\sqrt{2}}{4}$，$k_{22}(1.5) = \\frac{102-49\\sqrt{2}}{4}$，$k_{12}(1.5) = \\frac{49\\sqrt{2}}{4}$。\n- $x=2.0: \\theta = 3\\pi/4$。 $k_{11}(2) = 1+49(\\frac{1}{2}) = \\frac{51}{2}$，$k_{22}(2) = \\frac{51}{2}$，$k_{12}(2) = 49/2$。\n- $x=2.5: \\theta = 7\\pi/8$。 $k_{11}(2.5) = \\frac{102-49\\sqrt{2}}{4}$，$k_{12}(2.5) = \\frac{49\\sqrt{2}}{4}$。\n\n未知量按 $\\boldsymbol{u} = (u_{1,1}, u_{2,1}, u_{1,2}, u_{2,2})^{\\top}$ 顺序排列。问题要求对 $\\boldsymbol{x} = (1, 0, -1, 0)^{\\top}$ 计算 $\\boldsymbol{x}^{\\top} A \\boldsymbol{x}$。该计算展开为：\n$$\\boldsymbol{x}^{\\top} A \\boldsymbol{x} = \\begin{pmatrix} 1  0  -1  0 \\end{pmatrix} A \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix} = A_{11} - A_{13} - A_{31} + A_{33}$$\n我们只需要计算矩阵 $A$ 的这四个元素。\n\n- $A_{11}$（在 $(1,1)$ 处的对角元）：\n  面位于 E($x=1.5$)、W($x=0.5$)、N($y=1.5$, $x=1$)、S($y=0.5$, $x=1$)。\n  $A_{11} = k_{11}(1.5) + k_{11}(0.5) + k_{22}(1) + k_{22}(1) = \\frac{102+49\\sqrt{2}}{4} + \\frac{102+49\\sqrt{2}}{4} + 1 + 1 = \\frac{102+49\\sqrt{2}}{2} + 2 = \\frac{106+49\\sqrt{2}}{2}$。\n\n- $A_{33}$（在 $(1,2)$ 处的对角元）：\n  面位于 E($x=1.5$)、W($x=0.5$)、N($y=2.5$, $x=1$)、S($y=1.5$, $x=1$)。\n  由于问题的张量系数仅与 $x$ 相关，节点 $(1,2)$ 与节点 $(1,1)$ 共享相同的 $x$ 坐标，因此其对角元计算中使用的系数 $k_{11}$ 和 $k_{22}$ 与 $A_{11}$ 的相同。\n  $A_{33} = k_{11}(1.5) + k_{11}(0.5) + k_{22}(1) + k_{22}(1) = A_{11} = \\frac{106+49\\sqrt{2}}{2}$。\n\n- $A_{13}$（连接 $(1,1)$ 和 $(1,2)$ 的非对角元）：\n  这对应于节点 $(i,j)=(1,1)$ 的邻居 $u_{1,2} = u_{i,j+1}$。\n  $A_{13} = -(k_{22}^{\\mathrm{N}} + \\frac{k_{12}^{\\mathrm{E}} - k_{12}^{\\mathrm{W}}}{2}) = -(k_{22}(1) + \\frac{k_{12}(1.5) - k_{12}(0.5)}{2}) = -(1 + \\frac{49\\sqrt{2}/4 - (-49\\sqrt{2}/4)}{2}) = -(1 + \\frac{98\\sqrt{2}/4}{2}) = -(1 + \\frac{49\\sqrt{2}}{4})$。\n\n- $A_{31}$（连接 $(1,2)$ 和 $(1,1)$ 的非对角元）：\n  这对应于节点 $(i,j)=(1,2)$ 的邻居 $u_{1,1} = u_{i,j-1}$。\n  $A_{31} = -(k_{22}^{\\mathrm{S}} - \\frac{k_{12}^{\\mathrm{E}} - k_{12}^{\\mathrm{W}}}{2}) = -(k_{22}(1) - \\frac{k_{12}(1.5) - k_{12}(0.5)}{2}) = -(1 - \\frac{49\\sqrt{2}}{4}) = -1 + \\frac{49\\sqrt{2}}{4}$。\n\n有了这些矩阵元素，我们来处理第一个任务。\nM-矩阵必须具有非正的非对角元素。我们检查 $A_{31}$ 的符号：\n$A_{31} = \\frac{49\\sqrt{2}}{4} - 1$。由于 $\\sqrt{2} \\approx 1.414$，我们有 $\\frac{49\\sqrt{2}}{4} \\approx \\frac{49 \\times 1.414}{4} \\approx 17.3 > 1$。\n因此，$A_{31} > 0$。这个正的非对角元素表明，所得的刚度矩阵 $A$ 不是一个 M-矩阵。\n\n现在，我们进行第二个任务并计算二次型：\n$$\\boldsymbol{x}^{\\top} A \\boldsymbol{x} = A_{11} + A_{33} - (A_{13} + A_{31})$$\n首先，我们对对角项求和：\n$$A_{11} + A_{33} = 2 \\times \\left(\\frac{106+49\\sqrt{2}}{2}\\right) = 106 + 49\\sqrt{2}$$\n接下来，我们对非对角项求和：\n$$A_{13} + A_{31} = -\\left(1 + \\frac{49\\sqrt{2}}{4}\\right) + \\left(-1 + \\frac{49\\sqrt{2}}{4}\\right) = -1 - \\frac{49\\sqrt{2}}{4} - 1 + \\frac{49\\sqrt{2}}{4} = -2$$\n最后，我们计算二次型：\n$$\\boldsymbol{x}^{\\top} A \\boldsymbol{x} = (106 + 49\\sqrt{2}) - (-2) = 106 + 49\\sqrt{2} + 2 = 108 + 49\\sqrt{2}$$\n这就是最终的精确解析表达式。",
            "answer": "$$\\boxed{108 + 49\\sqrt{2}}$$"
        }
    ]
}