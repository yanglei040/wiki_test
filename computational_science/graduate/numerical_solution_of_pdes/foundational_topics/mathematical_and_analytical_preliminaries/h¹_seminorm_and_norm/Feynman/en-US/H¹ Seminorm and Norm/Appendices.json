{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a direct, hands-on opportunity to apply the definition of the $H^1$ norm to a concrete function used in the Finite Element Method (FEM). By calculating the norm of a continuous, piecewise affine function on a simple mesh from first principles, you will solidify your understanding of how the global norm is assembled from local contributions on each element. This practice is fundamental for demystifying the abstract nature of Sobolev spaces and grounding it in tangible computation. ",
            "id": "3402645",
            "problem": "Consider the union of two non-overlapping triangles $\\Omega = K_1 \\cup K_2 \\subset \\mathbb{R}^2$ forming a conforming mesh $\\mathcal{T}_h$ for the Finite Element Method (FEM) used to numerically solve partial differential equations (PDEs):\n- $K_1 = \\operatorname{conv}\\{(0,0),(2,0),(0,1)\\}$,\n- $K_2 = \\operatorname{conv}\\{(2,0),(2,2),(0,1)\\}$.\n\nLet $V_h$ be the space of continuous, piecewise affine (linear) functions over $\\mathcal{T}_h$. Define $u_h \\in V_h$ by its nodal values at the mesh vertices:\n- $u_h(0,0) = 0$,\n- $u_h(2,0) = 2$,\n- $u_h(0,1) = 1$,\n- $u_h(2,2) = 3$.\n\nUsing only first principles, namely the definition of the Sobolev space $H^1(\\Omega)$ and the standard properties of affine reference-to-physical mappings on simplices, compute the exact value of the $H^1$-norm of $u_h$ on $\\Omega$,\n$$\n\\|u_h\\|_{H^1(\\Omega)} \\quad \\text{with} \\quad \\|u_h\\|_{H^1(\\Omega)}^2 = \\int_{\\Omega} \\big(u_h(x)\\big)^2 \\,\\mathrm{d}x \\;+\\; \\int_{\\Omega} \\|\\nabla u_h(x)\\|_2^2 \\,\\mathrm{d}x.\n$$\nExpress your final answer as a single exact closed-form expression. Do not round.",
            "solution": "The problem statement is well-posed, scientifically grounded, and objective. It is a standard exercise in the numerical analysis of partial differential equations, specifically within the finite element method. The data provided are complete and consistent, defining a unique continuous piecewise affine function on a conforming mesh. The task is to compute a standard Sobolev norm, which is a well-defined mathematical operation. Therefore, the problem is valid and a solution can be derived.\n\nThe squared $H^1$-norm of the function $u_h$ on the domain $\\Omega$ is defined by the problem as:\n$$\n\\|u_h\\|_{H^1(\\Omega)}^2 = \\int_{\\Omega} \\big(u_h(x)\\big)^2 \\,\\mathrm{d}x \\;+\\; \\int_{\\Omega} \\|\\nabla u_h(x)\\|_2^2 \\,\\mathrm{d}x\n$$\nSince the domain $\\Omega$ is the union of two non-overlapping triangles, $\\Omega = K_1 \\cup K_2$, we can decompose the total norm into contributions from each triangle:\n$$\n\\|u_h\\|_{H^1(\\Omega)}^2 = \\left( \\int_{K_1} u_h^2 \\,d\\mathbf{x} + \\int_{K_2} u_h^2 \\,d\\mathbf{x} \\right) + \\left( \\int_{K_1} \\|\\nabla u_h\\|_2^2 \\,d\\mathbf{x} + \\int_{K_2} \\|\\nabla u_h\\|_2^2 \\,d\\mathbf{x} \\right)\n$$\nwhere $\\mathbf{x}=(x,y)$. The function $u_h$ is affine on each triangle, so its gradient $\\nabla u_h$ is a constant vector field on each triangle.\n\nFirst, we analyze the contribution from triangle $K_1 = \\operatorname{conv}\\{(0,0),(2,0),(0,1)\\}$.\nThe vertices of $K_1$ are $V_1=(0,0)$, $V_2=(2,0)$, and $V_3=(0,1)$. The nodal values of $u_h$ at these vertices are $u_h(V_1)=0$, $u_h(V_2)=2$, and $u_h(V_3)=1$. Let the restriction of $u_h$ to $K_1$ be denoted by $u_1(x,y)=ax+by+c$. We can determine the coefficients $a$, $b$, and $c$ by enforcing the nodal value conditions:\n$u_1(0,0) = a(0) + b(0) + c = 0 \\implies c=0$.\n$u_1(2,0) = a(2) + b(0) + c = 2 \\implies 2a=2 \\implies a=1$.\n$u_1(0,1) = a(0) + b(1) + c = 1 \\implies b=1$.\nSo, on $K_1$, the function is $u_1(x,y) = x+y$.\nThe gradient of $u_1$ is the constant vector $\\nabla u_1 = (1,1)$. The squared Euclidean norm of this gradient is $\\|\\nabla u_1\\|_2^2 = 1^2 + 1^2 = 2$.\nThe area of $K_1$ is $|K_1| = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times 2 \\times 1 = 1$.\nThe integral of the squared gradient over $K_1$ is therefore:\n$$\n\\int_{K_1} \\|\\nabla u_1\\|_2^2 \\,d\\mathbf{x} = \\int_{K_1} 2 \\,d\\mathbf{x} = 2 |K_1| = 2(1) = 2.\n$$\nTo compute the integral of $u_1^2$, we use the exact quadrature formula for the square of an affine function $p$ on a triangle $T$ with nodal values $p_1, p_2, p_3$:\n$$\n\\int_T p^2 \\,d\\mathbf{x} = \\frac{|T|}{6} (p_1^2 + p_2^2 + p_3^2 + p_1p_2 + p_1p_3 + p_2p_3).\n$$\nFor $u_1$ on $K_1$, with nodal values $0$, $2$, $1$ and area $|K_1|=1$:\n$$\n\\int_{K_1} u_1^2 \\,d\\mathbf{x} = \\frac{1}{6} \\left(0^2+2^2+1^2 + (0)(2) + (0)(1) + (2)(1)\\right) = \\frac{1}{6} (0+4+1+0+0+2) = \\frac{7}{6}.\n$$\n\nNext, we analyze the contribution from triangle $K_2 = \\operatorname{conv}\\{(2,0),(2,2),(0,1)\\}$.\nThe vertices of $K_2$ are $V_2=(2,0)$, $V_4=(2,2)$, and $V_3=(0,1)$. The nodal values are $u_h(V_2)=2$, $u_h(V_4)=3$, and $u_h(V_3)=1$. Let the restriction of $u_h$ to $K_2$ be $u_2(x,y)=dx+ey+f$. We solve for the coefficients:\n$u_2(0,1) = d(0)+e(1)+f = 1 \\implies e+f=1$.\n$u_2(2,0) = d(2)+e(0)+f = 2 \\implies 2d+f=2$.\n$u_2(2,2) = d(2)+e(2)+f = 3 \\implies 2d+2e+f=3$.\nSubtracting the second equation from the third gives $2e = 1$, so $e=1/2$. Substituting this into the first equation yields $f=1-e=1-1/2=1/2$. Finally, substituting $f$ into the second equation gives $2d = 2-f = 2-1/2 = 3/2$, so $d=3/4$.\nThus, on $K_2$, the function is $u_2(x,y) = \\frac{3}{4}x+\\frac{1}{2}y+\\frac{1}{2}$.\nThe gradient of $u_2$ is the constant vector $\\nabla u_2 = (3/4, 1/2)$. The squared norm is $\\|\\nabla u_2\\|_2^2 = (3/4)^2+(1/2)^2 = 9/16+4/16 = 13/16$.\nThe area of $K_2$ can be computed using the shoelace formula with vertices $(2,0)$, $(2,2)$, $(0,1)$:\n$|K_2| = \\frac{1}{2} |(2 \\cdot 2 - 0 \\cdot 2) + (2 \\cdot 1 - 2 \\cdot 0) + (0 \\cdot 0 - 1 \\cdot 2)| = \\frac{1}{2} |4+2-2| = 2$.\nThe integral of the squared gradient over $K_2$ is:\n$$\n\\int_{K_2} \\|\\nabla u_2\\|_2^2 \\,d\\mathbf{x} = \\int_{K_2} \\frac{13}{16} \\,d\\mathbf{x} = \\frac{13}{16} |K_2| = \\frac{13}{16}(2) = \\frac{13}{8}.\n$$\nFor the $L^2$-term on $K_2$, with nodal values $2$, $3$, $1$ and area $|K_2|=2$:\n$$\n\\int_{K_2} u_2^2 \\,d\\mathbf{x} = \\frac{2}{6} \\left(2^2+3^2+1^2 + (2)(3) + (2)(1) + (3)(1)\\right) = \\frac{1}{3} (4+9+1+6+2+3) = \\frac{25}{3}.\n$$\n\nFinally, we sum the four components to find the total squared $H^1$-norm:\n$$\n\\|u_h\\|_{H^1(\\Omega)}^2 = \\int_{K_1} u_h^2 \\,d\\mathbf{x} + \\int_{K_2} u_h^2 \\,d\\mathbf{x} + \\int_{K_1} \\|\\nabla u_h\\|_2^2 \\,d\\mathbf{x} + \\int_{K_2} \\|\\nabla u_h\\|_2^2 \\,d\\mathbf{x}\n$$\n$$\n\\|u_h\\|_{H^1(\\Omega)}^2 = \\frac{7}{6} + \\frac{25}{3} + 2 + \\frac{13}{8}\n$$\nCombining the $L^2$ and seminorm terms separately:\n$$\n\\|u_h\\|_{L^2(\\Omega)}^2 = \\frac{7}{6} + \\frac{50}{6} = \\frac{57}{6} = \\frac{19}{2}.\n$$\n$$\n|u_h|_{H^1(\\Omega)}^2 = 2 + \\frac{13}{8} = \\frac{16}{8} + \\frac{13}{8} = \\frac{29}{8}.\n$$\nThe total sum is:\n$$\n\\|u_h\\|_{H^1(\\Omega)}^2 = \\frac{19}{2} + \\frac{29}{8} = \\frac{76}{8} + \\frac{29}{8} = \\frac{105}{8}.\n$$\nThe problem asks for the $H^1$-norm, which is the square root of this value:\n$$\n\\|u_h\\|_{H^1(\\Omega)} = \\sqrt{\\frac{105}{8}} = \\sqrt{\\frac{105 \\times 2}{16}} = \\frac{\\sqrt{210}}{4}.\n$$\nThe number $210$ has prime factorization $2 \\times 3 \\times 5 \\times 7$, so it contains no square factors, and the radical is in its simplest form.",
            "answer": "$$\\boxed{\\frac{\\sqrt{210}}{4}}$$"
        },
        {
            "introduction": "In the analysis of numerical methods like FEM, it is standard practice to perform calculations on a simple, fixed reference element and then map the results to the physical elements of the mesh. This exercise guides you through the essential mechanics of this process, exploring how the $H^1$ norm transforms under an affine mapping. Mastering this relationship is crucial for deriving error estimates and understanding how the accuracy of a numerical solution depends on the size and shape of the mesh elements. ",
            "id": "3402638",
            "problem": "Consider the context of numerical solution of Partial Differential Equations (PDEs), where functions defined on a physical element are often pulled back to a reference element to analyze stability and error under mesh scaling. Let the reference domain be $\\widehat{\\Omega} = (0,1)^{2}$ and the physical domain be $\\Omega_{h} = (0,h_{x}) \\times (0,h_{y})$, obtained from the affine map $T_{h} : \\widehat{\\Omega} \\to \\Omega_{h}$ given by $x = A \\xi$, where $A = \\mathrm{diag}(h_{x}, h_{y})$ and $\\xi = (\\xi_{1}, \\xi_{2})^{\\top}$. Define the reference function $\\widehat{u} : \\widehat{\\Omega} \\to \\mathbb{R}$ by $\\widehat{u}(\\xi) = \\xi_{1}^{2} + \\xi_{2}^{3}$, and define the physical function $u : \\Omega_{h} \\to \\mathbb{R}$ by $u(x) = \\widehat{u}(A^{-1} x)$, so that $u$ is the pullback of $\\widehat{u}$ under $T_{h}$.\n\nStarting from the core definitions of the $L^{2}$ norm, the $H^{1}$ seminorm, and the $H^{1}$ norm,\n$$\\|u\\|_{L^{2}(\\Omega)}^{2} = \\int_{\\Omega} |u(x)|^{2} \\, dx, \\quad |u|_{H^{1}(\\Omega)}^{2} = \\int_{\\Omega} |\\nabla u(x)|^{2} \\, dx, \\quad \\|u\\|_{H^{1}(\\Omega)}^{2} = \\|u\\|_{L^{2}(\\Omega)}^{2} + |u|_{H^{1}(\\Omega)}^{2},$$\nand using only foundational tools such as the chain rule and change of variables, derive and compute, in closed form, the exact analytical expression for the squared $H^{1}$ norm $\\|u\\|_{H^{1}(\\Omega_{h})}^{2}$ as a function of $h_{x}$ and $h_{y}$.\n\nYour final answer must be a single closed-form expression in $h_{x}$ and $h_{y}$. No rounding is required.",
            "solution": "The problem requires the computation of the squared $H^{1}$ norm of a function $u$ defined on a physical domain $\\Omega_{h}$, where $u$ is related to a function $\\widehat{u}$ on a reference domain $\\widehat{\\Omega}$ via an affine transformation. The squared $H^{1}$ norm is defined as the sum of the squared $L^{2}$ norm and the squared $H^{1}$ seminorm:\n$$\n\\|u\\|_{H^{1}(\\Omega_{h})}^{2} = \\|u\\|_{L^{2}(\\Omega_{h})}^{2} + |u|_{H^{1}(\\Omega_{h})}^{2}\n$$\nWe will compute each term on the right-hand side separately by transforming the integrals from the physical domain $\\Omega_{h} = (0,h_{x}) \\times (0,h_{y})$ to the reference domain $\\widehat{\\Omega} = (0,1)^{2}$.\n\nThe transformation is given by $x = T_{h}(\\xi) = A\\xi$, where $x = (x_{1}, x_{2})^{\\top}$, $\\xi = (\\xi_{1}, \\xi_{2})^{\\top}$, and $A = \\mathrm{diag}(h_{x}, h_{y})$. The Jacobian matrix of this transformation is $J = \\frac{\\partial x}{\\partial \\xi} = A$. The determinant of the Jacobian is $\\det(J) = h_{x}h_{y}$. For a change of variables in an integral, we use the absolute value of the determinant, so the differential area element transforms as $dx = |\\det(J)| \\, d\\xi = h_{x}h_{y} \\, d\\xi$, assuming $h_{x}  0$ and $h_{y}  0$ as they represent physical dimensions. The function $u$ on the physical domain is related to the function $\\widehat{u}$ on the reference domain by $u(x) = \\widehat{u}(A^{-1}x)$, which is equivalent to $u(T_h(\\xi)) = \\widehat{u}(\\xi)$.\n\nFirst, we compute the squared $L^{2}$ norm, $\\|u\\|_{L^{2}(\\Omega_{h})}^{2}$.\nBy definition, $\\|u\\|_{L^{2}(\\Omega_{h})}^{2} = \\int_{\\Omega_{h}} |u(x)|^{2} \\, dx$.\nApplying the change of variables $x = A\\xi$:\n$$\n\\|u\\|_{L^{2}(\\Omega_{h})}^{2} = \\int_{\\widehat{\\Omega}} |u(A\\xi)|^{2} |\\det(J)| \\, d\\xi = \\int_{\\widehat{\\Omega}} |\\widehat{u}(\\xi)|^{2} (h_{x}h_{y}) \\, d\\xi\n$$\nGiven $\\widehat{u}(\\xi) = \\xi_{1}^{2} + \\xi_{2}^{3}$, we have $|\\widehat{u}(\\xi)|^{2} = (\\xi_{1}^{2} + \\xi_{2}^{3})^{2} = \\xi_{1}^{4} + 2\\xi_{1}^{2}\\xi_{2}^{3} + \\xi_{2}^{6}$.\nThe integral becomes:\n$$\n\\|u\\|_{L^{2}(\\Omega_{h})}^{2} = h_{x}h_{y} \\int_{0}^{1} \\int_{0}^{1} (\\xi_{1}^{4} + 2\\xi_{1}^{2}\\xi_{2}^{3} + \\xi_{2}^{6}) \\, d\\xi_{1} \\, d\\xi_{2}\n$$\nWe integrate with respect to $\\xi_{1}$ first:\n$$\n\\int_{0}^{1} (\\xi_{1}^{4} + 2\\xi_{1}^{2}\\xi_{2}^{3} + \\xi_{2}^{6}) \\, d\\xi_{1} = \\left[ \\frac{\\xi_{1}^{5}}{5} + \\frac{2\\xi_{1}^{3}}{3}\\xi_{2}^{3} + \\xi_{1}\\xi_{2}^{6} \\right]_{\\xi_{1}=0}^{1} = \\frac{1}{5} + \\frac{2}{3}\\xi_{2}^{3} + \\xi_{2}^{6}\n$$\nNow we integrate the result with respect to $\\xi_{2}$:\n$$\n\\int_{0}^{1} \\left(\\frac{1}{5} + \\frac{2}{3}\\xi_{2}^{3} + \\xi_{2}^{6}\\right) \\, d\\xi_{2} = \\left[ \\frac{1}{5}\\xi_{2} + \\frac{2}{3}\\frac{\\xi_{2}^{4}}{4} + \\frac{\\xi_{2}^{7}}{7} \\right]_{0}^{1} = \\frac{1}{5} + \\frac{1}{6} + \\frac{1}{7}\n$$\nTo sum the fractions, we find a common denominator of $210$:\n$$\n\\frac{1}{5} + \\frac{1}{6} + \\frac{1}{7} = \\frac{42}{210} + \\frac{35}{210} + \\frac{30}{210} = \\frac{107}{210}\n$$\nThus, the squared $L^{2}$ norm is:\n$$\n\\|u\\|_{L^{2}(\\Omega_{h})}^{2} = \\frac{107}{210}h_{x}h_{y}\n$$\n\nNext, we compute the squared $H^{1}$ seminorm, $|u|_{H^{1}(\\Omega_{h})}^{2}$.\nBy definition, $|u|_{H^{1}(\\Omega_{h})}^{2} = \\int_{\\Omega_{h}} |\\nabla_{x} u(x)|^{2} \\, dx$, where $\\nabla_{x}$ is the gradient with respect to the physical coordinates $x = (x_{1}, x_{2})^{\\top}$.\nWe must relate the physical gradient $\\nabla_{x} u$ to the reference gradient $\\nabla_{\\xi} \\widehat{u}$. Using the chain rule, we have $\\nabla_{\\xi} \\widehat{u} = J^{\\top} \\nabla_{x} u$. Therefore, $\\nabla_{x} u = (J^{\\top})^{-1} \\nabla_{\\xi} \\widehat{u}$.\nSince $J = A = \\mathrm{diag}(h_{x}, h_{y})$, $J$ is symmetric, so $J^{\\top} = J = A$. The inverse is $A^{-1} = \\mathrm{diag}(h_{x}^{-1}, h_{y}^{-1})$.\nSo, $\\nabla_{x} u = A^{-1} \\nabla_{\\xi} \\widehat{u}$.\nThe reference gradient is $\\nabla_{\\xi} \\widehat{u} = \\left(\\frac{\\partial \\widehat{u}}{\\partial \\xi_{1}}, \\frac{\\partial \\widehat{u}}{\\partial \\xi_{2}}\\right)^{\\top} = (2\\xi_{1}, 3\\xi_{2}^{2})^{\\top}$.\nThe physical gradient is then:\n$$\n\\nabla_{x} u = \\begin{pmatrix} h_{x}^{-1}  0 \\\\ 0  h_{y}^{-1} \\end{pmatrix} \\begin{pmatrix} 2\\xi_{1} \\\\ 3\\xi_{2}^{2} \\end{pmatrix} = \\begin{pmatrix} 2h_{x}^{-1}\\xi_{1} \\\\ 3h_{y}^{-1}\\xi_{2}^{2} \\end{pmatrix}\n$$\nThe squared magnitude of the physical gradient is:\n$$\n|\\nabla_{x} u|^{2} = (2h_{x}^{-1}\\xi_{1})^{2} + (3h_{y}^{-1}\\xi_{2}^{2})^{2} = 4h_{x}^{-2}\\xi_{1}^{2} + 9h_{y}^{-2}\\xi_{2}^{4}\n$$\nNow we can set up the integral for the seminorm, changing variables to the reference domain:\n$$\n|u|_{H^{1}(\\Omega_{h})}^{2} = \\int_{\\widehat{\\Omega}} \\left(4h_{x}^{-2}\\xi_{1}^{2} + 9h_{y}^{-2}\\xi_{2}^{4}\\right) |\\det(J)| \\, d\\xi = h_{x}h_{y} \\int_{0}^{1} \\int_{0}^{1} \\left(4h_{x}^{-2}\\xi_{1}^{2} + 9h_{y}^{-2}\\xi_{2}^{4}\\right) \\, d\\xi_{1} \\, d\\xi_{2}\n$$\nWe can separate this into two integrals:\n$$\n|u|_{H^{1}(\\Omega_{h})}^{2} = h_{x}h_{y} \\left( \\int_{0}^{1} \\int_{0}^{1} 4h_{x}^{-2}\\xi_{1}^{2} \\, d\\xi_{1} \\, d\\xi_{2} + \\int_{0}^{1} \\int_{0}^{1} 9h_{y}^{-2}\\xi_{2}^{4} \\, d\\xi_{1} \\, d\\xi_{2} \\right)\n$$\nThe first integral is:\n$$\n\\int_{0}^{1} \\int_{0}^{1} 4h_{x}^{-2}\\xi_{1}^{2} \\, d\\xi_{1} \\, d\\xi_{2} = 4h_{x}^{-2} \\left(\\int_{0}^{1}\\,d\\xi_2\\right) \\left(\\int_{0}^{1} \\xi_{1}^{2} \\, d\\xi_{1}\\right) = 4h_{x}^{-2} (1) \\left[\\frac{\\xi_{1}^{3}}{3}\\right]_{0}^{1} = \\frac{4}{3}h_{x}^{-2}\n$$\nThe second integral is:\n$$\n\\int_{0}^{1} \\int_{0}^{1} 9h_{y}^{-2}\\xi_{2}^{4} \\, d\\xi_{1} \\, d\\xi_{2} = 9h_{y}^{-2} \\left(\\int_{0}^{1}\\,d\\xi_1\\right) \\left(\\int_{0}^{1} \\xi_{2}^{4} \\, d\\xi_{2}\\right) = 9h_{y}^{-2} (1) \\left[\\frac{\\xi_{2}^{5}}{5}\\right]_{0}^{1} = \\frac{9}{5}h_{y}^{-2}\n$$\nSubstituting these back into the expression for the seminorm:\n$$\n|u|_{H^{1}(\\Omega_{h})}^{2} = h_{x}h_{y} \\left( \\frac{4}{3}h_{x}^{-2} + \\frac{9}{5}h_{y}^{-2} \\right) = \\frac{4}{3}h_{x}^{-1}h_{y} + \\frac{9}{5}h_{x}h_{y}^{-1} = \\frac{4}{3}\\frac{h_{y}}{h_{x}} + \\frac{9}{5}\\frac{h_{x}}{h_{y}}\n$$\n\nFinally, we sum the two components to obtain the squared $H^{1}$ norm:\n$$\n\\|u\\|_{H^{1}(\\Omega_{h})}^{2} = \\|u\\|_{L^{2}(\\Omega_{h})}^{2} + |u|_{H^{1}(\\Omega_{h})}^{2} = \\frac{107}{210}h_{x}h_{y} + \\frac{4}{3}\\frac{h_{y}}{h_{x}} + \\frac{9}{5}\\frac{h_{x}}{h_{y}}\n$$\nThis is the final analytical expression for the squared $H^{1}$ norm of $u$ on $\\Omega_{h}$ as a function of $h_{x}$ and $h_{y}$.",
            "answer": "$$\n\\boxed{\\frac{107}{210}h_{x}h_{y} + \\frac{4}{3}\\frac{h_{y}}{h_{x}} + \\frac{9}{5}\\frac{h_{x}}{h_{y}}}\n$$"
        },
        {
            "introduction": "While analytical calculations are invaluable for understanding, real-world applications of the Finite Element Method rely on numerical quadrature to approximate the integrals that define Sobolev norms. This programming exercise bridges the gap between theory and practice by having you implement a numerical integration scheme to compute the $H^1$ seminorm and norm for various functions. By comparing your numerical results to exact analytical values or high-accuracy reference solutions, you will gain practical experience in verifying computational code and appreciating the accuracy of methods like Gauss–Legendre quadrature. ",
            "id": "3402666",
            "problem": "Given the Sobolev space $H^{1}(\\Omega)$ on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{d}$, the $H^{1}$ seminorm and norm of a sufficiently smooth function $u$ are defined in terms of Lebesgue integrals by\n$$\n|u|_{H^{1}(\\Omega)} = \\left( \\int_{\\Omega} \\|\\nabla u(\\mathbf{x})\\|^{2} \\, \\mathrm{d}\\mathbf{x} \\right)^{1/2}, \\quad \\|u\\|_{H^{1}(\\Omega)} = \\left( \\int_{\\Omega} |u(\\mathbf{x})|^{2} \\, \\mathrm{d}\\mathbf{x} + \\int_{\\Omega} \\|\\nabla u(\\mathbf{x})\\|^{2} \\, \\mathrm{d}\\mathbf{x} \\right)^{1/2}.\n$$\nIn the numerical solution of partial differential equations (PDEs), practical evaluation of these integrals requires numerical quadrature. Consider the tensor-product Gauss–Legendre quadrature on a uniform partition of the unit square domain $\\Omega = [0,1]^{2}$ into $N \\times N$ congruent rectangles. On each cell $K = [x_{i},x_{i+1}] \\times [y_{j},y_{j+1}]$ with $x_{i+1}-x_{i} = h_{x}$ and $y_{j+1}-y_{j} = h_{y}$, the integral of a function $f$ is approximated by mapping the $q$-point Gauss–Legendre nodes and weights $\\{(\\xi_{a},w_{a})\\}_{a=1}^{q}$ on $[-1,1]$ to $K$ via the affine map $\\Phi(\\xi,\\eta) = (x_{i} + \\tfrac{h_{x}}{2}(\\xi+1),\\, y_{j} + \\tfrac{h_{y}}{2}(\\eta+1))$ and then summing\n$$\n\\int_{K} f(x,y)\\,\\mathrm{d}x\\,\\mathrm{d}y \\approx \\frac{h_{x} h_{y}}{4} \\sum_{a=1}^{q} \\sum_{b=1}^{q} w_{a} w_{b} \\, f\\!\\left( \\Phi(\\xi_{a},\\eta_{b}) \\right).\n$$\n\nTask: Implement a complete program that, starting from these definitions and the quadrature principle above, computes numerical approximations of the $H^{1}$ seminorm and norm of specific test functions on $\\Omega = [0,1]^{2}$ and reports errors against trusted values.\n\nUse the following test suite of functions $u:\\Omega \\to \\mathbb{R}$, with gradients $\\nabla u$ defined in the classical sense:\n- Case $\\mathbf{1}$ (smooth trigonometric): $u_{1}(x,y) = \\sin(\\pi x)\\sin(\\pi y)$.\n- Case $\\mathbf{2}$ (polynomial bubble): $u_{2}(x,y) = x(1-x)y(1-y)$.\n- Case $\\mathbf{3}$ (zero function): $u_{3}(x,y) \\equiv 0$.\n- Case $\\mathbf{4}$ (smooth exponential ridge): $u_{4}(x,y) = \\exp(\\alpha x y)$ with parameter $\\alpha = 7$.\n\nNumerical specification:\n- Use a uniform $N \\times N$ partition with $N = 12$ and a tensor-product Gauss–Legendre rule of order $q = 5$ to produce the primary approximations for both $|u|_{H^{1}(\\Omega)}$ and $\\|u\\|_{H^{1}(\\Omega)}$.\n- For error assessment, proceed as follows:\n  - For Cases $\\mathbf{1}$ and $\\mathbf{2}$, the exact values are analytically computable by separability and polynomial integration; the program must internally obtain trusted values using mathematically justified means starting only from the given definitions (analytical evaluation is permitted for these two cases).\n  - For Case $\\mathbf{3}$, the exact values are $0$ for both the $H^{1}$ seminorm and the $H^{1}$ norm.\n  - For Case $\\mathbf{4}$, where a closed-form primitive in elementary functions for the required integrals is not available, obtain a high-accuracy reference by a much finer quadrature: use $N_{\\mathrm{ref}} = 48$ and $q_{\\mathrm{ref}} = 8$ with the same tensor-product Gauss–Legendre approach to generate the trusted values.\n\nError reporting:\n- For each case with a nonzero trusted value, output the relative error defined by $E_{\\mathrm{rel}} = \\dfrac{|\\text{approx} - \\text{trusted}|}{\\text{trusted}}$ for both the seminorm and the norm.\n- For Case $\\mathbf{3}$, where the trusted values are zero, output the absolute approximations themselves for both the seminorm and the norm (i.e., use $E_{\\mathrm{abs}} = |\\text{approx}|$).\n- Assemble all eight results in the following fixed order:\n  $[E_{1}^{\\mathrm{semi}}, E_{1}^{\\mathrm{norm}}, E_{2}^{\\mathrm{semi}}, E_{2}^{\\mathrm{norm}}, E_{3}^{\\mathrm{semi}}, E_{3}^{\\mathrm{norm}}, E_{4}^{\\mathrm{semi}}, E_{4}^{\\mathrm{norm}}]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- Each floating-point value must be printed in scientific notation with exactly $10$ significant digits (that is, $1$ digit before the decimal point and $9$ digits after), e.g., $1.234567890\\mathrm{e}{-04}$.\n- No other text should be printed.\n\nAngle units are not applicable. Physical units do not apply. All computations occur on the unit square $\\Omega = [0,1]^{2}$ without additional scaling.",
            "solution": "The problem is well-posed and grounded in the principles of functional analysis and numerical methods for partial differential equations. It provides a complete and consistent set of specifications for computing approximations of the $H^{1}$ seminorm and norm for four distinct functions on the unit square, and for evaluating the accuracy of these approximations. The problem is therefore valid. We now proceed with a detailed solution.\n\nThe objective is to compute numerical approximations of the $H^{1}$ seminorm and norm for a function $u$ defined on the domain $\\Omega = [0,1]^{2}$. The definitions are provided as:\n$$|u|_{H^{1}(\\Omega)} = \\left( \\int_{\\Omega} \\|\\nabla u(\\mathbf{x})\\|^{2} \\, \\mathrm{d}\\mathbf{x} \\right)^{1/2}$$\n$$\\|u\\|_{H^{1}(\\Omega)} = \\left( \\int_{\\Omega} |u(\\mathbf{x})|^{2} \\, \\mathrm{d}\\mathbf{x} + \\int_{\\Omega} \\|\\nabla u(\\mathbf{x})\\|^{2} \\, \\mathrm{d}\\mathbf{x} \\right)^{1/2} = \\left( \\|u\\|_{L^2(\\Omega)}^2 + |u|_{H^{1}(\\Omega)}^2 \\right)^{1/2}$$\nHere, $\\nabla u$ is the gradient of $u$, and $\\|\\cdot\\|$ denotes the Euclidean norm for vectors. The core of the task is to evaluate the two integrals, $\\int_{\\Omega} |u|^{2} \\, \\mathrm{d}\\mathbf{x}$ and $\\int_{\\Omega} \\|\\nabla u\\|^{2} \\, \\mathrm{d}\\mathbf{x}$, using numerical quadrature.\n\nThe domain $\\Omega = [0,1]^2$ is partitioned into a uniform grid of $N \\times N$ rectangular cells. For $N=12$, each cell $K_{ij} = [x_i, x_{i+1}] \\times [y_j, y_{j+1}]$ for $i,j \\in \\{0, \\dots, N-1\\}$ has dimensions $h_x = h_y = h = 1/N = 1/12$. The integral over $\\Omega$ is the sum of integrals over each cell $K_{ij}$:\n$$\\int_{\\Omega} f(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x} = \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\int_{K_{ij}} f(x,y) \\, \\mathrm{d}x\\mathrm{d}y$$\n\nThe integral over a single cell $K$ is approximated using a $q$-point tensor-product Gauss-Legendre quadrature rule. This involves an affine change of variables from the reference square $[-1,1]^2$ to the cell $K = [x_i, x_{i+1}] \\times [y_j, y_{j+1}]$. The map is given by $\\mathbf{x} = \\Phi(\\boldsymbol{\\xi})$, where $\\mathbf{x}=(x,y)$ and $\\boldsymbol{\\xi}=(\\xi, \\eta)$:\n$$x = x_i + \\frac{h_x}{2}(\\xi+1), \\quad y = y_j + \\frac{h_y}{2}(\\eta+1)$$\nThe differential area element transforms as $\\mathrm{d}x\\mathrm{d}y = \\det(D\\Phi) \\, \\mathrm{d}\\xi\\mathrm{d}\\eta$, where the Jacobian determinant is $\\det(D\\Phi) = \\frac{h_x}{2} \\cdot \\frac{h_y}{2} = \\frac{h_x h_y}{4}$. The integral over $K$ is then approximated as:\n$$\\int_{K} f(x,y) \\, \\mathrm{d}x\\mathrm{d}y = \\int_{-1}^{1}\\int_{-1}^{1} f(\\Phi(\\xi,\\eta)) \\frac{h_x h_y}{4} \\, \\mathrm{d}\\xi\\mathrm{d}\\eta \\approx \\frac{h_x h_y}{4} \\sum_{a=1}^{q} \\sum_{b=1}^{q} w_a w_b f(\\Phi(\\xi_a, \\xi_b))$$\nwhere $\\{(\\xi_a, w_a)\\}_{a=1}^q$ are the $q$-point Gauss-Legendre nodes and weights on $[-1,1]$.\n\nThe overall algorithm is to implement a generic function that performs this two-dimensional quadrature for a given integrand $f$, grid division $N$, and quadrature order $q$. This function will be used to compute the required integrals for each test case.\n\nLet's denote the numerically computed integrals as $I_h(|u|^2)$ and $I_h(\\|\\nabla u\\|^2)$. The approximate seminorm and norm are then:\n$$|u|_{H^1, h} = \\sqrt{I_h(\\|\\nabla u\\|^2)}, \\quad \\|u\\|_{H^1, h} = \\sqrt{I_h(|u|^2) + I_h(\\|\\nabla u\\|^2)}$$\n\nWe will now analyze each case to determine the integrands, the trusted values, and the corresponding errors.\n\n**Case 1: $u_1(x,y) = \\sin(\\pi x)\\sin(\\pi y)$**\nThe gradient is $\\nabla u_1(x,y) = (\\pi\\cos(\\pi x)\\sin(\\pi y), \\pi\\sin(\\pi x)\\cos(\\pi y))$. The integrands are:\n$$|u_1|^2 = \\sin^2(\\pi x)\\sin^2(\\pi y)$$\n$$\\|\\nabla u_1\\|^2 = \\pi^2(\\cos^2(\\pi x)\\sin^2(\\pi y) + \\sin^2(\\pi x)\\cos^2(\\pi y))$$\nThe trusted values are obtained by analytical integration. Using the identities $\\int_0^1 \\sin^2(\\pi z) \\, \\mathrm{d}z = 1/2$ and $\\int_0^1 \\cos^2(\\pi z) \\, \\mathrm{d}z = 1/2$:\n$$\\int_{\\Omega} |u_1|^2 \\, \\mathrm{d}\\mathbf{x} = \\left(\\int_0^1 \\sin^2(\\pi x)\\mathrm{d}x\\right)\\left(\\int_0^1 \\sin^2(\\pi y)\\mathrm{d}y\\right) = \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}$$\n$$\\int_{\\Omega} \\|\\nabla u_1\\|^2 \\, \\mathrm{d}\\mathbf{x} = \\pi^2 \\left[ \\left(\\int_0^1 \\cos^2(\\pi x)\\mathrm{d}x\\right)\\left(\\int_0^1 \\sin^2(\\pi y)\\mathrm{d}y\\right) + \\left(\\int_0^1 \\sin^2(\\pi x)\\mathrm{d}x\\right)\\left(\\int_0^1 \\cos^2(\\pi y)\\mathrm{d}y\\right) \\right] = \\pi^2 \\left[ \\frac{1}{2}\\cdot\\frac{1}{2} + \\frac{1}{2}\\cdot\\frac{1}{2} \\right] = \\frac{\\pi^2}{2}$$\nSo, the trusted values are $|u_1|_{H^1} = \\sqrt{\\pi^2/2} = \\pi/\\sqrt{2}$ and $\\|u_1\\|_{H^1} = \\sqrt{1/4 + \\pi^2/2}$.\nThe numerical approximations are computed with $N=12, q=5$. The errors are relative: $E_{\\mathrm{rel}} = |\\text{approx} - \\text{trusted}|/\\text{trusted}$.\n\n**Case 2: $u_2(x,y) = x(1-x)y(1-y)$**\nThe gradient is $\\nabla u_2(x,y) = ((1-2x)y(1-y), x(1-x)(1-2y))$. The integrands are:\n$$|u_2|^2 = x^2(1-x)^2 y^2(1-y)^2$$\n$$\\|\\nabla u_2\\|^2 = (1-2x)^2 y^2(1-y)^2 + x^2(1-x)^2 (1-2y)^2$$\nTrusted values come from analytical integration. We need the definite integrals:\n$\\int_0^1 z^2(1-z)^2\\,\\mathrm{d}z = \\int_0^1 (z^2-2z^3+z^4)\\,\\mathrm{d}z = [z^3/3 - z^4/2 + z^5/5]_0^1 = 1/30$.\n$\\int_0^1 (1-2z)^2\\,\\mathrm{d}z = \\int_0^1 (1-4z+4z^2)\\,\\mathrm{d}z = [z - 2z^2 + 4z^3/3]_0^1 = 1/3$.\n$$\\int_{\\Omega} |u_2|^2\\,\\mathrm{d}\\mathbf{x} = \\left(\\int_0^1 x^2(1-x)^2\\mathrm{d}x\\right)\\left(\\int_0^1 y^2(1-y)^2\\mathrm{d}y\\right) = \\frac{1}{30} \\cdot \\frac{1}{30} = \\frac{1}{900}$$\n$$\\int_{\\Omega} \\|\\nabla u_2\\|^2\\,\\mathrm{d}\\mathbf{x} = \\left(\\int_0^1 (1-2x)^2\\mathrm{d}x\\right)\\left(\\int_0^1 y^2(1-y)^2\\mathrm{d}y\\right) + \\left(\\int_0^1 x^2(1-x)^2\\mathrm{d}x\\right)\\left(\\int_0^1 (1-2y)^2\\mathrm{d}y\\right) = \\frac{1}{3} \\cdot \\frac{1}{30} + \\frac{1}{30} \\cdot \\frac{1}{3} = \\frac{2}{90} = \\frac{1}{45}$$\nTrusted values: $|u_2|_{H^1} = \\sqrt{1/45}$ and $\\|u_2\\|_{H^1} = \\sqrt{1/900 + 1/45} = \\sqrt{21/900} = \\sqrt{21}/30$.\nThe numerical approximations use $N=12, q=5$, and errors are relative. Because $u_2$ is a polynomial of degree $4$ in each variable, the integrands $|u_2|^2$ and $\\|\\nabla u_2\\|^2$ are polynomials of degree up to $8$. A $q$-point Gauss rule is exact for polynomials of degree up to $2q-1$. With $q=5$, the rule is exact for polynomials of degree up to $9$, so we expect the numerical quadrature to yield results equal to the analytical values, up to machine precision.\n\n**Case 3: $u_3(x,y) = 0$**\nFor the zero function, $u_3=0$ and $\\nabla u_3=0$. Therefore, both integrands $|u_3|^2$ and $\\|\\nabla u_3\\|^2$ are identically zero. The exact integrals are $0$.\nThe trusted values are $|u_3|_{H^1}=0$ and $\\|u_3\\|_{H^1}=0$. The numerical integration of the zero function should yield a result of $0$ or a value on the order of floating-point epsilon.\nFor this zero-valued case, the error is absolute: $E_{\\text{abs}} = |\\text{approx}| = \\text{approx}$.\n\n**Case 4: $u_4(x,y) = \\exp(\\alpha x y)$ with $\\alpha=7$**\nThe gradient is $\\nabla u_4(x,y) = (\\alpha y \\exp(\\alpha x y), \\alpha x \\exp(\\alpha x y))$. The integrands are:\n$$|u_4|^2 = \\exp(2\\alpha x y)$$\n$$\\|\\nabla u_4\\|^2 = \\alpha^2(x^2+y^2)\\exp(2\\alpha x y)$$\nThese functions do not have elementary anti-derivatives. As instructed, trusted values are obtained via a high-accuracy numerical quadrature using $N_{\\mathrm{ref}}=48$ and $q_{\\mathrm{ref}}=8$. The primary approximations are computed with $N=12$ and $q=5$. The error is relative.\n\nThe implementation will construct a function to compute the 2D integrals, then apply it as described for each of the four cases, calculating and collecting the eight specified error metrics in order. The final results are presented in the required format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Computes H1 seminorm and norm approximations and errors for four test cases.\n    \"\"\"\n    \n    def integrate_2d(f, N, q_nodes, q_weights):\n        \"\"\"\n        Numerically integrates a function f over the unit square [0,1]^2.\n\n        Args:\n            f: The function to integrate, taking two arguments (x, y).\n            N: The number of grid cells in each direction.\n            q_nodes: 1D Gauss-Legendre quadrature nodes on [-1, 1].\n            q_weights: 1D Gauss-Legendre quadrature weights.\n\n        Returns:\n            The numerical approximation of the integral.\n        \"\"\"\n        h = 1.0 / N\n        q = len(q_nodes)\n        total_integral = 0.0\n\n        for i in range(N):\n            x_i = i * h\n            for j in range(N):\n                y_j = j * h\n                cell_integral = 0.0\n                for a in range(q):\n                    for b in range(q):\n                        xi_a, w_a = q_nodes[a], q_weights[a]\n                        xi_b, w_b = q_nodes[b], q_weights[b]\n                        \n                        # Affine mapping from reference square to cell K_ij\n                        x = x_i + (h / 2.0) * (xi_a + 1.0)\n                        y = y_j + (h / 2.0) * (xi_b + 1.0)\n                        \n                        cell_integral += w_a * w_b * f(x, y)\n                \n                # Add scaled cell integral to total\n                # The factor h*h/4 is the Jacobian determinant of the mapping\n                total_integral += (h * h / 4.0) * cell_integral\n                \n        return total_integral\n\n    results = []\n\n    # --- Case 1: u1(x,y) = sin(pi*x)*sin(pi*y) ---\n    u1_sq = lambda x, y: (np.sin(np.pi * x) * np.sin(np.pi * y))**2\n    grad_u1_norm_sq = lambda x, y: (np.pi**2) * ( (np.cos(np.pi * x) * np.sin(np.pi * y))**2 + (np.sin(np.pi * x) * np.cos(np.pi * y))**2 )\n    \n    # Analytical trusted values\n    trusted_I_u1_sq = 1.0 / 4.0\n    trusted_I_grad_u1_sq = np.pi**2 / 2.0\n    trusted_seminorm1 = np.sqrt(trusted_I_grad_u1_sq)\n    trusted_norm1 = np.sqrt(trusted_I_u1_sq + trusted_I_grad_u1_sq)\n    \n    # Numerical approximation\n    N, q = 12, 5\n    nodes_5, weights_5 = roots_legendre(q)\n    approx_I_u1_sq = integrate_2d(u1_sq, N, nodes_5, weights_5)\n    approx_I_grad_u1_sq = integrate_2d(grad_u1_norm_sq, N, nodes_5, weights_5)\n    approx_seminorm1 = np.sqrt(approx_I_grad_u1_sq)\n    approx_norm1 = np.sqrt(approx_I_u1_sq + approx_I_grad_u1_sq)\n\n    # Errors\n    err_seminorm1 = np.abs(approx_seminorm1 - trusted_seminorm1) / trusted_seminorm1\n    err_norm1 = np.abs(approx_norm1 - trusted_norm1) / trusted_norm1\n    results.extend([err_seminorm1, err_norm1])\n\n    # --- Case 2: u2(x,y) = x(1-x)y(1-y) ---\n    u2_sq = lambda x, y: (x * (1 - x) * y * (1 - y))**2\n    grad_u2_norm_sq = lambda x, y: ((1 - 2*x) * y * (1 - y))**2 + (x * (1 - x) * (1 - 2*y))**2\n\n    # Analytical trusted values\n    trusted_I_u2_sq = 1.0 / 900.0\n    trusted_I_grad_u2_sq = 1.0 / 45.0\n    trusted_seminorm2 = np.sqrt(trusted_I_grad_u2_sq)\n    trusted_norm2 = np.sqrt(trusted_I_u2_sq + trusted_I_grad_u2_sq)\n\n    # Numerical approximation - should be exact up to machine precision\n    approx_I_u2_sq = integrate_2d(u2_sq, N, nodes_5, weights_5)\n    approx_I_grad_u2_sq = integrate_2d(grad_u2_norm_sq, N, nodes_5, weights_5)\n    approx_seminorm2 = np.sqrt(approx_I_grad_u2_sq)\n    approx_norm2 = np.sqrt(approx_I_u2_sq + approx_I_grad_u2_sq)\n\n    # Errors\n    err_seminorm2 = np.abs(approx_seminorm2 - trusted_seminorm2) / trusted_seminorm2\n    err_norm2 = np.abs(approx_norm2 - trusted_norm2) / trusted_norm2\n    results.extend([err_seminorm2, err_norm2])\n\n    # --- Case 3: u3(x,y) = 0 ---\n    u3_sq = lambda x, y: 0.0\n    grad_u3_norm_sq = lambda x, y: 0.0\n\n    # Numerical approximation\n    approx_I_u3_sq = integrate_2d(u3_sq, N, nodes_5, weights_5)\n    approx_I_grad_u3_sq = integrate_2d(grad_u3_norm_sq, N, nodes_5, weights_5)\n    approx_seminorm3 = np.sqrt(approx_I_grad_u3_sq)\n    approx_norm3 = np.sqrt(approx_I_u3_sq + approx_I_grad_u3_sq)\n    \n    # Errors (absolute)\n    err_seminorm3 = np.abs(approx_seminorm3)\n    err_norm3 = np.abs(approx_norm3)\n    results.extend([err_seminorm3, err_norm3])\n\n    # --- Case 4: u4(x,y) = exp(alpha*x*y) with alpha=7 ---\n    alpha = 7.0\n    u4_sq = lambda x, y: np.exp(2.0 * alpha * x * y)\n    grad_u4_norm_sq = lambda x, y: (alpha**2) * (x**2 + y**2) * np.exp(2.0 * alpha * x * y)\n\n    # High-accuracy reference values\n    N_ref, q_ref = 48, 8\n    nodes_8, weights_8 = roots_legendre(q_ref)\n    trusted_I_u4_sq = integrate_2d(u4_sq, N_ref, nodes_8, weights_8)\n    trusted_I_grad_u4_sq = integrate_2d(grad_u4_norm_sq, N_ref, nodes_8, weights_8)\n    trusted_seminorm4 = np.sqrt(trusted_I_grad_u4_sq)\n    trusted_norm4 = np.sqrt(trusted_I_u4_sq + trusted_I_grad_u4_sq)\n\n    # Numerical approximation\n    approx_I_u4_sq = integrate_2d(u4_sq, N, nodes_5, weights_5)\n    approx_I_grad_u4_sq = integrate_2d(grad_u4_norm_sq, N, nodes_5, weights_5)\n    approx_seminorm4 = np.sqrt(approx_I_grad_u4_sq)\n    approx_norm4 = np.sqrt(approx_I_u4_sq + approx_I_grad_u4_sq)\n\n    # Errors\n    err_seminorm4 = np.abs(approx_seminorm4 - trusted_seminorm4) / trusted_seminorm4\n    err_norm4 = np.abs(approx_norm4 - trusted_norm4) / trusted_norm4\n    results.extend([err_seminorm4, err_norm4])\n\n    print(f\"[{','.join(f'{r:.9e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}