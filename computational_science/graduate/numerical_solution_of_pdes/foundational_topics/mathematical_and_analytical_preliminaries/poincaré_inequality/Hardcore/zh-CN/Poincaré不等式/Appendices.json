{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握庞加莱常数，我们从一个简单情形下的直接计算开始。本练习将演示如何在矩形域上，通过将庞加莱常数与拉普拉斯算子的主特征值相关联，来求得最优常数 $C_P$ 的精确值。通过分离变量法掌握这种解析方法，将为理解区域几何如何决定该常数值奠定坚实的基础 。",
            "id": "3432605",
            "problem": "考虑在矩形域 $\\Omega=(0,a)\\times(0,b)$（其中 $a0, b0$）上具有齐次狄利克雷边界条件的函数的庞加莱不等式，即：对于所有 $u\\in H_{0}^{1}(\\Omega)$，\n$$\n\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P}\\,\\|\\nabla u\\|_{L^{2}(\\Omega)}.\n$$\n此处，$H_{0}^{1}(\\Omega)$ 表示索博列夫空间，其包含的函数是平方可积的，具有平方可积的弱导数，并且在 $\\partial\\Omega$ 上为零。$\\|\\cdot\\|_{L^{2}(\\Omega)}$ 是标准的 $L^{2}$ 范数。在偏微分方程（PDE）的数值解中，$C_{P}$ 控制着耦合了刚度类和质量类双线性形式的离散化的范数等价性和稳定性界。\n\n从 $\\Omega$ 上的狄利克雷拉普拉斯算子的定义出发，并使用分离变量法求其特征对，导出上述庞加莱不等式中的精确最佳常数 $C_{P}$。然后，在以下几何变换下验证其缩放行为：\n- 各向同性缩放 $(a,b)\\mapsto (s\\,a,s\\,b)$，其中 $s0$，\n- $x$方向的各向异性拉伸 $(a,b)\\mapsto (s\\,a,b)$，其中 $s0$。\n\n请将您的最终答案表示为关于 $a$ 和 $b$ 的单个闭式解析表达式。无需四舍五入，也无需单位。",
            "solution": "该问题陈述是偏微分方程和索博列夫空间分析中的一个适定且标准的问题。它具有科学依据、自洽且客观。所有术语都是标准的且定义明确。因此，我们开始推导解答。\n\n对于域 $\\Omega \\subset \\mathbb{R}^d$ 和 $H_{0}^{1}(\\Omega)$ 中的函数，庞加莱不等式由下式给出：\n$$\n\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P}\\,\\|\\nabla u\\|_{L^{2}(\\Omega)},\n$$\n其中 $\\|\\cdot\\|_{L^{2}(\\Omega)}$ 是由内积 $(v,w)_{L^2} = \\int_\\Omega v w \\, dA$ 导出的范数。最佳常数 $C_P$ 定义为：\n$$\nC_P = \\sup_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^{2}(\\Omega)}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}}.\n$$\n等价地，两边平方，我们寻求：\n$$\nC_P^2 = \\sup_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^{2}(\\Omega)}^2}{\\|\\nabla u\\|_{L^{2}(\\Omega)}^2}.\n$$\n梯度的范数平方可以与拉普拉斯算子 $-\\Delta$ 相关联。使用格林第一恒等式（或高维中的分部积分），对于任何 $u \\in H_{0}^{1}(\\Omega)$，我们有：\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = \\int_\\Omega \\nabla u \\cdot \\nabla u \\, dA = -\\int_\\Omega u (\\Delta u) \\, dA + \\int_{\\partial\\Omega} u \\frac{\\partial u}{\\partial n} \\, dS.\n$$\n由于 $u \\in H_{0}^{1}(\\Omega)$，它在边界 $\\partial\\Omega$ 上为零（在迹的意义上），因此边界积分为零。这得出：\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = (-\\Delta u, u)_{L^{2}(\\Omega)}.\n$$\n因此，$C_P^2$ 的表达式可以用负狄利克雷拉普拉斯算子 $-\\Delta$ 来表示：\n$$\nC_P^2 = \\sup_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{(u, u)_{L^{2}(\\Omega)}}{(-\\Delta u, u)_{L^{2}(\\Omega)}} = \\left( \\inf_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{(-\\Delta u, u)_{L^{2}(\\Omega)}}{(u, u)_{L^{2}(\\Omega)}} \\right)^{-1}.\n$$\n分母中的下确界是算子 $-\\Delta$ 的瑞利商。根据紧自伴算子（$-\\Delta$ 的逆算子即是）的谱定理，这个下确界等于 $-\\Delta$ 的最小特征值。设 $-\\Delta$ 在 $\\Omega$ 上带齐次狄利克雷边界条件的特征值为 $\\lambda$，排序为 $0  \\lambda_1 \\leq \\lambda_2 \\leq \\dots$。于是，\n$$\n\\lambda_1 = \\inf_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{\\|\\nabla u\\|_{L^{2}(\\Omega)}^2}{\\|u\\|_{L^{2}(\\Omega)}^2}.\n$$\n由此，我们推导出最佳庞加莱常数与主特征值 $\\lambda_1$ 之间的关系：\n$$\nC_P^2 = \\frac{1}{\\lambda_1} \\implies C_P = \\frac{1}{\\sqrt{\\lambda_1}}.\n$$\n我们的任务现在简化为在矩形域 $\\Omega=(0,a)\\times(0,b)$ 上找到负狄利克雷拉普拉斯算子的最小特征值。该特征值问题是：\n$$\n-\\Delta \\phi = \\lambda \\phi \\quad \\text{in } \\Omega, \\quad \\phi = 0 \\quad \\text{on } \\partial\\Omega.\n$$\n在笛卡尔坐标系 $(x,y)$ 中，该问题为 $-\\left(\\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2}\\right) = \\lambda \\phi$。我们使用分离变量法求解，假设解的形式为 $\\phi(x,y) = X(x)Y(y)$。将此代入偏微分方程并除以 $X(x)Y(y)$ 得到：\n$$\n-\\frac{X''(x)}{X(x)} - \\frac{Y''(y)}{Y(y)} = \\lambda.\n$$\n此方程可分离为两个带齐次狄利克雷边界条件的一维特征值问题：\n\\begin{enumerate}\n    \\item $-X''(x) = \\mu X(x)$，对于 $x \\in (0,a)$，且 $X(0) = X(a) = 0$。\n    \\item $-Y''(y) = \\nu Y(y)$，对于 $y \\in (0,b)$，且 $Y(0) = Y(b) = 0$。\n\\end{enumerate}\n完整算子的特征值即为 $\\lambda = \\mu + \\nu$。这些标准斯特姆-刘维尔问题的解是众所周知的。对于 $x$ 方向，特征值和特征函数为：\n$$\n\\mu_m = \\left(\\frac{m\\pi}{a}\\right)^2, \\quad X_m(x) = \\sin\\left(\\frac{m\\pi x}{a}\\right), \\quad \\text{for } m \\in \\{1, 2, 3, \\dots\\}.\n$$\n类似地，对于 $y$ 方向，\n$$\n\\nu_n = \\left(\\frac{n\\pi}{b}\\right)^2, \\quad Y_n(y) = \\sin\\left(\\frac{n\\pi y}{b}\\right), \\quad \\text{for } n \\in \\{1, 2, 3, \\dots\\}.\n$$\n二维算子 $-\\Delta$ 的特征值 $\\lambda$ 是这些一维特征值的和，由整数 $m, n \\geq 1$ 索引：\n$$\n\\lambda_{m,n} = \\mu_m + \\nu_n = \\left(\\frac{m\\pi}{a}\\right)^2 + \\left(\\frac{n\\pi}{b}\\right)^2 = \\pi^2\\left(\\frac{m^2}{a^2} + \\frac{n^2}{b^2}\\right).\n$$\n最小特征值 $\\lambda_1$ 对应于 $m$ 和 $n$ 可能的最小整数值，即 $m=1$ 和 $n=1$。\n$$\n\\lambda_1 = \\lambda_{1,1} = \\pi^2\\left(\\frac{1}{a^2} + \\frac{1}{b^2}\\right).\n$$\n现在我们可以计算出精确的最佳常数 $C_P$：\n$$\nC_P = \\frac{1}{\\sqrt{\\lambda_1}} = \\frac{1}{\\sqrt{\\pi^2\\left(\\frac{1}{a^2} + \\frac{1}{b^2}\\right)}} = \\frac{1}{\\pi\\sqrt{\\frac{b^2+a^2}{a^2b^2}}} = \\frac{1}{\\pi}\\frac{\\sqrt{a^2b^2}}{\\sqrt{a^2+b^2}}.\n$$\n由于 $a0$ 和 $b0$，这可以简化为：\n$$\nC_P(a,b) = \\frac{ab}{\\pi\\sqrt{a^2+b^2}}.\n$$\n这就是最佳庞加莱常数的闭式解析表达式。\n\n接下来，我们验证其缩放行为。\n\\begin{itemize}\n    \\item **各向同性缩放：** 考虑变换 $(a,b) \\mapsto (a',b') = (sa, sb)$，其中缩放因子 $s0$。新的庞加莱常数 $C_P'$ 由下式给出：\n    $$\n    C_P' = C_P(sa, sb) = \\frac{(sa)(sb)}{\\pi\\sqrt{(sa)^2 + (sb)^2}} = \\frac{s^2ab}{\\pi\\sqrt{s^2(a^2+b^2)}} = \\frac{s^2ab}{s\\pi\\sqrt{a^2+b^2}} = s \\left( \\frac{ab}{\\pi\\sqrt{a^2+b^2}} \\right).\n    $$\n    因此，$C_P' = s\\, C_P(a,b)$。庞加莱常数随各向同性缩放因子 $s$ 线性缩放。\n\n    \\item **$x$方向的各向异性拉伸：** 考虑变换 $(a,b) \\mapsto (a',b') = (sa, b)$，其中 $s0$。新的庞加莱常数 $C_P'$ 是：\n    $$\n    C_P' = C_P(sa, b) = \\frac{(sa)b}{\\pi\\sqrt{(sa)^2 + b^2}} = \\frac{sab}{\\pi\\sqrt{s^2a^2 + b^2}}.\n    $$\n    此表达式展示了各向异性缩放。例如，当 $s \\to \\infty$ 时，区域变得非常长而薄，常数趋近于一个极限：\n    $$\n    \\lim_{s\\to\\infty} C_P' = \\lim_{s\\to\\infty} \\frac{sab}{\\pi s \\sqrt{a^2 + b^2/s^2}} = \\frac{ab}{\\pi\\sqrt{a^2}} = \\frac{b}{\\pi}.\n    $$\n    这个极限是长度为 $b$ 的一维区间的庞加莱常数，这在物理上是直观的，因为与短的 $y$ 方向上的变化相比，在非常长的 $x$ 方向上的变化的能量代价更小。\n\\end{itemize}\n推导完成，缩放性质已得到验证。$C_P$ 关于 $a$ 和 $b$ 的最终表达式如上所述。",
            "answer": "$$\n\\boxed{\\frac{ab}{\\pi\\sqrt{a^2+b^2}}}\n$$"
        },
        {
            "introduction": "尽管精确解具有启发性，但对于复杂几何形状的区域，精确求解往往是不可行的。本练习将从解析方法过渡到数值近似，展示如何使用有限元方法 (Finite Element Method, FEM) 估算庞加莱常数。你将学习如何将连续的变分问题转化为离散的广义特征值问题，这是计算科学与工程中的一项基本技术 。",
            "id": "3432600",
            "problem": "要求您设计、分析并实现一个数值Rayleigh商程序，用以估计在边界上为零的函数的最佳Poincaré常数，并验证在网格加密下的收敛性。设 $\\Omega \\subset \\mathbb{R}^{d}$ 为一个有界Lipschitz域，设 $H_{0}^{1}(\\Omega)$ 表示Sobolev空间，其函数具有平方可积的弱梯度且在 $\\partial \\Omega$ 上的迹为零，并设 $\\|\\cdot\\|_{L^{2}(\\Omega)}$ 和 $\\|\\nabla \\cdot\\|_{L^{2}(\\Omega)}$ 分别表示函数及其梯度的 $L^{2}$-范数。Poincaré不等式指出，存在一个最小常数 $C_{P} \\in \\mathbb{R}_{+}$，使得\n$$\n\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P} \\,\\|\\nabla u\\|_{L^{2}(\\Omega)} \\quad \\text{for all } u \\in H_{0}^{1}(\\Omega).\n$$\n目标是在给定网格上近似 $C_{P}$，方法是通过在协调有限元空间上最小化Dirichlet能量与$L^{2}$-范数的比值，并论证当网格加密时收敛性。\n\n任务：\n\n1. 从Poincaré不等式的定义和通过Lagrange乘子得到的驻点变分特征出发，定义Rayleigh商\n$$\n\\mathcal{R}(u) \\coloneqq \\frac{\\int_{\\Omega} |\\nabla u(x)|^{2}\\,dx}{\\int_{\\Omega} |u(x)|^{2}\\,dx} \\quad \\text{for } u \\in H_{0}^{1}(\\Omega)\\setminus\\{0\\}.\n$$\n解释为什么在 $H_{0}^{1}(\\Omega)$ 上最小化 $\\mathcal{R}(u)$ 能确定最佳常数 $C_{P}$，即最小化子的知识可以导出 $C_{P}$。然后，设 $V_{h} \\subset H_{0}^{1}(\\Omega)$ 是与给定网格相关联的协调有限元空间，并为 $v_{h} \\in V_{h}\\setminus\\{0\\}$ 类似地定义离散Rayleigh商 $\\mathcal{R}_{h}(v_{h})$。构建一个算法，在给定网格上，通过最小化 $V_{h}$ 上的 $\\mathcal{R}_{h}(\\cdot)$ 来计算 $C_{P}$ 的估计量 $C_{P,h}$。该最小化过程使用一个矩阵广义特征值问题，该问题由与Laplacian算子和 $L^{2}$ 内积相关的标准双线性形式组装而成。\n\n2. 在协调有限元空间的标准假设下，论证随网格加密的收敛性。具体来说，论证为什么离散Rayleigh商的最小化子会产生组装后的刚度矩阵和质量矩阵的广义特征对，以及为什么当网格尺寸 $h \\to 0$ 时，最小离散特征值会收敛到其连续对应项。对于嵌套空间，推断出 $C_{P,h}$ 到 $C_{P}$ 的单调收敛性，并说明在足够正则性条件下，使用分段线性元在一维空间中的预期收敛率。\n\n3. 为一维情况 $\\Omega = (0,L)$ 实现上述数值程序，其中在 $x=0$ 和 $x=L$ 处施加齐次Dirichlet边界条件，在具有 $N$ 个单元的均匀网格上使用连续分段线性有限元。组装与双线性形式对应的刚度矩阵 $K \\in \\mathbb{R}^{(N-1)\\times(N-1)}$ 和质量矩阵 $M \\in \\mathbb{R}^{(N-1)\\times(N-1)}$\n$$\na(u,v) = \\int_{0}^{L} u'(x) v'(x)\\,dx,\\qquad m(u,v) = \\int_{0}^{L} u(x) v(x)\\,dx,\n$$\n由于本质边界条件 $u(0)=u(L)=0$，这些形式仅限于内部节点。使用对称特征值求解器计算满足以下条件的最小广义特征值 $\\lambda_{h}$\n$$\nK \\mathbf{u}_{h} = \\lambda_{h} \\, M \\mathbf{u}_{h},\n$$\n并设置估计量 $C_{P,h} \\coloneqq 1/\\sqrt{\\lambda_{h}}$。\n\n4. 为了在区间上进行验证，使用一个经过充分检验的事实：在 $(0,L)$ 上，算子 $-d^{2}/dx^{2}$ 的第一Dirichlet特征值等于 $(\\pi/L)^{2}$，这意味着最佳常数 $C_{P} = L/\\pi$。对于下面的每个测试用例，计算绝对相对误差\n$$\ne(L,N) \\coloneqq \\frac{\\left|\\,C_{P,h}(L,N) - \\left(L/\\pi\\right)\\,\\right|}{L/\\pi}.\n$$\n\n测试套件：\n\n- 案例 #1：$L=1$, $N=2$。\n- 案例 #2：$L=1$, $N=8$。\n- 案例 #3：$L=1$, $N=32$。\n- 案例 #4：$L=2.5$, $N=50$。\n\n所有量均为无量纲。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，按测试用例的顺序排列，例如\n$$\n[\\;e(L_{1},N_{1}),\\,e(L_{2},N_{2}),\\,e(L_{3},N_{3}),\\,e(L_{4},N_{4})\\;].\n$$\n输出必须是实数（浮点数）。不应打印任何其他文本。",
            "solution": "该问题陈述经验证在科学上是合理的、适定的且内部一致的。它提出了一个偏微分方程数值分析中的标准问题，即使用有限元法近似Laplacian算子的特征值，及其与Poincaré不等式的联系。所有定义和参数都已明确指定。\n\n求解过程遵循问题中概述的任务，分几个步骤进行。\n\n### 1. 理论阐述：从Poincaré常数到广义特征值问题\n\n对于Sobolev空间 $H_{0}^{1}(\\Omega)$ 中的函数 $u$，Poincaré不等式由下式给出\n$$\n\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P} \\,\\|\\nabla u\\|_{L^{2}(\\Omega)},\n$$\n其中 $C_{P}$ 是使该不等式成立的最小可能常数。对于任何非零函数 $u \\in H_{0}^{1}(\\Omega)$，我们可以将不等式重新排列为\n$$\n\\frac{\\|u\\|_{L^{2}(\\Omega)}^{2}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2}} \\leq C_{P}^{2}.\n$$\n最佳常数 $C_{P}$ 是通过在所有容许函数上找到左侧表达式的上确界来获得的：\n$$\nC_{P}^{2} = \\sup_{u \\in H_{0}^{1}(\\Omega)\\setminus\\{0\\}} \\frac{\\|u\\|_{L^{2}(\\Omega)}^{2}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2}}.\n$$\n这等价于找到其倒数的下确界，即Rayleigh商 $\\mathcal{R}(u)$：\n$$\n\\frac{1}{C_{P}^{2}} = \\inf_{u \\in H_{0}^{1}(\\Omega)\\setminus\\{0\\}} \\frac{\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2}}{\\|u\\|_{L^{2}(\\Omega)}^{2}} = \\inf_{u \\in H_{0}^{1}(\\Omega)\\setminus\\{0\\}} \\frac{\\int_{\\Omega} |\\nabla u(x)|^{2}\\,dx}{\\int_{\\Omega} |u(x)|^{2}\\,dx} \\coloneqq \\lambda_{1}.\n$$\n常数 $\\lambda_{1}$ 是在 $\\Omega$ 上带有齐次Dirichlet边界条件的负Laplacian算子 $-\\Delta$ 的最小特征值。最小化 $\\mathcal{R}(u)$ 的相应Euler-Lagrange方程是特征值问题的弱形式：找到 $u \\in H_{0}^{1}(\\Omega)$，使得\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\,dx = \\lambda \\int_{\\Omega} u v \\,dx \\quad \\text{for all } v \\in H_{0}^{1}(\\Omega).\n$$\n最小特征值 $\\lambda_{1}$ 是 $\\mathcal{R}(u)$ 的最小值，因此最佳Poincaré常数为 $C_{P} = 1/\\sqrt{\\lambda_{1}}$。\n\n为了对此进行数值近似，我们引入一个有限维协调有限元空间 $V_{h} \\subset H_{0}^{1}(\\Omega)$。离散问题是在此子空间上找到Rayleigh商的最小值：\n$$\n\\lambda_{1,h} = \\min_{v_{h} \\in V_{h}\\setminus\\{0\\}} \\mathcal{R}_{h}(v_{h}) = \\min_{v_{h} \\in V_{h}\\setminus\\{0\\}} \\frac{\\int_{\\Omega} |\\nabla v_{h}|^{2}\\,dx}{\\int_{\\Omega} |v_{h}|^{2}\\,dx}.\n$$\n设 $\\{\\phi_{j}\\}_{j=1}^{N_{dof}}$ 为 $V_{h}$ 的一组基。任何函数 $v_{h} \\in V_{h}$ 都可以写成线性组合 $v_{h}(x) = \\sum_{j=1}^{N_{dof}} c_{j} \\phi_{j}(x)$，其中 $\\mathbf{c} = [c_{1}, \\dots, c_{N_{dof}}]^{T}$ 是系数向量。将此代入离散Rayleigh商可得：\n$$\n\\mathcal{R}_{h}(v_{h}) = \\frac{\\sum_{i=1}^{N_{dof}}\\sum_{j=1}^{N_{dof}} c_{i} c_{j} \\int_{\\Omega} \\nabla \\phi_{i} \\cdot \\nabla \\phi_{j}\\,dx}{\\sum_{i=1}^{N_{dof}}\\sum_{j=1}^{N_{dof}} c_{i} c_{j} \\int_{\\Omega} \\phi_{i} \\phi_{j}\\,dx} = \\frac{\\mathbf{c}^{T} K \\mathbf{c}}{\\mathbf{c}^{T} M \\mathbf{c}},\n$$\n其中 $K$ 是刚度矩阵，其元素为 $K_{ij} = a(\\phi_{j}, \\phi_{i}) = \\int_{\\Omega} \\nabla\\phi_{i} \\cdot \\nabla\\phi_{j}\\,dx$；$M$ 是质量矩阵，其元素为 $M_{ij} = m(\\phi_{j}, \\phi_{i}) = \\int_{\\Omega} \\phi_{i}\\phi_{j}\\,dx$。关于系数向量 $\\mathbf{c}$ 最小化此商等价于求解广义特征值问题：\n$$\nK \\mathbf{c} = \\lambda_{h} M \\mathbf{c}.\n$$\n该商的最小值 $\\lambda_{1,h}$ 是该系统的最小特征值。由此得到的Poincaré常数的数值估计量为 $C_{P,h} = 1/\\sqrt{\\lambda_{1,h}}$。\n\n算法如下：\n1. 给定 $\\Omega$ 的网格，为空间 $V_{h}$ 构建有限元基函数 $\\{\\phi_{j}\\}$。由于齐次边界条件，与边界节点相关的基函数被排除在外。\n2. 组装 $(N_{dof} \\times N_{dof})$ 刚度矩阵 $K$ 和质量矩阵 $M$。\n3. 求解广义特征值问题 $K \\mathbf{c} = \\lambda_{h} M \\mathbf{c}$，得到最小特征值 $\\lambda_{1,h}$。\n4. 计算Poincaré常数估计值 $C_{P,h} = 1/\\sqrt{\\lambda_{1,h}}$。\n\n### 2. 收敛性分析\n\n$C_{P,h}$ 到 $C_P$ 的收敛性依赖于有限元理论中关于特征值问题的基本结果。\n连续和离散的最小特征值分别由Rayleigh商在 $H_0^1(\\Omega)$ 和 $V_h$ 上的最小值给出：\n$$\n\\lambda_{1} = \\min_{u \\in H_{0}^{1}(\\Omega)\\setminus\\{0\\}} \\mathcal{R}(u), \\quad \\lambda_{1,h} = \\min_{v_{h} \\in V_{h}\\setminus\\{0\\}} \\mathcal{R}(v_{h}).\n$$\n由于有限元空间是协调的，因此 $V_{h} \\subset H_{0}^{1}(\\Omega)$。在较小集合 $V_h$ 上的最小化不可能产生比在较大集合 $H_{0}^{1}(\\Omega)$ 上的最小值更小的值。因此，我们有不等式：\n$$\n\\lambda_{1,h} \\geq \\lambda_{1}.\n$$\n这意味着 $C_{P,h} = 1/\\sqrt{\\lambda_{1,h}} \\leq 1/\\sqrt{\\lambda_{1}} = C_{P}$。数值近似为真实的Poincaré常数提供了一个下界。\n\n如果通过加密生成一系列网格，使得网格尺寸 $h \\to 0$，并且相应的有限元空间 $V_h$ 是嵌套的（对于 $h > h'$ 有 $V_{h'} \\subset V_h$），那么每次加密都会使最小化问题的容许函数集合增大。这导致近似特征值的单调递减：\n$$\n\\lambda_{1,h'} \\ge \\lambda_{1,h} \\ge \\dots \\ge \\lambda_{1}.\n$$\n因此，近似Poincaré常数序列 $C_{P,h}$ 从下方单调收敛于真实常数 $C_P$。\n\n关于收敛率，椭圆特征值问题的标准逼近理论指出，如果第一特征函数 $u_1$ 具有足够的正则性（例如，$u_1 \\in H^{p+1}(\\Omega)$），并且我们使用 $p$ 次分段多项式基函数，则特征值近似的误差为\n$$\n|\\lambda_{1,h} - \\lambda_{1}| = \\lambda_{1,h} - \\lambda_{1} = O(h^{2p}).\n$$\n对于使用分段线性元（$p=1$）的一维情况，在 $(0,L)$ 上的第一特征函数是 $u_1(x) = \\sin(\\pi x/L)$，它是无限可微的。因此，满足了所需的正则性要求，我们预期 $|\\lambda_{1,h} - \\lambda_{1}| = O(h^2)$。\nPoincaré常数的误差可以通过Taylor展开来估计：\n$$\nC_{P,h} = (\\lambda_{1,h})^{-1/2} = (\\lambda_1 + (\\lambda_{1,h} - \\lambda_1))^{-1/2} = \\lambda_1^{-1/2} \\left(1 - \\frac{1}{2}\\frac{\\lambda_{1,h}-\\lambda_1}{\\lambda_1} + O\\left(\\left(\\frac{\\lambda_{1,h}-\\lambda_1}{\\lambda_1}\\right)^2\\right)\\right).\n$$\n这表明 $|C_{P,h} - C_P| = C_P - C_{P,h} = O(\\lambda_{1,h} - \\lambda_1) = O(h^2)$。相对误差的收敛率也预期为 $O(h^2)$。\n\n### 3. 一维情况的实现\n\n对于 $\\Omega = (0,L)$ 和一个包含 $N$ 个单元的均匀网格，网格尺寸为 $h = L/N$。节点位于 $x_j = j h$，$j=0, \\dots, N$。自由度对应于 $N-1$ 个内部节点 $x_1, \\dots, x_{N-1}$。基函数是标准的分段线性“帽子”函数 $\\phi_j(x)$，$j=1, \\dots, N-1$，其中 $\\phi_j(x_i) = \\delta_{ij}$。\n\n刚度矩阵 $K$ 和质量矩阵 $M$ 的元素通过对这些基函数及其导数的乘积进行积分来计算。对于 $i,j \\in \\{1, \\dots, N-1\\}$：\n- 刚度矩阵 $K_{ij} = \\int_{0}^{L} \\phi_i'(x) \\phi_j'(x) \\,dx$：\n$$\nK_{ij} = \\begin{cases} 2/h  \\text{if } i=j \\\\ -1/h  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n- 质量矩阵 $M_{ij} = \\int_{0}^{L} \\phi_i(x) \\phi_j(x) \\,dx$：\n$$\nM_{ij} = \\begin{cases} 2h/3  \\text{if } i=j \\\\ h/6  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n得到的矩阵 $K, M \\in \\mathbb{R}^{(N-1)\\times(N-1)}$ 是对称和三对角的：\n$$\nK = \\frac{1}{h} \\begin{pmatrix}\n2  -1   \\\\\n-1  2  -1  \\\\\n  \\ddots  \\ddots  \\ddots \\\\\n   -1  2\n\\end{pmatrix}, \\quad\nM = \\frac{h}{6} \\begin{pmatrix}\n4  1   \\\\\n1  4  1  \\\\\n  \\ddots  \\ddots  \\ddots \\\\\n   1  4\n\\end{pmatrix}.\n$$\n这些矩阵用于广义特征值问题 $K \\mathbf{c} = \\lambda_h M \\mathbf{c}$。\n\n### 4. 验证与误差计算\n\n在 $(0,L)$ 上带有齐次Dirichlet边界条件的算子 $-d^2/dx^2$ 的精确第一特征值为 $\\lambda_1 = (\\pi/L)^2$。相应的最佳Poincaré常数为 $C_P = 1/\\sqrt{\\lambda_1} = L/\\pi$。数值估计值 $C_{P,h}$ 是从离散系统的最小特征值 $\\lambda_{1,h}$ 计算得出的。然后按规定计算绝对相对误差：\n$$\ne(L,N) = \\frac{|C_{P,h}(L,N) - C_P|}{C_P}.\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef assemble_matrices_and_solve(L, N):\n    \"\"\"\n    Assembles the stiffness and mass matrices for a 1D problem and solves the\n    generalized eigenvalue problem to find the smallest eigenvalue.\n\n    Args:\n        L (float): The length of the interval (0, L).\n        N (int): The number of finite elements.\n\n    Returns:\n        float: The smallest generalized eigenvalue lambda_h.\n    \"\"\"\n    if N  2:\n        raise ValueError(\"Number of elements N must be at least 2 for interior nodes to exist.\")\n\n    # Mesh size\n    h = float(L) / N\n    # Number of degrees of freedom (interior nodes)\n    dof = N - 1\n\n    # Assemble stiffness matrix K\n    # K is a tridiagonal matrix with 2/h on the diagonal and -1/h on the off-diagonals.\n    diag_k = np.full(dof, 2.0 / h)\n    off_diag_k = np.full(dof - 1, -1.0 / h)\n    K = np.diag(diag_k) + np.diag(off_diag_k, k=1) + np.diag(off_diag_k, k=-1)\n    \n    # Assemble mass matrix M\n    # M is a tridiagonal matrix with 4h/6 on the diagonal and h/6 on the off-diagonals.\n    diag_m = np.full(dof, 4.0 * h / 6.0)\n    off_diag_m = np.full(dof - 1, h / 6.0)\n    M = np.diag(diag_m) + np.diag(off_diag_m, k=1) + np.diag(off_diag_m, k=-1)\n\n    # Solve the generalized eigenvalue problem K*u = lambda*M*u\n    # scipy.linalg.eigh returns eigenvalues in ascending order for symmetric matrices.\n    # K and M are symmetric. M is also positive definite.\n    eigenvalues = eigh(K, M, eigvals_only=True)\n    \n    # The smallest eigenvalue is the first one\n    lambda_h_min = eigenvalues[0]\n    \n    return lambda_h_min\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and compute the relative errors.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 2),    # Case #1\n        (1.0, 8),    # Case #2\n        (1.0, 32),   # Case #3\n        (2.5, 50),   # Case #4\n    ]\n\n    results = []\n    for L, N in test_cases:\n        # Step 1: Solve for the smallest discrete eigenvalue lambda_h\n        lambda_h = assemble_matrices_and_solve(L, N)\n        \n        # Step 2: Compute the numerical estimate for the Poincare constant\n        C_Ph = 1.0 / np.sqrt(lambda_h)\n        \n        # Step 3: Compute the exact Poincare constant\n        C_P = L / np.pi\n        \n        # Step 4: Compute the absolute relative error\n        # Since C_Ph = C_P, the absolute value is not strictly needed but good practice.\n        relative_error = np.abs(C_Ph - C_P) / C_P\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "数值估计很有用，但其精度如何？这个高级练习将探讨这一关键问题，教你如何为庞加莱常数建立严格的界。通过结合一个协调方法（有限元法）和一个非协调方法（有限差分法），你将能够为 $C_P$ 的真值确定一个区间，从而为你的计算精度提供一个数学上可靠的证明 。",
            "id": "3432627",
            "problem": "考虑在一维区间域 $\\Omega = (0,L)$（其中 $L0$）上，与 Laplacian 算子相关的 Dirichlet 特征值问题。令 $H_0^1(\\Omega)$ 表示 Sobolev 空间，其元素为在边界上取值为零、自身及其弱导数均平方可积的函数。在 $H_0^1(\\Omega)$ 上定义双线性形式 $a(u,v) = \\int_0^L u'(x)v'(x)\\,dx$ 和 $b(u,v) = \\int_0^L u(x)v(x)\\,dx$。第一 Dirichlet 特征值 $\\lambda_1$ 通过 Rayleigh 商 $R(u) = a(u,u)/b(u,u)$ 进行变分表征。\n\nPoincaré 不等式断言存在一个最小常数 $C_P0$，使得对于所有 $u \\in H_0^1(\\Omega)$，都有 $\\|u\\|_{L^2(\\Omega)} \\le C_P \\|u'\\|_{L^2(\\Omega)}$。从上述定义出发，且不引用 $C_P$ 的预先给定的公式，利用基本原理：$\\lambda_1$ 的变分表征、对称双线性形式的性质以及 Rayleigh 商的最小化性质，推导最优 Poincaré 常数与第一 Dirichlet 特征值之间的关系。\n\n然后，通过使用一种相容逼近和一种非相容逼近来界定 $\\lambda_1$，从而为 $C_P$ 建立可计算的下界和上界：\n- 对于相容界，使用标准的线性有限元方法 (FEM) 在一个包含 $m$ 个尺寸为 $h=L/m$ 的单元的均匀网格上离散化 $H_0^1(\\Omega)$，施加齐次 Dirichlet 边界条件，组装全局刚度矩阵 $K \\in \\mathbb{R}^{(m-1)\\times(m-1)}$ 和质量矩阵 $M \\in \\mathbb{R}^{(m-1)\\times(m-1)}$，并计算矩阵束 $(K,M)$ 的最小广义特征值。\n- 对于非相容界，在相同的均匀网格上，使用标准的二阶中心有限差分法 (FDM) 来逼近 Dirichlet Laplacian 的最小特征值，这将产生带有齐次 Dirichlet 边界条件的离散三对角算子 $A \\in \\mathbb{R}^{(m-1)\\times(m-1)}$。使用其源于离散傅里叶符号的最小特征值的闭式表达式。\n\n使用这两个特征值逼近来生成 $C_P$ 的界，并严格证明为何一个是下界而另一个是上界。\n\n实现一个程序，对于下面测试套件中的每个测试用例 $(L,m)$，执行以下步骤：\n1. 在具有 $m$ 个单元的均匀网格上为线性单元组装 FEM 刚度矩阵和质量矩阵。\n2. 计算 $(K,M)$ 的最小广义 FEM 特征值 $\\lambda_{\\mathrm{FEM}}$。\n3. 在相同网格上计算 Dirichlet 问题的最小 FDM 特征值 $\\lambda_{\\mathrm{FDM}}$。\n4. 将这些特征值逼近转换为区间 $\\Omega=(0,L)$ 的 Poincaré 常数 $C_P$ 的界，得到下界 $C_P^{\\mathrm{low}}$ 和上界 $C_P^{\\mathrm{up}}$。同时，根据你的推导，计算 $(0,L)$ 上的精确 Poincaré 常数以供参考，以及区间的宽度 $C_P^{\\mathrm{up}} - C_P^{\\mathrm{low}}$。\n5. 将所有测试用例的结果汇总为指定的输出格式。\n\n使用以下测试套件：\n- 用例 1: $(L,m) = (1.0, 2)$。\n- 用例 2: $(L,m) = (1.0, 10)$。\n- 用例 3: $(L,m) = (2.0, 20)$。\n- 用例 4: $(L,m) = (0.5, 50)$。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个条目对应一个测试用例，其本身是按 $[C_P^{\\mathrm{low}}, C_P^{\\mathrm{up}}, C_P^{\\mathrm{exact}}, C_P^{\\mathrm{up}} - C_P^{\\mathrm{low}}]$ 顺序排列的四个浮点数列表。例如，打印的输出应如下所示：\n\"[ [value11,value12,value13,value14], [value21,value22,value23,value24], [value31,value32,value33,value34], [value41,value42,value43,value44] ]\"",
            "solution": "该问题已经过验证，被认为是有效的，因为它具有科学依据、提法恰当且客观。这是一个偏微分方程数值分析中的标准问题，所有术语和条件都定义明确且一致。\n\n解答分为三个部分。首先，我们推导最优 Poincaré 常数 $C_P$ 与第一 Dirichlet 特征值 $\\lambda_1$ 之间的基本关系。其次，我们建立并论证了从有限元和有限差分对 $\\lambda_1$ 的逼近中导出的 $C_P$ 的下界和上界的来源。最后，我们详细说明了为指定测试用例计算这些量的程序实现。\n\n**1. Poincaré 常数与第一特征值的关系**\n\n问题设定在域 $\\Omega = (0,L)$ 上，其中 $L0$。我们给定了 Sobolev 空间 $H_0^1(\\Omega)$，它包含平方可积、具有平方可积弱导数且在边界 $x=0$ 和 $x=L$ 上为零的函数。\n\n相关的范数是 $L^2$-范数 $\\|u\\|_{L^2(\\Omega)} = \\left(\\int_0^L u(x)^2 \\,dx\\right)^{1/2}$，和 $H^1$-半范数 $\\|u'\\|_{L^2(\\Omega)} = \\left(\\int_0^L u'(x)^2 \\,dx\\right)^{1/2}$。给定的双线性形式是 $a(u,v) = \\int_0^L u'(x)v'(x)\\,dx$ 和 $b(u,v) = \\int_0^L u(x)v(x)\\,dx$。在此表示法中，$a(u,u) = \\|u'\\|_{L^2(\\Omega)}^2$ 且 $b(u,u) = \\|u\\|_{L^2(\\Omega)}^2$。\n\nPoincaré 不等式指出，对于任意 $u \\in H_0^1(\\Omega)$，存在一个常数 $C_P  0$ 使得\n$$\n\\|u\\|_{L^2(\\Omega)} \\le C_P \\|u'\\|_{L^2(\\Omega)}。\n$$\n问题关注的是最优（最小）的此类常数，这是域 $\\Omega$ 的一个属性。将不等式两边平方，我们得到\n$$\n\\|u\\|_{L^2(\\Omega)}^2 \\le C_P^2 \\|u'\\|_{L^2(\\Omega)}^2。\n$$\n使用双线性形式，这可以表示为\n$$\nb(u,u) \\le C_P^2 a(u,u)。\n$$\n对于任何非零函数 $u \\in H_0^1(\\Omega)$，我们有 $a(u,u)  0$。因此，我们可以重新排列不等式为\n$$\n\\frac{b(u,u)}{a(u,u)} \\le C_P^2,\n$$\n或者等价地，\n$$\n\\frac{a(u,u)}{b(u,u)} \\ge \\frac{1}{C_P^2}。\n$$\n项 $R(u) = a(u,u)/b(u,u)$ 是 Rayleigh 商。Laplacian 算子的第一 Dirichlet 特征值 $\\lambda_1$ 被变分地定义为此商在所有允许函数上的最小值：\n$$\n\\lambda_1 = \\min_{u \\in H_0^1(\\Omega), u \\ne 0} R(u) = \\min_{u \\in H_0^1(\\Omega), u \\ne 0} \\frac{a(u,u)}{b(u,u)}。\n$$\n由于不等式 $R(u) \\ge 1/C_P^2$ 必须对所有 $u \\in H_0^1(\\Omega)$ 成立，因此它也必须对 $R(u)$ 的最小值成立。所以，\n$$\n\\lambda_1 \\ge \\frac{1}{C_P^2}。\n$$\n最优（最小）的 Poincaré 常数 $C_P$ 是使原始不等式尽可能紧确的那个。这是通过对所有非零 $u$ 取上确界来实现的：\n$$\nC_P^2 = \\sup_{u \\in H_0^1(\\Omega), u \\ne 0} \\frac{\\|u\\|_{L^2(\\Omega)}^2}{\\|u'\\|_{L^2(\\Omega)}^2} = \\sup_{u \\in H_0^1(\\Omega), u \\ne 0} \\frac{b(u,u)}{a(u,u)}。\n$$\nRayleigh 商的倒数的上确界是其下确界的倒数：\n$$\nC_P^2 = \\left( \\inf_{u \\in H_0^1(\\Omega), u \\ne 0} \\frac{a(u,u)}{b(u,u)} \\right)^{-1}。\n$$\n认识到下确界就是第一特征值 $\\lambda_1$，我们得到了基本关系：\n$$\nC_P^2 = \\frac{1}{\\lambda_1} \\implies C_P = \\frac{1}{\\sqrt{\\lambda_1}}。\n$$\n对于 $(0,L)$ 上的一维 Dirichlet 问题 $-u''=\\lambda u$，其精确的第一特征值为 $\\lambda_1 = (\\pi/L)^2$。因此，精确的最优 Poincaré 常数为：\n$$\nC_P^{\\mathrm{exact}} = \\frac{1}{\\sqrt{(\\pi/L)^2}} = \\frac{L}{\\pi}。\n$$\n\n**2. 界定 Poincaré 常数**\n\n关系式 $C_P = 1/\\sqrt{\\lambda_1}$ 表明，对 $\\lambda_1$ 的界可以转化为对 $C_P$ 的界。由于 $f(\\lambda) = 1/\\sqrt{\\lambda}$ 对于 $\\lambda  0$ 是一个单调递减函数，$\\lambda_1$ 的一个上界会提供 $C_P$ 的一个下界，而 $\\lambda_1$ 的一个下界会提供 $C_P$ 的一个上界。\n\n**相容有限元方法（$C_P$ 的下界）**：\n在 $\\Omega$ 的网格上使用线性基函数的标准有限元方法定义了一个有限维试验空间 $V_h$。基函数的构造方式使得它们满足齐次 Dirichlet 边界条件，这意味着 $V_h$ 是无限维空间 $H_0^1(\\Omega)$ 的一个子空间，即 $V_h \\subset H_0^1(\\Omega)$。FEM 的特征值逼近 $\\lambda_{\\mathrm{FEM}}$ 是通过在这个较小的空间上最小化 Rayleigh 商得到的：\n$$\n\\lambda_{\\mathrm{FEM}} = \\min_{u_h \\in V_h, u_h \\ne 0} \\frac{a(u_h, u_h)}{b(u_h, u_h)}。\n$$\n根据 Rayleigh-Ritz 原理（特征值最小-最大定理的一个推论），为一个泛函的最小值限定搜索空间只会使其最小值增大或不变。由于 $V_h \\subset H_0^1(\\Omega)$，可以得出：\n$$\n\\lambda_1 = \\min_{u \\in H_0^1(\\Omega)} R(u) \\le \\min_{u_h \\in V_h} R(u_h) = \\lambda_{\\mathrm{FEM}}。\n$$\n因此，FEM 特征值为真实特征值提供了一个上界，$\\lambda_1 \\le \\lambda_{\\mathrm{FEM}}$。应用函数 $f(\\lambda) = 1/\\sqrt{\\lambda}$ 会反转不等式：\n$$\nC_P^{\\mathrm{low}} = \\frac{1}{\\sqrt{\\lambda_{\\mathrm{FEM}}}} \\le \\frac{1}{\\sqrt{\\lambda_1}} = C_P。\n$$\n这确立了从 FEM 导出的值是 Poincaré 常数的下界。\n\n**有限差分法（$C_P$ 的上界）**：\n在间距为 $h=L/m$ 的均匀网格上对算子 $-d^2/dx^2$ 进行标准的二阶中心差分格式离散化，得到矩阵特征值问题 $A \\mathbf{u} = \\lambda \\mathbf{u}$，其中 $A = \\frac{1}{h^2}\\mathrm{tridiag}(-1, 2, -1)$ 是一个 $(m-1) \\times (m-1)$ 的矩阵。这个特定矩阵的特征值有闭式解。最小的特征值是：\n$$\n\\lambda_{\\mathrm{FDM}} = \\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi}{2m}\\right)。\n$$\n为了将其与真实特征值 $\\lambda_1 = (\\pi/L)^2 = (\\pi/(mh))^2$ 进行比较，我们可以使用 $\\sin(x) = x - x^3/6 + O(x^5)$ 的泰勒级数展开。对于小的 $x = \\pi/(2m)$，\n$$\n\\sin^2\\left(\\frac{\\pi}{2m}\\right) \\approx \\left(\\frac{\\pi}{2m} - \\frac{1}{6}\\left(\\frac{\\pi}{2m}\\right)^3\\right)^2 \\approx \\left(\\frac{\\pi}{2m}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\pi}{2m}\\right)^4。\n$$\n将此代入 $\\lambda_{\\mathrm{FDM}}$ 的表达式中：\n$$\n\\lambda_{\\mathrm{FDM}} = \\frac{4}{(L/m)^2} \\left( \\frac{\\pi^2}{4m^2} - \\frac{\\pi^4}{48m^4} + O(m^{-6})\\right) = \\frac{\\pi^2}{L^2} - \\frac{\\pi^4}{12m^2L^2} + O(h^4) = \\lambda_1 - O(h^2)。\n$$\n此分析表明，对于足够精细的网格（即 $h$ 很小），FDM 逼近会低估真实特征值，$\\lambda_{\\mathrm{FDM}} \\le \\lambda_1$。事实上，这个不等式对所有 $m \\ge 2$ 都成立。因此，FDM 特征值为真实特征值提供了一个下界。应用函数 $f(\\lambda) = 1/\\sqrt{\\lambda}$ 会反转不等式：\n$$\nC_P^{\\mathrm{up}} = \\frac{1}{\\sqrt{\\lambda_{\\mathrm{FDM}}}} \\ge \\frac{1}{\\sqrt{\\lambda_1}} = C_P。\n$$\n这确立了从 FDM 导出的值是 Poincaré 常数的上界。综合这些结果，我们获得了最优 Poincaré 常数的目标区间：\n$$\nC_P^{\\mathrm{low}} \\le C_P^{\\mathrm{exact}} \\le C_P^{\\mathrm{up}}。\n$$\n\n**3. 数值实现计划**\n\n对于每个测试用例 $(L, m)$，程序将：\n1.  定义网格尺寸 $h=L/m$ 和内部节点数 $n=m-1$。\n2.  组装 $(m-1) \\times (m-1)$ 的全局刚度矩阵 $K = \\frac{1}{h} \\mathrm{tridiag}(-1, 2, -1)$ 和质量矩阵 $M = \\frac{h}{6} \\mathrm{tridiag}(1, 4, 1)$。\n3.  使用数值稳定的求解器（例如 `scipy.linalg.eigh`，它适用于对称矩阵）求解广义特征值问题 $K\\mathbf{v} = \\lambda M\\mathbf{v}$。返回的最小特征值即为 $\\lambda_{\\mathrm{FEM}}$。\n4.  直接使用公式 $\\lambda_{\\mathrm{FDM}} = \\frac{4}{h^2} \\sin^2(\\frac{\\pi}{2m})$ 计算 $\\lambda_{\\mathrm{FDM}}$。\n5.  计算界 $C_P^{\\mathrm{low}} = 1/\\sqrt{\\lambda_{\\mathrm{FEM}}}$ 和 $C_P^{\\mathrm{up}} = 1/\\sqrt{\\lambda_{\\mathrm{FDM}}}$。\n6.  计算精确值 $C_P^{\\mathrm{exact}} = L/\\pi$ 和区间宽度 $C_P^{\\mathrm{up}} - C_P^{\\mathrm{low}}$。\n7.  将这四个值存储在当前测试用例的列表中。\n8.  遍历所有测试用例后，将结果格式化为指定的字符串格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Computes lower and upper bounds for the Poincaré constant C_P on the interval (0,L)\n    using FEM and FDM eigenvalue approximations, respectively.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 2),\n        (1.0, 10),\n        (2.0, 20),\n        (0.5, 50),\n    ]\n\n    results = []\n    for L, m in test_cases:\n        # 0. Basic parameters\n        h = L / m\n        n = m - 1  # Number of interior nodes / dimension of matrices\n\n        # Ensure we have interior nodes. Test cases all satisfy m >= 2.\n        if n == 0:\n             raise ValueError(\"Number of elements m must be at least 2.\")\n\n        # 1. Assemble the FEM stiffness (K) and mass (M) matrices for linear elements.\n        # K = (1/h) * tridiag(-1, 2, -1)\n        # M = (h/6) * tridiag(1, 4, 1)\n        diag_K = np.full(n, 2.0 / h)\n        off_diag_K = np.full(n - 1, -1.0 / h)\n        K = np.diag(diag_K) + np.diag(off_diag_K, k=1) + np.diag(off_diag_K, k=-1)\n\n        diag_M = np.full(n, 4.0 * h / 6.0)\n        off_diag_M = np.full(n - 1, 1.0 * h / 6.0)\n        M = np.diag(diag_M) + np.diag(off_diag_M, k=1) + np.diag(off_diag_M, k=-1)\n\n        # 2. Compute the smallest generalized FEM eigenvalue lambda_FEM of (K, M).\n        # We use eigh as K, M are symmetric and M is positive definite.\n        eigenvalues_fem = eigh(K, M, eigvals_only=True)\n        lambda_fem = eigenvalues_fem[0]\n\n        # 3. Compute the smallest FDM eigenvalue lambda_FDM.\n        # This has a closed-form expression.\n        lambda_fdm = (4.0 / h**2) * (np.sin(np.pi / (2.0 * m))**2)\n\n        # 4. Convert eigenvalue approximations into bounds on C_P.\n        # The true eigenvalue lambda_1 = (pi/L)^2 is bracketed:\n        # lambda_fdm = lambda_1 = lambda_fem\n        # Since C_P = 1/sqrt(lambda), the inequality for C_P is reversed:\n        # 1/sqrt(lambda_fem) = C_P = 1/sqrt(lambda_fdm)\n        cp_low = 1.0 / np.sqrt(lambda_fem)\n        cp_up = 1.0 / np.sqrt(lambda_fdm)\n        \n        # For reference, compute the exact Poincaré constant.\n        cp_exact = L / np.pi\n        \n        # Compute the width of the computed bracket.\n        bracket_width = cp_up - cp_low\n        \n        # Aggregate results for this case.\n        case_result = [cp_low, cp_up, cp_exact, bracket_width]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # [ [val1,val2,...], [val1,val2,...] ]\n    # We build the string representation manually for precise formatting control.\n    result_strings = []\n    for sublist in results:\n        # Format each number and join with commas, then enclose in brackets.\n        formatted_sublist = f'[{\",\".join(map(str, sublist))}]'\n        result_strings.append(formatted_sublist)\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}