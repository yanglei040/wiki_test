{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, our first practice involves deriving the Poincaré constant for a simple, canonical geometry. By calculating the exact constant $C_P$ for a rectangular domain, we connect its abstract definition to the concrete task of finding the smallest eigenvalue of the Laplacian operator. This exercise not only provides a tangible result but also illuminates how the constant fundamentally depends on the domain's dimensions .",
            "id": "3432605",
            "problem": "Consider the Poincaré inequality for functions with homogeneous Dirichlet boundary conditions on the rectangle domain $\\Omega=(0,a)\\times(0,b)$, with $a>0$ and $b>0$, namely: for all $u\\in H_{0}^{1}(\\Omega)$,\n$$\n\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P}\\,\\|\\nabla u\\|_{L^{2}(\\Omega)}.\n$$\nHere $H_{0}^{1}(\\Omega)$ denotes the Sobolev space of square-integrable functions with square-integrable weak derivatives that vanish on $\\partial\\Omega$, and $\\|\\cdot\\|_{L^{2}(\\Omega)}$ is the standard $L^{2}$ norm. In the numerical solution of Partial Differential Equations (PDE), $C_{P}$ controls norm equivalences and stability bounds for discretizations that couple stiffness-like and mass-like bilinear forms.\n\nStarting from the definition of the Dirichlet Laplacian on $\\Omega$ and using separation of variables to obtain its eigenpairs, derive the exact best constant $C_{P}$ in the Poincaré inequality above. Then, verify its scaling behavior under the following geometric transformations:\n- isotropic dilation $(a,b)\\mapsto (s\\,a,s\\,b)$ with $s>0$,\n- anisotropic stretching in the $x$-direction $(a,b)\\mapsto (s\\,a,b)$ with $s>0$.\n\nExpress your final answer as a single closed-form analytic expression for $C_{P}$ in terms of $a$ and $b$. No rounding is required, and no units are needed.",
            "solution": "The problem statement is a well-posed and standard problem in the analysis of partial differential equations and Sobolev spaces. It is scientifically grounded, self-contained, and objective. All terms are standard and well-defined. Therefore, we proceed with the derivation of a solution.\n\nThe Poincaré inequality for a domain $\\Omega \\subset \\mathbb{R}^d$ and functions in $H_{0}^{1}(\\Omega)$ is given by\n$$\n\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P}\\,\\|\\nabla u\\|_{L^{2}(\\Omega)},\n$$\nwhere $\\|\\cdot\\|_{L^{2}(\\Omega)}$ is the norm induced by the inner product $(v,w)_{L^2} = \\int_\\Omega v w \\, dA$. The best constant $C_P$ is defined by\n$$\nC_P = \\sup_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^{2}(\\Omega)}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}}.\n$$\nEquivalently, squaring both sides, we seek\n$$\nC_P^2 = \\sup_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{\\|u\\|_{L^{2}(\\Omega)}^2}{\\|\\nabla u\\|_{L^{2}(\\Omega)}^2}.\n$$\nThe squared norm of the gradient can be related to the Laplacian operator $-\\Delta$. Using Green's first identity (or integration by parts in higher dimensions), for any $u \\in H_{0}^{1}(\\Omega)$, we have\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = \\int_\\Omega \\nabla u \\cdot \\nabla u \\, dA = -\\int_\\Omega u (\\Delta u) \\, dA + \\int_{\\partial\\Omega} u \\frac{\\partial u}{\\partial n} \\, dS.\n$$\nSince $u \\in H_{0}^{1}(\\Omega)$, it vanishes on the boundary $\\partial\\Omega$ (in the sense of traces), so the boundary integral is zero. This yields\n$$\n\\|\\nabla u\\|_{L^{2}(\\Omega)}^2 = (-\\Delta u, u)_{L^{2}(\\Omega)}.\n$$\nThe expression for $C_P^2$ can thus be written in terms of the negative Dirichlet Laplacian, $-\\Delta$:\n$$\nC_P^2 = \\sup_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{(u, u)_{L^{2}(\\Omega)}}{(-\\Delta u, u)_{L^{2}(\\Omega)}} = \\left( \\inf_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{(-\\Delta u, u)_{L^{2}(\\Omega)}}{(u, u)_{L^{2}(\\Omega)}} \\right)^{-1}.\n$$\nThe infimum in the denominator is the Rayleigh quotient for the operator $-\\Delta$. By the spectral theorem for compact self-adjoint operators (which the inverse of $-\\Delta$ is), this infimum is equal to the smallest eigenvalue of $-\\Delta$. Let the eigenvalues of $-\\Delta$ on $\\Omega$ with homogeneous Dirichlet boundary conditions be denoted by $\\lambda$, ordered as $0 < \\lambda_1 \\leq \\lambda_2 \\leq \\dots$. Then,\n$$\n\\lambda_1 = \\inf_{u \\in H_{0}^{1}(\\Omega), u \\neq 0} \\frac{\\|\\nabla u\\|_{L^{2}(\\Omega)}^2}{\\|u\\|_{L^{2}(\\Omega)}^2}.\n$$\nFrom this, we deduce the relationship between the best Poincaré constant and the principal eigenvalue $\\lambda_1$:\n$$\nC_P^2 = \\frac{1}{\\lambda_1} \\implies C_P = \\frac{1}{\\sqrt{\\lambda_1}}.\n$$\nOur task is now reduced to finding the smallest eigenvalue of the negative Dirichlet Laplacian on the rectangular domain $\\Omega=(0,a)\\times(0,b)$. The eigenvalue problem is\n$$\n-\\Delta \\phi = \\lambda \\phi \\quad \\text{in } \\Omega, \\quad \\phi = 0 \\quad \\text{on } \\partial\\Omega.\n$$\nIn Cartesian coordinates $(x,y)$, this is $-\\left(\\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2}\\right) = \\lambda \\phi$. We solve this using the method of separation of variables, assuming a solution of the form $\\phi(x,y) = X(x)Y(y)$. Substituting this into the PDE and dividing by $X(x)Y(y)$ yields\n$$\n-\\frac{X''(x)}{X(x)} - \\frac{Y''(y)}{Y(y)} = \\lambda.\n$$\nThis equation separates into two one-dimensional eigenvalue problems with homogeneous Dirichlet boundary conditions:\n\\begin{enumerate}\n    \\item $-X''(x) = \\mu X(x)$ for $x \\in (0,a)$, with $X(0) = X(a) = 0$.\n    \\item $-Y''(y) = \\nu Y(y)$ for $y \\in (0,b)$, with $Y(0) = Y(b) = 0$.\n\\end{enumerate}\nThe eigenvalues of the full operator are then $\\lambda = \\mu + \\nu$. The solutions to these standard Sturm-Liouville problems are well-known. For the $x$-direction, the eigenvalues and eigenfunctions are\n$$\n\\mu_m = \\left(\\frac{m\\pi}{a}\\right)^2, \\quad X_m(x) = \\sin\\left(\\frac{m\\pi x}{a}\\right), \\quad \\text{for } m \\in \\{1, 2, 3, \\dots\\}.\n$$\nSimilarly, for the $y$-direction,\n$$\n\\nu_n = \\left(\\frac{n\\pi}{b}\\right)^2, \\quad Y_n(y) = \\sin\\left(\\frac{n\\pi y}{b}\\right), \\quad \\text{for } n \\in \\{1, 2, 3, \\dots\\}.\n$$\nThe eigenvalues $\\lambda$ of the two-dimensional operator $-\\Delta$ are the sums of these one-dimensional eigenvalues, indexed by integers $m, n \\geq 1$:\n$$\n\\lambda_{m,n} = \\mu_m + \\nu_n = \\left(\\frac{m\\pi}{a}\\right)^2 + \\left(\\frac{n\\pi}{b}\\right)^2 = \\pi^2\\left(\\frac{m^2}{a^2} + \\frac{n^2}{b^2}\\right).\n$$\nThe smallest eigenvalue, $\\lambda_1$, corresponds to the lowest possible integer values for $m$ and $n$, which are $m=1$ and $n=1$.\n$$\n\\lambda_1 = \\lambda_{1,1} = \\pi^2\\left(\\frac{1}{a^2} + \\frac{1}{b^2}\\right).\n$$\nWe can now calculate the exact best constant $C_P$:\n$$\nC_P = \\frac{1}{\\sqrt{\\lambda_1}} = \\frac{1}{\\sqrt{\\pi^2\\left(\\frac{1}{a^2} + \\frac{1}{b^2}\\right)}} = \\frac{1}{\\pi\\sqrt{\\frac{b^2+a^2}{a^2b^2}}} = \\frac{1}{\\pi}\\frac{\\sqrt{a^2b^2}}{\\sqrt{a^2+b^2}}.\n$$\nSince $a>0$ and $b>0$, this simplifies to\n$$\nC_P(a,b) = \\frac{ab}{\\pi\\sqrt{a^2+b^2}}.\n$$\nThis is the closed-form analytic expression for the best Poincaré constant.\n\nNext, we verify its scaling behavior.\n\\begin{itemize}\n    \\item **Isotropic dilation:** Consider the transformation $(a,b) \\mapsto (a',b') = (sa, sb)$ for some scaling factor $s>0$. The new Poincaré constant $C_P'$ is given by\n    $$\n    C_P' = C_P(sa, sb) = \\frac{(sa)(sb)}{\\pi\\sqrt{(sa)^2 + (sb)^2}} = \\frac{s^2ab}{\\pi\\sqrt{s^2(a^2+b^2)}} = \\frac{s^2ab}{s\\pi\\sqrt{a^2+b^2}} = s \\left( \\frac{ab}{\\pi\\sqrt{a^2+b^2}} \\right).\n    $$\n    Thus, $C_P' = s\\, C_P(a,b)$. The Poincaré constant scales linearly with the isotropic dilation factor $s$.\n\n    \\item **Anisotropic stretching in the $x$-direction:** Consider the transformation $(a,b) \\mapsto (a',b') = (sa, b)$ for $s>0$. The new Poincaré constant $C_P'$ is\n    $$\n    C_P' = C_P(sa, b) = \\frac{(sa)b}{\\pi\\sqrt{(sa)^2 + b^2}} = \\frac{sab}{\\pi\\sqrt{s^2a^2 + b^2}}.\n    $$\n    This expression demonstrates the anisotropic scaling. For instance, as $s \\to \\infty$, the domain becomes very long and thin, and the constant approaches a limit:\n    $$\n    \\lim_{s\\to\\infty} C_P' = \\lim_{s\\to\\infty} \\frac{sab}{\\pi s \\sqrt{a^2 + b^2/s^2}} = \\frac{ab}{\\pi\\sqrt{a^2}} = \\frac{b}{\\pi}.\n    $$\n    This limit is the Poincaré constant for a one-dimensional interval of length $b$, which is physically intuitive as variation in the very long $x$-direction becomes less costly energetically compared to variation in the short $y$-direction.\n\\end{itemize}\nThe derivation is complete, and the scaling properties have been verified. The final expression for $C_P$ in terms of $a$ and $b$ is as derived above.",
            "answer": "$$\n\\boxed{\\frac{ab}{\\pi\\sqrt{a^2+b^2}}}\n$$"
        },
        {
            "introduction": "Having mastered the calculation on a connected domain, we now investigate a more topologically complex scenario. This thought experiment explores how the Poincaré constant behaves on a disconnected domain, consisting of two separate regions. This practice reveals the profound impact of boundary conditions, contrasting the isolated nature of the Dirichlet problem with the challenges posed by different mean-value constraints in the Neumann problem, a situation with direct consequences for numerical solvers .",
            "id": "3432663",
            "problem": "Let $\\Omega \\subset \\mathbb{R}^d$ with $d \\ge 2$ be the disconnected domain $\\Omega = B_{R_1}(x_1) \\cup B_{R_2}(x_2)$, where $B_{R}(x)$ denotes the open ball of radius $R$ centered at $x$, the radii satisfy $R_1 \\ge R_2 > 0$, and the centers satisfy $\\lvert x_1 - x_2 \\rvert = L$ with $L > R_1 + R_2$ (so the balls are disjoint). Consider the Poincaré inequality in two boundary condition settings: (i) the Dirichlet setting with $u \\in H_0^1(\\Omega)$, and (ii) the Neumann setting with $u \\in H^1(\\Omega)$ and appropriate mean-zero constraints. Let $C_P^D(\\Omega)$ denote the optimal constant in the Dirichlet Poincaré inequality $\\lVert u \\rVert_{L^2(\\Omega)} \\le C_P^D(\\Omega)\\, \\lVert \\nabla u \\rVert_{L^2(\\Omega)}$ for all $u \\in H_0^1(\\Omega)$, and let $C_P^N(\\Omega;\\cdot)$ denote the optimal constant in the Neumann Poincaré inequality $\\lVert u - \\Pi(u) \\rVert_{L^2(\\Omega)} \\le C_P^N(\\Omega;\\cdot)\\, \\lVert \\nabla u \\rVert_{L^2(\\Omega)}$ for all $u \\in H^1(\\Omega)$, where $\\Pi(u)$ denotes the projection corresponding to the imposed mean-zero constraints. Assume standard weak formulations of the Laplacian consistent with each boundary condition. In the context of numerical solution of partial differential equations (PDE), also consider conforming discretizations by the finite element method (FEM).\n\nWhich of the following statements are correct?\n\nA. In the Dirichlet case, $C_P^D(\\Omega)$ is independent of $L$ and is equal to $\\max\\{C_P^D(B_{R_1}),\\, C_P^D(B_{R_2})\\}$; moreover, $C_P^D(B_R)$ scales linearly with $R$, so $C_P^D(\\Omega)$ scales like the larger radius $R_1$.\n\nB. In the Neumann case with only a single global mean-zero constraint over $\\Omega$, the Poincaré inequality holds with a finite constant independent of $L$, and $C_P^N(\\Omega;\\text{global mean})$ scales like $\\max\\{R_1, R_2\\}$.\n\nC. In the Neumann case with separate mean-zero constraints on each connected component, i.e., enforcing zero average on $B_{R_1}(x_1)$ and on $B_{R_2}(x_2)$ individually, the optimal constant satisfies $C_P^N(\\Omega;\\text{componentwise mean}) = \\max\\{C_P^N(B_{R_1}),\\, C_P^N(B_{R_2})\\}$ and is independent of $L$; furthermore, $C_P^N(B_R)$ scales linearly with $R$.\n\nD. As $L \\to \\infty$, the Dirichlet constant $C_P^D(\\Omega)$ diverges to $+\\infty$ because the domain becomes increasingly disconnected, causing a loss of coercivity at the continuum level.\n\nE. For a conforming FEM discretization of the Neumann problem on $\\Omega$ with two connected components, if only a single global mean-zero constraint is enforced, then the assembled stiffness matrix remains singular with a $1$-dimensional nullspace spanned by a vector that is constant on $B_{R_1}(x_1)$, constant on $B_{R_2}(x_2)$, and whose values have opposite signs to satisfy the single global constraint. To obtain a discrete Poincaré inequality, one must enforce one mean constraint per connected component.",
            "solution": "The problem statement will first be validated for scientific soundness, well-posedness, and objectivity.\n\n### Step 1: Extract Givens\n-   **Domain:** $\\Omega \\subset \\mathbb{R}^d$ with $d \\ge 2$.\n-   **Domain Definition:** $\\Omega = B_{R_1}(x_1) \\cup B_{R_2}(x_2)$, where $B_{R}(x)$ is the open ball of radius $R$ centered at $x$.\n-   **Radii:** $R_1 \\ge R_2 > 0$.\n-   **Centers:** $\\lvert x_1 - x_2 \\rvert = L$.\n-   **Disjointness:** $L > R_1 + R_2$.\n-   **Case (i) Dirichlet:** Function space is $u \\in H_0^1(\\Omega)$. The Dirichlet Poincaré inequality is $\\lVert u \\rVert_{L^2(\\Omega)} \\le C_P^D(\\Omega)\\, \\lVert \\nabla u \\rVert_{L^2(\\Omega)}$ for all $u \\in H_0^1(\\Omega)$, with $C_P^D(\\Omega)$ being the optimal constant.\n-   **Case (ii) Neumann:** Function space is $u \\in H^1(\\Omega)$ with mean-zero constraints. The Neumann Poincaré inequality is $\\lVert u - \\Pi(u) \\rVert_{L^2(\\Omega)} \\le C_P^N(\\Omega;\\cdot)\\, \\lVert \\nabla u \\rVert_{L^2(\\Omega)}$ for all $u \\in H^1(\\Omega)$, where $\\Pi(u)$ is a projection corresponding to the specific mean-zero constraint.\n-   **Context:** Standard weak formulations and conforming finite element method (FEM) discretizations are considered.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is formulated within the established mathematical framework of Sobolev spaces ($H^1$, $H_0^1$) and the theory of partial differential equations. The Poincaré inequality is a fundamental tool in this field. The specified domain, a disjoint union of two balls, is a standard example used to illustrate the influence of domain topology on spectral properties of differential operators and associated constants. The concepts of mean-zero constraints and FEM discretizations are also standard. The problem is rigorously grounded in mathematical analysis.\n2.  **Well-Posed:** The problem provides all necessary definitions to analyze the behavior of the Poincaré constant. The domain geometry is unambiguously defined. The function spaces and the inequalities are standard. The questions posed in the options are precise and admit definite mathematical proofs or disproofs.\n3.  **Objective:** The problem statement is expressed in formal, objective mathematical language. It contains no subjective claims, vagueness, or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is scientifically sound, well-posed, and objective. A full analysis of the options is warranted.\n\n### Derivation and Option Analysis\n\nLet the two disjoint components of the domain be $\\Omega_1 = B_{R_1}(x_1)$ and $\\Omega_2 = B_{R_2}(x_2)$. For any function $u$ defined on $\\Omega$, its restriction to $\\Omega_i$ is $u_i = u|_{\\Omega_i}$. The $L^2$ norms of the function and its gradient decompose over the disjoint union:\n$$ \\lVert u \\rVert_{L^2(\\Omega)}^2 = \\lVert u_1 \\rVert_{L^2(\\Omega_1)}^2 + \\lVert u_2 \\rVert_{L^2(\\Omega_2)}^2 $$\n$$ \\lVert \\nabla u \\rVert_{L^2(\\Omega)}^2 = \\lVert \\nabla u_1 \\rVert_{L^2(\\Omega_1)}^2 + \\lVert \\nabla u_2 \\rVert_{L^2(\\Omega_2)}^2 $$\n\n**Analysis of the Dirichlet Case (Options A and D)**\n\nThe space $H_0^1(\\Omega)$ consists of functions in $H^1(\\Omega)$ with zero trace on the boundary $\\partial\\Omega = \\partial\\Omega_1 \\cup \\partial\\Omega_2$. For a function $u \\in H_0^1(\\Omega)$, its restriction $u_i$ to a component $\\Omega_i$ must have zero trace on $\\partial\\Omega_i$. Thus, $u_1 \\in H_0^1(\\Omega_1)$ and $u_2 \\in H_0^1(\\Omega_2)$. The space $H_0^1(\\Omega)$ is isometrically isomorphic to the direct sum $H_0^1(\\Omega_1) \\oplus H_0^1(\\Omega_2)$.\n\nThe Dirichlet-Poincaré inequality holds on each component:\n$$ \\lVert u_i \\rVert_{L^2(\\Omega_i)} \\le C_P^D(\\Omega_i)\\, \\lVert \\nabla u_i \\rVert_{L^2(\\Omega_i)} \\quad \\text{for } i=1,2 $$\nLet $C_{\\max}^D = \\max\\{C_P^D(\\Omega_1), C_P^D(\\Omega_2)\\}$. We can write:\n$$ \\lVert u \\rVert_{L^2(\\Omega)}^2 = \\lVert u_1 \\rVert_{L^2(\\Omega_1)}^2 + \\lVert u_2 \\rVert_{L^2(\\Omega_2)}^2 \\le (C_P^D(\\Omega_1))^2 \\lVert \\nabla u_1 \\rVert_{L^2(\\Omega_1)}^2 + (C_P^D(\\Omega_2))^2 \\lVert \\nabla u_2 \\rVert_{L^2(\\Omega_2)}^2 $$\n$$ \\le (C_{\\max}^D)^2 \\left( \\lVert \\nabla u_1 \\rVert_{L^2(\\Omega_1)}^2 + \\lVert \\nabla u_2 \\rVert_{L^2(\\Omega_2)}^2 \\right) = (C_{\\max}^D)^2 \\lVert \\nabla u \\rVert_{L^2(\\Omega)}^2 $$\nThis shows that $C_P^D(\\Omega) \\le C_{\\max}^D$. To show equality, assume $C_{\\max}^D = C_P^D(\\Omega_1)$. Let $u_1^*$ be a function that saturates the inequality on $\\Omega_1$ (an eigenfunction corresponding to the first eigenvalue of the Dirichlet Laplacian on $\\Omega_1$). Define $u \\in H_0^1(\\Omega)$ by setting $u=u_1^*$ on $\\Omega_1$ and $u=0$ on $\\Omega_2$. For this $u$, the Rayleigh quotient is:\n$$ \\frac{\\lVert u \\rVert_{L^2(\\Omega)}^2}{\\lVert \\nabla u \\rVert_{L^2(\\Omega)}^2} = \\frac{\\lVert u_1^* \\rVert_{L^2(\\Omega_1)}^2}{\\lVert \\nabla u_1^* \\rVert_{L^2(\\Omega_1)}^2} = (C_P^D(\\Omega_1))^2 = (C_{\\max}^D)^2 $$\nThus, the optimal constant is $C_P^D(\\Omega) = \\max\\{C_P^D(\\Omega_1), C_P^D(\\Omega_2)\\}$. This value depends only on the geometry of the individual balls, not on the distance $L$ between them.\n\nThe Poincaré constant for a ball of radius $R$, $C_P^D(B_R)$, is $1/\\sqrt{\\lambda_1}$, where $\\lambda_1$ is the principal eigenvalue of the Dirichlet Laplacian on $B_R$. Through scaling arguments, it can be shown that $\\lambda_1 \\propto 1/R^2$, and therefore $C_P^D(B_R) \\propto R$. Since $R_1 \\ge R_2$, it follows that $C_P^D(B_{R_1}) \\ge C_P^D(B_{R_2})$, so $C_P^D(\\Omega) = C_P^D(B_{R_1})$.\n\n-   **Option A:** This statement asserts that $C_P^D(\\Omega)$ is independent of $L$, equals $\\max\\{C_P^D(B_{R_1}),\\, C_P^D(B_{R_2})\\}$, and scales like $R_1$. This is fully consistent with our derivation.\n    Verdict: **Correct**.\n-   **Option D:** This statement claims $C_P^D(\\Omega) \\to \\infty$ as $L \\to \\infty$. This directly contradicts our finding that the constant is independent of $L$. The physical separation of components has no effect on the Dirichlet-Poincaré constant due to the strict zero boundary condition on each component, which isolates them completely.\n    Verdict: **Incorrect**.\n\n**Analysis of the Neumann Case (Options B, C, and E)**\n\nThe space is $H^1(\\Omega)$. The seminorm $\\lVert \\nabla u \\rVert_{L^2(\\Omega)}$ is zero for any function that is constant on each connected component. Since $\\Omega$ has two components, the null space of the gradient operator is two-dimensional, spanned by the characteristic functions $\\chi_{\\Omega_1}$ and $\\chi_{\\Omega_2}$. For a Poincaré (or Poincaré-Wirtinger) inequality to hold with a finite constant, the space of functions must be restricted such that no function with zero gradient seminorm remains (except the zero function). This is achieved by imposing constraints, typically zero-mean conditions.\n\n-   **Option B (Global mean-zero):** The constraint is $\\int_\\Omega u \\,dx = 0$. We must check if this removes the entire 2D null space. Consider a function $u$ which is $c_1$ on $\\Omega_1$ and $c_2$ on $\\Omega_2$. Its gradient is zero. The constraint becomes $c_1 \\text{vol}(\\Omega_1) + c_2 \\text{vol}(\\Omega_2) = 0$. We can choose non-trivial constants, for example $c_1 = \\text{vol}(\\Omega_2)$ and $c_2 = -\\text{vol}(\\Omega_1)$. This function $u(x) = (\\text{vol}(\\Omega_2))\\chi_{\\Omega_1}(x) - (\\text{vol}(\\Omega_1))\\chi_{\\Omega_2}(x)$ has a zero global mean and a zero gradient. However, its $L^2$ norm (and the left-hand side of the inequality, $\\lVert u - \\Pi(u) \\rVert_{L^2(\\Omega)} = \\lVert u \\rVert_{L^2(\\Omega)}$ since $\\bar{u}_\\Omega=0$) is non-zero. The Rayleigh quotient for this function is infinite. Thus, a Poincaré inequality with a finite constant does not hold.\n    Verdict: **Incorrect**.\n\n-   **Option C (Component-wise mean-zero):** The constraints are $\\int_{\\Omega_1} u \\,dx = 0$ and $\\int_{\\Omega_2} u \\, dx = 0$. The projection is $\\Pi(u) = \\bar{u}_{\\Omega_1}\\chi_{\\Omega_1} + \\bar{u}_{\\Omega_2}\\chi_{\\Omega_2}$. The left-hand side of the inequality becomes:\n    $$ \\lVert u - \\Pi(u) \\rVert_{L^2(\\Omega)}^2 = \\lVert u_1 - \\bar{u}_{\\Omega_1} \\rVert_{L^2(\\Omega_1)}^2 + \\lVert u_2 - \\bar{u}_{\\Omega_2} \\rVert_{L^2(\\Omega_2)}^2 $$\n    These constraints effectively quotient out the constant functions on each component. On this restricted space, the problem decouples into two independent Neumann problems on $\\Omega_1$ and $\\Omega_2$. The analysis is analogous to the Dirichlet case. The constant $C_P^N(\\Omega;\\text{componentwise mean})$ is given by $\\max\\{C_P^N(\\Omega_1), C_P^N(\\Omega_2)\\}$. Like the Dirichlet constant, the Neumann-Poincaré constant $C_P^N(B_R)$ for a ball scales linearly with radius $R$. Therefore, the statement is completely analogous to the correct statement for the Dirichlet case. The constant is independent of $L$.\n    Verdict: **Correct**.\n\n-   **Option E (FEM Discretization):** This option discusses the numerical linear algebra consequences. The stiffness matrix $A$ for the weak form of the Neumann problem has entries $A_{ij} = \\int_\\Omega \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dx$. Its null space, at the discrete level, mirrors the null space of the continuous operator. It has a dimension equal to the number of connected components, which is $2$. The null vectors correspond to nodal vectors that are constant on each of the two discrete sub-domains. Imposing a single global mean-zero constraint eliminates one null mode (the globally constant vector), but a second mode remains. This remaining mode corresponds to a vector that is constant with value $c_1$ on the nodes of $\\Omega_1$ and constant with value $c_2$ on the nodes of $\\Omega_2$, where $c_1$ and $c_2$ are chosen to satisfy the discrete-level global mean-zero constraint. This implies $c_1$ and $c_2$ must have opposite signs. The resulting linear system is still singular. A discrete Poincaré inequality requires the stiffness matrix to be invertible on the constrained space. To achieve this, the entire 2-dimensional null space must be removed. This requires two independent constraints, such as enforcing a zero-mean condition on each component separately. The statement accurately describes this situation.\n    Verdict: **Correct**.",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "While analytical solutions are invaluable, they are limited to simple geometries; for real-world applications, we turn to numerical methods. This final practice guides you through computing rigorous lower and upper bounds for the Poincaré constant by contrasting a conforming Finite Element Method (FEM) with a Finite Difference Method (FDM). This powerful technique of 'bracketing' the true value is a cornerstone of numerical verification and provides deep insight into the systematic error behavior of different discretization schemes .",
            "id": "3432627",
            "problem": "Consider the one-dimensional Dirichlet eigenvalue problem associated with the Laplacian on an interval domain $\\Omega = (0,L)$ with $L>0$. Let $H_0^1(\\Omega)$ denote the Sobolev space of square-integrable functions with square-integrable weak derivative that vanish at the boundary. Define the bilinear forms $a(u,v) = \\int_0^L u'(x)v'(x)\\,dx$ and $b(u,v) = \\int_0^L u(x)v(x)\\,dx$ on $H_0^1(\\Omega)$. The first Dirichlet eigenvalue $\\lambda_1$ is characterized variationally via the Rayleigh quotient $R(u) = a(u,u)/b(u,u)$.\n\nThe Poincaré inequality asserts the existence of a smallest constant $C_P>0$ such that $\\|u\\|_{L^2(\\Omega)} \\le C_P \\|u'\\|_{L^2(\\Omega)}$ for all $u \\in H_0^1(\\Omega)$. Starting from the definitions given above, and without invoking pre-stated formulas for $C_P$, derive the relationship between the optimal Poincaré constant and the first Dirichlet eigenvalue by using fundamental principles: the variational characterization of $\\lambda_1$, the properties of symmetric bilinear forms, and the minimizing property of the Rayleigh quotient.\n\nThen, using this relationship, establish computable lower and upper bounds for $C_P$ by bracketing $\\lambda_1$ with one conforming and one nonconforming approximation:\n- For the conforming bound, discretize $H_0^1(\\Omega)$ with the standard Linear Finite Element Method (FEM) on a uniform mesh with $m$ elements of size $h=L/m$, impose homogeneous Dirichlet boundary conditions, assemble the global stiffness matrix $K \\in \\mathbb{R}^{(m-1)\\times(m-1)}$ and mass matrix $M \\in \\mathbb{R}^{(m-1)\\times(m-1)}$, and compute the smallest generalized eigenvalue of the matrix pencil $(K,M)$.\n- For the nonconforming bound, approximate the smallest eigenvalue of the Dirichlet Laplacian using the standard second-order central Finite Difference Method (FDM) on the same uniform grid, which yields the discrete tridiagonal operator $A \\in \\mathbb{R}^{(m-1)\\times(m-1)}$ with homogeneous Dirichlet boundary conditions. Use the closed-form expression of its smallest eigenvalue derived from the discrete Fourier symbol.\n\nUse these two eigenvalue approximations to produce bounds on $C_P$ and justify rigorously why one is a lower bound and the other is an upper bound.\n\nImplement a program that, for each test case $(L,m)$ in the test suite below, performs the following steps:\n1. Assemble the FEM stiffness and mass matrices for linear elements on a uniform mesh of $m$ elements.\n2. Compute the smallest generalized FEM eigenvalue $\\lambda_{\\mathrm{FEM}}$ of $(K,M)$.\n3. Compute the smallest FDM eigenvalue $\\lambda_{\\mathrm{FDM}}$ for the Dirichlet problem on the same grid.\n4. Convert these eigenvalue approximations into bounds on the Poincaré constant $C_P$ for the interval $\\Omega=(0,L)$, yielding a lower bound $C_P^{\\mathrm{low}}$ and an upper bound $C_P^{\\mathrm{up}}$. Also compute the exact Poincaré constant on $(0,L)$ for reference, based on your derivation, and the bracket width $C_P^{\\mathrm{up}} - C_P^{\\mathrm{low}}$.\n5. Aggregate the results for all test cases into the specified output format.\n\nUse the following test suite:\n- Case 1: $(L,m) = (1.0, 2)$.\n- Case 2: $(L,m) = (1.0, 10)$.\n- Case 3: $(L,m) = (2.0, 20)$.\n- Case 4: $(L,m) = (0.5, 50)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case and is itself a list of four floating-point numbers in the order $[C_P^{\\mathrm{low}}, C_P^{\\mathrm{up}}, C_P^{\\mathrm{exact}}, C_P^{\\mathrm{up}} - C_P^{\\mathrm{low}}]$. For example, the printed output should look like:\n\"[ [value11,value12,value13,value14], [value21,value22,value23,value24], [value31,value32,value33,value34], [value41,value42,value43,value44] ]\"",
            "solution": "The problem is subjected to validation and is deemed valid as it is scientifically grounded, well-posed, and objective. It is a standard problem in the numerical analysis of partial differential equations, with all terms and conditions being well-defined and consistent.\n\nThe solution proceeds in three parts. First, we derive the fundamental relationship between the optimal Poincaré constant $C_P$ and the first Dirichlet eigenvalue $\\lambda_1$. Second, we establish and justify the sources of lower and upper bounds on $C_P$ derived from Finite Element and Finite Difference approximations of $\\lambda_1$. Finally, we detail the implementation of a program to compute these quantities for the specified test cases.\n\n**1. Relationship Between the Poincaré Constant and the First Eigenvalue**\n\nThe problem is set on the domain $\\Omega = (0,L)$ for some $L>0$. We are given the Sobolev space $H_0^1(\\Omega)$, which contains functions that are square-integrable, have a square-integrable weak derivative, and are zero at the boundaries $x=0$ and $x=L$.\n\nThe relevant norms are the $L^2$-norm, $\\|u\\|_{L^2(\\Omega)} = \\left(\\int_0^L u(x)^2 \\,dx\\right)^{1/2}$, and the $H^1$-seminorm, $\\|u'\\|_{L^2(\\Omega)} = \\left(\\int_0^L u'(x)^2 \\,dx\\right)^{1/2}$. The given bilinear forms are $a(u,v) = \\int_0^L u'(x)v'(x)\\,dx$ and $b(u,v) = \\int_0^L u(x)v(x)\\,dx$. In this notation, $a(u,u) = \\|u'\\|_{L^2(\\Omega)}^2$ and $b(u,u) = \\|u\\|_{L^2(\\Omega)}^2$.\n\nThe Poincaré inequality states that for any $u \\in H_0^1(\\Omega)$, there exists a constant $C_P > 0$ such that\n$$\n\\|u\\|_{L^2(\\Omega)} \\le C_P \\|u'\\|_{L^2(\\Omega)}.\n$$\nThe problem concerns the optimal (smallest) such constant, which is a property of the domain $\\Omega$. Squaring both sides of the inequality, we get\n$$\n\\|u\\|_{L^2(\\Omega)}^2 \\le C_P^2 \\|u'\\|_{L^2(\\Omega)}^2.\n$$\nUsing the bilinear forms, this is expressed as\n$$\nb(u,u) \\le C_P^2 a(u,u).\n$$\nFor any non-zero function $u \\in H_0^1(\\Omega)$, we have $a(u,u) > 0$. Thus, we can rearrange the inequality to\n$$\n\\frac{b(u,u)}{a(u,u)} \\le C_P^2,\n$$\nor, equivalently,\n$$\n\\frac{a(u,u)}{b(u,u)} \\ge \\frac{1}{C_P^2}.\n$$\nThe term $R(u) = a(u,u)/b(u,u)$ is the Rayleigh quotient. The first Dirichlet eigenvalue $\\lambda_1$ of the Laplacian operator is defined variationally as the minimum of this quotient over all admissible functions:\n$$\n\\lambda_1 = \\min_{u \\in H_0^1(\\Omega), u \\ne 0} R(u) = \\min_{u \\in H_0^1(\\Omega), u \\ne 0} \\frac{a(u,u)}{b(u,u)}.\n$$\nSince the inequality $R(u) \\ge 1/C_P^2$ must hold for all $u \\in H_0^1(\\Omega)$, it must also hold for the minimum value of $R(u)$. Therefore,\n$$\n\\lambda_1 \\ge \\frac{1}{C_P^2}.\n$$\nThe optimal (smallest) Poincaré constant $C_P$ is the one that makes the original inequality as tight as possible. This is achieved by taking the supremum over all non-zero $u$:\n$$\nC_P^2 = \\sup_{u \\in H_0^1(\\Omega), u \\ne 0} \\frac{\\|u\\|_{L^2(\\Omega)}^2}{\\|u'\\|_{L^2(\\Omega)}^2} = \\sup_{u \\in H_0^1(\\Omega), u \\ne 0} \\frac{b(u,u)}{a(u,u)}.\n$$\nThe supremum of the reciprocal of the Rayleigh quotient is the reciprocal of its infimum:\n$$\nC_P^2 = \\left( \\inf_{u \\in H_0^1(\\Omega), u \\ne 0} \\frac{a(u,u)}{b(u,u)} \\right)^{-1}.\n$$\nRecognizing the infimum as the first eigenvalue $\\lambda_1$, we arrive at the fundamental relationship:\n$$\nC_P^2 = \\frac{1}{\\lambda_1} \\implies C_P = \\frac{1}{\\sqrt{\\lambda_1}}.\n$$\nThe exact first eigenvalue for the one-dimensional Dirichlet problem $-u''=\\lambda u$ on $(0,L)$ is $\\lambda_1 = (\\pi/L)^2$. Therefore, the exact optimal Poincaré constant is:\n$$\nC_P^{\\mathrm{exact}} = \\frac{1}{\\sqrt{(\\pi/L)^2}} = \\frac{L}{\\pi}.\n$$\n\n**2. Bracketing the Poincaré Constant**\n\nThe relationship $C_P = 1/\\sqrt{\\lambda_1}$ shows that bounds on $\\lambda_1$ can be translated into bounds on $C_P$. Since $f(\\lambda) = 1/\\sqrt{\\lambda}$ is a monotonically decreasing function for $\\lambda > 0$, an upper bound on $\\lambda_1$ provides a lower bound on $C_P$, and a lower bound on $\\lambda_1$ provides an upper bound on $C_P$.\n\n**Conforming Finite Element Method (Lower bound for $C_P$)**:\nThe standard Finite Element Method with linear basis functions on a mesh of $\\Omega$ defines a finite-dimensional trial space $V_h$. The basis functions are constructed such that they satisfy the homogeneous Dirichlet boundary conditions, which means $V_h$ is a subspace of the infinite-dimensional space $H_0^1(\\Omega)$, i.e., $V_h \\subset H_0^1(\\Omega)$. The FEM approximation of the eigenvalue, $\\lambda_{\\mathrm{FEM}}$, is found by minimizing the Rayleigh quotient over this smaller space:\n$$\n\\lambda_{\\mathrm{FEM}} = \\min_{u_h \\in V_h, u_h \\ne 0} \\frac{a(u_h, u_h)}{b(u_h, u_h)}.\n$$\nAccording to the Rayleigh-Ritz principle (a consequence of the min-max theorem for eigenvalues), restricting the search space for the minimum of a functional can only increase the minimum value. Since $V_h \\subset H_0^1(\\Omega)$, it follows that:\n$$\n\\lambda_1 = \\min_{u \\in H_0^1(\\Omega)} R(u) \\le \\min_{u_h \\in V_h} R(u_h) = \\lambda_{\\mathrm{FEM}}.\n$$\nThus, the FEM eigenvalue provides an upper bound for the true eigenvalue, $\\lambda_1 \\le \\lambda_{\\mathrm{FEM}}$. Applying the function $f(\\lambda) = 1/\\sqrt{\\lambda}$ reverses the inequality:\n$$\nC_P^{\\mathrm{low}} = \\frac{1}{\\sqrt{\\lambda_{\\mathrm{FEM}}}} \\le \\frac{1}{\\sqrt{\\lambda_1}} = C_P.\n$$\nThis establishes the FEM-derived value as a lower bound for the Poincaré constant.\n\n**Finite Difference Method (Upper bound for $C_P$)**:\nThe standard second-order central difference discretization of the operator $-d^2/dx^2$ on a uniform grid with spacing $h=L/m$ leads to the matrix eigenvalue problem $A \\mathbf{u} = \\lambda \\mathbf{u}$, where $A = \\frac{1}{h^2}\\mathrm{tridiag}(-1, 2, -1)$ is an $(m-1) \\times (m-1)$ matrix. The eigenvalues of this specific matrix are known in closed form. The smallest eigenvalue is:\n$$\n\\lambda_{\\mathrm{FDM}} = \\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi}{2m}\\right).\n$$\nTo compare this with the true eigenvalue $\\lambda_1 = (\\pi/L)^2 = (\\pi/(mh))^2$, we can use the Taylor series expansion for $\\sin(x) = x - x^3/6 + O(x^5)$. For small $x = \\pi/(2m)$,\n$$\n\\sin^2\\left(\\frac{\\pi}{2m}\\right) \\approx \\left(\\frac{\\pi}{2m} - \\frac{1}{6}\\left(\\frac{\\pi}{2m}\\right)^3\\right)^2 \\approx \\left(\\frac{\\pi}{2m}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\pi}{2m}\\right)^4.\n$$\nSubstituting this into the expression for $\\lambda_{\\mathrm{FDM}}$:\n$$\n\\lambda_{\\mathrm{FDM}} = \\frac{4}{(L/m)^2} \\left( \\frac{\\pi^2}{4m^2} - \\frac{\\pi^4}{48m^4} + O(m^{-6})\\right) = \\frac{\\pi^2}{L^2} - \\frac{\\pi^4}{12m^2L^2} + O(h^4) = \\lambda_1 - O(h^2).\n$$\nThis analysis shows that for sufficiently fine meshes (small $h$), the FDM approximation underestimates the true eigenvalue, $\\lambda_{\\mathrm{FDM}} \\le \\lambda_1$. In fact, this inequality holds for all $m \\ge 2$. Thus, the FDM eigenvalue provides a lower bound for the true eigenvalue. Applying the function $f(\\lambda) = 1/\\sqrt{\\lambda}$ reverses the inequality:\n$$\nC_P^{\\mathrm{up}} = \\frac{1}{\\sqrt{\\lambda_{\\mathrm{FDM}}}} \\ge \\frac{1}{\\sqrt{\\lambda_1}} = C_P.\n$$\nThis establishes the FDM-derived value as an upper bound for the Poincaré constant. Combining these results, we obtain the desired bracket for the optimal Poincaré constant:\n$$\nC_P^{\\mathrm{low}} \\le C_P^{\\mathrm{exact}} \\le C_P^{\\mathrm{up}}.\n$$\n\n**3. Numerical Implementation Plan**\n\nFor each test case $(L, m)$, the program will:\n1.  Define the mesh size $h=L/m$ and the number of interior nodes $n=m-1$.\n2.  Assemble the $(m-1) \\times (m-1)$ global stiffness matrix $K = \\frac{1}{h} \\mathrm{tridiag}(-1, 2, -1)$ and mass matrix $M = \\frac{h}{6} \\mathrm{tridiag}(1, 4, 1)$.\n3.  Solve the generalized eigenvalue problem $K\\mathbf{v} = \\lambda M\\mathbf{v}$ using a numerically stable solver, such as `scipy.linalg.eigh`, which is suitable for symmetric matrices. The smallest eigenvalue returned is $\\lambda_{\\mathrm{FEM}}$.\n4.  Compute $\\lambda_{\\mathrm{FDM}}$ directly using the formula $\\lambda_{\\mathrm{FDM}} = \\frac{4}{h^2} \\sin^2(\\frac{\\pi}{2m})$.\n5.  Calculate the bounds $C_P^{\\mathrm{low}} = 1/\\sqrt{\\lambda_{\\mathrm{FEM}}}$ and $C_P^{\\mathrm{up}} = 1/\\sqrt{\\lambda_{\\mathrm{FDM}}}$.\n6.  Compute the exact value $C_P^{\\mathrm{exact}} = L/\\pi$ and the bracket width $C_P^{\\mathrm{up}} - C_P^{\\mathrm{low}}$.\n7.  Store these four values in a list for the current test case.\n8.  After iterating through all test cases, format the results into the specified string format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Computes lower and upper bounds for the Poincaré constant C_P on the interval (0,L)\n    using FEM and FDM eigenvalue approximations, respectively.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 2),\n        (1.0, 10),\n        (2.0, 20),\n        (0.5, 50),\n    ]\n\n    results = []\n    for L, m in test_cases:\n        # 0. Basic parameters\n        h = L / m\n        n = m - 1  # Number of interior nodes / dimension of matrices\n\n        # 1. Assemble the FEM stiffness (K) and mass (M) matrices for linear elements.\n        # This implementation works for n=1 (m=2) and n>1.\n        # For n=1, the off_diag arrays are empty and np.diag handles this correctly.\n        if n > 0:\n            diag_K = np.full(n, 2.0 / h)\n            off_diag_K = np.full(n - 1, -1.0 / h)\n            K = np.diag(diag_K) + np.diag(off_diag_K, k=1) + np.diag(off_diag_K, k=-1)\n    \n            diag_M = np.full(n, 4.0 * h / 6.0)\n            off_diag_M = np.full(n - 1, 1.0 * h / 6.0)\n            M = np.diag(diag_M) + np.diag(off_diag_M, k=1) + np.diag(off_diag_M, k=-1)\n        else:\n            # This case (m=1) is not in the test suite and would be an error.\n            # Continue to avoid crashing on unexpected m.\n            continue\n\n        # 2. Compute the smallest generalized FEM eigenvalue lambda_FEM of (K, M).\n        # We use eigh as K, M are symmetric and M is positive definite.\n        eigenvalues_fem = eigh(K, M, eigvals_only=True)\n        lambda_fem = eigenvalues_fem[0]\n\n        # 3. Compute the smallest FDM eigenvalue lambda_FDM.\n        # This has a closed-form expression.\n        lambda_fdm = (4.0 / h**2) * (np.sin(np.pi / (2.0 * m))**2)\n\n        # 4. Convert eigenvalue approximations into bounds on C_P.\n        # The true eigenvalue lambda_1 = (pi/L)^2 is bracketed:\n        # lambda_fdm = lambda_1 = lambda_fem\n        # Since C_P = 1/sqrt(lambda), the inequality for C_P is reversed:\n        # 1/sqrt(lambda_fem) = C_P = 1/sqrt(lambda_fdm)\n        cp_low = 1.0 / np.sqrt(lambda_fem)\n        cp_up = 1.0 / np.sqrt(lambda_fdm)\n        \n        # For reference, compute the exact Poincaré constant.\n        cp_exact = L / np.pi\n        \n        # Compute the width of the computed bracket.\n        bracket_width = cp_up - cp_low\n        \n        # Aggregate results for this case.\n        case_result = [cp_low, cp_up, cp_exact, bracket_width]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # [ [val1,val2,...], [val1,val2,...] ]\n    # We build the string representation manually for precise formatting control.\n    result_strings = []\n    for sublist in results:\n        # Format each number and join with commas, then enclose in brackets.\n        formatted_sublist = f'[{\",\".join(map(str, sublist))}]'\n        result_strings.append(formatted_sublist)\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        }
    ]
}