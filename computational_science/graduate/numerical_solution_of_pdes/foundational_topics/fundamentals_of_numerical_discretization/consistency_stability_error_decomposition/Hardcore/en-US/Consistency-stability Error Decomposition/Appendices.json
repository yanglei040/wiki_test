{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we address a common task in computational science: selecting the most effective numerical scheme for a given problem. This exercise  challenges you to evaluate several popular methods for the linear advection equation. Your goal is to determine which scheme promises the highest accuracy in the long run by analyzing the fundamental trade-off between consistency (the order of accuracy) and stability, the essential prerequisite for any meaningful computation.",
            "id": "3373618",
            "problem": "Consider the linear advection partial differential equation $u_t + a u_x = 0$ with constant advection speed $a  0$ on the periodic domain $x \\in [0, 2\\pi]$, with smooth initial data $u(x, 0) = u_0(x)$ such that all derivatives up to order $4$ are bounded. Let the spatial grid be $x_j = j h$ for integer $j$ and fixed spacing $h = 2\\pi/M$, and the time grid be $t^n = n k$ for integer $n$ and time step $k  0$. Denote the Courant number by $\\lambda = k/h$, and suppose $T  0$ is a fixed final time. Throughout, assume zero discrete initial error by initializing $u_j^0 = u_0(x_j)$.\n\nYou are asked to select a numerical time-stepping design for evolving the grid values $u_j^n \\approx u(x_j, t^n)$ from $t^n$ to $t^{n+1}$ under an explicit constraint $k = \\lambda h$ with constant $\\lambda$ chosen to satisfy the Courant–Friedrichs–Lewy (CFL) condition appropriate to each scheme. The four candidate designs are:\n\nA. Forward Euler time with first-order upwind space:\n$u_j^{n+1} = u_j^n - \\lambda a \\left(u_j^n - u_{j-1}^n\\right)$.\n\nB. Forward Euler time with second-order centered space (forward-time centered-space):\n$u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2}$.\n\nC. Lax–Wendroff (second order in both time and space):\n$u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\frac{\\lambda^2 a^2}{2} \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$.\n\nD. Forward Euler time with second-order centered space and an artificial viscosity term scaled by $\\nu  0$:\n$u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\nu \\lambda \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$.\n\nYou must decide which design minimizes, as $h \\to 0$, the asymptotic upper bound on the global $L^2$ error at the fixed final time $T$ under the following framework rooted in first principles:\n\n- Consistency is defined by the local truncation error $\\tau_j^n$ obtained by substituting the exact solution into the scheme; $\\tau_j^n \\to 0$ as $k \\to 0$ and $h \\to 0$ indicates consistency.\n- Stability is defined by the existence of a uniform-in-$n$ bound in an appropriate norm for solutions of the homogeneous discrete evolution (e.g., via von Neumann analysis for periodic linear constant-coefficient problems).\n- The error decomposition for linear schemes on periodic grids yields an error evolution of the form $e^{n+1} = G e^n + k \\tau^n$ where $G$ is the discrete evolution operator of the homogeneous scheme, implying under stability that $\\|e^N\\| \\le C \\sum_{n=0}^{N-1} k \\|\\tau^n\\|$ for $N$ such that $N k = T$, with $C$ independent of $h$ and $k$.\n\nAssume that, for each scheme, the CFL condition is enforced by choosing $\\lambda$ so that the scheme is stable. Among designs A–D, which one yields the smallest asymptotic upper bound on the global $L^2$ error at time $T$ as $h \\to 0$ under the coupling $k = \\lambda h$ and the above consistency–stability error decomposition?\n\nChoose one:\n\nA. Design A.\n\nB. Design B.\n\nC. Design C.\n\nD. Design D.",
            "solution": "The user wants to identify which of the four given numerical schemes for the linear advection equation, $u_t + a u_x = 0$, minimizes the asymptotic upper bound on the global $L^2$ error at a fixed final time $T$.\n\nThe problem states a framework for assessing the global error, $\\|e^N\\|$, based on the local truncation error, $\\tau^n$. Specifically, for a stable scheme, the global error at the final time $T=Nk$ is bounded by $\\|e^N\\| \\le C \\sum_{n=0}^{N-1} k \\|\\tau^n\\|$, where $C$ is a constant independent of the mesh sizes $h$ and $k$. Since the number of time steps $N = T/k$, this bound can be expressed as $\\|e^N\\| \\le C k \\cdot N \\cdot \\max_n \\|\\tau^n\\| = C T \\max_n \\|\\tau^n\\|$. Therefore, to minimize the asymptotic upper bound on the global error as $h \\to 0$ with the coupling $k = \\lambda h$, we must find the scheme for which the local truncation error, $\\tau$, vanishes at the highest rate. This is equivalent to finding the scheme with the highest order of accuracy.\n\nThe local truncation error $\\tau_j^n$ for a scheme written in the form $\\mathcal{L}_h(u_j^n) = 0$ is defined by substituting the exact solution $u(x,t)$ into the scheme: $\\tau_j^n = \\mathcal{L}_h(u(x_j, t^n))$. We determine the order of accuracy by finding integers $p$ and $q$ such that $\\tau_j^n = O(h^p) + O(k^q)$. With $k = \\lambda h$, the overall order of the truncation error is $O(h^{\\min(p, q)})$. A higher order implies a faster convergence to the exact solution as $h \\to 0$.\n\nWe will analyze each scheme for its stability and order of accuracy. For the truncation error analysis, we use Taylor series expansions of the exact solution $u(x,t)$ around the point $(x_j, t^n)$. The exact solution satisfies $u_t = -a u_x$, which implies higher-order derivatives such as $u_{tt} = a^2 u_{xx}$ and $u_{ttt} = -a^3 u_{xxx}$. The expansion for the exact solution at the next time step is:\n$$u(x_j, t^{n+1}) = u(x_j, t^n+k) = u - ak u_x + \\frac{a^2k^2}{2} u_{xx} - \\frac{a^3 k^3}{6} u_{xxx} + O(k^4)$$\nAll derivatives are evaluated at $(x_j, t^n)$.\n\nThe local truncation error for a one-step scheme $u_j^{n+1} = \\mathcal{F}(u^n)_j$ is given by $k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}(u(\\cdot, t^n))_j$.\n\n**A. Forward Euler time with first-order upwind space**\nThe scheme is $u_j^{n+1} = u_j^n - \\lambda a \\left(u_j^n - u_{j-1}^n\\right)$.\nThe right-hand side (RHS) applied to the exact solution is:\n$$ \\mathcal{F}_A(u)_j = u(x_j, t^n) - \\frac{k a}{h} \\left( u(x_j, t^n) - u(x_{j-1}, t^n) \\right) $$\n$$ = u - \\frac{ka}{h} \\left( u - (u - h u_x + \\frac{h^2}{2} u_{xx} - O(h^3)) \\right) $$\n$$ = u - \\frac{ka}{h} \\left( h u_x - \\frac{h^2}{2} u_{xx} + O(h^3) \\right) $$\n$$ = u - ak u_x + \\frac{ak h}{2} u_{xx} + O(kh^2) $$\nThe truncation error is determined by:\n$$ k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}_A(u)_j = \\left( u - ak u_x + \\frac{a^2k^2}{2} u_{xx} + O(k^3) \\right) - \\left( u - ak u_x + \\frac{akh}{2} u_{xx} + O(kh^2) \\right) $$\n$$ k\\tau_j^n = \\left(\\frac{a^2k^2}{2} - \\frac{akh}{2}\\right) u_{xx} + O(k^3, kh^2) $$\n$$ \\tau_j^n = \\left(\\frac{a^2k}{2} - \\frac{ah}{2}\\right) u_{xx} + O(k^2, h^2) $$\nWith $k = \\lambda h$, this becomes $\\tau_j^n = \\frac{ah}{2} (a\\lambda - 1) u_{xx} + O(h^2)$. The scheme is first-order accurate, $\\tau_j^n = O(h,k) = O(h)$. The global error is therefore $O(h)$. Von Neumann analysis shows this scheme is stable for $0  a\\lambda \\le 1$.\n\n**B. Forward Euler time with second-order centered space (FTCS)**\nThe scheme is $u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2}$.\nTo check for stability, we perform a von Neumann analysis by substituting $u_j^n = g(\\xi)^n e^{i \\xi x_j}$, where $g(\\xi)$ is the amplification factor for the mode with wavenumber $\\xi$.\n$$ g = 1 - \\frac{\\lambda a}{2} \\left( e^{i \\xi h} - e^{-i \\xi h} \\right) = 1 - i \\lambda a \\sin(\\xi h) $$\nThe magnitude of the amplification factor is:\n$$ |g|^2 = 1^2 + (-\\lambda a \\sin(\\xi h))^2 = 1 + (\\lambda a \\sin(\\xi h))^2 $$\nFor any $\\lambda  0$, $a  0$, and $\\xi h$ not a multiple of $\\pi$, we have $|g|^2  1$. The scheme is therefore unconditionally unstable for the pure advection equation. The problem framework requires stability for the error bound to hold. As this scheme cannot be stabilized for any choice of $\\lambda  0$, it is not a viable candidate.\n\n**C. Lax–Wendroff**\nThe scheme is $u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\frac{\\lambda^2 a^2}{2} \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$.\nThis scheme is constructed to be second-order in both time and space. Let's verify the truncation error.\nThe RHS applied to the exact solution is:\n$$ \\mathcal{F}_C(u)_j = u - \\frac{ka}{2h}\\left( (u+hu_x+\\frac{h^2}{2}u_{xx}+\\frac{h^3}{6}u_{xxx}) - (u-hu_x+\\frac{h^2}{2}u_{xx}-\\frac{h^3}{6}u_{xxx}) + O(h^5) \\right) + \\frac{k^2 a^2}{2h^2}\\left( (u+hu_x+\\frac{h^2}{2}u_{xx}) - 2u + (u-hu_x+\\frac{h^2}{2}u_{xx}) + O(h^4) \\right) $$\n$$ \\mathcal{F}_C(u)_j = u - \\frac{ka}{2h}(2hu_x + \\frac{h^3}{3}u_{xxx} + O(h^5)) + \\frac{k^2 a^2}{2h^2}(h^2 u_{xx} + O(h^4)) $$\n$$ \\mathcal{F}_C(u)_j = u - ak u_x + \\frac{k^2 a^2}{2}u_{xx} - \\frac{ak h^2}{6}u_{xxx} + O(kh^4, k^2h^2) $$\nThe truncation error is determined by:\n$$ k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}_C(u)_j $$\n$$ k\\tau_j^n = \\left( u - ak u_x + \\frac{a^2k^2}{2} u_{xx} - \\frac{a^3 k^3}{6} u_{xxx} + O(k^4) \\right) - \\left( u - ak u_x + \\frac{k^2 a^2}{2}u_{xx} - \\frac{ak h^2}{6}u_{xxx} + O(kh^4, k^2h^2) \\right) $$\n$$ k\\tau_j^n = \\left( \\frac{akh^2}{6} - \\frac{a^3k^3}{6} \\right) u_{xxx} + \\dots $$\n$$ \\tau_j^n = \\left( \\frac{ah^2}{6} - \\frac{a^3k^2}{6} \\right) u_{xxx} + \\dots = O(h^2, k^2) $$\nWith $k = \\lambda h$, this becomes $\\tau_j^n = \\frac{ah^2}{6}(1 - (a\\lambda)^2)u_{xxx} + O(h^3)$. The scheme is second-order accurate, $\\tau_j^n = O(h^2)$. The global error is $O(h^2)$. Von Neumann analysis confirms the scheme is stable for $|a\\lambda| \\le 1$.\n\n**D. Forward Euler time with second-order centered space and an artificial viscosity term**\nThe scheme is $u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\nu \\lambda \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$. This is the FTCS scheme with an added term. The added term is a discrete approximation of $\\nu h k/h \\cdot u_{xx} = \\nu k h u_{xx}$ after multiplying the scheme by $h/k$. The modified PDE this scheme approximates is $u_t + a u_x = \\nu h u_{xx}$.\nLet's find the truncation error:\nThe RHS applied to the exact solution is the sum of the RHS from FTCS and the viscosity term.\n$$ \\mathcal{F}_D(u)_j = (u - ak u_x - \\frac{akh^2}{6} u_{xxx} + \\dots) + \\frac{\\nu k}{h}(h^2 u_{xx} + O(h^4)) $$\n$$ \\mathcal{F}_D(u)_j = u - ak u_x + \\nu kh u_{xx} - \\frac{akh^2}{6}u_{xxx} + \\dots $$\nThe truncation error is determined by:\n$$ k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}_D(u)_j $$\n$$ k\\tau_j^n = \\left( u - ak u_x + \\frac{a^2k^2}{2} u_{xx} + \\dots \\right) - \\left( u - ak u_x + \\nu kh u_{xx} + \\dots \\right) $$\n$$ k\\tau_j^n = \\left(\\frac{a^2k^2}{2} - \\nu kh \\right) u_{xx} + O(kh^2, k^3) $$\n$$ \\tau_j^n = \\left(\\frac{a^2k}{2} - \\nu h \\right) u_{xx} + O(h^2, k^2) $$\nWith $k = \\lambda h$, this is $\\tau_j^n = h \\left(\\frac{a^2\\lambda}{2} - \\nu \\right) u_{xx} + O(h^2)$.\nSince $\\nu  0$ is a given constant, this scheme is generally first-order, $\\tau_j^n = O(h)$, unless the special condition $\\nu = a^2\\lambda/2$ is met, which is not assumed. The global error is $O(h)$. The added viscosity term stabilizes the FTCS scheme; stability requires choosing $\\lambda$ such that $\\lambda \\le 1/(2\\nu)$ and $\\lambda a^2 \\le 2\\nu$.\n\n**Conclusion**\n\nLet's compare the orders of the global error for the stable schemes, as $h \\to 0$:\n-   Scheme A: $O(h)$\n-   Scheme B: Unstable, hence not usable.\n-   Scheme C: $O(h^2)$\n-   Scheme D: $O(h)$\n\nThe global error for Scheme C decreases with $h^2$, which is asymptotically much faster than the $O(h)$ decrease for Schemes A and D. Therefore, as $h \\to 0$, Scheme C (Lax-Wendroff) will yield the smallest error.\n\nFinal option-by-option analysis:\n- A. Incorrect. This scheme is first-order, $O(h)$, which is less accurate than scheme C.\n- B. Incorrect. This scheme is unconditionally unstable and cannot produce a meaningful solution.\n- C. Correct. This scheme is second-order, $O(h^2)$, providing the fastest asymptotic error reduction among the choices.\n- D. Incorrect. This scheme is first-order, $O(h)$, which is less accurate than scheme C.\n\nHence, the Lax-Wendroff design is the one that minimizes the asymptotic upper bound on the global error.",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "Having established how to compare schemes, we now deepen our analytical skills by moving from estimating the order of the error to calculating its precise value. In this practice , you will perform a detailed error decomposition for a parabolic equation, the heat equation, discretized with the backward Euler method. By meticulously tracking the error contributions from both space and time discretizations, you will derive the leading-order coefficient of the global error, revealing exactly how the numerical parameters influence accuracy.",
            "id": "3373628",
            "problem": "Consider the linear parabolic partial differential equation (PDE) $u_{t} = -A u$ on the spatial interval $(0,1)$ with homogeneous Dirichlet boundary conditions, where $A = -\\Delta$ is the positive Dirichlet Laplacian. Let the exact initial condition be $u_{0}(x) = \\sin(\\pi x)$. The exact solution satisfies $u(x,t) = a(t)\\sin(\\pi x)$ with a scalar amplitude $a(t)$ solving $a^{\\prime}(t) = -\\lambda a(t)$ and $\\lambda = \\pi^{2}$.\n\nDiscretize space using the standard second-order central difference approximation of $A$ on a uniform grid with spacing $h = \\frac{1}{N+1}$ and $N$ interior points, yielding a symmetric positive semidefinite matrix $A_{h} \\in \\mathbb{R}^{N \\times N}$. Discretize time using backward Euler with step size $k  0$, so that the fully discrete scheme is $(I + k A_{h}) u_{h}^{n+1} = u_{h}^{n}$ for $n \\geq 0$, with $u_{h}^{0}$ obtained by sampling $u_{0}$ at the grid points. Let $T  0$ be a fixed final time and $N_{t} = \\frac{T}{k} \\in \\mathbb{N}$ the number of time steps.\n\nStarting from fundamental definitions, perform a consistency-stability error decomposition. Use resolvent-based stability for backward Euler, i.e., analyze the discrete propagator $(I + k A_{h})^{-1}$ via its resolvent properties, and derive the global-in-time error at the grid points as the time $T$ is reached. Focus on the specific initial data $u_{0}(x) = \\sin(\\pi x)$ so that the discrete solution evolves on the grid in the discrete sine mode aligned with the continuous mode. Impose the coupled refinement $k = \\alpha h^{2}$ for a fixed parameter $\\alpha  0$, and consider the asymptotic regime $h \\to 0$ with $T$ fixed.\n\nYour task is to compute the leading-order coefficient $C(\\alpha, T)$ in the asymptotic expansion of the grid-point amplitude error at time $T$,\n$$\nE(T;h,k) = \\text{(discrete amplitude at time $T$)} - \\text{(exact amplitude at time $T$)} = C(\\alpha,T)\\, h^{2} + \\mathcal{O}(h^{4}),\n$$\nunder the coupling $k = \\alpha h^{2}$. Express the final answer as a closed-form analytic expression in terms of $\\alpha$ and $T$. No rounding is required and no units should be included in your answer.",
            "solution": "The user wants a detailed derivation of the leading-order coefficient in the asymptotic expansion of the grid-point amplitude error for a numerical solution to a linear parabolic partial differential equation.\n\nThe problem is validated as follows:\n- **Givens**:\n    - PDE: $u_{t} = -A u$ for $x \\in (0,1)$, with $A = -\\Delta = -\\partial_{xx}$ (positive Dirichlet Laplacian).\n    - Boundary Conditions (BC): Homogeneous Dirichlet, $u(0,t) = u(1,t) = 0$.\n    - Initial Condition (IC): $u_{0}(x) = \\sin(\\pi x)$.\n    - Exact Solution Form: $u(x,t) = a(t)\\sin(\\pi x)$.\n    - Exact Amplitude ODE: $a^{\\prime}(t) = -\\lambda a(t)$ with $\\lambda = \\pi^{2}$ and $a(0)=1$.\n    - Spatial Discretization: Standard second-order central difference on a uniform grid $x_j=jh$ for $j=1, \\dots, N$, with spacing $h = \\frac{1}{N+1}$. Let the discrete operator be $A_h$.\n    - Time Discretization: Backward Euler with step size $k  0$.\n    - Fully Discrete Scheme: $(I + k A_{h}) u_{h}^{n+1} = u_{h}^{n}$.\n    - Discrete Initial Condition: $u_{h}^{0}$ is the projection of $u_0(x)$ onto the grid.\n    - Asymptotic Coupling: $k = \\alpha h^{2}$ for fixed $\\alpha  0$.\n    - Final Time: $T  0$.\n    - Target Quantity: The coefficient $C(\\alpha, T)$ in the expansion of the amplitude error at time $T$: $E(T;h,k) = \\text{discrete amplitude} - \\text{exact amplitude} = C(\\alpha,T) h^{2} + \\mathcal{O}(h^{4})$.\n- **Validation Verdict**: The problem is scientifically grounded, well-posed, objective, and complete. It is a standard exercise in the numerical analysis of partial differential equations, specifically concerning the analysis of global error by decomposing it into spatial and temporal components (consistency and stability). The problem is valid.\n\nWe proceed with the solution.\n\nFirst, we determine the exact amplitude of the continuous solution. The initial condition $u_{0}(x) = \\sin(\\pi x)$ is the first eigenfunction of the operator $A = -\\partial_{xx}$ on $(0,1)$ with homogeneous Dirichlet boundary conditions. The corresponding eigenvalue is $\\lambda_1 = \\pi^{2}$. The solution to the PDE is therefore $u(x,t) = e^{-\\lambda_1 t} u_0(x) = e^{-\\pi^2 t} \\sin(\\pi x)$. By comparing this to the given form $u(x,t) = a(t)\\sin(\\pi x)$, we identify the exact amplitude function as $a(t) = e^{-\\pi^2 t}$. At the final time $T$, the exact amplitude is $a(T) = \\exp(-\\pi^{2} T)$.\n\nNext, we analyze the discrete problem. The spatial domain is discretized by $N$ interior grid points $x_j = j h$ for $j=1, \\dots, N$, with grid spacing $h = \\frac{1}{N+1}$. The second-order central difference approximation to $A = -\\partial_{xx}$ is the matrix $A_h$, whose action on a grid function $v$ is given by $(A_h v)_j = \\frac{-v_{j-1} + 2v_j - v_{j+1}}{h^2}$. The eigenvectors of this matrix $A_h$ are the discrete sine functions $v_j$ with components $(v_j)_m = \\sin(j \\pi x_m) = \\sin(j \\pi m h)$ for $m=1, \\dots, N$. The initial condition $u_0(x) = \\sin(\\pi x)$ when sampled on the grid gives the vector $u_h^0$ with components $(u_h^0)_m = \\sin(\\pi x_m) = \\sin(\\pi m h)$. This is precisely the first discrete eigenvector $v_1$ of $A_h$.\n\nThe eigenvalue $\\lambda_{1,h}$ of $A_h$ corresponding to the eigenvector $v_1$ is found by applying $A_h$ to $v_1$:\n$$ (A_h v_1)_m = \\frac{-\\sin(\\pi(m-1)h) + 2\\sin(\\pi m h) - \\sin(\\pi(m+1)h)}{h^2} $$\nUsing the trigonometric identity $\\sin(a-b) + \\sin(a+b) = 2\\sin(a)\\cos(b)$, we get\n$$ (A_h v_1)_m = \\frac{2\\sin(\\pi m h) - 2\\sin(\\pi m h)\\cos(\\pi h)}{h^2} = \\left(\\frac{2(1 - \\cos(\\pi h))}{h^2}\\right) \\sin(\\pi m h) $$\nThus, the discrete eigenvalue is $\\lambda_{1,h} = \\frac{2(1 - \\cos(\\pi h))}{h^2}$.\n\nThe fully discrete scheme evolves according to $u_h^{n+1} = (I + k A_h)^{-1} u_h^n$. Since the initial data $u_h^0$ is an eigenvector of $A_h$, the solution at any time step $n$ remains in the direction of this eigenvector:\n$u_h^n = ((I+kA_h)^{-1})^n u_h^0$. The corresponding eigenvalue of the propagator $(I+kA_h)^{-1}$ is $(1+k\\lambda_{1,h})^{-1}$. Therefore, the discrete solution is $u_h^n = (1+k\\lambda_{1,h})^{-n} u_h^0$. The discrete amplitude at time step $n$ is $a_h^n = (1+k\\lambda_{1,h})^{-n}$. At the final time $T$, with $n = N_t = T/k$, the discrete amplitude is $a_h(T) = (1+k\\lambda_{1,h})^{-T/k}$.\n\nTo find the error, we perform an asymptotic analysis for $h \\to 0$. We begin by expanding the discrete eigenvalue $\\lambda_{1,h}$ in powers of $h$. Using the Taylor series for cosine, $\\cos(x) = 1 - \\frac{x^2}{2!} + \\frac{x^4}{4!} - \\mathcal{O}(x^6)$:\n$$ \\lambda_{1,h} = \\frac{2}{h^2} \\left(1 - \\left(1 - \\frac{(\\pi h)^2}{2} + \\frac{(\\pi h)^4}{24} - \\mathcal{O}(h^6)\\right)\\right) = \\frac{2}{h^2} \\left(\\frac{\\pi^2 h^2}{2} - \\frac{\\pi^4 h^4}{24} + \\mathcal{O}(h^6)\\right) $$\n$$ \\lambda_{1,h} = \\pi^2 - \\frac{\\pi^4}{12} h^2 + \\mathcal{O}(h^4) $$\nThis shows that the spatial discretization introduces an error of order $\\mathcal{O}(h^2)$ in the eigenvalue, which is expected for a second-order method.\n\nNow we analyze the discrete amplitude $a_h(T)$. It is convenient to work with the logarithm:\n$$ \\ln(a_h(T)) = \\ln\\left((1+k\\lambda_{1,h})^{-T/k}\\right) = -\\frac{T}{k} \\ln(1+k\\lambda_{1,h}) $$\nUsing the Taylor series for the logarithm, $\\ln(1+x) = x - \\frac{x^2}{2} + \\mathcal{O}(x^3)$:\n$$ \\ln(a_h(T)) = -\\frac{T}{k} \\left( k\\lambda_{1,h} - \\frac{(k\\lambda_{1,h})^2}{2} + \\mathcal{O}(k^3) \\right) = -T\\lambda_{1,h} + \\frac{T}{2}k\\lambda_{1,h}^2 + \\mathcal{O}(T k^2) $$\nNow, we substitute the expansion for $\\lambda_{1,h}$ and the coupled refinement condition $k=\\alpha h^2$:\n$$ \\ln(a_h(T)) = -T\\left(\\pi^2 - \\frac{\\pi^4}{12} h^2 + \\mathcal{O}(h^4)\\right) + \\frac{T}{2}(\\alpha h^2)\\left(\\pi^2 - \\frac{\\pi^4}{12} h^2 + \\mathcal{O}(h^4)\\right)^2 + \\mathcal{O}(h^4) $$\nWe only need to keep terms up to $\\mathcal{O}(h^2)$:\n$$ \\ln(a_h(T)) = -T\\pi^2 + T\\frac{\\pi^4}{12} h^2 + \\frac{T\\alpha h^2}{2}(\\pi^2)^2 + \\mathcal{O}(h^4) $$\n$$ \\ln(a_h(T)) = -T\\pi^2 + \\left(T\\frac{\\pi^4}{12} + T\\frac{\\alpha\\pi^4}{2}\\right)h^2 + \\mathcal{O}(h^4) $$\n$$ \\ln(a_h(T)) = -T\\pi^2 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) $$\nExponentiating both sides gives the asymptotic expansion for $a_h(T)$:\n$$ a_h(T) = \\exp\\left(-T\\pi^2 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4)\\right) $$\n$$ a_h(T) = \\exp(-T\\pi^2) \\exp\\left(T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4)\\right) $$\nUsing the expansion $\\exp(x) = 1 + x + \\mathcal{O}(x^2)$ for small $x$:\n$$ a_h(T) = \\exp(-T\\pi^2) \\left[ 1 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) \\right] $$\nThe amplitude error at time $T$ is $E(T;h,k) = a_h(T) - a(T)$. Since $a(T) = \\exp(-\\pi^2 T)$:\n$$ E(T;h,k) = \\exp(-T\\pi^2)\\left[ 1 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) \\right] - \\exp(-T\\pi^2) $$\n$$ E(T;h,k) = \\exp(-T\\pi^2) T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) $$\nBy comparing this with the required form $E(T;h,k) = C(\\alpha,T) h^{2} + \\mathcal{O}(h^{4})$, we identify the leading-order error coefficient:\n$$ C(\\alpha,T) = \\exp(-T\\pi^2) T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right) $$\nThis expression can be simplified by finding a common denominator:\n$$ C(\\alpha,T) = T\\pi^4\\left(\\frac{1 + 6\\alpha}{12}\\right)\\exp(-T\\pi^2) = \\frac{T \\pi^{4} (1 + 6\\alpha)}{12} \\exp(-\\pi^{2} T) $$\nThis result represents the combined leading-order error from the spatial discretization (the term proportional to $\\frac{1}{12}$) and the temporal discretization (the term proportional to $\\frac{\\alpha}{2}$).",
            "answer": "$$\\boxed{\\frac{T \\pi^{4} (1 + 6\\alpha)}{12} \\exp(-\\pi^{2} T)}$$"
        },
        {
            "introduction": "Our final practice demonstrates that a \"one-size-fits-all\" approach to error analysis is insufficient; the method must be adapted to the physics of the underlying equation. This problem  contrasts a dispersive PDE (the linear Schrödinger equation) with a parabolic one (the heat equation). You will discover how the choice of an appropriate norm for measuring error—an $L^2$ norm for the energy-conserving dispersive case versus an $H^1$ norm for the smoothing parabolic case—is critical for obtaining correct stability results and for optimally balancing spatial and temporal errors.",
            "id": "3373598",
            "problem": "Consider two linear Partial Differential Equations (PDEs) on the periodic domain $[0,2\\pi]$ with smooth initial data $u_{0}(x)$:\n\n- Dispersive case (linear Schrödinger): $u_{t} = i \\nu u_{xx}$ with real diffusivity parameter $\\nu0$.\n- Parabolic case (heat): $v_{t} = \\nu v_{xx}$ with the same $\\nu0$.\n\nLet $x_{j} = j h$ for $j=0,1,\\dots,N-1$ with mesh size $h = \\frac{2\\pi}{N}$, and time levels $t^{n} = n \\tau$ for time step $\\tau0$. Let $u^{n}_{j}$ and $v^{n}_{j}$ denote fully discrete approximations to $u(x_{j},t^{n})$ and $v(x_{j},t^{n})$, respectively. Use the second-order centered finite difference for the Laplacian,\n$$\n(\\Delta_{h} w)_{j} := \\frac{w_{j+1} - 2 w_{j} + w_{j-1}}{h^{2}},\n$$\nwith periodic indexing. Consider the following fully discrete schemes:\n\n1. Dispersive scheme (Crank–Nicolson in time):\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\tau} = i \\nu \\left( \\frac{(\\Delta_{h} u^{n+1})_{j} + (\\Delta_{h} u^{n})_{j}}{2} \\right).\n$$\n\n2. Parabolic scheme (Forward Euler in time):\n$$\n\\frac{v^{n+1}_{j} - v^{n}_{j}}{\\tau} = \\nu (\\Delta_{h} v^{n})_{j}.\n$$\n\nDefine the discrete $L^{2}$ norm and the discrete $H^{1}$ seminorm by\n$$\n\\|w\\|_{L^{2}_{h}}^{2} := h \\sum_{j=0}^{N-1} |w_{j}|^{2}, \n\\qquad \n|w|_{H^{1}_{h}}^{2} := h \\sum_{j=0}^{N-1} \\left| \\frac{w_{j+1} - w_{j}}{h} \\right|^{2}.\n$$\n\nAssume the exact solutions are sufficiently smooth so that all derivatives required below exist and remain bounded on $[0,2\\pi] \\times [0,T]$ for a fixed final time $T0$.\n\nWork within the consistency–stability error decomposition framework for linear schemes: the global error at time $T$ in an appropriate norm can be bounded by the stability operator norm times the accumulation of the local truncation errors. You may use the following well-tested facts as a starting point:\n\n- The centered finite difference Laplacian $\\Delta_{h}$ has a spatial consistency error of order $h^{2}$ in $L^{2}$ for smooth data.\n- Crank–Nicolson time discretization has local temporal consistency error of order $\\tau^{2}$.\n- Forward Euler time discretization has local temporal consistency error of order $\\tau$.\n- For the dispersive Schrödinger equation, the exact semigroup is unitary in $L^{2}$, and the Crank–Nicolson scheme for a skew-adjoint spatial discretization inherits a discrete $L^{2}$ stability bound with constant $1$.\n- For the heat equation, the exact semigroup is contractive in $L^{2}$; the Forward Euler scheme is linearly stable in $L^{2}$ provided a Courant–Friedrichs–Lewy (CFL) condition $\\tau \\leq \\frac{h^{2}}{2\\nu}$ holds. Under this same CFL restriction, the scheme is also stable in $| \\cdot |_{H^{1}_{h}}$ up to a constant independent of $h$ and $\\tau$.\n\nSuppose the time step is chosen as $\\tau = C h^{\\alpha}$ for some fixed constant $C0$ and exponent $\\alpha0$, with $C$ small enough that the CFL restriction is satisfied when it applies. Measure the global error at time $T$ in the discrete $L^{2}$ norm for the dispersive case, and in the discrete $H^{1}$ seminorm for the parabolic case.\n\nUsing only the consistency–stability error decomposition and the scalings above, determine the exponent $\\alpha$ that asymptotically balances the dominant contributions of spatial and temporal discretization errors for each PDE as $h \\to 0$. Express your final answer as a two-component row matrix, listing first the dispersive exponent and second the parabolic exponent. No rounding is required, and no physical units apply.",
            "solution": "The problem is assessed to be valid. It is a well-posed question in the field of numerical analysis for partial differential equations, built upon established scientific principles of consistency, stability, and convergence. The data and assumptions provided are complete, consistent, and standard for such an analysis.\n\nThe objective is to determine the exponent $\\alpha$ in the relation $\\tau = C h^{\\alpha}$ that balances the spatial and temporal discretization errors for two different numerical schemes. The analysis relies on the consistency–stability error decomposition framework, which states that for a stable linear scheme, the global error at a fixed final time $T$ is of the same order as the local truncation error (LTE). The total LTE is a sum of contributions from the spatial discretization and the temporal discretization. To achieve optimal accuracy, the orders of these contributions should be matched.\n\nWe will analyze each case separately.\n\nCase 1: Dispersive Equation (Linear Schrödinger)\n\nThe PDE is $u_{t} = i \\nu u_{xx}$. It is solved using the Crank–Nicolson scheme:\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\tau} = i \\nu \\left( \\frac{(\\Delta_{h} u^{n+1})_{j} + (\\Delta_{h} u^{n})_{j}}{2} \\right).\n$$\nThe global error is measured in the discrete $L^{2}$ norm, $\\| \\cdot \\|_{L^{2}_{h}}$. The problem states that this scheme is stable with a stability constant of $1$ in this norm, so the global error order matches the LTE order.\n\nThe LTE, $\\eta$, can be conceptually decomposed into a spatial component and a temporal component:\n$$\n\\eta = \\eta_{\\text{space}} + \\eta_{\\text{time}}.\n$$\nThe global error at a fixed time $T$ will be bounded by a term that scales with the sum of the norms of these components:\n$$\n\\|E(T)\\|_{L^{2}_{h}} \\le K \\left( \\|\\eta_{\\text{space}}\\|_{L^{2}_{h}} + \\|\\eta_{\\text{time}}\\|_{L^{2}_{h}} \\right),\n$$\nfor some constant $K$ that depends on $T$ but is independent of $h$ and $\\tau$.\n\nAccording to the problem statement:\n1.  The spatial discretization error, arising from approximating the Laplacian $u_{xx}$ by the centered finite difference operator $\\Delta_{h}$, has a consistency error of order $h^{2}$. This means $\\|\\eta_{\\text{space}}\\|_{L^{2}_{h}} = O(h^{2})$.\n2.  The temporal discretization error, arising from the Crank–Nicolson time-stepping method, has a local consistency error of order $\\tau^{2}$. This means $\\|\\eta_{\\text{time}}\\|_{L^{2}_{h}} = O(\\tau^{2})$.\n\nThe total global error at time $T$ therefore has an asymptotic behavior dominated by the larger of these two error terms:\n$$\n\\|E(T)\\|_{L^{2}_{h}} \\sim O(h^{2}) + O(\\tau^{2}).\n$$\nTo balance these error contributions for optimal convergence, we set their orders to be equal:\n$$\nh^{2} \\sim \\tau^{2}.\n$$\nSubstituting the given scaling relationship $\\tau = C h^{\\alpha}$ for some positive constants $C$ and $\\alpha$:\n$$\nh^{2} \\sim (C h^{\\alpha})^{2} = C^{2} h^{2\\alpha}.\n$$\nFor this scaling to hold as $h \\to 0$, the exponents of $h$ must be equal:\n$$\n2 = 2\\alpha.\n$$\nSolving for $\\alpha$ gives the exponent for the dispersive case:\n$$\n\\alpha_{\\text{dispersive}} = 1.\n$$\n\nCase 2: Parabolic Equation (Heat Equation)\n\nThe PDE is $v_{t} = \\nu v_{xx}$. It is solved using the Forward Euler scheme:\n$$\n\\frac{v^{n+1}_{j} - v^{n}_{j}}{\\tau} = \\nu (\\Delta_{h} v^{n})_{j}.\n$$\nThe global error is measured in the discrete $H^{1}$ seminorm, $| \\cdot |_{H^{1}_{h}}$. The problem states that this scheme is stable in this norm, provided the CFL condition $\\tau \\leq \\frac{h^{2}}{2\\nu}$ is met. This condition is assumed to hold. Therefore, the global error order in the $| \\cdot |_{H^{1}_{h}}$ norm is determined by the order of the LTE in the same norm.\n\nAs before, we consider the spatial and temporal contributions to the LTE, but now we must estimate their magnitudes in the $| \\cdot |_{H^{1}_{h}}$ seminorm.\n\n1.  Spatial error contribution: The LTE's spatial part is $\\eta_{\\text{space}} = \\nu (v_{xx} - \\Delta_{h} v)$. We are given that the consistency error of $\\Delta_{h}$ is $O(h^2)$ in the $L^2$ norm. We need to determine its order in the $H^1$ seminorm. The seminorm involves a discrete derivative. For sufficiently smooth functions, the act of differentiation does not alter the order of the spatial approximation error. More formally, let $D_h$ be the finite difference operator corresponding to the first derivative. Then $| \\eta_{\\text{space}} |_{H^{1}_{h}} = \\|D_h \\eta_{\\text{space}} \\|_{L^2_h}$. The operators $D_h$ and $\\Delta_h$ commute. The error operator $(\\partial_{xx} - \\Delta_h)$ acts as multiplication by an $O(h^2)$ term in the Fourier domain, and applying the first derivative operator does not change this order. Thus, the consistency error for sufficiently smooth solutions remains second-order in the $H^1$ seminorm: $| \\eta_{\\text{space}} |_{H^{1}_{h}} = O(h^{2})$.\n\n2.  Temporal error contribution: The LTE's temporal part arises from the first-order Forward Euler method. The problem states the local temporal consistency error is of order $\\tau$. The dominant term in the temporal LTE is $\\eta_{\\text{time}} \\approx \\frac{\\tau}{2} v_{tt}$. We need to find the order of this term in the $| \\cdot |_{H^{1}_{h}}$ norm.\n$$\n| \\eta_{\\text{time}} |_{H^{1}_{h}} \\approx \\left| \\frac{\\tau}{2} v_{tt} \\right|_{H^{1}_{h}} = \\frac{\\tau}{2} |v_{tt}|_{H^{1}_{h}}.\n$$\nSince the exact solution $v$ is assumed to be sufficiently smooth, its derivatives, including $v_{tt}$, are bounded functions. Consequently, $|v_{tt}|_{H^{1}_{h}}$ is a bounded quantity independent of $\\tau$ and $h$. Therefore, the temporal error contribution to the LTE in the $H^{1}$ seminorm is of order $\\tau$:\n$$\n| \\eta_{\\text{time}} |_{H^{1}_{h}} = O(\\tau).\n$$\nThe total global error at time $T$ measured in the $H^1$ seminorm is thus bounded by:\n$$\n|E(T)|_{H^{1}_{h}} \\sim O(h^{2}) + O(\\tau).\n$$\nTo balance these error contributions, we set their orders to be equal:\n$$\nh^{2} \\sim \\tau.\n$$\nUsing the scaling relationship $\\tau = C h^{\\alpha}$:\n$$\nh^{2} \\sim C h^{\\alpha}.\n$$\nEquating the exponents of $h$:\n$$\n2 = \\alpha.\n$$\nThis gives the exponent for the parabolic case:\n$$\n\\alpha_{\\text{parabolic}} = 2.\n$$\nThis choice is consistent with the CFL stability condition $\\tau \\leq \\frac{h^{2}}{2\\nu}$. Substituting $\\tau = C h^{2}$ gives $C h^{2} \\leq \\frac{h^{2}}{2\\nu}$, which simplifies to $C \\leq \\frac{1}{2\\nu}$. The problem states that $C$ is chosen small enough for the condition to hold, which is feasible.\n\nFinal Result:\nThe exponent for the dispersive case is $\\alpha=1$.\nThe exponent for the parabolic case is $\\alpha=2$.\nThe final answer is presented as a two-component row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2\n\\end{pmatrix}\n}\n$$"
        }
    ]
}