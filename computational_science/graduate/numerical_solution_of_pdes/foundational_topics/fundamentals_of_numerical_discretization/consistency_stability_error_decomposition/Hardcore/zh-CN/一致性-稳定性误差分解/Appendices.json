{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最好的巩固方式莫过于亲手实践。本节练习将通过一个经典的线性抛物型偏微分方程（热传导方程）的数值求解，引导你进行一次完整的“一致性-稳定性误差分解”定量分析。通过追踪一个特定的傅里叶模态的演化，你将精确地推导出总误差的主导项，从而清晰地看到空间离散误差与时间离散误差是如何共同决定全局精度的。这个练习旨在为你建立一个坚实的分析基础，让你深刻理解误差的来源与构成。",
            "id": "3373628",
            "problem": "考虑空间区间 $(0,1)$ 上的线性抛物型偏微分方程 (PDE) $u_{t} = -A u$，其边界条件为齐次狄利克雷边界条件，其中 $A = -\\Delta$ 是正定狄利克雷拉普拉斯算子。设精确初始条件为 $u_{0}(x) = \\sin(\\pi x)$。精确解满足 $u(x,t) = a(t)\\sin(\\pi x)$，其中标量振幅 $a(t)$ 求解 $a^{\\prime}(t) = -\\lambda a(t)$ 且 $\\lambda = \\pi^{2}$。\n\n使用 $A$ 的标准二阶中心差分近似在均匀网格上对空间进行离散化，该网格间距为 $h = \\frac{1}{N+1}$，有 $N$ 个内部点，从而得到一个对称半正定矩阵 $A_{h} \\in \\mathbb{R}^{N \\times N}$。使用步长为 $k  0$ 的后向欧拉法对时间进行离散化，因此全离散格式为 $(I + k A_{h}) u_{h}^{n+1} = u_{h}^{n}$，$n \\geq 0$，其中 $u_{h}^{0}$ 是通过在网格点上对 $u_{0}$ 采样得到的。设 $T  0$ 为一个固定的最终时间，$N_{t} = \\frac{T}{k} \\in \\mathbb{N}$ 为时间步数。\n\n从基本定义出发，进行相容性-稳定性误差分解。对后向欧拉法使用基于预解式的稳定性，即通过其预解式性质来分析离散传播子 $(I + k A_{h})^{-1}$，并推导在达到时间 $T$ 时网格点上的全局时间误差。关注特定的初始数据 $u_{0}(x) = \\sin(\\pi x)$，使得离散解在网格上以与连续模态对齐的离散正弦模态演化。对于固定的参数 $\\alpha  0$，施加耦合细化条件 $k = \\alpha h^{2}$，并考虑在 $T$ 固定时 $h \\to 0$ 的渐近状态。\n\n你的任务是计算在时间 $T$ 时网格点振幅误差的渐近展开中的领阶系数 $C(\\alpha, T)$，\n$$\nE(T;h,k) = \\text{(时间 $T$ 时的离散振幅)} - \\text{(时间 $T$ 时的精确振幅)} = C(\\alpha,T)\\, h^{2} + \\mathcal{O}(h^{4}),\n$$\n在耦合条件 $k = \\alpha h^{2}$ 下。将最终答案表示为关于 $\\alpha$ 和 $T$ 的闭式解析表达式。无需四舍五入，答案中不应包含任何单位。",
            "solution": "用户要求详细推导线性抛物型偏微分方程数值解的网格点振幅误差渐近展开中的领阶系数。\n\n问题验证如下：\n- **已知条件**：\n    - PDE：$u_{t} = -A u$，$x \\in (0,1)$，其中 $A = -\\Delta = -\\partial_{xx}$ (正定狄利克雷拉普拉斯算子)。\n    - 边界条件 (BC)：齐次狄利克雷，$u(0,t) = u(1,t) = 0$。\n    - 初始条件 (IC)：$u_{0}(x) = \\sin(\\pi x)$。\n    - 精确解形式：$u(x,t) = a(t)\\sin(\\pi x)$。\n    - 精确振幅常微分方程 (ODE)：$a^{\\prime}(t) = -\\lambda a(t)$，其中 $\\lambda = \\pi^{2}$ 且 $a(0)=1$。\n    - 空间离散化：在均匀网格 $x_j=jh$（$j=1, \\dots, N$）上采用标准二阶中心差分，间距为 $h = \\frac{1}{N+1}$。设离散算子为 $A_h$。\n    - 时间离散化：步长为 $k  0$ 的后向欧拉法。\n    - 全离散格式：$(I + k A_{h}) u_{h}^{n+1} = u_{h}^{n}$。\n    - 离散初始条件：$u_{h}^{0}$ 是 $u_0(x)$ 在网格上的投影。\n    - 渐近耦合：$k = \\alpha h^{2}$，对于固定的 $\\alpha  0$。\n    - 最终时间：$T  0$。\n    - 目标量：时间 $T$ 时振幅误差展开式中的系数 $C(\\alpha, T)$：$E(T;h,k) = \\text{离散振幅} - \\text{精确振幅} = C(\\alpha,T) h^{2} + \\mathcal{O}(h^{4})$。\n- **验证结论**：该问题具有科学依据、适定、客观且完整。这是偏微分方程数值分析中的一个标准练习，具体涉及通过将其分解为空间和时间分量（相容性和稳定性）来分析全局误差。该问题有效。\n\n我们开始求解。\n\n首先，我们确定连续解的精确振幅。初始条件 $u_{0}(x) = \\sin(\\pi x)$ 是在 $(0,1)$ 上带有齐次狄利克雷边界条件的算子 $A = -\\partial_{xx}$ 的第一个特征函数。对应的特征值为 $\\lambda_1 = \\pi^{2}$。因此，该偏微分方程的解为 $u(x,t) = e^{-\\lambda_1 t} u_0(x) = e^{-\\pi^2 t} \\sin(\\pi x)$。通过将其与给定形式 $u(x,t) = a(t)\\sin(\\pi x)$ 进行比较，我们确定精确振幅函数为 $a(t) = e^{-\\pi^2 t}$。在最终时间 $T$，精确振幅为 $a(T) = \\exp(-\\pi^{2} T)$。\n\n接下来，我们分析离散问题。空间域由 $N$ 个内部网格点 $x_j = j h$（$j=1, \\dots, N$）离散化，网格间距为 $h = \\frac{1}{N+1}$。$A = -\\partial_{xx}$ 的二阶中心差分近似是矩阵 $A_h$，其作用于网格函数 $v$ 的方式由 $(A_h v)_j = \\frac{-v_{j-1} + 2v_j - v_{j+1}}{h^2}$ 给出。该矩阵 $A_h$ 的特征向量是离散正弦函数 $v_j$，其分量为 $(v_j)_m = \\sin(j \\pi x_m) = \\sin(j \\pi m h)$，$m=1, \\dots, N$。当初始条件 $u_0(x) = \\sin(\\pi x)$ 在网格上采样时，得到向量 $u_h^0$，其分量为 $(u_h^0)_m = \\sin(\\pi x_m) = \\sin(\\pi m h)$。这正是 $A_h$ 的第一个离散特征向量 $v_1$。\n\n通过将 $A_h$ 应用于 $v_1$，可以找到与特征向量 $v_1$ 对应的 $A_h$ 的特征值 $\\lambda_{1,h}$：\n$$ (A_h v_1)_m = \\frac{-\\sin(\\pi(m-1)h) + 2\\sin(\\pi m h) - \\sin(\\pi(m+1)h)}{h^2} $$\n使用三角恒等式 $\\sin(a-b) + \\sin(a+b) = 2\\sin(a)\\cos(b)$，我们得到\n$$ (A_h v_1)_m = \\frac{2\\sin(\\pi m h) - 2\\sin(\\pi m h)\\cos(\\pi h)}{h^2} = \\left(\\frac{2(1 - \\cos(\\pi h))}{h^2}\\right) \\sin(\\pi m h) $$\n因此，离散特征值为 $\\lambda_{1,h} = \\frac{2(1 - \\cos(\\pi h))}{h^2}$。\n\n全离散格式根据 $u_h^{n+1} = (I + k A_h)^{-1} u_h^n$ 演化。由于初始数据 $u_h^0$ 是 $A_h$ 的一个特征向量，因此在任何时间步 $n$ 的解都保持在该特征向量的方向上：$u_h^n = ((I+kA_h)^{-1})^n u_h^0$。传播子 $(I+kA_h)^{-1}$ 对应的特征值为 $(1+k\\lambda_{1,h})^{-1}$。因此，离散解为 $u_h^n = (1+k\\lambda_{1,h})^{-n} u_h^0$。在时间步 $n$ 的离散振幅为 $a_h^n = (1+k\\lambda_{1,h})^{-n}$。在最终时间 $T$，当 $n = N_t = T/k$ 时，离散振幅为 $a_h(T) = (1+k\\lambda_{1,h})^{-T/k}$。\n\n为了求误差，我们对 $h \\to 0$ 进行渐近分析。我们首先将离散特征值 $\\lambda_{1,h}$ 展开为 $h$ 的幂级数。使用余弦的泰勒级数 $\\cos(x) = 1 - \\frac{x^2}{2!} + \\frac{x^4}{4!} - \\mathcal{O}(x^6)$：\n$$ \\lambda_{1,h} = \\frac{2}{h^2} \\left(1 - \\left(1 - \\frac{(\\pi h)^2}{2} + \\frac{(\\pi h)^4}{24} - \\mathcal{O}(h^6)\\right)\\right) = \\frac{2}{h^2} \\left(\\frac{\\pi^2 h^2}{2} - \\frac{\\pi^4 h^4}{24} + \\mathcal{O}(h^6)\\right) $$\n$$ \\lambda_{1,h} = \\pi^2 - \\frac{\\pi^4}{12} h^2 + \\mathcal{O}(h^4) $$\n这表明空间离散化在特征值中引入了一个 $\\mathcal{O}(h^2)$ 阶的误差，这对于一个二阶方法是符合预期的。\n\n现在我们分析离散振幅 $a_h(T)$。使用对数会很方便：\n$$ \\ln(a_h(T)) = \\ln\\left((1+k\\lambda_{1,h})^{-T/k}\\right) = -\\frac{T}{k} \\ln(1+k\\lambda_{1,h}) $$\n使用对数的泰勒级数 $\\ln(1+x) = x - \\frac{x^2}{2} + \\mathcal{O}(x^3)$：\n$$ \\ln(a_h(T)) = -\\frac{T}{k} \\left( k\\lambda_{1,h} - \\frac{(k\\lambda_{1,h})^2}{2} + \\mathcal{O}(k^3) \\right) = -T\\lambda_{1,h} + \\frac{T}{2}k\\lambda_{1,h}^2 + \\mathcal{O}(T k^2) $$\n现在，我们代入 $\\lambda_{1,h}$ 的展开式和耦合细化条件 $k=\\alpha h^2$：\n$$ \\ln(a_h(T)) = -T\\left(\\pi^2 - \\frac{\\pi^4}{12} h^2 + \\mathcal{O}(h^4)\\right) + \\frac{T}{2}(\\alpha h^2)\\left(\\pi^2 - \\frac{\\pi^4}{12} h^2 + \\mathcal{O}(h^4)\\right)^2 + \\mathcal{O}(h^4) $$\n我们只需要保留到 $\\mathcal{O}(h^2)$ 的项：\n$$ \\ln(a_h(T)) = -T\\pi^2 + T\\frac{\\pi^4}{12} h^2 + \\frac{T\\alpha h^2}{2}(\\pi^2)^2 + \\mathcal{O}(h^4) $$\n$$ \\ln(a_h(T)) = -T\\pi^2 + \\left(T\\frac{\\pi^4}{12} + T\\frac{\\alpha\\pi^4}{2}\\right)h^2 + \\mathcal{O}(h^4) $$\n$$ \\ln(a_h(T)) = -T\\pi^2 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) $$\n对两边取指数，得到 $a_h(T)$ 的渐近展开式：\n$$ a_h(T) = \\exp\\left(-T\\pi^2 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4)\\right) $$\n$$ a_h(T) = \\exp(-T\\pi^2) \\exp\\left(T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4)\\right) $$\n对小的 $x$ 使用展开式 $\\exp(x) = 1 + x + \\mathcal{O}(x^2)$：\n$$ a_h(T) = \\exp(-T\\pi^2) \\left[ 1 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) \\right] $$\n时间 $T$ 时的振幅误差为 $E(T;h,k) = a_h(T) - a(T)$。由于 $a(T) = \\exp(-\\pi^2 T)$：\n$$ E(T;h,k) = \\exp(-T\\pi^2)\\left[ 1 + T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) \\right] - \\exp(-T\\pi^2) $$\n$$ E(T;h,k) = \\exp(-T\\pi^2) T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right)h^2 + \\mathcal{O}(h^4) $$\n将此与所需形式 $E(T;h,k) = C(\\alpha,T) h^{2} + \\mathcal{O}(h^{4})$ 进行比较，我们确定领阶误差系数为：\n$$ C(\\alpha,T) = \\exp(-T\\pi^2) T\\pi^4\\left(\\frac{1}{12} + \\frac{\\alpha}{2}\\right) $$\n这个表达式可以通过通分来简化：\n$$ C(\\alpha,T) = T\\pi^4\\left(\\frac{1 + 6\\alpha}{12}\\right)\\exp(-T\\pi^2) = \\frac{T \\pi^{4} (1 + 6\\alpha)}{12} \\exp(-\\pi^{2} T) $$\n这个结果代表了由空间离散化（与 $\\frac{1}{12}$ 成比例的项）和时间离散化（与 $\\frac{\\alpha}{2}$ 成比例的项）共同造成的领阶误差。",
            "answer": "$$\\boxed{\\frac{T \\pi^{4} (1 + 6\\alpha)}{12} \\exp(-\\pi^{2} T)}$$"
        },
        {
            "introduction": "掌握了误差分解的基本计算后，我们进一步将这些理论应用于实际的数值格式设计与选择中。本节练习将为你呈现一个线性双曲型偏微分方程（平流方程）的求解场景，并提供多种常见的数值格式作为备选方案。你的任务是运用一致性和稳定性的原理，评估每种格式的优劣，并最终挑选出在渐近意义下精度最高的格式。这个过程将让你体会到，一个数值格式的性能是其截断误差阶数（一致性）和解的有界性（稳定性）之间权衡的结果，从而培养你在工程与科研中做出明智决策的能力。",
            "id": "3373618",
            "problem": "考虑线性平流偏微分方程 $u_t + a u_x = 0$，其中平流速度 $a  0$ 为常数，定义在周期域 $x \\in [0, 2\\pi]$ 上，初始数据 $u(x, 0) = u_0(x)$ 是光滑的，使得所有直到4阶的导数都有界。设空间网格为 $x_j = j h$（$j$ 为整数），固定间距 $h = 2\\pi/M$；时间网格为 $t^n = n k$（$n$ 为整数），时间步长 $k  0$。用 $\\lambda = k/h$ 表示 Courant 数，并假设 $T  0$ 是一个固定的最终时间。在整个过程中，我们通过初始化 $u_j^0 = u_0(x_j)$ 来假设离散初始误差为零。\n\n要求您选择一种数值时间步进格式，用于在显式约束 $k = \\lambda h$ 下将网格值 $u_j^n \\approx u(x_j, t^n)$ 从 $t^n$ 演化到 $t^{n+1}$，其中常数 $\\lambda$ 的选择需要满足每种格式相应的 Courant–Friedrichs–Lewy (CFL) 条件。四种候选格式如下：\n\nA. 前向欧拉时间格式结合一阶迎风空间格式：\n$u_j^{n+1} = u_j^n - \\lambda a \\left(u_j^n - u_{j-1}^n\\right)$.\n\nB. 前向欧拉时间格式结合二阶中心空间格式（前向时间中心空间格式）：\n$u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2}$.\n\nC. Lax–Wendroff 格式（时间和空间均为二阶）：\n$u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\frac{\\lambda^2 a^2}{2} \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$.\n\nD. 前向欧拉时间格式结合二阶中心空间格式以及一个由 $\\nu  0$ 缩放的人工粘性项：\n$u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\nu \\lambda \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$.\n\n您必须在以下基于第一性原理的框架下，判断当 $h \\to 0$ 时，哪种设计能最小化在固定最终时间 $T$ 的全局 $L^2$ 误差的渐近上界：\n\n- 相容性由将精确解代入格式得到的局部截断误差 $\\tau_j^n$ 定义；当 $k \\to 0$ 和 $h \\to 0$ 时 $\\tau_j^n \\to 0$ 表示相容。\n- 稳定性定义为齐次离散演化方程的解在适当范数下存在一个关于 $n$ 一致的有界性（例如，对于周期性线性常系数问题，可通过 von Neumann 分析来判断）。\n- 周期网格上线性格式的误差分解产生形式为 $e^{n+1} = G e^n + k \\tau^n$ 的误差演化，其中 $G$ 是齐次格式的离散演化算子。这在稳定性条件下意味着对于满足 $N k = T$ 的 $N$，有 $\\|e^N\\| \\le C \\sum_{n=0}^{N-1} k \\|\\tau^n\\|$，其中 $C$ 与 $h$ 和 $k$ 无关。\n\n假设对于每种格式，都通过选择 $\\lambda$ 来强制执行 CFL 条件以确保格式是稳定的。在设计 A–D 中，根据耦合关系 $k = \\lambda h$ 以及上述的相容性-稳定性误差分解，哪一种设计在 $h \\to 0$ 时能在时间 $T$ 产生最小的全局 $L^2$ 误差的渐近上界？\n\n选择一项：\n\nA. 设计 A。\n\nB. 设计 B。\n\nC. 设计 C。\n\nD. 设计 D。",
            "solution": "用户希望确定对于线性平流方程 $u_t + a u_x = 0$，给定的四种数值格式中哪一种能在固定的最终时间 $T$ 最小化全局 $L^2$ 误差的渐近上界。\n\n问题陈述了一个基于局部截断误差 $\\tau^n$ 评估全局误差 $\\|e^N\\|$ 的框架。具体来说，对于一个稳定的格式，在最终时间 $T=Nk$ 的全局误差有上界 $\\|e^N\\| \\le C \\sum_{n=0}^{N-1} k \\|\\tau^n\\|$，其中 $C$ 是一个与网格尺寸 $h$ 和 $k$ 无关的常数。由于时间步数 $N = T/k$，这个界可以表示为 $\\|e^N\\| \\le C k \\cdot N \\cdot \\max_n \\|\\tau^n\\| = C T \\max_n \\|\\tau^n\\|$。因此，为了在耦合关系 $k = \\lambda h$ 下，当 $h \\to 0$ 时最小化全局误差的渐近上界，我们必须找到局部截断误差 $\\tau$ 消失速率最快的格式。这等价于找到精度阶数最高的格式。\n\n对于写成 $\\mathcal{L}_h(u_j^n) = 0$ 形式的格式，其局部截断误差 $\\tau_j^n$ 是通过将精确解 $u(x,t)$ 代入格式来定义的：$\\tau_j^n = \\mathcal{L}_h(u(x_j, t^n))$。我们通过找到整数 $p$ 和 $q$ 使得 $\\tau_j^n = O(h^p) + O(k^q)$ 来确定精度阶数。在 $k = \\lambda h$ 的条件下，截断误差的总阶数是 $O(h^{\\min(p, q)})$。更高的阶数意味着当 $h \\to 0$ 时，格式能更快地收敛到精确解。\n\n我们将分析每种格式的稳定性和精度阶数。对于截断误差分析，我们使用精确解 $u(x,t)$ 在点 $(x_j, t^n)$ 附近的泰勒级数展开。精确解满足 $u_t = -a u_x$，这意味着高阶导数如 $u_{tt} = a^2 u_{xx}$ 和 $u_{ttt} = -a^3 u_{xxx}$。在下一个时间步的精确解展开式为：\n$$u(x_j, t^{n+1}) = u(x_j, t^n+k) = u - ak u_x + \\frac{a^2k^2}{2} u_{xx} - \\frac{a^3 k^3}{6} u_{xxx} + O(k^4)$$\n所有导数均在 $(x_j, t^n)$ 点计算。\n\n对于单步格式 $u_j^{n+1} = \\mathcal{F}(u^n)_j$，局部截断误差由 $k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}(u(\\cdot, t^n))_j$ 给出。\n\n**A. 前向欧拉时间格式结合一阶迎风空间格式**\n该格式为 $u_j^{n+1} = u_j^n - \\lambda a \\left(u_j^n - u_{j-1}^n\\right)$。\n将精确解应用于右侧（RHS）得到：\n$$ \\mathcal{F}_A(u)_j = u(x_j, t^n) - \\frac{k a}{h} \\left( u(x_j, t^n) - u(x_{j-1}, t^n) \\right) $$\n$$ = u - \\frac{ka}{h} \\left( u - (u - h u_x + \\frac{h^2}{2} u_{xx} - O(h^3)) \\right) $$\n$$ = u - \\frac{ka}{h} \\left( h u_x - \\frac{h^2}{2} u_{xx} + O(h^3) \\right) $$\n$$ = u - ak u_x + \\frac{ak h}{2} u_{xx} + O(kh^2) $$\n截断误差由以下公式确定：\n$$ k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}_A(u)_j = \\left( u - ak u_x + \\frac{a^2k^2}{2} u_{xx} + O(k^3) \\right) - \\left( u - ak u_x + \\frac{akh}{2} u_{xx} + O(kh^2) \\right) $$\n$$ k\\tau_j^n = \\left(\\frac{a^2k^2}{2} - \\frac{akh}{2}\\right) u_{xx} + O(k^3, kh^2) $$\n$$ \\tau_j^n = \\left(\\frac{a^2k}{2} - \\frac{ah}{2}\\right) u_{xx} + O(k^2, h^2) $$\n当 $k = \\lambda h$ 时，上式变为 $\\tau_j^n = \\frac{ah}{2} (a\\lambda - 1) u_{xx} + O(h^2)$。该格式是一阶精度的，$\\tau_j^n = O(h,k) = O(h)$。因此全局误差为 $O(h)$。von Neumann 分析表明，当 $0  a\\lambda \\le 1$ 时，该格式是稳定的。\n\n**B. 前向欧拉时间格式结合二阶中心空间格式（FTCS）**\n该格式为 $u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2}$。\n为了检查稳定性，我们进行 von Neumann 分析，代入 $u_j^n = g(\\xi)^n e^{i \\xi x_j}$，其中 $g(\\xi)$ 是波数为 $\\xi$ 的模的放大因子。\n$$ g = 1 - \\frac{\\lambda a}{2} \\left( e^{i \\xi h} - e^{-i \\xi h} \\right) = 1 - i \\lambda a \\sin(\\xi h) $$\n放大因子的大小为：\n$$ |g|^2 = 1^2 + (-\\lambda a \\sin(\\xi h))^2 = 1 + (\\lambda a \\sin(\\xi h))^2 $$\n对于任何 $\\lambda  0$，$a  0$ 以及 $\\xi h$ 不是 $\\pi$ 的倍数时，我们有 $|g|^2  1$。因此，该格式对于纯平流方程是无条件不稳定的。问题框架要求稳定性才能使误差界成立。由于此格式对于任何 $\\lambda  0$ 的选择都无法稳定，因此它不是一个可行的候选方案。\n\n**C. Lax–Wendroff**\n该格式为 $u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\frac{\\lambda^2 a^2}{2} \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$。\n该格式被构造成在时间和空间上都是二阶精度的。我们来验证其截断误差。\n将精确解应用于右侧得到：\n$$ \\mathcal{F}_C(u)_j = u - \\frac{ka}{2h}\\left( (u+hu_x+\\frac{h^2}{2}u_{xx}+\\frac{h^3}{6}u_{xxx}) - (u-hu_x+\\frac{h^2}{2}u_{xx}-\\frac{h^3}{6}u_{xxx}) + O(h^5) \\right) + \\frac{k^2 a^2}{2h^2}\\left( (u+hu_x+\\frac{h^2}{2}u_{xx}) - 2u + (u-hu_x+\\frac{h^2}{2}u_{xx}) + O(h^4) \\right) $$\n$$ \\mathcal{F}_C(u)_j = u - \\frac{ka}{2h}(2hu_x + \\frac{h^3}{3}u_{xxx} + O(h^5)) + \\frac{k^2 a^2}{2h^2}(h^2 u_{xx} + O(h^4)) $$\n$$ \\mathcal{F}_C(u)_j = u - ak u_x + \\frac{k^2 a^2}{2}u_{xx} - \\frac{ak h^2}{6}u_{xxx} + O(kh^4, k^2h^2) $$\n截断误差由以下公式确定：\n$$ k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}_C(u)_j $$\n$$ k\\tau_j^n = \\left( u - ak u_x + \\frac{a^2k^2}{2} u_{xx} - \\frac{a^3 k^3}{6} u_{xxx} + O(k^4) \\right) - \\left( u - ak u_x + \\frac{k^2 a^2}{2}u_{xx} - \\frac{ak h^2}{6}u_{xxx} + O(kh^4, k^2h^2) \\right) $$\n$$ k\\tau_j^n = \\left( \\frac{akh^2}{6} - \\frac{a^3k^3}{6} \\right) u_{xxx} + \\dots $$\n$$ \\tau_j^n = \\left( \\frac{ah^2}{6} - \\frac{a^3k^2}{6} \\right) u_{xxx} + \\dots = O(h^2, k^2) $$\n当 $k = \\lambda h$ 时，上式变为 $\\tau_j^n = \\frac{ah^2}{6}(1 - (a\\lambda)^2)u_{xxx} + O(h^3)$。该格式是二阶精度的，$\\tau_j^n = O(h^2)$。全局误差为 $O(h^2)$。von Neumann 分析证实该格式在 $|a\\lambda| \\le 1$ 时是稳定的。\n\n**D. 前向欧拉时间格式结合二阶中心空间格式以及一个人工粘性项**\n该格式为 $u_j^{n+1} = u_j^n - \\lambda a \\frac{u_{j+1}^n - u_{j-1}^n}{2} + \\nu \\lambda \\left(u_{j+1}^n - 2 u_j^n + u_{j-1}^n\\right)$。这是在 FTCS 格式上增加了一项。附加项是 $\\nu h k/h \\cdot u_{xx} = \\nu k h u_{xx}$ 的离散近似。该格式所近似的修正偏微分方程是 $u_t + a u_x = \\nu h u_{xx}$。\n我们来计算截断误差：\n将精确解应用于右侧是 FTCS 右侧项和粘性项之和。\n$$ \\mathcal{F}_D(u)_j = (u - ak u_x - \\frac{akh^2}{6} u_{xxx} + \\dots) + \\frac{\\nu k}{h}(h^2 u_{xx} + O(h^4)) $$\n$$ \\mathcal{F}_D(u)_j = u - ak u_x + \\nu kh u_{xx} - \\frac{akh^2}{6}u_{xxx} + \\dots $$\n截断误差由以下公式确定：\n$$ k\\tau_j^n = u(x_j, t^{n+1}) - \\mathcal{F}_D(u)_j $$\n$$ k\\tau_j^n = \\left( u - ak u_x + \\frac{a^2k^2}{2} u_{xx} + \\dots \\right) - \\left( u - ak u_x + \\nu kh u_{xx} + \\dots \\right) $$\n$$ k\\tau_j^n = \\left(\\frac{a^2k^2}{2} - \\nu kh \\right) u_{xx} + O(kh^2, k^3) $$\n$$ \\tau_j^n = \\left(\\frac{a^2k}{2} - \\nu h \\right) u_{xx} + O(h^2, k^2) $$\n当 $k = \\lambda h$ 时，这变为 $\\tau_j^n = h \\left(\\frac{a^2\\lambda}{2} - \\nu \\right) u_{xx} + O(h^2)$。\n由于 $\\nu  0$ 是一个给定的常数，该格式通常是一阶的，$\\tau_j^n = O(h)$，除非满足特殊条件 $\\nu = a^2\\lambda/2$（此处未作此假设）。全局误差为 $O(h)$。增加的粘性项使 FTCS 格式稳定；稳定性要求选择的 $\\lambda$ 满足 $\\lambda \\le 1/(2\\nu)$ 和 $\\lambda a^2 \\le 2\\nu$。\n\n**结论**\n\n让我们比较当 $h \\to 0$ 时，各个稳定格式的全局误差阶数：\n-   格式 A：$O(h)$\n-   格式 B：不稳定，因此不可用。\n-   格式 C：$O(h^2)$\n-   格式 D：$O(h)$\n\n格式 C 的全局误差随 $h^2$ 减小，这在渐近意义上比格式 A 和 D 的 $O(h)$ 减小速度快得多。因此，当 $h \\to 0$ 时，格式 C (Lax-Wendroff) 将产生最小的误差。\n\n各选项最终分析：\n- A. 错误。此格式为一阶精度，$O(h)$，低于格式 C 的精度。\n- B. 错误。此格式无条件不稳定，无法产生有意义的解。\n- C. 正确。此格式为二阶精度，$O(h^2)$，在所有选项中提供了最快的渐近误差减小速度。\n- D. 错误。此格式为一阶精度，$O(h)$，低于格式 C 的精度。\n\n因此，Lax-Wendroff 设计是最小化全局误差渐近上界的设计。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "“一致性+稳定性 ⇒ 收敛性”这一核心法则的威力远不止于线性问题。本节练习将带领你进入更具挑战性的非线性守恒律领域，探索如何将误差分解框架拓展到这类问题中。你将分析一个用于标量守恒律的通用有限体积法，并利用格式的“单调性”这一关键性质来证明其在 $L^1$ 范数下的稳定性。基于此稳定性结果，你将能够推导出一个严格的全局误差上界。这个练习不仅展示了误差分解理论的普适性与强大生命力，还将为你引入非线性问题分析中的核心工具，如 $L^1$ 稳定性和单调性分析，让你看到即使在傅里叶分析不再适用的情况下，核心的理论思想依然成立。",
            "id": "3373599",
            "problem": "考虑实数轴上的标量守恒律 $u_{t} + f(u)_{x} = 0$，其通量 $f \\in C^{1}(\\mathbb{R})$ 是光滑的。设 $\\Delta x  0$ 为固定网格尺寸，$\\Delta t  0$ 为时间步长，满足 Courant–Friedrichs–Lewy (CFL) 条件，该条件保证了以下显式有限体积法的单调性：\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\lambda \\Big(F\\big(u_{i}^{n},u_{i+1}^{n}\\big) \\;-\\; F\\big(u_{i-1}^{n},u_{i}^{n}\\big)\\Big), \\quad \\lambda := \\frac{\\Delta t}{\\Delta x},\n$$\n其中 $F:\\mathbb{R}^{2}\\to\\mathbb{R}$ 是一个数值通量函数，它与 $f$ 相容（即对所有 $a \\in \\mathbb{R}$ 都有 $F(a,a)=f(a)$），并且是单调的（即 $F$ 关于其第一个参数非减，关于其第二个参数非增）。假设初始条件由有界变差初始数据 $u_{0}\\in BV(\\mathbb{R})$ 的精确单元平均值 $u_{i}^{0} = \\frac{1}{\\Delta x}\\int_{x_{i-1/2}}^{x_{i+1/2}} u_{0}(x)\\,dx$ 初始化，并令 $u(\\cdot,t)$ 表示具有初始数据 $u_0$ 的守恒律的熵解。\n\n定义精确解的单元平均投影为 $\\bar{u}_{i}^{n} := \\frac{1}{\\Delta x}\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t^{n})\\,dx$，其中 $t^{n} := n\\Delta t$；对任意网格函数 $v^{n}$，定义离散 $L^{1}$-范数为 $\\|v^{n}\\|_{1} := \\sum_{i\\in\\mathbb{Z}} |v_{i}^{n}|\\,\\Delta x$。设局部残差 $\\tau^{n} = \\{\\tau_{i}^{n}\\}_{i\\in\\mathbb{Z}}$ 通过将 $\\bar{u}^{n}$ 代入格式来定义：\n$$\n\\tau_{i}^{n} \\;:=\\; \\frac{\\bar{u}_{i}^{n+1}-\\bar{u}_{i}^{n}}{\\Delta t}\n\\;+\\; \\frac{F\\big(\\bar{u}_{i}^{n},\\bar{u}_{i+1}^{n}\\big) \\;-\\; F\\big(\\bar{u}_{i-1}^{n},\\bar{u}_{i}^{n}\\big)}{\\Delta x}.\n$$\n\n任务：\n1) 仅使用上述定义和 $F$ 的单调性，证明对于任意两个输入 $v^{n}$ 和 $w^{n}$，更新算子在离散 $L^{1}$-范数下是非扩张的，即 $\\|v^{n+1}-w^{n+1}\\|_{1} \\le \\|v^{n}-w^{n}\\|_{1}$。并由此得出结论，在相容性-稳定性误差分解中，$L^{1}$-稳定性放大因子 $S$ 为 $S=1$。\n\n2) 假设存在一个常数 $K0$，使得对于所有满足 $t^{n} \\le T$ 的 $n$，残差满足 $\\|\\tau^{n}\\|_{1} \\le K\\,\\Delta x$。利用第 1 部分的结果和关于 $e^{n} := \\bar{u}^{n} - u^{n}$ 的离散误差方程，在 $e^{0}=0$ 的假设下，推导出在时间 $T = N\\Delta t$ 时 $\\|e^{N}\\|_{1}$ 的一个上界，该上界用 $K$、$T$ 和 $\\Delta x$ 表示。\n\n最后，将你的界具体化到数据 $K=3$ 和 $T=2$ 的情况，并以 $\\Delta x$ 的单个闭式表达式的形式报告结果。无需四舍五入。最终答案不带单位。",
            "solution": "该问题被验证为双曲守恒律数值分析中的一个适定的标准练习。所给假设是相容的，并且足以进行所要求的推导。\n\n**第 1 部分：非扩张性证明与稳定性因子 $S$ 的确定**\n\n设数值格式的更新算子记为 $H$，使得对于一个网格函数 $v^{n} = \\{v_{i}^{n}\\}_{i\\in\\mathbb{Z}}$，更新后的网格函数 $v^{n+1} = H(v^{n})$ 具有分量\n$$\n(H(v^{n}))_{i} = v_{i}^{n} - \\lambda \\Big(F\\big(v_{i}^{n},v_{i+1}^{n}\\big) - F\\big(v_{i-1}^{n},v_{i}^{n}\\big)\\Big),\n$$\n其中 $\\lambda = \\frac{\\Delta t}{\\Delta x}$。我们想要证明该算子在离散 $L^{1}$-范数下是非扩张的，即对于任意两个网格函数 $v^{n}$ 和 $w^{n}$，我们有 $\\|H(v^{n})-H(w^{n})\\|_{1} \\le \\|v^{n}-w^{n}\\|_{1}$。\n\n令 $v^{n+1} = H(v^{n})$ 和 $w^{n+1} = H(w^{n})$。在网格点 $i$ 处的差值为\n$$\nv_{i}^{n+1} - w_{i}^{n+1} = (v_{i}^{n} - w_{i}^{n}) - \\lambda \\Big( \\big(F(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n})\\big) - \\big(F(v_{i-1}^{n}, v_{i}^{n}) - F(w_{i-1}^{n}, w_{i}^{n})\\big) \\Big).\n$$\n令 $\\delta_{i}^{n} := v_{i}^{n} - w_{i}^{n}$。通量差的表达式可以使用中值定理进行分解。对于项 $F(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n})$，我们有\n$$\nF(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n}) = \\big(F(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, v_{i+1}^{n})\\big) + \\big(F(w_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n})\\big).\n$$\n由于 $F$ 的单调性（关于第一个参数非减，关于第二个参数非增），我们可以定义系数 $A_{i+1/2}^{n} \\ge 0$ 和 $B_{i+1/2}^{n} \\le 0$，使得\n$$\nF(v_{i}^{n}, v_{i+1}^{n}) - F(w_{i}^{n}, w_{i+1}^{n}) = A_{i+1/2}^{n}(v_{i}^{n} - w_{i}^{n}) + B_{i+1/2}^{n}(v_{i+1}^{n} - w_{i+1}^{n}) = A_{i+1/2}^{n}\\delta_{i}^{n} + B_{i+1/2}^{n}\\delta_{i+1}^{n}.\n$$\n将此代入 $\\delta_{i}^{n+1} = v_{i}^{n+1} - w_{i}^{n+1}$ 的方程中：\n$$\n\\delta_{i}^{n+1} = \\delta_{i}^{n} - \\lambda \\big(A_{i+1/2}^{n}\\delta_{i}^{n} + B_{i+1/2}^{n}\\delta_{i+1}^{n}\\big) + \\lambda \\big(A_{i-1/2}^{n}\\delta_{i-1}^{n} + B_{i-1/2}^{n}\\delta_{i}^{n}\\big).\n$$\n根据 $\\delta^{n}$ 的下标重排各项：\n$$\n\\delta_{i}^{n+1} = \\big(\\lambda A_{i-1/2}^{n}\\big)\\delta_{i-1}^{n} + \\big(1 - \\lambda A_{i+1/2}^{n} + \\lambda B_{i-1/2}^{n}\\big)\\delta_{i}^{n} + \\big(-\\lambda B_{i+1/2}^{n}\\big)\\delta_{i+1}^{n}.\n$$\n我们将系数记为 $C_{i,i-1} = \\lambda A_{i-1/2}^{n}$、$C_{i,i} = 1 - \\lambda A_{i+1/2}^{n} + \\lambda B_{i-1/2}^{n}$ 和 $C_{i,i+1} = -\\lambda B_{i+1/2}^{n}$。\n问题陈述 CFL 条件保证了格式的单调性。一个格式 $u_{i}^{n+1} = \\mathcal{H}(u_{i-1}^{n}, u_{i}^{n}, u_{i+1}^{n})$ 是单调的，如果 $\\mathcal{H}$ 是其每个参数的非减函数。这意味着系数 $C_{i,j}$ 是非负的。\n确实，$A_{i-1/2}^{n} \\ge 0$ 意味着 $C_{i,i-1} \\ge 0$。$B_{i+1/2}^{n} \\le 0$ 意味着 $C_{i,i+1} \\ge 0$。条件 $C_{i,i} \\ge 0$ 由单调格式的 CFL 条件保证。\n\n对 $\\delta_{i}^{n+1}$ 取绝对值并使用三角不等式：\n$$\n|\\delta_{i}^{n+1}| \\le |C_{i,i-1}\\delta_{i-1}^{n}| + |C_{i,i}\\delta_{i}^{n}| + |C_{i,i+1}\\delta_{i+1}^{n}|.\n$$\n由于所有系数 $C_{i,j}$ 都是非负的：\n$$\n|\\delta_{i}^{n+1}| \\le C_{i,i-1}|\\delta_{i-1}^{n}| + C_{i,i}|\\delta_{i}^{n}| + C_{i,i+1}|\\delta_{i+1}^{n}|.\n$$\n现在，我们对所有 $i \\in \\mathbb{Z}$ 求和：\n$$\n\\sum_{i\\in\\mathbb{Z}} |\\delta_{i}^{n+1}| \\le \\sum_{i\\in\\mathbb{Z}} \\big(C_{i,i-1}|\\delta_{i-1}^{n}| + C_{i,i}|\\delta_{i}^{n}| + C_{i,i+1}|\\delta_{i+1}^{n}|\\big).\n$$\n我们改变右侧每一项的求和指标，以收集乘以 $|\\delta_{j}^{n}|$ 的项，得到 $\\sum_j (\\dots)|\\delta_j^n|$。 对于任意固定的索引 $j$，项 $|\\delta_j^n|$ 的系数是 $C_{j+1,j} + C_{j,j} + C_{j-1,j}$。这些系数的和为：\n$$\n(\\lambda A_{j+1/2}^{n}) + (1 - \\lambda A_{j+1/2}^{n} + \\lambda B_{j-1/2}^{n}) + (-\\lambda B_{j-1/2}^{n}) = 1.\n$$\n因此，我们证明了\n$$\n\\sum_{i\\in\\mathbb{Z}} |\\delta_{i}^{n+1}| \\le \\sum_{j\\in\\mathbb{Z}} |\\delta_{j}^{n}|.\n$$\n乘以 $\\Delta x$ 即可得到所需结果：\n$$\n\\|v^{n+1}-w^{n+1}\\|_{1} = \\sum_{i\\in\\mathbb{Z}}|v_{i}^{n+1}-w_{i}^{n+1}|\\Delta x \\le \\sum_{j\\in\\mathbb{Z}}|v_{j}^{n}-w_{j}^{n}|\\Delta x = \\|v^{n}-w^{n}\\|_{1}.\n$$\n这证明了算子 $H$ 在离散 $L^{1}$-范数下是非扩张的。误差分解中的稳定性放大因子 $S$ 对应于由于格式的演化算子，误差范数在每一步可能增长的因子。由于我们已经证明这个因子至多为 1，我们得出结论 $S=1$。\n\n**第 2 部分：误差界推导**\n\n我们已知局部残差 $\\tau_{i}^{n}$ 的定义：\n$$\n\\tau_{i}^{n} = \\frac{\\bar{u}_{i}^{n+1}-\\bar{u}_{i}^{n}}{\\Delta t} + \\frac{F\\big(\\bar{u}_{i}^{n},\\bar{u}_{i+1}^{n}\\big) - F\\big(\\bar{u}_{i-1}^{n},\\bar{u}_{i}^{n}\\big)}{\\Delta x}.\n$$\n重排此方程，得到精确单元平均值 $\\bar{u}^{n}$ 的演化表达式：\n$$\n\\bar{u}_{i}^{n+1} = \\bar{u}_{i}^{n} - \\lambda \\Big(F(\\bar{u}_{i}^{n},\\bar{u}_{i+1}^{n}) - F(\\bar{u}_{i-1}^{n},\\bar{u}_{i}^{n})\\Big) - \\Delta t\\,\\tau_{i}^{n}.\n$$\n用算子记号表示，即为 $\\bar{u}^{n+1} = H(\\bar{u}^{n}) - \\Delta t\\,\\tau^{n}$。\n数值解 $u^{n}$ 根据 $u^{n+1} = H(u^{n})$ 演化。\n误差定义为 $e^{n} = \\bar{u}^{n} - u^{n}$。从 $\\bar{u}^{n+1}$ 的方程中减去 $u^{n+1}$ 的方程，我们得到误差演化方程：\n$$\ne^{n+1} = \\bar{u}^{n+1} - u^{n+1} = \\big(H(\\bar{u}^{n}) - \\Delta t\\,\\tau^{n}\\big) - H(u^{n}) = \\big(H(\\bar{u}^{n}) - H(u^{n})\\big) - \\Delta t\\,\\tau^{n}.\n$$\n我们现在对此方程取离散 $L^{1}$-范数并应用三角不等式：\n$$\n\\|e^{n+1}\\|_{1} = \\|(H(\\bar{u}^{n}) - H(u^{n})) - \\Delta t\\,\\tau^{n}\\|_{1} \\le \\|H(\\bar{u}^{n}) - H(u^{n})\\|_{1} + \\|\\Delta t\\,\\tau^{n}\\|_{1}.\n$$\n根据第 1 部分的结果，算子 $H$ 在 $L^{1}$-范数下是非扩张的，所以\n$$\n\\|H(\\bar{u}^{n}) - H(u^{n})\\|_{1} \\le \\|\\bar{u}^{n} - u^{n}\\|_{1} = \\|e^{n}\\|_{1}.\n$$\n残差项的范数为 $\\|\\Delta t\\,\\tau^{n}\\|_{1} = \\Delta t \\sum_{i} |\\tau_{i}^{n}|\\Delta x = \\Delta t\\|\\tau^{n}\\|_{1}$。\n结合这些结果，我们得到误差范数的递推关系：\n$$\n\\|e^{n+1}\\|_{1} \\le \\|e^{n}\\|_{1} + \\Delta t\\|\\tau^{n}\\|_{1}.\n$$\n我们已知假设，对于所有满足 $t^{n} \\le T$ 的 $n$，有 $\\|\\tau^{n}\\|_{1} \\le K\\,\\Delta x$。将此应用于递推式：\n$$\n\\|e^{n+1}\\|_{1} \\le \\|e^{n}\\|_{1} + \\Delta t(K\\,\\Delta x).\n$$\n我们可以通过归纳法解此递推关系。对于 $n=0$：$\\|e^{1}\\|_{1} \\le \\|e^{0}\\|_{1} + K\\Delta t\\Delta x$。对于 $n=1$：$\\|e^{2}\\|_{1} \\le \\|e^{1}\\|_{1} + K\\Delta t\\Delta x \\le \\|e^{0}\\|_{1} + 2K\\Delta t\\Delta x$。\n经过 $N$ 步后，我们有：\n$$\n\\|e^{N}\\|_{1} \\le \\|e^{0}\\|_{1} + \\sum_{n=0}^{N-1} K\\Delta t\\Delta x = \\|e^{0}\\|_{1} + N K \\Delta t \\Delta x.\n$$\n问题陈述 $e^{0}=0$，因此 $\\|e^{0}\\|_{1}=0$。该界简化为：\n$$\n\\|e^{N}\\|_{1} \\le N \\Delta t K \\Delta x.\n$$\n最终时间为 $T=N\\Delta t$。将此代入界中得到：\n$$\n\\|e^{N}\\|_{1} \\le T K \\Delta x.\n$$\n最后，我们使用给定数据 $K=3$ 和 $T=2$ 将此界具体化：\n$$\n\\|e^{N}\\|_{1} \\le (2)(3)\\Delta x = 6\\Delta x.\n$$\n这就是在时间 $T=2$ 时 $L^{1}$-误差所要求的上界。",
            "answer": "$$\\boxed{6\\Delta x}$$"
        }
    ]
}