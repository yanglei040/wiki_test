{
    "hands_on_practices": [
        {
            "introduction": "我们的实践探索始于一个数值分析中的经典警示案例。对于平流方程，前向时间中心空间（FTCS）格式也许是最直观的离散化方法。尽管可以证明该格式与偏微分方程是一致的，但本练习将引导你通过冯·诺依曼稳定性分析，揭示其致命缺陷。这鲜明地展示了为何拉克斯等价定理中的稳定性要求是保证收敛性所不可或缺的。",
            "id": "3455897",
            "problem": "考虑线性常系数平流偏微分方程(PDE) $u_{t}+a\\,u_{x}=0$，其中波速 $a\\neq 0$ 为常数，定义在一个长度为 $L$ 的周期性空间域上。设空间网格为 $x_{j}=j\\,\\Delta x$，其中 $j\\in\\mathbb{Z}$，$\\Delta x=L/M$，$M$ 为某个正整数；设时间层为 $t^{n}=n\\,\\Delta t$，其中 $\\Delta t>0$。使用向前时间中心空间(FTCS)格式对该偏微分方程进行离散化：\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right).\n$$\n使用基于离散傅里叶模态的 von Neumann 分析以及所有模态有界放大意义下的稳定性定义，推导放大因子，并计算谱半径作为 Courant 数 $\\nu=\\dfrac{a\\,\\Delta t}{\\Delta x}$ 的函数。然后，仅使用相容性的基本定义和针对线性初值问题的 Lax-Richtmyer 等价定理（也称为 Lax 等价定理），解释为何 FTCS 格式对于此偏微分方程，在相容的情况下仍然不收敛。\n\n你的最终答案必须是谱半径 $\\rho(\\nu)=\\sup_{\\theta\\in[-\\pi,\\pi]}|G(\\theta)|$ 关于 $a$、$\\Delta t$ 和 $\\Delta x$ 的闭式表达式。不需要进行数值近似。",
            "solution": "对问题陈述进行分析后，确认其是有效的。它在偏微分方程的数值分析领域有坚实的科学基础，提法良好、目标明确，且没有任何矛盾或含糊之处。该问题提出了一个关于不稳定数值格式及其通过 Lax 等价定理进行分析的经典案例研究。\n\n我们首先对应用于线性平流方程 $u_{t}+a\\,u_{x}=0$ 的向前时间中心空间(FTCS)格式进行 von Neumann 稳定性分析。FTCS 格式如下：\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right)\n$$\n在 von Neumann 分析中，我们考虑数值解的单个傅里叶模态的行为，其形式写作 $u_j^n = G^n e^{i k x_j}$，其中 $k$ 是波数，$x_j = j\\Delta x$ 是空间坐标，$G$ 是取决于波数 $k$ 的放大因子。将此模态代入格式中，得到：\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{2 \\Delta x} \\left( G^n e^{i k (j+1) \\Delta x} - G^n e^{i k (j-1) \\Delta x} \\right)\n$$\n方程两边同除以非零项 $G^n e^{i k j \\Delta x}$，得到放大因子 $G$：\n$$\nG = 1 - \\frac{a \\Delta t}{2 \\Delta x} \\left( e^{i k \\Delta x} - e^{-i k \\Delta x} \\right)\n$$\n使用欧拉恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$，并定义归一化波数或相位角为 $\\theta = k \\Delta x$，我们得到：\n$$\nG(\\theta) = 1 - \\frac{a \\Delta t}{2 \\Delta x} (2i \\sin(\\theta))\n$$\n令 $\\nu = \\frac{a \\Delta t}{\\Delta x}$ 为 Courant 数。放大因子可以简洁地表示为：\n$$\nG(\\theta) = 1 - i \\nu \\sin(\\theta)\n$$\n为了使一个格式在 von Neumann 意义下是稳定的，其放大因子的模必须对所有可能的相位角 $\\theta \\in [-\\pi, \\pi]$ 满足 $|G(\\theta)| \\le 1$。我们来计算 $G(\\theta)$ 的模。作为一个复数，其模的平方是其实部和虚部平方的和：\n$$\n|G(\\theta)|^2 = (\\operatorname{Re}(G))^2 + (\\operatorname{Im}(G))^2 = 1^2 + (-\\nu \\sin(\\theta))^2 = 1 + \\nu^2 \\sin^2(\\theta)\n$$\n因此，放大因子的模为：\n$$\n|G(\\theta)| = \\sqrt{1 + \\nu^2 \\sin^2(\\theta)}\n$$\n谱半径 $\\rho(\\nu)$ 定义为此模在所有可能模态上的上确界：\n$$\n\\rho(\\nu)=\\sup_{\\theta\\in[-\\pi,\\pi]}|G(\\theta)| = \\sup_{\\theta\\in[-\\pi,\\pi]} \\sqrt{1 + \\nu^2 \\sin^2(\\theta)}\n$$\n为了找到这个上确界，我们必须在区间 $\\theta \\in [-\\pi, \\pi]$ 上最大化 $\\sin^2(\\theta)$ 项。$\\sin^2(\\theta)$ 的最大值是 $1$，在 $\\theta = \\pm \\pi/2$ 时取得。因此，谱半径为：\n$$\n\\rho(\\nu) = \\sqrt{1 + \\nu^2 (1)} = \\sqrt{1 + \\nu^2}\n$$\n代入 Courant 数 $\\nu$ 的定义，我们得到用给定参数表示的谱半径：\n$$\n\\rho = \\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2}\n$$\n现在，我们使用 Lax 等价定理来解释该格式不收敛的原因。该定理指出，对于一个适定的线性初值问题，一个相容的线性有限差分格式是收敛的，当且仅当它是稳定的。\n\n首先，我们检验相容性。如果一个格式的截断误差在网格间距 $\\Delta t$ 和 $\\Delta x$ 趋于零时也趋于零，则该格式是相容的。截断误差 $T_j^n$ 是通过将偏微分方程的精确解 $u(x, t)$ 代入差分方程中得到的：\n$$\nT_j^n = \\frac{u(x_j, t^{n+1}) - u(x_j, t^n)}{\\Delta t} + \\frac{a}{2\\Delta x} (u(x_{j+1}, t^n) - u(x_{j-1}, t^n))\n$$\n在点 $(x_j, t^n)$ 附近进行泰勒级数展开：\n$$\nu(x_j, t^{n+1}) = u(x_j, t^n) + \\Delta t \\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + O((\\Delta t)^3)\n$$\n$$\nu(x_{j\\pm 1}, t^n) = u(x_j, t^n) \\pm \\Delta x \\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} \\pm \\frac{(\\Delta x)^3}{6} u_{xxx} + O((\\Delta x)^4)\n$$\n将这些展开式代入 $T_j^n$ 的表达式中：\n$$\nT_j^n = \\left( u_t + \\frac{\\Delta t}{2}u_{tt} + \\dots \\right) + a \\left( u_x + \\frac{(\\Delta x)^2}{6}u_{xxx} + \\dots \\right)\n$$\n$$\nT_j^n = (u_t + a u_x) + \\frac{\\Delta t}{2}u_{tt} + a\\frac{(\\Delta x)^2}{6}u_{xxx} + \\dots\n$$\n由于 $u(x,t)$ 是精确解，因此 $u_t + a u_x = 0$。截断误差的主部为 $O(\\Delta t, (\\Delta x)^2)$。当 $\\Delta t \\to 0$ 且 $\\Delta x \\to 0$ 时，截断误差 $T_j^n \\to 0$。因此，FTCS 格式与平流方程是相容的。\n\n接下来，我们检验稳定性。根据 von Neumann 分析的推导，放大因子的模为 $|G(\\theta)| = \\sqrt{1 + \\nu^2 \\sin^2(\\theta)}$。题目指定 $a \\ne 0$，$\\Delta t > 0$，并隐含 $\\Delta x > 0$。因此，Courant 数 $\\nu = \\frac{a \\Delta t}{\\Delta x}$ 是非零的。对于任何满足 $\\sin(\\theta) \\ne 0$ 的模态 $\\theta \\in [-\\pi, \\pi]$（这对几乎所有模态都成立），$\\nu^2 \\sin^2(\\theta)$ 项是严格为正的。这意味着：\n$$\n|G(\\theta)| = \\sqrt{1 + \\nu^2 \\sin^2(\\theta)} > 1\n$$\n由于稳定性条件 $|G(\\theta)| \\le 1$ 对于所有 $\\nu \\ne 0$ 和几乎所有模态都被违反，因此 FTCS 格式是无条件不稳定的。对于任何非零的 $\\nu$，谱半径 $\\rho = \\sqrt{1 + \\nu^2}$ 严格大于 1。\n\n根据 Lax 等价定理，收敛性要求相容性和稳定性二者兼备。我们已经证明了 FTCS 格式是相容的，但却是无条件不稳定的。不满足稳定性条件意味着该格式不收敛。其物理解释是，数值误差，尤其是在高频模态中（其中 $|\\sin(\\theta)|$ 较大），在每个时间步长都会被放大，导致指数级增长，从而迅速污染并压倒真实解。这种无条件不稳定性正是 FTCS 格式对于线性平流方程不收敛的原因。",
            "answer": "$$\n\\boxed{\\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2}}\n$$"
        },
        {
            "introduction": "与显式FTCS格式的内在不稳定性形成对比，我们现在转向一种表现出卓越稳健性的隐式方法。用于扩散方程的后向欧拉格式是稳定数值方法的基石。本练习将让你推导其放大因子，以证明其无条件稳定性，从而展示隐式格式如何能够规避通常施加于显式格式的严格时间步长限制，并通过拉克斯等价定理保证收敛。",
            "id": "3455904",
            "problem": "考虑线性扩散偏微分方程 (PDE) $u_{t}=\\nu\\,u_{xx}$，其定义在长度为 $L>0$ 的周期性空间域上，扩散系数 $\\nu>0$。在均匀网格 $x_{j}=j\\,\\Delta x$（其中 $\\Delta x=L/N$ 且 $N\\geq 3$ 为整数）上对空间进行离散化，并将时间离散化为 $t^{n}=n\\,\\Delta t$（其中 $\\Delta t>0$）。用二阶中心空间差分定义隐式向后欧拉有限差分格式如下：\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2\\,u_{j}^{n+1}+u_{j-1}^{n+1}}{\\Delta x^{2}} \\quad \\text{对于所有整数 } j,n.\n$$\n使用简正模 (傅里叶) 分析，令 $u_{j}^{n}=\\hat{u}^{n}\\,\\exp\\!\\big(i\\,j\\,\\xi\\,\\Delta x\\big)$，其中波数 $\\xi\\in[-\\pi/\\Delta x,\\pi/\\Delta x]$，并定义放大因子 $g(\\xi)=\\hat{u}^{n+1}/\\hat{u}^{n}$。从该格式和傅里叶拟设出发，推导 $g(\\xi)$ 的精确闭式表达式，并用它证明对于所有的 $\\xi\\in[-\\pi/\\Delta x,\\pi/\\Delta x]$ 以及所有的 $\\Delta t>0$, $\\Delta x>0$ 和 $\\nu>0$，都有 $|g(\\xi)|\\leq 1$。然后，利用线性离散演化方程的稳定性定义和拉克斯等价定理 (Lax equivalence theorem)，论证该格式对于这个适定的线性初值问题是无条件稳定和收敛的，前提是它具有相容性。\n\n您的最终任务是计算在所有允许的波数上放大因子模的上确界。请给出\n$$\n\\sup_{\\xi\\in[-\\pi/\\Delta x,\\pi/\\Delta x]} |g(\\xi)|.\n$$\n的精确值。将您的答案表示为单个精确值，无需四舍五入。",
            "solution": "该问题要求对一维扩散方程 $u_{t}=\\nu\\,u_{xx}$ 的向后欧拉有限差分格式进行分析。此分析涉及推导放大因子、证明无条件稳定性、通过拉克斯等价定理 (Lax equivalence theorem) 证明收敛性，以及计算放大因子模的上确界。\n\n首先，我们推导放大因子 $g(\\xi)$ 的表达式。给定的有限差分格式为：\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\nu\\,\\frac{u_{j+1}^{n+1}-2\\,u_{j}^{n+1}+u_{j-1}^{n+1}}{\\Delta x^{2}}\n$$\n我们将简正模 (傅里叶) 拟设 $u_{j}^{n}=\\hat{u}^{n}\\,\\exp(i\\,j\\,\\xi\\,\\Delta x)$ 代入该格式。注意 $u_{j}^{n+1}=\\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\xi\\,\\Delta x)$，$u_{j+1}^{n+1}=\\hat{u}^{n+1}\\,\\exp(i\\,(j+1)\\,\\xi\\,\\Delta x)$，以及 $u_{j-1}^{n+1}=\\hat{u}^{n+1}\\,\\exp(i\\,(j-1)\\,\\xi\\,\\Delta x)$。\n将这些代入格式中得到：\n$$\n\\frac{\\hat{u}^{n+1}\\exp(i\\,j\\,\\xi\\,\\Delta x) - \\hat{u}^{n}\\exp(i\\,j\\,\\xi\\,\\Delta x)}{\\Delta t} = \\nu \\frac{\\hat{u}^{n+1}\\exp(i\\,(j+1)\\,\\xi\\,\\Delta x) - 2\\hat{u}^{n+1}\\exp(i\\,j\\,\\xi\\,\\Delta x) + \\hat{u}^{n+1}\\exp(i\\,(j-1)\\,\\xi\\,\\Delta x)}{\\Delta x^2}\n$$\n我们可以用非零公因子 $\\exp(i\\,j\\,\\xi\\,\\Delta x)$ 除以整个方程：\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n}}{\\Delta t} = \\nu \\frac{\\hat{u}^{n+1}\\exp(i\\,\\xi\\,\\Delta x) - 2\\hat{u}^{n+1} + \\hat{u}^{n+1}\\exp(-i\\,\\xi\\,\\Delta x)}{\\Delta x^2}\n$$\n在右侧提出因子 $\\hat{u}^{n+1}$：\n$$\n\\hat{u}^{n+1} - \\hat{u}^{n} = \\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\hat{u}^{n+1} \\left( \\exp(i\\,\\xi\\,\\Delta x) + \\exp(-i\\,\\xi\\,\\Delta x) - 2 \\right)\n$$\n使用恒等式 $2\\cos(\\theta) = \\exp(i\\theta)+\\exp(-i\\theta)$，括号中的表达式变为 $2\\cos(\\xi\\,\\Delta x) - 2$。\n$$\n\\hat{u}^{n+1} - \\hat{u}^{n} = \\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\hat{u}^{n+1} \\left( 2\\cos(\\xi\\,\\Delta x) - 2 \\right) = -2\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\hat{u}^{n+1} \\left( 1 - \\cos(\\xi\\,\\Delta x) \\right)\n$$\n接下来，我们使用半角恒等式 $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\n\\hat{u}^{n+1} - \\hat{u}^{n} = -2\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\hat{u}^{n+1} \\left( 2\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right) \\right) = -4\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right) \\hat{u}^{n+1}\n$$\n为了求放大因子 $g(\\xi) = \\hat{u}^{n+1}/\\hat{u}^{n}$，我们重新整理方程，将含 $\\hat{u}^{n+1}$ 和 $\\hat{u}^{n}$ 的项分组：\n$$\n\\hat{u}^{n} = \\hat{u}^{n+1} + 4\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right) \\hat{u}^{n+1} = \\hat{u}^{n+1} \\left( 1 + 4\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right) \\right)\n$$\n解出 $g(\\xi)$，得到其精确闭式表达式：\n$$\ng(\\xi) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}} = \\frac{1}{1 + 4\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right)}\n$$\n现在，我们必须证明对于所有有效参数，都有 $|g(\\xi)| \\leq 1$。给定的参数为 $\\nu>0$, $\\Delta t>0$ 和 $\\Delta x>0$。项 $\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right)$ 总是实数且非负。因此，乘积 $4\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right)$ 是一个非负实数。设其为 $A \\ge 0$。放大因子为 $g(\\xi) = \\frac{1}{1+A}$。由于 $A \\ge 0$，分母 $1+A \\ge 1$。因此，$g(\\xi)$ 是一个满足 $0  g(\\xi) \\leq 1$ 的实数。这直接意味着 $|g(\\xi)| = g(\\xi) \\leq 1$。这个不等式对所有波数 $\\xi$ 和任意选择的 $\\Delta t  0$ 和 $\\Delta x  0$ 都成立。\n\n接下来，我们论证该格式是无条件稳定和收敛的。\n对于应用于具有常系数和周期性边界条件的线性偏微分方程的线性有限差分格式，冯·诺依曼稳定性分析是拉克斯-里奇特迈尔 (Lax-Richtmyer) 意义下稳定性的充分必要条件。冯·诺依曼稳定性条件要求对于所有相关波数 $\\xi$，都有 $|g(\\xi)| \\leq 1 + O(\\Delta t)$。我们已经证明了更强的条件 $|g(\\xi)| \\leq 1$，它对所有 $\\Delta t  0$ 和 $\\Delta x  0$ 都成立，且对它们的比率没有任何限制。这证明了该格式是无条件稳定的。\n\n拉克斯等价定理 (Lax Equivalence Theorem) 指出，对于一个适定的线性初值问题，一个相容的线性有限差分格式是收敛的当且仅当它是稳定的。\n1. 线性扩散方程 $u_{t}=\\nu\\,u_{xx}$ 的初值问题是适定的。\n2. 给定的有限差分格式是线性的。\n3. 问题陈述允许我们假定该格式是相容的。通过泰勒级数展开的检验表明，截断误差为 $O(\\Delta t) + O(\\Delta x^2)$，因此该格式确实是相容的。\n4. 我们已经证明了该格式是无条件稳定的。\n\n根据拉克斯等价定理，这些条件共同意味着向后欧拉格式对于此问题是无条件收敛的。\n\n最后，我们计算放大因子模的上确界：\n$$\n\\sup_{\\xi\\in[-\\pi/\\Delta x,\\pi/\\Delta x]} |g(\\xi)|\n$$\n我们已经证明了 $|g(\\xi)|=g(\\xi)$，其表达式为：\n$$\n|g(\\xi)| = \\frac{1}{1 + 4\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right)}\n$$\n为了求此表达式的上确界，我们必须求其分母的最小值，因为分子是常数。分母是 $D(\\xi) = 1 + 4\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right)$。由于 $\\nu$、$\\Delta t$ 和 $\\Delta x^2$ 都是正常数，最小化 $D(\\xi)$ 等价于最小化项 $\\sin^2\\left(\\frac{\\xi\\,\\Delta x}{2}\\right)$。\n波数 $\\xi$ 在范围 $[-\\pi/\\Delta x, \\pi/\\Delta x]$ 内，所以正弦函数的参数 $\\theta = \\frac{\\xi\\,\\Delta x}{2}$ 在范围 $[-\\pi/2, \\pi/2]$ 内。在此区间上，$\\sin^2(\\theta)$ 的最小值为 $0$，发生在 $\\theta=0$ 处。这对应于 $\\xi=0$。\n在 $\\xi=0$ 处，分母变为：\n$$\nD(0) = 1 + 4\\frac{\\nu\\,\\Delta t}{\\Delta x^2}\\sin^2(0) = 1 + 0 = 1\n$$\n在这一点 $|g(\\xi)|$ 的值为 $|g(0)| = 1/1 = 1$。由于分母 $D(\\xi)$ 总是大于或等于 $1$，所以 $|g(\\xi)|$ 的值总是小于或等于 $1$。值 $1$ 在 $\\xi$ 的定义域内可以取到，因此上确界也是最大值。\n因此，放大因子模的上确界是 $1$。\n$$\n\\sup_{\\xi\\in[-\\pi/\\Delta x,\\pi/\\Delta x]} |g(\\xi)| = 1\n$$",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在看过了无条件不稳定和无条件稳定的例子之后，我们现在从设计者的视角出发。本练习将探讨一个通用的格式族，它包含不稳定的FTCS格式作为一个特例。通过引入一个控制人工粘性的参数，你将确定恢复稳定性所需的确切条件，绘制出完整的稳定区域，并阐明在格式设计中，精度与稳定性之间的基本权衡。",
            "id": "3455861",
            "problem": "考虑在 $\\mathbb{R}$ 上的线性平流初值问题 $u_{t} + a\\,u_{x} = 0$，其初始数据为光滑函数，其中 $a \\neq 0$ 是一个常数。在一个具有空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的均匀网格上，定义 Courant–Friedrichs–Lewy 数 $\\lambda = a\\,\\Delta t/\\Delta x$。研究以下包含两个实参数 $\\theta$ 的显式、三点线性格式族：\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j} \\;-\\; \\frac{\\lambda}{2}\\left(u^{n}_{j+1}-u^{n}_{j-1}\\right) \\;+\\; \\frac{\\theta}{2}\\left(u^{n}_{j+1}-2u^{n}_{j}+u^{n}_{j-1}\\right),\n$$\n该格式族在不同参数下对应不同格式：前向时间中心空间格式（$\\theta=0$）、Lax–Friedrichs 格式（$\\theta=1$），以及当 $a0$ 时的迎风格式（$\\theta=\\lambda$）。利用线性相容性、通过傅里叶（冯·诺依曼）分析得到的 $l^2$范数下的稳定性，以及 Lax 等价定理，完成以下任务：\n\n1.  从离散更新方程出发，推导单个傅里叶模 $e^{\\mathrm{i}j\\xi}$ 的傅里叶放大因子 $g(\\xi)$，并根据 $|g(\\xi)| \\le 1$ 对所有实数 $\\xi$ 成立的条件，获得关于 $(\\lambda,\\theta)$ 的 $l^2$-稳定性的一个充分必要条件。\n2.  从第一性原理出发，确定 $(\\lambda,\\theta)$-平面上的完整稳定区域，并找出其边界曲线。\n3.  解释为什么在整个稳定区域内，当 $\\Delta t,\\Delta x \\to 0$ 且 $\\lambda$ 保持固定时，该格式收敛到 $u_{t}+a\\,u_{x}=0$ 的解；并解释为什么在该区域之外不收敛。\n\n你的最终答案必须是保证在 $|\\lambda|\\le 1$ 时稳定的最小人工粘性 $\\Theta(\\lambda)$ 的单一解析表达式，其定义为：\n$$\n\\Theta(\\lambda) \\;=\\; \\inf\\left\\{\\theta\\in[0,1]:\\; (\\lambda,\\theta)\\ \\text{is}\\ l^2\\text{-stable}\\right\\}。\n$$\n无需进行数值计算；请以 $\\lambda$ 的闭式函数形式给出 $\\Theta(\\lambda)$。",
            "solution": "该问题要求分析一个用于线性平流方程的双参数有限差分格式族。这包括推导稳定性条件、刻画稳定区域、通过 Lax 等价定理讨论收敛性，并最终确定一个最小稳定人工粘性参数的表达式。\n\n线性平流方程为\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中函数 $u(x,t)$ 定义在 $\\mathbb{R} \\times [0, \\infty)$ 上，平流速度 $a$ 为非零常数。所考虑的数值格式为\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j} \\;-\\; \\frac{\\lambda}{2}\\left(u^{n}_{j+1}-u^{n}_{j-1}\\right) \\;+\\; \\frac{\\theta}{2}\\left(u^{n}_{j+1}-2u^{n}_{j}+u^{n}_{j-1}\\right)\n$$\n其中 $\\lambda = a\\,\\Delta t/\\Delta x$ 是 Courant 数，$\\theta$ 是一个实参数。\n\n**1. 放大因子与稳定性条件的推导**\n\n为了进行冯·诺依曼稳定性分析，我们考虑在时间层 $n$ 的数值解的一个傅里叶模，其形式为 $u^n_j = \\hat{u}^n(\\xi) e^{\\mathrm{i} j \\xi}$，其中 $\\xi = k_w \\Delta x$ 是波数 $k_w$ 对应的无量纲波数。由于格式的线性性，下一时间层的解可以写为 $u^{n+1}_j = \\hat{u}^{n+1}(\\xi) e^{\\mathrm{i} j \\xi}$。放大因子 $g(\\xi)$ 由关系式 $\\hat{u}^{n+1}(\\xi) = g(\\xi) \\hat{u}^n(\\xi)$ 定义。\n\n将傅里叶模代入格式中，我们得到：\n$$\ng(\\xi) e^{\\mathrm{i} j \\xi} = e^{\\mathrm{i} j \\xi} - \\frac{\\lambda}{2}\\left(e^{\\mathrm{i} (j+1) \\xi} - e^{\\mathrm{i} (j-1) \\xi}\\right) + \\frac{\\theta}{2}\\left(e^{\\mathrm{i} (j+1) \\xi} - 2e^{\\mathrm{i} j \\xi} + e^{\\mathrm{i} (j-1) \\xi}\\right)\n$$\n两边同除以公因子 $e^{\\mathrm{i} j \\xi}$，得到 $g(\\xi)$ 的表达式：\n$$\ng(\\xi) = 1 - \\frac{\\lambda}{2}\\left(e^{\\mathrm{i} \\xi} - e^{-\\mathrm{i} \\xi}\\right) + \\frac{\\theta}{2}\\left(e^{\\mathrm{i} \\xi} - 2 + e^{-\\mathrm{i} \\xi}\\right)\n$$\n利用欧拉恒等式 $e^{\\mathrm{i} \\xi} - e^{-\\mathrm{i} \\xi} = 2\\mathrm{i}\\sin(\\xi)$ 和 $e^{\\mathrm{i} \\xi} + e^{-\\mathrm{i} \\xi} = 2\\cos(\\xi)$，我们可以简化 $g(\\xi)$：\n$$\ng(\\xi) = 1 - \\mathrm{i}\\lambda\\sin(\\xi) + \\theta(\\cos(\\xi)-1)\n$$\n$g(\\xi)$ 的实部和虚部分别为：\n$$\n\\operatorname{Re}(g(\\xi)) = 1 + \\theta(\\cos(\\xi)-1) = 1 - 2\\theta\\sin^2\\left(\\frac{\\xi}{2}\\right)\n$$\n$$\n\\operatorname{Im}(g(\\xi)) = -\\lambda\\sin(\\xi)\n$$\n为了使格式在 $l^2$ 范数下稳定，冯·诺依曼稳定性条件要求放大因子的模长对于所有可能的波数 $\\xi \\in [-\\pi, \\pi]$ 都小于或等于 $1$。即 $|g(\\xi)| \\le 1$，这等价于 $|g(\\xi)|^2 \\le 1$。\n$$\n|g(\\xi)|^2 = (\\operatorname{Re}(g(\\xi)))^2 + (\\operatorname{Im}(g(\\xi)))^2 = (1 + \\theta(\\cos(\\xi)-1))^2 + (-\\lambda\\sin(\\xi))^2 \\le 1\n$$\n展开此表达式：\n$$\n1 + 2\\theta(\\cos(\\xi)-1) + \\theta^2(\\cos(\\xi)-1)^2 + \\lambda^2\\sin^2(\\xi) \\le 1\n$$\n两边减去 $1$，并使用恒等式 $\\sin^2(\\xi) = 1-\\cos^2(\\xi) = (1-\\cos(\\xi))(1+\\cos(\\xi))$，得到：\n$$\n2\\theta(\\cos(\\xi)-1) + \\theta^2(\\cos(\\xi)-1)^2 + \\lambda^2(1-\\cos(\\xi))(1+\\cos(\\xi)) \\le 0\n$$\n令 $C = 1-\\cos(\\xi)$。注意到对于 $\\xi \\in [-\\pi, \\pi]$，$C$ 的取值范围是 $0$ 到 $2$。不等式变为：\n$$\n-2\\theta C + \\theta^2 C^2 + \\lambda^2 C(2-C) \\le 0\n$$\n当 $C=0$ (即 $\\xi=0$) 时，不等式显然成立 ($0 \\le 0$)。对于 $C0$，我们可以除以 $C$：\n$$\n-2\\theta + \\theta^2 C + \\lambda^2(2-C) \\le 0\n$$\n将各项重排为关于 $C$ 的线性函数：\n$$\n(2\\lambda^2 - 2\\theta) + C(\\theta^2 - \\lambda^2) \\le 0\n$$\n这个不等式必须对所有 $C \\in (0, 2]$ 成立。我们定义函数 $F(C) = (2\\lambda^2 - 2\\theta) + C(\\theta^2 - \\lambda^2)$。由于 $F(C)$ 是关于 $C$ 的线性函数，要使其在区间 $(0, 2]$ 上为非正，只需检查其在区间边界 $C \\to 0^+$ 和 $C=2$ 处的值。\n\n条件1：当 $C \\to 0^+$ 时，我们必须有 $F(0^+) \\le 0$。\n$$\n2\\lambda^2 - 2\\theta \\le 0 \\implies \\lambda^2 \\le \\theta\n$$\n条件2：在 $C=2$ 处 (对应 $\\xi=\\pm\\pi$)，我们必须有 $F(2) \\le 0$。\n$$\n(2\\lambda^2 - 2\\theta) + 2(\\theta^2 - \\lambda^2) \\le 0\n$$\n$$\n2\\lambda^2 - 2\\theta + 2\\theta^2 - 2\\lambda^2 \\le 0\n$$\n$$\n2\\theta^2 - 2\\theta \\le 0 \\implies 2\\theta(\\theta-1) \\le 0\n$$\n最后一个不等式当且仅当 $0 \\le \\theta \\le 1$ 时成立。\n\n结合这两个必要条件，我们发现要使格式稳定，参数 $(\\lambda, \\theta)$ 必须满足：\n$$\n\\lambda^2 \\le \\theta \\quad \\text{且} \\quad 0 \\le \\theta \\le 1\n$$\n这些条件也是充分的。如果它们成立，函数 $F(C)$ 在区间 $[0, 2]$ 的两个端点处都是非正的。由于 $F(C)$ 是线性的，它必定对所有 $C \\in [0, 2]$ 都是非正的。因此，条件 $|g(\\xi)|^2 \\le 1$ 对所有 $\\xi$ 都成立。$l^2$-稳定性的充分必要条件是 $\\lambda^2 \\le \\theta \\le 1$。\n\n**2. $(\\lambda, \\theta)$-平面上的稳定区域**\n\n稳定区域是平面上所有满足条件 $\\lambda^2 \\le \\theta$ 和 $0 \\le \\theta \\le 1$ 的点 $(\\lambda, \\theta)$ 的集合。\n第二个条件 $0 \\le \\theta \\le 1$ 将区域限制在直线 $\\theta=0$ 和 $\\theta=1$ 之间的水平带状区域。\n第一个条件 $\\lambda^2 \\le \\theta$ 意味着对于给定的 $\\lambda$，稳定的 $\\theta$ 值必须位于抛物线 $\\theta=\\lambda^2$ 之上或其上。\n综合起来，稳定区域是 $(\\lambda, \\theta)$-平面上位于抛物线 $\\theta = \\lambda^2$ 之上（含边界）且位于直线 $\\theta = 1$ 之下（含边界）的区域。\n该区域的边界是以下曲线：\n- 抛物线 $\\theta = \\lambda^2$。\n- 对于 $\\lambda \\in [-1, 1]$ 的水平线段 $\\theta = 1$。\n交点通过令 $\\lambda^2 = 1$ 求得，即 $\\lambda = \\pm 1$。交点是 $(-1, 1)$ 和 $(1, 1)$。抛物线的顶点在 $(0, 0)$。因此，完整的稳定区域由 $\\lambda^2 \\le \\theta \\le 1$ 描述，这也意味着 $|\\lambda| \\le \\sqrt{\\theta} \\le \\sqrt{1} = 1$。所以，只有当 $|\\lambda| \\le 1$ 时才可能稳定。\n\n**3. 收敛性与 Lax 等价定理**\n\nLax 等价定理指出，对于一个适定的线性初值问题，一个相容的线性有限差分格式是收敛的当且仅当它是稳定的。\n\n首先，我们确定相容性。截断误差 $T_j^n$ 是将偏微分方程的精确解 $u(x, t)$ 代入有限差分格式得到的。\n$$\nT_j^n = \\frac{u_j^{n+1}-u_j^n}{\\Delta t} - \\frac{1}{\\Delta t}\\left[-\\frac{\\lambda}{2}(u_{j+1}^n-u_{j-1}^n) + \\frac{\\theta}{2}(u_{j+1}^n-2u_j^n+u_{j-1}^n) \\right]\n$$\n使用 $\\lambda = a \\Delta t/\\Delta x$，这可以写成：\n$$\nT_j^n = \\frac{u_j^{n+1}-u_j^n}{\\Delta t} + a\\frac{u_{j+1}^n-u_{j-1}^n}{2\\Delta x} - \\frac{\\theta \\Delta x^2}{2\\Delta t}\\frac{u_{j+1}^n-2u_j^n+u_{j-1}^n}{\\Delta x^2}\n$$\n围绕 $(x_j, t_n)$ 对每一项进行泰勒展开：\n- $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + O(\\Delta t^2)$\n- $\\frac{u_{j+1}^n-u_{j-1}^n}{2\\Delta x} = u_x + \\frac{\\Delta x^2}{6}u_{xxx} + O(\\Delta x^4)$\n- $\\frac{u_{j+1}^n-2u_j^n+u_{j-1}^n}{\\Delta x^2} = u_{xx} + \\frac{\\Delta x^2}{12}u_{xxxx} + O(\\Delta x^4)$\n将这些代入 $T_j^n$ 的表达式：\n$$\nT_j^n = (u_t + au_x) + \\frac{\\Delta t}{2}u_{tt} + a\\frac{\\Delta x^2}{6}u_{xxx} - \\frac{\\theta \\Delta x^2}{2\\Delta t}u_{xx} + \\text{高阶项}\n$$\n由于 $u$ 是偏微分方程的解，所以 $u_t+au_x=0$。此外，对偏微分方程求导可得 $u_{tt} = a^2 u_{xx}$。\n$$\nT_j^n = \\frac{\\Delta t}{2}a^2 u_{xx} - \\frac{\\theta \\Delta x^2}{2\\Delta t}u_{xx} + \\text{高阶项} = \\left(\\frac{a^2 \\Delta t}{2} - \\frac{\\theta \\Delta x^2}{2\\Delta t}\\right)u_{xx} + \\text{高阶项}\n$$\n这可以用 $\\lambda = a\\Delta t/\\Delta x$ 重写：\n$$\nT_j^n = \\frac{a^2\\Delta t}{2\\lambda^2}(\\lambda^2-\\theta)u_{xx} + \\text{高阶项}\n$$\n如果 $\\Delta t, \\Delta x \\to 0$ 同时保持 $\\lambda$ 固定，则 $\\Delta x$ 与 $\\Delta t$ 成正比。截断误差的主项是 $O(\\Delta t)$。当 $\\Delta t \\to 0$ 时，$T_j^n \\to 0$。因此，对于任意选择的 $\\lambda$ 和 $\\theta$，该格式都是相容的。\n\n在确定了相容性之后，Lax 等价定理可以直接应用：\n- 在整个稳定区域 $\\lambda^2 \\le \\theta \\le 1$ 内，格式是稳定的。由于它也是相容的，因此它是收敛的。当 $\\Delta t, \\Delta x \\to 0$ (且 $\\lambda$ 固定) 时，数值解将趋近于 $u_t + a u_x = 0$ 的真实解。\n- 在此区域之外，格式是不稳定的 ($|g(\\xi)|  1$ 对某些 $\\xi$ 成立)。不稳定的格式不可能是收敛的。微小的误差（如舍入误差）将在每个时间步被放大，导致指数级增长，从而完全淹没真实解。因此，在稳定区域之外，该格式是不收敛的。\n\n**$\\Theta(\\lambda)$ 的确定**\n\n问题要求函数 $\\Theta(\\lambda)$，它被定义为对于给定的 $\\lambda$，在 $[0, 1]$ 区间内使格式稳定的参数 $\\theta$ 的集合的下确界：\n$$\n\\Theta(\\lambda) = \\inf\\left\\{\\theta\\in[0,1]:\\; (\\lambda,\\theta)\\ \\text{is}\\ l^2\\text{-stable}\\right\\}\n$$\n这需要在 $|\\lambda| \\le 1$ 的条件下确定。根据我们的稳定性分析，对于一个固定的 $\\lambda$ 值（满足 $|\\lambda| \\le 1$），使格式稳定的 $\\theta$ 值的集合由不等式 $\\lambda^2 \\le \\theta \\le 1$ 给出。问题进一步将 $\\theta$ 限制在区间 $[0, 1]$ 内。这两个条件的交集就是区间 $[\\lambda^2, 1]$，因为对于 $|\\lambda| \\le 1$，我们有 $0 \\le \\lambda^2 \\le 1$。\n\n因此，对于一个固定的 $\\lambda$ 且 $|\\lambda| \\le 1$，在 $[0,1]$ 中稳定的 $\\theta$ 值的集合是闭区间 $[\\lambda^2, 1]$。这个集合的下确界（最大下界）是其最小值，也就是区间的左端点。\n$$\n\\Theta(\\lambda) = \\inf[\\lambda^2, 1] = \\lambda^2\n$$\n这个函数 $\\Theta(\\lambda) = \\lambda^2$ 代表了对于给定的 Courant 数 $\\lambda$，为了使不稳定的前向时间中心空间格式（$\\theta=0$）达到稳定，所必须添加的最小人工粘性（由 $\\theta$ 参数化）。选择 $\\theta = \\lambda^2$ 会得到 Lax-Wendroff 格式，这是一个二阶精度的格式。",
            "answer": "$$\n\\boxed{\\lambda^2}\n$$"
        }
    ]
}