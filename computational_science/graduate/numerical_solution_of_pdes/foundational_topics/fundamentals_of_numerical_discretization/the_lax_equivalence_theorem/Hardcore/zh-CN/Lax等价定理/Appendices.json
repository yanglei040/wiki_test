{
    "hands_on_practices": [
        {
            "introduction": "在数值分析中，最直观的方法未必是最好的。本练习是一个经典的警示故事，它将探讨前向时间中心空间（FTCS）格式。通过对该格式的分析，你将亲手揭示一个看似合理且一致的格式为何会无条件不稳定，从而无法收敛。这个实践是理解拉克斯等价定理中“稳定性”重要性的绝佳起点。",
            "id": "3455897",
            "problem": "考虑在长度为 $L$ 的周期性空间域上，具有恒定波速 $a\\neq 0$ 的线性常系数平流偏微分方程 (PDE) $u_{t}+a\\,u_{x}=0$。设空间网格为 $x_{j}=j\\,\\Delta x$，其中 $j\\in\\mathbb{Z}$，$M$ 为某个正整数且 $\\Delta x=L/M$；并设时间层为 $t^{n}=n\\,\\Delta t$，其中 $\\Delta t>0$。使用向前时间中心空间 (FTCS) 差分格式将该偏微分方程离散化：\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right).\n$$\n使用基于离散傅里叶模的冯·诺依曼分析方法以及“所有模的放大有界”的稳定性定义，推导放大因子，并计算谱半径作为库朗数 $\\nu=\\dfrac{a\\,\\Delta t}{\\Delta x}$ 的函数。然后，仅使用相容性的基本定义和针对线性初值问题的Lax-Richtmyer等价定理（也称为Lax等价定理），解释为何FTCS格式即使是相容的，也无法对此偏微分方程收敛。\n\n您的最终答案必须是谱半径 $\\rho(\\nu)=\\sup_{\\theta\\in[-\\pi,\\pi]}|G(\\theta)|$ 关于 $a$、$\\Delta t$ 和 $\\Delta x$ 的闭式表达式。不需要数值近似。",
            "solution": "分析问题陈述后，认定其有效。该问题在科学上基于偏微分方程的数值分析，问题适定，目标明确，且无任何矛盾或含糊之处。该问题呈现了一个不稳定的数值格式及其通过Lax等价定理进行分析的经典案例。\n\n我们首先对应用于线性平流方程 $u_{t}+a\\,u_{x}=0$ 的向前时间中心空间 (FTCS) 格式进行冯·诺依曼稳定性分析。FTCS格式如下所示：\n$$\nu_{j}^{n+1}=u_{j}^{n}-\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n}-u_{j-1}^{n}\\right)\n$$\n在冯·诺依曼分析中，我们考虑数值解的单个傅里叶模的行为，其形式为 $u_j^n = G^n e^{i k x_j}$，其中 $k$ 是波数，$x_j = j\\Delta x$ 是空间坐标，$G$ 是取决于波数 $k$ 的放大因子。将此模代入差分格式可得：\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{2 \\Delta x} \\left( G^n e^{i k (j+1) \\Delta x} - G^n e^{i k (j-1) \\Delta x} \\right)\n$$\n将整个方程除以非零项 $G^n e^{i k j \\Delta x}$，得到放大因子 $G$：\n$$\nG = 1 - \\frac{a \\Delta t}{2 \\Delta x} \\left( e^{i k \\Delta x} - e^{-i k \\Delta x} \\right)\n$$\n使用欧拉恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$，并定义归一化波数或相角为 $\\theta = k \\Delta x$，我们得到：\n$$\nG(\\theta) = 1 - \\frac{a \\Delta t}{2 \\Delta x} (2i \\sin(\\theta))\n$$\n令 $\\nu = \\frac{a \\Delta t}{\\Delta x}$ 为库朗数。放大因子可以简明地表示为：\n$$\nG(\\theta) = 1 - i \\nu \\sin(\\theta)\n$$\n为了使一个格式在冯·诺依曼意义下是稳定的，放大因子的模必须对所有可能的相角 $\\theta \\in [-\\pi, \\pi]$ 满足 $|G(\\theta)| \\le 1$。我们来计算 $G(\\theta)$ 的模。作为一个复数，其模的平方是其实部和虚部平方的和：\n$$\n|G(\\theta)|^2 = (\\operatorname{Re}(G))^2 + (\\operatorname{Im}(G))^2 = 1^2 + (-\\nu \\sin(\\theta))^2 = 1 + \\nu^2 \\sin^2(\\theta)\n$$\n因此，放大因子的模为：\n$$\n|G(\\theta)| = \\sqrt{1 + \\nu^2 \\sin^2(\\theta)}\n$$\n谱半径 $\\rho(\\nu)$ 定义为该模在所有可能模态上的上确界：\n$$\n\\rho(\\nu)=\\sup_{\\theta\\in[-\\pi,\\pi]}|G(\\theta)| = \\sup_{\\theta\\in[-\\pi,\\pi]} \\sqrt{1 + \\nu^2 \\sin^2(\\theta)}\n$$\n为了找到这个上确界，我们必须在区间 $\\theta \\in [-\\pi, \\pi]$ 上最大化 $\\sin^2(\\theta)$ 项。$\\sin^2(\\theta)$ 的最大值为 $1$，在 $\\theta = \\pm \\pi/2$ 时取得。因此，谱半径为：\n$$\n\\rho(\\nu) = \\sqrt{1 + \\nu^2 (1)} = \\sqrt{1 + \\nu^2}\n$$\n代入库朗数 $\\nu$ 的定义，我们得到用给定参数表示的谱半径：\n$$\n\\rho = \\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2}\n$$\n现在，我们使用Lax等价定理来解释该格式为何不收敛。该定理指出，对于一个适定的线性初值问题，一个相容的线性有限差分格式是收敛的，当且仅当它是稳定的。\n\n首先，我们检查相容性。如果一个格式的截断误差在网格间距 $\\Delta t$ 和 $\\Delta x$ 趋于零时也趋于零，那么该格式是相容的。截断误差 $T_j^n$ 是通过将偏微分方程的精确解 $u(x, t)$ 代入差分方程得到的：\n$$\nT_j^n = \\frac{u(x_j, t^{n+1}) - u(x_j, t^n)}{\\Delta t} + \\frac{a}{2\\Delta x} (u(x_{j+1}, t^n) - u(x_{j-1}, t^n))\n$$\n使用在 $(x_j, t^n)$ 点的泰勒级数展开：\n$$\nu(x_j, t^{n+1}) = u(x_j, t^n) + \\Delta t \\, u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + O((\\Delta t)^3)\n$$\n$$\nu(x_{j\\pm 1}, t^n) = u(x_j, t^n) \\pm \\Delta x \\, u_x + \\frac{(\\Delta x)^2}{2} u_{xx} \\pm \\frac{(\\Delta x)^3}{6} u_{xxx} + O((\\Delta x)^4)\n$$\n将这些展开式代入 $T_j^n$ 的表达式中：\n$$\nT_j^n = \\left( u_t + \\frac{\\Delta t}{2}u_{tt} + \\dots \\right) + a \\left( u_x + \\frac{(\\Delta x)^2}{6}u_{xxx} + \\dots \\right)\n$$\n$$\nT_j^n = (u_t + a u_x) + \\frac{\\Delta t}{2}u_{tt} + a\\frac{(\\Delta x)^2}{6}u_{xxx} + \\dots\n$$\n由于 $u(x,t)$ 是精确解，所以 $u_t + a u_x = 0$。截断误差的主部是 $O(\\Delta t, (\\Delta x)^2)$。当 $\\Delta t \\to 0$ 和 $\\Delta x \\to 0$ 时，截断误差 $T_j^n \\to 0$。因此，FTCS格式与平流方程是相容的。\n\n接下来，我们检查稳定性。根据冯·诺依曼分析的推导，放大因子的模为 $|G(\\theta)| = \\sqrt{1 + \\nu^2 \\sin^2(\\theta)}$。问题指定 $a \\ne 0$，$\\Delta t > 0$，并且隐含 $\\Delta x > 0$。因此，库朗数 $\\nu = \\frac{a \\Delta t}{\\Delta x}$ 是非零的。对于任何满足 $\\sin(\\theta) \\ne 0$ 的模（这对几乎所有模都成立），$\\nu^2 \\sin^2(\\theta)$ 项是严格为正的。这意味着：\n$$\n|G(\\theta)| = \\sqrt{1 + \\nu^2 \\sin^2(\\theta)} > 1\n$$\n由于对于所有 $\\nu \\ne 0$ 和几乎所有模，稳定性条件 $|G(\\theta)| \\le 1$ 都不满足，所以FTCS格式是无条件不稳定的。对于任何非零的 $\\nu$，谱半径 $\\rho = \\sqrt{1 + \\nu^2}$ 严格大于 $1$。\n\n根据Lax等价定理，收敛性要求相容性和稳定性。我们已经证明FTCS格式是相容的，但却是无条件不稳定的。未能满足稳定性条件意味着该格式不收敛。其物理解释是，数值误差，特别是在高频模态（其中 $|\\sin(\\theta)|$ 较大）中的误差，在每个时间步都会被放大，导致指数级增长，迅速污染并压倒真实解。这种无条件不稳定性是FTCS格式对线性平流方程不收敛的原因。",
            "answer": "$$\n\\boxed{\\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2}}\n$$"
        },
        {
            "introduction": "见证了无条件不稳定的格式后，我们自然会问：如何构建一个稳定的格式？本练习将引导你分析蛙跳格式（leapfrog scheme），这是一种在时间和空间上均为二阶精度的常用方法。与 FTCS 格式不同，蛙跳格式是“有条件稳定”的，这个实践将带你从第一性原理出发，通过冯·诺依曼稳定性分析推导出著名的 Courant-Friedrichs-Lewy (CFL) 条件，深刻理解稳定性与离散参数之间的内在联系。",
            "id": "3455887",
            "problem": "考虑一维环面上的线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其具有周期性边界条件，其中 $a \\in \\mathbb{R}$ 是一个常数平流速度。使用时间上的蛙跳格式和空间上的中心差分，在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上对该 PDE 进行离散化：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = 0,\n$$\n其中 $u_{j}^{n}$ 近似于 $u(x_{j},t^{n})$，库朗数为 $\\lambda \\equiv a\\,\\Delta t/\\Delta x$。假设为周期性边界条件，因此离散傅里叶模构成一个完备基。使用 von Neumann 分析，通过设 $u_{j}^{n} = \\zeta^{n}\\,\\exp(i\\,j\\,\\kappa)$ 来独立处理每个傅里叶模，其中 $\\kappa \\in [-\\pi,\\pi]$ 是无量纲波数。\n\n任务：\n- 从离散傅里叶模的定义和给定的格式出发，推导放大因子 $\\zeta$ 作为 $\\kappa$ 和 $\\lambda$ 的函数所满足的二次方程，并显式求解以获得两个放大因子 $G_{\\pm}(\\kappa;\\lambda)$。\n- 将所有傅里叶模上的谱半径定义为 $\\rho(\\lambda) \\equiv \\sup_{\\kappa \\in [-\\pi,\\pi]} \\max\\{ |G_{+}(\\kappa;\\lambda)|,\\,|G_{-}(\\kappa;\\lambda)|\\}$。计算仅用 $\\lambda$ 表示的 $\\rho(\\lambda)$ 的闭式表达式。\n- 仅使用局部截断误差的基本定义和关于 $(x_{j},t^{n})$ 的泰勒展开，证明该格式在 $\\Delta t$ 和 $\\Delta x$ 上都至少是 2 阶相容的。\n- 解释为什么集合 $\\{ \\lambda \\in \\mathbb{R} : \\rho(\\lambda) \\le 1 \\}$ 是此格式在周期性区域上的 von Neumann 稳定区域。然后，使用 Lax 等价定理 (LET)——该定理指出，对于一个适定的线性初值问题，一个有限差分格式是收敛的当且仅当它是相容且稳定的——来证明，如果 Courant–Friedrichs–Lewy (CFL) 条件 $|\\lambda| \\le 1$ 被违反，尽管格式是相容的，数值解对于某些初始数据仍会发散。\n\n作为最终答案，给出上面求得的函数 $\\rho(\\lambda)$ 的闭式解析表达式。不需要进行数值四舍五入；请精确表达您的答案，并且不要包含单位。",
            "solution": "所述问题是偏微分方程数值分析领域中一个标准的、适定的问题。它有科学依据，内容自洽且客观。所有给出的定义和条件都是标准且一致的。因此，该问题是有效的，并且可以推导出一个完整的解。\n\n该问题要求对线性平流方程的蛙跳格式进行四个部分的分析。我们将按顺序处理每个部分。\n\n首先，我们推导放大因子 $G_{\\pm}(\\kappa;\\lambda)$。给定的有限差分格式是：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = 0\n$$\n我们通过乘以 $2\\,\\Delta t$ 并使用库朗数定义 $\\lambda = a\\,\\Delta t/\\Delta x$ 来重新整理该式：\n$$\nu_{j}^{n+1} - u_{j}^{n-1} + \\lambda (u_{j+1}^{n} - u_{j-1}^{n}) = 0\n$$\n为了进行 von Neumann 稳定性分析，我们将傅里叶模 ansatz $u_{j}^{n} = \\zeta^{n}\\,\\exp(i\\,j\\,\\kappa)$ 代入格式中。项 $u_{j}^{n}$ 变为 $\\zeta^n \\exp(ijk)$，$u_{j}^{n+1}$ 变为 $\\zeta^{n+1} \\exp(ijk)$，$u_{j+1}^{n}$ 变为 $\\zeta^n \\exp(i(j+1)k)$，以此类推。\n$$\n\\zeta^{n+1}\\exp(i\\,j\\,\\kappa) - \\zeta^{n-1}\\exp(i\\,j\\,\\kappa) + \\lambda \\left( \\zeta^{n}\\exp(i\\,(j+1)\\,\\kappa) - \\zeta^{n}\\exp(i\\,(j-1)\\,\\kappa) \\right) = 0\n$$\n将整个方程除以公共的、非零的因子 $\\zeta^{n-1}\\exp(i\\,j\\,\\kappa)$，得到：\n$$\n\\zeta^{2} - 1 + \\lambda \\zeta \\left( \\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa) \\right) = 0\n$$\n使用欧拉恒等式 $\\sin(\\kappa) = \\frac{\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa)}{2i}$，我们可以将括号中的表达式简化为 $2i\\sin(\\kappa)$。\n$$\n\\zeta^{2} - 1 + \\lambda \\zeta (2i\\sin(\\kappa)) = 0\n$$\n这给出了放大因子 $\\zeta$ 所需的二次方程：\n$$\n\\zeta^2 + (2i\\lambda\\sin(\\kappa))\\zeta - 1 = 0\n$$\n我们使用二次求根公式 $\\zeta = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$ 来求解这个关于 $\\zeta$ 的方程，其中系数为 $a=1$, $b=2i\\lambda\\sin(\\kappa)$ 和 $c=-1$。\n$$\n\\zeta = \\frac{-2i\\lambda\\sin(\\kappa) \\pm \\sqrt{(2i\\lambda\\sin(\\kappa))^2 - 4(1)(-1)}}{2(1)}\n$$\n$$\n\\zeta = \\frac{-2i\\lambda\\sin(\\kappa) \\pm \\sqrt{-4\\lambda^2\\sin^2(\\kappa) + 4}}{2}\n$$\n$$\n\\zeta = \\frac{-2i\\lambda\\sin(\\kappa) \\pm 2\\sqrt{1 - \\lambda^2\\sin^2(\\kappa)}}{2}\n$$\n这得到了两个放大因子 $G_{\\pm}(\\kappa;\\lambda)$：\n$$\nG_{\\pm}(\\kappa;\\lambda) = -i\\lambda\\sin(\\kappa) \\pm \\sqrt{1 - \\lambda^2\\sin^2(\\kappa)}\n$$\n\n第二，我们计算谱半径 $\\rho(\\lambda) = \\sup_{\\kappa \\in [-\\pi,\\pi]} \\max\\{ |G_{+}(\\kappa;\\lambda)|,\\,|G_{-}(\\kappa;\\lambda)|\\}$。我们通过考虑平方根下项的两种情况来分析 $G_{\\pm}$ 的模。\n\n情况 1：$1 - \\lambda^2\\sin^2(\\kappa) \\ge 0$，这等价于 $|\\lambda\\sin(\\kappa)| \\le 1$。在这种情况下，平方根是实数。设 $\\alpha = \\sqrt{1 - \\lambda^2\\sin^2(\\kappa)}$。放大因子为 $G_{\\pm} = \\pm\\alpha - i\\lambda\\sin(\\kappa)$。模的平方为：\n$$\n|G_{\\pm}|^2 = (\\pm\\alpha)^2 + (-\\lambda\\sin(\\kappa))^2 = \\alpha^2 + \\lambda^2\\sin^2(\\kappa) = (1 - \\lambda^2\\sin^2(\\kappa)) + \\lambda^2\\sin^2(\\kappa) = 1\n$$\n因此，当 $|\\lambda\\sin(\\kappa)| \\le 1$ 时，始终有 $|G_{+}| = |G_{-}| = 1$。\n\n情况 2：$1 - \\lambda^2\\sin^2(\\kappa)  0$，这等价于 $|\\lambda\\sin(\\kappa)|  1$。在这种情况下，平方根是虚数。设 $\\beta = \\sqrt{\\lambda^2\\sin^2(\\kappa) - 1}$。平方根项变为 $\\sqrt{-(\\lambda^2\\sin^2(\\kappa) - 1)} = i\\beta$。放大因子为 $G_{\\pm} = -i\\lambda\\sin(\\kappa) \\pm i\\beta = i(-\\lambda\\sin(\\kappa) \\pm \\beta)$。这些是纯虚数。它们的模是：\n$$\n|G_{\\pm}| = |-\\lambda\\sin(\\kappa) \\pm \\sqrt{\\lambda^2\\sin^2(\\kappa) - 1}|\n$$\n为了求谱半径 $\\rho(\\lambda)$，我们必须找到这些模在所有 $\\kappa \\in [-\\pi,\\pi]$ 上的上确界。\n如果 $|\\lambda| \\le 1$，那么对于所有的 $\\kappa$，都有 $|\\sin(\\kappa)| \\le 1$，这意味着 $|\\lambda\\sin(\\kappa)| \\le |\\lambda| \\le 1$。我们总是在情况 1 中，所以 $|G_{\\pm}|$ 总是 $1$。上确界是 $1$。因此，当 $|\\lambda| \\le 1$ 时，$\\rho(\\lambda) = 1$。\n如果 $|\\lambda|  1$，则存在某些 $\\kappa$ 值使得 $|\\lambda\\sin(\\kappa)|  1$。当 $|\\sin(\\kappa)|$ 最大化时，即 $|\\sin(\\kappa)| = 1$ 时，$|G_{\\pm}|$ 的模将达到最大值，这发生在 $\\kappa = \\pm\\pi/2$。我们选择 $\\kappa = \\pi/2$，因此 $\\sin(\\kappa)=1$。那么 $|\\lambda\\sin(\\kappa)| = |\\lambda|  1$，这使我们处于情况 2。其模为：\n$$\n|G_{\\pm}| = |-\\lambda \\pm \\sqrt{\\lambda^2 - 1}|\n$$\n由于 $|\\lambda|  1$，我们有 $\\sqrt{\\lambda^2-1}  |\\lambda|$。我们假设 $\\lambda  1$。那么 $|G_{\\pm}| = |-\\lambda \\pm \\sqrt{\\lambda^2-1}| = \\lambda \\mp \\sqrt{\\lambda^2-1}$。这两个值的最大值是 $\\lambda + \\sqrt{\\lambda^2-1}$。如果 $\\lambda  -1$，那么令 $\\lambda' = -\\lambda  1$。在 $\\kappa=\\pi/2$ 处，$\\lambda\\sin\\kappa = \\lambda = -\\lambda'$。其模为 $|-(-\\lambda') \\pm \\sqrt{(-\\lambda')^2-1}| = |\\lambda' \\pm \\sqrt{\\lambda'^2-1}| = \\lambda' \\pm \\sqrt{\\lambda'^2-1}$，其中的最大值是 $\\lambda' + \\sqrt{\\lambda'^2-1} = |\\lambda| + \\sqrt{\\lambda^2-1}$。\n因此，对于 $|\\lambda|  1$，谱半径为 $\\rho(\\lambda) = \\sup_{\\kappa} |G_{\\pm}| = |\\lambda| + \\sqrt{\\lambda^2 - 1}$。\n结合这两种情况，$\\rho(\\lambda)$ 的闭式表达式为：\n$$\n\\rho(\\lambda) =\n\\begin{cases}\n1  \\text{if } |\\lambda| \\le 1 \\\\\n|\\lambda| + \\sqrt{\\lambda^2-1}  \\text{if } |\\lambda|  1\n\\end{cases}\n$$\n\n第三，我们证明该格式在 $\\Delta t$ 和 $\\Delta x$ 上都至少是 2 阶相容的。将精确解 $u(x,t)$ 代入差分算子，得到局部截断误差 (LTE) $\\tau_{j}^{n}$：\n$$\n\\tau_{j}^{n} = \\frac{u(x_{j}, t^{n+1}) - u(x_{j}, t^{n-1})}{2\\Delta t} + a \\frac{u(x_{j}+\\Delta x, t^{n}) - u(x_{j}-\\Delta x, t^{n})}{2\\Delta x}\n$$\n我们使用关于点 $(x_{j}, t^{n})$ 的泰勒级数展开：\n$u(x_j, t^{n\\pm1}) = u \\pm \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} \\pm \\frac{(\\Delta t)^3}{6} u_{ttt} + O(\\Delta t^4)$\n$u(x_{j\\pm1}, t^n) = u \\pm \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} \\pm \\frac{(\\Delta x)^3}{6} u_{xxx} + O(\\Delta x^4)$\n将这些展开式代入 $\\tau_j^n$ 的表达式中：\n时间导数项变为：\n$$\n\\frac{1}{2\\Delta t} \\left[ (u + \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} + \\frac{(\\Delta t)^3}{6} u_{ttt}) - (u - \\Delta t u_t + \\frac{(\\Delta t)^2}{2} u_{tt} - \\frac{(\\Delta t)^3}{6} u_{ttt}) + O(\\Delta t^5) \\right] = u_t + \\frac{(\\Delta t)^2}{6} u_{ttt} + O(\\Delta t^4)\n$$\n空间导数项变为：\n$$\n\\frac{a}{2\\Delta x} \\left[ (u + \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} + \\frac{(\\Delta x)^3}{6} u_{xxx}) - (u - \\Delta x u_x + \\frac{(\\Delta x)^2}{2} u_{xx} - \\frac{(\\Delta x)^3}{6} u_{xxx}) + O(\\Delta x^5) \\right] = a u_x + a\\frac{(\\Delta x)^2}{6} u_{xxx} + O(\\Delta x^4)\n$$\n结合这些，LTE 为：\n$$\n\\tau_{j}^{n} = (u_t + a u_x) + \\frac{(\\Delta t)^2}{6}u_{ttt} + a\\frac{(\\Delta x)^2}{6}u_{xxx} + O(\\Delta t^4) + O(\\Delta x^4)\n$$\n由于 $u(x,t)$ 是 PDE 的精确解，所以 $u_t + a u_x = 0$。因此，LTE 为：\n$$\n\\tau_{j}^{n} = \\frac{(\\Delta t)^2}{6}u_{ttt} + a\\frac{(\\Delta x)^2}{6}u_{xxx} + O(\\Delta t^4, \\Delta x^4)\n$$\nLTE 是 $O(\\Delta t^2, \\Delta x^2)$ 阶的。由于当 $\\Delta t, \\Delta x \\to 0$ 时 $\\tau_{j}^{n} \\to 0$，该格式是相容的。相容阶为 $(2,2)$，这在 $\\Delta t$ 和 $\\Delta x$ 上都至少是 2 阶。\n\n第四，我们解释稳定区域并使用 Lax 等价定理 (LET)。\n对于像蛙跳格式这样的多步格式，von Neumann 稳定性要求所有放大因子的模对于所有波数都不大于 1，即对所有 $\\kappa \\in [-\\pi,\\pi]$ 都有 $|G_{\\pm}(\\kappa; \\lambda)| \\le 1$。此外，为了满足 Lax-Richtmyer 稳定性（放大矩阵幂的一致有界性），任何模为 1 的根都必须是单根。条件 $\\sup_{\\kappa} |G_{\\pm}(\\kappa; \\lambda)| \\le 1$ 等价于谱半径 $\\rho(\\lambda) \\le 1$。根据我们对 $\\rho(\\lambda)$ 的分析，此条件当且仅当 $|\\lambda| \\le 1$ 时成立。因此，该格式的 von Neumann 稳定区域是 $\\{\\lambda \\in \\mathbb{R} : |\\lambda| \\le 1\\}$，这正是 Courant–Friedrichs–Lewy (CFL) 条件。\n\nLax 等价定理指出，对于一个适定的线性初值问题，一个有限差分格式是收敛的当且仅当它是相容且稳定的。\n我们已经证明了蛙跳格式是相容的（任务 3）。现在，让我们来证明当 CFL 条件 $|\\lambda| \\le 1$ 被违反时解会发散。假设 $|\\lambda|  1$。\n从任务 2 我们知道，在这种情况下，谱半径为 $\\rho(\\lambda) = |\\lambda| + \\sqrt{\\lambda^2-1}  1$。这个最大放大率是在某个波数 $\\kappa_0$ 处达到的，例如 $\\kappa_0 = \\pi/2$。我们将具有此模的相应放大因子称为 $G_{max}$。\n由于线性格式是逐个模态分析的，我们可以考虑仅由这个最不稳定的模组成的初始数据，例如 $u_j^0 = \\exp(ij\\kappa_0)$。要启动两步蛙跳格式，我们还需要 $u_j^1$。如果我们假设解以纯模的形式演化，则 $u_j^1 = G_{max} u_j^0$。那么，这个模在时间步 $n$ 的解由 $u_j^n = (G_{max})^n \\exp(ij\\kappa_0)$ 给出。\n在第 $n$ 步解的模为 $|u_j^n| = |G_{max}|^n = (\\rho(\\lambda))^n$。\n由于 $\\rho(\\lambda)  1$，这个傅里叶模的振幅随着时间步数 $n$ 的增加而指数增长：当 $n \\to \\infty$ 时，$(\\rho(\\lambda))^n \\to \\infty$。对于任意固定的时间 $t  0$，当网格加密时（$\\Delta t \\to 0$），步数 $n = t/\\Delta t$ 趋于无穷大，导致数值解无界。\n因此，当 $|\\lambda|1$ 时格式是不稳定的。根据 Lax 等价定理，由于该格式是相容的但不稳定，它不可能是收敛的。这表明，违反 CFL 条件会导致数值解发散，尽管该格式在形式上与 PDE 相容。",
            "answer": "$$\n\\boxed{\n\\rho(\\lambda) =\n\\begin{cases}\n1  \\text{如果 } |\\lambda| \\le 1 \\\\\n|\\lambda| + \\sqrt{\\lambda^2-1}  \\text{如果 } |\\lambda| > 1\n\\end{cases}\n}\n$$"
        },
        {
            "introduction": "我们不必孤立地看待每一种格式，而是可以将它们视为一个更广泛家族的成员。本练习介绍了一个包含多种格式（如 FTCS、Lax-Friedrichs 和迎风格式）的参数化格式族。这个实践的核心是让你探索“人工粘性”这一关键概念，它是一种通过在格式中添加耗散项来确保稳定性的强大技术。通过确定稳定区域，你将学会如何系统地设计和调整数值格式以满足收敛性要求，从而将之前练习中的概念融会贯通。",
            "id": "3455861",
            "problem": "考虑线性平流初值问题 $u_{t} + a\\,u_{x} = 0$ 在 $\\mathbb{R}$ 上，初值数据光滑，其中 $a \\neq 0$ 为常数。在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，定义 Courant–Friedrichs–Lewy 数 $\\lambda = a\\,\\Delta t/\\Delta x$。研究以下双参数显式三点线性格式族\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j} \\;-\\; \\frac{\\lambda}{2}\\left(u^{n}_{j+1}-u^{n}_{j-1}\\right) \\;+\\; \\frac{\\theta}{2}\\left(u^{n}_{j+1}-2u^{n}_{j}+u^{n}_{j-1}\\right),\n$$\n其中 $\\theta$ 为实参数。该格式族是向前时间中心空间格式（$\\theta=0$）、Lax–Friedrichs 格式（$\\theta=1$）以及（对于 $a0$）迎风格式（$\\theta=\\lambda$）之间的插值。利用线性相容性、通过傅里叶（von Neumann）分析得到的 $\\ell^{2}$ 范数稳定性的定义，以及 Lax 等价定理，完成以下任务：\n\n1. 从离散更新方程出发，推导单个傅里叶模 $e^{\\mathrm{i}j\\xi}$ 的傅里叶放大因子 $g(\\xi)$，并根据对所有实数 $\\xi$ 都有 $|g(\\xi)| \\le 1$ 的要求，得出 $(\\lambda,\\theta)$ 满足 $\\ell^{2}$ 稳定性的充要条件。\n2. 从第一性原理出发，确定 $(\\lambda,\\theta)$ 平面上的完整稳定区域，并找出其边界曲线。\n3. 解释为何在整个稳定区域内，当 $\\Delta t,\\Delta x \\to 0$ 且 $\\lambda$ 固定时，该格式收敛于 $u_{t}+a\\,u_{x}=0$ 的解，并解释为何在该区域外不收敛。\n\n你的最终答案必须是保证在 $|\\lambda|\\le 1$ 时稳定的最小人工黏性 $\\Theta(\\lambda)$ 的单一解析表达式，其定义为\n$$\n\\Theta(\\lambda) \\;=\\; \\inf\\left\\{\\theta\\in[0,1]:\\; (\\lambda,\\theta)\\ \\text{is}\\ \\ell^{2}\\text{-stable}\\right\\}.\n$$\n不需要进行数值计算；请以 $\\lambda$ 的闭合形式函数提供 $\\Theta(\\lambda)$。",
            "solution": "本题要求分析一个用于线性平流方程的双参数有限差分格式族。这包括推导稳定性条件、刻画稳定区域、通过 Lax 等价定理讨论收敛性，并最终确定最小稳定人工黏性参数的表达式。\n\n线性平流方程由下式给出\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n对于函数 $u(x,t)$ 在 $\\mathbb{R} \\times [0, \\infty)$ 上，其中 $a$ 是一个非零常数平流速度。所考虑的数值格式为\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j} \\;-\\; \\frac{\\lambda}{2}\\left(u^{n}_{j+1}-u^{n}_{j-1}\\right) \\;+\\; \\frac{\\theta}{2}\\left(u^{n}_{j+1}-2u^{n}_{j}+u^{n}_{j-1}\\right)\n$$\n其中 $\\lambda = a\\,\\Delta t/\\Delta x$ 是 Courant 数，$\\theta$ 是一个实参数。\n\n**1. 放大因子和稳定性条件的推导**\n\n为了进行 von Neumann 稳定性分析，我们考虑时间层 $n$ 上数值解的单个傅里叶模，形式为 $u^n_j = \\hat{u}^n(\\xi) e^{\\mathrm{i} j \\xi}$，其中 $\\xi = k_w \\Delta x$ 是对应于波数 $k_w$ 的无量纲波数。由于格式是线性的，下一时间层的解可以写为 $u^{n+1}_j = \\hat{u}^{n+1}(\\xi) e^{\\mathrm{i} j \\xi}$。放大因子 $g(\\xi)$ 由关系式 $\\hat{u}^{n+1}(\\xi) = g(\\xi) \\hat{u}^n(\\xi)$ 定义。\n\n将傅里叶模代入格式中，我们得到：\n$$\ng(\\xi) e^{\\mathrm{i} j \\xi} = e^{\\mathrm{i} j \\xi} - \\frac{\\lambda}{2}\\left(e^{\\mathrm{i} (j+1) \\xi} - e^{\\mathrm{i} (j-1) \\xi}\\right) + \\frac{\\theta}{2}\\left(e^{\\mathrm{i} (j+1) \\xi} - 2e^{\\mathrm{i} j \\xi} + e^{\\mathrm{i} (j-1) \\xi}\\right)\n$$\n两边同除以公因子 $e^{\\mathrm{i} j \\xi}$，得到 $g(\\xi)$ 的表达式：\n$$\ng(\\xi) = 1 - \\frac{\\lambda}{2}\\left(e^{\\mathrm{i} \\xi} - e^{-\\mathrm{i} \\xi}\\right) + \\frac{\\theta}{2}\\left(e^{\\mathrm{i} \\xi} - 2 + e^{-\\mathrm{i} \\xi}\\right)\n$$\n使用欧拉恒等式 $e^{\\mathrm{i} \\xi} - e^{-\\mathrm{i} \\xi} = 2\\mathrm{i}\\sin(\\xi)$ 和 $e^{\\mathrm{i} \\xi} + e^{-\\mathrm{i} \\xi} = 2\\cos(\\xi)$，我们可以简化 $g(\\xi)$：\n$$\ng(\\xi) = 1 - \\mathrm{i}\\lambda\\sin(\\xi) + \\theta(\\cos(\\xi)-1)\n$$\n$g(\\xi)$ 的实部和虚部分别是：\n$$\n\\operatorname{Re}(g(\\xi)) = 1 + \\theta(\\cos(\\xi)-1) = 1 - 2\\theta\\sin^2\\left(\\frac{\\xi}{2}\\right)\n$$\n$$\n\\operatorname{Im}(g(\\xi)) = -\\lambda\\sin(\\xi)\n$$\n为了使格式在 $\\ell^2$ 范数下稳定，von Neumann 稳定性条件要求对于所有可能的波数 $\\xi \\in [-\\pi, \\pi]$，放大因子的模长小于或等于 $1$。即 $|g(\\xi)| \\le 1$，这等价于 $|g(\\xi)|^2 \\le 1$。\n$$\n|g(\\xi)|^2 = (\\operatorname{Re}(g(\\xi)))^2 + (\\operatorname{Im}(g(\\xi)))^2 = (1 + \\theta(\\cos(\\xi)-1))^2 + (-\\lambda\\sin(\\xi))^2 \\le 1\n$$\n我们展开这个表达式：\n$$\n1 + 2\\theta(\\cos(\\xi)-1) + \\theta^2(\\cos(\\xi)-1)^2 + \\lambda^2\\sin^2(\\xi) \\le 1\n$$\n两边减去 $1$ 并使用恒等式 $\\sin^2(\\xi) = 1-\\cos^2(\\xi) = (1-\\cos(\\xi))(1+\\cos(\\xi))$ 得到：\n$$\n2\\theta(\\cos(\\xi)-1) + \\theta^2(\\cos(\\xi)-1)^2 + \\lambda^2(1-\\cos(\\xi))(1+\\cos(\\xi)) \\le 0\n$$\n令 $C = 1-\\cos(\\xi)$。注意对于 $\\xi \\in [-\\pi, \\pi]$，$C$ 的取值范围是从 $0$ 到 $2$。不等式变为：\n$$\n-2\\theta C + \\theta^2 C^2 + \\lambda^2 C(2-C) \\le 0\n$$\n当 $C=0$（即 $\\xi=0$）时，不等式平凡地成立（$0 \\le 0$）。当 $C0$ 时，我们可以两边同除以 $C$：\n$$\n-2\\theta + \\theta^2 C + \\lambda^2(2-C) \\le 0\n$$\n将各项重新排列为关于 $C$ 的线性函数：\n$$\n(2\\lambda^2 - 2\\theta) + C(\\theta^2 - \\lambda^2) \\le 0\n$$\n这个不等式必须对所有的 $C \\in (0, 2]$ 成立。我们定义函数 $F(C) = (2\\lambda^2 - 2\\theta) + C(\\theta^2 - \\lambda^2)$。由于 $F(C)$ 是关于 $C$ 的线性函数，要使其在区间 $(0, 2]$ 上非正，只需检查其在区间边界 $C \\to 0^+$ 和 $C=2$ 处的值。\n\n条件 1：当 $C \\to 0^+$ 时，必须有 $F(0^+) \\le 0$。\n$$\n2\\lambda^2 - 2\\theta \\le 0 \\implies \\lambda^2 \\le \\theta\n$$\n条件 2：在 $C=2$ 处（对应于 $\\xi=\\pm\\pi$），必须有 $F(2) \\le 0$。\n$$\n(2\\lambda^2 - 2\\theta) + 2(\\theta^2 - \\lambda^2) \\le 0\n$$\n$$\n2\\lambda^2 - 2\\theta + 2\\theta^2 - 2\\lambda^2 \\le 0\n$$\n$$\n2\\theta^2 - 2\\theta \\le 0 \\implies 2\\theta(\\theta-1) \\le 0\n$$\n这最后一个不等式当且仅当 $0 \\le \\theta \\le 1$ 时成立。\n\n结合这两个必要条件，我们发现为了使格式稳定，参数 $(\\lambda, \\theta)$ 必须满足：\n$$\n\\lambda^2 \\le \\theta \\quad \\text{and} \\quad 0 \\le \\theta \\le 1\n$$\n这些条件也是充分的。如果它们成立，函数 $F(C)$ 在区间 $[0, 2]$ 的两端都是非正的。由于 $F(C)$ 是线性的，它必须对所有的 $C \\in [0, 2]$ 都是非正的。因此，条件 $|g(\\xi)|^2 \\le 1$ 对所有 $\\xi$ 都成立。$\\ell^2$ 稳定性的充要条件是 $\\lambda^2 \\le \\theta \\le 1$。\n\n**2. $(\\lambda, \\theta)$ 平面上的稳定区域**\n\n稳定区域是平面上所有满足条件 $\\lambda^2 \\le \\theta$ 和 $0 \\le \\theta \\le 1$ 的点 $(\\lambda, \\theta)$ 的集合。\n第二个条件 $0 \\le \\theta \\le 1$ 将区域限制在直线 $\\theta=0$ 和 $\\theta=1$ 之间的水平带状区域内。\n第一个条件 $\\lambda^2 \\le \\theta$ 意味着对于给定的 $\\lambda$，稳定的 $\\theta$ 值必须位于抛物线 $\\theta=\\lambda^2$ 上或其上方。\n综合这些，稳定区域是 $(\\lambda, \\theta)$ 平面上位于抛物线 $\\theta = \\lambda^2$ 上方或之上，且位于直线 $\\theta = 1$ 下方或之上的区域。\n该区域的边界是以下曲线：\n- 抛物线 $\\theta = \\lambda^2$。\n- 对于 $\\lambda \\in [-1, 1]$ 的水平线段 $\\theta = 1$。\n交点可通过令 $\\lambda^2 = 1$ 求得，即 $\\lambda = \\pm 1$。交点是 $(-1, 1)$ 和 $(1, 1)$。抛物线的顶点在 $(0, 0)$。因此，完整的稳定区域由 $\\lambda^2 \\le \\theta \\le 1$ 描述，这也意味着 $|\\lambda| \\le \\sqrt{\\theta} \\le \\sqrt{1} = 1$。所以，只有当 $|\\lambda| \\le 1$ 时才可能稳定。\n\n**3. 收敛性与 Lax 等价定理**\n\nLax 等价定理指出，对于一个适定的线性初值问题，一个相容的线性有限差分格式是收敛的当且仅当它是稳定的。\n\n首先，我们确定相容性。截断误差 $T_j^n$ 是通过将偏微分方程的精确解 $u(x, t)$ 代入有限差分格式得到的。\n$$\nT_j^n = \\frac{u_j^{n+1}-u_j^n}{\\Delta t} - \\frac{1}{\\Delta t}\\left[-\\frac{\\lambda}{2}(u_{j+1}^n-u_{j-1}^n) + \\frac{\\theta}{2}(u_{j+1}^n-2u_j^n+u_{j-1}^n) \\right]\n$$\n使用 $\\lambda = a \\Delta t/\\Delta x$，这可以写成：\n$$\nT_j^n = \\frac{u_j^{n+1}-u_j^n}{\\Delta t} + a\\frac{u_{j+1}^n-u_{j-1}^n}{2\\Delta x} - \\frac{\\theta \\Delta x^2}{2\\Delta t}\\frac{u_{j+1}^n-2u_j^n+u_{j-1}^n}{\\Delta x^2}\n$$\n将每一项在 $(x_j, t_n)$ 附近进行泰勒展开：\n- $\\frac{u_j^{n+1}-u_j^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + O(\\Delta t^2)$\n- $\\frac{u_{j+1}^n-u_{j-1}^n}{2\\Delta x} = u_x + \\frac{\\Delta x^2}{6}u_{xxx} + O(\\Delta x^4)$\n- $\\frac{u_{j+1}^n-2u_j^n+u_{j-1}^n}{\\Delta x^2} = u_{xx} + \\frac{\\Delta x^2}{12}u_{xxxx} + O(\\Delta x^4)$\n将这些代入 $T_j^n$ 的表达式中：\n$$\nT_j^n = (u_t + au_x) + \\frac{\\Delta t}{2}u_{tt} + a\\frac{\\Delta x^2}{6}u_{xxx} - \\frac{\\theta \\Delta x^2}{2\\Delta t}u_{xx} + \\text{h.o.t.}\n$$\n由于 $u$ 是偏微分方程的解，所以 $u_t+au_x=0$。同时，对偏微分方程求导可得 $u_{tt} = a^2 u_{xx}$。\n$$\nT_j^n = \\frac{\\Delta t}{2}a^2 u_{xx} - \\frac{\\theta \\Delta x^2}{2\\Delta t}u_{xx} + \\text{h.o.t.} = \\left(\\frac{a^2 \\Delta t}{2} - \\frac{\\theta \\Delta x^2}{2\\Delta t}\\right)u_{xx} + \\text{h.o.t.}\n$$\n使用 $\\lambda = a\\Delta t/\\Delta x$ 可以将其改写为：\n$$\nT_j^n = \\frac{a^2\\Delta t}{2\\lambda^2}(\\lambda^2-\\theta)u_{xx} + \\text{h.o.t.}\n$$\n如果 $\\Delta t, \\Delta x \\to 0$ 而 $\\lambda$保持固定，那么 $\\Delta x$与 $\\Delta t$成正比。截断误差的主项是 $O(\\Delta t)$。当 $\\Delta t \\to 0$ 时，$T_j^n \\to 0$。因此，对于任何 $\\lambda$ 和 $\\theta$ 的选择，该格式都是相容的。\n\n在确定了相容性之后，Lax 等价定理可以直接应用：\n- 在整个稳定区域 $\\lambda^2 \\le \\theta \\le 1$ 内，该格式是稳定的。由于它也是相容的，所以它是收斂的。当 $\\Delta t, \\Delta x \\to 0$（且 $\\lambda$ 固定）时，数值解将趋近于 $u_t + a u_x = 0$ 的真实解。\n- 在该区域之外，格式是不稳定的（对于某些 $\\xi$ 有 $|g(\\xi)|  1$）。不稳定的格式不可能是收敛的。微小的误差（如舍入误差）将在每个时间步被放大，导致指数级增长，完全淹没真实解。因此，该格式在稳定区域之外不收敛。\n\n**$\\Theta(\\lambda)$ 的确定**\n\n本题要求解函数 $\\Theta(\\lambda)$，它被定义为对于给定的 $\\lambda$，稳定化参数 $\\theta \\in [0, 1]$ 集合的下确界：\n$$\n\\Theta(\\lambda) = \\inf\\left\\{\\theta\\in[0,1]:\\; (\\lambda,\\theta)\\ \\text{is}\\ \\ell^{2}\\text{-stable}\\right\\}\n$$\n这需要在 $|\\lambda| \\le 1$ 的条件下确定。根据我们的稳定性分析，对于一个固定的 $\\lambda$ 值（满足 $|\\lambda| \\le 1$），使格式稳定的 $\\theta$ 值集合由不等式 $\\lambda^2 \\le \\theta \\le 1$ 给出。题目进一步将 $\\theta$ 限制在区间 $[0, 1]$ 内。这两个条件的交集就是区间 $[\\lambda^2, 1]$，因为对于 $|\\lambda| \\le 1$，我们有 $0 \\le \\lambda^2 \\le 1$。\n\n因此，对于固定的 $\\lambda$（满足 $|\\lambda| \\le 1$），在 $[0,1]$ 内的稳定 $\\theta$ 值集合是闭区间 $[\\lambda^2, 1]$。该集合的下确界（最大下界）是其最小值，即区间的左端点。\n$$\n\\Theta(\\lambda) = \\inf[\\lambda^2, 1] = \\lambda^2\n$$\n这个函数 $\\Theta(\\lambda) = \\lambda^2$ 代表了为了使不稳定的向前时间中心空间格式（$\\theta=0$）在给定的 Courant 数 $\\lambda$ 下达到稳定，所必须添加的最小人工黏性量（由 $\\theta$ 参数化）。选择 $\\theta = \\lambda^2$ 得到的是 Lax-Wendroff 格式，该格式是二阶精度的。",
            "answer": "$$\n\\boxed{\\lambda^2}\n$$"
        }
    ]
}