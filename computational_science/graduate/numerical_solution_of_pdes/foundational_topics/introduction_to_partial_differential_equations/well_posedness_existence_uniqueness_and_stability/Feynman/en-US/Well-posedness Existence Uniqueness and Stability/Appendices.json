{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of analyzing numerical schemes for linear partial differential equations is the Fourier stability analysis, also known as von Neumann analysis. This powerful technique decomposes the numerical error into its Fourier modes and examines whether these modes are amplified or damped over time. This first practice applies this fundamental tool to the Forward Time, Centered Space (FTCS) discretization of the heat equation, a canonical example of a parabolic PDE. By deriving the amplification factor, you will uncover the famous conditional stability constraint that links the time step, spatial grid size, and physical diffusivity, providing a crucial first-hand look at the practical limits of explicit methods .",
            "id": "3463196",
            "problem": "Consider the one-dimensional heat equation $u_{t} = \\nu\\,u_{xx}$ on a periodic spatial domain, where $\\nu > 0$ is a constant diffusivity. Let a uniform spatial grid with spacing $\\Delta x$ and a uniform temporal grid with time step $\\Delta t$ be used. Define the Forward Time Centered Space (FTCS) explicit finite difference scheme as follows: at grid point $x_{j} = j\\,\\Delta x$ and time level $t^{n} = n\\,\\Delta t$, the approximate solution $U_{j}^{n}$ satisfies\n$$\nU_{j}^{n+1} = U_{j}^{n} + \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(U_{j+1}^{n} - 2\\,U_{j}^{n} + U_{j-1}^{n}\\right).\n$$\nUsing Fourier stability analysis (von Neumann analysis), start from the fundamental definition of stability for linear constant-coefficient schemes in the discrete $L^{2}$ norm, introduce the amplification factor for single Fourier modes, and derive the necessary and sufficient condition on $\\Delta t$ and $\\Delta x$ that guarantees stability of the FTCS scheme for all spatial Fourier wavenumbers compatible with the grid. Then, from this condition, determine the largest stable time step $\\Delta t_{\\max}$ expressed explicitly in terms of $\\nu$ and $\\Delta x$. Provide your final answer as a single closed-form analytic expression for $\\Delta t_{\\max}$. No rounding is required, and no units should be included in the final expression.",
            "solution": "The problem requires the derivation of the stability condition for the Forward Time Centered Space (FTCS) scheme for the one-dimensional heat equation, $u_{t} = \\nu\\,u_{xx}$, using Fourier stability analysis, also known as von Neumann analysis. The final goal is to determine the maximum stable time step, $\\Delta t_{\\max}$.\n\nThe FTCS scheme is given by:\n$$\nU_{j}^{n+1} = U_{j}^{n} + \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(U_{j+1}^{n} - 2\\,U_{j}^{n} + U_{j-1}^{n}\\right)\n$$\nwhere $U_{j}^{n}$ is the numerical approximation to the solution $u(x,t)$ at the grid point $x_j = j\\,\\Delta x$ and time level $t^n = n\\,\\Delta t$. Let us define the constant coefficient $r = \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}$. The scheme can be written as:\n$$\nU_{j}^{n+1} = U_{j}^{n} + r\\left(U_{j+1}^{n} - 2\\,U_{j}^{n} + U_{j-1}^{n}\\right)\n$$\n\nThe analysis will be performed in the context of the discrete $L^{2}$ norm. A scheme is defined as stable in the $L^{2}$ norm if the $L^{2}$ norm of the numerical solution remains bounded for all time. For a linear, constant-coefficient scheme on a periodic domain, Parseval's theorem allows us to relate the $L^{2}$ norm of the solution to its discrete Fourier transform. The stability condition then simplifies to analyzing the behavior of individual Fourier modes.\n\nWe consider a single Fourier mode ansatz for the solution:\n$$\nU_{j}^{n} = \\hat{U}^{n}(k) \\exp(i k x_{j}) = \\hat{U}^{n}(k) \\exp(i k j \\Delta x)\n$$\nwhere $i = \\sqrt{-1}$, $k$ is the spatial wavenumber, and $\\hat{U}^{n}(k)$ is the complex amplitude of the mode at time level $n$. The evolution of this amplitude from one time step to the next is characterized by the amplification factor, $G(k)$, defined as:\n$$\nG(k) = \\frac{\\hat{U}^{n+1}(k)}{\\hat{U}^{n}(k)}\n$$\nFor the solution's $L^2$ norm to remain bounded, the magnitude of the amplification factor for all possible wavenumbers $k$ must not exceed unity. This is the von Neumann stability condition:\n$$\n|G(k)| \\le 1 \\quad \\forall k\n$$\n\nTo find $G(k)$, we substitute the Fourier mode ansatz into the FTCS scheme.\nThe terms in the scheme become:\n$U_{j}^{n+1} = \\hat{U}^{n+1}(k) \\exp(i k j \\Delta x)$\n$U_{j}^{n} = \\hat{U}^{n}(k) \\exp(i k j \\Delta x)$\n$U_{j+1}^{n} = \\hat{U}^{n}(k) \\exp(i k (j+1) \\Delta x) = \\hat{U}^{n}(k) \\exp(i k j \\Delta x) \\exp(i k \\Delta x)$\n$U_{j-1}^{n} = \\hat{U}^{n}(k) \\exp(i k (j-1) \\Delta x) = \\hat{U}^{n}(k) \\exp(i k j \\Delta x) \\exp(-i k \\Delta x)$\n\nSubstituting these into the scheme equation yields:\n$$\n\\hat{U}^{n+1}(k) \\exp(i k j \\Delta x) = \\hat{U}^{n}(k) \\exp(i k j \\Delta x) + r \\left( \\hat{U}^{n}(k) \\exp(i k j \\Delta x) \\exp(i k \\Delta x) - 2\\hat{U}^{n}(k) \\exp(i k j \\Delta x) + \\hat{U}^{n}(k) \\exp(i k j \\Delta x) \\exp(-i k \\Delta x) \\right)\n$$\nDividing through by the common, non-zero factor $\\hat{U}^{n}(k) \\exp(i k j \\Delta x)$ gives the expression for the amplification factor, $G(k) = \\frac{\\hat{U}^{n+1}(k)}{\\hat{U}^{n}(k)}$:\n$$\nG(k) = 1 + r \\left( \\exp(i k \\Delta x) - 2 + \\exp(-i k \\Delta x) \\right)\n$$\nUsing the Euler identity $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$ with $\\theta = k \\Delta x$, we simplify the expression in the parenthesis:\n$$\n\\exp(i k \\Delta x) - 2 + \\exp(-i k \\Delta x) = 2\\cos(k \\Delta x) - 2 = -2(1 - \\cos(k \\Delta x))\n$$\nUsing the trigonometric half-angle identity $1 - \\cos(\\theta) = 2\\sin^{2}(\\theta/2)$, we obtain:\n$$\n-2(1 - \\cos(k \\Delta x)) = -4\\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nSubstituting this back into the expression for $G(k)$:\n$$\nG(k) = 1 - 4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nNow, we apply the stability condition $|G(k)| \\le 1$. Since $G(k)$ is a real-valued function, this is equivalent to:\n$$\n-1 \\le 1 - 4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\nThis inequality can be separated into two parts.\n\nFirst, the right-hand side inequality:\n$$\n1 - 4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\n$$\n-4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le 0\n$$\nSince $r = \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}$ is positive (given $\\nu > 0$, $\\Delta t > 0$) and $\\sin^{2}(\\cdot)$ is always non-negative, this inequality is always satisfied.\n\nSecond, the left-hand side inequality:\n$$\n-1 \\le 1 - 4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nRearranging the terms gives:\n$$\n4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le 2\n$$\n$$\nr \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le \\frac{1}{2}\n$$\nThis condition must hold for all wavenumbers $k$ that can be represented on the spatial grid. To ensure stability, we must satisfy the condition for the \"worst-case\" scenario, which corresponds to the value of $k$ that maximizes the term $\\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)$. The maximum value of $\\sin^{2}(\\cdot)$ is $1$. This maximum occurs for the highest frequency mode the grid can resolve, where $k \\Delta x = \\pi$ (corresponding to a wavelength of $2 \\Delta x$). For this mode, $\\sin^{2}\\left(\\frac{\\pi}{2}\\right)=1$.\n\nTherefore, the stability condition for all possible wavenumbers becomes:\n$$\nr \\cdot 1 \\le \\frac{1}{2}\n$$\nSubstituting back the definition of $r = \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}$:\n$$\n\\frac{\\nu\\,\\Delta t}{\\Delta x^{2}} \\le \\frac{1}{2}\n$$\nThis is the necessary and sufficient condition for the stability of the FTCS scheme for the heat equation. To find the largest stable time step, $\\Delta t_{\\max}$, we solve for $\\Delta t$:\n$$\n\\Delta t \\le \\frac{\\Delta x^{2}}{2 \\nu}\n$$\nThe maximum value for $\\Delta t$ that satisfies this inequality is:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x^{2}}{2 \\nu}\n$$\nAny time step larger than this will cause high-frequency numerical errors to be amplified, leading to an unstable and divergent solution.",
            "answer": "$$\\boxed{\\frac{\\Delta x^{2}}{2 \\nu}}$$"
        },
        {
            "introduction": "Having seen the conditional stability of the FTCS scheme for a parabolic equation, a natural question arises: how does the same scheme behave for a hyperbolic equation, like the linear advection equation? This exercise reveals a critical lesson in numerical analysis: a scheme's properties are deeply tied to the character of the PDE it approximates. You will demonstrate, through two distinct but related approaches, that the FTCS scheme is unconditionally unstable for advection. First, a von Neumann analysis will show that high-frequency modes are always amplified, regardless of the time step . Second, by constructing a simple counterexample, you will see how this instability manifests as a violation of the discrete maximum principle, leading to non-physical oscillations—a common symptom of a poorly chosen scheme for a hyperbolic problem.",
            "id": "3463195",
            "problem": "Consider the linear advection (transport) partial differential equation $u_{t} + a\\,u_{x} = 0$ on a one-dimensional periodic grid with spacing $\\Delta x$, where $a > 0$ is a constant wave speed. Let $u_{j}^{n}$ denote the grid function approximation to $u(x_{j}, t_{n})$ at spatial nodes $x_{j} = j\\,\\Delta x$ and discrete times $t_{n} = n\\,\\Delta t$. Analyze the explicit Forward Time, Central Space (FTCS) finite difference scheme\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\nand define the Courant number $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$.\n\nStarting from the definitions of the advection equation and the given discretization, and without introducing any additional stabilization or filtering, construct a counterexample to the discrete maximum principle by specifying an admissible discrete initial condition $u_{j}^{0}$ with $u_{j}^{0} \\ge 0$ for all $j$ that produces a negative value after one time step. Derive, from first principles, the exact minimum value of $u_{j}^{1}$ across all grid indices $j$ in terms of the Courant number $\\nu$. Then, perform a von Neumann (Fourier) stability analysis of the same scheme to characterize its linear amplification factor $G(\\theta)$ for a single Fourier mode of nondimensional wavenumber $\\theta = k\\,\\Delta x$, and determine the exact supremum of the magnitude $|G(\\theta)|$ over all $\\theta \\in \\mathbb{R}$, expressed in closed form as a function of $\\nu$.\n\nExpress your final answer as a two-entry row vector containing, in order: the minimum value of $u_{j}^{1}$ produced by your counterexample, and the supremum of $|G(\\theta)|$ over all $\\theta$. Your final expression must depend only on $\\nu$ and contain no other parameters. No rounding is required.",
            "solution": "The problem asks for two distinct analyses of the Forward Time, Central Space (FTCS) scheme for the linear advection equation. First, an analysis of the discrete maximum principle, and second, a von Neumann stability analysis.\n\nThe FTCS scheme can be expressed in terms of the Courant number $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$ as:\n$$u_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)$$\n\n**Part 1: Counterexample to the Maximum Principle and Minimum Value of $u_{j}^{1}$**\n\nThe discrete maximum principle for this equation would imply that if the initial condition $u_{j}^{0}$ is non-negative, i.e., $u_{j}^{0} \\ge 0$ for all $j$, then the solution $u_{j}^{n}$ should remain non-negative for all subsequent times $n > 0$. We seek a counterexample.\n\nLet's construct an initial condition $u^0_j \\geq 0$ and compute the solution at the first time step, $n=1$. The update rule is:\n$$u_{j}^{1} = u_{j}^{0} - \\frac{\\nu}{2}u_{j+1}^{0} + \\frac{\\nu}{2}u_{j-1}^{0}$$\nTo produce a negative value for $u_{j}^{1}$, the term $-\\frac{\\nu}{2}u_{j+1}^{0}$ must be sufficiently large and negative to overcome the other non-negative terms. Since $\\nu > 0$, we need to maximize $u_{j+1}^{0}$ while minimizing $u_{j}^{0}$ and $u_{j-1}^{0}$.\n\nLet us consider a discrete analogue of a Dirac delta function as the initial condition. This is an admissible, non-negative initial condition. The linearity of the scheme allows us to deduce the behavior for more complex initial data by superposition. Let's fix the maximum of the initial data to be $1$ for normalization, as the scheme's linearity means the output will scale with the input's amplitude. The problem's request for an answer solely in terms of $\\nu$ implies such a normalization.\n\nChoose the initial condition $u_{j}^{0}$ as:\n$$u_{j}^{0} = \\delta_{j,0} = \\begin{cases} 1 & j=0 \\\\ 0 & j \\ne 0 \\end{cases}$$\nThis satisfies $u_{j}^{0} \\ge 0$ for all $j$, and its maximum value is $1$.\n\nNow, we compute $u_{j}^{1}$ for all $j$:\n-   For $j = -1$: $u_{-1}^{1} = u_{-1}^{0} - \\frac{\\nu}{2}(u_{0}^{0} - u_{-2}^{0}) = 0 - \\frac{\\nu}{2}(1 - 0) = -\\frac{\\nu}{2}$.\n-   For $j = 0$: $u_{0}^{1} = u_{0}^{0} - \\frac{\\nu}{2}(u_{1}^{0} - u_{-1}^{0}) = 1 - \\frac{\\nu}{2}(0 - 0) = 1$.\n-   For $j = 1$: $u_{1}^{1} = u_{1}^{0} - \\frac{\\nu}{2}(u_{2}^{0} - u_{0}^{0}) = 0 - \\frac{\\nu}{2}(0 - 1) = \\frac{\\nu}{2}$.\n-   For $|j| \\ge 2$: All terms $u_{j}^{0}$, $u_{j+1}^{0}$, and $u_{j-1}^{0}$ are zero, so $u_{j}^{1} = 0$.\n\nThe solution at time $n=1$ is the set of values $\\{..., 0, -\\frac{\\nu}{2}, 1, \\frac{\\nu}{2}, 0, ...\\}$. Since $\\nu = \\frac{a \\Delta t}{\\Delta x}$ and $a, \\Delta t, \\Delta x$ are all positive, we have $\\nu > 0$. Therefore, $u_{-1}^{1} = -\\frac{\\nu}{2}$ is negative. This provides a concrete counterexample to the discrete maximum principle.\n\nTo find the exact minimum value of $u_{j}^{1}$ for any admissible non-negative initial condition with a maximum value of $1$, we analyze the expression $u_{j}^{1} = u_{j}^{0} - \\frac{\\nu}{2}u_{j+1}^{0} + \\frac{\\nu}{2}u_{j-1}^{0}$. Given $0 \\le u_{k}^{0} \\le 1$ for all $k$, we can establish a lower bound for $u_j^1$:\n$$ u_{j}^{1} \\ge \\min(u_j^0) - \\frac{\\nu}{2}\\max(u_{j+1}^0) + \\frac{\\nu}{2}\\min(u_{j-1}^0) = 0 - \\frac{\\nu}{2}(1) + \\frac{\\nu}{2}(0) = -\\frac{\\nu}{2} $$\nThe minimum value of $-\\frac{\\nu}{2}$ is achieved by our delta-function counterexample at $j=-1$ (with initial peak at $j=0$). More generally, an initial condition like $u_k^0=0$ for $k \\le j$ and $u_{j+1}^0=1$ would yield $u_j^1 = -\\frac{\\nu}{2}$. Thus, the exact minimum value of $u_j^1$ is $-\\frac{\\nu}{2}$.\n\n**Part 2: Von Neumann Stability Analysis**\n\nWe analyze the stability of the scheme by substituting a single Fourier mode, $u_{j}^{n} = [G(\\theta)]^n e^{i k x_j}$, into the discretized equation. Here, $G(\\theta)$ is the amplification factor and $\\theta = k \\Delta x$ is the non-dimensional wavenumber.\nThe spatial terms become:\n$u_{j+1}^{n} = [G(\\theta)]^n e^{i k (x_j + \\Delta x)} = [G(\\theta)]^n e^{i k x_j} e^{i k \\Delta x} = u_j^n e^{i\\theta}$\n$u_{j-1}^{n} = [G(\\theta)]^n e^{i k (x_j - \\Delta x)} = [G(\\theta)]^n e^{i k x_j} e^{-i k \\Delta x} = u_j^n e^{-i\\theta}$\n\nSubstituting these into the FTCS scheme:\n$$u_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}\\left(u_{j}^{n}e^{i\\theta} - u_{j}^{n}e^{-i\\theta}\\right)$$\nThe term $u_j^{n+1}$ is $G(\\theta) u_j^n$. Dividing by $u_{j}^{n}$ (which is non-zero for a non-trivial mode), we get the amplification factor $G(\\theta)$:\n$$G(\\theta) = 1 - \\frac{\\nu}{2}\\left(e^{i\\theta} - e^{-i\\theta}\\right)$$\nUsing Euler's identity, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, we have:\n$$G(\\theta) = 1 - i\\nu\\sin(\\theta)$$\nFor a scheme to be stable in the von Neumann sense, the magnitude of the amplification factor must satisfy $|G(\\theta)| \\le 1$ for all possible $\\theta$. Let's compute the magnitude of $G(\\theta)$:\n$$|G(\\theta)| = |1 - i\\nu\\sin(\\theta)|$$\nThis is the modulus of a complex number with real part $1$ and imaginary part $-\\nu\\sin(\\theta)$.\n$$|G(\\theta)| = \\sqrt{(\\text{Re}[G(\\theta)])^2 + (\\text{Im}[G(\\theta)])^2} = \\sqrt{1^2 + (-\\nu\\sin(\\theta))^2} = \\sqrt{1 + \\nu^2\\sin^2(\\theta)}$$\nThe problem asks for the supremum of $|G(\\theta)|$ over all $\\theta \\in \\mathbb{R}$. To find this, we need to maximize the expression $\\sqrt{1 + \\nu^2\\sin^2(\\theta)}$. Since the square root function is monotonic, this is equivalent to maximizing its argument, $1 + \\nu^2\\sin^2(\\theta)$.\n\nThe Courant number $\\nu$ is a positive constant. The term $\\sin^2(\\theta)$ varies between $0$ and $1$. The maximum value of $\\sin^2(\\theta)$ is $1$, which occurs for $\\theta = \\frac{\\pi}{2} + m\\pi$ for any integer $m$.\nTherefore, the supremum of $|G(\\theta)|$ is:\n$$\\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)| = \\sqrt{1 + \\nu^2(1)} = \\sqrt{1 + \\nu^2}$$\nSince $\\nu > 0$, we have $\\sqrt{1+\\nu^2} > 1$. This shows that for any choice of $\\Delta x$ and $\\Delta t$, there are Fourier modes that will be amplified, meaning the FTCS scheme is unconditionally unstable for the linear advection equation.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\nu}{2} & \\sqrt{1 + \\nu^2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The failure of central differencing for advection problems motivates the search for a more robust discretization, one that respects the physics of information transport. This leads to the concept of upwinding, where spatial differences are taken in the direction from which information is flowing. This practice challenges you to analyze a first-order upwind scheme for the two-dimensional advection equation . Instead of Fourier analysis, you will use a different and equally powerful technique: analyzing the scheme's coefficients to determine the conditions under which it forms a convex combination. This property guarantees that the scheme is monotone, satisfies a discrete maximum principle, and is stable in the uniform norm, providing a sharp Courant–Friedrichs–Lewy (CFL) condition that ensures a stable and physically plausible numerical solution.",
            "id": "3463187",
            "problem": "Consider the constant-coefficient two-dimensional linear advection equation $u_{t} + a\\,u_{x} + b\\,u_{y} = 0$ posed on a rectangular, uniform Cartesian grid with spacings $\\Delta x > 0$ and $\\Delta y > 0$, and advanced in time by a single-step explicit method with time step $\\Delta t > 0$. Assume periodic boundary conditions in both spatial directions so that the grid is topologically a torus. Let $U^{n}_{i,j}$ denote the grid function at time level $t^{n} = n\\,\\Delta t$ at node $(i,j)$.\n\nYou are told that the update $U^{n+1}_{i,j}$ is formed as a convex combination of only the current value and the immediately upwind neighbors in the $x$- and $y$-directions, selected according to the signs of $a$ and $b$: the stencil consists of the central point $(i,j)$ together with $(i-\\operatorname{sgn}(a),j)$ and $(i,j-\\operatorname{sgn}(b))$. The scheme is consistent with $u_{t} + a\\,u_{x} + b\\,u_{y} = 0$ in the sense of first-order accuracy in both space and time, obtained by forward Euler in time and first-order upwind differences in space.\n\nStarting from the core definitions of monotone schemes, the discrete maximum principle, and the notion of stability in the uniform norm, derive the sharp Courant–Friedrichs–Lewy (CFL) constraint that characterizes precisely when the explicit update is a convex combination with nonnegative coefficients and is $\\ell^{\\infty}$-stable. Express your answer as the single closed-form analytic expression for the largest admissible $\\Delta t$ in terms of $a$, $b$, $\\Delta x$, and $\\Delta y$.\n\nYour final answer must be a single analytic expression. No rounding is required.",
            "solution": "The problem requires the derivation of the Courant–Friedrichs–Lewy (CFL) condition for the first-order explicit upwind scheme for the two-dimensional linear advection equation. The condition sought is that which makes the scheme a convex combination, which in turn guarantees stability in the uniform norm ($\\ell^{\\infty}$-stability) and satisfaction of a discrete maximum principle.\n\nThe governing partial differential equation (PDE) is the two-dimensional constant-coefficient linear advection equation:\n$$\nu_{t} + a\\,u_{x} + b\\,u_{y} = 0\n$$\nwhere $u(x,y,t)$ is the transported quantity, and $a$ and $b$ are the constant velocity components in the $x$ and $y$ directions, respectively.\n\nWe discretize this equation on a uniform Cartesian grid with spatial spacings $\\Delta x$ and $\\Delta y$, and time step $\\Delta t$. The grid function $U^{n}_{i,j}$ approximates the exact solution $u(i\\Delta x, j\\Delta y, n\\Delta t)$.\n\nThe numerical scheme is constructed using the forward Euler method for the time derivative and first-order upwind differencing for the spatial derivatives.\nThe time derivative is approximated as:\n$$\nu_{t} \\approx \\frac{U^{n+1}_{i,j} - U^{n}_{i,j}}{\\Delta t}\n$$\nThe spatial derivatives $u_x$ and $u_y$ are approximated using upwind differences, meaning the differences are taken in the direction from which the flow originates. The choice of the neighboring point depends on the sign of the corresponding velocity component.\n\nFor the $x$-derivative term $a\\,u_{x}$:\n- If $a > 0$, the flow is from left to right, so we use a backward difference: $a\\,u_{x} \\approx a\\frac{U^{n}_{i,j} - U^{n}_{i-1,j}}{\\Delta x}$.\n- If $a < 0$, the flow is from right to left, so we use a forward difference: $a\\,u_{x} \\approx a\\frac{U^{n}_{i+1,j} - U^{n}_{i,j}}{\\Delta x}$.\nIf $a=0$, this term is zero and no spatial difference is needed.\n\nThese cases can be written compactly using the signum function, $\\operatorname{sgn}(a)$, and the absolute value $|a|$. Note that $a = |a|\\operatorname{sgn}(a)$ for $a \\neq 0$.\nThe upwind discretization for $a\\,u_x$ can be expressed as:\n$$\na\\,u_{x} \\approx \\frac{|a|}{\\Delta x} \\left( U^{n}_{i,j} - U^{n}_{i-\\operatorname{sgn}(a),j} \\right)\n$$\nThis expression can be verified for $a>0$ ($\\operatorname{sgn}(a)=1$) and $a<0$ ($\\operatorname{sgn}(a)=-1$). For $a<0$, it becomes $\\frac{-a}{\\Delta x} (U^n_{i,j} - U^n_{i+1,j}) = a \\frac{U^n_{i+1,j}-U^n_{i,j}}{\\Delta x}$, which is correct. If we define $\\operatorname{sgn}(0)=0$, this formulation is also valid for $a=0$, yielding $0$.\n\nSimilarly, for the $y$-derivative term $b\\,u_{y}$:\n$$\nb\\,u_{y} \\approx \\frac{|b|}{\\Delta y} \\left( U^{n}_{i,j} - U^{n}_{i,j-\\operatorname{sgn}(b)} \\right)\n$$\n\nSubstituting these approximations into the PDE gives the finite difference equation:\n$$\n\\frac{U^{n+1}_{i,j} - U^{n}_{i,j}}{\\Delta t} + \\frac{|a|}{\\Delta x} \\left( U^{n}_{i,j} - U^{n}_{i-\\operatorname{sgn}(a),j} \\right) + \\frac{|b|}{\\Delta y} \\left( U^{n}_{i,j} - U^{n}_{i,j-\\operatorname{sgn}(b)} \\right) = 0\n$$\nWe can solve for the updated value $U^{n+1}_{i,j}$:\n$$\nU^{n+1}_{i,j} = U^{n}_{i,j} - \\frac{|a|\\Delta t}{\\Delta x} \\left( U^{n}_{i,j} - U^{n}_{i-\\operatorname{sgn}(a),j} \\right) - \\frac{|b|\\Delta t}{\\Delta y} \\left( U^{n}_{i,j} - U^{n}_{i,j-\\operatorname{sgn}(b)} \\right)\n$$\nGrouping terms by the grid function values at time level $n$:\n$$\nU^{n+1}_{i,j} = \\left( 1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y} \\right) U^{n}_{i,j} + \\left( \\frac{|a|\\Delta t}{\\Delta x} \\right) U^{n}_{i-\\operatorname{sgn}(a),j} + \\left( \\frac{|b|\\Delta t}{\\Delta y} \\right) U^{n}_{i,j-\\operatorname{sgn}(b)}\n$$\nThis equation shows that $U^{n+1}_{i,j}$ is a linear combination of the values at the stencil points $(i,j)$, $(i-\\operatorname{sgn}(a),j)$, and $(i,j-\\operatorname{sgn}(b))$ at time level $n$, which is consistent with the problem description.\n\nThe problem states that the update must be a convex combination. A linear combination $Y = \\sum_{k} c_k X_k$ is a convex combination if all coefficients $c_k$ are non-negative ($c_k \\ge 0$) and their sum is equal to one ($\\sum_k c_k = 1$). A scheme with this property is called a monotone scheme. Such schemes satisfy a discrete maximum principle, i.e., $\\min_{i,j}(U^n_{i,j}) \\le U^{n+1}_{k,l} \\le \\max_{i,j}(U^n_{i,j})$ for all $k,l$. This directly implies stability in the uniform norm, $\\|U^{n+1}\\|_{\\infty} \\le \\|U^n\\|_{\\infty}$.\n\nLet's examine the coefficients in our scheme:\n$$\n\\begin{align*}\nC_{i,j} &= 1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y} \\\\\nC_{i-\\operatorname{sgn}(a),j} &= \\frac{|a|\\Delta t}{\\Delta x} \\\\\nC_{i,j-\\operatorname{sgn}(b)} &= \\frac{|b|\\Delta t}{\\Delta y}\n\\end{align*}\n$$\nFirst, we check if the sum of coefficients is $1$:\n$$\n\\sum C = \\left( 1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y} \\right) + \\frac{|a|\\Delta t}{\\Delta x} + \\frac{|b|\\Delta t}{\\Delta y} = 1\n$$\nThe sum is always $1$, which is a consequence of the scheme's consistency with the PDE.\n\nNext, we enforce the non-negativity of all coefficients.\nSince $\\Delta t > 0$, $\\Delta x > 0$, $\\Delta y > 0$, $|a| \\ge 0$, and $|b| \\ge 0$:\n-   The coefficient $C_{i-\\operatorname{sgn}(a),j} = \\frac{|a|\\Delta t}{\\Delta x}$ is always non-negative.\n-   The coefficient $C_{i,j-\\operatorname{sgn}(b)} = \\frac{|b|\\Delta t}{\\Delta y}$ is always non-negative.\nThe only remaining condition is for the coefficient of the central point, $U^{n}_{i,j}$:\n$$\nC_{i,j} = 1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y} \\ge 0\n$$\nThis inequality provides the stability constraint. This is the condition that makes the scheme monotone and thus $\\ell^\\infty$-stable. We now solve for $\\Delta t$:\n$$\n1 \\ge \\frac{|a|\\Delta t}{\\Delta x} + \\frac{|b|\\Delta t}{\\Delta y}\n$$\n$$\n1 \\ge \\Delta t \\left( \\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y} \\right)\n$$\nAssuming not both $a$ and $b$ are zero (in which case the equation is trivial), the term in the parenthesis is positive. We can therefore divide by it to isolate $\\Delta t$:\n$$\n\\Delta t \\le \\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y}}\n$$\nThis is the Courant–Friedrichs–Lewy (CFL) condition for this scheme. The problem asks for the sharpest constraint, corresponding to the largest admissible value of $\\Delta t$. This is found by taking the equality:\n$$\n\\Delta t_{\\text{max}} = \\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y}}\n$$\nAny $\\Delta t$ larger than this value will cause the coefficient $C_{i,j}$ to become negative, violating the convex combination property and potentially leading to non-physical oscillations and instability. Thus, this constitutes the sharp CFL constraint for $\\ell^\\infty$-stability of the first-order upwind scheme.",
            "answer": "$$\\boxed{\\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y}}}$$"
        }
    ]
}