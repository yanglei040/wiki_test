{
    "hands_on_practices": [
        {
            "introduction": "我们从一个经典问题开始：使用前向时间中心空间（FTCS）格式求解一维热方程。这个练习将引导你亲手进行冯·诺依曼稳定性分析，这是评估线性、常系数偏微分方程数值格式稳定性的基石。通过推导放大因子并施加稳定性约束，你将发现数值稳定性并非理所当然，而是依赖于离散参数（如时间步长 $\\Delta t$ 和空间步长 $\\Delta x$）之间的一个关键关系，即著名的CFL条件 。",
            "id": "3463196",
            "problem": "考虑一维热方程 $u_{t} = \\nu\\,u_{xx}$，其定义在周期性空间域上，其中 $\\nu > 0$ 是一个常数扩散系数。使用间距为 $\\Delta x$ 的均匀空间网格和时间步长为 $\\Delta t$ 的均匀时间网格。定义前向时间中心空间 (FTCS) 显式有限差分格式如下：在网格点 $x_{j} = j\\,\\Delta x$ 和时间层 $t^{n} = n\\,\\Delta t$ 上，近似解 $U_{j}^{n}$ 满足\n$$\nU_{j}^{n+1} = U_{j}^{n} + \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(U_{j+1}^{n} - 2\\,U_{j}^{n} + U_{j-1}^{n}\\right).\n$$\n使用傅里叶稳定性分析（von Neumann 分析），从离散 $L^{2}$ 范数下线性常系数格式稳定性的基本定义出发，引入单个傅里叶模式的放大因子，并推导保证 FTCS 格式对于所有与网格兼容的空间傅里叶波数都稳定的 $\\Delta t$ 和 $\\Delta x$ 所需的充分必要条件。然后，根据此条件，确定以 $\\nu$ 和 $\\Delta x$ 显式表示的最大稳定时间步长 $\\Delta t_{\\max}$。将您的最终答案表示为 $\\Delta t_{\\max}$ 的单个闭式解析表达式。最终表达式无需四舍五入，也不应包含单位。",
            "solution": "本题要求使用傅里叶稳定性分析（也称为 von Neumann 分析）来推导一维热方程 $u_{t} = \\nu\\,u_{xx}$ 的前向时间中心空间 (FTCS) 格式的稳定性条件。最终目标是确定最大稳定时间步长 $\\Delta t_{\\max}$。\n\nFTCS 格式由下式给出：\n$$\nU_{j}^{n+1} = U_{j}^{n} + \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}\\left(U_{j+1}^{n} - 2\\,U_{j}^{n} + U_{j-1}^{n}\\right)\n$$\n其中 $U_{j}^{n}$ 是解 $u(x,t)$ 在网格点 $x_j = j\\,\\Delta x$ 和时间层 $t^n = n\\,\\Delta t$ 上的数值近似。我们定义常系数 $r = \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}$。该格式可以写为：\n$$\nU_{j}^{n+1} = U_{j}^{n} + r\\left(U_{j+1}^{n} - 2\\,U_{j}^{n} + U_{j-1}^{n}\\right)\n$$\n\n分析将在离散 $L^{2}$ 范数的背景下进行。如果数值解的 $L^{2}$ 范数在所有时间内都保持有界，则该格式在 $L^{2}$ 范数下是稳定的。对于周期域上的线性常系数格式，Parseval 定理允许我们将解的 $L^{2}$ 范数与其离散傅里叶变换联系起来。稳定性条件于是简化为分析单个傅里叶模式的行为。\n\n我们考虑解的单个傅里叶模式拟设：\n$$\nU_{j}^{n} = \\hat{U}^{n}(k) \\exp(i k x_{j}) = \\hat{U}^{n}(k) \\exp(i k j \\Delta x)\n$$\n其中 $i = \\sqrt{-1}$，$k$ 是空间波数，$\\hat{U}^{n}(k)$ 是模式在时间层 $n$ 的复振幅。这个振幅从一个时间步到下一个时间步的演化由放大因子 $G(k)$ 来表征，定义为：\n$$\nG(k) = \\frac{\\hat{U}^{n+1}(k)}{\\hat{U}^{n}(k)}\n$$\n为了使解的 $L^2$ 范数保持有界，所有可能波数 $k$ 的放大因子的模不得超过 1。这就是 von Neumann 稳定性条件：\n$$\n|G(k)| \\le 1 \\quad \\forall k\n$$\n\n为了求出 $G(k)$，我们将傅里叶模式拟设代入 FTCS 格式。\n格式中的各项变为：\n$U_{j}^{n+1} = \\hat{U}^{n+1}(k) \\exp(i k j \\Delta x)$\n$U_{j}^{n} = \\hat{U}^{n}(k) \\exp(i k j \\Delta x)$\n$U_{j+1}^{n} = \\hat{U}^{n}(k) \\exp(i k (j+1) \\Delta x) = \\hat{U}^{n}(k) \\exp(i k j \\Delta x) \\exp(i k \\Delta x)$\n$U_{j-1}^{n} = \\hat{U}^{n}(k) \\exp(i k (j-1) \\Delta x) = \\hat{U}^{n}(k) \\exp(i k j \\Delta x) \\exp(-i k \\Delta x)$\n\n将这些代入格式方程得到：\n$$\n\\hat{U}^{n+1}(k) \\exp(i k j \\Delta x) = \\hat{U}^{n}(k) \\exp(i k j \\Delta x) + r \\left( \\hat{U}^{n}(k) \\exp(i k j \\Delta x) \\exp(i k \\Delta x) - 2\\hat{U}^{n}(k) \\exp(i k j \\Delta x) + \\hat{U}^{n}(k) \\exp(i k j \\Delta x) \\exp(-i k \\Delta x) \\right)\n$$\n两边同除以公共的非零因子 $\\hat{U}^{n}(k) \\exp(i k j \\Delta x)$，得到放大因子 $G(k) = \\frac{\\hat{U}^{n+1}(k)}{\\hat{U}^{n}(k)}$ 的表达式：\n$$\nG(k) = 1 + r \\left( \\exp(i k \\Delta x) - 2 + \\exp(-i k \\Delta x) \\right)\n$$\n使用欧拉恒等式 $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$，其中 $\\theta = k \\Delta x$，我们简化括号中的表达式：\n$$\n\\exp(i k \\Delta x) - 2 + \\exp(-i k \\Delta x) = 2\\cos(k \\Delta x) - 2 = -2(1 - \\cos(k \\Delta x))\n$$\n使用三角半角恒等式 $1 - \\cos(\\theta) = 2\\sin^{2}(\\theta/2)$，我们得到：\n$$\n-2(1 - \\cos(k \\Delta x)) = -4\\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n将此代回 $G(k)$ 的表达式中：\n$$\nG(k) = 1 - 4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n现在，我们应用稳定性条件 $|G(k)| \\le 1$。由于 $G(k)$ 是一个实值函数，这等价于：\n$$\n-1 \\le 1 - 4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\n这个不等式可以分为两部分。\n\n首先，右侧的不等式：\n$$\n1 - 4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\n$$\n-4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le 0\n$$\n由于 $r = \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}$ 是正的（给定 $\\nu > 0$, $\\Delta t > 0$）并且 $\\sin^{2}(\\cdot)$ 总是非负的，所以这个不等式总是成立。\n\n其次，左侧的不等式：\n$$\n-1 \\le 1 - 4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n整理各项可得：\n$$\n4r \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le 2\n$$\n$$\nr \\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right) \\le \\frac{1}{2}\n$$\n这个条件必须对空间网格上可以表示的所有波数 $k$ 都成立。为确保稳定性，我们必须满足“最坏情况”下的条件，这对应于使 $\\sin^{2}\\left(\\frac{k \\Delta x}{2}\\right)$ 项最大化的 $k$ 值。$\\sin^{2}(\\cdot)$ 的最大值是 1。这个最大值出现在网格能解析的最高频率模式，此时 $k \\Delta x = \\pi$（对应于 $2 \\Delta x$ 的波长）。对于这个模式，$\\sin^{2}\\left(\\frac{\\pi}{2}\\right)=1$。\n\n因此，对所有可能波数的稳定性条件变为：\n$$\nr \\cdot 1 \\le \\frac{1}{2}\n$$\n代回 $r = \\frac{\\nu\\,\\Delta t}{\\Delta x^{2}}$ 的定义：\n$$\n\\frac{\\nu\\,\\Delta t}{\\Delta x^{2}} \\le \\frac{1}{2}\n$$\n这就是热方程的 FTCS 格式稳定的充分必要条件。为了找到最大稳定时间步长 $\\Delta t_{\\max}$，我们求解 $\\Delta t$：\n$$\n\\Delta t \\le \\frac{\\Delta x^{2}}{2 \\nu}\n$$\n满足此不等式的 $\\Delta t$ 的最大值是：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x^{2}}{2 \\nu}\n$$\n任何大于此值的时间步长都会导致高频数值误差被放大，从而导致解不稳定和发散。",
            "answer": "$$\\boxed{\\frac{\\Delta x^{2}}{2 \\nu}}$$"
        },
        {
            "introduction": "在评估了FTCS格式在抛物型方程上的条件稳定性后，我们现在转向一个双曲型问题：线性平流方程。这个练习极具启发性，因为它揭示了同一个数值格式在不同类型方程下的迥异表现 。你将通过两种方式证明FTCS格式对于纯平流问题是无条件不稳定的：一是构造一个违反离散极值原理的具体反例，二是进行冯·诺依曼分析，揭示其放大因子的模长总是大于1。这个结果强调了为特定物理问题选择正确数值格式的极端重要性。",
            "id": "3463195",
            "problem": "考虑一维周期性网格上的线性平流（输运）偏微分方程 $u_{t} + a\\,u_{x} = 0$，其网格间距为 $\\Delta x$，其中 $a > 0$ 是一个恒定的波速。令 $u_{j}^{n}$ 表示在空间节点 $x_{j} = j\\,\\Delta x$ 和离散时间 $t_{n} = n\\,\\Delta t$ 上对 $u(x_{j}, t_{n})$ 的网格函数近似。分析显式的前向时间、中心空间（FTCS）有限差分格式\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\n并定义库朗数（Courant number）$\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$。\n\n从平流方程的定义和给定的离散化出发，在不引入任何额外稳定化或滤波的情况下，通过指定一个可行的离散初始条件 $u_{j}^{0}$（对所有 $j$ 满足 $u_{j}^{0} \\ge 0$），构造一个离散极值原理的反例，该反例在一个时间步后产生负值。根据第一性原理，推导所有网格指标 $j$ 上的 $u_{j}^{1}$ 的精确最小值，并用库朗数 $\\nu$ 表示。然后，对同一格式进行冯·诺依曼（Fourier）稳定性分析，以表征其对于无量纲波数 $\\theta = k\\,\\Delta x$ 的单个傅里叶模的线性放大因子 $G(\\theta)$，并确定其模 $|G(\\theta)|$ 在所有 $\\theta \\in \\mathbb{R}$ 上的精确上确界，结果表示为 $\\nu$ 的闭式函数。\n\n将您的最终答案表示为一个双元素行向量，按顺序包含：您的反例产生的 $u_{j}^{1}$ 的最小值，以及 $|G(\\theta)|$ 在所有 $\\theta$ 上的上确界。您的最终表达式必须只依赖于 $\\nu$，不包含其他参数。无需四舍五入。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 问题验证\n\n**第1步：提取已知信息**\n-   **偏微分方程 (PDE)**：线性平流方程为 $u_{t} + a\\,u_{x} = 0$，其中波速 $a > 0$ 是一个常数。\n-   **离散化网格**：区域是一个空间步长为 $\\Delta x$ 的一维周期性网格。\n-   **网格函数记法**：$u_{j}^{n}$ 是精确解 $u(x_{j}, t_{n})$ 在网格点 $x_{j} = j\\,\\Delta x$ 和时间 $t_{n} = n\\,\\Delta t$ 上的数值近似。\n-   **有限差分格式**：前向时间、中心空间 (FTCS) 格式由下式给出\n    $$u_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)。$$\n-   **库朗数定义**：库朗数定义为 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$。\n-   **任务**：\n    1.  使用一个初始条件 $u_{j}^{0} \\ge 0$ 构造离散极值原理的一个反例，使得对于某个 $j$，有 $u_{j}^{1}  0$。\n    2.  推导在所有网格指标 $j$ 上 $u_{j}^{1}$ 的精确最小值，用 $\\nu$ 表示。\n    3.  进行冯·诺依曼稳定性分析，求出放大因子 $G(\\theta)$，其中 $\\theta = k\\,\\Delta x$。\n    4.  确定放大因子模的上确界 $\\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)|$，作为 $\\nu$ 的函数。\n\n**第2步：使用提取的已知信息进行验证**\n-   **科学基础**：该问题在偏微分方程数值分析领域有坚实的科学基础。平流方程、FTCS 格式、库朗数、极值原理和冯·诺依曼稳定性分析都是标准和基本的概念。\n-   **适定性**：该问题是适定的。它要求基于所提供的数学定义进行具体的推导和表征。任务明确，能导出唯一且有意义的解。\n-   **客观性**：该问题以精确、客观的数学语言陈述，不含任何主观或推测性内容。\n-   **缺陷核对表**：该问题未表现出任何使其无效的缺陷。它在科学上是合理的，可形式化，完整且结构良好。问题并非无足轻重，并且触及了数值格式的核心性质。\n\n**第3步：结论与行动**\n该问题是**有效的**。将提供完整解答。\n\n### 解答\n\n该问题要求对线性平流方程的前向时间、中心空间（FTCS）格式进行两项不同的分析。首先，分析离散极值原理；其次，进行冯·诺依曼稳定性分析。\n\nFTCS 格式可以用库朗数 $\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$ 表示为：\n$$u_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)$$\n\n**第一部分：极值原理的反例与 $u_{j}^{1}$ 的最小值**\n\n对于此方程，离散极值原理将意味着，如果初始条件 $u_{j}^{0}$ 是非负的，即对所有 $j$ 都有 $u_{j}^{0} \\ge 0$，那么解 $u_{j}^{n}$ 在所有后续时间 $n  0$ 都应保持非负。我们寻求一个反例。\n\n让我们构造一个初始条件 $u^0_j \\geq 0$，并计算第一个时间步 $n=1$ 时的解。更新规则是：\n$$u_{j}^{1} = u_{j}^{0} - \\frac{\\nu}{2}u_{j+1}^{0} + \\frac{\\nu}{2}u_{j-1}^{0}$$\n要使 $u_{j}^{1}$ 产生一个负值，项 $-\\frac{\\nu}{2}u_{j+1}^{0}$ 必须足够大且为负，以克服其他非负项。由于 $\\nu  0$，我们需要最大化 $u_{j+1}^{0}$，同时最小化 $u_{j}^{0}$ 和 $u_{j-1}^{0}$。\n\n让我们考虑一个离散的狄拉克 delta 函数作为初始条件。这是一个可行的、非负的初始条件。格式的线性性质允许我们通过叠加来推断更复杂初始数据的行为。为了归一化，我们将初始数据的最大值固定为 $1$，因为格式的线性意味着输出将随输入振幅的比例而缩放。问题要求答案仅用 $\\nu$ 表示，也暗示了这种归一化。\n\n选择初始条件 $u_{j}^{0}$ 为：\n$$u_{j}^{0} = \\delta_{j,0} = \\begin{cases} 1  j=0 \\\\ 0  j \\ne 0 \\end{cases}$$\n这满足对所有 $j$ 都有 $u_{j}^{0} \\ge 0$，且其最大值为 $1$。\n\n现在，我们为所有 $j$ 计算 $u_{j}^{1}$：\n-   对于 $j = -1$：$u_{-1}^{1} = u_{-1}^{0} - \\frac{\\nu}{2}(u_{0}^{0} - u_{-2}^{0}) = 0 - \\frac{\\nu}{2}(1 - 0) = -\\frac{\\nu}{2}$。\n-   对于 $j = 0$：$u_{0}^{1} = u_{0}^{0} - \\frac{\\nu}{2}(u_{1}^{0} - u_{-1}^{0}) = 1 - \\frac{\\nu}{2}(0 - 0) = 1$。\n-   对于 $j = 1$：$u_{1}^{1} = u_{1}^{0} - \\frac{\\nu}{2}(u_{2}^{0} - u_{0}^{0}) = 0 - \\frac{\\nu}{2}(0 - 1) = \\frac{\\nu}{2}$。\n-   对于 $|j| \\ge 2$：所有项 $u_{j}^{0}$、$u_{j+1}^{0}$ 和 $u_{j-1}^{0}$ 均为零，所以 $u_{j}^{1} = 0$。\n\n在时间 $n=1$ 时的解是值的集合 $\\{..., 0, -\\frac{\\nu}{2}, 1, \\frac{\\nu}{2}, 0, ...\\}$。由于 $\\nu = \\frac{a \\Delta t}{\\Delta x}$ 且 $a, \\Delta t, \\Delta x$ 均为正，我们有 $\\nu  0$。因此，$u_{-1}^{1} = -\\frac{\\nu}{2}$ 是负的。这就为离散极值原理提供了一个具体的反例。\n\n为了找到对于任何最大值为 $1$ 的可行非负初始条件，$u_{j}^{1}$ 的精确最小值，我们分析表达式 $u_{j}^{1} = u_{j}^{0} - \\frac{\\nu}{2}u_{j+1}^{0} + \\frac{\\nu}{2}u_{j-1}^{0}$。给定对所有 $k$ 都有 $0 \\le u_{k}^{0} \\le 1$，我们可以为 $u_j^1$ 建立一个下界：\n$$ u_{j}^{1} \\ge \\min(u_j^0) - \\frac{\\nu}{2}\\max(u_{j+1}^0) + \\frac{\\nu}{2}\\min(u_{j-1}^0) = 0 - \\frac{\\nu}{2}(1) + \\frac{\\nu}{2}(0) = -\\frac{\\nu}{2} $$\n$-\\frac{\\nu}{2}$ 这个最小值可以通过我们的 delta 函数反例在 $j=-1$ 处（初始峰值在 $j=0$）达到。更一般地，一个像 $k \\le j$ 时 $u_k^0=0$ 且 $u_{j+1}^0=1$ 这样的初始条件会得到 $u_j^1 = -\\frac{\\nu}{2}$。因此，$u_j^1$ 的精确最小值是 $-\\frac{\\nu}{2}$。\n\n**第二部分：冯·诺依曼稳定性分析**\n\n我们通过将单个傅里叶模 $u_{j}^{n} = [G(\\theta)]^n e^{i k x_j}$ 代入离散方程来分析格式的稳定性。这里，$G(\\theta)$ 是放大因子，$\\theta = k \\Delta x$ 是无量纲波数。\n空间项变为：\n$u_{j+1}^{n} = [G(\\theta)]^n e^{i k (x_j + \\Delta x)} = [G(\\theta)]^n e^{i k x_j} e^{i k \\Delta x} = u_j^n e^{i\\theta}$\n$u_{j-1}^{n} = [G(\\theta)]^n e^{i k (x_j - \\Delta x)} = [G(\\theta)]^n e^{i k x_j} e^{-i k \\Delta x} = u_j^n e^{-i\\theta}$\n\n将这些代入 FTCS 格式中：\n$$u_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}\\left(u_{j}^{n}e^{i\\theta} - u_{j}^{n}e^{-i\\theta}\\right)$$\n项 $u_j^{n+1}$ 是 $G(\\theta) u_j^n$。除以 $u_{j}^{n}$（对于非平凡模，该项非零），我们得到放大因子 $G(\\theta)$：\n$$G(\\theta) = 1 - \\frac{\\nu}{2}\\left(e^{i\\theta} - e^{-i\\theta}\\right)$$\n使用欧拉恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$，我们有：\n$$G(\\theta) = 1 - i\\nu\\sin(\\theta)$$\n为了使一个格式在冯·诺依曼意义下是稳定的，放大因子的模必须对所有可能的 $\\theta$ 满足 $|G(\\theta)| \\le 1$。让我们计算 $G(\\theta)$ 的模：\n$$|G(\\theta)| = |1 - i\\nu\\sin(\\theta)|$$\n这是一个复数的模，其实部为 $1$，虚部为 $-\\nu\\sin(\\theta)$。\n$$|G(\\theta)| = \\sqrt{(\\text{Re}[G(\\theta)])^2 + (\\text{Im}[G(\\theta)])^2} = \\sqrt{1^2 + (-\\nu\\sin(\\theta))^2} = \\sqrt{1 + \\nu^2\\sin^2(\\theta)}$$\n问题要求 $|G(\\theta)|$ 在所有 $\\theta \\in \\mathbb{R}$ 上的上确界。为了找到这个值，我们需要最大化表达式 $\\sqrt{1 + \\nu^2\\sin^2(\\theta)}$。由于平方根函数是单调的，这等价于最大化其自变量 $1 + \\nu^2\\sin^2(\\theta)$。\n\n库朗数 $\\nu$ 是一个正常数。项 $\\sin^2(\\theta)$ 在 $0$ 和 $1$ 之间变化。$\\sin^2(\\theta)$ 的最大值是 $1$，这在 $\\theta = \\frac{\\pi}{2} + m\\pi$（对于任何整数 $m$）时出现。\n因此，$|G(\\theta)|$ 的上确界是：\n$$\\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)| = \\sqrt{1 + \\nu^2(1)} = \\sqrt{1 + \\nu^2}$$\n由于 $\\nu  0$，我们有 $\\sqrt{1+\\nu^2}  1$。这表明，对于任何 $\\Delta x$ 和 $\\Delta t$ 的选择，总会有傅里叶模被放大，意味着对于线性平流方程，FTCS 格式是无条件不稳定的。\n\n**最终答案构造**\n\n问题要求一个包含以下两个元素的行向量：\n1.  $u_{j}^{1}$ 的最小值：$-\\frac{\\nu}{2}$。\n2.  $|G(\\theta)|$ 在所有 $\\theta$ 上的上确界：$\\sqrt{1 + \\nu^2}$。\n\n最终答案以要求的格式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\nu}{2}  \\sqrt{1 + \\nu^2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "鉴于中心差分格式在求解平流问题上的失败，我们需要一种更稳健的方法。迎风格式（upwind scheme）应运而生，它通过利用信息传播的方向来构建差分，从而引入了必要的数值属性以维持稳定性 。在这个二维平流问题的实践中，你将不再使用冯·诺依曼分析，而是通过另一个强大的概念——保证数值解满足极值原理的单调性条件——来推导稳定性约束。最终，你将得出一个严格的CFL条件，该条件确保格式的更新是一种凸组合，从而保证其在 $\\ell^{\\infty}$ 范数下的稳定性。",
            "id": "3463187",
            "problem": "考虑常系数二维线性平流方程 $u_{t} + a\\,u_{x} + b\\,u_{y} = 0$，该方程建立在一个矩形的、均匀的笛卡尔网格上，其网格间距为 $\\Delta x  0$ 和 $\\Delta y  0$，并使用时间步长为 $\\Delta t  0$ 的单步显式方法进行时间推进。假设两个空间方向上都采用周期性边界条件，因此网格在拓扑上是一个环面。令 $U^{n}_{i,j}$ 表示在时间层 $t^{n} = n\\,\\Delta t$、节点 $(i,j)$ 上的网格函数。\n\n已知更新值 $U^{n+1}_{i,j}$ 是由当前值以及根据 $a$ 和 $b$ 的符号选择的 $x$ 和 $y$ 方向上紧邻的逆风向邻点的凸组合构成的：其计算模板由中心点 $(i,j)$ 以及点 $(i-\\operatorname{sgn}(a),j)$ 和 $(i,j-\\operatorname{sgn}(b))$ 组成。该格式与 $u_{t} + a\\,u_{x} + b\\,u_{y} = 0$ 相容，在时间和空间上均具有一阶精度，这是通过时间上采用前向欧拉法和空间上采用一阶迎风差分得到的。\n\n从单调格式、离散极值原理以及一致范数下稳定性的核心定义出发，推导严格的 Courant–Friedrichs–Lewy (CFL) 约束条件。该条件精确地刻画了显式更新何时是具有非负系数的凸组合且是 $\\ell^{\\infty}$-稳定的。请用一个关于 $a$、$b$、$\\Delta x$ 和 $\\Delta y$ 的最大允许 $\\Delta t$ 的单一闭式解析表达式来表示你的答案。\n\n你的最终答案必须是一个单一的解析表达式。无需进行四舍五入。",
            "solution": "本问题要求推导二维线性平流方程的一阶显式迎风格式的 Courant–Friedrichs–Lewy (CFL) 条件。所寻求的条件是能使该格式成为一个凸组合的条件，这反过来又保证了在一致范数下的稳定性（$\\ell^{\\infty}$-稳定性）并满足离散极值原理。\n\n控制偏微分方程 (PDE) 是二维常系数线性平流方程：\n$$\nu_{t} + a\\,u_{x} + b\\,u_{y} = 0\n$$\n其中 $u(x,y,t)$ 是被输运的量，$a$ 和 $b$ 分别是 $x$ 和 $y$ 方向上的常数速度分量。\n\n我们在一个空间间距为 $\\Delta x$ 和 $\\Delta y$、时间步长为 $\\Delta t$ 的均匀笛卡尔网格上对此方程进行离散化。网格函数 $U^{n}_{i,j}$ 近似了精确解 $u(i\\Delta x, j\\Delta y, n\\Delta t)$。\n\n该数值格式是使用前向欧拉法处理时间导数、使用一阶迎风差分处理空间导数构建的。\n时间导数近似为：\n$$\nu_{t} \\approx \\frac{U^{n+1}_{i,j} - U^{n}_{i,j}}{\\Delta t}\n$$\n空间导数 $u_x$ 和 $u_y$ 使用迎风差分进行近似，这意味着差分是在流动来源的方向上取的。邻点的选择取决于相应速度分量的符号。\n\n对于 $x$-导数项 $a\\,u_{x}$：\n- 如果 $a  0$，流动方向是从左到右，因此我们使用后向差分：$a\\,u_{x} \\approx a\\frac{U^{n}_{i,j} - U^{n}_{i-1,j}}{\\Delta x}$。\n- 如果 $a  0$，流动方向是从右到左，因此我们使用前向差分：$a\\,u_{x} \\approx a\\frac{U^{n}_{i+1,j} - U^{n}_{i,j}}{\\Delta x}$。\n如果 $a=0$，此项为零，不需要空间差分。\n\n这些情况可以使用符号函数 $\\operatorname{sgn}(a)$ 和绝对值 $|a|$ 来紧凑地表示。注意，对于 $a \\neq 0$，$a = |a|\\operatorname{sgn}(a)$。\n$a\\,u_x$ 的迎风离散可以表示为：\n$$\na\\,u_{x} \\approx \\frac{|a|}{\\Delta x} \\left( U^{n}_{i,j} - U^{n}_{i-\\operatorname{sgn}(a),j} \\right)\n$$\n可以验证该表达式对于 $a0$ ($\\operatorname{sgn}(a)=1$) 和 $a0$ ($\\operatorname{sgn}(a)=-1$) 的情况。对于 $a0$，它变为 $\\frac{-a}{\\Delta x} (U^n_{i,j} - U^n_{i+1,j}) = a \\frac{U^n_{i+1,j}-U^n_{i,j}}{\\Delta x}$，这是正确的。如果我们定义 $\\operatorname{sgn}(0)=0$，此公式对于 $a=0$ 也成立，结果为 $0$。\n\n类似地，对于 $y$-导数项 $b\\,u_{y}$：\n$$\nb\\,u_{y} \\approx \\frac{|b|}{\\Delta y} \\left( U^{n}_{i,j} - U^{n}_{i,j-\\operatorname{sgn}(b)} \\right)\n$$\n\n将这些近似代入 PDE，得到有限差分方程：\n$$\n\\frac{U^{n+1}_{i,j} - U^{n}_{i,j}}{\\Delta t} + \\frac{|a|}{\\Delta x} \\left( U^{n}_{i,j} - U^{n}_{i-\\operatorname{sgn}(a),j} \\right) + \\frac{|b|}{\\Delta y} \\left( U^{n}_{i,j} - U^{n}_{i,j-\\operatorname{sgn}(b)} \\right) = 0\n$$\n我们可以求解更新后的值 $U^{n+1}_{i,j}$：\n$$\nU^{n+1}_{i,j} = U^{n}_{i,j} - \\frac{|a|\\Delta t}{\\Delta x} \\left( U^{n}_{i,j} - U^{n}_{i-\\operatorname{sgn}(a),j} \\right) - \\frac{|b|\\Delta t}{\\Delta y} \\left( U^{n}_{i,j} - U^{n}_{i,j-\\operatorname{sgn}(b)} \\right)\n$$\n按时间层 $n$ 的网格函数值对各项进行分组：\n$$\nU^{n+1}_{i,j} = \\left( 1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y} \\right) U^{n}_{i,j} + \\left( \\frac{|a|\\Delta t}{\\Delta x} \\right) U^{n}_{i-\\operatorname{sgn}(a),j} + \\left( \\frac{|b|\\Delta t}{\\Delta y} \\right) U^{n}_{i,j-\\operatorname{sgn}(b)}\n$$\n这个方程表明，$U^{n+1}_{i,j}$ 是时间层 $n$ 上模板点 $(i,j)$、$(i-\\operatorname{sgn}(a),j)$ 和 $(i,j-\\operatorname{sgn}(b))$ 处值的线性组合，这与问题描述一致。\n\n问题指出更新必须是凸组合。如果所有系数 $c_k$ 都是非负的 ($c_k \\ge 0$) 并且它们的和等于1 ($\\sum_k c_k = 1$)，则线性组合 $Y = \\sum_{k} c_k X_k$ 是一个凸组合。具有此属性的格式称为单调格式。此类格式满足离散极值原理，即对所有 $k,l$ 都有 $\\min_{i,j}(U^n_{i,j}) \\le U^{n+1}_{k,l} \\le \\max_{i,j}(U^n_{i,j})$。这直接蕴含了一致范数下的稳定性，$\\|U^{n+1}\\|_{\\infty} \\le \\|U^n\\|_{\\infty}$。\n\n让我们检查我们格式中的系数：\n$$\n\\begin{align*}\nC_{i,j} = 1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y} \\\\\nC_{i-\\operatorname{sgn}(a),j} = \\frac{|a|\\Delta t}{\\Delta x} \\\\\nC_{i,j-\\operatorname{sgn}(b)} = \\frac{|b|\\Delta t}{\\Delta y}\n\\end{align*}\n$$\n首先，我们检查系数之和是否为 $1$：\n$$\n\\sum C = \\left( 1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y} \\right) + \\frac{|a|\\Delta t}{\\Delta x} + \\frac{|b|\\Delta t}{\\Delta y} = 1\n$$\n和总是 $1$，这是格式与 PDE 相容性的一个结果。\n\n接下来，我们强制要求所有系数的非负性。\n由于 $\\Delta t  0$，$\\Delta x  0$，$\\Delta y  0$，$|a| \\ge 0$ 和 $|b| \\ge 0$：\n-   系数 $C_{i-\\operatorname{sgn}(a),j} = \\frac{|a|\\Delta t}{\\Delta x}$ 总是非负的。\n-   系数 $C_{i,j-\\operatorname{sgn}(b)} = \\frac{|b|\\Delta t}{\\Delta y}$ 总是非负的。\n唯一剩下的条件是针对中心点 $U^{n}_{i,j}$ 的系数：\n$$\nC_{i,j} = 1 - \\frac{|a|\\Delta t}{\\Delta x} - \\frac{|b|\\Delta t}{\\Delta y} \\ge 0\n$$\n这个不等式提供了稳定性约束。这是使格式成为单调格式并因此 $\\ell^\\infty$-稳定的条件。我们现在求解 $\\Delta t$：\n$$\n1 \\ge \\frac{|a|\\Delta t}{\\Delta x} + \\frac{|b|\\Delta t}{\\Delta y}\n$$\n$$\n1 \\ge \\Delta t \\left( \\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y} \\right)\n$$\n假设 $a$ 和 $b$ 不全为零（在这种情况下方程是平凡的），括号中的项是正的。因此，我们可以用它来除以两边以分离出 $\\Delta t$：\n$$\n\\Delta t \\le \\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y}}\n$$\n这就是该格式的 Courant–Friedrichs–Lewy (CFL) 条件。问题要求的是最严格的约束，对应于 $\\Delta t$ 的最大允许值。这可以通过取等号得到：\n$$\n\\Delta t_{\\text{max}} = \\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y}}\n$$\n任何大于此值的 $\\Delta t$ 都会导致系数 $C_{i,j}$ 变为负值，从而违反凸组合的性质，并可能导致非物理振荡和不稳定性。因此，这构成了一阶迎风格式的 $\\ell^\\infty$-稳定性的严格 CFL 约束。",
            "answer": "$$\\boxed{\\frac{1}{\\frac{|a|}{\\Delta x} + \\frac{|b|}{\\Delta y}}}$$"
        }
    ]
}