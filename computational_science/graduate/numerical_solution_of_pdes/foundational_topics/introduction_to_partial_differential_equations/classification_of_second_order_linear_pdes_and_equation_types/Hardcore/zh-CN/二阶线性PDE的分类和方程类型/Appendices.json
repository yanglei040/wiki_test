{
    "hands_on_practices": [
        {
            "introduction": "对偏微分方程进行分类仅仅是第一步。真正的洞察力来自于将其变换为更简单的“典范形式”，这揭示了其基本性质，类似于在几何学中旋转坐标轴以简化二次曲线方程。这个练习提供了将一个具有混合导数项的方程对角化为典范形式的实践，通过计算特征值和旋转角度，将代数操作与消除混合导数的几何直觉联系起来 。",
            "id": "3371555",
            "problem": "考虑一个二阶线性偏微分方程（PDE）的主部，其形式为 $u_{xx}-4u_{xy}-3u_{yy}$。二阶线性偏微分方程的分类基于其主部系数构成的对称 $2 \\times 2$ 矩阵及其特征值的符号。变量的正交变换对应于坐标轴的旋转，它保持方程类型不变，并能使主部对角化。\n\n仅根据这些定义和事实，完成以下任务：\n\n1. 通过确定其二次型对称系数矩阵的特征值符号，对偏微分方程 $u_{xx}-4u_{xy}-3u_{yy}$ 进行分类，并说明方程类型。\n2. 进行空间坐标的正交旋转 $(x,y) \\mapsto (\\xi,\\eta)$，以消除混合导数项。明确求出旋转角 $\\theta$ 的弧度值，选择主值 $\\theta \\in (-\\pi/2,\\pi/2)$。\n3. 使用此旋转，将主部写成不含混合导数的标准型，然后重新缩放旋转后的坐标，使标准的双曲型具有单位系数，即 $u_{\\tilde{\\xi}\\tilde{\\xi}} - u_{\\tilde{\\eta}\\tilde{\\eta}}$ 的形式。\n\n将你的最终答案表示为旋转角 $\\theta$ 的精确弧度值。不需要四舍五入，角度应以弧度为单位给出。",
            "solution": "该问题要求对给定的二阶线性偏微分方程（PDE）进行分类并将其转换为标准型。分析基于该PDE的主部，即 $u_{xx}-4u_{xy}-3u_{yy}$。\n\n在两个变量 $x$ 和 $y$ 中，二阶线性PDE主部的一般形式为 $A u_{xx} + B u_{xy} + C u_{yy}$。对于给定的方程，我们确定系数为：\n$A = 1$\n$B = -4$\n$C = -3$\n\nPDE的分类取决于与此二次型相关的对称系数矩阵的性质。该矩阵记为 $M$，构造如下：\n$$\nM = \\begin{pmatrix} A  \\frac{B}{2} \\\\ \\frac{B}{2}  C \\end{pmatrix} = \\begin{pmatrix} 1  -2 \\\\ -2  -3 \\end{pmatrix}\n$$\n\n**1. PDE的分类**\n\nPDE的类型由矩阵 $M$ 的特征值的符号决定。特征值（记为 $\\lambda$）是特征方程 $\\det(M - \\lambda I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det \\begin{pmatrix} 1-\\lambda  -2 \\\\ -2  -3-\\lambda \\end{pmatrix} = 0\n$$\n展开行列式得到特征多项式：\n$$\n(1-\\lambda)(-3-\\lambda) - (-2)(-2) = 0\n$$\n$$\n-3 - \\lambda + 3\\lambda + \\lambda^2 - 4 = 0\n$$\n$$\n\\lambda^2 + 2\\lambda - 7 = 0\n$$\n我们使用二次公式求解 $\\lambda$：\n$$\n\\lambda = \\frac{-2 \\pm \\sqrt{2^2 - 4(1)(-7)}}{2(1)} = \\frac{-2 \\pm \\sqrt{4 + 28}}{2} = \\frac{-2 \\pm \\sqrt{32}}{2} = \\frac{-2 \\pm 4\\sqrt{2}}{2}\n$$\n两个特征值为：\n$$\n\\lambda_1 = -1 + 2\\sqrt{2} \\quad \\text{和} \\quad \\lambda_2 = -1 - 2\\sqrt{2}\n$$\n为了确定它们的符号，我们注意到 $\\sqrt{2} \\approx 1.414$，所以 $2\\sqrt{2} = \\sqrt{8} \\approx 2.828$。\n因此，$\\lambda_1 = -1 + 2\\sqrt{2} > 0$ 且 $\\lambda_2 = -1 - 2\\sqrt{2}  0$。\n由于特征值符号相反（$\\lambda_1 \\lambda_2 = \\det(M) = (1)(-3) - (-2)(-2) = -7  0$），该PDE被分类为**双曲型**。\n\n这个结果可以用判别式 $\\Delta = B^2 - 4AC$ 来验证：\n$$\n\\Delta = (-4)^2 - 4(1)(-3) = 16 + 12 = 28 > 0\n$$\n正判别式也表示方程是双曲型的。\n\n**2. 消除混合导数的正交旋转**\n\n将坐标系 $(x,y)$ 正交旋转到一个新坐标系 $(\\xi,\\eta)$ 可以使矩阵 $M$ 对角化。这对应于找到一个与 $M$ 的特征向量对齐的坐标系，从而消除混合偏导数项 $u_{\\xi\\eta}$。实现这一目标所需的旋转角 $\\theta$ 由以下公式给出：\n$$\n\\tan(2\\theta) = \\frac{B}{A-C}\n$$\n代入系数 $A=1$、$B=-4$ 和 $C=-3$：\n$$\n\\tan(2\\theta) = \\frac{-4}{1 - (-3)} = \\frac{-4}{4} = -1\n$$\n我们需要在主值区间 $(-\\frac{\\pi}{2}, \\frac{\\pi}{2})$ 内找到 $\\theta$。这意味着 $2\\theta$ 必须在区间 $(-\\pi, \\pi)$ 内。反正切函数的主值给出：\n$$\n2\\theta = \\arctan(-1) = -\\frac{\\pi}{4}\n$$\n求解 $\\theta$：\n$$\n\\theta = -\\frac{\\pi}{8}\n$$\n这个值位于指定的区间 $(-\\frac{\\pi}{2}, \\frac{\\pi}{2})$ 内。\n\n**3. 标准型**\n\n坐标旋转由以下公式给出：\n$$\n\\begin{pmatrix} \\xi \\\\ \\eta \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix}\n$$\n在此变换下，PDE的主部变换为：\n$$\nA u_{xx} + B u_{xy} + C u_{yy} \\longrightarrow \\lambda_{\\xi} u_{\\xi\\xi} + \\lambda_{\\eta} u_{\\eta\\eta}\n$$\n其中 $\\lambda_{\\xi}$ 和 $\\lambda_{\\eta}$ 是 $M$ 的特征值。特征值到新坐标轴的具体分配取决于旋转的选择。对于我们选择的 $\\theta = -\\frac{\\pi}{8}$，新系数是特征值 $\\lambda_1$ 和 $\\lambda_2$。我们来确定这种关联。微分算子的变换导致二次型被对角化为 $\\lambda_1 \\partial_{\\xi'}^2 + \\lambda_2 \\partial_{\\eta'}^2$，其中新坐标轴与特征向量对齐。算子变为：\n$$\n(-1+2\\sqrt{2}) u_{\\xi\\xi} + (-1-2\\sqrt{2}) u_{\\eta\\eta}\n$$\n这就是不含混合导数的标准型。\n\n最后一步是将坐标 $(\\xi, \\eta)$ 重新缩放为新坐标 $(\\tilde{\\xi}, \\tilde{\\eta})$，使系数的绝对值为单位1，从而得到 $u_{\\tilde{\\xi}\\tilde{\\xi}} - u_{\\tilde{\\eta}\\tilde{\\eta}}$ 的形式。\n设标准型写作 $\\lambda_1 u_{\\xi\\xi} + \\lambda_2 u_{\\eta\\eta}$，其中 $\\lambda_1 = 2\\sqrt{2}-1 > 0$ 且 $\\lambda_2 = -1-2\\sqrt{2}  0$。\n我们定义重新缩放如下：\n$$\n\\tilde{\\xi} = \\sqrt{\\lambda_1} \\xi = \\sqrt{2\\sqrt{2}-1} \\xi\n$$\n$$\n\\tilde{\\eta} = \\sqrt{|\\lambda_2|} \\eta = \\sqrt{1+2\\sqrt{2}} \\eta\n$$\n链式法则给出：\n$u_{\\xi} = \\frac{d\\tilde{\\xi}}{d\\xi} u_{\\tilde{\\xi}} = \\sqrt{2\\sqrt{2}-1} \\ u_{\\tilde{\\xi}} \\implies u_{\\xi\\xi} = (2\\sqrt{2}-1) u_{\\tilde{\\xi}\\tilde{\\xi}}$\n$u_{\\eta} = \\frac{d\\tilde{\\eta}}{d\\eta} u_{\\tilde{\\eta}} = \\sqrt{1+2\\sqrt{2}} \\ u_{\\tilde{\\eta}} \\implies u_{\\eta\\eta} = (1+2\\sqrt{2}) u_{\\tilde{\\eta}\\tilde{\\eta}}$\n\n将这些代入标准型：\n$$\n(2\\sqrt{2}-1) u_{\\xi\\xi} - (1+2\\sqrt{2}) u_{\\eta\\eta} = (2\\sqrt{2}-1) \\frac{u_{\\tilde{\\xi}\\tilde{\\xi}}}{2\\sqrt{2}-1} - (1+2\\sqrt{2}) \\frac{u_{\\tilde{\\eta}\\tilde{\\eta}}}{1+2\\sqrt{2}}\n$$\n这简化为目标双曲型，其系数为单位1：\n$$\nu_{\\tilde{\\xi}\\tilde{\\xi}} - u_{\\tilde{\\eta}\\tilde{\\eta}}\n$$\n问题要求旋转角 $\\theta$ 的精确值。根据我们的推导，这个角度是 $-\\frac{\\pi}{8}$ 弧度。",
            "answer": "$$\n\\boxed{-\\frac{\\pi}{8}}\n$$"
        },
        {
            "introduction": "在许多实际应用中，偏微分方程的系数并非恒定，而是随空间变化，这意味着方程的类型可能从一个区域变为另一个区域。本练习要求我们将分类判据应用于一个变系数方程，并在整个定义域上绘制出方程的类型分布图。这项技能对于为混合型问题选择合适的数值方法至关重要 。",
            "id": "3371537",
            "problem": "考虑在两个空间变量上的二阶线性偏微分方程（PDE），\n$$u_{xx}+2\\,(1-x)\\,u_{xy}-(1+x^{2})\\,u_{yy}=0,$$\n该方程定义在坐标为 $(x,y)$ 的平面 $\\mathbb{R}^{2}$ 上。从二元二阶线性偏微分方程类型分类的核心定义出发——即，对于写成 $A\\,u_{xx}+2\\,B\\,u_{xy}+C\\,u_{yy}$ 形式的主部，其判别式 $D$ 定义为 $D=B^{2}-A\\,C$——请执行以下操作：\n\n(1) 确定给定偏微分方程的主系数 $A$、$B$ 和 $C$，并推导出判别式 $D(x)$ 作为关于 $x$ 的显式解析表达式。\n\n(2) 仅使用 $D(x)$ 的符号和偏微分方程类型的标准定义（椭圆型若 $D0$，抛物线型若 $D=0$，双曲型若 $D0$），构建 $(x,y)$ 平面上的分段分类图，精确指出哪些区域是椭圆型、抛物线型或双曲型。请明确说明方程类型是否依赖于 $x$ 和/或 $y$。\n\n(3) 找出平面上所有满足 $D(x)=0$ 的实曲线（如果存在），这些曲线标志着抛物线型退化。如果不存在这样的曲线，请根据你的 $D(x)$ 表达式直接证明该结论。\n\n(4) 简要解释你的分类图对特征曲线的定性结构以及双曲型问题与椭圆型问题的数值格式选择的意义，并将你的讨论建立在 $D(x)$ 的符号和主部的基础上。\n\n你最终报告的答案必须是判别式 $D(x)$ 的简化解析表达式。无需四舍五入。最终答案中不包含单位。",
            "solution": "该问题要求对一个给定的二阶线性偏微分方程（PDE）进行分类，分析其在整个定义域上的类型，并讨论其意义。第一步是验证问题陈述的有效性。\n\n### 步骤 1：提取已知信息\n提供的已知信息如下：\n- 偏微分方程：$u_{xx}+2\\,(1-x)\\,u_{xy}-(1+x^{2})\\,u_{yy}=0$。\n- 定义域是坐标为 $(x,y)$ 的平面 $\\mathbb{R}^{2}$。\n- 主部的一般形式是 $A\\,u_{xx}+2\\,B\\,u_{xy}+C\\,u_{yy}$。\n- 判别式的定义是 $D=B^{2}-A\\,C$。\n- 分类标准为：\n  - 椭圆型若 $D0$。\n  - 抛物线型若 $D=0$。\n  - 双曲型若 $D0$。\n\n### 步骤 2：使用提取的已知信息进行验证\n该问题具有科学依据，因为它涉及二阶线性偏微分方程的标准分类，这是数学物理和数值分析中的一个基本课题。定义和方程都是标准且正确的。问题是适定的，提供了确定系数、计算判别式和对方程进行分类所需的所有必要信息。语言客观而精确。没有矛盾、缺失数据或不符合科学原理的前提。该问题有效。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n分析将根据问题陈述的四个部分进行组织。\n\n**(1) 确定系数与推导判别式**\n\n给定的偏微分方程是：\n$$u_{xx}+2\\,(1-x)\\,u_{xy}-(1+x^{2})\\,u_{yy}=0$$\n为了对此方程进行分类，我们将其与二元二阶线性偏微分方程主部的一般形式进行比较：\n$$A(x,y)\\,u_{xx}+2\\,B(x,y)\\,u_{xy}+C(x,y)\\,u_{yy} + \\text{lower order terms} = 0$$\n通过直接比较，我们确定给定偏微分方程的系数 $A$、$B$ 和 $C$：\n- $u_{xx}$ 的系数是 $A = 1$。\n- $u_{xy}$ 的系数是 $2(1-x)$，因此 $2B = 2(1-x)$，得到 $B = 1-x$。\n- $u_{yy}$ 的系数是 $-(1+x^2)$，因此 $C = -(1+x^2)$。\n\n判别式 $D$ 定义为 $D = B^{2} - A\\,C$。代入已确定的系数，我们推导出判别式是关于 $x$ 的函数：\n$$D(x) = (1-x)^{2} - (1)\\left(-(1+x^{2})\\right)$$\n展开各项，我们得到：\n$$D(x) = (1 - 2x + x^{2}) + (1+x^{2})$$\n合并同类项得到判别式的简化解析表达式：\n$$D(x) = 2x^{2} - 2x + 2$$\n这也可以写成因式分解的形式 $D(x) = 2(x^2 - x + 1)$。\n\n**(2) $(x,y)$ 平面上的分类图**\n\n偏微分方程的类型（椭圆型、抛物线型或双曲型）由判别式 $D(x) = 2x^{2} - 2x + 2$ 的符号决定。系数 $A$、$B$ 和 $C$ 仅依赖于变量 $x$，因此判别式 $D$ 和偏微分方程的类型也仅依赖于 $x$，而不依赖于 $y$。\n\n为了确定 $D(x)$ 的符号，我们分析二次多项式 $p(x) = x^{2} - x + 1$。$D(x)$ 的符号与 $p(x)$ 的符号相同，因为 $D(x)=2p(x)$ 且 $20$。我们可以通过二次公式检查 $p(x)$ 的实根来确定其符号，其中多项式本身（而非偏微分方程）的判别式为 $\\Delta = b^2 - 4ac$。对于 $p(x)=x^2-x+1$，我们有 $a=1$, $b=-1$, $c=1$。\n$$\\Delta = (-1)^{2} - 4(1)(1) = 1 - 4 = -3$$\n由于 $\\Delta  0$ 且首项系数 $a=1$ 为正，二次多项式 $p(x)$ 没有实根，并且对于所有实数 $x$ 都严格为正。\n\n或者，我们可以对 $p(x)$ 进行配方：\n$$p(x) = x^{2} - x + 1 = \\left(x^{2} - x + \\frac{1}{4}\\right) - \\frac{1}{4} + 1 = \\left(x - \\frac{1}{2}\\right)^{2} + \\frac{3}{4}$$\n由于对于所有 $x \\in \\mathbb{R}$，$\\left(x-\\frac{1}{2}\\right)^2 \\ge 0$，因此 $p(x)$ 的最小值为 $\\frac{3}{4}$，在 $x=\\frac{1}{2}$ 处取得。因此，对于所有 $x$，$p(x) > 0$。\n\n因此，该偏微分方程的判别式 $D(x) = 2 p(x) = 2\\left(\\left(x - \\frac{1}{2}\\right)^{2} + \\frac{3}{4}\\right)$ 对于所有 $x \\in \\mathbb{R}$ 都严格为正。\n$$D(x) > 0 \\quad \\forall (x,y) \\in \\mathbb{R}^{2}$$\n根据分类标准：\n- **椭圆型 ($D  0$)**：该偏微分方程从不为椭圆型。\n- **抛物线型 ($D = 0$)**：该偏微分方程从不为抛物线型。\n- **双曲型 ($D > 0$)**：该偏微分方程在平面 $\\mathbb{R}^{2}$ 上的所有点 $(x,y)$ 处均为双曲型。\n\n分类图是统一的：整个 $(x,y)$ 平面都是双曲型区域。\n\n**(3) 抛物线型退化曲线**\n\n抛物线型退化发生在判别式为零的点，即 $D(x) = 0$。\n$$2x^{2} - 2x + 2 = 0$$\n两边同除以 2，我们得到方程：\n$$x^{2} - x + 1 = 0$$\n如第 (2) 部分所述，该二次方程对于 $x$ 没有实数解。因此，在 $(x,y)$ 平面中不存在满足 $D(x)=0$ 的实曲线。该偏微分方程从不为抛物线型，也不表现出任何抛物线型退化。\n\n**(4) 对特征曲线和数值格式的意义**\n\n判别式 $D(x)$ 恒为正这一事实对解的行为和数值方法的选择具有重要意义。\n\n- **特征曲线**：由于该偏微分方程处处为双曲型 ($D > 0$)，因此存在两个不同的实特征曲线族穿过 $(x,y)$ 平面中的任意一点。这些曲线表示信息（或导数的不连续性）传播的路径。特征曲线的方程由 $A\\,(dy)^2 - 2B\\,dy\\,dx + C\\,(dx)^2 = 0$ 给出。代入我们的系数：\n$$(1)(dy)^2 - 2(1-x)\\,dy\\,dx + (-(1+x^2))(dx)^2 = 0$$\n特征线的斜率 $\\frac{dy}{dx}$ 是以下二次方程的根：\n$$\\left(\\frac{dy}{dx}\\right)^2 - 2(1-x)\\frac{dy}{dx} - (1+x^2) = 0$$\n斜率的解为 $\\frac{dy}{dx} = (1-x) \\pm \\sqrt{(1-x)^2 + (1+x^2)} = (1-x) \\pm \\sqrt{2x^2-2x+2}$。由于根号下的项正是判别式 $D(x) = 2x^2-2x+2$，它恒为正，因此总存在两个不同的实斜率。这种结构是类波现象的典型特征。\n\n- **数值格式**：方程的分类决定了适用的数值算法类别。对于像这样的**双曲型**方程，通常提出初值问题（例如，在初始时刻指定 $u$ 及其时间导数）。数值方法必须遵循沿特征线的信息流方向。合适的格式包括显式有限差分法（如迎风格式、Lax-Friedrichs 格式或 MacCormack 格式）或特征线法。这些显式方法通常受到稳定性约束，即 Courant-Friedrichs-Lewy (CFL) 条件，该条件限制了时间步长相对于空间网格间距的大小，以确保数值依赖域能够捕捉到真实的物理依赖域。\n\n相比之下，如果该偏微分方程是**椭圆型**的 ($D  0$)，它将模拟一个稳态过程，其解由封闭域上的边界条件决定。合适的数值方法将是针对由此产生的线性方程组的迭代求解器，如 Jacobi 或 Gauss-Seidel 方法。\n\n由于给定的偏微分方程处处为双曲型，为双曲系统设计的数值格式可以统一应用于整个计算域。无需使用在椭圆型和双曲型求解器之间切换的混合格式，而这对于混合型偏微分方程是必需的。",
            "answer": "$$\\boxed{2x^{2} - 2x + 2}$$"
        },
        {
            "introduction": "尽管解析分类是基础，但理解这些性质在数值计算中如何体现也至关重要。本练习在连续理论和离散计算之间架起了一座直接的桥梁。通过检查离散算子的特征值谱，我们可以开发一种数值“试金石”来验证偏微分方程的类型，从而确认在离散化后其核心数学结构是否得以保持 。",
            "id": "3371504",
            "problem": "考虑二维空间中的常系数二阶线性偏微分算子族，其由角度 $\\,\\theta\\,$ 参数化：\n$$\nL_{\\theta} u \\;=\\; \\cos\\theta\\;u_{xx} \\;+\\; 2\\sin\\theta\\;u_{xy} \\;+\\; (1-\\cos\\theta)\\;u_{yy}.\n$$\n一个具有主部 $\\,A\\,u_{xx} + 2B\\,u_{xy} + C\\,u_{yy}\\,$ 的非散度形式二变量二阶线性偏微分方程的分类，由相关二次型的符号确定，等价地，由主系数矩阵\n$$\n\\mathbf{P} \\;=\\; \\begin{pmatrix} A  B \\\\ B  C \\end{pmatrix}\n$$\n通过 $\\,\\mathbf{P}\\,$ 的定性或 $\\,B^2 - A\\,C\\,$ 的符号来确定。类型定义如下：\n- 如果二次型是定的（$\\,\\mathbf{P}\\,$ 的两个特征值符号相同，等价于 $\\,B^2 - AC  0\\,$），则为椭圆型。\n- 如果二次型是不定的（特征值符号相反，等价于 $\\,B^2 - AC  0\\,$），则为双曲型。\n- 如果二次型是半定的且非定的（一个特征值为零而另一个非零，等价于 $\\,B^2 - AC = 0\\,$），则为抛物型。\n\n你的任务是建立一个数值基准测试，通过在周期性网格上检验一个相容的中心差分离散化的离散谱特征来验证这种分类。请遵循以下要求。\n\n1) 从第一性原理进行解析分类：\n- 从与 $\\,L_{\\theta}\\,$ 相关的主矩阵 $\\,\\mathbf{P}\\,$ 出发，通过计算 $\\,B^2 - A C\\,$ 来推断类型作为 $\\,\\theta\\,$ 的函数。推导必须从上述定义开始，而不能使用任何预先记下的捷径。\n\n2) 通过离散谱特征进行数值验证：\n- 在单位周期性正方形 $[0,1)\\times[0,1)$ 上使用一个 $\\,N\\times N\\,$ 的均匀网格，其中 $\\,N\\,$ 是一个正整数。在两个方向上使用相等的网格间距。实现对 $\\,u_{xx}\\,$, $\\,u_{yy}\\,$ 和 $\\,u_{xy}\\,$ 的中心差分近似，并采用周期性环绕（周期性边界条件）。然后，使用所得循环算子的离散傅里叶对角化来获得完整的离散特征值集合。计算过程必须完全自包含，且不能依赖任何外部文件或用户输入。\n- 使用数值容差 $\\,\\tau  0\\,$ 来识别接近零的值，将基于离散谱特征的分类定义如下：\n  - 如果存在至少一个严格为正和至少一个严格为负的离散特征值（正负性相对于 $\\,\\tau\\,$ 测试），则为类双曲型。\n  - 如果所有离散特征值均为同号或零，并且存在至少一个特征值，其绝对值小于或等于 $\\,\\tau\\,$（即，具有非平凡零空间的半定），则为类抛物型。\n  - 如果所有离散特征值相对于 $\\,\\tau\\,$ 均严格为正或均严格为负，并且没有一个的绝对值小于或等于 $\\,\\tau\\,$，则为类椭圆型。\n\n3) 测试套件与验证：\n- 每个方向使用 $\\,N = 129\\,$ 个网格点。\n- 使用数值零容差 $\\,\\tau = 10^{-12}\\,$。\n- 角度必须以弧度表示。角度参数的测试套件为：\n  - $\\,\\theta_1 = 0.0\\,$，\n  - $\\,\\theta_2 = \\pi/4\\,$，\n  - $\\,\\theta_3 = \\pi\\,$，\n  - $\\,\\theta_4 = 2\\pi - 0.08\\,$，\n  - $\\,\\theta_5 = 0.08\\,$。\n- 对于每个 $\\,\\theta_i\\,$：\n  1. 从第一性原理出发，解析地预测类型（椭圆型、双曲型、抛物型）。\n  2. 如前所述，使用 $\\,u_{xx}\\,$, $\\,u_{yy}\\,$ 和 $\\,u_{xy}\\,$ 的中心差分模板，在 $\\,N\\times N\\,$ 周期性网格上计算离散特征值。使用上述规则将离散谱分类为类双曲型、类抛物型或类椭圆型。\n  3. 输出一个布尔值，表示离散分类是否与解析预测相匹配。\n\n4) 最终输出格式：\n- 你的程序应产生单行输出，其中包含五个测试角度的结果，形式为方括号内以逗号分隔的列表。例如，输出必须具有以下形式：\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5],\n$$\n其中每个 $\\,\\text{result}_i\\,$ 是 True 或 False。角度以弧度为单位。问题中除弧度外不出现其他物理单位。没有百分比表达式；所有比较都是直接的布尔断言。",
            "solution": "问题要求对一个给定的由角度 $\\theta$ 参数化的二阶线性偏微分算子族 $L_{\\theta}$ 进行两部分分析。首先，我们必须根据其主系数对算子进行解析分类。其次，我们必须基于有限差分离散的谱进行数值分类，并验证两种分类对于一组测试参数是否一致。\n\n该算子由下式给出：\n$$\nL_{\\theta} u \\;=\\; \\cos\\theta\\;u_{xx} \\;+\\; 2\\sin\\theta\\;u_{xy} \\;+\\; (1-\\cos\\theta)\\;u_{yy}\n$$\n\n### 第1部分：解析分类\n\n具有主部 $A\\,u_{xx} + 2B\\,u_{xy} + C\\,u_{yy}$ 的二阶线性偏微分方程的分类取决于判别式 $D = B^2 - AC$ 的符号。\n从 $L_{\\theta}u$ 的定义中，我们确定系数如下：\n- $A = \\cos\\theta$\n- $B = \\sin\\theta$\n- $C = 1 - \\cos\\theta$\n\n现在，我们计算判别式 $D$ 作为 $\\theta$ 的函数：\n$$\nD(\\theta) = B^2 - AC = (\\sin\\theta)^2 - (\\cos\\theta)(1 - \\cos\\theta)\n$$\n展开表达式：\n$$\nD(\\theta) = \\sin^2\\theta - \\cos\\theta + \\cos^2\\theta\n$$\n使用基本三角恒等式 $\\sin^2\\theta + \\cos^2\\theta = 1$，判别式简化为：\n$$\nD(\\theta) = 1 - \\cos\\theta\n$$\n分类则由 $\\cos\\theta$ 的值确定：\n1.  **椭圆型**：$D(\\theta)  0 \\implies 1 - \\cos\\theta  0 \\implies \\cos\\theta > 1$。对于任何实数 $\\theta$，此条件永远不满足。因此，算子 $L_{\\theta}$ 绝不是椭圆型的。\n2.  **抛物型**：$D(\\theta) = 0 \\implies 1 - \\cos\\theta = 0 \\implies \\cos\\theta = 1$。这发生在 $\\theta = 2k\\pi$（对于任何整数 $k$）时。\n3.  **双曲型**：$D(\\theta) > 0 \\implies 1 - \\cos\\theta > 0 \\implies \\cos\\theta  1$。这对于所有不是 $2\\pi$ 整数倍的 $\\theta$ 都成立。\n\n基于此分析，我们可以预测每个测试角度的类型：\n- $\\theta_1 = 0.0$：$\\cos(0) = 1$，所以 $D(0) = 0$。类型为**抛物型**。\n- $\\theta_2 = \\pi/4$：$\\cos(\\pi/4) = 1/\\sqrt{2}  1$，所以 $D(\\pi/4) > 0$。类型为**双曲型**。\n- $\\theta_3 = \\pi$：$\\cos(\\pi) = -1  1$，所以 $D(\\pi) > 0$。类型为**双曲型**。\n- $\\theta_4 = 2\\pi - 0.08$：$\\cos(2\\pi - 0.08) = \\cos(0.08)  1$，所以 $D(2\\pi - 0.08) > 0$。类型为**双曲型**。\n- $\\theta_5 = 0.08$：$\\cos(0.08)  1$，所以 $D(0.08) > 0$。类型为**双曲型**。\n\n### 第2部分：通过离散谱进行数值验证\n\n数值验证在单位正方形 $[0, 1) \\times [0, 1)$ 上的一个 $N \\times N$ 周期性网格上使用中心有限差分格式。网格尺寸为 $h = 1/N$。离散傅里叶基函数 $v_{m,n}(x_j, y_k) = e^{i(2\\pi m x_j + 2\\pi n y_k)} = e^{i(2\\pi m j h + 2\\pi n k h)}$ 是此类网格上任何线性、常系数有限差分算子的特征函数。此处，$(x_j, y_k) = (jh, kh)$ 是 $j, k \\in \\{0, 1, \\dots, N-1\\}$ 的网格点，整数波数 $m, n$ 的范围也是从 $0$ 到 $N-1$。\n\n标准二阶中心差分算子的特征值为：\n- 对于 $\\partial_{xx}$：$\\hat{L}_{xx}(m) = \\frac{e^{i 2\\pi m h} - 2 + e^{-i 2\\pi m h}}{h^2} = \\frac{2\\cos(2\\pi m/N) - 2}{(1/N)^2} = N^2(2\\cos(2\\pi m/N) - 2)$。\n- 对于 $\\partial_{yy}$：$\\hat{L}_{yy}(n) = N^2(2\\cos(2\\pi n/N) - 2)$。\n- 对于 $\\partial_{xy}$：$\\hat{L}_{xy}(m, n) = \\frac{(e^{i 2\\pi m h} - e^{-i 2\\pi m h})(e^{i 2\\pi n h} - e^{-i 2\\pi n h})}{(2h)^2} = \\frac{(2i\\sin(2\\pi m/N))(2i\\sin(2\\pi n/N))}{4(1/N)^2} = -N^2 \\sin(2\\pi m/N)\\sin(2\\pi n/N)$。\n\n对应于傅里叶模式 $(m, n)$ 的离散算子 $L_{\\theta,h}$ 的特征值 $\\lambda_{m,n}(\\theta)$ 是各分量算子特征值的线性组合：\n$$\n\\lambda_{m,n}(\\theta) = A \\cdot \\hat{L}_{xx}(m) + 2B \\cdot \\hat{L}_{xy}(m,n) + C \\cdot \\hat{L}_{yy}(n)\n$$\n代入系数 $A, B, C$ 和算子特征值：\n$$\n\\lambda_{m,n}(\\theta) = N^2 \\left[ \\cos\\theta(2\\cos(\\tfrac{2\\pi m}{N}) - 2) - 2\\sin\\theta \\sin(\\tfrac{2\\pi m}{N})\\sin(\\tfrac{2\\pi n}{N}) + (1-\\cos\\theta)(2\\cos(\\tfrac{2\\pi n}{N}) - 2) \\right]\n$$\n我们通过对所有 $m, n \\in \\{0, 1, \\dots, N-1\\}$ 计算此公式来得到 $N^2$ 个特征值的全谱。\n\n然后使用容差 $\\tau = 10^{-12}$ 对所有特征值的集合 $\\{\\lambda_{m,n}\\}$ 进行数值分类：\n- 如果存在特征值 $\\lambda > \\tau$，则令 `has_pos` 为真。\n- 如果存在特征值 $\\lambda  -\\tau$，则令 `has_neg` 为真。\n- 如果存在特征值 $|\\lambda| \\le \\tau$，则令 `has_near_zero` 为真。\n\n规则如下：\n- **类双曲型**：`has_pos` 且 `has_neg`。\n- **类抛物型**：非 (`has_pos` 且 `has_neg`) 且 `has_near_zero`。\n- **类椭圆型**：非 (`has_pos` 且 `has_neg`) 且 非 `has_near_zero`。\n\n对于每个测试角度，我们将生成解析类型字符串（'parabolic'、'hyperbolic'）和数值类型字符串（'parabolic-like'、'hyperbolic-like'、'elliptic-like'）。如果基本名称相同（例如，'parabolic' 匹配 'parabolic-like'），则视为匹配。最终输出将是一个布尔值列表，表示每个角度的匹配情况。根据我们的分析，我们预期对于所有测试用例，数值分类将与解析分类完全一致。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by performing analytical and numerical classification\n    of a second-order linear PDE and comparing the results.\n    \"\"\"\n    \n    # Define the problem parameters from the statement.\n    N = 129\n    tau = 1e-12\n    test_angles = [\n        0.0,\n        np.pi / 4.0,\n        np.pi,\n        2.0 * np.pi - 0.08,\n        0.08,\n    ]\n\n    def get_analytical_type(theta):\n        \"\"\"\n        Classifies the PDE analytically based on the discriminant B^2 - AC.\n        The discriminant for the given operator is 1 - cos(theta).\n        \"\"\"\n        discriminant = 1.0 - np.cos(theta)\n        # Use a small tolerance for floating point comparison to zero\n        if np.isclose(discriminant, 0.0):\n            return \"parabolic\"\n        elif discriminant > 0.0:\n            return \"hyperbolic\"\n        else: # discriminant  0\n            return \"elliptic\"\n\n    def get_numerical_type(theta, N, tau):\n        \"\"\"\n        Classifies the PDE numerically based on the spectrum of the\n        finite difference operator on a periodic grid.\n        \"\"\"\n        # Create 2D grids for wavenumbers m and n\n        m_vals = np.arange(N)\n        n_vals = np.arange(N)\n        m, n = np.meshgrid(m_vals, n_vals, indexing='ij')\n\n        # Angular frequencies for Fourier modes\n        omega_m = 2.0 * np.pi * m / N\n        omega_n = 2.0 * np.pi * n / N\n\n        # Eigenvalues of the discrete operators for u_xx, u_xy, u_yy\n        eig_xx = N**2 * (2.0 * np.cos(omega_m) - 2.0)\n        eig_xy = -N**2 * np.sin(omega_m) * np.sin(omega_n)\n        eig_yy = N**2 * (2.0 * np.cos(omega_n) - 2.0)\n        \n        # Coefficients of the PDE\n        A = np.cos(theta)\n        B = np.sin(theta)\n        C = 1.0 - np.cos(theta)\n\n        # Full spectrum of the discrete operator L_theta\n        eigenvalues = (A * eig_xx + 2.0 * B * eig_xy + C * eig_yy).flatten()\n        \n        # Classify the spectrum based on the problem's rules\n        has_pos = np.any(eigenvalues > tau)\n        has_neg = np.any(eigenvalues  -tau)\n        has_near_zero = np.any(np.abs(eigenvalues) = tau)\n\n        if has_pos and has_neg:\n            return \"hyperbolic-like\"\n        elif has_near_zero:\n            # This branch is taken if not hyperbolic, but has near-zero eigenvalues.\n            # This implies all eigenvalues are of one sign (or zero).\n            return \"parabolic-like\"\n        else:\n            # This branch is taken if not hyperbolic and no near-zero eigenvalues.\n            # This implies all eigenvalues are strictly positive or strictly negative.\n            return \"elliptic-like\"\n\n    results = []\n    for theta in test_angles:\n        analytical_type = get_analytical_type(theta)\n        numerical_type = get_numerical_type(theta, N, tau)\n        \n        # The verification check requires matching the base type\n        # e.g., \"hyperbolic\" should match \"hyperbolic-like\"\n        match = (analytical_type == numerical_type.replace('-like', ''))\n        results.append(match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}