{
    "hands_on_practices": [
        {
            "introduction": "高阶差分格式是求解偏微分方程数值解的关键。这个练习将指导你通过泰勒级数展开，直接推导一个六阶中心差分格式的系数，这也被称为“待定系数法” 。掌握这一基础技能，你将能深刻理解差分格式的构建原理及其截断误差的来源，这是设计和分析新格式的基石。",
            "id": "3403244",
            "problem": "考虑一个光滑函数 $u$，它在包含 $x$ 的开区间上至少有 $7$ 阶连续导数。在偏微分方程 (PDE) 的数值求解中，空间导数通常通过有限差分格式来近似。令 $h>0$ 表示均匀的网格间距，并考虑以下线性离散算子\n$$\nD_h u(x) \\equiv \\frac{1}{h} \\sum_{m \\in \\{-3,-2,-1,1,2,3\\}} c_m\\, u(x + m h),\n$$\n其中 $c_m$ 是待确定的无量纲权重。从 $u(x+mh)$ 关于 $x$ 的泰勒展开出发，在不预先假设任何已知格式的情况下，推导权重 $c_m$，以利用节点 $x\\pm h$、$x\\pm 2h$ 和 $x\\pm 3h$ 得到 $u'(x)$ 的一个六阶精度中心差分近似。显式求解这些权重，并验证该格式通过泰勒展开匹配所能达到的最高阶精度所对应的阶数条件。然后计算由下式定义的截断误差常数 $\\tau$\n$$\nD_h u(x) - u'(x) = \\tau\\, h^{6}\\, u^{(7)}(x) + \\mathcal{O}(h^{8}).\n$$\n按节点 $x-3h$、$x-2h$、$x-1h$、$x+1h$、$x+2h$、$x+3h$ 的顺序报告权重，然后是单个标量 $\\tau$。你的最终答案必须是仅包含这七个量的单个解析表达式。",
            "solution": "该问题要求使用指定的格式推导一阶导数 $u'(x)$ 的六阶精度中心差分近似的权重 $c_m$，并计算主截断误差常数。\n\n离散算子由下式给出\n$$\nD_h u(x) = \\frac{1}{h} \\sum_{m \\in S} c_m u(x + m h),\n$$\n其中格式的索引集合为 $S = \\{-3, -2, -1, 1, 2, 3\\}$。我们试图通过将 $D_h u(x)$ 的泰勒级数展开与 $u'(x)$ 的泰勒级数展开进行匹配来近似 $u'(x)$。\n\n$u(x+mh)$ 关于 $x$ 的泰勒级数展开为\n$$\nu(x+mh) = \\sum_{k=0}^{\\infty} \\frac{(mh)^k}{k!} u^{(k)}(x),\n$$\n其中 $u^{(k)}(x)$ 是 $u$ 在 $x$ 处的 $k$ 阶导数。将其代入算子表达式可得\n$$\nD_h u(x) = \\frac{1}{h} \\sum_{m \\in S} c_m \\left( \\sum_{k=0}^{\\infty} \\frac{(mh)^k}{k!} u^{(k)}(x) \\right).\n$$\n通过交换求和顺序，我们得到\n$$\nD_h u(x) = \\sum_{k=0}^{\\infty} \\left( \\frac{h^{k-1}}{k!} \\sum_{m \\in S} c_m m^k \\right) u^{(k)}(x).\n$$\n展开此和式，我们有\n$$\nD_h u(x) = \\frac{1}{h}\\left(\\sum_m c_m\\right) u(x) + \\left(\\sum_m c_m m\\right) u'(x) + \\frac{h}{2}\\left(\\sum_m c_m m^2\\right) u''(x) + \\frac{h^2}{6}\\left(\\sum_m c_m m^3\\right) u'''(x) + \\dots\n$$\n为使 $D_h u(x)$ 成为 $u'(x)$ 的一个截断误差为 $\\mathcal{O}(h^6)$ 的相容近似，我们必须将 $D_h u(x)$ 展开式中 $u^{(k)}(x)$ 的系数与 $u'(x)$ 展开式中的系数（除了 $u'(x)$ 的系数为 $1$ 外，其余全为零）匹配至尽可能高的阶数。这为六个未知系数 $c_m$ 产生了一个线性方程组：\n\\begin{align*}\n\\sum_{m \\in S} c_m m^0 = 0 \\quad (u(x) \\text{的系数}) \\\\\n\\sum_{m \\in S} c_m m^1 = 1 \\quad (u'(x) \\text{的系数}) \\\\\n\\sum_{m \\in S} c_m m^2 = 0 \\quad (u''(x) \\text{的系数}) \\\\\n\\sum_{m \\in S} c_m m^3 = 0 \\quad (u'''(x) \\text{的系数}) \\\\\n\\sum_{m \\in S} c_m m^4 = 0 \\quad (u^{(4)}(x) \\text{的系数}) \\\\\n\\sum_{m \\in S} c_m m^5 = 0 \\quad (u^{(5)}(x) \\text{的系数})\n\\end{align*}\n这就构成了关于六个未知数 $\\{c_{-3}, c_{-2}, c_{-1}, c_1, c_2, c_3\\}$ 的六个线性方程组。\n\n我们利用格式的对称性来分析该方程组。我们可以根据 $m$ 次方的奇偶性将方程分开。\n对于偶数次幂 $k=0, 2, 4$：\n\\begin{align*}\n(c_1 + c_{-1}) + (c_2 + c_{-2}) + (c_3 + c_{-3}) = 0 \\\\\n(c_1 + c_{-1}) + 4(c_2 + c_{-2}) + 9(c_3 + c_{-3}) = 0 \\\\\n(c_1 + c_{-1}) + 16(c_2 + c_{-2}) + 81(c_3 + c_{-3}) = 0\n\\end{align*}\n令 $S_j = c_j + c_{-j}$，其中 $j=1,2,3$。这是一个关于 $(S_1, S_2, S_3)$ 的齐次线性方程组。其系数矩阵的行列式为\n$$\n\\det \\begin{pmatrix} 1  1  1 \\\\ 1  4  9 \\\\ 1  16  81 \\end{pmatrix} = 1(4 \\cdot 81 - 9 \\cdot 16) - 1(1 \\cdot 81 - 9) + 1(16 - 4) = 180 - 72 + 12 = 120,\n$$\n该行列式不为零。因此，唯一的解是零解：$S_1=S_2=S_3=0$。这意味着 $c_j + c_{-j} = 0$，即 $c_{-j} = -c_j$（对于 $j=1,2,3$）。这确立了系数的反对称性，这是一阶导数中心差分近似的一个典型特征。\n\n对于奇数次幂 $k=1, 3, 5$：\n\\begin{align*}\n(c_1 - c_{-1}) + 2(c_2 - c_{-2}) + 3(c_3 - c_{-3}) = 1 \\\\\n(c_1 - c_{-1}) + 8(c_2 - c_{-2}) + 27(c_3 - c_{-3}) = 0 \\\\\n(c_1 - c_{-1}) + 32(c_2 - c_{-2}) + 243(c_3 - c_{-3}) = 0\n\\end{align*}\n利用反对称性质 $c_{-j} = -c_j$，我们有 $c_j - c_{-j} = 2c_j$。该方程组变为一个关于 $\\{c_1, c_2, c_3\\}$ 的 $3 \\times 3$ 方程组：\n\\begin{align*}\n2c_1 + 4c_2 + 6c_3 = 1 \\\\\n2c_1 + 16c_2 + 54c_3 = 0 \\\\\n2c_1 + 64c_2 + 486c_3 = 0\n\\end{align*}\n用第二个方程减去第一个方程，用第三个方程减去第二个方程：\n\\begin{align*}\n12c_2 + 48c_3 = -1 \\\\\n48c_2 + 432c_3 = 0\n\\end{align*}\n从这两个新方程中的第二个方程，我们得到 $48c_2 = -432c_3$，化简为 $c_2 = -9c_3$。将此代入第一个新方程：\n$$\n12(-9c_3) + 48c_3 = -1 \\implies -108c_3 + 48c_3 = -1 \\implies -60c_3 = -1 \\implies c_3 = \\frac{1}{60}.\n$$\n现在我们求 $c_2$：\n$$\nc_2 = -9c_3 = -9 \\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20}.\n$$\n最后，我们使用 $3 \\times 3$ 方程组的第一个方程来求 $c_1$：\n$$\n2c_1 + 4\\left(-\\frac{3}{20}\\right) + 6\\left(\\frac{1}{60}\\right) = 1 \\implies 2c_1 - \\frac{12}{20} + \\frac{6}{60} = 1 \\implies 2c_1 - \\frac{3}{5} + \\frac{1}{10} = 1.\n$$\n$$\n2c_1 - \\frac{6}{10} + \\frac{1}{10} = 1 \\implies 2c_1 - \\frac{5}{10} = 1 \\implies 2c_1 - \\frac{1}{2} = 1 \\implies 2c_1 = \\frac{3}{2} \\implies c_1 = \\frac{3}{4}.\n$$\n因此，这六个系数是：\n$c_1 = \\frac{3}{4}$，$c_2 = -\\frac{3}{20}$，$c_3 = \\frac{1}{60}$。\n$c_{-1} = -c_1 = -\\frac{3}{4}$，$c_{-2} = -c_2 = \\frac{3}{20}$，$c_{-3} = -c_3 = -\\frac{1}{60}$。\n\n有了这些系数，当 $k=0,2,3,4,5$ 时，和式 $\\sum_m c_m m^k$ 为零，当 $k=1$ 时为 1。截断误差是 $D_h u(x) - u'(x)$ 级数展开中的第一个非零项：\n$$\nD_h u(x) - u'(x) = \\sum_{k=2}^{\\infty} \\left( \\frac{h^{k-1}}{k!} \\sum_{m \\in S} c_m m^k \\right) u^{(k)}(x).\n$$\n在满足了直到 $k=5$ 的方程组之后，第一个可能的非零项对应于 $k=6$：\n$$\n\\frac{h^{5}}{6!} \\left(\\sum_m c_m m^6\\right) u^{(6)}(x).\n$$\n然而，由于反对称性 $c_{-j}=-c_j$，对于任何偶数次幂的 $m$，其和式为零：\n$$\n\\sum_m c_m m^6 = \\sum_{j=1}^3 (c_j j^6 + c_{-j}(-j)^6) = \\sum_{j=1}^3 (c_j j^6 - c_j j^6) = 0.\n$$\n因此，含有 $u^{(6)}(x)$ 的项为零，精度高于 $\\mathcal{O}(h^4)$。该格式至少是 $\\mathcal{O}(h^6)$ 精度的。主误差项是 $u^{(7)}(x)$ 的系数：\n$$\nD_h u(x) - u'(x) = \\frac{h^{6}}{7!} \\left(\\sum_m c_m m^7\\right) u^{(7)}(x) + \\mathcal{O}(h^8).\n$$\n问题将截断误差常数 $\\tau$ 定义为使该主项为 $\\tau h^6 u^{(7)}(x)$。因此，\n$$\n\\tau = \\frac{1}{7!} \\sum_{m \\in S} c_m m^7.\n$$\n对于奇数次幂 $k=7$ 的和式为：\n$$\n\\sum_m c_m m^7 = \\sum_{j=1}^3 (c_j j^7 + c_{-j}(-j)^7) = \\sum_{j=1}^3 (c_j - c_{-j}) j^7 = \\sum_{j=1}^3 2c_j j^7.\n$$\n$$\n\\sum_m c_m m^7 = 2\\left(\\frac{3}{4}\\right)(1)^7 + 2\\left(-\\frac{3}{20}\\right)(2)^7 + 2\\left(\\frac{1}{60}\\right)(3)^7.\n$$\n$$\n\\sum_m c_m m^7 = \\frac{3}{2} - \\frac{3}{10}(128) + \\frac{1}{30}(2187) = \\frac{3}{2} - \\frac{384}{10} + \\frac{2187}{30}.\n$$\n使用公分母 $30$：\n$$\n\\sum_m c_m m^7 = \\frac{45}{30} - \\frac{1152}{30} + \\frac{2187}{30} = \\frac{45 - 1152 + 2187}{30} = \\frac{1080}{30} = 36.\n$$\n现在我们计算 $\\tau$：\n$$\n\\tau = \\frac{1}{7!} (36) = \\frac{36}{5040}.\n$$\n为了化简分数，我们可以将分子和分母同时除以 $36$：\n$$\n\\tau = \\frac{1}{5040/36} = \\frac{1}{140}.\n$$\n所求的七个量是权重 $\\{c_{-3}, c_{-2}, c_{-1}, c_1, c_2, c_3\\}$ 和误差常数 $\\tau$。\n$c_{-3} = -1/60$，$c_{-2} = 3/20$，$c_{-1} = -3/4$，$c_1 = 3/4$，$c_2 = -3/20$，$c_3 = 1/60$，$\\tau = 1/140$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{60}  \\frac{3}{20}  -\\frac{3}{4}  \\frac{3}{4}  -\\frac{3}{20}  \\frac{1}{60}  \\frac{1}{140} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理查森外推法是一种强大的技术，它可以在不从头推导更复杂公式的情况下，提高现有数值近似的精度。本练习将向你展示如何通过组合一个简单的二阶中心差分格式在不同步长下的计算结果，来构造一个四阶精度的近似 。这个过程清晰地揭示了误差对消的核心思想，这是一个在科学计算中具有广泛应用的普适原则。",
            "id": "3403257",
            "problem": "考虑一个光滑函数 $u(x)$，在点 $x$ 的邻域内至少有五阶连续导数，并假设您在一个步长为 $h$ 的均匀网格上，使用一个二阶精度的中心差分格式来近似一阶导数 $u'(x)$，该格式定义为\n$$D(h) \\equiv \\frac{u(x+h) - u(x-h)}{2 h}.$$\n从 $u(x\\pm h)$ 关于 $x$ 的泰勒级数展开出发，推导 $D(h)$ 的主阶截断误差。以这些展开式为基础，通过线性组合近似值 $D(h)$ 和 $D(h/2)$，构造一个理查森外推，将近似精度提升至四阶。具体来说，确定以下拟设中的常数 $q$：\n$$D_{\\mathrm{R}}(h) \\equiv D\\!\\left(\\frac{h}{2}\\right) + q\\left[D\\!\\left(\\frac{h}{2}\\right) - D(h)\\right],$$\n使得 $D_{\\mathrm{R}}(h)$ 达到四阶精度。然后，计算得到的四阶格式的主截断误差项的系数 $C$，其定义为\n$$D_{\\mathrm{R}}(h) = u'(x) + C\\,h^{4}\\,u^{(5)}(x) + \\mathcal{O}\\!\\left(h^{6}\\right).$$\n您必须从第一性原理出发，明确地推导出 $q$ 和 $C$。将您的最终答案表示为一对数 $\\left(q,\\,C\\right)$，使用精确的解析形式，不进行四舍五入，不带单位。",
            "solution": "该问题要求通过理查森外推构造一个关于一阶导数 $u'(x)$ 的四阶近似，并推导其中的常数 $q$ 和主误差系数 $C$。该问题提法恰当，科学上合理，并包含了得到唯一解所需的所有信息。\n\n首先，我们分析二阶中心差分近似 $D(h)$ 的截断误差。我们从写出 $u(x+h)$ 和 $u(x-h)$ 在点 $x$ 附近的泰勒级数展开式开始。函数 $u(x)$ 假设至少有五阶连续导数，这使得我们能够展开到所需的阶数。为了确定与 $h^4$ 成正比的四阶格式的误差项，我们必须在初始展开中保留至少到 $h^5$ 的项。为了完全严谨，我们将展开到 $h^7$ 阶项，以观察后续误差项的结构。\n\n泰勒级数展开式为：\n$$u(x+h) = u(x) + h u'(x) + \\frac{h^2}{2!} u''(x) + \\frac{h^3}{3!} u'''(x) + \\frac{h^4}{4!} u^{(4)}(x) + \\frac{h^5}{5!} u^{(5)}(x) + \\frac{h^6}{6!} u^{(6)}(x) + \\frac{h^7}{7!} u^{(7)}(x) + \\mathcal{O}(h^8)$$\n$$u(x-h) = u(x) - h u'(x) + \\frac{h^2}{2!} u''(x) - \\frac{h^3}{3!} u'''(x) + \\frac{h^4}{4!} u^{(4)}(x) - \\frac{h^5}{5!} u^{(5)}(x) + \\frac{h^6}{6!} u^{(6)}(x) - \\frac{h^7}{7!} u^{(7)}(x) + \\mathcal{O}(h^8)$$\n\n用第一个展开式减去第二个展开式，得到：\n$$u(x+h) - u(x-h) = 2h u'(x) + 2\\frac{h^3}{3!} u'''(x) + 2\\frac{h^5}{5!} u^{(5)}(x) + 2\\frac{h^7}{7!} u^{(7)}(x) + \\mathcal{O}(h^9)$$\n$$u(x+h) - u(x-h) = 2h u'(x) + \\frac{h^3}{3} u'''(x) + \\frac{h^5}{60} u^{(5)}(x) + \\frac{h^7}{2520} u^{(7)}(x) + \\mathcal{O}(h^9)$$\n\n现在，我们将此结果代入中心差分算子 $D(h) \\equiv \\frac{u(x+h) - u(x-h)}{2h}$ 的定义中：\n$$D(h) = \\frac{1}{2h} \\left( 2h u'(x) + \\frac{h^3}{3} u'''(x) + \\frac{h^5}{60} u^{(5)}(x) + \\frac{h^7}{2520} u^{(7)}(x) + \\mathcal{O}(h^9) \\right)$$\n$$D(h) = u'(x) + \\frac{h^2}{6} u'''(x) + \\frac{h^4}{120} u^{(5)}(x) + \\frac{h^6}{5040} u^{(7)}(x) + \\mathcal{O}(h^8)$$\n$D(h)$ 的主阶截断误差是 $\\frac{h^2}{6} u'''(x)$，这证实了 $D(h)$ 是一个二阶精度的近似，即 $D(h) = u'(x) + \\mathcal{O}(h^2)$。\n\n接下来，我们构造理查森外推。我们需要 $D(h/2)$ 的表达式，这可以通过在 $D(h)$ 的展开式中用 $h/2$ 替换 $h$ 得到：\n$$D\\left(\\frac{h}{2}\\right) = u'(x) + \\frac{(h/2)^2}{6} u'''(x) + \\frac{(h/2)^4}{120} u^{(5)}(x) + \\frac{(h/2)^6}{5040} u^{(7)}(x) + \\mathcal{O}(h^8)$$\n$$D\\left(\\frac{h}{2}\\right) = u'(x) + \\frac{h^2}{24} u'''(x) + \\frac{h^4}{1920} u^{(5)}(x) + \\frac{h^6}{322560} u^{(7)}(x) + \\mathcal{O}(h^8)$$\n\n理查森外推公式为 $D_{\\mathrm{R}}(h) \\equiv D(h/2) + q[D(h/2) - D(h)]$。为了应用此公式，我们首先计算差值项：\n$$D\\left(\\frac{h}{2}\\right) - D(h) = \\left( \\frac{h^2}{24} - \\frac{h^2}{6} \\right) u'''(x) + \\left( \\frac{h^4}{1920} - \\frac{h^4}{120} \\right) u^{(5)}(x) + \\mathcal{O}(h^6)$$\n$$D\\left(\\frac{h}{2}\\right) - D(h) = \\left( \\frac{1-4}{24} \\right) h^2 u'''(x) + \\left( \\frac{1-16}{1920} \\right) h^4 u^{(5)}(x) + \\mathcal{O}(h^6)$$\n$$D\\left(\\frac{h}{2}\\right) - D(h) = -\\frac{3}{24} h^2 u'''(x) - \\frac{15}{1920} h^4 u^{(5)}(x) + \\mathcal{O}(h^6)$$\n$$D\\left(\\frac{h}{2}\\right) - D(h) = -\\frac{1}{8} h^2 u'''(x) - \\frac{1}{128} h^4 u^{(5)}(x) + \\mathcal{O}(h^6)$$\n\n现在，将此结果代入 $D_{\\mathrm{R}}(h)$ 的公式中：\n$$D_{\\mathrm{R}}(h) = \\left( u'(x) + \\frac{h^2}{24} u'''(x) + \\frac{h^4}{1920} u^{(5)}(x) \\right) + q \\left( -\\frac{h^2}{8} u'''(x) - \\frac{h^4}{128} u^{(5)}(x) \\right) + \\mathcal{O}(h^6)$$\n合并具有相同 $h$ 次幂的项：\n$$D_{\\mathrm{R}}(h) = u'(x) + \\left( \\frac{1}{24} - \\frac{q}{8} \\right) h^2 u'''(x) + \\left( \\frac{1}{1920} - \\frac{q}{128} \\right) h^4 u^{(5)}(x) + \\mathcal{O}(h^6)$$\n\n为了使 $D_{\\mathrm{R}}(h)$ 达到四阶精度， $h^2$ 项的系数必须为零。\n$$\\frac{1}{24} - \\frac{q}{8} = 0$$\n$$\\frac{q}{8} = \\frac{1}{24}$$\n$$q = \\frac{8}{24} = \\frac{1}{3}$$\n\n当 $q=1/3$ 时，近似达到四阶精度。现在，主截断误差是与 $h^4$ 成正比的项。此项的系数记为 $C$。\n$$C = \\frac{1}{1920} - \\frac{q}{128} = \\frac{1}{1920} - \\frac{1/3}{128} = \\frac{1}{1920} - \\frac{1}{3 \\times 128} = \\frac{1}{1920} - \\frac{1}{384}$$\n为了进行分数相减，我们找到一个公分母，即 $1920$。注意 $1920 = 5 \\times 384$。\n$$C = \\frac{1}{1920} - \\frac{5}{1920} = \\frac{1-5}{1920} = -\\frac{4}{1920}$$\n化简分数得到：\n$$C = -\\frac{1}{480}$$\n因此，四阶精度的近似及其主误差项为：\n$$D_{\\mathrm{R}}(h) = u'(x) - \\frac{1}{480} h^{4} u^{(5)}(x) + \\mathcal{O}(h^{6})$$\n\n所需的值是 $q=1/3$ 和 $C=-1/480$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{3}  -\\frac{1}{480} \\end{pmatrix}}$$"
        },
        {
            "introduction": "作为一项综合性挑战，本练习将引导你探索紧致（或隐式）差分格式，特别是埃尔米特（Hermite）型格式 。这类方法通过求解一个线性系统，在极小的模板宽度上实现非常高的精度，从而在计算上表现出卓越的效率。你将经历从解析推导、数值实现到误差与条件数分析的全过程，这不仅能巩固你对高阶方法的理解，还能提升你解决复杂问题的实践能力。",
            "id": "3403277",
            "problem": "您将为一维周期性网格设计并实现紧致 Hermite 差分格式，以八阶精度逼近二阶导数 $u_{xx}$。为最小化差分格式的带宽，您将同时使用函数值 $u$ 和一阶导数值 $u_x$ 作为未知数。您的起点必须是围绕网格点的泰勒展开和周期性。您必须建立一对耦合线性系统，其未知数是 $u_x$ 和 $u_{xx}$ 的离散近似值，其右侧仅涉及 $u$ 的采样值。您必须研究二阶导数线性系统的条件数。三角函数中的所有角度都必须以弧度为单位。\n\n考虑区间 $[0, 2\\pi)$ 上的一个均匀网格，该网格有 $N$ 个点，网格间距为 $h = \\frac{2\\pi}{N}$，并具有周期性边界条件。在每个网格点 $x_j = j h$ 处，令 $u_j = u(x_j)$，并定义 $u'_j \\approx u_x(x_j)$ 和 $u''_j \\approx u_{xx}(x_j)$。构建两个紧致 Hermite 差分格式：\n\n- 一个用于 $u_x$ 的八阶紧致 Hermite 差分格式，使用对称未知数格式以获得最小带宽：\n$$\nd_0 u'_j + d_1 \\left(u'_{j-1} + u'_{j+1}\\right) + d_2 \\left(u'_{j-2} + u'_{j+2}\\right)\n= \\frac{1}{h}\\left[ e_1 \\left(u_{j+1} - u_{j-1}\\right) + e_2 \\left(u_{j+2} - u_{j-2}\\right) \\right],\n$$\n其中 $d_0 = 1$，系数 $d_1, d_2, e_1, e_2$ 必须通过匹配关于 $x_j$ 的泰勒展开来确定，以使截断误差为 $\\mathcal{O}(h^8)$。\n\n- 一个用于 $u_{xx}$ 的八阶紧致 Hermite 差分格式，同时使用 $u$ 和 $u_x$ 作为未知数以获得最小带宽：\n$$\na_0 u''_j + a_1 \\left(u''_{j-1} + u''_{j+1}\\right) + a_2 \\left(u''_{j-2} + u''_{j+2}\\right)\n= \\frac{1}{h^2}\\left[ b_0 u_j + b_1 \\left(u_{j-1} + u_{j+1}\\right) + b_2 \\left(u_{j-2} + u_{j+2}\\right) \\right]\n+ \\frac{1}{h}\\left[ c_1 \\left(u'_{j+1} - u'_{j-1}\\right) + c_2 \\left(u'_{j+2} - u'_{j-2}\\right) \\right].\n$$\n固定 $a_0 = 1$ 并选择 $a_1 = \\frac{1}{3}$ 和 $a_2 = \\frac{1}{6}$，以确保对于所有网格波数，分母符号为严格正。通过匹配关于 $x_j$ 的泰勒展开来确定 $b_0, b_1, b_2, c_1, c_2$，以使截断误差为 $\\mathcal{O}(h^8)$，并且 $u$ 中的 $\\mathcal{O}(h^{-2})$ 项被抵消。\n\n算法任务：\n\n1. 从 $u(x)$ 及其导数关于 $x_j$ 的泰勒级数出发，通过强制级数系数相等直到保证八阶精度的项，推导出系数 $d_1, d_2, e_1, e_2$ 和 $b_0, b_1, b_2, c_1, c_2$ 的线性系统。除了泰勒展开和周期性所蕴含的级数恒等式外，不要引入任何其他公式。\n\n2. 为每个差分格式的左侧和右侧构建相应的周期性循环矩阵。必须求解一阶导数系统以获得离散的 $u'_j$，然后将其输入到二阶导数系统中以获得 $u''_j$。\n\n3. 使用函数 $u(x) = \\sin(k x)$（其中 $x$ 以弧度为单位）及其精确导数 $u_x(x) = k \\cos(k x)$ 和 $u_{xx}(x) = -k^2 \\sin(k x)$ 来验证该方案。计算二阶导数近似的相对 $\\ell^2$ 误差：\n$$\nE(N, k) = \\frac{\\| q - u_{xx}^{\\text{exact}} \\|_2}{\\| u_{xx}^{\\text{exact}} \\|_2},\n$$\n其中 $q$ 是计算出的 $u''_j$ 向量。\n\n4. 通过计算 $u_{xx}$ 左侧矩阵的二范数条件数来研究其条件性：\n$$\n\\kappa_2(A_2) = \\|A_2\\|_2 \\cdot \\|A_2^{-1}\\|_2.\n$$\n\n测试套件和输出规范：\n\n- 使用以下测试用例生成五个数值结果：\n    - 用例 1：$N = 64$，$k = 2$；返回 $E(64, 2)$，形式为浮点数。\n    - 用例 2：$N = 16$，$k = 2$；返回 $E(16, 2)$，形式为浮点数。\n    - 用例 3：$N = 64$，$k = \\frac{N}{4}$；返回 $E(64, 16)$，形式为浮点数。\n    - 用例 4：$N = 64$；返回 $\\kappa_2(A_2)$，形式为浮点数。\n    - 用例 5：$N = 512$；返回 $\\kappa_2(A_2)$，形式为浮点数。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[r_1,r_2,r_3,r_4,r_5]$）。所有角度必须以弧度为单位，所有数值输出必须是无单位的浮点数。",
            "solution": "### 1. 差分格式系数的推导\n\n本问题的核心是通过匹配泰勒级数展开来确定两个紧致埃尔米特（Hermite）差分格式的系数，以达到八阶精度。函数 $u(x)$ 及其导数 $u^{(n)}(x)$ 在点 $x_j$ 附近的泰勒级数由下式给出：\n$u(x_j \\pm m h) = \\sum_{k=0}^{\\infty} \\frac{(\\pm m h)^k}{k!} u^{(k)}(x_j)$\n$u_x(x_j \\pm m h) = \\sum_{k=0}^{\\infty} \\frac{(\\pm m h)^k}{k!} u^{(k+1)}(x_j)$\n$u_{xx}(x_j \\pm m h) = \\sum_{k=0}^{\\infty} \\frac{(\\pm m h)^k}{k!} u^{(k+2)}(x_j)$\n\n此处，$h$ 是网格间距，$m$ 是一个整数，$u^{(k)}(x_j)$ 是 $u$ 在 $x_j$ 处的 $k$ 阶导数。我们将 $u^{(k)}(x_j)$ 记为 $u_j^{(k)}$。\n\n#### 1.1 一阶导数差分格式 ($u_x$)\n\n一阶导数近似 $u'_j$ 的差分格式为：\n$$\nd_0 u'_j + d_1 (u'_{j-1} + u'_{j+1}) + d_2 (u'_{j-2} + u'_{j+2}) = \\frac{1}{h}\\left[ e_1 (u_{j+1} - u_{j-1}) + e_2 (u_{j+2} - u_{j-2}) \\right]\n$$\n我们用其精确对应项 $u_j^{(1)}$ 和 $u_j$ 替换离散值 $u'_j$ 和 $u_j$，并将所有项在 $x_j$ 附近展开。\n\n左侧 (LHS) 展开式为：\n$LHS = (d_0 + 2d_1 + 2d_2)u_j^{(1)} + h^2(d_1 + 4d_2)u_j^{(3)} + \\frac{h^4}{12}(d_1 + 16d_2)u_j^{(5)} + \\frac{h^6}{360}(d_1 + 64d_2)u_j^{(7)} + \\frac{h^8}{20160}(d_1 + 256d_2)u_j^{(9)} + \\mathcal{O}(h^{10})$\n\n右侧 (RHS) 展开式为：\n$RHS = 2(e_1 + 2e_2)u_j^{(1)} + \\frac{h^2}{3}(e_1 + 8e_2)u_j^{(3)} + \\frac{h^4}{60}(e_1 + 32e_2)u_j^{(5)} + \\frac{h^6}{2520}(e_1 + 128e_2)u_j^{(7)} + \\frac{h^8}{181440}(e_1 + 512e_2)u_j^{(9)} + \\mathcal{O}(h^{10})$\n\n为达到八阶精度，截断误差必须为 $\\mathcal{O}(h^8)$。这要求 LHS 和 RHS 之间 $u_j^{(1)}, u_j^{(3)}, u_j^{(5)}, u_j^{(7)}$ 的系数相匹配。在归一化条件 $d_0=1$ 下，我们得到一个关于 $d_1, d_2, e_1, e_2$ 的四元线性方程组：\n\n1.  $1 + 2d_1 + 2d_2 = 2e_1 + 4e_2$\n2.  $d_1 + 4d_2 = \\frac{1}{3}(e_1 + 8e_2)$\n3.  $\\frac{1}{12}(d_1 + 16d_2) = \\frac{1}{60}(e_1 + 32e_2) \\implies 5(d_1 + 16d_2) = e_1 + 32e_2$\n4.  $\\frac{1}{360}(d_1 + 64d_2) = \\frac{1}{2520}(e_1 + 128e_2) \\implies 7(d_1 + 64d_2) = e_1 + 128e_2$\n\n解此方程组可得唯一的有理数系数：\n$d_1 = \\frac{4}{9}$, $d_2 = \\frac{1}{36}$, $e_1 = \\frac{20}{27}$, $e_2 = \\frac{25}{216}$。\n\n#### 1.2 二阶导数差分格式 ($u_{xx}$)\n\n二阶导数近似 $u''_j$ 的差分格式为：\n$$\na_0 u''_j + a_1 \\left(u''_{j-1} + u''_{j+1}\\right) + a_2 \\left(u''_{j-2} + u''_{j+2}\\right) = \\frac{1}{h^2}\\left[ b_0 u_j + b_1 \\left(u_{j-1} + u_{j+1}\\right) + b_2 \\left(u_{j-2} + u_{j+2}\\right) \\right] + \\frac{1}{h}\\left[ c_1 \\left(u'_{j+1} - u'_{j-1}\\right) + c_2 \\left(u'_{j+2} - u'_{j-2}\\right) \\right]\n$$\n给定 $a_0 = 1, a_1 = \\frac{1}{3}, a_2 = \\frac{1}{6}$。过程是类似的。我们展开算子形式 $A_h u_{xx} - \\frac{1}{h^2}B_h u - \\frac{1}{h}C_h u_x = \\text{截断误差}$，并要求误差为 $\\mathcal{O}(h^8)$。这意味着在除去任何总的前置因子后，展开式中 $k=0, 2, 4, 6, 8$ 时 $u_j^{(k)}$ 的系数必须为零。\n\n$u_j^{(0)}$ 项必须消失，这意味着 $b_0 + 2b_1 + 2b_2 = 0$。令 $u_j^{(2)}, u_j^{(4)}, u_j^{(6)}, u_j^{(8)}$ 的系数相等，可得到关于剩余四个未知数 $b_1, b_2, c_1, c_2$ 的方程组。\n\n1.  $u_j^{(2)}: a_0+2a_1+2a_2 = (b_1+4b_2) + 2(c_1+2c_2) \\implies 2 = b_1+4b_2+2c_1+4c_2$\n2.  $u_j^{(4)}: a_1+4a_2 = \\frac{1}{12}(b_1+16b_2) + \\frac{1}{3}(c_1+8c_2) \\implies 12 = b_1+16b_2+4c_1+32c_2$\n3.  $u_j^{(6)}: \\frac{1}{12}(a_1+16a_2) = \\frac{1}{360}(b_1+64b_2) + \\frac{1}{60}(c_1+32c_2) \\implies 90 = b_1+64b_2+6c_1+192c_2$\n4.  $u_j^{(8)}: \\frac{1}{360}(a_1+64a_2) = \\frac{1}{20160}(b_1+256b_2) + \\frac{1}{2520}(c_1+128c_2) \\implies 616 = b_1+256b_2+8c_1+1024c_2$\n\n解此方程组可得：\n$b_1 = \\frac{16}{27}$, $b_2 = -\\frac{70}{27}$, $c_1 = \\frac{31}{9}$, $c_2 = \\frac{11}{9}$。\n由 $b_0 = -2b_1 - 2b_2$，我们求得 $b_0 = -2(\\frac{16}{27}) - 2(-\\frac{70}{27}) = \\frac{-32+140}{27} = \\frac{108}{27} = 4$。\n\n系数为：\n$a_0=1, a_1=\\frac{1}{3}, a_2=\\frac{1}{6}$\n$b_0=4, b_1=\\frac{16}{27}, b_2=-\\frac{70}{27}, c_1=\\frac{31}{9}, c_2=\\frac{11}{9}$\n\n### 2. 数值实现\n\n在具有 $N$ 个点的周期性网格上，差分格式会产生涉及循环矩阵的线性系统。\n\n#### 2.1 一阶导数系统\n$A_1 \\vec{u}' = \\vec{r}_1$，其中 $\\vec{u}'$ 是未知导数向量 $[u'_0, \\dots, u'_{N-1}]^T$。$A_1$ 是由系数 $d_0, d_1, d_2$ 定义的对称循环矩阵。$A_1$ 的第一行是 $[d_0, d_1, d_2, 0, \\dots, 0, d_2, d_1]$。右侧向量 $\\vec{r}_1$ 是通过将右侧算子应用于函数值向量 $\\vec{u} = [u_0, \\dots, u_{N-1}]^T$ 来计算的：\n$(\\vec{r}_1)_j = \\frac{1}{h} \\left[ e_1(u_{j+1} - u_{j-1}) + e_2(u_{j+2} - u_{j-2}) \\right]$。\n\n#### 2.2 二阶导数系统\n一旦求得 $\\vec{u}'$，我们就可以求解二阶导数 $\\vec{u}''$：$A_2 \\vec{u}'' = \\vec{r}_2$，其中 $A_2$ 是由系数 $a_0, a_1, a_2$ 构成的对称循环矩阵。右侧 $\\vec{r}_2$ 是对 $\\vec{u}$ 和已计算出的 $\\vec{u}'$ 进行运算的组合：\n$(\\vec{r}_2)_j = \\frac{1}{h^2} \\left[ b_0 u_j + b_1(u_{j-1} + u_{j+1}) + b_2(u_{j-2} + u_{j+2}) \\right] + \\frac{1}{h} \\left[ c_1(u'_{j+1} - u'_{j-1}) + c_2(u'_{j+2} - u'_{j-2}) \\right]$。\n这些循环系统可以高效求解，例如使用 `scipy.linalg.solve_circulant`。\n\n### 3. 误差与条件数分析\n\n相对 $\\ell^2$ 误差按规定计算：\n$E(N, k) = \\frac{\\| \\vec{u}_{comp}'' - \\vec{u}_{xx}^{\\text{exact}} \\|_2}{\\| \\vec{u}_{xx}^{\\text{exact}} \\|_2}$。\n\n对称循环矩阵 $A_2$ 的二范数条件数 $\\kappa_2(A_2)$ 是其最大绝对值特征值与最小绝对值特征值之比。对于第一行为 $(c_0, c_1, \\dots, c_{N-1})$ 且 $c_i=c_{N-i}$ 的对称循环矩阵，其特征值由以下实值公式给出：\n$\\lambda_j = c_0 + 2 \\sum_{l=1}^{\\lfloor (N-1)/2 \\rfloor} c_l \\cos\\left(\\frac{2\\pi jl}{N}\\right)$。\n对于矩阵 $A_2$，其特征值为：\n$\\lambda_j = a_0 + 2a_1\\cos\\left(\\frac{2\\pi j}{N}\\right) + 2a_2\\cos\\left(\\frac{4\\pi j}{N}\\right)$，其中 $j = 0, \\dots, N-1$。\n因此条件数为 $\\kappa_2(A_2) = \\frac{\\max_j |\\lambda_j|}{\\min_j |\\lambda_j|}$。鉴于指定的系数，特征值总是正的，因此绝对值是多余的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_circulant\n\ndef solve():\n    \"\"\"\n    Designs and implements 8th-order compact Hermite stencils for the second derivative,\n    validates the scheme, and analyzes its conditioning.\n    \"\"\"\n    \n    # Coefficients for the first derivative stencil (u_x)\n    # d0*u'_j + d1*(u'_{j-1}+u'_{j+1}) + d2*(u'_{j-2}+u'_{j+2}) = 1/h * [e1*(u_{j+1}-u_{j-1}) + e2*(u_{j+2}-u_{j-2})]\n    # d0 is normalized to 1.\n    d0_1 = 1.0\n    d1_1 = 4.0 / 9.0\n    d2_1 = 1.0 / 36.0\n    e1_1 = 20.0 / 27.0\n    e2_1 = 25.0 / 216.0\n\n    # Coefficients for the second derivative stencil (u_xx)\n    # LHS: a0*u''_j + a1*(u''_{j-1}+u''_{j+1}) + a2*(u''_{j-2}+u''_{j+2})\n    # RHS: 1/h^2 * [b0*u_j + b1*(u_{j-1}+u_{j+1}) + b2*(u_{j-2}+u_{j+2})] + 1/h * [c1*(u'_{j+1}-u'_{j-1}) + c2*(u'_{j+2}-u'_{j-2})]\n    # a0, a1, a2 are given.\n    a0_2 = 1.0\n    a1_2 = 1.0 / 3.0\n    a2_2 = 1.0 / 6.0\n    # b_i and c_i are derived.\n    b0_2 = 4.0\n    b1_2 = 16.0 / 27.0\n    b2_2 = -70.0 / 27.0\n    c1_2 = 31.0 / 9.0\n    c2_2 = 11.0 / 9.0\n\n    # Test cases as specified in the problem statement\n    test_cases = [\n        {'type': 'error', 'N': 64, 'k': 2},\n        {'type': 'error', 'N': 16, 'k': 2},\n        {'type': 'error', 'N': 64, 'k': 64 / 4},\n        {'type': 'cond', 'N': 64},\n        {'type': 'cond', 'N': 512}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N = case['N']\n        \n        if case['type'] == 'error':\n            k = float(case['k'])\n            h = 2.0 * np.pi / N\n            x = np.arange(N) * h\n            \n            # Test function and its exact derivatives\n            u = np.sin(k * x)\n            u_xx_exact = -k**2 * np.sin(k * x)\n\n            # --- System 1: Solve for the first derivative u' ---\n            \n            # Build the circulant matrix A1 (as its first row)\n            A1_row = np.zeros(N)\n            A1_row[0] = d0_1\n            A1_row[1] = d1_1\n            A1_row[N-1] = d1_1\n            A1_row[2] = d2_1\n            A1_row[N-2] = d2_1\n\n            # Build the RHS for the u' system\n            u_jp1 = np.roll(u, -1)\n            u_jm1 = np.roll(u, 1)\n            u_jp2 = np.roll(u, -2)\n            u_jm2 = np.roll(u, 2)\n            rhs1 = (e1_1 * (u_jp1 - u_jm1) + e2_1 * (u_jp2 - u_jm2)) / h\n            \n            # Solve the circulant system A1 * u_prime = rhs1\n            u_prime = solve_circulant(A1_row, rhs1)\n            \n            # --- System 2: Solve for the second derivative u'' ---\n            \n            # Build the circulant matrix A2 (as its first row)\n            A2_row = np.zeros(N)\n            A2_row[0] = a0_2\n            A2_row[1] = a1_2\n            A2_row[N-1] = a1_2\n            A2_row[2] = a2_2\n            A2_row[N-2] = a2_2\n            \n            # Build the RHS for the u'' system\n            B2_u_term = b0_2 * u + b1_2 * (u_jm1 + u_jp1) + b2_2 * (u_jm2 + u_jp2)\n            \n            up_jp1 = np.roll(u_prime, -1)\n            up_jm1 = np.roll(u_prime, 1)\n            up_jp2 = np.roll(u_prime, -2)\n            up_jm2 = np.roll(u_prime, 2)\n            C2_up_term = c1_2 * (up_jp1 - up_jm1) + c2_2 * (up_jp2 - up_jm2)\n            \n            rhs2 = B2_u_term / h**2 + C2_up_term / h\n\n            # Solve the circulant system A2 * q = rhs2\n            q = solve_circulant(A2_row, rhs2)\n            \n            # --- Error Calculation ---\n            norm_q_diff = np.linalg.norm(q - u_xx_exact)\n            norm_u_xx_exact = np.linalg.norm(u_xx_exact)\n            \n            if norm_u_xx_exact  1e-15:\n                # Handle cases where the exact solution is zero\n                error = norm_q_diff\n            else:\n                error = norm_q_diff / norm_u_xx_exact\n            \n            results.append(error)\n\n        elif case['type'] == 'cond':\n            # --- Condition Number Calculation ---\n            j = np.arange(N)\n            # Eigenvalues of the circulant matrix A2\n            theta_j = 2.0 * np.pi * j / N\n            eigenvalues = a0_2 + 2.0 * a1_2 * np.cos(theta_j) + 2.0 * a2_2 * np.cos(2.0 * theta_j)\n            \n            # Compute the 2-norm condition number\n            cond_num = np.max(np.abs(eigenvalues)) / np.min(np.abs(eigenvalues))\n            results.append(cond_num)\n\n    # Format and print the final results\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}