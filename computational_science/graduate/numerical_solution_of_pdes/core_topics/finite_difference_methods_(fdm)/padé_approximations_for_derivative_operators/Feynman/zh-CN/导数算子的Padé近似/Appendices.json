{
    "hands_on_practices": [
        {
            "introduction": "掌握任何数值方法的第一步是理解其构造过程。本练习将引导您从泰勒级数这一第一性原理出发，推导一个六阶精度紧致差分格式的系数。通过匹配展开式的各阶导数项，您可以系统性地消除低阶误差，从而实现高阶精度，这是设计和分析有限差分格式的核心技能。",
            "id": "3428918",
            "problem": "考虑在均匀网格 $x_{i} = x_{0} + i h$（网格间距 $h > 0$）上采样一个光滑函数 $f(x)$，并采用周期性边界条件，这是求解偏微分方程（PDE）的数值解法中的标准做法。通过以下隐式格式定义对一阶导数 $f'(x)$ 的一个紧致Padé型三对角近似：\n$$\n\\alpha\\, D_{i-1} + D_{i} + \\alpha\\, D_{i+1} \\;=\\; \\frac{1}{h}\\left[ a\\left(f_{i+1} - f_{i-1}\\right) + b\\left(f_{i+2} - f_{i-2}\\right) \\right],\n$$\n其中 $D_{i}$ 是 $f'(x_{i})$ 的离散近似，而 $\\alpha$、$a$ 和 $b$ 是待确定的网格无关系数。目标是选择 $\\alpha$、$a$ 和 $b$，使得该近似达到六阶精度，即截断误差为 $\\mathcal{O}(h^{6})$。\n\n仅从函数 $f(x)$ 在 $x_{i}$ 点的泰勒级数展开以及周期性网格的离散傅里叶符号的定义出发，推导强制实现六阶精度的条件，并求解与三对角左侧和最多只使用到二阶邻点的右侧相一致的唯一系数 $\\alpha$、$a$ 和 $b$。然后，使用离散傅里叶模 $f_{j} = \\exp(\\mathrm{i} k x_{j})$（其中无量纲波数量为 $\\xi = k h$），构建修正波数符号\n$$\n\\kappa(\\xi) \\quad \\text{such that} \\quad D_{j} \\;=\\; \\frac{\\mathrm{i}\\, \\kappa(\\xi)}{h}\\, f_{j},\n$$\n并通过将 $\\kappa(\\xi)$ 在 $\\xi = 0$ 附近进行泰勒级数展开来验证其六阶精度。\n\n将最终的系数 $\\alpha$、$a$、$b$ 和 $c$ 表示为精确有理数形式，其中 $c$ 是乘以 $\\left(f_{i+3} - f_{i-3}\\right)$ 的系数，在此构造中必须设为零。以单行矩阵的形式给出你的最终答案。无需四舍五入，不涉及物理单位。",
            "solution": "首先验证该问题，发现其是数值分析领域中一个适定且科学上合理的问题。它要求推导一个用于一阶导数的六阶紧致有限差分格式的系数。\n\n给定的格式为：\n$$\n\\alpha\\, D_{i-1} + D_{i} + \\alpha\\, D_{i+1} \\;=\\; \\frac{1}{h}\\left[ a\\left(f_{i+1} - f_{i-1}\\right) + b\\left(f_{i+2} - f_{i-2}\\right) \\right]\n$$\n为确定精度阶数，我们分析截断误差，该误差通过将近似值 $D_i$ 替换为精确导数 $f'(x_i)$、将 $f_i$ 替换为精确函数值 $f(x_i)$ 来获得。令 $f_i^{(n)}$ 表示 $f(x)$ 在 $x_i$ 处的 $n$ 阶导数。截断误差 $T_i$ 定义为：\n$$\nT_i = \\left( \\alpha\\, f'_{i-1} + f'_{i} + \\alpha\\, f'_{i+1} \\right) - \\frac{1}{h}\\left[ a\\left(f_{i+1} - f_{i-1}\\right) + b\\left(f_{i+2} - f_{i-2}\\right) \\right]\n$$\n我们将每一项在点 $x_i$ 附近进行泰勒级数展开。函数值的展开式为：\n$$\nf_{i\\pm m} = f(x_i \\pm mh) = \\sum_{n=0}^{\\infty} \\frac{(\\pm mh)^n}{n!} f_i^{(n)}\n$$\n这给出了中心差分：\n$$\nf_{i+1} - f_{i-1} = 2hf_i' + \\frac{2h^3}{3!}f_i''' + \\frac{2h^5}{5!}f_i^{(5)} + \\frac{2h^7}{7!}f_i^{(7)} + \\mathcal{O}(h^9)\n$$\n$$\nf_{i+2} - f_{i-2} = 4hf_i' + \\frac{16h^3}{3!}f_i''' + \\frac{64h^5}{5!}f_i^{(5)} + \\frac{256h^7}{7!}f_i^{(7)} + \\mathcal{O}(h^9)\n$$\n当格式算子应用于精确函数时，其右侧（RHS）变为：\n$$\n\\text{RHS} = \\frac{a}{h}\\left(2hf_i' + \\frac{h^3}{3}f_i''' + \\frac{h^5}{60}f_i^{(5)} + \\frac{h^7}{2520}f_i^{(7)}\\right) + \\frac{b}{h}\\left(4hf_i' + \\frac{8h^3}{3}f_i''' + \\frac{32h^5}{60}f_i^{(5)} + \\frac{128h^7}{2520}f_i^{(7)}\\right) + \\dots\n$$\n$$\n\\text{RHS} = (2a+4b)f_i' + \\left(\\frac{a}{3}+\\frac{8b}{3}\\right)h^2f_i''' + \\left(\\frac{a}{60}+\\frac{32b}{60}\\right)h^4f_i^{(5)} + \\left(\\frac{a}{2520}+\\frac{128b}{2520}\\right)h^6f_i^{(7)} + \\mathcal{O}(h^8)\n$$\n左侧（LHS）的导数项的展开式为：\n$$\nf'_{i\\pm 1} = f'(x_i \\pm h) = f'_i \\pm hf''_i + \\frac{h^2}{2!}f'''_i \\pm \\frac{h^3}{3!}f^{(4)}_i + \\frac{h^4}{4!}f^{(5)}_i \\pm \\frac{h^5}{5!}f^{(6)}_i + \\frac{h^6}{6!}f^{(7)}_i + \\mathcal{O}(h^7)\n$$\nLHS 变为：\n$$\n\\text{LHS} = \\alpha(f'_i - hf''_i + \\frac{h^2}{2}f'''_i - \\dots) + f'_i + \\alpha(f'_i + hf''_i + \\frac{h^2}{2}f'''_i + \\dots)\n$$\n由于该格式是中心格式，所有偶数阶导数项都相互抵消。\n$$\n\\text{LHS} = (1+2\\alpha)f'_i + \\alpha h^2 f'''_i + \\frac{\\alpha h^4}{12}f_i^{(5)} + \\frac{\\alpha h^6}{360}f_i^{(7)} + \\mathcal{O}(h^8)\n$$\n为使截断误差 $T_i = \\text{LHS} - \\text{RHS}$ 为 $\\mathcal{O}(h^6)$，LHS 和 RHS 中 $f'_i$、$h^2 f'''_i$ 和 $h^4 f^{(5)}_i$ 的系数必须匹配。这产生了一个关于 $\\alpha$、$a$ 和 $b$ 的三元线性方程组：\n1. $f'_i$：$1+2\\alpha = 2a+4b$\n2. $h^2 f'''_i$：$\\alpha = \\frac{a}{3} + \\frac{8b}{3} \\implies 3\\alpha = a+8b$\n3. $h^4 f^{(5)}_i$：$\\frac{\\alpha}{12} = \\frac{a}{60} + \\frac{32b}{60} \\implies 5\\alpha = a+32b$\n\n我们求解这个方程组。将方程(3)减去方程(2)：\n$$\n(a+32b) - (a+8b) = 5\\alpha - 3\\alpha \\implies 24b = 2\\alpha \\implies \\alpha = 12b\n$$\n将 $\\alpha=12b$ 代入方程(2)：\n$$\na+8b = 3(12b) = 36b \\implies a = 28b\n$$\n最后，将 $\\alpha=12b$ 和 $a=28b$ 代入方程(1)：\n$$\n1 + 2(12b) = 2(28b) + 4b\n$$\n$$\n1 + 24b = 56b + 4b\n$$\n$$\n1 = 36b \\implies b = \\frac{1}{36}\n$$\n由此，我们求得其他系数：\n$$\na = 28b = \\frac{28}{36} = \\frac{7}{9}\n$$\n$$\n\\alpha = 12b = \\frac{12}{36} = \\frac{1}{3}\n$$\n问题指定右侧的格式最多使用二阶邻点，这意味着项 $(f_{i+3} - f_{i-3})$ 的系数 $c$ 为零。因此，$c=0$。\n这些系数是：$\\alpha = 1/3$、$a = 7/9$、$b = 1/36$ 和 $c=0$。\n\n为了验证精度阶数，我们分析修正波数 $\\kappa(\\xi)$。我们将傅里叶模 $f_j = \\exp(\\mathrm{i} k x_j)$ 和定义 $D_j = \\frac{\\mathrm{i}}{h}\\kappa(\\xi)f_j$ 代入格式中，其中 $\\xi=kh$ 且 $f_{j \\pm m} = f_j \\exp(\\pm \\mathrm{i} m \\xi)$。\n$$\n\\alpha \\frac{\\mathrm{i}\\kappa}{h}f_{i-1} + \\frac{\\mathrm{i}\\kappa}{h}f_i + \\alpha \\frac{\\mathrm{i}\\kappa}{h}f_{i+1} = \\frac{1}{h}\\left[ a(f_{i+1}-f_{i-1}) + b(f_{i+2}-f_{i-2}) \\right]\n$$\n两边同除以 $f_i/h$ 并代入指数形式，得到：\n$$\n\\mathrm{i}\\kappa \\left( \\alpha \\exp(-\\mathrm{i}\\xi) + 1 + \\alpha \\exp(\\mathrm{i}\\xi) \\right) = a(\\exp(\\mathrm{i}\\xi) - \\exp(-\\mathrm{i}\\xi)) + b(\\exp(2\\mathrm{i}\\xi) - \\exp(-2\\mathrm{i}\\xi))\n$$\n使用欧拉恒等式 $2\\cos(x) = \\exp(\\mathrm{i}x)+\\exp(-\\mathrm{i}x)$ 和 $2\\mathrm{i}\\sin(x) = \\exp(\\mathrm{i}x)-\\exp(-\\mathrm{i}x)$：\n$$\n\\mathrm{i}\\kappa(1+2\\alpha\\cos\\xi) = a(2\\mathrm{i}\\sin\\xi) + b(2\\mathrm{i}\\sin(2\\xi))\n$$\n求解修正波数 $\\kappa(\\xi)$：\n$$\n\\kappa(\\xi) = \\frac{2a\\sin\\xi + 2b\\sin(2\\xi)}{1+2\\alpha\\cos\\xi}\n$$\n精确微分对应于 $\\kappa_{exact}(\\xi) = \\xi$。我们推导出的条件确保了 $\\kappa(\\xi)$ 的泰勒展开式的前几项与 $\\xi$ 匹配。代入我们求得的系数值：$\\alpha=1/3$, $a=7/9$, $b=1/36$。\n- $1+2\\alpha = 5/3$ 且 $2a+4b = 2(7/9)+4(1/36) = 14/9+1/9 = 15/9 = 5/3$。匹配。\n- $3\\alpha = 1$ 且 $a+8b = 7/9+8/36 = 7/9+2/9 = 9/9=1$。匹配。\n- $5\\alpha = 5/3$ 且 $a+32b = 7/9+32/36 = 7/9+8/9=15/9=5/3$。匹配。\n\n这些匹配关系等价于通过泰勒展开匹配 $f'_i$、$f'''_i$ 和 $f^{(5)}_i$ 的系数，确保了 $\\kappa(\\xi) = \\xi + C_7 \\xi^7 + \\mathcal{O}(\\xi^9)$，其中 $C_7$ 是第一个非零误差项的系数。与 $\\kappa(\\xi)=\\xi$ 的偏差首次出现在 $\\xi^7$ 阶。物理空间中的误差为 $\\mathcal{O}(h^6)$，这证实了其六阶精度。\n因此，系数 $\\alpha=1/3$、$a=7/9$、$b=1/36$ 以及隐含的 $c=0$ 是正确的。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{3} \\quad \\frac{7}{9} \\quad \\frac{1}{36} \\quad 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个数值格式的性能优劣，尤其是在求解波传播问题时，取决于它对不同频率波动的模拟能力。本练习将引入色散与耗散误差这两个关键概念，它们通过分析格式的傅里叶符号（或修正波数）来量化其性能。通过计算这些误差，您将学会如何评估一个格式在不同波长下的相位和振幅精度，这是为特定物理问题选择合适数值方法的关键一步。",
            "id": "3428900",
            "problem": "考虑一个间距为 $h > 0$、整数索引为 $j \\in \\mathbb{Z}$ 的均匀、无限、周期性网格。设 $f_j$ 表示一个足够光滑的函数 $f(x)$ 在 $x = j h$ 处的网格采样点。如果一个关于一阶导数的平移不变线性近似满足以下形式的隐式差分关系，则称其为有理的（帕德近似）：\n$$\n\\sum_{\\ell=-L}^{L} a_{\\ell} f^\\prime_{j+\\ell} \\;=\\; \\frac{1}{h}\\sum_{m=-M}^{M} b_m f_{j+m},\n$$\n其中 $a_{\\ell}$ 和 $b_m$ 是实系数，$L, M$ 是有限整数。对于周期性问题，使用基本拟设 $f_j = e^{\\mathrm{i} j \\theta}$ 和无量纲波数 $\\,\\theta = k h\\,$（角度单位：弧度）进行傅里叶分析，通过其符号 $\\widehat{D}(\\theta)$ 来刻画离散导数算子，定义为 $f^\\prime_j \\approx \\widehat{D}(\\theta) f_j$。精确的连续导数对应于符号 $\\mathrm{i} k = (\\mathrm{i}/h)\\theta$。\n\n色散误差和耗散误差是根据离散算子产生的修正波数来定义的：\n- 色散误差是虚部与精确无量纲波数的偏差，由下式给出：\n$$\nE_{\\mathrm{disp}}(\\theta) \\;=\\; \\operatorname{Im}\\!\\big(\\widehat{D}(\\theta)\\,h\\big) \\;-\\; \\theta.\n$$\n- 耗散误差是无量纲符号的实部，由下式给出：\n$$\nE_{\\mathrm{diss}}(\\theta) \\;=\\; \\operatorname{Re}\\!\\big(\\widehat{D}(\\theta)\\,h\\big).\n$$\n\n在本问题中，分析以下用于一阶导数的候选紧致（帕德）格式：\n$$\n\\frac{1}{4} f^\\prime_{j-1} + f^\\prime_j + \\frac{1}{4} f^\\prime_{j+1} \\;=\\; \\frac{3}{4h}\\,\\big(f_{j+1} - f_{j-1}\\big).\n$$\n从傅里叶拟设和上述隐式关系出发，推导离散符号 $\\widehat{D}(\\theta)$，然后在一个均匀的 $\\theta$ 值网格上计算色散和耗散误差。\n\n使用以下测试套件和规格：\n- 使用一个包含 $M=1001$ 个点的均匀网格，覆盖 $\\theta \\in [0,\\pi]$（包含端点），单位为弧度。\n- 计算以下量：\n  1. 一个布尔值，指示 $\\max_{\\theta \\in [0,\\pi]} |E_{\\mathrm{diss}}(\\theta)| < \\varepsilon$ 是否成立，容差为 $\\varepsilon = 10^{-12}$。\n  2. 网格上的最大绝对色散误差 $\\max_{\\theta \\in [0,\\pi]} |E_{\\mathrm{disp}}(\\theta)|$，以浮点数表示。\n  3. 最大绝对色散误差发生处的 $\\theta$ 值（单位为弧度），以浮点数表示。\n  4. $\\theta = \\pi/4$ 处的色散误差，以浮点数表示。\n  5. 网格上耗散误差的 $L^\\infty$ 范数 $\\max_{\\theta \\in [0,\\pi]} |E_{\\mathrm{diss}}(\\theta)|$，以浮点数表示。\n\n您的程序应产生单行输出，其中包含这五个结果，形式为用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”）。不需要物理单位，因为所有量都已通过 $\\theta = k h$ 进行了无量纲化，并且角度单位明确为弧度。",
            "solution": "该问题被评估为有效的，因为它代表了偏微分方程数值分析领域中一个适定的、有科学依据的练习。所有给定的定义、条件和参数都是一致且充分的，足以推导出唯一且有意义的解。\n\n问题的核心是通过推导给定紧致有限差分格式的符号 $\\widehat{D}(\\theta)$，然后分析其相关的色散和耗散误差，来确定其谱特性。\n\n指定的隐式差分格式为：\n$$\n\\frac{1}{4} f^\\prime_{j-1} + f^\\prime_j + \\frac{1}{4} f^\\prime_{j+1} \\;=\\; \\frac{3}{4h}\\,\\big(f_{j+1} - f_{j-1}\\big)\n$$\n\n这必须符合通用的有理近似形式：\n$$\n\\sum_{\\ell=-L}^{L} a_{\\ell} f^\\prime_{j+\\ell} \\;=\\; \\frac{1}{h}\\sum_{m=-M}^{M} b_m f_{j+m}\n$$\n\n通过比较这两种形式，我们可以确定系数 $a_{\\ell}$ 和 $b_m$。左侧（LHS）涉及导数项，给出 $L=1$ 时的 $a_{\\ell}$ 系数：\n$a_{-1} = 1/4$，$a_0 = 1$，以及 $a_1 = 1/4$。\n\n右侧（RHS）涉及函数值，给出 $M=1$ 时的 $b_m$ 系数：\n$b_{-1} = -3/4$，$b_0 = 0$，以及 $b_1 = 3/4$。\n\n为了求出符号 $\\widehat{D}(\\theta)$，我们使用傅里叶拟设 $f_j = e^{\\mathrm{i} j \\theta}$ 和离散算子的定义 $f'_j \\approx \\widehat{D}(\\theta) f_j$。将这些应用于任意网格点 $j+k$ 可得：\n$$\nf_{j+k} = e^{\\mathrm{i} (j+k) \\theta} = f_j e^{\\mathrm{i} k \\theta}\n$$\n$$\nf'_{j+k} \\approx \\widehat{D}(\\theta) f_{j+k} = \\widehat{D}(\\theta) f_j e^{\\mathrm{i} k \\theta}\n$$\n\n将这些表达式代入格式的通用形式，得到：\n$$\n\\sum_{\\ell=-L}^{L} a_{\\ell} \\left( \\widehat{D}(\\theta) f_j e^{\\mathrm{i} \\ell \\theta} \\right) \\;=\\; \\frac{1}{h}\\sum_{m=-M}^{M} b_m \\left( f_j e^{\\mathrm{i} m \\theta} \\right)\n$$\n\n由于 $f_j = e^{\\mathrm{i} j \\theta}$ 不恒为零，我们可以从两侧约去它：\n$$\n\\widehat{D}(\\theta) \\sum_{\\ell=-L}^{L} a_{\\ell} e^{\\mathrm{i} \\ell \\theta} \\;=\\; \\frac{1}{h}\\sum_{m=-M}^{M} b_m e^{\\mathrm{i} m \\theta}\n$$\n\n这使我们能够解出符号 $\\widehat{D}(\\theta)$：\n$$\n\\widehat{D}(\\theta) = \\frac{1}{h} \\frac{\\sum_{m=-M}^{M} b_m e^{\\mathrm{i} m \\theta}}{\\sum_{\\ell=-L}^{L} a_{\\ell} e^{\\mathrm{i} \\ell \\theta}}\n$$\n\n让我们用已确定的系数来计算分子和分母的和。\n分母的和，我们可以称之为 $\\mathcal{A}(\\theta)$，是：\n$$\n\\mathcal{A}(\\theta) = \\sum_{\\ell=-1}^{1} a_{\\ell} e^{\\mathrm{i} \\ell \\theta} = a_{-1}e^{-\\mathrm{i}\\theta} + a_0 + a_1e^{\\mathrm{i}\\theta}\n$$\n$$\n\\mathcal{A}(\\theta) = \\frac{1}{4}e^{-\\mathrm{i}\\theta} + 1 + \\frac{1}{4}e^{\\mathrm{i}\\theta} = 1 + \\frac{1}{4}(e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta})\n$$\n使用欧拉恒等式 $e^{\\mathrm{i}x} + e^{-\\mathrm{i}x} = 2\\cos(x)$，我们得到：\n$$\n\\mathcal{A}(\\theta) = 1 + \\frac{1}{2}\\cos(\\theta)\n$$\n\n分子的和，我们可以称之为 $\\mathcal{B}(\\theta)$，是：\n$$\n\\mathcal{B}(\\theta) = \\sum_{m=-1}^{1} b_m e^{\\mathrm{i} m \\theta} = b_{-1}e^{-\\mathrm{i}\\theta} + b_0 + b_1e^{\\mathrm{i}\\theta}\n$$\n$$\n\\mathcal{B}(\\theta) = -\\frac{3}{4}e^{-\\mathrm{i}\\theta} + 0 + \\frac{3}{4}e^{\\mathrm{i}\\theta} = \\frac{3}{4}(e^{\\mathrm{i}\\theta} - e^{-\\mathrm{i}\\theta})\n$$\n使用欧拉恒等式 $e^{\\mathrm{i}x} - e^{-\\mathrm{i}x} = 2\\mathrm{i}\\sin(x)$，我们得到：\n$$\n\\mathcal{B}(\\theta) = \\frac{3}{4}(2\\mathrm{i}\\sin(\\theta)) = \\frac{3}{2}\\mathrm{i}\\sin(\\theta)\n$$\n\n将 $\\mathcal{A}(\\theta)$ 和 $\\mathcal{B}(\\theta)$ 代回 $\\widehat{D}(\\theta)$ 的表达式中：\n$$\n\\widehat{D}(\\theta) = \\frac{1}{h} \\frac{\\frac{3}{2}\\mathrm{i}\\sin(\\theta)}{1 + \\frac{1}{2}\\cos(\\theta)} = \\frac{\\mathrm{i}}{h} \\frac{3\\sin(\\theta)}{2+\\cos(\\theta)}\n$$\n\n该问题根据无量纲修正波数 $\\widehat{D}(\\theta)h$ 来定义色散和耗散误差：\n$$\n\\widehat{D}(\\theta)h = \\mathrm{i} \\frac{3\\sin(\\theta)}{2+\\cos(\\theta)}\n$$\n\n对于所有使分母不为零的实数 $\\theta$（由于 $\\cos(\\theta) \\ge -1$，分母恒不为零），该表达式是纯虚数。\n\n耗散误差定义为 $E_{\\mathrm{diss}}(\\theta) = \\operatorname{Re}(\\widehat{D}(\\theta)h)$。根据我们推导的表达式：\n$$\nE_{\\mathrm{diss}}(\\theta) = \\operatorname{Re}\\left(\\mathrm{i} \\frac{3\\sin(\\theta)}{2+\\cos(\\theta)}\\right) = 0\n$$\n该格式是完全无耗散的。\n\n色散误差定义为 $E_{\\mathrm{disp}}(\\theta) = \\operatorname{Im}(\\widehat{D}(\\theta)h) - \\theta$。\n$$\nE_{\\mathrm{disp}}(\\theta) = \\operatorname{Im}\\left(\\mathrm{i} \\frac{3\\sin(\\theta)}{2+\\cos(\\theta)}\\right) - \\theta = \\frac{3\\sin(\\theta)}{2+\\cos(\\theta)} - \\theta\n$$\n\n有了这些误差的解析表达式，我们就可以按要求进行数值计算。\n\n1.  **耗散误差阈值的布尔值**：由于对所有 $\\theta$ 都有 $E_{\\mathrm{diss}}(\\theta) = 0$，所以 $\\max_{\\theta \\in [0,\\pi]} |E_{\\mathrm{diss}}(\\theta)| = 0$。给定容差 $\\varepsilon = 10^{-12}$，条件 $0 < 10^{-12}$ 成立。结果为 `True`。\n\n2.  **最大绝对色散误差**：我们需要找到 $\\max_{\\theta \\in [0,\\pi]} |E_{\\mathrm{disp}}(\\theta)|$。让我们分析 $E_{\\mathrm{disp}}(\\theta)$ 的导数：\n    $$\n    \\frac{d}{d\\theta}E_{\\mathrm{disp}}(\\theta) = \\frac{d}{d\\theta}\\left(\\frac{3\\sin(\\theta)}{2+\\cos(\\theta)}\\right) - 1\n    $$\n    分数的导数是 $\\frac{3\\cos(\\theta)(2+\\cos(\\theta)) - 3\\sin(\\theta)(-\\sin(\\theta))}{(2+\\cos(\\theta))^2} = \\frac{6\\cos(\\theta) + 3\\cos^2(\\theta) + 3\\sin^2(\\theta)}{(2+\\cos(\\theta))^2} = \\frac{6\\cos(\\theta)+3}{(2+\\cos(\\theta))^2}$。\n    因此，$\\frac{d}{d\\theta}E_{\\mathrm{disp}}(\\theta) = \\frac{6\\cos(\\theta)+3}{(2+\\cos(\\theta))^2} - 1 = \\frac{6\\cos(\\theta)+3 - (4+4\\cos(\\theta)+\\cos^2(\\theta))}{(2+\\cos(\\theta))^2} = \\frac{-\\cos^2(\\theta)+2\\cos(\\theta)-1}{(2+\\cos(\\theta))^2} = -\\frac{(\\cos(\\theta)-1)^2}{(2+\\cos(\\theta))^2}$。\n    对于所有 $\\theta \\in [0, \\pi]$，该导数小于或等于零，且仅在 $\\theta=0$ 时等于零。这意味着 $E_{\\mathrm{disp}}(\\theta)$ 在区间 $[0, \\pi]$ 上是单调递减函数。\n    端点处的误差为：\n    $E_{\\mathrm{disp}}(0) = \\frac{3\\sin(0)}{2+\\cos(0)} - 0 = 0$。\n    $E_{\\mathrm{disp}}(\\pi) = \\frac{3\\sin(\\pi)}{2+\\cos(\\pi)} - \\pi = \\frac{0}{2-1} - \\pi = -\\pi$。\n    由于该函数是单调的，最大绝对值必定出现在某个端点。我们有 $|E_{\\mathrm{disp}}(0)|=0$ 和 $|E_{\\mathrm{disp}}(\\pi)|=\\pi$。因此，最大绝对色散误差为 $\\pi$。\n\n3.  **最大误差处的 $\\theta$ 值**：根据以上分析，最大绝对误差出现在 $\\theta=\\pi$ 处。\n\n4.  **$\\theta=\\pi/4$ 处的色散误差**：我们直接计算该表达式：\n    $$\n    E_{\\mathrm{disp}}(\\pi/4) = \\frac{3\\sin(\\pi/4)}{2+\\cos(\\pi/4)} - \\frac{\\pi}{4} = \\frac{3(\\sqrt{2}/2)}{2+(\\sqrt{2}/2)} - \\frac{\\pi}{4} = \\frac{3\\sqrt{2}}{4+\\sqrt{2}} - \\frac{\\pi}{4}\n    $$\n\n5.  **耗散误差的 $L^\\infty$ 范数**：即 $\\max_{\\theta \\in [0,\\pi]} |E_{\\mathrm{diss}}(\\theta)|$。如前所述，$E_{\\mathrm{diss}}(\\theta)=0$，所以该值为 $0$。\n\n这些结果将在最终的程序中进行数值计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the dispersion and dissipation errors of a compact finite difference scheme.\n    \"\"\"\n    \n    # 1. Setup the computational grid and constants.\n    M = 1001\n    epsilon = 1e-12\n    # Create a uniform grid for theta from 0 to pi.\n    theta = np.linspace(0, np.pi, M)\n\n    # 2. Define and compute the error functions.\n    # The nondimensional symbol is D_hat * h = i * (3*sin(theta)) / (2+cos(theta)).\n    # The dissipation error is the real part, which is identically zero.\n    # The dispersion error is the imaginary part minus theta.\n    \n    # E_diss(theta) = Re(D_hat * h)\n    e_diss = np.zeros_like(theta)\n    \n    # E_disp(theta) = Im(D_hat * h) - theta\n    # Handle the case theta=0 to avoid potential 0/0 (though not an issue here).\n    # The expression is well-behaved, but it's good practice.\n    numerator = 3 * np.sin(theta)\n    denominator = 2 + np.cos(theta)\n    imaginary_part = np.divide(numerator, denominator, out=np.zeros_like(numerator), where=denominator!=0)\n    e_disp = imaginary_part - theta\n\n    # 3. Compute the five required quantities.\n    \n    # Quantity 1: Boolean indicating if max dissipation error is below a tolerance.\n    # Since e_diss is identically 0, max|e_diss| is 0.\n    l_inf_diss_error = np.max(np.abs(e_diss))\n    is_low_dissipation = l_inf_diss_error  epsilon\n    \n    # Quantity 2: Maximum absolute dispersion error over the grid.\n    max_abs_disp_error = np.max(np.abs(e_disp))\n    \n    # Quantity 3: The value of theta where the max absolute dispersion error occurs.\n    # As shown in the derivation, this occurs at theta = pi.\n    # We can confirm this numerically.\n    max_error_index = np.argmax(np.abs(e_disp))\n    theta_at_max_error = theta[max_error_index]\n    \n    # Quantity 4: The dispersion error at theta = pi/4.\n    # Computed directly for higher accuracy than interpolating from the grid.\n    theta_val = np.pi / 4.0\n    disp_err_at_pi_4 = (3 * np.sin(theta_val)) / (2 + np.cos(theta_val)) - theta_val\n    \n    # Quantity 5: The L-infinity norm of the dissipation error.\n    # This is the same as calculated for Quantity 1.\n    l_inf_diss_error_recomputed = l_inf_diss_error\n\n    # 4. Collate results and print in the specified format.\n    results = [\n        is_low_dissipation,\n        max_abs_disp_error,\n        theta_at_max_error,\n        disp_err_at_pi_4,\n        l_inf_diss_error_recomputed\n    ]\n\n    # Convert all results to strings and join with commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了局部精度和谱特性，离散算子在特定域上的整体代数结构对其在求解偏微分方程中的应用有着深远影响。本练习探讨了周期域上Padé微分算子的零空间，即被算子映射为零的函数集合。理解零空间对于分析守恒律（如平流方程中的均值守恒）和保证椭圆问题（如泊松方程）解的存在性与唯一性至关重要，它揭示了算子矩阵的代数属性与PDE解的定性行为之间的深刻联系。",
            "id": "3428932",
            "problem": "考虑一个长度为 $L$ 的一维周期性区域，它被 $N$ 个等距网格点 $x_{j}=j\\,h$（其中 $h=L/N$）离散化，并具有周期性索引 $u_{j+N}=u_{j}$。令 $E$ 表示平移算子 $(Eu)_{j}=u_{j+1}$。该网格上一阶导数的一个 Padé 近似是一个线性、常系数、循环算子，记为 $D_{x}^{[p/q]}$，可以写成 $E$ 的有理函数形式，\n$$\nD_{x}^{[p/q]}=\\frac{1}{h}\\,\\mathcal{P}(E)\\,\\mathcal{Q}(E)^{-1},\n$$\n其中 $\\mathcal{P}$ 和 $\\mathcal{Q}$ 分别是次数至多为 $p$ 和 $q$ 的实系数多项式。假设以下标准性质成立：\n- 至少一阶相容性：$\\mathcal{P}(1)=0$ 且 $\\mathcal{Q}(1)\\neq 0$。\n- 中心、斜伴随形式：在离散 $\\ell^{2}$ 内积意义下，$D_{x}^{[p/q]}$ 是斜伴随的，这意味着其离散傅里叶符号是纯虚数，并且关于波数是奇函数。\n- 无伪单位圆极点或零点：对于所有 $|z|=1$，有 $\\mathcal{Q}(z)\\neq 0$，并且分子的单位圆零点仅在 $z\\in\\{1,-1\\}$ 处（在 $|z|=1$ 上没有其他零点）。\n\n在全文中，令 $\\{\\varphi_{m}\\}_{m=0}^{N-1}$ 表示离散傅里叶模态 $\\varphi_{m}(j)=\\exp\\!\\big(\\mathrm{i}\\,\\kappa_{m}\\,x_{j}\\big)$，其波数为 $\\kappa_{m}=\\frac{2\\pi m}{L}$。\n\n(a) 利用循环结构和离散傅里叶基，确定作用于具有周期性的网格函数 $\\{u_{j}\\}_{j=0}^{N-1}$ 上的算子 $D_{x}^{[p/q]}$ 的零空间。描述哪些离散傅里叶模态属于该零空间，并解释这如何依赖于 $N$ 的奇偶性。\n\n(b) 考虑在同一周期网格上的线性平流方程 $u_{t}=a\\,u_{x}$，该方程在空间上通过半离散系统 $u_{t}=a\\,D_{x}^{[p/q]}u$ 进行离散化，其中 $a\\in\\mathbb{R}$ 是一个常数平流速度。解释 (a) 部分中确定的零空间如何影响一般初始数据下半离散演化的可解性和唯一性，特别是关于离散平均值的守恒以及任何零空间分量的行为。\n\n(c) 在一个 $N\\times N$ 的二维周期性网格上，其中相同的 Padé 构造在 $x$ 和 $y$ 方向上独立使用，定义离散拉普拉斯算子为\n$$\n\\Delta_{h}=-\\big(D_{x}^{[p/q]}\\big)^{\\top}D_{x}^{[p/q]}-\\big(D_{y}^{[p/q]}\\big)^{\\top}D_{y}^{[p/q]}.\n$$\n阐述离散压力泊松方程 $\\Delta_{h}\\,p=f$ 对右端项的可解性条件，并确定 $\\Delta_{h}$ 零空间的维数（用 $N$ 表示）。给出你的最终答案，形式为一个仅依赖于 $N$ 的闭式表达式。无需进行数值舍入，并且您必须提供最终答案，形式为无单位的单个整数。",
            "solution": "该问题被评估为有效，因为它具有数值分析的科学基础，是适定的，并使用客观、正式的语言。它内容自洽，没有矛盾或歧义。\n\n(a) 为确定算子 $D_{x}^{[p/q]}$ 的零空间，我们分析它在离散傅里叶基向量 $\\varphi_{m}(j)=\\exp(\\mathrm{i}\\,\\kappa_{m}\\,x_{j})$ 上的作用。算子 $D_{x}^{[p/q]}$ 定义在周期性网格上，使其成为一个循环矩阵。任何循环矩阵的特征向量都是离散傅里叶模态。\n\n令 $E$ 为平移算子，$(Eu)_{j}=u_{j+1}$。它对傅里叶模态 $\\varphi_{m}$ 的作用是\n$$\n(E\\varphi_{m})_{j} = \\varphi_{m}(j+1) = \\exp\\left(\\mathrm{i} \\frac{2\\pi m}{L} (j+1)h\\right) = \\exp\\left(\\mathrm{i} \\frac{2\\pi m}{N} (j+1)\\right) = \\exp\\left(\\mathrm{i} \\frac{2\\pi m}{N}\\right) \\varphi_{m}(j) = z_{m} \\varphi_{m}(j)\n$$\n其中 $z_{m} = \\exp(\\mathrm{i} \\frac{2\\pi m}{N})$，对于 $m \\in \\{0, 1, \\dots, N-1\\}$。因此，$E$ 的任何有理函数都对傅里叶基进行对角作用。$D_{x}^{[p/q]}=\\frac{1}{h}\\,\\mathcal{P}(E)\\,\\mathcal{Q}(E)^{-1}$ 的特征值由下式给出\n$$\n\\lambda_{m} = \\frac{1}{h} \\frac{\\mathcal{P}(z_{m})}{\\mathcal{Q}(z_{m})}\n$$\n一个傅里叶模态 $\\varphi_{m}$ 属于 $D_{x}^{[p/q]}$ 的零空间，当且仅当其对应的特征值 $\\lambda_{m}$ 为零。题目指出，对于单位圆上的任意点 $z$（$|z|=1$），$\\mathcal{Q}(z) \\neq 0$。由于对所有 $m$，$z_{m}$ 都位于单位圆上，所以 $\\mathcal{Q}(z_{m}) \\neq 0$。因此，$\\lambda_{m}=0$ 当且仅当 $\\mathcal{P}(z_{m})=0$。\n\n题目指出，多项式 $\\mathcal{P}(z)$ 在单位圆上的零点仅在 $z \\in \\{1, -1\\}$ 处。我们必须找出对于哪些整数 $m \\in \\{0, 1, \\dots, N-1\\}$，$z_{m}$ 的值等于 $1$ 或 $-1$。\n\n情况1：$z_{m} = 1$。\n$z_{m} = \\exp(\\mathrm{i} \\frac{2\\pi m}{N}) = 1$。该条件成立当且仅当 $\\frac{m}{N}$ 是一个整数。在 $m \\in \\{0, 1, \\dots, N-1\\}$ 的范围内，唯一的解是 $m=0$。对应的傅里叶模态 $\\varphi_{0}(j) = \\exp(0) = 1$ 是常数网格函数。这与性质 $\\mathcal{P}(1)=0$ 相一致，该性质意味着 $\\lambda_0 = 0$。\n\n情况2：$z_{m} = -1$。\n$z_{m} = \\exp(\\mathrm{i} \\frac{2\\pi m}{N}) = -1 = \\exp(\\mathrm{i} \\pi)$。这要求对于某个整数 $k$，有 $\\frac{2\\pi m}{N} = \\pi + 2k\\pi$，化简为 $m = N/2 + kN$。为了在范围 $\\{0, 1, \\dots, N-1\\}$ 内存在整数 $m$，$N/2$ 必须是整数，这意味着 $N$ 必须是偶数。\n- 如果 $N$ 是奇数，$N/2$ 不是整数，所以不存在索引 $m$ 使得 $z_{m}=-1$。\n- 如果 $N$ 是偶数，$m=N/2$ 是一个整数，并且它落在所需范围内。对应的傅里叶模态是 $\\varphi_{N/2}(j) = \\exp(\\mathrm{i} \\frac{2\\pi(N/2)j}{N}) = \\exp(\\mathrm{i}\\pi j) = (-1)^j$。这是奈奎斯特频率模态。\n\n总结来说，$D_{x}^{[p/q]}$ 的零空间是：\n- 如果 $N$ 是奇数，零空间是一维的，由常数模态 $\\varphi_{0}$ 张成（即常数网格函数）。\n- 如果 $N$ 是偶数，零空间是二维的，由常数模态 $\\varphi_{0}$ 和奈奎斯特模态 $\\varphi_{N/2}$ 张成。\n\n(b) 半离散系统由常微分方程组 $\\frac{d\\vec{u}}{dt} = a D_{x}^{[p/q]} \\vec{u}$ 给出。我们可以通过将解投影到傅里叶模态基上 $\\vec{u}(t) = \\sum_{m=0}^{N-1} c_{m}(t) \\vec{\\varphi}_{m}$ 来分析解的演化。将此代入方程，得到模态系数 $c_{m}(t)$ 的解耦系统：\n$$\n\\frac{dc_{m}}{dt} = a \\lambda_{m} c_{m}(t)\n$$\n每个系数的解是 $c_{m}(t) = c_{m}(0) \\exp(a \\lambda_{m} t)$，其中 $c_{m}(0)$ 由初始数据确定。\n\n对于 $D_{x}^{[p/q]}$ 零空间中的任何模态 $\\vec{\\varphi}_{m}$，我们有 $\\lambda_{m}=0$。这意味着 $\\frac{dc_{m}}{dt} = 0$，所以对于所有时间 $t$，$c_{m}(t) = c_{m}(0)$。初始数据中位于离散导数算子零空间的任何分量在所有时间内都保持不变。\n\n常数模态的系数 $c_{0}$ 与解的离散平均值 $\\bar{u} = \\frac{1}{N}\\sum_{j=0}^{N-1} u_{j}$ 成正比。由于对于任何 $N$ 都有 $\\lambda_{0}=0$，所以 $c_{0}(t)$ 是守恒的。这意味着解的离散平均值是一个守恒量，这是周期域上连续方程性质 $\\int u(x,t) dx = \\text{const}$ 的一个离散类比。\n\n如果 $N$ 是偶数，奈奎斯特模态 $\\varphi_{N/2}$ 也处于零空间中，因此其系数 $c_{N/2}(t)$ 也是守恒的。这意味着解在网格上以最高可表示频率振荡的分量是静止的。这是中心、斜伴随格式的一个纯粹的数值产物。\n\n半离散初值问题的解的存在性和唯一性没有受到影响。对于任何初始数据，都存在唯一的解。非平凡零空间的存在通过产生守恒量来影响动力学，这些守恒量在物理上可能期望（平均值的守恒是期望的），也可能不期望（奈奎斯特模态的守恒是不期望的）。\n\n(c) 离散拉普拉斯算子是 $\\Delta_{h} = -(D_{x}^{[p/q]})^\\top D_{x}^{[p/q]} - (D_{y}^{[p/q]})^\\top D_{y}^{[p/q]}$。由于 $D_{x}^{[p/q]}$ 和 $D_{y}^{[p/q]}$ 是斜伴随的（即，对于实值函数，$A^\\top = -A$），这可以简化为 $\\Delta_{h} = (D_{x}^{[p/q]})^{2} + (D_{y}^{[p/q]})^{2}$。\n\n$\\Delta_{h}$ 在 $N \\times N$ 网格上的特征向量是二维离散傅里叶模态 $\\varphi_{m,n}(j,k) = \\exp(\\mathrm{i}(\\kappa_{m}x_{j}+\\kappa_{n}y_{k}))$，其中 $m,n \\in \\{0, \\dots, N-1\\}$。令 $\\lambda_{m}^{(x)}$ 和 $\\lambda_{n}^{(y)}$ 分别是 $D_{x}^{[p/q]}$ 和 $D_{y}^{[p/q]}$ 对应于波数索引为 $m$ 和 $n$ 的模态的特征值。$\\Delta_{h}$ 对模态 $\\varphi_{m,n}$ 的特征值是 $\\mu_{m,n} = (\\lambda_{m}^{(x)})^{2} + (\\lambda_{n}^{(y)})^{2}$。\n\n$D_{x}^{[p/q]}$ 是斜伴随的这一性质意味着其特征值 $\\lambda_{m}^{(x)}$ 是纯虚数。令 $\\lambda_{m}^{(x)} = \\mathrm{i} \\omega_{m}$，其中 $\\omega_{m}$ 是实数。那么 $\\mu_{m,n} = (\\mathrm{i}\\omega_{m})^{2} + (\\mathrm{i}\\omega_{n})^{2} = -(\\omega_{m}^{2} + \\omega_{n}^{2})$。\n\n一个模态 $\\varphi_{m,n}$ 在 $\\Delta_{h}$ 的零空间中，如果其特征值 $\\mu_{m,n}$ 为零。这要求 $\\omega_{m}^{2} + \\omega_{n}^{2} = 0$，对于实数 $\\omega_{m}, \\omega_{n}$，这意味着 $\\omega_{m}=0$ 和 $\\omega_{n}=0$。这等价于要求 $\\lambda_{m}^{(x)}=0$ 和 $\\lambda_{n}^{(y)}=0$。\n\n从 (a) 部分可知，使得 $\\lambda_{k}=0$ 的索引 $k$ 的集合是：当 $N$ 为奇数时为 $\\{0\\}$，当 $N$ 为偶数时为 $\\{0, N/2\\}$。$\\Delta_{h}$ 零空间的维数是满足 $m$ 和 $n$ 都从这个零特征值索引集合中抽取的数对 $(m,n)$ 的数量。\n- 如果 $N$ 是奇数，唯一的选择是 $m=0$ 和 $n=0$。存在 $1 \\times 1 = 1$ 个这样的数对。零空间的维数是 $1$。\n- 如果 $N$ 是偶数，选择是 $m \\in \\{0, N/2\\}$ 和 $n \\in \\{0, N/2\\}$。存在 $2 \\times 2 = 4$ 个这样的数对：$(0,0)$、$(0,N/2)$、$(N/2,0)$ 和 $(N/2,N/2)$。零空间的维数是 $4$。\n\n一个依赖于 $N$ 的维数的单一闭式表达式可以被构造出来。一维零模态的数量是 $1$（若 $N$ 为奇数）或 $2$（若 $N$ 为偶数）。这可以写成 $(3+(-1)^N)/2$。二维零空间的维数是这个量的平方。\n$$\n\\text{dim}(\\text{ker}(\\Delta_{h})) = \\left(\\frac{3+(-1)^{N}}{2}\\right)^{2}\n$$\n\n离散泊松方程 $\\Delta_{h} p = f$ 的可解性条件来自 Fredholm 择一性。算子 $\\Delta_{h}$ 是自伴的，因此解存在的充要条件是右端项 $f$ 与 $\\Delta_{h}$ 的零空间正交。这意味着 $f$ 的离散傅里叶系数对于所有对应于零空间模态的波矢对 $(m,n)$ 都必须为零。\n- 如果 $N$ 是奇数，这是单个条件，即 $f$ 的 $(0,0)$ 傅里叶分量为零，即 $\\sum_{j,k} f_{jk} = 0$。\n- 如果 $N$ 是偶数，有四个条件：$f$ 的 $(0,0)$、$(0,N/2)$、$(N/2,0)$ 和 $(N/2,N/2)$ 傅里叶分量必须全部为零。\n\n要求的最终答案是 $\\Delta_{h}$ 零空间的维数。",
            "answer": "$$\\boxed{\\left(\\frac{3+(-1)^{N}}{2}\\right)^{2}}$$"
        }
    ]
}