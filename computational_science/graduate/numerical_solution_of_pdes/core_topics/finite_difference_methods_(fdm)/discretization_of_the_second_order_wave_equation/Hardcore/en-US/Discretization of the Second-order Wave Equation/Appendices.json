{
    "hands_on_practices": [
        {
            "introduction": "Before a numerical scheme can be trusted, its stability must be guaranteed. For explicit time-marching methods, the time step $\\Delta t$ and spatial step $\\Delta x$ are not independent; their relationship is governed by a stability constraint. This first exercise guides you through a rigorous Von Neumann stability analysis—a cornerstone technique in numerical analysis—to derive the famous Courant-Friedrichs-Lewy (CFL) condition for the 1D wave equation from first principles. ",
            "id": "3278584",
            "problem": "Consider the one-dimensional wave equation (a second-order hyperbolic Partial Differential Equation (PDE)) given by $u_{tt} = c^2 u_{xx}$ on a uniform spatial grid with spacing $\\Delta x$ and a uniform time step $\\Delta t$. Suppose an explicit finite difference scheme is constructed by applying second-order central differences in both space and time to approximate $u_{tt}$ and $u_{xx}$ at the grid points $x_j = j \\Delta x$ and $t^n = n \\Delta t$. Assume periodic boundary conditions so that discrete Fourier modes are admissible, and define the nondimensional Courant–Friedrichs–Lewy (CFL) number $\\lambda = \\dfrac{c \\Delta t}{\\Delta x}$.\n\nStarting from the discrete scheme alone and appropriate foundational definitions of stability for linear constant-coefficient schemes, determine the largest admissible value of $\\lambda$ such that the method is stable for all spatial Fourier wavenumbers. Your final answer must be a single real number. No rounding is necessary, and no physical units are required in the final answer.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. The concepts involved—the one-dimensional wave equation, finite difference methods, and Von Neumann stability analysis—are standard and well-defined in the field of numerical analysis. We can thus proceed with the derivation.\n\nThe problem considers the one-dimensional wave equation, a second-order hyperbolic partial differential equation (PDE):\n$$\nu_{tt} = c^2 u_{xx}\n$$\nwhere $u$ is the wave amplitude, $t$ is time, $x$ is the spatial coordinate, and $c$ is the wave speed. The problem specifies a discretization using second-order central differences for both the time and space derivatives. Let $U_j^n$ be the numerical approximation of $u(x_j, t^n)$, where $x_j = j \\Delta x$ and $t^n = n \\Delta t$.\n\nThe second-order central difference approximation for the time derivative $u_{tt}$ at $(x_j, t^n)$ is:\n$$\nu_{tt} \\approx \\frac{U_j^{n+1} - 2U_j^n + U_j^{n-1}}{(\\Delta t)^2}\n$$\nThe second-order central difference approximation for the spatial derivative $u_{xx}$ at $(x_j, t^n)$ is:\n$$\nu_{xx} \\approx \\frac{U_{j+1}^n - 2U_j^n + U_{j-1}^n}{(\\Delta x)^2}\n$$\nSubstituting these approximations into the PDE yields the finite difference equation:\n$$\n\\frac{U_j^{n+1} - 2U_j^n + U_j^{n-1}}{(\\Delta t)^2} = c^2 \\frac{U_{j+1}^n - 2U_j^n + U_{j-1}^n}{(\\Delta x)^2}\n$$\nThis scheme is explicit because we can rearrange it to solve for the solution at the future time level, $U_j^{n+1}$, in terms of solutions at the current and previous time levels, $U^n$ and $U^{n-1}$. Let us introduce the Courant–Friedrichs–Lewy (CFL) number, $\\lambda = \\frac{c \\Delta t}{\\Delta x}$. Rearranging the equation to solve for $U_j^{n+1}$:\n$$\nU_j^{n+1} - 2U_j^n + U_j^{n-1} = \\left( \\frac{c \\Delta t}{\\Delta x} \\right)^2 (U_{j+1}^n - 2U_j^n + U_{j-1}^n)\n$$\n$$\nU_j^{n+1} = 2U_j^n - U_j^{n-1} + \\lambda^2 (U_{j+1}^n - 2U_j^n + U_{j-1}^n)\n$$\nTo analyze the stability of this linear, constant-coefficient scheme with periodic boundary conditions, we employ Von Neumann stability analysis. We assume a solution in the form of a single Fourier mode:\n$$\nU_j^n = G^n e^{i k x_j} = G^n e^{i k j \\Delta x}\n$$\nwhere $k$ is the spatial wavenumber, $i = \\sqrt{-1}$, and $G = G(k)$ is the amplification factor per time step. For the scheme to be stable, the magnitude of the amplification factor must satisfy $|G| \\le 1$ for all wavenumbers $k$. Substituting the Fourier mode into the finite difference scheme:\n$$\nG^{n+1} e^{i k j \\Delta x} = 2G^n e^{i k j \\Delta x} - G^{n-1} e^{i k j \\Delta x} + \\lambda^2 \\left( G^n e^{i k (j+1) \\Delta x} - 2G^n e^{i k j \\Delta x} + G^n e^{i k (j-1) \\Delta x} \\right)\n$$\nDividing by the common non-zero term $G^{n-1} e^{i k j \\Delta x}$ gives the characteristic equation for $G$:\n$$\nG^2 = 2G - 1 + \\lambda^2 G (e^{i k \\Delta x} - 2 + e^{-i k \\Delta x})\n$$\nUsing the identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, with $\\theta = k \\Delta x$, we simplify the expression in the parenthesis:\n$$\nG^2 = 2G - 1 + \\lambda^2 G (2\\cos(k \\Delta x) - 2)\n$$\n$$\nG^2 = 2G - 1 - 2\\lambda^2 G (1 - \\cos(k \\Delta x))\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\nG^2 = 2G - 1 - 4\\lambda^2 G \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nRearranging this into a standard quadratic form, $aG^2+bG+c=0$:\n$$\nG^2 - 2\\left(1 - 2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\\right)G + 1 = 0\n$$\nThe roots of this quadratic equation are given by the formula $G = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\nG = \\left(1 - 2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\\right) \\pm \\sqrt{\\left(1 - 2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2 - 1}\n$$\nFor stability, we require $|G| \\le 1$. The product of the roots is $G_1 G_2 = c/a = 1$. If the roots are real, for stability we must have $|G| \\le 1$, which implies one root must have magnitude greater than or equal to $1$ and the other less than or equal to $1$. Unbounded growth is avoided only if both roots have magnitude exactly $1$. This occurs if the roots are equal to $1$ or $-1$.\nIf the roots are a complex conjugate pair, their product being $1$ implies that their magnitudes are also $1$. The condition for complex roots is that the discriminant of the quadratic equation is negative or zero.\n$$\n\\left(1 - 2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2 - 1 \\le 0\n$$\n$$\n\\left(1 - 2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2 \\le 1\n$$\nTaking the square root of both sides gives:\n$$\n-1 \\le 1 - 2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\nThis single inequality represents two conditions:\n1. $1 - 2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1 \\implies -2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 0$. This is always true since $\\lambda^2 \\ge 0$ and the sine-squared term is non-negative.\n2. $-1 \\le 1 - 2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\implies 2\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 2 \\implies \\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1$.\n\nThis second condition, $\\lambda^2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1$, is the necessary and sufficient condition for stability. It must hold for all possible spatial wavenumbers $k$. To ensure this, we must consider the \"worst case\" scenario, which corresponds to the value of $k$ that maximizes the term $\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)$. The dimensionless wavenumber $\\theta = k \\Delta x$ can range from $-\\pi$ to $\\pi$. The maximum value of $\\sin^2(\\theta/2)$ occurs when $\\theta/2 = \\pm \\pi/2$, which means $\\theta = \\pm \\pi$. This corresponds to the highest frequency mode representable on the grid (the Nyquist frequency). At this frequency:\n$$\n\\max \\left[ \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\pi}{2}\\right) = 1^2 = 1\n$$\nSubstituting this maximum value into the stability condition gives the most restrictive constraint on $\\lambda$:\n$$\n\\lambda^2 \\cdot 1 \\le 1 \\implies \\lambda^2 \\le 1\n$$\nSince the CFL number $\\lambda = \\frac{c \\Delta t}{\\Delta x}$ is defined with positive quantities ($c, \\Delta t, \\Delta x$), $\\lambda$ is non-negative. Therefore, the stability condition simplifies to:\n$$\n0 \\le \\lambda \\le 1\n$$\nThe problem asks for the largest admissible value of $\\lambda$ such that the method is stable. This is the upper bound of the derived interval.\n$$\n\\lambda_{\\max} = 1\n$$",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "A stable scheme prevents solutions from growing unboundedly, but it does not guarantee accuracy. A primary source of error in simulating wave propagation is numerical dispersion, a non-physical phenomenon where the wave speed on the grid depends on its frequency. This hands-on coding exercise challenges you to investigate this effect by exciting the highest possible frequency representable on the grid—a \"malicious\" mode that maximally exposes the scheme's flaws—and directly quantifying the resulting dispersion error. ",
            "id": "3229319",
            "problem": "Consider the one-dimensional linear wave Partial Differential Equation (PDE) $u_{tt} = c^2 u_{xx}$ posed on a periodic interval $[0,L)$, where $u(x,t)$ is twice differentiable in time and space, $c$ is the constant wave speed, and $L$ is the domain length. The numerical task is to investigate the dispersion properties of a standard second-order explicit finite difference method when the initial condition is deliberately chosen to be the highest frequency that can be represented on a given spatial grid.\n\nYou will work with a uniform grid with $N$ points, spatial step $\\Delta x = L/N$, and time step $\\Delta t$. Let the grid points be $x_i = i \\,\\Delta x$ for $i = 0,1,\\dots,N-1$, and time levels $t^n = n \\,\\Delta t$ for integer $n \\ge 0$. Use periodic boundary conditions, meaning indices wrap modulo $N$. The highest representable wavenumber on this grid (the Nyquist mode) is $k_{\\max} = \\pi/\\Delta x$. Define the \"malicious\" initial displacement as $u(x,0) = \\cos(k_{\\max} x)$ and the initial velocity as $u_t(x,0) = 0$. This initial condition maximizes susceptibility to numerical dispersion because it sits at the edge of the discrete spectrum.\n\nImplement a second-order accurate explicit finite difference method that is consistent with $u_{tt} = c^2 u_{xx}$, using central differences in both time and space on the above grid. Use periodic boundary conditions when approximating spatial derivatives. Initialize $u^0$ from $u(x,0)$, and construct $u^1$ using $u_t(x,0)$ and the method’s consistency with the PDE so that the overall scheme remains second-order accurate in time.\n\nFor each simulation, estimate the numerical angular frequency $\\omega_{\\text{num}}$ associated with the Nyquist mode by exploiting the discrete temporal behavior of the mode at a fixed grid point or by correlating the evolving solution $u^n$ with the initial spatial pattern $\\phi_i = \\cos(k_{\\max} x_i)$. Specifically, for an approximately single-mode time series, use the identity for cosine sequences to estimate $\\cos(\\omega_{\\text{num}} \\Delta t)$ from the sequence $\\{u^n\\}$, and average this estimate over multiple time levels to reduce numerical noise. Compute the exact angular frequency $\\omega_{\\text{exact}} = c\\,k_{\\max}$ induced by the continuous PDE for this mode. Define the dispersion error metric as the dimensionless float\n$$\nE = \\left| \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{exact}}} - 1 \\right|.\n$$\n\nAll physical quantities must be treated with appropriate units: choose $L$ in meters, $c$ in meters per second, and $\\Delta t$ in seconds; the angle in trigonometric functions is in radians. The Courant–Friedrichs–Lewy (CFL) condition should be respected for stability; define the Courant number $s = \\frac{c\\,\\Delta t}{\\Delta x}$, which is unitless, and use values with $s \\le 1$.\n\nYour program must:\n- Construct the malicious initial condition using $k_{\\max} = \\pi/\\Delta x$.\n- Advance the solution using a second-order explicit centered finite difference method under periodic boundary conditions.\n- Estimate $\\omega_{\\text{num}}$ from the time series and compute $E$ for each test case.\n- Round each $E$ to $8$ decimal places.\n\nUse the following test suite, which varies the Courant number $s$ to explore dispersion across regimes while holding $L$ and $c$ fixed:\n- Case $1$: $L = 1$ (meters), $c = 1$ (meters per second), $N = 128$, $s = 0.2$, $n_{\\text{steps}} = 200$.\n- Case $2$: $L = 1$ (meters), $c = 1$ (meters per second), $N = 128$, $s = 0.5$, $n_{\\text{steps}} = 200$.\n- Case $3$: $L = 1$ (meters), $c = 1$ (meters per second), $N = 128$, $s = 0.9$, $n_{\\text{steps}} = 200$.\n- Case $4$: $L = 1$ (meters), $c = 1$ (meters per second), $N = 128$, $s = 1.0$, $n_{\\text{steps}} = 200$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the above test cases. For example, the output format must be\n$[E_1,E_2,E_3,E_4]$,\nwhere each $E_j$ is the dispersion error for case $j$, rounded to $8$ decimal places.",
            "solution": "The problem requires an investigation into the numerical dispersion of a standard second-order explicit finite difference method for the one-dimensional linear wave equation, $u_{tt} = c^2 u_{xx}$. The analysis focuses on a specific initial condition, the Nyquist mode, which is the highest frequency mode representable on a discrete grid. This choice maximally exposes the scheme's dispersive errors.\n\nFirst, we define the computational domain and discretization. The spatial domain is a periodic interval $[0,L)$ discretized into $N$ points $x_i = i \\Delta x$ for $i=0, 1, \\dots, N-1$, with a grid spacing of $\\Delta x = L/N$. Time is discretized into levels $t^n = n \\Delta t$, where $\\Delta t$ is the time step. The solution at grid point $x_i$ and time $t^n$ is denoted by $u_i^n \\approx u(x_i, t^n)$.\n\nThe partial differential equation $u_{tt} = c^2 u_{xx}$ is approximated using second-order accurate central finite differences for both the time and space derivatives:\n$$\n\\frac{\\partial^2 u}{\\partial t^2}\\bigg|_{i,n} \\approx \\frac{u_i^{n+1} - 2u_i^n + u_i^{n-1}}{(\\Delta t)^2}\n$$\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{i,n} \\approx \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{(\\Delta x)^2}\n$$\nSubstituting these expressions into the PDE and rearranging yields the explicit time-marching scheme, commonly known as the leapfrog method:\n$$\nu_i^{n+1} = 2u_i^n - u_i^{n-1} + \\left(\\frac{c \\Delta t}{\\Delta x}\\right)^2 (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\nLet $s = \\frac{c \\Delta t}{\\Delta x}$ be the dimensionless Courant number. The scheme can be written as:\n$$\nu_i^{n+1} = 2(1-s^2)u_i^n + s^2(u_{i+1}^n + u_{i-1}^n) - u_i^{n-1}\n$$\nPeriodic boundary conditions are enforced, meaning that indices are taken modulo $N$, such that $u_N^n = u_0^n$ and $u_{-1}^n = u_{N-1}^n$. This scheme is stable for $s \\le 1$.\n\nThe initial conditions are specified as a \"malicious\" mode designed to probe the worst-case dispersion. The initial displacement is $u(x,0) = \\cos(k_{\\max}x)$, where $k_{\\max} = \\pi/\\Delta x$ is the Nyquist wavenumber. On the discrete grid, this becomes:\n$$\nu_i^0 = u(x_i, 0) = \\cos(k_{\\max} x_i) = \\cos\\left(\\frac{\\pi}{\\Delta x} i \\Delta x\\right) = \\cos(i\\pi) = (-1)^i\n$$\nThis initial condition corresponds to a sawtooth or checkerboard pattern, the highest frequency wave that can be represented on the grid. The initial velocity is $u_t(x,0)=0$.\n\nThe leapfrog scheme is a three-level method, requiring data from two previous time steps, $u^n$ and $u^{n-1}$, to compute $u^{n+1}$. To find the solution at the first time step, $u^1$, we must use a different approach that maintains the scheme's second-order accuracy. A Taylor series expansion of $u(x,t)$ around $t=0$ is used:\n$$\nu(x, \\Delta t) = u(x,0) + \\Delta t \\, u_t(x,0) + \\frac{(\\Delta t)^2}{2} u_{tt}(x,0) + O((\\Delta t)^3)\n$$\nUsing the initial condition $u_t(x,0)=0$ and the PDE itself, $u_{tt}(x,0) = c^2 u_{xx}(x,0)$, we get:\n$$\nu(x, \\Delta t) \\approx u(x,0) + \\frac{c^2 (\\Delta t)^2}{2} u_{xx}(x,0)\n$$\nDiscretizing this expression in space gives the formula for $u_i^1$:\n$$\nu_i^1 = u_i^0 + \\frac{s^2}{2} (u_{i+1}^0 - 2u_i^0 + u_{i-1}^0) = (1-s^2)u_i^0 + \\frac{s^2}{2}(u_{i+1}^0 + u_{i-1}^0)\n$$\nWith $u^0$ and $u^1$ established, the main leapfrog loop can proceed for all subsequent time steps.\n\nTo quantify the dispersion error, we must estimate the numerical angular frequency, $\\omega_{\\text{num}}$, and compare it to the exact angular frequency, $\\omega_{\\text{exact}}$. For a wave with wavenumber $k$, the continuous PDE implies a linear dispersion relation $\\omega = c k$. For the Nyquist mode, this gives:\n$$\n\\omega_{\\text{exact}} = c k_{\\max} = \\frac{c \\pi}{\\Delta x}\n$$\nThe numerical solution for the specified initial condition is expected to evolve as $u_i^n \\approx (-1)^i \\cos(\\omega_{\\text{num}} n \\Delta t)$. The time-varying amplitude of this mode, $A_n = \\cos(\\omega_{\\text{num}} n \\Delta t)$, can be isolated by projecting the numerical solution vector $U^n = \\{u_i^n\\}_{i=0}^{N-1}$ onto the initial mode shape vector $\\phi = \\{(-1)^i\\}_{i=0}^{N-1}$:\n$$\nA_n = \\frac{1}{N} \\sum_{i=0}^{N-1} u_i^n \\phi_i\n$$\nThe sequence $\\{A_n\\}$ follows the three-term recurrence relation for cosines: $A_{n+1} + A_{n-1} = 2 A_n \\cos(\\omega_{\\text{num}} \\Delta t)$. We can rearrange this to estimate the cosine of the phase step:\n$$\n\\cos(\\omega_{\\text{num}} \\Delta t) = \\frac{A_{n+1} + A_{n-1}}{2 A_n}\n$$\nBy computing this quantity for each time step $n$ (where $A_n$ is not close to zero) and averaging the results, we obtain a robust estimate, $\\cos_{\\text{est}}$. The numerical angular frequency is then recovered via:\n$$\n\\omega_{\\text{num}} = \\frac{1}{\\Delta t} \\arccos(\\cos_{\\text{est}})\n$$\nFinally, the dispersion error metric $E$ is calculated as the relative difference between the numerical and exact frequencies:\n$$\nE = \\left| \\frac{\\omega_{\\text{num}}}{\\omega_{\\text{exact}}} - 1 \\right|\n$$\nThis procedure is repeated for each given set of parameters to analyze how the dispersion error changes with the Courant number $s$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the wave equation for the Nyquist mode to analyze numerical dispersion.\n    \"\"\"\n    # test_cases: (L, c, N, s, n_steps)\n    test_cases = [\n        (1.0, 1.0, 128, 0.2, 200),\n        (1.0, 1.0, 128, 0.5, 200),\n        (1.0, 1.0, 128, 0.9, 200),\n        (1.0, 1.0, 128, 1.0, 200),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, c, N, s, n_steps = case\n\n        # Grid and simulation parameters\n        dx = L / N\n        dt = s * dx / c\n        \n        # Store solution history\n        u_history = np.zeros((n_steps + 1, N))\n\n        # Initial condition u^0: Nyquist mode u(x,0) = cos(pi*x/dx)\n        # u_i^0 = cos(pi * i*dx / dx) = cos(i*pi) = (-1)^i\n        u_curr = np.array([(-1)**i for i in range(N)], dtype=float)\n        u_history[0, :] = u_curr\n        \n        # First time step u^1, using u_t(x,0) = 0\n        # u_i^1 = (1-s^2)u_i^0 + (s^2/2)(u_{i+1}^0 + u_{i-1}^0)\n        u_prev = np.copy(u_curr) # This will be u^0\n        u_ip1 = np.roll(u_curr, -1)\n        u_im1 = np.roll(u_curr, 1)\n        u_curr = (1 - s**2) * u_curr + (s**2 / 2.0) * (u_ip1 + u_im1)\n        u_history[1, :] = u_curr\n\n        # Main loop (leapfrog scheme)\n        for n in range(1, n_steps):\n            u_ip1 = np.roll(u_curr, -1)\n            u_im1 = np.roll(u_curr, 1)\n            u_next = 2.0 * (1.0 - s**2) * u_curr + s**2 * (u_ip1 + u_im1) - u_prev\n            \n            u_prev = np.copy(u_curr)\n            u_curr = np.copy(u_next)\n            u_history[n + 1, :] = u_curr\n\n        # Post-processing: Estimate numerical frequency\n        # Initial mode shape\n        phi = np.array([(-1)**i for i in range(N)], dtype=float)\n        \n        # Project solution onto the mode shape to get amplitudes A_n\n        # A_n = dot(u_n, phi) / N\n        amplitudes = np.dot(u_history, phi) / N\n\n        cos_estimates = []\n        # Estimate cos(omega_num * dt) from the amplitude recurrence\n        # cos(theta) = (A_{n+1} + A_{n-1}) / (2 * A_n)\n        for n in range(1, n_steps):\n            # Avoid division by zero or small numbers\n            if abs(amplitudes[n]) > 1e-10:\n                cos_est = (amplitudes[n+1] + amplitudes[n-1]) / (2.0 * amplitudes[n])\n                cos_estimates.append(cos_est)\n\n        if not cos_estimates:\n             # Fallback if no valid estimates could be made (highly unlikely)\n             # Use the analytical dispersion relation for the Nyquist mode\n             avg_cos_est = 1.0 - 2.0 * s**2\n        else:\n             avg_cos_est = np.mean(cos_estimates)\n\n        # Clip to handle potential floating-point errors pushing value outside [-1, 1]\n        avg_cos_est = np.clip(avg_cos_est, -1.0, 1.0)\n        \n        omega_num = np.arccos(avg_cos_est) / dt\n\n        # Calculate exact frequency and dispersion error\n        k_max = np.pi / dx\n        omega_exact = c * k_max\n        \n        # Ensure omega_exact is not zero to avoid division errors\n        if abs(omega_exact)  1e-12:\n            dispersion_error = 0.0 if abs(omega_num)  1e-12 else np.inf\n        else:\n            dispersion_error = abs(omega_num / omega_exact - 1.0)\n            \n        results.append(round(dispersion_error, 8))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Simulations are typically performed on finite computational domains, which requires artificial boundary conditions that absorb outgoing waves to mimic an infinite medium. In this final practice, you will analyze a common absorbing boundary condition and uncover a crucial lesson: a condition that is perfectly absorbing in the continuous world can become reflective once discretized. This exercise involves deriving the numerical reflection coefficient to quantify these imperfections, a key skill in assessing the fidelity of wave simulations in bounded domains. ",
            "id": "3381686",
            "problem": "Consider the one-dimensional second-order wave equation for a scalar field $u(x,t)$,\n$$\nu_{tt}(x,t) = c^2\\,u_{xx}(x,t),\n$$\nwhere $c$ is the wave speed expressed in $\\mathrm{m/s}$. Discretize the spatial axis on a uniform grid with spacing $\\Delta x$ expressed in meters and discretize time with step $\\Delta t$ expressed in seconds. Use the standard second-order explicit finite-difference scheme in the interior,\n$$\nu_j^{n+1} = 2\\,u_j^n - u_j^{n-1} + \\lambda^2\\left(u_{j+1}^n - 2\\,u_j^n + u_{j-1}^n\\right),\n$$\nfor $j\\ge 1$, where the Courant number is $\\lambda = \\dfrac{c\\,\\Delta t}{\\Delta x}$. At the left boundary node $j=0$, implement a local absorbing impedance boundary condition as a discrete Robin condition,\n$$\n\\frac{u_0^{n+1} - u_0^{n-1}}{2\\,\\Delta t} - c_b\\,\\frac{u_1^n - u_0^n}{\\Delta x} = 0,\n$$\nwhere $c_b$ is a boundary impedance coefficient to be chosen, and the outward unit normal points to decreasing $x$ so $u_t + c\\,u_n=0$ becomes $u_t - c\\,u_x=0$ in the continuum limit.\n\nAssume monochromatic discrete plane-wave solutions of the form\n$$\nu_j^n = e^{-i\\,\\omega\\,n\\,\\Delta t}\\big(A\\,e^{-i\\,k\\,j\\,\\Delta x} + B\\,e^{i\\,k\\,j\\,\\Delta x}\\big),\n$$\nwith angular frequency $\\omega$ (in radians per second), wavenumber $k$ (in radians per meter), and complex amplitudes $A$ and $B$ representing, respectively, a left-going incident wave and a right-going reflected wave. Derive:\n1. The discrete dispersion relation linking $\\omega$ and $k$ imposed by the interior scheme.\n2. The complex-valued reflection coefficient $R = \\dfrac{B}{A}$ at the boundary in terms of $c_b$, $\\Delta x$, $\\Delta t$, and $k$, for the above discrete Robin boundary condition using the centered temporal and forward spatial differences as written.\n3. The exact impedance matching condition at the grid scale, meaning the value of $c_b$ for which the reflection coefficient is identically zero for a given discrete mode, expressed as a function of $(\\omega, k, \\Delta t, \\Delta x)$.\n\nThen, quantify the reflection induced purely by temporal discretization when $c_b$ is chosen equal to the physical wave speed $c$ in the boundary condition and $\\Delta t$ is close to the Courant–Friedrichs–Lewy (CFL) limit $\\lambda\\approx 1$. Use the derived reflection coefficient to compute its magnitude.\n\nAll angles must be treated in radians. Use the following test suite of parameter values, all with $c=1\\,\\mathrm{m/s}$ and $\\Delta x=1\\,\\mathrm{m}$:\n- Test 1 (happy path): $\\lambda = 0.9$, $k\\,\\Delta x = \\dfrac{\\pi}{3}$.\n- Test 2 (near-CFL): $\\lambda = 0.99$, $k\\,\\Delta x = \\dfrac{\\pi}{3}$.\n- Test 3 (near-CFL, long wavelength): $\\lambda = 0.99$, $k\\,\\Delta x = 0.01$.\n- Test 4 (near-CFL, near-Nyquist): $\\lambda = 0.99$, $k\\,\\Delta x = 0.9\\,\\pi$.\n- Test 5 (sub-CFL): $\\lambda = 0.5$, $k\\,\\Delta x = \\dfrac{\\pi}{3}$.\n\nFor each test case, compute the magnitude of the reflection coefficient $|R|$ when the boundary impedance coefficient is set to the physical wave speed $c_b=c$. Express each $|R|$ as a floating-point number rounded to eight decimal places (dimensionless). Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5]\").",
            "solution": "The user-provided problem is a well-posed and standard exercise in the numerical analysis of partial differential equations, specifically concerning the finite-difference time-domain (FDTD) method for the one-dimensional wave equation. The problem is scientifically sound, self-contained, and objective. We shall proceed with a complete solution.\n\n### Part 1: Discrete Dispersion Relation\n\nThe interior finite-difference scheme for the wave equation $u_{tt} = c^2 u_{xx}$ is given by:\n$$\nu_j^{n+1} = 2u_j^n - u_j^{n-1} + \\lambda^2\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right)\n$$\nwhere $u_j^n \\approx u(j\\Delta x, n\\Delta t)$ and the Courant number is $\\lambda = \\frac{c\\Delta t}{\\Delta x}$.\n\nWe analyze the behavior of discrete plane-wave solutions, which can be represented by a single mode of the form $u_j^n \\propto e^{-i(\\omega n\\Delta t - k j\\Delta x)}$. Substituting this into the numerical scheme, we obtain:\n$$\ne^{-i\\omega(n+1)\\Delta t} e^{ikj\\Delta x} = 2e^{-i\\omega n\\Delta t} e^{ikj\\Delta x} - e^{-i\\omega(n-1)\\Delta t} e^{ikj\\Delta x} + \\lambda^2 \\left( e^{-i\\omega n\\Delta t} e^{ik(j+1)\\Delta x} - 2e^{-i\\omega n\\Delta t} e^{ikj\\Delta x} + e^{-i\\omega n\\Delta t} e^{ik(j-1)\\Delta x} \\right)\n$$\nDividing by the common factor $e^{-i\\omega n\\Delta t} e^{ikj\\Delta x}$:\n$$\ne^{-i\\omega\\Delta t} = 2 - e^{i\\omega\\Delta t} + \\lambda^2 \\left( e^{ik\\Delta x} - 2 + e^{-ik\\Delta x} \\right)\n$$\nRearranging the terms to group the temporal and spatial parts:\n$$\ne^{i\\omega\\Delta t} + e^{-i\\omega\\Delta t} - 2 = \\lambda^2 \\left( e^{ik\\Delta x} + e^{-ik\\Delta x} - 2 \\right)\n$$\nUsing the identity $2\\cos\\theta = e^{i\\theta} + e^{-i\\theta}$, this becomes:\n$$\n2\\cos(\\omega\\Delta t) - 2 = \\lambda^2 (2\\cos(k\\Delta x) - 2)\n$$\nApplying the half-angle identity $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$:\n$$\n-4\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = -2\\lambda^2 \\left( 2\\sin^2\\left(\\frac{k\\Delta x}{2}\\right) \\right)\n$$\n$$\n\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\lambda^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)\n$$\nTaking the principal square root gives the discrete dispersion relation:\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\lambda\\sin\\left(\\frac{k\\Delta x}{2}\\right)\n$$\nThis relation connects the temporal frequency $\\omega$ of a discrete mode to its spatial wavenumber $k$ through the parameters of the numerical grid ($\\Delta x$, $\\Delta t$) and the physical wave speed $c$. Any deviation from the continuum relation $\\omega = ck$ is known as numerical dispersion.\n\n### Part 2: Reflection Coefficient\n\nAt the left boundary $j=0$, a discrete Robin condition is imposed:\n$$\n\\frac{u_0^{n+1} - u_0^{n-1}}{2\\Delta t} - c_b\\frac{u_1^n - u_0^n}{\\Delta x} = 0\n$$\nThe solution is assumed to be a superposition of an incident (left-going, amplitude $A$) and a reflected (right-going, amplitude $B$) wave:\n$$\nu_j^n = e^{-i\\omega n\\Delta t} \\left( A e^{-ikj\\Delta x} + B e^{ikj\\Delta x} \\right)\n$$\nWe evaluate the terms required by the boundary condition:\n$$\nu_0^n = e^{-i\\omega n\\Delta t} (A+B)\n$$\n$$\nu_0^{n+1} = e^{-i\\omega(n+1)\\Delta t} (A+B) = u_0^n e^{-i\\omega\\Delta t}\n$$\n$$\nu_0^{n-1} = e^{-i\\omega(n-1)\\Delta t} (A+B) = u_0^n e^{i\\omega\\Delta t}\n$$\n$$\nu_1^n = e^{-i\\omega n\\Delta t} \\left( A e^{-ik\\Delta x} + B e^{ik\\Delta x} \\right)\n$$\nSubstituting these into the boundary condition and dividing by the common factor $e^{-i\\omega n\\Delta t}$:\n$$\n(A+B)\\frac{e^{-i\\omega\\Delta t} - e^{i\\omega\\Delta t}}{2\\Delta t} - \\frac{c_b}{\\Delta x} \\left[ \\left( A e^{-ik\\Delta x} + B e^{ik\\Delta x} \\right) - (A+B) \\right] = 0\n$$\nUsing the identity $e^{-i\\theta} - e^{i\\theta} = -2i\\sin\\theta$:\n$$\n(A+B) \\frac{-i\\sin(\\omega\\Delta t)}{\\Delta t} - \\frac{c_b}{\\Delta x} \\left[ A(e^{-ik\\Delta x} - 1) + B(e^{ik\\Delta x} - 1) \\right] = 0\n$$\nTo find the reflection coefficient $R = B/A$, we divide by $A$:\n$$\n(1+R) \\frac{-i\\sin(\\omega\\Delta t)}{\\Delta t} = \\frac{c_b}{\\Delta x} \\left[ (e^{-ik\\Delta x} - 1) + R(e^{ik\\Delta x} - 1) \\right]\n$$\nWe rearrange to solve for $R$:\n$$\nR \\left[ \\frac{-i\\sin(\\omega\\Delta t)}{\\Delta t} - \\frac{c_b}{\\Delta x}(e^{ik\\Delta x} - 1) \\right] = \\frac{c_b}{\\Delta x}(e^{-ik\\Delta x} - 1) + \\frac{i\\sin(\\omega\\Delta t)}{\\Delta t}\n$$\nThis gives the reflection coefficient:\n$$\nR = \\frac{\\frac{c_b}{\\Delta x}(e^{-ik\\Delta x} - 1) + \\frac{i\\sin(\\omega\\Delta t)}{\\Delta t}}{-\\frac{i\\sin(\\omega\\Delta t)}{\\Delta t} - \\frac{c_b}{\\Delta x}(e^{ik\\Delta x} - 1)} = - \\frac{\\frac{c_b}{\\Delta x}(e^{-ik\\Delta x} - 1) + \\frac{i\\sin(\\omega\\Delta t)}{\\Delta t}}{\\frac{c_b}{\\Delta x}(e^{ik\\Delta x} - 1) + \\frac{i\\sin(\\omega\\Delta t)}{\\Delta t}}\n$$\n\n### Part 3: Exact Impedance Matching Condition\n\nThe reflection coefficient $R$ is zero if its numerator is zero:\n$$\n\\frac{c_b}{\\Delta x}(e^{-ik\\Delta x} - 1) + \\frac{i\\sin(\\omega\\Delta t)}{\\Delta t} = 0\n$$\nSolving for $c_b$:\n$$\nc_b = - \\frac{i\\sin(\\omega\\Delta t)}{\\Delta t} \\frac{\\Delta x}{e^{-ik\\Delta x} - 1}\n$$\nTo simplify, we use the identities $e^{-i\\theta} - 1 = -2i\\sin(\\theta/2)e^{-i\\theta/2}$ and $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$:\n$$\nc_b = - \\frac{i \\cdot 2\\sin(\\omega\\Delta t/2) \\cos(\\omega\\Delta t/2)}{\\Delta t} \\frac{\\Delta x}{-2i\\sin(k\\Delta x/2) e^{-ik\\Delta x/2}}\n$$\n$$\nc_b = \\frac{\\Delta x}{\\Delta t} \\frac{\\sin(\\omega\\Delta t/2)}{\\sin(k\\Delta x/2)} \\cos(\\omega\\Delta t/2) e^{ik\\Delta x/2}\n$$\nSubstituting the discrete dispersion relation $\\sin(\\omega\\Delta t/2) = \\lambda\\sin(k\\Delta x/2)$:\n$$\nc_b = \\frac{\\Delta x}{\\Delta t} \\lambda \\cos(\\omega\\Delta t/2) e^{ik\\Delta x/2}\n$$\nUsing $\\lambda = c\\Delta t/\\Delta x$:\n$$\nc_b = c \\cos\\left(\\frac{\\omega\\Delta t}{2}\\right) e^{ik\\Delta x/2}\n$$\nThis is the condition on $c_b$ for perfect absorption of the given discrete mode $(k, \\omega)$. Note that for a real-valued boundary operator, $c_b$ must be real. The derived condition shows that $c_b$ is generally complex, implying that this local, first-order boundary condition cannot perfectly absorb waves of all frequencies.\n\n### Part 4: Numerical Computation of Reflection\n\nWe are asked to compute the magnitude of the reflection coefficient $|R|$ when $c_b$ is set to the physical wave speed, $c_b = c$. We use the formula for $R$ from Part 2. For easier computation, we multiply the numerator and denominator by $\\Delta t$:\n$$\nR = - \\frac{\\frac{c\\Delta t}{\\Delta x}(e^{-ik\\Delta x} - 1) + i\\sin(\\omega\\Delta t)}{\\frac{c\\Delta t}{\\Delta x}(e^{ik\\Delta x} - 1) + i\\sin(\\omega\\Delta t)}\n$$\nSubstituting $\\lambda = c\\Delta t/\\Delta x$, we obtain the expression used for computation:\n$$\nR = - \\frac{\\lambda(e^{-ik\\Delta x} - 1) + i\\sin(\\omega\\Delta t)}{\\lambda(e^{ik\\Delta x} - 1) + i\\sin(\\omega\\Delta t)}\n$$\nFor each test case, specified by parameters $(\\lambda, k\\Delta x)$, the computational procedure is:\n1.  Given $\\lambda$ and $\\tilde{k} = k\\Delta x$.\n2.  From the dispersion relation, determine the corresponding discrete frequency term $\\omega\\Delta t$:\n    $$\n    \\omega\\Delta t = 2\\arcsin\\left(\\lambda\\sin\\left(\\frac{\\tilde{k}}{2}\\right)\\right)\n    $$\n3.  Calculate $\\sin(\\omega\\Delta t)$.\n4.  Substitute $\\lambda$, $\\tilde{k}$, and $\\sin(\\omega\\Delta t)$ into the expression for $R$.\n5.  Compute the complex values of the numerator $(N)$ and denominator $(D)$.\n6.  The magnitude of the reflection coefficient is $|R| = |N|/|D|$.\n\nThis procedure is implemented in the provided Python code. The constants $c=1\\,\\mathrm{m/s}$ and $\\Delta x=1\\,\\mathrm{m}$ imply $\\Delta t = \\lambda \\frac{\\Delta x}{c} = \\lambda$ seconds. The computations are performed for the five test cases specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the magnitude of the numerical reflection coefficient for a 1D wave\n    equation with a finite-difference scheme and a discrete impedance boundary\n    condition.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (lambda, k*Delta_x)\n    # c=1 and Delta_x=1 are fixed across all tests.\n    test_cases = [\n        (0.9, np.pi / 3),      # Test 1 (happy path)\n        (0.99, np.pi / 3),     # Test 2 (near-CFL)\n        (0.99, 0.01),          # Test 3 (near-CFL, long wavelength)\n        (0.99, 0.9 * np.pi),   # Test 4 (near-CFL, near-Nyquist)\n        (0.5, np.pi / 3),      # Test 5 (sub-CFL)\n    ]\n\n    results = []\n    \n    for lmbda, k_dx in test_cases:\n        # Step 1: Use the discrete dispersion relation to find omega*Delta_t.\n        # sin(omega*dt/2) = lambda * sin(k*dx/2)\n        # We can assume the argument to arcsin is = 1 because lambda = 1 is the CFL stability condition.\n        sin_omega_dt_half = lmbda * np.sin(k_dx / 2)\n        omega_dt = 2 * np.arcsin(sin_omega_dt_half)\n\n        # Step 2: Calculate sin(omega*dt) which is needed in the reflection coefficient formula.\n        sin_omega_dt = np.sin(omega_dt)\n\n        # Step 3: Define complex exponential terms.\n        exp_ikdx = np.exp(1j * k_dx)\n        exp_neg_ikdx = np.exp(-1j * k_dx) # or 1/exp_ikdx\n        \n        # Step 4: Calculate the numerator and denominator of the reflection coefficient formula.\n        # R = - [lambda*(exp(-i*k*dx) - 1) + i*sin(omega*dt)] / [lambda*(exp(i*k*dx) - 1) + i*sin(omega*dt)]\n        \n        numerator = lmbda * (exp_neg_ikdx - 1) + 1j * sin_omega_dt\n        denominator = lmbda * (exp_ikdx - 1) + 1j * sin_omega_dt\n        \n        # Step 5: Compute the magnitude of the reflection coefficient |R|.\n        # |R| = |-num/den| = |num| / |den|\n        r_magnitude = np.abs(numerator) / np.abs(denominator)\n        \n        # Step 6: Round to eight decimal places and append to results.\n        results.append(f\"{r_magnitude:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}