{
    "hands_on_practices": [
        {
            "introduction": "虽然二阶精度在许多情况下已足够，但高精度的科学计算应用往往要求更高的数值准确性。本练习将向您展示如何扩展泰勒级数分析方法，构建一个用于拉普拉斯算子的四阶精度离散格式，这是许多物理建模中的关键。通过使用一个更大的13点模板，您将建立一个更广泛的约束方程组，不仅消除截断误差中的主导项，也消除更高阶的误差项，从而揭示了在数值离散化中系统性地提升精度的路径。",
            "id": "3452807",
            "problem": "考虑一个二维空间 $(x,y)$ 中间距为 $h>0$ 的均匀笛卡尔网格。令 $u=u(x,y)$ 是一个足够光滑的标量场。您希望在网格点 $(x_i, y_j)$ 处，使用具有以下结构的对称模板，为二维拉普拉斯算子 $\\Delta u = \\partial_{xx}u + \\partial_{yy}u$ 构建一个各向同性的四阶精度有限差分近似：\n- 中心点 $(0,0)$ 的权重为 $w_{0}$。\n- 四个轴向最近邻点 $(\\pm h, 0)$ 和 $(0, \\pm h)$ 的公共权重为 $w_{1}$。\n- 四个对角最近邻点 $(\\pm h, \\pm h)$ 的公共权重为 $w_{2}$。\n- 四个轴向次近邻点 $(\\pm 2h, 0)$ 和 $(0, \\pm 2h)$ 的公共权重为 $w_{3}$。\n\n假设离散算子的形式为\n$$\n(L_{h} u)(0,0) = \\frac{1}{h^{2}}\\Big[w_{0}u(0,0) + w_{1}\\!\\!\\!\\sum_{\\substack{|p|+|q|=1\\\\(p,q)\\in\\mathbb{Z}^{2}}}\\!\\!\\! u(ph,qh) + w_{2}\\!\\!\\!\\sum_{\\substack{|p|=|q|=1\\\\(p,q)\\in\\mathbb{Z}^{2}}}\\!\\!\\! u(ph,qh) + w_{3}\\!\\!\\!\\sum_{\\substack{|p|+|q|=2, pq=0\\\\(p,q)\\in\\mathbb{Z}^{2}}}\\!\\!\\! u(ph,qh)\\Big].\n$$\n使用在 $(0,0)$ 点附近直到并包括总次数为4的双变量泰勒级数展开，施加以下源于偏微分方程和有限差分基本相容性原理的要求：\n1. 该算子能够零化常数和线性多项式，并在二次多项式上再现 $\\Delta u$。特别是，其主阶项必须满足 $L_{h} u = \\Delta u + \\mathcal{O}(h^{2})$。\n2. 为达到四阶精度，截断误差中所有的 $\\mathcal{O}(h^2)$ 项都必须为零。这些 $\\mathcal{O}(h^2)$ 项源于 $u$ 的四阶导数。\n3. 通过强制截断误差中混合四阶导数 $\\partial_{x}^{2}\\partial_{y}^{2}u$ 的系数为零，来消除 $h^{2}$ 阶的混合误差各向异性。\n\n求解由此产生的矩约束，以确定此模板的唯一权重 $(w_{0},w_{1},w_{2},w_{3})$。仅报告中心权重 $w_{0}$ 的精确值作为最终答案。无需数值取整；请以精确形式给出答案，不带单位。",
            "solution": "用户要求为一个特定的有限差分模板确定中心权重 $w_{0}$，该模板以四阶精度近似二维拉普拉斯算子 $\\Delta u = \\partial_{x}^{2} u + \\partial_{y}^{2} u$。该方法涉及将离散算子展开为泰勒级数，并对其系数施加约束。\n\n令离散算子为 $L_{h}u$。该模板涉及整数 $p, q$ 对应的点 $(ph, qh)$。在中心点 $(0,0)$，算子由下式给出：\n$$\n(L_{h} u)(0,0) = \\frac{1}{h^{2}}\\left[w_{0}u(0,0) + w_{1}\\sum_{\\text{axial}} u + w_{2}\\sum_{\\text{diagonal}} u + w_{3}\\sum_{\\text{next-axial}} u\\right]\n$$\n其中求和是对指定的邻点进行的。具体来说，即：\n$$\n(L_{h} u)(0,0) = \\frac{1}{h^{2}} \\Big[ w_{0}u(0,0) + w_{1}\\big(u(h,0) + u(-h,0) + u(0,h) + u(0,-h)\\big) \\\\\n+ w_{2}\\big(u(h,h) + u(-h,h) + u(h,-h) + u(-h,-h)\\big) \\\\\n+ w_{3}\\big(u(2h,0) + u(-2h,0) + u(0,2h) + u(0,-2h)\\big) \\Big]\n$$\n为了找到权重，我们将每一项 $u(x,y)$ 在原点 $(0,0)$ 附近展开为泰勒级数。令 $u_{ij} = \\frac{\\partial^{i+j}u}{\\partial x^i \\partial y^j}\\Big|_{(0,0)}$。展开式为：\n$$\nu(x,y) = \\sum_{k=0}^{\\infty} \\frac{1}{k!} \\left(x \\frac{\\partial}{\\partial x} + y \\frac{\\partial}{\\partial y}\\right)^k u \\Bigg|_{(0,0)}\n$$\n由于模板的对称性，所有 $h$ 的奇数次幂项都将抵消。我们需要展开到六阶导数，以正确识别 $\\mathcal{O}(h^4)$ 的截断误差项。\n\n我们对每个权重组的求和进行展开。\n对于 $w_{1}$：\n$u(h,0) + u(-h,0) = 2u(0,0) + h^2 u_{20} + \\frac{h^4}{12}u_{40} + \\frac{h^6}{360}u_{60} + \\mathcal{O}(h^8)$\n$u(0,h) + u(0,-h) = 2u(0,0) + h^2 u_{02} + \\frac{h^4}{12}u_{04} + \\frac{h^6}{360}u_{06} + \\mathcal{O}(h^8)$\n$w_{1}$ 的求和： $4u_{00} + h^2(u_{20}+u_{02}) + \\frac{h^4}{12}(u_{40}+u_{04}) + \\frac{h^6}{360}(u_{60}+u_{06}) + \\mathcal{O}(h^8)$\n\n对于 $w_{2}$：\n$u(h,h) + u(-h,h) + u(h,-h) + u(-h,-h) = 4u_{00} + 2h^2(u_{20}+u_{02}) + \\frac{h^4}{6}(u_{40}+6u_{22}+u_{04}) + \\frac{h^6}{180}(u_{60}+15u_{42}+15u_{24}+u_{06}) + \\mathcal{O}(h^8)$\n\n对于 $w_{3}$：\n该组与 $w_{1}$ 组相似，只是将 $h$ 替换为 $2h$。\n$u(2h,0) + u(-2h,0) = 2u_{00} + (2h)^2 u_{20} + \\frac{(2h)^4}{12}u_{40} + \\frac{(2h)^6}{360}u_{60} + \\mathcal{O}(h^8)$\n$w_3$ 的求和： $4u_{00} + 4h^2(u_{20}+u_{02}) + \\frac{16h^4}{12}(u_{40}+u_{04}) + \\frac{64h^6}{360}(u_{60}+u_{06}) + \\mathcal{O}(h^8)$\n可简化为 $4u_{00} + 4h^2(u_{20}+u_{02}) + \\frac{4h^4}{3}(u_{40}+u_{04}) + \\frac{8h^6}{45}(u_{60}+u_{06}) + \\mathcal{O}(h^8)$。\n\n现在我们整理 $h^2(L_h u)(0,0)$ 的展开式，按导数项分组。令 $\\Delta u = u_{20}+u_{02}$。\n$h^2 L_h u = u_{00}(w_0 + 4w_1 + 4w_2 + 4w_3) \\\\\n+ h^2 \\Delta u (w_1 + 2w_2 + 4w_3) \\\\\n+ h^4 \\left[ (u_{40}+u_{04})\\left(\\frac{w_1}{12} + \\frac{w_2}{6} + \\frac{4w_3}{3}\\right) + u_{22}\\left(w_2\\right) \\right] \\\\\n+ \\mathcal{O}(h^6)$\n\n现在我们将给定的要求作为对权重 $w_{i}$ 的约束条件施加。\n1.  算子必须与拉普拉斯算子相容。对于 $L_h u = \\Delta u + \\mathcal{O}(h^2)$，我们需要：\n    -   算子零化常数函数，例如 $u(x,y)=1$。这意味着 $u_{00}$ 的系数必须为 $0$。\n        $$ (C_0): w_0 + 4w_1 + 4w_2 + 4w_3 = 0 $$\n    -   在 $h^2 L_h u$ 的展开式中，$h^2 \\Delta u$ 的系数必须为 $1$。\n        $$ (C_1): w_1 + 2w_2 + 4w_3 = 1 $$\n    模板的对称性自动满足了对线性多项式的零化。这两个条件满足要求1。\n\n2.  为达到四阶精度（$L_h u = \\Delta u + \\mathcal{O}(h^4)$），截断误差中的 $\\mathcal{O}(h^2)$ 项必须为零。$\\mathcal{O}(h^2)$ 误差项是 $h^2 L_h u$ 展开式中的 $h^4$ 项除以 $h^2$。\n    $$ E_2 = h^2 \\left[ (u_{40}+u_{04})\\left(\\frac{w_1}{12} + \\frac{w_2}{6} + \\frac{4w_3}{3}\\right) + u_{22}\\left(w_2\\right) \\right] $$\n    为使此项对任何足够光滑的函数 $u$ 都为零，独立导数项 $u_{40}+u_{04}$ 和 $u_{22}$ 的系数必须为零。\n\n3.  要求3提供了使格式在 $h^2$ 阶上各向同性的具体指令：截断误差中混合导数 $\\partial_x^2\\partial_y^2 u = u_{22}$ 的系数必须为零。这直接给出了我们的第三个约束条件。\n    $$ (C_2): w_2 = 0 $$\n\n4.  在 $w_2=0$ 的情况下，要求2（所有 $\\mathcal{O}(h^2)$ 误差项为零）意味着 $(u_{40}+u_{04})$ 的系数也必须为零。\n    $$ (C_3): \\frac{w_1}{12} + \\frac{w_2}{6} + \\frac{4w_3}{3} = 0 $$\n\n我们现在得到了一个关于四个未知数 $(w_0, w_1, w_2, w_3)$ 的四元线性方程组：\n(C0) $w_0 + 4w_1 + 4w_2 + 4w_3 = 0$\n(C1) $w_1 + 2w_2 + 4w_3 = 1$\n(C2) $w_2 = 0$\n(C3) $\\frac{w_1}{12} + \\frac{w_2}{6} + \\frac{4w_3}{3} = 0$\n\n将 $(C_2)$ 代入其他方程：\n(C0') $w_0 + 4w_1 + 4w_3 = 0$\n(C1') $w_1 + 4w_3 = 1$\n(C3') $\\frac{w_1}{12} + \\frac{4w_3}{3} = 0$\n\n将 $(C3')$ 乘以 $12$：\n$w_1 + 16w_3 = 0$\n\n现在我们求解 $w_1$ 和 $w_3$ 的方程组：\n$w_1 + 4w_3 = 1$\n$w_1 + 16w_3 = 0$\n\n用第二个方程减去第一个方程，得到：\n$(w_1 + 16w_3) - (w_1 + 4w_3) = 0-1$\n$12w_3 = -1 \\implies w_3 = -\\frac{1}{12}$\n\n将 $w_3$ 代回 $w_1 + 16w_3 = 0$：\n$w_1 + 16\\left(-\\frac{1}{12}\\right) = 0 \\implies w_1 - \\frac{4}{3} = 0 \\implies w_1 = \\frac{4}{3}$\n\n最后，使用 $(C0')$ 求 $w_0$：\n$w_0 = -4w_1 - 4w_3$\n$w_0 = -4\\left(\\frac{4}{3}\\right) - 4\\left(-\\frac{1}{12}\\right)$\n$w_0 = -\\frac{16}{3} + \\frac{4}{12}$\n$w_0 = -\\frac{16}{3} + \\frac{1}{3}$\n$w_0 = -\\frac{15}{3}$\n$w_0 = -5$\n\n唯一的权重是 $(w_0, w_1, w_2, w_3) = (-5, \\frac{4}{3}, 0, -\\frac{1}{12})$。问题只要求中心权重 $w_0$。",
            "answer": "$$\\boxed{-5}$$"
        },
        {
            "introduction": "泰勒级数展开的威力远不止于规则的笛卡尔网格。在处理复杂几何问题时，现代数值方法（如有限体积法）常依赖于非结构网格，这要求我们能从任意分布的邻近数据点中重构函数的局部行为。本练习将阐释如何以泰勒级数为基础，构建一个局部多项式近似模型，并通过对周围数据点进行最小二乘拟合来确定多项式系数，这些系数正对应于函数在中心点的各阶导数值。这个实践突显了泰勒级数作为一个基本工具，在最通用的情况下进行函数重构的强大能力与灵活性。",
            "id": "3452734",
            "problem": "考虑一个用于非结构化网格上偏微分方程（PDE）有限体积离散化的光滑标量场 $u(x,y)$。在参考点 $(x_0, y_0)=(0,0)$ 处，我们寻求一个基于多元泰勒级数展开的二次多项式重构。从双变量的泰勒级数定义出发，构造一个2次多项式\n$$\np(x,y)=c_{00}+c_{10}x+c_{01}y+c_{20}\\frac{x^{2}}{2}+c_{11}xy+c_{02}\\frac{y^{2}}{2}\n$$\n其中系数 $c_{mn}$ 代表 $u$ 在 $(0,0)$ 处的相应缩放偏导数。\n\n使用加权最小二乘法，将 $p(x,y)$ 拟合到以下八个不规则分布点上的点态数据 $\\{u(x_i, y_i)\\}$（权重均为 $w_i=1$）：\n$$\n(1,0),\\quad (-1,0),\\quad (0,2),\\quad (0,-2),\\quad (1,3),\\quad (-1,3),\\quad (1,-3),\\quad (-1,-3).\n$$\n数据由光滑函数生成\n$$\nu(x,y)=\\exp(x)\\cos(y)+xy\n$$\n其中余弦函数使用弧度制。\n\n任务：\n1. 从多元泰勒级数定义出发，构建加权最小二乘目标函数 $\\sum_{i=1}^{8}w_i\\big(p(x_i, y_i)-u(x_i, y_i)\\big)^{2}$，并推导系数向量 $\\boldsymbol{c}=(c_{00}, c_{10}, c_{01}, c_{20}, c_{11}, c_{02})^{\\top}$ 的正规方程。\n2. 使用给定的点和 $w_i=1$，显式计算正规矩阵 $(A^{\\top}A)$ 和右端项 $(A^{\\top}\\boldsymbol{b})$ 的元素，其中 $A$ 的第 $i$ 行是在点 $(x_i, y_i)$ 处求值的基函数向量，$b_i=u(x_i, y_i)$，并且 $W=\\operatorname{diag}(w_1, \\dots, w_8)$。\n3. 根据得到的显式正规方程，计算混合系数 $c_{11}$。\n\n以单个实数的形式提供 $c_{11}$。无需四舍五入。无需单位。",
            "solution": "问题要求找到二次多项式拟合的系数 $c_{11}$。\n\n**1. 最小二乘问题的构建**\n\n二次多项式由下式给出：\n$$\np(x,y) = c_{00} \\cdot 1 + c_{10} \\cdot x + c_{01} \\cdot y + c_{20} \\cdot \\frac{x^2}{2} + c_{11} \\cdot xy + c_{02} \\cdot \\frac{y^2}{2}\n$$\n这是一个关于系数 $\\boldsymbol{c} = (c_{00}, c_{10}, c_{01}, c_{20}, c_{11}, c_{02})^{\\top}$ 的线性模型。基函数为 $\\{1, x, y, \\frac{x^2}{2}, xy, \\frac{y^2}{2}\\}$。\n\n目标是最小化加权残差平方和：\n$$\nJ(\\boldsymbol{c}) = \\sum_{i=1}^{8} w_i \\left( p(x_i, y_i) - u_i \\right)^2\n$$\n其中 $u_i = u(x_i, y_i)$ 是给定点的数据值。由于所有权重 $w_i=1$，目标函数简化为：\n$$\nJ(\\boldsymbol{c}) = \\sum_{i=1}^{8} \\left( p(x_i, y_i) - u_i \\right)^2\n$$\n这可以写成矩阵形式 $J(\\boldsymbol{c}) = \\|A\\boldsymbol{c} - \\boldsymbol{b}\\|^2$，其中 $\\boldsymbol{b}$ 是数据值向量 $[u_1, u_2, \\dots, u_8]^{\\top}$，$A$ 是一个 $8 \\times 6$ 的设计矩阵，其行是在每个点 $(x_i, y_i)$ 处求值的基函数：\n$$\nA_{i,:} = \\begin{pmatrix} 1  x_i  y_i  \\frac{x_i^2}{2}  x_i y_i  \\frac{y_i^2}{2} \\end{pmatrix}\n$$\n$J(\\boldsymbol{c})$ 的最小值通过将其关于 $\\boldsymbol{c}$ 的梯度设为零来找到，这就得到了正规方程：\n$$\n(A^{\\top}A)\\boldsymbol{c} = A^{\\top}\\boldsymbol{b}\n$$\n\n**2. 推导 $c_{11}$ 的方程**\n\n我们需要求解 $c_{11}$，它是向量 $\\boldsymbol{c}$ 中的第五个系数。正规方程组的第五行是：\n$$\n(A^{\\top}A)_{5,1}c_{00} + (A^{\\top}A)_{5,2}c_{10} + \\dots + (A^{\\top}A)_{5,6}c_{02} = (A^{\\top}\\boldsymbol{b})_5\n$$\n矩阵 $M = A^{\\top}A$ 的元素由 $M_{jk} = \\sum_{i=1}^8 v_j(x_i, y_i) v_k(x_i, y_i)$ 给出，其中 $v_j$ 是第 $j$ 个基函数。对应于 $c_{11}$ 的基函数是 $v_5(x,y) = xy$。让我们计算 $M$ 的第5行中的元素：\n点集 $\\{(x_i, y_i)\\}$ 关于 $x$ 轴和 $y$ 轴都是对称的。这意味着对于任何函数 $f(x,y)$，如果 $x$ 或 $y$ 的幂次为奇数，则在此特定点集上求和 $\\sum_i f(x_i, y_i)$ 将为零。\n\n让我们计算 $v_5$ 与其他基函数的点积：\n$M_{51} = \\sum_i (x_i y_i) \\cdot 1 = 0$ ($x$的幂次是1，$y$的幂次是1)。\n$M_{52} = \\sum_i (x_i y_i) \\cdot x_i = \\sum_i x_i^2 y_i = 0$ ($y$的幂次是1)。\n$M_{53} = \\sum_i (x_i y_i) \\cdot y_i = \\sum_i x_i y_i^2 = 0$ ($x$的幂次是1)。\n$M_{54} = \\sum_i (x_i y_i) \\cdot \\frac{x_i^2}{2} = \\frac{1}{2}\\sum_i x_i^3 y_i = 0$ ($y$的幂次是1)。\n$M_{56} = \\sum_i (x_i y_i) \\cdot \\frac{y_i^2}{2} = \\frac{1}{2}\\sum_i x_i y_i^3 = 0$ ($x$的幂次是1)。\n\n第5行（和列）中唯一的非零元素是对角元素：\n$M_{55} = \\sum_i (x_i y_i)^2 = \\sum_i x_i^2 y_i^2$。\n让我们计算给定点上的这个和：\n$(1,0), (-1,0), (0,2), (0,-2)$: 对于这些点，$x_i y_i = 0$。\n$(1,3)$: $(1 \\cdot 3)^2 = 9$。\n$(-1,3)$: $(-1 \\cdot 3)^2 = 9$。\n$(1,-3)$: $(1 \\cdot -3)^2 = 9$。\n$(-1,-3)$: $(-1 \\cdot -3)^2 = 9$。\n所以，$M_{55} = 0+0+0+0+9+9+9+9 = 36$。\n\n由于这种正交性，正规方程组的第五个方程与其他方程解耦，变为：\n$$\nM_{55} c_{11} = (A^{\\top}\\boldsymbol{b})_5\n$$\n$$\n36 \\, c_{11} = \\sum_{i=1}^8 (x_i y_i) u(x_i, y_i)\n$$\n\n**3. 计算 $c_{11}$**\n\n现在我们计算这个方程的右端项（RHS）。函数是 $u(x,y)=\\exp(x)\\cos(y)+xy$。我们只需要考虑 $x_i y_i \\neq 0$ 的点，即最后四个点：\n-   $i=5: (x_5, y_5) = (1,3)$, $x_5 y_5 = 3$, $u_5 = u(1,3) = \\exp(1)\\cos(3) + 1 \\cdot 3 = e\\cos(3)+3$。\n-   $i=6: (x_6, y_6) = (-1,3)$, $x_6 y_6 = -3$, $u_6 = u(-1,3) = \\exp(-1)\\cos(3) + (-1) \\cdot 3 = e^{-1}\\cos(3)-3$。\n-   $i=7: (x_7, y_7) = (1,-3)$, $x_7 y_7 = -3$, $u_7 = u(1,-3) = \\exp(1)\\cos(-3) + 1 \\cdot (-3) = e\\cos(3)-3$。\n-   $i=8: (x_8, y_8) = (-1,-3)$, $x_8 y_8 = 3$, $u_8 = u(-1,-3) = \\exp(-1)\\cos(-3) + (-1) \\cdot (-3) = e^{-1}\\cos(3)+3$。\n\n右端项的和是：\n$$\n\\text{RHS} = \\sum_{i=5}^8 (x_i y_i) u_i = (3)u_5 + (-3)u_6 + (-3)u_7 + (3)u_8\n$$\n$$\n\\text{RHS} = 3(u_5 - u_6 - u_7 + u_8)\n$$\n让我们代入 $u_i$ 的值：\n$$\n\\text{RHS} = 3 \\left[ (e\\cos(3)+3) - (e^{-1}\\cos(3)-3) - (e\\cos(3)-3) + (e^{-1}\\cos(3)+3) \\right]\n$$\n对各项进行分组：\n$$\n\\text{RHS} = 3 \\left[ (e\\cos(3) - e\\cos(3)) + (-e^{-1}\\cos(3) + e^{-1}\\cos(3)) + (3+3+3+3) \\right]\n$$\n$$\n\\text{RHS} = 3 \\left[ 0 + 0 + 12 \\right] = 3 \\cdot 12 = 36\n$$\n因此，$c_{11}$ 的方程是：\n$$\n36 \\, c_{11} = 36\n$$\n求解 $c_{11}$ 得到：\n$$\nc_{11} = 1\n$$\n这个值对应于偏导数 $\\frac{\\partial^2 u}{\\partial x \\partial y}$ 在 $(0,0)$ 处的精确值：\n$\\frac{\\partial u}{\\partial y} = -\\exp(x)\\sin(y) + x$。\n$\\frac{\\partial^2 u}{\\partial x \\partial y} = -\\exp(x)\\sin(y) + 1$。\n在 $(0,0)$ 处，该值为 $-\\exp(0)\\sin(0)+1 = 1$。由于点的特定选择以及 $u(x,y)$ 泰勒展开中高阶项的奇偶性，最小二乘拟合精确地恢复了这个系数。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}