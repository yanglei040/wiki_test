{
    "hands_on_practices": [
        {
            "introduction": "Before delving into complex mathematical derivations, it is essential to build a strong intuition for the physical meaning of the Courant-Friedrichs-Lewy (CFL) condition. This condition is fundamentally about ensuring that the numerical method can \"see\" the physical information it needs to propagate the solution correctly. This exercise challenges you to connect the abstract structure of a finite difference stencil to the physical concept of the domain of dependence, identifying a scheme that fails this basic requirement and predicting the resulting instability .",
            "id": "3375543",
            "problem": "Consider the linear advection equation $u_t + a\\,u_x = 0$ with constant wave speed $a>0$ on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. The exact solution propagates along characteristics $x(t) = x_0 + a t$, so the point $(x_i,t_{n+1})$ depends on data along the characteristic that arrives from the left at $(x_i - a \\Delta t, t_n)$. In an explicit finite difference method, the numerical domain of dependence at a single time update is the set of spatial nodes used on the right-hand side of the update formula at time level $t_n$ to produce $u_i^{n+1}$.\n\nUsing only the definitions above and first principles for the linear advection equation and explicit finite difference stencils, identify which option constructs an explicit one-step stencil whose numerical domain of dependence at $(x_i,t_{n+1})$ fails to cover the partial differential equation domain of dependence for $a>0$, and correctly predicts the associated instability mechanism that follows from this mismatch. Let $\\nu := a\\,\\Delta t/\\Delta x$ denote the Courant number.\n\nChoose the single best option.\n\nA. Stencil and mechanism:\nUpdate by forward time and forward (downwind) space,\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\nu\\left(u_{i+1}^n - u_i^n\\right).\n$$\nFor $a>0$ this stencil uses only $x_i$ and $x_{i+1}$ at time $t_n$, so its numerical domain of dependence excludes the upwind node $x_{i-1}$ required by the partial differential equation domain of dependence. A von Neumann analysis yields amplification factor $G(\\theta) = 1 + \\nu\\big(1 - e^{\\mathrm{i}\\theta}\\big)$ with $|G(\\theta)|>1$ for all $\\theta\\neq 0$ whenever $\\nu>0$, implying unconditional linear instability. The modified equation reveals a negative numerical viscosity (anti-diffusion) term proportional to $-\\,\\tfrac{a}{2}\\,(a\\Delta t + \\Delta x)\\,u_{xx}$, so short wavelengths grow fastest.\n\nB. Stencil and mechanism:\nUpdate by forward time and backward (upwind) space,\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\nu\\left(u_i^n - u_{i-1}^n\\right).\n$$\nFor $a>0$ this stencil uses $x_i$ and $x_{i-1}$ at time $t_n$, so its numerical domain of dependence contains the partial differential equation domain of dependence. It is linearly stable under the Courant-Friedrichs-Lewy condition $0\\le \\nu \\le 1$, with numerical diffusion that damps high wavenumbers.\n\nC. Stencil and mechanism:\nUpdate by forward time and centered space,\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;-\\; \\frac{\\nu}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right).\n$$\nFor $a>0$ this stencil uses $x_{i-1}$, $x_i$, and $x_{i+1}$ at time $t_n$, so its numerical domain of dependence includes the partial differential equation domain of dependence. Nevertheless, forward Euler in time applied to a skew-adjoint spatial operator produces $G(\\theta)=1-\\mathrm{i}\\nu\\sin\\theta$ and $|G(\\theta)|>1$ for any $\\theta\\neq 0$, hence unconditional instability due to time-discretization of a purely dispersive operator, not due to a domain-of-dependence mismatch.\n\nD. Stencil and mechanism:\nUpdate by the Lax-Friedrichs method,\n$$\nu_i^{n+1} \\;=\\; \\tfrac{1}{2}\\big(u_{i+1}^n + u_{i-1}^n\\big) \\;-\\; \\frac{\\nu}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right).\n$$\nFor $a>0$ this stencil’s numerical domain of dependence includes the partial differential equation domain of dependence. It is linearly stable provided $|\\nu|\\le 1$ due to added numerical diffusion that controls high wavenumbers.\n\nWhich option is correct?",
            "solution": "The problem asks to identify a finite difference scheme that violates the Courant-Friedrichs-Lewy (CFL) domain of dependence condition for the linear advection equation $u_t + a u_x = 0$ with $a > 0$, and to correctly describe the resulting instability.\n\nThe solution to the PDE, $u(x,t)$, is constant along characteristic curves $x - at = \\text{constant}$. This means the value at a point $(x_i, t_{n+1})$ is determined by the value at an earlier time $t_n$ at the point $(x_i - a \\Delta t, t_n)$. Since $a>0$, this point is to the left of $x_i$. The CFL condition requires that the numerical domain of dependence—the set of grid points at time $t_n$ used to compute $u_i^{n+1}$—must contain this physical domain of dependence. Therefore, for $a>0$, any stable explicit scheme must use information from at least one grid point at or to the left of $x_i$. A \"downwind\" scheme that uses only points at or to the right of $x_i$ will violate this condition.\n\nWe now analyze each option.\n\n**A. Stencil and mechanism: Forward time and forward (downwind) space**\nThe stencil is $u_i^{n+1} = u_i^n - \\nu(u_{i+1}^n - u_i^n)$.\n*   **Domain of Dependence:** This scheme uses nodes $x_i$ and $x_{i+1}$ to compute the update at $x_i$. The numerical domain of dependence is $[x_i, x_{i+1}]$. Since $a>0$, the physical domain of dependence is $x_i - a\\Delta t$, which is to the left of $x_i$. The numerical domain does not contain the physical domain, thus violating the CFL condition.\n*   **Instability Analysis:** A von Neumann analysis gives the amplification factor $G(\\theta) = 1 - \\nu(e^{\\mathrm{i}\\theta} - 1)$. The squared magnitude is $|G(\\theta)|^2 = |(1 - \\nu(\\cos\\theta-1)) - \\mathrm{i}\\nu\\sin\\theta|^2 = 1 + 2(\\nu + \\nu^2)(1-\\cos\\theta)$. Since $\\nu > 0$ and $(1-\\cos\\theta) \\ge 0$, we have $|G(\\theta)|^2 \\ge 1$, with strict inequality for any non-zero wavenumber. The scheme is unconditionally unstable. A modified equation analysis confirms this, revealing a leading error term of $-\\frac{a}{2}(a\\Delta t + \\Delta x) u_{xx}$, which is an anti-diffusion term that causes unbounded growth.\n*   **Conclusion:** This option correctly identifies a scheme that violates the domain of dependence condition and accurately describes the resulting instability.\n\n**B. Stencil and mechanism: Forward time and backward (upwind) space**\nThe stencil is $u_i^{n+1} = u_i^n - \\nu(u_i^n - u_{i-1}^n)$.\n*   **Domain of Dependence:** This scheme uses nodes $x_{i-1}$ and $x_i$. The numerical domain $[x_{i-1}, x_i]$ correctly contains the physical domain of dependence $x_i - a\\Delta t$ provided $a\\Delta t \\le \\Delta x$, i.e., $0 \\le \\nu \\le 1$.\n*   **Conclusion:** This describes a conditionally stable upwind scheme that *can* satisfy the CFL condition. It does not fit the question's criteria.\n\n**C. Stencil and mechanism: Forward time and centered space (FTCS)**\nThe stencil is $u_i^{n+1} = u_i^n - \\frac{\\nu}{2}(u_{i+1}^n - u_{i-1}^n)$.\n*   **Domain of Dependence:** The numerical domain is $[x_{i-1}, x_{i+1}]$. This contains the physical domain of dependence as long as $|\\nu| \\le 1$. Thus, the domain of dependence condition can be satisfied.\n*   **Instability Analysis:** The scheme is unconditionally unstable because its amplification factor $G(\\theta) = 1 - \\mathrm{i}\\nu\\sin\\theta$ has magnitude $|G(\\theta)|^2 = 1 + \\nu^2\\sin^2\\theta > 1$. However, this instability is not caused by a failure to satisfy the domain of dependence condition (for $|\\nu| \\le 1$).\n*   **Conclusion:** This option describes an unstable scheme, but its instability mechanism is different from the one requested.\n\n**D. Stencil and mechanism: Lax-Friedrichs method**\nThe stencil uses nodes $x_{i-1}$ and $x_{i+1}$.\n*   **Domain of Dependence:** Similar to FTCS, the numerical domain $[x_{i-1}, x_{i+1}]$ contains the physical domain for $|\\nu| \\le 1$.\n*   **Instability Analysis:** This scheme is known to be stable provided $|\\nu| \\le 1$.\n*   **Conclusion:** This describes a conditionally stable scheme and does not fit the question's criteria.\n\nBased on the analysis, Option A is the only one that presents a scheme that fundamentally fails the domain of dependence condition for $a>0$ and correctly attributes its unconditional instability to this failure.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "With a conceptual understanding in place, the next step is to formalize the stability analysis using a rigorous mathematical tool. The von Neumann (or Fourier) stability analysis is the standard method for determining the stability of linear finite difference schemes with constant coefficients. This practice provides a quintessential application of the technique, guiding you through the derivation of the sharp stability constraint for the first-order upwind scheme, a cornerstone method for solving advection problems .",
            "id": "3375615",
            "problem": "Consider the linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ for a constant advection speed $a \\in \\mathbb{R}$ on a uniform spatial grid with spacing $\\Delta x > 0$ and explicit time stepping with step size $\\Delta t > 0$. Discretize $u_{x}$ using the first-order upwind finite-difference approximation consistent with the sign of $a$ (backward difference if $a>0$, forward difference if $a<0$), and discretize $u_{t}$ using forward Euler in time. Assume a spatially periodic setting so that discrete Fourier modes are admissible. Define the Courant-Friedrichs-Lewy (CFL) number $C := a\\,\\Delta t/\\Delta x$. Perform a von Neumann (Fourier) stability analysis of this scheme by considering a discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\theta j)$, where $\\theta \\in \\mathbb{R}$ is the nondimensional wavenumber, and derive the sharp necessary and sufficient stability constraint on $C$ ensuring that the amplification factor has magnitude at most one for all wavenumbers. Finally, express your result as the maximal allowable time step $\\Delta t_{\\max}$ in terms of $a$ and $\\Delta x$. Provide your final answer as a single closed-form analytic expression. No numerical rounding is required.",
            "solution": "The problem requires deriving the stability condition for the first-order upwind scheme for the linear advection equation $u_t + a u_x = 0$. The scheme uses forward Euler for the time derivative and an upwind choice for the spatial derivative. We use von Neumann stability analysis.\n\nThe time derivative is approximated as $u_t \\approx (u_j^{n+1} - u_j^n)/\\Delta t$. The spatial derivative approximation depends on the sign of the advection speed $a$.\n\n**Case 1: $a > 0$**\nInformation propagates in the $+x$ direction, so the upwind scheme uses a backward difference: $u_x \\approx (u_j^n - u_{j-1}^n)/\\Delta x$. The finite difference equation is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\nRearranging and using the Courant number $C = a \\Delta t / \\Delta x > 0$, we get:\n$$\nu_j^{n+1} = u_j^n - C (u_j^n - u_{j-1}^n)\n$$\nWe substitute the Fourier mode $u_j^n = \\hat{u}^n \\exp(i\\theta j)$ and solve for the amplification factor $G(\\theta) = \\hat{u}^{n+1}/\\hat{u}^n$:\n$$\n\\hat{u}^{n+1} e^{i\\theta j} = \\hat{u}^n e^{i\\theta j} - C (\\hat{u}^n e^{i\\theta j} - \\hat{u}^n e^{i\\theta (j-1)})\n$$\n$$\nG(\\theta) = 1 - C (1 - e^{-i\\theta}) = (1 - C) + C e^{-i\\theta}\n$$\nThe squared magnitude is $|G(\\theta)|^2 = |(1 - C + C\\cos\\theta) - iC\\sin\\theta|^2 = (1-C+C\\cos\\theta)^2 + C^2\\sin^2\\theta$. Expanding this gives:\n$$\n|G(\\theta)|^2 = 1 - 2C(1-C)(1-\\cos\\theta)\n$$\nFor stability, we require $|G(\\theta)|^2 \\le 1$. This implies $-2C(1-C)(1-\\cos\\theta) \\le 0$. Since $1-\\cos\\theta \\ge 0$, the condition simplifies to $C(1-C) \\ge 0$. As $C > 0$ in this case, we must have $1-C \\ge 0$, which means $C \\le 1$. The stability condition is $0  C \\le 1$.\n\n**Case 2: $a  0$**\nInformation propagates in the $-x$ direction, so the upwind scheme uses a forward difference: $u_x \\approx (u_{j+1}^n - u_j^n)/\\Delta x$. The finite difference equation is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0\n$$\nHere, $C = a \\Delta t / \\Delta x  0$. The update is:\n$$\nu_j^{n+1} = u_j^n - C (u_{j+1}^n - u_j^n)\n$$\nSubstituting the Fourier mode yields the amplification factor:\n$$\nG(\\theta) = 1 - C (e^{i\\theta} - 1)\n$$\nThe squared magnitude is:\n$$\n|G(\\theta)|^2 = 1 + 2C(1+C)(1-\\cos\\theta)\n$$\nThe stability condition $|G(\\theta)|^2 \\le 1$ implies $2C(1+C)(1-\\cos\\theta) \\le 0$. This simplifies to $C(1+C) \\le 0$. Since $C  0$, we must have $1+C \\ge 0$, which means $C \\ge -1$. The stability condition is $-1 \\le C  0$.\n\n**Combined Constraint and Final Answer**\nFor $a>0$, we have $0  \\frac{a\\Delta t}{\\Delta x} \\le 1$. For $a0$, we have $-1 \\le \\frac{a\\Delta t}{\\Delta x}  0$, which is equivalent to $1 \\ge -\\frac{a\\Delta t}{\\Delta x} > 0$. Both conditions can be unified using the absolute value:\n$$\n\\frac{|a|\\Delta t}{\\Delta x} \\le 1\n$$\nThis is the sharp stability constraint. To find the maximal allowable time step, $\\Delta t_{\\max}$, we solve for $\\Delta t$:\n$$\n\\Delta t \\le \\frac{\\Delta x}{|a|}\n$$\nThe maximum value is thus:\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|a|}\n$$",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "The principles of numerical stability extend beyond hyperbolic equations like the advection equation. This practice broadens your understanding by applying the von Neumann analysis to a parabolic equation: the heat equation. By working through this problem, you will discover that the stability constraint for diffusive processes has a distinct character, with the maximum allowable time step scaling with the square of the spatial grid size, $\\Delta t \\propto (\\Delta x)^2$. This exercise highlights how the underlying physics of a partial differential equation directly dictates the nature of its numerical stability conditions .",
            "id": "3375578",
            "problem": "Consider the one-dimensional heat equation $u_{t} = \\nu\\, u_{xx}$ on an infinite, uniform spatial grid with spacing $\\Delta x$, where $\\nu  0$ is a constant kinematic viscosity (diffusivity). Discretize in time using the Forward-Time Central-Space (FTCS) scheme on a uniform temporal grid with time step $\\Delta t$. The Courant-Friedrichs-Lewy (CFL) stability condition for linear, constant-coefficient problems can be assessed by von Neumann (Fourier) analysis, which requires that the magnitude of the amplification factor be bounded by unity for all spatial Fourier modes.\n\nStarting from first principles appropriate to numerical solution of partial differential equations, namely the discrete FTCS update for $u_{t} = \\nu\\, u_{xx}$ on a uniform grid and the Fourier mode ansatz used in von Neumann analysis, derive the stability restriction that guarantees bounded growth of all discrete Fourier modes. Then, from this condition, determine the largest permissible time step $\\Delta t_{\\max}$ as a closed-form expression in terms of $\\Delta x$ and $\\nu$. Report your final answer for $\\Delta t_{\\max}$ as a single analytic expression. Do not provide an inequality, and do not include units in your final reported expression.",
            "solution": "We begin with the one-dimensional heat equation $u_{t} = \\nu\\, u_{xx}$, where $\\nu  0$ is constant. On a uniform spatial grid $x_{j} = j\\,\\Delta x$ and a uniform temporal grid $t^{n} = n\\,\\Delta t$, the Forward-Time Central-Space (FTCS) scheme discretizes the equation as\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\nu\\,\\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}}.\n$$\nEquivalently, the explicit update is\n$$\nu_{j}^{n+1} = u_{j}^{n} + r\\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right),\n$$\nwhere we have introduced the nondimensional diffusive number\n$$\nr = \\frac{\\nu\\,\\Delta t}{(\\Delta x)^{2}}.\n$$\n\nTo assess linear stability via von Neumann (Fourier) analysis, we consider the response of the scheme to a single spatial Fourier mode. Assume a solution of the form\n$$\nu_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,x_{j}\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right),\n$$\nwhere $k \\in \\mathbb{R}$ is the spatial wave number and $\\mathrm{i}$ is the imaginary unit. Substituting this ansatz into the update, we find\n$$\n\\hat{u}^{n+1}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right) + r\\left[\\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,(j+1)\\,\\Delta x\\right) - 2 \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right) + \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,(j-1)\\,\\Delta x\\right)\\right].\n$$\nCanceling the common factor $\\exp\\!\\left(\\mathrm{i}\\,k\\,j\\,\\Delta x\\right)$ yields the scalar recurrence\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n}\\left[1 + r\\left(\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right) - 2 + \\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right)\\right)\\right].\n$$\nDefine the amplification factor $G(k)$ by $\\hat{u}^{n+1} = G(k)\\,\\hat{u}^{n}$; then\n$$\nG(k) = 1 + r\\left(\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right) - 2 + \\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right)\\right).\n$$\nUsing the identity $\\exp\\!\\left(\\mathrm{i}\\,\\theta\\right) + \\exp\\!\\left(-\\mathrm{i}\\,\\theta\\right) = 2 \\cos\\!\\theta$, we simplify:\n$$\nG(k) = 1 + r\\left(2\\cos\\!\\left(k\\,\\Delta x\\right) - 2\\right) = 1 - 2r\\left(1 - \\cos\\!\\left(k\\,\\Delta x\\right)\\right).\n$$\nRecall the trigonometric identity $1 - \\cos\\!\\theta = 2 \\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)$, giving\n$$\nG(k) = 1 - 4 r\\,\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right).\n$$\n\nFor linear constant-coefficient schemes, von Neumann stability requires that the magnitude of the amplification factor not exceed unity for every wave number $k$, i.e.,\n$$\n|G(k)| \\leq 1 \\quad \\text{for all } k \\in \\mathbb{R}.\n$$\nSince $G(k)$ is real here, this reduces to\n$$\n-1 \\leq G(k) \\leq 1 \\quad \\text{for all } k.\n$$\nThe function $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)$ ranges over $[0,1]$ as $k$ varies. The most restrictive bound arises at the extremal values. Evaluate $G$ at $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)=0$ and $1$:\n- At $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)=0$, we have $G = 1$, which satisfies the bound for any $r$.\n- At $\\sin^{2}\\!\\left(\\frac{k\\,\\Delta x}{2}\\right)=1$, we have $G = 1 - 4r$.\n\nStability requires $-1 \\leq 1 - 4r \\leq 1$. The right inequality $1 - 4r \\leq 1$ holds trivially for $r \\geq 0$. The left inequality $-1 \\leq 1 - 4r$ yields\n$$\n-1 \\leq 1 - 4r \\quad \\Longleftrightarrow \\quad -2 \\leq -4r \\quad \\Longleftrightarrow \\quad r \\leq \\frac{1}{2}.\n$$\nAdditionally, for the diffusive equation and explicit FTCS scheme, one also requires $r \\geq 0$ to avoid sign reversal in the discrete diffusion operator. Therefore, the von Neumann stability condition is\n$$\n0 \\leq r \\leq \\frac{1}{2}.\n$$\nRecalling $r = \\frac{\\nu\\,\\Delta t}{(\\Delta x)^{2}}$, the largest permissible explicit time step is\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^{2}}{2\\,\\nu}.\n$$\nThis is the diffusive CFL restriction for the FTCS discretization of the heat equation.",
            "answer": "$$\\boxed{\\frac{(\\Delta x)^{2}}{2 \\nu}}$$"
        }
    ]
}