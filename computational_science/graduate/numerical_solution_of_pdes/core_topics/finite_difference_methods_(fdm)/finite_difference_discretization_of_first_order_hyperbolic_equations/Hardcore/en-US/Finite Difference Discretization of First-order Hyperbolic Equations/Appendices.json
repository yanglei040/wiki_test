{
    "hands_on_practices": [
        {
            "introduction": "To effectively solve hyperbolic equations, we must first understand the personality of our numerical tools. A finite difference scheme does not perfectly replicate the physics of wave propagation; it introduces numerical artifacts. This practice introduces Fourier analysis as the essential diagnostic tool to quantify two of these key artifacts: numerical dissipation, which damps wave amplitudes, and numerical dispersion, which causes waves of different frequencies to travel at incorrect speeds. By analyzing the amplification factor of various schemes, you will develop the foundational skill of predicting and characterizing their behavior .",
            "id": "3393016",
            "problem": "Consider the constant-coefficient linear advection equation $u_{t} + a\\,u_{x} = 0$ for a smooth scalar field $u(x,t)$ with positive advection speed $a > 0$, posed on an infinite uniform grid with spacing $h$ and time step $\\Delta t$. Let the Courant–Friedrichs–Lewy (CFL) number be defined as $\\lambda = a\\,\\Delta t/h$. Use Fourier mode analysis on a single-frequency component $u^{n}_{j} = \\hat{u}\\,\\exp(i\\,j\\,\\kappa)\\,\\exp(i\\,n\\,\\varphi)$, where $\\kappa = k\\,h$ is the nondimensional wavenumber with $k$ the physical wavenumber and $j,n \\in \\mathbb{Z}$ are the spatial and temporal indices.\n\n1. For the forward Euler, first-order upwind finite difference scheme for $a > 0$,\n$$\nu^{n+1}_{j} = u^{n}_{j} - \\lambda\\left(u^{n}_{j} - u^{n}_{j-1}\\right),\n$$\nderive the discrete amplification factor $G_{\\text{up}}(\\kappa)$, and determine whether the scheme introduces discrete dispersion, discrete dissipation, or both. Express the discrete phase in terms of the argument of $G_{\\text{up}}(\\kappa)$ and the numerical phase speed in terms of $\\varphi/\\Delta t$ and $k$.\n\n2. For the classical Lax–Wendroff scheme for linear advection,\n$$\nu^{n+1}_{j} = u^{n}_{j} - \\frac{\\lambda}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\lambda^{2}}{2}\\left(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\right),\n$$\nderive the discrete amplification factor $G_{\\text{LW}}(\\kappa)$ and its magnitude. Determine the condition on $\\lambda$ under which the scheme is nondissipative for all $\\kappa \\in [0,\\pi]$, and express the numerical phase speed in terms of the argument of $G_{\\text{LW}}(\\kappa)$ and $k$.\n\n3. Consider the following one-parameter family of three-point, tridiagonal compact upwind finite difference approximations to $u_{x}$, posed in semi-discrete form (method of lines with exact time integration) so that dispersive properties are controlled solely by the spatial differentiation:\n$$\n\\alpha\\,u'_{j-1} + u'_{j} = \\frac{1}{h}\\left(c_{-1}\\,u_{j-1} + c_{0}\\,u_{j} + c_{1}\\,u_{j+1}\\right),\n$$\nwhere $\\alpha \\ge 0$ is a free upwind-bias parameter and $c_{-1},c_{0},c_{1}$ are constant coefficients to be determined by consistency and bias toward upwind advection for $a > 0$. Using Fourier mode analysis, derive the semi-discrete modified wavenumber $\\tilde{k}(\\kappa)$ defined through $u'_{j} \\approx i\\,\\tilde{k}(\\kappa)\\,u_{j}$, and construct its small-$\\kappa$ expansion $\\tilde{k}(\\kappa)\\,h = \\kappa + \\beta_{3}(\\alpha)\\,\\kappa^{3} + \\mathcal{O}(\\kappa^{5})$. Impose the conditions required for formal third-order accuracy and upwind bias, and then define the leading-order normalized phase speed error over the target band $\\kappa \\in [0,\\kappa_{b}]$ for a fixed $0  \\kappa_{b}  \\pi$ by the integral\n$$\n\\mathcal{E}(\\alpha) = \\int_{0}^{\\kappa_{b}}\\left(\\frac{\\tilde{k}(\\kappa)}{k} - 1\\right)^{2}\\,d\\kappa,\n$$\nwhere $k = \\kappa/h$. Using the leading-order asymptotics in $\\kappa$, minimize $\\mathcal{E}(\\alpha)$ over $\\alpha \\ge 0$ in closed form. Your final answer must be the single optimal value of $\\alpha$ that minimizes the leading-order measure, expressed as an exact number. No rounding is required, and no units should be included in the final answer.",
            "solution": "### Part 1: First-Order Upwind Scheme\n\nThe first-order upwind scheme for $a > 0$ is given by\n$$\nu^{n+1}_{j} = u^{n}_{j} - \\lambda\\left(u^{n}_{j} - u^{n}_{j-1}\\right)\n$$\nwhere $\\lambda = a\\,\\Delta t/h$ is the CFL number. To perform Fourier analysis, we substitute a single mode $u^{n}_{j} = G^{n}(\\kappa)\\,\\exp(i\\,j\\,\\kappa)$, where $G(\\kappa)$ is the amplification factor and $\\kappa=kh$ is the non-dimensional wavenumber.\n$$\nG^{n+1}\\,\\exp(i\\,j\\,\\kappa) = G^{n}\\,\\exp(i\\,j\\,\\kappa) - \\lambda\\left(G^{n}\\,\\exp(i\\,j\\,\\kappa) - G^{n}\\,\\exp(i\\,(j-1)\\,\\kappa)\\right)\n$$\nDividing by $G^{n}\\,\\exp(i\\,j\\,\\kappa)$, we obtain the amplification factor $G_{\\text{up}}(\\kappa)$:\n$$\nG_{\\text{up}}(\\kappa) = 1 - \\lambda(1 - \\exp(-i\\,\\kappa)) = 1 - \\lambda + \\lambda e^{-i\\kappa} = 1 - \\lambda + \\lambda(\\cos(\\kappa) - i\\sin(\\kappa))\n$$\nThus,\n$$\nG_{\\text{up}}(\\kappa) = (1 - \\lambda + \\lambda\\,\\cos(\\kappa)) - i\\,\\lambda\\,\\sin(\\kappa)\n$$\nTo analyze dissipation, we compute the magnitude of $G_{\\text{up}}(\\kappa)$:\n$$\n|G_{\\text{up}}(\\kappa)|^2 = (1 - \\lambda + \\lambda\\,\\cos\\kappa)^2 + (-\\lambda\\,\\sin\\kappa)^2\n$$\n$$\n|G_{\\text{up}}(\\kappa)|^2 = (1-\\lambda)^2 + 2\\lambda(1-\\lambda)\\cos\\kappa + \\lambda^2\\cos^2\\kappa + \\lambda^2\\sin^2\\kappa\n$$\n$$\n|G_{\\text{up}}(\\kappa)|^2 = 1 - 2\\lambda + \\lambda^2 + 2\\lambda\\cos\\kappa - 2\\lambda^2\\cos\\kappa + \\lambda^2 = 1 - 2\\lambda(1-\\cos\\kappa) + 2\\lambda^2(1-\\cos\\kappa)\n$$\n$$\n|G_{\\text{up}}(\\kappa)|^2 = 1 - 2\\lambda(1-\\lambda)(1-\\cos\\kappa)\n$$\nUsing the half-angle identity $1-\\cos\\kappa = 2\\sin^2(\\kappa/2)$, we get\n$$\n|G_{\\text{up}}(\\kappa)|^2 = 1 - 4\\lambda(1-\\lambda)\\sin^2(\\frac{\\kappa}{2})\n$$\nFor the scheme to be stable, we require $|G_{\\text{up}}(\\kappa)| \\le 1$, which implies $4\\lambda(1-\\lambda)\\sin^2(\\kappa/2) \\ge 0$. As $\\lambda > 0$ and $\\sin^2(\\kappa/2) \\ge 0$, this requires $1-\\lambda \\ge 0$, so the stability condition is $0  \\lambda \\le 1$. If $0  \\lambda  1$, then $|G_{\\text{up}}(\\kappa)|  1$ for any $\\kappa \\ne 0, 2\\pi, \\dots$. This reduction in amplitude for non-zero wavenumbers indicates the presence of numerical (or artificial) dissipation.\n\nTo analyze dispersion, we examine the phase of $G_{\\text{up}}(\\kappa)$. The numerical phase shift per time step is $\\varphi = \\arg(G_{\\text{up}}(\\kappa))$.\n$$\n\\varphi = \\arg(G_{\\text{up}}) = \\arctan\\left(\\frac{-\\lambda\\,\\sin(\\kappa)}{1 - \\lambda + \\lambda\\,\\cos(\\kappa)}\\right)\n$$\nThe exact solution $u(x,t) = f(x-at)$ has a corresponding amplification factor $G_{\\text{exact}} = \\exp(-i\\,a\\,k\\,\\Delta t) = \\exp(-i\\,\\lambda\\,\\kappa)$. The exact phase shift is $-\\lambda\\,\\kappa$. The numerical phase speed is defined as $c_{\\text{num}} = -\\varphi / (k\\,\\Delta t)$. Substituting $k=\\kappa/h$ and $\\Delta t = \\lambda h/a$:\n$$\nc_{\\text{num}} = -\\frac{\\varphi}{(\\kappa/h)(\\lambda h/a)} = -\\frac{a\\,\\varphi}{\\lambda\\,\\kappa}\n$$\nSince $\\varphi$ is not a linear function of $\\kappa$ (specifically, $\\varphi \\ne -\\lambda\\kappa$ unless in the limit $\\kappa \\to 0$), the numerical phase speed $c_{\\text{num}}$ is not constant for all wavenumbers $k$. This dependency of phase speed on wavenumber is the definition of numerical dispersion. Therefore, the first-order upwind scheme introduces both discrete dissipation and discrete dispersion.\n\n### Part 2: Lax-Wendroff Scheme\n\nThe Lax-Wendroff scheme is given by\n$$\nu^{n+1}_{j} = u^{n}_{j} - \\frac{\\lambda}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\lambda^{2}}{2}\\left(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\right)\n$$\nSubstituting $u^n_j = G^n(\\kappa)\\exp(i j \\kappa)$ leads to:\n$$\nG_{\\text{LW}}(\\kappa) = 1 - \\frac{\\lambda}{2}(\\exp(i\\kappa) - \\exp(-i\\kappa)) + \\frac{\\lambda^2}{2}(\\exp(i\\kappa) - 2 + \\exp(-i\\kappa))\n$$\nUsing Euler's identities, $2i\\sin\\kappa = e^{i\\kappa}-e^{-i\\kappa}$ and $2\\cos\\kappa = e^{i\\kappa}+e^{-i\\kappa}$:\n$$\nG_{\\text{LW}}(\\kappa) = 1 - i\\lambda\\sin(\\kappa) + \\frac{\\lambda^2}{2}(2\\cos(\\kappa) - 2) = 1 - \\lambda^2(1-\\cos(\\kappa)) - i\\lambda\\sin(\\kappa)\n$$\nThe magnitude squared of the amplification factor is:\n$$\n|G_{\\text{LW}}(\\kappa)|^2 = \\left(1 - \\lambda^2(1-\\cos\\kappa)\\right)^2 + (-\\lambda\\sin\\kappa)^2\n$$\n$$\n|G_{\\text{LW}}(\\kappa)|^2 = 1 - 2\\lambda^2(1-\\cos\\kappa) + \\lambda^4(1-\\cos\\kappa)^2 + \\lambda^2\\sin^2\\kappa\n$$\nUsing $\\sin^2\\kappa = 1-\\cos^2\\kappa = (1-\\cos\\kappa)(1+\\cos\\kappa)$:\n$$\n|G_{\\text{LW}}(\\kappa)|^2 = 1 - 2\\lambda^2(1-\\cos\\kappa) + \\lambda^4(1-\\cos\\kappa)^2 + \\lambda^2(1-\\cos\\kappa)(1+\\cos\\kappa)\n$$\n$$\n|G_{\\text{LW}}(\\kappa)|^2 = 1 + (1-\\cos\\kappa)\\left[-2\\lambda^2 + \\lambda^4(1-\\cos\\kappa) + \\lambda^2(1+\\cos\\kappa)\\right]\n$$\n$$\n|G_{\\text{LW}}(\\kappa)|^2 = 1 + (1-\\cos\\kappa)\\left[-\\lambda^2 + \\lambda^2\\cos\\kappa + \\lambda^4 - \\lambda^4\\cos\\kappa\\right]\n$$\n$$\n|G_{\\text{LW}}(\\kappa)|^2 = 1 - (1-\\cos\\kappa)^2(\\lambda^2 - \\lambda^4) = 1 - \\lambda^2(1-\\lambda^2)(1-\\cos\\kappa)^2\n$$\nThe scheme is non-dissipative if $|G_{\\text{LW}}(\\kappa)| = 1$ for all $\\kappa$. This occurs when the subtractive term is zero for all $\\kappa$. Since $(1-\\cos\\kappa)^2$ is not identically zero, this requires $\\lambda^2(1-\\lambda^2)=0$. Given $\\lambda>0$, the only non-trivial solution is $1-\\lambda^2=0$, which implies $\\lambda=1$. The stability condition for Lax-Wendroff is $0  \\lambda \\le 1$. The scheme is non-dissipative only at the stability boundary $\\lambda=1$.\n\nThe numerical phase speed is $c_{\\text{num}} = -\\arg(G_{\\text{LW}}) / (k\\,\\Delta t)$, with\n$$\n\\arg(G_{\\text{LW}}) = \\arctan\\left(\\frac{-\\lambda\\sin(\\kappa)}{1-\\lambda^2(1-\\cos(\\kappa))}\\right)\n$$\n\n### Part 3: Compact Upwind Scheme\n\nThe semi-discrete compact scheme is given by\n$$\n\\alpha\\,u'_{j-1} + u'_{j} = \\frac{1}{h}\\left(c_{-1}\\,u_{j-1} + c_{0}\\,u_{j} + c_{1}\\,u_{j+1}\\right)\n$$\nTo satisfy consistency with the first derivative operator to the highest possible order, we perform a Taylor series expansion of all terms around point $j$. Matching terms for derivatives of $u$ gives a system of equations for the coefficients $c_{-1}, c_0, c_1$:\n1. Coeff of $u_j$: $c_{-1} + c_0 + c_1 = 0$\n2. Coeff of $u'_j$: $c_1 - c_{-1} = 1+\\alpha$\n3. Coeff of $u''_j$: $\\frac{h}{2}(c_1+c_{-1}) = -\\alpha h \\implies c_1+c_{-1} = -2\\alpha$\nSolving this system yields the coefficients as functions of $\\alpha$:\n$c_1 = \\frac{1-\\alpha}{2}$, $c_{-1} = -\\frac{1+3\\alpha}{2}$, $c_0 = 2\\alpha$.\n\nThe modified wavenumber $\\tilde{k}(\\kappa)$ is found by substituting $u_j = \\hat{u}\\exp(ij\\kappa)$ and $u'_j = i\\tilde{k}u_j$ into the scheme:\n$$\n\\alpha (i\\tilde{k}) e^{i(j-1)\\kappa} + (i\\tilde{k}) e^{ij\\kappa} = \\frac{1}{h}\\left(c_{-1}e^{i(j-1)\\kappa} + c_0 e^{ij\\kappa} + c_1 e^{i(j+1)\\kappa}\\right)\n$$\nDividing by $i e^{ij\\kappa}$ and rearranging gives:\n$$\n\\tilde{k}(\\kappa) h (\\alpha e^{-i\\kappa} + 1) = \\frac{1}{i}(c_{-1}e^{-i\\kappa} + c_0 + c_1 e^{i\\kappa})\n$$\nExpanding the expression for $\\tilde{k}(\\kappa)h$ for small $\\kappa$ yields:\n$$\n\\tilde{k}(\\kappa)h = \\kappa + \\left(\\frac{2\\alpha-1}{6(1+\\alpha)}\\right)\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\nThis is of the form specified in the problem, $\\tilde{k}(\\kappa)h = \\kappa + \\beta_3(\\alpha)\\kappa^3 + \\mathcal{O}(\\kappa^5)$, with\n$$\n\\beta_3(\\alpha) = \\frac{2\\alpha-1}{6(1+\\alpha)}\n$$\nThe problem asks to minimize an error measure over $\\alpha \\ge 0$. This implies we should proceed with the derived $\\beta_3(\\alpha)$ and find the value of $\\alpha$ that optimizes the scheme based on the given error metric.\n\nThe normalized phase speed error is $\\frac{\\tilde{k}(\\kappa)}{k} - 1 = \\frac{\\tilde{k}(\\kappa)h}{\\kappa} - 1$. Using the leading-order term from the expansion:\n$$\n\\frac{\\tilde{k}(\\kappa)}{k} - 1 = \\beta_3(\\alpha)\\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\nThe error integral $\\mathcal{E}(\\alpha)$ is approximated using this leading-order term:\n$$\n\\mathcal{E}(\\alpha) = \\int_{0}^{\\kappa_{b}}\\left(\\frac{\\tilde{k}(\\kappa)}{k} - 1\\right)^{2}\\,d\\kappa \\approx \\int_{0}^{\\kappa_{b}} (\\beta_3(\\alpha)\\kappa^2)^2 d\\kappa\n$$\n$$\n\\mathcal{E}(\\alpha) \\approx (\\beta_3(\\alpha))^2 \\int_{0}^{\\kappa_{b}} \\kappa^4 d\\kappa = (\\beta_3(\\alpha))^2 \\frac{\\kappa_b^5}{5}\n$$\nTo minimize $\\mathcal{E}(\\alpha)$ for a fixed $\\kappa_b > 0$, we must minimize $|\\beta_3(\\alpha)|$ over the domain $\\alpha \\ge 0$.\nWe need to find $\\min_{\\alpha \\ge 0} \\left|\\frac{2\\alpha-1}{6(1+\\alpha)}\\right|$.\nThis is equivalent to minimizing the squared quantity, $(\\beta_3(\\alpha))^2$.\nThe minimum value of $(\\beta_3(\\alpha))^2$ occurs when the numerator is zero, since the denominator $6(1+\\alpha)$ is non-zero for $\\alpha \\ge 0$.\n$$\n2\\alpha-1 = 0 \\implies \\alpha = \\frac{1}{2}\n$$\nThis value lies in the permitted range $\\alpha \\ge 0$. At $\\alpha=1/2$, $\\beta_3(1/2)=0$, which yields the minimum possible error $\\mathcal{E}(1/2)=0$ at this leading order of approximation. This corresponds to the case where the scheme becomes third-order accurate (and in fact, fourth-order for this specific family). Thus, the optimal value of the parameter is $1/2$.",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "When we move from linear advection to nonlinear conservation laws like the Burgers' equation, solutions can develop sharp discontinuities, or shocks. This hands-on implementation demonstrates a critical principle: the mathematical form of the discretization dictates whether these shocks propagate at the correct physical speed. By coding and comparing a conservative and a nonconservative scheme, you will see the celebrated Lax-Wendroff theorem in action and gain a tangible understanding of why only conservative schemes are reliable for shock-capturing applications .",
            "id": "3393018",
            "problem": "Consider the scalar conservation law known as inviscid Burgers’ equation, given by $u_t + \\tfrac{1}{2}(u^2)_x = 0$, posed on a one-dimensional spatial domain with piecewise constant Riemann initial data and constant Dirichlet boundary data. The fundamental base for this problem is the theory of hyperbolic conservation laws, the weak formulation, and the Rankine–Hugoniot jump condition, together with stability considerations based on the Courant–Friedrichs–Lewy (CFL) number. You will compare two explicit first-order finite difference discretizations: a conservative formulation using a numerical flux and a nonconservative formulation that directly discretizes the advective form $u_t + u u_x = 0$.\n\nThe setting is as follows. Let the spatial domain be $[-1,1]$, discretized into $N$ uniform cells of width $\\Delta x = \\tfrac{2}{N}$ with cell centers $x_i = -1 + (i+\\tfrac{1}{2})\\Delta x$ for $i = 0,\\dots,N-1$. Define piecewise constant Riemann initial data $u(x,0) = u_L$ for $x  0$ and $u(x,0) = u_R$ for $x  0$, and enforce constant Dirichlet boundary conditions $u(-1,t) = u_L$ and $u(1,t) = u_R$ for all $t \\ge 0$. Assume $u_L > u_R$ so that a shock forms and propagates with a well-defined speed. The exact shock speed $s_{\\mathrm{RH}}$ is determined by the Rankine–Hugoniot jump condition for a scalar conservation law $u_t + f(u)_x = 0$, with $f(u) = \\tfrac{1}{2}u^2$.\n\nThe first discretization is a conservative finite volume/finite difference method using a consistent numerical flux. Employ the local Lax–Friedrichs (also called Rusanov) numerical flux at interfaces $i+\\tfrac{1}{2}$:\n$$\nF_{i+\\frac{1}{2}}^n = \\frac{1}{2}\\left(f(u_i^n) + f(u_{i+1}^n)\\right) - \\frac{1}{2}\\alpha_{i+\\frac{1}{2}}^n\\left(u_{i+1}^n - u_i^n\\right),\n$$\nwhere $f(u) = \\tfrac{1}{2}u^2$ and $\\alpha_{i+\\frac{1}{2}}^n = \\max\\left(|u_i^n|,|u_{i+1}^n|\\right)$. The update is\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right),\n$$\nwith ghost/interface states at $x=-1$ and $x=1$ taken as $u_L$ and $u_R$ respectively to define $F_{-\\frac{1}{2}}^n$ and $F_{N-\\frac{1}{2}}^n$. Choose the time step to satisfy a stability constraint based on the Courant–Friedrichs–Lewy (CFL) number, specifically\n$$\n\\Delta t = \\mathrm{CFL} \\cdot \\frac{\\Delta x}{\\max_i |u_i^n|},\n$$\nwith $0  \\mathrm{CFL}  1$.\n\nThe second discretization treats the equation in nonconservative advective form $u_t + u u_x = 0$ and uses a pointwise upwind discretization based on the local speed $u_i^n$:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(\\max(u_i^n,0)\\left(u_i^n - u_{i-1}^n\\right) + \\min(u_i^n,0)\\left(u_{i+1}^n - u_i^n\\right)\\right),\n$$\nwith ghost neighbor values at the boundaries assigned consistently from $u_L$ and $u_R$, and boundary cell values reimposed to $u_L$ and $u_R$ after each time update to maintain the Dirichlet conditions. Use the same CFL-based time step selection for stability:\n$$\n\\Delta t = \\mathrm{CFL} \\cdot \\frac{\\Delta x}{\\max_i |u_i^n|}.\n$$\n\nTo quantify shock speed numerically, define the midpoint state $u_{\\mathrm{mid}} = \\tfrac{1}{2}(u_L + u_R)$. Estimate the shock position $x_{\\mathrm{shock}}(T)$ at a given final time $T$ by locating the first index $i$ where the discrete profile changes sign relative to $u_{\\mathrm{mid}}$, i.e., $(u_i^n - u_{\\mathrm{mid}})(u_{i+1}^n - u_{\\mathrm{mid}}) \\le 0$, and then linearly interpolating within the cell interface:\n$$\nx_{\\mathrm{shock}}(T) \\approx x_i + \\Delta x \\cdot \\frac{u_{\\mathrm{mid}} - u_i^n}{u_{i+1}^n - u_i^n}.\n$$\nBy construction, the shock initially lies at $x=0$, so the numerical shock speed is approximated by $s_{\\mathrm{num}} \\approx \\tfrac{x_{\\mathrm{shock}}(T)}{T}$. Compute the speed error for each scheme as\n$$\n\\varepsilon = \\left|s_{\\mathrm{num}} - s_{\\mathrm{RH}}\\right|,\n$$\nwhere $s_{\\mathrm{RH}}$ is the Rankine–Hugoniot speed for $f(u) = \\tfrac{1}{2}u^2$ and jump from $u_L$ to $u_R$.\n\nImplement both schemes on the same grid and parameters, and compare the speed errors at the same final time. Use the following test suite, designed to ensure coverage of a typical shock case, a stationary shock, and a moderate shock:\n1. Test case $1$: $u_L = 2.0$, $u_R = 0.0$, $T = 0.30$, $N = 800$, $\\mathrm{CFL} = 0.45$.\n2. Test case $2$: $u_L = 1.0$, $u_R = -1.0$, $T = 0.30$, $N = 800$, $\\mathrm{CFL} = 0.45$.\n3. Test case $3$: $u_L = 1.0$, $u_R = 0.5$, $T = 0.20$, $N = 800$, $\\mathrm{CFL} = 0.45$.\n\nFor each test case, compute the pair of speed errors $[\\varepsilon_{\\mathrm{cons}}, \\varepsilon_{\\mathrm{noncons}}]$, where $\\varepsilon_{\\mathrm{cons}}$ is for the conservative scheme and $\\varepsilon_{\\mathrm{noncons}}$ is for the nonconservative scheme. Your program should produce a single line of output containing the three pairs of results as a comma-separated list enclosed in square brackets, with each pair itself enclosed in square brackets, in the order of the test suite (for example, in the format $[[e_{1,\\mathrm{cons}},e_{1,\\mathrm{noncons}}],[e_{2,\\mathrm{cons}},e_{2,\\mathrm{noncons}}],[e_{3,\\mathrm{cons}},e_{3,\\mathrm{noncons}}]]$). All quantities are purely mathematical in this problem, so no physical units are required, and no angles or percentages appear in the output. The task is inherently testable because the output is a list of floating-point values for the defined test suite.",
            "solution": "### Principle-Based Solution Design\n\nThe core of this problem lies in a fundamental principle of numerical methods for conservation laws: a numerical scheme must be in \"conservation form\" to guarantee that any shock waves it captures propagate at the correct physical speed. This is formalized by the Lax-Wendroff theorem. The problem asks for a direct comparison of a scheme that respects this principle (the conservative finite volume method) and one that does not (the nonconservative upwind scheme).\n\n**1. Exact Shock Speed (Rankine–Hugoniot Condition)**\nFor a scalar conservation law $u_t + f(u)_x=0$, the speed $s$ of a discontinuity (shock) separating states $u_L$ and $u_R$ is given by the Rankine–Hugoniot condition:\n$$s = \\frac{[f(u)]}{[u]} = \\frac{f(u_R) - f(u_L)}{u_R - u_L}$$\nFor the inviscid Burgers' equation, the flux is $f(u) = \\frac{1}{2}u^2$. Substituting this into the condition yields:\n$$s_{\\mathrm{RH}} = \\frac{\\frac{1}{2}u_R^2 - \\frac{1}{2}u_L^2}{u_R - u_L} = \\frac{\\frac{1}{2}(u_R - u_L)(u_R + u_L)}{u_R - u_L}$$\nSince we are in the shock case ($u_L > u_R$), the denominator is non-zero, and we find the exact shock speed to be:\n$$s_{\\mathrm{RH}} = \\frac{1}{2}(u_L + u_R)$$\nThis formula will be used to calculate the exact speed for each test case and compute the error $\\varepsilon$.\n\n**2. Numerical Schemes and Time Evolution**\nA common function will be implemented to perform the time-stepping from $t=0$ to $t=T$ for a given numerical scheme.\n\n-   **Grid and Initial State:** A uniform cell-centered grid is established on $[-1,1]$. The initial condition is a piecewise constant function, which is discretized by assigning $u_L$ to cells with centers $x_i  0$ and $u_R$ to cells with $x_i  0$. Because the grid is cell-centered and the number of cells $N$ is even, no cell center falls on $x=0$, so the assignment is unambiguous.\n\n-   **Time Stepping:** The simulation proceeds in a loop. At each step $n$, the time step $\\Delta t$ is dynamically calculated based on the CFL condition to ensure stability: $\\Delta t = \\mathrm{CFL} \\cdot \\Delta x / \\max_i |u_i^n|$. The final time step is adjusted to ensure the simulation ends exactly at the target time $T$.\n\n**2.1. Conservative Scheme (Lax–Friedrichs)**\nThis scheme works by updating cell averages based on the net flux across cell boundaries. Its update formula is\n$$u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}}^n - F_{i-\\frac{1}{2}}^n\\right)$$\nThe numerical flux $F_{i+\\frac{1}{2}}$ is an approximation to the true flux at the interface between cells $i$ and $i+1$. The local Lax-Friedrichs (Rusanov) flux is a popular choice that introduces numerical dissipation proportional to the local wave speed to maintain stability. Its form is\n$$F_{i+\\frac{1}{2}} = \\frac{f(u_i) + f(u_{i+1})}{2} - \\frac{\\alpha_{i+\\frac{1}{2}}}{2}(u_{i+1} - u_i)$$\nwhere $\\alpha_{i+\\frac{1}{2}} = \\max(|u_i|, |u_{i+1}|)$.\nBoundary conditions are handled by introducing \"ghost cells\" outside the domain. The flux $F_{-\\frac{1}{2}}$ at the left boundary is computed using the state $u_L$ in the left ghost cell and $u_0$ in the first interior cell. Similarly, $F_{N-\\frac{1}{2}}$ at the right boundary uses $u_{N-1}$ and the ghost state $u_R$.\n\n**2.2. Nonconservative Scheme (Upwind)**\nThis scheme discretizes the nonconservative (advective) form of Burgers' equation, $u_t + u u_x = 0$. The spatial derivative $u_x$ is approximated using a first-order upwind difference, where the direction of the difference (forward or backward) depends on the sign of the local advection speed, $u_i$.\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\n\\begin{cases}\nu_i^n(u_i^n - u_{i-1}^n)  \\text{if } u_i^n  0 \\\\\nu_i^n(u_{i+1}^n - u_i^n)  \\text{if } u_i^n  0\n\\end{cases}\n$$\nThis scheme is not in conservation form. As a result, it is not guaranteed to converge to a weak solution of the original conservation law, and thus it may produce shocks that travel at an incorrect speed. Boundary conditions are implemented as specified: ghost cells with values $u_L$ and $u_R$ are used to compute the updates for $u_0$ and $u_{N-1}$, and after the full solution vector is updated, the values at the boundary cells are reset to $u_0 = u_L$ and $u_{N-1} = u_R$.\n\n**3. Shock Speed Analysis**\nAfter evolving the solution to the final time $T$, the numerical shock position is identified.\n-   The midpoint value $u_{\\mathrm{mid}} = (u_L+u_R)/2$ is calculated.\n-   The code searches for the first adjacent cell pair $(i, i+1)$ where the solution crosses this midpoint value, i.e., $(u_i - u_{\\mathrm{mid}})(u_{i+1} - u_{\\mathrm{mid}}) \\le 0$.\n-   Linear interpolation is used within this interval to find a more precise estimate of the shock position:\n    $$x_{\\mathrm{shock}} = x_i + \\Delta x \\frac{u_{\\mathrm{mid}} - u_i}{u_{i+1} - u_i}$$\n-   The numerical shock speed is then $s_{\\mathrm{num}} = x_{\\mathrm{shock}} / T$, assuming the shock starts at $x=0$.\n-   Finally, the error for each scheme is calculated as $\\varepsilon = |s_{\\mathrm{num}} - s_{\\mathrm{RH}}|$.\n\nThe implementation will process each test case, run both schemes, calculate their respective speed errors, and format the results as specified. This comparative analysis is expected to demonstrate the superior accuracy of the conservative scheme for shock-capturing problems.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It implements both a conservative and a nonconservative scheme for\n    the inviscid Burgers' equation and compares their shock speed prediction.\n    \"\"\"\n\n    def solve_case(u_L, u_R, T, N, CFL):\n        \"\"\"\n        Solves a single test case for both schemes.\n        \n        Returns:\n            A list containing the speed errors [err_cons, err_noncons].\n        \"\"\"\n        # --- Grid and Initial Conditions ---\n        L_domain = 2.0\n        dx = L_domain / N\n        x = np.linspace(-1 + dx / 2, 1 - dx / 2, N)\n        u0 = np.where(x  0, u_L, u_R)\n\n        # --- Exact Shock Speed (Rankine-Hugoniot) ---\n        s_rh = 0.5 * (u_L + u_R)\n        \n        # --- Function to run a simulation for a given scheme ---\n        def run_simulation(scheme_type):\n            u = u0.copy()\n            t = 0.0\n\n            while t  T:\n                # Calculate time step via CFL condition\n                max_u_abs = np.max(np.abs(u))\n                # Prevent division by zero if solution is identically zero\n                if max_u_abs  1e-12:\n                    max_u_abs = 1e-12\n                \n                dt = CFL * dx / max_u_abs\n                \n                # Ensure we stop exactly at time T\n                if t + dt  T:\n                    dt = T - t\n\n                if scheme_type == 'conservative':\n                    # Pad solution vector with ghost cells for boundary conditions\n                    u_padded = np.concatenate(([u_L], u, [u_R]))\n                    \n                    # Rusanov (Local Lax-Friedrichs) flux\n                    u_left = u_padded[:-1]\n                    u_right = u_padded[1:]\n                    \n                    flux_phys_left = 0.5 * u_left**2\n                    flux_phys_right = 0.5 * u_right**2\n                    \n                    alpha = np.maximum(np.abs(u_left), np.abs(u_right))\n                    \n                    flux_num = 0.5 * (flux_phys_left + flux_phys_right) - 0.5 * alpha * (u_right - u_left)\n                    \n                    # Update cell averages\n                    u = u - (dt / dx) * (flux_num[1:] - flux_num[:-1])\n\n                elif scheme_type == 'nonconservative':\n                    u_old = u.copy()\n                    u_new = u.copy()\n\n                    # Update for interior points (vectorized)\n                    # Note: These diffs use the state from the previous time step\n                    u_forward_diff = np.roll(u_old, -1) - u_old\n                    u_backward_diff = u_old - np.roll(u_old, 1)\n\n                    # Handle boundaries for difference calculation\n                    u_backward_diff[0] = u_old[0] - u_L\n                    u_forward_diff[N-1] = u_R - u_old[N-1]\n\n                    u_p = np.maximum(u_old, 0)\n                    u_n = np.minimum(u_old, 0)\n                    \n                    spatial_term = u_p * u_backward_diff + u_n * u_forward_diff\n                    u_new = u_old - (dt/dx) * spatial_term\n                    \n                    # Re-impose Dirichlet BC on boundary cells as specified\n                    u_new[0] = u_L\n                    u_new[N-1] = u_R\n                    u = u_new\n\n                t += dt\n            \n            return u\n\n        # --- Run simulations and calculate errors ---\n        errors = []\n        for scheme in ['conservative', 'nonconservative']:\n            u_final = run_simulation(scheme)\n            \n            u_mid = 0.5 * (u_L + u_R)\n            \n            # Find shock location by finding where solution crosses u_mid\n            # The condition finds the cell *before* the crossing\n            crossings = np.where((u_final[:-1] - u_mid) * (u_final[1:] - u_mid) = 0)[0]\n            \n            if len(crossings)  0:\n                i_shock = crossings[0] # Take the first crossing\n                \n                u_i = u_final[i_shock]\n                u_ip1 = u_final[i_shock + 1]\n                x_i = x[i_shock]\n                \n                # Linear interpolation to find precise shock position\n                # Add a small epsilon to denominator to avoid division by zero\n                denominator = u_ip1 - u_i\n                if abs(denominator)  1e-12:\n                    # If flat, place shock at interface\n                    x_shock = x_i + 0.5 * dx \n                else: \n                    x_shock = x_i + dx * (u_mid - u_i) / denominator\n            else:\n                # If no crossing is found (e.g., shock diffused out or exited domain), mark as NaN\n                x_shock = np.nan\n\n            if np.isnan(x_shock):\n                s_num = np.nan\n                error = np.nan\n            else:\n                s_num = x_shock / T\n                error = abs(s_num - s_rh)\n            errors.append(error)\n            \n        return errors\n\n    # --- Test Suite ---\n    test_cases = [\n        # (u_L, u_R, T, N, CFL)\n        (2.0, 0.0, 0.30, 800, 0.45),\n        (1.0, -1.0, 0.30, 800, 0.45),\n        (1.0, 0.5, 0.20, 800, 0.45),\n    ]\n\n    results = []\n    for params in test_cases:\n        errors = solve_case(*params)\n        results.append(errors)\n\n    # --- Final Output Formatting ---\n    formatted_pairs = [f\"[{e_c},{e_n}]\" for e_c, e_n in results]\n    print(f\"[{','.join(formatted_pairs)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Real-world phenomena are rarely one-dimensional, forcing us to extend our methods to higher dimensions. A powerful strategy is operator splitting, which deconstructs a complex multi-dimensional problem into a sequence of simpler 1D updates. This practice moves beyond basic implementation to analyze the theoretical cost of this simplification, revealing a new source of error known as the splitting error. You will learn to characterize this error by computing the commutator of the differential operators, providing deep insight into how the error depends on the structure of the advection field itself .",
            "id": "3393023",
            "problem": "Consider the linear first-order hyperbolic partial differential equation $u_{t} + a(x,y)\\,u_{x} + b(x,y)\\,u_{y} = 0$ on the unit square with periodic boundary conditions, where $a(x,y) = 1 + x\\,y$ and $b(x,y) = 1 + x^{2}$. The initial condition is $u(x,y,0) = \\sin(\\pi x)\\,\\cos(\\pi y)$. Let a dimension-by-dimension first-order upwind finite difference discretization be used for the spatial derivatives in each coordinate direction, where the local sign of the advection speed determines the upwind direction. Because $a(x,y) \\geq 1$ and $b(x,y) \\geq 1$ on the domain, adopt backward differences in both directions at all grid points. Define the semi-discrete operators $L_{x}^{\\Delta}$ and $L_{y}^{\\Delta}$ acting on a grid function $u_{i,j}$ by $L_{x}^{\\Delta} u_{i,j} = -a_{i,j}\\,\\frac{u_{i,j} - u_{i-1,j}}{\\Delta x}$ and $L_{y}^{\\Delta} u_{i,j} = -b_{i,j}\\,\\frac{u_{i,j} - u_{i,j-1}}{\\Delta y}$, where $(x_{i},y_{j})$ are uniform grid points with spacings $\\Delta x$ and $\\Delta y$.\n\nA Lie directional splitting update over a single time step $\\Delta t$ applies the $x$-advection update followed by the $y$-advection update. Using Taylor expansions and a smoothness assumption for $u$, characterize the leading-order local error introduced by this splitting in terms of the commutator of the split semi-discrete operators. In the continuum limit $\\Delta x,\\Delta y \\to 0$, compute the explicit commutator error term at the point $(x_{*},y_{*}) = \\left(\\frac{1}{2},\\frac{1}{2}\\right)$ for the given $a(x,y)$, $b(x,y)$, and $u(x,y,0)$, expressed as the coefficient multiplying $\\Delta t^{2}$ in the local error. Provide your final answer as a single closed-form analytic expression depending on $\\pi$ and $\\Delta t$.\n\nAdditionally, using your derived expression, explain which structural properties of the flow field $(a,b)$ lead to cancellation or amplification of the splitting error, but do not include this explanatory part in your final answer. No rounding is required, and no physical units are needed.",
            "solution": "The semi-discrete form of the PDE can be written as $\\frac{d\\vec{u}}{dt} = (L_x^\\Delta + L_y^\\Delta) \\vec{u}$, where $\\vec{u}$ is the vector of grid function values. The exact solution to this system of ODEs over a time step $\\Delta t$ is given by the matrix exponential $\\vec{u}(t_0+\\Delta t) = \\exp(\\Delta t(L_x^\\Delta + L_y^\\Delta))\\vec{u}(t_0)$.\n\nThe Lie directional splitting approximates this evolution by applying the operators sequentially:\n$$\n\\vec{u}_{approx}(t_0+\\Delta t) = \\exp(\\Delta t L_y^\\Delta) \\exp(\\Delta t L_x^\\Delta) \\vec{u}(t_0)\n$$\nTo characterize the local error, we perform a Taylor series expansion of the exact and approximate solution operators in powers of $\\Delta t$.\nThe exact operator is:\n$$\n\\exp(\\Delta t(L_x^\\Delta + L_y^\\Delta)) = I + \\Delta t(L_x^\\Delta + L_y^\\Delta) + \\frac{\\Delta t^2}{2}(L_x^\\Delta + L_y^\\Delta)^2 + O(\\Delta t^3)\n$$\n$$\n= I + \\Delta t(L_x^\\Delta + L_y^\\Delta) + \\frac{\\Delta t^2}{2}( (L_x^\\Delta)^2 + L_x^\\Delta L_y^\\Delta + L_y^\\Delta L_x^\\Delta + (L_y^\\Delta)^2 ) + O(\\Delta t^3)\n$$\nThe approximate splitting operator is:\n$$\n\\exp(\\Delta t L_y^\\Delta) \\exp(\\Delta t L_x^\\Delta) = \\left( I + \\Delta t L_y^\\Delta + \\frac{\\Delta t^2}{2}(L_y^\\Delta)^2 + ... \\right) \\left( I + \\Delta t L_x^\\Delta + \\frac{\\Delta t^2}{2}(L_x^\\Delta)^2 + ... \\right)\n$$\n$$\n= I + \\Delta t L_x^\\Delta + \\Delta t L_y^\\Delta + \\Delta t^2 L_y^\\Delta L_x^\\Delta + \\frac{\\Delta t^2}{2}(L_x^\\Delta)^2 + \\frac{\\Delta t^2}{2}(L_y^\\Delta)^2 + O(\\Delta t^3)\n$$\nThe leading-order local error is characterized by the difference between the approximate and exact operators at order $\\Delta t^2$. This difference is given by the Baker-Campbell-Hausdorff formula, which shows the leading-order error is proportional to the commutator of the operators:\n$$\nE(\\Delta t) = \\frac{\\Delta t^2}{2} (L_y^\\Delta L_x^\\Delta - L_x^\\Delta L_y^\\Delta) + O(\\Delta t^3) = -\\frac{\\Delta t^2}{2} [L_x^\\Delta, L_y^\\Delta]\n$$\nThe problem specifies the splitting as $x$-advection followed by $y$-advection, so the operator is $\\exp(\\Delta t L_y^\\Delta) \\exp(\\Delta t L_x^\\Delta)$. The error is therefore $\\frac{\\Delta t^2}{2}(L_x^\\Delta L_y^\\Delta - L_y^\\Delta L_x^\\Delta) = \\frac{\\Delta t^2}{2}[L_x^\\Delta, L_y^\\Delta]$. The leading-order local error is thus $\\frac{\\Delta t^2}{2}$ times the commutator $[L_x^\\Delta, L_y^\\Delta] = L_x^\\Delta L_y^\\Delta - L_y^\\Delta L_x^\\Delta$.\n\nIn the continuum limit, $\\Delta x \\to 0$ and $\\Delta y \\to 0$, the semi-discrete operators converge to the differential operators $L_x = -a(x,y)\\frac{\\partial}{\\partial x}$ and $L_y = -b(x,y)\\frac{\\partial}{\\partial y}$. The commutator of the discrete operators converges to the commutator of the differential operators:\n$$\n\\lim_{\\Delta x, \\Delta y \\to 0} [L_x^\\Delta, L_y^\\Delta]u = [L_x, L_y]u\n$$\nWe compute this continuum commutator, acting on a sufficiently smooth function $u(x,y)$:\n$$\n[L_x, L_y]u = (L_x L_y - L_y L_x)u\n$$\n$$\nL_x L_y u = \\left(-a \\frac{\\partial}{\\partial x}\\right) \\left(-b \\frac{\\partial u}{\\partial y}\\right) = a \\frac{\\partial}{\\partial x}\\left(b \\frac{\\partial u}{\\partial y}\\right) = a \\left( \\frac{\\partial b}{\\partial x}\\frac{\\partial u}{\\partial y} + b \\frac{\\partial^2 u}{\\partial x \\partial y} \\right) = a b_x u_y + ab u_{xy}\n$$\n$$\nL_y L_x u = \\left(-b \\frac{\\partial}{\\partial y}\\right) \\left(-a \\frac{\\partial u}{\\partial x}\\right) = b \\frac{\\partial}{\\partial y}\\left(a \\frac{\\partial u}{\\partial x}\\right) = b \\left( \\frac{\\partial a}{\\partial y}\\frac{\\partial u}{\\partial x} + a \\frac{\\partial^2 u}{\\partial y \\partial x} \\right) = b a_y u_x + ba u_{yx}\n$$\nAssuming $u$ is smooth, $u_{xy} = u_{yx}$. The commutator is:\n$$\n[L_x, L_y]u = (a b_x u_y + ab u_{xy}) - (b a_y u_x + ba u_{yx}) = a b_x u_y - b a_y u_x\n$$\nThe leading-order splitting error term in the continuum limit is $\\frac{\\Delta t^2}{2} [L_x, L_y]u = \\frac{\\Delta t^2}{2} (a b_x u_y - b a_y u_x)$.\n\nWe now evaluate this term at the point $(x_{*}, y_{*}) = (\\frac{1}{2}, \\frac{1}{2})$ using the initial condition $u(x,y,0) = \\sin(\\pi x)\\cos(\\pi y)$.\nThe required components are:\n-   $a(x,y) = 1 + xy$\n-   $b(x,y) = 1 + x^2$\n-   $a_y = \\frac{\\partial a}{\\partial y} = x$\n-   $b_x = \\frac{\\partial b}{\\partial x} = 2x$\n-   $u_x = \\frac{\\partial u}{\\partial x} = \\pi \\cos(\\pi x)\\cos(\\pi y)$\n-   $u_y = \\frac{\\partial u}{\\partial y} = -\\pi \\sin(\\pi x)\\sin(\\pi y)$\n\nEvaluating these at $(x,y) = (\\frac{1}{2}, \\frac{1}{2})$:\n-   $a(\\frac{1}{2}, \\frac{1}{2}) = 1 + (\\frac{1}{2})(\\frac{1}{2}) = 1 + \\frac{1}{4} = \\frac{5}{4}$\n-   $b(\\frac{1}{2}, \\frac{1}{2}) = 1 + (\\frac{1}{2})^2 = 1 + \\frac{1}{4} = \\frac{5}{4}$\n-   $a_y(\\frac{1}{2}, \\frac{1}{2}) = \\frac{1}{2}$\n-   $b_x(\\frac{1}{2}, \\frac{1}{2}) = 2(\\frac{1}{2}) = 1$\n-   $u_x(\\frac{1}{2}, \\frac{1}{2}, 0) = \\pi \\cos(\\frac{\\pi}{2})\\cos(\\frac{\\pi}{2}) = \\pi(0)(0) = 0$\n-   $u_y(\\frac{1}{2}, \\frac{1}{2}, 0) = -\\pi \\sin(\\frac{\\pi}{2})\\sin(\\frac{\\pi}{2}) = -\\pi(1)(1) = -\\pi$\n\nNow we substitute these values into the error expression. The problem asks for the full error term, which is the leading-order term in the Taylor expansion of the error.\n$$\n\\text{Error Term} = \\frac{\\Delta t^2}{2} (a b_x u_y - b a_y u_x)\n$$\n$$\n= \\frac{\\Delta t^2}{2} \\left[ \\left(\\frac{5}{4}\\right)(1)(-\\pi) - \\left(\\frac{5}{4}\\right)\\left(\\frac{1}{2}\\right)(0) \\right]\n$$\n$$\n= \\frac{\\Delta t^2}{2} \\left[ -\\frac{5\\pi}{4} - 0 \\right] = -\\frac{5\\pi}{8}\\Delta t^2\n$$\nThis is the final analytical expression for the leading-order local error at the specified point.",
            "answer": "$$\n\\boxed{-\\frac{5\\pi}{8}\\Delta t^{2}}\n$$"
        }
    ]
}