{
    "hands_on_practices": [
        {
            "introduction": "The concept of numerical stability is often simplified to the criterion that all amplification factors $g$ must satisfy $|g| \\le 1$. This exercise provides a crucial counterexample, demonstrating that this condition alone is not sufficient to guarantee bounded error growth over long simulations. By constructing a specific scenario with a repeated unit-modulus root, you will analytically derive the linear growth of a small initial error, a signature of weak instability, and gain a deeper appreciation for the subtleties of long-term numerical fidelity .",
            "id": "3415211",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ on a periodic domain, with wave speed $a \\neq 0$. Discretize in space with a uniform grid of spacing $\\Delta x$ indexed by $j \\in \\mathbb{Z}$ and in time with step $\\Delta t$ indexed by $n \\in \\mathbb{Z}$. Use the leapfrog time-centered scheme\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x} = 0,\n$$\nwhich can be written as\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n\\quad \\text{with} \\quad \\mu := \\frac{a\\,\\Delta t}{\\Delta x}.\n$$\nAdopt a Fourier mode ansatz $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,j)$ with $\\kappa := k\\,\\Delta x \\in [-\\pi,\\pi]$ for wavenumber $k \\in \\mathbb{R}$. Assume exact arithmetic yields the amplification polynomial for $\\widehat{u}^{\\,n}$ and that neutral stability means $|g|=1$ for all relevant roots $g$ of this polynomial.\n\nNow, construct a concrete setting that demonstrates that neutral stability does not imply bounded error growth over long time in the presence of rounding errors. To this end, choose the Courant number $\\mu = 1$ and the Fourier wavenumber $\\kappa = \\pi/2$. In this case the amplification polynomial has a repeated unit-modulus root. Suppose the exact solution is identically zero, but the computed initial modal amplitudes are contaminated by a tiny rounding mismatch modeled as\n$$\n\\widehat{u}^{\\,0} = 0, \n\\qquad \n\\widehat{u}^{\\,1} = -\\,i\\,\\varepsilon,\n$$\nwith a fixed $\\varepsilon$ satisfying $0|\\varepsilon|\\ll 1$ representing the projection of the rounding error onto this Fourier mode at the startup.\n\nUsing only the above fundamental setup and the Fourier-mode recurrence implied by the scheme, derive the exact closed-form expression for the modal amplitude $\\widehat{u}^{\\,N}$ after $N$ time steps, expressed in terms of $\\varepsilon$ and $N$. Your final answer must be a single analytic expression. No numerical rounding is required, and no physical units apply.",
            "solution": "The user has provided a problem statement regarding the analysis of weak instability in the leapfrog time-centered numerical scheme.\n\n### Step 1: Problem Validation\n\nThe problem is first subjected to a rigorous validation process.\n\n**Extracted Givens:**\n- **Governing Equation**: $u_{t} + a\\,u_{x} = 0$ with $a \\neq 0$.\n- **Discretization Scheme**: Leapfrog time-centered, $u_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)$, where $\\mu := \\frac{a\\,\\Delta t}{\\Delta x}$.\n- **Analysis Method**: Fourier mode ansatz, $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,j)$, with $\\kappa := k\\,\\Delta x$.\n- **Stability Condition**: Neutral stability is defined as $|g|=1$ for all relevant roots $g$ of the amplification polynomial.\n- **Specific Parameters**: Courant number $\\mu = 1$, normalized wavenumber $\\kappa = \\pi/2$.\n- **Initial Conditions for the Modal Amplitude**: $\\widehat{u}^{\\,0} = 0$ and $\\widehat{u}^{\\,1} = -\\,i\\,\\varepsilon$, where $0  |\\varepsilon| \\ll 1$.\n- **Objective**: Derive the closed-form expression for $\\widehat{u}^{\\,N}$ in terms of $\\varepsilon$ and $N$.\n\n**Validation Verdict:**\nThe problem is **valid**. It is a well-posed, scientifically grounded problem from the field of numerical analysis of partial differential equations. All necessary information is provided, the terminology is precise, and the setup is standard for demonstrating the concept of weak instability in numerical schemes. The problem does not violate any of the criteria for invalidity.\n\n### Step 2: Derivation of the Solution\n\nWe begin with the provided recurrence relation for the leapfrog scheme:\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nWe substitute the Fourier mode ansatz $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,j)$ into this equation:\n$$\n\\widehat{u}^{\\,n+1}\\,\\exp(i\\,\\kappa\\,j) = \\widehat{u}^{\\,n-1}\\,\\exp(i\\,\\kappa\\,j) - \\mu\\left(\\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,(j+1)) - \\widehat{u}^{\\,n}\\,\\exp(i\\,\\kappa\\,(j-1))\\right)\n$$\nDividing the entire equation by the common factor $\\exp(i\\,\\kappa\\,j)$ yields a recurrence relation for the modal amplitudes $\\widehat{u}^{\\,n}$:\n$$\n\\widehat{u}^{\\,n+1} = \\widehat{u}^{\\,n-1} - \\mu\\,\\widehat{u}^{\\,n}\\left(\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa)\\right)\n$$\nUsing Euler's identity, $\\exp(i\\,\\kappa) - \\exp(-i\\,\\kappa) = 2i\\sin(\\kappa)$, the relation becomes:\n$$\n\\widehat{u}^{\\,n+1} = \\widehat{u}^{\\,n-1} - 2i\\mu\\sin(\\kappa)\\,\\widehat{u}^{\\,n}\n$$\nRearranging the terms, we obtain a second-order linear homogeneous recurrence relation with constant coefficients:\n$$\n\\widehat{u}^{\\,n+1} + 2i\\mu\\sin(\\kappa)\\,\\widehat{u}^{\\,n} - \\widehat{u}^{\\,n-1} = 0\n$$\nThe problem specifies the parameters $\\mu = 1$ and $\\kappa = \\pi/2$. We substitute these values into the recurrence. Since $\\sin(\\pi/2) = 1$, the coefficient $2i\\mu\\sin(\\kappa)$ becomes $2i(1)(1) = 2i$. The specific recurrence relation for this case is:\n$$\n\\widehat{u}^{\\,n+1} + 2i\\,\\widehat{u}^{\\,n} - \\widehat{u}^{\\,n-1} = 0\n$$\nTo solve this recurrence, we find the roots of its characteristic polynomial by substituting the trial solution $\\widehat{u}^{\\,n} = g^n$:\n$$\ng^{n+1} + 2i\\,g^n - g^{n-1} = 0\n$$\nAssuming $g \\neq 0$ and dividing by $g^{n-1}$, we get the amplification polynomial:\n$$\ng^2 + 2i\\,g - 1 = 0\n$$\nThis quadratic expression is a perfect square:\n$$\n(g + i)^2 = g^2 + 2ig + i^2 = g^2 + 2ig - 1 = 0\n$$\nThe polynomial has a repeated root $g_{1,2} = -i$. The modulus of this root is $|-i| = 1$, confirming the problem's statement about a repeated unit-modulus root, which corresponds to weak instability.\n\nFor a recurrence relation with a repeated root $g$, the general solution for $\\widehat{u}^{\\,n}$ takes the form:\n$$\n\\widehat{u}^{\\,n} = (C_1 + C_2 n) g^n\n$$\nwhere $C_1$ and $C_2$ are constants to be determined from the initial conditions. Substituting $g = -i$, we have:\n$$\n\\widehat{u}^{\\,n} = (C_1 + C_2 n) (-i)^n\n$$\nThe problem provides the initial conditions representing a small rounding error: $\\widehat{u}^{\\,0} = 0$ and $\\widehat{u}^{\\,1} = -i\\varepsilon$.\nWe apply the condition for $n=0$:\n$$\n\\widehat{u}^{\\,0} = (C_1 + C_2 \\cdot 0) (-i)^0 = C_1 \\cdot 1 = C_1\n$$\nGiven $\\widehat{u}^{\\,0} = 0$, we find that $C_1 = 0$.\n\nNext, we apply the condition for $n=1$:\n$$\n\\widehat{u}^{\\,1} = (C_1 + C_2 \\cdot 1) (-i)^1 = (0 + C_2) (-i) = -i C_2\n$$\nGiven $\\widehat{u}^{\\,1} = -i\\varepsilon$, we equate the expressions:\n$$\n-i C_2 = -i\\varepsilon \\implies C_2 = \\varepsilon\n$$\nHaving found the constants $C_1 = 0$ and $C_2 = \\varepsilon$, we substitute them into the general solution to find the specific solution for the modal amplitude at time step $n$:\n$$\n\\widehat{u}^{\\,n} = (0 + \\varepsilon n) (-i)^n = n \\varepsilon (-i)^n\n$$\nThe problem requests the expression for $\\widehat{u}^{\\,N}$ after $N$ time steps. We simply replace $n$ with $N$:\n$$\n\\widehat{u}^{\\,N} = N \\varepsilon (-i)^N\n$$\nThis result shows that the magnitude of the modal amplitude, $|\\widehat{u}^{\\,N}| = |N \\varepsilon (-i)^N| = N|\\varepsilon|$, grows linearly with the number of time steps $N$. This linear growth, arising from a repeated unit-modulus root in the amplification polynomial, is the hallmark of a weak instability. Despite the scheme being neutrally stable by the $|g|=1$ criterion, a small initial error can be amplified over time, leading to a loss of accuracy in long-time simulations.",
            "answer": "$$\\boxed{N \\varepsilon (-i)^N}$$"
        },
        {
            "introduction": "Having understood the nature of weak instability, a practical question arises: how is the non-physical computational mode excited in the first place? This exercise focuses on the critical start-up phase of the three-level leapfrog scheme, which requires data at two initial time levels. You will analyze a common second-order start-up procedure using a Runge-Kutta method to precisely quantify the amplitude of the computational mode it inadvertently introduces, offering valuable insights into designing initialization methods that minimize such contamination .",
            "id": "3415283",
            "problem": "Consider the constant-coefficient linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ on a periodic domain, discretized on a uniform grid $x_{j} = j\\,\\Delta x$ with time step $\\Delta t$. The leapfrog time-centered scheme with centered space derivative is\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n-1} \\;-\\; \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right),\n$$\nwhere $\\mu \\equiv a\\,\\Delta t/\\Delta x$. It is known that this two-step scheme supports a non-physical computational mode in addition to the physical mode. A practical way to reduce its excitation is to use a second-order start-up procedure to compute $u^{1}$ from $u^{0}$.\n\nAdopt the following start-up: apply the explicit midpoint second-order Runge–Kutta (RK2) method to the semidiscrete ordinary differential equation (ODE) $u_{t} = -a\\,D_{0}\\,u$, where $D_{0}u_{j} \\equiv \\left(u_{j+1}-u_{j-1}\\right)/(2\\,\\Delta x)$, to advance from $t^{0}$ to $t^{1} = t^{0} + \\Delta t$. Then continue with the leapfrog scheme for all subsequent steps.\n\nAssume the initial discrete field is a single Fourier mode $u_{j}^{0} = \\exp(i\\,j\\,\\theta)$ with wavenumber $\\theta \\in [-\\pi,\\pi]$. For this $\\theta$, the leapfrog scheme admits two time-amplification factors $g_{+}(\\theta,\\mu)$ and $g_{-}(\\theta,\\mu)$, corresponding to the physical and computational modes, respectively. After the RK2 start-up produces $u^{1}$, the leapfrog solution can be written as a superposition $u^{n} = A\\,g_{+}^{\\,n} + B\\,g_{-}^{\\,n}$ for appropriate amplitudes $A$ and $B$ determined by $u^{0}$ and $u^{1}$.\n\nDerive, in closed form, the exact amplitude $B(\\mu,\\theta)$ of the computational mode excited by this RK2 start-up, expressed solely in terms of $\\mu$ and $\\theta$. Your final answer must be a single analytic expression for $B(\\mu,\\theta)$ with no unevaluated parameters. No rounding is required. Express trigonometric functions in radians.",
            "solution": "The user wants to find the amplitude of the computational mode generated by a specific start-up procedure for the leapfrog numerical scheme.\n\nLet's break down the problem methodically.\n\nFirst, we analyze the leapfrog scheme itself to determine its amplification factors. The scheme is given by:\n$$\nu_{j}^{n+1} = u_{j}^{n-1} - \\mu\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nwhere $\\mu = a\\Delta t / \\Delta x$. We perform a von Neumann stability analysis by substituting a single Fourier mode solution of the form $u_j^n = g^n e^{ij\\theta}$, where $g$ is the amplification factor per time step and $\\theta$ is the dimensionless wavenumber.\n$$\ng^{n+1}e^{ij\\theta} = g^{n-1}e^{ij\\theta} - \\mu g^n \\left(e^{i(j+1)\\theta} - e^{i(j-1)\\theta}\\right)\n$$\nDividing by $g^{n-1}e^{ij\\theta}$ (assuming $g \\neq 0$), we get:\n$$\ng^2 = 1 - \\mu g \\left(e^{i\\theta} - e^{-i\\theta}\\right)\n$$\nUsing Euler's formula, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$. The equation becomes a characteristic quadratic equation for $g$:\n$$\ng^2 + (2i\\mu\\sin\\theta) g - 1 = 0\n$$\nSolving for $g$ using the quadratic formula yields the two amplification factors, corresponding to the physical and computational modes. We denote them as $g_+$ and $g_-$:\n$$\ng_+(\\mu, \\theta) = -i\\mu\\sin\\theta + \\sqrt{1 - \\mu^2\\sin^2\\theta} \\quad \\text{(physical mode)}\n$$\n$$\ng_-(\\mu, \\theta) = -i\\mu\\sin\\theta - \\sqrt{1 - \\mu^2\\sin^2\\theta} \\quad \\text{(computational mode)}\n$$\nFor the scheme to be stable, the term under the square root must be non-negative, which leads to the Courant-Friedrichs-Lewy (CFL) condition $|\\mu\\sin\\theta| \\le 1$. When this condition holds, $|g_{\\pm}|=1$.\n\nNext, we analyze the start-up procedure to find the solution at the first time step, $u^1$. The procedure uses the explicit midpoint second-order Runge-Kutta (RK2) method on the semi-discretized equation $u_t = -a D_0 u$. For a single Fourier mode $u_j(t) = \\hat{u}(t)e^{ij\\theta}$, the spatial derivative operator acts as:\n$$\n-a D_0 u_j = -a \\frac{u_{j+1} - u_{j-1}}{2\\Delta x} = -a \\frac{\\hat{u}(t)e^{i(j+1)\\theta} - \\hat{u}(t)e^{i(j-1)\\theta}}{2\\Delta x} = -a \\frac{e^{i\\theta}-e^{-i\\theta}}{2\\Delta x} u_j(t) = -a \\frac{2i\\sin\\theta}{2\\Delta x} u_j(t)\n$$\nThis results in an ordinary differential equation (ODE) for the modal amplitude $\\hat{u}(t)$:\n$$\n\\frac{d\\hat{u}}{dt} = \\left(-\\frac{ia\\sin\\theta}{\\Delta x}\\right) \\hat{u} = \\lambda \\hat{u} \\quad \\text{where} \\quad \\lambda = -\\frac{ia\\sin\\theta}{\\Delta x}\n$$\nThe RK2 method for an ODE $y' = f(y)$ is $y^{n+1} = y^n + \\Delta t f(y^n + \\frac{\\Delta t}{2}f(y^n))$. For our linear ODE, this simplifies to:\n$$\n\\hat{u}^1 = \\hat{u}^0 + \\Delta t \\left( \\lambda \\left(\\hat{u}^0 + \\frac{\\Delta t}{2}(\\lambda\\hat{u}^0)\\right) \\right) = \\hat{u}^0 \\left(1 + \\lambda\\Delta t + \\frac{1}{2}(\\lambda\\Delta t)^2 \\right)\n$$\nThe amplification factor for this single RK2 step, which we'll call $G_{RK2}$, is:\n$$\nG_{RK2} = 1 + \\lambda\\Delta t + \\frac{1}{2}(\\lambda\\Delta t)^2\n$$\nSubstituting $\\lambda \\Delta t = -\\frac{ia\\Delta t}{\\Delta x}\\sin\\theta = -i\\mu\\sin\\theta$:\n$$\nG_{RK2} = 1 + (-i\\mu\\sin\\theta) + \\frac{1}{2}(-i\\mu\\sin\\theta)^2 = 1 - i\\mu\\sin\\theta - \\frac{1}{2}\\mu^2\\sin^2\\theta\n$$\nWith the initial condition $u_j^0 = e^{ij\\theta}$, the solution at the first two time levels is:\n$$\nu_j^0 = e^{ij\\theta} \\implies \\hat{u}^0 = 1\n$$\n$$\nu_j^1 = G_{RK2} e^{ij\\theta} \\implies \\hat{u}^1 = G_{RK2}\n$$\n\nThe general solution for the leapfrog scheme is a superposition of its two modes:\n$$\nu_j^n = (A g_+^n + B g_-^n) e^{ij\\theta}\n$$\nwhere $A$ and $B$ are the constant amplitudes of the physical and computational modes, respectively. We find these amplitudes by matching the solution at $n=0$ and $n=1$:\nFor $n=0$: $u_j^0 = (A g_+^0 + B g_-^0)e^{ij\\theta} = (A+B)e^{ij\\theta}$. Comparing with $u_j^0 = e^{ij\\theta}$, we get:\n$$\nA + B = 1 \\quad (1)\n$$\nFor $n=1$: $u_j^1 = (A g_+^1 + B g_-^1)e^{ij\\theta} = (Ag_+ + Bg_-)e^{ij\\theta}$. Comparing with $u_j^1 = G_{RK2} e^{ij\\theta}$, we get:\n$$\nAg_+ + Bg_- = G_{RK2} \\quad (2)\n$$\nWe need to solve this system of two linear equations for $B$. From $(1)$, we have $A = 1 - B$. Substituting this into $(2)$:\n$$\n(1-B)g_+ + Bg_- = G_{RK2}\n$$\n$$\ng_+ - B g_+ + B g_- = G_{RK2}\n$$\n$$\nB(g_- - g_+) = G_{RK2} - g_+\n$$\n$$\nB = \\frac{G_{RK2} - g_+}{g_- - g_+}\n$$\nNow we substitute the expressions for $G_{RK2}$, $g_+$, and $g_-$:\nThe denominator is:\n$$\ng_- - g_+ = (-i\\mu\\sin\\theta - \\sqrt{1 - \\mu^2\\sin^2\\theta}) - (-i\\mu\\sin\\theta + \\sqrt{1 - \\mu^2\\sin^2\\theta}) = -2\\sqrt{1 - \\mu^2\\sin^2\\theta}\n$$\nThe numerator is:\n$$\nG_{RK2} - g_+ = \\left(1 - i\\mu\\sin\\theta - \\frac{1}{2}\\mu^2\\sin^2\\theta\\right) - \\left(-i\\mu\\sin\\theta + \\sqrt{1 - \\mu^2\\sin^2\\theta}\\right)\n$$\n$$\n= 1 - \\frac{1}{2}\\mu^2\\sin^2\\theta - \\sqrt{1 - \\mu^2\\sin^2\\theta}\n$$\nCombining these, we get:\n$$\nB(\\mu, \\theta) = \\frac{1 - \\frac{1}{2}\\mu^2\\sin^2\\theta - \\sqrt{1 - \\mu^2\\sin^2\\theta}}{-2\\sqrt{1 - \\mu^2\\sin^2\\theta}}\n$$\nTo simplify this expression, let $X = \\sqrt{1 - \\mu^2\\sin^2\\theta}$. Then $\\mu^2\\sin^2\\theta = 1 - X^2$. The numerator becomes:\n$$\n1 - \\frac{1}{2}(1 - X^2) - X = 1 - \\frac{1}{2} + \\frac{1}{2}X^2 - X = \\frac{1}{2}X^2 - X + \\frac{1}{2} = \\frac{1}{2}(X^2 - 2X + 1) = \\frac{1}{2}(1 - X)^2\n$$\nThe denominator is simply $-2X$. Thus, the amplitude $B$ is:\n$$\nB = \\frac{\\frac{1}{2}(1 - X)^2}{-2X} = -\\frac{(1-X)^2}{4X}\n$$\nSubstituting back $X = \\sqrt{1 - \\mu^2\\sin^2\\theta}$, we obtain the final expression for the amplitude of the computational mode:\n$$\nB(\\mu, \\theta) = -\\frac{\\left(1 - \\sqrt{1 - \\mu^2\\sin^2\\theta}\\right)^2}{4\\sqrt{1 - \\mu^2\\sin^2\\theta}}\n$$\nThis expression is the exact amplitude of the excited computational mode, given in terms of $\\mu$ and $\\theta$.",
            "answer": "$$\\boxed{-\\frac{\\left(1 - \\sqrt{1 - \\mu^{2}\\sin^{2}(\\theta)}\\right)^{2}}{4\\sqrt{1 - \\mu^{2}\\sin^{2}(\\theta)}}}$$"
        },
        {
            "introduction": "In realistic applications, computational modes may be excited not only at start-up but also by boundary conditions or nonlinear effects, necessitating an active suppression mechanism. This practice simulates a common task for a numerical analyst: calibrating a filter—in this case, the Robert–Asselin filter—to achieve a desired damping rate for the computational mode while respecting a strict tolerance on the phase error introduced into the physical solution. This exercise illuminates the practical trade-offs involved in maintaining both stability and accuracy in numerical simulations .",
            "id": "3415215",
            "problem": "Consider the linear advection partial differential equation (PDE) $u_{t} + c\\,u_{x} = 0$ with constant wave speed $c0$, discretized on a uniform spatial grid with spacing $\\Delta x$ and time step $\\Delta t$ by the leapfrog time-centered scheme with centered spatial differences:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n-1}}{2\\Delta t} + c \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\Delta x} = 0\n$$\nTo suppress the weak instability associated with the leapfrog computational mode, apply after each leapfrog update the Robert–Asselin (RA) filter:\n$$\nu_{j}^{n} \\leftarrow u_{j}^{n} + \\epsilon\\left(u_{j}^{n+1} - 2u_{j}^{n} + u_{j}^{n-1}\\right),\n$$\nwhere $\\epsilon \\in (0,1/2)$ is a dimensionless parameter to be calibrated.\n\nPerform a von Neumann Fourier analysis by considering modes of the form $u_{j}^{n} = \\widehat{u}\\,\\lambda^{n} \\exp(i j \\theta)$, where $\\theta \\in [-\\pi,\\pi]$ is the nondimensional wavenumber and $\\lambda$ is the one-step amplification factor of the composite leapfrog-plus-filter step. Use the following parameter values:\n- Courant number $\\sigma = c\\Delta t/\\Delta x = 0.8$\n- Wavenumber for computational mode analysis: $\\theta = \\pi$\n- Wavenumber for phase error analysis: $\\theta = \\pi/4$\n\nCalibrate $\\epsilon$ by enforcing that the computational mode at $\\theta = \\pi$ decays by a factor of $0.9$ in amplitude per composite time step. Then, verify that the additional phase error per time step induced by the RA filter for the physical mode at $\\theta = \\pi/4$ does not exceed $0.007$ radians.\n\nIf the derived $\\epsilon$ violates the phase-error limit, choose the largest $\\epsilon$ that satisfies the phase-error bound. Otherwise, accept the value imposed by the computational-mode decay. Provide the final value of $\\epsilon$ as a dimensionless number. No rounding is required. All angles must be treated in radians.",
            "solution": "This problem requires calibrating the Robert-Asselin (RA) filter parameter $\\epsilon$ for the leapfrog scheme under specific constraints on stability and accuracy.\n\n### 1. Derive the Composite Amplification Relation\nThe analysis is performed on the combined leapfrog-filter scheme. Let's analyze the sequence of operations in Fourier space.\nThe semi-discrete equation in Fourier space is $\\frac{d\\widehat{u}}{dt} = -ic\\frac{\\sin(k\\Delta x)}{\\Delta x}\\widehat{u}$.\nThe leapfrog scheme is $\\frac{\\widehat{u}^{n+1}-\\widehat{u}^{n-1}}{2\\Delta t} = -ic\\frac{\\sin\\theta}{\\Delta x}\\widehat{u}^n$, where $\\theta=k\\Delta x$.\nThis can be written as $\\widehat{u}^{n+1} = \\widehat{u}^{n-1} - i(2\\sigma\\sin\\theta)\\widehat{u}^n$, where $\\sigma = c\\Delta t/\\Delta x$ is the Courant number. Let $\\nu = 2\\sigma\\sin\\theta$.\n1.  Leapfrog step: $\\widehat{u}^{n+1} = \\widehat{u}^{n-1} - i\\nu\\widehat{u}^n$.\n2.  RA filter: $\\widehat{u}_{f}^n = \\widehat{u}^n + \\epsilon(\\widehat{u}^{n+1} - 2\\widehat{u}^n + \\widehat{u}^{n-1})$. The subscript 'f' denotes the filtered value.\n3.  Next leapfrog step: $\\widehat{u}^{n+2} = \\widehat{u}_{f}^n - i\\nu\\widehat{u}^{n+1}$.\n\nWe combine these to get a single recurrence involving only non-filtered values.\nFirst, substitute $\\widehat{u}_{f}^n$ from (2) into (3):\n$\\widehat{u}^{n+2} = (1-2\\epsilon)\\widehat{u}^n + \\epsilon(\\widehat{u}^{n+1} + \\widehat{u}^{n-1}) - i\\nu\\widehat{u}^{n+1}$.\nFrom (1), we express the oldest term $\\widehat{u}^{n-1} = \\widehat{u}^{n+1} + i\\nu\\widehat{u}^n$. Substitute this into the equation for $\\widehat{u}^{n+2}$:\n$\\widehat{u}^{n+2} = (1-2\\epsilon)\\widehat{u}^n + \\epsilon(\\widehat{u}^{n+1} + (\\widehat{u}^{n+1} + i\\nu\\widehat{u}^n)) - i\\nu\\widehat{u}^{n+1}$\n$\\widehat{u}^{n+2} = (1-2\\epsilon + i\\epsilon\\nu)\\widehat{u}^n + (2\\epsilon - i\\nu)\\widehat{u}^{n+1}$.\nBy setting $\\widehat{u}^n = \\lambda^n$, we obtain the characteristic polynomial for the amplification factor $\\lambda$:\n$$\n\\lambda^2 - (2\\epsilon - i\\nu)\\lambda - (1-2\\epsilon+i\\epsilon\\nu) = 0\n$$\n\n### 2. Calibrate $\\epsilon$ using the Computational Mode\nWe analyze the case $\\theta=\\pi$. Here, $\\sin\\theta = 0$, so $\\nu = 2\\sigma\\sin\\pi = 0$. The characteristic polynomial simplifies to:\n$$\n\\lambda^2 - 2\\epsilon\\lambda - (1 - 2\\epsilon) = 0\n$$\nThe roots are given by the quadratic formula:\n$\\lambda = \\frac{2\\epsilon \\pm \\sqrt{(-2\\epsilon)^2 - 4(1)(-(1-2\\epsilon))}}{2} = \\epsilon \\pm \\sqrt{\\epsilon^2 + 1 - 2\\epsilon} = \\epsilon \\pm \\sqrt{(1-\\epsilon)^2}$.\nSince $\\epsilon \\in (0, 1/2)$, $1-\\epsilon > 0$, so $\\sqrt{(1-\\epsilon)^2} = 1-\\epsilon$.\nThe two roots are:\n$\\lambda_p = \\epsilon + (1-\\epsilon) = 1$ (physical mode).\n$\\lambda_c = \\epsilon - (1-\\epsilon) = 2\\epsilon - 1$ (computational mode).\n\nThe problem requires the computational mode to decay by a factor of $0.9$ per step. This means its amplification factor's magnitude must be $0.9$:\n$|\\lambda_c| = |2\\epsilon - 1| = 0.9$.\nSince $\\epsilon \\in (0, 1/2)$, $2\\epsilon-1$ is negative. Thus, $|2\\epsilon-1| = -(2\\epsilon-1) = 1-2\\epsilon$.\n$1 - 2\\epsilon = 0.9 \\implies 2\\epsilon = 0.1 \\implies \\epsilon = 0.05$.\nThis value is in the specified range $(0, 1/2)$.\n\n### 3. Analyze the Phase Error\nWe need to find the phase of the physical mode $\\lambda_p$ and find the perturbation due to $\\epsilon$ to leading order. The roots of the general characteristic equation are $\\lambda = (\\epsilon-i\\nu/2) \\pm \\sqrt{1 - (\\nu/2)^2 - (2\\epsilon-\\epsilon^2)}$.\nLet $\\phi = \\nu/2 = \\sigma\\sin\\theta$. The physical root is $\\lambda_p = (\\epsilon-i\\phi) + \\sqrt{1 - \\phi^2 - (2\\epsilon-\\epsilon^2)}$.\nFor small $\\epsilon$, we expand the square root:\n$\\sqrt{1 - \\phi^2 - (2\\epsilon-\\epsilon^2)} \\approx \\sqrt{1 - \\phi^2}\\left(1 - \\frac{2\\epsilon}{1-\\phi^2}\\right)^{1/2} \\approx \\sqrt{1 - \\phi^2}\\left(1 - \\frac{\\epsilon}{1-\\phi^2}\\right) = \\sqrt{1-\\phi^2} - \\frac{\\epsilon}{\\sqrt{1-\\phi^2}}$.\nSo, $\\lambda_p(\\epsilon) \\approx (\\epsilon - i\\phi) + \\sqrt{1-\\phi^2} - \\frac{\\epsilon}{\\sqrt{1-\\phi^2}} = \\underbrace{(\\sqrt{1-\\phi^2} - i\\phi)}_{\\lambda_p(0)} + \\epsilon\\left(1 - \\frac{1}{\\sqrt{1-\\phi^2}}\\right)$.\nThe phase perturbation is given by $\\Delta\\Phi \\approx \\text{Im}\\left(\\frac{\\delta\\lambda_p}{\\lambda_p(0)}\\right)$, where $\\delta\\lambda_p$ is the $O(\\epsilon)$ term. Since $|\\lambda_p(0)|=1$ for stable modes, $\\frac{1}{\\lambda_p(0)} = \\overline{\\lambda_p(0)} = \\sqrt{1-\\phi^2} + i\\phi$.\n$\\Delta\\Phi \\approx \\text{Im}\\left[ \\epsilon\\left(1 - \\frac{1}{\\sqrt{1-\\phi^2}}\\right) (\\sqrt{1-\\phi^2} + i\\phi) \\right] = \\epsilon\\phi\\left(1 - \\frac{1}{\\sqrt{1-\\phi^2}}\\right)$.\n\nThe phase error constraint is $|\\Delta\\Phi| \\le 0.007$ at $\\theta = \\pi/4$.\nWith $\\sigma=0.8$, we calculate $\\phi$:\n$\\phi = \\sigma\\sin\\theta = 0.8\\sin(\\pi/4) = 0.8 \\frac{\\sqrt{2}}{2} = 0.4\\sqrt{2}$.\nSince $\\phi^2 = (0.4\\sqrt{2})^2 = 0.32  1$, the unfiltered scheme is stable. The magnitude of the phase error is:\n$|\\Delta\\Phi| = \\left|\\epsilon\\phi\\left(1 - \\frac{1}{\\sqrt{1-\\phi^2}}\\right)\\right| = \\epsilon\\phi\\left(\\frac{1}{\\sqrt{1-\\phi^2}} - 1\\right)$.\nThe constraint becomes: $\\epsilon \\le \\frac{0.007}{\\phi(\\frac{1}{\\sqrt{1-\\phi^2}}-1)}$.\nLet's evaluate the bound:\n$\\phi = 0.4\\sqrt{2} \\approx 0.565685$.\nThe term in the parenthesis is $\\frac{1}{\\sqrt{1-0.32}} - 1 = \\frac{1}{\\sqrt{0.68}} - 1 \\approx \\frac{1}{0.82462} - 1 \\approx 1.21268 - 1 = 0.21268$.\nThe denominator of the bound on $\\epsilon$ is $\\approx 0.565685 \\times 0.21268 \\approx 0.12032$.\nSo, $\\epsilon \\le \\frac{0.007}{0.12032} \\approx 0.058178$.\n\n### 4. Final Decision on $\\epsilon$\n1.  The computational mode decay requirement gives $\\epsilon = 0.05$.\n2.  The phase error limit requires $\\epsilon \\le 0.058178...$.\n\nThe value $\\epsilon=0.05$ satisfies the phase error constraint ($0.05  0.058178...$).\nAccording to the problem statement, since the value derived from the decay constraint does not violate the phase-error limit, we accept it.\nThe final value for the parameter is $\\epsilon = 0.05$.",
            "answer": "$$\\boxed{0.05}$$"
        }
    ]
}