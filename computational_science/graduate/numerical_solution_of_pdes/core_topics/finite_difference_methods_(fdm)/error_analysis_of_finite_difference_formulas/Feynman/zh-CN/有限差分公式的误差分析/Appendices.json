{
    "hands_on_practices": [
        {
            "introduction": "分析和构建有限差分公式的基石是泰勒级数展开。本练习提供了一个应用这一基本工具的实践机会。通过建立并求解一组关于模板系数的线性方程组，您将从第一性原理出发，推导出一个三阶精度的单边差分格式，这是数值方法中的一项核心技能 。",
            "id": "3386969",
            "problem": "考虑一个光滑函数 $u(x)$，它在间距为 $h>0$ 的均匀网格上的节点 $x_{j}=x_{0}+j h$（其中 $j\\in\\{0,1,2,3\\}$）处被采样。你需要寻找一个单边有限差分公式，该公式仅使用函数值 $\\{u(x_{0}),u(x_{1}),u(x_{2}),u(x_{3})\\}$ 来近似一阶导数 $u'(x_{0})$。假设 $u$ 充分可微，以便围绕 $x_{0}$ 的泰勒级数展开是有效的。\n\n从 $u(x_{0}+j h)$ 关于 $x_{0}$ 的泰勒级数定义出发，并根据对 $u'(x_{0})$ 的相容有限差分近似必须与泰勒展开逐项匹配的要求，构造系数 $c_{0},c_{1},c_{2},c_{3}\\in\\mathbb{R}$，使得单边模板\n$$\n\\frac{1}{h}\\sum_{j=0}^{3} c_{j}\\,u(x_{0}+j h)\n$$\n对于 $u'(x_{0})$ 是三阶精确的，这意味着局部截断误差为 $\\mathcal{O}(h^{3})$。\n\n然后，验证直至并包括包含 $u^{(3)}(x_{0})$ 的项的矩条件，并显式计算由局部截断误差的主项定义的截断误差常数 $C$\n$$\n\\frac{1}{h}\\sum_{j=0}^{3} c_{j}\\,u(x_{0}+j h)-u'(x_{0}) \\;=\\; C\\,h^{3}\\,u^{(4)}(x_{0})\\;+\\;\\mathcal{O}(h^{4}).\n$$\n\n将你的最终结果以单行矩阵的形式报告，其中包含系数和截断误差常数，顺序为 $(c_{0},\\,c_{1},\\,c_{2},\\,c_{3},\\,C)$。无需四舍五入；请提供精确的有理数值。答案必须是无单位的，并以精确形式表示。",
            "solution": "所述问题在科学上是合理的、适定的和客观的。它提出了数值分析中的一个标准任务：使用基于泰勒级数展开的待定系数法推导有限差分公式。该问题提供了得出唯一解所需的所有信息和约束。因此，我们着手进行推导。\n\n我们的任务是找到系数 $c_0, c_1, c_2, c_3$，使得单边有限差分公式\n$$\nL[u] = \\frac{1}{h}\\sum_{j=0}^{3} c_{j}\\,u(x_{0}+j h)\n$$\n以三阶精度近似一阶导数 $u'(x_{0})$。这意味着局部截断误差 $\\tau = L[u] - u'(x_0)$ 必须为 $\\mathcal{O}(h^3)$ 阶。\n\n为了确定这些系数，我们将每一项 $u(x_0 + jh)$ 在点 $x_0$ 附近展开成泰勒级数。假设 $u$ 足够光滑，我们有：\n$$\nu(x_0+jh) = u(x_0) + (jh)u'(x_0) + \\frac{(jh)^2}{2!}u''(x_0) + \\frac{(jh)^3}{3!}u'''(x_0) + \\frac{(jh)^4}{4!}u^{(4)}(x_0) + \\mathcal{O}(h^5)\n$$\n将此展开式代入 $L[u]$ 的公式中，得到：\n$$\nL[u] = \\frac{1}{h} \\sum_{j=0}^{3} c_j \\left( u(x_0) + jhu'(x_0) + \\frac{j^2h^2}{2}u''(x_0) + \\frac{j^3h^3}{6}u'''(x_0) + \\frac{j^4h^4}{24}u^{(4)}(x_0) + \\mathcal{O}(h^5) \\right)\n$$\n我们可以按照在 $x_0$ 处求值的 $u$ 的各阶导数对各项进行重新分组：\n$$\nL[u] = \\left(\\frac{1}{h}\\sum_{j=0}^{3} c_j\\right) u(x_0) + \\left(\\sum_{j=0}^{3} jc_j\\right) u'(x_0) + \\left(\\frac{h}{2}\\sum_{j=0}^{3} j^2c_j\\right) u''(x_0) + \\left(\\frac{h^2}{6}\\sum_{j=0}^{3} j^3c_j\\right) u'''(x_0) + \\left(\\frac{h^3}{24}\\sum_{j=0}^{3} j^4c_j\\right) u^{(4)}(x_0) + \\mathcal{O}(h^4)\n$$\n为了使 $L[u]$ 成为 $u'(x_0)$ 的一个截断误差为 $\\mathcal{O}(h^3)$ 的相容近似，$L[u]$ 展开式中各阶导数的系数必须与 $u'(x_0)$ 本身展开式中的系数相匹配，后者就是 $1 \\cdot u'(x_0)$。具体来说，我们要求：\n\\begin{enumerate}\n    \\item $u(x_0)$ 的系数必须为 $0$：$\\frac{1}{h}\\sum_{j=0}^{3} c_j = 0 \\implies \\sum_{j=0}^{3} c_j = 0$。\n    \\item $u'(x_0)$ 的系数必须为 $1$：$\\sum_{j=0}^{3} jc_j = 1$。\n    \\item $u''(x_0)$ 的系数必须为 $0$：$\\frac{h}{2}\\sum_{j=0}^{3} j^2c_j = 0 \\implies \\sum_{j=0}^{3} j^2c_j = 0$。\n    \\item $u'''(x_0)$ 的系数必须为 $0$：$\\frac{h^2}{6}\\sum_{j=0}^{3} j^3c_j = 0 \\implies \\sum_{j=0}^{3} j^3c_j = 0$。\n\\end{enumerate}\n这四个条件构成了三阶精度所需的矩条件，并产生了一个关于四个未知系数 $c_0, c_1, c_2, c_3$ 的四元线性方程组：\n\\begin{align*}\n    1 \\cdot c_0 + 1 \\cdot c_1 + 1 \\cdot c_2 + 1 \\cdot c_3 = 0 \\\\\n    0 \\cdot c_0 + 1 \\cdot c_1 + 2 \\cdot c_2 + 3 \\cdot c_3 = 1 \\\\\n    0^2 \\cdot c_0 + 1^2 \\cdot c_1 + 2^2 \\cdot c_2 + 3^2 \\cdot c_3 = 0 \\\\\n    0^3 \\cdot c_0 + 1^3 \\cdot c_1 + 2^3 \\cdot c_2 + 3^3 \\cdot c_3 = 0\n\\end{align*}\n该方程组简化为：\n\\begin{align*}\n    c_0 + c_1 + c_2 + c_3 = 0 \\\\\n    c_1 + 2c_2 + 3c_3 = 1 \\\\\n    c_1 + 4c_2 + 9c_3 = 0 \\\\\n    c_1 + 8c_2 + 27c_3 = 0\n\\end{align*}\n我们先解关于 $c_1, c_2, c_3$ 的子系统。将第三和第四个方程减去第二个方程，得到：\n\\begin{align*}\n    (c_1 + 4c_2 + 9c_3) - (c_1 + 2c_2 + 3c_3) = 0 - 1 \\implies 2c_2 + 6c_3 = -1 \\\\\n    (c_1 + 8c_2 + 27c_3) - (c_1 + 2c_2 + 3c_3) = 0 - 1 \\implies 6c_2 + 24c_3 = -1\n\\end{align*}\n我们现在得到了一个关于 $c_2$ 和 $c_3$ 的 $2 \\times 2$ 方程组。将这些新方程中的第一个乘以 $3$ 得到 $6c_2 + 18c_3 = -3$。从第二个方程 $6c_2 + 24c_3 = -1$ 中减去此方程，得出：\n$$\n(6c_2 + 24c_3) - (6c_2 + 18c_3) = -1 - (-3) \\implies 6c_3 = 2 \\implies c_3 = \\frac{1}{3}\n$$\n将 $c_3 = 1/3$ 代回 $2c_2 + 6c_3 = -1$ 中：\n$$\n2c_2 + 6\\left(\\frac{1}{3}\\right) = -1 \\implies 2c_2 + 2 = -1 \\implies 2c_2 = -3 \\implies c_2 = -\\frac{3}{2}\n$$\n将 $c_2 = -3/2$ 和 $c_3 = 1/3$ 代回 $c_1 + 2c_2 + 3c_3 = 1$ 中：\n$$\nc_1 + 2\\left(-\\frac{3}{2}\\right) + 3\\left(\\frac{1}{3}\\right) = 1 \\implies c_1 - 3 + 1 = 1 \\implies c_1 = 3\n$$\n最后，我们从第一个方程 $c_0 + c_1 + c_2 + c_3 = 0$ 中求出 $c_0$：\n$$\nc_0 + 3 - \\frac{3}{2} + \\frac{1}{3} = 0 \\implies c_0 + \\frac{18-9+2}{6} = 0 \\implies c_0 + \\frac{11}{6} = 0 \\implies c_0 = -\\frac{11}{6}\n$$\n因此，系数为 $c_0 = -11/6$，$c_1 = 3$，$c_2 = -3/2$ 和 $c_3 = 1/3$。对直至包含 $u^{(3)}(x_0)$ 的项的矩条件的验证已内含在此推导过程中，因为我们已经显式地强制它们得到满足。\n\n现在，我们计算截断误差常数 $C$。局部截断误差为 $\\tau = L[u] - u'(x_0)$。使用已确定的系数，包含 $u(x_0)$、$u'(x_0)$、$u''(x_0)$ 和 $u'''(x_0)$ 的项都被正确处理，因此主误差项是泰勒展开中的下一项：\n$$\n\\tau = \\left(\\frac{h^3}{24}\\sum_{j=0}^{3} j^4c_j\\right) u^{(4)}(x_0) + \\mathcal{O}(h^4)\n$$\n问题将截断误差常数 $C$ 定义为 $\\tau = C h^3 u^{(4)}(x_0) + \\mathcal{O}(h^4)$。比较这两种形式，我们发现：\n$$\nC = \\frac{1}{24}\\sum_{j=0}^{3} j^4c_j\n$$\n我们计算这个和：\n$$\n\\sum_{j=0}^{3} j^4c_j = 0^4 c_0 + 1^4 c_1 + 2^4 c_2 + 3^4 c_3 = c_1 + 16c_2 + 81c_3\n$$\n代入系数的值：\n$$\n\\sum_{j=0}^{3} j^4c_j = 3 + 16\\left(-\\frac{3}{2}\\right) + 81\\left(\\frac{1}{3}\\right) = 3 - 24 + 27 = 6\n$$\n因此，常数 $C$ 为：\n$$\nC = \\frac{1}{24}(6) = \\frac{1}{4}\n$$\n所求的值是系数 $c_0, c_1, c_2, c_3$ 和截断误差常数 $C$。\n$c_0 = -11/6$\n$c_1 = 3$\n$c_2 = -3/2$\n$c_3 = 1/3$\n$C = 1/4$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{11}{6}  3  -\\frac{3}{2}  \\frac{1}{3}  \\frac{1}{4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然标准差分格式被广泛使用，但理解其局限性以及高阶格式的设计对于精确模拟至关重要。本练习对三种不同的二阶导数近似格式进行比较分析。通过推导它们的主截断误差系数，您将深入了解增加模板宽度或使用紧致格式如何能够实现更高的精度 。",
            "id": "3386971",
            "problem": "设 $u(x)$ 是一个在包含点 $x_{i}$ 的开区间上足够光滑的函数，并设 $\\{x_{i+k}\\}_{k\\in\\mathbb{Z}}$ 是一个间距为 $h>0$ 的均匀网格，其中 $x_{i\\pm k}=x_{i}\\pm k h$。记 $u^{(m)}(x)$ 为 $u$ 在 $x$ 处的 $m$ 阶导数。考虑在偏微分方程 (PDE) 的数值解中用于逼近二阶导数 $u_{xx}(x_{i})$ 的三种对称有限差分格式：\n\n1. 标准的三点中心差分算子\n$$\nD^{(2)}_{3} u(x_{i}) \\equiv \\frac{u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})}{h^{2}}.\n$$\n\n2. 一个形如下式的五点显式对称模板\n$$\nD^{(2)}_{5} u(x_{i}) \\equiv \\frac{1}{h^{2}}\\big( a\\,u(x_{i-2}) + b\\,u(x_{i-1}) + c\\,u(x_{i}) + b\\,u(x_{i+1}) + a\\,u(x_{i+2}) \\big),\n$$\n其中实系数 $a$、$b$ 和 $c$ 将通过强制与 $u_{xx}(x_{i})$ 的相容性并在对称性和光滑性假设下最大化形式精度阶来确定。\n\n3. 一个（在隐式有限差分意义上的）四阶紧致三对角格式，它通过以下关系定义了一个旨在逼近 $u_{xx}(x_{i})$ 的序列 $\\{q_{i}\\}$\n$$\n\\alpha\\, q_{i-1} + q_{i} + \\alpha\\, q_{i+1} \\;=\\; \\frac{\\beta}{h^{2}}\\big(u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\\big),\n$$\n其中实常数 $\\alpha$ 和 $\\beta$ 的选择使得 $q_{i}$ 在对称性和光滑性假设下达到最高可能的形式阶；然后将 $q_{i}$ 作为 $u_{xx}(x_{i})$ 的近似值。\n\n从 $u(x_{i\\pm k})$ 关于 $x_{i}$ 的泰勒级数展开出发，推导每种格式的主阶截断误差项。具体来说，对于这三种格式中的每一种，提取在 $x_{i}$ 处近似二阶导数的局部截断误差展开式中乘以 $h^{2} u^{(4)}(x_{i})$ 的系数。将这三个主误差常数，按上面列出的顺序，表示为精确的有理数。然后，简要讨论你的结果对于旨在消除主 $h^{2}$ 误差项的理查森外推法（Richardson extrapolation）的可行性的影响。\n\n你的最终答案必须是一个单行矩阵，包含对应于三种格式的三个常数，每个常数都精确表示为分数。不需要四舍五入，也不涉及单位。",
            "solution": "在均匀网格上进行有限差分公式误差分析的基础是泰勒级数展开。对于 $k\\in\\mathbb{Z}$，将 $u(x_{i\\pm k})$ 在 $x_{i}$ 处展开：\n$$\nu(x_{i\\pm k}) \\;=\\; u(x_{i})\n\\;\\pm\\; k h\\,u^{\\prime}(x_{i})\n\\;+\\; \\frac{(k h)^{2}}{2}\\,u^{\\prime\\prime}(x_{i})\n\\;\\pm\\; \\frac{(k h)^{3}}{6}\\,u^{(3)}(x_{i})\n\\;+\\; \\frac{(k h)^{4}}{24}\\,u^{(4)}(x_{i})\n\\;\\pm\\; \\frac{(k h)^{5}}{120}\\,u^{(5)}(x_{i})\n\\;+\\; \\frac{(k h)^{6}}{720}\\,u^{(6)}(x_{i})\n\\;+\\; \\cdots.\n$$\n根据对称性，奇数阶项在对称模板中会相互抵消，截断误差可以从偶数阶项中读出。\n\n格式1（三点中心差分）。计算\n$$\nD^{(2)}_{3} u(x_{i}) \\;=\\; \\frac{u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})}{h^{2}}.\n$$\n使用 $k=1$ 时的展开式：\n\\begin{align*}\nu(x_{i+1}) + u(x_{i-1})\n= 2 u(x_{i}) + h^{2} u^{\\prime\\prime}(x_{i}) + \\frac{h^{4}}{12} u^{(4)}(x_{i}) + \\frac{h^{6}}{360} u^{(6)}(x_{i}) + \\cdots,\\\\\nu(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\n= h^{2} u^{\\prime\\prime}(x_{i}) + \\frac{h^{4}}{12} u^{(4)}(x_{i}) + \\frac{h^{6}}{360} u^{(6)}(x_{i}) + \\cdots,\n\\end{align*}\n所以\n$$\nD^{(2)}_{3} u(x_{i}) \\;=\\; u^{\\prime\\prime}(x_{i}) + \\frac{h^{2}}{12} u^{(4)}(x_{i}) + \\frac{h^{4}}{360} u^{(6)}(x_{i}) + \\cdots.\n$$\n因此，主截断误差为 $+\\frac{h^{2}}{12} u^{(4)}(x_{i})$，局部截断误差中乘以 $u^{(4)}(x_{i})$ 的常数为 $\\frac{1}{12}$。\n\n格式2（五点显式对称模板）。考虑\n$$\nD^{(2)}_{5} u(x_{i}) \\;=\\; \\frac{1}{h^{2}}\\big( a\\,u(x_{i-2}) + b\\,u(x_{i-1}) + c\\,u(x_{i}) + b\\,u(x_{i+1}) + a\\,u(x_{i+2}) \\big),\n$$\n其中选择 $a, b, c$ 以达到四阶精度。使用 $k=1,2$ 时的泰勒展开式：\n\\begin{align*}\nu(x_{i\\pm 1}) = u(x_{i}) \\pm h u^{\\prime}(x_{i}) + \\frac{h^{2}}{2} u^{\\prime\\prime}(x_{i}) \\pm \\frac{h^{3}}{6} u^{(3)}(x_{i}) + \\frac{h^{4}}{24} u^{(4)}(x_{i}) \\pm \\frac{h^{5}}{120} u^{(5)}(x_{i}) + \\frac{h^{6}}{720} u^{(6)}(x_{i}) + \\cdots,\\\\\nu(x_{i\\pm 2}) = u(x_{i}) \\pm 2 h u^{\\prime}(x_{i}) + \\frac{(2 h)^{2}}{2} u^{\\prime\\prime}(x_{i}) \\pm \\frac{(2 h)^{3}}{6} u^{(3)}(x_{i}) + \\frac{(2 h)^{4}}{24} u^{(4)}(x_{i}) \\pm \\frac{(2 h)^{5}}{120} u^{(5)}(x_{i}) + \\frac{(2 h)^{6}}{720} u^{(6)}(x_{i}) + \\cdots\\\\\n= u(x_{i}) \\pm 2 h u^{\\prime}(x_{i}) + 2 h^{2} u^{\\prime\\prime}(x_{i}) \\pm \\frac{4 h^{3}}{3} u^{(3)}(x_{i}) + \\frac{2 h^{4}}{3} u^{(4)}(x_{i}) \\pm \\frac{4 h^{5}}{15} u^{(5)}(x_{i}) + \\frac{8 h^{6}}{45} u^{(6)}(x_{i}) + \\cdots.\n\\end{align*}\n根据对称性，奇数项在 $D^{(2)}_{5}$ 中相互抵消。收集偶数项，我们要求相容性条件使得\n$$\nD^{(2)}_{5} u(x_{i}) \\;=\\; u^{\\prime\\prime}(x_{i}) + \\mathcal{O}(h^{4}).\n$$\n匹配 $u(x_{i})$ 项得到零和条件\n$$\n2 a + 2 b + c \\;=\\; 0.\n$$\n匹配 $u^{\\prime\\prime}(x_{i})$ 项得到\n$$\n\\frac{1}{h^{2}}\\left( a \\cdot 2 h^{2} \\cdot 2 + b \\cdot h^{2} \\right) \\;=\\; 1 u^{\\prime\\prime}(x_{i})\n\\;\\;\\Longrightarrow\\;\\; 4 a + b \\;=\\; 1.\n$$\n为达到四阶精度，$u^{(4)}(x_{i})$ 项必须为零：\n$$\n\\frac{1}{h^{2}}\\left( a \\cdot \\frac{(2h)^4}{24} \\cdot 2 + b \\cdot \\frac{h^4}{24} \\cdot 2 \\right) = 0 \\cdot u^{(4)}(x_i)\n\\;\\;\\Longrightarrow\\;\\; \\frac{4}{3} a + \\frac{1}{12} b \\;=\\; 0.\n$$\n求解线性方程组\n$$\n\\begin{cases}\n2 a + 2 b + c = 0,\\\\\n4 a + b = 1,\\\\\n16a + b = 0,\n\\end{cases}\n$$\n第三个方程给出 $b = -16 a$。代入 $4 a + b = 1$ 得到 $4 a - 16 a = 1$，所以 $-12 a = 1$ 且 $a = -\\frac{1}{12}$。然后 $b = -16 a = \\frac{4}{3}$，并从零和条件得到 $c = -2 a - 2 b = -2\\left(-\\frac{1}{12}\\right) - 2\\left(\\frac{4}{3}\\right) = \\frac{1}{6} - \\frac{8}{3} = -\\frac{5}{2}$。因此\n$$\nD^{(2)}_{5} u(x_{i}) \\;=\\; \\frac{1}{h^{2}}\\left( -\\frac{1}{12} u(x_{i-2}) + \\frac{4}{3} u(x_{i-1}) - \\frac{5}{2} u(x_{i}) + \\frac{4}{3} u(x_{i+1}) - \\frac{1}{12} u(x_{i+2}) \\right).\n$$\n根据构造，$h^{2} u^{(4)}(x_{i})$ 项为零，所以主截断误差项涉及 $h^{4} u^{(6)}(x_{i})$。直接的矩计算证实 $u^{(6)}$ 的系数是 $-\\frac{1}{90}$，但对于当前问题，乘以 $h^{2} u^{(4)}(x_{i})$ 的系数是 $0$。\n\n格式3（四阶紧致三对角格式）。通过下式定义 $\\{q_{i}\\}$\n$$\n\\alpha\\, q_{i-1} + q_{i} + \\alpha\\, q_{i+1} \\;=\\; \\frac{\\beta}{h^{2}}\\big(u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\\big),\n$$\n并选择 $\\alpha$ 和 $\\beta$ 以最大化形式阶。为确定 $\\alpha$ 和 $\\beta$，将 $q_{i}$ 替换为精确的 $u^{\\prime\\prime}(x_{i})$，并强制泰勒级数系数相等直到 $h^{2}$ 阶项。展开\n\\begin{align*}\nu^{\\prime\\prime}(x_{i\\pm 1}) = u^{\\prime\\prime}(x_{i}) \\pm h\\,u^{(3)}(x_{i}) + \\frac{h^{2}}{2} u^{(4)}(x_{i}) \\pm \\frac{h^{3}}{6} u^{(5)}(x_{i}) + \\frac{h^{4}}{24} u^{(6)}(x_{i}) + \\cdots,\\\\\nu(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1}) = h^{2} u^{\\prime\\prime}(x_{i}) + \\frac{h^{4}}{12} u^{(4)}(x_{i}) + \\frac{h^{6}}{360} u^{(6)}(x_{i}) + \\cdots.\n\\end{align*}\n因此\n\\begin{align*}\n\\alpha \\big( u^{\\prime\\prime}(x_{i-1}) + u^{\\prime\\prime}(x_{i+1}) \\big) + u^{\\prime\\prime}(x_{i})\n= (2 \\alpha + 1) u^{\\prime\\prime}(x_{i}) + \\alpha h^{2} u^{(4)}(x_{i}) + \\frac{\\alpha h^{4}}{12} u^{(6)}(x_{i}) + \\cdots,\\\\\n\\frac{\\beta}{h^{2}} \\big(u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\\big)\n= \\beta u^{\\prime\\prime}(x_{i}) + \\frac{\\beta h^{2}}{12} u^{(4)}(x_{i}) + \\frac{\\beta h^{4}}{360} u^{(6)}(x_{i}) + \\cdots.\n\\end{align*}\n令系数相等直到 $h^{2}$ 阶项，得到\n$$\n2 \\alpha + 1 = \\beta, \\qquad \\alpha = \\frac{\\beta}{12}.\n$$\n求解得到\n$$\n\\beta = \\frac{6}{5}, \\qquad \\alpha = \\frac{1}{10}.\n$$\n因此该紧致关系与 $u^{\\prime\\prime}(x_{i})$ 相容，没有 $h^{2} u^{(4)}(x_{i})$ 的差异；$q_{i}$ 的主截断误差是 $h^{4}$ 阶的，因此乘以 $h^{2} u^{(4)}(x_{i})$ 的系数是 $0$。为了完整性，可以通过假定 $q_{i} = u^{\\prime\\prime}(x_{i}) + c h^{4} u^{(6)}(x_{i}) + \\cdots$，代入紧致关系，并匹配 $h^{4} u^{(6)}(x_{i})$ 项来确定 $q_{i}$ 中的 $h^{4} u^{(6)}(x_{i})$ 系数：\n\\begin{align*}\n\\alpha \\big( q_{i-1} + q_{i+1} \\big) + q_{i}\n= (2\\alpha + 1) u^{\\prime\\prime}(x_{i}) + \\alpha h^{2} u^{(4)}(x_{i}) + \\left( \\frac{\\alpha}{12} + c (2 \\alpha + 1) \\right) h^{4} u^{(6)}(x_{i}) + \\cdots,\\\\\n\\frac{\\beta}{h^{2}} \\big(u(x_{i+1}) - 2 u(x_{i}) + u(x_{i-1})\\big)\n= \\beta u^{\\prime\\prime}(x_{i}) + \\frac{\\beta h^{2}}{12} u^{(4)}(x_{i}) + \\frac{\\beta h^{4}}{360} u^{(6)}(x_{i}) + \\cdots,\n\\end{align*}\n并使用已经满足的低阶恒等式，我们得到\n$$\n\\frac{\\alpha}{12} + c(2 \\alpha + 1) = \\frac{\\beta}{360} \\;\\;\\Longrightarrow\\;\\; c = \\frac{\\beta/360 - \\alpha/12}{2 \\alpha + 1} = -\\frac{1}{240}.\n$$\n这证实了四阶行为，且其主误差常数比五点显式模板的要小，但关键是 $h^{2} u^{(4)}(x_{i})$ 项仍然不存在。\n\n按所列顺序收集三种格式中乘以 $h^{2} u^{(4)}(x_{i})$ 的主误差常数：\n- 三点中心差分：$\\frac{1}{12}$。\n- 五点显式对称模板：$0$。\n- 四阶紧致三对角格式：$0$。\n\n对理查森外推法（Richardson extrapolation）的影响。经典的理查森外推法旨在消除主截断误差项，它使用在间距为 $h$ 和 $\\lambda h$（通常 $\\lambda=2$）的网格上计算的解。对于 $D^{(2)}_{3}$，主误差为 $\\frac{h^{2}}{12} u^{(4)}(x_{i})$，因此使用两个网格进行外推可以消除 $\\mathcal{O}(h^{2})$ 项，得到一个四阶近似。相比之下，五点显式模板和四阶紧致格式都没有 $\\mathcal{O}(h^{2})$ 项；它们的主误差都是 $\\mathcal{O}(h^{4})$ 的，因此旨在消除 $h^{2}$ 项的理查森外推法没有任何好处。如果要使用更高阶的外推来消除 $\\mathcal{O}(h^{4})$ 项，就需要知道 $h^{4} u^{(6)}(x_{i})$ 的常数（例如，对于五点显式模板是 $-\\frac{1}{90}$，对于紧致格式是 $-\\frac{1}{240}$），但这超出了所要求的 $u^{(4)}(x_{i})$ 系数的范围。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{12}  0  0\\end{pmatrix}}$$"
        },
        {
            "introduction": "截断误差的理论结构对于验证代码和提高解的精度具有深远的实际意义。本练习通过指导您推导渐近误差估计子，将理论与实践联系起来，该技术是理查森外推法的核心。您将学习如何结合两个不同网格上的解来估计误差，而无需知道精确解，这是科学计算中一种强大的技术 。",
            "id": "3386972",
            "problem": "考虑一维泊松方程，这是一个偏微分方程 (PDE)，定义在开区间 $(0,1)$ 上，并带有狄利克雷边界条件，\n$$\n-u''(x) = f(x), \\quad x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0.\n$$\n假设精确解已知，由 $u(x) = \\sin(\\pi x)$ 给出，因此 $f(x) = \\pi^{2} \\sin(\\pi x)$。令 $U_{h}$ 表示在间距为 $h$ 的均匀网格上通过标准二阶中心有限差分法获得的数值解，令 $U_{h/2}$ 表示在间距为 $h/2$ 的均匀网格上获得的数值解。对于每个内部粗网格节点 $x_{i} = i h$（其中 $i$ 为整数），令 $x_{2i} = 2 i \\frac{h}{2}$ 为相应的对齐细网格节点。\n\n从相容性的基本定义和二阶导数的中心有限差分近似的泰勒展开出发，推导一个形如 $U_{h}(x_{i}) = u(x_{i}) + C(x_{i}) h^{p} + \\mathcal{O}(h^{p+1})$ 的渐近误差展开，其中 $C(x)$ 是某个光滑函数，$p \\geq 1$ 是整数阶。仅使用计算出的解 $U_{h}$ 和 $U_{h/2}$，并假设主导误差的行为类似于 $C(x) h^{p}$，推导一个在细网格对齐节点 $x_{2i}$ 处的渐近误差估计子公式，该公式在不需要 $u$ 的情况下近似 $U_{h/2}(x_{2i}) - u(x_{2i})$。然后，通过分析离散算子在模态 $\\sin(\\pi x)$ 上的作用并确定网格函数误差的主阶行为，验证给定模型问题（其中 $u(x) = \\sin(\\pi x)$）的阶数 $p$。\n\n你的最终答案必须是关于 $U_{h}$、$U_{h/2}$ 和 $p$ 的估计子的单个闭式表达式，以及对此模型问题验证过的整数值 $p$。如果提供多个项目，请将它们写成单行矩阵的形式。不需要四舍五入，也没有物理单位适用。",
            "solution": "该问题要求两个主要结果：首先，一个基于来自两种不同网格间距的数值解的渐近误差估计子公式；其次，对给定模型问题的收敛阶数 $p$ 进行验证。推导过程将按照问题陈述的结构分为三个部分。\n\n第1部分：渐近误差展开和阶数 $p$ 的推导\n\n问题是一维泊松方程 $-u''(x) = f(x)$，定义在 $x \\in (0,1)$ 上，且 $u(0)=u(1)=0$。标准二阶中心有限差分法在均匀网格 $x_i = ih$（其中 $i=0, 1, \\dots, N$ 且 $Nh=1$）上离散此方程。离散算子是 $L_h$，其对网格函数 $V$ 的作用定义为：\n$$\n(L_h V)_i = -\\frac{V_{i+1} - 2V_i + V_{i-1}}{h^2}\n$$\n数值解 $U_h$ 是一个网格函数，满足 $(L_h U_h)_i = f(x_i)$（对于 $i=1, \\dots, N-1$），并带有边界条件 $U_{h,0}=0$ 和 $U_{h,N}=0$。\n\n为了推导渐近误差展开的形式，我们首先确定局部截断误差 $\\tau_h(x_i)$，其定义为将精确解 $u(x)$ 应用于离散算子时产生的残差：\n$$\n\\tau_h(x_i) = (L_h u)_i - f(x_i) = (L_h u)_i - (-u''(x_i))\n$$\n我们使用 $u(x_{i+1}) = u(x_i+h)$ 和 $u(x_{i-1}) = u(x_i-h)$ 在点 $x_i$ 附近的泰勒级数展开：\n$$\nu(x_i \\pm h) = u(x_i) \\pm h u'(x_i) + \\frac{h^2}{2} u''(x_i) \\pm \\frac{h^3}{6} u'''(x_i) + \\frac{h^4}{24} u^{(4)}(x_i) \\pm \\frac{h^5}{120} u^{(5)}(x_i) + \\frac{h^6}{720} u^{(6)}(x_i) + \\mathcal{O}(h^7)\n$$\n将 $u(x_i+h)$ 和 $u(x_i-h)$ 的展开式相加，奇数次幂项抵消：\n$$\nu(x_i+h) + u(x_i-h) = 2u(x_i) + h^2 u''(x_i) + \\frac{h^4}{12} u^{(4)}(x_i) + \\frac{h^6}{360} u^{(6)}(x_i) + \\mathcal{O}(h^8)\n$$\n重新整理以找到 $u''(x_i)$ 的中心差分近似：\n$$\n-\\frac{u(x_i+h) - 2u(x_i) + u(x_i-h)}{h^2} = -u''(x_i) - \\frac{h^2}{12} u^{(4)}(x_i) - \\frac{h^4}{360} u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\n因此，截断误差为：\n$$\n\\tau_h(x_i) = \\left(-u''(x_i) - \\frac{h^2}{12} u^{(4)}(x_i) - \\dots \\right) + u''(x_i) = -\\frac{h^2}{12} u^{(4)}(x_i) - \\frac{h^4}{360} u^{(6)}(x_i) + \\mathcal{O}(h^6)\n$$\n误差网格函数 $e_h(x_i) = u(x_i) - U_h(x_i)$ 满足离散系统 $L_h e_h = \\tau_h$。对于一个稳定的方法，全局误差 $e_h$ 在 $h$ 上的阶数与局部截断误差 $\\tau_h$ 相同。由于 $\\tau_h$ 的主项是 $\\mathcal{O}(h^2)$，全局误差也是 $\\mathcal{O}(h^2)$。\n更正式地，可以证明误差具有一个关于 $h$ 的偶数次幂的渐近展开：\n$$\ne_h(x_i) = u(x_i) - U_h(x_i) = C_1(x_i) h^2 + C_2(x_i) h^4 + \\mathcal{O}(h^6)\n$$\n通过重新整理，我们得到数值解 $U_h(x_i)$ 的展开式：\n$$\nU_h(x_i) = u(x_i) - C_1(x_i) h^2 - C_2(x_i) h^4 + \\mathcal{O}(h^6)\n$$\n将其与问题中给出的形式 $U_{h}(x_{i}) = u(x_{i}) + C(x_{i}) h^{p} + \\mathcal{O}(h^{p+1})$ 进行比较，我们确定收敛的主阶为 $p=2$，光滑函数 $C(x)$ 为 $-C_1(x)$。\n\n第2部分：渐近误差估计子的推导\n\n给定阶数为 $p$ 的渐近误差展开，我们可以写出在粗网格（间距 $h$）上一点 $x_i$ 处以及在细网格（间距 $h/2$）上对齐点 $x_{2i}$ 处的数值解的表达式。注意 $x_{2i} = 2i(h/2) = ih = x_i$。我们将该空间点表示为 $x$。\n$$\nU_h(x) = u(x) + C(x) h^p + \\mathcal{O}(h^{p+1}) \\quad (1)\n$$\n$$\nU_{h/2}(x) = u(x) + C(x) \\left(\\frac{h}{2}\\right)^p + \\mathcal{O}(h^{p+1}) = u(x) + C(x) \\frac{h^p}{2^p} + \\mathcal{O}(h^{p+1}) \\quad (2)\n$$\n目标是找到细网格上误差 $E_{h/2}(x) = U_{h/2}(x) - u(x)$ 的一个估计子，根据方程(2)，它约等于 $C(x) h^p / 2^p$。我们必须仅使用计算出的解 $U_h(x)$ 和 $U_{h/2}(x)$ 来消去未知量 $u(x)$ 和 $C(x)$。\n\n从方程(1)中减去方程(2)：\n$$\nU_h(x) - U_{h/2}(x) = \\left( u(x) + C(x) h^p \\right) - \\left( u(x) + C(x) \\frac{h^p}{2^p} \\right) + \\mathcal{O}(h^{p+1})\n$$\n$$\nU_h(x) - U_{h/2}(x) = C(x)h^p \\left(1 - \\frac{1}{2^p}\\right) + \\mathcal{O}(h^{p+1})\n$$\n我们可以解出项 $C(x)h^p$：\n$$\nC(x)h^p = \\frac{U_h(x) - U_{h/2}(x)}{1 - 2^{-p}} + \\mathcal{O}(h^{p+1}) = \\frac{2^p}{2^p - 1} (U_h(x) - U_{h/2}(x)) + \\mathcal{O}(h^{p+1})\n$$\n细网格上误差的主项是 $E_{h/2}(x) \\approx C(x) (h/2)^p = C(x)h^p / 2^p$。代入 $C(x)h^p$ 的表达式：\n$$\nE_{h/2}(x) \\approx \\frac{1}{2^p} \\left( \\frac{2^p}{2^p - 1} (U_h(x) - U_{h/2}(x)) \\right) = \\frac{U_h(x) - U_{h/2}(x)}{2^p - 1}\n$$\n因此，在细网格对齐节点 $x_{2i}$ 处的渐近误差估计子（我们记为 $\\mathcal{E}_{h/2}$）是：\n$$\n\\mathcal{E}_{h/2}(x_{2i}) = \\frac{U_h(x_i) - U_{h/2}(x_{2i})}{2^p - 1}\n$$\n该公式近似于细网格上的误差 $U_{h/2}(x_{2i})-u(x_{2i})$。\n\n第3部分：模型问题阶数 $p$ 的验证\n\n对于给定的模型问题，精确解是 $u(x) = \\sin(\\pi x)$，源项是 $f(x) = \\pi^2 \\sin(\\pi x)$。离散系统是 $(L_h U_h)_i = \\pi^2 \\sin(\\pi x_i)$。我们分析离散算子 $L_h$ 在网格函数 $v_i = \\sin(\\pi x_i) = \\sin(\\pi i h)$ 上的作用。\n$$\n(L_h v)_i = -\\frac{\\sin(\\pi(i+1)h) - 2\\sin(\\pi i h) + \\sin(\\pi(i-1)h)}{h^2}\n$$\n使用三角恒等式 $\\sin(A+B)+\\sin(A-B) = 2\\sin(A)\\cos(B)$，其中 $A = \\pi i h$ 和 $B = \\pi h$：\n$$\n\\sin(\\pi(i+1)h) + \\sin(\\pi(i-1)h) = 2\\sin(\\pi i h)\\cos(\\pi h)\n$$\n将其代入 $(L_h v)_i$ 的表达式中：\n$$\n(L_h v)_i = -\\frac{2\\sin(\\pi i h)\\cos(\\pi h) - 2\\sin(\\pi i h)}{h^2} = \\left(\\frac{2(1-\\cos(\\pi h))}{h^2}\\right) \\sin(\\pi i h)\n$$\n这表明 $v_i = \\sin(\\pi x_i)$ 是离散算子 $L_h$ 的一个特征向量，其特征值为 $\\lambda_h = \\frac{2(1-\\cos(\\pi h))}{h^2}$。\n离散系统是 $L_h U_h = \\pi^2 v$。由于右侧是一个特征向量，解 $U_h$ 必须是该特征向量的倍数，即 $U_{h,i} = A v_i$，其中 $A$ 是某个常数。将 $L_h$ 应用于此解得到 $L_h U_{h,i} = A \\lambda_h v_i$。\n将其与右侧相等可得 $A \\lambda_h v_i = \\pi^2 v_i$，所以 $A = \\pi^2 / \\lambda_h$。\n因此，精确的数值解为 $U_{h,i} = \\frac{\\pi^2}{\\lambda_h} \\sin(\\pi x_i)$。\n\n误差是 $U_{h,i} - u(x_i) = \\frac{\\pi^2}{\\lambda_h} \\sin(\\pi x_i) - \\sin(\\pi x_i) = \\left(\\frac{\\pi^2}{\\lambda_h} - 1\\right)\\sin(\\pi x_i)$。\n为了找到主阶行为，我们使用 $\\cos(\\theta) = 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - \\mathcal{O}(\\theta^6)$（其中 $\\theta = \\pi h$）的泰勒级数，在 $h$ 很小时展开 $\\lambda_h$：\n$$\n\\lambda_h = \\frac{2}{h^2}\\left(1 - \\left(1 - \\frac{(\\pi h)^2}{2} + \\frac{(\\pi h)^4}{24} - \\mathcal{O}(h^6)\\right)\\right) = \\frac{2}{h^2}\\left(\\frac{\\pi^2 h^2}{2} - \\frac{\\pi^4 h^4}{24} + \\mathcal{O}(h^6)\\right) = \\pi^2 - \\frac{\\pi^4 h^2}{12} + \\mathcal{O}(h^4)\n$$\n现在我们分析误差系数：\n$$\n\\frac{\\pi^2}{\\lambda_h} - 1 = \\frac{\\pi^2}{\\pi^2 - \\frac{\\pi^4 h^2}{12} + \\mathcal{O}(h^4)} - 1 = \\frac{1}{1 - \\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)} - 1\n$$\n使用几何级数近似 $(1-z)^{-1} = 1 + z + z^2 + \\dots$，对于小的 $z = \\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)$：\n$$\n\\frac{\\pi^2}{\\lambda_h} - 1 = \\left(1 + \\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)\\right) - 1 = \\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)\n$$\n因此，误差为：\n$$\nU_h(x_i) - u(x_i) = \\left(\\frac{\\pi^2 h^2}{12} + \\mathcal{O}(h^4)\\right) \\sin(\\pi x_i) = \\left(\\frac{\\pi^2}{12}\\sin(\\pi x_i)\\right)h^2 + \\mathcal{O}(h^4)\n$$\n这个结果严格地验证了对于这个模型问题，误差展开的主项是 $h^2$ 阶的，从而证实了整数阶为 $p=2$。\n问题要求误差估计子近似 $U_{h/2}(x_{2i})-u(x_{2i})$，即细网格上的误差。我们推导的公式 $\\frac{U_h(x_i) - U_{h/2}(x_{2i})}{2^p - 1}$ 是正确的。最终答案是这个公式和 $p=2$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{U_h(x_i) - U_{h/2}(x_{2i})}{2^p - 1}  & 2 \\end{pmatrix}}\n$$"
        }
    ]
}