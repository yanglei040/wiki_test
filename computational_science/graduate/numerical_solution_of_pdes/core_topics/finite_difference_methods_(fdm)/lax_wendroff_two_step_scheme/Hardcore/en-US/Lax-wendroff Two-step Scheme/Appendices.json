{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of analyzing any numerical scheme is understanding how it treats individual wave components, a task for which von Neumann analysis is the essential tool. This practice guides you through deriving the amplification factor for the two-step Lax-Wendroff scheme. By dissecting the phase of this factor, you will quantify the numerical phase speed and its corresponding error, providing a direct and crucial measure of the scheme's dispersive properties as a function of wavenumber ().",
            "id": "3414428",
            "problem": "Consider the linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a>0$ on a periodic spatial domain. Let the spatial grid be $x_{j} = j\\,\\Delta x$ with time levels $t^{n} = n\\,\\Delta t$, and define the Courant–Friedrichs–Lewy (CFL) number $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$. Discretize this PDE using the two-step Lax–Wendroff (also called Richtmyer two-step) scheme:\n- Predictor (half-step in time at cell faces): $u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\dfrac{1}{2}\\left(u_{j+1}^{n} + u_{j}^{n}\\right) - \\dfrac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right)$,\n- Corrector (full-step in time at cell centers): $u_{j}^{n+1} = u_{j}^{n} - \\dfrac{a\\,\\Delta t}{\\Delta x}\\left(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right)$.\n\nUsing the Fourier (von Neumann) mode ansatz $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$ with dimensionless wave number $\\theta \\in (-\\pi,\\pi]$, derive the amplification factor $G(\\theta,\\lambda)$ defined by $\\hat{u}^{n+1} = G(\\theta,\\lambda)\\,\\hat{u}^{n}$. Then, adopting the convention consistent with the exact mode evolution $G_{\\text{exact}} = \\exp(-i\\,a\\,k\\,\\Delta t)$ with $k = \\theta/\\Delta x$, define the numerical phase speed $c_{p}(\\theta)$ by\n$$\nc_{p}(\\theta) \\equiv -\\,\\frac{\\Delta x}{\\theta}\\,\\frac{\\Arg\\!\\big(G(\\theta,\\lambda)\\big)}{\\Delta t},\n$$\nwhere $\\Arg$ is the principal argument in $(-\\pi,\\pi]$. Finally, quantify the phase error relative to $a$ via the dimensionless function\n$$\n\\varepsilon(\\theta,\\lambda) \\equiv \\frac{c_{p}(\\theta)}{a} - 1,\n$$\nand provide a single closed-form analytic expression for $\\varepsilon(\\theta,\\lambda)$ solely in terms of $\\theta$ and $\\lambda$, using only elementary functions and the principal argument function. Your final answer must be this expression; do not include any intermediate steps. No rounding is required, and no units should be reported. Assume $0\\lambda\\leq 1$ and $\\theta \\in (-\\pi,\\pi]$.",
            "solution": "The problem statement has been validated and is deemed to be scientifically grounded, well-posed, and objective. It presents a standard exercise in the von Neumann stability and dispersion analysis of a well-known numerical method for a fundamental partial differential equation. All provided definitions, constants, and constraints are self-contained and consistent. The problem is valid and a solution will be derived forthwith.\n\nThe objective is to derive an expression for the relative phase error, $\\varepsilon(\\theta,\\lambda)$, of the two-step Lax-Wendroff scheme applied to the linear advection equation $u_{t} + a\\,u_{x} = 0$. The derivation proceeds in three main stages: first, the determination of the scheme's amplification factor $G(\\theta,\\lambda)$; second, the calculation of the numerical phase speed $c_p(\\theta)$; and finally, the formulation of the relative phase error $\\varepsilon(\\theta,\\lambda)$.\n\nFirst, we determine the amplification factor $G(\\theta,\\lambda)$ by substituting the Fourier mode ansatz, $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$, into the two steps of the given numerical scheme.\n\nThe predictor step is given by:\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\dfrac{1}{2}\\left(u_{j+1}^{n} + u_{j}^{n}\\right) - \\dfrac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\n$$\nSubstituting the ansatz and the definition of the CFL number, $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$, we obtain:\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\dfrac{1}{2}\\left(\\hat{u}^{n}\\,\\exp(i(j+1)\\theta) + \\hat{u}^{n}\\,\\exp(ij\\theta)\\right) - \\dfrac{\\lambda}{2}\\left(\\hat{u}^{n}\\,\\exp(i(j+1)\\theta) - \\hat{u}^{n}\\,\\exp(ij\\theta)\\right)\n$$\nFactoring out $\\hat{u}^{n}\\,\\exp(ij\\theta)$:\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u}^{n}\\,\\exp(ij\\theta) \\left[ \\dfrac{1}{2}\\left(\\exp(i\\theta) + 1\\right) - \\dfrac{\\lambda}{2}\\left(\\exp(i\\theta) - 1\\right) \\right]\n$$\nFor the corrector step, we also need the value at $u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}$, which is found by applying the predictor step to grid points $j-1$ and $j$:\n$$\nu_{j-\\frac{1}{2}}^{n+\\frac{1}{2}} = \\dfrac{1}{2}\\left(u_{j}^{n} + u_{j-1}^{n}\\right) - \\dfrac{\\lambda}{2}\\left(u_{j}^{n} - u_{j-1}^{n}\\right)\n$$\nSubstituting the ansatz yields:\n$$\nu_{j-\\frac{1}{2}}^{n+\\frac{1}{2}} = \\hat{u}^{n}\\,\\exp(ij\\theta) \\left[ \\dfrac{1}{2}\\left(1 + \\exp(-i\\theta)\\right) - \\dfrac{\\lambda}{2}\\left(1 - \\exp(-i\\theta)\\right) \\right]\n$$\nNext, we substitute these expressions for the predictor values into the corrector step:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\lambda\\left(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right)\n$$\nSubstituting the ansatz on the left-hand side, $u_{j}^{n+1} = \\hat{u}^{n+1}\\,\\exp(ij\\theta)$, and the derived expressions on the right-hand side, we get:\n$$\n\\hat{u}^{n+1}\\,\\exp(ij\\theta) = \\hat{u}^{n}\\,\\exp(ij\\theta) - \\lambda \\left( \\hat{u}^{n}\\,\\exp(ij\\theta) \\left[ \\dots \\right] - \\hat{u}^{n}\\,\\exp(ij\\theta) \\left[ \\dots \\right] \\right)\n$$\nDividing by $\\hat{u}^{n}\\,\\exp(ij\\theta)$ gives the amplification factor $G(\\theta,\\lambda) = \\hat{u}^{n+1}/\\hat{u}^{n}$:\n$$\nG(\\theta,\\lambda) = 1 - \\lambda \\left( \\left[ \\dfrac{1}{2}(\\exp(i\\theta) + 1) - \\dfrac{\\lambda}{2}(\\exp(i\\theta) - 1)\\right] - \\left[ \\dfrac{1}{2}(1 + \\exp(-i\\theta)) - \\dfrac{\\lambda}{2}(1 - \\exp(-i\\theta))\\right] \\right)\n$$\nWe simplify the term inside the large parentheses:\n$$\n\\left( \\dfrac{1}{2}\\exp(i\\theta) + \\dfrac{1}{2} - \\dfrac{\\lambda}{2}\\exp(i\\theta) + \\dfrac{\\lambda}{2} \\right) - \\left( \\dfrac{1}{2} + \\dfrac{1}{2}\\exp(-i\\theta) - \\dfrac{\\lambda}{2} + \\dfrac{\\lambda}{2}\\exp(-i\\theta) \\right)\n$$\n$$\n= \\dfrac{1-\\lambda}{2}\\exp(i\\theta) + \\dfrac{1+\\lambda}{2} - \\dfrac{1-\\lambda}{2} - \\dfrac{1+\\lambda}{2}\\exp(-i\\theta)\n$$\n$$\n= \\dfrac{1-\\lambda}{2}\\exp(i\\theta) - \\dfrac{1+\\lambda}{2}\\exp(-i\\theta) + \\lambda\n$$\nSubstituting this back into the expression for $G$:\n$$\nG(\\theta,\\lambda) = 1 - \\lambda \\left( \\dfrac{1-\\lambda}{2}\\exp(i\\theta) - \\dfrac{1+\\lambda}{2}\\exp(-i\\theta) + \\lambda \\right)\n$$\n$$\nG(\\theta,\\lambda) = 1 - \\lambda^2 - \\dfrac{\\lambda(1-\\lambda)}{2}\\exp(i\\theta) + \\dfrac{\\lambda(1+\\lambda)}{2}\\exp(-i\\theta)\n$$\nTo find the real and imaginary parts, we use Euler's formula, $\\exp(\\pm i\\theta) = \\cos(\\theta) \\pm i\\sin(\\theta)$.\n$$\n\\operatorname{Re}(G) = 1 - \\lambda^2 - \\dfrac{\\lambda(1-\\lambda)}{2}\\cos(\\theta) + \\dfrac{\\lambda(1+\\lambda)}{2}\\cos(\\theta) = 1 - \\lambda^2 + \\cos(\\theta)\\left[\\dfrac{-\\lambda+\\lambda^2+\\lambda+\\lambda^2}{2}\\right]\n$$\n$$\n\\operatorname{Re}(G) = 1 - \\lambda^2 + \\lambda^2\\cos(\\theta) = 1 - \\lambda^2(1-\\cos(\\theta))\n$$\nUsing the half-angle identity $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$, we find:\n$$\n\\operatorname{Re}(G) = 1 - 2\\lambda^2\\sin^2\\left(\\frac{\\theta}{2}\\right)\n$$\nFor the imaginary part:\n$$\n\\operatorname{Im}(G) = - \\dfrac{\\lambda(1-\\lambda)}{2}\\sin(\\theta) - \\dfrac{\\lambda(1+\\lambda)}{2}\\sin(\\theta) = -\\sin(\\theta)\\left[\\dfrac{\\lambda-\\lambda^2+\\lambda+\\lambda^2}{2}\\right]\n$$\n$$\n\\operatorname{Im}(G) = -\\lambda\\sin(\\theta)\n$$\nThus, the amplification factor is:\n$$\nG(\\theta,\\lambda) = 1 - 2\\lambda^2\\sin^2\\left(\\frac{\\theta}{2}\\right) - i\\lambda\\sin(\\theta)\n$$\nThe second stage is to calculate the numerical phase speed $c_p(\\theta)$, defined as:\n$$\nc_{p}(\\theta) = -\\,\\frac{\\Delta x}{\\theta}\\,\\frac{\\Arg\\!\\big(G(\\theta,\\lambda)\\big)}{\\Delta t}\n$$\nUsing the relation $\\lambda = a\\Delta t / \\Delta x$, which can be rearranged to $\\Delta x/\\Delta t = a/\\lambda$, we get:\n$$\nc_{p}(\\theta) = -\\,\\frac{a}{\\lambda\\theta}\\Arg\\!\\big(G(\\theta,\\lambda)\\big)\n$$\nThe third and final stage is to find the relative phase error $\\varepsilon(\\theta,\\lambda)$:\n$$\n\\varepsilon(\\theta,\\lambda) = \\frac{c_{p}(\\theta)}{a} - 1\n$$\nSubstituting the expression for $c_p(\\theta)$:\n$$\n\\varepsilon(\\theta,\\lambda) = \\frac{1}{a}\\left(-\\,\\frac{a}{\\lambda\\theta}\\Arg\\!\\big(G(\\theta,\\lambda)\\big)\\right) - 1 = -\\frac{1}{\\lambda\\theta}\\Arg\\!\\big(G(\\theta,\\lambda)\\big) - 1\n$$\nFinally, we substitute the derived expression for $G(\\theta,\\lambda)$ to obtain the final answer for the relative phase error:\n$$\n\\varepsilon(\\theta,\\lambda) = -\\frac{1}{\\lambda\\theta} \\Arg\\!\\left(1 - 2\\lambda^2\\sin^2\\left(\\frac{\\theta}{2}\\right) - i\\lambda\\sin(\\theta)\\right) - 1\n$$\nThis expression is in terms of the dimensionless parameters $\\theta$ and $\\lambda$, and utilizes only elementary functions and the principal argument function $\\Arg$, as required.",
            "answer": "$$\n\\boxed{-\\frac{1}{\\lambda\\theta} \\Arg\\!\\left(1 - 2\\lambda^2\\sin^2\\left(\\frac{\\theta}{2}\\right) - i\\lambda\\sin(\\theta)\\right) - 1}\n$$"
        },
        {
            "introduction": "While phase error describes how a scheme treats individual sinusoidal waves, physical phenomena often involve localized wave packets whose propagation is governed by the group velocity. This exercise extends our analysis to derive the numerical group velocity from the scheme's dispersion relation (). By examining the leading-order error for long wavelengths, you will gain critical insight into how the scheme distorts the shape and speed of propagating wave groups.",
            "id": "3414439",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a \\in \\mathbb{R}$, discretized on a uniform grid $x_{j} = j\\,\\Delta x$ and $t^{n} = n\\,\\Delta t$. Apply the two-step Lax–Wendroff (also known as the Richtmyer two-step Lax–Wendroff) scheme defined by the predictor\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right),\n$$\nand the corrector\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{\\Delta x}\\left(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right).\n$$\nLet the Courant–Friedrichs–Lewy (CFL) number be $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$, and analyze the scheme by a von Neumann ansatz $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)$, where $\\theta = k\\,\\Delta x$ with spatial wavenumber $k \\in \\mathbb{R}$. Define the amplification factor $G(\\theta)$ by $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$, and define the numerical angular frequency $\\omega_{\\mathrm{num}}(\\theta)$ via the numerical phase $\\phi(\\theta)$ satisfying $G(\\theta) = |G(\\theta)|\\exp(-i\\,\\phi(\\theta))$ with $\\omega_{\\mathrm{num}}(\\theta) = \\dfrac{\\phi(\\theta)}{\\Delta t}$. The numerical group velocity is $v_{g,\\mathrm{num}}(\\theta) = \\dfrac{d\\omega_{\\mathrm{num}}}{dk}(\\theta)$, and the group velocity error is $E_{g}(\\theta) = v_{g,\\mathrm{num}}(\\theta) - a$.\n\nCompute $E_{g}(\\theta)$ by differentiating the numerical dispersion relation and identify the leading nonzero term of its small-$\\theta$ expansion as $\\theta \\to 0$. Express your final answer as a single closed-form analytic expression for the leading-order term in powers of $\\theta$, in terms of $a$, $\\lambda$, and $\\theta$. No rounding is required. The final answer must be a single expression (not an equation or inequality) and must not include units.",
            "solution": "The user wants to find the leading-order term of the group velocity error for the two-step Lax-Wendroff scheme applied to the linear advection equation.\n\nThe problem starts with the one-dimensional linear advection equation:\n$$\nu_t + a u_x = 0\n$$\nwhere $u = u(x,t)$ and $a$ is a constant wave speed.\n\nThe Richtmyer two-step Lax-Wendroff scheme is given by:\nPredictor step:\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\left(u_{j+1}^{n} + u_{j}^{n}\\right) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\n$$\nCorrector step:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{\\Delta x}\\left(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\right)\n$$\nThe Courant-Friedrichs-Lewy (CFL) number is defined as $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$.\n\nThe analysis is performed using the von Neumann ansatz $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,j\\,\\theta)$, where $\\theta = k\\,\\Delta x$ is the dimensionless wavenumber, with $k$ being the spatial wavenumber. The amplification factor $G(\\theta)$ is defined by the relation $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$.\n\nFirst, we must find the amplification factor $G(\\theta)$. To do this, we can combine the two steps into a single expression for $u_j^{n+1}$ in terms of values at time level $n$.\nSubstitute the predictor step for $u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}}$ and for $u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}$ (by shifting the index $j$ to $j-1$) into the corrector step:\n$$\nu_{j-\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\left(u_{j}^{n} + u_{j-1}^{n}\\right) - \\frac{\\lambda}{2}\\left(u_{j}^{n} - u_{j-1}^{n}\\right)\n$$\nThe difference term in the corrector step becomes:\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} - u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}} = \\left[ \\frac{1}{2}(u_{j+1}^n+u_j^n) - \\frac{\\lambda}{2}(u_{j+1}^n-u_j^n) \\right] - \\left[ \\frac{1}{2}(u_j^n+u_{j-1}^n) - \\frac{\\lambda}{2}(u_j^n-u_{j-1}^n) \\right]\n$$\n$$\n= \\frac{1}{2}(u_{j+1}^n - u_{j-1}^n) - \\frac{\\lambda}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\nSubstituting this into the corrector equation:\n$$\nu_j^{n+1} = u_j^n - \\lambda \\left[ \\frac{1}{2}(u_{j+1}^n - u_{j-1}^n) - \\frac{\\lambda}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n) \\right]\n$$\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{\\lambda^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\nThis is the single-step formulation of the Lax-Wendroff scheme. Now, we apply the von Neumann ansatz $u_j^n = \\hat{u}^n e^{ij\\theta}$:\n$$\n\\hat{u}^{n+1} e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} - \\frac{\\lambda}{2}(\\hat{u}^n e^{i(j+1)\\theta} - \\hat{u}^n e^{i(j-1)\\theta}) + \\frac{\\lambda^2}{2}(\\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta})\n$$\nDividing by $\\hat{u}^n e^{ij\\theta}$, we obtain the amplification factor $G(\\theta)$:\n$$\nG(\\theta) = 1 - \\frac{\\lambda}{2}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\lambda^2}{2}(e^{i\\theta} - 2 + e^{-i\\theta})\n$$\nUsing Euler's identities, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ and $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$, we get:\n$$\nG(\\theta) = 1 - \\frac{\\lambda}{2}(2i\\sin\\theta) + \\frac{\\lambda^2}{2}(2\\cos\\theta - 2)\n$$\n$$\nG(\\theta) = 1 - i\\lambda\\sin\\theta + \\lambda^2(\\cos\\theta - 1) = [1 - \\lambda^2(1-\\cos\\theta)] - i\\lambda\\sin\\theta\n$$\nThe numerical phase $\\phi(\\theta)$ is defined by $G(\\theta) = |G(\\theta)|e^{-i\\phi(\\theta)}$. From this, we have $\\tan(\\phi(\\theta)) = -\\frac{\\mathrm{Im}(G)}{\\mathrm{Re}(G)}$.\n$$\n\\tan(\\phi(\\theta)) = \\frac{\\lambda\\sin\\theta}{1 - \\lambda^2(1-\\cos\\theta)}\n$$\nSo, the numerical phase is:\n$$\n\\phi(\\theta) = \\arctan\\left(\\frac{\\lambda\\sin\\theta}{1 - \\lambda^2(1-\\cos\\theta)}\\right)\n$$\nThe numerical angular frequency is $\\omega_{\\mathrm{num}}(\\theta) = \\frac{\\phi(\\theta)}{\\Delta t}$. The numerical group velocity is $v_{g,\\mathrm{num}}(\\theta) = \\frac{d\\omega_{\\mathrm{num}}}{dk}$.\nUsing the chain rule and $\\theta = k\\Delta x$, we have $\\frac{d}{dk} = \\frac{d\\theta}{dk}\\frac{d}{d\\theta} = \\Delta x \\frac{d}{d\\theta}$.\n$$\nv_{g,\\mathrm{num}}(\\theta) = \\frac{d}{dk}\\left(\\frac{\\phi(\\theta)}{\\Delta t}\\right) = \\frac{\\Delta x}{\\Delta t} \\frac{d\\phi}{d\\theta}\n$$\nSince $\\lambda = \\frac{a\\Delta t}{\\Delta x}$, we have $\\frac{\\Delta x}{\\Delta t} = \\frac{a}{\\lambda}$.\n$$\nv_{g,\\mathrm{num}}(\\theta) = \\frac{a}{\\lambda} \\frac{d\\phi}{d\\theta}\n$$\nTo find the leading-order term of the group velocity error $E_g(\\theta) = v_{g,\\mathrm{num}}(\\theta) - a$ for small $\\theta$, we can Taylor-expand $\\phi(\\theta)$ around $\\theta=0$.\nWe use the Taylor series for $\\sin\\theta$, $\\cos\\theta$, and $\\arctan(x)$:\n$\\sin\\theta = \\theta - \\frac{\\theta^3}{6} + O(\\theta^5)$\n$\\cos\\theta = 1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} + O(\\theta^6)$\n$\\arctan(x) = x - \\frac{x^3}{3} + O(x^5)$\n\nThe argument of the arctan function becomes, for small $\\theta$:\n$$\n\\frac{\\lambda(\\theta - \\frac{\\theta^3}{6} + \\dots)}{1 - \\lambda^2(1 - (1 - \\frac{\\theta^2}{2} + \\dots))} = \\frac{\\lambda\\theta - \\frac{\\lambda\\theta^3}{6} + \\dots}{1 - \\frac{\\lambda^2\\theta^2}{2} + \\dots}\n$$\nUsing the geometric series $(1-z)^{-1} = 1+z+z^2+\\dots$:\n$$\n\\left(\\lambda\\theta - \\frac{\\lambda\\theta^3}{6} + \\dots\\right)\\left(1 + \\frac{\\lambda^2\\theta^2}{2} + \\dots\\right) = \\lambda\\theta + \\frac{\\lambda^3\\theta^3}{2} - \\frac{\\lambda\\theta^3}{6} + \\dots = \\lambda\\theta + \\left(\\frac{3\\lambda^3-\\lambda}{6}\\right)\\theta^3 + \\dots\n$$\nNow, we expand $\\phi(\\theta) = \\arctan(\\dots)$:\n$$\n\\phi(\\theta) = \\left(\\lambda\\theta + \\frac{\\lambda(3\\lambda^2-1)}{6}\\theta^3 + \\dots\\right) - \\frac{1}{3}(\\lambda\\theta + \\dots)^3 + \\dots\n$$\n$$\n\\phi(\\theta) = \\lambda\\theta + \\frac{\\lambda(3\\lambda^2-1)}{6}\\theta^3 - \\frac{\\lambda^3\\theta^3}{3} + O(\\theta^5)\n$$\n$$\n\\phi(\\theta) = \\lambda\\theta + \\left(\\frac{3\\lambda^3-\\lambda - 2\\lambda^3}{6}\\right)\\theta^3 + O(\\theta^5) = \\lambda\\theta + \\frac{\\lambda^3-\\lambda}{6}\\theta^3 + O(\\theta^5)\n$$\n$$\n\\phi(\\theta) = \\lambda\\theta + \\frac{\\lambda(\\lambda^2-1)}{6}\\theta^3 + O(\\theta^5)\n$$\nNext, we differentiate $\\phi(\\theta)$ with respect to $\\theta$:\n$$\n\\frac{d\\phi}{d\\theta} = \\lambda + \\frac{\\lambda(\\lambda^2-1)}{6}(3\\theta^2) + O(\\theta^4) = \\lambda + \\frac{\\lambda(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\n$$\nNow we compute the numerical group velocity:\n$$\nv_{g,\\mathrm{num}}(\\theta) = \\frac{a}{\\lambda} \\frac{d\\phi}{d\\theta} = \\frac{a}{\\lambda}\\left(\\lambda + \\frac{\\lambda(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\\right)\n$$\n$$\nv_{g,\\mathrm{num}}(\\theta) = a\\left(1 + \\frac{\\lambda^2-1}{2}\\theta^2 + O(\\theta^4)\\right) = a + \\frac{a(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\n$$\nThe group velocity error is $E_g(\\theta) = v_{g,\\mathrm{num}}(\\theta) - a$.\n$$\nE_g(\\theta) = \\left(a + \\frac{a(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\\right) - a = \\frac{a(\\lambda^2-1)}{2}\\theta^2 + O(\\theta^4)\n$$\nThe leading nonzero term of the group velocity error for small $\\theta$ (assuming $\\lambda^2 \\neq 1$) is:\n$$\n\\frac{a(\\lambda^2-1)}{2}\\theta^2\n$$",
            "answer": "$$\\boxed{\\frac{a \\left(\\lambda^{2} - 1\\right) \\theta^{2}}{2}}$$"
        },
        {
            "introduction": "The insights from linear analysis provide the foundation for tackling more complex nonlinear conservation laws, where the wave speed, given by the characteristic speed $a(u) = f'(u)$, depends on the solution itself. This exercise challenges you to apply the principles of linear stability to the nonlinear case by considering a 'frozen-coefficient' approach. You will determine the correct way to define a nonlinear Courant-Friedrichs-Lewy (CFL) number and choose a time step that ensures stability across the entire computational domain ().",
            "id": "3414458",
            "problem": "Consider the scalar conservation law $u_t + f(u)_x = 0$ with a smooth flux $f \\in C^2(\\mathbb{R})$, discretized on a uniform grid $x_j = j \\,\\Delta x$, $t^n = n \\,\\Delta t$, by the two-step Lax–Wendroff (Richtmyer) scheme:\n$$\nu_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\big(u_{j+1}^n + u_j^n\\big) - \\frac{\\Delta t}{2 \\,\\Delta x}\\Big(f(u_{j+1}^n)-f(u_j^n)\\Big),\n$$\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\Big(f\\big(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}}\\big) - f\\big(u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\big)\\Big).\n$$\nIt is known from the method of characteristics that the local wave speed is the characteristic speed $a(x,t) = f'(u(x,t))$. For linear advection with a constant speed $a$, von Neumann analysis of the Lax–Wendroff scheme yields a stability restriction on the Courant number. In the nonlinear setting, a common approach is to freeze the coefficient by linearizing around the current state and then enforce a stability restriction based on the maximal local characteristic speed at each time level. Using this principle, define a nonlinear Courant–Friedrichs–Lewy (CFL) number at time level $n$ in terms of the spatial grid and the maximal local characteristic speed, and determine how to select the time step $\\Delta t$ so that the scheme is stable uniformly in space and time.\n\nWhich of the following statements about defining such a nonlinear CFL number and choosing $\\Delta t$ are valid for ensuring stability of the two-step Lax–Wendroff scheme uniformly in space and time?\n\nA. Define the nonlinear CFL number $C^n$ as the product of the grid ratio $\\Delta t/\\Delta x$ and the maximum over $j$ of the magnitude of the local characteristic speed at time level $n$, then enforce a fixed bound $C^n \\le \\nu$ with a constant $0\\nu\\le 1$ by choosing $\\Delta t^n = \\nu \\,\\Delta x / \\max_j |f'(u_j^n)|$. This produces a uniform (in $j$) stability restriction at each time step and controls stability over all times by maintaining the same $\\nu$.\n\nB. Define the nonlinear CFL number using the spatial average of the characteristic speeds, i.e., set $C^n := (\\Delta t/\\Delta x) \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$ on a grid of $N$ cells, and choose $\\Delta t^n = \\nu \\,\\Delta x / \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$ with a fixed $0\\nu\\le 1$. This averaging guarantees stability uniformly in space and time because large local speeds are compensated by small ones elsewhere.\n\nC. Define the nonlinear CFL number with the minimum magnitude of the characteristic speed, $C^n := (\\Delta t/\\Delta x)\\min_j |f'(u_j^n)|$, and choose $\\Delta t^n = \\nu \\,\\Delta x / \\min_j |f'(u_j^n)|$ with a fixed $0\\nu\\le 1$. This is sufficient for uniform stability because the scheme is centered and second-order accurate.\n\nD. If there is an a priori invariant range $I \\subset \\mathbb{R}$ such that $u_j^n \\in I$ for all $j$ and $n$, then one may define $a_* := \\sup_{u\\in I} |f'(u)|$ and choose a constant time step $\\Delta t = \\nu \\,\\Delta x / a_*$ with a fixed $0\\nu\\le 1$, which ensures that the nonlinear CFL number remains bounded by $\\nu$ at all times, yielding uniform stability in space and time.\n\nE. Because the two-step Lax–Wendroff scheme is second order, it is unconditionally stable for smooth fluxes $f$ regardless of the size of $\\Delta t/\\Delta x$, so no CFL restriction is necessary to obtain uniform stability in space and time.",
            "solution": "The user wants me to act as a STEM professor to solve a problem about the stability of the two-step Lax-Wendroff scheme for a scalar conservation law.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The scalar conservation law is $u_t + f(u)_x = 0$.\n- **Flux Function:** The flux $f$ is smooth, $f \\in C^2(\\mathbb{R})$.\n- **Discretization:** The grid is uniform with $x_j = j \\,\\Delta x$ and $t^n = n \\,\\Delta t$.\n- **Numerical Scheme:** The two-step Lax–Wendroff (Richtmyer) scheme is given by:\n  - Predictor Step: $u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}} = \\frac{1}{2}\\big(u_{j+1}^n + u_j^n\\big) - \\frac{\\Delta t}{2 \\,\\Delta x}\\Big(f(u_{j+1}^n)-f(u_j^n)\\Big)$.\n  - Corrector Step: $u_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\Big(f\\big(u_{j+\\frac{1}{2}}^{n+\\frac{1}{2}}\\big) - f\\big(u_{j-\\frac{1}{2}}^{n+\\frac{1}{2}}\\big)\\Big)$.\n- **Characteristic Speed:** The local wave speed is the characteristic speed $a(x,t) = f'(u(x,t))$.\n- **Guiding Principle:** For the nonlinear case, one linearizes around the current state (freezes the coefficient) and enforces a stability restriction based on the maximal local characteristic speed at each time level.\n- **Objective:** Define a nonlinear Courant–Friedrichs–Lewy (CFL) number at time level $n$ and determine how to select the time step $\\Delta t$ to ensure the scheme is stable uniformly in space and time.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded, well-posed, and objective.\n1.  **Scientific or Factual Unsoundness:** The problem is based on standard, well-established concepts in the numerical analysis of partial differential equations, namely the Lax-Wendroff scheme for hyperbolic conservation laws and the Courant-Friedrichs-Lewy (CFL) stability condition. The method of extending linear stability analysis to nonlinear problems by \"freezing\" coefficients and considering the maximum local wave speed is a standard heuristic and theoretical tool. There are no violations of scientific principles.\n2.  **Non-Formalizable or Irrelevant:** The problem is directly and formally concerned with the topic of the Lax-Wendroff scheme and its stability.\n3.  **Incomplete or Contradictory Setup:** The problem provides the full definition of the numerical scheme, the governing equation, and the principle to be used for the analysis. The setup is complete and self-consistent.\n4.  **Unrealistic or Infeasible:** The scenario described is a standard computational problem. There are no unrealistic or infeasible conditions.\n5.  **Ill-Posed or Poorly Structured:** The question is precise and asks for valid statements regarding a standard procedure. A definite answer can be derived from the principles of numerical stability theory.\n6.  **Pseudo-Profound, Trivial, or Tautological:** The problem addresses a core, non-trivial concept in numerical PDEs: ensuring stability for a nonlinear problem. It requires a clear understanding of how local properties (wave speed) dictate global numerical behavior (stability).\n7.  **Outside Scientific Verifiability:** The stability of numerical schemes is a mathematically rigorous and verifiable field.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A full solution will be provided.\n\nThe stability of explicit finite difference schemes for hyperbolic partial differential equations is governed by the Courant-Friedrichs-Lewy (CFL) condition. This condition stipulates that the numerical domain of dependence of a point $(x_j, t^{n+1})$ must contain the physical domain of dependence. For the linear advection equation $u_t + a u_x = 0$ with a constant speed $a$, the Lax-Wendroff scheme is stable if and only if the Courant number $\\nu = |a| \\frac{\\Delta t}{\\Delta x}$ satisfies $\\nu \\le 1$.\n\nFor the nonlinear conservation law $u_t + f(u)_x = 0$, the characteristic speed $a(u) = f'(u)$ is not constant but depends on the solution $u$. The problem directs us to use the principle of freezing the coefficients. This means we consider the problem locally at each time step $t^n$ as a collection of linear advection problems, where the speed at each grid point $x_j$ is given by $a_j^n = f'(u_j^n)$.\n\nTo ensure stability across the entire spatial domain for the time step from $t^n$ to $t^{n+1}$, the time step $\\Delta t$ must be small enough to satisfy the stability condition for the *fastest* wave speed present in the numerical solution at time $t^n$. The maximum magnitude of the local characteristic speed is $\\max_j |a_j^n| = \\max_j |f'(u_j^n)|$.\n\nTherefore, the nonlinear CFL condition, which must be satisfied at each time step $n$, is:\n$$ \\frac{\\Delta t}{\\Delta x} \\max_j |f'(u_j^n)| \\le \\nu_{\\text{max}} $$\nFor the Lax-Wendroff scheme, the linear stability analysis yields $\\nu_{\\text{max}} = 1$. In practice, a safety factor is often used, so the condition is written as:\n$$ C^n := \\frac{\\Delta t}{\\Delta x} \\max_j |f'(u_j^n)| \\le \\nu $$\nwhere $C^n$ is the nonlinear CFL number at time level $n$, and $\\nu$ is a constant chosen such that $0  \\nu \\le 1$. To ensure stability for all time, this condition must be enforced at every time step, which typically leads to an adaptive time step $\\Delta t^n$ that changes as the solution evolves.\n\nWe now evaluate each option based on this principle.\n\n**A. Define the nonlinear CFL number $C^n$ as the product of the grid ratio $\\Delta t/\\Delta x$ and the maximum over $j$ of the magnitude of the local characteristic speed at time level $n$, then enforce a fixed bound $C^n \\le \\nu$ with a constant $0\\nu\\le 1$ by choosing $\\Delta t^n = \\nu \\,\\Delta x / \\max_j |f'(u_j^n)|$. This produces a uniform (in $j$) stability restriction at each time step and controls stability over all times by maintaining the same $\\nu$.**\n\nThis statement correctly identifies the nonlinear CFL number as $C^n = (\\Delta t / \\Delta x) \\max_j |f'(u_j^n)|$. It correctly applies the principle that stability is dictated by the maximum wave speed. By choosing the time step $\\Delta t^n = \\nu \\,\\Delta x / \\max_j |f'(u_j^n)|$ at each time level $n$, the CFL number becomes exactly $C^n = \\nu$, which satisfies the stability constraint $C^n \\le \\nu$. This adaptive time-stepping strategy is a standard and valid method for ensuring stability for nonlinear hyperbolic problems. The description of its effect is accurate.\n**Verdict: Correct**\n\n**B. Define the nonlinear CFL number using the spatial average of the characteristic speeds, i.e., set $C^n := (\\Delta t/\\Delta x) \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$ on a grid of $N$ cells, and choose $\\Delta t^n = \\nu \\,\\Delta x / \\left|\\frac{1}{N}\\sum_j f'(u_j^n)\\right|$ with a fixed $0\\nu\\le 1$. This averaging guarantees stability uniformly in space and time because large local speeds are compensated by small ones elsewhere.**\n\nThis approach is fundamentally flawed. Stability is a local condition. If a wave at a single point $x_j$ is propagating very fast (i.e., $|f'(u_j^n)|$ is large), the time step $\\Delta t$ must be small enough to capture this propagation. Averaging the speed over the entire domain can severely underestimate the required time step restriction if there is significant variation in $f'(u)$. A large local speed in one region is not \"compensated\" by small speeds elsewhere; it will still lead to a violation of the domain of dependence and cause numerical instability.\n**Verdict: Incorrect**\n\n**C. Define the nonlinear CFL number with the minimum magnitude of the characteristic speed, $C^n := (\\Delta t/\\Delta x)\\min_j |f'(u_j^n)|$, and choose $\\Delta t^n = \\nu \\,\\Delta x / \\min_j |f'(u_j^n)|$ with a fixed $0\\nu\\le 1$. This is sufficient for uniform stability because the scheme is centered and second-order accurate.**\n\nThis is the opposite of the correct procedure. Using the minimum speed to determine the time step would allow for an excessively large $\\Delta t$ if there are regions of high speed, leading to immediate instability. The stability is always limited by the *fastest* process, not the slowest. The assertion that this is sufficient because the scheme is second-order accurate is a non-sequitur; accuracy properties do not guarantee stability, especially not an incorrect stability criterion.\n**Verdict: Incorrect**\n\n**D. If there is an a priori invariant range $I \\subset \\mathbb{R}$ such that $u_j^n \\in I$ for all $j$ and $n$, then one may define $a_* := \\sup_{u\\in I} |f'(u)|$ and choose a constant time step $\\Delta t = \\nu \\,\\Delta x / a_*$ with a fixed $0\\nu\\le 1$, which ensures that the nonlinear CFL number remains bounded by $\\nu$ at all times, yielding uniform stability in space and time.**\n\nThis statement describes a valid, albeit more constrained, approach. If an invariant set $I$ for the solution $u$ is known a priori, one can find a global upper bound for the wave speed magnitude, $a_* = \\sup_{u \\in I} |f'(u)|$. Since $u_j^n \\in I$ for all $j$ and $n$, it follows that $\\max_j |f'(u_j^n)| \\le a_*$ for all time steps $n$. If a constant time step is chosen as $\\Delta t = \\nu \\Delta x / a_*$, then for any time level $n$, the CFL number is:\n$$ C^n = \\frac{\\Delta t}{\\Delta x} \\max_j |f'(u_j^n)| = \\frac{\\nu \\Delta x / a_*}{\\Delta x} \\max_j |f'(u_j^n)| = \\nu \\frac{\\max_j |f'(u_j^n)|}{a_*} $$\nSince $\\max_j |f'(u_j^n)| \\le a_*$, we have $C^n \\le \\nu$. The CFL condition is therefore satisfied for all time with a single, constant time step. This is a correct and often practical method when such a bound $a_*$ is available.\n**Verdict: Correct**\n\n**E. Because the two-step Lax–Wendroff scheme is second order, it is unconditionally stable for smooth fluxes $f$ regardless of the size of $\\Delta t/\\Delta x$, so no CFL restriction is necessary to obtain uniform stability in space and time.**\n\nThis statement is false. The order of accuracy and stability are distinct properties of a numerical scheme. For hyperbolic problems, explicit schemes like Lax-Wendroff are conditionally stable, not unconditionally stable. Unconditional stability is typically a feature of implicit schemes. The linear stability analysis of Lax-Wendroff rigorously proves that it is only stable under the CFL condition $|a| \\Delta t / \\Delta x \\le 1$. The second-order accuracy is only achieved when the scheme is stable.\n**Verdict: Incorrect**\n\nIn summary, statements A and D both describe valid methods for ensuring the stability of the Lax-Wendroff scheme for a nonlinear conservation law. Statement A describes an adaptive time-stepping approach, which is more general, while statement D describes a constant time-stepping approach that is valid under the more restrictive assumption of a known invariant domain for the solution.",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}