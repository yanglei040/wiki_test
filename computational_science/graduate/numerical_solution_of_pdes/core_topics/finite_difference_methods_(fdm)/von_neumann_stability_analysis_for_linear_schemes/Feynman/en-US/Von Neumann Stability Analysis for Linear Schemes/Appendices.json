{
    "hands_on_practices": [
        {
            "introduction": "The foundation of von Neumann analysis lies in understanding how spatial difference operators interact with individual Fourier modes. This first exercise guides you through deriving the Fourier symbols—the eigenvalues of these operators—for the fundamental forward and backward difference schemes. By examining the real and imaginary parts of these symbols, you will gain direct insight into the crucial numerical properties of dissipation and dispersion they introduce, setting the stage for analyzing more complex schemes .",
            "id": "3461944",
            "problem": "Consider a linear, shift-invariant spatial discretization on a uniform grid $x_{j} = j\\,\\Delta x$ for a scalar field $u_{j}(t)$ that approximates the spatial derivative operator $\\partial_{x}$. Two one-sided finite-difference operators are defined by $D_{+} u_{j} = \\left(u_{j+1} - u_{j}\\right)/\\Delta x$ and $D_{-} u_{j} = \\left(u_{j} - u_{j-1}\\right)/\\Delta x$. Using the foundational idea of von Neumann stability analysis (VNSA), namely that discrete Fourier modes $v_{j}(\\theta) = \\exp\\!\\left(i j \\theta\\right)$ diagonalize linear, shift-invariant difference operators, derive the Fourier symbols $\\widehat{D_{+}}(\\theta)$ and $\\widehat{D_{-}}(\\theta)$ such that $D_{\\pm} v_{j}(\\theta) = \\widehat{D_{\\pm}}(\\theta)\\, v_{j}(\\theta)$.\n\nThen, consider the semi-discrete approximation to the constant-coefficient linear advection equation $\\partial_{t} u + a\\,\\partial_{x} u = 0$ given by $\\partial_{t} u_{j}(t) + a\\, D u_{j}(t) = 0$, where $a \\in \\mathbb{R}$ is the advection speed and $D$ is either $D_{+}$ or $D_{-}$. Using the complex-valued Fourier symbols, distinguish between numerical dissipation (controlled by the real part of the symbol) and numerical dispersion (controlled by the imaginary part of the symbol), and explain for which sign of $a$ the choice of $D_{+}$ or $D_{-}$ yields stable, dissipative advection. Additionally, determine whether the phase speed associated with either $D_{+}$ or $D_{-}$, when used stably, overestimates or underestimates the exact phase speed for wavenumbers with $0  \\theta  \\pi$.\n\nProvide the pair of Fourier symbols $\\widehat{D_{+}}(\\theta)$ and $\\widehat{D_{-}}(\\theta)$ in closed form as your final answer. No numerical rounding is required and no physical units are to be reported in the final answer.",
            "solution": "The user has provided a problem requesting the derivation and analysis of Fourier symbols for one-sided finite-difference operators in the context of the linear advection equation.\n\n### Step 1: Extract Givens\n-   Uniform spatial grid: $x_{j} = j\\,\\Delta x$\n-   Scalar field on the grid: $u_{j}(t)$\n-   Forward difference operator: $D_{+} u_{j} = \\frac{u_{j+1} - u_{j}}{\\Delta x}$\n-   Backward difference operator: $D_{-} u_{j} = \\frac{u_{j} - u_{j-1}}{\\Delta x}$\n-   Discrete Fourier modes: $v_{j}(\\theta) = \\exp(i j \\theta)$\n-   Eigenvalue definition for Fourier symbols: $D_{\\pm} v_{j}(\\theta) = \\widehat{D_{\\pm}}(\\theta)\\, v_{j}(\\theta)$\n-   Linear advection equation: $\\partial_{t} u + a\\,\\partial_{x} u = 0$, where $a \\in \\mathbb{R}$ is the constant advection speed.\n-   Semi-discrete approximation: $\\partial_{t} u_{j}(t) + a\\, D u_{j}(t) = 0$, where $D$ is either $D_{+}$ or $D_{-}$.\n-   Analysis domain for wavenumber: $0  \\theta  \\pi$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically and mathematically sound. It presents a standard, canonical problem in the field of numerical analysis for partial differential equations. The definitions of the finite-difference operators, the use of discrete Fourier modes, and the formulation of the semi-discrete advection equation are all standard. The problem is self-contained, providing all necessary definitions and equations. The questions asked are precise, well-posed, and admit a unique, verifiable solution through established mathematical procedures. The problem is objective and free from ambiguity or factual errors.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe primary task is to derive the Fourier symbols, $\\widehat{D_{+}}(\\theta)$ and $\\widehat{D_{-}}(\\theta)$, and analyze their properties when used to discretize the linear advection equation.\n\n#### Part 1: Derivation of Fourier Symbols\n\nThe Fourier symbol $\\widehat{D}(\\theta)$ of a linear, shift-invariant difference operator $D$ is its eigenvalue corresponding to the discrete Fourier eigenfunction $v_{j}(\\theta) = \\exp(i j \\theta)$, where $\\theta = k \\Delta x$ is the dimensionless wavenumber, with $k$ being the physical wavenumber.\n\nFor the forward difference operator $D_{+}$, we apply it to $v_{j}(\\theta)$:\n$$\nD_{+} v_{j}(\\theta) = \\frac{v_{j+1}(\\theta) - v_{j}(\\theta)}{\\Delta x} = \\frac{\\exp(i (j+1) \\theta) - \\exp(i j \\theta)}{\\Delta x}\n$$\nFactoring out $\\exp(i j \\theta) = v_{j}(\\theta)$:\n$$\nD_{+} v_{j}(\\theta) = \\frac{\\exp(i j \\theta) (\\exp(i \\theta) - 1)}{\\Delta x} = \\left(\\frac{\\exp(i \\theta) - 1}{\\Delta x}\\right) v_{j}(\\theta)\n$$\nBy comparing this with the definition $D_{+} v_{j}(\\theta) = \\widehat{D_{+}}(\\theta) v_{j}(\\theta)$, we identify the Fourier symbol for $D_{+}$ as:\n$$\n\\widehat{D_{+}}(\\theta) = \\frac{\\exp(i \\theta) - 1}{\\Delta x}\n$$\nFor the backward difference operator $D_{-}$, we perform the same procedure:\n$$\nD_{-} v_{j}(\\theta) = \\frac{v_{j}(\\theta) - v_{j-1}(\\theta)}{\\Delta x} = \\frac{\\exp(i j \\theta) - \\exp(i (j-1) \\theta)}{\\Delta x}\n$$\nFactoring out $\\exp(i j \\theta) = v_{j}(\\theta)$:\n$$\nD_{-} v_{j}(\\theta) = \\frac{\\exp(i j \\theta) (1 - \\exp(-i \\theta))}{\\Delta x} = \\left(\\frac{1 - \\exp(-i \\theta)}{\\Delta x}\\right) v_{j}(\\theta)\n$$\nThus, the Fourier symbol for $D_{-}$ is:\n$$\n\\widehat{D_{-}}(\\theta) = \\frac{1 - \\exp(-i \\theta)}{\\Delta x}\n$$\n\n#### Part 2: Stability Analysis of the Semi-discrete Scheme\n\nThe semi-discrete approximation to the advection equation is $\\partial_{t} u_{j}(t) + a\\, D u_{j}(t) = 0$. We analyze the evolution of a single Fourier mode by substituting $u_{j}(t) = \\hat{u}(\\theta, t) \\exp(i j \\theta)$ into this equation. The operator $\\partial_t$ acts only on $\\hat{u}(\\theta, t)$ and $D$ acts only on the spatial part $\\exp(i j \\theta)$:\n$$\n\\frac{d\\hat{u}(\\theta, t)}{dt} \\exp(i j \\theta) + a\\, \\hat{u}(\\theta, t) D \\exp(i j \\theta) = 0\n$$\nUsing the eigenvalue property $D \\exp(i j \\theta) = \\widehat{D}(\\theta) \\exp(i j \\theta)$, we get:\n$$\n\\frac{d\\hat{u}(\\theta, t)}{dt} \\exp(i j \\theta) + a\\, \\hat{u}(\\theta, t) \\widehat{D}(\\theta) \\exp(i j \\theta) = 0\n$$\nDividing by the non-zero term $\\exp(i j \\theta)$, we obtain an ordinary differential equation (ODE) for the amplitude of the Fourier mode:\n$$\n\\frac{d\\hat{u}}{dt} = -a \\widehat{D}(\\theta) \\hat{u}\n$$\nThe solution to this ODE is $\\hat{u}(\\theta, t) = \\hat{u}(\\theta, 0) \\exp(-a \\widehat{D}(\\theta) t)$. For the scheme to be stable, the amplitude of any mode must not grow unbounded in time, i.e., $|\\exp(-a \\widehat{D}(\\theta) t)| \\le 1$ for all $\\theta$ and for $t  0$. This requires the real part of the exponent to be non-positive:\n$$\n\\text{Re}(-a \\widehat{D}(\\theta)) \\le 0\n$$\nWe analyze this condition for $D=D_{+}$ and $D=D_{-}$. Let's express the symbols in terms of their real and imaginary parts using $\\exp(i\\phi) = \\cos(\\phi) + i\\sin(\\phi)$.\nFor $\\widehat{D_{+}}(\\theta)$:\n$$\n\\widehat{D_{+}}(\\theta) = \\frac{\\cos(\\theta) - 1}{\\Delta x} + i \\frac{\\sin(\\theta)}{\\Delta x}\n$$\nThe stability condition is $\\text{Re}(-a \\widehat{D_{+}}(\\theta)) = -a \\text{Re}(\\widehat{D_{+}}(\\theta)) = -a \\frac{\\cos(\\theta) - 1}{\\Delta x} = a \\frac{1 - \\cos(\\theta)}{\\Delta x} \\le 0$. Since $\\Delta x  0$ and $1 - \\cos(\\theta) \\ge 0$ for all $\\theta$, this inequality holds if and only if $a \\le 0$. Thus, the forward difference scheme ($D_{+}$) is stable for left-propagating waves ($a \\le 0$). The term $a \\frac{1 - \\cos(\\theta)}{\\Delta x}$ represents numerical dissipation, which damps the amplitude of the modes unless $\\theta=0$ (modulo $2\\pi$).\n\nFor $\\widehat{D_{-}}(\\theta)$:\n$$\n\\widehat{D_{-}}(\\theta) = \\frac{1 - (\\cos(\\theta) - i\\sin(\\theta))}{\\Delta x} = \\frac{1 - \\cos(\\theta)}{\\Delta x} + i \\frac{\\sin(\\theta)}{\\Delta x}\n$$\nThe stability condition is $\\text{Re}(-a \\widehat{D_{-}}(\\theta)) = -a \\text{Re}(\\widehat{D_{-}}(\\theta)) = -a \\frac{1 - \\cos(\\theta)}{\\Delta x} \\le 0$. This inequality holds if and only if $-a \\le 0$, or $a \\ge 0$. Thus, the backward difference scheme ($D_{-}$) is stable for right-propagating waves ($a \\ge 0$). This scheme is also dissipative.\n\nThis outcome is the core of the upwinding principle: for stability, the one-sided difference must be taken from the direction from which the wave is coming (\"upwind\").\n\n#### Part 3: Analysis of Numerical Dispersion and Phase Speed\n\nThe solution for a Fourier mode is $u_j(t) = \\hat{u}(0) \\exp(-a t \\text{Re}(\\widehat{D})) \\exp(i (j\\theta - a t \\text{Im}(\\widehat{D})))$. The phase of the wave is $j\\theta - a t \\text{Im}(\\widehat{D}(\\theta))$. By writing $j\\theta = (j\\Delta x)(\\theta/\\Delta x) = kx_j$, the phase can be written as $k x_j - \\omega_{num} t$, where $\\omega_{num} = a \\text{Im}(\\widehat{D}(\\theta))$. The numerical phase speed is $c_{num}(\\theta) = \\omega_{num}/k = a \\text{Im}(\\widehat{D}(\\theta)) / (\\theta/\\Delta x)$.\n\nFor both $D_{+}$ and $D_{-}$, the imaginary part of the symbol is the same:\n$$\n\\text{Im}(\\widehat{D_{+}}(\\theta)) = \\text{Im}(\\widehat{D_{-}}(\\theta)) = \\frac{\\sin(\\theta)}{\\Delta x}\n$$\nTherefore, the numerical phase speed for both schemes is:\n$$\nc_{num}(\\theta) = a \\frac{\\sin(\\theta)/\\Delta x}{\\theta/\\Delta x} = a \\frac{\\sin(\\theta)}{\\theta}\n$$\nThe exact phase speed for the PDE $\\partial_{t} u + a\\,\\partial_{x} u = 0$ is $c_{exact} = a$.\n\nWe compare $c_{num}$ with $c_{exact}$ for $0  \\theta  \\pi$. In this interval, it is a known mathematical inequality that $0  \\sin(\\theta)/\\theta  1$. Let's analyze the stable cases:\n1.  **Stable case for $D_{-}$**: $a  0$. We compare $c_{num} = a \\frac{\\sin(\\theta)}{\\theta}$ with $c_{exact} = a$. Since $a  0$ and $\\frac{\\sin(\\theta)}{\\theta}  1$, it follows that $a \\frac{\\sin(\\theta)}{\\theta}  a$. Thus, $c_{num}  c_{exact}$. The numerical phase speed **underestimates** the exact phase speed.\n2.  **Stable case for $D_{+}$**: $a  0$. We again compare $c_{num} = a \\frac{\\sin(\\theta)}{\\theta}$ with $c_{exact} = a$. Since $a  0$, multiplying the inequality $\\frac{\\sin(\\theta)}{\\theta}  1$ by $a$ reverses the sign: $a \\frac{\\sin(\\theta)}{\\theta}  a$. Thus, $c_{num}  c_{exact}$. The numerical phase speed **overestimates** the exact phase speed.\n\nWhile the algebraic value of the phase speed is overestimated for $a0$, it is crucial to note that the magnitude of the speed is always underestimated in both stable cases. $|c_{num}| = |a \\frac{\\sin\\theta}{\\theta}| = |a| \\frac{\\sin\\theta}{\\theta}  |a| = |c_{exact}|$. This means that for all wavenumbers $\\theta \\in (0, \\pi)$, the numerical waves travel slower than the true waves, a phenomenon known as phase lag. This is a form of numerical dispersion, as the speed depends on the wavenumber $\\theta$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\exp(i\\theta) - 1}{\\Delta x}  \\frac{1 - \\exp(-i\\theta)}{\\Delta x}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from semi-discrete operators to a fully-discrete scheme, this practice challenges you to perform a complete von Neumann stability analysis for the canonical first-order upwind method. By combining a forward-in-time step with a backward-in-space difference, you will derive the scheme's amplification factor, $G(\\theta)$. This process culminates in deriving the celebrated Courant-Friedrichs-Lewy (CFL) condition, a cornerstone of numerical analysis that dictates the maximum stable time step for explicit advection schemes .",
            "id": "3461957",
            "problem": "Consider the linear advection partial differential equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a0$. Let a uniform spatial grid be given by $x_{j} = j\\,\\Delta x$ and discrete time levels $t^{n} = n\\,\\Delta t$, with unknowns $u_{j}^{n} \\approx u(x_{j}, t^{n})$. For $a0$, the first-order upwind finite difference scheme advances $u_{j}^{n}$ to $u_{j}^{n+1}$ by using information from the upwind direction. Assume periodic boundary conditions so that a discrete Fourier mode is well-defined on the grid.\n\nStarting from first principles of von Neumann stability analysis, namely that a linear, translation-invariant difference scheme acts diagonally on Fourier modes $e^{\\mathrm{i} j \\theta}$ and that stability is characterized by the requirement that the spectral amplification factor $G(\\theta)$ satisfies $\\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)| \\leq 1$, derive the discrete Fourier symbol of the first-order upwind scheme for $a0$ and determine the largest Courant-Friedrichs-Lewy (CFL) number $\\lambda_{\\max}$ such that the scheme is stable in the von Neumann sense. Here the CFL number is $\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$. Your final answer must be the single real number $\\lambda_{\\max}$, with no rounding required.",
            "solution": "The problem statement is evaluated and found to be valid. It is a well-posed, scientifically grounded problem from the field of numerical analysis for partial differential equations (PDEs), with all necessary information provided.\n\nThe linear advection equation is given by\n$$u_{t} + a u_{x} = 0$$\nwhere the advection speed $a$ is a positive constant, $a  0$. We discretize this PDE on a uniform grid with spatial step size $\\Delta x$ and time step size $\\Delta t$. The discrete points are $(x_j, t^n) = (j\\,\\Delta x, n\\,\\Delta t)$, and the numerical solution at these points is denoted by $u_j^n \\approx u(x_j, t^n)$.\n\nThe first-order upwind scheme is constructed by using a forward difference in time and a one-sided difference in space. For $a0$, the characteristic information propagates from left to right (in the direction of increasing $x$). Therefore, the \"upwind\" direction is the negative $x$-direction. This dictates the use of a first-order backward difference for the spatial derivative $u_x$:\n$$u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}$$\n$$u_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}$$\nSubstituting these approximations into the PDE yields the finite difference equation:\n$$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left(\\frac{u_j^n - u_{j-1}^n}{\\Delta x}\\right) = 0$$\nWe can rearrange this equation to solve for the solution at the next time step, $u_j^{n+1}$:\n$$u_j^{n+1} = u_j^n - \\frac{a\\,\\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n)$$\nIntroducing the Courant-Friedrichs-Lewy (CFL) number, $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$, the scheme becomes:\n$$u_j^{n+1} = u_j^n - \\lambda(u_j^n - u_{j-1}^n)$$\n$$u_j^{n+1} = (1 - \\lambda) u_j^n + \\lambda u_{j-1}^n$$\nThis is the explicit expression for the first-order upwind scheme for $a0$.\n\nTo perform the von Neumann stability analysis, we consider the behavior of a single Fourier mode on the grid. Assuming periodic boundary conditions, we can represent the solution as a superposition of modes of the form $u_j^n = \\hat{u}^n(k) e^{\\mathrm{i} k x_j}$, where $k$ is the wavenumber. For a linear scheme, it is sufficient to analyze a single mode. Let $u_j^n$ be of the form:\n$$u_j^n = G(\\theta)^n e^{\\mathrm{i} j \\theta}$$\nHere, $\\theta = k \\Delta x$ is the dimensionless wavenumber or phase angle, and $G(\\theta)$ is the amplification factor. The solution at the next time step is $u_j^{n+1} = G(\\theta)^{n+1} e^{\\mathrm{i} j \\theta}$. Substituting this ansatz into the difference scheme gives:\n$$G(\\theta)^{n+1} e^{\\mathrm{i} j \\theta} = (1 - \\lambda) G(\\theta)^n e^{\\mathrm{i} j \\theta} + \\lambda G(\\theta)^n e^{\\mathrm{i} (j-1) \\theta}$$\nWe can factor out $G(\\theta)^n$ (for a non-trivial solution) and $e^{\\mathrm{i} j \\theta}$:\n$$G(\\theta) e^{\\mathrm{i} j \\theta} = \\left( (1 - \\lambda) e^{\\mathrm{i} j \\theta} + \\lambda e^{\\mathrm{i} (j-1) \\theta} \\right)$$\n$$G(\\theta) e^{\\mathrm{i} j \\theta} = \\left( (1 - \\lambda) + \\lambda e^{-\\mathrm{i} \\theta} \\right) e^{\\mathrm{i} j \\theta}$$\nDividing both sides by the common factor $e^{\\mathrm{i} j \\theta}$ yields the amplification factor $G(\\theta)$, which is the discrete Fourier symbol of the scheme:\n$$G(\\theta) = 1 - \\lambda + \\lambda e^{-\\mathrm{i} \\theta}$$\nThe scheme is stable in the von Neumann sense if the magnitude of the amplification factor is less than or equal to $1$ for all possible values of $\\theta \\in [-\\pi, \\pi]$. The condition is:\n$$|G(\\theta)| \\le 1 \\quad \\forall \\theta$$\nTo analyze this condition, we compute the squared magnitude of $G(\\theta)$. Using Euler's formula, $e^{-\\mathrm{i} \\theta} = \\cos(\\theta) - \\mathrm{i} \\sin(\\theta)$, we can express $G(\\theta)$ in terms of its real and imaginary parts:\n$$G(\\theta) = (1 - \\lambda + \\lambda \\cos(\\theta)) - \\mathrm{i} (\\lambda \\sin(\\theta))$$\nThe squared magnitude is $|G(\\theta)|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2$:\n$$|G(\\theta)|^2 = (1 - \\lambda + \\lambda \\cos(\\theta))^2 + (-\\lambda \\sin(\\theta))^2$$\n$$|G(\\theta)|^2 = (1 - \\lambda(1 - \\cos(\\theta)))^2 + \\lambda^2 \\sin^2(\\theta)$$\nExpanding the terms:\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(1 - \\cos(\\theta))^2 + \\lambda^2 \\sin^2(\\theta)$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(1 - 2\\cos(\\theta) + \\cos^2(\\theta)) + \\lambda^2 \\sin^2(\\theta)$$\nUsing the identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$:\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(1 - 2\\cos(\\theta) + 1)$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(2 - 2\\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + 2\\lambda^2(1 - \\cos(\\theta))$$\nFactoring out the common terms:\n$$|G(\\theta)|^2 = 1 + (2\\lambda^2 - 2\\lambda)(1 - \\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\lambda)(1 - \\cos(\\theta))$$\nThe stability condition $|G(\\theta)|^2 \\le 1$ becomes:\n$$1 - 2\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\le 1$$\n$$-2\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\le 0$$\nDividing by $-2$ reverses the inequality:\n$$\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\ge 0$$\nWe analyze the signs of the factors.\n1. The CFL number $\\lambda = \\frac{a \\Delta t}{\\Delta x}$ must be non-negative, since $a0$, $\\Delta t  0$, and $\\Delta x  0$. So, $\\lambda \\ge 0$.\n2. The term $(1 - \\cos(\\theta))$ is always non-negative for any real $\\theta$, since $\\cos(\\theta) \\le 1$. Specifically, $0 \\le (1 - \\cos(\\theta)) \\le 2$.\n\nSince $\\lambda \\ge 0$ and $(1 - \\cos(\\theta)) \\ge 0$, the inequality $\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\ge 0$ is satisfied for all $\\theta$ if and only if the remaining factor is also non-negative:\n$$1 - \\lambda \\ge 0$$\nThis implies that $\\lambda \\le 1$.\nCombining the two conditions on $\\lambda$, the scheme is stable if and only if $0 \\le \\lambda \\le 1$.\nThe question asks for the largest CFL number $\\lambda_{\\max}$ for which the scheme is stable. Based on our derived stability region, this value is $1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Stability ensures a solution does not diverge, but accuracy demands a closer look at how well the scheme propagates physical waves. This exercise analyzes the leapfrog scheme, a method that is non-dissipative but introduces significant numerical dispersion. You will derive the discrete dispersion relation and compute the numerical group velocity, $v_g(\\theta)$, which governs the propagation of wavepackets. This analysis reveals how different Fourier components travel at incorrect speeds, a critical consideration for assessing the fidelity of wave simulations .",
            "id": "3461974",
            "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a \\in \\mathbb{R}$ on a periodic domain. Discretize in space with a uniform grid of spacing $\\Delta x$ and in time with step $\\Delta t$. Let $\\nu = a\\,\\Delta t/\\Delta x$ denote the Courant number. Consider the leapfrog-in-time, centered-in-space linear scheme\n$$\n\\frac{u^{n+1}_{j} - u^{n-1}_{j}}{2\\,\\Delta t} + a\\,\\frac{u^{n}_{j+1} - u^{n}_{j-1}}{2\\,\\Delta x} = 0.\n$$\nUsing the von Neumann Fourier mode ansatz $u^{n}_{j} = \\hat{u}\\,\\exp\\!\\big(i\\,j\\,\\theta - i\\,\\omega(\\theta)\\,n\\,\\Delta t\\big)$ with dimensionless wavenumber $\\theta \\in [-\\pi,\\pi]$ (in radians) and physical wavenumber $k = \\theta/\\Delta x$, derive the discrete dispersion relation linking $\\omega(\\theta)$ and $\\theta$. Then, from first principles, compute the group velocity $v_{g}(\\theta) = \\partial \\omega/\\partial k$ as an explicit function of $\\theta$ and $\\nu$, and compare it to the exact continuum group velocity $a$. Finally, using a small-$\\theta$ series obtained from your dispersion relation, quantify the leading-order relative error in the group velocity for a narrowband Gaussian wavepacket centered at $\\theta_{0}$ with $|\\theta_{0}| \\ll 1$, and discuss the implications for the accuracy of the propagation of such a wavepacket, including the role of spectral bandwidth.\n\nYour final answer must be a single closed-form analytic expression for the computed discrete group velocity $v_{g}(\\theta)$ in terms of $a$, $\\nu$, and $\\theta$ (no units in the final answer box). State angles in radians throughout. No numerical rounding is required.",
            "solution": "The problem statement has been critically validated and is deemed to be scientifically grounded, well-posed, objective, and self-contained. It presents a standard, non-trivial problem in the numerical analysis of partial differential equations, specifically concerning the dispersive properties of the leapfrog finite difference scheme for the linear advection equation. All provided information is consistent and sufficient for a rigorous derivation and analysis. The problem is therefore valid.\n\nWe begin with the one-dimensional linear advection equation, $u_{t} + a\\,u_{x} = 0$, where $a$ is a constant speed. The proposed numerical scheme is the leapfrog-in-time, centered-in-space discretization:\n$$\n\\frac{u^{n+1}_{j} - u^{n-1}_{j}}{2\\,\\Delta t} + a\\,\\frac{u^{n}_{j+1} - u^{n}_{j-1}}{2\\,\\Delta x} = 0\n$$\nTo analyze the scheme's dispersive properties, we substitute the von Neumann Fourier mode ansatz, $u^{n}_{j} = \\hat{u}\\,\\exp\\!\\big(i\\,j\\,\\theta - i\\,\\omega(\\theta)\\,n\\,\\Delta t\\big)$. Here, $j$ and $n$ are the discrete space and time indices, $\\Delta x$ and $\\Delta t$ are the grid spacing and time step, $\\theta$ is the dimensionless wavenumber, and $\\omega(\\theta)$ is the numerical frequency.\n\nThe terms in the scheme become:\n- $u^{n+1}_{j} = u^{n}_{j}\\,\\exp(-i\\,\\omega\\,\\Delta t)$\n- $u^{n-1}_{j} = u^{n}_{j}\\,\\exp(i\\,\\omega\\,\\Delta t)$\n- $u^{n}_{j+1} = u^{n}_{j}\\,\\exp(i\\,\\theta)$\n- $u^{n}_{j-1} = u^{n}_{j}\\,\\exp(-i\\,\\theta)$\n\nSubstituting these into the finite difference equation yields:\n$$\n\\frac{u^{n}_{j}\\,\\exp(-i\\,\\omega\\,\\Delta t) - u^{n}_{j}\\,\\exp(i\\,\\omega\\,\\Delta t)}{2\\,\\Delta t} + a\\,\\frac{u^{n}_{j}\\,\\exp(i\\,\\theta) - u^{n}_{j}\\,\\exp(-i\\,\\theta)}{2\\,\\Delta x} = 0\n$$\nFor a non-trivial solution ($u^{n}_{j} \\neq 0$), we can divide by $u^{n}_{j}$:\n$$\n\\frac{\\exp(-i\\,\\omega\\,\\Delta t) - \\exp(i\\,\\omega\\,\\Delta t)}{2\\,\\Delta t} + a\\,\\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2\\,\\Delta x} = 0\n$$\nUsing Euler's identity, $\\sin(z) = \\frac{\\exp(i\\,z) - \\exp(-i\\,z)}{2i}$, the equation simplifies to:\n$$\n\\frac{-2i\\,\\sin(\\omega\\,\\Delta t)}{2\\,\\Delta t} + a\\,\\frac{2i\\,\\sin(\\theta)}{2\\,\\Delta x} = 0\n$$\n$$\n-\\frac{i\\,\\sin(\\omega\\,\\Delta t)}{\\Delta t} + \\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x} = 0\n$$\nDividing by $i$ and rearranging gives the implicit discrete dispersion relation:\n$$\n\\frac{\\sin(\\omega\\,\\Delta t)}{\\Delta t} = \\frac{a\\,\\sin(\\theta)}{\\Delta x}\n$$\nIntroducing the Courant number, $\\nu = a\\,\\Delta t/\\Delta x$, we obtain a more compact form:\n$$\n\\sin(\\omega(\\theta)\\,\\Delta t) = \\nu\\,\\sin(\\theta)\n$$\nThis relation is valid for real-valued $\\omega$ provided that $|\\nu\\,\\sin(\\theta)| \\le 1$. Since $|\\sin(\\theta)| \\le 1$, this requires the Courant-Friedrichs-Lewy (CFL) stability condition $|\\nu| \\le 1$. Assuming stability, we can write the explicit dispersion relation:\n$$\n\\omega(\\theta) = \\frac{1}{\\Delta t}\\arcsin(\\nu\\,\\sin(\\theta))\n$$\nNext, we compute the discrete group velocity, defined as $v_{g}(\\theta) = \\frac{\\partial \\omega}{\\partial k}$, where $k$ is the physical wavenumber, related to the dimensionless wavenumber $\\theta$ by $k = \\theta/\\Delta x$. Using the chain rule, we can write:\n$$\nv_{g}(\\theta) = \\frac{\\partial \\omega}{\\partial k} = \\frac{\\partial \\omega}{\\partial \\theta}\\frac{\\partial \\theta}{\\partial k}\n$$\nFrom $\\theta = k\\,\\Delta x$, we find $\\frac{\\partial \\theta}{\\partial k} = \\Delta x$. We now differentiate $\\omega(\\theta)$ with respect to $\\theta$:\n$$\n\\frac{\\partial \\omega}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta}\\left[ \\frac{1}{\\Delta t}\\arcsin(\\nu\\,\\sin(\\theta)) \\right] = \\frac{1}{\\Delta t} \\cdot \\frac{1}{\\sqrt{1 - (\\nu\\,\\sin(\\theta))^{2}}} \\cdot \\frac{\\partial}{\\partial \\theta}(\\nu\\,\\sin(\\theta))\n$$\n$$\n\\frac{\\partial \\omega}{\\partial \\theta} = \\frac{1}{\\Delta t} \\frac{\\nu\\,\\cos(\\theta)}{\\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}}\n$$\nThe group velocity is therefore:\n$$\nv_{g}(\\theta) = \\Delta x \\cdot \\frac{\\partial \\omega}{\\partial \\theta} = \\Delta x \\cdot \\left( \\frac{\\nu\\,\\cos(\\theta)}{\\Delta t \\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}} \\right)\n$$\nSubstituting $\\nu = a\\,\\Delta t/\\Delta x$:\n$$\nv_{g}(\\theta) = \\Delta x \\cdot \\left( \\frac{(a\\,\\Delta t/\\Delta x)\\,\\cos(\\theta)}{\\Delta t \\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}} \\right) = \\frac{a\\,\\cos(\\theta)}{\\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}}\n$$\nThis is the discrete group velocity for the leapfrog scheme. For the continuum equation, the exact dispersion relation is $\\omega(k) = ak$, which yields an exact group velocity $v_{g}^{\\text{exact}} = \\frac{\\partial \\omega}{\\partial k} = a$. The continuum problem is non-dispersive. In contrast, the numerical group velocity $v_{g}(\\theta)$ depends on the wavenumber $\\theta$, indicating that the scheme introduces numerical dispersion.\n\nTo quantify the error for long wavelengths ($|\\theta| \\ll 1$), we expand $v_{g}(\\theta)$ in a Taylor series around $\\theta=0$. We use the approximations $\\cos(\\theta) \\approx 1 - \\frac{\\theta^{2}}{2}$ and $\\sin^{2}(\\theta) \\approx \\theta^{2}$.\n$$\nv_{g}(\\theta) = \\frac{a(1 - \\frac{\\theta^{2}}{2} + O(\\theta^{4}))}{\\sqrt{1 - \\nu^{2}(\\theta^{2} + O(\\theta^{4}))}} = a\\left(1 - \\frac{\\theta^{2}}{2}\\right)(1 - \\nu^{2}\\theta^{2})^{-1/2} + O(\\theta^{4})\n$$\nUsing the binomial expansion $(1-x)^{-1/2} \\approx 1 + \\frac{1}{2}x$ for small $x$:\n$$\nv_{g}(\\theta) \\approx a\\left(1 - \\frac{\\theta^{2}}{2}\\right)\\left(1 + \\frac{1}{2}\\nu^{2}\\theta^{2}\\right) = a\\left(1 + \\frac{1}{2}\\nu^{2}\\theta^{2} - \\frac{1}{2}\\theta^{2} - \\frac{1}{4}\\nu^{2}\\theta^{4}\\right)\n$$\nKeeping terms up to order $\\theta^{2}$:\n$$\nv_{g}(\\theta) \\approx a\\left(1 + \\frac{1}{2}(\\nu^{2} - 1)\\theta^{2}\\right)\n$$\nThe leading-order relative error in the group velocity is:\n$$\n\\frac{v_{g}(\\theta) - a}{a} \\approx \\frac{1}{2}(\\nu^{2} - 1)\\theta^{2}\n$$\nSince stability requires $\\nu^{2} \\le 1$, the term $\\nu^{2}-1$ is non-positive. Thus, $v_{g}(\\theta) \\le a$ for small $\\theta$. This indicates a lagging phase error: numerical wave components travel slower than their physical counterparts.\n\nFor a narrowband Gaussian wavepacket centered at a low wavenumber $\\theta_{0}$ ($|\\theta_{0}| \\ll 1$), its centroid will propagate at approximately $v_{g}(\\theta_{0})$, which is slightly less than $a$. More importantly, because the group velocity is not constant across the wavepacket's spectral bandwidth, different Fourier components will travel at different speeds. The variation of group velocity with wavenumber, $\\frac{\\partial v_{g}}{\\partial\\theta}$, leads to numerical dispersion, causing the wavepacket to spread and distort its shape over time. A wider spectral bandwidth exacerbates this effect, as it involves a wider range of group velocities, leading to more rapid un-physical spreading of the packet. At the highest resolvable wavenumber, $\\theta = \\pi$, the group velocity is $v_{g}(\\pi) = -a$, meaning these short waves propagate backwards, a severe numerical artifact of this scheme.",
            "answer": "$$\\boxed{\\frac{a\\,\\cos(\\theta)}{\\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}}}$$"
        }
    ]
}