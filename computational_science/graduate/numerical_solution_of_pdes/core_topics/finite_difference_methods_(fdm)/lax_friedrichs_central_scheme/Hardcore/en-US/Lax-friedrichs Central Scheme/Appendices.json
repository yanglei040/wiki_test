{
    "hands_on_practices": [
        {
            "introduction": "Before deploying a numerical scheme, we must understand its fundamental properties, chief among them its rate of convergence. This practice establishes the baseline performance of the Lax-Friedrichs scheme by combining theoretical analysis with a hands-on computational study . You will first derive the scheme's order of accuracy by analyzing its local truncation error for the linear advection equation, and then verify this theoretical prediction by implementing a grid refinement study to measure the convergence rate experimentally.",
            "id": "3413906",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ on the periodic domain $x \\in [0,L]$ with a smooth periodic initial condition $u(x,0) = u_0(x)$. Use the Lax-Friedrichs central scheme to approximate the solution. The Lax-Friedrichs scheme advances a grid function $u_j^n \\approx u(x_j,t^n)$ on a uniform grid $x_j = j\\,\\Delta x$ with time step $\\Delta t$ by combining neighbor averaging and a centered difference in space with a forward difference in time. Periodic boundary conditions are imposed by treating indices modulo the number of grid points. \n\nYour tasks are to:\n1) Derive, from first principles using Taylor expansion and the definition of local truncation error, the predicted rate of convergence (the order of accuracy) of the Lax-Friedrichs central scheme for this problem when the Courant-Friedrichs-Lewy (CFL) number $\\lambda = a\\,\\Delta t/\\Delta x$ is held fixed in $(0,1)$ as $\\Delta x \\to 0$ with $\\Delta t \\propto \\Delta x$.\n2) Design and implement a grid refinement study that computes the solution at a fixed final time $T$ for a sequence of grids $\\Delta x_k = L/N_k$ with $N_{k+1} = 2 N_k$, compares against the exact solution $u(x,T) = u_0(x - a T)$ (with periodicity), and measures the discrete $L^2$-norm of the error $e_k = \\left(\\Delta x_k \\sum_j \\lvert u_j^N - u(x_j,T) \\rvert^2 \\right)^{1/2}$. Use these errors to compute the experimental order of convergence by fitting a straight line to $(\\log \\Delta x_k, \\log e_k)$ and taking the slope.\n3) State the theoretically predicted convergence rate from your derivation in item 1), and verify it numerically using the refinement study in item 2).\n\nUse the following test suite. For each test case, take $L = 1$, periodic boundary conditions, and the exact solution $u(x,T) = u_0(x - a T)$ where the shift is taken modulo $L$. Use a time step $\\Delta t$ determined from the specified CFL number as $\\Delta t = \\text{CFL} \\cdot \\Delta x / \\lvert a \\rvert$ for each grid; if $a = 0$, take $\\Delta t = \\text{CFL} \\cdot \\Delta x$ (not used in these tests). Advance in time with steps of size $\\Delta t$, and if $T$ is not an integer multiple of $\\Delta t$, use a final shorter step so that the total simulated time is exactly $T$. For each test case, use $N_k = N_0 \\cdot 2^k$ for $k = 0,1,2,3$ (four refinement levels). The discrete $L^2$ error must be computed at the grid nodes $x_j = j\\,\\Delta x$ for $j = 0,1,\\dots,N_k-1$.\n\nTest cases:\n- Case A: $a = 1$, $T = 0.5$, $\\text{CFL} = 0.9$, $N_0 = 50$, $u_0(x) = \\sin(2\\pi x) + \\tfrac{1}{2}\\sin(4\\pi x)$.\n- Case B: $a = -2$, $T = 0.25$, $\\text{CFL} = 0.9$, $N_0 = 40$, $u_0(x) = \\cos(2\\pi x)$.\n- Case C: $a = 0.5$, $T = 1$, $\\text{CFL} = 0.99$, $N_0 = 60$, $u_0(x) = \\sin(2\\pi x) + \\tfrac{1}{4}\\sin(6\\pi x)$.\n\nAll angles implicitly used in trigonometric functions are in radians. No physical units are involved. The numerical answers for each test case are the observed experimental orders of convergence, each represented as a real number. Your program should produce a single line of output containing the observed orders for the three test cases as a comma-separated list enclosed in square brackets (for example, $[p_A,p_B,p_C]$). The output numbers must be floats.\n\nYour implementation must be a complete, runnable program that:\n- Implements the Lax-Friedrichs central scheme with periodic boundary conditions as described above.\n- Runs the three test cases, performing the refinement study for each one.\n- Computes the discrete $L^2$ errors and obtains the experimental order of convergence by a least-squares linear fit of $\\log e_k$ versus $\\log \\Delta x_k$ over the four refinement levels.\n- Prints only the list $[p_A,p_B,p_C]$ as described.",
            "solution": "The problem is assessed to be valid. It is scientifically sound, self-contained, well-posed, and directly pertains to the specified topic in numerical analysis. The provided parameters and conditions are sufficient and consistent for a unique solution to be determined.\n\nThe problem requires a three-part response: a theoretical derivation of the convergence rate for the Lax-Friedrichs scheme, the design and implementation of a numerical experiment to measure this rate, and a comparison between the theoretical and experimental results.\n\n### Part 1: Theoretical Order of Convergence\n\nThe one-dimensional linear advection equation is given by\n$$\nu_t + a\\,u_x = 0\n$$\nwhere $u(x,t)$ is the conserved quantity, $t$ is time, $x$ is the spatial coordinate, and $a$ is the constant wave speed. We are given a periodic domain $x \\in [0,L]$ and a smooth periodic initial condition $u(x,0) = u_0(x)$.\n\nThe Lax-Friedrichs central scheme for this equation on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$ is given by\n$$\nu_j^{n+1} = \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\frac{a\\,\\Delta t}{2\\,\\Delta x}(u_{j+1}^n - u_{j-1}^n)\n$$\nwhere $u_j^n$ is the numerical approximation of the solution $u(x_j, t^n)$ at grid point $x_j=j\\,\\Delta x$ and time $t^n=n\\,\\Delta t$.\n\nTo determine the order of accuracy, we calculate the local truncation error, $\\tau_j^n$. The truncation error is found by substituting the exact solution $u(x,t)$ into the finite difference equation and normalizing appropriately. Let $L_{\\Delta t, \\Delta x}$ be the difference operator associated with the scheme:\n$$\nL_{\\Delta t, \\Delta x}(u_j^n) \\equiv \\frac{u_j^{n+1} - \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)}{\\Delta t} + \\frac{a}{2\\,\\Delta x}(u_{j+1}^n - u_{j-1}^n) = 0\n$$\nThe local truncation error $\\tau_j^n$ is defined by applying this operator to the exact solution $u(x,t)$ at the point $(x_j, t^n)$:\n$$\n\\tau_j^n = L_{\\Delta t, \\Delta x}(u(x_j, t^n))\n$$\nWe use Taylor series to expand the terms $u(x_j, t^{n+1})$, $u(x_{j+1}, t^n)$, and $u(x_{j-1}, t^n)$ around the point $(x_j, t^n)$. Let $u$ and its partial derivatives $u_t, u_x, u_{tt}, u_{xx}, \\dots$ denote their values at $(x_j, t^n)$.\n\nThe expansions are:\n$$\nu(x_j, t^{n+1}) = u + u_t \\Delta t + \\frac{1}{2} u_{tt} (\\Delta t)^2 + \\frac{1}{6} u_{ttt} (\\Delta t)^3 + O((\\Delta t)^4)\n$$\n$$\nu(x_{j\\pm1}, t^n) = u \\pm u_x \\Delta x + \\frac{1}{2} u_{xx} (\\Delta x)^2 \\pm \\frac{1}{6} u_{xxx} (\\Delta x)^3 + \\frac{1}{24} u_{xxxx} (\\Delta x)^4 + O((\\Delta x)^5)\n$$\nFrom the second expansion, we derive expressions for the spatial average and difference terms in the scheme:\n$$\n\\frac{1}{2}(u(x_{j+1}, t^n) + u(x_{j-1}, t^n)) = u + \\frac{1}{2} u_{xx} (\\Delta x)^2 + \\frac{1}{24} u_{xxxx} (\\Delta x)^4 + O((\\Delta x)^6)\n$$\n$$\n\\frac{a}{2\\,\\Delta x}(u(x_{j+1}, t^n) - u(x_{j-1}, t^n)) = \\frac{a}{2\\,\\Delta x}(2u_x \\Delta x + \\frac{1}{3}u_{xxx}(\\Delta x)^3 + O((\\Delta x)^5)) = a\\,u_x + \\frac{a}{6}u_{xxx}(\\Delta x)^2 + O((\\Delta x)^4)\n$$\nNow, we substitute these expansions into the expression for $\\tau_j^n$:\n$$\n\\tau_j^n = \\frac{1}{\\Delta t} \\left[ \\left(u + u_t \\Delta t + \\frac{u_{tt}}{2}(\\Delta t)^2 + \\dots\\right) - \\left(u + \\frac{u_{xx}}{2}(\\Delta x)^2 + \\dots\\right) \\right] + \\left(a\\,u_x + \\frac{a u_{xxx}}{6}(\\Delta x)^2 + \\dots\\right)\n$$\nRearranging the terms, we get:\n$$\n\\tau_j^n = (u_t + a\\,u_x) + \\frac{u_{tt}}{2}\\Delta t - \\frac{u_{xx}}{2\\Delta t}(\\Delta x)^2 + O((\\Delta t)^2, (\\Delta x)^2)\n$$\nSince $u(x,t)$ is the exact solution to the PDE, the term $(u_t + a\\,u_x)$ is zero. The leading terms of the truncation error are:\n$$\n\\tau_j^n = \\frac{1}{2} u_{tt} \\Delta t - \\frac{1}{2\\Delta t} u_{xx} (\\Delta x)^2 + \\text{H.O.T.}\n$$\nTo simplify this expression, we use the PDE itself to relate time and space derivatives. Since $u_t = -a\\,u_x$, we can differentiate with respect to time to get $u_{tt} = (-a\\,u_x)_t = -a\\,u_{xt} = -a\\,(u_t)_x = -a\\,(-a\\,u_x)_x = a^2 u_{xx}$. Substituting $u_{tt} = a^2 u_{xx}$ into the error expression:\n$$\n\\tau_j^n = \\frac{1}{2} (a^2 u_{xx}) \\Delta t - \\frac{1}{2\\Delta t} u_{xx} (\\Delta x)^2 + \\text{H.O.T.}\n$$\n$$\n\\tau_j^n = \\frac{u_{xx}}{2\\Delta t} \\left( a^2 (\\Delta t)^2 - (\\Delta x)^2 \\right) + \\text{H.O.T.}\n$$\nLet $\\lambda = a\\,\\Delta t/\\Delta x$ be the Courant number as defined in the problem. The expression becomes:\n$$\n\\tau_j^n = \\frac{u_{xx} (\\Delta x)^2}{2\\Delta t} (\\lambda^2 - 1) + \\text{H.O.T.}\n$$\nThe problem specifies that the CFL number, $\\text{CFL} = \\lvert a \\rvert \\Delta t / \\Delta x$, is held fixed as $\\Delta x \\to 0$. This implies $\\Delta t \\propto \\Delta x$. Therefore, the ratio $\\Delta x/\\Delta t$ is a constant, and the leading term of the local truncation error is:\n$$\n\\tau_j^n = O(\\Delta x)\n$$\nAdditionally, since $\\Delta t \\propto \\Delta x$, the error is also $O(\\Delta t)$. Thus, the Lax-Friedrichs scheme is first-order accurate in both space and time. By the Lax Equivalence Theorem, for a consistent and stable scheme, the order of convergence of the global error is the same as the order of the local truncation error. Since the CFL condition $\\lvert a \\rvert \\Delta t / \\Delta x < 1$ ensures stability, the scheme will converge.\n\nTherefore, the theoretically predicted rate of convergence is $p=1$.\n\n### Part 2: Grid Refinement Study\n\nTo experimentally verify the theoretical order of convergence, a grid refinement study is performed. The methodology is as follows:\n1.  For each test case, we solve the problem on a sequence of four grids. The number of grid points is $N_k = N_0 \\cdot 2^k$ for $k=0, 1, 2, 3$. The corresponding grid spacing is $\\Delta x_k = L/N_k$.\n2.  The time step $\\Delta t_k$ for each grid is determined by fixing the CFL number, i.e., $\\Delta t_k = \\text{CFL} \\cdot \\Delta x_k / \\lvert a \\rvert$.\n3.  The numerical solution $u_j^N$ is computed up to the final time $T$. A final, smaller time step is used if $T$ is not an integer multiple of $\\Delta t_k$ to ensure the total simulation time is exactly $T$.\n4.  The error is measured by comparing the numerical solution to the known exact solution, $u(x,T) = u_0(x - aT \\pmod L)$, using the discrete $L^2$-norm:\n    $$\n    e_k = \\left( \\Delta x_k \\sum_{j=0}^{N_k-1} | u_j^N(T) - u(x_j, T) |^2 \\right)^{1/2}\n    $$\n5.  If the method has a convergence rate of $p$, the error is expected to scale as $e_k \\approx C(\\Delta x_k)^p$ for some constant $C$. Taking the logarithm of this relation gives:\n    $$\n    \\log e_k \\approx \\log C + p \\log \\Delta x_k\n    $$\n    This is a linear relationship between $\\log e_k$ and $\\log \\Delta x_k$. The slope of this line is the order of convergence, $p$.\n6.  The experimental order of convergence is computed by performing a least-squares linear regression on the set of points $\\{(\\log \\Delta x_k, \\log e_k)\\}_{k=0}^3$ and finding the slope of the best-fit line.\n\n### Part 3: Numerical Verification\n\nThe implemented program follows the design described in Part 2. It applies the Lax-Friedrichs scheme to each of the three test cases, performs the grid refinement study, and computes the experimental order of convergence. Based on the derivation in Part 1, the experimental order of convergence for each test case is expected to be approximately $1.0$. The final output of the program will list these computed orders.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef lax_friedrichs_step(u, a, dt, dx):\n    \"\"\"\n    Applies one step of the Lax-Friedrichs scheme for u_t + a * u_x = 0.\n    \n    Args:\n        u (np.ndarray): The current solution vector.\n        a (float): The advection speed.\n        dt (float): The time step.\n        dx (float): The spatial step.\n\n    Returns:\n        np.ndarray: The solution vector at the next time step.\n    \"\"\"\n    # Periodic boundary conditions are handled by np.roll\n    u_p1 = np.roll(u, -1)  # u_{j+1}\n    u_m1 = np.roll(u, 1)   # u_{j-1}\n\n    # Lax-Friedrichs update formula\n    u_new = 0.5 * (u_p1 + u_m1) - (a * dt / (2.0 * dx)) * (u_p1 - u_m1)\n    \n    return u_new\n\ndef run_simulation(N, L, a, T, CFL, u0_func):\n    \"\"\"\n    Runs a full simulation for a given grid and parameters.\n    \n    Args:\n        N (int): Number of grid points.\n        L (float): Length of the domain.\n        a (float): Advection speed.\n        T (float): Final time.\n        CFL (float): The CFL number to maintain.\n        u0_func (callable): Function for the initial condition u_0(x).\n\n    Returns:\n        tuple[float, float]: A tuple containing the spatial step dx and the L2 error.\n    \"\"\"\n    dx = L / N\n    x = np.linspace(0, L, N, endpoint=False) # Grid points x_j = j*dx\n    \n    if np.abs(a) > 1e-15:\n        dt = CFL * dx / np.abs(a)\n    else: # Should not happen based on test cases\n        dt = CFL * dx\n\n    u = u0_func(x)\n    \n    current_time = 0.0\n    \n    # Time stepping loop\n    num_steps = int(T / dt)\n    for _ in range(num_steps):\n        u = lax_friedrichs_step(u, a, dt, dx)\n        current_time += dt\n\n    # Final smaller step to reach T exactly\n    final_dt = T - current_time\n    if final_dt > 1e-12:  # Use a small tolerance\n        u = lax_friedrichs_step(u, a, final_dt, dx)\n\n    # Calculate the exact solution at time T\n    # The modulo operator '%' in Python handles periodicity correctly for x in [0,L)\n    u_exact = u0_func((x - a * T) % L)\n    \n    # Compute the discrete L2 error\n    error = np.sqrt(dx * np.sum((u - u_exact)**2))\n    \n    return dx, error\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    test_cases = [\n        # Case A: a=1, T=0.5, CFL=0.9, N0=50, u0=sin(2*pi*x) + 0.5*sin(4*pi*x)\n        {\n            'a': 1.0, 'T': 0.5, 'CFL': 0.9, 'N0': 50, 'L': 1.0,\n            'u0': lambda x: np.sin(2.0 * np.pi * x) + 0.5 * np.sin(4.0 * np.pi * x)\n        },\n        # Case B: a=-2, T=0.25, CFL=0.9, N0=40, u0=cos(2*pi*x)\n        {\n            'a': -2.0, 'T': 0.25, 'CFL': 0.9, 'N0': 40, 'L': 1.0,\n            'u0': lambda x: np.cos(2.0 * np.pi * x)\n        },\n        # Case C: a=0.5, T=1, CFL=0.99, N0=60, u0=sin(2*pi*x) + 0.25*sin(6*pi*x)\n        {\n            'a': 0.5, 'T': 1.0, 'CFL': 0.99, 'N0': 60, 'L': 1.0,\n            'u0': lambda x: np.sin(2.0 * np.pi * x) + 0.25 * np.sin(6.0 * np.pi * x)\n        }\n    ]\n\n    experimental_orders = []\n\n    for case in test_cases:\n        log_dxs = []\n        log_errors = []\n        \n        # Grid refinement loop (4 levels)\n        for k in range(4):\n            N = case['N0'] * (2**k)\n            dx, error = run_simulation(\n                N, case['L'], case['a'], case['T'], case['CFL'], case['u0']\n            )\n            if error > 1e-15: # Avoid log(0)\n                log_dxs.append(np.log(dx))\n                log_errors.append(np.log(error))\n        \n        # Perform linear regression to find the slope (order of convergence)\n        slope, _, _, _, _ = linregress(log_dxs, log_errors)\n        experimental_orders.append(slope)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, experimental_orders))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The true test for the Lax-Friedrichs scheme lies in its ability to handle the nonlinear phenomena it was designed for, particularly shock waves. This exercise moves from the linear advection equation to the nonlinear inviscid Burgers' equation, a prototypical model for shock formation . By applying the scheme to a Riemann problem and comparing the result to the exact solution derived from the Rankine-Hugoniot condition, you will see directly how the scheme's numerical dissipation captures a sharp discontinuity.",
            "id": "3413967",
            "problem": "Consider the scalar conservation law (a first-order nonlinear partial differential equation) for inviscid Burgers flow,\n$$\nu_{t} + \\left(\\tfrac{1}{2}u^{2}\\right)_{x} = 0,\n$$\nposed on the real line with Riemann initial data\n$$\nu(x,0) = \\begin{cases}\nu_{L}, & x < 0,\\\\\nu_{R}, & x > 0,\n\\end{cases}\n$$\nwith left and right states $u_{L}=\\tfrac{3}{2}$ and $u_{R}=-\\tfrac{1}{2}$. The flux $f(u)=\\tfrac{1}{2}u^{2}$ is convex. Use a uniform finite volume mesh with cells $C_{i}=[i\\,\\Delta x,(i+1)\\,\\Delta x]$ and $\\Delta x=1$, so that the discontinuity is at the cell interface between $C_{-1}$ and $C_{0}$. Initialize the cell averages at time $t^{0}=0$ by $u_{i}^{0}=u_{L}$ for $i\\le -1$ and $u_{i}^{0}=u_{R}$ for $i\\ge 0$. Evolve one time step of size $\\Delta t=\\tfrac{2}{5}$ using the canonical Lax–Friedrichs central scheme for scalar conservation laws.\n\nStarting from the finite volume conservation update and the Lax–Friedrichs central numerical flux definition, derive the first-step updates $u_{-1}^{1}$ and $u_{0}^{1}$ and evaluate them for the given data. Then, starting from the Rankine–Hugoniot jump condition, determine the exact self-similar Riemann solution at time $t=\\Delta t$ and compute the exact cell averages in $C_{-1}$ and $C_{0}$ at this time. Define the total absolute error over the two interface cells after one time step as\n$$\nE \\equiv \\left|u_{-1}^{1} - \\bar{u}_{-1}^{\\mathrm{exact}}(\\Delta t)\\right| + \\left|u_{0}^{1} - \\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t)\\right|.\n$$\nCompute $E$ exactly for the parameters above. Express your final answer as an exact fraction with no units.",
            "solution": "The problem is assessed as valid as it is a well-defined exercise in numerical analysis for partial differential equations, using standard models (Burgers' equation), methods (Lax-Friedrichs scheme), and concepts (Riemann problem, Rankine-Hugoniot condition). It is scientifically grounded, self-contained, and objective.\n\nThe solution process involves three main parts:\n1.  Computing the numerical solution in cells $C_{-1}$ and $C_{0}$ after one time step using the Lax-Friedrichs scheme.\n2.  Determining the exact solution of the Riemann problem and calculating the exact cell averages in $C_{-1}$ and $C_{0}$ at the same time.\n3.  Calculating the total absolute error $E$ by comparing the numerical and exact results.\n\n**Part 1: Numerical Solution via Lax-Friedrichs Scheme**\n\nThe scalar conservation law is given by $u_{t} + f(u)_{x} = 0$, with flux $f(u) = \\frac{1}{2}u^{2}$.\nThe finite volume method updates cell averages $u_{i}^{n} \\approx \\frac{1}{\\Delta x}\\int_{C_i} u(x, t^n) dx$ using the conservative formula:\n$$u_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2}^{n} - F_{i-1/2}^{n} \\right)$$\nwhere $F_{i+1/2}^{n}$ is the numerical flux between cells $C_i$ and $C_{i+1}$.\n\nThe canonical Lax-Friedrichs central scheme defines the numerical flux as:\n$$F_{i+1/2} = \\frac{1}{2} \\left[ f(u_{i}) + f(u_{i+1}) \\right] - \\frac{1}{2} \\frac{\\Delta x}{\\Delta t} \\left( u_{i+1} - u_{i} \\right)$$\nFor simplicity, we drop the superscript $n$ for the states at the current time step.\n\nThe given parameters are:\n- Left state: $u_{L} = \\frac{3}{2}$\n- Right state: $u_{R} = -\\frac{1}{2}$\n- Cell width: $\\Delta x = 1$\n- Time step: $\\Delta t = \\frac{2}{5}$\n- Flux function: $f(u) = \\frac{1}{2}u^{2}$\n\nThe initial cell averages at $t^{0}=0$ are specified as $u_{i}^{0} = u_{L} = \\frac{3}{2}$ for $i \\le -1$ and $u_{i}^{0} = u_{R} = -\\frac{1}{2}$ for $i \\ge 0$. We need to compute $u_{-1}^{1}$ and $u_{0}^{1}$.\n\nFirst, we compute the required numerical fluxes at the interfaces $i=-3/2$, $i=-1/2$, and $i=1/2$.\nThe states at time $t^0$ are: $u_{-2}^0 = \\frac{3}{2}$, $u_{-1}^0 = \\frac{3}{2}$, $u_{0}^0 = -\\frac{1}{2}$, $u_{1}^0 = -\\frac{1}{2}$.\nThe ratio $\\frac{\\Delta x}{\\Delta t} = \\frac{1}{2/5} = \\frac{5}{2}$.\n\nFlux $F_{-3/2}$: This flux is between cells $C_{-2}$ and $C_{-1}$.\nThe states are $u_{-2}^0 = u_{-1}^0 = \\frac{3}{2}$. Since the states are equal, the scheme must be consistent, meaning $F_{-3/2} = f(u_{L})$.\n$$F_{-3/2} = \\frac{1}{2} \\left[ f(\\frac{3}{2}) + f(\\frac{3}{2}) \\right] - \\frac{1}{2} \\frac{5}{2} \\left( \\frac{3}{2} - \\frac{3}{2} \\right) = f(\\frac{3}{2}) = \\frac{1}{2}\\left(\\frac{3}{2}\\right)^{2} = \\frac{9}{8}$$\n\nFlux $F_{1/2}$: This flux is between cells $C_{0}$ and $C_{1}$.\nThe states are $u_{0}^0 = u_{1}^0 = -\\frac{1}{2}$. The flux is $F_{1/2} = f(u_{R})$.\n$$F_{1/2} = \\frac{1}{2} \\left[ f(-\\frac{1}{2}) + f(-\\frac{1}{2}) \\right] - \\frac{1}{2} \\frac{5}{2} \\left( -\\frac{1}{2} - (-\\frac{1}{2}) \\right) = f(-\\frac{1}{2}) = \\frac{1}{2}\\left(-\\frac{1}{2}\\right)^{2} = \\frac{1}{8}$$\n\nFlux $F_{-1/2}$: This flux is between cells $C_{-1}$ and $C_{0}$, where the initial discontinuity lies.\nThe states are $u_{-1}^0 = \\frac{3}{2}$ and $u_{0}^0 = -\\frac{1}{2}$.\n$f(u_{-1}^0) = f(\\frac{3}{2}) = \\frac{9}{8}$ and $f(u_{0}^0) = f(-\\frac{1}{2}) = \\frac{1}{8}$.\n$$F_{-1/2} = \\frac{1}{2} \\left[ \\frac{9}{8} + \\frac{1}{8} \\right] - \\frac{1}{2} \\frac{5}{2} \\left( -\\frac{1}{2} - \\frac{3}{2} \\right) = \\frac{1}{2} \\left( \\frac{10}{8} \\right) - \\frac{5}{4} \\left( -2 \\right) = \\frac{10}{16} + \\frac{10}{4} = \\frac{5}{8} + \\frac{20}{8} = \\frac{25}{8}$$\n\nNow we can compute the updated cell averages.\nFor cell $C_{-1}$:\n$$u_{-1}^{1} = u_{-1}^{0} - \\frac{\\Delta t}{\\Delta x} \\left( F_{-1/2} - F_{-3/2} \\right) = \\frac{3}{2} - \\frac{2/5}{1} \\left( \\frac{25}{8} - \\frac{9}{8} \\right)$$\n$$u_{-1}^{1} = \\frac{3}{2} - \\frac{2}{5} \\left( \\frac{16}{8} \\right) = \\frac{3}{2} - \\frac{2}{5} (2) = \\frac{3}{2} - \\frac{4}{5} = \\frac{15 - 8}{10} = \\frac{7}{10}$$\n\nFor cell $C_{0}$:\n$$u_{0}^{1} = u_{0}^{0} - \\frac{\\Delta t}{\\Delta x} \\left( F_{1/2} - F_{-1/2} \\right) = -\\frac{1}{2} - \\frac{2/5}{1} \\left( \\frac{1}{8} - \\frac{25}{8} \\right)$$\n$$u_{0}^{1} = -\\frac{1}{2} - \\frac{2}{5} \\left( -\\frac{24}{8} \\right) = -\\frac{1}{2} - \\frac{2}{5} (-3) = -\\frac{1}{2} + \\frac{6}{5} = \\frac{-5 + 12}{10} = \\frac{7}{10}$$\nThe numerical approximations are $u_{-1}^{1} = \\frac{7}{10}$ and $u_{0}^{1} = \\frac{7}{10}$.\n\n**Part 2: Exact Solution and Cell Averages**\n\nThe Riemann problem has initial states $u_{L} = \\frac{3}{2}$ and $u_{R} = -\\frac{1}{2}$. The characteristic speeds are given by $f'(u) = u$. Since $u_{L} > u_{R}$, the characteristics cross, and the solution is a shock wave.\nThe speed of the shock, $s$, is given by the Rankine-Hugoniot jump condition:\n$$s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}} = \\frac{\\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2}}{u_{R} - u_{L}} = \\frac{1}{2} \\frac{(u_{R}-u_{L})(u_{R}+u_{L})}{u_{R}-u_{L}} = \\frac{u_{L}+u_{R}}{2}$$\nSubstituting the given values:\n$$s = \\frac{\\frac{3}{2} - \\frac{1}{2}}{2} = \\frac{1}{2}$$\nThe shock starts at $x=0$ at $t=0$ and travels with a constant speed $s=\\frac{1}{2}$. Its position at time $t$ is $x_{s}(t) = st = \\frac{1}{2}t$.\nThe exact solution is:\n$$u(x,t) = \\begin{cases} u_{L} = \\frac{3}{2}, & x  x_{s}(t) \\\\ u_{R} = -\\frac{1}{2},  x > x_{s}(t) \\end{cases}$$\nWe need to find the exact cell averages at $t=\\Delta t = \\frac{2}{5}$. At this time, the shock position is $x_{s}(\\Delta t) = \\frac{1}{2} \\cdot \\frac{2}{5} = \\frac{1}{5}$.\n\nThe cells of interest are $C_{-1} = [-1, 0]$ and $C_{0} = [0, 1]$ since $\\Delta x=1$.\nExact average for cell $C_{-1}$: $\\bar{u}_{-1}^{\\mathrm{exact}}(\\Delta t)$\nFor any $x \\in [-1, 0]$, we have $x  \\frac{1}{5}$. Thus, $u(x, \\Delta t) = u_{L} = \\frac{3}{2}$ throughout the entire cell $C_{-1}$.\n$$\\bar{u}_{-1}^{\\mathrm{exact}}(\\Delta t) = \\frac{1}{\\Delta x} \\int_{-1}^{0} u(x, \\Delta t) \\, dx = \\frac{1}{1} \\int_{-1}^{0} \\frac{3}{2} \\, dx = \\frac{3}{2} [x]_{-1}^{0} = \\frac{3}{2}(0 - (-1)) = \\frac{3}{2}$$\n\nExact average for cell $C_{0}$: $\\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t)$\nThe shock at $x_{s} = \\frac{1}{5}$ is inside the cell $C_{0}=[0, 1]$. The cell is partitioned by the shock.\n- For $x \\in [0, \\frac{1}{5})$, $u(x, \\Delta t) = u_{L} = \\frac{3}{2}$.\n- For $x \\in (\\frac{1}{5}, 1]$, $u(x, \\Delta t) = u_{R} = -\\frac{1}{2}$.\nThe exact cell average is:\n$$\\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t) = \\frac{1}{\\Delta x} \\int_{0}^{1} u(x, \\Delta t) \\, dx = \\int_{0}^{1/5} \\frac{3}{2} \\, dx + \\int_{1/5}^{1} \\left(-\\frac{1}{2}\\right) \\, dx$$\n$$\\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t) = \\frac{3}{2} [x]_{0}^{1/5} - \\frac{1}{2} [x]_{1/5}^{1} = \\frac{3}{2} \\left(\\frac{1}{5}\\right) - \\frac{1}{2} \\left(1 - \\frac{1}{5}\\right)$$\n$$\\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t) = \\frac{3}{10} - \\frac{1}{2} \\left(\\frac{4}{5}\\right) = \\frac{3}{10} - \\frac{4}{10} = -\\frac{1}{10}$$\n\n**Part 3: Total Absolute Error Calculation**\n\nThe total absolute error over the two cells is defined as:\n$$E = \\left|u_{-1}^{1} - \\bar{u}_{-1}^{\\mathrm{exact}}(\\Delta t)\\right| + \\left|u_{0}^{1} - \\bar{u}_{0}^{\\mathrm{exact}}(\\Delta t)\\right|$$\nSubstituting the calculated values:\n- $u_{-1}^{1} = \\frac{7}{10}$\n- $\\bar{u}_{-1}^{\\mathrm{exact}} = \\frac{3}{2} = \\frac{15}{10}$\n- $u_{0}^{1} = \\frac{7}{10}$\n- $\\bar{u}_{0}^{\\mathrm{exact}} = -\\frac{1}{10}$\n\n$$E = \\left|\\frac{7}{10} - \\frac{15}{10}\\right| + \\left|\\frac{7}{10} - \\left(-\\frac{1}{10}\\right)\\right|$$\n$$E = \\left|-\\frac{8}{10}\\right| + \\left|\\frac{7}{10} + \\frac{1}{10}\\right|$$\n$$E = \\frac{8}{10} + \\frac{8}{10} = \\frac{16}{10} = \\frac{8}{5}$$\nThe total absolute error is an exact fraction.",
            "answer": "$$\\boxed{\\frac{8}{5}}$$"
        },
        {
            "introduction": "For nonlinear conservation laws, convergence to the single, physically relevant solution requires satisfying an entropy condition. This advanced practice explores the crucial role of numerical dissipation in ensuring this entropy stability . You will analyze a scenario with insufficient dissipation to compute the resulting entropy production, revealing why the correct amount of numerical viscosity is essential for physical fidelity.",
            "id": "3413932",
            "problem": "Consider the scalar conservation law (a first-order Partial Differential Equation (PDE)) $u_{t} + f(u)_{x} = 0$ with Burgers flux $f(u) = \\tfrac{1}{2} u^{2}$. Discretize space on a uniform grid with spacing $\\Delta x = 1$ and consider the semi-discrete Local Lax-Friedrichs (LLF) central scheme\n$$\n\\frac{d}{dt} u_{j}(t) \\;=\\; -\\frac{1}{\\Delta x}\\Big(F(u_{j}(t),u_{j+1}(t)) \\;-\\; F(u_{j-1}(t),u_{j}(t))\\Big),\n$$\nwhere the numerical flux is\n$$\nF(u_{L},u_{R}) \\;=\\; \\frac{1}{2}\\big(f(u_{L}) + f(u_{R})\\big) \\;-\\; \\frac{\\alpha}{2}\\,\\big(u_{R} - u_{L}\\big),\n$$\nwith a uniform dissipation parameter $\\alpha  0$. Take the convex entropy $\\eta(u) = \\tfrac{1}{2} u^{2}$ and its associated physical entropy flux $q(u)$ defined by $q'(u) = \\eta'(u) f'(u)$ with $q(0) = 0$. For the LLF flux, construct a numerical entropy flux $\\widehat{q}(u_{L},u_{R})$ that is consistent with $q(u)$ and compatible with the LLF flux via the entropy variable $v(u) = \\eta'(u)$ and Tadmor’s entropy compatibility condition.\n\nNow fix the dissipation level to be $\\alpha = \\tfrac{3}{2}$, which is strictly below the maximal characteristic speed in the data specified below. Consider the piecewise-constant initial data\n$$\nu_{j}(0) \\;=\\; \\begin{cases}\n3,  j \\le 0,\\\\\n1,  j \\ge 1.\n\\end{cases}\n$$\nDefine the instantaneous discrete entropy residual at cell $j=0$ by\n$$\nS \\;=\\; \\left.\\frac{d}{dt}\\,\\eta\\big(u_{0}(t)\\big)\\right|_{t=0} \\;+\\; \\frac{1}{\\Delta x}\\Big(\\widehat{q}(u_{0}(0),u_{1}(0)) \\;-\\; \\widehat{q}(u_{-1}(0),u_{0}(0))\\Big).\n$$\nStarting only from the definitions above and the requirement of entropy compatibility, derive a valid expression for the numerical entropy flux $\\widehat{q}(u_{L},u_{R})$ for the LLF scheme, then evaluate $S$ for the given data at time $t=0$. Your final answer must be a single real number. Do not include units. Do not round or approximate; report the exact value.",
            "solution": "The problem requires the calculation of the instantaneous discrete entropy residual $S$ at cell $j=0$ for a given initial condition. This involves several steps: deriving the necessary physical and numerical quantities, and then performing the calculation.\n\n**1. Physical and Entropy-Related Functions**\n\nThe scalar conservation law is the inviscid Burgers' equation, $u_{t} + f(u)_{x} = 0$, with a convex flux given by:\n$$f(u) = \\frac{1}{2} u^{2}$$\nThe convex entropy function is given as:\n$$\\eta(u) = \\frac{1}{2} u^{2}$$\nThe entropy variable $v(u)$ is the derivative of the entropy function:\n$$v(u) = \\eta'(u) = u$$\nThe physical entropy flux, $q(u)$, is defined by the compatibility relation $q'(u) = \\eta'(u) f'(u)$ with the condition $q(0)=0$. Since $f'(u) = u$, we have:\n$$q'(u) = v(u) f'(u) = u \\cdot u = u^2$$\nIntegrating with respect to $u$ and applying the condition $q(0)=0$ gives:\n$$q(u) = \\int_0^u s^2 \\,ds = \\frac{1}{3} u^3$$\n\n**2. Numerical Flux and Numerical Entropy Flux**\n\nThe Local Lax-Friedrichs (LLF) numerical flux is given by:\n$$F(u_{L},u_{R}) = \\frac{1}{2}\\big(f(u_{L}) + f(u_{R})\\big) - \\frac{\\alpha}{2}\\,\\big(u_{R} - u_{L}\\big)$$\nThis is a Godunov-type flux of the form $F = \\frac{1}{2}(f_L + f_R) - \\frac{1}{2}Q(u_L, u_R)(u_R - u_L)$, where the numerical dissipation coefficient is $Q(u_L, u_R) = \\alpha$. Following Tadmor's framework, a compatible numerical entropy flux $\\widehat{q}(u_{L},u_{R})$ that is consistent with $q(u)$ can be constructed with the same structure:\n$$\\widehat{q}(u_{L},u_{R}) = \\frac{1}{2}\\big(q(u_{L}) + q(u_{R})\\big) - \\frac{1}{2}Q(u_L, u_R)\\big(\\eta(u_{R}) - \\eta(u_{L})\\big)$$\nSubstituting $Q = \\alpha$ and the expressions for $\\eta(u)$ and $q(u)$:\n$$\\widehat{q}(u_{L},u_{R}) = \\frac{1}{2}\\left(\\frac{1}{3}u_L^3 + \\frac{1}{3}u_R^3\\right) - \\frac{\\alpha}{2}\\left(\\frac{1}{2}u_R^2 - \\frac{1}{2}u_L^2\\right) = \\frac{1}{6}(u_L^3 + u_R^3) - \\frac{\\alpha}{4}(u_R^2 - u_L^2)$$\nThis is the derived expression for the numerical entropy flux.\n\n**3. Entropy Residual Calculation**\n\nThe instantaneous discrete entropy residual at cell $j=0$ is defined as:\n$$S = \\left.\\frac{d}{dt}\\,\\eta\\big(u_{0}(t)\\big)\\right|_{t=0} + \\frac{1}{\\Delta x}\\Big(\\widehat{q}(u_{0}(0),u_{1}(0)) - \\widehat{q}(u_{-1}(0),u_{0}(0))\\Big)$$\nThe first term is evaluated using the chain rule and the semi-discrete scheme:\n$$\\left.\\frac{d}{dt}\\eta(u_0)\\right|_{t=0} = \\eta'(u_0(0)) \\left.\\frac{du_0}{dt}\\right|_{t=0} = v(u_0(0)) \\left[ -\\frac{1}{\\Delta x}\\Big(F(u_0(0), u_1(0)) - F(u_{-1}(0), u_0(0))\\Big) \\right]$$\nThe initial data at $t=0$ is $u_j(0) = 3$ for $j \\le 0$ and $u_j(0) = 1$ for $j \\ge 1$.\nThis gives the states at the relevant interfaces:\n- At interface $j=-1/2$: $u_{-1}(0)=3, u_{0}(0)=3$.\n- At interface $j=1/2$: $u_{0}(0)=3, u_{1}(0)=1$.\nThe parameters are $\\Delta x=1$ and $\\alpha=3/2$. The entropy variable at cell 0 is $v(u_0(0)) = v(3) = 3$.\n\nNow we compute the numerical fluxes at $t=0$:\n- Interface $j=-1/2$: Since $u_{-1}=u_0=3$, the flux is consistent:\n  $$F_{-1/2} = F(3,3) = f(3) = \\frac{1}{2}(3)^2 = \\frac{9}{2}$$\n  $$\\widehat{q}_{-1/2} = \\widehat{q}(3,3) = q(3) = \\frac{1}{3}(3)^3 = 9$$\n- Interface $j=1/2$: Here $u_L=3$ and $u_R=1$.\n  $$F_{1/2} = F(3,1) = \\frac{1}{2}\\left(f(3) + f(1)\\right) - \\frac{3/2}{2}(1-3) = \\frac{1}{2}\\left(\\frac{9}{2} + \\frac{1}{2}\\right) - \\frac{3}{4}(-2) = \\frac{5}{2} + \\frac{3}{2} = 4$$\n  $$\\widehat{q}_{1/2} = \\widehat{q}(3,1) = \\frac{1}{6}(3^3 + 1^3) - \\frac{3/2}{4}(1^2 - 3^2) = \\frac{1}{6}(28) - \\frac{3}{8}(-8) = \\frac{14}{3} + 3 = \\frac{23}{3}$$\n\nFinally, we assemble the expression for $S$:\n$$S = v(3)\\left[ -\\frac{1}{1}(F_{1/2} - F_{-1/2}) \\right] + \\frac{1}{1}(\\widehat{q}_{1/2} - \\widehat{q}_{-1/2})$$\n$$S = 3 \\left( -\\left(4 - \\frac{9}{2}\\right) \\right) + \\left(\\frac{23}{3} - 9\\right)$$\n$$S = 3 \\left( -(-\\frac{1}{2}) \\right) + \\left(\\frac{23 - 27}{3}\\right)$$\n$$S = \\frac{3}{2} - \\frac{4}{3} = \\frac{9 - 8}{6} = \\frac{1}{6}$$\nThe instantaneous discrete entropy residual at cell $j=0$ is $1/6$.",
            "answer": "$$\n\\boxed{\\frac{1}{6}}\n$$"
        }
    ]
}