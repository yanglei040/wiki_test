{
    "hands_on_practices": [
        {
            "introduction": "设计一个优秀的隐式方法不仅仅是选择一个现成的方案，更需要理解其内部参数如何决定其稳定性。本练习将带你从第一性原理出发，为一个两阶段的隐式龙格-库塔方法推导其稳定性函数。通过施加L-稳定性这一对求解刚性问题至关重要的性质，你将亲手确定方法的关键参数，从而深入理解数值方法的理论设计过程 。",
            "id": "3459568",
            "problem": "考虑将两级单对角隐式龙格-库塔 (SDIRK) 方法族应用于线性测试问题 $\\frac{dy}{dt}=\\lambda y$，其中步长为 $h$，且 $z=h\\lambda$。使用由参数 $\\gamma$ 定义的刚性精确两级 SDIRK 表：\n$$\n\\begin{array}{c|cc}\n\\gamma  & \\gamma & 0 \\\\\n1 & 1-\\gamma & \\gamma \\\\\n\\hline\n & 1-\\gamma & \\gamma\n\\end{array}\n$$\n使得 $c_{1}=\\gamma$，$c_{2}=1$，$A=\\begin{pmatrix}\\gamma & 0\\\\ 1-\\gamma & \\gamma\\end{pmatrix}$，且 $b^{\\top}=(1-\\gamma,\\gamma)$，其中刚性精确条件为 $b^{\\top}$ 等于 $A$ 的最后一行。从龙格-库塔阶段定义和单步更新出发（不允许使用简化稳定性公式），推导满足 $y_{n+1}=R(z)\\,y_{n}$ 的线性稳定性函数 $R(z)$ 的封闭形式。然后，通过将 $R(z)$ 的泰勒展开式与 $\\exp(z)$ 的泰勒展开式匹配到 $\\mathcal{O}(z^{3})$ 阶，施加二阶精度条件以确定允许的 $\\gamma$ 值。最后，要求该方法是 L-稳定的，即 A-稳定且满足 $\\lim_{|z|\\to\\infty, \\operatorname{Re}(z)  0}R(z)=0$，并找出在开区间 $(0,1)$ 内实现 L-稳定性的唯一 $\\gamma$ 值。简要解释为什么这个选择对于刚性偏微分方程 (PDE) 的半离散化是理想的。给出 $\\gamma$ 的精确值作为最终答案（不要四舍五入）。",
            "solution": "给定一个带有参数 $\\gamma$ 且具有刚性精确性的两级单对角隐式龙格-库塔 (SDIRK) 方法，该方法应用于线性测试方程 $\\frac{dy}{dt}=\\lambda y$，其中 $z=h\\lambda$。阶段 $Y_{1}$ 和 $Y_{2}$ 以及更新 $y_{n+1}$ 由基本的龙格-库塔阶段方程定义\n$$\nY_{i}=y_{n}+h\\sum_{j=1}^{s}a_{ij}f\\!\\left(Y_{j}\\right),\\quad i=1,\\dots,s,\n$$\n和单步公式\n$$\ny_{n+1}=y_{n}+h\\sum_{j=1}^{s}b_{j}f\\!\\left(Y_{j}\\right),\n$$\n其中 $s=2$ 且 $f(y)=\\lambda y$。使用Butcher表\n$$\nA=\\begin{pmatrix}\\gamma  0\\\\ 1-\\gamma  \\gamma\\end{pmatrix},\\quad b^{\\top}=(1-\\gamma,\\gamma),\\quad c=\\begin{pmatrix}\\gamma\\\\ 1\\end{pmatrix},\n$$\n各阶段满足\n$$\nY_{1}=y_{n}+h\\gamma\\lambda Y_{1},\\qquad Y_{2}=y_{n}+h\\big[(1-\\gamma)\\lambda Y_{1}+\\gamma\\lambda Y_{2}\\big].\n$$\n引入 $z=h\\lambda$。求解第一阶段，\n$$\n(1-\\gamma z)Y_{1}=y_{n}\\quad\\Rightarrow\\quad Y_{1}=\\frac{y_{n}}{1-\\gamma z}.\n$$\n对于第二阶段，\n$$\n(1-\\gamma z)Y_{2}=y_{n}+z(1-\\gamma)Y_{1}=y_{n}+z(1-\\gamma)\\frac{y_{n}}{1-\\gamma z},\n$$\n所以\n$$\nY_{2}=\\frac{y_{n}}{1-\\gamma z}+\\frac{z(1-\\gamma)}{(1-\\gamma z)^{2}}\\,y_{n}=\\frac{1+(1-2\\gamma)z}{(1-\\gamma z)^{2}}\\,y_{n}.\n$$\n根据刚性精确性，$y_{n+1}=Y_{2}$，因此稳定性函数为\n$$\nR(z)=\\frac{y_{n+1}}{y_{n}}=\\frac{1+(1-2\\gamma)z}{(1-\\gamma z)^{2}}.\n$$\n\n为了施加二阶精度，我们要求 $R(z)$ 的泰勒展开式与 $\\exp(z)$ 的泰勒展开式在 $\\mathcal{O}(z^{2})$ 阶的项上相匹配，即，\n$$\nR(z)=1+z+\\tfrac{1}{2}z^{2}+\\mathcal{O}(z^{3}).\n$$\n将 $R(z)$ 在 $z=0$ 附近展开。使用\n$$\n(1-\\gamma z)^{-1}=1+\\gamma z+\\gamma^{2}z^{2}+\\mathcal{O}(z^{3}),\\qquad (1-\\gamma z)^{-2}=\\big((1-\\gamma z)^{-1}\\big)^{2}=1+2\\gamma z+3\\gamma^{2}z^{2}+\\mathcal{O}(z^{3}),\n$$\n我们得到\n$$\nR(z)=\\big(1+(1-2\\gamma)z\\big)\\big(1+2\\gamma z+3\\gamma^{2}z^{2}\\big)+\\mathcal{O}(z^{3}).\n$$\n合并系数：\n$$\nR(z)=1+\\big(2\\gamma+1-2\\gamma\\big)z+\\big(3\\gamma^{2}+2\\gamma(1-2\\gamma)\\big)z^{2}+\\mathcal{O}(z^{3})=1+z+\\big(2\\gamma-\\gamma^{2}\\big)z^{2}+\\mathcal{O}(z^{3}).\n$$\n将 $z^{2}$ 的系数与 $\\tfrac{1}{2}$ 匹配，得到二阶条件\n$$\n2\\gamma-\\gamma^{2}=\\tfrac{1}{2}\\quad\\Longleftrightarrow\\quad \\gamma^{2}-2\\gamma+\\tfrac{1}{2}=0.\n$$\n求解，\n$$\n\\gamma=1\\pm\\frac{1}{\\sqrt{2}}.\n$$\n\n接下来，确保 L-稳定性。根据定义，L-稳定性要求方法是 A-稳定的并且满足 $\\lim_{|z|\\to\\infty, \\operatorname{Re}(z)  0}R(z)=0$。从其封闭形式看，\n$$\nR(z)=\\frac{1+(1-2\\gamma)z}{(1-\\gamma z)^{2}},\n$$\n我们看到对于任何 $\\gamma\\neq 0$，\n$$\n\\lim_{|z|\\to\\infty, \\operatorname{Re}(z)  0}R(z)=0,\n$$\n因为分子是关于 $z$ 的 1 次多项式，而分母是 2 次的。\n\n对于 A-稳定性，只需验证对所有实数 $y$，都有 $|R(\\mathrm{i}y)|\\leq 1$，并在左半平面上应用最大模原理。计算\n$$\n|R(\\mathrm{i}y)|^{2}=\\frac{\\big|1+\\mathrm{i}(1-2\\gamma)y\\big|^{2}}{\\big|(1-\\gamma\\,\\mathrm{i}y)^{2}\\big|^{2}}=\\frac{1+(1-2\\gamma)^{2}y^{2}}{\\big(1+\\gamma^{2}y^{2}\\big)^{2}}.\n$$\n因此，对所有实数 $y$ 都有 $|R(\\mathrm{i}y)|\\leq 1$ 当且仅当\n$$\n1+(1-2\\gamma)^{2}y^{2}\\leq \\big(1+\\gamma^{2}y^{2}\\big)^{2}\\quad\\text{对所有实数 }y,\n$$\n等价于，\n$$\n\\gamma^{4}y^{4}+\\big(2\\gamma^{2}-(1-2\\gamma)^{2}\\big)y^{2}\\geq 0\\quad\\text{对所有实数 }y.\n$$\n由于 $\\gamma^{4}y^{4}\\geq 0$，该不等式对所有 $y$ 成立的充要条件是 $2\\gamma^{2}-(1-2\\gamma)^{2}\\geq 0$，即，\n$$\n2\\gamma^{2}-\\big(1-4\\gamma+4\\gamma^{2}\\big)\\geq 0\\;\\Longleftrightarrow\\;-1+4\\gamma-2\\gamma^{2}\\geq 0\\;\\Longleftrightarrow\\;2\\gamma^{2}-4\\gamma+1\\leq 0.\n$$\n但我们之前求解的二阶条件正是\n$$\n2\\gamma^{2}-4\\gamma+1=0,\n$$\n所以二阶条件的两个根都位于 A-稳定性的边界上，因此都能得到 A-稳定性。结合极限条件，$\\gamma=1\\pm \\frac{1}{\\sqrt{2}}$ 都是 L-稳定的。施加自然限制 $\\gamma\\in(0,1)$ 以使第一阶段的节点在步长内，并避免负权重 $1-\\gamma$，我们选择\n$$\n\\gamma=1-\\frac{1}{\\sqrt{2}}.\n$$\n\n对于刚性偏微分方程 (PDE) 半离散化的解释：在对抛物型或扩散型偏微分方程进行空间离散化后，所得到的系统具有大的负实部特征值。L-稳定的选择 $\\gamma=1-\\frac{1}{\\sqrt{2}}$ 得到的稳定性函数 $R(z)$ 是 A-稳定的，并且由于 $\\lim_{|z|\\to\\infty, \\operatorname{Re}(z)  0}R(z)=0$，它能衰减 $|z|$ 较大的高频分量。这能强烈衰减刚性模态而不会引入伪振荡，从而实现了不受刚性驱动的步长限制的无条件稳定时间步进。\n\n因此，在 $(0,1)$ 区间内确保 L-稳定性的唯一 $\\gamma$ 值为 $\\gamma=1-\\frac{1}{\\sqrt{2}}$。",
            "answer": "$$\\boxed{1-\\frac{1}{\\sqrt{2}}}$$"
        },
        {
            "introduction": "理论分析揭示了L-稳定性在无穷远处具有强耗散的特性，但这在实际计算中意味着什么？本练习将通过一个编程实践来回答这个问题。你将比较L-稳定的后向欧拉法和仅为A-稳定的隐式中点法在求解一个刚性偏微分方程时的表现，亲眼见证缺乏L-稳定性如何导致高频误差污染数值解，从而直观地理解其在刚性问题中的不可或替代性 。",
            "id": "3459566",
            "problem": "考虑一维热传导偏微分方程 (PDE) $u_t = \\nu u_{xx}$，其空间区间为 $[0,1]$，边界条件为齐次狄利克雷边界条件 $u(0,t)=0$ 和 $u(1,t)=0$，初始条件为光滑函数 $u(x,0)=u_0(x)$。使用矩量法，在具有 $M$ 个内部节点的均匀网格上进行二阶中心差分离散化，得到一个形式为 $U'(t) = A U(t)$ 的线性常微分方程 (ODE) 组，其中 $A$ 是由扩散系数 $\\nu$ 缩放的离散拉普拉斯算子。具体而言，设空间网格宽度为 $\\Delta x = 1/(M+1)$，并定义三对角矩阵 $L \\in \\mathbb{R}^{M \\times M}$，其元素对于所有有效索引 $i$ 为 $L_{ii} = -2/\\Delta x^2$、$L_{i,i+1} = 1/\\Delta x^2$ 和 $L_{i,i-1} = 1/\\Delta x^2$，其他元素为零。则 $A = \\nu L$。当 $M$ 中等大时，得到的线性ODE系统是刚性的，因为 $A$ 的特征值具有大的负实部，其量级为 $\\mathcal{O}(\\nu/\\Delta x^2)$。\n\n您的任务是使用此半离散模型，证明隐式中点法（也称为单步Gauss–Legendre方法）是代数稳定（A-稳定）但非L-稳定的，因此不能强烈抑制高频（刚性）模态。相比之下，后向欧拉法既是A-稳定又是L-稳定的，并且它确实能抑制这些模态。为此，请实现并应用以下两种时间积分器到线性系统 $U'(t) = A U(t)$：\n\n- 后向欧拉法：从 $U^n$到 $U^{n+1}$ 的一个时间步求解 $(I - \\Delta t\\, A) U^{n+1} = U^n$。\n- 隐式中点法 (Gauss)：从 $U^n$到 $U^{n+1}$ 的一个时间步求解 $(I - \\tfrac{1}{2}\\Delta t\\, A) U^{n+1} = (I + \\tfrac{1}{2}\\Delta t\\, A) U^n$。\n\n在 $L$ 的离散正弦本征基中进行计算，其特征向量的分量为 $v_m(i) = \\sin\\!\\big(m\\pi\\, i/(M+1)\\big)$，其中 $i \\in \\{1,\\dots,M\\}$ 和 $m \\in \\{1,\\dots,M\\}$。离散内积为 $\\langle u, v \\rangle_{\\Delta x} = \\Delta x \\sum_{i=1}^{M} u_i v_i$，并将每个模态归一化为单位离散范数。向量 $U \\in \\mathbb{R}^M$ 在模态 $m$ 中的模态振幅（系数）定义为离散投影的绝对值 $a_m = |\\langle U, \\widehat{v}_m \\rangle_{\\Delta x}|$，其中 $\\widehat{v}_m$ 是归一化模态。\n\n对于纯模态初始条件，将单个时间步上的模态放大率定义为该步之后与该步之前的模态振幅之比。对于混合模态初始条件，将一个时间步后的高频与低频模态振幅之比定义为 $r = a_{\\text{high}}/a_{\\text{low}}$。\n\n实现一个程序，该程序为以下固定配置和测试套件构建 $A$ 和归一化的本征模态，应用两种积分器进行一个时间步的计算，并报告所要求的模态放大测量值：\n\n- 所有测试共享的固定配置：\n  - 内部节点数：$M = 63$。\n  - 扩散系数：$\\nu = 1$。\n  - 网格宽度：$\\Delta x = 1/(M+1)$。\n  - 离散拉普拉斯矩阵：$A = \\nu L$，如上所述。\n  - 离散内积：$\\langle u, v \\rangle_{\\Delta x} = \\Delta x \\sum_{i=1}^{M} u_i v_i$；用此来归一化模态和计算投影。\n  - 低频模态指数：$m_{\\text{low}} = 1$。\n  - 高频模态指数：$m_{\\text{high}} = M$。\n\n- 测试套件（每个测试使用单个时间步 $N_{\\text{steps}} = 1$）：\n  1. 测试 A (最刚性强调)：初始条件 $U^0 = \\widehat{v}_{m_{\\text{high}}}$，时间步 $\\Delta t_A = 1000\\, \\Delta x^2$。输出一个时间步后的两个浮点模态放大率：首先是隐式中点法在模态 $m_{\\text{high}}$ 中的放大率大小，然后是后向欧拉法的，按此顺序。\n  2. 测试 B (中等刚性)：初始条件 $U^0 = \\widehat{v}_{m_{\\text{high}}}$，时间步 $\\Delta t_B = 1\\, \\Delta x^2$。输出一个时间步后的两个浮点模态放大率：首先是隐式中点法在模态 $m_{\\text{high}}$ 中的放大率大小，然后是后向欧拉法的，按此顺序。\n  3. 测试 C (模态竞争)：初始条件 $U^0 = \\widehat{v}_{m_{\\text{low}}} + \\widehat{v}_{m_{\\text{high}}}$，时间步 $\\Delta t_C = 1000\\, \\Delta x^2$。输出一个时间步后的两个浮点高低频振幅比：首先使用隐式中点法，然后使用后向欧拉法。\n\n您的程序必须：\n- 为每个测试构建 $A$、归一化的本征模态 $\\widehat{v}_{m_{\\text{low}}}$ 和 $\\widehat{v}_{m_{\\text{high}}}$，以及指定的初始数据。\n- 使用每种方法将 $U^0$ 推进一个指定 $\\Delta t$ 的时间步，并使用离散内积计算所需的模态测量值。\n- 生成单行输出，其中包含六个结果，四舍五入到六位小数，以方括号括起来的逗号分隔列表形式，顺序如下：$[\\text{TestA\\_IM},\\text{TestA\\_BE},\\text{TestB\\_IM},\\text{TestB\\_BE},\\text{TestC\\_IM\\_ratio},\\text{TestC\\_BE\\_ratio}]$。\n\n所有数值必须以无量纲浮点数的形式打印，四舍五入到六位小数。不涉及物理单位或角度单位。最后一行必须严格遵循上述列表格式，不得包含任何其他文本。",
            "solution": "问题陈述经评估是科学上合理、适定且自洽的。所有必要的参数、定义和方法都已明确指定，构成了偏微分方程数值分析中的一个标准练习。该问题是有效的，并且可以按所述方式解决。\n\n该问题要求展示后向欧拉法 (BE) 和隐式中点法 (IM) 时间积分格式在应用于由一维热方程 $u_t = \\nu u_{xx}$ 的空间离散化所产生的刚性常微分方程(ODE)组时的稳定性特性差异。\n\n采用中心有限差分格式的矩量法，在具有 $M$ 个内部点和网格宽度 $\\Delta x = 1/(M+1)$ 的均匀网格上，将偏微分方程 (PDE) 转换为一个由 $M$ 个耦合ODE组成的系统，形式为 $U'(t) = A U(t)$。向量 $U(t) \\in \\mathbb{R}^M$ 包含内部网格点上的解值。矩阵 $A = \\nu L$，其中 $L$ 是离散拉普拉斯算子，是一个实对称三对角矩阵。其特征值 $\\lambda_m(A)$ 是实数和负数，由下式给出：\n$$\n\\lambda_m(A) = \\nu \\frac{-4}{\\Delta x^2} \\sin^2\\left(\\frac{m\\pi}{2(M+1)}\\right) \\quad \\text{for } m = 1, \\dots, M.\n$$\n对应的特征向量 $\\widehat{v}_m$ 是离散正弦模态，在指定的离散内积 $\\langle u, v \\rangle_{\\Delta x} = \\Delta x \\sum_{i=1}^{M} u_i v_i$ 下，它们构成了 $\\mathbb{R}^M$ 的一个正交基。\n\n对于此系统，时间积分格式的稳定性可以通过检查其对每个本征模态的影响来分析。对于一个ODE $y' = \\lambda y$，数值方法的一个单步将解从 $y^n$ 转换为 $y^{n+1} = g(\\lambda \\Delta t) y^n$，其中 $g(z)$ 是放大因子，$z = \\lambda \\Delta t$。对于系统 $U'(t) = A U(t)$，第m个本征模态系数的更新由放大因子 $g(\\lambda_m(A) \\Delta t)$ 控制。\n\n所讨论的两种方法具有以下更新规则和放大因子：\n1.  **后向欧拉法 (BE)**：$(I - \\Delta t\\, A) U^{n+1} = U^n$。放大因子为\n    $$\n    g_{BE}(z) = \\frac{1}{1 - z}.\n    $$\n2.  **隐式中点法 (IM)**：$(I - \\tfrac{1}{2}\\Delta t\\, A) U^{n+1} = (I + \\tfrac{1}{2}\\Delta t\\, A) U^n$。放大因子为\n    $$\n    g_{IM}(z) = \\frac{1 + z/2}{1 - z/2}.\n    $$\n\n如果对于所有具有非正实部 $\\text{Re}(z) \\le 0$ 的复数 $z$，都有 $|g(z)| \\le 1$，则称数值方法是 **A-稳定**的。这确保了对于任何稳定的线性ODE系统，数值解对于任何时间步长 $\\Delta t  0$ 都不会无界增长。BE和IM都是A-稳定的。\n\n如果一个方法是A-稳定的，并且额外满足 $\\lim_{\\text{Re}(z) \\to -\\infty} |g(z)| = 0$，则称该方法是 **L-稳定**的。这一性质对于刚性系统至关重要，因为在这些系统中，某些特征值 $\\lambda_m$ 是非常大的负数。L-稳定性确保了相应的（高频）高度振荡或快速衰减的模态被数值格式强烈阻尼，特别是在使用大的时间步长 $\\Delta t$ 时。\n\n分析放大因子：\n- 对于BE：$\\lim_{\\text{Re}(z) \\to -\\infty} |g_{BE}(z)| = \\lim_{\\text{Re}(z) \\to -\\infty} |\\frac{1}{1-z}| = 0$。后向欧拉法是L-稳定的。\n- 对于IM：$\\lim_{\\text{Re}(z) \\to -\\infty} |g_{IM}(z)| = \\lim_{\\text{Re}(z) \\to -\\infty} |\\frac{1+z/2}{1-z/2}| = |\\frac{z/2}{-z/2}| = 1$。隐式中点法不是L-稳定的。\n\n该分析预测，BE将有效地阻尼高频模态，而IM将保留它们，从而在刚性问题的数值解中导致持续的、非物理的振荡。设计的数值测试旨在验证这一行为。\n\n实现过程如下：\n1.  设置常数：$M=63$，$\\nu=1$，$\\Delta x=1/64$。\n2.  构建 $M \\times M$ 矩阵 $A$。\n3.  分别为模态 $m_{\\text{low}}=1$ 和 $m_{\\text{high}}=63$ 构建归一化特征向量 $\\widehat{v}_{m_{\\text{low}}}$ 和 $\\widehat{v}_{m_{\\text{high}}}$。归一化是相对于离散内积 $\\langle u, v \\rangle_{\\Delta x}$进行的。归一化因子被发现为 $\\sqrt{2}$。\n4.  对于每个测试用例，构建初始条件向量 $U^0$。\n5.  实现执行BE和IM单个时间步的函数。这些函数求解各自的线性系统，例如，对于BE，求解 $(I - \\Delta t\\, A) U^{n+1} = U^n$。\n6.  应用一个时间步，为每种方法获得 $U^1$。\n7.  通过使用离散内积将结果向量 $U^1$ 投影回相应的本征模态，计算所需的模态放大率或振幅比。对于一个纯模态 $\\widehat{v}_m$ 的初始条件 $U^0$，放大率为 $|\\langle U^1, \\widehat{v}_m \\rangle_{\\Delta x}| / |\\langle U^0, \\widehat{v}_m \\rangle_{\\Delta x}|$。对于混合模态初始条件，高低频比率由 $U^1$ 中相应模态的振幅计算得出。\n\n- **测试A** 使用相对于显式方法稳定性极限而言较大的时间步 ($\\Delta t_A = 1000 \\Delta x^2$)。这对应于一个大的负值 $z = \\lambda_{m_{\\text{high}}} \\Delta t_A$。如预测的那样，IM产生的放大因子接近1，而BE产生的放大因子接近0。\n- **测试B** 使用一个较小的时间步 ($\\Delta t_B = \\Delta x^2$)。这里，$z = \\lambda_{m_{\\text{high}}} \\Delta t_B \\approx -4$。两种方法都阻尼该模态，但程度不同。\n- **测试C** 演示了非L-稳定性的实际后果。在结合了低频和高频模态的初始条件以及一个大的时间步下，BE选择性地阻尼刚性的高频分量，导致一个很小的高低频振幅比。相比之下，IM未能阻尼该分量，导致一个大的比率，这意味着刚性分量持续存在并污染了解。\n\n代码的结果将从数值上证实这一理论理解。",
            "answer": "[0.999023,0.000244,0.333190,0.199969,11.026744,0.000269]"
        },
        {
            "introduction": "无条件稳定性通常保证了数值解的能量或范数不会无界增长，但这是否就意味着解的所有物理特性都能被正确保持呢？本练习将探讨一个同样重要的性质：保正性。你将通过一个具体的例子发现，经典的A-稳定方法——Crank-Nicolson格式，在某些情况下会产生非物理的负值，这揭示了在选择时间积分格式时，除了稳定性，还必须考虑其是否符合问题的内在物理约束 。",
            "id": "3459547",
            "problem": "考虑一个由半离散抛物型偏微分方程产生的线性初值问题，写作 $u^{\\prime}(t)=A\\,u(t)$，其中 $A\\in\\mathbb{R}^{2\\times 2}$ 是一个反对称矩阵\n$$\nA=\\begin{pmatrix}2  -1\\\\ -1  2\\end{pmatrix}.\n$$\n回顾一下，一个矩阵是M-矩阵（$M$-matrix）的条件是：它是一个实Z-矩阵（$Z$-matrix，所有非对角线元素均为非正数），且其特征值的实部为正。上述矩阵 $A$ 的负矩阵 $-A$ 是一个非奇异M-矩阵。对于线性系统 $u^{\\prime}(t)=-A\\,u(t)$，时间步长为 $h0$ 的克兰克-尼科尔森（Crank–Nicolson, CN）时间积分格式产生一个单步传播矩阵\n$$\nG(h)=(I+\\tfrac{h}{2}A)^{-1}(I-\\tfrac{h}{2}A),\n$$\n使得 $u^{n+1}=G(h)\\,u^{n}$。如果对于所有的 $h0$，$G(h)$ 的所有元素都是非负的，则称该时间步进方法对半离散系统是保正的。这保证了非负数据在一步之后仍然保持非负。\n\n仅使用上述定义和直接的矩阵代数，显式计算上确界\n$$\nh_{\\mathrm{sup}}=\\sup\\{\\,h\\ge 0:\\ G(h)\\ \\text{is entrywise nonnegative}\\,\\}.\n$$\n你的最终答案必须是一个精确的数值。不需要四舍五入，也不涉及物理单位。然后，根据你的计算，简要总结为什么这表明对于大的 $h$，克兰克-尼科尔森方法通常不保持M-矩阵系统的正性。",
            "solution": "问题要求计算所有使克兰克-尼科尔森传播矩阵 $G(h)$ 按元素非负的非负时间步长 $h$ 集合的上确界。该系统由 $u^{\\prime}(t) = -A u(t)$ 定义，其中矩阵为\n$$\nA = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}.\n$$\n传播矩阵由下式给出\n$$\nG(h) = (I + \\tfrac{h}{2}A)^{-1}(I - \\tfrac{h}{2}A),\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。我们将使用直接的矩阵代数显式计算 $G(h)$。\n\n首先，我们计算 $G(h)$ 表达式中的两个矩阵。单位矩阵是 $I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n矩阵 $I + \\frac{h}{2}A$ 为：\n$$\nI + \\frac{h}{2}A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{h}{2}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 1 + h  -\\frac{h}{2} \\\\ -\\frac{h}{2}  1 + h \\end{pmatrix}.\n$$\n为了求其逆矩阵，我们首先计算其行列式：\n$$\n\\det(I + \\tfrac{h}{2}A) = (1 + h)^2 - (-\\tfrac{h}{2})^2 = 1 + 2h + h^2 - \\frac{h^2}{4} = \\frac{3}{4}h^2 + 2h + 1.\n$$\n当行列式不为零时，逆矩阵存在。由于 $h \\ge 0$，行列式 $\\frac{3}{4}h^2 + 2h + 1 > 0$ 恒成立，因此逆矩阵总是存在。\n逆矩阵为：\n$$\n(I + \\tfrac{h}{2}A)^{-1} = \\frac{1}{\\frac{3}{4}h^2 + 2h + 1}\\begin{pmatrix} 1 + h  \\frac{h}{2} \\\\ \\frac{h}{2}  1 + h \\end{pmatrix}.\n$$\n接下来，我们计算矩阵 $I - \\frac{h}{2}A$：\n$$\nI - \\frac{h}{2}A = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{h}{2}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 1 - h  \\frac{h}{2} \\\\ \\frac{h}{2}  1 - h \\end{pmatrix}.\n$$\n现在，我们计算乘积 $G(h) = (I + \\tfrac{h}{2}A)^{-1}(I - \\tfrac{h}{2}A)$。\n$$\nG(h) = \\frac{1}{\\frac{3}{4}h^2 + 2h + 1}\\begin{pmatrix} 1 + h  \\frac{h}{2} \\\\ \\frac{h}{2}  1 + h \\end{pmatrix}\\begin{pmatrix} 1 - h  \\frac{h}{2} \\\\ \\frac{h}{2}  1 - h \\end{pmatrix}.\n$$\n我们来计算分子中的矩阵乘积：\n(1,1) 元素为 $(1+h)(1-h) + (\\frac{h}{2})(\\frac{h}{2}) = 1 - h^2 + \\frac{h^2}{4} = 1 - \\frac{3}{4}h^2$。\n(1,2) 元素为 $(1+h)(\\frac{h}{2}) + (\\frac{h}{2})(1-h) = \\frac{h}{2} + \\frac{h^2}{2} + \\frac{h}{2} - \\frac{h^2}{2} = h$。\n(2,1) 元素为 $(\\frac{h}{2})(1-h) + (1+h)(\\frac{h}{2}) = \\frac{h}{2} - \\frac{h^2}{2} + \\frac{h}{2} + \\frac{h^2}{2} = h$。\n(2,2) 元素为 $(\\frac{h}{2})(\\frac{h}{2}) + (1+h)(1-h) = \\frac{h^2}{4} + 1 - h^2 = 1 - \\frac{3}{4}h^2$。\n因此，传播矩阵为：\n$$\nG(h) = \\frac{1}{\\frac{3}{4}h^2 + 2h + 1} \\begin{pmatrix} 1 - \\frac{3}{4}h^2   h \\\\ h   1 - \\frac{3}{4}h^2 \\end{pmatrix}.\n$$\n我们需要找到使 $G(h)$ 所有元素都非负的 $h \\ge 0$ 的集合。设这个集合为 $S$。\n$h=0$ 的情况得出 $G(0) = \\frac{1}{1}\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I$，它是按元素非负的。因此，$0 \\in S$。\n\n对于 $h  0$，分母 $D(h) = \\frac{3}{4}h^2 + 2h + 1$ 总是正的。\n非对角线元素为 $g_{12}(h) = g_{21}(h) = \\frac{h}{D(h)}$。由于 $h0$ 且 $D(h)0$，这些元素总是非负的。\n对角线元素为 $g_{11}(h) = g_{22}(h) = \\frac{1 - \\frac{3}{4}h^2}{D(h)}$。为了使这些元素非负，由于分母为正，分子必须是非负的。\n我们要求 $1 - \\frac{3}{4}h^2 \\ge 0$。\n这个不等式可以重写为 $1 \\ge \\frac{3}{4}h^2$，这意味着 $h^2 \\le \\frac{4}{3}$。因为 $h0$，我们必须有 $0  h \\le \\sqrt{\\frac{4}{3}} = \\frac{2}{\\sqrt{3}}$。\n\n使 $G(h)$ 按元素非负的所有 $h \\ge 0$ 的完整集合是 $[0, \\frac{2}{\\sqrt{3}}]$。\n问题要求 $h_{\\mathrm{sup}} = \\sup(S)$。这个集合的上确界是区间的上界，即 $\\frac{2}{\\sqrt{3}}$。\n$$\nh_{\\mathrm{sup}} = \\frac{2}{\\sqrt{3}}.\n$$\n这个结果表明，对于这个M-矩阵系统，克兰克-尼科尔森方法并非对所有 $h0$ 都保持正性。只有当时间步长 $h \\le \\frac{2}{\\sqrt{3}}$ 时，保正性才得以维持。对于任何时间步长 $h > \\frac{2}{\\sqrt{3}}$，矩阵 $G(h)$ 的对角线元素将变为负数，从而违反了保正性。有限上确界 $h_{\\mathrm{sup}}$ 的存在表明该方法不是无条件保正的。对于需要保证解（如浓度、概率）非负的物理问题，这是一个严重的限制，即使该方法是无条件A-稳定的。",
            "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{3}}}\n$$"
        }
    ]
}