{
    "hands_on_practices": [
        {
            "introduction": "第一个练习旨在建立有限差分格式和其傅里叶符号之间的基本联系。通过将物理空间中的离散运算转换为频域中的简单乘法，我们可以更容易地分析格式的性质。你将推导一个高阶差分格式的符号，并利用其泰勒展开来揭示该格式的精度阶数，这是数值分析中的一项核心技术 。",
            "id": "3429328",
            "problem": "考虑一个长度为 $L$ 的一维周期性空间域，其上有一个包含 $N$ 个点的均匀网格，网格间距为 $h = L/N$。令 $u_j$ 表示在节点 $x_j = j h$，$j = 0, 1, \\dots, N-1$ 上的网格函数，并采用周期性索引。定义线性差分算子 $D$，它通过四阶中心差分格式来近似一阶空间导数\n$$\n(D u)_j \\;=\\; \\frac{1}{12\\,h}\\left(-\\,u_{j+2} \\;+\\; 8\\,u_{j+1} \\;-\\; 8\\,u_{j-1} \\;+\\; u_{j-2}\\right).\n$$\n使用离散傅里叶变换 (DFT)，将 $D$ 视为一个位移不变卷积算子，并将其傅里叶符号 $\\widehat{D}(\\theta)$ 定义为这样一个复标量：对于任意单个傅里叶模式 $u_j = U \\exp\\!\\big(i\\,k_c\\,x_j\\big)$（其中 $U \\in \\mathbb{C}$，连续波数 $k_c \\in \\mathbb{R}$，且 $\\theta = k_c h$），有 $(D u)_j = \\widehat{D}(\\theta)\\,u_j$。所有三角函数均以弧度为单位。\n\n从 DFT 的定义和离散帕塞瓦尔恒等式（该恒等式将网格函数的 $\\ell^2$ 能量与傅里叶系数的模平方和等同起来）出发，推导上述差分格式的傅里叶符号 $\\widehat{D}(\\theta)$ 的显式闭式表达式。然后，求其小波数展开（即在 $|\\theta|\\ll 1$ 条件下关于 $\\theta$ 的泰勒级数），并将其与连续微分算子的符号 $i\\,k_c$ 进行比较。具体来说，计算 $\\widehat{D}(\\theta)$ 在 $\\theta = 0$ 附近的级数展开式中的前三个非零项，并用 $k_c$ 和 $h$ 表示。解释此展开式所指示的精度阶。\n\n你的最终答案必须是 $\\widehat{D}(\\theta)$ 关于 $k_c$ 和 $h$ 的单个闭式解析表达式。无需四舍五入。",
            "solution": "我们处理的是周期性网格，在此网格上，线性、位移不变的差分算子是卷积，并可通过离散傅里叶变换 (DFT) 对角化。离散帕塞瓦尔恒等式保证了物理空间中的能量范数对应于傅里叶空间中各模态能量的总和，这使得我们可以通过算子的傅里叶符号逐个模态地进行精度和稳定性分析。\n\n设单个傅里叶模式为 $u_j = U \\exp\\!\\big(i\\,k_c\\,x_j\\big)$，其中 $U \\in \\mathbb{C}$，$k_c \\in \\mathbb{R}$，且 $x_j = j h$。定义 $\\theta = k_c h$，因此 $u_{j+m} = U \\exp\\!\\big(i\\,k_c\\,x_{j+m}\\big) = U \\exp\\!\\big(i\\,k_c\\,(x_j + m h)\\big) = U \\exp\\!\\big(i\\,k_c\\,x_j\\big)\\exp\\!\\big(i\\,m\\theta\\big) = u_j\\,\\exp\\!\\big(i\\,m\\theta\\big)$。\n\n算子 $D$ 由下式给出\n$$\n(D u)_j \\;=\\; \\frac{1}{12\\,h}\\left(-\\,u_{j+2} \\;+\\; 8\\,u_{j+1} \\;-\\; 8\\,u_{j-1} \\;+\\; u_{j-2}\\right).\n$$\n代入傅里叶模式并提出公因子 $u_j$ 可得\n\\begin{align*}\n(D u)_j\n= \\frac{1}{12\\,h}\\left(-\\,u_j\\,\\exp(2 i \\theta) \\;+\\; 8\\,u_j\\,\\exp(i \\theta) \\;-\\; 8\\,u_j\\,\\exp(-i \\theta) \\;+\\; u_j\\,\\exp(-2 i \\theta)\\right) \\\\\n= u_j \\cdot \\frac{1}{12\\,h}\\left(-\\,\\exp(2 i \\theta) \\;+\\; 8\\,\\exp(i \\theta) \\;-\\; 8\\,\\exp(-i \\theta) \\;+\\; \\exp(-2 i \\theta)\\right).\n\\end{align*}\n根据傅里叶符号的定义，可得\n$$\n\\widehat{D}(\\theta) \\;=\\; \\frac{1}{12\\,h}\\left(-\\,\\exp(2 i \\theta) \\;+\\; 8\\,\\exp(i \\theta) \\;-\\; 8\\,\\exp(-i \\theta) \\;+\\; \\exp(-2 i \\theta)\\right).\n$$\n我们使用恒等式 $\\exp(i\\alpha) - \\exp(-i\\alpha) = 2 i \\sin(\\alpha)$ 进行简化：\n\\begin{align*}\n8\\,\\exp(i\\theta) - 8\\,\\exp(-i\\theta) = 16 i \\sin(\\theta), \\\\\n-\\,\\exp(2 i\\theta) + \\exp(-2 i\\theta) = -\\,2 i \\sin(2\\theta).\n\\end{align*}\n因此\n\\begin{align*}\n\\widehat{D}(\\theta)\n= \\frac{1}{12\\,h}\\left(16 i \\sin(\\theta) - 2 i \\sin(2\\theta)\\right)\n= \\frac{i}{12\\,h}\\left(16 \\sin(\\theta) - 2 \\sin(2\\theta)\\right) \\\\\n= \\frac{i}{6\\,h}\\left(8 \\sin(\\theta) - \\sin(2\\theta)\\right).\n\\end{align*}\n这就是显式的闭式傅里叶符号。它是纯虚数，这与一阶导数的近似是一致的。\n\n为获得小波数展开，我们令 $\\theta = k_c h$ 并对 $|\\theta|\\ll 1$ 的情况展开正弦函数：\n\\begin{align*}\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{6} + \\frac{\\theta^5}{120} - \\frac{\\theta^7}{5040} + \\mathcal{O}(\\theta^9), \\\\\n\\sin(2\\theta) = 2\\theta - \\frac{(2\\theta)^3}{6} + \\frac{(2\\theta)^5}{120} - \\frac{(2\\theta)^7}{5040} + \\mathcal{O}(\\theta^9) \\\\\n= 2\\theta - \\frac{4}{3}\\theta^3 + \\frac{4}{15}\\theta^5 - \\frac{8}{315}\\theta^7 + \\mathcal{O}(\\theta^9).\n\\end{align*}\n计算 $8 \\sin(\\theta) - \\sin(2\\theta)$：\n\\begin{align*}\n8 \\sin(\\theta) - \\sin(2\\theta)\n= 8\\left(\\theta - \\frac{\\theta^3}{6} + \\frac{\\theta^5}{120} - \\frac{\\theta^7}{5040}\\right)\n- \\left(2\\theta - \\frac{4}{3}\\theta^3 + \\frac{4}{15}\\theta^5 - \\frac{8}{315}\\theta^7\\right) + \\mathcal{O}(\\theta^9) \\\\\n= (8\\theta - 2\\theta) + \\left(-\\frac{8}{6}\\theta^3 + \\frac{4}{3}\\theta^3\\right) + \\left(\\frac{8}{120}\\theta^5 - \\frac{4}{15}\\theta^5\\right) + \\left(-\\frac{8}{5040}\\theta^7 + \\frac{8}{315}\\theta^7\\right) + \\mathcal{O}(\\theta^9) \\\\\n= 6\\theta + 0\\cdot\\theta^3 - \\frac{1}{5}\\theta^5 + \\frac{1}{42}\\theta^7 + \\mathcal{O}(\\theta^9).\n\\end{align*}\n因此，\n\\begin{align*}\n\\widehat{D}(\\theta)\n= \\frac{i}{6\\,h}\\left(6\\theta - \\frac{1}{5}\\theta^5 + \\frac{1}{42}\\theta^7 + \\mathcal{O}(\\theta^9)\\right) \\\\\n= i\\left(\\frac{\\theta}{h} - \\frac{\\theta^5}{30\\,h} + \\frac{\\theta^7}{252\\,h} + \\mathcal{O}\\!\\left(\\frac{\\theta^9}{h}\\right)\\right).\n\\end{align*}\n代入 $\\theta = k_c h$ 可得\n\\begin{align*}\n\\widehat{D}(\\theta)\n= i\\left(k_c - \\frac{k_c^5 h^4}{30} + \\frac{k_c^7 h^6}{252} + \\mathcal{O}\\!\\big(k_c^9 h^8\\big)\\right)\n= i\\,k_c\\left(1 - \\frac{(k_c h)^4}{30} + \\frac{(k_c h)^6}{252} + \\mathcal{O}\\!\\big((k_c h)^8\\big)\\right).\n\\end{align*}\n与连续符号 $i\\,k_c$ 相比，主导差异项的阶数为 $(k_c h)^4$，这表明该差分格式对一阶导数的近似具有四阶精度。\n\n因此，显式傅里叶符号为\n$$\n\\widehat{D}(\\theta) \\;=\\; \\frac{i}{6\\,h}\\left(8 \\sin(\\theta) - \\sin(2\\theta)\\right),\n\\quad \\text{with } \\theta = k_c h,\n$$\n其相对于 $i\\,k_c$ 的小波数展开证实了四阶精度。",
            "answer": "$$\\boxed{\\frac{i}{6\\,h}\\left(8\\,\\sin(k_c h)\\;-\\;\\sin(2\\,k_c h)\\right)}$$"
        },
        {
            "introduction": "在上一个练习的基础上，本练习将傅里叶分析应用于一个完整的时间依赖偏微分方程数值格式——热传导方程。你将推导其放大因子，并运用帕萨瓦尔恒等式（Parseval's identity）的原理来理解冯·诺依曼（von Neumann）稳定性判据，即每个傅里叶模的能量不能增长。这个练习将抽象的理论分析与选择稳定时间步长的实际问题具体地联系起来 。",
            "id": "3429318",
            "problem": "考虑一维热方程 $u_{t}=\\nu\\,u_{xx}$，其中扩散率 $\\nu0$ 为正，定义在长度为 $L$ 的周期性域上。该方程在一个有 $N$ 个点的均匀网格上进行离散化，网格间距为 $h=L/N$，并使用周期性索引 $j\\in\\{0,1,\\dots,N-1\\}$（索引对 $N$ 取模）。将标准二阶中心离散拉普拉斯算子定义为 $(\\Delta_{h} u)_{j}=\\frac{u_{j+1}-2u_{j}+u_{j-1}}{h^{2}}$。考虑显式前向欧拉时间步进格式\n$$\nu_{j}^{n+1}=u_{j}^{n}+\\nu\\,\\Delta t\\,(\\Delta_{h}u^{n})_{j},\n$$\n其中 $\\Delta t0$ 是时间步长。设离散傅里叶变换 (DFT) 定义为\n$$\n\\widehat{v}(k)=\\frac{1}{\\sqrt{N}}\\sum_{j=0}^{N-1}v_{j}\\,\\exp\\!\\left(-\\,\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right),\\quad k\\in\\{0,1,\\dots,N-1\\},\n$$\n并回顾 DFT 是酉的，因此帕塞瓦尔恒等式成立：\n$$\n\\sum_{j=0}^{N-1}|v_{j}|^{2}=\\sum_{k=0}^{N-1}|\\widehat{v}(k)|^{2}.\n$$\n对于每个模态 $k$，通过关系式 $\\widehat{(\\Delta_{h}v)}(k)=\\sigma_{\\Delta_{h}}(k)\\,\\widehat{v}(k)$ 定义离散拉普拉斯算子 $\\Delta_{h}$ 的傅里叶符号 $\\sigma_{\\Delta_{h}}(k)$。仅使用上述定义和事实，对该格式进行离散傅里叶分析，以推导在 $\\ell^{2}$ 范数下对 $\\Delta t$ 的稳定性要求。具体而言：\n- 计算傅里叶空间中该格式的 $\\sigma_{\\Delta_{h}}(k)$ 和逐模态放大因子 $G(k)$。\n- 使用帕塞瓦尔恒等式来论证 $\\ell^{2}$ 范数下的稳定性要求 $\\sup_{k}|G(k)|\\leq 1$。\n- 对 $k\\in\\{0,1,\\dots,N-1\\}$ 最大化 $-\\sigma_{\\Delta_{h}}(k)$，以获得对 $\\Delta t$ 的最严格约束，并论证为什么最坏情况模态是奈奎斯特模态 $k=N/2$（假设 $N$ 为偶数，以使该模态存在）。\n\n将您的最终答案表示为最大允许时间步长 $\\Delta t_{\\max}$ 的单个闭式解析表达式，用 $h$ 和 $\\nu$ 表示。无需四舍五入。",
            "solution": "问题陈述为一维热方程的前向时间中心空间 (FTCS) 格式提供了一个标准 von Neumann 稳定性分析的完整且一致的框架。该问题具有科学依据、是适定的且客观的。所有定义和条件在偏微分方程数值分析领域都是标准的。因此，该问题是有效的，我们着手求解。\n\n按照要求，分析分为四个部分：计算离散拉普拉斯算子的傅里叶符号，确定格式的放大因子，使用帕塞瓦尔恒等式论证稳定性判据，以及通过分析最坏情况傅里叶模态来推导时间步长 $\\Delta t$ 的稳定性极限。\n\n首先，我们计算离散拉普拉斯算子 $\\Delta_{h}$ 的傅里叶符号 $\\sigma_{\\Delta_{h}}(k)$，它由关系式 $\\widehat{(\\Delta_{h}v)}(k)=\\sigma_{\\Delta_{h}}(k)\\,\\widehat{v}(k)$ 定义。我们首先将离散傅里叶变换 (DFT) 应用于算子 $(\\Delta_{h} v)_{j}=\\frac{v_{j+1}-2v_{j}+v_{j-1}}{h^{2}}$。\n$$\n\\widehat{(\\Delta_{h}v)}(k) = \\frac{1}{\\sqrt{N}}\\sum_{j=0}^{N-1} \\left(\\frac{v_{j+1}-2v_{j}+v_{j-1}}{h^{2}}\\right) \\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right)\n$$\n$$\n\\widehat{(\\Delta_{h}v)}(k) = \\frac{1}{h^{2}} \\left[ \\frac{1}{\\sqrt{N}}\\sum_{j=0}^{N-1}v_{j+1}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right) - \\frac{2}{\\sqrt{N}}\\sum_{j=0}^{N-1}v_{j}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right) + \\frac{1}{\\sqrt{N}}\\sum_{j=0}^{N-1}v_{j-1}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right) \\right]\n$$\n括号中的第二项根据定义为 $-2\\widehat{v}(k)$。对于第一项，我们使用换元 $m=j+1$。由于周期性边界条件 ($v_{N}=v_{0}$)，对 $j \\in \\{0, \\dots, N-1\\}$ 的求和等价于对 $m \\in \\{0, \\dots, N-1\\}$ 的求和。\n$$\n\\sum_{j=0}^{N-1}v_{j+1}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right) = \\sum_{m=0}^{N-1}v_{m}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi (m-1) k}{N}\\right) = \\exp\\left(\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) \\sum_{m=0}^{N-1}v_{m}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi m k}{N}\\right)\n$$\n这个结果是 $\\exp(\\mathrm{i}\\,\\frac{2\\pi k}{N})\\sqrt{N}\\widehat{v}(k)$。类似地，涉及 $v_{j-1}$ 的第三项得到 $\\exp(-\\mathrm{i}\\,\\frac{2\\pi k}{N})\\sqrt{N}\\widehat{v}(k)$。将这些代回得到：\n$$\n\\widehat{(\\Delta_{h}v)}(k) = \\frac{1}{h^{2}} \\left[ \\exp\\left(\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) - 2 + \\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) \\right] \\widehat{v}(k)\n$$\n根据傅里叶符号的定义，我们确定 $\\sigma_{\\Delta_{h}}(k)$：\n$$\n\\sigma_{\\Delta_{h}}(k) = \\frac{1}{h^{2}} \\left[ \\exp\\left(\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) + \\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) - 2 \\right]\n$$\n使用欧拉恒等式 $2\\cos\\theta = e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta}$ 和半角恒等式 $2\\cos\\theta - 2 = -4\\sin^2(\\theta/2)$，其中 $\\theta = \\frac{2\\pi k}{N}$：\n$$\n\\sigma_{\\Delta_{h}}(k) = \\frac{2}{h^{2}} \\left( \\cos\\left(\\frac{2\\pi k}{N}\\right) - 1 \\right) = -\\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)\n$$\n\n第二，我们确定逐模态放大因子 $G(k)$。我们将 DFT 应用于显式前向欧拉格式：\n$$\nu_{j}^{n+1}=u_{j}^{n}+\\nu\\,\\Delta t\\,(\\Delta_{h}u^{n})_{j}\n$$\n$$\n\\widehat{u^{n+1}}(k) = \\widehat{u^{n}}(k) + \\nu\\,\\Delta t\\,\\widehat{(\\Delta_{h}u^{n})}(k)\n$$\n使用傅里叶符号的定义，$\\widehat{(\\Delta_{h}u^{n})}(k) = \\sigma_{\\Delta_{h}}(k)\\,\\widehat{u^{n}}(k)$：\n$$\n\\widehat{u^{n+1}}(k) = \\widehat{u^{n}}(k) + \\nu\\,\\Delta t\\,\\sigma_{\\Delta_{h}}(k)\\,\\widehat{u^{n}}(k) = \\left( 1 + \\nu\\,\\Delta t\\,\\sigma_{\\Delta_{h}}(k) \\right) \\widehat{u^{n}}(k)\n$$\n放大因子 $G(k)$ 是将傅里叶系数从一个时间步长乘以到下一个时间步长的因子，因此 $G(k) = \\frac{\\widehat{u^{n+1}}(k)}{\\widehat{u^{n}}(k)}$。\n$$\nG(k) = 1 + \\nu\\,\\Delta t\\,\\sigma_{\\Delta_{h}}(k) = 1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)\n$$\n\n第三，我们论证稳定性条件。如果解的 $\\ell^2$ 范数不随时间增长，即对所有 $n \\ge 0$ 都有 $\\|u^{n+1}\\|_{\\ell^2} \\le \\|u^n\\|_{\\ell^2}$，则称数值格式在 $\\ell^2$ 范数下是稳定的。将两边平方，这意味着 $\\|u^{n+1}\\|_{\\ell^2}^2 \\le \\|u^n\\|_{\\ell^2}^2$，其中 $\\|v\\|_{\\ell^2}^2 = \\sum_{j=0}^{N-1}|v_j|^2$。\n根据帕塞瓦尔恒等式，$\\sum_{j=0}^{N-1}|v_j|^2 = \\sum_{k=0}^{N-1}|\\widehat{v}(k)|^2$。将此应用于我们的稳定性条件，得到：\n$$\n\\sum_{k=0}^{N-1}|\\widehat{u^{n+1}}(k)|^2 \\le \\sum_{k=0}^{N-1}|\\widehat{u^{n}}(k)|^2\n$$\n代入 $\\widehat{u^{n+1}}(k) = G(k)\\widehat{u^{n}}(k)$:\n$$\n\\sum_{k=0}^{N-1}|G(k)\\widehat{u^{n}}(k)|^2 \\le \\sum_{k=0}^{N-1}|\\widehat{u^{n}}(k)|^2 \\quad \\implies \\quad \\sum_{k=0}^{N-1}|G(k)|^2 |\\widehat{u^{n}}(k)|^2 \\le \\sum_{k=0}^{N-1}|\\widehat{u^{n}}(k)|^2\n$$\n这个不等式必须对任意解 $u^n$ 成立，因此也必须对任意一组傅里叶系数 $\\widehat{u^n}(k)$ 成立。如果对每个模态 $k \\in \\{0, 1, \\dots, N-1\\}$ 都有 $|G(k)|^2 \\le 1$，则可以保证这一点。这等价于对所有 $k$ 的 von Neumann 稳定性条件 $|G(k)| \\le 1$，或 $\\sup_{k}|G(k)| \\le 1$。\n\n最后，我们使用此条件来推导对 $\\Delta t$ 的约束。该条件为：\n$$\n\\left| 1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) \\right| \\le 1\n$$\n这一个不等式等价于以下两个不等式：\n$$\n-1 \\le 1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) \\le 1\n$$\n右侧不等式，$1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}(\\dots) \\le 1$，意味着 $-\\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}(\\dots) \\le 0$。由于 $\\nu  0$，$\\Delta t  0$，$h^2  0$ 且 $\\sin^2(\\cdot) \\ge 0$，该不等式总是满足的。\n左侧不等式提供了实际的约束：\n$$\n-1 \\le 1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) \\quad \\implies \\quad \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) \\le 2\n$$\n此条件必须对所有 $k \\in \\{0, 1, \\dots, N-1\\}$ 成立。因此，我们必须对使不等式左侧最大化的 $k$ 值强制执行此条件。这对应于使 $-\\sigma_{\\Delta_{h}}(k) = \\frac{4}{h^2}\\sin^2(\\frac{\\pi k}{N})$ 最大化的模态。$\\sin^2(\\theta)$ 的最大值为 $1$，当 $\\theta = \\frac{\\pi}{2} + m\\pi$（对于任意整数 $m$）时取得。对于自变量 $\\frac{\\pi k}{N}$，我们在其范围内寻找一个 $k$ 值使得 $\\frac{\\pi k}{N} = \\frac{\\pi}{2}$。这得到 $k=N/2$。问题陈述 $N$ 是偶数，所以 $k=N/2$ 是一个整数，也是一个有效的模态索引。此模态被称为奈奎斯特频率，对应于网格上可表示的最高空间频率。它是“最坏情况”模态，因为它是最不稳定的，因此对 $\\Delta t$ 施加了最严格的约束。\n在 $k=N/2$ 时，我们有 $\\sin^2(\\frac{\\pi (N/2)}{N}) = \\sin^2(\\frac{\\pi}{2}) = 1$。稳定性条件变为：\n$$\n\\frac{4\\nu\\,\\Delta t}{h^{2}} \\cdot \\max_{k}\\left[\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)\\right] \\le 2 \\quad \\implies \\quad \\frac{4\\nu\\,\\Delta t}{h^{2}} \\cdot 1 \\le 2\n$$\n解出 $\\Delta t$：\n$$\n\\Delta t \\le \\frac{2h^2}{4\\nu} = \\frac{h^2}{2\\nu}\n$$\n最大允许时间步长 $\\Delta t_{\\max}$ 是此不等式的上界。\n$$\n\\Delta t_{\\max} = \\frac{h^2}{2\\nu}\n$$\n这就是著名的一维热方程显式欧拉离散化的 CFL (Courant-Friedrichs-Lewy) 条件。",
            "answer": "$$\\boxed{\\frac{h^2}{2\\nu}}$$"
        },
        {
            "introduction": "最后一个练习将超越线性偏微分方程，探讨模拟非线性动力学时的一个关键问题：混叠效应（aliasing）。以无粘性伯格斯方程（inviscid Burgers' equation）为模型，你将发现非线性项的标准计算方法如何在傅里叶空间中产生虚假的能量，从而违反物理守恒定律。这个练习突出了为什么像反混叠（dealiasing）这样的技术对于保证非线性模拟的物理保真度至关重要 。",
            "id": "3429312",
            "problem": "考虑周期性域 $[0,2\\pi]$ 上的无粘性 Burgers 方程 $u_t + u u_x = 0$。设 $N$ 为一个正偶数，定义网格 $x_j = 2\\pi j/N$, $j=0,\\dots,N-1$。对于在标准范围 $k \\in \\{-N/2, -N/2+1, \\dots, N/2-1\\}$ 内表示的整数波数 $k$，网格函数 $u(x_j)$ 的离散傅里叶变换 (DFT) 记为 $\\widehat{u}_k = \\frac{1}{N}\\sum_{j=0}^{N-1} u(x_j) e^{-i k x_j}$。离散 Parseval 恒等式为 $\\frac{1}{N}\\sum_{j=0}^{N-1} \\overline{f(x_j)}\\, g(x_j) = \\sum_{k} \\overline{\\widehat{f}_k}\\, \\widehat{g}_k$。对于乘积的伪谱计算，物理空间中的乘法对应于傅里叶空间中的模 $N$ 离散卷积：$\\widehat{f g}[k] = \\sum_{p+q \\equiv k \\, (\\mathrm{mod}\\, N)} \\widehat{f}_p\\, \\widehat{g}_q$。在解析集上，谱导数定义为 $\\widehat{f_x}[k] = i k \\widehat{f}_k$。\n\n设 $N=12$，考虑初始数据\n$$u(x,0) = A \\cos(2 x) + B \\sin(4 x),$$\n其中 $A$ 和 $B$ 是实数振幅。非线性项 $u u_x$ 的伪谱格式按以下步骤进行：\n- 计算 $\\widehat{u}_k$，\n- 形成 $\\widehat{u_x}_k = i k \\widehat{u}_k$，\n- 逆变换回物理空间以得到 $u(x_j)$ 和 $u_x(x_j)$，\n- 计算逐点乘积 $u(x_j)\\, u_x(x_j)$，\n- 进行离散傅里叶变换以获得 $\\widehat{u u_x}_k$。\n\n不应用去混叠。\n\n任务：\n1) 使用上述离散卷积特性，确定哪个解析的傅里叶模式接收了来自 $k=2$ 和 $k=4$ 模式相互作用的混叠贡献，并计算该模式下的所得系数 $\\widehat{u u_x}[k]$，将其表示为 $A$ 和 $B$ 的函数。\n\n2) 从离散 Parseval 恒等式和保守形式下连续对流算子的斜伴随性出发，解释为什么通过物理空间乘法和模 $N$ 卷积计算 $u u_x$ 会导致高频模式能量的伪增长，并根据三元组相互作用和混叠来确定其机理。\n\n3) 选择正确描述高频模式行为以及与分析一致的补救措施的选项。\n\n选项：\n\nA. $k=2$ 和 $k=4$ 的未解析相互作用产生一个 $k=6$ 的模式，该模式混叠到奈奎斯特模式 $k=-6$（因为 $6 \\equiv -6 \\, (\\mathrm{mod}\\, 12)$），得到 $\\widehat{u u_x}[-6] = 3 A B$ 并向最高解析模式注入能量。根据离散 Parseval 恒等式，由于乘法是通过模 $N$ 卷积计算的，破坏了斜伴随能量平衡，内积 $\\langle u, u u_x\\rangle_h$ 不为零；应用三分之二去混叠规则或在傅里叶空间中计算 $(u^2)_x/2$ 可以恢复能量守恒。\n\nB. 混叠将相互作用发送到 $k=2$，$\\widehat{u u_x}[2] = - A B$，将能量转移到低频模式；Parseval 恒等式确保伪谱乘法的能量守恒，而去混叠没有效果。\n\nC. 乘积 $u u_x$ 在 $k=\\pm 6$ 处没有贡献，因为 $k=2$ 和 $k=4$ 都在截断波数以下；因此，在使用不带去混叠的伪谱乘法时，离散能量是自动守恒的。\n\nD. 任何高频模式能量的伪增长完全是由时间积分器引起的；在精确时间积分下，对于所有 $N$，伪谱非线性项 $u u_x$ 在没有去混叠的情况下是能量守恒的。",
            "solution": "我们首先计算相关的傅里叶系数，并使用伪谱乘法的离散卷积结构。\n\n根据定义，对于 $u(x,0) = A \\cos(2 x) + B \\sin(4 x)$，我们有复傅里叶系数\n$$\\widehat{u}_2 = \\frac{A}{2}, \\quad \\widehat{u}_{-2} = \\frac{A}{2}, \\quad \\widehat{u}_4 = -\\frac{i B}{2}, \\quad \\widehat{u}_{-4} = \\frac{i B}{2},$$\n所有其他系数初始为零。傅里叶空间中的导数是 $\\widehat{u_x}_k = i k \\widehat{u}_k$，所以\n$$\\widehat{u_x}_2 = i \\cdot 2 \\cdot \\frac{A}{2} = i A, \\quad \\widehat{u_x}_{-2} = i \\cdot (-2) \\cdot \\frac{A}{2} = - i A,$$\n$$\\widehat{u_x}_4 = i \\cdot 4 \\cdot \\left(-\\frac{i B}{2}\\right) = 2 B, \\quad \\widehat{u_x}_{-4} = i \\cdot (-4) \\cdot \\left(\\frac{i B}{2}\\right) = 2 B.$$\n\n第 1 部分：识别混叠模式并计算该模式下的 $\\widehat{u u_x}$。\n\n物理空间中的乘法，然后进行离散傅里叶变换，对应于模 $N$ 的离散卷积：对于任何 $k$，\n$$\\widehat{u u_x}[k] = \\sum_{p+q \\equiv k \\, (\\mathrm{mod}\\, N)} \\widehat{u}_p\\, \\widehat{u_x}_q = \\sum_{p+q \\equiv k \\, (\\mathrm{mod}\\, 12)} \\widehat{u}_p\\, (i q\\, \\widehat{u}_q).$$\n\n我们关心的相互作用发生在已解析的低频模式 $k=2$ 和 $k=4$ 之间。在连续情况下，它们的和产生 $k=6$，这在主正值范围之外（当 $N=12$ 时，我们有 $k \\in \\{-6,-5,\\dots,5\\}$，而奈奎斯特模式 $k=-6$ 是频率 $|k|=6$ 的唯一代表）。在模 $N$ 离散卷积中，数对 $p=2$ 和 $q=4$ 对解析模式 $k \\equiv 2+4 \\equiv 6 \\equiv -6 \\, (\\mathrm{mod}\\, 12)$ 有贡献。同样，$p=4$ 和 $q=2$ 也对 $k \\equiv -6$ 有贡献。负频率对 $p=-2, q=-4$ 和 $p=-4, q=-2$ 也相加得到 $-6$ 而无需折叠。收集所有对 $k=-6$ 的贡献，得到\n\n$$\n\\begin{aligned}\n\\widehat{u u_x}[-6] \n= \\widehat{u}_{-2}\\, \\widehat{u_x}_{-4} + \\widehat{u}_{-4}\\, \\widehat{u_x}_{-2} + \\widehat{u}_{2}\\, \\widehat{u_x}_{4} + \\widehat{u}_{4}\\, \\widehat{u_x}_{2} \\\\\n= \\left(\\frac{A}{2}\\right)\\left(2 B\\right) + \\left(\\frac{i B}{2}\\right)\\left(- i A\\right) + \\left(\\frac{A}{2}\\right)\\left(2 B\\right) + \\left(-\\frac{i B}{2}\\right)\\left(i A\\right) \\\\\n= A B + \\frac{A B}{2} + A B + \\frac{A B}{2} \\\\\n= 3 A B.\n\\end{aligned}\n$$\n\n因此，混叠贡献出现在奈奎斯特模式 $k=-6$ 上，其系数为 $\\widehat{u u_x}[-6] = 3 A B$，这是一个实系数，对应于网格上频率为 $6$ 的余弦函数。在物理空间中，使用三角恒等式，\n\n$$\n\\begin{aligned}\nu_x = -2 A \\sin(2 x) + 4 B \\cos(4 x), \\\\\nu u_x = A \\cos(2 x)\\cdot 4 B \\cos(4 x) + B \\sin(4 x)\\cdot (-2 A) \\sin(2 x) + \\text{(其他频率的自相互作用)} \\\\\n= 3 A B \\cos(6 x) + A B \\cos(2 x) + \\text{(在 } k=\\pm 4, \\pm 8 \\text{ 处的项)}.\n\\end{aligned}\n$$\n\n在 $N=12$ 的网格上，$\\cos(6 x_j)$ 正是奈奎斯特模式，并且可以由单个 $k=-6$ 的系数表示，这与 $\\widehat{u u_x}[-6] = 3 A B$ 一致。\n\n第 2 部分：通过 Parseval 恒等式和离散卷积导致的伪高频模式能量增长。\n\n在连续问题中，保守形式的非线性对流项 $\\frac{1}{2}(u^2)_x$ 在周期性域上的 $L^2$ 内积中是斜伴随的，从而得出能量恒等式\n$$\\frac{d}{dt}\\left(\\frac{1}{2}\\|u\\|_{L^2}^2\\right) = \\left\\langle u, -u u_x \\right\\rangle = -\\frac{1}{2}\\left\\langle u, (u^2)_x \\right\\rangle = 0,$$\n因为 $\\int_0^{2\\pi} u(x) (u^2)_x(x)\\, dx = \\int_0^{2\\pi} \\frac{1}{2} (u^2(x))_x u(x)\\, dx = \\frac{1}{2}\\int_0^{2\\pi} (u^2(x))_x u(x)\\, dx$ 可化为一个消失的周期性边界项。在去混叠的谱 Galerkin 离散化中，同样的抵消在离散层面上也成立：将 $(u^2)_x/2$ 投影到解析模式上会保持离散 $L^2$ 能量。\n\n然而，在没有去混叠的伪谱设置中，网格上的逐点乘积 $u u_x$ 在傅里叶空间中对应于模 $N$ 卷积，这会将未解析的和 $p+q$ 折叠回解析集中。负责能量守恒的精细斜伴随结构被这种折叠所破坏：精确卷积中的三元组反对称配对（它会将相互作用发送到 $k=6$，这里在解析集之外）被填充奈奎斯特模式 $k=-6$ 的混叠相互作用所取代。根据离散 Parseval 恒等式，\n$$\\frac{d}{dt}\\left(\\frac{1}{2}\\|u\\|_{h}^2\\right) = \\left\\langle u, -u u_x \\right\\rangle_h = -\\sum_{k} \\overline{\\widehat{u}_k}\\, \\widehat{u u_x}_k,$$\n并且模 $N$ 卷积通常会得到 $\\sum_k \\overline{\\widehat{u}_k}\\, \\widehat{u u_x}_k \\neq 0$，因为 $\\widehat{u u_x}_k$ 包含的混叠贡献没有被 $(u^2)_x/2$ 的保守投影所平衡。在我们的特定场景中，尽管 $\\widehat{u}_{-6}(0)=0$，傅里叶空间中的演化方程，\n$$\\frac{d}{dt}\\widehat{u}_k = - \\widehat{u u_x}_k,$$\n意味着奈奎斯特模式满足 $\\frac{d}{dt}\\widehat{u}_{-6} = - 3 A B \\neq 0$，因此能量被注入到最高解析模式中。这是伪增长：在真实的 Galerkin 投影中，$k=2$ 和 $k=4$ 的相互作用只会产生 $k=6$，它位于解析集之外，会被丢弃而不是折叠到 $k=-6$ 上。\n\n因此，其机理是伪谱乘积中模 $N$ 卷积下三元组相互作用的离散混叠，加上非线性项离散化中保守斜对称形式的丧失。补救措施包括：\n- 在乘法之前通过将超出三分之二法则的模式置零来进行去混叠（或填充到 $3N/2$），这可以防止未解析的和折叠到解析集中，以及\n- 以保守形式计算非线性项，例如，完全在傅里叶空间中通过 $\\frac{1}{2}(u^2)_x$ 计算（或以斜对称分裂形式），这可以恢复离散能量守恒。\n\n第 3 部分：逐项分析选项。\n\n选项 A：它正确地指出对于 $N=12$，$2+4=6$ 的相互作用混叠到奈奎斯特模式 $k=-6$。计算出的系数 $\\widehat{u u_x}[-6] = 3 A B$ 与上面的卷积计算相匹配。它正确地解释了带有模 $N$ 卷积的离散 Parseval 恒等式破坏了斜伴随能量平衡，导致向最高模式的伪注入，并引用了标准的补救措施（三分之二去混叠规则或保守的 $(u^2)_x/2$ 计算）。结论：正确。\n\n选项 B：它断言混叠将能量发送到 $k=2$，其系数为 $\\widehat{u u_x}[2] = -A B$，这与卷积分析不符；主要的混叠高频贡献在 $k=-6$ 处，而不是 $k=2$。它还错误地声称 Parseval 恒等式确保了无去混叠的伪谱乘法的能量守恒；实际上，混叠破坏了能量平衡。结论：错误。\n\n选项 C：它声称在 $k=\\pm 6$ 处没有贡献，因为 $2$ 和 $4$ 都在截断波数以下。这忽略了非线性项产生和频 $6$ 以及在模 $N$ 卷积下其混叠到奈奎斯特模式 $k=-6$ 的情况。它还错误地指出能量是自动守恒的。结论：错误。\n\n选项 D：它将伪增长完全归因于时间积分，并声称无论是否去混叠，伪谱项 $u u_x$ 都是能量守恒的。这种增长机制即使在半离散层面（傅里叶系数的常微分方程）也源于混叠；精确的时间积分并不能消除它。结论：错误。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}