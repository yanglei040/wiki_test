{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握双共轭梯度（BiCG）方法，必须超越抽象的公式，亲身体验其运算流程。这个练习将引导你对一个小型非对称线性系统手动执行两轮完整的BiCG迭代 。通过计算每一步的中间向量和标量，你将对如何维持双正交性条件以及解如何逐步逼近建立起一个具体而深刻的理解。",
            "id": "3585465",
            "problem": "考虑求解非对称线性系统 $A x = b$ 的任务，通过在精确算术下执行恰好两次双共轭梯度 (BiCG) 方法（无预处理）的迭代，从 $x_{0} = 0$ 开始，并取影子残差等于初始残差。系统数据如下\n$$\nA \\;=\\; \\begin{pmatrix}\n2  & 1 & 0 \\\\\n0  & 3 & 1 \\\\\n1  & 0 & 2\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n1 \\\\\n1 \\\\\n0\n\\end{pmatrix}.\n$$\n设初始残差为 $r_{0} = b - A x_{0}$，并取影子残差 $s_{0} = r_{0}$。使用标准的实数算术双共轭梯度 (BiCG) 方法（双共轭梯度 (BiCG) 方法通过残差相对于 $A$ 和 $A^{\\mathsf{T}}$ 的双正交性，以及由三项关系驱动的搜索方向的耦合短递推来定义）来：\n- 构建并报告前两次迭代期间生成的所有中间标量和向量，包括 $r_{k}$、$\\tilde{r}_{k}$、$p_{k}$、$\\tilde{p}_{k}$、$v_{k} = A p_{k}$、$\\tilde{v}_{k} = A^{\\mathsf{T}} \\tilde{p}_{k}$，以及标量 $\\rho_{k}$、$\\alpha_{k}$、$\\beta_{k}$，连同 $x_{1}$ 和 $x_{2}$。\n- 通过确认所有用作分母的所需内积均为非零，来验证每一步的非崩溃性。\n\n最后，以简化的解析表达式形式给出欧几里得范数 $\\|r_{2}\\|_{2}$ 的精确值。不要四舍五入；报告精确值。",
            "solution": "该问题是有效的，因为它是数值线性代数中一个定义明确的练习，基于标准的双共轭梯度 (BiCG) 方法，提供了所有必要的数据，并且没有内部矛盾或科学缺陷。我们开始进行求解。\n\n双共轭梯度 (BiCG) 方法是用于求解非对称线性系统 $A x = b$ 的一种迭代算法。该算法生成残差序列 $r_k$ 和影子残差序列 $\\tilde{r}_k$，以及相应的搜索方向 $p_k$ 和 $\\tilde{p}_k$。其定义属性是残差的双正交性，即对于 $j \\neq k$ 有 $\\tilde{r}_j^T r_k = 0$，以及搜索方向的A-双正交性（或双共轭性），即对于 $j \\neq k$ 有 $\\tilde{p}_j^T A p_k = 0$。\n\n该算法从一个初始猜测值 $x_0$ 开始，按以下步骤进行：\n1.  初始化：\n    $r_0 = b - A x_0$\n    选择 $\\tilde{r}_0$（这里，$\\tilde{r}_0 = r_0$）\n    $p_0 = r_0$, $\\tilde{p}_0 = \\tilde{r}_0$\n2.  对于 $k = 0, 1, 2, \\dots$：\n    $\\rho_k = \\tilde{r}_k^T r_k$\n    $v_k = A p_k$\n    $\\alpha_k = \\rho_k / (\\tilde{p}_k^T v_k)$\n    $x_{k+1} = x_k + \\alpha_k p_k$\n    $r_{k+1} = r_k - \\alpha_k v_k$\n    $\\tilde{r}_{k+1} = \\tilde{r}_k - \\alpha_k A^T \\tilde{p}_k$\n    $\\rho_{k+1} = \\tilde{r}_{k+1}^T r_{k+1}$\n    $\\beta_k = \\rho_{k+1} / \\rho_k$\n    $p_{k+1} = r_{k+1} + \\beta_k p_k$\n    $\\tilde{p}_{k+1} = \\tilde{r}_{k+1} + \\beta_k \\tilde{p}_k$\n\n我们给定的系统数据为：\n$$A = \\begin{pmatrix} 2  & 1 & 0 \\\\ 0  & 3 & 1 \\\\ 1  & 0 & 2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$$\n$A$的转置是：\n$$A^{\\mathsf{T}} = \\begin{pmatrix} 2  & 0 & 1 \\\\ 1  & 3 & 0 \\\\ 0  & 1 & 2 \\end{pmatrix}$$\n\n**初始化 ($k=0$)**\n初始猜测值为 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n初始残差为 $r_0 = b - A x_0 = b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n初始影子残差取为 $\\tilde{r}_0 = r_0 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n初始搜索方向为 $p_0 = r_0 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 和 $\\tilde{p}_0 = \\tilde{r}_0 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n\n**第一次迭代 ($k=0$)**\n我们计算标量 $\\rho_0$：\n$$\\rho_0 = \\tilde{r}_0^T r_0 = \\begin{pmatrix} 1  & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = 1 \\cdot 1 + 1 \\cdot 1 + 0 \\cdot 0 = 2$$\n向量 $v_0 = A p_0$ 为：\n$$v_0 = A p_0 = \\begin{pmatrix} 2  & 1 & 0 \\\\ 0  & 3 & 1 \\\\ 1  & 0 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 3 \\\\ 1 \\end{pmatrix}$$\n向量 $\\tilde{v}_0 = A^{\\mathsf{T}} \\tilde{p}_0$ 为：\n$$\\tilde{v}_0 = A^{\\mathsf{T}} \\tilde{p}_0 = \\begin{pmatrix} 2  & 0 & 1 \\\\ 1  & 3 & 0 \\\\ 0  & 1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 4 \\\\ 1 \\end{pmatrix}$$\n$\\alpha_0$ 的分母为 $\\tilde{p}_0^T v_0 = \\begin{pmatrix} 1  & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 3 \\\\ 1 \\end{pmatrix} = 3+3 = 6$。\n*非崩溃性检查：* $\\rho_0 = 2 \\neq 0$ 和 $\\tilde{p}_0^T A p_0 = 6 \\neq 0$ 均成立，因此该方法可以继续进行。\n步长 $\\alpha_0$ 为：\n$$\\alpha_0 = \\frac{\\rho_0}{\\tilde{p}_0^T v_0} = \\frac{2}{6} = \\frac{1}{3}$$\n我们更新解向量以获得 $x_1$：\n$$x_1 = x_0 + \\alpha_0 p_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/3 \\\\ 1/3 \\\\ 0 \\end{pmatrix}$$\n新的残差 $r_1$ 为：\n$$r_1 = r_0 - \\alpha_0 v_0 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 3 \\\\ 3 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1-1 \\\\ 1-1 \\\\ 0-1/3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1/3 \\end{pmatrix}$$\n新的影子残差 $\\tilde{r}_1$ 为：\n$$\\tilde{r}_1 = \\tilde{r}_0 - \\alpha_0 \\tilde{v}_0 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 2 \\\\ 4 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1-2/3 \\\\ 1-4/3 \\\\ 0-1/3 \\end{pmatrix} = \\begin{pmatrix} 1/3 \\\\ -1/3 \\\\ -1/3 \\end{pmatrix}$$\n我们为下一步计算 $\\rho_1$：\n$$\\rho_1 = \\tilde{r}_1^T r_1 = \\begin{pmatrix} 1/3  & -1/3 & -1/3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ -1/3 \\end{pmatrix} = 0 + 0 + \\frac{1}{9} = \\frac{1}{9}$$\n标量 $\\beta_0$ 为：\n$$\\beta_0 = \\frac{\\rho_1}{\\rho_0} = \\frac{1/9}{2} = \\frac{1}{18}$$\n新的搜索方向 $p_1$ 和 $\\tilde{p}_1$ 为：\n$$p_1 = r_1 + \\beta_0 p_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1/3 \\end{pmatrix} + \\frac{1}{18} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/18 \\\\ 1/18 \\\\ -6/18 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 1 \\\\ 1 \\\\ -6 \\end{pmatrix}$$\n$$\\tilde{p}_1 = \\tilde{r}_1 + \\beta_0 \\tilde{p}_0 = \\begin{pmatrix} 1/3 \\\\ -1/3 \\\\ -1/3 \\end{pmatrix} + \\frac{1}{18} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 6/18 + 1/18 \\\\ -6/18 + 1/18 \\\\ -6/18 \\end{pmatrix} = \\begin{pmatrix} 7/18 \\\\ -5/18 \\\\ -6/18 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 7 \\\\ -5 \\\\ -6 \\end{pmatrix}$$\n\n**第二次迭代 ($k=1$)**\n我们从 $\\rho_1 = 1/9$ 开始。\n向量 $v_1 = A p_1$ 为：\n$$v_1 = A p_1 = \\begin{pmatrix} 2  & 1 & 0 \\\\ 0  & 3 & 1 \\\\ 1  & 0 & 2 \\end{pmatrix} \\frac{1}{18} \\begin{pmatrix} 1 \\\\ 1 \\\\ -6 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 2(1)+1(1) \\\\ 3(1)+1(-6) \\\\ 1(1)+2(-6) \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 3 \\\\ -3 \\\\ -11 \\end{pmatrix}$$\n向量 $\\tilde{v}_1 = A^{\\mathsf{T}} \\tilde{p}_1$ 为：\n$$\\tilde{v}_1 = A^{\\mathsf{T}} \\tilde{p}_1 = \\begin{pmatrix} 2  & 0 & 1 \\\\ 1  & 3 & 0 \\\\ 0  & 1 & 2 \\end{pmatrix} \\frac{1}{18} \\begin{pmatrix} 7 \\\\ -5 \\\\ -6 \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 2(7)+1(-6) \\\\ 1(7)+3(-5) \\\\ 1(-5)+2(-6) \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 8 \\\\ -8 \\\\ -17 \\end{pmatrix}$$\n$\\alpha_1$ 的分母为 $\\tilde{p}_1^T v_1 = \\left( \\frac{1}{18} \\begin{pmatrix} 7  & -5 & -6 \\end{pmatrix} \\right) \\left( \\frac{1}{18} \\begin{pmatrix} 3 \\\\ -3 \\\\ -11 \\end{pmatrix} \\right) = \\frac{1}{324} (21+15+66) = \\frac{102}{324} = \\frac{17}{54}$。\n*非崩溃性检查：* 我们有 $\\rho_1 = 1/9 \\neq 0$ 和 $\\tilde{p}_1^T A p_1 = 17/54 \\neq 0$。该方法可以继续进行而不会崩溃。\n步长 $\\alpha_1$ 为：\n$$\\alpha_1 = \\frac{\\rho_1}{\\tilde{p}_1^T v_1} = \\frac{1/9}{17/54} = \\frac{1}{9} \\cdot \\frac{54}{17} = \\frac{6}{17}$$\n我们更新解向量以获得 $x_2$：\n$$x_2 = x_1 + \\alpha_1 p_1 = \\begin{pmatrix} 1/3 \\\\ 1/3 \\\\ 0 \\end{pmatrix} + \\frac{6}{17} \\left(\\frac{1}{18} \\begin{pmatrix} 1 \\\\ 1 \\\\ -6 \\end{pmatrix}\\right) = \\begin{pmatrix} 1/3 \\\\ 1/3 \\\\ 0 \\end{pmatrix} + \\frac{1}{51} \\begin{pmatrix} 1 \\\\ 1 \\\\ -6 \\end{pmatrix} = \\begin{pmatrix} 17/51+1/51 \\\\ 17/51+1/51 \\\\ -6/51 \\end{pmatrix} = \\begin{pmatrix} 18/51 \\\\ 18/51 \\\\ -6/51 \\end{pmatrix} = \\frac{1}{17} \\begin{pmatrix} 6 \\\\ 6 \\\\ -2 \\end{pmatrix}$$\n新的残差 $r_2$ 为：\n$$r_2 = r_1 - \\alpha_1 v_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1/3 \\end{pmatrix} - \\frac{6}{17} \\left(\\frac{1}{18} \\begin{pmatrix} 3 \\\\ -3 \\\\ -11 \\end{pmatrix}\\right) = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1/3 \\end{pmatrix} - \\frac{1}{51} \\begin{pmatrix} 3 \\\\ -3 \\\\ -11 \\end{pmatrix} = \\begin{pmatrix} -3/51 \\\\ 3/51 \\\\ -17/51+11/51 \\end{pmatrix} = \\begin{pmatrix} -3/51 \\\\ 3/51 \\\\ -6/51 \\end{pmatrix} = \\frac{1}{17} \\begin{pmatrix} -1 \\\\ 1 \\\\ -2 \\end{pmatrix}$$\n根据要求，我们报告在此次迭代中生成的其他量。新的影子残差 $\\tilde{r}_2$ 为：\n$$\\tilde{r}_2 = \\tilde{r}_1 - \\alpha_1 \\tilde{v}_1 = \\begin{pmatrix} 1/3 \\\\ -1/3 \\\\ -1/3 \\end{pmatrix} - \\frac{6}{17} \\left(\\frac{1}{18} \\begin{pmatrix} 8 \\\\ -8 \\\\ -17 \\end{pmatrix}\\right) = \\begin{pmatrix} 1/3 \\\\ -1/3 \\\\ -1/3 \\end{pmatrix} - \\frac{1}{51} \\begin{pmatrix} 8 \\\\ -8 \\\\ -17 \\end{pmatrix} = \\begin{pmatrix} 17/51-8/51 \\\\ -17/51+8/51 \\\\ -17/51+17/51 \\end{pmatrix} = \\begin{pmatrix} 9/51 \\\\ -9/51 \\\\ 0 \\end{pmatrix} = \\frac{1}{17} \\begin{pmatrix} 3 \\\\ -3 \\\\ 0 \\end{pmatrix}$$\n最后，我们计算 $\\rho_2$ 和 $\\beta_1$：\n$$\\rho_2 = \\tilde{r}_2^T r_2 = \\left( \\frac{1}{17} \\begin{pmatrix} 3  & -3 & 0 \\end{pmatrix} \\right) \\left( \\frac{1}{17} \\begin{pmatrix} -1 \\\\ 1 \\\\ -2 \\end{pmatrix} \\right) = \\frac{1}{289}(-3-3+0) = -\\frac{6}{289}$$\n$$\\beta_1 = \\frac{\\rho_2}{\\rho_1} = \\frac{-6/289}{1/9} = -\\frac{54}{289}$$\n\n问题要求 $r_2$ 的欧几里得范数的精确值。\n$$\\|r_2\\|_2 = \\left\\| \\frac{1}{17} \\begin{pmatrix} -1 \\\\ 1 \\\\ -2 \\end{pmatrix} \\right\\|_2 = \\frac{1}{17} \\left\\| \\begin{pmatrix} -1 \\\\ 1 \\\\ -2 \\end{pmatrix} \\right\\|_2 = \\frac{1}{17} \\sqrt{(-1)^2 + 1^2 + (-2)^2} = \\frac{1}{17} \\sqrt{1+1+4} = \\frac{\\sqrt{6}}{17}$$",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{6}}{17}}\n$$"
        },
        {
            "introduction": "尽管双共轭梯度（BiCG）方法功能强大，但它有一个众所知的弱点：可能会出现“崩溃”（breakdown）现象，即算法因除以零而意外中止。本练习将展示一个精心构造的例子，其中BiCG在第一步迭代时便会失败 。通过分析这一失效情况，并将其与更稳健的稳定双共轭梯度（BiCGSTAB）方法的行为进行对比，你将对BiCG的实际局限性及其后继算法的开发动机获得关键的洞察。",
            "id": "2427438",
            "problem": "考虑线性系统 $A x = b$，其中 $3 \\times 3$ 矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n1  & 1 & 0\\\\\n0  & 1 & 1\\\\\n0  & 0 & 1\n\\end{pmatrix},\n$$\n右端项 $b = \\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}$，初始猜测 $x_0 = \\begin{pmatrix}0\\\\0\\\\0\\end{pmatrix}$。在精确算术下进行计算，并假设使用单位预处理器 $M = I$ 进行左预处理。设初始残差为 $r_0 = b - A x_0$，并为双共轭梯度 (BiCG) 方法选择影子残差为 $r_0^{\\ast} = \\begin{pmatrix}0\\\\1\\\\0\\end{pmatrix}$。通过 $p_0 = r_0$ 和 $p_0^{\\ast} = r_0^{\\ast}$ 初始化 BiCG 搜索方向。\n\n仅使用双共轭梯度 (BiCG) 法和稳定双共轭梯度 (BiCGSTAB) 法的标准定义，完成以下任务：\n\n- 计算 BiCG 第一次迭代的分母 $d_0 = p_0^{\\ast\\,T} A p_0$，并证明对于此例，BiCG 迭代在第一步即告中断。\n- 根据 BiCGSTAB 的定义操作，简要解释为何在通常选择 $\\hat{r} = r_0$ 的情况下，对于相同的 $A$、$b$ 和 $x_0$，此步对应的分母不为零，因此 BiCGSTAB 迭代在第一步不会遇到这种特定的中断情况。\n\n答案要求：\n- 最终答案只提供 $d_0$ 的精确值。\n- 无需四舍五入。\n- 不涉及单位。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、适定且客观的。这是一个计算线性代数中的标准练习，旨在说明双共轭梯度法的一个已知失效模式，以及稳定双共轭梯度法如何避免该问题。所有必要数据均已提供，且无矛盾之处。我们可以开始求解。\n\n问题要求分析对于给定的线性系统 $A x = b$，双共轭梯度 (BiCG) 法和稳定双共轭梯度 (BiCGSTAB) 法的第一次迭代。\n\n给定的数据如下：\n矩阵 $A$ 为\n$$\nA = \\begin{pmatrix}\n1  & 1 & 0\\\\\n0  & 1 & 1\\\\\n0  & 0 & 1\n\\end{pmatrix}\n$$\n右端向量 $b$ 为\n$$\nb = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n初始猜测 $x_0$ 是零向量\n$$\nx_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n预处理器是单位矩阵 $M=I$，这意味着我们考虑的是算法的非预处理版本。\n\n首先，我们来处理 BiCG 方法。初始残差 $r_0$ 计算如下：\n$$\nr_0 = b - A x_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1  & 1 & 0\\\\ 0  & 1 & 1\\\\ 0  & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n问题指定初始影子残差 $r_0^{\\ast}$ 为：\n$$\nr_0^{\\ast} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n初始搜索方向设置为 $p_0 = r_0$ 和 $p_0^{\\ast} = r_0^{\\ast}$。因此，\n$$\np_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\quad \\text{和} \\quad p_0^{\\ast} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n第一个任务是计算 BiCG 更新步骤中的分母 $d_0 = p_0^{\\ast\\,T} A p_0$。首先，我们计算乘积 $A p_0$：\n$$\nA p_0 = \\begin{pmatrix} 1  & 1 & 0\\\\ 0  & 1 & 1\\\\ 0  & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 0 \\\\ 0 \\cdot 1 + 1 \\cdot 0 + 1 \\cdot 0 \\\\ 0 \\cdot 1 + 0 \\cdot 0 + 1 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n现在，我们可以计算 $d_0$：\n$$\nd_0 = p_0^{\\ast\\,T} (A p_0) = \\begin{pmatrix} 0  & 1 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 0 \\cdot 1 + 1 \\cdot 0 + 0 \\cdot 0 = 0\n$$\nBiCG 算法中的步长 $\\alpha_k$ 计算公式为 $\\alpha_k = \\frac{r_k^{\\ast\\,T} r_k}{p_k^{\\ast\\,T} A p_k}$。对于第一次迭代，$k=0$，步长为 $\\alpha_0 = \\frac{r_0^{\\ast\\,T} r_0}{p_0^{\\ast\\,T} A p_0}$。该表达式的分母恰好是 $d_0$。由于 $d_0 = 0$，计算 $\\alpha_0$ 时会涉及除以零。这是 BiCG 算法的一次“严重中断”，使其无法继续进行。发生这种中断是因为所选的影子搜索方向 $p_0^\\ast$ 与搜索方向 $p_0$ 是 A-正交的，即 $p_0^{\\ast\\,T} A p_0 = 0$。\n\n接下来，我们分析 BiCGSTAB 方法的第一步。对于 BiCGSTAB，没有影子残差序列。取而代之的是，该算法采用了一个“稳定化”步骤，其中涉及一次额外的与 $A$ 的乘法。初始步长，记为 $\\alpha_0$，计算如下：\n$$\n\\alpha_0 = \\frac{\\rho_0}{\\hat{r}^T v_0}\n$$\n其中 $\\rho_0 = \\hat{r}^T r_0$，$v_0 = A p_0$，且 $p_0 = r_0$。向量 $\\hat{r}$ 是一个任意向量，但通常的标准选择是 $\\hat{r} = r_0$。题目要求我们考虑这种选择。\n当 $\\hat{r} = r_0$ 时，$\\alpha_0$ 的分母变为 $r_0^T v_0 = r_0^T A p_0$。由于 $p_0$ 也初始化为 $r_0$，所以分母是 $r_0^T A r_0$。\n\n让我们为给定的问题计算这个值。我们有 $r_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$，并且根据之前的计算，$A r_0 = A p_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n分母是：\n$$\nr_0^T A r_0 = \\begin{pmatrix} 1  & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1 \\cdot 1 + 0 \\cdot 0 + 0 \\cdot 0 = 1\n$$\n这个分母不为零。分子是 $\\rho_0 = r_0^T r_0 = 1$，因此步长 $\\alpha_0$ 是良定义的，且等于 $1$。BiCGSTAB 迭代可以继续进行，不会遇到导致 BiCG 方法中断的崩溃。\n\n总而言之，BiCG 的中断是由于对初始影子残差 $r_0^{\\ast}$ 的特定且某种程度上人为的选择，这使得影子搜索方向 $p_0^{\\ast}$ 与 $A p_0$ 正交。BiCGSTAB 通过消除对影子残差序列的需求，避免了这种特定的中断机制。其对应的分母 $r_0^T A r_0$ 仅依赖于标准残差 $r_0$ 和系统矩阵 $A$。对于一个非奇异矩阵 $A$ 和一个非零残差 $r_0$，对于一般的非对称矩阵，这个量 $r_0^T A r_0$ 并不保证非零，但在本例中它不为零，从而防止了在这一步发生中断。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "像BiCG这样的迭代方法，其威力在应用于源于物理模型（例如由偏微分方程（PDE）描述的模型）的问题时才能真正展现。这最后一个练习旨在连接抽象线性代数与计算物理学 。你将从一个平流方程的有限体积离散化中推导出BiCG系统矩阵，并将涉及矩阵转置的“影子”系统（shadow system）诠释为一个物理上的伴随输运过程，最后，你将探索如何通过最小化系统的非正规性来优化数值格式本身，从而使最终的线性系统更适合使用BiCG算法求解。",
            "id": "3366375",
            "problem": "考虑一维线性平流方程，其常数速度为 $c>0$。该方程的计算域被划分为 $N=2$ 个非均匀有限体积单元，宽度分别为 $\\Delta x_{1}$ 和 $\\Delta x_{2}$。设单元平均未知量为 $u_{1}$ 和 $u_{2}$。使用标准的有限体积平衡关系 $R_{i} = \\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x_{i}}$ 和针对 $c>0$ 的迎风数值通量，使得内界面通量 $F_{i+\\frac{1}{2}} = c u_{i}$。在左侧入流边界面上，引入一个修正的边界通量\n$$\nF_{\\frac{1}{2}} = c\\left((1-\\beta)\\,u_{b} + \\beta\\,u_{1}\\right),\n$$\n其中 $u_{b}$ 是给定的入流值，$\\beta$ 是一个待选的标量参数。在右侧出流边界面上，取 $F_{\\frac{5}{2}} = c\\,u_{2}$。通过关系式 $r = A(\\beta)\\,u - g$ 定义线性算子 $A(\\beta)$，其中 $r = (R_{1},R_{2})^{\\top}$，$g$ 包含了所有仅依赖于 $u_{b}$ 的边界源项。\n\n您的任务是：\n- 从上述有限体积平衡关系和迎风通量定义出发，推导算子 $A(\\beta)$ 及其在标准欧几里得内积下的转置 $A(\\beta)^{\\top}$ 的显式矩阵元素。\n- 使用双共轭梯度（BiCG）方法及其影子系统的定义，解释“影子”系统 $A(\\beta)^{\\top} y = b^{\\sharp}$ 在离散伴随输运方面的物理意义，并说明 $A(\\beta)^{\\top}$ 的元素如何编码网格上的反向连接性。\n- 为了量化与正规性的偏离程度，考虑交换子的弗罗贝尼乌斯范数，\n$$\n\\mathcal{D}(\\beta) = \\left\\|A(\\beta)^{\\top}A(\\beta) - A(\\beta)A(\\beta)^{\\top}\\right\\|_{F}.\n$$\n推导 $\\mathcal{D}(\\beta)$ 关于 $c$、$\\Delta x_{1}$、$\\Delta x_{2}$ 和 $\\beta$ 的显式表达式，然后确定在所有实数 $\\beta$ 上最小化 $\\mathcal{D}(\\beta)$ 的值 $\\beta^{\\star}$ 的唯一解析表达式。\n\n以 $\\beta^{\\star}$ 的封闭形式表达式提供您的最终答案。最终表达式中不要求进行数值取整，也不应包含单位。",
            "solution": "该问题经检验具有科学依据、良态且客观。这是一个数值分析中的标准练习，结合了偏微分方程的有限体积法和数值线性代数的概念。所有必要信息均已提供，任务定义明确。\n\n第一个任务是推导矩阵算子 $A(\\beta)$ 及其转置 $A(\\beta)^{\\top}$。该系统使用有限体积法在两个单元上进行离散化，单元平均未知量为 $u_1$ 和 $u_2$。单元 $i$ 的残差由 $R_i = \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x_i}$ 给出。\n\n对于单元1（索引 $i=1$），残差为 $R_1 = \\frac{F_{3/2} - F_{1/2}}{\\Delta x_1}$。\n左边界面 $x_{1/2}$ 处的通量为 $F_{1/2} = c((1-\\beta)u_b + \\beta u_1)$。\n内界面 $x_{3/2}$ 处的通量由迎风状态决定，对于 $c>0$ 的情况，即为单元1中的状态。因此，$F_{3/2} = c u_1$。\n将这些代入 $R_1$ 的表达式中：\n$$R_1 = \\frac{c u_1 - c((1-\\beta)u_b + \\beta u_1)}{\\Delta x_1} = \\frac{c u_1 - c\\beta u_1 - c(1-\\beta)u_b}{\\Delta x_1} = \\frac{c(1-\\beta)}{\\Delta x_1}u_1 - \\frac{c(1-\\beta)}{\\Delta x_1}u_b$$\n\n对于单元2（索引 $i=2$），残差为 $R_2 = \\frac{F_{5/2} - F_{3/2}}{\\Delta x_2}$。\n内界面 $x_{3/2}$ 处的通量同样为 $F_{3/2} = c u_1$。\n右侧出流边界面 $x_{5/2}$ 处的通量为 $F_{5/2} = c u_2$。\n将这些代入 $R_2$ 的表达式中：\n$$R_2 = \\frac{c u_2 - c u_1}{\\Delta x_2} = -\\frac{c}{\\Delta x_2}u_1 + \\frac{c}{\\Delta x_2}u_2$$\n\n问题通过关系式 $r = A(\\beta)u - g$ 定义算子 $A(\\beta)$，其中 $r = (R_1, R_2)^{\\top}$，$u = (u_1, u_2)^{\\top}$，$g$ 包含仅依赖于边界值 $u_b$ 的项。我们可以将残差方程组写成矩阵形式：\n$$\n\\begin{pmatrix} R_1 \\\\ R_2 \\end{pmatrix} =\n\\begin{pmatrix}\n\\frac{c(1-\\beta)}{\\Delta x_1}  & 0 \\\\\n-\\frac{c}{\\Delta x_2}  & \\frac{c}{\\Delta x_2}\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}\n-\n\\begin{pmatrix}\n\\frac{c(1-\\beta)}{\\Delta x_1}u_b \\\\ 0\n\\end{pmatrix}\n$$\n由此，我们确定矩阵 $A(\\beta)$ 和向量 $g$：\n$$A(\\beta) = \\begin{pmatrix} \\frac{c(1-\\beta)}{\\Delta x_1}  & 0 \\\\ -\\frac{c}{\\Delta x_2}  & \\frac{c}{\\Delta x_2} \\end{pmatrix}$$\n在标准欧几里得内积下，该矩阵的转置 $A(\\beta)^{\\top}$ 为：\n$$A(\\beta)^{\\top} = \\begin{pmatrix} \\frac{c(1-\\beta)}{\\Delta x_1}  & -\\frac{c}{\\Delta x_2} \\\\ 0  & \\frac{c}{\\Delta x_2} \\end{pmatrix}$$\n\n第二个任务是在双共轭梯度（BiCG）方法的背景下，解释“影子”系统 $A(\\beta)^{\\top}y = b^{\\sharp}$ 的物理意义。\n算子 $A(\\beta)$ 是与平流相关的空间微分算子的离散表示。由 $du/dt = -A(\\beta)u + \\dots$ 建模的原始物理系统描述了物理量 $u$ 被速度为 $c>0$ 的速度场输运的过程。信息从左向右（从单元1到单元2）传播，这由 $A(\\beta)$ 的下三角结构所编码，其中状态 $u_1$ 影响残差 $R_2$。\n转置算子 $A(\\beta)^{\\top}$ 是 $A(\\beta)$ 的离散伴随算子。在连续介质力学中，平流算子 $-c\\frac{\\partial}{\\partial x}$ 的伴随算子是 $+c\\frac{\\partial}{\\partial x}$（需对边界项进行适当处理）。该伴随算子描述了反方向的输运，即速度为 $-c$ 的输运。\n离散系统 $A(\\beta)^{\\top}y = b^{\\sharp}$ 反映了这种反向输运。矩阵 $A(\\beta)^{\\top}$ 是上三角矩阵。方程组为：\n$$ \\frac{c(1-\\beta)}{\\Delta x_1} y_1 - \\frac{c}{\\Delta x_2} y_2 = b^{\\sharp}_1 $$\n$$ \\frac{c}{\\Delta x_2} y_2 = b^{\\sharp}_2 $$\n该系统是向后求解的：首先求解 $y_2$，然后求解 $y_1$。$y_2$ 的值通过非零的非对角项 $(A^{\\top})_{12} = -c/\\Delta x_2$ 影响 $y_1$。这种结构代表了信息从单元2到单元1的流动。因此，影子系统代表了一个离散伴随输运问题，其中“影子”量 $y$ 在空间上向后输运，即从下游到上游。$A(\\beta)^{\\top}$ 的元素编码了计算网格上的这种反向连接性。\n\n第三个任务是推导与正规性偏离程度的表达式 $\\mathcal{D}(\\beta) = \\|A(\\beta)^{\\top}A(\\beta) - A(\\beta)A(\\beta)^{\\top}\\|_{F}$，并找到使其最小化的值 $\\beta^{\\star}$。\n设交换子为 $C(\\beta) = A(\\beta)^{\\top}A(\\beta) - A(\\beta)A(\\beta)^{\\top}$。为简化起见，设 $a = \\frac{c(1-\\beta)}{\\Delta x_1}$ 和 $d = \\frac{c}{\\Delta x_2}$。\n那么，$A(\\beta) = \\begin{pmatrix} a  & 0 \\\\ -d  & d \\end{pmatrix}$ 且 $A(\\beta)^{\\top} = \\begin{pmatrix} a  & -d \\\\ 0  & d \\end{pmatrix}$。\n首先，我们计算乘积 $A(\\beta)^{\\top}A(\\beta)$ 和 $A(\\beta)A(\\beta)^{\\top}$：\n$$A(\\beta)^{\\top}A(\\beta) = \\begin{pmatrix} a  & -d \\\\ 0  & d \\end{pmatrix} \\begin{pmatrix} a  & 0 \\\\ -d  & d \\end{pmatrix} = \\begin{pmatrix} a^2+d^2  & -d^2 \\\\ -d^2  & d^2 \\end{pmatrix}$$\n$$A(\\beta)A(\\beta)^{\\top} = \\begin{pmatrix} a  & 0 \\\\ -d  & d \\end{pmatrix} \\begin{pmatrix} a  & -d \\\\ 0  & d \\end{pmatrix} = \\begin{pmatrix} a^2  & -ad \\\\ -ad  & d^2+d^2 \\end{pmatrix} = \\begin{pmatrix} a^2  & -ad \\\\ -ad  & 2d^2 \\end{pmatrix}$$\n接下来，我们求交换子 $C(\\beta)$：\n$$C(\\beta) = \\begin{pmatrix} a^2+d^2  & -d^2 \\\\ -d^2  & d^2 \\end{pmatrix} - \\begin{pmatrix} a^2  & -ad \\\\ -ad  & 2d^2 \\end{pmatrix} = \\begin{pmatrix} d^2  & ad-d^2 \\\\ ad-d^2  & -d^2 \\end{pmatrix}$$\n交换子的弗罗贝尼乌斯范数的平方是其所有元素平方的总和：\n$$\\mathcal{D}(\\beta)^2 = \\|C(\\beta)\\|_{F}^2 = (d^2)^2 + (ad-d^2)^2 + (ad-d^2)^2 + (-d^2)^2 = 2d^4 + 2(ad-d^2)^2$$\n$\\mathcal{D}(\\beta)$ 的显式表达式是该量的平方根：\n$$\\mathcal{D}(\\beta) = \\sqrt{2d^4 + 2(ad-d^2)^2} = \\sqrt{2}\\sqrt{d^4 + (d(a-d))^2}$$\n代入 $a$ 和 $d$ 的定义：\n$$ \\mathcal{D}(\\beta) = \\sqrt{2} \\sqrt{ \\left(\\frac{c}{\\Delta x_2}\\right)^4 + \\left( \\frac{c}{\\Delta x_2} \\left( \\frac{c(1-\\beta)}{\\Delta x_1} - \\frac{c}{\\Delta x_2} \\right) \\right)^2 } = \\sqrt{2}c^2 \\sqrt{ \\frac{1}{(\\Delta x_2)^4} + \\left( \\frac{1-\\beta}{\\Delta x_1 \\Delta x_2} - \\frac{1}{(\\Delta x_2)^2} \\right)^2 } $$\n为了找到最小化 $\\mathcal{D}(\\beta)$ 的值 $\\beta^{\\star}$，我们可以等价地最小化 $\\mathcal{D}(\\beta)^2$。需要最小化的表达式是：\n$$ f(\\beta) = \\mathcal{D}(\\beta)^2 = 2d^4 + 2(ad-d^2)^2 $$\n项 $2d^4 = 2(c/\\Delta x_2)^4$ 不依赖于 $\\beta$。变量 $a = c(1-\\beta)/\\Delta x_1$ 是 $\\beta$ 的线性函数。因此，我们必须最小化项 $2(ad-d^2)^2$。由于这是一个平方量，其最小值为0。该最小值在以下条件下达到：\n$$ ad-d^2 = 0 $$\n由于 $d = c/\\Delta x_2 \\neq 0$，我们可以用 $d$ 去除：\n$$ a-d = 0 \\implies a = d $$\n代入 $a$ 和 $d$ 的表达式：\n$$ \\frac{c(1-\\beta)}{\\Delta x_1} = \\frac{c}{\\Delta x_2} $$\n由于 $c>0$，我们可以用 $c$ 去除：\n$$ \\frac{1-\\beta}{\\Delta x_1} = \\frac{1}{\\Delta x_2} $$\n求解 $\\beta$ 得到最优值 $\\beta^{\\star}$：\n$$ 1-\\beta = \\frac{\\Delta x_1}{\\Delta x_2} \\implies \\beta^{\\star} = 1 - \\frac{\\Delta x_1}{\\Delta x_2} $$\n这个 $\\beta$ 值提供了与正规性偏离程度 $\\mathcal{D}(\\beta)$ 的唯一最小值。",
            "answer": "$$\\boxed{1 - \\frac{\\Delta x_1}{\\Delta x_2}}$$"
        }
    ]
}