{
    "hands_on_practices": [
        {
            "introduction": "The core of the finite element method involves transforming simple, standardized reference elements into the actual, arbitrarily shaped elements that form the mesh. This transformation is achieved using an isoparametric mapping, which employs the same shape functions used for interpolating the solution field. This exercise  provides hands-on practice in deriving this mapping and computing its Jacobian, a crucial quantity that measures local distortion and is essential for integrating over the physical element.",
            "id": "3419691",
            "problem": "Consider the two-dimensional Finite Element Method (FEM) for solving partial differential equations on quadrilateral meshes. Let the reference element be the square $\\hat{Q}=[-1,1]^2$ with local coordinates $(\\xi,\\eta)$, and let the physical element $Q$ be a convex quadrilateral with vertices ordered counterclockwise and associated with the reference nodes $(\\xi,\\eta)=(-1,-1),(1,-1),(1,1),(-1,1)$ respectively. The physical coordinates of the four corner nodes are specified as\n$$\n(x_1,y_1)=(0,0),\\quad (x_2,y_2)=(2,0),\\quad (x_3,y_3)=(3,1.5),\\quad (x_4,y_4)=(1,1.5).\n$$\nStarting from the fundamental definition of the one-dimensional linear Lagrange basis on $[-1,1]$ and its tensor-product construction on $\\hat{Q}$, derive the isoparametric bilinear mapping $(x(\\xi,\\eta),y(\\xi,\\eta))$ from $\\hat{Q}$ to $Q$ using nodal shape functions. Then compute the Jacobian determinant\n$$\nJ(\\xi,\\eta)=\\det\\begin{pmatrix}\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\\end{pmatrix}\n$$\nfor the specified corner coordinates. Express the final result as a single simplified analytic expression for $J(\\xi,\\eta)$.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of the Finite Element Method, is well-posed with sufficient and consistent data, and is expressed in objective, formal language. We can proceed with the derivation.\n\nThe goal is to compute the Jacobian determinant $J(\\xi, \\eta)$ of the isoparametric mapping from a reference square element $\\hat{Q}=[-1,1]^2$ to a physical quadrilateral element $Q$. The mapping is constructed using bilinear shape functions.\n\nFirst, we define the one-dimensional linear Lagrange basis functions on the interval $[-1,1]$. Let the local coordinate be $z$. The two nodes are at $z=-1$ and $z=1$. The basis function $L_1(z)$ is $1$ at $z=-1$ and $0$ at $z=1$, while $L_2(z)$ is $0$ at $z=-1$ and $1$ at $z=1$. Their expressions are:\n$$\nL_1(z) = \\frac{1}{2}(1-z) \\quad \\text{and} \\quad L_2(z) = \\frac{1}{2}(1+z)\n$$\n\nNext, we construct the two-dimensional bilinear shape functions $N_i(\\xi, \\eta)$ for the four nodes of the reference square $\\hat{Q}$ by taking tensor products of the one-dimensional basis functions. The nodes are ordered counterclockwise:\nNode $1$: $(\\xi_1, \\eta_1) = (-1,-1)$\nNode $2$: $(\\xi_2, \\eta_2) = (1,-1)$\nNode $3$: $(\\xi_3, \\eta_3) = (1,1)$\nNode $4$: $(\\xi_4, \\eta_4) = (-1,1)$\n\nThe shape functions are:\n$$\nN_1(\\xi, \\eta) = L_1(\\xi) L_1(\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)\n$$\n$$\nN_2(\\xi, \\eta) = L_2(\\xi) L_1(\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)\n$$\n$$\nN_3(\\xi, \\eta) = L_2(\\xi) L_2(\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)\n$$\n$$\nN_4(\\xi, \\eta) = L_1(\\xi) L_2(\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\n\nThe isoparametric mapping relates the physical coordinates $(x,y)$ to the reference coordinates $(\\xi,\\eta)$ using these shape functions and the physical coordinates of the element's vertices $(x_i, y_i)$. The mapping is defined as:\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i\n$$\n$$\ny(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\nThe given physical coordinates are:\n$(x_1, y_1) = (0,0)$, $(x_2, y_2) = (2,0)$, $(x_3, y_3) = (3, 1.5)$, $(x_4, y_4) = (1, 1.5)$. To maintain precision, we use $1.5 = \\frac{3}{2}$.\n\nWe substitute the coordinates and shape functions into the mapping equations. For the $x$-coordinate:\n$$\nx(\\xi, \\eta) = N_1(0) + N_2(2) + N_3(3) + N_4(1)\n$$\n$$\nx(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(2) + \\frac{1}{4}(1+\\xi)(1+\\eta)(3) + \\frac{1}{4}(1-\\xi)(1+\\eta)(1)\n$$\nExpanding and collecting terms in powers of $\\xi$, $\\eta$, and $\\xi\\eta$:\n$$\n4x(\\xi, \\eta) = 2(1+\\xi-\\eta-\\xi\\eta) + 3(1+\\xi+\\eta+\\xi\\eta) + (1-\\xi+\\eta-\\xi\\eta)\n$$\n$$\n4x(\\xi, \\eta) = (2+3+1) + (2\\xi+3\\xi-\\xi) + (-2\\eta+3\\eta+\\eta) + (-2\\xi\\eta+3\\xi\\eta-\\xi\\eta)\n$$\n$$\n4x(\\xi, \\eta) = 6 + 4\\xi + 2\\eta + 0\\xi\\eta\n$$\n$$\nx(\\xi, \\eta) = \\frac{3}{2} + \\xi + \\frac{1}{2}\\eta\n$$\nFor the $y$-coordinate:\n$$\ny(\\xi, \\eta) = N_1(0) + N_2(0) + N_3\\left(\\frac{3}{2}\\right) + N_4\\left(\\frac{3}{2}\\right)\n$$\n$$\ny(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)\\left(\\frac{3}{2}\\right) + \\frac{1}{4}(1-\\xi)(1+\\eta)\\left(\\frac{3}{2}\\right)\n$$\nFactoring out common terms:\n$$\ny(\\xi, \\eta) = \\frac{3}{8}(1+\\eta) \\left[ (1+\\xi) + (1-\\xi) \\right]\n$$\n$$\ny(\\xi, \\eta) = \\frac{3}{8}(1+\\eta)(2) = \\frac{3}{4}(1+\\eta)\n$$\n$$\ny(\\xi, \\eta) = \\frac{3}{4} + \\frac{3}{4}\\eta\n$$\nThe mapping is affine, which is a special case of a bilinear map that occurs when the physical element is a parallelogram.\n\nNow, we compute the components of the Jacobian matrix $\\mathbf{J}$:\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{3}{2} + \\xi + \\frac{1}{2}\\eta \\right) = 1\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{3}{2} + \\xi + \\frac{1}{2}\\eta \\right) = \\frac{1}{2}\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left( \\frac{3}{4} + \\frac{3}{4}\\eta \\right) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left( \\frac{3}{4} + \\frac{3}{4}\\eta \\right) = \\frac{3}{4}\n$$\nThe Jacobian matrix is constant for this element:\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} 1 & \\frac{1}{2} \\\\ 0 & \\frac{3}{4} \\end{pmatrix}\n$$\nFinally, the Jacobian determinant $J(\\xi, \\eta)$ is the determinant of this matrix:\n$$\nJ(\\xi, \\eta) = \\det(\\mathbf{J}) = (1)\\left(\\frac{3}{4}\\right) - \\left(\\frac{1}{2}\\right)(0) = \\frac{3}{4}\n$$\nThe Jacobian determinant is a constant value, independent of $(\\xi,\\eta)$, which confirms that the mapping is affine and the physical element is a parallelogram. The value represents the ratio of the area of the physical element to the area of the reference element, scaled by a factor related to orientation. Specifically, $\\text{Area}(Q) = \\int_{\\hat{Q}} J(\\xi, \\eta) d\\xi d\\eta = \\frac{3}{4} \\times \\text{Area}(\\hat{Q}) = \\frac{3}{4} \\times 4 = 3$.",
            "answer": "$$\\boxed{\\frac{3}{4}}$$"
        },
        {
            "introduction": "The accuracy and stability of a finite element simulation are not just dependent on the mesh size, but also on the shape of its individual elements. Poorly shaped elements, such as those that are excessively stretched or flattened, can lead to large interpolation errors and ill-conditioned matrices. This practice  delves into quantifying element quality by calculating key metrics like the aspect ratio, minimum internal angle, and the condition number of the element's transformation matrix, providing concrete criteria for what constitutes a \"good\" element.",
            "id": "3419698",
            "problem": "Consider a single linear tetrahedral finite element used in the numerical solution of a Partial Differential Equation (PDE). The reference tetrahedron $\\hat{K}$ has vertices $\\hat{\\boldsymbol{x}}_{1}=(0,0,0)$, $\\hat{\\boldsymbol{x}}_{2}=(1,0,0)$, $\\hat{\\boldsymbol{x}}_{3}=(0,1,0)$, and $\\hat{\\boldsymbol{x}}_{4}=(0,0,1)$. The physical tetrahedron $K$ has vertices $\\boldsymbol{x}_{1}=(0,0,0)$, $\\boldsymbol{x}_{2}=(2,0,0)$, $\\boldsymbol{x}_{3}=(0,1,0)$, and $\\boldsymbol{x}_{4}=(0,0,0.5)$.\n\nThe element mapping $F_{K}:\\hat{K}\\rightarrow K$ is affine, and its deformation gradient $DF_{K}$ is constant on $K$. The operator $2$-norm (spectral norm) is to be used throughout.\n\nTasks:\n1. Derive $DF_{K}$ from first principles and compute the condition number $\\kappa(DF_{K})=\\|DF_{K}\\|\\,\\|DF_{K}^{-1}\\|$.\n2. Compute the element’s aspect ratio defined as the ratio of the longest to the shortest edge length among the six edges of $K$.\n3. Compute the minimum internal angle over all triangular faces of $K$ (angles measured in degrees), and assess whether the element satisfies both of the following prescribed quality thresholds:\n   - Minimum face angle threshold: $20^\\circ$.\n   - Condition number threshold: $4.1$.\nState clearly whether the element passes each threshold.\n\nAnswer specification:\n- The final answer must be the single numerical value of $\\kappa(DF_{K})$.\n- Round your final $\\kappa(DF_{K})$ to four significant figures.\n- The condition number is dimensionless; do not include any units in your final answer.\n- All angles must be expressed in degrees.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Element Type**: Single linear tetrahedral finite element.\n- **Reference Tetrahedron $\\hat{K}$ vertices**: $\\hat{\\boldsymbol{x}}_{1}=(0,0,0)$, $\\hat{\\boldsymbol{x}}_{2}=(1,0,0)$, $\\hat{\\boldsymbol{x}}_{3}=(0,1,0)$, $\\hat{\\boldsymbol{x}}_{4}=(0,0,1)$.\n- **Physical Tetrahedron $K$ vertices**: $\\boldsymbol{x}_{1}=(0,0,0)$, $\\boldsymbol{x}_{2}=(2,0,0)$, $\\boldsymbol{x}_{3}=(0,1,0)$, $\\boldsymbol{x}_{4}=(0,0,0.5)$.\n- **Mapping**: The element mapping $F_{K}:\\hat{K}\\rightarrow K$ is affine.\n- **Deformation Gradient**: $DF_{K}$ is constant on $K$.\n- **Norm**: The operator $2$-norm (spectral norm) is to be used.\n- **Tasks**:\n  1. Derive $DF_{K}$ and compute the condition number $\\kappa(DF_{K})=\\|DF_{K}\\|\\,\\|DF_{K}^{-1}\\|$.\n  2. Compute the element’s aspect ratio (longest edge / shortest edge).\n  3. Compute the minimum internal angle over all triangular faces of $K$ (in degrees).\n  4. Assess whether the element satisfies the quality thresholds: minimum face angle $> 20^\\circ$ and condition number $< 4.1$.\n- **Answer Specification**:\n  - The final answer is the numerical value of $\\kappa(DF_{K})$.\n  - Round to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded in the theory of the Finite Element Method (FEM), specifically concerning element quality metrics for a linear tetrahedral element. All terms like \"affine mapping\", \"deformation gradient\", \"condition number\", \"aspect ratio\", and \"minimum internal angle\" are standard, well-defined concepts in numerical analysis and computational mechanics. The provided data (vertex coordinates) are complete and self-consistent. The problem is well-posed, objective, and admits a unique, verifiable solution. It does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe analysis proceeds by addressing the three specified tasks in order.\n\n**1. Deformation Gradient and Condition Number**\n\nAn affine mapping $F_{K}$ from the reference element coordinates $\\hat{\\boldsymbol{x}} \\in \\hat{K}$ to the physical element coordinates $\\boldsymbol{x} \\in K$ is of the form:\n$$ \\boldsymbol{x} = F_K(\\hat{\\boldsymbol{x}}) = \\boldsymbol{B} \\hat{\\boldsymbol{x}} + \\boldsymbol{b} $$\nwhere $\\boldsymbol{B}$ is a constant $3 \\times 3$ matrix and $\\boldsymbol{b}$ is a constant translation vector. The deformation gradient, $DF_{K}$, is the Jacobian of this mapping, which is simply the matrix $\\boldsymbol{B}$.\n$$ DF_K = \\frac{\\partial \\boldsymbol{x}}{\\partial \\hat{\\boldsymbol{x}}} = \\boldsymbol{B} $$\nTo determine $\\boldsymbol{B}$ and $\\boldsymbol{b}$, we use the mapping of the vertices. For the first vertex, $\\hat{\\boldsymbol{x}}_{1} = (0,0,0)^T$ maps to $\\boldsymbol{x}_{1} = (0,0,0)^T$.\n$$ \\boldsymbol{x}_1 = \\boldsymbol{B} \\hat{\\boldsymbol{x}}_1 + \\boldsymbol{b} \\implies (0,0,0)^T = \\boldsymbol{B} (0,0,0)^T + \\boldsymbol{b} \\implies \\boldsymbol{b} = \\boldsymbol{0} $$\nThe mapping is purely linear: $\\boldsymbol{x} = \\boldsymbol{B} \\hat{\\boldsymbol{x}}$. The edge vectors of the physical element originating from $\\boldsymbol{x}_1$ can be expressed in terms of the mapping and the edge vectors of the reference element originating from $\\hat{\\boldsymbol{x}}_1$. Let $\\boldsymbol{v}_i = \\boldsymbol{x}_i - \\boldsymbol{x}_1$ and $\\hat{\\boldsymbol{v}}_i = \\hat{\\boldsymbol{x}}_i - \\hat{\\boldsymbol{x}}_1$ for $i \\in \\{2, 3, 4\\}$.\n$$ \\boldsymbol{v}_i = \\boldsymbol{x}_i - \\boldsymbol{x}_1 = (\\boldsymbol{B}\\hat{\\boldsymbol{x}}_i + \\boldsymbol{b}) - (\\boldsymbol{B}\\hat{\\boldsymbol{x}}_1 + \\boldsymbol{b}) = \\boldsymbol{B}(\\hat{\\boldsymbol{x}}_i - \\hat{\\boldsymbol{x}}_1) = \\boldsymbol{B}\\hat{\\boldsymbol{v}}_i $$\nThe reference edge vectors are:\n$$ \\hat{\\boldsymbol{v}}_2 = (1,0,0)^T, \\quad \\hat{\\boldsymbol{v}}_3 = (0,1,0)^T, \\quad \\hat{\\boldsymbol{v}}_4 = (0,0,1)^T $$\nThe corresponding physical edge vectors are:\n$$ \\boldsymbol{v}_2 = (2,0,0)^T, \\quad \\boldsymbol{v}_3 = (0,1,0)^T, \\quad \\boldsymbol{v}_4 = (0,0,0.5)^T $$\nWe can write this as a matrix equation:\n$$ [\\boldsymbol{v}_2, \\boldsymbol{v}_3, \\boldsymbol{v}_4] = \\boldsymbol{B} [\\hat{\\boldsymbol{v}}_2, \\hat{\\boldsymbol{v}}_3, \\hat{\\boldsymbol{v}}_4] $$\nSince $[\\hat{\\boldsymbol{v}}_2, \\hat{\\boldsymbol{v}}_3, \\hat{\\boldsymbol{v}}_4]$ is the $3 \\times 3$ identity matrix $\\boldsymbol{I}$, we find that $\\boldsymbol{B}$ is simply the matrix of physical edge vectors:\n$$ DF_K = \\boldsymbol{B} = [\\boldsymbol{v}_2, \\boldsymbol{v}_3, \\boldsymbol{v}_4] = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 0.5 \\end{pmatrix} $$\nThe condition number $\\kappa(DF_{K})$ with respect to the operator $2$-norm is defined as the ratio of the largest to the smallest singular value of $DF_{K}$, $\\kappa(DF_{K}) = \\sigma_{\\max} / \\sigma_{\\min}$. Since $DF_{K}$ is a diagonal matrix, its singular values are the absolute values of its diagonal entries: $\\sigma_1=2$, $\\sigma_2=1$, and $\\sigma_3=0.5$.\nThe largest singular value is $\\sigma_{\\max} = 2$.\nThe smallest singular value is $\\sigma_{\\min} = 0.5$.\nThe condition number is:\n$$ \\kappa(DF_{K}) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{2}{0.5} = 4 $$\nAlternatively, $\\kappa(DF_{K})=\\|DF_{K}\\|_2\\,\\|DF_{K}^{-1}\\|_2$. We have $\\|DF_{K}\\|_2 = \\sigma_{\\max} = 2$. The inverse is $DF_{K}^{-1} = \\text{diag}(1/2, 1, 2)$, so $\\|DF_{K}^{-1}\\|_2 = \\max(1/2, 1, 2) = 2$. Thus, $\\kappa(DF_K) = 2 \\times 2 = 4$.\n\n**2. Aspect Ratio**\n\nThe aspect ratio is the ratio of the longest edge length to the shortest edge length. We must compute the lengths of the $6$ edges of the physical tetrahedron $K$. Let $L_{ij} = \\|\\boldsymbol{x}_i - \\boldsymbol{x}_j\\|$.\n- $L_{12} = \\|(2,0,0) - (0,0,0)\\| = 2$\n- $L_{13} = \\|(0,1,0) - (0,0,0)\\| = 1$\n- $L_{14} = \\|(0,0,0.5) - (0,0,0)\\| = 0.5$\n- $L_{23} = \\|(0,1,0) - (2,0,0)\\| = \\|(-2,1,0)\\| = \\sqrt{(-2)^2+1^2+0^2} = \\sqrt{5}$\n- $L_{24} = \\|(0,0,0.5) - (2,0,0)\\| = \\|(-2,0,0.5)\\| = \\sqrt{4+0.25} = \\sqrt{4.25} = \\frac{\\sqrt{17}}{2}$\n- $L_{34} = \\|(0,0,0.5) - (0,1,0)\\| = \\|(0,-1,0.5)\\| = \\sqrt{0^2+(-1)^2+0.5^2} = \\sqrt{1+0.25} = \\sqrt{1.25} = \\frac{\\sqrt{5}}{2}$\nThe edge lengths are approximately $\\{2, 1, 0.5, 2.236, 2.062, 1.118\\}$.\nThe longest edge is $L_{\\max} = L_{23} = \\sqrt{5}$.\nThe shortest edge is $L_{\\min} = L_{14} = 0.5$.\nThe aspect ratio is:\n$$ \\text{Aspect Ratio} = \\frac{L_{\\max}}{L_{\\min}} = \\frac{\\sqrt{5}}{0.5} = 2\\sqrt{5} \\approx 4.472 $$\n\n**3. Minimum Internal Angle and Quality Assessment**\n\nWe compute the internal angles for each of the $4$ triangular faces using the dot product formula for the angle $\\theta$ between two vectors $\\boldsymbol{u}$ and $\\boldsymbol{v}$: $\\cos\\theta = (\\boldsymbol{u} \\cdot \\boldsymbol{v}) / (\\|\\boldsymbol{u}\\| \\|\\boldsymbol{v}\\|)$.\n\n- **Face 1 ($\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_3$):** Vectors from $\\boldsymbol{x}_1$ are $\\boldsymbol{v}_{12}=(2,0,0)$ and $\\boldsymbol{v}_{13}=(0,1,0)$. Since $\\boldsymbol{v}_{12} \\cdot \\boldsymbol{v}_{13} = 0$, the angle at $\\boldsymbol{x}_1$ is $90^\\circ$. The other angles are $\\arccos(2/\\sqrt{5}) \\approx 26.57^\\circ$ and $\\arccos(1/\\sqrt{5}) \\approx 63.43^\\circ$.\n\n- **Face 2 ($\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\boldsymbol{x}_4$):** Vectors from $\\boldsymbol{x}_1$ are $\\boldsymbol{v}_{12}=(2,0,0)$ and $\\boldsymbol{v}_{14}=(0,0,0.5)$. Since $\\boldsymbol{v}_{12} \\cdot \\boldsymbol{v}_{14} = 0$, the angle at $\\boldsymbol{x}_1$ is $90^\\circ$. The other angles are $\\arccos(4/\\sqrt{17}) \\approx 14.04^\\circ$ and $\\arccos(1/\\sqrt{17}) \\approx 75.96^\\circ$.\n\n- **Face 3 ($\\boldsymbol{x}_1, \\boldsymbol{x}_3, \\boldsymbol{x}_4$):** Vectors from $\\boldsymbol{x}_1$ are $\\boldsymbol{v}_{13}=(0,1,0)$ and $\\boldsymbol{v}_{14}=(0,0,0.5)$. Since $\\boldsymbol{v}_{13} \\cdot \\boldsymbol{v}_{14} = 0$, the angle at $\\boldsymbol{x}_1$ is $90^\\circ$. The other angles are $\\arccos(2/\\sqrt{5}) \\approx 26.57^\\circ$ and $\\arccos(1/\\sqrt{5}) \\approx 63.43^\\circ$.\n\n- **Face 4 ($\\boldsymbol{x}_2, \\boldsymbol{x}_3, \\boldsymbol{x}_4$):**\n    - Angle at $\\boldsymbol{x}_2$: Vectors are $\\boldsymbol{x}_3-\\boldsymbol{x}_2=(-2,1,0)$ and $\\boldsymbol{x}_4-\\boldsymbol{x}_2=(-2,0,0.5)$. Angle is $\\arccos(8/\\sqrt{85}) \\approx 29.74^\\circ$.\n    - Angle at $\\boldsymbol{x}_3$: Vectors are $\\boldsymbol{x}_2-\\boldsymbol{x}_3=(2,-1,0)$ and $\\boldsymbol{x}_4-\\boldsymbol{x}_3=(0,-1,0.5)$. Angle is $\\arccos(1/2.5) = \\arccos(0.4) \\approx 66.42^\\circ$.\n    - Angle at $\\boldsymbol{x}_4$: Vectors are $\\boldsymbol{x}_2-\\boldsymbol{x}_4=(2,0,-0.5)$ and $\\boldsymbolx}_3-\\boldsymbol{x}_4=(0,1,-0.5)$. Angle is $\\arccos(1/\\sqrt{85}) \\approx 83.83^\\circ$.\n\nThe minimum angle over all faces is $\\theta_{\\min} = \\arccos(4/\\sqrt{17}) \\approx 14.04^\\circ$.\n\n**Assessment of Quality Thresholds:**\n\n- **Minimum face angle threshold ($20^\\circ$):**\nThe computed minimum angle is $14.04^\\circ$. Since $14.04^\\circ < 20^\\circ$, the element **FAILS** this quality threshold.\n\n- **Condition number threshold ($4.1$):**\nThe computed condition number is $\\kappa(DF_K) = 4$. Since $4 < 4.1$, the element **PASSES** this quality threshold.\n\nAs per the answer specification, the final answer is the value of $\\kappa(DF_{K})$ rounded to four significant figures.\n$$ \\kappa(DF_K) = 4.000 $$",
            "answer": "$$\\boxed{4.000}$$"
        },
        {
            "introduction": "To ensure that a finite element method converges to the correct solution as the mesh is refined, the chosen elements must be able to exactly represent, at a minimum, a constant or linear field. The patch test is a fundamental numerical experiment that verifies this capability, especially for non-standard or non-conforming elements. This problem  guides you through performing a patch test on a non-conforming mesh with a \"hanging node,\" demonstrating how appropriate constraints are crucial for maintaining the consistency and convergence properties of the method.",
            "id": "3419666",
            "problem": "Consider the square domain $\\Omega = [0,1] \\times [0,1]$. Let $\\mathcal{T}_h$ be a triangulation that is nonconforming due to a single T-junction on the vertical segment $\\{(x,y) \\in \\Omega : x = 0.5, 0 \\le y \\le 1\\}$. The vertex set is\n- $A = (0,0)$, $B = (0.5,0)$, $C = (0.5,1)$, $D = (0,1)$, $E = (1,0)$, $F = (1,0.5)$, $G = (1,1)$, and a hanging node $H = (0.5,0.5)$.\nThe elements are the triangles\n- $T_1 = \\triangle ABC$, $T_2 = \\triangle ACD$ on the left half of $\\Omega$,\n- $T_3 = \\triangle BHE$, $T_4 = \\triangle EHF$, $T_5 = \\triangle HCG$, $T_6 = \\triangle HGF$ on the right half of $\\Omega$.\nOn each triangle, consider standard first-order Lagrange shape functions (i.e., continuous, piecewise-affine functions). To enforce interelement continuity across the nonmatching interface caused by the T-junction, impose the linear constraint at the hanging node $H$:\n$$\nu_h(H) \\;=\\; \\tfrac{1}{2}\\,u_h(B) \\;+\\; \\tfrac{1}{2}\\,u_h(C).\n$$\nLet $p(x,y) = a x + b y + c$ be an arbitrary linear polynomial with constants $a$, $b$, and $c \\in \\mathbb{R}$. Define $u_h \\in V_h$ as the unique piecewise-affine function on $\\mathcal{T}_h$ that takes nodal values $u_h(X) = p(X)$ at all non-hanging vertices $X \\in \\{A,B,C,D,E,F,G\\}$ and satisfies the above constraint at $H$.\n\nUsing only fundamental properties of first-order Lagrange finite elements and the above constraint, determine whether this constrained nonconforming mesh can exactly represent the linear function $p$. In particular, compute the $L^2$-norm of the representation error over $\\Omega$:\n$$\n\\|p - u_h\\|_{L^2(\\Omega)} \\;=\\; \\left(\\int_{\\Omega} |p(x,y) - u_h(x,y)|^2 \\, dx\\,dy\\right)^{1/2}.\n$$\nGive your final answer as an exact real number without units.",
            "solution": "The problem asks for the computation of the $L^2$-norm of the representation error, $\\|p - u_h\\|_{L^2(\\Omega)}$, where $p(x,y) = ax+by+c$ is an arbitrary linear polynomial and $u_h$ is its representation in a specific finite element space defined on a nonconforming mesh.\n\nFirst, we must verify the validity of the problem statement. The domain is the unit square $\\Omega = [0,1] \\times [0,1]$. The triangulation $\\mathcal{T}_h$ is specified by a set of vertices and triangles. Let's confirm that these triangles form a valid partition of $\\Omega$.\nThe vertices are $A=(0,0)$, $B=(0.5,0)$, $C=(0.5,1)$, $D=(0,1)$, $E=(1,0)$, $F=(1,0.5)$, $G=(1,1)$. The hanging node is $H=(0.5,0.5)$.\nThe left half of the domain, $[0, 0.5] \\times [0,1]$, has corners at $(0,0), (0.5,0), (0.5,1)$, and $(0,1)$, which correspond to vertices $A, B, C, D$. The elements are $T_1 = \\triangle ABC$ and $T_2 = \\triangle ACD$. The union $T_1 \\cup T_2$ is the polygon with boundary $A \\to B \\to C \\to D \\to A$, which correctly forms the rectangle $[0, 0.5] \\times [0,1]$.\nThe right half of the domain, $[0.5, 1] \\times [0,1]$, is composed of triangles $T_3, T_4, T_5, T_6$.\n- $T_3 = \\triangle BHE = \\triangle(0.5,0), (0.5,0.5), (1,0)$.\n- $T_4 = \\triangle EHF = \\triangle(1,0), (0.5,0.5), (1,0.5)$.\nThe union $T_3 \\cup T_4$ forms the rectangle with vertices $(0.5,0), (1,0), (1,0.5), (0.5,0.5)$, which is $[0.5, 1] \\times [0, 0.5]$.\n- $T_5 = \\triangle HCG = \\triangle(0.5,0.5), (0.5,1), (1,1)$.\n- $T_6 = \\triangle HGF = \\triangle(0.5,0.5), (1,1), (1,0.5)$.\nThe union $T_5 \\cup T_6$ forms the rectangle with vertices $(0.5,0.5), (0.5,1), (1,1), (1,0.5)$, which is $[0.5, 1] \\times [0.5, 1]$.\nThe union of all six triangles correctly tiles the entire domain $\\Omega$. The problem is geometrically self-consistent. The concepts of nonconforming meshes, Lagrange elements, and hanging node constraints are standard in numerical analysis. The problem is valid.\n\nThe error to be computed is $\\|p - u_h\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} |p(x,y) - u_h(x,y)|^2 \\, dx\\,dy\\right)^{1/2}$. We can analyze the error $e(x,y) = p(x,y) - u_h(x,y)$ on a per-element basis. The total squared error is the sum of the squared errors over each element:\n$$\n\\|p - u_h\\|_{L^2(\\Omega)}^2 = \\sum_{k=1}^6 \\int_{T_k} |p(x,y) - u_h(x,y)|^2 \\, dx\\,dy.\n$$\nThe function $u_h$ is a piecewise-affine function. On each triangle $T_k$, $u_h$ is a linear polynomial uniquely determined by its values at the three vertices of $T_k$.\n\nLet's first analyze the elements on the left side of the domain, $\\Omega_L = [0, 0.5] \\times [0,1]$. This subdomain is meshed by $T_1 = \\triangle ABC$ and $T_2 = \\triangle ACD$.\nOn $T_1$, the function $u_h$ is defined by its values at the vertices $A, B, C$. By problem definition, the nodal values at non-hanging vertices are obtained by evaluating $p$:\n$u_h(A) = p(A)$, $u_h(B) = p(B)$, and $u_h(C) = p(C)$.\nThe function $u_h$ on $T_1$ is the unique linear polynomial that agrees with the linear polynomial $p$ at three non-collinear points (the vertices of $T_1$). Therefore, $u_h(x,y)$ must be identical to $p(x,y)$ for all $(x,y) \\in T_1$.\nSimilarly, on $T_2$, $u_h$ is defined by its values at vertices $A, C, D$. The nodal values are $u_h(A)=p(A)$, $u_h(C)=p(C)$, and $u_h(D)=p(D)$. As before, $u_h(x,y)$ must be identical to $p(x,y)$ for all $(x,y) \\in T_2$.\nConsequently, the error $p - u_h$ is identically zero on the entire left subdomain $\\Omega_L$. The contribution to the total error from this part is zero.\n\nNow, we analyze the elements on the right side of the domain, $\\Omega_R = [0.5, 1] \\times [0,1]$. This involves the hanging node $H=(0.5,0.5)$.\nThe values of $u_h$ at the non-hanging vertices $B, C, E, F, G$ are set by evaluating $p$. The value at the hanging node $H$ is determined by the linear constraint:\n$$\nu_h(H) = \\tfrac{1}{2}\\,u_h(B) + \\tfrac{1}{2}\\,u_h(C).\n$$\nSubstituting the definitions for $u_h(B)$ and $u_h(C)$, we get:\n$$\nu_h(H) = \\tfrac{1}{2}\\,p(B) + \\tfrac{1}{2}\\,p(C).\n$$\nWe must now compare this value to the value of the polynomial $p$ at point $H$, i.e., $p(H)$.\nA fundamental property of any linear function $p(x,y)=ax+by+c$ is that its value on a line segment is a linear interpolation of its values at the endpoints. Specifically, for a point $P_\\lambda = (1-\\lambda)P_1 + \\lambda P_2$, we have $p(P_\\lambda) = (1-\\lambda)p(P_1) + \\lambda p(P_2)$.\nThe vertices in question are $B=(0.5,0)$ and $C=(0.5,1)$. The hanging node is $H=(0.5,0.5)$. We can observe that $H$ is the midpoint of the line segment $BC$:\n$$\nH = (0.5, 0.5) = \\left(\\frac{0.5+0.5}{2}, \\frac{0+1}{2}\\right) = \\tfrac{1}{2}B + \\tfrac{1}{2}C.\n$$\nThis corresponds to the case $\\lambda = 1/2$. Applying the property of linear functions:\n$$\np(H) = p(\\tfrac{1}{2}B + \\tfrac{1}{2}C) = \\tfrac{1}{2}\\,p(B) + \\tfrac{1}{2}\\,p(C).\n$$\nComparing this with the expression for $u_h(H)$, we find:\n$$\nu_h(H) = p(H).\n$$\nThe constraint is precisely the condition required for the nodal value of $u_h$ at the hanging node to match the value of the linear polynomial $p$. This is known as satisfying the patch test for linear polynomials.\n\nWith $u_h(H)=p(H)$, we can determine the error on the triangles in $\\Omega_R$.\n- On $T_3 = \\triangle BHE$: vertices are $B, H, E$. The nodal values for $u_h$ are $u_h(B)=p(B)$, $u_h(H)=p(H)$, and $u_h(E)=p(E)$. Since the linear function $u_h$ on $T_3$ matches the linear function $p$ at three vertices, $u_h \\equiv p$ on $T_3$.\n- On $T_4 = \\triangle EHF$: vertices are $E, H, F$. Nodal values are $u_h(E)=p(E)$, $u_h(H)=p(H)$, $u_h(F)=p(F)$. Thus, $u_h \\equiv p$ on $T_4$.\n- On $T_5 = \\triangle HCG$: vertices are $H, C, G$. Nodal values are $u_h(H)=p(H)$, $u_h(C)=p(C)$, $u_h(G)=p(G)$. Thus, $u_h \\equiv p$ on $T_5$.\n- On $T_6 = \\triangle HGF$: vertices are $H, G, F$. Nodal values are $u_h(H)=p(H)$, $u_h(G)=p(G)$, $u_h(F)=p(F)$. Thus, $u_h \\equiv p$ on $T_6$.\n\nThe representation error $p(x,y) - u_h(x,y)$ is therefore identically zero on every element $T_k$ in the triangulation $\\mathcal{T}_h$. This implies that $p(x,y) - u_h(x,y) = 0$ for all $(x,y) \\in \\Omega$.\nThe $L^2$-norm of the error is then:\n$$\n\\|p - u_h\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} |0|^2 \\, dx\\,dy\\right)^{1/2} = 0.\n$$\nThe constrained nonconforming mesh can exactly represent any linear function $p$. The error is zero, regardless of the specific coefficients $a,b,c$ of the linear polynomial.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}