## 引言
在计算科学与工程领域，[偏微分方程](@entry_id:141332)（PDEs）是描述从[结构力学](@entry_id:276699)到[流体动力学](@entry_id:136788)等各种物理现象的通用语言。然而，直接求解这些方程往往是不可能的，因此数值方法，特别是有限元方法（FEM），成为了不可或缺的工具。所有这些方法的基石都是一个看似简单的概念：**[网格离散化](@entry_id:751904)**，即将一个连续的物理域分解为一族离散的、可管理的几何单元（如三角形或四边形）和节点。

尽管[网格离散化](@entry_id:751904)是后续所有计算的起点，但对其背后深刻的数学原理、对计算精度和效率的决定性影响，以及其在不同学科中的应用往往是零散的。本文章旨在填补这一空白，提供一个从基本原理到前沿应用的完整知识框架。

为此，我们将通过三个章节逐步展开。第一章**“原理与机制”**将深入剖析[网格离散化](@entry_id:751904)的数学基础，从单元和节点的定义到[参考单元](@entry_id:168425)映射和[网格质量评估](@entry_id:177527)。第二章**“应用与跨学科连接”**将展示这些基本概念如何在实际问题（如系统组装、[自适应加密](@entry_id:746260)和并行计算）中发挥作用，并连接多个学科领域。最后，第三章**“动手实践”**将通过具体编程问题，让读者亲手实现和体验这些核心概念。通过这一结构，读者将建立起一个连贯而深入的理解，为解决复杂的科学与工程问题打下坚实的基础。

## 原理与机制

在[数值求解偏微分方程](@entry_id:634353)（PDEs）的过程中，将连续的物理域剖分为离散单元的集合，即网格剖分，是有限元方法（FEM）等数值方法的基石。本章将深入探讨[网格离散化](@entry_id:751904)的核心原理与机制，从网格的基本定义出发，逐步阐释单元与节点、几何与代数自由度、参考单元映射、[网格质量评估](@entry_id:177527)，直至处理复杂边界和[非协调网格](@entry_id:752550)等高级主题。我们的目标是建立一个从理论定义到实际计算的完整知识框架。

### 网格的基本概念

从根本上说，网格剖分是将一个复杂的几何域 $\Omega \subset \mathbb{R}^d$（其中 $d=2$ 或 $3$）分解为一族简单、互不重叠的几何形状（称为**单元**）的过程。这些单元通常是多边形（在 $\mathbb{R}^2$ 中）或多面体（在 $\mathbb{R}^3$ 中）。

#### 网格的定义：单元、节点与协调性

一个**网格** $\mathcal{T}_h$ 是计算域 $\Omega$ 的一个剖分，它由有限个被称为**单元**（elements）$K$ 的开集组成。一个有效的网格必须满足以下基本属性：
1.  **覆盖性**：所有单元[闭集的并集](@entry_id:143294)完全覆盖域的[闭集](@entry_id:136446)，即 $\overline{\Omega} = \bigcup_{K \in \mathcal{T}_h} \overline{K}$。
2.  **不相交性**：任意两个不同单元的内部互不相交，即对于 $K, K' \in \mathcal{T}_h$ 且 $K \neq K'$，有 $K \cap K' = \emptyset$。

在有限元分析中，我们通常要求网格具有更强的**协调性**（conformity）。一个**[协调网格](@entry_id:162625)**（conforming mesh）除了满足上述基本属性外，还必须满足以下关键的邻接条件：
对于任意两个不同的单元 $K, K' \in \mathcal{T}_h$，它们的[闭集](@entry_id:136446)之交 $\overline{K} \cap \overline{K'}$ 要么是空集，要么是这两个单元共有的一个完整的低维**面**（face）。这里的“面”是一个广义术语，它可以是一个顶点（0维面）、一条边（1维面）或一个面片（(d-1)维面）。

这个协调性条件的一个重要推论是，它禁止了**[悬挂节点](@entry_id:149024)**（hanging nodes）的出现。[悬挂节点](@entry_id:149024)是指一个单元的顶点恰好落在相邻单元的边的内部（而非端点）。在[协调网格](@entry_id:162625)中，这种情况是被严格禁止的，因为单元间的交集必须是它们共有的一个完整实体 。

与网格相关的几何实体，如顶点、边和面，可以被组织成所谓的**骨架**（skeletons）。对于一个网格 $\mathcal{T}_h$，其 $k$-维骨架 $\mathcal{S}^k(\mathcal{T}_h)$ 定义为所有单元的所有 $k$-维面的并集。
例如：
- **0-维骨架** $\mathcal{S}^0(\mathcal{T}_h)$ 是网格中所有顶点的集合。
- **1-维骨架** $\mathcal{S}^1(\mathcal{T}_h)$ 是网格中所有边的集合。
- **(d-1)-维骨架** $\mathcal{S}^{d-1}(\mathcal{T}_h)$ 包含了所有[余维](@entry_id:273141)为1的面，这既包括位于域 $\Omega$ 内部的**内部面**（由两个单元共享），也包括位于域边界 $\partial\Omega$ 上的**边界面** 。

### 从几何到代数：表示网格与解

网格为[偏微分方程的离散化](@entry_id:748528)提供了几何框架，但数值计算还需要一个[代数结构](@entry_id:137052)来表示近似解。这引出了几何实体与代数自由度之间的重要区别。

#### 几何节点与代数自由度

**几何节点**（geometric nodes）通常指构成网格几何形状的顶点，即 $0$-维骨架 $\mathcal{S}^0(\mathcal{T}_h)$。它们是定义单元形状和位置的纯粹几何点。

与此相对，**代数自由度**（algebraic degrees of freedom, DoFs）是用于唯一确定有限元空间中一个函数的[线性无关](@entry_id:148207)的线性泛函。它们是代数概念，定义了近似解的表示方式。

这两者之间的关系取决于所选的有限元类型 ：
-   对于最简单的**节点型拉格朗日单元**（nodal Lagrange elements），例如线性元（$\mathbb{P}_1$ 或 $\mathcal{Q}_1$），自由度恰好是在几何节点（顶点）上的函数值评估。在这种情况下，几何节点与自由度的位置重合。
-   对于**高阶拉格朗日单元**，自由度可能位于单元的边、面或内部，而不仅仅是顶点 。
-   对于其他类型的有限元族，如用于求解矢量场的 **Raviart-Thomas** 或 **Brezzi-Douglas-Marini** 单元，自由度可能不是简单的点值评估，而是函数在边或面上的积分矩（例如，法向分量的平均值）。

因此，必须清晰地区分定义网格几何的“几何节点”和定义函数空间的“代数自由度”。

#### 描述连通性：[关联矩阵](@entry_id:263683)

为了在计算机中实现有限元方法，我们需要一种[数据结构](@entry_id:262134)来存储网格的拓扑信息，即单元、节点、边等之间的连接关系。**[关联矩阵](@entry_id:263683)**（incidence matrices）为此提供了一种形式化且强大的工具。

例如，我们可以定义：
-   **节点-单元[关联矩阵](@entry_id:263683)** $M_{0,2}$：其元素 $(M_{0,2})_{i\ell}=1$ 表示节点 $i$ 是单元 $K_\ell$ 的一个顶点，否则为 $0$。
-   **单元-边[关联矩阵](@entry_id:263683)** $B_{2,1}$：这是一个有向矩阵，用于描述边的方向与单元边界方向的关系。给定全局的边方向（例如，从小编号节点指向大编号节点），如果某条边在单元边界上的方向与全局方向一致，则矩阵元素为 $+1$；如果相反，则为 $-1$；如果该边不属于此单元边界，则为 $0$。

考虑一个由三个三角形 $K_1=(1,2,3)$, $K_2=(3,2,4)$, $K_3=(3,4,5)$ 构成的简单二维网格。其节点集为 $\mathcal{V}=\{1,2,3,4,5\}$，[边集](@entry_id:267160)为 $\mathcal{E}=\{e_1, \dots, e_7\}$。我们可以构建节点-单元[关联矩阵](@entry_id:263683) $M_{0,2} \in \{0,1\}^{5 \times 3}$ 和有向的单元-边[关联矩阵](@entry_id:263683) $B_{2,1} \in \{-1,0,1\}^{3 \times 7}$。通过检查每个单元包含的节点和带方向的边，我们可以显式地写出这些矩阵。例如，在  的例子中，节点3同时属于 $K_1, K_2, K_3$，因此 $M_{0,2}$ 矩阵第三行的元素均为1。类似地，边 $(2,3)$ 在 $K_1$ 中是 $2 \to 3$（与全局方向一致，为+1），在 $K_2$ 中是 $3 \to 2$（与全局方向相反，为-1），这清晰地表明了边 $(2,3)$ 是一个内部边。这些矩阵不仅编码了拓扑，其代数性质（如[矩阵的核](@entry_id:152429)与像）也与微分几何中的外微分算子相对应。

### [参考单元](@entry_id:168425)的角色：映射与雅可比

直接在形状各异的物理单元上定义[基函数](@entry_id:170178)和进行数值积分是极其繁琐的。有限元方法通过引入**参考单元**（reference element）$\hat{K}$ 的概念，极大地简化了这一过程。所有计算，如[基函数](@entry_id:170178)定义和[数值积分](@entry_id:136578)，都在这个固定的、形状规则的[参考单元](@entry_id:168425)上进行。然后，通过一个可逆的**[几何映射](@entry_id:749852)**（mapping）$F_K: \hat{K} \to K$，将结果转换到物理域的真实单元 $K$ 上。

最常用的参考单元包括 $d$-维**参考单纯形**（如参考三角形或四面体）和 $d$-维**参考[超立方体](@entry_id:273913)**（如参考正方形或立方体）。

#### 仿射与[等参映射](@entry_id:173239)

-   **单纯形单元 ([仿射映射](@entry_id:746332))**：如果物理单元 $K$ 是一个单纯形（例如，三角形或四面体），那么从参考单纯形 $\hat{K}$ 到 $K$ 的映射 $F_K$ 是一个唯一的**[仿射映射](@entry_id:746332)**（affine map），形式为 $F_K(\hat{\mathbf{x}}) = B_K \hat{\mathbf{x}} + \mathbf{c}$。其中 $B_K$ 是一个 $d \times d$ 矩阵，$\mathbf{c}$ 是一个平移向量。这个映射由参考单元的顶点到物理单元顶点的对应关系唯一确定。具体来说，如果 $\mathbf{x}_0, \dots, \mathbf{x}_d$ 是物理单元的顶点，而 $\mathbf{\hat{v}}_0, \dots, \mathbf{\hat{v}}_d$ 是参考单元的顶点，其中 $\mathbf{\hat{v}}_0$ 是原点，则平移向量 $\mathbf{c} = \mathbf{x}_0$，而矩阵 $B_K$ 的第 $j$ 列由向量 $(\mathbf{x}_j - \mathbf{x}_0)$ 给出 。

-   **四边形/[六面体单元](@entry_id:174602) ([等参映射](@entry_id:173239))**：对于非仿射等价的单元，如一般的四边形或弯曲的单元，我们使用**[等参映射](@entry_id:173239)**（isoparametric mapping）。其思想是利用与定义函数空间相同的[基函数](@entry_id:170178)（称为**形函数**，shape functions）来构造[几何映射](@entry_id:749852)。例如，对于一个四节点四边形，其[几何映射](@entry_id:749852)定义为：
    $$
    \mathbf{x}(\hat{\mathbf{x}}) = \sum_{i=1}^{N} N_i(\hat{\mathbf{x}}) \mathbf{x}_i
    $$
    其中 $\mathbf{x}_i$ 是物理单元的节点坐标，$N_i(\hat{\mathbf{x}})$ 是在参考单元上定义的对应节点的[拉格朗日形函数](@entry_id:635448)。如果形函数是双线性（bilinear）的，那么映射就是[双线性映射](@entry_id:186502) 。

#### [雅可比矩阵](@entry_id:264467)：量化几何畸变

映射 $F_K$ 的**[雅可比矩阵](@entry_id:264467)**（Jacobian matrix），记为 $DF_K$，在有限元计算中扮演着核心角色。它是一个包含了 $F_K$ 所有一阶[偏导数](@entry_id:146280)的矩阵。
$$
(DF_K)_{ij} = \frac{\partial (F_K)_i}{\partial \hat{x}_j}
$$
雅可比矩阵的[行列式](@entry_id:142978) $J_K = \det(DF_K)$ 同样至关重要。它们的作用体现在两个方面：
1.  **梯度变换**：物理单元上的梯度与参考单元上的梯度通过雅可比矩阵的逆[转置](@entry_id:142115)相关联：$\nabla u = (DF_K)^{-T} \hat{\nabla} \hat{u}$。
2.  **积分[测度变换](@entry_id:157887)**：在进行积分换元时，[微分](@entry_id:158718)元之间通过雅可比行列式相关联：$d\mathbf{x} = J_K d\hat{\mathbf{x}}$。

对于[仿射映射](@entry_id:746332)，[雅可比矩阵](@entry_id:264467) $DF_K = B_K$ 是一个常数矩阵，这大大简化了计算。例如，在  中，[四面体单元](@entry_id:168311)的[雅可比行列式](@entry_id:137120)被计算为一个常数。而对于一般的[等参映射](@entry_id:173239)，[雅可比矩阵](@entry_id:264467)及其[行列式](@entry_id:142978)通常是参考坐标 $\hat{\mathbf{x}}$ 的函数，这意味着在单元内部不同点的几何畸变是不同的 。一个非正或退化的 $J_K$ 意味着映射是不可逆的，单元几何形状是无效的（例如，发生了内卷）。

### [高阶单元](@entry_id:750328)与节点[分布](@entry_id:182848)

为了获得更高的精度，我们可以使用更高阶的多项式来近似解，这便引出了**高阶有限元**。

#### 多项式空间与节点集

在单纯形单元上，通常使用**总次数**不超过 $p$ 的多项式空间 $\mathbb{P}_p$。在超立方体单元上，则使用**各方向次数**均不超过 $p$ 的张量积[多项式空间](@entry_id:144410) $\mathbb{Q}_p$。

为了唯一地定义一个 $p$ 次拉格朗日单元，我们需要指定 $\dim(\mathbb{P}_p)$ 或 $\dim(\mathbb{Q}_p)$ 个节点的位置。这些节点的选取必须保证其是**适定**的（unisolvent），即任何一个属于该[多项式空间](@entry_id:144410)的函数都可以被这些节点上的值唯一确定。

-   对于 $\mathbb{P}_p$ 空间，标准节点集可以通过在单纯形的**[重心坐标](@entry_id:155488)**（barycentric coordinates）中均匀取点来构造。例如，对于 $p=3$ 的三角形，其节点坐标可以表示为 $(\frac{k_1}{3}, \frac{k_2}{3})$，其中 $k_1, k_2$ 是非负整数且 $k_1+k_2 \le 3$ 。

-   对于 $\mathbb{Q}_p$ 空间，节点集通常通过一维节点集的[张量积](@entry_id:140694)来构造。例如，对于 $p=3$ 的正方形，其节点坐标为 $(\frac{i}{3}, \frac{j}{3})$，其中 $i,j \in \{0, 1, 2, 3\}$ 。

#### 高阶插值的挑战：稳定性与[节点选择](@entry_id:637104)

当多项式次数 $p$ 增高时，节点位置的选择变得至关重要。一个衡量插值过程稳定性的关键指标是**[勒贝格常数](@entry_id:196241)**（Lebesgue constant）$\Lambda_p$。它量化了[插值误差](@entry_id:139425)相对于最佳逼近误差可能被放大的最大倍数。

-   **[等距节点](@entry_id:168260)**：一个看似自然的选择是在区间上使用等距[分布](@entry_id:182848)的节点。然而，这是一个灾难性的选择。对于[等距节点](@entry_id:168260)，[勒贝格常数](@entry_id:196241)随 $p$ **[指数增长](@entry_id:141869)** ($\Lambda_p \sim 2^p/ (p \ln p)$)。这种不稳定性导致了著名的**龙格现象**（Runge phenomenon），即在高次插值时，函数在区间端点附近会产生剧烈的[伪振荡](@entry_id:152404)，导致插值结果发散 。

-   **[高斯-洛巴托-勒让德](@entry_id:749736) (GLL) 节点**：为了克服不稳定性，需要采用非[均匀分布](@entry_id:194597)的节点，使其在区间两端更密集。一类优秀的[节点选择](@entry_id:637104)是**GLL节点**（Gauss–Lobatto–Legendre nodes），它们是 $(1-x^2)P'_p(x)$ 的根，其中 $P_p(x)$ 是 $p$ 次[勒让德多项式](@entry_id:141510)。对于GLL节点（以及[切比雪夫节点](@entry_id:145620)），[勒贝格常数](@entry_id:196241)仅随 $p$ **对数增长** ($\Lambda_p = O(\log p)$）。这种缓慢的增长确保了插值过程的稳定性。当被逼近的函数足够光滑（例如，[解析函数](@entry_id:139584)）时，最佳逼近误差会以指数速率下降，远快于 $\log p$ 的增长，从而实现所谓的**谱收敛**（spectral convergence）。

重要的是，在[等参映射](@entry_id:173239)下，一维情况下的[勒贝格常数](@entry_id:196241)在从参考单元到物理单元的变换中是不变的。因此，在参考单元上选择稳定的节点[分布](@entry_id:182848)（如GLL节点）对于保证在弯曲物理单元上的高阶[插值稳定性](@entry_id:750768)至关重要 。

### [网格质量](@entry_id:151343)及其对精度的影响

有限元解的精度不仅取决于多项式次数 $p$ 和网格尺寸 $h$，还强烈地依赖于网格单元的**几何质量**。形状畸变严重的单元会导致数值解的精度显著下降。

#### 几何质量度量

为了量化单元的“好坏”，我们定义了一系列**质量度量**（quality metrics） ：
-   **[形状规则性](@entry_id:754733)参数** $\sigma_K = h_K / \rho_K$，其中 $h_K$ 是单元的[外接圆](@entry_id:165300)直径，$\rho_K$ 是[内切圆半径](@entry_id:168802)。这是衡量单元“接近”规则形状的最基本指标。一个理想的等边三角形的 $\sigma_K$ 值较小，而一个狭长的“针状”三角形的 $\sigma_K$ 值会非常大。
-   **最小/最大角**：对于[三角形单元](@entry_id:167871)，最小内角 $\theta_{\min}$ 和最大内角 $\theta_{\max}$ 是非常直观的度量。$\theta_{\min} \to 0$ 或 $\theta_{\max} \to \pi$ 都表示单元形状退化。
-   **[纵横比](@entry_id:177707)**（Aspect ratio）：对于四边形或更一般的单元，可以定义为最长边与最短边（或最短高）之比。
-   **雅可比矩阵的[条件数](@entry_id:145150)** $\kappa(DF_K) = \|DF_K\| \|DF_K^{-1}\|$：这个量度直接与从[参考单元](@entry_id:168425)到物理单元的映射相关，它同时捕捉了单元的拉伸和扭曲。可以证明，$\sigma_K$ 与 $\kappa(DF_K)$ 在量级上是等价的。

#### 质量与[插值误差](@entry_id:139425)的关系

[网格质量](@entry_id:151343)通过影响[插值误差](@entry_id:139425)常数来影响最终的计算精度。标准的有限元[插值误差估计](@entry_id:750765)形式为：
$$
\|u - I_K u\|_{H^m(K)} \le C_{m,p}(K) h_K^{p+1-m} |u|_{H^{p+1}(K)}
$$
这里的关键在于，常数 $C_{m,p}(K)$ 并非与单元形状无关。通过[标度分析](@entry_id:153681)可以证明，该常数与[形状规则性](@entry_id:754733)参数 $\sigma_K$ 的关系为 ：
$$
C_{m,p}(K) \propto (\sigma_K)^m
$$
这个关系揭示了深刻的内涵：
-   当我们在 $H^1$ 范数下（$m=1$）衡量误差时，[误差常数](@entry_id:168754)正比于 $\sigma_K$。这意味着，对于三角形，[误差常数](@entry_id:168754)与 $1/\sin(\theta_{\min})$ 成正比；对于四边形，则与纵横比和扭曲度的组合成正比。这解释了为什么我们需要避免小角度或大纵横比的单元。
-   一个值得注意的特例是 $L^2$ 范数下的误差（$m=0$）。此时，[误差常数](@entry_id:168754) $C_{0,p}(K)$ 与 $\sigma_K^0=1$ 成正比，即**$L^2$ [误差常数](@entry_id:168754)与单元形状无关**。这个所谓的“形状无关”特性是一个非常重要的理论结果，但它并不意味着我们可以随意使用坏单元，因为刚度矩阵的[条件数](@entry_id:145150)仍会受单元质量影响，导致代数求解困难。

### 网格剖分的进阶主题

#### 几何逼近误差

当计算域 $\Omega$ 具有弯曲边界 $\Gamma$ 时，由多边形（或多面体）构成的网格边界 $\Gamma_h$ 只能是对 $\Gamma$ 的一种近似。这种几何上的不匹配会引入额外的**几何逼近误差**。

我们可以用**[豪斯多夫距离](@entry_id:152367)**（Hausdorff distance） $d_H(\Gamma, \Gamma_h)$ 来量化这种误差。如果边界 $\Gamma$ 足够光滑（例如 $\mathcal{C}^{r+1}$ 类），并且我们使用分片 $r$ 次多项式曲线来逼近它（例如，线性边构成 $r=1$ 的情况），那么可以证明几何逼近误差的收敛阶为 ：
$$
d_H(\Gamma, \Gamma_h) = O(h^{r+1})
$$
这个结果意义重大。它表明，如果我们使用高阶有限元（大 $p$ 值）来求解，为了不让几何误差成为精度的瓶颈，我们也必须使用相应高阶的几何表示（大 $r$ 值）来逼近弯曲边界。这正是**等参元**（isoparametric elements）思想的精髓所在：用同阶的多项式来描述几何和解。

#### [非协调网格](@entry_id:752550)与[悬挂节点](@entry_id:149024)

虽然[协调网格](@entry_id:162625)在理论上更简单，但在**[自适应网格加密](@entry_id:143852)**（adaptive mesh refinement, AMR）等应用中，允许**[非协调网格](@entry_id:752550)**（non-conforming meshes）可以极大地提高灵活性。最常见的非协调性表现为**[悬挂节点](@entry_id:149024)**。

[悬挂节点](@entry_id:149024)的出现会破坏[函数空间](@entry_id:143478)的 $C^0$ 连续性，因为在[悬挂节点](@entry_id:149024)处，解的值没有被直接定义。为了恢复连续性，必须对[悬挂节点](@entry_id:149024)处的自由度施加**约束**。

以双线性 $\mathcal{Q}_1$ 单元为例，考虑一条粗单元的边，其端点为 $A$ 和 $B$。如果这条边被两个细单元共享，从而在其中点 $H$ 产生一个[悬挂节点](@entry_id:149024)。由于有限元函数在粗单元边上的迹（trace）是线性的，它由端点值 $u_A$ 和 $u_B$ 唯一确定。为了保证连续性，[悬挂节点](@entry_id:149024) $H$ 处的函数值 $u_H$ 必须与粗单元边上的迹在该点的值一致。对于中点，这意味着 ：
$$
u_H = \frac{1}{2}(u_A + u_B)
$$
这个[线性约束](@entry_id:636966)方程必须在构建全局[线性系统](@entry_id:147850)时被强制执行，通常通过修改全局自由度映射或直接代入消元来实现。

#### 实施边界条件：以周期性边界为例

在组装[全局刚度矩阵](@entry_id:138630)和[载荷向量](@entry_id:635284)的过程中，必须正确施加边界条件。除了常见的狄利克雷（Dirichlet）和诺伊曼（Neumann）边界条件外，**[周期性边界条件](@entry_id:147809)**（periodic boundary conditions）在许多物理问题中也十分重要。

[周期性边界条件](@entry_id:147809)，例如 $u(0,y) = u(L_x, y)$，意味着域的左右两边界被“视同”一点。在离散层面，这通过识别边界上的节点对来实现 。
1.  **节点识别**：在左右边界上具有相同 $y$ 坐标的一对节点 $(i, j)$ 被视为等价。
2.  **主从关系**：在每一对等价节点中，我们指定一个为**主节点**（master），另一个为**从节点**（slave）。例如，可以选择所有左边界节点为主节点。
3.  **约束实施**：在全局自由度编号和矩阵组装时，从节点的自由度被其主节点的自由度所取代。这在计算上通过修改**局部到全局的自由度映射**（local-to-global DOF mapping）来实现：当组装单元矩阵时，任何遇到从节点索引的地方，都用其对应的主节点索引来代替。

这个过程等价于将从[节点基](@entry_id:752522)函数的贡献（在[刚度矩阵](@entry_id:178659)的行和列中）累加到其主[节点基](@entry_id:752522)函数的对应位置上，从而正确地在离散[函数空间](@entry_id:143478)中实施了周期性约束。这种通过修改自由度映射来施加多点约束（multi-point constraints）的方法非常通用，也可以推广到更复杂的**布洛赫-周期性**（Bloch-periodic）条件，此时从自由度等于主自由度乘以一个复相位因子 。