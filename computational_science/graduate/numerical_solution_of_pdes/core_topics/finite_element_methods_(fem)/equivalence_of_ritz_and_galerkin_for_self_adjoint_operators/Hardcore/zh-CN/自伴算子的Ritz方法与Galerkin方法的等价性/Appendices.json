{
    "hands_on_practices": [
        {
            "introduction": "在本练习中，我们将通过一个具体的计算来直接验证Ritz方法和Galerkin方法在自伴问题上的等价性。我们将使用标准的一维泊松方程，并采用分片线性有限元基函数进行离散化。通过并列推导基于能量泛函最小化的Ritz方程和基于残量正交性的Galerkin方程，你将亲眼见证两种方法如何殊途同归，最终得到完全相同的线性方程组。这个基础练习旨在将抽象的理论等价性转化为具体、可操作的计算步骤。",
            "id": "3386619",
            "problem": "考虑在区间 $[0,1]$ 上的齐次狄利克雷边界条件的一维泊松边值问题：求解 $u$ 使得在 $(0,1)$ 内 $-u''=1$ 且 $u(0)=0$, $u(1)=0$。其变分形式为：求解 $u \\in H_{0}^{1}(0,1)$，使得对于所有 $v \\in H_{0}^{1}(0,1)$，都有 $\\int_{0}^{1} u'(x)v'(x)\\,dx=\\int_{0}^{1} v(x)\\,dx$。该问题由一个自伴算子控制，并且相关的双线性形式是对称且强制的。\n\n使用有限元法 (FEM)，在节点为 $x=0$、$x=\\frac{1}{3}$、$x=\\frac{2}{3}$ 和 $x=1$ 的均匀网格上采用分片线性基函数。施加齐次狄利克雷边界条件以消除在 $x=0$ 和 $x=1$ 处的边界自由度，并取试验空间为 $V_{h}=\\mathrm{span}\\{\\phi_{1},\\phi_{2}\\}$，其中 $\\phi_{1}$ 是满足 $\\phi_{1}\\!\\left(\\frac{1}{3}\\right)=1$ 且支集在 $[0,\\frac{2}{3}]$ 上的帽函数，$\\phi_{2}$ 是满足 $\\phi_{2}\\!\\left(\\frac{2}{3}\\right)=1$ 且支集在 $[\\frac{1}{3},1]$ 上的帽函数。\n\n从自伴算子的 Galerkin 方法（残量在试验空间中的正交性）和 Ritz 方法（能量泛函的最小化）的基本定义出发，执行以下操作：\n\n- 推导 $2\\times 2$ 刚度矩阵 $K$，其元素为 $K_{ij}=\\int_{0}^{1} \\phi_{i}'(x)\\phi_{j}'(x)\\,dx$（其中 $i,j\\in\\{1,2\\}$），并证明 $K$ 是对称正定 (SPD; symmetric positive definite) 的。\n- 推导载荷向量 $f$，其分量为 $f_{i}=\\int_{0}^{1} \\phi_{i}(x)\\,dx$（其中 $i\\in\\{1,2\\}$）。\n- 使用 Galerkin 方法，为 $u_{h}=x_{1}\\phi_{1}+x_{2}\\phi_{2}$ 的系数向量 $x=(x_{1},x_{2})$ 组装并求解线性系统 $Kx=f$。\n- 独立地，构造 Ritz 能量泛函 $J(u_{h})=\\frac{1}{2}\\int_{0}^{1} |u_{h}'(x)|^{2}\\,dx - \\int_{0}^{1} u_{h}(x)\\,dx$，在 $V_{h}$ 上关于 $(x_{1},x_{2})$ 将其最小化，并求解得到的最优性条件以获得一个系数向量。解释为什么由于自伴性，两种方法必须产生相同的系数向量。\n\n将你的最终答案以系数向量 $x=(x_{1},x_{2})$ 的精确有理数形式表示。无需四舍五入，也无需单位。",
            "solution": "用户希望我使用有限元法解决一个一维泊松问题。\n\n我的计划如下：\n1.  **验证问题陈述。**\n    *   **提取已知条件**：我将列出问题中提供的所有方程、边界条件、定义和空间。\n        *   偏微分方程 (PDE)：在 $(0,1)$ 中 $-u''=1$。\n        *   边界条件 (BCs)：$u(0)=0$, $u(1)=0$。\n        *   变分形式：求解 $u \\in H_{0}^{1}(0,1)$，使得对于所有 $v \\in H_{0}^{1}(0,1)$，都有 $\\int_{0}^{1} u'(x)v'(x)\\,dx=\\int_{0}^{1} v(x)\\,dx$。\n        *   有限元法 (FEM) 设置：\n            *   网格节点：$x=0, \\frac{1}{3}, \\frac{2}{3}, 1$。这意味着网格尺寸 $h = \\frac{1}{3}$。\n            *   基函数：分片线性（帽函数）。\n            *   试验空间：$V_{h}=\\mathrm{span}\\{\\phi_{1},\\phi_{2}\\}$。\n            *   $\\phi_{1}$：帽函数，满足 $\\phi_{1}(\\frac{1}{3})=1$，支集为 $[0, \\frac{2}{3}]$。\n            *   $\\phi_{2}$：帽函数，满足 $\\phi_{2}(\\frac{2}{3})=1$，支集为 $[\\frac{1}{3}, 1]$。\n        *   任务：\n            1. 推导刚度矩阵 $K_{ij}=\\int_{0}^{1} \\phi_{i}'(x)\\phi_{j}'(x)\\,dx$。证明其为对称正定矩阵 (SPD)。\n            2. 推导载荷向量 $f_{i}=\\int_{0}^{1} \\phi_{i}(x)\\,dx$。\n            3. 求解 $Kx=f$ (Galerkin 方法)。\n            4. 最小化能量泛函 $J(u_{h})=\\frac{1}{2}\\int_{0}^{1} |u_{h}'(x)|^{2}\\,dx - \\int_{0}^{1} u_{h}(x)\\,dx$ (Ritz 方法)。\n            5. 证明两种方法得到相同结果并解释原因。\n            6. 提供系数向量 $x=(x_{1}, x_{2})$ 作为最终答案。\n\n    *   **验证**：\n        *   **科学依据**：该问题是有限元法在泊松方程上的一个标准应用。这是数值分析和应用数学中的一个核心课题。它在科学上是合理的。\n        *   **适定性**：该问题是适定的。带狄利克雷边界条件的泊松方程有唯一解。有限元法表述也是标准的，并且由于双线性形式在索博列夫空间 $H_0^1(0,1)$ 上是强制和连续的，因此会得到唯一解。该问题要求在特定网格上进行具体计算。\n        *   **客观性**：语言精确且数学化。没有主观陈述。\n        *   **完整性**：提供了所有必要信息。网格、基函数以及需要求解的方程都已明确定义。\n        *   **一致性**：未发现矛盾。\n        *   **现实性**：该问题是一个教科书式的例子，因此在学术背景下是现实的。\n        *   **结构**：问题结构良好，能导出一个唯一的、稳定的、有意义的解。\n        *   **非平凡性**：该问题并非微不足道。它需要几个计算步骤（基函数及其导数的积分）和求解一个线性系统。它正确地说明了对于此类问题，Galerkin 方法和 Ritz 方法的等价性。\n        *   **可验证性**：所有步骤在数学上都是可验证的。\n\n    *   **结论**：问题有效。我将继续进行求解。\n\n2.  **求解问题。**\n\n    *   **定义基函数**：\n        *   节点为 $x_0=0$, $x_1=\\frac{1}{3}$, $x_2=\\frac{2}{3}$, $x_3=1$。网格尺寸为 $h = \\frac{1}{3}$。\n        *   $\\phi_1(x)$ 是与节点 $x_1=\\frac{1}{3}$ 相关联的帽函数。它在 $(0, \\frac{2}{3})$ 上非零。\n            *   对于 $x \\in [0, \\frac{1}{3}]$，$\\phi_1(x) = \\frac{x - 0}{1/3 - 0} = 3x$。\n            *   对于 $x \\in [\\frac{1}{3}, \\frac{2}{3}]$，$\\phi_1(x) = \\frac{2/3 - x}{2/3 - 1/3} = \\frac{2/3 - x}{1/3} = 2 - 3x$。\n            *   在其他情况下，$\\phi_1(x) = 0$。\n        *   $\\phi_2(x)$ 是与节点 $x_2=\\frac{2}{3}$ 相关联的帽函数。它在 $(\\frac{1}{3}, 1)$ 上非零。\n            *   对于 $x \\in [\\frac{1}{3}, \\frac{2}{3}]$，$\\phi_2(x) = \\frac{x - 1/3}{2/3 - 1/3} = \\frac{x - 1/3}{1/3} = 3x - 1$。\n            *   对于 $x \\in [\\frac{2}{3}, 1]$，$\\phi_2(x) = \\frac{1 - x}{1 - 2/3} = \\frac{1 - x}{1/3} = 3 - 3x$。\n            *   在其他情况下，$\\phi_2(x) = 0$。\n\n    *   **基函数的导数**：\n        *   $\\phi_1'(x)$：\n            *   对于 $x \\in (0, \\frac{1}{3})$，$\\phi_1'(x) = 3$。\n            *   对于 $x \\in (\\frac{1}{3}, \\frac{2}{3})$，$\\phi_1'(x) = -3$。\n            *   在其他情况下，$\\phi_1'(x) = 0$。\n        *   $\\phi_2'(x)$：\n            *   对于 $x \\in (\\frac{1}{3}, \\frac{2}{3})$，$\\phi_2'(x) = 3$。\n            *   对于 $x \\in (\\frac{2}{3}, 1)$，$\\phi_2'(x) = -3$。\n            *   在其他情况下，$\\phi_2'(x) = 0$。\n\n    *   **计算刚度矩阵 K**：\n        *   $K_{ij} = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\,dx$。\n        *   $K_{11} = \\int_{0}^{1} (\\phi_1'(x))^2 \\,dx = \\int_{0}^{1/3} (3)^2 \\,dx + \\int_{1/3}^{2/3} (-3)^2 \\,dx$。\n            *   $K_{11} = 9 \\times \\frac{1}{3} + 9 \\times \\frac{1}{3} = 3 + 3 = 6$。\n        *   $K_{22} = \\int_{0}^{1} (\\phi_2'(x))^2 \\,dx = \\int_{1/3}^{2/3} (3)^2 \\,dx + \\int_{2/3}^{1} (-3)^2 \\,dx$。\n            *   $K_{22} = 9 \\times \\frac{1}{3} + 9 \\times \\frac{1}{3} = 3 + 3 = 6$。\n        *   $K_{12} = \\int_{0}^{1} \\phi_1'(x) \\phi_2'(x) \\,dx$。该乘积仅在 $(\\frac{1}{3}, \\frac{2}{3})$ 上非零。\n            *   在 $(\\frac{1}{3}, \\frac{2}{3})$ 上，$\\phi_1'(x) = -3$ 且 $\\phi_2'(x) = 3$。\n            *   $K_{12} = \\int_{1/3}^{2/3} (-3)(3) \\,dx = \\int_{1/3}^{2/3} -9 \\,dx = -9 \\times (\\frac{2}{3} - \\frac{1}{3}) = -9 \\times \\frac{1}{3} = -3$。\n        *   $K_{21} = \\int_{0}^{1} \\phi_2'(x) \\phi_1'(x) \\,dx = K_{12} = -3$。\n        *   所以，$$K = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}$$。\n\n    *   **证明 K 是对称正定矩阵 (SPD)**：\n        *   **对称性**：$K_{12} = -3 = K_{21}$，所以 $K$ 是对称的。\n        *   **正定性**：我们检查顺序主子式。\n            *   第一个主子式是 $K_{11} = 6 > 0$。\n            *   第二个主子式是 $\\det(K) = (6)(6) - (-3)(-3) = 36 - 9 = 27 > 0$。\n            *   由于所有顺序主子式都为正，所以 $K$ 是正定的。\n\n    *   **计算载荷向量 f**：\n        *   $f_i = \\int_{0}^{1} \\phi_i(x) \\,dx$。几何上，这是三角形帽函数下方的面积。\n        *   $\\phi_1(x)$ 的支集是 $[0, \\frac{2}{3}]$，所以其底边长为 $\\frac{2}{3}$。高度为 1。\n            *   $f_1 = \\text{面积}(\\phi_1) = \\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} \\times \\frac{2}{3} \\times 1 = \\frac{1}{3}$。\n        *   $\\phi_2(x)$ 的支集是 $[\\frac{1}{3}, 1]$，所以其底边长为 $1 - \\frac{1}{3} = \\frac{2}{3}$。高度为 1。\n            *   $f_2 = \\text{面积}(\\phi_2) = \\frac{1}{2} \\times \\frac{2}{3} \\times 1 = \\frac{1}{3}$。\n        *   因此，载荷向量为 $$f = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix}$$。\n\n    *   **Galerkin 方法：求解 Kx = f**：\n        *   线性系统为 $\\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix}$。\n        *   这对应于方程组：\n            $6x_1 - 3x_2 = \\frac{1}{3}$\n            $-3x_1 + 6x_2 = \\frac{1}{3}$\n        *   由于问题域和右侧项的对称性，我们可以预料到 $x_1=x_2$。将此代入第一个方程，得到：\n            $6x_1 - 3x_1 = 3x_1 = \\frac{1}{3} \\implies x_1 = \\frac{1}{9}$。\n        *   因此，$x_1 = x_2 = \\frac{1}{9}$。\n        *   我们可以在第二个方程中验证这一点：$-3(\\frac{1}{9}) + 6(\\frac{1}{9}) = -\\frac{1}{3} + \\frac{2}{3} = \\frac{1}{3}$，这是正确的。\n        *   从 Galerkin 方法得到的系数向量是 $$x = \\begin{pmatrix} \\frac{1}{9} \\\\ \\frac{1}{9} \\end{pmatrix}$$。\n\n    *   **Ritz 方法：最小化能量泛函**：\n        *   Ritz 方法旨在找到 $u_h \\in V_h$ 以最小化能量泛函 $J(v) = \\frac{1}{2} a(v,v) - F(v)$，其中 $a(u,v)=\\int_0^1 u'v'dx$ 且 $F(v)=\\int_0^1 v dx$。\n        *   设 $u_h(x) = x_1\\phi_1(x) + x_2\\phi_2(x)$。\n        *   我们可以用系数 $x_1$ 和 $x_2$ 来表示泛函 $J$：\n            $J(x_1, x_2) = \\frac{1}{2} a(x_1\\phi_1 + x_2\\phi_2, x_1\\phi_1 + x_2\\phi_2) - F(x_1\\phi_1 + x_2\\phi_2)$。\n        *   利用 $a(\\cdot,\\cdot)$ 的双线性和 $F(\\cdot)$ 的线性：\n            $$J(x_1, x_2) = \\frac{1}{2} \\left( x_1^2 a(\\phi_1,\\phi_1) + 2x_1x_2 a(\\phi_1,\\phi_2) + x_2^2 a(\\phi_2,\\phi_2) \\right) - \\left( x_1 F(\\phi_1) + x_2 F(\\phi_2) \\right)$$\n        *   认识到 $K_{ij} = a(\\phi_i, \\phi_j)$ 且 $f_i = F(\\phi_i)$，我们可以将其写成矩阵形式：\n            $J(x) = \\frac{1}{2} x^T K x - x^T f$。\n        *   代入计算出的 $K$ 和 $f$：\n            $$J(x_1, x_2) = \\frac{1}{2} \\begin{pmatrix} x_1  x_2 \\end{pmatrix} \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} - \\begin{pmatrix} x_1  x_2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3} \\\\ \\frac{1}{3} \\end{pmatrix}$$\n            $$J(x_1, x_2) = \\frac{1}{2}(6x_1^2 - 6x_1x_2 + 6x_2^2) - \\frac{1}{3}x_1 - \\frac{1}{3}x_2$$\n        *   为求最小值，我们将关于 $x_1$ 和 $x_2$ 的偏导数设为零：\n            $$\\frac{\\partial J}{\\partial x_1} = \\frac{1}{2}(12x_1 - 6x_2) - \\frac{1}{3} = 6x_1 - 3x_2 - \\frac{1}{3} = 0$$\n            $$\\frac{\\partial J}{\\partial x_2} = \\frac{1}{2}(-6x_1 + 12x_2) - \\frac{1}{3} = -3x_1 + 6x_2 - \\frac{1}{3} = 0$$\n        *   得到的方程组为：\n            $6x_1 - 3x_2 = \\frac{1}{3}$\n            $-3x_1 + 6x_2 = \\frac{1}{3}$\n        *   这与从 Galerkin 方法得到的线性系统 $Kx=f$ 完全相同。因此，其解也必定是 $x_1 = \\frac{1}{9}$ 和 $x_2 = \\frac{1}{9}$。\n\n    *   **Galerkin 和 Ritz 方法的等价性**：\n        对于该问题，这两种方法的等价性是控制算子和相关双线性形式性质的直接结果。带有齐次狄利克雷条件的微分算子 $L=-d^2/dx^2$ 在 $L^2(0,1)$ 内积下是自伴的。这种自伴性意味着相关的双线性形式 $a(u,v) = \\int_0^1 u'(x)v'(x) \\,dx$ 是对称的，即 $a(u,v) = a(v,u)$。\n\n        Galerkin 方法要求残量与试验空间 $V_h$ 正交，对于此问题，这转化为求解 $u_h \\in V_h$ 使得对于所有 $v_h \\in V_h$ 都有 $a(u_h, v_h) = F(v_h)$。通过选择基函数 $\\phi_i$ 作为检验函数 $v_h$，可以得到线性系统 $\\sum_j x_j a(\\phi_j, \\phi_i) = F(\\phi_i)$，即 $Kx=f$。\n\n        Ritz 方法旨在空间 $V_h$ 上最小化二次能量泛函 $J(v) = \\frac{1}{2}a(v,v) - F(v)$。将 $v \\in V_h$ 表示为 $v = \\sum x_i \\phi_i$，该泛函变为系数 $x$ 的二次函数，$J(x) = \\frac{1}{2}x^T K x - x^T f$。这个凸泛函取得最小值的必要条件是其关于 $x$ 的梯度为零：$\\nabla J(x) = 0$。该梯度由 $\\nabla J(x) = Kx - f$ 给出。因此，最小化问题等价于求解线性系统 $Kx=f$。\n\n        总之，因为双线性形式是对称的（这是算子自伴的结果），Ritz 能量最小化原理的最优性条件与 Galerkin 方法的正交性条件是相同的。两种方法都归结为求解同一个对称线性系统 $Kx=f$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{9}  \\frac{1}{9} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "确认了Ritz与Galerkin方法在代数上的等价性后，我们进一步探究其背后更深刻的几何意义。对于自伴算子，此等价性保证了求出的数值解是在能量范数意义下，从所选有限维子空间中能够得到的“最佳”逼近。在本练习中，你将计算一个简单问题的精确解与数值解，并显式地计算出两者在能量范数下的误差。这将帮助你直观地理解Galerkin正交性如何确保误差最小化，从而巩固对这一核心性质的认识。",
            "id": "3386628",
            "problem": "考虑区间 $[0,1]$ 上的如下一维、二阶、线性偏微分方程 (PDE) 边值问题：\n$$\n- u''(x) = f(x), \\quad x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0,\n$$\n其中 $f(x) = 2$。令 $V = H_0^1(0,1)$ 为边界上迹为零的常规 Sobolev 空间，并令双线性形式为\n$$\na(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,dx,\n$$\n线性泛函为\n$$\n\\ell(v) = \\int_{0}^{1} f(x)\\,v(x)\\,dx.\n$$\n与此问题相关的自伴算子为 $A u = -u''$，由 $a(\\cdot,\\cdot)$ 导出的能量范数定义为\n$$\n\\|v\\|_{E} = \\sqrt{a(v,v)} = \\left( \\int_{0}^{1} \\left(v'(x)\\right)^{2}\\,dx \\right)^{1/2}.\n$$\n\n设有限维试探子空间为 $V_h = \\operatorname{span}\\{\\varphi\\}$，其中 $\\varphi(x) = \\sin(\\pi x)$ 满足本质边界条件。用两种独立的方法构造离散解 $u_h \\in V_h$：\n\n1. Galerkin 方法，定义为对所有 $v_h \\in V_h$ 都有 $a(u_h, v_h) = \\ell(v_h)$。\n2. Ritz 方法，定义为能量泛函在 $V_h$ 上的极小化子\n$$\nJ(v) = \\frac{1}{2} a(v,v) - \\ell(v).\n$$\n\n从对称正定双线性形式的基本变分原理和 $A$ 的自伴性出发，推导 $u_h$ 的两种构造方法，并验证它们产生相同的离散解。然后，计算精确解 $u \\in V$，并用它来确定能量范数误差 $\\|u - u_h\\|_{E}$。最后，仅利用自伴性和由 $a(\\cdot,\\cdot)$ 导出的 Hilbert 空间中的正交性等性质，证明两种构造方法在能量范数下产生相同的误差界。\n\n将最终答案表示为闭式解析表达式。无需四舍五入，不涉及物理单位。",
            "solution": "首先验证问题的科学合理性、适定性和客观性。\n\n### 步骤 1：提取已知条件\n- **微分方程：** $- u''(x) = f(x)$，对于 $x \\in (0,1)$。\n- **边界条件：** $u(0) = 0$, $u(1) = 0$。\n- **源函数：** $f(x) = 2$。\n- **函数空间：** $V = H_0^1(0,1)$。\n- **双线性形式：** $a(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,dx$。\n- **线性泛函：** $\\ell(v) = \\int_{0}^{1} f(x)\\,v(x)\\,dx$。\n- **算子：** $A u = -u''$，指定为自伴算子。\n- **能量范数：** $\\|v\\|_{E} = \\sqrt{a(v,v)}$。\n- **试探子空间：** $V_h = \\operatorname{span}\\{\\varphi\\}$，其中 $\\varphi(x) = \\sin(\\pi x)$。\n- **Galerkin 方法：** 求 $u_h \\in V_h$，使得对所有 $v_h \\in V_h$ 都有 $a(u_h, v_h) = \\ell(v_h)$。\n- **Ritz 方法：** 求 $u_h \\in V_h$，使得 $J(v) = \\frac{1}{2} a(v,v) - \\ell(v)$ 最小。\n- **目标：** 用两种方法推导 $u_h$，验证它们是相同的，求出精确解 $u$，并计算误差的能量范数 $\\|u - u_h\\|_{E}$。根据自伴算子的性质证明方法的等价性。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是偏微分方程数值分析中的一个标准练习，具体涉及有限元方法。\n- **科学性：** 问题使用了成熟的数学概念：二阶椭圆型偏微分方程、Sobolev 空间 ($H_0^1$) 和变分形式 (Ritz-Galerkin)。带有齐次 Dirichlet 边界条件的算子 $A u = -u''$ 是一个自伴正定算子的典型例子，对于这类算子，Ritz 方法和 Galerkin 方法是等价的。\n- **适定性：** 问题是适定的。Lax-Milgram 定理保证了弱解 $u \\in V$ 的存在性和唯一性。有限维问题也是适定的，因为问题的矩阵形式将是对称正定的，因此是可逆的。\n- **客观性：** 问题使用精确、标准的数学术语陈述，没有歧义或主观因素。\n- **完备性：** 提供了所有必要的数据和定义。基函数 $\\varphi(x) = \\sin(\\pi x)$ 正确地满足边界条件 $\\varphi(0)=0$ 和 $\\varphi(1)=0$，因此它是 $H_0^1(0,1)$ 中元素的一个有效选择。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n解答过程分几个步骤：分别使用 Galerkin 和 Ritz 方法求解离散解 $u_h$，验证它们的等价性，求出精确解 $u$，最后计算能量范数下的误差 $\\|u - u_h\\|_{E}$。\n\n**1. Galerkin 方法的构造**\n\n设近似解为 $u_h(x) = c\\,\\varphi(x) = c \\sin(\\pi x)$，其中 $c \\in \\mathbb{R}$ 为未知系数。由于 $V_h$ 是由 $\\varphi$ 张成的一维空间，Galerkin 条件 $a(u_h, v_h) = \\ell(v_h)$（对所有 $v_h \\in V_h$）简化为对基函数 $\\varphi$ 进行检验。因此，我们必须在以下方程中求解 $c$：\n$$\na(c\\,\\varphi, \\varphi) = \\ell(\\varphi)\n$$\n根据双线性形式参数的线性性质，上式变为：\n$$\nc\\,a(\\varphi, \\varphi) = \\ell(\\varphi)\n$$\n我们计算 $a(\\varphi, \\varphi)$ 和 $\\ell(\\varphi)$ 这两项。\n基函数的导数为 $\\varphi'(x) = \\pi\\cos(\\pi x)$。\n$$\na(\\varphi, \\varphi) = \\int_{0}^{1} (\\varphi'(x))^2 dx = \\int_{0}^{1} (\\pi \\cos(\\pi x))^2 dx = \\pi^2 \\int_{0}^{1} \\cos^2(\\pi x) dx\n$$\n使用恒等式 $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$，积分为：\n$$\n\\int_{0}^{1} \\cos^2(\\pi x) dx = \\frac{1}{2} \\int_{0}^{1} (1 + \\cos(2\\pi x)) dx = \\frac{1}{2} \\left[ x + \\frac{\\sin(2\\pi x)}{2\\pi} \\right]_{0}^{1} = \\frac{1}{2}(1 - 0) = \\frac{1}{2}\n$$\n因此，$a(\\varphi, \\varphi) = \\pi^2 \\cdot \\frac{1}{2} = \\frac{\\pi^2}{2}$。\n\n接下来，我们计算当 $f(x)=2$ 时的线性泛函 $\\ell(\\varphi)$：\n$$\n\\ell(\\varphi) = \\int_{0}^{1} f(x) \\varphi(x) dx = \\int_{0}^{1} 2 \\sin(\\pi x) dx = 2 \\left[ -\\frac{\\cos(\\pi x)}{\\pi} \\right]_{0}^{1} = -\\frac{2}{\\pi}(\\cos(\\pi) - \\cos(0)) = -\\frac{2}{\\pi}(-1 - 1) = \\frac{4}{\\pi}\n$$\n将这些结果代入 Galerkin 方程 $c\\,a(\\varphi, \\varphi) = \\ell(\\varphi)$：\n$$\nc \\left( \\frac{\\pi^2}{2} \\right) = \\frac{4}{\\pi} \\implies c = \\frac{8}{\\pi^3}\n$$\n因此，Galerkin 解为 $u_h(x) = \\frac{8}{\\pi^3} \\sin(\\pi x)$。\n\n**2. Ritz 方法的构造**\n\nRitz 方法旨在找到 $V_h$ 中的函数，使能量泛函 $J(v) = \\frac{1}{2}a(v,v) - \\ell(v)$ 最小。对于任何 $v_h \\in V_h$，我们可以写作 $v_h(x) = c\\,\\varphi(x)$。将其代入泛函，得到一个关于系数 $c$ 的函数：\n$$\nJ(c) = J(c\\,\\varphi) = \\frac{1}{2} a(c\\,\\varphi, c\\,\\varphi) - \\ell(c\\,\\varphi) = \\frac{c^2}{2} a(\\varphi, \\varphi) - c\\,\\ell(\\varphi)\n$$\n我们已经计算出 $a(\\varphi, \\varphi) = \\frac{\\pi^2}{2}$ 和 $\\ell(\\varphi) = \\frac{4}{\\pi}$。代入这些值：\n$$\nJ(c) = \\frac{c^2}{2} \\left(\\frac{\\pi^2}{2}\\right) - c \\left(\\frac{4}{\\pi}\\right) = \\frac{\\pi^2}{4} c^2 - \\frac{4}{\\pi} c\n$$\n这是一个关于 $c$ 的二次函数，其最小值可以通过将其对 $c$ 的导数设为零来求得：\n$$\n\\frac{dJ}{dc} = \\frac{d}{dc} \\left( \\frac{\\pi^2}{4} c^2 - \\frac{4}{\\pi} c \\right) = \\frac{\\pi^2}{2} c - \\frac{4}{\\pi} = 0\n$$\n解出 $c$ 得：\n$$\n\\frac{\\pi^2}{2} c = \\frac{4}{\\pi} \\implies c = \\frac{8}{\\pi^3}\n$$\n这得到了与 Galerkin 方法相同的系数。Ritz 解也是 $u_h(x) = \\frac{8}{\\pi^3} \\sin(\\pi x)$。这验证了对于此问题，两种方法产生相同的离散解。\n\n**3. 精确解**\n\n我们通过对微分方程 $-u''(x) = 2$ 进行两次积分来求精确解 $u(x)$。\n第一次积分：$-u'(x) = 2x + C_1$。\n第二次积分：$u(x) = -x^2 - C_1 x + C_2$。\n我们使用边界条件来确定常数 $C_1$ 和 $C_2$。\n$u(0) = 0 \\implies -0^2 - C_1(0) + C_2 = 0 \\implies C_2 = 0$。\n$u(1) = 0 \\implies -1^2 - C_1(1) + 0 = 0 \\implies -1 - C_1 = 0 \\implies C_1 = -1$。\n将常数代回，得到精确解为 $u(x) = -x^2 - (-1)x = x - x^2 = x(1-x)$。\n\n**4. 能量范数误差**\n\n我们需要计算 $\\|u - u_h\\|_E = \\sqrt{a(u - u_h, u - u_h)}$。对于对称双线性形式，从 Galerkin 公式导出的一个关键性质是误差与子空间的正交性，即对所有 $v_h \\in V_h$ 都有 $a(u - u_h, v_h) = 0$。这蕴含了类似毕达哥拉斯定理的关系：\n$$\n\\|u\\|_E^2 = \\|u_h\\|_E^2 + \\|u - u_h\\|_E^2\n$$\n因此，误差范数的平方由下式给出：\n$$\n\\|u - u_h\\|_E^2 = \\|u\\|_E^2 - \\|u_h\\|_E^2\n$$\n我们分别计算 $u$ 和 $u_h$ 的能量范数。\n对于精确解 $u(x) = x - x^2$，其导数为 $u'(x) = 1 - 2x$。\n$$\n\\|u\\|_E^2 = a(u,u) = \\int_{0}^{1} (u'(x))^2 dx = \\int_{0}^{1} (1-2x)^2 dx = \\int_{0}^{1} (1 - 4x + 4x^2) dx = \\left[ x - 2x^2 + \\frac{4}{3}x^3 \\right]_0^1 = 1 - 2 + \\frac{4}{3} = \\frac{1}{3}\n$$\n对于近似解 $u_h(x) = \\frac{8}{\\pi^3} \\sin(\\pi x)$，其导数为 $u'_h(x) = \\frac{8}{\\pi^2} \\cos(\\pi x)$。\n$$\n\\|u_h\\|_E^2 = a(u_h, u_h) = \\int_{0}^{1} (u'_h(x))^2 dx = \\int_{0}^{1} \\left(\\frac{8}{\\pi^2} \\cos(\\pi x)\\right)^2 dx = \\frac{64}{\\pi^4} \\int_{0}^{1} \\cos^2(\\pi x) dx\n$$\n如前所计算，$\\int_{0}^{1} \\cos^2(\\pi x) dx = \\frac{1}{2}$。\n$$\n\\|u_h\\|_E^2 = \\frac{64}{\\pi^4} \\left(\\frac{1}{2}\\right) = \\frac{32}{\\pi^4}\n$$\n现在我们可以计算误差范数的平方：\n$$\n\\|u - u_h\\|_E^2 = \\frac{1}{3} - \\frac{32}{\\pi^4}\n$$\n误差的能量范数是该值的平方根：\n$$\n\\|u - u_h\\|_E = \\sqrt{\\frac{1}{3} - \\frac{32}{\\pi^4}}\n$$\n\n**5. 等价性与误差界的证明**\n\n问题陈述指明算子 $A u = -u''$ 是自伴的。此性质确保了通过分部积分导出的相应双线性形式 $a(u,v)=\\int_0^1 u'v' dx$ 是对称的：$a(u,v) = a(v,u)$。对于这类对称正定问题，Galerkin 和 Ritz 方法是等价的。\n\nGalerkin 方法找到一个唯一的 $u_h \\in V_h$，满足 Galerkin 正交条件：对所有 $v_h \\in V_h$ 都有 $a(u-u_h, v_h) = 0$。在以内积 $a(\\cdot,\\cdot)$ 定义的 Hilbert 空间 $V$ 中，这意味着 $u_h$ 是精确解 $u$ 在子空间 $V_h$ 上的正交投影。正交投影的一个基本性质是它们代表了来自子空间的最佳逼近。即 $\\|u-u_h\\|_E = \\min_{v_h \\in V_h} \\|u-v_h\\|_E$。\n\nRitz 方法找到一个唯一的 $u_h \\in V_h$，使泛函 $J(v_h) = \\frac{1}{2}a(v_h, v_h) - \\ell(v_h)$ 最小化。我们可以证明这等价于寻找最佳逼近。考虑误差的平方 $\\|u - v_h\\|_E^2$：\n$$\n\\|u - v_h\\|_E^2 = a(u-v_h, u-v_h) = a(u,u) - 2a(u,v_h) + a(v_h,v_h)\n$$\n由于 $u$ 是精确解，它满足弱形式 $a(u,v) = \\ell(v)$（对所有 $v \\in V$）。因为 $V_h \\subset V$，该式对 $v_h$ 也成立：$a(u,v_h) = \\ell(v_h)$。将此代入误差表达式：\n$$\n\\|u - v_h\\|_E^2 = a(u,u) - 2\\ell(v_h) + a(v_h,v_h)\n$$\n为了在 $v_h \\in V_h$ 上最小化 $\\|u - v_h\\|_E^2$，我们必须最小化依赖于 $v_h$ 的项。由于 $a(u,u)$ 对于 $v_h$ 是一个常数，这等价于最小化 $a(v_h,v_h) - 2\\ell(v_h)$，而这又等价于最小化 $\\frac{1}{2}\\left(a(v_h,v_h) - 2\\ell(v_h)\\right) = J(v_h)$。\n\n因此，两种方法都是为了寻找同一个唯一的元素 $u_h \\in V_h$ 的不同表述：即 $u$ 在关于能量内积 $a(\\cdot, \\cdot)$ 的子空间 $V_h$ 上的正交投影。由于它们产生相同的解 $u_h$，因此得到的误差 $u-u_h$ 和任何标准误差估计，例如 Céa 引理（对于对称正定问题 $\\|u-u_h\\|_E = \\inf_{v_h \\in V_h} \\|u-v_h\\|_E$），都是相同的。这种等价性是双线性形式对称性的直接结果，而对称性又源于其对应的微分算子的自伴性。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{1}{3} - \\frac{32}{\\pi^4}}}\n$$"
        },
        {
            "introduction": "Ritz方法与Galerkin方法之间的等价性原理，其适用范围并不仅限于源问题。在求解自伴算子的特征值与特征函数时，这一原理同样扮演着核心角色。本练习将引导你将该思想应用于拉普拉斯算子的特征值问题。你将发现，无论是基于Rayleigh商最小化的Rayleigh-Ritz方法，还是基于弱形式投影的Galerkin方法，最终都会导向同一个广义代数特征值问题。这个实践旨在展示该等价性原理的普适性与强大功能。",
            "id": "3386616",
            "problem": "考虑在区间 $[0,1]$ 上的齐次狄利克雷边界条件下的一维拉普拉斯特征值问题：求所有特征对 $(\\lambda,u)$，使得在 $(0,1)$ 内有 $-u''=\\lambda u$，且 $u(0)=u(1)=0$。令 $H_{0}^{1}(0,1)$ 表示在边界上为零的函数的标准索伯列夫空间，并在 $H_{0}^{1}(0,1)$ 上定义对称双线性形式 $a(u,v)=\\int_{0}^{1} u'(x)v'(x)\\,dx$ 和 $m(u,v)=\\int_{0}^{1} u(x)v(x)\\,dx$。令 $V_{h}$ 为 $H_{0}^{1}(0,1)$ 的二维有限元子空间，由对应于节点 $\\{0,\\tfrac{1}{3},\\tfrac{2}{3},1\\}$ 的均匀网格上的连续分段线性函数组成，并令 $\\{\\phi_{1},\\phi_{2}\\}$ 为与内部节点 $\\tfrac{1}{3}$ 和 $\\tfrac{2}{3}$ 相关联的标准节点（帽函数）基。\n\n分别使用瑞利-里兹方法（在有限维子空间上最小化瑞利商）和伽辽金方法（将弱特征值问题投影到相同的 $V_{h}$ 上），推导出在 $V_{h}$ 上建立的离散代数特征值问题，并计算前两个离散特征值。显式计算刚度矩阵 $K$（其中 $K_{ij}=a(\\phi_{i},\\phi_{j})$）和质量矩阵 $M$（其中 $M_{ij}=m(\\phi_{i},\\phi_{j})$），求解得到的广义特征值问题，并确认从瑞利-里兹和伽辽金方法得到的特征值相等，因为其底层算子是自伴的。\n\n以精确形式给出你的最终答案，即两个特征值。不要四舍五入。",
            "solution": "用户提供了一个偏微分方程数值分析领域的问题，具体涉及特征值问题的有限元方法。\n\n### 第一步：问题验证\n\n首先根据所需标准对问题陈述进行验证。\n\n**1.1. 提取的已知条件：**\n-   **控制方程：** 在区间 $(0,1)$ 上的一维拉普拉斯特征值问题 $-u'' = \\lambda u$。\n-   **边界条件：** 齐次狄利克雷条件，$u(0)=0$ 和 $u(1)=0$。\n-   **函数空间：** $H_{0}^{1}(0,1)$，即一阶导数平方可积且在边界 $x=0$ 和 $x=1$ 处为零的函数的索伯列夫空间。\n-   **双线性形式：**\n    -   $a(u,v) = \\int_{0}^{1} u'(x)v'(x)\\,dx$\n    -   $m(u,v) = \\int_{0}^{1} u(x)v(x)\\,dx$\n-   **有限元子空间：** $V_{h}$，一个由连续分段线性函数组成的 $H_{0}^{1}(0,1)$ 的二维子空间。\n-   **网格：** 具有节点 $\\{0, \\frac{1}{3}, \\frac{2}{3}, 1\\}$ 的均匀网格。网格尺寸为 $h = \\frac{1}{3}$。\n-   **基：** 与内部节点 $x_1 = \\frac{1}{3}$ 和 $x_2 = \\frac{2}{3}$ 相关的标准节点基（帽函数）$\\{\\phi_{1}, \\phi_{2}\\}$。\n-   **矩阵：**\n    -   刚度矩阵 $K$，其元素为 $K_{ij} = a(\\phi_{i}, \\phi_{j})$。\n    -   质量矩阵 $M$，其元素为 $M_{ij} = m(\\phi_{i}, \\phi_{j})$。\n-   **任务：**\n    1.  从瑞利-里兹方法推导出离散代数特征值问题。\n    2.  从伽辽金方法推导出离散代数特征值问题。\n    3.  计算矩阵 $K$ 和 $M$。\n    4.  求解得到的广义特征值问题，并找到两个离散特征值。\n    5.  确认从两种方法获得的特征值是等价的。\n\n**1.2. 根据标准验证：**\n-   **科学依据：** 该问题是偏微分方程数值分析中的一个经典例子，它建立在索伯列夫空间、变分原理和有限元方法的成熟理论之上。算子是自伴的，这是该背景下的一个关键概念。该问题在科学上和数学上都是合理的。\n-   **适定性：** 该问题是适定的。所有必要的信息都已提供——偏微分方程、定义域、边界条件、函数空间和有限元离散化都已明确指定。任务明确，可以得到离散特征值的唯一解。\n-   **客观性：** 问题以精确、客观的数学语言陈述，没有任何主观性或歧义。\n\n**1.3. 结论：**\n该问题被认为是**有效的**。它自成体系、科学合理、适定、客观，并作为数值分析基本原理的典范示例。\n\n### 第二步：求解\n\n**2.1. 弱形式**\n特征值问题为 $-u'' = \\lambda u$ 在 $(0,1)$ 上，且 $u(0)=u(1)=0$。为了推导弱形式，我们乘以一个测试函数 $v \\in H_{0}^{1}(0,1)$ 并在定义域上积分：\n$$-\\int_{0}^{1} u''(x)v(x) \\,dx = \\lambda \\int_{0}^{1} u(x)v(x) \\,dx$$\n对左侧进行分部积分得到：\n$$\\int_{0}^{1} u'(x)v'(x) \\,dx - [u'(x)v(x)]_{0}^{1} = \\lambda \\int_{0}^{1} u(x)v(x) \\,dx$$\n由于 $v \\in H_{0}^{1}(0,1)$，我们有 $v(0)=v(1)=0$，因此边界项 $[u'(x)v(x)]_{0}^{1}$ 为零。使用双线性形式的给定定义，问题的弱形式为：\n求 $(\\lambda, u) \\in \\mathbb{R} \\times H_{0}^{1}(0,1)$，其中 $u \\neq 0$，使得\n$$a(u,v) = \\lambda m(u,v) \\quad \\forall v \\in H_{0}^{1}(0,1)$$\n\n**2.2. 瑞利-里兹方法与伽辽金方法的等价性**\n算子 $L = -\\frac{d^2}{dx^2}$ 在齐次狄利克雷边界条件下，关于 $L^2$ 内积 $m(u,v)$ 是自伴的。这一点可以通过 $a(u,v)$ 的对称性来验证。对于这类自伴正定算子，瑞利-里兹方法与伽辽金方法是等价的。\n\n-   **瑞利-里兹方法：** 这种变分方法旨在寻找瑞利商 $R(u) = \\frac{a(u,u)}{m(u,u)}$ 在有限维子空间 $V_h$ 上的稳定值。设 $u_h(x) = \\sum_{j=1}^{2} c_j \\phi_j(x)$ 是 $V_h$ 中的任意函数，其系数由向量 $\\mathbf{c} = \\begin{pmatrix} c_1  c_2 \\end{pmatrix}^T$ 表示。瑞利商变为 $\\mathbf{c}$ 的函数：\n    $$R(u_h) = \\frac{a(\\sum_i c_i \\phi_i, \\sum_j c_j \\phi_j)}{m(\\sum_i c_i \\phi_i, \\sum_j c_j \\phi_j)} = \\frac{\\sum_i \\sum_j c_i c_j a(\\phi_i, \\phi_j)}{\\sum_i \\sum_j c_i c_j m(\\phi_i, \\phi_j)} = \\frac{\\mathbf{c}^T K \\mathbf{c}}{\\mathbf{c}^T M \\mathbf{c}}$$\n    寻找 $R(u_h)$ 关于系数 $c_k$ 的稳定值 ($\\nabla_{\\mathbf{c}} R = 0$) 会得到广义代数特征值问题 $K\\mathbf{c} = \\lambda_h M\\mathbf{c}$。\n\n-   **伽辽金方法：** 这种投影方法旨在寻找一个近似解 $(\\lambda_h, u_h) \\in \\mathbb{R} \\times V_h$，它在子空间 $V_h$ 上满足弱形式：\n    $$a(u_h, v_h) = \\lambda_h m(u_h, v_h) \\quad \\forall v_h \\in V_h$$\n    我们代入 $u_h = \\sum_{j=1}^{2} c_j \\phi_j$。由于 $\\{\\phi_i\\}$ 构成 $V_h$ 的基，我们只需让方程对每个基函数 $v_h = \\phi_i$ ($i=1, 2$) 成立即可：\n    $$a\\left(\\sum_{j=1}^{2} c_j \\phi_j, \\phi_i\\right) = \\lambda_h m\\left(\\sum_{j=1}^{2} c_j \\phi_j, \\phi_i\\right) \\quad \\text{对 } i=1, 2$$\n    根据双线性形式的线性性质，我们得到：\n    $$\\sum_{j=1}^{2} a(\\phi_j, \\phi_i) c_j = \\lambda_h \\sum_{j=1}^{2} m(\\phi_j, \\phi_i) c_j \\quad \\text{对 } i=1, 2$$\n    注意到 $K_{ij} = a(\\phi_i, \\phi_j)$ 和 $M_{ij} = m(\\phi_i, \\phi_j)$，并考虑到形式的对称性 ($K_{ij}=K_{ji}$, $M_{ij}=M_{ji}$)，该方程组可以写成矩阵形式 $K\\mathbf{c} = \\lambda_h M\\mathbf{c}$。\n\n两种方法都得到了相同的离散问题。这种等价性是以下事实的直接结果：当算子是自伴的时，弱形式（伽辽金方法的起点）代表了瑞利商泛函（里兹方法的起点）的欧拉-拉格朗日方程。\n\n**2.3. 基函数**\n内部节点为 $x_1 = \\frac{1}{3}$ 和 $x_2 = \\frac{2}{3}$。网格尺寸为 $h = \\frac{1}{3}$。帽函数基为：\n$\\phi_1(x) = \\begin{cases} 3x  0 \\le x \\le \\frac{1}{3} \\\\ 2-3x  \\frac{1}{3}  x \\le \\frac{2}{3} \\\\ 0  \\text{其他情况} \\end{cases} \\quad \\text{和} \\quad \\phi_2(x) = \\begin{cases} 3x-1  \\frac{1}{3} \\le x \\le \\frac{2}{3} \\\\ 3-3x  \\frac{2}{3}  x \\le 1 \\\\ 0  \\text{其他情况} \\end{cases}$\n它们的导数是分段常数：\n$\\phi_1'(x) = \\begin{cases} 3  0  x  \\frac{1}{3} \\\\ -3  \\frac{1}{3}  x  \\frac{2}{3} \\\\ 0  \\text{其他情况} \\end{cases} \\quad \\text{和} \\quad \\phi_2'(x) = \\begin{cases} 3  \\frac{1}{3}  x  \\frac{2}{3} \\\\ -3  \\frac{2}{3}  x  1 \\\\ 0  \\text{其他情况} \\end{cases}$\n\n**2.4. 刚度矩阵 $K$ 的计算**\n$K_{ij} = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\,dx$。\n$K_{11} = \\int_{0}^{1/3} (3)^2 \\,dx + \\int_{1/3}^{2/3} (-3)^2 \\,dx = 9(\\frac{1}{3}) + 9(\\frac{1}{3}) = 3+3 = 6$。\n$K_{22} = \\int_{1/3}^{2/3} (3)^2 \\,dx + \\int_{2/3}^{1} (-3)^2 \\,dx = 9(\\frac{1}{3}) + 9(\\frac{1}{3}) = 3+3 = 6$。\n$K_{12} = K_{21} = \\int_{0}^{1} \\phi_1'(x) \\phi_2'(x) \\,dx = \\int_{1/3}^{2/3} (-3)(3) \\,dx = -9(\\frac{1}{3}) = -3$。\n刚度矩阵是 $$K = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}$$。\n\n**2.5. 质量矩阵 $M$ 的计算**\n$M_{ij} = \\int_{0}^{1} \\phi_i(x) \\phi_j(x) \\,dx$。\n$M_{11} = \\int_{0}^{1/3} (3x)^2 \\,dx + \\int_{1/3}^{2/3} (2-3x)^2 \\,dx = [3x^3]_{0}^{1/3} + [-\\frac{1}{9}(2-3x)^3]_{1/3}^{2/3} = 3(\\frac{1}{27}) - (-\\frac{1}{9}(0^3-1^3)) = \\frac{1}{9} + \\frac{1}{9} = \\frac{2}{9}$。\n根据对称性，$M_{22} = M_{11} = \\frac{2}{9}$。\n$M_{12} = M_{21} = \\int_{1/3}^{2/3} (2-3x)(3x-1) \\,dx = \\int_{1/3}^{2/3} (-9x^2+9x-2) \\,dx = [-3x^3 + \\frac{9}{2}x^2 - 2x]_{1/3}^{2/3}$。\n在上下限处求值：\n$[-3(\\frac{8}{27}) + \\frac{9}{2}(\\frac{4}{9}) - 2(\\frac{2}{3})] - [-3(\\frac{1}{27}) + \\frac{9}{2}(\\frac{1}{9}) - 2(\\frac{1}{3})] = [-\\frac{8}{9} + 2 - \\frac{4}{3}] - [-\\frac{1}{9} + \\frac{1}{2} - \\frac{2}{3}] = [-\\frac{2}{9}] - [-\\frac{5}{18}] = -\\frac{4}{18} + \\frac{5}{18} = \\frac{1}{18}$。\n质量矩阵是 $$M = \\begin{pmatrix} \\frac{2}{9}  \\frac{1}{18} \\\\ \\frac{1}{18}  \\frac{2}{9} \\end{pmatrix} = \\frac{1}{18} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix}$$。\n\n**2.6. 求解广义特征值问题**\n我们必须求解 $K\\mathbf{c} = \\lambda_h M\\mathbf{c}$，这等价于求 $\\det(K-\\lambda_h M)=0$ 的根。\n$$\\det\\left( \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix} - \\lambda_h \\begin{pmatrix} \\frac{4}{18}  \\frac{1}{18} \\\\ \\frac{1}{18}  \\frac{4}{18} \\end{pmatrix} \\right) = 0$$\n$$\\det \\begin{pmatrix} 6 - \\frac{2\\lambda_h}{9}  -3 - \\frac{\\lambda_h}{18} \\\\ -3 - \\frac{\\lambda_h}{18}  6 - \\frac{2\\lambda_h}{9} \\end{pmatrix} = 0$$\n设 $A = 6 - \\frac{2\\lambda_h}{9}$ 和 $B = -3 - \\frac{\\lambda_h}{18}$。行列式为 $A^2 - B^2 = 0$，这意味着 $A = \\pm B$。\n\n情况1：$A = B$\n$6 - \\frac{2\\lambda_h}{9} = -3 - \\frac{\\lambda_h}{18} \\implies 9 = \\frac{4\\lambda_h}{18} - \\frac{\\lambda_h}{18} = \\frac{3\\lambda_h}{18} = \\frac{\\lambda_h}{6}$\n$\\lambda_{h,1} = 54$\n\n情况2：$A = -B$\n$6 - \\frac{2\\lambda_h}{9} = -(-3 - \\frac{\\lambda_h}{18}) = 3 + \\frac{\\lambda_h}{18} \\implies 3 = \\frac{4\\lambda_h}{18} + \\frac{\\lambda_h}{18} = \\frac{5\\lambda_h}{18}$\n$\\lambda_{h,2} = \\frac{3 \\times 18}{5} = \\frac{54}{5}$\n两个离散特征值为 $\\lambda_{h,1} = \\frac{54}{5}$ 和 $\\lambda_{h,2} = 54$（按从小到大的顺序排列）。这些是前两个精确特征值 $\\lambda_1 = \\pi^2 \\approx 9.87$ 和 $\\lambda_2 = 4\\pi^2 \\approx 39.48$ 的近似值。正如该问题的有限元理论所预期的那样，离散特征值高估了真实特征值 ($\\lambda_{h,n} \\ge \\lambda_n$)。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{54}{5}  54\n\\end{pmatrix}\n}\n$$"
        }
    ]
}