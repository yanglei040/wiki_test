{
    "hands_on_practices": [
        {
            "introduction": "许多强大的数值积分法则，如辛普森法则，并非凭空产生。它们源于一个简单的思想：用一个多项式逼近原函数，然后对该多项式进行精确积分。本练习将引导你从基本原理出发 ，通过对拉格朗日插值多项式进行积分，亲自推导出辛普森法则的权重，并揭示其高精度的来源。",
            "id": "3426625",
            "problem": "考虑在单个有限元区间 $\\left[a,b\\right]$ 上的一个一维二阶椭圆偏微分方程的弱形式，其中单元载荷积分 $\\int_{a}^{b} f(x)\\,\\mathrm{d}x$ 必须被精确计算。假设 $f \\in C^{4}([a,b])$。使用基于插值型求积的闭式牛顿-柯特斯方法，通过对经过三个节点 $x_{0}=a$、$x_{1}=(a+b)/2$ 和 $x_{2}=b$ 的 $f$ 的唯一二次插值多项式进行积分，构建一个求积法则。通过对与这些节点相关的拉格朗日基多项式进行积分以获得权重，从而从第一性原理推导所得的三点公式。然后，基于该法则对最高3次多项式的精确性以及插值型求积余项的存在性理论，建立该法则的主阶误差表达式，其形式为\n$$\nE \\;=\\; -\\,C\\, (b-a)^{5}\\, f^{(4)}(\\xi)\n$$\n对于某个 $\\xi \\in (a,b)$。确定常数 $C$ 的显式值，并将其精确地表示为一个最简分数。将最终答案表示为一个无单位的单一数字。无需四舍五入。",
            "solution": "该问题要求在区间 $[a, b]$ 上推导一个三点闭式牛顿-柯特斯求积法则，并确定其主阶误差项表达式中的常数 $C$。\n\n### 第1部分：求积公式的推导\n\n该求积法则是通过对在三个指定节点 $x_0 = a$、$x_1 = \\frac{a+b}{2}$ 和 $x_2 = b$ 处插值函数 $f(x)$ 的唯一二次多项式 $P_2(x)$ 进行积分来构建的。积分的近似值为：\n$$\n\\int_{a}^{b} f(x)\\,\\mathrm{d}x \\approx \\int_{a}^{b} P_2(x)\\,\\mathrm{d}x\n$$\n插值多项式 $P_2(x)$ 可以用拉格朗日形式表示为：\n$$\nP_2(x) = f(x_0)L_0(x) + f(x_1)L_1(x) + f(x_2)L_2(x)\n$$\n其中 $L_i(x)$ 是拉格朗日基多项式。求积公式则为：\n$$\n\\int_{a}^{b} P_2(x)\\,\\mathrm{d}x = w_0 f(x_0) + w_1 f(x_1) + w_2 f(x_2)\n$$\n权重 $w_i$ 通过对相应的拉格朗日基多项式进行积分获得：\n$$\nw_i = \\int_{a}^{b} L_i(x)\\,\\mathrm{d}x\n$$\n为了简化积分，我们进行变量代换，将区间 $[a, b]$ 映射到参考区间 $[-1, 1]$。令 $x = \\frac{a+b}{2} + s \\frac{b-a}{2}$，其中 $s \\in [-1, 1]$。微分量为 $\\mathrm{d}x = \\frac{b-a}{2} \\mathrm{d}s$。节点 $x_0=a$、$x_1=(a+b)/2$ 和 $x_2=b$ 分别对应于 $s_0=-1$、$s_1=0$ 和 $s_2=1$。\n\n在参考区间 $[-1, 1]$ 上的拉格朗日基多项式为：\n$$\n\\hat{L}_0(s) = \\frac{(s-s_1)(s-s_2)}{(s_0-s_1)(s_0-s_2)} = \\frac{(s-0)(s-1)}{(-1-0)(-1-1)} = \\frac{1}{2}s(s-1)\n$$\n$$\n\\hat{L}_1(s) = \\frac{(s-s_0)(s-s_2)}{(s_1-s_0)(s_1-s_2)} = \\frac{(s-(-1))(s-1)}{(0-(-1))(0-1)} = \\frac{s^2-1}{-1} = 1-s^2\n$$\n$$\n\\hat{L}_2(s) = \\frac{(s-s_0)(s-s_1)}{(s_2-s_0)(s_2-s_1)} = \\frac{(s-(-1))(s-0)}{(1-(-1))(1-0)} = \\frac{1}{2}s(s+1)\n$$\n现在，我们通过在 $[-1, 1]$ 上对这些多项式进行积分，并考虑变量代换来计算权重 $w_i$：\n$$\nw_i = \\int_{-1}^{1} \\hat{L}_i(s) \\left(\\frac{b-a}{2}\\right)\\,\\mathrm{d}s\n$$\n对于 $w_0$：\n$$\nw_0 = \\frac{b-a}{2} \\int_{-1}^{1} \\frac{1}{2}(s^2-s)\\,\\mathrm{d}s = \\frac{b-a}{4} \\left[\\frac{s^3}{3} - \\frac{s^2}{2}\\right]_{-1}^{1} = \\frac{b-a}{4} \\left( \\left(\\frac{1}{3}-\\frac{1}{2}\\right) - \\left(\\frac{-1}{3}-\\frac{1}{2}\\right) \\right) = \\frac{b-a}{4} \\left(\\frac{2}{3}\\right) = \\frac{b-a}{6}\n$$\n对于 $w_1$：\n$$\nw_1 = \\frac{b-a}{2} \\int_{-1}^{1} (1-s^2)\\,\\mathrm{d}s = \\frac{b-a}{2} \\left[s - \\frac{s^3}{3}\\right]_{-1}^{1} = \\frac{b-a}{2} \\left( \\left(1-\\frac{1}{3}\\right) - \\left(-1-\\frac{-1}{3}\\right) \\right) = \\frac{b-a}{2} \\left(\\frac{2}{3} - \\left(-\\frac{2}{3}\\right)\\right) = \\frac{b-a}{2}\\left(\\frac{4}{3}\\right) = \\frac{4(b-a)}{6}\n$$\n对于 $w_2$：\n$$\nw_2 = \\frac{b-a}{2} \\int_{-1}^{1} \\frac{1}{2}(s^2+s)\\,\\mathrm{d}s = \\frac{b-a}{4} \\left[\\frac{s^3}{3} + \\frac{s^2}{2}\\right]_{-1}^{1} = \\frac{b-a}{4} \\left( \\left(\\frac{1}{3}+\\frac{1}{2}\\right) - \\left(\\frac{-1}{3}+\\frac{1}{2}\\right) \\right) = \\frac{b-a}{4} \\left(\\frac{2}{3}\\right) = \\frac{b-a}{6}\n$$\n所得的求积法则，即著名的辛普森法则，为：\n$$\n\\int_{a}^{b} f(x)\\,\\mathrm{d}x \\approx \\frac{b-a}{6} \\left[ f(a) + 4f\\left(\\frac{a+b}{2}\\right) + f(b) \\right]\n$$\n\n### 第2部分：误差项常数的推导\n\n该求积法则的误差泛函定义为：\n$$\nE(f) = \\int_{a}^{b} f(x)\\,\\mathrm{d}x - \\frac{b-a}{6} \\left[ f(a) + 4f\\left(\\frac{a+b}{2}\\right) + f(b) \\right]\n$$\n该法则是从二次插值构建的，因此它对最高2次的多项式是精确的。然而，由于节点的对称布置，辛普森法则具有更高的代数精度。让我们用一个三次多项式来测试它，例如在区间 $[x_1-h, x_1+h]$ 上的 $p(x) = (x-x_1)^3$，其中 $x_1=(a+b)/2$，$h=(b-a)/2$。积分为 $\\int_{x_1-h}^{x_1+h} (x-x_1)^3\\,\\mathrm{d}x = 0$，因为这是一个奇函数在对称区间上的积分。该法则给出 $\\frac{2h}{6}[(x_1-h-x_1)^3 + 4(x_1-x_1)^3 + (x_1+h-x_1)^3] = \\frac{h}{3}[(-h)^3 + 0 + h^3] = 0$。因此，该法则对最高3次的多项式是精确的。\n\n这种更高的代数精度表明误差项与 $f$ 的四阶导数有关。我们可以使用埃尔米特插值理论来推导它。令 $H_3(x)$ 为在节点 $x_0, x_1, x_2$ 处插值 $f$ 并在中点 $x_1$ 处插值其导数 $f'$ 的三次多项式。这种埃尔米特插值的误差由下式给出：\n$$\nf(x) - H_3(x) = \\frac{f^{(4)}(\\zeta_x)}{4!} (x-x_0)(x-x_1)^2(x-x_2)\n$$\n对于某个 $\\zeta_x \\in (a,b)$。求积法则的误差可以写为：\n$$\nE(f) = \\int_a^b f(x)\\,\\mathrm{d}x - I(f) = \\int_a^b (f(x) - H_3(x))\\,\\mathrm{d}x + \\int_a^b H_3(x)\\,\\mathrm{d}x - I(f)\n$$\n由于辛普森法则对任何三次多项式都是精确的，所以 $\\int_a^b H_3(x)\\,\\mathrm{d}x = I(H_3)$。根据 $H_3(x)$ 的构造，$H_3(x_i) = f(x_i)$ 对于 $i=0, 1, 2$ 成立。因此，$I(H_3) = I(f)$。这可将误差简化为：\n$$\nE(f) = \\int_a^b (f(x) - H_3(x))\\,\\mathrm{d}x = \\int_a^b \\frac{f^{(4)}(\\zeta_x)}{4!} (x-x_0)(x-x_1)^2(x-x_2)\\,\\mathrm{d}x\n$$\n令 $\\omega(x) = (x-x_0)(x-x_1)^2(x-x_2)$。对于 $x \\in [a, b] = [x_0, x_2]$，我们观察到 $(x-x_0) \\ge 0$，$(x-x_1)^2 \\ge 0$ 且 $(x-x_2) \\le 0$。因此，对于所有 $x \\in [a, b]$，$\\omega(x) \\le 0$。由于 $\\omega(x)$ 在积分区间上不变号，我们可以应用积分中值定理：\n$$\nE(f) = \\frac{f^{(4)}(\\xi)}{4!} \\int_a^b (x-x_0)(x-x_1)^2(x-x_2)\\,\\mathrm{d}x \\quad \\text{对于某个 } \\xi \\in (a, b)\n$$\n我们现在计算该积分。令 $h = (b-a)/2$。我们使用与之前相同的变量代换，$x = x_1 + sh = \\frac{a+b}{2} + s \\frac{b-a}{2}$，其中 $s \\in [-1, 1]$。\n$\\omega(x)$ 的各组成部分变为：\n$x-x_0 = (x_1+sh)-(x_1-h) = (s+1)h$\n$x-x_1 = sh$\n$x-x_2 = (x_1+sh)-(x_1+h) = (s-1)h$\n积分项为：\n$$\n\\int_a^b \\omega(x)\\,\\mathrm{d}x = \\int_{-1}^{1} [(s+1)h][sh]^2[(s-1)h] \\cdot (h\\,\\mathrm{d}s) = h^5 \\int_{-1}^{1} s^2(s^2-1) \\,\\mathrm{d}s\n$$\n$$\n= h^5 \\int_{-1}^{1} (s^4-s^2)\\,\\mathrm{d}s = h^5 \\left[ \\frac{s^5}{5} - \\frac{s^3}{3} \\right]_{-1}^{1} = h^5 \\left( \\left(\\frac{1}{5}-\\frac{1}{3}\\right) - \\left(\\frac{-1}{5}-\\frac{-1}{3}\\right) \\right) = h^5 \\left( 2 \\left(\\frac{3-5}{15}\\right) \\right) = -\\frac{4h^5}{15}\n$$\n将此结果代入误差表达式：\n$$\nE(f) = \\frac{f^{(4)}(\\xi)}{4!} \\left(-\\frac{4h^5}{15}\\right) = \\frac{f^{(4)}(\\xi)}{24} \\left(-\\frac{4h^5}{15}\\right) = -\\frac{h^5}{90}f^{(4)}(\\xi)\n$$\n最后，我们代入 $h = \\frac{b-a}{2}$，以区间长度 $b-a$ 表示误差：\n$$\nE(f) = -\\frac{1}{90} \\left(\\frac{b-a}{2}\\right)^5 f^{(4)}(\\xi) = -\\frac{(b-a)^5}{90 \\cdot 32} f^{(4)}(\\xi) = -\\frac{1}{2880}(b-a)^5 f^{(4)}(\\xi)\n$$\n问题陈述误差的形式为 $E = -C(b-a)^5 f^{(4)}(\\xi)$。通过将其与我们推导的公式进行比较，我们确定常数 $C$ 为：\n$$\nC = \\frac{1}{2880}\n$$\n该分数为最简形式，因为分子是 $1$。",
            "answer": "$$\\boxed{\\frac{1}{2880}}$$"
        },
        {
            "introduction": "仅仅应用一个固定的积分法则是远远不够的，我们可以做得更好。通过深入理解数值误差的结构，我们能巧妙地组合不同步长下的计算结果，以消除主导误差项。本练习将展示理查森外推法（Richardson extrapolation）这一优雅而强大的技术 ，并揭示它如何将简单的梯形法则提升为更高阶的辛普森法则，从而实现精度的飞跃。",
            "id": "3426550",
            "problem": "考虑在一维偏微分方程 (PDE) 的弱形式中出现的一个光滑被积函数 $f \\in C^{5}([a,b])$。任务是使用 Newton–Cotes 法则计算双线性形式积分 $I = \\int_{a}^{b} f(x)\\,dx$。设使用均匀子区间大小 $h = \\frac{b-a}{N}$ 的复合梯形法则记作\n$$\nT(h) = h \\left( \\frac{f(a) + f(b)}{2} + \\sum_{k=1}^{N-1} f(a + k h) \\right),\n$$\n类似地，$T(h/2)$ 表示在相同区间 $[a,b]$ 上使用步长 $h/2$ 计算的复合梯形法则。\n\n设计一个单步 Richardson 外推，该外推结合 $T(h)$ 和 $T(h/2)$ 来生成 $I$ 的一个估计值 $Q(h)$，其误差为 $O(h^{4})$。您的设计必须：\n- 选择常数 $\\alpha$ 和 $\\beta$ 以构成线性组合 $Q(h) = \\alpha\\,T(h/2) + \\beta\\,T(h)$。\n- 以 Euler–Maclaurin 求和公式为基本依据，证明您的选择为何能消去 $T(h)$ 误差展开式中的首要 $O(h^{2})$ 项，从而得到 $O(h^{4})$ 的精度。\n- 以 $T(h/2)$ 和 $T(h)$ 的闭合形式给出 $Q(h)$ 的最终表达式。\n\n将您的最终答案表示为单个闭合形式的解析表达式。无需四舍五入。",
            "solution": "该问题要求设计一个单步 Richardson 外推来提高复合梯形法则的精度。目标是结合两个估计值 $T(h)$ 和 $T(h/2)$，以产生一个具有更高精度阶的新估计值 $Q(h)$。此过程的理论依据依赖于 Euler–Maclaurin 求和公式。\n\n首先，我们建立复合梯形法则 $T(h)$ 的渐近误差展开式。Euler–Maclaurin 公式提供了一个积分与其对应求和之间的关系。对于一个在区间 $[m, n]$ 上足够光滑的函数 $g$，该公式可表示为：\n$$\n\\sum_{k=m}^{n} g(k) = \\int_{m}^{n} g(t) dt + \\frac{g(m)+g(n)}{2} + \\sum_{j=1}^{p} \\frac{B_{2j}}{(2j)!} \\left( g^{(2j-1)}(n) - g^{(2j-1)}(m) \\right) + R_p\n$$\n其中 $B_{2j}$ 是 Bernoulli 数。\n\n为将其应用于我们的积分 $I = \\int_{a}^{b} f(x)\\,dx$，我们进行变量替换 $x = a + th$，其中 $h = \\frac{b-a}{N}$。当 $t$ 从 $0$ 变到 $N$ 时，$x$ 从 $a$ 变到 $b$。积分变为 $I = h \\int_{0}^{N} f(a+th) dt$。令 $g(t) = f(a+th)$。\n复合梯形法则由下式给出：\n$$\nT(h) = h \\left( \\frac{f(a) + f(b)}{2} + \\sum_{k=1}^{N-1} f(a + k h) \\right) = h \\left( \\frac{g(0) + g(N)}{2} + \\sum_{k=1}^{N-1} g(k) \\right)\n$$\n这可以改写为 $\\frac{T(h)}{h} = \\sum_{k=0}^{N} g(k) - \\frac{g(0) + g(N)}{2}$。\n重排 Euler–Maclaurin 公式，我们得到：\n$$\n\\sum_{k=0}^{N} g(k) - \\frac{g(0) + g(N)}{2} = \\int_{0}^{N} g(t) dt + \\sum_{j=1}^{p} \\frac{B_{2j}}{(2j)!} \\left( g^{(2j-1)}(N) - g^{(2j-1)}(0) \\right) + R_p\n$$\n将我们的表达式 $\\frac{T(h)}{h}$ 和 $\\int_{0}^{N} g(t) dt = \\frac{I}{h}$ 代入：\n$$\n\\frac{T(h)}{h} = \\frac{I}{h} + \\sum_{j=1}^{p} \\frac{B_{2j}}{(2j)!} \\left( g^{(2j-1)}(N) - g^{(2j-1)}(0) \\right) + R_p'\n$$\n$g(t)$ 的导数通过链式法则与 $f(x)$ 的导数相关：$g^{(k)}(t) = h^k f^{(k)}(a+th)$。\n因此，$g^{(2j-1)}(N) = h^{2j-1}f^{(2j-1)}(b)$ 且 $g^{(2j-1)}(0) = h^{2j-1}f^{(2j-1)}(a)$。\n将这些代回并将整个方程乘以 $h$，我们得到：\n$$\nT(h) = I + \\sum_{j=1}^{p} \\frac{B_{2j}}{(2j)!} h^{2j} \\left( f^{(2j-1)}(b) - f^{(2j-1)}(a) \\right) + O(h^{2p+2})\n$$\n条件 $f \\in C^{5}([a,b])$ 确保我们可以将展开式写到 $O(h^4)$ 项，并带有一个良定义的余项。我们定义与 $h$ 无关的常数 $C_2$ 和 $C_4$：\n$C_2 = \\frac{B_2}{2!} \\left( f'(b) - f'(a) \\right)$\n$C_4 = \\frac{B_4}{4!} \\left( f'''(b) - f'''(a) \\right)$\n因此，梯形法则的误差展开式为：\n$$\nT(h) = I + C_2 h^2 + C_4 h^4 + O(h^6)\n$$\n这个关于 $h$ 的偶次幂的展开式是 Richardson 外推的基础。\n\n现在，我们写出步长为 $h$ 和步长为 $h/2$ 时的展开式：\n$$\nT(h) = I + C_2 h^2 + C_4 h^4 + O(h^6) \\quad (1)\n$$\n$$\nT(h/2) = I + C_2 \\left(\\frac{h}{2}\\right)^2 + C_4 \\left(\\frac{h}{2}\\right)^4 + O(h^6) = I + \\frac{1}{4} C_2 h^2 + \\frac{1}{16} C_4 h^4 + O(h^6) \\quad (2)\n$$\n我们寻求构造一个线性组合 $Q(h) = \\alpha\\,T(h/2) + \\beta\\,T(h)$，以提供 $I$ 的一个更好的估计值。将展开式 $(1)$ 和 $(2)$ 代入此形式：\n$$\nQ(h) = \\alpha \\left(I + \\frac{1}{4} C_2 h^2 + \\frac{1}{16} C_4 h^4 \\right) + \\beta \\left(I + C_2 h^2 + C_4 h^4 \\right) + O(h^6)\n$$\n$$\nQ(h) = (\\alpha + \\beta)I + \\left( \\frac{\\alpha}{4} + \\beta \\right) C_2 h^2 + \\left( \\frac{\\alpha}{16} + \\beta \\right) C_4 h^4 + O(h^6)\n$$\n为了使 $Q(h)$ 成为 $I$ 的一个更精确的近似，我们对系数 $\\alpha$ 和 $\\beta$ 施加两个条件：\n1. 为保证估计的一致性，$I$ 的系数必须为 $1$：\n   $$ \\alpha + \\beta = 1 $$\n2. 首要误差项 $C_2 h^2$ 的系数必须为 $0$，以消去此项：\n   $$ \\frac{\\alpha}{4} + \\beta = 0 $$\n我们现在有了一个关于 $\\alpha$ 和 $\\beta$ 的二元线性方程组。从第二个方程，我们得到 $\\beta = -\\frac{\\alpha}{4}$。将此代入第一个方程：\n$$\n\\alpha - \\frac{\\alpha}{4} = 1 \\implies \\frac{3}{4}\\alpha = 1 \\implies \\alpha = \\frac{4}{3}\n$$\n然后，我们求出 $\\beta$：\n$$\n\\beta = 1 - \\alpha = 1 - \\frac{4}{3} = -\\frac{1}{3}\n$$\n使用这些 $\\alpha$ 和 $\\beta$ 的值，外推估计值 $Q(h)$ 为：\n$$\nQ(h) = \\frac{4}{3}T(h/2) - \\frac{1}{3}T(h)\n$$\n这个新估计值的误差由其展开式中的下一个非零项决定。$C_2 h^2$ 项根据构造已为零。$I$ 项的系数为 $1$。因此误差为：\n$$\nQ(h) - I = \\left( \\frac{\\alpha}{16} + \\beta \\right) C_4 h^4 + O(h^6)\n$$\n让我们计算新的首项系数：\n$$\n\\frac{\\alpha}{16} + \\beta = \\frac{4/3}{16} - \\frac{1}{3} = \\frac{1}{12} - \\frac{1}{3} = \\frac{1-4}{12} = -\\frac{3}{12} = -\\frac{1}{4}\n$$\n所以 $Q(h)$ 的误差为：\n$$\nQ(h) - I = -\\frac{1}{4} C_4 h^4 + O(h^6)\n$$\n这证实了误差的阶为 $O(h^4)$，符合要求。得到的公式即为 Simpson 法则，这里它是通过对梯形法则进行 Richardson 外推得到的。\n\n用 $T(h)$ 和 $T(h/2)$ 表示的改进估计值 $Q(h)$ 的最终表达式为：\n$$\nQ(h) = \\frac{4}{3}T(h/2) - \\frac{1}{3}T(h)\n$$\n这可以写成一个单一的闭合形式。",
            "answer": "$$\n\\boxed{\\frac{4}{3}T\\left(\\frac{h}{2}\\right) - \\frac{1}{3}T(h)}\n$$"
        },
        {
            "introduction": "从理论走向实践，现实世界的问题需要既精确又高效的数值方法。一个固定的步长在函数的平滑区域会造成浪费，在剧烈变化的区域又可能精度不足。本练习探讨如何利用误差估计来构建一个自适应算法 ，该算法能自动在需要的地方加密网格，从而在满足给定误差容限 $\\varepsilon$ 的同时，避免不必要的计算，这是现代数值计算库的核心思想之一。",
            "id": "3426571",
            "problem": "在为线性标量偏微分方程(PDE)组装一维有限元矩阵时，您必须使用闭式 Newton–Cotes 法则来近似计算当前区间 $\\left[x_0,x_2\\right]\\subset [A,B]$ 上的形如 $\\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x$ 的积分。考虑在区间 $\\left[x_0,x_2\\right]$ 上使用复合 Simpson 法则，粗略步长为 $h:=x_2-x_0$，即使用节点 $x_0$、$x_1:=\\tfrac{x_0+x_2}{2}$ 和 $x_2$ 的单区间 Simpson 近似 $S_h$。现在通过将 $\\left[x_0,x_2\\right]$ 分割成两个长度为 $h/2$ 的半区间来加密该区间，并在每个子区间上应用 Simpson 法则，从而得到加密后的复合近似 $S_{h/2}$ 和可计算的差值 $D := S_{h/2}-S_h$。\n\n假设 $f$ 足够光滑，使得在长度为 $h$ 的区间上的 Simpson 法则误差与 $h^5$ 及 $f^{(4)}$ 在该区间内某点的值的乘积成正比。为加密后的近似 $S_{h/2}$ 构建一个仅依赖于 $D$ 的一致局部后验误差估计子，然后基于用户为整个积分区间 $[A,B]$ 指定的绝对容差 $\\varepsilon0$ 推导出一个接受准则。对当前区间采用标准的局部分配容差 $\\tau := \\varepsilon\\,\\frac{x_2-x_0}{B-A}$。您的接受准则应具有 “若 $\\lvert D\\rvert \\leq \\text{threshold}(\\varepsilon,x_2-x_0,B-A)$，则接受加密后的区间” 的形式。请提供该阈值关于 $\\varepsilon$、$x_2-x_0$ 和 $B-A$ 的显式封闭形式表达式。\n\n您的最终答案必须是单个解析表达式。不需要单位，也不需要四舍五入。",
            "solution": "我们从关于闭式 Newton–Cotes Simpson 法则的一个经过充分检验的事实出发：正如在本附录第一个练习中推导的那样，对于一个足够光滑的被积函数 $f$，在长度为 $h$ 的区间上的单区间 Simpson 近似满足\n$$\n\\int_{a}^{b} f(x)\\,\\mathrm{d}x - S_h = E_h = -\\frac{h^5}{2880}\\,f^{(4)}(\\xi_h),\n$$\n其中 $\\xi_h\\in[a,b]$。因此，局部截断误差的量级为 $E_h=\\mathcal{O}(h^5)$，其常数与 $f^{(4)}$ 有关。\n\n在长度为 $h:=x_2-x_0$ 的区间 $\\left[x_0,x_2\\right]$ 上，粗略的 Simpson 近似 $S_h$ 的误差为\n$$\nE_h := \\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x - S_h = -\\frac{h^5}{2880}\\,f^{(4)}(\\xi_h).\n$$\n将该区间加密为2个长度为 $h/2$ 的半区间，并在每个子区间上应用 Simpson 法则，得到加密后的复合近似 $S_{h/2}$。其总误差是两个子区间误差之和。在 $f^{(4)}$ 光滑的条件下，两个子区间的误差贡献近似相等，每个的量级为 $-(h/2)^5 f^{(4)}/2880$，因此加密后的总误差满足\n$$\nE_{h/2} := \\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x - S_{h/2} \\approx -2\\,\\frac{(h/2)^5}{2880}\\,f^{(4)}(\\xi_{h/2}) = \\frac{1}{16}\\,E_h,\n$$\n这里我们利用了主误差常数在 $f^{(4)}$ 的光滑变化范围内是相同的，以及因子 $\\left(\\tfrac{h}{2}\\right)^5 = \\tfrac{h^5}{32}$。因此，主阶关系为 $E_{h/2}\\approx \\tfrac{1}{16}E_h$。\n\n现在考虑可计算的差值\n$$\nD := S_{h/2}-S_h = \\bigl(\\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x - E_{h/2}\\bigr) - \\bigl(\\int_{x_0}^{x_2} f(x)\\,\\mathrm{d}x - E_h\\bigr) = E_h - E_{h/2}.\n$$\n使用 $E_{h/2}\\approx \\tfrac{1}{16}E_h$，就主阶而言，我们得到\n$$\nD \\approx E_h - \\frac{1}{16}E_h = \\frac{15}{16}\\,E_h.\n$$\n解出 $E_h$ 和 $E_{h/2}$ 可得\n$$\nE_h \\approx \\frac{16}{15}\\,D,\\qquad E_{h/2} \\approx \\frac{1}{16}\\,E_h \\approx \\frac{1}{15}\\,D.\n$$\n因此，对于加密后的复合 Simpson 近似 $S_{h/2}$，一个一致的局部后验误差估计子是\n$$\n\\eta := \\left|\\frac{1}{15}\\,D\\right| = \\frac{1}{15}\\,\\lvert S_{h/2}-S_h\\rvert.\n$$\n\n假设用户为整个区间 $[A,B]$ 上的积分指定了绝对容差 $\\varepsilon0$。自适应求积的标准容差分配方法是为区间 $\\left[x_0,x_2\\right]$ 分配局部容差\n$$\n\\tau := \\varepsilon\\,\\frac{x_2-x_0}{B-A}.\n$$\n为了接受加密后的区间，我们要求估计的加密后误差不超过其局部分配的容差：\n$$\n\\eta \\le \\tau \\quad \\Longleftrightarrow \\quad \\frac{1}{15}\\,\\lvert S_{h/2}-S_h\\rvert \\le \\varepsilon\\,\\frac{x_2-x_0}{B-A}.\n$$\n等价地，这产生了一个形如下式的接受准则\n$$\n\\lvert D\\rvert \\le \\underbrace{15\\,\\varepsilon\\,\\frac{x_2-x_0}{B-A}}_{\\text{threshold}(\\varepsilon,x_2-x_0,B-A)}.\n$$\n\n因此，所要求的显式阈值函数是 $15\\,\\varepsilon\\,\\dfrac{x_2-x_0}{B-A}$。",
            "answer": "$$\\boxed{15\\,\\varepsilon\\,\\frac{x_2 - x_0}{B - A}}$$"
        }
    ]
}