{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固有限元方法的基础步骤。它将指导你从一个标准的二阶边值问题出发，通过分部积分推导出其弱形式，然后展示该公式如何转化为一个具体的矩阵系统。最后，通过分析刚度矩阵的稀疏性，你将深入理解局部基函数的选择如何直接影响最终离散系统的结构，这是有限元方法计算效率的关键。",
            "id": "3457915",
            "problem": "考虑区间 $\\Omega=(0,1)$ 上的二阶线性边值问题：\n求解 $u:\\Omega \\to \\mathbb{R}$ 使得\n$$\n- \\big(a(x)\\,u'(x)\\big)' + c(x)\\,u(x) = f(x) \\quad \\text{对于 } x \\in (0,1), \\qquad u(0)=0,\\;u(1)=0,\n$$\n其中 $a \\in C^{1}([0,1])$ 对所有 $x \\in [0,1]$ 满足 $a(x)\\ge a_{0}>0$，$c \\in L^{\\infty}(0,1)$ 几乎处处满足 $c(x)\\ge 0$，且 $f \\in L^{2}(0,1)$。从加权余量法原理和 Sobolev 空间 $H_{0}^{1}(0,1)$ 的定义出发，通过恰好一次分部积分推导其弱形式，并用 $a(x)$、$c(x)$ 和 $f(x)$ 表示双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $\\ell(\\cdot)$。\n\n设 $\\mathcal{T}_{h}$ 是 $(0,1)$ 的一个均匀网格剖分，包含 $N$ 个长度为 $h=1/N$ 的单元。设 $V_{h} \\subset H_{0}^{1}(0,1)$ 是 $\\mathcal{T}_{h}$ 上的标准 $C^{0}$ 拉格朗日有限元空间，其多项式次数为 $p \\ge 1$，节点基为 $\\{\\phi_{j}\\}_{j=1}^{n}$（按沿线的坐标递增排序），并设 $W_{h}=V_{h}$，其节点基为 $\\{\\psi_{i}\\}_{i=1}^{n}$（采用相同排序）。使用有限元法（FEM），推导离散线性系统 $A\\boldsymbol{x}=\\boldsymbol{b}$，其各项为\n$$\nA_{ij} = a(\\phi_{j},\\psi_{i}), \\qquad b_{i} = \\ell(\\psi_{i}),\n$$\n通过写出单元贡献并解释如何从局部组装到全局。\n\n然后，仅根据一维均匀网格上基函数的紧支集和重叠情况，以及分部积分后双线性形式的形式，确定组装后的全局矩阵 $A$ 中非零对角线总数的一个精确闭式表达式（即，计算主对角线以及所有包含至少一个非零元素的独立上、下对角线），该表达式是关于多项式次数 $p$ 的函数。你的最终答案必须是一个关于 $p$ 的无单位的符号表达式。不需要进行数值近似或四舍五入。",
            "solution": "问题要求对给定的边值问题推导其弱形式和离散系统，然后确定最终的有限元矩阵中非零对角线的数量，并将其表示为多项式次数 $p$ 的函数。\n\n**第一部分：弱形式的推导**\n\n我们从边值问题的强形式开始：\n求解 $u: [0,1] \\to \\mathbb{R}$ 使得\n$$\n- \\big(a(x)\\,u'(x)\\big)' + c(x)\\,u(x) = f(x) \\quad \\text{对于 } x \\in (0,1),\n$$\n带有齐次 Dirichlet 边界条件 $u(0)=0$ 和 $u(1)=0$。\n\n加权余量法原理要求微分方程的余项 $r(x) = f(x) + (a(x)u'(x))' - c(x)u(x)$ 与一个合适的检验函数空间正交。包含了齐次边界条件的、适用于解 $u$ 和检验函数 $v$ 的函数空间是 Sobolev 空间 $H_{0}^{1}(0,1)$。该空间由 $L^2(0,1)$ 中其弱导数也在 $L^2(0,1)$ 中的函数组成，并且这些函数在迹的意义上满足边界条件 $u(0)=u(1)=0$。\n\n我们将微分方程乘以一个任意的检验函数 $v \\in H_{0}^{1}(0,1)$，并在定义域 $\\Omega = (0,1)$ 上积分：\n$$\n\\int_{0}^{1} \\left( - \\big(a(x)\\,u'(x)\\big)' + c(x)\\,u(x) \\right) v(x) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx.\n$$\n我们对包含二阶导数的项应用分部积分。对于任意函数 $u \\in H^2(0,1)$ 和 $v \\in H^1(0,1)$，分部积分公式为：\n$$\n\\int_{0}^{1} - \\big(a(x)\\,u'(x)\\big)' v(x) \\, dx = - \\Big[ a(x)\\,u'(x)\\,v(x) \\Big]_{0}^{1} + \\int_{0}^{1} a(x)\\,u'(x)\\,v'(x) \\, dx.\n$$\n由于检验函数 $v$ 属于 $H_{0}^{1}(0,1)$，它满足 $v(0)=0$ 和 $v(1)=0$。因此，边界项为零：\n$$\n- \\Big[ a(x)\\,u'(x)\\,v(x) \\Big]_{0}^{1} = - \\big( a(1)\\,u'(1)\\,v(1) - a(0)\\,u'(0)\\,v(0) \\big) = 0.\n$$\n将此代回积分后的方程，得到：\n$$\n\\int_{0}^{1} a(x)\\,u'(x)\\,v'(x) \\, dx + \\int_{0}^{1} c(x)\\,u(x)\\,v(x) \\, dx = \\int_{0}^{1} f(x) v(x) \\, dx.\n$$\n此方程必须对所有 $v \\in H_{0}^{1}(0,1)$ 成立。这就是问题的弱形式。\n\n我们可以将其表示为标准形式：求解 $u \\in H_{0}^{1}(0,1)$ 使得\n$$\na(u,v) = \\ell(v) \\quad \\forall v \\in H_{0}^{1}(0,1),\n$$\n其中 $a(\\cdot,\\cdot)$ 是一个双线性形式，$\\ell(\\cdot)$ 是一个线性泛函。通过与推导出的方程进行比较，我们确定：\n双线性形式 $a(\\cdot,\\cdot): H_{0}^{1}(0,1) \\times H_{0}^{1}(0,1) \\to \\mathbb{R}$ 由下式给出：\n$$\na(u,v) = \\int_{0}^{1} \\big( a(x)\\,u'(x)\\,v'(x) + c(x)\\,u(x)\\,v(x) \\big) \\, dx.\n$$\n线性泛函 $\\ell(\\cdot): H_{0}^{1}(0,1) \\to \\mathbb{R}$ 由下式给出：\n$$\n\\ell(v) = \\int_{0}^{1} f(x)\\,v(x) \\, dx.\n$$\n对 $a(x)$、$c(x)$ 和 $f(x)$ 的条件确保了这些积分是良定义的，并且双线性形式是连续和强制的，根据 Lax-Milgram 定理保证了唯一解的存在。\n\n**第二部分：离散线性系统的推导**\n\n在有限元法（FEM）中，我们在一个有限维子空间 $V_h \\subset H_{0}^{1}(0,1)$ 中寻求近似解 $u_h$。问题陈述 $V_h$ 是在均匀网格 $\\mathcal{T}_h$ 上的 $p \\ge 1$ 次连续分片多项式空间。设 $\\{\\phi_j\\}_{j=1}^{n}$ 是 $V_h$ 的一个节点基。近似解可以写成这些基函数的线性组合：\n$$\nu_h(x) = \\sum_{j=1}^{n} x_j \\phi_j(x),\n$$\n其中 $\\boldsymbol{x} = (x_1, \\dots, x_n)^T$ 是未知系数的向量，这些系数对应于 $u_h$ 在网格内部节点处的值。\n\nGalerkin 方法将试验空间设为与检验空间相等，即 $W_h=V_h$。离散问题是求解 $u_h \\in V_h$ 使得对所有 $v_h \\in V_h$ 都有 $a(u_h, v_h) = \\ell(v_h)$。由于 $V_h$ 是由基函数 $\\{\\psi_i\\}_{i=1}^{n}$（与 $\\{\\phi_i\\}_{i=1}^{n}$ 相同）张成的，因此只需对每个基函数强制执行此条件即可：\n$$\na(u_h, \\psi_i) = \\ell(\\psi_i) \\quad \\text{对于 } i=1, \\dots, n.\n$$\n代入 $u_h$ 的展开式，并利用 $a(\\cdot, \\cdot)$ 对其第一个参数的线性性，我们得到：\n$$\na\\left(\\sum_{j=1}^{n} x_j \\phi_j, \\psi_i\\right) = \\sum_{j=1}^{n} x_j a(\\phi_j, \\psi_i) = \\ell(\\psi_i) \\quad \\text{对于 } i=1, \\dots, n.\n$$\n这是一个关于 $n$ 个未知数 $x_j$ 的 $n$ 个线性方程组。我们可以将其写成矩阵形式 $A\\boldsymbol{x} = \\boldsymbol{b}$，其中矩阵 $A$（刚度矩阵）和向量 $\\boldsymbol{b}$（载荷向量）的项由下式给出：\n$$\nA_{ij} = a(\\phi_j, \\psi_i) = \\int_{0}^{1} \\big( a(x)\\,\\phi_j'(x)\\,\\psi_i'(x) + c(x)\\,\\phi_j(x)\\,\\psi_i(x) \\big) \\, dx,\n$$\n$$\nb_i = \\ell(\\psi_i) = \\int_{0}^{1} f(x)\\,\\psi_i(x) \\, dx.\n$$\n全局矩阵 $A$ 和向量 $\\boldsymbol{b}$ 是由网格 $\\mathcal{T}_h$ 中每个单元 $K_e$ 的局部贡献组装而成的。对于每个单元 $K_e$，人们使用限制在 $K_e$ 上的积分和局部基函数来计算单元矩阵 $A^e$ 和单元向量 $\\boldsymbol{b}^e$。例如，$(A^e)_{\\alpha\\beta} = \\int_{K_e} (\\dots) dx$。然后根据属于单元 $K_e$ 的节点的全局索引，将这些局部矩阵/向量的项加到全局矩阵/向量中的相应位置。\n\n**第三部分：非零对角线的数量**\n\n全局刚度矩阵 $A$ 的稀疏结构由基函数的支集（support）决定。矩阵元素 $A_{ij} = a(\\phi_j, \\phi_i)$ 非零，当且仅当基函数 $\\phi_i$ 和 $\\phi_j$ 的支集有非空的交集，因为被积函数 $\\phi_i, \\phi_j$ 和它们的导数只在支集上非零。\n\n对于一维拉格朗日有限元，与节点 $k$ 相关的基函数 $\\phi_k$ 的支集是包含节点 $k$ 的一个或两个单元。因此，两个基函数 $\\phi_i$ 和 $\\phi_j$ 的支集重叠，当且仅当它们所关联的节点 $i$ 和 $j$ 属于同一个单元。\n\n每个次数为 $p$ 的有限元单元包含 $p+1$ 个节点。由于问题规定节点是按坐标递增排序进行全局编号的，那么属于同一个单元的 $p+1$ 个节点的索引将是连续的或接近连续的。考虑任意一个单元，设其包含的 $p+1$ 个节点的最小全局索引为 $k_{min}$，最大全局索引为 $k_{max}$。由于节点是按坐标排序的，并且单元内的节点在空间上是相邻的，那么 $k_{max} - k_{min} = p$。\n\n矩阵的半带宽 $w$ 定义为 $w = \\max \\{|i-j| \\mid A_{ij} \\neq 0\\}$。基于以上分析，这个最大索引差 $|i-j|$ 发生在两个节点 $i$ 和 $j$ 位于同一个单元的两端时。因此，半带宽 $w = p$。\n\n一个带状矩阵的非零对角线总数由其主对角线、上对角线和下对角线组成。对于半带宽为 $p$ 的矩阵，有 1 条主对角线，p 条上对角线和 p 条下对角线。所以，非零对角线的总数为：\n$$\n1 (\\text{主对角线}) + p (\\text{上对角线}) + p (\\text{下对角线}) = 2p+1\n$$\n因此，关于多项式次数 $p$ 的表达式是 $2p+1$。",
            "answer": "$$\n\\boxed{2p+1}\n$$"
        },
        {
            "introduction": "理论模型通常建立在简单区域上，但实际工程问题往往涉及复杂的几何形状。本练习将带你超越简单的矩形区域，探讨如何处理曲线边界。我们将聚焦于分部积分产生的边界项（例如，诺伊曼边界条件），并研究几何近似（例如，用弦代替弧）如何影响这些项的计算精度，从而将抽象的变量变换理论与实际的数值误差联系起来。",
            "id": "3457854",
            "problem": "考虑单个曲线有限元子域 $K \\subset \\mathbb{R}^{2}$ 上的标量泊松问题，其一条边界边 $\\Gamma \\subset \\partial K$ 位于半径为 $R>0$ 的圆弧上。令 $u \\in H^{1}(K)$ 为试探函数，$v \\in H^{1}(K)$ 为测试函数。假设在 $\\Gamma$ 上有诺伊曼边界条件 $\\kappa \\nabla u \\cdot n = g$，其中 $\\kappa>0$ 为常数，$g$ 在 $\\Gamma$ 上足够光滑，并在其余边界上为齐次数据。通过分部积分得到的在 $K$ 上的弱形式为\n$$\n\\int_{K} \\kappa \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x - \\int_{\\Gamma} g \\, v \\, \\mathrm{d}s = \\int_{K} f \\, v \\, \\mathrm{d}x.\n$$\n令 $F : \\hat{K} \\to K$ 是从具有 $(\\xi,\\eta)$ 坐标的参考正方形 $\\hat{K} = [-1,1] \\times [-1,1]$ 到 $K$ 的等参映射。假设顶部参考边 $\\hat{e} = \\{ (\\xi,\\eta) \\in \\hat{K} : \\eta = 1, \\, \\xi \\in [-1,1] \\}$ 通过由圆弧参数化给出的边限制 $F_{e}(\\xi) = \\left( x(\\xi), y(\\xi) \\right)$ 映射到曲线边界 $\\Gamma$\n$$\nx(\\xi) = R \\cos\\big(\\theta(\\xi)\\big), \\quad y(\\xi) = R \\sin\\big(\\theta(\\xi)\\big), \\quad \\theta(\\xi) = \\theta_{c} + \\frac{\\Delta \\theta}{2} \\, \\xi,\n$$\n其中 $\\theta_{c} \\in \\mathbb{R}$ 为固定值，张角 $\\Delta \\theta \\in (0,\\pi]$。假设试探空间和测试空间由标准等参二次映射构造：$K$ 上的离散空间是 $\\hat{K}$ 上2次张量积多项式空间的拉回，并且在边界边 $\\hat{e}$ 上，边中点基函数限制为 $\\hat{N}_{m}(\\xi) = 1 - \\xi^{2}$。\n\n弱形式中的边界积分在映射 $F$ 下变换为\n$$\n\\int_{\\Gamma} g \\, v \\, \\mathrm{d}s \\;=\\; \\int_{-1}^{1} \\hat{g}(\\xi) \\, \\hat{v}(\\xi) \\, J_{e}(\\xi) \\, \\mathrm{d}\\xi,\n$$\n其中 $\\hat{g}(\\xi) = g\\big(F_{e}(\\xi)\\big)$，$\\hat{v}(\\xi) = v\\big(F_{e}(\\xi)\\big)$，以及 $J_{e}(\\xi) = \\left| \\frac{\\partial F_{e}}{\\partial \\xi}(\\xi) \\right|$ 是沿曲线边的一维雅可比（度量）。在许多数值实现中，度量 $J_{e}(\\xi)$ 通过将其直弦替换曲线边来近似，即通过从 $\\hat{e}$ 到连接端点 $F_{e}(-1)$ 和 $F_{e}(1)$ 的弦的线性映射，这会产生一个常数弦雅可比 $J_{\\mathrm{chord}}$。\n\n假设诺伊曼数据在 $\\Gamma$ 上为常数，即 $g \\equiv \\bar{g}$，其中 $\\bar{g} \\in \\mathbb{R}$。考虑离散测试函数，其在 $\\Gamma$ 上的限制是边中点基函数 $\\hat{N}_{m}(\\xi) = 1 - \\xi^{2}$ 的拉回。令 $L_{\\mathrm{exact}}$ 表示精确的边界线性泛函贡献，而 $L_{\\mathrm{approx}}$ 表示通过用弦雅可比近似度量所获得的贡献。定义由度量引起的边界求积误差\n$$\nE \\;=\\; L_{\\mathrm{exact}} \\;-\\; L_{\\mathrm{approx}}.\n$$\n仅使用给定的设置和第一性原理（变量代换和散度定理），以 $\\bar{g}$、$R$ 和 $\\Delta \\theta$ 的形式显式地推导出 $E$ 的闭式解。假设所有量都是无量纲的。您的最终答案必须是一个单一的闭式解析表达式，不含未计算的积分或极限。",
            "solution": "目标是计算由度量引起的边界求积误差 $E$，其定义为精确边界积分贡献 $L_{\\mathrm{exact}}$ 与近似贡献 $L_{\\mathrm{approx}}$ 之间的差值。\n$$\nE = L_{\\mathrm{exact}} - L_{\\mathrm{approx}}\n$$\n问题指明诺伊曼边界数据 $g$ 为常数 $g \\equiv \\bar{g}$，并且选择的测试函数 $v$ 使其到参考边 $\\hat{e} = [-1,1]$ 的拉回是二次基函数 $\\hat{v}(\\xi) = \\hat{N}_{m}(\\xi) = 1 - \\xi^{2}$。\n\n在曲线边 $\\Gamma$ 上的边界积分变换为在参考区间 $[-1,1]$ 上的积分：\n$$\n\\int_{\\Gamma} g \\, v \\, \\mathrm{d}s = \\int_{-1}^{1} g(F_e(\\xi)) \\, v(F_e(\\xi)) \\, J_e(\\xi) \\, \\mathrm{d}\\xi = \\int_{-1}^{1} \\hat{g}(\\xi) \\, \\hat{v}(\\xi) \\, J_e(\\xi) \\, \\mathrm{d}\\xi\n$$\n其中 $J_e(\\xi)$ 是从 $\\hat{e}$ 到 $\\Gamma$ 的变换的雅可比。问题提供了圆弧 $\\Gamma$ 的参数化为 $F_e(\\xi)$。我们将其解释为真实几何，其雅可比将用于“精确”计算。提及“等参映射”是为了说明参考单元上多项式基函数的来源，但并不意味着在精确计算中几何本身是一个近似的抛物线。\n\n给定常数 $g = \\bar{g}$ 和指定的拉回测试函数 $\\hat{v}(\\xi) = 1-\\xi^2$，精确和近似的线性泛函为：\n$$\nL_{\\mathrm{exact}} = \\int_{-1}^{1} \\bar{g} (1 - \\xi^{2}) J_e(\\xi) \\, \\mathrm{d}\\xi\n$$\n$$\nL_{\\mathrm{approx}} = \\int_{-1}^{1} \\bar{g} (1 - \\xi^{2}) J_{\\mathrm{chord}} \\, \\mathrm{d}\\xi\n$$\n其中 $J_e(\\xi)$ 是圆弧参数化的精确度量（雅可比），而 $J_{\\mathrm{chord}}$ 是其基于弦长的近似。\n\n首先，我们推导精确度量 $J_e(\\xi)$。弧 $\\Gamma$ 的参数化由 $F_e(\\xi) = (x(\\xi), y(\\xi))$ 给出，其中\n$$\nx(\\xi) = R \\cos\\big(\\theta(\\xi)\\big), \\quad y(\\xi) = R \\sin\\big(\\theta(\\xi)\\big), \\quad \\theta(\\xi) = \\theta_{c} + \\frac{\\Delta \\theta}{2} \\xi\n$$\n映射关于 $\\xi$ 的导数是 $\\frac{\\partial F_e}{\\partial \\xi} = \\left(\\frac{\\mathrm{d}x}{\\mathrm{d}\\xi}, \\frac{\\mathrm{d}y}{\\mathrm{d}\\xi}\\right)$。我们有 $\\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\xi} = \\frac{\\Delta\\theta}{2}$。\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} = -R \\sin(\\theta(\\xi)) \\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\xi} = -R \\frac{\\Delta\\theta}{2} \\sin(\\theta(\\xi))\n$$\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}\\xi} = R \\cos(\\theta(\\xi)) \\frac{\\mathrm{d}\\theta}{\\mathrm{d}\\xi} = R \\frac{\\Delta\\theta}{2} \\cos(\\theta(\\xi))\n$$\n度量 $J_e(\\xi)$ 是该切向量的模长：\n$$\nJ_e(\\xi) = \\left| \\frac{\\partial F_e}{\\partial \\xi} \\right| = \\sqrt{\\left(\\frac{\\mathrm{d}x}{\\mathrm{d}\\xi}\\right)^2 + \\left(\\frac{\\mathrm{d}y}{\\mathrm{d}\\xi}\\right)^2}\n= \\sqrt{\\left(-R \\frac{\\Delta\\theta}{2} \\sin(\\theta(\\xi))\\right)^2 + \\left(R \\frac{\\Delta\\theta}{2} \\cos(\\theta(\\xi))\\right)^2}\n$$\n$$\nJ_e(\\xi) = \\sqrt{R^2 \\left(\\frac{\\Delta\\theta}{2}\\right)^2 \\left(\\sin^2(\\theta(\\xi)) + \\cos^2(\\theta(\\xi))\\right)} = \\sqrt{R^2 \\left(\\frac{\\Delta\\theta}{2}\\right)^2} = \\left| R \\frac{\\Delta\\theta}{2} \\right|\n$$\n给定 $R > 0$ 和 $\\Delta\\theta \\in (0, \\pi]$，$J_e(\\xi)$ 是一个正常数：\n$$\nJ_e(\\xi) = R \\frac{\\Delta\\theta}{2}\n$$\n现在我们计算 $L_{\\mathrm{exact}}$：\n$$\nL_{\\mathrm{exact}} = \\int_{-1}^{1} \\bar{g} (1 - \\xi^{2}) \\left(R \\frac{\\Delta\\theta}{2}\\right) \\, \\mathrm{d}\\xi = \\bar{g} R \\frac{\\Delta\\theta}{2} \\int_{-1}^{1} (1 - \\xi^{2}) \\, \\mathrm{d}\\xi\n$$\n该积分计算结果为：\n$$\n\\int_{-1}^{1} (1 - \\xi^{2}) \\, \\mathrm{d}\\xi = \\left[\\xi - \\frac{\\xi^3}{3}\\right]_{-1}^{1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) = \\frac{2}{3} - \\left(-1 + \\frac{1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}\n$$\n将此结果代回，得到 $L_{\\mathrm{exact}}$：\n$$\nL_{\\mathrm{exact}} = \\bar{g} R \\frac{\\Delta\\theta}{2} \\cdot \\frac{4}{3} = \\frac{2}{3} \\bar{g} R \\Delta\\theta\n$$\n接下来，我们推导近似的弦雅可比 $J_{\\mathrm{chord}}$。它是由从 $\\hat{e}=[-1,1]$（长度为2）到连接端点 $F_e(-1)$ 和 $F_e(1)$ 的弦的线性映射所产生的。设该弦的长度为 $L_{\\mathrm{chord}}$。\n端点对应的角度为 $\\theta_{-1} = \\theta_c - \\frac{\\Delta\\theta}{2}$ 和 $\\theta_{1} = \\theta_c + \\frac{\\Delta\\theta}{2}$。坐标为 $P_{-1} = (R\\cos\\theta_{-1}, R\\sin\\theta_{-1})$ 和 $P_{1} = (R\\cos\\theta_{1}, R\\sin\\theta_{1})$。\n弦长的平方是：\n$$\nL_{\\mathrm{chord}}^2 = (R\\cos\\theta_{1} - R\\cos\\theta_{-1})^2 + (R\\sin\\theta_{1} - R\\sin\\theta_{-1})^2\n$$\n使用三角恒等式 $\\cos A - \\cos B = -2\\sin\\frac{A+B}{2}\\sin\\frac{A-B}{2}$ 和 $\\sin A - \\sin B = 2\\cos\\frac{A+B}{2}\\sin\\frac{A-B}{2}$，其中 $\\frac{A+B}{2}=\\theta_c$ 和 $\\frac{A-B}{2}=\\frac{\\Delta\\theta}{2}$：\n$$\nL_{\\mathrm{chord}}^2 = R^2 \\left(-2\\sin\\theta_c\\sin\\frac{\\Delta\\theta}{2}\\right)^2 + R^2 \\left(2\\cos\\theta_c\\sin\\frac{\\Delta\\theta}{2}\\right)^2\n$$\n$$\nL_{\\mathrm{chord}}^2 = 4R^2\\sin^2\\left(\\frac{\\Delta\\theta}{2}\\right) \\left(\\sin^2\\theta_c + \\cos^2\\theta_c\\right) = 4R^2\\sin^2\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n因为 $\\Delta\\theta \\in (0, \\pi]$，所以 $\\frac{\\Delta\\theta}{2} \\in (0, \\pi/2]$，因此 $\\sin(\\frac{\\Delta\\theta}{2}) \\ge 0$。于是，\n$$\nL_{\\mathrm{chord}} = 2R\\sin\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n常数弦雅可比是弦长与参考区间长度之比：\n$$\nJ_{\\mathrm{chord}} = \\frac{L_{\\mathrm{chord}}}{2} = \\frac{2R\\sin(\\frac{\\Delta\\theta}{2})}{2} = R\\sin\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n现在我们计算 $L_{\\mathrm{approx}}$：\n$$\nL_{\\mathrm{approx}} = \\int_{-1}^{1} \\bar{g} (1 - \\xi^{2}) J_{\\mathrm{chord}} \\, \\mathrm{d}\\xi = \\bar{g} R \\sin\\left(\\frac{\\Delta\\theta}{2}\\right) \\int_{-1}^{1} (1 - \\xi^{2}) \\, \\mathrm{d}\\xi\n$$\n使用相同的积分值 $\\frac{4}{3}$：\n$$\nL_{\\mathrm{approx}} = \\bar{g} R \\sin\\left(\\frac{\\Delta\\theta}{2}\\right) \\cdot \\frac{4}{3} = \\frac{4}{3} \\bar{g} R \\sin\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n最后，我们计算误差 $E = L_{\\mathrm{exact}} - L_{\\mathrm{approx}}$：\n$$\nE = \\frac{2}{3} \\bar{g} R \\Delta\\theta - \\frac{4}{3} \\bar{g} R \\sin\\left(\\frac{\\Delta\\theta}{2}\\right)\n$$\n提取公因式，得到误差的最终表达式：\n$$\nE = \\frac{2}{3} \\bar{g} R \\left( \\Delta\\theta - 2\\sin\\left(\\frac{\\Delta\\theta}{2}\\right) \\right)\n$$",
            "answer": "$$\\boxed{\\frac{2}{3} \\bar{g} R \\left( \\Delta\\theta - 2\\sin\\left(\\frac{\\Delta\\theta}{2}\\right) \\right)}$$"
        },
        {
            "introduction": "在大规模模拟中，对整个计算域使用单一的均匀网格往往不切实际。本练习将探讨一种强大的区域分解技术——砂浆法（mortar method），以处理非匹配网格。你将看到，在子区域上分别应用分部积分会自然地引出界面项，而这些界面项可以通过拉格朗日乘子来处理，从而形成一个鞍点问题。此练习的挑战在于分析该方法的稳定性，这对于保证数值解的可靠性至关重要，并能加深你对试探和检验空间选择的理解。",
            "id": "3457912",
            "problem": "考虑单位正方形域 $\\Omega = (0,1)\\times(0,1)$ 上的标量泊松问题，其偏微分方程(PDE)为 $-\\Delta u = f$ in $\\Omega$，并带有齐次狄利克雷边界条件 $u=0$ on $\\partial\\Omega$。将 $\\Omega$ 分解为两个不重叠的子域 $\\Omega_1 = (0,1/2)\\times(0,1)$ 和 $\\Omega_2 = (1/2,1)\\times(0,1)$，交界面为 $\\Gamma = \\{1/2\\}\\times(0,1)$。令 $u_1$ 和 $u_2$ 分别表示 $u$ 在 $\\Omega_1$ 和 $\\Omega_2$ 上的限制。通过在 $\\Omega_1$ 和 $\\Omega_2$ 上分别使用分部积分法，构建一个鞍点弱问题，其中跨 $\\Gamma$ 的迹的连续性由一个定义在 $\\Gamma$ 上的拉格朗日乘子 $\\lambda$ 以弱形式施加，其交界面双线性形式为 $\\int_{\\Gamma} \\lambda\\,(u_1 - u_2)\\,\\mathrm{d}s$ 类型。确定 $u_i$ 的合适试探空间和 $\\lambda$ 的测试空间，并清晰地陈述最终的耦合变分格式。\n\n接下来，考虑一个非匹配网格设置：在 $\\Omega_1$ 上使用网格尺寸为 $h_1 = h$ 的拟一致协调三角剖分和分片线性连续有限元；在 $\\Omega_2$ 上使用网格尺寸为 $h_2 = 2h$ 的拟一致协调三角剖分和分片线性连续有限元。因此，离散函数在 $\\Gamma$ 上的迹是非匹配的。在 $\\Gamma$ 上，定义一个砂浆乘子空间 $M_h$，由 $\\Gamma$ 的一个划分为长度为 $2h$ 的线段（与较粗的右侧迹网格相匹配）上的分片常数函数组成。考虑乘子空间上的两种范数：\n- 第一种选择是 $L^2(\\Gamma)$ 范数，即 $\\|\\lambda_h\\|_{M} = \\|\\lambda_h\\|_{L^2(\\Gamma)}$。\n- 第二种选择是 $H^{-1/2}(\\Gamma)$ 范数，即 $\\|\\lambda_h\\|_{M} = \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}$，理解为 $H^{1/2}(\\Gamma)$ 迹空间的对偶范数。\n\n设原始离散空间为 $V_h = V_{1,h}\\times V_{2,h}$，其中 $V_{i,h}\\subset H^1(\\Omega_i)$ 是相应的分片线性协调有限元空间，并为 $V_h$ 配备能量范数 $\\|(u_{1,h},u_{2,h})\\|_V = \\left(\\|\\nabla u_{1,h}\\|_{L^2(\\Omega_1)}^2 + \\|\\nabla u_{2,h}\\|_{L^2(\\Omega_2)}^2\\right)^{1/2}$。定义交界面双线性形式 $b(\\lambda_h,(u_{1,h},u_{2,h})) = \\int_{\\Gamma} \\lambda_h\\left(\\gamma u_{1,h} - \\gamma u_{2,h}\\right)\\,\\mathrm{d}s$，其中 $\\gamma$ 表示到 $\\Gamma$ 上的迹算子。\n\n对于每种砂浆范数的选择，通过离散inf-sup常数分析耦合鞍点问题的稳定性\n$$\n\\beta_M(h) \\;=\\; \\inf_{\\lambda_h\\in M_h\\setminus\\{0\\}} \\;\\sup_{(u_{1,h},u_{2,h})\\in V_h\\setminus\\{0\\}} \\;\\frac{b(\\lambda_h,(u_{1,h},u_{2,h}))}{\\|\\lambda_h\\|_{M}\\,\\|(u_{1,h},u_{2,h})\\|_V}\\,.\n$$\n从基本定律和核心定义（分部积分法、迹定理、$H^{1/2}(\\Gamma)$ 和 $H^{-1/2}(\\Gamma)$ 的对偶性以及有限元空间的标准性质）出发，推导当 $h\\to 0$ 时，对于两种砂浆范数的选择，$\\beta_M(h)$ 的主阶渐近尺度。特别地，确定指数 $\\alpha_{L^2}$ 和 $\\alpha_{H^{-1/2}}$，使得 $\\beta_{L^2}(h) \\approx C\\,h^{\\alpha_{L^2}}$ 和 $\\beta_{H^{-1/2}}(h) \\approx C'\\,h^{\\alpha_{H^{-1/2}}}$，其中 $C$ 和 $C'$ 是与 $h$ 无关的正常数。\n\n你的最终答案必须是这对指数，形式为单行矩阵。无需四舍五入，也不涉及物理单位。以其精确的解析形式表示该行矩阵。",
            "solution": "该问题分为两个主要部分：首先，推导在分解域上的泊松问题的鞍点弱格式；其次，对该格式的特定非匹配网格离散化进行稳定性分析。\n\n### 第1部分：连续弱格式\n\n我们从两个子域 $\\Omega_1$ 和 $\\Omega_2$ 上的泊松问题强形式开始：\n$$\n\\begin{cases}\n-\\Delta u_1 = f  \\text{ in } \\Omega_1, \\\\\n-\\Delta u_2 = f  \\text{ in } \\Omega_2.\n\\end{cases}\n$$\n全局解 $u$ 被要求在交界面 $\\Gamma$ 上连续且具有连续的法向通量，并在外部边界 $\\partial\\Omega$ 上满足齐次狄利克雷条件 $u=0$。这对 $u_1$ 和 $u_2$ 转化为以下条件：\n\\begin{enumerate}\n    \\item 边界条件：在 $\\partial\\Omega_1 \\cap \\partial\\Omega$ 上 $u_1=0$，在 $\\partial\\Omega_2 \\cap \\partial\\Omega$ 上 $u_2=0$。\n    \\item 在 $\\Gamma$ 上的交界面条件：\n        \\begin{itemize}\n            \\item 解的连续性：$u_1 = u_2$。\n            \\item 法向通量的连续性：$\\frac{\\partial u_1}{\\partial n_1} + \\frac{\\partial u_2}{\\partial n_2} = 0$，其中 $n_1$ 和 $n_2$ 分别是 $\\Omega_1$ 和 $\\Omega_2$ 的单位外法向量。在 $\\Gamma$ 上，我们有 $n_1 = -n_2$。\n        \\end{itemize}\n\\end{enumerate}\n\n为了推导弱格式，我们引入测试函数 $v_1$ 和 $v_2$。我们定义试探函数 $(u_1, u_2)$ 和测试函数 $(v_1, v_2)$ 的函数空间为 $V = V_1 \\times V_2$，其中\n$$ V_i = \\{w \\in H^1(\\Omega_i) \\mid w = 0 \\text{ on } \\partial\\Omega_i \\cap \\partial\\Omega \\}, \\quad \\text{for } i=1,2. $$\n我们在每个子域中将PDE乘以相应的测试函数 $v_i \\in V_i$ 并在 $\\Omega_i$ 上积分。应用分部积分法（格林第一恒等式），我们得到：\n$$\n\\int_{\\Omega_1} \\nabla u_1 \\cdot \\nabla v_1 \\, \\mathrm{d}x - \\int_{\\partial\\Omega_1} v_1 \\frac{\\partial u_1}{\\partial n_1} \\, \\mathrm{d}s = \\int_{\\Omega_1} f v_1 \\, \\mathrm{d}x.\n$$\n$$\n\\int_{\\Omega_2} \\nabla u_2 \\cdot \\nabla v_2 \\, \\mathrm{d}x - \\int_{\\partial\\Omega_2} v_2 \\frac{\\partial u_2}{\\partial n_2} \\, \\mathrm{d}s = \\int_{\\Omega_2} f v_2 \\, \\mathrm{d}x.\n$$\n由于在 $\\partial\\Omega_i \\cap \\partial\\Omega$ 上 $v_i=0$，边界积分仅在交界面 $\\Gamma$ 上非零。将这两个方程相加得到：\n$$\n\\sum_{i=1,2} \\int_{\\Omega_i} \\nabla u_i \\cdot \\nabla v_i \\, \\mathrm{d}x - \\int_{\\Gamma} \\left( v_1 \\frac{\\partial u_1}{\\partial n_1} + v_2 \\frac{\\partial u_2}{\\partial n_2} \\right) \\mathrm{d}s = \\sum_{i=1,2} \\int_{\\Omega_i} f v_i \\, \\mathrm{d}x.\n$$\n通量连续性条件可用于在交界面上定义一个单一的量，即拉格朗日乘子 $\\lambda$，它代表通量。我们定义 $\\lambda = \\frac{\\partial u_1}{\\partial n_1}|_\\Gamma$。根据通量连续性，我们有 $\\frac{\\partial u_2}{\\partial n_2}|_\\Gamma = -\\lambda$。将其代入交界面积分中得到：\n$$\n\\int_{\\Gamma} \\left(v_1 \\lambda - v_2 \\lambda \\right) \\mathrm{d}s = \\int_{\\Gamma} \\lambda (v_1 - v_2) \\, \\mathrm{d}s.\n$$\n在 $\\Gamma$ 上的连续性条件 $u_1=u_2$ 是弱施加的。我们引入一个乘子测试空间 $M$。对于连续问题，乘子 $\\lambda$（代表通量，即法向导数）的合适空间是 $M = H^{-1/2}(\\Gamma)$，即迹空间 $H^{1/2}(\\Gamma)$ 的对偶空间。连续性的弱施加表示为：\n$$\n\\int_{\\Gamma} \\mu (u_1 - u_2) \\, \\mathrm{d}s = 0, \\quad \\forall \\mu \\in M.\n$$\n现在我们组合成完整的鞍点问题。设 $u=(u_1, u_2)$ 和 $v=(v_1, v_2)$。定义双线性形式和线性泛函：\n$$\na(u,v) = \\sum_{i=1,2} \\int_{\\Omega_i} \\nabla u_i \\cdot \\nabla v_i \\, \\mathrm{d}x,\n$$\n$$\nb(\\mu, v) = \\int_{\\Gamma} \\mu (\\gamma v_1 - \\gamma v_2) \\, \\mathrm{d}s,\n$$\n$$\nL(v) = \\sum_{i=1,2} \\int_{\\Omega_i} f v_i \\, \\mathrm{d}x.\n$$\n这里，$\\gamma$ 是到 $\\Gamma$ 上的迹算子。问题陈述建议在第一个变分方程中使用带正号的双线性形式 $b(\\lambda, v)$。这对应于定义 $\\lambda = -\\frac{\\partial u_1}{\\partial n_1}|_\\Gamma$。根据这个约定，系统是：\n求 $(u, \\lambda) \\in V \\times M$ 使得\n$$\n\\begin{cases}\na(u,v) + b(\\lambda,v) = L(v)  \\forall v \\in V, \\\\\nb(\\mu, u) = 0  \\forall \\mu \\in M.\n\\end{cases}\n$$\n这就是耦合变分格式。\n\n### 第2部分：离散稳定性分析\n\n现在我们分析给定离散化的稳定性。离散空间是 $V_h = V_{1,h} \\times V_{2,h}$ 和 $M_h$。稳定性由离散inf-sup（或LBB）常数决定：\n$$\n\\beta_M(h) \\;=\\; \\inf_{\\lambda_h\\in M_h\\setminus\\{0\\}} \\;\\sup_{v_h\\in V_h\\setminus\\{0\\}} \\;\\frac{b(\\lambda_h,v_h)}{\\|\\lambda_h\\|_{M}\\,\\|v_h\\|_V}\\,,\n$$\n其中 $v_h=(v_{1,h}, v_{2,h})$ 且 $\\|v_h\\|_V^2 = \\|\\nabla v_{1,h}\\|_{L^2(\\Omega_1)}^2 + \\|\\nabla v_{2,h}\\|_{L^2(\\Omega_2)}^2$。我们需要找到对于两种范数 $\\|\\cdot\\|_M$ 的选择，$\\beta_M(h)$ 随 $h$ 变化的尺度关系。\n\n#### 情况1：$H^{-1/2}(\\Gamma)$ 范数\n\n第一种选择是 $\\|\\lambda_h\\|_M = \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}$。该范数通过对偶性定义：\n$$\n\\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)} = \\sup_{g \\in H^{1/2}(\\Gamma) \\setminus \\{0\\}} \\frac{\\langle \\lambda_h, g \\rangle_{\\Gamma}}{\\|g\\|_{H^{1/2}(\\Gamma)}},\n$$\n其中 $\\langle\\cdot,\\cdot\\rangle_{\\Gamma}$ 是 $L^2(\\Gamma)$ 内积，它表示 $H^{-1/2}(\\Gamma)$ 和 $H^{1/2}(\\Gamma)$ 之间的对偶配对。\n\n所选的离散化方案，即在非匹配网格（$h$ 和 $2h$）上使用分片线性元，以及在较粗网格（$2h$）上使用分片常数乘子，是一个稳定的砂浆有限元方法的标准例子。砂浆方法理论中的一个基本结果（由 Bernardi、Maday 和 Patera 提出）指出，对于这样的空间选择，离散inf-sup常数有一个与网格尺寸 $h$ 无关的正常数下界。即，\n$$\n\\beta_{H^{-1/2}}(h) \\ge \\beta_0 > 0,\n$$\n对于某个不依赖于 $h$ 的常数 $\\beta_0$。这种一致稳定性是在实践中选择这种特定乘子空间的原因。由于 $\\beta_{H^{-1/2}}(h)$ 有一个正常数下界，其主阶渐近尺度为常数。\n$$\n\\beta_{H^{-1/2}}(h) \\approx C' h^0.\n$$\n因此，指数为 $\\alpha_{H^{-1/2}} = 0$。\n\n#### 情况2：$L^2(\\Gamma)$ 范数\n\n第二种选择是 $\\|\\lambda_h\\|_M = \\|\\lambda_h\\|_{L^2(\\Gamma)}$。inf-sup常数为\n$$\n\\beta_{L^2}(h) \\;=\\; \\inf_{\\lambda_h\\in M_h\\setminus\\{0\\}} \\;\\sup_{v_h\\in V_h\\setminus\\{0\\}} \\;\\frac{b(\\lambda_h,v_h)}{\\|\\lambda_h\\|_{L^2(\\Gamma)}\\,\\|v_h\\|_V}\\,.\n$$\n我们可以通过分析离散乘子空间 $M_h$ 上 $L^2(\\Gamma)$ 和 $H^{-1/2}(\\Gamma)$ 范数之间的关系，将 $\\beta_{L^2}(h)$ 与 $\\beta_{H^{-1/2}}(h)$ 联系起来。对于任何 $\\lambda_h \\in M_h$，我们可以写出：\n$$\n\\sup_{v_h\\in V_h} \\frac{b(\\lambda_h,v_h)}{\\|v_h\\|_V} \\ge \\beta_{H^{-1/2}}(h) \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)} \\ge \\beta_0 \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}.\n$$\n将此代入 $\\beta_{L^2}(h)$ 的表达式中：\n$$\n\\beta_{L^2}(h) = \\inf_{\\lambda_h\\in M_h} \\frac{\\sup_{v_h} b(\\lambda_h,v_h)/\\|v_h\\|_V}{\\|\\lambda_h\\|_{L^2(\\Gamma)}} \\ge \\beta_0 \\inf_{\\lambda_h\\in M_h} \\frac{\\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}}{\\|\\lambda_h\\|_{L^2(\\Gamma)}}.\n$$\n因此，分析转向寻找范数比率的下确界的尺度关系。对于定义在尺寸为 $H$ 的拟一致网格上的有限元空间，一个标准的逆不等式成立。空间 $M_h$ 由尺寸为 $H=2h$ 的 $\\Gamma$ 划分上的分片常数函数组成。关联 $L^2$ 和 $H^{-1/2}$ 范数的相关逆不等式是：\n$$\n\\|\\lambda_h\\|_{L^2(\\Gamma)} \\le C H^{-1/2} \\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)} \\quad \\forall \\lambda_h \\in M_h.\n$$\n整理这个不等式，我们得到：\n$$\n\\frac{\\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}}{\\|\\lambda_h\\|_{L^2(\\Gamma)}} \\ge C^{-1} H^{1/2} = C^{-1} (2h)^{1/2}.\n$$\n此不等式对所有 $\\lambda_h \\in M_h$ 成立，因此在 $M_h$ 上的下确界也必须满足此尺度关系：\n$$\n\\inf_{\\lambda_h\\in M_h} \\frac{\\|\\lambda_h\\|_{H^{-1/2}(\\Gamma)}}{\\|\\lambda_h\\|_{L^2(\\Gamma)}} \\ge C' h^{1/2}.\n$$\n这为inf-sup常数的尺度关系提供了一个下界：$\\beta_{L^2}(h) \\ge \\beta_0 C' h^{1/2}$。\n\n为了证明这个尺度关系是紧的，我们必须证明 $\\beta_{L^2}(h) \\le C'' h^{1/2}$。这通常通过构造一个“最坏情况”的乘子函数 $\\lambda_h^* \\in M_h$ 来完成，对于该函数，在 $v_h$ 上的上确界很小。一个典型的选择是高度振荡的函数，例如在粗划分（尺寸为$2h$）的相邻段上交替变号的“棋盘”函数。设 $\\lambda_h^*$ 是这样一个函数，归一化使得 $\\|\\lambda_h^*\\|_{L^2(\\Gamma)}=1$。\n对于这个特定选择，可以证明\n$$ \\sup_{v_h\\in V_h\\setminus\\{0\\}} \\frac{b(\\lambda_h^*, v_h)}{\\|v_h\\|_V} \\le C'' h^{1/2}. $$\n这个界源于一种抵消效应。对于这种砂浆设置，一个已知的性质是，对于棋盘乘子 $\\lambda_h^*$，涉及粗网格函数的项会消失：对于所有 $V_{2,h}$ 迹空间中的 $v_{2,h}$，$\\int_\\Gamma \\lambda_h^* v_{2,h}\\,\\mathrm{d}s = 0$。于是上确界由项 $\\int_\\Gamma \\lambda_h^* v_{1,h}\\,\\mathrm{d}s$ 决定。网格尺寸的失配（$v_{1,h}$ 的 $h$ 对比 $\\lambda_h^*$ 的 $2h$）导致此项的阶为 $h^{1/2} \\|\\nabla v_{1,h}\\|_{L^2(\\Omega_1)}$。\n这证实了该尺度关系确实是紧的。\n$$\n\\beta_{L^2}(h) \\approx C h^{1/2}.\n$$\n因此，指数为 $\\alpha_{L^2} = 1/2$。\n\n这对指数是 $(\\alpha_{L^2}, \\alpha_{H^{-1/2}})$。\n\n最终指数：\n$\\alpha_{L^2} = 1/2$\n$\\alpha_{H^{-1/2}} = 0$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} & 0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}