{
    "hands_on_practices": [
        {
            "introduction": "Theoretical convergence rates are a cornerstone of finite element analysis, but how can we be sure our code implements the theory correctly? This first practice is a fundamental exercise in code verification using the method of manufactured solutions. By implementing a simple 1D finite element solver and performing a log-log analysis of the error, you will empirically confirm the predicted convergence rates in the $H^1(\\Omega)$ and $L^2(\\Omega)$ norms, bridging the gap between abstract theory and concrete numerical results .",
            "id": "3374906",
            "problem": "Consider the scalar second-order Partial Differential Equation (PDE) $-u''(x)=f(x)$ on the interval $\\Omega=(0,1)$ with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. Let the exact solution be a manufactured function $u(x)=\\sin(k\\pi x)$ for an integer frequency parameter $k\\in\\mathbb{N}$, and define the right-hand side by $f(x)=-u''(x)=(k\\pi)^2\\sin(k\\pi x)$. The goal is to empirically confirm the algebraic convergence rates of the linear conforming Finite Element Method (FEM) in the Sobolev space $H^1(\\Omega)$-norm and the Lebesgue space $L^2(\\Omega)$-norm by performing a log–log slope analysis of the error versus the mesh size.\n\nStarting from the weak formulation in the Sobolev space $H_0^1(\\Omega)$, use a standard continuous piecewise-linear (hat-function) approximation over a sequence of uniform meshes with mesh size $h=1/N$ for $N\\in\\mathbb{N}$. For each mesh, assemble and solve the discrete linear system obtained from the Galerkin method. Compute the error in the $H^1(\\Omega)$-norm and in the $L^2(\\Omega)$-norm between the exact solution $u$ and the finite element approximation $u_h$. The $L^2(\\Omega)$-norm is defined by $\\|v\\|_{L^2(\\Omega)}=\\left(\\int_\\Omega |v(x)|^2\\,dx\\right)^{1/2}$, and the $H^1(\\Omega)$-norm is defined by $\\|v\\|_{H^1(\\Omega)}=\\left(\\|v\\|_{L^2(\\Omega)}^2+\\|v'\\|_{L^2(\\Omega)}^2\\right)^{1/2}$. Use high-order Gaussian quadrature to evaluate the necessary integrals with sufficient accuracy.\n\nImplement a log–log slope analysis as follows. For a sequence of uniform meshes with sizes $h_j$, compute the errors $E_{H^1}(h_j)=\\|u-u_h\\|_{H^1(\\Omega)}$ and $E_{L^2}(h_j)=\\|u-u_h\\|_{L^2(\\Omega)}$ for $j=1,\\dots,m$, where $m\\in\\mathbb{N}$ is the number of refinement levels. Fit a straight line to $(\\log h_j,\\log E(h_j))$ in the least-squares sense; the slope of this line is the empirical convergence rate. Repeat for both norms.\n\nYour program must:\n- Use the manufactured solution $u(x)=\\sin(k\\pi x)$ with the corresponding source $f(x)=(k\\pi)^2\\sin(k\\pi x)$.\n- Use a uniform mesh with $N$ elements and linear basis functions to assemble the stiffness matrix and load vector from first principles.\n- Impose homogeneous Dirichlet boundary conditions strongly.\n- Compute both $\\|u-u_h\\|_{L^2(\\Omega)}$ and $\\|u-u_h\\|_{H^1(\\Omega)}$ using sufficiently accurate Gaussian quadrature over each mesh element.\n- Perform a least-squares linear regression on $(\\log h,\\log E)$ to extract the empirical slopes for both norms.\n\nTest suite:\n- Case A (happy path): frequency $k=1$, initial number of elements $N_0=8$, number of refinement levels $m=5$ (refine by halving $h$, i.e., doubling $N$, at each level).\n- Case B (coarse-to-fine coverage): frequency $k=3$, initial number of elements $N_0=4$, number of refinement levels $m=5$.\n- Case C (higher frequency content): frequency $k=5$, initial number of elements $N_0=16$, number of refinement levels $m=4$.\n\nFor each case, output a pair of real numbers $[p_{H^1},p_{L^2}]$ where $p_{H^1}$ is the empirical log–log slope for the $H^1(\\Omega)$-norm and $p_{L^2}$ is the empirical log–log slope for the $L^2(\\Omega)$-norm. All real numbers must be printed rounded to three digits after the decimal point.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, one per test case, in the order A, B, C, for example, $[[p_{H^1}^{(A)},p_{L^2}^{(A)}],[p_{H^1}^{(B)},p_{L^2}^{(B)}],[p_{H^1}^{(C)},p_{L^2}^{(C)}]]$.\n- No additional text should be printed.",
            "solution": "The problem requires an empirical validation of the convergence rates for the linear finite element method (FEM) applied to a one-dimensional Poisson equation. The analysis will be performed by solving for a manufactured solution and then computing the slope of the error norms versus mesh size on a log-log scale.\n\nThe governing Partial Differential Equation (PDE) is:\n$$ -u''(x) = f(x) \\quad \\text{for } x \\in \\Omega=(0,1) $$\nwith homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. The problem specifies a manufactured solution $u(x)=\\sin(k\\pi x)$, where $k \\in \\mathbb{N}$ is an integer frequency parameter. The right-hand side, or source term, $f(x)$ is determined by substituting the exact solution into the PDE:\n$$ f(x) = -u''(x) = - \\frac{d^2}{dx^2}(\\sin(k\\pi x)) = (k\\pi)^2 \\sin(k\\pi x) $$\n\nThe FEM solution begins with the weak formulation of the problem. We multiply the PDE by a test function $v(x)$ from the Sobolev space $H_0^1(\\Omega)$, which is the space of functions that are square-integrable, have square-integrable first derivatives, and are zero at the boundaries $x=0$ and $x=1$. Integrating over the domain $\\Omega$ yields:\n$$ -\\int_0^1 u''(x)v(x) \\,dx = \\int_0^1 f(x)v(x) \\,dx $$\nApplying integration by parts to the left-hand side gives:\n$$ \\left[-u'(x)v(x)\\right]_0^1 + \\int_0^1 u'(x)v'(x) \\,dx = \\int_0^1 f(x)v(x) \\,dx $$\nSince $v \\in H_0^1(\\Omega)$, $v(0)=v(1)=0$, and the boundary term vanishes. This leads to the weak formulation: Find $u \\in H_0^1(\\Omega)$ such that\n$$ a(u,v) = L(v) \\quad \\forall v \\in H_0^1(\\Omega) $$\nwhere the bilinear form $a(u,v)$ and the linear functional $L(v)$ are defined as:\n$$ a(u,v) = \\int_0^1 u'(x)v'(x) \\,dx $$\n$$ L(v) = \\int_0^1 f(x)v(x) \\,dx $$\n\nFor the finite element discretization, we partition the domain $\\Omega=(0,1)$ into a uniform mesh of $N$ elements, each of length $h=1/N$. The nodes are located at $x_i = ih$ for $i=0, 1, \\dots, N$. We seek an approximate solution $u_h$ in a finite-dimensional subspace $V_h \\subset H_0^1(\\Omega)$. For this problem, $V_h$ is the space of continuous piecewise-linear functions over this mesh that are zero at $x=0$ and $x=1$. A basis for $V_h$ is given by the set of \"hat\" functions $\\{\\phi_i(x)\\}_{i=1}^{N-1}$, where $\\phi_i(x)$ is the unique linear function that is $1$ at node $x_i$ and $0$ at all other nodes $x_j$.\n\nThe FEM approximation $u_h(x)$ is written as a linear combination of these basis functions:\n$$ u_h(x) = \\sum_{j=1}^{N-1} U_j \\phi_j(x) $$\nwhere $U_j$ are the unknown coefficients, representing the value of the approximate solution at the interior nodes $x_j$. The Galerkin method requires that the weak form holds for all test functions in the discrete space $V_h$, i.e., for each basis function $\\phi_i$:\n$$ a(u_h, \\phi_i) = L(\\phi_i) \\quad \\text{for } i=1, \\dots, N-1 $$\nSubstituting the expansion for $u_h$ gives a system of linear equations:\n$$ \\sum_{j=1}^{N-1} U_j a(\\phi_j, \\phi_i) = L(\\phi_i) $$\nThis can be written in matrix form as $AU=F$, where:\n- $A$ is the $(N-1) \\times (N-1)$ stiffness matrix with entries $A_{ij} = a(\\phi_j, \\phi_i) = \\int_0^1 \\phi_i'(x)\\phi_j'(x) \\,dx$.\n- $F$ is the $(N-1) \\times 1$ load vector with entries $F_i = L(\\phi_i) = \\int_0^1 f(x)\\phi_i(x) \\,dx$.\n- $U$ is the vector of unknown coefficients $[U_1, \\dots, U_{N-1}]^T$.\n\nFor a uniform mesh with piecewise linear basis functions, the stiffness matrix entries can be calculated analytically. The derivative $\\phi_i'(x)$ is piecewise constant: $1/h$ on $(x_{i-1}, x_i)$ and $-1/h$ on $(x_i, x_{i+1})$. This results in a symmetric, tridiagonal stiffness matrix:\n$$ A_{ij} = \\begin{cases} 2/h  \\text{if } i=j \\\\ -1/h  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases} $$\nThe load vector entries $F_i = \\int_{x_{i-1}}^{x_{i+1}} (k\\pi)^2 \\sin(k\\pi x) \\phi_i(x) \\,dx$ must be computed numerically. This is done by summing contributions from each element using Gaussian quadrature to ensure high accuracy.\n\nAfter solving the linear system $AU=F$ for the nodal values $U$, the full FEM solution $u_h(x)$ is known. The error is $e(x) = u(x) - u_h(x)$. We compute the error in two norms:\n- The $L^2$-norm: $\\|e\\|_{L^2(\\Omega)} = \\left(\\int_0^1 (u(x)-u_h(x))^2 \\,dx\\right)^{1/2}$.\n- The $H^1$-norm: $\\|e\\|_{H^1(\\Omega)} = \\left(\\|e\\|_{L^2(\\Omega)}^2 + \\|e'\\|_{L^2(\\Omega)}^2\\right)^{1/2}$, where $\\|e'\\|_{L^2(\\Omega)} = \\left(\\int_0^1 (u'(x)-u_h'(x))^2 \\,dx\\right)^{1/2}$.\n\nThese integrals are calculated element by element using high-order Gaussian quadrature. On each element $[x_j, x_{j+1}]$, the integral of a function $g(x)$ is approximated by transforming to a reference element $[-1,1]$ and using a weighted sum of function evaluations at specific quadrature points.\n\nTo find the empirical convergence rate, we compute the errors for a sequence of progressively refined meshes. Let $h_j$ be the mesh size at refinement level $j$, and let $E(h_j)$ be the corresponding error ($E_{H^1}$ or $E_{L^2}$). If the error converges algebraically, i.e., $E(h) \\approx C h^p$ for some constant $C$ and rate $p$, then taking the logarithm yields $\\log(E) \\approx \\log(C) + p \\log(h)$. This is a linear relationship between $\\log(E)$ and $\\log(h)$, where the slope is the convergence rate $p$. We perform a least-squares linear regression on the set of points $(\\log(h_j), \\log(E(h_j)))$ to determine the slope $p$.\n\nFor linear finite elements, theoretical predictions state that the convergence rate is $p=1$ for the $H^1$-norm and $p=2$ for the $L^2$-norm, provided the solution is sufficiently smooth and the mesh is fine enough. The program implements this entire procedure to verify these rates for the given test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the FEM convergence study for the specified test cases.\n    \"\"\"\n\n    # Test cases: (k, N_initial, num_refinements)\n    test_cases = [\n        (1, 8, 5),  # Case A\n        (3, 4, 5),  # Case B\n        (5, 16, 4), # Case C\n    ]\n\n    all_results = []\n    for k, N0, m in test_cases:\n        p_h1, p_l2 = run_convergence_study(k, N0, m)\n        all_results.append([f\"{p_h1:.3f}\", f\"{p_l2:.3f}\"])\n\n    # Format the final output string as per requirements\n    list_of_strings = [f\"[{item[0]},{item[1]}]\" for item in all_results]\n    final_output = f\"[{','.join(list_of_strings)}]\"\n    print(final_output)\n\ndef run_convergence_study(k, N0, num_refinements):\n    \"\"\"\n    Performs a convergence study for a given frequency k, initial mesh size N0,\n    and a number of refinement levels.\n\n    Args:\n        k (int): Frequency parameter for the manufactured solution.\n        N0 (int): Initial number of elements.\n        num_refinements (int): Number of mesh refinement steps.\n\n    Returns:\n        tuple: A pair of floats (p_h1, p_l2) representing the convergence\n               rates for the H1 and L2 norms.\n    \"\"\"\n    hs = []\n    errors_l2 = []\n    errors_h1 = []\n\n    for i in range(num_refinements):\n        N = N0 * (2**i)\n        h = 1.0 / N\n        l2_err, h1_err = solve_fem_1d(k, N)\n\n        hs.append(h)\n        errors_l2.append(l2_err)\n        errors_h1.append(h1_err)\n\n    log_hs = np.log(hs)\n    log_errs_l2 = np.log(errors_l2)\n    log_errs_h1 = np.log(errors_h1)\n\n    # Perform least-squares fit to find the slope (convergence rate)\n    p_l2 = np.polyfit(log_hs, log_errs_l2, 1)[0]\n    p_h1 = np.polyfit(log_hs, log_errs_h1, 1)[0]\n\n    return p_h1, p_l2\n\ndef solve_fem_1d(k, N):\n    \"\"\"\n    Solves the 1D Poisson problem -u''=f on (0,1) with u(0)=u(1)=0 using linear FEM.\n\n    Args:\n        k (int): Frequency parameter of the manufactured solution.\n        N (int): Number of mesh elements.\n\n    Returns:\n        tuple: A pair of floats (l2_error, h1_error).\n    \"\"\"\n    h = 1.0 / N\n    num_unknowns = N - 1\n\n    # Define exact solution, its derivative, and the source function\n    u_exact = lambda x: np.sin(k * np.pi * x)\n    u_prime_exact = lambda x: k * np.pi * np.cos(k * np.pi * x)\n    f_source = lambda x: (k * np.pi)**2 * np.sin(k * np.pi * x)\n\n    # Assemble stiffness matrix A\n    diag = np.full(num_unknowns, 2.0 / h)\n    off_diag = np.full(num_unknowns - 1, -1.0 / h)\n    A = np.diag(diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n    \n    # Gaussian quadrature setup (5 points is sufficient for high accuracy)\n    NUM_QUAD_POINTS = 5\n    xi_q, w_q = np.polynomial.legendre.leggauss(NUM_QUAD_POINTS)\n\n    # Assemble load vector F\n    F = np.zeros(num_unknowns)\n    # Local basis functions on reference element [-1, 1]\n    phi_ref = [lambda xi: (1 - xi) / 2, lambda xi: (1 + xi) / 2]\n\n    for j in range(N):  # Loop over elements\n        x_left = j * h\n        f_loc = np.zeros(2)\n        for q_idx in range(NUM_QUAD_POINTS):\n            x_q_phys = x_left + h / 2 * (1 + xi_q[q_idx])\n            f_val = f_source(x_q_phys)\n            for i in range(2):\n                f_loc[i] += f_val * phi_ref[i](xi_q[q_idx]) * (h / 2) * w_q[q_idx]\n\n        # Add local contributions to global vector\n        if j  0:\n            F[j - 1] += f_loc[0]\n        if j  N - 1:\n            F[j] += f_loc[1]\n\n    # Solve linear system AU = F\n    U_sol = np.linalg.solve(A, F)\n\n    # Full solution vector including boundary nodes\n    U_h = np.concatenate(([0.0], U_sol, [0.0]))\n\n    # Compute L2 and H1 error norms\n    l2_error_sq = 0.0\n    h1_seminorm_error_sq = 0.0\n\n    for j in range(N):  # Loop over elements to compute error integrals\n        x_left = j * h\n        U_j, U_jp1 = U_h[j], U_h[j + 1]\n        u_h_prime_const = (U_jp1 - U_j) / h\n        \n        for q_idx in range(NUM_QUAD_POINTS):\n            x_q_phys = x_left + h / 2 * (1 + xi_q[q_idx])\n            \n            # Evaluate exact solution and its derivative\n            u_ex = u_exact(x_q_phys)\n            u_prime_ex = u_prime_exact(x_q_phys)\n\n            # Evaluate FEM solution and its derivative\n            u_h_val = U_j * phi_ref[0](xi_q[q_idx]) + U_jp1 * phi_ref[1](xi_q[q_idx])\n            \n            # Accumulate squared errors\n            jacobian = h / 2\n            l2_error_sq += (u_ex - u_h_val)**2 * jacobian * w_q[q_idx]\n            h1_seminorm_error_sq += (u_prime_ex - u_h_prime_const)**2 * jacobian * w_q[q_idx]\n\n    l2_error = np.sqrt(l2_error_sq)\n    h1_error = np.sqrt(l2_error_sq + h1_seminorm_error_sq)\n\n    return l2_error, h1_error\n\nsolve()\n```"
        },
        {
            "introduction": "In practice, the integrals for the stiffness and mass matrices are computed numerically, not analytically. This exercise delves into the theoretical consequences of this approximation, a topic known as 'variational crime'. You will derive the minimum quadrature accuracy required to ensure that numerical integration does not degrade the optimal convergence rates, providing crucial insight into the interplay between numerical analysis and practical implementation .",
            "id": "3374918",
            "problem": "Consider the reaction–diffusion boundary value problem on a bounded convex domain $\\Omega \\subset \\mathbb{R}^{d}$ with $d \\in \\{2,3\\}$: find $u \\in H_{0}^{1}(\\Omega)$ such that\n$$\na(u,v) \\equiv \\int_{\\Omega} \\left( \\nabla u \\cdot \\nabla v + u\\,v \\right)\\,dx \\;=\\; \\ell(v) \\equiv \\int_{\\Omega} f\\,v\\,dx \\quad \\text{for all } v \\in H_{0}^{1}(\\Omega),\n$$\nwhere $f \\in L^{2}(\\Omega)$ and $u \\in H^{p+1}(\\Omega)$ for a fixed integer $p \\geq 1$. Let $\\{\\mathcal{T}_{h}\\}_{h}$ be a family of shape-regular, quasi-uniform simplicial meshes of $\\Omega$ with mesh size $h$, and let $V_{h} \\subset H_{0}^{1}(\\Omega)$ be the standard Lagrange finite element space of continuous, piecewise polynomial functions of total degree at most $p$ on $\\mathcal{T}_{h}$.\n\nA conforming discrete method is defined by underintegration of the bilinear form on each element $K \\in \\mathcal{T}_{h}$:\n$$\na_{h}(u_{h},v_{h}) \\;=\\; \\sum_{K \\in \\mathcal{T}_{h}} \\Big( Q_{s}^{K}\\big( \\nabla u_{h} \\cdot \\nabla v_{h} \\big) \\;+\\; Q_{m}^{K}\\big( u_{h}\\,v_{h} \\big) \\Big),\n$$\nwith the discrete load taken to be exact, $\\ell_{h}(v_{h}) = \\ell(v_{h})$, and the discrete problem seeks $u_{h} \\in V_{h}$ such that\n$$\na_{h}(u_{h},v_{h}) \\;=\\; \\ell(v_{h}) \\quad \\text{for all } v_{h} \\in V_{h}.\n$$\nHere, for each element $K$, $Q_{s}^{K}$ and $Q_{m}^{K}$ denote elementwise quadrature rules that are exact for polynomials on $K$ of total degree up to $r_{s}$ and $r_{m}$, respectively. Assume that the same pair $(r_{s},r_{m})$ is used on all elements and that the rules are stable in the sense of standard norm-equivalence bounds on polynomial spaces.\n\nUsing only fundamental definitions of the weak formulation, the polynomial-degree structure of the Lagrange finite element basis, and a consistency argument based on Strang’s lemma (no pre-packaged estimates may be invoked without justification), derive the tightest elementwise polynomial exactness degrees $r_{s}^{\\star}(p)$ and $r_{m}^{\\star}(p)$ (as functions of $p$ only) that guarantee the following: the discrete bilinear form coincides with the exact bilinear form on $V_{h} \\times V_{h}$, which in turn preserves the optimal convergence rates $\\|u-u_{h}\\|_{H^{1}(\\Omega)} = \\mathcal{O}(h^{p})$ and $\\|u-u_{h}\\|_{L^{2}(\\Omega)} = \\mathcal{O}(h^{p+1})$ as $h \\to 0$.\n\nExpress your final answer as a single row matrix containing the two expressions $r_{s}^{\\star}(p)$ and $r_{m}^{\\star}(p)$. No rounding is required. Do not include units in your answer.",
            "solution": "The problem requires the derivation of the minimum polynomial exactness degrees, $r_{s}^{\\star}(p)$ and $r_{m}^{\\star}(p)$, for the numerical quadrature rules used in a finite element discretization. The condition is that these degrees must be just sufficient to ensure that the discrete bilinear form $a_{h}(\\cdot, \\cdot)$ is identical to the exact bilinear form $a(\\cdot, \\cdot)$ when restricted to the finite element space $V_{h} \\times V_{h}$. This condition, in turn, is stated to be the guarantor of optimal convergence rates.\n\nLet us first formalize the core condition given in the problem statement:\n$$\na_{h}(v_{h}, w_{h}) = a(v_{h}, w_{h}) \\quad \\text{for all } v_{h}, w_{h} \\in V_{h}.\n$$\nBy writing the bilinear forms as a sum over elements $K \\in \\mathcal{T}_{h}$, we have:\n$$\na(v_{h}, w_{h}) = \\sum_{K \\in \\mathcal{T}_{h}} \\left( \\int_{K} \\nabla v_{h} \\cdot \\nabla w_{h} \\,dx + \\int_{K} v_{h} w_{h} \\,dx \\right)\n$$\n$$\na_{h}(v_{h}, w_{h}) = \\sum_{K \\in \\mathcal{T}_{h}} \\left( Q_{s}^{K}(\\nabla v_{h} \\cdot \\nabla w_{h}) + Q_{m}^{K}(v_{h} w_{h}) \\right)\n$$\nFor the equality $a_{h}(v_{h}, w_{h}) = a(v_{h}, w_{h})$ to hold for all choices of $v_{h}, w_{h} \\in V_{h}$, it is sufficient that the equality holds term-by-term on each element $K \\in \\mathcal{T}_{h}$. This requires:\n1. $Q_{s}^{K}(\\nabla v_{h} \\cdot \\nabla w_{h}) = \\int_{K} \\nabla v_{h} \\cdot \\nabla w_{h} \\,dx$ for all $v_{h}, w_{h} \\in V_{h}$.\n2. $Q_{m}^{K}(v_{h} w_{h}) = \\int_{K} v_{h} w_{h} \\,dx$ for all $v_{h}, w_{h} \\in V_{h}$.\n\nBefore proceeding, we briefly justify why this condition preserves optimal convergence rates, as requested by the problem's framing. The error $e = u-u_{h}$ in the energy norm associated with $a(\\cdot, \\cdot)$ can be bounded using Strang's First Lemma. Assuming the discrete form $a_{h}$ is coercive on $V_{h}$, the lemma provides an estimate of the form:\n$$\n\\|u - u_{h}\\|_{H^{1}(\\Omega)} \\leq C \\left( \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{H^{1}(\\Omega)} + \\sup_{w_{h} \\in V_{h} \\setminus \\{0\\}} \\frac{|a(u, w_{h}) - \\ell(w_{h})|}{\\|w_{h}\\|_{H^{1}(\\Omega)}} + \\sup_{v_{h}, w_{h} \\in V_{h} \\setminus \\{0\\}} \\frac{|a(v_{h}, w_{h}) - a_{h}(v_{h}, w_{h})|}{\\|v_{h}\\|_{H^{1}(\\Omega)} \\|w_{h}\\|_{H^{1}(\\Omega)}} \\right).\n$$\nIn our problem, the discrete load is exact, $\\ell_h = \\ell$, which means $a(u, w_h) = \\ell(w_h)$, so the second term (load consistency error) vanishes. The condition $a_{h}(v_{h}, w_{h}) = a(v_{h}, w_{h})$ for all $v_{h}, w_{h} \\in V_h$ makes the third term (bilinear form consistency error) vanish entirely. The error estimate thus simplifies to Céa's Lemma:\n$$\n\\|u - u_{h}\\|_{H^{1}(\\Omega)} \\leq C \\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{H^{1}(\\Omega)}.\n$$\nFor a solution with regularity $u \\in H^{p+1}(\\Omega)$ and a finite element space $V_{h}$ of polynomials of degree $p$, standard approximation theory guarantees that the best approximation error is $\\inf_{v_{h} \\in V_{h}} \\|u - v_{h}\\|_{H^{1}(\\Omega)} = \\mathcal{O}(h^{p})$. Thus, our condition ensures $\\|u-u_{h}\\|_{H^{1}(\\Omega)} = \\mathcal{O}(h^{p})$.\n\nThe optimal $L^{2}$-norm estimate is obtained via the Aubin-Nitsche duality argument. This argument relies on the $H^{1}$-norm estimate. If we enforce $a_{h} \\equiv a$ on $V_{h} \\times V_{h}$, the standard duality proof proceeds without modification, yielding $\\|u-u_{h}\\|_{L^{2}(\\Omega)} = \\mathcal{O}(h^{p+1})$, assuming sufficient elliptic regularity for the dual problem (which is assured by the convexity of $\\Omega$).\n\nWe now determine the minimum required degrees of exactness, $r_{s}^{\\star}$ and $r_{m}^{\\star}$.\nThe finite element space $V_{h}$ consists of functions whose restrictions to any element $K \\in \\mathcal{T}_{h}$ are polynomials of total degree at most $p$. Let us denote the space of such polynomials on $K$ as $\\mathcal{P}_{p}(K)$. Thus, for any $v_{h}, w_{h} \\in V_{h}$, their restrictions $v_{h}|_{K}$ and $w_{h}|_{K}$ are in $\\mathcal{P}_{p}(K)$.\n\nAnalysis of the stiffness term integrator, $Q_{s}^{K}$:\nThe integrand is $\\nabla v_{h} \\cdot \\nabla w_{h}$.\nIf $v_{h} \\in \\mathcal{P}_{p}(K)$, its gradient $\\nabla v_{h}$ is a vector quantity whose components are polynomials of total degree at most $p-1$.\nThe dot product $\\nabla v_{h} \\cdot \\nabla w_{h}$ involves sums of products of these components. A product of a polynomial of degree at most $p-1$ with another polynomial of degree at most $p-1$ results in a polynomial of degree at most $(p-1) + (p-1) = 2p-2$.\nTherefore, the integrand $\\nabla v_{h} \\cdot \\nabla w_{h}$ is a polynomial of total degree at most $2p-2$.\nThe quadrature rule $Q_{s}^{K}$ is defined to be exact for polynomials of total degree up to $r_{s}$. For condition (1) to hold for all $v_{h}, w_{h} \\in V_{h}$, $Q_{s}^{K}$ must integrate exactly any polynomial that can be formed as $\\nabla v_h \\cdot \\nabla w_h$. The highest degree polynomial we need to integrate is of degree $2p-2$. Thus, we must have $r_{s} \\geq 2p-2$. The tightest, or minimal, degree of exactness required is therefore\n$$\nr_{s}^{\\star}(p) = 2p-2.\n$$\n\nAnalysis of the mass term integrator, $Q_{m}^{K}$:\nThe integrand is $v_{h} w_{h}$.\nAs $v_{h}|_{K}$ and $w_{h}|_{K}$ are polynomials in $\\mathcal{P}_{p}(K)$, their product $v_{h} w_{h}$ is a polynomial of total degree at most $p + p = 2p$.\nThe quadrature rule $Q_{m}^{K}$ is defined to be exact for polynomials of total degree up to $r_{m}$. For condition (2) to hold for all $v_{h}, w_{h} \\in V_{h}$, $Q_{m}^{K}$ must integrate exactly any polynomial that can be formed as $v_h w_h$. The highest degree polynomial we need to integrate is of degree $2p$. Thus, we must have $r_{m} \\geq 2p$. The tightest, or minimal, degree of exactness required is therefore\n$$\nr_{m}^{\\star}(p) = 2p.\n$$\n\nThese are the minimal degrees of quadrature exactness that ensure the discrete bilinear form is identical to the exact one on the finite element space, which, as argued via Strang's Lemma and the Aubin-Nitsche argument, is a sufficient condition to preserve the optimal orders of convergence.\nThe final answer is the pair $(r_{s}^{\\star}(p), r_{m}^{\\star}(p))$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2p - 2  2p\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Standard error estimates rely on the solution being sufficiently smooth, an assumption that fails in many practical applications, such as problems on domains with re-entrant corners. This advanced practice explores how to recover optimal convergence rates in the presence of such singularities. You will analyze the effect of a radially graded mesh and derive the ideal grading parameter needed to counteract the singular behavior, demonstrating a powerful technique for adapting numerical methods to challenging physical problems .",
            "id": "3374917",
            "problem": "Consider the planar sector domain $\\Omega = \\{(r,\\theta): 0  r  R,\\; 0  \\theta  \\omega\\}$ with opening angle $\\omega \\in (\\pi,2\\pi)$, which induces a re-entrant corner at the origin. Let $u$ be the solution to the Poisson partial differential equation (PDE) $-\\Delta u = f$ in $\\Omega$ with $u=0$ on $\\partial\\Omega$, where $f \\in C^{\\infty}(\\overline{\\Omega})$ is chosen so that near $r=0$ the solution admits the decomposition $u(r,\\theta) = u_{\\mathrm{s}}(r,\\theta) + u_{\\mathrm{r}}(r,\\theta)$ with $u_{\\mathrm{s}}(r,\\theta) = r^{\\lambda}\\psi(\\theta)$, $\\lambda = \\pi/\\omega \\in (0,1)$, and $u_{\\mathrm{r}} \\in H^{2}(\\Omega)$ is sufficiently smooth. Here $H^{1}(\\Omega)$ denotes the Sobolev space of square-integrable functions with square-integrable first derivatives, and $L^{2}(\\Omega)$ denotes the space of square-integrable functions.\n\nConsider a conforming piecewise linear Finite Element Method (FEM) on a family of isotropic triangulations that are quasi-uniform in the angular direction and radially graded toward $r=0$ using the parameter $\\beta0$ via nodal radii $r_{i} = R\\left(\\frac{i}{M}\\right)^{\\beta}$ for $i=0,1,\\dots,M$, with $M$ the number of radial layers. Assume the number of angular sectors $K$ scales like $K \\simeq c\\,M$ for a fixed $c0$, so the total number of elements $N$ satisfies $N \\simeq C\\,M^{2}$ for a constant $C0$ independent of $M$. Let $h(r)$ denote the local element diameter at radius $r$ induced by this grading.\n\nStarting from standard local interpolation estimates for piecewise linear elements,\n- $|\\nabla(u - I_{h}u)| \\lesssim h(r)\\,|D^{2}u|$ for the $H^{1}(\\Omega)$ error, and\n- $|u - I_{h}u| \\lesssim h(r)^{2}\\,|D^{2}u|$ for the $L^{2}(\\Omega)$ error,\nand using the singular structure $|D^{2}u_{\\mathrm{s}}(r,\\theta)| \\simeq r^{\\lambda-2}$ near $r=0$ together with polar-coordinate integration, derive conditions on the grading parameter $\\beta$ so that the FEM recovers the near-optimal convergence rates associated with smooth solutions, namely first-order in the $H^{1}(\\Omega)$ norm and second-order in the $L^{2}(\\Omega)$ norm, as functions of the total number of elements $N$.\n\nProvide your answer as a single closed-form expression for the minimal admissible value $\\beta_{\\min}$ in terms of the singularity exponent $\\lambda$. No rounding is required. The final answer must be a single analytic expression.",
            "solution": "The problem requires finding the minimal grading parameter $\\beta_{\\min}$ for a radially graded mesh such that the conforming piecewise linear Finite Element Method (FEM) for a Poisson problem on a domain with a re-entrant corner achieves optimal convergence rates. The solution's regularity is reduced by the corner, with a singular part $u_{\\mathrm{s}}(r,\\theta) = r^{\\lambda}\\psi(\\theta)$ where $\\lambda = \\pi/\\omega \\in (1/2, 1)$. The error analysis must account for this singularity.\n\nThe total error of the FEM solution $u_h$ can be bounded by the interpolation error of the exact solution $u$. By Céa's lemma for the $H^1(\\Omega)$ norm and duality arguments for the $L^2(\\Omega)$ norm, the convergence rates are determined by how well the finite element space can approximate the solution $u$. The problem provides local interpolation error estimates, which we will use. Since the solution is decomposed as $u = u_{\\mathrm{s}} + u_{\\mathrm{r}}$ with $u_{\\mathrm{r}} \\in H^2(\\Omega)$, the convergence rate for the regular part $u_{\\mathrm{r}}$ will be optimal on any reasonably shaped mesh. The overall convergence rate is limited by the approximation of the singular part $u_{\\mathrm{s}}$. We therefore focus on the error for $u_{\\mathrm{s}}$.\n\nFirst, we characterize the local element diameter $h(r)$ for the given mesh. The nodal radii are $r_i = R(i/M)^{\\beta}$ for $i=0, \\dots, M$. The radial size of elements in the layer between $r_{i-1}$ and $r_i$ is $h_{r,i} = r_i - r_{i-1}$. Using a first-order approximation for $i \\gg 1$:\n$h_{r,i} = R M^{-\\beta} (i^{\\beta} - (i-1)^{\\beta}) \\approx R M^{-\\beta} (\\beta i^{\\beta-1})$.\nThe radius $r$ in this layer is approximately $r_i$, so $i \\approx M(r/R)^{1/\\beta}$. Substituting this into the expression for $h_{r,i}$ gives the radial mesh size as a function of $r$:\n$h_r(r) \\approx R \\beta M^{-\\beta} (M(r/R)^{1/\\beta})^{\\beta-1} = R \\beta M^{-1} (r/R)^{1-1/\\beta}$.\nThe number of angular sectors $K$ scales with $M$ ($K \\simeq cM$), so the tangential mesh size is $h_{\\theta}(r) \\approx r\\omega/K \\simeq (r\\omega/c) M^{-1}$.\nThe local element diameter $h(r)$ is the maximum of these sizes. Near the singularity at $r=0$, for $r \\ll R$ and $\\beta  0$, we have $r^{1-1/\\beta}  r$ since $1-1/\\beta  1$. Thus, the radial size $h_r(r)$ is typically larger than the tangential size $h_{\\theta}(r)$, so we can approximate the effective local diameter by $h(r) \\sim M^{-1}r^{1-1/\\beta}$.\n\nNext, we analyze the $H^1(\\Omega)$ error convergence. The goal is to achieve a rate of $O(N^{-1/2})$, where $N \\simeq CM^2$ is the total number of elements. This corresponds to a rate of $O(M^{-1})$. The squared $H^1(\\Omega)$-seminorm error for the singular part $u_{\\mathrm{s}}$ is estimated by integrating the local interpolation error:\n$\\|\\nabla(u_{\\mathrm{s}} - u_h)\\|_{L^2(\\Omega)}^2 \\lesssim \\|\\nabla(u_{\\mathrm{s}} - I_h u_{\\mathrm{s}})\\|_{L^2(\\Omega)}^2 \\lesssim \\int_{\\Omega} h(r)^2 |D^2 u_{\\mathrm{s}}(r,\\theta)|^2 dA$.\nUsing the given singular behavior $|D^2 u_{\\mathrm{s}}| \\sim r^{\\lambda-2}$, the derived mesh size $h(r) \\sim M^{-1}r^{1-1/\\beta}$, and the area element $dA = r dr d\\theta$, we get:\n$$ \\|\\nabla(u_{\\mathrm{s}} - u_h)\\|_{L^2(\\Omega)}^2 \\lesssim \\int_0^\\omega \\int_0^R (C_1 M^{-1} r^{1-1/\\beta})^2 (C_2 r^{\\lambda-2})^2 r \\, dr \\, d\\theta $$\n$$ \\lesssim M^{-2} \\int_0^R r^{2(1-1/\\beta)} r^{2(\\lambda-2)} r^1 \\, dr = M^{-2} \\int_0^R r^{2 - 2/\\beta + 2\\lambda - 4 + 1} \\, dr $$\n$$ = M^{-2} \\int_0^R r^{2\\lambda - 2/\\beta - 1} \\, dr $$\nFor the total error to be $O(M^{-1})$, the squared error must be $O(M^{-2})$. This requires the integral $\\int_0^R r^{2\\lambda - 2/\\beta - 1} \\, dr$ to be a bounded constant independent of $M$. For the integral to converge at $r=0$, the exponent of $r$ must be greater than $-1$:\n$2\\lambda - 2/\\beta - 1  -1 \\implies 2\\lambda  2/\\beta \\implies \\lambda  1/\\beta \\implies \\beta  1/\\lambda$.\nIf this condition holds, the integral is finite, and the $H^1$ error converges as desired.\n\nNow, we analyze the $L^2(\\Omega)$ error convergence. The goal is $O(N^{-1})$, which is $O(M^{-2})$. The squared $L^2(\\Omega)$ error is estimated using the provided local estimate:\n$\\|u_{\\mathrm{s}} - u_h\\|_{L^2(\\Omega)}^2 \\lesssim \\|u_{\\mathrm{s}} - I_h u_{\\mathrm{s}}\\|_{L^2(\\Omega)}^2 \\lesssim \\int_{\\Omega} (h(r)^2 |D^2 u_{\\mathrm{s}}(r,\\theta)|)^2 dA$.\nSubstituting the expressions for $h(r)$, $|D^2 u_s|$, and $dA$:\n$$ \\|u_{\\mathrm{s}} - u_h\\|_{L^2(\\Omega)}^2 \\lesssim \\int_0^\\omega \\int_0^R \\left( (C_1 M^{-1} r^{1-1/\\beta})^2 (C_2 r^{\\lambda-2}) \\right)^2 r \\, dr \\, d\\theta $$\n$$ \\lesssim M^{-4} \\int_0^R (r^{2(1-1/\\beta)} r^{\\lambda-2})^2 r \\, dr = M^{-4} \\int_0^R (r^{2 - 2/\\beta + \\lambda - 2})^2 r \\, dr $$\n$$ = M^{-4} \\int_0^R (r^{\\lambda - 2/\\beta})^2 r \\, dr = M^{-4} \\int_0^R r^{2\\lambda - 4/\\beta + 1} \\, dr $$\nFor the total $L^2$ error to be $O(M^{-2})$, the squared error must be $O(M^{-4})$. This requires the integral $\\int_0^R r^{2\\lambda - 4/\\beta + 1} \\, dr$ to be a bounded constant. Convergence at $r=0$ requires the exponent to be greater than $-1$:\n$2\\lambda - 4/\\beta + 1  -1 \\implies 2\\lambda + 2  4/\\beta \\implies \\lambda + 1  2/\\beta \\implies \\beta  \\frac{2}{\\lambda+1}$.\n\nTo recover both optimal convergence rates, both conditions on $\\beta$ must be satisfied:\n$1. \\quad \\beta  1/\\lambda$\n$2. \\quad \\beta  2/(\\lambda+1)$\nWe must determine which of these two conditions is stricter for the given range of $\\lambda \\in (1/2, 1)$. Let's compare the values $1/\\lambda$ and $2/(\\lambda+1)$. Consider their difference:\n$$ \\frac{1}{\\lambda} - \\frac{2}{\\lambda+1} = \\frac{(\\lambda+1) - 2\\lambda}{\\lambda(\\lambda+1)} = \\frac{1-\\lambda}{\\lambda(\\lambda+1)} $$\nSince $\\lambda \\in (1/2, 1)$, the numerator $1-\\lambda$ is positive, and the denominator $\\lambda(\\lambda+1)$ is also positive. Therefore, the difference is positive, which implies:\n$$ \\frac{1}{\\lambda}  \\frac{2}{\\lambda+1} $$\nThe condition $\\beta  1/\\lambda$ is stricter than $\\beta  2/(\\lambda+1)$. Satisfying the former automatically satisfies the latter. Thus, the condition to achieve both desired convergence rates is $\\beta  1/\\lambda$. The problem asks for the minimal admissible value $\\beta_{\\min}$, which is the infimum of the set of admissible $\\beta$ values. This corresponds to the boundary of the derived inequality.\n\nThe minimal admissible value is $\\beta_{\\min} = 1/\\lambda$. At this boundary value, a logarithmic factor may appear in the $H^1$ error estimate, i.e., $\\|\\nabla(u-u_h)\\|_{L^2} \\sim N^{-1/2}\\sqrt{\\log N}$, which is consistent with the problem's use of \"near-optimal\".",
            "answer": "$$\\boxed{\\frac{1}{\\lambda}}$$"
        }
    ]
}