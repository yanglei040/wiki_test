{
    "hands_on_practices": [
        {
            "introduction": "Understanding the derivation of a stiffness matrix begins with the simplest case: a one-dimensional bar. This practice  guides you through the foundational process of translating the principle of virtual work into the computable integral form of the element stiffness matrix $K$. By employing an isoparametric mapping, you will see how physical problems on arbitrary domains are transformed into a standardized reference domain for calculation, a core concept in modern finite element software.",
            "id": "3498543",
            "problem": "A two-node isoparametric bar element models a tapered, axially loaded, linearly elastic bar occupying the physical coordinate interval $[x_{1},\\,x_{2}]$ with small strains and no body forces. The displacement field is approximated as $u_{h}(x(\\xi)) = N(\\xi)\\,d$, where $\\xi \\in [-1,\\,1]$ is the parent coordinate, $d \\in \\mathbb{R}^{2}$ are the nodal displacements, and the linear shape functions are $N_{1}(\\xi) = \\frac{1-\\xi}{2}$ and $N_{2}(\\xi) = \\frac{1+\\xi}{2}$ collected in $N(\\xi) = \\begin{bmatrix}N_{1}(\\xi)  N_{2}(\\xi)\\end{bmatrix}$. The isoparametric mapping is $x(\\xi) = N_{1}(\\xi)\\,x_{1} + N_{2}(\\xi)\\,x_{2}$, with Jacobian $J(\\xi) = \\frac{dx}{d\\xi}$. The cross-sectional area varies linearly along the element, $A(\\xi) = N_{1}(\\xi)\\,A_{1} + N_{2}(\\xi)\\,A_{2}$, and the Young’s modulus may vary spatially as $E(\\xi)$ due to material heterogeneity. Assume one-dimensional small-strain kinematics, $\\varepsilon = \\frac{du}{dx}$, and linear elasticity, $\\sigma = E\\,\\varepsilon$.\n\n(a) Starting from the principle of virtual work for axial response, $\\delta W_{\\text{int}} = \\int_{x_{1}}^{x_{2}} \\sigma\\,\\delta\\varepsilon\\,A\\,dx$, perform the isoparametric change of variables from $x$ to $\\xi$, and derive the element stiffness matrix as a single integral over $\\xi \\in [-1,\\,1]$ expressed in terms of the strain-displacement matrix $B(\\xi)$, the modulus $E(\\xi)$, the area $A(\\xi)$, and the Jacobian $J(\\xi)$. Provide explicit expressions for $N(\\xi)$, $J(\\xi)$, and $B(\\xi)$ in terms of $x_{1}$ and $x_{2}$, but do not evaluate the integral.\n\n(b) Suppose $A(\\xi)$ is linear in $\\xi$ as given, while $E(\\xi)$ is an arbitrary polynomial of degree $m$ in $\\xi$. For the linear isoparametric mapping defined above, determine the largest integer $m$ for which the two-point Gauss–Legendre quadrature in $\\xi$ integrates the element stiffness matrix exactly. Report only the integer $m_{\\max}$ as your final answer. No rounding is required.",
            "solution": "This problem consists of two parts. Part (a) requires the derivation of the element stiffness matrix for a $2$-node isoparametric bar element. Part (b) asks for the determination of the maximum polynomial degree $m$ of the Young's modulus $E(\\xi)$ for which a $2$-point Gauss-Legendre quadrature provides an exact result for the stiffness matrix integral.\n\n(a) Derivation of the Element Stiffness Matrix\n\nThe derivation begins with the principle of virtual work for a one-dimensional bar under axial load, neglecting body forces. The internal virtual work, $\\delta W_{\\text{int}}$, is given by the integral of the stress $\\sigma$ multiplied by the virtual strain $\\delta\\varepsilon$ over the element's volume:\n$$ \\delta W_{\\text{int}} = \\int_{x_{1}}^{x_{2}} \\sigma\\,\\delta\\varepsilon\\,A\\,dx $$\nTo formulate the element stiffness matrix, we must express all quantities in terms of the nodal degrees of freedom $d$ and the parent coordinate $\\xi \\in [-1, 1]$.\n\nThe displacement field $u(x)$ is approximated using the shape functions $N(\\xi)$ and nodal displacements $d = \\begin{bmatrix} d_1  d_2 \\end{bmatrix}^T$:\n$$ u_h(x(\\xi)) = N(\\xi)d = N_1(\\xi)d_1 + N_2(\\xi)d_2 $$\nThe strain $\\varepsilon$ is the spatial derivative of the displacement, $\\varepsilon = \\frac{du}{dx}$. Using the chain rule, we can relate derivatives with respect to the physical coordinate $x$ and the parent coordinate $\\xi$:\n$$ \\frac{du}{d\\xi} = \\frac{du}{dx} \\frac{dx}{d\\xi} = \\varepsilon J(\\xi) $$\nwhere $J(\\xi) = \\frac{dx}{d\\xi}$ is the Jacobian of the coordinate transformation. This gives the strain as:\n$$ \\varepsilon = \\frac{1}{J(\\xi)}\\frac{du}{d\\xi} $$\nThe derivative of the displacement with respect to $\\xi$ is:\n$$ \\frac{du}{d\\xi} = \\frac{d}{d\\xi}(N(\\xi)d) = \\left(\\frac{dN(\\xi)}{d\\xi}\\right)d $$\nLet's denote the matrix of shape function derivatives as $N_{,\\xi} \\equiv \\frac{dN}{d\\xi}$. Then the strain can be written as:\n$$ \\varepsilon = \\left(\\frac{1}{J(\\xi)}N_{,\\xi}\\right) d = B(\\xi)d $$\nwhere $B(\\xi) = \\frac{1}{J(\\xi)}N_{,\\xi}$ is the strain-displacement matrix.\n\nSimilarly, the virtual strain $\\delta\\varepsilon$ is related to the virtual nodal displacements $\\delta d$ by the same matrix $B(\\xi)$:\n$$ \\delta\\varepsilon = B(\\xi)\\delta d $$\nThe constitutive law for linear elasticity is $\\sigma = E(\\xi)\\varepsilon$. Substituting the expression for $\\varepsilon$:\n$$ \\sigma = E(\\xi)B(\\xi)d $$\nNow we substitute these expressions for $\\sigma$, $\\delta\\varepsilon$, and the differential element $dx = J(\\xi)d\\xi$ into the virtual work integral. The integration limits change from $[x_1, x_2]$ to $[-1, 1]$. To maintain correct matrix multiplication form, we write $\\sigma \\delta\\varepsilon = \\delta\\varepsilon^T \\sigma$:\n$$ \\delta W_{\\text{int}} = \\int_{-1}^{1} (B(\\xi)\\delta d)^T (E(\\xi)B(\\xi)d) A(\\xi) J(\\xi) d\\xi $$\nUsing the property $(AB)^T = B^T A^T$, we get $(\\delta d^T B(\\xi)^T)$. Since nodal displacements $d$ and $\\delta d$ are not functions of $\\xi$, they can be taken outside the integral:\n$$ \\delta W_{\\text{int}} = \\delta d^T \\left( \\int_{-1}^{1} B(\\xi)^T E(\\xi) B(\\xi) A(\\xi) J(\\xi) d\\xi \\right) d $$\nThe internal virtual work is also defined as $\\delta W_{\\text{int}} = \\delta d^T K d$, where $K$ is the element stiffness matrix. By comparison, we obtain the expression for $K$:\n$$ K = \\int_{-1}^{1} B(\\xi)^T E(\\xi) A(\\xi) B(\\xi) J(\\xi) d\\xi $$\nNote that $E(\\xi)$, $A(\\xi)$, and $J(\\xi)$ are scalars for this $1$D problem and can be rearranged within the integrand.\nThe problem asks for this expression along with explicit forms for $N(\\xi)$, $J(\\xi)$, and $B(\\xi)$.\n\nThe shape functions are given:\n$$ N(\\xi) = \\begin{bmatrix} N_1(\\xi)  N_2(\\xi) \\end{bmatrix} = \\begin{bmatrix} \\frac{1-\\xi}{2}  \\frac{1+\\xi}{2} \\end{bmatrix} $$\nThe isoparametric mapping for the coordinate is $x(\\xi) = N_1(\\xi)x_1 + N_2(\\xi)x_2$:\n$$ x(\\xi) = \\frac{1-\\xi}{2}x_1 + \\frac{1+\\xi}{2}x_2 = \\frac{x_1+x_2}{2} + \\frac{x_2-x_1}{2}\\xi $$\nThe Jacobian $J(\\xi)$ is the derivative of $x(\\xi)$ with respect to $\\xi$:\n$$ J(\\xi) = \\frac{dx}{d\\xi} = \\frac{x_2-x_1}{2} $$\nFor a linear element, the Jacobian is constant. Let $L=x_2-x_1$ be the element length, so $J(\\xi)=L/2$.\nThe derivatives of the shape functions with respect to $\\xi$ are:\n$$ N_{,\\xi} = \\frac{dN}{d\\xi} = \\begin{bmatrix} -\\frac{1}{2}  \\frac{1}{2} \\end{bmatrix} $$\nThe strain-displacement matrix $B(\\xi)$ is then:\n$$ B(\\xi) = \\frac{1}{J(\\xi)}N_{,\\xi} = \\frac{1}{(x_2-x_1)/2} \\begin{bmatrix} -\\frac{1}{2}  \\frac{1}{2} \\end{bmatrix} = \\frac{2}{x_2-x_1} \\begin{bmatrix} -\\frac{1}{2}  \\frac{1}{2} \\end{bmatrix} = \\frac{1}{x_2-x_1}\\begin{bmatrix} -1  1 \\end{bmatrix} $$\nSince $J(\\xi)$ is constant for this element, $B(\\xi)$ is also constant.\n\n(b) Exact Integration using Gauss-Legendre Quadrature\n\nA Gauss-Legendre quadrature with $n_p$ integration points integrates a polynomial of degree up to $2n_p - 1$ exactly. The problem specifies a $2$-point quadrature, so $n_p=2$. Therefore, the integration of the stiffness matrix will be exact if the polynomial degree of the integrand is less than or equal to $2(2)-1=3$.\n\nThe stiffness matrix is $K = \\int_{-1}^{1} k(\\xi) d\\xi$, where the integrand is the matrix $k(\\xi) = B(\\xi)^T E(\\xi) B(\\xi) A(\\xi) J(\\xi)$. Since $E(\\xi)$, $A(\\xi)$, and $J(\\xi)$ are scalars, we can write $k(\\xi) = (B(\\xi)^T B(\\xi)) E(\\xi) A(\\xi) J(\\xi)$. We need to determine the polynomial degree of each component of this matrix integrand as a function of $\\xi$.\n\nLet's analyze the degree of each term:\n1.  Jacobian, $J(\\xi)$: As derived in part (a), $J(\\xi) = \\frac{x_2-x_1}{2}$ is a constant. Its polynomial degree is $0$.\n2.  Strain-Displacement Matrix, $B(\\xi)$: As derived in part (a), $B(\\xi) = \\frac{1}{x_2-x_1}\\begin{bmatrix} -1  1 \\end{bmatrix}$ is a constant row vector. Its components have a polynomial degree of $0$. Consequently, the matrix product $B(\\xi)^T B(\\xi)$ is also a constant matrix:\n    $$ B(\\xi)^T B(\\xi) = \\frac{1}{(x_2-x_1)^2} \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} -1  1 \\end{bmatrix} = \\frac{1}{(x_2-x_1)^2} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $$\n    The degree of each component is $0$.\n3.  Cross-sectional Area, $A(\\xi)$: The area varies linearly and is defined by the isoparametric interpolation $A(\\xi) = N_1(\\xi)A_1 + N_2(\\xi)A_2$:\n    $$ A(\\xi) = \\frac{1-\\xi}{2}A_1 + \\frac{1+\\xi}{2}A_2 = \\left(\\frac{A_1+A_2}{2}\\right) + \\left(\\frac{A_2-A_1}{2}\\right)\\xi $$\n    Assuming a tapered bar (i.e., $A_1 \\neq A_2$), $A(\\xi)$ is a polynomial of degree $1$ in $\\xi$.\n4.  Young's Modulus, $E(\\xi)$: It is given as an arbitrary polynomial of degree $m$ in $\\xi$.\n\nThe integrand for the stiffness matrix is $k(\\xi) = (B^T B) E(\\xi) A(\\xi) J$. Since $B^T B$ and $J$ are constant matrices/scalars, the polynomial nature of the integrand is determined entirely by the product $E(\\xi)A(\\xi)$. Let this product be $P(\\xi) = E(\\xi)A(\\xi)$.\nThe degree of a product of polynomials is the sum of their degrees.\n$$ \\text{degree}(P(\\xi)) = \\text{degree}(E(\\xi)) + \\text{degree}(A(\\xi)) = m + 1 $$\nFor exact integration using a $2$-point Gauss-Legendre quadrature, the degree of the integrand polynomial must be at most $3$:\n$$ \\text{degree}(P(\\xi)) \\leq 3 $$\n$$ m + 1 \\leq 3 $$\nSolving for $m$, we find:\n$$ m \\leq 2 $$\nThe largest integer value for $m$ that satisfies this condition is $m_{\\max}=2$.",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "Building on the 1D foundation, this exercise  transitions to a two-dimensional scalar problem using a bilinear quadrilateral element. This practice is key to understanding how to handle shape functions whose gradients vary within the element, a feature of most higher-order elements. By working through a specific calculation on a rectangular element, you will gain hands-on experience with the full pipeline: defining the Jacobian $J$, transforming gradients, and constructing the integrand to compute a specific stiffness matrix entry.",
            "id": "3383981",
            "problem": "Consider the steady diffusion Partial Differential Equation (PDE) with isotropic conductivity, given by $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a two-dimensional domain, where $\\kappa  0$ is a constant on each element. In the Finite Element Method (FEM) using bilinear $Q1$ quadrilateral elements, the element stiffness matrix entries are defined by the bilinear form associated with the weak formulation. Let the reference element be the square $[-1,1] \\times [-1,1]$ with reference coordinates $(\\xi,\\eta)$ and the standard $Q1$ shape functions $\\hat{N}_1, \\hat{N}_2, \\hat{N}_3, \\hat{N}_4$. Consider a single element whose physical coordinates form the rectangle with vertices (in counterclockwise order)\n$$(x_1,y_1) = (0,0), \\quad (x_2,y_2) = (4,0), \\quad (x_3,y_3) = (4,2), \\quad (x_4,y_4) = (0,2),$$\nand assume the isoparametric bilinear mapping is affine on this element. Starting from the weak form and the definition of the isoparametric mapping and Jacobian matrix, derive the expression for the element stiffness entry $K_e(1,3)$ in terms of $\\kappa$, where the index $i=1$ corresponds to the reference node $(\\xi,\\eta)=(-1,-1)$ and $j=3$ to $(\\xi,\\eta)=(1,1)$. Then, specify a tensor-product Gaussian quadrature rule on the reference square that integrates this entry exactly. Express the final numerical value of $K_e(1,3)$ as a closed-form analytic expression in terms of $\\kappa$. No rounding is required and no units should be included in the final expression.",
            "solution": "The element stiffness matrix entry $K_e(i,j)$ for the given diffusion problem is defined by the bilinear form arising from the weak formulation:\n$$K_e(i,j) = \\int_{\\Omega_e} \\kappa (\\nabla N_i \\cdot \\nabla N_j) \\, dA$$\nwhere $\\Omega_e$ is the physical element domain, $\\kappa$ is the constant material conductivity on the element, and $N_i, N_j$ are the global shape functions restricted to the element. The gradient operator $\\nabla$ is with respect to the physical coordinates $(x,y)$, i.e., $\\nabla = (\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})$.\n\nWe use the isoparametric mapping to transform the integral from the physical element $\\Omega_e$ to the reference square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$. The differential area element transforms as $dA = \\det(J) \\, d\\xi d\\eta$, where $J$ is the Jacobian matrix of the coordinate transformation. The gradient vectors transform according to the chain rule. Let $\\hat{\\nabla} = (\\frac{\\partial}{\\partial \\xi}, \\frac{\\partial}{\\partial \\eta})$ be the gradient in reference coordinates. The relationship between the physical and reference gradients of a shape function $N_i$ is given by:\n$$ \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{pmatrix} = (J^T)^{-1} \\begin{pmatrix} \\frac{\\partial \\hat{N}_i}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{N}_i}{\\partial \\eta} \\end{pmatrix} $$\nwhere $J$ is the Jacobian matrix $J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$.\nThe dot product in the integrand becomes:\n$$ \\nabla N_i \\cdot \\nabla N_j = \\left( (J^T)^{-1} \\hat{\\nabla} \\hat{N}_i \\right)^T \\left( (J^T)^{-1} \\hat{\\nabla} \\hat{N}_j \\right) = (\\hat{\\nabla} \\hat{N}_i)^T J^{-1} (J^T)^{-1} \\hat{\\nabla} \\hat{N}_j $$\nThe stiffness matrix entry is thus:\n$$ K_e(i,j) = \\int_{-1}^{1} \\int_{-1}^{1} \\kappa \\left( (\\hat{\\nabla} \\hat{N}_i)^T J^{-1} (J^T)^{-1} \\hat{\\nabla} \\hat{N}_j \\right) \\det(J) \\, d\\xi d\\eta $$\n\nFirst, we define the standard bilinear shape functions on the reference square, ordered counterclockwise from $(\\xi,\\eta)=(-1,-1)$:\n$\\hat{N}_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$\\hat{N}_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$\\hat{N}_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$\\hat{N}_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nWe need to compute $K_e(1,3)$. The required gradients of the reference shape functions are:\n$\\hat{\\nabla} \\hat{N}_1 = \\begin{pmatrix} \\frac{\\partial \\hat{N}_1}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{N}_1}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1-\\xi) \\end{pmatrix}$\n$\\hat{\\nabla} \\hat{N}_3 = \\begin{pmatrix} \\frac{\\partial \\hat{N}_3}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{N}_3}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}(1+\\eta) \\\\ \\frac{1}{4}(1+\\xi) \\end{pmatrix}$\n\nNext, we establish the isoparametric coordinate mapping from $(\\xi, \\eta)$ to $(x,y)$ using the given vertex coordinates $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(4,0)$, $(x_3,y_3)=(4,2)$, $(x_4,y_4)=(0,2)$:\n$x(\\xi, \\eta) = \\sum_{k=1}^{4} x_k \\hat{N}_k(\\xi, \\eta) = 0 \\cdot \\hat{N}_1 + 4 \\cdot \\hat{N}_2 + 4 \\cdot \\hat{N}_3 + 0 \\cdot \\hat{N}_4$\n$x(\\xi, \\eta) = 4\\frac{(1+\\xi)(1-\\eta)}{4} + 4\\frac{(1+\\xi)(1+\\eta)}{4} = (1+\\xi)[(1-\\eta)+(1+\\eta)] = 2(1+\\xi) = 2+2\\xi$\n$y(\\xi, \\eta) = \\sum_{k=1}^{4} y_k \\hat{N}_k(\\xi, \\eta) = 0 \\cdot \\hat{N}_1 + 0 \\cdot \\hat{N}_2 + 2 \\cdot \\hat{N}_3 + 2 \\cdot \\hat{N}_4$\n$y(\\xi, \\eta) = 2\\frac{(1+\\xi)(1+\\eta)}{4} + 2\\frac{(1-\\xi)(1+\\eta)}{4} = \\frac{1}{2}(1+\\eta)[(1+\\xi)+(1-\\xi)] = \\frac{1}{2}(1+\\eta)(2) = 1+\\eta$\nThis mapping is affine, as stated in the problem. The Jacobian matrix is constant over the element:\n$J = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}$\nThe determinant of the Jacobian is $\\det(J) = (2)(1) - (0)(0) = 2$.\nThe inverse of the Jacobian is $J^{-1} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{pmatrix}$.\nThe matrix product $J^{-1} (J^T)^{-1}$ is:\n$J^{-1} (J^T)^{-1} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{pmatrix}^T = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}  0 \\\\ 0  1 \\end{pmatrix}$\n\nNow we assemble the integrand for $K_e(1,3)$. The dot product term is:\n$(\\hat{\\nabla} \\hat{N}_1)^T J^{-1} (J^T)^{-1} \\hat{\\nabla} \\hat{N}_3 = \\begin{pmatrix} -\\frac{1}{4}(1-\\eta) \\\\ -\\frac{1}{4}(1-\\xi) \\end{pmatrix}^T \\begin{pmatrix} \\frac{1}{4}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{4}(1+\\eta) \\\\ \\frac{1}{4}(1+\\xi) \\end{pmatrix}$\n$= \\frac{1}{16} \\begin{pmatrix} -(1-\\eta)  -(1-\\xi) \\end{pmatrix} \\begin{pmatrix} \\frac{1}{4}  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1+\\eta \\\\ 1+\\xi \\end{pmatrix}$\n$= \\frac{1}{16} \\left[ -\\frac{1}{4}(1-\\eta)(1+\\eta) - (1-\\xi)(1+\\xi) \\right] = \\frac{1}{16} \\left[ -\\frac{1}{4}(1-\\eta^2) - (1-\\xi^2) \\right]$\n\nWe can now write the full integral for $K_e(1,3)$:\n$K_e(1,3) = \\int_{-1}^{1} \\int_{-1}^{1} \\kappa \\left( \\frac{1}{16} \\left[ -\\frac{1}{4}(1-\\eta^2) - (1-\\xi^2) \\right] \\right) (2) \\, d\\xi d\\eta$\n$K_e(1,3) = \\frac{2\\kappa}{16} \\int_{-1}^{1} \\int_{-1}^{1} \\left[ -\\frac{1}{4}(1-\\eta^2) - (1-\\xi^2) \\right] \\, d\\xi d\\eta$\n$K_e(1,3) = \\frac{\\kappa}{8} \\left[ -\\frac{1}{4} \\int_{-1}^{1} \\int_{-1}^{1} (1-\\eta^2) \\, d\\xi d\\eta - \\int_{-1}^{1} \\int_{-1}^{1} (1-\\xi^2) \\, d\\xi d\\eta \\right]$\nWe evaluate the definite integrals:\n$\\int_{-1}^{1} \\int_{-1}^{1} (1-\\eta^2) \\, d\\xi d\\eta = \\left( \\int_{-1}^{1} \\, d\\xi \\right) \\left( \\int_{-1}^{1} (1-\\eta^2) \\, d\\eta \\right) = [\\xi]_{-1}^{1} \\left[ \\eta - \\frac{\\eta^3}{3} \\right]_{-1}^{1} = (2) \\left[ \\left(1-\\frac{1}{3}\\right) - \\left(-1+\\frac{1}{3}\\right) \\right] = (2)\\left(\\frac{2}{3} - (-\\frac{2}{3})\\right) = (2)\\left(\\frac{4}{3}\\right) = \\frac{8}{3}$\nBy symmetry, $\\int_{-1}^{1} \\int_{-1}^{1} (1-\\xi^2) \\, d\\xi d\\eta = \\frac{8}{3}$.\n\nSubstituting these values back into the expression for $K_e(1,3)$:\n$K_e(1,3) = \\frac{\\kappa}{8} \\left[ -\\frac{1}{4}\\left(\\frac{8}{3}\\right) - \\left(\\frac{8}{3}\\right) \\right] = \\frac{\\kappa}{8} \\left[ -\\frac{2}{3} - \\frac{8}{3} \\right] = \\frac{\\kappa}{8} \\left( -\\frac{10}{3} \\right) = -\\frac{10\\kappa}{24} = -\\frac{5\\kappa}{12}$\n\nTo determine the required Gaussian quadrature rule, we examine the integrand function of $(\\xi, \\eta)$:\n$I(\\xi, \\eta) = \\kappa \\left( \\frac{1}{16} \\left[ -\\frac{1}{4}(1-\\eta^2) - (1-\\xi^2) \\right] \\right) (2) = \\frac{\\kappa}{8} \\left( -\\frac{1}{4} + \\frac{1}{4}\\eta^2 - 1 + \\xi^2 \\right) = \\frac{\\kappa}{8} \\left( \\xi^2 + \\frac{1}{4}\\eta^2 - \\frac{5}{4} \\right)$\nThis integrand is a polynomial of degree $2$ in $\\xi$ and degree $2$ in $\\eta$. A $1$D Gaussian quadrature rule with $n$ points integrates polynomials of degree up to $2n-1$ exactly. To integrate a polynomial of degree $d=2$, we require $2n-1 \\ge 2$, which implies $n \\ge 1.5$. Therefore, we must use at least $n=2$ points in the $\\xi$-direction and $m=2$ points in the $\\eta$-direction.\nThe tensor-product quadrature rule that integrates this entry exactly is a $2 \\times 2$ Gaussian quadrature rule.\n\nThe final numerical value for the element stiffness entry $K_e(1,3)$ is $-\\frac{5\\kappa}{12}$.",
            "answer": "$$\n\\boxed{-\\frac{5\\kappa}{12}}\n$$"
        },
        {
            "introduction": "This final practice  elevates the concept to vector-valued problems in solid mechanics, where the stiffness matrix relates nodal forces and displacements. You will explore how different physical idealizations of a 2D system—plane strain versus plane stress—are encoded in the constitutive matrix $\\boldsymbol{D}$. This exercise is crucial for appreciating how abstract modeling choices have direct and significant consequences on the numerical properties of the stiffness matrix, including its conditioning and overall stiffness.",
            "id": "3383946",
            "problem": "Consider small-strain, linear, isotropic elasticity in a bounded element domain $\\Omega_e \\subset \\mathbb{R}^2$. The governing balance is the quasi-static equilibrium Partial Differential Equation (PDE) $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$ together with the constitutive law of isotropic linear elasticity and the kinematic relation. In three dimensions, the small-strain tensor is $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}\\big(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top}\\big)$ and the Cauchy stress is $\\boldsymbol{\\sigma} = \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\boldsymbol{I} + 2 G\\,\\boldsymbol{\\varepsilon}$, where $\\lambda$ and $G$ are the Lamé parameters related to Young’s modulus $E0$ and Poisson’s ratio $\\nu$ by $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ and $G = \\dfrac{E}{2(1+\\nu)}$. In a two-dimensional formulation, one may impose either the plane strain constraints $\\varepsilon_{zz} = \\varepsilon_{xz} = \\varepsilon_{yz} = 0$ or the plane stress constraints $\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$.\n\nLet $\\boldsymbol{B}(\\boldsymbol{x})$ denote the strain–displacement matrix that maps nodal displacement vectors to the in-plane engineering strain vector $\\boldsymbol{\\varepsilon}_e = [\\varepsilon_{xx},\\,\\varepsilon_{yy},\\,\\gamma_{xy}]^{\\top}$, with $\\gamma_{xy} = 2 \\varepsilon_{xy}$. The element stiffness matrix under a given two-dimensional constitutive matrix $\\boldsymbol{D}$ is\n$$\n\\boldsymbol{K}_e = \\int_{\\Omega_e} \\boldsymbol{B}(\\boldsymbol{x})^{\\top}\\,\\boldsymbol{D}\\,\\boldsymbol{B}(\\boldsymbol{x})\\,\\mathrm{d}\\Omega.\n$$\nStarting from the $3$D constitutive law and the respective constraints for plane strain and plane stress, derive the two-dimensional constitutive matrices $\\boldsymbol{D}_{\\mathrm{pe}}$ (plane strain) and $\\boldsymbol{D}_{\\mathrm{ps}}$ (plane stress) as linear maps from $[\\varepsilon_{xx},\\,\\varepsilon_{yy},\\,\\gamma_{xy}]^{\\top}$ to $[\\sigma_{xx},\\,\\sigma_{yy},\\,\\tau_{xy}]^{\\top}$, where $\\tau_{xy} = \\sigma_{xy}$. Then, reason about how the choice of $\\boldsymbol{D}$ affects both the symmetry and the numerical values of $\\boldsymbol{K}_e$ for a fixed element geometry and interpolation (that is, fixed $\\boldsymbol{B}$ and $\\Omega_e$), for material parameters $E0$ and $\\nu \\in (-1, \\tfrac{1}{2})$.\n\nSelect all statements that are correct.\n\nA. For $E0$ and $\\nu \\in (-1,\\tfrac{1}{2})$, both $\\boldsymbol{D}_{\\mathrm{pe}}$ and $\\boldsymbol{D}_{\\mathrm{ps}}$ are symmetric, and consequently $\\boldsymbol{K}_e$ is symmetric in both plane strain and plane stress.\n\nB. For any fixed $\\nu0$, the in-plane shear contribution to $\\boldsymbol{K}_e$ is strictly larger under plane strain than under plane stress, for the same $\\Omega_e$ and $\\boldsymbol{B}$.\n\nC. As $\\nu \\to \\tfrac{1}{2}^{-}$ with $E$ and $\\Omega_e$ fixed, the spectral condition number of $\\boldsymbol{K}_e$ in plane strain tends to $+\\infty$, whereas in plane stress it remains bounded.\n\nD. For any fixed $\\nu0$ and fixed $\\Omega_e$ and $\\boldsymbol{B}$, every entry of $\\boldsymbol{K}_e$ under plane strain is greater than or equal to the corresponding entry under plane stress.\n\nE. Switching between plane strain and plane stress changes the sparsity pattern of $\\boldsymbol{K}_e$ because $\\boldsymbol{D}_{\\mathrm{pe}}$ and $\\boldsymbol{D}_{\\mathrm{ps}}$ have different zero patterns.\n\nF. For any kinematically admissible displacement field $\\boldsymbol{v}$, and any $\\nu0$, one has the energy density inequality $\\boldsymbol{\\varepsilon}_e(\\boldsymbol{v})^{\\top}\\,\\boldsymbol{D}_{\\mathrm{pe}}\\,\\boldsymbol{\\varepsilon}_e(\\boldsymbol{v}) \\ge \\boldsymbol{\\varepsilon}_e(\\boldsymbol{v})^{\\top}\\,\\boldsymbol{D}_{\\mathrm{ps}}\\,\\boldsymbol{\\varepsilon}_e(\\boldsymbol{v})$, with equality for pure in-plane shear $\\gamma_{xy} \\ne 0$ and $\\varepsilon_{xx}=\\varepsilon_{yy}=0$. Consequently, the shear part of $\\boldsymbol{K}_e$ is identical in plane strain and plane stress, while the normal part is stiffer in plane strain.",
            "solution": "### Derivation of Constitutive Matrices\n\n#### Plane Strain ($D_{\\mathrm{pe}}$)\nThe plane strain condition is $\\varepsilon_{zz} = \\varepsilon_{xz} = \\varepsilon_{yz} = 0$. The 3D constitutive law in component form is $\\sigma_{ij} = \\lambda \\delta_{ij} \\varepsilon_{kk} + 2G \\varepsilon_{ij}$.\nThe trace of the strain tensor is $\\mathrm{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz} = \\varepsilon_{xx} + \\varepsilon_{yy}$.\nThe in-plane stress components are:\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + 2G\\varepsilon_{xx} = (\\lambda + 2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} $$\n$$ \\sigma_{yy} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + 2G\\varepsilon_{yy} = \\lambda\\varepsilon_{xx} + (\\lambda + 2G)\\varepsilon_{yy} $$\nThe shear stress is $\\tau_{xy} = \\sigma_{xy} = 2G\\varepsilon_{xy} = G\\gamma_{xy}$.\nSubstituting the expressions for $\\lambda$ and $G$ in terms of $E$ and $\\nu$:\n$ \\lambda+2G = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} = \\frac{E\\nu + E(1-2\\nu)}{(1+\\nu)(1-2\\nu)} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} $\n$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} $\n$ G = \\frac{E}{2(1+\\nu)} $\nThe matrix $\\boldsymbol{D}_{\\mathrm{pe}}$ relates $[\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^\\top$ to $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$:\n$$\n\\boldsymbol{D}_{\\mathrm{pe}} =\n\\begin{pmatrix}\n\\lambda+2G  \\lambda  0 \\\\\n\\lambda  \\lambda+2G  0 \\\\\n0  0  G\n\\end{pmatrix}\n= \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{pmatrix}\n1-\\nu  \\nu  0 \\\\\n\\nu  1-\\nu  0 \\\\\n0  0  \\frac{1-2\\nu}{2}\n\\end{pmatrix}\n$$\n\n#### Plane Stress ($D_{\\mathrm{ps}}$)\nThe plane stress condition is $\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$. It is easier to start from the compliance form of Hooke's law: $\\varepsilon_{ij} = \\frac{1+\\nu}{E}\\sigma_{ij} - \\frac{\\nu}{E}\\sigma_{kk}\\delta_{ij}$.\nWith plane stress, $\\sigma_{kk} = \\sigma_{xx} + \\sigma_{yy}$. The in-plane strains are:\n$$ \\varepsilon_{xx} = \\frac{1}{E}(\\sigma_{xx} - \\nu\\sigma_{yy}) $$\n$$ \\varepsilon_{yy} = \\frac{1}{E}(\\sigma_{yy} - \\nu\\sigma_{xx}) $$\nInverting this system for the stresses yields:\n$$ \\sigma_{xx} = \\frac{E}{1-\\nu^2}(\\varepsilon_{xx} + \\nu\\varepsilon_{yy}) $$\n$$ \\sigma_{yy} = \\frac{E}{1-\\nu^2}(\\nu\\varepsilon_{xx} + \\varepsilon_{yy}) $$\nThe shear relations are $\\varepsilon_{xy} = \\frac{1+\\nu}{E}\\sigma_{xy}$, which gives $\\tau_{xy} = \\sigma_{xy} = \\frac{E}{1+\\nu}\\varepsilon_{xy} = \\frac{E}{2(1+\\nu)}(2\\varepsilon_{xy}) = G\\gamma_{xy}$.\nAssembling the constitutive matrix $\\boldsymbol{D}_{\\mathrm{ps}}$:\n$$\n\\boldsymbol{D}_{\\mathrm{ps}} = \\frac{E}{1-\\nu^2}\n\\begin{pmatrix}\n1  \\nu  0 \\\\\n\\nu  1  0 \\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{pmatrix}\n$$\n\n### Option-by-Option Analysis\n\n**A. For $E0$ and $\\nu \\in (-1,\\tfrac{1}{2})$, both $\\boldsymbol{D}_{\\mathrm{pe}}$ and $\\boldsymbol{D}_{\\mathrm{ps}}$ are symmetric, and consequently $\\boldsymbol{K}_e$ is symmetric in both plane strain and plane stress.**\nBy inspection of the derived matrices, both $\\boldsymbol{D}_{\\mathrm{pe}}$ and $\\boldsymbol{D}_{\\mathrm{ps}}$ are symmetric. The stiffness matrix is given by $\\boldsymbol{K}_e = \\int_{\\Omega_e} \\boldsymbol{B}^{\\top}\\,\\boldsymbol{D}\\,\\boldsymbol{B}\\,\\mathrm{d}\\Omega$. Its transpose is $\\boldsymbol{K}_e^{\\top} = \\int_{\\Omega_e} (\\boldsymbol{B}^{\\top}\\,\\boldsymbol{D}\\,\\boldsymbol{B})^{\\top}\\,\\mathrm{d}\\Omega = \\int_{\\Omega_e} \\boldsymbol{B}^{\\top}\\,\\boldsymbol{D}^{\\top}\\,\\boldsymbol{B}\\,\\mathrm{d}\\Omega$. Since $\\boldsymbol{D}$ is symmetric ($\\boldsymbol{D}^{\\top} = \\boldsymbol{D}$), it follows that $\\boldsymbol{K}_e^{\\top} = \\boldsymbol{K}_e$. Thus, $\\boldsymbol{K}_e$ is symmetric. This holds for both plane strain and plane stress.\n**Verdict: Correct.**\n\n**B. For any fixed $\\nu0$, the in-plane shear contribution to $\\boldsymbol{K}_e$ is strictly larger under plane strain than under plane stress, for the same $\\Omega_e$ and $\\boldsymbol{B}$.**\nThe in-plane shear behavior is governed by the $(3,3)$ entry of the constitutive matrix, which maps $\\gamma_{xy}$ to $\\tau_{xy}$.\nFor plane strain: $(\\boldsymbol{D}_{\\mathrm{pe}})_{33} = G = \\frac{E}{2(1+\\nu)}$.\nFor plane stress: $(\\boldsymbol{D}_{\\mathrm{ps}})_{33} = G = \\frac{E}{2(1+\\nu)}$.\nThe shear moduli are identical. Therefore, the shear contribution to the element stiffness matrix, which depends on this modulus, is also identical, not strictly larger.\n**Verdict: Incorrect.**\n\n**C. As $\\nu \\to \\tfrac{1}{2}^{-}$ with $E$ and $\\Omega_e$ fixed, the spectral condition number of $\\boldsymbol{K}_e$ in plane strain tends to $+\\infty$, whereas in plane stress it remains bounded.**\nThe spectral condition number of $\\boldsymbol{K}_e$ is related to that of $\\boldsymbol{D}$.\nFor plane strain, the prefactor of $\\boldsymbol{D}_{\\mathrm{pe}}$ is $\\frac{E}{(1+\\nu)(1-2\\nu)}$, which tends to $+\\infty$ as $\\nu \\to \\tfrac{1}{2}^{-}$. This term is associated with the bulk modulus. The ratio of the bulk modulus to the shear modulus diverges, causing the condition number of $\\boldsymbol{D}_{\\mathrm{pe}}$ to tend to infinity. This ill-conditioning is passed to $\\boldsymbol{K}_e$, a phenomenon known as volumetric locking.\nFor plane stress, as $\\nu \\to \\tfrac{1}{2}^{-}$, the matrix $\\boldsymbol{D}_{\\mathrm{ps}}$ approaches $\\frac{4E}{3} \\begin{pmatrix} 1  1/2  0 \\\\ 1/2  1  0 \\\\ 0  0  1/4 \\end{pmatrix}$. All entries are finite and the matrix is well-conditioned. Its eigenvalues are finite and non-zero. Consequently, the condition number of $\\boldsymbol{K}_e$ for plane stress remains bounded.\n**Verdict: Correct.**\n\n**D. For any fixed $\\nu0$ and fixed $\\Omega_e$ and $\\boldsymbol{B}$, every entry of $\\boldsymbol{K}_e$ under plane strain is greater than or equal to the corresponding entry under plane stress.**\nThis statement requires that $\\boldsymbol{K}_e^{\\mathrm{pe}} - \\boldsymbol{K}_e^{\\mathrm{ps}}$ be a matrix with all non-negative entries. This difference is $\\int_{\\Omega_e} \\boldsymbol{B}^{\\top}\\,(\\boldsymbol{D}_{\\mathrm{pe}} - \\boldsymbol{D}_{\\mathrm{ps}})\\,\\boldsymbol{B}\\,\\mathrm{d}\\Omega$. The difference matrix $\\Delta\\boldsymbol{D} = \\boldsymbol{D}_{\\mathrm{pe}} - \\boldsymbol{D}_{\\mathrm{ps}}$ is positive semi-definite (see F), but this does not guarantee that every entry of the resulting $\\boldsymbol{K}_e$ difference will be non-negative. The entries of $\\boldsymbol{B}$ (derivatives of shape functions) can be positive or negative, and their combination in the matrix product can lead to negative entries in the final result, particularly in off-diagonal blocks of the stiffness matrix.\n**Verdict: Incorrect.**\n\n**E. Switching between plane strain and plane stress changes the sparsity pattern of $\\boldsymbol{K}_e$ because $\\boldsymbol{D}_{\\mathrm{pe}}$ and $\\boldsymbol{D}_{\\mathrm{ps}}$ have different zero patterns.**\nThe sparsity pattern (the location of zero and non-zero entries) of $\\boldsymbol{D}_{\\mathrm{pe}}$ and $\\boldsymbol{D}_{\\mathrm{ps}}$ is identical. Both are block-diagonal with a dense $2 \\times 2$ block and a $1 \\times 1$ block. The sparsity of the element stiffness matrix $\\boldsymbol{K}_e$ is determined by the mesh connectivity (which nodes share an element) and the structure of $\\boldsymbol{B}$. Since the zero-entry structure of $\\boldsymbol{D}_{\\mathrm{pe}}$ and $\\boldsymbol{D}_{\\mathrm{ps}}$ is the same, the sparsity pattern of $\\boldsymbol{K}_e$ will not change.\n**Verdict: Incorrect.**\n\n**F. For any kinematically admissible displacement field $\\boldsymbol{v}$, and any $\\nu0$, one has the energy density inequality $\\boldsymbol{\\varepsilon}_e(\\boldsymbol{v})^{\\top}\\,\\boldsymbol{D}_{\\mathrm{pe}}\\,\\boldsymbol{\\varepsilon}_e(\\boldsymbol{v}) \\ge \\boldsymbol{\\varepsilon}_e(\\boldsymbol{v})^{\\top}\\,\\boldsymbol{D}_{\\mathrm{ps}}\\,\\boldsymbol{\\varepsilon}_e(\\boldsymbol{v})$, with equality for pure in-plane shear $\\gamma_{xy} \\ne 0$ and $\\varepsilon_{xx}=\\varepsilon_{yy}=0$. Consequently, the shear part of $\\boldsymbol{K}_e$ is identical in plane strain and plane stress, while the normal part is stiffer in plane strain.**\nThe inequality is equivalent to $\\boldsymbol{\\varepsilon}_e^{\\top}\\,(\\boldsymbol{D}_{\\mathrm{pe}} - \\boldsymbol{D}_{\\mathrm{ps}})\\,\\boldsymbol{\\varepsilon}_e \\ge 0$. This requires the matrix $\\Delta\\boldsymbol{D} = \\boldsymbol{D}_{\\mathrm{pe}} - \\boldsymbol{D}_{\\mathrm{ps}}$ to be positive semi-definite. One can show that $\\boldsymbol{D}_{\\mathrm{pe}} - \\boldsymbol{D}_{\\mathrm{ps}} = \\frac{E\\nu^2}{(1-\\nu^2)(1-2\\nu)} \\begin{pmatrix} 1  1  0 \\\\ 1  1  0 \\\\ 0  0  0 \\end{pmatrix}$. For $\\nu \\in (0, 1/2)$, the prefactor is positive. The matrix $\\left(\\begin{smallmatrix} 1  1 \\\\ 1  1 \\end{smallmatrix}\\right)$ has eigenvalues $2$ and $0$, so it is positive semi-definite. Thus, $\\Delta\\boldsymbol{D}$ is positive semi-definite, and the inequality holds. This means plane strain is energetically stiffer than plane stress. Equality holds when $\\boldsymbol{\\varepsilon}_e^{\\top}\\,\\Delta\\boldsymbol{D}\\,\\boldsymbol{\\varepsilon}_e = 0$, which evaluates to a positive constant times $(\\varepsilon_{xx}+\\varepsilon_{yy})^2=0$. This is true if and only if $\\varepsilon_{xx}+\\varepsilon_{yy}=0$. Pure shear ($\\varepsilon_{xx}=\\varepsilon_{yy}=0$) is a case where equality holds. The consequence follows: the shear modulus $G$ is the same, so the shear part of $\\boldsymbol{K}_e$ is identical. The \"normal part,\" associated with the top-left $2 \\times 2$ block of $\\boldsymbol{D}$, is where the difference lies, and the positive semi-definiteness of $\\Delta\\boldsymbol{D}$ shows the plane strain formulation is stiffer.\n**Verdict: Correct.**",
            "answer": "$$\\boxed{ACF}$$"
        }
    ]
}