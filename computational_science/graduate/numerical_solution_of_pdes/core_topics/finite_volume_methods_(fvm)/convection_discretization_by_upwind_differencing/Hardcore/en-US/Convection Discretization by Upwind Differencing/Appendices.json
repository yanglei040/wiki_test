{
    "hands_on_practices": [
        {
            "introduction": "Why can’t we always use a simple, symmetric central difference scheme for convection? This foundational exercise explores the numerical instability that arises in advection-dominated problems and introduces upwinding as the solution. By analyzing the discrete equations, you will see how central differencing can fail, and then use Fourier analysis to prove that the first-order upwind scheme introduces a numerical diffusion that guarantees stability. This practice is essential for understanding the fundamental trade-off between the formal accuracy of centered schemes and the essential robustness of upwind discretizations. ",
            "id": "3374268",
            "problem": "Consider the one-dimensional linear advection–diffusion partial differential equation (PDE)\n$$\nu_{t}(x,t) + a\\,u_{x}(x,t) \\;=\\; \\nu\\,u_{xx}(x,t),\n$$\nwith constant advection speed $a0$ and diffusion coefficient $\\nu0$, posed on a uniform grid with spacing $h0$. The Péclet number on a grid cell is defined by\n$$\n\\mathrm{Pe}_{h} \\;=\\; \\frac{a\\,h}{\\nu}.\n$$\nThe following tasks ask you to reason from first principles of flux balance and Fourier mode analysis.\n\n(a) For the steady operator obtained by setting $u_{t}=0$ and discretizing $u_{x}$ by the second-order central difference and $u_{xx}$ by the second-order central difference on the interior nodes $\\{x_{j}\\}$, write the tri-diagonal discrete operator at a generic interior node $x_{j}$ and determine the condition on $\\mathrm{Pe}_{h}$ under which the resulting coefficient matrix loses the sign structure associated with a monotone $M$-matrix, thereby admitting spurious oscillations in the discrete solution.\n\n(b) For the pure advection PDE\n$$\nu_{t}(x,t) + a\\,u_{x}(x,t) \\;=\\; 0,\n$$\non a periodic domain, consider the semi-discrete method-of-lines with the first-order upwind spatial discretization (for $a0$):\n$$\n\\frac{d}{dt}u_{j}(t) \\;=\\; -\\,a\\,\\frac{u_{j}(t)-u_{j-1}(t)}{h},\n$$\nwhere $u_{j}(t)$ approximates $u(x_{j},t)$ and $x_{j}=j\\,h$. Perform a von Neumann (Fourier) mode analysis by inserting the ansatz $u_{j}(t)=\\hat{u}(t)\\,\\exp\\!\\big(\\mathrm{i}\\,k\\,x_{j}\\big)$ for wavenumber $k\\in\\mathbb{R}$, and derive the exact complex growth rate (eigenvalue) $\\lambda(k)$ of each Fourier mode. Identify the real part $-\\,\\sigma(k)$ that governs amplitude damping and show that the upwind differencing introduces a numerical diffusion whose small-wavenumber limit agrees with the modified equation analysis.\n\n(c) Using your expression for $\\sigma(k)$, quantify the damping rate of the highest-resolvable Fourier mode on the grid, corresponding to $k=\\pi/h$. Express your final answer as a single analytic expression in terms of $a$ and $h$ only. The physical unit of the damping rate is inverse time; express it in $\\mathrm{s}^{-1}$. Do not include units in your final boxed answer, and no rounding is required.",
            "solution": "The problem presents a set of tasks concerning the numerical analysis of the one-dimensional linear advection–diffusion equation. The problem statement is scientifically grounded, well-posed, and objective, providing all necessary information for a rigorous analysis. It is therefore deemed valid. We proceed with a detailed, step-by-step solution to each part.\n\n(a) Analysis of the steady-state central difference scheme.\n\nThe steady-state advection–diffusion equation is obtained by setting the time derivative term $u_t(x,t)$ to $0$:\n$$\na\\,u_{x}(x,t) \\;=\\; \\nu\\,u_{xx}(x,t)\n$$\nThis can be rearranged as $\\nu\\,u_{xx} - a\\,u_x = 0$. We discretize this equation on a uniform grid with spacing $h$ at an interior node $x_j=j\\,h$. Using the second-order central difference approximations for the first and second derivatives:\n$$\nu_x(x_j) \\approx \\frac{u_{j+1} - u_{j-1}}{2h}\n$$\n$$\nu_{xx}(x_j) \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}\n$$\nwhere $u_j$ is the numerical approximation to $u(x_j)$. Substituting these into the steady-state PDE gives the discrete equation at node $j$:\n$$\n\\nu \\left( \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} \\right) - a \\left( \\frac{u_{j+1} - u_{j-1}}{2h} \\right) \\;=\\; 0\n$$\nTo identify the coefficients of the resulting tridiagonal system, we multiply by $h^2$ and group terms by node index:\n$$\n\\nu(u_{j+1} - 2u_j + u_{j-1}) - \\frac{a h}{2} (u_{j+1} - u_{j-1}) \\;=\\; 0\n$$\n$$\n\\left(\\nu + \\frac{a h}{2}\\right) u_{j-1} - 2\\nu u_j + \\left(\\nu - \\frac{a h}{2}\\right) u_{j+1} \\;=\\; 0\n$$\nThis equation represents the $j$-th row of a linear system $A\\mathbf{u} = \\mathbf{f}$. The non-zero entries of this row of the matrix $A$ are:\n$$\nA_{j, j-1} = \\nu + \\frac{a h}{2}, \\quad A_{j, j} = -2\\nu, \\quad A_{j, j+1} = \\nu - \\frac{a h}{2}\n$$\nA matrix is an $M$-matrix if it is a Z-matrix (off-diagonal entries are non-positive) with a positive inverse. For an irreducible Z-matrix, this is equivalent to having positive diagonal entries. Such matrices have desirable properties for discrete operators, including monotonicity, which ensures that the discrete solution does not exhibit spurious, non-physical oscillations.\n\nTo obtain a matrix with positive diagonal entries, we can multiply the discrete equation by $-1$:\n$$\n-\\left(\\nu + \\frac{a h}{2}\\right) u_{j-1} + 2\\nu u_j - \\left(\\nu - \\frac{a h}{2}\\right) u_{j+1} \\;=\\; 0\n$$\nThe corresponding matrix entries for this form are: diagonal $2\\nu$, and off-diagonals $-(\\nu + \\frac{ah}{2})$ and $-(\\nu - \\frac{ah}{2})$.\nThe diagonal entry $2\\nu$ is positive since $\\nu  0$.\nThe left off-diagonal entry, corresponding to $u_{j-1}$, is $-(\\nu + \\frac{ah}{2})$. Since $a0$, $h0$, and $\\nu0$, this term is always negative.\nThe right off-diagonal entry, corresponding to $u_{j+1}$, is $-(\\nu - \\frac{ah}{2})$. For this entry to be non-positive, as required for the M-matrix sign structure, we must have:\n$$\n-\\left(\\nu - \\frac{a h}{2}\\right) \\le 0 \\quad \\implies \\quad \\nu - \\frac{a h}{2} \\ge 0 \\quad \\implies \\quad \\nu \\ge \\frac{a h}{2}\n$$\nDividing by $\\nu$ (since $\\nu0$) and rearranging yields:\n$$\n1 \\ge \\frac{a h}{2\\nu} \\quad \\implies \\quad 2 \\ge \\frac{a h}{\\nu}\n$$\nUsing the definition of the grid Péclet number, $\\mathrm{Pe}_h = \\frac{ah}{\\nu}$, the condition for maintaining the M-matrix sign structure is $\\mathrm{Pe}_h \\le 2$. The matrix loses this sign structure, and thus its guarantee of monotonicity, when this condition is violated. Therefore, the condition under which the matrix loses the desired sign structure is $\\mathrm{Pe}_h  2$. When $\\mathrm{Pe}_h  2$, the coefficient of $u_{j+1}$ changes sign, leading to a loss of diagonal dominance and permitting spurious oscillations in the numerical solution, a well-known deficiency of the central difference scheme for advection-dominated problems.\n\n(b) Von Neumann analysis for the upwind scheme.\n\nWe consider the pure advection equation $u_t + a u_x = 0$ with $a0$, discretized in space using the first-order upwind scheme. The semi-discrete equation at node $j$ is:\n$$\n\\frac{d}{dt}u_{j}(t) \\;=\\; -\\,a\\,\\frac{u_{j}(t)-u_{j-1}(t)}{h}\n$$\nTo perform a von Neumann stability analysis, we substitute the Fourier mode ansatz $u_j(t) = \\hat{u}(t)\\,\\exp(\\mathrm{i}\\,k\\,x_j)$ where $x_j=j\\,h$ and $k$ is the wavenumber.\nThe left-hand side becomes:\n$$\n\\frac{d}{dt} \\left( \\hat{u}(t)\\,\\exp(\\mathrm{i}\\,k\\,j\\,h) \\right) = \\frac{d\\hat{u}}{dt}\\,\\exp(\\mathrm{i}\\,k\\,j\\,h)\n$$\nThe right-hand side becomes:\n$$\n-\\frac{a}{h} \\left( \\hat{u}(t)\\,\\exp(\\mathrm{i}\\,k\\,j\\,h) - \\hat{u}(t)\\,\\exp(\\mathrm{i}\\,k\\,(j-1)\\,h) \\right)\n$$\nEquating the two sides and dividing by the common non-zero factor $\\hat{u}(t)\\,\\exp(\\mathrm{i}\\,k\\,j\\,h)$ yields an ordinary differential equation for the modal amplitude $\\hat{u}(t)$:\n$$\n\\frac{1}{\\hat{u}} \\frac{d\\hat{u}}{dt} = -\\frac{a}{h} \\left( 1 - \\exp(-\\mathrm{i}\\,k\\,h) \\right)\n$$\nThis is of the form $\\frac{d\\hat{u}}{dt} = \\lambda(k)\\hat{u}$, where $\\lambda(k)$ is the complex growth rate (eigenvalue) for the mode with wavenumber $k$:\n$$\n\\lambda(k) = -\\frac{a}{h} \\left( 1 - \\exp(-\\mathrm{i}\\,k\\,h) \\right)\n$$\nUsing Euler's formula, $\\exp(-\\mathrm{i}\\theta) = \\cos(\\theta) - \\mathrm{i}\\sin(\\theta)$, we can separate $\\lambda(k)$ into its real and imaginary parts:\n$$\n\\lambda(k) = -\\frac{a}{h} \\left( 1 - (\\cos(kh) - \\mathrm{i}\\sin(kh)) \\right) = -\\frac{a}{h} (1 - \\cos(kh)) - \\mathrm{i}\\frac{a}{h}\\sin(kh)\n$$\nThe real part of $\\lambda(k)$ governs the amplitude evolution (damping or growth) of the Fourier mode. The problem defines this as $-\\sigma(k)$:\n$$\n\\mathrm{Re}(\\lambda(k)) = -\\sigma(k) = -\\frac{a}{h}(1 - \\cos(kh))\n$$\nThus, the damping rate is $\\sigma(k) = \\frac{a}{h}(1 - \\cos(kh))$. Since $a0$, $h0$, and $(1-\\cos(kh)) \\ge 0$ for all real $k$ and $h$, we have $\\sigma(k) \\ge 0$. This implies $\\mathrm{Re}(\\lambda(k)) \\le 0$, so all Fourier modes are damped or stable, and the scheme is unconditionally stable for all $k$. The non-zero damping for $k \\ne 0$ is a hallmark of numerical dissipation.\n\nTo demonstrate that this numerical dissipation is consistent with modified equation analysis, we examine the small-wavenumber limit, i.e., $kh \\ll 1$. We use the Taylor series expansion for $\\cos(kh)$ around $kh=0$:\n$$\n\\cos(kh) = 1 - \\frac{(kh)^2}{2!} + \\frac{(kh)^4}{4!} - \\dots\n$$\nSubstituting this into the expression for $\\mathrm{Re}(\\lambda(k))$:\n$$\n\\mathrm{Re}(\\lambda(k)) = -\\frac{a}{h}\\left(1 - \\left[1 - \\frac{k^2h^2}{2} + O(k^4h^4)\\right]\\right) = -\\frac{a}{h}\\left(\\frac{k^2h^2}{2} - O(k^4h^4)\\right) = -\\frac{ah}{2}k^2 + O(h^3k^4)\n$$\nThe growth rate of a Fourier mode $\\exp(\\mathrm{i}kx)$ subjected to a diffusion operator $\\nu_{num} u_{xx}$ is $\\nu_{num}(\\mathrm{i}k)^2 = -\\nu_{num}k^2$. Comparing this form with the leading term of $\\mathrm{Re}(\\lambda(k))$, we identify the numerical diffusion coefficient as:\n$$\n\\nu_{num} = \\frac{ah}{2}\n$$\nThis coefficient corresponds to the leading error term in the modified equation for the first-order upwind scheme, which is $u_t + a u_x = \\frac{ah}{2}u_{xx} + O(h^2)$. This confirms that the damping observed in the von Neumann analysis is indeed the numerical diffusion predicted by the modified equation.\n\n(c) Damping rate of the highest-resolvable mode.\n\nOn a grid with spacing $h$, the highest-resolvable wavenumber, or Nyquist wavenumber, corresponds to the mode with the shortest possible wavelength, which is $\\lambda_{min} = 2h$. The wavenumber $k$ is related to wavelength $\\lambda$ by $k=2\\pi/\\lambda$. Therefore, the highest-resolvable wavenumber is:\n$$\nk_{max} = \\frac{2\\pi}{2h} = \\frac{\\pi}{h}\n$$\nThis mode is often called the \"2-delta\" or \"sawtooth\" mode, as it oscillates with a period of $2h$. To quantify its damping rate, we evaluate the expression for $\\sigma(k)$ derived in part (b) at $k = \\pi/h$:\n$$\n\\sigma\\left(\\frac{\\pi}{h}\\right) = \\frac{a}{h} \\left(1 - \\cos\\left(\\frac{\\pi}{h} \\cdot h\\right)\\right)\n$$\n$$\n\\sigma\\left(\\frac{\\pi}{h}\\right) = \\frac{a}{h} \\left(1 - \\cos(\\pi)\\right)\n$$\nSince $\\cos(\\pi) = -1$, the damping rate becomes:\n$$\n\\sigma\\left(\\frac{\\pi}{h}\\right) = \\frac{a}{h} \\left(1 - (-1)\\right) = \\frac{a}{h} (2) = \\frac{2a}{h}\n$$\nThis is the damping rate for the highest-resolvable Fourier mode. The upwind scheme is most dissipative at the highest wavenumbers, effectively smoothing out sharp oscillations. The physical units are inverse time ($\\mathrm{s}^{-1}$), as $a$ has units of length/time and $h$ has units of length.",
            "answer": "$$\\boxed{\\frac{2a}{h}}$$"
        },
        {
            "introduction": "We have established that the upwind scheme introduces numerical diffusion to maintain stability, but what is the physical consequence of this artificial effect? This exercise provides a clear, quantitative answer by analyzing a boundary-layer problem. You will solve the advection-diffusion equation analytically and then numerically, comparing the thickness of the physical boundary layer to the one captured by the upwind scheme. This hands-on comparison offers a tangible way to measure the scheme's added diffusion and appreciate its primary weakness: the tendency to inaccurately smear sharp gradients. ",
            "id": "3374259",
            "problem": "Consider the steady one-dimensional advection–diffusion partial differential equation (PDE)\n$$-a\\,u_{x} + \\epsilon\\,u_{xx} = 0 \\quad \\text{on } (0,1),$$\nwith a strictly positive constant advection speed $a0$ and diffusion coefficient $\\epsilon0$, subject to boundary conditions\n$$u(0)=0, \\quad u(1)=1.$$\nDefine, for any strictly increasing profile $v(x)$ on $[0,1]$ and any fixed $0\\alpha1$, the boundary-layer thickness at $x=1$ by the unique $\\delta(\\alpha)\\in[0,1]$ such that\n$$v(1-\\delta(\\alpha))=\\alpha.$$\nYour tasks are:\n1) Starting from the differential equation and boundary conditions, solve for the continuous solution $u(x)$ and, using the above definition, obtain the exact expression for the continuous boundary-layer thickness $\\delta_{\\mathrm{cont}}(\\alpha)$.\n2) Discretize the PDE on a uniform grid $x_{i}=i h$ with $h=1/N$ for a positive integer $N$, interior indices $i=1,\\dots,N-1$, and enforce $u_{0}=0$, $u_{N}=1$. Use the first-order upwind difference for the advective derivative and the standard three-point second-order central difference for the diffusive term, namely\n$$-a\\,\\frac{u_{i}-u_{i-1}}{h}+\\epsilon\\,\\frac{u_{i+1}-2u_{i}+u_{i-1}}{h^{2}}=0.$$\nSolve the resulting linear recurrence in closed form for $u_{i}$. Then, adopting the geometric inner-layer approximation that is valid in the advection-dominated limit and for distances of $\\mathcal{O}(h)$ from $x=1$, determine the discrete boundary-layer thickness $\\delta_{\\mathrm{disc}}(\\alpha)$ defined by $u_{N-\\delta_{\\mathrm{disc}}(\\alpha)/h}=\\alpha$, expressed explicitly in terms of $a$, $\\epsilon$, $h$, and $\\alpha$.\n3) Form the ratio\n$$R(\\epsilon,h,a) \\equiv \\frac{\\delta_{\\mathrm{disc}}(\\alpha)}{\\delta_{\\mathrm{cont}}(\\alpha)}.$$\nDerive a closed-form analytic expression for $R(\\epsilon,h,a)$ and show that it is independent of $\\alpha$. Asymptotically interpret $R(\\epsilon,h,a)$ as $\\epsilon\\to 0^{+}$ with fixed $a0$ and $h0$.\n\nProvide only the final closed-form analytic expression for $R(\\epsilon,h,a)$ as your answer. No rounding is required and no units are to be reported.",
            "solution": "This problem is divided into three parts. First, we find the exact analytical solution to the continuous advection-diffusion equation and derive the corresponding boundary-layer thickness. Second, we solve the discretized version of the equation using the specified numerical scheme and determine the discrete boundary-layer thickness under an appropriate approximation. Third, we compute the ratio of the discrete to the continuous boundary-layer thickness and analyze its behavior.\n\n### Part 1: Continuous Solution and Boundary-Layer Thickness\n\nThe given steady one-dimensional advection–diffusion equation is:\n$$ \\epsilon\\,u_{xx} - a\\,u_{x} = 0 \\quad \\text{on } (0,1) $$\nwith $a0$, $\\epsilon0$. This is a linear, second-order ordinary differential equation with constant coefficients. The characteristic equation is given by:\n$$ \\epsilon r^2 - ar = 0 $$\n$$ r(\\epsilon r - a) = 0 $$\nThe roots are $r_1=0$ and $r_2=a/\\epsilon$. The general solution for $u(x)$ is therefore:\n$$ u(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x} = C_1 + C_2 \\exp\\left(\\frac{ax}{\\epsilon}\\right) $$\nThe constants $C_1$ and $C_2$ are determined by the boundary conditions $u(0)=0$ and $u(1)=1$.\nApplying $u(0)=0$:\n$$ C_1 + C_2 \\exp(0) = 0 \\implies C_1 + C_2 = 0 \\implies C_1 = -C_2 $$\nApplying $u(1)=1$:\n$$ C_1 + C_2 \\exp\\left(\\frac{a}{\\epsilon}\\right) = 1 $$\nSubstituting $C_1 = -C_2$ into the second equation gives:\n$$ -C_2 + C_2 \\exp\\left(\\frac{a}{\\epsilon}\\right) = 1 \\implies C_2 \\left(\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1\\right) = 1 $$\n$$ C_2 = \\frac{1}{\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1} $$\nand thus $C_1 = -C_2 = -\\frac{1}{\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1}$.\nThe exact continuous solution is:\n$$ u(x) = \\frac{\\exp\\left(\\frac{ax}{\\epsilon}\\right) - 1}{\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1} $$\nThe boundary-layer thickness, $\\delta_{\\mathrm{cont}}(\\alpha)$, is defined by $u(1-\\delta_{\\mathrm{cont}}(\\alpha)) = \\alpha$. Substituting $x = 1 - \\delta_{\\mathrm{cont}}(\\alpha)$ into the solution:\n$$ \\frac{\\exp\\left(\\frac{a(1-\\delta_{\\mathrm{cont}})}{\\epsilon}\\right) - 1}{\\exp\\left(\\frac{a}{\\epsilon}\\right) - 1} = \\alpha $$\nSolving for $\\delta_{\\mathrm{cont}}$:\n$$ \\exp\\left(\\frac{a}{\\epsilon} - \\frac{a\\delta_{\\mathrm{cont}}}{\\epsilon}\\right) - 1 = \\alpha \\left(\\exp\\left(\\frac{a}{\\epsilon}\\right)-1\\right) $$\n$$ \\exp\\left(\\frac{a}{\\epsilon}\\right) \\exp\\left(-\\frac{a\\delta_{\\mathrm{cont}}}{\\epsilon}\\right) = 1 + \\alpha \\exp\\left(\\frac{a}{\\epsilon}\\right) - \\alpha $$\n$$ \\exp\\left(-\\frac{a\\delta_{\\mathrm{cont}}}{\\epsilon}\\right) = \\frac{1-\\alpha + \\alpha \\exp\\left(\\frac{a}{\\epsilon}\\right)}{\\exp\\left(\\frac{a}{\\epsilon}\\right)} = \\alpha + (1-\\alpha)\\exp\\left(-\\frac{a}{\\epsilon}\\right) $$\n$$ -\\frac{a\\delta_{\\mathrm{cont}}}{\\epsilon} = \\ln\\left(\\alpha + (1-\\alpha)\\exp\\left(-\\frac{a}{\\epsilon}\\right)\\right) $$\n$$ \\delta_{\\mathrm{cont}}(\\alpha) = -\\frac{\\epsilon}{a} \\ln\\left(\\alpha + (1-\\alpha)\\exp\\left(-\\frac{a}{\\epsilon}\\right)\\right) $$\nFor the subsequent analysis, which is to be performed in the advection-dominated limit ($\\epsilon \\to 0^+$), we approximate this expression. In this limit, $a/\\epsilon \\to \\infty$, so $\\exp(-a/\\epsilon) \\to 0$. The expression for $\\delta_{\\mathrm{cont}}$ simplifies to:\n$$ \\delta_{\\mathrm{cont}}(\\alpha) \\approx -\\frac{\\epsilon}{a} \\ln(\\alpha) $$\n\n### Part 2: Discrete Solution and Boundary-Layer Thickness\n\nThe given finite difference equation is:\n$$ -a\\,\\frac{u_{i}-u_{i-1}}{h}+\\epsilon\\,\\frac{u_{i+1}-2u_{i}+u_{i-1}}{h^{2}}=0 $$\nMultiplying by $h^2$ and rearranging terms, we obtain a linear recurrence relation for $u_i$:\n$$ -ah(u_i - u_{i-1}) + \\epsilon(u_{i+1} - 2u_i + u_{i-1}) = 0 $$\n$$ \\epsilon u_{i+1} - (ah + 2\\epsilon)u_i + (ah + \\epsilon)u_{i-1} = 0 $$\nThe characteristic equation for this recurrence is:\n$$ \\epsilon r^2 - (ah + 2\\epsilon)r + (ah + \\epsilon) = 0 $$\nThe sum of the coefficients is $\\epsilon - (ah+2\\epsilon) + (ah+\\epsilon) = 0$, so $r_1=1$ is a root. The product of the roots is $r_1 r_2 = (ah+\\epsilon)/\\epsilon$. Thus, the second root is:\n$$ r_2 = 1 + \\frac{ah}{\\epsilon} $$\nThe general solution for the discrete profile $u_i$ is:\n$$ u_i = D_1 (r_1)^i + D_2 (r_2)^i = D_1 + D_2 \\left(1+\\frac{ah}{\\epsilon}\\right)^i $$\nThe constants $D_1$ and $D_2$ are determined by the boundary conditions $u_0=0$ and $u_N=1$.\nFor $i=0$: $u_0 = D_1 + D_2 = 0 \\implies D_1 = -D_2$.\nFor $i=N$: $u_N = D_1 + D_2 \\left(1+\\frac{ah}{\\epsilon}\\right)^N = 1$.\nSubstituting $D_1 = -D_2$:\n$$ -D_2 + D_2 \\left(1+\\frac{ah}{\\epsilon}\\right)^N = 1 \\implies D_2 \\left(\\left(1+\\frac{ah}{\\epsilon}\\right)^N - 1\\right) = 1 $$\n$$ D_2 = \\frac{1}{\\left(1+\\frac{ah}{\\epsilon}\\right)^N - 1} $$\nThe discrete solution is:\n$$ u_i = \\frac{\\left(1+\\frac{ah}{\\epsilon}\\right)^i - 1}{\\left(1+\\frac{ah}{\\epsilon}\\right)^N - 1} $$\nWe now find the discrete boundary-layer thickness $\\delta_{\\mathrm{disc}}(\\alpha)$ using the definition $u_{N-\\delta_{\\mathrm{disc}}/h} = \\alpha$. Let $k = \\delta_{\\mathrm{disc}}/h$ be the number of grid cells corresponding to the layer thickness. The index is $i=N-k$. The problem specifies using the \"geometric inner-layer approximation\" valid for advection-dominated flows ($\\epsilon \\to 0^+$) and near $x=1$ (small $k$). Let $\\rho = 1 + ah/\\epsilon$. The solution at $i=N-k$ is:\n$$ u_{N-k} = \\frac{\\rho^{N-k}-1}{\\rho^{N}-1} = \\frac{\\rho^N \\rho^{-k} - 1}{\\rho^N - 1} $$\nIn the advection-dominated limit, the cell Péclet number $P_h=ah/\\epsilon$ is large, thus $\\rho = 1+P_h \\gg 1$. For a sufficiently fine grid ($N$ large), $\\rho^N$ is very large. The approximation consists of neglecting the $-1$ terms in the numerator and denominator:\n$$ u_{N-k} \\approx \\frac{\\rho^N \\rho^{-k}}{\\rho^N} = \\rho^{-k} $$\nSetting this equal to $\\alpha$ gives:\n$$ \\alpha \\approx \\rho^{-k} = \\left(1+\\frac{ah}{\\epsilon}\\right)^{-k} = \\left(1+\\frac{ah}{\\epsilon}\\right)^{-\\delta_{\\mathrm{disc}}/h} $$\nTaking the natural logarithm of both sides:\n$$ \\ln(\\alpha) \\approx -\\frac{\\delta_{\\mathrm{disc}}}{h} \\ln\\left(1+\\frac{ah}{\\epsilon}\\right) $$\nSolving for $\\delta_{\\mathrm{disc}}(\\alpha)$:\n$$ \\delta_{\\mathrm{disc}}(\\alpha) \\approx -h \\frac{\\ln(\\alpha)}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)} $$\n\n### Part 3: Ratio of Boundary-Layer Thicknesses\n\nWe form the ratio $R(\\epsilon, h, a) = \\delta_{\\mathrm{disc}}(\\alpha) / \\delta_{\\mathrm{cont}}(\\alpha)$ using the expressions derived from the approximations appropriate for the advection-dominated limit.\n$$ R(\\epsilon,h,a) = \\frac{\\delta_{\\mathrm{disc}}(\\alpha)}{\\delta_{\\mathrm{cont}}(\\alpha)} \\approx \\frac{-h \\frac{\\ln(\\alpha)}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)}}{-\\frac{\\epsilon}{a} \\ln(\\alpha)} $$\nThe term $\\ln(\\alpha)$ cancels from the numerator and the denominator, demonstrating that the ratio $R$ is independent of $\\alpha$:\n$$ R(\\epsilon,h,a) = \\frac{h}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)} \\frac{a}{\\epsilon} = \\frac{\\frac{ah}{\\epsilon}}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)} $$\nThis is the final closed-form expression for the ratio.\n\nFor the asymptotic interpretation, we consider the limit $\\epsilon \\to 0^+$ while $a0$ and $h0$ are fixed. This corresponds to the cell Péclet number $P_h = ah/\\epsilon \\to \\infty$.\n$$ \\lim_{\\epsilon\\to 0^+} R(\\epsilon,h,a) = \\lim_{P_h\\to\\infty} \\frac{P_h}{\\ln(1+P_h)} $$\nUsing L'Hôpital's rule, this limit is $\\infty$. This means that for very small physical diffusion $\\epsilon$, the boundary layer produced by the upwind numerical scheme is much thicker than the true physical boundary layer. The upwind scheme introduces a large amount of numerical diffusion, which is proportional to the grid spacing $h$ and advection speed $a$, and this numerical diffusion dominates the physical diffusion $\\epsilon$, artificially broadening the boundary layer.",
            "answer": "$$\\boxed{\\frac{\\frac{ah}{\\epsilon}}{\\ln\\left(1+\\frac{ah}{\\epsilon}\\right)}}$$"
        },
        {
            "introduction": "Correctly applying numerical methods to equations with variable coefficients is critical for modeling real-world physical systems. This problem contrasts two different ways to implement an upwind scheme: a non-conservative finite-difference approach and a conservative finite-volume approach. By testing whether each scheme can preserve a constant solution and conserve a quantity across the domain, you will uncover the subtle but crucial importance of the conservative formulation. This practice highlights a core principle in computational fluid dynamics, ensuring that your numerical model respects the physical conservation laws it is meant to simulate. ",
            "id": "3374229",
            "problem": "Consider the linear advection Partial Differential Equation (PDE) in nondivergence form $u_t + a(x)\\,u_x = 0$ posed on a periodic interval $[0,L]$, where $a(x)$ is a given smooth function that may vary in space and may change sign. Let the domain be partitioned into $N$ uniform cells of width $\\Delta x = L/N$ with cell centers $x_i$ and interfaces $x_{i\\pm 1/2}$, and define a time step $\\Delta t$. Two first-order upwind semi-discrete schemes are considered:\n\n- Conservative upwind (finite-volume) scheme $S_c$: approximate the conservation law $u_t + (a(x)\\,u)_x = 0$ by\n$$\nU_i^{n+1} \\;=\\; U_i^n \\;-\\; \\frac{\\Delta t}{\\Delta x}\\,\\Big(F_{i+1/2}^n \\;-\\; F_{i-1/2}^n\\Big),\n$$\nwith upwind numerical flux\n$$\nF_{i+1/2}^n \\;=\\; a_{i+1/2}^+\\,U_i^n \\;+\\; a_{i+1/2}^-\\,U_{i+1}^n,\n$$\nwhere $a_{i+1/2} = a(x_{i+1/2})$, $a_{i+1/2}^+ = \\max\\{a_{i+1/2},\\,0\\}$, and $a_{i+1/2}^- = \\min\\{a_{i+1/2},\\,0\\}$.\n\n- Nonconservative upwind (finite-difference) scheme $S_{nc}$: discretize $u_t + a(x)\\,u_x = 0$ at cell centers by\n$$\nU_i^{n+1} \\;=\\; U_i^n \\;-\\; \\frac{\\Delta t}{\\Delta x}\\,\\Big(a_i^+\\,(U_i^n - U_{i-1}^n) \\;+\\; a_i^-\\,(U_{i+1}^n - U_i^n)\\Big),\n$$\nwhere $a_i = a(x_i)$, $a_i^+ = \\max\\{a_i,\\,0\\}$, and $a_i^- = \\min\\{a_i,\\,0\\}$.\n\nAssume periodic boundary conditions so that indices are taken modulo $N$. Define the discrete spatial average at time level $n$ by\n$$\n\\bar{U}^n \\;=\\; \\frac{1}{N}\\sum_{i=1}^N U_i^n.\n$$\n\nWhich of the following statements are correct for smooth variable $a(x)$ and periodic boundaries?\n\nA. For any smooth variable $a(x)$ and periodic boundary conditions, scheme $S_c$ preserves the discrete spatial average $\\bar{U}^n$ exactly in time, i.e., $\\bar{U}^{n+1} = \\bar{U}^n$ for all $n$.\n\nB. For any smooth variable $a(x)$ and periodic boundary conditions, scheme $S_{nc}$ preserves the discrete spatial average $\\bar{U}^n$ exactly in time, i.e., $\\bar{U}^{n+1} = \\bar{U}^n$ for all $n$.\n\nC. For any smooth variable $a(x)$, if the initial data is constant $U_i^0 \\equiv C$ for all $i$ with $C$ independent of $x$, then scheme $S_c$ keeps the solution exactly constant in time, i.e., $U_i^n \\equiv C$ for all $n$.\n\nD. For any smooth variable $a(x)$, if the initial data is constant $U_i^0 \\equiv C$ for all $i$ with $C$ independent of $x$, then scheme $S_{nc}$ keeps the solution exactly constant in time, i.e., $U_i^n \\equiv C$ for all $n$.",
            "solution": "The problem presents two numerical schemes, one conservative ($S_c$) and one non-conservative ($S_{nc}$), for the linear advection equation with a spatially varying coefficient $a(x)$. We are asked to evaluate four statements about the properties of these schemes under periodic boundary conditions.\n\nA crucial point is the distinction between the PDE in non-divergence form, $u_t + a(x)u_x = 0$, and the PDE in conservation form, $u_t + (a(x)u)_x = 0$. These two equations are only equivalent if $a(x)$ is a constant, because by the product rule, $(a(x)u)_x = a(x)u_x + a'(x)u$. Thus, the conservation form is equivalent to $u_t + a(x)u_x = -a'(x)u$. Scheme $S_c$ is explicitly stated to approximate the conservation form, while scheme $S_{nc}$ discretizes the non-divergence form.\n\nLet's analyze each statement.\n\n### Analysis of Statement A\n**Statement A:** For any smooth variable $a(x)$ and periodic boundary conditions, scheme $S_c$ preserves the discrete spatial average $\\bar{U}^n$ exactly in time, i.e., $\\bar{U}^{n+1} = \\bar{U}^n$ for all $n$.\n\nThe discrete spatial average is defined as $\\bar{U}^n = \\frac{1}{N}\\sum_{i=1}^N U_i^n$. To check if it is preserved, we need to analyze the sum $\\sum_{i=1}^N U_i^{n+1}$.\nThe scheme $S_c$ is given by:\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\,\\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big)\n$$\nSumming over all grid cells $i=1, \\dots, N$:\n$$\n\\sum_{i=1}^N U_i^{n+1} = \\sum_{i=1}^N U_i^n - \\frac{\\Delta t}{\\Delta x} \\sum_{i=1}^N \\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big)\n$$\nThe second sum on the right-hand side is a telescoping sum:\n$$\n\\sum_{i=1}^N \\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big) = (F_{3/2}^n - F_{1/2}^n) + (F_{5/2}^n - F_{3/2}^n) + \\dots + (F_{N+1/2}^n - F_{N-1/2}^n)\n$$\nAfter cancellation of intermediate terms, the sum simplifies to:\n$$\n\\sum_{i=1}^N \\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big) = F_{N+1/2}^n - F_{1/2}^n\n$$\nThe problem states that periodic boundary conditions are used, with indices taken modulo $N$. This implies that the grid point $x_{i+N} = x_i$ and the cell-centered value $U_{i+N}^n = U_i^n$. Consequently, the interface $x_{N+1/2}$ is a periodic copy of $x_{1/2}$. The numerical flux $F_{i+1/2}^n$ depends on $a_{i+1/2} = a(x_{i+1/2})$, $U_i^n$, and $U_{i+1}^n$.\nFor the flux at the periodic boundary, we have:\n$$\nF_{N+1/2}^n = a_{N+1/2}^+ U_N^n + a_{N+1/2}^- U_{N+1}^n\n$$\nBy periodicity, $x_{N+1/2}$ corresponds to the same physical location as $x_{1/2}$, so $a_{N+1/2} = a(x_{N+1/2}) = a(x_{1/2}) = a_{1/2}$. Also, $U_{N+1}^n$ is the value in cell $N+1$, which is cell $1$, so $U_{N+1}^n = U_1^n$. Thus,\n$$\nF_{N+1/2}^n = a_{1/2}^+ U_N^n + a_{1/2}^- U_1^n\n$$\nThe flux $F_{1/2}^n$ is defined as $F_{1/2}^n = a_{1/2}^+ U_0^n + a_{1/2}^- U_1^n$. By periodicity, cell $0$ is cell $N$, so $U_0^n = U_N^n$.\n$$\nF_{1/2}^n = a_{1/2}^+ U_N^n + a_{1/2}^- U_1^n\n$$\nTherefore, $F_{N+1/2}^n = F_{1/2}^n$, and the telescoping sum is zero. This property holds for any scheme written in this flux-difference form under periodic boundary conditions.\nThis leads to:\n$$\n\\sum_{i=1}^N U_i^{n+1} = \\sum_{i=1}^N U_i^n\n$$\nDividing by $N$ gives $\\bar{U}^{n+1} = \\bar{U}^n$. The discrete spatial average is conserved.\n\n**Verdict on A:** Correct.\n\n### Analysis of Statement B\n**Statement B:** For any smooth variable $a(x)$ and periodic boundary conditions, scheme $S_{nc}$ preserves the discrete spatial average $\\bar{U}^n$ exactly in time, i.e., $\\bar{U}^{n+1} = \\bar{U}^n$ for all $n$.\n\nThe scheme $S_{nc}$ is given by:\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\,\\Big(a_i^+\\,(U_i^n - U_{i-1}^n) + a_i^-\\,(U_{i+1}^n - U_i^n)\\Big)\n$$\nSumming over $i=1, \\dots, N$:\n$$\n\\sum_{i=1}^N U_i^{n+1} = \\sum_{i=1}^N U_i^n - \\frac{\\Delta t}{\\Delta x} \\sum_{i=1}^N \\Big(a_i^+\\,(U_i^n - U_{i-1}^n) + a_i^-\\,(U_{i+1}^n - U_i^n)\\Big)\n$$\nFor the average to be preserved, the summation term on the right must be zero for any set of values $\\{U_j^n\\}$. Let's analyze this sum, $S$:\n$$\nS = \\sum_{i=1}^N a_i^+ U_i^n - \\sum_{i=1}^N a_i^+ U_{i-1}^n + \\sum_{i=1}^N a_i^- U_{i+1}^n - \\sum_{i=1}^N a_i^- U_i^n\n$$\nWe perform a change of index on the second and third sums, using periodicity ($U_0=U_N$, $U_{N+1}=U_1$, etc.).\nLet $j=i-1$ in the second sum: $\\sum_{i=1}^N a_i^+ U_{i-1}^n = \\sum_{j=0}^{N-1} a_{j+1}^+ U_j^n = \\sum_{j=1}^N a_{j+1}^+ U_j^n$.\nLet $j=i+1$ in the third sum: $\\sum_{i=1}^N a_i^- U_{i+1}^n = \\sum_{j=2}^{N+1} a_{j-1}^- U_j^n = \\sum_{j=1}^N a_{j-1}^- U_j^n$.\nSubstituting these back and using $i$ as the summation index:\n$$\nS = \\sum_{i=1}^N a_i^+ U_i^n - \\sum_{i=1}^N a_{i+1}^+ U_i^n + \\sum_{i=1}^N a_{i-1}^- U_i^n - \\sum_{i=1}^N a_i^- U_i^n\n$$\nCombining terms:\n$$\nS = \\sum_{i=1}^N \\Big( (a_i^+ - a_{i+1}^+) + (a_{i-1}^- - a_i^-) \\Big) U_i^n\n$$\nThis sum is zero for an arbitrary profile $U^n$ if and only if the coefficient of each $U_i^n$ is zero, i.e., $a_i^+ - a_{i+1}^+ + a_{i-1}^- - a_i^- = 0$ for all $i$.\nIf $a(x)$ is constant, $a_i = a$ for all $i$, then $a_i^+=a_{i+1}^+$ and $a_{i-1}^-=a_i^-$, so the condition holds. However, the problem specifies a *variable* $a(x)$. Let's consider a simple case where $a(x)  0$ for all $x$. Then $a_i^+=a_i$ and $a_i^-=0$ for all $i$. The condition becomes $a_i - a_{i+1} = 0$, which means $a(x)$ is constant, contradicting the premise. Therefore, for a general variable coefficient $a(x)$, the sum $S$ is not zero, and the average is not preserved.\n\n**Verdict on B:** Incorrect.\n\n### Analysis of Statement C\n**Statement C:** For any smooth variable $a(x)$, if the initial data is constant $U_i^0 \\equiv C$ for all $i$ with $C$ independent of $x$, then scheme $S_c$ keeps the solution exactly constant in time, i.e., $U_i^n \\equiv C$ for all $n$.\n\nLet us assume that at time level $n$, the solution is constant, $U_j^n = C$ for all $j=1, \\dots, N$. We check the value at time $n+1$ using scheme $S_c$.\nFirst, we evaluate the numerical flux $F_{i+1/2}^n$:\n$$\nF_{i+1/2}^n = a_{i+1/2}^+\\,U_i^n + a_{i+1/2}^-\\,U_{i+1}^n\n$$\nSubstituting $U_i^n = C$ and $U_{i+1}^n = C$:\n$$\nF_{i+1/2}^n = a_{i+1/2}^+\\,C + a_{i+1/2}^-\\,C = (a_{i+1/2}^+ + a_{i+1/2}^-)\\,C\n$$\nFor any real number $z$, we have the identity $z^+ + z^- = \\max(z,0) + \\min(z,0) = z$.\nThus, $a_{i+1/2}^+ + a_{i+1/2}^- = a_{i+1/2}$.\nThe flux becomes $F_{i+1/2}^n = a_{i+1/2}\\,C$. This is the exact physical flux $f(u,x) = a(x)u$ evaluated at $u=C$.\nNow, we use the update rule for $S_c$:\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\,\\Big(F_{i+1/2}^n - F_{i-1/2}^n\\Big)\n$$\nSubstituting $U_i^n=C$ and the fluxes $F_{i+1/2}^n = a_{i+1/2}\\,C$ and $F_{i-1/2}^n = a_{i-1/2}\\,C$:\n$$\nU_i^{n+1} = C - \\frac{\\Delta t}{\\Delta x} \\Big(a_{i+1/2}\\,C - a_{i-1/2}\\,C\\Big) = C - C\\,\\frac{\\Delta t}{\\Delta x} \\Big(a_{i+1/2} - a_{i-1/2}\\Big)\n$$\nFor $U_i^{n+1}$ to be equal to $C$, the term $C\\,\\frac{\\Delta t}{\\Delta x} (a_{i+1/2} - a_{i-1/2})$ must be zero. Assuming $C \\neq 0$, this requires $a_{i+1/2} = a_{i-1/2}$ for all $i$. This implies that the function $a(x)$ is constant, which contradicts the premise that $a(x)$ is a variable function. Scheme $S_c$ discretizes the PDE $u_t + (a(x)u)_x=0$. A constant state $u=C \\ne 0$ is a solution to this PDE only if $(a(x)C)_x = C a'(x)=0$, i.e., if $a(x)$ is constant. Since the scheme is consistent with this PDE, it correctly evolves a constant state into a non-constant one when $a(x)$ is variable.\n\n**Verdict on C:** Incorrect.\n\n### Analysis of Statement D\n**Statement D:** For any smooth variable $a(x)$, if the initial data is constant $U_i^0 \\equiv C$ for all $i$ with $C$ independent of $x$, then scheme $S_{nc}$ keeps the solution exactly constant in time, i.e., $U_i^n \\equiv C$ for all $n$.\n\nLet's assume $U_j^n = C$ for all $j$ at time level $n$. The update rule for $S_{nc}$ is:\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\,\\Big(a_i^+\\,(U_i^n - U_{i-1}^n) + a_i^-\\,(U_{i+1}^n - U_i^n)\\Big)\n$$\nWe substitute $U_j^n = C$ for all relevant indices:\nThe differences become $U_i^n - U_{i-1}^n = C - C = 0$ and $U_{i+1}^n - U_i^n = C - C = 0$.\nThe update equation simplifies to:\n$$\nU_i^{n+1} = C - \\frac{\\Delta t}{\\Delta x}\\,\\Big(a_i^+\\,(0) + a_i^-\\,(0)\\Big) = C - 0 = C\n$$\nThis holds for any cell $i$ and is independent of the value of $a_i$. Thus, if the solution is constant at time $n$, it remains constant at time $n+1$. By induction, if $U_i^0=C$ for all $i$, then $U_i^n=C$ for all $n \\ge 0$. This property is a basic consistency requirement for any scheme purporting to solve $u_t+a(x)u_x=0$, since $u(x,t)=C$ is a trivial solution of this PDE.\n\n**Verdict on D:** Correct.\n\n### Summary\n- Statement A is correct because $S_c$ is a conservative finite-volume scheme, and for such schemes, the total sum of the solution values is conserved under periodic boundary conditions.\n- Statement B is incorrect because $S_{nc}$ is a non-conservative finite-difference scheme which does not guarantee conservation of the spatial average for a variable coefficient $a(x)$.\n- Statement C is incorrect because $S_c$ is a consistent discretization of $u_t + (a(x)u)_x = 0$, for which a constant state is not a solution if $a(x)$ is variable. The scheme correctly reflects this.\n- Statement D is correct because $S_{nc}$ is a consistent discretization of $u_t + a(x)u_x = 0$, for which a constant state is a solution. The scheme's spatial operator correctly evaluates to zero for a constant function.\n\nThe correct statements are A and D.",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}