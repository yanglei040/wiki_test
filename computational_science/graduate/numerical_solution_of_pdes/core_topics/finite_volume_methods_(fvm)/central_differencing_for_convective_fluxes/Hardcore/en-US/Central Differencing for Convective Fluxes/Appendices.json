{
    "hands_on_practices": [
        {
            "introduction": "To truly understand the behavior of a numerical scheme, we must analyze its effect on the fundamental components of a solution, such as sinusoidal waves. This exercise guides you through a Fourier analysis of the central differencing scheme applied to the linear advection equation . By deriving the discrete convective term for a single Fourier mode, you will uncover how the numerical approximation alters wave propagation, a phenomenon known as numerical dispersion, which is crucial for predicting the scheme's performance on more complex problems.",
            "id": "3369209",
            "problem": "Consider the one-dimensional linear advection partial differential equation (PDE) $\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial (a \\phi)}{\\partial x} = 0$ with constant velocity $a0$ on a periodic domain. Using the Finite Volume Method (FVM) on a uniform grid with cell centers at $x_i$ and spacing $\\Delta x0$, define the convective face flux at face $i+\\tfrac{1}{2}$ as $F_{i+\\tfrac{1}{2}} = a\\,\\phi_{i+\\tfrac{1}{2}}$, where the face value $\\phi_{i+\\tfrac{1}{2}}$ is given by the central interpolation $\\phi_{i+\\tfrac{1}{2}} = \\tfrac{1}{2}(\\phi_i + \\phi_{i+1})$; analogously for $i-\\tfrac{1}{2}$. The semidiscrete convective term in the cell balance is $\\left(F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}\\right)/\\Delta x$.\n\nSuppose that the cell-centered solution is a single Fourier mode $\\phi_i = \\sin(k x_i)$, where $k$ is a real wavenumber. Starting from the conservation-law cell balance and the central interpolation defined above, derive closed-form expressions for:\n- the central face fluxes $F_{i-\\tfrac{1}{2}}$ and $F_{i+\\tfrac{1}{2}}$, and\n- the resulting discrete convective term at cell $i$, $C_i = \\left(F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}\\right)/\\Delta x$,\n\nall expressed in terms of $a$, $k$, $x_i$, and $\\Delta x$ only.\n\nExpress your final answer as a single row matrix in the order $\\big[F_{i-\\tfrac{1}{2}},\\,F_{i+\\tfrac{1}{2}},\\,C_i\\big]$. No units are required. No numerical rounding is required; provide exact closed-form expressions.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary definitions for the Finite Volume Method discretization of the linear advection equation are provided. The task is a standard exercise in numerical analysis, specifically the Fourier analysis of a numerical scheme.\n\nThe problem asks for the derivation of the face fluxes $F_{i-\\tfrac{1}{2}}$ and $F_{i+\\tfrac{1}{2}}$, and the resulting discrete convective term $C_i$, for a one-dimensional linear advection equation. The derivation proceeds from the given definitions.\n\nThe governing partial differential equation is:\n$$ \\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial (a \\phi)}{\\partial x} = 0 $$\nwhere $a > 0$ is a constant velocity.\n\nThe cell-centered solution at grid point $i$ is given as a single Fourier mode:\n$$ \\phi_i = \\sin(k x_i) $$\nwhere $k$ is the wavenumber and $x_i$ is the coordinate of the cell center $i$. The grid is uniform with spacing $\\Delta x > 0$, so the coordinates of the adjacent cell centers are $x_{i+1} = x_i + \\Delta x$ and $x_{i-1} = x_i - \\Delta x$.\n\nThe values of the solution at the neighboring cell centers are therefore:\n$$ \\phi_{i+1} = \\sin(k x_{i+1}) = \\sin(k(x_i + \\Delta x)) $$\n$$ \\phi_{i-1} = \\sin(k x_{i-1}) = \\sin(k(x_i - \\Delta x)) $$\n\nFirst, we derive the expression for the face flux $F_{i+\\tfrac{1}{2}}$.\nThe convective flux at face $i+\\tfrac{1}{2}$ is defined as $F_{i+\\tfrac{1}{2}} = a\\,\\phi_{i+\\tfrac{1}{2}}$. The face value $\\phi_{i+\\tfrac{1}{2}}$ is obtained by central interpolation:\n$$ \\phi_{i+\\tfrac{1}{2}} = \\frac{1}{2}(\\phi_i + \\phi_{i+1}) $$\nSubstituting the expressions for $\\phi_i$ and $\\phi_{i+1}$:\n$$ \\phi_{i+\\tfrac{1}{2}} = \\frac{1}{2} \\left[ \\sin(k x_i) + \\sin(k(x_i + \\Delta x)) \\right] $$\nWe use the sum-to-product trigonometric identity $\\sin(A) + \\sin(B) = 2 \\sin\\left(\\frac{A+B}{2}\\right) \\cos\\left(\\frac{A-B}{2}\\right)$. Let $A = k(x_i + \\Delta x)$ and $B = k x_i$.\n$$ \\frac{A+B}{2} = \\frac{k x_i + k \\Delta x + k x_i}{2} = k x_i + \\frac{k \\Delta x}{2} $$\n$$ \\frac{A-B}{2} = \\frac{k x_i + k \\Delta x - k x_i}{2} = \\frac{k \\Delta x}{2} $$\nApplying the identity, we get:\n$$ \\sin(k x_i) + \\sin(k(x_i + \\Delta x)) = 2 \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) $$\nSubstituting this back into the expression for $\\phi_{i+\\tfrac{1}{2}}$:\n$$ \\phi_{i+\\tfrac{1}{2}} = \\frac{1}{2} \\left[ 2 \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\right] = \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) $$\nThe flux is then:\n$$ F_{i+\\tfrac{1}{2}} = a\\,\\phi_{i+\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) $$\n\nNext, we derive the expression for the face flux $F_{i-\\tfrac{1}{2}}$.\nThe process is analogous. The flux is $F_{i-\\tfrac{1}{2}} = a\\,\\phi_{i-\\tfrac{1}{2}}$, with the face value given by:\n$$ \\phi_{i-\\tfrac{1}{2}} = \\frac{1}{2}(\\phi_{i-1} + \\phi_i) $$\nSubstituting the expressions for $\\phi_{i-1}$ and $\\phi_i$:\n$$ \\phi_{i-\\tfrac{1}{2}} = \\frac{1}{2} \\left[ \\sin(k(x_i - \\Delta x)) + \\sin(k x_i) \\right] $$\nUsing the same sum-to-product identity with $A = k x_i$ and $B = k(x_i - \\Delta x)$:\n$$ \\frac{A+B}{2} = \\frac{k x_i + k x_i - k \\Delta x}{2} = k x_i - \\frac{k \\Delta x}{2} $$\n$$ \\frac{A-B}{2} = \\frac{k x_i - (k x_i - k \\Delta x)}{2} = \\frac{k \\Delta x}{2} $$\nApplying the identity:\n$$ \\sin(k(x_i - \\Delta x)) + \\sin(k x_i) = 2 \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) $$\nSubstituting this back:\n$$ \\phi_{i-\\tfrac{1}{2}} = \\frac{1}{2} \\left[ 2 \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\right] = \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) $$\nThe flux is then:\n$$ F_{i-\\tfrac{1}{2}} = a\\,\\phi_{i-\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) $$\n\nFinally, we derive the discrete convective term $C_i$.\nThis term is defined as the divergence of the flux over the cell volume:\n$$ C_i = \\frac{F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}}{\\Delta x} $$\nSubstituting the derived expressions for the fluxes:\n$$ C_i = \\frac{a}{\\Delta x} \\left[ \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) - \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\right] $$\nFactoring out the common term $a \\cos\\left(\\frac{k \\Delta x}{2}\\right)$:\n$$ C_i = \\frac{a \\cos\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x} \\left[ \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) - \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\right] $$\nWe now use the difference-to-product trigonometric identity $\\sin(A) - \\sin(B) = 2 \\cos\\left(\\frac{A+B}{2}\\right) \\sin\\left(\\frac{A-B}{2}\\right)$. Let $A = k x_i + \\frac{k \\Delta x}{2}$ and $B = k x_i - \\frac{k \\Delta x}{2}$.\n$$ \\frac{A+B}{2} = \\frac{k x_i + \\frac{k \\Delta x}{2} + k x_i - \\frac{k \\Delta x}{2}}{2} = k x_i $$\n$$ \\frac{A-B}{2} = \\frac{k x_i + \\frac{k \\Delta x}{2} - (k x_i - \\frac{k \\Delta x}{2})}{2} = \\frac{k \\Delta x}{2} $$\nApplying the identity, the term in the brackets becomes:\n$$ \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) - \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) = 2 \\cos(k x_i) \\sin\\left(\\frac{k \\Delta x}{2}\\right) $$\nSubstituting this into the expression for $C_i$:\n$$ C_i = \\frac{a \\cos\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x} \\left[ 2 \\cos(k x_i) \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right] $$\nRearranging the terms:\n$$ C_i = \\frac{a}{\\Delta x} \\left[ 2 \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\right] \\cos(k x_i) $$\nUsing the double-angle identity for sine, $\\sin(2\\theta) = 2 \\sin(\\theta) \\cos(\\theta)$, where $\\theta = \\frac{k \\Delta x}{2}$:\n$$ 2 \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) = \\sin\\left(2 \\cdot \\frac{k \\Delta x}{2}\\right) = \\sin(k \\Delta x) $$\nThe final expression for $C_i$ is:\n$$ C_i = \\frac{a \\sin(k \\Delta x)}{\\Delta x} \\cos(k x_i) $$\n\nThe three required expressions are:\n1.  $F_{i-\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right)$\n2.  $F_{i+\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right)$\n3.  $C_i = \\frac{a \\sin(k \\Delta x)}{\\Delta x} \\cos(k x_i)$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right)  a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right)  \\frac{a \\sin(k \\Delta x)}{\\Delta x} \\cos(k x_i) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While Fourier analysis reveals qualitative properties like dispersion, a quantitative measure of error is essential for practical applications and for comparing different numerical methods. This practice focuses on the concept of 'order of accuracy' by having you implement both second- and fourth-order central difference formulas . By computing the discrete $L^2$ error against an exact derivative, you will gain a concrete understanding of convergence rates and appreciate the practical trade-offs between a scheme's accuracy and its computational complexity.",
            "id": "3369270",
            "problem": "Consider the one-dimensional linear advection equation, whose convective flux contribution at a point is represented by the spatial derivative of a scalar field. Let $\\,\\phi(x)\\,$ be a smooth scalar field defined on the periodic domain $[0,1]$ and let $\\,u\\,$ denote a constant advection speed. The convective derivative at a point is $\\,u\\,\\partial\\phi/\\partial x\\,$. In this task, you will approximate the spatial derivative $\\,\\partial\\phi/\\partial x\\,$ using central finite differences of second-order and fourth-order accuracy derived from Taylor series analysis, and quantify the error by comparing to the exact derivative. Use periodic boundary conditions, a uniform grid with spacing $\\,\\Delta x = 1/N\\,$, and grid points $\\,x_i = i\\,\\Delta x\\,$ for $\\,i=0,1,\\dots,N-1\\,$ so that the interval endpoint $\\,x=1\\,$ is not redundantly included. All trigonometric function arguments are to be interpreted in radians.\n\nStarting from the definition of the spatial derivative $\\,\\partial\\phi/\\partial x\\,$ and using Taylor series expansions around a grid point, derive consistent second-order and fourth-order accurate central finite difference formulas for $\\,\\partial\\phi/\\partial x\\,$. Implement both formulas on a periodic grid, using wrap-around indexing to handle stencil points beyond the domain endpoints. For each case, compute the discrete $L^2$ error of your approximation against the exact derivative. The discrete $L^2$ error is defined as\n$$\n\\left\\|\\epsilon\\right\\|_{2} \\;=\\; \\left( \\Delta x \\sum_{i=0}^{N-1} \\left( d_i^{\\text{approx}} - d_i^{\\text{exact}} \\right)^2 \\right)^{1/2},\n$$\nwhere $\\,d_i^{\\text{approx}}\\,$ is the approximated derivative at $\\,x_i\\,$ and $\\,d_i^{\\text{exact}}\\,$ is the exact derivative at $\\,x_i\\,$.\n\nTake $\\,u=1\\,$ throughout, so the convective derivative equals the spatial derivative. Use the following test suite to evaluate your implementations:\n\n- Case A (baseline resolution, moderate wavenumber): $\\,\\phi(x)=\\sin(10\\pi x)\\,$, domain $[0,1]$, $\\,N=64\\,$.\n- Case B (baseline resolution, higher wavenumber): $\\,\\phi(x)=\\sin(30\\pi x)\\,$, domain $[0,1]$, $\\,N=64\\,$.\n- Case C (refined resolution, moderate wavenumber): $\\,\\phi(x)=\\sin(10\\pi x)\\,$, domain $[0,1]$, $\\,N=128\\,$.\n- Case D (constant field): $\\,\\phi(x)=1\\,$, domain $[0,1]$, $\\,N=64\\,$.\n\nFor each case, compute and report two numbers: the discrete $L^2$ error of the second-order central difference approximation and the discrete $L^2$ error of the fourth-order central difference approximation.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order: $[\\text{A\\_2nd},\\text{A\\_4th},\\text{B\\_2nd},\\text{B\\_4th},\\text{C\\_2nd},\\text{C\\_4th},\\text{D\\_2nd},\\text{D\\_4th}]$, where each entry is a floating-point number representing the corresponding discrete $L^2$ error.",
            "solution": "The user wants to solve a numerical analysis problem. Here is my plan:\n\n1.  **Validate the Problem**: I will go through the standard validation procedure.\n    -   **Step 1: Extract Givens**: I will list all the given information from the problem statement verbatim. This includes the equation, the domain, the boundary conditions, the grid definition, the error metric, the advection speed, and the specific test cases.\n    -   **Step 2: Validate Using Extracted Givens**: I'll check for scientific soundness, well-posedness, objectivity, completeness, consistency, etc. The problem is a standard exercise in numerical methods for PDEs, specifically on finite difference approximations of derivatives. The concepts (Taylor series, central differencing, L2 error, periodic boundaries) are well-defined and fundamental in the field. The provided test cases involve smooth, simple functions on a periodic domain, for which the problem is well-posed. The problem is objective, complete, and internally consistent.\n    -   **Step 3: Verdict and Action**: The problem is valid. I will proceed to solve it.\n\n2.  **Solve the Problem**:\n    -   **Derivation of Finite Difference Schemes**:\n        -   **Second-Order Central Difference**:\n            -   I will start with the Taylor series expansions for $\\phi(x_{i+1})$ and $\\phi(x_{i-1})$ around a grid point $x_i$, where the grid spacing is $\\Delta x$.\n            -   $\\phi(x_{i+1}) = \\phi(x_i) + \\Delta x \\phi'(x_i) + \\frac{(\\Delta x)^2}{2} \\phi''(x_i) + \\frac{(\\Delta x)^3}{6} \\phi'''(x_i) + \\mathcal{O}((\\Delta x)^4)$\n            -   $\\phi(x_{i-1}) = \\phi(x_i) - \\Delta x \\phi'(x_i) + \\frac{(\\Delta x)^2}{2} \\phi''(x_i) - \\frac{(\\Delta x)^3}{6} \\phi'''(x_i) + \\mathcal{O}((\\Delta x)^4)$\n            -   Subtracting the second expansion from the first eliminates the even-order derivative terms:\n                $\\phi(x_{i+1}) - \\phi(x_{i-1}) = 2 \\Delta x \\phi'(x_i) + \\frac{(\\Delta x)^3}{3} \\phi'''(x_i) + \\mathcal{O}((\\Delta x)^5)$\n            -   Solving for $\\phi'(x_i)$:\n                $\\phi'(x_i) = \\frac{\\phi(x_{i+1}) - \\phi(x_{i-1})}{2 \\Delta x} - \\frac{(\\Delta x)^2}{6} \\phi'''(x_i) + \\mathcal{O}((\\Delta x)^4)$\n            -   The finite difference formula is the first term, and the leading error term is proportional to $(\\Delta x)^2$, making the scheme second-order accurate.\n        -   **Fourth-Order Central Difference**:\n            -   To achieve higher accuracy, the stencil is extended to include points $x_{i+2}$ and $x_{i-2}$.\n            -   The Taylor expansions for $\\phi(x_{i\\pm 2})$ are:\n                $\\phi(x_{i+2}) = \\phi(x_i) + 2\\Delta x \\phi'(x_i) + \\frac{(2\\Delta x)^2}{2} \\phi''(x_i) + \\frac{(2\\Delta x)^3}{6} \\phi'''(x_i) + \\frac{(2\\Delta x)^4}{24} \\phi''''(x_i) + \\frac{(2\\Delta x)^5}{120} \\phi^{(5)}(x_i) + \\mathcal{O}((\\Delta x)^6)$\n                $\\phi(x_{i-2}) = \\phi(x_i) - 2\\Delta x \\phi'(x_i) + \\frac{(2\\Delta x)^2}{2} \\phi''(x_i) - \\frac{(2\\Delta x)^3}{6} \\phi'''(x_i) + \\frac{(2\\Delta x)^4}{24} \\phi''''(x_i) - \\frac{(2\\Delta x)^5}{120} \\phi^{(5)}(x_i) + \\mathcal{O}((\\Delta x)^6)$\n            -   Subtracting these gives:\n                $\\phi(x_{i+2}) - \\phi(x_{i-2}) = 4\\Delta x \\phi'(x_i) + \\frac{8(\\Delta x)^3}{3} \\phi'''(x_i) + \\frac{16(\\Delta x)^5}{60} \\phi^{(5)}(x_i) + \\mathcal{O}((\\Delta x)^7)$\n            -   We form a linear combination of the difference $(\\phi_{i+1} - \\phi_{i-1})$ and $(\\phi_{i+2} - \\phi_{i-2})$ to cancel the $\\phi'''(x_i)$ term. Multiplying the first-stencil difference by $8$ and subtracting the second-stencil difference:\n                $8(\\phi_{i+1} - \\phi_{i-1}) - (\\phi_{i+2} - \\phi_{i-2}) = [8(2\\Delta x \\phi'_i) - 4\\Delta x \\phi'_i] + [8(\\frac{(\\Delta x)^3}{3}\\phi'''_i) - \\frac{8(\\Delta x)^3}{3}\\phi'''_i] + \\mathcal{O}((\\Delta x)^5)$\n                $-\\phi_{i+2} + 8\\phi_{i+1} - 8\\phi_{i-1} + \\phi_{i-2} = 12\\Delta x \\phi'_i + \\mathcal{O}((\\Delta x)^5)$\n            -   Solving for $\\phi'(x_i)$ and including the next non-zero error term (which can be found by carrying the expansions to higher order):\n                $\\phi'(x_i) = \\frac{-\\phi_{i+2} + 8\\phi_{i+1} - 8\\phi_{i-1} + \\phi_{i-2}}{12 \\Delta x} + \\frac{(\\Delta x)^4}{30} \\phi^{(5)}(x_i) + \\mathcal{O}((\\Delta x)^6)$.\n            -   The leading error term is proportional to $(\\Delta x)^4$, so this scheme is fourth-order accurate.\n\n3.  **Implementation Strategy**:\n    -   **Grid and Field Setup**: For each test case, a 1D grid of $N$ points $x_i = i\\Delta x$ for $i=0, \\dots, N-1$ is created with $\\Delta x=1/N$. The scalar field $\\phi(x)$ and its exact derivative $\\phi'(x)$ are evaluated at these grid points.\n    -   **Periodic Boundary Conditions**: The use of periodic boundaries is essential. The required \"wrap-around\" indexing, where a stencil point like $x_{i+1}$ at the right boundary $i=N-1$ wraps to $x_0$, is naturally handled using array shifting operations.\n    -   **Numerical Differentiation**:\n        - The second-order formula $d_i^{\\text{approx}} = (\\phi_{i+1} - \\phi_{i-1})/(2 \\Delta x)$ is implemented by shifting the $\\phi$ array by $+1$ and $-1$ to get $\\phi_{i-1}$ and $\\phi_{i+1}$ respectively.\n        - The fourth-order formula $d_i^{\\text{approx}} = (-\\phi_{i+2} + 8\\phi_{i+1} - 8\\phi_{i-1} + \\phi_{i-2})/(12 \\Delta x)$ is implemented similarly, using shifts of $\\pm 1$ and $\\pm 2$.\n    -   **Error Calculation**: The discrete $L^2$ error is computed for both second-order an\nd fourth-order approximations using the given formula:\n        $\\|\\epsilon\\|_{2} = \\left( \\Delta x \\sum_{i=0}^{N-1} ( d_i^{\\text{approx}} - d_i^{\\text{exact}} )^2 \\right)^{1/2}$.\n\n4.  **Final Code Assembly**:\n    - A main function orchestrates the process for all four test cases.\n    - A helper function encapsulates the logic for a single case: grid generation, evaluating $\\phi$ and its exact derivative, applying the two finite difference formulas, and computing the corresponding $L^2$ errors.\n    - The results for all cases are collected and printed in the specified comma-separated format. The case with the constant field, $\\phi(x)=1$, serves as a verification test, as both finite difference schemes are exact for constant functions, yielding an error of zero.\nI will now write the full solution and the Python code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements 2nd and 4th order central finite differences\n    for the first derivative on a periodic domain, and computes the \n    discrete L2 error for a set of test cases.\n    \"\"\"\n\n    def calculate_derivative_errors(phi_func, d_phi_func, N):\n        \"\"\"\n        Calculates the L2 error for 2nd and 4th order central differences.\n\n        Args:\n            phi_func (function): A function that takes a numpy array x and returns phi(x).\n            d_phi_func (function): A function that takes a numpy array x and returns the exact derivative d(phi)/dx.\n            N (int): The number of grid points.\n\n        Returns:\n            tuple: A tuple containing the L2 error of the 2nd order scheme\n                   and the L2 error of the 4th order scheme.\n        \"\"\"\n        # 1. Grid Generation\n        dx = 1.0 / N\n        x = np.arange(N) * dx  # Grid points x_i = i * dx for i = 0, ..., N-1\n\n        # 2. Evaluate field and its exact derivative\n        phi = phi_func(x)\n        d_exact = d_phi_func(x)\n\n        # 3. Compute 2nd-order central difference approximation\n        # d_i = (phi_{i+1} - phi_{i-1}) / (2*dx)\n        # np.roll provides periodic wrap-around for stencil points.\n        phi_p1 = np.roll(phi, -1)  # phi_{i+1}\n        phi_m1 = np.roll(phi, 1)   # phi_{i-1}\n        d_approx_2nd = (phi_p1 - phi_m1) / (2.0 * dx)\n\n        # 4. Compute 4th-order central difference approximation\n        # d_i = (-phi_{i+2} + 8*phi_{i+1} - 8*phi_{i-1} + phi_{i-2}) / (12*dx)\n        phi_p2 = np.roll(phi, -2)  # phi_{i+2}\n        phi_m2 = np.roll(phi, 2)   # phi_{i-2}\n        d_approx_4th = (-phi_p2 + 8.0 * phi_p1 - 8.0 * phi_m1 + phi_m2) / (12.0 * dx)\n\n        # 5. Compute discrete L2 errors\n        # L2_error = sqrt(dx * sum((d_approx - d_exact)^2))\n        err_2nd = np.sqrt(dx * np.sum((d_approx_2nd - d_exact)**2))\n        err_4th = np.sqrt(dx * np.sum((d_approx_4th - d_exact)**2))\n\n        return err_2nd, err_4th\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: baseline resolution, moderate wavenumber\n        {'phi_func': lambda x: np.sin(10 * np.pi * x), \n         'd_phi_func': lambda x: 10 * np.pi * np.cos(10 * np.pi * x), \n         'N': 64},\n        # Case B: baseline resolution, higher wavenumber\n        {'phi_func': lambda x: np.sin(30 * np.pi * x), \n         'd_phi_func': lambda x: 30 * np.pi * np.cos(30 * np.pi * x), \n         'N': 64},\n        # Case C: refined resolution, moderate wavenumber\n        {'phi_func': lambda x: np.sin(10 * np.pi * x), \n         'd_phi_func': lambda x: 10 * np.pi * np.cos(10 * np.pi * x), \n         'N': 128},\n        # Case D: constant field\n        {'phi_func': lambda x: np.ones_like(x), \n         'd_phi_func': lambda x: np.zeros_like(x), \n         'N': 64}\n    ]\n\n    results = []\n    for case in test_cases:\n        err_2nd, err_4th = calculate_derivative_errors(\n            case['phi_func'], case['d_phi_func'], case['N']\n        )\n        results.append(err_2nd)\n        results.append(err_4th)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "A critical limitation of central differencing for convective fluxes emerges when dealing with solutions containing sharp gradients, such as shocks or contact discontinuities. This exercise provides a stark illustration of this failure mode by applying the scheme to a simple step function . You will calculate the solution after a single time step and observe the creation of non-physical oscillations, demonstrating the scheme's lack of monotonicity and highlighting why more advanced methods are often required for convection-dominated flows.",
            "id": "3369239",
            "problem": "Consider the linear advection (convection) equation for a passive scalar,\n$$\n\\frac{\\partial \\phi}{\\partial t} + a \\frac{\\partial \\phi}{\\partial x} = 0,\n$$\nwith constant advection speed $a0$ on a uniform grid with cell centers $x_i = i\\,\\Delta x$, $i \\in \\mathbb{Z}$. Adopt a conservative finite volume discretization with central interpolation for the convective fluxes at faces and forward Euler time integration. That is, approximate the face value by the arithmetic average of adjacent cell-centered values and advance one explicit time step of size $\\Delta t$.\n\nThe initial condition is a single discontinuous step located at the face $x_{1/2} = \\Delta x/2$ between cells $i=0$ and $i=1$:\n$$\n\\phi(x,0) = \\begin{cases}\n\\phi_L,  x  \\Delta x/2,\\\\\n\\phi_R,  x  \\Delta x/2,\n\\end{cases}\n$$\nwith $\\phi_L = 1$ and $\\phi_R = 0$.\n\nLet the Courant number (also known as the Courant–Friedrichs–Lewy (CFL) number) be\n$$\nC \\equiv \\frac{a\\,\\Delta t}{\\Delta x} = \\frac{7}{10}.\n$$\n\nUsing only the governing conservation law, the stated discretization choices, and the given initial data, determine after one time step the magnitude and the location of the first spurious overshoot above the initial maximum introduced by the central discretization. Define “magnitude” as the amount by which the updated value exceeds $\\max(\\phi_L,\\phi_R)$, and define the “location” as the cell index $i$ at which this first overshoot occurs. Report your final answer as a row vector $\\big(i,\\ \\text{magnitude}\\big)$ with exact values and do not round. No physical units are required.",
            "solution": "The problem is valid as it is scientifically grounded in the numerical analysis of partial differential equations, is well-posed for a single time step, and all terms and conditions are specified without ambiguity or contradiction.\n\nThe governing equation is the linear advection equation in one spatial dimension,\n$$\n\\frac{\\partial \\phi}{\\partial t} + a \\frac{\\partial \\phi}{\\partial x} = 0,\n$$\nwhere $\\phi = \\phi(x,t)$ is a scalar quantity and $a > 0$ is a constant advection speed.\n\nWe use a conservative finite volume method on a uniform grid with cell width $\\Delta x$. The cells are centered at $x_i = i\\,\\Delta x$. The cell $i$ spans the interval $[x_{i-1/2}, x_{i+1/2}]$, where $x_{i+1/2} = (i+1/2)\\,\\Delta x$. The cell-averaged value of $\\phi$ in cell $i$ at time $t$ is denoted by $\\phi_i(t)$. Integrating the governing equation over cell $i$ gives the exact conservation law for the cell average:\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi(x,t) dx + [a\\phi(x,t)]_{x_{i-1/2}}^{x_{i+1/2}} = 0.\n$$\nIn terms of cell averages $\\phi_i = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi(x,t) dx$, this becomes:\n$$\n\\frac{d\\phi_i}{dt} + \\frac{a}{\\Delta x} (\\phi_{i+1/2} - \\phi_{i-1/2}) = 0,\n$$\nwhere $\\phi_{i \\pm 1/2}$ represents the value of $\\phi$ at the cell faces.\n\nThe problem specifies central interpolation for the convective fluxes. This means the value at a cell face is approximated by the arithmetic mean of the values in the two adjacent cells:\n$$\n\\phi_{i+1/2} \\approx \\frac{\\phi_i + \\phi_{i+1}}{2}.\n$$\nSubstituting this approximation into the semi-discrete equation yields:\n$$\n\\frac{d\\phi_i}{dt} + \\frac{a}{\\Delta x} \\left( \\frac{\\phi_i + \\phi_{i+1}}{2} - \\frac{\\phi_{i-1} + \\phi_i}{2} \\right) = 0,\n$$\nwhich simplifies to the standard central difference approximation for the spatial derivative:\n$$\n\\frac{d\\phi_i}{dt} + \\frac{a}{2\\Delta x} (\\phi_{i+1} - \\phi_{i-1}) = 0.\n$$\nNext, we apply the forward Euler method for time integration. Let $\\phi_i^n$ be the approximation of $\\phi_i$ at time $t_n = n\\,\\Delta t$. The time derivative is approximated as:\n$$\n\\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} = - \\frac{a}{2\\Delta x} (\\phi_{i+1}^n - \\phi_{i-1}^n).\n$$\nRearranging for $\\phi_i^{n+1}$, we obtain the fully discrete update scheme:\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{a\\Delta t}{2\\Delta x} (\\phi_{i+1}^n - \\phi_{i-1}^n).\n$$\nUsing the definition of the Courant number, $C \\equiv \\frac{a\\Delta t}{\\Delta x}$, the update scheme is:\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{C}{2} (\\phi_{i+1}^n - \\phi_{i-1}^n).\n$$\nThe problem provides the initial condition as a step function:\n$$\n\\phi(x,0) = \\begin{cases}\n1,  x  \\frac{\\Delta x}{2},\\\\\n0,  x  \\frac{\\Delta x}{2}.\n\\end{cases}\n$$\nThe discontinuity is located at the face $x_{1/2} = \\frac{\\Delta x}{2}$ between cell $i=0$ and cell $i=1$. We determine the initial cell-averaged values $\\phi_i^0$ by integrating $\\phi(x,0)$ over each cell:\nFor any cell with index $i \\le 0$, its domain $[(i-\\frac{1}{2})\\Delta x, (i+\\frac{1}{2})\\Delta x]$ lies entirely in the region $x  \\frac{\\Delta x}{2}$. Thus, for $i \\le 0$:\n$$\n\\phi_i^0 = \\frac{1}{\\Delta x} \\int_{(i-1/2)\\Delta x}^{(i+1/2)\\Delta x} 1 \\, dx = 1.\n$$\nFor any cell with index $i \\ge 1$, its domain $[(i-\\frac{1}{2})\\Delta x, (i+\\frac{1}{2})\\Delta x]$ lies entirely in the region $x  \\frac{\\Delta x}{2}$. Thus, for $i \\ge 1$:\n$$\n\\phi_i^0 = \\frac{1}{\\Delta x} \\int_{(i-1/2)\\Delta x}^{(i+1/2)\\Delta x} 0 \\, dx = 0.\n$$\nSo, the discrete initial state at $n=0$ is:\n$$\n\\phi_i^0 = \\begin{cases}\n1,  i \\le 0, \\\\\n0,  i \\ge 1.\n\\end{cases}\n$$\nWe now compute the solution at the next time step, $n=1$, using $C=\\frac{7}{10}$.\n$$\n\\phi_i^1 = \\phi_i^0 - \\frac{1}{2} \\left(\\frac{7}{10}\\right) (\\phi_{i+1}^0 - \\phi_{i-1}^0) = \\phi_i^0 - \\frac{7}{20} (\\phi_{i+1}^0 - \\phi_{i-1}^0).\n$$\nWe evaluate $\\phi_i^1$ for each cell index $i$:\n- For $i \\le -1$: $\\phi_{i-1}^0 = 1$, $\\phi_i^0 = 1$, $\\phi_{i+1}^0 = 1$.\n  $$\n  \\phi_i^1 = 1 - \\frac{7}{20}(1 - 1) = 1.\n  $$\n- For $i=0$: $\\phi_{-1}^0=1$, $\\phi_0^0=1$, $\\phi_1^0=0$.\n  $$\n  \\phi_0^1 = 1 - \\frac{7}{20}(0 - 1) = 1 + \\frac{7}{20} = \\frac{27}{20}.\n  $$\n- For $i=1$: $\\phi_0^0=1$, $\\phi_1^0=0$, $\\phi_2^0=0$.\n  $$\n  \\phi_1^1 = 0 - \\frac{7}{20}(0 - 1) = \\frac{7}{20}.\n  $$\n- For $i \\ge 2$: $\\phi_{i-1}^0 = 0$, $\\phi_i^0 = 0$, $\\phi_{i+1}^0 = 0$.\n  $$\n  \\phi_i^1 = 0 - \\frac{7}{20}(0 - 0) = 0.\n  $$\nThe initial maximum value is $\\max(\\phi_L, \\phi_R) = \\max(1, 0) = 1$. The problem defines an overshoot as a value exceeding this maximum.\nThe updated values are:\n$$\n\\phi_i^1 = \\begin{cases}\n1,  i \\le -1, \\\\\n\\frac{27}{20},  i = 0, \\\\\n\\frac{7}{20},  i = 1, \\\\\n0,  i \\ge 2.\n\\end{cases}\n$$\nThe value $\\phi_0^1 = \\frac{27}{20} = 1.35$, which is greater than $1$. This is an overshoot.\nThe value $\\phi_1^1 = \\frac{7}{20} = 0.35$, which is within the initial range $[0, 1]$. All other values are either $0$ or $1$.\nThus, the only overshoot occurs in cell $i=0$. This is, by definition, the first spurious overshoot.\n\nThe location of this overshoot is the cell index $i=0$.\nThe magnitude of the overshoot is defined as the amount by which the updated value exceeds the initial maximum:\n$$\n\\text{Magnitude} = \\phi_0^1 - \\max(\\phi_L, \\phi_R) = \\frac{27}{20} - 1 = \\frac{7}{20}.\n$$\nThe requested answer is the row vector $(i, \\text{magnitude})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{7}{20}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}