{
    "hands_on_practices": [
        {
            "introduction": "许多物理现象（如化学反应速率）由非线性源项描述。为了在数值求解中获得更好的稳定性，通常采用隐式时间离散格式，但这会产生非线性代数方程组。本练习将指导你应用牛顿法，对一个典型的指数型非线性源项进行线性化处理，这是掌握隐式有限体积法求解器的核心步骤。",
            "id": "3444840",
            "problem": "考虑标量抛物型偏微分方程 $ \\frac{\\partial u}{\\partial t} = \\mathcal{L}(u) + S(u) $，其中 $ \\mathcal{L}(u) $ 表示产生穿过控制体表面通量的空间算子，$ S(u) = \\exp(u) $ 是一个非线性体积源。使用有限体积法 (FVM)，假设一个测度（三维中的体积、二维中的面积或一维中的长度）为 $ V_{P} $ 的单一控制体（单元）$ P $，其单元平均未知量 $ u_{P}(t) $ 在 $ P $ 上被视作常数。在从 $ t^{n} $ 到 $ t^{n+1} $、大小为 $ \\Delta t $ 的时间步长上，使用后向欧拉法进行时间离散，并通过将源项隐式近似为 $ V_{P} S(u_{P}^{n+1}) $ 来组装一个关于 $ u_{P}^{n+1} $ 的非线性代数方程。\n\n为求解该非线性系统，在第 $ k $ 次迭代中，对源项围绕当前迭代值 $ u_{P}^{(k)} $ 执行 Newton 线性化。通过将 $ P $ 中的后向欧拉残差在线性化后写为线性系统 $ a_{PP} u_{P}^{n+1} + \\sum_{N} a_{PN} u_{N}^{n+1} = b_{P} $ 的形式，提取仅源项对局部对角矩阵项和右端项的贡献，分别记为 $ a_{PP}^{(S)} $ 和 $ b_{P}^{(S)} $。您必须用 $ V_{P} $ 和 $ u_{P}^{(k)} $ 显式表示 $ a_{PP}^{(S)} $ 和 $ b_{P}^{(S)} $。\n\n将您的最终答案以单行矩阵的形式给出，该矩阵按顺序包含 $ a_{PP}^{(S)} $ 和 $ b_{P}^{(S)} $ 这两个表达式。不需要进行数值计算，也无需四舍五入。除了为组装 $ a_{PP}^{(S)} $ 和 $ b_{P}^{(S)} $ 而保持正确的符号约定外，请忽略 $ \\mathcal{L}(u) $ 和时间导数项的贡献。",
            "solution": "当前问题是有效的，因为它基于偏微分方程数值分析的原理，具有科学依据，并且是适定的、客观的和内部一致的。因此，我们可以进行形式推导。\n\n控制标量抛物型偏微分方程由下式给出：\n$$ \\frac{\\partial u}{\\partial t} = \\mathcal{L}(u) + S(u) $$\n其中 $S(u) = \\exp(u)$ 是非线性体积源项。\n\n应用有限体积法 (FVM)，我们将此方程在一个测度为 $V_P$ 的控制体（单元）$P$ 上进行积分：\n$$ \\int_{V_P} \\frac{\\partial u}{\\partial t} \\, dV = \\int_{V_P} \\mathcal{L}(u) \\, dV + \\int_{V_P} S(u) \\, dV $$\n假设单元平均值 $u_P$ 是 $u$ 在整个单元 $P$ 上的良好表示，积分后的方程变为关于 $u_P(t)$ 的半离散常微分方程：\n$$ V_P \\frac{d u_P}{d t} = F_P(u) + V_P S(u_P) $$\n其中 $F_P(u)$ 表示离散化后的空间算子 $\\mathcal{L}(u)$ 在体积上的积分，它产生穿过单元表面的净通量。\n\n接下来，我们使用全隐式后向欧拉法，在时间步长 $\\Delta t = t^{n+1} - t^n$ 上进行时间离散。这涉及在时间 $t^{n+1}$ 处近似时间导数，并在时间 $t^{n+1}$ 处计算右端的所有项：\n$$ V_P \\frac{u_P^{n+1} - u_P^n}{\\Delta t} = F_P(u^{n+1}) + V_P S(u_P^{n+1}) $$\n为了求解 $u_P^{n+1}$，常规做法是将所有项移到一边，把方程重排为残差形式 $R_P(u^{n+1}) = 0$。问题指定了一个最终的线性系统形式为 $a_{PP} u_{P}^{n+1} + \\sum_{N} a_{PN} u_{N}^{n+1} = b_{P}$，这意味着包含未知数 $u^{n+1}$ 的项被组装在左侧 (LHS)，而已知量则放在右侧 (RHS)。\n遵循此约定，方程被排列为：\n$$ \\left( V_P \\frac{u_P^{n+1}}{\\Delta t} - F_P(u^{n+1}) - V_P S(u_P^{n+1}) \\right) - V_P \\frac{u_P^n}{\\Delta t} = 0 $$\n问题要求我们仅分离出源项的贡献。在全离散方程中，源项在左侧 (LHS) 表现为 $-V_P S(u_P^{n+1})$。由于 $S(u) = \\exp(u)$，该项是非线性的。\n\n为了求解该非线性系统，我们采用 Newton 线性化。在非线性求解器的每次迭代 $k$ 中，我们在当前已知的迭代值（记为 $u_P^{(k)}$）周围对非线性项进行线性化。我们要求解的未知量是 $u_P^{n+1}$。一个通用函数 $f(x)$ 在 $x_k$ 附近的线性化为 $f(x) \\approx f(x_k) + f'(x_k)(x - x_k)$。\n将此方法应用于源函数 $S(u_P^{n+1})$，其中 $x = u_P^{n+1}$ 且 $x_k = u_P^{(k)}$：\n$$ S(u_P^{n+1}) \\approx S(u_P^{(k)}) + S'(u_P^{(k)}) (u_P^{n+1} - u_P^{(k)}) $$\n其中 $S'(u_P^{(k)})$ 是 $S(u)$ 关于 $u$ 的导数，在 $u_P^{(k)}$ 处求值。\n\n将此线性化表达式代入我们重排后方程的源项部分 $-V_P S(u_P^{n+1})$，我们得到：\n$$ -V_P S(u_P^{n+1}) \\approx -V_P \\left[ S(u_P^{(k)}) + S'(u_P^{(k)}) (u_P^{n+1} - u_P^{(k)}) \\right] $$\n展开此表达式可得：\n$$ -V_P S'(u_P^{(k)}) u_P^{n+1} - V_P S(u_P^{(k)}) + V_P S'(u_P^{(k)}) u_P^{(k)} $$\n这表示在第 $k$ 次迭代中，线性化源项对代数方程左侧 (LHS) 的总贡献。\n\n现在我们必须按照指示，忽略所有其他项，将这些贡献分离到目标形式 $a_{PP} u_{P}^{n+1} = b_{P}$ 中。\n包含未知数 $u_P^{n+1}$ 的项贡献给矩阵系数 $a_{PP}$。其余项相对于 $u_P^{n+1}$ 是常数，并被移至右侧 (RHS) 以构成 $b_P$。\n\n对左侧项 $a_{PP} u_{P}^{n+1}$ 的贡献是：\n$$ \\underbrace{\\left( -V_P S'(u_P^{(k)}) \\right)}_{a_{PP}^{(S)}} u_P^{n+1} $$\n因此，仅源项对对角矩阵项的贡献是：\n$$ a_{PP}^{(S)} = -V_P S'(u_P^{(k)}) $$\n\n线性化源项的其余项 $- V_P S(u_P^{(k)}) + V_P S'(u_P^{(k)}) u_P^{(k)}$ 位于左侧。要将它们移至右侧成为 $b_P$ 的一部分，我们必须改变它们的符号：\n$$ b_P^{(S)} = - \\left( - V_P S(u_P^{(k)}) + V_P S'(u_P^{(k)}) u_P^{(k)} \\right) $$\n$$ b_P^{(S)} = V_P S(u_P^{(k)}) - V_P S'(u_P^{(k)}) u_P^{(k)} $$\n这是仅源项对右端向量的贡献。\n\n最后，我们代入 $S(u)$ 及其导数 $S'(u)$ 的具体形式：\n给定 $S(u) = \\exp(u)$，其导数为 $S'(u) = \\frac{d}{du}(\\exp(u)) = \\exp(u)$。\n在 $u_P^{(k)}$ 处求值：\n$S(u_P^{(k)}) = \\exp(u_P^{(k)})$\n$S'(u_P^{(k)}) = \\exp(u_P^{(k)})$\n\n将这些代入 $a_{PP}^{(S)}$ 和 $b_P^{(S)}$ 的表达式中：\n$$ a_{PP}^{(S)} = -V_P \\exp(u_P^{(k)}) $$\n$$ b_P^{(S)} = V_P \\exp(u_P^{(k)}) - V_P \\exp(u_P^{(k)}) u_P^{(k)} $$\n$b_P^{(S)}$ 的表达式可以因式分解为：\n$$ b_P^{(S)} = V_P \\exp(u_P^{(k)}) (1 - u_P^{(k)}) $$\n这些就是所要求的源项贡献的显式表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-V_{P} \\exp(u_{P}^{(k)})  V_{P} \\exp(u_{P}^{(k)}) (1 - u_{P}^{(k)})\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在学会如何构建数值格式后，一个关键的步骤是确保其能够产生物理上真实的结果，例如浓度等物理量必须保持非负。本练习探讨了线性化源项的离散方式如何影响系统矩阵的性质，并最终决定解的正值性。你将通过应用M-矩阵理论，推导保证数值解具有物理意义的条件。",
            "id": "3444890",
            "problem": "考虑一个由线性产生-破坏源项控制的标量输运问题，其偏微分方程（PDE）通过有限体积法（FVM）进行离散。设控制体 $P$ 上的线性化源项写作 $S(u_{P}) = a_{P}\\,u_{P} + b_{P}$，其中 $a_{P}$ 代表破坏系数，$b_{P}$ 代表产生系数。假设在一个时间步长 $\\Delta t$ 上采用全隐式时间离散，并且空间离散（扩散项采用中心差分，对流项采用满足总变差减小单调性的迎风差分）所产生的基于面的相邻耦合系数在写于右侧时是非负的。设瞬态质量系数为 $m_{P} = \\rho c V_{P} / \\Delta t$，其中 $\\rho$ 是密度，$c$ 是一个正的材料常数，$V_{P}$ 是控制体 $P$ 的体积。假设边界条件和初始数据均为非负。\n\n从 $V_{P}$ 上的守恒积分形式出发，通过全隐式FVM离散，推导出新时间层 $n+1$ 上单个控制体方程的系数形式，并运用非奇异单调矩阵（M-矩阵）理论，建立保证当右端项非负时 $u^{n+1} \\ge 0$ 分量恒成立的关于 $a_{P}$ 和 $b_{P}$ 的条件。证明破坏系数存在一个有限上界 $a_{P}^{\\max}$，超过该值时可能失去正定性，并以 $m_{P}$ 和 $V_{P}$ 的形式精确计算此界的闭合形式。你的最终答案必须是 $a_{P}^{\\max}$ 的单一解析表达式，不含不等式和单位。",
            "solution": "该问题被验证为具有科学依据、适定且客观的。这是偏微分方程数值解领域的一个标准问题，具体涉及有限体积法（FVM）的稳定性和正定性。\n\n求解过程首先离散化一般标量输运方程，然后应用M-矩阵理论推导源项系数需满足的条件，以确保解的非负性。\n\n设 $u$ 为标量变量。对于一个控制体 $V_P$ 在时间区间 $[t^n, t^{n+1}]$ 上的守恒积分形式为：\n$$\n\\int_{V_P} \\rho c u^{n+1} dV - \\int_{V_P} \\rho c u^n dV + \\int_{t^n}^{t^{n+1}} \\left( \\int_{A_P} \\mathbf{J} \\cdot d\\mathbf{A} \\right) dt = \\int_{t^n}^{t^{n+1}} \\left( \\int_{V_P} S_v dV \\right) dt\n$$\n其中 $\\rho$ 和 $c$ 是材料属性，$\\mathbf{J}$ 是总通量矢量，$S_v$ 是体积源项。\n\n我们采用全隐式FVM离散。控制体内的 $u$ 值由其单元平均值 $u_P$ 表示。所有项，包括通量和源项，都在新的时间层 $t^{n+1}$ 进行计算。为清晰起见，我们将 $t^{n+1}$ 时的值表示为不带上标（例如 $u_P$），而将 $t^n$ 时的值表示为带上标 $n$（例如 $u_P^n$）。\n\n时间导数项近似为：\n$$\n\\frac{1}{\\Delta t} \\left( \\int_{V_P} \\rho c u^{n+1} dV - \\int_{V_P} \\rho c u^n dV \\right) \\approx \\frac{\\rho c V_P}{\\Delta t} (u_P - u_P^n) = m_P(u_P - u_P^n)\n$$\n其中 $m_P = \\frac{\\rho c V_P}{\\Delta t}$ 是给定的瞬态质量系数。\n\n问题陈述线性化源项为 $S(u_P) = a_P u_P + b_P$。这里存在一个歧义，即这究竟是体积源 $S_v$ 还是在整个体积上积分的总源项 $\\int_{V_P} S_v dV$。要求最终答案用 $m_P$ 和 $V_P$ 表示，这强烈暗示意图是 $S_v$ 的解释，即 $S_v(u) = a_P u + b_P$。在这种情况下，积分后的源项为：\n$$\n\\int_{V_P} S_v dV \\approx (a_P u_P + b_P)V_P\n$$\n通量项 $\\sum_f \\mathbf{J} \\cdot \\mathbf{A}_f$ 的空间离散被给定为在代数方程右侧产生非负的相邻耦合系数。这导出了标准的FVM形式：\n$$\n\\sum_f (\\mathbf{J} \\cdot \\mathbf{A}_f) \\approx A_{P, \\text{flux}} u_P - \\sum_{N} A_N u_N\n$$\n其中 $N$ 表示与 $P$ 相邻的控制体集合，且系数 $A_N \\ge 0$。对于内部控制体上的守恒格式，系数 $A_{P, \\text{flux}}$ 等于相邻系数之和，即 $A_{P, \\text{flux}} = \\sum_N A_N$。\n\n将这些离散项代入积分平衡方程（除以 $\\Delta t$ 后）得到：\n$$\nm_P(u_P - u_P^n) + \\left( \\sum_N A_N \\right) u_P - \\sum_N A_N u_N = (a_P u_P + b_P)V_P\n$$\n我们现在将此方程重排为标准线性代数形式 $A_{P,P} u_P = \\sum_N A_{P,N} u_N + B_P$：\n$$\n\\left( m_P + \\sum_N A_N - a_P V_P \\right) u_P = \\sum_N A_N u_N + m_P u_P^n + b_P V_P\n$$\n由此，我们确定代数系统的系数：\n- 左侧主对角系数：$A_{P,P} = m_P + \\sum_N A_N - a_P V_P$\n- 右侧非对角系数：$A_{P,N} = A_N$\n- 右侧常数源项：$B_P = m_P u_P^n + b_P V_P$\n\n为了使解 $u_P$ 对于任何非负初始条件 $u_P^n \\ge 0$ 和边界条件都是非负的，必须满足两个条件。系统矩阵必须是单调矩阵（M-矩阵），并且右端项向量必须是非负的。\n\n首先，我们分析右端项 $B_P$。鉴于 $m_P  0$, $u_P^n \\ge 0$, 和 $V_P  0$，条件 $B_P \\ge 0$ 要求产生系数满足 $b_P \\ge 0$。\n\n其次，我们分析系统矩阵，称之为 $\\mathbf{M}$。第 $P$ 行的方程为 $\\mathbf{M}_{PP} u_P + \\sum_{N} \\mathbf{M}_{PN} u_N = B_P$。\n与我们推导的形式比较，我们有：\n- 对角矩阵元素：$\\mathbf{M}_{PP} = A_{P,P} = m_P + \\sum_N A_N - a_P V_P$\n- 非对角矩阵元素：$\\mathbf{M}_{PN} = -A_N$\n\n$\\mathbf{M}$ 是M-矩阵的一个充分条件是它是一个严格或不可约对角占优的L-矩阵。L-矩阵具有正的对角元素和非正的非对角元素。\n1. 非正非对角元素的条件：$\\mathbf{M}_{PN} = -A_N \\le 0$。由于给定 $A_N \\ge 0$，此条件得到满足。\n2. 正对角元素的条件：$\\mathbf{M}_{PP}  0 \\implies m_P + \\sum_N A_N - a_P V_P  0$。\n3. 对角占优的条件：$|\\mathbf{M}_{PP}| \\ge \\sum_{N} |\\mathbf{M}_{PN}|$。假设 $\\mathbf{M}_{PP}0$，则为：\n    $$\n    m_P + \\sum_N A_N - a_P V_P \\ge \\sum_N |-A_N| = \\sum_N A_N\n    $$\n    该不等式简化为：\n    $$\n    m_P - a_P V_P \\ge 0 \\implies a_P V_P \\le m_P \\implies a_P \\le \\frac{m_P}{V_P}\n    $$\n这个条件代表了系统保证非负解时对 $a_P$ 的约束。它比条件 $\\mathbf{M}_{PP}  0$ 更具限制性，因为 $\\sum_N A_N \\ge 0$。如果 $a_P$ 违反此界限 ($a_P  m_P/V_P$)，对角占优性将丧失，矩阵不保证是M-矩阵，其逆矩阵可能包含负元素，从而允许 $u_P  0$。\n\n问题将 $a_P$ 称为“破坏系数”，这令人困惑，因为与 $u_P$ 成比例的破坏项通常具有负系数（例如，$-k u_P$ 且 $k  0$）。负的 $a_P$ 总是满足 $a_P \\le m_P/V_P$，因为 $m_P  0$ 且 $V_P  0$。然而，问题要求一个有限上界 $a_P^{\\max}$，这意味着 $a_P$ 可以是一个正值（即产生系数），并且可以大到足以引起不稳定性。因此，我们将“$a_P$ 代表破坏系数”解释为一种用词不当，我们的任务是找到产生系数 $a_P$ 的上限，超过该上限将失去正定性。\n\n这个上界 $a_P^{\\max}$ 是对角占优条件达到极限时的值：\n$$\na_P^{\\max} = \\frac{m_P}{V_P}\n$$\n如果 $a_P  a_P^{\\max}$，系统将不再是对角占优的，正定性可能丧失。这证明了这样一个有限上界的存在。该界以指定的变量 $m_P$ 和 $V_P$ 的闭合形式精确给出。\n因此，保证正定性的源项系数条件是 $a_P \\le m_P/V_P$ 和 $b_P \\ge 0$。所求的是 $a_P$ 的上界。",
            "answer": "$$\\boxed{\\frac{m_P}{V_P}}$$"
        },
        {
            "introduction": "高级的数值分析需要理解离散格式各部分之间微妙的相互作用。本练习是一个思想实验，它利用“制造解方法”构建一个特定的源项，该源项会意外地抵消一阶迎风格式中固有的数值扩散。你将分析这种抵消如何导致非物理的伪解，并学习如何修正离散格式以消除此问题。",
            "id": "3444866",
            "problem": "考虑一个定义在均匀周期性域 $x \\in [0,L]$ 上的一维稳态线性平流-反应偏微分方程 (PDE)：\n$$\na\\,\\partial_{x} u(x) + \\kappa\\,u(x) = s(x),\n$$\n其中 $a0$ 是一个恒定的平流速度，$\\kappa \\ge 0$ 是一个恒定的反应系数。您将使用有限体积法 (FVM) 在一个包含 $N$ 个单元、间距为 $\\Delta x = L/N$ 的均匀网格上对该偏微分方程进行离散化，其中单元中心为 $x_i$，单元值为 $u_i \\approx u(x_i)$。对流通量采用针对 $a0$ 的一阶迎风格式进行近似，反应项采用单元中心值进行近似，而源项则通过人工解方法 (MMS) 进行构造，以研究数值扩散的抵消问题。\n\n具体来说，定义一个依赖于未知量的二阶导数的人工源：\n$$\ns(x) = -\\gamma\\,\\partial_{x}^{2} u(x),\n$$\n其中 $\\gamma$ 是一个待定的常系数。在 FVM 中，将穿过单元 $i$ 的净对流通量近似为：\n$$\na\\left(u_i - u_{i-1}\\right),\n$$\n将反应项的贡献近似为：\n$$\n\\kappa\\,\\Delta x\\,u_i,\n$$\n并将源项积分近似为界面梯度的差值：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} s(x)\\,dx \\approx -\\gamma\\left[\\partial_x u(x_{i+1/2}) - \\partial_x u(x_{i-1/2})\\right] \\approx -\\gamma\\,\\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta x}.\n$$\n因此，单元 $i$ 的离散稳态平衡方程为：\n$$\na\\left(u_i - u_{i-1}\\right) + \\kappa\\,\\Delta x\\,u_i = -\\gamma\\,\\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta x}.\n$$\n\n从这个离散方程出发，仅使用代数变换和与泰勒展开一致的恒等式，完成以下任务：\n1. 将迎风差分 $u_i - u_{i-1}$ 分解为一个中心差分和一个二阶差分之和，以揭示一阶迎风格式的人工扩散结构。\n2. 确定源项系数 $\\gamma$ 的临界值 $\\gamma_{\\mathrm{c}}$，在该值下，离散化的源项能精确抵消迎风对流通量中的人工扩散分量，从而只留下平流项的纯中心差分表示与反应项的组合。\n3. 分析这种精确抵消何时会导致伪稳态解。具体而言，在周期性边界条件下，将非平凡离散稳态解的存在性描述为反应系数 $\\kappa$ 的函数，并解释其出现的机理。\n4. 为源项提出一种离散化修正方案，该方案能防止精确抵消，同时保持与控制体积分的一致性，并简要说明为什么您的修正方案能消除伪稳态解。\n\n请以临界系数 $\\gamma_{\\mathrm{c}}$ 的闭式表达式形式提供您的最终答案。无需代入任何数值，无需四舍五入，最终答案中也无需报告物理单位。",
            "solution": "按照问题陈述的要求，分析分四部分进行。\n\n所给出的离散控制方程为：\n$$\na\\left(u_i - u_{i-1}\\right) + \\kappa\\,\\Delta x\\,u_i = -\\gamma\\,\\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta x}\n$$\n该方程表示控制体 $i$ 内的稳态平衡。为清晰起见，我们将所有包含未知数 $u_i$ 及其相邻值的项移到方程左侧：\n$$\na\\left(u_i - u_{i-1}\\right) + \\kappa\\,\\Delta x\\,u_i + \\gamma\\,\\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta x} = 0\n$$\n\n1. 分解迎风差分以揭示其人工扩散。\n\n净对流通量的一阶迎风差分项是 $a(u_i - u_{i-1})$。为分析其结构，我们使用以下标准代数恒等式，该恒等式将一阶后向差分与一个二阶中心差分和一个二阶中心二阶差分关联起来：\n$$\nu_i - u_{i-1} = \\frac{u_{i+1} - u_{i-1}}{2} - \\frac{u_{i+1} - 2u_i + u_{i-1}}{2}\n$$\n该恒等式可通过简单代数运算验证：\n$$\n\\frac{u_{i+1} - u_{i-1} - (u_{i+1} - 2u_i + u_{i-1})}{2} = \\frac{u_{i+1} - u_{i-1} - u_{i+1} + 2u_i - u_{i-1}}{2} = \\frac{2u_i - 2u_{i-1}}{2} = u_i - u_{i-1}\n$$\n将此分解代入对流项 $a(u_i - u_{i-1})$，得到：\n$$\na(u_i - u_{i-1}) = a\\left( \\frac{u_{i+1} - u_{i-1}}{2} \\right) - a\\left( \\frac{u_{i+1} - 2u_i + u_{i-1}}{2} \\right)\n$$\n第一项 $a(u_{i+1} - u_{i-1})/2$ 代表了对单元积分后的平流项 $a\\,\\partial_x u(x)$ 的二阶中心差分近似所带来的通量平衡，即 $a\\Delta x \\frac{u_{i+1} - u_{i-1}}{2\\Delta x}$。第二项 $-a(u_{i+1} - 2u_i + u_{i-1})/2$ 是人工扩散项。该项与一个二阶差分成正比，而二阶差分是二阶导数的近似。具体来说，它对应于一个形式为 $-D_{\\mathrm{art}}\\,\\partial_x^2 u$ 的扩散项，其中人工扩散系数为 $D_{\\mathrm{art}} = \\frac{a\\Delta x}{2}$。\n\n2. 确定临界值 $\\gamma_{\\mathrm{c}}$。\n\n为了找到使离散源项能精确抵消人工扩散的 $\\gamma$ 值，我们将第1部分的分解式代入完整的离散方程：\n$$\n\\left[ a\\left( \\frac{u_{i+1} - u_{i-1}}{2} \\right) - a\\left( \\frac{u_{i+1} - 2u_i + u_{i-1}}{2} \\right) \\right] + \\kappa\\,\\Delta x\\,u_i + \\gamma\\,\\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta x} = 0\n$$\n我们根据差分算子对各项进行分组：用于平流的中心差分、用于反应的单元中心值，以及用于扩散的二阶差分算子。\n$$\na\\left( \\frac{u_{i+1} - u_{i-1}}{2} \\right) + \\kappa\\,\\Delta x\\,u_i + \\left( \\frac{\\gamma}{\\Delta x} - \\frac{a}{2} \\right) \\left( u_{i+1} - 2u_i + u_{i-1} \\right) = 0\n$$\n为了使离散源项能精确抵消人工扩散，二阶差分项 $(u_{i+1} - 2u_i + u_{i-1})$ 的系数必须为零。这给出了临界系数 $\\gamma_{\\mathrm{c}}$ 的条件：\n$$\n\\frac{\\gamma_{\\mathrm{c}}}{\\Delta x} - \\frac{a}{2} = 0\n$$\n求解 $\\gamma_{\\mathrm{c}}$ 可得：\n$$\n\\gamma_{\\mathrm{c}} = \\frac{a\\,\\Delta x}{2}\n$$\n\n3. 分析伪稳态解的出现。\n\n当 $\\gamma = \\gamma_{\\mathrm{c}}$ 时，离散方程简化为一个纯粹的平流中心差分格式与反应项的组合：\n$$\na\\left( \\frac{u_{i+1} - u_{i-1}}{2} \\right) + \\kappa\\,\\Delta x\\,u_i = 0\n$$\n我们在周期性边界条件 $u_{i+N} = u_i$ 下分析非平凡稳态解的存在性。\n情况1：反应系数 $\\kappa  0$。\n反应项提供了一种形式的阻尼。为证明这一点，可以考虑解的动量。假设一个傅里叶模态解 $u_j = \\hat{u}_k \\exp(I k j \\Delta x)$，其中 $I = \\sqrt{-1}$。将其代入方程，我们发现满足周期性边界条件的唯一解是平凡解，即对所有 $k$ 都有 $\\hat{u}_k=0$ (可能 $k=0$ 除外，但如果 $\\kappa0$，也可以证明其为零)。一个更初等的分析表明，对于形式为 $\\lambda^i$ 的解，其特征方程的根的模不等于1，从而排除了周期性的非平凡解。对于 $\\kappa0$，系统是带阻尼的，不存在伪稳态解。唯一的解是平凡解，$u_i = 0$ 对所有 $i$ 成立。\n\n情况2：反应系数 $\\kappa = 0$。\n离散方程简化为纯平流的中心差分近似：\n$$\na\\left( \\frac{u_{i+1} - u_{i-1}}{2} \\right) = 0 \\implies u_{i+1} = u_{i-1}\n$$\n这个方程将网格解耦为两个独立的子网格：一个用于偶数索引点 ($...u_{i-2}, u_i, u_{i+2}, ...$)，另一个用于奇数索引点 ($...u_{i-1}, u_{i+1}, u_{i+3}, ...$)。方程 $u_{i+1} = u_{i-1}$ 允许这样的解：当 $i$ 为偶数时 $u_i = C_{\\text{even}}$，当 $i$ 为奇数时 $u_i = C_{\\text{odd}}$。这种解的一般表示形式是 $u_i = c_1 + c_2(-1)^i$。项 $c_2(-1)^i$ 代表一个高频的“棋盘”或“2-$\\Delta x$”模式。\n这个模式是一个伪的、非物理的解。它作为稳态解的存在性取决于周期性边界条件 $u_{i+N} = u_i$。代入该模式，我们得到 $c_2(-1)^{i+N} = c_2(-1)^i$，可简化为 $c_2 ((-1)^N - 1) = 0$。\n- 如果单元数 $N$ 是奇数，则 $(-1)^N = -1$，条件变为 $-2c_2 = 0$，这意味着 $c_2 = 0$。只有常数解 $u_i = c_1$ 是可能的。\n- 如果单元数 $N$ 是偶数，则 $(-1)^N = 1$，条件变为 $0=0$。这对任意 $c_2$ 都成立。因此，对于任意常数 $c_2 \\neq 0$，伪模式 $u_i = c_2(-1)^i$ 是一个有效的非平凡稳态解。\n\n这些伪状态出现的机理是所有扩散效应（包括物理的和数值的）被完全抵消，只留下一个纯粹的中心平流算子，该算子是非耗散的，并且其非平凡零空间包含了网格上可表示的最高频率模式。\n\n4. 为源项提出离散化修正方案。\n\n这个问题的产生是由于所选择的源项离散格式 $\\int s(x)dx \\approx -\\gamma\\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta x}$ 完美地模仿了人工扩散项的结构。该离散格式是通过首先应用微积分基本定理 $\\int s(x) dx = -\\gamma[\\partial_x u(x_{i+1/2}) - \\partial_x u(x_{i-1/2})]$，然后对界面梯度使用简单的有限差分得到的。这导致了一个二阶差分模板。\n\n一个稳健的修正是为源项积分使用一个更精确、因而在结构上不同但仍然保持一致性的近似。积分的中点法则指出 $\\int_{x_i-\\Delta x/2}^{x_i+\\Delta x/2} f(x) dx = \\Delta x f(x_i) + \\frac{(\\Delta x)^3}{24} f''(x_i) + O((\\Delta x)^5)$。\n在这里，我们的被积函数是 $s(x) = -\\gamma\\,\\partial_x^2 u(x)$。所以积分为：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} s(x) dx = \\Delta x \\, s(x_i) + \\frac{(\\Delta x)^3}{24} s''(x_i) + \\dots = -\\gamma \\Delta x (\\partial_x^2 u)|_i - \\gamma \\frac{(\\Delta x)^3}{24} (\\partial_x^4 u)|_i + \\dots\n$$\n我们可以用中心有限差分来近似连续导数：\n$(\\partial_x^2 u)|_i \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta x)^2}$\n$(\\partial_x^4 u)|_i \\approx \\frac{u_{i+2} - 4u_{i+1} + 6u_i - 4u_{i-1} + u_{i-2}}{(\\Delta x)^4}$\n\n将这些代入积分近似，得到源项的修正离散格式：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} s(x) dx \\approx -\\gamma \\frac{u_{i+1} - 2u_i + u_{i-1}}{\\Delta x} - \\frac{\\gamma}{24\\Delta x} (u_{i+2} - 4u_{i+1} + 6u_i - 4u_{i-1} + u_{i-2})\n$$\n当使用这个修正后的离散格式并取 $\\gamma = \\gamma_{\\mathrmc} = a\\Delta x/2$ 时，二阶差分项仍然会抵消迎风格式带来的人工扩散。然而，会剩下一个四阶差分项：\n$$\na\\left( \\frac{u_{i+1} - u_{i-1}}{2} \\right) + \\kappa\\,\\Delta x\\,u_i - \\frac{\\gamma_c}{24\\Delta x}(u_{i+2} - \\dots) = 0\n$$\n$$\na\\left( \\frac{u_{i+1} - u_{i-1}}{2} \\right) + \\kappa\\,\\Delta x\\,u_i - \\frac{a}{48}(u_{i+2} - 4u_{i+1} + 6u_i - 4u_{i-1} + u_{i-2}) = 0\n$$\n这个剩余项是一个高阶耗散项（一个双调和扩散项）。对于 $(-1)^i$ 模式，该项不为零，因此提供了必要的阻尼来消除伪棋盘解，恢复了奇偶网格点之间的耦合，并确保了唯一的稳态解。这个修正保持了一致性，因为添加的项相对于离散化的主要部分是关于 $\\Delta x$ 的更高阶项。",
            "answer": "$$\n\\boxed{\\frac{a\\,\\Delta x}{2}}\n$$"
        }
    ]
}