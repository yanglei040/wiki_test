{
    "hands_on_practices": [
        {
            "introduction": "这第一个练习是基础性的。它将引导您从基本的物理守恒定律出发，推导跨越两种不同材料界面的通量的正确表达式。您将发现调和平均是如何自然地作为物理上一致的方式来模拟有效电导率的，这是精确数值模拟的基石。",
            "id": "3409996",
            "problem": "考虑在一个由矩形控制体积组成的笛卡尔有限体积网格上，沿x轴的一维空间中的标量温度场 $u(x)$ 的稳态热传导。该过程由傅里叶定律控制。两个相邻的单元，分别表示为 $W$ (西) 和 $E$ (东)，在 $x=x_{f}$ 位置共享一个内部垂直面。设单元中心分别位于 $x=x_{W}$ 和 $x=x_{E}$，其到共享面的距离分别为 $d_{W}=x_{f}-x_{W}$ 和 $d_{E}=x_{E}-x_{f}$。假设导热系数是各向同性的，并且在每个单元内是分段常数，在单元 $W$ 内等于 $k_{W}$，在单元 $E$ 内等于 $k_{E}$。穿过共享面的法向热通量密度 $q_{f}$，定义为从 $W$ 指向 $E$ 的方向为正。\n\n仅从傅里叶定律 $q=-k\\,\\partial u/\\partial x$ 和内部界面上法向热通量的连续性出发，推導一个用 $u_{W}$、$u_{E}$、$d_{W}$、$d_{E}$、$k_{W}$ 和 $k_{E}$ 表示的 $q_{f}$ 的相容离散表达式，并说明为何所得的界面导热系数是以到单元中心的距离 $d_{W}$ 和 $d_{E}$ 为几何权重的谐波平均值。\n\n然后，使用以下数据计算 $q_{f}$ 的值：\n- 单元宽度 $\\Delta x_{W}=0.6\\,\\mathrm{m}$ 和 $\\Delta x_{E}=0.2\\,\\mathrm{m}$，因此 $d_{W}=\\Delta x_{W}/2$ 和 $d_{E}=\\Delta x_{E}/2$。\n- 导热系数 $k_{W}=2.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ 和 $k_{E}=15\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n- 单元中心温度 $u_{W}=400\\,\\mathrm{K}$ 和 $u_{E}=300\\,\\mathrm{K}$。\n\n将 $q_{f}$ 的最终数值结果四舍五入至四位有效数字。以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位表示该通量密度。",
            "solution": "该问题陈述已经过验证，并被认为是合理的。它科学地基于傅里叶热传导定律，这是物理学和工程学中的一个基本原理。该问题是适定的，提供了推导界面热通量的唯一且有意义的解所需的所有必要定义、常数和边界条件。语言客观、精确，提供的数值在物理上是一致且合理的。因此，将提供一个解答。\n\n主要目标是推导穿过两个相邻控制体积 $W$ 和 $E$ 共享面的法向热通量密度 $q_{f}$ 的离散表达式。推导始于一维稳态热传导的傅里叶定律：\n$$\nq = -k \\frac{du}{dx}\n$$\n其中 $q$ 是热通量密度，$k$ 是导热系数，$u$ 是温度。对于无源介质中的稳态传导，热通量 $q$ 在整个区域内必须是常数。设这个从单元 $W$ 到单元 $E$ 的恒定通量为 $q_{f}$。\n\n有限体积法将区域离散化，并假设分段常数的导热系数适用于每个单元内部。为了求得界面 $x=x_{f}$ 处的通量，我们对傅里叶定律在与界面相邻的两个半单元上进行积分。关键的物理假设是界面处温度的连续性和法向热通量的连续性。设界面 $x_f$ 处的温度为 $u_f$。\n\n首先，我们考虑单元中心 $x_W$ 和界面 $x_f$ 之间的区域。在此区域内，导热系数为常数 $k=k_W$。我们可以重新排列傅里叶定律，并从 $x_W$ 到 $x_f$ 进行积分：\n$$\n\\int_{u(x_W)}^{u(x_f)} du = \\int_{x_W}^{x_f} -\\frac{q}{k} dx\n$$\n由于在此区间内 $q=q_f$ (常数) 和 $k=k_W$ (常数)，我们得到：\n$$\nu(x_f) - u(x_W) = -\\frac{q_f}{k_W} (x_f - x_W)\n$$\n使用给定的符号，其中 $u_f = u(x_f)$，$u_W = u(x_W)$，以及 $d_W = x_f - x_W$，上式变为：\n$$\nu_f - u_W = -\\frac{q_f d_W}{k_W}\n$$\n这个方程可以重新整理，用单元中心温度 $u_W$ 和通量 $q_f$ 来表示界面温度 $u_f$：\n$$\nu_f = u_W - \\frac{q_f d_W}{k_W}\n$$\n接下来，我们对界面 $x_f$ 和单元中心 $x_E$ 之间的区域执行相同的步骤。在此区域内，导热系数为常数 $k=k_E$。从 $x_f$ 到 $x_E$ 积分傅里叶定律：\n$$\n\\int_{u(x_f)}^{u(x_E)} du = \\int_{x_f}^{x_E} -\\frac{q}{k} dx\n$$\n当 $q=q_f$ 和 $k=k_E$ 时，积分得到：\n$$\nu(x_E) - u(x_f) = -\\frac{q_f}{k_E} (x_E - x_f)\n$$\n使用符号 $u_E = u(x_E)$ 和 $d_E = x_E - x_f$：\n$$\nu_E - u_f = -\\frac{q_f d_E}{k_E}\n$$\n这提供了界面温度 $u_f$ 的第二个表达式：\n$$\nu_f = u_E + \\frac{q_f d_E}{k_E}\n$$\n现在，我们通过令 $u_f$ 的两个表达式相等来强制界面处的温度连续性。这就从系统中消去了未知的界面温度。\n$$\nu_W - \\frac{q_f d_W}{k_W} = u_E + \\frac{q_f d_E}{k_E}\n$$\n现在我们可以求解热通量 $q_f$。重新整理各项以合并 $q_f$：\n$$\nu_W - u_E = q_f \\left( \\frac{d_W}{k_W} + \\frac{d_E}{k_E} \\right)\n$$\n最后，界面上热通量密度的离散表达式为：\n$$\nq_f = \\frac{u_W - u_E}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\n这个表达式是相容的，因为如果 $u_W > u_E$，通量 $q_f$ 为正，这与问题中定义的从 $W$ 到 $E$ 的热流方向一致。\n\n为了说明为何此公式涉及谐波平均，我们可以将我们的结果与傅里叶定律的标准有限差分近似 $q_f = -k_f \\frac{u_E - u_W}{d_W + d_E}$ 进行比较，其中 $k_f$ 是一个有效的界面导热系数。\n通过重写我们推导出的 $q_f$ 表达式：\n$$\nq_f = - \\frac{u_E - u_W}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\n比较 $q_f$ 的两种形式，我们可以使温差项 $-(u_E-u_W)$ 的系数相等：\n$$\n\\frac{k_f}{d_W + d_E} = \\frac{1}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\n求解 $k_f$ 得到：\n$$\nk_f = \\frac{d_W + d_E}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\n这是导热系数 $k_W$ 和 $k_E$ 的加权谐波平均的定义，权重分别是距离 $d_W$ 和 $d_E$。这种平均方案自然源于两个热阻串联的物理模型。厚度为 $\\Delta x$、导热系数为 $k$ 的平板的单位面积热阻为 $R' = \\frac{\\Delta x}{k}$。从单元 $W$ 中心到单元 $E$ 中心的总热阻是两段热阻之和：$R'_{total} = R'_W + R'_E = \\frac{d_W}{k_W} + \\frac{d_E}{k_E}$。热通量是总热阻上的温差，$q_f = \\frac{\\Delta u}{R'_{total}} = \\frac{u_W - u_E}{R'_{total}}$，这正是我们推导出的表达式。\n\n现在，我们使用给定的数值数据来计算 $q_f$：\n- 单元宽度：$\\Delta x_{W}=0.6\\,\\mathrm{m}$ 和 $\\Delta x_{E}=0.2\\,\\mathrm{m}$。\n- 到单元中心的距离：$d_{W}=\\frac{\\Delta x_{W}}{2}=\\frac{0.6}{2}=0.3\\,\\mathrm{m}$ 和 $d_{E}=\\frac{\\Delta x_{E}}{2}=\\frac{0.2}{2}=0.1\\,\\mathrm{m}$。\n- 导热系数：$k_{W}=2.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ 和 $k_{E}=15\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。\n- 单元中心温度：$u_{W}=400\\,\\mathrm{K}$ 和 $u_{E}=300\\,\\mathrm{K}$。\n\n将这些值代入推导出的 $q_f$ 表达式中：\n$$\nq_f = \\frac{400 - 300}{\\frac{0.3}{2.5} + \\frac{0.1}{15}}\n$$\n首先，计算分母中的各项：\n$$\n\\frac{d_W}{k_W} = \\frac{0.3}{2.5} = 0.12 \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\n$$\n\\frac{d_E}{k_E} = \\frac{0.1}{15} = \\frac{1}{150} \\approx 0.00666\\overline{6} \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\n分母是这两个热阻之和：\n$$\n\\frac{d_W}{k_W} + \\frac{d_E}{k_E} = 0.12 + \\frac{1}{150} = \\frac{12}{100} + \\frac{1}{150} = \\frac{3}{25} + \\frac{1}{150} = \\frac{18}{150} + \\frac{1}{150} = \\frac{19}{150} \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\n温差为 $\\Delta u = u_W - u_E = 400 - 300 = 100 \\, \\mathrm{K}$。\n现在，我们计算通量密度：\n$$\nq_f = \\frac{100}{\\frac{19}{150}} = \\frac{100 \\times 150}{19} = \\frac{15000}{19} \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\n进行除法运算：\n$$\nq_f \\approx 789.473684... \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\nq_f \\approx 789.5 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\n正号表示热通量方向是从单元 $W$ 指向单元 $E$，这与单元 $W$ 中较高的温度相符。",
            "answer": "$$\n\\boxed{789.5}\n$$"
        },
        {
            "introduction": "在推导出调和平均之后，本实践将挑战您在一个真实模拟中观察其影响。通过在一个具有高对比度、不连续电导率的问题上，实施并比较使用调和平均的有限体积法与使用算术平均的简单方法，您将定量地衡量两者在精度和收敛速度上的差异。这个练习用具体的数值证据巩固了理论概念。",
            "id": "3409997",
            "problem": "考虑具有空间变化的各向同性传导系数的稳态扩散方程，\n$$\n-\\nabla \\cdot \\left(k(\\mathbf{x}) \\nabla u(\\mathbf{x})\\right) = f(\\mathbf{x}) \\quad \\text{in } \\Omega = (0,1)\\times(0,1),\n$$\n该方程服从齐次狄利克雷边界条件，\n$$\nu(\\mathbf{x}) = 0 \\quad \\text{on } \\partial\\Omega.\n$$\n假设将 $\\Omega$ 均匀笛卡尔剖分为 $N\\times N$ 个边长为 $h = 1/N$ 的正方形控制体，标量单元中心未知量 $u_{i,j}$ 被解释为单元 $(i,j)$ 上的单元平均值，其中 $i,j \\in \\{0,\\dots,N-1\\}$。设源项为常数 $f(\\mathbf{x}) \\equiv f_0$，其中 $f_0$ 为一指定的标量。传导系数 $k(\\mathbf{x})$ 在每个单元上为分片常数，形成一个棋盘格模式，两个正常数 $k_{\\mathrm{high}}$ 和 $k_{\\mathrm{low}}$ 根据单元索引的和的奇偶性交替出现，即如果 $i+j$ 为偶数，则单元传导系数 $k_{i,j}$ 等于 $k_{\\mathrm{high}}$，如果 $i+j$ 为奇数，则等于 $k_{\\mathrm{low}}$。这种布置模拟了具有与网格对齐的不连续界面的强非均质介质。\n\n从局部守恒定律和穿过单元面的扩散通量的定义出发，使用两种不同的界面传导系数模型来离散化该算子：\n- 一种物理上一致的有限体积离散化方法，该方法使用一个面心传导系数，此系数源于一个适用于跨相邻半单元串联传导的界面模型。对于两个相邻单元之间的内部面，使用该界面模型所蕴含的传导系数。对于邻近边界的面，将齐次狄利克雷边界条件置于单元面上进行处理，并从第一性原理推导正确的界面传输率。\n- 一种中心差分格式，该格式在每个内部面上使用两个单元传导系数的算术平均值。对于邻近边界的面，与中心差分模板和置于单元面上的齐次狄利克雷边界条件保持一致地处理。\n\n在均匀网格上，两种格式在二维空间中都产生一个五点模板。组装得到的线性系统\n$$\nA u = b,\n$$\n其中 $u \\in \\mathbb{R}^{N^2}$ 按字典序收集了 $\\{u_{i,j}\\}$，$b \\in \\mathbb{R}^{N^2}$ 是离散化的源项。求解该系统以获得两种格式的数值解。\n\n为了量化收敛性，将单元中心场 $w_{i,j}$ 的离散 $L^2$ 范数定义为\n$$\n\\|w\\|_{L^2_h} \\coloneqq \\left( \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} w_{i,j}^2 \\, h^2 \\right)^{1/2}.\n$$\n由于对于不连续系数场，通常无法获得闭式精确解 $u(\\mathbf{x})$，因此我们使用在更精细的网格上通过物理上一致的有限体积离散化计算出的参考解。具体来说，使用有限体积格式在 $N_{\\mathrm{ref}} = 128$ 的网格上计算一个参考解，并通过对不重叠的 $s \\times s$ 块进行块平均，将其限制到较粗的网格上，其中 $s = N_{\\mathrm{ref}}/N$ 是一个整数。对于给定的粗网格解 $u^{(N)}$ 和相应的限制后的参考解 $u^{\\mathrm{ref}\\to N}$，定义误差为\n$$\nE(N) \\coloneqq \\left\\| u^{(N)} - u^{\\mathrm{ref}\\to N} \\right\\|_{L^2_h}.\n$$\n对每种格式，通过对多个网格尺寸的数据点 $\\left\\{ \\left(\\log h, \\log E(N)\\right) \\right\\}$ 拟合一条直线来估计经验收敛阶 $p$，其中 $h = 1/N$。使用线性最小二乘法获得斜率 $p$。\n\n你的任务是实现这个基准测试，并针对一个包含不同传导系数对比度的小型测试套件，为两种格式生成经验收敛阶。使用以下测试套件：\n- 案例 1: $k_{\\mathrm{high}} = 10$，$k_{\\mathrm{low}} = 1$，$f_0 = 1$，粗网格尺寸 $N \\in \\{16, 32, 64\\}$。\n- 案例 2: $k_{\\mathrm{high}} = 1000$，$k_{\\mathrm{low}} = 1$，$f_0 = 1$，粗网格尺寸 $N \\in \\{16, 32, 64\\}$。\n- 案例 3: $k_{\\mathrm{high}} = 1$，$k_{\\mathrm{low}} = 10^{-3}$，$f_0 = 1$，粗网格尺寸 $N \\in \\{16, 32, 64\\}$。\n\n对每个案例，使用具有物理一致性界面传导系数模型的有限体积格式，在 $N_{\\mathrm{ref}} = 128$ 的细网格上计算一个单一的参考解。然后，对于集合中的每个粗网格，求解两种格式并计算相对于限制后参考解的误差。通过对 $\\log E(N)$ 与 $\\log h$ 进行线性回归，估计有限体积格式的收敛阶 $p_{\\mathrm{FV}}$ 和中心差分格式的收敛阶 $p_{\\mathrm{CD}}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序如下\n$$\n\\left[ p_{\\mathrm{FV}}^{(1)},\\, p_{\\mathrm{CD}}^{(1)},\\, p_{\\mathrm{FV}}^{(2)},\\, p_{\\mathrm{CD}}^{(2)},\\, p_{\\mathrm{FV}}^{(3)},\\, p_{\\mathrm{CD}}^{(3)} \\right],\n$$\n其中上标表示案例索引。每个条目必须是浮点数。\n\n无需外部输入。在此基准测试中，所有物理量都是无量纲的，因此无需报告物理单位。不使用角度。不使用百分比。最终输出必须严格遵守所要求的格式。",
            "solution": "我们从稳态扩散的基本守恒原理开始。对于围绕单元中心 $(i,j)$ 且体积为 $|V_{i,j}| = h^2$ 的控制体 $V_{i,j}$，对偏微分方程进行积分可得\n$$\n\\int_{V_{i,j}} -\\nabla \\cdot \\left(k \\nabla u\\right) \\, \\mathrm{d}\\mathbf{x} = \\int_{V_{i,j}} f \\, \\mathrm{d}\\mathbf{x}.\n$$\n根据散度定理，左侧等于通过该控制体边界的净扩散通量，\n$$\n\\sum_{\\text{faces } F \\subset \\partial V_{i,j}} \\int_{F} \\left( -k \\nabla u \\cdot \\mathbf{n}_F \\right) \\, \\mathrm{d}S = \\int_{V_{i,j}} f \\, \\mathrm{d}\\mathbf{x}.\n$$\n在边长为 $h$ 的均匀笛卡尔网格上，每个内部面的面积为 $h$，相邻单元中心之间的距离为 $h$。通过中心差分来近似穿过两个相邻单元中心之间某个面的法向导数，穿过单元 $(i,j)$ 和 $(i',j')$ 之间内部面 $F$ 的扩散通量可以写为\n$$\n\\Phi_F \\approx -k_F \\frac{u_{i',j'} - u_{i,j}}{h} \\cdot h = -k_F\\,(u_{i',j'} - u_{i,j}),\n$$\n其中 $k_F$ 是一个有效的界面传导系数。代入积分平衡式，并将两边同除以单元体积 $h^2$，得到标准五点形式的离散方程，\n$$\n\\sum_{\\text{neighbors } (i',j')} \\frac{k_F}{h^2}\\left(u_{i,j} - u_{i',j'}\\right) + \\sum_{\\text{boundary faces}} \\frac{k_{F,\\partial}}{h^2}\\left(u_{i,j} - u_{\\mathrm{bc}}\\right) = f_{i,j}.\n$$\n此处，第二个和式考虑了邻近边界的面。对于直接置于单元面上的齐次狄利克雷边界条件 $u_{\\mathrm{bc}} = 0$，从单元中心到边界的距离是 $h/2$，法向导数的近似变为\n$$\n\\frac{u_{\\mathrm{bc}} - u_{i,j}}{h/2},\n$$\n因此边界面的通量大小为\n$$\n\\Phi_{F,\\partial} \\approx -k_{i,j} \\frac{u_{\\mathrm{bc}} - u_{i,j}}{h/2} \\cdot h = -2 k_{i,j} (u_{\\mathrm{bc}} - u_{i,j}).\n$$\n除以 $h^2$，边界面的传输率为\n$$\nT_{F,\\partial} = \\frac{2 k_{i,j}}{h^2}.\n$$\n\n关键的建模选择是内部面的有效界面传导系数 $k_F$。考虑两个相邻单元，其在法线方向上的传导系数分别为 $k_L$ 和 $k_R$，并沿一个公共面相邻。将垂直于该面的复合介质建模为两个厚度为 $h/2$ 的串联层，法向上的单位面积等效电阻为\n$$\nR_{\\mathrm{eq}} = \\frac{h/2}{k_L} + \\frac{h/2}{k_R} = \\frac{h}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right).\n$$\n对于跨越距离 $h$ 的单位 $u$ 跳跃，产生相同法向通量的等效传导系数 $k_F$ 满足\n$$\n\\Phi_F = -k_F \\frac{\\Delta u}{h} \\cdot h = -k_F \\Delta u,\n$$\n并且通过将其与通过两个半单元的串联通量相等，\n$$\n\\Phi_F = -\\frac{\\Delta u}{R_{\\mathrm{eq}}}.\n$$\n因此，\n$$\nk_F = \\frac{h}{R_{\\mathrm{eq}}} = \\frac{h}{\\frac{h}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right)} = \\frac{2}{\\frac{1}{k_L} + \\frac{1}{k_R}}.\n$$\n这是 $k_L$ 和 $k_R$ 的调和平均值，它源于界面处的基本串联传导模型。在离散通量中使用此 $k_F$ 可得到一个跨越不连续界面且物理上一致的有限体积格式。\n\n相比之下，在非均质介质中，一种常用的中心差分近似通常用算术平均值代替 $k_F$，\n$$\nk_F^{\\mathrm{arith}} = \\frac{k_L + k_R}{2},\n$$\n这对于均匀的 $k$ 是精确的，但对于急剧跳跃则不一致；它错误地表示了串联传导，并倾向于模糊界面效应，导致精度降低和潜在的网格依赖伪影。\n\n对于这两种格式，组装的矩阵 $A$ 都是对称正定的，其对角元等于到邻居和边界面传输率之和，非对角元等于连接相邻单元的传输率的负值。右端项 $b$ 使用单元中心源 $f_{i,j} = f_0$。\n\n由于对于不连续的棋盘格传导系数没有闭式解，我们采用通过在 $N_{\\mathrm{ref}} = 128$ 的细网格上使用物理一致的有限体积格式计算高分辨率解来构造参考解的方法。为了将粗网格解与此参考解进行比较，我们通过对不重叠的 $s \\times s$ 块进行块平均，将细网格解限制到每个粗网格上，其中 $s = N_{\\mathrm{ref}}/N$ 是一个整数。这种限制操作产生了一个与粗网格单元平均值对齐的粗网格场 $u^{\\mathrm{ref}\\to N}$。\n\n然后我们计算离散 $L^2$ 误差\n$$\nE(N) = \\left( \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\left(u^{(N)}_{i,j} - u^{\\mathrm{ref}\\to N}_{i,j}\\right)^2 \\, h^2 \\right)^{1/2}.\n$$\n假设对于足够细的网格，存在一个渐近误差模型 $E(N) \\approx C h^p$，取对数可得\n$$\n\\log E(N) \\approx \\log C + p \\log h.\n$$\n我们通过对不同网格尺寸 $N \\in \\{16, 32, 64\\}$ 的 $\\log E(N)$ 对 $\\log h$ 作图，用线性最小二乘法拟合其斜率来估计收敛阶 $p$。\n\n测试套件探讨了三种对比度：案例1为中等对比度 $k_{\\mathrm{high}} = 10$，$k_{\\mathrm{low}} = 1$；案例2为强对比度 $k_{\\mathrm{high}} = 1000$，$k_{\\mathrm{low}} = 1$；案例3为反向对比度，包含一个相对于 $k_{\\mathrm{high}} = 1$ 非常小的传导系数 $k_{\\mathrm{low}} = 10^{-3}$。在所有案例中，源项为 $f_0 = 1$。我们期望，物理上一致的有限体积格式在不连续点附近比使用算术平均的中心差分格式表现出更好的精度和更稳定的收敛行为，尤其是在界面建模至关重要的高对比度情况下。\n\n算法上，程序对每个案例执行以下步骤：\n- 构造 $N_{\\mathrm{ref}}\\times N_{\\mathrm{ref}}$ 的棋盘格传导系数场。\n- 组装并求解具有调和界面传导系数的有限体积系统，以获得细网格参考解。\n- 对于每个粗网格尺寸 $N \\in \\{16, 32, 64\\}$：\n  - 组装并求解具有调和界面传导系数的有限体积系统。\n  - 组装并求解具有算术界面传导系数的中心差分系统。\n  - 通过块平均将细网格参考解限制到粗网格上。\n  - 计算每种格式相对于限制后参考解的离散 $L^2$ 误差。\n- 在对数-对数空间中通过线性回归估计收敛阶 $p_{\\mathrm{FV}}$ 和 $p_{\\mathrm{CD}}$。\n\n最后，程序按以下顺序打印一行包含六个浮点数的单行文本\n$$\n\\left[ p_{\\mathrm{FV}}^{(1)},\\, p_{\\mathrm{CD}}^{(1)},\\, p_{\\mathrm{FV}}^{(2)},\\, p_{\\mathrm{CD}}^{(2)},\\, p_{\\mathrm{FV}}^{(3)},\\, p_{\\mathrm{CD}}^{(3)} \\right].\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csr_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef build_checkerboard_k(N: int, k_high: float, k_low: float) -> np.ndarray:\n    \"\"\"\n    Build an N x N checkerboard conductivity field with k_high and k_low alternating\n    by parity of (i + j).\n    \"\"\"\n    k = np.empty((N, N), dtype=float)\n    for i in range(N):\n        for j in range(N):\n            k[i, j] = k_high if ((i + j) % 2 == 0) else k_low\n    return k\n\ndef face_conductivity(k_left: float, k_right: float, scheme: str) -> float:\n    \"\"\"\n    Compute face conductivity between two adjacent cells given their conductivities.\n    scheme: 'harmonic' or 'arithmetic'\n    \"\"\"\n    if scheme == 'harmonic':\n        # Harmonic average: 2 / (1/k_left + 1/k_right)\n        # Guard against division by zero (though k are positive by construction)\n        return 2.0 / (1.0 / k_left + 1.0 / k_right)\n    elif scheme == 'arithmetic':\n        return 0.5 * (k_left + k_right)\n    else:\n        raise ValueError(\"Unknown scheme: {}\".format(scheme))\n\ndef assemble_system(N: int, k: np.ndarray, scheme: str, f0: float) -> tuple:\n    \"\"\"\n    Assemble the sparse linear system A u = b for the variable-coefficient diffusion\n    problem on an N x N cell-centered grid with homogeneous Dirichlet boundary conditions.\n    Interior faces use either harmonic or arithmetic averaging depending on 'scheme'.\n    Boundary faces use a transmissibility of 2*k_cell/h^2 corresponding to a boundary at the face.\n    Returns (A_csr, b) where A_csr is a csr_matrix of size (N^2, N^2) and b is an ndarray of length N^2.\n    \"\"\"\n    h = 1.0 / N\n    # Using LIL for assembly efficiency, then convert to CSR.\n    A = lil_matrix((N * N, N * N), dtype=float)\n    b = np.full(N * N, f0, dtype=float)\n\n    def idx(i: int, j: int) -> int:\n        return i * N + j\n\n    for i in range(N):\n        for j in range(N):\n            p = idx(i, j)\n            diag = 0.0\n            k_ij = k[i, j]\n\n            # Left face (neighbor at j-1 or boundary)\n            if j > 0:\n                k_face = face_conductivity(k_ij, k[i, j - 1], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i, j - 1)] -= T\n            else:\n                # Boundary at left face: distance h/2\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n                # u_bc = 0, so no RHS contribution needed\n\n            # Right face (neighbor at j+1 or boundary)\n            if j  N - 1:\n                k_face = face_conductivity(k_ij, k[i, j + 1], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i, j + 1)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            # Bottom face (neighbor at i-1 or boundary)\n            if i > 0:\n                k_face = face_conductivity(k_ij, k[i - 1, j], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i - 1, j)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            # Top face (neighbor at i+1 or boundary)\n            if i  N - 1:\n                k_face = face_conductivity(k_ij, k[i + 1, j], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i + 1, j)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            A[p, p] += diag\n\n    return csr_matrix(A), b\n\ndef solve_system(A: csr_matrix, b: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Solve the sparse linear system A u = b using a direct solver.\n    \"\"\"\n    return spsolve(A, b)\n\ndef restrict_block_average(u_ref: np.ndarray, N_ref: int, N: int) -> np.ndarray:\n    \"\"\"\n    Restrict a fine-grid solution u_ref (flattened length N_ref^2) to a coarse grid of size N x N\n    by block averaging over non-overlapping s x s blocks, where s = N_ref // N.\n    Returns a flattened coarse solution of length N^2.\n    \"\"\"\n    s = N_ref // N\n    assert N_ref % N == 0, \"N_ref must be divisible by N for block averaging.\"\n    # Reshape fine solution to 2D\n    u2d = u_ref.reshape(N_ref, N_ref)\n    # Average over s x s blocks\n    u_coarse = np.zeros((N, N), dtype=float)\n    for i in range(N):\n        for j in range(N):\n            block = u2d[i * s:(i + 1) * s, j * s:(j + 1) * s]\n            u_coarse[i, j] = np.mean(block)\n    return u_coarse.ravel()\n\ndef l2_error(u_coarse: np.ndarray, u_ref_coarse: np.ndarray, N: int) -> float:\n    \"\"\"\n    Compute the discrete L2 error between u_coarse and restricted reference u_ref_coarse on an N x N grid.\n    \"\"\"\n    h = 1.0 / N\n    diff = u_coarse - u_ref_coarse\n    return np.sqrt(np.sum(diff * diff) * h * h)\n\ndef convergence_rate(N_list: list, err_list: list) -> float:\n    \"\"\"\n    Estimate the convergence rate p by linear regression of log(err) versus log(h),\n    where h = 1/N, across the given N_list and err_list.\n    \"\"\"\n    h_list = np.array([1.0 / N for N in N_list], dtype=float)\n    logh = np.log(h_list)\n    loge = np.log(np.array(err_list, dtype=float))\n    # Fit line: loge = a + p * logh\n    p = np.polyfit(logh, loge, 1)[0]\n    return float(p)\n\ndef run_case(k_high: float, k_low: float, f0: float, N_ref: int, N_list: list) -> tuple:\n    \"\"\"\n    Run a single test case:\n    - Build checkerboard k on fine grid N_ref.\n    - Solve FV harmonic scheme on fine grid for reference.\n    - For each N in N_list, solve both schemes and compute L2 errors against restricted reference.\n    - Return the estimated convergence rates for FV harmonic and CD arithmetic.\n    \"\"\"\n    # Reference solution on fine grid using FV harmonic\n    k_ref = build_checkerboard_k(N_ref, k_high, k_low)\n    A_ref, b_ref = assemble_system(N_ref, k_ref, scheme='harmonic', f0=f0)\n    u_ref = solve_system(A_ref, b_ref)\n\n    # Collect errors across coarse grids\n    errs_fv = []\n    errs_cd = []\n\n    for N in N_list:\n        # Conductivity on coarse grid\n        kN = build_checkerboard_k(N, k_high, k_low)\n\n        # FV harmonic on coarse grid\n        A_fv, b_fv = assemble_system(N, kN, scheme='harmonic', f0=f0)\n        u_fv = solve_system(A_fv, b_fv)\n\n        # CD arithmetic on coarse grid\n        A_cd, b_cd = assemble_system(N, kN, scheme='arithmetic', f0=f0)\n        u_cd = solve_system(A_cd, b_cd)\n\n        # Restrict reference to coarse grid\n        u_ref_N = restrict_block_average(u_ref, N_ref, N)\n\n        # Errors\n        e_fv = l2_error(u_fv, u_ref_N, N)\n        e_cd = l2_error(u_cd, u_ref_N, N)\n\n        errs_fv.append(e_fv)\n        errs_cd.append(e_cd)\n\n    # Rates via regression\n    rate_fv = convergence_rate(N_list, errs_fv)\n    rate_cd = convergence_rate(N_list, errs_cd)\n\n    return rate_fv, rate_cd\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k_high, k_low, f0, N_ref, N_list)\n        (10.0, 1.0, 1.0, 128, [16, 32, 64]),\n        (1000.0, 1.0, 1.0, 128, [16, 32, 64]),\n        (1.0, 1e-3, 1.0, 128, [16, 32, 64]),\n    ]\n\n    results = []\n    for k_high, k_low, f0, N_ref, N_list in test_cases:\n        rate_fv, rate_cd = run_case(k_high, k_low, f0, N_ref, N_list)\n        # Append in the specified order\n        results.append(rate_fv)\n        results.append(rate_cd)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "在单一界面模型的基础上，这最后一个实践将概念扩展到一个更复杂的场景，即多种材料在单个点相交。您将为此类连接点开发一个一致的数值处理方法，这是复合材料或复杂地质构造模拟中的一个常见特征。这个问题演示了如何使用星-三角变换等工具来推广串联电阻的基本原理，以便在复杂几何形状中保持局部守恒和准确性。",
            "id": "3410014",
            "problem": "考虑在一个二维介质中的稳态扩散，该过程由偏微分方程（PDE）$-\\nabla \\cdot (k \\nabla \\phi) = 0$ 控制。该介质由三个多边形控制体组成，它们交于一个单点 $P$。在每个控制体 $i \\in \\{1,2,3\\}$ 内部，传导率 $k_i$ 是分段常数，未知场 $\\phi_i$ 是在控制体中心处取值的单元平均值。三个控制体之间的界面是交于点 $P$ 的直线段，分别表示为面 $(1,2)$、$(2,3)$ 和 $(3,1)$，其各自的长度（在二维中即面积）为 $A_{12}$、$A_{23}$ 和 $A_{31}$。假设采用适用于有限体积法（FVM）中两点通量近似（TPFA）的正交布局：对于每个面 $(i,j)$，连接控制体 $i$ 和 $j$ 中心的线段与该面正交，并且从控制体中心沿法线到该面的距离分别为 $d_{i,ij}$ 和 $d_{j,ij}$。在连接点 $P$ 处没有源或汇。\n\n从傅里叶定律 $q_n = -k \\,\\partial \\phi/\\partial n$ 和跨面的扩散阻力串联相加原理出发，完成以下任务。\n\n1. 对于每个界面 $(i,j)$，假设一个物理上一致的、形式为 $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$ 的两点通量近似（TPFA）面通量模型，并基于两个相邻材料中的法向扩散阻力跨面串联相加的假设，推导面传导率 $T_{ij}$。\n\n2. 在点 $P$ 引入一个辅助连接点未知数 $\\phi_{\\ast}$ 和三个非负导纳 $g_1$、$g_2$ 和 $g_3$，分别连接 $\\phi_{\\ast}$ 与 $\\phi_1$、$\\phi_2$ 和 $\\phi_3$，使得：(a) 在点 $P$ 处的局部守恒 $\\sum_{i=1}^{3} g_i(\\phi_i - \\phi_{\\ast}) = 0$ 成立，并且 (b) 消去辅助未知数 $\\phi_{\\ast}$ 后，能产生与第1部分中推导出的相同的成对面通量 $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$。仅使用这两个要求，推导出一个仅含 $\\phi_1$、$\\phi_2$、$\\phi_3$、$k_1$、$k_2$、$k_3$、$A_{12}$、$A_{23}$、$A_{31}$、$d_{1,12}$、$d_{2,12}$、$d_{2,23}$、$d_{3,23}$、$d_{3,31}$ 和 $d_{1,31}$ 的关于 $\\phi_{\\ast}$ 的显式解析表达式。\n\n3. 通过从局部守恒的星形系统中消去 $\\phi_{\\ast}$，简要验证所得的控制体中心之间的成对通量与 TPFA 模型 $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$ 相匹配，并因此满足在点 $P$ 处的局部守恒。\n\n请提供第2部分所要求的 $\\phi_{\\ast}$ 的显式闭式表达式作为最终答案。最终答案中不要包含中间步骤。无需进行数值计算。",
            "solution": "该问题提法恰当且科学上合理，是使用有限体积法求解偏微分方程中的一个标准推导。我们将按顺序解决问题的三个部分。\n\n**第1部分：面传导率 $T_{ij}$ 的推导**\n\n我们考虑稳态扩散方程 $-\\nabla \\cdot (k \\nabla \\phi) = 0$。为使两点通量近似（TPFA）有效，我们依赖于给定的正交性条件：连接相邻控制体 $i$ 和 $j$ 中心的线与共享面 $(i,j)$ 正交。这使我们能够将通量计算近似为沿该线的一维问题。\n\n设从控制体 $i$ 穿过面 $(i,j)$ 到达控制体 $j$ 的通量表示为 $F_{ij}$。总通量 $F_{ij}$ 是法向通量密度 $q_{ij}$ 与面面积 $A_{ij}$ 的乘积。\n根据傅里叶定律，通量密度与势 $\\phi$ 的负梯度成正比。假设 $\\phi$ 在从单元中心到面的线段上呈线性分布，我们可以将通量密度写成两部分，面的每一侧各一部分。设 $\\phi_{f,ij}$ 为面 $(i,j)$ 处的势。\n\n从单元中心 $i$ 到面的通量密度为 $q_{ij} = k_i \\frac{\\phi_i - \\phi_{f,ij}}{d_{i,ij}}$。\n从面到单元中心 $j$ 的通量密度为 $q_{ij} = k_j \\frac{\\phi_{f,ij} - \\phi_j}{d_{j,ij}}$。\n由于通量密度必须跨面连续（界面处无源或汇），我们可以用两种方式表达总通量 $F_{ij} = A_{ij} q_{ij}$：\n$F_{ij} = A_{ij} k_i \\frac{\\phi_i - \\phi_{f,ij}}{d_{i,ij}} \\implies \\phi_i - \\phi_{f,ij} = F_{ij} \\left( \\frac{d_{i,ij}}{A_{ij} k_i} \\right)$\n$F_{ij} = A_{ij} k_j \\frac{\\phi_{f,ij} - \\phi_j}{d_{j,ij}} \\implies \\phi_{f,ij} - \\phi_j = F_{ij} \\left( \\frac{d_{j,ij}}{A_{ij} k_j} \\right)$\n\n括号中的项代表与面相邻的半单元的扩散阻力。阻力串联相加的原理指出，总势降是每个阻性元件上势降的总和。\n将以上两个方程相加，消去面势 $\\phi_{f,ij}$：\n$(\\phi_i - \\phi_{f,ij}) + (\\phi_{f,ij} - \\phi_j) = \\phi_i - \\phi_j$\n$\\phi_i - \\phi_j = F_{ij} \\left( \\frac{d_{i,ij}}{A_{ij} k_i} \\right) + F_{ij} \\left( \\frac{d_{j,ij}}{A_{ij} k_j} \\right) = F_{ij} \\left( \\frac{d_{i,ij}}{A_{ij} k_i} + \\frac{d_{j,ij}}{A_{ij} k_j} \\right)$\n\n给定 TPFA 模型 $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$。通过重新整理推导出的 $F_{ij}$ 方程，我们得到：\n$F_{ij} = \\frac{\\phi_i - \\phi_j}{\\frac{d_{i,ij}}{A_{ij} k_i} + \\frac{d_{j,ij}}{A_{ij} k_j}}$\n\n将其与 TPFA 模型进行比较，我们确定面传导率 $T_{ij}$ 为总串联阻力的倒数：\n$T_{ij} = \\frac{1}{\\frac{d_{i,ij}}{A_{ij} k_i} + \\frac{d_{j,ij}}{A_{ij} k_j}} = A_{ij} \\frac{1}{\\frac{d_{i,ij}}{k_i} + \\frac{d_{j,ij}}{k_j}}$\n该表达式是传导率 $k_i$ 和 $k_j$ 的调和平均值，由距离 $d_{i,ij}$ 和 $d_{j,ij}$ 加权，并由面面积 $A_{ij}$ 缩放。\n\n**第2部分：辅助连接点势 $\\phi_{\\ast}$ 的推导**\n\n给定一个星形网络，它将三个单元中心 $\\phi_1, \\phi_2, \\phi_3$ 连接到一个势为 $\\phi_{\\ast}$ 的中心辅助点 $P$。从每个 $\\phi_i$到 $\\phi_{\\ast}$ 的连接都有一个导纳 $g_i$。\n\n要求 (a) 指出在点 $P$ 处的局部守恒：\n$\\sum_{i=1}^{3} g_i(\\phi_i - \\phi_{\\ast}) = 0$\n$g_1(\\phi_1 - \\phi_{\\ast}) + g_2(\\phi_2 - \\phi_{\\ast}) + g_3(\\phi_3 - \\phi_{\\ast}) = 0$\n求解 $\\phi_{\\ast}$ 可得：\n$g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3 = (g_1 + g_2 + g_3)\\phi_{\\ast}$\n$\\phi_{\\ast} = \\frac{g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3}{g_1 + g_2 + g_3}$\n\n要求 (b) 指出，该星形网络必须等效于原始的 TPFA 通量的三角形网络，即 $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$。这种等效性通过标准的星-三角（或 T-Π）变换建立。离开任意节点 $i$ 的净通量在两种模型中必须相同。\n在三角形网络（TPFA 模型）中，离开节点1的通量为 $F_{1,\\text{out}}^{\\Delta} = T_{12}(\\phi_1 - \\phi_2) + T_{31}(\\phi_1 - \\phi_3)$。\n在星形网络中，离开节点1的通量为 $F_{1,\\text{out}}^{\\star} = g_1(\\phi_1 - \\phi_{\\ast})$。代入 $\\phi_{\\ast}$ 的表达式：\n$F_{1,\\text{out}}^{\\star} = g_1 \\left( \\phi_1 - \\frac{g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3}{g_1 + g_2 + g_3} \\right) = \\frac{g_1}{g_1+g_2+g_3} \\left( (g_1+g_2+g_3)\\phi_1 - (g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3) \\right)$\n$F_{1,\\text{out}}^{\\star} = \\frac{g_1}{g_1+g_2+g_3} (g_2(\\phi_1 - \\phi_2) + g_3(\\phi_1 - \\phi_3))$\n$F_{1,\\text{out}}^{\\star} = \\frac{g_1 g_2}{g_1+g_2+g_3}(\\phi_1 - \\phi_2) + \\frac{g_1 g_3}{g_1+g_2+g_3}(\\phi_1 - \\phi_3)$\n\n通过令 $F_{1,\\text{out}}^{\\Delta}$ 和 $F_{1,\\text{out}}^{\\star}$ 中 $(\\phi_i - \\phi_j)$ 的系数相等（对节点2和3也类似处理），得到星形到三角形的变换公式：\n$T_{12} = \\frac{g_1 g_2}{g_1+g_2+g_3}$\n$T_{23} = \\frac{g_2 g_3}{g_1+g_2+g_3}$\n$T_{31} = \\frac{g_3 g_1}{g_1+g_2+g_3}$\n\n为了求得 $\\phi_{\\ast}$，我们需要用已知的传导率 $T_{ij}$ 来表示导纳 $g_i$。这就是三角形到星形的变换。考虑乘积之和：\n$T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12} = \\frac{g_1g_2^2g_3 + g_2g_3^2g_1 + g_3g_1^2g_2}{(g_1+g_2+g_3)^2} = \\frac{g_1g_2g_3(g_1+g_2+g_3)}{(g_1+g_2+g_3)^2} = \\frac{g_1g_2g_3}{g_1+g_2+g_3}$\n设 $N = T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12}$。则 $N = \\frac{g_1g_2g_3}{g_1+g_2+g_3}$。\n将 $N$ 除以 $T_{23}$ 可得：\n$\\frac{N}{T_{23}} = \\frac{g_1g_2g_3/(g_1+g_2+g_3)}{g_2g_3/(g_1+g_2+g_3)} = g_1$。\n通过指标的循环置换，我们找到星形导纳的表达式：\n$g_1 = \\frac{T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12}}{T_{23}}$\n$g_2 = \\frac{T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12}}{T_{31}}$\n$g_3 = \\frac{T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12}}{T_{12}}$\n\n现在我们将这些代入 $\\phi_{\\ast}$ 的方程中：\n$\\phi_{\\ast} = \\frac{g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3}{g_1 + g_2 + g_3}$\n分子项 $(T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12})$ 是所有 $g_i$ 的公因子，可以从 $\\phi_{\\ast}$ 表达式的分子和分母中提取出来。\n$\\phi_{\\ast} = \\frac{ (\\frac{1}{T_{23}})\\phi_1 + (\\frac{1}{T_{31}})\\phi_2 + (\\frac{1}{T_{12}})\\phi_3 }{ \\frac{1}{T_{23}} + \\frac{1}{T_{31}} + \\frac{1}{T_{12}} }$\n\n这个简洁的结果表明，$\\phi_{\\ast}$ 是周围单元势的加权平均值，其中每个 $\\phi_i$ 的权重是与节点 $i$ *相对*的面的传导率的倒数（即阻力）。\n设 $R_{ij} = 1/T_{ij}$ 为面 $(i,j)$ 的阻力。根据第1部分，我们有：\n$R_{ij} = \\frac{d_{i,ij}}{A_{ij} k_i} + \\frac{d_{j,ij}}{A_{ij} k_j}$。\n将这些阻力代入 $\\phi_{\\ast}$ 的表达式中：\n$\\phi_{\\ast} = \\frac{R_{23}\\phi_1 + R_{31}\\phi_2 + R_{12}\\phi_3}{R_{23} + R_{31} + R_{12}}$\n用完整的表达式展开此式，即可得到第2部分的最终答案。\n\n**第3部分：验证**\n\n问题要求验证从星形系统中消去 $\\phi_{\\ast}$ 能得到 TPFA 通量，并且这些通量满足在点 $P$ 处的局部守恒。我们在第2部分中的推导已经起到了这个验证作用。\n我们已经确定，为了使星形和三角形模型中每个节点 $i$ 的净流出通量相同（$F_{i,\\text{out}}^{\\star} = F_{i,\\text{out}}^{\\Delta}$），$g_i$ 和 $T_{ij}$ 之间必须满足一个特定的关系。这个关系正是星-三角变换。\n在三角形网络中，离开节点 $i$ 的净通量为 $F_{i,\\text{out}}^{\\Delta} = \\sum_{j \\neq i} T_{ij}(\\phi_i - \\phi_j)$。这是成对 TPFA 通量的总和。\n在星形网络中，离开节点 $i$ 的净通量为 $F_{i,\\text{out}}^{\\star} = g_i(\\phi_i - \\phi_{\\ast})$。\n等效性 $F_{i,\\text{out}}^{\\Delta} = F_{i,\\text{out}}^{\\star}$ 证实了消去 $\\phi_\\ast$（这在用 $\\phi_1, \\phi_2, \\phi_3$ 表示 $F_{i,\\text{out}}^{\\star}$ 时已隐式完成）会产生从每个单元出发的正确的成对 TPFA 通量之和。\n\n点 $P$ 处的局部守恒是星形网络的定义特征：$\\sum_{i=1}^{3} g_i(\\phi_i - \\phi_{\\ast}) = 0$。这可以写成 $\\sum_i F_{i,\\text{out}}^{\\star} = 0$。\n由于已建立的等效性，这意味着来自三角形网络的净通量之和也必须为零：$\\sum_i F_{i,\\text{out}}^{\\Delta} = 0$。\n$\\sum_i \\sum_{j \\neq i} T_{ij}(\\phi_i - \\phi_j) = (T_{12}(\\phi_1-\\phi_2) + T_{31}(\\phi_1-\\phi_3)) + (T_{12}(\\phi_2-\\phi_1) + T_{23}(\\phi_2-\\phi_3)) + (T_{31}(\\phi_3-\\phi_1) + T_{23}(\\phi_3-\\phi_2))$。\n由于 $T_{ij}=T_{ji}$，所有项都相互抵消，从而证实了 $\\sum_i F_{i,\\text{out}}^{\\Delta} = 0$。\n因此，TPFA 通量系统与在一个中间点 $P$ 施加局部通量守恒的公式是相容的，而星形和三角形网络的等效性是这种相容性的数学体现。\n\n第2部分所要求的 $\\phi_{\\ast}$ 的最终表达式如下所示。",
            "answer": "$$\n\\boxed{\n\\frac{\n\\left(\\frac{d_{2,23}}{A_{23} k_2} + \\frac{d_{3,23}}{A_{23} k_3}\\right)\\phi_1 + \\left(\\frac{d_{3,31}}{A_{31} k_3} + \\frac{d_{1,31}}{A_{31} k_1}\\right)\\phi_2 + \\left(\\frac{d_{1,12}}{A_{12} k_1} + \\frac{d_{2,12}}{A_{12} k_2}\\right)\\phi_3\n}{\n\\left(\\frac{d_{2,23}}{A_{23} k_2} + \\frac{d_{3,23}}{A_{23} k_3}\\right) + \\left(\\frac{d_{3,31}}{A_{31} k_3} + \\frac{d_{1,31}}{A_{31} k_1}\\right) + \\left(\\frac{d_{1,12}}{A_{12} k_1} + \\frac{d_{2,12}}{A_{12} k_2}\\right)\n}\n}\n$$"
        }
    ]
}