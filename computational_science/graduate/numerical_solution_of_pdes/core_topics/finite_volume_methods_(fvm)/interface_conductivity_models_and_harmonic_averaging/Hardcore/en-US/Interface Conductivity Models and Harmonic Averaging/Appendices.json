{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of discretizing diffusion equations across material interfaces is the correct calculation of the interfacial flux. This first exercise guides you through the foundational derivation for a one-dimensional, two-material interface, starting from Fourier's law and the principle of continuity . By completing this practice, you will see how the harmonic average of conductivity is not an arbitrary choice but a direct consequence of modeling the physical system as two thermal resistors in series, a crucial concept for any physically-based simulation.",
            "id": "3409996",
            "problem": "Consider steady heat conduction of a scalar temperature field $u(x)$ governed by Fourier’s law in one spatial dimension along the $x$-axis, on a Cartesian finite volume mesh comprising rectangular control volumes. Two adjacent cells, denoted $W$ (west) and $E$ (east), share an internal vertical face at location $x=x_{f}$. Let the cell centers be at $x=x_{W}$ and $x=x_{E}$ with distances $d_{W}=x_{f}-x_{W}$ and $d_{E}=x_{E}-x_{f}$. Assume isotropic thermal conductivity that is piecewise constant in each cell, equal to $k_{W}$ within cell $W$ and $k_{E}$ within cell $E$. The normal heat flux density across the shared face, $q_{f}$, is defined positive from $W$ to $E$.\n\nStarting only from Fourier’s law $q=-k\\,\\partial u/\\partial x$ and the continuity of normal heat flux at an internal face, derive a consistent discrete expression for $q_{f}$ in terms of $u_{W}$, $u_{E}$, $d_{W}$, $d_{E}$, $k_{W}$, and $k_{E}$, and justify why the resulting interface conductivity is a harmonic average with geometric weights set by the distances $d_{W}$ and $d_{E}$ to the cell centers.\n\nThen, evaluate $q_{f}$ for the following data:\n- Cell widths $\\Delta x_{W}=0.6\\,\\mathrm{m}$ and $\\Delta x_{E}=0.2\\,\\mathrm{m}$, so that $d_{W}=\\Delta x_{W}/2$ and $d_{E}=\\Delta x_{E}/2$.\n- Conductivities $k_{W}=2.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ and $k_{E}=15\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n- Cell-centered temperatures $u_{W}=400\\,\\mathrm{K}$ and $u_{E}=300\\,\\mathrm{K}$.\n\nRound your final numerical value of $q_{f}$ to four significant figures. Express the flux density in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.",
            "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in Fourier's law of heat conduction, a fundamental principle in physics and engineering. The problem is well-posed, providing all necessary definitions, constants, and boundary conditions to derive a unique and meaningful solution for the interface heat flux. The language is objective and precise, and the numerical values provided are physically consistent and plausible. Therefore, a solution will be provided.\n\nThe primary objective is to derive a discrete expression for the normal heat flux density, $q_{f}$, across the face shared by two adjacent control volumes, $W$ and $E$. The derivation begins with Fourier's law for one-dimensional steady heat conduction:\n$$\nq = -k \\frac{du}{dx}\n$$\nwhere $q$ is the heat flux density, $k$ is the thermal conductivity, and $u$ is the temperature. For steady-state conduction in a source-free medium, the heat flux $q$ must be constant throughout the domain. Let this constant flux from cell $W$ to cell $E$ be denoted $q_{f}$.\n\nThe finite volume method discretizes the domain and assumes that the piecewise constant conductivity applies within each cell. To find the flux at the interface $x=x_{f}$, we integrate Fourier's law across the two half-cells adjacent to the face. The key physical assumptions are the continuity of temperature and the continuity of normal heat flux at the interface. Let the temperature at the interface $x_f$ be $u_f$.\n\nFirst, we consider the region between the cell center $x_W$ and the interface $x_f$. In this region, the conductivity is constant at $k=k_W$. We can rearrange Fourier's law and integrate from $x_W$ to $x_f$:\n$$\n\\int_{u(x_W)}^{u(x_f)} du = \\int_{x_W}^{x_f} -\\frac{q}{k} dx\n$$\nSince $q=q_f$ (constant) and $k=k_W$ (constant) in this interval, we have:\n$$\nu(x_f) - u(x_W) = -\\frac{q_f}{k_W} (x_f - x_W)\n$$\nUsing the provided notation, where $u_f = u(x_f)$, $u_W = u(x_W)$, and $d_W = x_f - x_W$, this becomes:\n$$\nu_f - u_W = -\\frac{q_f d_W}{k_W}\n$$\nThis equation can be rearranged to express the interface temperature $u_f$ in terms of the cell-center temperature $u_W$ and the flux $q_f$:\n$$\nu_f = u_W - \\frac{q_f d_W}{k_W}\n$$\nNext, we perform the same procedure for the region between the interface $x_f$ and the cell center $x_E$. In this region, the conductivity is constant at $k=k_E$. Integrating Fourier's law from $x_f$ to $x_E$:\n$$\n\\int_{u(x_f)}^{u(x_E)} du = \\int_{x_f}^{x_E} -\\frac{q}{k} dx\n$$\nWith $q=q_f$ and $k=k_E$, the integration yields:\n$$\nu(x_E) - u(x_f) = -\\frac{q_f}{k_E} (x_E - x_f)\n$$\nUsing the notation $u_E = u(x_E)$ and $d_E = x_E - x_f$:\n$$\nu_E - u_f = -\\frac{q_f d_E}{k_E}\n$$\nThis provides a second expression for the interface temperature $u_f$:\n$$\nu_f = u_E + \\frac{q_f d_E}{k_E}\n$$\nNow, we enforce the continuity of temperature at the interface by equating the two expressions for $u_f$. This eliminates the unknown interface temperature from the system.\n$$\nu_W - \\frac{q_f d_W}{k_W} = u_E + \\frac{q_f d_E}{k_E}\n$$\nWe can now solve for the heat flux $q_f$. Rearranging the terms to group $q_f$:\n$$\nu_W - u_E = q_f \\left( \\frac{d_W}{k_W} + \\frac{d_E}{k_E} \\right)\n$$\nFinally, the discrete expression for the heat flux density at the face is:\n$$\nq_f = \\frac{u_W - u_E}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\nThis expression is consistent because if $u_W > u_E$, the flux $q_f$ is positive, corresponding to heat flow from $W$ to $E$ as defined in the problem.\n\nTo justify why this formulation involves a harmonic average, we can compare our result to a standard finite difference approximation of Fourier's law, $q_f = -k_f \\frac{u_E - u_W}{d_W + d_E}$, where $k_f$ is an effective interface conductivity.\nBy rewriting our derived expression for $q_f$:\n$$\nq_f = - \\frac{u_E - u_W}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\nComparing the two forms for $q_f$, we can equate the coefficients of the temperature difference term, $-(u_E-u_W)$:\n$$\n\\frac{k_f}{d_W + d_E} = \\frac{1}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\nSolving for $k_f$ gives:\n$$\nk_f = \\frac{d_W + d_E}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\nThis is the definition of the weighted harmonic average of the conductivities $k_W$ and $k_E$, with the weights being the respective distances $d_W$ and $d_E$. This averaging scheme naturally arises from the physical model of two thermal resistors in series. The thermal resistance per unit area of a slab of thickness $\\Delta x$ and conductivity $k$ is $R' = \\frac{\\Delta x}{k}$. The total resistance from the center of cell $W$ to the center of cell $E$ is the sum of the resistances of the two segments: $R'_{total} = R'_W + R'_E = \\frac{d_W}{k_W} + \\frac{d_E}{k_E}$. The heat flux is the temperature difference across the total resistance, $q_f = \\frac{\\Delta u}{R'_{total}} = \\frac{u_W - u_E}{R'_{total}}$, which is precisely the derived expression.\n\nNow, we evaluate $q_f$ using the given numerical data:\n- Cell widths: $\\Delta x_{W}=0.6\\,\\mathrm{m}$ and $\\Delta x_{E}=0.2\\,\\mathrm{m}$.\n- Distances to cell centers: $d_{W}=\\frac{\\Delta x_{W}}{2}=\\frac{0.6}{2}=0.3\\,\\mathrm{m}$ and $d_{E}=\\frac{\\Delta x_{E}}{2}=\\frac{0.2}{2}=0.1\\,\\mathrm{m}$.\n- Conductivities: $k_{W}=2.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ and $k_{E}=15\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n- Cell-centered temperatures: $u_{W}=400\\,\\mathrm{K}$ and $u_{E}=300\\,\\mathrm{K}$.\n\nSubstituting these values into the derived expression for $q_f$:\n$$\nq_f = \\frac{400 - 300}{\\frac{0.3}{2.5} + \\frac{0.1}{15}}\n$$\nFirst, calculate the terms in the denominator:\n$$\n\\frac{d_W}{k_W} = \\frac{0.3}{2.5} = 0.12 \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\n$$\n\\frac{d_E}{k_E} = \\frac{0.1}{15} = \\frac{1}{150} \\approx 0.00666\\overline{6} \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\nThe denominator is the sum of these two resistances:\n$$\n\\frac{d_W}{k_W} + \\frac{d_E}{k_E} = 0.12 + \\frac{1}{150} = \\frac{12}{100} + \\frac{1}{150} = \\frac{3}{25} + \\frac{1}{150} = \\frac{18}{150} + \\frac{1}{150} = \\frac{19}{150} \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\nThe temperature difference is $\\Delta u = u_W - u_E = 400 - 300 = 100 \\, \\mathrm{K}$.\nNow, we calculate the flux density:\n$$\nq_f = \\frac{100}{\\frac{19}{150}} = \\frac{100 \\times 150}{19} = \\frac{15000}{19} \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\nPerforming the division:\n$$\nq_f \\approx 789.473684... \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\nRounding the result to four significant figures as requested:\n$$\nq_f \\approx 789.5 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\nThe positive sign indicates that the heat flux is directed from cell $W$ to cell $E$, consistent with the higher temperature in cell $W$.",
            "answer": "$$\n\\boxed{789.5}\n$$"
        },
        {
            "introduction": "Real-world materials are often arranged in complex configurations, where more than two distinct media meet at a point or a line. This practice challenges you to extend the principles from the simple 1D interface to a two-dimensional vertex where three materials converge . By deriving a locally conservative flux model using an auxiliary potential, you will learn a powerful technique for ensuring physical consistency in discretizations of complex, multi-material geometries, which is essential for advanced simulators.",
            "id": "3410014",
            "problem": "Consider steady diffusion governed by the partial differential equation (PDE) $-\\nabla \\cdot (k \\nabla \\phi) = 0$ in a two-dimensional medium consisting of three polygonal control volumes that meet at a single point $P$. Within each control volume $i \\in \\{1,2,3\\}$, the conductivity is piecewise constant and equal to $k_i$, and the unknown field is cell-averaged to the control-volume center $\\phi_i$. The interfaces between the three control volumes are straight segments that meet at $P$ and are denoted by faces $(1,2)$, $(2,3)$, and $(3,1)$, with respective lengths (areas in two dimensions) $A_{12}$, $A_{23}$, and $A_{31}$. Assume an orthogonal layout suitable for the Two-Point Flux Approximation (TPFA) within the Finite Volume Method (FVM): for each face $(i,j)$, the line segment connecting the centers of control volumes $i$ and $j$ is orthogonal to the face, and the distances from control-volume centers to the face along the normal are $d_{i,ij}$ and $d_{j,ij}$, respectively. There are no sources or sinks at the junction point $P$.\n\nStarting from Fourier’s law $q_n = -k \\,\\partial \\phi/\\partial n$ and the series addition of diffusive resistances across a face, do the following.\n\n1. For each interface face $(i,j)$, postulate a physically consistent face flux model of the TPFA form $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$ and derive the face transmissibility $T_{ij}$ based on the assumption that the normal diffusive resistances in the two adjacent materials add in series across the face.\n\n2. Introduce an auxiliary junction unknown $\\phi_{\\ast}$ at $P$ and three nonnegative conductances $g_1$, $g_2$, and $g_3$ connecting $\\phi_{\\ast}$ to $\\phi_1$, $\\phi_2$, and $\\phi_3$, respectively, such that: (a) local conservation at $P$ holds in the sense $\\sum_{i=1}^{3} g_i(\\phi_i - \\phi_{\\ast}) = 0$, and (b) eliminating the auxiliary unknown $\\phi_{\\ast}$ produces the same pairwise face fluxes $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$ you derived in part 1. Using only these two requirements, derive an explicit analytic expression for $\\phi_{\\ast}$ solely in terms of $\\phi_1$, $\\phi_2$, $\\phi_3$, $k_1$, $k_2$, $k_3$, $A_{12}$, $A_{23}$, $A_{31}$, $d_{1,12}$, $d_{2,12}$, $d_{2,23}$, $d_{3,23}$, $d_{3,31}$, and $d_{1,31}$.\n\n3. Briefly verify, by eliminating $\\phi_{\\ast}$ from the locally conservative star system, that the resulting pairwise fluxes between control-volume centers match the TPFA model $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$ and hence satisfy local conservation at $P$.\n\nProvide as your final answer the explicit closed-form expression for $\\phi_{\\ast}$ requested in part 2. Do not provide intermediate steps in the final answer. No numerical evaluation is required.",
            "solution": "The problem is well-posed and scientifically sound, representing a standard derivation in the numerical solution of partial differential equations using the Finite Volume Method. We shall proceed by addressing the three parts of the problem in sequence.\n\n**Part 1: Derivation of Face Transmissibility $T_{ij}$**\n\nWe consider the steady-state diffusion equation $-\\nabla \\cdot (k \\nabla \\phi) = 0$. For the Two-Point Flux Approximation (TPFA) to be valid, we rely on the given orthogonality condition: the line connecting the centers of adjacent control volumes $i$ and $j$ is orthogonal to the shared face $(i,j)$. This allows us to approximate the flux calculation as a one-dimensional problem along this line.\n\nLet the flux from control volume $i$ to control volume $j$ across face $(i,j)$ be denoted by $F_{ij}$. The total flux $F_{ij}$ is the product of the normal flux density, $q_{ij}$, and the face area, $A_{ij}$.\nFrom Fourier's law, the flux density is proportional to the negative gradient of the potential $\\phi$. Assuming a linear profile for $\\phi$ in the segments from the cell centers to the face, we can write the flux density in two parts, one for each side of the face. Let $\\phi_{f,ij}$ be the potential at the face $(i,j)$.\n\nThe flux density from cell center $i$ to the face is $q_{ij} = k_i \\frac{\\phi_i - \\phi_{f,ij}}{d_{i,ij}}$.\nThe flux density from the face to cell center $j$ is $q_{ij} = k_j \\frac{\\phi_{f,ij} - \\phi_j}{d_{j,ij}}$.\nSince the flux density must be continuous across the face (no sources or sinks at the interface), we can express the total flux $F_{ij} = A_{ij} q_{ij}$ in two ways:\n$F_{ij} = A_{ij} k_i \\frac{\\phi_i - \\phi_{f,ij}}{d_{i,ij}} \\implies \\phi_i - \\phi_{f,ij} = F_{ij} \\left( \\frac{d_{i,ij}}{A_{ij} k_i} \\right)$\n$F_{ij} = A_{ij} k_j \\frac{\\phi_{f,ij} - \\phi_j}{d_{j,ij}} \\implies \\phi_{f,ij} - \\phi_j = F_{ij} \\left( \\frac{d_{j,ij}}{A_{ij} k_j} \\right)$\n\nThe terms in the parentheses represent the diffusive resistances of the half-cells adjacent to the face. The principle of series addition of resistances states that the total potential drop is the sum of the potential drops across each resistive element.\nSumming the two equations above eliminates the face potential $\\phi_{f,ij}$:\n$(\\phi_i - \\phi_{f,ij}) + (\\phi_{f,ij} - \\phi_j) = \\phi_i - \\phi_j$\n$\\phi_i - \\phi_j = F_{ij} \\left( \\frac{d_{i,ij}}{A_{ij} k_i} \\right) + F_{ij} \\left( \\frac{d_{j,ij}}{A_{ij} k_j} \\right) = F_{ij} \\left( \\frac{d_{i,ij}}{A_{ij} k_i} + \\frac{d_{j,ij}}{A_{ij} k_j} \\right)$\n\nWe are given the TPFA model $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$. By rearranging the derived equation for $F_{ij}$, we get:\n$F_{ij} = \\frac{\\phi_i - \\phi_j}{\\frac{d_{i,ij}}{A_{ij} k_i} + \\frac{d_{j,ij}}{A_{ij} k_j}}$\n\nComparing this with the TPFA model, we identify the face transmissibility $T_{ij}$ as the inverse of the total series resistance:\n$T_{ij} = \\frac{1}{\\frac{d_{i,ij}}{A_{ij} k_i} + \\frac{d_{j,ij}}{A_{ij} k_j}} = A_{ij} \\frac{1}{\\frac{d_{i,ij}}{k_i} + \\frac{d_{j,ij}}{k_j}}$\nThis expression is a harmonic average of the conductivities $k_i$ and $k_j$, weighted by the distances $d_{i,ij}$ and $d_{j,ij}$, and scaled by the face area $A_{ij}$.\n\n**Part 2: Derivation of the Auxiliary Junction Potential $\\phi_{\\ast}$**\n\nWe are given a star-shaped network connecting the three cell centers $\\phi_1, \\phi_2, \\phi_3$ to a central auxiliary point $P$ with potential $\\phi_{\\ast}$. The connection from each $\\phi_i$ to $\\phi_{\\ast}$ has a conductance $g_i$.\n\nRequirement (a) states local conservation at $P$:\n$\\sum_{i=1}^{3} g_i(\\phi_i - \\phi_{\\ast}) = 0$\n$g_1(\\phi_1 - \\phi_{\\ast}) + g_2(\\phi_2 - \\phi_{\\ast}) + g_3(\\phi_3 - \\phi_{\\ast}) = 0$\nSolving for $\\phi_{\\ast}$ gives:\n$g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3 = (g_1 + g_2 + g_3)\\phi_{\\ast}$\n$\\phi_{\\ast} = \\frac{g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3}{g_1 + g_2 + g_3}$\n\nRequirement (b) states that this star network must be equivalent to the original delta network of TPFA fluxes, i.e., $F_{ij} = T_{ij}(\\phi_i - \\phi_j)$. This equivalence is established through the standard star-delta (or T-Π) transformation. The net flux leaving any node $i$ must be the same in both models.\nIn the delta network (TPFA model), the flux out of node $1$ is $F_{1,\\text{out}}^{\\Delta} = T_{12}(\\phi_1 - \\phi_2) + T_{31}(\\phi_1 - \\phi_3)$.\nIn the star network, the flux out of node $1$ is $F_{1,\\text{out}}^{\\star} = g_1(\\phi_1 - \\phi_{\\ast})$. Substituting the expression for $\\phi_{\\ast}$:\n$F_{1,\\text{out}}^{\\star} = g_1 \\left( \\phi_1 - \\frac{g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3}{g_1 + g_2 + g_3} \\right) = \\frac{g_1}{g_1+g_2+g_3} \\left( (g_1+g_2+g_3)\\phi_1 - (g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3) \\right)$\n$F_{1,\\text{out}}^{\\star} = \\frac{g_1}{g_1+g_2+g_3} (g_2(\\phi_1 - \\phi_2) + g_3(\\phi_1 - \\phi_3))$\n$F_{1,\\text{out}}^{\\star} = \\frac{g_1 g_2}{g_1+g_2+g_3}(\\phi_1 - \\phi_2) + \\frac{g_1 g_3}{g_1+g_2+g_3}(\\phi_1 - \\phi_3)$\n\nEquating the coefficients of $(\\phi_i - \\phi_j)$ in $F_{1,\\text{out}}^{\\Delta}$ and $F_{1,\\text{out}}^{\\star}$ (and similarly for nodes $2$ and $3$) yields the star-to-delta transformation formulas:\n$T_{12} = \\frac{g_1 g_2}{g_1+g_2+g_3}$\n$T_{23} = \\frac{g_2 g_3}{g_1+g_2+g_3}$\n$T_{31} = \\frac{g_3 g_1}{g_1+g_2+g_3}$\n\nTo find $\\phi_{\\ast}$, we need the conductances $g_i$ in terms of the known transmissibilities $T_{ij}$. This is the delta-to-star transformation. Consider the sum of products:\n$T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12} = \\frac{g_1g_2^2g_3 + g_2g_3^2g_1 + g_3g_1^2g_2}{(g_1+g_2+g_3)^2} = \\frac{g_1g_2g_3(g_1+g_2+g_3)}{(g_1+g_2+g_3)^2} = \\frac{g_1g_2g_3}{g_1+g_2+g_3}$\nLet $N = T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12}$. Then $N = \\frac{g_1g_2g_3}{g_1+g_2+g_3}$.\nDividing $N$ by $T_{23}$ yields:\n$\\frac{N}{T_{23}} = \\frac{g_1g_2g_3/(g_1+g_2+g_3)}{g_2g_3/(g_1+g_2+g_3)} = g_1$.\nBy cyclic permutation of indices, we find the expressions for the star conductances:\n$g_1 = \\frac{T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12}}{T_{23}}$\n$g_2 = \\frac{T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12}}{T_{31}}$\n$g_3 = \\frac{T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12}}{T_{12}}$\n\nNow we substitute these into the equation for $\\phi_{\\ast}$:\n$\\phi_{\\ast} = \\frac{g_1\\phi_1 + g_2\\phi_2 + g_3\\phi_3}{g_1 + g_2 + g_3}$\nThe numerator term $(T_{12}T_{23} + T_{23}T_{31} + T_{31}T_{12})$ is common to all $g_i$ and can be factored out from the numerator and denominator of the expression for $\\phi_{\\ast}$.\n$\\phi_{\\ast} = \\frac{ (\\frac{1}{T_{23}})\\phi_1 + (\\frac{1}{T_{31}})\\phi_2 + (\\frac{1}{T_{12}})\\phi_3 }{ \\frac{1}{T_{23}} + \\frac{1}{T_{31}} + \\frac{1}{T_{12}} }$\n\nThis elegant result shows that $\\phi_{\\ast}$ is a weighted average of the surrounding cell potentials, where the weight for each $\\phi_i$ is the inverse transmissibility (i.e., the resistance) of the face *opposite* to node $i$.\nLet $R_{ij} = 1/T_{ij}$ be the resistance of face $(i,j)$. From Part 1, we have:\n$R_{ij} = \\frac{d_{i,ij}}{A_{ij} k_i} + \\frac{d_{j,ij}}{A_{ij} k_j}$.\nSubstituting these resistances into the expression for $\\phi_{\\ast}$:\n$\\phi_{\\ast} = \\frac{R_{23}\\phi_1 + R_{31}\\phi_2 + R_{12}\\phi_3}{R_{23} + R_{31} + R_{12}}$\nExpanding this with the full expressions gives the final answer for Part 2.\n\n**Part 3: Verification**\n\nThe problem asks to verify that eliminating $\\phi_{\\ast}$ from the star system yields the TPFA fluxes and that these satisfy local conservation at $P$. Our derivation in Part 2 already serves as this verification.\nWe established that for the net flux out of each node $i$ to be identical in the star and delta models ($F_{i,\\text{out}}^{\\star} = F_{i,\\text{out}}^{\\Delta}$), a specific relationship between $g_i$ and $T_{ij}$ must hold. This relationship is precisely the star-delta transformation.\nThe net flux out of node $i$ in the delta network is $F_{i,\\text{out}}^{\\Delta} = \\sum_{j \\neq i} T_{ij}(\\phi_i - \\phi_j)$. This is the sum of the pairwise TPFA fluxes.\nThe net flux out of node $i$ in the star network is $F_{i,\\text{out}}^{\\star} = g_i(\\phi_i - \\phi_{\\ast})$.\nThe equivalence $F_{i,\\text{out}}^{\\Delta} = F_{i,\\text{out}}^{\\star}$ confirms that eliminating $\\phi_\\ast$ (which is implicitly done when writing $F_{i,\\text{out}}^{\\star}$ in terms of $\\phi_1, \\phi_2, \\phi_3$) produces the correct sum of pairwise TPFA fluxes from each cell.\n\nLocal conservation at $P$ is the defining characteristic of the star network: $\\sum_{i=1}^{3} g_i(\\phi_i - \\phi_{\\ast}) = 0$. This can be written as $\\sum_i F_{i,\\text{out}}^{\\star} = 0$.\nBecause of the established equivalence, this implies that the sum of the net fluxes from the delta network must also be zero: $\\sum_i F_{i,\\text{out}}^{\\Delta} = 0$.\n$\\sum_i \\sum_{j \\neq i} T_{ij}(\\phi_i - \\phi_j) = (T_{12}(\\phi_1-\\phi_2) + T_{31}(\\phi_1-\\phi_3)) + (T_{12}(\\phi_2-\\phi_1) + T_{23}(\\phi_2-\\phi_3)) + (T_{31}(\\phi_3-\\phi_1) + T_{23}(\\phi_3-\\phi_2))$.\nSince $T_{ij}=T_{ji}$, all terms cancel, confirming $\\sum_i F_{i,\\text{out}}^{\\Delta} = 0$.\nThus, the system of TPFA fluxes is consistent with a formulation that imposes local flux conservation at an intermediate point $P$, and the equivalence of the star and delta networks is the mathematical embodiment of this consistency.\n\nThe final expression for $\\phi_{\\ast}$ requested in Part 2 is provided below.",
            "answer": "$$\n\\boxed{\n\\frac{\n\\left(\\frac{d_{2,23}}{A_{23} k_2} + \\frac{d_{3,23}}{A_{23} k_3}\\right)\\phi_1 + \\left(\\frac{d_{3,31}}{A_{31} k_3} + \\frac{d_{1,31}}{A_{31} k_1}\\right)\\phi_2 + \\left(\\frac{d_{1,12}}{A_{12} k_1} + \\frac{d_{2,12}}{A_{12} k_2}\\right)\\phi_3\n}{\n\\left(\\frac{d_{2,23}}{A_{23} k_2} + \\frac{d_{3,23}}{A_{23} k_3}\\right) + \\left(\\frac{d_{3,31}}{A_{31} k_3} + \\frac{d_{1,31}}{A_{31} k_1}\\right) + \\left(\\frac{d_{1,12}}{A_{12} k_1} + \\frac{d_{2,12}}{A_{12} k_2}\\right)\n}\n}\n$$"
        },
        {
            "introduction": "While theoretical derivations provide the foundation, numerical experiments provide the ultimate proof of a method's validity and performance. This hands-on coding practice tasks you with comparing the convergence behavior of a finite volume scheme using the correct harmonic average against a naive scheme using a simple arithmetic average . By implementing both for a classic checkerboard problem with high conductivity contrast, you will gain a practical understanding of why proper interface treatment is absolutely critical for achieving accurate and reliable numerical solutions.",
            "id": "3409997",
            "problem": "Consider the stationary diffusion equation with spatially varying isotropic conductivity,\n$$\n-\\nabla \\cdot \\left(k(\\mathbf{x}) \\nabla u(\\mathbf{x})\\right) = f(\\mathbf{x}) \\quad \\text{in } \\Omega = (0,1)\\times(0,1),\n$$\nsubject to homogeneous Dirichlet boundary conditions,\n$$\nu(\\mathbf{x}) = 0 \\quad \\text{on } \\partial\\Omega.\n$$\nAssume a uniform Cartesian partition of $\\Omega$ into $N\\times N$ square control volumes of side length $h = 1/N$ with scalar cell-centered unknowns $u_{i,j}$ interpreted as cell averages over cell $(i,j)$ for $i,j \\in \\{0,\\dots,N-1\\}$. Let the source be constant $f(\\mathbf{x}) \\equiv f_0$ for a specified scalar $f_0$. The conductivity $k(\\mathbf{x})$ is piecewise constant per cell, forming a checkerboard pattern with two positive constants $k_{\\mathrm{high}}$ and $k_{\\mathrm{low}}$ alternating by parity of the cell indices, i.e., the cell conductivity $k_{i,j}$ equals $k_{\\mathrm{high}}$ if $i+j$ is even and $k_{\\mathrm{low}}$ if $i+j$ is odd. This arrangement models a strongly heterogeneous medium with discontinuous interfaces aligned to the grid.\n\nStarting from the local conservation law and the definition of diffusive flux through cell faces, discretize the operator using two distinct face conductivity models:\n- A physically consistent finite volume discretization that uses a face-centered conductivity derived from an interface model appropriate for series conduction across abutting half-cells. For interior faces between two neighboring cells, use the conductivity implied by the interface model. For boundary-adjacent faces, treat the homogeneous Dirichlet boundary condition located at the cell face and derive the correct face transmissibility from first principles.\n- A centered difference scheme that uses an arithmetic average of the two cell conductivities at each interior face. Treat boundary-adjacent faces consistently with the centered difference stencil and the homogeneous Dirichlet boundary condition placed at the cell face.\n\nOn the uniform grid, both schemes produce a five-point stencil in two dimensions. Assemble the resulting linear system\n$$\nA u = b,\n$$\nwhere $u \\in \\mathbb{R}^{N^2}$ collects $\\{u_{i,j}\\}$ in lexicographic order, and $b \\in \\mathbb{R}^{N^2}$ is the discretized source term. Solve this system to obtain numerical solutions for both schemes.\n\nTo quantify convergence, define the discrete $L^2$ norm of a cell-centered field $w_{i,j}$ by\n$$\n\\|w\\|_{L^2_h} \\coloneqq \\left( \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} w_{i,j}^2 \\, h^2 \\right)^{1/2}.\n$$\nSince a closed-form exact solution $u(\\mathbf{x})$ is generally not available for discontinuous coefficient fields, use a reference solution computed on a much finer grid for the physically consistent finite volume discretization. Specifically, compute a reference solution on a grid with $N_{\\mathrm{ref}} = 128$ using the finite volume scheme and restrict it to coarser grids by block averaging over non-overlapping $s \\times s$ blocks, where $s = N_{\\mathrm{ref}}/N$ is an integer. For a given coarse grid solution $u^{(N)}$ and the corresponding restricted reference $u^{\\mathrm{ref}\\to N}$, define the error\n$$\nE(N) \\coloneqq \\left\\| u^{(N)} - u^{\\mathrm{ref}\\to N} \\right\\|_{L^2_h}.\n$$\nFor each scheme, estimate the empirical convergence rate $p$ by fitting a straight line to the data $\\left\\{ \\left(\\log h, \\log E(N)\\right) \\right\\}$ across multiple grid sizes, where $h = 1/N$. Use linear least squares to obtain the slope $p$.\n\nYour task is to implement this benchmark and produce empirical convergence rates for both schemes over a small test suite comprising different conductivity contrasts. Use the following test suite:\n- Case $1$: $k_{\\mathrm{high}} = 10$, $k_{\\mathrm{low}} = 1$, $f_0 = 1$, coarse grid sizes $N \\in \\{16, 32, 64\\}$.\n- Case $2$: $k_{\\mathrm{high}} = 1000$, $k_{\\mathrm{low}} = 1$, $f_0 = 1$, coarse grid sizes $N \\in \\{16, 32, 64\\}$.\n- Case $3$: $k_{\\mathrm{high}} = 1$, $k_{\\mathrm{low}} = 10^{-3}$, $f_0 = 1$, coarse grid sizes $N \\in \\{16, 32, 64\\}$.\n\nFor each case, compute a single reference solution on the fine grid with $N_{\\mathrm{ref}} = 128$ using the finite volume scheme with the physically consistent face conductivity model. Then, for each coarse grid in the set, solve both schemes and compute the error relative to the restricted reference. Estimate the convergence rate $p_{\\mathrm{FV}}$ for the finite volume scheme and $p_{\\mathrm{CD}}$ for the centered difference scheme by linear regression of $\\log E(N)$ against $\\log h$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n\\left[ p_{\\mathrm{FV}}^{(1)},\\, p_{\\mathrm{CD}}^{(1)},\\, p_{\\mathrm{FV}}^{(2)},\\, p_{\\mathrm{CD}}^{(2)},\\, p_{\\mathrm{FV}}^{(3)},\\, p_{\\mathrm{CD}}^{(3)} \\right],\n$$\nwhere the superscript indicates the case index. Each entry must be a floating-point number.\n\nNo external input is required. All physical quantities are nondimensional in this benchmark, so no physical units are to be reported. Angles are not used. Percentages are not used. The final output must adhere exactly to the required format.",
            "solution": "We begin from the fundamental conservation principle for steady diffusion. For a control volume $V_{i,j}$ surrounding a cell center $(i,j)$ with volume $|V_{i,j}| = h^2$, integrating the partial differential equation yields\n$$\n\\int_{V_{i,j}} -\\nabla \\cdot \\left(k \\nabla u\\right) \\, \\mathrm{d}\\mathbf{x} = \\int_{V_{i,j}} f \\, \\mathrm{d}\\mathbf{x}.\n$$\nBy the divergence theorem, the left-hand side equals the net diffusive flux through the boundary of the volume,\n$$\n\\sum_{\\text{faces } F \\subset \\partial V_{i,j}} \\int_{F} \\left( -k \\nabla u \\cdot \\mathbf{n}_F \\right) \\, \\mathrm{d}S = \\int_{V_{i,j}} f \\, \\mathrm{d}\\mathbf{x}.\n$$\nOn a uniform Cartesian grid with side length $h$, each interior face has area $h$ and the distance between adjacent cell centers is $h$. Approximating the normal derivative across a face between two adjacent cell centers by a centered difference, the diffusive flux across an interior face $F$ between cells $(i,j)$ and $(i',j')$ can be written as\n$$\n\\Phi_F \\approx -k_F \\frac{u_{i',j'} - u_{i,j}}{h} \\cdot h = -k_F\\,(u_{i',j'} - u_{i,j}),\n$$\nwhere $k_F$ is an effective face conductivity. Substituting into the integrated balance and dividing both sides by the cell volume $h^2$ yields a discrete equation in the standard five-point form,\n$$\n\\sum_{\\text{neighbors } (i',j')} \\frac{k_F}{h^2}\\left(u_{i,j} - u_{i',j'}\\right) + \\sum_{\\text{boundary faces}} \\frac{k_{F,\\partial}}{h^2}\\left(u_{i,j} - u_{\\mathrm{bc}}\\right) = f_{i,j}.\n$$\nHere, the second sum accounts for boundary-adjacent faces. For a homogeneous Dirichlet boundary condition $u_{\\mathrm{bc}} = 0$ placed directly at the cell face, the distance from the cell center to the boundary is $h/2$, and the normal derivative approximation becomes\n$$\n\\frac{u_{\\mathrm{bc}} - u_{i,j}}{h/2},\n$$\nso the boundary face flux magnitude is\n$$\n\\Phi_{F,\\partial} \\approx -k_{i,j} \\frac{u_{\\mathrm{bc}} - u_{i,j}}{h/2} \\cdot h = -2 k_{i,j} (u_{\\mathrm{bc}} - u_{i,j}).\n$$\nDividing by $h^2$, the boundary face transmissibility is\n$$\nT_{F,\\partial} = \\frac{2 k_{i,j}}{h^2}.\n$$\n\nThe crucial modeling choice is the effective face conductivity $k_F$ for interior faces. Consider two adjacent cells with conductivities $k_L$ and $k_R$ in the normal direction, abutting along a common face. Modeling the composite medium normal to the face as two layers of thickness $h/2$ in series, the equivalent resistance per unit area in the normal direction is\n$$\nR_{\\mathrm{eq}} = \\frac{h/2}{k_L} + \\frac{h/2}{k_R} = \\frac{h}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right).\n$$\nThe equivalent conductivity $k_F$ that produces the same normal flux for a unit jump in $u$ across the distance $h$ satisfies\n$$\n\\Phi_F = -k_F \\frac{\\Delta u}{h} \\cdot h = -k_F \\Delta u,\n$$\nand by equating to the series flux through the two half-cells,\n$$\n\\Phi_F = -\\frac{\\Delta u}{R_{\\mathrm{eq}}}.\n$$\nThus,\n$$\nk_F = \\frac{h}{R_{\\mathrm{eq}}} = \\frac{h}{\\frac{h}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right)} = \\frac{2}{\\frac{1}{k_L} + \\frac{1}{k_R}}.\n$$\nThis is the harmonic average of $k_L$ and $k_R$, and it arises from the fundamental series conduction model at an interface. Using this $k_F$ in the discrete flux yields a physically consistent finite volume scheme across discontinuous interfaces.\n\nIn contrast, a commonly used centered difference approximation in heterogeneous media often replaces $k_F$ with the arithmetic average,\n$$\nk_F^{\\mathrm{arith}} = \\frac{k_L + k_R}{2},\n$$\nwhich is exact for uniform $k$ but inconsistent for sharp jumps; it misrepresents series conduction and tends to smear interface effects, resulting in reduced accuracy and potentially grid-dependent artifacts.\n\nFor both schemes, the assembled matrix $A$ is symmetric positive definite with diagonal entries equal to the sum of transmissibilities to neighbors and boundary faces, and off-diagonal entries equal to negative transmissibilities connecting adjacent cells. The right-hand side $b$ uses the cell-centered source $f_{i,j} = f_0$.\n\nBecause a closed-form solution is not available for discontinuous checkerboard conductivity, we adopt the method of manufactured reference by computing a high-resolution solution using the physically consistent finite volume scheme on a fine grid with $N_{\\mathrm{ref}} = 128$. To compare coarse grid solutions against this reference, we restrict the fine solution to each coarse grid by block averaging over non-overlapping $s \\times s$ blocks, where $s = N_{\\mathrm{ref}}/N$ is an integer. This restriction produces a coarse field $u^{\\mathrm{ref}\\to N}$ aligned to the coarse cell averages.\n\nWe then compute the discrete $L^2$ error\n$$\nE(N) = \\left( \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\left(u^{(N)}_{i,j} - u^{\\mathrm{ref}\\to N}_{i,j}\\right)^2 \\, h^2 \\right)^{1/2}.\n$$\nAssuming an asymptotic error model $E(N) \\approx C h^p$ for sufficiently fine grids, taking logarithms yields\n$$\n\\log E(N) \\approx \\log C + p \\log h.\n$$\nWe estimate the rate $p$ by linear least squares fitting of the slope of $\\log E(N)$ versus $\\log h$ across the grid sizes $N \\in \\{16, 32, 64\\}$.\n\nThe test suite explores three contrasts: Case $1$ with moderate contrast $k_{\\mathrm{high}} = 10$, $k_{\\mathrm{low}} = 1$, Case $2$ with strong contrast $k_{\\mathrm{high}} = 1000$, $k_{\\mathrm{low}} = 1$, and Case $3$ with reverse contrast including a very small conductivity $k_{\\mathrm{low}} = 10^{-3}$ relative to $k_{\\mathrm{high}} = 1$. In all cases, the source is $f_0 = 1$. We expect the physically consistent finite volume scheme to exhibit better accuracy and more stable convergence behavior near discontinuities than the centered difference scheme with arithmetic averaging, particularly at high contrast where interface modeling is critical.\n\nAlgorithmically, the program performs the following steps for each case:\n- Construct the $N_{\\mathrm{ref}}\\times N_{\\mathrm{ref}}$ checkerboard conductivity field.\n- Assemble and solve the finite volume system with harmonic face conductivities to obtain the fine reference solution.\n- For each coarse grid size $N \\in \\{16, 32, 64\\}$:\n  - Assemble and solve the finite volume system with harmonic face conductivities.\n  - Assemble and solve the centered difference system with arithmetic face conductivities.\n  - Restrict the fine reference solution onto the coarse grid by block averaging.\n  - Compute the discrete $L^2$ error for each scheme relative to the restricted reference.\n- Estimate the convergence rates $p_{\\mathrm{FV}}$ and $p_{\\mathrm{CD}}$ by linear regression in $\\log$-$\\log$ space.\n\nFinally, the program prints a single line with the six floating-point numbers in the order\n$$\n\\left[ p_{\\mathrm{FV}}^{(1)},\\, p_{\\mathrm{CD}}^{(1)},\\, p_{\\mathrm{FV}}^{(2)},\\, p_{\\mathrm{CD}}^{(2)},\\, p_{\\mathrm{FV}}^{(3)},\\, p_{\\mathrm{CD}}^{(3)} \\right].\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csr_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef build_checkerboard_k(N: int, k_high: float, k_low: float) - np.ndarray:\n    \"\"\"\n    Build an N x N checkerboard conductivity field with k_high and k_low alternating\n    by parity of (i + j).\n    \"\"\"\n    k = np.empty((N, N), dtype=float)\n    for i in range(N):\n        for j in range(N):\n            k[i, j] = k_high if ((i + j) % 2 == 0) else k_low\n    return k\n\ndef face_conductivity(k_left: float, k_right: float, scheme: str) - float:\n    \"\"\"\n    Compute face conductivity between two adjacent cells given their conductivities.\n    scheme: 'harmonic' or 'arithmetic'\n    \"\"\"\n    if scheme == 'harmonic':\n        # Harmonic average: 2 / (1/k_left + 1/k_right)\n        # Guard against division by zero (though k are positive by construction)\n        return 2.0 / (1.0 / k_left + 1.0 / k_right)\n    elif scheme == 'arithmetic':\n        return 0.5 * (k_left + k_right)\n    else:\n        raise ValueError(\"Unknown scheme: {}\".format(scheme))\n\ndef assemble_system(N: int, k: np.ndarray, scheme: str, f0: float) - tuple:\n    \"\"\"\n    Assemble the sparse linear system A u = b for the variable-coefficient diffusion\n    problem on an N x N cell-centered grid with homogeneous Dirichlet boundary conditions.\n    Interior faces use either harmonic or arithmetic averaging depending on 'scheme'.\n    Boundary faces use a transmissibility of 2*k_cell/h^2 corresponding to a boundary at the face.\n    Returns (A_csr, b) where A_csr is a csr_matrix of size (N^2, N^2) and b is an ndarray of length N^2.\n    \"\"\"\n    h = 1.0 / N\n    # Using LIL for assembly efficiency, then convert to CSR.\n    A = lil_matrix((N * N, N * N), dtype=float)\n    b = np.full(N * N, f0, dtype=float)\n\n    def idx(i: int, j: int) - int:\n        return i * N + j\n\n    for i in range(N):\n        for j in range(N):\n            p = idx(i, j)\n            diag = 0.0\n            k_ij = k[i, j]\n\n            # Left face (neighbor at j-1 or boundary)\n            if j  0:\n                k_face = face_conductivity(k_ij, k[i, j - 1], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i, j - 1)] -= T\n            else:\n                # Boundary at left face: distance h/2\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n                # u_bc = 0, so no RHS contribution needed\n\n            # Right face (neighbor at j+1 or boundary)\n            if j  N - 1:\n                k_face = face_conductivity(k_ij, k[i, j + 1], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i, j + 1)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            # Bottom face (neighbor at i-1 or boundary)\n            if i  0:\n                k_face = face_conductivity(k_ij, k[i - 1, j], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i - 1, j)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            # Top face (neighbor at i+1 or boundary)\n            if i  N - 1:\n                k_face = face_conductivity(k_ij, k[i + 1, j], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i + 1, j)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            A[p, p] += diag\n\n    return csr_matrix(A), b\n\ndef solve_system(A: csr_matrix, b: np.ndarray) - np.ndarray:\n    \"\"\"\n    Solve the sparse linear system A u = b using a direct solver.\n    \"\"\"\n    return spsolve(A, b)\n\ndef restrict_block_average(u_ref: np.ndarray, N_ref: int, N: int) - np.ndarray:\n    \"\"\"\n    Restrict a fine-grid solution u_ref (flattened length N_ref^2) to a coarse grid of size N x N\n    by block averaging over non-overlapping s x s blocks, where s = N_ref // N.\n    Returns a flattened coarse solution of length N^2.\n    \"\"\"\n    s = N_ref // N\n    assert N_ref % N == 0, \"N_ref must be divisible by N for block averaging.\"\n    # Reshape fine solution to 2D\n    u2d = u_ref.reshape(N_ref, N_ref)\n    # Average over s x s blocks\n    u_coarse = np.zeros((N, N), dtype=float)\n    for i in range(N):\n        for j in range(N):\n            block = u2d[i * s:(i + 1) * s, j * s:(j + 1) * s]\n            u_coarse[i, j] = np.mean(block)\n    return u_coarse.ravel()\n\ndef l2_error(u_coarse: np.ndarray, u_ref_coarse: np.ndarray, N: int) - float:\n    \"\"\"\n    Compute the discrete L2 error between u_coarse and restricted reference u_ref_coarse on an N x N grid.\n    \"\"\"\n    h = 1.0 / N\n    diff = u_coarse - u_ref_coarse\n    return np.sqrt(np.sum(diff * diff) * h * h)\n\ndef convergence_rate(N_list: list, err_list: list) - float:\n    \"\"\"\n    Estimate the convergence rate p by linear regression of log(err) versus log(h),\n    where h = 1/N, across the given N_list and err_list.\n    \"\"\"\n    h_list = np.array([1.0 / N for N in N_list], dtype=float)\n    logh = np.log(h_list)\n    loge = np.log(np.array(err_list, dtype=float))\n    # Fit line: loge = a + p * logh\n    p = np.polyfit(logh, loge, 1)[0]\n    return float(p)\n\ndef run_case(k_high: float, k_low: float, f0: float, N_ref: int, N_list: list) - tuple:\n    \"\"\"\n    Run a single test case:\n    - Build checkerboard k on fine grid N_ref.\n    - Solve FV harmonic scheme on fine grid for reference.\n    - For each N in N_list, solve both schemes and compute L2 errors against restricted reference.\n    - Return the estimated convergence rates for FV harmonic and CD arithmetic.\n    \"\"\"\n    # Reference solution on fine grid using FV harmonic\n    k_ref = build_checkerboard_k(N_ref, k_high, k_low)\n    A_ref, b_ref = assemble_system(N_ref, k_ref, scheme='harmonic', f0=f0)\n    u_ref = solve_system(A_ref, b_ref)\n\n    # Collect errors across coarse grids\n    errs_fv = []\n    errs_cd = []\n\n    for N in N_list:\n        # Conductivity on coarse grid\n        kN = build_checkerboard_k(N, k_high, k_low)\n\n        # FV harmonic on coarse grid\n        A_fv, b_fv = assemble_system(N, kN, scheme='harmonic', f0=f0)\n        u_fv = solve_system(A_fv, b_fv)\n\n        # CD arithmetic on coarse grid\n        A_cd, b_cd = assemble_system(N, kN, scheme='arithmetic', f0=f0)\n        u_cd = solve_system(A_cd, b_cd)\n\n        # Restrict reference to coarse grid\n        u_ref_N = restrict_block_average(u_ref, N_ref, N)\n\n        # Errors\n        e_fv = l2_error(u_fv, u_ref_N, N)\n        e_cd = l2_error(u_cd, u_ref_N, N)\n\n        errs_fv.append(e_fv)\n        errs_cd.append(e_cd)\n\n    # Rates via regression\n    rate_fv = convergence_rate(N_list, errs_fv)\n    rate_cd = convergence_rate(N_list, errs_cd)\n\n    return rate_fv, rate_cd\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k_high, k_low, f0, N_ref, N_list)\n        (10.0, 1.0, 1.0, 128, [16, 32, 64]),\n        (1000.0, 1.0, 1.0, 128, [16, 32, 64]),\n        (1.0, 1e-3, 1.0, 128, [16, 32, 64]),\n    ]\n\n    results = []\n    for k_high, k_low, f0, N_ref, N_list in test_cases:\n        rate_fv, rate_cd = run_case(k_high, k_low, f0, N_ref, N_list)\n        # Append in the specified order\n        results.append(rate_fv)\n        results.append(rate_cd)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}