{
    "hands_on_practices": [
        {
            "introduction": "A key task in any viscous flow simulation is ensuring the computational mesh has sufficient resolution to capture the steep gradients within the boundary layer. This practice connects the analytical solution for laminar flow over a flat plate to the essential non-dimensional quantities used to assess mesh quality in CFD. By deriving the friction velocity, $u_{\\tau}$, and the dimensionless wall distance, $y^{+}$, you will gain a concrete understanding of how these critical parameters are defined and how they vary in space, which is crucial for designing and evaluating wall-resolved meshes .",
            "id": "3389986",
            "problem": "An incompressible Newtonian fluid of constant density $\\rho$ and dynamic viscosity $\\mu$ flows with uniform free-stream speed $U_{\\infty}$ over a smooth, isothermal, semi-infinite flat plate aligned with the flow. For $0<x\\leq L$, the local wall shear stress distribution is known (from a similarity solution of the laminar boundary layer) to be\n$$\n\\tau_{w}(x)=0.332\\,\\rho\\,U_{\\infty}^{2}\\,\\sqrt{\\frac{\\nu}{U_{\\infty}\\,x}},\n$$\nwhere $\\nu=\\mu/\\rho$ is the kinematic viscosity, $x$ is the streamwise distance from the leading edge, and $L$ is a characteristic plate length used to delimit the computational domain. A Computational Fluid Dynamics (CFD) mesh employs a uniform first off-wall cell height $\\Delta y$ everywhere along the plate.\n\nUsing only fundamental definitions and conservation-law-based scaling, derive closed-form analytic expressions for the friction velocity $u_{\\tau}(x)$ and the dimensionless wall distance $y^{+}(x)$ in terms of $x$, $U_{\\infty}$, $\\nu$, and $\\Delta y$. Express $u_{\\tau}(x)$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$ and $y^{+}(x)$ as dimensionless. Do not substitute numerical values or perform rounding; present simplified symbolic expressions.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and objective. It provides all necessary information to derive the requested quantities based on fundamental definitions in fluid mechanics.\n\nThe derivation proceeds in two parts. First, we will derive the expression for the friction velocity, $u_{\\tau}(x)$, and second, we will derive the expression for the dimensionless wall distance, $y^{+}(x)$.\n\nThe friction velocity, $u_{\\tau}$, is a quantity with units of velocity, defined in terms of the wall shear stress, $\\tau_{w}$, and the fluid density, $\\rho$. The fundamental definition is:\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_{w}}{\\rho}}\n$$\nThe problem provides the expression for the local wall shear stress, $\\tau_{w}(x)$, for laminar flow over a flat plate:\n$$\n\\tau_{w}(x) = 0.332\\,\\rho\\,U_{\\infty}^{2}\\,\\sqrt{\\frac{\\nu}{U_{\\infty}\\,x}}\n$$\nwhere $U_{\\infty}$ is the free-stream speed, $\\nu$ is the kinematic viscosity, and $x$ is the streamwise coordinate. Substituting this expression for $\\tau_{w}(x)$ into the definition of $u_{\\tau}$ yields the friction velocity as a function of $x$:\n$$\nu_{\\tau}(x) = \\sqrt{\\frac{1}{\\rho} \\left( 0.332\\,\\rho\\,U_{\\infty}^{2}\\,\\sqrt{\\frac{\\nu}{U_{\\infty}\\,x}} \\right)}\n$$\nThe density $\\rho$ cancels out:\n$$\nu_{\\tau}(x) = \\sqrt{0.332\\,U_{\\infty}^{2}\\,\\left(\\frac{\\nu}{U_{\\infty}\\,x}\\right)^{1/2}}\n$$\nWe can simplify this expression by applying the properties of exponents:\n$$\nu_{\\tau}(x) = (0.332)^{1/2} \\, (U_{\\infty}^{2})^{1/2} \\, \\left(\\left(\\frac{\\nu}{U_{\\infty}\\,x}\\right)^{1/2}\\right)^{1/2}\n$$\n$$\nu_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty} \\, \\left(\\frac{\\nu}{U_{\\infty}\\,x}\\right)^{1/4}\n$$\nDistributing the exponent $1/4$ to the terms inside the parenthesis gives:\n$$\nu_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty} \\, \\frac{\\nu^{1/4}}{U_{\\infty}^{1/4} \\, x^{1/4}}\n$$\nCombining the terms involving $U_{\\infty}$ leads to the final simplified expression for the friction velocity:\n$$\nu_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty}^{1 - 1/4} \\, \\nu^{1/4} \\, x^{-1/4} = \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4}\n$$\nThis expression provides the friction velocity in units of velocity ($\\mathrm{m}\\,\\mathrm{s}^{-1}$), as requested.\n\nNext, we derive the expression for the dimensionless wall distance, $y^{+}$. The fundamental definition of $y^{+}$ is:\n$$\ny^{+} = \\frac{y u_{\\tau}}{\\nu}\n$$\nwhere $y$ is the physical distance from the wall. In the context of Computational Fluid Dynamics (CFD), $y^{+}$ is a crucial parameter for evaluating the resolution of the mesh near a wall. The problem specifies a uniform first off-wall cell height of $\\Delta y$. The dimensionless distance is typically evaluated at a characteristic height within this first cell. The problem requires the expression for $y^{+}(x)$ in terms of $\\Delta y$, implying that we should use this height as the characteristic physical distance from the wall. Therefore, we set $y = \\Delta y$. This gives the $y^{+}$ value at the top of the first cell layer.\n$$\ny^{+}(x) = \\frac{\\Delta y \\, u_{\\tau}(x)}{\\nu}\n$$\nNow, we substitute the previously derived expression for $u_{\\tau}(x)$:\n$$\ny^{+}(x) = \\frac{\\Delta y}{\\nu} \\left( \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4} \\right)\n$$\nWe can simplify this expression by combining the terms involving the kinematic viscosity $\\nu$:\n$$\ny^{+}(x) = \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{1/4 - 1} \\, x^{-1/4}\n$$\n$$\ny^{+}(x) = \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{-3/4} \\, x^{-1/4}\n$$\nThis expression gives the dimensionless wall distance $y^{+}$ as a function of $x$ and the mesh parameter $\\Delta y$. The expression is dimensionless as required.\n\nThe two requested expressions are thus:\n1. Friction velocity: $u_{\\tau}(x) = \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4}$\n2. Dimensionless wall distance: $y^{+}(x) = \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{-3/4} \\, x^{-1/4}$\nThese are the final, simplified, closed-form analytic expressions based on the provided information and fundamental definitions.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{0.332} \\, U_{\\infty}^{3/4} \\, \\nu^{1/4} \\, x^{-1/4} & \\sqrt{0.332} \\, \\Delta y \\, U_{\\infty}^{3/4} \\, \\nu^{-3/4} \\, x^{-1/4} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Translating a physical boundary condition, like the no-slip rule, into a discrete numerical algorithm is a cornerstone of CFD. This exercise guides you through the derivation and implementation of a ghost-cell method, a standard technique in finite-volume solvers to enforce Dirichlet boundary conditions for velocity. By constructing the ghost-cell velocity value, you will see exactly how the solver can be made to respect the physical velocity at the wall and how this consistently defines the numerical wall shear stress .",
            "id": "3389957",
            "problem": "A developer is implementing wall boundary conditions in a one-dimensional, planar, collocated finite-volume discretization for a Newtonian viscous fluid within Computational Fluid Dynamics (CFD). Consider an interior control volume with center at point $P$ and a ghost control volume with center at point $G$, where the plane separating $P$ and $G$ coincides with a physical wall face at point $f$. The coordinate $n$ is normal to the wall, pointing from $P$ towards $G$. The distances from the wall face to the centers are $d_P$ for $P$ and $d_G$ for $G$, each strictly positive. The scalar of interest is the tangential velocity component $u$, and the wall imposes a Dirichlet no-slip condition specifying a tangential wall velocity $U_w$ at the wall face. The dynamic viscosity is $\\mu$, and the mass density is $\\rho$.\n\nStarting only from the following foundational bases:\n- Linear interpolation for a scalar between neighboring points along the line connecting their centers.\n- Newton’s law of viscosity for a Newtonian fluid, which states that the wall shear stress is proportional to the wall-normal gradient of the tangential velocity component.\n- The definition of friction velocity as a scale derived from the wall shear and the density.\n\nDerive the expression for the ghost-cell tangential velocity value $u_G$ such that applying linear interpolation between $P$ and $G$ reproduces the wall value $u_f = U_w$ at the face. Then, using a consistent face-normal velocity gradient approximation at the wall, compute the wall shear stress $\\tau_w$ and the friction velocity $u_\\tau$.\n\nYour program must:\n- Implement the derived expression for $u_G$ that enforces the Dirichlet wall condition at the face by linear interpolation.\n- Use the resulting discretely consistent wall-normal velocity gradient at the face to compute the wall shear stress $\\tau_w$ via Newton’s law of viscosity.\n- Compute the friction velocity $u_\\tau$ based on $\\tau_w$ and $\\rho$.\n\nUnits and numerical requirements:\n- Distances $d_P$ and $d_G$ must be provided and used in $\\mathrm{m}$.\n- Velocities $u_P$ and $U_w$ must be provided and used in $\\mathrm{m/s}$.\n- Dynamic viscosity $\\mu$ must be provided and used in $\\mathrm{Pa \\cdot s}$.\n- Density $\\rho$ must be provided and used in $\\mathrm{kg/m^3}$.\n- Wall shear $\\tau_w$ must be reported in $\\mathrm{Pa}$.\n- Friction velocity $u_\\tau$ must be reported in $\\mathrm{m/s}$.\n- Round each numerical output to exactly $6$ decimal places.\n\nTest suite:\n- Case $1$: $d_P = 0.01 \\ \\mathrm{m}$, $d_G = 0.01 \\ \\mathrm{m}$, $u_P = 0.5 \\ \\mathrm{m/s}$, $U_w = 0.0 \\ \\mathrm{m/s}$, $\\mu = 0.001 \\ \\mathrm{Pa \\cdot s}$, $\\rho = 1000.0 \\ \\mathrm{kg/m^3}$.\n- Case $2$: $d_P = 0.01 \\ \\mathrm{m}$, $d_G = 0.01 \\ \\mathrm{m}$, $u_P = 0.0 \\ \\mathrm{m/s}$, $U_w = 1.0 \\ \\mathrm{m/s}$, $\\mu = 0.001 \\ \\mathrm{Pa \\cdot s}$, $\\rho = 1000.0 \\ \\mathrm{kg/m^3}$.\n- Case $3$: $d_P = 0.005 \\ \\mathrm{m}$, $d_G = 0.015 \\ \\mathrm{m}$, $u_P = 0.2 \\ \\mathrm{m/s}$, $U_w = 0.8 \\ \\mathrm{m/s}$, $\\mu = 1.8 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$, $\\rho = 1.225 \\ \\mathrm{kg/m^3}$.\n- Case $4$: $d_P = 0.02 \\ \\mathrm{m}$, $d_G = 0.03 \\ \\mathrm{m}$, $u_P = 0.75 \\ \\mathrm{m/s}$, $U_w = 0.75 \\ \\mathrm{m/s}$, $\\mu = 0.002 \\ \\mathrm{Pa \\cdot s}$, $\\rho = 900.0 \\ \\mathrm{kg/m^3}$.\n- Case $5$: $d_P = 1.0 \\times 10^{-6} \\ \\mathrm{m}$, $d_G = 1.0 \\times 10^{-6} \\ \\mathrm{m}$, $u_P = 0.1 \\ \\mathrm{m/s}$, $U_w = 0.0 \\ \\mathrm{m/s}$, $\\mu = 1.0 \\ \\mathrm{Pa \\cdot s}$, $\\rho = 1.0 \\ \\mathrm{kg/m^3}$.\n\nFor each case, compute and output the triple $[u_G, \\tau_w, u_\\tau]$ using the derived expressions and the provided parameters. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case is a sub-list in order. For example, the output format must be:\n\"[[u_G1,tau_w1,u_tau1],[u_G2,tau_w2,u_tau2],...]\" with every number rounded to $6$ decimal places.",
            "solution": "The problem requires the derivation of expressions for the ghost-cell tangential velocity $u_G$, the wall shear stress $\\tau_w$, and the friction velocity $u_\\tau$ for a Dirichlet no-slip wall boundary condition in a one-dimensional finite-volume framework. The derivation must proceed from the foundational principles specified.\n\nLet the wall face $f$ be located at the position $n=0$ along the wall-normal coordinate. The interior fluid cell center, $P$, is at $n_P = -d_P$, and the exterior ghost-cell center, $G$, is at $n_G = d_G$. The corresponding tangential velocities at these points are $u_P$ and $u_G$, respectively. The specified tangential velocity at the wall is $U_w$.\n\n**1. Derivation of the Ghost-Cell Velocity, $u_G$**\n\nThe first principle is the use of linear interpolation for the scalar velocity field $u$ between the neighboring cell centers $P$ and $G$. The velocity $u(n)$ at a position $n$ between $n_P = -d_P$ and $n_G = d_G$ is given by a weighted average of the values $u_P$ and $u_G$:\n$$u(n) = \\frac{(n_G - n)u_P + (n - n_P)u_G}{n_G - n_P}$$\nSubstituting the positions $n_P = -d_P$ and $n_G = d_G$:\n$$u(n) = \\frac{(d_G - n)u_P + (n - (-d_P))u_G}{d_G - (-d_P)} = \\frac{(d_G - n)u_P + (n + d_P)u_G}{d_G + d_P}$$\nWe enforce the Dirichlet boundary condition at the wall face $f$, where $n=0$ and the velocity is specified as $u_f = U_w$. Setting $n=0$ in the interpolation formula yields the velocity at the face:\n$$u_f = u(0) = \\frac{(d_G - 0)u_P + (0 + d_P)u_G}{d_G + d_P} = \\frac{d_G u_P + d_P u_G}{d_G + d_P}$$\nBy imposing the condition $u_f = U_w$, we can solve for the required ghost-cell value $u_G$:\n$$U_w = \\frac{d_G u_P + d_P u_G}{d_G + d_P}$$\n$$U_w (d_G + d_P) = d_G u_P + d_P u_G$$\n$$d_P u_G = U_w (d_G + d_P) - d_G u_P$$\n$$u_G = \\frac{U_w (d_G + d_P) - d_G u_P}{d_P}$$\nThis expression can be rewritten as:\n$$u_G = U_w \\left(1 + \\frac{d_G}{d_P}\\right) - u_P \\frac{d_G}{d_P}$$\nThis equation defines the value $u_G$ in the ghost cell such that linear interpolation between $P$ and $G$ correctly yields the specified velocity $U_w$ at the wall.\n\n**2. Derivation of the Wall Shear Stress, $\\tau_w$**\n\nThe second principle is Newton's law of viscosity, which relates the shear stress to the velocity gradient. For the tangential component, the wall shear stress $\\tau_w$ is given by:\n$$\\tau_w = \\mu \\left. \\frac{\\partial u}{\\partial n} \\right|_{n=0}$$\nwhere $\\mu$ is the dynamic viscosity and $\\left. \\frac{\\partial u}{\\partial n} \\right|_{n=0}$ is the velocity gradient normal to the wall, evaluated at the wall face.\n\nThe problem states that a consistent face-normal velocity gradient approximation must be used. Consistency requires that the gradient be calculated from the same linear velocity profile established in the previous step. The gradient of the linear function $u(n)$ is constant between $P$ and $G$:\n$$\\frac{du}{dn} = \\frac{d}{dn} \\left( \\frac{(d_G - n)u_P + (n + d_P)u_G}{d_G + d_P} \\right) = \\frac{-u_P + u_G}{d_G + d_P}$$\nThis central-difference approximation, centered at the midpoint between $P$ and $G$, is the gradient of the interpolant everywhere, including at the face $f$.\n$$\\left. \\frac{\\partial u}{\\partial n} \\right|_{n=0} = \\frac{u_G - u_P}{d_G + d_P}$$\nSubstituting this gradient into Newton's law of viscosity gives the expression for the wall shear stress:\n$$\\tau_w = \\mu \\left( \\frac{u_G - u_P}{d_G + d_P} \\right)$$\nThis expression correctly uses the ghost-cell value $u_G$ to compute the stress, ensuring consistency with the enforced Dirichlet condition.\n\n**3. Derivation of the Friction Velocity, $u_\\tau$**\n\nThe third principle is the definition of the friction velocity, $u_\\tau$. It is a velocity scale derived from the wall shear stress $\\tau_w$ and the fluid density $\\rho$. As a scale, it is a non-negative quantity, and its definition involves the magnitude of the wall shear stress:\n$$u_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}$$\nSubstituting the derived expression for $\\tau_w$:\n$$u_\\tau = \\sqrt{\\frac{\\left| \\mu \\left( \\frac{u_G - u_P}{d_G + d_P} \\right) \\right|}{\\rho}}$$\n\n**Summary of Final Formulae**\n\nThe computational procedure for each test case is as follows:\n1.  Calculate the ghost-cell velocity $u_G$ using the given parameters:\n    $$u_G = U_w \\left(1 + \\frac{d_G}{d_P}\\right) - u_P \\frac{d_G}{d_P}$$\n2.  Calculate the wall shear stress $\\tau_w$ using the computed $u_G$:\n    $$\\tau_w = \\mu \\left( \\frac{u_G - u_P}{d_G + d_P} \\right)$$\n3.  Calculate the friction velocity $u_\\tau$ from the computed $\\tau_w$:\n    $$u_\\tau = \\sqrt{\\frac{|\\tau_w|}{\\rho}}$$\n\nThese expressions will be implemented to solve for the values in the provided test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes ghost-cell velocity, wall shear stress, and friction velocity\n    for a series of test cases based on a 1D finite-volume wall boundary condition.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (d_P, d_G, u_P, U_w, mu, rho)\n    test_cases = [\n        (0.01, 0.01, 0.5, 0.0, 0.001, 1000.0),\n        (0.01, 0.01, 0.0, 1.0, 0.001, 1000.0),\n        (0.005, 0.015, 0.2, 0.8, 1.8e-5, 1.225),\n        (0.02, 0.03, 0.75, 0.75, 0.002, 900.0),\n        (1.0e-6, 1.0e-6, 0.1, 0.0, 1.0, 1.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        d_P, d_G, u_P, U_w, mu, rho = case\n\n        # 1. Derive the expression for the ghost-cell tangential velocity u_G\n        # u_G = U_w * (1 + d_G/d_P) - u_P * (d_G/d_P)\n        u_G = U_w * (1.0 + d_G / d_P) - u_P * (d_G / d_P)\n\n        # 2. Compute the wall shear stress tau_w\n        # tau_w = mu * (u_G - u_P) / (d_G + d_P)\n        # The velocity gradient is consistently determined from the linear profile\n        # between P and G.\n        grad_u_at_wall = (u_G - u_P) / (d_G + d_P)\n        tau_w = mu * grad_u_at_wall\n\n        # 3. Compute the friction velocity u_tau\n        # u_tau = sqrt(|tau_w| / rho)\n        if tau_w == 0.0:\n            u_tau = 0.0\n        else:\n            u_tau = np.sqrt(np.abs(tau_w) / rho)\n            \n        # Round each result to 6 decimal places.\n        # np.round is used as specified in execution environment.\n        # Python's format specifier with f-strings for '0-padding' and rounding.\n        # We process results into a list of correctly rounded numbers.\n        case_results = [\n            round(u_G, 6),\n            round(tau_w, 6),\n            round(u_tau, 6),\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as specified: \"[[r11,r12,r13],[r21,r22,r23],...]\"\n    # Using a list comprehension to build the string representation of each inner list.\n    inner_lists_str = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    # Joining the inner list strings with commas and enclosing in the outer brackets.\n    final_output = f\"[{','.join(inner_lists_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "For incompressible flows, enforcing the no-penetration condition at a wall is intrinsically linked to the pressure field. This exercise explores this coupling within the context of a projection method, one of the most common algorithms for solving the incompressible Navier-Stokes equations. You will derive the appropriate pressure boundary condition, implemented via a ghost-cell pressure, that ensures the final velocity field respects the impermeability of the wall, preventing any spurious mass flux through the boundary .",
            "id": "3389943",
            "problem": "Consider a two-dimensional incompressible Newtonian fluid of constant density $\\rho$ and dynamic viscosity $\\mu$ occupying the half-space $y \\geq 0$, bounded by a rigid, impermeable, planar wall located at $y=0$. The flow is computed using a standard projection method within the framework of Computational Fluid Dynamics (CFD), where intermediate velocities are advanced by all non-pressure terms, and then corrected by a pressure field to enforce incompressibility and boundary constraints.\n\nAssume a uniform, staggered Cartesian grid: the pressure $p$ is stored at cell centers, the wall-normal velocity $v$ (the $y$-component) is stored at $y$-faces, and the wall-tangential velocity $u$ (the $x$-component) is stored at $x$-faces. The first interior pressure cell center adjacent to the wall is located at $y=\\Delta y/2$, and a single ghost pressure cell center is located outside the fluid at $y=-\\Delta y/2$. The wall-normal velocity is defined at the wall face $y=0$. The projection step is\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\frac{\\Delta t}{\\rho}\\,\\nabla p^{n+1},\n$$\nwhere $\\boldsymbol{u}^{*}$ is the intermediate velocity obtained by advancing the momentum equation without the pressure gradient over a time step $\\Delta t$, and $\\boldsymbol{u}^{n+1}$ is the divergence-free corrected velocity. The wall is impermeable, so $v^{n+1}$ evaluated at the wall face must satisfy $v^{n+1}|_{y=0} = 0$. The wall admits tangential slip that is governed by the Newtonian viscous shear relation at the wall,\n$$\n\\tau_{w} = \\mu\\,\\frac{\\partial u_{t}}{\\partial n}\\bigg|_{y=0},\n$$\nwhere $u_{t}$ is the wall-tangential velocity and $\\partial/\\partial n$ denotes differentiation in the wall-normal direction. The friction velocity $u_{\\tau}$ is defined by $\\tau_{w} = \\rho\\,u_{\\tau}^{2}$, but you should not assume any special value for $u_{\\tau}$ or any particular slip length; the only requirement is that the discrete wall-normal momentum balance must not contaminate the tangential shear relation with spurious wall-normal mass flux.\n\nUsing second-order centered differencing for the wall-normal pressure gradient at $y=0$,\n$$\n\\frac{\\partial p}{\\partial n}\\bigg|_{y=0} \\approx \\frac{p_{I} - p_{g}}{\\Delta y},\n$$\nwhere $p_{I}$ is the pressure at the first interior cell center ($y=\\Delta y/2$) and $p_{g}$ is the ghost pressure at $y=-\\Delta y/2$, derive the analytical expression for $p_{g}$ in terms of $p_{I}$, $\\rho$, $\\Delta t$, $\\Delta y$, and the intermediate wall-normal velocity $v^{*}$ evaluated at the wall face ($y=0$), such that:\n- the projection enforces $v^{n+1}|_{y=0} = 0$ exactly (eliminating spurious wall-normal mass flux), and\n- the discrete wall-normal momentum balance at the wall is consistent with the tangential viscous shear relation $\\tau_{w} = \\mu\\,\\partial u_{t}/\\partial n$.\n\nYour final answer must be a single closed-form expression for $p_{g}$ written in terms of the specified quantities. No numerical evaluation is required. Do not introduce any additional modeling assumptions beyond those stated. Express your final answer symbolically with no units inside the expression.",
            "solution": "The problem asks for an analytical expression for a ghost-cell pressure, $p_g$, used to enforce a boundary condition for an incompressible flow simulation using a projection method. Before proceeding to a solution, the problem statement must be validated for self-consistency, scientific soundness, and clarity.\n\nThe problem is well-defined. It outlines a standard scenario in Computational Fluid Dynamics (CFD): the use of a projection method on a staggered grid to solve for incompressible flow next to a boundary. The concepts presented—staggered grid, projection method, intermediate velocity, pressure correction, and ghost cells—are fundamental to the field.\n\nThe derivation is guided by two stated conditions:\n$1$. The projection must enforce strict impermeability at the wall, meaning the corrected wall-normal velocity component must be zero: $v^{n+1}|_{y=0} = 0$.\n$2$. The discrete wall-normal momentum balance must be \"consistent with\" the tangential viscous shear relation.\n\nThe first condition is a precise mathematical constraint that is central to projection methods. It provides a direct path to determine the necessary wall-normal pressure gradient, which in turn defines the ghost-cell pressure.\n\nThe second condition requires careful interpretation. In the context of the Navier-Stokes equations, the wall-normal momentum balance at a stationary, impermeable wall relates the wall-normal pressure gradient to the curvature of the wall-normal velocity profile ($\\partial p/\\partial n = \\mu \\partial^2 v/\\partial n^2$). The tangential shear relation ($\\tau_w = \\mu \\partial u_t/\\partial n$) arises from the tangential momentum balance. These two relationships are physically distinct. However, the problem's phrasing, specifically the preamble that the scheme \"must not contaminate the tangential shear relation with spurious wall-normal mass flux,\" suggests that the second condition is a qualitative descriptor of a desirable outcome, rather than an independent mathematical constraint. Enforcing the first condition ($v^{n+1}|_{y=0}=0$) is precisely the mechanism to prevent such spurious mass flux. A correct treatment of the wall-normal velocity is a prerequisite for, and therefore \"consistent with,\" a physically correct computation of the entire flow field, including the tangential shear.\n\nThus, the problem is deemed valid and well-posed, with the understanding that the derivation for $p_g$ hinges on satisfying the first, quantitative constraint, which consequently ensures the second, qualitative condition is met.\n\nThe derivation proceeds as follows.\n\nThe projection step, which corrects the intermediate velocity field $\\boldsymbol{u}^{*}$ with the pressure gradient to yield the final, divergence-free velocity $\\boldsymbol{u}^{n+1}$, is given by:\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{*} - \\frac{\\Delta t}{\\rho}\\,\\nabla p^{n+1}\n$$\nHere, $\\Delta t$ is the time step and $\\rho$ is the fluid density. We are interested in the component of this vector equation normal to the wall. Let the wall-normal direction be $y$, and the corresponding velocity component be $v$. The equation for the wall-normal velocity component is:\n$$\nv^{n+1} = v^{*} - \\frac{\\Delta t}{\\rho}\\,\\frac{\\partial p^{n+1}}{\\partial y}\n$$\nThis equation must hold everywhere in the fluid domain, including at the boundary $y=0$. Evaluating the expression at the wall face, where the wall-normal velocity is defined on the staggered grid:\n$$\nv^{n+1}|_{y=0} = v^{*}|_{y=0} - \\frac{\\Delta t}{\\rho}\\,\\frac{\\partial p^{n+1}}{\\partial y}\\bigg|_{y=0}\n$$\nThe primary constraint is that the wall is impermeable, which must be satisfied by the final velocity field at time $n+1$. This is expressed as:\n$$\nv^{n+1}|_{y=0} = 0\n$$\nSubstituting this condition into the projection equation gives:\n$$\n0 = v^{*}|_{y=0} - \\frac{\\Delta t}{\\rho}\\,\\frac{\\partial p^{n+1}}{\\partial y}\\bigg|_{y=0}\n$$\nThis equation provides the necessary Neumann boundary condition for the pressure $p^{n+1}$ at the wall. We can solve for the wall-normal pressure gradient:\n$$\n\\frac{\\partial p^{n+1}}{\\partial y}\\bigg|_{y=0} = \\frac{\\rho}{\\Delta t}\\,v^{*}|_{y=0}\n$$\nThe problem specifies that this gradient is to be approximated using a second-order centered difference scheme involving the pressure at the first interior cell center, $p_{I}$ (located at $y=\\Delta y/2$), and the pressure at a ghost-cell center, $p_g$ (located at $y=-\\Delta y/2$). The stencil for this approximation is centered at the wall, $y=0$:\n$$\n\\frac{\\partial p}{\\partial n}\\bigg|_{y=0} \\equiv \\frac{\\partial p^{n+1}}{\\partial y}\\bigg|_{y=0} \\approx \\frac{p_{I} - p_{g}}{\\Delta y}\n$$\nBy equating the required physical pressure gradient with its discrete approximation, we establish a relationship that defines the ghost-cell pressure $p_g$:\n$$\n\\frac{p_{I} - p_{g}}{\\Delta y} = \\frac{\\rho}{\\Delta t}\\,v^{*}|_{y=0}\n$$\nFinally, we solve for $p_g$ to obtain the desired expression. Multiplying both sides by $\\Delta y$:\n$$\np_{I} - p_{g} = \\frac{\\rho \\Delta y}{\\Delta t}\\,v^{*}|_{y=0}\n$$\nRearranging the terms to isolate $p_g$:\n$$\np_{g} = p_{I} - \\frac{\\rho \\Delta y}{\\Delta t}\\,v^{*}|_{y=0}\n$$\nThis expression provides the value for the ghost-cell pressure $p_g$ in terms of the first interior cell pressure $p_I$, the fluid properties $\\rho$, the numerical parameters $\\Delta t$ and $\\Delta y$, and the intermediate wall-normal velocity $v^{*}$ evaluated at the wall face. By setting the ghost-cell pressure according to this formula, the subsequent solution of the pressure-Poisson equation and the velocity correction step will enforce the impermeability condition $v^{n+1}|_{y=0} = 0$ exactly at the discrete level.",
            "answer": "$$\n\\boxed{p_{I} - \\frac{\\rho \\Delta y}{\\Delta t} v^{*}|_{y=0}}\n$$"
        }
    ]
}