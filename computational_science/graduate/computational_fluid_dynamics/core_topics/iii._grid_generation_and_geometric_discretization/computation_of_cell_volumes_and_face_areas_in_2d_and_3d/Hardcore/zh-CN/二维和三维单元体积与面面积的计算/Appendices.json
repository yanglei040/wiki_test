{
    "hands_on_practices": [
        {
            "introduction": "在计算流体动力学（CFD）中，准确计算任意形状控制体的体积是保证离散格式守恒性的基石。然而，对于复杂的非凸多面体，直接计算体积颇具挑战。本练习  介绍了一种极为巧妙且通用的算法：通过引入一个任意的参考点，将多面体体积分解为一系列带符号的四面体体积之和。通过这个实践，你不仅将掌握一个稳健的体积计算方法，还将深化对散度定理等基本物理原理的理解，因为它揭示了曲面积分与体积分之间的深刻联系，而这正是CFD有限体积法的理论核心。",
            "id": "3303150",
            "problem": "您的任务是设计、论证并实现一个适用于计算流体动力学 (CFD) 的算法，用于计算一个一般非凸多面体的体积。该多面体的边界由一组具有一致朝向的有限平面三角面片表示。您必须从第一性原理出发，构建一种方法，将体积剖分为由一个固定参考点和每个有向面片所形成的带符号四面体，然后证明，只要曲面是封闭且不自交的，最终得到的总体积与参考点的选择无关。\n\n您必须使用的基本原理是：\n- 平面面片的有向面积矢量定义以及标量三重积恒等式，即对于向量 $\\mathbf{u}, \\mathbf{v}, \\mathbf{w} \\in \\mathbb{R}^{3}$，标量三重积满足 $\\det[\\mathbf{u},\\mathbf{v},\\mathbf{w}] = \\mathbf{u} \\cdot (\\mathbf{v} \\times \\mathbf{w})$。\n- 散度定理 (Gauss’s Theorem)，该定理指出，对于区域 $\\Omega \\subset \\mathbb{R}^{3}$ 上的一个足够光滑的向量场 $\\mathbf{F}$，其边界为 $\\partial \\Omega$，外向单位法向量为 $\\mathbf{n}$，则有 $\\displaystyle \\int_{\\Omega} \\nabla \\cdot \\mathbf{F}\\, dV = \\oint_{\\partial \\Omega} \\mathbf{F} \\cdot \\mathbf{n}\\, dS$。\n- 顶点为 $\\mathbf{p}_{0}, \\mathbf{p}_{1}, \\mathbf{p}_{2}, \\mathbf{p}_{3}$ 的四面体的有符号体积定义为 $V_{\\text{tet}} = \\frac{1}{6}\\det[\\mathbf{p}_{1}-\\mathbf{p}_{0}, \\mathbf{p}_{2}-\\mathbf{p}_{0}, \\mathbf{p}_{3}-\\mathbf{p}_{0}]$。\n\n您的算法设计必须：\n1. 使用一个固定的参考点 $\\mathbf{r} \\in \\mathbb{R}^{3}$（不一定位于多面体内部）来定义每个三角面片对总体积的有符号贡献。每个具有有序顶点 $(\\mathbf{a},\\mathbf{b},\\mathbf{c})$ 的三角形贡献一个由顶点 $(\\mathbf{r},\\mathbf{a},\\mathbf{b},\\mathbf{c})$ 构成的四面体的有符号体积。\n2. 汇总所有面的有符号贡献以获得总体积 $V(\\mathbf{r})$。\n3. 从第一性原理证明，如果曲面是封闭、不自交且具有一致朝向，则 $V(\\mathbf{r})$ 与参考点 $\\mathbf{r}$ 的选择无关。\n4. 解释为什么对于开放曲面，该独立性会失效，并提供一个具体例子。\n\n您必须将该算法实现为一个完整的、可运行的程序，该程序以立方米为单位生成体积。所有体积均以 $\\mathrm{m}^{3}$ 表示，并四舍五入到十位小数。本问题不涉及角度。程序必须是自包含的，且不得读取任何输入。\n\n测试套件描述和要求输出：\n实现该算法，并在以下四种情况下对其进行评估。对于每种情况，使用两个不同的参考点计算体积，并返回这两个体积值以及一个布尔值，该布尔值指示两个体积在数值容差范围内是否相等（相等判断使用绝对差小于 $10^{-10}$）。最终的程序输出必须是单行，其中包含一个用方括号括起来的逗号分隔列表，按顺序汇总所有案例的结果。\n\n- 案例1 (闭合、凸、理想情况)：单位立方体，由 $xy$ 平面中顶点为 $\\{(0,0),(1,0),(1,1),(0,1)\\}$ 的正方形多边形沿 $z$ 轴方向从 $z=0$ 拉伸到 $z=1$ 得到。使用 $\\mathbf{r}_{1}=(0.2,0.3,0.4)$ 和 $\\mathbf{r}_{2}=(-1,-1,-1)$。真实体积为 $1.0\\,\\mathrm{m}^{3}$。\n\n- 案例2 (闭合、凸的四面体)：顶点为 $\\mathbf{v}_{0}=(0,0,0)$、$\\mathbf{v}_{1}=(1,0,0)$、$\\mathbf{v}_{2}=(0,1,0)$、$\\mathbf{v}_{3}=(0,0,1)$ 的四面体，其三角面片构成一个闭合的外向曲面。使用 $\\mathbf{r}_{1}=(0,0,0)$ 和 $\\mathbf{r}_{2}=(5,5,5)$。真实体积为 $\\frac{1}{6}\\,\\mathrm{m}^{3}$。\n\n- 案例3 (闭合、非凸)：将 $xy$ 平面中由有序顶点 $\\{(0,0),(2,0),(2,1),(1,1),(1,2),(0,2)\\}$ 给出的凹形“L形”多边形从 $z=0$ 拉伸到 $z=1$。底面积为 $3$，因此真实体积为 $3.0\\,\\mathrm{m}^{3}$。使用 $\\mathbf{r}_{1}=(0.5,0.5,0.5)$ 和 $\\mathbf{r}_{2}=(10,-1,0)$。\n\n- 案例4 (开放曲面，边界情况)：位于平面 $z=0$ 上的单个方形面片，顶点为 $\\{(0,0,0),(1,0,0),(1,1,0),(0,1,0)\\}$，并被三角化为两个三角形。使用 $\\mathbf{r}_{1}=(0,0,1)$ 和 $\\mathbf{r}_{2}=(0,0,-1)$。该曲面是开放的；预计独立性会失效。\n\n对于每个案例，您的程序应输出三个值：以 $\\mathrm{m}^{3}$ 为单位的第一个体积（四舍五入到十位小数），以 $\\mathrm{m}^{3}$ 为单位的第二个体积（四舍五入到十位小数），以及一个指示体积是否在容差范围内一致的布尔值。最终输出格式必须是单行，包含所有案例结果串联而成的逗号分隔列表，并用方括号括起来；即 $[\\text{V1\\_case1},\\text{V2\\_case1},\\text{agree\\_case1},\\text{V1\\_case2},\\dots]$。",
            "solution": "该问题要求设计、论证并实现一个算法，用以计算由一组具有一致朝向的三角面片所定义的一般多面体的体积。该算法基于将多面体的体积分解为一系列由每个面片的顶点和一个公共的、任意的参考点所形成的带符号四面体体积之和。任务的核心是证明，对于一个封闭且不自交的曲面，最终得到的总体积与该参考点的选择无关。\n\n### 算法设计\n\n设多面体的体积为 $\\Omega \\subset \\mathbb{R}^3$，其边界曲面为 $\\partial \\Omega$。该边界是一个由 $N$ 个三角面片 $\\{f_1, f_2, \\ldots, f_N\\}$ 组成的网格。每个面片 $f_i$ 由一个有序的顶点三元组 $(\\mathbf{a}_i, \\mathbf{b}_i, \\mathbf{c}_i)$ 定义。所有面片的顶点排序是一致的，这意味着由叉积（如 $(\\mathbf{b}_i - \\mathbf{a}_i) \\times (\\mathbf{c}_i - \\mathbf{a}_i)$）导出的法向量总是指向体积的内部或外部。按照惯例，我们假设法线朝向外部。\n\n1.  **参考点的选择**：我们选择一个任意的参考点 $\\mathbf{r} \\in \\mathbb{R}^3$。该点可以位于空间中的任何位置，包括多面体的内部、外部或边界上。\n\n2.  **基于面片的四面体的有符号体积**：对于每个具有顶点 $(\\mathbf{a}_i, \\mathbf{b}_i, \\mathbf{c}_i)$ 的三角面片 $f_i$，我们构建一个由顶点 $(\\mathbf{r}, \\mathbf{a}_i, \\mathbf{b}_i, \\mathbf{c}_i)$ 构成的四面体。该四面体的有符号体积 $V_i$ 由标量三重积给出：\n    $$ V_i(\\mathbf{r}) = \\frac{1}{6} \\det\\begin{bmatrix} \\mathbf{a}_i - \\mathbf{r}  \\mathbf{b}_i - \\mathbf{r}  \\mathbf{c}_i - \\mathbf{r} \\end{bmatrix} $$\n    其中向量被视为矩阵的列。这等价于：\n    $$ V_i(\\mathbf{r}) = \\frac{1}{6} (\\mathbf{a}_i - \\mathbf{r}) \\cdot \\left( (\\mathbf{b}_i - \\mathbf{r}) \\times (\\mathbf{c}_i - \\mathbf{r}) \\right) $$\n    $V_i$ 的符号取决于面片顶点 $(\\mathbf{a}_i, \\mathbf{b}_i, \\mathbf{c}_i)$ 相对于参考点 $\\mathbf{r}$ 的朝向。\n\n3.  **有符号体积的汇总**：多面体的总体积 $V(\\mathbf{r})$ 通过对所有此类四面体的有符号体积求和来计算：\n    $$ V(\\mathbf{r}) = \\sum_{i=1}^{N} V_i(\\mathbf{r}) = \\sum_{i=1}^{N} \\frac{1}{6} \\det\\begin{bmatrix} \\mathbf{a}_i - \\mathbf{r}  \\mathbf{b}_i - \\mathbf{r}  \\mathbf{c}_i - \\mathbf{r} \\end{bmatrix} $$\n    如果曲面法线（由顶点顺序决定）指向外部，那么对于那些参考点 $\\mathbf{r}$ 位于面片“内”侧的四面体，其将贡献正体积；而对于那些参考点 $\\mathbf{r}$ 位于“外”侧的四面体，其将贡献负体积。对于凸多面体和内部参考点，所有贡献均为正。对于非凸形状或外部参考点，会发生正负抵消，但最终总和仍能正确得出净体积。\n\n### 与参考点 $\\mathbf{r}$ 无关的证明\n\n为证明计算出的体积 $V(\\mathbf{r})$ 对于封闭曲面与 $\\mathbf{r}$ 的选择无关，我们必须证明 $V(\\mathbf{r})$ 相对于 $\\mathbf{r}$ 的梯度是零向量，即 $\\nabla_{\\mathbf{r}} V(\\mathbf{r}) = \\mathbf{0}$。\n\n我们来计算单个面片 $f_i$ 贡献的梯度：\n$$ \\nabla_{\\mathbf{r}} V_i(\\mathbf{r}) = \\frac{1}{6} \\nabla_{\\mathbf{r}} \\det\\begin{bmatrix} \\mathbf{a}_i - \\mathbf{r}  \\mathbf{b}_i - \\mathbf{r}  \\mathbf{c}_i - \\mathbf{r} \\end{bmatrix} $$\n使用行列式求导的链式法则（Jacobi's formula），并注意到 $\\nabla_{\\mathbf{r}} (\\mathbf{k} - \\mathbf{r}) = -\\mathbf{I}$（其中 $\\mathbf{k}$ 是一个常数向量，$\\mathbf{I}$ 是单位张量），可以计算行列式对其向量参数的梯度。一个更直接的方法是计算其关于 $\\mathbf{r}$ 的一个分量（例如 $r_k$）的偏导数。\n$$ \\frac{\\partial}{\\partial r_k} \\det[\\mathbf{u}_1, \\mathbf{u}_2, \\mathbf{u}_3] = \\det\\left[\\frac{\\partial \\mathbf{u}_1}{\\partial r_k}, \\mathbf{u}_2, \\mathbf{u}_3\\right] + \\det\\left[\\mathbf{u}_1, \\frac{\\partial \\mathbf{u}_2}{\\partial r_k}, \\mathbf{u}_3\\right] + \\det\\left[\\mathbf{u}_1, \\mathbf{u}_2, \\frac{\\partial \\mathbf{u}_3}{\\partial r_k}\\right] $$\n这里，$\\mathbf{u}_1 = \\mathbf{a}_i - \\mathbf{r}$，$\\mathbf{u}_2 = \\mathbf{b}_i - \\mathbf{r}$，$\\mathbf{u}_3 = \\mathbf{c}_i - \\mathbf{r}$。偏导数 $\\frac{\\partial \\mathbf{u}_j}{\\partial r_k}$ 是向量 $-\\mathbf{e}_k$，其中 $\\mathbf{e}_k$ 是第 $k$ 个坐标的标准基向量。\n因此，梯度的第 $k$ 个分量是：\n$$ \\frac{\\partial V_i}{\\partial r_k} = \\frac{1}{6} \\left( \\det[-\\mathbf{e}_k, \\mathbf{u}_2, \\mathbf{u}_3] + \\det[\\mathbf{u}_1, -\\mathbf{e}_k, \\mathbf{u}_3] + \\det[\\mathbf{u}_1, \\mathbf{u}_2, -\\mathbf{e}_k] \\right) $$\n使用标量三重积恒等式，上式变为：\n$$ \\frac{\\partial V_i}{\\partial r_k} = \\frac{1}{6} \\left( -\\mathbf{e}_k \\cdot (\\mathbf{u}_2 \\times \\mathbf{u}_3) - \\mathbf{e}_k \\cdot (\\mathbf{u}_3 \\times \\mathbf{u}_1) - \\mathbf{e}_k \\cdot (\\mathbf{u}_1 \\times \\mathbf{u}_2) \\right) $$\n因为这对每个分量 $k$ 都成立，我们可以写出完整的梯度向量：\n$$ \\nabla_{\\mathbf{r}} V_i(\\mathbf{r}) = -\\frac{1}{6} \\left( (\\mathbf{u}_2 \\times \\mathbf{u}_3) + (\\mathbf{u}_3 \\times \\mathbf{u}_1) + (\\mathbf{u}_1 \\times \\mathbf{u}_2) \\right) $$\n将 $\\mathbf{u}_1, \\mathbf{u}_2, \\mathbf{u}_3$ 代回：\n$$ \\nabla_{\\mathbf{r}} V_i(\\mathbf{r}) = -\\frac{1}{6} \\left( ((\\mathbf{b}_i - \\mathbf{r}) \\times (\\mathbf{c}_i - \\mathbf{r})) + ((\\mathbf{c}_i - \\mathbf{r}) \\times (\\mathbf{a}_i - \\mathbf{r})) + ((\\mathbf{a}_i - \\mathbf{r}) \\times (\\mathbf{b}_i - \\mathbf{r})) \\right) $$\n括号内的叉积之和可以使用恒等式 $(\\mathbf{v}-\\mathbf{u})\\times(\\mathbf{w}-\\mathbf{u}) = \\mathbf{v}\\times\\mathbf{w} + \\mathbf{w}\\times\\mathbf{u} + \\mathbf{u}\\times\\mathbf{v}$ 进行简化。令 $\\mathbf{u}=\\mathbf{r}$，$\\mathbf{v}=\\mathbf{c}_i$，$\\mathbf{w}=\\mathbf{b}_i$ 并对各项进行置换，我们发现该和等价于 $(\\mathbf{b}_i - \\mathbf{a}_i) \\times (\\mathbf{c}_i - \\mathbf{a}_i)$。\n因此：\n$$ \\nabla_{\\mathbf{r}} V_i(\\mathbf{r}) = -\\frac{1}{6} ((\\mathbf{b}_i - \\mathbf{a}_i) \\times (\\mathbf{c}_i - \\mathbf{a}_i)) $$\n项 $\\frac{1}{2} (\\mathbf{b}_i - \\mathbf{a}_i) \\times (\\mathbf{c}_i - \\mathbf{a}_i)$ 是三角面片 $f_i$ 的矢量面积 $\\mathbf{S}_i$。因此：\n$$ \\nabla_{\\mathbf{r}} V_i(\\mathbf{r}) = -\\frac{1}{3} \\mathbf{S}_i $$\n总体积的梯度是每个面片梯度的总和：\n$$ \\nabla_{\\mathbf{r}} V(\\mathbf{r}) = \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}} V_i(\\mathbf{r}) = -\\frac{1}{3} \\sum_{i=1}^{N} \\mathbf{S}_i $$\n对于任何封闭曲面 $\\partial\\Omega$（即一个包围体积且没有任何孔洞的曲面），其所有面片的矢量面积之和为零向量：$\\sum_{i=1}^{N} \\mathbf{S}_i = \\oint_{\\partial\\Omega} d\\mathbf{S} = \\mathbf{0}$。这是将散度定理应用于恒定向量场的一个推论。\n因此，对于封闭曲面：\n$$ \\nabla_{\\mathbf{r}} V(\\mathbf{r}) = \\mathbf{0} $$\n这证明了计算出的体积 $V(\\mathbf{r})$ 不随参考点 $\\mathbf{r}$ 的位置而改变，从而确立了该算法的鲁棒性。\n\n### 开放曲面独立性失效的情况\n\n该独立性证明的关键在于一个属性：闭合曲面上所有面片面积矢量的总和为零。如果曲面是开放的，此条件不满足。开放曲面的面积矢量之和通常不为零。\n$$ \\nabla_{\\mathbf{r}} V(\\mathbf{r}) = -\\frac{1}{3} \\sum_{i \\in \\text{open surface}} \\mathbf{S}_i \\neq \\mathbf{0} $$\n这个非零梯度意味着计算出的“体积” $V(\\mathbf{r})$ 取决于参考点 $\\mathbf{r}$ 的选择。\n\n**具体例子 (案例4)：**\n考虑一个位于 $z=0$ 平面上的方形面片，由顶点 $\\{(0,0,0),(1,0,0),(1,1,0),(0,1,0)\\}$ 定义。将其三角化为两个具有向上朝向（法线沿 $+z$ 方向）的三角形：\n$f_1$ 的顶点为 $(\\mathbf{a}_1, \\mathbf{b}_1, \\mathbf{c}_1) = ((0,0,0), (1,0,0), (1,1,0))$。\n$f_2$ 的顶点为 $(\\mathbf{a}_2, \\mathbf{b}_2, \\mathbf{c}_2) = ((0,0,0), (1,1,0), (0,1,0))$。\n\n面积矢量为：\n$\\mathbf{S}_1 = \\frac{1}{2}(\\mathbf{b}_1 - \\mathbf{a}_1) \\times (\\mathbf{c}_1 - \\mathbf{a}_1) = \\frac{1}{2}(1,0,0) \\times (1,1,0) = \\frac{1}{2}(0,0,1)$。\n$\\mathbf{S}_2 = \\frac{1}{2}(\\mathbf{b}_2 - \\mathbf{a}_2) \\times (\\mathbf{c}_2 - \\mathbf{a}_2) = \\frac{1}{2}(1,1,0) \\times (0,1,0) = \\frac{1}{2}(0,0,1)$。\n\n面积矢量的和为 $\\sum \\mathbf{S}_i = \\mathbf{S}_1 + \\mathbf{S}_2 = (0,0,1)$。\n计算出的“体积”的梯度为 $\\nabla_{\\mathbf{r}} V(\\mathbf{r}) = -\\frac{1}{3}(0,0,1)$。这表明该值会随着 $\\mathbf{r}$ 的 $z$ 坐标的变化而改变。\n我们来计算该曲面的 $V(\\mathbf{r})$。请注意，对于任何位于 $xy$ 平面上的面，$\\det[\\mathbf{a}_i,\\mathbf{b}_i,\\mathbf{c}_i]=0$。\n我们使用展开式 $V_i(\\mathbf{r}) = \\frac{1}{6} (\\det[\\mathbf{a}_i,\\mathbf{b}_i,\\mathbf{c}_i] - \\mathbf{r}\\cdot(2\\mathbf{S}_i))$。\n所以，$V(\\mathbf{r}) = \\sum_i \\frac{1}{6} (0 - \\mathbf{r}\\cdot(2\\mathbf{S}_i)) = -\\frac{1}{3} \\mathbf{r} \\cdot \\sum_i \\mathbf{S}_i$。\n$V(\\mathbf{r}) = -\\frac{1}{3} (r_x, r_y, r_z) \\cdot (0,0,1) = -\\frac{r_z}{3}$。\n对于案例4中指定的两个参考点：\n- $\\mathbf{r}_1 = (0,0,1)$: $V(\\mathbf{r}_1) = -1/3$。\n- $\\mathbf{r}_2 = (0,0,-1)$: $V(\\mathbf{r}_2) = -(-1)/3 = 1/3$。\n计算出的值不同，证实了对于开放曲面，独立性属性会失效。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the polyhedron volume problem for all test cases.\n    \"\"\"\n\n    def compute_volume(faces, ref_point):\n        \"\"\"\n        Computes the volume of a polyhedron defined by triangular faces.\n\n        Args:\n            faces (list of tuples): A list of triangular faces. Each face is a \n                                    tuple of 3 vertices, and each vertex is a \n                                    numpy array of shape (3,).\n            ref_point (numpy.ndarray): The reference point as a numpy array of \n                                       shape (3,).\n\n        Returns:\n            float: The computed volume of the polyhedron.\n        \"\"\"\n        total_volume = 0.0\n        r = np.array(ref_point, dtype=np.float64)\n\n        for face in faces:\n            p1 = np.array(face[0], dtype=np.float64)\n            p2 = np.array(face[1], dtype=np.float64)\n            p3 = np.array(face[2], dtype=np.float64)\n            \n            # Form the matrix with columns (p1-r), (p2-r), (p3-r)\n            mat = np.array([p1 - r, p2 - r, p3 - r]).T\n            \n            # The signed volume of the tetrahedron is (1/6) * det(mat)\n            total_volume += np.linalg.det(mat)\n        \n        return total_volume / 6.0\n\n    # Test Case 1: Unit cube\n    v = [\n        (0.0, 0.0, 0.0), (1.0, 0.0, 0.0), (1.0, 1.0, 0.0), (0.0, 1.0, 0.0),\n        (0.0, 0.0, 1.0), (1.0, 0.0, 1.0), (1.0, 1.0, 1.0), (0.0, 1.0, 1.0)\n    ]\n    # Faces with outward pointing normals\n    case1_faces = [\n        # Bottom face (z=0, normal -k)\n        (v[0], v[2], v[1]), (v[0], v[3], v[2]),\n        # Top face (z=1, normal +k)\n        (v[4], v[5], v[6]), (v[4], v[6], v[7]),\n        # Front face (y=0, normal -j)\n        (v[0], v[1], v[5]), (v[0], v[5], v[4]),\n        # Back face (y=1, normal +j)\n        (v[3], v[6], v[2]), (v[3], v[7], v[6]),\n        # Left face (x=0, normal -i)\n        (v[0], v[4], v[7]), (v[0], v[7], v[3]),\n        # Right face (x=1, normal +i)\n        (v[1], v[2], v[6]), (v[1], v[6], v[5])\n    ]\n    r1_case1 = (0.2, 0.3, 0.4)\n    r2_case1 = (-1.0, -1.0, -1.0)\n\n    # Test Case 2: Tetrahedron\n    v_tet = [\n        (0.0, 0.0, 0.0), (1.0, 0.0, 0.0), (0.0, 1.0, 0.0), (0.0, 0.0, 1.0)\n    ]\n    # Faces with outward pointing normals\n    case2_faces = [\n        (v_tet[0], v_tet[2], v_tet[1]), # Bottom face, normal -k\n        (v_tet[0], v_tet[1], v_tet[3]), # Side face, normal -j\n        (v_tet[0], v_tet[3], v_tet[2]), # Side face, normal -i\n        (v_tet[1], v_tet[2], v_tet[3]), # Slanted top face\n    ]\n    r1_case2 = (0.0, 0.0, 0.0)\n    r2_case2 = (5.0, 5.0, 5.0)\n\n    # Test Case 3: L-shaped prism\n    p_base = [\n        (0.0, 0.0), (2.0, 0.0), (2.0, 1.0), (1.0, 1.0), (1.0, 2.0), (0.0, 2.0)\n    ]\n    v_lshape_bottom = [(x, y, 0.0) for x, y in p_base]\n    v_lshape_top = [(x, y, 1.0) for x, y in p_base]\n    \n    # Triangulation of L-shape base polygon using a fan from v0=(0,0,0)\n    case3_faces = [\n        # Bottom face (z=0, normal -k, CW)\n        (v_lshape_bottom[0], v_lshape_bottom[2], v_lshape_bottom[1]),\n        (v_lshape_bottom[0], v_lshape_bottom[3], v_lshape_bottom[2]),\n        (v_lshape_bottom[0], v_lshape_bottom[4], v_lshape_bottom[3]),\n        (v_lshape_bottom[0], v_lshape_bottom[5], v_lshape_bottom[4]),\n        # Top face (z=1, normal +k, CCW)\n        (v_lshape_top[0], v_lshape_top[1], v_lshape_top[2]),\n        (v_lshape_top[0], v_lshape_top[2], v_lshape_top[3]),\n        (v_lshape_top[0], v_lshape_top[3], v_lshape_top[4]),\n        (v_lshape_top[0], v_lshape_top[4], v_lshape_top[5]),\n    ]\n    # Side faces (6 rectangles - 12 triangles)\n    for i in range(6):\n        p_curr_b = v_lshape_bottom[i]\n        p_next_b = v_lshape_bottom[(i + 1) % 6]\n        p_curr_t = v_lshape_top[i]\n        p_next_t = v_lshape_top[(i + 1) % 6]\n        \n        # CCW from outside gives outward normal\n        case3_faces.append((p_curr_b, p_next_b, p_next_t))\n        case3_faces.append((p_curr_b, p_next_t, p_curr_t))\n        \n    r1_case3 = (0.5, 0.5, 0.5)\n    r2_case3 = (10.0, -1.0, 0.0)\n\n    # Test Case 4: Open square patch\n    v_sq = [(0,0,0), (1,0,0), (1,1,0), (0,1,0)]\n    # Upward normal (+k)\n    case4_faces = [\n        (v_sq[0], v_sq[1], v_sq[2]),\n        (v_sq[0], v_sq[2], v_sq[3])\n    ]\n    r1_case4 = (0.0, 0.0, 1.0)\n    r2_case4 = (0.0, 0.0, -1.0)\n\n    test_cases = [\n        (case1_faces, r1_case1, r2_case1),\n        (case2_faces, r1_case2, r2_case2),\n        (case3_faces, r1_case3, r2_case3),\n        (case4_faces, r1_case4, r2_case4)\n    ]\n    \n    results = []\n    tolerance = 1e-10\n\n    for faces, r1, r2 in test_cases:\n        v1 = compute_volume(faces, r1)\n        v2 = compute_volume(faces, r2)\n        \n        v1_rounded = round(v1, 10)\n        v2_rounded = round(v2, 10)\n        \n        # Format -0.0 as 0.0\n        if v1_rounded == -0.0: v1_rounded = 0.0\n        if v2_rounded == -0.0: v2_rounded = 0.0\n\n        agree = abs(v1 - v2)  tolerance\n        \n        results.extend([f\"{v1_rounded:.10f}\", f\"{v2_rounded:.10f}\", str(agree)])\n\n    # Format the final string as required\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "虽然通用算法功能强大，但在实际的CFD应用中，我们常常使用结构化或半结构化网格，其中包含如六面体等特定类型的单元。对于这些单元，人们常常采用简化的代数公式来计算面面积等几何量。本练习  旨在引导你严格地将一种常用的代数近似方法与精确的几何定义进行对比，从而揭示那些看似合理的“捷径”可能引入的系统性偏差。",
            "id": "3303160",
            "problem": "在计算流体动力学 (CFD) 中，通用六面体单元的面面积通常通过参数化曲面积分精确计算，或通过基于顶点位置的代数公式近似计算。考虑一个三线性六面体单元，其顶面位于平面 $z=0$ 上，且顶点为\n$$\n\\mathbf{r}_{--}=(0,0,0),\\quad \\mathbf{r}_{+-}=(L,0,0),\\quad \\mathbf{r}_{++}=(L+\\alpha,H,0),\\quad \\mathbf{r}_{-+}=(\\alpha,H,0),\n$$\n其中 $L0$，$H0$ 且 $\\alpha\\neq 0$。该面是一个斜平面平行四边形，并由标准的双线性曲面映射表示\n$$\n\\mathbf{x}(\\xi,\\eta)=\\sum_{i,j\\in\\{-1,+1\\}} \\mathbf{r}_{ij}\\,N_{ij}(\\xi,\\eta),\\quad N_{ij}(\\xi,\\eta)=\\frac{1}{4}(1+i\\xi)(1+j\\eta),\\quad (\\xi,\\eta)\\in[-1,1]^2,\n$$\n这是三线性六面体等参映射在该面上的限制。\n\n现有两种面面积的计算方法将被进行比较：\n- 由参数化曲面积分基本定义的精确面积 $A_{\\mathrm{exact}}$\n$$\nA_{\\mathrm{exact}}=\\int_{-1}^{1}\\int_{-1}^{1} \\left\\|\\frac{\\partial\\mathbf{x}}{\\partial \\xi}(\\xi,\\eta)\\times \\frac{\\partial\\mathbf{x}}{\\partial \\eta}(\\xi,\\eta)\\right\\|\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta.\n$$\n- 中边对角线叉积近似法\n$$\nA_{\\mathrm{diag}}=\\frac{1}{2}\\left\\|\\mathbf{d}_1\\times \\mathbf{d}_2\\right\\|,\n$$\n其中 $\\mathbf{d}_1$ 是连接边 $\\mathbf{r}_{--}\\text{ 到 }\\mathbf{r}_{+-}$ 的中点与边 $\\mathbf{r}_{-+}\\text{ 到 }\\mathbf{r}_{++}$ 的中点的向量，而 $\\mathbf{d}_2$ 是连接边 $\\mathbf{r}_{+-}\\text{ 到 }\\mathbf{r}_{++}$ 的中点与边 $\\mathbf{r}_{--}\\text{ 到 }\\mathbf{r}_{-+}$ 的中点的向量。\n\n仅从上述定义以及参数化曲面的基本微分几何恒等式出发，计算此面的相对偏差\n$$\nB=\\frac{A_{\\mathrm{diag}}}{A_{\\mathrm{exact}}}-1\n$$\n并将其表示为一个精确的数值。无需四舍五入。最终答案必须是一个不带单位的实数。",
            "solution": "题目要求计算一个六面体单元的特定平面四边形面的相对偏差 $B = \\frac{A_{\\mathrm{diag}}}{A_{\\mathrm{exact}}} - 1$。为此，我们必须首先使用给定的参数化曲面积分定义计算精确面积 $A_{\\mathrm{exact}}$，然后使用给定的代数公式计算近似面积 $A_{\\mathrm{diag}}$。\n\n首先，我们计算精确面积 $A_{\\mathrm{exact}}$。该曲面由双线性等参映射定义：\n$$\n\\mathbf{x}(\\xi,\\eta)=\\sum_{i,j\\in\\{-1,+1\\}} \\mathbf{r}_{ij}\\,N_{ij}(\\xi,\\eta) = \\frac{1}{4}\\sum_{i,j\\in\\{-1,+1\\}} \\mathbf{r}_{ij}(1+i\\xi)(1+j\\eta)\n$$\n其中 $(\\xi,\\eta) \\in [-1,1]^2$。顶点给定如下：\n$$\n\\mathbf{r}_{--}=(0,0,0),\\quad \\mathbf{r}_{+-}=(L,0,0),\\quad \\mathbf{r}_{++}=(L+\\alpha,H,0),\\quad \\mathbf{r}_{-+}=(\\alpha,H,0)\n$$\n其中 $L0$，$H0$ 且 $\\alpha\\neq 0$。\n\n我们展开 $\\mathbf{x}(\\xi,\\eta)$ 的表达式：\n$$\n\\mathbf{x}(\\xi,\\eta) = \\frac{1}{4} \\left[ \\mathbf{r}_{--}(1-\\xi)(1-\\eta) + \\mathbf{r}_{+-}(1+\\xi)(1-\\eta) + \\mathbf{r}_{++}(1+\\xi)(1+\\eta) + \\mathbf{r}_{-+}(1-\\xi)(1+\\eta) \\right]\n$$\n由于 $\\mathbf{r}_{--}=(0,0,0)$，第一项为零。\n为了计算面积分，我们需要求 $\\mathbf{x}(\\xi,\\eta)$ 关于 $\\xi$ 和 $\\eta$ 的偏导数。\n\n关于 $\\xi$ 的偏导数为：\n$$\n\\frac{\\partial\\mathbf{x}}{\\partial \\xi} = \\frac{1}{4} \\left[ -\\mathbf{r}_{--}(1-\\eta) + \\mathbf{r}_{+-}(1-\\eta) + \\mathbf{r}_{++}(1+\\eta) - \\mathbf{r}_{-+}(1+\\eta) \\right]\n$$\n$$\n\\frac{\\partial\\mathbf{x}}{\\partial \\xi} = \\frac{1}{4} \\left[ (\\mathbf{r}_{+-}-\\mathbf{r}_{--})(1-\\eta) + (\\mathbf{r}_{++}-\\mathbf{r}_{-+})(1+\\eta) \\right]\n$$\n让我们计算代表四边形边的向量：\n$$\n\\mathbf{r}_{+-}-\\mathbf{r}_{--} = (L,0,0)-(0,0,0) = (L,0,0)\n$$\n$$\n\\mathbf{r}_{++}-\\mathbf{r}_{-+} = (L+\\alpha,H,0)-(\\alpha,H,0) = (L,0,0)\n$$\n将这些代入 $\\frac{\\partial\\mathbf{x}}{\\partial \\xi}$ 的表达式中：\n$$\n\\frac{\\partial\\mathbf{x}}{\\partial \\xi} = \\frac{1}{4} \\left[ (L,0,0)(1-\\eta) + (L,0,0)(1+\\eta) \\right] = \\frac{1}{4} (L,0,0)(1-\\eta+1+\\eta) = \\frac{1}{4}(L,0,0)(2) = \\left(\\frac{L}{2}, 0, 0\\right)\n$$\n\n关于 $\\eta$ 的偏导数为：\n$$\n\\frac{\\partial\\mathbf{x}}{\\partial \\eta} = \\frac{1}{4} \\left[ -\\mathbf{r}_{--}(1-\\xi) - \\mathbf{r}_{+-}(1+\\xi) + \\mathbf{r}_{++}(1+\\xi) + \\mathbf{r}_{-+}(1-\\xi) \\right]\n$$\n$$\n\\frac{\\partial\\mathbf{x}}{\\partial \\eta} = \\frac{1}{4} \\left[ (\\mathbf{r}_{-+}-\\mathbf{r}_{--})(1-\\xi) + (\\mathbf{r}_{++}-\\mathbf{r}_{+-})(1+\\xi) \\right]\n$$\n让我们计算另一对边的向量：\n$$\n\\mathbf{r}_{-+}-\\mathbf{r}_{--} = (\\alpha,H,0)-(0,0,0) = (\\alpha,H,0)\n$$\n$$\n\\mathbf{r}_{++}-\\mathbf{r}_{+-} = (L+\\alpha,H,0)-(L,0,0) = (\\alpha,H,0)\n$$\n将这些代入 $\\frac{\\partial\\mathbf{x}}{\\partial \\eta}$ 的表达式中：\n$$\n\\frac{\\partial\\mathbf{x}}{\\partial \\eta} = \\frac{1}{4} \\left[ (\\alpha,H,0)(1-\\xi) + (\\alpha,H,0)(1+\\xi) \\right] = \\frac{1}{4} (\\alpha,H,0)(1-\\xi+1+\\xi) = \\frac{1}{4}(\\alpha,H,0)(2) = \\left(\\frac{\\alpha}{2}, \\frac{H}{2}, 0\\right)\n$$\n切向量是常数，这证实了该曲面是平面的。现在我们计算它们的叉积：\n$$\n\\frac{\\partial\\mathbf{x}}{\\partial \\xi} \\times \\frac{\\partial\\mathbf{x}}{\\partial \\eta} = \\left(\\frac{L}{2}, 0, 0\\right) \\times \\left(\\frac{\\alpha}{2}, \\frac{H}{2}, 0\\right) = \\begin{vmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ \\frac{L}{2}  0  0 \\\\ \\frac{\\alpha}{2}  \\frac{H}{2}  0 \\end{vmatrix} = \\left(0, 0, \\frac{L}{2}\\frac{H}{2} - 0\\right) = \\left(0, 0, \\frac{LH}{4}\\right)\n$$\n这个向量的模为：\n$$\n\\left\\|\\frac{\\partial\\mathbf{x}}{\\partial \\xi} \\times \\frac{\\partial\\mathbf{x}}{\\partial \\eta}\\right\\| = \\left|\\frac{LH}{4}\\right| = \\frac{LH}{4}\n$$\n因为 $L0$ 且 $H0$。被积函数是常数。\n精确面积 $A_{\\mathrm{exact}}$ 是在参数域上的积分：\n$$\nA_{\\mathrm{exact}} = \\int_{-1}^{1}\\int_{-1}^{1} \\frac{LH}{4}\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta = \\frac{LH}{4} \\int_{-1}^{1}\\mathrm{d}\\xi \\int_{-1}^{1}\\mathrm{d}\\eta = \\frac{LH}{4} \\cdot (2) \\cdot (2) = LH\n$$\n\n接下来，我们计算近似面积 $A_{\\mathrm{diag}}$。这需要计算向量 $\\mathbf{d}_1$ 和 $\\mathbf{d}_2$。\n$\\mathbf{d}_1$ 是连接边 $\\mathbf{r}_{--}$ 到 $\\mathbf{r}_{+-}$ 的中点与边 $\\mathbf{r}_{-+}$ 到 $\\mathbf{r}_{++}$ 的中点的向量。\n设 $M_1$ 为边 $(\\mathbf{r}_{--}, \\mathbf{r}_{+-})$ 的中点， $M_3$ 为边 $(\\mathbf{r}_{-+}, \\mathbf{r}_{++})$ 的中点。\n$$\nM_1 = \\frac{1}{2}(\\mathbf{r}_{--} + \\mathbf{r}_{+-}) = \\frac{1}{2}((0,0,0) + (L,0,0)) = \\left(\\frac{L}{2}, 0, 0\\right)\n$$\n$$\nM_3 = \\frac{1}{2}(\\mathbf{r}_{-+} + \\mathbf{r}_{++}) = \\frac{1}{2}((\\alpha,H,0) + (L+\\alpha,H,0)) = \\left(\\frac{L+2\\alpha}{2}, H, 0\\right)\n$$\n所以，$\\mathbf{d}_1 = M_3 - M_1$：\n$$\n\\mathbf{d}_1 = \\left(\\frac{L+2\\alpha}{2}, H, 0\\right) - \\left(\\frac{L}{2}, 0, 0\\right) = \\left(\\frac{L+2\\alpha-L}{2}, H, 0\\right) = (\\alpha, H, 0)\n$$\n\n$\\mathbf{d}_2$ 是连接边 $\\mathbf{r}_{+-}$ 到 $\\mathbf{r}_{++}$ 的中点与边 $\\mathbf{r}_{--}$ 到 $\\mathbf{r}_{-+}$ 的中点的向量。\n设 $M_2$ 为边 $(\\mathbf{r}_{+-}, \\mathbf{r}_{++})$ 的中点， $M_4$ 为边 $(\\mathbf{r}_{--}, \\mathbf{r}_{-+})$ 的中点。\n$$\nM_2 = \\frac{1}{2}(\\mathbf{r}_{+-} + \\mathbf{r}_{++}) = \\frac{1}{2}((L,0,0) + (L+\\alpha,H,0)) = \\left(\\frac{2L+\\alpha}{2}, \\frac{H}{2}, 0\\right)\n$$\n$$\nM_4 = \\frac{1}{2}(\\mathbf{r}_{--} + \\mathbf{r}_{-+}) = \\frac{1}{2}((0,0,0) + (\\alpha,H,0)) = \\left(\\frac{\\alpha}{2}, \\frac{H}{2}, 0\\right)\n$$\n所以，$\\mathbf{d}_2 = M_4 - M_2$：\n$$\n\\mathbf{d}_2 = \\left(\\frac{\\alpha}{2}, \\frac{H}{2}, 0\\right) - \\left(\\frac{2L+\\alpha}{2}, \\frac{H}{2}, 0\\right) = \\left(\\frac{\\alpha-(2L+\\alpha)}{2}, \\frac{H-H}{2}, 0\\right) = (-L, 0, 0)\n$$\n\n现在我们为 $A_{\\mathrm{diag}}$ 计算叉积：\n$$\n\\mathbf{d}_1 \\times \\mathbf{d}_2 = (\\alpha, H, 0) \\times (-L, 0, 0) = \\begin{vmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ \\alpha  H  0 \\\\ -L  0  0 \\end{vmatrix} = (0, 0, \\alpha \\cdot 0 - H(-L)) = (0, 0, LH)\n$$\n近似面积是该向量模的一半：\n$$\nA_{\\mathrm{diag}} = \\frac{1}{2}\\left\\|\\mathbf{d}_1 \\times \\mathbf{d}_2\\right\\| = \\frac{1}{2}\\left\\|(0, 0, LH)\\right\\| = \\frac{1}{2}LH\n$$\n\n最后，我们计算相对偏差 $B$：\n$$\nB = \\frac{A_{\\mathrm{diag}}}{A_{\\mathrm{exact}}} - 1 = \\frac{\\frac{1}{2}LH}{LH} - 1 = \\frac{1}{2} - 1 = -\\frac{1}{2}\n$$\n相对偏差是一个常数值，与几何参数 $L$、$H$ 和 $\\alpha$ 无关。",
            "answer": "$$\\boxed{-\\frac{1}{2}}$$"
        },
        {
            "introduction": "一个稳健的CFD程序必须能够优雅地处理质量各异的网格，包括那些几何上“退化”或形状恶劣的单元。本实践  深入探讨了一个关键问题：如何计算近乎扁平的四面体体积，这是数值不稳定性的一个常见来源。通过分析当顶点接近共面时体积计算的行为，你将对数值稳健性所面临的挑战有更深刻的认识，并学会处理这类精细几何构型的技巧。",
            "id": "3303164",
            "problem": "在计算流体动力学 (CFD) 中，单元体积的精确计算对于守恒离散化至关重要。考虑一个四面体控制体积，其顶点由以下公式给出：\n- $X_{1} = (0, 0, 0)$，\n- $X_{2} = (L, 0, 0)$，\n- $X_{3} = (0, L, 0)$，\n- $X_{4} = (\\varepsilon a L, \\varepsilon b L, \\varepsilon c L)$，\n其中 $L  0$ 是一个固定的长度尺度，$a$、$b$、$c$ 是量级为 $1$ 的无量纲常数，而 $0  \\varepsilon \\ll 1$ 是一个小的无量纲参数，表示近共面的程度。当 $\\varepsilon \\to 0^{+}$ 时，该几何形状是近共面的，因此在体积计算上是数值退化的。你需要分析该四面体体积的一阶行为，并构建一个能够解决退化问题同时保持体积一阶精度的扰动方案。\n\n任务：\n- 从 $\\mathbb{R}^{3}$ 中单形的有向体积的基本定义和一阶线性化原理出发，确定由 $\\{X_{i}\\}_{i=1}^{4}$ 定义的四面体体积 $V(\\varepsilon)$ 的 $\\mathcal{O}(\\varepsilon)$ 项。\n- 提出一个顶点扰动方案，该方案能解决近共面性问题，且不改变体积的一阶项。具体来说，只考虑垂直扰动：对于 $i \\in \\{1,2,3,4\\}$，设置 $\\widetilde{X}_{i} = X_{i} + \\delta X_{i}$，其中 $\\delta X_{i} = (0, 0, \\varepsilon L \\eta_{i})$，$\\eta_{i}$ 是待定的量级为 $1$ 的无量纲常数。推导关于 $(\\eta_{1}, \\eta_{2}, \\eta_{3}, \\eta_{4})$ 的线性条件，以确保扰动后四面体的 $\\mathcal{O}(\\varepsilon)$ 体积与未扰动构型的体积相等。\n- 为了明确地解决退化问题，选择一个与您的条件一致的具体非平凡选择，例如 $\\eta_{1} = 0$, $\\eta_{4} = 0$, $\\eta_{2} = 1$, $\\eta_{3} = -1$。使用这个选择，计算修正后体积 $V_{\\text{corr}}(\\varepsilon)$ 的 $\\mathcal{O}(\\varepsilon)$ 项，并将其与未扰动体积的 $\\mathcal{O}(\\varepsilon)$ 项进行比较。\n\n以 $L$、$\\varepsilon$ 和 $c$ 的显式闭式表达式形式给出 $V_{\\text{corr}}(\\varepsilon)$ 一阶项的最终结果。答案以立方米为单位，但只报告作为 $L$、$\\varepsilon$ 和 $c$ 的函数的符号表达式（不要在最终的方框答案中包含单位）。不需要四舍五入。",
            "solution": "问题陈述被认为是有效的，因为它是科学合理的、适定的、客观的且内部一致的。它提出了一个与计算流体力学相关的计算几何和扰动分析的标准问题。\n\n解答按照问题陈述的要求分三部分进行。我们从四面体有向体积的基本定义开始。\n\n一个具有顶点 $X_{1}$、$X_{2}$、$X_{3}$ 和 $X_{4}$ 的四面体的有向体积 $V$ 可以通过构成三个共点棱的向量的标量三重积来计算。选择 $X_{1}$作为原点，这些向量是 $\\vec{v}_{1} = X_{2} - X_{1}$、$\\vec{v}_{2} = X_{3} - X_{1}$ 和 $\\vec{v}_{3} = X_{4} - X_{1}$。有向体积则由下式给出：\n$$ V = \\frac{1}{6} (\\vec{v}_{1} \\times \\vec{v}_{2}) \\cdot \\vec{v}_{3} = \\frac{1}{6} \\det(\\vec{v}_{1}, \\vec{v}_{2}, \\vec{v}_{3}) $$\n\n第一部分：未扰动体积 $V(\\varepsilon)$ 的一阶项\n未扰动四面体的顶点如下：\n$X_{1} = (0, 0, 0)$\n$X_{2} = (L, 0, 0)$\n$X_{3} = (0, L, 0)$\n$X_{4} = (\\varepsilon a L, \\varepsilon b L, \\varepsilon c L)$\n\n从顶点 $X_{1}$ 出发的棱向量为：\n$\\vec{v}_{1} = X_{2} - X_{1} = (L, 0, 0)$\n$\\vec{v}_{2} = X_{3} - X_{1} = (0, L, 0)$\n$\\vec{v}_{3} = X_{4} - X_{1} = (\\varepsilon a L, \\varepsilon b L, \\varepsilon c L)$\n\n有向体积 $V(\\varepsilon)$ 由这些向量组成的矩阵的行列式计算得出：\n$$\n6 V(\\varepsilon) = \\det(\\vec{v}_{1}, \\vec{v}_{2}, \\vec{v}_{3}) =\n\\begin{vmatrix}\nL  0  \\varepsilon a L \\\\\n0  L  \\varepsilon b L \\\\\n0  0  \\varepsilon c L\n\\end{vmatrix}\n$$\n由于这是一个上三角矩阵，其行列式是对角线元素的乘积：\n$$ \\det(\\vec{v}_{1}, \\vec{v}_{2}, \\vec{v}_{3}) = L \\cdot L \\cdot (\\varepsilon c L) = \\varepsilon c L^{3} $$\n因此，有向体积为：\n$$ V(\\varepsilon) = \\frac{1}{6} \\varepsilon c L^{3} $$\n体积与 $\\varepsilon$成正比。体积的一阶项，即 $\\mathcal{O}(\\varepsilon)$ 项，是整个表达式 $\\frac{1}{6} \\varepsilon c L^{3}$。\n\n第二部分：顶点扰动与一阶体积保持条件\n顶点根据 $\\widetilde{X}_{i} = X_{i} + \\delta X_{i}$ 进行扰动，其中 $\\delta X_{i} = (0, 0, \\varepsilon L \\eta_{i})$。扰动后的顶点坐标为：\n$\\widetilde{X}_{1} = (0, 0, \\varepsilon L \\eta_{1})$\n$\\widetilde{X}_{2} = (L, 0, \\varepsilon L \\eta_{2})$\n$\\widetilde{X}_{3} = (0, L, \\varepsilon L \\eta_{3})$\n$\\widetilde{X}_{4} = (\\varepsilon a L, \\varepsilon b L, \\varepsilon L (c + \\eta_{4}))$\n\n从 $\\widetilde{X}_{1}$ 出发的新棱向量为：\n$\\vec{\\tilde{v}}_{1} = \\widetilde{X}_{2} - \\widetilde{X}_{1} = (L, 0, \\varepsilon L(\\eta_{2} - \\eta_{1}))$\n$\\vec{\\tilde{v}}_{2} = \\widetilde{X}_{3} - \\widetilde{X}_{1} = (0, L, \\varepsilon L(\\eta_{3} - \\eta_{1}))$\n$\\vec{\\tilde{v}}_{3} = \\widetilde{X}_{4} - \\widetilde{X}_{1} = (\\varepsilon a L, \\varepsilon b L, \\varepsilon L(c + \\eta_{4} - \\eta_{1}))$\n\n修正后的有向体积 $V_{\\text{corr}}(\\varepsilon)$ 由这些向量的行列式的 $\\frac{1}{6}$ 给出：\n$$\n6 V_{\\text{corr}}(\\varepsilon) = \\det(\\vec{\\tilde{v}}_{1}, \\vec{\\tilde{v}}_{2}, \\vec{\\tilde{v}}_{3}) =\n\\begin{vmatrix}\nL  0  \\varepsilon a L \\\\\n0  L  \\varepsilon b L \\\\\n\\varepsilon L(\\eta_{2} - \\eta_{1})  \\varepsilon L(\\eta_{3} - \\eta_{1})  \\varepsilon L(c + \\eta_{4} - \\eta_{1})\n\\end{vmatrix}\n$$\n例如，沿第一行展开行列式：\n$$\n\\det = L \\begin{vmatrix} L  \\varepsilon b L \\\\ \\varepsilon L(\\eta_{3} - \\eta_{1})  \\varepsilon L(c + \\eta_{4} - \\eta_{1}) \\end{vmatrix} + \\varepsilon a L \\begin{vmatrix} 0  L \\\\ \\varepsilon L(\\eta_{2} - \\eta_{1})  \\varepsilon L(\\eta_{3} - \\eta_{1}) \\end{vmatrix}\n$$\n$$\n= L \\left( \\varepsilon L^{2}(c + \\eta_{4} - \\eta_{1}) - \\varepsilon^{2}bL^{2}(\\eta_{3} - \\eta_{1}) \\right) + \\varepsilon a L \\left( - \\varepsilon L^{2}(\\eta_{2} - \\eta_{1}) \\right)\n$$\n$$\n= \\varepsilon L^{3}(c + \\eta_{4} - \\eta_{1}) - \\varepsilon^{2} L^{3} \\left( b(\\eta_{3} - \\eta_{1}) + a(\\eta_{2} - \\eta_{1}) \\right)\n$$\n因此，修正后的有向体积为：\n$$ V_{\\text{corr}}(\\varepsilon) = \\frac{1}{6} \\left( \\varepsilon L^{3}(c + \\eta_{4} - \\eta_{1}) + \\mathcal{O}(\\varepsilon^{2}) \\right) $$\n$V_{\\text{corr}}(\\varepsilon)$ 的一阶项，即 $\\mathcal{O}(\\varepsilon)$ 项，是 $\\frac{1}{6} \\varepsilon L^{3}(c + \\eta_{4} - \\eta_{1})$。\n为保持体积的一阶精度，此项必须等于未扰动体积 $V(\\varepsilon)$ 的一阶项：\n$$ \\frac{1}{6} \\varepsilon L^{3}(c + \\eta_{4} - \\eta_{1}) = \\frac{1}{6} \\varepsilon c L^{3} $$\n这简化为关于扰动参数的线性条件：\n$$ c + \\eta_{4} - \\eta_{1} = c \\implies \\eta_{1} = \\eta_{4} $$\n这个条件 $\\eta_{1} - \\eta_{4} = 0$ 与 $\\eta_{2}$ 和 $\\eta_{3}$ 无关，因为它们对体积的贡献仅出现在 $\\mathcal{O}(\\varepsilon^{2})$ 阶及更高阶。\n\n第三部分：特定扰动方案的修正体积\n给定一组特定的扰动参数选择：$\\eta_{1} = 0$, $\\eta_{4} = 0$, $\\eta_{2} = 1$, $\\eta_{3} = -1$。\n我们验证这个选择满足推导出的条件：$\\eta_{1} = \\eta_{4} \\implies 0 = 0$。条件得到满足。\n问题要求计算此选择下修正体积 $V_{\\text{corr}}(\\varepsilon)$ 的 $\\mathcal{O}(\\varepsilon)$ 项。如前所述，修正体积的一阶项为 $\\frac{1}{6} \\varepsilon L^{3}(c + \\eta_{4} - \\eta_{1})$。代入给定值 $\\eta_{1} = 0$ 和 $\\eta_{4} = 0$：\n$$ \\left. V_{\\text{corr}}(\\varepsilon) \\right|_{\\mathcal{O}(\\varepsilon)} = \\frac{1}{6} \\varepsilon L^{3}(c + 0 - 0) = \\frac{1}{6} \\varepsilon c L^{3} $$\n如预期，这与未扰动体积的一阶项 $\\frac{1}{6} \\varepsilon c L^{3}$ 相同。非零 $\\eta_2$ 和 $\\eta_3$ 的目的是在数值上解决顶点 $X_1, X_2, X_3$ 的共面性问题，而不改变体积的一阶项。$V_{\\text{corr}}(\\varepsilon)$ 的一阶项的最终表达式就是这个结果。",
            "answer": "$$\n\\boxed{\\frac{1}{6} \\varepsilon c L^{3}}\n$$"
        }
    ]
}