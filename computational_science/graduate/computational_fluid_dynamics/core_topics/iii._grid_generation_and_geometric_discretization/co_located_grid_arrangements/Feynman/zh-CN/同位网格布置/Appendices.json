{
    "hands_on_practices": [
        {
            "introduction": "为了理解为何同位网格需要特殊的处理方法，我们首先必须直观地观察它所要解决的问题。这项实践通过一个数值实验，生动地展示了同位网格上臭名昭著的“棋盘格”压力不稳定性，并将其与交错网格的内禀稳定性进行对比。通过这个练习，你将对压力-速度解耦现象建立起一个深刻且直观的认识，从而理解Rhie-Chow等稳定化格式的必要性 。",
            "id": "3365597",
            "problem": "考虑在每个方向长度为 $L=1$ 的二维周期性区域上的稳态不可压缩斯托克斯方程，其空间坐标为 $(x,y)$，速度场为 $\\mathbf{u}(x,y) = (u(x,y), v(x,y))$：\n$$\n-\\nabla p + \\nu \\nabla^2 \\mathbf{u} = \\mathbf{f}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\n其中 $p(x,y)$ 是压力，$\\nu$ 是运动粘度，$\\mathbf{f}(x,y)$ 是给定的体积力。在分步投影法中，压力场 $p$ 是通过求解以下与强制执行离散不可压缩性相关的压力泊松方程得到的：\n$$\n\\nabla^2 p = s,\n$$\n其中 $s$ 是一个由中间速度场的散度构造的离散源项。在间距为 $\\Delta x = \\Delta y$ 的均匀笛卡尔网格上，不同的网格布置会导致不同的离散梯度和散度算子。具体来说：\n- 同位（单元中心）布置将 $u$、$v$ 和 $p$ 全部置于单元中心。一种常见的朴素中心差分实现使用每个坐标方向上的最近邻点来计算中心的离散压力梯度：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{col}} = \\frac{p_{i+1,j} - p_{i-1,j}}{2 \\Delta x}, \\quad\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{col}} = \\frac{p_{i,j+1} - p_{i,j-1}}{2 \\Delta x}.\n$$\n- Marker-And-Cell (MAC) 交错布置将 $u$ 置于垂直面 $(i+\\tfrac{1}{2}, j)$ 上，$v$ 置于水平面 $(i, j+\\tfrac{1}{2})$ 上，而 $p$ 置于单元中心 $(i,j)$。离散压力梯度自然地出现在面上：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\text{MAC}} = \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x}, \\quad\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}}^{\\text{MAC}} = \\frac{p_{i,j+1} - p_{i,j}}{\\Delta x}.\n$$\n\n众所周知，同位中心差分允许存在一种伪压力模式，通常称为棋盘格模式，它在 $N_x \\times N_y$ 均匀周期性网格上定义为\n$$\np_{i,j}^{\\text{chk}} = (-1)^{i+j}, \\quad i = 0,1,\\dots,N_x-1, \\quad j = 0,1,\\dots,N_y-1,\n$$\n并对应于最高可分辨空间频率（奈奎斯特模式）。这种模式可被某些离散强迫项激发，在同位网格上，当采用从中心到面的朴素插值时，它会与动量方程解耦，导致 $p$ 中出现不驱动动量的非物理振荡。相反，MAC 交错布置抑制了这种解耦，因为面心离散梯度直接对相邻单元中心的压力进行采样，棋盘格模式的差分在面上不为零。\n\n你的任务是：\n1. 使用人造源项 $s_{i,j} = (-1)^{i+j}$，在具有周期性边界条件的离散压力泊松方程中激发棋盘格模式。该方程使用标准五点拉普拉斯算子进行离散化。在间距为 $\\Delta x$ 的均匀网格上，五点拉普拉斯算子的离散傅里叶符号为\n$$\n\\lambda(k_x,k_y) = \\frac{2}{\\Delta x^2}\\left(\\cos(k_x \\Delta x)-1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos(k_y \\Delta x)-1\\right),\n$$\n对于离散波数 $k_x = \\frac{2\\pi m}{L}$，$k_y = \\frac{2\\pi n}{L}$，其中 $m = 0,1,\\dots,N_x-1$ 且 $n = 0,1,\\dots,N_y-1$。当 $N_x$ 和 $N_y$ 为偶数时，棋盘格模式对应于 $(m,n) = (N_x/2, N_y/2)$，这使得 $\\cos(\\pi) = -1$，因此\n$$\n\\lambda_{\\text{chk}} = -\\frac{4}{\\Delta x^2} - \\frac{4}{\\Delta x^2} = -\\frac{8}{\\Delta x^2}.\n$$\n由此，与棋盘格强迫项相关的压力振幅 $A_p(\\Delta x)$ 的缩放关系为\n$$\nA_p(\\Delta x) = \\frac{1}{|\\lambda_{\\text{chk}}|} = \\frac{\\Delta x^2}{8}.\n$$\n2. 对于一系列均匀网格，在傅里叶域中使用上述离散拉普拉斯符号数值求解离散周期性泊松方程 $\\nabla^2 p = s$，并通过将计算出的 $p$ 投影到 $p^{\\text{chk}}$ 上来提取棋盘格分量的数值振幅 $A_p(\\Delta x)$。\n3. 计算并比较在以下两种情况下会进入动量方程的面心压力梯度的均方根 (RMS) 大小：\n   - 通过将相邻单元的中心梯度平均到面获得的同位朴素面梯度：\n   $$\n   \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\text{col-face}} = \\frac{1}{2}\\left[\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{col}} + \\left(\\frac{\\partial p}{\\partial x}\\right)_{i+1,j}^{\\text{col}}\\right], \\quad\n   \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}}^{\\text{col-face}} = \\frac{1}{2}\\left[\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{col}} + \\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+1}^{\\text{col}}\\right].\n   $$\n   - 如上文定义的 MAC 面梯度。RMS 大小定义为\n   $$\n   G_{\\text{RMS}} = \\sqrt{\\frac{1}{N_f}\\sum_{f} g_f^2},\n   $$\n   其中 $g_f$ 遍及两个方向上所有的面梯度分量，$N_f$ 是面的总数。\n4. 数值证明：\n   - 同位朴素面梯度对棋盘格分量是“盲”的，因此对于人造强迫项，其 RMS 大小在数值上为零，这解释了解耦现象。\n   - MAC 面梯度与棋盘格模式耦合，对于人造强迫项，其 RMS 大小的缩放关系为 $\\mathcal{O}(\\Delta x)$，因为 $A_p(\\Delta x) \\sim \\Delta x^2$ 且面梯度的缩放关系为 $A_p(\\Delta x)/\\Delta x$。\n\n实现一个程序，该程序：\n- 在长度为 $L=1$ 的周期性区域上构建人造源项 $s_{i,j} = (-1)^{i+j}$。\n- 在傅里叶空间中使用离散拉普拉斯符号求解离散泊松方程以获得 $p_{i,j}$。\n- 通过投影到 $(-1)^{i+j}$ 上来计算数值棋盘格振幅 $A_p(\\Delta x)$。\n- 为得到的 $p_{i,j}$ 计算 $G_{\\text{RMS}}^{\\text{col-face}}$ 和 $G_{\\text{RMS}}^{\\text{MAC}}$。\n- 报告每个网格的元组 $(A_p(\\Delta x), G_{\\text{RMS}}^{\\text{col-face}}, G_{\\text{RMS}}^{\\text{MAC}})$。\n\n测试套件：\n- 对以下情况使用 $N_x=N_y$ 和 $L=1$ 的正方形网格：\n  1. $N_x=N_y=8$（粗网格，$\\Delta x = 1/8$）。\n  2. $N_x=N_y=16$（中等网格，$\\Delta x = 1/16$）。\n  3. $N_x=N_y=32$（细网格，$\\Delta x = 1/32$）。\n  4. $N_x=N_y=64$（极细网格，$\\Delta x = 1/64$）。\n所有报告的量都是无量纲的。你的程序应生成单行输出，其中包含结果，格式为由逗号分隔的四个带括号的元组列表，每个元组按 $(A_p(\\Delta x), G_{\\text{RMS}}^{\\text{col-face}}, G_{\\text{RMS}}^{\\text{MAC}})$ 的顺序排列，与测试用例的顺序相同，例如：\n\"[(a1,b1,c1),(a2,b2,c2),(a3,b3,c3),(a4,b4,c4)]\"。",
            "solution": "我们从稳态不可压缩斯托克斯方程开始\n$$\n-\\nabla p + \\nu \\nabla^2 \\mathbf{u} = \\mathbf{f}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\n在分步投影法下，这导致通过压力泊松方程来强制执行离散不可压缩性\n$$\n\\nabla^2 p = s,\n$$\n其中源项 $s$ 从中间速度的散度获得。在均匀周期性网格上，在离散傅里叶空间中求解此泊松方程是很自然的，并且能揭示某些空间模式如何传播到压力中。我们关注棋盘格（奈奎斯特）模式，\n$$\np_{i,j}^{\\text{chk}} = (-1)^{i+j},\n$$\n它在相邻的单元中心之间符号交替变化。\n\n对于间距为 $\\Delta x$ 且具有周期性边界条件的均匀网格，标准的五点离散拉普拉斯算子具有傅里叶符号\n$$\n\\lambda(k_x,k_y) = \\frac{2}{\\Delta x^2}\\left(\\cos(k_x \\Delta x)-1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos(k_y \\Delta x)-1\\right),\n$$\n其离散波数为 $k_x = \\frac{2\\pi m}{L}$ 和 $k_y = \\frac{2\\pi n}{L}$，$m=0,\\dots,N_x-1$，$n=0,\\dots,N_y-1$，且 $L=1$。对于棋盘格模式，$(m,n)=(N_x/2, N_y/2)$ 且 $k_x \\Delta x = \\pi$，$k_y \\Delta x = \\pi$，得到\n$$\n\\lambda_{\\text{chk}} = \\frac{2}{\\Delta x^2}\\left(\\cos \\pi - 1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos \\pi - 1\\right) = \\frac{2}{\\Delta x^2}\\left(-1 - 1\\right) + \\frac{2}{\\Delta x^2}\\left(-1 - 1\\right) = -\\frac{8}{\\Delta x^2}.\n$$\n用 $s_{i,j}=(-1)^{i+j}$ 强迫泊松方程意味着右侧只有这一种模式。因此解与该模式成正比：\n$$\np_{i,j} = A_p(\\Delta x)\\, (-1)^{i+j}.\n$$\n代入傅里叶空间中的离散泊松方程可得\n$$\n\\lambda_{\\text{chk}} A_p(\\Delta x) = 1 \\quad \\Rightarrow \\quad A_p(\\Delta x) = -\\frac{1}{\\lambda_{\\text{chk}}} = \\frac{\\Delta x^2}{8}.\n$$\n因此，计算出的压力中棋盘格分量的振幅按 $\\Delta x^2$ 缩放。\n\n同位布置和 Marker-And-Cell (MAC) 交错布置之间的区别在于动量方程中压力梯度的表示方式：\n- 在同位（单元中心）方案中，一种常见的朴素实现使用中心差分来估计单元中心的 $\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{col}}$ 和 $\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{col}}$。对于棋盘格压力 $p_{i,j} = A_p(\\Delta x)\\,(-1)^{i+j}$，\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j}^{\\text{col}} = \\frac{p_{i+1,j} - p_{i-1,j}}{2 \\Delta x}\n= \\frac{A_p(\\Delta x)\\left[(-1)^{i+1+j} - (-1)^{i-1+j}\\right]}{2\\Delta x}\n= \\frac{A_p(\\Delta x)\\,(-1)^{i+j}\\left[-1 - (-1)\\right]}{2\\Delta x} = 0,\n$$\n类似的计算表明 $\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j}^{\\text{col}}=0$。如果接着通过平均相邻的中心梯度来朴素地构造面梯度，那么驱动动量方程的最终面压力梯度仍然为零。这证明了解耦：在同位朴素方案中，棋盘格压力不会产生面心压力。\n- 在 MAC 交错布置中，面心离散梯度直接取相邻中心压力的差值：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i+\\frac{1}{2},j}^{\\text{MAC}} = \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x}\n= \\frac{A_p(\\Delta x)\\left[(-1)^{i+1+j} - (-1)^{i+j}\\right]}{\\Delta x}\n= \\frac{A_p(\\Delta x)\\,(-1)^{i+j}(-1 - 1)}{\\Delta x}\n= -\\frac{2\\,A_p(\\Delta x)}{\\Delta x}\\,(-1)^{i+j}.\n$$\n$\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j+\\frac{1}{2}}^{\\text{MAC}}$ 也有类似的表达式。因此，MAC 面梯度与棋盘格模式强耦合，并驱动动量校正以抑制此类振荡。对于人造强迫项，MAC 面梯度的大小的缩放关系为 $\\frac{A_p(\\Delta x)}{\\Delta x} \\sim \\frac{\\Delta x^2}{\\Delta x} = \\mathcal{O}(\\Delta x)$。\n\n程序算法设计：\n1. 对于每个具有 $N_x=N_y$ 和 $\\Delta x = 1/N_x$ 的测试网格，构建人造源项 $s_{i,j} = (-1)^{i+j}$。\n2. 计算 $s$ 的二维离散傅里叶变换以获得 $\\hat{s}(m,n)$。\n3. 对于每个傅里叶模式 $(m,n)$，使用以下公式计算离散拉普拉斯符号 $\\lambda(m,n)$：\n$$\n\\lambda(m,n) = \\frac{2}{\\Delta x^2}\\left(\\cos\\left(\\frac{2\\pi m}{N_x}\\right)-1\\right) + \\frac{2}{\\Delta x^2}\\left(\\cos\\left(\\frac{2\\pi n}{N_y}\\right)-1\\right).\n$$\n4. 对于所有 $\\lambda(m,n) \\neq 0$ 的 $(m,n)$，计算 $\\hat{p}(m,n) = \\hat{s}(m,n) / \\lambda(m,n)$。由于交替模式，零模式 $(m,n)=(0,0)$ 在 $\\hat{s}$ 中不存在，因此不会发生除以零的情况。\n5. 进行逆变换以在物理空间中获得 $p_{i,j}$。\n6. 将 $p$ 投影到棋盘格模式上以提取振幅，\n$$\nA_p(\\Delta x) = \\frac{1}{N_x N_y} \\sum_{i=0}^{N_x-1}\\sum_{j=0}^{N_y-1} p_{i,j}(-1)^{i+j}.\n$$\n7. 使用中心差分计算同位中心梯度，然后通过将相邻的中心梯度平均到面来获得同位面梯度。计算所有面上的均方根大小：\n$$\nG_{\\text{RMS}}^{\\text{col-face}} = \\sqrt{\\frac{1}{N_f}\\sum_{f}\\left(g_{f}^{\\text{col-face}}\\right)^2}.\n$$\n8. 从相邻的中心压力计算 MAC 面梯度及相应的均方根大小：\n$$\nG_{\\text{RMS}}^{\\text{MAC}} = \\sqrt{\\frac{1}{N_f}\\sum_{f}\\left(g_{f}^{\\text{MAC}}\\right)^2}.\n$$\n9. 为测试套件中的每个网格输出 $(A_p(\\Delta x), G_{\\text{RMS}}^{\\text{col-face}}, G_{\\text{RMS}}^{\\text{MAC}})$，并按规定汇总成单行。\n\n预期行为：\n- 数值 $A_p(\\Delta x)$ 应与 $\\Delta x^2/8$ 近似成比例（取决于浮点精度和离散变换的归一化）。\n- $G_{\\text{RMS}}^{\\text{col-face}}$ 在数值上应为零（达到机器精度），这表明同位朴素梯度对棋盘格压力是“盲”的。\n- 对于此人造强迫项，$G_{\\text{RMS}}^{\\text{MAC}}$ 应与 $\\Delta x$ 呈线性比例关系，因为面梯度大小的行为类似于 $2 A_p(\\Delta x)/\\Delta x$。\n\n这直接展示了 Marker-And-Cell (MAC) 交错网格抑制棋盘格压力模式的机制：通过将速度置于面上，离散压力梯度被评估为相邻压力的差值，该差值对于交替模式不为零，从而将伪模式耦合到动量中，并在其中被耗散。相反，在中心处使用同位朴素中心差分计算压力梯度会消除交替分量，从而允许伪压力模式持续存在而不影响速度场。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef discrete_laplacian_symbol(nx, ny, dx):\n    \"\"\"\n    Build the discrete Laplacian symbol lambda(m,n) for a periodic grid\n    using the five-point stencil central differences on a uniform grid.\n    \"\"\"\n    # Wavenumber indices m, n\n    m = np.arange(nx)\n    n = np.arange(ny)\n    # Cosine terms for each axis\n    cos_m = np.cos(2.0 * np.pi * m / nx)\n    cos_n = np.cos(2.0 * np.pi * n / ny)\n    # Broadcast to 2D grid of (m,n)\n    lam = (2.0 / dx**2) * (cos_m[:, None] - 1.0) + (2.0 / dx**2) * (cos_n[None, :] - 1.0)\n    return lam\n\ndef solve_poisson_checkerboard(nx, ny, L=1.0):\n    \"\"\"\n    Solve the discrete periodic Poisson equation for s_{i,j} = (-1)^{i+j}\n    using the discrete Laplacian symbol in Fourier space.\n\n    Returns:\n        p: computed pressure field (nx x ny)\n        Ap: numerical checkerboard amplitude via projection onto (-1)^{i+j}\n    \"\"\"\n    dx = L / nx\n    # Manufactured source s = (-1)^{i+j}\n    i = np.arange(nx)[:, None]\n    j = np.arange(ny)[None, :]\n    s = ((-1.0) ** (i + j)).astype(np.float64)\n\n    # FFT of source\n    s_hat = np.fft.fft2(s)\n\n    # Discrete Laplacian symbol\n    lam = discrete_laplacian_symbol(nx, ny, dx)\n\n    # Avoid division by zero: source has zero mean, so lam[0,0] won't be used\n    # Construct p_hat = s_hat / lam\n    # Use where to handle potential zeros robustly (though s_hat[0,0]==0)\n    p_hat = np.zeros_like(s_hat, dtype=np.complex128)\n    mask = lam != 0.0\n    p_hat[mask] = s_hat[mask] / lam[mask]\n\n    # Inverse FFT to get p\n    p = np.real(np.fft.ifft2(p_hat))\n\n    # Compute checkerboard amplitude Ap = mean(p * (-1)^{i+j})\n    pattern = ((-1.0) ** (i + j)).astype(np.float64)\n    Ap = np.sum(p * pattern) / (nx * ny)\n\n    return p, Ap, dx\n\ndef colocated_face_gradient_rms(p, dx):\n    \"\"\"\n    Compute colocated center gradients via central differences and then\n    naive face gradients by averaging adjacent center gradients.\n    Return RMS magnitude over all faces.\n    \"\"\"\n    nx, ny = p.shape\n\n    # Periodic shifts\n    p_ip = np.roll(p, -1, axis=0)\n    p_im = np.roll(p,  1, axis=0)\n    p_jp = np.roll(p, -1, axis=1)\n    p_jm = np.roll(p,  1, axis=1)\n\n    # Center gradients (central difference)\n    gx_c = (p_ip - p_im) / (2.0 * dx)\n    gy_c = (p_jp - p_jm) / (2.0 * dx)  # dx == dy\n\n    # Face gradients: average adjacent center gradients to faces\n    # x-faces at (i+1/2, j): average gx_c[i,j] and gx_c[i+1,j]\n    gx_face = 0.5 * (gx_c + np.roll(gx_c, -1, axis=0))\n    # y-faces at (i, j+1/2): average gy_c[i,j] and gy_c[i,j+1]\n    gy_face = 0.5 * (gy_c + np.roll(gy_c, -1, axis=1))\n\n    # RMS over all faces (both directions)\n    # Number of faces: 2 * nx * ny\n    rms = np.sqrt((np.sum(gx_face**2) + np.sum(gy_face**2)) / (2.0 * nx * ny))\n    return rms\n\ndef mac_face_gradient_rms(p, dx):\n    \"\"\"\n    Compute MAC face gradients directly from adjacent center pressures.\n    Return RMS magnitude over all faces.\n    \"\"\"\n    nx, ny = p.shape\n\n    # x-face gradient: (p_{i+1,j} - p_{i,j}) / dx\n    p_ip = np.roll(p, -1, axis=0)\n    gx_face = (p_ip - p) / dx\n\n    # y-face gradient: (p_{i,j+1} - p_{i,j}) / dx\n    p_jp = np.roll(p, -1, axis=1)\n    gy_face = (p_jp - p) / dx\n\n    rms = np.sqrt((np.sum(gx_face**2) + np.sum(gy_face**2)) / (2.0 * nx * ny))\n    return rms\n\ndef run_test_case(nx):\n    ny = nx\n    p, Ap, dx = solve_poisson_checkerboard(nx, ny, L=1.0)\n    rms_col = colocated_face_gradient_rms(p, dx)\n    rms_mac = mac_face_gradient_rms(p, dx)\n    return (Ap, rms_col, rms_mac)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [8, 16, 32, 64]\n\n    results = []\n    for nx in test_cases:\n        Ap, rms_col, rms_mac = run_test_case(nx)\n        # Format each tuple with reasonable precision\n        results.append(f\"({Ap:.10f},{rms_col:.10e},{rms_mac:.10e})\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在了解了压力-速度解耦问题后，我们现在来探讨同位网格下的一种经典解决方案——Rhie-Chow动量插值法。这项实践将引导你一步步推导出应用Rhie-Chow插值后所产生的压力修正方程。通过这个推导过程，你将揭示该技术在数学上是如何重新建立压力与速度之间的耦合，从而有效抑制棋盘格不稳定性的核心机制 。",
            "id": "3302122",
            "problem": "考虑在同位有限体积网格上求解的二维、不可压缩、常密度流，其中所有原始变量都存储在单元中心。网格是均匀的，间距为 $\\Delta x$ 和 $\\Delta y$，因此任何内部单元 $P$ 的控制体体积为 $\\Delta V = \\Delta x \\Delta y$，面面积为 $A_{e} = \\Delta y$、$A_{w} = \\Delta y$、$A_{n} = \\Delta x$ 和 $A_{s} = \\Delta x$。时间积分采用隐式欧拉法，时间步长为 $\\Delta t$。为避免在同位网格布置上出现压力-速度解耦，面质量通量采用 Rhie–Chow 插值法构建，其中面法向速度修正是通过对单元中心对角系数的倒数进行中心插值，从而得到动量方程的面有效逆对角项。\n\n假设在水平速度分量 $u$ 和垂直速度分量 $v$ 的离散化动量方程中，所有单元的对角系数均为 $a_{P}^{u} = a_{P}^{v} = \\rho \\Delta V / \\Delta t$，其中 $\\rho$ 是恒定密度。利用此假设以及对角系数倒数的中心插值来计算每个面的有效对角项，推导并显式组合内部单元 $P$ 的线性压力修正方程的系数，\n$$\na_{P}^{p'} \\, p'_{P} \\;=\\; a_{E}^{p'} \\, p'_{E} \\;+\\; a_{W}^{p'} \\, p'_{W} \\;+\\; a_{N}^{p'} \\, p'_{N} \\;+\\; a_{S}^{p'} \\, p'_{S} \\;+\\; b_{P}^{p'} \\,,\n$$\n其中 $p'$ 表示压力修正值，$b_{P}^{p'}$ 是由预测（未修正）通量的质量通量不平衡引起的修正源项。用 $\\Delta x$、$\\Delta y$、$\\rho$ 和 $\\Delta t$ 表示组合后的系数 $a_{W}^{p'}$、$a_{E}^{p'}$、$a_{S}^{p'}$、$a_{N}^{p'}$ 以及对角项 $a_{P}^{p'}$。以 $a_{W}^{p'}$、$a_{E}^{p'}$、$a_{S}^{p'}$、$a_{N}^{p'}$、$a_{P}^{p'}$ 的顺序，将最终答案作为单行提供。无需进行数值计算。",
            "solution": "压力修正方程是通过对修正后的速度场强制执行质量守恒来推导的。对于均匀笛卡尔网格上的二维不可压缩流，控制体 $P$ 的离散化连续性方程为：\n$$\n(\\rho u A)_{e} - (\\rho u A)_{w} + (\\rho v A)_{n} - (\\rho v A)_{s} = 0\n$$\n其中 $u$ 和 $v$ 是单元面上的速度分量，$A$ 是面面积。在 SIMPLE 算法框架内，速度场和压力场被分解为预测部分（用 $*$ 表示）和修正部分（用 $'$ 表示）：\n$$\np = p^* + p' \\quad, \\quad u = u^* + u' \\quad, \\quad v = v^* + v'\n$$\n预测速度 $u^*$ 和 $v^*$ 通常不满足连续性，导致单元 $P$ 出现质量通量不平衡。修正后的速度必须满足连续性。将分解式代入连续性方程并重新整理，得到一个关于修正量的方程：\n$$\n(\\rho u' A)_{e} - (\\rho u' A)_{w} + (\\rho v' A)_{n} - (\\rho v' A)_{s} = - [(\\rho u^* A)_{e} - (\\rho u^* A)_{w} + (\\rho v^* A)_{n} - (\\rho v^* A)_{s}]\n$$\n右侧是预测步骤中质量通量不平衡的负值，被定义为源项 $b_{P}^{p'}$。我们的目标是用压力修正量 $p'$ 来表示左侧的面通量修正项。\n\n问题指明速度修正是基于 Rhie-Chow 插值概念的。面法向速度修正与该面上的压力修正梯度有关。东面速度修正量 $u'_{e}$ 的关系式为：\n$$\nu'_{e} = - d_e (p'_{E} - p'_{P})\n$$\n其中 $d_e$ 是从动量方程推导出的一个系数。问题陈述该机制涉及一个“面有效逆对角项…通过对单元中心对角系数的倒数进行中心插值获得”。一个包含了这一指令的量纲一致的公式是：\n$$\nu'_{e} = - \\Delta V \\overline{\\left(\\frac{1}{a^{u}}\\right)}_{e} \\frac{p'_{E} - p'_{P}}{\\Delta x}\n$$\n这里，$\\overline{(1/a^u)}_e$ 是在面 $e$ 处对角动量系数 $a^u$ 倒数的中心插值。\n给定 $a_{P}^{u} = a_{E}^{u} = \\frac{\\rho \\Delta V}{\\Delta t}$，其倒数对所有单元都是常数：\n$$\n\\frac{1}{a^{u}} = \\frac{\\Delta t}{\\rho \\Delta V} = \\frac{\\Delta t}{\\rho \\Delta x \\Delta y}\n$$\n因此，在面上的插值值为：\n$$\n\\overline{\\left(\\frac{1}{a^{u}}\\right)}_{e} = \\frac{1}{2} \\left( \\left(\\frac{1}{a^{u}}\\right)_{P} + \\left(\\frac{1}{a^{u}}\\right)_{E} \\right) = \\frac{1}{2} \\left( \\frac{\\Delta t}{\\rho \\Delta V} + \\frac{\\Delta t}{\\rho \\Delta V} \\right) = \\frac{\\Delta t}{\\rho \\Delta V}\n$$\n将此代入 $u'_{e}$ 的表达式中：\n$$\nu'_{e} = - \\Delta V \\left( \\frac{\\Delta t}{\\rho \\Delta V} \\right) \\frac{p'_{E} - p'_{P}}{\\Delta x} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{E} - p'_{P}}{\\Delta x}\n$$\n那么，在面 $e$ 处的质量通量修正 $(\\rho u' A)_e$ 为：\n$$\n(\\rho u' A)_{e} = \\rho A_{e} u'_{e} = \\rho (\\Delta y) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{E} - p'_{P}}{\\Delta x} \\right) = - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{E} - p'_{P})\n$$\n根据对称性，我们可以推导出其他面的通量修正：\n- **西面 (w):** 速度修正为 $u'_{w} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{W}}{\\Delta x}$。通量修正为：\n$$\n(\\rho u' A)_{w} = \\rho A_{w} u'_{w} = \\rho (\\Delta y) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{W}}{\\Delta x} \\right) = - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{P} - p'_{W})\n$$\n- **北面 (n):** 这里我们使用垂直速度 $v$ 及其对角系数 $a^v$。由于 $a_{P}^{v}=a_{N}^{v}=\\frac{\\rho \\Delta V}{\\Delta t}$，推导过程是类似的。速度修正为 $v'_{n} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{N} - p'_{P}}{\\Delta y}$。通量修正为：\n$$\n(\\rho v' A)_{n} = \\rho A_{n} v'_{n} = \\rho (\\Delta x) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{N} - p'_{P}}{\\Delta y} \\right) = - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{N} - p'_{P})\n$$\n- **南面 (s):** 速度修正为 $v'_{s} = - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{S}}{\\Delta y}$。通量修正为：\n$$\n(\\rho v' A)_{s} = \\rho A_{s} v'_{s} = \\rho (\\Delta x) \\left( - \\frac{\\Delta t}{\\rho} \\frac{p'_{P} - p'_{S}}{\\Delta y} \\right) = - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{P} - p'_{S})\n$$\n现在，我们将这些通量修正代入修正场的连续性方程中：\n$$\n(\\rho u' A)_{e} - (\\rho u' A)_{w} + (\\rho v' A)_{n} - (\\rho v' A)_{s} = b_{P}^{p'}\n$$\n$$\n\\left( - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{E} - p'_{P}) \\right) - \\left( - \\frac{\\Delta t \\Delta y}{\\Delta x} (p'_{P} - p'_{W}) \\right) + \\left( - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{N} - p'_{P}) \\right) - \\left( - \\frac{\\Delta t \\Delta x}{\\Delta y} (p'_{P} - p'_{S}) \\right) = b_{P}^{p'}\n$$\n展开并组合各项：\n$$\n\\left( \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{P} - \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{E} \\right) + \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{P} - \\frac{\\Delta t \\Delta y}{\\Delta x} p'_{W} \\right) + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{P} - \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{N} \\right) + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{P} - \\frac{\\Delta t \\Delta x}{\\Delta y} p'_{S} \\right) = b_{P}^{p'}\n$$\n我们将所有含 $p'_{P}$ 的项收集到左侧，并将所有其他项移到右侧，以匹配所要求的格式 $a_{P}^{p'} \\, p'_{P} = \\sum a_{nb}^{p'} \\, p'_{nb} + b_{P}^{p'}$。\n$$\np'_{P} \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} + \\frac{\\Delta t \\Delta y}{\\Delta x} + \\frac{\\Delta t \\Delta x}{\\Delta y} + \\frac{\\Delta t \\Delta x}{\\Delta y} \\right) = \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} \\right) p'_{E} + \\left( \\frac{\\Delta t \\Delta y}{\\Delta x} \\right) p'_{W} + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} \\right) p'_{N} + \\left( \\frac{\\Delta t \\Delta x}{\\Delta y} \\right) p'_{S} + b_{P}^{p'}\n$$\n从这个最终形式中，我们可以确定系数：\n$$\na_{E}^{p'} = \\frac{\\Delta t \\Delta y}{\\Delta x}\n$$\n$$\na_{W}^{p'} = \\frac{\\Delta t \\Delta y}{\\Delta x}\n$$\n$$\na_{N}^{p'} = \\frac{\\Delta t \\Delta x}{\\Delta y}\n$$\n$$\na_{S}^{p'} = \\frac{\\Delta t \\Delta x}{\\Delta y}\n$$\n对角系数 $a_{P}^{p'}$ 是相邻系数之和：\n$$\na_{P}^{p'} = a_{E}^{p'} + a_{W}^{p'} + a_{N}^{p'} + a_{S}^{p'} = 2 \\frac{\\Delta t \\Delta y}{\\Delta x} + 2 \\frac{\\Delta t \\Delta x}{\\Delta y} = 2 \\Delta t \\left( \\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y} \\right)\n$$\n问题要求按 $a_{W}^{p'}$、$a_{E}^{p'}$、$a_{S}^{p'}$、$a_{N}^{p'}$、$a_{P}^{p'}$ 的顺序列出系数。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\Delta t \\Delta y}{\\Delta x}, & \\frac{\\Delta t \\Delta y}{\\Delta x}, & \\frac{\\Delta t \\Delta x}{\\Delta y}, & \\frac{\\Delta t \\Delta x}{\\Delta y}, & 2 \\Delta t \\left(\\frac{\\Delta y}{\\Delta x} + \\frac{\\Delta x}{\\Delta y}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "一个基本的Rhie-Chow格式虽然有效，但这远非故事的全部。为了在计算中达到最佳性能，稳定化项的强度应能根据局部流动条件自适应地调整。这项高级实践将指导你设计一个自适应的Rhie-Chow系数，并分析数值稳定性与格式精度（截断误差）之间存在的根本性权衡。掌握这种权衡分析是开发高保真CFD代码的一项关键技能 。",
            "id": "3302125",
            "problem": "考虑一个用于计算流体力学 (CFD) 中不可压缩流的均匀一维同位网格，其网格间距 $\\Delta x$ 经无量纲化处理为 $\\Delta x = 1$。面法向速度由单元中心的速度和压力通过 Rhie–Chow (RC) 插值方法构造，以抑制压力-速度解耦现象。设单元索引 $i$ 处的连续性方程离散为 $(u_{i+1/2} - u_{i-1/2})/\\Delta x = 0$。RC 面速度由相邻单元速度的线性平均和一个压差修正项构成，该修正项由无量纲系数 $\\beta$ 除以动量对角元的无量纲表示 $a_m^*$ 进行缩放。假设动量对角元随局部单元雷诺数 $Re_c$ 的变化关系为 $a_m^* = 2 + |Re_c|$，这反映了一维中心差分离散中扩散和对流贡献的组合。设局部单元佩克莱数为 $Pe_c = |u| \\Delta x/\\Gamma$，并设 $s_0 \\in (0,1)$ 为用户指定的稳定强度上限。\n\n从离散连续性方程和标准 RC 构造原理（即在线性插值面速度上增加一个基于压差的稳定修正项）出发，并在均匀网格上使用 von Neumann 傅里叶分析：\n\n- 推导 RC 修正项对单元 $i$ 处离散散度算子的贡献，并说明其作用相当于一个按 $\\beta/a_m^*$ 缩放的压力离散拉普拉斯算子。\n- 将严格无量纲的稳定强度 $S_{\\max}$ 定义为 RC 引起的散度在最高可分辨波数（奈奎斯特波数）下的振幅，然后推导 $S_{\\max}$ 关于 $\\beta$ 和 $a_m^*$ 的表达式。\n- 使用离散拉普拉斯算子的泰勒展开，识别由 RC 项引起的主阶截断误差，并将无量纲截断误差系数 $T$ 定义为修正方程中领先高阶导数项的系数。\n\n设计一个自适应律 $\\beta(Re_c, Pe_c)$，方法是要求稳定强度饱和到一个用户定义的目标曲线上，该曲线依赖于局部单元佩克莱数，\n$$\nS_{\\mathrm{des}}(|Pe_c|) = s_0 \\frac{Pe_c^2}{1 + Pe_c^2},\n$$\n从而使得稳定作用在扩散主导区域可忽略不计，而在强对流主导区域接近 $s_0$。也就是说，选择 $\\beta(Re_c,Pe_c)$ 使得对每个单元都有 $S_{\\max} = S_{\\mathrm{des}}(|Pe_c|)$。\n\n你的任务是：\n\n- 根据上述定义从第一性原理出发，推导 $S_{\\max}$ 和 $T$ 关于 $\\beta$ 和 $a_m^*$ 的显式公式。\n- 使用 $S_{\\max} = S_{\\mathrm{des}}(|Pe_c|)$ 的要求，推导 $\\beta(Re_c, Pe_c)$ 的显式闭式表达式，并将 $S_{\\max}(Re_c,Pe_c)$ 和 $T(Re_c,Pe_c)$ 仅用 $Re_c$、$Pe_c$ 和 $s_0$ 表示。\n- 分析你的自适应律所蕴含的 $T$ 与 $S_{\\max}$ 之间的权衡曲线。描述其斜率的特征，并判断它是否依赖于 $Re_c$。\n\n所有量都是无量纲的，因此不需要物理单位。如果在推导中出现角度，必须以弧度为单位，但你的最终公式应该不含角度。\n\n测试套件和要求的程序输出：\n\n- 在一个程序中实现你推导的公式，对于每个参数三元组 $(Re_c, Pe_c, s_0)$，该程序返回三元组 $[\\beta, S_{\\max}, T]$。\n- 使用以下参数三元组测试套件：\n  - $(Re_c, Pe_c, s_0) = (0.0, 0.0, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (0.1, 0.1, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (10.0, 10.0, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (50.0, 1.0, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (10^6, 10^6, 0.8)$\n  - $(Re_c, Pe_c, s_0) = (100.0, 0.0, 0.8)$\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个结果本身是一个包含三个浮点数 $[\\beta, S_{\\max}, T]$ 的列表，四舍五入到6位小数，例如：$[[\\beta_1,S_1,T_1],[\\beta_2,S_2,T_2],\\dots]$。\n\n最终答案必须是一个完整、可运行的程序，该程序以完全指定的格式计算并打印这些结果。",
            "solution": "本问题要求在计算流体力学的背景下，针对一维同位网格，推导和分析一种自适应 Rhie–Chow (RC) 插值格式。分析将使用傅里叶分析和泰勒级数展开来推导该数值格式的关键属性，即其稳定强度和截断误差。随后，将推导 RC 系数 $\\beta$ 的自适应律，以满足指定的稳定目标。\n\n**1. Rhie–Chow 对离散散度的贡献**\n\n在间距 $\\Delta x=1$ 的均匀网格上，索引为 $i$ 的单元处的离散连续性方程为：\n$$ u_{i+1/2} - u_{i-1/2} = 0 $$\n问题描述了 Rhie–Chow 面速度 $u_{i+1/2}$ 是由相邻单元中心速度 ($u_i$, $u_{i+1}$) 的线性平均和一个压差修正项构成的。这对应于标准的 RC 公式：\n$$ u_{i+1/2} = \\frac{u_i + u_{i+1}}{2} - \\frac{\\beta}{a_m^*} (p_{i+1} - p_i) $$\n这里我们使用了给定的网格间距 $\\Delta x = 1$。量 $\\beta$ 和 $a_m^*$ 分别是无量纲 RC 系数和动量方程对角元，在本分析中被视为局部常数。\n\n单元左侧面的速度 $u_{i-1/2}$ 可类似地定义为：\n$$ u_{i-1/2} = \\frac{u_{i-1} + u_i}{2} - \\frac{\\beta}{a_m^*} (p_i - p_{i-1}) $$\n将这些面速度的表达式代入离散连续性方程，得到：\n$$ \\left( \\frac{u_i + u_{i+1}}{2} - \\frac{\\beta}{a_m^*} (p_{i+1} - p_i) \\right) - \\left( \\frac{u_{i-1} + u_i}{2} - \\frac{\\beta}{a_m^*} (p_i - p_{i-1}) \\right) = 0 $$\n合并并重排各项，我们分离出速度和压力的贡献：\n$$ \\frac{u_{i+1} - u_{i-1}}{2} - \\frac{\\beta}{a_m^*} \\left[ (p_{i+1} - p_i) - (p_i - p_{i-1}) \\right] = 0 $$\n这可以写成：\n$$ \\frac{u_{i+1} - u_{i-1}}{2} - \\frac{\\beta}{a_m^*} (p_{i+1} - 2p_i + p_{i-1}) = 0 $$\n第一项 $\\frac{u_{i+1} - u_{i-1}}{2\\Delta x}$（其中 $\\Delta x=1$）表示在单元 $i$ 处速度散度 $\\nabla \\cdot \\mathbf{u}$ 的标准中心差分近似。第二项是来自 RC 插值的贡献，我们将其表示为 $D_{RC}(p)_i$：\n$$ D_{RC}(p)_i = - \\frac{\\beta}{a_m^*} (p_{i+1} - 2p_i + p_{i-1}) $$\n表达式 $(p_{i+1} - 2p_i + p_{i-1})$ 是一维拉普拉斯算子 $\\frac{d^2p}{dx^2}$ 按 $\\Delta x^2$ 缩放后的标准二阶有限差分近似。由于 $\\Delta x=1$，该项恰好是单元 $i$ 处压力的离散拉普拉斯算子。因此，RC 修正项在连续性方程中引入了一个项，其作用相当于一个按因子 $-\\beta/a_m^*$ 缩放的压力场离散拉普拉斯算子。\n\n**2. 稳定强度 ($S_{\\max}$)**\n\n为了分析 RC 引起的稳定项的性质，我们进行 von Neumann（傅里叶）分析。我们考虑算子对压力的单个傅里叶模式 $p_j = \\hat{p} e^{I k x_j}$ 的影响，其中 $x_j = j\\Delta x = j$，$k$ 是波数，$I = \\sqrt{-1}$。将离散拉普拉斯算子应用于此模式，得到：\n$$ p_{j+1} - 2p_j + p_{j-1} = \\hat{p}e^{Ikj}(e^{Ik} - 2 + e^{-Ik}) = \\hat{p}e^{Ikj}(2\\cos(k) - 2) $$\n因此，离散拉普拉斯算子的傅里叶符号是 $2(\\cos(k)-1)$。整个 RC 贡献 $D_{RC}(p)$ 的傅里叶符号是：\n$$ \\widehat{D_{RC}(p)} = - \\frac{\\beta}{a_m^*} [2(\\cos(k)-1)] = \\frac{2\\beta}{a_m^*}(1 - \\cos(k)) $$\n稳定强度 $S(k)$ 定义为该算子在傅里叶空间中的振幅。假设 $\\beta > 0$ 和 $a_m^* > 0$：\n$$ S(k) = \\frac{2\\beta}{a_m^*} (1 - \\cos(k)) $$\n最大稳定强度 $S_{\\max}$ 出现在网格上最高可分辨的波数处，即奈奎斯特频率 $k = \\pi / \\Delta x = \\pi$。在此波数下，对应于最高频率的“棋盘”模式，我们有：\n$$ S_{\\max} = S(\\pi) = \\frac{2\\beta}{a_m^*} (1 - \\cos(\\pi)) = \\frac{2\\beta}{a_m^*} (1 - (-1)) = \\frac{4\\beta}{a_m^*} $$\n\n**3. 截断误差系数 ($T$)**\n\n截断误差通过使用泰勒级数展开将离散算子与其连续对应项进行比较来确定。将 $p(x_i \\pm \\Delta x)$ 在 $x_i$ 附近展开：\n$$ p_{i\\pm1} = p_i \\pm p'_i \\Delta x + \\frac{p''_i}{2} \\Delta x^2 \\pm \\frac{p'''_i}{6} \\Delta x^3 + \\frac{p''''_i}{24} \\Delta x^4 + O(\\Delta x^5) $$\n将这些展开式代入离散拉普拉斯表达式（其中 $\\Delta x=1$）：\n$$ p_{i+1} - 2p_i + p_{i-1} = \\left(p_i'' + \\frac{p''''_i}{12} + O(\\Delta x^4)\\right) \\Delta x^2 = \\frac{d^2p}{dx^2} + \\frac{1}{12}\\frac{d^4p}{dx^4} + O(\\Delta x^4) $$\n因此，RC 贡献 $D_{RC}(p)_i$ 可以写成一个微分算子加上高阶项的形式：\n$$ D_{RC}(p)_i = - \\frac{\\beta}{a_m^*} \\left( \\frac{d^2p}{dx^2} + \\frac{1}{12}\\frac{d^4p}{dx^4} + \\dots \\right) $$\n主阶截断误差是展开式中超出预期连续算子的第一项。在这里，它是涉及四阶导数的项：\n$$ \\text{Truncation Error} = - \\frac{\\beta}{12 a_m^*} \\frac{d^4p}{dx^4} $$\n无量纲截断误差系数 $T$ 定义为此领先高阶导数项系数的绝对值：\n$$ T = \\left| - \\frac{\\beta}{12 a_m^*} \\right| = \\frac{\\beta}{12 a_m^*} $$\n\n**4. 自适应律和推导的公式**\n\n问题通过要求最大稳定强度 $S_{\\max}$ 匹配一个期望的目标曲线 $S_{\\mathrm{des}}(|Pe_c|)$ 来指定 $\\beta$ 的自适应律：\n$$ S_{\\max} = S_{\\mathrm{des}}(|Pe_c|) = s_0 \\frac{Pe_c^2}{1 + Pe_c^2} $$\n使用我们推导出的 $S_{\\max}$ 公式以及给定的动量对角元表达式 $a_m^* = 2 + |Re_c|$，我们可以求解 $\\beta$。由于 $Re_c$ 是一个非负参数，我们用 $Re_c$ 代替 $|Re_c|$。\n$$ \\frac{4\\beta}{2 + Re_c} = s_0 \\frac{Pe_c^2}{1 + Pe_c^2} $$\n求解 $\\beta(Re_c, Pe_c)$：\n$$ \\beta(Re_c, Pe_c) = \\frac{s_0 (2 + Re_c)}{4} \\frac{Pe_c^2}{1 + Pe_c^2} $$\n这是自适应 RC 系数的闭式表达式。\n\n根据该定律，根据定义，$S_{\\max}$ 等于 $S_{\\mathrm{des}}$：\n$$ S_{\\max}(Re_c, Pe_c) = s_0 \\frac{Pe_c^2}{1 + Pe_c^2} $$\n为了求出此自适应律下的截断误差系数 $T$，我们将 $\\beta$ 和 $a_m^*$ 的表达式代入 $T$ 的公式中：\n$$ T = \\frac{\\beta}{12 a_m^*} = \\frac{1}{12(2 + Re_c)} \\left( \\frac{s_0 (2 + Re_c)}{4} \\frac{Pe_c^2}{1 + Pe_c^2} \\right) $$\n项 $(2 + Re_c)$ 被消去，得到：\n$$ T(Re_c, Pe_c) = \\frac{s_0}{48} \\frac{Pe_c^2}{1 + Pe_c^2} $$\n\n**5. $T$ 与 $S_{\\max}$ 权衡分析**\n\n从推导出的 $S_{\\max}$ 和 $T$ 的表达式，我们可以建立它们之间的直接关系：\n$$ S_{\\max} = s_0 \\frac{Pe_c^2}{1 + Pe_c^2} \\quad \\implies \\quad \\frac{Pe_c^2}{1 + Pe_c^2} = \\frac{S_{\\max}}{s_0} $$\n将此代入 $T$ 的表达式中：\n$$ T = \\frac{s_0}{48} \\left( \\frac{S_{\\max}}{s_0} \\right) = \\frac{S_{\\max}}{48} $$\n这个结果 $T = S_{\\max}/48$ 揭示了此数值格式中固有的一个基本权衡关系。该关系是线性的，意味着引入的四阶截断误差量与施加的稳定量成正比。权衡曲线的斜率 $dT/dS_{\\max}$ 是一个常数：\n$$ \\frac{dT}{dS_{\\max}} = \\frac{1}{48} $$\n该斜率与物理参数 $Re_c$ 和 $Pe_c$ 无关，也与用户定义的参数 $s_0$ 无关。这种固定关系是 RC 公式中所选的压力拉普拉斯算子二阶中心差分模板的一个结构属性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the adaptive Rhie-Chow coefficient (beta), maximum stabilization\n    strength (S_max), and truncation error coefficient (T) for a set of\n    test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.0, 0.0, 0.8),\n        (0.1, 0.1, 0.8),\n        (10.0, 10.0, 0.8),\n        (50.0, 1.0, 0.8),\n        (1e6, 1e6, 0.8),\n        (100.0, 0.0, 0.8),\n    ]\n\n    results = []\n    for case in test_cases:\n        Rec, Pec, s0 = case\n        \n        # Ensure Rec and Pec are non-negative as per their definitions\n        Rec = abs(Rec)\n        Pec = abs(Pec)\n\n        # The Peclet number term appears in all calculations.\n        if 1.0 + Pec**2 == 0: # Avoid division by zero, though impossible for real Pec\n            pec_term = 0.0\n        else:\n            pec_term = Pec**2 / (1.0 + Pec**2)\n\n        # 1. Calculate S_max(Rec, Pec)\n        # S_max = s0 * (Pec^2 / (1 + Pec^2))\n        S_max = s0 * pec_term\n\n        # 2. Calculate beta(Rec, Pec)\n        # beta = (s0 * (2 + Rec) / 4) * (Pec^2 / (1 + Pec^2))\n        beta = (s0 * (2.0 + Rec) / 4.0) * pec_term\n\n        # 3. Calculate T(Rec, Pec)\n        # T = S_max / 48\n        T = S_max / 48.0\n        \n        # Round results to 6 decimal places as required.\n        rounded_beta = round(beta, 6)\n        rounded_S_max = round(S_max, 6)\n        rounded_T = round(T, 6)\n\n        results.append(f\"[{rounded_beta}, {rounded_S_max}, {rounded_T}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}