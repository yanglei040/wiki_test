{
    "hands_on_practices": [
        {
            "introduction": "This problem provides a foundational exercise in analyzing a grid transformation. Before assessing the quality or impact of a grid, you must be able to compute its fundamental geometric properties. This practice guides you through the process of deriving the covariant metric tensor and related quantities like scale factors and aspect ratio directly from an analytical mapping, reinforcing the core concepts from differential geometry used in CFD. ",
            "id": "3327571",
            "problem": "In Computational Fluid Dynamics (CFD), curvilinear grid generation for complex geometries often employs mappings from a computational domain to a physical domain. Consider the $2$-dimensional mapping from computational coordinates $(\\xi,\\eta)$ to Cartesian physical coordinates $\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)$ given by\n$$\n\\mathbf{x}(\\xi,\\eta) = \\big(r(\\xi)\\cos\\eta,\\; r(\\xi)\\sin\\eta\\big), \\quad r(\\xi) = 1 + \\beta\\,\\xi,\n$$\nwith $\\beta0$, $\\xi\\in[0,1]$, and $\\eta\\in[0,2\\pi)$ measured in radians. Using only fundamental definitions from differential geometry of curvilinear coordinates as used in CFD (covariant base vectors, metric tensor, orthogonality criterion, and scale factors), perform the following:\n\n- Starting from the definition of covariant base vectors $\\mathbf{x}_{\\xi}=\\partial\\mathbf{x}/\\partial\\xi$ and $\\mathbf{x}_{\\eta}=\\partial\\mathbf{x}/\\partial\\eta$, derive the covariant metric tensor components $g_{ij}=\\mathbf{x}_{i}\\cdot\\mathbf{x}_{j}$ for $i,j\\in\\{\\xi,\\eta\\}$ in terms of $\\beta$, $\\xi$, and $\\eta$.\n- Using the definition of orthogonality in curvilinear coordinates, determine whether the coordinate lines are orthogonal and explain how the parameter $\\beta$ influences orthogonality.\n- Define the local cell aspect ratio $A(\\xi,\\eta)$ as the ratio of scale factors $h_{\\eta}/h_{\\xi}$, where $h_{i}=\\sqrt{g_{ii}}$ for $i\\in\\{\\xi,\\eta\\}$. Derive $A(\\xi,\\eta)$ in terms of $\\beta$ and $\\xi$, and interpret how variations in $\\beta$ modify the aspect ratio distribution across the grid.\n\nReport as your final answer only the closed-form analytic expression for the aspect ratio $A(\\xi)$ in terms of $\\beta$ and $\\xi$. No numerical evaluation is required, and no rounding applies. Do not include units in the final answer.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary information is provided, and the tasks are well-defined within the standard framework of differential geometry as applied to computational fluid dynamics. The solution proceeds as follows.\n\nThe problem provides a $2$-dimensional mapping from computational coordinates $(\\xi, \\eta)$ to physical Cartesian coordinates $\\mathbf{x}(\\xi, \\eta) = (x(\\xi, \\eta), y(\\xi, \\eta))$. The mapping is given by:\n$$\n\\mathbf{x}(\\xi, \\eta) = \\big(r(\\xi)\\cos\\eta, r(\\xi)\\sin\\eta\\big)\n$$\nwhere $r(\\xi) = 1 + \\beta\\xi$, with the constraints $\\beta  0$, $\\xi \\in [0, 1]$, and $\\eta \\in [0, 2\\pi)$.\n\nFirst, we derive the covariant metric tensor components $g_{ij}$. This requires the calculation of the covariant base vectors, $\\mathbf{x}_{\\xi}$ and $\\mathbf{x}_{\\eta}$, which are the partial derivatives of the position vector $\\mathbf{x}$ with respect to the computational coordinates.\n\nThe position vector is $\\mathbf{x}(\\xi, \\eta) = (x(\\xi, \\eta), y(\\xi, \\eta)) = \\big((1+\\beta\\xi)\\cos\\eta, (1+\\beta\\xi)\\sin\\eta\\big)$.\n\nThe partial derivative with respect to $\\xi$ is:\n$$\n\\mathbf{x}_{\\xi} = \\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\left( \\frac{\\partial}{\\partial \\xi} \\big((1+\\beta\\xi)\\cos\\eta\\big), \\frac{\\partial}{\\partial \\xi} \\big((1+\\beta\\xi)\\sin\\eta\\big) \\right)\n$$\n$$\n\\mathbf{x}_{\\xi} = (\\beta\\cos\\eta, \\beta\\sin\\eta)\n$$\n\nThe partial derivative with respect to $\\eta$ is:\n$$\n\\mathbf{x}_{\\eta} = \\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\left( \\frac{\\partial}{\\partial \\eta} \\big((1+\\beta\\xi)\\cos\\eta\\big), \\frac{\\partial}{\\partial \\eta} \\big((1+\\beta\\xi)\\sin\\eta\\big) \\right)\n$$\n$$\n\\mathbf{x}_{\\eta} = \\big(-(1+\\beta\\xi)\\sin\\eta, (1+\\beta\\xi)\\cos\\eta\\big)\n$$\n\nNext, we compute the components of the covariant metric tensor, $g_{ij} = \\mathbf{x}_{i} \\cdot \\mathbf{x}_{j}$, for $i, j \\in \\{\\xi, \\eta\\}$.\n\nThe component $g_{\\xi\\xi}$ is:\n$$\ng_{\\xi\\xi} = \\mathbf{x}_{\\xi} \\cdot \\mathbf{x}_{\\xi} = (\\beta\\cos\\eta)^2 + (\\beta\\sin\\eta)^2 = \\beta^2\\cos^2\\eta + \\beta^2\\sin^2\\eta = \\beta^2(\\cos^2\\eta + \\sin^2\\eta) = \\beta^2\n$$\n\nThe component $g_{\\eta\\eta}$ is:\n$$\ng_{\\eta\\eta} = \\mathbf{x}_{\\eta} \\cdot \\mathbf{x}_{\\eta} = \\big(-(1+\\beta\\xi)\\sin\\eta\\big)^2 + \\big((1+\\beta\\xi)\\cos\\eta\\big)^2 = (1+\\beta\\xi)^2\\sin^2\\eta + (1+\\beta\\xi)^2\\cos^2\\eta\n$$\n$$\ng_{\\eta\\eta} = (1+\\beta\\xi)^2(\\sin^2\\eta + \\cos^2\\eta) = (1+\\beta\\xi)^2\n$$\n\nThe off-diagonal component $g_{\\xi\\eta}$ is:\n$$\ng_{\\xi\\eta} = \\mathbf{x}_{\\xi} \\cdot \\mathbf{x}_{\\eta} = (\\beta\\cos\\eta)\\big(-(1+\\beta\\xi)\\sin\\eta\\big) + (\\beta\\sin\\eta)\\big((1+\\beta\\xi)\\cos\\eta\\big)\n$$\n$$\ng_{\\xi\\eta} = -\\beta(1+\\beta\\xi)\\cos\\eta\\sin\\eta + \\beta(1+\\beta\\xi)\\sin\\eta\\cos\\eta = 0\n$$\nSince the metric tensor is symmetric, $g_{\\eta\\xi} = g_{\\xi\\eta} = 0$.\n\nThus, the covariant metric tensor components are:\n$$\ng_{\\xi\\xi} = \\beta^2, \\quad g_{\\eta\\eta} = (1+\\beta\\xi)^2, \\quad g_{\\xi\\eta} = g_{\\eta\\xi} = 0\n$$\n\nThe second task is to determine if the coordinate lines are orthogonal. A curvilinear coordinate system is orthogonal if and only if the off-diagonal components of its metric tensor are zero. In this case, we have found that $g_{\\xi\\eta} = g_{\\eta\\xi} = 0$ for all values of $\\xi$ and $\\eta$ in their respective domains. This means the base vectors $\\mathbf{x}_{\\xi}$ and $\\mathbf{x}_{\\eta}$ are orthogonal at every point. Therefore, the coordinate lines (lines of constant $\\xi$ and lines of constant $\\eta$) are orthogonal throughout the grid. The parameter $\\beta$, being a positive constant, affects the magnitude of $\\mathbf{x}_{\\xi}$ but does not alter the fact that $g_{\\xi\\eta}=0$. Consequently, the coordinate system is orthogonal for any $\\beta  0$, and $\\beta$ has no influence on the orthogonality property itself. Geometrically, lines of constant $\\xi$ are circles, and lines of constant $\\eta$ are radial lines, which are always mutually orthogonal.\n\nThe third task is to derive the local cell aspect ratio, defined as $A(\\xi, \\eta) = h_{\\eta}/h_{\\xi}$. The scale factors (or Lamé coefficients) $h_i$ are defined as $h_i = \\sqrt{g_{ii}}$.\n\nThe scale factor $h_{\\xi}$ is:\n$$\nh_{\\xi} = \\sqrt{g_{\\xi\\xi}} = \\sqrt{\\beta^2} = |\\beta|\n$$\nGiven that $\\beta  0$, we have $h_{\\xi} = \\beta$.\n\nThe scale factor $h_{\\eta}$ is:\n$$\nh_{\\eta} = \\sqrt{g_{\\eta\\eta}} = \\sqrt{(1+\\beta\\xi)^2} = |1+\\beta\\xi|\n$$\nGiven that $\\beta  0$ and $\\xi \\in [0, 1]$, the term $1+\\beta\\xi$ is strictly positive, so $|1+\\beta\\xi| = 1+\\beta\\xi$. Thus, $h_{\\eta} = 1+\\beta\\xi$.\n\nNow, we can compute the aspect ratio $A(\\xi, \\eta)$:\n$$\nA(\\xi, \\eta) = \\frac{h_{\\eta}}{h_{\\xi}} = \\frac{1+\\beta\\xi}{\\beta}\n$$\nThe expression for the aspect ratio depends only on $\\xi$ and $\\beta$, not on $\\eta$. We can therefore write it as $A(\\xi)$.\n$$\nA(\\xi) = \\frac{1+\\beta\\xi}{\\beta} = \\frac{1}{\\beta} + \\xi\n$$\nTo interpret the influence of $\\beta$, we examine this expression. The aspect ratio $A(\\xi)$ represents the ratio of the local arc length in the $\\eta$-direction (azimuthal) to the local length in the $\\xi$-direction (radial).\n- For a fixed $\\beta$, $A(\\xi)$ increases linearly with $\\xi$. At the inner boundary ($\\xi=0$), $A(0) = 1/\\beta$. At the outer boundary ($\\xi=1$), $A(1) = (1+\\beta)/\\beta = 1/\\beta + 1$. This indicates that grid cells become progressively more stretched in the azimuthal direction as one moves radially outward.\n- For a small $\\beta  0$, the value of $1/\\beta$ is large. This results in a large aspect ratio across the entire domain, meaning the cells are highly elongated in the $\\eta$-direction. This corresponds to a narrow annulus where the radial grid spacing (proportional to $\\beta$) is much smaller than the azimuthal spacing (proportional to $r(\\xi)=1+\\beta\\xi \\approx 1$).\n- For a large $\\beta$, the value of $1/\\beta$ is small. The aspect ratio starts near zero at $\\xi=0$ ($A(0) = 1/\\beta \\to 0$) and approaches $1$ as $\\xi$ increases. This means cells near the inner boundary are stretched in the radial direction, and they become more isotropic (squarer) towards the outer boundary. A large $\\beta$ corresponds to a wide annulus with significant radial stretching.\n\nThe final requested quantity is the closed-form analytic expression for the aspect ratio $A(\\xi)$.",
            "answer": "$$\\boxed{\\frac{1 + \\beta \\xi}{\\beta}}$$"
        },
        {
            "introduction": "Understanding grid geometry is the first step; the next is analyzing its impact on the governing equations. This exercise demonstrates how grid non-orthogonality manifests as challenging cross-derivative terms in the transformed diffusion equation. By connecting the analytical derivation to a quantitative numerical analysis, you will gain insight into how grid skewness can degrade the accuracy and stability of a numerical scheme. ",
            "id": "3327534",
            "problem": "Consider the two-dimensional ($2$-D) diffusion of a scalar field $u(x,y,t)$ governed by the standard diffusion equation from first principles, which states that the rate of change of $u$ is proportional to the divergence of its gradient: $\\frac{\\partial u}{\\partial t} = \\nu \\nabla^{2} u$, where $\\nu$ is the diffusion coefficient. In Computational Fluid Dynamics (CFD), solving this equation on complex geometries often requires transformations from physical coordinates $(x,y)$ to computational coordinates $(\\xi,\\eta)$, which introduce metric terms and, for non-orthogonal grids, cross-derivative contributions. Starting from the chain rule for multivariable functions and the definition of the gradient and Laplacian, derive the general form of the transformed diffusion operator in $(\\xi,\\eta)$ that involves covariant and contravariant metric tensors and the Jacobian determinant. Then specialize to a skewed affine map that models non-orthogonality: $x(\\xi,\\eta) = \\xi + \\alpha \\eta$ and $y(\\xi,\\eta) = \\eta$, where $\\alpha$ is a dimensionless skew parameter. From this specialization, identify the cross-derivative contribution introduced by non-orthogonality and its coefficient.\n\nNext, design a simple numerical diffusion test using a uniform computational grid with spacing $h$ (in meters), central-difference approximations, and a single time step of the explicit Forward Euler method with timestep $\\Delta t$ (in seconds). Assume a Fourier mode on the computational grid with wavenumbers $k_{\\xi}$ and $k_{\\eta}$ (angles must be given in radians). Using well-tested discrete Fourier analysis for central differences, the discrete second derivative operators along $\\xi$, $\\eta$, and the mixed derivative $\\xi\\eta$ each have known Fourier-mode eigenvalues that depend on $k_{\\xi}$, $k_{\\eta}$, and $h$. Using these, compute the discrete amplification factor for one Forward Euler step on the orthogonal grid (baseline case with $\\alpha = 0$) and on the skewed grid (non-orthogonal case with $\\alpha \\neq 0$). Define the relative amplification error ratio $R$ as the change in the numerical damping due to non-orthogonality, normalized by the baseline damping:\n$$\nR \\equiv \\frac{G_{\\alpha} - G_{0}}{G_{0} - 1},\n$$\nwhere $G_{0}$ is the amplification factor for the orthogonal grid and $G_{\\alpha}$ is the amplification factor for the non-orthogonal grid.\n\nYour program must implement this analysis and produce numerical values of $R$ for the following test suite. Each parameter set is a tuple $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t)$, where $h$ is in meters, $\\nu$ is in $\\mathrm{m}^{2}/\\mathrm{s}$, and angles $k_{\\xi}$ and $k_{\\eta}$ are in radians:\n- Test $1$ (baseline orthogonal case): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.0,\\pi/3,\\pi/3,1.0,0.1,0.05)$.\n- Test $2$ (mild skew, equal modes): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.2,\\pi/3,\\pi/3,1.0,0.1,0.05)$.\n- Test $3$ (moderate skew, unequal modes): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.5,\\pi/6,\\pi/3,1.0,0.1,0.05)$.\n- Test $4$ (strong skew, high wavenumbers): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.9,\\pi/2,\\pi/2,1.0,0.05,0.02)$.\n- Test $5$ (skew with one direction constant, edge case): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.7,\\pi/3,0.0,1.0,0.1,0.05)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_{1},r_{2},r_{3},r_{4},r_{5}]$), where each $r_{i}$ is the computed float value of $R$ for the corresponding test case. Angles must be treated in radians, and all intermediate quantities must be computed consistently with the specified physical units. The output floats are dimensionless by construction.",
            "solution": "The problem statement has been analyzed and is determined to be valid. It is scientifically grounded in the principles of continuum mechanics, tensor calculus, and numerical analysis. The setup is self-contained, consistent, and well-posed, providing all necessary information to derive a unique solution.\n\nThe solution proceeds in three stages:\n$1$. Derivation of the general transformed diffusion operator.\n$2$. Specialization of the operator for the given skewed affine coordinate transformation.\n$3$. Numerical analysis of the discretized equation to derive the relative amplification error ratio, $R$.\n\n**$1$. Transformation of the Diffusion Operator**\n\nThe starting point is the $2$-D diffusion equation in physical Cartesian coordinates $(x,y)$:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\nabla^2 u = \\nu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\nWe consider a transformation to a general computational coordinate system $(\\xi^1, \\xi^2) \\equiv (\\xi, \\eta)$. The relationship is given by $x(\\xi, \\eta)$ and $y(\\xi, \\eta)$. The chain rule for partial derivatives gives:\n$$\n\\frac{\\partial}{\\partial \\xi^i} = \\frac{\\partial x^k}{\\partial \\xi^i} \\frac{\\partial}{\\partial x^k}\n$$\nwhere summation over the repeated index $k \\in \\{1,2\\}$ is implied, with $(x^1, x^2) \\equiv (x,y)$. This relates the gradient operators in the two coordinate systems.\n\nA standard result from tensor calculus states that the Laplacian operator $\\nabla^2$ transforms as:\n$$\n\\nabla^2 u = \\frac{1}{J} \\frac{\\partial}{\\partial \\xi^i} \\left( J g^{ij} \\frac{\\partial u}{\\partial \\xi^j} \\right)\n$$\nwhere summation is implied over $i,j \\in \\{1,2\\}$. Here, $J$ is the Jacobian determinant of the transformation and $g^{ij}$ are the components of the contravariant metric tensor.\n\nThe Jacobian matrix $\\mathbf{J}$ and its determinant $J$ are:\n$$\n\\mathbf{J} = \\begin{pmatrix} x_\\xi  x_\\eta \\\\ y_\\xi  y_\\eta \\end{pmatrix}, \\quad J = \\det(\\mathbf{J}) = x_\\xi y_\\eta - x_\\eta y_\\xi\n$$\nwhere subscripts denote partial differentiation (e.g., $x_\\xi = \\partial x/\\partial \\xi$).\n\nThe covariant metric tensor, $\\mathbf{G} = [g_{ij}]$, is defined by $\\mathbf{G} = \\mathbf{J}^T \\mathbf{J}$:\n$$\ng_{ij} = \\frac{\\partial x^k}{\\partial \\xi^i} \\frac{\\partial x^k}{\\partial \\xi^j} \\implies \\mathbf{G} = \\begin{pmatrix} x_\\xi^2+y_\\xi^2  x_\\xi x_\\eta + y_\\xi y_\\eta \\\\ x_\\xi x_\\eta + y_\\xi y_\\eta  x_\\eta^2+y_\\eta^2 \\end{pmatrix}\n$$\nThe contravariant metric tensor, $\\mathbf{G}^{-1} = [g^{ij}]$, is the matrix inverse of $\\mathbf{G}$. It can be shown that $\\det(\\mathbf{G}) = J^2$, leading to:\n$$\n[g^{ij}] = \\frac{1}{J^2} \\begin{pmatrix} g_{22}  -g_{12} \\\\ -g_{21}  g_{11} \\end{pmatrix} = \\frac{1}{J^2} \\begin{pmatrix} x_\\eta^2+y_\\eta^2  -(x_\\xi x_\\eta + y_\\xi y_\\eta) \\\\ -(x_\\xi x_\\eta + y_\\xi y_\\eta)  x_\\xi^2+y_\\xi^2 \\end{pmatrix}\n$$\n\n**$2$. Specialization to the Skewed Affine Map**\n\nThe problem specifies the skewed affine map:\n$$\nx(\\xi, \\eta) = \\xi + \\alpha \\eta, \\quad y(\\xi, \\eta) = \\eta\n$$\nWe compute the partial derivatives:\n$$\nx_\\xi = 1, \\quad x_\\eta = \\alpha, \\quad y_\\xi = 0, \\quad y_\\eta = 1\n$$\nThe Jacobian determinant is:\n$$\nJ = x_\\xi y_\\eta - x_\\eta y_\\xi = (1)(1) - (\\alpha)(0) = 1\n$$\nSince the Jacobian and all metric coefficients derived from it will be constant, the transformed Laplacian simplifies. The general form $\\frac{1}{J} \\frac{\\partial}{\\partial \\xi^i} (J g^{ij} \\frac{\\partial u}{\\partial \\xi^j})$ becomes $g^{ij} \\frac{\\partial^2 u}{\\partial \\xi^i \\partial \\xi^j}$ because $J$ and $g^{ij}$ are constant.\n\nThe components of the contravariant metric tensor $[g^{ij}]$ are:\n$$\ng^{11} = \\frac{1}{J^2}(x_\\eta^2 + y_\\eta^2) = \\frac{1}{1^2}(\\alpha^2 + 1^2) = 1 + \\alpha^2\n$$\n$$\ng^{22} = \\frac{1}{J^2}(x_\\xi^2 + y_\\xi^2) = \\frac{1}{1^2}(1^2 + 0^2) = 1\n$$\n$$\ng^{12} = g^{21} = -\\frac{1}{J^2}(x_\\xi x_\\eta + y_\\xi y_\\eta) = -\\frac{1}{1^2}((1)(\\alpha) + (0)(1)) = -\\alpha\n$$\nSubstituting these into the simplified Laplacian expression:\n$$\n\\nabla^2 u = g^{11} \\frac{\\partial^2 u}{\\partial \\xi^2} + g^{22} \\frac{\\partial^2 u}{\\partial \\eta^2} + 2g^{12} \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}\n$$\n$$\n\\nabla^2 u = (1+\\alpha^2) \\frac{\\partial^2 u}{\\partial \\xi^2} + \\frac{\\partial^2 u}{\\partial \\eta^2} - 2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}\n$$\nThe non-orthogonality, represented by $\\alpha \\neq 0$, introduces the cross-derivative term $-2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}$, with a coefficient of $-2\\alpha$.\n\n**$3$. Numerical Amplification Factor Analysis**\n\nThe transformed diffusion equation is:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\left( (1+\\alpha^2) \\frac{\\partial^2 u}{\\partial \\xi^2} - 2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta} + \\frac{\\partial^2 u}{\\partial \\eta^2} \\right)\n$$\nWe discretize this equation using Forward Euler in time and second-order central differences in space on a uniform grid with spacing $\\Delta\\xi = \\Delta\\eta = h$. A Fourier mode $u^n_{i,j} = \\hat{u}^n e^{I(k_\\xi i h + k_\\eta j h)}$ is substituted into the discretized equation to find the amplification factor $G = \\hat{u}^{n+1}/\\hat{u}^n$.\n\nThe discrete spatial operators have the following Fourier eigenvalues (symbols):\n- $\\delta^2_\\xi u \\to \\lambda_{\\xi\\xi} \\hat{u}$, where $\\lambda_{\\xi\\xi} = \\frac{-4}{h^2}\\sin^2(k_\\xi h/2)$\n- $\\delta^2_\\eta u \\to \\lambda_{\\eta\\eta} \\hat{u}$, where $\\lambda_{\\eta\\eta} = \\frac{-4}{h^2}\\sin^2(k_\\eta h/2)$\n- $\\delta_{\\xi\\eta} u \\to \\lambda_{\\xi\\eta} \\hat{u}$, where $\\lambda_{\\xi\\eta} = -\\frac{1}{h^2}\\sin(k_\\xi h)\\sin(k_\\eta h)$\n\nApplying the Forward Euler scheme $u^{n+1} = u^n + \\Delta t (\\text{RHS})^n$ and substituting the Fourier modes and eigenvalues, we get:\n$$\n\\hat{u}^{n+1} = \\hat{u}^n + \\nu \\Delta t \\left[ (1+\\alpha^2) \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta} + \\lambda_{\\eta\\eta} \\right] \\hat{u}^n\n$$\nThe amplification factor for a given skewness $\\alpha$, denoted $G_\\alpha$, is:\n$$\nG_\\alpha = 1 + \\nu \\Delta t \\left[ (1+\\alpha^2)\\lambda_{\\xi\\xi} - 2\\alpha\\lambda_{\\xi\\eta} + \\lambda_{\\eta\\eta} \\right]\n$$\nFor the orthogonal case ($\\alpha=0$), the amplification factor $G_0$ is:\n$$\nG_0 = 1 + \\nu \\Delta t \\left[ \\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta} \\right]\n$$\nThe relative amplification error ratio $R$ is defined as:\n$$\nR \\equiv \\frac{G_{\\alpha} - G_{0}}{G_{0} - 1}\n$$\nThe numerator is:\n$$\nG_\\alpha - G_0 = \\nu \\Delta t \\left[ (\\alpha^2) \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta} \\right]\n$$\nThe denominator is:\n$$\nG_0 - 1 = \\nu \\Delta t \\left[ \\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta} \\right]\n$$\nThe term $\\nu \\Delta t$ cancels, showing that $R$ measures a structural property of the spatial discretization:\n$$\nR = \\frac{\\alpha^2 \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta}}{\\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta}}\n$$\nSubstituting the expressions for the eigenvalues:\n$$\nR = \\frac{\\alpha^2 \\frac{-4}{h^2}\\sin^2(\\frac{k_\\xi h}{2}) - 2\\alpha \\left(-\\frac{1}{h^2}\\sin(k_\\xi h)\\sin(k_\\eta h)\\right)}{\\frac{-4}{h^2}\\sin^2(\\frac{k_\\xi h}{2}) + \\frac{-4}{h^2}\\sin^2(\\frac{k_\\eta h}{2})}\n$$\nSimplifying by canceling the common factor $-1/h^2$ and dividing numerator and denominator by $4$:\n$$\nR = \\frac{4\\alpha^2 \\sin^2(k_\\xi h/2) - 2\\alpha \\sin(k_\\xi h)\\sin(k_\\eta h)}{4\\sin^2(k_\\xi h/2) + 4\\sin^2(k_\\eta h/2)}\n$$\nUsing the identity $\\sin(x) = 2\\sin(x/2)\\cos(x/2)$, we can write:\n$$\nR = \\frac{4\\alpha^2 \\sin^2(k_\\xi h/2) - 8\\alpha \\sin(k_\\xi h/2)\\cos(k_\\xi h/2)\\sin(k_\\eta h/2)\\cos(k_\\eta h/2)}{4\\left(\\sin^2(k_\\xi h/2) + \\sin^2(k_\\eta h/2)\\right)}\n$$\nLetting $\\theta_\\xi = k_\\xi h/2$ and $\\theta_\\eta = k_\\eta h/2$, the final expression for implementation is:\n$$\nR = \\frac{\\alpha^2 \\sin^2(\\theta_\\xi) - 2\\alpha \\sin(\\theta_\\xi)\\cos(\\theta_\\xi)\\sin(\\theta_\\eta)\\cos(\\theta_\\eta)}{\\sin^2(\\theta_\\xi) + \\sin^2(\\theta_\\eta)}\n$$\nThis formula is implemented for the provided test cases. For the case where the denominator is zero (i.e., $k_\\xi h$ and $k_\\eta h$ are both multiples of $2\\pi$), the numerator is also zero, yielding an indeterminate form $0/0$. In this scenario of zero numerical damping, the ratio $R$ is taken to be $0$, as there is no damping error to measure.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_r(alpha, k_xi, k_eta, h):\n    \"\"\"\n    Computes the relative amplification error ratio R.\n\n    The formula for R is derived from the Fourier analysis of the\n    central-differenced diffusion equation on a skewed affine grid.\n    The ratio R is independent of the diffusion coefficient nu and\n    the time step dt.\n\n    Args:\n        alpha (float): Dimensionless skew parameter.\n        k_xi (float): Wavenumber in the xi-direction (in radians for angle-like quantity).\n        k_eta (float): Wavenumber in the eta-direction (in radians for angle-like quantity).\n        h (float): Uniform grid spacing.\n\n    Returns:\n        float: The calculated value of the relative amplification error ratio R.\n    \"\"\"\n    theta_xi = k_xi * h / 2.0\n    theta_eta = k_eta * h / 2.0\n\n    sin_theta_xi = np.sin(theta_xi)\n    sin_theta_eta = np.sin(theta_eta)\n\n    denominator = sin_theta_xi**2 + sin_theta_eta**2\n\n    # If the denominator is close to zero, it means the numerical damping for the\n    # orthogonal grid is zero (G_0 = 1). This occurs for wavenumbers that are\n    # not resolved by the grid (e.g., k_xi*h=0, k_eta*h=0). In this 0/0 case,\n    # the relative error is conceptually zero.\n    if np.isclose(denominator, 0.0):\n        return 0.0\n\n    cos_theta_xi = np.cos(theta_xi)\n    cos_theta_eta = np.cos(theta_eta)\n    \n    # Numerator corresponds to the change in damping due to skewness.\n    # It contains terms proportional to alpha and alpha^2.\n    numerator = (alpha**2 * sin_theta_xi**2 -\n                 2 * alpha * sin_theta_xi * cos_theta_xi * sin_theta_eta * cos_theta_eta)\n    \n    # Using the identity sin(2x) = 2sin(x)cos(x), an alternative form for the\n    # second term in the numerator is -alpha * sin(k_xi*h) * sin(k_eta*h) / 2,\n    # which is used in some derivations. The current form is direct.\n    \n    r = numerator / denominator\n    return r\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (alpha, k_xi, k_eta, h, nu, dt).\n    # nu and dt are not used in the final formula for R but are part of the problem spec.\n    test_cases = [\n        # Test 1 (baseline orthogonal case)\n        (0.0, np.pi/3, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 2 (mild skew, equal modes)\n        (0.2, np.pi/3, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 3 (moderate skew, unequal modes)\n        (0.5, np.pi/6, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 4 (strong skew, high wavenumbers)\n        (0.9, np.pi/2, np.pi/2, 1.0, 0.05, 0.02),\n        # Test 5 (skew with one direction constant, edge case)\n        (0.7, np.pi/3, 0.0, 1.0, 0.1, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, k_xi, k_eta, h, nu, dt = case\n        result = compute_r(alpha, k_xi, k_eta, h)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A robust numerical scheme on a curvilinear grid must do more than just accurately discretize the transformed equations; it must also preserve fundamental physical principles. This problem addresses the crucial concept of the Geometric Conservation Law (GCL), which ensures that a numerical scheme correctly handles a uniform flow field. You will explore how the choice of discrete operators and their consistent application to both metric terms and fluxes is essential for achieving exact free-stream preservation. ",
            "id": "3327604",
            "problem": "Consider a smooth, one-to-one mapping from a logically rectangular computational domain with coordinates $\\boldsymbol{\\xi} = (\\xi,\\eta,\\zeta)$ to a physical domain with coordinates $\\boldsymbol{x} = (x,y,z)$ given by the vector function $\\boldsymbol{x}(\\xi,\\eta,\\zeta)$. Let $J = \\det\\left( \\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{\\xi}} \\right)$ denote the Jacobian determinant and let the contravariant vectors be defined by $\\boldsymbol{a}^{\\xi} = \\nabla \\xi$, $\\boldsymbol{a}^{\\eta} = \\nabla \\eta$, and $\\boldsymbol{a}^{\\zeta} = \\nabla \\zeta$. In conservation-law form, a physical-space divergence $\\nabla_{\\boldsymbol{x}} \\cdot \\boldsymbol{F}(\\boldsymbol{U})$ can be mapped to computational space as $\\partial_{\\xi} \\tilde{F}^{\\xi} + \\partial_{\\eta} \\tilde{F}^{\\eta} + \\partial_{\\zeta} \\tilde{F}^{\\zeta}$ with contravariant fluxes $\\tilde{F}^{\\xi} = \\boldsymbol{F} \\cdot (J \\boldsymbol{a}^{\\xi})$, $\\tilde{F}^{\\eta} = \\boldsymbol{F} \\cdot (J \\boldsymbol{a}^{\\eta})$, and $\\tilde{F}^{\\zeta} = \\boldsymbol{F} \\cdot (J \\boldsymbol{a}^{\\zeta})$. It is a well-tested fact that the continuous metric identities hold, namely $\\partial_{\\xi}(J \\boldsymbol{a}^{\\xi}) + \\partial_{\\eta}(J \\boldsymbol{a}^{\\eta}) + \\partial_{\\zeta}(J \\boldsymbol{a}^{\\zeta}) = \\boldsymbol{0}$, which, together with constant $\\boldsymbol{F}$, implies preservation of a uniform free stream.\n\nOn a structured grid with nodal points $(\\xi_i,\\eta_j,\\zeta_k)$ and a finite-difference scheme, let $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$ denote linear, consistent discrete derivative operators approximating $\\partial_{\\xi}$, $\\partial_{\\eta}$, and $\\partial_{\\zeta}$, respectively. Assume smooth grid mappings and boundary treatments for which mixed partial derivatives commute in the continuous setting. The goal is to design a consistent discrete approximation of the metric terms $J \\boldsymbol{a}^{\\xi}$, $J \\boldsymbol{a}^{\\eta}$, and $J \\boldsymbol{a}^{\\zeta}$ that satisfies a discrete analogue of the metric identities and preserves a uniform free stream when $\\boldsymbol{U}$ is constant. You must also justify the requirement to use the same discrete difference operators in both the metric construction and the flux divergence.\n\nWhich of the following discrete constructions achieves these goals on a smooth, curvilinear, structured grid?\n\nA. Define discrete metrics in a conservative cofactor form by $\\,\\widehat{J \\boldsymbol{a}^{\\xi}} = D_{\\eta}\\boldsymbol{x} \\times D_{\\zeta}\\boldsymbol{x}$, $\\,\\widehat{J \\boldsymbol{a}^{\\eta}} = D_{\\zeta}\\boldsymbol{x} \\times D_{\\xi}\\boldsymbol{x}$, and $\\,\\widehat{J \\boldsymbol{a}^{\\zeta}} = D_{\\xi}\\boldsymbol{x} \\times D_{\\eta}\\boldsymbol{x}$, and compute the discrete flux divergence with the same operators $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$ applied to $\\tilde{F}^{\\xi}$, $\\tilde{F}^{\\eta}$, and $\\tilde{F}^{\\zeta}$, respectively. Choose $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$ to be linear, consistent, and to commute on smooth grids (for example, compatible Summation-By-Parts operators with identical interior stencils). \n\nB. Compute $\\boldsymbol{a}^{\\xi}$, $\\boldsymbol{a}^{\\eta}$, and $\\boldsymbol{a}^{\\zeta}$ in a non-conservative form by approximating the inverse Jacobian matrix $(\\partial \\boldsymbol{x}/\\partial \\boldsymbol{\\xi})^{-1}$ at each node via a local least-squares fit, then set $J$ from a separate discrete triple product formula. Use upwind-biased difference operators for the flux divergence that differ from those used in the metric construction.\n\nC. Compute $J \\boldsymbol{a}^{\\xi}$ by first forming $J$ from a discrete triple product of discrete $\\boldsymbol{x}_{\\xi}$, $\\boldsymbol{x}_{\\eta}$, and $\\boldsymbol{x}_{\\zeta}$ using $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$, then multiply $J$ by a discrete approximation of $\\boldsymbol{a}^{\\xi}$ obtained from solving a $3 \\times 3$ linear system for $(\\partial \\boldsymbol{x}/\\partial \\boldsymbol{\\xi})^{-1}$ at each node. Use the same operators $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$ for the flux divergence.\n\nD. Define discrete metrics using the conservative cofactor form but with compact central differences for $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$, while computing the flux divergence with an explicit central difference of the same formal order but a different stencil. Rely on the formal order matching to argue that free-stream preservation and metric identities hold approximately rather than exactly.\n\nSelect the correct option(s) and, using first principles, justify the construction and the requirement to use the same operators for metrics and fluxes to guarantee the discrete metric identities and free-stream preservation for constant states.",
            "solution": "The problem statement is a valid and well-posed question in the field of computational fluid dynamics, specifically concerning the numerical solution of conservation laws on curvilinear coordinate systems. The concepts presented—generalized coordinate transformation, Jacobian determinant, contravariant vectors, metric identities, and free-stream preservation—are fundamental to the theory and practice of finite-difference and finite-volume methods. The question asks for a discrete methodology that satisfies the Geometric Conservation Law (GCL) to ensure free-stream preservation.\n\n### Principle-Based Derivation\n\nThe transformation of the divergence of a flux vector $\\boldsymbol{F}$ from physical space $\\boldsymbol{x}=(x,y,z)$ to computational space $\\boldsymbol{\\xi}=(\\xi,\\eta,\\zeta)$ is given by:\n$$\n\\nabla_{\\boldsymbol{x}} \\cdot \\boldsymbol{F} = \\frac{1}{J} \\left( \\frac{\\partial (J F^\\xi)}{\\partial \\xi} + \\frac{\\partial (J F^\\eta)}{\\partial \\eta} + \\frac{\\partial (J F^\\zeta)}{\\partial \\zeta} \\right)\n$$\nwhere $F^\\xi = \\boldsymbol{F} \\cdot \\boldsymbol{a}^\\xi$, $F^\\eta = \\boldsymbol{F} \\cdot \\boldsymbol{a}^\\eta$, and $F^\\zeta = \\boldsymbol{F} \\cdot \\boldsymbol{a}^\\zeta$ are the contravariant components of $\\boldsymbol{F}$. The problem statement uses a slightly different but equivalent formulation in terms of contravariant fluxes, $\\tilde{F}^{\\xi} = \\boldsymbol{F} \\cdot (J \\boldsymbol{a}^{\\xi})$, leading to the conservation-law form in computational space:\n$$\n\\nabla_{\\boldsymbol{x}} \\cdot \\boldsymbol{F} \\rightarrow \\partial_{\\xi} \\tilde{F}^{\\xi} + \\partial_{\\eta} \\tilde{F}^{\\eta} + \\partial_{\\zeta} \\tilde{F}^{\\zeta} = 0\n$$\nPreservation of a uniform free stream requires that if the physical state vector $\\boldsymbol{U}$ is constant, the numerical scheme must yield a zero residual. For a constant $\\boldsymbol{U}$, the physical flux vector $\\boldsymbol{F}(\\boldsymbol{U})$ is also a constant vector, which we denote as $\\boldsymbol{F}_c$. The contravariant fluxes become $\\tilde{F}^{\\gamma} = \\boldsymbol{F}_c \\cdot (J \\boldsymbol{a}^{\\gamma})$ for $\\gamma \\in \\{\\xi, \\eta, \\zeta\\}$.\n\nThe continuous governing equation for a constant state is:\n$$\n\\partial_{\\xi} (\\boldsymbol{F}_c \\cdot (J \\boldsymbol{a}^{\\xi})) + \\partial_{\\eta} (\\boldsymbol{F}_c \\cdot (J \\boldsymbol{a}^{\\eta})) + \\partial_{\\zeta} (\\boldsymbol{F}_c \\cdot (J \\boldsymbol{a}^{\\zeta})) = 0\n$$\nSince $\\boldsymbol{F}_c$ is a constant vector, it can be factored out of the derivatives:\n$$\n\\boldsymbol{F}_c \\cdot \\left( \\partial_{\\xi}(J \\boldsymbol{a}^{\\xi}) + \\partial_{\\eta}(J \\boldsymbol{a}^{\\eta}) + \\partial_{\\zeta}(J \\boldsymbol{a}^{\\zeta}) \\right) = 0\n$$\nFor this equation to hold for any arbitrary constant state (i.e., any $\\boldsymbol{F}_c$), the term in parentheses must be identically zero. This is the **continuous metric identity**, also known as the Geometric Conservation Law (GCL):\n$$\n\\partial_{\\xi}(J \\boldsymbol{a}^{\\xi}) + \\partial_{\\eta}(J \\boldsymbol{a}^{\\eta}) + \\partial_{\\zeta}(J \\boldsymbol{a}^{\\zeta}) = \\boldsymbol{0}\n$$\nThis identity can be proven to hold analytically. The terms $J \\boldsymbol{a}^{\\gamma}$ are known as the metric terms or scaled contravariant base vectors. They have a more direct expression in terms of the derivatives of the position vector $\\boldsymbol{x}(\\xi,\\eta,\\zeta)$, known as the cofactor identities:\n$$\nJ \\boldsymbol{a}^{\\xi} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\eta} \\times \\frac{\\partial \\boldsymbol{x}}{\\partial \\zeta}, \\quad\nJ \\boldsymbol{a}^{\\eta} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\zeta} \\times \\frac{\\partial \\boldsymbol{x}}{\\partial \\xi}, \\quad\nJ \\boldsymbol{a}^{\\zeta} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\xi} \\times \\frac{\\partial \\boldsymbol{x}}{\\partial \\eta}\n$$\nSubstituting these into the GCL gives an identity that holds due to the commutativity of mixed partial derivatives for a sufficiently smooth mapping $\\boldsymbol{x}(\\boldsymbol{\\xi})$.\n\nNow, we must replicate this property at the discrete level. Let $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$ be linear discrete operators approximating the partial derivatives. A discrete approximation of the flux divergence is $D_{\\xi} \\tilde{F}^{\\xi} + D_{\\eta} \\tilde{F}^{\\eta} + D_{\\zeta} \\tilde{F}^{\\zeta}$. For a constant state $\\boldsymbol{F}_c$, the condition for free-stream preservation is:\n$$\nD_{\\xi} (\\boldsymbol{F}_c \\cdot \\widehat{J \\boldsymbol{a}^{\\xi}}) + D_{\\eta} (\\boldsymbol{F}_c \\cdot \\widehat{J \\boldsymbol{a}^{\\eta}}) + D_{\\zeta} (\\boldsymbol{F}_c \\cdot \\widehat{J \\boldsymbol{a}^{\\zeta}}) = 0\n$$\nwhere $\\widehat{J \\boldsymbol{a}^{\\gamma}}$ denotes the discrete approximation of the metric term. Since the operators $D_\\gamma$ are linear, we have:\n$$\n\\boldsymbol{F}_c \\cdot \\left( D_{\\xi}(\\widehat{J \\boldsymbol{a}^{\\xi}}) + D_{\\eta}(\\widehat{J \\boldsymbol{a}^{\\eta}}) + D_{\\zeta}(\\widehat{J \\boldsymbol{a}^{\\zeta}}) \\right) = 0\n$$\nFor this to hold for any $\\boldsymbol{F}_c$, the **discrete GCL** must be satisfied *exactly* (i.e., to machine precision):\n$$\nD_{\\xi}(\\widehat{J \\boldsymbol{a}^{\\xi}}) + D_{\\eta}(\\widehat{J \\boldsymbol{a}^{\\eta}}) + D_{\\zeta}(\\widehat{J \\boldsymbol{a}^{\\zeta}}) = \\boldsymbol{0}\n$$\nThe key is to define the discrete metrics $\\widehat{J \\boldsymbol{a}^{\\gamma}}$ such that this algebraic identity holds. The most robust way to achieve this is to mimic the structure that leads to the cancellation in the continuous case. This involves two critical choices:\n1.  The discrete metrics must be defined using the cofactor form, but with discrete operators replacing the partial derivatives.\n2.  The discrete operators used to compute the metrics must be intertwined with the operators used to compute the flux divergence in a way that creates a telescoping sum or similar algebraic cancellation.\n\nLet us propose a construction and test it. Let the operators for metric construction be $D'_{\\gamma}$ and for the flux divergence be $D_{\\gamma}$. Define the metrics using the cofactor form:\n$$\n\\widehat{J \\boldsymbol{a}^{\\xi}} = D'_{\\eta}\\boldsymbol{x} \\times D'_{\\zeta}\\boldsymbol{x}, \\quad\n\\widehat{J \\boldsymbol{a}^{\\eta}} = D'_{\\zeta}\\boldsymbol{x} \\times D'_{\\xi}\\boldsymbol{x}, \\quad\n\\widehat{J \\boldsymbol{a}^{\\zeta}} = D'_{\\xi}\\boldsymbol{x} \\times D'_{\\eta}\\boldsymbol{x}\n$$\nThe discrete GCL becomes:\n$$\nD_{\\xi}(D'_{\\eta}\\boldsymbol{x} \\times D'_{\\zeta}\\boldsymbol{x}) + D_{\\eta}(D'_{\\zeta}\\boldsymbol{x} \\times D'_{\\xi}\\boldsymbol{x}) + D_{\\zeta}(D'_{\\xi}\\boldsymbol{x} \\times D'_{\\eta}\\boldsymbol{x}) = \\boldsymbol{0}\n$$\nThis identity holds if $D_{\\gamma}$ and $D'_{\\gamma}$ are the same operators ($D_{\\gamma} = D'_{\\gamma}$), and these operators have a discrete commutativity property, i.e., $D_{\\xi}D_{\\eta} \\approx D_{\\eta}D_{\\xi}$. For many common operators, like standard central differences on a uniform or smoothly varying grid, this commutativity holds, leading to exact cancellation. More generally, Summation-By-Parts (SBP) operators are designed to satisfy a discrete analogue of integration-by-parts, which provides the necessary algebraic structure for this identity to hold. Using different operators for the metrics ($D'$) and the divergence ($D$) breaks this symmetry and the cancellation fails.\n\n### Option-by-Option Analysis\n\n**A. Define discrete metrics in a conservative cofactor form by $\\,\\widehat{J \\boldsymbol{a}^{\\xi}} = D_{\\eta}\\boldsymbol{x} \\times D_{\\zeta}\\boldsymbol{x}$, etc., and compute the discrete flux divergence with the same operators $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$.**\n\nThis option follows the derived principle exactly. It uses the discrete cofactor form for the metrics. Critically, it specifies that the *same* operators are used for both metric construction and the flux divergence. The condition that these operators are linear, consistent, and commute (or have compatible SBP properties) ensures that the algebraic structure mimics the continuous case, leading to an exact cancellation in the discrete GCL expression. This guarantees free-stream preservation to machine precision. This is the standard, well-established method for satisfying the GCL in finite-difference schemes.\n**Verdict: Correct.**\n\n**B. Compute $\\boldsymbol{a}^{\\xi}$, $\\boldsymbol{a}^{\\eta}$, and $\\boldsymbol{a}^{\\zeta}$ in a non-conservative form by approximating the inverse Jacobian matrix ... then set $J$ from a separate discrete triple product formula. Use upwind-biased difference operators for the flux divergence that differ from those used in the metric construction.**\n\nThis approach has two fundamental flaws. First, it computes the metric terms by separately approximating $J$ and $\\boldsymbol{a}^{\\gamma}$ and then multiplying them. This is a \"non-conservative\" construction because the discrete product $\\hat{J} \\widehat{\\boldsymbol{a}^{\\gamma}}$ is not in general equal to the discrete cofactor form, e.g., $D_{\\eta}\\boldsymbol{x} \\times D_{\\zeta}\\boldsymbol{x}$. The exact algebraic link is broken by using different discretization paths, meaning the resulting metrics $\\widehat{J \\boldsymbol{a}^{\\gamma}}$ will not satisfy the discrete GCL. Second, it explicitly uses different operators for the flux divergence and the metric construction, which as we derived, breaks the algebraic cancellation required for the GCL.\n**Verdict: Incorrect.**\n\n**C. Compute $J \\boldsymbol{a}^{\\xi}$ by first forming $J$ from a discrete triple product ... then multiply $J$ by a discrete approximation of $\\boldsymbol{a}^{\\xi}$ obtained from solving a $3 \\times 3$ linear system ... Use the same operators $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$ for the flux divergence.**\n\nThis option, like B, uses a non-conservative construction for the metric terms. The discrete Jacobian determinant $\\hat{J} = (D_{\\xi}\\boldsymbol{x}) \\cdot (D_{\\eta}\\boldsymbol{x} \\times D_{\\zeta}\\boldsymbol{x})$ and the discrete inverse $\\widehat{(\\partial \\boldsymbol{x}/\\partial \\boldsymbol{\\xi})^{-1}}$ are computed via separate paths. While they are consistent approximations, their product does not algebraically guarantee the satisfaction of the discrete GCL in the same way the cofactor form does. Even though it correctly proposes using the same operators for the flux divergence, the initial construction of the metrics is flawed and will not lead to exact free-stream preservation.\n**Verdict: Incorrect.**\n\n**D. Define discrete metrics using the conservative cofactor form but with compact central differences for $D_{\\xi}$, $D_{\\eta}$, and $D_{\\zeta}$, while computing the flux divergence with an explicit central difference of the same formal order but a different stencil. Rely on the formal order matching to argue that free-stream preservation and metric identities hold approximately rather than exactly.**\n\nThis option correctly uses the cofactor form for the metrics. However, it explicitly violates the crucial requirement of using the same operators for the metrics and the flux divergence. Using operators with different stencils (even if they share the same formal order of accuracy) will destroy the exact algebraic cancellation. The argument that free-stream preservation will hold \"approximately\" is an admission of failure. In robust numerical schemes, free-stream preservation must be satisfied *exactly* (to machine precision). An \"approximate\" satisfaction means the scheme generates spurious sources in a uniform flow, which is unacceptable and can lead to significant solution errors.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}