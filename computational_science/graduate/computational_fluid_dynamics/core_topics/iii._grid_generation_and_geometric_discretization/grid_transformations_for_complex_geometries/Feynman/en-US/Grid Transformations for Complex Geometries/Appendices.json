{
    "hands_on_practices": [
        {
            "introduction": "To analyze fluid flow on a complex domain, we must first describe the geometry of the computational grid itself. This initial practice guides you through the fundamental process of deriving a grid's geometric character from its mathematical definition. By working through a common polar-type mapping , you will calculate the metric tensor, assess orthogonality, and determine the cell aspect ratio, building a direct link between the transformation parameters and the grid's local shape and quality.",
            "id": "3327571",
            "problem": "In Computational Fluid Dynamics (CFD), curvilinear grid generation for complex geometries often employs mappings from a computational domain to a physical domain. Consider the $2$-dimensional mapping from computational coordinates $(\\xi,\\eta)$ to Cartesian physical coordinates $\\mathbf{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)$ given by\n$$\n\\mathbf{x}(\\xi,\\eta) = \\big(r(\\xi)\\cos\\eta,\\; r(\\xi)\\sin\\eta\\big), \\quad r(\\xi) = 1 + \\beta\\,\\xi,\n$$\nwith $\\beta0$, $\\xi\\in[0,1]$, and $\\eta\\in[0,2\\pi)$ measured in radians. Using only fundamental definitions from differential geometry of curvilinear coordinates as used in CFD (covariant base vectors, metric tensor, orthogonality criterion, and scale factors), perform the following:\n\n- Starting from the definition of covariant base vectors $\\mathbf{x}_{\\xi}=\\partial\\mathbf{x}/\\partial\\xi$ and $\\mathbf{x}_{\\eta}=\\partial\\mathbf{x}/\\partial\\eta$, derive the covariant metric tensor components $g_{ij}=\\mathbf{x}_{i}\\cdot\\mathbf{x}_{j}$ for $i,j\\in\\{\\xi,\\eta\\}$ in terms of $\\beta$, $\\xi$, and $\\eta$.\n- Using the definition of orthogonality in curvilinear coordinates, determine whether the coordinate lines are orthogonal and explain how the parameter $\\beta$ influences orthogonality.\n- Define the local cell aspect ratio $A(\\xi,\\eta)$ as the ratio of scale factors $h_{\\eta}/h_{\\xi}$, where $h_{i}=\\sqrt{g_{ii}}$ for $i\\in\\{\\xi,\\eta\\}$. Derive $A(\\xi,\\eta)$ in terms of $\\beta$ and $\\xi$, and interpret how variations in $\\beta$ modify the aspect ratio distribution across the grid.\n\nReport as your final answer only the closed-form analytic expression for the aspect ratio $A(\\xi)$ in terms of $\\beta$ and $\\xi$. No numerical evaluation is required, and no rounding applies. Do not include units in the final answer.",
            "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary information is provided, and the tasks are well-defined within the standard framework of differential geometry as applied to computational fluid dynamics. The solution proceeds as follows.\n\nThe problem provides a $2$-dimensional mapping from computational coordinates $(\\xi, \\eta)$ to physical Cartesian coordinates $\\mathbf{x}(\\xi, \\eta) = (x(\\xi, \\eta), y(\\xi, \\eta))$. The mapping is given by:\n$$\n\\mathbf{x}(\\xi, \\eta) = \\big(r(\\xi)\\cos\\eta, r(\\xi)\\sin\\eta\\big)\n$$\nwhere $r(\\xi) = 1 + \\beta\\xi$, with the constraints $\\beta  0$, $\\xi \\in [0, 1]$, and $\\eta \\in [0, 2\\pi)$.\n\nFirst, we derive the covariant metric tensor components $g_{ij}$. This requires the calculation of the covariant base vectors, $\\mathbf{x}_{\\xi}$ and $\\mathbf{x}_{\\eta}$, which are the partial derivatives of the position vector $\\mathbf{x}$ with respect to the computational coordinates.\n\nThe position vector is $\\mathbf{x}(\\xi, \\eta) = (x(\\xi, \\eta), y(\\xi, \\eta)) = \\big((1+\\beta\\xi)\\cos\\eta, (1+\\beta\\xi)\\sin\\eta\\big)$.\n\nThe partial derivative with respect to $\\xi$ is:\n$$\n\\mathbf{x}_{\\xi} = \\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\left( \\frac{\\partial}{\\partial \\xi} \\big((1+\\beta\\xi)\\cos\\eta\\big), \\frac{\\partial}{\\partial \\xi} \\big((1+\\beta\\xi)\\sin\\eta\\big) \\right)\n$$\n$$\n\\mathbf{x}_{\\xi} = (\\beta\\cos\\eta, \\beta\\sin\\eta)\n$$\n\nThe partial derivative with respect to $\\eta$ is:\n$$\n\\mathbf{x}_{\\eta} = \\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\left( \\frac{\\partial}{\\partial \\eta} \\big((1+\\beta\\xi)\\cos\\eta\\big), \\frac{\\partial}{\\partial \\eta} \\big((1+\\beta\\xi)\\sin\\eta\\big) \\right)\n$$\n$$\n\\mathbf{x}_{\\eta} = \\big(-(1+\\beta\\xi)\\sin\\eta, (1+\\beta\\xi)\\cos\\eta\\big)\n$$\n\nNext, we compute the components of the covariant metric tensor, $g_{ij} = \\mathbf{x}_{i} \\cdot \\mathbf{x}_{j}$, for $i, j \\in \\{\\xi, \\eta\\}$.\n\nThe component $g_{\\xi\\xi}$ is:\n$$\ng_{\\xi\\xi} = \\mathbf{x}_{\\xi} \\cdot \\mathbf{x}_{\\xi} = (\\beta\\cos\\eta)^2 + (\\beta\\sin\\eta)^2 = \\beta^2\\cos^2\\eta + \\beta^2\\sin^2\\eta = \\beta^2(\\cos^2\\eta + \\sin^2\\eta) = \\beta^2\n$$\n\nThe component $g_{\\eta\\eta}$ is:\n$$\ng_{\\eta\\eta} = \\mathbf{x}_{\\eta} \\cdot \\mathbf{x}_{\\eta} = \\big(-(1+\\beta\\xi)\\sin\\eta\\big)^2 + \\big((1+\\beta\\xi)\\cos\\eta\\big)^2 = (1+\\beta\\xi)^2\\sin^2\\eta + (1+\\beta\\xi)^2\\cos^2\\eta\n$$\n$$\ng_{\\eta\\eta} = (1+\\beta\\xi)^2(\\sin^2\\eta + \\cos^2\\eta) = (1+\\beta\\xi)^2\n$$\n\nThe off-diagonal component $g_{\\xi\\eta}$ is:\n$$\ng_{\\xi\\eta} = \\mathbf{x}_{\\xi} \\cdot \\mathbf{x}_{\\eta} = (\\beta\\cos\\eta)\\big(-(1+\\beta\\xi)\\sin\\eta\\big) + (\\beta\\sin\\eta)\\big((1+\\beta\\xi)\\cos\\eta\\big)\n$$\n$$\ng_{\\xi\\eta} = -\\beta(1+\\beta\\xi)\\cos\\eta\\sin\\eta + \\beta(1+\\beta\\xi)\\sin\\eta\\cos\\eta = 0\n$$\nSince the metric tensor is symmetric, $g_{\\eta\\xi} = g_{\\xi\\eta} = 0$.\n\nThus, the covariant metric tensor components are:\n$$\ng_{\\xi\\xi} = \\beta^2, \\quad g_{\\eta\\eta} = (1+\\beta\\xi)^2, \\quad g_{\\xi\\eta} = g_{\\eta\\xi} = 0\n$$\n\nThe second task is to determine if the coordinate lines are orthogonal. A curvilinear coordinate system is orthogonal if and only if the off-diagonal components of its metric tensor are zero. In this case, we have found that $g_{\\xi\\eta} = g_{\\eta\\xi} = 0$ for all values of $\\xi$ and $\\eta$ in their respective domains. This means the base vectors $\\mathbf{x}_{\\xi}$ and $\\mathbf{x}_{\\eta}$ are orthogonal at every point. Therefore, the coordinate lines (lines of constant $\\xi$ and lines of constant $\\eta$) are orthogonal throughout the grid. The parameter $\\beta$, being a positive constant, affects the magnitude of $\\mathbf{x}_{\\xi}$ but does not alter the fact that $g_{\\xi\\eta}=0$. Consequently, the coordinate system is orthogonal for any $\\beta  0$, and $\\beta$ has no influence on the orthogonality property itself. Geometrically, lines of constant $\\xi$ are circles, and lines of constant $\\eta$ are radial lines, which are always mutually orthogonal.\n\nThe third task is to derive the local cell aspect ratio, defined as $A(\\xi, \\eta) = h_{\\eta}/h_{\\xi}$. The scale factors (or Lamé coefficients) $h_i$ are defined as $h_i = \\sqrt{g_{ii}}$.\n\nThe scale factor $h_{\\xi}$ is:\n$$\nh_{\\xi} = \\sqrt{g_{\\xi\\xi}} = \\sqrt{\\beta^2} = |\\beta|\n$$\nGiven that $\\beta  0$, we have $h_{\\xi} = \\beta$.\n\nThe scale factor $h_{\\eta}$ is:\n$$\nh_{\\eta} = \\sqrt{g_{\\eta\\eta}} = \\sqrt{(1+\\beta\\xi)^2} = |1+\\beta\\xi|\n$$\nGiven that $\\beta  0$ and $\\xi \\in [0, 1]$, the term $1+\\beta\\xi$ is strictly positive, so $|1+\\beta\\xi| = 1+\\beta\\xi$. Thus, $h_{\\eta} = 1+\\beta\\xi$.\n\nNow, we can compute the aspect ratio $A(\\xi, \\eta)$:\n$$\nA(\\xi, \\eta) = \\frac{h_{\\eta}}{h_{\\xi}} = \\frac{1+\\beta\\xi}{\\beta}\n$$\nThe expression for the aspect ratio depends only on $\\xi$ and $\\beta$, not on $\\eta$. We can therefore write it as $A(\\xi)$.\n$$\nA(\\xi) = \\frac{1+\\beta\\xi}{\\beta} = \\frac{1}{\\beta} + \\xi\n$$\nTo interpret the influence of $\\beta$, we examine this expression. The aspect ratio $A(\\xi)$ represents the ratio of the local arc length in the $\\eta$-direction (azimuthal) to the local length in the $\\xi$-direction (radial).\n- For a fixed $\\beta$, $A(\\xi)$ increases linearly with $\\xi$. At the inner boundary ($\\xi=0$), $A(0) = 1/\\beta$. At the outer boundary ($\\xi=1$), $A(1) = (1+\\beta)/\\beta = 1/\\beta + 1$. This indicates that grid cells become progressively more stretched in the azimuthal direction as one moves radially outward.\n- For a small $\\beta  0$, the value of $1/\\beta$ is large. This results in a large aspect ratio across the entire domain, meaning the cells are highly elongated in the $\\eta$-direction. This corresponds to a narrow annulus where the radial grid spacing (proportional to $\\beta$) is much smaller than the azimuthal spacing (proportional to $r(\\xi)=1+\\beta\\xi \\approx 1$).\n- For a large $\\beta$, the value of $1/\\beta$ is small. The aspect ratio starts near zero at $\\xi=0$ ($A(0) = 1/\\beta \\to 0$) and approaches $1$ as $\\xi$ increases. This means cells near the inner boundary are stretched in the radial direction, and they become more isotropic (squarer) towards the outer boundary. A large $\\beta$ corresponds to a wide annulus with significant radial stretching.\n\nThe final requested quantity is the closed-form analytic expression for the aspect ratio $A(\\xi)$.",
            "answer": "$$\\boxed{\\frac{1 + \\beta \\xi}{\\beta}}$$"
        },
        {
            "introduction": "A perfect, orthogonal grid is a luxury seldom afforded by complex geometries. This practice explores the consequences of non-orthogonality by examining how a skew parameter, $\\alpha$, contaminates the transformed diffusion equation with spurious cross-derivative terms . You will not only derive this effect analytically but also perform a numerical stability analysis to quantify how this geometric defect directly corrupts the accuracy of a numerical solution, providing a crucial lesson in the interplay between grid quality and simulation fidelity.",
            "id": "3327534",
            "problem": "Consider the two-dimensional ($2$-D) diffusion of a scalar field $u(x,y,t)$ governed by the standard diffusion equation from first principles, which states that the rate of change of $u$ is proportional to the divergence of its gradient: $\\partial u / \\partial t = \\nu \\nabla^{2} u$, where $\\nu$ is the diffusion coefficient. In Computational Fluid Dynamics (CFD), solving this equation on complex geometries often requires transformations from physical coordinates $(x,y)$ to computational coordinates $(\\xi,\\eta)$, which introduce metric terms and, for non-orthogonal grids, cross-derivative contributions. Starting from the chain rule for multivariable functions and the definition of the gradient and Laplacian, derive the general form of the transformed diffusion operator in $(\\xi,\\eta)$ that involves covariant and contravariant metric tensors and the Jacobian determinant. Then specialize to a skewed affine map that models non-orthogonality: $x(\\xi,\\eta) = \\xi + \\alpha \\eta$ and $y(\\xi,\\eta) = \\eta$, where $\\alpha$ is a dimensionless skew parameter. From this specialization, identify the cross-derivative contribution introduced by non-orthogonality and its coefficient.\n\nNext, design a simple numerical diffusion test using a uniform computational grid with spacing $h$ (in meters), central-difference approximations, and a single time step of the explicit Forward Euler method with timestep $\\Delta t$ (in seconds). Assume a Fourier mode on the computational grid with wavenumbers $k_{\\xi}$ and $k_{\\eta}$ (angles must be given in radians). Using well-tested discrete Fourier analysis for central differences, the discrete second derivative operators along $\\xi$, $\\eta$, and the mixed derivative $\\xi\\eta$ each have known Fourier-mode eigenvalues that depend on $k_{\\xi}$, $k_{\\eta}$, and $h$. Using these, compute the discrete amplification factor for one Forward Euler step on the orthogonal grid (baseline case with $\\alpha = 0$) and on the skewed grid (non-orthogonal case with $\\alpha \\neq 0$). Define the relative amplification error ratio $R$ as the change in the numerical damping due to non-orthogonality, normalized by the baseline damping:\n$$\nR \\equiv \\frac{G_{\\alpha} - G_{0}}{G_{0} - 1},\n$$\nwhere $G_{0}$ is the amplification factor for the orthogonal grid and $G_{\\alpha}$ is the amplification factor for the non-orthogonal grid.\n\nYour program must implement this analysis and produce numerical values of $R$ for the following test suite. Each parameter set is a tuple $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t)$, where $h$ is in meters, $\\nu$ is in $\\mathrm{m}^{2}/\\mathrm{s}$, and angles $k_{\\xi}$ and $k_{\\eta}$ are in radians:\n- Test $1$ (baseline orthogonal case): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.0,\\pi/3,\\pi/3,1.0,0.1,0.05)$.\n- Test $2$ (mild skew, equal modes): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.2,\\pi/3,\\pi/3,1.0,0.1,0.05)$.\n- Test $3$ (moderate skew, unequal modes): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.5,\\pi/6,\\pi/3,1.0,0.1,0.05)$.\n- Test $4$ (strong skew, high wavenumbers): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.9,\\pi/2,\\pi/2,1.0,0.05,0.02)$.\n- Test $5$ (skew with one direction constant, edge case): $(\\alpha,k_{\\xi},k_{\\eta},h,\\nu,\\Delta t) = (0.7,\\pi/3,0.0,1.0,0.1,0.05)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_{1},r_{2},r_{3},r_{4},r_{5}]$), where each $r_{i}$ is the computed float value of $R$ for the corresponding test case. Angles must be treated in radians, and all intermediate quantities must be computed consistently with the specified physical units. The output floats are dimensionless by construction.",
            "solution": "The problem statement has been analyzed and is determined to be valid. It is scientifically grounded in the principles of continuum mechanics, tensor calculus, and numerical analysis. The setup is self-contained, consistent, and well-posed, providing all necessary information to derive a unique solution.\n\nThe solution proceeds in three stages:\n$1$. Derivation of the general transformed diffusion operator.\n$2$. Specialization of the operator for the given skewed affine coordinate transformation.\n$3$. Numerical analysis of the discretized equation to derive the relative amplification error ratio, $R$.\n\n**$1$. Transformation of the Diffusion Operator**\n\nThe starting point is the $2$-D diffusion equation in physical Cartesian coordinates $(x,y)$:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\nabla^2 u = \\nu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\nWe consider a transformation to a general computational coordinate system $(\\xi^1, \\xi^2) \\equiv (\\xi, \\eta)$. The relationship is given by $x(\\xi, \\eta)$ and $y(\\xi, \\eta)$. The chain rule for partial derivatives gives:\n$$\n\\frac{\\partial}{\\partial \\xi^i} = \\frac{\\partial x^k}{\\partial \\xi^i} \\frac{\\partial}{\\partial x^k}\n$$\nwhere summation over the repeated index $k \\in \\{1,2\\}$ is implied, with $(x^1, x^2) \\equiv (x,y)$. This relates the gradient operators in the two coordinate systems.\n\nA standard result from tensor calculus states that the Laplacian operator $\\nabla^2$ transforms as:\n$$\n\\nabla^2 u = \\frac{1}{J} \\frac{\\partial}{\\partial \\xi^i} \\left( J g^{ij} \\frac{\\partial u}{\\partial \\xi^j} \\right)\n$$\nwhere summation is implied over $i,j \\in \\{1,2\\}$. Here, $J$ is the Jacobian determinant of the transformation and $g^{ij}$ are the components of the contravariant metric tensor.\n\nThe Jacobian matrix $\\mathbf{J}$ and its determinant $J$ are:\n$$\n\\mathbf{J} = \\begin{pmatrix} x_\\xi  x_\\eta \\\\ y_\\xi  y_\\eta \\end{pmatrix}, \\quad J = \\det(\\mathbf{J}) = x_\\xi y_\\eta - x_\\eta y_\\xi\n$$\nwhere subscripts denote partial differentiation (e.g., $x_\\xi = \\partial x/\\partial \\xi$).\n\nThe covariant metric tensor, $\\mathbf{G} = [g_{ij}]$, is defined by $\\mathbf{G} = \\mathbf{J}^T \\mathbf{J}$:\n$$\ng_{ij} = \\frac{\\partial x^k}{\\partial \\xi^i} \\frac{\\partial x^k}{\\partial \\xi^j} \\implies \\mathbf{G} = \\begin{pmatrix} x_\\xi^2+y_\\xi^2  x_\\xi x_\\eta + y_\\xi y_\\eta \\\\ x_\\xi x_\\eta + y_\\xi y_\\eta  x_\\eta^2+y_\\eta^2 \\end{pmatrix}\n$$\nThe contravariant metric tensor, $\\mathbf{G}^{-1} = [g^{ij}]$, is the matrix inverse of $\\mathbf{G}$. It can be shown that $\\det(\\mathbf{G}) = J^2$, leading to:\n$$\n[g^{ij}] = \\frac{1}{J^2} \\begin{pmatrix} g_{22}  -g_{12} \\\\ -g_{21}  g_{11} \\end{pmatrix} = \\frac{1}{J^2} \\begin{pmatrix} x_\\eta^2+y_\\eta^2  -(x_\\xi x_\\eta + y_\\xi y_\\eta) \\\\ -(x_\\xi x_\\eta + y_\\xi y_\\eta)  x_\\xi^2+y_\\xi^2 \\end{pmatrix}\n$$\n\n**$2$. Specialization to the Skewed Affine Map**\n\nThe problem specifies the skewed affine map:\n$$\nx(\\xi, \\eta) = \\xi + \\alpha \\eta, \\quad y(\\xi, \\eta) = \\eta\n$$\nWe compute the partial derivatives:\n$$\nx_\\xi = 1, \\quad x_\\eta = \\alpha, \\quad y_\\xi = 0, \\quad y_\\eta = 1\n$$\nThe Jacobian determinant is:\n$$\nJ = x_\\xi y_\\eta - x_\\eta y_\\xi = (1)(1) - (\\alpha)(0) = 1\n$$\nSince the Jacobian and all metric coefficients derived from it will be constant, the transformed Laplacian simplifies. The general form $\\frac{1}{J} \\frac{\\partial}{\\partial \\xi^i} (J g^{ij} \\frac{\\partial u}{\\partial \\xi^j})$ becomes $g^{ij} \\frac{\\partial^2 u}{\\partial \\xi^i \\partial \\xi^j}$ because $J$ and $g^{ij}$ are constant.\n\nThe components of the contravariant metric tensor $[g^{ij}]$ are:\n$$\ng^{11} = \\frac{1}{J^2}(x_\\eta^2 + y_\\eta^2) = \\frac{1}{1^2}(\\alpha^2 + 1^2) = 1 + \\alpha^2\n$$\n$$\ng^{22} = \\frac{1}{J^2}(x_\\xi^2 + y_\\xi^2) = \\frac{1}{1^2}(1^2 + 0^2) = 1\n$$\n$$\ng^{12} = g^{21} = -\\frac{1}{J^2}(x_\\xi x_\\eta + y_\\xi y_\\eta) = -\\frac{1}{1^2}((1)(\\alpha) + (0)(1)) = -\\alpha\n$$\nSubstituting these into the simplified Laplacian expression:\n$$\n\\nabla^2 u = g^{11} \\frac{\\partial^2 u}{\\partial \\xi^2} + g^{22} \\frac{\\partial^2 u}{\\partial \\eta^2} + 2g^{12} \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}\n$$\n$$\n\\nabla^2 u = (1+\\alpha^2) \\frac{\\partial^2 u}{\\partial \\xi^2} + \\frac{\\partial^2 u}{\\partial \\eta^2} - 2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}\n$$\nThe non-orthogonality, represented by $\\alpha \\neq 0$, introduces the cross-derivative term $-2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta}$, with a coefficient of $-2\\alpha$.\n\n**$3$. Numerical Amplification Factor Analysis**\n\nThe transformed diffusion equation is:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\left( (1+\\alpha^2) \\frac{\\partial^2 u}{\\partial \\xi^2} - 2\\alpha \\frac{\\partial^2 u}{\\partial \\xi \\partial \\eta} + \\frac{\\partial^2 u}{\\partial \\eta^2} \\right)\n$$\nWe discretize this equation using Forward Euler in time and second-order central differences in space on a uniform grid with spacing $\\Delta\\xi = \\Delta\\eta = h$. A Fourier mode $u^n_{i,j} = \\hat{u}^n e^{I(k_\\xi i h + k_\\eta j h)}$ is substituted into the discretized equation to find the amplification factor $G = \\hat{u}^{n+1}/\\hat{u}^n$.\n\nThe discrete spatial operators have the following Fourier eigenvalues (symbols):\n- $\\delta^2_\\xi u \\to \\lambda_{\\xi\\xi} \\hat{u}$, where $\\lambda_{\\xi\\xi} = \\frac{-4}{h^2}\\sin^2(k_\\xi h/2)$\n- $\\delta^2_\\eta u \\to \\lambda_{\\eta\\eta} \\hat{u}$, where $\\lambda_{\\eta\\eta} = \\frac{-4}{h^2}\\sin^2(k_\\eta h/2)$\n- $\\delta_{\\xi\\eta} u \\to \\lambda_{\\xi\\eta} \\hat{u}$, where $\\lambda_{\\xi\\eta} = -\\frac{1}{h^2}\\sin(k_\\xi h)\\sin(k_\\eta h)$\n\nApplying the Forward Euler scheme $u^{n+1} = u^n + \\Delta t (\\text{RHS})^n$ and substituting the Fourier modes and eigenvalues, we get:\n$$\n\\hat{u}^{n+1} = \\hat{u}^n + \\nu \\Delta t \\left[ (1+\\alpha^2) \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta} + \\lambda_{\\eta\\eta} \\right] \\hat{u}^n\n$$\nThe amplification factor for a given skewness $\\alpha$, denoted $G_\\alpha$, is:\n$$\nG_\\alpha = 1 + \\nu \\Delta t \\left[ (1+\\alpha^2)\\lambda_{\\xi\\xi} - 2\\alpha\\lambda_{\\xi\\eta} + \\lambda_{\\eta\\eta} \\right]\n$$\nFor the orthogonal case ($\\alpha=0$), the amplification factor $G_0$ is:\n$$\nG_0 = 1 + \\nu \\Delta t \\left[ \\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta} \\right]\n$$\nThe relative amplification error ratio $R$ is defined as:\n$$\nR \\equiv \\frac{G_{\\alpha} - G_{0}}{G_{0} - 1}\n$$\nThe numerator is:\n$$\nG_\\alpha - G_0 = \\nu \\Delta t \\left[ (\\alpha^2) \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta} \\right]\n$$\nThe denominator is:\n$$\nG_0 - 1 = \\nu \\Delta t \\left[ \\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta} \\right]\n$$\nThe term $\\nu \\Delta t$ cancels, showing that $R$ measures a structural property of the spatial discretization:\n$$\nR = \\frac{\\alpha^2 \\lambda_{\\xi\\xi} - 2\\alpha \\lambda_{\\xi\\eta}}{\\lambda_{\\xi\\xi} + \\lambda_{\\eta\\eta}}\n$$\nSubstituting the expressions for the eigenvalues:\n$$\nR = \\frac{\\alpha^2 \\frac{-4}{h^2}\\sin^2(\\frac{k_\\xi h}{2}) - 2\\alpha \\left(-\\frac{1}{h^2}\\sin(k_\\xi h)\\sin(k_\\eta h)\\right)}{\\frac{-4}{h^2}\\sin^2(\\frac{k_\\xi h}{2}) + \\frac{-4}{h^2}\\sin^2(\\frac{k_\\eta h}{2})}\n$$\nSimplifying by canceling the common factor $-1/h^2$ and dividing numerator and denominator by $4$:\n$$\nR = \\frac{4\\alpha^2 \\sin^2(k_\\xi h/2) - 2\\alpha \\sin(k_\\xi h)\\sin(k_\\eta h)}{4\\sin^2(k_\\xi h/2) + 4\\sin^2(k_\\eta h/2)}\n$$\nUsing the identity $\\sin(x) = 2\\sin(x/2)\\cos(x/2)$, we can write:\n$$\nR = \\frac{4\\alpha^2 \\sin^2(k_\\xi h/2) - 8\\alpha \\sin(k_\\xi h/2)\\cos(k_\\xi h/2)\\sin(k_\\eta h/2)\\cos(k_\\eta h/2)}{4\\left(\\sin^2(k_\\xi h/2) + \\sin^2(k_\\eta h/2)\\right)}\n$$\nLetting $\\theta_\\xi = k_\\xi h/2$ and $\\theta_\\eta = k_\\eta h/2$, the final expression for implementation is:\n$$\nR = \\frac{\\alpha^2 \\sin^2(\\theta_\\xi) - 2\\alpha \\sin(\\theta_\\xi)\\cos(\\theta_\\xi)\\sin(\\theta_\\eta)\\cos(\\theta_\\eta)}{\\sin^2(\\theta_\\xi) + \\sin^2(\\theta_\\eta)}\n$$\nThis formula is implemented for the provided test cases. For the case where the denominator is zero (i.e., $k_\\xi h$ and $k_\\eta h$ are both multiples of $2\\pi$), the numerator is also zero, yielding an indeterminate form $0/0$. In this scenario of zero numerical damping, the ratio $R$ is taken to be $0$, as there is no damping error to measure.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_r(alpha, k_xi, k_eta, h):\n    \"\"\"\n    Computes the relative amplification error ratio R.\n\n    The formula for R is derived from the Fourier analysis of the\n    central-differenced diffusion equation on a skewed affine grid.\n    The ratio R is independent of the diffusion coefficient nu and\n    the time step dt.\n\n    Args:\n        alpha (float): Dimensionless skew parameter.\n        k_xi (float): Wavenumber in the xi-direction (in radians for angle-like quantity).\n        k_eta (float): Wavenumber in the eta-direction (in radians for angle-like quantity).\n        h (float): Uniform grid spacing.\n\n    Returns:\n        float: The calculated value of the relative amplification error ratio R.\n    \"\"\"\n    theta_xi = k_xi * h / 2.0\n    theta_eta = k_eta * h / 2.0\n\n    sin_theta_xi = np.sin(theta_xi)\n    sin_theta_eta = np.sin(theta_eta)\n\n    denominator = sin_theta_xi**2 + sin_theta_eta**2\n\n    # If the denominator is close to zero, it means the numerical damping for the\n    # orthogonal grid is zero (G_0 = 1). This occurs for wavenumbers that are\n    # not resolved by the grid (e.g., k_xi*h=0, k_eta*h=0). In this 0/0 case,\n    # the relative error is conceptually zero.\n    if np.isclose(denominator, 0.0):\n        return 0.0\n\n    cos_theta_xi = np.cos(theta_xi)\n    cos_theta_eta = np.cos(theta_eta)\n    \n    # Numerator corresponds to the change in damping due to skewness.\n    # It contains terms proportional to alpha and alpha^2.\n    numerator = (alpha**2 * sin_theta_xi**2 -\n                 2 * alpha * sin_theta_xi * cos_theta_xi * sin_theta_eta * cos_theta_eta)\n    \n    # Using the identity sin(2x) = 2sin(x)cos(x), an alternative form for the\n    # second term in the numerator is -alpha * sin(k_xi*h) * sin(k_eta*h) / 2,\n    # which is used in some derivations. The current form is direct.\n    \n    r = numerator / denominator\n    return r\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (alpha, k_xi, k_eta, h, nu, dt).\n    # nu and dt are not used in the final formula for R but are part of the problem spec.\n    test_cases = [\n        # Test 1 (baseline orthogonal case)\n        (0.0, np.pi/3, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 2 (mild skew, equal modes)\n        (0.2, np.pi/3, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 3 (moderate skew, unequal modes)\n        (0.5, np.pi/6, np.pi/3, 1.0, 0.1, 0.05),\n        # Test 4 (strong skew, high wavenumbers)\n        (0.9, np.pi/2, np.pi/2, 1.0, 0.05, 0.02),\n        # Test 5 (skew with one direction constant, edge case)\n        (0.7, np.pi/3, 0.0, 1.0, 0.1, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, k_xi, k_eta, h, nu, dt = case\n        result = compute_r(alpha, k_xi, k_eta, h)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond analytical derivations, an experienced CFD practitioner must develop an intuition for how a grid's overall quality will impact simulation results. This final exercise challenges you to act as that practitioner, evaluating two different grids for a scalar advection problem based on their reported quality metrics like skewness, aspect ratio, and metric smoothness . By predicting which grid will lead to lower dispersion error, you will hone the critical skill of assessing a grid's suitability and anticipating numerical challenges before committing to a full-scale simulation.",
            "id": "3327566",
            "problem": "Consider the two-dimensional linear scalar advection equation for a passive scalar $\\,\\phi(x,y,t)\\,$, given by\n$$\n\\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} + v \\frac{\\partial \\phi}{\\partial y} = 0,\n$$\nwith uniform velocity components $\\,u = U  0\\,$ and $\\,v = 0\\,$. The physical domain is a smooth channel of length $\\,L_x\\,$ and height $\\,L_y\\,$ containing a streamlined bump, and the scalar initial condition is a single Fourier mode aligned with the streamwise direction,\n$$\n\\phi(x,y,0) = \\sin\\!\\left(\\frac{2\\pi x}{L_x}\\right),\n$$\nso that the physical wavenumber is $\\,k_x = 2\\pi/L_x\\,$ and $\\,k_y = 0\\,$. You discretize space using a curvilinear transformation $\\,(\\xi,\\eta) \\mapsto (x(\\xi,\\eta), y(\\xi,\\eta))\\,$ on a uniform computational grid with $\\,N_\\xi \\times N_\\eta\\,$ points, and you discretize the spatial derivative operators using second-order central differences in computational coordinates. The time integration is second-order accurate and uses the same Courant–Friedrichs–Lewy (CFL) number across all cases. The curvilinear formulation is conservative and satisfies the Geometric Conservation Law (GCL) exactly.\n\nTwo grids, $\\,\\mathcal{G}_1\\,$ and $\\,\\mathcal{G}_2\\,$, of equal size $\\,N_\\xi \\times N_\\eta\\,$ are considered. In both cases, the computational spacings $\\,\\Delta_\\xi\\,$ and $\\,\\Delta_\\eta\\,$ are uniform, but the physical metrics differ:\n\n- Grid $\\,\\mathcal{G}_1\\,$ is near-orthogonal and smooth: the maximum grid-line skewness angle relative to the $\\,x\\,$-direction is bounded by $\\,\\theta_{\\max}^{(1)} \\le 10^{\\circ}\\,$; the maximum cell aspect ratio, defined as the ratio of the physical streamwise edge length to the physical cross-stream edge length, satisfies $\\,\\mathrm{AR}_{\\max}^{(1)} \\le 3\\,$; and the contravariant metric components and their first derivatives are smooth with per-cell relative variation bounded by $\\,\\epsilon_1 \\le 0.05\\,$, quantified as\n$$\n\\max\\limits_{i,j}\\left(\\left|\\frac{x_\\xi(i+1,j)-x_\\xi(i-1,j)}{x_\\xi(i,j)}\\right|,\\ \\left|\\frac{x_\\eta(i,j+1)-x_\\eta(i,j-1)}{x_\\eta(i,j)}\\right|\\right) \\le \\epsilon_1.\n$$\n\n- Grid $\\,\\mathcal{G}_2\\,$ is more strongly skewed and stretched: $\\,\\theta_{\\max}^{(2)} \\le 35^{\\circ}\\,$; $\\,\\mathrm{AR}_{\\max}^{(2)} \\le 12\\,$ with cells elongated primarily in the streamwise direction; and the same metric components exhibit oscillatory clustering with per-cell relative variation bounded by $\\,\\epsilon_2 \\le 0.30\\,$, i.e.,\n$$\n\\max\\limits_{i,j}\\left(\\left|\\frac{x_\\xi(i+1,j)-x_\\xi(i-1,j)}{x_\\xi(i,j)}\\right|,\\ \\left|\\frac{x_\\eta(i,j+1)-x_\\eta(i,j-1)}{x_\\eta(i,j)}\\right|\\right) \\le \\epsilon_2,\n$$\nwith oscillation wavelengths on the order of $\\,4\\,$ computational cells near the bump.\n\nAssume $\\,\\mathcal{G}_1\\,$ and $\\,\\mathcal{G}_2\\,$ each satisfy the usual smoothness requirements for well-posed discretizations and that boundary reflections can be neglected over the short-time propagation of one streamwise wavelength. Based on first principles of curvilinear transformations and finite difference dispersion for linear advection, predict which grid yields lower spatial dispersion error (phase speed error) for the advected single-mode initial condition.\n\nChoose the best answer:\n\nA. Grid $\\,\\mathcal{G}_1\\,$ yields lower dispersion error because near-orthogonality, bounded aspect ratio, and smooth metrics minimize anisotropic phase error and suppress metric-induced variable-coefficient effects.\n\nB. Grid $\\,\\mathcal{G}_2\\,$ yields lower dispersion error because elongated cells in the streamwise direction reduce truncation error in the direction of advection, and skewness improves alignment with streamlines.\n\nC. Both grids yield comparable dispersion error because they have the same number of points, the same computational step sizes $\\,\\Delta_\\xi\\,$ and $\\,\\Delta_\\eta\\,$, and satisfy the Geometric Conservation Law.\n\nD. The comparison is indeterminate without time-step details, because dispersion error is dominated by temporal discretization rather than spatial grid quality in this setup.",
            "solution": "The user wants me to analyze a problem in computational fluid dynamics concerning the numerical dispersion error on two different curvilinear grids.\n\n### Step 1: Extract Givens\n-   **Governing Equation**: The two-dimensional linear scalar advection equation for a passive scalar $\\phi(x,y,t)$ is\n    $$ \\frac{\\partial \\phi}{\\partial t} + u \\frac{\\partial \\phi}{\\partial x} + v \\frac{\\partial \\phi}{\\partial y} = 0 $$\n-   **Velocity Field**: Uniform velocity components are $u = U  0$ and $v = 0$. The equation simplifies to $\\frac{\\partial \\phi}{\\partial t} + U \\frac{\\partial \\phi}{\\partial x} = 0$.\n-   **Physical Domain**: A smooth channel of length $L_x$ and height $L_y$ containing a streamlined bump.\n-   **Initial Condition**: $\\phi(x,y,0) = \\sin\\left(\\frac{2\\pi x}{L_x}\\right)$. This is a single Fourier mode with physical wavenumber $k_x = 2\\pi/L_x$ and $k_y = 0$.\n-   **Numerical Scheme**:\n    -   A curvilinear coordinate transformation $(\\xi,\\eta) \\mapsto (x(\\xi,\\eta), y(\\xi,\\eta))$ is used.\n    -   The computational grid is uniform with $N_\\xi \\times N_\\eta$ points and uniform spacings $\\Delta_\\xi$ and $\\Delta_\\eta$.\n    -   Spatial derivatives are discretized using second-order central differences in computational coordinates $(\\xi, \\eta)$.\n    -   Time integration is second-order accurate.\n    -   The Courant–Friedrichs–Lewy (CFL) number is the same for all simulations.\n    -   The formulation is conservative and satisfies the Geometric Conservation Law (GCL) exactly.\n-   **Grid $\\mathcal{G}_1$**: Near-orthogonal and smooth.\n    -   Maximum skewness angle: $\\theta_{\\max}^{(1)} \\le 10^{\\circ}$ relative to the $x$-direction.\n    -   Maximum cell aspect ratio: $\\mathrm{AR}_{\\max}^{(1)} \\le 3$.\n    -   Metric smoothness: Per-cell relative variation of metric derivatives is bounded by $\\epsilon_1 \\le 0.05$.\n-   **Grid $\\mathcal{G}_2$**: Strongly skewed and stretched.\n    -   Maximum skewness angle: $\\theta_{\\max}^{(2)} \\le 35^{\\circ}$.\n    -   Maximum cell aspect ratio: $\\mathrm{AR}_{\\max}^{(2)} \\le 12$, with streamwise elongation.\n    -   Metric smoothness: Oscillatory with per-cell relative variation of metric derivatives bounded by $\\epsilon_2 \\le 0.30$, with oscillation wavelengths of $\\sim 4$ computational cells.\n-   **Assumptions**:\n    -   Both grids are sufficiently smooth for a well-posed discretization.\n    -   Boundary reflections are negligible.\n-   **Question**: Predict which grid yields lower spatial dispersion error (phase speed error).\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded in the theory of numerical methods for partial differential equations, specifically within computational fluid dynamics. The concepts used—linear advection, curvilinear coordinates, finite differences, dispersion error, grid quality metrics (skewness, aspect ratio, metric smoothness), and the Geometric Conservation Law—are standard and well-defined in the field.\n\nThe problem is well-posed. It provides a clear physical and numerical setup and asks for a qualitative comparison of a specific error type (spatial dispersion) based on explicitly stated differences in grid quality. The information provided is sufficient and self-consistent. The use of a single Fourier mode initial condition is a standard technique for analyzing numerical dispersion. The constraints and properties of the two grids are defined quantitatively.\n\nThe problem is objective and free of subjective claims. The question can be answered by applying first principles of truncation error analysis for finite difference schemes on curvilinear grids. The problem is not trivial; it requires a nuanced understanding of how grid geometric properties translate into numerical error terms in the transformed governing equation.\n\nAll criteria for a valid problem are met.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed to derive the solution.\n\n### Derivation\n\nThe governing equation in physical coordinates $(x,y)$ is:\n$$ \\frac{\\partial \\phi}{\\partial t} + U \\frac{\\partial \\phi}{\\partial x} = 0 $$\nWe transform this equation to computational coordinates $(\\xi,\\eta)$. Using the chain rule for derivatives, the equation transforms to a quasi-linear form:\n$$ \\frac{\\partial \\phi}{\\partial t} + (U\\xi_x) \\frac{\\partial \\phi}{\\partial \\xi} + (U\\eta_x) \\frac{\\partial \\phi}{\\partial \\eta} = 0 $$\nThe terms $\\xi_x = \\frac{\\partial \\xi}{\\partial x}$ and $\\eta_x = \\frac{\\partial \\eta}{\\partial x}$ are metric terms of the transformation. They can be expressed in terms of the derivatives of the physical coordinates with respect to the computational coordinates: $\\xi_x = y_\\eta/J$ and $\\eta_x = -y_\\xi/J$, where $J = x_\\xi y_\\eta - x_\\eta y_\\xi$ is the Jacobian of the transformation. The transformed equation is:\n$$ \\frac{\\partial \\phi}{\\partial t} + \\frac{U y_\\eta}{J} \\frac{\\partial \\phi}{\\partial \\xi} - \\frac{U y_\\xi}{J} \\frac{\\partial \\phi}{\\partial \\eta} = 0 $$\nThis is an advection equation in the $(\\xi, \\eta)$ space with variable advection speeds $C_\\xi(\\xi, \\eta) = U y_\\eta / J$ and $C_\\eta(\\xi, \\eta) = -U y_\\xi / J$.\n\nThe problem states that a second-order central difference scheme is used for the spatial derivatives on a uniform computational grid. The modified wavenumber analysis for a central difference operator $\\frac{\\partial}{\\partial \\xi} \\approx \\delta_\\xi$ on a wave $\\phi = e^{i(k_\\xi \\xi)}$ shows that the effective wavenumber $k'_\\xi$ is:\n$$ k'_\\xi = \\frac{\\sin(k_\\xi \\Delta\\xi)}{\\Delta\\xi} $$\nFor small $k_\\xi \\Delta\\xi$, this is $k'_\\xi \\approx k_\\xi - \\frac{(k_\\xi \\Delta\\xi)^2}{6}k_\\xi$. The numerical phase speed is thus different from the true phase speed, which is the source of dispersion error. The leading error term is proportional to the third derivative of the solution, $\\frac{\\partial^3 \\phi}{\\partial \\xi^3}$.\n\nHowever, this analysis is for constant coefficients. In our case, the coefficients $C_\\xi$ and $C_\\eta$ are functions of the grid metrics and vary with position. The truncation error of the numerical scheme includes not only the standard dispersion terms but also terms involving the derivatives of the metrics. For a conservative formulation, the discretized equation approximates $\\frac{\\partial (J\\phi)}{\\partial t} + \\frac{\\partial (U_\\xi \\phi)}{\\partial \\xi} + \\frac{\\partial (U_\\eta \\phi)}{\\partial \\eta} = 0$, where $U_\\xi$ and $U_\\eta$ are contravariant velocities. The leading truncation error terms for the spatial part are of the form:\n$$ \\text{LTE}_{\\text{space}} \\propto \\Delta\\xi^2 \\frac{\\partial^3 (U_\\xi \\phi)}{\\partial \\xi^3} + \\Delta\\eta^2 \\frac{\\partial^3 (U_\\eta \\phi)}{\\partial \\eta^3} $$\nExpanding these terms, for example $\\frac{\\partial^3 (U_\\xi \\phi)}{\\partial \\xi^3}$, yields terms like $U_\\xi \\frac{\\partial^3 \\phi}{\\partial \\xi^3}$ (the standard dispersion term), but also new terms involving derivatives of the metrics, such as $\\frac{\\partial U_\\xi}{\\partial \\xi} \\frac{\\partial^2 \\phi}{\\partial \\xi^2}$ and $\\frac{\\partial^2 U_\\xi}{\\partial \\xi^2} \\frac{\\partial \\phi}{\\partial \\xi}$. These new terms, often called variable-coefficient errors or metric-induced errors, can significantly increase the total numerical error, including dispersion.\n\nLet's compare the two grids based on this understanding:\n\n**Grid $\\mathcal{G}_1$ (High-Quality Grid):**\n1.  **Near-orthogonality ($\\theta_{\\max}^{(1)} \\le 10^{\\circ}$):** For a grid aligned with the coordinate axes, $y_\\xi = 0$. Small skewness means $y_\\xi$ is small. This makes the artificial cross-stream advection speed, $C_\\eta = -U y_\\xi/J$, small. The problem is numerically \"closer\" to the original one-dimensional advection, reducing a major source of anisotropic error.\n2.  **Smooth Metrics ($\\epsilon_1 \\le 0.05$):** The small value of $\\epsilon_1$ implies that the first derivatives of the mapping ($x_\\xi, y_\\xi$, etc.) vary smoothly and slowly. This means that the second and higher derivatives of the mapping functions ($x, y$) are small. Consequently, the derivatives of the metric terms (e.g., $\\frac{\\partial U_\\xi}{\\partial \\xi}$) are small. This suppresses the magnitude of the additional metric-induced error terms in the truncation error expansion.\n3.  **Bounded Aspect Ratio ($\\mathrm{AR}_{\\max}^{(1)} \\le 3$):** A moderate aspect ratio helps maintain similar resolution in different computational directions, which is generally beneficial for controlling anisotropic errors, especially when the flow is not perfectly aligned with a grid direction.\n\n**Grid $\\mathcal{G}_2$ (Low-Quality Grid):**\n1.  **Strong Skewness ($\\theta_{\\max}^{(2)} \\le 35^{\\circ}$):** A large skewness angle implies a large value for $y_\\xi$ in some regions. This results in a large artificial cross-stream advection speed $C_\\eta$. The numerical scheme must accurately cancel the effects of advection in the $\\xi$ and $\\eta$ computational directions to reproduce the purely $x$-directional physical advection. Central difference schemes perform poorly in this situation, leading to significant phase (dispersion) and amplitude errors.\n2.  **Oscillatory Metrics ($\\epsilon_2 \\le 0.30$):** This is the most damaging property. The large and oscillatory nature of the metric derivatives (indicated by $\\epsilon_2 = 0.30$) means that terms like $\\frac{\\partial U_\\xi}{\\partial \\xi}$ and $\\frac{\\partial^2 U_\\xi}{\\partial \\xi^2}$ are large and rapidly changing. These terms introduce large, spurious source terms in the modified differential equation, which pollute the solution with unphysical oscillations and severely degrade the phase accuracy. The fact that the metric oscillations have a wavelength of $\\sim 4$ grid cells is particularly detrimental, as it can resonantly interact with the numerical scheme to produce high-wavenumber errors.\n3.  **High Aspect Ratio ($\\mathrm{AR}_{\\max}^{(2)} \\le 12$):** While cell elongation in the flow direction can sometimes be efficient, a high aspect ratio coupled with high skewness is known to be a potent source of numerical error.\n\n**Conclusion:**\nGrid $\\mathcal{G}_1$ is designed to minimize the sources of numerical error specific to curvilinear grids. Its near-orthogonality, moderate aspect ratio, and most importantly, smooth metrics ensure that the truncation error is small and dominated by the inherent, well-behaved dispersion of the underlying central difference scheme.\nGrid $\\mathcal{G}_2$ exhibits features (high skewness, high aspect ratio, and non-smooth, oscillatory metrics) that are known to generate large numerical errors. The oscillatory metrics, in particular, will introduce large metric-induced dispersion and dissipation, leading to a much larger overall phase error than on Grid $\\mathcal{G}_1$.\n\nTherefore, Grid $\\mathcal{G}_1$ will yield significantly lower spatial dispersion error.\n\n### Option-by-Option Analysis\n\n**A. Grid $\\,\\mathcal{G}_1\\,$ yields lower dispersion error because near-orthogonality, bounded aspect ratio, and smooth metrics minimize anisotropic phase error and suppress metric-induced variable-coefficient effects.**\nThis statement correctly identifies the key factors. Near-orthogonality and bounded aspect ratio reduce anisotropic error. Smooth metrics are crucial for suppressing the \"variable-coefficient effects,\" which are the additional error terms arising from the derivatives of the metrics. This option provides a complete and accurate explanation. This statement is **Correct**.\n\n**B. Grid $\\,\\mathcal{G}_2\\,$ yields lower dispersion error because elongated cells in the streamwise direction reduce truncation error in the direction of advection, and skewness improves alignment with streamlines.**\nThis statement is incorrect. While streamwise cell elongation can be part of an efficient grid design strategy, it does not inherently reduce truncation error per point. More importantly, skewness is detrimental to accuracy; it represents a *misalignment* with the Cartesian-aligned streamlines of this problem and introduces large artificial cross-flow advection in the computational domain. This statement is **Incorrect**.\n\n**C. Both grids yield comparable dispersion error because they have the same number of points, the same computational step sizes $\\,\\Delta_\\xi\\,$ and $\\,\\Delta_\\eta\\,$, and satisfy the Geometric Conservation Law.**\nThis is a flawed argument. Having the same number of points does not guarantee comparable accuracy if the grid quality is vastly different. The truncation error on a curvilinear grid depends critically on the metric terms and their derivatives, not just on $\\Delta\\xi$ and $\\Delta\\eta$. Satisfying the GCL is a necessary condition for consistency and avoiding spurious source terms for a uniform flow, but it does not remove the higher-order truncation errors (like dispersion) that are amplified by poor grid quality. This statement is **Incorrect**.\n\n**D. The comparison is indeterminate without time-step details, because dispersion error is dominated by temporal discretization rather than spatial grid quality in this setup.**\nThis statement is incorrect. The problem specifically asks for a comparison of *spatial* dispersion error. The effect of spatial grid quality on numerical error can be, and often is, very large and dominant, especially when comparing a high-quality grid to a poor-quality one. Given the extreme defects of Grid $\\mathcal{G}_2$, it is almost certain that the spatial error sources will dominate. The problem is not indeterminate; the principles of numerical analysis allow for a clear prediction. This statement is **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}