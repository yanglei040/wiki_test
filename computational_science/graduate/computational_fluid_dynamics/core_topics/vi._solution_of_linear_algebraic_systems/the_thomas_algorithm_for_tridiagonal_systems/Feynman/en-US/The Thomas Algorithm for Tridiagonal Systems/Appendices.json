{
    "hands_on_practices": [
        {
            "introduction": "The most effective way to grasp the mechanics of the Thomas algorithm is through direct application. This first exercise provides a small, concrete $4 \\times 4$ tridiagonal system for you to solve step-by-step . By manually performing the forward elimination and backward substitution passes, you will build a solid procedural understanding of how the algorithm efficiently transforms and solves the system.",
            "id": "1030146",
            "problem": "Consider the tridiagonal system of equations:\n$$\n\\begin{cases}\n2x_1 - x_2 &= 3 \\\\\n-x_1 + 3x_2 - 2x_3 &= 1 \\\\\n-\\dfrac{1}{2}x_2 + 4x_3 - x_4 &= 0 \\\\\n-\\dfrac{3}{2}x_3 + 5x_4 &= 2\n\\end{cases}\n$$\nSolve this system using the Thomas algorithm and provide the value of $x_4$. The Thomas algorithm consists of a forward sweep to modify coefficients and a backward sweep to compute solutions starting from the last variable.",
            "solution": "The Thomas algorithm solves the tridiagonal system $A\\mathbf{x} = \\mathbf{d}$ by first decomposing $A$ into lower and upper bidiagonal matrices, $A=LU$, and then solving $L\\mathbf{y} = \\mathbf{d}$ (forward substitution) and $U\\mathbf{x} = \\mathbf{y}$ (backward substitution).\n\nWe define the system using the standard notation:\n- Sub-diagonal $a_i$ (for $i=2, \\dots, 4$): e.g., $a_2=-1$\n- Main diagonal $b_i$ (for $i=1, \\dots, 4$): e.g., $b_1=2$\n- Super-diagonal $c_i$ (for $i=1, \\dots, 3$): e.g., $c_1=-1$\n- Right-hand side vector $d_i$: e.g., $d_1=3$\n\n**1. LU Factorization and Forward Substitution:**\nWe compute the diagonal of the upper matrix $U$ (let's call it $\\tilde{b}_i$) and the intermediate vector $\\mathbf{y}$.\n\n- For $i=1$:\n  $\\tilde{b}_1 = b_1 = 2$\n  $y_1 = d_1 = 3$\n\n- For $i=2$:\n  The multiplier is $l_2 = a_2 / \\tilde{b}_1 = (-1) / 2 = -\\dfrac{1}{2}$.\n  $\\tilde{b}_2 = b_2 - l_2 c_1 = 3 - (-\\dfrac{1}{2})(-1) = \\dfrac{5}{2}$.\n  $y_2 = d_2 - l_2 y_1 = 1 - (-\\dfrac{1}{2})(3) = \\dfrac{5}{2}$.\n\n- For $i=3$:\n  The multiplier is $l_3 = a_3 / \\tilde{b}_2 = (-\\dfrac{1}{2}) / (\\dfrac{5}{2}) = -\\dfrac{1}{5}$.\n  $\\tilde{b}_3 = b_3 - l_3 c_2 = 4 - (-\\dfrac{1}{5})(-2) = \\dfrac{18}{5}$.\n  $y_3 = d_3 - l_3 y_2 = 0 - (-\\dfrac{1}{5})(\\dfrac{5}{2}) = \\dfrac{1}{2}$.\n\n- For $i=4$:\n  The multiplier is $l_4 = a_4 / \\tilde{b}_3 = (-\\dfrac{3}{2}) / (\\dfrac{18}{5}) = -\\dfrac{5}{12}$.\n  $\\tilde{b}_4 = b_4 - l_4 c_3 = 5 - (-\\dfrac{5}{12})(-1) = \\dfrac{55}{12}$.\n  $y_4 = d_4 - l_4 y_3 = 2 - (-\\dfrac{5}{12})(\\dfrac{1}{2}) = \\dfrac{53}{24}$.\n\nThe forward pass gives us the system $U\\mathbf{x}=\\mathbf{y}$, where the diagonal of $U$ is $\\tilde{b}_i$, the super-diagonal is $c_i$, and the RHS is $y_i$.\n\n**2. Backward Substitution:**\nWe solve for $x_i$ starting from the last equation.\n\n- For $x_4$:\n  $\\tilde{b}_4 x_4 = y_4 \\implies x_4 = y_4 / \\tilde{b}_4 = (\\dfrac{53}{24}) / (\\dfrac{55}{12}) = \\dfrac{53}{24} \\cdot \\dfrac{12}{55} = \\dfrac{53}{110}$.\n\nThus, $x_4 = \\dfrac{53}{110}$.",
            "answer": "$$ \\boxed{\\dfrac{53}{110}} $$"
        },
        {
            "introduction": "Having mastered the mechanics, we now turn to the practical significance of the Thomas algorithm. This practice problem situates the algorithm within a classic Computational Fluid Dynamics (CFD) context—the discretization of a 1D diffusion equation . You will implement and compare the specialized Thomas algorithm against a general-purpose LU solver, providing a quantitative understanding of its linear-time, $O(n)$, efficiency versus the cubic-time, $O(n^3)$, cost of dense matrix methods.",
            "id": "3383321",
            "problem": "Consider the one-dimensional steady diffusion equation, a canonical model in Computational Fluid Dynamics (CFD), given by $-\\dfrac{d^2 u}{dx^2} = f(x)$ on the unit interval $[0,1]$ with homogeneous Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 0$. Using a uniform grid with $n$ interior nodes, grid spacing $h = \\dfrac{1}{n+1}$, and the second-order central difference approximation for the second derivative, one arrives at a linear system $A \\mathbf{u} = \\mathbf{b}$ where $A$ is tridiagonal with entries $-1$ on the sub- and super-diagonals and $2$ on the main diagonal. Explicitly, $A \\in \\mathbb{R}^{n \\times n}$ has $a_i = -1$ for $i = 2,\\dots,n$, $b_i = 2$ for $i = 1,\\dots,n$, and $c_i = -1$ for $i = 1,\\dots,n-1$, so that $A$ is the Toeplitz tridiagonal matrix corresponding to this discretization.\n\nFrom the perspective of numerical linear algebra, there are two classical ways to solve $A \\mathbf{x} = \\mathbf{b}$ in this setting:\n- The Thomas algorithm (tridiagonal Gaussian elimination without pivoting), which exploits the tridiagonal structure.\n- A general-purpose dense solver based on Lower-Upper (LU) factorization with partial pivoting, which ignores sparsity and treats $A$ as a dense matrix.\n\nStarting only from the discretization described above, implement both solvers and compare their numerical accuracy and computational cost on the same tridiagonal system. Construct a synthetic right-hand side guaranteeing a known exact solution as follows: For a given $n$, define the exact vector $\\mathbf{x}^{\\star} \\in \\mathbb{R}^n$ by $x_i^{\\star} = \\sin\\!\\left(\\pi \\dfrac{i}{n+1}\\right)$ for $i = 1,\\dots,n$. Then set $\\mathbf{b} = A \\mathbf{x}^{\\star}$. For each solver, compute:\n- The relative $2$-norm error $e = \\dfrac{\\lVert \\mathbf{x} - \\mathbf{x}^{\\star} \\rVert_2}{\\lVert \\mathbf{x}^{\\star} \\rVert_2}$,\n- The $2$-norm residual $r = \\lVert \\mathbf{b} - A \\mathbf{x} \\rVert_2$.\n\nFor computational cost, report operation counts as follows:\n- For the Thomas algorithm, use the exact count $F_{\\mathrm{T}}(n) = 8n - 7$, obtained by counting each addition, subtraction, multiplication, and division as one floating-point operation.\n- For the dense LU solver with partial pivoting, use the standard dense estimate $F_{\\mathrm{LU}}(n) = \\dfrac{2}{3} n^3 + 2 n^2$, covering factorization plus forward and backward substitution.\n\nYour implementation must be a complete, runnable program that:\n- Constructs $A$ and $\\mathbf{b}$ from the above specification for each test case,\n- Solves the system by both methods,\n- Computes the prescribed accuracy metrics and cost estimates,\n- Produces output in the specified format.\n\nTest suite:\n- Use the following set of interior-node counts $n$ to test different regimes and edge cases: $n \\in \\{\\,1,\\,2,\\,50,\\,400\\,\\}$.\n\nQuantifiable answers:\n- For each test case $n$, produce a list of six floats: $[e_{\\mathrm{T}}, e_{\\mathrm{LU}}, r_{\\mathrm{T}}, r_{\\mathrm{LU}}, F_{\\mathrm{T}}(n), F_{\\mathrm{LU}}(n)]$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each item is the list corresponding to one test case in the order $n = 1$, $n = 2$, $n = 50$, $n = 400$. For example: $[\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,]$.\n- All reported quantities are dimensionless real numbers (no physical units). Angles are not used, and no percentages are required; any ratios must be provided as real numbers.",
            "solution": "The problem presented is valid. It is a well-posed, scientifically grounded problem in numerical linear algebra with direct applications to computational fluid dynamics. All necessary data and definitions are provided, and there are no contradictions or ambiguities.\n\nThe problem requires a comparison of two distinct numerical methods for solving a linear system $A \\mathbf{x} = \\mathbf{b}$ that arises from the finite difference discretization of a one-dimensional steady diffusion equation. The two methods are the Thomas algorithm, a specialized solver for tridiagonal systems, and a general-purpose dense solver based on LU factorization with partial pivoting.\n\nThe governing partial differential equation is the one-dimensional Poisson equation on the unit interval $x \\in [0, 1]$:\n$$\n-\\frac{d^2 u}{dx^2} = f(x)\n$$\nwith homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$.\n\nA uniform grid with $n$ interior nodes $x_i = i h$ for $i=1, \\dots, n$ is introduced, where the grid spacing is $h = \\frac{1}{n+1}$. The boundary points are $x_0 = 0$ and $x_{n+1} = 1$. Using a second-order central difference approximation for the second derivative at each interior node $x_i$,\n$$\n\\frac{d^2 u}{dx^2}\\bigg|_{x_i} \\approx \\frac{u(x_{i-1}) - 2u(x_i) + u(x_{i+1})}{h^2} = \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2}\n$$\nsubstituting this into the governing equation gives a system of $n$ linear equations:\n$$\n-\\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} = f(x_i) \\quad \\text{for } i = 1, \\dots, n\n$$\nwhere $u_0 = u(0) = 0$ and $u_{n+1} = u(1) = 0$. Rearranging, we have:\n$$\n-u_{i-1} + 2u_i - u_{i+1} = h^2 f(x_i)\n$$\nThis can be expressed as a matrix system $A \\mathbf{u} = \\mathbf{b}$, where $\\mathbf{u} = [u_1, u_2, \\dots, u_n]^T$ is the vector of unknown values at the interior nodes, $\\mathbf{b} = h^2 [f(x_1), \\dots, f(x_n)]^T$, and $A$ is the $n \\times n$ tridiagonal matrix defined in the problem statement:\n$$\nA = \\begin{pmatrix}\n2 & -1 & & & \\\\\n-1 & 2 & -1 & & \\\\\n& \\ddots & \\ddots & \\ddots & \\\\\n& & -1 & 2 & -1 \\\\\n& & & -1 & 2\n\\end{pmatrix}\n$$\nThis matrix is symmetric and positive-definite. It is also strictly diagonally dominant for the first and last rows and weakly diagonally dominant for all other rows. These properties are crucial for the stability of numerical solvers.\n\nThe problem specifies a synthetic right-hand side vector $\\mathbf{b}$ by first defining an exact solution $\\mathbf{x}^{\\star}$ and then computing $\\mathbf{b} = A \\mathbf{x}^{\\star}$. The exact solution has components $x_i^{\\star} = \\sin(\\pi \\frac{i}{n+1})$ for $i=1, \\dots, n$. This method, known as the Method of Manufactured Solutions, allows for exact quantification of numerical error.\n\n**Method 1: Thomas Algorithm**\n\nThe Thomas algorithm is an efficient specialized method for solving tridiagonal systems of equations. It is a form of Gaussian elimination that avoids operations on the zero elements of the matrix, resulting in a computational cost of order $O(n)$. It consists of two stages: a forward elimination pass and a backward substitution pass.\n\nGiven a tridiagonal system with sub-diagonal $a_i$ ($i=2, \\dots, n$), main diagonal $d_i$ ($i=1, \\dots, n$), and super-diagonal $c_i$ ($i=1, \\dots, n-1$), and a right-hand side vector $r_i$:\n$$\na_i x_{i-1} + d_i x_i + c_i x_{i+1} = r_i\n$$\nThe problem statement uses $b_i$ for the main diagonal, so we use that notation here ($d_i \\equiv b_i$):\n1.  **Forward Elimination**: The algorithm modifies the super-diagonal coefficients $c_i$ and the right-hand side vector $r_i$. Let the modified coefficients be $c'_i$ and $r'_i$.\n    $$\n    c'_1 = \\frac{c_1}{b_1} \\quad ; \\quad r'_1 = \\frac{r_1}{b_1}\n    $$\n    For $i = 2, \\dots, n-1$:\n    $$\n    c'_i = \\frac{c_i}{b_i - a_i c'_{i-1}}\n    $$\n    And for $i = 2, \\dots, n$:\n    $$\n    r'_i = \\frac{r_i - a_i r'_{i-1}}{b_i - a_i c'_{i-1}}\n    $$\n2.  **Backward Substitution**: The solution vector $\\mathbf{x}$ is computed in reverse order.\n    $$\n    x_n = r'_n\n    $$\n    For $i = n-1, \\dots, 1$:\n    $$\n    x_i = r'_i - c'_i x_{i+1}\n    $$\nBecause the matrix $A$ is diagonally dominant, the denominator $b_i - a_i c'_{i-1}$ is never zero, ensuring the algorithm is well-defined and numerically stable without pivoting. The computational cost is given as $F_{\\mathrm{T}}(n) = 8n - 7$ floating-point operations.\n\n**Method 2: Dense LU Factorization with Partial Pivoting**\n\nThis is a general-purpose method applicable to any invertible square matrix. It does not exploit the tridiagonal structure of $A$. The method first factorizes the matrix $A$ into a product $PA = LU$, where $P$ is a permutation matrix (representing row swaps for numerical stability, known as partial pivoting), $L$ is a unit lower triangular matrix, and $U$ is an upper triangular matrix.\n\nThe system $A\\mathbf{x} = \\mathbf{b}$ is transformed into $PA\\mathbf{x} = P\\mathbf{b}$, which becomes $LU\\mathbf{x} = P\\mathbf{b}$. This is solved in two steps:\n1.  **Forward Substitution**: Solve the lower triangular system $L\\mathbf{y} = P\\mathbf{b}$ for $\\mathbf{y}$.\n2.  **Backward Substitution**: Solve the upper triangular system $U\\mathbf{x} = \\mathbf{y}$ for $\\mathbf{x}$.\n\nWhile robust, this approach is computationally much more expensive for a tridiagonal matrix. The cost is dominated by the factorization step, which for a dense $n \\times n$ matrix is $O(n^3)$. The problem provides the standard cost estimate $F_{\\mathrm{LU}}(n) = \\frac{2}{3}n^3 + 2n^2$.\n\n**Metrics for Comparison**\n\nFor each solver, we compute two key metrics:\n1.  **Relative 2-Norm Error**: $e = \\frac{\\lVert \\mathbf{x} - \\mathbf{x}^{\\star} \\rVert_2}{\\lVert \\mathbf{x}^{\\star} \\rVert_2}$. This measures how close the computed solution $\\mathbf{x}$ is to the known exact solution $\\mathbf{x}^{\\star}$. A smaller value indicates higher accuracy.\n2.  **2-Norm Residual**: $r = \\lVert \\mathbf{b} - A \\mathbf{x} \\rVert_2$. This measures how well the computed solution $\\mathbf{x}$ satisfies the original equation. A small residual does not always guarantee a small error, especially for ill-conditioned matrices, but it is an important indicator of solver performance.\n\nThe implementation will proceed by iterating through the specified values of $n$, constructing the matrix $A$ and vectors $\\mathbf{x}^{\\star}$ and $\\mathbf{b}$ for each $n$, applying both solvers, and computing the six specified quantities ($e_{\\mathrm{T}}$, $e_{\\mathrm{LU}}$, $r_{\\mathrm{T}}$, $r_{\\mathrm{LU}}$, $F_{\\mathrm{T}}(n)$, $F_{\\mathrm{LU}}(n)$).",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve as dense_solve\n\ndef thomas_solver(a, b, c, d):\n    \"\"\"\n    Solves a tridiagonal system Ax = d.\n    'a' is the sub-diagonal (n-1 elements), 'b' is the main diagonal (n elements),\n    'c' is the super-diagonal (n-1 elements), 'd' is the RHS vector (n elements).\n    The problem statement uses 1-based indexing for math notation, but here we\n    use 0-based indexing standard in programming.\n    a: sub-diagonal, a[i] is A[i+1, i]\n    b: main-diagonal, b[i] is A[i, i]\n    c: super-diagonal, c[i] is A[i, i+1]\n    \"\"\"\n    n = len(d)\n    if n == 0:\n        return np.array([])\n    if n == 1:\n        return np.array([d[0] / b[0]])\n\n    # Create modifiable copies of the super-diagonal and RHS vector\n    c_prime = np.zeros(n - 1)\n    d_prime = np.zeros(n)\n    \n    # Forward elimination\n    c_prime[0] = c[0] / b[0]\n    d_prime[0] = d[0] / b[0]\n    \n    for i in range(1, n - 1):\n        denominator = b[i] - a[i - 1] * c_prime[i - 1]\n        c_prime[i] = c[i] / denominator\n        d_prime[i] = (d[i] - a[i - 1] * d_prime[i - 1]) / denominator\n\n    denominator = b[n - 1] - a[n - 2] * c_prime[n - 2]\n    d_prime[n - 1] = (d[n - 1] - a[n - 2] * d_prime[n - 2]) / denominator\n    \n    # Backward substitution\n    x = np.zeros(n)\n    x[n - 1] = d_prime[n - 1]\n    for i in range(n - 2, -1, -1):\n        x[i] = d_prime[i] - c_prime[i] * x[i + 1]\n        \n    return x\n\ndef solve():\n    \"\"\"\n    Main function to run the comparison for the test suite.\n    \"\"\"\n    test_cases = [1, 2, 50, 400]\n    results = []\n\n    for n in test_cases:\n        # Step 1: Construct the linear system A x = b with a known solution x_star\n        \n        # Define the matrix A as a dense matrix for the LU solver and for calculating residuals\n        if n == 1:\n            A = np.array([[2.0]])\n        else:\n            main_diag_vals = np.full(n, 2.0)\n            sub_diag_vals = np.full(n - 1, -1.0)\n            sup_diag_vals = np.full(n - 1, -1.0)\n            A = np.diag(main_diag_vals) + np.diag(sup_diag_vals, k=1) + np.diag(sub_diag_vals, k=-1)\n        \n        # Define the exact solution vector x_star\n        i = np.arange(1, n + 1)\n        x_star = np.sin(np.pi * i / (n + 1))\n        \n        # Compute the right-hand side vector b = A * x_star\n        b = A @ x_star\n        \n        # Step 2: Solve the system using both methods\n        \n        # Method 1: Thomas Algorithm\n        if n > 1:\n            x_T = thomas_solver(sub_diag_vals, main_diag_vals, sup_diag_vals, b)\n        else: # Handle n=1 case for Thomas algorithm\n            x_T = thomas_solver(np.array([]), np.array([2.0]), np.array([]), b)\n\n        # Method 2: Dense LU solver with partial pivoting\n        x_LU = dense_solve(A, b)\n        \n        # Step 3: Compute accuracy metrics and computational costs\n        \n        # Relative 2-norm error\n        norm_x_star = np.linalg.norm(x_star)\n        e_T = np.linalg.norm(x_T - x_star) / norm_x_star\n        e_LU = np.linalg.norm(x_LU - x_star) / norm_x_star\n        \n        # 2-norm residual\n        r_T = np.linalg.norm(b - A @ x_T)\n        r_LU = np.linalg.norm(b - A @ x_LU)\n        \n        # Computational cost estimates\n        F_T = float(8 * n - 7)\n        F_LU = (2.0 / 3.0) * n**3 + 2.0 * n**2\n        \n        # Store the results for this test case\n        results.append([e_T, e_LU, r_T, r_LU, F_T, F_LU])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Our final practice problem delves into a crucial, advanced concept: the interaction between the linear solver and the underlying discretization scheme. While the Thomas algorithm can provide an exact solution to a tridiagonal system, this does not guarantee the physical fidelity of the result if the system itself arises from an unstable numerical approximation . By analyzing a 1D convection-diffusion problem, you will see how a standard central-differencing scheme can produce non-physical oscillations in convection-dominated flows, a vital lesson on the importance of discretization properties like the $M$-matrix criterion.",
            "id": "3383308",
            "problem": "Consider steady one-dimensional transport of a passive scalar $\\,\\phi(x)\\,$ governed by the conservation law with constant properties,\n$$ \\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\rho v \\frac{d\\phi}{dx} = 0, $$\non the interval $\\,x \\in [0,L]\\,$ with Dirichlet boundary conditions $\\,\\phi(0)=1\\,$ and $\\,\\phi(L)=0\\,$. Let the domain length be $\\,L=1\\,$ and discretize it into $\\,N=4\\,$ interior control volumes of uniform width $\\,\\Delta x = L/(N+1)\\,$ on a uniform grid with unit cross-sectional area $\\,A=1\\,$. Use central differencing for the convective and diffusive fluxes at the cell faces in a cell-centered finite volume formulation to obtain a tridiagonal linear system for the interior nodal values $\\,\\{\\phi_i\\}_{i=1}^{N}\\,$.\n\nTake constant positive flow $\\,v>0\\,$ and constants $\\,\\Gamma=0.2\\,$ and $\\,\\rho v = 4\\,$ so that the face mass flux is $\\,F=\\rho v\\,$ and the diffusive conductance is $\\,D=\\Gamma/\\Delta x\\,$. Assemble the tridiagonal system in the coefficient form\n$$ a_i\\,\\phi_{i-1} + b_i\\,\\phi_i + c_i\\,\\phi_{i+1} = d_i, \\quad i=1,\\dots,N, $$\nwith the boundary values incorporated into the right-hand side where needed. Then, solve this tridiagonal system exactly using the Thomas algorithm to obtain the discrete solution. In the process, explicitly identify the central-differencing coefficients $\\,a_W\\,$ and $\\,a_E\\,$ at a generic interior node and determine whether the resulting off-diagonal entries in the system matrix satisfy the nonpositivity requirement of a nonsingular $\\,M$-matrix. Conclude whether the discrete solution is monotone between the boundary values.\n\nWhat is the computed value of the interior nodal unknown $\\,\\phi_3\\,$? Express your answer as a dimensionless number rounded to four significant figures.",
            "solution": "We start from the steady one-dimensional convection–diffusion balance with constant properties,\n$$ \\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\rho v \\frac{d\\phi}{dx} = 0, $$\nand apply a cell-centered finite volume method on $\\,x\\in[0,L]\\,$ with $\\,L=1\\,$, $\\,N=4\\,$ interior cells, and uniform spacing $\\,\\Delta x = L/(N+1) = 1/5 = 0.2\\,$. The cross-sectional area is $\\,A=1\\,$, the diffusivity is $\\,\\Gamma=0.2\\,$, and the mass flux is $\\,F=\\rho v = 4\\,$. The diffusive conductance per face is\n$$ D \\equiv \\frac{\\Gamma}{\\Delta x} = \\frac{0.2}{0.2} = 1. $$\n\nUsing central differencing for both convection and diffusion at each interior control volume, the standard finite volume balance can be written in the canonical form\n$$ a_P\\,\\phi_P = a_W\\,\\phi_W + a_E\\,\\phi_E, $$\nwhere for positive flow direction $\\,v&gt;0\\,$ the central-differencing coefficients at an interior node are\n$$ a_W = D + \\frac{F}{2}, \\qquad a_E = D - \\frac{F}{2}, \\qquad a_P = a_W + a_E. $$\nSubstituting $\\,D=1\\,$ and $\\,F=4\\,$ gives\n$$ a_W = 1 + \\frac{4}{2} = 3, \\qquad a_E = 1 - \\frac{4}{2} = -1, \\qquad a_P = 3 + (-1) = 2. $$\n\nTo expose the matrix structure, rearrange each interior equation as\n$$ a_P\\,\\phi_i - a_W\\,\\phi_{i-1} - a_E\\,\\phi_{i+1} = 0. $$\nIn coefficient-matrix notation, the diagonal coefficient is $\\,b_i=a_P=2\\,$, the subdiagonal is $\\,a_i=-a_W=-3\\,$, and the superdiagonal is $\\,c_i=-a_E=1\\,$. Incorporating the Dirichlet boundary conditions $\\,\\phi_0=1\\,$ and $\\,\\phi_5=0\\,$ at the first and last interior equations yields\n- For $\\,i=1\\,$:\n$$ b_1\\,\\phi_1 + c_1\\,\\phi_2 = d_1, \\quad \\text{with} \\quad b_1=2,\\; c_1=1,\\; d_1=a_W\\,\\phi_0=3\\cdot 1=3. $$\n- For $\\,i=2,3\\,$:\n$$ a_i\\,\\phi_{i-1} + b_i\\,\\phi_i + c_i\\,\\phi_{i+1} = d_i, \\quad \\text{with} \\quad a_i=-3,\\; b_i=2,\\; c_i=1,\\; d_i=0. $$\n- For $\\,i=4\\,$:\n$$ a_4\\,\\phi_3 + b_4\\,\\phi_4 = d_4, \\quad \\text{with} \\quad a_4=-3,\\; b_4=2,\\; d_4=a_E\\,\\phi_5=(-1)\\cdot 0=0. $$\n\nObserve the $\\,M$-matrix criterion: in the assembled coefficient matrix, the off-diagonal entries are $\\,a_i=-a_W=-3<0\\,$ and $\\,c_i=-a_E=1>0\\,$. The positivity of $\\,c_i\\,$ violates the nonpositivity of off-diagonal entries required of a nonsingular $\\,M$-matrix. This violation arises because $\\,a_E<0\\,$ for the chosen parameters, equivalently the cell Péclet number $\\,\\text{Pe} = F/D = 4\\,$ exceeds the central-differencing threshold $\\,2\\,$. Hence, non-monotone discrete solutions are possible.\n\nWe now solve the tridiagonal system using the Thomas algorithm. Write the system in the standard tridiagonal form\n$$ a_i \\phi_{i-1} + b_i \\phi_i + c_i \\phi_{i+1} = d_i, \\quad i=1,\\dots,4, $$\nwith\n$$\n\\begin{aligned}\n& a_1=0,\\; b_1=2,\\; c_1=1,\\; d_1=3, \\\\\n& a_2=-3,\\; b_2=2,\\; c_2=1,\\; d_2=0, \\\\\n& a_3=-3,\\; b_3=2,\\; c_3=1,\\; d_3=0, \\\\\n& a_4=-3,\\; b_4=2,\\; c_4=0,\\; d_4=0.\n\\end{aligned}\n$$\n\nForward elimination step. Define modified coefficients $\\,\\tilde{c}_i\\,$ and $\\,\\tilde{d}_i\\,$ by\n$$ \\tilde{c}_1 = \\frac{c_1}{b_1}, \\qquad \\tilde{d}_1 = \\frac{d_1}{b_1}, $$\nand for $\\,i=2,\\dots,4\\,$,\n$$ \\beta_i = b_i - a_i \\tilde{c}_{i-1}, \\qquad \\tilde{c}_i = \\frac{c_i}{\\beta_i}, \\qquad \\tilde{d}_i = \\frac{d_i - a_i \\tilde{d}_{i-1}}{\\beta_i}. $$\nCompute sequentially:\n- For $\\,i=1\\,$:\n$$ \\tilde{c}_1 = \\frac{1}{2} = \\frac{1}{2}, \\qquad \\tilde{d}_1 = \\frac{3}{2}. $$\n- For $\\,i=2\\,$:\n$$ \\beta_2 = 2 - (-3)\\cdot \\frac{1}{2} = 2 + \\frac{3}{2} = \\frac{7}{2}, \\quad \\tilde{c}_2 = \\frac{1}{\\beta_2} = \\frac{2}{7}, \\quad \\tilde{d}_2 = \\frac{0 - (-3)\\cdot \\frac{3}{2}}{\\frac{7}{2}} = \\frac{\\frac{9}{2}}{\\frac{7}{2}} = \\frac{9}{7}. $$\n- For $\\,i=3\\,$:\n$$ \\beta_3 = 2 - (-3)\\cdot \\frac{2}{7} = 2 + \\frac{6}{7} = \\frac{20}{7}, \\quad \\tilde{c}_3 = \\frac{1}{\\beta_3} = \\frac{7}{20}, \\quad \\tilde{d}_3 = \\frac{0 - (-3)\\cdot \\frac{9}{7}}{\\frac{20}{7}} = \\frac{\\frac{27}{7}}{\\frac{20}{7}} = \\frac{27}{20}. $$\n- For $\\,i=4\\,$:\n$$ \\beta_4 = 2 - (-3)\\cdot \\frac{7}{20} = 2 + \\frac{21}{20} = \\frac{61}{20}, \\quad \\tilde{d}_4 = \\frac{0 - (-3)\\cdot \\frac{27}{20}}{\\frac{61}{20}} = \\frac{\\frac{81}{20}}{\\frac{61}{20}} = \\frac{81}{61}. $$\n\nBack substitution step. Set\n$$ \\phi_4 = \\tilde{d}_4 = \\frac{81}{61}, $$\nand for $\\,i=3,2,1\\,$ compute\n$$ \\phi_i = \\tilde{d}_i - \\tilde{c}_i \\phi_{i+1}. $$\nThus,\n$$ \\phi_3 = \\tilde{d}_3 - \\tilde{c}_3 \\phi_4 = \\frac{27}{20} - \\frac{7}{20}\\cdot \\frac{81}{61} = \\frac{27}{20} - \\frac{567}{1220} = \\frac{1647 - 567}{1220} = \\frac{1080}{1220} = \\frac{54}{61}. $$\nFor completeness,\n$$ \\phi_2 = \\tilde{d}_2 - \\tilde{c}_2 \\phi_3 = \\frac{9}{7} - \\frac{2}{7}\\cdot \\frac{54}{61} = \\frac{63}{61}, \\qquad \\phi_1 = \\tilde{d}_1 - \\tilde{c}_1 \\phi_2 = \\frac{3}{2} - \\frac{1}{2}\\cdot \\frac{63}{61} = \\frac{60}{61}. $$\n\nThe computed interior profile $\\,\\{\\phi_i\\}\\,$ is\n$$ \\phi_1 = \\frac{60}{61}, \\quad \\phi_2 = \\frac{63}{61}, \\quad \\phi_3 = \\frac{54}{61}, \\quad \\phi_4 = \\frac{81}{61}. $$\nThese values oscillate relative to the boundary values $\\,\\phi(0)=1\\,$ and $\\,\\phi(1)=0\\,$, with $\\,\\phi_2>1\\,$ and $\\,\\phi_4>1\\,$, indicating a non-monotone discrete solution despite exact solution of the tridiagonal system by the Thomas algorithm. This non-monotonicity is consistent with the violation of the nonsingular $\\,M$-matrix condition due to the positive superdiagonal entry $\\,c_i=-a_E=1>0\\,$ induced by central differencing at $\\,\\text{Pe}=F/D=4>2\\,$.\n\nFinally, the requested nodal value is\n$$ \\phi_3 = \\frac{54}{61} \\approx 0.8852459016\\ldots, $$\nwhich rounded to four significant figures is $\\,0.8852\\,$ and is dimensionless.",
            "answer": "$$\\boxed{0.8852}$$"
        }
    ]
}