{
    "hands_on_practices": [
        {
            "introduction": "Before embarking on a complex numerical simulation of incompressible flow, one must first ensure the problem is mathematically well-posed. The fundamental law of mass conservation imposes a strict global constraint that the net flow across all boundaries of the domain must be zero. This hands-on practice  challenges you to apply the divergence theorem to diagnose and correct inconsistent boundary conditions, a critical and practical first step in any valid computational fluid dynamics analysis.",
            "id": "3353815",
            "problem": "Consider a two-dimensional incompressible flow in a rectangular domain $\\Omega = [0,L]\\times[0,H]$ with $L$ in meters and $H$ in meters. The governing kinematic constraint is the continuity equation $\\nabla\\cdot\\mathbf{u}=0$, where $\\mathbf{u}(x,y)=(u(x,y),v(x,y))$ is the velocity field. The boundary $\\partial\\Omega$ consists of the left inflow boundary at $x=0$, the right outflow boundary at $x=L$, and impermeable no-slip walls at $y=0$ and $y=H$. The outward unit normal is denoted by $\\mathbf{n}$.\n\nFundamental conservation for an incompressible flow requires the global flux balance $\\int_{\\partial\\Omega}\\mathbf{u}\\cdot\\mathbf{n}\\,dS=0$. Consider the following prescribed data:\n- Domain dimensions: $L=1.0$ meters and $H=0.4$ meters.\n- Left boundary ($x=0$) inflow condition: $u(0,y)=u_{\\text{in}}(y)$, $v(0,y)=0$, with\n$$\nu_{\\text{in}}(y)=U_{0}\\left[1-\\left(2\\frac{y}{H}-1\\right)^{2}\\right],\\quad U_{0}=1.2\\ \\text{meters per second},\\quad 0\\le y\\le H.\n$$\n- Right boundary ($x=L$) outflow condition: $u(L,y)=u_{\\text{out}}(y)$, $v(L,y)=0$, with\n$$\nu_{\\text{out}}(y)=U_{1},\\quad U_{1}=0.7\\ \\text{meters per second},\\quad 0\\le y\\le H.\n$$\n- Top and bottom walls ($y=H$ and $y=0$): impermeable, so $\\mathbf{u}\\cdot\\mathbf{n}=0$.\n\nThese boundary data violate the global incompressibility flux balance. Using only the continuity equation and the divergence theorem as the fundamental base, derive the unique uniform correction $\\delta$ to be added to the outflow profile so that the corrected outflow is $u_{\\text{out}}^{\\text{corr}}(y) = u_{\\text{out}}(y) + \\delta$, ensuring $\\int_{\\partial\\Omega}\\mathbf{u}\\cdot\\mathbf{n}\\,dS=0$ and restoring solvability of the pressure–velocity coupling. Compute $\\delta$ and provide its value in meters per second. Round your final result to four significant figures.",
            "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It presents a standard scenario in computational fluid dynamics where boundary conditions for an incompressible flow simulation must be adjusted to satisfy the global continuity constraint. The problem is valid and a solution can be derived.\n\nThe fundamental principle for an incompressible flow is the continuity equation, which states that the divergence of the velocity field $\\mathbf{u}$ is zero:\n$$\n\\nabla\\cdot\\mathbf{u} = 0\n$$\nApplying the divergence theorem to the velocity field $\\mathbf{u}$ over the domain $\\Omega$ yields:\n$$\n\\int_{\\Omega} (\\nabla\\cdot\\mathbf{u}) \\,dV = \\oint_{\\partial\\Omega} \\mathbf{u}\\cdot\\mathbf{n} \\,dS\n$$\nwhere $\\partial\\Omega$ is the boundary of the domain $\\Omega$ and $\\mathbf{n}$ is the outward-pointing unit normal vector. Since $\\nabla\\cdot\\mathbf{u}=0$ everywhere in $\\Omega$, the volume integral is zero. This imposes a global conservation constraint on the boundary values of the velocity:\n$$\n\\oint_{\\partial\\Omega} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = 0\n$$\nThis equation states that the net volumetric flux across the boundary of the domain must be zero. For the problem to be solvable, the prescribed boundary conditions must satisfy this constraint.\n\nThe boundary $\\partial\\Omega$ of the rectangular domain $\\Omega = [0,L]\\times[0,H]$ consists of four segments:\n1.  Left boundary (inflow): $x=0$, for $0 \\le y \\le H$.\n2.  Right boundary (outflow): $x=L$, for $0 \\le y \\le H$.\n3.  Bottom boundary (wall): $y=0$, for $0 \\le x \\le L$.\n4.  Top boundary (wall): $y=H$, for $0 \\le x \\le L$.\n\nThe total boundary integral can be split into four parts:\n$$\n\\oint_{\\partial\\Omega} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = \\int_{\\text{left}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS + \\int_{\\text{right}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS + \\int_{\\text{bottom}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS + \\int_{\\text{top}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = 0\n$$\nWe evaluate each integral:\n- On the top and bottom walls, the problem states they are impermeable, so $\\mathbf{u}\\cdot\\mathbf{n}=0$. On the bottom wall ($y=0$), the outward normal is $\\mathbf{n}=(0,-1)$, so $\\mathbf{u}\\cdot\\mathbf{n} = -v(x,0)$. On the top wall ($y=H$), the outward normal is $\\mathbf{n}=(0,1)$, so $\\mathbf{u}\\cdot\\mathbf{n} = v(x,H)$. The impermeability condition implies $v(x,0)=0$ and $v(x,H)=0$. Therefore, the flux through the top and bottom walls is zero:\n$$\n\\int_{\\text{bottom}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = 0 \\quad \\text{and} \\quad \\int_{\\text{top}} \\mathbf{u}\\cdot\\mathbf{n} \\,dS = 0\n$$\n- On the left boundary ($x=0$), the outward normal vector is $\\mathbf{n}=(-1,0)$. The velocity vector is $\\mathbf{u}(0,y)=(u_{\\text{in}}(y), 0)$. The dot product is $\\mathbf{u}\\cdot\\mathbf{n} = u_{\\text{in}}(y)(-1) + (0)(0) = -u_{\\text{in}}(y)$. The differential element of surface area is $dS=dy$. The total flux through the left boundary is:\n$$\nQ_{\\text{in, raw}} = \\int_{0}^{H} -u_{\\text{in}}(y) \\,dy\n$$\nThis represents the flux leaving the domain. The volumetric flow rate entering the domain is $Q_{\\text{in}} = -Q_{\\text{in, raw}} = \\int_{0}^{H} u_{\\text{in}}(y) \\,dy$.\n\n- On the right boundary ($x=L$), the outward normal vector is $\\mathbf{n}=(1,0)$. The corrected velocity vector is $\\mathbf{u}(L,y)=(u_{\\text{out}}^{\\text{corr}}(y), 0) = (U_1+\\delta, 0)$. The dot product is $\\mathbf{u}\\cdot\\mathbf{n} = (U_1+\\delta)(1) + (0)(0) = U_1+\\delta$. The flux through the right boundary is:\n$$\nQ_{\\text{out, corr}} = \\int_{0}^{H} (U_1+\\delta) \\,dy\n$$\n\nSubstituting these into the global balance equation:\n$$\n\\int_{0}^{H} -u_{\\text{in}}(y) \\,dy + \\int_{0}^{H} (U_1+\\delta) \\,dy + 0 + 0 = 0\n$$\nThis rearranges to the familiar statement that the volumetric flow rate in must equal the volumetric flow rate out:\n$$\n\\int_{0}^{H} u_{\\text{in}}(y) \\,dy = \\int_{0}^{H} (U_1+\\delta) \\,dy\n$$\nWe now compute each integral. First, the inflow rate $Q_{\\text{in}}$:\n$$\nQ_{\\text{in}} = \\int_{0}^{H} U_{0}\\left[1-\\left(2\\frac{y}{H}-1\\right)^{2}\\right] \\,dy\n$$\nWe can expand the integrand and integrate term by term:\n$$\nu_{\\text{in}}(y) = U_{0}\\left[1-\\left(\\frac{4y^2}{H^2} - \\frac{4y}{H} + 1\\right)\\right] = U_{0}\\left(\\frac{4y}{H} - \\frac{4y^2}{H^2}\\right)\n$$\n$$\nQ_{\\text{in}} = \\int_{0}^{H} U_{0}\\left(\\frac{4y}{H} - \\frac{4y^2}{H^2}\\right) \\,dy = U_{0} \\left[ \\frac{4y^2}{2H} - \\frac{4y^3}{3H^2} \\right]_{0}^{H}\n$$\n$$\nQ_{\\text{in}} = U_{0} \\left( \\frac{2H^2}{H} - \\frac{4H^3}{3H^2} \\right) = U_{0} \\left( 2H - \\frac{4}{3}H \\right) = U_{0}H\\left(2 - \\frac{4}{3}\\right) = \\frac{2}{3}U_{0}H\n$$\nNext, we compute the corrected outflow rate $Q_{\\text{out}}^{\\text{corr}}$:\n$$\nQ_{\\text{out}}^{\\text{corr}} = \\int_{0}^{H} (U_1+\\delta) \\,dy = (U_1+\\delta)[y]_{0}^{H} = (U_1+\\delta)H\n$$\nEquating the inflow and outflow rates:\n$$\n\\frac{2}{3}U_{0}H = (U_1+\\delta)H\n$$\nThe domain height $H$ is a non-zero constant and can be canceled from both sides:\n$$\n\\frac{2}{3}U_{0} = U_1+\\delta\n$$\nSolving for the correction term $\\delta$:\n$$\n\\delta = \\frac{2}{3}U_{0} - U_1\n$$\nWe are given the numerical values $U_{0}=1.2$ meters per second and $U_{1}=0.7$ meters per second. Substituting these values:\n$$\n\\delta = \\frac{2}{3}(1.2) - 0.7 = 2(0.4) - 0.7 = 0.8 - 0.7 = 0.1\n$$\nThe value of the correction is $\\delta = 0.1$ meters per second. The problem requires the answer to be rounded to four significant figures. This gives $0.1000$. This positive value indicates that the original outflow velocity was too low to balance the inflow, and thus needs to be increased.\nWith the correction, the mean inflow velocity is $\\bar{u}_{\\text{in}} = \\frac{Q_{\\text{in}}}{H} = \\frac{2}{3}U_0 = \\frac{2}{3}(1.2) = 0.8$ m/s. The corrected outflow velocity is $u_{\\text{out}}^{\\text{corr}} = U_1 + \\delta = 0.7 + 0.1 = 0.8$ m/s, which is uniform. The correction ensures the mean outflow velocity equals the mean inflow velocity, thereby satisfying global mass conservation.",
            "answer": "$$\n\\boxed{0.1000}\n$$"
        },
        {
            "introduction": "The projection method lies at the heart of many modern incompressible flow solvers, providing a robust mechanism for enforcing the divergence-free constraint. This algorithm iteratively \"projects\" a provisional velocity field onto a space of divergence-free fields by solving a Poisson equation for the pressure. This exercise  offers a concrete walkthrough of this core procedure on a staggered grid, guiding you through calculating the discrete divergence, forming the right-hand side of the pressure-Poisson equation, and performing a single iterative update to the pressure field.",
            "id": "3353803",
            "problem": "Consider the incompressible Navier–Stokes equations discretized on a uniform Cartesian grid using a Marker-and-Cell (MAC) layout. Let the computational domain be partitioned into a $3\\times 3$ array of control volumes with cell centers indexed by $(i,j)\\in\\{1,2,3\\}\\times\\{1,2,3\\}$, uniform spacings $\\Delta x=\\Delta y = h$, and fluid density $\\rho$. Face-centered intermediate velocities (after advection–diffusion but before projection) are denoted by $u^{*}_{i+1/2,j}$ on vertical faces and $v^{*}_{i,j+1/2}$ on horizontal faces. The incompressibility constraint is enforced by solving a pressure Poisson equation obtained from the projection step.\n\nStart from the kinematic constraint of incompressibility, $\\nabla\\cdot \\boldsymbol{u}^{n+1}=0$, and the standard projection of $\\boldsymbol{u}^{*}$ onto a divergence-free space to derive the Poisson equation for the pressure field. Then, adopt the second-order finite-volume/MAC discrete operators:\n- Discrete divergence at cell $(i,j)$ computed as\n$$\n(\\nabla\\cdot \\boldsymbol{u}^{*})_{i,j}\\;\\approx\\;\\frac{u^{*}_{i+1/2,j}-u^{*}_{i-1/2,j}}{\\Delta x}\\;+\\;\\frac{v^{*}_{i,j+1/2}-v^{*}_{i,j-1/2}}{\\Delta y},\n$$\n- Five-point Laplacian for cell-centered pressure unknowns with Dirichlet pressure boundary conditions applied on the outer boundary of the $3\\times 3$ cell-centered domain:\n$$\n\\frac{p_{i+1,j}-2p_{i,j}+p_{i-1,j}}{h^{2}}+\\frac{p_{i,j+1}-2p_{i,j}+p_{i,j-1}}{h^{2}} \\;=\\; b_{i,j},\n$$\nwhere $b_{i,j}$ is the discrete right-hand side of the Poisson equation.\n\nSuppose the only face-centered intermediate velocities needed for the center cell $(i,j)=(2,2)$ are given as follows (SI units), with $\\Delta x=\\Delta y=h$:\n- $u^{*}_{3/2,\\,2} \\;=\\; 0\\,\\mathrm{m/s}$,\n- $u^{*}_{5/2,\\,2} \\;=\\; 2\\,\\mathrm{m/s}$,\n- $v^{*}_{2,\\,3/2} \\;=\\; 1\\,\\mathrm{m/s}$,\n- $v^{*}_{2,\\,5/2} \\;=\\; 3\\,\\mathrm{m/s}$.\n\nLet the density be $\\rho=1\\,\\mathrm{kg/m^{3}}$, the time step be $\\Delta t = 0.5\\,\\mathrm{s}$, and the grid spacing be $h=1\\,\\mathrm{m}$. Initialize the pressure iterate as $p_{i,j}^{(0)}=0$ for all interior cells and impose homogeneous Dirichlet pressure on the outer boundary of the $3\\times 3$ domain.\n\nTasks:\n1. Using only the data above, compute the discrete divergence $(\\nabla\\cdot \\boldsymbol{u}^{*})_{2,2}$ at the center cell and construct the corresponding right-hand side $b_{2,2}$ for the pressure Poisson equation in the standard projection method.\n2. Write the Jacobi iteration for the five-point Laplacian and perform one Jacobi update at the center cell to obtain $p^{(1)}_{2,2}$ using the initial iterate and boundary conditions specified.\n\nExpress the final updated center-cell pressure $p^{(1)}_{2,2}$ in Pascals. No rounding is required; report the exact value. Use SI units throughout.",
            "solution": "The problem requires the calculation of the right-hand side of a pressure Poisson equation and a single Jacobi iteration step for the pressure at a specific cell in a computational fluid dynamics context. The problem is well-posed and contains all necessary information for the requested tasks.\n\nFirst, we establish the relationship between the pressure field $p$, the intermediate velocity field $\\boldsymbol{u}^*$, and the final, divergence-free velocity field $\\boldsymbol{u}^{n+1}$. The projection method corrects the intermediate velocity using the pressure gradient. A common formulation of the projection step is:\n$$ \\frac{\\boldsymbol{u}^{n+1} - \\boldsymbol{u}^*}{\\Delta t} = - \\frac{1}{\\rho} \\nabla p^{n+1} $$\nwhere $\\rho$ is the fluid density, $\\Delta t$ is the time step, and $p^{n+1}$ is the pressure at the new time level. This can be rearranged to express the final velocity as:\n$$ \\boldsymbol{u}^{n+1} = \\boldsymbol{u}^* - \\frac{\\Delta t}{\\rho} \\nabla p^{n+1} $$\nThe incompressibility constraint for the fluid flow requires the final velocity field to be divergence-free, i.e., $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$. Applying the divergence operator to the equation above yields:\n$$ \\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot \\boldsymbol{u}^* - \\nabla \\cdot \\left(\\frac{\\Delta t}{\\rho} \\nabla p^{n+1}\\right) $$\nSetting $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$ and assuming $\\rho$ and $\\Delta t$ are constant in space, we obtain the pressure Poisson equation:\n$$ \\nabla^2 p^{n+1} = \\frac{\\rho}{\\Delta t} \\nabla \\cdot \\boldsymbol{u}^* $$\nwhere $\\nabla^2$ is the Laplacian operator.\n\nThe problem provides the discrete form of this equation using a five-point stencil for the Laplacian and a finite-volume approximation for the divergence on a Marker-and-Cell (MAC) grid. The discrete equation at a cell center $(i,j)$ is:\n$$ \\frac{p_{i+1,j} - 2p_{i,j} + p_{i-1,j}}{\\Delta x^2} + \\frac{p_{i,j+1} - 2p_{i,j} + p_{i,j-1}}{\\Delta y^2} = \\frac{\\rho}{\\Delta t} \\left( \\frac{u^{*}_{i+1/2,j}-u^{*}_{i-1/2,j}}{\\Delta x} + \\frac{v^{*}_{i,j+1/2}-v^{*}_{i,j-1/2}}{\\Delta y} \\right) $$\nGiven that the grid spacings are uniform, $\\Delta x = \\Delta y = h$, this simplifies to the form stated in the problem:\n$$ \\frac{1}{h^2}(p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - 4p_{i,j}) = b_{i,j} $$\nwhere the right-hand side $b_{i,j}$ is defined as:\n$$ b_{i,j} = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\boldsymbol{u}^*)_{i,j} $$\nand $(\\nabla \\cdot \\boldsymbol{u}^*)_{i,j}$ is the discrete divergence.\n\n**Task 1: Compute $(\\nabla\\cdot \\boldsymbol{u}^{*})_{2,2}$ and $b_{2,2}$**\n\nWe are asked to compute these quantities for the center cell $(i,j) = (2,2)$ of the $3 \\times 3$ domain. The required data are:\n- $u^{*}_{3/2,\\,2} = 0\\,\\mathrm{m/s}$\n- $u^{*}_{5/2,\\,2} = 2\\,\\mathrm{m/s}$\n- $v^{*}_{2,\\,3/2} = 1\\,\\mathrm{m/s}$\n- $v^{*}_{2,\\,5/2} = 3\\,\\mathrm{m/s}$\n- $h = 1\\,\\mathrm{m}$\n- $\\rho = 1\\,\\mathrm{kg/m^{3}}$\n- $\\Delta t = 0.5\\,\\mathrm{s}$\n\nUsing the provided formula for the discrete divergence at $(i,j)=(2,2)$:\n$$ (\\nabla\\cdot \\boldsymbol{u}^{*})_{2,2} = \\frac{u^{*}_{2+1/2,2}-u^{*}_{2-1/2,2}}{h} + \\frac{v^{*}_{2,2+1/2}-v^{*}_{2,2-1/2}}{h} = \\frac{u^{*}_{5/2,2}-u^{*}_{3/2,2}}{h} + \\frac{v^{*}_{2,5/2}-v^{*}_{2,3/2}}{h} $$\nSubstituting the given numerical values:\n$$ (\\nabla\\cdot \\boldsymbol{u}^{*})_{2,2} = \\frac{2 - 0}{1} + \\frac{3 - 1}{1} = 2 + 2 = 4\\,\\mathrm{s}^{-1} $$\nNow, we can compute the right-hand side $b_{2,2}$ for the pressure Poisson equation:\n$$ b_{2,2} = \\frac{\\rho}{\\Delta t} (\\nabla \\cdot \\boldsymbol{u}^*)_{2,2} = \\frac{1\\,\\mathrm{kg/m^{3}}}{0.5\\,\\mathrm{s}} \\times (4\\,\\mathrm{s}^{-1}) = 2\\,\\mathrm{s}^{-1} \\times 4\\,\\mathrm{s}^{-1} \\times 1\\,\\mathrm{kg/m^{3}} = 8\\,\\mathrm{kg/(m^3 \\cdot s^2)} $$\nThe units are consistent, as $1\\,\\mathrm{Pa/m^2} = 1\\,\\mathrm{kg/(m^3 \\cdot s^2)}$.\n\n**Task 2: Perform one Jacobi update for $p^{(1)}_{2,2}$**\n\nThe Jacobi iteration method is used to solve the system of linear equations arising from the discretization of the Poisson equation. The update rule for the pressure $p_{i,j}$ at iteration step $k+1$ is derived by isolating $p_{i,j}$ from the discrete equation:\n$$ p_{i,j}^{(k+1)} = \\frac{1}{4} \\left( p_{i+1,j}^{(k)} + p_{i-1,j}^{(k)} + p_{i,j+1}^{(k)} + p_{i,j-1}^{(k)} - h^2 b_{i,j} \\right) $$\nWe are asked to compute the first iterate $p^{(1)}_{2,2}$ for the central cell $(i,j)=(2,2)$. The formula becomes:\n$$ p_{2,2}^{(1)} = \\frac{1}{4} \\left( p_{3,2}^{(0)} + p_{1,2}^{(0)} + p_{2,3}^{(0)} + p_{2,1}^{(0)} - h^2 b_{2,2} \\right) $$\nThe problem specifies the initial guess $p_{i,j}^{(0)} = 0$ for all interior cells. The domain consists of cells indexed by $(i,j) \\in \\{1,2,3\\} \\times \\{1,2,3\\}$. The neighbors of cell $(2,2)$ are $(3,2)$, $(1,2)$, $(2,3)$, and $(2,1)$, which are all interior cells. Therefore, their initial pressure values are zero:\n- $p_{3,2}^{(0)} = 0$\n- $p_{1,2}^{(0)} = 0$\n- $p_{2,3}^{(0)} = 0$\n- $p_{2,1}^{(0)} = 0$\n\nWe also have $h=1\\,\\mathrm{m}$ and $b_{2,2} = 8\\,\\mathrm{kg/(m^3 \\cdot s^2)}$. Substituting all values into the Jacobi update equation:\n$$ p_{2,2}^{(1)} = \\frac{1}{4} \\left( 0 + 0 + 0 + 0 - (1\\,\\mathrm{m})^2 \\times (8\\,\\mathrm{kg/(m^3 \\cdot s^2)}) \\right) $$\n$$ p_{2,2}^{(1)} = \\frac{1}{4} ( -8\\,\\mathrm{kg/(m \\cdot s^2)} ) $$\nThe unit $\\mathrm{kg/(m \\cdot s^2)}$ is dimensionally equivalent to the Pascal ($Pa$), which is the SI unit for pressure.\n$$ p_{2,2}^{(1)} = -2\\,\\mathrm{Pa} $$\nThe final updated center-cell pressure $p^{(1)}_{2,2}$ is $-2\\,\\mathrm{Pa}$.\nThe homogeneous Dirichlet boundary conditions specified for the outer boundary were not explicitly used for this specific calculation, as the stencil for $p_{2,2}$ only involves other interior cells for which the initial guess $p^{(0)}_{i,j}=0$ was specified.",
            "answer": "$$\n\\boxed{-2}\n$$"
        },
        {
            "introduction": "The choice of grid arrangement has profound consequences for the stability and accuracy of pressure–velocity coupling. While geometrically simple, collocated grids can fail to detect unphysical, high-frequency pressure oscillations, a pathology known as \"checkerboard decoupling.\" This exercise  provides a powerful analytical demonstration of this failure and shows precisely how the Rhie-Chow stabilization technique introduces the necessary coupling to suppress these spurious modes, ensuring a physically meaningful pressure field.",
            "id": "3353857",
            "problem": "Consider a two-dimensional, incompressible flow discretized on a uniform collocated grid of size $4\\times 4$ with periodic boundaries in both directions, grid spacing $h>0$ in $x$ and $y$, and constant density. Let velocities and pressure be stored at cell centers indexed by integers $(i,j)$ with $i,j\\in\\{0,1,2,3\\}$ and periodicity modulo $4$. Assume a predictor step in which the discrete momentum equations are linearized and assembled with a strictly positive, uniform diagonal coefficient $a_p>0$ at every cell, representing the implicit contribution of transient and diffusive terms. Neglect body forces and convective transport in the present analysis. Define the cell-centered discrete pressure gradient at $(i,j)$ by second-order central differences, that is, $(\\partial p/\\partial x)_{i,j}$ is approximated by $(p_{i+1,j}-p_{i-1,j})/(2h)$ and $(\\partial p/\\partial y)_{i,j}$ by $(p_{i,j+1}-p_{i,j-1})/(2h)$, with indices taken modulo $4$.\n\nIn this collocated arrangement, the face-normal velocities used in the discrete continuity are computed as follows.\n\n- Without Rhie–Chow stabilization (RC), the face-normal velocity at an interior face is the arithmetic average of the adjacent cell-centered velocities. For example, at the east face between cells $(i,j)$ and $(i+1,j)$, the $x$-face velocity is $u_{i+1/2,j}=\\tfrac{1}{2}\\left(u_{i,j}+u_{i+1,j}\\right)$, and similarly for other faces and for $v$ on north–south faces. The cell-centered velocities are obtained by applying the discrete pressure gradient to the predictor velocity with coefficient $a_p$, i.e., $u_{i,j}=u^{*}_{i,j}-\\frac{1}{a_p}\\left(\\partial p/\\partial x\\right)_{i,j}$ and $v_{i,j}=v^{*}_{i,j}-\\frac{1}{a_p}\\left(\\partial p/\\partial y\\right)_{i,j}$, where $u^{*}_{i,j}$ and $v^{*}_{i,j}$ are the provisional velocities arising from non-pressure terms.\n\n- With Rhie–Chow stabilization (RC), the face-normal velocity includes a pressure-difference-based correction that avoids pressure odd–even decoupling. Using the standard symmetric form on a uniform grid, the $x$-face velocity at the east face is\n$$\nu^{\\text{RC}}_{i+1/2,j}=\\tfrac{1}{2}\\left(u_{i,j}+u_{i+1,j}\\right)-\\overline{d}_{i+1/2,j}\\left[\\frac{p_{i+1,j}-p_{i,j}}{h}-\\tfrac{1}{2}\\left(\\left.\\frac{\\partial p}{\\partial x}\\right|_{i,j}+\\left.\\frac{\\partial p}{\\partial x}\\right|_{i+1,j}\\right)\\right],\n$$\nwith $\\overline{d}_{i+1/2,j}=\\tfrac{1}{2}\\left(\\tfrac{1}{a_p}+\\tfrac{1}{a_p}\\right)=\\tfrac{1}{a_p}$, and an analogous formula in the $y$-direction for $v^{\\text{RC}}_{i,j+1/2}$ with $\\overline{d}=\\tfrac{1}{a_p}$ and $h$ in $y$. The discrete continuity at cell $(i,j)$ uses the standard second-order face-difference form of the discrete divergence,\n$$\n\\left(\\nabla\\cdot \\mathbf{u}\\right)_{i,j}=\\frac{u_{i+1/2,j}-u_{i-1/2,j}}{h}+\\frac{v_{i,j+1/2}-v_{i,j-1/2}}{h}.\n$$\n\nNow impose a pure checkerboard pressure mode of amplitude $P_0>0$,\n$$\np_{i,j}=P_0\\,(-1)^{i+j},\n$$\nand take $u^{*}_{i,j}=0$ and $v^{*}_{i,j}=0$ for all $(i,j)$ to isolate the pressure–velocity coupling.\n\nDefine the spurious-mode amplitude $M$ as the scalar such that the discrete divergence at each cell equals the checkerboard pattern scaled by $M$,\n$$\n\\left(\\nabla\\cdot \\mathbf{u}\\right)_{i,j}=(-1)^{i+j}\\,M.\n$$\n\nUsing only the stated discretizations and definitions, derive $M$ in the case without Rhie–Chow stabilization and with Rhie–Chow stabilization, as explicit functions of $P_0$, $a_p$, and $h$. Express your final answer as the two-component row vector $\\left(M_{\\text{before}},\\,M_{\\text{after}}\\right)$, where $M_{\\text{before}}$ corresponds to the case without Rhie–Chow stabilization and $M_{\\text{after}}$ corresponds to the case with Rhie–Chow stabilization. No numerical evaluation is required; provide a closed-form symbolic expression.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded in the principles of computational fluid dynamics, specifically concerning pressure–velocity coupling on collocated grids. The problem is well-posed, objective, and contains all necessary information for a unique solution.\n\nThe objective is to determine the amplitude $M$ of the spurious divergence field, defined by $(\\nabla\\cdot \\mathbf{u})_{i,j}=(-1)^{i+j}\\,M$, resulting from a checkerboard pressure field $p_{i,j}=P_0\\,(-1)^{i+j}$. The predictor velocities are given as $u^{*}_{i,j}=0$ and $v^{*}_{i,j}=0$. We will analyze two cases: without and with Rhie-Chow stabilization.\n\nFirst, we calculate the discrete cell-centered pressure gradients for the given pressure field $p_{i,j} = P_0(-1)^{i+j}$. The indices are taken modulo $4$ due to periodicity. For the $x$-direction at cell $(i,j)$:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{p_{i+1,j} - p_{i-1,j}}{2h}\n$$\nSubstituting the pressure field:\n$$\np_{i+1,j} = P_0(-1)^{i+1+j} = -P_0(-1)^{i+j}\n$$\n$$\np_{i-1,j} = P_0(-1)^{i-1+j} = -P_0(-1)^{i+j}\n$$\nTherefore, the discrete pressure gradient in the $x$-direction is:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = \\frac{-P_0(-1)^{i+j} - (-P_0(-1)^{i+j})}{2h} = 0\n$$\nBy symmetry, the discrete pressure gradient in the $y$-direction is also zero:\n$$\n\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = \\frac{p_{i,j+1} - p_{i,j-1}}{2h} = \\frac{-P_0(-1)^{i+j} - (-P_0(-1)^{i+j})}{2h} = 0\n$$\nThis result, that the second-order central difference gradient of a checkerboard field is zero, is the fundamental reason for pressure–velocity decoupling on a collocated grid.\n\nNext, we determine the cell-centered velocities $u_{i,j}$ and $v_{i,j}$ using the provided relation:\n$$\nu_{i,j} = u^{*}_{i,j} - \\frac{1}{a_p}\\left(\\frac{\\partial p}{\\partial x}\\right)_{i,j} = 0 - \\frac{1}{a_p}(0) = 0\n$$\n$$\nv_{i,j} = v^{*}_{i,j} - \\frac{1}{a_p}\\left(\\frac{\\partial p}{\\partial y}\\right)_{i,j} = 0 - \\frac{1}{a_p}(0) = 0\n$$\nThus, the cell-centered velocities are zero everywhere for any cell $(i,j)$.\n\nNow we can proceed to evaluate the discrete divergence for the two specified cases.\n\n**Case 1: Without Rhie-Chow Stabilization ($M_{\\text{before}}$)**\n\nIn this case, the face-normal velocities are the arithmetic average of the adjacent cell-centered velocities. For the east face of cell $(i,j)$:\n$$\nu_{i+1/2,j} = \\frac{1}{2}\\left(u_{i,j} + u_{i+1,j}\\right) = \\frac{1}{2}\\left(0 + 0\\right) = 0\n$$\nSimilarly, $u_{i-1/2,j} = 0$, $v_{i,j+1/2} = 0$, and $v_{i,j-1/2} = 0$.\nThe discrete divergence at cell $(i,j)$ is then:\n$$\n\\left(\\nabla\\cdot \\mathbf{u}\\right)_{i,j} = \\frac{u_{i+1/2,j}-u_{i-1/2,j}}{h}+\\frac{v_{i,j+1/2}-v_{i,j-1/2}}{h} = \\frac{0-0}{h} + \\frac{0-0}{h} = 0\n$$\nWe are given that $\\left(\\nabla\\cdot \\mathbf{u}\\right)_{i,j}=(-1)^{i+j}\\,M_{\\text{before}}$. This implies $0 = (-1)^{i+j}M_{\\text{before}}$. Since this must hold for all $(i,j)$, we conclude that:\n$$\nM_{\\text{before}} = 0\n$$\n\n**Case 2: With Rhie-Chow Stabilization ($M_{\\text{after}}$)**\n\nThe cell-centered velocities are still $u_{i,j}=0$ and $v_{i,j}=0$. However, the face-normal velocities are calculated using the Rhie-Chow formula. For the east face of cell $(i,j)$, we have:\n$$\nu^{\\text{RC}}_{i+1/2,j} = \\frac{1}{2}\\left(u_{i,j}+u_{i+1,j}\\right) - \\overline{d}_{i+1/2,j}\\left[\\frac{p_{i+1,j}-p_{i,j}}{h}-\\frac{1}{2}\\left(\\left.\\frac{\\partial p}{\\partial x}\\right|_{i,j}+\\left.\\frac{\\partial p}{\\partial x}\\right|_{i+1,j}\\right)\\right]\n$$\nSubstituting the known values: $u_{i,j}=u_{i+1,j}=0$, $(\\partial p/\\partial x)|_{i,j}=(\\partial p/\\partial x)|_{i+1,j}=0$, and $\\overline{d}_{i+1/2,j} = 1/a_p$. The expression simplifies to:\n$$\nu^{\\text{RC}}_{i+1/2,j} = -\\frac{1}{a_p}\\left[\\frac{p_{i+1,j}-p_{i,j}}{h}\\right] = -\\frac{1}{a_p h}(p_{i+1,j}-p_{i,j})\n$$\nWe compute the pressure difference:\n$$\np_{i+1,j}-p_{i,j} = P_0(-1)^{i+1+j} - P_0(-1)^{i+j} = P_0(-1)^{i+j}(-1-1) = -2P_0(-1)^{i+j}\n$$\nSo, the face velocity is:\n$$\nu^{\\text{RC}}_{i+1/2,j} = -\\frac{1}{a_p h}(-2P_0(-1)^{i+j}) = \\frac{2P_0}{a_p h}(-1)^{i+j}\n$$\nFor the west face velocity, $u^{\\text{RC}}_{i-1/2,j}$, we need the pressure difference $p_{i,j}-p_{i-1,j}$:\n$$\np_{i,j}-p_{i-1,j} = P_0(-1)^{i+j} - P_0(-1)^{i-1+j} = P_0(-1)^{i+j}(1-(-1)) = 2P_0(-1)^{i+j}\n$$\nThe velocity at the west face is:\n$$\nu^{\\text{RC}}_{i-1/2,j} = -\\frac{1}{a_p h}(p_{i,j}-p_{i-1,j}) = -\\frac{1}{a_p h}(2P_0(-1)^{i+j}) = -\\frac{2P_0}{a_p h}(-1)^{i+j}\n$$\nThe $x$-component of the divergence is:\n$$\n\\frac{u^{\\text{RC}}_{i+1/2,j}-u^{\\text{RC}}_{i-1/2,j}}{h} = \\frac{1}{h}\\left[ \\frac{2P_0}{a_p h}(-1)^{i+j} - \\left(-\\frac{2P_0}{a_p h}(-1)^{i+j}\\right) \\right] = \\frac{4P_0}{a_p h^2}(-1)^{i+j}\n$$\nDue to the symmetry of the problem in the $x$ and $y$ directions, the $y$-component of the divergence is identical:\n$$\n\\frac{v^{\\text{RC}}_{i,j+1/2}-v^{\\text{RC}}_{i,j-1/2}}{h} = \\frac{4P_0}{a_p h^2}(-1)^{i+j}\n$$\nThe total discrete divergence at cell $(i,j)$ is the sum of these two components:\n$$\n(\\nabla\\cdot \\mathbf{u}^{\\text{RC}})_{i,j} = \\frac{4P_0}{a_p h^2}(-1)^{i+j} + \\frac{4P_0}{a_p h^2}(-1)^{i+j} = \\frac{8P_0}{a_p h^2}(-1)^{i+j}\n$$\nWe are given that $(\\nabla\\cdot \\mathbf{u}^{\\text{RC}})_{i,j}=(-1)^{i+j}\\,M_{\\text{after}}$. Equating the two expressions gives:\n$$\nM_{\\text{after}} = \\frac{8P_0}{a_p h^2}\n$$\nThe final answer is the two-component row vector $(M_{\\text{before}}, M_{\\text{after}})$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{8P_0}{a_p h^2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}