{
    "hands_on_practices": [
        {
            "introduction": "在任何有限体积法中，首要任务是为单个控制体积正确表达质量守恒。本练习旨在通过推导离散形式的连续性方程，为后续学习奠定基础。这个过程将单元格中心密度的变化与穿过单元格表面的净质量通量联系起来，这是在交错网格上进行流体动力学模拟的核心步骤 。",
            "id": "3346588",
            "problem": "考虑一个二维笛卡尔域，该域通过计算流体动力学（CFD）中使用的均匀交错网格进行离散化。压力和密度存储在以 $(i,j)$ 为索引的网格中心，x方向动量速度分量 $u$ 存储在以 $(i+\\tfrac{1}{2},j)$ 为索引的垂直面上，y方向动量速度分量 $v$ 存储在以 $(i,j+\\tfrac{1}{2})$ 为索引的水平面上。以网格为中心的控制体尺寸为 $\\Delta x \\times \\Delta y$。假设网格内没有体积质量源。其控制原理是固定控制体上的积分质量守恒：\n$$\\frac{\\mathrm{d}}{\\mathrm{d} t}\\int_{V}\\rho\\,\\mathrm{d}V+\\oint_{\\partial V}\\rho\\,\\boldsymbol{u}\\cdot \\boldsymbol{n}\\,\\mathrm{d}A=0$$,\n其中 $\\rho$ 是质量密度，$\\boldsymbol{u}$ 是速度矢量。\n\n定义离散的面质量通量\n$$m^{x}_{i+\\tfrac{1}{2},j}=\\rho_{i+\\tfrac{1}{2},j}\\,u_{i+\\tfrac{1}{2},j}\\,\\Delta y,\\qquad m^{x}_{i-\\tfrac{1}{2},j}=\\rho_{i-\\tfrac{1}{2},j}\\,u_{i-\\tfrac{1}{2},j}\\,\\Delta y$$,\n$$m^{y}_{i,j+\\tfrac{1}{2}}=\\rho_{i,j+\\tfrac{1}{2}}\\,v_{i,j+\\tfrac{1}{2}}\\,\\Delta x,\\qquad m^{y}_{i,j-\\tfrac{1}{2}}=\\rho_{i,j-\\tfrac{1}{2}}\\,v_{i,j-\\tfrac{1}{2}}\\,\\Delta x$$,\n约定 $m^{x}_{i+\\tfrac{1}{2},j}$ 对于流经东侧面的 $+x$ 方向流动为正，$m^{x}_{i-\\tfrac{1}{2},j}$ 对于流经西侧面的 $+x$ 方向流动为正，$m^{y}_{i,j+\\tfrac{1}{2}}$ 对于流经北侧面的 $+y$ 方向流动为正，$m^{y}_{i,j-\\tfrac{1}{2}}$ 对于流经南侧面的 $+y$ 方向流动为正。设时间层 $n$ 和 $n+1$ 的网格中心密度分别为 $\\rho^{n}_{i,j}$ 和 $\\rho^{n+1}_{i,j}$，并对网格平均存储项在一个时间步长 $\\Delta t$ 内采用后向欧拉时间积分。\n\n严格从给定的积分质量守恒原理出发，在交错网格上应用有限体积离散化，推导每个压力网格 $(i,j)$ 的守恒形式连续性平衡方程，该方程在完全离散形式下必须为零。将您的最终答案表示为关于残差（即等于零的方程左侧）的单个闭式解析表达式，该表达式应使用 $\\rho^{n+1}_{i,j}$、$\\rho^{n}_{i,j}$、$\\Delta x$、$\\Delta y$、$\\Delta t$、$m^{x}_{i\\pm\\tfrac{1}{2},j}$ 和 $m^{y}_{i,j\\pm\\tfrac{1}{2}}$ 来表示。最终答案中不要包含等号。无需进行数值计算。",
            "solution": "用户希望我验证问题陈述，如果有效，则提供一个解决方案。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n*   **域**：一个二维笛卡尔域。\n*   **网格**：一个均匀交错网格。\n*   **变量位置**：\n    *   压力 ($p$) 和密度 ($\\rho$) 存储在以 $(i,j)$ 为索引的网格中心。\n    *   $x$ 方向动量速度分量 ($u$) 存储在以 $(i+\\frac{1}{2},j)$ 为索引的垂直面上。\n    *   $y$ 方向动量速度分量 ($v$) 存储在以 $(i,j+\\frac{1}{2})$ 为索引的水平面上。\n*   **控制体**：一个以网格为中心的控制体，尺寸为 $\\Delta x \\times \\Delta y$。\n*   **源项**：网格内无体积质量源。\n*   **控制原理**：固定控制体 $V$ 上的积分质量守恒方程：\n    $$\\frac{\\mathrm{d}}{\\mathrm{d} t}\\int_{V}\\rho\\,\\mathrm{d}V+\\oint_{\\partial V}\\rho\\,\\boldsymbol{u}\\cdot \\boldsymbol{n}\\,\\mathrm{d}A=0$$\n*   **离散的面质量通量**：\n    *   $m^{x}_{i+\\frac{1}{2},j}=\\rho_{i+\\frac{1}{2},j}\\,u_{i+\\frac{1}{2},j}\\,\\Delta y$ (东侧面，$+x$ 方向流动为正)\n    *   $m^{x}_{i-\\frac{1}{2},j}=\\rho_{i-\\frac{1}{2},j}\\,u_{i-\\frac{1}{2},j}\\,\\Delta y$ (西侧面，$+x$ 方向流动为正)\n    *   $m^{y}_{i,j+\\frac{1}{2}}=\\rho_{i,j+\\frac{1}{2}}\\,v_{i,j+\\frac{1}{2}}\\,\\Delta x$ (北侧面，$+y$ 方向流动为正)\n    *   $m^{y}_{i,j-\\frac{1}{2}}=\\rho_{i,j-\\frac{1}{2}}\\,v_{i,j-\\frac{1}{2}}\\,\\Delta x$ (南侧面，$+y$ 方向流动为正)\n*   **时间离散化**：\n    *   时间层为 $n$ 和 $n+1$。\n    *   时间步长为 $\\Delta t$。\n    *   网格中心密度为 $\\rho^{n}_{i,j}$ 和 $\\rho^{n+1}_{i,j}$。\n    *   存储项的时间积分格式为后向欧拉法。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n根据既定标准对问题进行评估：\n\n*   **科学依据**：该问题基于质量守恒基本原理，这是物理学和流体动力学的基石。所描述的离散化方法（交错网格上的有限体积法）是计算流体动力学（CFD）中的一种标准且成熟的技术。该设置在科学上和数学上都是合理的。\n*   **适定性**：该问题要求从给定的积分定律和一系列定义中推导出一个离散方程。给定的条件充分且一致，可以得出一个唯一的解析表达式。\n*   **客观性**：该问题使用 CFD 领域的精确、标准术语进行陈述。没有主观或含糊不清的陈述。\n\n该问题不存在任何无效性缺陷。它是偏微分方程数值方法领域中的一个标准的、定义明确的问题。\n\n**步骤 3：结论与行动**\n\n问题有效。将提供一个完整的、有理有据的解决方案。\n\n### 解\n\n目标是使用有限体积法，在交错网格上为以 $(i,j)$ 为中心的控制体推导质量守恒方程的完全离散形式。出发点是固定控制体 $V$ 的连续性方程的积分形式：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d} t}\\int_{V}\\rho\\,\\mathrm{d}V+\\oint_{\\partial V}\\rho\\,\\boldsymbol{u}\\cdot \\boldsymbol{n}\\,\\mathrm{d}A=0 $$\n该方程表明，控制体内质量的增加率等于净流入其中的质量率。\n\n我们将此原理应用于与网格中心 $(i,j)$ 相关联的控制体 $V_{i,j}$。该控制体是一个尺寸为 $\\Delta x \\times \\Delta y$ 的矩形区域。对于二维分析，我们假设单位深度，因此网格的体积为 $\\Delta V = \\Delta x \\Delta y$。\n\n守恒定律中的两项分别进行离散化。\n\n**1. 存储项的离散化**\n\n第一项 $\\frac{\\mathrm{d}}{\\mathrm{d} t}\\int_{V}\\rho\\,\\mathrm{d}V$ 表示控制体内质量的变化率。对于控制体 $V_{i,j}$，我们通过假设网格中心密度 $\\rho_{i,j}$ 代表整个网格的平均密度来近似该积分：\n$$ \\int_{V_{i,j}}\\rho\\,\\mathrm{d}V \\approx \\rho_{i,j} \\Delta V = \\rho_{i,j} \\Delta x \\Delta y $$\n然后对该表达式求时间导数。由于网格是固定的，$\\Delta x$ 和 $\\Delta y$ 不随时间变化：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d} t}\\int_{V_{i,j}}\\rho\\,\\mathrm{d}V \\approx \\frac{\\mathrm{d}}{\\mathrm{d} t}(\\rho_{i,j} \\Delta x \\Delta y) = \\Delta x \\Delta y \\frac{\\mathrm{d}\\rho_{i,j}}{\\mathrm{d}t} $$\n问题指定了在一个时间步长 $\\Delta t = t^{n+1} - t^{n}$ 内采用后向欧拉格式进行时间积分。该格式使用时间步的开始和结束时刻的值来近似时间导数：\n$$ \\frac{\\mathrm{d}\\rho_{i,j}}{\\mathrm{d}t} \\approx \\frac{\\rho^{n+1}_{i,j} - \\rho^{n}_{i,j}}{\\Delta t} $$\n将此代入存储项的表达式，得到其完全离散形式：\n$$ \\Delta x \\Delta y \\frac{\\rho^{n+1}_{i,j} - \\rho^{n}_{i,j}}{\\Delta t} $$\n后向欧拉法是一种隐式格式，因此不属于时间导数部分的通量项在新的时间层 $n+1$ 进行计算。\n\n**2. 通量项的离散化**\n\n第二项 $\\oint_{\\partial V}\\rho\\,\\boldsymbol{u}\\cdot \\boldsymbol{n}\\,\\mathrm{d}A$ 表示穿过其边界 $\\partial V$ 离开控制体的净质量通量。网格 $V_{i,j}$ 的边界由四个面组成：东(e)、西(w)、北(n)和南(s)。因此，面积分是流经这四个面的通量之和：\n$$ \\oint_{\\partial V_{i,j}}\\rho\\,\\boldsymbol{u}\\cdot \\boldsymbol{n}\\,\\mathrm{d}A = \\int_{A_e} (\\rho\\boldsymbol{u}\\cdot\\boldsymbol{n}_e)\\mathrm{d}A + \\int_{A_w} (\\rho\\boldsymbol{u}\\cdot\\boldsymbol{n}_w)\\mathrm{d}A + \\int_{A_n} (\\rho\\boldsymbol{u}\\cdot\\boldsymbol{n}_n)\\mathrm{d}A + \\int_{A_s} (\\rho\\boldsymbol{u}\\cdot\\boldsymbol{n}_s)\\mathrm{d}A $$\n我们逐一计算每个面的积分：\n*   **东侧面 (e)**：该面位于 $x_{i+\\frac{1}{2}}$。外向单位法向量为 $\\boldsymbol{n}_e = (1, 0)$。面面积为 $A_e = \\Delta y$。点积为 $\\rho\\boldsymbol{u}\\cdot\\boldsymbol{n}_e = \\rho u$。通量近似为 $(\\rho u)_{i+\\frac{1}{2},j} A_e = (\\rho u)_{i+\\frac{1}{2},j} \\Delta y$。问题给出的离散质量通量 $m^{x}_{i+\\frac{1}{2},j}=\\rho_{i+\\frac{1}{2},j}\\,u_{i+\\frac{1}{2},j}\\,\\Delta y$ 定义为 $+x$ 方向（向外）的流动为正。因此，质量流出率恰好是 $m^{x}_{i+\\frac{1}{2},j}$。\n*   **西侧面 (w)**：该面位于 $x_{i-\\frac{1}{2}}$。外向单位法向量为 $\\boldsymbol{n}_w = (-1, 0)$。面面积为 $A_w = \\Delta y$。点积为 $\\rho\\boldsymbol{u}\\cdot\\boldsymbol{n}_w = -\\rho u$。外向通量近似为 $(-\\rho u)_{i-\\frac{1}{2},j} A_w = -(\\rho u)_{i-\\frac{1}{2},j} \\Delta y$。问题给出的离散质量通量 $m^{x}_{i-\\frac{1}{2},j}=\\rho_{i-\\frac{1}{2},j}\\,u_{i-\\frac{1}{2},j}\\,\\Delta y$ 定义为 $+x$ 方向的流动为正。一个正的 $m^{x}_{i-\\frac{1}{2},j}$ 表示流入网格 $V_{i,j}$。因此，通过西侧面的质量流出率为 $-m^{x}_{i-\\frac{1}{2},j}$。\n*   **北侧面 (n)**：该面位于 $y_{j+\\frac{1}{2}}$。外向单位法向量为 $\\boldsymbol{n}_n = (0, 1)$。面面积为 $A_n = \\Delta x$。点积为 $\\rho\\boldsymbol{u}\\cdot\\boldsymbol{n}_n = \\rho v$。外向通量近似为 $(\\rho v)_{i,j+\\frac{1}{2}} A_n = (\\rho v)_{i,j+\\frac{1}{2}} \\Delta x$。给定的质量通量 $m^{y}_{i,j+\\frac{1}{2}}=\\rho_{i,j+\\frac{1}{2}}\\,v_{i,j+\\frac{1}{2}}\\,\\Delta x$ 对于 $+y$ 方向（向外）的流动为正。因此，质量流出率为 $m^{y}_{i,j+\\frac{1}{2}}$。\n*   **南侧面 (s)**：该面位于 $y_{j-\\frac{1}{2}}$。外向单位法向量为 $\\boldsymbol{n}_s = (0, -1)$。面面积为 $A_s = \\Delta x$。点积为 $\\rho\\boldsymbol{u}\\cdot\\boldsymbol{n}_s = -\\rho v$。外向通量近似为 $(-\\rho v)_{i,j-\\frac{1}{2}} A_s = -(\\rho v)_{i,j-\\frac{1}{2}} \\Delta x$。给定的质量通量 $m^{y}_{i,j-\\frac{1}{2}}=\\rho_{i,j-\\frac{1}{2}}\\,v_{i,j-\\frac{1}{2}}\\,\\Delta x$ 对于 $+y$ 方向的流动为正，这是一种流入。因此，通过南侧面的质量流出率为 $-m^{y}_{i,j-\\frac{1}{2}}$。\n\n将所有四个面的贡献相加，得到净质量流出率：\n$$ \\oint_{\\partial V_{i,j}}\\rho\\,\\boldsymbol{u}\\cdot \\boldsymbol{n}\\,\\mathrm{d}A \\approx m^{x}_{i+\\frac{1}{2},j} - m^{x}_{i-\\frac{1}{2},j} + m^{y}_{i,j+\\frac{1}{2}} - m^{y}_{i,j-\\frac{1}{2}} $$\n\n**3. 组合最终方程**\n\n组合离散化的存储项和通量项，得到完全离散的质量守恒方程：\n$$ \\Delta x \\Delta y \\frac{\\rho^{n+1}_{i,j} - \\rho^{n}_{i,j}}{\\Delta t} + \\left( m^{x}_{i+\\frac{1}{2},j} - m^{x}_{i-\\frac{1}{2},j} \\right) + \\left( m^{y}_{i,j+\\frac{1}{2}} - m^{y}_{i,j-\\frac{1}{2}} \\right) = 0 $$\n问题要求的是残差的表达式，即该方程的左侧。此表达式代表了“每个压力网格的守恒形式连续性平衡”，数值求解器必须将其驱动为零。",
            "answer": "$$ \\boxed{\\Delta x \\Delta y \\frac{\\rho^{n+1}_{i,j} - \\rho^{n}_{i,j}}{\\Delta t} + m^{x}_{i+\\frac{1}{2},j} - m^{x}_{i-\\frac{1}{2},j} + m^{y}_{i,j+\\frac{1}{2}} - m^{y}_{i,j-\\frac{1}{2}}} $$"
        },
        {
            "introduction": "在建立质量守恒之后，我们必须对动量方程进行离散化。此练习聚焦于动量方程中的粘性项，演示了如何构建一个与速度分量的交错布局相适应的离散拉普拉斯算子。掌握在交错网格上处理二阶导数对于准确模拟粘性扩散效应至关重要 。",
            "id": "3346623",
            "problem": "考虑一个在标记-网格（MAC）交错网格（Marker-And-Cell (MAC)）上离散的二维不可压缩流。压力 $p$ 存储在坐标为 $(x_i,y_j)$ 的网格中心 $(i,j)$ 处，水平速度分量 $u$ 存储在垂直于 $x$ 方向的网格面上，位于坐标为 $(x_{i+\\frac{1}{2}},y_j)$ 的 $(i+\\tfrac{1}{2},j)$ 处，垂直速度分量 $v$ 存储在垂直于 $y$ 方向的网格面上，位于坐标为 $(x_i,y_{j+\\frac{1}{2}})$ 的 $(i,j+\\tfrac{1}{2})$ 处。该笛卡尔网格是均匀的，间距为 $\\Delta x$ 和 $\\Delta y$，因此 $x_{i+1}-x_i=\\Delta x$ 且 $y_{j+1}-y_j=\\Delta y$。\n\n从笛卡尔坐标系中拉普拉斯算子的定义 $\\nabla^{2} u \\equiv \\frac{\\partial^{2} u}{\\partial x^{2}} + \\frac{\\partial^{2} u}{\\partial y^{2}}$ 出发，推导在交错网格位置 $(i+\\tfrac{1}{2},j)$ 处 $\\nabla^{2} u$ 的二阶中心差分近似，该近似与 $u$ 在 $x$ 方向网格面上的存储方式一致。使用关于 $(x_{i+\\frac{1}{2}},y_j)$ 的泰勒级数展开来证明其精度阶，并明确说明为什么对于你所构建的中心差分格式，任何交叉导数项（涉及 $\\frac{\\partial^{2} u}{\\partial x \\partial y}$ 的混合导数）在均匀笛卡尔网格上都会消失。\n\n将你在 $(i+\\tfrac{1}{2},j)$ 处 $\\nabla^{2} u$ 的最终离散算子，仅用相邻面心值 $u_{i+\\frac{3}{2},\\,j}$、$u_{i+\\frac{1}{2},\\,j}$、$u_{i-\\frac{1}{2},\\,j}$、$u_{i+\\frac{1}{2},\\,j+1}$ 和 $u_{i+\\frac{1}{2},\\,j-1}$ 表示为一个单一的封闭形式解析表达式。无需进行数值计算。",
            "solution": "出发点是笛卡尔坐标系下拉普拉斯算子的定义，\n$$\n\\nabla^{2} u(x,y) \\equiv \\frac{\\partial^{2} u}{\\partial x^{2}}(x,y) + \\frac{\\partial^{2} u}{\\partial y^{2}}(x,y).\n$$\n在标记-网格（MAC）交错网格上，水平速度分量 $u$ 定义在位置 $(x_{i+\\frac{1}{2}},y_j)$ 处，这些位置位于垂直于 $x$ 方向的网格面的中心。目标是使用相邻的面心 $u$ 值，构建在 $(x_{i+\\frac{1}{2}},y_j)$ 处求值的 $\\frac{\\partial^{2} u}{\\partial x^{2}}$ 和 $\\frac{\\partial^{2} u}{\\partial y^{2}}$ 的二阶中心差分近似。\n\n对于在 $(x_{i+\\frac{1}{2}},y_j)$ 处沿 $x$ 方向的二阶导数，我们使用点 $(x_{i+\\frac{3}{2}},y_j)$ 和 $(x_{i-\\frac{1}{2}},y_j)$。均匀网格意味着 $x_{i+\\frac{3}{2}} - x_{i+\\frac{1}{2}} = \\Delta x$ 且 $x_{i+\\frac{1}{2}} - x_{i-\\frac{1}{2}} = \\Delta x$。对 $u$ 在 $(x_{i+\\frac{1}{2}},y_j)$ 点进行泰勒级数展开：\n$$\nu(x_{i+\\frac{3}{2}},y_j) = u(x_{i+\\frac{1}{2}},y_j) + \\Delta x\\, u_{x}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta x)^{2}}{2}\\, u_{xx}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta x)^{3}}{6}\\, u_{xxx}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta x)^{4}}{24}\\, u_{xxxx}(x_{i+\\frac{1}{2}},y_j) + \\mathcal{O}((\\Delta x)^{5}),\n$$\n$$\nu(x_{i-\\frac{1}{2}},y_j) = u(x_{i+\\frac{1}{2}},y_j) - \\Delta x\\, u_{x}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta x)^{2}}{2}\\, u_{xx}(x_{i+\\frac{1}{2}},y_j) - \\frac{(\\Delta x)^{3}}{6}\\, u_{xxx}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta x)^{4}}{24}\\, u_{xxxx}(x_{i+\\frac{1}{2}},y_j) + \\mathcal{O}((\\Delta x)^{5}),\n$$\n其中下标表示在 $(x_{i+\\frac{1}{2}},y_j)$ 处求值的偏导数。将这两个表达式相加，再减去两倍的 $u(x_{i+\\frac{1}{2}},y_j)$，得到\n$$\nu(x_{i+\\frac{3}{2}},y_j) - 2\\,u(x_{i+\\frac{1}{2}},y_j) + u(x_{i-\\frac{1}{2}},y_j) = (\\Delta x)^{2}\\, u_{xx}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta x)^{4}}{12}\\, u_{xxxx}(x_{i+\\frac{1}{2}},y_j) + \\mathcal{O}((\\Delta x)^{6}).\n$$\n除以 $(\\Delta x)^{2}$ 得到二阶中心差分近似\n$$\n\\frac{u_{i+\\frac{3}{2},\\,j} - 2\\,u_{i+\\frac{1}{2},\\,j} + u_{i-\\frac{1}{2},\\,j}}{(\\Delta x)^{2}} = u_{xx}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta x)^{2}}{12}\\, u_{xxxx}(x_{i+\\frac{1}{2}},y_j) + \\mathcal{O}((\\Delta x)^{4}),\n$$\n其在 $\\Delta x$ 上具有二阶精度。\n\n对于在 $(x_{i+\\frac{1}{2}},y_j)$ 处沿 $y$ 方向的二阶导数，使用点 $(x_{i+\\frac{1}{2}},y_{j+1})$ 和 $(x_{i+\\frac{1}{2}},y_{j-1})$，其中 $y_{j+1} - y_j = \\Delta y$ 且 $y_j - y_{j-1} = \\Delta y$。关于 $(x_{i+\\frac{1}{2}},y_j)$ 的泰勒展开式为\n$$\nu(x_{i+\\frac{1}{2}},y_{j+1}) = u(x_{i+\\frac{1}{2}},y_j) + \\Delta y\\, u_{y}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta y)^{2}}{2}\\, u_{yy}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta y)^{3}}{6}\\, u_{yyy}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta y)^{4}}{24}\\, u_{yyyy}(x_{i+\\frac{1}{2}},y_j) + \\mathcal{O}((\\Delta y)^{5}),\n$$\n$$\nu(x_{i+\\frac{1}{2}},y_{j-1}) = u(x_{i+\\frac{1}{2}},y_j) - \\Delta y\\, u_{y}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta y)^{2}}{2}\\, u_{yy}(x_{i+\\frac{1}{2}},y_j) - \\frac{(\\Delta y)^{3}}{6}\\, u_{yyy}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta y)^{4}}{24}\\, u_{yyyy}(x_{i+\\frac{1}{2}},y_j) + \\mathcal{O}((\\Delta y)^{5}).\n$$\n求和并减去两倍的 $u(x_{i+\\frac{1}{2}},y_j)$，得到\n$$\nu(x_{i+\\frac{1}{2}},y_{j+1}) - 2\\,u(x_{i+\\frac{1}{2}},y_j) + u(x_{i+\\frac{1}{2}},y_{j-1}) = (\\Delta y)^{2}\\, u_{yy}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta y)^{4}}{12}\\, u_{yyyy}(x_{i+\\frac{1}{2}},y_j) + \\mathcal{O}((\\Delta y)^{6}),\n$$\n因此二阶中心差分近似为\n$$\n\\frac{u_{i+\\frac{1}{2},\\,j+1} - 2\\,u_{i+\\frac{1}{2},\\,j} + u_{i+\\frac{1}{2},\\,j-1}}{(\\Delta y)^{2}} = u_{yy}(x_{i+\\frac{1}{2}},y_j) + \\frac{(\\Delta y)^{2}}{12}\\, u_{yyyy}(x_{i+\\frac{1}{2}},y_j) + \\mathcal{O}((\\Delta y)^{4}),\n$$\n其在 $\\Delta y$ 上具有二阶精度。\n\n将这两个近似相加，得到在 $(x_{i+\\frac{1}{2}},y_j)$ 处的离散拉普拉斯算子：\n$$\n\\frac{u_{i+\\frac{3}{2},\\,j} - 2\\,u_{i+\\frac{1}{2},\\,j} + u_{i-\\frac{1}{2},\\,j}}{(\\Delta x)^{2}} + \\frac{u_{i+\\frac{1}{2},\\,j+1} - 2\\,u_{i+\\frac{1}{2},\\,j} + u_{i+\\frac{1}{2},\\,j-1}}{(\\Delta y)^{2}} = \\nabla^{2} u(x_{i+\\frac{1}{2}},y_j) + \\mathcal{O}((\\Delta x)^{2}) + \\mathcal{O}((\\Delta y)^{2}).\n$$\n\n剩下的问题是解释为什么交叉导数项 $u_{xy}(x_{i+\\frac{1}{2}},y_j)$ 没有出现在所构建的离散算子中。考虑 $u$ 在 $(x_{0},y_{0})$ 点关于 $(x_{0}+h,y_{0}+k)$ 的二维泰勒展开：\n$$\nu(x_{0}+h,y_{0}+k) = u(x_{0},y_{0}) + h\\, u_{x} + k\\, u_{y} + \\frac{h^{2}}{2}\\, u_{xx} + h k\\, u_{xy} + \\frac{k^{2}}{2}\\, u_{yy} + \\cdots,\n$$\n其中所有导数均在 $(x_{0},y_{0})$ 处求值。混合导数 $u_{xy}$ 乘以乘积 $h k$。在上面用于近似 $u_{xx}$ 和 $u_{yy}$ 的差分格式中，偏移量纯粹沿着一个坐标方向：对于 $u_{xx}$，点的偏移为 $(h,k)=(\\pm \\Delta x,0)$；对于 $u_{yy}$，点的偏移为 $(h,k)=(0,\\pm \\Delta y)$。在这两种情况下，都有 $h k = 0$，因此在所选模板点的展开式中，混合导数项恒为零。此外，根据定义，笛卡尔坐标系中的拉普拉斯算子不包含交叉导数，即 $\\nabla^{2} u = u_{xx} + u_{yy}$，这反映了坐标方向的正交性和度量系数的均匀性。因此，当通过将两个解耦的二阶导数相加来形成离散拉普拉斯算子时，不会引入交叉导数项，并且所构造的算子是一个以 $(i+\\tfrac{1}{2},j)$ 为中心的五点格式，仅涉及沿坐标轴对齐的邻点。\n\n因此，在均匀笛卡尔 MAC 交错网格上，于 $(i+\\tfrac{1}{2},j)$ 处的 $\\nabla^{2} u$ 的二阶中心差分近似为\n$$\n\\frac{u_{i+\\frac{3}{2},\\,j} - 2\\,u_{i+\\frac{1}{2},\\,j} + u_{i-\\frac{1}{2},\\,j}}{(\\Delta x)^{2}} + \\frac{u_{i+\\frac{1}{2},\\,j+1} - 2\\,u_{i+\\frac{1}{2},\\,j} + u_{i+\\frac{1}{2},\\,j-1}}{(\\Delta y)^{2}},\n$$\n其截断误差为 $\\mathcal{O}((\\Delta x)^{2}) + \\mathcal{O}((\\Delta y)^{2})$，并且由于网格的正交性和差分格式点的轴向对齐，所有交叉导数项均消失。",
            "answer": "$$\\boxed{\\frac{u_{i+\\frac{3}{2},\\,j} - 2\\,u_{i+\\frac{1}{2},\\,j} + u_{i-\\frac{1}{2},\\,j}}{(\\Delta x)^{2}} + \\frac{u_{i+\\frac{1}{2},\\,j+1} - 2\\,u_{i+\\frac{1}{2},\\,j} + u_{i+\\frac{1}{2},\\,j-1}}{(\\Delta y)^{2}}}$$"
        },
        {
            "introduction": "非线性平流项的处理需要特别的技巧。这项高级练习探讨了如何在单元格表面定义平流速度，以确保其与离散连续性方程相容。这是防止产生虚假质量源并保证求解器稳定性的关键一步，突显了在数值格式中保持物理守恒律的重要性 。",
            "id": "3346585",
            "problem": "考虑在均匀笛卡尔交错网格（标记与网格(MAC)类型）上的不可压缩流。设网格单元索引为 $(i,j)$，网格间距为 $\\Delta x$ 和 $\\Delta y$，面心速度为 $u_{i+1/2,j}$（位于垂直面上）和 $v_{i,j+1/2}$（位于水平面上）。假设您已计算出一个单元中心通量场 $\\boldsymbol{H}_{i,j}=\\left(H^x_{i,j},H^y_{i,j}\\right)$，该场在二阶中心差分的意义下是离散无散的，即对于所有内部单元，\n$$\n\\frac{H^x_{i+1,j}-H^x_{i-1,j}}{2\\,\\Delta x}+\\frac{H^y_{i,j+1}-H^y_{i,j-1}}{2\\,\\Delta y}=0.\n$$\n在动量方程的对流项和标量输运中，您需要用到面上的对流速度。目标是通过将 $\\boldsymbol{H}_{i,j}$ 插值到面上来计算质量相容的面对流速度 $(u^{\\mathrm{adv}},v^{\\mathrm{adv}})$，使得离散连续性方程\n$$\n\\frac{u^{\\mathrm{adv}}_{i+1/2,j}-u^{\\mathrm{adv}}_{i-1/2,j}}{\\Delta x}+\\frac{v^{\\mathrm{adv}}_{i,j+1/2}-v^{\\mathrm{adv}}_{i,j-1/2}}{\\Delta y}=0,\n$$\n在给定的单元中心场 $\\boldsymbol{H}_{i,j}$ 满足所述的离散无散条件时成立。请从均匀网格上的有限体积形式的连续性方程和离散散度定理出发，推导一个二阶插值方案，该方案将 $\\boldsymbol{H}_{i,j}$ 映射到具有上述质量相容性质的 $(u^{\\mathrm{adv}}_{i+1/2,j},v^{\\mathrm{adv}}_{i,j+1/2})$。然后，讨论在对流和连续性离散化中一致地使用这些面对流速度对保持离散连续性的影响，并将其与使用不保持散度的单侧迎风面插值的影响进行对比。\n\n哪几项陈述是正确的？\n\nA. 在具有周期性边界的均匀网格上，通过对相邻单元中心的通量分量进行平均以获得面对流速度，即 $u^{\\mathrm{adv}}_{i+1/2,j}=\\left(H^x_{i,j}+H^x_{i+1,j}\\right)/2$ 和 $v^{\\mathrm{adv}}_{i,j+1/2}=\\left(H^y_{i,j}+H^y_{i,j+1}\\right)/2$，会产生一个基于面的离散散度，其值与 $\\boldsymbol{H}_{i,j}$ 的中心差分散度完全相等，因此只要单元中心散度为零，离散连续性就得以保持。\n\nB. 使用单侧迎风插值在面上获得 $u^{\\mathrm{adv}}$ 和 $v^{\\mathrm{adv}}$，可以保证保持与 $\\boldsymbol{H}_{i,j}$ 的中心差分散度相同的离散散度，因此也能保证连续性的保持。\n\nC. 如果在动量对流项和连续性更新中都使用质量相容的面对流速度，离散连续性残差将保持在机器舍入误差水平（除去边界封闭处理的影响），因此对流不会为压力泊松方程引入非零源项。\n\nD. 即使单元中心场 $\\boldsymbol{H}_{i,j}$ 在二阶中心差分下是无散的，任何到面上的插值都无法保持连续性，除非在插值后面场上施加一个显式的 Helmholtz–Hodge 分解。\n\nE. 当动量方程中的对流项在均匀网格上使用质量相容的面对流速度以斜对称形式进行离散化时，无粘离散动能是守恒的，因为面场在斜对称格式所要求的离散意义下是无散的。",
            "solution": "该问题要求我们验证一个关于在交错网格上离散化不可压缩流的陈述。首先，我们必须验证问题陈述本身。\n\n### 步骤1：提取已知条件\n- 网格：均匀笛卡尔交错网格（标记与网格或MAC类型）。\n- 单元索引：$(i,j)$。\n- 网格间距：$\\Delta x$ 和 $\\Delta y$。\n- 一个单元中心通量场：$\\boldsymbol{H}_{i,j}=\\left(H^x_{i,j},H^y_{i,j}\\right)$。\n- 关于 $\\boldsymbol{H}_{i,j}$ 的条件：对于所有内部单元，它相对于一个我们记为 $D_c$ 的二阶中心差分算子是离散无散的：\n$$ (D_c \\boldsymbol{H})_{i,j} \\equiv \\frac{H^x_{i+1,j}-H^x_{i-1,j}}{2\\,\\Delta x}+\\frac{H^y_{i,j+1}-H^y_{i,j-1}}{2\\,\\Delta y}=0. $$\n- 目标：找到一个二阶插值方法，从 $\\boldsymbol{H}_{i,j}$ 计算面对流速度 $(u^{\\mathrm{adv}}_{i+1/2,j}, v^{\\mathrm{adv}}_{i,j+1/2})$，使得所得的面心场相对于我们记为 $D_f$ 的标准MAC网格散度算子是离散无散的。即，我们要求：\n$$ (D_f \\boldsymbol{u}^{\\mathrm{adv}})_{i,j} \\equiv \\frac{u^{\\mathrm{adv}}_{i+1/2,j}-u^{\\mathrm{adv}}_{i-1/2,j}}{\\Delta x}+\\frac{v^{\\mathrm{adv}}_{i,j+1/2}-v^{\\mathrm{adv}}_{i,j-1/2}}{\\Delta y}=0. $$\n该性质必须在 $(D_c \\boldsymbol{H})_{i,j}=0$ 时成立。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述具有科学依据、是适定的且客观的。它探讨了计算流体动力学中的一个基本问题：为对流构建与离散连续性方程相容的速度场。两种不同的离散散度算子，一个用于单元中心场，另一个用于面心场，都是标准定义。如何通过插值将它们联系起来的问题，是一个明确定义的数学问题，与求解纳维-斯托克斯方程的投影法的稳定性和准确性相关。该问题不包含任何科学缺陷、歧义或矛盾。\n\n### 步骤3：结论与行动\n问题是有效的。我们继续进行求解。\n\n### 质量相容插值的推导\n\n问题要求一个二阶插值格式，能将单元中心场 $\\boldsymbol{H}_{i,j}$ 映射到面心场 $\\boldsymbol{u}^{\\mathrm{adv}} = (u^{\\mathrm{adv}}, v^{\\mathrm{adv}})$，同时保持两种不同离散算子之间的无散性质。\n\n让我们提出一个简单的二阶线性插值格式，其中面上的速度是来自两个相邻单元中心的通量分量的平均值：\n$$ u^{\\mathrm{adv}}_{i+1/2,j} = \\frac{H^x_{i,j} + H^x_{i+1,j}}{2} $$\n$$ v^{\\mathrm{adv}}_{i,j+1/2} = \\frac{H^y_{i,j} + H^y_{i,j+1}}{2} $$\n现在，我们计算这个面心场的离散散度 $(D_f \\boldsymbol{u}^{\\mathrm{adv}})_{i,j}$，该散度是为以 $(i,j)$ 为中心的控制体定义的：\n$$ (D_f \\boldsymbol{u}^{\\mathrm{adv}})_{i,j} = \\frac{u^{\\mathrm{adv}}_{i+1/2,j}-u^{\\mathrm{adv}}_{i-1/2,j}}{\\Delta x}+\\frac{v^{\\mathrm{adv}}_{i,j+1/2}-v^{\\mathrm{adv}}_{i,j-1/2}}{\\Delta y} $$\n代入 $u^{\\mathrm{adv}}$ 的插值公式：\n$$ u^{\\mathrm{adv}}_{i+1/2,j} = \\frac{1}{2}(H^x_{i,j} + H^x_{i+1,j}) $$\n$$ u^{\\mathrm{adv}}_{i-1/2,j} = \\frac{1}{2}(H^x_{i-1,j} + H^x_{i,j}) $$\n散度的第一项变为：\n$$ \\frac{u^{\\mathrm{adv}}_{i+1/2,j}-u^{\\mathrm{adv}}_{i-1/2,j}}{\\Delta x} = \\frac{1}{\\Delta x} \\left( \\frac{H^x_{i,j} + H^x_{i+1,j}}{2} - \\frac{H^x_{i-1,j} + H^x_{i,j}}{2} \\right) = \\frac{H^x_{i+1,j} - H^x_{i-1,j}}{2\\Delta x} $$\n类似地，对于 $v^{\\mathrm{adv}}$ 分量：\n$$ v^{\\mathrm{adv}}_{i,j+1/2} = \\frac{1}{2}(H^y_{i,j} + H^y_{i,j+1}) $$\n$$ v^{\\mathrm{adv}}_{i,j-1/2} = \\frac{1}{2}(H^y_{i,j-1} + H^y_{i,j}) $$\n散度的第二项变为：\n$$ \\frac{v^{\\mathrm{adv}}_{i,j+1/2}-v^{\\mathrm{adv}}_{i,j-1/2}}{\\Delta y} = \\frac{1}{\\Delta y} \\left( \\frac{H^y_{i,j} + H^y_{i,j+1}}{2} - \\frac{H^y_{i,j-1} + H^y_{i,j}}{2} \\right) = \\frac{H^y_{i,j+1} - H^y_{i,j-1}}{2\\Delta y} $$\n将两项相加，我们发现两个散度算子之间存在一个直接关系：\n$$ (D_f \\boldsymbol{u}^{\\mathrm{adv}})_{i,j} = \\frac{H^x_{i+1,j}-H^x_{i-1,j}}{2\\Delta x}+\\frac{H^y_{i,j+1}-H^y_{i,j-1}}{2\\Delta y} = (D_c \\boldsymbol{H})_{i,j} $$\n这个结果表明，平均场的MAC网格散度与原始单元中心场的中心差分散度恒等。因此，如果 $\\boldsymbol{H}_{i,j}$ 在中心差分意义下是无散的（即 $(D_c \\boldsymbol{H})_{i,j} = 0$），那么插值得到的面速度场 $\\boldsymbol{u}^{\\mathrm{adv}}$ 保证在MAC网格意义下是无散的（即 $(D_f \\boldsymbol{u}^{\\mathrm{adv}})_{i,j} = 0$）。这种平均格式就是所要求的“质量相容”插值。\n\n现在我们评估每个陈述。\n\n### 逐项分析\n\n**A. 在具有周期性边界的均匀网格上，通过对相邻单元中心的通量分量进行平均以获得面对流速度，即 $u^{\\mathrm{adv}}_{i+1/2,j}=\\left(H^x_{i,j}+H^x_{i+1,j}\\right)/2$ 和 $v^{\\mathrm{adv}}_{i,j+1/2}=\\left(H^y_{i,j}+H^y_{i,j+1}\\right)/2$，会产生一个基于面的离散散度，其值与 $\\boldsymbol{H}_{i,j}$ 的中心差分散度完全相等，因此只要单元中心散度为零，离散连续性就得以保持。**\n我们上面的推导表明这个陈述是完全正确的。基于面的离散散度 $(D_f \\boldsymbol{u}^{\\mathrm{adv}})_{i,j}$ 在代数上与单元中心的离散散度 $(D_c \\boldsymbol{H})_{i,j}$ 相同。因此，如果 $(D_c \\boldsymbol{H})_{i,j}=0$，那么 $(D_f \\boldsymbol{u}^{\\mathrm{adv}})_{i,j}=0$。提及周期性边界是为了确保模板操作对所有单元都有良好定义，但核心的代数恒等式对任何内部单元都成立。\n结论：**正确**。\n\n**B. 使用单侧迎风插值在面上获得 $u^{\\mathrm{adv}}$ 和 $v^{\\mathrm{adv}}$，可以保证保持与 $\\boldsymbol{H}_{i,j}$ 的中心差分散度相同的离散散度，因此也能保证连续性的保持。**\n让我们分析单侧迎风插值。面上的插值取自上风向的单元中心。为简单起见，假设流向为正 $x$ 和正 $y$ 方向，因此处处有 $H^x > 0$ 和 $H^y > 0$。插值为：\n$u^{\\mathrm{adv}}_{i+1/2,j} = H^x_{i,j}$\n$v^{\\mathrm{adv}}_{i,j+1/2} = H^y_{i,j}$\n基于面的散度变为：\n$$ (D_f \\boldsymbol{u}^{\\mathrm{adv}})_{i,j} = \\frac{H^x_{i,j} - H^x_{i-1,j}}{\\Delta x} + \\frac{H^y_{i,j} - H^y_{i-1,j}}{\\Delta y} $$\n这个表达式是一个一阶后向差分散度算子。它与二阶中心差分算子 $(D_c \\boldsymbol{H})_{i,j}$ 有着根本的不同。没有理由认为如果其中一个为零，另一个也为零。例如，考虑一个由序列 $\\{..., c, d, c, d, ...\\}$ 定义的一维场 $H^x_i$。中心差分 $(H^x_{i+1}-H^x_{i-1})/(2\\Delta x)$ 在每个单元处都为零，但基于迎风格式的散度 $(H^x_i - H^x_{i-1})/\\Delta x$ 会在 $(d-c)/\\Delta x$ 和 $(c-d)/\\Delta x$ 之间交替，如果 $c \\ne d$ 则非零。因此，迎风格式不保持无散性质。\n结论：**不正确**。\n\n**C. 如果在动量对流项和连续性更新中都使用质量相容的面对流速度，离散连续性残差将保持在机器舍入误差水平（除去边界封闭处理的影响），因此对流不会为压力泊松方程引入非零源项。**\n这个陈述描述了不可压缩流投影法中的一个关键原则。一个主要的挑战是确保对流项的数值离散化不违反离散连续性约束。如果对流步骤在速度场中产生了非零散度，这会充当一个人为的质量源/汇，压力投影步骤必须对其进行修正。压力泊松方程的源项与对流步骤后的临时速度场的散度成正比。通过构造一个“质量相容”（即离散无散）的面对流速度场 $\\boldsymbol{u}^{\\mathrm{adv}}$，并在一个相容的对流格式（即设计为不从无散场中产生散度的格式）中使用它，临时速度的散度可以保持在机器零水平。这意味着对流步骤尊重了连续性约束，并且没有为压力方程产生伪源项。该陈述正确地描述了使用这种质量相容格式的目的和好处。\n结论：**正确**。\n\n**D. 即使单元中心场 $\\boldsymbol{H}_{i,j}$ 在二阶中心差分下是无散的，任何到面上的插值都无法保持连续性，除非在插值后面场上施加一个显式的 Helmholtz–Hodge 分解。**\n这个陈述是错误的。我们对选项A的推导提供了一个直接的反例。简单的平均插值格式直接构造了一个在MAC意义下离散无散的面心场，前提是原始的单元中心场在中心差分意义下是无散的。不需要后续的投影（这是一个涉及求解泊松方程的计算密集型操作）。\n结论：**不正确**。\n\n**E. 当动量方程中的对流项在均匀网格上使用质量相容的面对流速度以斜对称形式进行离散化时，无粘离散动能是守恒的，因为面场在斜对称格式所要求的离散意义下是无散的。**\n对流项的斜对称离散化是指其矩阵表示 $C$ 是斜对称的，即 $C^T = -C$。这个性质对于任何向量 $\\boldsymbol{x}$ 都导致 $\\boldsymbol{x}^T C \\boldsymbol{x} = 0$，对于动量方程而言，这意味着离散动能被对流项精确守恒。在交错网格上为流体对流推导出这种斜对称算子的数学过程，关键依赖于分部求和（散度定理的离散模拟）。这些推导仅在对流速度场在MAC网格意义下是离散无散的（$D_f \\boldsymbol{u}^{\\mathrm{adv}} = 0$）时才成立。“质量相容”的面速度根据定义就是满足这个条件的。因此，在斜对称对流格式中使用它们，满足了离散动能守恒的必要条件。\n结论：**正确**。",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}