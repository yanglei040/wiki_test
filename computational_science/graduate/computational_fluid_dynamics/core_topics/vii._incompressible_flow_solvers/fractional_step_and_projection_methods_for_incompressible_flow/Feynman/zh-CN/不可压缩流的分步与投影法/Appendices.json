{
    "hands_on_practices": [
        {
            "introduction": "投影方法的核心在于将一个任意向量场分解为一个无散度部分和一个无旋度（梯度）部分。本练习提供了一个具体的解析推导，让您从第一性原理出发，推导压力泊松方程 (Pressure Poisson Equation, PPE)，并将其应用于一个给定的非螺线管（有散）速度场。通过计算投影前后的散度，您将亲眼见证该方法如何精确地强制执行不可压缩性约束 。",
            "id": "3321950",
            "problem": "考虑一个周期性域中的二维、常密度不可压缩流，该流动由不可压缩Navier–Stokes方程控制。在无量纲变量下进行计算，因此密度为 $1$ 且时间步长为 $\\Delta t = 1$。域为 $\\Omega = [0,2\\pi]\\times[0,2\\pi]$，在两个方向上均采用周期性边界条件。在标准的分数步投影法中，首先在没有压力的情况下推进一个临时速度场 $\\,\\boldsymbol{u}^{\\ast}\\,$，然后通过压力更新对其进行校正，以强制满足不可压缩性。\n\n从不可压缩流的基本约束和投影步骤的定义出发：校正后的速度满足 $\\,\\nabla\\cdot \\boldsymbol{u}^{n+1} = 0\\,$，并且它是通过从临时速度中减去一个时间步长内的压力梯度得到的。在不假设任何预先推导的公式的情况下，利用这些基础推导出在校正后强制不可压缩性时，压力在周期性边界条件下必须满足的椭圆边值问题。\n\n设给定的临时速度为\n$$\n\\boldsymbol{u}^{\\ast}(x,y) = \\big(2\\sin(x)\\cos(y),\\; -\\cos(x)\\sin(y)\\big), \\quad (x,y)\\in\\Omega.\n$$\n为确保唯一性，对域 $\\Omega$ 上的压力施加标准的零均值条件。\n\n利用以上信息，计算：\n- 在一个投影步骤后强制满足不可压缩性的压力场 $\\,p(x,y)\\,$，以及\n- 由下式定义的散度缩减因子 $\\,r\\,$\n$$\nr \\equiv \\frac{\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^{2}(\\Omega)}}{\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}},\n$$\n其中 $\\|f\\|_{L^{2}(\\Omega)} \\equiv \\left(\\int_{\\Omega} |f|^{2}\\, \\mathrm{d}x\\,\\mathrm{d}y\\right)^{1/2}$。\n\n将您的最终答案以一个数对的形式报告，该数对由 $\\,p(x,y)\\,$ 的闭式表达式和标量 $\\,r\\,$ 组成。由于进行了无量纲化，因此不需要单位。答案必须是包含这两个条目的单行矩阵。无需四舍五入。",
            "solution": "首先，我们从分数步投影法的基本原理推导压力泊松方程 (PPE)。校正后的速度 $\\boldsymbol{u}^{n+1}$ 通过从临时速度 $\\boldsymbol{u}^{\\ast}$ 中减去压力梯度得到，并且必须满足不可压缩性约束。\n\n给定关系式 $\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\ast} - \\Delta t \\nabla p$ 和约束 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$。在本问题中，无量纲化后 $\\Delta t = 1$，因此：\n$$\n\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^{\\ast} - \\nabla p\n$$\n对上式两边取散度：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{n+1} = \\nabla \\cdot (\\boldsymbol{u}^{\\ast} - \\nabla p) = \\nabla \\cdot \\boldsymbol{u}^{\\ast} - \\nabla \\cdot (\\nabla p)\n$$\n应用不可压缩性约束并利用 $\\nabla \\cdot (\\nabla p) = \\nabla^2 p$ (拉普拉斯算子)，我们得到压力泊松方程：\n$$\n0 = \\nabla \\cdot \\boldsymbol{u}^{\\ast} - \\nabla^2 p \\implies \\nabla^2 p = \\nabla \\cdot \\boldsymbol{u}^{\\ast}\n$$\n接下来，我们为给定的临时速度场 $\\boldsymbol{u}^{\\ast}(x,y) = (2\\sin(x)\\cos(y), -\\cos(x)\\sin(y))$ 求解这个方程。\n\n**1. 计算源项**\nPPE的源项是 $\\boldsymbol{u}^{\\ast}$ 的散度：\n$$\n\\nabla \\cdot \\boldsymbol{u}^{\\ast} = \\frac{\\partial u^{\\ast}}{\\partial x} + \\frac{\\partial v^{\\ast}}{\\partial y} = \\frac{\\partial}{\\partial x}(2\\sin(x)\\cos(y)) + \\frac{\\partial}{\\partial y}(-\\cos(x)\\sin(y))\n$$\n$$\n\\nabla \\cdot \\boldsymbol{u}^{\\ast} = 2\\cos(x)\\cos(y) - \\cos(x)\\cos(y) = \\cos(x)\\cos(y)\n$$\n因此，我们需要求解的PPE是：\n$$\n\\nabla^2 p(x,y) = \\cos(x)\\cos(y)\n$$\n\n**2. 求解压力场**\n由于源项的形式和周期性边界条件，我们假设解的形式为 $p(x,y) = A\\cos(x)\\cos(y)$。计算其拉普拉斯算子：\n$$\n\\nabla^2 p = \\frac{\\partial^2 p}{\\partial x^2} + \\frac{\\partial^2 p}{\\partial y^2} = -A\\cos(x)\\cos(y) - A\\cos(x)\\cos(y) = -2A\\cos(x)\\cos(y)\n$$\n将其与源项相等：\n$$\n-2A\\cos(x)\\cos(y) = \\cos(x)\\cos(y) \\implies -2A = 1 \\implies A = -\\frac{1}{2}\n$$\n一般解为 $p(x,y) = -\\frac{1}{2}\\cos(x)\\cos(y) + C$。为了确定常数 $C$，我们应用零均值条件 $\\int_{\\Omega} p(x,y)\\, \\mathrm{d}A = 0$。\n由于 $\\cos(x)$ 和 $\\cos(y)$ 在 $[0, 2\\pi]$ 上的积分为零，$\\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\cos(x)\\cos(y) \\, \\mathrm{d}x\\,\\mathrm{d}y = 0$。因此，积分条件变为 $\\int_{\\Omega} C \\, \\mathrm{d}A = C(2\\pi)^2 = 0$，这意味着 $C=0$。\n唯一的压力场是：\n$$\np(x,y) = -\\frac{1}{2}\\cos(x)\\cos(y)\n$$\n\n**3. 计算散度缩减因子**\n缩减因子定义为 $r = \\frac{\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^{2}(\\Omega)}}{\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}}$。\n根据构造，投影步骤精确满足 $\\nabla \\cdot \\boldsymbol{u}^{n+1} = 0$。因此，分子为零：$\\|\\nabla\\cdot \\boldsymbol{u}^{n+1}\\|_{L^{2}(\\Omega)} = 0$。\n分母需要 $\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}$。我们有 $\\nabla \\cdot \\boldsymbol{u}^{\\ast} = \\cos(x)\\cos(y)$。\n$$\n\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}^2 = \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\cos^2(x)\\cos^2(y) \\, \\mathrm{d}x\\,\\mathrm{d}y = \\left(\\int_{0}^{2\\pi} \\cos^2(t) \\, \\mathrm{d}t\\right)^2\n$$\n使用恒等式 $\\cos^2(t) = \\frac{1}{2}(1 + \\cos(2t))$，我们得到 $\\int_{0}^{2\\pi} \\cos^2(t) \\, \\mathrm{d}t = \\pi$。\n因此，$\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)}^2 = \\pi^2$，且 $\\|\\nabla\\cdot \\boldsymbol{u}^{\\ast}\\|_{L^{2}(\\Omega)} = \\pi$。\n由于分母不为零，缩减因子是良定义的：\n$$\nr = \\frac{0}{\\pi} = 0\n$$\n这证实了投影步骤在理论上完全消除了散度。最终答案由数对 $(p(x,y), r)$ 组成。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{2}\\cos(x)\\cos(y) & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从连续方程到离散网格的转化过程中，会出现新的数值挑战。在配置网格（即将压力和速度变量存储在同一网格点）上，简单的离散化会导致非物理性的压力振荡，这种现象被称为压力-速度解耦。本练习将探讨这种不稳定性的根源，并演示 Rhie-Chow 插值技术如何通过确保离散算子的一致性来恢复稳定性，这对于获得物理上合理的结果至关重要 。",
            "id": "3322014",
            "problem": "考虑一个长度为 $L$ 的周期性域上的一维不可压缩流，其密度 $\\rho$ 为常数。该域通过一个均匀的同位网格进行离散，网格中心有 $N$ 个，位置为 $x_i = i h$，$i = 0, 1, \\dots, N-1$，其中 $h = L/N$。不可压缩Navier–Stokes方程通过分步（投影）法进行离散：首先推进不含压力梯度的动量方程，得到一个中间速度 $u^{*}$，然后通过压力修正将该速度投影到一个无散场上。速度修正假设与压力梯度呈线性关系，\n$$\nu^{n+1} = u^{*} - \\alpha \\nabla p,\n$$\n其中 $\\alpha = \\Delta t/\\rho$，$\\Delta t$ 为时间步长，$\\rho$ 为恒定密度。在同位网格上，离散连续性方程使用面法向通量，因此，在网格中心计算离散散度时所用的面速度，是通过对网格中心量进行插值构造的。\n\n在均匀网格上定义以下离散算子：\n- 压力的面心离散梯度，\n$$\nG_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} = \\frac{p_{i+1} - p_i}{h}.\n$$\n- 压力的格心离散梯度，\n$$\nG_{\\mathrm{cell}} p\\big|_{i} = \\frac{p_{i+1} - p_{i-1}}{2 h}.\n$$\n- 中间速度的线性面插值，\n$$\n\\mathcal{I} u^{*}\\big|_{i+\\frac{1}{2}} = \\frac{u^{*}_i + u^{*}_{i+1}}{2}.\n$$\n- 面速度的格心离散散度，\n$$\nD u\\big|_{i} = \\frac{u\\big|_{i+\\frac{1}{2}} - u\\big|_{i-\\frac{1}{2}}}{h}.\n$$\n\n为了避免同位网格上的压力-速度解耦，引入了一种Rhie–Chow型插值，该方法通过混合在面上计算的压力梯度和格心梯度的平均值来实现。具体来说，考虑单参数族\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\theta\\, G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} + (1-\\theta)\\, \\frac{G_{\\mathrm{cell}} p\\big|_{i} + G_{\\mathrm{cell}} p\\big|_{i+1}}{2},\n$$\n其中 $\\theta \\in \\mathbb{R}$，并将连续性方程中使用的面速度定义为\n$$\nu\\big|_{i+\\frac{1}{2}} = \\mathcal{I} u^{*}\\big|_{i+\\frac{1}{2}} - \\alpha\\, g_{i+\\frac{1}{2}}^{(\\theta)}.\n$$\n\n从不可压缩性约束和投影法出发，分析上述Rhie–Chow型插值在抑制压力-速度解耦方面的作用。在周期性边界条件（无边界）下，推导离散梯度-散度一致性条件。此条件要求：对于任意离散压力场 $p$，由修正项 $-\\alpha\\, g_{i+\\frac{1}{2}}^{(\\theta)}$ 产生的对离散散度 $D u$ 的压力贡献，必须与通过复合 $D$ 和 $G_{\\mathrm{face}}$ 得到的标准离散拉普拉斯算子一致：\n$$\nD\\Big(-\\alpha\\, G_{\\mathrm{face}} p\\Big) \\equiv D\\Big(-\\alpha\\, g^{(\\theta)}\\Big).\n$$\n\n确定混合参数 $\\theta$ 的唯一标量值，该值需在周期性网格上对所有网格解析的傅里叶模态满足此一致性条件。在推导过程中，请明确展示 $\\theta$ 的选择如何影响作用于 $p$ 的离散算子，并解释Rhie–Chow构造如何避免伪奇偶（棋盘）压力-速度解耦。你的最终答案必须是单个实数 $\\theta$；不需要单位。",
            "solution": "我们的目标是确定混合参数 $\\theta$ 的值，该值需满足离散梯度-散度一致性条件：\n$$\nD\\Big(-\\alpha\\, G_{\\mathrm{face}} p\\Big) \\equiv D\\Big(-\\alpha\\, g^{(\\theta)}\\Big)\n$$\n这个恒等式必须对任何离散压力场 $p$ 都成立。两边的常数因子 $-\\alpha$ 可以消去，得到算子恒等式：\n$$\nD\\left(G_{\\mathrm{face}} p\\right) = D\\left(g^{(\\theta)}\\right)\n$$\n我们将分别展开该方程的两边，并比较它们的离散模板。\n\n**1. 左侧 (LHS) 的展开**\n左侧是标准的离散拉普拉斯算子，通过复合散度算子和面心梯度算子得到：\n$$\n\\text{LHS} = D\\left(G_{\\mathrm{face}} p\\right)\\Big|_i = \\frac{G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} - G_{\\mathrm{face}} p\\big|_{i-\\frac{1}{2}}}{h}\n$$\n代入 $G_{\\mathrm{face}}$ 的定义：\n$$\n\\text{LHS} = \\frac{1}{h} \\left( \\frac{p_{i+1} - p_i}{h} - \\frac{p_i - p_{i-1}}{h} \\right) = \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2}\n$$\n这是一个作用于 $p_i$ 的紧凑三点模板。\n\n**2. 右侧 (RHS) 的展开**\n右侧涉及混合梯度 $g^{(\\theta)}$：\n$$\n\\text{RHS} = D\\left(g^{(\\theta)}\\right)\\Big|_i = \\frac{g_{i+\\frac{1}{2}}^{(\\theta)} - g_{i-\\frac{1}{2}}^{(\\theta)}}{h}\n$$\n首先，我们将 $g_{i+\\frac{1}{2}}^{(\\theta)}$ 用压力值 $p_j$ 表示：\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\theta\\, G_{\\mathrm{face}} p\\big|_{i+\\frac{1}{2}} + (1-\\theta)\\, \\frac{G_{\\mathrm{cell}} p\\big|_{i} + G_{\\mathrm{cell}} p\\big|_{i+1}}{2}\n$$\n代入梯度算子的定义：\n$$\ng_{i+\\frac{1}{2}}^{(\\theta)} = \\theta \\left( \\frac{p_{i+1} - p_i}{h} \\right) + \\frac{1-\\theta}{2} \\left( \\frac{p_{i+1} - p_{i-1}}{2h} + \\frac{p_{i+2} - p_i}{2h} \\right) = \\frac{\\theta}{h}(p_{i+1} - p_i) + \\frac{1-\\theta}{4h}(p_{i+2} + p_{i+1} - p_i - p_{i-1})\n$$\n通过将索引 $i$ 移位到 $i-1$，我们得到 $g_{i-\\frac{1}{2}}^{(\\theta)}$：\n$$\ng_{i-\\frac{1}{2}}^{(\\theta)} = \\frac{\\theta}{h}(p_{i} - p_{i-1}) + \\frac{1-\\theta}{4h}(p_{i+1} + p_{i} - p_{i-1} - p_{i-2})\n$$\n现在，计算差值 $g_{i+\\frac{1}{2}}^{(\\theta)} - g_{i-\\frac{1}{2}}^{(\\theta)}$ 并除以 $h$。我们将与 $\\theta$ 和 $(1-\\theta)$ 成比例的项分开处理。\n- 与 $\\theta$ 相关的项贡献为:\n  $$\n  \\frac{1}{h} \\left[ \\frac{\\theta}{h}(p_{i+1} - p_i) - \\frac{\\theta}{h}(p_i - p_{i-1}) \\right] = \\theta \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2}\n  $$\n- 与 $(1-\\theta)$ 相关的项贡献为:\n  $$\n  \\frac{1-\\theta}{4h^2} \\left[ (p_{i+2} + p_{i+1} - p_i - p_{i-1}) - (p_{i+1} + p_i - p_{i-1} - p_{i-2}) \\right] = \\frac{1-\\theta}{4h^2} (p_{i+2} - 2p_i + p_{i-2})\n  $$\n将两部分合并，得到RHS的完整表达式：\n$$\n\\text{RHS} = \\theta \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} + (1-\\theta) \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}\n$$\n\n**3. 求解 $\\theta$**\n令 LHS = RHS：\n$$\n\\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} = \\theta \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} + (1-\\theta) \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}\n$$\n整理各项：\n$$\n(1-\\theta) \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} = (1-\\theta) \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2}\n$$\n$$\n(1-\\theta) \\left( \\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2} - \\frac{p_{i+2} - 2p_i + p_{i-2}}{4h^2} \\right) = 0\n$$\n该等式必须对任意离散压力场 $p$ 成立。括号内的算子通常不是零算子（例如，它对一个四次多项式不为零）。因此，唯一的可能是其标量系数为零：\n$$\n1 - \\theta = 0 \\implies \\theta = 1\n$$\n选择 $\\theta=1$ 意味着 Rhie-Chow 压力梯度 $g^{(1)}$ 等于面心梯度 $G_{\\mathrm{face}} p$，从而确保了离散压力泊松算子是标准的、稳定的三点拉普拉斯算子 $\\frac{p_{i+1} - 2p_i + p_{i-1}}{h^2}$。这个算子能“看见”并惩罚非物理的棋盘压力模态（如 $p_i = C(-1)^i$），从而消除了导致压力-速度解耦的主要不稳定来源。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在实现一个复杂的数值格式后，验证其代码的正确性是至关重要的一步。制造解方法 (Method of Manufactured Solutions, MMS) 是一种严谨且强大的代码验证技术。本练习将引导您完成MMS的流程，您将从一个预设的、满足不可压缩条件的解析速度场和压力场出发，反向推导出必须施加在动量方程中的相应体力项以及压力泊松方程的边界条件，从而能够系统地测试您的求解器 。",
            "id": "3322036",
            "problem": "考虑在单位正方形域 $\\Omega = [0,1] \\times [0,1]$ 上，时间 $t \\ge 0$ 时，速度场 $\\mathbf{u}(x,y,t) = (u(x,y,t), v(x,y,t))$ 和压力 $p(x,y,t)$ 的二维不可压缩纳维-斯托克斯方程的无量纲形式，\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} - \\nu \\nabla^{2}\\mathbf{u} + \\nabla p = \\mathbf{f}(x,y,t), \\qquad \\nabla\\cdot\\mathbf{u} = 0,\n$$\n其中 $\\nu > 0$ 是运动粘度，$\\mathbf{f}(x,y,t)$ 是体积力。假设在 $\\partial\\Omega$ 的所有四条边上都施加了连续边界条件。您希望通过人造解法来测试分步投影法 (fractional-step projection method) 的分裂误差。\n\n给定由流函数 $\\psi(x,y,t)$ 定义的人造解，\n$$\n\\psi(x,y,t) = A \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t),\n$$\n其中 $A>0$ 和 $\\omega>0$ 为常数，由此构造出速度场为\n$$\nu(x,y,t) = \\frac{\\partial \\psi}{\\partial y} = A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t), \\qquad v(x,y,t) = -\\frac{\\partial \\psi}{\\partial x} = -A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t).\n$$\n压力场规定为\n$$\np(x,y,t) = B \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t),\n$$\n其中 $B>0$ 为常数。底边界 $y=0$ 上的外单位法向量为 $\\mathbf{n} = (0,-1)$。\n\n任务：\n- 从不可压缩纳维-斯托克斯方程作为基本定律出发，验证人造速度场是无散场。\n- 推导体积力 $\\mathbf{f}(x,y,t)$，使得给定的 $(\\mathbf{u},p)$ 在所有时间 $t\\ge 0$ 内精确满足 $\\Omega$ 中的动量方程。\n- 在边界上施加动量平衡的法向分量，推导经典投影步骤中所需的压力泊松方程的诺伊曼边界数据，即在 $y=0$ 上定义的函数 $g(x,t)$，使得在 $y=0$ 处有 $\\partial p/\\partial n = g(x,t)$。\n\n将最终的边界数据 $g(x,t)$ 表示为由 $A$、$B$、$\\omega$、$\\nu$、$\\pi$、$x$ 和 $t$ 组成的单个闭式解析表达式。无需进行数值计算。所有量均为无量纲；不要在表达式中包含单位。",
            "solution": "该问题要求分析给定的人造解，以求解二维不可压缩纳维-斯托克斯方程。任务是验证速度场的无散条件，推导相应的体积力项，并确定域的底边界上压力的诺伊曼边界条件。\n\n控制方程是动量方程和不可压缩性约束：\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} - \\nu \\nabla^{2}\\mathbf{u} + \\nabla p = \\mathbf{f}(x,y,t)\n$$\n$$\n\\nabla\\cdot\\mathbf{u} = 0\n$$\n\n所提供的人造解由流函数 $\\psi(x,y,t) = A \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t)$ 定义，从中推导出速度场 $\\mathbf{u} = (u,v)$：\n$$\nu(x,y,t) = \\frac{\\partial \\psi}{\\partial y} = A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t)\n$$\n$$\nv(x,y,t) = -\\frac{\\partial \\psi}{\\partial x} = -A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t)\n$$\n压力场给出为：\n$$\np(x,y,t) = B \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n$$\n\n首先，我们依次处理这三个任务。\n\n**任务1：验证无散条件**\n\n如果速度场 $\\mathbf{u}$ 的散度为零，即 $\\nabla\\cdot\\mathbf{u} = 0$，则该速度场是无散的。在二维中，即为 $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0$。我们计算速度分量的偏导数：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t) \\right) = A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t)\n$$\n$$\n\\frac{\\partial v}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( -A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t) \\right) = -A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t)\n$$\n散度是这两项之和：\n$$\n\\nabla\\cdot\\mathbf{u} = \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t) - A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t) = 0\n$$\n速度场对于所有 $(x,y,t)$ 确实是无散的。这个结果是预料之中的，因为任何通过 $u = \\partial\\psi/\\partial y$ 和 $v = -\\partial\\psi/\\partial x$ 从流函数 $\\psi$ 推导出的二维速度场，只要 $\\psi$ 是二次连续可微的，根据克莱罗定理关于混合偏导数相等的性质，即 $\\frac{\\partial^2\\psi}{\\partial x \\partial y} = \\frac{\\partial^2\\psi}{\\partial y \\partial x}$，就会自动满足不可压缩条件。\n\n**任务2：推导体积力**\n\n体积力 $\\mathbf{f}(x,y,t)$ 是通过重新排列动量方程来确定的：\n$$\n\\mathbf{f} = \\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} - \\nu \\nabla^{2}\\mathbf{u} + \\nabla p\n$$\n我们计算右侧的每一项。\n\n1.  **时间导数，$\\frac{\\partial \\mathbf{u}}{\\partial t}$**：\n    $$\n    \\frac{\\partial u}{\\partial t} = -A \\pi \\omega \\cos(\\pi y)\\sin(\\pi x)\\sin(\\omega t)\n    $$\n    $$\n    \\frac{\\partial v}{\\partial t} = A \\pi \\omega \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n    $$\n\n2.  **对流项，$(\\mathbf{u}\\cdot\\nabla)\\mathbf{u}$**：\n    其分量为 $(u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y})$ 和 $(u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y})$。我们需要 $\\mathbf{u}$ 关于空间坐标的偏导数：\n    $\\frac{\\partial u}{\\partial x} = A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t)$\n    $\\frac{\\partial u}{\\partial y} = -A \\pi^2 \\sin(\\pi y)\\sin(\\pi x)\\cos(\\omega t)$\n    $\\frac{\\partial v}{\\partial x} = A \\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t)$\n    $\\frac{\\partial v}{\\partial y} = -A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t)$\n\n    x-分量：\n    $u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = (A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t))(A \\pi^2 \\cos(\\pi y)\\cos(\\pi x)\\cos(\\omega t)) + (-A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t))(-A \\pi^2 \\sin(\\pi y)\\sin(\\pi x)\\cos(\\omega t))$\n    $= A^2 \\pi^3 \\sin(\\pi x)\\cos(\\pi x)\\cos^2(\\omega t)[\\cos^2(\\pi y) + \\sin^2(\\pi y)] = A^2 \\pi^3 \\sin(\\pi x)\\cos(\\pi x)\\cos^2(\\omega t) = \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi x)\\cos^2(\\omega t)$\n\n    y-分量：\n    $u \\frac{\\partial v}{\\partial x} + v \\frac{\\partial v}{\\partial y} = (A \\pi \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t))(A \\pi^2 \\sin(\\pi x)\\sin(\\pi y)\\cos(\\omega t)) + (-A \\pi \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t))(-A \\pi^2 \\cos(\\pi x)\\cos(\\pi y)\\cos(\\omega t))$\n    $= A^2 \\pi^3 \\sin(\\pi y)\\cos(\\pi y)\\cos^2(\\omega t)[\\sin^2(\\pi x) + \\cos^2(\\pi x)] = A^2 \\pi^3 \\sin(\\pi y)\\cos(\\pi y)\\cos^2(\\omega t) = \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi y)\\cos^2(\\omega t)$\n\n3.  **粘性项，$-\\nu \\nabla^{2}\\mathbf{u}$**：\n    $\\nabla^2 u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = -A \\pi^3 \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t) - A \\pi^3 \\cos(\\pi y)\\sin(\\pi x)\\cos(\\omega t) = -2 \\pi^2 u$\n    $\\nabla^2 v = \\frac{\\partial^2 v}{\\partial x^2} + \\frac{\\partial^2 v}{\\partial y^2} = A \\pi^3 \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t) + A \\pi^3 \\cos(\\pi x)\\sin(\\pi y)\\cos(\\omega t) = -2 \\pi^2 v$\n    所以，$-\\nu \\nabla^2 \\mathbf{u} = 2\\nu\\pi^2\\mathbf{u}$。\n\n4.  **压力梯度，$\\nabla p$**：\n    $$\n    \\frac{\\partial p}{\\partial x} = -B \\pi \\sin(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n    $$\n    $$\n    \\frac{\\partial p}{\\partial y} = B \\pi \\cos(\\pi x)\\cos(\\pi y)\\sin(\\omega t)\n    $$\n\n结合这些项，得到体积力 $\\mathbf{f}=(f_x, f_y)$ 的分量：\n$$\nf_x = -A \\pi \\omega \\cos(\\pi y)\\sin(\\pi x)\\sin(\\omega t) + \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi x)\\cos^2(\\omega t) + 2\\nu\\pi^2 u - B \\pi \\sin(\\pi x)\\sin(\\pi y)\\sin(\\omega t)\n$$\n$$\nf_y = A \\pi \\omega \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t) + \\frac{1}{2} A^2 \\pi^3 \\sin(2\\pi y)\\cos^2(\\omega t) + 2\\nu\\pi^2 v + B \\pi \\cos(\\pi x)\\cos(\\pi y)\\sin(\\omega t)\n$$\n\n**任务3：推导压力诺伊曼边界条件**\n\n最后的任务是推导压力泊松方程的诺伊曼边界数据 $g(x,t)$，使得在底边界 $y=0$ 上有 $\\frac{\\partial p}{\\partial n} = g(x,t)$。该边界上的外单位法向量为 $\\mathbf{n} = (0,-1)$。\n\n投影法中压力的诺伊曼条件是通过在边界上施加动量平衡的法向分量来推导的。然而，在此MMS问题中，由于我们已知精确的压力场，推导变得更为直接。边界数据 $g(x,t)$ 可以通过直接计算给定压力场在边界上的法向导数得到。\n$$\ng(x,t) = \\frac{\\partial p}{\\partial n}\\bigg|_{y=0} = \\nabla p(x,0,t) \\cdot \\mathbf{n}\n$$\n当 $\\mathbf{n}=(0,-1)$ 时，我们有：\n$$\ng(x,t) = \\left( \\frac{\\partial p}{\\partial x}, \\frac{\\partial p}{\\partial y} \\right)\\bigg|_{y=0} \\cdot (0,-1) = - \\frac{\\partial p}{\\partial y}\\bigg|_{y=0}\n$$\n我们现在计算 $p$ 关于 $y$ 的偏导数，并在 $y=0$ 处求值。\n$$\n\\frac{\\partial p}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( B \\cos(\\pi x)\\sin(\\pi y)\\sin(\\omega t) \\right) = B \\pi \\cos(\\pi x)\\cos(\\pi y)\\sin(\\omega t)\n$$\n在 $y=0$ 处对该表达式求值：\n$$\n\\frac{\\partial p}{\\partial y}\\bigg|_{y=0} = B \\pi \\cos(\\pi x)\\cos(0)\\sin(\\omega t) = B \\pi \\cos(\\pi x)\\sin(\\omega t)\n$$\n最后，诺伊曼边界数据 $g(x,t)$ 是此结果的负值：\n$$\ng(x,t) = - B \\pi \\cos(\\pi x)\\sin(\\omega t)\n$$\n在数值模拟中，为了匹配精确的人造解，必须将此函数规定为 $y=0$ 边界上压力的诺伊曼边界条件。",
            "answer": "$$\\boxed{-B \\pi \\cos(\\pi x)\\sin(\\omega t)}$$"
        }
    ]
}