{
    "hands_on_practices": [
        {
            "introduction": "在比较计算流体动力学（CFD）模拟与实验结果时，使用标准化的无量纲参数至关重要。压力系数 $C_p$ 就是这样一个核心参数，它能够消除绝对压力值的任意性，并使不同尺度和流速下的结果具有可比性。本练习将指导您从基本的纳维-斯托克斯方程出发，推导压力系数的定义，并探讨选择参考压力的重要性，这是确保结果具有物理意义和可比性的关键一步 。",
            "id": "3294307",
            "problem": "考虑一个典型的二维后台阶流动，流体为不可压缩流体，其密度 $\\rho$ 和动力粘度 $\\mu$ 恒定。上游通道的高度为 $H_1$，台阶高度为 $h$，下游通道的高度为 $H_2 = H_1 + h$。流入流场为充分发展的内部流动，其平均流速 $U_b$ 是相对于上游通道横截面定义的。您需要构建一个无量纲的壁面压力系数，该系数适用于模拟和实验之间的严格比较，然后针对一个特定的数据点进行评估。\n\n从无体力项的不可压缩流体连续性方程和动量方程出发，使用 $h$ 作为特征长度，$U_b$ 作为特征速度，进行无量纲化，从而得到一个无量纲压力变量。该变量的梯度在无量纲动量方程中以一种不依赖于任何附加压力常数的形式出现。利用此变量定义一个基于壁面参考和平均流速的压力系数 $C_p$，该系数可在不同数据集之间直接比较。并用有量纲的壁面静压 $p_w(x)$（在流向位置 $x$ 处）、一个恒定的参考压力 $p_{\\mathrm{ref}}$、密度 $\\rho$ 和平均流速 $U_b$ 来明确地写出它的表达式。基于控制方程对压力偏移的不变性，解释为什么 $p_{\\mathrm{ref}}$ 可以在一个常数范围内任意选择，但为了进行比较必须保持一致固定。并为确保跨设备的一致性，提出一个有原则的 $p_{\\mathrm{ref}}$ 选择方案。在您提出的选择下，提供 $C_p(x)$ 相应的显式表达式。\n\n最后，对于空气流动，其 $\\rho = 1.20\\,\\mathrm{kg/m^3}$，上游平均流速 $U_b = 10.0\\,\\mathrm{m/s}$，假设您采用一个上游平面 $x_u$ 处的面积平均静压作为参考，该平面位于台阶上游足够远的位置，使得 $x_u/h = -8$，其测量值为 $\\bar{p}(x_u) = 100325\\,\\mathrm{Pa}$。在下游一个壁面位置 $x$ 处，其中 $x/h = 6$，时间平均壁面静压的测量值为 $p_w(x) = 100290\\,\\mathrm{Pa}$。使用您定义的 $C_p$，计算在 $x/h = 6$ 处的 $C_p(x)$。将您的答案四舍五入到四位有效数字。以无量纲数的形式表达您的答案。",
            "solution": "### 推导与定义\n\n分析从无体力项、具有恒定性质的不可压缩流体的控制方程开始。这些是连续性方程和动量方程。其有量纲形式为：\n$$\n\\nabla \\cdot \\mathbf{u} = 0\n$$\n$$\n\\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u} \\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u}\n$$\n其中 $\\mathbf{u}$ 是速度矢量，$t$ 是时间，$p$ 是静压，$\\rho$ 是密度，$\\mu$ 是动力粘度。\n\n为对这些方程进行无量纲化，我们引入用上标 $*$ 表示的无量纲变量。使用台阶高度 $h$ 作为特征长度，上游平均流速 $U_b$ 作为特征速度：\n$$\n\\mathbf{x}^* = \\frac{\\mathbf{x}}{h}, \\quad \\mathbf{u}^* = \\frac{\\mathbf{u}}{U_b}, \\quad t^* = \\frac{t}{h/U_b}\n$$\n将这些代入动量方程并乘以 $\\frac{h}{\\rho U_b^2}$，得到：\n$$\n\\frac{\\partial \\mathbf{u}^*}{\\partial t^*} + \\mathbf{u}^* \\cdot \\nabla^* \\mathbf{u}^* = -\\frac{1}{\\rho U_b^2} \\nabla^* p + \\frac{\\mu}{\\rho U_b h} \\nabla^{*2} \\mathbf{u}^*\n$$\n在不可压缩流中，只有压力梯度 $\\nabla p$ 影响动力学。为创建一个定义明确的无量纲压力，我们必须减去一个恒定的参考压力 $p_{\\mathrm{ref}}$。我们定义无量纲压力变量 $P$ 为：\n$$\nP = \\frac{p - p_{\\mathrm{ref}}}{\\rho U_b^2}\n$$\n其梯度为 $\\nabla^*p = \\rho U_b^2 \\nabla^*P$。代入后，得到的无量纲动量方程为：\n$$\n\\frac{\\partial \\mathbf{u}^*}{\\partial t^*} + \\mathbf{u}^* \\cdot \\nabla^* \\mathbf{u}^* = -\\nabla^* P + \\frac{1}{Re_h} \\nabla^{*2} \\mathbf{u}^*\n$$\n这种形式满足了要求，因为梯度是直接作用于无量纲变量 $P$ 的。\n\n按照惯例，压力系数 $C_p$ 通过动压 $q = \\frac{1}{2}\\rho U^2$ 进行归一化。使用特征速度 $U_b$，动压为 $q_b = \\frac{1}{2}\\rho U_b^2$。因此，用于测量壁面上流向位置 $x$ 处静压 $p_w(x)$ 的压力系数 $C_p(x)$ 定义为：\n$$\nC_p(x) = \\frac{p_w(x) - p_{\\mathrm{ref}}}{\\frac{1}{2} \\rho U_b^2}\n$$\n$p_{\\mathrm{ref}}$ 的选择对于比较不同实验或模拟的结果至关重要。尽管控制方程对任意的压力常数偏移是不变的，但 $C_p$ 的值会随 $p_{\\mathrm{ref}}$ 的改变而平移一个常数。因此，为了使 $C_p$ 成为一个有用的、可比较的度量，$p_{\\mathrm{ref}}$ 必须根据一个一致且物理上合理的惯例来定义。\n\n对于 $p_{\\mathrm{ref}}$，一个有原则的选择是在台阶上游远处某个横截面的面积平均静压，例如在 $x_u$ 处。该位置处于充分发展的流入区域，使得参考压力与台阶引起的分离的具体细节无关。设此参考压力为 $\\bar{p}(x_u)$。采用此惯例，压力系数的显式表达式为：\n$$\nC_p(x) = \\frac{p_w(x) - \\bar{p}(x_u)}{\\frac{1}{2} \\rho U_b^2}\n$$\n\n### 计算\n\n最后，我们根据给定的数据计算此表达式。\n给定的值为：\n- $\\rho = 1.20\\,\\mathrm{kg/m^3}$\n- $U_b = 10.0\\,\\mathrm{m/s}$\n- $p_{\\mathrm{ref}} = \\bar{p}(x_u) = 100325\\,\\mathrm{Pa}$ (在 $x_u/h = -8$ 处)\n- $p_w(x) = 100290\\,\\mathrm{Pa}$ (在 $x/h = 6$ 处)\n\n首先，计算参考动压：\n$$\n\\frac{1}{2}\\rho U_b^2 = \\frac{1}{2} \\times 1.20\\,\\mathrm{kg/m^3} \\times (10.0\\,\\mathrm{m/s})^2 = 0.60 \\times 100\\,\\mathrm{Pa} = 60.0\\,\\mathrm{Pa}\n$$\n接下来，计算壁面测量点与参考平面之间的压力差：\n$$\np_w(x) - p_{\\mathrm{ref}} = 100290\\,\\mathrm{Pa} - 100325\\,\\mathrm{Pa} = -35\\,\\mathrm{Pa}\n$$\n现在，计算压力系数：\n$$\nC_p(x) = \\frac{-35\\,\\mathrm{Pa}}{60.0\\,\\mathrm{Pa}} = -0.583333...\n$$\n按要求将结果四舍五入到四位有效数字，得到 $-0.5833$。",
            "answer": "$$\\boxed{-0.5833}$$"
        },
        {
            "introduction": "对于采用显式时间推进格式的非定常流动模拟，数值稳定性是一个首要的实践问题。虽然显式格式在概念上较为简单，但其稳定性受到时间步长 $\\Delta t$ 的严格限制，这个限制同时来自于对流（由流体速度决定）和扩散（由粘性和网格尺寸决定）。本练习提供了一个确定最大稳定时间步长的实践机会，您需要在一个包含不同流速和网格尺寸的典型后台阶流动区域中，平衡计算效率与数值稳定性 。",
            "id": "3294285",
            "problem": "考虑一个不可压缩的平面后台阶流，采用显式前向欧拉有限体积格式进行时间推进，其中对流项使用一阶迎风数值通量，扩散项在结构化正交网格上使用二阶中心差分。流体的运动粘度为 $\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^2/s}$。网格是非均匀的，由于剪切层和回流，局部解析的最大速度因不同子区域而异。为确保动量线性化对流-扩散输运方程显式更新的稳定性和单调性，时间步长 $\\Delta t$ 的选择必须保证在每个控制体积中，Courant–Friedrichs–Lewy (CFL) 条件（针对对流）和扩散数条件（针对扩散）都不超过规定的阈值。\n\n网格以及速度分量局部最大值的保守估计总结在四个不相交的子区域中，这些子区域共同覆盖了整个计算域：\n\n- 子区域 A (紧邻台阶下游的剪切层)：$\\Delta x = 2.5 \\times 10^{-4}\\,\\mathrm{m}$，$\\Delta y = 1.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\max|u| = 3.0\\,\\mathrm{m/s}$，$\\max|v| = 0.60\\,\\mathrm{m/s}$。\n- 子区域 B (下游近壁区)：$\\Delta x = 2.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\Delta y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$，$\\max|u| = 1.50\\,\\mathrm{m/s}$，$\\max|v| = 0.15\\,\\mathrm{m/s}$。\n- 子区域 C (回流核心区)：$\\Delta x = 5.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\Delta y = 3.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\max|u| = 0.80\\,\\mathrm{m/s}$，$\\max|v| = 0.40\\,\\mathrm{m/s}$。\n- 子区域 D (出口区)：$\\Delta x = 1.0 \\times 10^{-3}\\,\\mathrm{m}$，$\\Delta y = 5.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\max|u| = 2.50\\,\\mathrm{m/s}$，$\\max|v| = 0.050\\,\\mathrm{m/s}$。\n\n根据上述离散化的线性化对流和扩散的显式时间推进稳定性的第一性原理，确定最大的均匀时间步长 $\\Delta t_{\\max}$，以保证在每个子区域中，局部对流 Courant–Friedrichs–Lewy 数不超过 $0.50$，局部扩散数不超过 $0.25$。陈述您推导的任何中间表达式，并通过考虑所有子区域来评估 $\\Delta t_{\\max}$。将您的最终答案四舍五入到四位有效数字，并以秒为单位表示。",
            "solution": "为了确定最大允许的均匀时间步长 $\\Delta t_{\\max}$，我们必须在所有四个子区域的每个计算单元中同时满足对流和扩散的稳定性约束。全局时间步长不得大于由每个局部约束施加的时间步长限制中的最小值。\n\n应用于二维线性化对流-扩散方程的前向欧拉时间步进格式的稳定性准则分别由对流（Courant–Friedrichs–Lewy 或 CFL 条件）和扩散（扩散数条件）给出。\n\n对于结构化网格上的一阶迎风对流格式，CFL 条件基于每个坐标方向上 CFL 数的总和：\n$$\nC = C_x + C_y = \\frac{|u|\\Delta t}{\\Delta x} + \\frac{|v|\\Delta t}{\\Delta y} = \\left(\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y}\\right) \\Delta t \\le C_{\\max}\n$$\n问题指定最大 CFL 数为 $C_{\\max} = 0.50$。这给出了一个对流时间步长约束：\n$$\n\\Delta t_{adv} \\le \\frac{C_{\\max}}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y}} = \\frac{0.50}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y}}\n$$\n对于二阶中心差分扩散格式，稳定性条件基于每个坐标方向上扩散数的总和：\n$$\nd = d_x + d_y = \\frac{\\nu \\Delta t}{(\\Delta x)^2} + \\frac{\\nu \\Delta t}{(\\Delta y)^2} = \\nu \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right) \\Delta t \\le d_{\\max}\n$$\n问题指定最大扩散数为 $d_{\\max} = 0.25$。这给出了一个扩散时间步长约束：\n$$\n\\Delta t_{diff} \\le \\frac{d_{\\max}}{\\nu \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right)} = \\frac{0.25}{\\nu \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right)}\n$$\n现在我们必须对每个子区域评估这些约束，使用运动粘度 $\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^2/s}$ 和提供的局部网格尺寸以及最大速度分量。\n\n**子区域 A (剪切层):**\n$\\Delta x_A = 2.5 \\times 10^{-4}\\,\\mathrm{m}$，$\\Delta y_A = 1.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\max|u| = 3.0\\,\\mathrm{m/s}$，$\\max|v| = 0.60\\,\\mathrm{m/s}$。\n$$\n\\Delta t_{adv, A} \\le \\frac{0.50}{\\frac{3.0}{2.5 \\times 10^{-4}} + \\frac{0.60}{1.0 \\times 10^{-4}}} = \\frac{0.50}{12000 + 6000} = \\frac{0.50}{18000} \\approx 2.778 \\times 10^{-5}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{diff, A} \\le \\frac{0.25}{(1.0 \\times 10^{-6}) \\left(\\frac{1}{(2.5 \\times 10^{-4})^2} + \\frac{1}{(1.0 \\times 10^{-4})^2}\\right)} = \\frac{0.25}{(1.0 \\times 10^{-6}) (1.6 \\times 10^{7} + 1.0 \\times 10^{8})} \\approx 2.155 \\times 10^{-3}\\,\\mathrm{s}\n$$\n子区域 A 的最大允许时间步长为 $\\Delta t_A = \\min(\\Delta t_{adv, A}, \\Delta t_{diff, A}) \\approx 2.778 \\times 10^{-5}\\,\\mathrm{s}$。\n\n**子区域 B (近壁区):**\n$\\Delta x_B = 2.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\Delta y_B = 5.0 \\times 10^{-5}\\,\\mathrm{m}$，$\\max|u| = 1.50\\,\\mathrm{m/s}$，$\\max|v| = 0.15\\,\\mathrm{m/s}$。\n$$\n\\Delta t_{adv, B} \\le \\frac{0.50}{\\frac{1.50}{2.0 \\times 10^{-4}} + \\frac{0.15}{5.0 \\times 10^{-5}}} = \\frac{0.50}{7500 + 3000} = \\frac{0.50}{10500} \\approx 4.762 \\times 10^{-5}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{diff, B} \\le \\frac{0.25}{(1.0 \\times 10^{-6}) \\left(\\frac{1}{(2.0 \\times 10^{-4})^2} + \\frac{1}{(5.0 \\times 10^{-5})^2}\\right)} = \\frac{0.25}{(1.0 \\times 10^{-6}) (2.5 \\times 10^{7} + 4.0 \\times 10^{8})} \\approx 5.882 \\times 10^{-4}\\,\\mathrm{s}\n$$\n子区域 B 的最大允许时间步长为 $\\Delta t_B = \\min(\\Delta t_{adv, B}, \\Delta t_{diff, B}) \\approx 4.762 \\times 10^{-5}\\,\\mathrm{s}$。\n\n**子区域 C (回流核心区):**\n$\\Delta x_C = 5.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\Delta y_C = 3.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\max|u| = 0.80\\,\\mathrm{m/s}$，$\\max|v| = 0.40\\,\\mathrm{m/s}$。\n$$\n\\Delta t_{adv, C} \\le \\frac{0.50}{\\frac{0.80}{5.0 \\times 10^{-4}} + \\frac{0.40}{3.0 \\times 10^{-4}}} = \\frac{0.50}{1600 + 1333.33...} \\approx 1.705 \\times 10^{-4}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{diff, C} \\le \\frac{0.25}{(1.0 \\times 10^{-6}) \\left(\\frac{1}{(5.0 \\times 10^{-4})^2} + \\frac{1}{(3.0 \\times 10^{-4})^2}\\right)} = \\frac{0.25}{(1.0 \\times 10^{-6}) (4.0 \\times 10^{6} + 1.111... \\times 10^{7})} \\approx 1.654 \\times 10^{-2}\\,\\mathrm{s}\n$$\n子区域 C 的最大允许时间步长为 $\\Delta t_C = \\min(\\Delta t_{adv, C}, \\Delta t_{diff, C}) \\approx 1.705 \\times 10^{-4}\\,\\mathrm{s}$。\n\n**子区域 D (出口区):**\n$\\Delta x_D = 1.0 \\times 10^{-3}\\,\\mathrm{m}$，$\\Delta y_D = 5.0 \\times 10^{-4}\\,\\mathrm{m}$，$\\max|u| = 2.50\\,\\mathrm{m/s}$，$\\max|v| = 0.050\\,\\mathrm{m/s}$。\n$$\n\\Delta t_{adv, D} \\le \\frac{0.50}{\\frac{2.50}{1.0 \\times 10^{-3}} + \\frac{0.050}{5.0 \\times 10^{-4}}} = \\frac{0.50}{2500 + 100} = \\frac{0.50}{2600} \\approx 1.923 \\times 10^{-4}\\,\\mathrm{s}\n$$\n$$\n\\Delta t_{diff, D} \\le \\frac{0.25}{(1.0 \\times 10^{-6}) \\left(\\frac{1}{(1.0 \\times 10^{-3})^2} + \\frac{1}{(5.0 \\times 10^{-4})^2}\\right)} = \\frac{0.25}{(1.0 \\times 10^{-6}) (1.0 \\times 10^{6} + 4.0 \\times 10^{6})} = 5.0 \\times 10^{-2}\\,\\mathrm{s}\n$$\n子区域 D 的最大允许时间步长为 $\\Delta t_D = \\min(\\Delta t_{adv, D}, \\Delta t_{diff, D}) \\approx 1.923 \\times 10^{-4}\\,\\mathrm{s}$。\n\n为确保在整个计算域内的稳定性，均匀时间步长 $\\Delta t$ 必须小于或等于所有子区域中最大允许时间步长的最小值。\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_A, \\Delta t_B, \\Delta t_C, \\Delta t_D)\n$$\n比较每个子区域的最大允许时间步长：\n$\\Delta t_A \\approx 2.778 \\times 10^{-5}\\,\\mathrm{s}$\n$\\Delta t_B \\approx 4.762 \\times 10^{-5}\\,\\mathrm{s}$\n$\\Delta t_C \\approx 1.705 \\times 10^{-4}\\,\\mathrm{s}$\n$\\Delta t_D \\approx 1.923 \\times 10^{-4}\\,\\mathrm{s}$\n\n这些值中的最小值是 $\\Delta t_A$，它由剪切层中的对流约束决定。\n$$\n\\Delta t_{\\max} = \\frac{0.50}{18000}\\,\\mathrm{s} = \\frac{1}{36000}\\,\\mathrm{s}\n$$\n数值计算结果为：\n$$\n\\Delta t_{\\max} = 0.000027777... \\,\\mathrm{s} = 2.7777... \\times 10^{-5}\\,\\mathrm{s}\n$$\n根据题目要求，四舍五入到四位有效数字，我们得到：\n$$\n\\Delta t_{\\max} = 2.778 \\times 10^{-5}\\,\\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{2.778 \\times 10^{-5}}\n$$"
        },
        {
            "introduction": "获得一个数值稳定的解并不等同于获得一个准确的解。在现代CFD实践中，验证与确认（Verification and Validation, VV）是评估模拟结果可靠性的核心环节。关键步骤包括使用理查森外推法（Richardson extrapolation）来估计与网格无关的“真实”解，并计算网格收敛指数（GCI）来量化数值不确定性。掌握这些技术能让您的模拟从定性的“彩色云图”转变为定量的、具有预测能力的科学工具 。",
            "id": "3294313",
            "problem": "给定后向台阶（Backward-Facing Step, BFS）流中再附着长度的三套网格数值结果，这些结果是通过计算流体力学模拟在连续均匀网格加密下获得的。目标是使用三网格理查森外推法来估计网格无关的再附着长度，并计算细/中网格对的网格收敛指数（GCI）。您的推导和实现必须从主阶离散误差模型开始。该模型指出，在特征间距为 $ h $ 的网格上获得的任何计算量 $ \\phi(h) $ 都满足 $ \\phi(h) = \\phi_\\infty + C h^p $，其中 $ \\phi_\\infty $ 是网格无关值，$ C $ 是一个未知常数，$ p $ 是观测到的精度阶。假设采用均匀加密，使得 $ h_2 = r h_1 $ 和 $ h_3 = r h_2 $，其中加密比 $ r  1 $ 为常数，并假设再附着长度随网格加密单调收敛。\n\n以此为基础，推导出一个实用算法来：\n- 从三套网格数据中推断观测阶 $ p $，\n- 执行三网格理查森外推以估计网格无关再附着长度 $ \\phi_\\infty $，\n- 使用安全因子计算细/中网格对的网格收敛指数（GCI），以及\n- 通过使用细/中和中/粗网格对的 GCI 值进行比率检验，评估解是否处于渐近收敛范围内。\n\n定义和要求：\n- 后向台阶（Backward-Facing Step, BFS）。\n- 网格收敛指数（GCI）：一个与网格分辨率相关的数值不确定性的标准化指标。\n- 使用安全因子 $ F_s = 1.25 $，适用于三网格单调收敛情况。\n- 令 $ \\phi_1 $、$ \\phi_2 $ 和 $ \\phi_3 $ 分别表示在细、中、粗网格上计算的再附着长度。令 $ r $ 表示均匀加密比，定义为 $ r = h_2/h_1 = h_3/h_2 $。\n- 对于渐近范围检验，使用由两对网格 $ (1,2) $ 和 $ (2,3) $ 的 GCI 值定义的比率 $ R_a $，并要求 $ R_a $ 位于 $ [0.95, 1.05] $ 区间内，才将解分类为渐近收敛。\n\n物理单位和输出规范：\n- 再附着长度必须以米为单位表示；以米为单位输出经 Richardson 外推的再附着长度 $ \\phi_\\infty $。四舍五入至 $ 6 $ 位小数。\n- GCI 必须表示为小数形式（无单位），而非百分比；四舍五入至 $ 6 $ 位小数。\n- 观测阶 $ p $ 和加密比 $ r $ 必须以小数值输出；四舍五入至 $ 6 $ 位小数。\n- 渐近范围检验必须以布尔值输出。\n\n测试套件：\n- 情况 $ 1 $：$ r = 2.0 $，$ \\phi_1 = 5.84 \\,\\text{m} $，$ \\phi_2 = 6.02 \\,\\text{m} $，$ \\phi_3 = 6.33 \\,\\text{m} $，$ F_s = 1.25 $。\n- 情况 $ 2 $：$ r = 1.5 $，$ \\phi_1 = 5.95 \\,\\text{m} $，$ \\phi_2 = 6.07 \\,\\text{m} $，$ \\phi_3 = 6.22 \\,\\text{m} $，$ F_s = 1.25 $。\n- 情况 $ 3 $：$ r = 1.1 $，$ \\phi_1 = 6.08 \\,\\text{m} $，$ \\phi_2 = 6.13 \\,\\text{m} $，$ \\phi_3 = 6.185 \\,\\text{m} $，$ F_s = 1.25 $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个测试用例的结果必须是一个内部列表，形式为 $ [p, r, \\phi_\\infty, \\text{GCI}_{12}, \\text{asymptotic}] $，其中 $ p $ 是观测阶，$ r $ 是加密比，$ \\phi_\\infty $ 是经 Richardson 外推的再附着长度（单位：米），$ \\text{GCI}_{12} $ 是细/中网格的网格收敛指数（小数形式），$ \\text{asymptotic} $ 是说明是否满足渐近范围标准的布尔值。例如，总体输出应如下所示：$ [[p_1,r_1,\\phi_{\\infty,1},\\text{GCI}_{12,1},\\text{bool}_1],[p_2,r_2,\\phi_{\\infty,2},\\text{GCI}_{12,2},\\text{bool}_2],[p_3,r_3,\\phi_{\\infty,3},\\text{GCI}_{12,3},\\text{bool}_3]] $。\n\n科学真实性：\n- 确保您的算法强制执行单调收敛条件，并且只处理物理上一致的情况，即 $ (\\phi_3 - \\phi_2) $ 和 $ (\\phi_2 - \\phi_1) $ 符号相同且加密比 $ r $ 大于 $ 1 $。如果单调性不满足，则应标记该情况，并且依赖于此推导的量应设置为“非数字”（not-a-number）以表示失败。\n\n您的程序必须实现上述要求，并将其完全按照规定应用于测试套件。不允许外部输入。",
            "solution": "该问题要求应用标准的网格收敛性分析技术。其核心在于离散误差模型：\n$$ \\phi(h) \\approx \\phi_\\infty + C h^p $$\n其中 $\\phi(h)$ 是在特征网格尺寸为 $h$ 时计算的量，$\\phi_\\infty$ 是网格无关的精确解，$p$ 是精度阶。我们有三套网格的解 $\\phi_1, \\phi_2, \\phi_3$，其特征间距分别为 $h_1, h_2, h_3$，且网格是均匀加密的，加密比 $r = h_2/h_1 = h_3/h_2 > 1$。\n\n在继续之前，我们必须检查单调收敛性，即差值 $(\\phi_2 - \\phi_1)$ 和 $(\\phi_3 - \\phi_2)$ 的符号必须相同。如果此条件不满足，则该方法不适用。\n\n### 1. 观测精度阶 $ p $ 的推导\n我们考虑连续网格上解的差值：\n$$ \\epsilon_{21} = \\phi_2 - \\phi_1 \\approx C h_1^p (r^p - 1) $$\n$$ \\epsilon_{32} = \\phi_3 - \\phi_2 \\approx C h_1^p r^p (r^p - 1) $$\n取这两个差值的比率，得到：\n$$ \\frac{\\epsilon_{32}}{\\epsilon_{21}} = \\frac{\\phi_3 - \\phi_2}{\\phi_2 - \\phi_1} \\approx r^p $$\n解出 $p$：\n$$ p = \\frac{\\ln\\left( \\frac{\\phi_3 - \\phi_2}{\\phi_2 - \\phi_1} \\right)}{\\ln(r)} $$\n\n### 2. Richardson 外推值 $ \\phi_\\infty $ 的推导\n使用两套最细网格的解 $\\phi_1$ 和 $\\phi_2$ 以及已确定的精度阶 $p$，我们可以外推得到网格无关值 $\\phi_\\infty$：\n$$ \\phi_\\infty \\approx \\phi_1 + \\frac{\\phi_1 - \\phi_2}{r^p - 1} $$\n\n### 3. 网格收敛指数 (GCI) 的推导\nGCI 为离散化不确定性提供了一个定量的度量。对于细/中网格对（$1,2$），GCI 定义为：\n$$ \\text{GCI}_{12} = \\frac{F_s}{r^p - 1} \\left| \\frac{\\phi_1 - \\phi_2}{\\phi_1} \\right| $$\n其中安全因子 $F_s = 1.25$。\n\n### 4. 渐近范围检验\n为了评估网格是否足够精细以处于渐近收敛范围，我们比较来自两对网格的GCI。我们计算 $\\text{GCI}_{12}$（细/中）和 $\\text{GCI}_{23}$（中/粗）。$ \\text{GCI}_{23} $ 的公式为：\n$$ \\text{GCI}_{23} = \\frac{F_s}{r^p - 1} \\left| \\frac{\\phi_2 - \\phi_3}{\\phi_2} \\right| $$\n如果解在渐近范围内，比率 $R_a = \\frac{\\text{GCI}_{23}}{r^p \\text{GCI}_{12}}$ 应该接近于1。问题要求我们检查 $R_a$ 是否落在区间 $[0.95, 1.05]$ 内。\n\n以下代码实现了该算法，并应用于每个测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process test cases for grid convergence analysis and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (r, phi1, phi2, phi3, Fs)\n        (2.0, 5.84, 6.02, 6.33, 1.25),\n        (1.5, 5.95, 6.07, 6.22, 1.25),\n        (1.1, 6.08, 6.13, 6.185, 1.25),\n    ]\n\n    results_str_list = []\n    for case in test_cases:\n        r, phi1, phi2, phi3, Fs = case\n        \n        # Check for monotonic convergence.\n        # The differences (phi2-phi1) and (phi3-phi2) must have the same sign.\n        # This implies their product must be positive.\n        # A value of zero indicates non-strict monotonicity but can still cause issues\n        # with the log, so we check for = 0.\n        diff21 = phi2 - phi1\n        diff32 = phi3 - phi2\n        \n        if diff21 * diff32 = 0:\n            # Non-monotonic or oscillatory convergence.\n            # The derivations are not valid in this case.\n            p = np.nan\n            phi_inf = np.nan\n            gci_12 = np.nan\n            asymptotic = False\n        else:\n            # Calculate the observed order of accuracy 'p'\n            # p = ln((phi3-phi2)/(phi2-phi1)) / ln(r)\n            diff_ratio = diff32 / diff21\n            p = np.log(diff_ratio) / np.log(r)\n            \n            # Calculate the Richardson-extrapolated value 'phi_inf'\n            # phi_inf = (r^p * phi1 - phi2) / (r^p - 1)\n            rp = r**p\n            phi_inf = (rp * phi1 - phi2) / (rp - 1)\n            \n            # Calculate the Grid Convergence Index (GCI) for the fine/medium pair (1,2)\n            # GCI_12 = Fs * |(phi1-phi2)/phi1| / (r^p - 1)\n            rel_err_12 = np.abs((phi1 - phi2) / phi1)\n            gci_12 = (Fs * rel_err_12) / (rp - 1)\n            \n            # Asymptotic range check\n            # Compute GCI for the medium/coarse pair (2,3)\n            rel_err_23 = np.abs((phi2 - phi3) / phi2)\n            gci_23 = (Fs * rel_err_23) / (rp - 1)\n            \n            # Compute the ratio R_a = GCI_23 / (r^p * GCI_12)\n            # A check for gci_12 being zero prevents division by zero.\n            if gci_12 == 0:\n                asymptotic = False\n            else:\n                R_a = gci_23 / (rp * gci_12)\n                asymptotic = (0.95 = R_a = 1.05)\n\n        # Format the results for the final output string.\n        p_str = f\"{p:.6f}\" if not np.isnan(p) else \"nan\"\n        r_str = f\"{r:.6f}\"\n        phi_inf_str = f\"{phi_inf:.6f}\" if not np.isnan(phi_inf) else \"nan\"\n        gci_12_str = f\"{gci_12:.6f}\" if not np.isnan(gci_12) else \"nan\"\n        asymptotic_str = str(asymptotic)\n        \n        case_result_str = (\n            f\"[{p_str},{r_str},{phi_inf_str},{gci_12_str},{asymptotic_str}]\"\n        )\n        results_str_list.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str_list)}]\")\n\nsolve()\n```"
        }
    ]
}