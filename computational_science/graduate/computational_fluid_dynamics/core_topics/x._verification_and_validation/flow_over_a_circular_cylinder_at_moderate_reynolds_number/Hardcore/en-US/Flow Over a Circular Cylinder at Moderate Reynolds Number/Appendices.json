{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any accurate Computational Fluid Dynamics (CFD) simulation is a well-designed computational mesh. For wall-bounded flows, resolving the thin boundary layer is critical for correctly predicting skin friction, heat transfer, and flow separation. This practice will guide you through a first-principles scaling analysis to estimate the necessary near-wall grid spacing for a Direct Numerical Simulation (DNS) of flow over a cylinder, connecting fundamental fluid dynamics scales to practical numerical parameters .",
            "id": "3319585",
            "problem": "Consider incompressible, Newtonian flow of a uniform free stream with speed $U_{\\infty}$ over a circular cylinder of diameter $D$ at a moderate Reynolds number $Re=100$, where the Reynolds number is defined by $Re = \\dfrac{U_{\\infty} D}{\\nu}$ and $\\nu$ is the kinematic viscosity. You are tasked with designing a near-wall normal grid spacing for a Direct Numerical Simulation (DNS) within the broader context of Computational Fluid Dynamics (CFD). Use a first-principles scaling argument based on the balance of convection and diffusion in the near-wall region to define a viscous length scale $\\,\\ell_{\\nu} = \\dfrac{\\nu}{U_{\\infty}}\\,$. Starting from the incompressible Navier–Stokes equations and appropriate boundary-layer scaling near the cylinder surface, derive how the expected laminar boundary layer thickness $\\delta$ scales with $Re$ along an $O(D)$ streamwise arc length on the cylinder. Then, using the viscous length scale as the near-wall normal grid spacing requirement (i.e., take the near-wall spacing $\\Delta n_w$ to be $\\Delta n_w \\sim \\ell_{\\nu}$), estimate $\\dfrac{\\Delta n_w}{D}$ at $Re=100$, and relate this choice to the expected number of grid points across the boundary layer thickness via the ratio $\\dfrac{\\delta}{\\ell_{\\nu}}$. Express your final answer as the single dimensionless quantity $\\dfrac{\\Delta n_w}{D}$, with no units. No rounding is necessary.",
            "solution": "The governing equations are the incompressible Navier–Stokes equations,\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^{2}\\boldsymbol{u}, \\qquad \\nabla \\cdot \\boldsymbol{u} = 0,\n$$\nwith $\\boldsymbol{u}$ the velocity field, $p$ the pressure, $\\rho$ the density, and $\\nu$ the kinematic viscosity. Near the solid boundary, where gradients in the wall-normal direction are large, a standard scaling argument for laminar boundary layers balances streamwise convection with wall-normal viscous diffusion. Denote by $s$ a characteristic streamwise arc length along the cylinder surface and by $y$ the wall-normal coordinate. For laminar flow over a body with characteristic streamwise distance $s = O(D)$, the dominant balance in the tangential momentum equation is\n$$\nU_{\\infty} \\frac{\\partial u}{\\partial s} \\sim \\nu \\frac{\\partial^{2} u}{\\partial y^{2}}.\n$$\nRepresenting derivatives by their characteristic scales, with $\\partial/\\partial s \\sim 1/s$ and $\\partial/\\partial y \\sim 1/\\delta$ where $\\delta$ is the boundary layer thickness, we obtain\n$$\nU_{\\infty} \\frac{U_{\\infty}}{s} \\sim \\nu \\frac{U_{\\infty}}{\\delta^{2}} \\quad \\Longrightarrow \\quad \\frac{U_{\\infty}^{2}}{s} \\sim \\nu \\frac{U_{\\infty}}{\\delta^{2}}.\n$$\nCanceling the common factor $U_{\\infty}$ yields\n$$\n\\frac{U_{\\infty}}{s} \\sim \\frac{\\nu}{\\delta^{2}} \\quad \\Longrightarrow \\quad \\delta \\sim \\sqrt{\\frac{\\nu s}{U_{\\infty}}}.\n$$\nFor flow around a cylinder, a representative streamwise distance to develop the boundary layer is $s = O(D)$, so\n$$\n\\delta \\sim \\sqrt{\\frac{\\nu D}{U_{\\infty}}} = \\frac{D}{\\sqrt{Re}},\n$$\nsince $Re = \\dfrac{U_{\\infty} D}{\\nu}$.\n\nTo set the near-wall normal grid spacing, define the viscous length scale by equating a convective time scale $t_{c} \\sim \\dfrac{\\ell}{U_{\\infty}}$ with a diffusive time scale $t_{d} \\sim \\dfrac{\\ell^{2}}{\\nu}$. Setting $t_{c} \\sim t_{d}$ gives $\\ell \\sim \\dfrac{\\nu}{U_{\\infty}}$, which we denote as\n$$\n\\ell_{\\nu} = \\frac{\\nu}{U_{\\infty}}.\n$$\nNormalizing $\\ell_{\\nu}$ by the cylinder diameter $D$ and using the definition of the Reynolds number,\n$$\n\\frac{\\ell_{\\nu}}{D} = \\frac{\\nu/U_{\\infty}}{D} = \\frac{1}{Re}.\n$$\nHence, at $Re=100$,\n$$\n\\frac{\\Delta n_{w}}{D} \\sim \\frac{\\ell_{\\nu}}{D} = \\frac{1}{100}.\n$$\n\nIt is useful to relate this spacing to the expected boundary layer thickness. Using the earlier scaling, the ratio of the boundary layer thickness to the viscous length scale is\n$$\n\\frac{\\delta}{\\ell_{\\nu}} \\sim \\frac{D/\\sqrt{Re}}{D/Re} = \\sqrt{Re}.\n$$\nTherefore, choosing $\\Delta n_{w} \\sim \\ell_{\\nu}$ produces approximately $\\sqrt{Re}$ points across the boundary layer thickness. At $Re=100$, this gives\n$$\n\\frac{\\delta}{\\ell_{\\nu}} \\sim \\sqrt{100} = 10,\n$$\nindicating that a spacing of order $\\ell_{\\nu}$ yields about $10$ points across the boundary layer, which is a reasonable baseline for resolving near-wall gradients in a laminar DNS at this Reynolds number. The requested dimensionless near-wall spacing is thus\n$$\n\\frac{\\Delta n_{w}}{D} = \\frac{1}{100}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{100}}$$"
        },
        {
            "introduction": "For unsteady simulations using explicit time-integration schemes, the choice of time step, $\\Delta t$, is governed not only by accuracy but critically by numerical stability. A time step that is too large can lead to catastrophic failure of the simulation. This exercise provides essential hands-on practice in determining the maximum stable time step by considering the two fundamental physical limits: the advective limit, described by the Courant–Friedrichs–Lewy (CFL) condition, and the diffusive limit, derived from a stability analysis of the viscous terms .",
            "id": "3319645",
            "problem": "Consider unsteady, two-dimensional, incompressible flow over a circular cylinder of diameter $D$ at a moderate Reynolds number $Re = 100$, where $Re \\equiv \\dfrac{\\rho U_{\\infty} D}{\\mu} = \\dfrac{U_{\\infty} D}{\\nu}$, with $\\rho$ the density, $\\mu$ the dynamic viscosity, $\\nu$ the kinematic viscosity, and $U_{\\infty}$ the free-stream speed. The governing equations are the incompressible Navier–Stokes equations. Suppose the flow is advanced in time using an explicit Strong-Stability-Preserving third-order Runge–Kutta (SSP-RK3) method with a second-order central-difference discretization of the viscous term and a high-resolution upwind discretization (e.g., Weighted Essentially Non-Oscillatory (WENO)) for the convective term. The near-body computational mesh is Cartesian and uniform with spacings $\\Delta x = \\Delta y = D/100$ in a band surrounding the cylinder. Take $D = 0.02$ m and $U_{\\infty} = 0.5$ m/s.\n\nStarting from first principles:\n- Use the Courant–Friedrichs–Lewy (CFL) argument that, in an explicit scheme, information carried by convection should not traverse more than a fraction $c$ of a grid cell in one time step to derive a convective time step bound. For this solver and discretization, take the conservative Courant–Friedrichs–Lewy (CFL) number $c = 0.5$.\n- Independently, perform a von Neumann stability analysis of the semi-discrete heat equation obtained by isolating the viscous term, discretized with second-order central differences on a uniform grid and advanced by an explicit forward-Euler substep (as embedded in SSP-RK3), to obtain a viscous time step bound on a two-dimensional grid in terms of $\\nu$, $\\Delta x$, and $\\Delta y$.\n\nFor the given $Re = 100$, first compute $\\nu$ from its definition. Then, evaluate numerically both the convective and viscous time step bounds using the provided data and identify the more restrictive constraint. Report the final stable time step $\\Delta t_{\\text{stable}}$ as the minimum of the two bounds. Express your answer in seconds and round to four significant figures.",
            "solution": "The physical starting point is the incompressible Navier–Stokes equations,\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla \\boldsymbol{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^{2}\\boldsymbol{u}, \\qquad \\nabla\\cdot\\boldsymbol{u} = 0,\n$$\nwith free-stream speed $U_{\\infty}$ and cylinder diameter $D$ defining the Reynolds number $Re = \\dfrac{U_{\\infty} D}{\\nu}$. We are to determine a stable explicit time step accounting for both convection and diffusion.\n\nStep 1: Compute the kinematic viscosity from the Reynolds number definition. Solving $Re = \\dfrac{U_{\\infty} D}{\\nu}$ for $\\nu$ gives\n$$\n\\nu = \\frac{U_{\\infty} D}{Re}.\n$$\nWith $U_{\\infty} = 0.5$ m/s, $D = 0.02$ m, and $Re = 100$, we obtain\n$$\n\\nu = \\frac{0.5 \\times 0.02}{100} = 0.0001 \\text{ m}^{2}\\!/\\text{s} = 1.0\\times 10^{-4} \\text{ m}^{2}\\!/\\text{s}.\n$$\n\nStep 2: Derive the convective time step bound from the Courant–Friedrichs–Lewy (CFL) argument. The CFL principle requires that, over a single time step, advective transport should not cross more than a fraction $c$ of a cell:\n$$\n\\frac{U_{\\infty}\\,\\Delta t}{\\Delta x} \\le c \\quad \\Longrightarrow \\quad \\Delta t_{\\text{conv}} \\le \\frac{c\\,\\Delta x}{U_{\\infty}}.\n$$\nHere, $\\Delta x = \\Delta y = D/100$, so\n$$\n\\Delta x = \\frac{D}{100} = \\frac{0.02}{100} = 2.0\\times 10^{-4} \\text{ m}.\n$$\nWith $c = 0.5$ and $U_{\\infty} = 0.5$ m/s, the convective bound evaluates to\n$$\n\\Delta t_{\\text{conv}} = \\frac{0.5 \\times 2.0\\times 10^{-4}}{0.5} = 2.0\\times 10^{-4} \\text{ s}.\n$$\n\nStep 3: Derive the viscous time step bound via von Neumann analysis of the discrete heat equation. Consider the scalar heat equation $u_{t} = \\nu\\left(u_{xx} + u_{yy}\\right)$ discretized with second-order central differences on a uniform two-dimensional grid with spacings $\\Delta x$ and $\\Delta y$. The semi-discrete spatial operator has Fourier eigenvalues\n$$\n\\lambda(\\kappa_{x},\\kappa_{y}) = -\\nu\\left[\\frac{4}{\\Delta x^{2}}\\sin^{2}\\!\\left(\\frac{\\kappa_{x}\\Delta x}{2}\\right) + \\frac{4}{\\Delta y^{2}}\\sin^{2}\\!\\left(\\frac{\\kappa_{y}\\Delta y}{2}\\right)\\right].\n$$\nThe most restrictive (most negative) eigenvalue magnitude occurs at the highest resolvable wavenumbers, $\\kappa_{x}\\Delta x = \\pi$ and $\\kappa_{y}\\Delta y = \\pi$, yielding\n$$\n\\lambda_{\\min} = -\\nu\\left(\\frac{4}{\\Delta x^{2}} + \\frac{4}{\\Delta y^{2}}\\right).\n$$\nFor an explicit forward-Euler step applied to $y^{\\prime} = \\lambda y$ with real $\\lambda \\le 0$, stability requires $|1 + \\lambda \\Delta t| \\le 1$, which reduces to $-2 \\le \\lambda \\Delta t \\le 0$ and thus $\\Delta t \\le \\dfrac{2}{|\\lambda_{\\min}|}$. Applying this to the discrete heat operator gives\n$$\n\\Delta t_{\\nu} \\le \\frac{2}{\\nu\\left(\\frac{4}{\\Delta x^{2}} + \\frac{4}{\\Delta y^{2}}\\right)} \\;=\\; \\frac{1}{2\\nu\\left(\\frac{1}{\\Delta x^{2}} + \\frac{1}{\\Delta y^{2}}\\right)}.\n$$\nThe Strong-Stability-Preserving third-order Runge–Kutta (SSP-RK3) method preserves the forward-Euler stability bound for monotone spatial discretizations, so this viscous constraint remains a conservative sufficient condition for stability for the explicit viscous update embedded in SSP-RK3.\n\nFor the given mesh with $\\Delta x = \\Delta y$, this simplifies to\n$$\n\\Delta t_{\\nu} \\le \\frac{\\Delta x^{2}}{4\\nu}.\n$$\nSubstituting $\\Delta x = 2.0\\times 10^{-4}$ m and $\\nu = 1.0\\times 10^{-4}$ m$^{2}$/s,\n$$\n\\Delta t_{\\nu} = \\frac{(2.0\\times 10^{-4})^{2}}{4 \\times 1.0\\times 10^{-4}} = \\frac{4.0\\times 10^{-8}}{4.0\\times 10^{-4}} = 1.0\\times 10^{-4} \\text{ s}.\n$$\n\nStep 4: Select the stable time step as the more restrictive bound. We have\n$$\n\\Delta t_{\\text{conv}} = 2.0\\times 10^{-4} \\text{ s}, \\qquad \\Delta t_{\\nu} = 1.0\\times 10^{-4} \\text{ s}.\n$$\nTherefore,\n$$\n\\Delta t_{\\text{stable}} = \\min\\left(\\Delta t_{\\text{conv}}, \\Delta t_{\\nu}\\right) = 1.0\\times 10^{-4} \\text{ s}.\n$$\n\nInterpretation and additional discussion of viscous constraints at $Re = 100$: At this moderate Reynolds number, the boundary layer thickness around the cylinder scales as $\\delta \\sim D/\\sqrt{Re} \\approx D/10$. Accurately resolving the near-wall gradients typically requires grid spacings normal to the wall $\\Delta n \\ll \\delta$, which can be substantially smaller than the tangential spacing. Because the viscous stability condition depends on $\\Delta n$ through the term $\\left(1/\\Delta x^{2} + 1/\\Delta y^{2}\\right)$, the smallest local spacing (often the wall-normal spacing) controls the global explicit time step via $\\Delta t_{\\nu} \\propto \\Delta_{\\min}^{2}/\\nu$. Thus, even when the convective CFL would allow a larger step, the viscous constraint can dominate at $Re = 100$ on finely clustered near-wall meshes. In the present case with $\\Delta x = \\Delta y = D/100$, the viscous constraint is indeed more restrictive and sets the stable time step.\n\nNumerical value and rounding: The final stable time step is $\\Delta t_{\\text{stable}} = 1.0\\times 10^{-4}$ s. Rounded to four significant figures, this is $1.000\\times 10^{-4}$ s.",
            "answer": "$$\\boxed{1.000 \\times 10^{-4}}$$"
        },
        {
            "introduction": "While direct simulation provides high-fidelity data, its computational cost can be prohibitive for exploring wide parameter spaces, such as in flow control applications. This advanced practice introduces the concept of a reduced-order model (ROM) to efficiently study the complex phenomenon of frequency lock-in for an oscillating cylinder. You will implement a van der Pol oscillator, a classic surrogate for wake dynamics, to map the lock-in region, gaining insight into the powerful techniques used to model and analyze fluid-structure interactions .",
            "id": "3319624",
            "problem": "You are tasked with constructing a principled, computationally efficient surrogate for an Arbitrary Lagrangian-Eulerian (ALE) moving-mesh simulation of a two-dimensional incompressible flow over a circular cylinder undergoing a prescribed transverse harmonic oscillation. The goal is to algorithmically map the lock-in region in the plane of amplitude and frequency ratios for moderate Reynolds number.\n\nThe physical setting is as follows. Consider a circular cylinder of diameter $D$ in a uniform free stream of speed $U_{\\infty}$ at Reynolds number $Re=200$, where $Re=\\rho U_{\\infty} D/\\mu$ with fluid density $\\rho$ and dynamic viscosity $\\mu$. The cylinder is forced to oscillate transversely according to $y(t)=A\\sin(2\\pi f t)$, where $A$ is the peak-to-peak amplitude divided by $2$, and $f$ is the forcing frequency. The natural vortex shedding frequency for a fixed cylinder is $f_s = St \\, U_{\\infty}/D$, where the Strouhal number $St$ for $Re=200$ is taken to be $St = 0.2$. You are to work in non-dimensional convective units based on $D$ and $U_{\\infty}$, that is, non-dimensional time is $t^{*} = t\\,U_{\\infty}/D$, non-dimensional transverse displacement is $y^{*} = y/D$, and all frequencies expressed as cycles per non-dimensional time unit (that is, per $t^{*}$) are $f^{*} = f \\, D/U_{\\infty}$. In these units the natural shedding frequency is $f_s^{*}=St$ and the corresponding angular frequency is $\\omega_s = 2\\pi St$.\n\nDirectly solving the full Navier–Stokes equations in an Arbitrary Lagrangian-Eulerian frame for this problem is computationally expensive. Instead, assume that the dominant unsteady lift dynamics can be represented by a single-degree-of-freedom nonlinear global-mode oscillator of van der Pol type, which is a widely used surrogate model for wake instability. Specifically, model the fluctuating lift coefficient $C_L(t^{*})$ by the differential equation\n$$\n\\frac{d^2 C_L}{dt^{*2}} + \\varepsilon\\left(C_L^2-1\\right)\\frac{d C_L}{dt^{*}} + \\omega_s^2 C_L = K \\, \\frac{d^2 y^{*}}{dt^{*2}},\n$$\nwhere $\\varepsilon > 0$ is the nonlinearity parameter controlling the self-excited limit cycle in the absence of forcing, $K > 0$ is a coupling coefficient that represents the effect of body acceleration on the wake dynamics, and $\\omega_s=2\\pi St$ is the natural angular frequency of the global mode. The prescribed transverse oscillation is $y^{*}(t^{*}) = (A/D)\\,\\sin(2\\pi f^{*} t^{*})$, where $A/D$ is the non-dimensional amplitude and $f^{*}=(f/f_s)\\,St$ is the non-dimensional forcing frequency. The transverse acceleration forcing term is therefore\n$$\n\\frac{d^2 y^{*}}{dt^{*2}} = -\\left(\\frac{A}{D}\\right) \\left(2\\pi f^{*}\\right)^2 \\sin\\left(2\\pi f^{*} t^{*}\\right).\n$$\n\nYour program must implement the following steps from first principles:\n\n1. Start from the fundamental conservation laws of mass and momentum for incompressible flow to justify the existence of a global instability mode leading to periodic vortex shedding past a fixed cylinder at $Re=200$. Use the Strouhal relation $f_s = St \\, U_{\\infty}/D$ with $St=0.2$ to define the natural shedding frequency in convective units.\n\n2. Motivate and adopt the reduced-order van der Pol oscillator surrogate for the fluctuating lift coefficient $C_L(t^{*})$ driven by the imposed transverse acceleration of the body. The oscillator must be integrated in non-dimensional time $t^{*}$ with parameters $\\varepsilon$ and $K$ chosen to represent a moderately supercritical wake at $Re=200$.\n\n3. For each test case below, integrate the forced oscillator from $t^{*}=0$ to $t^{*}=T_{\\mathrm{end}}$, discard an initial transient interval, and determine whether frequency lock-in occurs. Define frequency lock-in as follows: compute the one-sided discrete Fourier transform of $C_L(t^{*})$ over the analysis window and denote by $f_{\\max}$ the frequency (in cycles per non-dimensional time unit) at which the spectral magnitude is maximal. Let $f_f^{*}$ be the forcing frequency and $f_s^{*}=St$ the natural shedding frequency. Declare that lock-in occurs if and only if both conditions hold:\n   - The dominant frequency satisfies $\\left|f_{\\max} - f_f^{*}\\right|/f_f^{*} \\le 0.05$.\n   - The spectral power in a narrow band of width $\\Delta f$ centered at $f_f^{*}$ is at least $1.5$ times the spectral power in a band of the same width centered at $f_s^{*}$.\n\n   For numerical robustness, use a Hann window before performing the Fourier transform, remove the mean from $C_L(t^{*})$, choose a uniform sampling with constant time step $\\Delta t^{*}$, and take $\\Delta f$ equal to the single-bin frequency resolution of the analysis window. Use $T_{\\mathrm{end}}=400$, discard the first half as transient, and analyze the second half.\n\n4. Use the following numerical parameter values in convective units unless otherwise stated: $St=0.2$, $\\omega_s=2\\pi St$, $\\varepsilon=0.3$, $K=10$, $T_{\\mathrm{end}}=400$, and a uniform sampling time step $\\Delta t^{*}=0.02$. Initialize the oscillator with $C_L(0)=10^{-2}$ and $d C_L/dt^{*}(0)=0$.\n\nYour program must evaluate the lock-in criterion for the following test suite of amplitude and frequency-ratio pairs, each specified as $\\left(A/D,\\; f/f_s\\right)$:\n\n- Case $1$: $\\left(0.05,\\; 0.70\\right)$\n- Case $2$: $\\left(0.20,\\; 0.95\\right)$\n- Case $3$: $\\left(0.10,\\; 1.15\\right)$\n- Case $4$: $\\left(0.02,\\; 0.95\\right)$\n- Case $5$: $\\left(0.30,\\; 0.85\\right)$\n- Case $6$: $\\left(0.15,\\; 0.50\\right)$\n\nAll quantities in this problem are non-dimensional. There are no physical units to report. For each case, the output must be a boolean indicating whether lock-in occurs under the above definition.\n\nFinal output specification: Your program should produce a single line of output containing the boolean results for the six cases in order, formatted as a comma-separated list enclosed in square brackets, for example, $[True,False,True,False,False,True]$.",
            "solution": "We begin from the incompressible Navier–Stokes equations in conservation form for velocity $\\mathbf{u}(\\mathbf{x},t)$ and pressure $p(\\mathbf{x},t)$:\n$$\n\\nabla\\cdot \\mathbf{u} = 0, \\qquad\n\\frac{\\partial \\mathbf{u}}{\\partial t} + (\\mathbf{u}\\cdot\\nabla)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^2 \\mathbf{u},\n$$\nwith kinematic viscosity $\\nu=\\mu/\\rho$. For uniform inflow past a circular cylinder at $Re=\\rho U_{\\infty} D/\\mu = 200$, the steady symmetric base flow becomes globally unstable to an antisymmetric mode that generates periodic vortex shedding. Extensive experiments and simulations have established a near-linear Strouhal relation $St = f_s D/U_{\\infty}$ with $St \\approx 0.2$ at $Re=200$, which we adopt as a well-tested fact. In convective non-dimensionalization using $D$ and $U_{\\infty}$, the natural shedding frequency is $f_s^{*}=St=0.2$ and the corresponding angular frequency is $\\omega_s = 2\\pi St$.\n\nWhen the cylinder undergoes a prescribed transverse oscillation $y(t)=A\\sin(2\\pi f t)$, the instantaneous body acceleration drives the near-wake through unsteady boundary conditions in an Arbitrary Lagrangian-Eulerian (ALE) setting. Rather than moving a computational mesh, we seek a reduced-order surrogate that captures the core physics of global wake oscillation and its entrainment by external forcing. A widely used and well-supported approach is to represent the fluctuating lift coefficient $C_L(t^{*})$ as a self-excited nonlinear oscillator of van der Pol type, whose limit cycle corresponds to the saturated global mode of the wake. The canonical forced van der Pol equation in our non-dimensional convective time $t^{*}$ is\n$$\n\\frac{d^2 C_L}{dt^{*2}} + \\varepsilon\\left(C_L^2-1\\right)\\frac{d C_L}{dt^{*}} + \\omega_s^2 C_L = F(t^{*}),\n$$\nwhere $\\varepsilon > 0$ controls the nonlinearity and saturation of the limit cycle, and $F(t^{*})$ represents external forcing. In the context of a prescribed cylinder transverse motion $y^{*}(t^{*}) = y(t)/D$, the dominant inertial forcing on the wake scales with the cylinder’s transverse acceleration. Therefore, we set\n$$\nF(t^{*}) = K\\,\\frac{d^2 y^{*}}{dt^{*2}}, \\quad y^{*}(t^{*}) = \\left(\\frac{A}{D}\\right)\\sin\\left(2\\pi f^{*} t^{*}\\right),\n$$\nwith $f^{*}=f D/U_{\\infty} = (f/f_s)\\,St$, and $K > 0$ a coupling coefficient. The acceleration is\n$$\n\\frac{d^2 y^{*}}{dt^{*2}} = -\\left(\\frac{A}{D}\\right)\\left(2\\pi f^{*}\\right)^2 \\sin\\left(2\\pi f^{*} t^{*}\\right).\n$$\n\nThe algorithm proceeds as follows.\n\n1. Parameter selection: We set $St=0.2$, hence $\\omega_s=2\\pi St$. For a moderately supercritical wake at $Re=200$, we choose $\\varepsilon=0.3$ to achieve a gently nonlinear limit cycle and $K=10$ to produce observable, but not overwhelming, entrainment by transverse acceleration. These are dimensionless, model-level parameters that are consistent with prior wake-oscillator studies for moderate Reynolds numbers.\n\n2. Time integration: For each test case $\\left(A/D, f/f_s\\right)$, compute $f^{*} = (f/f_s)\\,St$, define the prescribed $y^{*}(t^{*})$ and its second derivative, and integrate\n$$\n\\begin{cases}\n\\dot{C}_L = v,\\\\\n\\dot{v} = -\\varepsilon\\left(C_L^2 - 1\\right) v - \\omega_s^2 C_L + K \\,\\ddot{y}^{*}(t^{*}),\n\\end{cases}\n$$\nfrom $t^{*}=0$ to $t^{*}=T_{\\mathrm{end}}$ with $T_{\\mathrm{end}}=400$, and step size $\\Delta t^{*}=0.02$ for uniform sampling. Initial conditions are $C_L(0)=10^{-2}$ and $v(0)=0$.\n\n3. Frequency analysis for lock-in detection: Discard the first half of the time series to remove transients. From the remaining window, subtract the sample mean from $C_L$ to avoid a direct current component, apply a Hann window to reduce spectral leakage, and perform a one-sided discrete Fourier transform to obtain spectral magnitude as a function of frequency (in cycles per $t^{*}$). Let $f_{\\max}$ denote the frequency at which the magnitude is maximal.\n\n4. Decision rule: Let $f_s^{*}=St$ and $f_f^{*}=(f/f_s)\\,St$. Compute the single-bin frequency resolution $\\Delta f = 1/T_{\\mathrm{win}}$, where $T_{\\mathrm{win}}$ is the duration of the analysis window. Let $P(f_0)$ denote the sum of spectral power over bins whose frequencies lie in $[f_0-\\Delta f/2, f_0+\\Delta f/2]$. Declare lock-in if and only if the following hold:\n   - Dominant frequency proximity: $\\left|f_{\\max} - f_f^{*}\\right|/f_f^{*} \\le 0.05$.\n   - Forcing dominance over the natural mode: $P(f_f^{*}) \\ge 1.5 \\times P(f_s^{*})$.\n\n   This two-part criterion ensures that the response is both phase-locked to the forcing frequency and that the forcing-aligned component dominates the natural shedding component within the analysis bandwidth.\n\n5. Outputs: For each test case, record a boolean indicating whether lock-in occurs.\n\nTest suite details: The six prescribed cases are\n- Case $1$: $\\left(A/D, f/f_s\\right) = \\left(0.05, 0.70\\right)$,\n- Case $2$: $\\left(A/D, f/f_s\\right) = \\left(0.20, 0.95\\right)$,\n- Case $3$: $\\left(A/D, f/f_s\\right) = \\left(0.10, 1.15\\right)$,\n- Case $4$: $\\left(A/D, f/f_s\\right) = \\left(0.02, 0.95\\right)$,\n- Case $5$: $\\left(A/D, f/f_s\\right) = \\left(0.30, 0.85\\right)$,\n- Case $6$: $\\left(A/D, f/f_s\\right) = \\left(0.15, 0.50\\right)$.\n\nInterpretation: Cases near $f/f_s \\approx 1$ with larger $A/D$ are expected to lock-in due to stronger acceleration forcing aligned with the natural global mode, whereas cases far from unity or with very small $A/D$ are expected not to lock-in. However, the decision is determined by the quantitative spectral criterion described above.\n\nThe final program assembles these steps, solves the oscillator with the specified parameters and numerical settings, analyzes the spectrum, and prints a single line with a list of six booleans in order corresponding to the above cases.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Surrogate model and analysis for lock-in mapping in forced transverse oscillation of a cylinder\n# using a forced van der Pol wake oscillator for fluctuating lift.\n\ndef simulate_wake_oscillator(a_over_d: float, r_freq: float,\n                             St: float = 0.2,\n                             epsilon: float = 0.3,\n                             K: float = 10.0,\n                             t_end: float = 400.0,\n                             dt: float = 0.02):\n    \"\"\"\n    Simulate the forced van der Pol oscillator for the fluctuating lift coefficient C_L\n    with prescribed transverse oscillation y* = (A/D) sin(2 pi f* t*).\n    Parameters:\n        a_over_d: non-dimensional amplitude A/D\n        r_freq: frequency ratio f/f_s\n        St: Strouhal number (f_s*), default 0.2 for Re=200\n        epsilon: van der Pol nonlinearity parameter\n        K: coupling coefficient for acceleration forcing\n        t_end: end time in convective units\n        dt: sampling time step for uniform output\n    Returns:\n        t: time samples (numpy array)\n        CL: fluctuating lift coefficient time series (numpy array)\n    \"\"\"\n    # Natural angular frequency in convective units\n    omega_s = 2.0 * np.pi * St\n    # Forcing frequency in convective units (cycles per t*) and angular frequency\n    f_forcing = r_freq * St\n    omega_f = 2.0 * np.pi * f_forcing\n\n    # Define prescribed motion and its second derivative\n    def y_ddot(t):\n        # y*(t) = a_over_d * sin(omega_f * t)\n        return -a_over_d * (omega_f ** 2) * np.sin(omega_f * t)\n\n    # ODE system: x = [C_L, v], where v = dC_L/dt\n    def rhs(t, x):\n        CL, v = x\n        dCLdt = v\n        dvdt = -epsilon * (CL**2 - 1.0) * v - (omega_s**2) * CL + K * y_ddot(t)\n        return [dCLdt, dvdt]\n\n    # Time grid for uniform sampling\n    t_eval = np.arange(0.0, t_end + 1e-12, dt)\n\n    # Initial conditions\n    x0 = [1e-2, 0.0]\n\n    sol = solve_ivp(rhs, (0.0, t_end), x0, method='RK45', t_eval=t_eval, rtol=1e-6, atol=1e-9)\n    if not sol.success:\n        # In the unlikely event of failure, fall back to zeros to avoid crashing\n        return t_eval, np.zeros_like(t_eval)\n\n    return sol.t, sol.y[0]\n\n\ndef hann_window(n: int):\n    \"\"\"Generate a Hann window of length n.\"\"\"\n    if n = 0:\n        return np.array([])\n    return 0.5 - 0.5 * np.cos(2.0 * np.pi * np.arange(n) / (n - 1))\n\n\ndef spectral_lock_in(CL: np.ndarray, dt: float, St: float, r_freq: float,\n                     dominance_ratio: float = 1.5, freq_tol: float = 0.05):\n    \"\"\"\n    Decide lock-in based on spectral analysis of the lift coefficient signal.\n    Parameters:\n        CL: time series of fluctuating lift coefficient (numpy array)\n        dt: uniform sampling time step\n        St: Strouhal number (natural frequency in cycles per t*)\n        r_freq: forcing frequency ratio f/f_s\n        dominance_ratio: required ratio P(forcing)/P(natural) for lock-in\n        freq_tol: relative tolerance for dominant frequency proximity to forcing frequency\n    Returns:\n        lock_in: boolean\n    \"\"\"\n    n = CL.size\n    if n  8:\n        return False\n\n    # Remove mean to avoid DC component\n    x = CL - np.mean(CL)\n\n    # Apply Hann window\n    w = hann_window(n)\n    xw = x * w\n\n    # One-sided real FFT\n    X = np.fft.rfft(xw)\n    freqs = np.fft.rfftfreq(n, dt)\n    # Power spectral density (magnitude squared)\n    P = np.abs(X) ** 2\n\n    # Exclude zero frequency bin from consideration of dominant oscillatory component\n    if freqs.size > 1:\n        P[0] = 0.0\n\n    # Dominant frequency\n    idx_max = int(np.argmax(P))\n    f_max = freqs[idx_max]\n\n    # Define target frequencies\n    f_nat = St\n    f_forcing = r_freq * St\n\n    # Single-bin frequency resolution\n    if n * dt > 0:\n        df = 1.0 / (n * dt)\n    else:\n        df = 0.0\n\n    # Helper to compute band power in +/- half-bin around f0\n    def band_power(f0):\n        if df = 0:\n            return 0.0\n        # Indices whose frequencies are within half a bin width of f0\n        idxs = np.where(np.abs(freqs - f0) = (0.5 * df))[0]\n        if idxs.size == 0:\n            # fall back to nearest bin\n            idx = int(np.argmin(np.abs(freqs - f0)))\n            return P[idx]\n        return float(np.sum(P[idxs]))\n\n    P_forcing = band_power(f_forcing)\n    P_natural = band_power(f_nat)\n\n    # Conditions for lock-in\n    proximity = (abs(f_max - f_forcing) / f_forcing) = freq_tol if f_forcing > 0 else False\n    dominance = (P_forcing >= dominance_ratio * P_natural)\n\n    return bool(proximity and dominance)\n\n\ndef analyze_case(a_over_d: float, r_freq: float,\n                 St: float = 0.2, epsilon: float = 0.3, K: float = 10.0,\n                 t_end: float = 400.0, dt: float = 0.02) -> bool:\n    \"\"\"\n    Simulate and analyze a single test case for lock-in.\n    \"\"\"\n    t, CL = simulate_wake_oscillator(a_over_d, r_freq, St=St, epsilon=epsilon, K=K, t_end=t_end, dt=dt)\n    # Discard first half as transient\n    n = CL.size\n    start = n // 2\n    CL_win = CL[start:]\n    return spectral_lock_in(CL_win, dt, St, r_freq, dominance_ratio=1.5, freq_tol=0.05)\n\n\ndef solve():\n    # Define the test cases from the problem statement as (A/D, f/f_s).\n    test_cases = [\n        (0.05, 0.70),  # Case 1\n        (0.20, 0.95),  # Case 2\n        (0.10, 1.15),  # Case 3\n        (0.02, 0.95),  # Case 4\n        (0.30, 0.85),  # Case 5\n        (0.15, 0.50),  # Case 6\n    ]\n\n    # Fixed parameters for all cases\n    St = 0.2\n    epsilon = 0.3\n    K = 10.0\n    t_end = 400.0\n    dt = 0.02\n\n    results = []\n    for a_over_d, r_freq in test_cases:\n        lock_in = analyze_case(a_over_d, r_freq, St=St, epsilon=epsilon, K=K, t_end=t_end, dt=dt)\n        results.append(lock_in)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```",
            "answer": "[False,True,True,False,True,False]"
        }
    ]
}