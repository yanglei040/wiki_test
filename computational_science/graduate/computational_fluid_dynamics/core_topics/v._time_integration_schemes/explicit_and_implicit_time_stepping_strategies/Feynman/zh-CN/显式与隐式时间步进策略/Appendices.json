{
    "hands_on_practices": [
        {
            "introduction": "掌握基本数值格式的推导、精度和稳定性分析，是深入学习计算流体动力学的第一步。本练习将引导你完整地分析Crank-Nicolson方法——一种在CFD中广泛应用的经典隐式格式。通过这个过程，你将熟悉局部截断误差的分析方法，并接触到A-稳定性和L-稳定性等核心概念，这对于选择和评估时间积分策略至关重要。",
            "id": "3316918",
            "problem": "计算流体动力学（CFD）中，通过方法线法进行空间离散化得到的半离散格式，会导出一个形如 $M \\dot{\\mathbf{u}}(t) = \\mathbf{r}(\\mathbf{u}(t))$ 的常微分方程（ODE）组，其中 $M \\in \\mathbb{R}^{m \\times m}$ 是一个与时间无关的对称正定质量矩阵，$\\mathbf{r}: \\mathbb{R}^{m} \\to \\mathbb{R}^{m}$ 足够光滑。考虑将解从时间 $t_n$ 推进到 $t_{n+1} = t_n + \\Delta t$。\n\n任务：\n1. 从基本恒等式\n$$\nM\\left(\\mathbf{u}(t_{n+1}) - \\mathbf{u}(t_n)\\right) = \\int_{t_n}^{t_{n+1}} \\mathbf{r}(\\mathbf{u}(t)) \\, dt,\n$$\n出发，通过对右侧的时间积分应用梯形求积法则，推导出一个隐式时间步进方法。写出从 $\\mathbf{u}^n$ 计算 $\\mathbf{u}^{n+1}$ 的最终全离散单步法。\n\n2. 通过分析局部截断误差，确定该方法在时间上具有二阶精度。具体来说，定义将精确解代入离散格式时产生的差项，并利用时间上的泰勒展开和链式法则，确定 $\\Delta t$ 的首个非零项的阶。\n\n3. 考虑线性刚性模型问题 $\\mathbf{r}(\\mathbf{u}) = A \\mathbf{u}$（其中 $A \\in \\mathbb{R}^{m \\times m}$）和 $M = I$，并分析标量测试方程 $\\dot{u} = \\lambda u$（其中 $\\lambda \\in \\mathbb{C}$, $\\operatorname{Re}(\\lambda)  0$）。推导该方法（在第1部分中得到）的标量放大因子 $R(z)$，其中 $z = \\lambda \\Delta t$。讨论在 $\\operatorname{Re}(z) \\le 0$ 时 $|R(z)|$ 的含义以及当 $z \\to -\\infty$ 时 $R(z)$ 的行为与 A-稳定性和 L-稳定性的关系，包括刚性分量中出现寄生振荡的可能性。\n\n最后，计算第1部分推导的方法的刚性极限放大因子 $\\lim_{z \\to -\\infty} R(z)$，并将此极限作为你的最终答案。将最终答案表示为一个无单位的精确实数。",
            "solution": "所述问题具有科学依据、是适定的、客观的，并包含严格求解所需的所有信息。这些任务对应于常微分方程（ODE）数值方法的标准分析，涵盖了其推导、精度和稳定性。\n\n### 任务1：隐式时间步进方法的推导\n\n我们从基本积分恒等式开始，该恒等式将解向量 $\\mathbf{u}$ 在时间区间 $[t_n, t_{n+1}]$ 上的变化与残差向量 $\\mathbf{r}(\\mathbf{u}(t))$ 的时间积分联系起来：\n$$\nM\\left(\\mathbf{u}(t_{n+1}) - \\mathbf{u}(t_n)\\right) = \\int_{t_n}^{t_{n+1}} \\mathbf{r}(\\mathbf{u}(t)) \\, dt\n$$\n这里，$t_{n+1} = t_n + \\Delta t$。任务是通过使用梯形求积法则来近似右侧的积分，从而推导出一种离散单步法。对于一个在区间 $[a, b]$ 上的通用向量值函数 $\\mathbf{f}(t)$，梯形法则由下式给出：\n$$\n\\int_a^b \\mathbf{f}(t) \\, dt \\approx \\frac{b-a}{2} \\left( \\mathbf{f}(a) + \\mathbf{f}(b) \\right)\n$$\n将此法则应用于我们的积分，其中 $\\mathbf{f}(t) = \\mathbf{r}(\\mathbf{u}(t))$, $a = t_n$, $b = t_{n+1}$，我们得到以下近似：\n$$\n\\int_{t_n}^{t_{n+1}} \\mathbf{r}(\\mathbf{u}(t)) \\, dt \\approx \\frac{t_{n+1} - t_n}{2} \\left( \\mathbf{r}(\\mathbf{u}(t_n)) + \\mathbf{r}(\\mathbf{u}(t_{n+1})) \\right) = \\frac{\\Delta t}{2} \\left( \\mathbf{r}(\\mathbf{u}(t_n)) + \\mathbf{r}(\\mathbf{u}(t_{n+1})) \\right)\n$$\n为了获得全离散方法，我们将此近似代入基本恒等式，并用时间 $t_k$ 处的数值近似解 $\\mathbf{u}^k$ 替换精确解 $\\mathbf{u}(t_k)$。这得到：\n$$\nM\\left(\\mathbf{u}^{n+1} - \\mathbf{u}^n\\right) = \\frac{\\Delta t}{2} \\left( \\mathbf{r}(\\mathbf{u}^n) + \\mathbf{r}(\\mathbf{u}^{n+1}) \\right)\n$$\n这就是将解从 $\\mathbf{u}^n$ 推进到 $\\mathbf{u}^{n+1}$ 的单步法。这是一个隐式方法，因为未知量 $\\mathbf{u}^{n+1}$ 出现在方程的两边，包括作为（通常为非线性的）函数 $\\mathbf{r}$ 的自变量。此方法广为人知，称为梯形法则方法，或在某些情况下称为 Crank-Nicolson 方法。\n\n### 任务2：局部截断误差分析\n\n局部截断误差（LTE）是将 ODE 的精确解 $\\mathbf{u}(t)$ 代入离散差分方程时产生的残差（或差项）。我们将第 $n+1$ 步的差项表示为 $\\boldsymbol{\\tau}^{n+1}$：\n$$\n\\boldsymbol{\\tau}^{n+1} = M\\left(\\mathbf{u}(t_{n+1}) - \\mathbf{u}(t_n)\\right) - \\frac{\\Delta t}{2} \\left( \\mathbf{r}(\\mathbf{u}(t_n)) + \\mathbf{r}(\\mathbf{u}(t_{n+1})) \\right)\n$$\n为了确定该方法的阶，我们对各项在时间 $t_n$ 附近进行泰勒级数展开。令 $\\mathbf{u}_n = \\mathbf{u}(t_n)$。\n$\\mathbf{u}(t_{n+1})$ 的展开式为：\n$$\n\\mathbf{u}(t_{n+1}) = \\mathbf{u}_n + \\Delta t \\dot{\\mathbf{u}}_n + \\frac{(\\Delta t)^2}{2} \\ddot{\\mathbf{u}}_n + \\frac{(\\Delta t)^3}{6} \\dddot{\\mathbf{u}}_n + \\mathcal{O}((\\Delta t)^4)\n$$\n$\\mathbf{r}(\\mathbf{u}(t_{n+1}))$ 的时间展开式为：\n$$\n\\mathbf{r}(\\mathbf{u}(t_{n+1})) = \\mathbf{r}(\\mathbf{u}_n) + \\Delta t \\dot{\\mathbf{r}}_n + \\frac{(\\Delta t)^2}{2} \\ddot{\\mathbf{r}}_n + \\mathcal{O}((\\Delta t)^3)\n$$\n其中 $\\dot{\\mathbf{r}}_n = \\frac{d}{dt}\\mathbf{r}(\\mathbf{u}(t))|_{t=t_n}$，依此类推。\n现在，我们将这些展开式代入 $\\boldsymbol{\\tau}^{n+1}$ 的表达式中：\n$$\n\\boldsymbol{\\tau}^{n+1} = M\\left( \\Delta t \\dot{\\mathbf{u}}_n + \\frac{(\\Delta t)^2}{2} \\ddot{\\mathbf{u}}_n + \\frac{(\\Delta t)^3}{6} \\dddot{\\mathbf{u}}_n \\right) - \\frac{\\Delta t}{2} \\left( \\mathbf{r}_n + \\left[ \\mathbf{r}_n + \\Delta t \\dot{\\mathbf{r}}_n + \\frac{(\\Delta t)^2}{2} \\ddot{\\mathbf{r}}_n \\right] \\right) + \\mathcal{O}((\\Delta t)^4)\n$$\n$$\n\\boldsymbol{\\tau}^{n+1} = \\left( M \\Delta t \\dot{\\mathbf{u}}_n + M \\frac{(\\Delta t)^2}{2} \\ddot{\\mathbf{u}}_n + M \\frac{(\\Delta t)^3}{6} \\dddot{\\mathbf{u}}_n \\right) - \\left( \\Delta t \\mathbf{r}_n + \\frac{(\\Delta t)^2}{2} \\dot{\\mathbf{r}}_n + \\frac{(\\Delta t)^3}{4} \\ddot{\\mathbf{r}}_n \\right) + \\mathcal{O}((\\Delta t)^4)\n$$\n精确解在所有时间都满足原始 ODE $M \\dot{\\mathbf{u}}(t) = \\mathbf{r}(\\mathbf{u}(t))$。由于 $M$ 与时间无关，我们可以对该关系式关于时间求导得到：\n$M \\ddot{\\mathbf{u}}(t) = \\dot{\\mathbf{r}}(t)$\n$M \\dddot{\\mathbf{u}}(t) = \\ddot{\\mathbf{r}}(t)$\n将这些在 $t=t_n$ 处的关系式代入 $\\boldsymbol{\\tau}^{n+1}$ 的表达式中：\n$$\n\\boldsymbol{\\tau}^{n+1} = \\left( \\Delta t \\mathbf{r}_n + \\frac{(\\Delta t)^2}{2} \\dot{\\mathbf{r}}_n + \\frac{(\\Delta t)^3}{6} \\ddot{\\mathbf{r}}_n \\right) - \\left( \\Delta t \\mathbf{r}_n + \\frac{(\\Delta t)^2}{2} \\dot{\\mathbf{r}}_n + \\frac{(\\Delta t)^3}{4} \\ddot{\\mathbf{r}}_n \\right) + \\mathcal{O}((\\Delta t)^4)\n$$\n$\\Delta t$ 阶和 $(\\Delta t)^2$ 阶的项相互抵消。首个非零项是 $(\\Delta t)^3$ 阶的：\n$$\n\\boldsymbol{\\tau}^{n+1} = \\left( \\frac{1}{6} - \\frac{1}{4} \\right) (\\Delta t)^3 \\ddot{\\mathbf{r}}_n + \\mathcal{O}((\\Delta t)^4) = -\\frac{(\\Delta t)^3}{12} \\ddot{\\mathbf{r}}_n + \\mathcal{O}((\\Delta t)^4)\n$$\n局部截断误差通常定义为单位时间的差项，即 $\\boldsymbol{\\tau}^{n+1} / \\Delta t$。因此，LTE 的首项是 $(\\Delta t)^2$ 阶的。一个 LTE 为 $\\mathcal{O}((\\Delta t)^p)$ 阶的方法被称为 p 阶方法。因此，梯形法则方法在时间上是二阶的。\n\n### 任务3：稳定性分析与刚性极限放大因子\n\n我们考虑线性刚性模型问题，其中 $M = I$（单位矩阵）且 $\\mathbf{r}(\\mathbf{u}) = A \\mathbf{u}$。ODE 系统变为 $\\dot{\\mathbf{u}} = A \\mathbf{u}$。\n将这些代入任务1中的离散格式：\n$$\nI(\\mathbf{u}^{n+1} - \\mathbf{u}^n) = \\frac{\\Delta t}{2} \\left( A\\mathbf{u}^n + A\\mathbf{u}^{n+1} \\right)\n$$\n重新整理以求解 $\\mathbf{u}^{n+1}$：\n$$\n\\mathbf{u}^{n+1} - \\frac{\\Delta t}{2} A\\mathbf{u}^{n+1} = \\mathbf{u}^n + \\frac{\\Delta t}{2} A\\mathbf{u}^n\n$$\n$$\n\\left(I - \\frac{\\Delta t}{2} A\\right) \\mathbf{u}^{n+1} = \\left(I + \\frac{\\Delta t}{2} A\\right) \\mathbf{u}^n\n$$\n稳定性分析可以通过检验标量测试方程 $\\dot{u} = \\lambda u$ 来进行，其中 $\\lambda \\in \\mathbb{C}$ 且 $\\operatorname{Re}(\\lambda)  0$。这对应于设 $A = \\lambda$ 和 $\\mathbf{u} = u$。离散格式变为：\n$$\n\\left(1 - \\frac{\\lambda \\Delta t}{2}\\right) u^{n+1} = \\left(1 + \\frac{\\lambda \\Delta t}{2}\\right) u^n\n$$\n标量放大因子 $R(z)$ 定义为 $u^{n+1} = R(z) u^n$，其中 $z = \\lambda \\Delta t$。从上式中，我们得到：\n$$\nR(z) = \\frac{1 + z/2}{1 - z/2}\n$$\n如果一个方法的稳定区域包含整个复平面左半部分，即对于所有 $\\operatorname{Re}(z) \\le 0$ 的 $z \\in \\mathbb{C}$ 都有 $|R(z)| \\le 1$，则该方法是 A-稳定的。令 $z = x + iy$，其中 $x = \\operatorname{Re}(z) \\le 0$：\n$$\n|R(z)|^2 = \\left| \\frac{1 + (x+iy)/2}{1 - (x+iy)/2} \\right|^2 = \\frac{|(1+x/2) + i(y/2)|^2}{|(1-x/2) - i(y/2)|^2} = \\frac{(1+x/2)^2 + (y/2)^2}{(1-x/2)^2 + (y/2)^2}\n$$\n条件 $|R(z)|^2 \\le 1$ 等价于 $(1+x/2)^2 \\le (1-x/2)^2$，化简后为 $1+x \\le 1-x$，即 $2x \\le 0$ 或 $x \\le 0$。这恰好是条件 $\\operatorname{Re}(z) \\le 0$。因此，该方法是 A-稳定的。\n\n如果一个方法是 A-稳定的，并且额外满足 $\\lim_{|z| \\to \\infty, \\operatorname{Re}(z)  0} |R(z)| = 0$，则该方法是 L-稳定的。我们通常沿着实轴检验其在 $z \\to -\\infty$ 时的极限。\n$$\n\\lim_{z \\to -\\infty} R(z) = \\lim_{z \\to -\\infty} \\frac{1 + z/2}{1 - z/2}\n$$\n分子和分母同除以 $z$：\n$$\n\\lim_{z \\to -\\infty} \\frac{1/z + 1/2}{1/z - 1/2} = \\frac{0 + 1/2}{0 - 1/2} = -1\n$$\n由于此极限为 $-1$ 而不是 $0$，该方法不是 L-稳定的。这意味着对于解的非常刚性的分量（对应于具有大负实部的特征值 $\\lambda$，因此 $z \\to -\\infty$），数值解不会衰减；相反，它的符号在每个时间步都会翻转，即 $u^{n+1} \\approx -u^n$。这会导致被称为寄生振荡的持续的、非物理的高频振荡。对于需要对刚性分量进行强阻尼的问题，L-稳定的方法（如后向欧拉法，其 $R(z) \\to 0$）更为可取。\n\n最后的任务是计算刚性极限放大因子，即上面计算的极限。\n$$\n\\lim_{z \\to -\\infty} R(z) = -1\n$$",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "在了解了单一格式的特性后，比较不同格式的性能对于做出明智的建模选择至关重要。本练习在前一个实践的基础上，将Crank-Nicolson方法与另一种常用的隐式格式——后向欧拉法进行对比。练习的核心是分析它们的幅值误差和相位误差，这两个误差分别对应于数值耗散和数值色散，并探讨这些数值效应如何深刻影响湍流等物理现象的模拟。",
            "id": "3316984",
            "problem": "考虑周期性域上的线性波动方程 $u_{t} + c\\,u_{x} = 0$，其中常数波速 $c > 0$。设空间导数由一个与 $\\partial_{x}$ 一致的斜对称线性算子进行半离散化，因此对于波数为 $k$ 的单个傅里叶模式，其复振幅 $\\hat{u}(t)$ 的半离散演化由以下常微分方程控制\n$$\n\\frac{d\\hat{u}}{dt} = i\\,\\omega\\,\\hat{u},\\quad \\omega = c\\,\\tilde{k},\\quad \\omega > 0,\n$$\n其中 $\\tilde{k}$ 是与所选空间离散化相关的离散波数。将均匀时间步长记为 $\\Delta t$，无量纲参数记为 $z = \\omega\\,\\Delta t$。\n\n将后向欧拉（backward Euler）法和 Crank-Nicolson 法应用于该半离散常微分方程，并对每种方法，通过 $\\hat{u}^{n+1} = g\\,\\hat{u}^{n}$ 定义单步放大因子 $g$。对于每种方法：\n- 以 $z$ 的函数形式推导出 $g$ 的闭式解。\n- 将单步振幅误差定义为 $|g| - 1$（相对于精确解的振幅，对于纯虚数 $\\omega$，该振幅随时间恒定）。\n- 将单步相位误差（以弧度为单位）定义为 $\\arg(g) - \\omega\\,\\Delta t$，其中 $\\arg(g)$ 是复数 $g$ 的主辐角。\n- 求出振幅误差到 $z^{2}$ 阶项（含）以及相位误差到 $z^{3}$ 阶项（含）的小 $z$ 主阶渐近展开。\n\n然后，使用这些展开式，计算后向欧拉法与 Crank-Nicolson 法的主阶相位误差系数的量值之比（即，主阶相位误差展开式中 $z^{3}$ 项系数的绝对值之比）。将此比率报告为单个实数。所有相位量均使用弧度。无需四舍五入。\n\n最后，根据您的推导，解释这些时间步进策略的振幅和相位行为对计算流体动力学中欠解析湍流的影响，并明确阐述在存在斜对称空间算子的情况下，由时间积分引入的数值耗散和数值色散的作用。",
            "solution": "周期域上的线性波动方程 $u_{t} + c\\,u_{x} = 0$ 可以在傅里叶空间中表示。对于波数为 $k$ 的单个傅里叶模式 $u(x,t) = \\hat{u}(t)\\,\\exp(i k x)$，一个斜对称的半离散空间算子（例如，周期网格上的谱导数或中心差分）将此模式映射到一个纯虚数特征值。因此，模式振幅的半离散演化方程为\n$$\n\\frac{d\\hat{u}}{dt} = i\\,\\omega\\,\\hat{u},\\quad \\omega = c\\,\\tilde{k},\\quad \\omega > 0.\n$$\n在一个时间步长 $\\Delta t$ 内的精确解是 $\\hat{u}(t+\\Delta t) = \\exp(i \\omega \\Delta t)\\,\\hat{u}(t)$，其模为 1，累积相位为 $\\omega \\Delta t$。\n\n我们分析应用于 $\\frac{d\\hat{u}}{dt} = i\\,\\omega\\,\\hat{u}$ 的后向欧拉法和 Crank-Nicolson 法。\n\n后向欧拉法定义为\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n} + \\Delta t\\, i\\,\\omega\\,\\hat{u}^{n+1}.\n$$\n求解放大因子 $g_{\\mathrm{BE}}$ 可得\n$$\n\\hat{u}^{n+1}\\left(1 - i\\,\\omega\\,\\Delta t\\right) = \\hat{u}^{n}\\quad\\Rightarrow\\quad g_{\\mathrm{BE}} = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}} = \\frac{1}{1 - i z},\\quad z = \\omega\\,\\Delta t.\n$$\n其模和辐角为\n$$\n|g_{\\mathrm{BE}}| = \\frac{1}{\\sqrt{1 + z^{2}}},\\qquad \\arg(g_{\\mathrm{BE}}) = \\arctan(z).\n$$\n单步振幅误差为\n$$\n|g_{\\mathrm{BE}}| - 1 = \\frac{1}{\\sqrt{1 + z^{2}}} - 1.\n$$\n对于小 $z$，使用 $(1 + z^{2})^{-1/2} = 1 - \\frac{1}{2} z^{2} + \\frac{3}{8} z^{4} + \\mathcal{O}(z^{6})$，我们得到\n$$\n|g_{\\mathrm{BE}}| - 1 = -\\frac{1}{2} z^{2} + \\frac{3}{8} z^{4} + \\mathcal{O}(z^{6}).\n$$\n以弧度为单位的单步相位误差为\n$$\n\\text{Phase error}_{\\mathrm{BE}} = \\arg(g_{\\mathrm{BE}}) - \\omega\\,\\Delta t = \\arctan(z) - z.\n$$\n使用 $\\arctan(z) = z - \\frac{1}{3} z^{3} + \\frac{1}{5} z^{5} + \\mathcal{O}(z^{7})$，主阶相位误差为\n$$\n\\text{Phase error}_{\\mathrm{BE}} = -\\frac{1}{3} z^{3} + \\frac{1}{5} z^{5} + \\mathcal{O}(z^{7}).\n$$\n\nCrank-Nicolson 法定义为\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n} + \\Delta t\\, i\\,\\omega\\,\\frac{\\hat{u}^{n+1} + \\hat{u}^{n}}{2}.\n$$\n求解 $g_{\\mathrm{CN}}$ 可得\n$$\n\\hat{u}^{n+1}\\left(1 - i\\,\\frac{z}{2}\\right) = \\hat{u}^{n}\\left(1 + i\\,\\frac{z}{2}\\right)\\quad\\Rightarrow\\quad g_{\\mathrm{CN}} = \\frac{1 + i\\,\\frac{z}{2}}{1 - i\\,\\frac{z}{2}}.\n$$\n其模为\n$$\n|g_{\\mathrm{CN}}| = \\frac{\\sqrt{1 + \\left(\\frac{z}{2}\\right)^{2}}}{\\sqrt{1 + \\left(\\frac{z}{2}\\right)^{2}}} = 1,\n$$\n因此单步振幅误差恒为零：\n$$\n|g_{\\mathrm{CN}}| - 1 = 0.\n$$\n$g_{\\mathrm{CN}}$ 的辐角是分子和分母辐角之差：\n$$\n\\arg\\!\\left(1 + i\\,\\frac{z}{2}\\right) = \\arctan\\!\\left(\\frac{z}{2}\\right),\\qquad \\arg\\!\\left(1 - i\\,\\frac{z}{2}\\right) = -\\arctan\\!\\left(\\frac{z}{2}\\right),\n$$\n因此\n$$\n\\arg(g_{\\mathrm{CN}}) = 2\\,\\arctan\\!\\left(\\frac{z}{2}\\right).\n$$\n以弧度为单位的单步相位误差为\n$$\n\\text{Phase error}_{\\mathrm{CN}} = 2\\,\\arctan\\!\\left(\\frac{z}{2}\\right) - z.\n$$\n使用级数 $\\arctan(\\xi) = \\xi - \\frac{1}{3}\\xi^{3} + \\frac{1}{5}\\xi^{5} + \\mathcal{O}(\\xi^{7})$，其中 $\\xi = z/2$，我们得到\n$$\n2\\,\\arctan\\!\\left(\\frac{z}{2}\\right) = 2\\left(\\frac{z}{2} - \\frac{1}{3}\\left(\\frac{z}{2}\\right)^{3} + \\frac{1}{5}\\left(\\frac{z}{2}\\right)^{5} + \\mathcal{O}(z^{7})\\right) = z - \\frac{1}{12} z^{3} + \\frac{1}{80} z^{5} + \\mathcal{O}(z^{7}),\n$$\n所以\n$$\n\\text{Phase error}_{\\mathrm{CN}} = -\\frac{1}{12} z^{3} + \\frac{1}{80} z^{5} + \\mathcal{O}(z^{7}).\n$$\n\n我们现在计算主阶相位误差系数（乘以 $z^{3}$ 的系数）的量值之比：\n- 对于后向欧拉法，量值为 $\\left|\\,-\\frac{1}{3}\\,\\right| = \\frac{1}{3}$。\n- 对于 Crank-Nicolson 法，量值为 $\\left|\\,-\\frac{1}{12}\\,\\right| = \\frac{1}{12}$。\n因此，所求的比率为\n$$\n\\frac{\\frac{1}{3}}{\\frac{1}{12}} = 4.\n$$\n\n这些振幅和相位行为对计算流体动力学中欠解析湍流的影响如下。平流项的半离散线性化动力学是斜对称的，对应于纯虚数特征值。在这种情况下，Crank-Nicolson 法不引入振幅阻尼（$|g_{\\mathrm{CN}}| = 1$），保留了此类线性模式的范数，同时表现出量级为 $z^{3}$、系数为 $-\\frac{1}{12}$ 的相对较小的色散相位误差。后向欧拉法引入了无条件振幅阻尼（$|g_{\\mathrm{BE}}|  1$），其主阶亏损为 $-\\frac{1}{2} z^{2}$，以及一个系数为 $-\\frac{1}{3}$ 的更大的色散相位误差。对于欠解析湍流，其中小尺度无法被网格精确表示，时间积分引起的耗散可以起到隐式亚格子正则化的作用。后向欧拉法依赖于时间步长的阻尼会优先衰减高频内容，这类似于隐式大涡模拟（ILES），但代价是增加了色散误差，并可能对动态相关的近网格尺度产生过阻尼。Crank-Nicolson 法对于斜对称线性动力学是非耗散的，保留了这些分量的能量并且具有较小的相位误差，这有利于精确地传播波和涡结构；然而，在存在非线性相互作用、混淆和非正规效应的情况下，缺乏时间步进耗散可能会导致能量在未解析的尺度上累积，除非辅以空间滤波、去混淆或显式亚格子建模。因此，在这些策略之间的选择涉及一种权衡：后向欧拉法通过耗散提供鲁棒性，但对振幅和相位的扭曲更强；Crank-Nicolson 法对线性波保持了振幅保真度和较低的色散，但依赖于其他机制来控制欠解析的动力学。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "理论上的“无条件稳定”在实际计算中是否总是成立？本练习旨在揭示理想化理论与计算实践之间的重要差距。你将通过一个具体的反例，探索一个A-稳定的隐式格式（如后向欧拉法）在实际应用中如何因为迭代求解器的有限精度而失去其无条件稳定性。这个实践问题强调了代数方程求解的精度与时间积分稳定性之间紧密的、不可忽视的联系。",
            "id": "3316997",
            "problem": "考虑计算流体力学中的一个标量常微分方程的初值问题：$y'(t) = f(y(t))$，$y(0) = y_0$，其中 $f$ 是全局利普希茨连续的，利普希茨常数为 $L > 0$，即对所有的 $y$ 和 $z$ 都有 $|f(y) - f(z)| \\le L |y - z|$。一种广泛使用的 A-稳定单步隐式方法是后向（隐式）欧拉格式，它对时间步长 $\\Delta t > 0$ 由以下非线性方程定义\n$$\ny_{n+1} = y_n + \\Delta t\\, f(y_{n+1}),\n$$\n在每一步 $n$ 都必须求解该方程以得到 $y_{n+1}$。在实践中，该隐式方程通常使用迭代线性或非线性求解器来求解，当达到预设的残差容忍度时终止。令计算得到的迭代值 $y_{n+1}^{\\text{(approx)}}$ 满足一个残差条件\n$$\nr_n := y_{n+1}^{\\text{(approx)}} - y_n - \\Delta t\\, f\\!\\left(y_{n+1}^{\\text{(approx)}}\\right),\n$$\n其相对容忍度为 $|r_n| \\le \\zeta\\, |y_n|$，其中 $\\zeta \\ge 0$ 是一个无量纲数。假设残差与 $y_n$ 的对齐方式为最坏情况，即计算解的增长达到最大。\n\n任务是从第一性原理出发，形式上推导出一个反例，证明由于不精确的线性/非线性求解，A-稳定的隐式方法会丧失无条件稳定性，并用 $\\Delta t$ 和 $L$ 来量化容忍度阈值。使用线性检验方程 $f(y) = -L y$（其中 $L > 0$），这样精确的隐式欧拉更新需求解\n$$\n(1 + \\Delta t\\, L)\\, y_{n+1} = y_n.\n$$\n对于满足 $|r_n| \\le \\zeta\\, |y_n|$ 的不精确求解，其中选择 $r_n$ 与 $y_n$ 对齐以最大化增长，请证明有效放大因子被修正，并推导使计算迭代值 $y_n$ 发散的 $\\zeta$ 阈值。总结出区分收缩、中性行为和发散的，关联 $\\zeta$、$\\Delta t$ 和 $L$ 的精确不等式。\n\n然后实现一个程序，针对指定的测试套件，为每个案例计算：\n- 阈值 $\\zeta_{\\text{th}} = \\Delta t\\, L$，\n- 有效放大因子 $g_{\\text{eff}}$，以及\n- 在最坏情况残差对齐下，数值序列是否发散。\n\n使用以下测试套件，其设计旨在覆盖稳定情况、中性边界情况、发散情况以及小步长下的敏感性。所有量均为无量纲。对于每个案例，程序应从 $y_0$ 开始，使用解答部分推导出的最坏情况不精确隐式欧拉递推关系演化 $N$ 步，并报告得到的 $y_N$：\n1. $(L, \\Delta t, \\zeta, N, y_0) = (10.0, 0.01, 0.05, 50, 1.0)$，\n2. $(L, \\Delta t, \\zeta, N, y_0) = (10.0, 0.01, 0.10, 50, 1.0)$，\n3. $(L, \\Delta t, \\zeta, N, y_0) = (10.0, 0.01, 0.20, 50, 1.0)$，\n4. $(L, \\Delta t, \\zeta, N, y_0) = (1.0, 1.0, 1.01, 50, 1.0)$，\n5. $(L, \\Delta t, \\zeta, N, y_0) = (100.0, 10^{-4}, 0.011, 50, 1.0)$。\n\n对于每个测试案例，输出必须是 $[\\zeta_{\\text{th}}, g_{\\text{eff}}, d, y_N]$ 形式的列表，其中 $d$ 是一个整数指示符（如果序列在最坏情况残差对齊下发散，则为 $1$，否则为 $0$）。您的程序应生成单行输出，其中包含一个以逗号分隔的列表形式的结果，并用方括号括起来。每个测试案例的列表顺序与上面相同，浮点数四舍五入到六位小数，例如 $[[\\cdots],[\\cdots],\\ldots]$。",
            "solution": "该问题要求分析当每个时间步产生的非线性代数方程被不精确求解时，后向（隐式）欧拉方法的稳定性。我们的任务是推导出一个条件，以证明一个A-稳定方法由于这种不精确性而丧失无条件稳定性，并量化解容忍度的阈值。\n\n让我们从形式化问题设置开始。给定一个标量常微分方程（ODE）$y'(t) = f(y(t))$，初始条件为 $y(0) = y_0$。函数 $f$ 是利普希茨连续的，常数为 $L > 0$。后向欧拉方法将此ODE离散化为：\n$$\n\\frac{y_{n+1} - y_n}{\\Delta t} = f(y_{n+1})\n$$\n其中 $y_n$ 是对 $y(n\\Delta t)$ 的数值近似，$\\Delta t$ 是时间步长。这可以重写为需求解 $y_{n+1}$ 的方程：\n$$\ny_{n+1} - y_n - \\Delta t f(y_{n+1}) = 0\n$$\n问题指出这个方程被不精确求解。令计算解为 $y_{n+1}^{\\text{(approx)}}$。为簡便起见，正如在此类分析中常见的做法，我们将省略上标，让 $y_{n+1}$ 代表这个计算出的、不精确的值。这种不精确性由一个非零残差 $r_n$ 来表征：\n$$\nr_n := y_{n+1} - y_n - \\Delta t f(y_{n+1})\n$$\n该残差受相对容忍度条件的约束：\n$$\n|r_n| \\le \\zeta |y_n|\n$$\n其中 $\\zeta \\ge 0$ 是一个无量纲容忍度参数。\n\n为了分析稳定性，我们使用标准的线性检验方程 $f(y) = \\lambda y$。对于当前问题，给定 $f(y) = -L y$，其中 $L > 0$ 是利普希茨常数。这对应于 $\\lambda = -L$，一个实数且为负的值，对于这类值，已知后向欧拉方法是A-稳定（且L-稳定）的，意味着对于任何 $\\Delta t > 0$ 的选择，精确数值解都应该衰减。\n\n将 $f(y_{n+1}) = -L y_{n+1}$ 代入残差定义中：\n$$\nr_n = y_{n+1} - y_n - \\Delta t (-L y_{n+1})\n$$\n$$\nr_n = y_{n+1} (1 + \\Delta t L) - y_n\n$$\n我们可以重排这个方程，用当前迭代值 $y_n$ 和残差 $r_n$ 来表示下一个迭代值 $y_{n+1}$：\n$$\ny_{n+1} (1 + \\Delta t L) = y_n + r_n\n$$\n$$\ny_{n+1} = \\frac{y_n + r_n}{1 + \\Delta t L}\n$$\n这个方程显示了在数值格式和不精确求解残差的影响下，解是如何从一步演化到下一步的。\n\n问题要求我们考虑使计算解增长最大化的残差的“最坏情况对齐”。下一个迭代值的模为 $|y_{n+1}| = \\frac{|y_n + r_n|}{|1 + \\Delta t L|}$。由于 $L > 0$ 和 $\\Delta t > 0$，分母 $1 + \\Delta t L$ 总是正的。为了最大化 $|y_{n+1}|$，我们必须最大化分子 $|y_n + r_n|$。残差 $r_n$ 受 $|r_n| \\le \\zeta |y_n|$ 的约束。$|y_n + r_n|$ 的值在 $r_n$ 为实数且与 $y_n$ 同号时最大。因此，残差的最坏情况选择是 $r_n = \\zeta y_n$（如果 $y_n > 0$，$r_n = \\zeta y_n$；如果 $y_n  0$，$r_n = \\zeta y_n = -\\zeta|y_n|$）。这个选择使容忍度边界饱和，并对齐残差以引起最大放大。\n\n将这个最坏情况的残差 $r_n = \\zeta y_n$ 代入 $y_{n+1}$ 的递推关系中：\n$$\ny_{n+1} = \\frac{y_n + \\zeta y_n}{1 + \\Delta t L} = \\frac{(1 + \\zeta) y_n}{1 + \\Delta t L}\n$$\n这给了我们一个形式为 $y_{n+1} = g_{\\text{eff}} y_n$ 的线性递推关系，其中 $g_{\\text{eff}}$ 是有效放大因子：\n$$\ng_{\\text{eff}} = \\frac{1 + \\zeta}{1 + \\Delta t L}\n$$\n如果 $|g_{\\text{eff}}|  1$，数值解序列 $y_n$ 是稳定的（收缩）；如果 $|g_{\\text{eff}}| = 1$，则是中性的；如果 $|g_{\\text{eff}}| > 1$，则是不稳定的（发散）。\n\n由于 $\\zeta \\ge 0$，$L > 0$ 和 $\\Delta t > 0$，分子 $1 + \\zeta$ 和分母 $1 + \\Delta t L$ 都大于或等于 $1$。因此，$g_{\\text{eff}}$ 总是正的，我们可以在稳定性分析中去掉绝对值符号。\n\n发散的条件是 $g_{\\text{eff}} > 1$：\n$$\n\\frac{1 + \\zeta}{1 + \\Delta t L} > 1\n$$\n乘以正的分母 $1 + \\Delta t L$：\n$$\n1 + \\zeta > 1 + \\Delta t L\n$$\n$$\n\\zeta > \\Delta t L\n$$\n这个不等式为后向欧拉方法的无条件稳定性提供了一个反例。即使该方法在精确求解时是 A-稳定的，如果不精确求解的相对残差容忍度 $\\zeta$ 大于时间步长 $\\Delta t$ 与系统特征频率（由 $L$ 代表）的乘积，也可能引发不稳定性。\n\n区分收缩与发散的阈值容忍度 $\\zeta_{\\text{th}}$ 是放大因子恰好为 $1$ 的点：\n$$\n\\zeta_{\\text{th}} = \\Delta t L\n$$\n我们可以根据 $\\zeta$ 与此阈值的关系总结其行为：\n- 如果 $\\zeta  \\Delta t L$，则 $g_{\\text{eff}}  1$，解收缩（稳定）。\n- 如果 $\\zeta = \\Delta t L$，则 $g_{\\text{eff}} = 1$，解是中性的（大小恒定）。\n- 如果 $\\zeta > \\Delta t L$，则 $g_{\\text{eff}} > 1$，解发散（不稳定）。\n\n程序将实现这些发现。对于每个测试案例 $(L, \\Delta t, \\zeta, N, y_0)$，我们将计算：\n1. 阈值容忍度：$\\zeta_{\\text{th}} = \\Delta t L$。\n2. 有效放大因子：$g_{\\text{eff}} = (1 + \\zeta) / (1 + \\Delta t L)$。\n3. 发散指示符 $d$：如果 $\\zeta > \\zeta_{\\text{th}}$，则 $d=1$，否则 $d=0$。\n4. $N$ 步后的最终值：$y_N = y_0 \\cdot (g_{\\text{eff}})^N$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the stability properties and final solution value for an inexact\n    implicit Euler method applied to the linear test equation y' = -Ly.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, Delta_t, zeta, N, y0)\n        (10.0, 0.01, 0.05, 50, 1.0),\n        (10.0, 0.01, 0.10, 50, 1.0),\n        (10.0, 0.01, 0.20, 50, 1.0),\n        (1.0, 1.0, 1.01, 50, 1.0),\n        (100.0, 1e-4, 0.011, 50, 1.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        L, delta_t, zeta, N, y0 = case\n\n        # 1. Calculate the stability threshold zeta_th\n        zeta_th = delta_t * L\n\n        # 2. Calculate the effective amplification factor g_eff\n        g_eff = (1.0 + zeta) / (1.0 + delta_t * L)\n\n        # 3. Determine the divergence indicator d\n        # Divergence occurs for zeta  delta_t * L, which is equivalent to g_eff  1.\n        # The problem defines divergence for a strict inequality.\n        d = 1 if zeta > zeta_th else 0\n\n        # 4. Calculate y_N using the derived recurrence y_{n+1} = g_eff * y_n\n        # This is a geometric progression: y_N = y0 * (g_eff)^N\n        y_N = y0 * (g_eff ** N)\n        \n        # Store results for this case\n        case_results = [zeta_th, g_eff, d, y_N]\n        all_results.append(case_results)\n\n    # Format the final output string as a list of lists.\n    # Each float must be rounded to six decimal places.\n    formatted_results = []\n    for res in all_results:\n        zeta_th_str = f\"{res[0]:.6f}\"\n        g_eff_str = f\"{res[1]:.6f}\"\n        d_str = str(res[2])\n        y_N_str = f\"{res[3]:.6f}\"\n        formatted_results.append(f\"[{zeta_th_str},{g_eff_str},{d_str},{y_N_str}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}