{
    "hands_on_practices": [
        {
            "introduction": "守恒律是物理学和计算流体动力学（CFD）的基石，一个理想的数值格式应在离散层面严格遵守这些定律。本练习旨在探讨亚当斯-巴什福斯（Adams–Bashforth）方法在何种条件下能够精确保持线性不变量。理解这一性质对于确保长期模拟的物理真实性至关重要。",
            "id": "3288536",
            "problem": "考虑一个源于计算流体动力学(CFD)的半离散守恒律，它产生一个形式为 $u'(t) = F(u(t))$ 的自治常微分方程(ODEs)系统，其中 $u(t) \\in \\mathbb{R}^{m}$ 且 $F : \\mathbb{R}^{m} \\to \\mathbb{R}^{m}$。令 $I(u) = \\alpha^{\\top} u$ 为一个线性不变量，例如，它代表总离散质量，其中 $\\alpha \\in \\mathbb{R}^{m}$ 是一个固定向量。假设这个不变量被连续动力学精确保守，即对于所有 $u \\in \\mathbb{R}^{m}$，都有 $\\alpha^{\\top} F(u) = 0$。\n\n使用固定步长 $h > 0$ 的 $k$ 步显式 Adams–Bashforth 方法对该常微分方程进行时间离散，定义为\n$$\nu^{n+1} = u^{n} + h \\sum_{j=0}^{k-1} b_{j}\\, F(u^{n-j}),\n$$\n其中 $b_{0}, b_{1}, \\dots, b_{k-1} \\in \\mathbb{R}$ 是方法系数，且 $u^{n} \\approx u(t_{n})$，$t_{n+1} = t_{n} + h$。定义不变量在一个时间步长内的离散变化量为\n$$\nD_{n} := \\alpha^{\\top} u^{n+1} - \\alpha^{\\top} u^{n}.\n$$\n\n从 $I(u)$ 的定义和给定性质 $\\alpha^{\\top} F(u) = 0$ 出发，推导 $D_{n}$ 关于 $h$、$\\alpha$、系数 $b_{j}$ 以及求值 $F(u^{n-j})$ 的表达式，然后计算该表达式的值。根据您的推导，陈述 $k$ 步显式 Adams–Bashforth 方法精确保守线性不变量 $I(u)$ 的条件，并解释为什么即使连续模型保守 $I(u)$，在实际的CFD模拟中仍可能出现与精确保守的偏差。\n\n您的最终答案必须是 $D_{n}$ 的计算结果。不需要四舍五入，最终答案中也不应包含任何物理单位。",
            "solution": "经分析，问题陈述是有效的。它在常微分方程的数值分析领域，特别是在计算流体动力学中的应用方面，具有科学依据。该问题是适定的、客观的、自洽的、一致的。所有必要的定义和条件都已提供，以推导出唯一的、有意义的解。\n\n问题要求推导当一个常微分方程系统 $u'(t) = F(u(t))$ 使用 $k$ 步显式 Adams–Bashforth 方法进行离散化时，线性不变量 $I(u) = \\alpha^{\\top} u$ 的离散变化量。我们已知连续动力学精确保守该不变量，这可以转化为性质 $\\alpha^{\\top} F(u) = 0$ 对所有 $u \\in \\mathbb{R}^{m}$ 成立。\n\n不变量在一个时间步长内的离散变化量定义为：\n$$\nD_{n} := \\alpha^{\\top} u^{n+1} - \\alpha^{\\top} u^{n}\n$$\n\n$k$ 步显式 Adams–Bashforth 方法由以下公式给出：\n$$\nu^{n+1} = u^{n} + h \\sum_{j=0}^{k-1} b_{j}\\, F(u^{n-j})\n$$\n其中 $h$ 是时间步长，$b_{j}$ 是该方法的系数。\n\n为了推导 $D_{n}$ 的表达式，我们将 $u^{n+1}$ 的公式代入 $D_{n}$ 的定义中：\n$$\nD_{n} = \\alpha^{\\top} \\left( u^{n} + h \\sum_{j=0}^{k-1} b_{j}\\, F(u^{n-j}) \\right) - \\alpha^{\\top} u^{n}\n$$\n\n利用转置运算的线性性质，我们可以将 $\\alpha^{\\top}$ 分配到括号内的各项：\n$$\nD_{n} = \\alpha^{\\top} u^{n} + \\alpha^{\\top} \\left( h \\sum_{j=0}^{k-1} b_{j}\\, F(u^{n-j}) \\right) - \\alpha^{\\top} u^{n}\n$$\n\n项 $\\alpha^{\\top} u^{n}$ 和 $-\\alpha^{\\top} u^{n}$ 相互抵消：\n$$\nD_{n} = \\alpha^{\\top} \\left( h \\sum_{j=0}^{k-1} b_{j}\\, F(u^{n-j}) \\right)\n$$\n\n我们可以将标量 $h$ 和 $b_{j}$ 从内积中提出，并将转置分配到求和的每一项：\n$$\nD_{n} = h \\sum_{j=0}^{k-1} b_{j}\\, (\\alpha^{\\top} F(u^{n-j}))\n$$\n\n现在，我们必须使用问题陈述中提供的核心性质：半离散算子 $F$ 精确保守线性不变量 $I(u)$。这表示为：\n$$\n\\alpha^{\\top} F(u) = 0 \\quad \\text{for all } u \\in \\mathbb{R}^{m}\n$$\n此性质对状态空间中的任何向量 $u$ 都成立。因此，它也必然对先前时间步的解 $u^{n}, u^{n-1}, \\dots, u^{n-(k-1)}$ 成立。具体来说，对于求和中的每一项，我们有：\n$$\n\\alpha^{\\top} F(u^{n-j}) = 0 \\quad \\text{for } j = 0, 1, \\dots, k-1\n$$\n\n将此结果代入我们关于 $D_{n}$ 的表达式中：\n$$\nD_{n} = h \\sum_{j=0}^{k-1} b_{j}\\, (0)\n$$\n\n零的和为零，这导出了不变量离散变化量的最终计算表达式：\n$$\nD_{n} = 0\n$$\n\n基于此推导， $k$ 步显式 Adams–Bashforth 方法精确保守线性不变量 $I(u)$ 的条件是，半离散的右端算子 $F(u)$ 本身必须精确保守该不变量。也就是说，该条件恰好是 $\\alpha^{\\top} F(u) = 0$。Adams–Bashforth 方法的结构是 $F$ 求值的线性组合，这确保了如果所有 $F$ 的求值都位于 $\\alpha^{\\top}$ 的零空间中，那么它们的线性组合也位于该零空间中。这意味着数值更新项 $h \\sum b_j F(u^{n-j})$ 与 $\\alpha$ 正交，将其加到 $u^n$ 上不会改变 $\\alpha^{\\top} u^n$ 的值。要使此守恒性质成立，无需对系数 $b_{j}$（除了它们是有限实数）或步长 $h$ 施加任何进一步的条件。\n\n即使底层的连续偏微分方程(PDE)是完全保守的，在实际的CFD模拟中，出现与精确保守的偏差可能有两个主要原因：\n\n$1$. **浮点算术误差**：上述推导假设了无限精度算术。在实际计算中，所有数字都以有限精度的浮点格式表示。即使 $\\alpha^{\\top} F(u)$ 在数学上为零，由于计算 $F(u)$ 和点积所需的大量浮点加法和乘法中的舍入误差，其在计算机上的数值计算结果也可能是一个很小的非零值。这个小误差，我们称之为 $\\epsilon_{n-j}$，意味着计算出的变化量为 $D_{n, \\text{computed}} = h \\sum_{j=0}^{k-1} b_{j} \\epsilon_{n-j}$。这个和通常不为零。经过数千或数百万个时间步，这些小误差会累积起来，导致数值计算出的不变量总值出现显著的“漂移”。\n\n$2$. **非守恒空间离散化**：问题假设半离散系统 $u' = F(u)$ 满足 $\\alpha^{\\top} F(u) = 0$。此性质被称为具有守恒的空间离散化。在实践中，$F(u)$ 是由原始偏微分方程中散度项的空间离散化（例如，有限差分、有限体积、有限元）推导出来的。尽管偏微分方程本身可能是守恒的，但有可能选择一种空间离散格式，该格式在离散层面上不能完美地保持此性质。例如，一个朴素的有限差分格式可能不具备保证守恒的“伸缩求和”性质。在这种情况下，假设 $\\alpha^{\\top} F(u) = 0$ 从一开始就被违反了；相反，我们有 $\\alpha^{\\top} F(u) \\approx 0$，其中误差取决于网格尺寸。时间积分方法于是正确地积分了一个非守恒的常微分方程系统，导致非零的 $D_n$ 和不变量守恒的失败。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "评估一个数值方法不能只看其稳定性和精度阶数，一个更深刻的视角是认识到数值格式求解的并非原始方程，而是一个包含了数值误差的“修正方程”。本练习将深入探讨 AB2 方法的这一概念，通过推导其修正方程，让你能够精确识别影响解的质量和物理真实性的主导数值耗散和色散误差。",
            "id": "3288552",
            "problem": "在计算流体动力学 (CFD) 中，通常在线性测试常微分方程 (ODE) $y'=\\lambda y$ 上分析如 Adams–Bashforth 族之类的显式多步法，以理解其稳定性和误差传播特性。考虑应用于该测试 ODE 的二阶 Adams–Bashforth 方法 (AB$2$)：\n$$\ny_{n+1} \\;=\\; y_n \\;+\\; h\\left(\\tfrac{3}{2} f_n \\;-\\; \\tfrac{1}{2} f_{n-1}\\right), \\quad \\text{其中} \\quad f_k \\;=\\; \\lambda\\, y_k,\n$$\n其中 $h$ 是常数时间步长，$\\lambda \\in \\mathbb{C}$ 是空间离散化算子的特征值，且 $y_n \\approx y(t_n)$，$t_n = n h$。假设存在一个形式如下的修正连续时间 ODE：\n$$\ny'(t) \\;=\\; \\Lambda(h,\\lambda)\\, y(t),\n$$\n对于足够小的 $h$，其在 $t_n$ 处采样的精确解能精确再现 AB$2$ 的离散解。从该方法的定义以及离散放大因子与线性 ODE 精确指数解之间的基本关系出发，通过将离散更新与单时间步内的精确指数传播相匹配，并按 $z \\equiv h \\lambda$ 的幂次展开来推导 $\\Lambda(h,\\lambda)$。请从第一性原理出发进行系统性推导，不要假设任何预先计算好的修正方程。\n\n然后，对于纯振荡情况 $\\lambda = \\mathrm{i}\\,\\omega$（其中 $\\omega$ 为实数），通过分别辨識出 $\\Lambda(h,\\lambda)$ 的虚部和实部，并将其表示为 $h \\omega$ 的幂次形式，来提取出领先阶的色散和耗散贡献。$\\Lambda(h,\\lambda)$ 的展开式必须保留到 $h^3$ 阶项。\n\n请提供 $\\Lambda(h,\\lambda)$ 的单个闭式解析表达式作为最终答案，截断至 $h^3$ 阶。无需单位，无需四舍五入。您的最终答案必须仅为一个表达式。",
            "solution": "问题要求推导修正的连续时间常微分方程 (ODE) $y'(t) = \\Lambda(h,\\lambda) y(t)$ 的算子 $\\Lambda(h,\\lambda)$，该方程的精确解对应于由二阶 Adams–Bashforth (AB$2$) 方法生成的离散解。分析将通过在 $\\Lambda$ 的最终表达式中按 $z \\equiv h \\lambda$ 的幂次展开至 $h^3$ 阶来进行。\n\n应用于测试 ODE $y' = \\lambda y$ 的二阶 Adams–Bashforth 方法由下式给出：\n$$y_{n+1} = y_n + h\\left(\\frac{3}{2} f_n - \\frac{1}{2} f_{n-1}\\right)$$\n其中 $f_k = \\lambda y_k$。将此代入格式，我们得到关于离散解值 $y_k$ 的线性递推关系：\n$$y_{n+1} = y_n + h\\left(\\frac{3}{2} \\lambda y_n - \\frac{1}{2} \\lambda y_{n-1}\\right)$$\n\n修正方程方法的核心假设是，数值解 $\\{y_n\\}$ 精确地位于一个连续函数 $y(t)$ 的轨迹上，该函数是修正 ODE $y'(t) = \\Lambda y(t)$ 的解。算子 $\\Lambda$ 依赖于原始算子 $\\lambda$ 和步长 $h$。\n\n此修正 ODE 的精确解满足 $y(t_2) = \\exp(\\Lambda(t_2-t_1)) y(t_1)$。因此，对于常数步长 $h = t_{n+1} - t_n$，离散值之间通过以下关系联系：\n$$y_{n+1} = y(t_n+h) = \\exp(h\\Lambda) y(t_n) = \\exp(h\\Lambda) y_n$$\n$$y_{n-1} = y(t_n-h) = \\exp(-h\\Lambda) y(t_n) = \\exp(-h\\Lambda) y_n$$\n\n我们将这些关系代入 AB$2$ 递推关系中：\n$$\\exp(h\\Lambda) y_n = y_n + h\\lambda\\left(\\frac{3}{2} y_n - \\frac{1}{2} \\exp(-h\\Lambda) y_n\\right)$$\n假设 $y_n \\neq 0$，我们可以两边同除以 $y_n$，得到一个关于 $\\Lambda$ 的隐式方程：\n$$\\exp(h\\Lambda) = 1 + \\frac{3}{2} h\\lambda - \\frac{1}{2} h\\lambda \\exp(-h\\Lambda)$$\n为了求解 $\\Lambda$，我们引入无量纲变量 $Z = h\\Lambda$ 和 $z = h\\lambda$。方程变为：\n$$\\exp(Z) = 1 + \\frac{3}{2} z - \\frac{1}{2} z \\exp(-Z)$$\n我们现在将指数函数展开为泰勒级数。\n$$\\left(1 + Z + \\frac{Z^2}{2!} + \\frac{Z^3}{3!} + \\frac{Z^4}{4!} + \\dots\\right) = 1 + \\frac{3}{2} z - \\frac{1}{2} z \\left(1 - Z + \\frac{Z^2}{2!} - \\frac{Z^3}{3!} + \\dots\\right)$$\n简化右边项可得：\n$$Z + \\frac{Z^2}{2} + \\frac{Z^3}{6} + \\frac{Z^4}{24} + \\dots = z + \\frac{1}{2} zZ - \\frac{1}{4} zZ^2 + \\frac{1}{12} zZ^3 - \\dots$$\n为了用 $\\lambda$ 表示 $\\Lambda$，我们必须找到 $Z$ 关于 $z$ 的幂级数。我们假设其形式为：\n$$Z = c_1 z + c_2 z^2 + c_3 z^3 + c_4 z^4 + \\dots$$\n将此级数代入方程，并令 $z$ 的各次幂系数相等：\n\n对于 $z^1$ 阶项：\n在左手边 (LHS)，唯一的项是 $c_1 z$。在右手边 (RHS)，唯一的项是 $z$。\n$$c_1 = 1$$\n这证实了该方法是一致的，因为当 $h \\to 0$ 时，$\\Lambda \\to \\lambda$。\n\n对于 $z^2$ 阶项：\nLHS: $c_2 z^2 + \\frac{1}{2}(c_1 z)^2 = (c_2 + \\frac{1}{2}c_1^2)z^2$\nRHS: $\\frac{1}{2} z(c_1 z) = \\frac{1}{2}c_1 z^2$\n令系数相等：$c_2 + \\frac{1}{2}c_1^2 = \\frac{1}{2}c_1$。代入 $c_1=1$，我们得到 $c_2+\\frac{1}{2}=\\frac{1}{2}$，这意味着 $c_2=0$。\n\n对于 $z^3$ 阶项：\nLHS: $c_3 z^3 + \\frac{1}{2}(2c_1c_2 z^3) + \\frac{1}{6}(c_1 z)^3 = (c_3 + c_1 c_2 + \\frac{1}{6}c_1^3)z^3$\nRHS: $\\frac{1}{2} z(c_2 z^2) - \\frac{1}{4} z(c_1 z)^2 = (\\frac{1}{2}c_2 - \\frac{1}{4}c_1^2)z^3$\n令系数相等：$c_3 + c_1 c_2 + \\frac{1}{6}c_1^3 = \\frac{1}{2}c_2 - \\frac{1}{4}c_1^2$。代入 $c_1=1$ 和 $c_2=0$：\n$c_3 + 0 + \\frac{1}{6} = 0 - \\frac{1}{4} \\implies c_3 = -\\frac{1}{4} - \\frac{1}{6} = -\\frac{3+2}{12} = -\\frac{5}{12}$。\n\n对于 $z^4$ 阶项：\nLHS: $c_4 z^4 + \\frac{1}{2}(c_2^2 + 2c_1c_3)z^4 + \\frac{1}{6}(3c_1^2c_2)z^4 + \\frac{1}{24}c_1^4 z^4 = (c_4 + c_1c_3 + \\frac{1}{2}c_2^2 + \\frac{1}{2}c_1^2c_2 + \\frac{1}{24}c_1^4)z^4$\nRHS: $\\frac{1}{2}z(c_3z^3) - \\frac{1}{4}z(2c_1c_2z^3) + \\frac{1}{12}z(c_1z)^3 = (\\frac{1}{2}c_3 - \\frac{1}{2}c_1c_2 + \\frac{1}{12}c_1^3)z^4$\n令系数相等并代入 $c_1=1$，$c_2=0$，$c_3=-5/12$：\nLHS: $c_4 + (1)(-\\frac{5}{12}) + 0 + 0 + \\frac{1}{24} = c_4 - \\frac{10}{24} + \\frac{1}{24} = c_4 - \\frac{9}{24}$\nRHS: $\\frac{1}{2}(-\\frac{5}{12}) - 0 + \\frac{1}{12} = -\\frac{5}{24} + \\frac{2}{24} = -\\frac{3}{24}$\n因此，$c_4 - \\frac{9}{24} = -\\frac{3}{24} \\implies c_4 = \\frac{6}{24} = \\frac{1}{4}$。\n\n收集这些系数，$Z$ 的级数是：\n$$Z = z - \\frac{5}{12}z^3 + \\frac{1}{4}z^4 + \\mathcal{O}(z^5)$$\n代回 $Z=h\\Lambda$ 和 $z=h\\lambda$：\n$$h\\Lambda(h,\\lambda) = h\\lambda - \\frac{5}{12}(h\\lambda)^3 + \\frac{1}{4}(h\\lambda)^4 + \\mathcal{O}(h^5)$$\n两边同除以 $h$，我们得到 $\\Lambda(h,\\lambda)$ 的表达式，截断至 $h^3$ 阶：\n$$\\Lambda(h,\\lambda) = \\lambda - \\frac{5}{12}h^2\\lambda^3 + \\frac{1}{4}h^3\\lambda^4$$\n领先误差项是 $-\\frac{5}{12}h^2\\lambda^3$，这与 AB$2$ 方法是二阶精度相符。\n\n对于纯振荡情况，我们设 $\\lambda = i\\omega$，其中 $\\omega$ 是一个实频率且 $i^2 = -1$。\n$$\\Lambda(h,i\\omega) = i\\omega - \\frac{5}{12}h^2(i\\omega)^3 + \\frac{1}{4}h^3(i\\omega)^4$$\n使用 $i$ 的幂：$i^3 = -i$ 且 $i^4 = 1$。\n$$\\Lambda(h,i\\omega) = i\\omega - \\frac{5}{12}h^2(-i\\omega^3) + \\frac{1}{4}h^3(\\omega^4)$$\n$$\\Lambda(h,i\\omega) = \\frac{1}{4}h^3\\omega^4 + i\\left(\\omega + \\frac{5}{12}h^2\\omega^3\\right)$$\n$\\Lambda$ 的实部和虚部决定了数值解的行为。\n实部 $\\text{Re}(\\Lambda) = \\frac{1}{4}h^3\\omega^4$ 代表数值耗散（或反耗散）。由于其为正，数值格式的振幅会随时间增长（$e^{\\text{Re}(\\Lambda)t}$），而不是衰减。这是一种数值反耗散或不稳定性的表现，其效应为 $h^3$ 阶。这是领先阶的幅度误差贡献。\n虚部 $\\text{Im}(\\Lambda) = \\omega + \\frac{5}{12}h^2\\omega^3$ 代表修正的振荡频率。项 $\\frac{5}{12}h^2\\omega^3$ 是领先阶数值色散误差。由于其为正，高频分量（较大的 $\\omega$）在数值上传播得比它们的真实速度更快，从而导致相位误差。\n\n问题要求提供 $\\Lambda(h,\\lambda)$ 的单个闭式表达式，截断至 $h^3$ 阶。这就是在对振荡情况进行具体分析之前推导出的表达式。",
            "answer": "$$\\boxed{\\lambda - \\frac{5}{12}h^2\\lambda^3 + \\frac{1}{4}h^3\\lambda^4}$$"
        },
        {
            "introduction": "在计算流体动力学中，最高效的方法通常是在最短计算时间内获得所需精度解的方法。本练习将亚当斯-巴什福斯方法与另一主流的龙格-库塔（Runge–Kutta）方法进行直接的性能对决。通过这项实践，你将学会如何量化分析在“每步计算成本”与“稳定性所限制的时间步长”之间的根本性权衡。",
            "id": "3288534",
            "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a > 0$ 为常数，定义在长度为 $L$ 的周期性域上，并用 $N$ 个点的均匀网格进行离散，网格间距为 $h = L/N$。使用一阶迎风有限差分进行空间离散化，以产生一个半离散常微分方程组。从后向差分算子的离散傅里叶模态分析出发，确定半离散算子的特征值集合，并找出对于显式方法时间步进最具限制性的特征值。\n\n您将比较三阶 Adams–Bashforth 显式多步法 (AB3) 与经典的三阶三步 Runge–Kutta 方法 (RK3)。利用每个时间积分器的线性绝对稳定域和您得到的最坏情况下的半离散特征值，计算每种方法的最大稳定时间步长 $\\Delta t_{\\max}$。然后，利用 AB3 每时间步的右端项 (RHS) 求值次数为 $1$、RK3 为 $3$ 这一事实，计算 AB3 和 RK3 之间单位模拟时间的计算成本之比，定义为\n$$\n\\mathcal{R} \\equiv \\frac{\\text{AB3 单位模拟时间的 RHS 求值次数}}{\\text{RK3 单位模拟时间的 RHS 求值次数}}。\n$$\n假设每次 RHS 求值的计算成本相等，并且在长时间极限下，多步法的启动成本可以忽略不计。\n\n报告 $\\mathcal{R}$ 的值，以单一数字形式给出，四舍五入到四位有效数字。最终答案不需要单位。",
            "solution": "该问题是有效的，因为它科学地基于偏微分方程数值分析的原理，是适定的、客观的，并包含推导唯一解所需的所有必要信息。\n\n该问题要求比较三阶 Adams–Bashforth (AB3) 方法和经典的三阶三步 Runge–Kutta (RK3) 方法在一维线性平流方程 $u_{t} + a\\,u_{x} = 0$（其中平流速度 $a > 0$ 为常数）上的计算效率。分析按以下步骤进行：空间离散化、离散算子的特征值分析、时间积分器的稳定性分析，最后是计算成本比。\n\n**步骤 1：半离散化与特征值分析**\n空间域用间距为 $h$ 的均匀网格进行离散。对于平流方程 $u_t = -a u_x$，当 $a > 0$ 时，一阶迎风有限差分格式使用一阶后向差分来计算空间导数 $u_x$。在网格点 $x_j$ 处，这由下式给出：\n$$\nu_x(x_j) \\approx \\frac{u_j - u_{j-1}}{h}\n$$\n其中 $u_j(t)$ 是 $u(x_j, t)$ 的数值近似。将此代入 PDE，得到一个常微分方程组 (ODEs)，每个网格点 $j$ 对应一个方程：\n$$\n\\frac{d u_j}{dt} = -\\frac{a}{h} (u_j - u_{j-1})\n$$\n这是方程的半离散形式，可以写成向量形式 $\\frac{d\\mathbf{u}}{dt} = \\mathbf{L}\\mathbf{u}$，其中 $\\mathbf{L}$ 是空间离散化算子。\n\n为了找到算子 $\\mathbf{L}$ 的特征值，我们进行离散傅里叶模态分析。我们考虑单个傅里叶模态作为解：\n$$\nu_j(t) = \\hat{u}_k(t) \\exp(i k x_j) = \\hat{u}_k(t) \\exp(i k j h)\n$$\n其中 $k$ 是波数，$\\hat{u}_k(t)$ 是模态的时间相关振幅。将此代入半离散方程得到：\n$$\n\\frac{d}{dt} \\left( \\hat{u}_k(t) \\exp(i k j h) \\right) = -\\frac{a}{h} \\left( \\hat{u}_k(t) \\exp(i k j h) - \\hat{u}_k(t) \\exp(i k (j-1) h) \\right)\n$$\n两边除以公共因子 $\\exp(i k j h)$，得到模态振幅 $\\hat{u}_k(t)$ 的 ODE：\n$$\n\\frac{d \\hat{u}_k}{dt} = -\\frac{a}{h} \\left( 1 - \\exp(-i k h) \\right) \\hat{u}_k(t)\n$$\n这具有 $\\frac{d\\hat{u}_k}{dt} = \\lambda_k \\hat{u}_k$ 的形式，其中 $\\lambda_k$ 是算子 $\\mathbf{L}$ 的特征值。令 $\\theta = kh$ 为无量纲波数，其范围从 $0$ 到 $2\\pi$，以完全表示网格可分辨的波。特征值由下式给出：\n$$\n\\lambda(\\theta) = -\\frac{a}{h} (1 - \\exp(-i\\theta)) = -\\frac{a}{h} (1 - \\cos\\theta + i\\sin\\theta)\n$$\n这些特征值位于复平面的一个圆上。为了看清这一点，令 $\\lambda = \\lambda_x + i\\lambda_y$。那么 $\\lambda_x = -\\frac{a}{h}(1-\\cos\\theta)$ 且 $\\lambda_y = -\\frac{a}{h}\\sin\\theta$。重新整理可得 $\\lambda_x + \\frac{a}{h} = \\frac{a}{h}\\cos\\theta$ 和 $\\lambda_y = -\\frac{a}{h}\\sin\\theta$。将这两个方程平方并相加，得到：\n$$\n\\left(\\lambda_x + \\frac{a}{h}\\right)^2 + \\lambda_y^2 = \\left(\\frac{a}{h}\\right)^2\n$$\n这是复平面上一个圆心为 $(-\\frac{a}{h}, 0)$、半径为 $\\frac{a}{h}$ 的圆的方程。特征值谱就是这个圆，它穿过原点（对于 $\\theta=0$）并延伸到负实轴上的点 $(-2a/h, 0)$（对于 $\\theta=\\pi$）。\n\n为了使显式时间积分方法稳定，对于所有特征值 $\\lambda_k$，量 $z_k = \\Delta t \\lambda_k$ 必须位于该方法的绝对稳定域 $S$ 内。缩放后的特征值集合 $\\{z_k\\}$ 也形成一个圆，由 $|z + \\nu| = \\nu$ 定义，其中 $\\nu = \\frac{a \\Delta t}{h}$ 是库朗数。为保证稳定性，整个圆必须被包含在 $S$ 内。\n\n对于时间步进最具限制性的特征值是当 $\\Delta t$ 增加时首先导致不稳定性的那个特征值。对于像 AB 和 RK 方法那样的、在负实轴上有界的稳定域，这通常由离原点最远且位于负实轴上的特征值决定。这对应于 $\\theta = \\pi$：\n$$\n\\lambda_{\\text{worst}} = \\lambda(\\pi) = -\\frac{a}{h} (1 - \\exp(-i\\pi)) = -\\frac{a}{h} (1 - (-1)) = -\\frac{2a}{h}\n$$\n\n**步骤 2：稳定性极限与最大时间步长**\n显式方法的稳定域通常与负实轴相交于一个区间 $[-\\beta, 0]$。整个缩放后特征值谱的稳定性要求圆 $|z+\\nu|=\\nu$ 的最左点 $z = -2\\nu$ 必须在此区间内。这意味着 $|-2\\nu| \\le \\beta$，即：\n$$\n2\\nu \\le \\beta \\implies \\nu_{\\max} = \\frac{\\beta}{2}\n$$\n因此，最大稳定时间步长 $\\Delta t_{\\max}$ 与 $\\beta$ 的关系为：\n$$\n\\frac{a \\Delta t_{\\max}}{h} = \\nu_{\\max} = \\frac{\\beta}{2} \\implies \\Delta t_{\\max} = \\frac{h \\beta}{2a}\n$$\n现在我们需要 AB3 和 RK3 方法的稳定性截距 $\\beta$。\n- 对于三阶 Adams-Bashforth (AB3) 方法，其在负实轴上的稳定性边界是一个标准结果，$\\beta_{\\text{AB3}} = \\frac{6}{11}$。\n- 对于经典的三阶三步 Runge-Kutta (RK3) 方法，其稳定函数为 $R(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!}$。稳定性边界 $\\beta_{\\text{RK3}}$ 是 $|R(-x)|=1$ 的正根，这导向方程 $x^3 - 3x^2 + 6x - 12 = 0$。其数值解为 $\\beta_{\\text{RK3}} \\approx 2.512745$。\n\n最大稳定时间步长为：\n$$\n\\Delta t_{\\max, \\text{AB3}} = \\frac{h \\beta_{\\text{AB3}}}{2a} = \\frac{h}{2a} \\frac{6}{11} = \\frac{3h}{11a}\n$$\n$$\n\\Delta t_{\\max, \\text{RK3}} = \\frac{h \\beta_{\\text{RK3}}}{2a} \\approx \\frac{h}{2a} (2.512745)\n$$\n\n**步骤 3：计算成本比**\n计算成本由单位模拟时间的右端项 (RHS) 求值次数来衡量。对于给定的方法，这是：\n$$\n\\text{成本} = \\frac{\\text{每时间步的 RHS 求值次数}}{\\text{每时间步的模拟时间}} = \\frac{N_{RHS}}{\\Delta t_{\\max}}\n$$\n给定 $N_{RHS, \\text{AB3}} = 1$ 和 $N_{RHS, \\text{RK3}} = 3$。比率 $\\mathcal{R}$ 定义为：\n$$\n\\mathcal{R} = \\frac{\\text{成本}_{\\text{AB3}}}{\\text{成本}_{\\text{RK3}}} = \\frac{N_{RHS, \\text{AB3}}/\\Delta t_{\\max, \\text{AB3}}}{N_{RHS, \\text{RK3}}/\\Delta t_{\\max, \\text{RK3}}} = \\frac{1/\\Delta t_{\\max, \\text{AB3}}}{3/\\Delta t_{\\max, \\text{RK3}}} = \\frac{1}{3} \\frac{\\Delta t_{\\max, \\text{RK3}}}{\\Delta t_{\\max, \\text{AB3}}}\n$$\n代入最大时间步长的表达式：\n$$\n\\mathcal{R} = \\frac{1}{3} \\frac{h \\beta_{\\text{RK3}} / (2a)}{h \\beta_{\\text{AB3}} / (2a)} = \\frac{1}{3} \\frac{\\beta_{\\text{RK3}}}{\\beta_{\\text{AB3}}}\n$$\n现在，我们代入 $\\beta_{\\text{AB3}}$ 和 $\\beta_{\\text{RK3}}$ 的值：\n$$\n\\mathcal{R} = \\frac{1}{3} \\frac{\\beta_{\\text{RK3}}}{6/11} = \\frac{11 \\beta_{\\text{RK3}}}{18}\n$$\n使用 $\\beta_{\\text{RK3}}$ 的数值：\n$$\n\\mathcal{R} = \\frac{11 \\times 2.512745}{18} \\approx \\frac{27.640195}{18} \\approx 1.53556638...\n$$\n四舍五入到四位有效数字，计算成本之比为 $1.536$。由于 $\\mathcal{R} > 1$，对于这个特定问题，AB3 方法的计算成本比 RK3 方法更高。这意味着，为了达到稳定性，AB3需要的时间步长太小，以至于其单步求值次数少的优势被抵消了，使得RK3方法在此场景下总体效率更高。",
            "answer": "$$\\boxed{1.536}$$"
        }
    ]
}