{
    "hands_on_practices": [
        {
            "introduction": "This first exercise lays the foundational principles of dual time stepping. By analyzing a simple one-dimensional scalar advection problem, you will derive the explicit pseudo-time update rule from first principles . The core task is to perform a stability analysis to determine the maximum allowable pseudo-time step, which reveals the fundamental link between the numerical scheme and the physical properties of the system.",
            "id": "3313256",
            "problem": "Consider a one-dimensional inviscid scalar conservation law on a periodic domain of length $L$ with a constant positive advection speed $a>0$, governed by $\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0$ with $f(u) = a u$. Discretize the domain into $N$ uniform finite volumes of width $\\Delta x = \\frac{L}{N}$, and let $u_i$ denote the cell-averaged state in cell $i$. Use the first-order upwind numerical flux for $a>0$ and define the finite-volume semi-discrete residual in each cell $i$ as $R_i(U) = F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}$, where $U = (u_1,\\dots,u_N)^{\\top}$ and the periodic boundary condition couples cell $N$ back to cell $1$. Let the mass matrix $M$ be the diagonal matrix of cell volumes, so $M_{ii} = \\Delta x$.\n\nTo accelerate convergence to the steady state $R(U) = 0$, introduce a pseudo-time $\\tau$ and consider explicit forward Euler integration in pseudo-time for the semi-discrete ordinary differential equation $M \\frac{dU}{d\\tau} = - R(U)$. Starting from fundamental finite-volume definitions and the first-order upwind flux for $a>0$, derive the explicit componentwise pseudo-time update $u_i^{k+1}$ as a function of $u_i^k$ and its neighbors at iteration $k$.\n\nDefine the discrete residual $\\ell_1$ norm at iteration $k$ by $\\|R(U^k)\\|_1 = \\sum_{i=1}^{N} |R_i(U^k)|$. Using only first principles and well-tested properties of monotone upwind discretizations, identify a condition on the pseudo-time step $\\Delta \\tau$ that is sufficient to guarantee that the sequence $\\|R(U^k)\\|_1$ is monotonically nonincreasing in $k$. Finally, from this condition, determine the largest allowable pseudo-time step $\\Delta \\tau_{\\max}$ that guarantees monotone nonincreasing residual norm in pseudo-time. Express your final answer for $\\Delta \\tau_{\\max}$ in seconds as a closed-form analytic expression (no inequality).",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- **Governing Equation**: A one-dimensional inviscid scalar conservation law, $\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0$.\n- **Flux Function**: $f(u) = a u$, with $a > 0$ being a constant advection speed.\n- **Domain**: A periodic domain of length $L$.\n- **Discretization**: Finite volume method with $N$ uniform cells of width $\\Delta x = \\frac{L}{N}$.\n- **State Variable**: $u_i$ is the cell-averaged state in cell $i$. $U = (u_1, \\dots, u_N)^{\\top}$.\n- **Numerical Flux**: First-order upwind numerical flux for $a>0$.\n- **Semi-discrete Residual**: $R_i(U) = F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}$, where $F$ is the numerical flux.\n- **Boundary Condition**: Periodic, coupling cell $N$ to cell $1$.\n- **Mass Matrix**: Diagonal matrix $M$ with $M_{ii} = \\Delta x$.\n- **Pseudo-time Integration**: Explicit forward Euler for the ODE $M \\frac{dU}{d\\tau} = -R(U)$, where $\\tau$ is the pseudo-time.\n- **Residual Norm**: Discrete $\\ell_1$ norm at iteration $k$ is $\\|R(U^k)\\|_1 = \\sum_{i=1}^{N} |R_i(U^k)|$.\n- **Objective 1**: Derive the explicit componentwise pseudo-time update $u_i^{k+1}$.\n- **Objective 2**: Find a condition on the pseudo-time step $\\Delta \\tau$ sufficient for $\\|R(U^{k+1})\\|_1 \\leq \\|R(U^k)\\|_1$.\n- **Objective 3**: Determine the largest allowable pseudo-time step $\\Delta \\tau_{\\max}$ from this condition.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem describes a standard technique (dual time stepping with explicit Euler) for finding the steady-state solution of a discretized partial differential equation (the 1D linear advection equation). This is a classical topic in computational fluid dynamics (CFD) and numerical analysis.\n- **Well-Posed**: The problem is well-posed. It asks for the derivation of an update rule and a stability condition, which have unique and meaningful solutions based on the provided framework.\n- **Objective**: The language is precise, mathematical, and free of any subjective or opinion-based statements.\n- **Completeness and Consistency**: All necessary components for the derivation are provided: the governing equation, the flux, the discretization scheme, the time-stepping method, and the objective criteria. The setup is internally consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution will be provided.\n\nThe semi-discrete form of the governing equation, used for accelerating to a steady state, is given by introducing a pseudo-time variable $\\tau$:\n$$\nM \\frac{dU}{d\\tau} = -R(U)\n$$\nHere, $M$ is the diagonal mass matrix with entries $M_{ii} = \\Delta x$, $U$ is the vector of cell-averaged states, and $R(U)$ is the vector of residuals. Writing this equation for a single cell $i$ gives:\n$$\n\\Delta x \\frac{du_i}{d\\tau} = -R_i(U)\n$$\nDiscretizing this ordinary differential equation in pseudo-time using the explicit forward Euler method with a time step $\\Delta \\tau$ yields:\n$$\n\\Delta x \\frac{u_i^{k+1} - u_i^k}{\\Delta \\tau} = -R_i(U^k)\n$$\nwhere $k$ is the pseudo-time iteration index. Solving for the updated state $u_i^{k+1}$, we get:\n$$\nu_i^{k+1} = u_i^k - \\frac{\\Delta \\tau}{\\Delta x} R_i(U^k)\n$$\nThis is the general form of the pseudo-time update. To make it explicit, we must evaluate the residual term $R_i(U^k)$. The residual for cell $i$ is defined as the net flux across its boundaries:\n$$\nR_i(U) = F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\n$$\nwhere $F_{i+\\frac{1}{2}}$ is the numerical flux at the interface between cell $i$ and cell $i+1$. The problem specifies a first-order upwind scheme. For a constant positive advection speed $a>0$, the \"upwind\" direction is from the cell with the lower index. Therefore, the state used to evaluate the flux at interface $i+\\frac{1}{2}$ is the state in cell $i$, which is $u_i$.\n$$\nF_{i+\\frac{1}{2}} = f(u_i) = a u_i\n$$\nSimilarly, the numerical flux at the interface $i-\\frac{1}{2}$ (between cell $i-1$ and cell $i$) depends on the state in cell $i-1$:\n$$\nF_{i-\\frac{1}{2}} = f(u_{i-1}) = a u_{i-1}\n$$\nSubstituting these flux expressions into the residual definition gives:\n$$\nR_i(U^k) = a u_i^k - a u_{i-1}^k = a(u_i^k - u_{i-1}^k)\n$$\n(Due to periodicity, $u_0$ is understood as $u_N$.)\nNow, we substitute this explicit form of the residual into the pseudo-time update equation to obtain the first required result:\n$$\nu_i^{k+1} = u_i^k - \\frac{\\Delta \\tau}{\\Delta x} a(u_i^k - u_{i-1}^k)\n$$\n\nNext, we seek a condition on $\\Delta \\tau$ that guarantees the monotonic non-increase of the discrete residual $\\ell_1$ norm, i.e., $\\|R(U^{k+1})\\|_1 \\le \\|R(U^k)\\|_1$. We begin by finding an evolution equation for the residual itself. The residual at pseudo-time step $k+1$ is:\n$$\nR_i(U^{k+1}) = a(u_i^{k+1} - u_{i-1}^{k+1})\n$$\nWe substitute the update expressions for $u_i^{k+1}$ and $u_{i-1}^{k+1}$:\n$$\nu_i^{k+1} = u_i^k - \\frac{a \\Delta \\tau}{\\Delta x} (u_i^k - u_{i-1}^k) = u_i^k - \\frac{\\Delta \\tau}{\\Delta x} R_i(U^k)\n$$\n$$\nu_{i-1}^{k+1} = u_{i-1}^k - \\frac{a \\Delta \\tau}{\\Delta x} (u_{i-1}^k - u_{i-2}^k) = u_{i-1}^k - \\frac{\\Delta \\tau}{\\Delta x} R_{i-1}(U^k)\n$$\nSubstituting these into the expression for $R_i(U^{k+1})$:\n$$\nR_i(U^{k+1}) = a \\left[ \\left(u_i^k - \\frac{\\Delta \\tau}{\\Delta x} R_i(U^k)\\right) - \\left(u_{i-1}^k - \\frac{\\Delta \\tau}{\\Delta x} R_{i-1}(U^k)\\right) \\right]\n$$\n$$\nR_i(U^{k+1}) = a(u_i^k - u_{i-1}^k) - \\frac{a \\Delta \\tau}{\\Delta x} \\left( R_i(U^k) - R_{i-1}(U^k) \\right)\n$$\nRecognizing that $a(u_i^k - u_{i-1}^k) = R_i(U^k)$, we have:\n$$\nR_i^{k+1} = R_i^k - \\frac{a \\Delta \\tau}{\\Delta x} (R_i^k - R_{i-1}^k)\n$$\nLet's define the non-dimensional parameter $C = \\frac{a \\Delta \\tau}{\\Delta x}$. Rearranging the equation for $R_i^{k+1}$:\n$$\nR_i^{k+1} = (1 - C) R_i^k + C R_{i-1}^k\n$$\nThis is an upwind scheme for the advection of the residual itself. We now analyze the $\\ell_1$ norm of $R^{k+1}$:\n$$\n\\|R^{k+1}\\|_1 = \\sum_{i=1}^{N} |R_i^{k+1}| = \\sum_{i=1}^{N} |(1 - C) R_i^k + C R_{i-1}^k|\n$$\nUsing the triangle inequality, $|x+y| \\le |x|+|y|$:\n$$\n\\|R^{k+1}\\|_1 \\le \\sum_{i=1}^{N} \\left( |1 - C| |R_i^k| + |C| |R_{i-1}^k| \\right)\n$$\nSeparating the sums:\n$$\n\\|R^{k+1}\\|_1 \\le |1 - C| \\sum_{i=1}^{N} |R_i^k| + |C| \\sum_{i=1}^{N} |R_{i-1}^k|\n$$\nDue to the periodic boundary conditions, the sum over the shifted index $i-1$ is equal to the sum over the index $i$: $\\sum_{i=1}^{N} |R_{i-1}^k| = \\sum_{j=0}^{N-1} |R_j^k| = \\sum_{j=1}^{N} |R_j^k| = \\|R^k\\|_1$.\nTherefore, the inequality becomes:\n$$\n\\|R^{k+1}\\|_1 \\le (|1 - C| + |C|) \\|R^k\\|_1\n$$\nFor the residual norm to be monotonically non-increasing ($\\|R^{k+1}\\|_1 \\le \\|R^k\\|_1$), a sufficient condition is:\n$$\n|1 - C| + |C| \\le 1\n$$\nSince $a > 0$, $\\Delta \\tau > 0$ (for a forward step), and $\\Delta x > 0$, the parameter $C = \\frac{a \\Delta \\tau}{\\Delta x}$ is strictly positive. So, $|C| = C$. The condition becomes:\n$$\n|1 - C| + C \\le 1\n$$\nWe analyze this condition for $C > 0$.\n- If $0 < C \\le 1$, then $1 - C \\ge 0$, so $|1 - C| = 1 - C$. The condition is $(1 - C) + C \\le 1$, which simplifies to $1 \\le 1$. This is always true.\n- If $C > 1$, then $1 - C < 0$, so $|1 - C| = -(1 - C) = C - 1$. The condition is $(C - 1) + C \\le 1$, which simplifies to $2C - 1 \\le 1$, or $2C \\le 2$, or $C \\le 1$. This contradicts the assumption that $C > 1$.\nThus, the sufficient condition for monotonic non-increase of the residual norm is $0 < C \\le 1$. In terms of the physical parameters, this is:\n$$\n0 < \\frac{a \\Delta \\tau}{\\Delta x} \\le 1\n$$\nFinally, we must determine the largest allowable pseudo-time step, $\\Delta \\tau_{\\max}$, that guarantees this condition. This maximum value is obtained at the upper boundary of the inequality:\n$$\n\\frac{a \\Delta \\tau_{\\max}}{\\Delta x} = 1\n$$\nSolving for $\\Delta \\tau_{\\max}$ gives the final answer:\n$$\n\\Delta \\tau_{\\max} = \\frac{\\Delta x}{a}\n$$\nThe units are $[\\text{Length}] / ([\\text{Length}]/[\\text{Time}]) = [\\text{Time}]$, which is seconds in SI units, as required.",
            "answer": "$$\\boxed{\\frac{\\Delta x}{a}}$$"
        },
        {
            "introduction": "Moving beyond simple stability, this practice explores how to optimize the convergence rate of the pseudo-time iteration. By framing a general linear problem in terms of its iteration matrix, you will use spectral analysis to find the pseudo-time step that provides the fastest error decay . This exercise demonstrates how understanding the eigenvalue spectrum of the discrete operator is crucial for designing an efficient acceleration strategy.",
            "id": "3313273",
            "problem": "Consider a steady, linear convection–diffusion boundary value problem discretized on a bounded domain with Dirichlet boundary conditions, yielding an algebraic residual of the form $R(U)=A\\,U-b$, where $A \\in \\mathbb{R}^{n \\times n}$ is a matrix arising from a consistent, second-order spatial discretization. Assume that $A$ is diagonalizable with a real, positive spectrum bounded as $0<\\lambda_{\\min}\\leq \\lambda \\leq \\lambda_{\\max}$ for all eigenvalues $\\lambda$ of $A$, which is a typical property of stabilized discretizations of convection–diffusion that produce an $M$-matrix. To accelerate convergence to the steady state $R(U)=0$, introduce a pseudo-time $\\tau$ and consider the dual time stepping evolution equation $\\,\\frac{dU}{d\\tau}=-R(U)\\,$. Using a forward Euler pseudo-time integrator with pseudo-time step $\\Delta \\tau>0$, form the linear fixed-point iteration for $U(\\tau)$, and derive the corresponding iteration matrix in terms of $A$ and $\\Delta \\tau$. Define the pseudo-time Courant–Friedrichs–Lewy (CFL) number as $\\,CFL_{\\tau}=\\Delta \\tau\\,\\rho(A)\\,$, where $\\rho(A)$ is the spectral radius of $A$. Express the spectral radius of the iteration matrix as a function of $CFL_{\\tau}$ and the spectral condition number $\\kappa=\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$. Then, determine the value of $CFL_{\\tau}$ that minimizes the spectral radius of the iteration matrix over all positive $\\Delta \\tau$, assuming $\\lambda_{\\min}$ and $\\lambda_{\\max}$ are fixed. Provide your final answer as a single, closed-form expression for the optimal $CFL_{\\tau}$ in terms of $\\kappa$. The answer is dimensionless. No numerical rounding is required; express the final answer exactly, in analytic form.",
            "solution": "The problem as stated is scientifically sound, self-contained, and well-posed. It describes a standard method in numerical analysis for accelerating the convergence of iterative solvers for linear systems, framed within the context of computational fluid dynamics. All terms are formally defined, and the premises are consistent with established mathematical principles. Therefore, a solution can be derived.\n\nThe problem seeks to find the steady-state solution to a system of linear equations, $A\\,U - b = 0$, by recasting it as a time-dependent problem. The governing equation for the pseudo-time evolution of the state vector $U$ is given as:\n$$\n\\frac{dU}{d\\tau} = -R(U)\n$$\nwhere $\\tau$ is the pseudo-time and $R(U) = A\\,U - b$ is the residual. Substituting the expression for the residual, we obtain a linear ordinary differential equation:\n$$\n\\frac{dU}{d\\tau} = -(A\\,U - b) = b - A\\,U\n$$\nTo solve this equation numerically, we apply the forward Euler method with a pseudo-time step $\\Delta \\tau > 0$. Let $U^k$ denote the approximation of $U$ at pseudo-time $\\tau_k = k\\,\\Delta \\tau$. The forward Euler discretization is:\n$$\n\\frac{U^{k+1} - U^k}{\\Delta \\tau} = b - A\\,U^k\n$$\nRearranging this equation yields the linear fixed-point iteration:\n$$\nU^{k+1} = U^k + \\Delta \\tau (b - A\\,U^k) = (I - \\Delta \\tau A)U^k + \\Delta \\tau b\n$$\nThis is an iterative scheme of the form $U^{k+1} = G U^k + c$, where the iteration matrix is $G = I - \\Delta \\tau A$, and $c = \\Delta \\tau b$.\n\nThe convergence rate of this iteration is determined by the spectral radius of the iteration matrix $G$, denoted $\\rho(G)$. The iteration converges if and only if $\\rho(G) < 1$. To achieve the fastest convergence, we must find the value of $\\Delta \\tau$ that minimizes $\\rho(G)$.\n\nThe matrix $A$ is given to be diagonalizable with a real, positive spectrum of eigenvalues $\\lambda$, where $0 < \\lambda_{\\min} \\leq \\lambda \\leq \\lambda_{\\max}$. Let $\\sigma(A)$ be the set of eigenvalues of $A$. If $\\lambda \\in \\sigma(A)$, then the corresponding eigenvalue $\\mu$ of the iteration matrix $G = I - \\Delta \\tau A$ is given by:\n$$\n\\mu = 1 - \\Delta \\tau \\lambda\n$$\nThe spectral radius of $G$ is the maximum absolute value of its eigenvalues:\n$$\n\\rho(G) = \\max_{\\mu \\in \\sigma(G)} |\\mu| = \\max_{\\lambda \\in \\sigma(A)} |1 - \\Delta \\tau \\lambda|\n$$\nSince the function $f(\\lambda) = 1 - \\Delta \\tau \\lambda$ is linear and monotonic in $\\lambda$, the extreme values of $f(\\lambda)$ over the interval $[\\lambda_{\\min}, \\lambda_{\\max}]$ will occur at the endpoints $\\lambda_{\\min}$ and $\\lambda_{\\max}$. Therefore, the spectral radius is the maximum of the absolute values at these endpoints:\n$$\n\\rho(G) = \\max \\left( |1 - \\Delta \\tau \\lambda_{\\min}|, |1 - \\Delta \\tau \\lambda_{\\max}| \\right)\n$$\nNext, we express this in terms of the pseudo-time CFL number, $CFL_{\\tau} = \\Delta \\tau\\,\\rho(A)$, and the spectral condition number, $\\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$. The spectral radius of $A$, for a matrix with a real positive spectrum, is $\\rho(A) = \\lambda_{\\max}$. Thus, we can write $\\Delta \\tau = \\frac{CFL_{\\tau}}{\\lambda_{\\max}}$. We also have $\\lambda_{\\min} = \\frac{\\lambda_{\\max}}{\\kappa}$.\n\nSubstituting these expressions into the terms for $\\rho(G)$:\n$$\n1 - \\Delta \\tau \\lambda_{\\min} = 1 - \\left(\\frac{CFL_{\\tau}}{\\lambda_{\\max}}\\right) \\left(\\frac{\\lambda_{\\max}}{\\kappa}\\right) = 1 - \\frac{CFL_{\\tau}}{\\kappa}\n$$\n$$\n1 - \\Delta \\tau \\lambda_{\\max} = 1 - \\left(\\frac{CFL_{\\tau}}{\\lambda_{\\max}}\\right) \\lambda_{\\max} = 1 - CFL_{\\tau}\n$$\nThe spectral radius of the iteration matrix as a function of $CFL_{\\tau}$ and $\\kappa$ is therefore:\n$$\n\\rho(G) = \\max\\left( \\left|1 - \\frac{CFL_{\\tau}}{\\kappa}\\right|, |1 - CFL_{\\tau}| \\right)\n$$\nOur goal is to find the value of $CFL_{\\tau} > 0$ that minimizes this function. The minimum of the maximum of two functions is typically found where the values of the functions are equal. We seek to balance the magnitudes of the two extreme eigenvalues of $G$. For stability, we require $\\rho(G) < 1$, which implies $|1 - CFL_{\\tau}| < 1$, leading to $0 < CFL_{\\tau} < 2$. In this range, the term $1 - \\frac{CFL_{\\tau}}{\\kappa}$ is positive because $\\kappa \\geq 1$ and $CFL_{\\tau} < 2$, so $\\frac{CFL_{\\tau}}{\\kappa} < 2$. The term $1 - CFL_{\\tau}$ can be positive or negative. The optimal convergence rate is achieved when the magnitudes of the two arguments are equal and minimized. This occurs when one argument is the negative of the other:\n$$\n1 - \\Delta \\tau \\lambda_{\\min} = -(1 - \\Delta \\tau \\lambda_{\\max})\n$$\nThis ensures that the spectral interval of $G$, which is $[1 - \\Delta \\tau \\lambda_{\\max}, 1 - \\Delta \\tau \\lambda_{\\min}]$, is centered symmetrically around zero, minimizing its maximum absolute value.\nSolving this equation for $\\Delta \\tau$:\n$$\n1 - \\Delta \\tau \\lambda_{\\min} = \\Delta \\tau \\lambda_{\\max} - 1\n$$\n$$\n2 = \\Delta \\tau (\\lambda_{\\min} + \\lambda_{\\max})\n$$\n$$\n\\Delta \\tau_{\\text{opt}} = \\frac{2}{\\lambda_{\\min} + \\lambda_{\\max}}\n$$\nNow, we convert this optimal pseudo-time step into the optimal pseudo-time CFL number, $CFL_{\\tau, \\text{opt}}$:\n$$\nCFL_{\\tau, \\text{opt}} = \\Delta \\tau_{\\text{opt}} \\cdot \\rho(A) = \\left( \\frac{2}{\\lambda_{\\min} + \\lambda_{\\max}} \\right) \\lambda_{\\max} = \\frac{2\\lambda_{\\max}}{\\lambda_{\\min} + \\lambda_{\\max}}\n$$\nFinally, to express this result in terms of the spectral condition number $\\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$, we divide the numerator and denominator by $\\lambda_{\\min}$:\n$$\nCFL_{\\tau, \\text{opt}} = \\frac{2 \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}}{\\frac{\\lambda_{\\min}}{\\lambda_{\\min}} + \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}} = \\frac{2\\kappa}{1 + \\kappa}\n$$\nThis is the value of the pseudo-time CFL number that minimizes the spectral radius of the forward Euler iteration matrix, thereby maximizing the convergence rate to the steady-state solution.",
            "answer": "$$\\boxed{\\frac{2\\kappa}{1+\\kappa}}$$"
        },
        {
            "introduction": "Real-world CFD problems are often \"stiff,\" characterized by physical processes occurring on vastly different time scales. This final practice uses a simple model equation to demonstrate why explicit methods become prohibitively expensive for such systems, requiring impractically small steps to maintain stability . By comparing the iteration counts of explicit forward Euler and implicit backward Euler schemes, you will gain a concrete understanding of the unconditional stability of implicit methods and why they are essential for robustly solving stiff problems.",
            "id": "3313197",
            "problem": "Consider steady-state acceleration by dual time stepping for a single linearized residual mode. Let the pseudo-time error amplitude $e(\\tau)$ evolve under the scalar test equation derived from linearization of the residual operator about a steady solution, namely the ordinary differential equation $de/d\\tau = -\\lambda\\, e$ with $\\lambda \\gt 0$. The inner (pseudo-time) integration is performed either by the explicit forward Euler method or by the implicit backward Euler method. Starting from the normalized initial condition $e(0)=1$, determine the number of pseudo-time iterations required so that the error amplitude is reduced to at most $10^{-6}$.\n\nYou must derive the iteration counts from first principles, beginning with the scalar test equation $de/d\\tau = -\\lambda e$, and then applying the update of each time integration scheme to obtain the per-iteration error amplification factor. Use the following definitions and constraints:\n- Pseudo-time step size is fixed at $\\Delta \\tau = 10^{-5}$ (in seconds).\n- For the explicit forward Euler scheme, use the update that results from discretizing $de/d\\tau = -\\lambda e$ by a single forward Euler step of size $\\Delta \\tau$.\n- For the implicit backward Euler scheme, use the update that results from discretizing $de/d\\tau = -\\lambda e$ by a single backward Euler step of size $\\Delta \\tau$.\n- The required number of iterations, if convergence occurs, is the smallest integer $n$ such that the magnitude of the error after $n$ iterations is at most $10^{-6}$.\n- If the explicit scheme does not strictly reduce the error magnitude (that is, if the magnitude of its amplification factor is greater than or equal to $1$), declare the explicit iteration count as $+\\infty$.\n\nTest suite:\n- Use the six values $\\lambda \\in \\{10^{2},\\,10^{4},\\,2\\times 10^{5},\\,3\\times 10^{5},\\,5\\times 10^{5},\\,10^{6}\\}$.\n- For each $\\lambda$ in the above set, compute a pair of results $[n_{\\text{explicit}}, n_{\\text{implicit}}]$, where each entry is the integer iteration count if finite, and $+\\infty$ if non-convergent.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the six test cases as a comma-separated list of pairs, enclosed in square brackets, and with no spaces. For example, an admissible format is of the form $[[a,b],[c,d],\\dots]$ where each $a,b,c,d$ is either a nonnegative integer written in decimal or the symbol $\\infty$ represented by the floating-point literal $inf$.\n- The outputs are dimensionless counts; no physical units are required in the output.",
            "solution": "The problem requires the determination of the number of pseudo-time iterations, $n$, needed to reduce the amplitude of a linearized residual error mode to a fraction $10^{-6}$ of its initial value. The error amplitude, $e(\\tau)$, is governed by the scalar ordinary differential equation (ODE):\n$$\n\\frac{de}{d\\tau} = -\\lambda e(\\tau)\n$$\nwith a real, positive eigenvalue $\\lambda > 0$ and initial condition $e(0)=1$. The pseudo-time integration is performed using a fixed step size $\\Delta\\tau = 10^{-5}$ with two different schemes: explicit forward Euler and implicit backward Euler.\n\nLet $e_k$ denote the numerical approximation to $e(k\\Delta\\tau)$. The iterative process for both schemes can be expressed in the form $e_{k+1} = G e_k$, where $G$ is the amplification factor. Starting from $e_0 = 1$, the error after $n$ iterations is $e_n = G^n e_0 = G^n$. The convergence criterion is to find the smallest integer $n$ such that $|e_n| \\leq 10^{-6}$, which translates to $|G|^n \\leq 10^{-6}$.\n\nIf $|G| < 1$, we can find $n$ by taking the natural logarithm of both sides:\n$$\nn \\ln|G| \\leq \\ln(10^{-6})\n$$\nSince $|G| < 1$, $\\ln|G|$ is negative. Dividing by $\\ln|G|$ reverses the inequality sign:\n$$\nn \\geq \\frac{\\ln(10^{-6})}{\\ln|G|}\n$$\nThe required number of iterations is the smallest integer satisfying this condition, which is given by the ceiling function:\n$$\nn = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln|G|} \\right\\rceil\n$$\nIf $|G| \\geq 1$, the error does not decrease, and the iteration count is considered infinite ($+\\infty$).\n\nWe now derive the amplification factor $G$ for each scheme.\n\n**1. Explicit Forward Euler Scheme**\n\nThe forward Euler method discretizes the ODE by approximating the derivative at the current time level, $\\tau_k$:\n$$\n\\frac{e_{k+1} - e_k}{\\Delta\\tau} = -\\lambda e_k\n$$\nSolving for $e_{k+1}$, we obtain the update rule:\n$$\ne_{k+1} = e_k - \\lambda \\Delta\\tau e_k = (1 - \\lambda \\Delta\\tau) e_k\n$$\nThe amplification factor for the explicit scheme is therefore:\n$$\nG_{\\text{explicit}} = 1 - \\lambda \\Delta\\tau\n$$\nFor convergence, the magnitude of the amplification factor must be strictly less than $1$:\n$$\n|G_{\\text{explicit}}| = |1 - \\lambda \\Delta\\tau| < 1\n$$\nSince $\\lambda > 0$ and $\\Delta\\tau > 0$, the product $\\lambda\\Delta\\tau$ is positive. The inequality is equivalent to $-1 < 1 - \\lambda\\Delta\\tau < 1$.\nThe right-hand side, $1 - \\lambda\\Delta\\tau < 1$, implies $-\\lambda\\Delta\\tau < 0$, which is always true.\nThe left-hand side, $-1 < 1 - \\lambda\\Delta\\tau$, implies $\\lambda\\Delta\\tau < 2$.\nThus, the explicit forward Euler scheme is stable only if $\\lambda\\Delta\\tau < 2$. According to the problem statement, if this condition is not met (i.e., if $|G_{\\text{explicit}}| \\geq 1$, which corresponds to $\\lambda\\Delta\\tau \\geq 2$), the number of iterations is $n_{\\text{explicit}} = +\\infty$.\nWhen the scheme is stable, the number of iterations is:\n$$\nn_{\\text{explicit}} = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln|1 - \\lambda\\Delta\\tau|} \\right\\rceil\n$$\n\n**2. Implicit Backward Euler Scheme**\n\nThe backward Euler method discretizes the ODE by approximating the derivative at the next time level, $\\tau_{k+1}$:\n$$\n\\frac{e_{k+1} - e_k}{\\Delta\\tau} = -\\lambda e_{k+1}\n$$\nSolving for $e_{k+1}$:\n$$\ne_{k+1} + \\lambda \\Delta\\tau e_{k+1} = e_k \\implies e_{k+1}(1 + \\lambda\\Delta\\tau) = e_k\n$$\nThis gives the update rule:\n$$\ne_{k+1} = \\frac{1}{1 + \\lambda\\Delta\\tau} e_k\n$$\nThe amplification factor for the implicit scheme is:\n$$\nG_{\\text{implicit}} = \\frac{1}{1 + \\lambda\\Delta\\tau}\n$$\nSince $\\lambda > 0$ and $\\Delta\\tau > 0$, the denominator $1 + \\lambda\\Delta\\tau$ is always greater than $1$. Consequently, $0 < G_{\\text{implicit}} < 1$ for all valid problem parameters. The implicit backward Euler scheme is unconditionally stable for this ODE. The number of iterations is always finite and is given by:\n$$\nn_{\\text{implicit}} = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln\\left(\\frac{1}{1 + \\lambda\\Delta\\tau}\\right)} \\right\\rceil = \\left\\lceil \\frac{\\ln(10^{-6})}{-\\ln(1 + \\lambda\\Delta\\tau)} \\right\\rceil = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + \\lambda\\Delta\\tau)} \\right\\rceil\n$$\n\n**Numerical Evaluation**\n\nWe apply these formulas to the given test suite with $\\Delta\\tau = 10^{-5}$ and a tolerance target of $10^{-6}$.\n\n- **Case 1: $\\lambda = 10^2$**\n  - $\\lambda\\Delta\\tau = 10^2 \\times 10^{-5} = 0.001$. This satisfies the explicit stability condition $\\lambda\\Delta\\tau < 2$.\n  - $n_{\\text{explicit}} = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln|1 - 0.001|} \\right\\rceil = \\left\\lceil \\frac{-13.8155}{-0.0010005} \\right\\rceil = \\lceil 13808.6 \\rceil = 13809$.\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 0.001)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{0.0009995} \\right\\rceil = \\lceil 13822.4 \\rceil = 13823$.\n  - Result: $[13809, 13823]$\n\n- **Case 2: $\\lambda = 10^4$**\n  - $\\lambda\\Delta\\tau = 10^4 \\times 10^{-5} = 0.1$. This satisfies $\\lambda\\Delta\\tau < 2$.\n  - $n_{\\text{explicit}} = \\left\\lceil \\frac{\\ln(10^{-6})}{\\ln|1 - 0.1|} \\right\\rceil = \\left\\lceil \\frac{-13.8155}{-0.10536} \\right\\rceil = \\lceil 131.12 \\rceil = 132$.\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 0.1)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{0.09531} \\right\\rceil = \\lceil 144.95 \\rceil = 145$.\n  - Result: $[132, 145]$\n\n- **Case 3: $\\lambda = 2 \\times 10^5$**\n  - $\\lambda\\Delta\\tau = 2 \\times 10^5 \\times 10^{-5} = 2$. This is the stability limit. $|G_{\\text{explicit}}| = |1 - 2| = 1$.\n  - $n_{\\text{explicit}} = +\\infty$.\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 2)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{1.0986} \\right\\rceil = \\lceil 12.57 \\rceil = 13$.\n  - Result: $[+\\infty, 13]$\n\n- **Case 4: $\\lambda = 3 \\times 10^5$**\n  - $\\lambda\\Delta\\tau = 3 \\times 10^5 \\times 10^{-5} = 3$. This violates the stability condition $\\lambda\\Delta\\tau < 2$.\n  - $n_{\\text{explicit}} = +\\infty$.\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 3)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{1.3863} \\right\\rceil = \\lceil 9.966 \\rceil = 10$.\n  - Result: $[+\\infty, 10]$\n\n- **Case 5: $\\lambda = 5 \\times 10^5$**\n  - $\\lambda\\Delta\\tau = 5 \\times 10^5 \\times 10^{-5} = 5$. This violates the stability condition.\n  - $n_{\\text{explicit}} = +\\infty$.\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 5)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{1.7918} \\right\\rceil = \\lceil 7.71 \\rceil = 8$.\n  - Result: $[+\\infty, 8]$\n\n- **Case 6: $\\lambda = 10^6$**\n  - $\\lambda\\Delta\\tau = 10^6 \\times 10^{-5} = 10$. This violates the stability condition.\n  - $n_{\\text{explicit}} = +\\infty$.\n  - $n_{\\text{implicit}} = \\left\\lceil \\frac{-\\ln(10^{-6})}{\\ln(1 + 10)} \\right\\rceil = \\left\\lceil \\frac{13.8155}{2.3979} \\right\\rceil = \\lceil 5.76 \\rceil = 6$.\n  - Result: $[+\\infty, 6]$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the number of pseudo-time iterations for error reduction\n    using explicit forward Euler and implicit backward Euler schemes.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        10**2,\n        10**4,\n        2 * 10**5,\n        3 * 10**5,\n        5 * 10**5,\n        10**6,\n    ]\n\n    delta_tau = 1e-5\n    tolerance = 1e-6\n    # Pre-calculate the natural logarithm of the tolerance for efficiency.\n    log_tolerance = np.log(tolerance)\n\n    results = []\n    for lam in test_cases:\n        # Calculate the dimensionless product lambda * delta_tau\n        lambda_dt = lam * delta_tau\n\n        # --- Explicit Forward Euler ---\n        # The stability condition for the explicit scheme is lambda * delta_tau < 2.\n        # If lambda * delta_tau >= 2, the amplification factor's magnitude is >= 1,\n        # leading to non-convergence.\n        if lambda_dt >= 2.0:\n            n_explicit = np.inf\n        else:\n            # Amplification factor G = 1 - lambda * delta_tau\n            # We need |G|^n <= tolerance, so n >= log(tolerance) / log(|G|).\n            # The result must be the smallest integer, hence the ceiling.\n            g_explicit = abs(1.0 - lambda_dt)\n            n_explicit = int(np.ceil(log_tolerance / np.log(g_explicit)))\n\n        # --- Implicit Backward Euler ---\n        # The implicit scheme is unconditionally stable for this problem.\n        # Amplification factor G = 1 / (1 + lambda * delta_tau)\n        # We need G^n <= tolerance, so n >= log(tolerance) / log(G).\n        # log(G) = log(1 / (1 + lambda_dt)) = -log(1 + lambda_dt).\n        # Thus, n >= log(tolerance) / -log(1 + lambda_dt).\n        n_implicit = int(np.ceil(log_tolerance / -np.log(1.0 + lambda_dt)))\n\n        results.append((n_explicit, n_implicit))\n\n    # Format the output string to match the exact requirement: [[a,b],[c,d],...] with no spaces.\n    formatted_pairs = []\n    for n_exp, n_imp in results:\n        # np.inf stringifies to 'inf' by default, which is required.\n        s_exp = 'inf' if np.isinf(n_exp) else str(int(n_exp))\n        s_imp = str(int(n_imp))\n        formatted_pairs.append(f\"[{s_exp},{s_imp}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(formatted_pairs)}]]\")\n\nsolve()\n```"
        }
    ]
}