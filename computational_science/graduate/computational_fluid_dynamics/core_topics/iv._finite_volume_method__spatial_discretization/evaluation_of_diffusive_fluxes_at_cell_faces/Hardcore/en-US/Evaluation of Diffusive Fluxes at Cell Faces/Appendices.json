{
    "hands_on_practices": [
        {
            "introduction": "To build robust numerical schemes, we must start from first principles. This practice guides you through a fundamental scenario in diffusion: transport across an interface between two different materials. By enforcing the physical principle of flux continuity, you will derive the exact interface flux and discover why a simple arithmetic average of the diffusion coefficients can lead to significant errors, especially on non-uniform grids. This exercise  is crucial for developing an intuition for diffusive resistance and appreciating the need for physically consistent interpolation schemes like harmonic averaging.",
            "id": "3316585",
            "problem": "Consider one-dimensional, steady diffusion of a passive scalar $\\,\\phi\\,$ with no sources and no convection in a composite medium where the diffusion coefficient $\\,\\Gamma\\,$ has a discontinuity at an interface coincident with a finite-volume face. Two adjacent control volumes share a common face located at position $\\,x_f\\,$. The west cell center is at position $\\,x_W\\,$ and the east cell center is at position $\\,x_E\\,$. The distances from the cell centers to the face are $\\,\\delta_W = x_f - x_W\\,$ and $\\,\\delta_E = x_E - x_f\\,$, respectively, with $\\,\\delta_W \\neq \\delta_E\\,$ to represent a graded mesh. The cross-sectional area is $\\,A\\,$, taken constant, and the diffusion coefficient takes the constant values $\\,\\Gamma_W\\,$ for $\\,x<x_f\\,$ and $\\,\\Gamma_E\\,$ for $\\,x>x_f\\,$, with $\\,\\Gamma_W \\neq \\Gamma_E\\,$.\n\nYou are to evaluate the diffusive flux at the face from the two cell-centered values $\\,\\phi_W\\,$ and $\\,\\phi_E\\,$, starting from Fick's law $\\,q = -\\Gamma\\,\\mathrm{d}\\phi/\\mathrm{d}x\\,$ and the fact that the steady diffusive flux is continuous across the interface. Define the face flux magnitude predicted by a two-point face scheme using an arithmetic average of the diffusion coefficient as\n$$F_{\\text{arith}} = A\\,\\Gamma_f^{\\text{arith}}\\,\\frac{\\phi_E - \\phi_W}{\\delta_W + \\delta_E},$$\nwith $\\,\\Gamma_f^{\\text{arith}} = \\tfrac{1}{2}\\left(\\Gamma_W + \\Gamma_E\\right)\\,$, and let $\\,F_{\\text{exact}}\\,$ be the physically consistent flux obtained by enforcing flux continuity across the interface and piecewise constant $\\,\\Gamma\\,$.\n\nUsing only the fundamental relations described above, derive and report a closed-form analytic expression for the relative error\n$$\\mathcal{E} = \\frac{F_{\\text{arith}} - F_{\\text{exact}}}{F_{\\text{exact}}},$$\nexpressed solely in terms of $\\,\\Gamma_W\\,$, $\\,\\Gamma_E\\,$, $\\,\\delta_W\\,$, and $\\,\\delta_E\\,$. Interpret this result by relating it to an effective interface resistance and ensure the expression is dimensionless. The final answer must be a single closed-form analytical expression. Do not round.",
            "solution": "The problem requires the derivation of the relative error between a numerically approximated diffusive flux and the exact diffusive flux across an interface in a composite medium. The starting point is the one-dimensional, steady-state diffusion equation with no sources or convection, which is derived from Fick's law.\n\nFor a one-dimensional system, Fick's law states that the diffusive flux per unit area, $q$, is given by:\n$$q = -\\Gamma \\frac{d\\phi}{dx}$$\nwhere $\\phi$ is the scalar concentration and $\\Gamma$ is the diffusion coefficient. The total flux across a surface of area $A$ is $F = A q$.\n\nUnder steady-state conditions with no sources, the principle of conservation dictates that the flux must be constant throughout the domain. That is, $\\frac{dF}{dx} = 0$, which implies $F$ is a constant. Let us denote this constant exact flux as $F_{\\text{exact}}$.\n\nThe domain is composed of two regions with different diffusion coefficients: $\\Gamma_W$ for $x < x_f$ and $\\Gamma_E$ for $x > x_f$. We can integrate Fick's law across each region separately.\n\nFirst, consider the west-side region, from the cell center at $x_W$ to the face at $x_f$. The diffusion coefficient is $\\Gamma_W$.\n$$F_{\\text{exact}} = -A \\Gamma_W \\frac{d\\phi}{dx} \\quad \\text{for} \\quad x \\in [x_W, x_f]$$\nSeparating variables and integrating from $x_W$ to $x_f$, where the scalar values are $\\phi_W$ and $\\phi_f$ respectively:\n$$\\int_{x_W}^{x_f} F_{\\text{exact}} dx = -A \\Gamma_W \\int_{\\phi_W}^{\\phi_f} d\\phi$$\n$$F_{\\text{exact}} (x_f - x_W) = -A \\Gamma_W (\\phi_f - \\phi_W)$$\nUsing the definition $\\delta_W = x_f - x_W$, we get:\n$$F_{\\text{exact}} \\delta_W = A \\Gamma_W (\\phi_W - \\phi_f)$$\nThis can be rearranged to express the drop in the scalar value:\n$$\\phi_W - \\phi_f = \\frac{F_{\\text{exact}} \\delta_W}{A \\Gamma_W}$$\n\nNext, consider the east-side region, from the face at $x_f$ to the cell center at $x_E$. The diffusion coefficient is $\\Gamma_E$.\n$$F_{\\text{exact}} = -A \\Gamma_E \\frac{d\\phi}{dx} \\quad \\text{for} \\quad x \\in [x_f, x_E]$$\nIntegrating from $x_f$ to $x_E$, where the scalar values are $\\phi_f$ and $\\phi_E$:\n$$\\int_{x_f}^{x_E} F_{\\text{exact}} dx = -A \\Gamma_E \\int_{\\phi_f}^{\\phi_E} d\\phi$$\n$$F_{\\text{exact}} (x_E - x_f) = -A \\Gamma_E (\\phi_E - \\phi_f)$$\nUsing the definition $\\delta_E = x_E - x_f$, we have:\n$$F_{\\text{exact}} \\delta_E = A \\Gamma_E (\\phi_f - \\phi_E)$$\nThis gives the second scalar drop:\n$$\\phi_f - \\phi_E = \\frac{F_{\\text{exact}} \\delta_E}{A \\Gamma_E}$$\n\nTo eliminate the unknown interface scalar value $\\phi_f$, we add the two expressions for the scalar drops:\n$$(\\phi_W - \\phi_f) + (\\phi_f - \\phi_E) = \\frac{F_{\\text{exact}} \\delta_W}{A \\Gamma_W} + \\frac{F_{\\text{exact}} \\delta_E}{A \\Gamma_E}$$\n$$\\phi_W - \\phi_E = \\frac{F_{\\text{exact}}}{A} \\left( \\frac{\\delta_W}{\\Gamma_W} + \\frac{\\delta_E}{\\Gamma_E} \\right)$$\nNow we can solve for the exact flux, $F_{\\text{exact}}$, in terms of the known cell-centered values $\\phi_W$ and $\\phi_E$:\n$$F_{\\text{exact}} = A \\frac{\\phi_W - \\phi_E}{\\frac{\\delta_W}{\\Gamma_W} + \\frac{\\delta_E}{\\Gamma_E}}$$\nTo align with the sign convention used in the definition of $F_{\\text{arith}}$, which is proportional to $\\phi_E - \\phi_W$, we can write:\n$$F_{\\text{exact}} = -A \\frac{\\phi_E - \\phi_W}{\\frac{\\delta_W}{\\Gamma_W} + \\frac{\\delta_E}{\\Gamma_E}}$$\nThis can be rewritten by defining an effective diffusion coefficient for the interface, $\\Gamma_f^{\\text{exact}}$:\n$$F_{\\text{exact}} = A \\, \\Gamma_f^{\\text{exact}} \\frac{\\phi_E - \\phi_W}{\\delta_W + \\delta_E}$$\nComparing the forms, we can identify $\\Gamma_f^{\\text{exact}}$:\n$$A \\, \\Gamma_f^{\\text{exact}} \\frac{\\phi_E - \\phi_W}{\\delta_W + \\delta_E} = -A \\frac{\\phi_E - \\phi_W}{\\frac{\\delta_W}{\\Gamma_W} + \\frac{\\delta_E}{\\Gamma_E}} \\quad \\implies \\quad \\Gamma_f^{\\text{exact}} = \\frac{\\delta_W + \\delta_E}{\\frac{\\delta_W}{\\Gamma_W} + \\frac{\\delta_E}{\\Gamma_E}}$$\nThis is the weighted harmonic mean of the diffusion coefficients. The terms $\\frac{\\delta_W}{A\\Gamma_W}$ and $\\frac{\\delta_E}{A\\Gamma_E}$ represent the diffusive resistances of the west and east segments, demonstrating that for the exact solution, these series resistances add up.\n\nThe problem defines the flux calculated with the arithmetic average of the diffusion coefficient as:\n$$F_{\\text{arith}} = A\\,\\Gamma_f^{\\text{arith}}\\,\\frac{\\phi_E - \\phi_W}{\\delta_W + \\delta_E}$$\nwhere $\\Gamma_f^{\\text{arith}} = \\frac{1}{2}(\\Gamma_W + \\Gamma_E)$.\n\nWe are asked to find the relative error $\\mathcal{E}$:\n$$\\mathcal{E} = \\frac{F_{\\text{arith}} - F_{\\text{exact}}}{F_{\\text{exact}}} = \\frac{F_{\\text{arith}}}{F_{\\text{exact}}} - 1$$\nThe ratio of the fluxes simplifies to the ratio of the effective diffusion coefficients:\n$$\\frac{F_{\\text{arith}}}{F_{\\text{exact}}} = \\frac{A\\,\\Gamma_f^{\\text{arith}}\\,\\frac{\\phi_E - \\phi_W}{\\delta_W + \\delta_E}}{A\\,\\Gamma_f^{\\text{exact}}\\,\\frac{\\phi_E - \\phi_W}{\\delta_W + \\delta_E}} = \\frac{\\Gamma_f^{\\text{arith}}}{\\Gamma_f^{\\text{exact}}}$$\nSubstituting the expressions for $\\Gamma_f^{\\text{arith}}$ and $\\Gamma_f^{\\text{exact}}$:\n$$\\frac{F_{\\text{arith}}}{F_{\\text{exact}}} = \\frac{\\frac{1}{2}(\\Gamma_W + \\Gamma_E)}{\\frac{\\delta_W + \\delta_E}{\\frac{\\delta_W}{\\Gamma_W} + \\frac{\\delta_E}{\\Gamma_E}}} = \\frac{\\Gamma_W + \\Gamma_E}{2} \\cdot \\frac{\\frac{\\delta_W}{\\Gamma_W} + \\frac{\\delta_E}{\\Gamma_E}}{\\delta_W + \\delta_E}$$\nLet's simplify this expression:\n$$\\frac{F_{\\text{arith}}}{F_{\\text{exact}}} = \\frac{\\Gamma_W + \\Gamma_E}{2(\\delta_W + \\delta_E)} \\cdot \\frac{\\delta_W \\Gamma_E + \\delta_E \\Gamma_W}{\\Gamma_W \\Gamma_E} = \\frac{(\\Gamma_W + \\Gamma_E)(\\delta_W \\Gamma_E + \\delta_E \\Gamma_W)}{2 \\Gamma_W \\Gamma_E (\\delta_W + \\delta_E)}$$\nNow, we compute the relative error $\\mathcal{E}$:\n$$\\mathcal{E} = \\frac{(\\Gamma_W + \\Gamma_E)(\\delta_W \\Gamma_E + \\delta_E \\Gamma_W)}{2 \\Gamma_W \\Gamma_E (\\delta_W + \\delta_E)} - 1$$\n$$\\mathcal{E} = \\frac{(\\Gamma_W + \\Gamma_E)(\\delta_W \\Gamma_E + \\delta_E \\Gamma_W) - 2 \\Gamma_W \\Gamma_E (\\delta_W + \\delta_E)}{2 \\Gamma_W \\Gamma_E (\\delta_W + \\delta_E)}$$\nExpanding the numerator:\nNumerator $= (\\Gamma_W \\delta_W \\Gamma_E + \\Gamma_W \\delta_E \\Gamma_W + \\Gamma_E \\delta_W \\Gamma_E + \\Gamma_E \\delta_E \\Gamma_W) - (2\\delta_W \\Gamma_W \\Gamma_E + 2\\delta_E \\Gamma_W \\Gamma_E)$\nNumerator $= \\delta_W \\Gamma_W \\Gamma_E + \\delta_E \\Gamma_W^2 + \\delta_W \\Gamma_E^2 + \\delta_E \\Gamma_W \\Gamma_E - 2\\delta_W \\Gamma_W \\Gamma_E - 2\\delta_E \\Gamma_W \\Gamma_E$\nCombining terms:\nNumerator $= \\delta_E \\Gamma_W^2 + \\delta_W \\Gamma_E^2 - \\delta_W \\Gamma_W \\Gamma_E - \\delta_E \\Gamma_W \\Gamma_E$\nFactoring by $\\delta_W$ and $\\delta_E$:\nNumerator $= \\delta_W(\\Gamma_E^2 - \\Gamma_W \\Gamma_E) + \\delta_E(\\Gamma_W^2 - \\Gamma_W \\Gamma_E)$\nNumerator $= \\delta_W \\Gamma_E(\\Gamma_E - \\Gamma_W) - \\delta_E \\Gamma_W(\\Gamma_E - \\Gamma_W)$\nFactoring out the common term $(\\Gamma_E - \\Gamma_W)$:\nNumerator $= (\\Gamma_E - \\Gamma_W)(\\delta_W \\Gamma_E - \\delta_E \\Gamma_W)$\n\nThus, the final expression for the relative error is:\n$$\\mathcal{E} = \\frac{(\\Gamma_E - \\Gamma_W)(\\delta_W \\Gamma_E - \\delta_E \\Gamma_W)}{2 \\Gamma_W \\Gamma_E (\\delta_W + \\delta_E)}$$\nThis expression is dimensionless, as required. The numerator has units of $[\\Gamma]^2[\\delta]$ and the denominator has units of $[\\Gamma]^2[\\delta]$.\n\nThis result can be interpreted through the concept of diffusive resistance. The exact total resistance is $R_{\\text{exact}} = (\\delta_W/(A\\Gamma_W)) + (\\delta_E/(A\\Gamma_E))$. The resistance implied by the arithmetic mean approximation is $R_{\\text{arith}} = (\\delta_W+\\delta_E)/(A\\Gamma_f^{\\text{arith}})$. The relative error in flux is given by $\\mathcal{E} = R_{\\text{exact}}/R_{\\text{arith}} - 1$. The derived expression shows that this error is zero under two conditions:\n$1$. $\\Gamma_E = \\Gamma_W$: The medium is homogeneous, so there is no discontinuity.\n$2$. $\\delta_W \\Gamma_E = \\delta_E \\Gamma_W$, or $\\delta_W/\\delta_E = \\Gamma_W/\\Gamma_E$: The grid spacing on either side of the interface is graded in a specific ratio related to the diffusion coefficients. In this particular case, the arithmetic mean fortuitously yields the correct harmonic mean required by the physics.\nFor a uniform grid ($\\delta_W = \\delta_E = \\delta$), the error simplifies to $\\mathcal{E} = \\frac{(\\Gamma_E - \\Gamma_W)^2}{4\\Gamma_W\\Gamma_E}$. Since this is always non-negative, the arithmetic average scheme always overestimates the magnitude of the flux compared to the exact solution when the grid is uniform and $\\Gamma_W \\neq \\Gamma_E$.",
            "answer": "$$\\boxed{\\frac{(\\Gamma_E - \\Gamma_W)(\\delta_W \\Gamma_E - \\delta_E \\Gamma_W)}{2 \\Gamma_W \\Gamma_E (\\delta_W + \\delta_E)}}$$"
        },
        {
            "introduction": "Real-world materials are often anisotropic, meaning their properties depend on direction. This exercise  explores the challenge of discretizing diffusive fluxes when the principal axes of the conductivity tensor $\\mathbf{K}$ are not aligned with the computational grid. You will directly compare a simple Two-Point Flux Approximation (TPFA) with a more sophisticated Multi-Point Flux Approximation (MPFA) to see precisely why TPFA fails and how MPFA succeeds. By using a linear manufactured solution, the analysis becomes exceptionally clear, revealing the source of cross-diffusion error and the rationale behind advanced flux evaluation schemes.",
            "id": "3316594",
            "problem": "Consider a two-dimensional diffusive process governed by Fourier's law of heat conduction (equivalently, Fick's law of mass diffusion), which states that the diffusive flux vector is given by $\\mathbf{q}=-\\mathbf{K}\\nabla u$, where $\\mathbf{K}\\in\\mathbb{R}^{2\\times 2}$ is a symmetric, positive definite conductivity tensor and $u:\\mathbb{R}^2\\to\\mathbb{R}$ is a scalar potential with gradient $\\nabla u$. In a finite-volume context, the normal flux across a face with unit normal $\\mathbf{n}_f$ is defined by $q_f=-\\mathbf{n}_f^\\top\\mathbf{K}\\nabla u$. The conductivity tensor is assumed anisotropic with principal values $k_1>0$ and $k_2>0$, and principal directions rotated by an angle $\\theta$ relative to a fixed global frame. Let $\\mathbf{R}(\\theta)$ denote the planar rotation by angle $\\theta$, and define the conductivity tensor by $\\mathbf{K}=\\mathbf{R}(\\theta)^\\top\\mathrm{diag}(k_1,k_2)\\,\\mathbf{R}(\\theta)$. The face normal is oriented at an angle $\\varphi$ in the same global frame, i.e., $\\mathbf{n}_f=[\\cos\\varphi,\\sin\\varphi]^\\top$, with tangent $\\mathbf{t}_f=[-\\sin\\varphi,\\cos\\varphi]^\\top$.\n\nTwo numerical flux approximations are to be evaluated:\n- Two-Point Flux Approximation (TPFA): $q_f^{\\mathrm{TPFA}}$ uses only the difference of cell-centered values along the line connecting the two adjacent cell centers and the projection of $\\mathbf{K}$ onto the normal direction.\n- MultiPoint Flux Approximation (MPFA): $q_f^{\\mathrm{MPFA}}$ reconstructs the local gradient using multiple point values to capture both normal and tangential directional derivatives, thereby accounting for cross-coupling introduced by anisotropy and misalignment.\n\nAssume a linear scalar field of the form $u(x,y)=a\\,x+b\\,y$, where $a$ and $b$ are constants, so that $\\nabla u=\\mathbf{g}=[a,b]^\\top$ is constant. Consider a face centered at the origin with unit normal $\\mathbf{n}_f$ and tangent $\\mathbf{t}_f$. Let the two adjacent cell centers be located at positions $\\mathbf{r}_A=-\\frac{d}{2}\\mathbf{n}_f$ and $\\mathbf{r}_B=+\\frac{d}{2}\\mathbf{n}_f$, where $d>0$ is the distance between the cell centers along the normal. In addition, define tangential neighbor positions on each side: $\\mathbf{r}_{A,\\pm}=\\mathbf{r}_A\\pm s\\,\\mathbf{t}_f$ and $\\mathbf{r}_{B,\\pm}=\\mathbf{r}_B\\pm s\\,\\mathbf{t}_f$, where $s\\ge 0$ is the tangential offset.\n\nDefine the exact normal flux by $q_f^{\\mathrm{exact}}=-\\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{g}$. Define the Two-Point Flux Approximation by $q_f^{\\mathrm{TPFA}}=-\\left(\\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{n}_f\\right)\\,\\frac{u(\\mathbf{r}_B)-u(\\mathbf{r}_A)}{d}$. Define the MultiPoint Flux Approximation by first constructing directional derivatives\n$$\nD_n=\\frac{u(\\mathbf{r}_B)-u(\\mathbf{r}_A)}{d},\\quad D_t^{(A)}=\\frac{u(\\mathbf{r}_{A,+})-u(\\mathbf{r}_{A,-})}{2s},\\quad D_t^{(B)}=\\frac{u(\\mathbf{r}_{B,+})-u(\\mathbf{r}_{B,-})}{2s},\n$$\nwith the convention that if $s=0$ then $D_t^{(A)}=D_t^{(B)}=0$, and set $D_t=\\frac{D_t^{(A)}+D_t^{(B)}}{2}$. Form the reconstructed gradient $\\widehat{\\nabla u}=D_n\\,\\mathbf{n}_f+D_t\\,\\mathbf{t}_f$, and compute\n$$\nq_f^{\\mathrm{MPFA}}=-\\mathbf{n}_f^\\top\\mathbf{K}\\,\\widehat{\\nabla u}.\n$$\nBy design, for linear $u$ and $s>0$, $\\widehat{\\nabla u}$ recovers $\\nabla u$ exactly.\n\nYour task is to implement a program that, for a given set of parameters $(k_1,k_2,\\theta,\\varphi,d,s,a,b)$, computes the pair of absolute errors $\\left|q_f^{\\mathrm{TPFA}}-q_f^{\\mathrm{exact}}\\right|$ and $\\left|q_f^{\\mathrm{MPFA}}-q_f^{\\mathrm{exact}}\\right|$. Use angles in radians. Treat all quantities as dimensionless. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nTest Suite:\n- Case $\\mathbf{1}$ (anisotropic but aligned): $(k_1,k_2,\\theta,\\varphi,d,s,a,b)=\\left(2.0,0.5,0.0,0.0,1.0,0.5,1.0,0.5\\right)$.\n- Case $\\mathbf{2}$ (anisotropic, $\\mathbf{K}$ rotated): $(k_1,k_2,\\theta,\\varphi,d,s,a,b)=\\left(2.0,0.5,\\frac{\\pi}{4},0.0,1.0,0.5,1.0,0.5\\right)$.\n- Case $\\mathbf{3}$ (isotropic): $(k_1,k_2,\\theta,\\varphi,d,s,a,b)=\\left(1.0,1.0,\\frac{\\pi}{3},\\frac{\\pi}{4},1.0,0.5,1.0,0.5\\right)$.\n- Case $\\mathbf{4}$ (general misalignment): $(k_1,k_2,\\theta,\\varphi,d,s,a,b)=\\left(3.0,0.7,\\frac{\\pi}{6},\\frac{\\pi}{3},1.2,0.4,1.0,0.5\\right)$.\n- Case $\\mathbf{5}$ (boundary, no tangential neighbors): $(k_1,k_2,\\theta,\\varphi,d,s,a,b)=\\left(2.0,0.5,\\frac{\\pi}{4},\\frac{\\pi}{6},1.0,0.0,1.0,0.5\\right)$.\n\nRequired final output format: Your program should produce a single line of output containing the results for all test cases as a comma-separated list of pairs, each pair itself being a comma-separated list of the two floating-point absolute errors, enclosed in square brackets. For example, an output with three test cases should look like $\\left[[e_{1}^{\\mathrm{TPFA}},e_{1}^{\\mathrm{MPFA}}],[e_{2}^{\\mathrm{TPFA}},e_{2}^{\\mathrm{MPFA}}],[e_{3}^{\\mathrm{TPFA}},e_{3}^{\\mathrm{MPFA}}]\\right]$.",
            "solution": "The problem requires the calculation of absolute errors for two numerical flux approximations, the Two-Point Flux Approximation (TPFA) and the MultiPoint Flux Approximation (MPFA), relative to an exact analytical flux for a two-dimensional diffusion problem. The problem is well-posed, scientifically sound, and provides all necessary information for a unique solution.\n\nThe analysis begins by formalizing the mathematical constructs provided in the problem statement. All quantities are treated as dimensionless.\n\nFirst, we define the primary vectors and matrices. The scalar field is linear, $u(x,y)=a\\,x+b\\,y$, which implies a constant gradient vector $\\mathbf{g}=\\nabla u = [a,b]^\\top$.\nThe face unit normal vector $\\mathbf{n}_f$ and unit tangent vector $\\mathbf{t}_f$ are defined by the face orientation angle $\\varphi$:\n$$\n\\mathbf{n}_f = \\begin{pmatrix} \\cos\\varphi \\\\ \\sin\\varphi \\end{pmatrix}, \\quad \\mathbf{t}_f = \\begin{pmatrix} -\\sin\\varphi \\\\ \\cos\\varphi \\end{pmatrix}\n$$\nThese two vectors form an orthonormal basis for $\\mathbb{R}^2$.\n\nThe conductivity tensor $\\mathbf{K}$ is defined by its principal conductivities $k_1$ and $k_2$ and the rotation angle $\\theta$ of its principal axes. The rotation matrix $\\mathbf{R}(\\theta)$ and its transpose $\\mathbf{R}(\\theta)^\\top$ are:\n$$\n\\mathbf{R}(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix}, \\quad \\mathbf{R}(\\theta)^\\top = \\begin{pmatrix} \\cos\\theta & \\sin\\theta \\\\ -\\sin\\theta & \\cos\\theta \\end{pmatrix}\n$$\nThe tensor $\\mathbf{K}$ is given by $\\mathbf{K}=\\mathbf{R}(\\theta)^\\top\\mathrm{diag}(k_1,k_2)\\,\\mathbf{R}(\\theta)$. Performing the matrix multiplication yields the components of $\\mathbf{K}$:\n$$\n\\mathbf{K} = \\begin{pmatrix} k_1\\cos^2\\theta + k_2\\sin^2\\theta & (k_2-k_1)\\sin\\theta\\cos\\theta \\\\ (k_2-k_1)\\sin\\theta\\cos\\theta & k_1\\sin^2\\theta + k_2\\cos^2\\theta \\end{pmatrix}\n$$\nThis is a symmetric matrix, and since $k_1 > 0$ and $k_2 > 0$, it is positive definite as required.\n\nWith these definitions, we can derive the expressions for the three fluxes.\n\n**1. Exact Normal Flux, $q_f^{\\mathrm{exact}}$**\n\nThe exact normal flux is defined by $q_f^{\\mathrm{exact}}=-\\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{g}$. This is a direct computation involving matrix-vector multiplication.\n$$\nq_f^{\\mathrm{exact}} = - \\begin{pmatrix} \\cos\\varphi & \\sin\\varphi \\end{pmatrix} \\begin{pmatrix} K_{11} & K_{12} \\\\ K_{21} & K_{22} \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix}\n$$\n\n**2. Two-Point Flux Approximation, $q_f^{\\mathrm{TPFA}}$**\n\nThe TPFA flux is defined as $q_f^{\\mathrm{TPFA}}=-\\left(\\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{n}_f\\right)\\,\\frac{u(\\mathbf{r}_B)-u(\\mathbf{r}_A)}{d}$. The term $\\frac{u(\\mathbf{r}_B)-u(\\mathbf{r}_A)}{d}$ represents a finite difference approximation of the normal derivative. For a linear scalar field $u(\\mathbf{r}) = \\mathbf{g}^\\top\\mathbf{r} + c$, this term can be computed exactly. Given $\\mathbf{r}_A = -\\frac{d}{2}\\mathbf{n}_f$ and $\\mathbf{r}_B = \\frac{d}{2}\\mathbf{n}_f$:\n$$\nu(\\mathbf{r}_B) - u(\\mathbf{r}_A) = (\\mathbf{g}^\\top\\mathbf{r}_B + c) - (\\mathbf{g}^\\top\\mathbf{r}_A + c) = \\mathbf{g}^\\top(\\mathbf{r}_B - \\mathbf{r}_A) = \\mathbf{g}^\\top(d\\,\\mathbf{n}_f) = d\\,(\\mathbf{g}^\\top\\mathbf{n}_f)\n$$\nTherefore, the finite difference is exact:\n$$\n\\frac{u(\\mathbf{r}_B)-u(\\mathbf{r}_A)}{d} = \\mathbf{g}^\\top\\mathbf{n}_f = \\mathbf{n}_f^\\top\\mathbf{g}\n$$\nSubstituting this back into the TPFA definition, we get:\n$$\nq_f^{\\mathrm{TPFA}} = -\\left(\\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{n}_f\\right) \\left(\\mathbf{n}_f^\\top\\mathbf{g}\\right)\n$$\nThe TPFA flux is the product of an effective normal conductivity, $T_{\\mathrm{eff}} = \\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{n}_f$, and the projection of the gradient onto the face normal, $g_n = \\mathbf{n}_f^\\top\\mathbf{g}$.\n\n**3. MultiPoint Flux Approximation, $q_f^{\\mathrm{MPFA}}$**\n\nThe MPFA flux is $q_f^{\\mathrm{MPFA}}=-\\mathbf{n}_f^\\top\\mathbf{K}\\,\\widehat{\\nabla u}$, where $\\widehat{\\nabla u}$ is a reconstructed gradient.\nThe reconstructed gradient is $\\widehat{\\nabla u}=D_n\\,\\mathbf{n}_f+D_t\\,\\mathbf{t}_f$.\nThe normal derivative component $D_n$ is the same as the one used in TPFA:\n$$\nD_n = \\frac{u(\\mathbf{r}_B)-u(\\mathbf{r}_A)}{d} = \\mathbf{n}_f^\\top\\mathbf{g}\n$$\nThe tangential derivative component $D_t = \\frac{1}{2}(D_t^{(A)} + D_t^{(B)})$ is computed based on values at tangential neighbor locations. Let's analyze the case for $s > 0$:\n$$\nD_t^{(A)} = \\frac{u(\\mathbf{r}_{A,+}) - u(\\mathbf{r}_{A,-})}{2s} = \\frac{\\mathbf{g}^\\top(\\mathbf{r}_{A,+}-\\mathbf{r}_{A,-})}{2s} = \\frac{\\mathbf{g}^\\top((\\mathbf{r}_A+s\\mathbf{t}_f)-(\\mathbf{r}_A-s\\mathbf{t}_f))}{2s} = \\frac{\\mathbf{g}^\\top(2s\\mathbf{t}_f)}{2s} = \\mathbf{g}^\\top\\mathbf{t}_f\n$$\nSimilarly, $D_t^{(B)} = \\mathbf{g}^\\top\\mathbf{t}_f$, so $D_t = \\mathbf{g}^\\top\\mathbf{t}_f = \\mathbf{t}_f^\\top\\mathbf{g}$.\nThe reconstructed gradient for $s>0$ is:\n$$\n\\widehat{\\nabla u} = (\\mathbf{n}_f^\\top\\mathbf{g})\\,\\mathbf{n}_f + (\\mathbf{t}_f^\\top\\mathbf{g})\\,\\mathbf{t}_f\n$$\nSince $\\{\\mathbf{n}_f, \\mathbf{t}_f\\}$ is an orthonormal basis, this expression is the decomposition of the vector $\\mathbf{g}$ onto this basis. Thus, $\\widehat{\\nabla u} = \\mathbf{g}$. The MPFA scheme exactly reconstructs the gradient for a linear field when $s>0$.\nConsequently, for $s > 0$:\n$$\nq_f^{\\mathrm{MPFA}} = -\\mathbf{n}_f^\\top\\mathbf{K}\\,\\widehat{\\nabla u} = -\\mathbf{n}_f^\\top\\mathbf{K}\\,\\mathbf{g} = q_f^{\\mathrm{exact}}\n$$\nThis implies that the absolute error for MPFA is zero for all test cases where $s > 0$.\n\nNow, consider the case $s=0$. The problem states that if $s=0$, then $D_t^{(A)} = D_t^{(B)} = 0$, which leads to $D_t = 0$.\nThe reconstructed gradient becomes:\n$$\n\\widehat{\\nabla u} = D_n\\,\\mathbf{n}_f = (\\mathbf{n}_f^\\top\\mathbf{g})\\,\\mathbf{n}_f\n$$\nThe MPFA flux is then:\n$$\nq_f^{\\mathrm{MPFA}} = -\\mathbf{n}_f^\\top\\mathbf{K}\\left( (\\mathbf{n}_f^\\top\\mathbf{g})\\,\\mathbf{n}_f \\right) = -(\\mathbf{n}_f^\\top\\mathbf{g}) (\\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{n}_f)\n$$\nThis is identical to the expression for $q_f^{\\mathrm{TPFA}}$. Therefore, when $s=0$, $q_f^{\\mathrm{MPFA}} = q_f^{\\mathrm{TPFA}}$, and their errors will be identical.\n\n**4. Error Calculation**\n\nThe absolute errors are computed as:\n$$\nE_{\\mathrm{TPFA}} = \\left|q_f^{\\mathrm{TPFA}} - q_f^{\\mathrm{exact}}\\right| = \\left| -\\left(\\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{n}_f\\right) \\left(\\mathbf{n}_f^\\top\\mathbf{g}\\right) - (-\\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{g}) \\right| = \\left| \\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{g} - (\\mathbf{n}_f^\\top\\mathbf{K}\\mathbf{n}_f) (\\mathbf{n}_f^\\top\\mathbf{g}) \\right|\n$$\nThe TPFA error is non-zero if $\\mathbf{K}$ has off-diagonal terms when expressed in the $\\{\\mathbf{n}_f, \\mathbf{t}_f\\}$ basis, which occurs when the principal axes of $\\mathbf{K}$ are not aligned with the face normal/tangent.\n\nThe MPFA error is:\n$$\nE_{\\mathrm{MPFA}} = \\left|q_f^{\\mathrm{MPFA}} - q_f^{\\mathrm{exact}}\\right| = \\begin{cases} 0 & \\text{if } s > 0 \\\\ E_{\\mathrm{TPFA}} & \\text{if } s = 0 \\end{cases}\n$$\n\nThe implementation will follow these derived formulas. For each test case, we construct the $\\mathbf{K}$ matrix and the vectors $\\mathbf{g}$ and $\\mathbf{n}_f$, then compute the fluxes and their differences.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes absolute errors for TPFA and MPFA flux approximations for a set of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (k1, k2, theta, phi, d, s, a, b)\n        (2.0, 0.5, 0.0, 0.0, 1.0, 0.5, 1.0, 0.5),\n        (2.0, 0.5, np.pi/4, 0.0, 1.0, 0.5, 1.0, 0.5),\n        (1.0, 1.0, np.pi/3, np.pi/4, 1.0, 0.5, 1.0, 0.5),\n        (3.0, 0.7, np.pi/6, np.pi/3, 1.2, 0.4, 1.0, 0.5),\n        (2.0, 0.5, np.pi/4, np.pi/6, 1.0, 0.0, 1.0, 0.5),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        k1, k2, theta, phi, d, s, a, b = case\n\n        # --- Define vectors and matrices ---\n\n        # Gradient vector g\n        g = np.array([a, b])\n\n        # Face normal vector n_f\n        n_f = np.array([np.cos(phi), np.sin(phi)])\n\n        # Conductivity tensor K\n        c_theta, s_theta = np.cos(theta), np.sin(theta)\n        K = np.array([\n            [k1 * c_theta**2 + k2 * s_theta**2, (k2 - k1) * s_theta * c_theta],\n            [(k2 - k1) * s_theta * c_theta, k1 * s_theta**2 + k2 * c_theta**2]\n        ])\n\n        # --- Calculate fluxes ---\n\n        # 1. Exact flux\n        # q_f_exact = -n_f^T * K * g\n        q_f_exact = -n_f @ (K @ g)\n\n        # 2. Two-Point Flux Approximation (TPFA)\n        # q_f_tpfa = -(n_f^T * K * n_f) * (n_f^T * g)\n        transmissibility = n_f @ (K @ n_f)\n        grad_normal_proj = n_f @ g\n        q_f_tpfa = -transmissibility * grad_normal_proj\n\n        # --- Calculate errors ---\n\n        # TPFA error\n        error_tpfa = np.abs(q_f_tpfa - q_f_exact)\n\n        # MPFA error\n        # For a linear scalar field u, the MPFA scheme is exact if s > 0.\n        # If s = 0, the MPFA scheme degenerates to the TPFA scheme.\n        if s > 0:\n            error_mpfa = 0.0\n        else: # s == 0\n            error_mpfa = error_tpfa\n        \n        results.append([error_tpfa, error_mpfa])\n\n    # Format the final output string as a list of lists.\n    # e.g., [[err1_tpfa,err1_mpfa],[err2_tpfa,err2_mpfa]]\n    inner_parts = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_string = f\"[{','.join(inner_parts)}]\"\n    print(final_string)\n\nsolve()\n```"
        },
        {
            "introduction": "An accurate numerical scheme is useless if it produces a linear system that is unstable or impossible to solve efficiently. This practice moves beyond accuracy to explore the critical issue of numerical stability on poor-quality meshes. By analyzing a carefully constructed two-cell system with severe non-orthogonality , you will investigate how a standard discretization can fail, leading to a loss of the essential Symmetric Positive Definite (SPD) property of the diffusion operator. This thought experiment is key to understanding the deep connection between mesh geometry and matrix conditioning, and the need for schemes that guarantee robustness.",
            "id": "3316604",
            "problem": "Consider steady diffusion of a scalar field $\\phi$ with constant diffusivity $k$ on a cutout of an unstructured mesh used in Computational Fluid Dynamics (CFD). The governing conservation law in integral form and Fick's law state that, for a control volume $\\Omega_P$ with boundary $\\partial \\Omega_P$, \n$$\n\\int_{\\partial \\Omega_P} \\left(-k \\nabla \\phi \\cdot \\boldsymbol{n}\\right) \\, \\mathrm{d}A = \\int_{\\Omega_P} s \\, \\mathrm{d}V,\n$$\nwhere $s$ is a source and $\\boldsymbol{n}$ is the outward unit normal. In a Finite Volume Method (FVM) discretization, face-normal diffusive fluxes are evaluated on each face and summed.\n\nYou are asked to examine when the naive face-normal two-point evaluation combined with a non-orthogonal correction can destroy the Symmetric Positive Definite (SPD) property of the assembled diffusion operator, and how to fix it.\n\nMesh fragment and data:\n- Two interior cells $P$ and $N$ of equal volumes $V_P = V_N = 1$ share a single interior face $f$ of area $A_f = 1$ with unit normal $\\boldsymbol{n}_f$ pointing from $P$ to $N$.\n- The centroid-to-centroid vector is $\\boldsymbol{d} = \\boldsymbol{x}_N - \\boldsymbol{x}_P$ with $|\\boldsymbol{d}| = 1$ and direction $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f = \\cos(154^\\circ) \\approx -0.9$ (highly non-orthogonal and obtuse).\n- Each cell has exactly one additional boundary face of area $A_b = 1$, at distance $\\ell_b = 10$ along its outward normal, with Dirichlet boundary value $\\phi_b = 0$. Assume standard conservative boundary treatment.\n- Uniform diffusivity $k = 1$.\n- For the interior face, adopt the usual two-point normal projection of Fick's law as the implicit part, and treat any tangential non-orthogonal (cross-diffusion) contribution explicitly (so it does not appear in the implicit matrix).\n\nStarting only from the integral conservation law and Fick's law (no ready-made discretization formulae may be assumed), analyze the implicit $2 \\times 2$ operator assembled for the unknowns $(\\phi_P,\\phi_N)$ on this two-cell subsystem. Determine whether the naive non-orthogonal treatment can produce a loss of the SPD property of the implicit diffusion operator on this mesh. Then judge which remedy, if any, can provably restore SPD while preserving local conservation.\n\nSelect all options that are correct.\n\nA. On the given mesh with $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\approx -0.9$ and $\\ell_b = 10$, the naive two-point implicit normal flux produces the interior-face contribution coefficient $A_\\perp \\approx -0.9$. Assembling the implicit matrix yields\n$$\n\\begin{bmatrix}\n-0.9 + 0.1 & +0.9 \\\\\n+0.9 & -0.9 + 0.1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-0.8 & 0.9 \\\\\n0.9 & -0.8\n\\end{bmatrix},\n$$\nwhose eigenvalues are $0.1$ and $-1.7$, so the operator is not SPD. A locally conservative fix is to limit the implicit normal coefficient to $\\lvert A_\\perp \\rvert \\approx 0.9$ (equivalently, replace $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f$ by $\\lvert \\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\rvert$ in the implicit operator) and put the sign correction into the explicit source; the resulting implicit matrix\n$$\n\\begin{bmatrix}\n0.9 + 0.1 & -0.9 \\\\\n-0.9 & 0.9 + 0.1\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1.0 & -0.9 \\\\\n-0.9 & 1.0\n\\end{bmatrix}\n$$\nhas eigenvalues $1.9$ and $0.1$ and is SPD.\n\nB. On the given mesh with $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\approx -0.9$ and $\\ell_b = 10$, the explicit non-orthogonal correction always ensures diagonal dominance of the implicit operator, so the naive two-point scheme necessarily remains SPD; no fix is required.\n\nC. On a slightly non-orthogonal mesh with $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f = 0.2$ and $\\ell_b = 1$, the naive two-point scheme loses SPD, but making the entire cross-diffusion term fully implicit and assigning it entirely to the owner cell $P$ restores SPD while maintaining local conservation and symmetry.\n\nD. On the given mesh with $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\approx -0.9$ and $\\ell_b = 10$, an alternative conservative and SPD-preserving fix is to use a rotated-diffusion split: keep the implicit normal part with $\\lvert \\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\rvert$ so that the $P$–$N$ coupling is non-positive and symmetric, and treat the tangential (cross-diffusion) part implicitly via a symmetric least-squares face-gradient that yields a positive semidefinite bilinear form over the compact stencil. On this two-cell subsystem the tangential term contributes no additional implicit coupling, so the implicit matrix reduces to the SPD matrix in option A; on larger stencils it remains symmetric positive semidefinite by construction and preserves local conservation.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\nThe problem provides the following information for a steady-state diffusion analysis on an unstructured mesh using the Finite Volume Method (FVM):\n- **Governing Law:** Integral form of the conservation law for a scalar $\\phi$ in a control volume $\\Omega_P$: $$ \\int_{\\partial \\Omega_P} \\left(-k \\nabla \\phi \\cdot \\boldsymbol{n}\\right) \\, \\mathrm{d}A = \\int_{\\Omega_P} s \\, \\mathrm{d}V $$\n- **Constitutive Law:** Fick's law relates the flux to the gradient of $\\phi$.\n- **Mesh and Geometry:**\n    - Two adjacent interior cells, $P$ and $N$.\n    - Cell volumes: $V_P = V_N = 1$.\n    - Shared interior face $f$ with area $A_f = 1$.\n    - Unit normal of face $f$, $\\boldsymbol{n}_f$, points from cell $P$ to cell $N$.\n    - Centroid-to-centroid vector: $\\boldsymbol{d} = \\boldsymbol{x}_N - \\boldsymbol{x}_P$.\n    - Magnitude of centroid vector: $|\\boldsymbol{d}| = 1$.\n    - Non-orthogonality measure: $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f = \\cos(154^\\circ) \\approx -0.9$.\n    - Each cell has one boundary face of area $A_b = 1$.\n    - The distance from the cell centroid to its boundary face is $\\ell_b = 10$.\n- **Physical Properties and Boundary Conditions:**\n    - Diffusivity: $k=1$ (constant).\n    - Boundary conditions: Dirichlet type, with value $\\phi_b = 0$ on the boundary faces.\n    - Boundary treatment is \"standard conservative\".\n- **Discretization Scheme:**\n    - For the interior face $f$, the implicit part of the flux is based on a \"two-point normal projection of Fick’s law\".\n    - The non-orthogonal (cross-diffusion) contribution is treated explicitly.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem is based on the standard diffusion equation and its discretization via the Finite Volume Method, a cornerstone of Computational Fluid Dynamics. The concepts of non-orthogonal meshes, explicit correction terms, and the Symmetric Positive Definite (SPD) property of the diffusion operator are all standard and well-established in the field. The setup is scientifically sound.\n2.  **Well-Posed:** For the given Dirichlet boundary conditions, the physical problem of steady-state diffusion is well-posed. The question concerns the properties of a specific numerical discretization, which is a valid and meaningful analysis.\n3.  **Objective:** The language is precise and quantitative. Terms like \"naive face-normal two-point evaluation\" and \"non-orthogonal correction\" are standard in the context of FVM. The data provided are objective.\n4.  **Completeness and Consistency:** The problem provides all necessary data to construct the $2 \\times 2$ matrix system for the unknowns $\\phi_P$ and $\\phi_N$. The description of the geometry, while simplified, is self-consistent. The term $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\approx -0.9$ indicates a mesh with obtuse angles between the face normal and the cell-connecting vector, which is a known cause of numerical difficulties, making the premise of the problem realistic.\n5.  **No other flaws detected.** The problem is a well-defined exercise in numerical analysis as applied to CFD.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. Proceeding to the solution.\n\n## Derivation of the Implicit Operator\n\nThe FVM approximates the integral conservation law by summing fluxes over the faces of a control volume. For steady state with no source ($s=0$), the sum of net fluxes out of a control volume is zero.\n\n### Discretized Equations\n\nThe equation for the control volume $\\Omega_P$ is:\n$$ F_{Pf} + F_{Pb} = S_{P, \\text{explicit}} $$\nwhere $F_{Pf}$ is the flux from $P$ to $N$ through face $f$, and $F_{Pb}$ is the flux out of the boundary face of $P$. $S_{P, \\text{explicit}}$ contains all explicitly treated terms. We are interested in the implicit operator, so we assemble the matrix based on terms containing the unknowns $\\phi_P$ and $\\phi_N$.\n\n**1. Interior Face Flux ($F_{Pf}$):**\nThe problem specifies a \"naive two-point normal projection\" for the implicit part. This corresponds to approximating the gradient at the face using the cell-center values and then projecting it onto the face normal.\nThe flux is $F_f = -k A_f (\\nabla \\phi)_f \\cdot \\boldsymbol{n}_f$.\nThe gradient is approximated as $(\\nabla \\phi)_f \\approx \\frac{\\phi_N - \\phi_P}{|\\boldsymbol{d}|} \\hat{\\boldsymbol{d}}$.\nSo, the implicit part of the flux leaving $P$ through $f$ is:\n$$ F_{Pf}^{\\text{implicit}} = -k A_f \\left( \\frac{\\phi_N - \\phi_P}{|\\boldsymbol{d}|} \\hat{\\boldsymbol{d}} \\right) \\cdot \\boldsymbol{n}_f = -k \\frac{A_f}{|\\boldsymbol{d}|} (\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f) (\\phi_N - \\phi_P) $$\nSubstituting the given values ($k=1, A_f=1, |\\boldsymbol{d}|=1, \\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\approx -0.9$):\n$$ F_{Pf}^{\\text{implicit}} = -(1) \\frac{1}{1} (-0.9) (\\phi_N - \\phi_P) = 0.9 (\\phi_N - \\phi_P) $$\n\n**2. Boundary Face Flux ($F_{Pb}$):**\nThe boundary treatment is a standard \"two-point\" flux between the cell center $P$ and the boundary, where $\\phi_b = 0$.\n$$ F_{Pb} = -k A_b \\frac{\\phi_b - \\phi_P}{\\ell_b} = -(1)(1) \\frac{0 - \\phi_P}{10} = 0.1 \\phi_P $$\nThis flux is inherently implicit.\n\n**3. Assembling the Equation for Cell P:**\nThe implicit part of the conservation equation for cell $P$ is $F_{Pf}^{\\text{implicit}} + F_{Pb} = 0$.\n$$ 0.9 (\\phi_N - \\phi_P) + 0.1 \\phi_P = 0 \\implies -0.8 \\phi_P + 0.9 \\phi_N = 0 $$\nThe first row of the system matrix operator is $[-0.8, 0.9]$.\n\n**4. Assembling the Equation for Cell N:**\nBy symmetry, the boundary flux for cell $N$ is $F_{Nb} = 0.1 \\phi_N$.\nThe flux leaving $N$ through face $f$ is $F_{Nf}$. The outward normal for $N$ at face $f$ is $-\\boldsymbol{n}_f$.\nThus, $F_{Nf} = -F_{Pf}$. The implicit part is:\n$$ F_{Nf}^{\\text{implicit}} = -F_{Pf}^{\\text{implicit}} = -0.9 (\\phi_N - \\phi_P) = 0.9 (\\phi_P - \\phi_N) $$\nThe implicit equation for cell $N$ is $F_{Nf}^{\\text{implicit}} + F_{Nb} = 0$.\n$$ 0.9 (\\phi_P - \\phi_N) + 0.1 \\phi_N = 0 \\implies 0.9 \\phi_P - 0.8 \\phi_N = 0 $$\nThe second row of the system matrix is $[0.9, -0.8]$.\n\n**5. The Implicit Matrix:**\nThe assembled implicit matrix $M$ is:\n$$ M = \\begin{bmatrix} -0.8 & 0.9 \\\\ 0.9 & -0.8 \\end{bmatrix} $$\nIn standard FVM practice, the diffusion matrix $A$ is formulated as $A\\phi=S$ where the diagonal elements are positive. This would be $A = -M$:\n$$ A = \\begin{bmatrix} 0.8 & -0.9 \\\\ -0.9 & 0.8 \\end{bmatrix} $$\nA matrix is SPD if it is symmetric and all its eigenvalues are positive. $A$ is symmetric. Its characteristic equation is $(0.8-\\lambda)^2 - (-0.9)^2 = 0$, giving $0.8-\\lambda = \\pm 0.9$. The eigenvalues are $\\lambda_1 = 0.8-0.9 = -0.1$ and $\\lambda_2 = 0.8+0.9 = 1.7$. Since one eigenvalue is negative, the matrix $A$ is not positive definite, and therefore not SPD.\n\n## Option-by-Option Analysis\n\n**A. On the given mesh with $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\approx -0.9$ and $\\ell_b = 10$, the naive two-point implicit normal flux produces the interior-face contribution coefficient $A_\\perp \\approx -0.9$. Assembling the implicit matrix yields...**\n\nThe analysis in this option first presents the matrix $M$, which we derived. It correctly states its eigenvalues are $0.1$ and $-1.7$. A matrix is SPD if it is symmetric and positive definite. The standard operator $A = -M$ has eigenvalues $-0.1$ and $1.7$, so it is not positive definite. Therefore, the statement \"the operator is not SPD\" is correct.\n\nThe proposed fix is to replace $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f$ with $|\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f| = 0.9$ in the implicit part of the flux calculation.\nThe new implicit flux out of $P$ through $f$ is:\n$$ F_{Pf, \\text{new}}^{\\text{implicit}} = -k \\frac{A_f}{|\\boldsymbol{d}|} |\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f| (\\phi_N - \\phi_P) = -(1)\\frac{1}{1}(0.9)(\\phi_N - \\phi_P) = 0.9(\\phi_P - \\phi_N) $$\nThe equation for $P$ is now $0.9(\\phi_P - \\phi_N) + 0.1 \\phi_P = S'_P$, which simplifies to $1.0 \\phi_P - 0.9 \\phi_N = S'_P$.\nThe equation for $N$ is $-F_{Pf, \\text{new}}^{\\text{implicit}} + F_{Nb} = S'_N$, giving $-0.9(\\phi_P - \\phi_N) + 0.1\\phi_N = S'_N$, which simplifies to $-0.9 \\phi_P + 1.0 \\phi_N = S'_N$.\nThe resulting implicit matrix (in the standard positive-diagonal form) is:\n$$ A_{\\text{new}} = \\begin{bmatrix} 1.0 & -0.9 \\\\ -0.9 & 1.0 \\end{bmatrix} $$\nThis matrix is symmetric. The characteristic equation is $(1.0 - \\lambda)^2 - (-0.9)^2 = 0$, giving $1.0 - \\lambda = \\pm 0.9$. The eigenvalues are $\\lambda_1 = 1.0 + 0.9 = 1.9$ and $\\lambda_2 = 1.0 - 0.9 = 0.1$. Both eigenvalues are positive, so the matrix is SPD. This matches the option's analysis. The fix is a form of deferred correction, where the difference between the original flux and the modified implicit part is treated explicitly, thus preserving local conservation at convergence.\nVerdict: **Correct**.\n\n**B. On the given mesh with $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\approx -0.9$ and $\\ell_b = 10$, the explicit non-orthogonal correction always ensures diagonal dominance of the implicit operator, so the naive two-point scheme necessarily remains SPD; no fix is required.**\n\nThe \"explicit non-orthogonal correction\" refers to the scheme we have analyzed. The resulting matrix is $A = \\begin{bmatrix} 0.8 & -0.9 \\\\ -0.9 & 0.8 \\end{bmatrix}$. A matrix is diagonally dominant if for every row, the absolute value of the diagonal element is strictly greater than the sum of the absolute values of the off-diagonal elements. For the first row, we check if $|0.8| > |-0.9|$, which is false ($0.8 \\ngtr 0.9$). The matrix is not diagonally dominant. As shown above, it is also not SPD. The statement that the scheme \"necessarily remains SPD\" is false.\nVerdict: **Incorrect**.\n\n**C. On a slightly non-orthogonal mesh with $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f = 0.2$ and $\\ell_b = 1$, the naive two-point scheme loses SPD, but making the entire cross-diffusion term fully implicit and assigning it entirely to the owner cell $P$ restores SPD while maintaining local conservation and symmetry.**\n\nLet's analyze the naive scheme with these new parameters: $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f = 0.2$ and $\\ell_b = 1$. The interior face flux from $P$ to $N$ is now:\n$F_{Pf}^{\\text{implicit}} = -k \\frac{A_f}{|\\boldsymbol{d}|} (\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f) (\\phi_N - \\phi_P) = -(1)\\frac{1}{1}(0.2)(\\phi_N - \\phi_P) = 0.2(\\phi_P - \\phi_N)$.\nThe boundary flux is $F_{Pb} = -k A_b \\frac{\\phi_b - \\phi_P}{\\ell_b} = -(1)(1)\\frac{0 - \\phi_P}{1} = 1.0 \\phi_P$.\nThe equation for $P$ (in $A\\phi=S$ form) becomes $(0.2+1.0)\\phi_P - 0.2\\phi_N = S'_P$, or $1.2\\phi_P - 0.2\\phi_N = S'_P$.\nBy symmetry, the equation for $N$ is $-0.2\\phi_P + 1.2\\phi_N = S'_N$.\nThe matrix is $ A' = \\begin{bmatrix} 1.2 & -0.2 \\\\ -0.2 & 1.2 \\end{bmatrix} $.\nThis matrix is symmetric. Its eigenvalues are given by $(1.2 - \\lambda)^2 - (-0.2)^2 = 0$, so $1.2 - \\lambda = \\pm 0.2$. The eigenvalues are $\\lambda_1 = 1.4$ and $\\lambda_2 = 1.0$. Both are positive, hence the matrix is SPD.\nThe premise of the option, \"the naive two-point scheme loses SPD\", is false for these parameters.\nVerdict: **Incorrect**.\n\n**D. On the given mesh with $\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f \\approx -0.9$ and $\\ell_b = 10$, an alternative conservative and SPD-preserving fix is to use a rotated-diffusion split...**\n\nThis option describes a more sophisticated fix.\n1.  **Implicit Normal Part:** It proposes to \"keep the implicit normal part with $|\\hat{\\boldsymbol{d}} \\cdot \\boldsymbol{n}_f|$\". This is identical to the fix proposed in Option A. As shown in the analysis of A, this results in the SPD matrix $A_{\\text{new}} = \\begin{bmatrix} 1.0 & -0.9 \\\\ -0.9 & 1.0 \\end{bmatrix}$.\n\n2.  **Implicit Tangential Part:** It proposes treating the tangential (cross-diffusion) part implicitly using a \"symmetric least-squares face-gradient\". This is a known advanced technique to maintain the SPD property.\n3.  **Analysis on the two-cell system:** The option correctly states that \"On this two-cell subsystem the tangential term contributes no additional implicit coupling\". A least-squares gradient reconstruction at face $f$ requires values from a stencil of cells surrounding $f$. In this minimal system, the only neighbors are $P$ and $N$. Any gradient reconstruction is therefore constrained to the direction of the vector $\\boldsymbol{d} = \\boldsymbol{x}_N - \\boldsymbol{x}_P$. The cross-diffusion term is, by construction, associated with the component of the flux normal vector that is orthogonal to $\\boldsymbol{d}$. Since the gradient cannot be resolved in any direction other than $\\boldsymbol{d}$, the dot product of the approximated gradient with the vector component defining the cross-diffusion is zero. Thus, the implicit tangential term adds nothing to the matrix in this specific two-cell case.\n4.  **Conclusion:** The implicit matrix for this method, on this specific mesh, reduces to that from the normal-part-only fix, which is the SPD matrix from Option A. The general description of the method as being conservative and SPD-preserving (on larger stencils) is also correct.\nVerdict: **Correct**.",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}