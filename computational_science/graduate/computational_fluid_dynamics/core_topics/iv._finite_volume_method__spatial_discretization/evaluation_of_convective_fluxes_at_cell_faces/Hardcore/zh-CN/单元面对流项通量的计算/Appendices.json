{
    "hands_on_practices": [
        {
            "introduction": "动手实践的第一步是理解数值格式的内在精度。本练习将分析一个基础的二阶中心差分格式，以评估其在均匀网格上对流一个简单线性标量场时的表现。通过推导其截断误差 ，我们将揭示该格式为何能精确重构线性分布，这是理解数值方法“阶”的含义的关键一步。",
            "id": "3316286",
            "problem": "考虑在有限体积法 (FVM) 中，均匀笛卡尔网格上的一维被动标量场平流问题。设标量场由线性分布 $\\phi(x)=\\phi_{0}+\\alpha x$ 给出，其中 $\\phi_{0}$ 和 $\\alpha$ 为常数，且密度 $\\rho$ 和速度 $u$ 为常数。用 $x_{i}$ 表示单元中心，其均匀间距为 $\\Delta x$，单元 $i$ 的东侧面用 $x_{i+\\frac{1}{2}}=(x_{i}+x_{i+1})/2$ 表示。通过一个面的对流通量由平流输运的标准FVM面积分定义，对于恒定的 $\\rho$ 和 $u$，这简化为质量通量与面上 $\\phi$ 值的乘积。\n\n使用二阶中心差分 (CD) 格式，根据相邻单元中心的值来近似 $x_{i+\\frac{1}{2}}$ 处的 $\\phi$ 面值，推导通过单元 $i$ 东侧面的离散对流通量，并将其与通过在 $x_{i+\\frac{1}{2}}$ 处计算 $\\phi(x)$ 得到的精确面对流通量进行比较。将东侧面上的归一化截断误差定义为\n$$\n\\varepsilon_{i+\\frac{1}{2}}=\\frac{F_{i+\\frac{1}{2}}^{\\mathrm{CD}}-F_{i+\\frac{1}{2}}^{\\mathrm{exact}}}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x},\n$$\n并假设 $u\\neq 0$ 和 $\\alpha\\neq 0$。计算 $\\varepsilon_{i+\\frac{1}{2}}$，并通过解释 $\\varepsilon_{i+\\frac{1}{2}}$ 的值，说明基于CD格式的离散对流算子对于此类线性分布是否精确。将 $\\varepsilon_{i+\\frac{1}{2}}$ 的最终答案表示为一个无单位的纯数；无需四舍五入。",
            "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取给定条件\n- **系统**：一维被动标量场 $\\phi$ 的平流。\n- **数值方法**：有限体积法 (FVM)。\n- **网格**：均匀笛卡尔网格，单元中心为 $x_{i}$，均匀间距为 $\\Delta x$。\n- **标量场分布**：$\\phi(x)=\\phi_{0}+\\alpha x$，其中 $\\phi_{0}$ 和 $\\alpha$ 是常数。\n- **流动属性**：密度 $\\rho$ 和速度 $u$ 是常数。\n- **面位置**：单元 $i$ 的东侧面位于 $x_{i+\\frac{1}{2}}=(x_{i}+x_{i+1})/2$。\n- **对流通量定义**：通量是质量通量 $(\\rho u)$ 与面上 $\\phi$ 值的乘积。\n- **近似格式**：使用二阶中心差分 (CD) 来近似面值 $\\phi_{i+\\frac{1}{2}}$。\n- **归一化截断误差定义**：\n$$\n\\varepsilon_{i+\\frac{1}{2}}=\\frac{F_{i+\\frac{1}{2}}^{\\mathrm{CD}}-F_{i+\\frac{1}{2}}^{\\mathrm{exact}}}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x}\n$$\n- **假设**：$u\\neq 0$ 且 $\\alpha\\neq 0$。\n\n### 步骤 2：使用提取的给定条件进行验证\n- **科学基础**：该问题是计算流体动力学 (CFD) 中数值格式分析的标准练习。FVM、平流、中心差分和截断误差等概念是该领域的基本且公认的概念。问题设定在科学上和数学上都是合理的。\n- **适定性**：该问题是适定的。所有必需的定义、函数和常数都已提供，足以推导出所求量。假设 $u \\neq 0$ 和 $\\alpha \\neq 0$ 确保了误差项的分母不为零，从而保证了有明确定义的唯一解。\n- **客观性**：语言客观、精确，使用了标准的数学和CFD术语。\n- **完整性与一致性**：问题是自洽且内部一致的。标量分布、面位置和数值格式的定义是兼容的，并且足以进行推导。\n\n### 步骤 3：结论与行动\n问题有效。将推导解答。\n\n任务是计算线性标量分布的对流通量的归一化截断误差 $\\varepsilon_{i+\\frac{1}{2}}$，其中通量使用二阶中心差分进行近似。这需要推导精确通量 $F_{i+\\frac{1}{2}}^{\\mathrm{exact}}$ 和近似通量 $F_{i+\\frac{1}{2}}^{\\mathrm{CD}}$ 的表达式。\n\n首先，我们确定通过位于 $x_{i+\\frac{1}{2}}$ 的单元 $i$ 东侧面的精确对流通量。该通量是单位面积质量通量 $\\rho u$ 与面上标量 $\\phi$ 的精确值的乘积。\n标量场由 $\\phi(x) = \\phi_0 + \\alpha x$ 给出。\n面上 $x_{i+\\frac{1}{2}}$ 处标量的精确值为：\n$$\n\\phi^{\\mathrm{exact}}_{i+\\frac{1}{2}} = \\phi(x_{i+\\frac{1}{2}}) = \\phi_0 + \\alpha x_{i+\\frac{1}{2}}\n$$\n因此，精确对流通量为：\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{exact}} = (\\rho u) \\phi^{\\mathrm{exact}}_{i+\\frac{1}{2}} = (\\rho u) (\\phi_0 + \\alpha x_{i+\\frac{1}{2}})\n$$\n\n接下来，我们使用二阶中心差分 (CD) 格式来确定离散对流通量 $F_{i+\\frac{1}{2}}^{\\mathrm{CD}}$，以近似面上的标量值。CD格式将面值近似为两个相邻单元中心 $x_i$ 和 $x_{i+1}$ 处值的线性插值。\n$$\n\\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}} = \\frac{\\phi_i + \\phi_{i+1}}{2}\n$$\n这里，$\\phi_i$ 和 $\\phi_{i+1}$ 是单元中心的标量值。由于我们正在分析格式的误差，这些值取自精确分布：\n$$\n\\phi_i = \\phi(x_i) = \\phi_0 + \\alpha x_i\n$$\n$$\n\\phi_{i+1} = \\phi(x_{i+1}) = \\phi_0 + \\alpha x_{i+1}\n$$\n将这些代入CD公式：\n$$\n\\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}} = \\frac{(\\phi_0 + \\alpha x_i) + (\\phi_0 + \\alpha x_{i+1})}{2} = \\frac{2\\phi_0 + \\alpha(x_i + x_{i+1})}{2} = \\phi_0 + \\alpha \\left( \\frac{x_i + x_{i+1}}{2} \\right)\n$$\n根据问题定义，面位置为 $x_{i+\\frac{1}{2}} = (x_i + x_{i+1})/2$。将此代入 $\\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}}$ 的表达式中：\n$$\n\\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}} = \\phi_0 + \\alpha x_{i+\\frac{1}{2}}\n$$\n这表明对于线性分布，中心差分近似的值与面上的精确值完全相同。\n于是，离散对流通量为：\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{CD}} = (\\rho u) \\phi^{\\mathrm{CD}}_{i+\\frac{1}{2}} = (\\rho u) (\\phi_0 + \\alpha x_{i+\\frac{1}{2}})\n$$\n现在，我们可以计算归一化截断误差的分子：\n$$\nF_{i+\\frac{1}{2}}^{\\mathrm{CD}} - F_{i+\\frac{1}{2}}^{\\mathrm{exact}} = (\\rho u) (\\phi_0 + \\alpha x_{i+\\frac{1}{2}}) - (\\rho u) (\\phi_0 + \\alpha x_{i+\\frac{1}{2}}) = 0\n$$\n最后，我们将此结果代入归一化截断误差 $\\varepsilon_{i+\\frac{1}{2}}$ 的定义中：\n$$\n\\varepsilon_{i+\\frac{1}{2}} = \\frac{F_{i+\\frac{1}{2}}^{\\mathrm{CD}}-F_{i+\\frac{1}{2}}^{\\mathrm{exact}}}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x} = \\frac{0}{\\rho\\,|u|\\,|\\alpha|\\,\\Delta x}\n$$\n鉴于 $\\rho > 0$、$u \\neq 0$、$\\alpha \\neq 0$ 和 $\\Delta x > 0$，分母不为零。因此，结果是：\n$$\n\\varepsilon_{i+\\frac{1}{2}} = 0\n$$\n对此结果的解释是归一化截断误差为零。这意味着对于任何作为位置线性函数的标量场，用于对流通量的二阶中心差分格式是精确的。这是预料之中的，因为二阶格式是从 Taylor 级数展开式在二阶项之后截断而构建的，而对于线性函数，所有二阶及更高阶的导数都为零。CD格式固有的线性插值完美地重建了线性函数在两个节点中点处的值。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "实际的CFD应用常常涉及复杂的几何形状，这需要使用非结构化网格。本练习将我们的关注点从简单的笛卡尔网格转移到更具挑战性的场景：如何在三角形这样的任意形状的单元面上计算通量。我们将通过推导和分析数值积分（求积）法则 ，来掌握在有限体积法中精确计算面积分的关键技术。",
            "id": "3316240",
            "problem": "考虑在计算流体动力学 (CFD) 的有限体积法 (FVM) 中使用的非结构化有限体积网格中的一个平面三角形面。一个无源标量穿过具有外向单位法向量 $\\mathbf{n}_f$ 的面的对流通量由面积分给出\n$$\n\\mathcal{F}_f \\;=\\; \\int_{A_f} \\rho\\,\\phi\\,\\left(\\mathbf{u}\\cdot\\mathbf{n}_f\\right)\\, dA,\n$$\n其中 $\\rho$ 是密度，$\\phi$ 是标量，$\\mathbf{u}$ 是速度， $A_f$ 是面面积。假设面是平的，因此 $\\mathbf{n}_f$ 在 $A_f$ 上是常数，并将面积分函数定义为 $f(\\mathbf{x}) = \\rho(\\mathbf{x})\\,\\phi(\\mathbf{x})\\,\\left(\\mathbf{u}(\\mathbf{x})\\cdot\\mathbf{n}_f\\right)$。\n\n从这个积分表达式和对低阶多项式精确的要求出发，为计算 $\\mathcal{F}_f$ 发展三角形面上的求积法则：\n- 推导一个对三角形上所有线性函数 $f$ 都精确的单点公式，并用面面积 $A_f$ 表示其节点位置和权重。\n- 推导一个对三角形上所有二次函数 $f$ 都精确的对称三点公式，并用面面积 $A_f$ 表示其节点位置和权重。\n\n然后，通过在面形心处对 $f$ 进行 Taylor 展开，分析这两种法则的精度阶。设该面的特征长度为 $h$ （例如，外接圆的直径），并假设 $f$ 在 $A_f$ 上是光滑的。确定单点和三点法则的绝对求积误差如何随 $h$ 变化。\n\n最后，在顶点为 $(0,0)$、$(1,0)$、$(0,1)$ 的参考三角形面（其面积为 $A_f = \\frac{1}{2}$）上验证这些构造。在该面上，取\n$$\nf(x,y) \\;=\\; 4 \\;+\\; 2x \\;-\\; 3y \\;+\\; 5xy \\;+\\; x^2 \\;+\\; 2y^2.\n$$\n计算精确积分 $\\int_{A_f} f\\, dA$ 以及由您推导的法则得到的单点和三点近似值。将单点误差定义为近似值减去精确积分值。作为您的最终答案，报告此特定测试函数和面上的单点误差，以无舍入、无单位的精确有理数形式给出。最终答案中不要包含任何其他量。",
            "solution": "面的对流通量为\n$$\n\\mathcal{F}_f \\;=\\; \\int_{A_f} f(\\mathbf{x})\\, dA, \\quad f(\\mathbf{x}) \\;=\\; \\rho(\\mathbf{x})\\,\\phi(\\mathbf{x})\\,\\left(\\mathbf{u}(\\mathbf{x})\\cdot\\mathbf{n}_f\\right),\n$$\n其中在平面上 $\\mathbf{n}_f$ 是常数。我们通过对多项式测试函数强制精确性来构造求积法则，并利用多项式精确性在从参考三角形进行映射下的仿射不变性。\n\n对线性函数精确的单点法则。考虑一个面积为 $A_f$、形心为 $\\mathbf{x}_c$ 的三角形面。对于任意仿射函数 $f(\\mathbf{x}) = a + \\mathbf{b}\\cdot\\mathbf{x}$，单形上的中值定理意味着 $f$ 在三角形上的平均值等于 $f$ 在形心处的取值。因此，对线性函数 $f$ 精确的单点求积公式为\n$$\n\\int_{A_f} f(\\mathbf{x})\\, dA \\;\\approx\\; A_f\\, f(\\mathbf{x}_c),\n$$\n其节点位于形心 $\\mathbf{x}_c$，权重为 $A_f$。\n\n对二次函数精确的对称三点法则。我们通过对称性推导一个三点法则。在顶点为 $(0,0)$, $(1,0)$, $(0,1)$ 且面积为 $A = \\frac{1}{2}$ 的参考三角形上，我们寻找三个节点，它们是满足 $a+2b=1$ 的重心坐标模式 $(a,b,b)$ 的排列，并具有相等的权重 $w$。根据仿射不变性，将此法则变换到任何物理三角形上，都会得到一个具有相同精确度等级的法则，其权重按物理面积进行缩放。\n\n我们对多项式基 $\\{1, x, y, x^2, y^2, xy\\}$ 强制精确性：\n- 对常数函数的精确性给出\n$$\n3w \\;=\\; A \\;=\\; \\frac{1}{2} \\;\\Rightarrow\\; w \\;=\\; \\frac{1}{6}.\n$$\n- 对 $x$ 和 $y$ 的精确性由对称性和重心约束 $a+2b=1$ 得出。例如，$x$ 的求积为\n$$\nQ[x] \\;=\\; w\\,(a + 2b) \\;=\\; w \\;=\\; \\frac{1}{6},\n$$\n与 $\\int_{A} x\\, dA = \\frac{1}{6}$ 相匹配。\n- 对于二次项，我们需要\n$$\nQ[x^2] \\;=\\; w\\,(a^2 + 2b^2) \\;=\\; \\int_{A} x^2\\, dA \\;=\\; \\frac{1}{12}, \\\\\nQ[xy] \\;=\\; w\\,(b^2 + 2ab) \\;=\\; \\int_{A} xy\\, dA \\;=\\; \\frac{1}{24}.\n$$\n使用 $w = \\frac{1}{6}$，这些变为\n$$\na^2 + 2b^2 \\;=\\; \\frac{1}{2}, \\qquad b^2 + 2ab \\;=\\; \\frac{1}{4},\n$$\n且有 $a+2b=1$。求解可得一个严格位于内部的容许解为\n$$\na \\;=\\; \\frac{2}{3}, \\qquad b \\;=\\; \\frac{1}{6}.\n$$\n因此，参考三角形（顶点为 $(0,0)$, $(1,0)$, $(0,1)$）上的三个节点的笛卡尔坐标为\n$$\n(x_1,y_1) \\;=\\; \\left(\\frac{1}{6},\\frac{1}{6}\\right), \\quad\n(x_2,y_2) \\;=\\; \\left(\\frac{2}{3},\\frac{1}{6}\\right), \\quad\n(x_3,y_3) \\;=\\; \\left(\\frac{1}{6},\\frac{2}{3}\\right),\n$$\n每个节点的权重为 $w = \\frac{1}{6}$。在面积为 $A_f$ 的一般三角形上，权重在这些参考点的三个仿射像处缩放为 $w_f = \\frac{A_f}{3}$。\n\n通过 Taylor 展开进行精度阶分析。设 $\\mathbf{x}_c$ 为物理面的形心，并设该面的特征长度为 $h$。将 $f$ 在 $\\mathbf{x}_c$ 处展开：\n$$\nf(\\mathbf{x}_c + \\boldsymbol{\\xi}) \\;=\\; f(\\mathbf{x}_c) \\;+\\; \\nabla f(\\mathbf{x}_c)\\cdot \\boldsymbol{\\xi} \\;+\\; \\frac{1}{2}\\,\\boldsymbol{\\xi}^{\\top}\\,\\nabla^2 f(\\mathbf{x}_c)\\,\\boldsymbol{\\xi} \\;+\\; \\frac{1}{6}\\sum_{i,j,k} \\partial_{ijk} f(\\mathbf{x}_c)\\,\\xi_i \\xi_j \\xi_k \\;+\\; \\cdots,\n$$\n其中 $\\boldsymbol{\\xi}$ 位于面平面内，且 $|\\boldsymbol{\\xi}| = \\mathcal{O}(h)$。精确积分是此级数在面域上的积分。单点法则计算 $A_f f(\\mathbf{x}_c)$，抵消了常数项和线性项的贡献，因为一阶矩 $\\int \\xi_i\\, dA$ 在形心处为零。主导误差项来自二次项：\n$$\nE_{\\text{1pt}} \\;=\\; \\int_{A_f} f\\, dA \\;-\\; A_f f(\\mathbf{x}_c) \\;=\\; \\frac{1}{2}\\int_{A_f} \\boldsymbol{\\xi}^{\\top}\\,\\nabla^2 f(\\mathbf{x}_c)\\,\\boldsymbol{\\xi}\\, dA \\;+\\; \\mathcal{O}(h^5).\n$$\n由于 $\\int_{A_f} \\xi_i \\xi_j\\, dA = \\mathcal{O}(h^4)$ 且 $A_f = \\mathcal{O}(h^2)$，绝对误差的尺度为\n$$\n|E_{\\text{1pt}}| \\;=\\; \\mathcal{O}(h^4).\n$$\n对于对所有二次函数都精确的三点公式，常数项、线性项和二次项都被精确积分，因此主导误差来自三次项，其面积分为 $\\mathcal{O}(h^5)$：\n$$\n|E_{\\text{3pt}}| \\;=\\; \\mathcal{O}(h^5).\n$$\n\n在参考三角形上的验证。设参考三角形为 $T = \\{(x,y)\\,:\\, x\\ge 0,\\; y\\ge 0,\\; x+y\\le 1\\}$，其面积为 $A = \\frac{1}{2}$。考虑\n$$\nf(x,y) \\;=\\; 4 \\;+\\; 2x \\;-\\; 3y \\;+\\; 5xy \\;+\\; x^2 \\;+\\; 2y^2.\n$$\n精确积分使用已知的单形-单项式积分结果：\n$$\n\\int_{T} 1\\, dA \\;=\\; \\frac{1}{2}, \\quad\n\\int_{T} x\\, dA \\;=\\; \\frac{1}{6}, \\quad\n\\int_{T} y\\, dA \\;=\\; \\frac{1}{6}, \\quad\n\\int_{T} xy\\, dA \\;=\\; \\frac{1}{24}, \\quad\n\\int_{T} x^2\\, dA \\;=\\; \\frac{1}{12}, \\quad\n\\int_{T} y^2\\, dA \\;=\\; \\frac{1}{12}.\n$$\n所以，\n$$\n\\int_{T} f\\, dA \\;=\\; 4\\cdot \\frac{1}{2} \\;+\\; 2\\cdot \\frac{1}{6} \\;-\\; 3\\cdot \\frac{1}{6} \\;+\\; 5\\cdot \\frac{1}{24} \\;+\\; 1\\cdot \\frac{1}{12} \\;+\\; 2\\cdot \\frac{1}{12}\n\\;=\\; \\frac{55}{24}.\n$$\n$T$ 上的单点法则使用形心 $(x_c,y_c) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 和权重 $A = \\frac{1}{2}$：\n$$\nf\\!\\left(\\frac{1}{3},\\frac{1}{3}\\right) \\;=\\; 4 \\;+\\; \\frac{2}{3} \\;-\\; 1 \\;+\\; \\frac{5}{9} \\;+\\; \\frac{1}{9} \\;+\\; \\frac{2}{9} \\;=\\; \\frac{41}{9},\n$$\n因此\n$$\nQ_{\\text{1pt}}[f] \\;=\\; \\frac{1}{2}\\cdot \\frac{41}{9} \\;=\\; \\frac{41}{18}.\n$$\n根据定义，单点误差（近似值减去精确值）为\n$$\nE_{\\text{1pt}} \\;=\\; \\frac{41}{18} \\;-\\; \\frac{55}{24} \\;=\\; -\\frac{1}{72}.\n$$\n为了完整起见，推导出的三点法则的节点为\n$$\n\\left(\\frac{1}{6},\\frac{1}{6}\\right),\\quad \\left(\\frac{2}{3},\\frac{1}{6}\\right),\\quad \\left(\\frac{1}{6},\\frac{2}{3}\\right),\n$$\n每个节点的权重为 $\\frac{1}{6}$。计算并求和，\n$$\nQ_{\\text{3pt}}[f] \\;=\\; \\frac{1}{6}\\Big(f\\!\\left(\\tfrac{1}{6},\\tfrac{1}{6}\\right) + f\\!\\left(\\tfrac{2}{3},\\tfrac{1}{6}\\right) + f\\!\\left(\\tfrac{1}{6},\\tfrac{2}{3}\\right)\\Big) \\;=\\; \\frac{55}{24},\n$$\n这与对于一个二阶精确法则的预期一样，与精确积分相匹配。\n\n因此，本测试案例所要求的单点误差是精确有理数值 $-\\frac{1}{72}$。",
            "answer": "$$\\boxed{-\\frac{1}{72}}$$"
        },
        {
            "introduction": "为了在CFD模拟中实现更高的精度，数值方法不仅需要单元中心的值，还需要单元内部变量的梯度信息。这个最终的实践模拟了现代CFD求解器中的一项核心任务：利用来自邻近单元的数据，通过稳健的最小二乘法重构梯度 。然后，我们将利用这个梯度将标量值精确地插值到单元面，并计算最终的对流通量，即便在网格非理想的情况下也能保证计算的准确性。",
            "id": "3316239",
            "problem": "考虑一个计算流体动力学（CFD）中的二维有限体积控制体。设标量场为被动组分的质量分数 $\\phi$，其由一个守恒输运方程控制。给定一个中心点位于 $\\boldsymbol{x}_{P} = (\\,0,\\,0\\,)$ 的单元 $P$，以及四个相邻单元的中心点坐标和标量值：\n- 东侧相邻单元 $E$：$\\boldsymbol{x}_{E} = (\\,1,\\,0\\,)$，$\\phi_{E} = 0.5$，\n- 西侧相邻单元 $W$：$\\boldsymbol{x}_{W} = (\\, -1,\\,0\\,)$，$\\phi_{W} = 0.1$，\n- 北侧相邻单元 $N$：$\\boldsymbol{x}_{N} = (\\,0,\\,2\\,)$，$\\phi_{N} = 0.2$，\n- 南侧相邻单元 $S$：$\\boldsymbol{x}_{S} = (\\,0,\\, -1\\,)$，$\\phi_{S} = 0.35$，\n以及中心值 $\\phi_{P} = 0.3$。\n\n$P$ 和 $E$ 之间的一个面 $f$ 的中心点为 $\\boldsymbol{x}_{f} = (\\,0.5,\\,0.1\\,)$，该点偏离了连接 $\\boldsymbol{x}_{P}$ 和 $\\boldsymbol{x}_{E}$ 的直线。该面的单位法向量为 $\\boldsymbol{n}_{f} = (\\,1,\\,0\\,)$，从 $P$ 指向 $E$，面面积为 $A_{f} = 0.8~\\mathrm{m^2}$。面中心的密度和速度分别为 $\\rho_{f} = 1.2~\\mathrm{kg\\,m^{-3}}$ 和 $\\boldsymbol{u}_{f} = (\\,2.0,\\,0.3\\,)~\\mathrm{m\\,s^{-1}}$。\n\n从 $\\phi$ 在 $\\boldsymbol{x}_{P}$ 点的一阶 Taylor 展开和加权最小二乘问题的定义出发，使用相邻单元差值和距离平方反比权重，推导梯度 $\\nabla \\phi\\big|_{P}$ 的最小二乘系统，并求解 $\\nabla \\phi\\big|_{P}$ 的数值。然后，使用重构的梯度线性预测在 $\\boldsymbol{x}_{f}$ 处的面值 $\\phi_{f}$，并计算通过面 $f$ 的对流组分质量流率，\n$$F_{\\mathrm{conv},f} \\;=\\; \\rho_{f}\\,\\left(\\boldsymbol{u}_{f}\\cdot \\boldsymbol{n}_{f}\\right)\\,A_{f}\\,\\phi_{f}.$$\n将最终的对流通量以 $\\mathrm{kg\\,s^{-1}}$ 为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算通过单元面的被动标量组分的对流通量。这个过程包括三个主要步骤：1) 使用加权最小二乘法在单元中心重构标量场的梯度，2) 使用此梯度将标量值外插到面中心，3) 使用给定公式计算对流通量。\n\n首先，我们进行问题验证。所给的问题陈述具有科学依据、问题适定且客观。它概述了计算流体动力学中有限体积法的标准程序。所有必要的数据均已提供，不存在内部矛盾或违反物理原理的情况。因此，该问题被认为是有效的，我们可以继续进行求解。\n\n梯度重构的核心是标量场 $\\phi$ 在单元中心点 $\\boldsymbol{x}_{P}$ 附近的一阶 Taylor 级数展开。对于任意相邻单元 $N_i$，其值 $\\phi_{N_i}$ 可以近似为：\n$$\n\\phi_{N_i} \\approx \\phi_{P} + \\nabla \\phi\\big|_{P} \\cdot (\\boldsymbol{x}_{N_i} - \\boldsymbol{x}_{P})\n$$\n令 $\\nabla \\phi\\big|_{P} = \\boldsymbol{g} = (g_x, g_y)$，$\\boldsymbol{r}_{i} = \\boldsymbol{x}_{N_i} - \\boldsymbol{x}_{P} = ((\\Delta x)_i, (\\Delta y)_i)$，以及 $\\Delta \\phi_i = \\phi_{N_i} - \\phi_P$。对每个相邻单元的近似为：\n$$\n\\Delta \\phi_i \\approx \\boldsymbol{g} \\cdot \\boldsymbol{r}_{i} = g_x (\\Delta x)_i + g_y (\\Delta y)_i\n$$\n我们有四个相邻单元（$E$、$W$、$N$、$S$），这为梯度的两个分量 $g_x$ 和 $g_y$ 产生了一个超定线性方程组。我们通过最小化加权残差平方和 $J$ 来求解该系统：\n$$\nJ(\\boldsymbol{g}) = \\sum_{i \\in \\{E,W,N,S\\}} w_i \\left( \\boldsymbol{g} \\cdot \\boldsymbol{r}_{i} - \\Delta \\phi_i \\right)^2\n$$\n权重 $w_i$ 由距离平方反比给出，即 $w_i = |\\boldsymbol{r}_{i}|^{-2}$。\n\n让我们计算所需的向量、标量和权重。中心单元位于 $\\boldsymbol{x}_{P} = (0, 0)$，其值为 $\\phi_{P} = 0.3$。\n对于东侧相邻单元 $E$：\n$\\boldsymbol{x}_{E} = (1, 0)$，$\\phi_{E} = 0.5$。\n$\\boldsymbol{r}_{E} = (1, 0)$，$\\Delta \\phi_E = 0.5 - 0.3 = 0.2$。\n$|\\boldsymbol{r}_{E}|^2 = 1^2 + 0^2 = 1$，所以 $w_E = 1/1 = 1$。\n\n对于西侧相邻单元 $W$：\n$\\boldsymbol{x}_{W} = (-1, 0)$，$\\phi_{W} = 0.1$。\n$\\boldsymbol{r}_{W} = (-1, 0)$，$\\Delta \\phi_W = 0.1 - 0.3 = -0.2$。\n$|\\boldsymbol{r}_{W}|^2 = (-1)^2 + 0^2 = 1$，所以 $w_W = 1/1 = 1$。\n\n对于北侧相邻单元 $N$：\n$\\boldsymbol{x}_{N} = (0, 2)$，$\\phi_{N} = 0.2$。\n$\\boldsymbol{r}_{N} = (0, 2)$，$\\Delta \\phi_N = 0.2 - 0.3 = -0.1$。\n$|\\boldsymbol{r}_{N}|^2 = 0^2 + 2^2 = 4$，所以 $w_N = 1/4 = 0.25$。\n\n对于南侧相邻单元 $S$：\n$\\boldsymbol{x}_{S} = (0, -1)$，$\\phi_{S} = 0.35$。\n$\\boldsymbol{r}_{S} = (0, -1)$，$\\Delta \\phi_S = 0.35 - 0.3 = 0.05$。\n$|\\boldsymbol{r}_{S}|^2 = 0^2 + (-1)^2 = 1$，所以 $w_S = 1/1 = 1$。\n\n为了最小化 $J$，我们将其关于 $g_x$ 和 $g_y$ 的偏导数设为零，得到正规方程组：\n$$\n\\begin{pmatrix} \\sum_i w_i (\\Delta x)_i^2  \\sum_i w_i (\\Delta x)_i (\\Delta y)_i \\\\ \\sum_i w_i (\\Delta x)_i (\\Delta y)_i  \\sum_i w_i (\\Delta y)_i^2 \\end{pmatrix} \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\begin{pmatrix} \\sum_i w_i (\\Delta x)_i \\Delta \\phi_i \\\\ \\sum_i w_i (\\Delta y)_i \\Delta \\phi_i \\end{pmatrix}\n$$\n我们计算矩阵和右侧向量的分量：\n$\\sum_i w_i (\\Delta x)_i^2 = w_E(1)^2 + w_W(-1)^2 + w_N(0)^2 + w_S(0)^2 = 1(1) + 1(1) + 0 + 0 = 2$。\n$\\sum_i w_i (\\Delta y)_i^2 = w_E(0)^2 + w_W(0)^2 + w_N(2)^2 + w_S(-1)^2 = 0 + 0 + 0.25(4) + 1(1) = 1 + 1 = 2$。\n$\\sum_i w_i (\\Delta x)_i (\\Delta y)_i = w_E(1)(0) + w_W(-1)(0) + w_N(0)(2) + w_S(0)(-1) = 0$。\n\n$\\sum_i w_i (\\Delta x)_i \\Delta \\phi_i = w_E(1)(0.2) + w_W(-1)(-0.2) + w_N(0)(-0.1) + w_S(0)(0.05) = 0.2 + 0.2 + 0 + 0 = 0.4$。\n$\\sum_i w_i (\\Delta y)_i \\Delta \\phi_i = w_E(0)(0.2) + w_W(0)(-0.2) + w_N(2)(-0.1) + w_S(-1)(0.05) = 0 + 0 + 0.25(-0.2) + 1(-0.05) = -0.05 - 0.05 = -0.1$。\n\n该方程组为：\n$$\n\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} g_x \\\\ g_y \\end{pmatrix} = \\begin{pmatrix} 0.4 \\\\ -0.1 \\end{pmatrix}\n$$\n求解 $g_x$ 和 $g_y$：\n$2 g_x = 0.4 \\implies g_x = 0.2$。\n$2 g_y = -0.1 \\implies g_y = -0.05$。\n因此，在单元中心重构的梯度为 $\\nabla \\phi\\big|_{P} = (0.2, -0.05)$。\n\n接下来，我们使用此梯度线性外插到面中心 $\\boldsymbol{x}_f = (0.5, 0.1)$ 处的标量值 $\\phi_f$。\n外插公式为：\n$$\n\\phi_f = \\phi_P + \\nabla \\phi\\big|_{P} \\cdot (\\boldsymbol{x}_f - \\boldsymbol{x}_P)\n$$\n位移向量为 $\\boldsymbol{r}_{Pf} = \\boldsymbol{x}_f - \\boldsymbol{x}_P = (0.5, 0.1) - (0, 0) = (0.5, 0.1)$。\n代入数值：\n$$\n\\phi_f = 0.3 + (0.2, -0.05) \\cdot (0.5, 0.1) = 0.3 + (0.2)(0.5) + (-0.05)(0.1)\n$$\n$$\n\\phi_f = 0.3 + 0.1 - 0.005 = 0.395\n$$\n\n最后，我们计算通过面 $f$ 的对流组分质量流率 $F_{\\mathrm{conv},f}$：\n$$\nF_{\\mathrm{conv},f} = \\rho_f (\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f) A_f \\phi_f\n$$\n给定值为 $\\rho_f = 1.2~\\mathrm{kg\\,m^{-3}}$、$\\boldsymbol{u}_f = (2.0, 0.3)~\\mathrm{m\\,s^{-1}}$、$\\boldsymbol{n}_f = (1, 0)$ 和 $A_f = 0.8~\\mathrm{m^2}$。\n首先，我们计算面上的速度法向分量：\n$$\n\\boldsymbol{u}_f \\cdot \\boldsymbol{n}_f = (2.0, 0.3) \\cdot (1, 0) = (2.0)(1) + (0.3)(0) = 2.0~\\mathrm{m\\,s^{-1}}\n$$\n现在我们可以计算通量：\n$$\nF_{\\mathrm{conv},f} = (1.2~\\mathrm{kg\\,m^{-3}}) \\times (2.0~\\mathrm{m\\,s^{-1}}) \\times (0.8~\\mathrm{m}^2) \\times 0.395\n$$\n$$\nF_{\\mathrm{conv},f} = 1.92~\\mathrm{kg\\,s^{-1}} \\times 0.395 = 0.7584~\\mathrm{kg\\,s^{-1}}\n$$\n问题要求答案四舍五入到四位有效数字。计算值 $0.7584$ 已经有四位有效数字。",
            "answer": "$$\n\\boxed{0.7584}\n$$"
        }
    ]
}