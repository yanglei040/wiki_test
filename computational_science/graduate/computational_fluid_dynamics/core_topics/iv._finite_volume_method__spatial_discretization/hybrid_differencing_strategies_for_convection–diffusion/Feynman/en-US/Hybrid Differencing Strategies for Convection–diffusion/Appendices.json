{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in mastering any numerical method is to verify its fundamental properties through implementation. This practice guides you through a foundational numerical experiment: performing a grid refinement study for a one-dimensional convection-diffusion problem using a classic hybrid differencing scheme. By implementing the code and analyzing the results, you will directly observe how the scheme's accuracy changes between diffusion-dominated and convection-dominated regimes, providing tangible confirmation of the theoretical trade-off between stability and accuracy that motivates hybrid strategies .",
            "id": "3330986",
            "problem": "Consider the steady one-dimensional convection–diffusion boundary value problem on the interval $[0,1]$ with Dirichlet boundary conditions: find a sufficiently smooth function $u(x)$ such that\n$$\na\\,\\frac{d u}{d x}(x) - D\\,\\frac{d^2 u}{d x^2}(x) = 0,\\quad x \\in (0,1),\\qquad u(0) = 0,\\quad u(1) = 1,\n$$\nwhere $a$ and $D$ are real constants representing the advective speed and diffusivity, respectively. All quantities are dimensionless (no physical units). The task is to perform grid refinement studies using a hybrid differencing strategy for the convection term and to extract the observed order of accuracy in diffusion-dominated and convection-dominated regimes.\n\nImplement the Finite Difference Method (FDM) for the spatial discretization with a uniform grid spacing $\\Delta x = h = 1/N$, where $N$ is the total number of intervals and the grid has nodes at $x_i = i h$ for $i=0,1,\\dots,N$. Always approximate the diffusion term $-D\\,\\frac{d^2 u}{d x^2}$ by the standard second-order central difference. For the convection term $a\\,\\frac{d u}{d x}$, adopt the following hybrid differencing strategy based on the local cell Peclet number $P_{\\Delta} = \\frac{|a|\\,\\Delta x}{D}$:\n- If $P_{\\Delta} \\le 2$, use the second-order central difference for $\\frac{d u}{d x}$ at interior nodes.\n- If $P_{\\Delta} > 2$, use the first-order upwind difference for $\\frac{d u}{d x}$ aligned with the sign of $a$ at interior nodes (i.e., for $a>0$, use the backward difference; for $a<0$, use the forward difference).\n\nYou must:\n- Assemble the resulting tridiagonal linear system for the interior unknowns $u_i$ at nodes $x_i$ for $i=1,\\dots,N-1$ with $u_0=0$ and $u_N=1$ imposed directly.\n- Solve the linear system and compute the numerical solution $u^{(h)}(x_i)$ at all nodes.\n- Compute the discrete $\\ell^2$ error norm against the exact solution $u(x)$ of the boundary value problem derived from the governing equation,\n$$\nE(h) = \\left(\\Delta x \\sum_{i=0}^{N} \\left(u^{(h)}(x_i) - u(x_i)\\right)^2\\right)^{1/2}.\n$$\n- For each test regime, compute the observed order of accuracy $p$ by performing a least-squares linear regression of $\\log(E(h))$ against $\\log(h)$ over the refinement sequence. That is, determine $p$ such that $\\log(E(h)) \\approx \\alpha + p\\,\\log(h)$ for some constant $\\alpha$.\n\nTest suite:\n- Use $D=1$ for all tests. For each case, provide the sequence of $N$ values as listed.\n    $1.$ Diffusion-dominated regime: $a=0.1$, $N\\in\\{32,64,128,256,512\\}$.\n    $2.$ Convection-dominated regime with positive advection: $a=400$, $N\\in\\{8,16,32,64\\}$.\n    $3.$ Pure diffusion boundary value problem: $a=0$, $N\\in\\{32,64,128,256,512\\}$.\n    $4.$ Convection-dominated regime with negative advection: $a=-400$, $N\\in\\{8,16,32,64\\}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the four observed orders of accuracy for cases $1$ through $4$ as a comma-separated list enclosed in square brackets, rounded to three decimal places, for example, $[p_1,p_2,p_3,p_4]$.\n\nAngle units are not applicable. Percentages are not applicable. All quantities are dimensionless. The exact solution used for error evaluation must be derived from the differential equation and boundary conditions, not empirically specified.",
            "solution": "The user-provided problem is a well-posed boundary value problem (BVP) from computational fluid dynamics, requiring a numerical solution and error analysis. The problem is scientifically grounded, self-contained, and calls for the application of standard, verifiable numerical methods. Therefore, the problem is valid.\n\nThe solution process involves several steps:\n1.  Deriving the exact analytical solution to the BVP to serve as a benchmark for accuracy.\n2.  Discretizing the governing differential equation using the specified hybrid finite difference scheme.\n3.  Assembling and solving the resulting tridiagonal linear system of equations.\n4.  Computing the discrete $\\ell^2$ error norm for a sequence of refined grids.\n5.  Calculating the observed order of accuracy, $p$, by performing a linear regression on the log-log plot of error versus grid spacing.\n\n### 1. Analytical Solution\nThe governing ordinary differential equation (ODE) is a second-order linear homogeneous equation with constant coefficients:\n$$\nD\\,\\frac{d^2 u}{d x^2}(x) - a\\,\\frac{d u}{d x}(x) = 0\n$$\nThe characteristic equation is $D r^2 - a r = r(D r - a) = 0$, which has roots $r_1 = 0$ and $r_2 = a/D$.\n\nFor $a \\neq 0$, the general solution is of the form $u(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x}$, which gives:\n$$\nu(x) = C_1 + C_2 e^{(a/D)x}\n$$\nThe constants $C_1$ and $C_2$ are determined by the Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 1$.\nApplying $u(0) = 0$:\n$$\nC_1 + C_2 e^0 = 0 \\implies C_1 = -C_2\n$$\nApplying $u(1) = 1$:\n$$\nC_1 + C_2 e^{a/D} = 1\n$$\nSubstituting $C_1 = -C_2$ into the second equation gives $-C_2 + C_2 e^{a/D} = 1$, which yields $C_2 = 1 / (e^{a/D} - 1)$. Consequently, $C_1 = -1 / (e^{a/D} - 1)$.\nThe exact solution for $a \\neq 0$ is:\n$$\nu(x) = \\frac{e^{(a/D)x} - 1}{e^{a/D} - 1}\n$$\n\nFor the special case $a = 0$, the ODE simplifies to $D u''(x) = 0$, which integrates to $u(x) = C_1 x + C_2$. Applying the boundary conditions $u(0)=0$ and $u(1)=1$ gives $C_2=0$ and $C_1=1$, respectively. Thus, for $a=0$, the exact solution is:\n$$\nu(x) = x\n$$\nThis result can also be obtained by taking the limit of the general solution as $a \\to 0$ using L'Hôpital's rule.\n\n### 2. Finite Difference Discretization\nWe discretize the domain $[0,1]$ using a uniform grid with $N$ intervals, such that the grid spacing is $h = \\Delta x = 1/N$ and the grid nodes are $x_i = i h$ for $i = 0, 1, \\dots, N$. The numerical solution at these nodes is denoted by $u_i \\approx u(x_i)$. The values $u_0=0$ and $u_N=1$ are known from the boundary conditions. We seek to find the interior values $u_1, \\dots, u_{N-1}$.\n\nThe discretized equation at an interior node $x_i$ is:\n$$\na \\left(\\frac{du}{dx}\\right)_i - D \\left(\\frac{d^2u}{dx^2}\\right)_i = 0\n$$\nThe diffusion term is always approximated by the second-order central difference:\n$$\n- D \\left(\\frac{d^2u}{dx^2}\\right)_i \\approx -D \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\nThe convection term is approximated using a hybrid scheme based on the cell Peclet number $P_{\\Delta} = \\frac{|a|h}{D}$.\n\n**Case A: $P_{\\Delta} \\le 2$ (Central Difference Scheme)**\nThe convection term is approximated by the second-order central difference:\n$$\na \\left(\\frac{du}{dx}\\right)_i \\approx a \\frac{u_{i+1} - u_{i-1}}{2h}\n$$\nSubstituting these approximations into the governing ODE and rearranging terms to the form $a_P u_i = a_W u_{i-1} + a_E u_{i+1}$ yields:\n$$\n\\frac{2D}{h^2} u_i = \\left(\\frac{D}{h^2} + \\frac{a}{2h}\\right) u_{i-1} + \\left(\\frac{D}{h^2} - \\frac{a}{2h}\\right) u_{i+1}\n$$\nThe coefficients are:\n$a_W = \\frac{D}{h} + \\frac{a}{2}$, $a_E = \\frac{D}{h} - \\frac{a}{2}$, and $a_P = a_W + a_E = \\frac{2D}{h}$.\n\n**Case B: $P_{\\Delta} > 2$ (Upwind Difference Scheme)**\nThe scheme becomes first-order upwind.\nIf $a>0$, a backward difference is used: $a \\left(\\frac{du}{dx}\\right)_i \\approx a \\frac{u_i - u_{i-1}}{h}$.\nThe discretized equation is:\n$$\n\\left(\\frac{2D}{h^2} + \\frac{a}{h}\\right) u_i = \\left(\\frac{D}{h^2} + \\frac{a}{h}\\right) u_{i-1} + \\left(\\frac{D}{h^2}\\right) u_{i+1}\n$$\nThe coefficients are:\n$a_W = \\frac{D}{h} + a$, $a_E = \\frac{D}{h}$, and $a_P = a_W + a_E = \\frac{2D}{h} + a$.\n\nIf $a<0$, a forward difference is used: $a \\left(\\frac{du}{dx}\\right)_i \\approx a \\frac{u_{i+1} - u_{i}}{h}$.\nThe discretized equation is:\n$$\n\\left(\\frac{2D}{h^2} - \\frac{a}{h}\\right) u_i = \\left(\\frac{D}{h^2}\\right) u_{i-1} + \\left(\\frac{D}{h^2} - \\frac{a}{h}\\right) u_{i+1}\n$$\nThe coefficients are:\n$a_W = \\frac{D}{h}$, $a_E = \\frac{D}{h} - a$, and $a_P = a_W + a_E = \\frac{2D}{h} - a$.\n\n### 3. Linear System Assembly\nFor each interior node $i=1, \\dots, N-1$, we have an equation of the form:\n$$\n-a_W u_{i-1} + a_P u_i - a_E u_{i+1} = 0\n$$\nSince $a_W, a_P, a_E$ are constant across the uniform grid for a given test case, this forms a tridiagonal system of linear equations $A\\vec{u} = \\vec{b}$ for the vector of unknowns $\\vec{u} = [u_1, u_2, \\dots, u_{N-1}]^T$.\n\nThe matrix $A$ is an $(N-1) \\times (N-1)$ tridiagonal matrix:\n$$\nA = \\begin{pmatrix}\na_P & -a_E & 0 & \\dots & 0 \\\\\n-a_W & a_P & -a_E & \\dots & 0 \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n0 & \\dots & -a_W & a_P & -a_E \\\\\n0 & \\dots & 0 & -a_W & a_P\n\\end{pmatrix}\n$$\nThe right-hand side vector $\\vec{b}$ incorporates the boundary conditions.\nFor $i=1$: $-a_W u_0 + a_P u_1 - a_E u_2 = 0$. With $u_0=0$, this is $a_P u_1 - a_E u_2 = 0$.\nFor $i=N-1$: $-a_W u_{N-2} + a_P u_{N-1} - a_E u_N = 0$. With $u_N=1$, this becomes $-a_W u_{N-2} + a_P u_{N-1} = a_E$.\nThus, the vector $\\vec{b}$ is:\n$$\n\\vec{b} = [0, 0, \\dots, 0, a_E]^T\n$$\nThis tridiagonal system can be efficiently solved using specialized algorithms, such as `scipy.linalg.solve_banded`.\n\n### 4. Error Analysis and Order of Accuracy\nAfter solving for the numerical solution $u^{(h)} = [u_0, u_1, \\dots, u_N]^T$, we compute the discrete $\\ell^2$ error norm against the exact solution $u(x_i)$:\n$$\nE(h) = \\left(h \\sum_{i=0}^{N} \\left(u_i - u(x_i)\\right)^2\\right)^{1/2}\n$$\nThe theoretical convergence rate is $E(h) \\approx C h^p$, where $p$ is the order of accuracy. To find the observed order, we take the logarithm:\n$$\n\\log(E(h)) \\approx \\log(C) + p \\log(h)\n$$\nBy computing $E(h)$ for a sequence of grid spacings $h$, we can perform a linear regression on $\\log(E(h))$ versus $\\log(h)$. The slope of the resulting line is the observed order of accuracy, $p$.\n\n### 5. Analysis of Test Cases\n- **Case 1 ($a=0.1, D=1$):** With $N \\ge 32$, $h \\le 1/32$. The maximum $P_{\\Delta} = 0.1 \\times (1/32) / 1 \\approx 0.0031$, which is much less than $2$. The second-order central difference scheme is used, so we expect $p \\approx 2.0$.\n- **Case 2 ($a=400, D=1$):** With $N \\le 64$, $h \\ge 1/64$. The minimum $P_{\\Delta} = 400 \\times (1/64) / 1 = 6.25$, which is greater than $2$. The first-order upwind scheme is used, so we expect $p \\approx 1.0$.\n- **Case 3 ($a=0, D=1$):** $P_{\\Delta} = 0$, so the central difference scheme is used. The scheme reduces to the standard stencil for the second derivative, and the exact solution is $u(x)=x$. The finite difference method recovers this linear solution exactly in the absence of floating-point error. Numerically, the error will be at the level of machine precision, and thus roughly constant for all $h$. This leads to an observed order of accuracy $p \\approx 0.0$.\n- **Case 4 ($a=-400, D=1$):** Similar to Case 2, the minimum $P_{\\Delta} = |-400| \\times (1/64) / 1 = 6.25 > 2$. The first-order upwind scheme is used, and we expect $p \\approx 1.0$.\n\nThe implementation will follow this logic to compute the four values of $p$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D steady convection-diffusion equation using a hybrid finite\n    difference scheme and calculates the observed order of accuracy for\n    four different test regimes.\n    \"\"\"\n\n    def get_exact_solution(x, a, D):\n        \"\"\"\n        Computes the exact analytical solution to the BVP.\n        \"\"\"\n        if a == 0.0:\n            return x\n        else:\n            ratio = a / D\n            # Use np.expm1 for numerical stability when ratio is close to zero.\n            return np.expm1(ratio * x) / np.expm1(ratio)\n\n    def solve_one_case(a, D, N_values):\n        \"\"\"\n        Performs grid refinement study for a single (a, D) case.\n        Returns the observed order of accuracy.\n        \"\"\"\n        h_list = []\n        error_list = []\n\n        for N in N_values:\n            # 1. Grid setup\n            h = 1.0 / N\n            x_nodes = np.linspace(0.0, 1.0, N + 1)\n            \n            # 2. Determine scheme based on cell Peclet number\n            P_delta = np.abs(a) * h / D\n\n            if P_delta <= 2.0:\n                # Central Difference Scheme for convection\n                a_W = D/h + a/2.0\n                a_E = D/h - a/2.0\n                # Per the control volume formulation, a_P = a_W + a_E for CDS\n                a_P = 2.0*D/h\n            else:\n                # Upwind Scheme for convection\n                if a > 0.0:\n                    # Backward difference\n                    a_W = D/h + a\n                    a_E = D/h\n                    a_P = a_W + a_E # = 2*D/h + a\n                else: # a < 0.0\n                    # Forward difference\n                    a_W = D/h\n                    a_E = D/h - a\n                    a_P = a_W + a_E # = 2*D/h - a\n            \n            # 3. Assemble the tridiagonal linear system Au = b\n            dim = N - 1\n            ab = np.zeros((3, dim))\n            b = np.zeros(dim)\n            \n            # Fill the banded matrix 'ab' for scipy.linalg.solve_banded\n            # ab[0, 1:] = super-diagonal\n            # ab[1, :]   = main-diagonal\n            # ab[2, :-1]= sub-diagonal\n            ab[1, :] = a_P\n            if dim > 0:\n                ab[0, 1:] = -a_E\n                ab[2, :-1] = -a_W\n\n            # 4. Apply boundary conditions\n            # u_0 = 0 is handled implicitly as it doesn't add to the RHS\n            # u_N = 1 affects the last equation (for u_{N-1})\n            if dim > 0:\n                # The term -a_E * u_N becomes a_E on the RHS\n                b[-1] = a_E * 1.0\n            \n            # 5. Solve the system\n            if dim > 0:\n                u_internal = solve_banded((1, 1), ab, b)\n            else:\n                u_internal = np.array([])\n            \n            # 6. Construct full numerical solution vector\n            u_numerical = np.zeros(N + 1)\n            u_numerical[0] = 0.0\n            u_numerical[-1] = 1.0\n            u_numerical[1:-1] = u_internal\n\n            # 7. Compute the l2-error\n            u_exact = get_exact_solution(x_nodes, a, D)\n            error_sq_sum = np.sum((u_numerical - u_exact)**2)\n            error = np.sqrt(h * error_sq_sum)\n            \n            # Handle cases where error is zero to avoid log(0)\n            if error < np.finfo(np.float64).tiny:\n                error = np.finfo(np.float64).tiny\n\n            h_list.append(h)\n            error_list.append(error)\n        \n        # 8. Calculate order of accuracy using linear regression\n        log_h = np.log(np.array(h_list))\n        log_error = np.log(np.array(error_list))\n        \n        # Fit a line: log(error) = p * log(h) + const\n        p, _ = np.polyfit(log_h, log_error, 1)\n        \n        return p\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'a': 0.1,  'D': 1.0, 'N_values': [32, 64, 128, 256, 512]}, # Diffusion-dominated\n        {'a': 400.0, 'D': 1.0, 'N_values': [8, 16, 32, 64]}, # Convection-dominated, a>0\n        {'a': 0.0,  'D': 1.0, 'N_values': [32, 64, 128, 256, 512]}, # Pure diffusion\n        {'a': -400.0, 'D': 1.0, 'N_values': [8, 16, 32, 64]}, # Convection-dominated, a<0\n    ]\n\n    results = []\n    for case in test_cases:\n        order_p = solve_one_case(case['a'], case['D'], case['N_values'])\n        results.append(order_p)\n\n    # Format the final output string\n    formatted_results = [f\"{p:.3f}\" for p in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having verified the basic properties of a hybrid scheme, we now explore its practical advantages in a more complex scenario. This exercise employs the Method of Manufactured Solutions to create a test case with a sharp internal layer, where the local cell Peclet number varies significantly across the domain. By comparing the performance of an adaptive blending strategy against fixed schemes (pure central, pure upwind, and a simple average), you will quantify the superior accuracy that adaptivity offers, demonstrating why modern schemes dynamically adjust their properties to match local flow conditions .",
            "id": "3331018",
            "problem": "Consider the one-dimensional steady convection–diffusion equation on the domain $[0,1]$ with spatial coordinate $x$,\n$$u(x)\\,\\frac{d\\phi}{dx} \\;=\\; \\nu\\,\\frac{d^2\\phi}{dx^2} \\;+\\; s(x),$$\nwhere $u(x)$ is a prescribed spatially varying convection speed, $\\nu>0$ is the constant diffusion coefficient, and $s(x)$ is a source term fabricated to enforce a chosen exact solution. Use Dirichlet boundary conditions $\\phi(0)=\\phi_{\\text{exact}}(0)$ and $\\phi(1)=\\phi_{\\text{exact}}(1)$.\n\nTo introduce an internal layer while keeping the problem solvable by construction, employ the Method of Manufactured Solutions. Let the exact solution be\n$$\\phi_{\\text{exact}}(x) \\;=\\; \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right)\\right),$$\nwith a small positive parameter $\\delta_\\phi$ controlling the internal layer thickness near $x=1/2$. Define the spatially varying convection speed\n$$u(x) \\;=\\; u_0 \\;+\\; u_{\\mathrm{amp}}\\,\\tanh\\!\\left(\\frac{x - 1/2}{\\delta_u}\\right),$$\nwith parameters $u_0>0$, $u_{\\mathrm{amp}}\\ge 0$, and $\\delta_u>0$ chosen so that $u(x)\\ge 0$ for all $x\\in[0,1]$. Compute the corresponding source term $s(x)$ analytically by substituting $\\phi_{\\text{exact}}(x)$ and $u(x)$ into the governing equation.\n\nDiscretize the domain into a uniform grid of $N+1$ points with spacing $\\Delta x = 1/N$. Approximate the diffusion term by the standard second-order central difference\n$$\\frac{d^2\\phi}{dx^2}\\Big|_{x_i} \\approx \\frac{\\phi_{i+1} - 2\\phi_{i} + \\phi_{i-1}}{\\Delta x^2},$$\nand approximate the convection term with a hybrid differencing strategy that blends central differencing and upwind differencing via a local blending weight $\\beta_i\\in[0,1]$:\n- Central difference at node $i$: $$\\left(\\frac{d\\phi}{dx}\\right)^{\\mathrm{CD}}_i \\approx \\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x}.$$\n- Upwind difference at node $i$ for $u(x_i)\\ge 0$: $$\\left(\\frac{d\\phi}{dx}\\right)^{\\mathrm{UD}}_i \\approx \\frac{\\phi_{i} - \\phi_{i-1}}{\\Delta x}.$$\n- Upwind difference at node $i$ for $u(x_i)< 0$: $$\\left(\\frac{d\\phi}{dx}\\right)^{\\mathrm{UD}}_i \\approx \\frac{\\phi_{i+1} - \\phi_{i}}{\\Delta x}.$$\n- Hybrid blend: $$\\left(\\frac{d\\phi}{dx}\\right)^{\\mathrm{HYB}}_i \\approx (1-\\beta_i)\\,\\left(\\frac{d\\phi}{dx}\\right)^{\\mathrm{CD}}_i \\;+\\; \\beta_i\\,\\left(\\frac{d\\phi}{dx}\\right)^{\\mathrm{UD}}_i.$$\n\nImplement two strategies for $\\beta_i$:\n1. Fixed blending with $\\beta_i=\\beta_{\\mathrm{fixed}}$ for all $i$, where $\\beta_{\\mathrm{fixed}}$ is a constant chosen from the set $\\{0.0,\\,0.5,\\,1.0\\}$.\n2. Adaptive blending where $\\beta_i$ depends on the local cell Peclet number $P_e(x_i)$ defined by $$P_e(x_i) \\;=\\; \\frac{|u(x_i)|\\,\\Delta x}{\\nu}.$$ Use a smooth logistic-type transition centered at the classical hybrid threshold $P_e = 2$:\n$$\\beta_i \\;=\\; \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{P_e(x_i) - 2}{w}\\right)\\right),$$\nwith a positive steepness parameter $w$ (use $w=0.5$).\n\nAssemble the resulting linear system for the interior unknowns $\\{\\phi_i\\}_{i=1}^{N-1}$ and enforce the Dirichlet boundary conditions using the exact solution values at $x=0$ and $x=1$. Solve the linear system to obtain the discrete approximation $\\phi^{\\mathrm{num}}$.\n\nCompute the discretization error by comparing $\\phi^{\\mathrm{num}}$ to $\\phi_{\\text{exact}}$ on the grid, and report the following error norms:\n- The discrete $L_2$ norm: $$\\lVert e \\rVert_{L_2} \\;=\\; \\left(\\sum_{i=0}^{N} \\left(\\phi^{\\mathrm{num}}_i - \\phi_{\\text{exact}}(x_i)\\right)^2 \\,\\Delta x\\right)^{1/2}.$$\n- The discrete $L_\\infty$ norm: $$\\lVert e \\rVert_{L_\\infty} \\;=\\; \\max_{0\\le i \\le N}\\left|\\phi^{\\mathrm{num}}_i - \\phi_{\\text{exact}}(x_i)\\right|.$$\n\nFor each test case, compute the improvement factors of the adaptive strategy relative to each fixed $\\beta_{\\mathrm{fixed}}\\in\\{0.0,\\,0.5,\\,1.0\\}$, defined as the ratio of the fixed strategy error to the adaptive strategy error:\n- $I_{2}(\\beta_{\\mathrm{fixed}}) = \\lVert e \\rVert_{L_2}^{\\mathrm{fixed}} \\big/ \\lVert e \\rVert_{L_2}^{\\mathrm{adaptive}}$.\n- $I_{\\infty}(\\beta_{\\mathrm{fixed}}) = \\lVert e \\rVert_{L_\\infty}^{\\mathrm{fixed}} \\big/ \\lVert e \\rVert_{L_\\infty}^{\\mathrm{adaptive}}$.\n\nYour program must implement the above and output, for each test case, a list of six floating-point numbers arranged as\n$$\\left[ I_{2}(0.0),\\, I_{\\infty}(0.0),\\, I_{2}(0.5),\\, I_{\\infty}(0.5),\\, I_{2}(1.0),\\, I_{\\infty}(1.0) \\right].$$\nAggregate the results for all test cases into a single list, printed on one line in the exact format specified below.\n\nTest Suite:\nUse the following $4$ test cases, each specified by the tuple $(N,\\,\\nu,\\,u_0,\\,u_{\\mathrm{amp}},\\,\\delta_\\phi,\\,\\delta_u)$:\n- Case $1$: $(200,\\,0.001,\\,1.0,\\,0.9,\\,0.02,\\,0.02)$.\n- Case $2$: $(200,\\,0.01,\\,1.0,\\,0.5,\\,0.05,\\,0.05)$.\n- Case $3$: $(400,\\,0.0005,\\,0.5,\\,0.49,\\,0.01,\\,0.01)$.\n- Case $4$: $(100,\\,0.001,\\,0.0,\\,0.0,\\,0.02,\\,0.02)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, each inner list corresponding to one test case, in the form\n$$\\texttt{[[r_{1,1},r_{1,2},r_{1,3},r_{1,4},r_{1,5},r_{1,6}],[r_{2,1},\\dots,r_{2,6}],[r_{3,1},\\dots,r_{3,6}],[r_{4,1},\\dots,r_{4,6}]]}$$\nwhere each $r_{k,j}$ is a floating-point number.",
            "solution": "The problem is valid. It presents a well-posed, scientifically grounded task in the field of computational fluid dynamics, specifically concerning the numerical solution of the one-dimensional steady convection-diffusion equation. All parameters, equations, and boundary conditions are explicitly defined, creating a self-contained and verifiable problem. The use of the Method of Manufactured Solutions is a standard technique for code verification and numerical scheme analysis. The test cases provided are consistent with the problem's constraints, including the edge case of pure diffusion, which serves as a valuable check.\n\nThe solution process involves several steps: derivation of the analytical source term, discretization of the governing partial differential equation into a system of linear algebraic equations, solving the system for different numerical schemes, and calculating the specified error metrics and improvement factors.\n\nFirst, we derive the source term $s(x)$ using the Method of Manufactured Solutions. The governing equation is\n$$u(x)\\,\\frac{d\\phi}{dx} \\;=\\; \\nu\\,\\frac{d^2\\phi}{dx^2} \\;+\\; s(x)$$\nThe source term is therefore $s(x) = u(x)\\frac{d\\phi}{dx} - \\nu\\frac{d^2\\phi}{dx^2}$. We require the first and second derivatives of the manufactured solution $\\phi_{\\text{exact}}(x) = \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right)\\right)$. Let $\\theta_\\phi(x) = \\frac{x - 1/2}{\\delta_\\phi}$.\n\nThe first derivative is:\n$$ \\frac{d\\phi_{\\text{exact}}}{dx} = \\frac{d}{dx}\\left[\\frac{1}{2}(1 + \\tanh(\\theta_\\phi(x)))\\right] = \\frac{1}{2} \\text{sech}^2(\\theta_\\phi(x)) \\cdot \\frac{d\\theta_\\phi}{dx} = \\frac{1}{2\\delta_\\phi}\\text{sech}^2\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right) $$\n\nThe second derivative is:\n$$ \\frac{d^2\\phi_{\\text{exact}}}{dx^2} = \\frac{d}{dx}\\left[\\frac{1}{2\\delta_\\phi}\\text{sech}^2(\\theta_\\phi(x))\\right] = \\frac{1}{2\\delta_\\phi} \\cdot \\left(-2\\,\\text{sech}^2(\\theta_\\phi(x))\\tanh(\\theta_\\phi(x))\\right) \\cdot \\frac{d\\theta_\\phi}{dx} $$\n$$ \\frac{d^2\\phi_{\\text{exact}}}{dx^2} = -\\frac{1}{\\delta_\\phi^2}\\text{sech}^2\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right)\\tanh\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right) $$\n\nSubstituting these into the expression for $s(x)$, we obtain the analytical source term:\n$$ s(x) = u(x)\\left[\\frac{1}{2\\delta_\\phi}\\text{sech}^2\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right)\\right] - \\nu\\left[-\\frac{1}{\\delta_\\phi^2}\\text{sech}^2\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right)\\tanh\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right)\\right] $$\n$$ s(x) = \\frac{1}{\\delta_\\phi} \\text{sech}^2\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right) \\left[ \\frac{u(x)}{2} + \\frac{\\nu}{\\delta_\\phi}\\tanh\\left(\\frac{x - 1/2}{\\delta_\\phi}\\right) \\right] $$\nwhere $u(x) = u_0 + u_{\\mathrm{amp}}\\,\\tanh\\!\\left(\\frac{x - 1/2}{\\delta_u}\\right)$.\n\nNext, we discretize the domain $[0,1]$ into $N+1$ points $x_i = i\\Delta x$ for $i=0, 1, \\dots, N$, with grid spacing $\\Delta x = 1/N$. The governing equation at an interior node $x_i$ is approximated as:\n$$ u_i \\left(\\frac{d\\phi}{dx}\\right)_i - \\nu \\left(\\frac{d^2\\phi}{dx^2}\\right)_i = s_i $$\nwhere $u_i = u(x_i)$, $s_i = s(x_i)$, and $\\phi_i$ is the numerical approximation to $\\phi(x_i)$.\n\nThe diffusion term is approximated by a second-order central difference:\n$$ \\left(\\frac{d^2\\phi}{dx^2}\\right)_i \\approx \\frac{\\phi_{i+1} - 2\\phi_i + \\phi_{i-1}}{\\Delta x^2} $$\n\nThe convection term is approximated using a hybrid blending of central and upwind differences. Given that the problem parameters ensure $u(x_i) \\ge 0$, we use the upwind scheme for non-negative velocity.\n$$ \\left(\\frac{d\\phi}{dx}\\right)_i \\approx (1-\\beta_i)\\left(\\frac{\\phi_{i+1} - \\phi_{i-1}}{2\\Delta x}\\right) + \\beta_i\\left(\\frac{\\phi_i - \\phi_{i-1}}{\\Delta x}\\right) $$\nRearranging this to group terms by $\\phi_j$:\n$$ \\left(\\frac{d\\phi}{dx}\\right)_i \\approx \\frac{1}{2\\Delta x}\\left[ (1-\\beta_i)\\phi_{i+1} + 2\\beta_i\\phi_i - (1+\\beta_i)\\phi_{i-1} \\right] $$\n\nSubstituting these approximations into the governing equation and rearranging yields a linear algebraic equation for each interior node $i \\in \\{1, \\dots, N-1\\}$:\n$$ \\phi_{i-1}\\left(-\\frac{u_i(1+\\beta_i)}{2\\Delta x} - \\frac{\\nu}{\\Delta x^2}\\right) + \\phi_i\\left(\\frac{u_i \\beta_i}{\\Delta x} + \\frac{2\\nu}{\\Delta x^2}\\right) + \\phi_{i+1}\\left(\\frac{u_i(1-\\beta_i)}{2\\Delta x} - \\frac{\\nu}{\\Delta x^2}\\right) = s_i $$\nThis can be written in the standard form $C_{W,i}\\phi_{i-1} + C_{P,i}\\phi_i + C_{E,i}\\phi_{i+1} = s_i$, where:\n$$ C_{W,i} = -\\frac{u_i(1+\\beta_i)}{2\\Delta x} - \\frac{\\nu}{\\Delta x^2} \\quad (\\text{West coefficient}) $$\n$$ C_{P,i} = \\frac{u_i \\beta_i}{\\Delta x} + \\frac{2\\nu}{\\Delta x^2} \\quad (\\text{Point coefficient}) $$\n$$ C_{E,i} = \\frac{u_i(1-\\beta_i)}{2\\Delta x} - \\frac{\\nu}{\\Delta x^2} \\quad (\\text{East coefficient}) $$\n\nThe blending factor $\\beta_i$ is determined by one of two strategies:\n$1$. Fixed blending: $\\beta_i = \\beta_{\\mathrm{fixed}}$, where $\\beta_{\\mathrm{fixed}}$ is a constant ($0.0$, $0.5$, or $1.0$).\n$2$. Adaptive blending: $\\beta_i$ is a function of the local cell Peclet number $P_e(x_i) = \\frac{|u(x_i)|\\Delta x}{\\nu}$. Using the specified logistic function with steepness parameter $w=0.5$:\n$$ \\beta_i = \\frac{1}{2}\\left(1 + \\tanh\\left(\\frac{P_e(x_i) - 2}{0.5}\\right)\\right) $$\n\nThese equations for $i=1, \\dots, N-1$ form a tridiagonal linear system $A\\mathbf{\\phi}_{\\text{int}} = \\mathbf{b}$, where $\\mathbf{\\phi}_{\\text{int}} = [\\phi_1, \\phi_2, \\dots, \\phi_{N-1}]^T$ is the vector of unknown interior nodal values. The matrix $A$ has dimensions $(N-1) \\times (N-1)$.\n\nThe Dirichlet boundary conditions $\\phi_0 = \\phi_{\\text{exact}}(0)$ and $\\phi_N = \\phi_{\\text{exact}}(1)$ are known. Their contributions are moved to the right-hand side of the equations for $i=1$ and $i=N-1$:\nFor $i=1$: $C_{P,1}\\phi_1 + C_{E,1}\\phi_2 = s_1 - C_{W,1}\\phi_0$\nFor $i=N-1$: $C_{W,N-1}\\phi_{N-2} + C_{P,N-1}\\phi_{N-1} = s_{N-1} - C_{E,N-1}\\phi_N$\n\nThis tridiagonal system is solved to find $\\mathbf{\\phi}_{\\text{int}}$. The full numerical solution vector is then $\\phi^{\\mathrm{num}} = [\\phi_0, \\phi_1, \\dots, \\phi_{N-1}, \\phi_N]^T$.\n\nThe error is calculated by comparing $\\phi^{\\mathrm{num}}$ to the exact solution $\\phi_{\\text{exact}}$ evaluated at the grid points. The discrete $L_2$ and $L_\\infty$ error norms are computed as specified. Finally, the improvement factors, which quantify the relative performance of the adaptive scheme, are calculated as the ratio of an error norm from a fixed-$\\beta$ scheme to the corresponding norm from the adaptive scheme.\n$$I_{2}(\\beta_{\\mathrm{fixed}}) = \\frac{\\lVert e \\rVert_{L_2}^{\\mathrm{fixed}}}{\\lVert e \\rVert_{L_2}^{\\mathrm{adaptive}}}, \\quad I_{\\infty}(\\beta_{\\mathrm{fixed}}) = \\frac{\\lVert e \\rVert_{L_\\infty}^{\\mathrm{fixed}}}{\\lVert e \\rVert_{L_\\infty}^{\\mathrm{adaptive}}}$$\nFor test case $4$, where $u(x)=0$, the convection term vanishes. Consequently, all differencing schemes produce identical results, and all improvement factors are expected to be exactly $1.0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        (200, 0.001, 1.0, 0.9, 0.02, 0.02),\n        (200, 0.01, 1.0, 0.5, 0.05, 0.05),\n        (400, 0.0005, 0.5, 0.49, 0.01, 0.01),\n        (100, 0.001, 0.0, 0.0, 0.02, 0.02),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, nu, u0, u_amp, delta_phi, delta_u = case\n        \n        # Calculate errors for the four schemes\n        err_fixed_00 = solve_case(N, nu, u0, u_amp, delta_phi, delta_u, 'fixed', beta_fixed=0.0)\n        err_fixed_05 = solve_case(N, nu, u0, u_amp, delta_phi, delta_u, 'fixed', beta_fixed=0.5)\n        err_fixed_10 = solve_case(N, nu, u0, u_amp, delta_phi, delta_u, 'fixed', beta_fixed=1.0)\n        err_adaptive = solve_case(N, nu, u0, u_amp, delta_phi, delta_u, 'adaptive')\n\n        l2_err_adapt, linf_err_adapt = err_adaptive\n\n        # Calculate improvement factors\n        # For stability, if adaptive error is zero, ratio is 1 (as fixed error must also be zero).\n        # This handles the u=0 case where all errors are identical.\n        I2_00 = err_fixed_00[0] / l2_err_adapt if l2_err_adapt > 0 else 1.0\n        Iinf_00 = err_fixed_00[1] / linf_err_adapt if linf_err_adapt > 0 else 1.0\n        \n        I2_05 = err_fixed_05[0] / l2_err_adapt if l2_err_adapt > 0 else 1.0\n        Iinf_05 = err_fixed_05[1] / linf_err_adapt if linf_err_adapt > 0 else 1.0\n        \n        I2_10 = err_fixed_10[0] / l2_err_adapt if l2_err_adapt > 0 else 1.0\n        Iinf_10 = err_fixed_10[1] / linf_err_adapt if linf_err_adapt > 0 else 1.0\n\n        case_results = [I2_00, Iinf_00, I2_05, Iinf_05, I2_10, Iinf_10]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"{all_results}\")\n\ndef solve_case(N, nu, u0, u_amp, delta_phi, delta_u, beta_strategy, beta_fixed=None):\n    \"\"\"\n    Solves the 1D convection-diffusion problem for a single strategy.\n    \n    Args:\n        N, nu, u0, u_amp, delta_phi, delta_u: Problem parameters.\n        beta_strategy (str): 'fixed' or 'adaptive'.\n        beta_fixed (float, optional): Value for fixed blending.\n\n    Returns:\n        A tuple (l2_error, linf_error).\n    \"\"\"\n    # 1. Setup grid\n    x = np.linspace(0.0, 1.0, N + 1)\n    dx = 1.0 / N\n\n    # 2. Define analytical functions\n    # Using '1 - tanh^2' for sech^2 is more numerically stable than '1/cosh^2'\n    def phi_exact_func(x_):\n        theta = (x_ - 0.5) / delta_phi\n        return 0.5 * (1.0 + np.tanh(theta))\n\n    def u_func(x_):\n        theta = (x_ - 0.5) / delta_u\n        return u0 + u_amp * np.tanh(theta)\n\n    def s_func(x_):\n        u_val = u_func(x_)\n        \n        theta_phi = (x_ - 0.5) / delta_phi\n        tanh_phi = np.tanh(theta_phi)\n        sech2_phi = 1.0 - tanh_phi**2\n        \n        dphi_dx = 0.5 * sech2_phi / delta_phi\n        d2phi_dx2 = -sech2_phi * tanh_phi / delta_phi**2\n        \n        return u_val * dphi_dx - nu * d2phi_dx2\n\n    # 3. Evaluate exact solution, velocity, and source at grid points\n    phi_exact_grid = phi_exact_func(x)\n    u_grid = u_func(x)\n    s_grid = s_func(x)\n\n    # 4. Determine beta values for interior nodes\n    beta_vals_interior = np.zeros(N - 1)\n    i_int = np.arange(1, N) # Indices of interior points\n    if beta_strategy == 'fixed':\n        beta_vals_interior[:] = beta_fixed\n    else: # adaptive\n        w = 0.5\n        # Since u(x)>=0, abs is not strictly necessary but good practice\n        pe = np.abs(u_grid[i_int]) * dx / nu\n        beta_vals_interior = 0.5 * (1.0 + np.tanh((pe - 2.0) / w))\n\n    # 5. Assemble banded matrix A and vector b for interior nodes\n    num_unknowns = N - 1\n    # ab[0,:]: upper\n    # ab[1,:]: main\n    # ab[2,:]: lower\n    ab = np.zeros((3, num_unknowns))\n    b = np.zeros(num_unknowns)\n    \n    ui = u_grid[i_int]\n    betai = beta_vals_interior\n\n    # Calculate coefficients for all interior nodes at once\n    CW = -ui * (1.0 + betai) / (2.0 * dx) - nu / dx**2\n    CP = ui * betai / dx + 2.0 * nu / dx**2\n    CE = ui * (1.0 - betai) / (2.0 * dx) - nu / dx**2\n\n    # Populate banded matrix\n    ab[0, 1:] = CE[:-1]       # Upper diagonal\n    ab[1, :] = CP             # Main diagonal\n    ab[2, :-1] = CW[1:]       # Lower diagonal\n\n    # Populate RHS vector b\n    b[:] = s_grid[i_int]\n    \n    # Apply boundary conditions\n    b[0] -= CW[0] * phi_exact_grid[0]      # At i=1\n    b[-1] -= CE[-1] * phi_exact_grid[-1]   # At i=N-1\n    \n    # 6. Solve the system\n    phi_interior = solve_banded((1, 1), ab, b)\n\n    # 7. Construct full numerical solution vector\n    phi_num = np.zeros(N + 1)\n    phi_num[0] = phi_exact_grid[0]\n    phi_num[-1] = phi_exact_grid[-1]\n    phi_num[1:N] = phi_interior\n\n    # 8. Calculate error norms\n    error = phi_num - phi_exact_grid\n    l2_error = np.sqrt(np.sum(error**2) * dx)\n    linf_error = np.max(np.abs(error))\n\n    return l2_error, linf_error\n\nif __name__ == '__main__':\n    solve()\n\n```"
        },
        {
            "introduction": "Beyond implementation, a deep understanding of a numerical scheme requires analyzing its theoretical guarantees for stability and boundedness. This problem shifts focus from coding to a rigorous analysis of the discretized equations within a Finite Volume framework. You will examine the conditions required to maintain a bounded solution—one free of unphysical oscillations—by ensuring the discretized system forms an M-matrix. This analysis is particularly critical near domain boundaries, where the interplay of boundary conditions and the numerical scheme can be delicate .",
            "id": "3331015",
            "problem": "Consider the one-dimensional, steady convection–diffusion equation for a passive scalar $\\,\\phi(x)\\,$ in a channel of length $\\,L\\,$ with constant properties,\n$$\\frac{d}{dx}\\left(\\Gamma\\,\\frac{d\\phi}{dx}\\right)-\\rho u\\,\\frac{d\\phi}{dx}=0,$$\nwhere $\\,\\Gamma>0\\,$ is the diffusion coefficient, $\\,\\rho>0\\,$ is the density, and $\\,u>0\\,$ is the uniform streamwise velocity. The boundary conditions are $\\,\\phi(0)=\\phi_{\\mathrm{in}}\\,$ (Dirichlet inflow) and $\\,\\frac{d\\phi}{dx}(L)=0\\,$ (Neumann outflow). Discretize using the Finite Volume Method (FVM) with uniform control volumes of width $\\,\\Delta x\\,$ and constant cross-sectional area $\\,A\\,$, cell centers $\\,x_P\\,$, and internal faces $\\,f\\,$. Let the convective mass flux at a face be $\\,F_f=\\rho u A>0\\,$ and let the diffusive conductance at a face be $\\,D_f=\\Gamma A/\\delta x_f\\,$, where $\\,\\delta x_f\\,$ is the distance used in the diffusive approximation at face $\\,f\\,$ (for internal faces $\\,\\delta x_f=\\Delta x\\,$, and at boundary faces $\\,\\delta x_f=\\Delta x/2\\,$ if a one-sided half-cell approximation is used). Define the local face Peclet number\n$$Pe_f=\\frac{F_f}{D_f}.$$\nAt each internal face $\\,f\\,$, approximate the convective transport of $\\,\\phi\\,$ by a hybrid interpolation\n$$\\phi_f^{\\mathrm{HYB}}=(1-\\beta_f)\\,\\phi_f^{\\mathrm{CD}}+\\beta_f\\,\\phi_f^{\\mathrm{UW}},\\qquad 0\\le \\beta_f\\le 1,$$\nwhere $\\,\\phi_f^{\\mathrm{CD}}\\,$ is the central-differencing face value and $\\,\\phi_f^{\\mathrm{UW}}\\,$ is the upwind face value consistent with $\\,u>0\\,$. Focus on the first interior control volume adjacent to the inflow boundary and the last interior control volume adjacent to the outflow boundary. Using only the governing equation, the FVM flux balance, and Taylor expansions for truncation error, determine near-boundary conditions under which the discrete system remains bounded (i.e., satisfies a discrete maximum principle with nonnegative neighbor coefficients and an $M$-matrix structure) and quantify the leading-order accuracy of the hybrid scheme adjacent to each boundary. Based on this analysis, propose a near-boundary rule for the blending parameter $\\,\\beta_f\\,$ as a function of the local $\\,Pe_f\\,$ that ensures boundedness at the inflow while maximizing formal order of accuracy at the outflow. Which option correctly characterizes the boundedness and accuracy and gives a valid $\\,\\beta_f(Pe_f)\\,$ choice?\n\nA. At the inflow-adjacent internal face, enforce $\\,\\beta_f=\\max\\!\\big(0,\\,1-2/Pe_f\\big)\\,$ (with $\\,Pe_f>0\\,$), which is the minimal upwind blending that guarantees nonnegative east-neighbor coefficients. At the outflow-adjacent internal face, set $\\,\\beta_f=0\\,$ so that central differencing recovers second-order accuracy with the Neumann boundary while maintaining boundedness in the last cell.\n\nB. Use the uniform interior rule $\\,\\beta_f=\\min\\!\\big(1,\\,|Pe_f|/2\\big)\\,$ at all faces, including those adjacent to inflow and outflow, which guarantees boundedness and second-order accuracy adjacent to both boundaries.\n\nC. Set $\\,\\beta_f=1\\,$ for faces adjacent to both inflow and outflow boundaries regardless of $\\,Pe_f\\,$; this universally enforces boundedness and maintains optimal accuracy.\n\nD. At the inflow-adjacent internal face, take $\\,\\beta_f=\\max\\!\\big(0,\\,1-Pe_f/2\\big)\\,$, and at the outflow-adjacent internal face, take $\\,\\beta_f=\\max\\!\\big(0,\\,1-2/Pe_f\\big)\\,$; this choice ensures nonnegative neighbor coefficients and second-order accuracy near both boundaries.",
            "solution": "We derive boundedness and near-boundary accuracy conditions from the finite volume flux balance on a uniform grid with $\\,u>0\\,$. For an interior cell $\\,P\\,$ with west and east faces denoted $\\,w\\,$ and $\\,e\\,$, the semi-discrete steady balance reads\n$$F_e\\,\\phi_e - F_w\\,\\phi_w = D_e\\left(\\phi_E-\\phi_P\\right)-D_w\\left(\\phi_P-\\phi_W\\right),$$\nwhere $\\,\\phi_W\\,$ and $\\,\\phi_E\\,$ are neighbor cell-center values, $\\,D_w=\\Gamma A/\\Delta x\\,$ and $\\,D_e=\\Gamma A/\\Delta x\\,$ on a uniform mesh. Hybrid interpolation gives\n$$\\phi_f^{\\mathrm{HYB}}=(1-\\beta_f)\\,\\phi_f^{\\mathrm{CD}}+\\beta_f\\,\\phi_f^{\\mathrm{UW}}.$$\nFor $\\,u>0\\,$, upwind uses the west cell value for all internal faces: $\\,\\phi_w^{\\mathrm{UW}}=\\phi_W,\\;\\phi_e^{\\mathrm{UW}}=\\phi_P.$ Central differencing uses the average: $\\,\\phi_w^{\\mathrm{CD}}=\\tfrac{1}{2}\\left(\\phi_W+\\phi_P\\right),\\;\\phi_e^{\\mathrm{CD}}=\\tfrac{1}{2}\\left(\\phi_P+\\phi_E\\right).$ Therefore,\n\\begin{align*}\n\\phi_w^{\\mathrm{HYB}}&=(1-\\beta_w)\\,\\tfrac{1}{2}\\left(\\phi_W+\\phi_P\\right)+\\beta_w\\,\\phi_W=\\left(\\tfrac{1-\\beta_w}{2}+\\beta_w\\right)\\phi_W+\\tfrac{1-\\beta_w}{2}\\,\\phi_P,\\\\\n\\phi_e^{\\mathrm{HYB}}&=(1-\\beta_e)\\,\\tfrac{1}{2}\\left(\\phi_P+\\phi_E\\right)+\\beta_e\\,\\phi_P=\\tfrac{1-\\beta_e}{2}\\,\\phi_E+\\left(\\tfrac{1-\\beta_e}{2}+\\beta_e\\right)\\phi_P.\n\\end{align*}\nSubstituting into the convective flux terms yields the convection contributions to the linearized coefficients:\n\\begin{align*}\n\\text{convective contribution to }a_W:&\\quad F_w\\left(\\tfrac{1-\\beta_w}{2}+\\beta_w\\right)=F_w\\,\\tfrac{1+\\beta_w}{2},\\\\\n\\text{convective contribution to }a_E:&\\quad F_e\\,\\tfrac{1-\\beta_e}{2},\\quad\\text{but with a negative sign when moved to the left-hand side, i.e., }a_E^{\\mathrm{conv}}=-\\,\\tfrac{F_e}{2}\\,(1-\\beta_e).\n\\end{align*}\nAdding diffusion contributions, the standard algebraic form for the cell $\\,P\\,$ becomes\n$$a_W\\,\\phi_W + a_E\\,\\phi_E + a_P\\,\\phi_P = b_P,$$\nwith\n\\begin{align*}\na_W&=D_w + F_w\\,\\tfrac{1+\\beta_w}{2},\\\\\na_E&=D_e - F_e\\,\\tfrac{1-\\beta_e}{2},\\\\\na_P&=a_W+a_E+\\left(F_e-F_w\\right),\n\\end{align*}\nand $\\,b_P\\,$ accounts for boundary-face fluxes where applicable. These expressions recover the familiar special cases: for central differencing ($\\,\\beta_f=0\\,$), $\\,a_W=D_w+F_w/2\\,$ and $\\,a_E=D_e-F_e/2\\,$; for upwind ($\\,\\beta_f=1\\,$), $\\,a_W=D_w+F_w\\,$ and $\\,a_E=D_e\\,$.\n\nBoundedness in the sense of a discrete maximum principle is ensured by nonnegative neighbor coefficients $\\,a_W\\ge 0\\,$ and $\\,a_E\\ge 0\\,$ and an $M$-matrix structure with diagonal dominance $\\,a_P\\ge a_W+a_E\\,$ for $\\,u>0\\,$. On a uniform mesh with $\\,\\Gamma>0\\,$ and $\\,F_f>0\\,$, we have $\\,a_W\\ge D_w>0\\,$ automatically for any $\\,\\beta_w\\in[0,1]\\,$, because $\\,\\tfrac{1+\\beta_w}{2}\\ge \\tfrac{1}{2}.$ The potential violation arises at $\\,a_E\\,$, which for central differencing can become negative if convection overwhelms diffusion. To enforce $\\,a_E\\ge 0\\,$,\n$$D_e - \\frac{F_e}{2}\\,(1-\\beta_e)\\ge 0\\quad\\Longleftrightarrow\\quad (1-\\beta_e)\\le \\frac{2D_e}{F_e}=\\frac{2}{Pe_e},$$\nwhere $\\,Pe_e=F_e/D_e\\,$ is the local face Peclet number at the east internal face. Thus,\n$$\\beta_e \\ge 1 - \\frac{2}{Pe_e}.$$\nFor $\\,Pe_e\\le 2\\,$ the right-hand side is nonpositive and any $\\,\\beta_e\\in[0,1]\\,$, including central differencing $\\,\\beta_e=0\\,$, is bounded; for $\\,Pe_e>2\\,$, a minimal upwind blending $\\,\\beta_e=1-2/Pe_e\\,$ guarantees $\\,a_E\\ge 0\\,$ while maximizing central weighting.\n\nNear the inflow boundary, consider the first interior cell $\\,P=1\\,$ with west boundary face $\\,w\\,$ and east internal face $\\,e\\,$. The west face uses the Dirichlet inflow $\\,\\phi(0)=\\phi_{\\mathrm{in}}\\,$, and its contribution enters the source $\\,b_P\\,$. Boundedness still hinges on the internal east face coefficient $\\,a_E\\,$, hence the same constraint\n$$\\beta_e \\ge 1 - \\frac{2}{Pe_e}.$$\nBecause $\\,Pe_e=F_e/D_e\\,$ on a uniform mesh with $\\,D_e=\\Gamma A/\\Delta x\\,$, this condition depends on the local internal-face Peclet number and is independent of the boundary half-spacing at $\\,w\\,$.\n\nNear the outflow boundary, consider the last interior cell $\\,P=N\\,$ with internal west face $\\,w\\,$ and east boundary face $\\,e\\,$. The Neumann outflow $\\,\\frac{d\\phi}{dx}(L)=0\\,$ implies zero diffusive flux at $\\,e\\,$. The boundedness of the interior neighbor coefficient $\\,a_W=D_w+F_w\\,\\tfrac{1+\\beta_w}{2}\\,$ is automatic for any $\\,\\beta_w\\in[0,1]\\,$, since $\\,D_w>0\\,$ and $\\,F_w>0\\,$. Therefore, a choice $\\,\\beta_w=0\\,$ at the internal west face of the last cell incurs no boundedness risk and increases accuracy.\n\nTo quantify accuracy, examine the truncation error via Taylor expansion. For smooth $\\,\\phi(x)\\,$, central differencing of convective fluxes at an internal face yields a second-order approximation with leading error $\\,\\mathcal{O}(\\Delta x^2)\\,$; upwind is first-order with leading error $\\,\\mathcal{O}(\\Delta x)\\,$. At the outflow boundary with zero gradient $\\,\\frac{d\\phi}{dx}(L)=0\\,$, central differencing applied at the internal west face of the last cell retains its second-order behavior because the boundary condition suppresses the convective steepening at the east face. In contrast, imposing upwind ($\\,\\beta_f=1\\,$) propagates first-order diffusion (numerical viscosity) into the last cell.\n\nCollecting these results:\n- Inflow-adjacent internal face: enforce the minimal blending\n$$\\beta_f=\\max\\!\\left(0,\\,1-\\frac{2}{Pe_f}\\right),\\qquad Pe_f=\\frac{F_f}{D_f},$$\nto guarantee $\\,a_E\\ge 0\\,$ and preserve as much central weighting as admissible.\n- Outflow-adjacent internal face: set $\\,\\beta_f=0\\,$ to maximize accuracy (second-order) while boundedness is already ensured by $\\,a_W\\ge 0\\,$.\n\nWe now assess the options.\n\nOption A: It prescribes $\\,\\beta_f=\\max(0,1-2/Pe_f)\\,$ at the inflow-adjacent internal face, exactly the minimal blending derived from $\\,a_E\\ge 0\\,$. For the outflow-adjacent internal face it sets $\\,\\beta_f=0\\,$, which, given $\\,a_W\\ge 0\\,$ for any $\\,\\beta_w\\in[0,1]\\,$ and the zero-gradient boundary at $\\,L\\,$, maximizes accuracy without violating boundedness. This option correctly characterizes both boundedness and accuracy and provides a valid $\\,\\beta_f(Pe_f)\\,$.\n\nOption B: The uniform rule $\\,\\beta_f=\\min(1,|Pe_f|/2)\\,$ reproduces the standard interior hybrid threshold ($\\,\\beta_f=0\\,$ for $\\,|Pe_f|\\le 2\\,$, $\\,\\beta_f=1\\,$ when $\\,|Pe_f|>2\\,$), which ensures boundedness but does not maximize accuracy at boundaries; notably, for large $\\,Pe_f\\,$ at inflow it enforces full upwind ($\\,\\beta_f=1\\,$), which is only first-order accurate, and at outflow it unnecessarily enforces upwind when $\\,|Pe_f|>2\\,$, degrading accuracy. The claim of second-order accuracy adjacent to both boundaries is therefore incorrect. Verdict: Incorrect.\n\nOption C: Setting $\\,\\beta_f=1\\,$ at both boundaries enforces upwind everywhere near boundaries, which guarantees boundedness but reduces accuracy to first order. The claim that optimal accuracy is maintained is false. Verdict: Incorrect.\n\nOption D: At the inflow it suggests $\\,\\beta_f=\\max(0,1-Pe_f/2)\\,$, which decreases $\\,\\beta_f\\,$ as $\\,Pe_f\\,$ increases and can be negative unless clipped; more importantly, it is the wrong functional form for enforcing $\\,a_E\\ge 0\\,$. The correct condition is $\\,\\beta_f\\ge 1-2/Pe_f\\,$, not $\\,1-Pe_f/2\\,$. At the outflow it proposes $\\,\\beta_f=\\max(0,1-2/Pe_f)\\,$; while harmless for boundedness at the last cell, it fails to adopt the accuracy-maximizing $\\,\\beta_f=0\\,$ when $\\,Pe_f>2\\,$, and the overall claim of ensuring second-order accuracy near both boundaries is not supported. Verdict: Incorrect.\n\nTherefore, Option A is the unique correct statement and near-boundary $\\,\\beta_f(Pe_f)\\,$ rule consistent with the derived boundedness and accuracy properties.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}