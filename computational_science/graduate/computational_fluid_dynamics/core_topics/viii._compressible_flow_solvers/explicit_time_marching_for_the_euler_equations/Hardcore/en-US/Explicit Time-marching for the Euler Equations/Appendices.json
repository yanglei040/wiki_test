{
    "hands_on_practices": [
        {
            "introduction": "The stability of any explicit time-marching scheme for hyperbolic systems like the Euler equations is governed by the Courant-Friedrichs-Lewy (CFL) condition. This principle dictates that the numerical domain of dependence must contain the physical domain of dependence, effectively limiting the time step size based on the fastest physical wave speed in the system. This first practice takes you back to first principles, guiding you through the derivation of the characteristic speeds of the one-dimensional Euler equations to reveal how the maximum allowable time step is fundamentally tied to the local fluid velocity and the speed of sound.",
            "id": "3317302",
            "problem": "Consider one-dimensional inviscid compressible flow governed by the Euler equations in conservative form,\n$$\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = \\boldsymbol{0},$$\nwhere the conserved variables are\n$$\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix},$$\nand the fluxes are\n$$\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(E + p) \\end{pmatrix}.$$\nAssume a calorically perfect gas with constant specific heat ratio $\\gamma$ and thermodynamic closure $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$. In explicit time-marching schemes, the Courant-Friedrichs-Lewy (CFL) condition requires a time step that is limited by the maximum magnitude of the characteristic speeds (eigenvalues of the flux Jacobian) of the system. Starting from the governing equations and the ideal-gas assumption, derive the relevant characteristic speeds for the one-dimensional Euler system by linearization and isentropic thermodynamic arguments, identify the speed of sound, and determine the maximum characteristic speed at a uniform state with density $\\rho$, velocity $u$, pressure $p$, and specific heat ratio $\\gamma$.\n\nEvaluate this maximum characteristic speed for the state defined by $\\rho = 1.2$ $\\mathrm{kg\\, m^{-3}}$, $u = 50$ $\\mathrm{m\\, s^{-1}}$, $p = 101325$ $\\mathrm{Pa}$, and $\\gamma = 1.4$. Express your final answer in $\\mathrm{m\\, s^{-1}}$ and round to four significant figures.",
            "solution": "The problem requires the derivation of the characteristic speeds for the one-dimensional Euler equations, the identification of the speed of sound, the determination of the maximum characteristic speed, and its evaluation for a given flow state. The analysis will begin by transforming the Euler equations from their conservative form to a non-conservative (quasilinear) form to identify the flux Jacobian and its eigenvalues.\n\nThe one-dimensional Euler equations in conservative form are given by:\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = \\boldsymbol{0}\n$$\nwhere the vector of conserved variables $\\boldsymbol{U}$ and the flux vector $\\boldsymbol{F}$ are:\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\boldsymbol{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E + p) \\end{pmatrix}\n$$\nThe system is closed with the equation of state for a calorically perfect gas:\n$$\np = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)\n$$\nThe characteristic speeds are the eigenvalues of the flux Jacobian matrix $\\boldsymbol{A} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{U}}$. Instead of computing this matrix directly, it is more convenient to convert the system into a quasilinear form using primitive variables, such as $\\boldsymbol{W} = (\\rho, u, p)^T$. The system can be written as $\\frac{\\partial \\boldsymbol{W}}{\\partial t} + \\boldsymbol{A}'(\\boldsymbol{W}) \\frac{\\partial \\boldsymbol{W}}{\\partial x} = \\boldsymbol{0}$, where the eigenvalues of $\\boldsymbol{A}'$ are the same as those of $\\boldsymbol{A}$.\n\nLet's expand the three scalar equations from the conservative form using the product rule:\n$1$. Mass conservation:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0 \\implies \\frac{\\partial \\rho}{\\partial t} + u \\frac{\\partial \\rho}{\\partial x} + \\rho \\frac{\\partial u}{\\partial x} = 0\n$$\nThis equation is already in terms of primitive variables' derivatives.\n\n$2$. Momentum conservation:\n$$\n\\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0 \\implies \\rho \\frac{\\partial u}{\\partial t} + u \\frac{\\partial \\rho}{\\partial t} + 2 \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n$$\nSubstitute $\\frac{\\partial \\rho}{\\partial t}$ from the mass equation:\n$$\n\\rho \\frac{\\partial u}{\\partial t} + u \\left(-u \\frac{\\partial \\rho}{\\partial x} - \\rho \\frac{\\partial u}{\\partial x}\\right) + 2 \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n$$\n$$\n\\rho \\frac{\\partial u}{\\partial t} - u^2 \\frac{\\partial \\rho}{\\partial x} - \\rho u \\frac{\\partial u}{\\partial x} + 2 \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n$$\nSimplifying gives the non-conservative momentum equation:\n$$\n\\rho \\frac{\\partial u}{\\partial t} + \\rho u \\frac{\\partial u}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0 \\implies \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} = 0\n$$\n\n$3$. Energy conservation:\n$$\n\\frac{\\partial E}{\\partial t} + \\frac{\\partial (u(E+p))}{\\partial x} = 0 \\implies \\frac{\\partial E}{\\partial t} + u \\frac{\\partial E}{\\partial x} + (E+p) \\frac{\\partial u}{\\partial x} + u \\frac{\\partial p}{\\partial x} = 0\n$$\nTo express this in terms of $(\\rho, u, p)$, we use $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$. Its derivatives are:\n$$\n\\frac{\\partial E}{\\partial t} = \\frac{1}{\\gamma-1} \\frac{\\partial p}{\\partial t} + \\frac{1}{2} u^2 \\frac{\\partial \\rho}{\\partial t} + \\rho u \\frac{\\partial u}{\\partial t}\n$$\n$$\n\\frac{\\partial E}{\\partial x} = \\frac{1}{\\gamma-1} \\frac{\\partial p}{\\partial x} + \\frac{1}{2} u^2 \\frac{\\partial \\rho}{\\partial x} + \\rho u \\frac{\\partial u}{\\partial x}\n$$\nSubstitute these into the expanded energy equation. This process is lengthy, but leads to the simplified non-conservative energy equation:\n$$\n\\frac{\\partial p}{\\partial t} + u \\frac{\\partial p}{\\partial x} + \\gamma p \\frac{\\partial u}{\\partial x} = 0\n$$\n\nNow we assemble the system of non-conservative equations in matrix form, $\\frac{\\partial \\boldsymbol{W}}{\\partial t} + \\boldsymbol{A}' \\frac{\\partial \\boldsymbol{W}}{\\partial x} = \\boldsymbol{0}$, with $\\boldsymbol{W} = (\\rho, u, p)^T$:\n$$\n\\begin{pmatrix} \\frac{\\partial \\rho}{\\partial t} \\\\ \\frac{\\partial u}{\\partial t} \\\\ \\frac{\\partial p}{\\partial t} \\end{pmatrix} + \\begin{pmatrix} u  \\rho  0 \\\\ 0  u  \\frac{1}{\\rho} \\\\ 0  \\gamma p  u \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial \\rho}{\\partial x} \\\\ \\frac{\\partial u}{\\partial x} \\\\ \\frac{\\partial p}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe characteristic speeds $\\lambda$ are the eigenvalues of the matrix $\\boldsymbol{A}' = \\begin{pmatrix} u  \\rho  0 \\\\ 0  u  \\frac{1}{\\rho} \\\\ 0  \\gamma p  u \\end{pmatrix}$.\nThe eigenvalues are found by solving the characteristic equation $\\det(\\boldsymbol{A}' - \\lambda \\boldsymbol{I}) = 0$:\n$$\n\\det \\begin{pmatrix} u-\\lambda  \\rho  0 \\\\ 0  u-\\lambda  \\frac{1}{\\rho} \\\\ 0  \\gamma p  u-\\lambda \\end{pmatrix} = (u-\\lambda) \\left[ (u-\\lambda)^2 - (\\gamma p) \\left(\\frac{1}{\\rho}\\right) \\right] = 0\n$$\nThis gives $(u-\\lambda) \\left[ (u-\\lambda)^2 - \\frac{\\gamma p}{\\rho} \\right] = 0$.\nThe three eigenvalues, or characteristic speeds, are:\n$$\n\\lambda_1 = u, \\quad \\lambda_2 = u + \\sqrt{\\frac{\\gamma p}{\\rho}}, \\quad \\lambda_3 = u - \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\nThis completes the first part of the problem.\n\nNext, we identify the speed of sound, $c$. By thermodynamic definition, the speed of sound is the propagation speed of an isentropic compression or rarefaction wave, given by $c^2 = \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s$, where $s$ is the specific entropy. For a calorically perfect gas undergoing an isentropic process, $p = K\\rho^\\gamma$, where $K$ is a constant. Differentiating pressure with respect to density gives:\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s = \\frac{d}{d\\rho}(K\\rho^\\gamma) = K \\gamma \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho^\\gamma} \\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho}\n$$\nThus, the speed of sound is $c = \\sqrt{\\frac{\\gamma p}{\\rho}}$.\nThe characteristic speeds can now be expressed in terms of the flow velocity $u$ and the speed of sound $c$:\n$$\n\\lambda_1 = u, \\quad \\lambda_2 = u+c, \\quad \\lambda_3 = u-c\n$$\nThese represent the advection of entropy/contact discontinuities at speed $u$, and the propagation of acoustic waves relative to the fluid at speeds $\\pm c$.\n\nThe Courant-Friedrichs-Lewy (CFL) condition for an explicit scheme depends on the maximum magnitude of the characteristic speeds, $\\lambda_{\\text{max\\_mag}} = \\max(|\\lambda_1|, |\\lambda_2|, |\\lambda_3|)$. This is:\n$$\n\\lambda_{\\text{max\\_mag}} = \\max(|u|, |u+c|, |u-c|)\n$$\nSince $c  0$, it can be shown that $|u+c|$ or $|u-c|$ will be the maximum. The term $|u|+c$ encompasses both possibilities. For any real numbers $u$ and $c$, the triangle inequality states $|u+c| \\leq |u|+|c|$ and $|u-c| \\leq |u|+|c|$.\nIf $u \\ge 0$, then $|u+c| = u+c$. Since $c0$, $u+c  u = |u|$ and $u+c  |u-c|$.\nIf $u  0$, then $|u-c| = |-u+c| = |u|+c$. Since $c0$, $|u|+c|u|$ and $|u|+c|u+c|$.\nIn all cases, the maximum magnitude is given by the sum of the absolute flow speed and the speed of sound:\n$$\n\\lambda_{\\text{max\\_mag}} = |u| + c\n$$\n\nFinally, we evaluate this maximum characteristic speed for the given state: $\\rho = 1.2\\,\\mathrm{kg\\,m^{-3}}$, $u = 50\\,\\mathrm{m\\,s^{-1}}$, $p = 101325\\,\\mathrm{Pa}$, and $\\gamma = 1.4$. All units are in the SI system.\nFirst, calculate the speed of sound $c$:\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(1.4)(101325\\,\\mathrm{Pa})}{1.2\\,\\mathrm{kg\\,m^{-3}}}} = \\sqrt{\\frac{141855}{1.2}}\\,\\mathrm{m\\,s^{-1}} = \\sqrt{118212.5}\\,\\mathrm{m\\,s^{-1}} \\approx 343.8204\\,\\mathrm{m\\,s^{-1}}\n$$\nNow, calculate the maximum characteristic speed magnitude:\n$$\n\\lambda_{\\text{max\\_mag}} = |u| + c = |50\\,\\mathrm{m\\,s^{-1}}| + 343.8204\\,\\mathrm{m\\,s^{-1}} = 50\\,\\mathrm{m\\,s^{-1}} + 343.8204\\,\\mathrm{m\\,s^{-1}} = 393.8204\\,\\mathrm{m\\,s^{-1}}\n$$\nRounding the result to four significant figures gives $393.8\\,\\mathrm{m\\,s^{-1}}$. In scientific notation this is $3.938 \\times 10^2\\,\\mathrm{m\\,s^{-1}}$.",
            "answer": "$$\\boxed{3.938 \\times 10^{2}}$$"
        },
        {
            "introduction": "To achieve high-order accuracy, modern finite volume methods move beyond simple first-order assumptions about the data within a computational cell. The key is to reconstruct a more detailed, sub-cell resolution profile from the cell-averaged data, which provides more accurate states at cell interfaces for the flux calculation. However, this reconstruction must be done carefully to avoid introducing non-physical oscillations near shocks or steep gradients. This exercise provides hands-on practice with slope limiting, a crucial technique used in high-resolution schemes to ensure monotonicity while maintaining accuracy in smooth regions of the flow.",
            "id": "3317343",
            "problem": "Consider a one-dimensional, uniform Cartesian mesh used for an explicit time-marching finite volume method for the compressible Euler equations. Focus on the scalar reconstruction problem for the mass density field. Let the computational grid consist of cells indexed by an integer $i$, each of width $\\Delta x$, and let the available data be the cell-averaged mass density values $\\bar{\\rho}_i$ expressed in kilograms per cubic meter. In a second-order, high-resolution Godunov-type method, one reconstructs a piecewise linear profile inside each cell using a slope-limited gradient to obtain left and right interface states suitable for a Riemann solver. The goal is to compute the limited slopes and the corresponding left/right reconstructed states at a chosen interface.\n\nStarting from the finite volume representation of the conservation law for mass, from the requirement of total variation diminishing behavior in the sense of Harten, and from the consistency with linear reconstruction in smooth regions, one adopts a slope limiter. The Monotonized Central (MC) limiter chooses a limited slope per cell by comparing one-sided and centered difference candidates and selecting a value that preserves monotonicity while retaining second-order accuracy in smooth regions. The piecewise linear reconstruction within cell $i$ for the density is of the form\n$\\rho_i(x) = \\bar{\\rho}_i + \\sigma_i \\left(x - x_i\\right)$,\nwhere $x_i$ is the center of cell $i$ and $\\sigma_i$ is the limited slope with units of kilograms per meter to the fourth power. The left and right reconstructed states at the interface between cells $i$ and $i+1$, located at $x_{i+\\frac{1}{2}} = x_i + \\frac{1}{2}\\Delta x$, are defined as\n$\\rho_{i+\\frac{1}{2}}^{-} = \\bar{\\rho}_i + \\frac{1}{2}\\sigma_i \\Delta x$ and $\\rho_{i+\\frac{1}{2}}^{+} = \\bar{\\rho}_{i+1} - \\frac{1}{2}\\sigma_{i+1} \\Delta x$.\nTo ensure scientific realism, impose the following boundary treatment: if an index appears that would require data outside the available array, use zero-gradient extrapolation by setting the out-of-bounds value equal to the nearest boundary value, which enforces a vanishing discrete gradient at the domain boundary.\n\nTask: For each specified test case below, compute the limited slopes $\\sigma_i$ and $\\sigma_{i+1}$ using the Monotonized Central limiter applied to the cell-averaged densities $\\bar{\\rho}_k$ and grid spacing $\\Delta x$, then compute the left and right reconstructed interface states $\\rho_{i+\\frac{1}{2}}^{-}$ and $\\rho_{i+\\frac{1}{2}}^{+}$. Express the slopes in kilograms per meter to the fourth power and the interface states in kilograms per cubic meter. All numerical answers must be returned as floating-point numbers.\n\nFor the Monotonized Central limiter, use the following principles: define one-sided difference quotients on a uniform grid by\n$\\delta^-_i = \\dfrac{\\bar{\\rho}_i - \\bar{\\rho}_{i-1}}{\\Delta x}$ and $\\delta^+_i = \\dfrac{\\bar{\\rho}_{i+1} - \\bar{\\rho}_i}{\\Delta x}$,\nand the centered difference candidate by\n$\\delta^c_i = \\dfrac{\\bar{\\rho}_{i+1} - \\bar{\\rho}_{i-1}}{2\\,\\Delta x}$.\nThen the MC-limited slope is obtained by applying a minmod selection over the three candidates $2\\,\\delta^-_i$, $2\\,\\delta^+_i$, and $\\delta^c_i$ to enforce monotonicity while favoring the smallest magnitude among them when they have the same sign and returning zero otherwise. Use the same construction for $\\sigma_{i+1}$ with shifted indices.\n\nTest suite:\n- Case $1$: Use the sequence of five density cell averages with values $1.0$, $1.5$, $2.0$, $2.5$, $3.0$ in that order, with $\\Delta x = 1.0$ meter, and reconstruct at the interface between cells $i=2$ and $i+1=3$.\n- Case $2$: Use the sequence of five density cell averages with values $1.0$, $1.0$, $1.0$, $5.0$, $5.0$ in that order, with $\\Delta x = 1.0$ meter, and reconstruct at the interface between cells $i=2$ and $i+1=3$.\n- Case $3$: Use the sequence of five density cell averages with values $2.0$, $3.0$, $2.5$, $2.0$, $1.5$ in that order, with $\\Delta x = 1.0$ meter, and reconstruct at the interface between cells $i=2$ and $i+1=3$.\n- Case $4$: Use the sequence of three density cell averages with values $1.0$, $2.0$, $3.0$ in that order, with $\\Delta x = 1.0$ meter, and reconstruct at the interface between cells $i=0$ and $i+1=1$. Apply the stated boundary treatment.\n- Case $5$: Use the sequence of four density cell averages with values $1.0$, $2.0$, $2.0$, $2.0$ in that order, with $\\Delta x = 0.5$ meter, and reconstruct at the interface between cells $i=1$ and $i+1=2$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of results, one per test case, where each result is a sublist in the form $[\\sigma_i, \\sigma_{i+1}, \\rho_{i+\\frac{1}{2}}^{-}, \\rho_{i+\\frac{1}{2}}^{+}]$. The overall output must be a single bracketed, comma-separated list of these sublists, for example\n$[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],\\ldots]$,\nwith all entries as floating-point numbers. Slopes must be in kilograms per meter to the fourth power, and interface states must be in kilograms per cubic meter.",
            "solution": "We begin from the one-dimensional conservation law for mass in the compressible Euler equations,\n$\\dfrac{\\partial \\rho}{\\partial t} + \\dfrac{\\partial}{\\partial x}(\\rho u) = 0$,\nand its finite volume semi-discrete form on a uniform mesh with cell averages $\\bar{\\rho}_i(t)$:\n$\\dfrac{d \\bar{\\rho}_i}{dt} = -\\dfrac{1}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)$,\nwhere $F_{i\\pm\\frac{1}{2}}$ are numerical fluxes computed by solving or approximating Riemann problems at interfaces located at $x_{i\\pm\\frac{1}{2}}$. In explicit time-marching methods, stable and accurate fluxes require accurate non-oscillatory reconstructions of left and right states at interfaces. For second-order accuracy, a piecewise linear reconstruction inside each cell $i$ is employed:\n$\\rho_i(x) = \\bar{\\rho}_i + \\sigma_i(x - x_i)$,\nwhere $\\sigma_i$ is an approximation to the spatial derivative $\\partial \\rho/\\partial x$ in a limited sense. The left and right interface states at $x_{i+\\frac{1}{2}}$ are\n$\\rho_{i+\\frac{1}{2}}^{-} = \\rho_i\\left(x_{i+\\frac{1}{2}}\\right) = \\bar{\\rho}_i + \\dfrac{1}{2}\\sigma_i \\Delta x$,\n$\\rho_{i+\\frac{1}{2}}^{+} = \\rho_{i+1}\\left(x_{i+\\frac{1}{2}}\\right) = \\bar{\\rho}_{i+1} - \\dfrac{1}{2}\\sigma_{i+1} \\Delta x$.\nThese formulas follow from linearity and the definition $x_{i+\\frac{1}{2}} - x_i = \\Delta x/2$ and $x_{i+1} - x_{i+\\frac{1}{2}} = \\Delta x/2$.\n\nTo prevent spurious oscillations near discontinuities while retaining second-order accuracy in smooth regions, we use a Total Variation Diminishing (TVD) limiter. The Monotonized Central (MC) limiter is designed to be second-order accurate in smooth regions and reduce to first order near extrema or steep gradients. On a uniform mesh, define one-sided and centered discrete slopes:\n$\\delta^-_i = \\dfrac{\\bar{\\rho}_i - \\bar{\\rho}_{i-1}}{\\Delta x}$,\n$\\delta^+_i = \\dfrac{\\bar{\\rho}_{i+1} - \\bar{\\rho}_i}{\\Delta x}$,\n$\\delta^c_i = \\dfrac{\\bar{\\rho}_{i+1} - \\bar{\\rho}_{i-1}}{2\\,\\Delta x}$.\nThe minmod function of a set of real numbers returns their common sign times the minimum of their absolute values if they all share the same strictly positive or strictly negative sign, and returns zero otherwise. For three arguments $a$, $b$, $c$, the minmod function is\n$\\operatorname{minmod}(a,b,c) = \\begin{cases}\n\\phantom{-}\\min\\left(|a|,|b|,|c|\\right)  \\text{if } a0,\\,b0,\\,c0,\\\\\n-\\min\\left(|a|,|b|,|c|\\right)  \\text{if } a0,\\,b0,\\,c0,\\\\\n0  \\text{otherwise}.\n\\end{cases}$\nThe MC-limited slope is then defined as\n$\\sigma_i = \\operatorname{minmod}\\!\\left(2\\,\\delta^-_i,\\;2\\,\\delta^+_i,\\;\\delta^c_i\\right)$.\nThis choice arises from enforcing that the reconstructed linear profiles do not create new extrema (TVD property) by bounding the slope by the smallest magnitude among the relevant directional derivatives, while allowing a centered difference in smooth regions.\n\nBoundary treatment follows from the specified zero-gradient extrapolation: when computing $\\delta^-_0$ or $\\delta^c_0$ that require $\\bar{\\rho}_{-1}$, set $\\bar{\\rho}_{-1} = \\bar{\\rho}_0$; similarly, when computing $\\delta^+_{N-1}$ or $\\delta^c_{N-1}$ that require $\\bar{\\rho}_{N}$, set $\\bar{\\rho}_{N} = \\bar{\\rho}_{N-1}$. This enforces $\\delta^-_0 = 0$ and $\\delta^+_{N-1} = 0$, which correctly yields zero-limited slopes at boundaries when combined with the MC limiter.\n\nAlgorithm for each test case:\n- Given the sequence $\\{\\bar{\\rho}_k\\}$ and $\\Delta x$, and a target interface between cells $i$ and $i+1$:\n    - Compute $\\sigma_i$ using $\\delta^-_i$, $\\delta^+_i$, $\\delta^c_i$ with ghost values if needed.\n    - Compute $\\sigma_{i+1}$ similarly.\n    - Compute $\\rho_{i+\\frac{1}{2}}^{-} = \\bar{\\rho}_i + \\dfrac{1}{2}\\sigma_i \\Delta x$ and $\\rho_{i+\\frac{1}{2}}^{+} = \\bar{\\rho}_{i+1} - \\dfrac{1}{2}\\sigma_{i+1} \\Delta x$.\n- Return the sublist $[\\sigma_i, \\sigma_{i+1}, \\rho_{i+\\frac{1}{2}}^{-}, \\rho_{i+\\frac{1}{2}}^{+}]$.\n\nVerification on the provided cases yields behavior consistent with expectations:\n- For a strictly linear profile (Case $1$), $\\sigma_i$ and $\\sigma_{i+1}$ equal the exact derivative, producing identical left and right states at the interface.\n- For a jump discontinuity (Case $2$), the limiter drives both slopes to zero, recovering first-order non-oscillatory states equal to the neighboring cell averages.\n- For a smoothly varying but decreasing region (Case $3$), the limiter returns a negative slope with magnitude bounded by the centered difference, maintaining second-order accuracy.\n- Near a boundary with zero-gradient extrapolation (Case $4$), the boundary slope vanishes and the interior slope matches the centered difference, yielding consistent interface states.\n- With non-unit grid spacing (Case $5$), the use of $\\Delta x$ in the difference quotients and reconstruction demonstrates correct dimensional scaling: the slopes have units of kilograms per meter to the fourth power and the reconstructed states retain kilograms per cubic meter.\n\nThe program implements the above steps for all test cases and prints the single required line: a bracketed list of sublists, one per case, each containing four floating-point values in the specified order and units.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef minmod3(a: float, b: float, c: float) - float:\n    \"\"\"\n    Three-argument minmod function.\n    Returns:\n        sign(a)*min(|a|,|b|,|c|) if a,b,c have the same nonzero sign;\n        0.0 otherwise.\n    \"\"\"\n    # Check signs\n    if a  0.0 and b  0.0 and c  0.0:\n        return min(a, b, c)\n    if a  0.0 and b  0.0 and c  0.0:\n        return -min(abs(a), abs(b), abs(c))\n    return 0.0\n\ndef mc_slope(rho: np.ndarray, i: int, dx: float) - float:\n    \"\"\"\n    Compute the Monotonized Central (MC) limited slope for cell i\n    given cell-averaged density rho and grid spacing dx.\n    Uses zero-gradient extrapolation at boundaries.\n    \"\"\"\n    n = rho.size\n    # Fetch neighbor values with zero-gradient extrapolation\n    rho_im1 = rho[0] if i-1  0 else rho[i-1]\n    rho_i   = rho[i]\n    rho_ip1 = rho[-1] if i+1 = n else rho[i+1]\n\n    # One-sided and centered difference quotients\n    dm = (rho_i - rho_im1) / dx\n    dp = (rho_ip1 - rho_i) / dx\n    dc = (rho_ip1 - rho_im1) / (2.0 * dx)\n\n    # MC limiter: minmod of (2*dm, 2*dp, dc)\n    return minmod3(2.0 * dm, 2.0 * dp, dc)\n\ndef reconstruct_interface_states(rho: np.ndarray, i: int, dx: float):\n    \"\"\"\n    Compute (sigma_i, sigma_ip1, left_state, right_state)\n    at interface between cells i and i+1 using MC limiter.\n    \"\"\"\n    n = rho.size\n    if i  0 or i+1 = n:\n        raise IndexError(\"Interface index i must satisfy 0 = i  N-1.\")\n    sigma_i = mc_slope(rho, i, dx)\n    sigma_ip1 = mc_slope(rho, i+1, dx)\n    left_state = rho[i] + 0.5 * sigma_i * dx\n    right_state = rho[i+1] - 0.5 * sigma_ip1 * dx\n    return sigma_i, sigma_ip1, left_state, right_state\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (density_values_list, dx, interface_left_index_i)\n    test_cases = [\n        ([1.0, 1.5, 2.0, 2.5, 3.0], 1.0, 2),\n        ([1.0, 1.0, 1.0, 5.0, 5.0], 1.0, 2),\n        ([2.0, 3.0, 2.5, 2.0, 1.5], 1.0, 2),\n        ([1.0, 2.0, 3.0], 1.0, 0),\n        ([1.0, 2.0, 2.0, 2.0], 0.5, 1),\n    ]\n\n    results = []\n    for dens_list, dx, i in test_cases:\n        rho = np.array(dens_list, dtype=float)\n        sigma_i, sigma_ip1, left_state, right_state = reconstruct_interface_states(rho, i, dx)\n        # Append as a list of floats\n        results.append([float(sigma_i), float(sigma_ip1), float(left_state), float(right_state)])\n\n    # Final print statement in the exact required format.\n    # Print as a single-line list of sublists with comma-separated floats.\n    def format_sublist(lst):\n        return \"[\" + \",\".join(f\"{x:.12g}\" for x in lst) + \"]\"\n    print(\"[\" + \",\".join(format_sublist(r) for r in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "Once the spatial discretization is handled and the semi-discrete form $\\frac{d\\boldsymbol{U}}{dt} = \\boldsymbol{L}(\\boldsymbol{U})$ is established, the final piece of the puzzle is to integrate this system of ordinary differential equations forward in time. While a simple forward Euler step is instructive, practical schemes require higher-order accuracy and better stability properties. This practice demonstrates the mechanics of a third-order Strong Stability Preserving Runge-Kutta (SSPRK) method, showing how the solution is advanced through multiple stages to achieve a more accurate and robust update.",
            "id": "3317315",
            "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma=1.4$, discretized by a conservative finite volume method on a uniform grid. In a given cell, the method-of-lines semi-discrete system is of the form $\\frac{d}{dt}\\boldsymbol{U}(t)=\\boldsymbol{L}(\\boldsymbol{U}(t))$, where $\\boldsymbol{U}=[\\rho,\\ \\rho u,\\ E]^{\\mathsf{T}}$ are the conservative variables: density $\\rho$, momentum $\\rho u$, and total energy per unit volume $E$. The total energy is related to the primitive variables by $E=\\frac{p}{\\gamma-1}+\\frac{1}{2}\\rho u^{2}$.\n\nAt time $t^{n}$, the primitive state in the cell is $\\rho^{n}=1.0\\ \\text{kg}\\,\\text{m}^{-3}$, $u^{n}=100\\ \\text{m}\\,\\text{s}^{-1}$, $p^{n}=1.0\\times 10^{5}\\ \\text{Pa}$. Use these to form the conservative state $\\boldsymbol{U}^{n}$. A high-resolution flux computation has been performed and, for this cell, the semi-discrete residual $\\boldsymbol{L}(\\cdot)$ has been numerically evaluated at the relevant stage states that arise when applying the canonical third-order Strong Stability Preserving Rungeâ€“Kutta (SSPRK) method with three stages and third order of accuracy (SSPRK(3,3)). The resulting residual vectors (in SI units per second) are:\n- At the initial state $\\boldsymbol{U}^{n}$: $\\boldsymbol{L}^{n}=\\begin{pmatrix}-0.80\\\\ 95.0\\\\ -1.20\\times 10^{5}\\end{pmatrix}$.\n- At the first-stage state (to be computed): $\\boldsymbol{L}^{(1)}=\\begin{pmatrix}-0.75\\\\ 92.0\\\\ -1.18\\times 10^{5}\\end{pmatrix}$.\n- At the second-stage state (to be computed): $\\boldsymbol{L}^{(2)}=\\begin{pmatrix}-0.79\\\\ 90.5\\\\ -1.16\\times 10^{5}\\end{pmatrix}$.\n\nTake the time step to be $\\Delta t=1.0\\times 10^{-4}\\ \\text{s}$. Starting from fundamental conservation and the method-of-lines formulation, and using the SSPRK(3,3) explicit time-marching framework, compute the first-stage, second-stage, and final updated conservative states for this cell. Then, report the updated density $\\rho^{n+1}$.\n\nRound your final numerical answer to six significant figures. Express the final density in $\\text{kg}\\,\\text{m}^{-3}$.",
            "solution": "The problem requires the calculation of the updated state of a fluid cell after one time step using an explicit time-marching scheme. The governing equations are the one-dimensional compressible Euler equations, which have been semi-discretized in space using a conservative finite volume method. This results in a system of ordinary differential equations (ODEs) for each cell, known as the method-of-lines formulation:\n$$ \\frac{d}{dt}\\boldsymbol{U}(t) = \\boldsymbol{L}(\\boldsymbol{U}(t)) $$\nHere, $\\boldsymbol{U} = [\\rho, \\rho u, E]^{\\mathsf{T}}$ is the vector of conserved variables: density $\\rho$, momentum $\\rho u$, and total energy per unit volume $E$. The term $\\boldsymbol{L}(\\boldsymbol{U}(t))$ represents the semi-discrete spatial operator, or residual.\n\nFirst, we must compute the initial state vector $\\boldsymbol{U}^n$ at time $t^n$ from the given primitive variables: $\\rho^{n}=1.0\\ \\text{kg}\\,\\text{m}^{-3}$, $u^{n}=100\\ \\text{m}\\,\\text{s}^{-1}$, and $p^{n}=1.0\\times 10^{5}\\ \\text{Pa}$. The ratio of specific heats is given as $\\gamma=1.4$.\n\nThe components of $\\boldsymbol{U}^n$ are:\n1.  Density: $\\rho^n = 1.0$\n2.  Momentum: $(\\rho u)^n = \\rho^n u^n = 1.0 \\times 100 = 100.0$\n3.  Total energy: $E^n = \\frac{p^n}{\\gamma-1} + \\frac{1}{2}\\rho^n (u^n)^2$.\nSubstituting the given values:\n$$ E^n = \\frac{1.0\\times 10^{5}}{1.4-1} + \\frac{1}{2}(1.0)(100)^2 = \\frac{1.0\\times 10^{5}}{0.4} + \\frac{1}{2}(10000) = 2.5\\times 10^{5} + 5000 = 255000 $$\nThus, the initial conservative state vector is:\n$$ \\boldsymbol{U}^n = \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} $$\nThe problem specifies the use of the canonical third-order Strong Stability Preserving Runge-Kutta (SSPRK(3,3)) method to advance the solution from $\\boldsymbol{U}^n$ to $\\boldsymbol{U}^{n+1}$. The time step is $\\Delta t = 1.0\\times 10^{-4}\\ \\text{s}$. The SSPRK(3,3) scheme proceeds in three stages:\n\nStage 1:\n$$ \\boldsymbol{U}^{(1)} = \\boldsymbol{U}^{n} + \\Delta t \\boldsymbol{L}(\\boldsymbol{U}^{n}) $$\nStage 2:\n$$ \\boldsymbol{U}^{(2)} = \\frac{3}{4}\\boldsymbol{U}^{n} + \\frac{1}{4}\\left(\\boldsymbol{U}^{(1)} + \\Delta t \\boldsymbol{L}(\\boldsymbol{U}^{(1)})\\right) $$\nStage 3 (Final update):\n$$ \\boldsymbol{U}^{n+1} = \\frac{1}{3}\\boldsymbol{U}^{n} + \\frac{2}{3}\\left(\\boldsymbol{U}^{(2)} + \\Delta t \\boldsymbol{L}(\\boldsymbol{U}^{(2)})\\right) $$\nThe problem provides the necessary evaluated residual vectors:\n$$ \\boldsymbol{L}^{n} = \\boldsymbol{L}(\\boldsymbol{U}^{n}) = \\begin{pmatrix}-0.80\\\\ 95.0\\\\ -1.20\\times 10^{5}\\end{pmatrix}, \\quad \\boldsymbol{L}^{(1)} = \\boldsymbol{L}(\\boldsymbol{U}^{(1)}) = \\begin{pmatrix}-0.75\\\\ 92.0\\\\ -1.18\\times 10^{5}\\end{pmatrix}, \\quad \\boldsymbol{L}^{(2)} = \\boldsymbol{L}(\\boldsymbol{U}^{(2)}) = \\begin{pmatrix}-0.79\\\\ 90.5\\\\ -1.16\\times 10^{5}\\end{pmatrix} $$\n\nWe proceed with the calculations for each stage.\n\n**Calculation of the first-stage state $\\boldsymbol{U}^{(1)}$:**\nWe first compute the increment $\\Delta t \\boldsymbol{L}^n$:\n$$ \\Delta t \\boldsymbol{L}^n = 1.0\\times 10^{-4} \\begin{pmatrix}-0.80\\\\ 95.0\\\\ -1.20\\times 10^{5}\\end{pmatrix} = \\begin{pmatrix}-0.00008\\\\ 0.0095\\\\ -12.0\\end{pmatrix} $$\nNow, we find $\\boldsymbol{U}^{(1)}$:\n$$ \\boldsymbol{U}^{(1)} = \\boldsymbol{U}^{n} + \\Delta t \\boldsymbol{L}^n = \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} + \\begin{pmatrix}-0.00008\\\\ 0.0095\\\\ -12.0\\end{pmatrix} = \\begin{pmatrix} 0.99992 \\\\ 100.0095 \\\\ 254988.0 \\end{pmatrix} $$\n\n**Calculation of the second-stage state $\\boldsymbol{U}^{(2)}$:**\nFirst, we compute the term inside the parenthesis: $\\boldsymbol{U}^{(1)} + \\Delta t \\boldsymbol{L}^{(1)}$.\n$$ \\Delta t \\boldsymbol{L}^{(1)} = 1.0\\times 10^{-4} \\begin{pmatrix}-0.75\\\\ 92.0\\\\ -1.18\\times 10^{5}\\end{pmatrix} = \\begin{pmatrix}-0.000075\\\\ 0.0092\\\\ -11.8\\end{pmatrix} $$\n$$ \\boldsymbol{U}^{(1)} + \\Delta t \\boldsymbol{L}^{(1)} = \\begin{pmatrix} 0.99992 \\\\ 100.0095 \\\\ 254988.0 \\end{pmatrix} + \\begin{pmatrix}-0.000075\\\\ 0.0092\\\\ -11.8\\endpmatrix} = \\begin{pmatrix} 0.999845 \\\\ 100.0187 \\\\ 254976.2 \\end{pmatrix} $$\nNow, we apply the coefficients for $\\boldsymbol{U}^{(2)}$:\n$$ \\boldsymbol{U}^{(2)} = \\frac{3}{4} \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} 0.999845 \\\\ 100.0187 \\\\ 254976.2 \\endpmatrix} $$\n$$ \\boldsymbol{U}^{(2)} = \\begin{pmatrix} 0.75 \\\\ 75.0 \\\\ 191250.0 \\end{pmatrix} + \\begin{pmatrix} 0.24996125 \\\\ 25.004675 \\\\ 63744.05 \\end{pmatrix} = \\begin{pmatrix} 0.99996125 \\\\ 100.004675 \\\\ 254994.05 \\end{pmatrix} $$\n\n**Calculation of the final updated state $\\boldsymbol{U}^{n+1}$:**\nSimilar to the previous stage, we first compute the term $\\boldsymbol{U}^{(2)} + \\Delta t \\boldsymbol{L}^{(2)}$.\n$$ \\Delta t \\boldsymbol{L}^{(2)} = 1.0\\times 10^{-4} \\begin{pmatrix}-0.79\\\\ 90.5\\\\ -1.16\\times 10^{5}\\end{pmatrix} = \\begin{pmatrix}-0.000079\\\\ 0.00905\\\\ -11.6\\endpmatrix} $$\n$$ \\boldsymbol{U}^{(2)} + \\Delta t \\boldsymbol{L}^{(2)} = \\begin{pmatrix} 0.99996125 \\\\ 100.004675 \\\\ 254994.05 \\end{pmatrix} + \\begin{pmatrix}-0.000079\\\\ 0.00905\\\\ -11.6\\endpmatrix} = \\begin{pmatrix} 0.99988225 \\\\ 100.013725 \\\\ 254982.45 \\end{pmatrix} $$\nFinally, we apply the coefficients for $\\boldsymbol{U}^{n+1}$:\n$$ \\boldsymbol{U}^{n+1} = \\frac{1}{3} \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix} 0.99988225 \\\\ 100.013725 \\\\ 254982.45 \\end{pmatrix} $$\n$$ \\boldsymbol{U}^{n+1} = \\begin{pmatrix} 1/3 \\\\ 100/3 \\\\ 85000.0 \\end{pmatrix} + \\begin{pmatrix} 0.666588166... \\\\ 66.67581666... \\\\ 169988.3 \\end{pmatrix} = \\begin{pmatrix} 0.999921499... \\\\ 100.0091499... \\\\ 254988.3 \\end{pmatrix} $$\nThe question specifically asks for the updated density $\\rho^{n+1}$, which is the first component of the final state vector $\\boldsymbol{U}^{n+1}$.\n$$ \\rho^{n+1} \\approx 0.9999215 $$\nThe problem requires this value to be rounded to six significant figures. The first six significant digits are $9, 9, 9, 9, 2, 1$. The seventh digit is $5$, which requires rounding up the last significant digit.\nTherefore, the rounded value is $0.999922$.",
            "answer": "$$\\boxed{0.999922}$$"
        }
    ]
}