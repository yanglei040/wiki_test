{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握一个数值格式，我们必须首先理解其最核心的构成部分。这个练习将引导您从几个基本的物理和数学约束条件出发，推导出van Leer通量分裂中著名的亚声速分裂多项式。通过这个过程，您不仅能学会公式本身，更能领会其背后的设计思想和严谨逻辑，这是从使用者转变为开发者的关键一步 。",
            "id": "3387430",
            "problem": "考虑一维可压缩欧拉方程和马赫数定义 $M = u/a$，其中 $u$ 是流体速度，$a$ 是声速。在用于对流项的 van Leer 通量矢量分裂中，目标是将质量对流通量分裂为正向传播和负向传播的贡献，对于亚声速状态 $|M|1$，这表示为应用于马赫数的分裂函数 $\\phi^{+}(M)$ 和 $\\phi^{-}(M)$。在超声速状态下，使用绝对迎风分裂：对于 $M \\geq 1$，正分支承载全部对流贡献，负分支为零；对于 $M \\leq -1$，负分支承载全部贡献，正分支为零。\n\n从第一性原理出发，对亚声速分裂函数要求以下经过充分检验且具有物理基础的约束条件：\n- 与超声速分支在声速点处的连续性：$\\phi^{+}(1)=1$，$\\phi^{-}(1)=0$，$\\phi^{+}(-1)=0$，$\\phi^{-}(-1)=-1$。\n- 速度符号反转下的对称性：对于所有 $M \\in (-1,1)$，有 $\\phi^{-}(M) = -\\phi^{+}(-M)$。\n- 在亚声速范围内的精确质量通量恢复：对于所有 $M \\in (-1,1)$，有 $\\phi^{+}(M) + \\phi^{-}(M) = M$。\n\n此外，为防止在声速点出现非物理伪影，假设亚声速分裂函数是在 $M=\\pm 1$ 处可微的最低阶多项式，并与那里的超声速分支的一阶导数相匹配。\n\n构造满足所有这些条件的 $|M|1$ 时的 $\\phi^{+}(M)$ 和 $\\phi^{-}(M)$ 的显式多项式形式。您的最终答案必须是以闭式解析表达式写出的一对 $\\phi^{+}(M)$ 和 $\\phi^{-}(M)$。最终表达式中不要求数值四舍五入，也不应包含单位。",
            "solution": "用于对流项的 van Leer 通量矢量分裂旨在寻找函数 $\\phi^{+}(M)$ 和 $\\phi^{-}(M)$，它们根据传播方向正确地划分质量对流通量。我们从问题中确定以下要求：\n\n1. 在声速点 $M=\\pm 1$ 处与超声速绝对迎风分裂的连续性：\n   - 对于 $M=1$，正分支必须承载全部贡献，而负分支为零，因此 $\\phi^{+}(1)=1$ 且 $\\phi^{-}(1)=0$。\n   - 对于 $M=-1$，负分支必须承载全部贡献，而正分支为零，因此 $\\phi^{+}(-1)=0$ 且 $\\phi^{-}(-1)=-1$。\n\n2. 对称性：\n   - 分裂应遵守符号反转，因此对于 $M \\in (-1,1)$，有 $\\phi^{-}(M) = - \\phi^{+}(-M)$。\n\n3. 精确质量通量恢复：\n   - 分裂的分量必须能重新组合成原始的对流内容，因此对于 $M \\in (-1,1)$，有 $\\phi^{+}(M) + \\phi^{-}(M) = M$。\n\n4. 光滑性和最低阶多项式：\n   - 为避免在声速点产生虚假的波反射或耗散，亚声速多项式在 $M=\\pm 1$ 处应是可微的，并与超声速分支的一阶导数相匹配。超声速行为是：对于正分支，当 $M \\geq 1$ 时 $\\phi^{+}(M)=M$，当 $M \\leq -1$ 时 $\\phi^{+}(M)=0$；对于负分支，当 $M \\geq 1$ 时 $\\phi^{-}(M)=0$，当 $M \\leq -1$ 时 $\\phi^{-}(M)=M$。因此，\n   - $\\frac{d}{dM}\\phi^{+}(1) = 1$ 且 $\\frac{d}{dM}\\phi^{+}(-1) = 0$，\n   - $\\frac{d}{dM}\\phi^{-}(1) = 0$ 且 $\\frac{d}{dM}\\phi^{-}(-1) = 1$。\n\n我们在 $|M|1$ 上构造一个与端点值和导数匹配的最低阶多项式 $\\phi^{+}(M)$。一个能在 $M=-1$ 处强制函数值为零且导数为零的自然选择是包含一个 $(M+1)$ 的平方因子，即，令\n$$\n\\phi^{+}(M) = c\\,(M+1)^{2}\n$$\n其中 $c$ 为某个常数。这种形式意味着 $\\phi^{+}(-1) = 0$ 和 $\\frac{d}{dM}\\phi^{+}(-1) = 0$，这与正分支的超声速左侧行为相匹配，因为对于 $M \\leq -1$，该分支恒为零。\n\n我们现在强制要求 $\\phi^{+}(1) = 1$：\n$$\n\\phi^{+}(1) = c\\,(1+1)^{2} = c\\,(2)^{2} = 4c = 1 \\quad \\Rightarrow \\quad c = \\frac{1}{4}.\n$$\n因此，\n$$\n\\phi^{+}(M) = \\frac{1}{4}(M+1)^{2}.\n$$\n我们在 $M=1$ 处验证导数：\n$$\n\\frac{d}{dM}\\phi^{+}(M) = \\frac{1}{2}(M+1), \\quad \\frac{d}{dM}\\phi^{+}(1) = \\frac{1}{2}(2) = 1,\n$$\n这与正分支在 $M=1$ 处的超声速导数相匹配。\n\n根据对称性，我们定义\n$$\n\\phi^{-}(M) = -\\phi^{+}(-M) = -\\frac{1}{4}(-M+1)^{2} = -\\frac{1}{4}(1-M)^{2} = -\\frac{1}{4}(M-1)^{2}.\n$$\n我们检查端点值：\n- 在 $M=1$ 处，$\\phi^{-}(1) = -\\frac{1}{4}(1-1)^{2} = 0$，与超声速负分支一致。\n- 在 $M=-1$ 处，$\\phi^{-}(-1) = -\\frac{1}{4}((-1)-1)^{2} = -\\frac{1}{4}(-2)^{2} = -1$，与超声速负分支一致。\n\n我们验证负分支的导数匹配：\n$$\n\\frac{d}{dM}\\phi^{-}(M) = -\\frac{1}{2}(M-1),\n$$\n因此\n$$\n\\frac{d}{dM}\\phi^{-}(1) = -\\frac{1}{2}(0) = 0, \\quad \\frac{d}{dM}\\phi^{-}(-1) = -\\frac{1}{2}(-2) = 1,\n$$\n分别与负分支在 $M=1$ 和 $M=-1$ 处的超声速导数相匹配。\n\n最后，我们验证对于所有 $M \\in (-1,1)$ 的精确质量通量恢复：\n$$\n\\phi^{+}(M) + \\phi^{-}(M) = \\frac{1}{4}(M+1)^{2} - \\frac{1}{4}(M-1)^{2} = \\frac{1}{4}\\left[(M^{2}+2M+1) - (M^{2}-2M+1)\\right] = \\frac{1}{4}(4M) = M.\n$$\n\n因此，在 $|M|1$ 上，满足在 $M=\\pm 1$ 处的连续性、对称性、精确质量通量恢复以及在声速点处的导数匹配的唯一的最低阶光滑多项式分裂函数为\n$$\n\\phi^{+}(M) = \\frac{1}{4}(M+1)^{2}, \\quad \\phi^{-}(M) = -\\frac{1}{4}(M-1)^{2}.\n$$\n这些就是所求的亚声速分裂函数。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{4}\\,(M+1)^{2}  -\\frac{1}{4}\\,(M-1)^{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "真实世界的流体问题几乎都是多维的，因此将一维数值格式推广到高维空间是计算流体力学中的一项核心技能。本实践练习聚焦于如何利用法向马赫数 $M_n$ 将一维的van Leer分裂思想扩展至二维或三维，并证明其关键的旋转不变性。您需要通过理论推导和编程实践来验证这一性质，从而深刻理解如何构建一个在任意坐标系下都表现一致的稳健数值格式 。",
            "id": "3387357",
            "problem": "考虑二维无粘可压欧拉方程，它是一个关于状态向量 $U = [\\rho, \\rho u, \\rho v, \\rho E]^\\top$ 的守恒律系统，其中 $\\rho$ 是密度，$(u,v)$ 是速度的笛卡尔分量，$E$ 是比总能。令比热比为 $\\gamma$，热力学压力为 $p$，声速为 $a = \\sqrt{\\gamma p / \\rho}$。比总焓为 $H = E + p / \\rho$。通过具有单位外法线 $\\mathbf{n} = (n_x, n_y)$ 的面的通量是法向通量 $F_n(U)$，它是通过将物理通量投影到方向 $\\mathbf{n}$ 上得到的。\n\n从欧拉方程和热力学量的定义出发，推导一种 van Leer 意义上的多维通量矢量分裂 (FVS) 方法，该方法仅依赖于法向马赫数 $M_n = (\\mathbf{u} \\cdot \\mathbf{n}) / a$ 和热力学标量。具体而言，构造分裂通量 $F_n^+(U)$ 和 $F_n^-(U)$，使得 $F_n(U) = F_n^+(U) + F_n^-(U)$，并且每次分裂都通过 $M_n$ 依赖于相对于面法线方向的波传播符号。证明当分裂通量写为 $F_n^\\pm(U) = F^\\pm(U;\\,M_n)$ 时，它具有旋转不变性，即如果坐标系通过正交变换进行旋转，并且 $\\mathbf{n}$ 也进行一致的旋转，则分裂通量在动量分量上作为正常向量进行变换，而质量和能量分量保持为不变的标量。\n\n使用以下基础：\n- 守恒形式的欧拉方程及其旋转不变性。\n- 将法向通量分解为对流贡献和压力功贡献，每个贡献都可以用 $\\rho$、$(u,v)$、$p$、$a$、$H$ 和面法线 $\\mathbf{n}$ 表示。\n- 法向马赫数 $M_n$ 的定义，其来自于速度在 $\\mathbf{n}$ 上的投影。\n\n在推导过程中，您不得假设或陈述任何预先推导的 van Leer 公式。您必须从第一性原理出发进行推导，确保与守恒形式以及沿面法线的特征速度保持一致。\n\n在推导多维分裂通量并证明其旋转不变性之后，实现一个程序，该程序：\n- 构造一个马赫数为 $M_\\infty = 2$ 的均匀超音速自由来流，其中 $\\gamma = 1.4$，密度 $\\rho_\\infty = 1.225$ 千克/立方米，压力 $p_\\infty = 101325$ 帕斯卡。计算相应的声速 $a_\\infty$ 和自由来流速度大小 $U_\\infty = M_\\infty a_\\infty$。\n- 定义一个笛卡尔网格，其面外法线为 $\\mathbf{n}_x = (1,0)$ 和 $\\mathbf{n}_y = (0,1)$，以及一个由角度 $\\theta$ (以弧度为单位) 旋转的自由来流速度方向。\n- 对于每个面法线和每个测试角度，使用您的多维 van Leer FVS 计算分裂通量 $F_n^\\pm(U)$，并独立地通过将状态旋转到面元对齐坐标系，沿对齐法线应用一维分裂，然后将分裂通量的动量分量旋转回原始坐标系来计算它们。\n- 报告每个测试角度下，直接计算的分裂通量与旋转坐标系计算的分裂通量之间的最大绝对差（涵盖两个面和两个符号）。\n\n角度单位说明：所有角度均使用弧度。\n\n您的程序必须实现所述方法，并为以下自由来流角度的测试套件生成结果：\n- $\\theta_1 = 0$ (与 $x$ 轴对齐),\n- $\\theta_2 = \\pi/3$ ($x$ 面法向马赫数等于 $1$),\n- $\\theta_3 = \\pi/4$,\n- $\\theta_4 = -\\pi/6$.\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4]\"）。每个结果都必须是一个浮点数，等于上述的最大绝对差。由于这些差异是无量纲的，因此输出不需要物理单位。程序必须是自包含的，不得读取任何输入，并且必须使用指定的运行时环境。",
            "solution": "该问题要求推导二维欧拉方程的旋转不变多维 van Leer 通量矢量分裂 (FVS) 方法，证明其旋转不变性，并进行数值验证。\n\n### 第一部分：多维 van Leer 分裂通量的推导\n\n我们从守恒形式的二维无粘可压欧拉方程开始：\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F_x(U)}{\\partial x} + \\frac{\\partial F_y(U)}{\\partial y} = 0\n$$\n其中状态向量 $U$ 和笛卡尔通量向量 $F_x(U)$、$F_y(U)$ 由下式给出：\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho v \\\\ \\rho E \\end{pmatrix}, \\quad\nF_x(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ \\rho uv \\\\ \\rho u H \\end{pmatrix}, \\quad\nF_y(U) = \\begin{pmatrix} \\rho v \\\\ \\rho uv \\\\ \\rho v^2 + p \\\\ \\rho v H \\end{pmatrix}\n$$\n这里，$\\rho$ 是密度，$\\mathbf{u} = (u,v)$ 是速度向量，$p$ 是压力，$E = \\frac{p}{(\\gamma-1)\\rho} + \\frac{1}{2}(u^2+v^2)$ 是比总能，$H = E + p/\\rho$ 是比总焓，$\\gamma$ 是比热比。\n\n通过具有单位外法向量 $\\mathbf{n} = (n_x, n_y)$ 的表面的通量是法向通量 $F_n(U)$，通过将笛卡尔通量投影到 $\\mathbf{n}$ 上得到：\n$$\nF_n(U) = F_x(U) n_x + F_y(U) n_y = \\begin{pmatrix} \\rho(un_x + vn_y) \\\\ (\\rho u^2+p)n_x + (\\rho uv)n_y \\\\ (\\rho uv)n_x + (\\rho v^2+p)n_y \\\\ (\\rho u H)n_x + (\\rho v H)n_y \\end{pmatrix}\n$$\n令 $u_n = \\mathbf{u} \\cdot \\mathbf{n} = u n_x + v n_y$ 为速度的法向分量。法向通量可以写为：\n$$\nF_n(U) = \\begin{pmatrix} \\rho u_n \\\\ \\rho u u_n + p n_x \\\\ \\rho v u_n + p n_y \\\\ \\rho H u_n \\end{pmatrix}\n$$\n为了使结构在坐标旋转下保持不变，我们使用向量表示法来表示动量分量：\n$$\nF_n(U) = \\begin{pmatrix} \\rho u_n \\\\ \\rho \\mathbf{u} u_n + p \\mathbf{n} \\\\ \\rho H u_n \\end{pmatrix}\n$$\n通量矢量分裂 (FVS) 的目标是将 $F_n(U)$ 分解为两部分，$F_n^+(U)$ 和 $F_n^-(U)$，使得 $F_n(U) = F_n^+(U) + F_n^-(U)$。该分裂基于垂直于面的信息传播方向。欧拉方程在法向上的特征速度是通量雅可比矩阵 $\\partial F_n / \\partial U$ 的特征值，即 $\\lambda_1 = u_n - a$、$\\lambda_{2,3} = u_n$ 和 $\\lambda_4 = u_n + a$，其中 $a = \\sqrt{\\gamma p / \\rho}$ 是声速。分裂通量 $F_n^+$ 和 $F_n^-$ 的构造方式使得雅可比矩阵 $\\partial F_n^+ / \\partial U$ 的特征值非负，而 $\\partial F_n^- / \\partial U$ 的特征值非正。\n\nvan Leer 分裂格式通过使分裂依赖于法向马赫数 $M_n = u_n / a$ 来实现这一点。\n\n**超音速流 ($|M_n| \\ge 1$):**\n在超音速流中，所有特征波都沿同一方向传播。\n- 如果 $M_n \\ge 1$，流动为顺流。所有信息都随流动方向移动，因此整个通量都与正向相关联。\n  $$ F_n^+(U) = F_n(U), \\quad F_n^-(U) = 0 $$\n- 如果 $M_n \\le -1$，流动为逆流。所有信息都与正法线方向相反移动。\n  $$ F_n^+(U) = 0, \\quad F_n^-(U) = F_n(U) $$\n\n**亚音速流 ($|M_n|  1$):**\n在亚音速流中，声波 $(u_n \\pm a)$ 向相反方向传播。通量必须分裂为与这些方向相关联的分量。我们遵循将一维 van Leer 分裂扩展为多维旋转不变形式的原则。关键在于从旋转不变的标量和正确变换的向量来构造分裂通量向量。\n\n我们定义一个分裂质量通量 $f_m^\\pm$ 和一个分裂压力 $p^\\pm$：\n1.  **分裂质量通量**：总质量通量为 $f_m = \\rho u_n$。对于 $|M_n|  1$，van Leer 的多项式分裂为：\n    $$ f_m^\\pm(M_n) = \\pm \\frac{1}{4} \\rho a (M_n \\pm 1)^2 $$\n    其和正确地重构了总质量通量：$f_m^+ + f_m^- = \\frac{1}{4}\\rho a[(M_n+1)^2 - (M_n-1)^2] = \\frac{1}{4}\\rho a[4M_n] = \\rho a M_n = \\rho u_n$。\n2.  **分裂压力**：总压力贡献 $p$ 根据声波的传播进行分裂。对于 $|M_n|  1$，多项式分裂为：\n    $$ p^\\pm(M_n) = p \\cdot \\frac{1}{4} (M_n \\pm 1)^2 (2 \\mp M_n) $$\n    其和正确地重构了总压力：$p^+ + p^- = \\frac{p}{4}[ (M_n^2+2M_n+1)(2-M_n) + (M_n^2-2M_n+1)(2+M_n) ] = \\frac{p}{4}[ (-M_n^3+3M_n+2) + (M_n^3-3M_n+2) ] = p$。\n\n使用这些分裂的标量，我们通过从一维情况推广结构来构造多维分裂通量向量 $F_n^\\pm$。总通量分量可以解释为质量通量 ($\\rho u_n$)、动量通量 ($\\rho \\mathbf{u} u_n + p \\mathbf{n}$) 和能量通量 ($\\rho H u_n = (\\rho u_n) H$)。我们类似地组装分裂通量：\n$$\nF_n^\\pm(U) = \\begin{pmatrix} f_m^\\pm \\\\ f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n} \\\\ f_m^\\pm H \\end{pmatrix}\n$$\n这种形式将标量 $f_m^\\pm$ 和 $p^\\pm$ 与向量 $\\mathbf{u}$ 和 $\\mathbf{n}$ 结合起来。各项为：\n- 质量分量：$f_m^\\pm$\n- 动量分量：$f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n}$\n- 能量分量：$f_m^\\pm H$\n\n对于 $|M_n|  1$，$F_n^+ + F_n^-$ 的和正确地恢复了完整通量 $F_n(U)$。分裂函数和超音速截断确保了分裂通量在 $M_n = \\pm 1$ 处的连续性和可微性。\n\n### 第二部分：旋转不变性的证明\n\n为了证明该分裂是旋转不变的，我们必须证明在任意正交坐标系旋转下，分裂通量的形式保持一致。设 $T$ 是一个正交旋转矩阵 ($T^\\top T = I$)。在旋转后的坐标系中，向量变换为 $\\mathbf{v}' = T\\mathbf{v}$，而标量保持不变。\n- 带撇号的量表示旋转后的坐标系。\n- 标量热力学性质是不变的：$\\rho' = \\rho$，$p' = p$，$a' = a$，$E' = E$，$H' = H$。\n- 速度和法向量的变换方式为：$\\mathbf{u}' = T\\mathbf{u}$ 和 $\\mathbf{n}' = T\\mathbf{n}$。\n\n关键步骤是检查法向马赫数 $M_n$ 的变换性质。旋转坐标系中的法向速度为：\n$$\nu_n' = \\mathbf{u}' \\cdot \\mathbf{n}' = (T\\mathbf{u}) \\cdot (T\\mathbf{n}) = (T\\mathbf{u})^\\top (T\\mathbf{n}) = \\mathbf{u}^\\top T^\\top T \\mathbf{n} = \\mathbf{u}^\\top I \\mathbf{n} = \\mathbf{u} \\cdot \\mathbf{n} = u_n\n$$\n由于 $u_n$ 是一个旋转不变量（一个真标量），而 $a$ 也是一个标量，因此法向马赫数是不变的：\n$$\nM_n' = u_n' / a' = u_n / a = M_n\n$$\n因为分裂质量通量 $f_m^\\pm$ 和分裂压力 $p^\\pm$ 仅依赖于 $\\rho, p, a$ 和 $M_n$，这些都是旋转不变量，所以这些量也是不变的：\n$$\nf_m'^\\pm = f_m^\\pm, \\quad p'^\\pm = p^\\pm\n$$\n现在，我们来考察分裂通量向量 $F_n^\\pm(U)$ 的变换。它在旋转坐标系中的分量 $F_{n'}^\\pm(U')$ 为：\n$$\nF_{n'}^\\pm(U') = \\begin{pmatrix} f_m'^\\pm \\\\ f_m'^\\pm \\mathbf{u}' + p'^\\pm \\mathbf{n}' \\\\ f_m'^\\pm H' \\end{pmatrix}\n= \\begin{pmatrix} f_m^\\pm \\\\ f_m^\\pm (T\\mathbf{u}) + p^\\pm (T\\mathbf{n}) \\\\ f_m^\\pm H \\end{pmatrix}\n= \\begin{pmatrix} f_m^\\pm \\\\ T(f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n}) \\\\ f_m^\\pm H \\end{pmatrix}\n$$\n这个结果表明：\n1.  质量分量 $f_m^\\pm$ 是一个标量，并正确地保持不变。\n2.  能量分量 $f_m^\\pm H$ 是一个标量，并正确地保持不变。\n3.  动量分量 $f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n}$ 的变换方式为 $T(f_m^\\pm \\mathbf{u} + p^\\pm \\mathbf{n})$，这是向量的正确变换规则。\n\n分裂公式的结构与坐标系的选择无关。它仅依赖于内在的、与坐标无关的量（标量和向量）。这样就完成了旋转不变性的证明。问题的数值部分将通过比较直接计算与涉及显式旋转的计算来验证这一性质。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and verifies the rotational invariance of a multidimensional\n    van Leer Flux Vector Splitting scheme for the 2D Euler equations.\n    \"\"\"\n\n    # 1. Define problem constants and free-stream conditions\n    gamma = 1.4\n    rho_inf = 1.225  # kg/m^3\n    p_inf = 101325.0  # Pa\n    M_inf = 2.0\n\n    a_inf = np.sqrt(gamma * p_inf / rho_inf)\n    U_inf_mag = M_inf * a_inf\n    E_inf = p_inf / ((gamma - 1) * rho_inf) + 0.5 * U_inf_mag**2\n    H_inf = E_inf + p_inf / rho_inf\n\n    # State primitives (constant for the free stream)\n    rho, p, a, E, H = rho_inf, p_inf, a_inf, E_inf, H_inf\n\n    test_cases = [\n        0.0,          # Aligned with x-axis\n        np.pi / 3,    # Mn = 1 for x-face\n        np.pi / 4,    # General supersonic case\n        -np.pi / 6,   # Mn = -1 for y-face\n    ]\n\n    normals = [\n        np.array([1.0, 0.0]),  # x-face\n        np.array([0.0, 1.0]),  # y-face\n    ]\n\n    results = []\n\n    def get_split_flux_direct(u_vec, n_vec):\n        \"\"\"Computes split fluxes F+ and F- directly using the multidimensional formula.\"\"\"\n        u, v = u_vec\n        nx, ny = n_vec\n\n        un = u * nx + v * ny\n        Mn = un / a\n\n        F_plus = np.zeros(4)\n        F_minus = np.zeros(4)\n\n        if Mn = 1.0:\n            F_plus[0] = rho * un\n            F_plus[1] = rho * u * un + p * nx\n            F_plus[2] = rho * v * un + p * ny\n            F_plus[3] = rho * H * un\n        elif Mn = -1.0:\n            F_minus[0] = rho * un\n            F_minus[1] = rho * u * un + p * nx\n            F_minus[2] = rho * v * un + p * ny\n            F_minus[3] = rho * H * un\n        else: # |Mn|  1.0\n            # Split mass flux\n            fm_plus = rho * a * 0.25 * (Mn + 1.0)**2\n            fm_minus = -rho * a * 0.25 * (Mn - 1.0)**2\n            # Split pressure\n            p_plus = p * 0.25 * (Mn + 1.0)**2 * (2.0 - Mn)\n            p_minus = p * 0.25 * (Mn - 1.0)**2 * (2.0 + Mn)\n\n            # Assemble F+\n            F_plus[0] = fm_plus\n            F_plus[1] = fm_plus * u + p_plus * nx\n            F_plus[2] = fm_plus * v + p_plus * ny\n            F_plus[3] = fm_plus * H\n\n            # Assemble F-\n            F_minus[0] = fm_minus\n            F_minus[1] = fm_minus * u + p_minus * nx\n            F_minus[2] = fm_minus * v + p_minus * ny\n            F_minus[3] = fm_minus * H\n            \n        return F_plus, F_minus\n\n    def get_split_flux_rotated(u_vec, n_vec):\n        \"\"\"Computes split fluxes by rotating, applying 1D split, and rotating back.\"\"\"\n        u, v = u_vec\n        nx, ny = n_vec\n\n        # Rotated velocity components\n        un = u * nx + v * ny  # Normal velocity\n        ut = -u * ny + v * nx # Tangential velocity\n        Mn = un / a\n\n        F_plus_rot = np.zeros(4)\n        F_minus_rot = np.zeros(4)\n\n        if Mn = 1.0:\n            F_plus_rot[0] = rho * un\n            F_plus_rot[1] = rho * un * un + p\n            F_plus_rot[2] = rho * un * ut\n            F_plus_rot[3] = rho * H * un\n        elif Mn = -1.0:\n            F_minus_rot[0] = rho * un\n            F_minus_rot[1] = rho * un * un + p\n            F_minus_rot[2] = rho * un * ut\n            F_minus_rot[3] = rho * H * un\n        else: # |Mn|  1.0\n            fm_plus = rho * a * 0.25 * (Mn + 1.0)**2\n            fm_minus = -rho * a * 0.25 * (Mn - 1.0)**2\n            p_plus = p * 0.25 * (Mn + 1.0)**2 * (2.0 - Mn)\n            p_minus = p * 0.25 * (Mn - 1.0)**2 * (2.0 + Mn)\n\n            # Assemble F+ in rotated frame\n            F_plus_rot[0] = fm_plus\n            F_plus_rot[1] = fm_plus * un + p_plus\n            F_plus_rot[2] = fm_plus * ut\n            F_plus_rot[3] = fm_plus * H\n\n            # Assemble F- in rotated frame\n            F_minus_rot[0] = fm_minus\n            F_minus_rot[1] = fm_minus * un + p_minus\n            F_minus_rot[2] = fm_minus * ut\n            F_minus_rot[3] = fm_minus * H\n\n        # Rotate momentum components back to original frame\n        F_plus_final = np.copy(F_plus_rot)\n        F_plus_final[1] = F_plus_rot[1] * nx - F_plus_rot[2] * ny\n        F_plus_final[2] = F_plus_rot[1] * ny + F_plus_rot[2] * nx\n\n        F_minus_final = np.copy(F_minus_rot)\n        F_minus_final[1] = F_minus_rot[1] * nx - F_minus_rot[2] * ny\n        F_minus_final[2] = F_minus_rot[1] * ny + F_minus_rot[2] * nx\n\n        return F_plus_final, F_minus_final\n\n    for theta in test_cases:\n        max_abs_diff_for_angle = 0.0\n        \n        # 2. Get free-stream velocity vector for the current angle\n        u = U_inf_mag * np.cos(theta)\n        v = U_inf_mag * np.sin(theta)\n        u_vec = np.array([u, v])\n\n        for n_vec in normals:\n            # 3. Method 1: Direct multidimensional calculation\n            F_plus_direct, F_minus_direct = get_split_flux_direct(u_vec, n_vec)\n\n            # 4. Method 2: Rotated frame calculation\n            F_plus_rotated, F_minus_rotated = get_split_flux_rotated(u_vec, n_vec)\n\n            # 5. Compare results and update max difference\n            diff_plus = np.max(np.abs(F_plus_direct - F_plus_rotated))\n            diff_minus = np.max(np.abs(F_minus_direct - F_minus_rotated))\n            \n            max_abs_diff_for_angle = max(max_abs_diff_for_angle, diff_plus, diff_minus)\n\n        results.append(max_abs_diff_for_angle)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "数值通量的具体构造形式对计算结果的稳定性和物理真实性至关重要。本练习旨在挑战您对数值格式性质的深刻理解，通过对比分析，阐明为何标准的van Leer分裂方法能够保持单调性和正确的迎风偏置。您将探讨一个看似微小的改动——例如对面元马赫数进行平均——为何可能破坏格式的优良特性，甚至导致非物理解的出现，从而加深对迎风格式设计精髓的认识 。",
            "id": "3387415",
            "problem": "考虑 $d$ 维空间中守恒形式的可压缩欧拉方程，写作 $\\partial_t \\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$，其中 $\\boldsymbol{U}$ 是守恒状态，$\\boldsymbol{F}(\\boldsymbol{U})$ 是物理通量，$\\boldsymbol{u}$ 是速度，$a$ 是声速。设 $\\boldsymbol{n}$ 为网格面的单位法向量，$u_n = \\boldsymbol{u} \\cdot \\boldsymbol{n}$ 为面法向速度，$M = u_n / a$ 为面法向马赫数。在一个面上，用 $\\boldsymbol{U}_L$ 和 $\\boldsymbol{U}_R$ 表示左、右状态，并有相应的 $u_{n,L}$、$u_{n,R}$、$a_L$、$a_R$ 以及 $M_L = u_{n,L}/a_L$、$M_R = u_{n,R}/a_R$。\n\nVan Leer 通量矢量分裂构造了形如 $\\widehat{\\boldsymbol{F}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R; \\boldsymbol{n}) = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$ 的数值通量，其中 $+$ 和 $-$ 的贡献分别与相对于面法线向右和向左移动的特征场相关联，并且对 $M$ 的依赖性强制实现了一个光滑的跨音速迎风偏置。具体来说，对于每个速度为 $\\lambda$（法向通量雅可比矩阵的特征值）的特征场，分裂权重作为马赫数 $M$ 的函数满足以下定性性质：(i) 对于强右行流，负贡献消失；(ii) 对于强左行流，正贡献消失；(iii) 在亚音速区域，两个贡献都非零，但其偏置与特征速度的符号保持一致。您可以假设面法向方向上的欧拉通量雅可比矩阵具有实特征值 $\\lambda_k \\in \\{u_n - a, u_n, u_n + a\\}$ 和一套完备的左、右特征向量，因此沿着每个特征，更新的行为类似于一个以速度 $\\lambda_k$ 平流的标量守恒律。\n\n一种常见的变体方案是计算平均面马赫数 $M_{\\mathrm{avg}} = \\tfrac{M_L + M_R}{2}$，并将其同时用于 $\\boldsymbol{F}^+(\\boldsymbol{U}_L; M_{\\mathrm{avg}})$ 和 $\\boldsymbol{F}^-(\\boldsymbol{U}_R; M_{\\mathrm{avg}})$。\n\n仅使用上述基本原理，从特征结构和标量数值通量的单调性准则出发，论述 Van Leer 通量矢量分裂的迎风性和单调性。具体来说：\n\n- 解释为什么在 $\\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L)$ 中仅使用 $M_L$ 并在 $\\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$ 中仅使用 $M_R$ 可以保持迎风方向性，并且沿着每个特征产生一个对其左侧变量非减、对其右侧变量非增的两点通量。\n\n- 解释为什么在 $\\boldsymbol{F}^+$ 和 $\\boldsymbol{F}^-$ 中用平均值 $M_{\\mathrm{avg}}$ 替代 $M_L$ 和 $M_R$ 会在跨音速状态（例如，$M_L  0$ 且 $M_R  0$）附近破坏这些性质，并给出一个说明这种失效的具体情景。\n\n根据您的分析，选择所有必然为真的陈述：\n\nA. 在 Van Leer 通量矢量分裂中使用分离的面法向马赫数 $M_L$ 和 $M_R$，可以得到一个数值通量，其关于 $\\boldsymbol{U}_L$ 的雅可比矩阵在右行特征场上是半正定的，其关于 $\\boldsymbol{U}_R$ 的雅可比矩阵在左行特征场上是半负定的，从而保持了迎风方向性，并在投影到特征变量上时满足离散单调性条件。\n\nB. 在面上平均马赫数 $M_{\\mathrm{avg}} = \\tfrac{M_L + M_R}{2}$ 会违反标量单调性条件，因为 $\\boldsymbol{F}^+$ 和 $\\boldsymbol{F}^-$ 对 $M_{\\mathrm{avg}}$ 的依赖性引入了对 $\\boldsymbol{U}_L$ 和 $\\boldsymbol{U}_R$ 两者的交叉依赖；在跨音速状态附近，这可能改变通量关于 $\\boldsymbol{U}_R$ 或 $\\boldsymbol{U}_L$ 的偏导数的符号。\n\nC. 使用平均马赫数 $M_{\\mathrm{avg}}$ 至多只会改变数值耗散的大小，但不能改变迎风偏置，因为特征速度的符号是由在面上计算的 $u_n$ 的符号决定的，而与 $M$ 的计算方式无关。\n\nD. 在 $M_L  0$ 和 $M_R  0$ 的跨音速稀疏波中，平均马赫数 $M_{\\mathrm{avg}}$ 可能接近于 $0$，从而减少了预期的迎风扩散并将两个通量贡献都耦合到两个状态上；这可能产生一个非单调通量，并容许虚假的膨胀激波。\n\nE. 使用分离的 $M_L$ 和 $M_R$ 违反了欧拉方程跨面的守恒性，而使用 $M_{\\mathrm{avg}}$ 则恢复了守恒性。\n\n选择一个或多个正确的选项。",
            "solution": "问题陈述提出了一个关于可压缩欧拉方程的 Van Leer 通量矢量分裂格式性质的概念性问题，特别关注其标准格式与使用平均马赫数的变体格式在迎风性和单调性方面的差异。\n\n### 问题验证\n\n首先，必须验证问题陈述的科学合理性、自洽性和适定性。\n\n**步骤1：提取已知条件**\n\n-   **控制方程**：$d$ 维空间中的可压缩欧拉方程，$\\partial_t \\boldsymbol{U} + \\nabla \\cdot \\boldsymbol{F}(\\boldsymbol{U}) = \\boldsymbol{0}$。$\\boldsymbol{U}$ 是守恒状态，$\\boldsymbol{F}(\\boldsymbol{U})$ 是物理通量。\n-   **状态变量**：速度 $\\boldsymbol{u}$，声速 $a$。\n-   **面几何与流动**：$\\boldsymbol{n}$ 是面的单位法向量，$u_n = \\boldsymbol{u} \\cdot \\boldsymbol{n}$ 是面法向速度，$M = u_n / a$ 是面法向马赫数。\n-   **离散状态**：在一个面上，左状态是 $\\boldsymbol{U}_L$，右状态是 $\\boldsymbol{U}_R$。这给出了 $u_{n,L}$、$u_{n,R}$、$a_L$、$a_R$、$M_L = u_{n,L}/a_L$ 和 $M_R = u_{n,R}/a_R$。\n-   **标准 Van Leer 通量**：$\\widehat{\\boldsymbol{F}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R; \\boldsymbol{n}) = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$。\n-   **分裂通量的性质**：$\\boldsymbol{F}^+$ 用于右行场，$\\boldsymbol{F}^-$ 用于左行场。对于强右行流（$M \\gg 0$），$\\boldsymbol{F}^- \\to \\boldsymbol{0}$。对于强左行流（$M \\ll 0$），$\\boldsymbol{F}^+ \\to \\boldsymbol{0}$。在亚音速流中，两者通常都非零。\n-   **特征结构**：面法向通量雅可比矩阵具有实特征值 $\\lambda_k \\in \\{u_n - a, u_n, u_n + a\\}$。\n-   **变体格式**：一种提议的修改使用平均马赫数 $M_{\\mathrm{avg}} = \\frac{M_L + M_R}{2}$ 来定义通量：$\\widehat{\\boldsymbol{F}}_{\\mathrm{avg}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_{\\mathrm{avg}}) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_{\\mathrm{avg}})$。\n-   **单调性准则**：标量数值通量 $\\hat{f}(u_L, u_R)$ 如果对其左侧变量 ($u_L$) 非减，对其右侧变量 ($u_R$) 非增，则称其为单调的。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学依据充分**：该问题牢固地基于计算流体动力学（CFD）的标准理论，特别是有限体积法和著名的用于欧拉方程的 Van Leer 通量矢量分裂格式。所有概念（欧拉方程、通量分裂、特征值、马赫数、单调性）都是标准的并且描述正确。\n-   **适定的**：问题要求基于数值格式的基本原理进行定性分析和推理。问题是具体的，可以通过应用双曲守恒律的理论来回答。\n-   **客观的**：措辞技术性强且精确。没有主观或模糊的陈述。\n-   **清单审查**：问题陈述是完整的、一致的、科学合理的且适定的。它没有违反任何无效性标准。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。将继续进行求解过程。\n\n### 推导与分析\n\n该问题要求分析 Van Leer 通量矢量分裂的两个版本，重点是迎风性和单调性。对于标量两点通量 $\\hat{f}(u_L, u_R)$，单调性要求 $\\frac{\\partial \\hat{f}}{\\partial u_L} \\ge 0$ 和 $\\frac{\\partial \\hat{f}}{\\partial u_R} \\le 0$。对于方程组，该条件通常在逐特征的意义上解释，或通过通量关于左、右状态的雅可比矩阵的特征值来解释。\n\n**标准格式分析：$\\widehat{\\boldsymbol{F}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$**\n\n1.  **迎风性**：迎风思想的核心是信息沿着特征线传播。对于右行波（正特征值 $\\lambda_k  0$），数值格式应从“迎风”方向，即左状态 $\\boldsymbol{U}_L$ 获取信息。对于左行波（负特征值 $\\lambda_k  0$），它应从右状态 $\\boldsymbol{U}_R$ 获取信息。Van Leer 分裂正是为了体现这一原则而构造的。通量被分裂为 $\\boldsymbol{F} = \\boldsymbol{F}^+ + \\boldsymbol{F}^-$，其中 $\\boldsymbol{F}^+$ 的通量雅可比矩阵（$A^+ = d\\boldsymbol{F}^+/d\\boldsymbol{U}$）具有非负特征值，而 $\\boldsymbol{F}^-$ 的通量雅可比矩阵（$A^- = d\\boldsymbol{F}^-/d\\boldsymbol{U}$）具有非正特征值。\n    在标准数值通量 $\\widehat{\\boldsymbol{F}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R)$ 中，右行通量贡献 $\\boldsymbol{F}^+$ *仅* 依赖于左状态 $\\boldsymbol{U}_L$（及其派生量 $M_L$）。左行通量贡献 $\\boldsymbol{F}^-$ *仅* 依赖于右状态 $\\boldsymbol{U}_R$（及其派生量 $M_R$）。这种严格的分离确保了正确的迎风方向性。右行波的信息仅来自左侧，左行波的信息仅来自右侧。\n\n2.  **单调性**：为检验单调性条件，我们计算数值通量关于 $\\boldsymbol{U}_L$ 和 $\\boldsymbol{U}_R$ 的雅可比矩阵：\n    $$ \\frac{\\partial \\widehat{\\boldsymbol{F}}}{\\partial \\boldsymbol{U}_L} = \\frac{\\partial}{\\partial \\boldsymbol{U}_L} \\left( \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_L) \\right) = \\boldsymbol{A}^+(\\boldsymbol{U}_L; M_L) $$\n    $$ \\frac{\\partial \\widehat{\\boldsymbol{F}}}{\\partial \\boldsymbol{U}_R} = \\frac{\\partial}{\\partial \\boldsymbol{U}_R} \\left( \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_R) \\right) = \\boldsymbol{A}^-(\\boldsymbol{U}_R; M_R) $$\n    根据通量矢量分裂的构造，矩阵 $\\boldsymbol{A}^+(\\boldsymbol{U})$ 具有非负特征值，矩阵 $\\boldsymbol{A}^-(\\boldsymbol{U})$ 具有非正特征值。这是标量单调性条件的系统层面等价物。因此，标准 Van Leer 格式在这个意义上是单调的。\n\n**变体格式分析：$\\widehat{\\boldsymbol{F}}_{\\mathrm{avg}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_{\\mathrm{avg}}) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_{\\mathrm{avg}})$**\n\n1.  **迎风性与单调性失效**：在此变体中，分裂通量 $\\boldsymbol{F}^+$ 和 $\\boldsymbol{F}^-$ 都通过平均马赫数 $M_{\\mathrm{avg}} = \\frac{1}{2}(M_L + M_R)$ 依赖于左、右两个状态 $\\boldsymbol{U}_L$ 和 $\\boldsymbol{U}_R$。这引入了破坏迎风结构的交叉依赖性。\n    让我们考察关于 $\\boldsymbol{U}_R$ 的雅可比矩阵：\n    $$ \\frac{\\partial \\widehat{\\boldsymbol{F}}_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R} = \\frac{\\partial}{\\partial \\boldsymbol{U}_R} \\left( \\boldsymbol{F}^+(\\boldsymbol{U}_L; M_{\\mathrm{avg}}) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M_{\\mathrm{avg}}) \\right) $$\n    使用链式法则：\n    $$ \\frac{\\partial \\widehat{\\boldsymbol{F}}_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R} = \\underbrace{\\frac{\\partial \\boldsymbol{F}^+}{\\partial M_{\\mathrm{avg}}} \\frac{\\partial M_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R}}_{\\text{错误的耦合}} + \\underbrace{\\frac{\\partial \\boldsymbol{F}^-}{\\partial \\boldsymbol{U}_R}}_{\\text{正确的部分}} + \\underbrace{\\frac{\\partial \\boldsymbol{F}^-}{\\partial M_{\\mathrm{avg}}} \\frac{\\partial M_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R}}_{\\text{修改部分}} $$\n    项 $\\frac{\\partial \\boldsymbol{F}^-}{\\partial \\boldsymbol{U}_R}$ 具有非正特征值，符合预期。然而，新项 $\\frac{\\partial \\boldsymbol{F}^+}{\\partial M_{\\mathrm{avg}}} \\frac{\\partial M_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R}$ 是有问题的。通量 $\\boldsymbol{F}^+$ 随 $M$ 增加，因此矩阵 $\\frac{\\partial \\boldsymbol{F}^+}{\\partial M_{\\mathrm{avg}}}$ 通常具有正特征值。在某些流动条件下，该乘积可能具有正特征值，并超过来自正确项的负特征值，导致完整的雅可比矩阵 $\\frac{\\partial \\widehat{\\boldsymbol{F}}_{\\mathrm{avg}}}{\\partial \\boldsymbol{U}_R}$ 具有正特征值。这违反了单调性条件 $\\frac{\\partial \\hat{f}}{\\partial u_R} \\le 0$。\n\n2.  **具体失效情景**：考虑一个跨音速稀疏波，其中流动膨胀穿过声速。例如，$M_L = 0.2$ 和 $M_R = -0.2$。\n    -   在这种情况下，$M_{\\mathrm{avg}} = \\frac{0.2 + (-0.2)}{2} = 0$。\n    -   变体通量为 $\\widehat{\\boldsymbol{F}}_{\\mathrm{avg}} = \\boldsymbol{F}^+(\\boldsymbol{U}_L; M=0) + \\boldsymbol{F}^-(\\boldsymbol{U}_R; M=0)$。\n    -   Van Leer 分裂被构造成从超音速流的完全迎风平滑过渡到亚音速流的混合贡献通量。分裂函数是 $M$ 的多项式。例如，对声波 ($u_n \\pm a$) 的贡献由诸如 $\\frac{a}{4}(M \\pm 1)^2$ 的因子加权。在 $M=0$ 时，这些权重相等，表示迎风和顺风信息的均等混合。这种行为是中心差分格式的特征，该格式缺乏处理激波和接触间断所需的数值耗散。\n    -   标准格式会使用 $M_L=0.2$ 和 $M_R=-0.2$，根据每一侧的局部流动提供正确的迎风偏置，从而引入必要的数值耗散。而使用 $M_{\\mathrm{avg}}=0$ 的变体格式失去了这种关键的迎风偏置。缺乏足够数值耗散的格式不是单调的，并且可能容许非物理的解，例如膨胀激波，即稀疏波错误地锐化为间断。\n\n### 逐项评估\n\n**A. 在 Van Leer 通量矢量分裂中使用分离的面法向马赫数 $M_L$ 和 $M_R$，可以得到一个数值通量，其关于 $\\boldsymbol{U}_L$ 的雅可比矩阵在右行特征场上是半正定的，其关于 $\\boldsymbol{U}_R$ 的雅可比矩阵在左行特征场上是半负定的，从而保持了迎风方向性，并在投影到特征变量上时满足离散单调性条件。**\n此陈述是对标准 Van Leer 分裂性质的正确描述。如上推导，$\\partial \\widehat{\\boldsymbol{F}} / \\partial \\boldsymbol{U}_L = \\boldsymbol{A}^+(\\boldsymbol{U}_L)$ 具有非负特征值，而 $\\partial \\widehat{\\boldsymbol{F}} / \\partial \\boldsymbol{U}_R = \\boldsymbol{A}^-(\\boldsymbol{U}_R)$ 具有非正特征值。“半正定/半负定”是描述此性质的恰当矩阵术语，它确保了单调性。\n**结论：正确。**\n\n**B. 在面上平均马赫数 $M_{\\mathrm{avg}} = \\tfrac{M_L + M_R}{2}$ 会违反标量单调性条件，因为 $\\boldsymbol{F}^+$ 和 $\\boldsymbol{F}^-$ 对 $M_{\\mathrm{avg}}$ 的依赖性引入了对 $\\boldsymbol{U}_L$ 和 $\\boldsymbol{U}_R$ 两者的交叉依赖；在跨音速状态附近，这可能改变通量关于 $\\boldsymbol{U}_R$ 或 $\\boldsymbol{U}_L$ 的偏导数的符号。**\n此陈述正确地指出了失效机制。由 $M_{\\mathrm{avg}}$ 引入的交叉依赖性意味着 $\\boldsymbol{F}^+$ 依赖于 $\\boldsymbol{U}_R$，$\\boldsymbol{F}^-$ 依赖于 $\\boldsymbol{U}_L$。如分析所示，这可能导致雅可比矩阵违反单调性所需的符号条件。\n**结论：正确。**\n\n**C. 使用平均马赫数 $M_{\\mathrm{avg}}$ 至多只会改变数值耗散的大小，但不能改变迎风偏置，因为特征速度的符号是由在面上计算的 $u_n$ 的符号决定的，而与 $M$ 的计算方式无关。**\n此陈述不正确。Van Leer 格式中的迎风偏置不只是二元的；它由依赖于马赫数 $M$ 的加权函数决定。在跨音速稀疏波情况下 ($M_{avg} \\approx 0$)，迎风偏置被有效消除，格式退化为对声波的中心型差分，这从根本上改变了其特性，而不仅仅是耗散的大小。\n**结论：不正确。**\n\n**D. 在 $M_L  0$ 和 $M_R  0$ 的跨音速稀疏波中，平均马赫数 $M_{\\mathrm{avg}}$ 可能接近于 $0$，从而减少了预期的迎风扩散并将两个通量贡献都耦合到两个状态上；这可能产生一个非单调通量，并容许虚假的膨胀激波。**\n此陈述为变体格式的失效提供了一个准确而具体的例子。对跨音速稀疏波情景的分析证实了此陈述的每一部分：$M_{\\mathrm{avg}} \\approx 0$ 确实减少了迎风扩散（数值耗散），确实错误地耦合了通量，并且由此产生的非单调行为已知会容许膨胀激波。\n**结论：正确。**\n\n**E. 使用分离的 $M_L$ 和 $M_R$ 违反了欧拉方程跨面的守恒性，而使用 $M_{\\mathrm{avg}}$ 则恢复了守恒性。**\n此陈述不正确。在有限体积法中，只要界面上的数值通量 $\\widehat{\\boldsymbol{F}}_{i+1/2}$ 是其左侧 ($\\boldsymbol{U}_i$) 和右侧 ($\\boldsymbol{U}_{i+1}$) 状态的唯一函数，并且离开单元 $i$ 的通量与进入单元 $i+1$ 的通量相同，守恒性就得到保证。标准格式 ($\\widehat{\\boldsymbol{F}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$) 和变体格式 ($\\widehat{\\boldsymbol{F}}_{\\mathrm{avg}}(\\boldsymbol{U}_L, \\boldsymbol{U}_R)$) 都定义了这样一个唯一的两点通量函数。因此，两种格式都是完全守恒的。计算马赫数的方法不影响格式的守恒性质。\n**结论：不正确。**",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}