{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在建立欧拉和拉格朗日描述之间的基本数学联系。我们将从一个给定的线性欧拉速度场出发，通过求解常微分方程来推导拉格朗日流图的精确解析表达式。这个过程不仅展示了两种描述之间的转换方法，也引入了矩阵指数这一强大的数学工具，它在线性系统理论中至关重要。",
            "id": "3338625",
            "problem": "考虑在 $\\mathbb{R}^{n}$ 中的一个连续流体微团，它们在时间 $t=0$ 时的初始位置由 $\\boldsymbol{X} \\in \\mathbb{R}^{n}$ 标记。欧拉速度场由 $\\boldsymbol{v}(\\boldsymbol{x},t)=\\boldsymbol{A}\\boldsymbol{x}$ 给出，其中 $\\boldsymbol{A} \\in \\mathbb{R}^{n \\times n}$ 是一个与 $\\boldsymbol{x}$ 和 $t$ 无关的常数矩阵。拉格朗日流映射 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ 定义为初始位于 $\\boldsymbol{X}$ 的微团在时间 $t$ 时的位置，并且根据定义，它满足以下初值问题\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\boldsymbol{v}\\big(\\boldsymbol{\\chi}(\\boldsymbol{X},t),t\\big), \\qquad \\boldsymbol{\\chi}(\\boldsymbol{X},0)=\\boldsymbol{X}.\n$$\n从流映射的基本定义和给定的欧拉场出发，推导出一个用 $\\boldsymbol{A}$、$\\boldsymbol{X}$ 和 $t$ 表示的 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ 的闭式解析表达式。你的最终答案必须是一个单一的闭式表达式。不需要进行数值计算，最终答案中也不需要报告单位。",
            "solution": "该问题被认为是有效的，因为它以连续介质力学原理为科学基础，数学上是适定的，并且陈述客观。它提出了一个标准的初值问题，用于从给定的速度场（欧拉描述）确定粒子轨迹（拉格朗日流映射）。所有必要的数据和定义都已提供，没有内部矛盾或歧义。\n\n此推导的起点是拉格朗日流映射 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ 的定义，它描述了在时间 $t=0$ 时位于位置 $\\boldsymbol{X}$ 的流体微团在时间 $t$ 时的位置。该位置的演化由一个常微分方程（ODE）控制，该方程将粒子的速度与在粒子当前位置评估的欧拉速度场联系起来。具体如下：\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\boldsymbol{v}\\big(\\boldsymbol{\\chi}(\\boldsymbol{X},t),t\\big)\n$$\n问题指定欧拉速度场为 $\\boldsymbol{v}(\\boldsymbol{x},t) = \\boldsymbol{A}\\boldsymbol{x}$，其中 $\\boldsymbol{A}$ 是一个常数 $n \\times n$ 矩阵。将粒子的位置 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ 代入通用位置变量 $\\boldsymbol{x}$，我们得到该流动的常微分方程的具体形式：\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\boldsymbol{A}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t)\n$$\n这是一个具有常系数的 $n$ 维线性、一阶、齐次常微分方程组。待求解的变量是向量 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$，其中 $\\boldsymbol{X}$ 被视为标记特定流体微团的参数。指定微团在 $t=0$ 时的起始位置的初始条件如下：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\boldsymbol{X}\n$$\n形如 $\\frac{d\\boldsymbol{y}}{dt} = \\boldsymbol{A}\\boldsymbol{y}$ 的常微分方程组的通解由 $\\boldsymbol{y}(t) = \\exp(\\boldsymbol{A}t)\\boldsymbol{C}$ 给出，其中 $\\boldsymbol{C}$ 是一个常数积分向量，而 $\\exp(\\boldsymbol{A}t)$ 是矩阵指数。矩阵指数由其泰勒级数展开定义：\n$$\n\\exp(\\boldsymbol{A}t) = \\sum_{k=0}^{\\infty} \\frac{(\\boldsymbol{A}t)^k}{k!} = \\boldsymbol{I} + \\boldsymbol{A}t + \\frac{1}{2!}(\\boldsymbol{A}t)^2 + \\frac{1}{3!}(\\boldsymbol{A}t)^3 + \\dots\n$$\n其中 $\\boldsymbol{I}$ 是 $n \\times n$ 单位矩阵。\n\n将此通解形式应用于我们的问题，流映射的解为：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\exp(\\boldsymbol{A}t)\\boldsymbol{C}\n$$\n常数向量 $\\boldsymbol{C}$ 通过应用初始条件来确定。在 $t=0$ 时，我们有：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\exp(\\boldsymbol{A}\\cdot 0)\\boldsymbol{C} = \\exp(\\boldsymbol{0})\\boldsymbol{C}\n$$\n零矩阵的指数是单位矩阵，$\\exp(\\boldsymbol{0}) = \\boldsymbol{I}$。因此：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\boldsymbol{I}\\boldsymbol{C} = \\boldsymbol{C}\n$$\n从给定的初始条件，我们知道 $\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\boldsymbol{X}$。将这两个表示初始状态的表达式相等，得到：\n$$\n\\boldsymbol{C} = \\boldsymbol{X}\n$$\n因此，积分常数向量就是流体微团的初始位置向量。\n\n将此结果代回通解，得到拉格朗日流映射的最终闭式解析表达式：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\exp(\\boldsymbol{A}t)\\boldsymbol{X}\n$$\n该表达式给出了在指定的线性欧拉速度场影响下，任何由其初始位置 $\\boldsymbol{X}$ 唯一标识的流体微团在时间 $t$ 的位置。",
            "answer": "$$\\boxed{\\exp(\\boldsymbol{A}t)\\boldsymbol{X}}$$"
        },
        {
            "introduction": "在前一个练习的基础上，本实践将抽象的理论应用于一个直观的物理场景：二维刚体旋转流。通过求解一个具体速度场下的粒子轨迹，我们将看到数学解如何描绘出我们所熟悉的圆形轨道。此练习旨在加深对拉格朗日路径物理意义的理解，并演示如何从流场参数（如角速度 $\\omega$）中确定轨迹的关键特性（如周期）。",
            "id": "3338684",
            "problem": "考虑一个二维不可压缩刚体旋转流场，其在欧拉描述下的速度场由 $\\boldsymbol{v}(x,y) = \\omega(-y, x)$ 给出，其中 $\\omega$ 是一个恒定的角速度。设拉格朗日粒子轨迹 $\\boldsymbol{x}(t) = (x(t), y(t))$ 定义为运动学关系 $\\mathrm{d}\\boldsymbol{x}/\\mathrm{d}t = \\boldsymbol{v}(\\boldsymbol{x})$ 在初始条件 $\\boldsymbol{x}(0) = (x_{0}, y_{0})$（其中 $(x_{0}, y_{0}) \\neq (0,0)$）下的解。仅从连接欧拉速度场和拉格朗日轨迹的基本运动学关系以及线性常微分方程的标准性质出发，推导精确的拉格朗日轨迹，并用它来确定最小正旋转周期 $T(\\omega)$，使得对于所有 $t$ 都有 $\\boldsymbol{x}(t + T) = \\boldsymbol{x}(t)$。\n\n你最终报告的答案必须是 $T(\\omega)$ 的单一闭式解析表达式，单位为秒。角速度 $\\omega$ 的单位是弧度/秒。最终答案中不要报告轨迹；它只应出现在你的推导过程中。不需要进行数值近似。",
            "solution": "题目给出了一个二维刚体旋转流的欧拉速度场，$\\boldsymbol{v}(x,y) = \\omega(-y, x)$，其中 $\\omega$ 是一个恒定的角速度。拉格朗日粒子轨迹，记为 $\\boldsymbol{x}(t) = (x(t), y(t))$，由以下基本运动学关系确定：\n$$\n\\frac{\\mathrm{d}\\boldsymbol{x}}{\\mathrm{d}t} = \\boldsymbol{v}(\\boldsymbol{x})\n$$\n该矢量方程满足初始条件 $\\boldsymbol{x}(0) = (x_0, y_0)$，其中 $(x_0, y_0) \\neq (0,0)$。\n\n将该矢量方程分解为其分量，得到一个由两个耦合的一阶线性常微分方程（ODE）组成的系统：\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} = -\\omega y \\quad (1)\n$$\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} = \\omega x \\quad (2)\n$$\n为求解此系统，我们将方程 $(1)$ 对时间 $t$ 求导：\n$$\n\\frac{\\mathrm{d}^2 x}{\\mathrm{d}t^2} = -\\omega \\frac{\\mathrm{d}y}{\\mathrm{d}t}\n$$\n将方程 $(2)$ 代入这个新方程的右侧，可以消去变量 $y$：\n$$\n\\frac{\\mathrm{d}^2 x}{\\mathrm{d}t^2} = -\\omega (\\omega x) = -\\omega^2 x\n$$\n这得到了一个关于 $x(t)$ 的二阶线性齐次常微分方程：\n$$\n\\frac{\\mathrm{d}^2 x}{\\mathrm{d}t^2} + \\omega^2 x = 0\n$$\n这是简谐振子的标准方程。其通解由下式给出：\n$$\nx(t) = A \\cos(\\omega t) + B \\sin(\\omega t)\n$$\n其中 $A$ 和 $B$ 是由初始条件决定的积分常数。\n\n首先，我们应用位置的初始条件 $x(0) = x_0$：\n$$\nx(0) = A \\cos(0) + B \\sin(0) = A \\cdot 1 + B \\cdot 0 = A\n$$\n因此，我们发现常数 $A$ 等于初始位置 $x_0$。$x(t)$ 的表达式变为：\n$$\nx(t) = x_0 \\cos(\\omega t) + B \\sin(\\omega t)\n$$\n为了找到 $y(t)$ 的表达式，我们可以使用方程 $(1)$，它表明 $y = -\\frac{1}{\\omega} \\frac{\\mathrm{d}x}{\\mathrm{d}t}$。这在 $\\omega \\neq 0$ 时有效。$\\omega=0$ 的情况对应于静止流体（$\\boldsymbol{v}=\\boldsymbol{0}$），此时周期的概念没有意义。我们首先计算 $x(t)$ 的导数：\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} = -x_0 \\omega \\sin(\\omega t) + B \\omega \\cos(\\omega t)\n$$\n将此代入 $y(t)$ 的表达式中：\n$$\ny(t) = -\\frac{1}{\\omega} \\left(-x_0 \\omega \\sin(\\omega t) + B \\omega \\cos(\\omega t)\\right) = x_0 \\sin(\\omega t) - B \\cos(\\omega t)\n$$\n接下来，我们应用初始条件 $y(0) = y_0$：\n$$\ny(0) = x_0 \\sin(0) - B \\cos(0) = x_0 \\cdot 0 - B \\cdot 1 = -B\n$$\n这得到 $-B = y_0$，即 $B = -y_0$。\n\n将常数 $A = x_0$ 和 $B = -y_0$ 的值代入 $x(t)$ 和 $y(t)$ 的表达式中，我们得到完整的拉格朗日轨迹：\n$$\nx(t) = x_0 \\cos(\\omega t) - y_0 \\sin(\\omega t)\n$$\n$$\ny(t) = x_0 \\sin(\\omega t) + y_0 \\cos(\\omega t)\n$$\n题目要求我们找到最小的正旋转周期 $T$。根据定义，周期 $T$ 必须对所有时间 $t$ 满足条件 $\\boldsymbol{x}(t + T) = \\boldsymbol{x}(t)$。这意味着位置矢量的每个分量都必须是周期为 $T$ 的周期函数：\n$$\nx(t+T) = x(t) \\quad \\text{和} \\quad y(t+T) = y(t)\n$$\n我们来分析 $x(t)$ 的条件：\n$$\nx_0 \\cos(\\omega(t+T)) - y_0 \\sin(\\omega(t+T)) = x_0 \\cos(\\omega t) - y_0 \\sin(\\omega t)\n$$\n使用三角和角恒等式 $\\cos(\\alpha+\\beta) = \\cos(\\alpha)\\cos(\\beta) - \\sin(\\alpha)\\sin(\\beta)$ 和 $\\sin(\\alpha+\\beta) = \\sin(\\alpha)\\cos(\\beta) + \\cos(\\alpha)\\sin(\\beta)$，我们展开方程的左边：\n$$\nx_0[\\cos(\\omega t)\\cos(\\omega T) - \\sin(\\omega t)\\sin(\\omega T)] - y_0[\\sin(\\omega t)\\cos(\\omega T) + \\cos(\\omega t)\\sin(\\omega T)] = x_0 \\cos(\\omega t) - y_0 \\sin(\\omega t)\n$$\n我们收集乘以 $\\cos(\\omega t)$ 和 $\\sin(\\omega t)$ 的项：\n$$\n\\cos(\\omega t)[x_0 \\cos(\\omega T) - y_0 \\sin(\\omega T)] - \\sin(\\omega t)[x_0 \\sin(\\omega T) + y_0 \\cos(\\omega T)] = \\cos(\\omega t)x_0 - \\sin(\\omega t)y_0\n$$\n这个等式必须对所有 $t$ 值成立。由于函数 $\\cos(\\omega t)$ 和 $\\sin(\\omega t)$ 是线性无关的，它们在方程两边的各自系数必须相等。这产生了一个关于量 $\\cos(\\omega T)$ 和 $\\sin(\\omega T)$ 的两个线性方程组：\n$$\nx_0 \\cos(\\omega T) - y_0 \\sin(\\omega T) = x_0 \\quad (3)\n$$\n$$\nx_0 \\sin(\\omega T) + y_0 \\cos(\\omega T) = y_0 \\quad (4)\n$$\n由于初始条件指定为 $(x_0, y_0) \\neq (0,0)$，该方程组有唯一解。通过观察可以看出，解是：\n$$\n\\cos(\\omega T) = 1\n$$\n$$\n\\sin(\\omega T) = 0\n$$\n将这个提议的解代回方程 $(3)$ 和 $(4)$ 验证其正确性：$x_0(1) - y_0(0) = x_0$ 和 $x_0(0) + y_0(1) = y_0$。条件得到满足。分析 $y(t)$ 的周期性会得到一个相同的方程组。\n\n$\\cos(\\omega T) = 1$ 和 $\\sin(\\omega T) = 0$ 这两个同时成立的条件意味着角 $\\omega T$ 必须是 $2\\pi$ 的整数倍：\n$$\n\\omega T = 2\\pi k, \\quad \\text{for } k \\in \\mathbb{Z}\n$$\n根据定义，周期 $T$ 是一个正量（$T > 0$）。因此，$k$ 必须是一个非零整数。求解 $T$ 得：\n$$\nT = \\frac{2\\pi k}{\\omega}\n$$\n为了找到最小正周期，我们必须选择能使 $T$ 得到最小正值的整数 $k$。\n- 如果 $\\omega > 0$，我们必须选择最小的正整数 $k=1$。这得到 $T = \\frac{2\\pi}{\\omega}$。\n- 如果 $\\omega  0$，我们必须选择绝对值最小的负整数 $k=-1$，以确保 $T$ 为正。这得到 $T = \\frac{2\\pi(-1)}{\\omega} = -\\frac{2\\pi}{\\omega}$。\n这两种情况可以用一个包含绝对值的表达式来概括：\n$$\nT(\\omega) = \\frac{2\\pi}{|\\omega|}\n$$\n$\\omega$ 的单位是弧度/秒 $(\\text{rad} \\cdot \\text{s}^{-1})$，$2\\pi$ 是以弧度为单位的角度。因此，$T$ 的单位是秒，这符合对周期的预期。",
            "answer": "$$\\boxed{\\frac{2\\pi}{|\\omega|}}$$"
        },
        {
            "introduction": "在真实世界的流体动力学问题中，速度场通常非常复杂，无法获得解析解，因此必须依赖数值方法。本计算实践将理论知识转化为代码，要求您通过数值积分来重构粒子轨迹和变形梯度。此练习的核心是直接验证一个基本原理——不可压缩流中的体积守恒（在二维中即面积守恒，对应于雅可比行列式 $J=1$），并比较不同数值积分方案（如欧拉法和龙格-库塔法）的精度差异，从而体验理论概念在计算流体动力学（CFD）中的实际应用。",
            "id": "3338691",
            "problem": "某开发人员获得一个从直接数值模拟（DNS）数据中得到的欧拉速度场 $\\mathbf{u}(\\mathbf{x},t)$。其目标是重构拉格朗日流图 $\\boldsymbol{\\chi}(\\mathbf{X},t)$，并通过形变梯度的雅可比行列式来量化体积（二维情况下为面积）的变化。请在二维空间中进行操作。设 $\\mathbf{x}(t;\\mathbf{X})$ 表示从 $t=0$ 时刻的物质坐标 $\\mathbf{X}$ 出发的轨迹，定义形变梯度 $\\mathbf{F}(\\mathbf{X},t)=\\partial \\mathbf{x} / \\partial \\mathbf{X}$ 及其行列式 $J(\\mathbf{X},t)=\\det \\mathbf{F}(\\mathbf{X},t)$。基本关系是运动学常微分方程 $d\\mathbf{x}/dt=\\mathbf{u}(\\mathbf{x},t)$（其中 $\\mathbf{x}(0;\\mathbf{X})=\\mathbf{X}$）和变分方程 $d\\mathbf{F}/dt=\\nabla \\mathbf{u}(\\mathbf{x}(t),t)\\,\\mathbf{F}$（其中 $\\mathbf{F}(\\mathbf{X},0)=\\mathbf{I}$），此处 $\\nabla \\mathbf{u}$ 是速度梯度，$\\mathbf{I}$ 是单位矩阵。\n\n实现一个程序，该程序：\n- 通过对 $d\\mathbf{x}/dt=\\mathbf{u}(\\mathbf{x},t)$ 从 $t=0$ 积分到 $t=t_{\\text{final}}$ 来隐式地重构 $\\boldsymbol{\\chi}(\\mathbf{X},t)$，并同时对 $d\\mathbf{F}/dt=\\nabla \\mathbf{u}\\,\\mathbf{F}$（其中 $\\mathbf{F}(\\mathbf{X},0)=\\mathbf{I}$）进行积分。\n- 对一组初始位置 $\\{\\mathbf{X}_i\\}$，计算 $J(\\mathbf{X},t_{\\text{final}})=\\det \\mathbf{F}(\\mathbf{X},t_{\\text{final}})$。\n- 针对不可压缩情况与可压缩情况，测试体积（面积）守恒性，并将观察到的误差与时间积分方案的选择联系起来。\n\n使用两个特定的、科学上一致的场：\n1) 不可压缩场（无散度），由边长为 $L$ 的周期性正方形域上的流函数 $\\psi(\\mathbf{x},t)$ 定义。设 $L=1\\,\\text{m}$，$T=1\\,\\text{s}$，且 $\\psi(x,y,t)=A \\sin\\left(2\\pi x/L\\right)\\sin\\left(2\\pi y/L\\right)\\cos\\left(2\\pi t/T\\right)$，其中 $A=0.1\\,\\text{m}^2/\\text{s}$。速度为 $\\mathbf{u}=(\\partial \\psi/\\partial y,\\,-\\partial \\psi/\\partial x)$，其梯度 $\\nabla \\mathbf{u}$ 必须通过解析方法得到。空间上的周期性边界条件必须通过将位置对 $L$ 取模来强制执行。在这种情况下，不可压缩性意味着体积守恒，因此预期的 $J$ 值为 $1$。\n2) 可压缩均匀各向同性膨胀/收缩，其中 $\\mathbf{u}(\\mathbf{x},t)=c\\,\\mathbf{x}$，$c$ 是单位为 $\\text{s}^{-1}$ 的常数。在二维中，$\\nabla \\mathbf{u}=c\\,\\mathbf{I}$，形变梯度的精确解为 $\\mathbf{F}(t)=\\exp(c t)\\,\\mathbf{I}$，这意味着 $J(t)=\\exp(2 c t)$。在主要的可压缩测试中使用 $c=0.2\\,\\text{s}^{-1}$，并使用 $c=0\\,\\text{s}^{-1}$ 作为边界情况。\n\n使用两种时间积分方案积分耦合系统 $(\\mathbf{x},\\mathbf{F})$：显式前向欧拉法和经典四阶龙格-库塔法。对于每个测试，计算初始位置集合中 $J$ 相对于期望值（不可压缩情况下为 $1$，可压缩情况下为 $\\exp(2 c t_{\\text{final}})$）的最大绝对误差。所有计算出的误差必须报告为无量纲浮点数。\n\n使用以下测试套件，初始位置以米为单位：\n- 初始位置 $\\{\\mathbf{X}_i\\}$: $\\{(0.1,0.1),(0.9,0.1),(0.1,0.9),(0.9,0.9),(0.5,0.5)\\}\\,\\text{m}$。\n- 最终时间 $t_{\\text{final}}=1\\,\\text{s}$。\n\n测试用例（每个测试用例在内部是一次程序运行，所有结果汇总到单个输出中）：\n- 用例 1：不可压缩场，显式欧拉法，时间步长 $\\Delta t=0.05\\,\\text{s}$。\n- 用例 2：不可压缩场，经典四阶龙格-库塔法，时间步长 $\\Delta t=0.005\\,\\text{s}$。\n- 用例 3：可压缩场，$c=0.2\\,\\text{s}^{-1}$，显式欧拉法，时间步长 $\\Delta t=0.05\\,\\text{s}$。\n- 用例 4：可压缩场，$c=0.2\\,\\text{s}^{-1}$，经典四阶龙格-库塔法，时间步长 $\\Delta t=0.005\\,\\text{s}$。\n- 用例 5：可压缩边界情况，$c=0\\,\\text{s}^{-1}$，显式欧拉法，时间步长 $\\Delta t=0.05\\,\\text{s}$。\n\n三角函数中的角度参数必须以弧度处理。输入参数的物理单位是米（$\\text{m}$）和秒（$\\text{s}$）；雅可比行列式是无量纲的。将最终误差表示为无量纲浮点数。\n\n你的程序应该生成单行输出，其中包含一个方括号括起来的结果逗号分隔列表，顺序为 $\\left[\\text{用例 }1,\\text{用例 }2,\\text{用例 }3,\\text{用例 }4,\\text{用例 }5\\right]$。例如，输出必须是 $\\left[\\text{float}_1,\\text{float}_2,\\text{float}_3,\\text{float}_4,\\text{float}_5\\right]$ 的形式。",
            "solution": "在流体动力学中，欧拉描述和拉格朗日描述之间的区别是基础性的。欧拉描述指定了在固定空间位置上的速度场 $\\mathbf{u}(\\mathbf{x},t)$，而拉格朗日描述则跟随物质点，并构建将初始物质位置 $\\mathbf{X}$ 映至其当前位置 $\\mathbf{x}(t;\\mathbf{X})$ 的流图 $\\boldsymbol{\\chi}(\\mathbf{X},t)$。\n\n从基本运动学定律出发，物质轨迹满足 $d\\mathbf{x}/dt=\\mathbf{u}(\\mathbf{x},t)$，其中 $\\mathbf{x}(0;\\mathbf{X})=\\mathbf{X}$。形变梯度 $\\mathbf{F}(\\mathbf{X},t)=\\partial \\mathbf{x}/\\partial \\mathbf{X}$ 根据变分方程 $d\\mathbf{F}/dt=\\nabla \\mathbf{u}(\\mathbf{x}(t),t)\\,\\mathbf{F}$ 演化，其中 $\\mathbf{F}(\\mathbf{X},0)=\\mathbf{I}$。该方程是通过对运动学关系关于 $\\mathbf{X}$ 求导并应用链式法则得出的：$\\partial_t(\\partial \\mathbf{x}/\\partial \\mathbf{X})=\\left(\\partial \\mathbf{u}/\\partial \\mathbf{x}\\right)\\left(\\partial \\mathbf{x}/\\partial \\mathbf{X}\\right)=\\nabla \\mathbf{u}\\,\\mathbf{F}$。\n\n雅可比行列式 $J(\\mathbf{X},t)=\\det \\mathbf{F}(\\mathbf{X},t)$ 表示从参考构型到当前构型的局部体积变化。其演化可使用 Jacobi 行列式公式推导：对于一个可逆矩阵 $\\mathbf{F}(t)$，$d(\\det \\mathbf{F})/dt=\\det \\mathbf{F}\\,\\mathrm{tr}\\left(\\mathbf{F}^{-1}\\frac{d\\mathbf{F}}{dt}\\right)$。代入 $\\frac{d\\mathbf{F}}{dt}=\\nabla \\mathbf{u}\\,\\mathbf{F}$ 可得 $dJ/dt=J\\,\\mathrm{tr}(\\nabla \\mathbf{u})=J\\,\\nabla\\cdot \\mathbf{u}$。因此，\n- 如果流是不可压缩的，则 $\\nabla\\cdot \\mathbf{u}=0$，所以 $dJ/dt=0$ 且对所有时间 $J(t)=J(0)=1$；在连续介质模型中，体积（二维情况下为面积）是精确守恒的。\n- 如果流是可压缩的，且在二维中具有空间上均匀的 $\\nabla \\mathbf{u}=c\\,\\mathbf{I}$，则 $d\\mathbf{F}/dt=c\\,\\mathbf{F}$ 且 $\\mathbf{F}(t)=e^{ct}\\mathbf{I}$，从而得到 $J(t)=\\det \\mathbf{F}(t)=e^{ct}\\cdot e^{ct}=e^{2ct}$。此结果与 $dJ/dt=J\\,\\mathrm{tr}(\\nabla \\mathbf{u})=J\\cdot 2c$ 一致。\n\n算法设计遵循以下原则：\n1) 指定欧拉场。\n   - 不可压缩情况：定义流函数 $\\psi(x,y,t)=A \\sin(k x)\\sin(k y)\\cos(\\omega t)$，其中 $k=2\\pi/L$ 且 $\\omega=2\\pi/T$。速度为 $\\mathbf{u}=(\\partial \\psi/\\partial y,\\,-\\partial \\psi/\\partial x)$，其梯度 $\\nabla \\mathbf{u}$ 通过解析方法计算：\n   $$\n   u_x=A k \\cos(k y)\\sin(k x)\\cos(\\omega t),\\quad\n   u_y=-A k \\cos(k x)\\sin(k y)\\cos(\\omega t),\n   $$\n   $$\n   \\frac{\\partial u_x}{\\partial x}=A k^2 \\cos(k y)\\cos(k x)\\cos(\\omega t),\\quad\n   \\frac{\\partial u_x}{\\partial y}=-A k^2 \\sin(k y)\\sin(k x)\\cos(\\omega t),\n   $$\n   $$\n   \\frac{\\partial u_y}{\\partial x}=A k^2 \\sin(k x)\\sin(k y)\\cos(\\omega t),\\quad\n   \\frac{\\partial u_y}{\\partial y}=-A k^2 \\cos(k x)\\cos(k y)\\cos(\\omega t).\n   $$\n   散度 $\\nabla\\cdot\\mathbf{u}=\\partial u_x/\\partial x+\\partial u_y/\\partial y$ 恒等于 $0$，保证了不可压缩性。\n   - 可压缩情况：选择 $\\mathbf{u}(\\mathbf{x},t)=c\\,\\mathbf{x}$，其中 $c$ 为常数，使得 $\\nabla \\mathbf{u}=c\\,\\mathbf{I}$ 且 $J(t)=e^{2ct}$。\n\n2) 对每个初始位置 $\\mathbf{X}_i$，使用以下两种时间积分器之一，对耦合系统 $(\\mathbf{x},\\mathbf{F})$ 从 $t=0$ 积分到 $t=t_{\\text{final}}$：\n   - 显式欧拉法（一阶）：$\\mathbf{x}_{n+1}=\\mathbf{x}_n+\\Delta t\\,\\mathbf{u}(\\mathbf{x}_n,t_n)$ 和 $\\mathbf{F}_{n+1}=\\mathbf{F}_n+\\Delta t\\,\\nabla \\mathbf{u}(\\mathbf{x}_n,t_n)\\,\\mathbf{F}_n$。\n   - 经典四阶龙格-库塔法：对 $\\mathbf{x}$ 和 $\\mathbf{F}$ 一致地应用标准的四阶段格式：\n     $$\n     \\mathbf{k}_1=\\mathbf{u}(\\mathbf{x}_n,t_n),\\quad \\mathbf{K}_1=\\nabla \\mathbf{u}(\\mathbf{x}_n,t_n)\\,\\mathbf{F}_n,\n     $$\n     $$\n     \\mathbf{k}_2=\\mathbf{u}\\left(\\mathbf{x}_n+\\tfrac{\\Delta t}{2}\\mathbf{k}_1,t_n+\\tfrac{\\Delta t}{2}\\right),\\quad\n     \\mathbf{K}_2=\\nabla \\mathbf{u}\\left(\\mathbf{x}_n+\\tfrac{\\Delta t}{2}\\mathbf{k}_1,t_n+\\tfrac{\\Delta t}{2}\\right)\\left(\\mathbf{F}_n+\\tfrac{\\Delta t}{2}\\mathbf{K}_1\\right),\n     $$\n     $$\n     \\mathbf{k}_3=\\mathbf{u}\\left(\\mathbf{x}_n+\\tfrac{\\Delta t}{2}\\mathbf{k}_2,t_n+\\tfrac{\\Delta t}{2}\\right),\\quad\n     \\mathbf{K}_3=\\nabla \\mathbf{u}\\left(\\mathbf{x}_n+\\tfrac{\\Delta t}{2}\\mathbf{k}_2,t_n+\\tfrac{\\Delta t}{2}\\right)\\left(\\mathbf{F}_n+\\tfrac{\\Delta t}{2}\\mathbf{K}_2\\right),\n     $$\n     $$\n     \\mathbf{k}_4=\\mathbf{u}\\left(\\mathbf{x}_n+\\Delta t\\,\\mathbf{k}_3,t_n+\\Delta t\\right),\\quad\n     \\mathbf{K}_4=\\nabla \\mathbf{u}\\left(\\mathbf{x}_n+\\Delta t\\,\\mathbf{k}_3,t_n+\\Delta t\\right)\\left(\\mathbf{F}_n+\\Delta t\\,\\mathbf{K}_3\\right),\n     $$\n     $$\n     \\mathbf{x}_{n+1}=\\mathbf{x}_n+\\frac{\\Delta t}{6}\\left(\\mathbf{k}_1+2\\mathbf{k}_2+2\\mathbf{k}_3+\\mathbf{k}_4\\right),\\quad\n     \\mathbf{F}_{n+1}=\\mathbf{F}_n+\\frac{\\Delta t}{6}\\left(\\mathbf{K}_1+2\\mathbf{K}_2+2\\mathbf{K}_3+\\mathbf{K}_4\\right).\n     $$\n   对于不可压缩的周期场，在每个步骤后通过将位置对 $L$ 取模来施加空间周期性。\n\n3) 计算雅可比行列式 $J_i=\\det \\mathbf{F}(\\mathbf{X}_i,t_{\\text{final}})$ 和各测试用例的期望值：\n   - 不可压缩：期望 $J_{\\text{exp}}=1$。\n   - 可压缩（常数 $c$）：期望 $J_{\\text{exp}}=e^{2 c t_{\\text{final}}}$。\n   将每个用例的误差量化为 $\\max_i \\left|J_i-J_{\\text{exp}}\\right|$。\n\n4) 汇总指定测试套件的结果。显式欧拉法是一阶方法，预计会表现出更大的误差，尤其是在时间步长 $\\Delta t$ 较粗的情况下。经典四阶龙格-库塔法由于其更高的精度阶数，即使在中等步长下，也应产生显著更小的误差。在不可压缩的情况下，$J$ 对 $1$ 的任何偏离都纯粹源于数值积分误差和离散化，这为该方案对体积守恒的忠实度提供了一个直接的度量。在具有空间均匀 $\\nabla \\mathbf{u}$ 的可压缩情况下，精确的 $J$ 是已知的，从而能够直接与 $e^{2ct}$ 进行误差评估；边界情况 $c=0$ 简化为一个平凡的恒等流，此时 $J=1$。\n\n该程序实现了这些步骤，并输出一个单行，其中包含一个方括号括起来的、按指定顺序排列的五个无量纲浮点数的逗号分隔列表。",
            "answer": "```python\n# Python 3.12\n# Libraries: numpy 1.23.5, scipy 1.11.4 (not used)\nimport numpy as np\n\ndef velocity_incompressible(x, t, params):\n    # params: dict with A, L, T\n    A = params['A']\n    L = params['L']\n    T = params['T']\n    k = 2.0 * np.pi / L\n    omega = 2.0 * np.pi / T\n    # u = (dpsi/dy, -dpsi/dx)\n    u_x = A * k * np.cos(k * x[1]) * np.sin(k * x[0]) * np.cos(omega * t)\n    u_y = -A * k * np.cos(k * x[0]) * np.sin(k * x[1]) * np.cos(omega * t)\n    return np.array([u_x, u_y])\n\ndef grad_incompressible(x, t, params):\n    A = params['A']\n    L = params['L']\n    T = params['T']\n    k = 2.0 * np.pi / L\n    omega = 2.0 * np.pi / T\n    cos_omega_t = np.cos(omega * t)\n    kx = k * x[0]\n    ky = k * x[1]\n    dux_dx = A * (k**2) * np.cos(ky) * np.cos(kx) * cos_omega_t\n    dux_dy = -A * (k**2) * np.sin(ky) * np.sin(kx) * cos_omega_t\n    duy_dx = A * (k**2) * np.sin(kx) * np.sin(ky) * cos_omega_t\n    duy_dy = -A * (k**2) * np.cos(kx) * np.cos(ky) * cos_omega_t\n    return np.array([[dux_dx, dux_dy],\n                     [duy_dx, duy_dy]])\n\ndef velocity_compressible(x, t, params):\n    c = params['c']\n    return c * x\n\ndef grad_compressible(x, t, params):\n    c = params['c']\n    return c * np.eye(2)\n\ndef integrate_particle(X0, t_final, dt, method, field_type, params):\n    x = np.array(X0, dtype=float)\n    F = np.eye(2)\n    t = 0.0\n    steps = int(round(t_final / dt))\n    if field_type == 'incompressible':\n        L = params['L']\n        vel = lambda xx, tt: velocity_incompressible(xx, tt, params)\n        grd = lambda xx, tt: grad_incompressible(xx, tt, params)\n    elif field_type == 'compressible':\n        vel = lambda xx, tt: velocity_compressible(xx, tt, params)\n        grd = lambda xx, tt: grad_compressible(xx, tt, params)\n    else:\n        raise ValueError(\"Unknown field_type\")\n\n    for _ in range(steps):\n        if method == 'euler':\n            u = vel(x, t)\n            G = grd(x, t)\n            x_new = x + dt * u\n            F_new = F + dt * (G @ F)\n        elif method == 'rk4':\n            k1x = vel(x, t)\n            k1F = grd(x, t) @ F\n\n            x2 = x + 0.5 * dt * k1x\n            F2 = F + 0.5 * dt * k1F\n            k2x = vel(x2, t + 0.5 * dt)\n            k2F = grd(x2, t + 0.5 * dt) @ F2\n\n            x3 = x + 0.5 * dt * k2x\n            F3 = F + 0.5 * dt * k2F\n            k3x = vel(x3, t + 0.5 * dt)\n            k3F = grd(x3, t + 0.5 * dt) @ F3\n\n            x4 = x + dt * k3x\n            F4 = F + dt * k3F\n            k4x = vel(x4, t + dt)\n            k4F = grd(x4, t + dt) @ F4\n\n            x_new = x + (dt / 6.0) * (k1x + 2 * k2x + 2 * k3x + k4x)\n            F_new = F + (dt / 6.0) * (k1F + 2 * k2F + 2 * k3F + k4F)\n        else:\n            raise ValueError(\"Unknown method\")\n\n        x = x_new\n        F = F_new\n        t += dt\n\n        if field_type == 'incompressible':\n            # Enforce periodicity on [0, L)\n            x = np.mod(x, L)\n\n    J = float(np.linalg.det(F))\n    return J\n\ndef run_case(field_type, method, dt, t_final, params, initial_positions):\n    # Compute Js for all initial positions\n    Js = []\n    for X0 in initial_positions:\n        J = integrate_particle(X0, t_final, dt, method, field_type, params)\n        Js.append(J)\n    Js = np.array(Js)\n    # Expected J\n    if field_type == 'incompressible':\n        J_exp = 1.0\n    elif field_type == 'compressible':\n        c = params['c']\n        J_exp = float(np.exp(2.0 * c * t_final))\n    else:\n        raise ValueError(\"Unknown field_type\")\n    # Error metric: maximum absolute error across particles\n    err = float(np.max(np.abs(Js - J_exp)))\n    return err\n\ndef solve():\n    # Initial positions in meters\n    initial_positions = [\n        (0.1, 0.1),\n        (0.9, 0.1),\n        (0.1, 0.9),\n        (0.9, 0.9),\n        (0.5, 0.5),\n    ]\n    t_final = 1.0  # seconds\n\n    # Test cases specification\n    test_cases = [\n        # Case 1: Incompressible, Euler, dt=0.05 s\n        (\"incompressible\", \"euler\", 0.05, t_final, {\"A\": 0.1, \"L\": 1.0, \"T\": 1.0}),\n        # Case 2: Incompressible, RK4, dt=0.005 s\n        (\"incompressible\", \"rk4\", 0.005, t_final, {\"A\": 0.1, \"L\": 1.0, \"T\": 1.0}),\n        # Case 3: Compressible c=0.2 s^-1, Euler, dt=0.05 s\n        (\"compressible\", \"euler\", 0.05, t_final, {\"c\": 0.2}),\n        # Case 4: Compressible c=0.2 s^-1, RK4, dt=0.005 s\n        (\"compressible\", \"rk4\", 0.005, t_final, {\"c\": 0.2}),\n        # Case 5: Compressible boundary c=0.0 s^-1, Euler, dt=0.05 s\n        (\"compressible\", \"euler\", 0.05, t_final, {\"c\": 0.0}),\n    ]\n\n    results = []\n    for field_type, method, dt, tf, params in test_cases:\n        err = run_case(field_type, method, dt, tf, params, initial_positions)\n        results.append(err)\n\n    # Print results as a single bracketed, comma-separated list\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}