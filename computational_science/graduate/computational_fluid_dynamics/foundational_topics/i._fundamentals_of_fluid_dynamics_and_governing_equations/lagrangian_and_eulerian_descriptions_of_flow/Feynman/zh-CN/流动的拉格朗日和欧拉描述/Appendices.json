{
    "hands_on_practices": [
        {
            "introduction": "我们面临一个基本挑战：给定一个欧拉速度场，我们如何找到单个流体质点的轨迹（即拉格朗日流图）？本练习直接处理了线性速度场 $\\boldsymbol{v}(\\boldsymbol{x},t) = \\boldsymbol{A}\\boldsymbol{x}$ 的情况 。这种形式虽然简单，但非常重要，因为它代表了任何一般光滑流场在某点附近的一阶泰勒展开。解决这个问题可以巩固定义流图的微分方程，并引入矩阵指数作为求解线性常微分方程组的强大工具，这是力学中的一项常见任务。",
            "id": "3338625",
            "problem": "考虑在 $\\mathbb{R}^{n}$ 中的一个流体质点连续体，其在时间 $t=0$ 时的初始位置由 $\\boldsymbol{X} \\in \\mathbb{R}^{n}$ 标记。欧拉速度场由 $\\boldsymbol{v}(\\boldsymbol{x},t)=\\boldsymbol{A}\\boldsymbol{x}$ 给出，其中 $\\boldsymbol{A} \\in \\mathbb{R}^{n \\times n}$ 是一个与 $\\boldsymbol{x}$ 和 $t$ 无关的常数矩阵。拉格朗日流映射 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ 被定义为初始位置在 $\\boldsymbol{X}$ 的质点在时间 $t$ 时的位置，并且根据定义，它满足以下初值问题\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\boldsymbol{v}\\big(\\boldsymbol{\\chi}(\\boldsymbol{X},t),t\\big), \\qquad \\boldsymbol{\\chi}(\\boldsymbol{X},0)=\\boldsymbol{X}.\n$$\n从流映射的基本定义和给定的欧拉场出发，推导出一个用 $\\boldsymbol{A}$、$\\boldsymbol{X}$ 和 $t$ 表示的 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ 的闭式解析表达式。最终答案必须是一个单一的闭式表达式。无需进行数值计算，也无需在最终答案中报告单位。",
            "solution": "该问题被认为是有效的，因为其科学基础是连续介质力学原理，在数学上是适定的，且陈述客观。它提出了一个标准的初值问题，即根据给定的速度场（欧拉描述）确定粒子轨迹（拉格朗日流映射）。所有必要的数据和定义都已给出，不存在内部矛盾或模糊之处。\n\n此推导的起点是拉格朗日流映射 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ 的定义，它描述了在时间 $t=0$ 时位于位置 $\\boldsymbol{X}$ 的流体质点在时间 $t$ 时的位置。该位置的演化由一个常微分方程（ODE）控制，该方程将质点的速度与在质点当前位置求值的欧拉速度场联系起来。如下所示：\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\boldsymbol{v}\\big(\\boldsymbol{\\chi}(\\boldsymbol{X},t),t\\big)\n$$\n问题指定欧拉速度场为 $\\boldsymbol{v}(\\boldsymbol{x},t) = \\boldsymbol{A}\\boldsymbol{x}$，其中 $\\boldsymbol{A}$ 是一个常数 $n \\times n$ 矩阵。将质点的位置 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$ 代入一般位置变量 $\\boldsymbol{x}$，我们得到该流动的常微分方程的具体形式：\n$$\n\\frac{d}{dt}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\boldsymbol{A}\\,\\boldsymbol{\\chi}(\\boldsymbol{X},t)\n$$\n这是一个由 $n$ 个线性、一阶、齐次常系数常微分方程组成的方程组。待求解的变量是向量 $\\boldsymbol{\\chi}(\\boldsymbol{X},t)$，其中 $\\boldsymbol{X}$ 被视为标记特定流体质点的参数。指定质点在 $t=0$ 时起始位置的初始条件如下：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\boldsymbol{X}\n$$\n对于形如 $\\frac{d\\boldsymbol{y}}{dt} = \\boldsymbol{A}\\boldsymbol{y}$ 的常微分方程组，其通解由 $\\boldsymbol{y}(t) = \\exp(\\boldsymbol{A}t)\\boldsymbol{C}$ 给出，其中 $\\boldsymbol{C}$ 是一个积分常数向量，$\\exp(\\boldsymbol{A}t)$ 是矩阵指数。矩阵指数由其泰勒级数展开定义：\n$$\n\\exp(\\boldsymbol{A}t) = \\sum_{k=0}^{\\infty} \\frac{(\\boldsymbol{A}t)^k}{k!} = \\boldsymbol{I} + \\boldsymbol{A}t + \\frac{1}{2!}(\\boldsymbol{A}t)^2 + \\frac{1}{3!}(\\boldsymbol{A}t)^3 + \\dots\n$$\n其中 $\\boldsymbol{I}$ 是 $n \\times n$ 单位矩阵。\n\n将此通用形式应用于我们的问题，流映射的解为：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\exp(\\boldsymbol{A}t)\\boldsymbol{C}\n$$\n常数向量 $\\boldsymbol{C}$ 通过应用初始条件来确定。在 $t=0$ 时，我们有：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\exp(\\boldsymbol{A}\\cdot 0)\\boldsymbol{C} = \\exp(\\boldsymbol{0})\\boldsymbol{C}\n$$\n零矩阵的指数是单位矩阵，即 $\\exp(\\boldsymbol{0}) = \\boldsymbol{I}$。因此：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\boldsymbol{I}\\boldsymbol{C} = \\boldsymbol{C}\n$$\n根据给定的初始条件，我们知道 $\\boldsymbol{\\chi}(\\boldsymbol{X},0) = \\boldsymbol{X}$。令这两个表示初始状态的表达式相等，可得：\n$$\n\\boldsymbol{C} = \\boldsymbol{X}\n$$\n因此，积分常数向量就是流体质点的初始位置向量。\n\n将此结果代回通解，得到拉格朗日流映射的最终闭式解析表达式：\n$$\n\\boldsymbol{\\chi}(\\boldsymbol{X},t) = \\exp(\\boldsymbol{A}t)\\boldsymbol{X}\n$$\n该表达式给出了在指定的线性欧拉速度场作用下，由其初始位置 $\\boldsymbol{X}$ 唯一确定的任意流体质点在时间 $t$ 的位置。",
            "answer": "$$\\boxed{\\exp(\\boldsymbol{A}t)\\boldsymbol{X}}$$"
        },
        {
            "introduction": "在速度与位置的基本联系之上，我们现在来考察加速度，这是连接运动学与动力学的桥梁。物质导数将拉格朗日观点下的加速度（跟随一个质点所感受到的变化）与欧拉场量联系起来。本练习聚焦于对流加速度项 $(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$，并将其与动量通量张量的散度 $\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})$ 联系起来 。通过一个具体的例子，您将亲手理解为什么这两个不同的数学表达式在物理上是相关的，以及流动的可压缩性（由 $\\nabla\\cdot\\boldsymbol{v}$ 表示）如何充当它们之间的桥梁，这一认识对于理解和推导控制方程至关重要。",
            "id": "3338679",
            "problem": "考虑计算流体动力学（CFD）中的二维欧拉速度场，该速度场由 $\\boldsymbol{v}(x,y)=\\big(v_{1}(x,y),v_{2}(x,y)\\big)=\\big(xy,x^{2}\\big)$ 给出，并假设其是定常且足够光滑的。在笛卡尔坐标系下使用标准微分算子进行计算。从物质（或拉格朗日）加速度和张量散度的核心定义出发，完成以下任务：\n\n1. 使用物质加速度的对流部分 $(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$ 的定义，其分量为 $\\big[(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}\\big]_{i}=v_{j}\\,\\partial_{j}v_{i}$（暗含爱因斯坦求和约定），计算给定速度场的 $(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$。\n\n2. 使用二阶张量场散度的定义，将其应用于并矢积 $\\boldsymbol{v}\\otimes\\boldsymbol{v}$，其分量为 $\\big[\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})\\big]_{i}=\\partial_{j}(v_{i}v_{j})$，计算给定速度场的 $\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})$。\n\n3. 从作为不可压缩流体基本质量守恒原理的定常、恒定密度连续性方程 $\\nabla\\cdot\\boldsymbol{v}=0$ 出发，将你计算得到的两个矢量场联系起来，并讨论当 $\\nabla\\cdot\\boldsymbol{v}\\neq 0$ 时会发生什么变化。定义残差矢量场 $\\boldsymbol{D}(x,y):=\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})-(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$，为给定的 $\\boldsymbol{v}(x,y)$ 显式地计算它，并根据连续性方程对其进行解释。\n\n请以列向量形式写出 $\\boldsymbol{D}(x,y)$ 的显式解析表达式作为你的最终答案。不需要数值近似，也不需要单位。",
            "solution": "用户要求在进行求解之前，对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- **欧拉速度场**：$\\boldsymbol{v}(x,y) = \\big(v_{1}(x,y), v_{2}(x,y)\\big) = \\big(xy, x^{2}\\big)$。\n- **假设**：该场是二维、定常且足够光滑的。\n- **坐标系**：笛卡尔坐标系。\n- **定义1（对流加速度）**：$(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$，其分量为 $\\big[(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}\\big]_{i} = v_{j}\\,\\partial_{j}v_{i}$（使用爱因斯坦求和约定，其中 $j$ 对空间维度求和，此处为1和2）。\n- **定义2（并矢积的散度）**：$\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})$，其分量为 $\\big[\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})\\big]_{i} = \\partial_{j}(v_{i}v_{j})$。\n- **原理**：不可压缩流体的定常、恒定密度连续性方程为 $\\nabla\\cdot\\boldsymbol{v}=0$。\n- **任务1**：计算给定速度场的 $(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$。\n- **任务2**：计算给定速度场的 $\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})$。\n- **任务3**：使用原理 $\\nabla\\cdot\\boldsymbol{v}=0$ 关联任务1和任务2的结果，讨论 $\\nabla\\cdot\\boldsymbol{v}\\neq 0$ 的情况，并为给定的速度场计算残差矢量场 $\\boldsymbol{D}(x,y) := \\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v}) - (\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$。\n- **要求的最终答案**：$\\boldsymbol{D}(x,y)$ 作为列向量的显式解析表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于连续介质运动学（特别是流体动力学）的基本概念。物质加速度（拉格朗日视角）和动量通量张量散度（欧拉视角）的定义是标准且正确的。\n- **适定性**：该问题是适定的。速度场是一个显式函数，所需运算是明确定义的矢量微积分计算。任务结构逻辑清晰，能够导出一个唯一、稳定且有意义的解。\n- **客观性**：该问题以精确、形式化的数学语言陈述，没有任何主观性或歧义。\n- **缺陷分析**：\n  1. **科学/事实不健全**：问题是健全的。所有原理和定义在物理学和工程学中都是标准的。\n  2. **不可形式化/不相关**：该问题是一个形式化的数学练习，与流体流动描述的主题直接相关。\n  3. **不完整/矛盾的设定**：问题被完全指定。人们最初可能怀疑存在矛盾，因为问题引入了不可压缩条件 $\\nabla\\cdot\\boldsymbol{v}=0$，但给出的速度场 $\\boldsymbol{v}=(xy, x^2)$ 的散度为 $\\nabla\\cdot\\boldsymbol{v} = \\partial_x(xy) + \\partial_y(x^2) = y \\neq 0$。然而，问题文本恰当地处理了这一点。它要求首先在不可压缩的理想条件下关联这两个量，然后明确地“讨论当 $\\nabla\\cdot\\boldsymbol{v}\\neq 0$ 时会发生什么变化”，并计算给定（非不可压缩）场的差值。这是一种教学结构，而不是逻辑矛盾。\n  4. **不现实/不可行**：速度场是一个简单的多项式函数，作为更复杂流动的局部近似，这在物理上是合理的。\n  5. **病态/结构不良**：问题结构清晰，并能导出一个唯一的解。\n  6. **伪深刻/琐碎**：该问题需要对矢量微积分进行非平凡的应用，并突出了推导纳维-斯托克斯方程时的一个关键恒等式，区分了动量方程的守恒形式和非守恒形式。它并非琐碎问题。\n  7. **超出科学可验证范围**：计算在数学上是可验证的。\n\n### 步骤3：结论与行动\n该问题是有效的。这是一个关于矢量微积分在流体运动学中应用的、表述良好的练习。我现在将进行完整的解答。\n\n### 解答\n\n解答过程将按问题陈述中指定的三个任务进行。给定的二维速度场为 $\\boldsymbol{v}(x,y) = v_1 \\hat{\\boldsymbol{i}} + v_2 \\hat{\\boldsymbol{j}} = xy\\,\\hat{\\boldsymbol{i}} + x^{2}\\,\\hat{\\boldsymbol{j}}$。\n\n**1. 计算对流加速度 $(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$**\n\n对流加速度项 $(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$ 描述了流体质点因移动到空间中速度不同的新位置而引起的速度变化率。算子 $(\\boldsymbol{v}\\cdot\\nabla)$ 由下式给出：\n$$\n\\boldsymbol{v}\\cdot\\nabla = v_1 \\frac{\\partial}{\\partial x} + v_2 \\frac{\\partial}{\\partial y} = (xy) \\frac{\\partial}{\\partial x} + (x^{2}) \\frac{\\partial}{\\partial y}\n$$\n我们将此算子应用于矢量场 $\\boldsymbol{v}$：\n$$\n(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v} = \\left( (xy) \\frac{\\partial}{\\partial x} + (x^{2}) \\frac{\\partial}{\\partial y} \\right) (xy\\,\\hat{\\boldsymbol{i}} + x^{2}\\,\\hat{\\boldsymbol{j}})\n$$\n我们分别计算各个分量。\n第一个分量 $[(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}]_1$ 是：\n$$\n[(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}]_1 = (xy) \\frac{\\partial(xy)}{\\partial x} + (x^{2}) \\frac{\\partial(xy)}{\\partial y} = (xy)(y) + (x^{2})(x) = xy^{2} + x^{3}\n$$\n第二个分量 $[(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}]_2$ 是：\n$$\n[(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}]_2 = (xy) \\frac{\\partial(x^{2})}{\\partial x} + (x^{2}) \\frac{\\partial(x^{2})}{\\partial y} = (xy)(2x) + (x^{2})(0) = 2x^{2}y\n$$\n因此，对流加速度矢量为：\n$$\n(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v} = (xy^{2} + x^{3})\\,\\hat{\\boldsymbol{i}} + (2x^{2}y)\\,\\hat{\\boldsymbol{j}}\n$$\n\n**2. 计算并矢积的散度 $\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})$**\n\n项 $\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})$ 表示动量通量张量（对于单位恒定密度）的散度。并矢积 $\\boldsymbol{v}\\otimes\\boldsymbol{v}$ 是一个二阶张量 $T_{ij} = v_i v_j$。对于给定的场：\n$$\n\\boldsymbol{v}\\otimes\\boldsymbol{v} = \\begin{pmatrix} v_1 v_1 & v_1 v_2 \\\\ v_2 v_1 & v_2 v_2 \\end{pmatrix} = \\begin{pmatrix} (xy)(xy) & (xy)(x^{2}) \\\\ (x^{2})(xy) & (x^{2})(x^{2}) \\end{pmatrix} = \\begin{pmatrix} x^{2}y^{2} & x^{3}y \\\\ x^{3}y & x^{4} \\end{pmatrix}\n$$\n该张量的散度 $[\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})]_i = \\partial_j(v_i v_j)$ 是一个矢量。\n第一个分量是：\n$$\n[\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})]_1 = \\frac{\\partial}{\\partial x}(v_1 v_1) + \\frac{\\partial}{\\partial y}(v_1 v_2) = \\frac{\\partial}{\\partial x}(x^{2}y^{2}) + \\frac{\\partial}{\\partial y}(x^{3}y) = 2xy^{2} + x^{3}\n$$\n第二个分量是：\n$$\n[\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})]_2 = \\frac{\\partial}{\\partial x}(v_2 v_1) + \\frac{\\partial}{\\partial y}(v_2 v_2) = \\frac{\\partial}{\\partial x}(x^{3}y) + \\frac{\\partial}{\\partial y}(x^{4}) = 3x^{2}y + 0 = 3x^{2}y\n$$\n因此，结果矢量为：\n$$\n\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v}) = (2xy^{2} + x^{3})\\,\\hat{\\boldsymbol{i}} + (3x^{2}y)\\,\\hat{\\boldsymbol{j}}\n$$\n\n**3. $\\boldsymbol{D}(x,y)$ 的关系、讨论与计算**\n\n首先，我们建立 $(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$ 和 $\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})$ 之间的一般关系。我们从后者的分量定义出发，并应用微分的乘法法则：\n$$\n[\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})]_i = \\partial_j(v_i v_j) = (\\partial_j v_i)v_j + v_i(\\partial_j v_j)\n$$\n我们识别各项：\n- 第一项 $(\\partial_j v_i)v_j = v_j \\partial_j v_i$ 正是对流加速度第 $i$ 个分量 $[(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}]_i$ 的定义。\n- 在第二项 $v_i(\\partial_j v_j)$ 中，括号内的量 $\\partial_j v_j$ 是速度场散度 $\\nabla\\cdot\\boldsymbol{v}$ 的定义。\n所以，分量形式的关系是：\n$$\n[\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v})]_i = [(\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}]_i + v_i(\\nabla\\cdot\\boldsymbol{v})\n$$\n用矢量符号表示，这是一个标准的矢量微积分恒等式：\n$$\n\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v}) = (\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v} + \\boldsymbol{v}(\\nabla\\cdot\\boldsymbol{v})\n$$\n问题指出，对于不可压缩流体，连续性方程为 $\\nabla\\cdot\\boldsymbol{v}=0$。在这种情况下，右侧第二项消失，恒等式简化为 $\\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v}) = (\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$。这是将纳维-斯托克斯方程从非守恒形式重构为守恒形式的关键步骤，这在数值方法中通常是有利的。\n\n当 $\\nabla\\cdot\\boldsymbol{v} \\neq 0$ 时，例如对于可压缩流体，这两个场不再相同。它们的差值恰好是 $\\boldsymbol{v}(\\nabla\\cdot\\boldsymbol{v})$ 项。该项解释了由于流体微团体积变化（因此，在质量恒定时，密度发生变化）所引起的动量变化。\n\n残差矢量场定义为 $\\boldsymbol{D}(x,y) := \\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v}) - (\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}$。根据上面推导的恒等式，我们立即得到：\n$$\n\\boldsymbol{D}(x,y) = \\boldsymbol{v}(\\nabla\\cdot\\boldsymbol{v})\n$$\n我们来计算给定场 $\\boldsymbol{v} = (xy, x^2)$ 的这个量。首先，我们计算散度：\n$$\n\\nabla\\cdot\\boldsymbol{v} = \\frac{\\partial v_1}{\\partial x} + \\frac{\\partial v_2}{\\partial y} = \\frac{\\partial(xy)}{\\partial x} + \\frac{\\partial(x^{2})}{\\partial y} = y + 0 = y\n$$\n由于 $\\nabla\\cdot\\boldsymbol{v} = y$，该流动是可压缩的（除非限制在直线 $y=0$ 上）。残差矢量场 $\\boldsymbol{D}$ 是：\n$$\n\\boldsymbol{D}(x,y) = \\boldsymbol{v}(\\nabla\\cdot\\boldsymbol{v}) = (xy, x^{2})(y) = (xy^{2}, x^{2}y)\n$$\n我们可以通过直接减去第1部分和第2部分的结果来验证这一结果：\n$$\n\\boldsymbol{D}(x,y) = \\nabla\\cdot(\\boldsymbol{v}\\otimes\\boldsymbol{v}) - (\\boldsymbol{v}\\cdot\\nabla)\\boldsymbol{v}\n$$\n$$\n= (2xy^{2} + x^{3}, 3x^{2}y) - (xy^{2} + x^{3}, 2x^{2}y)\n$$\n$$\n= ((2xy^{2} + x^{3}) - (xy^{2} + x^{3}), (3x^{2}y - 2x^{2}y))\n$$\n$$\n= (xy^{2}, x^{2}y)\n$$\n结果是一致的。矢量场 $\\boldsymbol{D}(x,y)$ 代表了由流动散度非零引起的对动量平衡的贡献。\n\n最终答案要求以列向量形式给出。\n$$\n\\boldsymbol{D}(x,y) = \\begin{pmatrix} xy^{2} \\\\ x^{2}y \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nxy^{2} \\\\\nx^{2}y\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "计算流体力学（CFD）的最终目标通常是将理论模型转化为数值模拟。这最后一个练习将从解析推导转向计算实现 。您将通过数值积分运动学方程，从给定的欧拉速度场中重建拉格朗日流图 $\\boldsymbol{\\chi}(\\mathbf{X},t)$ 和变形梯度张量 $\\mathbf{F}(\\mathbf{X},t)$。这个编程练习提供了将理论与实践相结合的宝贵经验，它展示了数值方法的选择（如欧拉法与龙格-库塔法）如何直接影响模拟的准确性和物理保真度，这是任何计算科学家都需核心关注的问题。",
            "id": "3338691",
            "problem": "一位开发者获得了一个从直接数值模拟（DNS）数据中得到的欧拉速度场 $\\mathbf{u}(\\mathbf{x},t)$。目标是重建拉格朗日流图 $\\boldsymbol{\\chi}(\\mathbf{X},t)$，并通过形变梯度的雅可比行列式来量化体积（在二维中为面积）的变化。在二维空间中进行操作。令 $\\mathbf{x}(t;\\mathbf{X})$ 表示在时间 $t=0$ 时从物质坐标 $\\mathbf{X}$ 出发的轨迹，并定义形变梯度 $\\mathbf{F}(\\mathbf{X},t)=\\partial \\mathbf{x} / \\partial \\mathbf{X}$ 及其行列式 $J(\\mathbf{X},t)=\\det \\mathbf{F}(\\mathbf{X},t)$。基本关系是运动学常微分方程 $d\\mathbf{x}/dt=\\mathbf{u}(\\mathbf{x},t)$（初值条件为 $\\mathbf{x}(0;\\mathbf{X})=\\mathbf{X}$）和变分方程 $d\\mathbf{F}/dt=\\nabla \\mathbf{u}(\\mathbf{x}(t),t)\\,\\mathbf{F}$（初值条件为 $\\mathbf{F}(\\mathbf{X},0)=\\mathbf{I}$），其中 $\\nabla \\mathbf{u}$ 是速度梯度，$\\mathbf{I}$ 是单位矩阵。\n\n实现一个程序，该程序：\n- 通过从 $t=0$ 到 $t=t_{\\text{final}}$ 积分 $d\\mathbf{x}/dt=\\mathbf{u}(\\mathbf{x},t)$ 来隐式重建 $\\boldsymbol{\\chi}(\\mathbf{X},t)$，并同时积分 $d\\mathbf{F}/dt=\\nabla \\mathbf{u}\\,\\mathbf{F}$（初值条件为 $\\mathbf{F}(\\mathbf{X},0)=\\mathbf{I}$）。\n- 对于一组初始位置 $\\{\\mathbf{X}_i\\}$，计算 $J(\\mathbf{X},t_{\\text{final}})=\\det \\mathbf{F}(\\mathbf{X},t_{\\text{final}})$。\n- 检验不可压缩情况与可压缩情况下的体积（面积）守恒性，并将观察到的误差与时间积分方案的选择联系起来。\n\n使用两个具体且科学上一致的场：\n1) 不可压缩场（无散场），由边长为 $L$ 的周期性方形域上的流函数 $\\psi(\\mathbf{x},t)$ 定义。设 $L=1\\,\\text{m}$，$T=1\\,\\text{s}$，且 $\\psi(x,y,t)=A \\sin\\left(2\\pi x/L\\right)\\sin\\left(2\\pi y/L\\right)\\cos\\left(2\\pi t/T\\right)$，其中 $A=0.1\\,\\text{m}^2/\\text{s}$。速度为 $\\mathbf{u}=(\\partial \\psi/\\partial y,\\,-\\partial \\psi/\\partial x)$，其梯度 $\\nabla \\mathbf{u}$ 必须通过解析方法获得。必须通过对位置取模 $L$ 来强制执行空间上的周期性边界条件。在这种情况下，不可压缩性意味着体积守恒，因此预期的 $J$ 为 $1$。\n2) 可压缩均匀各向同性膨胀/收缩，其中 $\\mathbf{u}(\\mathbf{x},t)=c\\,\\mathbf{x}$，$c$ 是一个单位为 $\\text{s}^{-1}$ 的常数。在二维中，$\\nabla \\mathbf{u}=c\\,\\mathbf{I}$，形变梯度的精确解为 $\\mathbf{F}(t)=\\exp(c t)\\,\\mathbf{I}$，这意味着 $J(t)=\\exp(2 c t)$。对于主要的可压缩测试，使用 $c=0.2\\,\\text{s}^{-1}$，并使用 $c=0\\,\\text{s}^{-1}$ 作为边界情况。\n\n使用两种时间积分方案积分耦合系统 $(\\mathbf{x},\\mathbf{F})$：显式前向欧拉法和经典的四阶龙格-库塔法。对于每个测试，计算在一组初始位置上 $J$ 相对于期望值（不可压缩情况下为 $1$，可压缩情况下为 $\\exp(2 c t_{\\text{final}})$）的最大绝对误差。所有计算出的误差必须报告为无量纲浮点数。\n\n使用以下测试套件，初始位置以米为单位：\n- 初始位置 $\\{\\mathbf{X}_i\\}$: $\\{(0.1,0.1),(0.9,0.1),(0.1,0.9),(0.9,0.9),(0.5,0.5)\\}\\,\\text{m}$。\n- 最终时间 $t_{\\text{final}}=1\\,\\text{s}$。\n\n测试用例（每个测试用例在内部是一次程序运行，所有结果汇总为单个输出）：\n- 用例 1：不可压缩场，显式欧拉法，时间步长 $\\Delta t=0.05\\,\\text{s}$。\n- 用例 2：不可压缩场，经典四阶龙格-库塔法，时间步长 $\\Delta t=0.005\\,\\text{s}$。\n- 用例 3：可压缩场，$c=0.2\\,\\text{s}^{-1}$，显式欧拉法，时间步长 $\\Delta t=0.05\\,\\text{s}$。\n- 用例 4：可压缩场，$c=0.2\\,\\text{s}^{-1}$，经典四阶龙格-库塔法，时间步长 $\\Delta t=0.005\\,\\text{s}$。\n- 用例 5：可压缩边界情况，$c=0\\,\\text{s}^{-1}$，显式欧拉法，时间步长 $\\Delta t=0.05\\,\\text{s}$。\n\n三角函数中的角度参数必须以弧度处理。输入参数的物理单位是米（$\\text{m}$）和秒（$\\text{s}$）；雅可比行列式是无量纲的。将最终误差表示为无量纲浮点数。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按 $\\left[\\text{用例 }1,\\text{用例 }2,\\text{用例 }3,\\text{用例 }4,\\text{用例 }5\\right]$ 的顺序列出。例如，输出必须是 $\\left[\\text{float}_1,\\text{float}_2,\\text{float}_3,\\text{float}_4,\\text{float}_5\\right]$ 的形式。",
            "solution": "欧拉描述和拉格朗日描述之间的区别是流体动力学的基础。欧拉描述指定了固定空间位置上的速度场 $\\mathbf{u}(\\mathbf{x},t)$，而拉格朗日描述则跟踪物质点，并构建将初始物质位置 $\\mathbf{X}$ 映射到其当前位置 $\\mathbf{x}(t;\\mathbf{X})$ 的流图 $\\boldsymbol{\\chi}(\\mathbf{X},t)$。\n\n从基本运动学定律出发，物质轨迹满足 $d\\mathbf{x}/dt=\\mathbf{u}(\\mathbf{x},t)$，且有 $\\mathbf{x}(0;\\mathbf{X})=\\mathbf{X}$。形变梯度 $\\mathbf{F}(\\mathbf{X},t)=\\partial \\mathbf{x}/\\partial \\mathbf{X}$ 根据变分方程 $d\\mathbf{F}/dt=\\nabla \\mathbf{u}(\\mathbf{x}(t),t)\\,\\mathbf{F}$ 演化，且有 $\\mathbf{F}(\\mathbf{X},0)=\\mathbf{I}$。该方程通过对运动学关系式关于 $\\mathbf{X}$ 求导并应用链式法则得出：$\\partial_t(\\partial \\mathbf{x}/\\partial \\mathbf{X})=\\left(\\partial \\mathbf{u}/\\partial \\mathbf{x}\\right)\\left(\\partial \\mathbf{x}/\\partial \\mathbf{X}\\right)=\\nabla \\mathbf{u}\\,\\mathbf{F}$。\n\n雅可比行列式 $J(\\mathbf{X},t)=\\det \\mathbf{F}(\\mathbf{X},t)$ 表示从参考构型到当前构型的局部体积变化。其演化可以使用雅可比行列式公式推导：对于可逆矩阵 $\\mathbf{F}(t)$，$d(\\det \\mathbf{F})/dt=\\det \\mathbf{F}\\,\\mathrm{tr}\\left(\\mathbf{F}^{-1}\\frac{d\\mathbf{F}}{dt}\\right)$。代入 $\\frac{d\\mathbf{F}}{dt}=\\nabla \\mathbf{u}\\,\\mathbf{F}$ 可得 $dJ/dt=J\\,\\mathrm{tr}(\\nabla \\mathbf{u})=J\\,\\nabla\\cdot \\mathbf{u}$。因此，\n- 如果流是不可压缩的，则 $\\nabla\\cdot \\mathbf{u}=0$，因此 $dJ/dt=0$ 且对于所有时间 $J(t)=J(0)=1$；在连续介质模型中，体积（二维中为面积）是精确守恒的。\n- 如果流是可压缩的，且在二维空间中具有均匀的速度梯度 $\\nabla \\mathbf{u}=c\\,\\mathbf{I}$，则 $d\\mathbf{F}/dt=c\\,\\mathbf{F}$ 且 $\\mathbf{F}(t)=e^{ct}\\mathbf{I}$，从而导致 $J(t)=\\det \\mathbf{F}(t)=e^{ct}\\cdot e^{ct}=e^{2ct}$。这个结果与 $dJ/dt=J\\,\\mathrm{tr}(\\nabla \\mathbf{u})=J\\cdot 2c$ 一致。\n\n算法设计遵循以下原则：\n1) 指定欧拉场。\n   - 不可压缩情况：定义流函数 $\\psi(x,y,t)=A \\sin(k x)\\sin(k y)\\cos(\\omega t)$，其中 $k=2\\pi/L$ 且 $\\omega=2\\pi/T$。速度为 $\\mathbf{u}=(\\partial \\psi/\\partial y,\\,-\\partial \\psi/\\partial x)$，其梯度 $\\nabla \\mathbf{u}$ 解析计算如下：\n   $$\n   u_x=A k \\cos(k y)\\sin(k x)\\cos(\\omega t),\\quad\n   u_y=-A k \\cos(k x)\\sin(k y)\\cos(\\omega t),\n   $$\n   $$\n   \\frac{\\partial u_x}{\\partial x}=A k^2 \\cos(k y)\\cos(k x)\\cos(\\omega t),\\quad\n   \\frac{\\partial u_x}{\\partial y}=-A k^2 \\sin(k y)\\sin(k x)\\cos(\\omega t),\n   $$\n   $$\n   \\frac{\\partial u_y}{\\partial x}=A k^2 \\sin(k x)\\sin(k y)\\cos(\\omega t),\\quad\n   \\frac{\\partial u_y}{\\partial y}=-A k^2 \\cos(k x)\\cos(k y)\\cos(\\omega t).\n   $$\n   散度 $\\nabla\\cdot\\mathbf{u}=\\partial u_x/\\partial x+\\partial u_y/\\partial y$ 恒为 $0$，保证了不可压缩性。\n   - 可压缩情况：选择 $\\mathbf{u}(\\mathbf{x},t)=c\\,\\mathbf{x}$，其中 $c$ 为常数，使得 $\\nabla \\mathbf{u}=c\\,\\mathbf{I}$ 且 $J(t)=e^{2ct}$。\n\n2) 对于每个初始位置 $\\mathbf{X}_i$，使用以下两种时间积分器之一，从 $t=0$ 到 $t=t_{\\text{final}}$ 积分耦合系统 $(\\mathbf{x},\\mathbf{F})$：\n   - 显式欧拉法（一阶）：$\\mathbf{x}_{n+1}=\\mathbf{x}_n+\\Delta t\\,\\mathbf{u}(\\mathbf{x}_n,t_n)$ 和 $\\mathbf{F}_{n+1}=\\mathbf{F}_n+\\Delta t\\,\\nabla \\mathbf{u}(\\mathbf{x}_n,t_n)\\,\\mathbf{F}_n$。\n   - 经典四阶龙格-库塔法：将标准的四阶段方案一致地应用于 $\\mathbf{x}$ 和 $\\mathbf{F}$：\n     $$\n     \\mathbf{k}_1=\\mathbf{u}(\\mathbf{x}_n,t_n),\\quad \\mathbf{K}_1=\\nabla \\mathbf{u}(\\mathbf{x}_n,t_n)\\,\\mathbf{F}_n,\n     $$\n     $$\n     \\mathbf{k}_2=\\mathbf{u}\\left(\\mathbf{x}_n+\\tfrac{\\Delta t}{2}\\mathbf{k}_1,t_n+\\tfrac{\\Delta t}{2}\\right),\\quad\n     \\mathbf{K}_2=\\nabla \\mathbf{u}\\left(\\mathbf{x}_n+\\tfrac{\\Delta t}{2}\\mathbf{k}_1,t_n+\\tfrac{\\Delta t}{2}\\right)\\left(\\mathbf{F}_n+\\tfrac{\\Delta t}{2}\\mathbf{K}_1\\right),\n     $$\n     $$\n     \\mathbf{k}_3=\\mathbf{u}\\left(\\mathbf{x}_n+\\tfrac{\\Delta t}{2}\\mathbf{k}_2,t_n+\\tfrac{\\Delta t}{2}\\right),\\quad\n     \\mathbf{K}_3=\\nabla \\mathbf{u}\\left(\\mathbf{x}_n+\\tfrac{\\Delta t}{2}\\mathbf{k}_2,t_n+\\tfrac{\\Delta t}{2}\\right)\\left(\\mathbf{F}_n+\\tfrac{\\Delta t}{2}\\mathbf{K}_2\\right),\n     $$\n     $$\n     \\mathbf{k}_4=\\mathbf{u}\\left(\\mathbf{x}_n+\\Delta t\\,\\mathbf{k}_3,t_n+\\Delta t\\right),\\quad\n     \\mathbf{K}_4=\\nabla \\mathbf{u}\\left(\\mathbf{x}_n+\\Delta t\\,\\mathbf{k}_3,t_n+\\Delta t\\right)\\left(\\mathbf{F}_n+\\Delta t\\,\\mathbf{K}_3\\right),\n     $$\n     $$\n     \\mathbf{x}_{n+1}=\\mathbf{x}_n+\\frac{\\Delta t}{6}\\left(\\mathbf{k}_1+2\\mathbf{k}_2+2\\mathbf{k}_3+\\mathbf{k}_4\\right),\\quad\n     \\mathbf{F}_{n+1}=\\mathbf{F}_n+\\frac{\\Delta t}{6}\\left(\\mathbf{K}_1+2\\mathbf{K}_2+2\\mathbf{K}_3+\\mathbf{K}_4\\right).\n     $$\n   对于不可压缩的周期场，在每一步之后通过对位置取模 $L$ 来强制执行空间周期性。\n\n3) 计算雅可比行列式 $J_i=\\det \\mathbf{F}(\\mathbf{X}_i,t_{\\text{final}})$ 以及测试用例的期望值：\n   - 不可压缩：期望 $J_{\\text{exp}}=1$。\n   - 可压缩，常数 $c$：期望 $J_{\\text{exp}}=e^{2 c t_{\\text{final}}}$。\n   将每个用例的误差量化为 $\\max_i \\left|J_i-J_{\\text{exp}}\\right|$。\n\n4) 为指定的测试套件汇总结果。显式欧拉法是一阶方法，预计会表现出较大的误差，尤其是在较粗糙的 $\\Delta t$ 下。经典的四阶龙格-库塔方法由于其更高的精度阶数，即使在使用中等步长时也应产生显著更小的误差。在不可压缩的情况下，$J$ 与 $1$ 的任何偏差都纯粹源于数值积分误差和离散化，这直接衡量了方案对体积守恒的忠实度。在具有空间均匀 $\\nabla \\mathbf{u}$ 的可压缩情况下，精确的 $J$ 是已知的，可以直接评估与 $e^{2ct}$ 的误差；边界情况 $c=0$ 简化为一个平凡的恒等流，此时 $J=1$。\n\n该程序实现了这些步骤，并输出一行包含方括号的、逗号分隔的列表，其中包含按规定顺序排列的五个测试的无量纲浮点数。",
            "answer": "```python\n# Python 3.12\n# Libraries: numpy 1.23.5, scipy 1.11.4 (not used)\nimport numpy as np\n\ndef velocity_incompressible(x, t, params):\n    # params: dict with A, L, T\n    A = params['A']\n    L = params['L']\n    T = params['T']\n    k = 2.0 * np.pi / L\n    omega = 2.0 * np.pi / T\n    # u = (dpsi/dy, -dpsi/dx)\n    u_x = A * k * np.cos(k * x[1]) * np.sin(k * x[0]) * np.cos(omega * t)\n    u_y = -A * k * np.cos(k * x[0]) * np.sin(k * x[1]) * np.cos(omega * t)\n    return np.array([u_x, u_y])\n\ndef grad_incompressible(x, t, params):\n    A = params['A']\n    L = params['L']\n    T = params['T']\n    k = 2.0 * np.pi / L\n    omega = 2.0 * np.pi / T\n    cos_omega_t = np.cos(omega * t)\n    kx = k * x[0]\n    ky = k * x[1]\n    dux_dx = A * (k**2) * np.cos(ky) * np.cos(kx) * cos_omega_t\n    dux_dy = -A * (k**2) * np.sin(ky) * np.sin(kx) * cos_omega_t\n    duy_dx = A * (k**2) * np.sin(kx) * np.sin(ky) * cos_omega_t\n    duy_dy = -A * (k**2) * np.cos(kx) * np.cos(ky) * cos_omega_t\n    return np.array([[dux_dx, dux_dy],\n                     [duy_dx, duy_dy]])\n\ndef velocity_compressible(x, t, params):\n    c = params['c']\n    return c * x\n\ndef grad_compressible(x, t, params):\n    c = params['c']\n    return c * np.eye(2)\n\ndef integrate_particle(X0, t_final, dt, method, field_type, params):\n    x = np.array(X0, dtype=float)\n    F = np.eye(2)\n    t = 0.0\n    steps = int(round(t_final / dt))\n    if field_type == 'incompressible':\n        L = params['L']\n        vel = lambda xx, tt: velocity_incompressible(xx, tt, params)\n        grd = lambda xx, tt: grad_incompressible(xx, tt, params)\n    elif field_type == 'compressible':\n        vel = lambda xx, tt: velocity_compressible(xx, tt, params)\n        grd = lambda xx, tt: grad_compressible(xx, tt, params)\n    else:\n        raise ValueError(\"Unknown field_type\")\n\n    for _ in range(steps):\n        if method == 'euler':\n            u = vel(x, t)\n            G = grd(x, t)\n            x_new = x + dt * u\n            F_new = F + dt * (G @ F)\n        elif method == 'rk4':\n            k1x = vel(x, t)\n            k1F = grd(x, t) @ F\n\n            x2 = x + 0.5 * dt * k1x\n            F2 = F + 0.5 * dt * k1F\n            k2x = vel(x2, t + 0.5 * dt)\n            k2F = grd(x2, t + 0.5 * dt) @ F2\n\n            x3 = x + 0.5 * dt * k2x\n            F3 = F + 0.5 * dt * k2F\n            k3x = vel(x3, t + 0.5 * dt)\n            k3F = grd(x3, t + 0.5 * dt) @ F3\n\n            x4 = x + dt * k3x\n            F4 = F + dt * k3F\n            k4x = vel(x4, t + dt)\n            k4F = grd(x4, t + dt) @ F4\n\n            x_new = x + (dt / 6.0) * (k1x + 2 * k2x + 2 * k3x + k4x)\n            F_new = F + (dt / 6.0) * (k1F + 2 * k2F + 2 * k3F + k4F)\n        else:\n            raise ValueError(\"Unknown method\")\n\n        x = x_new\n        F = F_new\n        t += dt\n\n        if field_type == 'incompressible':\n            # Enforce periodicity on [0, L)\n            x = np.mod(x, L)\n\n    J = float(np.linalg.det(F))\n    return J\n\ndef run_case(field_type, method, dt, t_final, params, initial_positions):\n    # Compute Js for all initial positions\n    Js = []\n    for X0 in initial_positions:\n        J = integrate_particle(X0, t_final, dt, method, field_type, params)\n        Js.append(J)\n    Js = np.array(Js)\n    # Expected J\n    if field_type == 'incompressible':\n        J_exp = 1.0\n    elif field_type == 'compressible':\n        c = params['c']\n        J_exp = float(np.exp(2.0 * c * t_final))\n    else:\n        raise ValueError(\"Unknown field_type\")\n    # Error metric: maximum absolute error across particles\n    err = float(np.max(np.abs(Js - J_exp)))\n    return err\n\ndef solve():\n    # Initial positions in meters\n    initial_positions = [\n        (0.1, 0.1),\n        (0.9, 0.1),\n        (0.1, 0.9),\n        (0.9, 0.9),\n        (0.5, 0.5),\n    ]\n    t_final = 1.0  # seconds\n\n    # Test cases specification\n    test_cases = [\n        # Case 1: Incompressible, Euler, dt=0.05 s\n        (\"incompressible\", \"euler\", 0.05, t_final, {\"A\": 0.1, \"L\": 1.0, \"T\": 1.0}),\n        # Case 2: Incompressible, RK4, dt=0.005 s\n        (\"incompressible\", \"rk4\", 0.005, t_final, {\"A\": 0.1, \"L\": 1.0, \"T\": 1.0}),\n        # Case 3: Compressible c=0.2 s^-1, Euler, dt=0.05 s\n        (\"compressible\", \"euler\", 0.05, t_final, {\"c\": 0.2}),\n        # Case 4: Compressible c=0.2 s^-1, RK4, dt=0.005 s\n        (\"compressible\", \"rk4\", 0.005, t_final, {\"c\": 0.2}),\n        # Case 5: Compressible boundary c=0.0 s^-1, Euler, dt=0.05 s\n        (\"compressible\", \"euler\", 0.05, t_final, {\"c\": 0.0}),\n    ]\n\n    results = []\n    for field_type, method, dt, tf, params in test_cases:\n        err = run_case(field_type, method, dt, tf, params, initial_positions)\n        results.append(err)\n\n    # Print results as a single bracketed, comma-separated list\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}