{
    "hands_on_practices": [
        {
            "introduction": "To grasp the hyperbolic nature of the Euler equations, we must first understand how they propagate information locally. This exercise guides you through the fundamental analysis of the 1D Euler system by deriving its characteristic structure—the eigenvalues and eigenvectors of the flux Jacobian. Performing this derivation connects abstract linear algebra to the physical reality of acoustic and entropy waves, forming the theoretical bedrock for constructing modern shock-capturing numerical schemes .",
            "id": "3343704",
            "problem": "Consider the one-dimensional compressible Euler equations in conservation form for an ideal gas with ratio of specific heats $\\gamma$:\n$$\n\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\frac{\\partial \\boldsymbol{f}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0},\n\\quad\n\\boldsymbol{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix},\n\\quad\n\\boldsymbol{f}(\\boldsymbol{Q}) = \\begin{pmatrix}\n\\rho u \\\\\n\\rho u^{2} + p \\\\\nu(\\rho E + p)\n\\end{pmatrix},\n$$\nwhere $\\rho$ is the mass density, $u$ is the velocity, $E$ is the specific total energy, and $p$ is the pressure satisfying the ideal-gas equation of state $p = (\\gamma - 1)\\rho e$ with $e$ the specific internal energy. Define the sound speed $c$ by $c^{2} = \\gamma p / \\rho$, and the specific total enthalpy $H$ by $H = (\\rho E + p)/\\rho$.\n\nAt a smooth state, the flux Jacobian $\\boldsymbol{A}(\\boldsymbol{Q}) = \\partial \\boldsymbol{f}/\\partial \\boldsymbol{Q}$ characterizes the local propagation of small-amplitude disturbances. Starting from the conservation laws and the equation of state, derive the characteristic speeds and the right and left eigenvectors of $\\boldsymbol{A}(\\boldsymbol{Q})$ in terms of the primitive variables $(\\rho, u, p)$ and $\\gamma$. Impose the normalization that the matrix of left eigenvectors $\\boldsymbol{L}$ satisfies $\\boldsymbol{L}\\boldsymbol{R} = \\boldsymbol{I}$, where $\\boldsymbol{R}$ is the matrix of right eigenvectors and $\\boldsymbol{I}$ is the identity. In particular, construct the contact (entropy) wave as the eigenvector associated with the eigenvalue $u$ along which pressure and velocity are unchanged.\n\nDiscuss the mathematical character of the system at sonic states, clarifying whether the eigenstructure is defective or diagonalizable, and analyze the implications for approximate Riemann solvers, including the need for entropy fixes near transonic rarefactions.\n\nFinally, for a generic small perturbation $\\delta \\boldsymbol{Q} = \\begin{pmatrix} \\delta \\rho \\\\ \\delta(\\rho u) \\\\ \\delta(\\rho E) \\end{pmatrix}$ about a base state $(\\rho, u, p)$, compute the scalar amplitude $\\alpha_{2}$ of the contact wave defined by $\\alpha_{2} = \\boldsymbol{\\ell}_{2} \\cdot \\delta \\boldsymbol{Q}$, where $\\boldsymbol{\\ell}_{2}$ is the left eigenvector associated with the eigenvalue $u$ under the normalization $\\boldsymbol{L}\\boldsymbol{R} = \\boldsymbol{I}$. Express your final answer for $\\alpha_{2}$ symbolically in terms of $u$, $c$, $\\gamma$, $\\delta \\rho$, $\\delta(\\rho u)$, and $\\delta(\\rho E)$. No numerical evaluation is required.",
            "solution": "The user wants a detailed analysis of the eigenstructure of the one-dimensional compressible Euler equations, a discussion of the system's character at sonic states, and the derivation of the amplitude of the contact wave component of a small perturbation.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Governing Equations**: $\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\frac{\\partial \\boldsymbol{f}(\\boldsymbol{Q})}{\\partial x} = \\boldsymbol{0}$\n*   **State Vector**: $\\boldsymbol{Q} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{pmatrix}$\n*   **Flux Vector**: $\\boldsymbol{f}(\\boldsymbol{Q}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(\\rho E + p) \\end{pmatrix}$\n*   **Ideal Gas Equation of State**: $p = (\\gamma - 1)\\rho e$, where $\\gamma$ is the ratio of specific heats and $e$ is the specific internal energy.\n*   **Specific Total Energy**: $E = e + \\frac{1}{2}u^2$\n*   **Sound Speed**: $c^{2} = \\gamma p / \\rho$\n*   **Specific Total Enthalpy**: $H = (\\rho E + p)/\\rho = E + p/\\rho$\n*   **Flux Jacobian**: $\\boldsymbol{A}(\\boldsymbol{Q}) = \\partial \\boldsymbol{f}/\\partial \\boldsymbol{Q}$\n*   **Normalization Condition**: The matrix of left eigenvectors $\\boldsymbol{L}$ and the matrix of right eigenvectors $\\boldsymbol{R}$ satisfy $\\boldsymbol{L}\\boldsymbol{R} = \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the identity matrix.\n*   **Contact Wave Definition**: The eigenvector associated with the eigenvalue $u$, along which pressure and velocity are unchanged.\n*   **Perturbation**: A generic small perturbation $\\delta \\boldsymbol{Q} = \\begin{pmatrix} \\delta \\rho \\\\ \\delta(\\rho u) \\\\ \\delta(\\rho E) \\end{pmatrix}$\n*   **Objective**: Compute the scalar amplitude $\\alpha_{2} = \\boldsymbol{\\ell}_{2} \\cdot \\delta \\boldsymbol{Q}$, where $\\boldsymbol{\\ell}_{2}$ is the left eigenvector for the eigenvalue $u$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded**: The problem is based on the Euler equations, a cornerstone of fluid dynamics. All definitions (ideal gas law, sound speed, enthalpy) are standard and correct. This is scientifically sound.\n*   **Well-Posed**: The problem asks for a derivation of known quantities and a discussion of a well-established topic in computational fluid dynamics. The final calculation is specific and has a unique answer based on the premises. The problem is well-posed.\n*   **Objective**: The problem is stated in precise mathematical language, free of subjectivity or ambiguity. This is objective.\n*   **Completeness**: All necessary equations and definitions are provided to derive the required quantities. The system is self-contained.\n*   **Other Flaws**: The problem does not exhibit any of the flaws listed in the validation criteria (e.g., it is not trivial, contradictory, or unverifiable).\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Solution\n\nThe system of equations can be written in quasilinear form as $\\frac{\\partial \\boldsymbol{Q}}{\\partial t} + \\boldsymbol{A}(\\boldsymbol{Q})\\frac{\\partial \\boldsymbol{Q}}{\\partial x} = \\boldsymbol{0}$, where $\\boldsymbol{A}(\\boldsymbol{Q}) = \\frac{\\partial \\boldsymbol{f}}{\\partial \\boldsymbol{Q}}$ is the flux Jacobian. The eigenvalues of $\\boldsymbol{A}$ represent the characteristic speeds of wave propagation, and the eigenvectors represent the modes of these waves.\n\n**1. Flux Jacobian, Eigenvalues, and Eigenvectors**\n\nTo find the Jacobian $\\boldsymbol{A}$, we must differentiate the components of the flux vector $\\boldsymbol{f}$ with respect to the components of the state vector $\\boldsymbol{Q}$. The components of $\\boldsymbol{f}$ are given in terms of primitive variables $(\\rho, u, p)$, while $\\boldsymbol{Q}$ is in conservative variables. We can express the primitive variables in terms of the conservative ones: $\\rho = Q_1$, $u = Q_2/Q_1$, and $p = (\\gamma-1)(Q_3 - \\frac{1}{2}Q_2^2/Q_1)$. The differentiation is tedious but straightforward. The resulting Jacobian matrix is:\n$$\n\\boldsymbol{A}(\\boldsymbol{Q}) = \\begin{pmatrix}\n0  1  0 \\\\\n\\frac{\\gamma-3}{2}u^2  (3-\\gamma)u  \\gamma-1 \\\\\nu\\left(\\frac{\\gamma-1}{2}u^2 - H\\right)  H - (\\gamma-1)u^2  \\gamma u\n\\end{pmatrix}\n$$\nwhere $H = \\frac{c^2}{\\gamma-1} + \\frac{1}{2}u^2$ is the specific total enthalpy.\n\nThe eigenvalues of $\\boldsymbol{A}$ are the roots of the characteristic polynomial $\\det(\\boldsymbol{A} - \\lambda \\boldsymbol{I}) = 0$. For the Euler equations, these are well-known to be:\n$$\n\\lambda_1 = u - c, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + c\n$$\nThese correspond to the two acoustic waves (propagating at speeds $u \\pm c$) and the contact/entropy wave (propagating with the fluid velocity $u$).\n\nThe corresponding right eigenvectors $\\boldsymbol{r}_k$, satisfying $\\boldsymbol{A}\\boldsymbol{r}_k = \\lambda_k \\boldsymbol{r}_k$, form the columns of the matrix $\\boldsymbol{R}$. A standard, unscaled choice for these eigenvectors is:\n$$\n\\boldsymbol{r}_1 = \\begin{pmatrix} 1 \\\\ u-c \\\\ H-uc \\end{pmatrix}, \\quad\n\\boldsymbol{r}_2 = \\begin{pmatrix} 1 \\\\ u \\\\ u^2/2 \\end{pmatrix}, \\quad\n\\boldsymbol{r}_3 = \\begin{pmatrix} 1 \\\\ u+c \\\\ H+uc \\end{pmatrix}\n$$\nThe eigenvector $\\boldsymbol{r}_2$ corresponds to the contact wave. A perturbation proportional to $\\boldsymbol{r}_2$ represents a change in density (and thus entropy, since $p=(\\gamma-1)\\rho e$) with no change in pressure or velocity, as specified in the problem.\n\nThe left eigenvectors $\\boldsymbol{\\ell}_k$, satisfying $\\boldsymbol{\\ell}_k \\boldsymbol{A} = \\lambda_k \\boldsymbol{\\ell}_k$, form the rows of the matrix $\\boldsymbol{L}$. The normalization condition $\\boldsymbol{L}\\boldsymbol{R} = \\boldsymbol{I}$ implies that $\\boldsymbol{\\ell}_i \\cdot \\boldsymbol{r}_j = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\n**2. Discussion of Sonic States and Numerical Implications**\n\nA sonic state is where the local flow velocity equals the local sound speed, i.e., $|u| = c$. Let's consider $u=c$. The eigenvalues become:\n$$\n\\lambda_1 = 0, \\quad \\lambda_2 = c, \\quad \\lambda_3 = 2c\n$$\nFor a non-zero sound speed $c0$, these eigenvalues are distinct. A matrix with distinct eigenvalues is always diagonalizable. Therefore, the eigenstructure of the flux Jacobian $\\boldsymbol{A}$ is not defective at a sonic point; a full set of linearly independent eigenvectors exists.\n\nThe mathematical character of the system remains strictly hyperbolic. However, a significant issue arises in the context of numerical methods, particularly for approximate Riemann solvers like Roe's method. The problem centers on transonic rarefactions, where a continuous expansion fan crosses a sonic point (e.g., the flow transitions from subsonic $uc$ to supersonic $uc$ across the fan).\n\nThe characteristic fields associated with eigenvalues $\\lambda_1 = u-c$ and $\\lambda_3 = u+c$ are genuinely nonlinear (i.e., $\\nabla_{\\boldsymbol{Q}}\\lambda_k \\cdot \\boldsymbol{r}_k \\neq 0$), meaning they admit both shock and rarefaction wave solutions. The field for $\\lambda_2=u$ is linearly degenerate ($\\nabla_{\\boldsymbol{Q}}\\lambda_2 \\cdot \\boldsymbol{r}_2 = 0$), admitting only contact discontinuities.\n\nIn a transonic rarefaction, for example for the first characteristic family, the wave speed $\\lambda_1(x,t) = u(x,t) - c(x,t)$ varies continuously from a negative value on one side to a positive value on the other. A simple approximate Riemann solver like Roe's method replaces this fan with a single discontinuity propagating at an averaged speed. If this averaged speed is close to zero, the solver might incorrectly place a stationary shock wave where a smooth rarefaction should be. This numerical shock wave violates the second law of thermodynamics (the entropy condition) and is a non-physical artifact.\n\nTo prevent this, an \"entropy fix\" is required. These fixes detect the condition for a transonic rarefaction (e.g., $\\lambda_k(\\boldsymbol{Q}_L)  0  \\lambda_k(\\boldsymbol{Q}_R)$ for the left and right states of a Riemann problem) and modify the numerical flux function. For example, the wave is artificially \"smeared\" or broadened to mimic the behavior of a rarefaction fan, thereby preventing the formation of the entropy-violating shock and ensuring a physically correct solution.\n\n**3. Derivation of the Contact Wave Amplitude $\\alpha_2$**\n\nThe amplitude $\\alpha_2$ of the contact wave component of a perturbation $\\delta\\boldsymbol{Q}$ is given by the projection of $\\delta\\boldsymbol{Q}$ onto the corresponding left eigenvector $\\boldsymbol{\\ell}_2$: $\\alpha_2 = \\boldsymbol{\\ell}_2 \\cdot \\delta\\boldsymbol{Q}$. We must first find the normalized left eigenvector $\\boldsymbol{\\ell}_2$.\n\nFrom the orthogonality condition $\\boldsymbol{\\ell}_2 \\cdot \\boldsymbol{r}_1 = 0$ and $\\boldsymbol{\\ell}_2 \\cdot \\boldsymbol{r}_3 = 0$:\n$$\n\\ell_{2,1} + \\ell_{2,2}(u-c) + \\ell_{2,3}(H-uc) = 0 \\\\\n\\ell_{2,1} + \\ell_{2,2}(u+c) + \\ell_{2,3}(H+uc) = 0\n$$\nSubtracting the first equation from the second gives:\n$$\n2c\\ell_{2,2} + 2uc\\ell_{2,3} = 0 \\implies \\ell_{2,2} = -u\\ell_{2,3} \\quad (\\text{for } c \\neq 0)\n$$\nSubstituting this back into the first equation:\n$$\n\\ell_{2,1} - u(u-c)\\ell_{2,3} + (H-uc)\\ell_{2,3} = 0 \\implies \\ell_{2,1} + (-u^2 + uc + H - uc)\\ell_{2,3} = 0 \\implies \\ell_{2,1} = (u^2-H)\\ell_{2,3}\n$$\nSo, the unnormalized left eigenvector is proportional to $(u^2-H, -u, 1)^T$. Let this be $\\boldsymbol{\\ell}_2^* = (u^2-H, -u, 1)^T$.\n\nNow, we impose the normalization condition $\\boldsymbol{\\ell}_2 \\cdot \\boldsymbol{r}_2 = 1$. Let $\\boldsymbol{\\ell}_2 = S \\boldsymbol{\\ell}_2^*$.\n$$\nS \\left( (u^2-H)\\cdot 1 + (-u)\\cdot u + 1 \\cdot \\frac{u^2}{2} \\right) = 1\n$$\n$$\nS \\left( u^2 - H - u^2 + \\frac{u^2}{2} \\right) = 1 \\implies S \\left( \\frac{u^2}{2} - H \\right) = 1\n$$\nThe scaling factor is $S = \\frac{1}{u^2/2 - H}$. Substituting $H = \\frac{c^2}{\\gamma-1} + \\frac{u^2}{2}$:\n$$\nS = \\frac{1}{u^2/2 - \\left(\\frac{c^2}{\\gamma-1} + \\frac{u^2}{2}\\right)} = -\\frac{\\gamma-1}{c^2}\n$$\nThe normalized left eigenvector $\\boldsymbol{\\ell}_2$ is thus:\n$$\n\\boldsymbol{\\ell}_2 = -\\frac{\\gamma-1}{c^2} \\begin{pmatrix} u^2-H \\\\ -u \\\\ 1 \\end{pmatrix} = -\\frac{\\gamma-1}{c^2} \\begin{pmatrix} u^2 - (\\frac{c^2}{\\gamma-1} + \\frac{u^2}{2}) \\\\ -u \\\\ 1 \\end{pmatrix} = -\\frac{\\gamma-1}{c^2} \\begin{pmatrix} \\frac{u^2}{2} - \\frac{c^2}{\\gamma-1} \\\\ -u \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\boldsymbol{\\ell}_2 = \\begin{pmatrix} -\\frac{(\\gamma-1)u^2}{2c^2} + 1 \\\\ \\frac{(\\gamma-1)u}{c^2} \\\\ -\\frac{\\gamma-1}{c^2} \\end{pmatrix}\n$$\nFinally, we compute the amplitude $\\alpha_2 = \\boldsymbol{\\ell}_2 \\cdot \\delta\\boldsymbol{Q}$:\n$$\n\\alpha_2 = \\left(1 - \\frac{(\\gamma-1)u^2}{2c^2}\\right)\\delta\\rho + \\left(\\frac{(\\gamma-1)u}{c^2}\\right)\\delta(\\rho u) + \\left(-\\frac{\\gamma-1}{c^2}\\right)\\delta(\\rho E)\n$$\nThis can be factored for a more compact representation:\n$$\n\\alpha_2 = \\frac{\\gamma-1}{c^2} \\left[ \\left(\\frac{c^2}{\\gamma-1} - \\frac{u^2}{2}\\right)\\delta\\rho + u\\,\\delta(\\rho u) - \\delta(\\rho E) \\right]\n$$\nThe first form is already expressed in the required variables.",
            "answer": "$$\\boxed{\\left(1 - \\frac{(\\gamma-1)u^2}{2c^2}\\right)\\delta\\rho + \\frac{(\\gamma-1)u}{c^2}\\delta(\\rho u) - \\frac{\\gamma-1}{c^2}\\delta(\\rho E)}$$"
        },
        {
            "introduction": "A deep understanding of characteristic waves is not merely theoretical; it is essential for the practical task of setting physically and mathematically sound boundary conditions in simulations. This practice applies the Method of Characteristics to a 2D steady flow, challenging you to determine how many conditions must be specified at a subsonic inflow boundary. By analyzing the signs of the characteristic speeds normal to the boundary, you will directly link the hyperbolic structure of the equations to the well-posedness of a computational problem .",
            "id": "3343739",
            "problem": "Consider the two-dimensional, steady, compressible Euler equations posed on a domain with smooth boundary segment having outward unit normal $\\boldsymbol{n} = (n_{x}, n_{y})$. Let the conservative state be $U = (\\rho, \\rho u, \\rho v, \\rho E)^{\\top}$, where $\\rho$ is the mass density, $(u, v)$ are the Cartesian components of velocity $\\boldsymbol{u}$, and $E$ is the total specific energy. Assume a thermally and calorically perfect gas with ratio of specific heats $\\gamma  1$, so that the pressure satisfies $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho (u^{2} + v^{2})\\right)$ and the speed of sound is $a = \\sqrt{\\gamma p / \\rho}$. In conservation form, the steady equations are $\\partial_{x}\\boldsymbol{F}(U) + \\partial_{y}\\boldsymbol{G}(U) = \\boldsymbol{0}$, where $\\boldsymbol{F}$ and $\\boldsymbol{G}$ are the inviscid fluxes in the $x$- and $y$-directions.\n\nUsing the Method of Characteristics (MOC), analyze the characteristic structure of the quasi-linear form projected along the boundary normal direction. Let the normal component of velocity be $u_{n} = \\boldsymbol{u}\\cdot\\boldsymbol{n}$. Assume the boundary is a subsonic inflow boundary, meaning $u_{n}  0$ and $|u_{n}|  a$. Starting from fundamental definitions and the Euler equations, determine the sign of each characteristic speed associated with the normal flux Jacobian and formulate the boundary-data requirement in terms of incoming versus outgoing characteristic fields. Based on this classification, count the number of independent scalar boundary conditions that must be prescribed at such a subsonic inflow boundary for the two-dimensional steady Euler system to be locally well-posed. Provide your final count as a single integer. No rounding is required and no units are to be included in the final answer.",
            "solution": "We begin by recalling that the two-dimensional steady compressible Euler equations for a perfect gas can be written in conservation form as\n$$\n\\partial_{x}\\boldsymbol{F}(U) + \\partial_{y}\\boldsymbol{G}(U) = \\boldsymbol{0},\n$$\nwith $U = (\\rho, \\rho u, \\rho v, \\rho E)^{\\top}$, $p = (\\gamma - 1)\\left(\\rho E - \\tfrac{1}{2}\\rho (u^{2} + v^{2})\\right)$, and $a = \\sqrt{\\gamma p / \\rho}$. To employ the Method of Characteristics (MOC) at a boundary, we project the quasi-linear form along the outward unit normal direction $\\boldsymbol{n} = (n_{x}, n_{y})$. Define the normal flux\n$$\n\\boldsymbol{F}_{n}(U) = n_{x}\\boldsymbol{F}(U) + n_{y}\\boldsymbol{G}(U),\n$$\nand the corresponding normal Jacobian\n$$\nA_{n}(U) = \\frac{\\partial \\boldsymbol{F}_{n}}{\\partial U}(U).\n$$\nThe characteristic speeds of the system in the normal direction are the eigenvalues of $A_{n}(U)$. Physically, in inviscid compressible flow, the characteristic fields comprise convective transport of entropy and tangential vorticity, and acoustic waves. In a locally one-dimensional sense aligned with the normal, the eigenstructure of $A_{n}$ mirrors that of the one-dimensional Euler equations with velocity $u_{n} = \\boldsymbol{u}\\cdot\\boldsymbol{n}$ and speed of sound $a$.\n\nA standard derivation (either by explicit linearization of $A_{n}$ or by projection of the known eigenstructure of the Euler flux Jacobians) shows that the four eigenvalues of $A_{n}$ in two dimensions are\n$$\n\\lambda_{1} = u_{n} - a, \\quad \\lambda_{2} = u_{n}, \\quad \\lambda_{3} = u_{n}, \\quad \\lambda_{4} = u_{n} + a.\n$$\nThe repeated eigenvalue $u_{n}$ corresponds to the entropy and tangential vorticity (or shear) convected along the flow, while $u_{n} \\pm a$ correspond to the two acoustic characteristic families.\n\nThe Method of Characteristics classifies characteristics as incoming or outgoing relative to the computational domain by the sign of $\\lambda_{i}$ with respect to the outward normal. For an outward normal, a characteristic with $\\lambda_{i}  0$ is entering the domain (incoming), while $\\lambda_{i}  0$ is leaving the domain (outgoing). The number of independent scalar boundary conditions that must be specified equals the number of incoming characteristic fields, because data on outgoing characteristics are determined by the interior solution and must not be over-specified.\n\nWe are given that the boundary is a subsonic inflow boundary, meaning\n$$\nu_{n}  0 \\quad \\text{and} \\quad |u_{n}|  a.\n$$\nWe now determine the signs of the eigenvalues under these conditions:\n\n- For $\\lambda_{2} = u_{n}$, since $u_{n}  0$, we have $\\lambda_{2}  0$.\n- For $\\lambda_{3} = u_{n}$, the same reasoning gives $\\lambda_{3}  0$.\n- For $\\lambda_{1} = u_{n} - a$, the subsonic condition $|u_{n}|  a$ with $u_{n}  0$ implies $u_{n} - a  0 - a  0$, hence $\\lambda_{1}  0$.\n- For $\\lambda_{4} = u_{n} + a$, the subsonic condition $|u_{n}|  a$ yields $u_{n} + a  -|u_{n}| + a  0$, hence $\\lambda_{4}  0$.\n\nTherefore, at a subsonic inflow boundary with outward normal, there are exactly three incoming characteristic fields (those with $\\lambda_{1}  0$, $\\lambda_{2}  0$, and $\\lambda_{3}  0$), and one outgoing characteristic field (with $\\lambda_{4}  0$). By the MOC boundary-data requirement, the number of independent scalar boundary conditions that must be prescribed at the boundary equals the number of incoming characteristics, which is $3$.\n\nIn terms of physical quantities, these three pieces of boundary data can be chosen to fix, for example, a combination of thermodynamic and kinematic quantities associated with the incoming fields (such as a specification of entropy or stagnation conditions and flow direction). The outgoing acoustic characteristic is determined by interior compatibility and should not be specified. The count is independent of the particular choice of primitive variables, provided they span the incoming characteristic subspace.\n\nHence, the required number of boundary conditions at a subsonic inflow boundary for the two-dimensional steady Euler equations is $3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "The distinction between the Euler and Navier-Stokes equations goes beyond their form, leading to profoundly different physical behaviors. This computational exercise provides a hands-on demonstration of one of the most fundamental differences: time reversibility. By implementing a time-reversal experiment, you will numerically confirm the reversible character of the hyperbolic Euler equations and witness the irreversible \"arrow of time\" introduced by the parabolic viscous term in the Navier-Stokes equations, quantifying its effect on the flow's total energy .",
            "id": "3343741",
            "problem": "You are asked to design and implement a program that performs a time-reversal experiment for two-dimensional incompressible flows governed by the Euler equations (zero viscosity) and the Navier–Stokes equations (positive viscosity). The goal is to use principled diagnostics to assess the mathematical character of these equations under time reversal: numerical reversibility for Euler and irreversibility for Navier–Stokes.\n\nThe fundamental base for this task is as follows.\n\n- The incompressible Navier–Stokes equations in a periodic square domain are\n$$\n\\partial_t \\boldsymbol{u} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} = -\\nabla p + \\nu \\nabla^2 \\boldsymbol{u}, \\quad \\nabla \\cdot \\boldsymbol{u} = 0,\n$$\nwith the Euler equations given by the special case $\\nu = 0$. Here $\\boldsymbol{u}(x,y,t)$ is the velocity, $p(x,y,t)$ is the pressure (up to a constant), and $\\nu \\ge 0$ is the kinematic viscosity.\n\n- In two space dimensions, introduce the scalar vorticity $\\omega = \\partial_x u_y - \\partial_y u_x$ and the streamfunction $\\psi$ defined by $\\boldsymbol{u} = (\\partial_y \\psi, -\\partial_x \\psi)$, so that incompressibility is automatically satisfied. The vorticity evolves by\n$$\n\\partial_t \\omega + \\boldsymbol{u}\\cdot\\nabla \\omega = \\nu \\nabla^2 \\omega,\n$$\nand the streamfunction satisfies the elliptic relation\n$$\n\\nabla^2 \\psi = -\\omega.\n$$\n\n- Under time reversal $t \\mapsto -t$, the Euler equations are invariant when combined with the transformation $\\boldsymbol{u}\\mapsto -\\boldsymbol{u}$ (equivalently $\\omega \\mapsto -\\omega$), but the Navier–Stokes equations with $\\nu0$ are not invariant due to the irreversible viscous term $\\nu \\nabla^2 \\boldsymbol{u}$.\n\n- The kinetic energy is\n$$\nE(t) = \\frac{1}{2} \\int_{\\Omega} \\lVert \\boldsymbol{u}(x,y,t)\\rVert^2 \\, \\mathrm{d}x \\,\\mathrm{d}y,\n$$\nand in two dimensions one has the exact balance for smooth solutions\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} E(t) = - \\nu \\int_{\\Omega} \\omega(x,y,t)^2 \\, \\mathrm{d}x \\,\\mathrm{d}y,\n$$\nso $E$ is conserved for $\\nu = 0$ and decays monotonically for $\\nu  0$. In particular, the cumulative dissipation over a time interval $[0,T]$ is\n$$\nD(0,T) = \\nu \\int_{0}^{T} \\int_{\\Omega} \\omega(x,y,t)^2 \\, \\mathrm{d}x \\,\\mathrm{d}y \\,\\mathrm{d}t.\n$$\n\nYour program must implement a spatially pseudo-spectral discretization on a periodic square domain $\\Omega = [0,2\\pi)^2$ with an $N \\times N$ equispaced grid and the $2/3$ de-aliasing rule for nonlinear terms. Adopt a time integration scheme that is strictly time-symmetric for the inviscid part ($\\nu=0$) so that the Euler dynamics is numerically reversible under the mapping $t \\mapsto -t$, $\\omega \\mapsto -\\omega$, and treat the viscous term exactly via an integrating factor when $\\nu  0$ to avoid artificial instability in the diffusive component. All trigonometric functions must take angles in radians. All quantities are non-dimensional.\n\nTime-reversal experiment protocol for each test case:\n\n1. Set the initial vorticity at $t=0$ to\n$$\n\\omega_0(x,y) = A \\left[\\sin(3x + 2y) + \\cos(2x - y)\\right],\n$$\nwhere $A$ is a given amplitude. Recover the corresponding divergence-free velocity $\\boldsymbol{u}_0$ via the streamfunction $\\psi_0$ solving $\\nabla^2 \\psi_0 = -\\omega_0$.\n\n2. Integrate forward from $t=0$ to $t=T$ using a fixed time step $\\Delta t$ and $M$ steps (so $T = M \\Delta t$) for the given viscosity $\\nu \\ge 0$. Record the forward kinetic energy $E(0)$ and $E(T)$, and compute the cumulative dissipation diagnostic\n$$\nD(0,T) \\approx \\nu \\sum_{n=0}^{M-1} \\left( \\int_{\\Omega} \\omega(x,y,t_n)^2 \\, \\mathrm{d}x \\,\\mathrm{d}y \\right) \\Delta t,\n$$\nwhere $t_n = n \\Delta t$. Use the standard Riemann sum with uniform timestep.\n\n3. Perform a time-reversal experiment: construct two consecutive terminal states from the forward integration and apply the mapping $\\omega \\mapsto -\\omega$ consistently to these two states. Then march forward for the same number of steps $M$ with the same $\\nu$ and $\\Delta t$. At the end, compare the obtained vorticity field with $-\\omega_0$ and report the relative reversal error\n$$\n\\varepsilon_{\\mathrm{rev}} = \\frac{\\lVert \\omega_{\\mathrm{rev}}(T) + \\omega_0 \\rVert_{L^2(\\Omega)}}{\\lVert \\omega_0 \\rVert_{L^2(\\Omega)}},\n$$\nwith the convention that if $\\lVert \\omega_0 \\rVert_{L^2(\\Omega)} = 0$ then $\\varepsilon_{\\mathrm{rev}} := 0$. Here $\\lVert \\cdot \\rVert_{L^2(\\Omega)}$ denotes the standard $L^2$ norm on the periodic square domain.\n\n4. Also report the energy ratio\n$$\nR_E = \\frac{E(T)}{E(0)}.\n$$\n\nYour program must compute, for each test case, the triple of floats $(\\varepsilon_{\\mathrm{rev}}, R_E, D(0,T))$.\n\nTest Suite:\n\nUse the following four parameter sets to exercise different facets and edge cases of the experiment. In all cases, the spatial grid is $N = 32$, the domain is $\\Omega = [0,2\\pi)^2$, the time step is $\\Delta t = 0.0025$, and the number of time steps is $M = 400$ so that $T = 1.0$.\n\n- Case $1$ (Euler, reversible baseline): $(\\nu, A) = (0.0, 1.0)$.\n- Case $2$ (Navier–Stokes, mild dissipation): $(\\nu, A) = (0.001, 1.0)$.\n- Case $3$ (Navier–Stokes, stronger dissipation): $(\\nu, A) = (0.01, 1.0)$.\n- Case $4$ (trivial edge case): $(\\nu, A) = (0.01, 0.0)$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results for the four cases, concatenated in order as a flat list of twelve floats:\n$$\n[\\varepsilon_{\\mathrm{rev}}^{(1)}, R_E^{(1)}, D^{(1)}, \\varepsilon_{\\mathrm{rev}}^{(2)}, R_E^{(2)}, D^{(2)}, \\varepsilon_{\\mathrm{rev}}^{(3)}, R_E^{(3)}, D^{(3)}, \\varepsilon_{\\mathrm{rev}}^{(4)}, R_E^{(4)}, D^{(4)}].\n$$\nThe line must be printed exactly as a comma-separated list enclosed in square brackets with no additional text. All trigonometric angles must be in radians. All quantities are non-dimensional. The answers are floats.",
            "solution": "The user seeks to implement a numerical experiment to study the time-reversal properties of the 2D incompressible Euler and Navier–Stokes equations. The problem is well-posed, scientifically sound, and provides sufficient detail to construct a unique numerical solution. I will proceed with the implementation as specified.\n\n### Principle-Based Design\n\nThe core of the problem lies in numerically evolving the vorticity transport equation:\n$$\n\\partial_t \\omega + \\boldsymbol{u}\\cdot\\nabla \\omega = \\nu \\nabla^2 \\omega\n$$\non a two-dimensional periodic domain $\\Omega = [0,2\\pi)^2$. The velocity $\\boldsymbol{u}$ is recovered from the vorticity $\\omega$ via a streamfunction $\\psi$ that satisfies the Poisson equation $\\nabla^2 \\psi = -\\omega$. We will use a pseudo-spectral method for spatial discretization and a specialized time-stepping scheme.\n\n**1. Spatial Discretization: Pseudo-Spectral Method**\n\nA pseudo-spectral method is employed, which represents fields like vorticity on an $N \\times N$ grid, and uses the Fast Fourier Transform (FFT) to switch to Fourier space for computations.\n\n- **Vorticity to Velocity**: In Fourier space, derivatives become algebraic multiplications. The streamfunction's Fourier coefficients $\\hat{\\psi}$ are related to the vorticity's coefficients $\\hat{\\omega}$ by:\n$$\n-(k_x^2 + k_y^2)\\hat{\\psi}(\\boldsymbol{k}) = -\\hat{\\omega}(\\boldsymbol{k}) \\implies \\hat{\\psi}(\\boldsymbol{k}) = \\frac{\\hat{\\omega}(\\boldsymbol{k})}{k_x^2 + k_y^2}\n$$\nwhere $\\boldsymbol{k}=(k_x, k_y)$ is the wavevector. The case $\\boldsymbol{k}=0$ is handled by setting $\\hat{\\psi}(0,0)=0$. The velocity coefficients are then $\\hat{u}_x = i k_y \\hat{\\psi}$ and $\\hat{u}_y = -i k_x \\hat{\\psi}$.\n\n- **Nonlinear Advection Term**: The advection term $\\boldsymbol{u}\\cdot\\nabla\\omega$ is computed pseudo-spectrally. We compute $\\boldsymbol{u}$ and $\\omega$ in physical space via inverse FFT, multiply them, then transform back to Fourier space via FFT to compute the spatial derivatives. To prevent aliasing errors from this quadratic nonlinearity, the $2/3$ de-aliasing rule is applied by zeroing out high-frequency modes ($|k_x|, |k_y|  \\lfloor N/3 \\rfloor$) after computing the nonlinear product.\n\n- **Viscous Diffusion Term**: The diffusion term $\\nu \\nabla^2 \\omega$ becomes $-\\nu (k_x^2 + k_y^2) \\hat{\\omega}$ in Fourier space, a simple multiplication.\n\n**2. Time Integration**\n\nThe problem requires a time-symmetric scheme for the inviscid part and an exact treatment of the viscous term. A scheme that satisfies these conditions and is suitable for a two-step reversal experiment is an exponential time-differencing leapfrog-like method. The semi-discretized equation in Fourier space is:\n$$\n\\frac{d\\hat{\\omega}}{dt} = F(\\hat{\\omega}) + L\\hat{\\omega}\n$$\nwhere $L\\hat{\\omega} = -\\nu(k_x^2+k_y^2)\\hat{\\omega}$ is the linear diffusion operator and $F(\\hat{\\omega})$ is the nonlinear advection operator.\n\nA second-order scheme that is time-symmetric for $F$ and treats $L$ with an integrating factor is:\n$$\n\\hat{\\omega}^{n+1} = e^{2L\\Delta t} \\hat{\\omega}^{n-1} + 2\\Delta t e^{L\\Delta t} F(\\hat{\\omega}^n)\n$$\nFor $\\nu=0$, this reduces to the standard second-order leapfrog scheme $\\hat{\\omega}^{n+1} = \\hat{\\omega}^{n-1} + 2\\Delta t F(\\hat{\\omega}^n)$, which is time-reversible. For $\\nu0$, the exponential factors break the time-reversal symmetry, correctly modeling the physical irreversibility.\n\n- **Startup**: This is a two-step method, requiring $\\hat{\\omega}^0$ and $\\hat{\\omega}^1$ to start. $\\hat{\\omega}^0$ is given by the initial condition. $\\hat{\\omega}^1$ is computed using a second-order Runge-Kutta (Heun's method) for the first time step. This maintains the overall second-order accuracy.\n\n**3. Time-Reversal Protocol**\n\n1.  **Forward Integration**: The system is evolved from $t=0$ to $t=T=M\\Delta t$. The states at the last two time steps, $\\omega^{M-1}$ and $\\omega^{M}$, are stored. The initial and final kinetic energies $E(0), E(T)$ and the total dissipation $D(0,T)$ are computed.\n    - Kinetic Energy: $E = \\frac{1}{2}\\int |\\boldsymbol{u}|^2 dV$. Using Parseval's theorem, this is efficiently computed in Fourier space: $E(t) = \\frac{1}{2} \\frac{(2\\pi)^2}{N^4} \\sum_{K \\neq 0} \\frac{|\\hat{\\omega}(\\boldsymbol{k},t)|^2}{k_x^2+k_y^2}$.\n    - Dissipation: $D(0,T) \\approx \\nu \\Delta t \\sum_{n=0}^{M-1} \\lVert \\omega(t_n) \\rVert^2_{L^2}$, where the squared norm is also computed via Parseval's theorem: $\\lVert \\omega \\rVert^2_{L^2} \\approx \\frac{(2\\pi)^2}{N^4} \\sum_{\\boldsymbol{k}} |\\hat{\\omega}(\\boldsymbol{k})|^2$.\n\n2.  **Reverse Integration**: The same numerical integrator is used to march forward in time for another $M$ steps, but with initial conditions derived from the final state of the forward run. For a two-step method, the initial state is a pair of fields. We apply the time-reversal transformation $\\omega \\mapsto -\\omega$ to the two consecutive terminal states:\n    - $\\omega_{\\text{rev}}(0) = -\\omega(T)$\n    - $\\omega_{\\text{rev}}(\\Delta t) = -\\omega(T-\\Delta t)$ (This requires a slight adaptation for our scheme, we use $\\omega^{M}$ and $\\omega^{M-1}$)\n    The initial pair for the reverse leapfrog integration is thus $(\\hat{\\omega}_{\\text{rev}}^0, \\hat{\\omega}_{\\text{rev}}^1) = (-\\hat{\\omega}^M, -\\hat{\\omega}^{M-1})$.\n\n3.  **Diagnostics**: After the reverse integration, the final state $\\omega_{\\text{rev}}(T)$ is compared to the negative of the initial state, $-\\omega_0$, to compute the reversal error $\\varepsilon_{\\mathrm{rev}}$. The energy ratio $R_E=E(T)/E(0)$ is also reported.\n\nThis numerical setup allows a direct probe of the mathematical character of the equations. For the Euler case ($\\nu=0$), the scheme is time-reversible, so $\\varepsilon_{\\mathrm{rev}}$ should be close to zero (limited by floating-point error and startup scheme asymmetry). For the Navier–Stokes case ($\\nu0$), the scheme is not reversible, and $\\varepsilon_{\\mathrm{rev}}$ is expected to be significant, demonstrating the \"arrow of time\" introduced by viscosity.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ... No, use numpy.fft\n# from scipy.fft import fft2, ifft2 is an allowed equivalent\n\ndef solve():\n    \"\"\"\n    Main function to run the time-reversal experiment for all test cases.\n    \"\"\"\n\n    def solve_case(N, dt, M, nu, A):\n        \"\"\"\n        Solves a single time-reversal experiment case.\n        \"\"\"\n        # =====================================================================\n        # 1. Grid and Wavenumber Setup\n        # =====================================================================\n        L = 2 * np.pi\n        dx = L / N\n        x = np.arange(N) * dx\n        X, Y = np.meshgrid(x, x, indexing='ij')\n\n        kx_1d = np.fft.fftfreq(N, d=dx / (2 * np.pi))\n        Kx, Ky = np.meshgrid(kx_1d, kx_1d, indexing='ij')\n        K2 = Kx**2 + Ky**2\n\n        K2_inv = np.zeros_like(K2)\n        K2_inv[K2 > 0] = 1.0 / K2[K2 > 0]\n\n        kmax = N // 3\n        dealias_mask = (np.abs(Kx) = kmax)  (np.abs(Ky) = kmax)\n\n        # =====================================================================\n        # 2. Helper Functions\n        # =====================================================================\n        def get_advection_hat(omega_hat):\n            psi_hat = -omega_hat * K2_inv\n            ux_hat = 1j * Ky * psi_hat\n            uy_hat = -1j * Kx * psi_hat\n\n            ux = np.real(np.fft.ifft2(ux_hat))\n            uy = np.real(np.fft.ifft2(uy_hat))\n            omega = np.real(np.fft.ifft2(omega_hat))\n\n            ux_omega_hat = np.fft.fft2(ux * omega)\n            uy_omega_hat = np.fft.fft2(uy * omega)\n            \n            ux_omega_hat[~dealias_mask] = 0\n            uy_omega_hat[~dealias_mask] = 0\n\n            return -(1j * Kx * ux_omega_hat + 1j * Ky * uy_omega_hat)\n\n        def get_L2_norm_sq(omega_hat):\n            return (L**2 / N**2) * np.sum(np.abs(np.fft.ifft2(omega_hat))**2)\n            \n        def get_energy(omega_hat):\n            energy_density_hat = K2_inv * np.abs(omega_hat)**2\n            return 0.5 * (L**2 / N**4) * np.sum(energy_density_hat)\n        \n        # =====================================================================\n        # 3. Initial Condition  Trivial Case\n        # =====================================================================\n        if A == 0.0:\n            return 0.0, 1.0, 0.0\n\n        omega0 = A * (np.sin(3 * X + 2 * Y) + np.cos(2 * X - Y))\n        omega0_hat = np.fft.fft2(omega0)\n\n        # =====================================================================\n        # 4. Forward Integration\n        # =====================================================================\n        w_hat_p = np.copy(omega0_hat)  # omega_hat at t_{n-1}\n        dissipation_sum = get_L2_norm_sq(w_hat_p)\n        E0 = get_energy(w_hat_p)\n\n        # Startup Step (RK2 - Heun's method) to get omega_hat at t_1\n        F_p = get_advection_hat(w_hat_p)\n        k1 = F_p - nu * K2 * w_hat_p\n        w_hat_star = w_hat_p + dt * k1\n        \n        F_star = get_advection_hat(w_hat_star)\n        k2 = F_star - nu * K2 * w_hat_star\n        w_hat_c = w_hat_p + 0.5 * dt * (k1 + k2)  # omega_hat at t_n\n\n        # Main Time-Stepping Loop\n        exp_visc_1 = np.exp(-nu * K2 * dt)\n        exp_visc_2 = np.exp(-2 * nu * K2 * dt)\n        \n        omega_hat_M_minus_1 = np.copy(w_hat_c)\n\n        for n in range(1, M):\n            if n  M:\n                 dissipation_sum += get_L2_norm_sq(w_hat_c)\n            \n            # Exponential Leapfrog step\n            F_hat_c = get_advection_hat(w_hat_c)\n            w_hat_n = exp_visc_2 * w_hat_p + 2 * dt * exp_visc_1 * F_hat_c\n            \n            omega_hat_M_minus_1 = w_hat_p\n            w_hat_p = w_hat_c\n            w_hat_c = w_hat_n\n\n            if n == M - 2:\n                omega_hat_M_minus_1 = np.copy(w_hat_c)\n\n        omega_hat_M = np.copy(w_hat_c)\n\n        ET = get_energy(omega_hat_M)\n        RE = ET / E0 if E0 > 0 else 1.0\n        DT = nu * dt * dissipation_sum\n\n        # =====================================================================\n        # 5. Time-Reversal Experiment\n        # =====================================================================\n        w_hat_rev_p = -omega_hat_M          # omega_rev^0 = -omega^M\n        w_hat_rev_c = -omega_hat_M_minus_1  # omega_rev^1 = -omega^{M-1}\n\n        for n in range(1, M):\n            F_hat_rev_c = get_advection_hat(w_hat_rev_c)\n            w_hat_rev_n = exp_visc_2 * w_hat_rev_p + 2 * dt * exp_visc_1 * F_hat_rev_c\n            \n            w_hat_rev_p = w_hat_rev_c\n            w_hat_rev_c = w_hat_rev_n\n\n        omega_hat_rev_final = w_hat_rev_c\n        \n        norm_w0_sq = get_L2_norm_sq(omega0_hat)\n        norm_err_sq = get_L2_norm_sq(omega_hat_rev_final + omega0_hat)\n        eps_rev = np.sqrt(norm_err_sq / norm_w0_sq)\n\n        return eps_rev, RE, DT\n\n    # --- Main execution script ---\n    test_cases = [\n        (0.0, 1.0),    # Case 1: Euler\n        (0.001, 1.0),  # Case 2: Navier-Stokes (mild)\n        (0.01, 1.0),   # Case 3: Navier-Stokes (strong)\n        (0.01, 0.0),   # Case 4: Trivial\n    ]\n    \n    N = 32\n    dt = 0.0025\n    M = 400\n    \n    results = []\n    for nu, A in test_cases:\n        eps_rev, RE, DT = solve_case(N, dt, M, nu, A)\n        results.extend([eps_rev, RE, DT])\n        \n    print(f\"[{','.join(f'{x:.7g}' for x in results)}]\")\n\nsolve()\n```"
        }
    ]
}