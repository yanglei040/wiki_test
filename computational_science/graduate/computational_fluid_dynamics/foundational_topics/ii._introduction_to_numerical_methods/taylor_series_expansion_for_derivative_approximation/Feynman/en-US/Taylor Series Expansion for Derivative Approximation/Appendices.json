{
    "hands_on_practices": [
        {
            "introduction": "In computational fluid dynamics, accurately resolving diffusive processes, such as viscosity or heat conduction, is paramount. These physical phenomena are modeled by second-order derivatives in the governing equations. This first practice provides a foundational exercise in deriving a high-order approximation for the second derivative, which is essential for minimizing numerical errors and correctly capturing these effects on a discrete grid . By systematically applying Taylor series expansions, you will construct the coefficients for a fourth-order accurate scheme and determine its leading truncation error, mastering a core skill in the analysis and design of numerical methods.",
            "id": "3370259",
            "problem": "In Computational Fluid Dynamics (CFD), higher-order accurate discretizations of spatial derivatives are essential for resolving viscous effects with minimal numerical dissipation. Consider a smooth scalar field $f(x)$ representing, for example, a velocity component in a one-dimensional laminar flow. The pointwise second derivative $f''(x)$ is needed in the discretization of the viscous term of the Navierâ€“Stokes equations. Suppose $f$ is sampled at the symmetric locations $x-2h$, $x-h$, $x$, $x+h$, and $x+2h$, where $h>0$ is the uniform grid spacing.\n\nStarting from the Taylor series expansion of $f(x\\pm h)$ and $f(x\\pm 2h)$ about $x$, construct a symmetric linear combination of the sampled values at the stencil $\\{x-2h, x-h, x, x+h, x+2h\\}$ that yields a fourth-order accurate approximation of $f''(x)$. Then, by carrying the Taylor series one order beyond the achieved accuracy, compute the leading truncation error term and express it explicitly in terms of $f^{(6)}(x)$ and $h$.\n\nYour final answer must consist of:\n1. A single closed-form analytic expression giving the fourth-order accurate finite-difference formula for $f''(x)$ using the given stencil.\n2. A single closed-form analytic expression for the leading truncation error term proportional to $f^{(6)}(x)$.\n\nProvide both expressions. No numerical rounding is required, and no units are needed.",
            "solution": "The user wants to derive a fourth-order accurate finite difference approximation for the second derivative, $f''(x)$, using a five-point symmetric stencil.\n\n### Step 1: Extract Givens\n- The function to be differentiated is a smooth scalar field $f(x)$.\n- The derivative to be approximated is the second derivative, $f''(x)$.\n- The stencil of points is symmetric: $\\{x-2h, x-h, x, x+h, x+2h\\}$.\n- $h>0$ is the uniform grid spacing.\n- The method to be used is constructing a linear combination of the function values at the stencil points, based on Taylor series expansions.\n- The required order of accuracy for the approximation of $f''(x)$ is fourth-order, i.e., the truncation error is $O(h^4)$.\n- The final result must include the finite difference formula and its leading truncation error term.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard and fundamental task in the field of numerical analysis, particularly as applied to computational fluid dynamics. It is well-posed, providing all necessary information (stencil, desired derivative, order of accuracy) to uniquely determine the coefficients of the linear combination and the leading error term. The language is objective and precise. The problem is free of any scientific or logical flaws, contradictions, or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the Finite Difference Formula and Truncation Error\n\nWe seek an approximation for $f''(x)$ of the form:\n$$\nf''(x) \\approx \\frac{c_{-2}f(x-2h) + c_{-1}f(x-h) + c_0f(x) + c_1f(x+h) + c_2f(x+2h)}{k}\n$$\nFor a symmetric approximation on a symmetric stencil, we expect the coefficients to be symmetric, i.e., $c_{-i} = c_i$. Furthermore, for approximating a second derivative, the scaling factor $k$ is typically $h^2$. Let us define the coefficients as $c_0$, $c_1=c_{-1}$, and $c_2=c_{-2}$. The approximation, denoted $D_h^2 f(x)$, is:\n$$\nD_h^2 f(x) = \\frac{c_2 f(x-2h) + c_1 f(x-h) + c_0 f(x) + c_1 f(x+h) + c_2 f(x+2h)}{h^2}\n$$\nThis can be rewritten as:\n$$\nD_h^2 f(x) = \\frac{c_2[f(x+2h) + f(x-2h)] + c_1[f(x+h) + f(x-h)] + c_0 f(x)}{h^2}\n$$\nTo determine the coefficients $c_0$, $c_1$, and $c_2$, we use Taylor series expansions of $f(x \\pm h)$ and $f(x \\pm 2h)$ about the point $x$. Since the final error term involves $f^{(6)}(x)$, we must carry the expansions to a sufficiently high order to capture this term. The combination of $f(x+kh)$ and $f(x-kh)$ conveniently cancels all odd-order derivative terms.\n\nThe expansions for the sums are:\n$$\nf(x+h) + f(x-h) = 2 \\sum_{n=0}^{\\infty} \\frac{h^{2n}}{(2n)!} f^{(2n)}(x) = 2f(x) + h^2 f''(x) + \\frac{h^4}{12}f^{(4)}(x) + \\frac{h^6}{360}f^{(6)}(x) + O(h^8)\n$$\n$$\nf(x+2h) + f(x-2h) = 2 \\sum_{n=0}^{\\infty} \\frac{(2h)^{2n}}{(2n)!} f^{(2n)}(x) = 2f(x) + 4h^2 f''(x) + \\frac{16h^4}{12}f^{(4)}(x) + \\frac{64h^6}{360}f^{(6)}(x) + O(h^8)\n$$\nSimplifying the fractions in the second expansion:\n$$\nf(x+2h) + f(x-2h) = 2f(x) + 4h^2 f''(x) + \\frac{4h^4}{3}f^{(4)}(x) + \\frac{8h^6}{45}f^{(6)}(x) + O(h^8)\n$$\nNow, substitute these expansions into the expression for $D_h^2 f(x)$:\n\\begin{align*}\nh^2 D_h^2 f(x) &= c_2\\left[2f(x) + 4h^2 f''(x) + \\frac{4}{3}h^4f^{(4)}(x) + \\frac{8}{45}h^6f^{(6)}(x) + \\dots\\right] \\\\\n&+ c_1\\left[2f(x) + h^2 f''(x) + \\frac{1}{12}h^4f^{(4)}(x) + \\frac{1}{360}h^6f^{(6)}(x) + \\dots\\right] \\\\\n&+ c_0 f(x)\n\\end{align*}\nGroup terms by the derivatives of $f(x)$:\n\\begin{align*}\nh^2 D_h^2 f(x) &= f(x) [2c_2 + 2c_1 + c_0] \\\\\n&+ f''(x) h^2 [4c_2 + c_1] \\\\\n&+ f^{(4)}(x) h^4 \\left[\\frac{4}{3}c_2 + \\frac{1}{12}c_1\\right] \\\\\n&+ f^{(6)}(x) h^6 \\left[\\frac{8}{45}c_2 + \\frac{1}{360}c_1\\right] \\\\\n&+ O(h^8)\n\\end{align*}\nDividing by $h^2$, we get:\n$$\nD_h^2 f(x) = \\frac{f(x)}{h^2}[2c_2+2c_1+c_0] + f''(x)[4c_2+c_1] + f^{(4)}(x)h^2\\left[\\frac{4}{3}c_2+\\frac{1}{12}c_1\\right] + f^{(6)}(x)h^4\\left[\\frac{8}{45}c_2+\\frac{1}{360}c_1\\right] + O(h^6)\n$$\nFor $D_h^2 f(x)$ to be a fourth-order accurate approximation of $f''(x)$, we require the following conditions:\n$1$. The coefficient of $f(x)$ must be $0$: $2c_2 + 2c_1 + c_0 = 0$.\n$2$. The coefficient of $f''(x)$ must be $1$: $4c_2 + c_1 = 1$.\n$3$. The coefficient of the $h^2$ term (containing $f^{(4)}(x)$) must be $0$ to achieve at least fourth-order accuracy: $\\frac{4}{3}c_2 + \\frac{1}{12}c_1 = 0 \\implies 16c_2 + c_1 = 0$.\n\nWe now have a system of three linear equations for the three unknown coefficients:\n\\begin{cases}\n2c_2 + 2c_1 + c_0 = 0 \\\\\n4c_2 + c_1 = 1 \\\\\n16c_2 + c_1 = 0\n\\end{cases}\nFrom the third equation, we have $c_1 = -16c_2$.\nSubstituting this into the second equation: $4c_2 + (-16c_2) = 1 \\implies -12c_2 = 1 \\implies c_2 = -\\frac{1}{12}$.\nNow we can find $c_1$: $c_1 = -16\\left(-\\frac{1}{12}\\right) = \\frac{16}{12} = \\frac{4}{3}$.\nFinally, using the first equation to find $c_0$: $c_0 = -2c_2 - 2c_1 = -2\\left(-\\frac{1}{12}\\right) - 2\\left(\\frac{4}{3}\\right) = \\frac{1}{6} - \\frac{8}{3} = \\frac{1}{6} - \\frac{16}{6} = -\\frac{15}{6} = -\\frac{5}{2}$.\n\nThe coefficients are $c_2 = -\\frac{1}{12}$, $c_1 = \\frac{4}{3}$, and $c_0 = -\\frac{5}{2}$.\nThe finite difference formula for $f''(x)$ is:\n$$\nf''(x) \\approx \\frac{-\\frac{1}{12}f(x-2h) + \\frac{4}{3}f(x-h) - \\frac{5}{2}f(x) + \\frac{4}{3}f(x+h) - \\frac{1}{12}f(x+2h)}{h^2}\n$$\nTo eliminate fractions in the numerator, we multiply the numerator and denominator by $12$:\n$$\nf''(x) \\approx \\frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2}\n$$\n\nThe truncation error $T$ is given by $T = D_h^2 f(x) - f''(x)$. With the derived coefficients, the terms involving $f(x)$, $f''(x)$, and $f^{(4)}(x)$ are correctly set. The leading error term is the first non-zero term in the expansion, which is the term containing $f^{(6)}(x)$:\n$$\nT = f^{(6)}(x)h^4\\left[\\frac{8}{45}c_2 + \\frac{1}{360}c_1\\right] + O(h^6)\n$$\nSubstituting the values for $c_1$ and $c_2$:\n$$\nT = f^{(6)}(x)h^4\\left[\\frac{8}{45}\\left(-\\frac{1}{12}\\right) + \\frac{1}{360}\\left(\\frac{4}{3}\\right)\\right] + O(h^6)\n$$\n$$\nT = f^{(6)}(x)h^4\\left[-\\frac{8}{540} + \\frac{4}{1080}\\right] = f^{(6)}(x)h^4\\left[-\\frac{16}{1080} + \\frac{4}{1080}\\right] = f^{(6)}(x)h^4\\left(-\\frac{12}{1080}\\right)\n$$\nSimplifying the fraction $-\\frac{12}{1080} = -\\frac{1}{90}$.\nThus, the leading truncation error term is:\n$$\nT = -\\frac{h^4}{90}f^{(6)}(x)\n$$\nThe approximation is indeed fourth-order accurate, as the error is $O(h^4)$.\n\nThe two required expressions are:\n$1$. The finite difference formula for $f''(x)$: $\\frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2}$\n$2$. The leading truncation error term: $-\\frac{h^4}{90}f^{(6)}(x)$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2} & -\\frac{h^4}{90}f^{(6)}(x) \\end{pmatrix}}$$"
        },
        {
            "introduction": "While uniform grids provide a convenient theoretical starting point, practical CFD simulations almost always employ non-uniform, or stretched, grids to efficiently resolve flow features like boundary layers and shock waves. This practice extends the Taylor series method to the more general case of a non-uniform stencil . You will derive the appropriate finite-difference coefficients and analyze how the truncation error behaves on a stretched grid, directly connecting the abstract mathematical derivation to a tangible and critical application in fluid dynamics simulations.",
            "id": "3370198",
            "problem": "Consider a smooth scalar field $u(x)$ and a nonuniform three-point stencil $\\{x_{i-1},x_i,x_{i+1}\\}$, where $h_- = x_i - x_{i-1} > 0$ and $h_+ = x_{i+1} - x_i > 0$. You will derive a three-point linear finite-difference approximation for the first derivative $u'(x_i)$ by matching a local Taylor series expansion about $x_i$ and then analyze the leading truncation error. Subsequently, you will apply the resulting approximation to a wall-stretched grid in the wall-normal coordinate $y$ and predict the error scaling of $\\partial_y u$ in terms of a local grid spacing $h(y)$.\n\nDerivation task:\n- Starting from the Taylor series expansions for $u(x_{i-1})$ and $u(x_{i+1})$ about $x_i$ and the assumption of smoothness up to at least the third derivative, derive coefficients $a$, $b$, and $c$ such that\n$$u'(x_i) \\approx a\\,u(x_{i-1}) + b\\,u(x_i) + c\\,u(x_{i+1})$$\nmatches the Taylor series up to terms that are $O(h^3)$ in the sense that the approximation is exact for constants, linear, and quadratic polynomials in $x$. From this derivation, determine the leading-order truncation error term and express it as a coefficient multiplying $u^{(3)}(x_i)$.\n\nApplication to wall-stretched grid:\n- Consider a monotone grid mapping for the wall-normal coordinate $y$ of the form\n$$y(\\xi) = L\\,\\frac{e^{\\beta \\xi} - 1}{e^{\\beta} - 1},$$\nwith $\\xi \\in [0,1]$ a uniform computational coordinate with nodal values $\\xi_j = j/(N-1)$ for $j=0,1,\\dots,N-1$, domain size $L>0$, and stretching parameter $\\beta>0$. For each interior node $y_i = y(\\xi_i)$, define $h_- = y_i - y_{i-1}$ and $h_+ = y_{i+1} - y_i$. Using the derived truncation error, predict how the pointwise error in approximating $\\partial_y u(y_i)$ scales with the local spacing. Express your prediction in terms of $h_-$, $h_+$, and an equivalent local spacing $h_{\\text{loc}}(y_i)$ that you must define from $h_-$ and $h_+$ in a way justified by your Taylor analysis.\n\nImplementation requirements:\n- Implement a program that:\n  1. Computes and returns the coefficients $a$, $b$, and $c$ for specified pairs $(h_-,h_+)$.\n  2. Confirms the leading-order truncation error coefficient for $u^{(3)}$ from your derivation and evaluates the ratio of the observed local error to the predicted leading term on a stretched grid for a chosen smooth function $u(y)$.\n  3. Performs a two-grid empirical convergence study on the stretched grid to estimate the observed order of accuracy $p$ of the finite-difference approximation for $\\partial_y u$.\n\nTest suite and parameters to use:\n- Use $L=1$ for all stretched grids.\n- Test case $1$ (asymmetric stencil coefficients): $h_- = 0.07$, $h_+ = 0.13$. Output the list $[a,b,c]$.\n- Test case $2$ (symmetric stencil coefficients): $h_- = 0.10$, $h_+ = 0.10$. Output the list $[a,b,c]$.\n- Test case $3$ (local error-to-leading-term ratio on a stretched grid): choose $u(y) = \\operatorname{Re}\\{e^{\\lambda y}\\}$ with $\\lambda = -3 + \\mathrm{i}\\pi$, so that $u'(y) = \\operatorname{Re}\\{\\lambda e^{\\lambda y}\\}$ and $u^{(3)}(y) = \\operatorname{Re}\\{\\lambda^3 e^{\\lambda y}\\}$. Use $N = 161$, $\\beta = 4$, and evaluate at interior index $i=50$. Compute the finite-difference approximation of $u'(y_i)$ using your coefficients from the local $h_-$ and $h_+$, then compute the ratio\n$$r = \\frac{\\left(a\\,u(y_{i-1}) + b\\,u(y_i) + c\\,u(y_{i+1})\\right) - u'(y_i)}{\\left(\\frac{h_- h_+}{6}\\right)\\,u^{(3)}(y_i)}.$$\nOutput the float $r$.\n- Test case $4$ (empirical order on a stretched grid): choose $u(y) = \\operatorname{Im}\\{e^{\\lambda y}\\}$ with $\\lambda = -2 + 3\\mathrm{i}$, so that $u'(y) = \\operatorname{Im}\\{\\lambda e^{\\lambda y}\\}$. Use $\\beta = 3$ and two grids with $N_1 = 81$ and $N_2 = 161$. For each grid, compute the maximum interior-point absolute error\n$$E_N = \\max_{i=1,\\dots,N-2} \\left|a_i\\,u(y_{i-1}) + b_i\\,u(y_i) + c_i\\,u(y_{i+1}) - u'(y_i)\\right|,$$\nwhere $a_i$, $b_i$, and $c_i$ are computed from the local $(h_-^{(i)},h_+^{(i)})$ at each interior point. Let $\\Delta \\xi_N = 1/(N-1)$ and estimate the empirical order\n$$p = \\frac{\\log\\left(E_{N_2}/E_{N_1}\\right)}{\\log\\left(\\Delta \\xi_{N_2}/\\Delta \\xi_{N_1}\\right)}.$$\nOutput the float $p$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the test cases: $[[a_1,b_1,c_1],[a_2,b_2,c_2],r,p]$. No additional text should be printed.",
            "solution": "The user-provided problem is a well-posed task in numerical analysis, specifically concerning the derivation and application of finite difference schemes. The problem is scientifically grounded, internally consistent, and contains all necessary information for a complete solution.\n\n### Part 1: Derivation of the Finite Difference Formula and Truncation Error\n\nWe aim to find the coefficients $a$, $b$, and $c$ for the finite-difference approximation of the first derivative $u'(x_i)$ at a point $x_i$ on a non-uniform grid:\n$$u'(x_i) \\approx a\\,u(x_{i-1}) + b\\,u(x_i) + c\\,u(x_{i+1})$$\nThe stencil points are $\\{x_{i-1}, x_i, x_{i+1}\\}$ with grid spacings defined as $h_- = x_i - x_{i-1} > 0$ and $h_+ = x_{i+1} - x_i > 0$. The coefficients are determined by matching Taylor series expansions to ensure the formula is exact for any polynomial of degree up to $2$.\n\nWe start with the Taylor series expansions of $u(x_{i-1})$ and $u(x_{i+1})$ around the point $x_i$:\n$$u(x_{i-1}) = u(x_i - h_-) = u(x_i) - h_- u'(x_i) + \\frac{h_-^2}{2} u''(x_i) - \\frac{h_-^3}{6} u^{(3)}(x_i) + O(h_-^4)$$\n$$u(x_{i+1}) = u(x_i + h_+) = u(x_i) + h_+ u'(x_i) + \\frac{h_+^2}{2} u''(x_i) + \\frac{h_+^3}{6} u^{(3)}(x_i) + O(h_+^4)$$\n\nSubstituting these expansions into the right-hand side (RHS) of the approximation gives:\n$$\\text{RHS} = a\\left( u_i - h_- u'_i + \\frac{h_-^2}{2} u''_i - \\dots \\right) + b u_i + c\\left( u_i + h_+ u'_i + \\frac{h_+^2}{2} u''_i + \\dots \\right)$$\nwhere $u_i = u(x_i)$, $u'_i = u'(x_i)$, etc. Collecting terms by derivatives of $u$ at $x_i$:\n$$\\text{RHS} = u_i(a+b+c) + u'_i(-ah_- + ch_+) + u''_i\\left(a\\frac{h_-^2}{2} + c\\frac{h_+^2}{2}\\right) + u^{(3)}_i\\left(-a\\frac{h_-^3}{6} + c\\frac{h_+^3}{6}\\right) + \\dots$$\n\nTo make the scheme exact for constants ($u(x)=k$), linear functions ($u(x)=mx+k$), and quadratic functions ($u(x)=qx^2+mx+k$), the coefficients of $u_i$, $u'_i$, and $u''_i$ on the RHS must match those of the LHS, which is $u'_i$. This leads to the following system of linear equations for $a$, $b$, and $c$:\n1. Coefficient of $u_i$: $a + b + c = 0$\n2. Coefficient of $u'_i$: $-ah_- + ch_+ = 1$\n3. Coefficient of $u''_i$: $a h_-^2 + c h_+^2 = 0$\n\nFrom equation (3), we express $a$ in terms of $c$:\n$a = -c \\frac{h_+^2}{h_-^2}$\n\nSubstitute this into equation (2):\n$- \\left(-c \\frac{h_+^2}{h_-^2}\\right) h_- + c h_+ = 1 \\implies c \\frac{h_+^2}{h_-} + c h_+ = 1$\n$c \\left( \\frac{h_+^2 + h_- h_+}{h_-} \\right) = 1 \\implies c \\frac{h_+(h_+ + h_-)}{h_-} = 1$\nSolving for $c$ yields:\n$$c = \\frac{h_-}{h_+(h_+ + h_-)}$$\n\nNow, we solve for $a$:\n$$a = - \\left( \\frac{h_-}{h_+(h_+ + h_-)} \\right) \\frac{h_+^2}{h_-^2} = -\\frac{h_+}{h_-(h_+ + h_-)}$$\n\nFinally, from equation (1), we solve for $b$:\n$$b = -a - c = \\frac{h_+}{h_-(h_+ + h_-)} - \\frac{h_-}{h_+(h_+ + h_-)} = \\frac{h_+^2 - h_-^2}{h_- h_+(h_+ + h_-)} = \\frac{(h_+ - h_-)(h_+ + h_-)}{h_- h_+(h_+ + h_-)}$$\n$$b = \\frac{h_+ - h_-}{h_- h_+}$$\n\nThe truncation error, $\\tau$, is the difference between the finite difference operator and the true derivative operator. It is given by the first non-zero term in the Taylor expansion that was not cancelled. This is the term containing $u^{(3)}_i$:\n$$\\tau = \\left( -a \\frac{h_-^3}{6} + c \\frac{h_+^3}{6} \\right) u^{(3)}_i + O(h^3)$$\nwhere $h$ is a characteristic grid spacing, e.g., $h = \\max(h_-, h_+)$. Substituting the expressions for $a$ and $c$:\n$$\\tau = \\left[ - \\left(-\\frac{h_+}{h_-(h_+ + h_-)}\\right) \\frac{h_-^3}{6} + \\left(\\frac{h_-}{h_+(h_+ + h_-)}\\right) \\frac{h_+^3}{6} \\right] u^{(3)}_i + O(h^3)$$\n$$\\tau = \\left[ \\frac{h_+ h_-^2}{6(h_+ + h_-)} + \\frac{h_- h_+^2}{6(h_+ + h_-)} \\right] u^{(3)}_i + O(h^3)$$\n$$\\tau = \\frac{h_-h_+(h_- + h_+)}{6(h_+ + h_-)} u^{(3)}_i + O(h^3) = \\frac{h_- h_+}{6} u^{(3)}_i + O(h^3)$$\nThe leading-order truncation error is $\\frac{h_- h_+}{6} u^{(3)}(x_i)$. The scheme is second-order accurate since the error term is proportional to the product $h_- h_+$, which scales as $O(h^2)$.\n\n### Part 2: Application to Wall-Stretched Grid\n\nThe problem considers a stretched grid defined by the mapping $y(\\xi) = L(e^{\\beta \\xi} - 1)/(e^{\\beta} - 1)$ from a uniform computational coordinate $\\xi \\in [0,1]$. For small computational grid spacing $\\Delta\\xi$, the physical spacings are:\n$$h_- = y_i - y_{i-1} \\approx y'(\\xi_i) \\Delta\\xi$$\n$$h_+ = y_{i+1} - y_i \\approx y'(\\xi_i) \\Delta\\xi$$\nwhere $y'(\\xi) = dy/d\\xi$. The leading truncation error at point $y_i$ is $T_i = \\frac{h_- h_+}{6} u^{(3)}(y_i)$.\nSubstituting the approximations for $h_-$ and $h_+$:\n$$T_i \\approx \\frac{(y'(\\xi_i)\\Delta\\xi)^2}{6} u^{(3)}(y_i)$$\nThe problem asks to predict how the error scales with a local spacing $h_{\\text{loc}}(y_i)$. A natural definition for the local physical spacing is the arithmetic mean:\n$$h_{\\text{loc}}(y_i) = \\frac{h_- + h_+}{2}$$\nFrom a Taylor expansion of the mapping function, we have $h_{\\text{loc}}(y_i) = y'(\\xi_i)\\Delta\\xi + O(\\Delta\\xi^3)$.\nSince $h_-h_+ \\approx h_{\\text{loc}}^2$, the magnitude of the truncation error is:\n$$|T_i| \\approx \\frac{h_{\\text{loc}}(y_i)^2}{6} |u^{(3)}(y_i)|$$\nThis demonstrates that the pointwise error scales quadratically with the local grid spacing $h_{\\text{loc}}$. Consequently, the finite difference scheme is second-order accurate in terms of local grid spacing. Furthermore, since $h_{\\text{loc}}$ is proportional to $\\Delta\\xi$, the maximum error over the grid is expected to scale as $O(\\Delta\\xi^2)$, implying an empirical order of convergence $p=2$ with respect to the computational grid spacing.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the multi-part finite difference problem.\n    \"\"\"\n\n    def get_coeffs(h_minus, h_plus):\n        \"\"\"\n        Calculates the coefficients a, b, and c for the 3-point\n        non-uniform finite difference approximation of the first derivative.\n        \n        Args:\n            h_minus (float): Grid spacing x_i - x_{i-1}.\n            h_plus (float): Grid spacing x_{i+1} - x_i.\n            \n        Returns:\n            list: A list containing the coefficients [a, b, c].\n        \"\"\"\n        h_sum = h_minus + h_plus\n        a = -h_plus / (h_minus * h_sum)\n        b = (h_plus - h_minus) / (h_minus * h_plus)\n        c = h_minus / (h_plus * h_sum)\n        return [a, b, c]\n\n    # Test Case 1: Asymmetric stencil coefficients\n    h_minus1, h_plus1 = 0.07, 0.13\n    coeffs1 = get_coeffs(h_minus1, h_plus1)\n\n    # Test Case 2: Symmetric stencil coefficients\n    h_minus2, h_plus2 = 0.10, 0.10\n    coeffs2 = get_coeffs(h_minus2, h_plus2)\n\n    # Test Case 3: Local error to leading-term ratio\n    L3, N3, beta3, i3 = 1.0, 161, 4.0, 50\n    lam3 = -3.0 + 1j * np.pi\n\n    def y_map(xi, L, beta):\n        return L * (np.exp(beta * xi) - 1.0) / (np.exp(beta) - 1.0)\n\n    delta_xi3 = 1.0 / (N3 - 1)\n    xi_coords3 = np.array([i3 - 1, i3, i3 + 1]) * delta_xi3\n    y_coords3 = y_map(xi_coords3, L3, beta3)\n    y_im1, y_i, y_ip1 = y_coords3[0], y_coords3[1], y_coords3[2]\n\n    h_minus3 = y_i - y_im1\n    h_plus3 = y_ip1 - y_i\n    coeffs3 = get_coeffs(h_minus3, h_plus3)\n    a3, b3, c3 = coeffs3[0], coeffs3[1], coeffs3[2]\n\n    u_vals = np.real(np.exp(lam3 * np.array([y_im1, y_i, y_ip1])))\n    \n    u_num_prime = a3 * u_vals[0] + b3 * u_vals[1] + c3 * u_vals[2]\n    u_exact_prime = np.real(lam3 * np.exp(lam3 * y_i))\n    u_exact_ppp = np.real(lam3**3 * np.exp(lam3 * y_i))\n\n    observed_error = u_num_prime - u_exact_prime\n    predicted_leading_error = (h_minus3 * h_plus3 / 6.0) * u_exact_ppp\n    \n    r = observed_error / predicted_leading_error\n\n    # Test Case 4: Empirical order of accuracy\n    def compute_max_error(N, beta, L, lam):\n        delta_xi = 1.0 / (N - 1)\n        xi_grid = np.linspace(0, 1, N)\n        y_grid = y_map(xi_grid, L, beta)\n        \n        errors = []\n        for i in range(1, N - 1):\n            y_im1, y_i, y_ip1 = y_grid[i - 1], y_grid[i], y_grid[i + 1]\n            h_minus = y_i - y_im1\n            h_plus = y_ip1 - y_i\n\n            a, b, c = get_coeffs(h_minus, h_plus)\n            \n            u_vals = np.imag(np.exp(lam * np.array([y_im1, y_i, y_ip1])))\n            \n            u_num_prime = a * u_vals[0] + b * u_vals[1] + c * u_vals[2]\n            u_exact_prime = np.imag(lam * np.exp(lam * y_i))\n            \n            errors.append(np.abs(u_num_prime - u_exact_prime))\n        \n        return np.max(errors)\n\n    L4, beta4 = 1.0, 3.0\n    N1, N2 = 81, 161\n    lam4 = -2.0 + 3.0j\n\n    error_N1 = compute_max_error(N1, beta4, L4, lam4)\n    error_N2 = compute_max_error(N2, beta4, L4, lam4)\n\n    delta_xi_N1 = 1.0 / (N1 - 1)\n    delta_xi_N2 = 1.0 / (N2 - 1)\n    \n    p = np.log(error_N2 / error_N1) / np.log(delta_xi_N2 / delta_xi_N1)\n\n    # Assemble final results and print in the required format\n    results = [coeffs1, coeffs2, r, p]\n    \n    # Python's default str() for a list includes brackets and spaces,\n    # which is needed for the requested output format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "The theoretical order of accuracy derived with pen and paper assumes infinite precision arithmetic, a luxury we do not have on digital computers. This final practice explores the practical consequences of implementing high-order schemes using finite-precision, floating-point numbers . You will analyze how minute rounding errors in the stored coefficients of a scheme can disrupt the delicate cancellation of error terms, leading to a degradation of the scheme's formal accuracy. This exercise provides a crucial insight into the robustness of numerical methods and the interplay between algorithm design and computer architecture.",
            "id": "3370218",
            "problem": "In computational fluid dynamics (CFD), spatial derivatives of smooth fluxes are often approximated on uniform grids using finite differences designed by Taylor series expansion. Consider a one-dimensional uniform grid with spacing $h$, and the antisymmetric $7$-point central difference operator\n$$\nD_h f(x_i) \\equiv \\frac{1}{h} \\sum_{k=-3}^{3} a_k f(x_i + k h),\n$$\nwith $a_0 = 0$ and $a_{-k} = - a_k$ for $k = 1, 2, 3$. The nominal design target is a sixth-order accurate approximation to $f'(x_i)$, achieved by enforcing moment conditions arising from the Taylor expansion of $f(x_i + k h)$ about $x_i$.\n\nStarting from the Taylor series expansion and the antisymmetry constraint, derive the moment conditions necessary for sixth-order accuracy, solve for the exact positive-side coefficients $a_1, a_2, a_3$, and then analyze the effect of floating-point (FP) rounding when the precomputed positive-side coefficients are stored to four significant figures as $a_1^{\\mathrm{fp}} = 0.7500$, $a_2^{\\mathrm{fp}} = -0.1500$, and $a_3^{\\mathrm{fp}} = 0.01667$, with $a_{-k}^{\\mathrm{fp}} = - a_k^{\\mathrm{fp}}$.\n\nUsing these FP-rounded coefficients, compute the coefficient multiplying the $h^2 f^{(3)}(x_i)$ term in the leading spurious truncation error introduced by the rounding. That is, determine the scalar $C$ such that the dominant rounding-induced truncation error term takes the form $C\\, h^2 f^{(3)}(x_i) + \\text{higher-order terms}$. Express the final scalar $C$ as a pure number in standard scientific notation. If numerical rounding is needed, round your answer to four significant figures.",
            "solution": "The problem is validated as follows:\n1.  **Extract Givens**:\n    -   Grid: One-dimensional uniform grid with spacing $h$.\n    -   Operator: The antisymmetric $7$-point central difference operator is defined as $D_h f(x_i) \\equiv \\frac{1}{h} \\sum_{k=-3}^{3} a_k f(x_i + k h)$.\n    -   Antisymmetry constraints: $a_0 = 0$ and $a_{-k} = -a_k$ for $k = 1, 2, 3$.\n    -   Design target: Sixth-order accurate approximation to the first derivative, $f'(x_i)$.\n    -   Floating-point (FP) coefficients: $a_1^{\\mathrm{fp}} = 0.7500$, $a_2^{\\mathrm{fp}} = -0.1500$, $a_3^{\\mathrm{fp}} = 0.01667$. The antisymmetry $a_{-k}^{\\mathrm{fp}} = -a_k^{\\mathrm{fp}}$ is maintained.\n    -   Task: Determine the scalar coefficient $C$ of the term $C\\, h^2 f^{(3)}(x_i)$ in the truncation error that arises from using the FP-rounded coefficients.\n\n2.  **Validate Using Extracted Givens**:\n    -   The problem is scientifically grounded in the field of numerical analysis, specifically the study of finite difference methods in computational fluid dynamics.\n    -   The problem is well-posed, providing sufficient information and clear constraints to determine a unique value for the coefficient $C$.\n    -   The language is objective and mathematically precise.\n    -   There are no scientific or factual unsoundness, no missing information, no contradictions, and the setup is realistic. Rounding errors are a practical concern in computation.\n\n3.  **Verdict and Action**: The problem is valid. A full solution will be provided.\n\nThe core of the method is to analyze the truncation error of the operator $D_h f(x_i)$ by expanding each term $f(x_i + k h)$ in a Taylor series about the point $x_i$. The Taylor series expansion is:\n$$\nf(x_i + kh) = \\sum_{n=0}^{\\infty} \\frac{(kh)^n}{n!} f^{(n)}(x_i)\n$$\nwhere $f^{(n)}(x_i)$ is the $n$-th derivative of $f(x)$ evaluated at $x_i$.\n\nSubstituting this expansion into the definition of the operator $D_h f(x_i)$:\n$$\nD_h f(x_i) = \\frac{1}{h} \\sum_{k=-3}^{3} a_k \\left( \\sum_{n=0}^{\\infty} \\frac{(kh)^n}{n!} f^{(n)}(x_i) \\right)\n$$\nWe can swap the order of summation:\n$$\nD_h f(x_i) = \\frac{1}{h} \\sum_{n=0}^{\\infty} \\left( \\sum_{k=-3}^{3} a_k (kh)^n \\right) \\frac{f^{(n)}(x_i)}{n!}\n$$\nThis simplifies to:\n$$\nD_h f(x_i) = \\sum_{n=0}^{\\infty} h^{n-1} \\left( \\sum_{k=-3}^{3} k^n a_k \\right) \\frac{f^{(n)}(x_i)}{n!}\n$$\nLet us define the moments of the coefficients $a_k$ as $M_n = \\sum_{k=-3}^{3} k^n a_k$. The operator can then be written as:\n$$\nD_h f(x_i) = \\frac{M_0}{h}f^{(0)}(x_i) + M_1 f^{(1)}(x_i) + \\frac{M_2}{2!} h f^{(2)}(x_i) + \\frac{M_3}{3!} h^2 f^{(3)}(x_i) + \\dots\n$$\nThe problem specifies the antisymmetry constraints $a_0 = 0$ and $a_{-k} = -a_k$. Let's analyze the moments $M_n$ under these constraints:\n$$\nM_n = \\sum_{k=-3}^{3} k^n a_k = 0^n a_0 + \\sum_{k=1}^{3} (k^n a_k + (-k)^n a_{-k})\n$$\nSince $a_0 = 0$ and $a_{-k} = -a_k$:\n$$\nM_n = \\sum_{k=1}^{3} (k^n a_k - (-k)^n a_k) = \\sum_{k=1}^{3} a_k (k^n - (-1)^n k^n)\n$$\nIf $n$ is an even integer, $n = 2p$, then $(-1)^n = 1$, and $k^n - (-1)^n k^n = k^{2p} - k^{2p} = 0$. Thus, $M_n = 0$ for all even $n$.\nIf $n$ is an odd integer, $n = 2p+1$, then $(-1)^n = -1$, and $k^n - (-1)^n k^n = k^{2p+1} - (-k^{2p+1}) = 2k^{2p+1}$. Thus, $M_n = 2 \\sum_{k=1}^{3} k^n a_k$ for all odd $n > 0$. And $M_0 = 0$.\n\nApplying this to the operator expansion, all terms with even derivatives ($f^{(0)}, f^{(2)}, f^{(4)}, \\dots$) vanish automatically.\n$$\nD_h f(x_i) = M_1 f^{(1)}(x_i) + \\frac{M_3}{3!} h^2 f^{(3)}(x_i) + \\frac{M_5}{5!} h^4 f^{(5)}(x_i) + \\frac{M_7}{7!} h^6 f^{(7)}(x_i) + \\dots\n$$\nThe truncation error is $T.E. = D_h f(x_i) - f'(x_i)$.\n$$\nT.E. = (M_1 - 1)f'(x_i) + \\frac{M_3}{6} h^2 f^{(3)}(x_i) + \\frac{M_5}{120} h^4 f^{(5)}(x_i) + \\frac{M_7}{720} h^6 f^{(7)}(x_i) + O(h^8)\n$$\nFor the operator to be sixth-order accurate, the coefficients of $f'(x_i)$, $h^2 f^{(3)}(x_i)$, and $h^4 f^{(5)}(x_i)$ in the error must be zero. This imposes the following moment conditions on the exact coefficients $a_k$:\n1. $M_1 - 1 = 0 \\implies M_1 = 1 \\implies 2(a_1 + 2a_2 + 3a_3) = 1$\n2. $M_3 = 0 \\implies 2(a_1 + 8a_2 + 27a_3) = 0$\n3. $M_5 = 0 \\implies 2(a_1 + 32a_2 + 243a_3) = 0$\n\nSolving this system yields the exact coefficients: $a_1 = \\frac{3}{4}$, $a_2 = -\\frac{3}{20}$, and $a_3 = \\frac{1}{60}$.\nAs decimals, these are $a_1 = 0.75$, $a_2 = -0.15$, and $a_3 = 0.01\\overline{6}$.\n\nThe problem states that the precomputed coefficients are stored as $a_1^{\\mathrm{fp}} = 0.7500$, $a_2^{\\mathrm{fp}} = -0.1500$, and $a_3^{\\mathrm{fp}} = 0.01667$. Comparing these to the exact values, we see that $a_1^{\\mathrm{fp}}$ and $a_2^{\\mathrm{fp}}$ are exact, while $a_3^{\\mathrm{fp}}$ is a rounded version of $a_3$.\n\nWe are asked to find the coefficient $C$ of the $h^2 f^{(3)}(x_i)$ term in the resulting truncation error. This coefficient is $\\frac{M_3^{\\mathrm{fp}}}{6}$, where $M_3^{\\mathrm{fp}}$ is the third moment calculated with the floating-point coefficients.\n$$\nM_3^{\\mathrm{fp}} = 2 \\sum_{k=1}^{3} k^3 a_k^{\\mathrm{fp}} = 2(1^3 a_1^{\\mathrm{fp}} + 2^3 a_2^{\\mathrm{fp}} + 3^3 a_3^{\\mathrm{fp}})\n$$\n$$\nM_3^{\\mathrm{fp}} = 2(a_1^{\\mathrm{fp}} + 8 a_2^{\\mathrm{fp}} + 27 a_3^{\\mathrm{fp}})\n$$\nSubstituting the given FP values:\n$$\nM_3^{\\mathrm{fp}} = 2(0.7500 + 8(-0.1500) + 27(0.01667))\n$$\n$$\nM_3^{\\mathrm{fp}} = 2(0.7500 - 1.2000 + 0.45009)\n$$\n$$\nM_3^{\\mathrm{fp}} = 2(-0.4500 + 0.45009)\n$$\n$$\nM_3^{\\mathrm{fp}} = 2(0.00009) = 0.00018\n$$\nThe condition $M_3 = 0$ is violated due to the rounding of $a_3$. The coefficient $C$ of the spurious error term $C h^2 f^{(3)}(x_i)$ is given by:\n$$\nC = \\frac{M_3^{\\mathrm{fp}}}{3!} = \\frac{M_3^{\\mathrm{fp}}}{6}\n$$\n$$\nC = \\frac{0.00018}{6} = 0.00003\n$$\nThe problem requires this scalar to be expressed in standard scientific notation, rounded to four significant figures if necessary. The result $0.00003$ is exact based on the given FP numbers. To present it with four significant figures, we write:\n$$\nC = 3.000 \\times 10^{-5}\n$$\nThis result indicates that rounding the last coefficient, even by a small amount, degrades the scheme's order of accuracy from sixth-order to second-order by introducing a non-zero $O(h^2)$ truncation error term.",
            "answer": "$$\\boxed{3.000 \\times 10^{-5}}$$"
        }
    ]
}