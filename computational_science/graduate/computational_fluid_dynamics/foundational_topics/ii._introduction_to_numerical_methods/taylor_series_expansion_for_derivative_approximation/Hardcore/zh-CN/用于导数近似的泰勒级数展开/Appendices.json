{
    "hands_on_practices": [
        {
            "introduction": "在计算流体力学中，精确地近似导数是捕捉流动物理（如粘性效应和波传播）的关键。本练习将带您实践一项核心技能：使用泰勒级数展开来系统地构建高阶有限差分格式。通过为一个对称的五点模板推导一个四阶精确的二阶导数公式，您将深入理解如何通过代数操作消除低阶截断误差项，从而实现更高的数值精度。",
            "id": "3370259",
            "problem": "在计算流体动力学（CFD）中，空间导数的高阶精度离散化对于以最小的数值耗散解析粘性效应至关重要。考虑一个光滑标量场 $f(x)$，例如，它代表一维层流中的一个速度分量。在纳维-斯托克斯方程粘性项的离散化中，需要逐点二阶导数 $f''(x)$。假设在对称位置 $x-2h$、$x-h$、$x$、$x+h$ 和 $x+2h$ 对 $f$ 进行采样，其中 $h>0$ 是均匀的网格间距。\n\n从 $f(x\\pm h)$ 和 $f(x\\pm 2h)$ 关于 $x$ 的泰勒级数展开出发，构建在模板 $\\{x-2h, x-h, x, x+h, x+2h\\}$ 上采样值的对称线性组合，以得到 $f''(x)$ 的一个四阶精度近似。然后，通过将泰勒级数展开到比所达到的精度高一阶，计算主截断误差项，并用 $f^{(6)}(x)$ 和 $h$ 显式表达。\n\n您的最终答案必须包含：\n1.  一个单一的闭式解析表达式，给出使用给定模板的 $f''(x)$ 的四阶精度有限差分公式。\n2.  一个单一的闭式解析表达式，给出与 $f^{(6)}(x)$ 成正比的主截断误差项。\n\n提供这两个表达式。不需要进行数值舍入，也不需要单位。",
            "solution": "用户希望使用一个五点对称模板来推导二阶导数 $f''(x)$ 的四阶精度有限差分近似。\n\n### 步骤 1：提取已知条件\n- 待微分的函数是一个光滑标量场 $f(x)$。\n- 待近似的导数是二阶导数 $f''(x)$。\n- 点的模板是对称的：$\\{x-2h, x-h, x, x+h, x+2h\\}$。\n- $h>0$ 是均匀的网格间距。\n- 所用的方法是基于泰勒级数展开，构建模板点上函数值的线性组合。\n- 对 $f''(x)$ 近似的所需精度阶数为四阶，即截断误差为 $O(h^4)$。\n- 最终结果必须包括有限差分公式及其主截断误差项。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是数值分析领域的一项标准和基础任务，尤其是在计算流体动力学中的应用。问题是适定的，提供了所有必要信息（模板、所需导数、精度阶数）来唯一确定线性组合的系数和主误差项。语言客观、精确。该问题没有任何科学或逻辑上的缺陷、矛盾或歧义。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整解答。\n\n### 有限差分公式和截断误差的推导\n\n我们寻求一个形式如下的 $f''(x)$ 的近似：\n$$\nf''(x) \\approx \\frac{c_{-2}f(x-2h) + c_{-1}f(x-h) + c_0f(x) + c_1f(x+h) + c_2f(x+2h)}{k}\n$$\n对于对称模板上的对称近似，我们期望系数也是对称的，即 $c_{-i} = c_i$。此外，对于近似二阶导数，缩放因子 $k$ 通常是 $h^2$。我们定义系数为 $c_0$、$c_1=c_{-1}$ 和 $c_2=c_{-2}$。该近似，记作 $D_h^2 f(x)$，是：\n$$\nD_h^2 f(x) = \\frac{c_2 f(x-2h) + c_1 f(x-h) + c_0 f(x) + c_1 f(x+h) + c_2 f(x+2h)}{h^2}\n$$\n这可以重写为：\n$$\nD_h^2 f(x) = \\frac{c_2[f(x+2h) + f(x-2h)] + c_1[f(x+h) + f(x-h)] + c_0 f(x)}{h^2}\n$$\n为了确定系数 $c_0$、$c_1$ 和 $c_2$，我们使用 $f(x \\pm h)$ 和 $f(x \\pm 2h)$ 关于点 $x$ 的泰勒级数展开。由于最终的误差项涉及 $f^{(6)}(x)$，我们必须将展开式推进到足够高的阶数才能捕捉到这一项。$f(x+kh)$ 和 $f(x-kh)$ 的组合方便地消除了所有奇数阶导数项。\n\n这些和的展开式为：\n$$\nf(x+h) + f(x-h) = 2 \\sum_{n=0}^{\\infty} \\frac{h^{2n}}{(2n)!} f^{(2n)}(x) = 2f(x) + h^2 f''(x) + \\frac{h^4}{12}f^{(4)}(x) + \\frac{h^6}{360}f^{(6)}(x) + O(h^8)\n$$\n$$\nf(x+2h) + f(x-2h) = 2 \\sum_{n=0}^{\\infty} \\frac{(2h)^{2n}}{(2n)!} f^{(2n)}(x) = 2f(x) + 4h^2 f''(x) + \\frac{16h^4}{12}f^{(4)}(x) + \\frac{64h^6}{360}f^{(6)}(x) + O(h^8)\n$$\n简化第二个展开式中的分数：\n$$\nf(x+2h) + f(x-2h) = 2f(x) + 4h^2 f''(x) + \\frac{4h^4}{3}f^{(4)}(x) + \\frac{8h^6}{45}f^{(6)}(x) + O(h^8)\n$$\n现在，将这些展开式代入 $D_h^2 f(x)$ 的表达式中：\n\\begin{align*}\nh^2 D_h^2 f(x) = c_2\\left[2f(x) + 4h^2 f''(x) + \\frac{4}{3}h^4f^{(4)}(x) + \\frac{8}{45}h^6f^{(6)}(x) + \\dots\\right] \\\\\n+ c_1\\left[2f(x) + h^2 f''(x) + \\frac{1}{12}h^4f^{(4)}(x) + \\frac{1}{360}h^6f^{(6)}(x) + \\dots\\right] \\\\\n+ c_0 f(x)\n\\end{align*}\n按 $f(x)$ 的导数对各项进行分组：\n\\begin{align*}\nh^2 D_h^2 f(x) = f(x) [2c_2 + 2c_1 + c_0] \\\\\n+ f''(x) h^2 [4c_2 + c_1] \\\\\n+ f^{(4)}(x) h^4 \\left[\\frac{4}{3}c_2 + \\frac{1}{12}c_1\\right] \\\\\n+ f^{(6)}(x) h^6 \\left[\\frac{8}{45}c_2 + \\frac{1}{360}c_1\\right] \\\\\n+ O(h^8)\n\\end{align*}\n除以 $h^2$，我们得到：\n$$\nD_h^2 f(x) = \\frac{f(x)}{h^2}[2c_2+2c_1+c_0] + f''(x)[4c_2+c_1] + f^{(4)}(x)h^2\\left[\\frac{4}{3}c_2+\\frac{1}{12}c_1\\right] + f^{(6)}(x)h^4\\left[\\frac{8}{45}c_2+\\frac{1}{360}c_1\\right] + O(h^6)\n$$\n为了使 $D_h^2 f(x)$ 成为 $f''(x)$ 的四阶精度近似，我们需要满足以下条件：\n1. $f(x)$ 的系数必须为 $0$：$2c_2 + 2c_1 + c_0 = 0$。\n2. $f''(x)$ 的系数必须为 $1$：$4c_2 + c_1 = 1$。\n3. 为了达到至少四阶精度，$h^2$ 项（包含 $f^{(4)}(x)$）的系数必须为 $0$：$\\frac{4}{3}c_2 + \\frac{1}{12}c_1 = 0 \\implies 16c_2 + c_1 = 0$。\n\n我们现在得到了一个关于三个未知系数的三元线性方程组：\n\\begin{cases}\n2c_2 + 2c_1 + c_0 = 0 \\\\\n4c_2 + c_1 = 1 \\\\\n16c_2 + c_1 = 0\n\\end{cases}\n从第三个方程，我们有 $c_1 = -16c_2$。\n将其代入第二个方程：$4c_2 + (-16c_2) = 1 \\implies -12c_2 = 1 \\implies c_2 = -\\frac{1}{12}$。\n现在我们可以求出 $c_1$：$c_1 = -16\\left(-\\frac{1}{12}\\right) = \\frac{16}{12} = \\frac{4}{3}$。\n最后，使用第一个方程求出 $c_0$：$c_0 = -2c_2 - 2c_1 = -2\\left(-\\frac{1}{12}\\right) - 2\\left(\\frac{4}{3}\\right) = \\frac{1}{6} - \\frac{8}{3} = \\frac{1}{6} - \\frac{16}{6} = -\\frac{15}{6} = -\\frac{5}{2}$。\n\n系数为 $c_2 = -\\frac{1}{12}$，$c_1 = \\frac{4}{3}$ 和 $c_0 = -\\frac{5}{2}$。\n$f''(x)$ 的有限差分公式为：\n$$\nf''(x) \\approx \\frac{-\\frac{1}{12}f(x-2h) + \\frac{4}{3}f(x-h) - \\frac{5}{2}f(x) + \\frac{4}{3}f(x+h) - \\frac{1}{12}f(x+2h)}{h^2}\n$$\n为了消除分子中的分数，我们将分子和分母同乘以 $12$：\n$$\nf''(x) \\approx \\frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2}\n$$\n\n截断误差 $T$ 由 $T = D_h^2 f(x) - f''(x)$ 给出。利用推导出的系数，涉及 $f(x)$、$f''(x)$ 和 $f^{(4)}(x)$ 的项被正确设置。主误差项是展开式中的第一个非零项，即包含 $f^{(6)}(x)$ 的项：\n$$\nT = f^{(6)}(x)h^4\\left[\\frac{8}{45}c_2 + \\frac{1}{360}c_1\\right] + O(h^6)\n$$\n代入 $c_1$ 和 $c_2$ 的值：\n$$\nT = f^{(6)}(x)h^4\\left[\\frac{8}{45}\\left(-\\frac{1}{12}\\right) + \\frac{1}{360}\\left(\\frac{4}{3}\\right)\\right] + O(h^6)\n$$\n$$\nT = f^{(6)}(x)h^4\\left[-\\frac{8}{540} + \\frac{4}{1080}\\right] = f^{(6)}(x)h^4\\left[-\\frac{16}{1080} + \\frac{4}{1080}\\right] = f^{(6)}(x)h^4\\left(-\\frac{12}{1080}\\right)\n$$\n简化分数 $-\\frac{12}{1080} = -\\frac{1}{90}$。\n因此，主截断误差项是：\n$$\nT = -\\frac{h^4}{90}f^{(6)}(x)\n$$\n该近似确实是四阶精度的，因为误差为 $O(h^4)$。\n\n所需的两个表达式是：\n1. $f''(x)$ 的有限差分公式：$\\frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2}$\n2. 主截断误差项：$-\\frac{h^4}{90}f^{(6)}(x)$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2}, \\quad -\\frac{h^4}{90}f^{(6)}(x) \\end{pmatrix}}$$"
        },
        {
            "introduction": "当处理非线性守恒律时，通量函数通常是守恒变量的复合函数，例如 $F(x) = f(g(x))$。一个常见的误区是认为离散化的链式法则（即 $f'(g(x_i)) D_c g(x_i)$）等同于对复合函数直接进行离散化（即 $D_c F(x_i)$）。本练习将引导您使用泰勒级数来精确量化这两者之间的差异，即“离散链式法则误差”，并揭示其对数值解精度的影响。",
            "id": "3370227",
            "problem": "考虑一个一维均匀网格，其节点为 $x_i = x_0 + i h$，常数间距为 $h > 0$，该网格用于计算流体力学 (CFD)。令 $g : \\mathbb{R} \\to \\mathbb{R}$ 为一个足够光滑的标量场，令 $f : \\mathbb{R} \\to \\mathbb{R}$ 为一个足够光滑的非线性通量函数。定义 $F(x) = f(g(x))$。目标是在 $x_i$ 处近似计算 $\\partial_x F(x)$。\n\n从导数的基本定义和关于 $x_i$ 的泰勒级数展开出发，解决以下问题：\n\n1) 在网格上使用二阶中心差分，两个离散近似\n$$D_c F(x_i) \\equiv \\frac{F(x_{i+1}) - F(x_{i-1})}{2 h} \\quad \\text{与} \\quad f'(g(x_i))\\,D_c g(x_i) \\equiv f'(g(x_i))\\,\\frac{g(x_{i+1}) - g(x_{i-1})}{2 h}$$\n当 $h \\to 0$ 时都收敛于 $\\partial_x F(x_i)$，但在有限的 $h$ 下它们并不相等。使用 $g(x)$ 关于 $x_i$ 的泰勒级数展开，然后将 $f(g(x))$ 关于点 $g(x_i)$ 展开，推导离散链式法则误差的主阶表达式（截至并包括 $h^2$ 阶项）\n$$E_i \\equiv D_c F(x_i) - f'(g(x_i))\\,D_c g(x_i).$$\n将 $E_i$ 表示为 $f$ 对其自变量在 $g(x_i)$ 处的导数以及 $g$ 对 $x$ 在 $x_i$ 处的导数的函数。\n\n2) 提出一个对称的五点中心线性模板\n$$\\mathcal{D}_h[F]_i \\equiv \\sum_{m=-2}^{2} c_m\\,F(x_{i+m})$$\n以近似 $\\partial_x F(x_i)$，其中系数 $c_m$ 依赖于 $h$，并且选择这些系数以使该模板与连续导数一致，并消除在对一般解析函数 $f$ 和光滑函数 $g$ 的 $\\mathcal{D}_h[F]_i$ 进行泰勒展开时出现的所有 $\\mathcal{O}(h^2)$ 阶截断误差项。确定系数 $c_{-2}, c_{-1}, c_0, c_1, c_2$ 关于 $h$ 的闭式表达式。\n\n你的最终答案应该是这五个系数 $c_{-2}, c_{-1}, c_0, c_1, c_2$ 的行矩阵，用 $h$ 表示。",
            "solution": "用户提供了一个数值分析问题，具体涉及复合函数导数的有限差分近似，这是计算流体力学 (CFD) 中的一个常见任务。\n\n首先，我将根据指定协议验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **网格：** 一个一维均匀网格，节点为 $x_i = x_0 + i h$，常数间距为 $h > 0$。\n- **函数：** $g : \\mathbb{R} \\to \\mathbb{R}$ 是一个足够光滑的标量场。$f : \\mathbb{R} \\to \\mathbb{R}$ 是一个足够光滑的非线性通量函数。\n- **复合函数：** $F(x) = f(g(x))$。\n- **目标：** 在网格节点 $x_i$ 处近似计算导数 $\\partial_x F(x)$。\n- **第 1 部分任务：** 推导离散链式法则误差 $E_i \\equiv D_c F(x_i) - f'(g(x_i))\\,D_c g(x_i)$ 的主阶表达式。推导应进行到并包括 $h^2$ 阶项。\n- **离散算子：**\n  - $F$ 的二阶中心差分：$D_c F(x_i) \\equiv \\frac{F(x_{i+1}) - F(x_{i-1})}{2 h}$。\n  - $g$ 的二阶中心差分：$D_c g(x_i) \\equiv \\frac{g(x_{i+1}) - g(x_{i-1})}{2 h}$。\n- **第 2 部分任务：** 确定对称五点中心线性模板 $\\mathcal{D}_h[F]_i \\equiv \\sum_{m=-2}^{2} c_m\\,F(x_{i+m})$ 的系数 $c_m$，该模板近似 $\\partial_x F(x_i)$，使得模板是一致的，并且所有 $\\mathcal{O}(h^2)$ 阶截断误差项都被消除。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题经过严格验证。\n- **科学依据：** 该问题牢固地植根于数值分析这一数学领域，特别是有限差分理论。泰勒级数展开是分析此类格式精度的基本工具。离散链式法则和相关的对易误差的概念是守恒律数值解中的一个标准课题。该问题在科学上和数学上都是合理的。\n- **适定性：** 问题是适定的。第 1 部分要求进行具体推导，基于标准泰勒级数微积分，其结果是唯一的。第 2 部分要求确定具有特定属性（5 点、对称、4 阶精度）的有限差分模板的系数。这会导出一个定义明确的系数线性方程组，该方程组有唯一解。\n- **客观性：** 问题以精确、客观的数学语言陈述。\n- **完整性和一致性：** 问题提供了所有必要的定义和约束。“$f$ 和 $g$ 足够光滑”的假设是标准且恰当的，因为它保证了泰勒级数展开所需的更高阶导数的存在性。\n- **其他缺陷：** 问题没有表现出任何其他缺陷，例如不切实际、结构不良、微不足道或无法验证。这是数值方法中的一个标准的、非平凡的练习题。\n\n### 步骤 3：结论与行动\n问题是 **有效的**。将提供完整解答。\n\n### 解答\n\n问题分两部分解决。为清晰起见，我们将 $g$ 关于 $x$ 在 $x_i$ 处的导数记为 $g_i' = \\frac{dg}{dx}(x_i)$，$g_i'' = \\frac{d^2g}{dx^2}(x_i)$ 等。类似地， $f$ 关于其自变量在 $g(x_i)$ 处的导数将记为 $f_i' = \\frac{df}{dg}(g(x_i))$，$f_i'' = \\frac{d^2f}{dg^2}(g(x_i))$ 等。\n\n**第 1 部分：离散链式法则误差的推导**\n\n误差定义为 $E_i \\equiv D_c F(x_i) - f_i'\\,D_c g(x_i)$。我们将使用泰勒级数将每一项展开到所需的阶数。\n\n首先，我们展开算子 $D_c g(x_i)$：\n$g(x)$ 在 $x_i$ 附近的泰勒级数展开为：\n$$g(x_{i+1}) = g(x_i+h) = g(x_i) + h g_i' + \\frac{h^2}{2} g_i'' + \\frac{h^3}{6} g_i''' + \\mathcal{O}(h^4)$$\n$$g(x_{i-1}) = g(x_i-h) = g(x_i) - h g_i' + \\frac{h^2}{2} g_i'' - \\frac{h^3}{6} g_i''' + \\mathcal{O}(h^4)$$\n代入 $D_c g(x_i)$ 的定义中：\n$$D_c g(x_i) = \\frac{g(x_{i+1}) - g(x_{i-1})}{2h} = \\frac{(g(x_i) + h g_i' + \\frac{h^2}{2} g_i'' + \\frac{h^3}{6} g_i''') - (g(x_i) - h g_i' + \\frac{h^2}{2} g_i'' - \\frac{h^3}{6} g_i''')}{2h} + \\mathcal{O}(h^3)$$\n$$D_c g(x_i) = \\frac{2 h g_i' + \\frac{h^3}{3} g_i'''}{2h} + \\mathcal{O}(h^3) = g_i' + \\frac{h^2}{6} g_i''' + \\mathcal{O}(h^3)$$\n因此，误差表达式中的第二项为：\n$$f_i'\\,D_c g(x_i) = f_i'(g_i' + \\frac{h^2}{6} g_i''') + \\mathcal{O}(h^3) = f_i'g_i' + \\frac{h^2}{6} f_i'g_i''' + \\mathcal{O}(h^3)$$\n\n接下来，我们分析项 $D_c F(x_i)$。真实导数为 $\\partial_x F(x_i) = \\frac{d}{dx}f(g(x))|_{x=x_i} = f_i' g_i'$。已知中心差分算子的截断误差取决于其作用函数的三阶导数。$F(x)$ 的三阶导数为：\n$$F'(x) = f'(g(x)) g'(x)$$\n$$F''(x) = f''(g(x)) (g'(x))^2 + f'(g(x)) g''(x)$$\n$$F'''(x) = f'''(g(x)) (g'(x))^3 + 3 f''(g(x)) g'(x) g''(x) + f'(g(x)) g'''(x)$$\n中心差分算子的泰勒展开为：\n$$D_c F(x_i) = F'(x_i) + \\frac{h^2}{6} F'''(x_i) + \\mathcal{O}(h^4)$$\n代入 $F'(x_i)$ 和 $F'''(x_i)$ 的表达式：\n$$D_c F(x_i) = (f_i' g_i') + \\frac{h^2}{6} (f_i''' (g_i')^3 + 3 f_i'' g_i' g_i'' + f_i' g_i''') + \\mathcal{O}(h^4)$$\n$$D_c F(x_i) = f_i' g_i' + \\frac{h^2}{6} f_i' g_i''' + \\frac{h^2}{2} f_i'' g_i' g_i'' + \\frac{h^2}{6} f_i''' (g_i')^3 + \\mathcal{O}(h^4)$$\n\n最后，我们计算误差 $E_i = D_c F(x_i) - f_i'\\,D_c g(x_i)$：\n$$E_i = \\left( f_i' g_i' + \\frac{h^2}{6} f_i' g_i''' + \\frac{h^2}{2} f_i'' g_i' g_i'' + \\frac{h^2}{6} f_i''' (g_i')^3 \\right) - \\left( f_i'g_i' + \\frac{h^2}{6} f_i'g_i''' \\right) + \\mathcal{O}(h^4)$$\n项 $f_i' g_i'$ 和 $\\frac{h^2}{6} f_i' g_i'''$ 相互抵消。主阶误差为：\n$$E_i = \\frac{h^2}{2} f_i'' g_i' g_i'' + \\frac{h^2}{6} f_i''' (g_i')^3 + \\mathcal{O}(h^4)$$\n误差的表达式，截至并包括 $h^2$ 阶项，为：\n$$E_i = h^2 \\left( \\frac{1}{2} \\frac{d^2f}{dg^2}(g(x_i)) \\frac{dg}{dx}(x_i) \\frac{d^2g}{dx^2}(x_i) + \\frac{1}{6} \\frac{d^3f}{dg^3}(g(x_i)) \\left(\\frac{dg}{dx}(x_i)\\right)^3 \\right)$$\n这个由微分和离散化不可交换性引起的误差，在非线性现象的数值模拟中是一个关键问题。\n\n**第 2 部分：五点模板系数的确定**\n\n我们寻求模板 $\\mathcal{D}_h[F]_i = \\sum_{m=-2}^{2} c_m\\,F(x_{i+m})$ 的系数 $c_m$，使得 $\\mathcal{D}_h[F]_i = \\partial_x F(x_i) + \\mathcal{O}(h^4)$。这是一个四阶精度格式。我们将 $F(x_{i+m}) = F(x_i+mh)$ 在 $x_i$ 处进行泰勒展开：\n$$F(x_{i+m}) = F(x_i) + (mh)F'(x_i) + \\frac{(mh)^2}{2!}F''(x_i) + \\frac{(mh)^3}{3!}F'''(x_i) + \\frac{(mh)^4}{4!}F^{(4)}(x_i) + \\dots$$\n将其代入模板定义中：\n$$\\mathcal{D}_h[F]_i = \\sum_{m=-2}^{2} c_m \\left( F_i + mh F'_i + \\frac{m^2h^2}{2} F''_i + \\frac{m^3h^3}{6} F'''_i + \\frac{m^4h^4}{24} F^{(4)}_i + \\mathcal{O}(h^5) \\right)$$\n按 $F$ 的导数对各项进行分组：\n$$\\mathcal{D}_h[F]_i = F_i \\left(\\sum c_m\\right) + F'_i \\left(h \\sum m c_m\\right) + F''_i \\left(\\frac{h^2}{2} \\sum m^2 c_m\\right) + F'''_i \\left(\\frac{h^3}{6} \\sum m^3 c_m\\right) + F^{(4)}_i \\left(\\frac{h^4}{24} \\sum m^4 c_m\\right) + \\mathcal{O}(h^5)$$\n为了以 $\\mathcal{O}(h^4)$ 的误差近似 $F'_i$，我们必须满足以下方程组：\n1. $F_i$ 的系数：$\\sum_{m=-2}^{2} c_m = 0$\n2. $F'_i$ 的系数：$h \\sum_{m=-2}^{2} m c_m = 1$\n3. $F''_i$ 的系数（$\\mathcal{O}(h)$ 误差的来源）：$\\sum_{m=-2}^{2} m^2 c_m = 0$\n4. $F'''_i$ 的系数（$\\mathcal{O}(h^2)$ 误差的来源）：$\\sum_{m=-2}^{2} m^3 c_m = 0$\n5. $F^{(4)}_i$ 的系数（$\\mathcal{O}(h^3)$ 误差的来源）：$\\sum_{m=-2}^{2} m^4 c_m = 0$\n\n问题指定了一个“对称中心线性模板”。对于近似奇数阶导数（一阶导数），这意味着系数是反对称的：$c_{-m} = -c_m$。这得到：\n$$c_0 = 0, \\quad c_{-1} = -c_1, \\quad c_{-2} = -c_2$$\n我们来看看这对我们的方程组有何简化：\n1. $\\sum c_m = c_{-2}+c_{-1}+c_0+c_1+c_2 = -c_2-c_1+0+c_1+c_2 = 0$。此条件自动满足。\n3. $\\sum m^2 c_m = (-2)^2 c_{-2} + (-1)^2 c_{-1} + 1^2 c_1 + 2^2 c_2 = 4(-c_2) + 1(-c_1) + c_1 + 4c_2 = 0$。此条件也自动满足。\n5. $\\sum m^4 c_m = (-2)^4 c_{-2} + (-1)^4 c_{-1} + 1^4 c_1 + 2^4 c_2 = 16(-c_2) + 1(-c_1) + c_1 + 16c_2 = 0$。此条件也自动满足。\n\n反对称条件自动消除了所有偶次幂误差项。我们剩下两个关于两个未知数 $c_1$ 和 $c_2$ 的非平凡方程：\n2. $h \\sum m c_m = h( (-2)c_{-2} + (-1)c_{-1} + 1 c_1 + 2 c_2 ) = h( (-2)(-c_2) + (-1)(-c_1) + c_1 + 2c_2 ) = h(2c_2 + c_1 + c_1 + 2c_2) = h(2c_1 + 4c_2) = 1$.\n   $$ \\implies 2c_1 + 4c_2 = \\frac{1}{h} $$\n4. $\\sum m^3 c_m = (-2)^3 c_{-2} + (-1)^3 c_{-1} + 1^3 c_1 + 2^3 c_2 = -8(-c_2) -1(-c_1) + c_1 + 8c_2 = 8c_2 + c_1 + c_1 + 8c_2 = 2c_1 + 16c_2 = 0$.\n   $$ \\implies c_1 + 8c_2 = 0 $$\n\n我们现在解这个 $2 \\times 2$ 线性方程组。从第二个方程，我们得到 $c_1 = -8 c_2$。将其代入第一个方程：\n$$2(-8c_2) + 4c_2 = \\frac{1}{h}$$\n$$-16c_2 + 4c_2 = \\frac{1}{h}$$\n$$-12c_2 = \\frac{1}{h} \\implies c_2 = -\\frac{1}{12h}$$\n现在，我们求 $c_1$：\n$$c_1 = -8c_2 = -8 \\left(-\\frac{1}{12h}\\right) = \\frac{8}{12h} = \\frac{2}{3h}$$\n完整的系数集是：\n$$c_2 = -\\frac{1}{12h}$$\n$$c_1 = \\frac{2}{3h}$$\n$$c_0 = 0$$\n$$c_{-1} = -c_1 = -\\frac{2}{3h}$$\n$$c_{-2} = -c_2 = \\frac{1}{12h}$$\n将它们按所需顺序 $(c_{-2}, c_{-1}, c_0, c_1, c_2)$ 排列，我们得到最终结果。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{12h} & -\\frac{2}{3h} & 0 & \\frac{2}{3h} & -\\frac{1}{12h}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "现实世界中的CFD模拟很少使用均匀网格，尤其是在需要解析边界层等具有高梯度区域的流动时，网格拉伸技术至关重要。本练习将理论推导与计算实践相结合，首先要求您为非均匀网格推导一个二阶精确的导数近似格式。随后，您将把该格式应用于一个典型的壁面拉伸网格，并通过编写代码来经验性地验证其收敛阶，从而将抽象的截断误差分析与可观测的计算结果联系起来。",
            "id": "3370198",
            "problem": "考虑一个光滑标量场 $u(x)$ 和一个非均匀三点格式 $\\{x_{i-1},x_i,x_{i+1}\\}$，其中 $h_- = x_i - x_{i-1} > 0$ 且 $h_+ = x_{i+1} - x_i > 0$。你将通过匹配关于 $x_i$ 的局部泰勒级数展开，为一阶导数 $u'(x_i)$ 推导一个三点线性有限差分近似，然后分析其主截断误差。随后，你将把得到的近似应用于法向壁面坐标 $y$ 的壁面拉伸网格，并预测 $\\partial_y u$ 的误差如何根据局部网格间距 $h(y)$ 缩放。所有三角函数必须使用弧度制。\n\n推导任务：\n- 从 $u(x_{i-1})$ 和 $u(x_{i+1})$ 关于 $x_i$ 的泰勒级数展开式出发，并假设函数至少具有三阶导数的光滑性，推导系数 $a$、$b$ 和 $c$，使得\n$$u'(x_i) \\approx a\\,u(x_{i-1}) + b\\,u(x_i) + c\\,u(x_{i+1})$$\n匹配泰勒级数，直到 $O(h^3)$ 阶项，即该近似对于 $x$ 的常数、线性和二次多项式是精确的。根据此推导，确定主阶截断误差项，并将其表示为一个乘以 $u^{(3)}(x_i)$ 的系数。\n\n应用于壁面拉伸网格：\n- 考虑法向壁面坐标 $y$ 的一个单调网格映射，形式为\n$$y(\\xi) = L\\,\\frac{e^{\\beta \\xi} - 1}{e^{\\beta} - 1},$$\n其中 $\\xi \\in [0,1]$ 是一个均匀计算坐标，其节点值为 $\\xi_j = j/(N-1)$（$j=0,1,\\dots,N-1$），域大小为 $L>0$，拉伸参数为 $\\beta>0$。对于每个内部节点 $y_i = y(\\xi_i)$，定义 $h_- = y_i - y_{i-1}$ 和 $h_+ = y_{i+1} - y_i$。使用推导出的截断误差，预测近似 $\\partial_y u(y_i)$ 的点态误差如何随局部间距缩放。用 $h_-$、$h_+$ 和一个等效局部间距 $h_{\\text{loc}}(y_i)$ 来表达你的预测，你必须根据你的泰勒分析以合理的方式从 $h_-$ 和 $h_+$ 定义此等效间距。\n\n实现要求：\n- 实现一个程序，该程序：\n  1. 计算并返回指定配对 $(h_-,h_+)$ 的系数 $a$、$b$ 和 $c$。\n  2. 验证你推导出的 $u^{(3)}$ 的主阶截断误差系数，并对于一个选定的光滑函数 $u(y)$，在一个拉伸网格上计算观测到的局部误差与预测的主项之比。\n  3. 在拉伸网格上进行双网格经验收敛性研究，以估计 $\\partial_y u$ 的有限差分近似的观测精度阶 $p$。\n\n测试套件和使用的参数：\n- 对所有拉伸网格使用 $L=1$，并以弧度指定角度。\n- 测试用例1（非对称格式系数）：$h_- = 0.07$，$h_+ = 0.13$。输出列表 $[a,b,c]$。\n- 测试用例2（对称格式系数）：$h_- = 0.10$，$h_+ = 0.10$。输出列表 $[a,b,c]$。\n- 测试用例3（拉伸网格上的局部误差与主项之比）：选择 $u(y) = \\operatorname{Re}\\{e^{\\lambda y}\\}$，其中 $\\lambda = -3 + \\mathrm{i}\\pi$，因此 $u'(y) = \\operatorname{Re}\\{\\lambda e^{\\lambda y}\\}$ 且 $u^{(3)}(y) = \\operatorname{Re}\\{\\lambda^3 e^{\\lambda y}\\}$。使用 $N = 161$，$\\beta = 4$，并在内部索引 $i=50$ 处进行评估。使用局部 $h_-$ 和 $h_+$ 的系数计算 $u'(y_i)$ 的有限差分近似，然后计算比率\n$$r = \\frac{\\left(a\\,u(y_{i-1}) + b\\,u(y_i) + c\\,u(y_{i+1})\\right) - u'(y_i)}{\\left(\\frac{h_- h_+}{6}\\right)\\,u^{(3)}(y_i)}.$$\n输出浮点数 $r$。\n- 测试用例4（拉伸网格上的经验阶）：选择 $u(y) = \\operatorname{Im}\\{e^{\\lambda y}\\}$，其中 $\\lambda = -2 + 3\\mathrm{i}$，因此 $u'(y) = \\operatorname{Im}\\{\\lambda e^{\\lambda y}\\}$。使用 $\\beta = 3$ 以及两个网格，$N_1 = 81$ 和 $N_2 = 161$。对每个网格，计算内部点最大绝对误差\n$$E_N = \\max_{i=1,\\dots,N-2} \\left|a_i\\,u(y_{i-1}) + b_i\\,u(y_i) + c_i\\,u(y_{i+1}) - u'(y_i)\\right|,$$\n其中 $a_i$、$b_i$ 和 $c_i$ 根据每个内部点的局部 $(h_-^{(i)},h_+^{(i)})$ 计算。令 $\\Delta \\xi_N = 1/(N-1)$ 并估计经验阶\n$$p = \\frac{\\log\\left(E_{N_2}/E_{N_1}\\right)}{\\log\\left(\\Delta \\xi_{N_2}/\\Delta \\xi_{N_1}\\right)}.$$\n输出浮点数 $p$。\n\n最终输出格式：\n- 你的程序应产生单行输出，其中包含一个逗号分隔的列表，列表用方括号括起，并按测试用例的顺序排列结果：$[[a_1,b_1,c_1],[a_2,b_2,c_2],r,p]$。不应打印任何额外文本。",
            "solution": "用户提供的问题是数值分析领域一个适定的任务，具体涉及有限差分格式的推导和应用。该问题具有科学依据，内部一致，并包含了完整解答所需的所有信息。\n\n### 第一部分：有限差分公式和截断误差的推导\n\n我们的目标是找到非均匀网格上点 $x_i$ 处一阶导数 $u'(x_i)$ 的有限差分近似的系数 $a, b, c$：\n$$u'(x_i) \\approx a\\,u(x_{i-1}) + b\\,u(x_i) + c\\,u(x_{i+1})$$\n格式点为 $\\{x_{i-1}, x_i, x_{i+1}\\}$，网格间距定义为 $h_- = x_i - x_{i-1} > 0$ 和 $h_+ = x_{i+1} - x_i > 0$。这些系数通过匹配泰勒级数展开来确定，以确保该公式对最高为2次的多项式都是精确的。\n\n我们从 $u(x_{i-1})$ 和 $u(x_{i+1})$ 在点 $x_i$ 附近的泰勒级数展开开始：\n$$u(x_{i-1}) = u(x_i - h_-) = u(x_i) - h_- u'(x_i) + \\frac{h_-^2}{2} u''(x_i) - \\frac{h_-^3}{6} u^{(3)}(x_i) + O(h_-^4)$$\n$$u(x_{i+1}) = u(x_i + h_+) = u(x_i) + h_+ u'(x_i) + \\frac{h_+^2}{2} u''(x_i) + \\frac{h_+^3}{6} u^{(3)}(x_i) + O(h_+^4)$$\n\n将这些展开式代入近似式的右侧 (RHS) 得到：\n$$\\text{RHS} = a\\left( u_i - h_- u'_i + \\frac{h_-^2}{2} u''_i - \\dots \\right) + b u_i + c\\left( u_i + h_+ u'_i + \\frac{h_+^2}{2} u''_i + \\dots \\right)$$\n其中 $u_i = u(x_i)$，$u'_i = u'(x_i)$，依此类推。按 $u$ 在 $x_i$ 处的导数收集各项：\n$$\\text{RHS} = u_i(a+b+c) + u'_i(-ah_- + ch_+) + u''_i\\left(a\\frac{h_-^2}{2} + c\\frac{h_+^2}{2}\\right) + u^{(3)}_i\\left(-a\\frac{h_-^3}{6} + c\\frac{h_+^3}{6}\\right) + \\dots$$\n\n为了使格式对常数 ($u(x)=k$)、线性函数 ($u(x)=mx+k$) 和二次函数 ($u(x)=qx^2+mx+k$) 精确，RHS 中 $u_i$、$u'_i$ 和 $u''_i$ 的系数必须与 LHS（即 $u'_i$）的系数相匹配。这导出了关于 $a, b, c$ 的以下线性方程组：\n1. $u_i$ 的系数：$a + b + c = 0$\n2. $u'_i$ 的系数：$-ah_- + ch_+ = 1$\n3. $u''_i$ 的系数：$a h_-^2 + c h_+^2 = 0$\n\n从方程(3)中，我们将 $a$ 表示为 $c$ 的函数：\n$a = -c \\frac{h_+^2}{h_-^2}$\n\n将此代入方程(2)：\n$- \\left(-c \\frac{h_+^2}{h_-^2}\\right) h_- + c h_+ = 1 \\implies c \\frac{h_+^2}{h_-} + c h_+ = 1$\n$c \\left( \\frac{h_+^2 + h_- h_+}{h_-} \\right) = 1 \\implies c \\frac{h_+(h_+ + h_-)}{h_-} = 1$\n解出 $c$ 得到：\n$$c = \\frac{h_-}{h_+(h_+ + h_-)}$$\n\n现在，我们解出 $a$：\n$$a = - \\left( \\frac{h_-}{h_+(h_+ + h_-)} \\right) \\frac{h_+^2}{h_-^2} = -\\frac{h_+}{h_-(h_+ + h_-)}$$\n\n最后，从方程(1)中，我们解出 $b$：\n$$b = -a - c = \\frac{h_+}{h_-(h_+ + h_-)} - \\frac{h_-}{h_+(h_+ + h_-)} = \\frac{h_+^2 - h_-^2}{h_- h_+(h_+ + h_-)} = \\frac{(h_+ - h_-)(h_+ + h_-)}{h_- h_+(h_+ + h_-)}$$\n$$b = \\frac{h_+ - h_-}{h_- h_+}$$\n\n截断误差 $\\tau$ 是有限差分算子与真实微分算子之间的差。它由泰勒展开中第一个未被抵消的非零项给出。这是包含 $u^{(3)}_i$ 的项：\n$$\\tau = \\left( -a \\frac{h_-^3}{6} + c \\frac{h_+^3}{6} \\right) u^{(3)}_i + O(h^3)$$\n其中 $h$ 是一个特征网格间距，例如 $h = \\max(h_-, h_+)$。代入 $a$ 和 $c$ 的表达式：\n$$\\tau = \\left[ - \\left(-\\frac{h_+}{h_-(h_+ + h_-)}\\right) \\frac{h_-^3}{6} + \\left(\\frac{h_-}{h_+(h_+ + h_-)}\\right) \\frac{h_+^3}{6} \\right] u^{(3)}_i + O(h^3)$$\n$$\\tau = \\left[ \\frac{h_+ h_-^2}{6(h_+ + h_-)} + \\frac{h_- h_+^2}{6(h_+ + h_-)} \\right] u^{(3)}_i + O(h^3)$$\n$$\\tau = \\frac{h_-h_+(h_- + h_+)}{6(h_+ + h_-)} u^{(3)}_i + O(h^3) = \\frac{h_- h_+}{6} u^{(3)}_i + O(h^3)$$\n主阶截断误差为 $\\frac{h_- h_+}{6} u^{(3)}(x_i)$。该格式是二阶精确的，因为误差项与乘积 $h_- h_+$ 成正比，其缩放级别为 $O(h^2)$。\n\n### 第二部分：应用于壁面拉伸网格\n\n问题考虑了一个由映射 $y(\\xi) = L(e^{\\beta \\xi} - 1)/(e^{\\beta} - 1)$ 定义的拉伸网格，该映射从均匀计算坐标 $\\xi \\in [0,1]$ 建立。对于小的计算网格间距 $\\Delta\\xi$，物理间距为：\n$$h_- = y_i - y_{i-1} \\approx y'(\\xi_i) \\Delta\\xi$$\n$$h_+ = y_{i+1} - y_i \\approx y'(\\xi_i) \\Delta\\xi$$\n其中 $y'(\\xi) = dy/d\\xi$。在点 $y_i$ 处的主截断误差为 $T_i = \\frac{h_- h_+}{6} u^{(3)}(y_i)$。\n代入 $h_-$ 和 $h_+$ 的近似值：\n$$T_i \\approx \\frac{(y'(\\xi_i)\\Delta\\xi)^2}{6} u^{(3)}(y_i)$$\n问题要求预测误差如何随局部间距 $h_{\\text{loc}}(y_i)$ 缩放。局部物理间距的一个自然定义是算术平均值：\n$$h_{\\text{loc}}(y_i) = \\frac{h_- + h_+}{2}$$\n从映射函数的泰勒展开，我们有 $h_{\\text{loc}}(y_i) = y'(\\xi_i)\\Delta\\xi + O(\\Delta\\xi^3)$。\n由于 $h_-h_+ \\approx h_{\\text{loc}}^2$，截断误差的量级为：\n$$|T_i| \\approx \\frac{h_{\\text{loc}}(y_i)^2}{6} |u^{(3)}(y_i)|$$\n这表明点态误差随局部网格间距 $h_{\\text{loc}}$ 呈二次方缩放。因此，就局部网格间距而言，该有限差分格式是二阶精确的。此外，由于 $h_{\\text{loc}}$ 与 $\\Delta\\xi$ 成正比，网格上的最大误差预计将按 $O(\\Delta\\xi^2)$ 缩放，这意味着相对于计算网格间距的经验收敛阶为 $p=2$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the multi-part finite difference problem.\n    \"\"\"\n\n    def get_coeffs(h_minus, h_plus):\n        \"\"\"\n        Calculates the coefficients a, b, and c for the 3-point\n        non-uniform finite difference approximation of the first derivative.\n        \n        Args:\n            h_minus (float): Grid spacing x_i - x_{i-1}.\n            h_plus (float): Grid spacing x_{i+1} - x_i.\n            \n        Returns:\n            list: A list containing the coefficients [a, b, c].\n        \"\"\"\n        h_sum = h_minus + h_plus\n        a = -h_plus / (h_minus * h_sum)\n        b = (h_plus - h_minus) / (h_minus * h_plus)\n        c = h_minus / (h_plus * h_sum)\n        return [a, b, c]\n\n    # Test Case 1: Asymmetric stencil coefficients\n    h_minus1, h_plus1 = 0.07, 0.13\n    coeffs1 = get_coeffs(h_minus1, h_plus1)\n\n    # Test Case 2: Symmetric stencil coefficients\n    h_minus2, h_plus2 = 0.10, 0.10\n    coeffs2 = get_coeffs(h_minus2, h_plus2)\n\n    # Test Case 3: Local error to leading-term ratio\n    L3, N3, beta3, i3 = 1.0, 161, 4.0, 50\n    lam3 = -3.0 + 1j * np.pi\n\n    def y_map(xi, L, beta):\n        return L * (np.exp(beta * xi) - 1.0) / (np.exp(beta) - 1.0)\n\n    delta_xi3 = 1.0 / (N3 - 1)\n    xi_coords3 = np.array([i3 - 1, i3, i3 + 1]) * delta_xi3\n    y_coords3 = y_map(xi_coords3, L3, beta3)\n    y_im1, y_i, y_ip1 = y_coords3[0], y_coords3[1], y_coords3[2]\n\n    h_minus3 = y_i - y_im1\n    h_plus3 = y_ip1 - y_i\n    coeffs3 = get_coeffs(h_minus3, h_plus3)\n    a3, b3, c3 = coeffs3[0], coeffs3[1], coeffs3[2]\n\n    u_vals = np.real(np.exp(lam3 * np.array([y_im1, y_i, y_ip1])))\n    \n    u_num_prime = a3 * u_vals[0] + b3 * u_vals[1] + c3 * u_vals[2]\n    u_exact_prime = np.real(lam3 * np.exp(lam3 * y_i))\n    u_exact_ppp = np.real(lam3**3 * np.exp(lam3 * y_i))\n\n    observed_error = u_num_prime - u_exact_prime\n    predicted_leading_error = (h_minus3 * h_plus3 / 6.0) * u_exact_ppp\n    \n    r = observed_error / predicted_leading_error\n\n    # Test Case 4: Empirical order of accuracy\n    def compute_max_error(N, beta, L, lam):\n        delta_xi = 1.0 / (N - 1)\n        xi_grid = np.linspace(0, 1, N)\n        y_grid = y_map(xi_grid, L, beta)\n        \n        errors = []\n        for i in range(1, N - 1):\n            y_im1, y_i, y_ip1 = y_grid[i - 1], y_grid[i], y_grid[i + 1]\n            h_minus = y_i - y_im1\n            h_plus = y_ip1 - y_i\n\n            a, b, c = get_coeffs(h_minus, h_plus)\n            \n            u_vals = np.imag(np.exp(lam * np.array([y_im1, y_i, y_ip1])))\n            \n            u_num_prime = a * u_vals[0] + b * u_vals[1] + c * u_vals[2]\n            u_exact_prime = np.imag(lam * np.exp(lam * y_i))\n            \n            errors.append(np.abs(u_num_prime - u_exact_prime))\n        \n        return np.max(errors)\n\n    L4, beta4 = 1.0, 3.0\n    N1, N2 = 81, 161\n    lam4 = -2.0 + 3.0j\n\n    error_N1 = compute_max_error(N1, beta4, L4, lam4)\n    error_N2 = compute_max_error(N2, beta4, L4, lam4)\n\n    delta_xi_N1 = 1.0 / (N1 - 1)\n    delta_xi_N2 = 1.0 / (N2 - 1)\n    \n    p = np.log(error_N2 / error_N1) / np.log(delta_xi_N2 / delta_xi_N1)\n\n    # Assemble final results and print in the required format\n    results = [coeffs1, coeffs2, r, p]\n    \n    # Python's default str() for a list includes brackets and spaces,\n    # which is needed for the requested output format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}