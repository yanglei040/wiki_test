{
    "hands_on_practices": [
        {
            "introduction": "本章旨在通过一系列动手实践，加深您对典型模型方程离散化核心概念的理解。第一个练习  将从基本的一维热传导方程入手。通过构建一个显式有限体积格式，您将推导出保证解的物理实在性（如非负性）所需满足的条件，并将其与经典的有限差分方法进行比较，从而深入理解离散格式的保守性、单调性和稳定性等基本性质。",
            "id": "3310197",
            "problem": "考虑一维热传导方程（也称为扩散方程）的守恒形式，其标量场为 $u(x,t)$，\n$$\nu_t \\;=\\; \\alpha\\,u_{xx} \\;=\\; -\\,\\partial_x q, \\qquad q \\;=\\; -\\,\\alpha\\,u_x,\n$$\n该方程定义在一个周期性域上，具有均匀的空间网格间距 $\\Delta x$ 和时间步长 $\\Delta t$。假设要求您设计一种有限体积法 (FVM)，该方法使用以下方式来演化 $u(x,t)$ 的单元平均值 $u_i^n$：\n- 在每个控制体积内对 $u(x,t)$ 进行分段常数重构，\n- 在单元交界面上对扩散通量 $q$ 使用中心两点通量近似，以及\n- 前向欧拉时间积分。\n\n您必须在显式时间步长限制下，确保对于非负初始数据 $u_i^0 \\ge 0$，$u_i^n$ 具有非负性（保正性）。您还必须在相同或相关的时间步长限制下，评估所得格式的单调性（即每个单元的更新是其模板中每个参数的非减函数）和 $L^\\infty$ 范数下的非扩张性（即 $\\|u^{n+1}\\|_\\infty \\le \\|u^n\\|_\\infty$）。最后，将您的 FVM 与用于相同方程和网格的标准时间前向中心差分 (FTCS) 有限差分法进行比较。\n\n下列哪个陈述是正确的？\n\nA. 采用中心两点扩散通量的显式 FVM 得到的更新形式为 $u_i^{n+1} \\,=\\, (1-2\\mu)\\,u_i^n \\,+\\, \\mu\\,u_{i-1}^n \\,+\\, \\mu\\,u_{i+1}^n$，其中 $\\mu \\,=\\, \\alpha\\,\\Delta t/\\Delta x^2$。对于非负数据，该格式是保正的、单调的且在 $L^\\infty$ 范数下非扩张的，当且仅当 $0 \\le \\mu \\le \\tfrac{1}{2}$。此外，此 FVM 更新与在相同网格上用于热传导方程的 FTCS 有限差分法一致。\n\nB. 采用中心两点扩散通量的显式 FVM 在任何 $0 \\le \\mu \\le 1$ 的情况下都是保正的且在 $L^\\infty$ 范数下非扩张的，因为扩散是耗散的，并且仅凭守恒性就能保证非负性。\n\nC. 采用中心两点扩散通量的显式 FVM 是守恒的，因此对于任何 $\\Delta t>0$，无论 $\\mu$ 的值如何，它总是单调且保正的。\n\nD. 用于热传导方程的 FTCS 有限差分法是无条件单调且在 $L^\\infty$ 范数下非扩张的，因为对于任何 $\\Delta t>0$，抛物型方程都会平滑振荡，而 FVM 需要 $0 \\le \\mu \\le \\tfrac{1}{2}$ 才能保正。",
            "solution": "对用户提供的问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程：** 一维热传导方程的守恒形式为 $u_t = \\alpha\\,u_{xx} = -\\partial_x q$，扩散通量为 $q = -\\alpha\\,u_x$。\n- **场：** $u(x,t)$ 是一个标量场。\n- **区域：** 区域是周期性的。\n- **网格：** 具有均匀空间间距 $\\Delta x$ 和均匀时间步长 $\\Delta t$ 的网格。\n- **数值方法：** 指定了一种有限体积法 (FVM)，其具有以下特征：\n    1. **变量：** 单元平均值，记为 $u_i^n$，其中 $i$ 是空间索引，$n$ 是时间索引。单元 $C_i$ 以 $x_i$ 为中心，边界位于 $x_{i-1/2}$ 和 $x_{i+1/2}$，宽度为 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。\n    2. **重构：** 在每个控制体积内对 $u(x,t)$ 进行分段常数重构。\n    3. **通量近似：** 在单元交界面上对 $q$ 使用中心两点通量近似。\n    4. **时间积分：** 前向欧拉法。\n- **待分析属性：**\n    1. **非负性（保正性）：** 如果初始数据 $u_i^0 \\ge 0$，确保对所有 $n$ 都有 $u_i^n \\ge 0$。\n    2. **单调性：** 每个单元的更新 $u_i^{n+1}$ 必须是其模板参数（$u_j^n$）的非减函数。\n    3. **$L^\\infty$ 范数下的非扩张性：** $\\|u^{n+1}\\|_\\infty \\le \\|u^n\\|_\\infty$。\n- **比较任务：** 将推导出的 FVM 与标准的“时间前向中心差分”(FTCS) 有限差分法进行比较。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上和数学上都是合理的。它描述了偏微分方程数值分析领域中的一个标准练习，特别是针对计算流体力学。控制方程是基础的，指定的数值方法（显式时间步进的 FVM）是一种成熟的技术。保正性、单调性和 $L^\\infty$ 稳定性的概念是评估数值格式的标准准则。该问题是适定的、客观的，并包含了推导唯一解和执行所需分析的所有必要信息。没有矛盾、歧义或事实错误。\n\n### 步骤 3：结论与行动\n此问题是 **有效的**。现在开始求解过程。\n\n### 推导与分析\n\n我们首先按照规定推导有限体积格式。将守恒律 $u_t + \\partial_x q = 0$ 在控制体积 $C_i = [x_{i-1/2}, x_{i+1/2}]$ 上积分：\n$$\n\\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial u}{\\partial t} \\,dx + \\int_{x_{i-1/2}}^{x_{i+1/2}} \\frac{\\partial q}{\\partial x} \\,dx = 0\n$$\n定义单元平均值为 $u_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x,t) \\,dx$，第一项变为 $\\Delta x \\frac{d u_i}{dt}$。根据微积分基本定理，第二项变为 $q(x_{i+1/2}, t) - q(x_{i-1/2}, t)$。因此，半离散方程为：\n$$\n\\frac{d u_i}{dt} = - \\frac{q_{i+1/2} - q_{i-1/2}}{\\Delta x}\n$$\n其中 $q_{i \\pm 1/2}$ 是单元交界面上的通量。\n\n问题指定了分段常数重构，这意味着我们假设对于 $x \\in C_i$，$u(x,t) \\approx u_i(t)$。通量为 $q = -\\alpha u_x$。我们在单元交界面 $x_{i+1/2}$ 处使用“中心两点通量近似”，这涉及到相邻单元 $i$ 和 $i+1$ 的值。空间导数 $u_x$ 通过基于单元平均值的中心差分来近似：\n$$\n(u_x)_{i+1/2} \\approx \\frac{u_{i+1} - u_i}{\\Delta x}\n$$\n那么，在交界面 $x_{i+1/2}$ 处的数值通量为：\n$$\nq_{i+1/2} = -\\alpha \\left( \\frac{u_{i+1} - u_i}{\\Delta x} \\right)\n$$\n类似地，在交界面 $x_{i-1/2}$ 处的通量为：\n$$\nq_{i-1/2} = -\\alpha \\left( \\frac{u_i - u_{i-1}}{\\Delta x} \\right)\n$$\n将这些通量近似代入半离散方程：\n$$\n\\frac{d u_i}{dt} = - \\frac{1}{\\Delta x} \\left[ -\\alpha \\left( \\frac{u_{i+1} - u_i}{\\Delta x} \\right) - \\left( -\\alpha \\left( \\frac{u_i - u_{i-1}}{\\Delta x} \\right) \\right) \\right] = \\frac{\\alpha}{\\Delta x^2} (u_{i+1} - 2u_i + u_{i-1})\n$$\n应用前向欧拉法进行时间积分，其中 $\\frac{du_i}{dt} \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}$：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\frac{\\alpha}{\\Delta x^2} (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\n我们定义无量纲扩散数 $\\mu = \\frac{\\alpha \\Delta t}{\\Delta x^2}$。重新整理方程，得到 FVM 格式的最终更新公式：\n$$\nu_i^{n+1} = u_i^n + \\mu (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\n$$\nu_i^{n+1} = (1 - 2\\mu) u_i^n + \\mu u_{i-1}^n + \\mu u_{i+1}^n\n$$\n这就是显式 FVM 格式。\n\n接下来，我们将其与用于 $u_t = \\alpha u_{xx}$ 的标准 FTCS（时间前向中心差分）有限差分法进行比较。FTCS 离散格式为：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\alpha \\frac{u_{i+1}^n - 2u_i^n + u_{i-1}^n}{\\Delta x^2}\n$$\n这在代数上与为 FVM 推导的方程完全相同。因此，得到的更新公式是相同的。指定的 FVM 与 FTCS 格式完全一致。\n\n现在我们分析格式 $u_i^{n+1} = (1 - 2\\mu) u_i^n + \\mu u_{i-1}^n + \\mu u_{i+1}^n$ 的性质。\n\n1.  **保正性：** 要使格式是保正的，我们需要如果对所有 $j$ 都有 $u_j^n \\ge 0$，那么 $u_i^{n+1} \\ge 0$。由于 $u_i^{n+1}$ 是 $u_j^n$ 的线性组合，一个充分条件是组合中的所有系数都非负。\n    - 系数 $\\mu = \\frac{\\alpha \\Delta t}{\\Delta x^2}$ 根据定义是非负的（假设 $\\alpha, \\Delta t, \\Delta x$ 均为正）。\n    - 我们还必须要求 $u_i^n$ 的系数为非负：$1 - 2\\mu \\ge 0$，这意味着 $2\\mu \\le 1$，即 $\\mu \\le \\frac{1}{2}$。\n    这个条件也是必要的。如果 $\\mu > 1/2$，我们可以构造初始数据，例如，$u_i^0 = 1$ 且对于 $j \\neq i$ 有 $u_j^0 = 0$，这将导致 $u_i^1 = 1 - 2\\mu  0$。因此，该格式是保正的当且仅当 $0 \\le \\mu \\le \\frac{1}{2}$。\n\n2.  **单调性：** 如果一个格式的更新函数是其每个参数的非减函数，则该格式是单调的。对于我们的线性格式，这意味着关于模板值的偏导数必须是非负的：\n    - $\\frac{\\partial u_i^{n+1}}{\\partial u_{i-1}^n} = \\mu \\ge 0$。\n    - $\\frac{\\partial u_i^{n+1}}{\\partial u_{i+1}^n} = \\mu \\ge 0$。\n    - $\\frac{\\partial u_i^{n+1}}{\\partial u_i^n} = 1 - 2\\mu \\ge 0 \\implies \\mu \\le \\frac{1}{2}$。\n    单调性的条件与保正性的条件相同：$0 \\le \\mu \\le \\frac{1}{2}$。\n\n3.  **$L^\\infty$ 范数下的非扩张性：** 我们要求 $\\|u^{n+1}\\|_\\infty \\le \\|u^n\\|_\\infty$。设 $M^n = \\|u^n\\|_\\infty = \\sup_j |u_j^n|$。\n    $$\n    |u_i^{n+1}| = |(1 - 2\\mu) u_i^n + \\mu u_{i-1}^n + \\mu u_{i+1}^n|\n    $$\n    使用三角不等式：\n    $$\n    |u_i^{n+1}| \\le |1 - 2\\mu| |u_i^n| + |\\mu| |u_{i-1}^n| + |\\mu| |u_{i+1}^n|\n    $$\n    如果我们强制执行条件 $0 \\le \\mu \\le \\frac{1}{2}$，那么所有系数都是非负的，所以 $|1 - 2\\mu| = 1 - 2\\mu$ 且 $|\\mu| = \\mu$。\n    $$\n    |u_i^{n+1}| \\le (1 - 2\\mu) |u_i^n| + \\mu |u_{i-1}^n| + \\mu |u_{i+1}^n| \\le (1 - 2\\mu) M^n + \\mu M^n + \\mu M^n = (1 - 2\\mu + 2\\mu) M^n = M^n\n    $$\n    由于对所有 $i$ 都有 $|u_i^{n+1}| \\le M^n$，我们得到 $\\|u^{n+1}\\|_\\infty \\le M^n = \\|u^n\\|_\\infty$。条件 $0 \\le \\mu \\le \\frac{1}{2}$ 是该格式在 $L^\\infty$ 范数下非扩张的充分条件。这个条件也被认为是该范数下稳定性的必要条件（冯·诺依曼稳定性分析得出相同的条件）。\n\n### 评估选项\n\n**A. 采用中心两点扩散通量的显式 FVM 得到的更新形式为 $u_i^{n+1} \\,=\\, (1-2\\mu)\\,u_i^n \\,+\\, \\mu\\,u_{i-1}^n \\,+\\, \\mu\\,u_{i+1}^n$，其中 $\\mu \\,=\\, \\alpha\\,\\Delta t/\\Delta x^2$。对于非负数据，该格式是保正的、单调的且在 $L^\\infty$ 范数下非扩张的，当且仅当 $0 \\le \\mu \\le \\tfrac{1}{2}$。此外，此 FVM 更新与在相同网格上用于热传导方程的 FTCS 有限差分法一致。**\n- 推导出的更新公式与给定公式相符。\n- 对保正性、单调性和 $L^\\infty$ 非扩张性的分析证实了条件 $0 \\le \\mu \\le \\frac{1}{2}$。\n- 同样证明了这种特定的 FVM 与标准 FTCS 方法的等价性。\n该陈述中的所有主张都是准确的。\n**结论：正确**\n\n**B. 采用中心两点扩散通量的显式 FVM 在任何 $0 \\le \\mu \\le 1$ 的情况下都是保正的且在 $L^\\infty$ 范数下非扩张的，因为扩散是耗散的，并且仅凭守恒性就能保证非负性。**\n- 条件 $0 \\le \\mu \\le 1$ 是不正确的。例如，如果 $\\mu = 0.75$，系数 $1 - 2\\mu = -0.5$ 为负，这违反了保正性。\n- 其推理是有缺陷的。守恒性是一个全局属性（单元值的总和是恒定的），并不能保证像保正性这样的局部属性。虽然物理扩散是耗散的，但如果违反了时间步长限制，数值格式可能会变得不稳定并且不能保正。\n**结论：不正确**\n\n**C. 采用中心两点扩散通量的显式 FVM 是守恒的，因此对于任何 $\\Delta t0$，无论 $\\mu$ 的值如何，它总是单调且保正的。**\n- 该格式通过其 FVM 构造确实是守恒的。然而，守恒性保证无条件单调性和保正性的推论是错误的。\n- 如前所示，该格式仅在 $0 \\le \\mu \\le \\frac{1}{2}$ 的条件下是单调和保正的。它不是无条件的。\n**结论：不正确**\n\n**D. 用于热传导方程的 FTCS 有限差分法是无条件单调且在 $L^\\infty$ 范数下非扩张的，因为对于任何 $\\Delta t0$，抛物型方程都会平滑振荡，而 FVM 需要 $0 \\le \\mu \\le \\tfrac{1}{2}$ 才能保正。**\n- 这个陈述错误地声称 FTCS 方法是无条件稳定的、单调的和非扩张的。FTCS 格式是条件稳定显式方法的典型例子，要求 $\\mu \\le \\frac{1}{2}$。\n- 关于抛物型方程平滑振荡的推理指的是连续偏微分方程，而不必然是其离散近似。\n- 它在 FTCS 方法和 FVM 之间制造了一个错误的区别，而在给定的规范下，它们是具有相同稳定性条件的相同格式。\n**结论：不正确**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了基本离散格式的性质后，下一个挑战是如何系统性地提高其精度。本练习  聚焦于扩散项 $u_{xx}$ 的高阶近似，要求您利用泰勒级数展开从头构建一个四阶精度的中心差分格式。这项实践不仅能锻炼您的代数推导能力，更重要的是，它揭示了高阶格式的设计原理及其对截断误差的控制，这是在计算流体力学中实现高保真模拟的关键一步。",
            "id": "3310241",
            "problem": "在计算流体动力学 (CFD) 中，扩散算子的高阶空间离散化用于在无需过度加密网格的情况下控制数值色散和数值耗散。考虑一个光滑标量场 $u(x)$，其在均匀一维网格上采样，网格点为 $x_i = x_0 + i h$，其中 $h  0$ 是恒定的网格间距，$i \\in \\mathbb{Z}$ 为内部点的索引。仅从点 $x_i$ 处的泰勒级数展开和二阶导数离散近似的相容性定义出发，构建一个以四阶精度近似 $u_{xx}(x_i)$ 的对称五点格式。通过强制离散算子与连续二阶导数相匹配，并消除为达到四阶精度所需消除的低阶误差项，来确定该格式的权重（用 $h$ 表示）。然后，计算此近似的主截断误差项，并用 $h$ 和六阶导数 $u^{(6)}(x_i)$ 显式地表达出来。\n\n请以两个闭式解析表达式的形式给出最终结果：首先，是用节点值 $u_{i-2}$、$u_{i-1}$、$u_i$、$u_{i+1}$ 和 $u_{i+2}$ 表示的、经 $h^2$ 归一化的 $u_{xx}(x_i)$ 近似的五点格式公式；其次，是写成 $h^4 u^{(6)}(x_i)$ 倍数形式的主截断误差项。无需进行数值四舍五入。",
            "solution": "用户希望推导一个用于二阶导数 $u_{xx}(x_i)$ 的四阶精度对称五点有限差分格式，并确定其主截断误差项。推导必须基于泰勒级数展开。\n\n令二阶导数 $u_{xx}(x_i) = u_i''$ 的近似表示为 $\\delta_{xx} u_i$。对于一个以 $x_i$ 为中心的对称五点格式，其近似的一般形式为：\n$$ \\delta_{xx} u_i = c_{-2} u_{i-2} + c_{-1} u_{i-1} + c_0 u_i + c_1 u_{i+1} + c_2 u_{i+2} $$\n其中 $u_{i+j} = u(x_i + j h)$。对于对称格式，权重必须满足 $c_{-j} = c_j$。因此，我们有 $c_{-1}=c_1$ 和 $c_{-2}=c_2$。我们将独立系数重命名为 $A = c_2$，$B = c_1$ 和 $C = c_0$。该格式变为：\n$$ \\delta_{xx} u_i = A u_{i-2} + B u_{i-1} + C u_i + B u_{i+1} + A u_{i+2} $$\n\n为了确定系数 $A$、$B$ 和 $C$，我们将每一项 $u_{i+j}$ 在点 $x_i$ 附近展开为泰勒级数。我们将 $u^{(k)}(x_i)$ 记为 $u_i^{(k)}$。\n$$ u_{i+1} = u(x_i+h) = u_i + h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} + \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} + \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + O(h^7) $$\n$$ u_{i-1} = u(x_i-h) = u_i - h u_i^{(1)} + \\frac{h^2}{2!} u_i^{(2)} - \\frac{h^3}{3!} u_i^{(3)} + \\frac{h^4}{4!} u_i^{(4)} - \\frac{h^5}{5!} u_i^{(5)} + \\frac{h^6}{6!} u_i^{(6)} + O(h^7) $$\n$$ u_{i+2} = u(x_i+2h) = u_i + (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} + \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} + \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + O(h^7) $$\n$$ u_{i-2} = u(x_i-2h) = u_i - (2h) u_i^{(1)} + \\frac{(2h)^2}{2!} u_i^{(2)} - \\frac{(2h)^3}{3!} u_i^{(3)} + \\frac{(2h)^4}{4!} u_i^{(4)} - \\frac{(2h)^5}{5!} u_i^{(5)} + \\frac{(2h)^6}{6!} u_i^{(6)} + O(h^7) $$\n\n将这些展开式代入格式公式中：\n$$ \\delta_{xx} u_i = A(u_{i-2} + u_{i+2}) + B(u_{i-1} + u_{i+1}) + C u_i $$\n通过将泰勒级数成对相加，由于对称性，奇数阶导数项被消去：\n$$ u_{i+1} + u_{i-1} = 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12} u_i^{(4)} + \\frac{h^6}{360} u_i^{(6)} + O(h^8) $$\n$$ u_{i+2} + u_{i-2} = 2u_i + 4h^2 u_i^{(2)} + \\frac{16h^4}{12} u_i^{(4)} + \\frac{64h^6}{360} u_i^{(6)} + O(h^8) = 2u_i + 4h^2 u_i^{(2)} + \\frac{4h^4}{3} u_i^{(4)} + \\frac{8h^6}{45} u_i^{(6)} + O(h^8) $$\n将这些和代入 $\\delta_{xx} u_i$ 的表达式中：\n$$ \\delta_{xx} u_i = A \\left( 2u_i + 4h^2 u_i^{(2)} + \\frac{4h^4}{3} u_i^{(4)} + \\dots \\right) + B \\left( 2u_i + h^2 u_i^{(2)} + \\frac{h^4}{12} u_i^{(4)} + \\dots \\right) + C u_i $$\n按 $u_i$ 的导数阶数合并同类项：\n$$ \\delta_{xx} u_i = (2A+2B+C) u_i + (4A+B)h^2 u_i^{(2)} + \\left(\\frac{4A}{3} + \\frac{B}{12}\\right)h^4 u_i^{(4)} + O(h^6) $$\n\n为了使该算子成为 $u_i^{(2)}$ 的一个相容的四阶近似，我们必须使展开式中各导数项的系数与目标算子 $u_i^{(2)}$ 的系数相匹配。\n1.  $u_i$ 的系数必须为零：$2A+2B+C = 0$。\n2.  $u_i^{(2)}$ 的系数必须为一：$(4A+B)h^2 = 1 \\implies 4A+B = \\frac{1}{h^2}$。\n3.  为达到四阶精度，$O(h^2)$ 的误差项必须被消除。主误差项的系数（涉及 $u_i^{(4)}$）必须为零：$(\\frac{4A}{3} + \\frac{B}{12})h^4 = 0 \\implies \\frac{4A}{3} + \\frac{B}{12} = 0$。\n\n我们求解这个关于 $A$、$B$ 和 $C$ 的三元线性方程组。\n由方程 (3) 可得：\n$$ \\frac{B}{12} = -\\frac{4A}{3} \\implies B = -16A $$\n将此结果代入方程 (2)：\n$$ 4A + (-16A) = \\frac{1}{h^2} \\implies -12A = \\frac{1}{h^2} \\implies A = -\\frac{1}{12h^2} $$\n现在我们求 $B$：\n$$ B = -16A = -16\\left(-\\frac{1}{12h^2}\\right) = \\frac{16}{12h^2} = \\frac{4}{3h^2} $$\n最后，由方程 (1)，我们求 $C$：\n$$ C = -2A - 2B = -2\\left(-\\frac{1}{12h^2}\\right) - 2\\left(\\frac{4}{3h^2}\\right) = \\frac{1}{6h^2} - \\frac{8}{3h^2} = \\frac{1-16}{6h^2} = -\\frac{15}{6h^2} = -\\frac{5}{2h^2} $$\n这些系数为 $c_{-2}=c_2=A=-\\frac{1}{12h^2}$，$c_{-1}=c_1=B=\\frac{16}{12h^2}$，以及 $c_0=C=-\\frac{30}{12h^2}$。\n将这些系数代入格式公式，得到 $u_{xx}(x_i)$ 的近似：\n$$ u_{xx}(x_i) \\approx \\frac{1}{12h^2} (-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}) $$\n这就是所求的四阶格式公式。\n\n接下来，我们计算主截断误差项。截断误差 $T$ 定义为 $T = \\delta_{xx}u_i - u_{xx}(x_i)$。$T$ 的主项是该差值泰勒展开中的第一个非零项。由于我们消除了 $u_i^{(4)}$ 项，下一项将与 $u_i^{(6)}$ 成正比。\n$\\delta_{xx} u_i$ 的完整展开式为：\n$$ \\delta_{xx} u_i = (2A+2B+C) u_i + (4A+B)h^2 u_i^{(2)} + \\left(\\frac{4A}{3} + \\frac{B}{12}\\right)h^4 u_i^{(4)} + \\left(\\frac{8A}{45} + \\frac{B}{360}\\right)h^6 u_i^{(6)} + O(h^8) $$\n根据构造，上式简化为：\n$$ \\delta_{xx} u_i = u_i^{(2)} + \\left(\\frac{8A}{45} + \\frac{B}{360}\\right)h^6 u_i^{(6)} + O(h^8) $$\n因此，主截断误差项为：\n$$ T_{\\text{lead}} = \\left(\\frac{8A}{45} + \\frac{B}{360}\\right)h^6 u_i^{(6)} $$\n代入 $A$ 和 $B$ 的值：\n$A = -\\frac{1}{12h^2}$ 和 $B = \\frac{16}{12h^2}$。\n$$ T_{\\text{lead}} = \\left(\\frac{8}{45}\\left(-\\frac{1}{12h^2}\\right) + \\frac{1}{360}\\left(\\frac{16}{12h^2}\\right)\\right)h^6 u_i^{(6)} $$\n$$ T_{\\text{lead}} = \\left(-\\frac{8}{540h^2} + \\frac{16}{4320h^2}\\right)h^6 u_i^{(6)} $$\n我们使用公分母 $4320$：\n$$ T_{\\text{lead}} = \\left(-\\frac{8 \\times 8}{4320h^2} + \\frac{16}{4320h^2}\\right)h^6 u_i^{(6)} = \\left(\\frac{-64+16}{4320h^2}\\right)h^6 u_i^{(6)} $$\n$$ T_{\\text{lead}} = \\left(\\frac{-48}{4320h^2}\\right)h^6 u_i^{(6)} = -\\frac{48}{4320} h^4 u_i^{(6)} $$\n简化分数：\n$$ -\\frac{48}{4320} = -\\frac{48}{48 \\times 90} = -\\frac{1}{90} $$\n所以，主截断误差项为：\n$$ T_{\\text{lead}} = -\\frac{1}{90}h^4 u_i^{(6)} $$\n这证实了该格式确实是四阶精度的，因为误差与 $h^4$ 成正比。\n\n所要求的两个结果是格式公式和主截断误差项。\n1. 格式公式：$\\delta_{xx} u_i = \\frac{-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}}{12h^2}$\n2. 主截断误差项：$-\\frac{1}{90}h^4 u^{(6)}(x_i)$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{-u_{i-2} + 16u_{i-1} - 30u_i + 16u_{i+1} - u_{i+2}}{12h^2} \\\\ -\\frac{1}{90}h^4 u^{(6)}(x_i)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后，我们将从抛物型方程转向双曲型方程，探索波传播现象的离散化。本练习  深入探讨了一维波动方程的色散特性，要求您对两种不同的显式格式进行冯·诺依曼稳定性分析。通过计算并比较它们的数值相速度，您将亲身体会到不同离散策略如何影响波的传播，并理解“数值色散”这一在模拟对流主导问题时必须面对的核心概念。",
            "id": "3310226",
            "problem": "考虑一维线性波动方程 $u_{tt} = c^{2} u_{xx}$，该方程定义在空间间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀空间网格上，并定义库朗数 $\\nu = c \\Delta t / \\Delta x$。对于波数为 $k$、无量纲波数为 $\\kappa = k \\Delta x$ 的单个傅里叶模式，分析其在以下两种显式二阶精度离散化格式下的相位色散。\n\n格式 A（二阶方程的标准时间中心和空间中心离散化）：对于网格索引 $j \\in \\mathbb{Z}$ 和时间层 $n \\in \\mathbb{Z}$，\n$$\nu_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1} = \\nu^{2} \\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right).\n$$\n\n格式 B（使用 Lax–Wendroff 方法对单向平流进行基于特征线的行波分量演化）：将解分解为右行和左行分量，每个分量满足形式为 $w_{t} \\pm c w_{x} = 0$ 的单向波动方程。使用 Lax–Wendroff 方法对每个单向方程进行离散化，\n$$\nw_{j}^{n+1} = w_{j}^{n} \\mp \\frac{\\nu}{2} \\left(w_{j+1}^{n} - w_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2} \\left(w_{j+1}^{n} - 2 w_{j}^{n} + w_{j-1}^{n}\\right),\n$$\n并通过相应的单向分量的色散来解释全波动方程的单个右行傅里叶模式的相位色散。\n\n对每种格式，对单个傅里葉模式 $u_{j}^{n} = \\exp(i(j\\kappa - n\\theta))$ 进行离散傅里叶（von Neumann）分析，以获得每时间步的数值相位 $\\theta(\\kappa,\\nu)$。定义数值相速度 $c_{\\text{num}} = (\\theta/\\Delta t) / k = (c/\\nu)\\, \\theta/\\kappa$，并考虑小波数展开\n$$\n\\frac{c_{\\text{num}}}{c} = 1 + \\alpha(\\nu)\\, \\kappa^{2} + \\mathcal{O}(\\kappa^{4}).\n$$\n令 $\\alpha_{A}(\\nu)$ 和 $\\alpha_{B}(\\nu)$ 分别表示格式 A 和格式 B 的系数。\n\n从第一性原理推导 $\\alpha_{A}(\\nu)$ 和 $\\alpha_{B}(\\nu)$，并给出差值 $\\Delta \\alpha(\\nu) = \\alpha_{B}(\\nu) - \\alpha_{A}(\\nu)$ 的解析表达式。\n您的最终答案必须是仅含 $\\nu$ 的单个闭式表达式。不需要进行数值舍入，最终表达式中也不应包含任何物理单位。",
            "solution": "本问题要求推导一维波动方程的两种数值格式的领头阶相位色散误差系数 $\\alpha_A(\\nu)$ 和 $\\alpha_B(\\nu)$，并计算它们的差值 $\\Delta \\alpha(\\nu) = \\alpha_{B}(\\nu) - \\alpha_{A}(\\nu)$。\n\n分析是针对形式为 $u_{j}^{n} = \\exp(i(j\\kappa - n\\theta))$ 的单个傅里叶模式进行的，其中 $\\kappa = k \\Delta x$ 是无量纲波数，$\\theta$ 是每时间步的数值相移。放大因子为 $G = u_j^{n+1}/u_j^n = \\exp(-i\\theta)$。数值相速度 $c_{\\text{num}}$与真实相速度 $c$ 的比值由下式给出\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\theta / (k \\Delta t)}{c} = \\frac{\\theta}{(k \\Delta x)(c \\Delta t / \\Delta x)} = \\frac{\\theta}{\\kappa \\nu}\n$$\n领头阶色散误差系数 $\\alpha(\\nu)$ 由小 $\\kappa$ 展开定义\n$$\n\\frac{c_{\\text{num}}}{c} = 1 + \\alpha(\\nu) \\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\n\n首先，我们分析格式 A：\n$$\nu_{j}^{n+1} - 2 u_{j}^{n} + u_{j}^{n-1} = \\nu^{2} \\left(u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\n将傅里叶模式 $u_j^n = G^n \\exp(ij\\kappa)$ 代入格式，得到：\n$$\n(G - 2 + G^{-1}) G^n \\exp(ij\\kappa) = \\nu^2 (\\exp(i\\kappa) - 2 + \\exp(-i\\kappa)) G^n \\exp(ij\\kappa)\n$$\n除以公因子 $G^n \\exp(ij\\kappa)$ 并使用欧拉恒等式 $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos(\\phi)$，我们得到：\n$$\n2\\cos(\\theta) - 2 = \\nu^2(2\\cos(\\kappa) - 2)\n$$\n使用半角恒等式 $1-\\cos(\\phi) = 2\\sin^2(\\phi/2)$：\n$$\n-4\\sin^2(\\frac{\\theta}{2}) = -2\\nu^2(1-\\cos(\\kappa)) = -4\\nu^2\\sin^2(\\frac{\\kappa}{2})\n$$\n这给出了格式 A 的数值色散关系：\n$$\n\\sin\\left(\\frac{\\theta}{2}\\right) = \\nu \\sin\\left(\\frac{\\kappa}{2}\\right)\n$$\n这里我们选择对应于前向传播波的正根。由此，我们得到 $\\theta = 2\\arcsin(\\nu\\sin(\\kappa/2))$。为了求出 $\\alpha_A(\\nu)$，我们对小 $\\kappa$ 展开 $\\theta$：\n$$\n\\sin\\left(\\frac{\\kappa}{2}\\right) = \\frac{\\kappa}{2} - \\frac{1}{3!}\\left(\\frac{\\kappa}{2}\\right)^3 + \\mathcal{O}(\\kappa^5) = \\frac{\\kappa}{2} - \\frac{\\kappa^3}{48} + \\mathcal{O}(\\kappa^5)\n$$\n令 $X = \\nu\\sin(\\kappa/2) = \\frac{\\nu\\kappa}{2} - \\frac{\\nu\\kappa^3}{48} + \\mathcal{O}(\\kappa^5)$。使用 $\\arcsin(X) = X + \\frac{X^3}{6} + \\mathcal{O}(X^5)$：\n$$\n\\frac{\\theta}{2} = \\arcsin\\left(\\nu\\sin\\left(\\frac{\\kappa}{2}\\right)\\right) = \\left(\\frac{\\nu\\kappa}{2} - \\frac{\\nu\\kappa^3}{48}\\right) + \\frac{1}{6}\\left(\\frac{\\nu\\kappa}{2}\\right)^3 + \\mathcal{O}(\\kappa^5)\n$$\n$$\n\\frac{\\theta}{2} = \\frac{\\nu\\kappa}{2} - \\frac{\\nu\\kappa^3}{48} + \\frac{\\nu^3\\kappa^3}{48} + \\mathcal{O}(\\kappa^5) = \\frac{\\nu\\kappa}{2} + \\frac{\\nu^3-\\nu}{48}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\n$$\n\\theta = \\nu\\kappa + \\frac{\\nu^3-\\nu}{24}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\n现在，我们求相速度比：\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\theta}{\\nu\\kappa} = \\frac{1}{\\nu\\kappa}\\left(\\nu\\kappa + \\frac{\\nu(\\nu^2-1)}{24}\\kappa^3 + \\mathcal{O}(\\kappa^5)\\right) = 1 + \\frac{\\nu^2-1}{24}\\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\n通过与定义进行比较，我们确定格式 A 的系数：\n$$\n\\alpha_A(\\nu) = \\frac{\\nu^2-1}{24}\n$$\n\n接下来，我们分析满足 $w_t+cw_x=0$ 的右行波的格式 B。问题指出这对应于 Lax-Wendroff 离散化：\n$$\nw_{j}^{n+1} = w_{j}^{n} - \\frac{\\nu}{2} \\left(w_{j+1}^{n} - w_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2} \\left(w_{j+1}^{n} - 2 w_{j}^{n} + w_{j-1}^{n}\\right)\n$$\n代入傅里叶模式 $w_j^n = G^n \\exp(ij\\kappa)$ 得到放大因子 $G$：\n$$\nG = 1 - \\frac{\\nu}{2}(\\exp(i\\kappa) - \\exp(-i\\kappa)) + \\frac{\\nu^2}{2}(\\exp(i\\kappa) - 2 + \\exp(-i\\kappa))\n$$\n$$\nG = 1 - i\\nu\\sin(\\kappa) + \\nu^2(\\cos(\\kappa)-1) = 1 - i\\nu\\sin(\\kappa) - 2\\nu^2\\sin^2\\left(\\frac{\\kappa}{2}\\right)\n$$\n数值相位为 $\\theta = -\\arg(G)$。\n$$\n\\theta = -\\arctan\\left(\\frac{\\text{Im}(G)}{\\text{Re}(G)}\\right) = -\\arctan\\left(\\frac{-\\nu\\sin(\\kappa)}{1-2\\nu^2\\sin^2(\\kappa/2)}\\right) = \\arctan\\left(\\frac{\\nu\\sin(\\kappa)}{1-2\\nu^2\\sin^2(\\kappa/2)}\\right)\n$$\n为了求出 $\\alpha_B(\\nu)$，我们对小 $\\kappa$ 展开 $\\theta$。令 $Y$ 为反正切函数的自变量。\n分子：$\\nu\\sin(\\kappa) = \\nu\\left(\\kappa - \\frac{\\kappa^3}{6} + \\mathcal{O}(\\kappa^5)\\right)$。\n分母：$1 - 2\\nu^2\\sin^2(\\kappa/2) = 1 - 2\\nu^2\\left(\\frac{\\kappa}{2} - \\frac{\\kappa^3}{48} + \\dots\\right)^2 = 1 - 2\\nu^2\\left(\\frac{\\kappa^2}{4} - \\frac{\\kappa^4}{48} + \\dots\\right) = 1 - \\frac{\\nu^2\\kappa^2}{2} + \\frac{\\nu^2\\kappa^4}{24} + \\dots$。\n进行除法运算：\n$$\nY = \\frac{\\nu\\kappa - \\frac{\\nu}{6}\\kappa^3 + \\dots}{1 - \\frac{\\nu^2}{2}\\kappa^2 + \\dots} = \\left(\\nu\\kappa - \\frac{\\nu}{6}\\kappa^3 + \\dots\\right)\\left(1 + \\frac{\\nu^2}{2}\\kappa^2 + \\dots\\right) = \\nu\\kappa + \\frac{\\nu^3}{2}\\kappa^3 - \\frac{\\nu}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5) = \\nu\\kappa + \\frac{3\\nu^3-\\nu}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\n现在，展开 $\\theta = \\arctan(Y) = Y - \\frac{Y^3}{3} + \\mathcal{O}(Y^5)$：\n$$\n\\theta = \\left(\\nu\\kappa + \\frac{3\\nu^3-\\nu}{6}\\kappa^3\\right) - \\frac{1}{3}(\\nu\\kappa)^3 + \\mathcal{O}(\\kappa^5) = \\nu\\kappa + \\left(\\frac{3\\nu^3-\\nu}{6} - \\frac{\\nu^3}{3}\\right)\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\n$$\n\\theta = \\nu\\kappa + \\frac{3\\nu^3 - \\nu - 2\\nu^3}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5) = \\nu\\kappa + \\frac{\\nu^3-\\nu}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5)\n$$\n相速度比为：\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\theta}{\\nu\\kappa} = \\frac{1}{\\nu\\kappa}\\left(\\nu\\kappa + \\frac{\\nu(\\nu^2-1)}{6}\\kappa^3 + \\mathcal{O}(\\kappa^5)\\right) = 1 + \\frac{\\nu^2-1}{6}\\kappa^2 + \\mathcal{O}(\\kappa^4)\n$$\n因此，格式 B 的系数为：\n$$\n\\alpha_B(\\nu) = \\frac{\\nu^2-1}{6}\n$$\n最后，我们计算差值 $\\Delta\\alpha(\\nu) = \\alpha_B(\\nu) - \\alpha_A(\\nu)$：\n$$\n\\Delta\\alpha(\\nu) = \\frac{\\nu^2-1}{6} - \\frac{\\nu^2-1}{24} = (\\nu^2-1)\\left(\\frac{1}{6} - \\frac{1}{24}\\right) = (\\nu^2-1)\\left(\\frac{4-1}{24}\\right) = (\\nu^2-1)\\left(\\frac{3}{24}\\right)\n$$\n$$\n\\Delta\\alpha(\\nu) = \\frac{\\nu^2-1}{8}\n$$",
            "answer": "$$\\boxed{\\frac{\\nu^2 - 1}{8}}$$"
        }
    ]
}