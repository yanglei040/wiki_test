{
    "hands_on_practices": [
        {
            "introduction": "我们将从许多数值方法最基本的构件——单元插值——开始。即使是像双线性插值这样在每个方向上都是线性的简单方法，如果节点值处理不当或几何形状发生扭曲，也可能产生非物理的负值。这个练习 () 提供了一个具体可视化的例子，并介绍了一种简单的全局缩放限制器来纠正这个问题，为理解更复杂的保正方法奠定基础。",
            "id": "3352405",
            "problem": "考虑一个用于计算流体动力学中输运非负标量场插值的二维四边形有限元。四个顶点（按逆时针顺序）的物理坐标由 $\\boldsymbol{x}_{1}=(0,0)$、$\\boldsymbol{x}_{2}=(2,0.5)$、$\\boldsymbol{x}_{3}=(2.5,1.5)$ 和 $\\boldsymbol{x}_{4}=(0.5,1.0)$ 给出。这是一个倾斜的平行四边形，因此从坐标为 $(\\xi,\\eta)\\in[-1,1]^{2}$ 的参考正方形到该单元的等参映射是仿射且保向的。在参考正方形上，使用与四个顶点相关联的标准双线性（一阶）拉格朗日形函数 $N_{i}(\\xi,\\eta)$。标量的节点值指定为 $u_{1}=0.80$、$u_{2}=0.30$、$u_{3}=-0.10$ 和 $u_{4}=0.40$。\n\n从双线性形函数的定义和输运标量正定性的基本要求出发，回答以下问题：\n\n1. 判断双线性插值函数 $u_{h}(\\boldsymbol{x})=\\sum_{i=1}^{4}N_{i}(\\xi(\\boldsymbol{x}),\\eta(\\boldsymbol{x}))\\,u_{i}$ 是否在单元内任何一点变为负值。\n\n2. 为了在最小化高阶精度损失的情况下强制正定性，考虑由 $u_{h}^{\\text{lim}}(\\boldsymbol{x})=u_{\\text{avg}}+\\theta\\left(u_{h}(\\boldsymbol{x})-u_{\\text{avg}}\\right)$ 定义的全局缩放限制器，其中单个参数 $\\theta\\in[0,1]$ 在单元内均匀应用，而 $u_{\\text{avg}}$ 是 $u_{h}$ 在物理单元上的单元平均值。假设映射是仿射的（因此雅可比行列式为常数），计算保证单元内所有 $\\boldsymbol{x}$ 都满足 $u_{h}^{\\text{lim}}(\\boldsymbol{x})\\ge 0$ 的最小缩放因子 $\\theta$。\n\n将最终的缩放因子表示为一个精确分数。无需四舍五入。最终答案必须是一个数字。",
            "solution": "该问题要求关于四边形有限元上双线性插值的两个主要结果：首先，判断插值标量场 $u_h$ 是否会变为负值；其次，为保正限制器计算一个缩放因子 $\\theta$。\n\n分析在参考单元上进行，该单元是一个由 $(\\xi, \\eta) \\in [-1,1]^2$ 定义的正方形。到顶点为 $\\boldsymbol{x}_{1}=(0,0)$、$\\boldsymbol{x}_{2}=(2,0.5)$、$\\boldsymbol{x}_{3}=(2.5,1.5)$ 和 $\\boldsymbol{x}_{4}=(0.5,1.0)$ 的物理单元的等参映射是仿射的，因为物理单元是一个平行四边形。这可以通过验证 $\\boldsymbol{x}_{2}-\\boldsymbol{x}_{1} = \\boldsymbol{x}_{3}-\\boldsymbol{x}_{4} = (2, 0.5)$ 和 $\\boldsymbol{x}_{4}-\\boldsymbol{x}_{1} = \\boldsymbol{x}_{3}-\\boldsymbol{x}_{2} = (0.5, 1.0)$ 来确认。\n\n双线性插值函数 $u_h$ 使用参考正方形上的标准拉格朗日形函数来定义，这些形函数对应于从 $(\\xi,\\eta)=(-1,-1)$ 开始逆时针编号的顶点：\n$N_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\n插值标量场由 $u_{h}(\\xi,\\eta) = \\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,u_{i}$ 给出，其中节点值为 $u_{1}=0.80$、$u_{2}=0.30$、$u_{3}=-0.10$ 和 $u_{4}=0.40$。\n\n第1部分：判断 $u_h(\\boldsymbol{x})$ 的正定性。\n矩形域上双线性函数的一个基本性质是其全局极值（最小值和最大值）保证出现在域的四个顶点之一。因此，要找到 $u_h$ 在整个单元上的最小值，我们只需检查其在参考正方形顶点处的值。根据等参插值的定义，这些值恰好是节点值 $u_i$。\n插值函数的最小值 $u_{\\min}$ 为：\n$$u_{\\min} = \\min_{(\\xi,\\eta) \\in [-1,1]^2} u_h(\\xi, \\eta) = \\min\\{u_1, u_2, u_3, u_4\\}$$\n代入给定的节点值：\n$$u_{\\min} = \\min\\{0.80, 0.30, -0.10, 0.40\\} = -0.10$$\n由于 $u_{\\min} = -0.10$，小于 $0$，因此双线性插值函数 $u_h(\\boldsymbol{x})$ 确实在单元内的某一点变为负值。具体来说，最小值出现在顶点 $(\\xi,\\eta)=(1,1)$，它对应于物理顶点 $\\boldsymbol{x}_3$。\n\n第2部分：计算缩放因子 $\\theta$。\n保正限制器定义为 $u_{h}^{\\text{lim}}(\\boldsymbol{x})=u_{\\text{avg}}+\\theta\\left(u_{h}(\\boldsymbol{x})-u_{\\text{avg}}\\right)$，其中 $\\theta \\in [0,1]$。我们必须对单元内所有的 $\\boldsymbol{x}$ 强制 $u_{h}^{\\text{lim}}(\\boldsymbol{x}) \\ge 0$。\n\n首先，我们计算单元平均值 $u_{\\text{avg}}$。由于映射是仿射的，变换的雅可比行列式是常数。物理空间中的单元平均值等于参考单元上的平均值：\n$$u_{\\text{avg}} = \\frac{\\int_E u_h d\\boldsymbol{x}}{\\int_E d\\boldsymbol{x}} = \\frac{\\int_{-1}^1 \\int_{-1}^1 u_h(\\xi,\\eta) J d\\xi d\\eta}{\\int_{-1}^1 \\int_{-1}^1 J d\\xi d\\eta} = \\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 u_h(\\xi,\\eta) d\\xi d\\eta$$\n代入 $u_h$ 的定义：\n$$u_{\\text{avg}} = \\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 \\left(\\sum_{i=1}^4 N_i(\\xi, \\eta) u_i\\right) d\\xi d\\eta = \\sum_{i=1}^4 u_i \\left(\\frac{1}{4} \\int_{-1}^1 \\int_{-1}^1 N_i(\\xi, \\eta) d\\xi d\\eta\\right)$$\n任何双线性形函数在参考单元上的积分都是 $\\int_{-1}^1 \\int_{-1}^1 N_i(\\xi, \\eta) d\\xi d\\eta = 1$。因此，单元平均值是节点值的算术平均值：\n$$u_{\\text{avg}} = \\frac{1}{4} \\sum_{i=1}^{4} u_{i} = \\frac{1}{4}(0.80 + 0.30 - 0.10 + 0.40) = \\frac{1.40}{4} = 0.35$$\n条件 $u_{h}^{\\text{lim}} \\ge 0$ 即为 $u_{\\text{avg}}+\\theta\\left(u_{h}(\\boldsymbol{x})-u_{\\text{avg}}\\right) \\ge 0$。这个不等式必须对单元内所有点都成立。最严格的情况发生在 $u_h$ 取最小值处，即 $u_{\\min} = -0.10$。\n因此我们必须满足：\n$$u_{\\text{avg}} + \\theta(u_{\\min} - u_{\\text{avg}}) \\ge 0$$\n代入 $u_{\\text{avg}}$ 和 $u_{\\min}$ 的值：\n$$0.35 + \\theta(-0.10 - 0.35) \\ge 0$$\n$$0.35 - 0.45\\theta \\ge 0$$\n$$0.35 \\ge 0.45\\theta$$\n这给出了 $\\theta$ 的一个上界：\n$$\\theta \\le \\frac{0.35}{0.45}$$\n范围 $[0, \\frac{0.35}{0.45}]$ 内的任何 $\\theta$ 都能保证解为非负。问题要求的是“在最小化高阶精度损失的情况下”强制正定性的因子。要最小化精度损失，应施加尽可能少的限制，这对应于选择可能的最大 $\\theta$ 值。因此，措辞“最小缩放因子”被解释为这个临界上界，该值使得受限解在其最小值处恰好为非负。\n$$\\theta = \\frac{0.35}{0.45} = \\frac{35}{45}$$\n将其表示为最简精确分数：\n$$\\theta = \\frac{5 \\times 7}{5 \\times 9} = \\frac{7}{9}$$\n这就是所要求的缩放因子。",
            "answer": "$$\\boxed{\\frac{7}{9}}$$"
        },
        {
            "introduction": "现在我们从简单的单元插值转向有限体积法中的高阶重构。像WENO这样的高阶方法虽然功能强大，但并非天生就保证物理量（如浅水深度 $h$）的正定性，并且可能产生过冲或下冲。这个练习 () 将在浅水方程的背景下展示这种失效模式，并阐明缩放限制器的作用。它还将澄清一个常见的误解，即认为总变差递减(TVD)格式可以避免此类问题。",
            "id": "3352454",
            "problem": "考虑一维浅水方程，这是一个关于水深 $h(x,t)$ 和动量 $m(x,t)=h(x,t)u(x,t)$ 的守恒律方程组，其中 $u(x,t)$ 是速度。物理真实性要求对于所有的 $x$ 和 $t$，水深 $h(x,t)\\ge 0$ 逐点成立。在有限体积离散中，单元 $i$ 内的单元平均水深 $\\bar{h}_i$ 定义为 $\\bar{h}_i=\\frac{1}{\\Delta x}\\int_{I_i}h(x)\\,\\mathrm{d}x$，其中 $I_i$ 是宽度为 $\\Delta x$ 的空间单元。假设使用五阶加权基本无振荡 (WENO) 重构，从相邻单元的平均值中获得给定单元内节点上的逐点值，例如在单元 $i$ 内的三个 Gauss–Lobatto 节点上：左界面 $x_{i-1/2}$、单元中心 $x_i$ 和右界面 $x_{i+1/2}$。\n\n给定单元 $i$ 周围非负单元平均水深的局部配置如下：\n$$\n\\bar{h}_{i-2}=\\frac{1}{10},\\quad \\bar{h}_{i-1}=\\frac{1}{20},\\quad \\bar{h}_{i}=\\frac{3}{100},\\quad \\bar{h}_{i+1}=\\frac{1}{50},\\quad \\bar{h}_{i+2}=\\frac{1}{25}.\n$$\n假设单元 $i$ 内的非线性 WENO 重构在 Gauss–Lobatto 节点上产生以下逐点值：\n$$\nh^{\\mathrm{rec}}(x_{i-1/2})=-\\frac{1}{250},\\qquad h^{\\mathrm{rec}}(x_{i})=\\frac{1}{20},\\qquad h^{\\mathrm{rec}}(x_{i+1/2})=\\frac{1}{50}.\n$$\n这是一种过冲/下冲的情况：所有五个单元的平均值都是非负的，但左侧重构节点的值是负的。为了强制保持正性，考虑在单元 $i$ 中对高阶重构进行朝向单元平均值的标准凸缩放：\n$$\nh^{\\mathrm{lim}}(\\xi)=\\theta\\left(h^{\\mathrm{rec}}(\\xi)-\\bar{h}_i\\right)+\\bar{h}_i,\\quad \\xi\\in\\{x_{i-1/2},x_i,x_{i+1/2}\\},\n$$\n其中单个标量参数 $\\theta\\in[0,1]$ 的选择应使得在所有三个节点上都有 $h^{\\mathrm{lim}}(\\xi)\\ge 0$。假设没有干区容差，即在任何正性条件中设置 $\\epsilon=0$，并且不要改变 $\\bar{h}_i$。\n\n从守恒律要求 $h\\ge 0$ 和上述定义出发，确定能保证在单元 $i$ 的三个节点上 $h^{\\mathrm{lim}}(\\xi)\\ge 0$ 的最小 $\\theta\\in[0,1]$。请以单个闭式表达式的形式给出 $\\theta$ 的精确值。\n\n此外，请利用有限体积序列 $\\{\\bar{h}_j\\}$ 上总变差减小 (TVD) 的定义，解释为什么在这种情况下，单元平均值上的 TVD 属性并不能排除在 $x_{i-1/2}$ 处出现负的逐点重构值。\n\n您的最终答案必须是单个实数值或单个闭式表达式。不需要四舍五入，并且最终的方框答案中不要包含任何单位。",
            "solution": "这个问题是有效的，因为它在计算流体动力学领域有科学依据，特别是关于守恒律的保正高阶数值方法。它是一个适定的、客观的问题，并包含了推导出一个唯一的、有意义的解所需的所有信息。\n\n问题包含两部分。首先，我们必须确定参数 $\\theta \\in [0, 1]$ 的最小值，以确保限制后的解具有正性。其次，我们必须解释为什么单元平均值的总变差减小 (TVD) 属性不能阻止高阶重构中出现负的逐点值。\n\n第1部分：确定限制器参数 $\\theta$。\n\n保正限制器是一种凸缩放，定义为：\n$$\nh^{\\mathrm{lim}}(\\xi) = \\theta \\left(h^{\\mathrm{rec}}(\\xi) - \\bar{h}_i\\right) + \\bar{h}_i\n$$\n其中 $\\xi$ 代表单元 $i$ 内的一个节点。寻求参数 $\\theta$ 是为了在三个指定的 Gauss–Lobatto 节点 $\\xi \\in \\{x_{i-1/2}, x_i, x_{i+1/2}\\}$ 上强制执行物理约束 $h^{\\mathrm{lim}}(\\xi) \\ge 0$。问题陈述没有使用干区容差，这意味着水深的下界严格为 $0$。\n\n单元 $i$ 的给定数据为：\n- 单元平均值：$\\bar{h}_i = \\frac{3}{100}$\n- 节点上的重构值：\n  - $h^{\\mathrm{rec}}(x_{i-1/2}) = -\\frac{1}{250}$\n  - $h^{\\mathrm{rec}}(x_i) = \\frac{1}{20}$\n  - $h^{\\mathrm{rec}}(x_{i+1/2}) = \\frac{1}{50}$\n\n我们必须确保对于三个节点中的每一个都有 $h^{\\mathrm{lim}}(\\xi) \\ge 0$。这会产生关于 $\\theta$ 的三个不等式。\n\n1.  在节点 $\\xi = x_{i-1/2}$ 处：\n    条件是 $\\theta \\left(h^{\\mathrm{rec}}(x_{i-1/2}) - \\bar{h}_i\\right) + \\bar{h}_i \\ge 0$。\n    代入数值：\n    $$\n    \\theta \\left(-\\frac{1}{250} - \\frac{3}{100}\\right) + \\frac{3}{100} \\ge 0\n    $$\n    让我们计算括号中的项：\n    $$\n    -\\frac{1}{250} - \\frac{3}{100} = -\\frac{2}{500} - \\frac{15}{500} = -\\frac{17}{500}\n    $$\n    不等式变为：\n    $$\n    \\theta \\left(-\\frac{17}{500}\\right) + \\frac{3}{100} \\ge 0 \\implies \\frac{3}{100} \\ge \\theta \\left(\\frac{17}{500}\\right)\n    $$\n    解出 $\\theta$：\n    $$\n    \\theta \\le \\frac{3}{100} \\times \\frac{500}{17} = \\frac{3 \\times 5}{17} = \\frac{15}{17}\n    $$\n    这是关键约束，源于具有负下冲的节点。\n\n2.  在节点 $\\xi = x_i$ 处：\n    条件是 $\\theta \\left(h^{\\mathrm{rec}}(x_i) - \\bar{h}_i\\right) + \\bar{h}_i \\ge 0$。\n    代入数值：\n    $$\n    \\theta \\left(\\frac{1}{20} - \\frac{3}{100}\\right) + \\frac{3}{100} \\ge 0\n    $$\n    括号中的项是 $\\frac{5}{100} - \\frac{3}{100} = \\frac{2}{100} = \\frac{1}{50}$，为正值。\n    不等式是 $\\theta \\left(\\frac{1}{50}\\right) + \\frac{3}{100} \\ge 0$。由于 $\\theta \\ge 0$ 且所有其他项均为正，因此对于 $\\theta \\in [0, 1]$，该不等式总是成立。具体来说，$\\theta \\ge - \\frac{3}{100} \\times 50 = -\\frac{3}{2}$，这与 $\\theta \\in [0,1]$ 一致。\n\n3.  在节点 $\\xi = x_{i+1/2}$ 处：\n    条件是 $\\theta \\left(h^{\\mathrm{rec}}(x_{i+1/2}) - \\bar{h}_i\\right) + \\bar{h}_i \\ge 0$。\n    代入数值：\n    $$\n    \\theta \\left(\\frac{1}{50} - \\frac{3}{100}\\right) + \\frac{3}{100} \\ge 0\n    $$\n    括号中的项是 $\\frac{2}{100} - \\frac{3}{100} = -\\frac{1}{100}$。\n    不等式变为：\n    $$\n    \\theta \\left(-\\frac{1}{100}\\right) + \\frac{3}{100} \\ge 0 \\implies \\frac{3}{100} \\ge \\theta \\left(\\frac{1}{100}\\right) \\implies \\theta \\le 3\n    $$\n    对于 $\\theta \\in [0, 1]$，这个条件也总是成立的。\n\n结合这些约束，我们必须有 $\\theta \\in [0, 1]$ 和 $\\theta \\le \\frac{15}{17}$。所有保证正性的 $\\theta$ 值的集合是区间 $[0, \\frac{15}{17}]$。\n\n问题要求的是“保证”正性的“最小 $\\theta$”。这种措辞有些模棱两可。过于字面的解释会得出 $\\theta=0$，这对应于回退到一阶精度的常数重构 ($h^{\\mathrm{lim}}(\\xi) = \\bar{h}_i$)，这是一个功能上正确但在实践中很差的选择，因为它丢弃了高阶信息。设计此类限制器的标准做法是尽可能地减少侵入性，这意味着选择满足约束的尽可能大的 $\\theta$ 值。这个值在确保物理性质的同时保留了尽可能高的精度阶。这个值是 $\\theta = \\frac{15}{17}$，它使得限制后函数的最小值恰好为零。措辞“最小 $\\theta$”在数值方法的背景下最好被解释为由限制算法计算出的特定值，该值代表了容许参数区域的边界。这个值对应于对高阶重构的最小必要修正。因此，我们选择值 $\\theta = \\frac{15}{17}$。\n\n第2部分：TVD 属性和逐点负值。\n\n有限体积格式的总变差减小 (TVD) 属性适用于单元平均值序列 $\\{\\bar{h}_j\\}$。总变差定义为 $TV(\\bar{h}) = \\sum_j |\\bar{h}_{j+1} - \\bar{h}_j|$。如果单元平均值的总变差在一个时间步内不增加，即 $TV(\\bar{h}^{n+1}) \\le TV(\\bar{h}^n)$，则该格式是 TVD 的。\n\n解释的核心在于离散单元平均值的属性与连续的单元内重构的属性之间的区别。\n1.  TVD 属性是关于离散单元平均值序列 $\\{\\bar{h}_j\\}$ 的一个全局陈述。它旨在控制单元平均值层面的振荡，防止在序列 $\\{\\bar{h}_j\\}$ 中形成新的伪极值。\n2.  然而，它不对每个单元内重构的高阶多项式 $h^{\\mathrm{rec}}(x)$ 的逐点行为施加任何限制。高阶重构（如指定的五阶 WENO）基于相邻单元平均值的模板（在本例中为 $\\{\\bar{h}_{i-2}, \\dots, \\bar{h}_{i+2}\\}$）来构建一个多项式。\n3.  即使单元平均值数据是正的并且满足 TVD 条件，重构的多项式也可能局部地“过冲”或“下冲”数据的范围，这种行为与高次多项式插值的 Runge 现象有关。这在基础数据中存在陡峭梯度或局部极值附近尤为常见。\n4.  在给定的问题中，单元平均值序列为 $\\bar{h}_{i-2}=\\frac{1}{10}$、$\\bar{h}_{i-1}=\\frac{1}{20}$、$\\bar{h}_{i}=\\frac{3}{100}$、$\\bar{h}_{i+1}=\\frac{1}{50}$、$\\bar{h}_{i+2}=\\frac{1}{25}$，其十进制形式为 $0.1, 0.05, 0.03, 0.02, 0.04$。该数据序列在 $\\bar{h}_{i+1}$ 处有一个局部最小值。用高阶多项式在此类局部最小值上重构光滑函数是数值下冲的经典场景。WENO 格式试图通过非线性地选择最光滑的子模板来减轻这种情况，但并不能保证完全消除此类人为现象，正如最终得到的负值 $h^{\\mathrm{rec}}(x_{i-1/2})=-\\frac{1}{250}$ 所证明的那样。\n\n总而言之，TVD 属性是离散单元平均值序列的一个属性，确保其无振荡演化。它不保证每个单元内高阶重构多项式的局部正性甚至单调性。因此，出现负的逐点重构值与一个对其单元平均值是 TVD 的格式是完全兼容的。",
            "answer": "$$\\boxed{\\frac{15}{17}}$$"
        },
        {
            "introduction": "最后，我们将问题的复杂性提升到一个完全耦合的守恒律系统——可压缩欧拉方程。在这里，解的可容许性不仅仅是关于单个变量为正，而是关系到整个状态向量在热力学上是否有效（例如，正密度 $\\rho$ *和* 正压力 $p$）。这个练习 () 展示了如何将单个限制参数应用于守恒变量的向量，以同时强制执行这些耦合的约束条件，确保最终解的物理真实性。",
            "id": "3352416",
            "problem": "考虑带理想气体状态方程的一维可压缩欧拉方程，其守恒状态为 $U = (\\rho, m, E)^{\\top}$，其中 $m = \\rho u$，压力由 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\dfrac{m^{2}}{\\rho}\\right)$ 给出。在间断伽辽金 (DG) 方法的单个网格中，已知网格平均状态是严格容许的。你将通过使用单一因子 $\\theta \\in [0,1]$ 将所有守恒场向网格平均值进行线性缩放，从而在求积点处强制实现正性。\n\n该网格的数据如下：\n- 比热比：$\\gamma = 1.4$。\n- 正性阈值：$\\varepsilon = 0.05$。\n- 网格平均变量：$\\bar{\\rho} = 1$，$\\bar{u} = 0.2$，$\\bar{p} = 1$。使用这些值来确定 $\\bar{m}$ 和 $\\bar{E}$。\n- 在两个求积点 $x_{1}$ 和 $x_{2}$ 处，给定未限制的节点值 $(\\rho, p)$：\n  - 在 $x_{1}$ 处：$\\rho_{1} = 0.01$， $p_{1} = 0.02$。\n  - 在 $x_{2}$ 处：$\\rho_{2} = 1.8$， $p_{2} = 0.5$。\n- 假设点速度等于网格平均速度，即 $u(x_{1}) = u(x_{2}) = \\bar{u}$。\n\n将每个求积点处的限制后状态定义为\n$$\nU_{\\theta}(x_{j}) \\;=\\; \\bar{U} \\;+\\; \\theta\\big(U(x_{j}) - \\bar{U}\\big), \\quad j \\in \\{1,2\\},\n$$\n其中 $U = (\\rho, m, E)^{\\top}$，$m = \\rho u$，且 $E$ 是根据给定的 $(\\rho, p)$ 和假定的速度，通过理想气体关系式确定的。确定单一最大的 $\\theta \\in [0,1]$，使得在两个求积点上，限制后的值同时满足容许性条件\n$$\n\\rho_{\\theta}(x_{j}) \\;\\ge\\; \\varepsilon, \n\\quad\np_{\\theta}(x_{j}) \\;\\ge\\; \\varepsilon,\n\\quad j \\in \\{1,2\\}.\n$$\n\n你的最终答案必须是此网格限制因子 $\\theta$ 的数值。如果可能，请给出精确值。如果选择报告小数，请将答案四舍五入到六位有效数字。",
            "solution": "该问题是有效的。这是一个计算流体力学领域的适定问题，具体涉及高阶间断伽辽金 (DG) 方法的保正限制器。所有必要的数据和定义都已提供，问题在科学上是合理的且客观的。\n\n目标是找到单一最大的缩放因子 $\\theta \\in [0,1]$，使得线性缩放后的状态 $U_{\\theta}(x_j) = \\bar{U} + \\theta(U(x_j) - \\bar{U})$ 在两个求积点 $j \\in \\{1,2\\}$ 上同时满足容许性条件 $\\rho_{\\theta}(x_j) \\ge \\varepsilon$ 和 $p_{\\theta}(x_j) \\ge \\varepsilon$。\n\n首先，我们必须确定网格平均的守恒状态向量 $\\bar{U}$ 以及在求积点 $U(x_1)$ 和 $U(x_2)$ 处的守恒状态向量。守恒状态向量为 $U = (\\rho, m, E)^{\\top}$，其中 $\\rho$ 是密度，$m = \\rho u$ 是动量，$E$ 是单位体积的总能量。压力 $p$ 由理想气体状态方程给出：$p = (\\gamma - 1)(E - \\frac{1}{2}\\frac{m^2}{\\rho})$。\n\n给定数据包括比热比 $\\gamma = 1.4$ 和正性阈值 $\\varepsilon = 0.05$。\n\n**步骤 1：计算网格平均守恒状态 $\\bar{U}$**\n给定网格平均原始变量：$\\bar{\\rho} = 1$, $\\bar{u} = 0.2$, $\\bar{p} = 1$。\n网格平均动量为 $\\bar{m} = \\bar{\\rho}\\bar{u} = 1 \\times 0.2 = 0.2$。\n网格平均总能量 $\\bar{E}$ 可由压力关系式求得：\n$$\n\\bar{p} = (\\gamma - 1)\\left(\\bar{E} - \\frac{1}{2}\\bar{\\rho}\\bar{u}^2\\right)\n$$\n$$\n1 = (1.4 - 1)\\left(\\bar{E} - \\frac{1}{2}(1)(0.2)^2\\right)\n$$\n$$\n1 = 0.4(\\bar{E} - 0.02)\n$$\n$$\n\\bar{E} = \\frac{1}{0.4} + 0.02 = 2.5 + 0.02 = 2.52\n$$\n因此，网格平均守恒状态为 $\\bar{U} = (1, 0.2, 2.52)^{\\top}$。\n\n**步骤 2：计算未限制的守恒状态 $U(x_1)$ 和 $U(x_2)$**\n在两个求积点上，我们假设速度等于网格平均速度，即 $u(x_j) = \\bar{u} = 0.2$。\n\n在求积点 $x_1$ 处：\n给定的原始变量为 $\\rho_1 = 0.01$ 和 $p_1 = 0.02$。速度为 $u_1 = \\bar{u} = 0.2$。\n动量为 $m_1 = \\rho_1 u_1 = 0.01 \\times 0.2 = 0.002$。\n总能量 $E_1$ 可由压力关系式求得：\n$$\np_1 = (\\gamma - 1)\\left(E_1 - \\frac{1}{2}\\rho_1 u_1^2\\right)\n$$\n$$\n0.02 = (1.4 - 1)\\left(E_1 - \\frac{1}{2}(0.01)(0.2)^2\\right)\n$$\n$$\n0.02 = 0.4(E_1 - 0.0002)\n$$\n$$\nE_1 = \\frac{0.02}{0.4} + 0.0002 = 0.05 + 0.0002 = 0.0502\n$$\n因此，在 $x_1$ 处的未限制守恒状态为 $U(x_1) = (0.01, 0.002, 0.0502)^{\\top}$。\n\n在求积点 $x_2$ 处：\n给定的原始变量为 $\\rho_2 = 1.8$ 和 $p_2 = 0.5$。速度为 $u_2 = \\bar{u} = 0.2$。\n动量为 $m_2 = \\rho_2 u_2 = 1.8 \\times 0.2 = 0.36$。\n总能量 $E_2$ 可由压力关系式求得：\n$$\np_2 = (\\gamma - 1)\\left(E_2 - \\frac{1}{2}\\rho_2 u_2^2\\right)\n$$\n$$\n0.5 = (1.4 - 1)\\left(E_2 - \\frac{1}{2}(1.8)(0.2)^2\\right)\n$$\n$$\n0.5 = 0.4(E_2 - 0.036)\n$$\n$$\nE_2 = \\frac{0.5}{0.4} + 0.036 = 1.25 + 0.036 = 1.286\n$$\n因此，在 $x_2$ 处的未限制守恒状态为 $U(x_2) = (1.8, 0.36, 1.286)^{\\top}$。\n\n**步骤 3：建立并求解容许性约束**\n限制后的状态为 $U_{\\theta}(x_j) = (1-\\theta)\\bar{U} + \\theta U(x_j)$。容许性条件为 $\\rho_{\\theta}(x_j) \\ge \\varepsilon$ 和 $p_{\\theta}(x_j) \\ge \\varepsilon$。\n\n对密度 $\\rho_{\\theta}$ 的约束：\n限制后的密度为 $\\rho_{\\theta}(x_j) = \\bar{\\rho} + \\theta(\\rho_j - \\bar{\\rho})$。必须满足条件 $\\rho_{\\theta}(x_j) \\ge \\varepsilon$。\n若 $\\rho_j \\ge \\bar{\\rho}$，则对于 $\\theta \\in [0,1]$ 有 $\\rho_\\theta(x_j) \\ge \\bar{\\rho} = 1  \\varepsilon = 0.05$，因此对 $\\theta$ 没有施加约束（除了 $\\theta \\le 1$）。\n若 $\\rho_j  \\bar{\\rho}$，条件变为 $\\theta(\\bar{\\rho} - \\rho_j) \\le \\bar{\\rho} - \\varepsilon$，这意味着 $\\theta \\le \\frac{\\bar{\\rho} - \\varepsilon}{\\bar{\\rho} - \\rho_j}$。\n\n对于 $x_1$：$\\rho_1 = 0.01  \\bar{\\rho} = 1$。此条件起作用。\n$$\n\\theta \\le \\frac{\\bar{\\rho} - \\varepsilon}{\\bar{\\rho} - \\rho_1} = \\frac{1 - 0.05}{1 - 0.01} = \\frac{0.95}{0.99} = \\frac{95}{99}\n$$\n对于 $x_2$：$\\rho_2 = 1.8 > \\bar{\\rho} = 1$。此条件除了 $\\theta \\le 1$ 外没有对 $\\theta$ 施加其他约束。\n\n对压力 $p_{\\theta}$ 的约束：\n$u(x_j) = \\bar{u}$ 的假设带来了一个关键的简化。我们来证明这意味着压力与 $\\theta$ 成线性关系。\n限制后的变量为 $\\rho_{\\theta} = \\bar{\\rho} + \\theta(\\rho_j - \\bar{\\rho})$，$m_{\\theta} = \\bar{m} + \\theta(m_j - \\bar{m})$，以及 $E_{\\theta} = \\bar{E} + \\theta(E_j - \\bar{E})$。\n由于 $m_j = \\rho_j u_j = \\rho_j \\bar{u}$ 且 $\\bar{m} = \\bar{\\rho}\\bar{u}$，我们有：\n$m_{\\theta} = \\bar{\\rho}\\bar{u} + \\theta(\\rho_j\\bar{u} - \\bar{\\rho}\\bar{u}) = (\\bar{\\rho} + \\theta(\\rho_j - \\bar{\\rho}))\\bar{u} = \\rho_{\\theta}\\bar{u}$。\n这意味着限制后状态的速度是恒定的：$u_{\\theta} = m_{\\theta}/\\rho_{\\theta} = \\bar{u}$。\n那么限制后的压力为：\n$p_{\\theta}(x_j) = (\\gamma - 1)(E_{\\theta} - \\frac{1}{2}\\rho_{\\theta}\\bar{u}^2) = (\\gamma - 1)[(\\bar{E} + \\theta(E_j - \\bar{E})) - \\frac{1}{2}(\\bar{\\rho} + \\theta(\\rho_j - \\bar{\\rho}))\\bar{u}^2]$。\n重新整理各项：\n$p_{\\theta}(x_j) = (\\gamma - 1)[(\\bar{E} - \\frac{1}{2}\\bar{\\rho}\\bar{u}^2) + \\theta((E_j - \\frac{1}{2}\\rho_j\\bar{u}^2) - (\\bar{E} - \\frac{1}{2}\\bar{\\rho}\\bar{u}^2))]$。\n注意到 $p_j = (\\gamma - 1)(E_j - \\frac{1}{2}\\rho_j u_j^2) = (\\gamma - 1)(E_j - \\frac{1}{2}\\rho_j \\bar{u}^2)$ 且 $\\bar{p} = (\\gamma-1)(\\bar{E} - \\frac{1}{2}\\bar{\\rho}\\bar{u}^2)$，我们得到：\n$p_{\\theta}(x_j) = \\bar{p} + \\theta(p_j - \\bar{p})$。\n因此，压力是线性缩放的。条件 $p_{\\theta}(x_j) \\ge \\varepsilon$ 的处理方式与密度约束类似。\n若 $p_j \\ge \\bar{p}$，对 $\\theta$ 没有约束。\n若 $p_j  \\bar{p}$，我们需要 $\\theta \\le \\frac{\\bar{p} - \\varepsilon}{\\bar{p} - p_j}$。\n\n对于 $x_1$：$p_1 = 0.02  \\bar{p} = 1$。此条件起作用。\n$$\n\\theta \\le \\frac{\\bar{p} - \\varepsilon}{\\bar{p} - p_1} = \\frac{1 - 0.05}{1 - 0.02} = \\frac{0.95}{0.98} = \\frac{95}{98}\n$$\n对于 $x_2$：$p_2 = 0.5  \\bar{p} = 1$。此条件起作用。\n$$\n\\theta \\le \\frac{\\bar{p} - \\varepsilon}{\\bar{p} - p_2} = \\frac{1 - 0.05}{1 - 0.5} = \\frac{0.95}{0.5} = 1.9\n$$\n\n**步骤 4：确定 $\\theta$ 的最终值**\n单一因子 $\\theta$ 必须同时满足所有约束，包括 $\\theta \\in [0,1]$。\n推导出的约束条件是：\n1. 来自 $\\rho_{\\theta}(x_1)$：$\\theta \\le \\frac{95}{99}$\n2. 来自 $p_{\\theta}(x_1)$：$\\theta \\le \\frac{95}{98}$\n3. 来自 $\\rho_{\\theta}(x_2)$：除了 $\\theta \\le 1$ 外无其他约束。\n4. 来自 $p_{\\theta}(x_2)$：$\\theta \\le 1.9$，与 $\\theta \\in [0,1]$ 结合意味着 $\\theta \\le 1$。\n\n我们必须找到满足所有这些条件的最大 $\\theta$，因此我们取所有上界的最小值：\n$$\n\\theta \\le \\min\\left(1, \\frac{95}{99}, \\frac{95}{98}, 1.9\\right)\n$$\n比较分数 $\\frac{95}{99}$ 和 $\\frac{95}{98}$，由于分子相同，分母较大的分数较小。因此，$\\frac{95}{99}  \\frac{95}{98}$。两个分数都小于 1。\n最严格的约束是 $\\theta \\le \\frac{95}{99}$。\n因此，限制因子 $\\theta$ 的单一最大值为 $\\frac{95}{99}$。\n\n作为四舍五入到六位有效数字的小数，该值为 $0.959596$。问题要求尽可能给出精确值。",
            "answer": "$$ \\boxed{\\frac{95}{99}} $$"
        }
    ]
}