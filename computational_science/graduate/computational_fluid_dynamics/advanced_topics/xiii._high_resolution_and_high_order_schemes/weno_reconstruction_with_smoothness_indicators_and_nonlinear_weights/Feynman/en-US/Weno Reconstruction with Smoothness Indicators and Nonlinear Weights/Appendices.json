{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any WENO scheme lies in its ability to construct multiple lower-order polynomial approximations on different substencils. This first exercise takes you back to first principles, asking you to derive the explicit formulas for the reconstructed values from each candidate polynomial in a fifth-order WENO scheme . Mastering this derivation is crucial for understanding where the well-known coefficients in WENO implementations come from and how the reconstruction is fundamentally linked to the cell-average data.",
            "id": "3392156",
            "problem": "Consider the scalar conservation law $u_{t} + f(u)_{x} = 0$ discretized by a finite volume method on a uniform mesh with cell centers $x_{j}$, cell interfaces $x_{j\\pm 1/2}$, and cell width $\\Delta x$. Let $\\bar{u}_{j}$ denote the cell average of $u$ over cell $I_{j} = [x_{j-1/2}, x_{j+1/2}]$. In a fifth-order Weighted Essentially Non-Oscillatory (WENO) reconstruction (Weighted Essentially Non-Oscillatory (WENO)), one introduces three quadratic reconstruction polynomials $p_{k}(x)$, $k \\in \\{0,1,2\\}$, each defined on a three-cell substencil:\n- $S_{0} = \\{I_{i-2}, I_{i-1}, I_{i}\\}$,\n- $S_{1} = \\{I_{i-1}, I_{i}, I_{i+1}\\}$,\n- $S_{2} = \\{I_{i}, I_{i+1}, I_{i+2}\\}$.\n\nEach polynomial $p_{k}(x)$ is of degree at most $2$ and satisfies the cell-average matching conditions on its substencil: for every cell $I_{j}$ in the substencil of $p_{k}$,\n$$(1/\\Delta x)\\int_{x_{j-1/2}}^{x_{j+1/2}} p_{k}(x)\\,\\mathrm{d}x \\;=\\; \\bar{u}_{j}.$$\nThe interface approximation from substencil $k$ is $u_{i+1/2}^{(k)} := p_{k}(x_{i+1/2})$.\n\nStarting from the finite volume definition of cell averages and the requirement above (without invoking any pre-tabulated WENO coefficients), derive $u_{i+1/2}^{(k)}$ for each $k \\in \\{0,1,2\\}$ explicitly as linear combinations of the five neighboring cell averages $\\{\\bar{u}_{i+m}\\}_{m=-2}^{2}$ and $\\Delta x$. Express each $u_{i+1/2}^{(k)}$ clearly as a linear combination with rational coefficients. Provide your final result as a single row matrix $\\big(u_{i+1/2}^{(0)},\\,u_{i+1/2}^{(1)},\\,u_{i+1/2}^{(2)}\\big)$ using only $\\{\\bar{u}_{i+m}\\}_{m=-2}^{2}$ and constants. No rounding is required. Do not include units in your final answer.",
            "solution": "The problem requires the derivation of the reconstructed values at the cell interface $x_{i+1/2}$ from each of the three substencils $S_0$, $S_1$, and $S_2$ used in a fifth-order WENO scheme. The reconstructed values are denoted by $u_{i+1/2}^{(k)}$ for $k \\in \\{0, 1, 2\\}$. Each value is obtained by evaluating a unique quadratic polynomial $p_k(x)$ at $x_{i+1/2}$. The polynomial $p_k(x)$ is defined by the condition that its cell averages match the given cell averages $\\bar{u}_j$ on its corresponding three-cell stencil $S_k$. We will derive these expressions from first principles.\n\nA crucial step is to define a local coordinate system for each stencil to simplify the algebraic manipulations. For a generic three-cell stencil consisting of cells $I_{j-1}$, $I_j$, $I_{j+1}$, it is convenient to define a local coordinate $\\xi = (x - x_j) / \\Delta x$, where $x_j$ is the center of the middle cell. In this coordinate system, the cell centers are at $\\xi \\in \\{-1, 0, 1\\}$.\n\nLet the quadratic polynomial in the local coordinate be $P(\\xi) = a\\xi^2 + b\\xi + c$. The cell average condition for a cell centered at $x_{j+s}$ (i.e., at $\\xi = s$) is:\n$$ \\bar{u}_{j+s} = \\frac{1}{\\Delta x} \\int_{x_{j+s-1/2}}^{x_{j+s+1/2}} p(x) \\,dx $$\nChanging variables to $\\xi = (x-x_j)/\\Delta x$, we have $x = x_j + \\xi \\Delta x$ and $dx = \\Delta x d\\xi$. The integration limits for cell $I_{j+s}$ become $\\xi = s - 1/2$ and $\\xi = s + 1/2$. The condition transforms to:\n$$ \\bar{u}_{j+s} = \\int_{s-1/2}^{s+1/2} P(\\xi) \\,d\\xi = \\int_{s-1/2}^{s+1/2} (a\\xi^2 + b\\xi + c) \\,d\\xi $$\n$$ \\bar{u}_{j+s} = \\left[ \\frac{a}{3}\\xi^3 + \\frac{b}{2}\\xi^2 + c\\xi \\right]_{s-1/2}^{s+1/2} $$\nEvaluating the antiderivative at the limits:\n$$ \\bar{u}_{j+s} = \\frac{a}{3}((s+\\tfrac{1}{2})^3 - (s-\\tfrac{1}{2})^3) + \\frac{b}{2}((s+\\tfrac{1}{2})^2 - (s-\\tfrac{1}{2})^2) + c((s+\\tfrac{1}{2}) - (s-\\tfrac{1}{2})) $$\n$$ \\bar{u}_{j+s} = \\frac{a}{3}(3s^2 + \\frac{1}{4}) + \\frac{b}{2}(2s) + c(1) = a(s^2 + \\frac{1}{12}) + bs + c $$\nWe apply this general formula to the central three-cell stencil with $s \\in \\{-1, 0, 1\\}$, corresponding to cell averages $\\bar{u}_{j-1}$, $\\bar{u}_j$, and $\\bar{u}_{j+1}$:\n\\begin{align*}\n\\bar{u}_{j-1} &= a((-1)^2 + \\tfrac{1}{12}) + b(-1) + c = a(\\tfrac{13}{12}) - b + c \\\\\n\\bar{u}_{j} &= a((0)^2 + \\tfrac{1}{12}) + b(0) + c = a(\\tfrac{1}{12}) + c \\\\\n\\bar{u}_{j+1} &= a((1)^2 + \\tfrac{1}{12}) + b(1) + c = a(\\tfrac{13}{12}) + b + c\n\\end{align*}\nThis forms a linear system for the coefficients $a,b,c$. Solving this system yields:\nFrom the second equation, $c = \\bar{u}_j - a/12$.\nSubtracting the first equation from the third gives $\\bar{u}_{j+1} - \\bar{u}_{j-1} = 2b$, so $b = \\frac{1}{2}(\\bar{u}_{j+1} - \\bar{u}_{j-1})$.\nAdding the first and third equations gives $\\bar{u}_{j-1} + \\bar{u}_{j+1} = 2a(\\frac{13}{12}) + 2c = \\frac{13}{6}a + 2(\\bar{u}_j - a/12) = (\\frac{13}{6}-\\frac{1}{6})a + 2\\bar{u}_j = 2a + 2\\bar{u}_j$.\nThis simplifies to $2a = \\bar{u}_{j-1} - 2\\bar{u}_j + \\bar{u}_{j+1}$, so $a = \\frac{1}{2}(\\bar{u}_{j-1} - 2\\bar{u}_j + \\bar{u}_{j+1})$.\nThe coefficients are:\n$$ a = \\frac{1}{2}(\\bar{u}_{j-1} - 2\\bar{u}_j + \\bar{u}_{j+1}) $$\n$$ b = \\frac{1}{2}(\\bar{u}_{j+1} - \\bar{u}_{j-1}) $$\n$$ c = \\bar{u}_j - \\frac{1}{24}(\\bar{u}_{j-1} - 2\\bar{u}_j + \\bar{u}_{j+1}) = -\\frac{1}{24}\\bar{u}_{j-1} + \\frac{13}{12}\\bar{u}_j - \\frac{1}{24}\\bar{u}_{j+1} $$\nNow we apply these general solutions to each specific stencil $S_k$ to find $u_{i+1/2}^{(k)}$.\n\n**Case $k=1$: Stencil $S_1 = \\{I_{i-1}, I_i, I_{i+1}\\}$**\nThis stencil is centered at cell $I_i$. We set $j=i$, so the local coordinate is $\\xi_1 = (x - x_i)/\\Delta x$. The cell averages are $\\bar{u}_{i-1}$, $\\bar{u}_i$, $\\bar{u}_{i+1}$. The coefficients $a_1, b_1, c_1$ of the polynomial $p_1(x)$ are given directly by the general formula with $j=i$:\n$a_1 = \\frac{1}{2}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1})$,\n$b_1 = \\frac{1}{2}(\\bar{u}_{i+1} - \\bar{u}_{i-1})$,\n$c_1 = -\\frac{1}{24}\\bar{u}_{i-1} + \\frac{13}{12}\\bar{u}_i - \\frac{1}{24}\\bar{u}_{i+1}$.\nWe evaluate the polynomial at $x_{i+1/2}$, which corresponds to $\\xi_1 = (x_{i+1/2} - x_i)/\\Delta x = 1/2$.\n$u_{i+1/2}^{(1)} = p_1(x_{i+1/2}) = a_1(\\frac{1}{2})^2 + b_1(\\frac{1}{2}) + c_1 = \\frac{a_1}{4} + \\frac{b_1}{2} + c_1$.\nSubstituting the expressions for the coefficients:\n$u_{i+1/2}^{(1)} = \\frac{1}{8}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1}) + \\frac{1}{4}(\\bar{u}_{i+1} - \\bar{u}_{i-1}) + (-\\frac{1}{24}\\bar{u}_{i-1} + \\frac{13}{12}\\bar{u}_i - \\frac{1}{24}\\bar{u}_{i+1})$.\nCollecting terms for each cell average:\nCoefficient of $\\bar{u}_{i-1}$: $\\frac{1}{8} - \\frac{1}{4} - \\frac{1}{24} = \\frac{3-6-1}{24} = -\\frac{4}{24} = -\\frac{1}{6}$.\nCoefficient of $\\bar{u}_{i}$: $-\\frac{2}{8} + \\frac{13}{12} = -\\frac{1}{4} + \\frac{13}{12} = \\frac{-3+13}{12} = \\frac{10}{12} = \\frac{5}{6}$.\nCoefficient of $\\bar{u}_{i+1}$: $\\frac{1}{8} + \\frac{1}{4} - \\frac{1}{24} = \\frac{3+6-1}{24} = \\frac{8}{24} = \\frac{1}{3}$.\nThus, $u_{i+1/2}^{(1)} = -\\frac{1}{6}\\bar{u}_{i-1} + \\frac{5}{6}\\bar{u}_{i} + \\frac{1}{3}\\bar{u}_{i+1} = \\frac{1}{6}(-\\bar{u}_{i-1} + 5\\bar{u}_{i} + 2\\bar{u}_{i+1})$.\n\n**Case $k=2$: Stencil $S_2 = \\{I_i, I_{i+1}, I_{i+2}\\}$**\nThis stencil is centered at cell $I_{i+1}$. We set $j=i+1$, so the local coordinate is $\\xi_2 = (x - x_{i+1})/\\Delta x$. The cell averages are $\\bar{u}_{i}$, $\\bar{u}_{i+1}$, $\\bar{u}_{i+2}$. The coefficients are given by the general formula with $j=i+1$:\n$a_2 = \\frac{1}{2}(\\bar{u}_{i} - 2\\bar{u}_{i+1} + \\bar{u}_{i+2})$,\n$b_2 = \\frac{1}{2}(\\bar{u}_{i+2} - \\bar{u}_{i})$,\n$c_2 = -\\frac{1}{24}\\bar{u}_{i} + \\frac{13}{12}\\bar{u}_{i+1} - \\frac{1}{24}\\bar{u}_{i+2}$.\nWe evaluate at $x_{i+1/2}$, which corresponds to $\\xi_2 = (x_{i+1/2} - x_{i+1})/\\Delta x = -1/2$.\n$u_{i+1/2}^{(2)} = p_2(x_{i+1/2}) = a_2(-\\frac{1}{2})^2 + b_2(-\\frac{1}{2}) + c_2 = \\frac{a_2}{4} - \\frac{b_2}{2} + c_2$.\nSubstituting the expressions for the coefficients:\n$u_{i+1/2}^{(2)} = \\frac{1}{8}(\\bar{u}_{i} - 2\\bar{u}_{i+1} + \\bar{u}_{i+2}) - \\frac{1}{4}(\\bar{u}_{i+2} - \\bar{u}_{i}) + (-\\frac{1}{24}\\bar{u}_{i} + \\frac{13}{12}\\bar{u}_{i+1} - \\frac{1}{24}\\bar{u}_{i+2})$.\nCollecting terms:\nCoefficient of $\\bar{u}_{i}$: $\\frac{1}{8} + \\frac{1}{4} - \\frac{1}{24} = \\frac{3+6-1}{24} = \\frac{8}{24} = \\frac{1}{3}$.\nCoefficient of $\\bar{u}_{i+1}$: $-\\frac{2}{8} + \\frac{13}{12} = -\\frac{1}{4} + \\frac{13}{12} = \\frac{-3+13}{12} = \\frac{10}{12} = \\frac{5}{6}$.\nCoefficient of $\\bar{u}_{i+2}$: $\\frac{1}{8} - \\frac{1}{4} - \\frac{1}{24} = \\frac{3-6-1}{24} = -\\frac{4}{24} = -\\frac{1}{6}$.\nThus, $u_{i+1/2}^{(2)} = \\frac{1}{3}\\bar{u}_{i} + \\frac{5}{6}\\bar{u}_{i+1} - \\frac{1}{6}\\bar{u}_{i+2} = \\frac{1}{6}(2\\bar{u}_{i} + 5\\bar{u}_{i+1} - \\bar{u}_{i+2})$.\n\n**Case $k=0$: Stencil $S_0 = \\{I_{i-2}, I_{i-1}, I_i\\}$**\nThis stencil is centered at cell $I_{i-1}$. We set $j=i-1$, so the local coordinate is $\\xi_0 = (x - x_{i-1})/\\Delta x$. The cell averages are $\\bar{u}_{i-2}$, $\\bar{u}_{i-1}$, $\\bar{u}_{i}$. The coefficients are given by the general formula with $j=i-1$:\n$a_0 = \\frac{1}{2}(\\bar{u}_{i-2} - 2\\bar{u}_{i-1} + \\bar{u}_{i})$,\n$b_0 = \\frac{1}{2}(\\bar{u}_{i} - \\bar{u}_{i-2})$,\n$c_0 = -\\frac{1}{24}\\bar{u}_{i-2} + \\frac{13}{12}\\bar{u}_{i-1} - \\frac{1}{24}\\bar{u}_{i}$.\nWe evaluate at $x_{i+1/2}$, which corresponds to $\\xi_0 = (x_{i+1/2} - x_{i-1})/\\Delta x = (i+1/2 - (i-1)) = 3/2$.\n$u_{i+1/2}^{(0)} = p_0(x_{i+1/2}) = a_0(\\frac{3}{2})^2 + b_0(\\frac{3}{2}) + c_0 = \\frac{9}{4}a_0 + \\frac{3}{2}b_0 + c_0$.\nSubstituting the expressions for the coefficients:\n$u_{i+1/2}^{(0)} = \\frac{9}{8}(\\bar{u}_{i-2} - 2\\bar{u}_{i-1} + \\bar{u}_{i}) + \\frac{3}{4}(\\bar{u}_{i} - \\bar{u}_{i-2}) + (-\\frac{1}{24}\\bar{u}_{i-2} + \\frac{13}{12}\\bar{u}_{i-1} - \\frac{1}{24}\\bar{u}_{i})$.\nCollecting terms:\nCoefficient of $\\bar{u}_{i-2}$: $\\frac{9}{8} - \\frac{3}{4} - \\frac{1}{24} = \\frac{27-18-1}{24} = \\frac{8}{24} = \\frac{1}{3}$.\nCoefficient of $\\bar{u}_{i-1}$: $-\\frac{18}{8} + \\frac{13}{12} = -\\frac{9}{4} + \\frac{13}{12} = \\frac{-27+13}{12} = -\\frac{14}{12} = -\\frac{7}{6}$.\nCoefficient of $\\bar{u}_{i}$: $\\frac{9}{8} + \\frac{3}{4} - \\frac{1}{24} = \\frac{27+18-1}{24} = \\frac{44}{24} = \\frac{11}{6}$.\nThus, $u_{i+1/2}^{(0)} = \\frac{1}{3}\\bar{u}_{i-2} - \\frac{7}{6}\\bar{u}_{i-1} + \\frac{11}{6}\\bar{u}_{i} = \\frac{1}{6}(2\\bar{u}_{i-2} - 7\\bar{u}_{i-1} + 11\\bar{u}_{i})$.\n\nIn summary, the three interface values are:\n$u_{i+1/2}^{(0)} = \\frac{2\\bar{u}_{i-2} - 7\\bar{u}_{i-1} + 11\\bar{u}_{i}}{6}$\n$u_{i+1/2}^{(1)} = \\frac{-\\bar{u}_{i-1} + 5\\bar{u}_{i} + 2\\bar{u}_{i+1}}{6}$\n$u_{i+1/2}^{(2)} = \\frac{2\\bar{u}_{i} + 5\\bar{u}_{i+1} - \\bar{u}_{i+2}}{6}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{6}(2\\bar{u}_{i-2} - 7\\bar{u}_{i-1} + 11\\bar{u}_{i})\n&\n\\frac{1}{6}(-\\bar{u}_{i-1} + 5\\bar{u}_{i} + 2\\bar{u}_{i+1})\n&\n\\frac{1}{6}(2\\bar{u}_{i} + 5\\bar{u}_{i+1} - \\bar{u}_{i+2})\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While scalar conservation laws are instructive, most real-world problems in fluid dynamics involve systems of equations. This practice demonstrates how to extend the scalar WENO reconstruction to a linear hyperbolic system by working in characteristic fields, which diagonalize the system into a set of independent scalar advection equations . By performing the reconstruction on these simpler characteristic variables and then mapping back to physical variables, you will practice a cornerstone technique for developing high-order methods for complex systems.",
            "id": "3392151",
            "problem": "Consider the linear hyperbolic system of conservation laws $\\,\\partial_{t}\\mathbf{U} + A\\,\\partial_{x}\\mathbf{U} = \\mathbf{0}\\,$ with constant Jacobian matrix\n$$\nA=\\begin{pmatrix}\n2 & 1\\\\\n1 & 2\n\\end{pmatrix},\n$$\nposed on a uniform one-dimensional mesh with cell centers at $\\,x_{j}=j\\,\\Delta x\\,$. Let $\\,\\mathbf{U}=(u,v)^{\\mathsf{T}}\\,$ denote the vector of conserved variables and suppose the available finite-volume cell averages are\n$$\nu_{j}=1+j,\\qquad v_{j}=2-j,\n$$\nfor indices $\\,j\\in\\{-2,-1,0,1,2\\}\\,$. Focus on the interface at $\\,x_{i+1/2}\\,$ with $\\,i=0\\,$.\n\nStarting from first principles of characteristic decomposition for linear systems and high-order finite-volume reconstruction, do the following in order:\n- Construct the right and left eigenvector matrices of $\\,A\\,$ to form the characteristic projection $\\,\\mathbf{w}=L\\,\\mathbf{U}\\,$ and its inverse mapping $\\,\\mathbf{U}=R\\,\\mathbf{w}\\,$, where $\\,L=R^{-1}\\,$.\n- Project the given cell averages $\\,\\mathbf{U}_{j}\\,$ to characteristic fields $\\,\\mathbf{w}_{j}\\,$.\n- In each scalar characteristic field, perform a left-biased fifth-order Weighted Essentially Non-Oscillatory (WENO) reconstruction using the Jiang–Shu formulation (WENO-JS), with smoothness indicators and nonlinear weights computed from the three substencils on the five-point stencil $\\,\\{j-2,j-1,j,j+1,j+2\\}\\,$. Use the ideal weights $\\,d_{0},d_{1},d_{2}\\,$ associated with the fifth-order scheme, smoothness indicator power $\\,p=2\\,$, and $\\,\\varepsilon=10^{-6}\\,$.\n- Map the reconstructed characteristic state at $\\,x_{i+1/2}^{-}\\,$ back to the physical components $\\,\\mathbf{U}_{i+1/2}^{-}=R\\,\\mathbf{w}_{i+1/2}^{-}\\,$.\n\nReport the reconstructed left state of the first physical component at the interface, $\\,u_{i+1/2}^{-}\\,$, as a single number. No rounding is required and no units should be included in the final answer.",
            "solution": "The solution proceeds in four stages:\n1.  Characteristic decomposition of the system matrix $A$.\n2.  Projection of the physical cell-averaged data $\\mathbf{U}_j$ onto the characteristic fields.\n3.  Fifth-order WENO reconstruction in each characteristic field to find the left state $\\mathbf{w}_{i+1/2}^{-}$ at the interface.\n4.  Transformation of the reconstructed characteristic state back to physical variables to find $\\mathbf{U}_{i+1/2}^{-}$ and its first component $u_{i+1/2}^{-}$.\n\n**1. Characteristic Decomposition**\n\nThe Jacobian matrix is $A=\\begin{pmatrix} 2 & 1\\\\ 1 & 2 \\end{pmatrix}$. We find its eigenvalues $(\\lambda)$ and right eigenvectors $(\\mathbf{r})$.\nThe characteristic equation is $\\det(A - \\lambda I) = (2-\\lambda)^{2} - 1 = 0$, which gives $2-\\lambda = \\pm 1$.\nThe eigenvalues are $\\lambda_1 = 1$ and $\\lambda_2 = 3$.\n\nFor $\\lambda_1 = 1$: $(A-\\lambda_1 I)\\mathbf{r}_1 = \\mathbf{0} \\Rightarrow \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\\mathbf{r}_1 = \\mathbf{0}$. A corresponding right eigenvector is $\\mathbf{r}_1 = (1, -1)^{\\mathsf{T}}$.\nFor $\\lambda_2 = 3$: $(A-\\lambda_2 I)\\mathbf{r}_2 = \\mathbf{0} \\Rightarrow \\begin{pmatrix} -1 & 1 \\\\ 1 & -1 \\end{pmatrix}\\mathbf{r}_2 = \\mathbf{0}$. A corresponding right eigenvector is $\\mathbf{r}_2 = (1, 1)^{\\mathsf{T}}$.\n\nThe matrix of right eigenvectors, $R$, and its inverse, the matrix of left eigenvectors, $L=R^{-1}$, are:\n$$\nR = \\begin{pmatrix} 1 & 1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n$$\nL = R^{-1} = \\frac{1}{1(1) - 1(-1)} \\begin{pmatrix} 1 & -1 \\\\ 1 & 1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 & -1 \\\\ 1 & 1 \\end{pmatrix}\n$$\n\n**2. Projection to Characteristic Fields**\n\nThe physical cell averages are $\\mathbf{U}_j = (u_j, v_j)^{\\mathsf{T}} = (1+j, 2-j)^{\\mathsf{T}}$. We project these onto the characteristic fields using $\\mathbf{w}_j = L\\mathbf{U}_j$.\n$$\n\\mathbf{w}_j = \\begin{pmatrix} w_{1,j} \\\\ w_{2,j} \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1 & -1 \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1+j \\\\ 2-j \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} (1+j) - (2-j) \\\\ (1+j) + (2-j) \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 2j-1 \\\\ 3 \\end{pmatrix}\n$$\nSo, the two characteristic fields are:\n$w_{1,j} = j - \\frac{1}{2}$\n$w_{2,j} = \\frac{3}{2}$\n\nFor the reconstruction at $x_{1/2}^{-}$ (for cell $i=0$), we use the stencil $j \\in \\{-2, -1, 0, 1, 2\\}$.\n\n**3. WENO-JS Reconstruction**\n\nWe perform a separate WENO reconstruction for each characteristic field.\n\n**Field 2 ($w_2$):**\nThe cell averages are $w_{2,j} = \\frac{3}{2}$ for all $j$. The data is constant. Any reasonable reconstruction scheme, including 5th-order WENO, will exactly preserve a constant state. Therefore, the reconstructed value at the interface is the constant itself.\n$$\nw_{2,1/2}^{-} = \\frac{3}{2}\n$$\n\n**Field 1 ($w_1$):**\nThe cell averages are $w_{1,j} = j - \\frac{1}{2}$. This data is a linear function of the index $j$. A 5th-order WENO scheme is designed to achieve 5th-order accuracy in smooth regions, which means it can exactly reconstruct polynomials of degree up to $4$. Since our data is perfectly linear (a polynomial of degree $1$), the WENO scheme will yield the exact value of the underlying continuous function.\n\nIf we assume $x_j = j \\Delta x$, a continuous function whose cell averages are $w_{1,j} = j - \\frac{1}{2}$ can be written as $p(x) = \\frac{x}{\\Delta x} - \\frac{1}{2}$. Without loss of generality, let $\\Delta x=1$, so $x_j=j$ and $p(x) = x - \\frac{1}{2}$. The interface is at $x_{1/2} = \\frac{1}{2}$. The exact value is $p(\\frac{1}{2}) = \\frac{1}{2} - \\frac{1}{2} = 0$.\nThus, the reconstruction must yield:\n$$\nw_{1,1/2}^{-} = 0\n$$\n\nTo formally verify this, we can examine the WENO-JS procedure. The 5th-order reconstruction is a weighted average of three 3rd-order reconstructions on substencils $S_0=\\{j-2, j-1, j\\}$, $S_1=\\{j-1, j, j+1\\}$, and $S_2=\\{j, j+1, j+2\\}$. For linear data, each of these substencil reconstructions is also exact. Let's verify for $i=0$:\n$\\hat{w}_{1,1/2}^{(0)} = \\frac{1}{3}w_{1,-2} - \\frac{7}{6}w_{1,-1} + \\frac{11}{6}w_{1,0} = \\frac{1}{3}(-2.5) - \\frac{7}{6}(-1.5) + \\frac{11}{6}(-0.5) = \\frac{-5+10.5-5.5}{6} = 0$.\n$\\hat{w}_{1,1/2}^{(1)} = -\\frac{1}{6}w_{1,-1} + \\frac{5}{6}w_{1,0} + \\frac{1}{3}w_{1,1} = -\\frac{1}{6}(-1.5) + \\frac{5}{6}(-0.5) + \\frac{1}{3}(0.5) = \\frac{1.5-2.5+1}{6} = 0$.\n$\\hat{w}_{1,1/2}^{(2)} = \\frac{1}{3}w_{1,0} + \\frac{5}{6}w_{1,1} - \\frac{1}{6}w_{1,2} = \\frac{1}{3}(-0.5) + \\frac{5}{6}(0.5) - \\frac{1}{6}(1.5) = \\frac{-1+2.5-1.5}{6} = 0$.\nSince all sub-reconstructions yield $0$, their weighted sum is also $0$.\n\nFurthermore, the Jiang-Shu smoothness indicators $\\beta_k$ for linear data are all equal. For $i=0$:\n$\\beta_0 = \\frac{13}{12}(w_{1,-2}-2w_{1,-1}+w_{1,0})^2 + \\frac{1}{4}(w_{1,-2}-4w_{1,-1}+3w_{1,0})^2 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(2)^2=1$.\n$\\beta_1 = \\frac{13}{12}(w_{1,-1}-2w_{1,0}+w_{1,1})^2 + \\frac{1}{4}(w_{1,-1}-w_{1,1})^2 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-2)^2=1$.\n$\\beta_2 = \\frac{13}{12}(w_{1,0}-2w_{1,1}+w_{1,2})^2 + \\frac{1}{4}(3w_{1,0}-4w_{1,1}+w_{1,2})^2 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-2)^2=1$.\nSince $\\beta_0=\\beta_1=\\beta_2$, the nonlinear weights $\\omega_k$ become equal to the ideal linear weights $d_k$. The WENO reconstruction reverts to the optimal 5th-order linear reconstruction, which is exact for linear data.\n\nThe reconstructed characteristic state at the interface is $\\mathbf{w}_{1/2}^{-} = (w_{1,1/2}^{-}, w_{2,1/2}^{-})^{\\mathsf{T}} = (0, \\frac{3}{2})^{\\mathsf{T}}$.\n\n**4. Transformation Back to Physical Variables**\n\nFinally, we map the reconstructed characteristic state back to the physical variables using $\\mathbf{U}_{1/2}^{-} = R \\mathbf{w}_{1/2}^{-}$.\n$$\n\\mathbf{U}_{1/2}^{-} = \\begin{pmatrix} u_{1/2}^{-} \\\\ v_{1/2}^{-} \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ -1 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} 1(0) + 1(\\frac{3}{2}) \\\\ -1(0) + 1(\\frac{3}{2}) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{3}{2} \\end{pmatrix}\n$$\nThe reconstructed left state of the first physical component at the interface $x_{1/2}$ is $u_{1/2}^{-} = \\frac{3}{2}$.",
            "answer": "$$\n\\boxed{1.5}\n$$"
        },
        {
            "introduction": "A key feature of the WENO method is its ability to adapt to local solution smoothness, but how robust are the standard smoothness indicators? This advanced exercise challenges you to analyze a known weakness of the classical Jiang-Shu indicators at 'critical points,' where specific function structures can mislead the indicators and degrade accuracy . By constructing a function that triggers this failure and evaluating a modified indicator, you will gain deeper insight into the ongoing research aimed at improving the robustness of WENO schemes.",
            "id": "3392210",
            "problem": "Consider one-dimensional reconstruction for a scalar conservation law $u_{t} + f(u)_{x} = 0$ on a uniform grid with spacing $h$, where pointwise nodal values $u_{i+m} = u(x_{i+m})$ are available. In a $5$-point Weighted Essentially Non-Oscillatory (WENO) reconstruction (Weighted Essentially Non-Oscillatory (WENO)), three quadratic candidate polynomials are built on the three-point sub-stencils $S_{0} = \\{i-2,i-1,i\\}$, $S_{1} = \\{i-1,i,i+1\\}$, and $S_{2} = \\{i,i+1,i+2\\}$, and smoothness is measured by the Jiang–Shu indicators $\\beta_{k}$ obtained from the integral of squared derivatives of each polynomial over the target cell.\n\nStarting from the integral definition of the smoothness indicator as the sum of the cellwise $L^{2}$ norms of the first and second derivatives of the quadratic candidate polynomial on each sub-stencil, derive the classical discrete forms of $\\beta_{0}$, $\\beta_{1}$, and $\\beta_{2}$ in terms of $u_{i+m}$ on a uniform mesh.\n\nNext, construct a specific function that realizes near-cancellation of discrete derivatives on the union of stencils. Let $i=0$ and define\n$$\nu(x) = a\\,x + b\\,x^{3},\n$$\nwith $a \\neq 0$, and choose $b$ so that the one-sided first-derivative-like combinations on $S_{0}$ and $S_{2}$ vanish at $x=0$. Evaluate the resulting $\\beta_{k}$ for $k=0,1,2$ at $x_{0}=0$ and show how, for this construction, the classical $\\beta_{k}$ can shrink with $h$ despite the presence of a nontrivial gradient $u'(0)=a$.\n\nFinally, propose a fix by defining a blended gradient–curvature indicator on the central stencil $S_{1}$,\n$$\n\\tilde{\\beta}_{1}(\\lambda) \\equiv \\lambda\\,\\frac{\\big(u_{i+1} - u_{i-1}\\big)^{2}}{4\\,h^{2}} \\;+\\; (1-\\lambda)\\,\\frac{\\big(u_{i-2} - 2u_{i-1} + u_{i}\\big)^{2} + \\big(u_{i} - 2u_{i+1} + u_{i+2}\\big)^{2}}{2\\,h^{2}},\n$$\nwith a blending parameter $\\lambda \\in (0,1)$. Using your constructed $u(x)$ and the choice of $b$ that achieves the near-cancellation, evaluate $\\tilde{\\beta}_{1}(\\lambda)$ at $i=0$ for $\\lambda=\\tfrac{1}{2}$ and express your final answer as a single closed-form analytic expression in terms of $a$. No rounding is required, and no units should be included in the final expression.",
            "solution": "### Part 1: Derivation of Classical Smoothness Indicators\n\nThe smoothness indicator $\\beta_k$ for the quadratic polynomial $p_k(x)$ on stencil $S_k$ is defined by integrating over the target cell $[x_{i-1/2}, x_{i+1/2}]$. Let $\\xi = (x-x_i)/h$. Then $dx = h\\,d\\xi$, and the integration interval is $\\xi \\in [-1/2, 1/2]$. The scaled indicator is:\n$$\n\\beta_k = \\int_{-1/2}^{1/2} \\left[ \\left(\\frac{dp_k}{d\\xi}\\right)^2 + \\left(\\frac{d^2p_k}{d\\xi^2}\\right)^2 \\right] d\\xi\n$$\n\nFor the central stencil $S_1 = \\{i-1, i, i+1\\}$, the interpolating polynomial $p_1(x)$ passing through $(x_{i-1}, u_{i-1}), (x_i, u_i), (x_{i+1}, u_{i+1})$ can be written in terms of $\\xi = (x-x_i)/h$ as:\n$$\np_1(\\xi h + x_i) = u_i + \\frac{u_{i+1}-u_{i-1}}{2}\\xi + \\frac{u_{i+1}-2u_i+u_{i-1}}{2}\\xi^2\n$$\nThe derivatives with respect to $\\xi$ are:\n$$\n\\frac{dp_1}{d\\xi} = \\frac{u_{i+1}-u_{i-1}}{2} + (u_{i+1}-2u_i+u_{i-1})\\xi\n$$\n$$\n\\frac{d^2p_1}{d\\xi^2} = u_{i+1}-2u_i+u_{i-1}\n$$\nIntegrating the squares from $\\xi = -1/2$ to $1/2$:\n$$\n\\int_{-1/2}^{1/2} \\left(\\frac{d^2p_1}{d\\xi^2}\\right)^2 d\\xi = \\int_{-1/2}^{1/2} (u_{i+1}-2u_i+u_{i-1})^2 d\\xi = (u_{i+1}-2u_i+u_{i-1})^2\n$$\n$$\n\\int_{-1/2}^{1/2} \\left(\\frac{dp_1}{d\\xi}\\right)^2 d\\xi = \\int_{-1/2}^{1/2} \\left[ \\left(\\frac{u_{i+1}-u_{i-1}}{2}\\right)^2 + (u_{i+1}-u_{i-1})(u_{i+1}-2u_i+u_{i-1})\\xi + (u_{i+1}-2u_i+u_{i-1})^2\\xi^2 \\right] d\\xi\n$$\nThe term with $\\xi$ integrates to zero. The result is:\n$$\n= \\left(\\frac{u_{i+1}-u_{i-1}}{2}\\right)^2 (1) + (u_{i+1}-2u_i+u_{i-1})^2 \\left[\\frac{\\xi^3}{3}\\right]_{-1/2}^{1/2} = \\frac{1}{4}(u_{i+1}-u_{i-1})^2 + \\frac{1}{12}(u_{i+1}-2u_i+u_{i-1})^2\n$$\nCombining the parts for $\\beta_1$:\n$$\n\\beta_1 = \\left( \\frac{1}{4}(u_{i-1}-u_{i+1})^2 + \\frac{1}{12}(u_{i-1}-2u_i+u_{i+1})^2 \\right) + (u_{i-1}-2u_i+u_{i+1})^2 \n$$\n$$\n\\beta_1 = \\frac{13}{12}(u_{i-1} - 2u_i + u_{i+1})^2 + \\frac{1}{4}(u_{i-1} - u_{i+1})^2\n$$\nThe derivations for $\\beta_0$ and $\\beta_2$ are analogous but involve shifting the coordinate system and integration interval. The resulting well-known discrete formulae are:\n$$\n\\beta_0 = \\frac{13}{12}(u_{i-2} - 2u_{i-1} + u_i)^2 + \\frac{1}{4}(u_{i-2} - 4u_{i-1} + 3u_i)^2\n$$\n$$\n\\beta_2 = \\frac{13}{12}(u_i - 2u_{i+1} + u_{i+2})^2 + \\frac{1}{4}(3u_i - 4u_{i+1} + u_{i+2})^2\n$$\n\n### Part 2: Analysis of the Specific Function\n\nWe are given $u(x) = ax + bx^3$ and we work at $i=0$, so $x_m = mh$. The point values are $u_m = u(mh) = amh + bm^3h^3$.\nThe condition is that \"one-sided first-derivative-like combinations on $S_0$ and $S_2$ vanish\". These correspond to the terms $(u_{i-2} - 4u_{i-1} + 3u_i)$ for $S_0$ and $(3u_i - 4u_{i+1} + u_{i+2})$ for $S_2$. For $i=0$:\n\nFor $S_0=\\{-2, -1, 0\\}$, the term is $u_{-2} - 4u_{-1} + 3u_0$.\n$u_0 = 0$\n$u_{-1} = a(-h) + b(-h)^3 = -ah - bh^3$\n$u_{-2} = a(-2h) + b(-2h)^3 = -2ah - 8bh^3$\n$u_{-2} - 4u_{-1} + 3u_0 = (-2ah - 8bh^3) - 4(-ah - bh^3) + 0 = 2ah - 4bh^3$.\nSetting this to zero: $2ah - 4bh^3 = 0 \\implies a = 2bh^2$.\n\nFor $S_2=\\{0, 1, 2\\}$, the term is $3u_0 - 4u_1 + u_2$.\n$u_1 = ah + bh^3$\n$u_2 = a(2h) + b(2h)^3 = 2ah + 8bh^3$\n$3u_0 - 4u_1 + u_2 = 0 - 4(ah + bh^3) + (2ah + 8bh^3) = -2ah + 4bh^3$.\nSetting this to zero also gives $a = 2bh^2$.\nSince $a \\neq 0$, we must have $b = \\frac{a}{2h^2}$.\n\nNow we evaluate the nodal values with this specific $b$:\n$u_m = u(mh) = amh + \\frac{a}{2h^2}(mh)^3 = amh + \\frac{am^3h}{2}$.\n$u_0 = 0$\n$u_1 = ah + \\frac{ah}{2} = \\frac{3}{2}ah$\n$u_{-1} = -ah - \\frac{ah}{2} = -\\frac{3}{2}ah$\n$u_2 = 2ah + \\frac{8ah}{2} = 6ah$\n$u_{-2} = -2ah - \\frac{8ah}{2} = -6ah$\n\nNext, we evaluate the $\\beta_k$ at $i=0$:\nFor $\\beta_0$:\n$u_{-2} - 2u_{-1} + u_0 = -6ah - 2(-\\frac{3}{2}ah) + 0 = -3ah$.\n$u_{-2} - 4u_{-1} + 3u_0 = 0$ (by construction).\n$\\beta_0 = \\frac{13}{12}(-3ah)^2 + \\frac{1}{4}(0)^2 = \\frac{13 \\cdot 9 a^2h^2}{12} = \\frac{39}{4}a^2h^2$.\n\nFor $\\beta_1$:\n$u_{-1} - 2u_0 + u_1 = -\\frac{3}{2}ah - 0 + \\frac{3}{2}ah = 0$.\n$u_{-1} - u_1 = -\\frac{3}{2}ah - \\frac{3}{2}ah = -3ah$.\n$\\beta_1 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-3ah)^2 = \\frac{9}{4}a^2h^2$.\n\nFor $\\beta_2$:\n$u_0 - 2u_1 + u_2 = 0 - 2(\\frac{3}{2}ah) + 6ah = 3ah$.\n$3u_0 - 4u_1 + u_2 = 0$ (by construction).\n$\\beta_2 = \\frac{13}{12}(3ah)^2 + \\frac{1}{4}(0)^2 = \\frac{39}{4}a^2h^2$.\n\nAll three indicators, $\\beta_0$, $\\beta_1$, and $\\beta_2$, are proportional to $h^2$. As $h \\to 0$, they all approach zero. This is the behavior at a so-called \"critical point\". For this constructed function, $u'(0) = a \\neq 0$, yet the indicators behave as if the function is extremely smooth (like at an extremum where $u'=0, u''=0$). This happens because the specific value of $u'''(0) = \\frac{3a}{h^2}$ causes a cancellation in the higher-order terms of the finite difference approximations for the first derivative on the side stencils $S_0$ and $S_2$. This artificially suppresses the gradient-measuring part of $\\beta_0$ and $\\beta_2$, distorting the relative magnitudes of the indicators and potentially leading to a loss of accuracy in the WENO scheme, as the nonlinear weights no longer correctly reflect the local smoothness.\n\n### Part 3: Evaluation of the Blended Indicator\n\nThe proposed blended indicator is:\n$$\n\\tilde{\\beta}_{1}(\\lambda) = \\lambda\\,\\frac{\\big(u_{i+1} - u_{i-1}\\big)^{2}}{4\\,h^{2}} \\;+\\; (1-\\lambda)\\,\\frac{\\big(u_{i-2} - 2u_{i-1} + u_{i}\\big)^{2} + \\big(u_{i} - 2u_{i+1} + u_{i+2}\\big)^{2}}{2\\,h^{2}}\n$$\nWe need to evaluate this at $i=0$ with $\\lambda = \\frac{1}{2}$.\n$$\n\\tilde{\\beta}_{1}(\\tfrac{1}{2}) = \\frac{1}{2}\\,\\frac{\\big(u_{1} - u_{-1}\\big)^{2}}{4\\,h^{2}} \\;+\\; \\frac{1}{2}\\,\\frac{\\big(u_{-2} - 2u_{-1} + u_{0}\\big)^{2} + \\big(u_{0} - 2u_{1} + u_{2}\\big)^{2}}{2\\,h^{2}}\n$$\n$$\n\\tilde{\\beta}_{1}(\\tfrac{1}{2}) = \\frac{\\big(u_{1} - u_{-1}\\big)^{2}}{8\\,h^{2}} \\;+\\; \\frac{\\big(u_{-2} - 2u_{-1} + u_{0}\\big)^{2} + \\big(u_{2} - 2u_{1} + u_{0}\\big)^{2}}{4\\,h^{2}}\n$$\nUsing the values computed in Part 2:\n$u_1 - u_{-1} = 3ah$\n$u_{-2} - 2u_{-1} + u_0 = -3ah$\n$u_2 - 2u_1 + u_0 = 3ah$\n\nSubstitute these into the expression for $\\tilde{\\beta}_{1}(\\frac{1}{2})$:\n$$\n\\tilde{\\beta}_{1}(\\tfrac{1}{2}) = \\frac{(3ah)^2}{8h^2} + \\frac{(-3ah)^2 + (3ah)^2}{4h^2}\n$$\n$$\n= \\frac{9a^2h^2}{8h^2} + \\frac{9a^2h^2 + 9a^2h^2}{4h^2}\n$$\n$$\n= \\frac{9}{8}a^2 + \\frac{18a^2h^2}{4h^2}\n$$\n$$\n= \\frac{9}{8}a^2 + \\frac{9}{2}a^2 = \\frac{9}{8}a^2 + \\frac{36}{8}a^2 = \\frac{45}{8}a^2\n$$\nThe value of this new indicator is independent of $h$ and proportional to $a^2$, which is proportional to $(u'(0))^2$. This blended indicator successfully captures the non-trivial gradient at the point of interest, overcoming the deficiency of the classical indicators for this specific function.",
            "answer": "$$\n\\boxed{\\frac{45}{8}a^{2}}\n$$"
        }
    ]
}