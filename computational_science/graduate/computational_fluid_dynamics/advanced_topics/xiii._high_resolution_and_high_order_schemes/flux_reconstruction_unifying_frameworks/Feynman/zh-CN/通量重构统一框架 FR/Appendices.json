{
    "hands_on_practices": [
        {
            "introduction": "通量重构方法的核心在于一个离散算子，它近似于通量散度。本练习提供了一个动手实践的机会，让您能够从第一性原理出发，为一个简单的一维案例构建此算子。通过对解和通量进行拉格朗日插值计算，您将具体地理解解点值是如何映射到通量导数值的，从而揭示通量重构格式的核心机制。",
            "id": "3320594",
            "problem": "考虑标量守恒律 $\\partial_{t} u + \\partial_{\\xi} f(u) = 0$ 的一维参考单元 $\\xi \\in [-1,1]$，其中通量函数为 $f(u) = u$。在通量重构 (FR) 统一框架中，使用 $p+2$ 个通量点，从在 $p+1$ 个解点上表示的解中重构一个多项式通量。设 $p=2$，解点位于 $\\xi = -1, 0, 1$，通量点位于 $\\xi = -1, -\\frac{1}{2}, \\frac{1}{2}, 1$。假设周期性或匹配的公共界面通量，使得边界修正项在该单个参考单元上为零；等价地，在边界处使用插值的局部通量。\n\n通过解点上的拉格朗日多项式定义 $p$ 次解的插值多项式 $u(\\xi)$，在通量点处计算通量 $f(u)$，通过通量点上的拉格朗日插值重构 $p+1$ 次通量多项式，然后在其解点处计算其导数。从第一性原理推导微分矩阵 $\\mathbf{D} \\in \\mathbb{R}^{3 \\times 3}$，使得在解点处重构通量的导数向量 $\\left[\\partial_{\\xi} F(-1), \\partial_{\\xi} F(0), \\partial_{\\xi} F(1)\\right]^{\\mathsf{T}}$ 等于 $\\mathbf{D} \\left[u(-1), u(0), u(1)\\right]^{\\mathsf{T}}$。\n\n将微分矩阵的所有元素表示为精确的有理数。最终表达式无需四舍五入，也不涉及任何物理单位。",
            "solution": "目标是推导微分矩阵 $\\mathbf{D} \\in \\mathbb{R}^{3 \\times 3}$，该矩阵将解点处的解值向量 $\\mathbf{u}_S = \\left[u(-1), u(0), u(1)\\right]^{\\mathsf{T}}$ 映射到同一点处的重构通量导数向量 $\\mathbf{F}'_S = \\left[\\partial_{\\xi} F(-1), \\partial_{\\xi} F(0), \\partial_{\\xi} F(1)\\right]^{\\mathsf{T}}$，其关系为 $\\mathbf{F}'_S = \\mathbf{D} \\mathbf{u}_S$。推导过程将遵循问题陈述中概述的步骤。\n\n多项式次数为 $p=2$。解点为 $\\xi_S = \\{-1, 0, 1\\}$，通量点为 $\\xi_F = \\{-1, -\\frac{1}{2}, \\frac{1}{2}, 1\\}$。通量函数为 $f(u) = u$。\n\n步骤 1：定义 $p$ 次解的插值多项式 $u(\\xi)$。\n解由一个 $p=2$ 次多项式 $u(\\xi)$ 表示，它在解点 $\\xi_{S,0}=-1$, $\\xi_{S,1}=0$, $\\xi_{S,2}=1$ 处对解值 $u_0 = u(-1)$, $u_1 = u(0)$ 和 $u_2 = u(1)$ 进行插值。使用拉格朗日插值：\n$$u(\\xi) = \\sum_{i=0}^{2} u_i L_{S,i}(\\xi)$$\n其中 $L_{S,i}(\\xi)$ 是解点的拉格朗日基多项式：\n$L_{S,0}(\\xi) = \\frac{(\\xi - 0)(\\xi - 1)}{(-1 - 0)(-1 - 1)} = \\frac{1}{2}(\\xi^2 - \\xi)$\n$L_{S,1}(\\xi) = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = 1 - \\xi^2$\n$L_{S,2}(\\xi) = \\frac{(\\xi - (-1))(\\xi - 0)}{(1 - (-1))(1 - 0)} = \\frac{1}{2}(\\xi^2 + \\xi)$\n因此，解的插值多项式为：\n$$u(\\xi) = u_0 \\left(\\frac{1}{2}(\\xi^2 - \\xi)\\right) + u_1 \\left(1 - \\xi^2\\right) + u_2 \\left(\\frac{1}{2}(\\xi^2 + \\xi)\\right)$$\n\n步骤 2：在通量点处计算通量 $f(u)$。\n通量函数为 $f(u) = u$，因此在任意位置 $\\xi$ 的通量值就是 $f(u(\\xi)) = u(\\xi)$。我们在四个通量点 $\\xi_{F,0}=-1$、$\\xi_{F,1}=-1/2$、$\\xi_{F,2}=1/2$、$\\xi_{F,3}=1$ 处计算这些值。设通量值向量为 $\\mathbf{f}_F = [f_0, f_1, f_2, f_3]^{\\mathsf{T}}$。\n$f_0 = u(-1) = u_0$\n$f_1 = u(-1/2) = u_0 \\frac{1}{2}(\\frac{1}{4}+\\frac{1}{2}) + u_1(1-\\frac{1}{4}) + u_2 \\frac{1}{2}(\\frac{1}{4}-\\frac{1}{2}) = \\frac{3}{8}u_0 + \\frac{3}{4}u_1 - \\frac{1}{8}u_2$\n$f_2 = u(1/2) = u_0 \\frac{1}{2}(\\frac{1}{4}-\\frac{1}{2}) + u_1(1-\\frac{1}{4}) + u_2 \\frac{1}{2}(\\frac{1}{4}+\\frac{1}{2}) = -\\frac{1}{8}u_0 + \\frac{3}{4}u_1 + \\frac{3}{8}u_2$\n$f_3 = u(1) = u_2$\n这个关系可以用矩阵形式表示为 $\\mathbf{f}_F = \\mathbf{M} \\mathbf{u}_S$：\n$$\\begin{pmatrix} f_0 \\\\ f_1 \\\\ f_2 \\\\ f_3 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 & 0 \\\\ \\frac{3}{8} & \\frac{3}{4} & -\\frac{1}{8} \\\\ -\\frac{1}{8} & \\frac{3}{4} & \\frac{3}{8} \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\\\ u_2 \\end{pmatrix}$$\n\n步骤 3：重构 $p+1$ 次通量多项式 $F(\\xi)$。\n通量多项式 $F(\\xi)$ 的次数为 $p+1=3$，并在通量点 $\\xi_F$ 处对通量值 $\\mathbf{f}_F$ 进行插值。使用拉格朗日插值：\n$$F(\\xi) = \\sum_{j=0}^{3} f_j L_{F,j}(\\xi)$$\n其中 $L_{F,j}(\\xi)$ 是通量点的拉格朗日基多项式。\n\n步骤 4：计算重构通量在解点处的导数。\n通量多项式的导数为：\n$$\\partial_{\\xi} F(\\xi) = \\sum_{j=0}^{3} f_j \\frac{d L_{F,j}}{d\\xi}(\\xi)$$\n我们需要该导数在解点 $\\xi_S=\\{-1, 0, 1\\}$ 处的值。这可以写成矩阵-向量乘积的形式，$\\mathbf{F}'_S = \\mathbf{L}' \\mathbf{f}_F$，其中 $\\mathbf{L}'$ 是一个 $3 \\times 4$ 矩阵，其元素为 $\\mathbf{L}'_{ij} = \\frac{d L_{F,j}}{d\\xi}(\\xi_{S,i})$。让我们在解点处计算通量基多项式 $L_{F,j}(\\xi)$ 的导数。\n基多项式的导数为：\n$\\frac{d L_{F,0}}{d\\xi} = \\frac{d}{d\\xi} \\left( -\\frac{2}{3}(\\xi^3 - \\xi^2 - \\frac{1}{4}\\xi + \\frac{1}{4}) \\right) = -\\frac{2}{3}(3\\xi^2 - 2\\xi - \\frac{1}{4})$\n$\\frac{d L_{F,1}}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{4}{3}(\\xi^3 - \\frac{1}{2}\\xi^2 - \\xi + \\frac{1}{2}) \\right) = \\frac{4}{3}(3\\xi^2 - \\xi - 1)$\n$\\frac{d L_{F,2}}{d\\xi} = \\frac{d}{d\\xi} \\left( -\\frac{4}{3}(\\xi^3 + \\frac{1}{2}\\xi^2 - \\xi - \\frac{1}{2}) \\right) = -\\frac{4}{3}(3\\xi^2 + \\xi - 1)$\n$\\frac{d L_{F,3}}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{2}{3}(\\xi^3 + \\xi^2 - \\frac{1}{4}\\xi - \\frac{1}{4}) \\right) = \\frac{2}{3}(3\\xi^2 + 2\\xi - \\frac{1}{4})$\n\n在 $\\xi_S = \\{-1, 0, 1\\}$ 处计算这些值：\n对于 $\\xi = -1$：\n$\\frac{d L_{F,0}}{d\\xi}(-1) = -\\frac{2}{3}(3+2-\\frac{1}{4}) = -\\frac{19}{6}$, $\\frac{d L_{F,1}}{d\\xi}(-1) = \\frac{4}{3}(3+1-1) = 4$, $\\frac{d L_{F,2}}{d\\xi}(-1) = -\\frac{4}{3}(3-1-1) = -\\frac{4}{3}$, $\\frac{d L_{F,3}}{d\\xi}(-1) = \\frac{2}{3}(3-2-\\frac{1}{4}) = \\frac{1}{2}$.\n对于 $\\xi = 0$：\n$\\frac{d L_{F,0}}{d\\xi}(0) = -\\frac{2}{3}(-\\frac{1}{4}) = \\frac{1}{6}$, $\\frac{d L_{F,1}}{d\\xi}(0) = \\frac{4}{3}(-1) = -\\frac{4}{3}$, $\\frac{d L_{F,2}}{d\\xi}(0) = -\\frac{4}{3}(-1) = \\frac{4}{3}$, $\\frac{d L_{F,3}}{d\\xi}(0) = \\frac{2}{3}(-\\frac{1}{4}) = -\\frac{1}{6}$.\n对于 $\\xi = 1$：\n$\\frac{d L_{F,0}}{d\\xi}(1) = -\\frac{2}{3}(3-2-\\frac{1}{4}) = -\\frac{1}{2}$, $\\frac{d L_{F,1}}{d\\xi}(1) = \\frac{4}{3}(3-1-1) = \\frac{4}{3}$, $\\frac{d L_{F,2}}{d\\xi}(1) = -\\frac{4}{3}(3+1-1) = -4$, $\\frac{d L_{F,3}}{d\\xi}(1) = \\frac{2}{3}(3+2-\\frac{1}{4}) = \\frac{19}{6}$.\n\n这给出了矩阵 $\\mathbf{L}'$：\n$$\\mathbf{L}' = \\begin{pmatrix} -\\frac{19}{6} & 4 & -\\frac{4}{3} & \\frac{1}{2} \\\\ \\frac{1}{6} & -\\frac{4}{3} & \\frac{4}{3} & -\\frac{1}{6} \\\\ -\\frac{1}{2} & \\frac{4}{3} & -4 & \\frac{19}{6} \\end{pmatrix}$$\n\n最后，推导微分矩阵 $\\mathbf{D}$。\n我们有 $\\mathbf{F}'_S = \\mathbf{L}' \\mathbf{f}_F$ 和 $\\mathbf{f}_F = \\mathbf{M} \\mathbf{u}_S$。将它们结合起来得到 $\\mathbf{F}'_S = (\\mathbf{L}' \\mathbf{M}) \\mathbf{u}_S$。因此，微分矩阵为 $\\mathbf{D} = \\mathbf{L}' \\mathbf{M}$。\n$$\\mathbf{D} = \\begin{pmatrix} -\\frac{19}{6} & 4 & -\\frac{4}{3} & \\frac{1}{2} \\\\ \\frac{1}{6} & -\\frac{4}{3} & \\frac{4}{3} & -\\frac{1}{6} \\\\ -\\frac{1}{2} & \\frac{4}{3} & -4 & \\frac{19}{6} \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ \\frac{3}{8} & \\frac{3}{4} & -\\frac{1}{8} \\\\ -\\frac{1}{8} & \\frac{3}{4} & \\frac{3}{8} \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n执行矩阵乘法：\n$D_{11} = (-\\frac{19}{6})(1) + (4)(\\frac{3}{8}) + (-\\frac{4}{3})(-\\frac{1}{8}) = -\\frac{19}{6} + \\frac{3}{2} + \\frac{1}{6} = -\\frac{18}{6} + \\frac{3}{2} = -3 + \\frac{3}{2} = -\\frac{3}{2}$\n$D_{12} = (4)(\\frac{3}{4}) + (-\\frac{4}{3})(\\frac{3}{4}) = 3 - 1 = 2$\n$D_{13} = (4)(-\\frac{1}{8}) + (-\\frac{4}{3})(\\frac{3}{8}) + (\\frac{1}{2})(1) = -\\frac{1}{2} - \\frac{1}{2} + \\frac{1}{2} = -\\frac{1}{2}$\n\n$D_{21} = (\\frac{1}{6})(1) + (-\\frac{4}{3})(\\frac{3}{8}) + (\\frac{4}{3})(-\\frac{1}{8}) = \\frac{1}{6} - \\frac{1}{2} - \\frac{1}{6} = -\\frac{1}{2}$\n$D_{22} = (-\\frac{4}{3})(\\frac{3}{4}) + (\\frac{4}{3})(\\frac{3}{4}) = -1 + 1 = 0$\n$D_{23} = (-\\frac{4}{3})(-\\frac{1}{8}) + (\\frac{4}{3})(\\frac{3}{8}) + (-\\frac{1}{6})(1) = \\frac{1}{6} + \\frac{1}{2} - \\frac{1}{6} = \\frac{1}{2}$\n\n$D_{31} = (-\\frac{1}{2})(1) + (\\frac{4}{3})(\\frac{3}{8}) + (-4)(-\\frac{1}{8}) = -\\frac{1}{2} + \\frac{1}{2} + \\frac{1}{2} = \\frac{1}{2}$\n$D_{32} = (\\frac{4}{3})(\\frac{3}{4}) + (-4)(\\frac{3}{4}) = 1 - 3 = -2$\n$D_{33} = (\\frac{4}{3})(-\\frac{1}{8}) + (-4)(\\frac{3}{8}) + (\\frac{19}{6})(1) = -\\frac{1}{6} - \\frac{3}{2} + \\frac{19}{6} = \\frac{18}{6} - \\frac{3}{2} = 3 - \\frac{3}{2} = \\frac{3}{2}$\n\n得到的微分矩阵 $\\mathbf{D}$ 是：\n$$\\mathbf{D} = \\begin{pmatrix} -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -2 & \\frac{3}{2} \\end{pmatrix}$$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{3}{2} & 2 & -\\frac{1}{2} \\\\ -\\frac{1}{2} & 0 & \\frac{1}{2} \\\\ \\frac{1}{2} & -2 & \\frac{3}{2} \\end{pmatrix} } $$"
        },
        {
            "introduction": "像通量重构这样的高阶方法的威力不仅在于其标称精度，还在于其诸如超收敛等微妙的特性。本实践探讨了一个看似微小的设计选择——单元内解点的位置——如何显著影响特定位置的精度。通过分析不同节点集的收敛行为，您将揭示求积规则、离散正交性与数值格式性能之间的深层联系。",
            "id": "3320647",
            "problem": "考虑单位区间上具有恒定正速度的一维周期性线性平流方程，\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\n其中 $a > 0$，方程定义在 $x \\in [0,1]$ 上，并具有光滑初始条件 $u(x,0) = \\sin\\left(2\\pi x\\right)$。在通量重构（FR）统一框架中，使用次数为 $p$ 的单元内多项式逼近，并选择特定的修正函数以恢复间断 Galerkin 方法。每个单元被映射到参考坐标 $\\xi \\in [-1,1]$ 上，数值解在一组 $p+1$ 个解点上表示。界面位置 $\\xi=-1$ 和 $\\xi=1$ 被称为通量点。\n\n考虑为 $p+1$ 个解点选择两种不同的节点集：\n- Gauss–Legendre 节点（仅内部节点），记作 $\\mathrm{LG}$。\n- Gauss–Lobatto–Legendre 节点（包括端点），记作 $\\mathrm{LGL}$。\n\n对于采用迎风数值通量的 FR 格式，在顺风通量点（右界面 $\\xi=1$）处计算的某些解或通量值表现出超收敛现象，即该通量点处的渐近点误差以 $h^q$ 的形式缩放，其指数 $q$ 严格大于标称阶 $p+1$，其中 $h$ 是单元尺寸。这种超收敛现象是否存在，与通过离散正交性和求积精度性质所选择的节点集有关。\n\n从以下基本依据出发：\n- 偏微分方程的守恒形式及其弱形式。\n- 每个单元上的多项式逼近，以及在界面处对 $a>0$ 使用迎风格式的数值通量。\n- Gauss–Legendre 和 Gauss–Lobatto–Legendre 求积精度的性质，具体来说，$p+1$ 点的 Gauss–Legendre 求积对最高 $2p+1$ 次的多项式是精确的，而 $p+1$ 点的 Gauss–Lobatto–Legendre 求积对最高 $2p-1$ 次的多项式是精确的。\n- 在通量重构统一框架内，使用 Legendre 和 Radau 多项式构造修正函数以恢复间断 Galerkin 方法。\n\n任务是，在不使用简便公式的情况下，根据多项式次数 $p$ 和节点集，从逻辑和数学上推导出 FR 格式在顺风通量点 $\\xi=1$ 处点误差的渐近收敛指数 $q$。利用上述基本性质，论证由求积精度引起的离散矩抵消如何决定主边界误差项是被消除（产生超收敛）还是持续存在（产生标称阶）。然后实现一个程序，给定一组 $(\\text{nodal\\_set}, p)$ 测试用例，输出每个用例预测的整数指数 $q$。\n\n您的实现必须是一个完整的、可运行的程序。不需要用户输入。使用以下参数测试套件：\n- 用例 1：$(\\mathrm{LG}, p=1)$。\n- 用例 2：$(\\mathrm{LGL}, p=1)$。\n- 用例 3：$(\\mathrm{LG}, p=2)$。\n- 用例 4：$(\\mathrm{LGL}, p=2)$。\n- 用例 5：$(\\mathrm{LG}, p=0)$。\n- 用例 6：$(\\mathrm{LGL}, p=0)$。\n- 用例 7：$(\\mathrm{LG}, p=3)$。\n- 用例 8：$(\\mathrm{LGL}, p=3)$。\n\n对于每个用例，程序必须计算并报告顺风通量点处渐近点误差的整数指数 $q$。需要编码的原理是：当节点集为 $\\mathrm{LG}$ 时，由最高 $2p+1$ 次的精度所引出的离散矩结构消除了 FR 格式中基于 Radau 的修正所构造的主边界误差项，从而得到 $q=2p+1$；当节点集为 $\\mathrm{LGL}$ 时，这种离散精度达不到 $2p+1$ 次，主项持续存在，得到 $q=p+1$。对于退化情况 $p=0$，两者都得到 $q=1$。\n\n您的程序应生成单行输出，其中包含用逗号分隔并用方括号括起来的结果（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。输出必须是无单位的整数。此问题中不出现角度。由于收敛指数是无量纲的，因此不需要物理单位。",
            "solution": "问题陈述的有效性已确立。该问题在科学上基于偏微分方程数值方法的理论，是适定的，并且陈述客观。所有从基本先验原理推导解决方案所需的信息均已提供。\n\n任务是推导应用于一维线性平流方程 $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$（其中 $a > 0$）的通量重构（FR）格式在顺风通量点处点误差的渐近收敛指数 $q$。指数 $q$ 取决于逼近的多项式次数 $p$ 和节点集的选择（Gauss-Legendre，$\\mathrm{LG}$，或 Gauss-Lobatto-Legendre，$\\mathrm{LGL}$）。\n\n推导过程从所提供的基本原理出发。\n\n1.  **框架设置**：我们考虑守恒形式的方程 $\\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} = 0$，其通量为 $f(u) = au$。区域 $[0,1]$ 被离散为尺寸为 $h$ 的单元，每个单元映射到参考单元 $\\xi \\in [-1,1]$。在每个单元内，解 $u$ 由一个 $p$ 次多项式 $u_h$ 逼近，该多项式由其在 $p+1$ 个解点上的值定义。FR 方法通过添加一个修正多项式，从一个不连续的通量 $F_D(\\xi) = a u_h(\\xi)$ 构造出单元内的连续通量逼近 $F(\\xi)$。单元内的半离散方程为 $\\frac{d u_h}{dt} = -\\frac{1}{J} \\frac{dF}{d\\xi}$，其中 $J=h/2$ 是映射的雅可比矩阵。\n\n2.  **与间断 Galerkin (DG) 的联系**：问题指定使用可恢复节点型 DG 方法的修正函数。对于恒定正速度 $a>0$，流动方向从左到右，使得 $\\xi=-1$ 为迎风界面，$\\xi=1$ 为顺风界面。通量修正是由界面上的数值通量 $F^*$ 与内部通量迹之间的跳跃决定的。对于迎风通量，右界面 $\\xi=1$ 处的跳跃为 $\\Delta F_R = F^*(1) - F_D(1) = a u_h(1) - a u_h(1) = 0$，因为数值通量取自单元内部。左界面处的跳跃为 $\\Delta F_L = F^*(-1) - F_D(-1) = a u_{h,L}^* - a u_h(-1)$，其中 $u_{h,L}^*$ 是来自迎风相邻单元的解值。修正后的通量为 $F(\\xi) = F_D(\\xi) + \\Delta F_L \\cdot g_L(\\xi)$，其中 $g_L(\\xi)$ 是左修正函数。与 DG 等效的修正函数使用 Radau 多项式构造，使得 $\\frac{dg_L}{d\\xi}$ 与右 Radau 多项式 $R_p(\\xi) = L_p(\\xi) - L_{p+1}(\\xi)$ 的导数成比例。\n\n3.  **误差传播机制**：超收敛分析侧重于误差 $\\epsilon = u_h - u_I$ 的演化，其中 $u_I$ 是在 $p+1$ 个解点上插值精确解 $u_{ex}$ 的 $p$ 次多项式。顺风通量点处的误差 $\\epsilon(1,t)$ 主要由在迎风通量边界引入的误差驱动。对于具有精确初始条件的单个单元，一个时间步长后的主要误差源是通量散度的连续和离散表示之间的不匹配。顺风点 $\\xi=1$ 处的误差与来自迎风通量边界条件的截断误差的积分成正比。对于节点型 DG/FR 格式，关键在于此误差由迎风单元中初始插值误差的特定矩所控制。出流边界 $\\xi=1$ 处的点误差由以下形式的项主导：\n$$\n\\epsilon(1) \\propto \\int_{-1}^{1} (u_{ex}(\\xi, 0) - u_I(\\xi, 0)) \\cdot \\Psi(\\xi) d\\xi\n$$\n其中 $u_{ex}(\\xi, 0) - u_I(\\xi, 0)$ 是初始插值误差，而 $\\Psi(\\xi)$ 是一个与格式右手边公式相关的特定检验函数。对于从 FR 恢复的 DG 格式，$\\Psi(\\xi)$ 与修正函数的导数相关，并且是一个 $p$ 次多项式。\n\n4.  **求积的作用**：在节点格式中，积分被替换为在解点 $\\{\\xi_k\\}_{k=0}^p$ 上的求积和：\n$$\n\\int_{-1}^{1} \\phi(\\xi) d\\xi \\approx \\sum_{k=0}^{p} w_k \\phi(\\xi_k)\n$$\n半离散误差方程的右边包含项 $\\sum_{k=0}^{p} w_k (u_{ex}(\\xi_k, 0) - u_I(\\xi_k, 0)) \\cdot \\Psi(\\xi_k)$。根据插值多项式 $u_I$ 的定义，在所有解点 $\\xi_k$ 处，我们有 $u_{ex}(\\xi_k, 0) - u_I(\\xi_k, 0) = 0$。因此，该离散和恒等于零。这意味着格式传播的误差与积分项的求积误差成正比：\n$$\nE_{quad} = \\int_{-1}^{1} (u_{ex} - u_I) \\Psi(\\xi) d\\xi - \\sum_{k=0}^{p} w_k (u_{ex} - u_I)(\\xi_k) \\Psi(\\xi_k) = \\int_{-1}^{1} (u_{ex} - u_I) \\Psi(\\xi) d\\xi\n$$\n因此，收敛阶 $q$ 由该积分的大小决定，而积分大小又取决于由节点集定义的求积法则如何处理具有特定多项式结构的被积函数。插值误差的行为是 $u_{ex} - u_I \\sim O(h^{p+1})$，并与一个 $p+1$ 次多项式成正比。检验函数 $\\Psi(\\xi)$ 是一个 $p$ 次多项式。因此，被积函数 $(u_{ex} - u_I) \\Psi(\\xi)$ 是一个 $(p+1)+p = 2p+1$ 次的多项式。\n\n5.  **Gauss-Legendre ($\\mathrm{LG}$) 节点的推导**：对于 $\\mathrm{LG}$ 节点集，$p+1$ 个解点是 Legendre 多项式 $L_{p+1}(\\xi)$ 的根。相应的 $p+1$ 点 Gauss-Legendre 求积法则对所有次数最高为 $2(p+1) - 1 = 2p+1$ 的多项式都是精确的。控制主误差项的被积函数是一个 $2p+1$ 次的多项式。由于 $\\mathrm{LG}$ 求积法则对此次数的多项式是精确的，因此求积误差为零。\n$$\n\\int_{-1}^{1} (u_{ex} - u_I) \\Psi(\\xi) d\\xi = \\sum_{k=0}^{p} w_k (u_{ex} - u_I)(\\xi_k) \\Psi(\\xi_k) = 0\n$$\n这意味着阶为 $h^{p+1}$ 的主误差项由于离散矩抵消而完全消失。顺风边界处的误差现在由误差展开中的更高阶项决定。更详细的分析表明，插值误差的下一个非零矩导致点误差以 $h$ 的更高次幂缩放。最终的收敛阶为 $q = 2p+1$。这就是超收敛，因为对于 $p>0$，有 $2p+1 > p+1$。\n\n6.  **Gauss-Lobatto-Legendre ($\\mathrm{LGL}$) 节点的推导**：对于 $\\mathrm{LGL}$ 节点集，$p+1$ 个解点包括端点 $\\xi = \\pm 1$。相应的 $p+1$ 点 Gauss-Lobatto-Legendre 求积法则对所有次数最高为 $2(p+1) - 3 = 2p-1$ 的多项式都是精确的。如前所述，被积函数 $(u_{ex} - u_I) \\Psi(\\xi)$ 是一个 $2p+1$ 次的多项式。对于 $p \\geq 1$，我们有 $2p+1 > 2p-1$。$\\mathrm{LGL}$ 求积法则对于这个被积函数是不精确的。因此，求积误差不为零：\n$$\n\\int_{-1}^{1} (u_{ex} - u_I) \\Psi(\\xi) d\\xi \\neq \\sum_{k=0}^{p} w_k (u_{ex} - u_I)(\\xi_k) \\Psi(\\xi_k) = 0\n$$\n由于积分不为零，且插值误差项 $(u_{ex} - u_I)$ 的阶为 $h^{p+1}$，因此求积误差的阶也为 $h^{p+1}$。这个主误差项不会消失。因此，顺风边界处的点误差以格式的标称精度阶收敛。收敛指数为 $q = p+1$。\n\n7.  **退化情况 $p=0$**：当 $p=0$ 时，逼近 $u_h$ 是分片常数。对于 $\\mathrm{LG}$ 和 $\\mathrm{LGL}$ 两种约定，都只有一个解点（$p+1=1$），通常位于单元中心 $\\xi=0$。标称阶为 $p+1=1$。分片常数逼近对于光滑解的收敛速度不可能快于一阶，因此不可能出现超收敛。收敛阶被限制为 $q=1$。这与两种情况的公式都一致：对于 $\\mathrm{LG}$，$q=2(0)+1=1$；对于 $\\mathrm{LGL}$，$q=0+1=1$。\n\n**结论**：顺风通量点是否存在超收敛，直接取决于与节点集相关的求积法则的精度阶。\n- 对于 $\\mathrm{LG}$ 节点，求积法则足够精确（对最高 $2p+1$ 次多项式精确），能够消除主误差项，从而导致阶为 $q=2p+1$ 的超收敛。\n- 对于 $\\mathrm{LGL}$ 节点，求积法则不够精确（仅对最高 $2p-1$ 次多项式精确），因此主误差项持续存在，格式达到其标称阶 $q=p+1$。\n- 对于基本情况 $p=0$，两种方法都得到标称阶 $q=1$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the asymptotic convergence exponent q for the Flux Reconstruction method\n    at the downwind flux point for a set of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (nodal_set_str, polynomial_degree_p).\n    test_cases = [\n        ('LG', 1),   # Case 1\n        ('LGL', 1),  # Case 2\n        ('LG', 2),   # Case 3\n        ('LGL', 2),  # Case 4\n        ('LG', 0),   # Case 5\n        ('LGL', 0),  # Case 6\n        ('LG', 3),   # Case 7\n        ('LGL', 3),  # Case 8\n    ]\n\n    results = []\n    for nodal_set, p in test_cases:\n        # The derivation shows that the convergence exponent 'q' depends on\n        # whether discrete moment cancellations occur, which is tied to the\n        # exactness of the quadrature rule associated with the nodal set.\n        \n        # For the degenerate case p=0, the approximation is piecewise constant.\n        # The order is limited to 1, regardless of methodology.\n        if p == 0:\n            q = 1\n        \n        # For Gauss-Legendre (LG) nodes, the quadrature is exact for polynomials\n        # up to degree 2p+1. This annihilates the leading error term (which is\n        # a polynomial of degree 2p+1), leading to superconvergence.\n        elif nodal_set == 'LG':\n            q = 2 * p + 1\n        \n        # For Gauss-Lobatto-Legendre (LGL) nodes, the quadrature is only exact\n        # for polynomials up to degree 2p-1. The leading error term persists,\n        # yielding the nominal order of convergence.\n        elif nodal_set == 'LGL':\n            q = p + 1\n        \n        else:\n            # This case should not be reached with the given valid test cases.\n            # Assign an invalid value to indicate an error.\n            q = -1 \n\n        results.append(q)\n\n    # Final print statement in the exact required format.\n    # e.g., \"[result_1,result_2,...]\"\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "为了应用于实际问题，一个数值框架必须能稳健地处理复杂的物理现象和边界条件。本练习从简单的标量方程过渡到非线性的气体动力学欧拉方程，重点关注实现亚音速入流边界条件这一关键任务。您将应用特征线理论的原理来构建一个在物理和数值上都合理的“虚拟状态”，从而展示FR方法的弱边界条件施加方式如何为复杂的CFD模拟提供一种灵活而稳定的途径。",
            "id": "3320624",
            "problem": "考虑一维无粘可压缩理想气体欧拉方程，其比热比 $\\gamma$ 为常数，其守恒形式写作 $\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = 0$，其中 $\\mathbf{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ 且 $\\mathbf{F}(\\mathbf{U}) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\mathsf{T}}$，状态方程为 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$。在通量重构（FR）统一框架中，单元残差通过数值通量 $\\hat{f}^{n}$ 与其相邻单元和物理边界耦合，该数值通量与投影到外向单位法向量 $\\mathbf{n}$ 上的物理通量一致，即 $\\hat{f}^{n}(\\mathbf{U}^{-}, \\mathbf{U}^{+}) \\approx \\mathbf{F}(\\mathbf{U}) \\cdot \\mathbf{n}$。在物理边界上，通过在内部迹 $\\mathbf{U}^{-}$ 和一个边界外部状态 $\\mathbf{U}_{b}$ 上评估 $\\hat{f}^{n}$ 来弱施加边界条件，其中边界外部状态 $\\mathbf{U}_{b}$ 通过双曲容许构造来编码物理边界信息。\n\n(a) 从积分守恒律和一致的近似黎曼求解器 $\\hat{f}^{n}(\\cdot,\\cdot)$ 的定义出发，陈述在边界通量面上弱施加边界条件是如何进入FR残差的，并解释为什么通过特征信息选择 $\\mathbf{U}_{b}$ 能确保亚音速入流的迎风稳定性。\n\n(b) 考虑一个位于 $x=0$ 的左边界，其所在域为半无限域 $x>0$，并有指向域内的亚音速入流，即 $u > 0$ 且 $0  M  1$，其中 $M = |u|/c$ 且 $c = \\sqrt{\\gamma p/\\rho}$ 为声速。设边界处的内部原始状态为 $\\mathbf{w}^{-} = (\\rho^{-}, u^{-}, p^{-})^{\\mathsf{T}}$。设外部（指定的入流）原始数据为 $\\mathbf{w}_{\\infty} = (\\rho_{\\infty}, u_{\\infty}, p_{\\infty})^{\\mathsf{T}}$。仅使用欧拉方程的双曲结构和理想气体关系，通过强制与入射波相关的特征信息取自 $\\mathbf{w}_{\\infty}$，而与出射波相关的特征信息取自 $\\mathbf{w}^{-}$，来构造边界原始状态 $\\mathbf{w}_{b} = (\\rho_{b}, u_{b}, p_{b})^{\\mathsf{T}}$。然后，将 $\\mathbf{w}_{b}$ 表示为 $(\\rho^{-}, u^{-}, p^{-})$、$(\\rho_{\\infty}, u_{\\infty}, p_{\\infty})$ 和 $\\gamma$ 的闭式解析表达式。您的最终答案必须是写成单个行矩阵的边界原始状态向量 $\\mathbf{w}_{b}$。不需要进行数值评估；请提供精确的符号表达式。最终结果中不要包含任何单位。",
            "solution": "该问题被评估为有效，因为它在科学上基于计算流体力学和双曲偏微分方程的原理，是适定的，并且陈述客观。所有提供的信息都是一致且足以推导出唯一解的。\n\n(a) 通量重构中边界条件的弱施加及稳定性\n\n通量重构（FR）方法是根据守恒律在计算单元 $I_j = [x_L, x_R]$ 上的积分形式 $\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = 0$ 建立的。对于一个测试函数 $\\phi_k(x)$，其弱形式为：\n$$ \\int_{I_j} \\phi_k (\\partial_t \\mathbf{U}_h + \\partial_x \\mathbf{F}_h) \\,dx = 0 $$\n其中 $\\mathbf{U}_h$ 和 $\\mathbf{F}_h$ 分别是单元内解和通量的多项式近似。对通量项进行分部积分得到：\n$$ \\int_{I_j} \\phi_k \\partial_t \\mathbf{U}_h \\,dx + \\left[ \\phi_k \\mathbf{F}_h \\right]_{x_L}^{x_R} - \\int_{I_j} (\\partial_x \\phi_k) \\mathbf{F}_h \\,dx = 0 $$\n解 $\\mathbf{U}_h$ 在单元内部是连续的，但在单元之间是不连续的。这导致通量 $\\mathbf{F}_h$ 在单元界面处不连续。为确保守恒性并提供耦合，界面处可能存在的双值通量被一个单值数值通量 $\\hat{\\mathbf{F}}$ 所取代。该数值通量是界面两侧状态的函数，即 $\\mathbf{U}^{-}$（内部值）和 $\\mathbf{U}^{+}$（外部值）。弱形式变为：\n$$ \\int_{I_j} \\phi_k \\partial_t \\mathbf{U}_h \\,dx + \\phi_k(x_R) \\hat{\\mathbf{F}}(x_R) - \\phi_k(x_L) \\hat{\\mathbf{F}}(x_L) - \\int_{I_j} (\\partial_x \\phi_k) \\mathbf{F}_h \\,dx = 0 $$\n单元残差是该方程的空间部分。\n\n在一个物理边界上，例如在左侧通量面 $x_L = 0$，内部状态是来自计算域内部的解的迹 $\\mathbf{U}^{-}(0)$。“外部”状态（通常来自相邻单元）不存在。因此，我们必须构造一个编码了物理边界条件的虚拟状态 $\\mathbf{U}_b$。此边界通量面上的数值通量随后计算为 $\\hat{\\mathbf{F}}(0) = \\hat{f}^n(\\mathbf{U}^{-}(0), \\mathbf{U}_b)$，其中 $\\hat{f}^n$ 是一个近似黎曼求解器。因此，边界条件的弱施加通过边界通量项 $\\phi_k(0) \\hat{f}^n(\\mathbf{U}^{-}(0), \\mathbf{U}_b)$ 进入单元残差。\n\n此过程的稳定性由一种“双曲容许”的 $\\mathbf{U}_b$ 构造方法来保证，该方法依赖于控制方程的双曲系统的特征结构。对于一维欧拉方程，通量雅可比矩阵 $\\mathbf{A} = \\partial \\mathbf{F} / \\partial \\mathbf{U}$ 具有三个对应于特征速度的实特征值：$\\lambda_1 = u-c$、$\\lambda_2 = u$ 和 $\\lambda_3 = u+c$。特征值的符号表示信息沿相应特征线的传播方向。\n\n对于左边界（$x=0$，域 $x>0$）的亚音速入流，我们有 $u > 0$ 且马赫数 $M = u/c  1$。特征值为：\n- $\\lambda_1 = u-c  0$：信息从域内部（$x0$）向边界传播。这是一个**出射**波。\n- $\\lambda_2 = u  0$：信息从域外部（$x0$）传入域内。这是一个**入射**波。\n- $\\lambda_3 = u+c  0$：信息也从外部传入域内。这是一个**入射**波。\n\n对于双曲系统的适定边值问题，需要指定的边界条件数量必须等于入射特征的数量。在这里，有两个入射波。与出射波相关的信息必须由域内的解确定。\n\n通过构造 $\\mathbf{U}_b$，使得与入射波（$\\lambda_2, \\lambda_3$）相关的特征变量由指定的外部数据 $\\mathbf{w}_{\\infty}$ 确定，而与出射波（$\\lambda_1$）相关的特征变量由内部解的迹 $\\mathbf{w}^{-}$ 确定，我们便根据双曲理论正确地设定了边界条件。这种对特征信息的“迎风”处理确保了边界能吸收出射波而无伪反射，并正确地施加外部状态信息，从而防止了会导致数值不稳定性的能量的人为产生。\n\n(b) 边界状态 $\\mathbf{w}_b$ 的构造\n\n我们通过根据传播方向设定特征变量的值来构造边界原始状态 $\\mathbf{w}_b = (\\rho_b, u_b, p_b)^{\\mathsf{T}}$。特征变量由欧拉方程的黎曼不变量导出。对于熵变沿迹线平流且声波被视为等熵的流动，相关的特征量为：\n1. $u - \\frac{2c}{\\gamma-1}$，与出射波（$\\lambda_1 = u-c$）相关。\n2. $S \\propto p/\\rho^\\gamma$，即熵，与入射波（$\\lambda_2 = u$）相关。\n3. $u + \\frac{2c}{\\gamma-1}$，与入射波（$\\lambda_3 = u+c$）相关。\n\n此处，$c$ 是当地声速，$c=\\sqrt{\\gamma p/\\rho}$。根据基于特征的边界条件原理，状态 $\\mathbf{w}_b$ 必须满足：\n1. 来自内部状态 $\\mathbf{w}^{-}$ 的出射信息：\n   $$ u_b - \\frac{2c_b}{\\gamma-1} = u^{-} - \\frac{2c^{-}}{\\gamma-1} $$\n2. 来自指定的外部状态 $\\mathbf{w}_{\\infty}$ 的入射信息：\n   $$ \\frac{p_b}{\\rho_b^\\gamma} = \\frac{p_{\\infty}}{\\rho_{\\infty}^\\gamma} $$\n3. 来自指定的外部状态 $\\mathbf{w}_{\\infty}$ 的入射信息：\n   $$ u_b + \\frac{2c_b}{\\gamma-1} = u_{\\infty} + \\frac{2c_{\\infty}}{\\gamma-1} $$\n\n此处，$c_b = \\sqrt{\\gamma p_b/\\rho_b}$，$c^{-} = \\sqrt{\\gamma p^{-}/\\rho^{-}}$，以及 $c_{\\infty} = \\sqrt{\\gamma p_{\\infty}/\\rho_{\\infty}}$。我们得到了一个关于三个未知数 $(\\rho_b, u_b, p_b)$ 的三方程系统。\n\n首先，我们利用两个声学不变量方程（1）和（3）求解 $u_b$ 和 $c_b$。\n将方程（1）和（3）相加：\n$$ 2u_b = (u_{\\infty} + u^{-}) + \\frac{2c_{\\infty}}{\\gamma-1} - \\frac{2c^{-}}{\\gamma-1} \\implies u_b = \\frac{1}{2}(u_{\\infty} + u^{-}) + \\frac{c_{\\infty} - c^{-}}{\\gamma-1} $$\n将方程（1）从方程（3）中减去：\n$$ \\frac{4c_b}{\\gamma-1} = (u_{\\infty} - u^{-}) + \\frac{2c_{\\infty}}{\\gamma-1} + \\frac{2c^{-}}{\\gamma-1} \\implies c_b = \\frac{\\gamma-1}{4}(u_{\\infty} - u^{-}) + \\frac{1}{2}(c_{\\infty} + c^{-}) $$\n\n现在我们使用方程（2）和声速的定义来求解 $\\rho_b$ 和 $p_b$。\n从（2）式，我们有 $p_b = p_{\\infty} \\left( \\frac{\\rho_b}{\\rho_{\\infty}} \\right)^\\gamma$。\n从 $c_b$ 的定义，我们有 $p_b = \\frac{\\rho_b c_b^2}{\\gamma}$。\n令这两个 $p_b$ 的表达式相等：\n$$ \\frac{\\rho_b c_b^2}{\\gamma} = p_{\\infty} \\left( \\frac{\\rho_b}{\\rho_{\\infty}} \\right)^\\gamma = \\frac{p_{\\infty}}{\\rho_{\\infty}^\\gamma} \\rho_b^\\gamma $$\n$$ \\rho_b^{1-\\gamma} = \\frac{\\gamma p_{\\infty}}{c_b^2 \\rho_{\\infty}^\\gamma} = \\frac{\\gamma p_{\\infty}}{c_b^2 \\rho_{\\infty}^\\gamma} \\frac{\\rho_{\\infty}}{\\rho_{\\infty}} = \\frac{\\gamma p_{\\infty}/\\rho_{\\infty}}{c_b^2} \\frac{1}{\\rho_{\\infty}^{\\gamma-1}} = \\frac{c_{\\infty}^2}{c_b^2} \\rho_{\\infty}^{1-\\gamma} $$\n$$ \\rho_b = \\left( \\frac{c_{\\infty}^2}{c_b^2} \\rho_{\\infty}^{1-\\gamma} \\right)^{\\frac{1}{1-\\gamma}} = \\left( \\frac{c_{\\infty}}{c_b} \\right)^{\\frac{2}{1-\\gamma}} \\rho_{\\infty} = \\rho_{\\infty} \\left( \\frac{c_b}{c_{\\infty}} \\right)^{\\frac{2}{\\gamma-1}} $$\n最后，将这个 $\\rho_b$ 的表达式代入方程（2）的熵关系式中：\n$$ p_b = p_{\\infty} \\left( \\frac{\\rho_b}{\\rho_{\\infty}} \\right)^\\gamma = p_{\\infty} \\left( \\left( \\frac{c_b}{c_{\\infty}} \\right)^{\\frac{2}{\\gamma-1}} \\right)^\\gamma = p_{\\infty} \\left( \\frac{c_b}{c_{\\infty}} \\right)^{\\frac{2\\gamma}{\\gamma-1}} $$\n\n通过代入 $c_b$、$c^{-}$ 和 $c_{\\infty}$ 的表达式，可得到 $\\mathbf{w}_b = (\\rho_b, u_b, p_b)^{\\mathsf{T}}$ 的完整表达式。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\rho_{\\infty} \\left( \\frac{\\frac{1}{2}(\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}} + \\sqrt{\\frac{\\gamma p^{-}}{\\rho^{-}}}) + \\frac{\\gamma - 1}{4}(u_{\\infty} - u^{-})}{\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}}} \\right)^{\\frac{2}{\\gamma-1}}  \\frac{1}{2}(u_{\\infty} + u^{-}) + \\frac{1}{\\gamma-1}\\left(\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}} - \\sqrt{\\frac{\\gamma p^{-}}{\\rho^{-}}}\\right)  p_{\\infty} \\left( \\frac{\\frac{1}{2}(\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}} + \\sqrt{\\frac{\\gamma p^{-}}{\\rho^{-}}}) + \\frac{\\gamma - 1}{4}(u_{\\infty} - u^{-})}{\\sqrt{\\frac{\\gamma p_{\\infty}}{\\rho_{\\infty}}}} \\right)^{\\frac{2\\gamma}{\\gamma-1}} \\end{pmatrix}} $$"
        }
    ]
}