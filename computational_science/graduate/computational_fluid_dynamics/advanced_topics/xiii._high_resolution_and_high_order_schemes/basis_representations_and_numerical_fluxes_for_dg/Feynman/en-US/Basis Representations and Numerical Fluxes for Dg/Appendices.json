{
    "hands_on_practices": [
        {
            "introduction": "This exercise forms the bedrock of implementing any finite element-type method, including the Discontinuous Galerkin (DG) scheme. You will translate the abstract weak-form integrals into their concrete algebraic counterparts: the mass and stiffness matrices. By using Legendre polynomials as a modal basis and applying numerical quadrature, you will gain hands-on experience in constructing the fundamental operators that govern the behavior of the solution within a single element. ",
            "id": "3295180",
            "problem": "Consider the one-dimensional reference element $[-1,1]$ used in the Discontinuous Galerkin (DG) method. Use the polynomial space $P^2$ spanned by the Legendre basis polynomials $\\{\\phi_0,\\phi_1,\\phi_2\\}=\\{P_0,P_1,P_2\\}$ with $P_0(x)=1$, $P_1(x)=x$, and $P_2(x)=\\tfrac{1}{2}(3x^2-1)$. Define the elemental mass matrix $M$ and the elemental $H^1$ stiffness matrix $K$ by\n$$\nM_{ij}=\\int_{-1}^1 \\phi_i(x)\\,\\phi_j(x)\\,dx, \\qquad K_{ij}=\\int_{-1}^1 \\phi_i'(x)\\,\\phi_j'(x)\\,dx,\n$$\nfor $i,j\\in\\{0,1,2\\}$. Evaluate all entries using the $N_q=3$ Gauss–Legendre quadrature rule on $[-1,1]$ and verify that the mass matrix is diagonal. Then, form the matrix $A=M^{-1}K$ and determine its spectral radius $\\rho(A)$ as an exact number. Provide the explicit entries of $M$ and $K$ in your working, but report only the single final value of $\\rho(A)$ as your final answer. No rounding is required.",
            "solution": "The problem requires the evaluation of the elemental mass matrix $M$ and stiffness matrix $K$ for a $P^2$ polynomial space on the reference element $[-1,1]$ using a $3$-point Gauss-Legendre quadrature rule. Subsequently, we are to form the matrix $A=M^{-1}K$ and find its spectral radius $\\rho(A)$.\n\nFirst, we list the given Legendre basis polynomials and their derivatives:\n- Basis functions ($\\phi_i(x)$):\n$$\n\\phi_0(x) = 1 \\\\\n\\phi_1(x) = x \\\\\n\\phi_2(x) = \\frac{1}{2}(3x^2 - 1)\n$$\n- Derivatives of basis functions ($\\phi_i'(x)$):\n$$\n\\phi_0'(x) = 0 \\\\\n\\phi_1'(x) = 1 \\\\\n\\phi_2'(x) = 3x\n$$\n\nThe matrices $M$ and $K$ are defined by the integrals $M_{ij}=\\int_{-1}^1 \\phi_i(x)\\,\\phi_j(x)\\,dx$ and $K_{ij}=\\int_{-1}^1 \\phi_i'(x)\\,\\phi_j'(x)\\,dx$. We must evaluate these integrals using the $N_q=3$ Gauss-Legendre quadrature rule, which approximates an integral as $\\int_{-1}^1 f(x) dx \\approx \\sum_{k=1}^{3} w_k f(x_k)$.\n\nFor $N_q=3$, the quadrature points $x_k$ are the roots of the Legendre polynomial $P_3(x)$, and the weights are $w_k$.\n- Quadrature points: $x_1 = -\\sqrt{\\frac{3}{5}}$, $x_2 = 0$, $x_3 = \\sqrt{\\frac{3}{5}}$.\n- Quadrature weights: $w_1 = \\frac{5}{9}$, $w_2 = \\frac{8}{9}$, $w_3 = \\frac{5}{9}$.\n\nWe evaluate the basis functions and their derivatives at these quadrature points.\nValues of $\\phi_i(x_k)$:\n- $\\phi_0(x_k) = 1$ for $k \\in \\{1,2,3\\}$.\n- $\\phi_1(x_1) = -\\sqrt{\\frac{3}{5}}$, $\\phi_1(x_2) = 0$, $\\phi_1(x_3) = \\sqrt{\\frac{3}{5}}$.\n- $\\phi_2(x_1) = \\frac{1}{2}(3(-\\sqrt{\\frac{3}{5}})^2-1) = \\frac{1}{2}(3(\\frac{3}{5})-1) = \\frac{1}{2}(\\frac{9}{5}-1) = \\frac{2}{5}$.\n- $\\phi_2(x_2) = \\frac{1}{2}(3(0)^2-1) = -\\frac{1}{2}$.\n- $\\phi_2(x_3) = \\frac{1}{2}(3(\\sqrt{\\frac{3}{5}})^2-1) = \\frac{2}{5}$.\n\nValues of $\\phi_i'(x_k)$:\n- $\\phi_0'(x_k) = 0$ for $k \\in \\{1,2,3\\}$.\n- $\\phi_1'(x_k) = 1$ for $k \\in \\{1,2,3\\}$.\n- $\\phi_2'(x_1) = 3(-\\sqrt{\\frac{3}{5}}) = -3\\sqrt{\\frac{3}{5}}$.\n- $\\phi_2'(x_2) = 3(0) = 0$.\n- $\\phi_2'(x_3) = 3(\\sqrt{\\frac{3}{5}}) = 3\\sqrt{\\frac{3}{5}}$.\n\nNow, we compute the entries of the mass matrix $M$ using $M_{ij} = \\sum_{k=1}^{3} w_k \\phi_i(x_k) \\phi_j(x_k)$. Due to the orthogonality of Legendre polynomials and the fact that the $3$-point rule integrates polynomials of degree up to $2(3)-1=5$ exactly, we expect a diagonal matrix.\n- $M_{00} = \\sum_{k=1}^{3} w_k \\phi_0(x_k)^2 = (\\frac{5}{9})(1)^2 + (\\frac{8}{9})(1)^2 + (\\frac{5}{9})(1)^2 = \\frac{5+8+5}{9} = \\frac{18}{9} = 2$.\n- $M_{11} = \\sum_{k=1}^{3} w_k \\phi_1(x_k)^2 = (\\frac{5}{9})(-\\sqrt{\\frac{3}{5}})^2 + (\\frac{8}{9})(0)^2 + (\\frac{5}{9})(\\sqrt{\\frac{3}{5}})^2 = (\\frac{5}{9})(\\frac{3}{5}) + 0 + (\\frac{5}{9})(\\frac{3}{5}) = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}$.\n- $M_{22} = \\sum_{k=1}^{3} w_k \\phi_2(x_k)^2 = (\\frac{5}{9})(\\frac{2}{5})^2 + (\\frac{8}{9})(-\\frac{1}{2})^2 + (\\frac{5}{9})(\\frac{2}{5})^2 = (\\frac{5}{9})(\\frac{4}{25}) + (\\frac{8}{9})(\\frac{1}{4}) + (\\frac{5}{9})(\\frac{4}{25}) = \\frac{4}{45} + \\frac{2}{9} + \\frac{4}{45} = \\frac{4+10+4}{45} = \\frac{18}{45} = \\frac{2}{5}$.\n- Off-diagonal terms $M_{ij}$ for $i \\ne j$:\n  - $M_{01} = \\sum_{k=1}^{3} w_k \\phi_0(x_k) \\phi_1(x_k) = (\\frac{5}{9})(1)(-\\sqrt{\\frac{3}{5}}) + (\\frac{8}{9})(1)(0) + (\\frac{5}{9})(1)(\\sqrt{\\frac{3}{5}}) = 0$.\n  - $M_{02} = \\sum_{k=1}^{3} w_k \\phi_0(x_k) \\phi_2(x_k) = (\\frac{5}{9})(1)(\\frac{2}{5}) + (\\frac{8}{9})(1)(-\\frac{1}{2}) + (\\frac{5}{9})(1)(\\frac{2}{5}) = \\frac{2}{9} - \\frac{4}{9} + \\frac{2}{9} = 0$.\n  - $M_{12} = \\sum_{k=1}^{3} w_k \\phi_1(x_k) \\phi_2(x_k) = (\\frac{5}{9})(-\\sqrt{\\frac{3}{5}})(\\frac{2}{5}) + (\\frac{8}{9})(0)(-\\frac{1}{2}) + (\\frac{5}{9})(\\sqrt{\\frac{3}{5}})(\\frac{2}{5}) = 0$.\nBy symmetry, $M_{ji} = M_{ij}$. Thus, the mass matrix is:\n$$\nM = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{2}{5} \\end{pmatrix}\n$$\nAs verified, the mass matrix $M$ is diagonal.\n\nNext, we compute the entries of the stiffness matrix $K$ using $K_{ij} = \\sum_{k=1}^{3} w_k \\phi_i'(x_k) \\phi_j'(x_k)$.\n- Since $\\phi_0'(x) = 0$, all entries in the first row and column are zero: $K_{0j} = K_{j0} = 0$.\n- $K_{11} = \\sum_{k=1}^{3} w_k \\phi_1'(x_k)^2 = (\\frac{5}{9})(1)^2 + (\\frac{8}{9})(1)^2 + (\\frac{5}{9})(1)^2 = \\frac{18}{9} = 2$.\n- $K_{22} = \\sum_{k=1}^{3} w_k \\phi_2'(x_k)^2 = (\\frac{5}{9})(-3\\sqrt{\\frac{3}{5}})^2 + (\\frac{8}{9})(0)^2 + (\\frac{5}{9})(3\\sqrt{\\frac{3}{5}})^2 = (\\frac{5}{9})(9 \\cdot \\frac{3}{5}) + 0 + (\\frac{5}{9})(9 \\cdot \\frac{3}{5}) = 3 + 3 = 6$.\n- $K_{12} = \\sum_{k=1}^{3} w_k \\phi_1'(x_k) \\phi_2'(x_k) = (\\frac{5}{9})(1)(-3\\sqrt{\\frac{3}{5}}) + (\\frac{8}{9})(1)(0) + (\\frac{5}{9})(1)(3\\sqrt{\\frac{3}{5}}) = 0$.\nBy symmetry, $K_{21} = K_{12} = 0$. The stiffness matrix is:\n$$\nK = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 6 \\end{pmatrix}\n$$\n\nNow we form the matrix $A = M^{-1}K$. First, we find the inverse of the diagonal matrix $M$:\n$$\nM^{-1} = \\begin{pmatrix} 2^{-1} & 0 & 0 \\\\ 0 & (\\frac{2}{3})^{-1} & 0 \\\\ 0 & 0 & (\\frac{2}{5})^{-1} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{3}{2} & 0 \\\\ 0 & 0 & \\frac{5}{2} \\end{pmatrix}\n$$\nThen, we compute the product $A = M^{-1}K$:\n$$\nA = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & \\frac{3}{2} & 0 \\\\ 0 & 0 & \\frac{5}{2} \\end{pmatrix} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 6 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\cdot 0 & 0 & 0 \\\\ 0 & \\frac{3}{2} \\cdot 2 & 0 \\\\ 0 & 0 & \\frac{5}{2} \\cdot 6 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 15 \\end{pmatrix}\n$$\nThe final step is to determine the spectral radius $\\rho(A)$. The eigenvalues of a diagonal matrix are its diagonal entries. The eigenvalues of $A$ are $\\lambda_1=0$, $\\lambda_2=3$, and $\\lambda_3=15$.\nThe spectral radius is the maximum of the absolute values of the eigenvalues:\n$$\n\\rho(A) = \\max(|\\lambda_1|, |\\lambda_2|, |\\lambda_3|) = \\max(|0|, |3|, |15|) = 15\n$$\nThe spectral radius is an exact number as required.",
            "answer": "$$\\boxed{15}$$"
        },
        {
            "introduction": "In DG methods, the solution within an element can be represented in multiple ways, most commonly using a modal basis (coefficients of orthogonal polynomials) or a nodal basis (values at specific points). This practice explores the critical link between these two representations by constructing the transformation matrix that maps modal coefficients to nodal values. Analyzing the conditioning of this matrix provides vital insight into the numerical stability of your scheme, a crucial consideration for robust and accurate simulations. ",
            "id": "3295158",
            "problem": "Consider one spatial reference element $[-1,1]$ in a Discontinuous Galerkin (DG) discretization of a one-dimensional scalar conservation law. Let the modal basis on $[-1,1]$ be the first $k+1$ Legendre polynomials $\\{P_{0}(x),P_{1}(x),\\dots,P_{k}(x)\\}$, where $P_{m}(x)$ denotes the classical Legendre polynomial of degree $m$ on $[-1,1]$ (normalized such that $P_{0}(x)=1$, $P_{1}(x)=x$, and $P_{2}(x)=(3x^{2}-1)/2$). The nodal set is taken as the Gauss–Lobatto quadrature nodes on $[-1,1]$, defined by including the endpoints and the interior nodes given by the roots of $P_{k}'(x)$.\n\nWork with polynomial degree $k=2$, so that there are $k+1=3$ Gauss–Lobatto nodes. Starting from the definitions above, do the following:\n\n- Construct the Lagrange nodal basis $\\{\\ell_{i}(x)\\}_{i=1}^{3}$ associated with these $k+1$ nodes on $[-1,1]$, ensuring that $\\ell_{i}(x_{j})=\\delta_{ij}$.\n- Define and compute the interpolation matrix $V\\in\\mathbb{R}^{3\\times 3}$ whose $(i,j)$ entry is $V_{ij}=P_{j-1}(x_{i})$, mapping modal Legendre coefficients $(a_{0},a_{1},a_{2})$ to nodal values $(u(x_{1}),u(x_{2}),u(x_{3}))$ by $u(x_{i})=\\sum_{m=0}^{2}a_{m}P_{m}(x_{i})$.\n- Using first principles, verify the invertibility of $V$ and analyze its conditioning in the Euclidean two-norm.\n\nYour final task is to provide the exact two-norm condition number of the interpolation matrix $V$ as a single closed-form analytic expression. No rounding is required; give the exact expression with radicals if they arise.",
            "solution": "The problem statement is internally consistent, mathematically well-posed, and grounded in the standard theory of numerical methods for partial differential equations, specifically the Discontinuous Galerkin (DG) method. All definitions, parameters, and constants are provided, allowing for a direct and unambiguous solution pathway. The problem is therefore deemed valid.\n\nThe solution proceeds in several steps: first, we determine the required Gauss–Lobatto nodes for the specified polynomial degree. Second, we construct the requested Lagrange basis polynomials for completeness. Third, we assemble the interpolation matrix $V$. Finally, we analyze the properties of $V$, including its invertibility and its two-norm condition number, which is the primary objective.\n\n**Step 1: Determine the Gauss–Lobatto Nodes**\nThe problem specifies a polynomial degree of $k=2$. The Gauss–Lobatto nodes on the reference interval $[-1, 1]$ consist of the endpoints, $x=-1$ and $x=1$, and the interior roots of the derivative of the Legendre polynomial of degree $k=2$, which is $P_{2}'(x)$.\n\nThe Legendre polynomial of degree $2$ is given as $P_{2}(x) = \\frac{1}{2}(3x^{2}-1)$.\nIts derivative is:\n$$\nP_{2}'(x) = \\frac{d}{dx}\\left(\\frac{1}{2}(3x^{2}-1)\\right) = \\frac{1}{2}(6x) = 3x\n$$\nThe root of $P_{2}'(x)=0$ is found by solving $3x=0$, which yields $x=0$.\nTherefore, the set of three ($k+1=3$) Gauss–Lobatto nodes, ordered from smallest to largest, is:\n$$\nx_{1} = -1, \\quad x_{2} = 0, \\quad x_{3} = 1\n$$\n\n**Step 2: Construct the Lagrange Nodal Basis**\nThe Lagrange basis polynomials $\\{\\ell_{i}(x)\\}_{i=1}^{3}$ are polynomials of degree at most $k=2$ that satisfy the property $\\ell_{i}(x_{j}) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nFor $\\ell_{1}(x)$: It must be zero at $x_{2}=0$ and $x_{3}=1$, and equal to $1$ at $x_{1}=-1$.\n$$\n\\ell_{1}(x) = C_1(x-x_{2})(x-x_{3}) = \\frac{(x-0)(x-1)}{(-1-0)(-1-1)} = \\frac{x(x-1)}{2} = \\frac{1}{2}x^{2} - \\frac{1}{2}x\n$$\n\nFor $\\ell_{2}(x)$: It must be zero at $x_{1}=-1$ and $x_{3}=1$, and equal to $1$ at $x_{2}=0$.\n$$\n\\ell_{2}(x) = C_2(x-x_{1})(x-x_{3}) = \\frac{(x-(-1))(x-1)}{(0-(-1))(0-1)} = \\frac{(x+1)(x-1)}{-1} = 1 - x^{2}\n$$\n\nFor $\\ell_{3}(x)$: It must be zero at $x_{1}=-1$ and $x_{2}=0$, and equal to $1$ at $x_{3}=1$.\n$$\n\\ell_{3}(x) = C_3(x-x_{1})(x-x_{2}) = \\frac{(x-(-1))(x-0)}{(1-(-1))(1-0)} = \\frac{x(x+1)}{2} = \\frac{1}{2}x^{2} + \\frac{1}{2}x\n$$\nThe constructed Lagrange basis is $\\{\\frac{1}{2}(x^{2}-x), 1-x^{2}, \\frac{1}{2}(x^{2}+x)\\}$.\n\n**Step 3: Compute the Interpolation Matrix V**\nThe interpolation matrix $V \\in \\mathbb{R}^{3\\times 3}$ is defined by its entries $V_{ij} = P_{j-1}(x_{i})$, for $i,j \\in \\{1,2,3\\}$. The modal basis functions are the first three Legendre polynomials:\n$P_{0}(x) = 1$\n$P_{1}(x) = x$\n$P_{2}(x) = \\frac{1}{2}(3x^{2}-1)$\n\nWe evaluate these polynomials at the nodes $x_{1}=-1$, $x_{2}=0$, and $x_{3}=1$.\n\nFor the first row ($i=1$, $x_{1}=-1$):\n$V_{11} = P_{0}(-1) = 1$\n$V_{12} = P_{1}(-1) = -1$\n$V_{13} = P_{2}(-1) = \\frac{1}{2}(3(-1)^{2}-1) = \\frac{1}{2}(3-1) = 1$\n\nFor the second row ($i=2$, $x_{2}=0$):\n$V_{21} = P_{0}(0) = 1$\n$V_{22} = P_{1}(0) = 0$\n$V_{23} = P_{2}(0) = \\frac{1}{2}(3(0)^{2}-1) = -\\frac{1}{2}$\n\nFor the third row ($i=3$, $x_{3}=1$):\n$V_{31} = P_{0}(1) = 1$\n$V_{32} = P_{1}(1) = 1$\n$V_{33} = P_{2}(1) = \\frac{1}{2}(3(1)^{2}-1) = \\frac{1}{2}(3-1) = 1$\n\nAssembling these values gives the matrix $V$:\n$$\nV = \\begin{pmatrix} 1 & -1 & 1 \\\\ 1 & 0 & -\\frac{1}{2} \\\\ 1 & 1 & 1 \\end{pmatrix}\n$$\n\n**Step 4: Verify Invertibility and Compute the Condition Number**\nTo verify invertibility, we can compute the determinant of $V$.\n$$\n\\det(V) = 1\\left(0(1) - 1\\left(-\\frac{1}{2}\\right)\\right) - (-1)\\left(1(1) - 1\\left(-\\frac{1}{2}\\right)\\right) + 1\\left(1(1) - 1(0)\\right)\n$$\n$$\n\\det(V) = 1\\left(\\frac{1}{2}\\right) + 1\\left(1+\\frac{1}{2}\\right) + 1(1) = \\frac{1}{2} + \\frac{3}{2} + 1 = \\frac{4}{2} + 1 = 2 + 1 = 3\n$$\nSince $\\det(V) = 3 \\neq 0$, the matrix $V$ is invertible.\n\nThe two-norm condition number of $V$, denoted $\\kappa_{2}(V)$, is the ratio of its largest singular value ($\\sigma_{\\max}$) to its smallest singular value ($\\sigma_{\\min}$): $\\kappa_{2}(V) = \\sigma_{\\max}(V) / \\sigma_{\\min}(V)$. The singular values of $V$ are the square roots of the eigenvalues of the matrix $V^{T}V$.\n\nFirst, we compute $V^{T}V$:\n$$\nV^{T} = \\begin{pmatrix} 1 & 1 & 1 \\\\ -1 & 0 & 1 \\\\ 1 & -\\frac{1}{2} & 1 \\end{pmatrix}\n$$\n$$\nV^{T}V = \\begin{pmatrix} 1 & 1 & 1 \\\\ -1 & 0 & 1 \\\\ 1 & -\\frac{1}{2} & 1 \\end{pmatrix} \\begin{pmatrix} 1 & -1 & 1 \\\\ 1 & 0 & -\\frac{1}{2} \\\\ 1 & 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 3 & 0 & \\frac{3}{2} \\\\ 0 & 2 & 0 \\\\ \\frac{3}{2} & 0 & \\frac{9}{4} \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ of $V^{T}V$ are the roots of the characteristic equation $\\det(V^{T}V - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix} 3-\\lambda & 0 & \\frac{3}{2} \\\\ 0 & 2-\\lambda & 0 \\\\ \\frac{3}{2} & 0 & \\frac{9}{4}-\\lambda \\end{pmatrix} = (2-\\lambda) \\left[ (3-\\lambda)\\left(\\frac{9}{4}-\\lambda\\right) - \\left(\\frac{3}{2}\\right)^{2} \\right] = 0\n$$\nThis immediately gives one eigenvalue $\\lambda_1 = 2$. The other two eigenvalues are the roots of the expression in the brackets:\n$$\n(3-\\lambda)\\left(\\frac{9}{4}-\\lambda\\right) - \\frac{9}{4} = 0\n$$\n$$\n\\frac{27}{4} - 3\\lambda - \\frac{9}{4}\\lambda + \\lambda^{2} - \\frac{9}{4} = 0\n$$\n$$\n\\lambda^{2} - \\left(3+\\frac{9}{4}\\right)\\lambda + \\left(\\frac{27}{4} - \\frac{9}{4}\\right) = 0\n$$\n$$\n\\lambda^{2} - \\frac{21}{4}\\lambda + \\frac{18}{4} = 0 \\implies 4\\lambda^{2} - 21\\lambda + 18 = 0\n$$\nUsing the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$:\n$$\n\\lambda = \\frac{21 \\pm \\sqrt{(-21)^{2} - 4(4)(18)}}{2(4)} = \\frac{21 \\pm \\sqrt{441 - 288}}{8} = \\frac{21 \\pm \\sqrt{153}}{8}\n$$\nSince $153 = 9 \\times 17$, we have $\\sqrt{153} = 3\\sqrt{17}$. The other two eigenvalues are:\n$$\n\\lambda_{2} = \\frac{21 + 3\\sqrt{17}}{8} \\quad \\text{and} \\quad \\lambda_{3} = \\frac{21 - 3\\sqrt{17}}{8}\n$$\nThe eigenvalues of $V^{T}V$ are $\\{2, \\frac{21+3\\sqrt{17}}{8}, \\frac{21-3\\sqrt{17}}{8}\\}$. We check their approximate values: $\\sqrt{17} \\approx 4.123$, so $\\lambda_2 \\approx \\frac{21+12.369}{8} \\approx 4.17$ and $\\lambda_3 \\approx \\frac{21-12.369}{8} \\approx 1.08$. Thus, the maximum and minimum eigenvalues are:\n$$\n\\lambda_{\\max} = \\frac{21 + 3\\sqrt{17}}{8} \\quad \\text{and} \\quad \\lambda_{\\min} = \\frac{21 - 3\\sqrt{17}}{8}\n$$\nThe condition number is the ratio of the square roots of these eigenvalues:\n$$\n\\kappa_{2}(V) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}} = \\sqrt{\\frac{\\frac{21 + 3\\sqrt{17}}{8}}{\\frac{21 - 3\\sqrt{17}}{8}}} = \\sqrt{\\frac{21 + 3\\sqrt{17}}{21 - 3\\sqrt{17}}}\n$$\nWe simplify the expression by factoring out $3$ from the numerator and denominator:\n$$\n\\kappa_{2}(V) = \\sqrt{\\frac{7 + \\sqrt{17}}{7 - \\sqrt{17}}}\n$$\nTo rationalize the expression inside the square root, we multiply the numerator and denominator by the conjugate of the denominator:\n$$\n\\kappa_{2}(V) = \\sqrt{\\frac{7 + \\sqrt{17}}{7 - \\sqrt{17}} \\cdot \\frac{7 + \\sqrt{17}}{7 + \\sqrt{17}}} = \\sqrt{\\frac{(7 + \\sqrt{17})^{2}}{7^{2} - (\\sqrt{17})^{2}}} = \\sqrt{\\frac{(7 + \\sqrt{17})^{2}}{49 - 17}} = \\sqrt{\\frac{(7 + \\sqrt{17})^{2}}{32}}\n$$\nTaking the square root gives:\n$$\n\\kappa_{2}(V) = \\frac{7 + \\sqrt{17}}{\\sqrt{32}} = \\frac{7 + \\sqrt{17}}{4\\sqrt{2}}\n$$\nFinally, rationalizing the denominator of the overall expression:\n$$\n\\kappa_{2}(V) = \\frac{(7 + \\sqrt{17})\\sqrt{2}}{4\\sqrt{2}\\sqrt{2}} = \\frac{7\\sqrt{2} + \\sqrt{34}}{8}\n$$\nThis is the exact, closed-form analytic expression for the two-norm condition number of the matrix $V$.",
            "answer": "$$\n\\boxed{\\frac{7\\sqrt{2} + \\sqrt{34}}{8}}\n$$"
        },
        {
            "introduction": "Moving from linear advection to complex non-linear systems like the Euler equations reveals subtle but critical challenges in designing high-order schemes. This practice confronts one such challenge: the choice of variables for polynomial reconstruction. By comparing reconstructions in conservative versus primitive variables for a multi-species gas, you will directly observe how this choice impacts the generation of non-physical oscillations at contact discontinuities, providing a powerful lesson on ensuring your numerical method respects the underlying physics. ",
            "id": "3295126",
            "problem": "Consider the one-dimensional compressible Euler equations for a variable thermodynamic gas that models a two-species mixture under mechanical and thermal equilibrium. The conservative state vector is denoted by $\\mathbf{U} = [\\rho, \\rho u, \\rho E, \\rho s]^\\top$, where $\\rho$ is the density in $\\mathrm{kg/m^3}$, $u$ is the velocity in $\\mathrm{m/s}$, $E$ is the total energy per unit mass in $\\mathrm{J/kg}$, and $s \\in [0,1]$ is a passive scalar representing the local mixture composition (with $s=0$ corresponding to species $1$ and $s=1$ to species $2$). The flux is $\\mathbf{F}(\\mathbf{U}) = [\\rho u, \\rho u^2 + p, u(\\rho E + p), \\rho s u]^\\top$. The pressure $p$ is closed by an ideal-gas-like equation of state with composition-dependent ratio of specific heats $\\gamma(s)$ and gas constant $R(s)$, namely $p = (\\gamma(s) - 1)\\rho e$, where $e$ is the internal energy. The sound speed is $c = \\sqrt{\\gamma(s)p/\\rho}$. For a given temperature $T$ in $\\mathrm{K}$, the density can be recovered from the ideal-gas relation $\\rho = p/(R(s) T)$. Assume species parameters $\\gamma_1$, $R_1$ and $\\gamma_2$, $R_2$ are known and define linear mixture laws $\\gamma(s) = (1-s)\\gamma_1 + s \\gamma_2$ and $R(s) = (1-s)R_1 + s R_2$.\n\nA single interior interface at $x=0$ separates two cells: a left cell spanning $x \\in [-\\Delta x, 0]$ with center $x_c^{(L)} = -\\Delta x/2$, and a right cell spanning $x \\in [0, \\Delta x]$ with center $x_c^{(R)} = +\\Delta x/2$. Consider a Discontinuous Galerkin (DG) polynomial basis of degree one (piecewise linear) on each cell, that is, for any field $q(x)$ we approximate in each cell by $q_h(x) = a + b (x - x_c)$ where $a$ and $b$ are the local degrees of freedom. For a given exact field $q(x)$, the $L^2$ best-fit $P^1$ coefficients $(a,b)$ on a cell of width $\\Delta x$ are determined by minimizing $\\int_{\\text{cell}} (q_h(x) - q(x))^2 \\, dx$, which yields the normal equations stating that the average of the residual and the first moment of the residual vanish. For a symmetric cell, the average of $(x - x_c)$ is zero, so $a$ equals the cell average of $q$ and $b$ equals the cell-average of $q(x)(x-x_c)$ divided by the cell-average of $(x-x_c)^2$.\n\nDefine two basis-dependent reconstructions at the interface:\n- Conservative-basis reconstruction: First $L^2$-project the exact conservative fields $\\mathbf{U}(x)$ component-wise onto $P^1$ on each cell to obtain $\\mathbf{U}_h^{(L)}(x)$ and $\\mathbf{U}_h^{(R)}(x)$, then evaluate left and right interface traces $\\mathbf{U}_L = \\mathbf{U}_h^{(L)}(0^{-})$ and $\\mathbf{U}_R = \\mathbf{U}_h^{(R)}(0^{+})$. Convert each to primitive variables to obtain the interface pressures $p_L$ and $p_R$.\n- Primitive-basis reconstruction: First $L^2$-project the exact primitive fields $\\mathbf{W}(x) = [\\rho(x), u(x), p(x), s(x)]^\\top$ component-wise onto $P^1$ on each cell to obtain $\\mathbf{W}_h^{(L)}(x)$ and $\\mathbf{W}_h^{(R)}(x)$, then evaluate left and right interface traces $\\mathbf{W}_L = \\mathbf{W}_h^{(L)}(0^{-})$ and $\\mathbf{W}_R = \\mathbf{W}_h^{(R)}(0^{+})$, and convert each to conservative variables $\\mathbf{U}_L$ and $\\mathbf{U}_R$.\n\nDefine the Rusanov (local Lax–Friedrichs) numerical flux at the interface by\n$$\n\\mathbf{F}^* = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_L) + \\mathbf{F}(\\mathbf{U}_R)\\right) - \\frac{1}{2} a_{\\max} \\left(\\mathbf{U}_R - \\mathbf{U}_L\\right),\n$$\nwhere $a_{\\max} = \\max\\{ |u_L| + c_L,\\; |u_R| + c_R \\}$ and $c = \\sqrt{\\gamma(s)p/\\rho}$.\n\nYour task is to develop an interface flux for this setting and quantify spurious pressure oscillations at a pressure-equilibrium contact advected by a DG representation. Assume the exact primitive fields in each cell satisfy constant pressure and velocity and constant temperature, with a linearly varying composition:\n- $p(x) \\equiv p_0$ in $\\mathrm{Pa}$,\n- $u(x) \\equiv u_0$ in $\\mathrm{m/s}$,\n- $T(x) \\equiv T_0$ in $\\mathrm{K}$,\n- $s(x) = s_c + \\sigma (x - x_c)$ with $s_c$ the cell-center composition and $\\sigma$ the cell slope, both dimensionless.\n\nFrom these primitives, define $\\rho(x) = p_0 / (R(s(x)) T_0)$ and $E(x) = e(x) + \\tfrac{1}{2} u_0^2$ with $e(x) = p_0 / ((\\gamma(s(x)) - 1)\\rho(x))$, and thus $\\mathbf{U}(x) = [\\rho(x), \\rho(x) u_0, \\rho(x) E(x), \\rho(x) s(x)]^\\top$.\n\nFor the interface at $x=0$, implement:\n- The conservative-basis reconstruction to obtain $\\mathbf{U}_L,\\mathbf{U}_R$, compute $p_L$ and $p_R$ from these traces, and measure the spurious pressure oscillation magnitude $\\Delta p_{\\mathrm{cons}} = |p_R - p_L|$ in $\\mathrm{Pa}$.\n- The primitive-basis reconstruction to obtain $\\mathbf{W}_L,\\mathbf{W}_R$ and thus $\\mathbf{U}_L,\\mathbf{U}_R$, compute $p_L$ and $p_R$ and measure $\\Delta p_{\\mathrm{prim}} = |p_R - p_L|$ in $\\mathrm{Pa}$.\n- Construct $\\mathbf{F}^*$ by the Rusanov formula for each reconstruction (this confirms the interface flux is well-defined and computable).\n\nAssume species parameters are fixed at $\\gamma_1 = 1.4$, $R_1 = 287$ $\\mathrm{J/(kg \\cdot K)}$, $\\gamma_2 = 1.67$, $R_2 = 207$ $\\mathrm{J/(kg \\cdot K)}$. Let the cell width be $\\Delta x = 1$ $\\mathrm{m}$. Use the $L^2$ projection formulas to determine the degree-one coefficients on each cell for both representations. All composition values $s$ must be treated as dimensionless and, for evaluating $\\gamma(s)$ and $R(s)$, clipped to the interval $[0,1]$.\n\nTest Suite. For each test case, you are given $(p_0, u_0, T_0)$ and left/right $(s_c, \\sigma)$ pairs defining $s(x)$ on the left and right cells. Use the following four test cases (all units are specified):\n- Case $1$: $p_0 = 10^5$ $\\mathrm{Pa}$, $u_0 = 50$ $\\mathrm{m/s}$, $T_0 = 300$ $\\mathrm{K}$; left $(s_c^{(L)}, \\sigma^{(L)}) = (0.35, 0.30)$, right $(s_c^{(R)}, \\sigma^{(R)}) = (0.70, -0.40)$.\n- Case $2$: $p_0 = 10^5$ $\\mathrm{Pa}$, $u_0 = 0$ $\\mathrm{m/s}$, $T_0 = 300$ $\\mathrm{K}$; left $(s_c^{(L)}, \\sigma^{(L)}) = (0.30, 0.40)$, right $(s_c^{(R)}, \\sigma^{(R)}) = (0.75, -0.30)$.\n- Case $3$: $p_0 = 10^5$ $\\mathrm{Pa}$, $u_0 = 0$ $\\mathrm{m/s}$, $T_0 = 300$ $\\mathrm{K}$; left $(s_c^{(L)}, \\sigma^{(L)}) = (0.30, 0.00)$, right $(s_c^{(R)}, \\sigma^{(R)}) = (0.70, 0.00)$.\n- Case $4$: $p_0 = 10^5$ $\\mathrm{Pa}$, $u_0 = 600$ $\\mathrm{m/s}$, $T_0 = 300$ $\\mathrm{K}$; left $(s_c^{(L)}, \\sigma^{(L)}) = (0.25, 0.50)$, right $(s_c^{(R)}, \\sigma^{(R)}) = (0.75, -0.50)$.\n\nRequired Output. For each case, compute and return the pair $(\\Delta p_{\\mathrm{cons}}, \\Delta p_{\\mathrm{prim}})$ as two floating-point numbers in $\\mathrm{Pa}$. Aggregate the results across all cases as a single list in the order $[\\Delta p_{\\mathrm{cons}}^{(1)}, \\Delta p_{\\mathrm{prim}}^{(1)}, \\Delta p_{\\mathrm{cons}}^{(2)}, \\Delta p_{\\mathrm{prim}}^{(2)}, \\Delta p_{\\mathrm{cons}}^{(3)}, \\Delta p_{\\mathrm{prim}}^{(3)}, \\Delta p_{\\mathrm{cons}}^{(4)}, \\Delta p_{\\mathrm{prim}}^{(4)}]$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots]$). All returned values must be in $\\mathrm{Pa}$ and printed as raw floating-point numbers without units attached.",
            "solution": "The analysis proceeds in two stages as mandated: problem validation followed by the derivation of the solution.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Governing Equations**: One-dimensional compressible Euler equations for a variable thermodynamic gas.\n- **State Vector (Conservative)**: $\\mathbf{U} = [\\rho, \\rho u, \\rho E, \\rho s]^\\top$.\n- **Flux Vector**: $\\mathbf{F}(\\mathbf{U}) = [\\rho u, \\rho u^2 + p, u(\\rho E + p), \\rho s u]^\\top$.\n- **Variables**: $\\rho$ (density), $u$ (velocity), $E$ (total energy/mass), $s$ (passive scalar, $s\\in[0,1]$), $p$ (pressure), $e$ (internal energy/mass), $T$ (temperature).\n- **Equation of State**: $p = (\\gamma(s) - 1)\\rho e$, where $E = e + \\frac{1}{2}u^2$.\n- **Ideal Gas Relation**: $\\rho = p/(R(s) T)$.\n- **Sound Speed**: $c = \\sqrt{\\gamma(s)p/\\rho}$.\n- **Mixture Laws**: $\\gamma(s) = (1-s)\\gamma_1 + s \\gamma_2$ and $R(s) = (1-s)R_1 + s R_2$.\n- **Species Parameters**: $\\gamma_1 = 1.4$, $R_1 = 287 \\, \\mathrm{J/(kg \\cdot K)}$; $\\gamma_2 = 1.67$, $R_2 = 207 \\, \\mathrm{J/(kg \\cdot K)}$.\n- **Clipping Rule**: For evaluating $\\gamma(s)$ and $R(s)$, any value of $s$ must be clipped to the interval $[0,1]$.\n- **Numerical Method**: Discontinuous Galerkin (DG) with piecewise linear polynomials ($P^1$) on each cell.\n- **Cell Geometry**: A left cell on $x \\in [-\\Delta x, 0]$ with center $x_c^{(L)} = -\\Delta x/2$ and a right cell on $x \\in [0, \\Delta x]$ with center $x_c^{(R)} = +\\Delta x/2$. Cell width is $\\Delta x=1 \\, \\mathrm{m}$.\n- **Basis Representation**: $q_h(x) = a + b (x-x_c)$ on each cell.\n- **$L^2$ Projection**: Coefficients $(a,b)$ are determined by $a = \\frac{1}{\\Delta x} \\int_{\\text{cell}} q(x) \\, dx$ and $b = \\frac{\\int q(x)(x-x_c)dx}{\\int (x-x_c)^2 dx}$.\n- **Reconstruction Methods**:\n    1.  **Conservative-basis**: Project $\\mathbf{U}(x)$ onto the $P^1$ basis to get $\\mathbf{U}_h(x)$, then evaluate at the interface $x=0$ to find $\\mathbf{U}_L, \\mathbf{U}_R$.\n    2.  **Primitive-basis**: Project $\\mathbf{W}(x) = [\\rho, u, p, s]^\\top$ onto the $P^1$ basis to get $\\mathbf{W}_h(x)$, then evaluate at $x=0$ to find $\\mathbf{W}_L, \\mathbf{W}_R$.\n- **Numerical Flux**: Rusanov flux, $\\mathbf{F}^* = \\frac{1}{2}\\left(\\mathbf{F}(\\mathbf{U}_L) + \\mathbf{F}(\\mathbf{U}_R)\\right) - \\frac{1}{2} a_{\\max} \\left(\\mathbf{U}_R - \\mathbf{U}_L\\right)$, with $a_{\\max} = \\max\\{ |u_L| + c_L,\\; |u_R| + c_R \\}$.\n- **Exact Solution Form**: For each cell, $p(x) \\equiv p_0$, $u(x) \\equiv u_0$, $T(x) \\equiv T_0$, and $s(x) = s_c + \\sigma (x - x_c)$. The conservative variables $\\rho(x)$ and $E(x)$ are derived from these primitive fields.\n- **Task**: For both reconstruction methods, compute the spurious pressure difference $\\Delta p = |p_R - p_L|$ at the interface $x=0$.\n- **Test Cases**: Four sets of parameters are provided: $(p_0, u_0, T_0, (s_c^{(L)}, \\sigma^{(L)}), (s_c^{(R)}, \\sigma^{(R)}))$.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientific Grounding**: The problem is well-grounded in computational fluid dynamics. The compressible Euler equations, variable-gamma gas models, Discontinuous Galerkin methods, $L^2$ projection, and Rusanov fluxes are all standard concepts and tools in this field. The study of spurious oscillations at contact discontinuities is a classical and important topic in the development of numerical schemes for conservation laws.\n- **Well-Posedness**: The problem is well-posed. It provides a complete set of initial data, physical parameters, and a deterministic set of instructions for calculation. A unique numerical result can be obtained for each test case.\n- **Objectivity**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective claims.\n- **Completeness and Consistency**: All necessary data ($\\gamma_i, R_i, \\Delta x$, test case parameters) and definitions (equations of state, basis functions, projection formulas) are explicitly provided. The relationships between variables are self-consistent. The setup describes a contact discontinuity, which is a valid solution to the Euler equations, characterized by jumps in density and other thermodynamic properties but continuity of pressure and velocity.\n\n**Step 3: Verdict and Action**\n\nThe problem is scientifically valid, well-posed, and self-contained. Therefore, a solution will be provided.\n\n### Solution Derivation\n\nThe core of the problem is to compare two different reconstruction strategies within a Discontinuous Galerkin framework for a specific flow configuration: a contact discontinuity where pressure and velocity are constant, but composition and density vary.\n\n**1. Preliminaries: State Variables and $L^2$ Projection**\n\nThe conservative state is $\\mathbf{U} = [\\rho, \\rho u, \\rho E, \\rho s]^\\top$. The primitive state is $\\mathbf{W} = [\\rho, u, p, s]^\\top$. The pressure $p$ is derived from the conservative state via:\n$$\np = (\\gamma(s) - 1) (\\rho E - \\frac{1}{2}\\rho u^2) = (\\gamma(s) - 1) \\left( U_3 - \\frac{U_2^2}{2U_1} \\right)\n$$\nwhere $s = U_4/U_1$ must be clipped to $[0,1]$ before being used in the mixture law $\\gamma(s) = (1-s)\\gamma_1 + s\\gamma_2$.\n\nThe $P^1$ approximation of a function $q(x)$ on a cell of width $\\Delta x$ centered at $x_c$ is $q_h(x) = a + b(x-x_c)$. The coefficients $(a,b)$ are found via $L^2$ projection:\n$$\na = \\frac{1}{\\Delta x} \\int_{x_c - \\Delta x/2}^{x_c + \\Delta x/2} q(x) \\, dx \\quad , \\quad b = \\frac{\\int_{x_c - \\Delta x/2}^{x_c + \\Delta x/2} q(x)(x-x_c) \\, dx}{\\int_{x_c - \\Delta x/2}^{x_c + \\Delta x/2} (x-x_c)^2 \\, dx}\n$$\nThe denominator for $b$ simplifies to $\\frac{(\\Delta x)^3}{12}$, thus $b = \\frac{12}{(\\Delta x)^3} \\int q(x)(x-x_c) \\, dx$. For computations, it is convenient to use a local coordinate $\\xi = x-x_c$, which spans $[-\\Delta x/2, \\Delta x/2]$.\n\nInterface values at $x=0$ are evaluated from the reconstructions on the left cell ($x_c^{(L)}=-\\Delta x/2$) and right cell ($x_c^{(R)}=+\\Delta x/2$).\nThe local coordinate at the interface for the left cell is $\\xi^{(L)} = 0 - x_c^{(L)} = +\\Delta x/2$.\nThe local coordinate at the interface for the right cell is $\\xi^{(R)} = 0 - x_c^{(R)} = -\\Delta x/2$.\nThus, the interface traces are:\n$$\nq_L = a^{(L)} + b^{(L)} \\frac{\\Delta x}{2} \\quad , \\quad q_R = a^{(R)} - b^{(R)} \\frac{\\Delta x}{2}\n$$\n\n**2. Exact Field Specification**\n\nThe problem defines an exact field with constant pressure $p_0$, velocity $u_0$, and temperature $T_0$, but with a spatially varying composition $s(x) = s_c + \\sigma(x-x_c)$. From these, the other exact fields are derived:\n- $\\gamma(x) = \\gamma(s(x))$\n- $R(x) = R(s(x))$\n- $\\rho(x) = \\frac{p_0}{R(x) T_0}$\n- $e(x) = \\frac{p_0}{(\\gamma(x)-1)\\rho(x)} = \\frac{R(x) T_0}{\\gamma(x)-1}$\n- $E(x) = e(x) + \\frac{1}{2}u_0^2$\n\n**3. Conservative-Basis Reconstruction**\n\nIn this approach, we project each component of the conservative vector $\\mathbf{U}(x) = [\\rho(x), \\rho(x) u_0, \\rho(x) E(x), \\rho(x) s(x)]^\\top$ onto the $P^1$ basis. Since $s(x)$ is linear, the functions $R(x)$ and $\\gamma(x)$ are also linear. However, $\\rho(x)$ is a reciprocal of a linear function, and $e(x)$ is a ratio of linear functions. Consequently, the components of $\\mathbf{U}(x)$ are non-linear functions of $x$.\n\nFor each cell (Left and Right) and each conservative component $U_i(x)$, we must compute the coefficients $(a_i, b_i)$ by performing numerical integration (e.g., using `scipy.integrate.quad`) for the $L^2$ projection formulas.\n\nOnce the coefficients $\\{a_i^{(L)}, b_i^{(L)}\\}_{i=1}^4$ and $\\{a_i^{(R)}, b_i^{(R)}\\}_{i=1}^4$ are found, the conservative states at the interface are reconstructed:\n$$\n\\mathbf{U}_L = \\begin{bmatrix} a_1^{(L)} + b_1^{(L)} \\frac{\\Delta x}{2} \\\\ \\vdots \\\\ a_4^{(L)} + b_4^{(L)} \\frac{\\Delta x}{2} \\end{bmatrix} \\quad , \\quad \\mathbf{U}_R = \\begin{bmatrix} a_1^{(R)} - b_1^{(R)} \\frac{\\Delta x}{2} \\\\ \\vdots \\\\ a_4^{(R)} - b_4^{(R)} \\frac{\\Delta x}{2} \\end{bmatrix}\n$$\nFrom these vectors $\\mathbf{U}_L$ and $\\mathbf{U}_R$, we recover the interface pressures $p_L$ and $p_R$ using the formula $p = (\\gamma(s)-1)(U_3 - U_2^2/(2U_1))$. Since the projection and reconstruction process does not, in general, commute with the non-linear conversion from conservative to primitive variables, the resulting pressures $p_L$ and $p_R$ will not be equal to the exact pressure $p_0$. The magnitude of this spurious pressure oscillation is $\\Delta p_{\\mathrm{cons}} = |p_R - p_L|$. This value is expected to be non-zero when composition gradients exist ($\\sigma \\ne 0$).\n\n**4. Primitive-Basis Reconstruction**\n\nThis approach involves projecting the primitive variables $\\mathbf{W}(x) = [\\rho(x), u(x), p(x), s(x)]^\\top$. The specified exact field has $p(x) = p_0$ and $u(x) = u_0$, which are constant. The $L^2$ projection of a constant function $C$ onto a $P^1$ basis results in the exact coefficients $(a=C, b=0)$.\nTherefore:\n- For $p(x)=p_0$, the coefficients are $(a_p, b_p) = (p_0, 0)$.\n- For $u(x)=u_0$, the coefficients are $(a_u, b_u) = (u_0, 0)$.\n\nThe reconstructed pressure fields on the left and right cells are simply $p_h^{(L)}(x) = p_0$ and $p_h^{(R)}(x) = p_0$. Evaluating these at the interface gives:\n$$\np_L = p_h^{(L)}(0) = p_0 \\quad , \\quad p_R = p_h^{(R)}(0) = p_0\n$$\nConsequently, the spurious pressure oscillation is zero:\n$$\n\\Delta p_{\\mathrm{prim}} = |p_R - p_L| = |p_0 - p_0| = 0\n$$\nThis result holds for all test cases, demonstrating a key advantage of primitive-variable reconstruction for resolving contact discontinuities without generating numerical artifacts in pressure. The projections for $\\rho(x)$ and $s(x)$ would be non-trivial, but they are not needed to determine the interface pressures.\n\nThe task is thus reduced to numerically computing $\\Delta p_{\\mathrm{cons}}$ for each test case and reporting $\\Delta p_{\\mathrm{prim}} = 0$.\nA special case occurs when $\\sigma=0$ (e.g., Test Case 3). Here, the exact state is piecewise constant. The $L^2$ projection is exact for all variables (conservative and primitive), yielding coefficients $(a=C, b=0)$. Thus, for this case, $\\Delta p_{\\mathrm{cons}}$ will also be zero. With these ingredients, the numerical flux $\\mathbf{F}^*$ can be readily computed, confirming the procedure is well-defined, though its value is not required for the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes spurious pressure oscillations at a contact discontinuity for a two-species gas\n    using a P1 Discontinuous Galerkin method. It compares conservative-basis and \n    primitive-basis reconstructions.\n    \"\"\"\n    # Species parameters\n    g1, r1 = 1.4, 287.0\n    g2, r2 = 1.67, 207.0\n    \n    # Cell width\n    dx = 1.0\n\n    # Test cases: (p0, u0, T0, (sc_L, sigma_L), (sc_R, sigma_R))\n    test_cases = [\n        (1e5, 50.0, 300.0, (0.35, 0.30), (0.70, -0.40)),\n        (1e5, 0.0, 300.0, (0.30, 0.40), (0.75, -0.30)),\n        (1e5, 0.0, 300.0, (0.30, 0.00), (0.70, 0.00)),\n        (1e5, 600.0, 300.0, (0.25, 0.50), (0.75, -0.50)),\n    ]\n\n    # --- Helper functions for mixture properties and exact fields ---\n\n    def clip_s(s):\n        return np.clip(s, 0.0, 1.0)\n\n    def gamma_from_s(s):\n        s_clipped = clip_s(s)\n        return (1.0 - s_clipped) * g1 + s_clipped * g2\n\n    def R_from_s(s):\n        s_clipped = clip_s(s)\n        return (1.0 - s_clipped) * r1 + s_clipped * r2\n\n    # --- L2 projection and pressure recovery ---\n\n    def project(func, *args):\n        \"\"\"\n        Performs an L2 projection of a function onto a P1 basis.\n        \"\"\"\n        # Coefficient a (cell average)\n        integrand_a = lambda xi: func(xi, *args)\n        integral_a = quad(integrand_a, -dx / 2.0, dx / 2.0)[0]\n        a = integral_a / dx\n        \n        # Coefficient b (slope)\n        integrand_b = lambda xi: func(xi, *args) * xi\n        integral_b = quad(integrand_b, -dx / 2.0, dx / 2.0)[0]\n        # Denominator is integral of (x-xc)^2, cell-averaged: (dx^2/12)\n        # b = avg(q*xi) / avg(xi^2) = (1/dx * int_b) / (dx^2/12) = 12/dx^3 * int_b\n        b = 12.0 / (dx**3) * integral_b\n        \n        return a, b\n\n    def get_pressure_from_U(U_vec):\n        \"\"\"\n        Recovers pressure from a vector of conservative variables.\n        \"\"\"\n        rho, rhou, rhoE, rhos = U_vec\n        if rho  1e-9: return 0.0\n        \n        s = rhos / rho\n        gamma = gamma_from_s(s)\n        pressure = (gamma - 1.0) * (rhoE - 0.5 * rhou**2 / rho)\n        return pressure\n\n    results = []\n    \n    for p0, u0, T0, (sc_L, sigma_L), (sc_R, sigma_R) in test_cases:\n        \n        # --- Conservative-Basis Reconstruction ---\n        \n        # Define the exact conservative fields as functions of local coordinate xi\n        def get_fields(sc, sigma):\n            def q1_rho(xi): # rho\n                s_val = sc + sigma * xi\n                return p0 / (T0 * R_from_s(s_val))\n            def q2_rhou(xi): # rho*u\n                return q1_rho(xi) * u0\n            def q3_rhoE(xi): # rho*E\n                s_val = sc + sigma * xi\n                rho_val = q1_rho(xi)\n                internal_energy = (R_from_s(s_val) * T0) / (gamma_from_s(s_val) - 1.0)\n                kinetic_energy = 0.5 * u0**2\n                return rho_val * (internal_energy + kinetic_energy)\n            def q4_rhos(xi): # rho*s\n                s_val = sc + sigma * xi # Use unclipped s for conserved quantity\n                return q1_rho(xi) * s_val\n            return [q1_rho, q2_rhou, q3_rhoE, q4_rhos]\n\n        # Project conservative fields for the left cell\n        U_coeffs_L = [project(f) for f in get_fields(sc_L, sigma_L)]\n        \n        # Project conservative fields for the right cell\n        U_coeffs_R = [project(f) for f in get_fields(sc_R, sigma_R)]\n\n        # Evaluate reconstructed conservative states at the interface (x=0)\n        # For left cell, local coordinate xi at x=0 is +dx/2\n        # For right cell, local coordinate xi at x=0 is -dx/2\n        U_L = np.array([a + b * (dx / 2.0) for a, b in U_coeffs_L])\n        U_R = np.array([a + b * (-dx / 2.0) for a, b in U_coeffs_R])\n        \n        # Recover pressures from reconstructed states\n        p_L_cons = get_pressure_from_U(U_L)\n        p_R_cons = get_pressure_from_U(U_R)\n        \n        # Spurious pressure difference for conservative reconstruction\n        dp_cons = abs(p_R_cons - p_L_cons)\n        \n        # --- Primitive-Basis Reconstruction ---\n        # As reasoned in the solution, the projection of the constant pressure field p(x)=p0\n        # is exact, resulting in reconstructed interface pressures equal to p0.\n        # Thus, the spurious pressure difference is zero.\n        dp_prim = 0.0\n        \n        results.extend([dp_cons, dp_prim])\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}