## 应用与跨学科连接

在前面的章节中，我们已经详细介绍了间断 Galerkin (DG) 方法的核心原理与机制，包括其[弱形式](@entry_id:142897)、[基函数](@entry_id:170178)表示以及[数值通量](@entry_id:752791)的构建。理论的价值在于应用。本章旨在展示这些基本原理如何在多样化、真实世界和跨学科的背景下得到应用、扩展和整合。我们将通过一系列面向应用的场景，探索 DG 方法在处理复杂物理问题、应对几何挑战、实现自适应计算以及与其他科学领域交叉融合方面的强大能力和灵活性。本章的目标不是重复讲授核心概念，而是展示它们在解决实际科学与工程问题中的效用，从而加深读者对 DG 方法作为一种先进计算工具的理解。

### [可压缩气体动力学](@entry_id:169361)中的高等数值通量设计

将 DG 方法应用于[可压缩气体动力学](@entry_id:169361)，如欧拉方程所描述的那样，是对数值通量设计提出的一个严峻考验。简单问题（如标量线性平流）的通量设计，在面对包含激波、接触间断和[稀疏波](@entry_id:168428)的复杂非线性系统时，其局限性便显露无遗。

一个经典且强大的通量是 Roe [近似黎曼求解器](@entry_id:267136)。它通过在界面两侧的状态之间构造一个线性化问题来实现，该线性化依赖于一组精心设计的“Roe 平均”[状态变量](@entry_id:138790)，如速度和焓。这种构造的精妙之处在于，它能精确满足跨越单个孤立间断的 Rankine-Hugoniot [跳跃条件](@entry_id:750965)，从而能够以极高的分辨率捕捉激波和接触间断。然而，Roe 通量的成功并非没有代价。一个众所周知的问题是，当特征速度（如 $u-a$）跨越界面从负变到正时（例如在[跨音速稀疏波](@entry_id:756129)中），Roe 格式可能会产生一个违反物理[熵条件](@entry_id:166346)的“膨胀激波”。这种数值假象的产生，是因为 Roe 格式的线性化本质无法捕捉波内部的[非线性](@entry_id:637147)结构。为了克服这一缺陷，必须引入“[熵修正](@entry_id:749021)”，例如通过 Harten-Hyman 修正在[声速点](@entry_id:755066)附近修改[波速](@entry_id:186208)，或在检测到熵违例的区域局部切换到更具[耗散性](@entry_id:162959)的通量，如局部 Lax-Friedrichs (Rusanov) 通量 。

近年来，为了从根本上解决[熵稳定性](@entry_id:749023)问题，研究人员发展了可证明熵稳定的 DG 格式。这些先进格式通常将一个保持[熵守恒](@entry_id:749018)的数值通量与一个在[熵变](@entry_id:138294)量下构造的[对称正定](@entry_id:145886)耗散矩阵相结合。[熵守恒通量](@entry_id:749013)确保数值离散本身不产生非物理的熵，而附加的耗散项则负责稳定地捕捉激波并保证熵增。当这些[熵稳定通量](@entry_id:749015)与满足[分部求和](@entry_id:185335)（Summation-by-Parts, SBP）性质的[求积法则](@entry_id:753909)，以及采用分裂形式（skew-symmetric form）离散的体积项相结合时，整个 DG 格式便能在全局半离散层面上满足[熵不等式](@entry_id:184404)，从而在理论上保证了格式的[非线性](@entry_id:637147)稳定性 。

除了[熵稳定性](@entry_id:749023)，在模拟[可压缩流体](@entry_id:164617)时，保持物理量的[正定性](@entry_id:149643)（如密度和压力为正）是另一个至关重要的实际挑战。不恰当的数值通量或时间步长可能导致计算出的状态变为非物理。解决这一问题的策略通常依赖于[基函数](@entry_id:170178)的选择和相应的限制器技术。例如，对于[模态基](@entry_id:752055)，可以在更新单元平均值后，通过一个“[正定性](@entry_id:149643)保持限制器”来缩放[高阶模](@entry_id:750331)态的系数，以确保在单元内的若干监测点上密度和压力均为正。对于[节点基](@entry_id:752522)，则可以采用一种子单元重构的有限体积方法，在更精细的[子网](@entry_id:156282)格上进行鲁棒的一阶更新，从而保证每个子单元状态的物理实在性。这些策略的成功与否，也与数值通量（如耗散性较强的 Rusanov 通量或更精确的 HLLC 通量）的选择密切相关 。

### [基函数](@entry_id:170178)表示在精度与稳定性中的作用

DG 方法的灵活性很大程度上源于其对单元内[局部基](@entry_id:151573)函数的自由选择。最常见的两类是[模态基](@entry_id:752055)（如勒让德多项式）和[节点基](@entry_id:752522)（如[高斯点](@entry_id:170251)上的[拉格朗日多项式](@entry_id:142463)）。这两种选择不仅在实现上有所不同，更对格式的精度、稳定性和[计算效率](@entry_id:270255)有着深远的影响。

一个核心区别在于它们如何处理[非线性](@entry_id:637147)项，如[欧拉方程](@entry_id:177914)中的[对流通量](@entry_id:158187)。当一个 $k$ 次多项式解通过一个[非线性](@entry_id:637147)函数时，其结果通常不再是 $k$ 次多项式，无法被原始基底精确表示。这种不匹配会产生“混淆误差”（aliasing error）。在[模态基](@entry_id:752055)框架下，通常通过将[非线性](@entry_id:637147)通量进行 $L^2$ 投影来近似，这是一种在积分意义下最优的逼近。而在[节点基](@entry_id:752522)框架下，则通常在节点上对通量进行插值。这两种不同的处理方式导致了截然不同的混淆误差特性。针对具体问题，如给定参数的[欧拉方程](@entry_id:177914)，可以构造特定的波形来最大化这两种基底表示策略所产生的混淆误差差异，从而深入理解其对解的影响 。

[基函数](@entry_id:170178)的选择及其伴随的求积法则，还对离散守恒律的性质产生微妙影响。以线性平流方程为例，使用[中心通量](@entry_id:747204)的 DG 格式在连续意义上是[能量守恒](@entry_id:140514)的。当使用一个标准正交的[模态基](@entry_id:752055)（如[标准化](@entry_id:637219)的[勒让德多项式](@entry_id:141510)）时，[质量矩阵](@entry_id:177093)是单位阵，离散能量直接对应于解的 $L^2$ 范数。该格式精确地保持了这个离散能量的守恒。然而，在[节点基](@entry_id:752522)（如 Gauss-Lobatto 点）的实现中，为了提高计算效率，通常采用“[质量集中](@entry_id:175432)”（mass lumping）技术，即将[质量矩阵](@entry_id:177093)近似为一个对角阵。在这种情况下，格式保持守恒的是一个基于求积点和权重的离散[能量范数](@entry_id:274966)。虽然这个离散能量也是守恒的，但它与精确的 $L^2$ 能量范数并不完全相同。通过计算一个非平凡初值（如二次勒让德多项式 $P_2(x)$）在这两种能量定义下的差值，可以清晰地揭示这种由求积近似带来的差异 。

此外，[基函数](@entry_id:170178)的选择不局限于标准多项式。为了更好地捕捉解的特定行为或适应复杂的几何边界，可以在多项式基底中加入“富化函数”。例如，可以加入一个在单元边界为零的“[气泡函数](@entry_id:176111)”（如三角函数）。这种富化基底的一个有趣特性是，如果待逼近的函数本身就在原始的多项式[子空间](@entry_id:150286)内，那么即使在富化基底下进行 $L^2$ 投影，其结果依然是精确的，投影误差为零。这表明富化技术可以在不损失对简单解的逼近能力的前提下，增强对复杂解的[表达能力](@entry_id:149863) 。

### 在复杂几何与网格上的应用

DG 方法最引人注目的优势之一是其处理复杂几何和非结构网格的卓越能力。这种能力源于其离散化完全在局部单元上进行，单元间的通信仅通过边界上的[数值通量](@entry_id:752791)完成。

当计算域包含曲线边界时，通常采用[曲线网格](@entry_id:748122)。这需要将物理空间中的曲线单元映射到一个规则的[参考单元](@entry_id:168425)（如正方形或三角形）上进行计算。在此过程中，必须精确处理由坐标变换引入的几何度量项。守恒律方程从物理[坐标系](@entry_id:156346)变换到参考[坐标系](@entry_id:156346)时，必须使用 Piola 恒等式以确保变换后的方程依然保持[守恒形式](@entry_id:747710)。这涉及到雅可比矩阵、[协变基](@entry_id:198968)向量（切向于坐标线）和[逆变](@entry_id:192290)度量向量（法向于坐标面）的正确使用。在计算单元边界上的数值通量时，必须使用这些几何度量项来正确计算物理通量在真实法向上的投影，以确保格式的守恒性和自由流保持特性（即能够精确保持均匀流场）。在[曲边单元](@entry_id:748117)上，雅可比行列式 $J$ 不再是常数，这导致[质量矩阵](@entry_id:177093) $M$ 不再是单位阵（即使在正交[模态基](@entry_id:752055)下），因为 $M_{\alpha \beta} = \int \varphi_\alpha \varphi_\beta J \, d\xi d\eta$。如果[几何映射](@entry_id:749852)具有特定对称性（如 $J$ 是关于参考坐标的偶函数），质量矩阵会呈现出[块对角结构](@entry_id:746869)，这可以被利用来提高[计算效率](@entry_id:270255)。同时，由于 $J$ 本身也需要在多项式空间中表示，这会引入“度量混淆误差”，其大小会影响一些高级格式（如分裂形式 DG）的稳定性 。

对于更复杂的几何，例如由CAD模型定义的物体，物体的边界可能不与网格线对齐，从而产生“切割单元”（cut cells）。DG 方法可以通过[浸入](@entry_id:161534)边界（Immersed Boundary）法来处理这种情况。其核心思想是在被切割的单元内部，只在流体占据的区域进行积分。[基函数](@entry_id:170178)被几何边界“裁剪”，在单元边界和浸入边界上都需要定义[数值通量](@entry_id:752791)。为了在切割面上保持守恒性，需要设计特殊的、依赖于[基函数](@entry_id:170178)的求积法则，以确保[通量积分](@entry_id:138365)的精确性 。

在处理真实世界的复杂区域时，通常需要使用[混合网格](@entry_id:750429)，例如在[边界层](@entry_id:139416)附近使用四边形网格，而在远离边界的区域使用三角形网格。当一个[模态基](@entry_id:752055)的[三角形单元](@entry_id:167871)和一个[节点基](@entry_id:752522)的[四边形单元](@entry_id:176937)共享一个公共边时，如何保证通量计算的守恒性成为一个挑战。一种称为“[砂浆法](@entry_id:752184)”（mortar method）的技术可以解决这个问题。其核心思想是在共享的界面上定义一个统一的、足够高精度的求积法则（如高斯求积），两边的单元都使用这个公共的[求积法则](@entry_id:753909)来计算通量矩，从而确保离开一个单元的通量精确地等于进入相邻单元的通量，避免了因[基函数](@entry_id:170178)和求积不匹配而导致的质量泄露 。

DG 方法的应用甚至可以超越传统的三维[欧氏空间](@entry_id:138052)，扩展到在[曲面](@entry_id:267450)上[求解偏微分方程](@entry_id:138485)。例如，在模拟[薄膜流动](@entry_id:155418)或地球物理流时，需要在球面或其他[流形](@entry_id:153038)上求解守恒律。DG 框架可以自然地推广到这种情况，只需将传统的散度、[梯度算子](@entry_id:275922)替换为[曲面](@entry_id:267450)上的对应算子（如[曲面](@entry_id:267450)散度 $\nabla_\Gamma \cdot$），并在每个点的切空间中定义局部[正交基](@entry_id:264024)。[数值通量](@entry_id:752791)的设计也需考虑[曲面](@entry_id:267450)度量，例如，法向矢量是位于切平面内且与单元边界正交的“余[法向量](@entry_id:264185)”。通过这种方式，可以为[曲面](@entry_id:267450)上的守恒律（如[曲面](@entry_id:267450)上的 Burgers 方程）构建熵稳定的 DG 格式 。

### 效率与鲁棒性的自适应策略

为了在保证计算精度的同时最大限度地提高效率，现代 DG 方法广泛采用自适应技术。自适应不仅限于传统的[网格加密](@entry_id:168565)（h-自适应）或多项式阶数提升（p-自适应），还包括更精巧的[基函数](@entry_id:170178)和数值通量的动态选择。

一种先进的策略是“[基函数](@entry_id:170178)自适应”。其思想是根据解的局部光滑度动态切换[基函数](@entry_id:170178)表示。例如，在解的光滑区域，使用[模态基](@entry_id:752055)是合适的；但在包含激波等间断的区域，切换到[节点基](@entry_id:752522)（特别是基于 Gauss-Lobatto 点的[节点基](@entry_id:752522)）可能更有优势。通过分析不同[基函数](@entry_id:170178)对[数值黏性](@entry_id:141318)的影响可以揭示其原因。对于一个连续的光滑波，使用 LGL [节点基](@entry_id:752522)的 DG 格式，其左右界面上的迹值是连续的，这导致[数值通量](@entry_id:752791)中的耗散项（如 HLLC 通量中的[波速](@entry_id:186208)乘以状态跳跃项）完全为零。这意味着[节点基](@entry_id:752522)自身引入的[数值黏性](@entry_id:141318)极低。相反，[模态基](@entry_id:752055)由于 $L^2$ 投影的性质，在界面上会产生一个小的跳跃，从而产生一定的[数值黏性](@entry_id:141318)。因此，在激波附近，我们希望由[数值通量](@entry_id:752791)本身来提供主要的耗散，此时使用[数值黏性](@entry_id:141318)低的[节点基](@entry_id:752522)是合适的；而在光滑区，我们可能需要[基函数](@entry_id:170178)本身提供一些背景耗散以抑制伪振荡，此时[模态基](@entry_id:752055)更为有利。通过在不同区域间切换基底，可以实现计算特性与物理现象的更优匹配 。

另一种强大的自适应策略是“[数值通量](@entry_id:752791)自适应”。其核心思想是：在解非常光滑的区域，使用计算代价低且耗散极小的通量（如[熵守恒通量](@entry_id:749013)）；而在激波或[接触间断](@entry_id:194702)附近，则切换为更鲁棒、耗散更强的通量（如 Roe 或 HLL 通量）来保证稳定性并捕捉间断。这种切换的判据可以基于对解的光滑度的局部评估。对于采用层级[模态基](@entry_id:752055)（hierarchical modal basis）的 DG 方法，这种评估变得非常自然。如果一个解是光滑的，其在[高阶模](@entry_id:750331)态上的能量（即高阶系数的平方和）会迅速衰减。因此，可以通过计算[高阶模](@entry_id:750331)态能量占总模态能量的比例来构造一个“光滑度指示器”。在每个单元交界面上，根据相邻两个单元的指示器大小，就可以动态地选择最合适的[数值通量](@entry_id:752791)，从而在全局范围内实现计算效率和鲁棒性的最佳平衡 。

### 跨学科连接

DG 方法的通用性和灵活性使其成为连接不同物理领域和计算方法的理想桥梁，推动了多物理场耦合仿真的发展。

一个典型的例子是**反应[流[体力](@entry_id:136788)](@entry_id:174230)学**。在此类问题中，[流体动力学](@entry_id:136788)（由欧拉或[纳维-斯托克斯方程](@entry_id:142275)描述）与复杂的化学反应网络紧密耦合。[化学反应](@entry_id:146973)通常表现为控制方程中的“刚性”源项，其[特征时间尺度](@entry_id:276738)远小于流动的[特征时间尺度](@entry_id:276738)，给数值求解带来巨大挑战。一种有效的处理方法是采用[算子分裂](@entry_id:634210)的隐式-显式（IMEX）[时间积分格式](@entry_id:165373)，其中[对流](@entry_id:141806)项用显式方法处理，而刚性源项则用[隐式方法](@entry_id:137073)处理。在这种框架下，DG 空间离散[基函数](@entry_id:170178)的选择会对隐式求解的效率和稳定性产生显著影响。分析表明，对于相同的物理问题和时间步长，使用[模态基](@entry_id:752055)和[节点基](@entry_id:752522)进行空间离散，会导致隐式源项求解步骤的雅可比矩阵具有截然不同的谱特性（如[条件数](@entry_id:145150)）。这揭示了空间离散选择与时间积分稳定性之间深刻的内在联系，对于设计高效稳定的[多物理场耦合](@entry_id:171389)求解器至关重要 。

另一个重要的跨学科应用是**地表水与[地下水](@entry_id:201480)流动耦合**。地表的自由流动（如河流、洪水）通常用浅水方程或纳维-斯托克斯方程描述，适合用 DG 方法求解；而地下的[多孔介质流](@entry_id:146440)则通常由[达西定律](@entry_id:153223)描述，常采用[混合有限元](@entry_id:178533)（MFE）方法进行离散。在连接这两个区域的界面上，需要一个能保证通量连续和守恒的耦合策略。DG 方法的框架为这种异构方法的耦合提供了便利。例如，在一个简化的[稳态扩散](@entry_id:154663)模型中，我们可以将[自由流](@entry_id:159506)区域的 DG 解与[多孔介质](@entry_id:154591)区域的 MFE 解通过一个精心设计的界面数值通量连接起来。通过将界面通量设定为 MFE 侧的通量值，可以自然地保证通量的守恒性和格式的一致性。分析这种耦合格式的界面误差，可以量化由于两种不同数值方法（及其[基函数](@entry_id:170178)）的不匹配所带来的不一致性，为评估和改进复杂环境模型的精度提供了理论依据 。

### 结论

本章通过一系列应用实例，展示了间断 Galerkin 方法作为一种计算框架的广度和深度。我们看到，从[可压缩气体动力学](@entry_id:169361)中精密设计的[熵稳定通量](@entry_id:749015)，到处理复杂几何时的度量变换与[混合网格](@entry_id:750429)技术，再到面向效率与鲁棒性的自适应策略，DG 方法的基本原理在各种挑战性问题中都得到了创造性的应用和发展。更重要的是，DG 方法的灵活性使其能够自然地与其他数值方法和物理模型耦合，在[反应流](@entry_id:190684)、[多孔介质流](@entry_id:146440)等跨学科领域中扮演着关键角色。

这些例子共同说明了一个核心思想：在 DG 方法中，[基函数](@entry_id:170178)、[数值通量](@entry_id:752791)和求积法则的选择并非孤立的技术决策，而是与待解问题的物理特性、几何复杂性以及所需的精度与效率紧密相关的设计过程。深刻理解这些选择背后的原理，是有效运用 DG 方法解决前沿科学与工程问题的关键。