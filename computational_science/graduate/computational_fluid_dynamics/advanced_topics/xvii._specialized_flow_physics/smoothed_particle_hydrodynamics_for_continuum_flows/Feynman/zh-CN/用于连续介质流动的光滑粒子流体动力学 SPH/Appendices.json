{
    "hands_on_practices": [
        {
            "introduction": "平滑核函数是SPH方法的核心，其性质对模拟的准确性和稳定性至关重要。一个基本要求是“单位分解”特性，它确保了核函数在所有粒子上的总和能够近似一个常数值。本练习将引导您完成对广泛使用的三次样条核函数的归一化常数的解析推导，这是任何SPH研究者都应掌握的基础技能。",
            "id": "3363341",
            "problem": "在用于连续介质流的光滑粒子流体动力学 (SPH) 中，三维 ($3$D) 三次样条核函数由无量纲半径 $q = \\|\\mathbf{r}\\|/h$ 定义为\n$$\nW(\\mathbf{r},h) = C_{3}\\,h^{-3}\\,w(q),\n$$\n其紧支集为 $q \\in [0,2]$，形状函数 $w(q)$ 由下式给出\n$$\nw(q) = \n\\begin{cases}\n1 - \\frac{3}{2}q^{2} + \\frac{3}{4}q^{3}, & 0 \\le q \\le 1, \\\\\n\\frac{1}{4}(2 - q)^{3}, & 1 < q \\le 2, \\\\\n0, & q > 2.\n\\end{cases}\n$$\n这里，$h>0$ 是光滑长度，而 $C_{3}$ 是待确定的（无量纲）归一化常数。\n\n仅使用 SPH 的基本要求，即核函数必须满足归一化（单位分解）条件\n$$\n\\int_{\\mathbb{R}^{3}} W(\\mathbf{r},h)\\,\\mathrm{d}\\mathbf{r} = 1,\n$$\n从第一性原理出发，推导出常数 $C_{3}$ 的闭式值，并明确证明其与 $h$ 无关。\n\n然后，对于 $h = 1$ 的情况，通过数值积分验证\n$$\n\\int_{\\|\\mathbf{r}\\|\\leq 2h} W(\\mathbf{r},h)\\,\\mathrm{d}\\mathbf{r} = 1.\n$$\n在数值验证中，请利用球对称性将积分简化为关于 $q$ 的一维积分，并在区间 $[0,1]$ 和 $[1,2]$ 上分别应用 $3$ 点 Gauss–Legendre 法则。在展示积分检验过程时，报告的中间数值应至少保留 $10$ 位有效数字。\n\n将您的最终答案表示为 $C_{3}$ 的闭式值（无单位）。最终答案无需四舍五入。",
            "solution": "光滑粒子流体动力学 (SPH) 核函数必须满足归一化（单位分解）条件\n$$\n\\int_{\\mathbb{R}^{3}} W(\\mathbf{r},h)\\,\\mathrm{d}\\mathbf{r} = 1.\n$$\n我们从给定的核函数形式出发\n$$\nW(\\mathbf{r},h) = C_{3}\\,h^{-3}\\,w(q), \\quad q=\\frac{\\|\\mathbf{r}\\|}{h},\n$$\n其紧支集为 $q \\in [0,2]$。由于 $W$ 是球对称的，我们转换到球坐标系，其中体积元为 $4\\pi r^{2}\\,\\mathrm{d}r$ 且 $r = \\|\\mathbf{r}\\|$。归一化条件变为\n$$\n1 = \\int_{\\mathbb{R}^{3}} W(\\mathbf{r},h)\\,\\mathrm{d}\\mathbf{r}\n= \\int_{0}^{2h} 4\\pi r^{2}\\, C_{3}\\,h^{-3}\\, w\\!\\left(\\frac{r}{h}\\right)\\,\\mathrm{d}r.\n$$\n引入变量代换 $q = r/h$，于是 $r = h q$，$\\mathrm{d}r = h\\,\\mathrm{d}q$，且 $r^{2} = h^{2} q^{2}$。则\n$$\n1 = 4\\pi C_{3} h^{-3} \\int_{0}^{2h} r^{2} w\\!\\left(\\frac{r}{h}\\right)\\,\\mathrm{d}r\n= 4\\pi C_{3} h^{-3} \\int_{0}^{2} \\left(h^{2} q^{2}\\right) w(q)\\, \\left(h\\,\\mathrm{d}q\\right)\n= 4\\pi C_{3} \\int_{0}^{2} q^{2} w(q)\\,\\mathrm{d}q.\n$$\n这直接表明 $C_{3}$ 与 $h$ 无关。定义\n$$\nJ \\equiv \\int_{0}^{2} q^{2} w(q)\\,\\mathrm{d}q,\n$$\n这样归一化条件可写作\n$$\n1 = 4\\pi C_{3} J \\quad \\Rightarrow \\quad C_{3} = \\frac{1}{4\\pi J}.\n$$\n我们现在根据给定的 $w(q)$ 的分段形式计算 $J$：\n$$\nJ = \\int_{0}^{1} q^{2} \\left(1 - \\frac{3}{2}q^{2} + \\frac{3}{4}q^{3}\\right)\\,\\mathrm{d}q\n+ \\int_{1}^{2} q^{2}\\left[\\frac{1}{4}(2 - q)^{3}\\right]\\,\\mathrm{d}q.\n$$\n在 $[0,1]$ 上，\n$$\nq^{2} w(q) = q^{2} - \\frac{3}{2} q^{4} + \\frac{3}{4} q^{5},\n$$\n所以\n$$\n\\int_{0}^{1} q^{2} w(q)\\,\\mathrm{d}q\n= \\int_{0}^{1} q^{2}\\,\\mathrm{d}q - \\frac{3}{2}\\int_{0}^{1} q^{4}\\,\\mathrm{d}q + \\frac{3}{4}\\int_{0}^{1} q^{5}\\,\\mathrm{d}q\n= \\frac{1}{3} - \\frac{3}{2}\\cdot \\frac{1}{5} + \\frac{3}{4}\\cdot \\frac{1}{6}.\n$$\n计算得，\n$$\n\\frac{1}{3} - \\frac{3}{10} + \\frac{1}{8} = \\frac{40}{120} - \\frac{36}{120} + \\frac{15}{120} = \\frac{19}{120}.\n$$\n在 $[1,2]$ 上，展开\n$$\n\\frac{1}{4}(2 - q)^{3} = \\frac{1}{4}\\left(8 - 12q + 6q^{2} - q^{3}\\right)\n= 2 - 3q + \\frac{3}{2}q^{2} - \\frac{1}{4}q^{3},\n$$\n因此\n$$\nq^{2} w(q) = 2 q^{2} - 3 q^{3} + \\frac{3}{2} q^{4} - \\frac{1}{4} q^{5}.\n$$\n因此，\n$$\n\\int_{1}^{2} q^{2} w(q)\\,\\mathrm{d}q\n= 2\\int_{1}^{2} q^{2}\\,\\mathrm{d}q - 3\\int_{1}^{2} q^{3}\\,\\mathrm{d}q + \\frac{3}{2}\\int_{1}^{2} q^{4}\\,\\mathrm{d}q - \\frac{1}{4}\\int_{1}^{2} q^{5}\\,\\mathrm{d}q.\n$$\n计算每一项：\n$$\n\\int_{1}^{2} q^{2}\\,\\mathrm{d}q = \\left.\\frac{q^{3}}{3}\\right|_{1}^{2} = \\frac{8 - 1}{3} = \\frac{7}{3}, \\quad\n\\int_{1}^{2} q^{3}\\,\\mathrm{d}q = \\left.\\frac{q^{4}}{4}\\right|_{1}^{2} = \\frac{16 - 1}{4} = \\frac{15}{4},\n$$\n$$\n\\int_{1}^{2} q^{4}\\,\\mathrm{d}q = \\left.\\frac{q^{5}}{5}\\right|_{1}^{2} = \\frac{32 - 1}{5} = \\frac{31}{5}, \\quad\n\\int_{1}^{2} q^{5}\\,\\mathrm{d}q = \\left.\\frac{q^{6}}{6}\\right|_{1}^{2} = \\frac{64 - 1}{6} = \\frac{63}{6} = \\frac{21}{2}.\n$$\n代入得：\n$$\n\\int_{1}^{2} q^{2} w(q)\\,\\mathrm{d}q\n= 2\\cdot \\frac{7}{3} - 3\\cdot \\frac{15}{4} + \\frac{3}{2}\\cdot \\frac{31}{5} - \\frac{1}{4}\\cdot \\frac{21}{2}\n= \\frac{14}{3} - \\frac{45}{4} + \\frac{93}{10} - \\frac{21}{8}.\n$$\n通分，公分母为 $120$，\n$$\n\\frac{14 \\cdot 40}{120} - \\frac{45 \\cdot 30}{120} + \\frac{93 \\cdot 12}{120} - \\frac{21 \\cdot 15}{120}\n= \\frac{560 - 1350 + 1116 - 315}{120} = \\frac{11}{120}.\n$$\n总计，\n$$\nJ = \\frac{19}{120} + \\frac{11}{120} = \\frac{30}{120} = \\frac{1}{4}.\n$$\n因此，归一化条件 $1 = 4\\pi C_{3} J$ 给出\n$$\n1 = 4\\pi C_{3}\\left(\\frac{1}{4}\\right) = \\pi C_{3} \\quad \\Rightarrow \\quad C_{3} = \\frac{1}{\\pi}.\n$$\n\n我们现在对 $h = 1$ 的情况通过数值积分来验证\n$$\n\\int_{\\|\\mathbf{r}\\|\\leq 2h} W(\\mathbf{r},h)\\,\\mathrm{d}\\mathbf{r} = 1.\n$$\n利用球对称性和 $h=1$ 可得\n$$\n\\int_{\\|\\mathbf{r}\\|\\leq 2} W(\\mathbf{r},1)\\,\\mathrm{d}\\mathbf{r}\n= 4\\pi C_{3} \\int_{0}^{2} q^{2} w(q)\\,\\mathrm{d}q\n= 4\\pi \\left(\\frac{1}{\\pi}\\right) \\int_{0}^{2} q^{2} w(q)\\,\\mathrm{d}q\n= 4 \\int_{0}^{2} q^{2} w(q)\\,\\mathrm{d}q.\n$$\n我们将积分分段。由于被积函数 $q^{2} w(q)$ 在每个子区间上是最高次数为 $5$ 的多项式，所以 $3$ 点 Gauss–Legendre 法则能够得到精确的积分值。为展示数值，我们使用上面计算的精确子积分值：\n$$\n\\int_{0}^{1} q^{2} w(q)\\,\\mathrm{d}q = \\frac{19}{120} \\approx 0.1583333333,\n\\quad\n\\int_{1}^{2} q^{2} w(q)\\,\\mathrm{d}q = \\frac{11}{120} \\approx 0.0916666667.\n$$\n求和得，\n$$\n\\int_{0}^{2} q^{2} w(q)\\,\\mathrm{d}q \\approx 0.1583333333 + 0.0916666667 = 0.2500000000.\n$$\n因此，\n$$\n\\int_{\\|\\mathbf{r}\\|\\leq 2} W(\\mathbf{r},1)\\,\\mathrm{d}\\mathbf{r}\n= 4 \\times 0.2500000000 = 1.0000000000,\n$$\n在数值上验证了归一化。\n\n总之，归一化常数与 $h$ 无关，其值为\n$$\nC_{3} = \\frac{1}{\\pi}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{\\pi}}$$"
        },
        {
            "introduction": "虽然许多流体流动是近乎不可压缩的，但使用严格不可压缩的SPH方法在计算上可能非常昂贵。弱可压缩SPH (WCSPH) 方法通过允许微小的密度波动，提供了一种实用的替代方案，而这种波动由一个人工声速$c_s$来控制。本练习将演示如何将期望的压缩水平与这一关键模拟参数的选择及其导致的时间步长约束联系起来。",
            "id": "3363330",
            "problem": "考虑一个粘性连续介质流的弱可压缩光滑粒子流体动力学（SPH）离散化，该离散化使用正压状态方程和人工声速 $c_{s}$ 来近似近不可压缩性。流体的参考密度为 $\\rho_{0}$，流场在计算域内达到的最大速度为 $U_{\\max}$。为了保证较小的压缩性误差，要求在整个模拟过程中，相对密度变化 $\\Delta \\rho/\\rho_{0}$ 保持小于或等于 $0.01$。\n\n从连续介质的质量和动量守恒方程以及正压闭合关系出发，依据第一性原理推导在给定 $U_{\\max}$ 的情况下，确保 $\\Delta \\rho/\\rho_{0} \\leq 0.01$ 所需的最小声速 $c_{s}$。然后，使用适用于显式时间积分的 Courant-Friedrichs-Lewy (CFL) 原则，并将 SPH 中的主导信号速度取为声学和对流贡献之和，确定相应的声学 CFL 时间步长约束。具体而言，假设粒子光滑长度为 $h$，选定的库朗数为 $C$，并利用该方法中最快特征信号在单个时间步长内不得穿过超过一个光滑长度的要求。\n\n使用以下参数：\n- 最大流速 $U_{\\max} = 2.5$ m/s，\n- 光滑长度 $h = 0.01$ m，\n- 库朗数 $C = 0.35$。\n\n将最终数值结果四舍五入至四位有效数字。最小声速以 m/s 为单位，时间步长以秒为单位表示。你的最终答案必须是一个单行矩阵，包含最小声速 $c_{s}$ 和在声学 CFL 约束下相应的最大稳定时间步长 $\\Delta t$。",
            "solution": "本题求解分为两部分。首先，推导维持所需压缩性水平所需的最小人工声速 $c_s$。其次，使用该声速值根据 Courant-Friedrichs-Lewy (CFL) 条件计算最大稳定时间步长 $\\Delta t$。\n\n**第 1 部分：最小声速的推导**\n\n在弱可压缩SPH (WCSPH) 方法中，压力 $P$ 通过一个正压状态方程 $P=P(\\rho)$ 由密度 $\\rho$ 计算得出。声速定义为 $c_s^2 = \\mathrm{d}P/\\mathrm{d}\\rho$。对于参考密度 $\\rho_0$ 附近的小密度波动 $\\Delta \\rho = \\rho - \\rho_0$，压力-密度关系可以线性化为：\n$$\n\\Delta P \\approx \\left. \\frac{\\mathrm{d}P}{\\mathrm{d}\\rho} \\right|_{\\rho_0} \\Delta \\rho = c_s^2 \\Delta \\rho\n$$\n这里，$c_s$ 是在参考密度下评估的人工声速。\n\n接下来，我们通过对动量方程进行量级分析，建立压力波动与流速之间的关系。在惯性主导的流动中，动压的尺度与惯性项相当。\n$$\n|\\nabla P| \\sim |\\rho (\\mathbf{u} \\cdot \\nabla)\\mathbf{u}|\n$$\n在特征长度 $L$ 和最大速度 $U_{\\max}$ 下，这近似为：\n$$\n\\frac{\\Delta P}{L} \\sim \\rho_0 \\frac{U_{\\max}^2}{L} \\quad \\Rightarrow \\quad \\Delta P \\sim \\rho_0 U_{\\max}^2\n$$\n结合上述两个关于 $\\Delta P$ 的关系式，我们得到：\n$$\nc_s^2 \\Delta \\rho \\sim \\rho_0 U_{\\max}^2\n$$\n整理后得到相对密度波动的表达式：\n$$\n\\frac{\\Delta \\rho}{\\rho_0} \\sim \\frac{U_{\\max}^2}{c_s^2}\n$$\n问题要求相对密度变化不超过 $0.01$：\n$$\n\\frac{U_{\\max}^2}{c_s^2} \\leq 0.01\n$$\n解出 $c_s$ 的条件：\n$$\nc_s^2 \\geq \\frac{U_{\\max}^2}{0.01} = 100 U_{\\max}^2\n$$\n因此，所需的最小声速为：\n$$\nc_{s, \\min} = \\sqrt{100 U_{\\max}^2} = 10 U_{\\max}\n$$\n代入给定值 $U_{\\max} = 2.5 \\, \\text{m/s}$：\n$$\nc_{s, \\min} = 10 \\times 2.5 \\, \\text{m/s} = 25 \\, \\text{m/s}\n$$\n四舍五入到四位有效数字，得到 $c_{s, \\min} = 25.00 \\, \\text{m/s}$。\n\n**第 2 部分：CFL 时间步长约束的推导**\n\n对于显式时间积分格式，CFL 条件要求在一个时间步长内，数值依赖域必须包含物理依赖域。在 SPH 中，这通常表示为：\n$$\n\\Delta t \\leq C \\frac{h}{v_{\\text{signal, max}}}\n$$\n其中 $C$ 是库朗数，$h$ 是光滑长度。问题指明，主导信号速度 $v_{\\text{signal}}$ 是声速和对流速度之和。为确保全局稳定性，我们必须考虑最快信号速度，它发生在流速达到最大值 $U_{\\max}$ 的地方：\n$$\nv_{\\text{signal, max}} = c_{s, \\min} + U_{\\max}\n$$\n我们使用在第 1 部分中计算的最小声速 $c_{s, \\min}$。最大稳定时间步长 $\\Delta t_{\\max}$ 对应于等式成立的情况：\n$$\n\\Delta t_{\\max} = C \\frac{h}{c_{s, \\min} + U_{\\max}}\n$$\n代入给定值和推导值：$C = 0.35$，$h = 0.01 \\, \\text{m}$，$U_{\\max} = 2.5 \\, \\text{m/s}$，以及 $c_{s, \\min} = 25 \\, \\text{m/s}$。\n$$\n\\Delta t_{\\max} = 0.35 \\times \\frac{0.01 \\, \\text{m}}{25 \\, \\text{m/s} + 2.5 \\, \\text{m/s}} = 0.35 \\times \\frac{0.01}{27.5} \\, \\text{s}\n$$\n$$\n\\Delta t_{\\max} \\approx 0.0001272727... \\, \\text{s}\n$$\n将此值四舍五入到四位有效数字，得到：\n$$\n\\Delta t_{\\max} = 1.273 \\times 10^{-4} \\, \\text{s}\n$$\n因此，最小声速为 $25.00 \\, \\text{m/s}$，相应的最大稳定时间步长为 $1.273 \\times 10^{-4} \\, \\text{s}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n25.00 & 1.273 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "为了提高效率和准确性，现代SPH模拟通常使用随局部粒子密度变化的自适应平滑长度$h$。这个看似简单的改变会在运动方程中引入微妙但重要的修正项，即所谓的“grad-h”项。这个高级练习将深入探讨SPH的拉格朗日形式，以推导这些项，并分析它们在特定流动场景中的重要性。",
            "id": "3363327",
            "problem": "考虑一个嵌入在三维平滑粒子流体动力学 (SPH) 离散化中的平面一维流，其核函数 $W(|\\boldsymbol{r}|,h)$ 是各向同性、紧支集、归一化的，且对于任意光滑长度 $h$ 均满足 $\\int_{\\mathbb{R}^{3}} W(|\\boldsymbol{r}|,h)\\,\\mathrm{d}^{3}\\boldsymbol{r} = 1$。假设密度求和的定义为 $\\rho_{a} = \\sum_{b} m_{b}\\,W(|\\boldsymbol{r}_{a}-\\boldsymbol{r}_{b}|,h_{a})$，光滑长度的封闭关系为 $h(\\rho) = h_{0}\\,(\\rho/\\rho_{0})^{-1/3}$，其中 $h_{0}$ 和 $\\rho_{0}$ 是正常数，且流动变量仅沿笛卡尔坐标 $x$ 变化。物理密度场为 $\\rho(x) = \\rho_{0}\\,(1+\\alpha x)$，其中 $|\\alpha|\\,h_{0} \\ll 1$，粒子 $a$ 位于 $x_{a} = 0$ 处，远离边界，使得核函数的支撑域完全包含在连续介质描述成立的区域内。\n\n从无粘性正压流体的离散拉格朗日量 $L = \\sum_{a} m_{a}\\left(\\tfrac{1}{2}\\,|\\boldsymbol{v}_{a}|^{2} - u(\\rho_{a})\\right)$ 出发，并使用密度求和与光滑长度约束 $h_{a} = h(\\rho_{a})$，应用 Euler–Lagrange 方程推导压力加速度的形式，该形式通过一个因子 $\\Omega_{a}$ 包含了所谓的 grad-$h$ 修正，该因子源于 $\\rho_{a}$ 对 $h_{a}$ 的依赖性。然后，假设在连续介质极限下（此时求和可以用在缓变场上对空间进行的积分代替），对于给定的 $\\rho(x)$ 和 $h(\\rho)$，在 $x_{a}=0$ 处计算 $\\Omega_{a}$，计算过程仅明确使用核函数的归一化和各向同性性质。\n\n将“未修正”的 SPH 压力加速度定义为将 grad-$h$ 因子设为 1 时得到的表达式，并定义无量纲量值比\n$$\nR \\equiv \\left|\\Omega_{a}^{-1} - 1\\right|,\n$$\n它衡量了 grad-$h$ 修正相对于粒子 $a$ 处未修正项的量值。在上述假设下计算 $R$。您的最终答案必须是单个数字或单个闭式解析表达式。如果使用了任何近似，请根据假设进行论证。最终答案不需要单位。如果得出数值，除非必要，否则不要四舍五入；否则，请给出精确值。",
            "solution": "本问题要求从拉格朗日力学推导带有自适应光滑长度的 SPH 运动方程，并计算特定条件下 grad-h 修正项的相对大小。\n\n### 第 1 部分：从拉格朗日量推导运动方程\n\n粒子 $c$ 的运动方程由 Euler-Lagrange 方程给出：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{\\partial L}{\\partial \\boldsymbol{v}_{c}}\\right) = \\frac{\\partial L}{\\partial \\boldsymbol{r}_{c}}\n$$\n其中 $L = \\sum_{a} m_{a}\\left(\\tfrac{1}{2}\\,|\\boldsymbol{v}_{a}|^{2} - u(\\rho_{a})\\right)$。\n方程左侧为：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(m_{c}\\boldsymbol{v}_{c}\\right) = m_{c}\\frac{\\mathrm{d}\\boldsymbol{v}_{c}}{\\mathrm{d}t}\n$$\n方程右侧为：\n$$\n\\frac{\\partial L}{\\partial \\boldsymbol{r}_{c}} = - \\sum_{a} m_{a} \\frac{\\mathrm{d}u}{\\mathrm{d}\\rho_{a}} \\frac{\\partial \\rho_{a}}{\\partial \\boldsymbol{r}_{c}} = - \\sum_{a} m_{a} \\frac{P_a}{\\rho_a^2} \\frac{\\partial \\rho_{a}}{\\partial \\boldsymbol{r}_{c}}\n$$\n关键在于计算 $\\frac{\\partial \\rho_{a}}{\\partial \\boldsymbol{r}_{c}}$。由于 $h_a = h(\\rho_a)$，我们必须使用链式法则：\n$$\n\\frac{\\partial \\rho_{a}}{\\partial \\boldsymbol{r}_{c}} = \\frac{\\partial}{\\partial \\boldsymbol{r}_{c}}\\left(\\sum_{b} m_{b} W_{ab}(h_a)\\right) = \\sum_{b} m_{b} \\left( \\frac{\\partial W_{ab}}{\\partial \\boldsymbol{r}_{c}} + \\frac{\\partial W_{ab}}{\\partial h_a} \\frac{\\mathrm{d}h_a}{\\mathrm{d}\\rho_a} \\frac{\\partial \\rho_a}{\\partial \\boldsymbol{r}_{c}} \\right)\n$$\n重新整理以求解 $\\frac{\\partial \\rho_{a}}{\\partial \\boldsymbol{r}_{c}}$：\n$$\n\\frac{\\partial \\rho_{a}}{\\partial \\boldsymbol{r}_{c}} \\left(1 - \\frac{\\mathrm{d}h_{a}}{\\mathrm{d}\\rho_{a}} \\sum_{b} m_{b} \\frac{\\partial W_{ab}}{\\partial h_{a}}\\right) = \\sum_{b} m_{b} \\frac{\\partial W_{ab}}{\\partial \\boldsymbol{r}_{c}}\n$$\n定义 grad-h 修正因子 $\\Omega_a$ 为：\n$$\n\\Omega_{a} \\equiv \\left(1 - \\frac{\\mathrm{d}h_{a}}{\\mathrm{d}\\rho_{a}} \\sum_{b} m_{b} \\frac{\\partial W_{ab}}{\\partial h_{a}}\\right)^{-1}\n$$\n于是 $\\frac{\\partial \\rho_{a}}{\\partial \\boldsymbol{r}_{c}} = \\Omega_a \\sum_{b} m_{b} \\frac{\\partial W_{ab}}{\\partial \\boldsymbol{r}_{c}}$。使用 $\\frac{\\partial W_{ab}}{\\partial \\boldsymbol{r}_c} = (\\delta_{ac}-\\delta_{bc})\\nabla_a W_{ab}$，我们得到运动方程：\n$$\nm_c \\frac{\\mathrm{d}\\boldsymbol{v}_{c}}{\\mathrm{d}t} = - \\sum_a m_a \\frac{P_a}{\\rho_a^2} \\Omega_a \\sum_b m_b (\\delta_{ac}-\\delta_{bc})\\nabla_a W_{ab}\n$$\n通过交换求和顺序并重新标记索引，可以证明这等价于：\n$$\n\\frac{\\mathrm{d}\\boldsymbol{v}_{c}}{\\mathrm{d}t} = -\\sum_{b}m_{b}\\left( \\frac{P_{c}\\Omega_{c}}{\\rho_{c}^{2}} + \\frac{P_{b}\\Omega_{b}}{\\rho_{b}^{2}} \\right)\\nabla_{c}W_{cb}\n$$\n这就是包含了 grad-h 修正的压力加速度。\n\n### 第 2 部分：在给定条件下计算 $\\Omega_a$\n\n我们需要计算在 $x_a=0$ 处的 $\\Omega_{a}^{-1} = 1 - \\frac{\\mathrm{d}h_{a}}{\\mathrm{d}\\rho_{a}} \\sum_{b} m_{b} \\frac{\\partial W_{ab}}{\\partial h_{a}}$。\n首先，计算 $h$ 对 $\\rho$ 的导数。由 $h_{a} = h_{0}\\,(\\rho_{a}/\\rho_{0})^{-1/3}$ 可得：\n$$\n\\frac{\\mathrm{d}h_{a}}{\\mathrm{d}\\rho_{a}} = h_{0}\\rho_{0}^{1/3} \\left(-\\frac{1}{3}\\rho_{a}^{-4/3}\\right) = -\\frac{1}{3} \\frac{h_a}{\\rho_a}\n$$\n接下来，在连续介质极限下计算求和项 $S_a = \\sum_{b} m_{b} \\frac{\\partial W_{ab}}{\\partial h_{a}}$。我们将求和替换为积分：\n$$\nS_a \\to \\int \\rho(\\boldsymbol{r}_{b}) \\frac{\\partial W(|\\boldsymbol{r}_{a}-\\boldsymbol{r}_{b}|, h_{a})}{\\partial h_{a}} \\mathrm{d}^3\\boldsymbol{r}_{b}\n$$\n在粒子 $a$ 处 ($x_a=0$)，$\\rho_a \\to \\rho(0)=\\rho_0$ 且 $h_a \\to h(\\rho_0)=h_0$。令 $\\boldsymbol{r}' = \\boldsymbol{r}_b - \\boldsymbol{r}_a$。在 $\\boldsymbol{r}_a=0$ 处，$\\boldsymbol{r}_b = \\boldsymbol{r}'$。给定的密度场为 $\\rho(\\boldsymbol{r}_b) = \\rho(x_b) = \\rho_0(1+\\alpha x'_x)$。积分变为：\n$$\nS_a = \\int \\rho_{0}(1+\\alpha x'_x) \\frac{\\partial W(|\\boldsymbol{r}'|, h_{0})}{\\partial h_{0}} \\mathrm{d}^3\\boldsymbol{r}'\n$$\n$$\nS_a = \\rho_{0} \\int \\frac{\\partial W(r', h_{0})}{\\partial h_{0}} \\mathrm{d}^3\\boldsymbol{r}' + \\rho_{0}\\alpha \\int x'_x \\frac{\\partial W(r', h_{0})}{\\partial h_{0}} \\mathrm{d}^3\\boldsymbol{r}'\n$$\n我们利用核函数的性质来计算这两个积分：\n1.  **第一个积分**：根据核函数的归一化条件 $\\int W(r', h_{0}) \\mathrm{d}^3\\boldsymbol{r}' = 1$，对其两边关于 $h_0$ 求导，得到：\n    $$\n    \\frac{\\partial}{\\partial h_{0}}\\int W(r', h_{0}) \\mathrm{d}^3\\boldsymbol{r}' = \\int \\frac{\\partial W(r', h_{0})}{\\partial h_{0}} \\mathrm{d}^3\\boldsymbol{r}' = \\frac{\\partial(1)}{\\partial h_{0}} = 0\n    $$\n2.  **第二个积分**：核函数 $W(r', h_{0})$ 及其对 $h_0$ 的导数都是各向同性（球对称）的，即它们是 $r' = |\\boldsymbol{r}'|$ 的函数。被积函数 $x'_x \\frac{\\partial W}{\\partial h_0}$ 是 $x'_x$ 的奇函数。由于积分域（核函数的支撑域）是关于原点对称的，该积分值为零。\n\n由于两个积分都为零，我们得到 $S_a = 0$。\n\n现在我们可以计算 $\\Omega_a^{-1}$：\n$$\n\\Omega_{a}^{-1} = 1 - \\left(-\\frac{1}{3}\\frac{h_{a}}{\\rho_{a}}\\right) \\times 0 = 1\n$$\n因此 $\\Omega_a = 1$。\n\n### 第 3 部分：计算比率 R\n\n无量纲比率 $R$ 定义为 $R \\equiv \\left|\\Omega_{a}^{-1} - 1\\right|$。代入我们计算出的 $\\Omega_a^{-1}$ 值：\n$$\nR = |1 - 1| = 0\n$$\n这个结果表明，对于线性密度分布，grad-h 修正项（在一阶近似下）为零。这是因为该修正项与密度场的曲率（二阶导数）相关，而对于线性场 $\\rho(x) = \\rho_0(1+\\alpha x)$, 曲率为零。因此，没有 grad-h 修正。",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}