{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of flamelet theory is the parameterization of a complex reacting flow by a few controlling variables. This exercise reinforces the fundamental relationships between mixture fraction ($Z$), local equivalence ratio ($\\phi$), and the scalar dissipation rate ($\\chi$), which governs flame extinction. By working through a hypothetical scenario of partial premixing, you will gain hands-on experience in how stream compositions alter the flame's stoichiometric structure and its vulnerability to extinction .",
            "id": "3318846",
            "problem": "In the flamelet formulation of turbulent combustion within computational fluid dynamics (CFD), the local state of a reacting mixture is parameterized by the mixture fraction $Z$, which is a conserved scalar for mixing of two streams. Consider a canonical two-stream configuration: a fuel stream and an oxidizer stream that mix without reaction to produce local pre-reaction mass fractions $Y_{F}(Z)$ and $Y_{O}(Z)$ through linear superposition. The local equivalence ratio $\\phi$ is defined as the ratio of the actual fuel-to-oxidizer mass ratio to its stoichiometric value, where the one-step chemistry is represented by $F + s\\,O \\rightarrow \\text{products}$ and $s$ is the stoichiometric oxidizer-to-fuel mass ratio. Assume unity Lewis numbers and constant density for the purposes of scalar transport.\n\nLet the fuel stream have composition $Y_{F,F}$ and $Y_{O,F}$, and the oxidizer stream have composition $Y_{F,O}$ and $Y_{O,O}$. Assume the spatial dependence of the mixture fraction across the counterflow mixing layer is given by\n$$\nZ(\\xi) = \\frac{1}{2}\\left[1 - \\tanh(\\alpha \\,\\xi)\\right],\n$$\nwith constant $\\alpha  0$, where $\\xi$ is the coordinate normal to the stagnation plane. The molecular diffusivity is a constant $D  0$. The scalar dissipation rate is\n$$\n\\chi(\\xi) = 2 D \\left|\\frac{dZ}{d\\xi}\\right|^{2}.\n$$\nExtinction in the non-premixed flamelet sense occurs when the scalar dissipation rate at the stoichiometric surface, $\\chi_{st} \\equiv \\chi(\\xi_{st})$ with $Z(\\xi_{st}) = Z_{st}$, exceeds a chemistry-dependent critical value $\\chi_{\\text{ext,crit}}$.\n\nYou are to analyze partial premixing by allowing a nonzero fuel background in the oxidizer stream, quantified by $Y_{F,O}  0$. Using only the definitions above and linear two-stream mixing as the fundamental base, proceed as follows:\n\n1) Derive the mapping $\\phi(Z)$ between the local equivalence ratio $\\phi$ and the mixture fraction $Z$ for general two-stream mixing with $Y_{F,F}$, $Y_{O,F}$, $Y_{F,O}$, and $Y_{O,O}$.\n\n2) Specialize to a methane–oxygen chemistry surrogate with $s = 4$ and the following stream compositions:\n- Fuel stream: $Y_{F,F} = 1$, $Y_{O,F} = 0$.\n- Oxidizer stream oxygen mass fraction: $Y_{O,O} = 0.21$.\nCompare two oxidizer cases:\n(a) No background fuel: $Y_{F,O} = 0$.\n(b) Partial premixing: $Y_{F,O} = 0.02$.\nFor each case, determine the stoichiometric mixture fraction $Z_{st}$ by enforcing the stoichiometric mixing condition and identifying the location where $\\phi(Z_{st}) = 1$.\n\n3) With the $Z(\\xi)$ profile given above, express $\\chi_{st}$ as a function of $Z_{st}$, $D$, and $\\alpha$ only, and compute the ratio\n$$\nR \\equiv \\frac{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0.02}{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0},\n$$\nholding $D$, $\\alpha$, and $\\chi_{\\text{ext,crit}}$ fixed across the comparison. This ratio quantifies the change in the mixing-controlled extinction propensity induced by the background fuel in the oxidizer stream.\n\nProvide your final numeric value of $R$ rounded to four significant figures. Express your answer as a dimensionless number with no units.",
            "solution": "The user wants me to solve a multi-part problem in combustion theory, specifically relating to flamelet models. I will first validate the problem statement and then proceed with a detailed solution if it is valid.\n\n### Problem Validation\n\n#### Step 1: Extract Givens\n- **Mixture fraction**: $Z$. $Z$ is a conserved scalar.\n- **Pre-reaction mass fractions**: $Y_F(Z)$ for fuel, $Y_O(Z)$ for oxidizer, determined by linear superposition.\n- **Local equivalence ratio**: $\\phi = \\frac{Y_F / Y_O}{1/s} = s \\frac{Y_F}{Y_O}$.\n- **One-step chemistry**: $F + s\\,O \\rightarrow \\text{products}$.\n- **Stoichiometric oxidizer-to-fuel mass ratio**: $s$.\n- **Assumptions**: Unity Lewis numbers, constant density.\n- **Stream compositions**:\n    - Fuel stream: mass fractions $Y_{F,F}$ and $Y_{O,F}$.\n    - Oxidizer stream: mass fractions $Y_{F,O}$ and $Y_{O,O}$.\n- **Mixture fraction spatial profile**: $Z(\\xi) = \\frac{1}{2}\\left[1 - \\tanh(\\alpha \\,\\xi)\\right]$, with constant $\\alpha  0$. $\\xi$ is the coordinate normal to the stagnation plane.\n- **Molecular diffusivity**: Constant $D  0$.\n- **Scalar dissipation rate**: $\\chi(\\xi) = 2 D \\left|\\frac{dZ}{d\\xi}\\right|^{2}$.\n- **Stoichiometric scalar dissipation rate**: $\\chi_{st} \\equiv \\chi(\\xi_{st})$, where $Z(\\xi_{st}) = Z_{st}$.\n- **Extinction condition**: Extinction occurs when $\\chi_{st}$ exceeds a critical value $\\chi_{\\text{ext,crit}}$.\n- **Numerical values for Part 2 and 3**:\n    - $s = 4$.\n    - Fuel stream: $Y_{F,F} = 1$, $Y_{O,F} = 0$.\n    - Oxidizer stream: $Y_{O,O} = 0.21$.\n    - Case (a): No background fuel, $Y_{F,O} = 0$.\n    - Case (b): Partial premixing, $Y_{F,O} = 0.02$.\n- **Required output**: The ratio $R \\equiv \\frac{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0.02}{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0}$.\n\n#### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the well-established flamelet concept in combustion science, a cornerstone of turbulent combustion modeling. The definitions of mixture fraction, equivalence ratio, and scalar dissipation rate are standard in the field. The setup describes a canonical counterflow mixing problem. All aspects are firmly grounded in the principles of chemical engineering and fluid mechanics.\n- **Well-Posed**: The problem is structured as a sequence of derivations and calculations. Each step logically follows from the previous one. The given information is sufficient to derive a unique solution for the requested ratio, $R$.\n- **Objective**: The problem is stated in precise, quantitative, and unbiased language. There are no subjective or opinion-based statements.\n- **Other checks**: The problem is self-contained, with all necessary definitions and data provided. There are no contradictions. The setup is a standard idealization used in combustion research and is thus scientifically plausible for its purpose. The problem is substantive and requires a chain of reasoning based on fundamental principles.\n\n#### Step 3: Verdict and Action\nThe problem is valid. It is a well-posed, scientifically sound, and objective problem from the field of computational fluid dynamics and combustion theory. I will proceed with the detailed solution.\n\n### Solution\n\nThe solution is constructed in three parts as requested by the problem statement.\n\n#### 1) Derivation of the mapping $\\phi(Z)$\n\nThe local mass fractions of fuel, $Y_F(Z)$, and oxidizer, $Y_O(Z)$, are given by the linear mixing rule between the fuel stream (at $Z=1$) and the oxidizer stream (at $Z=0$). In the problem's notation, where the fuel stream is denoted by subscript $F$ and the oxidizer stream by subscript $O$ in the context of stream compositions, the mixing rules are:\n$$\nY_F(Z) = Z \\cdot Y_{F,F} + (1-Z) \\cdot Y_{F,O}\n$$\n$$\nY_O(Z) = Z \\cdot Y_{O,F} + (1-Z) \\cdot Y_{O,O}\n$$\nThe local equivalence ratio $\\phi$ is defined as the actual fuel-to-oxidizer ratio normalized by the stoichiometric fuel-to-oxidizer ratio ($1/s$):\n$$\n\\phi = s \\frac{Y_F}{Y_O}\n$$\nSubstituting the linear mixing rules for $Y_F(Z)$ and $Y_O(Z)$ into the definition of $\\phi$ gives the mapping $\\phi(Z)$:\n$$\n\\phi(Z) = s \\frac{Z Y_{F,F} + (1-Z) Y_{F,O}}{Z Y_{O,F} + (1-Z) Y_{O,O}}\n$$\nThis is the general relationship between the local equivalence ratio and the mixture fraction for the given two-stream mixing configuration.\n\n#### 2) Determination of the stoichiometric mixture fraction $Z_{st}$\n\nThe stoichiometric mixture fraction, $Z_{st}$, is the value of $Z$ at which the mixture is stoichiometric, i.e., where $\\phi(Z_{st}) = 1$. Setting the expression for $\\phi(Z)$ equal to $1$ yields:\n$$\n1 = s \\frac{Z_{st} Y_{F,F} + (1-Z_{st}) Y_{F,O}}{Z_{st} Y_{O,F} + (1-Z_{st}) Y_{O,O}}\n$$\nTo solve for $Z_{st}$, we rearrange the equation:\n$$\nZ_{st} Y_{O,F} + (1-Z_{st}) Y_{O,O} = s \\left( Z_{st} Y_{F,F} + (1-Z_{st}) Y_{F,O} \\right)\n$$\n$$\nZ_{st} Y_{O,F} + Y_{O,O} - Z_{st} Y_{O,O} = s Z_{st} Y_{F,F} + s Y_{F,O} - s Z_{st} Y_{F,O}\n$$\nGrouping terms containing $Z_{st}$:\n$$\nY_{O,O} - s Y_{F,O} = Z_{st} \\left( s Y_{F,F} - s Y_{F,O} - Y_{O,F} + Y_{O,O} \\right)\n$$\nIsolating $Z_{st}$ gives the general solution:\n$$\nZ_{st} = \\frac{Y_{O,O} - s Y_{F,O}}{s Y_{F,F} + Y_{O,O} - Y_{O,F} - s Y_{F,O}}\n$$\nWe now specialize this result using the provided numerical values: $s=4$, $Y_{F,F}=1$, $Y_{O,F}=0$, and $Y_{O,O}=0.21$. The expression for $Z_{st}$ becomes:\n$$\nZ_{st} = \\frac{0.21 - 4 Y_{F,O}}{4(1) + 0.21 - 0 - 4 Y_{F,O}} = \\frac{0.21 - 4 Y_{F,O}}{4.21 - 4 Y_{F,O}}\n$$\nWe evaluate this for the two specified cases.\n\n(a) No background fuel: $Y_{F,O} = 0$.\n$$\nZ_{st,a} = \\frac{0.21 - 4(0)}{4.21 - 4(0)} = \\frac{0.21}{4.21}\n$$\n\n(b) Partial premixing: $Y_{F,O} = 0.02$.\n$$\nZ_{st,b} = \\frac{0.21 - 4(0.02)}{4.21 - 4(0.02)} = \\frac{0.21 - 0.08}{4.21 - 0.08} = \\frac{0.13}{4.13}\n$$\n\n#### 3) Calculation of the ratio $R$\n\nFirst, we derive an expression for the scalar dissipation rate $\\chi_{st}$ as a function of $Z_{st}$. The scalar dissipation rate is given by $\\chi(\\xi) = 2 D |dZ/d\\xi|^2$. We need to find the derivative $dZ/d\\xi$ from the given profile $Z(\\xi) = \\frac{1}{2}[1 - \\tanh(\\alpha \\xi)]$.\n$$\n\\frac{dZ}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{1}{2} - \\frac{1}{2}\\tanh(\\alpha \\xi) \\right) = -\\frac{1}{2} \\text{sech}^2(\\alpha \\xi) \\cdot \\alpha = -\\frac{\\alpha}{2} \\text{sech}^2(\\alpha \\xi)\n$$\nWe need to express this derivative in terms of $Z$. From the definition of $Z(\\xi)$, we have $2Z = 1 - \\tanh(\\alpha\\xi)$, which gives $\\tanh(\\alpha\\xi) = 1-2Z$. Using the identity $\\text{sech}^2(x) = 1 - \\tanh^2(x)$, we find:\n$$\n\\text{sech}^2(\\alpha\\xi) = 1 - \\left(1-2Z\\right)^2 = 1 - \\left(1 - 4Z + 4Z^2\\right) = 4Z - 4Z^2 = 4Z(1-Z)\n$$\nSubstituting this back into the derivative:\n$$\n\\frac{dZ}{d\\xi} = -\\frac{\\alpha}{2} \\left[ 4Z(1-Z) \\right] = -2\\alpha Z(1-Z)\n$$\nNow, we can write $\\chi$ as a function of $Z$:\n$$\n\\chi(Z) = 2 D \\left| -2\\alpha Z(1-Z) \\right|^2 = 2 D \\left[ 4\\alpha^2 Z^2(1-Z)^2 \\right] = 8D\\alpha^2 Z^2(1-Z)^2\n$$\nThe scalar dissipation rate at the stoichiometric surface, $\\chi_{st}$, is obtained by evaluating this expression at $Z=Z_{st}$:\n$$\n\\chi_{st} = 8D\\alpha^2 Z_{st}^2(1-Z_{st})^2\n$$\nWe are asked to compute the ratio $R \\equiv \\frac{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0.02}{\\chi_{st}\\ \\text{with}\\ Y_{F,O} = 0}$. Using the expression for $\\chi_{st}$ and denoting the two cases with subscripts $b$ and $a$ respectively:\n$$\nR = \\frac{8D\\alpha^2 Z_{st,b}^2(1-Z_{st,b})^2}{8D\\alpha^2 Z_{st,a}^2(1-Z_{st,a})^2}\n$$\nThe constants $8D\\alpha^2$ cancel, as they are held fixed:\n$$\nR = \\left( \\frac{Z_{st,b}(1-Z_{st,b})}{Z_{st,a}(1-Z_{st,a})} \\right)^2\n$$\nLet's compute the terms $Z(1-Z)$ for each case.\nFor case (a):\n$$\nZ_{st,a}(1-Z_{st,a}) = \\frac{0.21}{4.21} \\left(1 - \\frac{0.21}{4.21}\\right) = \\frac{0.21}{4.21} \\left(\\frac{4.21-0.21}{4.21}\\right) = \\frac{0.21 \\times 4.00}{(4.21)^2} = \\frac{0.84}{(4.21)^2}\n$$\nFor case (b):\n$$\nZ_{st,b}(1-Z_{st,b}) = \\frac{0.13}{4.13} \\left(1 - \\frac{0.13}{4.13}\\right) = \\frac{0.13}{4.13} \\left(\\frac{4.13-0.13}{4.13}\\right) = \\frac{0.13 \\times 4.00}{(4.13)^2} = \\frac{0.52}{(4.13)^2}\n$$\nNow we compute the ratio of these terms:\n$$\n\\frac{Z_{st,b}(1-Z_{st,b})}{Z_{st,a}(1-Z_{st,a})} = \\frac{0.52 / (4.13)^2}{0.84 / (4.21)^2} = \\frac{0.52}{0.84} \\times \\left(\\frac{4.21}{4.13}\\right)^2\n$$\nNow we calculate the numerical value:\n$$\n\\frac{Z_{st,b}(1-Z_{st,b})}{Z_{st,a}(1-Z_{st,a})} \\approx \\frac{0.52}{0.84} \\times (1.019370...)^2 \\approx 0.619047... \\times 1.039116... \\approx 0.643265...\n$$\nFinally, we compute $R$ by squaring this value:\n$$\nR = (0.643265...)^2 \\approx 0.413790...\n$$\nRounding to four significant figures, we get $R \\approx 0.4138$.",
            "answer": "$$\\boxed{0.4138}$$"
        },
        {
            "introduction": "The theoretical S-curve, representing ignition and extinction behavior, poses a significant challenge for practical implementation in CFD codes. A robust lookup algorithm must navigate the multiple solution branches without introducing numerical instabilities. This hands-on coding practice tasks you with designing a smooth branch-aware interpolation scheme based on a simplified model, providing essential skills for creating stable and physically meaningful simulations from flamelet tables .",
            "id": "3318797",
            "problem": "You are tasked with designing and testing a robust branch-aware property lookup algorithm for flamelet-based combustion that enforces continuity across ignition–extinction branches by using a branch indicator derived from the $S$-curve topology. Work in a nondimensional setting to avoid physical units. Your implementation must be fully self-contained and produce deterministic results.\n\nStarting point and fundamental base:\n- Consider the steady, mixture-fraction-conditioned progress-variable balance that emerges in the flamelet regime of turbulent combustion, where the local mixture fraction $Z$ is a conserved scalar and the Stoichiometric Scalar Dissipation Rate (SDR) at the stoichiometric mixture fraction, denoted $\\chi_{st}$, controls the diffusive mixing timescale. In the steady flamelet approximation, the balance of diffusion and reaction source terms in the transport equation for a normalized progress variable $C \\in [0,1]$ yields a nonlinear algebraic relation exhibiting an $S$-shaped response when parametrized by $\\chi_{st}$.\n- Use a reduced, nondimensional surrogate for the manifold obtained by asymptotic reduction near criticality, where the progress variable $C$ satisfies the algebraic constraint\n$$\nF(C;\\chi_{st}) \\equiv C^3 - \\alpha C + \\beta(\\chi_{st}) = 0,\n$$\nwith parameters $\\alpha  0$ and $\\beta(\\chi_{st}) = \\kappa(\\chi_{st}-\\chi_0)$ for constants $\\kappa0$ and $\\chi_0$. This cubic normal form captures the $S$-curve topology produced by the competition between reaction and diffusion. The discriminant condition\n$$\n\\Delta(\\chi_{st}) = 4\\alpha^3 - 27\\beta(\\chi_{st})^2\n$$\ndetermines whether there are $3$ real solutions ($\\Delta0$) corresponding to extinction, unstable, and ignition branches, or a single real solution ($\\Delta \\le 0$).\n\nYour task:\n1. From the standpoint of $S$-curve topology, derive a smooth branch indicator that discriminates between the lower and upper stable branches using only local information that can be computed from the roots of $F(C;\\chi_{st})=0$ at a given $\\chi_{st}$. The indicator must:\n   - Map a target progress variable $C_t$ to a continuous weight $w \\in [0,1]$ with $w \\approx 0$ near the lower stable branch and $w \\approx 1$ near the upper stable branch.\n   - Be monotone in the signed distance of $C_t$ from a topologically meaningful separatrix that you define using the $S$-curve geometry (for example, a location between the lower and upper stable roots).\n   - Reduce to a constant on single-valued regions ($\\Delta \\le 0$) where only one real root exists.\n2. Using the indicator from Part $1$, construct a branch-aware lookup for a scalar “table” quantity $q$ that is fixed by the manifold and depends on the branch. For this problem, set $q$ equal to the manifold progress variable, that is, $q(C;\\chi_{st},Z) = C$ evaluated on the appropriate stable branch(es). When $3$ real roots exist at a given $\\chi_{st}$, enforce continuity by forming a convex combination of the lower and upper stable manifold values using your indicator $w$, while excluding the unstable root:\n   - If there are $3$ real roots at $\\chi_{st}$, denote the ordered roots by $C_{low}(\\chi_{st}) \\le C_{mid}(\\chi_{st}) \\le C_{high}(\\chi_{st})$. Your lookup should return a continuous value $q^{lookup}(\\chi_{st},Z,C_t)$ that blends the lower and upper stable branches according to your indicator and depends on $C_t$.\n   - If there is a single real root, return that root as the lookup, independent of $C_t$.\n3. Demonstrate robustness of your method near the critical Stoichiometric Scalar Dissipation Rates where branches merge. Determine the fold locations from the cubic discriminant. Let\n$$\n\\beta_{crit} = \\frac{2}{3\\sqrt{3}}\\,\\alpha^{3/2}, \\quad \\chi_{crit}^{\\pm} = \\chi_0 \\pm \\frac{\\beta_{crit}}{\\kappa}.\n$$\nYou will test behavior for $\\chi_{st}$ near $\\chi_{crit}^{+}$.\n\nTest suite and parameters:\n- Use the following nondimensional parameter values:\n  - $\\alpha = 1.0$, $\\kappa = 1.0$, $\\chi_0 = 1.0$.\n  - Smoothing scale for the indicator: $\\delta = 2\\times 10^{-2}$.\n  - For any $\\chi_{st}$ with $3$ real roots, define $C_{low}(\\chi_{st})$ and $C_{high}(\\chi_{st})$ as the smallest and largest real roots, respectively. Define the separatrix at that $\\chi_{st}$ by $C_{sep}(\\chi_{st}) = \\tfrac{1}{2}(C_{low}(\\chi_{st}) + C_{high}(\\chi_{st}))$.\n- Compute the following five quantitative metrics, in this exact order, using the specified offsets:\n  $1.$ Center, lower-branch fidelity: set $\\chi_{st} = \\chi_0$, compute $C_{low}(\\chi_0)$ and set $C_t = C_{low}(\\chi_0) + 10^{-2}$. Compute the absolute error\n  $$\n  e_{low} = \\left|\\,q^{lookup}(\\chi_0,Z,C_t) - C_{low}(\\chi_0)\\,\\right|.\n  $$\n  $2.$ Center, upper-branch fidelity: set $\\chi_{st} = \\chi_0$, compute $C_{high}(\\chi_0)$ and set $C_t = C_{high}(\\chi_0) - 10^{-2}$. Compute\n  $$\n  e_{high} = \\left|\\,q^{lookup}(\\chi_0,Z,C_t) - C_{high}(\\chi_0)\\,\\right|.\n  $$\n  $3.$ Continuity across the separatrix: set $\\chi_{st} = \\chi_0$, compute $C_{sep}(\\chi_0)$ and let $\\varepsilon = 10^{-4}$. Compute the continuity jump\n  $$\n  J = \\left|\\,q^{lookup}\\big(\\chi_0,Z,C_{sep}(\\chi_0)+\\varepsilon\\big) - q^{lookup}\\big(\\chi_0,Z,C_{sep}(\\chi_0)-\\varepsilon\\big)\\,\\right|.\n  $$\n  $4.$ Near-fold, upper-branch fidelity: set $\\chi_{st} = \\chi_{crit}^{+} - 10^{-4}$, compute $C_{high}(\\chi_{st})$, set $C_t = C_{high}(\\chi_{st}) - 10^{-3}$. Compute\n  $$\n  e_{fold} = \\left|\\,q^{lookup}(\\chi_{st},Z,C_t) - C_{high}(\\chi_{st})\\,\\right|.\n  $$\n  $5.$ Across-fold robustness: set $\\chi_1 = \\chi_{crit}^{+} - 10^{-4}$, $\\chi_2 = \\chi_{crit}^{+} + 10^{-4}$, compute $C_{sep}(\\chi_1)$, and evaluate\n  $$\n  D = \\left|\\,q^{lookup}(\\chi_2,Z,C_{sep}(\\chi_1)) - q^{lookup}(\\chi_1,Z,C_{sep}(\\chi_1))\\,\\right|.\n  $$\n- The mixture fraction $Z$ is a dummy input in this problem; treat $q$ as independent of $Z$ to isolate the branch handling.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the exact order $[e_{low},e_{high},J,e_{fold},D]$. Express each entry as a decimal float with at least six digits after the decimal point.\n\nConstraints and requirements:\n- You must base your derivation in Part $1$ on the $S$-curve topology and the fold structure implied by the discriminant, not on any ad hoc if-else case selection by thresholds on $\\chi_{st}$ alone.\n- The indicator must be smooth in $C_t$ and $\\chi_{st}$ away from the folds and must not use any discontinuous functions of $C_t$.\n- The algorithm must robustly handle near-critical $\\chi_{st}$ values where roots coalesce, without producing undefined values or not-a-number results.\n- Assume all quantities are nondimensional; do not attach physical units.",
            "solution": "## PROBLEM VALIDATION\n\n### Step 1: Extract Givens\n- **Governing Equation**: The progress variable $C$ is a real root of the algebraic equation $F(C;\\chi_{st}) = C^3 - \\alpha C + \\beta(\\chi_{st}) = 0$.\n- **Parameters**:\n  - $\\alpha  0$ is a constant.\n  - $\\beta(\\chi_{st}) = \\kappa(\\chi_{st}-\\chi_0)$ where $\\kappa  0$ and $\\chi_0$ are constants.\n  - $\\chi_{st}$ is the Stoichiometric Scalar Dissipation Rate (SDR).\n- **Discriminant**: $\\Delta(\\chi_{st}) = 4\\alpha^3 - 27\\beta(\\chi_{st})^2$.\n- **Root Structure**:\n  - If $\\Delta  0$: $3$ real roots ($C_{low} \\le C_{mid} \\le C_{high}$).\n  - If $\\Delta \\le 0$: $1$ real root.\n- **Task 1 (Branch Indicator)**:\n  - Derive a smooth branch indicator $w(C_t)$, where $C_t$ is a target progress variable.\n  - $w \\in [0,1]$.\n  - $w \\approx 0$ near the lower stable branch, $w \\approx 1$ near the upper stable branch.\n  - Monotone in the signed distance of $C_t$ from a separatrix.\n  - Constant on single-valued regions ($\\Delta \\le 0$).\n- **Task 2 (Branch-Aware Lookup)**:\n  - The lookup quantity is $q(C;\\chi_{st},Z) = C$. The mixture fraction $Z$ is a dummy variable.\n  - If $3$ roots exist, the lookup value is $q^{lookup} = (1-w)C_{low} + wC_{high}$.\n  - If $1$ root exists, the lookup value is the single root.\n- **Critical Points**:\n  - $\\beta_{crit} = \\frac{2}{3\\sqrt{3}}\\,\\alpha^{3/2}$.\n  - $\\chi_{crit}^{\\pm} = \\chi_0 \\pm \\frac{\\beta_{crit}}{\\kappa}$.\n- **Test Suite Parameters**:\n  - $\\alpha = 1.0$, $\\kappa = 1.0$, $\\chi_0 = 1.0$.\n  - Smoothing scale $\\delta = 2\\times 10^{-2}$.\n  - Separatrix definition: $C_{sep}(\\chi_{st}) = \\tfrac{1}{2}(C_{low}(\\chi_{st}) + C_{high}(\\chi_{st}))$.\n- **Metrics to Compute**:\n  1. $e_{low} = |q^{lookup}(\\chi_0,Z,C_{low}(\\chi_0) + 10^{-2}) - C_{low}(\\chi_0)|$.\n  2. $e_{high} = |q^{lookup}(\\chi_0,Z,C_{high}(\\chi_0) - 10^{-2}) - C_{high}(\\chi_0)|$.\n  3. $J = |q^{lookup}(\\chi_0,Z,C_{sep}(\\chi_0)+\\varepsilon) - q^{lookup}(\\chi_0,Z,C_{sep}(\\chi_0)-\\varepsilon)|$ with $\\varepsilon=10^{-4}$.\n  4. $e_{fold} = |q^{lookup}(\\chi_{st},Z,C_t) - C_{high}(\\chi_{st})|$ where $\\chi_{st} = \\chi_{crit}^{+} - 10^{-4}$ and $C_t = C_{high}(\\chi_{st}) - 10^{-3}$.\n  5. $D = |q^{lookup}(\\chi_2,Z,C_{sep}(\\chi_1)) - q^{lookup}(\\chi_1,Z,C_{sep}(\\chi_1))|$ where $\\chi_1 = \\chi_{crit}^{+} - 10^{-4}$ and $\\chi_2 = \\chi_{crit}^{+} + 10^{-4}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem is rooted in the established theory of flamelet models in combustion, using a canonical cubic equation that represents the normal form of a cusp catastrophe, which accurately describes the ignition-extinction ($S$-curve) phenomenon. All concepts are standard in the field.\n- **Well-Posed**: The problem sets a clear, deterministic computational task. All parameters, equations, and test conditions are explicitly defined, leading to a unique set of numerical results.\n- **Objective**: The language is precise and quantitative. The tasks involve derivation and implementation of a specific algorithm and reporting of objective numerical metrics.\n\nBased on this, the problem is **valid**. It is a well-defined problem in applied numerical methods within the context of computational fluid dynamics and combustion theory.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n---\n\n### Part 1: Derivation of the Branch Indicator\nThe problem requires a smooth branch indicator $w$ to distinguish between the lower ($C_{low}$) and upper ($C_{high}$) stable branches of the $S$-curve. The indicator must be a function of a target progress variable $C_t$ and should map to the interval $[0,1]$.\nThe provided separatrix, $C_{sep}(\\chi_{st}) = \\tfrac{1}{2}(C_{low}(\\chi_{st}) + C_{high}(\\chi_{st}))$, provides a natural dividing line between the domains of influence of the two stable branches. The signed distance of $C_t$ from this separatrix, $d = C_t - C_{sep}$, can be used to construct the indicator.\n\nA suitable function that smoothly transitions from $0$ to $1$ is the hyperbolic tangent function, scaled appropriately. We define the branch indicator $w$ as:\n$$\nw(C_t; \\chi_{st}) = \\frac{1}{2}\\left[ 1 + \\tanh\\left(\\frac{C_t - C_{sep}(\\chi_{st})}{\\delta}\\right) \\right]\n$$\nwhere $\\delta$ is the specified smoothing scale. This indicator satisfies the required properties:\n- It is a smooth, differentiable function of $C_t$ (and of $\\chi_{st}$ through $C_{sep}$).\n- As $C_t \\to -\\infty$, the argument of $\\tanh$ becomes large and negative, so $\\tanh \\to -1$ and $w \\to 0$. This corresponds to the lower branch.\n- As $C_t \\to +\\infty$, the argument of $\\tanh$ becomes large and positive, so $\\tanh \\to 1$ and $w \\to 1$. This corresponds to the upper branch.\n- It is monotonically increasing with $C_t$, and thus with the signed distance from the separatrix.\n\nThis indicator is only defined in the multi-valued region ($\\Delta  0$) where $C_{low}$ and $C_{high}$ are distinct. As per the problem description, the overall lookup algorithm will handle the single-valued region separately.\n\n### Part 2: Construction of the Branch-Aware Lookup Algorithm\nThe branch-aware lookup algorithm for a quantity $q$ (here, $q=C$) takes as input the scalar dissipation rate $\\chi_{st}$ and a target progress variable $C_t$. The algorithm proceeds as follows:\n\n1.  **Compute State Parameter**: Given $\\chi_{st}$, calculate $\\beta = \\kappa(\\chi_{st} - \\chi_0)$.\n2.  **Determine Manifold Topology**: Calculate the discriminant $\\Delta = 4\\alpha^3 - 27\\beta^2$.\n3.  **Perform Lookup**:\n    - **If $\\Delta \\le 0$ (Single-Valued Region)**: There is only one real root for the equation $C^3 - \\alpha C + \\beta = 0$. The algorithm must find this root, $C_{single}$, and return it. The lookup is independent of $C_t$.\n      $$\n      q^{lookup}(\\chi_{st}, Z, C_t) = C_{single}(\\chi_{st})\n      $$\n    - **If $\\Delta  0$ (Multi-Valued Region)**: Three real roots exist. The algorithm must find and sort them: $C_{low} \\le C_{mid} \\le C_{high}$. The outer two roots, $C_{low}$ and $C_{high}$, correspond to the stable lower (extinguished) and upper (ignited) branches, respectively. The middle root, $C_{mid}$, is unstable and is excluded from the lookup.\n        - First, compute the separatrix: $C_{sep} = \\tfrac{1}{2}(C_{low} + C_{high})$.\n        - Next, compute the branch indicator using the formula from Part 1: $w = \\frac{1}{2}\\left[ 1 + \\tanh\\left(\\frac{C_t - C_{sep}}{\\delta}\\right) \\right]$.\n        - Finally, compute the lookup value as a convex combination of the stable branch values:\n          $$\n          q^{lookup}(\\chi_{st}, Z, C_t) = (1 - w)C_{low}(\\chi_{st}) + w C_{high}(\\chi_{st})\n          $$\nThis construction ensures that for a given $\\chi_{st}$ in the multi-valued region, the lookup provides a continuous transition from $C_{low}$ to $C_{high}$ as the target field variable $C_t$ crosses the separatrix.\n\n### Part 3: Algorithmic Implementation and Test Suite\n\nThe algorithm is implemented in Python using the `numpy` library for numerical operations, particularly for finding the roots of the cubic polynomial. The test suite requires computing five metrics based on the specified parameters.\n\nFirst, we determine the critical values. The folds of the $S$-curve occur when $\\Delta=0$, which implies $\\beta = \\pm\\beta_{crit}$.\nGiven $\\alpha=1.0$, $\\kappa=1.0$, $\\chi_0=1.0$:\n$\\beta_{crit} = \\frac{2}{3\\sqrt{3}}\\,(1.0)^{3/2} = \\frac{2}{3\\sqrt{3}} \\approx 0.38490018$.\nThe corresponding critical $\\chi_{st}$ values are:\n$\\chi_{crit}^{\\pm} = \\chi_0 \\pm \\frac{\\beta_{crit}}{\\kappa} = 1.0 \\pm \\beta_{crit}$.\nThe upper value, $\\chi_{crit}^{+} = 1.0 + \\beta_{crit} \\approx 1.38490018$, corresponds to the extinction turning point where the upper and middle branches merge (at $C = \\sqrt{\\alpha/3} = 1/\\sqrt{3}$).\n\nThe five metrics are computed as follows:\n1.  **$e_{low}$**: At $\\chi_{st}=1.0$, $\\beta=0$ and the roots are $C_{low}=-1, C_{mid}=0, C_{high}=1$. $C_{sep}=0$. With $C_t = -1.0 + 10^{-2} = -0.99$, $C_t$ is far below $C_{sep}$, so $w \\approx 0$ and $q^{lookup} \\approx C_{low}$. The error will be very small.\n2.  **$e_{high}$**: At $\\chi_{st}=1.0$, with $C_t = 1.0 - 10^{-2} = 0.99$, $C_t$ is far above $C_{sep}$, so $w \\approx 1$ and $q^{lookup} \\approx C_{high}$. The error will also be very small.\n3.  **$J$**: At $\\chi_{st}=1.0$, we evaluate the lookup on either side of $C_{sep}=0$. The difference measures the steepness of the transition region, which is controlled by $\\delta$. For small arguments, $\\tanh(x) \\approx x$, so $J \\approx 2 \\cdot \\tanh(\\varepsilon/\\delta) \\approx 2\\varepsilon/\\delta = 2 \\cdot 10^{-4} / (2 \\cdot 10^{-2}) = 0.01$.\n4.  **$e_{fold}$**: Here, $\\chi_{st} = \\chi_{crit}^{+} - 10^{-4}$ is just inside the multi-valued region, near the extinction fold. The roots $C_{mid}$ and $C_{high}$ are very close. The target $C_t = C_{high} - 10^{-3}$ is still far from the separatrix $C_{sep}$ relative to the smoothing scale $\\delta$, so $w$ will be very close to $1$ and the lookup will be accurate.\n5.  **$D$**: This metric quantifies the discontinuity of the lookup procedure when crossing a fold point with $C_t$ fixed at the pre-fold separatrix value, $C_{sep}(\\chi_1)$. For $\\chi_1$, $q^{lookup}$ evaluates to $C_{sep}(\\chi_1)$. For $\\chi_2  \\chi_{crit}^{+}$, the system has a single root, which is the continuation of the $C_{low}$ branch. The value $D = |C_{single}(\\chi_2) - C_{sep}(\\chi_1)|$ measures the jump, which is expected to be significant as $C_{sep}$ is defined as the midpoint of the widely separated $C_{low}$ and $C_{high}$ roots.\n\nThe provided Python code implements this logic and computes the specified metrics.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Note: No scipy functions are needed as numpy.tanh is sufficient.\n\ndef solve():\n    \"\"\"\n    Implements the branch-aware lookup algorithm and runs the test suite\n    as specified in the problem statement.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # The 'test_cases' structure is not used directly as the tests are specific.\n    # Instead, we define the global parameters for the problem.\n    alpha = 1.0\n    kappa = 1.0\n    chi0 = 1.0\n    delta = 2e-2\n    dummy_z = 0.0 # Placeholder for the dummy mixture fraction variable\n\n    def find_real_roots(chi_st_val):\n        \"\"\"\n        Finds the real roots of the cubic equation C^3 - alpha*C + beta = 0\n        for a given chi_st value.\n        \"\"\"\n        beta_val = kappa * (chi_st_val - chi0)\n        coeffs = [1, 0, -alpha, beta_val]\n        all_roots = np.roots(coeffs)\n        # Filter for real roots (imaginary part is close to zero)\n        real_roots = all_roots[np.isclose(all_roots.imag, 0)].real\n        return np.sort(real_roots)\n\n    def q_lookup(chi_st_val, z_val, C_t_val):\n        \"\"\"\n        Constructs the branch-aware lookup for the scalar quantity q.\n        The variable z_val is ignored as per the problem description.\n        \"\"\"\n        beta_val = kappa * (chi_st_val - chi0)\n        discriminant = 4 * alpha**3 - 27 * beta_val**2\n\n        # Case 1: Single real root exists\n        if discriminant = 0:\n            roots = find_real_roots(chi_st_val)\n            # In edge cases (at the fold), numerical precision might yield\n            # a double root. Taking the mean is a robust way to handle this.\n            return np.mean(roots)\n        \n        # Case 2: Three real roots exist\n        else:\n            roots = find_real_roots(chi_st_val)\n            C_low, _, C_high = roots\n            \n            # Define the separatrix based on the two stable roots\n            C_sep = 0.5 * (C_low + C_high)\n            \n            # Calculate the smooth branch indicator weight 'w'\n            tanh_arg = (C_t_val - C_sep) / delta\n            w = 0.5 * (1 + np.tanh(tanh_arg))\n            \n            # Form the convex combination of the stable branch values\n            q_val = (1 - w) * C_low + w * C_high\n            return q_val\n\n    # Main logic to calculate the five specified metrics\n    results = []\n    \n    # --- Pre-computation of critical values ---\n    beta_crit = (2 / (3 * np.sqrt(3))) * alpha**(3/2)\n    chi_crit_p = chi0 + beta_crit / kappa\n\n    # --- Metric 1: Center, lower-branch fidelity (e_low) ---\n    chi_st_1 = chi0\n    # For chi_st=chi0, beta=0. The roots are -1, 0, 1. So C_low=-1.\n    C_low_1 = -1.0\n    C_t_1 = C_low_1 + 1e-2\n    q_lookup_1 = q_lookup(chi_st_1, dummy_z, C_t_1)\n    e_low = abs(q_lookup_1 - C_low_1)\n    results.append(e_low)\n\n    # --- Metric 2: Center, upper-branch fidelity (e_high) ---\n    chi_st_2 = chi0\n    # For chi_st=chi0, beta=0. The roots are -1, 0, 1. So C_high=1.\n    C_high_2 = 1.0\n    C_t_2 = C_high_2 - 1e-2\n    q_lookup_2 = q_lookup(chi_st_2, dummy_z, C_t_2)\n    e_high = abs(q_lookup_2 - C_high_2)\n    results.append(e_high)\n\n    # --- Metric 3: Continuity across the separatrix (J) ---\n    chi_st_3 = chi0\n    epsilon = 1e-4\n    # For chi_st=chi0, C_sep = 0.5 * (-1 + 1) = 0.\n    C_sep_3 = 0.0\n    q_lookup_3_plus = q_lookup(chi_st_3, dummy_z, C_sep_3 + epsilon)\n    q_lookup_3_minus = q_lookup(chi_st_3, dummy_z, C_sep_3 - epsilon)\n    J = abs(q_lookup_3_plus - q_lookup_3_minus)\n    results.append(J)\n\n    # --- Metric 4: Near-fold, upper-branch fidelity (e_fold) ---\n    chi_st_4 = chi_crit_p - 1e-4\n    roots_4 = find_real_roots(chi_st_4)\n    _, _, C_high_4 = roots_4\n    C_t_4 = C_high_4 - 1e-3\n    q_lookup_4 = q_lookup(chi_st_4, dummy_z, C_t_4)\n    e_fold = abs(q_lookup_4 - C_high_4)\n    results.append(e_fold)\n\n    # --- Metric 5: Across-fold robustness (D) ---\n    chi1_5 = chi_crit_p - 1e-4\n    chi2_5 = chi_crit_p + 1e-4\n\n    # Calculate q1 at chi1 (3-root region)\n    roots_5_1 = find_real_roots(chi1_5)\n    C_low_5_1, _, C_high_5_1 = roots_5_1\n    C_sep_5_1 = 0.5 * (C_low_5_1 + C_high_5_1)\n    # The query is at C_t = C_sep_5_1\n    q1 = q_lookup(chi1_5, dummy_z, C_sep_5_1)\n\n    # Calculate q2 at chi2 (1-root region)\n    # The C_t value (C_sep_5_1) is irrelevant for the single-root case\n    q2 = q_lookup(chi2_5, dummy_z, C_sep_5_1)\n    \n    D = abs(q2 - q1)\n    results.append(D)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Applying flamelet models within Large-Eddy Simulation (LES) requires closing unclosed terms that arise from the filtering process, a central task in turbulent combustion modeling. This exercise focuses on modeling the subgrid-scale production of progress-variable variance, a term crucial for capturing turbulence-chemistry interaction. By deriving a model, calibrating it against hypothetical high-fidelity data, and testing its predictions, you will practice the complete workflow of developing and validating a subgrid closure for an LES context .",
            "id": "3318856",
            "problem": "You are tasked with deriving, implementing, and calibrating a subgrid model for the production of Favre-filtered progress-variable variance in Large-Eddy Simulation (LES) of turbulent reacting flows using the flamelet-based approach. Consider the progress variable defined as a normalized linear combination of product mass fractions, denoted by $c$, where $0 \\le c \\le 1$, and its reaction source term denoted by $\\dot{\\omega}_c$. In a flamelet-based modeling framework, the filtered source term $\\tilde{\\dot{\\omega}}_c$ is obtained by lookup from a precomputed laminar steady flamelet library as a function of mixture fraction and its moments; however, in this problem, you are given the required filtered gradients directly.\n\nStart from the filtered (Favre) variance of $c$, denoted by $\\widetilde{c''^2}$, where $c'' = c - \\tilde{c}$ denotes the Favre fluctuation of $c$. A contribution to the variance production arises from the covariance between $c$ and $\\dot{\\omega}_c$, namely $2 \\, \\widetilde{c'' \\dot{\\omega}_c''}$. Use a generalized gradient model for the unresolved covariance between $c$ and $\\dot{\\omega}_c$ of the form\n$$\n\\tau(c,\\dot{\\omega}_c) \\equiv \\widetilde{c \\, \\dot{\\omega}_c} - \\tilde{c} \\, \\tilde{\\dot{\\omega}}_c \\approx C_g \\, \\Delta^2 \\, \\partial_k \\tilde{c} \\, \\partial_k \\tilde{\\dot{\\omega}}_c,\n$$\nwhere $C_g$ is an unknown dimensionless model coefficient to be calibrated, $\\Delta$ is the LES filter width (with units $\\mathrm{m}$), and repeated indices imply summation. Assume that density variations are moderate such that Favre and Reynolds covariances are approximately equal for the provided dataset, and that molecular transport effects do not explicitly enter the present calibration.\n\nYour tasks are:\n1. Derive the model expression for the variance production by subgrid heat release, $P_\\omega$, in terms of $C_g$, $\\Delta$, $\\nabla \\tilde{c}$, and $\\nabla \\tilde{\\dot{\\omega}}_c$. Clearly state the resulting units of $P_\\omega$.\n2. Calibrate $C_g$ by minimizing the mean-squared error between the Direct Numerical Simulation (DNS, Direct Numerical Simulation) estimates of $\\tau(c,\\dot{\\omega}_c)$ and the generalized gradient model prediction $C_g \\, \\Delta^2 \\, \\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c$. Use the following calibration dataset, which is representative of a piloted jet flame DNS filtered at various $\\Delta$:\n   - Case $\\#1$: $\\Delta = 1.0 \\times 10^{-3} \\ \\mathrm{m}$, $\\nabla \\tilde{c} = [1000, \\, 0, \\, 0] \\ \\mathrm{m}^{-1}$, $\\nabla \\tilde{\\dot{\\omega}}_c = [200, \\, 0, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$, $\\tau_{\\mathrm{DNS}} = 1.6666666666666668 \\times 10^{-2} \\ \\mathrm{s}^{-1}$.\n   - Case $\\#2$: $\\Delta = 1.5 \\times 10^{-3} \\ \\mathrm{m}$, $\\nabla \\tilde{c} = [800, \\, 600, \\, 0] \\ \\mathrm{m}^{-1}$, $\\nabla \\tilde{\\dot{\\omega}}_c = [50, \\, 30, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$, $\\tau_{\\mathrm{DNS}} = 1.0875 \\times 10^{-2} \\ \\mathrm{s}^{-1}$.\n   - Case $\\#3$: $\\Delta = 0.8 \\times 10^{-3} \\ \\mathrm{m}$, $\\nabla \\tilde{c} = [-500, \\, 400, \\, 100] \\ \\mathrm{m}^{-1}$, $\\nabla \\tilde{\\dot{\\omega}}_c = [200, \\, -120, \\, 40] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$, $\\tau_{\\mathrm{DNS}} = -7.68 \\times 10^{-3} \\ \\mathrm{s}^{-1}$.\n   - Case $\\#4$: $\\Delta = 1.2 \\times 10^{-3} \\ \\mathrm{m}$, $\\nabla \\tilde{c} = [0, \\, 1000, \\, 0] \\ \\mathrm{m}^{-1}$, $\\nabla \\tilde{\\dot{\\omega}}_c = [0, \\, 100, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$, $\\tau_{\\mathrm{DNS}} = 1.2 \\times 10^{-2} \\ \\mathrm{s}^{-1}$.\n   - Case $\\#5$: $\\Delta = 1.0 \\times 10^{-3} \\ \\mathrm{m}$, $\\nabla \\tilde{c} = [300, \\, -400, \\, 500] \\ \\mathrm{m}^{-1}$, $\\nabla \\tilde{\\dot{\\omega}}_c = [-150, \\, 200, \\, -250] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$, $\\tau_{\\mathrm{DNS}} = -2.0833333333333334 \\times 10^{-2} \\ \\mathrm{s}^{-1}$.\n3. After calibrating $C_g$, predict the production $P_\\omega$ for each of the following test cases. Express all final results in $\\mathrm{s}^{-1}$ as floating-point numbers.\n   - Test $\\#\\mathrm{A}$ (happy path): $\\Delta = 1.1 \\times 10^{-3} \\ \\mathrm{m}$, $\\nabla \\tilde{c} = [700, \\, 200, \\, 100] \\ \\mathrm{m}^{-1}$, $\\nabla \\tilde{\\dot{\\omega}}_c = [70, \\, 40, \\, 10] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$.\n   - Test $\\#\\mathrm{B}$ (boundary, zero source gradient): $\\Delta = 1.0 \\times 10^{-3} \\ \\mathrm{m}$, $\\nabla \\tilde{c} = [1000, \\, 0, \\, 0] \\ \\mathrm{m}^{-1}$, $\\nabla \\tilde{\\dot{\\omega}}_c = [0, \\, 0, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$.\n   - Test $\\#\\mathrm{C}$ (anti-aligned gradients): $\\Delta = 0.9 \\times 10^{-3} \\ \\mathrm{m}$, $\\nabla \\tilde{c} = [400, \\, 0, \\, 0] \\ \\mathrm{m}^{-1}$, $\\nabla \\tilde{\\dot{\\omega}}_c = [-100, \\, 0, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$.\n   - Test $\\#\\mathrm{D}$ (filter-width scaling): $\\Delta = 2.0 \\times 10^{-3} \\ \\mathrm{m}$, $\\nabla \\tilde{c} = [500, \\, 500, \\, 0] \\ \\mathrm{m}^{-1}$, $\\nabla \\tilde{\\dot{\\omega}}_c = [50, \\, 50, \\, 0] \\ \\mathrm{m}^{-1} \\ \\mathrm{s}^{-1}$.\n\nImplementation requirements:\n- Your program must compute the least-squares estimate $C_g^\\star$ from the calibration set and then compute $P_\\omega = 2 \\, C_g^\\star \\, \\Delta^2 \\, \\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c$ for each test case.\n- Angles do not appear in this problem.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is the predicted $P_\\omega$ for Test $\\#\\mathrm{A}$ through Test $\\#\\mathrm{D}$, respectively, expressed in $\\mathrm{s}^{-1}$.\n\nTest suite coverage rationale:\n- Test $\\#\\mathrm{A}$ is a general nondegenerate configuration.\n- Test $\\#\\mathrm{B}$ enforces the boundary condition of zero production when $\\nabla \\tilde{\\dot{\\omega}}_c$ vanishes.\n- Test $\\#\\mathrm{C}$ checks sign sensitivity for anti-aligned gradients.\n- Test $\\#\\mathrm{D}$ examines $\\Delta^2$ scaling for the model prediction.\n\nAll physical quantities must be treated in the International System of Units (SI), and the final outputs must be in $\\mathrm{s}^{-1}$.",
            "solution": "The problem is found to be valid upon examination. It is scientifically grounded in the field of turbulent combustion modeling, well-posed with a clear objective and sufficient data, and free from any subjective or contradictory statements.\n\n### Part 1: Derivation of the Variance Production Model\n\nThe problem concerns the modeling of a term in the transport equation for the Favre-filtered progress-variable variance, $\\widetilde{c''^2}$. The term of interest is the production of variance due to the chemical source term, which we denote as $P_\\omega$. This term is given as $2 \\, \\widetilde{c'' \\dot{\\omega}_c''}$.\n\nThe Favre fluctuation of the progress variable $c$ is defined as $c'' = c - \\tilde{c}$. Similarly, for the source term $\\dot{\\omega}_c$, we have $\\dot{\\omega}_c'' = \\dot{\\omega}_c - \\tilde{\\dot{\\omega}}_c$. The term $\\widetilde{c'' \\dot{\\omega}_c''}$ represents the Favre-filtered covariance of the fluctuations of $c$ and $\\dot{\\omega}_c$. It can be expanded as:\n$$\n\\widetilde{c'' \\dot{\\omega}_c''} = \\widetilde{(c - \\tilde{c})(\\dot{\\omega}_c - \\tilde{\\dot{\\omega}}_c)} = \\widetilde{c \\dot{\\omega}_c - c \\tilde{\\dot{\\omega}}_c - \\tilde{c} \\dot{\\omega}_c + \\tilde{c} \\tilde{\\dot{\\omega}}_c}\n$$\nUsing the linearity of the filtering operator and the property that for any quantities $A$ and $B$, $\\widetilde{\\tilde{A} B} = \\tilde{A} \\tilde{B}$, we can simplify the expression:\n$$\n\\widetilde{c'' \\dot{\\omega}_c''} = \\widetilde{c \\dot{\\omega}_c} - \\widetilde{c \\tilde{\\dot{\\omega}}_c} - \\widetilde{\\tilde{c} \\dot{\\omega}_c} + \\widetilde{\\tilde{c} \\tilde{\\dot{\\omega}}_c} = \\widetilde{c \\dot{\\omega}_c} - \\tilde{c} \\tilde{\\dot{\\omega}}_c - \\tilde{c} \\tilde{\\dot{\\omega}}_c + \\tilde{c} \\tilde{\\dot{\\omega}}_c = \\widetilde{c \\dot{\\omega}_c} - \\tilde{c} \\tilde{\\dot{\\omega}}_c\n$$\nThis resulting expression is precisely the definition provided for the unresolved covariance $\\tau(c, \\dot{\\omega}_c)$. Therefore, we have the identity:\n$$\n\\widetilde{c'' \\dot{\\omega}_c''} = \\tau(c, \\dot{\\omega}_c)\n$$\nThe variance production term is thus $P_\\omega = 2 \\, \\tau(c, \\dot{\\omega}_c)$.\n\nThe problem provides a generalized gradient model for $\\tau(c, \\dot{\\omega}_c)$:\n$$\n\\tau(c, \\dot{\\omega}_c) \\approx C_g \\, \\Delta^2 \\, \\partial_k \\tilde{c} \\, \\partial_k \\tilde{\\dot{\\omega}}_c = C_g \\, \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c)\n$$\nwhere $C_g$ is a dimensionless model coefficient, $\\Delta$ is the filter width, and the gradients are of the filtered quantities.\n\nSubstituting this model into the expression for $P_\\omega$, we obtain the final model expression for the variance production:\n$$\nP_\\omega \\approx 2 \\, C_g \\, \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c)\n$$\n\nTo determine the units of $P_\\omega$, we analyze the units of each term in the expression:\n- $C_g$: dimensionless.\n- $\\Delta$: $\\mathrm{m}$, so $\\Delta^2$: $\\mathrm{m}^2$.\n- The progress variable $\\tilde{c}$ is dimensionless, so its gradient $\\nabla \\tilde{c}$ has units of $\\mathrm{m}^{-1}$.\n- The source term $\\tilde{\\dot{\\omega}}_c$ is a rate and has units of $\\mathrm{s}^{-1}$, so its gradient $\\nabla \\tilde{\\dot{\\omega}}_c$ has units of $\\mathrm{m}^{-1} \\mathrm{s}^{-1}$.\n- The dot product $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c$ has units of $(\\mathrm{m}^{-1}) \\cdot (\\mathrm{m}^{-1} \\mathrm{s}^{-1}) = \\mathrm{m}^{-2} \\mathrm{s}^{-1}$.\n\nThe units of $P_\\omega$ are therefore $(\\mathrm{m}^2) \\cdot (\\mathrm{m}^{-2} \\mathrm{s}^{-1}) = \\mathrm{s}^{-1}$.\n\n### Part 2: Calibration of the Model Coefficient $C_g$\n\nThe coefficient $C_g$ is calibrated by minimizing the sum of squared errors between the DNS data for the covariance, $\\tau_{\\mathrm{DNS}}$, and the model prediction, $\\tau_{\\text{model}} = C_g \\, M$, where $M_i = \\Delta_i^2 \\, (\\nabla \\tilde{c}_i \\cdot \\nabla \\tilde{\\dot{\\omega}}_{c,i})$ for each calibration case $i$.\nThe sum of squared errors is $S = \\sum_{i=1}^{N} (\\tau_{\\mathrm{DNS}, i} - C_g M_i)^2$. To minimize $S$ with respect to $C_g$, we set its derivative to zero:\n$$\n\\frac{dS}{dC_g} = \\sum_{i=1}^{N} 2 (\\tau_{\\mathrm{DNS}, i} - C_g M_i) (-M_i) = 0\n$$\nSolving for the optimal coefficient, $C_g^\\star$:\n$$\nC_g^\\star = \\frac{\\sum_{i=1}^{N} \\tau_{\\mathrm{DNS}, i} M_i}{\\sum_{i=1}^{N} M_i^2}\n$$\nWe first compute the values of $M_i$ for each of the $N=5$ calibration cases.\n- Case 1: $M_1 = (1.0 \\times 10^{-3})^2 (1000 \\cdot 200) = 10^{-6} \\cdot 2 \\times 10^5 = 0.2 \\, \\mathrm{s}^{-1}$.\n- Case 2: $M_2 = (1.5 \\times 10^{-3})^2 (800 \\cdot 50 + 600 \\cdot 30) = 2.25 \\times 10^{-6} \\cdot 58000 = 0.1305 \\, \\mathrm{s}^{-1}$.\n- Case 3: $M_3 = (0.8 \\times 10^{-3})^2 (-500 \\cdot 200 + 400 \\cdot (-120) + 100 \\cdot 40) = 0.64 \\times 10^{-6} \\cdot (-144000) = -0.09216 \\, \\mathrm{s}^{-1}$.\n- Case 4: $M_4 = (1.2 \\times 10^{-3})^2 (1000 \\cdot 100) = 1.44 \\times 10^{-6} \\cdot 10^5 = 0.144 \\, \\mathrm{s}^{-1}$.\n- Case 5: $M_5 = (1.0 \\times 10^{-3})^2 (300 \\cdot (-150) - 400 \\cdot 200 + 500 \\cdot (-250)) = 10^{-6} \\cdot (-250000) = -0.25 \\, \\mathrm{s}^{-1}$.\n\nAn inspection reveals that the provided DNS data, $\\tau_{\\mathrm{DNS},i}$, corresponds exactly to the model prediction with a constant coefficient $C_g = 1/12 \\approx 0.08333...$:\n- Case 1: $(1/12) M_1 = 0.2/12 = 1/60 \\approx 0.01666...$, matching $\\tau_{\\mathrm{DNS},1}$.\n- Case 2: $(1/12) M_2 = 0.1305/12 = 0.010875$, matching $\\tau_{\\mathrm{DNS},2}$.\n- Case 3: $(1/12) M_3 = -0.09216/12 = -0.00768$, matching $\\tau_{\\mathrm{DNS},3}$.\n- Case 4: $(1/12) M_4 = 0.144/12 = 0.012$, matching $\\tau_{\\mathrm{DNS},4}$.\n- Case 5: $(1/12) M_5 = -0.25/12 = -1/48 \\approx -0.020833...$, matching $\\tau_{\\mathrm{DNS},5}$.\nSince the error is zero for each data point with $C_g = 1/12$, the least-squares minimization procedure will yield exactly this value. Thus, $C_g^\\star = 1/12$.\n\n### Part 3: Prediction of Variance Production for Test Cases\n\nWith the calibrated coefficient $C_g^\\star = 1/12$, the model for the variance production is:\n$$\nP_\\omega = 2 \\cdot \\frac{1}{12} \\cdot \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c) = \\frac{1}{6} \\Delta^2 \\, (\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c)\n$$\nWe apply this formula to each test case.\n- **Test A**:\n  - $\\Delta^2 = (1.1 \\times 10^{-3})^2 = 1.21 \\times 10^{-6} \\, \\mathrm{m}^2$.\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (700 \\cdot 70 + 200 \\cdot 40 + 100 \\cdot 10) = 49000 + 8000 + 1000 = 58000 \\, \\mathrm{m}^{-2} \\mathrm{s}^{-1}$.\n  - $P_{\\omega,A} = \\frac{1}{6} (1.21 \\times 10^{-6})(58000) = \\frac{0.07018}{6} \\approx 0.0116966... \\, \\mathrm{s}^{-1}$.\n\n- **Test B**:\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (1000 \\cdot 0) = 0$.\n  - $P_{\\omega,B} = 0 \\, \\mathrm{s}^{-1}$.\n\n- **Test C**:\n  - $\\Delta^2 = (0.9 \\times 10^{-3})^2 = 0.81 \\times 10^{-6} \\, \\mathrm{m}^2$.\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (400 \\cdot (-100)) = -40000 \\, \\mathrm{m}^{-2} \\mathrm{s}^{-1}$.\n  - $P_{\\omega,C} = \\frac{1}{6} (0.81 \\times 10^{-6})(-40000) = \\frac{-0.0324}{6} = -0.0054 \\, \\mathrm{s}^{-1}$.\n\n- **Test D**:\n  - $\\Delta^2 = (2.0 \\times 10^{-3})^2 = 4.0 \\times 10^{-6} \\, \\mathrm{m}^2$.\n  - $\\nabla \\tilde{c} \\cdot \\nabla \\tilde{\\dot{\\omega}}_c = (500 \\cdot 50 + 500 \\cdot 50) = 25000 + 25000 = 50000 \\, \\mathrm{m}^{-2} \\mathrm{s}^{-1}$.\n  - $P_{\\omega,D} = \\frac{1}{6} (4.0 \\times 10^{-6})(50000) = \\frac{0.2}{6} = \\frac{1}{30} \\approx 0.033333... \\, \\mathrm{s}^{-1}$.\n\nThe following code will perform these computations programmatically.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, calibrates, and applies a subgrid model for progress-variable\n    variance production in LES of turbulent combustion.\n    \"\"\"\n\n    # ----------------------------------------------------------------------\n    # Part 1: Calibration of the model coefficient C_g\n    # ----------------------------------------------------------------------\n\n    # The model for the unresolved covariance is:\n    # tau_model = Cg * M, where M = Delta^2 * (grad(c) . grad(omega_c))\n    # We calibrate Cg using the provided DNS dataset.\n\n    calibration_cases = [\n        # (Delta, grad_c, grad_omega_c, tau_dns)\n        (1.0e-3, np.array([1000, 0, 0]), np.array([200, 0, 0]), 1.6666666666666668e-2),\n        (1.5e-3, np.array([800, 600, 0]), np.array([50, 30, 0]), 1.0875e-2),\n        (0.8e-3, np.array([-500, 400, 100]), np.array([200, -120, 40]), -7.68e-3),\n        (1.2e-3, np.array([0, 1000, 0]), np.array([0, 100, 0]), 1.2e-2),\n        (1.0e-3, np.array([300, -400, 500]), np.array([-150, 200, -250]), -2.0833333333333334e-2),\n    ]\n\n    M_cal = []\n    tau_dns_cal = []\n\n    for case in calibration_cases:\n        delta, grad_c, grad_omega_c, tau_dns = case\n        dot_product = np.dot(grad_c, grad_omega_c)\n        M = delta**2 * dot_product\n        M_cal.append(M)\n        tau_dns_cal.append(tau_dns)\n\n    M_cal_vec = np.array(M_cal)\n    tau_dns_cal_vec = np.array(tau_dns_cal)\n\n    # The optimal coefficient Cg* is found by minimizing the sum of\n    # squared errors, leading to the least-squares formula:\n    # Cg* = sum(tau_i * M_i) / sum(M_i^2)\n    # Using np.dot for vectorized summation.\n    sum_tau_M = np.dot(tau_dns_cal_vec, M_cal_vec)\n    sum_M_sq = np.dot(M_cal_vec, M_cal_vec)\n\n    # Since the data is noise-free, any non-zero M_i can determine Cg.\n    # Cg_star = tau_dns_cal_vec[0] / M_cal_vec[0]\n    # For robustness and generality, use the least-squares formula.\n    if sum_M_sq == 0:\n        # Avoid division by zero, although not expected for this dataset\n        Cg_star = 0.0\n    else:\n        Cg_star = sum_tau_M / sum_M_sq\n\n    # ----------------------------------------------------------------------\n    # Part 2: Prediction for the test cases\n    # ----------------------------------------------------------------------\n    \n    # The production term model is P_omega = 2 * Cg* * Delta^2 * (grad(c) . grad(omega_c))\n    \n    test_cases = [\n        # (Delta, grad_c, grad_omega_c)\n        (1.1e-3, np.array([700, 200, 100]), np.array([70, 40, 10])), # Test A\n        (1.0e-3, np.array([1000, 0, 0]), np.array([0, 0, 0])),        # Test B\n        (0.9e-3, np.array([400, 0, 0]), np.array([-100, 0, 0])),      # Test C\n        (2.0e-3, np.array([500, 500, 0]), np.array([50, 50, 0])),       # Test D\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, grad_c, grad_omega_c = case\n        dot_product = np.dot(grad_c, grad_omega_c)\n        \n        # P_omega = 2 * Cg_star * M\n        M = delta**2 * dot_product\n        p_omega = 2.0 * Cg_star * M\n        results.append(p_omega)\n    \n    # Format the final output as specified\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}