{
    "hands_on_practices": [
        {
            "introduction": "The introduction of an elliptic operator brings a new length scale, $L$, into the turbulence model, which must be resolved by the computational grid. This exercise  provides a practical method for determining the necessary near-wall grid resolution. By analyzing the truncation error of a simplified one-dimensional model, you will derive the relationship between the grid spacing, $\\Delta y$, the model's length scale, and the desired numerical accuracy, ensuring your simulation is set up for success.",
            "id": "3314002",
            "problem": "Consider a one-dimensional wall-normal slice of a turbulent boundary layer in which the near-wall turbulence is modeled by an elliptic relaxation equation for a generic relaxation variable $f$ as used in wall-normal velocity variance damping ($v^2-f$) approaches. In the viscous sublayer and buffer region, the homogeneous part of the elliptic relaxation behavior is well represented by the wall-normal ordinary differential equation\n$$\nL^2 \\frac{d^2 f}{dy^2} - f \\approx 0,\n$$\nwhere $y$ is the wall-normal coordinate with $y=0$ at the wall, and $L$ is an elliptic relaxation length scale that is positive and varies slowly enough near the wall to be treated as constant over the relaxation layer. The physically relevant solution near the wall is exponentially decaying, so that $f$ decreases appreciably over a length of order $L$.\n\nYou must design a wall-normal grid that resolves the elliptic relaxation layer in the sense that the local truncation error induced by a second-order central-difference approximation of the second derivative remains below a prescribed relative tolerance $\\varepsilon$ when compared to the characteristic magnitude of the elliptic operator acting on $f$. The central-difference approximation for the second derivative at uniform spacing $\\Delta y$ has a local truncation error proportional to $\\Delta y^2$ times the fourth derivative. For the exponential solution, the ratio of the truncation error contribution $L^2 \\left(\\text{truncation error of } d^2 f/dy^2\\right)$ to the characteristic operator magnitude $f$ is approximately\n$$\n\\left(\\frac{\\Delta y^2}{12}\\right)\\frac{1}{L^2}.\n$$\nImpose the requirement that this ratio is less than or equal to the prescribed tolerance $\\varepsilon$, and determine a bound on the uniform spacing $\\Delta y$ sufficient to ensure the error constraint throughout the relaxation layer.\n\nDefine the dimensionless wall unit $y^+$ using the standard turbulent wall scaling $y^+ = y u_\\tau / \\nu$, where $u_\\tau$ is the friction velocity and $\\nu$ is the kinematic viscosity. Assume a cell-centered discretization in which the first interior point resides at $y = \\Delta y/2$. The relaxation layer extent to be resolved is defined as the distance $y_\\alpha$ at which the exponential solution has decayed to a prescribed fraction $\\alpha$ of its wall-adjacent magnitude. Using the exponential decay model, this relaxation layer extent is\n$$\ny_\\alpha = L \\ln\\left(\\frac{1}{\\alpha}\\right).\n$$\n\nYour task is to, for each test case below:\n- Derive and then compute the maximum permissible uniform spacing $\\Delta y$ that satisfies the truncation error requirement.\n- Compute the first-cell-center wall unit $y^+_{\\text{first}} = (\\Delta y/2) u_\\tau / \\nu$ (dimensionless).\n- Determine the minimal integer number of uniformly spaced points $N_{\\text{relax}}$ needed to cover the relaxation layer thickness $y_\\alpha$ using spacing $\\Delta y$, that is\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{y_\\alpha}{\\Delta y} \\right\\rceil.\n$$\n\nAssume that outside the relaxation layer the clustering can be relaxed, so you only need to report the uniform near-wall clustering within $0 \\le y \\le y_\\alpha$.\n\nExpress the first-cell $y^+$ value as a decimal number (dimensionless), and the number of points $N_{\\text{relax}}$ as an integer. No angles are used in this problem. All given input parameters below use the International System of Units (SI): wall-normal lengths in meters, kinematic viscosity in $\\mathrm{m^2/s}$, friction velocity in $\\mathrm{m/s}$, tolerance and fraction as dimensionless decimals.\n\nTest suite:\n1. Case A (air-like boundary layer):\n   - $u_\\tau = 0.5~\\mathrm{m/s}$,\n   - $\\nu = 1.5\\times 10^{-5}~\\mathrm{m^2/s}$,\n   - $L = 1.2\\times 10^{-3}~\\mathrm{m}$,\n   - $\\delta = 5.0\\times 10^{-2}~\\mathrm{m}$ (outer boundary layer thickness, given for context),\n   - $\\varepsilon = 1.0\\times 10^{-4}$,\n   - $\\alpha = 1.0\\times 10^{-2}$.\n2. Case B (water-like boundary layer):\n   - $u_\\tau = 4.0\\times 10^{-2}~\\mathrm{m/s}$,\n   - $\\nu = 1.0\\times 10^{-6}~\\mathrm{m^2/s}$,\n   - $L = 2.5\\times 10^{-4}~\\mathrm{m}$,\n   - $\\delta = 1.5\\times 10^{-2}~\\mathrm{m}$,\n   - $\\varepsilon = 5.0\\times 10^{-5}$,\n   - $\\alpha = 1.0\\times 10^{-3}$.\n3. Case C (low-speed air-like boundary layer):\n   - $u_\\tau = 2.0\\times 10^{-1}~\\mathrm{m/s}$,\n   - $\\nu = 1.8\\times 10^{-5}~\\mathrm{m^2/s}$,\n   - $L = 8.0\\times 10^{-4}~\\mathrm{m}$,\n   - $\\delta = 3.0\\times 10^{-2}~\\mathrm{m}$,\n   - $\\varepsilon = 2.0\\times 10^{-4}$,\n   - $\\alpha = 2.0\\times 10^{-2}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-item list $[y^+_{\\text{first}}, N_{\\text{relax}}]$ corresponding to each test case in the order listed above. For example, the output format must be\n$$\n[ [y^+_{\\text{first},A}, N_{\\text{relax},A}], [y^+_{\\text{first},B}, N_{\\text{relax},B}], [y^+_{\\text{first},C}, N_{\\text{relax},C}] ].\n$$\nRound each $y^+_{\\text{first}}$ to $6$ decimal places. The integers $N_{\\text{relax}}$ must be exact.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of computational fluid dynamics and turbulence modeling, is well-posed with a complete and consistent set of definitions and data, and is expressed in objective, formal language. The provided physical parameters are realistic for the specified flow conditions. The task is to derive and compute grid resolution requirements for a simplified near-wall turbulence model.\n\nThe derivation proceeds in three steps for each test case: a) determining the maximum permissible uniform grid spacing $\\Delta y$, b) calculating the dimensionless first-cell-center wall coordinate $y^+_{\\text{first}}$, and c) finding the minimum number of grid points $N_{\\text{relax}}$ to resolve the near-wall relaxation layer.\n\nThe governing ordinary differential equation for the relaxation variable $f$ in the near-wall region is given as:\n$$\nL^2 \\frac{d^2 f}{dy^2} - f \\approx 0\n$$\nwhere $y$ is the wall-normal coordinate, and $L$ is the constant elliptic relaxation length scale. The physically relevant solution is an exponential decay, $f(y) \\propto e^{-y/L}$.\n\n**Step 1: Derivation of the Maximum Grid Spacing $\\Delta y$**\n\nThe problem states a requirement on the local truncation error of the numerical scheme. The ratio of the truncation error contribution from a second-order central difference scheme to the characteristic magnitude of the operator is given as approximately $\\left(\\frac{\\Delta y^2}{12}\\right)\\frac{1}{L^2}$. This ratio must be less than or equal to a prescribed relative tolerance $\\varepsilon$. We establish the constraint:\n$$\n\\frac{(\\Delta y)^2}{12 L^2} \\le \\varepsilon\n$$\nTo find the maximum permissible spacing, we solve this inequality for $\\Delta y$:\n$$\n(\\Delta y)^2 \\le 12 \\varepsilon L^2\n$$\nSince $\\Delta y$ must be a positive length, we take the square root of both sides:\n$$\n\\Delta y \\le \\sqrt{12 \\varepsilon L^2}\n$$\nThe maximum uniform spacing, which we will use for our grid, is therefore:\n$$\n\\Delta y_{\\text{max}} = L \\sqrt{12 \\varepsilon}\n$$\nFor the remainder of the analysis, we set the grid spacing $\\Delta y = \\Delta y_{\\text{max}}$.\n\n**Step 2: Calculation of the First-Cell-Center Wall Unit $y^+_{\\text{first}}$**\n\nThe dimensionless wall unit, $y^+$, is defined as:\n$$\ny^+ = \\frac{y u_\\tau}{\\nu}\n$$\nwhere $u_\\tau$ is the friction velocity and $\\nu$ is the kinematic viscosity. The problem specifies a cell-centered discretization where the first interior point is located at $y_{\\text{first}} = \\Delta y / 2$. Substituting this into the definition of $y^+$ gives the first-cell-center wall unit, $y^+_{\\text{first}}$:\n$$\ny^+_{\\text{first}} = \\frac{(\\Delta y / 2) u_\\tau}{\\nu} = \\frac{\\Delta y u_\\tau}{2 \\nu}\n$$\nSubstituting the expression for $\\Delta y = \\Delta y_{\\text{max}}$ yields:\n$$\ny^+_{\\text{first}} = \\frac{(L \\sqrt{12 \\varepsilon}) u_\\tau}{2 \\nu}\n$$\n\n**Step 3: Determination of the Minimal Number of Points $N_{\\text{relax}}$**\n\nThe relaxation layer is defined by its thickness $y_\\alpha$, the distance from the wall at which the solution $f$ decays to a fraction $\\alpha$ of its wall-adjacent value. This is given by:\n$$\ny_\\alpha = L \\ln\\left(\\frac{1}{\\alpha}\\right)\n$$\nThe number of uniformly spaced grid cells of size $\\Delta y$ required to cover this distance is the ratio $y_\\alpha / \\Delta y$. Since the number of points must be an integer and must cover the entire layer, we take the ceiling of this ratio:\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{y_\\alpha}{\\Delta y} \\right\\rceil\n$$\nSubstituting the expressions for $y_\\alpha$ and $\\Delta y = \\Delta y_{\\text{max}}$:\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{L \\ln(1/\\alpha)}{L \\sqrt{12 \\varepsilon}} \\right\\rceil = \\left\\lceil \\frac{\\ln(1/\\alpha)}{\\sqrt{12 \\varepsilon}} \\right\\rceil\n$$\nThis result shows that the number of points required to resolve the relaxation layer is independent of the specific length scale $L$ and flow parameters $u_\\tau$ and $\\nu$, depending only on the numerical tolerance $\\varepsilon$ and the decay definition $\\alpha$.\n\n**Calculations for Test Cases**\n\nThe derived formulas are now applied to the three specified test cases.\n\n**Case A:**\nGiven parameters: $u_\\tau = 0.5~\\mathrm{m/s}$, $\\nu = 1.5 \\times 10^{-5}~\\mathrm{m^2/s}$, $L = 1.2 \\times 10^{-3}~\\mathrm{m}$, $\\varepsilon = 1.0 \\times 10^{-4}$, $\\alpha = 1.0 \\times 10^{-2}$.\n$$\n\\Delta y = (1.2 \\times 10^{-3}) \\sqrt{12 \\times (1.0 \\times 10^{-4})} \\approx 4.15692 \\times 10^{-5}~\\mathrm{m}\n$$\n$$\ny^+_{\\text{first}} = \\frac{(4.15692 \\times 10^{-5}) \\times 0.5}{2 \\times (1.5 \\times 10^{-5})} \\approx 0.692820\n$$\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{\\ln(1 / (1.0 \\times 10^{-2}))}{\\sqrt{12 \\times (1.0 \\times 10^{-4})}} \\right\\rceil = \\left\\lceil \\frac{\\ln(100)}{\\sqrt{0.0012}} \\right\\rceil = \\lceil 132.937 \\rceil = 133\n$$\n\n**Case B:**\nGiven parameters: $u_\\tau = 4.0 \\times 10^{-2}~\\mathrm{m/s}$, $\\nu = 1.0 \\times 10^{-6}~\\mathrm{m^2/s}$, $L = 2.5 \\times 10^{-4}~\\mathrm{m}$, $\\varepsilon = 5.0 \\times 10^{-5}$, $\\alpha = 1.0 \\times 10^{-3}$.\n$$\n\\Delta y = (2.5 \\times 10^{-4}) \\sqrt{12 \\times (5.0 \\times 10^{-5})} \\approx 6.12372 \\times 10^{-6}~\\mathrm{m}\n$$\n$$\ny^+_{\\text{first}} = \\frac{(6.12372 \\times 10^{-6}) \\times (4.0 \\times 10^{-2})}{2 \\times (1.0 \\times 10^{-6})} \\approx 0.122474\n$$\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{\\ln(1 / (1.0 \\times 10^{-3}))}{\\sqrt{12 \\times (5.0 \\times 10^{-5})}} \\right\\rceil = \\left\\lceil \\frac{\\ln(1000)}{\\sqrt{0.0006}} \\right\\rceil = \\lceil 281.996 \\rceil = 282\n$$\n\n**Case C:**\nGiven parameters: $u_\\tau = 2.0 \\times 10^{-1}~\\mathrm{m/s}$, $\\nu = 1.8 \\times 10^{-5}~\\mathrm{m^2/s}$, $L = 8.0 \\times 10^{-4}~\\mathrm{m}$, $\\varepsilon = 2.0 \\times 10^{-4}$, $\\alpha = 2.0 \\times 10^{-2}$.\n$$\n\\Delta y = (8.0 \\times 10^{-4}) \\sqrt{12 \\times (2.0 \\times 10^{-4})} \\approx 3.91918 \\times 10^{-5}~\\mathrm{m}\n$$\n$$\ny^+_{\\text{first}} = \\frac{(3.91918 \\times 10^{-5}) \\times (2.0 \\times 10^{-1})}{2 \\times (1.8 \\times 10^{-5})} \\approx 0.217732\n$$\n$$\nN_{\\text{relax}} = \\left\\lceil \\frac{\\ln(1 / (2.0 \\times 10^{-2}))}{\\sqrt{12 \\times (2.0 \\times 10^{-4})}} \\right\\rceil = \\left\\lceil \\frac{\\ln(50)}{\\sqrt{0.0024}} \\right\\rceil = \\lceil 79.853 \\rceil = 80\n$$\n\nThese calculations yield the required values for each test case, which will be formatted into the final program output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates near-wall grid resolution requirements for an elliptic relaxation model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (u_tau, nu, L, epsilon, alpha)\n    test_cases = [\n        # Case A (air-like boundary layer)\n        (0.5, 1.5e-5, 1.2e-3, 1.0e-4, 1.0e-2),\n        # Case B (water-like boundary layer)\n        (4.0e-2, 1.0e-6, 2.5e-4, 5.0e-5, 1.0e-3),\n        # Case C (low-speed air-like boundary layer)\n        (2.0e-1, 1.8e-5, 8.0e-4, 2.0e-4, 2.0e-2),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        u_tau, nu, L, epsilon, alpha = case\n\n        # Step 1: Compute the maximum permissible uniform spacing delta_y\n        # delta_y <= L * sqrt(12 * epsilon)\n        delta_y = L * np.sqrt(12 * epsilon)\n\n        # Step 2: Compute the first-cell-center wall unit y_plus_first\n        # y_plus_first = (delta_y / 2) * u_tau / nu\n        y_plus_first = (delta_y * u_tau) / (2 * nu)\n\n        # Step 3: Determine the minimal integer number of points N_relax\n        # N_relax = ceil(y_alpha / delta_y), where y_alpha = L * ln(1/alpha)\n        # This simplifies to ceil(ln(1/alpha) / sqrt(12 * epsilon))\n        n_relax = np.ceil(np.log(1 / alpha) / np.sqrt(12 * epsilon))\n\n        # Format the results as specified:\n        # - y_plus_first rounded to 6 decimal places.\n        # - n_relax as an integer.\n        # The result for each case is a two-item list.\n        result = [round(y_plus_first, 6), int(n_relax)]\n        results.append(result)\n\n    # Final print statement in the exact required format: [[y1, N1], [y2, N2], ...]\n    # The default string representation of a list of lists in Python matches the required output format.\n    print(results)\n\nsolve()\n```"
        },
        {
            "introduction": "With an understanding of the necessary grid resolution, the next step is to solve the core elliptic relaxation equation itself. This practice  guides you through the numerical solution of the two-dimensional screened Poisson equation that governs the relaxation variable $\\alpha$. You will implement a finite-volume discretization to handle the spatially varying length scale, gaining hands-on experience with assembling and solving the resulting linear system, which is a cornerstone of modern CFD.",
            "id": "3313959",
            "problem": "Consider an elliptic relaxation model for near-wall turbulence in a two-dimensional steady boundary layer over a flat plate. Let the relaxation variable be denoted by $\\,\\alpha(x,y)\\,$ and the relaxation length-scale be specified by a known field $\\,L(x,y)\\,.$ The steady nonlocal relaxation is modeled through the linear elliptic partial differential equation\n$$\n\\nabla\\cdot\\left(L^2(x,y)\\,\\nabla \\alpha(x,y)\\right) - \\alpha(x,y) \\;=\\; -\\,\\alpha_{\\mathrm{eq}}(x,y),\n$$\nposed on a rectangular domain $\\,[0,L_x]\\times[0,L_y]\\,$ with the following boundary conditions consistent with a flat-plate boundary layer: a no-slip wall at $\\,y=0\\,$ implies a Dirichlet condition $\\,\\alpha(x,0)=0\\,$; a symmetry or free-stream condition at the outer boundary $\\,y=L_y\\,$ implies a homogeneous Neumann condition $\\,\\partial \\alpha/\\partial y=0\\,$; an inflow at $\\,x=0\\,$ implies a homogeneous Neumann condition $\\,\\partial \\alpha/\\partial x=0\\,$; and an outflow at $\\,x=L_x\\,$ implies a homogeneous Neumann condition $\\,\\partial \\alpha/\\partial x=0\\,$. The equilibrium target is prescribed as\n$$\n\\alpha_{\\mathrm{eq}}(x,y) \\;=\\; \\alpha_\\infty\\left(1-\\exp\\!\\left(-\\dfrac{y}{c_\\delta\\,\\delta(x)}\\right)\\right),\n$$\nwhere the laminar boundary layer thickness proxy is\n$$\n\\delta(x) \\;=\\; C_\\delta \\,\\sqrt{\\dfrac{\\nu\\,x}{U_\\infty}}.\n$$\nHere $\\,U_\\infty\\,$ is the free-stream speed, $\\,\\nu\\,$ is the kinematic viscosity, $\\,\\alpha_\\infty\\,$ is a dimensionless outer equilibrium value, and $\\,C_\\delta\\,$ and $\\,c_\\delta\\,$ are dimensionless constants.\n\nYour task is to compute $\\,\\alpha(x,y)\\,$ numerically on a uniform, structured grid using a conservative second-order finite-volume discretization with face-centered diffusion coefficients formed by the harmonic mean of neighboring cell-centered values of $\\,L^2(x,y)\\,.$ Use control volumes centered at grid points, with grid spacings $\\,\\Delta x=L_x/(N_x-1)\\,$ and $\\,\\Delta y=L_y/(N_y-1)\\,.$ Implement the homogeneous Neumann conditions by enforcing zero normal diffusive flux across the corresponding boundary faces; implement the Dirichlet condition by pointwise enforcement at the wall nodes. Assemble the resulting sparse linear system and solve for the interior unknowns. Assume $\\,\\alpha_\\infty=1\\,$ and $\\,c_\\delta=1\\,$.\n\nTo interpret the computed $\\,\\alpha(x,y)\\,$ field relative to the boundary layer thickness, define for three streamwise stations $\\,x\\in\\{x_1,x_2,x_3\\}\\,$ the penetration height $\\,y_{95}(x)\\,$ as the smallest wall-normal location where $\\,\\alpha(x,y)\\ge 0.95\\,\\alpha(x,L_y)\\,.$ Compute the dimensionless ratio\n$$\nr(x)\\;=\\;\\dfrac{y_{95}(x)}{\\delta(x)},\n$$\nand report, for each test case below, the arithmetic mean of the three ratios across the specified stations, i.e.,\n$$\n\\bar r \\;=\\;\\dfrac{1}{3}\\sum_{m=1}^3 r(x_m).\n$$\n\nUse the following physical and numerical parameters throughout: $\\,U_\\infty=10\\,,$ $\\,\\nu=1.5\\times 10^{-5}\\,,$ $\\,L_x=1.0\\,,$ $\\,L_y=0.2\\,,$ $\\,N_x=81\\,,$ $\\,N_y=81\\,,$ $\\,C_\\delta=5.0\\,,$ $\\,x_1=0.1\\,,$ $\\,x_2=0.5\\,,$ $\\,x_3=0.9\\,.$ The relaxation length $\\,L(x,y)\\,$ differs across cases as specified below.\n\nTest suite to implement and evaluate:\n- Case A (happy path, wall-scaling with saturation): $\\,L(x,y)=\\min\\{\\kappa\\,y,\\,L_\\infty\\}\\,$ with $\\,\\kappa=0.41\\,$ and $\\,L_\\infty=0.03\\,$.\n- Case B (edge case, very small saturation scale): $\\,L(x,y)=\\min\\{\\kappa\\,y,\\,L_\\infty\\}\\,$ with $\\,\\kappa=0.41\\,$ and $\\,L_\\infty=0.001\\,$.\n- Case C (coverage case, uniform relaxation scale): $\\,L(x,y)=L_0\\,$ with $\\,L_0=0.03\\,$.\n\nYour program must:\n- Discretize and solve the stated elliptic problem for each case on the same grid.\n- Compute $\\,\\bar r\\,$ for each case as defined above.\n- Produce a single line of output containing the three results as a comma-separated list enclosed in square brackets, with each number rounded to six decimal places, in the order Case A, Case B, Case C (for example, $[a,b,c]$).\n\nBecause the requested outputs are dimensionless ratios, no physical units are required in the final numerical output. The program must be self-contained and not rely on any external input.",
            "solution": "The user has provided a well-posed problem from the field of computational fluid dynamics, specifically concerning elliptic relaxation models for near-wall turbulence. The problem is scientifically grounded, self-contained, and all parameters are defined. The validation is passed, and we may proceed to the solution.\n\nThe problem requires a numerical solution to the steady, linear, elliptic partial differential equation (PDE):\n$$\n\\nabla\\cdot\\left(L^2(x,y)\\,\\nabla \\alpha(x,y)\\right) - \\alpha(x,y) = -\\,\\alpha_{\\mathrm{eq}}(x,y)\n$$\nThis equation models a nonlocal relaxation process for a turbulence variable $\\alpha(x,y)$. The term $L^2(x,y)$ is the squared relaxation length, acting as a spatially varying diffusion coefficient. The term $-\\alpha(x,y)$ is a local sink or \"relaxation\" term, and $\\alpha_{\\mathrm{eq}}(x,y)$ is the prescribed equilibrium state towards which $\\alpha$ relaxes.\n\nThe solution will be obtained using a second-order, conservative finite-volume method on a uniform, node-centered grid. The domain $[0,L_x]\\times[0,L_y]$ is discretized into $N_x \\times N_y$ nodes, with spacings $\\Delta x = L_x/(N_x-1)$ and $\\Delta y = L_y/(N_y-1)$.\n\nA control volume (CV) is defined around each grid node $(i,j)$, located at $(x_i, y_j)$. The PDE is integrated over each CV. For an interior CV, this yields:\n$$\n\\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\left[ \\nabla\\cdot(D\\nabla \\alpha) - \\alpha \\right] dx\\,dy = \\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} (-\\alpha_{\\mathrm{eq}}) dx\\,dy\n$$\nwhere $D(x,y) = L^2(x,y)$. Applying the divergence theorem and approximating the integrals with midpoint rule values (i.e., cell-centered values) leads to a balance of fluxes across the CV faces and the integrated source/sink terms:\n$$\n(F_e - F_w) + (F_n - F_s) - \\alpha_{i,j}\\Delta x\\Delta y = -\\alpha_{\\mathrmeq, i,j}\\Delta x\\Delta y\n$$\nHere, $F_e, F_w, F_n, F_s$ are the total diffusive fluxes out of the east, west, north, and south faces, respectively. For the east face, for example, the flux is $F_e = D_e (\\partial\\alpha/\\partial x)_e \\Delta y$, where $D_e$ is the diffusion coefficient at the face. The derivatives are approximated by central differences, e.g., $(\\partial\\alpha/\\partial x)_e \\approx (\\alpha_{i+1,j} - \\alpha_{i,j})/\\Delta x$. The problem specifies that face-centered diffusion coefficients are computed using the harmonic mean of the neighboring cell-centered values, e.g., $D_e = 2D_{i,j}D_{i+1,j}/(D_{i,j}+D_{i+1,j})$.\n\nCombining these approximations and dividing by the CV volume $\\Delta x \\Delta y$ yields a linear algebraic equation for each unknown $\\alpha_{i,j}$:\n$$\na_W \\alpha_{i-1,j} + a_E \\alpha_{i+1,j} + a_S \\alpha_{i,j-1} + a_N \\alpha_{i,j+1} + a_P \\alpha_{i,j} = -\\alpha_{\\mathrmeq,i,j}\n$$\nwhere the coefficients are defined as:\n$a_W = D_w/\\Delta x^2$, $a_E = D_e/\\Delta x^2$, $a_S = D_s/\\Delta y^2$, $a_N = D_n/\\Delta y^2$, and the central coefficient is $a_P = -(a_W+a_E+a_S+a_N+1)$. The term '$-1$' in $a_P$ arises from the relaxation term $-\\alpha$ in the PDE.\n\nThe boundary conditions are incorporated as follows:\n1.  **Dirichlet at $y=0$**: The condition $\\alpha(x,0)=0$ is enforced by setting $\\alpha_{i,0}=0$ for all $i=0,\\dots,N_x-1$. These nodes are not unknowns. For the adjacent nodes at $j=1$, the south-neighbor term $a_S \\alpha_{i,0}$ is a known quantity (zero in this case) and is moved to the right-hand side of the algebraic equation. A key physical detail is that for Cases A and B, $L(x,0)=0$, which implies $D(x,0)=0$. The harmonic mean for $D_s$ at the face between $j=1$ and $j=0$ becomes zero, automatically decoupling the $j=1$ nodes from the wall in the diffusion term.\n2.  **Homogeneous Neumann at $x=0, x=L_x, y=L_y$**: The condition of zero normal diffusive flux is implemented using a ghost-cell technique. For example, at the left boundary $x=0$, a ghost node at $i=-1$ is assumed to have the value $\\alpha_{-1,j} = \\alpha_{0,j}$. The west-going flux for a cell at $i=0$ is proportional to $D_w (\\alpha_{0,j} - \\alpha_{-1,j})$, which becomes zero. This effectively removes the west-neighbor coupling, and a corresponding modification is made to the stencil for the boundary node. Specifically, the $a_W$ term vanishes from the equation. The same logic is applied to the east and north boundaries.\n\nThese discrete equations define a large, sparse, diagonally dominant linear system of the form $\\mathbf{A}\\mathbf{x}=\\mathbf{b}$, where $\\mathbf{x}$ is a vector of the $N_x \\times (N_y-1)$ unknown nodal values of $\\alpha$. This system is assembled and then solved efficiently using a sparse direct solver, `scipy.sparse.linalg.spsolve`.\n\nAfter obtaining the solution field $\\alpha(x,y)$, the following post-processing steps are performed for each case:\n1.  At each specified streamwise station $x_m \\in \\{0.1, 0.5, 0.9\\}$, the corresponding column index $i_m$ is identified.\n2.  The vertical profile $\\alpha(x_m, y)$ is extracted. The local outer value is $\\alpha(x_m, L_y) = \\alpha_{i_m, N_y-1}$.\n3.  The penetration height $y_{95}(x_m)$ is found, defined as the $y$-location where $\\alpha$ reaches $95\\%$ of its outer value. This is computed using linear interpolation on the discrete profile.\n4.  The local boundary layer thickness proxy $\\delta(x_m) = C_\\delta \\sqrt{\\nu x_m / U_\\infty}$ is calculated.\n5.  The dimensionless ratio $r(x_m) = y_{95}(x_m)/\\delta(x_m)$ is computed.\n6.  The final reported value, $\\bar{r}$, is the arithmetic mean of the three ratios $r(x_1)$, $r(x_2)$, and $r(x_3)$.\n\nThis procedure is repeated for each of the three test cases, which vary the definition of the relaxation length scale $L(x,y)$, and the resulting $\\bar{r}$ values are reported.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the solution for the three test cases\n    and print the final output in the required format.\n    \"\"\"\n    test_cases = [\n        {'type': 'A', 'kappa': 0.41, 'L_inf': 0.03},\n        {'type': 'B', 'kappa': 0.41, 'L_inf': 0.001},\n        {'type': 'C', 'L0': 0.03}\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = solve_case(case_params)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef solve_case(case_params):\n    \"\"\"\n    Discretizes and solves the elliptic PDE for a single test case,\n    then computes and returns the required average ratio.\n    \"\"\"\n    # Physical and numerical parameters\n    U_inf = 10.0\n    nu = 1.5e-5\n    Lx = 1.0\n    Ly = 0.2\n    Nx = 81\n    Ny = 81\n    C_delta = 5.0\n    alpha_inf = 1.0\n    c_delta = 1.0\n    x_stations = np.array([0.1, 0.5, 0.9])\n\n    # Grid setup\n    dx = Lx / (Nx - 1)\n    dy = Ly / (Ny - 1)\n    x = np.linspace(0, Lx, Nx)\n    y = np.linspace(0, Ly, Ny)\n    X, Y = np.meshgrid(x, y, indexing='ij')\n\n    # Pre-calculate auxiliary fields: delta(x), alpha_eq(x,y), L(x,y), D(x,y)\n    delta_x = np.zeros_like(x)\n    non_zero_x_mask = x > 0\n    delta_x[non_zero_x_mask] = C_delta * np.sqrt(nu * x[non_zero_x_mask] / U_inf)\n\n    alpha_eq = np.zeros((Nx, Ny))\n    for i in range(Nx):\n        if delta_x[i] > 1e-15:\n            alpha_eq[i, 1:] = alpha_inf * (1.0 - np.exp(-y[1:] / (c_delta * delta_x[i])))\n        else: # Handle x=0 where delta=0\n            alpha_eq[i, 1:] = alpha_inf\n    # By default, alpha_eq(x,0) remains 0.\n\n    case_type = case_params.get('type')\n    if case_type in ['A', 'B']:\n        kappa = case_params['kappa']\n        L_inf = case_params['L_inf']\n        L = np.minimum(kappa * Y, L_inf)\n    elif case_type == 'C':\n        L0 = case_params['L0']\n        L = np.full((Nx, Ny), L0)\n    \n    D = L**2\n\n    # Assemble the sparse linear system A*x=b\n    num_unknowns = Nx * (Ny - 1)\n    A = lil_matrix((num_unknowns, num_unknowns))\n    b = np.zeros(num_unknowns)\n\n    for i in range(Nx):\n        for j in range(1, Ny):\n            k = i * (Ny - 1) + (j - 1)\n            b[k] = -alpha_eq[i, j]\n\n            A_p_contrib = 0.0\n\n            # West neighbor (i-1, j)\n            if i > 0:\n                D_w_den = D[i,j] + D[i-1,j]\n                D_w = (2.0 * D[i,j] * D[i-1,j]) / D_w_den if D_w_den > 1e-15 else 0.0\n                A_w = D_w / dx**2\n                k_w = (i - 1) * (Ny - 1) + (j - 1)\n                A[k, k_w] = A_w\n                A_p_contrib -= A_w\n            \n            # East neighbor (i+1, j)\n            if i < Nx - 1:\n                D_e_den = D[i,j] + D[i+1,j]\n                D_e = (2.0 * D[i,j] * D[i+1,j]) / D_e_den if D_e_den > 1e-15 else 0.0\n                A_e = D_e / dx**2\n                k_e = (i + 1) * (Ny - 1) + (j - 1)\n                A[k, k_e] = A_e\n                A_p_contrib -= A_e\n\n            # South neighbor (i, j-1)\n            D_s_den = D[i,j] + D[i,j-1]\n            D_s = (2.0 * D[i,j] * D[i,j-1]) / D_s_den if D_s_den > 1e-15 else 0.0\n            A_s = D_s / dy**2\n            if j > 1:\n                k_s = i * (Ny - 1) + (j - 2)\n                A[k, k_s] = A_s\n            # For j=1, neighbor alpha_i0=0 is known. Its contribution A_s*alpha_i0=0 to RHS is nil.\n            A_p_contrib -= A_s\n\n            # North neighbor (i, j+1)\n            if j < Ny - 1:\n                D_n_den = D[i,j] + D[i,j+1]\n                D_n = (2.0 * D[i,j] * D[i,j+1]) / D_n_den if D_n_den > 1e-15 else 0.0\n                A_n = D_n / dy**2\n                k_n = i * (Ny - 1) + j\n                A[k, k_n] = A_n\n                A_p_contrib -= A_n\n                \n            # Diagonal entry, including the local relaxation term '-1'\n            A[k, k] = A_p_contrib - 1.0\n\n    # Solve the system and reconstruct the full solution field\n    alpha_vec = spsolve(A.tocsc(), b)\n    alpha = np.zeros((Nx, Ny))\n    alpha[:, 1:] = alpha_vec.reshape((Nx, Ny - 1))\n\n    # Post-process to find the mean ratio\n    ratios = []\n    x_indices = [np.argmin(np.abs(x - xs)) for xs in x_stations]\n\n    for i_stat in x_indices:\n        x_m = x[i_stat]\n        delta_m = C_delta * np.sqrt(nu * x_m / U_inf) if x_m > 0 else 0.0\n\n        alpha_profile = alpha[i_stat, :]\n        alpha_outer = alpha_profile[-1]\n        target_alpha = 0.95 * alpha_outer\n\n        if target_alpha <= 1e-9: # Robustness for near-zero solutions\n            y95 = 0.0\n        else:\n            y95 = np.interp(target_alpha, alpha_profile, y)\n\n        if delta_m > 1e-15:\n            r_m = y95 / delta_m\n            ratios.append(r_m)\n\n    return np.mean(ratios)\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        },
        {
            "introduction": "A turbulence model is ultimately judged by its predictive accuracy for engineering quantities. This exercise  bridges the gap between the theoretical model and a key practical output: the skin-friction coefficient $C_f$. Using a composite velocity profile that mimics the output of a $v^2-f$ model, you will determine $C_f$ and assess its sensitivity to the underlying assumptions about the elliptic relaxation length scale, a critical skill in model validation and application.",
            "id": "3313995",
            "problem": "Consider fully developed turbulent plane channel flow of an incompressible Newtonian fluid between two parallel plates separated by a distance $2h$, with the mean flow in the streamwise direction and no mean variation in the streamwise or spanwise directions. Let the kinematic viscosity be $\\nu$ and the density be $\\rho$. Define the skin-friction coefficient as $C_f = 2 \\, \\tau_w / (\\rho \\, U_b^2)$, where $\\tau_w$ is the wall shear stress and $U_b$ is the bulk (cross-sectional average) mean velocity. The goal is to compute $C_f$ from a given near-wall turbulence modeling proxy for the $v^2\\!-\\!f$ (velocity variance squared minus elliptic relaxation function) model and assess the sensitivity to the elliptic relaxation length-scale definition $L$, then compare to a Direct Numerical Simulation (DNS) informed composite correlation.\n\nStart from the Reynolds-Averaged Navierâ€“Stokes (RANS) mean momentum balance for a fully developed channel, the no-slip condition, and the law-of-the-wall scaling. Use the fundamental facts that $u_\\tau = \\sqrt{\\tau_w/\\rho}$ (the friction velocity), $U_b = \\frac{1}{h} \\int_0^h U(y) \\, dy$, and $C_f = 2 \\left( \\frac{u_\\tau}{U_b} \\right)^2$. Treat the following composite representation of the mean velocity profile as a proxy for a converged $v^2\\!-\\!f$ solution produced under a specified elliptic relaxation length-scale definition $L$:\n$$\nU^+(y^+,\\eta; \\kappa, B, \\Pi) \\;=\\; \\frac{1}{\\kappa} \\ln\\!\\big(1 + \\kappa \\, y^+\\big) \\;+\\; B \\left(1 - e^{-y^+/A}\\right) \\;+\\; \\Pi \\, W(\\eta),\n$$\nwith $y^+ = y \\, u_\\tau / \\nu$, $\\eta = y/h$, $U^+ = U/u_\\tau$, a wake function $W(\\eta) = 2 \\sin^2\\!\\left( \\frac{\\pi}{2} \\eta \\right)$, a damping constant $A = 10$, and $\\kappa$, $B$, $\\Pi$ constants determined by either a specific $L$-definition choice or by a DNS-informed correlation. This form is consistent with the no-slip boundary condition because $U^+(0,0;\\kappa,B,\\Pi) = 0$, recovers the viscous sublayer scaling $U^+ \\approx y^+$ for small $y^+$, and matches a logarithmic behavior for large $y^+$.\n\nFor a given bulk Reynolds number $Re_b = 2 U_b h / \\nu$ and known $(h,\\nu)$, determine $u_\\tau$ by enforcing the bulk velocity definition with the composite profile:\n$$\nU_b \\;=\\; \\frac{1}{h} \\int_0^h U(y) \\, dy \\;=\\; \\frac{u_\\tau}{h} \\int_0^h U^+\\!\\left( \\frac{y u_\\tau}{\\nu}, \\frac{y}{h}; \\kappa, B, \\Pi \\right) dy,\n$$\nand subsequently compute $C_f = 2 (u_\\tau / U_b)^2$. This defines a one-dimensional nonlinear root-finding problem for $u_\\tau$.\n\nTo assess sensitivity to the elliptic relaxation length-scale $L$, use the following three parameter sets for $(\\kappa, B, \\Pi)$:\n- DNS-informed composite correlation (used as the comparison baseline): $(\\kappa, B, \\Pi) = (0.41, 5.20, 0.20)$,\n- $L_{\\mathrm{loc}}$ definition, representing a larger local relaxation length (tending to reduce $C_f$): $(\\kappa, B, \\Pi) = (0.41, 5.35, 0.22)$,\n- $L_{\\mathrm{wall}}$ definition, representing a wall-limited relaxation length (tending to increase $C_f$): $(\\kappa, B, \\Pi) = (0.41, 5.05, 0.18)$.\n\nYour program must:\n- For each test case, solve for $u_\\tau$ that matches the target $U_b$ implied by $Re_b$, then compute and report $C_f$ for the two $L$-definition proxies and for the DNS-informed parameters.\n- Use $\\rho = 1.0 \\,\\mathrm{kg/m^3}$, so that $C_f$ is dimensionless without further unit conversions.\n- Express all lengths in $\\mathrm{m}$ and velocities in $\\mathrm{m/s}$, with $C_f$ dimensionless.\n- Use numerical quadrature with sufficient resolution to evaluate the bulk integral, and a robust bracketing method to solve the scalar equation for $u_\\tau$.\n\nTest suite:\n- Case $1$: $h = 0.05\\,\\mathrm{m}$, $\\nu = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $Re_b = 2600$,\n- Case $2$: $h = 0.05\\,\\mathrm{m}$, $\\nu = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $Re_b = 5600$,\n- Case $3$: $h = 0.05\\,\\mathrm{m}$, $\\nu = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $Re_b = 20000$,\n- Case $4$: $h = 0.05\\,\\mathrm{m}$, $\\nu = 1.0 \\times 10^{-5}\\,\\mathrm{m^2/s}$, $Re_b = 80000$.\n\nFor each case, the required output is a list of three floating-point numbers $[C_{f,L_{\\mathrm{loc}}}, C_{f,L_{\\mathrm{wall}}}, C_{f,\\mathrm{DNS}}]$, in this order. Your program should produce a single line of output containing the results as a comma-separated list of these four lists, enclosed in square brackets, for example $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$, where each $x_i$, $y_i$, $z_i$ are floats computed as specified above.",
            "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution. It requires the computation of the skin-friction coefficient, $C_f$, in a fully developed turbulent plane channel flow, based on a composite mean velocity profile that serves as a proxy for solutions from a $v^2\\!-\\!f$ turbulence model. The sensitivity of $C_f$ to parameters representing different elliptic relaxation length-scale definitions is to be assessed and compared against a baseline derived from Direct Numerical Simulation (DNS) data.\n\nThe fundamental relationship connecting the prescribed bulk Reynolds number, $Re_b$, to the unknown friction velocity, $u_\\tau$, is the definition of the bulk mean velocity, $U_b$. For a channel of half-height $h$, this is given by:\n$$\nU_b = \\frac{1}{h} \\int_0^h U(y) \\, dy\n$$\nwhere $y$ is the wall-normal coordinate and $U(y)$ is the mean velocity profile.\n\nThe problem provides a composite velocity profile in dimensionless form, $U^+ = U/u_\\tau$, as a function of the inner-scaled wall distance, $y^+ = y u_\\tau / \\nu$, and the outer-scaled wall distance, $\\eta = y/h$. The profile is:\n$$\nU^+(y^+,\\eta; \\kappa, B, \\Pi) = \\frac{1}{\\kappa} \\ln(1 + \\kappa \\, y^+) + B \\left(1 - e^{-y^+/A}\\right) + \\Pi \\, W(\\eta)\n$$\nHere, $\\kappa$, $B$, and $\\Pi$ are model parameters, $A=10$ is a constant, and $W(\\eta) = 2 \\sin^2(\\frac{\\pi}{2}\\eta)$ is the wake function.\n\nSubstituting $U(y) = u_\\tau U^+(y^+,\\eta)$ into the bulk velocity definition yields:\n$$\nU_b = \\frac{u_\\tau}{h} \\int_0^h U^+\\left(\\frac{y u_\\tau}{\\nu}, \\frac{y}{h}; \\kappa, B, \\Pi\\right) \\, dy\n$$\nThe bulk Reynolds number is defined as $Re_b = 2 U_b h / \\nu$. We can express the target $U_b$ in terms of the given problem parameters: $U_b = \\frac{Re_b \\nu}{2h}$. Substituting this into the previous equation gives the central nonlinear equation for the unknown friction velocity $u_\\tau$:\n$$\n\\frac{Re_b \\nu}{2h} = \\frac{u_\\tau}{h} \\int_0^h U^+\\left(\\frac{y u_\\tau}{\\nu}, \\frac{y}{h}\\right) \\, dy\n$$\nRearranging, we seek the root of the function $g(u_\\tau)$:\n$$\ng(u_\\tau) = u_\\tau \\int_0^h U^+\\left(\\frac{y u_\\tau}{\\nu}, \\frac{y}{h}\\right) \\, dy - \\frac{Re_b \\nu}{2} = 0\n$$\nThe integral in this expression does not have a closed-form analytical solution, so it must be evaluated using numerical quadrature. The function $g(u_\\tau)$ is strictly monotonic with respect to $u_\\tau$ for $u_\\tau > 0$, as $U^+$ is a monotonically increasing function of $y^+$ and thus of $u_\\tau$. This property ensures that a unique positive root for $u_\\tau$ exists and makes bracketing methods, such as Brent's method, highly suitable for solving $g(u_\\tau) = 0$. A physically sensible search interval, for instance $[10^{-4}, 1.0]$, can be established for $u_\\tau$.\n\nOnce the unique value of $u_\\tau$ is determined for a given set of parameters $(Re_b, h, \\nu)$ and $(\\kappa, B, \\Pi)$, the skin-friction coefficient $C_f$ is calculated. The definition is $C_f = 2 \\tau_w / (\\rho U_b^2)$, where $\\tau_w = \\rho u_\\tau^2$ is the wall shear stress. This simplifies to:\n$$\nC_f = 2 \\frac{\\rho u_\\tau^2}{\\rho U_b^2} = 2 \\left( \\frac{u_\\tau}{U_b} \\right)^2\n$$\n\nThe computational procedure for each test case $(h, \\nu, Re_b)$ is as follows, repeated for each of the three specified parameter sets $(\\kappa, B, \\Pi)$:\n$1$. Calculate the target bulk velocity $U_b = Re_b \\nu / (2h)$.\n$2$. Define the function $g(u_\\tau)$ as detailed above. This function internally computes the definite integral of $U^+$ from $y=0$ to $y=h$ for a given $u_\\tau$ using a numerical quadrature routine.\n$3$. Employ a numerical root-finding algorithm (Brent's method) to solve $g(u_\\tau) = 0$ and find the value of $u_\\tau$.\n$4$. Compute the corresponding skin-friction coefficient $C_f = 2 (u_\\tau/U_b)^2$.\n\nThis procedure is applied to the four test cases and three parameter sets:\n- **DNS-informed correlation:** $(\\kappa, B, \\Pi) = (0.41, 5.20, 0.20)$\n- **$L_{\\mathrm{loc}}$ definition proxy:** $(\\kappa, B, \\Pi) = (0.41, 5.35, 0.22)$\n- **$L_{\\mathrm{wall}}$ definition proxy:** $(\\kappa, B, \\Pi) = (0.41, 5.05, 0.18)$\n\nThe final output will consist of a list containing four sub-lists, where each sub-list holds the three computed $C_f$ values ($C_{f,L_{\\mathrm{loc}}}$, $C_{f,L_{\\mathrm{wall}}}$, $C_{f,\\mathrm{DNS}}$) for one test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize, integrate\n\ndef solve():\n    \"\"\"\n    Solves for the skin-friction coefficient in turbulent channel flow\n    using a composite velocity profile and a root-finding approach.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (h, nu, Re_b)\n        (0.05, 1.0e-5, 2600),\n        (0.05, 1.0e-5, 5600),\n        (0.05, 1.0e-5, 20000),\n        (0.05, 1.0e-5, 80000),\n    ]\n\n    # Damping constant for the velocity profile\n    A = 10.0\n\n    # Parameter sets for different turbulence model assumptions\n    param_sets = {\n        'L_loc': {'kappa': 0.41, 'B': 5.35, 'Pi': 0.22},\n        'L_wall': {'kappa': 0.41, 'B': 5.05, 'Pi': 0.18},\n        'DNS': {'kappa': 0.41, 'B': 5.20, 'Pi': 0.20},\n    }\n    \n    # The required output order for the parameter sets\n    param_order = ['L_loc', 'L_wall', 'DNS']\n    \n    all_results = []\n\n    for h, nu, Re_b in test_cases:\n        # Calculate the target bulk mean velocity from the given Reynolds number\n        U_b = (Re_b * nu) / (2.0 * h)\n        \n        case_results = []\n        for param_name in param_order:\n            params = param_sets[param_name]\n            kappa = params['kappa']\n            B = params['B']\n            Pi = params['Pi']\n\n            # Define the composite velocity profile U+ = U/u_tau\n            def U_plus(y, u_tau_guess):\n                y_plus = y * u_tau_guess / nu\n                eta = y / h\n                \n                # Equation for U+ as given in the problem\n                term1 = (1.0 / kappa) * np.log(1.0 + kappa * y_plus)\n                term2 = B * (1.0 - np.exp(-y_plus / A))\n                term3 = Pi * 2.0 * np.sin(np.pi * eta / 2.0)**2\n                \n                return term1 + term2 + term3\n\n            # The function whose root we need to find, based on the bulk velocity definition\n            # g(u_tau) = u_tau * Integral(U_plus dy) - U_b * h = 0\n            def root_function(u_tau_guess):\n                # Numerically integrate U_plus from y=0 to y=h\n                integral_val, _ = integrate.quad(\n                    U_plus, 0, h, args=(u_tau_guess,)\n                )\n                # Return the residual of the governing equation\n                return u_tau_guess * integral_val - U_b * h\n\n            # Solve for u_tau using a robust bracketing root-finder (Brent's method)\n            # The bracket [1e-4, 1.0] is physically reasonable for these flow conditions\n            try:\n                u_tau_solution = optimize.brentq(root_function, 1e-4, 1.0)\n            except ValueError:\n                # This would happen if the root is not bracketed, which is\n                # unlikely given the monotonic nature of the function.\n                u_tau_solution = float('nan')\n\n            # Calculate the skin-friction coefficient C_f = 2 * (u_tau / U_b)^2\n            Cf = 2.0 * (u_tau_solution / U_b)**2\n            case_results.append(Cf)\n\n        all_results.append(case_results)\n\n    # Format the final output string as specified in the problem statement\n    # e.g., [[x1,y1,z1],[x2,y2,z2],...]\n    formatted_inner_lists = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(formatted_inner_lists)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}