{
    "hands_on_practices": [
        {
            "introduction": "低雷诺数湍流模型旨在解析直至壁面的整个流动区域，这要求在近壁区域使用极其精细的网格。该网格质量通常通过无量纲壁面距离 $y^+$ 来量化。本练习  让你亲手实践这一关键概念，通过计算为达到目标 $y^+$ 值所需的网格间距，掌握任何从事壁面束缚流研究的计算流体力学工程师都需具备的基本技能。",
            "id": "3342206",
            "problem": "在计算流体动力学（CFD）中，一个壁面解析的低雷诺数湍流模型要求第一个单元中心位于粘性底层内，其无量纲壁面法向距离满足 $y^{+} \\leq 1$。考虑一个统计定常的不可压缩壁面束缚流，其壁面剪切应力 $\\tau_{w}$、密度 $\\rho$ 和运动粘度 $\\nu$ 已知。近壁网格在法线方向上是均匀的，紧邻壁面的第一个单元高度为 $\\Delta y$，因此第一个单元中心位于 $y = \\Delta y/2$。\n\n使用壁面束缚流的摩擦速度和粘性标度的基本定义，推导确保第一个单元中心处 $y^{+} = 1$ 所需的法向间距 $\\Delta y$。然后计算当 $\\rho = 1030\\,\\mathrm{kg\\,m^{-3}}$，$\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^{2}\\,s^{-1}}$ 且 $\\tau_{w} = 0.50\\,\\mathrm{Pa}$ 时该间距的值。\n\n最终间距以米为单位表示，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导将第一个单元中心置于无量纲壁面距离 $y^{+} = 1$ 处所需的壁面法向单元间距 $\\Delta y$。该问题是适定的，其科学基础是壁面束缚湍流的原理，并为获得唯一解提供了所有必要的数据。\n\n首先，我们建立基本定义。无量纲壁面法向距离 $y^{+}$ 定义为：\n$$y^{+} = \\frac{y u_{\\tau}}{\\nu}$$\n其中 $y$ 是距壁面的有量纲距离，$u_{\\tau}$ 是摩擦速度，$\\nu$ 是流体的运动粘度。\n\n摩擦速度 $u_{\\tau}$ 由壁面剪切应力 $\\tau_{w}$ 和流体密度 $\\rho$ 定义：\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_{w}}{\\rho}}$$\n\n将 $u_{\\tau}$ 的定义代入 $y^{+}$ 的表达式中，我们得到一个将 $y^{+}$ 与物理流动属性联系起来的单一方程：\n$$y^{+} = \\frac{y}{\\nu} \\sqrt{\\frac{\\tau_{w}}{\\rho}}$$\n\n问题指定，对于紧邻壁面的均匀网格，第一个单元的高度为 $\\Delta y$，其中心位于 $y = \\Delta y / 2$。对于壁面解析的低雷诺数模型，要求是将此第一个单元中心放置在 $y^{+} \\leq 1$ 的位置。我们将使用临界值 $y^{+} = 1$ 来确定最大允许单元高度。\n\n我们在方程中设 $y = \\Delta y / 2$ 和 $y^{+} = 1$：\n$$1 = \\frac{\\frac{\\Delta y}{2}}{\\nu} \\sqrt{\\frac{\\tau_{w}}{\\rho}}$$\n\n现在，我们解此方程以求得所需的单元间距 $\\Delta y$。\n$$1 = \\frac{\\Delta y}{2\\nu} \\sqrt{\\frac{\\tau_{w}}{\\rho}}$$\n$$\\Delta y = \\frac{2\\nu}{\\sqrt{\\frac{\\tau_{w}}{\\rho}}}$$\n这也可以写成：\n$$\\Delta y = 2\\nu \\sqrt{\\frac{\\rho}{\\tau_{w}}}$$\n这是所需法向间距的符号表达式。\n\n接下来，我们使用所提供的数据计算 $\\Delta y$ 的数值：\n- 密度, $\\rho = 1030\\,\\mathrm{kg\\,m^{-3}}$\n- 运动粘度, $\\nu = 1.0 \\times 10^{-6}\\,\\mathrm{m^{2}\\,s^{-1}}$\n- 壁面剪切应力, $\\tau_{w} = 0.50\\,\\mathrm{Pa}$\n\n将这些值代入推导出的表达式中：\n$$\\Delta y = 2 \\times (1.0 \\times 10^{-6}) \\times \\sqrt{\\frac{1030}{0.50}}$$\n首先，计算平方根内的项：\n$$\\frac{1030}{0.50} = 2060$$\n现在，将此结果代回 $\\Delta y$ 的方程中：\n$$\\Delta y = 2 \\times 10^{-6} \\times \\sqrt{2060}$$\n计算平方根：\n$$\\sqrt{2060} \\approx 45.387223$$\n最后，计算 $\\Delta y$：\n$$\\Delta y \\approx 2 \\times 10^{-6} \\times 45.387223$$\n$$\\Delta y \\approx 90.774446 \\times 10^{-6}\\,\\mathrm{m}$$\n用标准科学记数法表示，即为：\n$$\\Delta y \\approx 9.0774446 \\times 10^{-5}\\,\\mathrm{m}$$\n\n问题要求将答案四舍五入到四位有效数字。前四位有效数字是 $9.077$。第五位有效数字是 $4$，因此我们舍去。\n$$\\Delta y \\approx 9.077 \\times 10^{-5}\\,\\mathrm{m}$$",
            "answer": "$$\\boxed{9.077 \\times 10^{-5}}$$"
        },
        {
            "introduction": "除了合适的网格划分，低雷诺数模型的准确性还取决于其能否再现粘性子层中的复杂物理过程，这通常需要特定的近壁处理或边界条件。这个理论性练习  将引导你从第一性原理出发，推导在紧邻无滑移壁面处湍动能 ($k$) 与其耗散率 ($\\epsilon$) 之间的关系。理解这一推导过程有助于揭示许多双方程模型中 $\\epsilon$ 方程边界条件的物理来源。",
            "id": "3342170",
            "problem": "考虑在低雷诺数下，流经光滑平壁的不可压缩湍流，其中粘性子层被显式解析，如同在低雷诺数双方程模型中一样。设$y$表示壁面法向距离，并将瞬时速度分解为平均值和脉动值，即$\\mathbf{u} = \\mathbf{U} + \\mathbf{u}'$，其中$\\mathbf{u}' = (u', v', w')$。湍动能(TKE)定义为$k = \\frac{1}{2} \\overline{u'_i u'_i}$，其中上划线表示系综平均；耗散率定义为$\\epsilon = 2 \\nu \\overline{s_{ij} s_{ij}}$，其中$s_{ij} = \\frac{1}{2}\\left(\\frac{\\partial u'_i}{\\partial x_j} + \\frac{\\partial u'_j}{\\partial x_i}\\right)$是脉动应变率张量，$\\nu$是运动粘度。\n\n从脉动量的不可压缩连续性方程、光滑壁面的无滑移和不可穿透边界条件出发，并假设壁面附近的脉动场是光滑的，推导速度脉动的近壁主阶展开式，并用它们得到在小$y$处$\\epsilon$的主阶表达式。然后，利用物理上观测到的湍动能的近壁标度关系$k \\sim a y^2$（当$y \\to 0$时，其中$a$是一个有限的非零常数），消去任何未知的近壁系数，将$\\epsilon$表示为如下形式：\n$$\n\\epsilon = C_{\\epsilon}\\, \\nu\\, \\frac{k}{y^2},\n$$\n并确定常数$C_{\\epsilon}$。\n\n你的最终答案必须是$C_{\\epsilon}$的值，以纯无量纲数的形式报告。不需要四舍五入，最终答案中不应包含单位。",
            "solution": "目标是确定表达式$\\epsilon = C_{\\epsilon}\\, \\nu\\, \\frac{k}{y^2}$中常数$C_{\\epsilon}$的值，该表达式关联了不可压缩湍流近壁区域中的湍动能耗散率$\\epsilon$与湍动能$k$。我们首先分析光滑壁面附近的速度脉动行为。\n\n设壁面位于平面$y=0$处。我们使用笛卡尔坐标系$(x_1, x_2, x_3)$，对应于$(x, y, z)$，速度脉动为$(u'_1, u'_2, u'_3)$，对应于$(u', v', w')$。壁面位于$x_2=0$。\n\n壁面上的无滑移和不可穿透边界条件要求所有速度分量均为零：$\\mathbf{u}(x_1, 0, x_3, t) = \\mathbf{0}$。由于平均速度$\\mathbf{U}$也必须满足无滑移条件，即$\\mathbf{U}(x_1, 0, x_3) = \\mathbf{0}$，因此脉动在壁面上也必须为零：$\\mathbf{u}'(x_1, 0, x_3, t) = \\mathbf{0}$。\n\n假设脉动速度场是壁面法向距离$x_2$的光滑函数，我们可以将其在$x_2=0$附近进行泰勒级数展开：\n$$\nu'_i(x_1, x_2, x_3, t) = u'_i|_{x_2=0} + \\frac{\\partial u'_i}{\\partial x_2}\\bigg|_{x_2=0} x_2 + \\frac{1}{2} \\frac{\\partial^2 u'_i}{\\partial x_2^2}\\bigg|_{x_2=0} x_2^2 + O(x_2^3)\n$$\n边界条件$u'_i|_{x_2=0}=0$消去了常数项。让我们将系数（它们是$(x_1, x_3, t)$的函数）表示如下：\n$$\n\\alpha_i(x_1, x_3, t) = \\frac{\\partial u'_i}{\\partial x_2}\\bigg|_{x_2=0}, \\quad \\beta_i(x_1, x_3, t) = \\frac{1}{2}\\frac{\\partial^2 u'_i}{\\partial x_2^2}\\bigg|_{x_2=0}\n$$\n所以展开式为：\n$$\nu'_1 = \\alpha_1 x_2 + \\beta_1 x_2^2 + O(x_2^3)\n$$\n$$\nu'_2 = \\alpha_2 x_2 + \\beta_2 x_2^2 + O(x_2^3)\n$$\n$$\nu'_3 = \\alpha_3 x_2 + \\beta_3 x_2^2 + O(x_2^3)\n$$\n接下来，我们应用不可压缩流动的连续性方程，该方程也适用于脉动量：\n$$\n\\frac{\\partial u'_i}{\\partial x_i} = \\frac{\\partial u'_1}{\\partial x_1} + \\frac{\\partial u'_2}{\\partial x_2} + \\frac{\\partial u'_3}{\\partial x_3} = 0\n$$\n将泰勒级数展开式代入连续性方程：\n$$\n\\frac{\\partial}{\\partial x_1}(\\alpha_1 x_2 + \\dots) + \\frac{\\partial}{\\partial x_2}(\\alpha_2 x_2 + \\beta_2 x_2^2 + \\dots) + \\frac{\\partial}{\\partial x_3}(\\alpha_3 x_2 + \\dots) = 0\n$$\n$$\n\\left(\\frac{\\partial \\alpha_1}{\\partial x_1} x_2 + \\dots\\right) + \\left(\\alpha_2 + 2\\beta_2 x_2 + \\dots\\right) + \\left(\\frac{\\partial \\alpha_3}{\\partial x_3} x_2 + \\dots\\right) = 0\n$$\n该方程必须对所有小的$x_2 > 0$成立。我们按$x_2$的幂次合并各项：\n主阶项，即$x_2^0$阶项，给出：\n$$\n\\alpha_2 = 0\n$$\n这是一个关键结果。它意味着$\\frac{\\partial u'_2}{\\partial x_2}\\big|_{x_2=0} = 0$。因此，壁面法向速度脉动$u'_2$必须以$x_2^2$阶的项开始。速度脉动的修正后展开式为：\n$$\nu'_1 = \\alpha_1 x_2 + O(x_2^2)\n$$\n$$\nu'_2 = \\beta_2 x_2^2 + O(x_2^3)\n$$\n$$\nu'_3 = \\alpha_3 x_2 + O(x_2^2)\n$$\n现在，我们分析湍动能的主阶行为，$k = \\frac{1}{2} \\overline{u'_i u'_i} = \\frac{1}{2}(\\overline{u'_1 u'_1} + \\overline{u'_2 u'_2} + \\overline{u'_3 u'_3})$。代入展开式：\n$$\n\\overline{u'_1 u'_1} = \\overline{(\\alpha_1 x_2 + O(x_2^2))^2} = \\overline{\\alpha_1^2} x_2^2 + O(x_2^3)\n$$\n$$\n\\overline{u'_2 u'_2} = \\overline{(\\beta_2 x_2^2 + O(x_2^3))^2} = \\overline{\\beta_2^2} x_2^4 + O(x_2^5)\n$$\n$$\n\\overline{u'_3 u'_3} = \\overline{(\\alpha_3 x_2 + O(x_2^2))^2} = \\overline{\\alpha_3^2} x_2^2 + O(x_2^3)\n$$\n对$x_2$取主阶，动能为：\n$$\nk = \\frac{1}{2}(\\overline{\\alpha_1^2} + \\overline{\\alpha_3^2}) x_2^2 + O(x_2^3)\n$$\n这证实了给定的近壁标度关系$k \\sim a y^2$（或$k \\sim a x_2^2$），其中常数$a$为$a = \\frac{1}{2}(\\overline{\\alpha_1^2} + \\overline{\\alpha_3^2})$。\n\n接下来，我们计算耗散率$\\epsilon = 2\\nu \\overline{s_{ij} s_{ij}}$，其中$s_{ij} = \\frac{1}{2}\\left(\\frac{\\partial u'_i}{\\partial x_j} + \\frac{\\partial u'_j}{\\partial x_i}\\right)$。我们需要对于小的$x_2$，脉动应变率张量$s_{ij}$各分量的主阶项。我们首先从泰勒级数计算速度梯度：\n$$\n\\frac{\\partial u'_1}{\\partial x_1} = \\frac{\\partial \\alpha_1}{\\partial x_1} x_2 + \\dots \\quad \\frac{\\partial u'_1}{\\partial x_2} = \\alpha_1 + \\dots \\quad \\frac{\\partial u'_1}{\\partial x_3} = \\frac{\\partial \\alpha_1}{\\partial x_3} x_2 + \\dots\n$$\n$$\n\\frac{\\partial u'_2}{\\partial x_1} = \\frac{\\partial \\beta_2}{\\partial x_1} x_2^2 + \\dots \\quad \\frac{\\partial u'_2}{\\partial x_2} = 2\\beta_2 x_2 + \\dots \\quad \\frac{\\partial u'_2}{\\partial x_3} = \\frac{\\partial \\beta_2}{\\partial x_3} x_2^2 + \\dots\n$$\n$$\n\\frac{\\partial u'_3}{\\partial x_1} = \\frac{\\partial \\alpha_3}{\\partial x_1} x_2 + \\dots \\quad \\frac{\\partial u'_3}{\\partial x_2} = \\alpha_3 + \\dots \\quad \\frac{\\partial u'_3}{\\partial x_3} = \\frac{\\partial \\alpha_3}{\\partial x_3} x_2 + \\dots\n$$\n$s_{ij}$的分量，取主阶，为：\n$$\ns_{11} = \\frac{\\partial u'_1}{\\partial x_1} = O(x_2) \\quad s_{22} = \\frac{\\partial u'_2}{\\partial x_2} = O(x_2) \\quad s_{33} = \\frac{\\partial u'_3}{\\partial x_3} = O(x_2)\n$$\n$$\ns_{12} = s_{21} = \\frac{1}{2}\\left(\\frac{\\partial u'_1}{\\partial x_2} + \\frac{\\partial u'_2}{\\partial x_1}\\right) = \\frac{1}{2}(\\alpha_1 + O(x_2^2)) = \\frac{1}{2}\\alpha_1 + O(x_2^2)\n$$\n$$\ns_{13} = s_{31} = \\frac{1}{2}\\left(\\frac{\\partial u'_1}{\\partial x_3} + \\frac{\\partial u'_3}{\\partial x_1}\\right) = O(x_2)\n$$\n$$\ns_{23} = s_{32} = \\frac{1}{2}\\left(\\frac{\\partial u'_2}{\\partial x_3} + \\frac{\\partial u'_3}{\\partial x_2}\\right) = \\frac{1}{2}(O(x_2^2) + \\alpha_3) = \\frac{1}{2}\\alpha_3 + O(x_2^2)\n$$\n量$s_{ij}s_{ij}$是张量所有分量的平方和：\n$$\ns_{ij}s_{ij} = s_{11}^2 + s_{22}^2 + s_{33}^2 + 2(s_{12}^2 + s_{13}^2 + s_{23}^2)\n$$\n代入主阶项：\n$$\ns_{ij}s_{ij} = O(x_2^2) + O(x_2^2) + O(x_2^2) + 2\\left(\\left(\\frac{1}{2}\\alpha_1\\right)^2 + O(x_2^2) + \\left(\\frac{1}{2}\\alpha_3\\right)^2\\right) = 2\\left(\\frac{1}{4}\\alpha_1^2 + \\frac{1}{4}\\alpha_3^2\\right) + O(x_2^2)\n$$\n$$\ns_{ij}s_{ij} = \\frac{1}{2}(\\alpha_1^2 + \\alpha_3^2) + O(x_2^2)\n$$\n取系综平均，我们得到小$x_2$时的行为：\n$$\n\\overline{s_{ij}s_{ij}} = \\frac{1}{2}(\\overline{\\alpha_1^2} + \\overline{\\alpha_3^2}) + O(x_2^2)\n$$\n因此，耗散率$\\epsilon$为：\n$$\n\\epsilon = 2\\nu \\overline{s_{ij}s_{ij}} = 2\\nu \\left[ \\frac{1}{2}(\\overline{\\alpha_1^2} + \\overline{\\alpha_3^2}) \\right] = \\nu (\\overline{\\alpha_1^2} + \\overline{\\alpha_3^2})\n$$\n取主阶。注意，$\\epsilon$在壁面处趋于一个有限的非零值，$\\epsilon_w = \\nu(\\overline{\\alpha_1^2} + \\overline{\\alpha_3^2})$。\n\n最后，我们通过消去未知系数$\\overline{\\alpha_1^2}$和$\\overline{\\alpha_3^2}$来关联$\\epsilon$和$k$。\n从$k$的表达式：\n$$\n\\frac{k}{x_2^2} = \\frac{1}{2}(\\overline{\\alpha_1^2} + \\overline{\\alpha_3^2})\n$$\n所以，我们可以写出：\n$$\n(\\overline{\\alpha_1^2} + \\overline{\\alpha_3^2}) = \\frac{2k}{x_2^2}\n$$\n将此代入$\\epsilon$的表达式：\n$$\n\\epsilon = \\nu \\left(\\frac{2k}{x_2^2}\\right) = 2\\nu \\frac{k}{x_2^2}\n$$\n将$x_2$替换为通用的壁面法向坐标$y$，我们得到：\n$$\n\\epsilon = 2\\nu \\frac{k}{y^2}\n$$\n将此与给定形式$\\epsilon = C_{\\epsilon}\\, \\nu\\, \\frac{k}{y^2}$进行比较，我们确定常数$C_{\\epsilon}$。\n$$\nC_{\\epsilon} = 2\n$$\n这个结果给出了粘性子层中耗散率和湍动能之间的精确主阶关系。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在探索了网格划分的基础和关键变量的理论行为之后，我们现在在一个更高级的背景下综合这些思想。$v^2-f$ 模型是一种先进的低雷诺数闭合模型，它通过附加的输运方程来捕捉近壁效应，而不是依赖简单的阻尼函数。这项综合性的编程练习  要求你实现该模型的简化版本，让你能直接观察其公式如何确保涡粘度在近壁处得到正确的物理阻尼。",
            "id": "3342163",
            "problem": "考虑在间距为 $2h$ 的两个平行板之间的不可压缩牛顿流体的定常、完全发展的平面槽道流。设壁面法向坐标为 $y \\in [0,h]$，其中 $y=0$ 处为壁面，$y=h$ 处为中心线。流动由恒定的流向压力梯度驱动，我们采用雷诺平均纳维-斯托克斯 (RANS) 框架，并结合低雷诺数 $v^2$–$f$ 湍流封闭模型。\n\n基本基础与力学平衡：\n- 平均动量平衡意味着总剪切应力在半槽道内呈线性变化：$$\\tau_{\\text{tot}}(y) = \\rho u_\\tau^2 \\left(1 - \\frac{y}{h}\\right),$$ 其中 $\\rho$ 是流体密度，$u_\\tau$ 是摩擦速度，定义为 $u_\\tau = \\sqrt{\\tau_w/\\rho}$，$\\tau_w$ 为壁面剪切应力。\n- 平均剪切通过以下方式与总应力相关：$$\\tau_{\\text{tot}}(y) = \\mu_{\\text{eff}}(y)\\, S(y),$$ 其中 $\\mu_{\\text{eff}}(y) = \\mu + \\mu_t(y)$ 是有效动力黏度，$\\mu$ 是分子动力黏度，$\\mu_t(y)$ 是涡黏度，而 $S(y) = \\frac{dU}{dy}$ 是平均剪切率。为验证涡黏度的近壁阻尼效应，用层流值来近似时间尺度中所需的平均剪切，$$S(y) \\approx \\frac{\\tau_{\\text{tot}}(y)}{\\mu},$$ 这与分子黏度在近壁区占主导地位（$\\mu_t \\ll \\mu$）的情况相符。\n\n封闭目标与构造：\n- $v^2$–$f$ 封闭模型假定 $$\\mu_t(y) = \\rho\\, C_\\mu\\, v^2(y)\\, \\tau(y),$$ 其中 $v^2(y)$ 是壁面法向湍流强度，$C_\\mu$ 是一个模型常数，$\\tau(y)$ 是一个由 $(k,\\epsilon,f)$ 构造的特征湍流时间尺度，其构造方式确保了近壁阻尼。\n- 对湍动能及其耗散率使用给定的、物理上一致的剖面，这些剖面满足近壁极限 $k \\sim \\mathcal{O}(y^2)$ 和 $\\epsilon \\sim \\mathcal{O}(1)$：\n  $$k(y) = A_k\\, u_\\tau^2 \\left[1 - \\cos\\left(\\frac{\\pi y}{h}\\right)\\right]^2,$$\n  $$\\epsilon(y) = A_\\epsilon\\, \\frac{u_\\tau^3}{h} \\left[1 + \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{\\pi y}{h}\\right)\\right)\\right],$$\n  其中 $A_k$ 和 $A_\\epsilon$ 为正常数。\n- 使用长度尺度来模拟壁面法向各向异性的椭圆松弛 $$L(y) = \\frac{C_\\eta\\, \\nu}{\\sqrt{\\epsilon(y)}},$$ 其中 $\\nu = \\mu/\\rho$ 是运动黏度，$C_\\eta$ 是一个正常数。通过以下边值问题获得壁面法向分量分数 $b(y)$：\n  $$L(y)^2\\, \\frac{d^2 b}{dy^2}(y) - b(y) = -\\frac{1}{3}, \\quad y \\in (0,h),$$\n  边界条件为 $$b(0) = 0, \\quad \\frac{db}{dy}(h) = 0.$$ \n  这种简化的椭圆松弛强制 $b$ 在远离壁面时趋向于 $\\tfrac{1}{3}$，在壁面处趋向于 $0$。然后设置 $$v^2(y) = b(y)\\, k(y).$$\n- 通过以下方式求解椭圆松弛变量 $f(y)$\n  $$L(y)^2\\, \\frac{d^2 f}{dy^2}(y) - f(y) = C_2\\, \\chi(y)\\, \\left(b(y) - \\frac{1}{3}\\right), \\quad y \\in (0,h),$$\n  其中 $$\\chi(y) = \\min\\left(\\frac{\\epsilon(y)}{\\max\\left(k(y),\\, k_{\\text{floor}}\\right)},\\, \\chi_{\\max}\\right)$$ 是一个正则化比率，以避免 $k$ 在近壁区趋于 $0$ 时的奇异行为。施加边界条件 $$f(0) = f_w \\quad \\text{(其中 } f_w \\ne 0\\text{)}, \\quad \\frac{df}{dy}(h) = 0.$$\n- 将时间尺度构造为一个稳健的近壁阻尼最小值：\n  $$\\tau(y) = \\min\\left(\\frac{k(y)}{\\epsilon(y)},\\, \\frac{1}{\\left|f(y)\\right|\\, \\max\\left(\\left|S(y)\\right|,\\, S_{\\min}\\right)},\\, C_T \\sqrt{\\frac{\\nu}{\\epsilon(y)}}\\right),$$\n  其中 $C_T>0$ 和 $S_{\\min}>0$ 是小的正常则化常数。这种组合利用了局部平衡时间尺度 $k/\\epsilon$、由 $f$ 控制的剪切时间尺度 $1/(|f|\\,|S|)$ 以及黏性时间尺度 $\\sqrt{\\nu/\\epsilon}$，以强制实现低雷诺数阻尼。\n\n数值要求：\n- 将区间 $[0,h]$ 均匀离散化，至少使用 $N=400$ 个网格点。对二阶导数使用二阶中心差分，并显式地施加边界条件。为 $b(y)$ 和 $f(y)$ 组装并求解得到的线性系统。\n- 使用以下固定的物理常数和单位：\n  - $\\rho$ 的单位为 $\\mathrm{kg/m^3}$，$\\mu$ 的单位为 $\\mathrm{Pa\\cdot s}$，$h$ 的单位为 $\\mathrm{m}$；因此 $u_\\tau$ 的单位为 $\\mathrm{m/s}$，$k$ 的单位为 $\\mathrm{m^2/s^2}$，$\\epsilon$ 的单位为 $\\mathrm{m^2/s^3}$，$L$ 的单位为 $\\mathrm{m}$，$f$ 无量纲，$S$ 的单位为 $\\mathrm{s^{-1}}$，$\\tau$ 的单位为 $\\mathrm{s}$，$\\mu_t$ 的单位为 $\\mathrm{Pa\\cdot s}$。所有内部计算结果均以国际单位制（SI）表示。\n- 使用 $\\rho = 1000\\, \\mathrm{kg/m^3}$，$\\mu = 1.0\\times 10^{-3}\\, \\mathrm{Pa\\cdot s}$，$h = 0.01\\, \\mathrm{m}$，$C_\\mu = 0.22$，$C_\\eta = 70.0$，$C_2 = 0.3$，$C_T = 6.0$，$f_w = -0.5$，$k_{\\text{floor}} = 10^{-8}\\, u_\\tau^2$，$\\chi_{\\max} = 10^6\\, \\mathrm{s^{-1}}$，以及 $S_{\\min} = 10^{-6}\\, \\mathrm{s^{-1}}$。\n\n测试套件：\n- 使用由摩擦雷诺数和湍流剖面振幅 $(\\mathrm{Re}_\\tau, A_k, A_\\epsilon)$ 指定的三个测试案例：\n  1. $(\\mathrm{Re}_\\tau = 150, A_k = 0.25, A_\\epsilon = 1.4)$,\n  2. $(\\mathrm{Re}_\\tau = 395, A_k = 0.30, A_\\epsilon = 1.5)$,\n  3. $(\\mathrm{Re}_\\tau = 590, A_k = 0.30, A_\\epsilon = 1.7)$,\n  其中 $\\mathrm{Re}_\\tau = u_\\tau h / \\nu$ 且 $\\nu = \\mu/\\rho$。\n- 对于每个测试案例，计算涡黏度 $\\mu_t(y)$ 并通过检查布尔条件来评估近壁阻尼 \n  $$\\frac{\\mu_t(y_1)}{\\mu}  10^{-3},$$ \n  其中 $y_1$ 是离壁面的第一个网格点（即 $y_1 = \\Delta y$）。这量化了在第一个离壁位置，涡黏度至少比分子黏度小三个数量级，这是一个严格的近壁阻尼准则。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含三个测试案例的布尔结果，格式为方括号内以逗号分隔的列表（例如，“[True,False,True]”）。\n\n所有角度在此问题中均不相关。确保所有计算均以国际单位制（SI）进行。无需外部输入，程序必须完全自包含且可执行。",
            "solution": "用户提供的问题是计算流体力学中一个适定且有科学依据的练习，具体涉及低雷诺数湍流模型的验证。该问题要求对完全发展的平面槽道流的简化 $v^2-f$ 湍流封闭模型进行数值求解，以验证其近壁阻尼特性。求解过程是通过使用有限差分法离散化控制方程，并为三个指定的测试案例中的每一个求解所得到的代数方程组。\n\n计算域为半槽道高度，$y \\in [0,h]$。该域被离散化为 $N=401$ 个均匀间隔的网格点 $y_i = i \\cdot \\Delta y$，$i=0, 1, \\dots, N-1$，其中网格间距为 $\\Delta y = h / (N-1)$。对每个测试案例执行求解程序，每个案例由一组三个参数定义：摩擦雷诺数 $\\mathrm{Re}_\\tau$、湍动能振幅 $A_k$ 和耗散率振幅 $A_\\epsilon$。\n\n计算顺序如下：\n\n1.  **初始化**：对于每个测试案例 $(\\mathrm{Re}_\\tau, A_k, A_\\epsilon)$，计算基本物理参数。运动黏度为 $\\nu = \\mu/\\rho$。摩擦速度 $u_\\tau$ 是壁面束缚湍流中的一个关键速度尺度，根据其与摩擦雷诺数的关系定义导出：$u_\\tau = \\mathrm{Re}_\\tau \\nu / h$。\n\n2.  **预设剖面**：在网格 $y_i$ 上计算一组与流动和湍流相关的剖面：\n    -   总剪切应力 $\\tau_{\\text{tot}}(y)$，其值从壁面处（$y=0$）的最大值 $\\tau_w = \\rho u_\\tau^2$ 线性变化到槽道中心线处（$y=h$）的零。\n    -   平均剪切率 $S(y)$ 近似为 $S(y) \\approx \\tau_{\\text{tot}}(y)/\\mu$，这在黏性主导的近壁区域是有效的，并根据问题的指示在整个域中使用。\n    -   湍动能 $k(y)$ 及其耗散率 $\\epsilon(y)$ 使用所提供的具有物理动机的解析函数进行评估。这些剖面正确地捕捉了近壁区的标度律行为，其中 $k(y) \\propto y^2$ 且 $\\epsilon(y)$ 在壁面处趋于一个有限值。\n    -   椭圆松弛长度尺度 $L(y)$ 计算为 $L(y) = C_\\eta \\nu / \\sqrt{\\epsilon(y)}$。\n\n3.  **求解壁面法向分量分数 $b(y)$**：量 $b(y)$ 表示壁面法向湍动能与总湍动能之比。它是通过求解以下二阶线性边值问题（BVP）获得的：\n    $$L(y)^2\\, \\frac{d^2 b}{dy^2}(y) - b(y) = -\\frac{1}{3}$$\n    边界条件为 $b(0) = 0$ 和 $\\frac{db}{dy}(h) = 0$。该方程使用二阶中心差分对二阶导数进行离散化，从而得到一个线性代数方程组。\n    -   在内部网格点 $y_i$ 处，离散化的方程为：\n        $$\\frac{L_i^2}{(\\Delta y)^2} b_{i-1} - \\left(\\frac{2L_i^2}{(\\Delta y)^2} + 1\\right)b_i + \\frac{L_i^2}{(\\Delta y)^2} b_{i+1} = -\\frac{1}{3}$$\n    -   壁面处的 Dirichlet 条件 $b_0 = 0$ 被直接设置。\n    -   中心线处的 Neumann 条件 $\\frac{db}{dy}(h) = 0$ 使用二阶精度的“虚拟点”方法实现，这将最后一个网格点 $y_{N-1}$ 处的方程修改为：\n        $$\\frac{2L_{N-1}^2}{(\\Delta y)^2} b_{N-2} - \\left(\\frac{2L_{N-1}^2}{(\\Delta y)^2} + 1\\right)b_{N-1} = -\\frac{1}{3}$$\n    这为未知值 $b_1, \\dots, b_{N-1}$ 产生一个三对角线性系统，然后对其进行求解。\n\n4.  **求解椭圆松弛变量 $f(y)$**：变量 $f(y)$ 是 $v^2-f$ 模型的一个关键组成部分，它将非局部的壁面效应引入到压力-应变项中。它通过求解一个类似的 BVP 来确定：\n    $$L(y)^2\\, \\frac{d^2 f}{dy^2}(y) - f(y) = C_2\\, \\chi(y)\\, \\left(b(y) - \\frac{1}{3}\\right)$$\n    边界条件为 $f(0) = f_w$ 和 $\\frac{df}{dy}(h) = 0$。右侧的源项依赖于先前计算的 $b(y)$ 和一个正则化比率 $\\chi(y) = \\min(\\epsilon(y)/\\max(k(y), k_{\\text{floor}}), \\chi_{\\max})$。离散化方法与 $b(y)$ 方程的方法相同，产生另一个三对角线性系统。非齐次 Dirichlet 条件 $f_0=f_w$ 通过将已知项移到系统中第一个方程的右侧来处理。\n\n5.  **计算湍流时间尺度和涡黏度**：\n    -   一旦 $b(y)$ 和 $f(y)$ 已知，壁面法向湍流强度就计算为 $v^2(y) = b(y)k(y)$。\n    -   通过取三个不同时间尺度的最小值来构造一个复合湍流时间尺度 $\\tau(y)$：\n        1.  大涡时间尺度：$\\tau_1 = k(y)/\\epsilon(y)$。\n        2.  基于剪切的时间尺度：$\\tau_2 = 1/(|f(y)|\\max(|S(y)|, S_{\\min}))$。\n        3.  Kolmogorov (黏性) 时间尺度：$\\tau_3 = C_T \\sqrt{\\nu/\\epsilon(y)}$。\n        这个最小值函数 $\\tau(y) = \\min(\\tau_1, \\tau_2, \\tau_3)$ 确保模型在域中的每个点选择限制性最强（最快）的物理过程，从而强制实现正确的近壁阻尼。\n    -   最后，涡黏度 $\\mu_t(y)$，它代表了湍流脉动对平均流动量传递的影响，根据其在 $v^2-f$ 模型中的定义进行计算：\n        $$\\mu_t(y) = \\rho\\, C_\\mu\\, v^2(y)\\, \\tau(y)$$\n\n6.  **近壁阻尼的验证**：主要目标是验证该模型表现出强烈的近壁阻尼。这通过检查第一个离壁网格点 $y_1 = \\Delta y$ 处的涡黏度是否显著小于分子黏度 $\\mu$ 来评估。对每个测试案例评估布尔条件 $\\mu_t(y_1)/\\mu  10^{-3}$。所有三个案例的结果被收集到一个列表中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_bvp(L, dy, N, R, u0):\n    \"\"\"\n    Solves the BVP: L(y)^2 * u''(y) - u(y) = R(y)\n    with boundary conditions u(0) = u0 and u'(h) = 0.\n    \n    Args:\n        L (np.array): Profile of the length scale L(y).\n        dy (float): Grid spacing.\n        N (int): Number of grid points.\n        R (np.array): Right-hand side profile R(y).\n        u0 (float): Dirichlet boundary condition at y=0.\n        \n    Returns:\n        np.array: The solution profile u(y) of size N.\n    \"\"\"\n    # The system is solved for the N-1 unknown points u[1], ..., u[N-1].\n    M = np.zeros((N - 1, N - 1))\n    \n    # Pre-calculate alpha = (L/dy)^2 for the unknown points.\n    alpha = (L[1:] / dy)**2\n    \n    # Main diagonal: -(2*alpha + 1)\n    np.fill_diagonal(M, -(2 * alpha + 1))\n    \n    # Upper diagonal (k=1): alpha_i for equation at i\n    # This corresponds to alpha values for points i=1 to N-2\n    np.fill_diagonal(M[:, 1:], alpha[:-1])\n    \n    # Lower diagonal (k=-1): alpha_i for equation at i\n    # This corresponds to alpha values for points i=2 to N-1\n    np.fill_diagonal(M[1:, :], alpha[1:])\n    \n    # Modify the last row for the Neumann boundary condition u'(h)=0\n    # The coefficient for u_{N-2} becomes 2*alpha_{N-1}\n    M[-1, -2] = 2 * alpha[-1]\n    \n    # Construct the right-hand side vector `b_vec` for the system Ax=b\n    b_vec = R[1:]\n    \n    # Account for the non-homogeneous Dirichlet BC at y=0\n    b_vec[0] -= alpha[0] * u0\n    \n    # Solve the tridiagonal system\n    u_solution = np.linalg.solve(M, b_vec)\n    \n    # Combine the BC value with the solved interior points\n    u = np.concatenate(([u0], u_solution))\n    \n    return u\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print results.\n    \"\"\"\n    # Define physical and model constants in SI units\n    rho = 1000.0  # kg/m^3\n    mu = 1.0e-3   # Pa.s\n    h = 0.01      # m\n    C_mu = 0.22\n    C_eta = 70.0\n    C_2 = 0.3\n    C_T = 6.0\n    f_w = -0.5\n    k_floor_factor = 1.0e-8\n    chi_max = 1.0e6   # s^-1\n    S_min = 1.0e-6    # s^-1\n    nu = mu / rho     # m^2/s\n    \n    # Define numerical parameters\n    N = 401 # Number of grid points (at least 400)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (150, 0.25, 1.4), # (Re_tau, A_k, A_epsilon)\n        (395, 0.30, 1.5),\n        (590, 0.30, 1.7),\n    ]\n\n    results = []\n    for Re_tau, A_k, A_epsilon in test_cases:\n        # 1. Calculate primary parameters\n        u_tau = Re_tau * nu / h\n        \n        # 2. Set up the grid\n        y = np.linspace(0, h, N)\n        dy = h / (N - 1)\n        \n        # 3. Calculate prescribed profiles\n        tau_tot = rho * u_tau**2 * (1 - y / h)\n        cos_term = np.cos(np.pi * y / h)\n        k = A_k * u_tau**2 * (1 - cos_term)**2\n        epsilon = A_epsilon * (u_tau**3 / h) * (1 + 0.5 * (1 - cos_term))\n        L = C_eta * nu / np.sqrt(epsilon)\n        S = tau_tot / mu\n\n        # 4. Solve BVP for b(y)\n        R_b = np.full(N, -1.0/3.0)\n        b = solve_bvp(L, dy, N, R_b, 0.0)\n\n        # 5. Calculate profiles needed for the f-BVP\n        v2 = b * k\n        k_floor_val = k_floor_factor * u_tau**2\n        k_regularized = np.maximum(k, k_floor_val)\n        chi = np.minimum(epsilon / k_regularized, chi_max)\n\n        # 6. Solve BVP for f(y)\n        R_f = C_2 * chi * (b - 1.0/3.0)\n        f = solve_bvp(L, dy, N, R_f, f_w)\n\n        # 7. Calculate timescale and eddy viscosity\n        # Timescale component 1: k/epsilon\n        tau1 = k / epsilon\n        # Timescale component 2: 1/(|f|*|S|)\n        abs_f = np.abs(f)\n        S_regularized = np.maximum(np.abs(S), S_min)\n        tau2 = 1.0 / (abs_f * S_regularized)\n        # Timescale component 3: viscous timescale\n        tau3 = C_T * np.sqrt(nu / epsilon)\n        \n        # Composite timescale is the minimum of the components\n        tau = np.minimum.reduce([tau1, tau2, tau3])\n        \n        # Eddy viscosity\n        mu_t = rho * C_mu * v2 * tau\n\n        # 8. Check the near-wall damping condition\n        # y_1 is the first off-wall grid point, at index 1\n        is_damped = (mu_t[1] / mu)  1.0e-3\n        results.append(is_damped)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}