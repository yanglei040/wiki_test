{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of understanding turbulence is analyzing the energy budget of the mean flow. The interaction between mean and fluctuating velocity fields governs the transfer of kinetic energy, which in most common shear flows cascades from the large-scale mean motion to the smaller-scale turbulent eddies. This practice guides you through the derivation of the mean kinetic energy equation to identify the production term $-\\overline{u_i' u_j'} \\partial_j \\bar{u}_i$, which quantifies this energy transfer. By designing a controlled numerical experiment, you will explore both the canonical energy cascade and the counter-intuitive \"counter-gradient\" scenario where energy flows from the turbulence back to the mean flow, a crucial test case for the validity of RANS models .",
            "id": "3357831",
            "problem": "Consider a constant-density, incompressible, Newtonian fluid governed by the fundamental momentum balance and mass conservation. The fundamental base you must start from is the following:\n\n- Incompressible continuity: $\\partial_i u_i = 0$.\n- Newtonian momentum equation: $\\partial_t u_i + u_j \\partial_j u_i = -\\frac{1}{\\rho} \\partial_i p + \\nu \\partial_j \\partial_j u_i + f_i$, where $\\rho$ is density, $\\nu$ is kinematic viscosity, and $f_i$ is a body force per unit mass.\n\nTask A (derivation): Applying Reynolds decomposition $u_i = \\bar{u}_i + u_i'$ and $p = \\bar{p} + p'$ and an averaging operator satisfying Reynolds rules, derive the mean kinetic energy equation for the mean flow of the Reynolds-Averaged Navier-Stokes (RANS) system. Your derivation must begin from the stated fundamental base and use only mathematically valid manipulations and identities consistent with incompressibility. Identify the term that transfers kinetic energy between the mean field and turbulent fluctuations, and express this term in a coordinate-free tensor contraction with the mean velocity gradient. Do not use any shortcut formula; your derivation must be from first principles.\n\nTask B (controlled experiment and computation): Design a controlled, spatially uniform experiment in which the transfer term of Task A changes sign by varying the sign of the Reynolds stress relative to the mean velocity gradient. For mathematical concreteness, represent the mean velocity gradient by a constant tensor $G_{ij} = \\partial_j \\bar{u}_i$ (units $\\mathrm{s}^{-1}$) and the Reynolds stress by a constant symmetric tensor $R_{ij} = \\overline{u_i' u_j'}$ (units $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$). For each case, the instantaneous rate of mean-to-turbulence kinetic energy transfer per unit mass is defined as the scalar\n$$\nP \\equiv -\\sum_{i=1}^3 \\sum_{j=1}^3 R_{ij} \\, G_{ij},\n$$\nwith units $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$.\n\nAdditionally, to assess a common modeling response, compute the prediction of the Boussinesq eddy viscosity closure, which assumes $R_{ij}^{\\text{model}} \\approx -2 \\nu_t S_{ij}$ where $S_{ij} \\equiv \\tfrac{1}{2}(G_{ij}+G_{ji})$ is the mean rate-of-strain tensor and $\\nu_t \\ge 0$ is a scalar eddy viscosity. For a given $(R_{ij},G_{ij})$, define the least-squares best-fit eddy viscosity\n$$\n\\nu_t^\\star \\equiv -\\frac{\\sum_{i,j} R_{ij}\\, S_{ij}}{2 \\sum_{i,j} S_{ij}\\, S_{ij}},\n$$\nand constrain the model to $\\nu_t = \\max(0,\\nu_t^\\star)$. The corresponding modeled transfer rate is then\n$$\nP_{\\text{model}} \\equiv 2 \\nu_t \\sum_{i,j} S_{ij}\\, S_{ij}.\n$$\n\nYou must implement a program that, for each test case, computes the pair $(P, P_{\\text{model}})$ and a boolean flag indicating whether $P$ is negative (sign change relative to the canonical positive mean-to-turbulence transfer). All computed transfer rates must be expressed in $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$, rounded to six decimal places.\n\nTest Suite: Use the following five scientifically plausible cases (all tensors are $3 \\times 3$ with entries in SI units):\n\n- Case $1$ (canonical plane shear, positive transfer): $G = \\begin{bmatrix} 0 & 5 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, $R = \\begin{bmatrix} 0 & -0.02 & 0 \\\\ -0.02 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n- Case $2$ (counter-gradient, negative transfer): $G = \\begin{bmatrix} 0 & 5 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, $R = \\begin{bmatrix} 0 & 0.005 & 0 \\\\ 0.005 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n- Case $3$ (zero shear boundary case): $G = \\begin{bmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, $R = \\begin{bmatrix} 0 & -0.01 & 0 \\\\ -0.01 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n- Case $4$ (three-dimensional mixed gradients with anisotropic stress): $G = \\begin{bmatrix} 0 & 4 & 0 \\\\ 2 & 0 & -3 \\\\ 0 & 0 & 0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, $R = \\begin{bmatrix} 0.10 & -0.03 & 0.00 \\\\ -0.03 & 0.08 & 0.01 \\\\ 0.00 & 0.01 & 0.05 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n- Case $5$ (closure-consistent shear with known eddy viscosity): $G = \\begin{bmatrix} 0 & 10 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\,\\mathrm{s}^{-1}$, with a known eddy viscosity $\\nu_t = 0.01\\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$ used to define $R$ via $R = -2 \\nu_t S$ where $S = \\tfrac{1}{2}(G+G^\\top)$; explicitly $R = \\begin{bmatrix} 0 & -0.10 & 0 \\\\ -0.10 & 0 & 0 \\\\ 0 & 0 & 0 \\end{bmatrix}\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$.\n\nAnswer specification and final output format: Your program must produce a single line containing a list of results, one per test case, where each result is the list $[P, P_{\\text{model}}, \\text{is\\_negative}]$ with $P$ and $P_{\\text{model}}$ rounded to six decimal places and $\\text{is\\_negative}$ a boolean indicating whether $P < 0$. The overall output must be a single list enclosing the five case results, formatted exactly as a comma-separated list enclosed in square brackets, for example\n$[[P_1,P_{\\text{model},1},\\text{is\\_negative}_1],[P_2,P_{\\text{model},2},\\text{is\\_negative}_2],\\dots]$,\nwith all $P$ and $P_{\\text{model}}$ in $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$.",
            "solution": "We begin from the incompressible mass conservation $\\partial_i u_i = 0$ and the Newtonian momentum equation $\\partial_t u_i + u_j \\partial_j u_i = -\\frac{1}{\\rho} \\partial_i p + \\nu \\partial_j \\partial_j u_i + f_i$. Introduce Reynolds decomposition $u_i = \\bar{u}_i + u_i'$ and $p = \\bar{p} + p'$, and apply an averaging operator with Reynolds rules, $\\overline{u_i'} = 0$, $\\overline{\\bar{u}_i} = \\bar{u}_i$, linearity, and commutation with differentiation for statistically stationary averages. The Reynolds-Averaged Navier-Stokes (RANS) mean momentum equation is\n$$\n\\partial_t \\bar{u}_i + \\bar{u}_j \\partial_j \\bar{u}_i = -\\frac{1}{\\rho} \\partial_i \\bar{p} + \\nu \\partial_j \\partial_j \\bar{u}_i - \\partial_j \\overline{u_i' u_j'} + \\bar{f}_i,\n$$\nwith $\\partial_i \\bar{u}_i = 0$.\n\nTo derive the mean kinetic energy equation, multiply the mean momentum equation by $\\bar{u}_i$, and use product rules and incompressibility. Define the mean kinetic energy per unit mass $K \\equiv \\tfrac{1}{2} \\bar{u}_i \\bar{u}_i$. The time derivative term becomes $\\bar{u}_i \\partial_t \\bar{u}_i = \\partial_t K$. The mean convection term is $\\bar{u}_i \\bar{u}_j \\partial_j \\bar{u}_i = \\bar{u}_j \\partial_j K$ by the chain rule. Pressure work combines into a divergence using $\\bar{u}_i \\partial_i \\bar{p} = \\partial_i (\\bar{p}\\,\\bar{u}_i) - \\bar{p} \\partial_i \\bar{u}_i = \\partial_i (\\bar{p}\\,\\bar{u}_i)$ due to $\\partial_i \\bar{u}_i = 0$. Viscous work splits into a sum of a dissipation-like term and a divergence: $\\nu \\bar{u}_i \\partial_j \\partial_j \\bar{u}_i = \\nu \\partial_j (\\bar{u}_i \\partial_j \\bar{u}_i) - \\nu (\\partial_j \\bar{u}_i) (\\partial_j \\bar{u}_i)$. Body force work is $\\bar{f}_i \\bar{u}_i$. The Reynolds stress transport term contributes $\\bar{u}_i \\left(-\\partial_j \\overline{u_i' u_j'}\\right) = -\\partial_j(\\bar{u}_i \\overline{u_i' u_j'}) + \\overline{u_i' u_j'} \\partial_j \\bar{u}_i$ by product rules.\n\nCollecting terms into a conservative form,\n$$\n\\partial_t K + \\bar{u}_j \\partial_j K + \\partial_j\\left(\\frac{\\bar{p}}{\\rho}\\bar{u}_j + \\nu \\bar{u}_i \\partial_j \\bar{u}_i - \\bar{u}_i \\overline{u_i' u_j'}\\right)\n= -\\nu (\\partial_j \\bar{u}_i)(\\partial_j \\bar{u}_i) - \\overline{u_i' u_j'}\\,\\partial_j \\bar{u}_i + \\bar{f}_i \\bar{u}_i.\n$$\nHere, the scalar term $-\\overline{u_i' u_j'}\\,\\partial_j \\bar{u}_i$ transfers kinetic energy between mean and turbulent fields: when it is positive, mean kinetic energy is lost (a sink) and turbulent kinetic energy is produced; when it is negative, turbulent fluctuations feed energy back into the mean flow (a source for the mean). Because the Reynolds stress tensor $R_{ij} \\equiv \\overline{u_i' u_j'}$ is symmetric, and the mean velocity gradient $\\partial_j \\bar{u}_i$ can be decomposed into the symmetric rate-of-strain $S_{ij} \\equiv \\tfrac{1}{2}(\\partial_j \\bar{u}_i + \\partial_i \\bar{u}_j)$ and the antisymmetric rotation $W_{ij} \\equiv \\tfrac{1}{2}(\\partial_j \\bar{u}_i - \\partial_i \\bar{u}_j)$, the contraction simplifies to $-\\overline{u_i' u_j'}\\,\\partial_j \\bar{u}_i = -R_{ij} S_{ij}$ because $R_{ij} W_{ij} = 0$.\n\nFor the controlled experiment, we choose spatially uniform $G_{ij} \\equiv \\partial_j \\bar{u}_i$ and $R_{ij}$ to form five test cases. The transfer rate per unit mass is defined as\n$$\nP \\equiv -\\sum_{i=1}^3 \\sum_{j=1}^3 R_{ij}\\,G_{ij},\n$$\nwith units $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$. To assess the model response, adopt the Boussinesq eddy viscosity closure for the modeled Reynolds stress, $R_{ij}^{\\text{model}} \\approx -2 \\nu_t S_{ij}$, where $S_{ij} = \\tfrac{1}{2}(G_{ij}+G_{ji})$ and $\\nu_t \\ge 0$. For a given $(R,G)$, the least-squares fit for a scalar $\\nu_t^\\star$ minimizing $\\|R + 2 \\nu_t S\\|_F^2$ yields\n$$\n\\nu_t^\\star = -\\frac{\\sum_{i,j} R_{ij} S_{ij}}{2 \\sum_{i,j} S_{ij} S_{ij}},\n$$\nand constraining the model $\\nu_t = \\max(0,\\nu_t^\\star)$ ensures nonnegative modeled production. The modeled transfer rate is\n$$\nP_{\\text{model}} = 2 \\nu_t \\sum_{i,j} S_{ij} S_{ij}.\n$$\n\nThe five test cases are as specified, all expressed in SI units. The computational algorithm for each case is:\n\n- Compute $P = -\\sum_{i,j} R_{ij} G_{ij}$.\n- Compute $S = \\tfrac{1}{2}(G + G^\\top)$, the Frobenius norm squared $||S||_F^2 = \\sum_{i,j} S_{ij} S_{ij}$, and the inner product $\\langle R,S \\rangle = \\sum_{i,j} R_{ij} S_{ij}$.\n- If $||S||_F^2 = 0$, set $P_{\\text{model}} = 0$. Otherwise, compute $\\nu_t^\\star = -\\langle R,S\\rangle / (2 ||S||_F^2)$ and $\\nu_t = \\max(0,\\nu_t^\\star)$, then $P_{\\text{model}} = 2 \\nu_t ||S||_F^2$.\n- The boolean flag $\\text{is\\_negative}$ is true if $P < 0$.\n\nInterpretation and physical plausibility: In canonical shear-driven turbulence, the cross-correlation $R_{12} = \\overline{u' v'}$ is typically opposite in sign to the mean shear $G_{12} = \\partial_y \\bar{u}$, so $P$ is positive, indicating transfer from the mean to turbulence. Counter-gradient momentum transport can occur in strongly rotating shear flows (e.g., low absolute vorticity) or in flows with strong curvature or nonlocal history effects, causing $R_{12}$ to have the same sign as $G_{12}$, rendering $P$ negative. The scalar eddy viscosity Boussinesq closure enforces $\\nu_t \\ge 0$, implying $P_{\\text{model}} \\ge 0$ and thus cannot represent negative $P$; in the least-squares fit, this manifests as $\\nu_t^\\star < 0$ being truncated to $0$, yielding $P_{\\text{model}} = 0$ where the true transfer $P$ is negative. The boundary case with zero shear has $S_{ij} = 0$ and both $P$ and $P_{\\text{model}}$ equal to $0$, consistent with no mean-to-turbulence transfer.\n\nFinally, your program must implement these computations for the specified test suite, and print a single line containing a list of five results, each as $[P, P_{\\text{model}}, \\text{is\\_negative}]$ with $P$ and $P_{\\text{model}}$ rounded to six decimal places and units $\\mathrm{m}^2\\,\\mathrm{s}^{-3}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_production(R: np.ndarray, G: np.ndarray) -> float:\n    \"\"\"\n    Compute mean-to-turbulence kinetic energy transfer rate:\n    P = - sum_{i,j} R_ij * G_ij\n    Units: m^2/s^3\n    \"\"\"\n    return float(-np.sum(R * G))\n\ndef compute_model_production(R: np.ndarray, G: np.ndarray) -> float:\n    \"\"\"\n    Compute modeled transfer rate using Boussinesq eddy viscosity closure with\n    nonnegative least-squares best-fit nu_t.\n    S = 0.5 * (G + G^T)\n    nu_t* = - <R,S> / (2 <S,S>)\n    nu_t = max(0, nu_t*)\n    P_model = 2 * nu_t * <S,S>\n    Edge case: if <S,S> == 0, return 0.\n    \"\"\"\n    S = 0.5 * (G + G.T)\n    denom = float(np.sum(S * S))\n    if denom == 0.0:\n        return 0.0\n    numerator = float(np.sum(R * S))\n    nu_t_star = - numerator / (2.0 * denom)\n    nu_t = max(0.0, nu_t_star)\n    return float(2.0 * nu_t * denom)\n\ndef format_result_list(results):\n    \"\"\"\n    Format the results as a single-line string of nested lists,\n    with floats rounded to six decimals and booleans as True/False.\n    \"\"\"\n    def fmt_float(x):\n        return f\"{x:.6f}\"\n    parts = []\n    for p_true, p_model, is_neg in results:\n        parts.append(f\"[{fmt_float(p_true)},{fmt_float(p_model)},{str(is_neg)}]\")\n    return \"[\" + \",\".join(parts) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (R, G) with 3x3 numpy arrays.\n    test_cases = [\n        # Case 1: canonical plane shear, positive transfer\n        (\n            np.array([[0.0, -0.02, 0.0],\n                      [-0.02, 0.0,  0.0],\n                      [0.0,  0.0,  0.0]]),\n            np.array([[0.0, 5.0, 0.0],\n                      [0.0, 0.0, 0.0],\n                      [0.0, 0.0, 0.0]])\n        ),\n        # Case 2: counter-gradient, negative transfer\n        (\n            np.array([[0.0, 0.005, 0.0],\n                      [0.005, 0.0,  0.0],\n                      [0.0,  0.0,  0.0]]),\n            np.array([[0.0, 5.0, 0.0],\n                      [0.0, 0.0, 0.0],\n                      [0.0, 0.0, 0.0]])\n        ),\n        # Case 3: zero shear boundary case\n        (\n            np.array([[0.0, -0.01, 0.0],\n                      [-0.01, 0.0,  0.0],\n                      [0.0,  0.0,  0.0]]),\n            np.zeros((3,3))\n        ),\n        # Case 4: three-dimensional mixed gradients with anisotropic stress\n        (\n            np.array([[0.10, -0.03, 0.00],\n                      [-0.03, 0.08, 0.01],\n                      [0.00, 0.01, 0.05]]),\n            np.array([[0.0, 4.0, 0.0],\n                      [2.0, 0.0, -3.0],\n                      [0.0, 0.0, 0.0]])\n        ),\n        # Case 5: closure-consistent shear with known eddy viscosity nu_t=0.01\n        (\n            np.array([[0.0, -0.10, 0.0],\n                      [-0.10, 0.0,  0.0],\n                      [0.0,  0.0,  0.0]]),\n            np.array([[0.0, 10.0, 0.0],\n                      [0.0,  0.0, 0.0],\n                      [0.0,  0.0, 0.0]])\n        ),\n    ]\n\n    results = []\n    for R, G in test_cases:\n        p_true = compute_production(R, G)\n        p_model = compute_model_production(R, G)\n        is_negative = p_true < 0.0\n        results.append((p_true, p_model, is_negative))\n\n    # Final print statement in the exact required format.\n    print(format_result_list(results))\n\nsolve()\n```"
        },
        {
            "introduction": "The Boussinesq hypothesis, which linearly relates the Reynolds stress to the mean strain-rate, forms the basis of the most widely used RANS models. However, its core assumption—that the principal axes of the Reynolds stress anisotropy tensor $b_{ij}$ align with those of the mean strain-rate tensor $S_{ij}$—is often violated in complex flows. This exercise introduces a rigorous, quantitative method to evaluate this assumption by projecting the true anisotropy onto the subspace spanned by the strain-rate tensor. By calculating metrics such as cosine alignment and relative error for various flow scenarios, you will develop a powerful diagnostic tool for assessing the limitations of linear eddy-viscosity models .",
            "id": "3357794",
            "problem": "Consider an incompressible turbulent flow described by the Reynolds-averaged Navier–Stokes equations, where Reynolds decomposition yields a mean velocity field and turbulent fluctuations. The second-order turbulent moment is the Reynolds stress tensor, denoted by $\\overline{u_i' u_j'}$, and the turbulent kinetic energy is defined as $k = \\tfrac{1}{2} \\overline{u_i' u_i'}$. The anisotropy tensor is defined as $b_{ij} = \\overline{u_i' u_j'}/(2k) - \\delta_{ij}/3$, which is symmetric and traceless. The Boussinesq eddy-viscosity hypothesis assumes the deviatoric part of the Reynolds stress is isotropic with respect to principal directions of the mean strain rate, giving a modeled anisotropy of the form $b_{ij}^{\\mathrm{EV}} = -(\\nu_t/k) S_{ij}$, where $S_{ij} = \\tfrac{1}{2}(\\partial U_i/\\partial x_j + \\partial U_j/\\partial x_i)$ is the mean rate-of-strain tensor and $\\nu_t$ is a scalar turbulent viscosity.\n\nIn non-equilibrium separated flows, the true anisotropy can be misaligned with the mean strain rate. One way to quantify the error introduced by the isotropy assumption is to project the true anisotropy onto the one-dimensional subspace spanned by the mean strain-rate tensor. Treat the space of symmetric second-order tensors with the Frobenius inner product $\\langle A, B\\rangle = A_{ij} B_{ij}$ and norm $\\|A\\|_F = \\sqrt{\\langle A, A\\rangle}$. For a given Reynolds stress tensor $\\overline{u_i' u_j'}$ and rate-of-strain tensor $S_{ij}$, define:\n- the true anisotropy $b_{ij} = \\overline{u_i' u_j'}/(2k) - \\delta_{ij}/3$ with $k = \\tfrac{1}{2}\\overline{u_i' u_i'}$,\n- the best-fit eddy-viscosity anisotropy $b_{ij}^{\\mathrm{fit}}$ as the orthogonal projection of $b_{ij}$ onto the span of $S_{ij}$, that is, $b_{ij}^{\\mathrm{fit}} = \\operatorname*{arg\\,min}_{\\alpha \\in \\mathbb{R}} \\| b_{ij} - \\alpha S_{ij}\\|_F$,\n- the relative residual error $r = \\| b_{ij} - b_{ij}^{\\mathrm{fit}}\\|_F / \\|b_{ij}\\|_F$ (define $r = 0$ if $\\|b_{ij}\\|_F = 0$),\n- the cosine alignment $c = \\langle b_{ij}, S_{ij}\\rangle / (\\|b_{ij}\\|_F \\|S_{ij}\\|_F)$, with the convention $c = 1$ if both $\\|b_{ij}\\|_F = 0$ and $\\|S_{ij}\\|_F = 0$, and $c = 0$ if exactly one of these norms is zero.\n\nStarting only from these definitions and the fundamental structure of the Reynolds-averaged Navier–Stokes equations and Reynolds decomposition, derive the algorithm to compute $r$ and $c$ for a given pair of tensors $(\\overline{u_i' u_j'}, S_{ij})$, and implement it as a program that outputs the error metrics for a small test suite representing different regimes relevant to non-equilibrium separated flows. All quantities are to be treated as dimensionless for the purpose of this computation, and no physical units should be reported in the output.\n\nUse the following test suite of symmetric tensors, each case specified by a pair $(\\overline{u_i' u_j'}, S_{ij})$:\n\n- Case 1 (equilibrium-aligned shear, happy path):\n  - $\\overline{u_i' u_j'} = \\begin{bmatrix} 1.0 & -0.6 & 0.0 \\\\ -0.6 & 1.0 & 0.0 \\\\ 0.0 & 0.0 & 1.0 \\end{bmatrix}$,\n  - $S_{ij} = \\begin{bmatrix} 0.0 & 1.0 & 0.0 \\\\ 1.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$.\n- Case 2 (non-equilibrium separated-like misalignment):\n  - $\\overline{u_i' u_j'} = \\begin{bmatrix} 2.2 & 0.2 & -0.1 \\\\ 0.2 & 0.6 & 0.05 \\\\ -0.1 & 0.05 & 0.4 \\end{bmatrix}$,\n  - $S_{ij} = \\begin{bmatrix} 0.0 & 1.0 & 0.0 \\\\ 1.0 & 0.3 & 0.6 \\\\ 0.0 & 0.6 & -0.3 \\end{bmatrix}$.\n- Case 3 (isotropic stress, edge case with zero anisotropy):\n  - $\\overline{u_i' u_j'} = \\begin{bmatrix} 0.8 & 0.0 & 0.0 \\\\ 0.0 & 0.8 & 0.0 \\\\ 0.0 & 0.0 & 0.8 \\end{bmatrix}$,\n  - $S_{ij} = \\begin{bmatrix} 0.0 & 0.5 & 0.0 \\\\ 0.5 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$.\n- Case 4 (zero strain, edge case with irreducible anisotropy):\n  - $\\overline{u_i' u_j'} = \\begin{bmatrix} 3.0 & 0.2 & 0.1 \\\\ 0.2 & 1.0 & 0.05 \\\\ 0.1 & 0.05 & 0.5 \\end{bmatrix}$,\n  - $S_{ij} = \\begin{bmatrix} 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\\\ 0.0 & 0.0 & 0.0 \\end{bmatrix}$.\n\nYour program should, for each case, compute the pair $(r, c)$ as defined above and produce a single line of output containing the results as a comma-separated list of pairs enclosed in square brackets in the order of the cases, where each number is rounded to six decimal places. For example, the required format is [[r1,c1],[r2,c2],[r3,c3],[r4,c4]] with no additional text.",
            "solution": "The problem requires the derivation and implementation of an algorithm to compute two metrics, the relative residual error $r$ and the cosine alignment $c$, which quantify the validity of the Boussinesq eddy-viscosity hypothesis for a given turbulent flow state. The state is defined by the Reynolds stress tensor $\\overline{u_i' u_j'}$ and the mean rate-of-strain tensor $S_{ij}$.\n\nFirst, we formalize the necessary quantities. All tensors are considered elements of the vector space of $3 \\times 3$ real matrices, equipped with the Frobenius inner product $\\langle A, B\\rangle = A_{ij} B_{ij}$ and its induced norm $\\|A\\|_F = \\sqrt{\\langle A, A\\rangle}$.\n\nThe turbulent kinetic energy $k$ is half the trace of the Reynolds stress tensor:\n$$k = \\frac{1}{2} \\overline{u_i' u_i'} = \\frac{1}{2} \\operatorname{tr}(\\overline{u_i' u_j'})$$\nThe anisotropy tensor $b_{ij}$ is defined as the deviatoric part of the normalized Reynolds stress tensor:\n$$b_{ij} = \\frac{\\overline{u_i' u_j'}}{2k} - \\frac{1}{3}\\delta_{ij}$$\nwhere $\\delta_{ij}$ is the Kronecker delta. By construction, $b_{ij}$ is a symmetric and traceless tensor. This holds provided $k \\neq 0$. If $k=0$, the Reynolds stress tensor $\\overline{u_i' u_j'}$ must be the zero tensor, as its diagonal elements, which are variances, would be zero. In this situation, the turbulence is non-existent, and the notion of anisotropy is ill-defined. However, the limit as $k \\to 0$ would imply $b_{ij} \\to 0$, so we can consider $b_{ij}$ to be the zero tensor if $k=0$.\n\nThe core of the problem is to find the best approximation of $b_{ij}$ by a tensor proportional to $S_{ij}$. This is an orthogonal projection problem. We seek the tensor $b_{ij}^{\\mathrm{fit}}$ in the one-dimensional subspace spanned by $S_{ij}$ that is closest to $b_{ij}$. This is expressed as:\n$$b_{ij}^{\\mathrm{fit}} = \\alpha S_{ij}$$\nwhere $\\alpha \\in \\mathbb{R}$ is the scalar coefficient that minimizes the squared Frobenius norm of the residual, $\\|b_{ij} - \\alpha S_{ij}\\|_F^2$. Let us define the objective function $L(\\alpha)$:\n$$L(\\alpha) = \\|b - \\alpha S\\|_F^2 = \\langle b - \\alpha S, b - \\alpha S \\rangle$$\nExpanding the inner product:\n$$L(\\alpha) = \\langle b, b \\rangle - 2\\alpha \\langle b, S \\rangle + \\alpha^2 \\langle S, S \\rangle = \\|b\\|_F^2 - 2\\alpha \\langle b, S \\rangle + \\alpha^2 \\|S\\|_F^2$$\nTo find the minimum, we compute the derivative of $L(\\alpha)$ with respect to $\\alpha$ and set it to zero:\n$$\\frac{dL}{d\\alpha} = -2 \\langle b, S \\rangle + 2\\alpha \\|S\\|_F^2 = 0$$\nSolving for $\\alpha$, assuming $\\|S\\|_F^2 \\neq 0$:\n$$\\alpha = \\frac{\\langle b, S \\rangle}{\\|S\\|_F^2}$$\nIf $\\|S\\|_F = 0$, then $S_{ij}$ is the zero tensor. The subspace spanned by $S_{ij}$ contains only the zero tensor, so the projection $b_{ij}^{\\mathrm{fit}}$ must be the zero tensor.\n\nThe cosine alignment $c$ is defined directly as the cosine of the angle between $b_{ij}$ and $S_{ij}$ in the vector space:\n$$c = \\frac{\\langle b, S \\rangle}{\\|b\\|_F \\|S\\|_F}$$\nThe problem provides specific conventions for cases where norms are zero:\n1. If $\\|b\\|_F = 0$ and $\\|S\\|_F = 0$, then $c=1$.\n2. If exactly one of $\\|b\\|_F$ or $\\|S\\|_F$ is zero, then $c=0$.\n\nThe relative residual error $r$ is defined as:\n$$r = \\frac{\\| b - b^{\\mathrm{fit}}\\|_F}{\\|b\\|_F}$$\nwith the special condition that $r=0$ if $\\|b\\|_F=0$.\nThe residual vector, $b - b^{\\mathrm{fit}}$, is by construction orthogonal to the projection subspace spanned by $S$. Therefore, it is orthogonal to $b^{\\mathrm{fit}}$. By the Pythagorean theorem in this inner product space, we have:\n$$\\|b\\|_F^2 = \\|b^{\\mathrm{fit}}\\|_F^2 + \\|b - b^{\\mathrm{fit}}\\|_F^2$$\nThus, the squared norm of the residual is $\\|b - b^{\\mathrm{fit}}\\|_F^2 = \\|b\\|_F^2 - \\|b^{\\mathrm{fit}}\\|_F^2$.\nWe can express $\\|b^{\\mathrm{fit}}\\|_F^2$ using $\\alpha$:\n$$\\|b^{\\mathrm{fit}}\\|_F^2 = \\|\\alpha S\\|_F^2 = \\alpha^2 \\|S\\|_F^2 = \\left(\\frac{\\langle b, S \\rangle}{\\|S\\|_F^2}\\right)^2 \\|S\\|_F^2 = \\frac{\\langle b, S \\rangle^2}{\\|S\\|_F^2}$$\nThis is valid when $\\|S\\|_F \\neq 0$.\nSubstituting this into the expression for the squared residual error, $r^2$:\n$$r^2 = \\frac{\\|b - b^{\\mathrm{fit}}\\|_F^2}{\\|b\\|_F^2} = \\frac{\\|b\\|_F^2 - \\|b^{\\mathrm{fit}}\\|_F^2}{\\|b\\|_F^2} = 1 - \\frac{\\|b^{\\mathrm{fit}}\\|_F^2}{\\|b\\|_F^2} = 1 - \\frac{\\langle b, S \\rangle^2}{\\|b\\|_F^2 \\|S\\|_F^2}$$\nRecognizing that the final term is the square of the cosine alignment $c$, we arrive at a simple relationship:\n$$r^2 = 1 - c^2 \\implies r = \\sqrt{1 - c^2}$$\nThis relationship holds provided $\\|b\\|_F \\neq 0$. Let's verify it against the edge cases.\n- If $\\|b\\|_F \\neq 0$ and $\\|S\\|_F = 0$: The definition of $c$ gives $c=0$. The formula then gives $r = \\sqrt{1-0^2}=1$. Let's check this against the fundamental definition of $r$. If $\\|S\\|_F=0$, then $b^{\\mathrm{fit}}=0$. The residual is $b-0=b$. Thus $r = \\|b\\|_F/\\|b\\|_F = 1$. The formula holds.\n- If $\\|b\\|_F = 0$: The problem explicitly states $r=0$, so we must use this definition directly.\n\nBased on this analysis, the algorithm for each pair $(\\overline{u_i' u_j'}, S_{ij})$ is as follows:\n\n1.  Compute the turbulent kinetic energy: $k = \\frac{1}{2} \\operatorname{tr}(\\overline{u_i' u_j'})$.\n2.  If $k=0$, then $\\overline{u_i' u_j'}$ is the zero tensor, which implies $b_{ij}$ is also the zero tensor. Otherwise, compute the anisotropy tensor: $b_{ij} = \\frac{\\overline{u_i' u_j'}}{2k} - \\frac{1}{3}\\delta_{ij}$.\n3.  Compute the Frobenius norms $\\|b\\|_F$ and $\\|S\\|_F$.\n4.  Compute the cosine alignment $c$ based on the provided rules:\n    - If $\\|b\\|_F \\approx 0$ and $\\|S\\|_F \\approx 0$, set $c=1.0$.\n    - If either $\\|b\\|_F \\approx 0$ or $\\|S\\|_F \\approx 0$ (but not both), set $c=0.0$.\n    - Otherwise, compute the inner product $\\langle b, S \\rangle = \\sum_{i,j} b_{ij}S_{ij}$ and set $c = \\langle b, S \\rangle / (\\|b\\|_F \\|S\\|_F)$.\n5.  Compute the relative residual error $r$:\n    - If $\\|b\\|_F \\approx 0$, set $r=0.0$.\n    - Otherwise, compute $r = \\sqrt{1.0 - c^2}$. To prevent numerical issues (e.g., `c` slightly outside $[-1, 1]$), it is prudent to compute this as $r = \\sqrt{\\max(0, 1.0 - c^2)}$.\n\nThis algorithm will be implemented to process the given test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the error metrics (r, c) for a test suite of Reynolds stress\n    and mean strain-rate tensors.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: equilibrium-aligned shear\n        (\n            np.array([[1.0, -0.6, 0.0], [-0.6, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n            np.array([[0.0, 1.0, 0.0], [1.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n        ),\n        # Case 2: non-equilibrium separated-like misalignment\n        (\n            np.array([[2.2, 0.2, -0.1], [0.2, 0.6, 0.05], [-0.1, 0.05, 0.4]]),\n            np.array([[0.0, 1.0, 0.0], [1.0, 0.3, 0.6], [0.0, 0.6, -0.3]])\n        ),\n        # Case 3: isotropic stress, edge case with zero anisotropy\n        (\n            np.array([[0.8, 0.0, 0.0], [0.0, 0.8, 0.0], [0.0, 0.0, 0.8]]),\n            np.array([[0.0, 0.5, 0.0], [0.5, 0.0, 0.0], [0.0, 0.0, 0.0]])\n        ),\n        # Case 4: zero strain, edge case with irreducible anisotropy\n        (\n            np.array([[3.0, 0.2, 0.1], [0.2, 1.0, 0.05], [0.1, 0.05, 0.5]]),\n            np.array([[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n        )\n    ]\n\n    results = []\n    for R_stress, S_strain in test_cases:\n        r, c = calculate_metrics(R_stress, S_strain)\n        results.append(f\"[{r:.6f},{c:.6f}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_metrics(R, S):\n    \"\"\"\n    Calculates the relative residual error 'r' and cosine alignment 'c'.\n    \n    Args:\n        R (np.ndarray): The Reynolds stress tensor, u'_i u'_j.\n        S (np.ndarray): The mean rate-of-strain tensor, S_ij.\n        \n    Returns:\n        tuple[float, float]: A pair of floats (r, c).\n    \"\"\"\n    # 1. Calculate turbulent kinetic energy k\n    k = 0.5 * np.trace(R)\n\n    # 2. Calculate the anisotropy tensor b_ij\n    # Use a small tolerance to handle floating point comparisons\n    tol = 1e-12\n    if k < tol:\n        # If k is zero, Reynolds stress is zero, so anisotropy is zero.\n        b = np.zeros_like(R)\n    else:\n        I = np.identity(R.shape[0])\n        b = R / (2.0 * k) - I / 3.0\n\n    # 3. Compute Frobenius norms\n    norm_b = np.linalg.norm(b, 'fro')\n    norm_s = np.linalg.norm(S, 'fro')\n\n    # 4. Compute cosine alignment c based on problem's rules for edge cases\n    if norm_b < tol and norm_s < tol:\n        c = 1.0\n    elif norm_b < tol or norm_s < tol:\n        c = 0.0\n    else:\n        # Inner product is the sum of element-wise products\n        inner_prod = np.sum(b * S)\n        c = inner_prod / (norm_b * norm_s)\n\n    # 5. Compute relative residual error r\n    if norm_b < tol:\n        # Per problem definition, r=0 if ||b||=0\n        r = 0.0\n    else:\n        # Clamp c^2 to [0, 1] to avoid domain error with sqrt due to float precision\n        c_squared = max(0.0, min(1.0, c**2))\n        r = np.sqrt(1.0 - c_squared)\n\n    return r, c\n\nsolve()\n```"
        },
        {
            "introduction": "Predicting complex flow phenomena, such as separation and reattachment, is a critical challenge in engineering and a key benchmark for the performance of turbulence models. Standard linear eddy-viscosity models often struggle in these non-equilibrium regions, motivating the development of more sophisticated nonlinear closures. This practice provides a direct, hands-on comparison between a linear model and a nonlinear model that includes quadratic dependencies on the strain-rate tensor $S_{ij}$ and rotation-rate tensor $W_{ij}$. By applying both closures to a synthetic separated flow and predicting the reattachment point, you will gain practical insight into how additional model complexity can, or sometimes cannot, improve predictions of critical engineering quantities .",
            "id": "3357832",
            "problem": "You are to build and analyze a purely algebraic, a priori comparison between two Reynolds-Averaged Navier–Stokes (RANS) closures for the turbulent shear stress in a three-dimensional, steady, incompressible, wall-bounded separated flow, evaluated along a streamwise line near a wall. Begin from first principles by using Reynolds decomposition and the Reynolds-averaged momentum equation as the theoretical base. Then, construct the modeled turbulent shear stress predictions and evaluate whether adding nonlinear tensor terms that depend on quadratic invariants of the mean strain-rate and mean rotation-rate tensors improves the prediction of the streamwise reattachment location.\n\nFundamental base and setup:\n- Let the instantaneous velocity be decomposed as $u_i = U_i + u_i'$, with $U_i$ the Reynolds-averaged mean velocity and $u_i'$ the fluctuation. The steady, incompressible Reynolds-averaged momentum equation for density $\\rho$ is \n$$\nU_j \\frac{\\partial U_i}{\\partial x_j} = -\\frac{1}{\\rho} \\frac{\\partial \\overline{P}}{\\partial x_i} + \\nu \\frac{\\partial^2 U_i}{\\partial x_j \\partial x_j} - \\frac{\\partial}{\\partial x_j}\\overline{u_i' u_j'},\n$$\nwhere $\\nu$ is the kinematic viscosity. Define the mean strain-rate tensor $S_{ij} = \\tfrac{1}{2}\\left(\\partial U_i/\\partial x_j + \\partial U_j/\\partial x_i\\right)$ and the mean rotation-rate tensor $W_{ij} = \\tfrac{1}{2}\\left(\\partial U_i/\\partial x_j - \\partial U_j/\\partial x_i\\right)$. The turbulent stress tensor is $T_{ij} = -\\overline{u_i' u_j'}$.\n\nModeled closures to compare:\n- A linear eddy-viscosity closure uses a scalar eddy viscosity $\\nu_t$ and relates $T_{ij}$ proportionally to $S_{ij}$.\n- A nonlinear eddy-viscosity closure augments the linear term with quadratic tensor terms constructed from $S_{ij}$ and $W_{ij}$, specifically symmetric tensor combinations formed from the products $S_{ik} W_{kj}$, $S_{ik} S_{kj}$, and $W_{ik} W_{kj}$.\n\nTask:\n- For each provided test case, you must:\n  1. From the given fields along a streamwise coordinate $x$, assemble at each $x$ the full three-dimensional tensors $S_{ij}(x)$ and $W_{ij}(x)$, a scalar eddy viscosity $\\nu_t(x)$, and a synthetic “truth” wall shear stress $\\tau_w^{\\mathrm{true}}(x)$.\n  2. Derive and implement the linear closure’s prediction of the wall shear stress component $T_{12}^{\\mathrm{L}}(x)$ using the definition of the linear eddy-viscosity model and the relationship between $T_{ij}$ and $S_{ij}$.\n  3. Derive and implement the nonlinear closure’s prediction of the wall shear stress component $T_{12}^{\\mathrm{NL}}(x)$ using a quadratic tensor-basis expansion built from $S_{ij}$ and $W_{ij}$ up to second order, aggregated with given constant coefficients, and with dimensional consistency using $\\nu_t(x)$ as the turbulence scale.\n  4. Define the streamwise reattachment location $x_r$ as the smallest $x$ where the shear stress crosses zero from negative to positive. For each of $T_{12}^{\\mathrm{L}}(x)$, $T_{12}^{\\mathrm{NL}}(x)$, and the synthetic truth $\\tau_w^{\\mathrm{true}}(x)$, detect the first zero crossing from negative to positive and estimate its location by linear interpolation between adjacent sample points. If no such crossing exists in the sampled domain, take the predicted reattachment location to be “not-a-number.”\n  5. For each test case, compute the absolute errors $|x_r^{\\mathrm{L}} - x_r^{\\mathrm{true}}|$ and $|x_r^{\\mathrm{NL}} - x_r^{\\mathrm{true}}|$. Report whether the nonlinear model reduces the absolute error strictly, i.e., whether $|x_r^{\\mathrm{NL}} - x_r^{\\mathrm{true}}| < |x_r^{\\mathrm{L}} - x_r^{\\mathrm{true}}|$.\n\nModel specifications to implement:\n- Linear eddy-viscosity model: assume $T_{ij}^{\\mathrm{L}}(x)$ is proportional to $S_{ij}(x)$ with proportionality controlled by $\\nu_t(x)$, and extract the shear component needed for the wall stress.\n- Nonlinear eddy-viscosity model: construct\n$$\nT_{ij}^{\\mathrm{NL}}(x) = 2\\nu_t(x)S_{ij}(x) + a_1\\nu_t^2(x)\\left[S(x)W(x) + W(x)S(x)\\right]_{ij} + a_2\\nu_t^2(x)\\left[S(x)S(x)\\right]_{ij} + a_3\\nu_t^2(x)\\left[W(x)W(x)\\right]_{ij},\n$$\nand use its $i=1,j=2$ component for the wall shear stress. The constants are $a_1 = 0.3$, $a_2 = -0.2$, $a_3 = 0.1$ (all dimensionless). Note that in these expressions matrix products are ordinary tensor contractions, e.g., $\\left[S(x)W(x)\\right]_{ij} = S_{ik}(x)W_{kj}(x)$ and similarly for other products; the sum $S(x)W(x) + W(x)S(x)$ is symmetric by construction. The density is taken as unity, so the wall shear stress magnitude equals the turbulent shear component $T_{12}$ in consistent units.\n- Synthetic “truth” wall shear stress used for evaluation is defined by\n$$\n\\tau_w^{\\mathrm{true}}(x) = 2\\nu_t(x)S_{12}(x) + a_1^{\\mathrm{true}}\\nu_t^2(x)\\left[S(x)W(x) + W(x)S(x)\\right]_{12} + a_2^{\\mathrm{true}}\\nu_t^2(x)\\left[S(x)S(x)\\right]_{12} + a_3^{\\mathrm{true}}\\nu_t^2(x)\\left[W(x)W(x)\\right]_{12} + c_3\\nu_t^3(x)\\left[S(x)W(x)S(x)\\right]_{12},\n$$\nwith $(a_1^{\\mathrm{true}},a_2^{\\mathrm{true}},a_3^{\\mathrm{true}},c_3)$ provided below per test case. The last cubic term represents unmodeled physics.\n\nTest suite:\n- Use a uniform streamwise grid $x_k = k\\,\\Delta x$ with $\\Delta x = 0.5$ for $k = 0,1,\\dots,20$ so that the domain is $x \\in [0,10]$.\n- For each test case, you are given the nonzero components of $S_{ij}(x)$ and $W_{ij}(x)$ as scalar functions of $x$. Assemble the full $3 \\times 3$ tensors using symmetry: $S_{ij}(x) = S_{ji}(x)$ and $W_{ij}(x) = -W_{ji}(x)$, with unspecified components equal to zero. Enforce incompressibility by setting $S_{33}(x) = -\\left(S_{11}(x) + S_{22}(x)\\right)$.\n\nTest case $1$ (general separated flow with moderate three-dimensionality):\n- $S_{12}(x) = s(x) = s_0 \\tanh\\!\\left(\\dfrac{x - x_0}{L_s}\\right)$ with $s_0 = 0.5$, $x_0 = 5.0$, $L_s = 1.2$.\n- $S_{11}(x) = a(x) = 0.06 \\exp\\!\\left(-\\dfrac{(x - 5.0)^2}{4.0}\\right) - 0.03$.\n- $S_{22}(x) = d(x) = -0.5\\,a(x) + 0.01 \\sin\\!\\left(0.5\\,x\\right)$.\n- $S_{13}(x) = t(x) = 0.05 \\cos\\!\\left(0.7\\,x\\right)\\exp\\!\\left(-\\dfrac{(x - 5.0)^2}{12.0}\\right)$ and $S_{23}(x) = q(x) = -0.04 \\sin\\!\\left(0.5\\,x\\right)\\exp\\!\\left(-\\dfrac{(x - 6.0)^2}{10.0}\\right)$.\n- $W_{12}(x) = w(x) = 0.7\\,s(x) + 0.05 \\sin(x)$, $W_{13}(x) = z(x) = 0.03 \\cos\\!\\left(0.3\\,x\\right)$, $W_{23}(x) = y(x) = -0.025 \\sin\\!\\left(0.4\\,x\\right)$.\n- $\\nu_t(x) = 0.02 + 0.06 \\exp\\!\\left(-\\dfrac{(x - 5.5)^2}{2.0}\\right)$.\n- Truth coefficients: $a_1^{\\mathrm{true}} = 0.35$, $a_2^{\\mathrm{true}} = -0.25$, $a_3^{\\mathrm{true}} = 0.10$, $c_3 = 0.08$.\n\nTest case $2$ (weak nonlinearity, quasi-two-dimensional behavior):\n- $S_{12}(x) = s(x) = s_0 \\tanh\\!\\left(\\dfrac{x - x_0}{L_s}\\right)$ with $s_0 = 0.35$, $x_0 = 4.0$, $L_s = 1.0$.\n- $S_{11}(x) = a(x) = 0.03 \\exp\\!\\left(-\\dfrac{(x - 4.0)^2}{3.0}\\right) - 0.015$.\n- $S_{22}(x) = d(x) = -0.6\\,a(x) + 0.005 \\cos\\!\\left(0.4\\,x\\right)$.\n- $S_{13}(x) = t(x) = 0.02 \\cos\\!\\left(0.5\\,x\\right)\\exp\\!\\left(-\\dfrac{(x - 5.0)^2}{10.0}\\right)$ and $S_{23}(x) = q(x) = 0.02 \\sin\\!\\left(0.3\\,x\\right)\\exp\\!\\left(-\\dfrac{(x - 5.0)^2}{10.0}\\right)$.\n- $W_{12}(x) = w(x) = 0.9\\,s(x) + 0.02 \\sin\\!\\left(0.8\\,x\\right)$, $W_{13}(x) = z(x) = 0.015 \\cos\\!\\left(0.35\\,x\\right)$, $W_{23}(x) = y(x) = 0.015 \\sin\\!\\left(0.25\\,x\\right)$.\n- $\\nu_t(x) = 0.015 + 0.04 \\exp\\!\\left(-\\dfrac{(x - 4.5)^2}{1.5}\\right)$.\n- Truth coefficients: $a_1^{\\mathrm{true}} = 0.32$, $a_2^{\\mathrm{true}} = -0.18$, $a_3^{\\mathrm{true}} = 0.08$, $c_3 = 0.02$.\n\nTest case $3$ (challenging case where linear model may miss reattachment):\n- $S_{12}(x) = s(x) = -0.25 + 0.03 \\tanh\\!\\left(\\dfrac{x - 6.0}{1.0}\\right)$.\n- $S_{11}(x) = a(x) = 0.05 \\exp\\!\\left(-\\dfrac{(x - 7.0)^2}{2.0}\\right) - 0.02$.\n- $S_{22}(x) = d(x) = -0.7\\,a(x) + 0.01 \\cos\\!\\left(0.6\\,x\\right)$.\n- $S_{13}(x) = t(x) = 0.06 \\exp\\!\\left(-\\dfrac{(x - 8.0)^2}{3.0}\\right)\\cos\\!\\left(0.5\\,x\\right)$ and $S_{23}(x) = q(x) = -0.05 \\exp\\!\\left(-\\dfrac{(x - 7.5)^2}{2.5}\\right)\\sin\\!\\left(0.4\\,x\\right)$.\n- $W_{12}(x) = w(x) = 0.40 + 0.05 \\sin\\!\\left(0.7\\,x\\right)$, $W_{13}(x) = z(x) = 0.05 \\cos\\!\\left(0.4\\,x\\right)$, $W_{23}(x) = y(x) = -0.05 \\sin\\!\\left(0.3\\,x\\right)$.\n- $\\nu_t(x) = 0.02 + 0.05 \\exp\\!\\left(-\\dfrac{(x - 7.0)^2}{1.2}\\right)$.\n- Truth coefficients: $a_1^{\\mathrm{true}} = 0.40$, $a_2^{\\mathrm{true}} = -0.30$, $a_3^{\\mathrm{true}} = 0.12$, $c_3 = 0.12$.\n\nImportant implementation notes:\n- For each $x$, assemble $S(x)$ and $W(x)$ with the components above and all other entries zero, respecting symmetry/antisymmetry and $S_{33}(x) = -\\left(S_{11}(x) + S_{22}(x)\\right)$.\n- Compute matrix products such as $S(x)W(x)$, $W(x)S(x)$, $S(x)S(x)$, $W(x)W(x)$, and $S(x)W(x)S(x)$ using standard tensor contraction rules.\n- Detect the reattachment location by scanning for the first index $k$ where $\\tau(x_k) \\le 0$ and $\\tau(x_{k+1}) > 0$, and linearly interpolate the zero crossing between $x_k$ and $x_{k+1}$. If no such index exists, the reattachment location is not-a-number.\n\nFinal output specification:\n- For each of the three test cases, compute a boolean indicating whether the nonlinear model strictly reduces the absolute error in reattachment prediction compared to the linear model. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., $\\left[\\mathrm{True},\\mathrm{False},\\mathrm{True}\\right]$. Since the outputs are booleans, no physical units are required in the final output.",
            "solution": "The user wants to solve a problem in computational fluid dynamics.\n\n### Step 1: Extract Givens\n- **Reynolds Decomposition**: $u_i = U_i + u_i'$, where $U_i$ is the mean velocity and $u_i'$ is the fluctuation.\n- **RANS Equation**: The steady, incompressible Reynolds-averaged momentum equation is $U_j \\frac{\\partial U_i}{\\partial x_j} = -\\frac{1}{\\rho} \\frac{\\partial \\overline{P}}{\\partial x_i} + \\nu \\frac{\\partial^2 U_i}{\\partial x_j \\partial x_j} - \\frac{\\partial}{\\partial x_j}\\overline{u_i' u_j'}$.\n- **Definitions**:\n  - Mean strain-rate tensor: $S_{ij} = \\tfrac{1}{2}\\left(\\partial U_i/\\partial x_j + \\partial U_j/\\partial x_i\\right)$.\n  - Mean rotation-rate tensor: $W_{ij} = \\tfrac{1}{2}\\left(\\partial U_i/\\partial x_j - \\partial U_j/\\partial x_i\\right)$.\n  - Turbulent stress tensor: $T_{ij} = -\\overline{u_i' u_j'}$.\n- **Linear Model**: $T_{ij}^{\\mathrm{L}}(x)$ is proportional to $S_{ij}(x)$ with proportionality controlled by $\\nu_t(x)$. Based on the nonlinear model's form, this implies $T_{ij}^{\\mathrm{L}}(x) = 2 \\nu_t(x) S_{ij}(x)$.\n- **Nonlinear Model**: $T_{ij}^{\\mathrm{NL}}(x) = 2\\nu_t(x)S_{ij}(x) + a_1\\nu_t^2(x)\\left[S(x)W(x) + W(x)S(x)\\right]_{ij} + a_2\\nu_t^2(x)\\left[S(x)S(x)\\right]_{ij} + a_3\\nu_t^2(x)\\left[W(x)W(x)\\right]_{ij}$.\n- **Nonlinear Model Constants**: $a_1 = 0.3$, $a_2 = -0.2$, $a_3 = 0.1$.\n- **Synthetic Truth Model**: $\\tau_w^{\\mathrm{true}}(x) = 2\\nu_t(x)S_{12}(x) + a_1^{\\mathrm{true}}\\nu_t^2(x)\\left[S(x)W(x) + W(x)S(x)\\right]_{12} + a_2^{\\mathrm{true}}\\nu_t^2(x)\\left[S(x)S(x)\\right]_{12} + a_3^{\\mathrm{true}}\\nu_t^2(x)\\left[W(x)W(x)\\right]_{12} + c_3\\nu_t^3(x)\\left[S(x)W(x)S(x)\\right]_{12}$.\n- **Physical Constants**: Density $\\rho=1$.\n- **Reattachment Definition**: $x_r$ is the smallest $x$ where the shear stress crosses zero from negative to positive. Estimate by linear interpolation. If no crossing, $x_r$ is \"not-a-number\" (`NaN`).\n- **Evaluation Metric**: For each case, determine if $|x_r^{\\mathrm{NL}} - x_r^{\\mathrm{true}}| < |x_r^{\\mathrm{L}} - x_r^{\\mathrm{true}}|$.\n- **Grid**: Uniform grid $x_k = k\\,\\Delta x$ with $\\Delta x = 0.5$ for $k = 0,1,\\dots,20$ (domain $x \\in [0,10]$).\n- **Tensor Assembly Rules**:\n  - $S_{ij}(x) = S_{ji}(x)$.\n  - $W_{ij}(x) = -W_{ji}(x)$.\n  - Unspecified tensor components are zero.\n  - Incompressibility: $S_{33}(x) = -\\left(S_{11}(x) + S_{22}(x)\\right)$.\n- **Test Case 1**:\n  - Components: $S_{12}(x) = 0.5 \\tanh((x - 5.0)/1.2)$, $S_{11}(x) = 0.06 \\exp(-(x - 5.0)^2/4.0) - 0.03$, $S_{22}(x) = -0.5 S_{11}(x) + 0.01 \\sin(0.5x)$, $S_{13}(x) = 0.05 \\cos(0.7x)\\exp(-(x - 5.0)^2/12.0)$, $S_{23}(x) = -0.04 \\sin(0.5x)\\exp(-(x - 6.0)^2/10.0)$, $W_{12}(x) = 0.7 S_{12}(x) + 0.05 \\sin(x)$, $W_{13}(x) = 0.03 \\cos(0.3x)$, $W_{23}(x) = -0.025 \\sin(0.4x)$.\n  - Eddy Viscosity: $\\nu_t(x) = 0.02 + 0.06 \\exp(-(x - 5.5)^2/2.0)$.\n  - Truth Coefficients: $a_1^{\\mathrm{true}} = 0.35$, $a_2^{\\mathrm{true}} = -0.25$, $a_3^{\\mathrm{true}} = 0.10$, $c_3 = 0.08$.\n- **Test Case 2**:\n  - Components: $S_{12}(x) = 0.35 \\tanh((x - 4.0)/1.0)$, $S_{11}(x) = 0.03 \\exp(-(x - 4.0)^2/3.0) - 0.015$, $S_{22}(x) = -0.6 S_{11}(x) + 0.005 \\cos(0.4x)$, $S_{13}(x) = 0.02 \\cos(0.5x)\\exp(-(x - 5.0)^2/10.0)$, $S_{23}(x) = 0.02 \\sin(0.3x)\\exp(-(x - 5.0)^2/10.0)$, $W_{12}(x) = 0.9 S_{12}(x) + 0.02 \\sin(0.8x)$, $W_{13}(x) = 0.015 \\cos(0.35x)$, $W_{23}(x) = 0.015 \\sin(0.25x)$.\n  - Eddy Viscosity: $\\nu_t(x) = 0.015 + 0.04 \\exp(-(x - 4.5)^2/1.5)$.\n  - Truth Coefficients: $a_1^{\\mathrm{true}} = 0.32$, $a_2^{\\mathrm{true}} = -0.18$, $a_3^{\\mathrm{true}} = 0.08$, $c_3 = 0.02$.\n- **Test Case 3**:\n  - Components: $S_{12}(x) = -0.25 + 0.03 \\tanh((x - 6.0)/1.0)$, $S_{11}(x) = 0.05 \\exp(-(x - 7.0)^2/2.0) - 0.02$, $S_{22}(x) = -0.7 S_{11}(x) + 0.01 \\cos(0.6x)$, $S_{13}(x) = 0.06 \\exp(-(x - 8.0)^2/3.0)\\cos(0.5x)$, $S_{23}(x) = -0.05 \\exp(-(x - 7.5)^2/2.5)\\sin(0.4x)$, $W_{12}(x) = 0.40 + 0.05 \\sin(0.7x)$, $W_{13}(x) = 0.05 \\cos(0.4x)$, $W_{23}(x) = -0.05 \\sin(0.3x)$.\n  - Eddy Viscosity: $\\nu_t(x) = 0.02 + 0.05 \\exp(-(x - 7.0)^2/1.2)$.\n  - Truth Coefficients: $a_1^{\\mathrm{true}} = 0.40$, $a_2^{\\mathrm{true}} = -0.30$, $a_3^{\\mathrm{true}} = 0.12$, $c_3 = 0.12$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is firmly rooted in the theory of turbulence modeling for the Reynolds-Averaged Navier-Stokes (RANS) equations. The use of linear and nonlinear eddy-viscosity models, based on a tensor-basis expansion of the Reynolds stress anisotropy, is a standard and well-documented approach in computational fluid dynamics. The functional forms, while synthetic, are chosen to mimic realistic flow features.\n- **Well-Posed**: The problem is a direct computational task. All necessary functions, constants, and algorithms are explicitly defined, ensuring that a unique solution can be calculated.\n- **Objective**: The problem is stated in precise, mathematical language, free from subjectivity or ambiguity.\n- **Incomplete or Contradictory Setup**: The problem is self-contained. All necessary model forms, coefficients, and input data are provided. The tensor assembly rules are complete and consistent with standard fluid dynamics conventions (e.g., symmetry of $S_{ij}$, antisymmetry of $W_{ij}$, and tracerless property of $S_{ij}$ for incompressible flow).\n- **Unrealistic or Infeasible**: The setup is a synthetic, algebraic test case, not a simulation of a full flow field. Within this context, the conditions and data are plausible for an a priori analysis of turbulence models. There are no violations of physical or dimensional consistency.\n- **Ill-Posed or Poorly Structured**: The structure is logical, building from fundamental definitions to model construction and finally to a quantitative comparison. The reattachment criterion is clearly defined.\n- **Pseudo-Profound, Trivial, or Tautological**: The problem is not trivial. It requires careful implementation of tensor algebra over a discrete domain, a numerical search-and-interpolation algorithm, and logical handling of special cases (e.g., failure to predict reattachment). It is a valid exercise in understanding and implementing algebraic stress models.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-defined, scientifically sound computational exercise in the field of turbulence modeling. A full solution will be provided.\n\n---\n\n### Solution Strategy\n\nThe problem requires a comparative analysis of a linear and a nonlinear eddy-viscosity model against a synthetic \"truth\" for predicting the streamwise reattachment point in a separated flow. The analysis is purely algebraic and performed along a single spatial coordinate $x$. The density $\\rho$ is taken as $1$, so the turbulent stress $T_{ij}$ is numerically equal to the shear stress. The component of interest for wall shear is $T_{12}$.\n\n**1. Model Formulations for Shear Stress $T_{12}$**\n\nFirst, we define the specific component $T_{12}$ for each of the three models.\n\n*   **Linear Eddy-Viscosity Model (LEVM)**: This model is based on the Boussinesq hypothesis, which postulates a linear relationship between the Reynolds stress tensor and the mean strain-rate tensor. For the shear component $T_{12}$, the model is:\n    $$\n    T_{12}^{\\mathrm{L}}(x) = 2 \\nu_t(x) S_{12}(x)\n    $$\n    Here, $\\nu_t(x)$ is the scalar eddy viscosity.\n\n*   **Nonlinear Eddy-Viscosity Model (NLEVM)**: This model extends the LEVM by including nonlinear, quadratic terms constructed from the mean strain-rate tensor $S(x)$ and the mean rotation-rate tensor $W(x)$. The $ij$-component is given as:\n    $$\n    T_{ij}^{\\mathrm{NL}}(x) = 2\\nu_t(x)S_{ij}(x) + a_1\\nu_t^2(x)\\left[S(x)W(x) + W(x)S(x)\\right]_{ij} + a_2\\nu_t^2(x)\\left[S(x)^2\\right]_{ij} + a_3\\nu_t^2(x)\\left[W(x)^2\\right]_{ij}\n    $$\n    where $[S(x)W(x)]_{ij} = S_{ik}(x)W_{kj}(x)$ represents tensor contraction (matrix multiplication). To find $T_{12}^{\\mathrm{NL}}(x)$, we evaluate the $(i,j)=(1,2)$ component of each term in the sum. This is most reliably done computationally by first constructing the full $3 \\times 3$ matrices $S(x)$ and $W(x)$ and then performing the specified matrix multiplications.\n\n*   **Synthetic Truth Model**: This is an extension of the NLEVM, with different coefficients and an additional cubic term, designed to represent a more complex \"ground truth\" against which the other models are compared.\n    $$\n    \\tau_w^{\\mathrm{true}}(x) = T_{12}^{\\mathrm{true}}(x) = T_{12}^{\\mathrm{NL}}(x)\\Big|_{a_i \\to a_i^{\\mathrm{true}}} + c_3\\,\\nu_t^3(x)\\,\\left[S(x)W(x)S(x)\\right]_{12}\n    $$\n    Again, the $(1,2)$ component of the cubic term $[S(x)W(x)S(x)]_{12}$ is calculated via matrix multiplications.\n\n**2. Computational Procedure**\n\nFor each test case, the following steps are executed:\n\n1.  **Discretize Domain**: A uniform grid is defined as $x_k = k \\cdot (0.5)$ for $k = 0, 1, \\ldots, 20$.\n2.  **Assemble Tensors**: At each grid point $x_k$, the $3 \\times 3$ tensors $S(x_k)$ and $W(x_k)$ are populated. Given functions define the non-zero components. Symmetry ($S_{ij}=S_{ji}$) and anti-symmetry ($W_{ij}=-W_{ji}$) are used to fill in the remaining specified components. The incompressibility constraint $S_{11}+S_{22}+S_{33}=0$ is enforced by setting $S_{33}(x_k) = -(S_{11}(x_k) + S_{22}(x_k))$. Any component not explicitly defined or derivable from symmetry is set to zero. For instance, $W_{11}, W_{22}, W_{33}$ are all zero due to anti-symmetry.\n3.  **Compute Shear Stress Profiles**: For each point $x_k$ on the grid:\n    *   Evaluate the functions for $S_{ij}(x_k)$, $W_{ij}(x_k)$, and $\\nu_t(x_k)$.\n    *   Assemble the matrices $S(x_k)$ and $W(x_k)$.\n    *   Perform the required matrix multiplications: $S^2$, $W^2$, $SW$, $WS$, and $SWS$.\n    *   Use the results to compute the scalar values $T_{12}^{\\mathrm{L}}(x_k)$, $T_{12}^{\\mathrm{NL}}(x_k)$, and $T_{12}^{\\mathrm{true}}(x_k)$, storing them in arrays.\n\n**3. Reattachment Point Detection**\n\nThe reattachment point $x_r$ is where the wall shear stress becomes positive after being negative, signifying the end of a flow separation bubble. For each of the three computed stress profiles ($\\tau^{\\mathrm{L}}$, $\\tau^{\\mathrm{NL}}$, $\\tau^{\\mathrm{true}}$):\n\n1.  **Scan for Zero Crossing**: Iterate through the grid from $k=0$ to $k=19$. Find the first index $k$ such that $\\tau(x_k) \\le 0$ and $\\tau(x_{k+1}) > 0$.\n2.  **Linear Interpolation**: If such an interval $[x_k, x_{k+1}]$ is found, the zero-crossing is estimated using linear interpolation:\n    $$\n    x_r = x_k - \\tau(x_k) \\frac{x_{k+1} - x_k}{\\tau(x_{k+1}) - \\tau(x_k)}\n    $$\n3.  **No Reattachment**: If the loop completes without finding such a crossing, it implies that reattachment does not occur within the domain $[0, 10]$. In this case, the reattachment location $x_r$ is assigned the value `not-a-number` (`NaN`).\n\n**4. Error Analysis and Comparison**\n\nThe final step is to determine if the NLEVM provides a more accurate prediction of the reattachment location than the LEVM.\n\n1.  **Calculate Absolute Errors**: Compute the absolute errors for the linear and nonlinear models with respect to the synthetic truth:\n    $$\n    E_{\\mathrm{L}} = |x_r^{\\mathrm{L}} - x_r^{\\mathrm{true}}|\n    $$\n    $$\n    E_{\\mathrm{NL}} = |x_r^{\\mathrm{NL}} - x_r^{\\mathrm{true}}|\n    $$\n2.  **Evaluate Improvement**: Determine the boolean value of the strict inequality $E_{\\mathrm{NL}} < E_{\\mathrm{L}}$. The handling of `NaN` values is critical:\n    *   If a model fails to predict reattachment ($x_r$ is `NaN`) while the truth model does, its error is considered infinite.\n    *   If the LEVM fails (error is infinite) and the NLEVM succeeds (error is finite), the NLEVM is strictly better. The condition is `True`.\n    *   If the NLEVM fails, it cannot be strictly better than the LEVM, regardless of the LEVM's performance. The condition is `False`.\n    *   If both models predict a finite reattachment location, their finite errors are compared directly.\n\nThis procedure is applied to each of the three test cases, yielding a boolean result for each.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the RANS model comparison problem for all test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"name\": \"Test case 1 (general separated flow with moderate three-dimensionality)\",\n            \"params\": {\"s0\": 0.5, \"x0\": 5.0, \"Ls\": 1.2},\n            \"S12_f\": lambda x, p: p[\"s0\"] * np.tanh((x - p[\"x0\"]) / p[\"Ls\"]),\n            \"S11_f\": lambda x, p: 0.06 * np.exp(-(x - 5.0)**2 / 4.0) - 0.03,\n            \"S22_f\": lambda x, p: -0.5 * (0.06 * np.exp(-(x - 5.0)**2 / 4.0) - 0.03) + 0.01 * np.sin(0.5 * x),\n            \"S13_f\": lambda x, p: 0.05 * np.cos(0.7 * x) * np.exp(-(x - 5.0)**2 / 12.0),\n            \"S23_f\": lambda x, p: -0.04 * np.sin(0.5 * x) * np.exp(-(x - 6.0)**2 / 10.0),\n            \"W12_f\": lambda x, p: 0.7 * (p[\"s0\"] * np.tanh((x - p[\"x0\"]) / p[\"Ls\"])) + 0.05 * np.sin(x),\n            \"W13_f\": lambda x, p: 0.03 * np.cos(0.3 * x),\n            \"W23_f\": lambda x, p: -0.025 * np.sin(0.4 * x),\n            \"nut_f\": lambda x, p: 0.02 + 0.06 * np.exp(-(x - 5.5)**2 / 2.0),\n            \"truth_coeffs\": {\"a1\": 0.35, \"a2\": -0.25, \"a3\": 0.10, \"c3\": 0.08},\n        },\n        {\n            \"name\": \"Test case 2 (weak nonlinearity, quasi-two-dimensional behavior)\",\n            \"params\": {\"s0\": 0.35, \"x0\": 4.0, \"Ls\": 1.0},\n            \"S12_f\": lambda x, p: p[\"s0\"] * np.tanh((x - p[\"x0\"]) / p[\"Ls\"]),\n            \"S11_f\": lambda x, p: 0.03 * np.exp(-(x - 4.0)**2 / 3.0) - 0.015,\n            \"S22_f\": lambda x, p: -0.6 * (0.03 * np.exp(-(x - 4.0)**2 / 3.0) - 0.015) + 0.005 * np.cos(0.4 * x),\n            \"S13_f\": lambda x, p: 0.02 * np.cos(0.5 * x) * np.exp(-(x - 5.0)**2 / 10.0),\n            \"S23_f\": lambda x, p: 0.02 * np.sin(0.3 * x) * np.exp(-(x - 5.0)**2 / 10.0),\n            \"W12_f\": lambda x, p: 0.9 * (p[\"s0\"] * np.tanh((x - p[\"x0\"]) / p[\"Ls\"])) + 0.02 * np.sin(0.8 * x),\n            \"W13_f\": lambda x, p: 0.015 * np.cos(0.35 * x),\n            \"W23_f\": lambda x, p: 0.015 * np.sin(0.25 * x),\n            \"nut_f\": lambda x, p: 0.015 + 0.04 * np.exp(-(x - 4.5)**2 / 1.5),\n            \"truth_coeffs\": {\"a1\": 0.32, \"a2\": -0.18, \"a3\": 0.08, \"c3\": 0.02},\n        },\n        {\n            \"name\": \"Test case 3 (challenging case where linear model may miss reattachment)\",\n            \"params\": {},\n            \"S12_f\": lambda x, p: -0.25 + 0.03 * np.tanh((x - 6.0) / 1.0),\n            \"S11_f\": lambda x, p: 0.05 * np.exp(-(x - 7.0)**2 / 2.0) - 0.02,\n            \"S22_f\": lambda x, p: -0.7 * (0.05 * np.exp(-(x - 7.0)**2 / 2.0) - 0.02) + 0.01 * np.cos(0.6 * x),\n            \"S13_f\": lambda x, p: 0.06 * np.exp(-(x - 8.0)**2 / 3.0) * np.cos(0.5 * x),\n            \"S23_f\": lambda x, p: -0.05 * np.exp(-(x - 7.5)**2 / 2.5) * np.sin(0.4 * x),\n            \"W12_f\": lambda x, p: 0.40 + 0.05 * np.sin(0.7 * x),\n            \"W13_f\": lambda x, p: 0.05 * np.cos(0.4 * x),\n            \"W23_f\": lambda x, p: -0.05 * np.sin(0.3 * x),\n            \"nut_f\": lambda x, p: 0.02 + 0.05 * np.exp(-(x - 7.0)**2 / 1.2),\n            \"truth_coeffs\": {\"a1\": 0.40, \"a2\": -0.30, \"a3\": 0.12, \"c3\": 0.12},\n        }\n    ]\n\n    nl_model_coeffs = {\"a1\": 0.3, \"a2\": -0.2, \"a3\": 0.1}\n\n    results = []\n    for case in test_cases:\n        result = run_case(case, nl_model_coeffs)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef find_reattachment(x_grid, stress_profile):\n    \"\"\"\n    Finds the reattachment point by linear interpolation.\n    Returns NaN if no reattachment is found.\n    \"\"\"\n    for i in range(len(x_grid) - 1):\n        if stress_profile[i] <= 0 and stress_profile[i+1] > 0:\n            x1, y1 = x_grid[i], stress_profile[i]\n            x2, y2 = x_grid[i+1], stress_profile[i+1]\n            return x1 - y1 * (x2 - x1) / (y2 - y1)\n    return np.nan\n\ndef run_case(case_data, nl_coeffs):\n    \"\"\"\n    Executes a single test case.\n    \"\"\"\n    # Setup grid\n    dx = 0.5\n    x = np.arange(0, 10 + dx, dx)\n    n_points = len(x)\n    params = case_data[\"params\"]\n    \n    # Evaluate tensor components and nu_t on the grid\n    nu_t = case_data[\"nut_f\"](x, params)\n    S11 = case_data[\"S11_f\"](x, params)\n    S12 = case_data[\"S12_f\"](x, params)\n    S13 = case_data[\"S13_f\"](x, params)\n    S22 = case_data[\"S22_f\"](x, params)\n    S23 = case_data[\"S23_f\"](x, params)\n    S33 = -(S11 + S22)\n    \n    W12 = case_data[\"W12_f\"](x, params)\n    W13 = case_data[\"W13_f\"](x, params)\n    W23 = case_data[\"W23_f\"](x, params)\n\n    # Initialize stress arrays\n    tau_L = np.zeros(n_points)\n    tau_NL = np.zeros(n_points)\n    tau_true = np.zeros(n_points)\n    \n    # Calculate stresses at each grid point\n    for k in range(n_points):\n        S = np.array([\n            [S11[k], S12[k], S13[k]],\n            [S12[k], S22[k], S23[k]],\n            [S13[k], S23[k], S33[k]]\n        ])\n        \n        W = np.array([\n            [0, W12[k], W13[k]],\n            [-W12[k], 0, W23[k]],\n            [-W13[k], -W23[k], 0]\n        ])\n        \n        # Linear model stress\n        T_L_12 = 2 * nu_t[k] * S12[k]\n        \n        # Nonlinear terms\n        S_sq = S @ S\n        W_sq = W @ W\n        SW = S @ W\n        WS = W @ S\n        \n        # Nonlinear model stress\n        T_NL_12 = T_L_12 + \\\n                  nl_coeffs[\"a1\"] * nu_t[k]**2 * (SW + WS)[0, 1] + \\\n                  nl_coeffs[\"a2\"] * nu_t[k]**2 * S_sq[0, 1] + \\\n                  nl_coeffs[\"a3\"] * nu_t[k]**2 * W_sq[0, 1]\n\n        # Truth model stress\n        SWS = S @ W @ S\n        truth = case_data[\"truth_coeffs\"]\n        T_true_12 = T_L_12 + \\\n                    truth[\"a1\"] * nu_t[k]**2 * (SW + WS)[0, 1] + \\\n                    truth[\"a2\"] * nu_t[k]**2 * S_sq[0, 1] + \\\n                    truth[\"a3\"] * nu_t[k]**2 * W_sq[0, 1] + \\\n                    truth[\"c3\"] * nu_t[k]**3 * SWS[0, 1]\n                    \n        tau_L[k] = T_L_12\n        tau_NL[k] = T_NL_12\n        tau_true[k] = T_true_12\n\n    # Find reattachment points\n    xr_L = find_reattachment(x, tau_L)\n    xr_NL = find_reattachment(x, tau_NL)\n    xr_true = find_reattachment(x, tau_true)\n\n    # Compare errors, handling NaN cases\n    is_L_nan = np.isnan(xr_L)\n    is_NL_nan = np.isnan(xr_NL)\n    is_true_nan = np.isnan(xr_true)\n\n    if is_true_nan:\n        # If truth has no reattachment, comparison is ambiguous. Default to False.\n        return False\n    \n    if is_NL_nan:\n        # NL model failed, so it cannot be strictly better.\n        return False\n    \n    if is_L_nan:\n        # L model failed, but NL model succeeded. NL is strictly better.\n        return True\n\n    # Both models found reattachment, compare finite errors.\n    err_L = abs(xr_L - xr_true)\n    err_NL = abs(xr_NL - xr_true)\n    \n    return err_NL < err_L\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}