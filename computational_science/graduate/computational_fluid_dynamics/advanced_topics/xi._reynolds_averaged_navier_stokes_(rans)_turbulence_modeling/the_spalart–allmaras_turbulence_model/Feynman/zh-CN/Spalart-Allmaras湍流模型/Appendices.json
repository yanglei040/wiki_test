{
    "hands_on_practices": [
        {
            "introduction": "Spalart-Allmaras模型的核心在于它如何通过一个输运变量 $\\tilde{\\nu}$ 来构建湍流涡粘性 $\\nu_t$。本练习将引导你探索两者之间的关键代数关系，特别是通过粘性阻尼函数 $f_{v1}$ 实现的调节作用，从而确保模型在近壁区和远场都能表现出物理上合理的行为。通过亲自计算并分析其渐近极限，你将深刻理解该模型设计的精髓。",
            "id": "3380828",
            "problem": "在单方程Spalart–Allmaras湍流模型（SA）中，湍流运动粘度被建模为一个输运工作变量和分子粘度的代数函数，以符合雷诺平均Navier–Stokes方程和Boussinesq涡粘假设。考虑在某位置的不可压缩空气流动，其分子运动粘度为 $\\nu = 1.50 \\times 10^{-5}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$，Spalart–Allmaras工作变量的值为 $\\tilde{\\nu} = 5.00 \\times 10^{-5}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$。取典型的SA模型常数 $c_{v1} = 7.1$。该模型定义了一个无量纲比值 $\\chi \\equiv \\tilde{\\nu} / \\nu$，并使用一个粘性阻尼函数来确保正确的近壁区和外层极限。\n\n仅使用Spalart–Allmaras模型的既定关系和雷诺平均Navier–Stokes封闭理论的基本原理，计算这些数据所隐含的湍流运动粘度 $\\nu_t$。然后，分析无量纲比值 $\\nu_t / \\tilde{\\nu}$ 在 $\\chi \\to 0$ 和 $\\chi \\to \\infty$ 时的极限，并说明极限值。从物理合理性的角度解释这些极限。\n\n按如下方式报告您的最终结果：\n- 提供 $\\nu_t$ 的值，单位为 $\\mathrm{m}^2\\ \\mathrm{s}^{-1}$，保留四位有效数字。\n- 提供两个极限值 $\\lim_{\\chi \\to 0} \\left(\\nu_t / \\tilde{\\nu}\\right)$ 和 $\\lim_{\\chi \\to \\infty} \\left(\\nu_t / \\tilde{\\nu}\\right)$，作为纯数（无量纲）。\n您的最终答案必须在一行中呈现为三个条目，顺序如上所述。",
            "solution": "该问题陈述经核实，科学上合理、提法恰当、客观且自洽，为基于Spalart–Allmaras湍流模型的既定原理求解问题提供了所有必要数据。\n\nSpalart–Allmaras（SA）模型为湍流运动粘度 $\\nu_t$ 提供了一个代数关系，该关系是输运工作变量 $\\tilde{\\nu}$ 的函数。此关系是雷诺平均Navier–Stokes（RANS）方程中使用的Boussinesq涡粘假设的核心。其公式如下：\n$$\n\\nu_t = \\tilde{\\nu} f_{v1}(\\chi)\n$$\n其中 $f_{v1}$ 是一个粘性阻尼函数，旨在正确模拟固体壁面附近的湍流行为。函数 $f_{v1}$ 取决于无量纲比值 $\\chi$，其定义为：\n$$\n\\chi \\equiv \\frac{\\tilde{\\nu}}{\\nu}\n$$\n这里，$\\nu$ 是流体的分子运动粘度。SA模型中阻尼函数 $f_{v1}$ 的典型形式为：\n$$\nf_{v1}(\\chi) = \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}\n$$\n其中 $c_{v1}$ 是一个模型常数。\n\n问题提供了以下数据：\n- 分子运动粘度：$\\nu = 1.50 \\times 10^{-5}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$\n- Spalart–Allmaras工作变量：$\\tilde{\\nu} = 5.00 \\times 10^{-5}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$\n- SA模型常数：$c_{v1} = 7.1$\n\n首先，我们计算无量纲比值 $\\chi$ 的值：\n$$\n\\chi = \\frac{\\tilde{\\nu}}{\\nu} = \\frac{5.00 \\times 10^{-5}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}}{1.50 \\times 10^{-5}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}} = \\frac{5.00}{1.50} = \\frac{10}{3}\n$$\n接下来，我们使用给定的常数 $c_{v1} = 7.1$ 计算粘性阻尼函数 $f_{v1}(\\chi)$ 的值：\n$$\nf_{v1}\\left(\\frac{10}{3}\\right) = \\frac{\\left(\\frac{10}{3}\\right)^3}{\\left(\\frac{10}{3}\\right)^3 + (7.1)^3} = \\frac{\\frac{1000}{27}}{\\frac{1000}{27} + 357.911} \\approx \\frac{37.037037}{37.037037 + 357.911} = \\frac{37.037037}{394.948037} \\approx 0.0937769\n$$\n现在，我们可以计算湍流运动粘度 $\\nu_t$：\n$$\n\\nu_t = \\tilde{\\nu} f_{v1}(\\chi) = (5.00 \\times 10^{-5}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}) \\times 0.0937769 \\approx 4.688845 \\times 10^{-6}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}\n$$\n问题要求此结果保留四位有效数字：\n$$\n\\nu_t \\approx 4.689 \\times 10^{-6}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}\n$$\n\n问题的第二部分要求分析无量纲比值 $\\nu_t / \\tilde{\\nu}$ 在 $\\chi \\to 0$ 和 $\\chi \\to \\infty$ 时的极限。根据模型的定义，这个比值就是阻尼函数本身：\n$$\n\\frac{\\nu_t}{\\tilde{\\nu}} = f_{v1}(\\chi) = \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}\n$$\n\n我们计算当 $\\chi \\to 0$ 时的极限：\n$$\n\\lim_{\\chi \\to 0} \\frac{\\nu_t}{\\tilde{\\nu}} = \\lim_{\\chi \\to 0} f_{v1}(\\chi) = \\lim_{\\chi \\to 0} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3} = \\frac{0^3}{0^3 + c_{v1}^3} = \\frac{0}{c_{v1}^3} = 0\n$$\n这个极限在物理上是合理的。条件 $\\chi = \\tilde{\\nu}/\\nu \\to 0$ 对应于分子粘度占主导地位的区域，例如紧邻固体表面的粘性子层。在此区域中，湍流脉动被抑制，湍流粘度 $\\nu_t$ 必须趋近于零。阻尼函数 $f_{v1}$ 确保了这种正确的近壁行为。\n\n接下来，我们计算当 $\\chi \\to \\infty$ 时的极限：\n$$\n\\lim_{\\chi \\to \\infty} \\frac{\\nu_t}{\\tilde{\\nu}} = \\lim_{\\chi \\to \\infty} f_{v1}(\\chi) = \\lim_{\\chi \\to \\infty} \\frac{\\chi^3}{\\chi^3 + c_{v1}^3}\n$$\n为了计算这个极限，我们将分子和分母同除以 $\\chi^3$：\n$$\n\\lim_{\\chi \\to \\infty} \\frac{1}{1 + \\frac{c_{v1}^3}{\\chi^3}} = \\frac{1}{1 + 0} = 1\n$$\n这个极限在物理上也是合理的。条件 $\\chi = \\tilde{\\nu}/\\nu \\to \\infty$ 对应于远离壁面、湍流效应远强于分子粘性效应的区域（即高雷诺数湍流）。在这些区域，分子粘度的阻尼效应可以忽略不计，模型的设计使得工作变量 $\\tilde{\\nu}$ 变得等同于湍流粘度 $\\nu_t$。因此，比值 $\\nu_t / \\tilde{\\nu}$ 正确地趋近于 $1$。\n\n所要求的三个结果是：\n1. 湍流运动粘度 $\\nu_t \\approx 4.689 \\times 10^{-6}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-1}$。\n2. 极限 $\\lim_{\\chi \\to 0} (\\nu_t / \\tilde{\\nu}) = 0$。\n3. 极限 $\\lim_{\\chi \\to \\infty} (\\nu_t / \\tilde{\\nu}) = 1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.689 \\times 10^{-6} & 0 & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在计算流体力学中，理论知识必须转化为实际的数值设置，而网格划分是其中最关键的一步。本练习将带你完成一个至关重要的实践任务：估算使用Spalart-Allmaras模型进行壁面解析模拟时所需的网格分辨率。你将学习如何从流动参数出发，通过壁面单位（如 $y^+$）等概念，推导出近壁区第一个网格节点的高度以及流向和展向的网格尺寸。",
            "id": "3380871",
            "problem": "在空气中，一个光滑、零压力梯度的湍流边界层在平板上发展。您将使用不带壁面函数的 Spalart–Allmaras (SA) 湍流模型，因此必须解析粘性底层。考虑一个距离前缘 $x = 0.5\\,\\mathrm{m}$ 的代表性流向位置，自由来流速度 $U_{\\infty} = 30\\,\\mathrm{m\\,s^{-1}}$，密度 $\\rho = 1.225\\,\\mathrm{kg\\,m^{-3}}$，运动粘度 $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}}$。假设流动为不可压缩流动，壁面为水力光滑壁面。\n\n从壁面单位的基本定义以及粘性底层（其中平均速度遵循 $u^{+} = y^{+}$）必须被解析的要求出发，按以下步骤进行：\n\n- 建立第一个离壁点、流向间距和展向间距的壁面单位关系式：$y_{1}^{+}$、$\\Delta x^{+}$ 和 $\\Delta z^{+}$，用粘性长度尺度和摩擦速度表示。\n- 将摩擦速度与局部壁面剪切应力和局部湍流壁面摩擦系数联系起来。\n- 为了封闭在零压力梯度下光滑平板的推导，采用局部湍流壁面摩擦系数的经典 1/7 次方律关系式，$C_{f,x} = 0.026\\,\\mathrm{Re}_{x}^{-1/7}$，其中 $\\mathrm{Re}_{x} = U_{\\infty} x / \\nu$。\n- 设定与使用不带壁面函数的 SA 模型解析粘性底层相一致的近壁面解析目标：$y_{1}^{+} = 0.5$、$\\Delta x^{+} = 50$ 和 $\\Delta z^{+} = 15$。将这些作为壁面单位要求，并将其转换为物理间距。\n\n推导 $\\Delta x$、$\\Delta z$ 和 $y_{1}$ 关于 $U_{\\infty}$、$x$、$\\nu$ 和壁面单位目标的符号表达式，然后在给定条件下进行数值计算。将最终间距表示为单个行向量 $\\begin{pmatrix}\\Delta x & \\Delta z & y_{1}\\end{pmatrix}$，单位为毫米，并将答案四舍五入至三位有效数字。",
            "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n步骤 1：提取已知条件\n-   **流动配置**：光滑、零压力梯度的平板湍流边界层。不可压缩流动。水力光滑壁面。\n-   **流体性质（空气）**：密度 $\\rho = 1.225\\,\\mathrm{kg\\,m^{-3}}$，运动粘度 $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}}$。\n-   **流动条件**：自由来流速度 $U_{\\infty} = 30\\,\\mathrm{m\\,s^{-1}}$。\n-   **位置**：距离前缘的流向位置 $x = 0.5\\,\\mathrm{m}$。\n-   **湍流模型**：不带壁面函数的 Spalart–Allmaras (SA) 模型。\n-   **定义和关系式**：\n    -   粘性底层速度剖面：$u^{+} = y^{+}$。\n    -   局部雷诺数：$\\mathrm{Re}_{x} = U_{\\infty} x / \\nu$。\n    -   局部壁面摩擦系数关系式：$C_{f,x} = 0.026\\,\\mathrm{Re}_{x}^{-1/7}$。\n-   **解析目标（以壁面单位表示）**：\n    -   第一个离壁点间距：$y_{1}^{+} = 0.5$。\n    -   流向网格间距：$\\Delta x^{+} = 50$。\n    -   展向网格间距：$\\Delta z^{+} = 15$。\n\n步骤 2：使用提取的已知条件进行验证\n该问题在科学上是合理的、适定的且客观的。\n-   **科学依据**：该问题基于流体力学和计算流体力学 (CFD) 的基本原理。湍流边界层、壁面单位 ($y^{+}$、$u^{+}$)、摩擦速度 ($u_{\\tau}$)、壁面摩擦系数 ($C_{f,x}$) 和雷诺数 ($\\mathrm{Re}_{x}$) 等概念都是标准的。对 $C_{f,x}$ 使用 1/7 次方律是平板湍流边界层的经典经验近似。指定的壁面单位解析目标（$y_{1}^{+} < 1$、$\\Delta x^{+} \\approx 50$、$\\Delta z^{+} \\approx 15$）是旨在解析粘性底层的壁面解析模拟的典型且合适的目标，这正是无壁面函数的 SA 模型所要求的。所有提供的数值对于标准条件下的空气都是物理上现实的。\n-   **适定性和完整性**：该问题是自洽的，提供了推导唯一解所需的所有数据和关系。求解路径逻辑结构清晰。\n-   **客观性**：语言精确，没有主观或模糊的术语。\n\n步骤 3：结论和行动\n该问题被认为是**有效的**。将提供完整解答。\n\n目标是确定所需的物理网格间距 $y_{1}$（第一个单元高度）、$\\Delta x$（流向间距）和 $\\Delta z$（展向间距），以满足指定的以壁面单位表示的解析目标。推导过程将首先建立符号表达式，然后进行数值计算。\n\n无量纲壁面单位使用摩擦速度 $u_{\\tau}$ 和运动粘度 $\\nu$ 定义。摩擦速度定义为 $u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$，其中 $\\tau_{w}$ 是壁面剪切应力。粘性长度尺度为 $\\delta_{\\nu} = \\nu/u_{\\tau}$。\n\n壁面单位间距定义为：\n$$y_{1}^{+} = \\frac{y_{1}}{\\delta_{\\nu}} = \\frac{y_{1} u_{\\tau}}{\\nu}$$\n$$\\Delta x^{+} = \\frac{\\Delta x}{\\delta_{\\nu}} = \\frac{\\Delta x u_{\\tau}}{\\nu}$$\n$$\\Delta z^{+} = \\frac{\\Delta z}{\\delta_{\\nu}} = \\frac{\\Delta z u_{\\tau}}{\\nu}$$\n重新整理这些方程，得到用壁面单位目标和流动性质表示的物理间距：\n$$y_{1} = \\frac{y_{1}^{+} \\nu}{u_{\\tau}}$$\n$$\\Delta x = \\frac{\\Delta x^{+} \\nu}{u_{\\tau}}$$\n$$\\Delta z = \\frac{\\Delta z^{+} \\nu}{u_{\\tau}}$$\n为了继续，我们必须确定摩擦速度 $u_{\\tau}$。这可以通过使用局部壁面摩擦系数 $C_{f,x}$ 来完成，其定义为：\n$$C_{f,x} = \\frac{\\tau_{w}}{\\frac{1}{2}\\rho U_{\\infty}^{2}}$$\n将 $\\tau_{w} = \\rho u_{\\tau}^{2}$ 代入 $C_{f,x}$ 的定义中，得到：\n$$C_{f,x} = \\frac{\\rho u_{\\tau}^{2}}{\\frac{1}{2}\\rho U_{\\infty}^{2}} = \\frac{2 u_{\\tau}^{2}}{U_{\\infty}^{2}}$$\n解出 $u_{\\tau}$ 得到：\n$$u_{\\tau} = U_{\\infty} \\sqrt{\\frac{C_{f,x}}{2}}$$\n问题提供了在零压力梯度下光滑平板的 $C_{f,x}$ 的经典 1/7 次方律关系式：\n$$C_{f,x} = 0.026\\,\\mathrm{Re}_{x}^{-1/7}$$\n其中局部雷诺数 $\\mathrm{Re}_{x}$ 由下式给出：\n$$\\mathrm{Re}_{x} = \\frac{U_{\\infty} x}{\\nu}$$\n通过将 $C_{f,x}$ 的表达式代入 $u_{\\tau}$ 的方程，我们推导出用给定参数表示的摩擦速度的符号表达式：\n$$u_{\\tau} = U_{\\infty} \\sqrt{\\frac{0.026\\,\\mathrm{Re}_{x}^{-1/7}}{2}} = U_{\\infty} \\sqrt{0.013}\\,\\mathrm{Re}_{x}^{-1/14}$$\n现在，我们可以将这个 $u_{\\tau}$ 的表达式代回到物理间距的方程中。这就得到了 $y_{1}$、$\\Delta x$ 和 $\\Delta z$ 的最终符号表达式：\n$$y_{1} = \\frac{y_{1}^{+} \\nu}{U_{\\infty} \\sqrt{0.013}\\,\\mathrm{Re}_{x}^{-1/14}} = \\frac{y_{1}^{+} \\nu}{\\sqrt{0.013}\\,U_{\\infty}} \\left( \\frac{U_{\\infty} x}{\\nu} \\right)^{1/14}$$\n$$\\Delta x = \\frac{\\Delta x^{+} \\nu}{U_{\\infty} \\sqrt{0.013}\\,\\mathrm{Re}_{x}^{-1/14}} = \\frac{\\Delta x^{+} \\nu}{\\sqrt{0.013}\\,U_{\\infty}} \\left( \\frac{U_{\\infty} x}{\\nu} \\right)^{1/14}$$\n$$\\Delta z = \\frac{\\Delta z^{+} \\nu}{U_{\\infty} \\sqrt{0.013}\\,\\mathrm{Re}_{x}^{-1/14}} = \\frac{\\Delta z^{+} \\nu}{\\sqrt{0.013}\\,U_{\\infty}} \\left( \\frac{U_{\\infty} x}{\\nu} \\right)^{1/14}$$\n这些就是所需的符号表达式。接下来，我们使用所提供的值对其进行数值计算：$U_{\\infty} = 30\\,\\mathrm{m\\,s^{-1}}$、$x = 0.5\\,\\mathrm{m}$、$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}}$、$y_{1}^{+} = 0.5$、$\\Delta x^{+} = 50$ 和 $\\Delta z^{+} = 15$。\n\n首先，计算局部雷诺数 $\\mathrm{Re}_{x}$：\n$$\\mathrm{Re}_{x} = \\frac{(30\\,\\mathrm{m\\,s^{-1}})(0.5\\,\\mathrm{m})}{1.5\\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}}} = \\frac{15}{1.5\\times 10^{-5}} = 1.0 \\times 10^{6}$$\n接下来，计算局部壁面摩擦系数 $C_{f,x}$：\n$$C_{f,x} = 0.026 \\times (1.0 \\times 10^{6})^{-1/7} \\approx 0.026 \\times 0.13895 \\approx 0.0036127$$\n现在，计算摩擦速度 $u_{\\tau}$：\n$$u_{\\tau} = U_{\\infty} \\sqrt{\\frac{C_{f,x}}{2}} \\approx 30\\,\\mathrm{m\\,s^{-1}} \\times \\sqrt{\\frac{0.0036127}{2}} \\approx 30 \\times \\sqrt{0.00180635} \\approx 30 \\times 0.042501 \\,\\mathrm{m\\,s^{-1}} \\approx 1.2750\\,\\mathrm{m\\,s^{-1}}$$\n我们现在可以确定所需的以米为单位的物理间距：\n$$y_{1} = \\frac{y_{1}^{+} \\nu}{u_{\\tau}} \\approx \\frac{0.5 \\times (1.5\\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}})}{1.2750\\,\\mathrm{m\\,s^{-1}}} \\approx 5.882 \\times 10^{-6}\\,\\mathrm{m}$$\n$$\\Delta x = \\frac{\\Delta x^{+} \\nu}{u_{\\tau}} \\approx \\frac{50 \\times (1.5\\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}})}{1.2750\\,\\mathrm{m\\,s^{-1}}} \\approx 5.882 \\times 10^{-4}\\,\\mathrm{m}$$\n$$\\Delta z = \\frac{\\Delta z^{+} \\nu}{u_{\\tau}} \\approx \\frac{15 \\times (1.5\\times 10^{-5}\\,\\mathrm{m^{2}\\,s^{-1}})}{1.2750\\,\\mathrm{m\\,s^{-1}}} \\approx 1.765 \\times 10^{-4}\\,\\mathrm{m}$$\n问题要求最终答案以毫米为单位，并四舍五入到三位有效数字。我们将结果从米转换为毫米（$1\\,\\mathrm{m} = 1000\\,\\mathrm{mm}$）：\n$$y_{1} \\approx 5.882 \\times 10^{-3}\\,\\mathrm{mm} \\approx 0.00588\\,\\mathrm{mm}$$\n$$\\Delta x \\approx 0.5882\\,\\mathrm{mm} \\approx 0.588\\,\\mathrm{mm}$$\n$$\\Delta z \\approx 0.1765\\,\\mathrm{mm} \\approx 0.176\\,\\mathrm{mm}$$\n最终答案表示为行向量 $\\begin{pmatrix}\\Delta x & \\Delta z & y_{1}\\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.588 & 0.176 & 0.00588\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Spalart-Allmaras模型的输运方程在数值求解上存在独特的挑战，尤其是在近壁区的“刚性”(stiffness)问题，这容易导致非物理的负值出现。这个高级练习将让你深入剖析这一问题的根源，通过分析离散方程，你不仅将推导出一个保证解的非负性的时间步长限制，还将设计一个更为稳健的正定性限制器。这项实践对于理解和开发可靠的CFD求解器至关重要。",
            "id": "3380837",
            "problem": "考虑一维通道中均匀平均对流速度为 $u>0$ 时，工作变量 $\\tilde{\\nu}$ 的单方程 Spalart–Allmaras (SA) 湍流模型。$\\tilde{\\nu}$ 的控制输运方程包含对流、扩散、产生和耗散。为了进行严格分析，采用以下物理上标准的简化：保留与平均应变 $S$ 成正比的线性产生项和与 $(\\tilde{\\nu}/d)^{2}$ 成正比的二次耗散项，并忽略非线性梯度产生项。得到的偏微分方程为\n$$\n\\frac{\\partial \\tilde{\\nu}}{\\partial t} + u \\frac{\\partial \\tilde{\\nu}}{\\partial x} \\;=\\; c_{b1} S \\tilde{\\nu} \\;+\\; \\frac{\\partial}{\\partial x}\\!\\left(\\alpha\\,\\frac{\\partial \\tilde{\\nu}}{\\partial x}\\right) \\;-\\; c_{w1}\\left(\\frac{\\tilde{\\nu}}{d}\\right)^{2},\n$$\n其中 $\\alpha \\equiv \\frac{\\nu + \\tilde{\\nu}}{\\sigma}$，$\\nu$ 是分子运动粘度，$\\sigma$ 是一个正的模型常数，$c_{b1}$ 是产生常数，$c_{w1}$ 是耗散常数，$d>0$ 是壁面距离函数。\n\n使用时间上的显式欧拉格式、针对 $u>0$ 的一阶迎风对流格式以及在时间步开始时计算并冻结系数 $\\alpha$ 的二阶中心扩散格式，在均匀网格 $x_{i} = i\\,\\Delta x$ 上对此方程进行离散化。在单元索引 $i$ 处的半离散更新格式为\n$$\n\\tilde{\\nu}_{i}^{n+1} \\;=\\; \\tilde{\\nu}_{i}^{n} \\;-\\; \\lambda\\left(\\tilde{\\nu}_{i}^{n} - \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\mu\\left(\\tilde{\\nu}_{i+1}^{n} - 2\\tilde{\\nu}_{i}^{n} + \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\Delta t\\,c_{b1} S \\tilde{\\nu}_{i}^{n} \\;-\\; \\Delta t\\,c_{w1}\\left(\\frac{\\tilde{\\nu}_{i}^{n}}{d}\\right)^{2},\n$$\n其中 $\\lambda \\equiv \\frac{u\\,\\Delta t}{\\Delta x}$ 且 $\\mu \\equiv \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}$。假设初始数据非负，即对所有 $i$ 都有 $\\tilde{\\nu}_{i}^{0}\\ge 0$，并且 $\\alpha$ 受其在已知界限 $\\tilde{\\nu}_{\\max}$ 处的值的限制，即 $\\alpha \\le \\alpha_{\\max}$，其中 $\\alpha_{\\max} \\equiv \\frac{\\nu + \\tilde{\\nu}_{\\max}}{\\sigma}$。\n\n任务 A。从离散更新格式以及标量单调格式在显式时间步进下保持非负性的要求出发，推导一个充分的时间步长限制条件，以保证只要 $\\tilde{\\nu}_{i}^{n}\\ge 0$ 和 $\\tilde{\\nu}_{i\\pm 1}^{n}\\ge 0$，就有 $\\tilde{\\nu}_{i}^{n+1}\\ge 0$。你的推导必须明确指出由于耗散项的显式离散化导致 $\\tilde{\\nu}$ 可能变为负值的机制，并以 $u$、$\\Delta x$、$\\alpha_{\\max}$、$c_{w1}$、$d$ 和 $\\tilde{\\nu}_{\\max}$ 的形式给出一个关于 $\\Delta t$ 的闭式界。\n\n任务 B。提出一个与连续耗散模型一致的保正限制器，该限制器通过在一个时间步长内对局部常微分方程 $\\,\\frac{\\partial \\tilde{\\nu}}{\\partial t} = -\\,c_{w1}\\left(\\frac{\\tilde{\\nu}}{d}\\right)^{2}\\,$ 进行解析积分得到，同时将对流、扩散和产生视为已施加作用，从而产生一个中间值 $\\tilde{\\nu}^{*}$。给出将 $\\tilde{\\nu}^{*}$ 映射到 $\\tilde{\\nu}^{n+1}$ 并且对任何 $\\tilde{\\nu}^{*}\\ge 0$ 都保持正性的闭式表达式。\n\n最后，使用以下物理上一致的参数评估你的时间步长限制：\n- $u = 40\\,\\text{m/s}$,\n- $\\Delta x = 1.0\\times 10^{-4}\\,\\text{m}$,\n- $\\nu = 1.5\\times 10^{-5}\\,\\text{m}^{2}/\\text{s}$,\n- $\\sigma = \\frac{2}{3}$,\n- $d = 5.0\\times 10^{-4}\\,\\text{m}$,\n- $c_{w1} = 3.239$,\n- $\\tilde{\\nu}_{\\max} = 5.0\\times 10^{-4}\\,\\text{m}^{2}/\\text{s}$。\n\n以秒为单位表示最大允许时间步长，并四舍五入到四位有效数字。同时以闭式解析表达式的形式提供保正耗散限制器。你的最终答案必须包含数值时间步长和其后的解析限制器，并一并给出。",
            "solution": "问题要求为一个简化的 Spalart-Allmaras (SA) 模型的保正显式数值格式推导一个时间步长限制，并为耗散项构建一个保正限制器。最后，必须使用一组给定的参数对推导出的时间步长限制进行评估。\n\n### 问题验证\n\n首先，对问题陈述进行验证。\n已知条件如下：\n-   SA 工作变量 $\\tilde{\\nu}$ 的偏微分方程：\n    $$\n    \\frac{\\partial \\tilde{\\nu}}{\\partial t} + u \\frac{\\partial \\tilde{\\nu}}{\\partial x} \\;=\\; c_{b1} S \\tilde{\\nu} \\;+\\; \\frac{\\partial}{\\partial x}\\!\\left(\\alpha\\,\\frac{\\partial \\tilde{\\nu}}{\\partial x}\\right) \\;-\\; c_{w1}\\left(\\frac{\\tilde{\\nu}}{d}\\right)^{2}\n    $$\n-   相关参数的定义：$u > 0$，$\\alpha \\equiv \\frac{\\nu + \\tilde{\\nu}}{\\sigma}$，$\\sigma>0$，$d>0$。\n-   半离散更新法则：\n    $$\n    \\tilde{\\nu}_{i}^{n+1} \\;=\\; \\tilde{\\nu}_{i}^{n} \\;-\\; \\lambda\\left(\\tilde{\\nu}_{i}^{n} - \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\mu\\left(\\tilde{\\nu}_{i+1}^{n} - 2\\tilde{\\nu}_{i}^{n} + \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\Delta t\\,c_{b1} S \\tilde{\\nu}_{i}^{n} \\;-\\; \\Delta t\\,c_{w1}\\left(\\frac{\\tilde{\\nu}_{i}^{n}}{d}\\right)^{2}\n    $$\n-   数值参数的定义：$\\lambda \\equiv \\frac{u\\,\\Delta t}{\\Delta x}$ 和 $\\mu \\equiv \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}$。\n-   初始条件：对所有 $i$ 都有 $\\tilde{\\nu}_{i}^{0}\\ge 0$。\n-   $\\alpha$ 的一个上界：$\\alpha \\le \\alpha_{\\max}$ 其中 $\\alpha_{\\max} \\equiv \\frac{\\nu + \\tilde{\\nu}_{\\max}}{\\sigma}$。\n-   用于评估的数值：$u = 40\\,\\text{m/s}$, $\\Delta x = 1.0\\times 10^{-4}\\,\\text{m}$, $\\nu = 1.5\\times 10^{-5}\\,\\text{m}^{2}/\\text{s}$, $\\sigma = \\frac{2}{3}$, $d = 5.0\\times 10^{-4}\\,\\text{m}$, $c_{w1} = 3.239$, $\\tilde{\\nu}_{\\max} = 5.0\\times 10^{-4}\\,\\text{m}^{2}/\\text{s}$。\n\n该问题在计算流体动力学和数值分析方面有科学依据。它是适定的、客观的和自洽的，但关于产生项 $c_{b1} S \\tilde{\\nu}$ 有一个需要澄清的小点。问题要求一个保证非负性的充分时间步长限制。如果 $c_{b1}S > 0$，产生项作为 $\\tilde{\\nu}$ 的源项，有助于保持正性。为了推导一个鲁棒的充分条件，我们必须考虑最坏的情况，即该源项的贡献最小。假设 $c_{b1}S \\ge 0$，最小源项为零。将此项设为 $c_{b1}S=0$ 来考虑将产生最严格的，因此也是充分的时间步长限制。因此，该问题被认为是有效的。\n\n### 任务 A：时间步长限制的推导\n\n目标是在给定所有网格点 $j$ 上 $\\tilde{\\nu}_{j}^{n} \\ge 0$ 的条件下，找到一个能保证 $\\tilde{\\nu}_{i}^{n+1} \\ge 0$ 的关于时间步长 $\\Delta t$ 的充分条件。\n离散化方程为：\n$$\n\\tilde{\\nu}_{i}^{n+1} \\;=\\; \\tilde{\\nu}_{i}^{n} \\;-\\; \\frac{u\\,\\Delta t}{\\Delta x}\\left(\\tilde{\\nu}_{i}^{n} - \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}\\left(\\tilde{\\nu}_{i+1}^{n} - 2\\tilde{\\nu}_{i}^{n} + \\tilde{\\nu}_{i-1}^{n}\\right) \\;+\\; \\Delta t\\,c_{b1} S \\tilde{\\nu}_{i}^{n} \\;-\\; \\Delta t\\,c_{w1}\\left(\\frac{\\tilde{\\nu}_{i}^{n}}{d}\\right)^{2}\n$$\n为了分析正性，我们通过将在时间层 $n$ 上具有相同空间索引的项归类来重新排列方程：\n$$\n\\tilde{\\nu}_{i}^{n+1} \\;=\\; \\left(1 - \\frac{u\\,\\Delta t}{\\Delta x} - \\frac{2\\alpha\\,\\Delta t}{\\Delta x^{2}} + \\Delta t\\,c_{b1} S\\right)\\tilde{\\nu}_{i}^{n} \\;+\\; \\left(\\frac{u\\,\\Delta t}{\\Delta x} + \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}\\right)\\tilde{\\nu}_{i-1}^{n} \\;+\\; \\left(\\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}}\\right)\\tilde{\\nu}_{i+1}^{n} \\;-\\; \\Delta t\\,c_{w1}\\frac{(\\tilde{\\nu}_{i}^{n})^{2}}{d^{2}}\n$$\n给定对所有 $j$ 都有 $\\tilde{\\nu}_{j}^{n} \\ge 0$，且 $u, \\Delta t, \\Delta x, \\alpha$ 均为正值，$\\tilde{\\nu}_{i-1}^{n}$ 和 $\\tilde{\\nu}_{i+1}^{n}$ 的系数是非负的。因此，涉及邻近点的项 $(\\frac{u\\,\\Delta t}{\\Delta x} + \\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}})\\tilde{\\nu}_{i-1}^{n}$ 和 $(\\frac{\\alpha\\,\\Delta t}{\\Delta x^{2}})\\tilde{\\nu}_{i+1}^{n}$ 是非负的。\n\n确保 $\\tilde{\\nu}_{i}^{n+1} \\ge 0$ 的一个充分条件是，涉及 $\\tilde{\\nu}_{i}^{n}$ 的其余项之和为非负。这是一个保守的条件，等价于要求在最坏情况下（即来自邻近点的贡献为零，$\\tilde{\\nu}_{i-1}^{n} = 0$ 且 $\\tilde{\\nu}_{i+1}^{n} = 0$）保持正性。\n$$\n\\left(1 - \\frac{u\\,\\Delta t}{\\Delta x} - \\frac{2\\alpha\\,\\Delta t}{\\Delta x^{2}} + \\Delta t\\,c_{b1} S\\right)\\tilde{\\nu}_{i}^{n} - \\Delta t\\,c_{w1}\\frac{(\\tilde{\\nu}_{i}^{n})^{2}}{d^{2}} \\ge 0\n$$\n假设 $\\tilde{\\nu}_{i}^{n} > 0$，我们可以除以 $\\tilde{\\nu}_{i}^{n}$（如果邻近点也为零，$\\tilde{\\nu}_{i}^{n}=0$ 的情况会使不等式自然满足，得到 $\\tilde{\\nu}_{i}^{n+1}=0$）。\n$$\n1 - \\frac{u\\,\\Delta t}{\\Delta x} - \\frac{2\\alpha\\,\\Delta t}{\\Delta x^{2}} + \\Delta t\\,c_{b1} S - \\Delta t\\,c_{w1}\\frac{\\tilde{\\nu}_{i}^{n}}{d^{2}} \\ge 0\n$$\n这个不等式指明了产生负值的机制：对流 ($u \\tilde{\\nu}_{i}^{n}$) 和扩散 ($2\\alpha \\tilde{\\nu}_{i}^{n} / \\Delta x$) 的流出量之和，再加上显式耗散，在一个时间步长内可能超过局部值 $\\tilde{\\nu}_{i}^{n}$。\n重新整理以求解 $\\Delta t$：\n$$\n1 + \\Delta t\\,c_{b1} S \\ge \\Delta t \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} + \\frac{c_{w1}\\tilde{\\nu}_{i}^{n}}{d^2} \\right)\n$$\n$$\n\\Delta t \\le \\frac{1 + \\Delta t\\,c_{b1} S}{\\frac{u}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} + \\frac{c_{w1}\\tilde{\\nu}_{i}^{n}}{d^2}}\n$$\n这不是一个关于 $\\Delta t$ 的显式界。我们可以通过回到前一个不等式并分离出 $\\Delta t$ 来得到一个显式界：\n$$\n1 \\ge \\Delta t \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} - c_{b1} S + \\frac{c_{w1}\\tilde{\\nu}_{i}^{n}}{d^2} \\right)\n$$\n$$\n\\Delta t \\le \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} - c_{b1} S + \\frac{c_{w1}\\tilde{\\nu}_{i}^{n}}{d^2} \\right)^{-1}\n$$\n为了获得一个对所有网格点和所有时间都有效的时间步长限制，我们必须选择最严格的条件。这对应于最大化分母：\n1.  最大化 $\\alpha$：使用给定的界 $\\alpha \\le \\alpha_{\\max}$。\n2.  最大化 $\\tilde{\\nu}_{i}^{n}$：使用给定的界 $\\tilde{\\nu}_{\\max}$。\n3.  最小化 $c_{b1}S$：如在问题验证中所论证的，项 $c_{b1}S\\tilde{\\nu}$ 是一个源项（对于 $S>0$），它有助于保持正性。最严格（因此也是充分）的条件是通过假设可能的最小源项得到的，即 $c_{b1}S = 0$。\n\n由此得到的充分时间步长限制为：\n$$\n\\Delta t \\le \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha_{\\max}}{\\Delta x^2} + \\frac{c_{w1}\\tilde{\\nu}_{\\max}}{d^2} \\right)^{-1}\n$$\n\n### 任务 B：耗散项的保正限制器\n\n任务是通过在一个时间步长 $\\Delta t$ 内求解局部常微分方程 $\\frac{\\partial \\tilde{\\nu}}{\\partial t} = -c_{w1}\\left(\\frac{\\tilde{\\nu}}{d}\\right)^{2}$，为耗散项找到一个保正的更新方法。设 $\\tilde{\\nu}^{*}$ 是经过对流、扩散和产生步骤后的变量值，它作为耗散步骤的初始条件。我们求解：\n$$\n\\frac{d\\tilde{\\nu}}{dt} = -\\frac{c_{w1}}{d^2} \\tilde{\\nu}^2\n$$\n初始条件为 $\\tilde{\\nu}(0) = \\tilde{\\nu}^{*}$。我们寻求 $\\tilde{\\nu}^{n+1} = \\tilde{\\nu}(\\Delta t)$。这是一个可分离的常微分方程：\n$$\n\\frac{d\\tilde{\\nu}}{\\tilde{\\nu}^2} = -\\frac{c_{w1}}{d^2} dt\n$$\n从 $t=0$ 到 $\\Delta t$（以及从 $\\tilde{\\nu}^{*}$ 到 $\\tilde{\\nu}^{n+1}$）积分：\n$$\n\\int_{\\tilde{\\nu}^{*}}^{\\tilde{\\nu}^{n+1}} \\frac{1}{\\nu'^2} d\\nu' = -\\int_{0}^{\\Delta t} \\frac{c_{w1}}{d^2} dt'\n$$\n$$\n\\left[ -\\frac{1}{\\nu'} \\right]_{\\tilde{\\nu}^{*}}^{\\tilde{\\nu}^{n+1}} = -\\frac{c_{w1}\\Delta t}{d^2}\n$$\n$$\n-\\frac{1}{\\tilde{\\nu}^{n+1}} + \\frac{1}{\\tilde{\\nu}^{*}} = -\\frac{c_{w1}\\Delta t}{d^2}\n$$\n求解 $\\tilde{\\nu}^{n+1}$：\n$$\n\\frac{1}{\\tilde{\\nu}^{n+1}} = \\frac{1}{\\tilde{\\nu}^{*}} + \\frac{c_{w1}\\Delta t}{d^2} = \\frac{d^2 + c_{w1}\\Delta t \\tilde{\\nu}^{*}}{d^2 \\tilde{\\nu}^{*}}\n$$\n$$\n\\tilde{\\nu}^{n+1} = \\frac{d^2 \\tilde{\\nu}^{*}}{d^2 + c_{w1}\\Delta t \\tilde{\\nu}^{*}} = \\frac{\\tilde{\\nu}^{*}}{1 + \\frac{c_{w1}\\Delta t}{d^2}\\tilde{\\nu}^{*}}\n$$\n该表达式提供了从中间状态 $\\tilde{\\nu}^{*}$ 到最终状态 $\\tilde{\\nu}^{n+1}$ 的映射。对于任何非负的 $\\tilde{\\nu}^{*} \\ge 0$，分子是非负的，而分母是严格为正的（因为 $c_{w1}, \\Delta t, d^2$ 均为正），从而保证 $\\tilde{\\nu}^{n+1} \\ge 0$。\n\n### 最终评估\n\n我们被要求使用给定的数值来评估时间步长限制。\n1.  计算 $\\alpha_{\\max}$：\n    $$ \\alpha_{\\max} = \\frac{\\nu + \\tilde{\\nu}_{\\max}}{\\sigma} = \\frac{1.5\\times 10^{-5}\\,\\text{m}^2/\\text{s} + 5.0\\times 10^{-4}\\,\\text{m}^2/\\text{s}}{2/3} = \\frac{5.15\\times 10^{-4}}{2/3} = 7.725 \\times 10^{-4}\\,\\text{m}^2/\\text{s} $$\n2.  计算时间步长倒数的三个分量：\n    -   对流频率： $\\frac{u}{\\Delta x} = \\frac{40\\,\\text{m/s}}{1.0\\times 10^{-4}\\,\\text{m}} = 4.0 \\times 10^{5}\\,\\text{s}^{-1}$\n    -   扩散频率： $\\frac{2\\alpha_{\\max}}{\\Delta x^2} = \\frac{2 \\times 7.725 \\times 10^{-4}\\,\\text{m}^2/\\text{s}}{(1.0\\times 10^{-4}\\,\\text{m})^2} = \\frac{1.545 \\times 10^{-3}}{1.0 \\times 10^{-8}}\\,\\text{s}^{-1} = 1.545 \\times 10^{5}\\,\\text{s}^{-1}$\n    -   耗散频率： $\\frac{c_{w1}\\tilde{\\nu}_{\\max}}{d^2} = \\frac{3.239 \\times 5.0\\times 10^{-4}\\,\\text{m}^2/\\text{s}}{(5.0\\times 10^{-4}\\,\\text{m})^2} = \\frac{3.239}{5.0\\times 10^{-4}}\\,\\text{s}^{-1} = 6478\\,\\text{s}^{-1}$\n3.  将频率相加以找到 $\\Delta t$ 限制的分母：\n    $$ \\left( \\frac{u}{\\Delta x} + \\frac{2\\alpha_{\\max}}{\\Delta x^2} + \\frac{c_{w1}\\tilde{\\nu}_{\\max}}{d^2} \\right) = (4.0 \\times 10^5 + 1.545 \\times 10^5 + 0.06478 \\times 10^5)\\,\\text{s}^{-1} \\approx 5.6098 \\times 10^5\\,\\text{s}^{-1} $$\n4.  计算最大允许时间步长：\n    $$ \\Delta t_{\\max} = \\frac{1}{5.60978 \\times 10^5\\,\\text{s}^{-1}} \\approx 1.78259 \\times 10^{-6}\\,\\text{s} $$\n    四舍五入到四位有效数字，得到 $\\Delta t_{\\max} = 1.783 \\times 10^{-6}\\,\\text{s}$。\n\n最终答案由这个数值和限制器的解析表达式组成。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.783 \\times 10^{-6} & \\frac{\\tilde{\\nu}^{*}}{1 + \\frac{c_{w1} \\Delta t}{d^2}\\tilde{\\nu}^{*}} \\end{pmatrix}}\n$$"
        }
    ]
}