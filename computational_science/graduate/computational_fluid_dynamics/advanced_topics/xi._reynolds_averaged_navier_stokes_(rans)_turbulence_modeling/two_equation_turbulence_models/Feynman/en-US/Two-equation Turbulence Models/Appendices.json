{
    "hands_on_practices": [
        {
            "introduction": "The accuracy of a RANS simulation heavily depends on the inlet boundary conditions. This exercise focuses on the crucial task of translating physically intuitive quantities, such as turbulence intensity $I$ and length scale $L$, into the specific input variables required by two-equation models, namely the turbulent kinetic energy $k$, dissipation rate $\\varepsilon$, and specific dissipation rate $\\omega$. By working through these calculations and performing a sensitivity analysis , you will gain practical skill in setting up simulations and appreciate how these upstream choices can influence downstream predictions.",
            "id": "3385389",
            "problem": "Consider a steady, incompressible, high-Reynolds-number plug flow in a straight duct of constant cross-section, modeled using the Reynolds-averaged Navier–Stokes (RANS) equations with two-equation turbulence closures. At the inlet, the mean speed is $U = 20\\,\\mathrm{m/s}$, the turbulence intensity is $I = 0.05$ (defined as the ratio of root-mean-square velocity fluctuation to mean speed), and the integral length scale is $L = 0.03\\,\\mathrm{m}$. Assume the standard eddy-viscosity constant is $C_{\\mu} = 0.09$ and that the inlet turbulence is approximately homogeneous and isotropic.\n\nTasks:\n- Starting from the definition of turbulence intensity $I$ and the isotropic relation for turbulent kinetic energy, derive an expression for the inlet turbulent kinetic energy $k(0)$ and compute its numerical value in $\\mathrm{m^2/s^2}$.\n- Using a high-Reynolds-number scaling for the dissipation rate consistent with the eddy-viscosity closure, derive an expression for the inlet dissipation rate $\\varepsilon(0)$ and compute its numerical value in $\\mathrm{m^2/s^3}$.\n- To initialize a $k-\\omega$ model consistently with the $k-\\varepsilon$ model’s eddy viscosity at the inlet, derive an expression for the inlet specific dissipation rate $\\omega(0)$ and compute its numerical value in $\\mathrm{s^{-1}}$.\n- Downstream of the inlet, neglect mean-shear production over the first $x^{\\ast} = 2\\,\\mathrm{m}$ and model the turbulent kinetic energy evolution by advection and dissipation only. Starting from the RANS transport of $k$ with production neglected, derive a closed-form expression for $k(x)$ in terms of $U$, $L$, $C_{\\mu}$, and $k(0)$. Then, using the eddy-viscosity closure to eliminate $\\varepsilon(x)$, obtain a closed-form expression for the eddy viscosity $\\nu_{t}(x)$.\n- Define the dimensionless logarithmic sensitivity of the downstream eddy viscosity to the inlet length scale as $S_{\\nu}(L;x^{\\ast}) \\equiv \\frac{\\partial \\ln \\nu_{t}(x^{\\ast})}{\\partial \\ln L}$. Derive an analytic expression for $S_{\\nu}(L;x^{\\ast})$ and compute its numerical value at $x^{\\ast} = 2\\,\\mathrm{m}$.\n\nRound the final sensitivity $S_{\\nu}(L;x^{\\ast})$ to four significant figures. Express the final sensitivity as a dimensionless number.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- Flow type: Steady, incompressible, high-Reynolds-number plug flow.\n- Geometry: Straight duct of constant cross-section.\n- Turbulence model: Reynolds-averaged Navier–Stokes (RANS) with two-equation closures.\n- Inlet mean speed: $U = 20\\,\\mathrm{m/s}$.\n- Inlet turbulence intensity: $I = 0.05$.\n- Inlet integral length scale: $L = 0.03\\,\\mathrm{m}$.\n- Eddy-viscosity constant: $C_{\\mu} = 0.09$.\n- Inlet turbulence characteristics: Approximately homogeneous and isotropic.\n- Downstream distance for analysis: $x^{\\ast} = 2\\,\\mathrm{m}$.\n- Definition of logarithmic sensitivity: $S_{\\nu}(L;x^{\\ast}) \\equiv \\frac{\\partial \\ln \\nu_{t}(x^{\\ast})}{\\partial \\ln L}$.\n- Simplification for downstream evolution: Neglect mean-shear production and diffusion over the first $x^{\\ast} = 2\\,\\mathrm{m}$, considering only advection and dissipation.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded, using standard concepts and terminology from the field of computational fluid dynamics and turbulence modeling (e.g., RANS, $k-\\varepsilon$, $k-\\omega$, eddy viscosity, turbulence intensity). The provided numerical values are physically realistic for typical engineering flows. The problem is well-posed, with each task clearly defined and sufficient information provided to obtain a unique solution. The language is objective and free of ambiguity. The simplifying assumptions, such as neglecting production and diffusion for modeling turbulence decay, are standard in this context. The problem is not trivial and requires a multi-step derivation involving principles of turbulence modeling and calculus.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution is provided below.\n\n### Task 1: Inlet Turbulent Kinetic Energy $k(0)$\nThe turbulent kinetic energy per unit mass, $k$, is defined as $k = \\frac{1}{2}(\\overline{u'^2} + \\overline{v'^2} + \\overline{w'^2})$, where $u'$, $v'$, and $w'$ are the velocity fluctuations in the coordinate directions. For isotropic turbulence, the normal Reynolds stresses are equal: $\\overline{u'^2} = \\overline{v'^2} = \\overline{w'^2}$. Therefore, $k = \\frac{3}{2}\\overline{u'^2}$.\nThe turbulence intensity $I$ is defined as the ratio of the root-mean-square of a velocity fluctuation component to the mean speed $U$. For isotropic turbulence, this is $I = \\frac{\\sqrt{\\overline{u'^2}}}{U}$.\nFrom this definition, we have $\\overline{u'^2} = I^2 U^2$. Substituting this into the expression for $k$ yields:\n$$k = \\frac{3}{2} (I^2 U^2) = \\frac{3}{2} I^2 U^2$$\nAt the inlet ($x=0$), we can compute the value of the turbulent kinetic energy, $k(0)$:\n$$k(0) = \\frac{3}{2} (0.05)^2 (20\\,\\mathrm{m/s})^2 = \\frac{3}{2} (0.0025) (400\\,\\mathrm{m^2/s^2}) = 1.5\\,\\mathrm{m^2/s^2}$$\n\n### Task 2: Inlet Dissipation Rate $\\varepsilon(0)$\nThe dissipation rate, $\\varepsilon$, can be related to the turbulent kinetic energy $k$ and the integral length scale $L$ based on dimensional arguments, $\\varepsilon \\propto k^{3/2}/L$. A common practice in CFD, which aligns with the eddy-viscosity closure, relates the eddy viscosity $\\nu_t$ to these scales. The eddy viscosity is defined in the $k-\\varepsilon$ model as $\\nu_t = C_{\\mu} \\frac{k^2}{\\varepsilon}$. It can also be scaled with a characteristic velocity ($\\sim k^{1/2}$) and length scale. A standard model for this length scale consistent with the $k-\\varepsilon$ model's constants is $L_{\\text{model}} = C_{\\mu}^{1/4} L$. This gives $\\nu_t \\propto k^{1/2} (C_{\\mu}^{1/4} L)$. Equating the two forms for $\\nu_t$ leads to a relationship for $\\varepsilon$. A more direct and widely used formula for setting inlet conditions, consistent with this scaling, is:\n$$\\varepsilon = C_{\\mu}^{3/4} \\frac{k^{3/2}}{L}$$\nAt the inlet, we compute $\\varepsilon(0)$ using $k(0) = 1.5\\,\\mathrm{m^2/s^2}$, $L = 0.03\\,\\mathrm{m}$, and $C_{\\mu} = 0.09$:\n$$\\varepsilon(0) = (0.09)^{3/4} \\frac{(1.5\\,\\mathrm{m^2/s^2})^{3/2}}{0.03\\,\\mathrm{m}} = (0.09)^{3/4} \\frac{1.5\\sqrt{1.5}}{0.03} \\frac{\\mathrm{m^3/s^3}}{\\mathrm{m}} \\approx 10.061\\,\\mathrm{m^2/s^3}$$\n\n### Task 3: Inlet Specific Dissipation Rate $\\omega(0)$\nThe eddy viscosity is defined in the standard high-Reynolds-number $k-\\omega$ model as $\\nu_t = k/\\omega$. To ensure consistency with the $k-\\varepsilon$ model at the inlet, we equate their respective expressions for $\\nu_t$:\n$$C_{\\mu} \\frac{k(0)^2}{\\varepsilon(0)} = \\frac{k(0)}{\\omega(0)}$$\nSolving for the specific dissipation rate, $\\omega(0)$:\n$$\\omega(0) = \\frac{\\varepsilon(0)}{C_{\\mu} k(0)}$$\nSubstituting the expressions for $\\varepsilon(0)$ and $k(0)$ gives a direct relation to the physical scales:\n$$\\omega(0) = \\frac{C_{\\mu}^{3/4} k(0)^{3/2} / L}{C_{\\mu} k(0)} = C_{\\mu}^{-1/4} \\frac{k(0)^{1/2}}{L}$$\nUsing the numerical values:\n$$\\omega(0) = \\frac{10.061\\,\\mathrm{m^2/s^3}}{0.09 \\times 1.5\\,\\mathrm{m^2/s^2}} \\approx 74.526\\,\\mathrm{s^{-1}}$$\n\n### Task 4: Downstream Evolution of $k(x)$ and $\\nu_t(x)$\nThe transport equation for $k$ in a steady, one-dimensional plug flow, neglecting production and diffusion terms, is:\n$$U \\frac{dk}{dx} = -\\varepsilon(x)$$\nWe assume the relationship between $\\varepsilon$ and $k$ used for the inlet conditions holds for the decaying turbulence downstream, with $L$ being a constant parameter representing the initial scale of the energy-containing eddies:\n$$\\varepsilon(x) = C_{\\mu}^{3/4} \\frac{k(x)^{3/2}}{L}$$\nSubstituting this into the transport equation gives a separable ordinary differential equation for $k(x)$:\n$$U \\frac{dk}{dx} = -C_{\\mu}^{3/4} \\frac{k^{3/2}}{L}$$\n$$k^{-3/2} dk = -\\frac{C_{\\mu}^{3/4}}{UL} dx$$\nIntegrating from the inlet ($x=0$) to a downstream position $x$:\n$$\\int_{k(0)}^{k(x)} k'^{-3/2} dk' = -\\int_{0}^{x} \\frac{C_{\\mu}^{3/4}}{UL} dx'$$\n$$\\left[ -2k'^{-1/2} \\right]_{k(0)}^{k(x)} = -\\frac{C_{\\mu}^{3/4}}{UL} x$$\n$$-2(k(x)^{-1/2} - k(0)^{-1/2}) = -\\frac{C_{\\mu}^{3/4}}{UL} x$$\n$$k(x)^{-1/2} = k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4}}{2UL} x$$\nSolving for $k(x)$ yields the closed-form expression:\n$$k(x) = \\left( k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL} \\right)^{-2}$$\nNext, we find the eddy viscosity $\\nu_t(x)$. We use the $k-\\varepsilon$ model definition and the assumed relationship for $\\varepsilon(x)$:\n$$\\nu_t(x) = C_{\\mu} \\frac{k(x)^2}{\\varepsilon(x)} = C_{\\mu} \\frac{k(x)^2}{C_{\\mu}^{3/4} k(x)^{3/2}/L} = C_{\\mu}^{1/4} L k(x)^{1/2}$$\nSubstituting the expression for $k(x)^{1/2} = (k(x))^{-1/2 \\cdot (-1)} = (k(x)^{-1/2})^{-1}$:\n$$\\nu_t(x) = C_{\\mu}^{1/4} L \\left( k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL} \\right)^{-1}$$\n\n### Task 5: Sensitivity Analysis $S_{\\nu}(L;x^{\\ast})$\nThe dimensionless logarithmic sensitivity is defined as $S_{\\nu}(L;x^{\\ast}) \\equiv \\frac{\\partial \\ln \\nu_{t}(x^{\\ast})}{\\partial \\ln L}$. Using the chain rule, this is equivalent to $S_{\\nu}(L;x^{\\ast}) = L \\frac{\\partial \\ln \\nu_{t}(x^{\\ast})}{\\partial L}$.\nFirst, we take the natural logarithm of the expression for $\\nu_t(x)$:\n$$\\ln \\nu_t(x) = \\ln(C_{\\mu}^{1/4}) + \\ln(L) - \\ln\\left( k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL} \\right)$$\nNote that $k(0)$ depends on $I$ and $U$, not on $L$. Now, we differentiate with respect to $L$:\n$$\\frac{\\partial \\ln \\nu_t(x)}{\\partial L} = 0 + \\frac{1}{L} - \\frac{1}{k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL}} \\cdot \\frac{\\partial}{\\partial L}\\left( \\frac{C_{\\mu}^{3/4} x}{2U} L^{-1} \\right)$$\n$$\\frac{\\partial \\ln \\nu_t(x)}{\\partial L} = \\frac{1}{L} - \\frac{1}{k(0)^{-1/2} + \\frac{C_{\\mu}^{3/4} x}{2UL}} \\cdot \\left( -\\frac{C_{\\mu}^{3/4} x}{2UL^2} \\right)$$\n$$\\frac{\\partial \\ln \\nu_t(x)}{\\partial L} = \\frac{1}{L} + \\frac{C_{\\mu}^{3/4} x / (2UL^2)}{k(0)^{-1/2} + C_{\\mu}^{3/4} x / (2UL)}$$\nMultiplying by $L$ gives the sensitivity $S_{\\nu}$:\n$$S_{\\nu}(L;x) = L \\left( \\frac{1}{L} \\right) + \\frac{C_{\\mu}^{3/4} x / (2UL)}{k(0)^{-1/2} + C_{\\mu}^{3/4} x / (2UL)}$$\n$$S_{\\nu}(L;x) = 1 + \\frac{C_{\\mu}^{3/4} x / (2UL)}{k(0)^{-1/2} + C_{\\mu}^{3/4} x / (2UL)}$$\nNow, we compute the numerical value at $x^{\\ast} = 2\\,\\mathrm{m}$. First, we calculate the component terms:\nThe term $k(0)^{-1/2} = (1.5)^{-1/2} \\approx 0.816497\\,\\mathrm{s/m}$.\nThe term $\\frac{C_{\\mu}^{3/4} x^{\\ast}}{2UL} = \\frac{(0.09)^{3/4} \\times 2}{2 \\times 20 \\times 0.03} = \\frac{(0.09)^{3/4}}{0.6} \\approx \\frac{0.164317}{0.6} \\approx 0.273861\\,\\mathrm{s/m}$.\nSubstituting these values into the expression for $S_{\\nu}$:\n$$S_{\\nu}(L;x^{\\ast}) = 1 + \\frac{0.273861}{0.816497 + 0.273861} = 1 + \\frac{0.273861}{1.090358} \\approx 1 + 0.251165 \\approx 1.251165$$\nRounding to four significant figures, the sensitivity is $1.251$.",
            "answer": "$$\\boxed{1.251}$$"
        },
        {
            "introduction": "A key differentiator among two-equation models is how they calculate the eddy viscosity $\\nu_t$, especially in challenging flows. The Shear Stress Transport (SST) $k-\\omega$ model is renowned for its improved performance in flows with separation, an advantage stemming directly from its built-in shear stress limiter. This practice  allows you to computationally implement and contrast the baseline $k-\\omega$ eddy viscosity formulation with the SST-limited version, providing direct insight into how this limiter prevents the over-prediction of shear stress in separated flow regions.",
            "id": "3385353",
            "problem": "Consider the Reynolds-Averaged Navier–Stokes (RANS) equations and the Boussinesq hypothesis, which models the Reynolds stress tensor as proportional to the mean strain-rate tensor through a turbulent (eddy) viscosity. The Boussinesq relation states that the deviatoric part of the Reynolds stress tensor is $$\\tau_{ij}^{\\prime} = 2 \\rho \\nu_t S_{ij}$$, where $\\rho$ is the fluid density, $\\nu_t$ is the turbulent kinematic viscosity, and $S_{ij}$ is the mean strain-rate tensor. The scalar strain-rate magnitude is defined as $$S = \\sqrt{2 S_{ij} S_{ij}}$$, and the modeled shear stress magnitude is $$\\tau = 2 \\rho \\nu_t S.$$\n\nIn two-equation turbulence models, one solves transport equations for the turbulent kinetic energy $k$ and a second variable that determines a turbulence time scale (for example, the specific dissipation rate $\\omega$). In the standard $k-\\omega$ model, dimensional consistency and energy-budget arguments lead to an eddy-viscosity scaling relation that connects $k$ and $\\omega$ to $\\nu_t$. In the Shear Stress Transport (SST) model, a limiting mechanism is introduced to avoid excessive eddy viscosity in regions of strong shear or adverse pressure gradients, which is necessary for realistic prediction of separated flows. Away from walls, the SST limiter can be expressed in terms of the strain-rate magnitude, a positive coefficient $a_1$, and the specific dissipation rate $\\omega$.\n\nStarting from the Boussinesq hypothesis and the definitions above, you must derive the baseline eddy-viscosity relation in terms of $k$ and $\\omega$, and the SST-limited eddy-viscosity relation that uses the coefficient $a_1$ and the strain-rate magnitude $S$ when the near-wall blending function is unity. Then, using those relations, compute the modeled shear stress magnitude $\\tau$ field for given one-dimensional sampled fields $k(x)$, $\\omega(x)$, and $S(x)$ that represent a separated flow region. Assume constant density $\\rho$ and that the fields are sufficiently smooth and strictly nonnegative. Use $a_1 = 0.31$ and $\\rho = 1.225 \\,\\text{kg}/\\text{m}^3$.\n\nNumerical and output requirements:\n- Implement both eddy-viscosity formulations:\n  1. The baseline relation from the $k-\\omega$ model expressed in terms of $k$ and $\\omega$.\n  2. The Shear Stress Transport (SST) limited relation formed from $k$, $\\omega$, $S$, and $a_1$ in the limit where the SST blending function is unity away from walls.\n- For each test case, compute two modeled shear stress magnitude distributions:\n  1. Without the limiter (baseline).\n  2. With the SST limiter (away-from-wall form).\n- For each test case, report three quantities:\n  1. The mean modeled shear stress magnitude without the limiter, expressed in pascal (newton per square meter).\n  2. The mean modeled shear stress magnitude with the limiter, expressed in pascal (newton per square meter).\n  3. The fractional change in the mean (limited minus unlimited) divided by the unlimited mean, expressed as a decimal (not a percentage).\n- All shear stress values must be expressed in $\\text{Pa}$ and all angles, if any were used, must be expressed in radians. There are no angle inputs here.\n- Use an infinitesimal positive constant $\\varepsilon$ only to avoid division by zero in $\\omega$, ensuring physical consistency.\n\nTest suite:\n- Case 1 (high shear in separated shear layer, limiter active):\n  - $$k = [0.6,\\,0.8,\\,1.0,\\,1.1,\\,1.0,\\,0.9,\\,0.8,\\,0.7,\\,0.6,\\,0.5] \\,\\text{m}^2/\\text{s}^2,$$\n  - $$\\omega = [600,\\,550,\\,500,\\,450,\\,400,\\,350,\\,300,\\,250,\\,220,\\,200] \\,\\text{s}^{-1},$$\n  - $$S = [900,\\,800,\\,700,\\,600,\\,500,\\,400,\\,300,\\,250,\\,200,\\,150] \\,\\text{s}^{-1}.$$\n- Case 2 (recirculation core, low strain-rate, limiter mostly inactive):\n  - $$k = [0.4,\\,0.5,\\,0.6,\\,0.5,\\,0.4] \\,\\text{m}^2/\\text{s}^2,$$\n  - $$\\omega = [800,\\,900,\\,1000,\\,900,\\,800] \\,\\text{s}^{-1},$$\n  - $$S = [30,\\,25,\\,20,\\,25,\\,30] \\,\\text{s}^{-1}.$$\n- Case 3 (transitional shear near reattachment, limiter partially active):\n  - $$k = [0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.6,\\,0.5,\\,0.4] \\,\\text{m}^2/\\text{s}^2,$$\n  - $$\\omega = [200,\\,220,\\,240,\\,260,\\,280,\\,300,\\,320] \\,\\text{s}^{-1},$$\n  - $$S = [100,\\,110,\\,120,\\,130,\\,140,\\,150,\\,160] \\,\\text{s}^{-1}.$$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets. Each inner list must contain exactly three floats in the order specified above for the corresponding test case. For example: $$[[\\tau_{\\text{mean,unlimited}},\\tau_{\\text{mean,limited}},\\Delta],\\ldots].$$",
            "solution": "The problem requires the calculation of modeled turbulent shear stress magnitude using two different formulations for the turbulent (eddy) viscosity, $\\nu_t$, derived from two-equation turbulence models. The first is the baseline formulation from the standard $k$-$\\omega$ model, and the second is the limiter-enhanced formulation from the Shear Stress Transport (SST) $k$-$\\omega$ model.\n\nThe foundation for this analysis is the Boussinesq hypothesis, which relates the deviatoric part of the Reynolds stress tensor, $\\tau'_{ij}$, to the mean strain-rate tensor, $S_{ij}$, via the eddy viscosity, $\\nu_t$:\n$$ \\tau'_{ij} = 2 \\rho \\nu_t S_{ij} $$\nHere, $\\rho$ is the fluid density. The problem defines a scalar modeled shear stress magnitude, $\\tau$, based on this relationship and the scalar strain-rate magnitude, $S = \\sqrt{2 S_{ij} S_{ij}}$:\n$$ \\tau = 2 \\rho \\nu_t S $$\nThe core task is to define $\\nu_t$ according to the two specified turbulence models.\n\n### Step 1: Baseline Eddy Viscosity Formulation (Standard $k-\\omega$ Model)\n\nIn two-equation models, transport equations are solved for the turbulent kinetic energy, $k$, and a second variable that determines a turbulent time scale, $T_{turb}$. The specific dissipation rate, $\\omega$, is one such variable, representing the rate of dissipation of turbulence energy per unit energy, so $\\omega \\propto 1/T_{turb}$. The turbulent kinetic energy $k$ has dimensions of velocity squared, $[k] = L^2 T^{-2}$, and $\\omega$ has dimensions of frequency, $[\\omega] = T^{-1}$.\n\nThe turbulent kinematic viscosity, $\\nu_t$, must have dimensions of $L^2 T^{-1}$. By dimensional analysis, the simplest combination of $k$ and $\\omega$ that yields the correct units for $\\nu_t$ is their ratio:\n$$ [\\nu_t] = \\frac{[k]}{[\\omega]} = \\frac{L^2 T^{-2}}{T^{-1}} = L^2 T^{-1} $$\nBased on this dimensional reasoning, the standard $k-\\omega$ model, developed by Wilcox, defines the eddy viscosity as:\n$$ \\nu_{t, \\text{unlimited}} = \\frac{k}{\\omega} $$\nThis is the baseline, or unlimited, formulation. Substituting this into the equation for $\\tau$ gives the unlimited shear stress magnitude:\n$$ \\tau_{\\text{unlimited}} = 2 \\rho \\left( \\frac{k}{\\omega} \\right) S $$\nTo ensure numerical stability if $\\omega$ approaches zero, we compute this as $\\tau_{\\text{unlimited}} = 2 \\rho (k/(\\omega + \\varepsilon)) S$, where $\\varepsilon$ is a small positive constant.\n\n### Step 2: SST-Limited Eddy Viscosity Formulation\n\nA known issue with the standard $k-\\omega$ model is its tendency to over-predict shear stresses in regions with strong adverse pressure gradients or flow separation. The Shear Stress Transport (SST) model, developed by Menter, addresses this by introducing a limiter on the eddy viscosity. This limiter is motivated by Bradshaw's hypothesis, which observes that in many boundary layer flows, the magnitude of the turbulent shear stress is proportional to the turbulent kinetic energy, $|\\tau_{\\text{turb}}| \\approx \\rho a_1 k$, where $a_1$ is an empirical constant.\n\nBy combining this with the Boussinesq relation $\\tau \\approx \\rho \\nu_t S$, we can derive a limit on the eddy viscosity:\n$$ \\rho \\nu_t S \\le \\rho a_1 k \\implies \\nu_t \\le \\frac{a_1 k}{S} $$\nThe SST model incorporates this physical constraint by modifying the eddy viscosity definition. Away from the wall, where the model's second blending function $F_2$ is unity, the SST eddy viscosity is defined as:\n$$ \\nu_{t, \\text{limited}} = \\frac{a_1 k}{\\max(a_1 \\omega, S)} $$\nThis formulation elegantly switches between the standard $k-\\omega$ behavior and the shear stress limiter:\n- If $a_1 \\omega \\ge S$ (low-strain regions), then $\\max(a_1 \\omega, S) = a_1 \\omega$, and the expression reduces to $\\nu_{t, \\text{limited}} = \\frac{a_1 k}{a_1 \\omega} = \\frac{k}{\\omega}$. This recovers the baseline formulation.\n- If $S > a_1 \\omega$ (high-strain regions, e.g., separated shear layers), then $\\max(a_1 \\omega, S) = S$, and the expression becomes $\\nu_{t, \\text{limited}} = \\frac{a_1 k}{S}$. This imposes the Bradshaw-based limit on eddy viscosity.\n\nThis is equivalent to writing $\\nu_{t, \\text{limited}} = \\min(\\frac{k}{\\omega}, \\frac{a_1 k}{S})$. Substituting the SST formulation into the equation for $\\tau$ gives the limited shear stress magnitude:\n$$ \\tau_{\\text{limited}} = 2 \\rho \\left( \\frac{a_1 k}{\\max(a_1 \\omega, S)} \\right) S $$\n\n### Step 3: Computational Procedure\n\nFor each test case, we are given one-dimensional arrays for $k(x)$, $\\omega(x)$, and $S(x)$. The required outputs are calculated as follows:\n1.  For each point $x_i$ in the domain, compute $\\tau_{\\text{unlimited}}(x_i)$ and $\\tau_{\\text{limited}}(x_i)$ using the derived formulas, the given constants $\\rho = 1.225 \\,\\text{kg}/\\text{m}^3$ and $a_1 = 0.31$, and the data arrays.\n2.  Compute the mean of each shear stress distribution:\n    $$ \\bar{\\tau}_{\\text{unlimited}} = \\frac{1}{N} \\sum_{i=1}^{N} \\tau_{\\text{unlimited}}(x_i) $$\n    $$ \\bar{\\tau}_{\\text{limited}} = \\frac{1}{N} \\sum_{i=1}^{N} \\tau_{\\text{limited}}(x_i) $$\n3.  Compute the fractional change in the mean shear stress:\n    $$ \\Delta = \\frac{\\bar{\\tau}_{\\text{limited}} - \\bar{\\tau}_{\\text{unlimited}}}{\\bar{\\tau}_{\\text{unlimited}}} $$\nThese three values—$\\bar{\\tau}_{\\text{unlimited}}$, $\\bar{\\tau}_{\\text{limited}}$, and $\\Delta$—are computed for each provided test case.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes modeled shear stress magnitude based on baseline and SST-limited\n    k-omega turbulence model formulations.\n    \"\"\"\n    # Define physical and model constants\n    RHO = 1.225    # Fluid density in kg/m^3\n    A1 = 0.31      # SST model coefficient\n    EPSILON = 1e-12 # Small constant for numerical stability\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: High shear, limiter active\n        (\n            np.array([0.6, 0.8, 1.0, 1.1, 1.0, 0.9, 0.8, 0.7, 0.6, 0.5]), # k [m^2/s^2]\n            np.array([600, 550, 500, 450, 400, 350, 300, 250, 220, 200]), # omega [s^-1]\n            np.array([900, 800, 700, 600, 500, 400, 300, 250, 200, 150])  # S [s^-1]\n        ),\n        # Case 2: Recirculation core, low strain, limiter mostly inactive\n        (\n            np.array([0.4, 0.5, 0.6, 0.5, 0.4]), # k [m^2/s^2]\n            np.array([800, 900, 1000, 900, 800]), # omega [s^-1]\n            np.array([30, 25, 20, 25, 30])      # S [s^-1]\n        ),\n        # Case 3: Transitional shear, limiter partially active\n        (\n            np.array([0.2, 0.3, 0.4, 0.5, 0.6, 0.5, 0.4]), # k [m^2/s^2]\n            np.array([200, 220, 240, 260, 280, 300, 320]), # omega [s^-1]\n            np.array([100, 110, 120, 130, 140, 150, 160])  # S [s^-1]\n        )\n    ]\n\n    all_results = []\n    for k, omega, S in test_cases:\n        # 1. Unlimited (baseline k-omega) calculation\n        # The term (k / (omega + EPSILON)) represents the baseline eddy viscosity.\n        nu_t_unlimited = k / (omega + EPSILON)\n        tau_unlimited = 2 * RHO * nu_t_unlimited * S\n        mean_tau_unlimited = np.mean(tau_unlimited)\n\n        # 2. Limited (SST k-omega) calculation\n        # The term (A1 * k / max(A1*omega, S)) represents the SST-limited eddy viscosity.\n        sst_denominator = np.maximum(A1 * omega, S)\n        \n        # Initialize the limited eddy viscosity array and guard against division by zero.\n        nu_t_limited = np.zeros_like(k)\n        safe_indices = sst_denominator > EPSILON\n        \n        # Calculate limited eddy viscosity only for numerically safe indices.\n        if np.any(safe_indices):\n            nu_t_limited[safe_indices] = A1 * k[safe_indices] / sst_denominator[safe_indices]\n        \n        tau_limited = 2 * RHO * nu_t_limited * S\n        mean_tau_limited = np.mean(tau_limited)\n\n        # 3. Fractional change calculation\n        # Guard against division by zero if the unlimited mean is zero.\n        if abs(mean_tau_unlimited) > EPSILON:\n            frac_change = (mean_tau_limited - mean_tau_unlimited) / mean_tau_unlimited\n        else:\n            # If unlimited mean is zero, and limited mean is also zero, change is 0.\n            # Otherwise, the change is infinite (not expected in this problem).\n            frac_change = 0.0 if abs(mean_tau_limited)  EPSILON else np.inf\n\n        all_results.append([mean_tau_unlimited, mean_tau_limited, frac_change])\n\n    # Final print statement in the exact required format: [[...],[...],...]\n    # Using str().replace() ensures no spaces are present in the output.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "Modeling the near-wall region is one of the most critical aspects of practical turbulence modeling. This exercise  addresses the fundamental choice between resolving the boundary layer with a fine mesh (a low-Reynolds-number approach) and bridging it with semi-empirical formulas (a wall function approach). By calculating the dimensionless wall distance $y^+$ for the first grid cell, you will learn to make this crucial decision, which directly connects your meshing strategy to the underlying physics and assumptions of the turbulence model.",
            "id": "3385404",
            "problem": "A Reynolds-Averaged Navier–Stokes (RANS) simulation in Computational Fluid Dynamics (CFD) is to be performed for a turbulent, externally incompressible flow over a smooth flat plate. The near-wall resolution is planned using a two-equation turbulence model. The wall friction velocity is measured to be $u_{\\tau} = 0.42\\,\\mathrm{m/s}$, the distance from the wall to the center of the first cell is $\\Delta y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$, and the kinematic viscosity of the fluid is $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$. \n\nStarting from the definition of wall friction velocity and the viscous length scale used in inner scaling of wall-bounded turbulence, derive the dimensionless wall distance $y^{+}$ for the first cell and compute its value. Then, using physical reasoning based on the structure of the inner layer (viscous sublayer, buffer layer, and logarithmic region) and the near-wall modeling philosophy of two-equation turbulence models (such as the high-Reynolds-number $k-\\epsilon$ with wall functions and low-Reynolds-number variants or the Shear Stress Transport (SST) $k-\\omega$ model integrated to the wall), decide whether wall functions or low-Reynolds-number formulations should be used for the given mesh and justify the threshold choice between these treatments.\n\nExpress the final answer as a two-entry row matrix containing:\n- the computed value of $y^{+}$, rounded to three significant figures, and \n- an indicator $I$ where $I = 1$ denotes that wall functions should be used and $I = 0$ denotes that low-Reynolds-number formulations should be used.\n\nAll input values are given in International System of Units (SI), and $y^{+}$ and $I$ are dimensionless. No other outputs are required.",
            "solution": "The problem is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\nThe following data are provided in the problem statement:\n- Wall friction velocity: $u_{\\tau} = 0.42\\,\\mathrm{m/s}$\n- Distance from the wall to the center of the first cell: $\\Delta y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$\n- Kinematic viscosity of the fluid: $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n- The flow is a turbulent, externally incompressible flow over a smooth flat plate.\n- A two-equation turbulence model is to be used.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem uses standard concepts from computational fluid dynamics (CFD) and turbulence modeling, specifically Reynolds-Averaged Navier–Stokes (RANS) equations. The definitions of wall friction velocity ($u_{\\tau}$), dimensionless wall distance ($y^{+}$), wall functions, and low-Reynolds-number models are fundamental principles in this field. The given numerical values are physically realistic for air flow at standard conditions.\n2.  **Well-Posed:** The problem is clearly defined. It requests the calculation of a specific non-dimensional parameter, $y^{+}$, and a subsequent decision based on well-established criteria in CFD practice. The information provided is sufficient and consistent, leading to a unique and meaningful solution.\n3.  **Objective:** The language is technical and precise, free from any subjective or ambiguous statements.\n4.  **Completeness and Consistency:** The problem is self-contained and provides all necessary data for the required calculations and reasoning. There are no contradictions.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid as it is scientifically sound, well-posed, and complete. A full solution will be provided.\n\n### Solution Derivation\n\nThe problem requires a two-part answer: the calculation of the dimensionless wall distance $y^{+}$ and a decision on the appropriate near-wall modeling strategy.\n\n**Part 1: Derivation and Calculation of $y^{+}$**\n\nThe near-wall region of a turbulent boundary layer is characterized by scales derived from the wall shear stress, $\\tau_w$, the fluid density, $\\rho$, and the fluid kinematic viscosity, $\\nu$.\n\nThe wall friction velocity, $u_{\\tau}$, is defined as the velocity scale and is given by:\n$$\nu_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}\n$$\nWhile $\\tau_w$ and $\\rho$ are not given directly, $u_{\\tau}$ is provided, so this definition serves as the conceptual starting point.\n\nThe characteristic length scale in the near-wall region is the viscous length scale, $\\delta_{\\nu}$. It is defined as:\n$$\n\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}\n$$\nThis scale represents the approximate thickness where viscous effects are dominant.\n\nThe dimensionless wall distance, denoted as $y^{+}$, is the normal distance from the wall, $y$, non-dimensionalized by this viscous length scale:\n$$\ny^{+} = \\frac{y}{\\delta_{\\nu}}\n$$\nSubstituting the definition of $\\delta_{\\nu}$ into the expression for $y^{+}$ gives the formula for direct calculation:\n$$\ny^{+} = \\frac{y \\cdot u_{\\tau}}{\\nu}\n$$\nIn the context of a CFD mesh, the relevant distance $y$ is the distance from the wall to the center of the first computational cell, which is given as $\\Delta y$. Therefore, the $y^{+}$ for the first cell is:\n$$\ny^{+} = \\frac{\\Delta y \\cdot u_{\\tau}}{\\nu}\n$$\nNow, we substitute the given values into this equation:\n- $u_{\\tau} = 0.42\\,\\mathrm{m/s}$\n- $\\Delta y = 5.0 \\times 10^{-5}\\,\\mathrm{m}$\n- $\\nu = 1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}$\n\n$$\ny^{+} = \\frac{(5.0 \\times 10^{-5}\\,\\mathrm{m}) \\cdot (0.42\\,\\mathrm{m/s})}{1.5 \\times 10^{-5}\\,\\mathrm{m^2/s}}\n$$\nThe units cancel out, as expected for a dimensionless quantity: $(\\mathrm{m} \\cdot \\mathrm{m/s}) / (\\mathrm{m^2/s}) = \\mathrm{m^2/s} / \\mathrm{m^2/s}$.\n$$\ny^{+} = \\frac{5.0 \\times 0.42}{1.5} = \\frac{2.1}{1.5} = \\frac{21}{15} = \\frac{7}{5} = 1.4\n$$\nThe problem asks for the result to be rounded to three significant figures, so the value is $1.40$.\n\n**Part 2: Justification of Near-Wall Treatment**\n\nThe choice between using wall functions and a low-Reynolds-number formulation (i.e., integrating the model equations to the wall) depends critically on the $y^{+}$ value of the first cell center. This is because these two approaches are based on modeling different parts of the turbulent boundary layer's inner region. The inner region is broadly classified based on $y^{+}$:\n1.  **Viscous Sublayer ($y^{+} \\lesssim 5$):** Viscous shear stress is dominant. The non-dimensional velocity profile is linear, $u^{+} = y^{+}$, where $u^{+} = u/u_{\\tau}$.\n2.  **Buffer Layer ($5 \\lesssim y^{+} \\lesssim 30$):** Both viscous and turbulent (Reynolds) stresses are important. This region is complex and acts as a transition.\n3.  **Logarithmic Region ($y^{+} \\gtrsim 30$):** Turbulent shear stress is dominant. The velocity profile follows the logarithmic law, $u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + C$, where $\\kappa \\approx 0.41$ is the von Kármán constant and $C \\approx 5.2$ for a smooth wall.\n\nThe corresponding CFD modeling strategies are:\n- **Low-Reynolds-Number Formulations (or wall-resolving models like SST $k$-$\\omega$):** These models are designed to be valid throughout the inner layer, including the viscous sublayer. They resolve the steep gradients near the wall. For these models to be accurate, the mesh must be very fine, placing the center of the first cell deep within the viscous sublayer. The generally accepted criterion is $y^{+} \\approx 1$.\n- **Wall Functions (used with high-Reynolds-number models like standard $k$-$\\epsilon$):** This approach avoids resolving the viscous sublayer and buffer layer. It assumes that the first cell lies in the logarithmic region. The wall functions use the logarithmic law to \"bridge\" the region between the first cell center and the wall, providing boundary conditions for the mean flow and turbulence equations. This requires the first cell center to be located at $y^{+} > 30$. Placing the first cell in the buffer region ($5 \\lesssim y^{+} \\lesssim 30$) is highly discouraged as neither the linear profile nor the logarithmic law is valid, leading to significant modeling errors.\n\nIn this problem, the calculated dimensionless wall distance for the first cell is $y^{+} = 1.40$. This value falls squarely within the viscous sublayer ($1.40  5$). This mesh resolution is therefore appropriate for a low-Reynolds-number formulation that resolves the boundary layer all the way to the wall. It is entirely inappropriate for a wall function approach, which requires $y^{+} > 30$.\n\nTherefore, a low-Reynolds-number formulation should be used. The indicator $I$ is defined as $I=0$ for this choice.\n\nThe final answer consists of the computed value $y^{+} = 1.40$ and the indicator $I=0$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.40  0 \\end{pmatrix}}\n$$"
        }
    ]
}