{
    "hands_on_practices": [
        {
            "introduction": "多项式混沌方法的核心在于使用正交多项式作为随机空间的基函数。为了简化推导和计算，这些基函数相对于随机输入的概率测度必须是标准正交的。本练习将引导您完成为均匀分布的随机变量构建这样一个标准正交基的过程，这是应用多项式混沌展开的一项基本技能。",
            "id": "3392649",
            "problem": "考虑侵入式随机 Galerkin 方法，其中标量随机输入由一个均匀随机变量 $\\xi \\sim \\mathcal{U}(-1,1)$ 建模，其概率密度函数 (PDF) 在 $\\xi \\in [-1,1]$ 时为 $\\rho(\\xi)=\\frac{1}{2}$，否则为 $\\rho(\\xi)=0$。在 Galerkin 投影中，内积是关于 $\\rho$ 的期望 $\\mathbb{E}[\\cdot]$，因此对于任意平方可积函数 $f$ 和 $g$，内积定义为 $\\langle f, g \\rangle_{\\rho} := \\mathbb{E}[f(\\xi) g(\\xi)] = \\int_{-1}^{1} f(\\xi) g(\\xi) \\rho(\\xi) \\, \\mathrm{d}\\xi$。多项式基选自经典的 Legendre 多项式 $\\{P_n(\\xi)\\}_{n=0}^{\\infty}$，因为它们在 $[-1,1]$ 上的均匀权重下是正交的。在许多侵入式随机 Galerkin 格式中，例如基于广义多项式混沌 (gPC) 的格式，要求基在 $\\langle \\cdot, \\cdot \\rangle_{\\rho}$ 下是标准正交的，以获得简化的代数结构。\n\n从上述基本定义出发，确定归一化常数 $c_n$，使得缩放后的基函数 $\\Psi_n(\\xi) := c_n P_n(\\xi)$ 在 $L^{2}_{\\rho}([-1,1])$ 中形成一个标准正交系，即 $\\mathbb{E}[\\Psi_m(\\xi)\\Psi_n(\\xi)] = \\delta_{mn}$，其中 $\\delta_{mn}$ 表示 Kronecker delta。然后，使用相同的定义，验证期望值恒等式 $\\mathbb{E}[P_m(\\xi) P_n(\\xi)]$ 的闭式形式。您的最终答案必须是 $c_n$ 关于 $n$ 的闭式表达式；无需数值近似，也不涉及单位。",
            "solution": "目标是找到归一化常数 $c_n$，使得基函数 $\\Psi_n(\\xi) = c_n P_n(\\xi)$ 关于由期望算子 $\\mathbb{E}[\\cdot]$ 定义的内积是标准正交的。标准正交条件给出如下：\n$$\n\\mathbb{E}[\\Psi_m(\\xi)\\Psi_n(\\xi)] = \\delta_{mn}\n$$\n其中 $\\delta_{mn}$ 是 Kronecker delta，当 $m=n$ 时为 $1$，当 $m \\neq n$ 时为 $0$。\n\n将 $\\Psi_n(\\xi)$ 的定义代入该条件中，我们得到：\n$$\n\\mathbb{E}[ (c_m P_m(\\xi)) (c_n P_n(\\xi)) ] = \\delta_{mn}\n$$\n由于 $c_m$ 和 $c_n$ 是确定性常数，它们可以从期望中提出：\n$$\nc_m c_n \\mathbb{E}[P_m(\\xi) P_n(\\xi)] = \\delta_{mn}\n$$\n接下来，我们使用期望项 $\\mathbb{E}[P_m(\\xi) P_n(\\xi)]$ 在概率密度函数 $\\rho(\\xi)$ 方面的定义来计算它。随机变量 $\\xi$ 在 $[-1, 1]$ 上均匀分布，因此其 PDF 为 $\\rho(\\xi) = \\frac{1}{2}$ for $\\xi \\in [-1, 1]$。\n$$\n\\mathbb{E}[P_m(\\xi) P_n(\\xi)] = \\int_{-\\infty}^{\\infty} P_m(\\xi) P_n(\\xi) \\rho(\\xi) \\, \\mathrm{d}\\xi = \\int_{-1}^{1} P_m(\\xi) P_n(\\xi) \\left(\\frac{1}{2}\\right) \\, \\mathrm{d}\\xi\n$$\n提出常数 $\\frac{1}{2}$：\n$$\n\\mathbb{E}[P_m(\\xi) P_n(\\xi)] = \\frac{1}{2} \\int_{-1}^{1} P_m(\\xi) P_n(\\xi) \\, \\mathrm{d}\\xi\n$$\n该表达式构成了问题中要求的期望恒等式的验证。为以闭式形式计算它，我们使用 Legendre 多项式的标准正交性质，该性质表明：\n$$\n\\int_{-1}^{1} P_m(x) P_n(x) \\, \\mathrm{d}x = \\frac{2}{2n+1} \\delta_{mn}\n$$\n将这个已知结果代入我们的期望表达式中，得到闭式恒等式：\n$$\n\\mathbb{E}[P_m(\\xi) P_n(\\xi)] = \\frac{1}{2} \\left( \\frac{2}{2n+1} \\delta_{mn} \\right) = \\frac{1}{2n+1} \\delta_{mn}\n$$\n现在，我们将此结果代回缩放基 $\\Psi_n(\\xi)$ 的标准正交条件中：\n$$\nc_m c_n \\left( \\frac{1}{2n+1} \\delta_{mn} \\right) = \\delta_{mn}\n$$\n为了找到常数 $c_n$，我们考虑 $m = n$ 的情况。在这种情况下，$\\delta_{nn} = 1$：\n$$\nc_n c_n \\left( \\frac{1}{2n+1} \\delta_{nn} \\right) = \\delta_{nn} \\implies c_n^2 \\left( \\frac{1}{2n+1} \\right) = 1\n$$\n解出 $c_n^2$：\n$$\nc_n^2 = 2n+1\n$$\n按照惯例，归一化常数取正平方根。因此：\n$$\nc_n = \\sqrt{2n+1}\n$$\n对于 $m \\neq n$ 的情况，正交性质确保了 $\\delta_{mn} = 0$，导出恒等式 $0 = 0$，这是一致的。\n\n因此，标准正交基函数为 $\\Psi_n(\\xi) = \\sqrt{2n+1} P_n(\\xi)$。归一化常数 $c_n$ 仅取决于多项式的次数 $n$。",
            "answer": "$$\n\\boxed{\\sqrt{2n+1}}\n$$"
        },
        {
            "introduction": "在建立了标准正交基之后，我们可以将侵入式伽辽金方法应用于随机偏微分方程（PDE）。该方法将随机PDE投影到多项式基上，将其转化为一个关于混沌系数的、规模更大但确定性的耦合PDE系统。本练习将通过一个具有随机波速的波动方程来具体展示这一投影过程，让您亲手计算由此产生的“随机刚度矩阵”中的元素，从而理解物理参数中的不确定性是如何耦合各个混沌模式的演化的。",
            "id": "2448421",
            "problem": "考虑具有随机波速的一维波动方程\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t,\\xi) \\;=\\; c(\\xi)^{2}\\,\\frac{\\partial^{2} u}{\\partial x^{2}}(x,t,\\xi),\n$$\n其空间域为 $x\\in(0,L)$，时间域为 $t\\ge 0$，满足齐次狄利克雷边界条件 $u(0,t,\\xi)=0$ 和 $u(L,t,\\xi)=0$，以及初始条件 $u(x,0,\\xi)=u_{0}(x)$ 和 $\\frac{\\partial u}{\\partial t}(x,0,\\xi)=v_{0}(x)$，其中 $u_{0}$ 和 $v_{0}$ 是确定性函数。波速被建模为一个仿射随机场\n$$\nc(\\xi) \\;=\\; c_{0} \\,+\\, \\sigma\\,\\xi,\n$$\n其中 $c_{0}>0$, $\\sigma\\ge 0$，且 $\\xi$ 是一个标准正态随机变量，其概率密度为 $\\rho(\\xi)=\\frac{1}{\\sqrt{2\\pi}}\\exp(-\\xi^{2}/2)$。考虑在总阶数 $p=2$ 处截断的广义多项式混沌 (gPC) 展开，\n$$\nu(x,t,\\xi) \\;=\\; \\sum_{k=0}^{2} u_{k}(x,t)\\,\\psi_{k}(\\xi),\n$$\n其中 $\\{\\psi_{k}\\}_{k=0}^{2}$ 是在标准正态测度下定义的概率论中的标准正交埃尔米特基，定义如下\n$$\n\\psi_{0}(\\xi)=1,\\quad \\psi_{1}(\\xi)=\\xi,\\quad \\psi_{2}(\\xi)=\\frac{\\xi^{2}-1}{\\sqrt{2}},\n$$\n内积定义为 $\\langle f,g\\rangle = \\int_{\\mathbb{R}} f(\\xi)\\,g(\\xi)\\,\\rho(\\xi)\\,d\\xi$。\n\n通过强制残差与随机基 $\\{\\psi_{i}\\}_{i=0}^{2}$ 正交，建立控制确定性系数场 $\\{u_{k}(x,t)\\}_{k=0}^{2}$ 的侵入式伽辽金系统。令随机耦合矩阵的元素为\n$$\nA_{ij} \\;=\\; \\int_{\\mathbb{R}} c(\\xi)^{2}\\,\\psi_{i}(\\xi)\\,\\psi_{j}(\\xi)\\,\\rho(\\xi)\\,d\\xi \\;=\\; \\mathbb{E}\\big[c(\\xi)^{2}\\,\\psi_{i}(\\xi)\\,\\psi_{j}(\\xi)\\big],\\quad i,j\\in\\{0,1,2\\}。\n$$\n\n请为矩阵元素 $A_{11}$ 提供一个单一的闭式解析表达式。您的最终答案必须是一个单一的解析表达式。不包含单位。不要四舍五入。",
            "solution": "目标是计算随机耦合矩阵 $A$ 的矩阵元素 $A_{11}$。根据定义，对于 $i,j \\in \\{0, 1, 2\\}$，矩阵元素由下式给出：\n$$\nA_{ij} = \\mathbb{E}\\big[c(\\xi)^{2}\\,\\psi_{i}(\\xi)\\,\\psi_{j}(\\xi)\\big]\n$$\n我们需要找到特定的元素 $A_{11}$，这对应于设置 $i=1$ 和 $j=1$：\n$$\nA_{11} = \\mathbb{E}\\big[c(\\xi)^{2}\\,\\psi_{1}(\\xi)\\,\\psi_{1}(\\xi)\\big] = \\mathbb{E}\\big[c(\\xi)^{2}\\,(\\psi_{1}(\\xi))^{2}\\big]\n$$\n问题给出了随机波速 $c(\\xi)$ 和基函数 $\\psi_{1}(\\xi)$ 的表达式：\n$$\nc(\\xi) = c_{0} + \\sigma\\,\\xi\n$$\n$$\n\\psi_{1}(\\xi) = \\xi\n$$\n将这些表达式代入 $A_{11}$ 的公式中得到：\n$$\nA_{11} = \\mathbb{E}\\big[(c_{0} + \\sigma\\,\\xi)^{2}\\,\\xi^{2}\\big]\n$$\n我们展开平方项 $(c_{0} + \\sigma\\,\\xi)^{2}$：\n$$\n(c_{0} + \\sigma\\,\\xi)^{2} = c_{0}^{2} + 2c_{0}\\sigma\\xi + \\sigma^{2}\\xi^{2}\n$$\n$A_{11}$ 的表达式变为：\n$$\nA_{11} = \\mathbb{E}\\big[(c_{0}^{2} + 2c_{0}\\sigma\\xi + \\sigma^{2}\\xi^{2})\\,\\xi^{2}\\big]\n$$\n将 $\\xi^{2}$ 项分配到期望内部得到：\n$$\nA_{11} = \\mathbb{E}\\big[c_{0}^{2}\\xi^{2} + 2c_{0}\\sigma\\xi^{3} + \\sigma^{2}\\xi^{4}\\big]\n$$\n根据期望算子的线性性质，我们可以写出：\n$$\nA_{11} = \\mathbb{E}[c_{0}^{2}\\xi^{2}] + \\mathbb{E}[2c_{0}\\sigma\\xi^{3}] + \\mathbb{E}[\\sigma^{2}\\xi^{4}]\n$$\n常数 $c_{0}$ 和 $\\sigma$ 可以从期望中提取出来：\n$$\nA_{11} = c_{0}^{2}\\,\\mathbb{E}[\\xi^{2}] + 2c_{0}\\sigma\\,\\mathbb{E}[\\xi^{3}] + \\sigma^{2}\\,\\mathbb{E}[\\xi^{4}]\n$$\n为了计算这个表达式，我们必须计算标准正态随机变量 $\\xi \\sim \\mathcal{N}(0,1)$ 的矩。均值为 $\\mu$、标准差为 $\\varsigma$ 的高斯分布的 $n$ 阶中心矩是 $\\mathbb{E}[(\\xi - \\mu)^n]$。对于标准正态分布，$\\mu=0$ 且 $\\varsigma=1$，因此中心矩就是原始矩 $\\mathbb{E}[\\xi^{n}]$。\n这些矩由以下公式给出：\n- 对于所有奇数 $n$，$\\mathbb{E}[\\xi^{n}] = 0$。\n- 对于所有偶数 $n$，$\\mathbb{E}[\\xi^{n}] = (n-1)!! = (n-1)(n-3)\\cdots 1$。\n\n使用这些性质，我们求出所需的矩：\n- 二阶矩（方差）：$\\mathbb{E}[\\xi^{2}] = (2-1)!! = 1$。\n- 三阶矩（偏度为零）：$\\mathbb{E}[\\xi^{3}] = 0$。\n- 四阶矩（与峰度有关）：$\\mathbb{E}[\\xi^{4}] = (4-1)!! = 3 \\cdot 1 = 3$。\n\n将这些矩的值代回 $A_{11}$ 的表达式中：\n$$\nA_{11} = c_{0}^{2}(1) + 2c_{0}\\sigma(0) + \\sigma^{2}(3)\n$$\n简化此表达式可得到最终结果：\n$$\nA_{11} = c_{0}^{2} + 3\\sigma^{2}\n$$\n这就是随机耦合矩阵元素 $A_{11}$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{c_{0}^{2} + 3\\sigma^{2}}\n$$"
        },
        {
            "introduction": "现在，我们将分析扩展到非线性偏微分方程，这在流体力学中很常见，但给多项式混沌方法带来了新的挑战。本练习以无粘性伯格斯方程为例，其非线性通量项会在伽辽金投影后产生一个“三阶积”张量，导致混沌模式之间的三次耦合。更重要的是，当解中形成激波时，多项式展开会丧失其谱收敛性。这项高级实践将首先要求您推导非线性伯格斯方程的伽辽金系统，然后通过数值方法研究激波形成导致的谱收敛性破坏，这是将多项式混沌方法应用于双曲守恒律时必须理解的关键现象。",
            "id": "3337860",
            "problem": "考虑在一个空间周期域上的具有凸二次通量的一维无粘性伯格斯方程，\n$$u_t + \\left(\\tfrac{1}{2} u^2\\right)_x = 0,$$\n该方程针对 $x \\in [0,1]$ 设定，具有周期性边界条件和无量纲变量。初始条件不确定，由下式给出\n$$u(x,0,\\xi) = A(\\xi)\\sin(2\\pi x),$$\n其中 $\\xi \\in [-1,1]$ 是一个概率密度为 $ \\rho(\\xi) = \\tfrac{1}{2}$ 的均匀随机变量，随机振幅为\n$$A(\\xi) = A_0 + A_1 \\xi,$$\n其中 $A_0$ 和 $A_1$ 是确定性常数。使用在 $[-1,1]$ 上权重为 $\\rho(\\xi)$ 的正交勒让德多项式 $\\{\\phi_n(\\xi)\\}_{n=0}^P$ 作为广义多项式混沌 (gPC) 基，展开 $u(x,t,\\xi)$，使得\n$$\\int_{-1}^1 \\phi_m(\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,d\\xi = \\delta_{mn},$$\n并写作\n$$u(x,t,\\xi) = \\sum_{n=0}^P u_n(x,t)\\,\\phi_n(\\xi).$$\n通过将伯格斯方程在每个基函数 $\\phi_k(\\xi)$ 上进行随机伽辽金 (SG) 投影，推导混沌系数 $\\{u_k(x,t)\\}_{k=0}^P$ 的守恒形式的耦合确定性偏微分方程组。特别地，通过三重积系数表示非线性通量耦合\n$$C_{kmn} = \\int_{-1}^1 \\phi_k(\\xi)\\phi_m(\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,d\\xi,$$\n并证明 SG 系统可以写为\n$$\\partial_t u_k(x,t) + \\partial_x\\left(\\tfrac{1}{2}\\sum_{m=0}^P\\sum_{n=0}^P u_m(x,t)u_n(x,t)\\,C_{kmn}\\right) = 0,\\quad k=0,1,\\dots,P.$$\n接下来，分析混沌基中关于随机激波形成的谱收敛性。对于无粘性伯格斯方程，激波形成时间取决于初始斜率，因此也取决于随机振幅 $A(\\xi)$。固定一个空间点 $x_* \\in [0,1]$ 并考虑时间 $t>0$。定义逐点混沌系数\n$$u_n(x_*,t) = \\int_{-1}^1 u(x_*,t,\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,d\\xi.$$\n当 $t$ 严格小于在 $\\xi \\in [-1,1]$ 上的最小激波时间时，映射 $\\xi \\mapsto u(x_*,t,\\xi)$ 是光滑的，系数 $\\{u_n(x_*,t)\\}$ 应随 $n$ 快速衰减。当 $t$ 超过 $\\xi$ 的部分支撑域的激波时间时，由于熵激波在依赖于 $\\xi$ 的时间穿过 $x_*$，$\\xi \\mapsto u(x_*,t,\\xi)$ 的依赖关系可能变得不光滑，系数衰减会显著减慢。\n\n实现一个程序来完成以下任务：\n- 构建在 $[-1,1]$ 上关于 $\\rho(\\xi)=\\tfrac{1}{2}$ 的正交勒让德 gPC 基函数 $\\{\\phi_n(\\xi)\\}_{n=0}^P$。\n- 通过在 $\\xi \\in [-1,1]$ 上进行数值积分来计算三重积系数 $C_{kmn}$。\n- 对于物理的解 $u(x,t,\\xi)$，避免求解 SG 系统，而是通过 Lax–Oleinik 变分原理计算无粘性伯格斯方程的精确熵解。定义初始条件的原函数\n$$G(y;\\xi) = \\int_0^y A(\\xi)\\sin(2\\pi s)\\,ds = -\\frac{A(\\xi)}{2\\pi}\\cos(2\\pi y) + \\frac{A(\\xi)}{2\\pi},$$\n并对于固定的 $x_*$ 和 $t>0$，通过下式计算在 $x_*$ 处的熵解\n$$u(x_*,t,\\xi) = \\frac{x_* - y^*(x_*,t;\\xi)}{t},$$\n其中 $y^*(x_*,t;\\xi)$ 是使下式最小化的值\n$$h(y;x_*,t;\\xi) = G(y;\\xi) + \\frac{(x_* - y)^2}{2t}, \\quad y \\in [0,1],$$\n在一个周期内。对于 $t=0$，使用 $u(x_*,0,\\xi) = A(\\xi)\\sin(2\\pi x_*)$。\n- 通过在 $\\xi$ 上进行数值积分，将 $u(x_*,t,\\xi)$ 投影到 gPC 基上，以获得 $\\{u_n(x_*,t)\\}_{n=0}^P$。\n\n为量化谱收敛性，定义阶数 $n \\in \\{P_{\\mathrm{low}},\\dots,P_{\\mathrm{high}}\\}$ 的尾部能量，\n$$E_{\\mathrm{tail}}(t;P_{\\mathrm{low}},P_{\\mathrm{high}}) = \\sum_{n=P_{\\mathrm{low}}}^{P_{\\mathrm{high}}} \\left|u_n(x_*,t)\\right|.$$\n使用以下无量纲参数的测试套件：\n- 基和积分：\n  - 使用正交勒让德多项式，即 $\\phi_n(\\xi) = \\sqrt{2n+1}P_n(\\xi)$，其中 $P_n(\\xi)$ 是第 $n$ 个勒让德多项式。\n  - 在 $\\xi$ 上使用 $Q_\\xi = 101$ 点的高斯-勒让德积分，权重按 $\\rho(\\xi)=\\tfrac{1}{2}$ 进行缩放。\n- 物理和随机参数：\n  - $A_0 = 1.0$, $A_1 = 0.5$。\n  - $x_* = 0.3$。\n  - 考虑时间 $t \\in \\{0.0,\\,0.05,\\,0.12,\\,0.35\\}$。\n- 投影和尾部测量：\n  - 使用最大混沌阶数 $P_{\\mathrm{high}} = 20$ 和 $P_{\\mathrm{low}} = 10$。\n  - 对于 Lax–Oleinik 最小化问题，使用 $N_y = 1024$ 个等距点对 $y \\in [0,1]$ 进行离散化。\n\n您的程序必须按照列出的顺序，在指定的时间计算 $E_{\\mathrm{tail}}(t;10,20)$。所有量都是无量纲的。您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 $[r_1,r_2,r_3,r_4]$）。每个 $r_i$ 必须是一个浮点数，代表相应测试用例的 $E_{\\mathrm{tail}}(t_i;10,20)$。数值方法必须稳健，并与所述的物理模型和投影在科学上保持一致；结果必须按照所述的第一性原理获得，不得使用启发式捷径。",
            "solution": "该问题要求为具有不确定初始条件的一维无粘性伯格斯方程推导随机伽辽金 (SG) 系统，然后对其广义多项式混沌 (gPC) 展开的谱收敛性进行数值分析。分析的重点是在物理的解中形成激波时 gPC 系数的行为。\n\n控制方程是无粘性伯格斯方程：\n$$\n\\partial_t u + \\partial_x \\left(\\frac{1}{2} u^2\\right) = 0\n$$\n在域 $x \\in [0,1]$ 上，具有周期性边界条件。不确定性通过初始条件引入：\n$$\nu(x,0,\\xi) = A(\\xi)\\sin(2\\pi x)\n$$\n其中 $\\xi$ 是在 $[-1,1]$ 上均匀分布的随机变量，其概率密度函数 (PDF) 为 $\\rho(\\xi) = 1/2$。振幅 $A(\\xi) = A_0 + A_1 \\xi$ 是 $\\xi$ 的线性函数。\n\n解 $u(x,t,\\xi)$ 在一个使用正交勒让德多项式 $\\{\\phi_n(\\xi)\\}_{n=0}^P$ 的 gPC 基中展开。这些基函数相对于由 PDF $\\rho(\\xi)$ 加权的内积是正交的：\n$$\n\\langle \\phi_m, \\phi_n \\rangle_{\\rho} = \\int_{-1}^1 \\phi_m(\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,d\\xi = \\delta_{mn}\n$$\n解的 gPC 展开为：\n$$\nu(x,t,\\xi) = \\sum_{n=0}^P u_n(x,t)\\,\\phi_n(\\xi)\n$$\n其中 $u_n(x,t)$ 是确定性的混沌系数。\n\n首先，我们按要求推导 SG 系统。我们将 gPC 展开代入伯格斯方程：\n$$\n\\partial_t \\left(\\sum_{n=0}^P u_n \\phi_n\\right) + \\partial_x \\left[\\frac{1}{2} \\left(\\sum_{n=0}^P u_n \\phi_n\\right)^2\\right] = 0\n$$\n由于基函数 $\\phi_n(\\xi)$ 与 $x$ 和 $t$ 无关，导数可以移到求和号内部：\n$$\n\\sum_{n=0}^P (\\partial_t u_n) \\phi_n + \\partial_x \\left[\\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n \\phi_m \\phi_n\\right] = 0\n$$\n此方程表示 PDE 在 gPC 基中的残差。随机伽辽金方法将此残差投影到每个基函数 $\\phi_k(\\xi)$ 上，其中 $k=0,1,\\dots,P$。投影是通过取内积 $\\langle \\cdot, \\phi_k \\rangle_{\\rho}$ 定义的：\n$$\n\\left\\langle \\sum_{n=0}^P (\\partial_t u_n) \\phi_n, \\phi_k \\right\\rangle_{\\rho} + \\left\\langle \\partial_x \\left[\\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n \\phi_m \\phi_n\\right], \\phi_k \\right\\rangle_{\\rho} = 0\n$$\n对于线性项，我们利用内积的线性和基的正交性：\n$$\n\\sum_{n=0}^P (\\partial_t u_n) \\langle \\phi_n, \\phi_k \\rangle_{\\rho} = \\sum_{n=0}^P (\\partial_t u_n) \\delta_{nk} = \\partial_t u_k\n$$\n对于非线性通量项，空间导数 $\\partial_x$ 可以移到积分算子之外，因为它作用于与 $\\xi$ 无关的变量：\n$$\n\\partial_x \\left\\langle \\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n \\phi_m \\phi_n, \\phi_k \\right\\rangle_{\\rho} = \\partial_x \\left[\\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n \\int_{-1}^1 \\phi_k(\\xi)\\phi_m(\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,d\\xi\\right]\n$$\n该积分是三重积系数 $C_{kmn}$。代入此定义，非线性项变为：\n$$\n\\partial_x \\left(\\frac{1}{2} \\sum_{m=0}^P \\sum_{n=0}^P u_m u_n C_{kmn}\\right)\n$$\n结合投影后的各项，我们得到混沌系数 $\\{u_k(x,t)\\}$ 的耦合确定性 PDE 系统，正如所要求：\n$$\n\\partial_t u_k(x,t) + \\partial_x\\left(\\frac{1}{2}\\sum_{m=0}^P\\sum_{n=0}^P u_m(x,t)u_n(x,t)\\,C_{kmn}\\right) = 0, \\quad k=0,1,\\dots,P\n$$\n这完成了理论推导。\n\n数值任务是分析 gPC 展开的谱收敛性。我们不需数值求解复杂的 SG 系统，而是被要求为每个 $\\xi$ 的实现计算伯格斯方程的精确熵解，然后将此解投影到 gPC 基上。这种非侵入式方法可以准确评估系数的衰减情况。\n\n熵解使用 Lax–Oleinik 变分原理找到。对于给定的空间点 $x_*$ 和时间 $t>0$，解 $u(x_*, t, \\xi)$ 由下式给出：\n$$\nu(x_*,t,\\xi) = \\frac{x_* - y^*(x_*,t;\\xi)}{t}\n$$\n其中 $y^*(x_*,t;\\xi)$ 是使函数最小化的 $y \\in [0,1]$ 的值：\n$$\nh(y;x_*,t;\\xi) = G(y;\\xi) + \\frac{(x_* - y)^2}{2t}\n$$\n这里，$G(y;\\xi)$ 是初始速度分布 $u(y,0,\\xi)$ 的原函数：\n$$\nG(y;\\xi) = \\int_0^y u(s,0,\\xi)\\,ds = \\int_0^y A(\\xi)\\sin(2\\pi s)\\,ds = -\\frac{A(\\xi)}{2\\pi}\\cos(2\\pi y) + \\frac{A(\\xi)}{2\\pi}\n$$\n对于固定的 $\\xi$、$x_*$ 和 $t$，通过在周期域 $[0,1]$ 中离散化的 $y$ 值网格上进行数值最小化来找到 $y^*$ 的值。对于 $t=0$ 的特殊情况，解就是初始条件在 $x_*$ 处的值。\n\n一旦解 $u(x_*, t, \\xi)$ 作为 $\\xi$ 的函数已知，gPC 系数 $u_n(x_*, t)$ 通过投影计算得出：\n$$\nu_n(x_*,t) = \\langle u(x_*,t,\\xi), \\phi_n(\\xi) \\rangle_{\\rho} = \\int_{-1}^1 u(x_*,t,\\xi)\\phi_n(\\xi)\\rho(\\xi)\\,d\\xi\n$$\n该积分使用高斯-勒让德积分进行数值计算。对于权重 $\\rho(\\xi)=1/2$ 的正交勒让德多项式是 $\\phi_n(\\xi) = \\sqrt{2n+1}P_n(\\xi)$，其中 $P_n$ 是标准的第 $n$ 阶勒让德多项式。\n\n最后，为了量化谱收敛性，计算尾部能量 $E_{\\mathrm{tail}}$：\n$$\nE_{\\mathrm{tail}}(t;P_{\\mathrm{low}},P_{\\mathrm{high}}) = \\sum_{n=P_{\\mathrm{low}}}^{P_{\\mathrm{high}}} \\left|u_n(x_*,t)\\right|\n$$\n这衡量了展开中高阶模态所含的能量。对于 $\\xi$ 的光滑函数，系数 $u_n$ 快速衰减，$E_{\\mathrm{tail}}$ 很小。当激波形成时，解 $u(x_*,t,\\xi)$ 对 $\\xi$ 的依赖性变得不光滑，导致系数衰减变慢，而 $E_{\\mathrm{tail}}$ 变大。实现将按照指定参数执行这些步骤。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import legendre\n\ndef solve():\n    \"\"\"\n    Computes the tail energy of a gPC expansion for the 1D inviscid Burgers\n    equation with an uncertain initial condition at specified times.\n    \"\"\"\n    # Problem Parameters\n    A0 = 1.0\n    A1 = 0.5\n    x_star = 0.3\n    times_to_test = [0.0, 0.05, 0.12, 0.35]\n    P_low = 10\n    P_high = 20\n    P = P_high  # Maximum chaos order\n    \n    # Numerical Method Parameters\n    Q_xi = 101  # Number of quadrature points for xi\n    N_y = 1024  # Number of grid points for y minimization\n\n    # --- Pre-computation Step ---\n\n    # 1. Orthonormal Legendre basis functions phi_n(xi) = sqrt(2n+1) * P_n(xi)\n    # P_n(xi) are standard Legendre polynomials.\n    # Pre-generate callable polynomial objects for efficiency.\n    legendre_polys = [legendre(n) for n in range(P + 1)]\n    def evaluate_phi_n(n, xi_values):\n        return np.sqrt(2 * n + 1) * legendre_polys[n](xi_values)\n\n    # 2. Gauss-Legendre quadrature for integrals over xi in [-1, 1]\n    # The integral to compute is integral(f(xi) * rho(xi) * dxi) where rho(xi) = 1/2.\n    # The standard quadrature approximates integral(g(xi) * dxi).\n    # So, we use g(xi) = f(xi)/2. The weights must be scaled by 1/2.\n    xi_q, w_q_std = np.polynomial.legendre.leggauss(Q_xi)\n    quad_weights = w_q_std / 2.0\n\n    # 3. Pre-evaluate basis functions at all quadrature points\n    phi_at_quad_points = np.zeros((P + 1, Q_xi))\n    for n in range(P + 1):\n        phi_at_quad_points[n, :] = evaluate_phi_n(n, xi_q)\n\n    # 4. Discretization grid for the minimization problem in y\n    y_grid = np.linspace(0, 1, N_y)\n\n    # --- Helper functions for the Lax-Oleinik solution ---\n    \n    def get_amplitude(xi):\n        return A0 + A1 * xi\n\n    def G_potential(y, xi_val):\n        \"\"\"Primitive of the initial condition.\"\"\"\n        A_val = get_amplitude(xi_val)\n        return -A_val / (2 * np.pi) * (np.cos(2 * np.pi * y) - 1.0)\n\n    def h_function(y, t, xi_val):\n        \"\"\"Function to be minimized for the Lax-Oleinik solution.\"\"\"\n        return G_potential(y, xi_val) + (x_star - y)**2 / (2 * t)\n\n    # --- Main computation loop ---\n\n    results = []\n    \n    for t in times_to_test:\n        # Array to store the solution u(x_star, t, xi) at each quadrature point\n        u_at_quad_points = np.zeros(Q_xi)\n\n        if t == 0.0:\n            # For t=0, the solution is the initial condition\n            A_vals = get_amplitude(xi_q)\n            u_at_quad_points = A_vals * np.sin(2 * np.pi * x_star)\n        else:\n            # For t>0, use the Lax-Oleinik formula\n            for i, xi_val in enumerate(xi_q):\n                # Evaluate h over the y_grid for the current xi_val\n                h_vals_at_y = h_function(y_grid, t, xi_val)\n                \n                # Find the y that minimizes h\n                min_idx = np.argmin(h_vals_at_y)\n                y_star = y_grid[min_idx]\n                \n                # Compute the solution u\n                u_at_quad_points[i] = (x_star - y_star) / t\n\n        # Project u(x_star, t, xi) onto the gPC basis to find coefficients u_n\n        # u_n = integral( u(xi) * phi_n(xi) * rho(xi) dxi )\n        # Numerically: u_n = sum over q of ( u(xi_q) * phi_n(xi_q) * w_q' )\n        # Vectorized computation for all coefficients u_0, ..., u_P\n        u_coeffs = phi_at_quad_points @ (u_at_quad_points * quad_weights)\n        \n        # Calculate the tail energy\n        tail_energy = np.sum(np.abs(u_coeffs[P_low : P_high + 1]))\n        results.append(tail_energy)\n    \n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}