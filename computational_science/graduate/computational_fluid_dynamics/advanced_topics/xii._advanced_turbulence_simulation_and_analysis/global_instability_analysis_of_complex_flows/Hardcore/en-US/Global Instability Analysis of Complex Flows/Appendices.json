{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of global instability analysis is the formulation of a well-posed eigenvalue problem from the governing equations. This first exercise  uses the canonical complex Ginzburg-Landau equation to walk through this fundamental process step-by-step. You will practice applying the normal-mode ansatz and specifying appropriate boundary conditions for an open flow, which are crucial for isolating instabilities generated within the domain. Furthermore, this problem details a robust numerical strategy, providing a complete roadmap from a partial differential equation to a discrete matrix problem ready for computational solution.",
            "id": "3323898",
            "problem": "Consider the linear complex Ginzburg–Landau equation, a canonical model for global instabilities in slowly varying convective–diffusive systems: $\\partial_t q = \\mu(x) q + U \\,\\partial_x q + D \\,\\partial_{xx} q$ on a finite interval $x \\in [0,L]$, where $q(x,t) \\in \\mathbb{C}$ is the complex amplitude, $\\mu(x) \\in \\mathbb{C}$ is a prescribed spatially varying coefficient, $U \\in \\mathbb{R}$ is a constant advection speed, and $D \\in \\mathbb{C}$ is a constant complex diffusion coefficient with $\\mathrm{Re}(D)  0$ to ensure parabolic well-posedness. Assume $U  0$ so that $x=0$ is the upstream (inflow) boundary and $x=L$ is the downstream (outflow) boundary. In global instability analysis, one seeks temporal growth rates and spatial structures of global modes by formulating a linear eigenvalue problem for the operator governing the right-hand side.\n\nWhich option correctly sets up the global eigenvalue problem on $[0,L]$, specifies physically appropriate inflow/outflow boundary conditions for this second-order spatial operator, and outlines a scientifically sound spectral collocation solution strategy using Chebyshev polynomials, including the proper domain mapping and differentiation scaling?\n\nA. Use the temporal normal-mode ansatz $q(x,t) = \\hat{q}(x)\\, \\exp(\\lambda t)$ to obtain the eigenvalue problem $\\lambda \\,\\hat{q}(x) = \\mu(x)\\,\\hat{q}(x) + U\\,\\partial_x \\hat{q}(x) + D\\,\\partial_{xx} \\hat{q}(x)$ on $x \\in [0,L]$, with upstream inflow boundary condition $\\hat{q}(0) = 0$ and downstream outflow boundary condition $\\partial_x \\hat{q}(L) = 0$ (a homogeneous radiation-type condition for convective outflow). Discretize $\\hat{q}(x)$ by spectral collocation on Chebyshev–Gauss–Lobatto (CGL) points after mapping $x = \\frac{L}{2}(1+\\xi)$ from $\\xi \\in [-1,1]$, so that $\\partial_x = \\frac{2}{L}\\,\\partial_\\xi$ and $\\partial_{xx} = \\left(\\frac{2}{L}\\right)^2 \\partial_{\\xi\\xi}$. Form the discrete operator $\\mathbf{L} = \\mathrm{diag}(\\mu(x_j)) + U\\,\\frac{2}{L}\\,\\mathbf{D}_\\xi + D\\,\\left(\\frac{2}{L}\\right)^2 \\mathbf{D}_\\xi^{(2)}$, enforce the two boundary conditions by replacing the corresponding rows to impose $\\hat{q}(0)=0$ and $\\partial_x \\hat{q}(L)=0$, and solve the standard eigenvalue problem $\\mathbf{L}\\,\\hat{\\mathbf{q}} = \\lambda\\,\\hat{\\mathbf{q}}$ for $\\lambda \\in \\mathbb{C}$ and the global mode $\\hat{\\mathbf{q}}$.\n\nB. Impose periodic boundary conditions $\\hat{q}(0) = \\hat{q}(L)$ and $\\partial_x \\hat{q}(0) = \\partial_x \\hat{q}(L)$ to emulate a domain without boundaries, and discretize by a Fourier spectral method on a uniform grid. Build a generalized eigenvalue problem $\\mathbf{M}\\,\\lambda\\,\\hat{\\mathbf{q}} = \\mathbf{L}\\,\\hat{\\mathbf{q}}$ with a mass matrix $\\mathbf{M}$ obtained from trapezoidal-rule quadrature weights, and compute $\\lambda$ and $\\hat{\\mathbf{q}}$.\n\nC. Use the temporal normal-mode ansatz to derive $\\lambda \\,\\hat{q}(x) = \\mu(x)\\,\\hat{q}(x) + U\\,\\partial_x \\hat{q}(x) + D\\,\\partial_{xx} \\hat{q}(x)$, enforce both boundary conditions at the inflow: $\\hat{q}(0) = 0$ and $\\partial_x \\hat{q}(0) = 0$ (since inflow requires strict control), leave the outflow unconstrained, and discretize with Chebyshev–Gauss–Lobatto points on $\\xi \\in [-1,1]$ using the unscaled differentiation matrices $\\mathbf{D}_\\xi$ and $\\mathbf{D}_\\xi^{(2)}$ directly on $x \\in [0,L]$ without mapping or derivative rescaling. Solve $\\mathbf{L}\\,\\hat{\\mathbf{q}} = \\lambda\\,\\hat{\\mathbf{q}}$.\n\nD. Set homogeneous Dirichlet boundary conditions at both ends, $\\hat{q}(0) = 0$ and $\\hat{q}(L) = 0$, to avoid numerical reflections, and discretize with Chebyshev polynomials constructed directly on $[0,L]$ by evaluating the Chebyshev differentiation matrices at the physical nodes $x_j = L\\,\\cos(\\pi j/N)$ for $j \\in \\{0,\\dots, N\\}$, forming a generalized eigenvalue problem $\\mathbf{M}\\,\\lambda\\,\\hat{\\mathbf{q}} = \\mathbf{L}\\,\\hat{\\mathbf{q}}$ to account for the nonuniform grid spacing. Then compute the leading eigenvalues to diagnose global instability.",
            "solution": "The solution is derived through a systematic three-step process: formulating the eigenvalue problem, specifying appropriate boundary conditions, and detailing a correct numerical discretization strategy.\n\n1.  **Formulation of the Eigenvalue Problem**: We start with the governing PDE, $\\partial_t q = \\mu(x) q + U \\,\\partial_x q + D \\,\\partial_{xx} q$. Applying the temporal normal-mode ansatz, $q(x,t) = \\hat{q}(x) e^{\\lambda t}$, where $\\lambda$ is the complex eigenvalue and $\\hat{q}(x)$ is the spatial mode shape, transforms the PDE into a second-order ordinary differential eigenvalue equation:\n    $$\n    \\lambda \\hat{q}(x) = \\left( \\mu(x) + U \\partial_x + D \\partial_{xx} \\right) \\hat{q}(x)\n    $$\n    This correctly defines the continuous eigenvalue problem.\n\n2.  **Boundary Conditions (BCs)**: The problem describes an open, convective-diffusive system with flow from $x=0$ (inflow) to $x=L$ (outflow). The BCs must reflect this physics.\n    *   **Inflow ($x=0$)**: To study instabilities generated within the domain, it is standard practice to prevent any disturbances from entering. A homogeneous Dirichlet condition, $\\hat{q}(0) = 0$, achieves this.\n    *   **Outflow ($x=L$)**: The BC should allow disturbances to leave the domain with minimal non-physical reflection. A \"hard\" condition like $\\hat{q}(L) = 0$ would cause strong reflections. A \"soft\" or non-reflecting condition is needed. The simplest and a very common choice is a homogeneous Neumann (zero-gradient) condition, $\\partial_x \\hat{q}(L) = 0$. This allows the mode amplitude to have a non-zero value and a zero slope at the exit, which is a reasonable approximation of an outgoing wave far downstream.\n\n3.  **Numerical Discretization (Spectral Collocation)**: A robust method for this non-periodic problem is spectral collocation using Chebyshev polynomials.\n    *   **Domain Mapping**: Chebyshev methods are defined on the canonical interval $\\xi \\in [-1,1]$. The physical domain $x \\in [0,L]$ must be mapped via the affine transformation $x = \\frac{L}{2}(1+\\xi)$.\n    *   **Derivative Scaling**: Due to the mapping, derivatives must be rescaled using the chain rule: $\\partial_x = \\frac{2}{L}\\partial_\\xi$ and $\\partial_{xx} = (\\frac{2}{L})^2 \\partial_{\\xi\\xi}$.\n    *   **Discretization**: The continuous function $\\hat{q}(x)$ is represented by its values $\\hat{\\mathbf{q}}$ at the Chebyshev-Gauss-Lobatto (CGL) collocation points. The derivatives are approximated by matrix-vector products with correctly scaled Chebyshev differentiation matrices. This leads to the standard matrix eigenvalue problem $\\mathbf{L}\\,\\hat{\\mathbf{q}} = \\lambda\\,\\hat{\\mathbf{q}}$, where $\\mathbf{L}$ is the discretized operator. The BCs are enforced by modifying the rows of the matrix equation corresponding to the boundary nodes.\n\n**Analysis of Options:**\n*   **A**: Correctly implements all three steps: the ansatz, the physically appropriate inflow (Dirichlet) and outflow (Neumann) BCs, and the complete, correctly scaled Chebyshev collocation strategy.\n*   **B**: Uses periodic BCs, which are physically incorrect for an inflow-outflow problem.\n*   **C**: Imposes two BCs at the inflow and none at the outflow, which is mathematically ill-posed for a second-order ODE. It also fails to scale the differentiation matrices, which is a critical error.\n*   **D**: Uses a Dirichlet BC at the outflow, which is physically inappropriate as it induces strong reflections. The grid point mapping is incorrect for the interval $[0,L]$. The justification for a generalized eigenvalue problem is also incorrect for a collocation method.\n\nTherefore, option A provides the only complete and correct procedure.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A primary challenge in computational analysis is that simulations are performed on finite domains, while many physical flows are \"open\" and effectively extend to infinity. This mismatch can cause spurious reflections from artificial boundaries, contaminating the solution. This practice  explores the sponge layer, a widely-used numerical technique designed to absorb outgoing waves and mimic a non-reflecting, infinite domain. By analyzing how this damping term modifies the governing operator, you will gain insight into how it successfully shifts the continuous spectrum associated with far-field effects while minimally perturbing the physically important discrete eigenvalues of core-localized modes.",
            "id": "3323904",
            "problem": "Consider a global linear instability analysis of a complex open flow, where the governing equations are the linearization of the Navier–Stokes equations about a steady base flow. After a high-order spatial discretization, the semi-discrete system for the perturbation state vector $\\mathbf{q}(t)$ takes the form\n$$\n\\mathbf{M}\\,\\frac{d\\mathbf{q}}{dt} \\;=\\; \\mathbf{A}\\,\\mathbf{q},\n$$\nwhere $\\mathbf{M}$ is a symmetric positive definite mass matrix arising from the discretization of the inner product, and $\\mathbf{A}$ is the linearized operator that includes advection, pressure coupling, viscous diffusion, and boundary condition enforcement. The global spectrum is computed from the generalized eigenvalue problem\n$$\n\\mathbf{A}\\,\\mathbf{q} \\;=\\; \\lambda\\,\\mathbf{M}\\,\\mathbf{q}.\n$$\nTo mitigate reflections and mimic radiation on the truncated computational domain, a sponge layer is introduced in a peripheral subregion $\\Omega_s$ by appending a linear damping term to the evolution equations. Specifically, the modified evolution is\n$$\n\\mathbf{M}\\,\\frac{d\\mathbf{q}}{dt} \\;=\\; \\mathbf{A}\\,\\mathbf{q} \\;-\\; \\boldsymbol{\\Sigma}\\,\\mathbf{M}\\,\\mathbf{q},\n$$\nwhere $\\boldsymbol{\\Sigma}$ is a diagonal operator whose entries are the nonnegative spatially varying scalar field $\\sigma(\\mathbf{x}) \\ge 0$ supported in $\\Omega_s$ and vanishing in the core region. The corresponding eigenvalue problem becomes\n$$\n\\big(\\mathbf{A} - \\boldsymbol{\\Sigma}\\,\\mathbf{M}\\big)\\,\\mathbf{q} \\;=\\; \\lambda\\,\\mathbf{M}\\,\\mathbf{q}.\n$$\nAssume the base flow is constant in the far field and the sponge layer smoothly attains a constant asymptotic value $\\sigma_\\infty  0$ in that far field. Using first principles—namely the linearized dynamical system structure, the energy inner product associated with $\\mathbf{M}$, and Fourier analysis of the far-field symbol—determine which of the following statements about the spectral effect of the sponge layer are correct.\n\nA. Appending the sponge layer corresponds to replacing $\\mathbf{A}$ by $\\mathbf{A} - \\boldsymbol{\\Sigma}\\,\\mathbf{M}$, with $\\boldsymbol{\\Sigma}\\ge 0$ and self-adjoint relative to the $\\mathbf{M}$ inner product, which introduces nonnegative energy dissipation. This moves the continuous spectrum associated with far-field advection and radiation to the left in the complex plane by approximately $-\\sigma_\\infty$, while discrete physical eigenvalues that are spatially localized in the core region are only weakly perturbed, with leading-order shifts that scale with the fraction of their $\\mathbf{M}$-energy residing inside $\\Omega_s$.\n\nB. The primary effect of the sponge layer is equivalent to modifying the mass matrix as $\\mathbf{M} \\mapsto \\mathbf{M} + \\boldsymbol{\\Sigma}$, which increases the effective inertia and therefore tends to move the discrete physical eigenvalues to the right in the complex plane (larger real parts), potentially destabilizing previously stable modes.\n\nC. In the special case $\\sigma(\\mathbf{x}) \\equiv \\alpha  0$ uniform throughout the domain, the sponge operator is $\\boldsymbol{\\Sigma}\\,\\mathbf{M} = \\alpha\\,\\mathbf{M}$ and every eigenvalue undergoes an exact rigid translation: if $\\lambda_{\\text{old}}$ solves $\\mathbf{A}\\mathbf{q} = \\lambda_{\\text{old}} \\mathbf{M}\\mathbf{q}$, then $\\lambda_{\\text{new}} = \\lambda_{\\text{old}} - \\alpha$ solves $(\\mathbf{A} - \\alpha \\mathbf{M})\\mathbf{q} = \\lambda_{\\text{new}} \\mathbf{M}\\mathbf{q}$. For a far-field region with $\\sigma(\\mathbf{x}) \\to \\sigma_\\infty$, the essential spectrum associated with far-field advection–diffusion is translated left by approximately $-\\sigma_\\infty$, while discrete physical eigenvalues supported in the core shift by an amount $-\\big(\\mathbf{q}^\\ast \\boldsymbol{\\Sigma}\\mathbf{M}\\mathbf{q}\\big)/\\big(\\mathbf{q}^\\ast \\mathbf{M}\\mathbf{q}\\big)$ at leading order, which is small if $\\mathbf{q}$ has negligible energy in $\\Omega_s$.\n\nD. Because the sponge layer introduces pointwise damping, it renders the operator compact and completely removes the continuous spectrum, leaving only isolated, discrete eigenvalues; thus, the global spectrum becomes purely discrete.\n\nE. The sponge damping predominantly modifies the imaginary parts of the eigenvalues (oscillation frequencies) without significantly affecting the real parts (growth rates), since its action is equivalent to a phase shift in the far field.\n\nChoose all correct options.",
            "solution": "The effect of the sponge layer on the spectrum can be analyzed by considering its impact on the governing eigenvalue problem. The original problem is $\\mathbf{A}\\mathbf{q} = \\lambda\\mathbf{M}\\mathbf{q}$, and the modified problem is $(\\mathbf{A} - \\boldsymbol{\\Sigma}\\mathbf{M})\\mathbf{q} = \\lambda\\mathbf{M}\\mathbf{q}$.\n\n1.  **Uniform Damping Case**: A key insight comes from the special case where damping is uniform, $\\sigma(\\mathbf{x}) = \\alpha > 0$. Here, $\\boldsymbol{\\Sigma} = \\alpha\\mathbf{I}$. The modified eigenvalue problem becomes $(\\mathbf{A} - \\alpha\\mathbf{M})\\mathbf{q} = \\lambda_{\\text{new}}\\mathbf{M}\\mathbf{q}$. This can be rearranged to $\\mathbf{A}\\mathbf{q} = (\\lambda_{\\text{new}} + \\alpha)\\mathbf{M}\\mathbf{q}$. Comparing this to the original problem, $\\mathbf{A}\\mathbf{q} = \\lambda_{\\text{old}}\\mathbf{M}\\mathbf{q}$, we see that $\\lambda_{\\text{old}} = \\lambda_{\\text{new}} + \\alpha$, which means $\\lambda_{\\text{new}} = \\lambda_{\\text{old}} - \\alpha$. This shows that uniform damping rigidly shifts the entire spectrum to the left along the real axis by an amount $\\alpha$.\n\n2.  **Effect on Continuous Spectrum**: The continuous spectrum arises from wave-like solutions in the far-field of an open domain, where the base flow is effectively uniform. In this region, the sponge strength approaches a constant, $\\sigma(\\mathbf{x}) \\to \\sigma_\\infty$. Based on the uniform damping case, the continuous spectrum is therefore shifted to the left in the complex plane by approximately $\\sigma_\\infty$. This is the primary purpose of a sponge layer: to move the non-physical continuous spectrum associated with the finite domain far into the stable left half-plane, \"cleaning\" the spectrum so that physical, discrete modes are easier to identify.\n\n3.  **Effect on Discrete Spectrum**: Discrete global modes are spatially localized in the core of the domain and decay towards the boundaries. By design, the sponge function $\\sigma(\\mathbf{x})$ is zero in this core region and only non-zero in the peripheral region $\\Omega_s$. The change to the operator is the perturbation $\\delta\\mathbf{A} = -\\boldsymbol{\\Sigma}\\mathbf{M}$. According to standard eigenvalue perturbation theory, the shift in an eigenvalue is proportional to an inner product that measures the overlap between the mode, its adjoint, and the perturbation. Since the discrete mode has negligible amplitude in the sponge region $\\Omega_s$, this overlap is very small. Consequently, the eigenvalues of discrete global modes are only weakly perturbed.\n\n4.  **Energy and Stability**: The sponge term, $-\\boldsymbol{\\Sigma}\\mathbf{M}\\mathbf{q}$, is a damping term. It introduces dissipation, meaning it removes energy from the system. This must correspond to a decrease in the growth rate of perturbations, i.e., a shift of the eigenvalues to the left (more negative real part). Any claim of destabilization is incorrect.\n\n**Analysis of Options:**\n*   **A**: This statement correctly identifies that the operator $\\mathbf{A}$ is modified, the sponge is dissipative ($\\boldsymbol{\\Sigma} \\ge 0$), the continuous spectrum is shifted left by $\\approx -\\sigma_\\infty$, and the discrete eigenvalues are weakly perturbed. This is a complete and accurate summary of the sponge layer's function.\n*   **B**: This is incorrect. The sponge modifies the operator $\\mathbf{A}$, not the mass matrix $\\mathbf{M}$. Furthermore, it is stabilizing (moves eigenvalues left), not destabilizing.\n*   **C**: This statement correctly analyzes the uniform damping case, yielding the exact shift $\\lambda_{\\text{new}} = \\lambda_{\\text{old}} - \\alpha$. It then correctly applies this reasoning to the far-field to deduce the shift of the essential (continuous) spectrum. It also correctly argues that the shift for discrete modes is small due to the lack of spatial overlap. This statement is also entirely correct.\n*   **D**: This is incorrect. Adding a bounded perturbation (like the sponge term) does not eliminate the continuous spectrum; it can only shift it. The essential spectrum remains.\n*   **E**: This is incorrect. The sponge term represents physical damping, which primarily affects the real part of the eigenvalue (the growth rate), not the imaginary part (the frequency).\n\nBoth A and C provide correct and complementary descriptions of the sponge layer's spectral effects.",
            "answer": "$$\\boxed{AC}$$"
        },
        {
            "introduction": "The power of instability analysis extends beyond a single calculation; its true utility lies in understanding how stability characteristics evolve as physical parameters like the Reynolds number ($\\mathrm{Re}$) or Mach number ($\\mathrm{Ma}$) change. This final exercise  provides a hands-on experience with a common research task: performing a parameter continuation study using a simplified Reduced-Order Model (ROM). By tracking eigenvalues, identifying mode-switching events, and locating regions of strong interaction within a two-mode model, you will gain practical skills in mapping stability diagrams. This practice bridges the gap from basic analysis to the advanced diagnostics used to uncover how different physical mechanisms compete to drive instability in complex flows.",
            "id": "3323974",
            "problem": "Consider the global instability of a compressible cavity flow modeled by the linearized compressible Navier–Stokes equations about a steady base state. The leading global mode is defined as the eigenpair $\\{\\lambda,\\mathbf{q}\\}$ of a linear operator such that $\\mathcal{L}(\\mathrm{Re},\\mathrm{Ma},\\mathrm{Pr})\\,\\mathbf{q}=\\lambda\\,\\mathbf{q}$, where $\\mathrm{Re}$ is the Reynolds number, $\\mathrm{Ma}$ is the Mach number, and $\\mathrm{Pr}$ is the Prandtl number. To focus on the interaction between a shear-layer instability and an acoustic resonance, use a two-degree-of-freedom Reduced-Order Model (ROM) in which the uncoupled shear-layer and acoustic modes have the complex eigenvalues $\\lambda_s^0=\\alpha_s+i\\,\\omega_s$ and $\\lambda_a^0=\\alpha_a+i\\,\\omega_a$. The coupled global operator is the $2\\times 2$ complex matrix\n$$\n\\mathbf{L}(\\mathrm{Re},\\mathrm{Ma},\\mathrm{Pr},s)=\n\\begin{bmatrix}\n\\lambda_s^0  \\kappa \\\\\n\\kappa  \\lambda_a^0\n\\end{bmatrix},\n$$\nwhere $s\\in[0,1]$ is a dimensionless coupling scale parameter modeling the cavity’s acoustic reflectivity. Let the uncoupled growth rates and angular frequencies be defined by the following dimensionless calibrations around a base point $(\\mathrm{Re}_0,\\mathrm{Ma}_0,\\mathrm{Pr}_0)$:\n$$\n\\alpha_s(\\mathrm{Re},\\mathrm{Pr})=\\alpha_{s0}+\\alpha_{s1}\\,\\frac{\\mathrm{Re}-\\mathrm{Re}_0}{\\mathrm{Re}_0}-\\alpha_{s2}\\,(\\mathrm{Pr}-\\mathrm{Pr}_0),\n\\quad\n\\omega_s(\\mathrm{Re})=\\omega_{s0}+\\omega_{s1}\\,\\sqrt{\\mathrm{Re}},\n$$\n$$\n\\alpha_a(\\mathrm{Ma},\\mathrm{Pr})=\\alpha_{a0}+\\alpha_{a1}\\,(\\mathrm{Ma}-\\mathrm{Ma}_0)-\\alpha_{a2}\\,(\\mathrm{Pr}-\\mathrm{Pr}_0),\n\\quad\n\\omega_a(\\mathrm{Ma})=\\omega_{a0}+\\omega_{a1}\\,\\mathrm{Ma},\n$$\nand let the hydrodynamic–acoustic coupling be\n$$\n\\kappa(\\mathrm{Re},\\mathrm{Ma},s)=s\\left(\\kappa_1\\,\\mathrm{Ma}+\\kappa_2\\,\\sqrt{\\mathrm{Re}}\\right).\n$$\nUse the physically plausible, dimensionless constants\n$$\n\\mathrm{Re}_0=600,\\quad \\mathrm{Ma}_0=0.6,\\quad \\mathrm{Pr}_0=0.72,\n$$\n$$\n\\alpha_{s0}=-0.05,\\quad \\alpha_{s1}=0.12,\\quad \\alpha_{s2}=0.02,\n\\quad\n\\omega_{s0}=0.7,\\quad \\omega_{s1}=0.03,\n$$\n$$\n\\alpha_{a0}=-0.08,\\quad \\alpha_{a1}=0.15,\\quad \\alpha_{a2}=0.01,\n\\quad\n\\omega_{a0}=0.4,\\quad \\omega_{a1}=1.2,\n$$\n$$\n\\kappa_1=0.02,\\quad \\kappa_2=0.005.\n$$\nAll quantities are non-dimensional. The leading global eigenvalue $\\lambda_{\\max}$ is the eigenvalue of $\\mathbf{L}$ with the largest real part. Classify the leading mode at a given parameter point by its eigenvector $\\mathbf{v}_{\\max}$: if the absolute value of the first component is greater than or equal to the absolute value of the second, label it as shear-layer (integer $0$); otherwise, label it as acoustic (integer $1$).\n\nYour program must implement a parameter continuation in the sense of evaluating $\\lambda_{\\max}$ along parameter paths and tracking the mode classification. In addition, estimate the codimension-$2$ crossing between shear-layer and acoustic branches as the simultaneous solution to\n$$\n\\alpha_s(\\mathrm{Re},\\mathrm{Pr})=\\alpha_a(\\mathrm{Ma},\\mathrm{Pr}),\n\\qquad\n\\omega_s(\\mathrm{Re})=\\omega_a(\\mathrm{Ma}),\n$$\nfor a fixed $\\mathrm{Pr}$, which marks the intersection of equal growth rate and equal frequency manifolds.\n\nImplement the following test suite and compute the requested results. Each test uses the constants above and $\\mathrm{Pr}=\\mathrm{Pr}_0$ unless specified otherwise:\n\n- Test $1$ (continuation in $\\mathrm{Re}$): With $\\mathrm{Ma}=0.6$, $s=1.0$, and $\\mathrm{Re}$ varying uniformly from $300$ to $900$ in $121$ steps, compute and return the maximum real part of the leading eigenvalue $\\lambda_{\\max}$ encountered along the path (a float).\n\n- Test $2$ (classification switch in $\\mathrm{Ma}$): With $\\mathrm{Re}=600$, $s=1.0$, and $\\mathrm{Ma}$ varying uniformly from $0.2$ to $1.2$ in $101$ steps, find and return the smallest $\\mathrm{Ma}$ at which the leading-mode classification switches between shear-layer ($0$) and acoustic ($1$), using the classification at $\\mathrm{Ma}=0.2$ as the reference (a float). If no switch occurs, return $\\mathrm{NaN}$.\n\n- Test $3$ (distance to codimension-$2$ crossing along a path in $(\\mathrm{Re},\\mathrm{Ma})$): With $s=1.0$, and the parametric path $\\mathrm{Re}(t)=650+50\\,t$, $\\mathrm{Ma}(t)=0.85+0.1\\,t$ for $t\\in[0,1]$ sampled at $101$ uniformly spaced values, compute the minimum value of\n$$\nD(t)=\\sqrt{\\left[\\alpha_s(\\mathrm{Re}(t),\\mathrm{Pr}_0)-\\alpha_a(\\mathrm{Ma}(t),\\mathrm{Pr}_0)\\right]^2+\\left[\\omega_s(\\mathrm{Re}(t))-\\omega_a(\\mathrm{Ma}(t))\\right]^2}\n$$\nencountered along the path (a float).\n\n- Test $4$ (existence of uncoupled codimension-$2$ crossing within a domain): With $s=0.0$ (uncoupled limit) and $\\mathrm{Pr}=\\mathrm{Pr}_0$, solve the system\n$$\n\\alpha_s(\\mathrm{Re},\\mathrm{Pr}_0)=\\alpha_a(\\mathrm{Ma},\\mathrm{Pr}_0),\\qquad \\omega_s(\\mathrm{Re})=\\omega_a(\\mathrm{Ma}),\n$$\nfor $(\\mathrm{Re}^\\star,\\mathrm{Ma}^\\star)$, and return a boolean indicating whether the solution lies within the domain $\\mathrm{Re}\\in[500,800]$ and $\\mathrm{Ma}\\in[0.5,1.0]$. Use a robust one-dimensional root find by eliminating $\\mathrm{Re}$ through the first equation and solving the second for $\\mathrm{Ma}$; if no solution exists, return false.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Tests $1$ through $4$, for example, $[r_1,r_2,r_3,r_4]$. All outputs must be dimensionless floats or a boolean, exactly as specified above.",
            "solution": "The problem is valid as it is scientifically grounded in the field of fluid dynamics, specifically global instability analysis, and presents a well-posed, objective, and computationally verifiable set of tasks. The model, while simplified, is a standard reduced-order representation of mode interaction in complex flows. All parameters, constants, and functions are explicitly defined, allowing for a direct and unambiguous implementation.\n\nThe solution proceeds by first implementing the governing physical model and then addressing each of the four test cases systematically.\n\n### 1. Model Formulation\n\nThe core of the problem is the analysis of a $2 \\times 2$ complex matrix $\\mathbf{L}$, which serves as a Reduced-Order Model (ROM) for the interaction between a shear-layer mode and an acoustic mode in a compressible cavity flow. The matrix is given by:\n$$\n\\mathbf{L}(\\mathrm{Re},\\mathrm{Ma},\\mathrm{Pr},s)=\n\\begin{bmatrix}\n\\lambda_s^0  \\kappa \\\\\n\\kappa  \\lambda_a^0\n\\end{bmatrix}\n$$\nThe diagonal elements, $\\lambda_s^0 = \\alpha_s + i\\,\\omega_s$ and $\\lambda_a^0 = \\alpha_a + i\\,\\omega_a$, represent the complex eigenvalues of the uncoupled shear-layer and acoustic modes, respectively. The off-diagonal element, $\\kappa$, represents the coupling strength between them. Their dependencies on the physical parameters (Reynolds number $\\mathrm{Re}$, Mach number $\\mathrm{Ma}$, Prandtl number $\\mathrm{Pr}$, and coupling scale $s$) are defined by a set of linear and simple non-linear calibration functions.\n\nThe provided constants are:\n- Base state: $\\mathrm{Re}_0=600$, $\\mathrm{Ma}_0=0.6$, $\\mathrm{Pr}_0=0.72$.\n- Shear-layer coefficients: $\\alpha_{s0}=-0.05$, $\\alpha_{s1}=0.12$, $\\alpha_{s2}=0.02$, $\\omega_{s0}=0.7$, $\\omega_{s1}=0.03$.\n- Acoustic coefficients: $\\alpha_{a0}=-0.08$, $\\alpha_{a1}=0.15$, $\\alpha_{a2}=0.01$, $\\omega_{a0}=0.4$, $\\omega_{a1}=1.2$.\n- Coupling coefficients: $\\kappa_1=0.02$, $\\kappa_2=0.005$.\n\nAll tests are conducted at a fixed Prandtl number $\\mathrm{Pr}=\\mathrm{Pr}_0=0.72$. This simplifies the expressions for the growth rates $\\alpha_s$ and $\\alpha_a$, as the term $(\\mathrm{Pr}-\\mathrm{Pr}_0)$ is always zero. The working equations are:\n$$\n\\alpha_s(\\mathrm{Re}) = \\alpha_{s0}+\\alpha_{s1}\\,\\frac{\\mathrm{Re}-\\mathrm{Re}_0}{\\mathrm{Re}_0} = -0.05+0.12\\,\\frac{\\mathrm{Re}-600}{600}\n$$\n$$\n\\omega_s(\\mathrm{Re}) = \\omega_{s0}+\\omega_{s1}\\,\\sqrt{\\mathrm{Re}} = 0.7+0.03\\,\\sqrt{\\mathrm{Re}}\n$$\n$$\n\\alpha_a(\\mathrm{Ma}) = \\alpha_{a0}+\\alpha_{a1}\\,(\\mathrm{Ma}-\\mathrm{Ma}_0) = -0.08+0.15\\,(\\mathrm{Ma}-0.6)\n$$\n$$\n\\omega_a(\\mathrm{Ma}) = \\omega_{a0}+\\omega_{a1}\\,\\mathrm{Ma} = 0.4+1.2\\,\\mathrm{Ma}\n$$\n$$\n\\kappa(\\mathrm{Re},\\mathrm{Ma},s) = s\\left(\\kappa_1\\,\\mathrm{Ma}+\\kappa_2\\,\\sqrt{\\mathrm{Re}}\\right) = s\\left(0.02\\,\\mathrm{Ma}+0.005\\,\\sqrt{\\mathrm{Re}}\\right)\n$$\n\n### 2. Eigenvalue Problem and Mode Classification\n\nThe eigenvalues $\\lambda$ of the matrix $\\mathbf{L}$ are the roots of the characteristic equation $\\det(\\mathbf{L} - \\lambda\\mathbf{I}) = 0$:\n$$\n(\\lambda_s^0 - \\lambda)(\\lambda_a^0 - \\lambda) - \\kappa^2 = 0\n$$\nThis is a quadratic equation for $\\lambda$, whose solutions are:\n$$\n\\lambda = \\frac{\\lambda_s^0 + \\lambda_a^0}{2} \\pm \\frac{\\sqrt{(\\lambda_s^0 - \\lambda_a^0)^2 + 4\\kappa^2}}{2}\n$$\nThe leading global eigenvalue, $\\lambda_{\\max}$, is the eigenvalue with the largest real part, $\\mathrm{Re}(\\lambda)$.\n\nThe leading mode is classified based on its corresponding eigenvector $\\mathbf{v}_{\\max} = [v_1, v_2]^T$. If $|v_1| \\ge |v_2|$, the mode is classified as shear-layer (integer $0$); otherwise, it is acoustic (integer $1$). The eigenvector corresponding to an eigenvalue $\\lambda$ can be found by solving $(\\mathbf{L} - \\lambda\\mathbf{I})\\mathbf{v} = \\mathbf{0}$. For $\\kappa \\ne 0$, a valid eigenvector is $\\mathbf{v} = [\\kappa, \\lambda - \\lambda_s^0]^T$. The classification is then based on comparing $|\\kappa|$ with $|\\lambda_{\\max} - \\lambda_s^0|$.\n\n### 3. Implementation of Test Cases\n\nA computational routine is developed to address the four specific tests.\n\n**Test 1: Continuation in $\\mathrm{Re}$**\nWith $\\mathrm{Ma}=0.6$ and $s=1.0$, the parameter $\\mathrm{Re}$ is varied from $300$ to $900$ over $121$ steps. At each step, the matrix $\\mathbf{L}$ is constructed, its eigenvalues are computed, and the real part of the leading eigenvalue $\\lambda_{\\max}$ is stored. The final result is the maximum value of these stored real parts encountered along the path.\n\n**Test 2: Classification Switch in $\\mathrm{Ma}$**\nWith $\\mathrm{Re}=600$ and $s=1.0$, the parameter $\\mathrm{Ma}$ is varied from $0.2$ to $1.2$ over $101$ steps. First, the mode classification (shear-layer or acoustic) is determined at the initial point $\\mathrm{Ma}=0.2$. Then, for subsequent values of $\\mathrm{Ma}$, the mode is re-classified. The test returns the first (smallest) value of $\\mathrm{Ma}$ at which the classification differs from the initial one. If no such switch occurs over the entire path, the result is $\\mathrm{NaN}$.\n\n**Test 3: Distance to Codimension-$2$ Crossing**\nA parametric path in the $(\\mathrm{Re}, \\mathrm{Ma})$ plane is defined by $\\mathrm{Re}(t)=650+50t$ and $\\mathrm{Ma}(t)=0.85+0.1t$ for $t \\in [0,1]$, sampled at $101$ points. At each point, the distance metric $D(t)$ is calculated:\n$$\nD(t)=\\sqrt{\\left[\\alpha_s(\\mathrm{Re}(t))-\\alpha_a(\\mathrm{Ma}(t))\\right]^2+\\left[\\omega_s(\\mathrm{Re}(t))-\\omega_a(\\mathrm{Ma}(t))\\right]^2}\n$$\nThis metric represents the Euclidean distance between the uncoupled eigenvalues $(\\alpha_s, \\omega_s)$ and $(\\alpha_a, \\omega_a)$ in the complex plane. The final result is the minimum value of $D(t)$ found along the path.\n\n**Test 4: Existence of Uncoupled Codimension-$2$ Crossing**\nThis test requires solving the system of two nonlinear equations for $(\\mathrm{Re}, \\mathrm{Ma})$ that defines a codimension-$2$ crossing point where the uncoupled eigenvalues are equal ($\\lambda_s^0 = \\lambda_a^0$):\n$$\n(1) \\quad \\alpha_s(\\mathrm{Re}) = \\alpha_a(\\mathrm{Ma})\n$$\n$$\n(2) \\quad \\omega_s(\\mathrm{Re}) = \\omega_a(\\mathrm{Ma})\n$$\nSubstituting the explicit formulas with $\\mathrm{Pr}=\\mathrm{Pr}_0$:\n$$\n(1) \\quad -0.05+0.12\\,\\frac{\\mathrm{Re}-600}{600} = -0.08+0.15\\,(\\mathrm{Ma}-0.6)\n$$\n$$\n(2) \\quad 0.7+0.03\\,\\sqrt{\\mathrm{Re}} = 0.4+1.2\\,\\mathrm{Ma}\n$$\nEquation (1) is linear in $\\mathrm{Re}$ and $\\mathrm{Ma}$. Simplifying it yields a direct relationship: $\\mathrm{Re} = 750\\,\\mathrm{Ma}$.\nSubstituting this into Equation (2) yields a single nonlinear equation for $\\mathrm{Ma}$:\n$$\n0.7+0.03\\,\\sqrt{750\\,\\mathrm{Ma}} - (0.4+1.2\\,\\mathrm{Ma}) = 0\n$$\nThis equation is solved for $\\mathrm{Ma}$ using a numerical root-finding algorithm, such as Brent's method. The search for the root $\\mathrm{Ma}^\\star$ is performed within an interval derived from the intersection of the problem's specified domains, $\\mathrm{Ma}\\in[0.5,1.0]$ and $\\mathrm{Re}\\in[500,800]$. The latter constraint implies $\\mathrm{Ma} \\in [500/750, 800/750] \\approx [0.667, 1.067]$. Thus, the search for $\\mathrm{Ma}^\\star$ is performed in $[2/3, 1.0]$. If a root is found in this interval, a solution $(\\mathrm{Re}^\\star, \\mathrm{Ma}^\\star)$ exists within the specified domain, and the function returns `True`; otherwise, it returns `False`.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem and print the results for all test cases.\n    \"\"\"\n\n    # --- Model Constants ---\n    Re0, Ma0, Pr0 = 600.0, 0.6, 0.72\n    alpha_s0, alpha_s1, alpha_s2 = -0.05, 0.12, 0.02\n    omega_s0, omega_s1 = 0.7, 0.03\n    alpha_a0, alpha_a1, alpha_a2 = -0.08, 0.15, 0.01\n    omega_a0, omega_a1 = 0.4, 1.2\n    kappa1, kappa2 = 0.02, 0.005\n\n    # --- Model Functions (with Pr = Pr0) ---\n    def alpha_s(Re):\n        return alpha_s0 + alpha_s1 * (Re - Re0) / Re0\n    \n    def omega_s(Re):\n        return omega_s0 + omega_s1 * np.sqrt(Re)\n\n    def alpha_a(Ma):\n        return alpha_a0 + alpha_a1 * (Ma - Ma0)\n    \n    def omega_a(Ma):\n        return omega_a0 + omega_a1 * Ma\n\n    def kappa(Re, Ma, s):\n        return s * (kappa1 * Ma + kappa2 * np.sqrt(Re))\n\n    def get_leading_mode(Re, Ma, s):\n        \"\"\"\n        Computes the leading eigenvalue and its classification for given parameters.\n        \"\"\"\n        lambda_s_0 = alpha_s(Re) + 1j * omega_s(Re)\n        lambda_a_0 = alpha_a(Ma) + 1j * omega_a(Ma)\n        k = kappa(Re, Ma, s)\n\n        # Build the L matrix\n        L = np.array([[lambda_s_0, k], [k, lambda_a_0]], dtype=complex)\n        \n        # Eigen decomposition\n        evals, evecs = np.linalg.eig(L)\n        \n        # Find leading eigenvalue (max real part)\n        idx_max = np.argmax(np.real(evals))\n        lambda_max = evals[idx_max]\n        \n        # Get corresponding eigenvector\n        v_max = evecs[:, idx_max]\n        \n        # Classify the mode\n        # 0 for shear-layer, 1 for acoustic\n        classification = 0 if np.abs(v_max[0]) >= np.abs(v_max[1]) else 1\n        \n        return lambda_max, classification\n\n    # --- Test Case 1: Continuation in Re ---\n    def test1():\n        Ma, s = 0.6, 1.0\n        Re_path = np.linspace(300, 900, 121)\n        max_real_parts = []\n        for Re in Re_path:\n            lambda_max, _ = get_leading_mode(Re, Ma, s)\n            max_real_parts.append(np.real(lambda_max))\n        return np.max(max_real_parts)\n\n    # --- Test Case 2: Classification switch in Ma ---\n    def test2():\n        Re, s = 600.0, 1.0\n        Ma_path = np.linspace(0.2, 1.2, 101)\n        \n        # Get reference classification at the start of the path\n        _, ref_class = get_leading_mode(Re, Ma_path[0], s)\n        \n        # Find the first point of switch\n        for Ma in Ma_path[1:]:\n            _, current_class = get_leading_mode(Re, Ma, s)\n            if current_class != ref_class:\n                return Ma\n        \n        return np.nan\n\n    # --- Test Case 3: Distance to codimension-2 crossing ---\n    def test3():\n        s = 1.0\n        t_path = np.linspace(0, 1, 101)\n        distances = []\n        \n        for t in t_path:\n            Re_t = 650.0 + 50.0 * t\n            Ma_t = 0.85 + 0.1 * t\n            \n            val_alpha_s = alpha_s(Re_t)\n            val_omega_s = omega_s(Re_t)\n            val_alpha_a = alpha_a(Ma_t)\n            val_omega_a = omega_a(Ma_t)\n            \n            dist = np.sqrt((val_alpha_s - val_alpha_a)**2 + (val_omega_s - val_omega_a)**2)\n            distances.append(dist)\n            \n        return np.min(distances)\n\n    # --- Test Case 4: Existence of uncoupled codimension-2 crossing ---\n    def test4():\n        # Eq1: alpha_s(Re) = alpha_a(Ma)\n        # alpha_s0 + alpha_s1*(Re/Re0 - 1) = alpha_a0 + alpha_a1*(Ma - Ma0)\n        # 0.0002*Re - 0.17 = 0.15*Ma - 0.17 => Re = 750 * Ma\n        re_of_ma = lambda ma: 750.0 * ma\n\n        # Eq2: omega_s(Re) = omega_a(Ma)\n        # We need to find the root of f(Ma) = omega_s(Re(Ma)) - omega_a(Ma) = 0\n        def f_ma(ma):\n            re = re_of_ma(ma)\n            return omega_s(re) - omega_a(ma)\n\n        # Domain constraints\n        re_min, re_max = 500.0, 800.0\n        ma_min, ma_max = 0.5, 1.0\n        \n        # Further constrain Ma search interval based on Re constraint\n        ma_from_re_min = re_min / 750.0 # 500/750 = 2/3\n        ma_from_re_max = re_max / 750.0 # 800/750 = 16/15\n        \n        search_ma_min = max(ma_min, ma_from_re_min)\n        search_ma_max = min(ma_max, ma_from_re_max)\n        \n        # Check if search interval is valid\n        if search_ma_min >= search_ma_max:\n             return False\n\n        try:\n            # Brent's method requires endpoints to have different signs\n            optimize.brentq(f_ma, search_ma_min, search_ma_max)\n            return True\n        except ValueError:\n            # Occurs if f(a) and f(b) have the same sign (no guaranteed root)\n            return False\n\n    # --- Execute all tests and format output ---\n    results = [test1(), test2(), test3(), test4()]\n    \n    # Format according to specifications in the problem description\n    print(f\"[{results[0]},{results[1]},{results[2]},{str(results[3]).lower()}]\")\n\nsolve()\n```"
        }
    ]
}