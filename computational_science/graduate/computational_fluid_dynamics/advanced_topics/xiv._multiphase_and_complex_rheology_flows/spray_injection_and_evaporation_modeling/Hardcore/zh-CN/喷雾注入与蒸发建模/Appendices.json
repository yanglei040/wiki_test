{
    "hands_on_practices": [
        {
            "introduction": "在模拟数百万个液滴之前，我们必须首先确保我们的代码能够准确地求解单个液滴的控制方程。“人造解方法”（Method of Manufactured Solutions, MMS）是进行代码验证的黄金标准。本练习将指导你推导必要的源项，并实施一个数值测试，以根据已知的精确解来验证求解器的准确性和收敛阶。",
            "id": "3364871",
            "problem": "考虑一个蒸发的球形液滴群，其模型通过质量和能量守恒定律描述，并受到与周围气体的对流传热和传质作用。假设该液滴群是稀疏的，从而可以忽略液滴间的相互作用，气相属性恒定，且液滴保持球形。设 $t$ 表示时间。设液滴液体密度为 $\\rho_\\ell$，液体比热容为 $c_{p,\\ell}$，汽化潜热为 $L_v$，气体密度为 $\\rho_g$，气体动力粘度为 $\\mu_g$，气体导热系数为 $k_g$，气体比热容为 $c_{p,g}$，蒸汽在气体中的二元扩散系数为 $D_v$，普适气体常数为 $R_u$，蒸汽分子量为 $M_v$，空气分子量为 $M_{air}$，环境气体压力为 $p$，环境气体温度为 $T_g$，环境蒸汽质量分数为 $Y_{v,\\infty}$。液滴质量为 $m(t)$，液滴直径为 $d(t)$，液滴温度为 $T_d(t)$。液滴面积为 $A(t) = \\pi d(t)^2$，质量与直径的关系为 $m(t) = \\rho_\\ell \\frac{\\pi}{6} d(t)^3$。气-滴相对速度大小为 $u_{rel}$。\n\n对于一个蒸发的液滴群，其控制常微分方程组（ODEs）带有用于人工解法（MMS）的附加源项，具体如下：\n- 质量平衡：$$\\frac{dm}{dt} = -\\dot{m}_e + S_m(t),$$\n- 能量平衡：$$m c_{p,\\ell} \\frac{dT_d}{dt} = h A (T_g - T_d) - \\dot{m}_e L_v + S_T(t),$$\n其中 $\\dot{m}_e$ 是蒸发质量速率，$h$ 是对流传热系数，$S_m(t)$ 和 $S_T(t)$ 是为使给定函数 $d(t)$ 和 $T_d(t)$ 成为该 ODEs 的精确解而选择的人工源项。\n\n使用球体周围传质和传热的标准关联式：\n- 雷诺数（Reynolds number）：$$Re = \\frac{\\rho_g u_{rel} d}{\\mu_g},$$\n- 施密特数（Schmidt number）：$$Sc = \\frac{\\mu_g}{\\rho_g D_v},$$\n- 普朗特数（Prandtl number）：$$Pr = \\frac{\\mu_g c_{p,g}}{k_g},$$\n- 舍伍德数（Sherwood number）：$$Sh = 2 + 0.6 Re^{1/2} Sc^{1/3},$$\n- 努塞尔数（Nusselt number）：$$Nu = 2 + 0.6 Re^{1/2} Pr^{1/3},$$\n- 传质系数：$$k_m = \\frac{Sh D_v}{d},$$\n- 传热系数：$$h = \\frac{Nu k_g}{d}.$$\n\n假设液滴表面的蒸汽质量分数由平衡饱和压力决定，该压力使用具有恒定潜热的积分形式 Clausius–Clapeyron 关系式计算：\n- 蒸汽比气体常数：$$R_v = \\frac{R_u}{M_v},$$\n- 饱和压力：$$p_{sat}(T_d) = p_{ref} \\exp\\left(-\\frac{L_v}{R_v}\\left(\\frac{1}{T_d} - \\frac{1}{T_{ref}}\\right)\\right),$$\n其中 $p_{ref}$ 和 $T_{ref}$ 为给定的参考值，\n- 表面蒸汽质量分数：$$Y_{v,s}(T_d) = \\frac{M_v p_{sat}(T_d)}{M_v p_{sat}(T_d) + M_{air} \\left(p - p_{sat}(T_d)\\right)}.$$\n蒸发速率被建模为对流传质通量：\n$$\\dot{m}_e = k_m A \\rho_g \\left(Y_{v,s}(T_d) - Y_{v,\\infty}\\right).$$\n\n人工解与源项。将直径和液滴温度设定为人工解：\n- 直径：$$d(t) = d_0 \\sqrt{1 - \\alpha t}, \\quad \\text{for } 0 \\le t  \\frac{1}{\\alpha},$$\n- 液滴温度：$$T_d(t) = T_{mean} + \\gamma \\sin(\\omega t).$$\n使用几何关系 $m(t) = \\rho_\\ell \\frac{\\pi}{6} d(t)^3$ 定义液滴质量。利用这些人工解 $d(t)$ 和 $T_d(t)$，通过将源项 $S_m(t)$ 和 $S_T(t)$ 定义为仅时间的函数来强制精确性，使得上述 ODEs 被人工解恒等满足。从基本平衡方程出发推导 $S_m(t)$ 和 $S_T(t)$：\n- 从 $m(t)$ 和 $d(t)$ 计算 $\\frac{dm}{dt}$，\n- 从 $T_d(t)$ 计算 $\\frac{dT_d}{dt}$，\n- 在关联式中使用人工解 $d(t)$ 和 $T_d(t)$ 来评估 $\\dot{m}_e(t)$ 和 $h(t)$，\n- 分别对平衡方程求解 $S_m(t)$ 和 $S_T(t)$。\n\n数值验证。实现一个二阶显式 Runge–Kutta 格式（也称为中点法），用以数值积分带有随时间变化的源项 $S_m(t)$ 和 $S_T(t)$ 的 ODE 系统：\n- 需要进行数值积分的 ODE 系统是：\n$$\\frac{dm}{dt} = -\\dot{m}_e(m,T_d,u_{rel}) + S_m(t),$$\n$$\\frac{dT_d}{dt} = \\frac{h(m,u_{rel}) A(m) (T_g - T_d) - \\dot{m}_e(m,T_d,u_{rel}) L_v + S_T(t)}{m c_{p,\\ell}},$$\n其中 $A(m) = \\pi d(m)^2$ 且 $d(m) = \\left(\\frac{6 m}{\\pi \\rho_\\ell}\\right)^{1/3}$，$\\dot{m}_e$ 和 $h$ 使用关联式，并代入瞬时数值 $d$ 和 $T_d$。\n\n从数值解 $m(t_i)$ 和 $T_d(t_i)$ 计算离散时间历程 $d_{num}(t_i)$ 和 $T_{num}(t_i)$，并与在相同时间网格上评估的精确人工解 $d(t_i)$ 和 $T_d(t_i)$ 进行比较。对于每个测试案例，报告两个无量纲的精度度量：\n- 直径的相对离散 $L^2$ 误差，\n$$\\varepsilon_d = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(d_{num}(t_i) - d(t_i)\\right)^2}{\\sum_{i=1}^{N} d(t_i)^2}},$$\n- 液滴温度的相对离散 $L^2$ 误差，\n$$\\varepsilon_T = \\sqrt{\\frac{\\sum_{i=1}^{N} \\left(T_{num}(t_i) - T_d(t_i)\\right)^2}{\\sum_{i=1}^{N} T_d(t_i)^2}}.$$\n这些误差是无量纲浮点数。\n\n参数值。使用以下符合物理现实的常数（全部采用国际单位制 (SI)）：\n- $\\rho_\\ell = 1000 \\,\\mathrm{kg/m^3}$, $c_{p,\\ell} = 4180 \\,\\mathrm{J/(kg\\cdot K)}$, $L_v = 2.26\\times 10^6 \\,\\mathrm{J/kg}$,\n- $\\rho_g = 1.2 \\,\\mathrm{kg/m^3}$, $\\mu_g = 1.8\\times 10^{-5} \\,\\mathrm{Pa\\cdot s}$, $k_g = 0.026 \\,\\mathrm{W/(m\\cdot K)}$, $c_{p,g} = 1005 \\,\\mathrm{J/(kg\\cdot K)}$,\n- $D_v = 2.5\\times 10^{-5} \\,\\mathrm{m^2/s}$, $R_u = 8.314462618 \\,\\mathrm{J/(mol\\cdot K)}$, $M_v = 18.01528\\times 10^{-3} \\,\\mathrm{kg/mol}$, $M_{air} = 28.97\\times 10^{-3} \\,\\mathrm{kg/mol}$,\n- $p = 101325 \\,\\mathrm{Pa}$, $T_g = 800 \\,\\mathrm{K}$, $Y_{v,\\infty} = 0.01$,\n- Clausius–Clapeyron 参考值：$p_{ref} = 611 \\,\\mathrm{Pa}$ 于 $T_{ref} = 273.15 \\,\\mathrm{K}$。\n\n人工解参数：\n- $d_0 = 100\\times 10^{-6} \\,\\mathrm{m}$, $\\alpha = 20 \\,\\mathrm{s^{-1}}$,\n- $T_{mean} = 300 \\,\\mathrm{K}$, $\\gamma = 10 \\,\\mathrm{K}$, $\\omega = 50 \\,\\mathrm{s^{-1}}$.\n\n数值积分的初始条件 $m(0)$ 和 $T_d(0)$ 取自 $t=0$ 时的人工解。\n\n测试套件。使用三个不同的参数集来测试求解器的精度：\n- 案例1（理想路径）：$u_{rel} = 1.0 \\,\\mathrm{m/s}$，时间步长 $\\Delta t = 1.0\\times 10^{-4} \\,\\mathrm{s}$，最终时间 $T_{end} = 0.02 \\,\\mathrm{s}$，\n- 案例2（边界情况，低对流）：$u_{rel} = 0.0 \\,\\mathrm{m/s}$，时间步长 $\\Delta t = 5.0\\times 10^{-5} \\,\\mathrm{s}$，最终时间 $T_{end} = 0.02 \\,\\mathrm{s}$，\n- 案例3（边缘情况，粗时间步长）：$u_{rel} = 1.0 \\,\\mathrm{m/s}$，时间步长 $\\Delta t = 1.0\\times 10^{-3} \\,\\mathrm{s}$，最终时间 $T_{end} = 0.02 \\,\\mathrm{s}$。\n\n您的任务：\n1. 推导使给定 $d(t)$ 和 $T_d(t)$ 成为 ODEs 精确人工解的 $S_m(t)$ 和 $S_T(t)$ 的显式公式。\n2. 实现一个程序，该程序：\n   - 使用给定的人工解和物理关联式，将 $S_m(t)$ 和 $S_T(t)$ 构建为随时间变化的函数，\n   - 对每个测试案例，使用二阶显式 Runge–Kutta 方法积分 ODEs，\n   - 计算每个案例的相对离散 $L^2$ 误差 $\\varepsilon_d$ 和 $\\varepsilon_T$。\n3. 将误差表示为无量纲浮点数。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序如下：\n$$[\\varepsilon_{d,1}, \\varepsilon_{T,1}, \\varepsilon_{d,2}, \\varepsilon_{T,2}, \\varepsilon_{d,3}, \\varepsilon_{T,3}].$$",
            "solution": "用户提供了一个问题，要求应用人工解法（Method of Manufactured Solutions, MMS）来验证一个用于求解描述喷雾液滴蒸发的常微分方程组（ODEs）的数值求解器。该过程包括两个主要阶段：首先，推导 MMS 所需的解析源项；其次，实现一个数值求解器，用这些源项对 ODEs 进行积分，并计算与已知人工解的误差。\n\n### 第1部分：人工源项的推导\n\n目标是找到源项 $S_m(t)$ 和 $S_T(t)$，使得给定的人工解 $d(t)$ 和 $T_d(t)$ 成为控制 ODEs 的精确解。\n\n控制 ODEs 为：\n1.  质量平衡：$\\frac{dm}{dt} = -\\dot{m}_e + S_m(t)$\n2.  能量平衡：$m c_{p,\\ell} \\frac{dT_d}{dt} = h A (T_g - T_d) - \\dot{m}_e L_v + S_T(t)$\n\n我们可以重新整理这些方程以求解源项：\n$$S_m(t) = \\frac{dm}{dt} + \\dot{m}_e(t)$$\n$$S_T(t) = m(t) c_{p,\\ell} \\frac{dT_d}{dt} - h(t) A(t) (T_g - T_d(t)) + \\dot{m}_e(t) L_v$$\n为了计算这些表达式，必须通过代入人工解，将右侧的每一项都表示为时间 $t$ 的函数。\n\n**人工解：**\n-   直径：$d(t) = d_0 \\sqrt{1 - \\alpha t}$\n-   温度：$T_d(t) = T_{mean} + \\gamma \\sin(\\omega t)$\n\n**步骤1.1：人工解的时间导数**\n液滴质量通过 $m(t) = \\rho_\\ell \\frac{\\pi}{6} d(t)^3$ 与直径相关。\n首先，我们求直径的时间导数 $\\frac{dd}{dt}$：\n$$\\frac{dd}{dt} = \\frac{d}{dt}\\left(d_0 (1 - \\alpha t)^{1/2}\\right) = d_0 \\left(\\frac{1}{2}\\right) (1 - \\alpha t)^{-1/2} (-\\alpha) = -\\frac{\\alpha d_0}{2\\sqrt{1 - \\alpha t}}$$\n由于 $d(t) = d_0 \\sqrt{1 - \\alpha t}$，我们可以写出 $\\sqrt{1 - \\alpha t} = d(t)/d_0$。代入此式得到：\n$$\\frac{dd}{dt} = -\\frac{\\alpha d_0}{2 (d(t)/d_0)} = -\\frac{\\alpha d_0^2}{2 d(t)}$$\n使用链式法则，我们求质量的时间导数 $\\frac{dm}{dt}$：\n$$\\frac{dm}{dt} = \\frac{d}{dt}\\left(\\rho_\\ell \\frac{\\pi}{6} d(t)^3\\right) = \\rho_\\ell \\frac{\\pi}{6} \\cdot 3d(t)^2 \\frac{dd}{dt} = \\rho_\\ell \\frac{\\pi}{2} d(t)^2 \\left(-\\frac{\\alpha d_0^2}{2 d(t)}\\right)$$\n$$\\frac{dm}{dt}(t) = -\\frac{\\pi}{4} \\rho_\\ell \\alpha d_0^2 d(t)$$\n\n液滴温度的时间导数 $\\frac{dT_d}{dt}$ 很直接：\n$$\\frac{dT_d}{dt}(t) = \\frac{d}{dt}\\left(T_{mean} + \\gamma \\sin(\\omega t)\\right) = \\gamma \\omega \\cos(\\omega t)$$\n\n**步骤1.2：基于人工解的物理属性**\n所有物理属性必须使用 $d(t)$ 和 $T_d(t)$ 进行评估。为了清晰起见，我们用下标 'man' 来表示这些随时间变化的属性。\n- 雷诺数（Reynolds number）：$Re_{man}(t) = \\frac{\\rho_g u_{rel} d(t)}{\\mu_g}$\n- 无量纲数 $Sc = \\frac{\\mu_g}{\\rho_g D_v}$ 和 $Pr = \\frac{\\mu_g c_{p,g}}{k_g}$ 是常数。\n- 舍伍德数（Sherwood number）：$Sh_{man}(t) = 2 + 0.6 Re_{man}(t)^{1/2} Sc^{1/3}$\n- 努塞尔数（Nusselt number）：$Nu_{man}(t) = 2 + 0.6 Re_{man}(t)^{1/2} Pr^{1/3}$\n- 液滴表面积：$A(t) = \\pi d(t)^2$\n\n蒸发率 $\\dot{m}_e(t)$ 由 $\\dot{m}_e = k_m A \\rho_g (Y_{v,s} - Y_{v,\\infty})$ 给出。\n- 传质系数：$k_{m,man}(t) = \\frac{Sh_{man}(t) D_v}{d(t)}$\n- $\\dot{m}_{e,man}(t) = \\left(\\frac{Sh_{man}(t) D_v}{d(t)}\\right) (\\pi d(t)^2) \\rho_g (Y_{v,s,man}(t) - Y_{v,\\infty})$\n$$\\dot{m}_{e,man}(t) = \\pi D_v \\rho_g d(t) Sh_{man}(t) (Y_{v,s,man}(t) - Y_{v,\\infty})$$\n其中 $Y_{v,s,man}(t)$ 是表面蒸汽质量分数，它通过 Clausius-Clapeyron 关系式依赖于 $T_d(t)$：\n- 蒸汽饱和压力：$p_{sat,man}(t) = p_{ref} \\exp\\left(-\\frac{L_v}{R_v}\\left(\\frac{1}{T_d(t)} - \\frac{1}{T_{ref}}\\right)\\right)$\n- 表面蒸汽质量分数：$Y_{v,s,man}(t) = \\frac{M_v p_{sat,man}(t)}{M_v p_{sat,man}(t) + M_{air} (p - p_{sat,man}(t))}$\n\n传热项 $h(t)A(t)$ 的计算方式类似：\n- 传热系数：$h_{man}(t) = \\frac{Nu_{man}(t) k_g}{d(t)}$\n- 传热项：$(hA)_{man}(t) = \\left(\\frac{Nu_{man}(t) k_g}{d(t)}\\right)(\\pi d(t)^2) = \\pi k_g d(t) Nu_{man}(t)$\n\n**步骤1.3：源项的最终表达式**\n将这些随时间变化的表达式代入 $S_m(t)$ 和 $S_T(t)$ 的方程中：\n$$S_m(t) = -\\frac{\\pi}{4} \\rho_\\ell \\alpha d_0^2 d(t) + \\dot{m}_{e,man}(t)$$\n$$S_T(t) = \\left(\\rho_\\ell \\frac{\\pi}{6} d(t)^3\\right) c_{p,\\ell} (\\gamma \\omega \\cos(\\omega t)) - (hA)_{man}(t) (T_g - T_d(t)) + \\dot{m}_{e,man}(t) L_v$$\n\n这些方程为 MMS 验证提供了所需的显式、随时间变化的源项。\n\n### 第2部分：数值积分与误差分析\n\n任务是使用二阶显式 Runge-Kutta（中点）方法对原始 ODE 系统进行数值积分。状态向量为 $\\mathbf{y} = [m, T_d]^T$。系统为 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$。\n\n**步骤2.1：用于数值积分的ODE系统**\n函数 $\\mathbf{f}(t, \\mathbf{y})$ 代表 ODEs 的右侧：\n$$\\mathbf{f}(t, \\mathbf{y}) = \\begin{bmatrix} f_m(t, m, T_d) \\\\ f_T(t, m, T_d) \\end{bmatrix}$$\n其中：\n$$f_m(t, m, T_d) = -\\dot{m}_e(m, T_d) + S_m(t)$$\n$$f_T(t, m, T_d) = \\frac{h(m) A(m) (T_g - T_d) - \\dot{m}_e(m, T_d) L_v + S_T(t)}{m c_{p,\\ell}}$$\n在这里，物理项 $\\dot{m}_e$ 和 $hA$ 是在积分的每个阶段使用*当前的数值状态* $(m, T_d)$ 计算的，而源项 $S_m(t)$ 和 $S_T(t)$ 是在相应时间 $t$ 使用*解析的人工解*评估的。\n\n**步骤2.2：中点法 (RK2)**\n对于时间步长 $\\Delta t$，从 $t_i$ 时的状态 $\\mathbf{y}_i$ 前进到 $t_{i+1} = t_i + \\Delta t$ 时的状态如下：\n1.  计算区间开始处的斜率：\n    $$\\mathbf{k}_1 = \\mathbf{f}(t_i, \\mathbf{y}_i)$$\n2.  估计区间中点处的状态：\n    $$\\mathbf{y}_{mid} = \\mathbf{y}_i + \\frac{\\Delta t}{2} \\mathbf{k}_1$$\n3.  计算中点处的斜率：\n    $$\\mathbf{k}_2 = \\mathbf{f}(t_i + \\frac{\\Delta t}{2}, \\mathbf{y}_{mid})$$\n4.  将解推进到下一个时间步：\n    $$\\mathbf{y}_{i+1} = \\mathbf{y}_i + \\Delta t \\mathbf{k}_2$$\n\n**步骤2.3：实现与误差计算**\n数值计算步骤如下：\n1.  在 $t=0$ 时使用人工解初始化数值解：$m_{num}(0) = m(0)$ 和 $T_{d,num}(0) = T_d(0)$。\n2.  创建一个时间网格 $t_i = i\\Delta t$，其中 $i=0, 1, \\ldots, N$，且 $N=T_{end}/\\Delta t$。\n3.  从 $i=0$ 迭代到 $N-1$，在每一步应用 RK2 方法从 $\\mathbf{y}_i$ 求得 $\\mathbf{y}_{i+1}$。\n4.  存储数值结果 $d_{num}(t_i)$ 和 $T_{d,num}(t_i)$，其中 $d_{num}$ 从 $m_{num}$ 导出，使用 $d = (6m/(\\pi\\rho_\\ell))^{1/3}$。\n5.  同时，在相同网格上计算并存储精确值 $d(t_i)$ 和 $T_d(t_i)$。\n6.  最后，使用指定的公式在时间点 $t_1, \\ldots, t_N$ 上计算相对离散 $L^2$ 误差 $\\varepsilon_d$ 和 $\\varepsilon_T$。\n\n此过程将对三个测试案例中的每一个重复进行，这些案例在 $u_{rel}$ 和 $\\Delta t$ 上有所不同，以评估数值格式在不同条件下的准确性。对于二阶格式，预期的行为是误差随时间步长 $\\Delta t$ 的减小而呈二次方下降。比较案例1（$\\Delta t = 10^{-4}$）和案例3（$\\Delta t = 10^{-3}$，步长增大10倍），我们预计案例3中的误差大约是案例1中误差的 $10^2 = 100$ 倍。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the droplet evaporation MMS problem, calculates errors for three test cases,\n    and prints the results in the specified format.\n    \"\"\"\n\n    class Params:\n        # Liquid properties (water)\n        rho_l = 1000.0  # kg/m^3\n        c_p_l = 4180.0  # J/(kg.K)\n        L_v = 2.26e6   # J/kg\n\n        # Gas properties (air)\n        rho_g = 1.2      # kg/m^3\n        mu_g = 1.8e-5    # Pa.s\n        k_g = 0.026      # W/(m.K)\n        c_p_g = 1005.0   # J/(kg.K)\n\n        # Mass transfer properties\n        D_v = 2.5e-5     # m^2/s\n        R_u = 8.314462618 # J/(mol.K)\n        M_v = 18.01528e-3 # kg/mol (water)\n        M_air = 28.97e-3  # kg/mol\n\n        # Ambient conditions\n        p_inf = 101325.0 # Pa\n        T_g = 800.0      # K\n        Y_v_inf = 0.01   # kg/kg\n\n        # Clausius-Clapeyron reference\n        p_ref = 611.0    # Pa\n        T_ref = 273.15   # K\n\n        # Manufactured solution parameters\n        d0 = 100.0e-6    # m\n        alpha = 20.0     # 1/s\n        T_mean = 300.0   # K\n        gamma = 10.0     # K\n        omega = 50.0     # 1/s\n\n        # Calculated constants\n        R_v = R_u / M_v\n        Sc = mu_g / (rho_g * D_v)\n        Pr = mu_g * c_p_g / k_g\n\n    p = Params()\n\n    # --- Manufactured Solutions and their Derivatives ---\n    def d_man(t):\n        val = 1.0 - p.alpha * t\n        if val = 0: return 0.0\n        return p.d0 * np.sqrt(val)\n\n    def Td_man(t):\n        return p.T_mean + p.gamma * np.sin(p.omega * t)\n\n    def m_man(t):\n        return p.rho_l * np.pi / 6.0 * d_man(t)**3\n\n    def dmdt_man(t):\n        return - (np.pi / 4.0) * p.rho_l * p.alpha * p.d0**2 * d_man(t)\n\n    def dTd_dt_man(t):\n        return p.gamma * p.omega * np.cos(p.omega * t)\n\n    # --- Core Physics Calculation ---\n    def calc_phys_props(d_val, Td_val, u_rel):\n        if d_val == 0:\n            return 0.0, 0.0\n\n        # Reynolds number\n        Re = p.rho_g * u_rel * d_val / p.mu_g\n\n        # Sherwood and Nusselt numbers\n        Sh = 2.0 + 0.6 * np.sqrt(Re) * p.Sc**(1/3)\n        Nu = 2.0 + 0.6 * np.sqrt(Re) * p.Pr**(1/3)\n\n        # Vapor saturation pressure\n        p_sat = p.p_ref * np.exp(-(p.L_v / p.R_v) * (1.0 / Td_val - 1.0 / p.T_ref))\n\n        # Surface vapor mass fraction\n        Y_v_s_num = p.M_v * p_sat\n        Y_v_s_den = Y_v_s_num + p.M_air * (p.p_inf - p_sat)\n        Y_v_s = Y_v_s_num / Y_v_s_den if Y_v_s_den != 0 else 0\n\n        # Evaporation rate\n        m_dot_e = np.pi * p.D_v * p.rho_g * d_val * Sh * (Y_v_s - p.Y_v_inf)\n        \n        # Heat transfer term h*A\n        hA = np.pi * p.k_g * d_val * Nu\n\n        return m_dot_e, hA\n\n    # --- Manufactured Source Terms ---\n    def S_m(t, u_rel):\n        d_val = d_man(t)\n        if d_val == 0: return 0.0\n        \n        m_dot_e_man, _ = calc_phys_props(d_val, Td_man(t), u_rel)\n        return dmdt_man(t) + m_dot_e_man\n\n    def S_T(t, u_rel):\n        d_val = d_man(t)\n        if d_val == 0: return 0.0\n        \n        Td_val = Td_man(t)\n        m_val = m_man(t)\n        \n        m_dot_e_man, hA_man = calc_phys_props(d_val, Td_val, u_rel)\n        \n        term1 = m_val * p.c_p_l * dTd_dt_man(t)\n        term2 = hA_man * (p.T_g - Td_val)\n        term3 = m_dot_e_man * p.L_v\n        \n        return term1 - term2 + term3\n\n    # --- ODE System RHS ---\n    def ode_rhs(t, y, u_rel):\n        m_num, Td_num = y\n        \n        if m_num = 0:\n            return np.array([0.0, 0.0])\n        \n        d_num = (6.0 * m_num / (np.pi * p.rho_l))**(1/3)\n        \n        m_dot_e_num, hA_num = calc_phys_props(d_num, Td_num, u_rel)\n        \n        dmdt = -m_dot_e_num + S_m(t, u_rel)\n        dTd_dt = (hA_num * (p.T_g - Td_num) - m_dot_e_num * p.L_v + S_T(t, u_rel)) / (m_num * p.c_p_l)\n        \n        return np.array([dmdt, dTd_dt])\n\n    # --- Main Loop for a Single Test Case ---\n    def run_case(u_rel, dt, T_end):\n        num_steps = int(round(T_end / dt))\n        times = np.linspace(0, T_end, num_steps + 1)\n        \n        # Initialize arrays for numerical and exact solutions\n        y_num = np.zeros((num_steps + 1, 2))\n        d_num = np.zeros(num_steps + 1)\n        \n        d_exact = np.zeros(num_steps + 1)\n        Td_exact = np.zeros(num_steps + 1)\n        \n        # Initial conditions from manufactured solution\n        y_num[0, 0] = m_man(0.0)\n        y_num[0, 1] = Td_man(0.0)\n        \n        # RK2 (Midpoint method) integration loop\n        for i in range(num_steps):\n            t_i = times[i]\n            y_i = y_num[i]\n            \n            k1 = ode_rhs(t_i, y_i, u_rel)\n            y_mid = y_i + 0.5 * dt * k1\n            k2 = ode_rhs(t_i + 0.5 * dt, y_mid, u_rel)\n            \n            y_num[i+1] = y_i + dt * k2\n\n        # Post-process to get all diameter and temperature histories\n        for i in range(num_steps + 1):\n            m_i = y_num[i, 0]\n            d_num[i] = (6.0 * m_i / (np.pi * p.rho_l))**(1/3) if m_i > 0 else 0\n            d_exact[i] = d_man(times[i])\n            Td_exact[i] = Td_man(times[i])\n        \n        Td_num = y_num[:, 1]\n        \n        # Calculate L2 relative errors (excluding the initial point at t=0)\n        d_err_sq_sum = np.sum((d_num[1:] - d_exact[1:])**2)\n        d_exact_sq_sum = np.sum(d_exact[1:]**2)\n        eps_d = np.sqrt(d_err_sq_sum / d_exact_sq_sum) if d_exact_sq_sum > 0 else 0\n\n        T_err_sq_sum = np.sum((Td_num[1:] - Td_exact[1:])**2)\n        T_exact_sq_sum = np.sum(Td_exact[1:]**2)\n        eps_T = np.sqrt(T_err_sq_sum / T_exact_sq_sum) if T_exact_sq_sum > 0 else 0\n\n        return eps_d, eps_T\n\n    test_cases = [\n        {'u_rel': 1.0, 'dt': 1.0e-4, 'T_end': 0.02}, # Case 1\n        {'u_rel': 0.0, 'dt': 5.0e-5, 'T_end': 0.02}, # Case 2\n        {'u_rel': 1.0, 'dt': 1.0e-3, 'T_end': 0.02}, # Case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        eps_d, eps_T = run_case(case['u_rel'], case['dt'], case['T_end'])\n        results.extend([eps_d, eps_T])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "拉格朗日包裹法本质上是一种随机方法，使用过少的包裹会导致显著的统计噪声，从而污染模拟结果。本练习将演示如何运用基本的统计学原理，估算为达到源项计算所需的精度而要投入的包裹数量，从而在计算成本和模型保真度之间取得平衡。",
            "id": "3364885",
            "problem": "在一个时间步内，由于由拉格朗日粒子表示的注入液体的蒸发，单个计算流体动力学 (CFD) 单元接收蒸汽质量源。液体喷射率为 $\\dot{m}_{\\ell} = 5.0 \\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$，时间步长为 $\\Delta t = 5.0 \\times 10^{-3}\\,\\mathrm{s}$。在一个时间步内，注入 $N$ 个粒子，每个粒子携带相等的液体质量 $m_{p} = \\dot{m}_{\\ell}\\,\\Delta t / N$。对于一个给定的单元，在一个时间步内，每个粒子在该单元内蒸发的液体质量分数由独立同分布的随机变量 $X_{i}$ 建模，其均值为 $\\mu_{f} = 0.70$，标准差为 $\\sigma_{f} = 0.21$，且与 $m_{p}$ 无关。在一个时间步内添加到单元中的估计蒸汽质量源是蒸发质量的总和 $\\sum_{i=1}^{N} m_{p} X_{i}$，再除以单元体积，但为了随机准确性的目的，只有源估计值的相对变异性是重要的。\n\n将单个时间步内估计源的变异系数 $\\epsilon$ 定义为估计量的标准差与均值之比。从独立同分布随机变量之和的均值和方差的基本定义，以及变异系数的定义出发，推导出一个 $\\epsilon$ 作为 $N$、$\\mu_{f}$ 和 $\\sigma_{f}$ 函数的表达式。利用此关系，确定为达到目标变异系数 $\\epsilon = 3.0 \\times 10^{-2}$ 所需的每个时间步的粒子数。此外，一个使用每个时间步 $N_{\\text{ref}} = 25$ 个粒子的初步运行产生了一个与给定的 $X_{i}$ 统计数据一致的变异系数。使用该初步运行通过参考缩放论证来交叉检验你的结果。\n\n将最终答案表示为 $N$ 的单个整数值（无量纲）。除了精确计算外，不需要进行舍入。",
            "solution": "该问题要求确定在喷雾蒸发的 CFD 模拟中，为达到指定的统计精度水平所需的拉格朗日粒子数 $N$。该精度由单元中估计的蒸汽质量源的变异系数 $\\epsilon$ 来量化。\n\n首先，我们必须验证问题陈述。\n步骤 1：提取给定信息。\n- 液体喷射率：$\\dot{m}_{\\ell} = 5.0 \\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$\n- 时间步长：$\\Delta t = 5.0 \\times 10^{-3}\\,\\mathrm{s}$\n- 每个时间步注入的粒子数：$N$\n- 单个粒子的质量：$m_{p} = \\dot{m}_{\\ell}\\,\\Delta t / N$\n- 粒子质量的蒸发分数：$X_{i}$，其中 $i$ 的范围从 $1$到 $N$。这些是独立同分布 (i.i.d.) 的随机变量。\n- 蒸发分数的均值：$\\mu_{f} = 0.70$\n- 蒸发分数的标准差：$\\sigma_{f} = 0.21$\n- 目标变异系数：$\\epsilon = 3.0 \\times 10^{-2}$\n- 参考粒子数：$N_{\\text{ref}} = 25$\n\n步骤 2：使用提取的给定信息进行验证。\n该问题具有科学依据，采用了统计力学和计算流体动力学 (CFD) 的标准概念，特别是拉格朗日粒子追踪和随机源项建模。问题提法明确，提供了推导唯一解所需的所有信息。对于喷雾蒸发情景，这些参数在物理上是合理的。问题是客观的，并使用了精确的术语。没有内部矛盾、歧义或违反科学原理的地方。\n\n步骤 3：结论与行动。\n问题有效。我们继续进行解答。\n\n在一个时间步 $\\Delta t$ 内，单元内蒸发的液体总质量是单元中 $N$ 个粒子各自蒸发质量的总和。这个总蒸发质量，我们称之为 $M_{evap}$，是一个随机变量，由下式给出：\n$$M_{evap} = \\sum_{i=1}^{N} m_{p} X_{i}$$\n问题陈述指出，单元的估计蒸汽质量源与此量成正比（具体来说，是 $M_{evap}$ 除以单元体积）。变异系数 $\\epsilon$ 定义为该估计量的标准差与其均值之比。由于单元体积是一个常数，它将从该比率中消去。因此，我们可以直接用 $M_{evap}$ 来定义 $\\epsilon$：\n$$\\epsilon = \\frac{\\sqrt{Var(M_{evap})}}{E[M_{evap}]}$$\n这里，$E[\\cdot]$ 表示期望值（均值），$Var(\\cdot)$ 表示方差。\n\n首先，我们计算 $M_{evap}$ 的均值。利用期望的线性性质：\n$$E[M_{evap}] = E\\left[\\sum_{i=1}^{N} m_{p} X_{i}\\right]$$\n由于对于给定的 $N$，$m_{p}$ 是一个常数，它可以从期望中提取出来：\n$$E[M_{evap}] = \\sum_{i=1}^{N} E[m_{p} X_{i}] = \\sum_{i=1}^{N} m_{p} E[X_{i}]$$\n随机变量 $X_i$ 是同分布的，均值为 $\\mu_f$。因此，对于所有的 $i$，都有 $E[X_i] = \\mu_f$。\n$$E[M_{evap}] = \\sum_{i=1}^{N} m_{p} \\mu_{f} = N m_{p} \\mu_{f}$$\n\n接下来，我们计算 $M_{evap}$ 的方差。由于随机变量 $X_i$ 是独立的，它们之和的方差等于它们方差之和：\n$$Var(M_{evap}) = Var\\left(\\sum_{i=1}^{N} m_{p} X_{i}\\right) = \\sum_{i=1}^{N} Var(m_{p} X_{i})$$\n使用性质 $Var(aY) = a^2 Var(Y)$，其中 $a$ 是常数，Y 是随机变量，我们有：\n$$Var(M_{evap}) = \\sum_{i=1}^{N} m_{p}^2 Var(X_{i})$$\n随机变量 $X_i$ 是同分布的，标准差为 $\\sigma_f$，所以它们的方差是 $Var(X_i) = \\sigma_{f}^2$。\n$$Var(M_{evap}) = \\sum_{i=1}^{N} m_{p}^2 \\sigma_{f}^2 = N m_{p}^2 \\sigma_{f}^2$$\n\n$M_{evap}$ 的标准差是其方差的平方根：\n$$\\sqrt{Var(M_{evap})} = \\sqrt{N m_{p}^2 \\sigma_{f}^2} = m_{p} \\sigma_{f} \\sqrt{N}$$\n\n现在我们可以推导出变异系数 $\\epsilon$ 的表达式：\n$$\\epsilon = \\frac{\\sqrt{Var(M_{evap})}}{E[M_{evap}]} = \\frac{m_{p} \\sigma_{f} \\sqrt{N}}{N m_{p} \\mu_{f}}$$\n粒子质量 $m_p$ 被消去，这是预料之中的，因为 $\\epsilon$ 是相对变异性的度量。\n$$\\epsilon = \\frac{\\sigma_{f} \\sqrt{N}}{N \\mu_{f}} = \\frac{\\sigma_{f}}{\\mu_{f} \\sqrt{N}}$$\n这就是 $\\epsilon$、$N$、$\\mu_f$ 和 $\\sigma_f$ 之间所需的关系。\n\n为了求出达到目标变异系数 $\\epsilon$ 所需的粒子数 $N$，我们重新整理这个方程：\n$$\\sqrt{N} = \\frac{\\sigma_{f}}{\\mu_{f} \\epsilon}$$\n$$N = \\left(\\frac{\\sigma_{f}}{\\mu_{f} \\epsilon}\\right)^2$$\n我们给定的值为 $\\mu_f = 0.70$、$\\sigma_f = 0.21$ 以及目标值 $\\epsilon = 3.0 \\times 10^{-2}$。代入这些值：\n$$N = \\left(\\frac{0.21}{0.70 \\times (3.0 \\times 10^{-2})}\\right)^2$$\n$$N = \\left(\\frac{0.21}{0.70 \\times 0.03}\\right)^2 = \\left(\\frac{0.21}{0.021}\\right)^2 = (10)^2 = 100$$\n所以，每个时间步需要 100 个粒子。\n\n最后，我们使用参考缩放论证进行交叉检验。推导出的关系 $\\epsilon = \\frac{\\sigma_f / \\mu_f}{\\sqrt{N}}$ 意味着 $\\epsilon \\propto 1/\\sqrt{N}$。因此，对于两个不同的运行 $(N_1, \\epsilon_1)$ 和 $(N_2, \\epsilon_2)$，以下缩放定律成立：\n$$\\epsilon_1 \\sqrt{N_1} = \\epsilon_2 \\sqrt{N_2}$$\n设参考运行为状态 1，其中 $N_1 = N_{\\text{ref}} = 25$。这次运行的变异系数 $\\epsilon_{\\text{ref}}$ 为：\n$$\\epsilon_{\\text{ref}} = \\frac{\\sigma_{f}}{\\mu_{f} \\sqrt{N_{\\text{ref}}}} = \\frac{0.21}{0.70 \\sqrt{25}} = \\frac{0.3}{5} = 0.06$$\n设目标运行为状态 2，其中 $\\epsilon_2 = \\epsilon = 0.03 = 3.0 \\times 10^{-2}$。我们需要求出 $N_2 = N$。\n使用缩放定律：\n$$N = N_2 = N_1 \\left(\\frac{\\epsilon_1}{\\epsilon_2}\\right)^2 = N_{\\text{ref}} \\left(\\frac{\\epsilon_{\\text{ref}}}{\\epsilon}\\right)^2$$\n$$N = 25 \\left(\\frac{0.06}{0.03}\\right)^2 = 25 \\times (2)^2 = 25 \\times 4 = 100$$\n交叉检验证实了通过直接计算得到的结果。每个时间步所需的粒子数是 100。",
            "answer": "$$\\boxed{100}$$"
        },
        {
            "introduction": "将质量、动量和能量从连续运动的拉格朗日包裹精确地传递到离散、固定的欧拉网格是一项挑战，简单的处理方式可能会违反基本守恒定律。本练习将展示如何在一个时间步内，将单个包裹的源项贡献精确地分配给其穿越的多个网格，从而保证质量和能量的严格守恒。",
            "id": "3364858",
            "problem": "在一个一维计算流体动力学（CFD）域中，一个拉格朗日喷雾包裹在一个全局时间步内穿过多个欧拉网格单元。每个有限体积单元内的质量和能量的局部守恒要求，由包裹蒸发和热交换引起的欧拉源项，等于包裹在该单元内停留期间的时间累积交换量。该域被划分为三个相邻的单元，界面位置分别为 $x = 0$、$x = 2.0 \\times 10^{-3}\\ \\text{m}$、$x = 5.0 \\times 10^{-3}\\ \\text{m}$ 和 $x = 9.0 \\times 10^{-3}\\ \\text{m}$。一个拉格朗日包裹，初始位置为 $x(0) = 1.0 \\times 10^{-3}\\ \\text{m}$，在一个持续时间为 $\\Delta t = 4.0 \\times 10^{-3}\\ \\text{s}$ 的欧拉时间步内，以恒定速度 $u_{p} = 2.0\\ \\text{m}\\,\\text{s}^{-1}$ 移动。因此，在时间区间 $t \\in [0,\\Delta t]$ 内，包裹依次穿过单元1、单元2和单元3。\n\n在此步长中，包裹的蒸发质量损失率（从液体到气体）是时间 $t$ 的预定函数，由 $\\dot{m}_{e}(t) = \\alpha + \\beta t$ 给出，其中 $\\alpha = 8.0 \\times 10^{-7}\\ \\text{kg}\\,\\text{s}^{-1}$ 且 $\\beta = 1.0 \\times 10^{-4}\\ \\text{kg}\\,\\text{s}^{-2}$。包裹向气相的净焓传递率（包括显热和潜热效应，合并为从包裹到气体的单一净热传递）为 $\\dot{Q}(t) = \\eta - \\zeta t$，其中 $\\eta = 1.25\\ \\text{W}$ 且 $\\zeta = 50.0\\ \\text{W}\\,\\text{s}^{-1}$。为了计算停留时间，假设相对于包裹运动，气体流动是静止的，并且忽略在此时间步内欧拉场对 $\\dot{m}_{e}(t)$ 和 $\\dot{Q}(t)$ 的任何反馈。\n\n使用质量和能量守恒以及由 $x(t) = x(0) + u_{p} t$ 所暗示的运动学停留时间，确定必须分配给每个单元的总蒸发质量分数和总传递焓分数，以使跨越所穿过单元的总和与包裹在 $[0,\\Delta t]$ 上的总交换量完全匹配。按顺序 $\\left(f_{1}^{(m)}, f_{2}^{(m)}, f_{3}^{(m)}, f_{1}^{(Q)}, f_{2}^{(Q)}, f_{3}^{(Q)}\\right)$ 提供六个无量纲分数，其中 $f_{i}^{(m)}$ 是单元 $i = 1,2,3$ 的质量分数，$f_{i}^{(Q)}$ 是焓分数。\n\n将每个分数四舍五入到六位有效数字。将您的答案表示为单行矩阵。分数是无量纲的；最终数值中不包括单位。",
            "solution": "合适的基本依据是质量守恒和热力学第一定律（能量守恒），应用于每个有限体积单元上的一个时间间隔，并结合包裹运动的运动学。对于一个与欧拉控制体交换质量和能量的拉格朗日包裹，一个时间间隔内的欧拉源项等于包裹在该控制体内停留期间包裹交换率的时间积分。因此，如果包裹在时间子区间 $I_{i} \\subset [0,\\Delta t]$ 内占据单元 $i$，则该单元中增加到气体中的质量和焓为\n$$\n\\Delta m_{i} = \\int_{I_{i}} \\dot{m}_{e}(t)\\, dt,\\qquad \\Delta Q_{i} = \\int_{I_{i}} \\dot{Q}(t)\\, dt.\n$$\n在该步长内的总交换量为\n$$\n\\Delta m_{\\text{tot}} = \\int_{0}^{\\Delta t} \\dot{m}_{e}(t)\\, dt,\\qquad \\Delta Q_{\\text{tot}} = \\int_{0}^{\\Delta t} \\dot{Q}(t)\\, dt.\n$$\n为实现精确守恒，分配给每个单元的分数为\n$$\nf_{i}^{(m)} = \\frac{\\Delta m_{i}}{\\Delta m_{\\text{tot}}},\\qquad f_{i}^{(Q)} = \\frac{\\Delta Q_{i}}{\\Delta Q_{\\text{tot}}}.\n$$\n\n我们首先根据运动学确定停留时间的子区间。包裹的位置是 $x(t) = x(0) + u_{p} t$，其中 $x(0) = 1.0 \\times 10^{-3}\\ \\text{m}$ 且 $u_{p} = 2.0\\ \\text{m}\\,\\text{s}^{-1}$。包裹穿过单元界面的时间是 $x(t) = 2.0 \\times 10^{-3}\\ \\text{m}$、$x(t) = 5.0 \\times 10^{-3}\\ \\text{m}$ 和 $x(t) = 9.0 \\times 10^{-3}\\ \\text{m}$ 的解。这些时间是\n$$\nt_{1} = \\frac{2.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 5.0 \\times 10^{-4}\\ \\text{s},\\quad\nt_{2} = \\frac{5.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 2.0 \\times 10^{-3}\\ \\text{s},\\quad\nt_{3} = \\frac{9.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 4.0 \\times 10^{-3}\\ \\text{s}.\n$$\n因此，子区间为 $I_{1} = [0,\\, 5.0 \\times 10^{-4}]$、$I_{2} = [5.0 \\times 10^{-4},\\, 2.0 \\times 10^{-3}]$ 和 $I_{3} = [2.0 \\times 10^{-3},\\, 4.0 \\times 10^{-3}]$。\n\n接下来，我们计算每个子区间上给定速率的时间积分。对于蒸发率 $\\dot{m}_{e}(t) = \\alpha + \\beta t$，其中 $\\alpha = 8.0 \\times 10^{-7}\\ \\text{kg}\\,\\text{s}^{-1}$ 且 $\\beta = 1.0 \\times 10^{-4}\\ \\text{kg}\\,\\text{s}^{-2}$，我们有\n$$\n\\int_{a}^{b} (\\alpha + \\beta t)\\, dt = \\alpha (b-a) + \\frac{1}{2}\\beta\\left(b^{2} - a^{2}\\right).\n$$\n使用 $I_{1}$，其中 $a_{1} = 0$ 且 $b_{1} = 5.0 \\times 10^{-4}$，\n$$\n\\Delta m_{1} = \\alpha (5.0 \\times 10^{-4} - 0) + \\frac{1}{2}\\beta\\left((5.0 \\times 10^{-4})^{2} - 0^{2}\\right) = (8.0 \\times 10^{-7})(5.0 \\times 10^{-4}) + \\frac{1}{2}(1.0 \\times 10^{-4})(2.5 \\times 10^{-7}).\n$$\n在数值上，\n$$\n\\Delta m_{1} = 4.0 \\times 10^{-10} + 1.25 \\times 10^{-11} = 4.125 \\times 10^{-10}.\n$$\n对于 $I_{2}$，其中 $a_{2} = 5.0 \\times 10^{-4}$ 且 $b_{2} = 2.0 \\times 10^{-3}$，\n$$\n\\Delta m_{2} = \\alpha (1.5 \\times 10^{-3}) + \\frac{1}{2}\\beta\\left((2.0 \\times 10^{-3})^{2} - (5.0 \\times 10^{-4})^{2}\\right) = (8.0 \\times 10^{-7})(1.5 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(3.75 \\times 10^{-6}),\n$$\n所以\n$$\n\\Delta m_{2} = 1.2 \\times 10^{-9} + 1.875 \\times 10^{-10} = 1.3875 \\times 10^{-9}.\n$$\n对于 $I_{3}$，其中 $a_{3} = 2.0 \\times 10^{-3}$ 且 $b_{3} = 4.0 \\times 10^{-3}$，\n$$\n\\Delta m_{3} = \\alpha (2.0 \\times 10^{-3}) + \\frac{1}{2}\\beta\\left((4.0 \\times 10^{-3})^{2} - (2.0 \\times 10^{-3})^{2}\\right) = (8.0 \\times 10^{-7})(2.0 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(12.0 \\times 10^{-6}),\n$$\n得到\n$$\n\\Delta m_{3} = 1.6 \\times 10^{-9} + 6.0 \\times 10^{-10} = 2.2 \\times 10^{-9}.\n$$\n总质量传递为\n$$\n\\Delta m_{\\text{tot}} = \\alpha \\Delta t + \\frac{1}{2}\\beta \\Delta t^{2} = (8.0 \\times 10^{-7})(4.0 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(16.0 \\times 10^{-6}) = 3.2 \\times 10^{-9} + 0.8 \\times 10^{-9} = 4.0 \\times 10^{-9}.\n$$\n因此，质量分数为\n$$\nf_{1}^{(m)} = \\frac{4.125 \\times 10^{-10}}{4.0 \\times 10^{-9}} = 0.103125,\\quad\nf_{2}^{(m)} = \\frac{1.3875 \\times 10^{-9}}{4.0 \\times 10^{-9}} = 0.346875,\\quad\nf_{3}^{(m)} = \\frac{2.2 \\times 10^{-9}}{4.0 \\times 10^{-9}} = 0.55.\n$$\n\n对于焓率 $\\dot{Q}(t) = \\eta - \\zeta t$，其中 $\\eta = 1.25\\ \\text{W}$ 且 $\\zeta = 50.0\\ \\text{W}\\,\\text{s}^{-1}$，在 $[a,b]$ 上的积分为\n$$\n\\int_{a}^{b} (\\eta - \\zeta t)\\, dt = \\eta (b-a) - \\frac{1}{2}\\zeta\\left(b^{2} - a^{2}\\right).\n$$\n在 $I_{1}$ 上，\n$$\n\\Delta Q_{1} = \\eta (5.0 \\times 10^{-4}) - \\frac{1}{2}\\zeta\\left((5.0 \\times 10^{-4})^{2} - 0^{2}\\right) = (1.25)(5.0 \\times 10^{-4}) - \\frac{1}{2}(50.0)(2.5 \\times 10^{-7}),\n$$\n所以\n$$\n\\Delta Q_{1} = 6.25 \\times 10^{-4} - 6.25 \\times 10^{-6} = 6.1875 \\times 10^{-4}.\n$$\n在 $I_{2}$ 上，\n$$\n\\Delta Q_{2} = \\eta (1.5 \\times 10^{-3}) - \\frac{1}{2}\\zeta\\left((2.0 \\times 10^{-3})^{2} - (5.0 \\times 10^{-4})^{2}\\right) = (1.25)(1.5 \\times 10^{-3}) - \\frac{1}{2}(50.0)(3.75 \\times 10^{-6}),\n$$\n得出\n$$\n\\Delta Q_{2} = 1.875 \\times 10^{-3} - 9.375 \\times 10^{-5} = 1.78125 \\times 10^{-3}.\n$$\n在 $I_{3}$ 上，\n$$\n\\Delta Q_{3} = \\eta (2.0 \\times 10^{-3}) - \\frac{1}{2}\\zeta\\left((4.0 \\times 10^{-3})^{2} - (2.0 \\times 10^{-3})^{2}\\right) = (1.25)(2.0 \\times 10^{-3}) - \\frac{1}{2}(50.0)(12.0 \\times 10^{-6}),\n$$\n得到\n$$\n\\Delta Q_{3} = 2.5 \\times 10^{-3} - 3.0 \\times 10^{-4} = 2.2 \\times 10^{-3}.\n$$\n总焓传递为\n$$\n\\Delta Q_{\\text{tot}} = \\eta \\Delta t - \\frac{1}{2}\\zeta \\Delta t^{2} = (1.25)(4.0 \\times 10^{-3}) - \\frac{1}{2}(50.0)(16.0 \\times 10^{-6}) = 5.0 \\times 10^{-3} - 4.0 \\times 10^{-4} = 4.6 \\times 10^{-3}.\n$$\n因此，焓分数为\n$$\nf_{1}^{(Q)} = \\frac{6.1875 \\times 10^{-4}}{4.6 \\times 10^{-3}} \\approx 0.134510869565,\\quad\nf_{2}^{(Q)} = \\frac{1.78125 \\times 10^{-3}}{4.6 \\times 10^{-3}} \\approx 0.387228260870,\\quad\nf_{3}^{(Q)} = \\frac{2.2 \\times 10^{-3}}{4.6 \\times 10^{-3}} = \\frac{11}{23} \\approx 0.478260869565.\n$$\n根据构造，$\\sum_{i=1}^{3} f_{i}^{(m)} = 1$ 且 $\\sum_{i=1}^{3} f_{i}^{(Q)} = 1$，满足守恒。将每个分数四舍五入到六位有效数字，得到\n$$\nf_{1}^{(m)} = 0.103125,\\quad f_{2}^{(m)} = 0.346875,\\quad f_{3}^{(m)} = 0.550000,\\quad f_{1}^{(Q)} = 0.134511,\\quad f_{2}^{(Q)} = 0.387228,\\quad f_{3}^{(Q)} = 0.478261.\n$$\n所需的输出是按指定顺序排列的单行矩阵。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.103125  0.346875  0.550000  0.134511  0.387228  0.478261\\end{pmatrix}}$$"
        }
    ]
}