{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的喷雾模型之前，我们必须首先掌握单个液滴的基本物理过程。本练习将引导你从第一性原理出发，推导出一个正在蒸发的球形液滴内部的瞬态温度分布，这对于理解液滴加热和相变的内在机制至关重要。通过求解包含对流和蒸发边界条件的瞬态热传导方程，你将能深刻体会到内部热传导与表面传热传质之间的相互作用，并为后续更高级的数值模型打下坚实的物理基础。",
            "id": "3364889",
            "problem": "一个半径为 $R$、热导率为 $k_{\\ell}$、密度为 $\\rho_{\\ell}$、比热为 $c_{p,\\ell}$、热扩散率为 $\\alpha_{\\ell} = k_{\\ell}/(\\rho_{\\ell} c_{p,\\ell})$ 的球形液滴被注入到热气体环境中。环境气体温度在空间上是均匀的，等于 $T_{\\infty}$，液滴的初始温度在空间上也是均匀的，等于 $T_{i}$。液滴表面的气侧对流传热系数为 $h$，液滴以稳定的界面质量通量 $\\dot{m}''$ 蒸发，蒸发潜热为 $L$。假设气膜是准稳态的，并且在热瞬态过程中，液滴表面温度 $T_{s}$ 近似恒定（湿球近似）。界面能量平衡将从液体流出的传导热通量与传入的对流通量减去蒸发带走的潜热等同起来。在此模型假设下，您可以用一个有效的对流传热系数 $h_{e}$ 来表示界面能量平衡，该系数耦合了外部对流和蒸发。\n\n忽略热瞬态过程中液滴半径的变化（内部热扩散与较慢的 $D^{2}$ 定律半径演化之间的时间尺度分离），并通过在 $r=R$ 处具有对流型边界条件的球内瞬态热传导来模拟内部温度场。仅使用适用于计算流体动力学（CFD）的第一性原理——液体中的能量守恒、通过界面能量平衡编码的基于菲克扩散的界面准稳态蒸发，以及球体的毕渥数（Bi）的定义——推导对于任意、恒定的有效毕渥数 $\\mathrm{Bi}_{e} = h_{e} R / k_{\\ell}$，液滴体积平均温度 $T_{d}(t)$ 的精确解析表达式。您的推导必须从球坐标系下的热方程和界面能量平衡开始，通过分离变量法进行，并确保中心线处具有适当的正则性。\n\n将最终答案表示为 $T_{d}(t)$ 的单个闭合形式级数，用 $R$、$\\alpha_{\\ell}$、$k_{\\ell}$、$h$、$\\dot{m}''$、$L$、$T_{\\infty}$ 和 $T_{i}$ 来表达。答案必须是单个解析表达式（而不是一组方程或不等式）。最终答案中不要包含物理单位。如果您引入任何无量纲参数，请在推导中明确定义它们。",
            "solution": "该问题要求推导正在经历瞬态加热和蒸发的球形液滴的体积平均温度 $T_d(t)$。推导必须从第一性原理开始。\n\n**1. 问题建模**\n\n球对称介质内瞬态热传导的控制方程是球坐标系下的热方程。假设温度 $T$ 仅随径向位置 $r$ 和时间 $t$ 变化，该方程为：\n$$ \\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial T}{\\partial r} \\right) = \\frac{1}{\\alpha_{\\ell}} \\frac{\\partial T}{\\partial t} $$\n其中 $\\alpha_{\\ell} = k_{\\ell}/(\\rho_{\\ell} c_{p,\\ell})$ 是液体热扩散率。此方程在 $0 \\le r \\le R$ 和 $t > 0$ 时有效。\n\n该问题受以下初始条件和边界条件的约束：\n\n初始条件 (IC)：液滴初始时处于均匀温度 $T_i$。\n$$ T(r, 0) = T_i \\quad \\text{for} \\quad 0 \\le r \\le R $$\n\n边界条件 1 (BC1)：在球心（$r=0$）处，温度场必须是正则的。由于球对称性，这意味着温度梯度为零：\n$$ \\frac{\\partial T}{\\partial r} \\Big|_{r=0} = 0 $$\n\n边界条件 2 (BC2)：在液滴表面（$r=R$）处，给出了界面能量平衡。从液体内部传出的传导热通量与来自气体的净热通量相平衡，后者是来自环境气体的对流传热减去蒸发消耗的能量。\n$$ -k_{\\ell} \\frac{\\partial T}{\\partial r} \\Big|_{r=R} = h(T_{\\infty} - T(R,t)) - \\dot{m}'' L $$\n此处，$h$ 是对流传热系数，$T_{\\infty}$ 是环境温度，$T(R,t)$ 是瞬时表面温度，$\\dot{m}''$ 是蒸发质量通量，$L$ 是蒸发潜热。问题陈述 $\\dot{m}''$ 是一个常数。\n\n这个边界条件是罗宾（或第三类）边界条件。可以通过定义一个有效环境温度 $T_{e,\\infty}$ 将其重排为更标准的形式：\n$$ -k_{\\ell} \\frac{\\partial T}{\\partial r} \\Big|_{r=R} = h \\left( \\left( T_{\\infty} - \\frac{\\dot{m}'' L}{h} \\right) - T(R,t) \\right) $$\n我们将有效环境温度定义为 $T_{e,\\infty} = T_{\\infty} - \\frac{\\dot{m}'' L}{h}$。BC2 变为：\n$$ -k_{\\ell} \\frac{\\partial T}{\\partial r} \\Big|_{r=R} = h (T_{e,\\infty} - T(R,t)) $$\n\n**2. 问题齐次化**\n\n所述问题具有非齐次边界条件。将问题转换为具有齐次边界条件的问题会更方便。我们定义一个新的温度变量 $\\theta(r,t)$，作为瞬态温度与最终稳态温度之差。稳态温度在整个球体内将是均匀的，等于有效环境温度 $T_{e,\\infty}$。\n$$ \\theta(r,t) = T(r,t) - T_{e,\\infty} $$\n$\\theta(r,t)$ 的控制方程和条件是：\nPDE（偏微分方程）：$\\frac{1}{r^2} \\frac{\\partial}{\\partial r} \\left( r^2 \\frac{\\partial \\theta}{\\partial r} \\right) = \\frac{1}{\\alpha_{\\ell}} \\frac{\\partial \\theta}{\\partial t}$\nIC（初始条件）：$\\theta(r,0) = T(r,0) - T_{e,\\infty} = T_i - T_{e,\\infty}$\nBC1（边界条件1）：$\\frac{\\partial \\theta}{\\partial r} \\Big|_{r=0} = 0$\nBC2（边界条件2）：$-k_{\\ell} \\frac{\\partial \\theta}{\\partial r} \\Big|_{r=R} = h (T_{e,\\infty} - (\\theta(R,t) + T_{e,\\infty})) = -h \\theta(R,t)$，简化为 $k_{\\ell} \\frac{\\partial \\theta}{\\partial r} \\Big|_{r=R} + h \\theta(R,t) = 0$。\n\n**3. 分离变量法**\n\n我们使用分离变量法求解 $\\theta(r,t)$。假设解的形式为：\n$$ \\theta(r,t) = F(r)G(t) $$\n代入偏微分方程并分离变量，得到：\n$$ \\frac{1}{F(r)} \\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dF}{dr} \\right) = \\frac{1}{\\alpha_{\\ell}} \\frac{1}{G(t)} \\frac{dG}{dt} = -\\lambda^2 $$\n其中 $-\\lambda^2$ 是分离常数。这得到两个常微分方程：\n\n时间方程：$\\frac{dG}{dt} + \\lambda^2 \\alpha_{\\ell} G = 0$。其解为 $G(t) = C \\exp(-\\lambda^2 \\alpha_{\\ell} t)$。\n\n空间方程：$\\frac{1}{r^2} \\frac{d}{dr} \\left( r^2 \\frac{dF}{dr} \\right) + \\lambda^2 F = 0$。这可以通过代换 $F(r) = u(r)/r$ 来简化。$u(r)$ 的方程变为：\n$$ \\frac{d^2 u}{dr^2} + \\lambda^2 u = 0 $$\n$u(r)$ 的通解是 $u(r) = A \\sin(\\lambda r) + B \\cos(\\lambda r)$，因此 $F(r)$ 的解是：\n$$ F(r) = \\frac{A \\sin(\\lambda r) + B \\cos(\\lambda r)}{r} $$\n\n**4. 应用边界条件求特征值**\n\n我们将空间边界条件应用于 $F(r)$ 来确定常数 $A$、$B$ 和特征值 $\\lambda_n$。\n\nBC1（$r=0$ 处的正则性）：当 $r \\to 0$ 时，$F(r)$ 必须保持有限。项 $\\cos(\\lambda r)/r$ 像 $1/r$ 一样发散。因此，我们必须有 $B=0$。于是空间解的形式为：\n$$ F(r) = A \\frac{\\sin(\\lambda r)}{r} $$\n\nBC2（表面对流）：$k_{\\ell} \\frac{dF}{dr} \\Big|_{r=R} + h F(R) = 0$。\n导数为 $\\frac{dF}{dr} = A \\frac{\\lambda r \\cos(\\lambda r) - \\sin(\\lambda r)}{r^2}$。\n代入边界条件：\n$$ k_{\\ell} A \\left( \\frac{\\lambda R \\cos(\\lambda R) - \\sin(\\lambda R)}{R^2} \\right) + h A \\left( \\frac{\\sin(\\lambda R)}{R} \\right) = 0 $$\n对于非平凡解（$A \\neq 0$），我们必须有：\n$$ k_{\\ell} (\\lambda R \\cos(\\lambda R) - \\sin(\\lambda R)) + h R \\sin(\\lambda R) = 0 $$\n整理后得到特征值 $\\lambda_n$ 的特征方程：\n$$ \\lambda R \\cos(\\lambda R) = (1 - \\frac{hR}{k_{\\ell}}) \\sin(\\lambda R) $$\n让我们定义毕渥数 $\\mathrm{Bi} = hR/k_{\\ell}$ 和无量纲特征值 $\\beta_n = \\lambda_n R$。特征方程变为：\n$$ \\beta_n \\cot(\\beta_n) = 1 - \\mathrm{Bi} $$\n对于 $n=1, 2, 3, \\ldots$ 的值 $\\beta_n$ 是这个超越方程的正根。\n\n**5. 通解和系数的计算**\n\n$\\theta(r,t)$ 的通解是所有特征值上乘积解的无穷级数和：\n$$ \\theta(r,t) = \\sum_{n=1}^{\\infty} A_n \\frac{\\sin(\\lambda_n r)}{r} \\exp(-\\lambda_n^2 \\alpha_{\\ell} t) $$\n系数 $A_n$ 由初始条件 $\\theta(r,0) = T_i - T_{e,\\infty}$ 利用特征函数 $\\phi_n(r) = \\frac{\\sin(\\lambda_n r)}{r}$ 在区间 $[0, R]$ 上关于权函数 $w(r)=r^2$ 的正交性来确定。\n$$ A_n = \\frac{\\int_0^R \\theta(r,0) \\phi_n(r) r^2 dr}{\\int_0^R \\phi_n(r)^2 r^2 dr} = \\frac{(T_i - T_{e,\\infty}) \\int_0^R r \\sin(\\lambda_n r) dr}{\\int_0^R \\sin^2(\\lambda_n r) dr} $$\n计算积分：\n分子积分：$\\int_0^R r \\sin(\\lambda_n r) dr = \\frac{\\sin(\\lambda_n R) - \\lambda_n R \\cos(\\lambda_n R)}{\\lambda_n^2} = \\frac{R^2}{\\beta_n^2}(\\sin\\beta_n - \\beta_n\\cos\\beta_n)$。\n分母积分：$\\int_0^R \\sin^2(\\lambda_n r) dr = \\frac{R}{2} - \\frac{\\sin(2\\lambda_n R)}{4\\lambda_n} = \\frac{R}{2} - \\frac{R\\sin(2\\beta_n)}{4\\beta_n}$。\n\n使用特征方程 $\\beta_n\\cos\\beta_n = (1-\\mathrm{Bi})\\sin\\beta_n$，分子积分项变为 $\\sin\\beta_n - \\beta_n\\cos\\beta_n = \\sin\\beta_n - (1-\\mathrm{Bi})\\sin\\beta_n = \\mathrm{Bi}\\sin\\beta_n$。\n分母积分可以简化为 $\\frac{R}{2\\beta_n^2}(\\beta_n^2+\\mathrm{Bi}^2-\\mathrm{Bi})$。\n因此，系数为：\n$$ A_n = (T_i - T_{e,\\infty}) \\frac{\\frac{R^2}{\\beta_n^2}(\\mathrm{Bi}\\sin\\beta_n)}{\\frac{R}{2} - \\frac{R\\sin(2\\beta_n)}{4\\beta_n}} = (T_i - T_{e,\\infty}) \\frac{2R \\mathrm{Bi} \\sin\\beta_n}{\\beta_n^2 - (1-\\mathrm{Bi})\\sin^2\\beta_n} $$\n\n**6. 体积平均温度的推导**\n\n体积平均液滴温度 $T_d(t)$ 定义为：\n$$ T_d(t) = \\frac{1}{V} \\int_V T(r,t) dV = \\frac{1}{\\frac{4}{3}\\pi R^3} \\int_0^R T(r,t) 4\\pi r^2 dr = \\frac{3}{R^3} \\int_0^R T(r,t) r^2 dr $$\n代入 $T(r,t) = T_{e,\\infty} + \\theta(r,t)$：\n$$ T_d(t) = \\frac{3}{R^3} \\int_0^R (T_{e,\\infty} + \\theta(r,t)) r^2 dr = T_{e,\\infty} + \\frac{3}{R^3} \\int_0^R \\theta(r,t) r^2 dr $$\n现在，我们代入 $\\theta(r,t)$ 的级数解：\n$$ T_d(t) = T_{e,\\infty} + \\frac{3}{R^3} \\int_0^R \\left( \\sum_{n=1}^{\\infty} A_n \\frac{\\sin(\\lambda_n r)}{r} \\exp(-\\lambda_n^2 \\alpha_{\\ell} t) \\right) r^2 dr $$\n交换求和与积分：\n$$ T_d(t) = T_{e,\\infty} + \\frac{3}{R^3} \\sum_{n=1}^{\\infty} A_n \\exp(-\\lambda_n^2 \\alpha_{\\ell} t) \\int_0^R r \\sin(\\lambda_n r) dr $$\n使用之前计算的积分 $\\int_0^R r \\sin(\\lambda_n r) dr = \\frac{R^2}{\\beta_n^2}(\\mathrm{Bi}\\sin\\beta_n)$：\n$$ T_d(t) - T_{e,\\infty} = \\frac{3}{R^3} \\sum_{n=1}^{\\infty} A_n \\exp(-\\lambda_n^2 \\alpha_{\\ell} t) \\frac{R^2}{\\beta_n^2}(\\mathrm{Bi}\\sin\\beta_n) $$\n代入 $A_n$ 的表达式：\n$$ T_d(t) - T_{e,\\infty} = \\frac{3}{R} \\sum_{n=1}^{\\infty} \\left( (T_i - T_{e,\\infty}) \\frac{2R \\mathrm{Bi} \\sin\\beta_n}{\\beta_n^2 - (1-\\mathrm{Bi})\\sin^2\\beta_n} \\right) \\frac{\\mathrm{Bi}\\sin\\beta_n}{\\beta_n^2} \\exp(-\\lambda_n^2 \\alpha_{\\ell} t) $$\n$$ T_d(t) - T_{e,\\infty} = (T_i - T_{e,\\infty}) \\sum_{n=1}^{\\infty} \\frac{6 \\mathrm{Bi}^2 \\sin^2\\beta_n}{\\beta_n^2 (\\beta_n^2 - (1-\\mathrm{Bi})\\sin^2\\beta_n)} \\exp(-\\beta_n^2 \\frac{\\alpha_{\\ell} t}{R^2}) $$\n这个系数表达式可以使用从特征方程推导出的 $\\sin^2\\beta_n = \\frac{\\beta_n^2}{\\beta_n^2 + (1-\\mathrm{Bi})^2}$ 来简化。系数变为：\n$$ C_n = \\frac{6 \\mathrm{Bi}^2}{\\beta_n^2 (\\beta_n^2 + \\mathrm{Bi}^2 - \\mathrm{Bi})} $$\n体积平均温度的解是：\n$$ T_d(t) = T_{e,\\infty} + (T_i - T_{e,\\infty}) \\sum_{n=1}^{\\infty} \\frac{6 \\mathrm{Bi}^2}{\\beta_n^2 (\\beta_n^2 + \\mathrm{Bi}^2 - \\mathrm{Bi})} \\exp\\left(-\\beta_n^2 \\frac{\\alpha_{\\ell} t}{R^2}\\right) $$\n\n**7. 最终表达式**\n最后，我们将 $T_{e,\\infty}$ 和 $\\mathrm{Bi}$ 的定义代回，用原始问题参数表示答案。\n$T_{e,\\infty} = T_{\\infty} - \\frac{\\dot{m}'' L}{h}$\n$\\mathrm{Bi} = \\frac{hR}{k_{\\ell}}$\n特征值 $\\beta_n$ 是 $\\beta \\cot(\\beta) = 1 - \\frac{hR}{k_{\\ell}}$ 的正根。\n\n最终表达式是：\n$$ T_d(t) = \\left( T_{\\infty} - \\frac{\\dot{m}'' L}{h} \\right) + \\left( T_i - T_{\\infty} + \\frac{\\dot{m}'' L}{h} \\right) \\sum_{n=1}^{\\infty} \\frac{6 \\left(\\frac{hR}{k_{\\ell}}\\right)^2}{\\beta_n^2 \\left(\\beta_n^2 + \\left(\\frac{hR}{k_{\\ell}}\\right)^2 - \\frac{hR}{k_{\\ell}}\\right)} \\exp\\left(-\\beta_n^2 \\frac{\\alpha_{\\ell} t}{R^2}\\right) $$\n其中 $\\beta_n$ 是 $\\beta \\cot(\\beta) = 1 - \\frac{hR}{k_{\\ell}}$ 的正根。这是所要求的单个闭合形式的级数解。",
            "answer": "$$\\boxed{\\left( T_{\\infty} - \\frac{\\dot{m}'' L}{h} \\right) + \\left( T_i - T_{\\infty} + \\frac{\\dot{m}'' L}{h} \\right) \\sum_{n=1}^{\\infty} \\frac{6 \\left(\\frac{hR}{k_{\\ell}}\\right)^2}{\\beta_n^2 \\left(\\beta_n^2 + \\left(\\frac{hR}{k_{\\ell}}\\right)^2 - \\frac{hR}{k_{\\ell}}\\right)} \\exp\\left(-\\beta_n^2 \\frac{\\alpha_{\\ell} t}{R^2}\\right), \\quad \\text{其中 } \\beta_n \\text{ 是 } \\beta_n \\cot(\\beta_n) = 1 - \\frac{hR}{k_{\\ell}} \\text{ 的正根}}$$"
        },
        {
            "introduction": "在计算流体力学中，将离散的拉格朗日粒子（如液滴）与连续的欧拉网格进行耦合是模拟喷雾的关键步骤。本练习关注一个核心的实际问题：当一个液滴在一个时间步内穿越多个网格时，如何精确地分配其产生的质量和能量源项，以确保整个计算域的严格守恒。通过解决这个运动学和守恒定律相结合的问题，你将掌握实现精确、稳定耦合的核心算法，这是开发可靠喷雾模拟程序的必备技能。",
            "id": "3364858",
            "problem": "在一个一维计算流体动力学 (CFD) 域中，一个拉格朗日喷雾包裹体在一个全局时间步长内穿过多个欧拉单元。每个有限体积单元中的局部质量和能量守恒要求，由包裹体蒸发和热交换引起的欧拉源项，等于包裹体在该单元内停留期间的时间累积交换量。该域被划分为三个相邻的单元，界面位于 $x = 0$、$x = 2.0 \\times 10^{-3}\\ \\text{m}$、$x = 5.0 \\times 10^{-3}\\ \\text{m}$ 和 $x = 9.0 \\times 10^{-3}\\ \\text{m}$。一个初始位置为 $x(0) = 1.0 \\times 10^{-3}\\ \\text{m}$ 的拉格朗日包裹体，在一个持续时间为 $\\Delta t = 4.0 \\times 10^{-3}\\ \\text{s}$ 的欧拉时间步长内，以恒定速度 $u_{p} = 2.0\\ \\text{m}\\,\\text{s}^{-1}$ 移动。因此，在时间区间 $t \\in [0,\\Delta t]$ 内，包裹体依次穿过单元1、单元2和单元3。\n\n在此步长期间，包裹体的蒸发质量损失率（从液相到气相）是时间的预设函数，由 $\\dot{m}_{e}(t) = \\alpha + \\beta t$ 给出，其中 $\\alpha = 8.0 \\times 10^{-7}\\ \\text{kg}\\,\\text{s}^{-1}$ 且 $\\beta = 1.0 \\times 10^{-4}\\ \\text{kg}\\,\\text{s}^{-2}$。包裹体向气相的净焓传递率（包括显热和潜热效应，合并为从包裹体到气相的单一净传热）为 $\\dot{Q}(t) = \\eta - \\zeta t$，其中 $\\eta = 1.25\\ \\text{W}$ 且 $\\zeta = 50.0\\ \\text{W}\\,\\text{s}^{-1}$。为了计算停留时间，假设相对于包裹体运动，气体流动是静止的，并忽略在此时间步长内欧拉场对 $\\dot{m}_{e}(t)$ 和 $\\dot{Q}(t)$ 的任何反馈。\n\n使用质量和能量守恒以及由 $x(t) = x(0) + u_{p} t$ 所隐含的运动学停留时间，确定必须分配给每个单元的总蒸发质量分数和总传递焓分数，以使所有穿越单元的总和与包裹体在 $[0,\\Delta t]$ 上的总交换量完全匹配。按顺序 $\\left(f_{1}^{(m)}, f_{2}^{(m)}, f_{3}^{(m)}, f_{1}^{(Q)}, f_{2}^{(Q)}, f_{3}^{(Q)}\\right)$ 提供六个无量纲分数，其中 $f_{i}^{(m)}$ 是质量分数，$f_{i}^{(Q)}$ 是单元 $i = 1,2,3$ 的焓分数。\n\n将每个分数四舍五入到六位有效数字。将你的答案表示为单行矩阵。分数是无量纲的；最终数值中不包含单位。",
            "solution": "合适的基本依据是质量守恒和热力学第一定律（能量守恒），应用于每个有限体积单元上的一个时间区间，并结合包裹体运动的运动学。对于与欧拉控制体积交换质量和能量的拉格朗日包裹体，一个时间区间内的欧拉源项等于包裹体在该控制体积内停留期间其交换率的时间积分。因此，如果包裹体在时间子区间 $I_{i} \\subset [0,\\Delta t]$ 内占据单元 $i$，则该单元中气体增加的质量和焓为\n$$\n\\Delta m_{i} = \\int_{I_{i}} \\dot{m}_{e}(t)\\, dt,\\qquad \\Delta Q_{i} = \\int_{I_{i}} \\dot{Q}(t)\\, dt.\n$$\n该步长内的总交换量为\n$$\n\\Delta m_{\\text{tot}} = \\int_{0}^{\\Delta t} \\dot{m}_{e}(t)\\, dt,\\qquad \\Delta Q_{\\text{tot}} = \\int_{0}^{\\Delta t} \\dot{Q}(t)\\, dt.\n$$\n为确保精确守恒，分配给每个单元的分数为\n$$\nf_{i}^{(m)} = \\frac{\\Delta m_{i}}{\\Delta m_{\\text{tot}}},\\qquad f_{i}^{(Q)} = \\frac{\\Delta Q_{i}}{\\Delta Q_{\\text{tot}}}.\n$$\n\n我们首先根据运动学确定停留时间子区间。包裹体的位置是 $x(t) = x(0) + u_{p} t$，其中 $x(0) = 1.0 \\times 10^{-3}\\ \\text{m}$ 且 $u_{p} = 2.0\\ \\text{m}\\,\\text{s}^{-1}$。包裹体穿过单元界面的时间是 $x(t) = 2.0 \\times 10^{-3}\\ \\text{m}$、$x(t) = 5.0 \\times 10^{-3}\\ \\text{m}$ 和 $x(t) = 9.0 \\times 10^{-3}\\ \\text{m}$ 的解。这些时间是\n$$\nt_{1} = \\frac{2.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 5.0 \\times 10^{-4}\\ \\text{s},\\quad\nt_{2} = \\frac{5.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 2.0 \\times 10^{-3}\\ \\text{s},\\quad\nt_{3} = \\frac{9.0 \\times 10^{-3} - 1.0 \\times 10^{-3}}{2.0} = 4.0 \\times 10^{-3}\\ \\text{s}.\n$$\n因此，子区间为 $I_{1} = [0,\\, 5.0 \\times 10^{-4}]$、$I_{2} = [5.0 \\times 10^{-4},\\, 2.0 \\times 10^{-3}]$ 和 $I_{3} = [2.0 \\times 10^{-3},\\, 4.0 \\times 10^{-3}]$。\n\n接下来，我们计算给定速率在每个子区间上的时间积分。对于蒸发率 $\\dot{m}_{e}(t) = \\alpha + \\beta t$，其中 $\\alpha = 8.0 \\times 10^{-7}\\ \\text{kg}\\,\\text{s}^{-1}$ 且 $\\beta = 1.0 \\times 10^{-4}\\ \\text{kg}\\,\\text{s}^{-2}$，我们有\n$$\n\\int_{a}^{b} (\\alpha + \\beta t)\\, dt = \\alpha (b-a) + \\frac{1}{2}\\beta\\left(b^{2} - a^{2}\\right).\n$$\n使用 $I_{1}$，其中 $a_{1} = 0$ 和 $b_{1} = 5.0 \\times 10^{-4}$，\n$$\n\\Delta m_{1} = \\alpha (5.0 \\times 10^{-4} - 0) + \\frac{1}{2}\\beta\\left((5.0 \\times 10^{-4})^{2} - 0^{2}\\right) = (8.0 \\times 10^{-7})(5.0 \\times 10^{-4}) + \\frac{1}{2}(1.0 \\times 10^{-4})(2.5 \\times 10^{-7}).\n$$\n数值计算结果为，\n$$\n\\Delta m_{1} = 4.0 \\times 10^{-10} + 1.25 \\times 10^{-11} = 4.125 \\times 10^{-10}.\n$$\n对于 $I_{2}$，其中 $a_{2} = 5.0 \\times 10^{-4}$ 和 $b_{2} = 2.0 \\times 10^{-3}$，\n$$\n\\Delta m_{2} = \\alpha (1.5 \\times 10^{-3}) + \\frac{1}{2}\\beta\\left((2.0 \\times 10^{-3})^{2} - (5.0 \\times 10^{-4})^{2}\\right) = (8.0 \\times 10^{-7})(1.5 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(3.75 \\times 10^{-6}),\n$$\n所以\n$$\n\\Delta m_{2} = 1.2 \\times 10^{-9} + 1.875 \\times 10^{-10} = 1.3875 \\times 10^{-9}.\n$$\n对于 $I_{3}$，其中 $a_{3} = 2.0 \\times 10^{-3}$ 和 $b_{3} = 4.0 \\times 10^{-3}$，\n$$\n\\Delta m_{3} = \\alpha (2.0 \\times 10^{-3}) + \\frac{1}{2}\\beta\\left((4.0 \\times 10^{-3})^{2} - (2.0 \\times 10^{-3})^{2}\\right) = (8.0 \\times 10^{-7})(2.0 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(12.0 \\times 10^{-6}),\n$$\n得到\n$$\n\\Delta m_{3} = 1.6 \\times 10^{-9} + 6.0 \\times 10^{-10} = 2.2 \\times 10^{-9}.\n$$\n总质量传递为\n$$\n\\Delta m_{\\text{tot}} = \\alpha \\Delta t + \\frac{1}{2}\\beta \\Delta t^{2} = (8.0 \\times 10^{-7})(4.0 \\times 10^{-3}) + \\frac{1}{2}(1.0 \\times 10^{-4})(16.0 \\times 10^{-6}) = 3.2 \\times 10^{-9} + 0.8 \\times 10^{-9} = 4.0 \\times 10^{-9}.\n$$\n因此，质量分数为\n$$\nf_{1}^{(m)} = \\frac{4.125 \\times 10^{-10}}{4.0 \\times 10^{-9}} = 0.103125,\\quad\nf_{2}^{(m)} = \\frac{1.3875 \\times 10^{-9}}{4.0 \\times 10^{-9}} = 0.346875,\\quad\nf_{3}^{(m)} = \\frac{2.2 \\times 10^{-9}}{4.0 \\times 10^{-9}} = 0.55.\n$$\n\n对于焓率 $\\dot{Q}(t) = \\eta - \\zeta t$，其中 $\\eta = 1.25\\ \\text{W}$ 且 $\\zeta = 50.0\\ \\text{W}\\,\\text{s}^{-1}$，在 $[a,b]$ 上的积分为\n$$\n\\int_{a}^{b} (\\eta - \\zeta t)\\, dt = \\eta (b-a) - \\frac{1}{2}\\zeta\\left(b^{2} - a^{2}\\right).\n$$\n在 $I_{1}$ 上，\n$$\n\\Delta Q_{1} = \\eta (5.0 \\times 10^{-4}) - \\frac{1}{2}\\zeta\\left((5.0 \\times 10^{-4})^{2} - 0^{2}\\right) = (1.25)(5.0 \\times 10^{-4}) - \\frac{1}{2}(50.0)(2.5 \\times 10^{-7}),\n$$\n所以\n$$\n\\Delta Q_{1} = 6.25 \\times 10^{-4} - 6.25 \\times 10^{-6} = 6.1875 \\times 10^{-4}.\n$$\n在 $I_{2}$ 上，\n$$\n\\Delta Q_{2} = \\eta (1.5 \\times 10^{-3}) - \\frac{1}{2}\\zeta\\left((2.0 \\times 10^{-3})^{2} - (5.0 \\times 10^{-4})^{2}\\right) = (1.25)(1.5 \\times 10^{-3}) - \\frac{1}{2}(50.0)(3.75 \\times 10^{-6}),\n$$\n得到\n$$\n\\Delta Q_{2} = 1.875 \\times 10^{-3} - 9.375 \\times 10^{-5} = 1.78125 \\times 10^{-3}.\n$$\n在 $I_{3}$ 上，\n$$\n\\Delta Q_{3} = \\eta (2.0 \\times 10^{-3}) - \\frac{1}{2}\\zeta\\left((4.0 \\times 10^{-3})^{2} - (2.0 \\times 10^{-3})^{2}\\right) = (1.25)(2.0 \\times 10^{-3}) - \\frac{1}{2}(50.0)(12.0 \\times 10^{-6}),\n$$\n得到\n$$\n\\Delta Q_{3} = 2.5 \\times 10^{-3} - 3.0 \\times 10^{-4} = 2.2 \\times 10^{-3}.\n$$\n总焓传递为\n$$\n\\Delta Q_{\\text{tot}} = \\eta \\Delta t - \\frac{1}{2}\\zeta \\Delta t^{2} = (1.25)(4.0 \\times 10^{-3}) - \\frac{1}{2}(50.0)(16.0 \\times 10^{-6}) = 5.0 \\times 10^{-3} - 4.0 \\times 10^{-4} = 4.6 \\times 10^{-3}.\n$$\n因此，焓分数为\n$$\nf_{1}^{(Q)} = \\frac{6.1875 \\times 10^{-4}}{4.6 \\times 10^{-3}} \\approx 0.134510869565,\\quad\nf_{2}^{(Q)} = \\frac{1.78125 \\times 10^{-3}}{4.6 \\times 10^{-3}} \\approx 0.387228260870,\\quad\nf_{3}^{(Q)} = \\frac{2.2 \\times 10^{-3}}{4.6 \\times 10^{-3}} = \\frac{11}{23} \\approx 0.478260869565.\n$$\n根据构造，$\\sum_{i=1}^{3} f_{i}^{(m)} = 1$ 且 $\\sum_{i=1}^{3} f_{i}^{(Q)} = 1$，满足守恒定律。将每个分数四舍五入到六位有效数字，得到\n$$\nf_{1}^{(m)} = 0.103125,\\quad f_{2}^{(m)} = 0.346875,\\quad f_{3}^{(m)} = 0.550000,\\quad f_{1}^{(Q)} = 0.134511,\\quad f_{2}^{(Q)} = 0.387228,\\quad f_{3}^{(Q)} = 0.478261.\n$$\n所需输出是按指定顺序排列的单行矩阵。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.103125  0.346875  0.550000  0.134511  0.387228  0.478261\\end{pmatrix}}$$"
        },
        {
            "introduction": "拉格朗日喷雾模型使用有限数量的“计算包裹”来代表数以百万计的真实液滴，这引入了固有的统计不确定性。本练习旨在揭示计算成本与模拟精度之间的重要权衡，让你能够基于统计学原理来量化和控制数值噪声。通过推导源项的变异系数与计算包裹数量之间的关系，你将学会如何估算为达到特定精度目标所需的包裹数量，这是优化喷雾模拟计算效率和可靠性的关键一步。",
            "id": "3364885",
            "problem": "在一个时间步内，由于注入的由拉格朗日粒子表示的液体蒸发，单个计算流体动力学 (CFD) 单元接收到一个蒸汽质量源。液体注入速率为 $\\dot{m}_{\\ell} = 5.0 \\times 10^{-4}\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$，时间步为 $\\Delta t = 5.0 \\times 10^{-3}\\,\\mathrm{s}$。在一个时间步内，注入了 $N$ 个粒子，每个粒子携带相等的液体质量 $m_{p} = \\dot{m}_{\\ell}\\,\\Delta t / N$。对于一个给定的单元，在该时间步内，每个粒子在单元内部的液体质量的蒸发分数由独立同分布的随机变量 $X_{i}$ 建模，其均值为 $\\mu_{f} = 0.70$，标准差为 $\\sigma_{f} = 0.21$，且与 $m_{p}$ 无关。在一个时间步内添加到单元的估计蒸汽质量源是蒸发质量的总和 $\\sum_{i=1}^{N} m_{p} X_{i}$ 除以单元体积，但为了随机准确性的目的，只有源项估计的相对变异性是重要的。\n\n将单个时间步内估计源项的变异系数 $\\epsilon$ 定义为该估计量的标准差与均值之比。从独立同分布随机变量之和的均值和方差的基本定义以及变异系数的定义出发，推导 $\\epsilon$ 作为 $N$、$\\mu_{f}$ 和 $\\sigma_{f}$ 的函数表达式。使用此关系，确定要达到目标变异系数 $\\epsilon = 3.0 \\times 10^{-2}$ 所需的每时间步的粒子数量。此外，一次使用每时间步 $N_{\\text{ref}} = 25$ 个粒子的初步运行产生了一个与给定的 $X_{i}$ 统计数据一致的变异系数。使用初步运行通过参考缩放论证来交叉验证您的结果。\n\n将最终答案表示为 $N$ 的单个整数值（无量纲）。除了精确计算外，不需要进行舍入。",
            "solution": "该问题要求确定在喷雾蒸发的CFD模拟中，为达到指定的统计精度水平所需的拉格朗日粒子数量 $N$。该精度由单元中估计的蒸汽质量源的变异系数 $\\epsilon$ 来量化。\n\n在一个时间步 $\\Delta t$ 内，单元内蒸发的液体总质量是单元中存在的 $N$ 个粒子各自蒸发质量的总和。这个总蒸发质量，我们称之为 $M_{evap}$，是一个随机变量，由下式给出：\n$$M_{evap} = \\sum_{i=1}^{N} m_{p} X_{i}$$\n问题陈述指出，单元的估计蒸汽质量源与此量成正比（具体来说，是 $M_{evap}$ 除以单元体积）。变异系数 $\\epsilon$ 定义为该估计量的标准差与其均值之比。由于单元体积是一个常数，它将在此比率中被消去。因此，我们可以直接用 $M_{evap}$ 来定义 $\\epsilon$：\n$$\\epsilon = \\frac{\\sqrt{Var(M_{evap})}}{E[M_{evap}]}$$\n这里，$E[\\cdot]$ 表示期望值（均值），$Var(\\cdot)$ 表示方差。\n\n首先，我们计算 $M_{evap}$ 的均值。利用期望的线性性质：\n$$E[M_{evap}] = E\\left[\\sum_{i=1}^{N} m_{p} X_{i}\\right]$$\n由于对于给定的 $N$，$m_p$ 是一个常数，它可以从期望中提出来：\n$$E[M_{evap}] = \\sum_{i=1}^{N} E[m_{p} X_{i}] = \\sum_{i=1}^{N} m_{p} E[X_{i}]$$\n随机变量 $X_i$ 是同分布的，均值为 $\\mu_f$。因此，对所有 $i$ 都有 $E[X_i] = \\mu_f$。\n$$E[M_{evap}] = \\sum_{i=1}^{N} m_{p} \\mu_{f} = N m_{p} \\mu_{f}$$\n\n接下来，我们计算 $M_{evap}$ 的方差。由于随机变量 $X_i$ 是独立的，它们和的方差等于它们方差的和：\n$$Var(M_{evap}) = Var\\left(\\sum_{i=1}^{N} m_{p} X_{i}\\right) = \\sum_{i=1}^{N} Var(m_{p} X_{i})$$\n使用性质 $Var(aY) = a^2 Var(Y)$（其中 $a$ 是常数，$Y$ 是随机变量），我们有：\n$$Var(M_{evap}) = \\sum_{i=1}^{N} m_{p}^2 Var(X_{i})$$\n随机变量 $X_i$ 是同分布的，标准差为 $\\sigma_f$，所以它们的方差是 $Var(X_i) = \\sigma_{f}^2$。\n$$Var(M_{evap}) = \\sum_{i=1}^{N} m_{p}^2 \\sigma_{f}^2 = N m_{p}^2 \\sigma_{f}^2$$\n\n$M_{evap}$ 的标准差是其方差的平方根：\n$$\\sqrt{Var(M_{evap})} = \\sqrt{N m_{p}^2 \\sigma_{f}^2} = m_{p} \\sigma_{f} \\sqrt{N}$$\n\n现在我们可以推导变异系数 $\\epsilon$ 的表达式：\n$$\\epsilon = \\frac{\\sqrt{Var(M_{evap})}}{E[M_{evap}]} = \\frac{m_{p} \\sigma_{f} \\sqrt{N}}{N m_{p} \\mu_{f}}$$\n粒子质量 $m_p$ 消去了，这是预料之中的，因为 $\\epsilon$ 是衡量相对变异性的指标。\n$$\\epsilon = \\frac{\\sigma_{f} \\sqrt{N}}{N \\mu_{f}} = \\frac{\\sigma_{f}}{\\mu_{f} \\sqrt{N}}$$\n这就是所求的 $\\epsilon$、$N$、$\\mu_f$ 和 $\\sigma_f$ 之间的关系。\n\n为了求出达到目标变异系数 $\\epsilon$ 所需的粒子数 $N$，我们重新整理该方程：\n$$\\sqrt{N} = \\frac{\\sigma_{f}}{\\mu_{f} \\epsilon}$$\n$$N = \\left(\\frac{\\sigma_{f}}{\\mu_{f} \\epsilon}\\right)^2$$\n我们已知 $\\mu_f = 0.70$，$\\sigma_f = 0.21$，以及目标 $\\epsilon = 3.0 \\times 10^{-2}$。代入这些值：\n$$N = \\left(\\frac{0.21}{0.70 \\times (3.0 \\times 10^{-2})}\\right)^2$$\n$$N = \\left(\\frac{0.21}{0.70 \\times 0.03}\\right)^2 = \\left(\\frac{0.21}{0.021}\\right)^2 = (10)^2 = 100$$\n所以，需要每时间步 100 个粒子。\n\n最后，我们使用参考缩放论证进行交叉验证。推导出的关系 $\\epsilon = \\frac{\\sigma_f / \\mu_f}{\\sqrt{N}}$ 意味着 $\\epsilon \\propto 1/\\sqrt{N}$。因此，对于具有 $(N_1, \\epsilon_1)$ 和 $(N_2, \\epsilon_2)$ 的两次不同运行，以下缩放定律成立：\n$$\\epsilon_1 \\sqrt{N_1} = \\epsilon_2 \\sqrt{N_2}$$\n设参考运行为状态 1，其中 $N_1 = N_{\\text{ref}} = 25$。这次运行的变异系数 $\\epsilon_{\\text{ref}}$ 是：\n$$\\epsilon_{\\text{ref}} = \\frac{\\sigma_{f}}{\\mu_{f} \\sqrt{N_{\\text{ref}}}} = \\frac{0.21}{0.70 \\sqrt{25}} = \\frac{0.3}{5} = 0.06$$\n设目标运行为状态 2，其中 $\\epsilon_2 = \\epsilon = 0.03 = 3.0 \\times 10^{-2}$。我们需要求解 $N_2 = N$。\n使用缩放定律：\n$$N = N_2 = N_1 \\left(\\frac{\\epsilon_1}{\\epsilon_2}\\right)^2 = N_{\\text{ref}} \\left(\\frac{\\epsilon_{\\text{ref}}}{\\epsilon}\\right)^2$$\n$$N = 25 \\left(\\frac{0.06}{0.03}\\right)^2 = 25 \\times (2)^2 = 25 \\times 4 = 100$$\n交叉验证证实了通过直接计算得到的结果。所需的每时间步粒子数量为 100。",
            "answer": "$$\\boxed{100}$$"
        }
    ]
}