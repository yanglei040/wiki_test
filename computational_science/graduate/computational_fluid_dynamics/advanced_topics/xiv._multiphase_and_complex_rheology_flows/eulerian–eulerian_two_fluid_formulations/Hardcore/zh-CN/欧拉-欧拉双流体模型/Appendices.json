{
    "hands_on_practices": [
        {
            "introduction": "在欧拉-欧拉模型中，体积分数场 $\\alpha_k$ 的平流输运是追踪相界面的基础。然而，使用简单的离散格式（如中心差分）可能会在清晰的界面附近（例如气泡表面）产生非物理的振荡，从而影响解的准确性。这个练习  深入分析一个典型的平流-扩散方程，以确定抑制这些振荡所需的最小数值扩散，从而确保解的单调性和物理真实性。",
            "id": "3315487",
            "problem": "在计算流体动力学（CFD）的欧拉-欧拉双流体模型中，用于描述不可混溶相的相体积分数场 $\\,\\alpha(x,t)\\,$ 由其相速度 $\\,u\\,$ 平流输运。如果只进行纯平流计算，该场在尖锐界面附近会产生振荡。为抑制这些虚假的 $\\,\\alpha\\,$ 振荡且不引入过度弥散，通常的做法是在守恒平流方程中增加一个各向同性扩散项，该项代表了维持单调性所需的最小数值扩散。考虑一个定义在网格间距为 $\\,\\Delta x\\,$ 的均匀网格上的一维标量原型方程：\n$$\n\\partial_{t}\\alpha + \\partial_{x}\\!\\left(u\\,\\alpha\\right) \\;=\\; \\nu\\,\\partial_{xx}\\alpha,\n$$\n其中 $\\,u\\in\\mathbb{R}\\,$ 和 $\\,\\nu \\ge 0\\,$ 均为常数。假设：\n- 在均匀网格上，采用有限体积法进行半离散化，未知量为网格平均值 $\\,\\alpha_i^n\\,$，时间推进采用时间步长为 $\\,\\Delta t\\,$ 的前向欧拉显式格式。\n- 面上的对流通量和扩散通量均采用二阶中心差分格式进行近似。\n- 目标是对 $\\,\\alpha\\in[0,1]\\,$ 强制满足离散极值原理（不产生新的极值点），从而对于任意满足 $\\,\\alpha(x,0)\\in[0,1]\\,$ 的初始条件，在尖锐界面附近都不会出现虚假振荡。这一要求需在库朗-弗里德里希斯-列维 (Courant–Friedrichs–Lewy, CFL) 数 $\\,C = |u|\\,\\Delta t/\\Delta x\\,$ 满足 $\\,C \\le 1\\,$ 的条件下成立。\n\n从守恒律和上述离散格式出发，推导为保证更新值为相邻网格值的凸组合所需的系数约束。并确定扩散系数 $\\,\\nu\\,$ 的最小值，该值需保证对于所有满足 $\\,C \\le 1\\,$ 的时间步长 $\\,\\Delta t\\,$，格式具有单调性。请将最终答案表示为以 $\\,|u|\\,$ 和 $\\,\\Delta x\\,$ 表示的精确解析表达式。扩散系数的单位为平方米/秒 ($\\mathrm{m}^2/\\mathrm{s}$)。无需取整。",
            "solution": "问题要求确定一个常数扩散系数 $\\nu$ 的最小值，以保证用于求解一维对流扩散方程\n$$\n\\partial_{t}\\alpha + \\partial_{x}(u\\,\\alpha) \\;=\\; \\nu\\,\\partial_{xx}\\alpha\n$$\n的特定数值格式满足离散极值原理。速度 $u$ 为常数。该数值格式基于间距为 $\\Delta x$ 的均匀网格，并采用时间步长为 $\\Delta t$ 的前向欧拉法进行时间推进。空间离散对对流通量和扩散通量均使用二阶中心差分。该条件必须对满足库朗-弗里德里希斯-列维 (CFL) 条件 $C = |u|\\Delta t/\\Delta x \\le 1$ 的任何时间步长 $\\Delta t$ 都成立。\n\n首先，我们建立全离散数值格式。将控制方程在一个有限体积单元 $i$（从 $x_{i-1/2}$ 到 $x_{i+1/2}$）上进行积分，其中 $x_i$ 是单元中心。单元宽度为 $\\Delta x = x_{i+1/2} - x_{i-1/2}$。由此可得：\n$$\n\\frac{d\\alpha_i}{dt} + \\frac{1}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) = 0\n$$\n此处，$\\alpha_i(t)$ 是单元 $i$ 中 $\\alpha$ 的单元平均值，$F_{i\\pm1/2}$ 代表单元界面上的总通量。总通量由对流部分 $F^c = u\\alpha$ 和扩散部分 $F^d = -\\nu \\partial_x \\alpha$ 组成。\n\n根据题目要求，单元界面上的通量采用二阶中心差分格式进行近似。\n在界面 $i+1/2$ 处的通量为：\n$$\nF_{i+1/2} = F^c_{i+1/2} + F^d_{i+1/2} = u \\left(\\frac{\\alpha_{i+1} + \\alpha_i}{2}\\right) - \\nu \\left(\\frac{\\alpha_{i+1} - \\alpha_i}{\\Delta x}\\right)\n$$\n类似地，在界面 $i-1/2$ 处的通量为：\n$$\nF_{i-1/2} = u \\left(\\frac{\\alpha_i + \\alpha_{i-1}}{2}\\right) - \\nu \\left(\\frac{\\alpha_i - \\alpha_{i-1}}{\\Delta x}\\right)\n$$\n将这些通量表达式代入有限体积方程，得到半离散格式：\n$$\n\\frac{d\\alpha_i}{dt} = -\\frac{1}{\\Delta x} \\left[ u \\left(\\frac{\\alpha_{i+1} - \\alpha_{i-1}}{2}\\right) - \\nu \\left(\\frac{\\alpha_{i+1} - 2\\alpha_i + \\alpha_{i-1}}{\\Delta x}\\right) \\right]\n$$\n这可以改写为：\n$$\n\\frac{d\\alpha_i}{dt} = -u \\frac{\\alpha_{i+1} - \\alpha_{i-1}}{2\\Delta x} + \\nu \\frac{\\alpha_{i+1} - 2\\alpha_i + \\alpha_{i-1}}{\\Delta x^2}\n$$\n接下来，我们应用前向欧拉法进行时间积分，其中 $\\alpha_i^n$ 表示在时间层 $n$ 的值：\n$$\n\\frac{\\alpha_i^{n+1} - \\alpha_i^n}{\\Delta t} = -u \\frac{\\alpha_{i+1}^n - \\alpha_{i-1}^n}{2\\Delta x} + \\nu \\frac{\\alpha_{i+1}^n - 2\\alpha_i^n + \\alpha_{i-1}^n}{\\Delta x^2}\n$$\n求解 $\\alpha_i^{n+1}$ 可得：\n$$\n\\alpha_i^{n+1} = \\alpha_i^n - \\frac{u\\Delta t}{2\\Delta x}(\\alpha_{i+1}^n - \\alpha_{i-1}^n) + \\frac{\\nu\\Delta t}{\\Delta x^2}(\\alpha_{i+1}^n - 2\\alpha_i^n + \\alpha_{i-1}^n)\n$$\n为满足离散极值原理，更新值 $\\alpha_i^{n+1}$ 必须是前一时间步各值 $\\alpha_{i-1}^n$、$\\alpha_i^n$ 和 $\\alpha_{i+1}^n$ 的凸组合。这意味着我们将 $\\alpha_i^{n+1}$ 表达为如下形式：\n$$\n\\alpha_i^{n+1} = C_{i-1} \\alpha_{i-1}^n + C_i \\alpha_i^n + C_{i+1} \\alpha_{i+1}^n\n$$\n其中系数 $C_{j}$ 必须是非负的（$C_j \\ge 0$）并且它们的和为 1（$\\sum C_j = 1$）。\n通过重新排列 $\\alpha_i^{n+1}$ 表达式中的各项，我们可以确定这些系数：\n$$\n\\alpha_i^{n+1} = \\left(\\frac{u\\Delta t}{2\\Delta x} + \\frac{\\nu\\Delta t}{\\Delta x^2}\\right)\\alpha_{i-1}^n + \\left(1 - \\frac{2\\nu\\Delta t}{\\Delta x^2}\\right)\\alpha_i^n + \\left(-\\frac{u\\Delta t}{2\\Delta x} + \\frac{\\nu\\Delta t}{\\Delta x^2}\\right)\\alpha_{i+1}^n\n$$\n因此，这些系数为：\n$C_{i-1} = \\frac{u\\Delta t}{2\\Delta x} + \\frac{\\nu\\Delta t}{\\Delta x^2}$\n$C_i = 1 - \\frac{2\\nu\\Delta t}{\\Delta x^2}$\n$C_{i+1} = -\\frac{u\\Delta t}{2\\Delta x} + \\frac{\\nu\\Delta t}{\\Delta x^2}$\n\n我们来验证它们的和是否为 1：\n$$\nC_{i-1} + C_i + C_{i+1} = \\left(\\frac{u\\Delta t}{2\\Delta x} + \\frac{\\nu\\Delta t}{\\Delta x^2}\\right) + \\left(1 - \\frac{2\\nu\\Delta t}{\\Delta x^2}\\right) + \\left(-\\frac{u\\Delta t}{2\\Delta x} + \\frac{\\nu\\Delta t}{\\Delta x^2}\\right) = 1\n$$\n条件得到满足。现在我们来确保每个系数都为非负。\n1. $C_i \\ge 0 \\implies 1 - \\frac{2\\nu\\Delta t}{\\Delta x^2} \\ge 0 \\implies \\frac{2\\nu\\Delta t}{\\Delta x^2} \\le 1$。\n2. $C_{i-1} \\ge 0 \\implies \\frac{u\\Delta t}{2\\Delta x} + \\frac{\\nu\\Delta t}{\\Delta x^2} \\ge 0 \\implies \\frac{\\nu}{\\Delta x} \\ge -\\frac{u}{2}$。\n3. $C_{i+1} \\ge 0 \\implies -\\frac{u\\Delta t}{2\\Delta x} + \\frac{\\nu\\Delta t}{\\Delta x^2} \\ge 0 \\implies \\frac{\\nu}{\\Delta x} \\ge \\frac{u}{2}$。\n\n结合条件 2 和 3，我们必须满足 $\\frac{\\nu}{\\Delta x} \\ge \\max(-\\frac{u}{2}, \\frac{u}{2})$，可简化为：\n$$\n\\frac{\\nu}{\\Delta x} \\ge \\frac{|u|}{2}\n$$\n这给出了扩散系数 $\\nu$ 的基本约束条件：\n$$\n\\nu \\ge \\frac{|u|\\Delta x}{2}\n$$\n这个条件是保证格式单调性所必需的，且与时间步长 $\\Delta t$ 无关。它将物理扩散与网格分辨率及平流速度联系起来，等价于网格佩克莱特数 (Péclet number) 约束 $Pe_{\\Delta x} = \\frac{|u|\\Delta x}{\\nu} \\le 2$。\n\n满足此条件的 $\\nu$ 的最小值为：\n$$\n\\nu_{min} = \\frac{|u|\\Delta x}{2}\n$$\n现在，我们必须检查这个 $\\nu$ 的取值是否与问题的约束条件兼容。问题要求对于任何满足 CFL 数 $C = \\frac{|u|\\Delta t}{\\Delta x} \\le 1$ 的 $\\Delta t$，格式都具有单调性。当 $\\nu = \\nu_{min}$ 时，剩下的单调性条件是 $C_i \\ge 0$，即 $\\frac{2\\nu\\Delta t}{\\Delta x^2} \\le 1$。\n代入 $\\nu = \\nu_{min}$：\n$$\n\\frac{2\\left(\\frac{|u|\\Delta x}{2}\\right)\\Delta t}{\\Delta x^2} \\le 1\n$$\n$$\n\\frac{|u|\\Delta x \\Delta t}{\\Delta x^2} \\le 1\n$$\n$$\n\\frac{|u|\\Delta t}{\\Delta x} \\le 1\n$$\n这个不等式恰好是 CFL 条件 $C \\le 1$，而已知条件中已给出。因此，如果我们选择 $\\nu = \\frac{|u|\\Delta x}{2}$，则对于任何满足 CFL 极限 $C \\le 1$ 的时间步长，该格式都能保证单调性。任何小于此值的 $\\nu$ 都会因为 $u$ 的符号而违反 $C_{i-1}$ 或 $C_{i+1}$ 的非负性。所以，所需的最小值就是这个值。这个扩散量被称为一阶迎风格式的固有数值扩散，因为设置 $\\nu = |u|\\Delta x/2$ 实际上将中心差分格式转换成了一阶迎风格式。\n\n最终答案是最小扩散系数的表达式。$|u|\\Delta x$ 的单位是 $(\\mathrm{m}/\\mathrm{s}) \\cdot \\mathrm{m} = \\mathrm{m}^2/\\mathrm{s}$，这与题目要求的扩散系数单位一致。",
            "answer": "$$\\boxed{\\frac{|u|\\Delta x}{2}}$$"
        },
        {
            "introduction": "除了输运过程，多相流的物理特性主要由相间耦合项决定，其中曳力是一个典型的例子。曳力项在代数上耦合了相动量方程，常常引入严重的数值刚性，这决定了显式时间积分格式的整体稳定性。通过这个练习 ，您将对线性化的曳力算子进行经典的稳定性分析，推导出其施加的严格时间步长限制，从而定量地理解为何处理这些项时通常必须采用隐式方法。",
            "id": "3315453",
            "problem": "考虑一个使用计算流体力学（CFD）中的欧拉-欧拉两流体模型进行建模的均匀、充分混合的气-液系统。关注单个计算单元，其中对流、压力梯度和粘性应力与相间阻力相比可以忽略不计。气相的密度为 $\\rho_{g} = 1.2$ $\\mathrm{kg/m^{3}}$，体积分数为 $\\alpha_{g} = 0.10$；而液相的密度为 $\\rho_{\\ell} = 1000$ $\\mathrm{kg/m^{3}}$，体积分数为 $\\alpha_{\\ell} = 0.90$。在所关注的时间步长内，相间动量交换系数（阻力系数）取为常数 $K = 150$ $\\mathrm{kg/(m^{3}\\,s)}$。\n\n从单位体积的相动量平衡和牛顿第三定律出发，推导两相纯阻力耦合速度动力学的线性化算子。确定其特征值，并由此计算仅对阻力源项使用显式前向欧拉时间离散化时的最大稳定时间步长界限 $\\Delta t_{\\max}$，使用线性化阻力耦合算子的谱半径作为控制稳定性的量。将最终的时间步长界限以秒为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "### 解题过程\n\n出发点是根据问题陈述简化的各相 $k$（其中 $k$ 可以是气相 $g$ 或液相 $\\ell$）的相动量平衡方程。通过忽略对流、压力梯度和粘性项，相 $k$ 的单位体积动量方程简化为：\n$$\n\\frac{\\partial}{\\partial t}(\\alpha_{k} \\rho_{k} \\mathbf{u}_{k}) = \\mathbf{M}_{k}\n$$\n其中 $\\alpha_{k}$ 是体积分数，$\\rho_{k}$ 是密度，$\\mathbf{u}_{k}$ 是相 $k$ 的速度，$\\mathbf{M}_{k}$ 是相间动量传递项（阻力）。由于在时间步长内，单元中的属性 $\\alpha_{k}$ 和 $\\rho_{k}$ 是常数，我们可以写出：\n$$\n\\alpha_{k} \\rho_{k} \\frac{d\\mathbf{u}_{k}}{dt} = \\mathbf{M}_{k}\n$$\n相间动量传递是由于阻力引起的，根据牛顿第三定律，$\\mathbf{M}_{g} = -\\mathbf{M}_{\\ell}$。液相作用于气相的阻力由下式给出：\n$$\n\\mathbf{M}_{g} = K (\\mathbf{u}_{\\ell} - \\mathbf{u}_{g})\n$$\n因此，作用于液相的阻力是：\n$$\n\\mathbf{M}_{\\ell} = K (\\mathbf{u}_{g} - \\mathbf{u}_{\\ell})\n$$\n其中 $K$ 是相间动量交换系数。\n\n将这些阻力项代入气相（$g$）和液相（$\\ell$）的简化动量方程，我们得到：\n$$\n\\alpha_{g} \\rho_{g} \\frac{d\\mathbf{u}_{g}}{dt} = K (\\mathbf{u}_{\\ell} - \\mathbf{u}_{g})\n$$\n$$\n\\alpha_{\\ell} \\rho_{\\ell} \\frac{d\\mathbf{u}_{\\ell}}{dt} = K (\\mathbf{u}_{g} - \\mathbf{u}_{\\ell})\n$$\n速度分量之间的耦合是线性的和各向同性的，因此我们可以分析单个速度分量（例如，$x$ 方向）而不失一般性。设 $u_g$ 和 $u_\\ell$ 为这些分量。常微分方程（ODEs）系统变为：\n$$\n\\frac{du_{g}}{dt} = \\frac{K}{\\alpha_{g} \\rho_{g}} (u_{\\ell} - u_{g})\n$$\n$$\n\\frac{du_{\\ell}}{dt} = \\frac{K}{\\alpha_{\\ell} \\rho_{\\ell}} (u_{g} - u_{\\ell})\n$$\n这个系统可以写成矩阵形式 $\\frac{d\\mathbf{u}}{dt} = \\mathbf{J}\\mathbf{u}$，其中 $\\mathbf{u} = \\begin{pmatrix} u_g \\\\ u_\\ell \\end{pmatrix}$：\n$$\n\\frac{d}{dt} \\begin{pmatrix} u_g \\\\ u_\\ell \\end{pmatrix} = \n\\begin{pmatrix} \n-\\frac{K}{\\alpha_{g} \\rho_{g}}  \\frac{K}{\\alpha_{g} \\rho_{g}} \\\\\n\\frac{K}{\\alpha_{\\ell} \\rho_{\\ell}}  -\\frac{K}{\\alpha_{\\ell} \\rho_{\\ell}}\n\\end{pmatrix}\n\\begin{pmatrix} u_g \\\\ u_\\ell \\end{pmatrix}\n$$\n矩阵 $\\mathbf{J}$ 是阻力耦合速度动力学的线性化算子：\n$$\n\\mathbf{J} = \\begin{pmatrix} \n-C_g  C_g \\\\\nC_\\ell  -C_\\ell\n\\end{pmatrix}\n$$\n其中我们定义了逆松弛时间 $C_g = \\frac{K}{\\alpha_{g} \\rho_{g}}$ 和 $C_\\ell = \\frac{K}{\\alpha_{\\ell} \\rho_{\\ell}}$。\n\n接下来，我们通过求解特征方程 $\\det(\\mathbf{J} - \\lambda \\mathbf{I}) = 0$ 来确定算子 $\\mathbf{J}$ 的特征值 $\\lambda$：\n$$\n\\det \\begin{pmatrix} \n-C_g - \\lambda  C_g \\\\\nC_\\ell  -C_\\ell - \\lambda\n\\end{pmatrix} = 0\n$$\n$$\n(-C_g - \\lambda)(-C_\\ell - \\lambda) - (C_g)(C_\\ell) = 0\n$$\n$$\nC_g C_\\ell + C_g \\lambda + C_\\ell \\lambda + \\lambda^2 - C_g C_\\ell = 0\n$$\n$$\n\\lambda^2 + (C_g + C_\\ell)\\lambda = 0\n$$\n$$\n\\lambda(\\lambda + C_g + C_\\ell) = 0\n$$\n特征值为：\n$$\n\\lambda_1 = 0\n$$\n$$\n\\lambda_2 = -(C_g + C_\\ell)\n$$\n特征值 $\\lambda_1 = 0$ 对应于封闭系统中总动量的守恒。特征值 $\\lambda_2$ 控制速度滑移向共同速度的指数松弛过程。\n\n对于一个常微分方程系统 $\\frac{d\\mathbf{u}}{dt} = \\mathbf{J}\\mathbf{u}$ 的显式前向欧拉离散，其格式为 $\\mathbf{u}^{n+1} = \\mathbf{u}^{n} + \\Delta t \\mathbf{J} \\mathbf{u}^{n} = (\\mathbf{I} + \\Delta t \\mathbf{J})\\mathbf{u}^{n}$。数值稳定性的条件是放大矩阵 $(\\mathbf{I} + \\Delta t \\mathbf{J})$ 的所有特征值的模都必须小于或等于1。该矩阵的特征值为 $1 + \\Delta t \\lambda_k$，其中 $\\lambda_k$ 是 $\\mathbf{J}$ 的特征值。\n对于 $\\lambda_1 = 0$，条件是 $|1 + \\Delta t \\cdot 0| = 1 \\le 1$，这个条件总是满足的。\n对于 $\\lambda_2 = -(C_g + C_\\ell)$，条件是 $|1 + \\Delta t \\lambda_2| \\le 1$：\n$$\n|1 - \\Delta t (C_g + C_\\ell)| \\le 1\n$$\n因为 $\\Delta t$、$C_g$ 和 $C_\\ell$ 都是正数，这展开为：\n$$\n-1 \\le 1 - \\Delta t (C_g + C_\\ell) \\le 1\n$$\n右侧不等式 $1 - \\Delta t(C_g + C_\\ell) \\le 1$ 意味着 $-\\Delta t(C_g + C_\\ell) \\le 0$，这总是成立的。\n左侧不等式给出了稳定性极限：\n$$\n-1 \\le 1 - \\Delta t (C_g + C_\\ell)\n$$\n$$\n\\Delta t (C_g + C_\\ell) \\le 2\n$$\n$$\n\\Delta t \\le \\frac{2}{C_g + C_\\ell}\n$$\n算子的谱半径为 $\\rho(\\mathbf{J}) = \\max(|\\lambda_1|, |\\lambda_2|) = |-(C_g + C_\\ell)| = C_g + C_\\ell$。因此，最大稳定时间步长 $\\Delta t_{\\max}$ 是：\n$$\n\\Delta t_{\\max} = \\frac{2}{C_g + C_\\ell} = \\frac{2}{\\frac{K}{\\alpha_{g} \\rho_{g}} + \\frac{K}{\\alpha_{\\ell} \\rho_{\\ell}}}\n$$\n现在，我们代入给定的数值：\n$\\rho_{g} = 1.2$ $\\mathrm{kg/m^{3}}$，$\\alpha_{g} = 0.10$，所以 $\\alpha_{g} \\rho_{g} = 0.10 \\times 1.2 = 0.12$ $\\mathrm{kg/m^{3}}$。\n$\\rho_{\\ell} = 1000$ $\\mathrm{kg/m^{3}}$，$\\alpha_{\\ell} = 0.90$，所以 $\\alpha_{\\ell} \\rho_{\\ell} = 0.90 \\times 1000 = 900$ $\\mathrm{kg/m^{3}}$。\n$K = 150$ $\\mathrm{kg/(m^{3}\\,s)}$。\n\n我们计算 $C_g$ 和 $C_\\ell$：\n$$\nC_g = \\frac{150}{0.12} = 1250 \\text{ s}^{-1}\n$$\n$$\nC_\\ell = \\frac{150}{900} = \\frac{1}{6} \\text{ s}^{-1}\n$$\n它们的和是：\n$$\nC_g + C_\\ell = 1250 + \\frac{1}{6} = \\frac{7500}{6} + \\frac{1}{6} = \\frac{7501}{6} \\text{ s}^{-1}\n$$\n最大稳定时间步长是：\n$$\n\\Delta t_{\\max} = \\frac{2}{C_g + C_\\ell} = \\frac{2}{7501/6} = \\frac{12}{7501} \\text{ s}\n$$\n最后，我们计算数值并四舍五入到四位有效数字：\n$$\n\\Delta t_{\\max} = \\frac{12}{7501} \\approx 0.0015997867 \\text{ s}\n$$\n四舍五入到四位有效数字，我们得到 $0.001600$ s。",
            "answer": "$$\\boxed{0.001600}$$"
        },
        {
            "introduction": "一个数值稳定的格式不一定是一个鲁棒的格式；极端的流动条件仍可能产生物理上不可能的结果，例如负密度或超出 $[0, 1]$ 范围的体积分数。为了构建一个真正鲁棒的求解器，我们必须直接强制施加物理可容许性约束。这个练习  将指导您设计并推导一个保正限制器，这是一种通过审慎地缩放数值更新量来保证解保持在有效物理界限内的技术。",
            "id": "3315467",
            "problem": "考虑一个用于可压缩气液混合物的一维、有限体积显式更新，该混合物通过计算流体动力学 (CFD) 中的欧拉-欧拉双流体公式进行建模。对于每个相 $k\\in\\{g,\\ell\\}$，单位体积的相质量为 $m_k=\\alpha_k\\rho_k$，其中 $\\alpha_k$ 是相体积分数，$\\rho_k$ 是相密度。在一个时间步长上的显式更新可以写为对守恒变量的前向欧拉步，\n$$\nm_k^{\\star} \\equiv m_k^{n} + \\Delta m_k, \\quad \\alpha_g^{\\star} \\equiv \\alpha_g^{n} + \\Delta \\alpha_g,\n$$\n其中 $m_k^{n}$ 和 $\\alpha_g^{n}$ 表示旧状态，$m_k^{\\star}$ 和 $\\alpha_g^{\\star}$ 表示限制前的新状态，而 $\\Delta m_k,\\Delta \\alpha_g$ 表示由数值通量和源项（包括刚性松弛）产生的总显式增量。液体体积分数为 $\\alpha_{\\ell}=1-\\alpha_g$。其基本基础是相质量守恒，\n$$\n\\partial_t(\\alpha_k\\rho_k) + \\partial_x(\\alpha_k\\rho_ku_k) = S_{m,k},\n$$\n其中 $S_{m,k}$ 代表相间质量交换。在显式格式中，强激波或刚性源项下的大通量可能导致 $m_k^{\\star}\\le 0$ 或 $\\alpha_k^{\\star}\\notin[0,1]$，这是不可接受的。可接受集定义为\n$$\n\\mathcal{A}=\\left\\{(\\alpha_g,\\alpha_{\\ell},m_g,m_{\\ell}) \\,\\middle|\\, \\epsilon_{\\alpha}\\le \\alpha_g \\le 1-\\epsilon_{\\alpha},\\ \\alpha_{\\ell}=1-\\alpha_g,\\ m_g\\ge \\epsilon_{m},\\ m_{\\ell}\\ge \\epsilon_{m}\\right\\},\n$$\n其中选择小的下限值 $\\epsilon_{\\alpha}0$ 和 $\\epsilon_{m}0$ 以避免除零并保持严格正性。密度通过 $m_k$ 和 $\\alpha_k$ 恢复，方式如下\n$$\n\\rho_k = \\frac{m_k}{\\alpha_k}.\n$$\n您的任务是从 $\\mathcal{A}$ 的凸性和显式更新结构出发，推导一个单一的标量保正限制器，该限制器构造一个受限的更新\n$$\nm_k^{n+1} = m_k^{n} + \\theta\\,\\Delta m_k,\\quad \\alpha_g^{n+1} = \\alpha_g^{n} + \\theta\\,\\Delta \\alpha_g,\\quad \\alpha_{\\ell}^{n+1}=1-\\alpha_g^{n+1},\n$$\n其中缩放因子 $0\\le \\theta \\le 1$，使得受限状态位于 $\\mathcal{A}$ 内并产生严格为正的密度 $\\rho_k^{n+1}0$。从基本质量平衡和作为凸约束集的 $\\mathcal{A}$ 的定义出发，推导 $\\theta$ 上需要同时满足的条件：\n- 质量下限 $m_k^{n+1}\\ge \\epsilon_{m}$（对于 $k\\in\\{g,\\ell\\}$），\n- 体积分数下限和上限 $\\epsilon_{\\alpha}\\le \\alpha_g^{n+1}\\le 1-\\epsilon_{\\alpha}$，\n并证明选择\n$$\n\\theta=\\min\\Big(1,\\ \\theta_{m,g},\\ \\theta_{m,\\ell},\\ \\theta_{\\alpha,\\mathrm{low}},\\ \\theta_{\\alpha,\\mathrm{up}}\\Big)\n$$\n（其中 $\\theta_{(\\cdot)}\\in[0,1]$ 是适当定义的特定于约束的缩放因子）可以保证 $m_k^{n+1}\\ge \\epsilon_{m}$ 和 $\\epsilon_{\\alpha}\\le \\alpha_g^{n+1}\\le 1-\\epsilon_{\\alpha}$，从而保证 $\\rho_k^{n+1}0$。\n\n然后，在一个程序中实现所推导的限制器，该程序针对一组给定的测试用例，计算受限更新并返回限制后的 $(\\theta,\\alpha_g^{n+1},\\alpha_{\\ell}^{n+1},\\rho_g^{n+1},\\rho_{\\ell}^{n+1})$ 以及一个布尔值，指示是否所有约束都已满足。使用以下物理上合理的测试套件，该套件对限制器的不同方面进行了压力测试。密度必须以 $\\mathrm{kg/m^3}$ 表示：\n\n- 测试用例 1 (正常路径，适度更新):\n  - $\\alpha_g^{n}=0.4$, $\\rho_g^{n}=5\\,\\mathrm{kg/m^3}$, $\\rho_{\\ell}^{n}=950\\,\\mathrm{kg/m^3}$,\n  - $\\Delta \\alpha_g=-0.02$, $\\Delta m_g=-0.1\\,\\mathrm{kg/m^3}$, $\\Delta m_{\\ell}=+0.1\\,\\mathrm{kg/m^3}$。\n\n- 测试用例 2 (强激波，无限制时气体质量变为负值):\n  - $\\alpha_g^{n}=0.3$, $\\rho_g^{n}=8\\,\\mathrm{kg/m^3}$, $\\rho_{\\ell}^{n}=1000\\,\\mathrm{kg/m^3}$,\n  - $\\Delta \\alpha_g=-0.05$, $\\Delta m_g=-3.0\\,\\mathrm{kg/m^3}$, $\\Delta m_{\\ell}=+2.0\\,\\mathrm{kg/m^3}$。\n\n- 测试用例 3 (刚性松弛，体积分数超过单位一):\n  - $\\alpha_g^{n}=0.5$, $\\rho_g^{n}=2\\,\\mathrm{kg/m^3}$, $\\rho_{\\ell}^{n}=900\\,\\mathrm{kg/m^3}$,\n  - $\\Delta \\alpha_g=+0.8$, $\\Delta m_g=+0.1\\,\\mathrm{kg/m^3}$, $\\Delta m_{\\ell}=-0.1\\,\\mathrm{kg/m^3}$。\n\n- 测试用例 4 (近真空气体分数，可能发生下溢):\n  - $\\alpha_g^{n}=10^{-6}$, $\\rho_g^{n}=0.8\\,\\mathrm{kg/m^3}$, $\\rho_{\\ell}^{n}=1000\\,\\mathrm{kg/m^3}$,\n  - $\\Delta \\alpha_g=-10^{-3}$, $\\Delta m_g=-10^{-5}\\,\\mathrm{kg/m^3}$, $\\Delta m_{\\ell}=+10^{-2}\\,\\mathrm{kg/m^3}$。\n\n- 测试用例 5 (几乎纯气体，无限制时气体分数上限被违反):\n  - $\\alpha_g^{n}=1-10^{-9}$, $\\rho_g^{n}=10\\,\\mathrm{kg/m^3}$, $\\rho_{\\ell}^{n}=1000\\,\\mathrm{kg/m^3}$,\n  - $\\Delta \\alpha_g=+0.1$, $\\Delta m_g=+1.0\\,\\mathrm{kg/m^3}$, $\\Delta m_{\\ell}=-1.0\\,\\mathrm{kg/m^3}$。\n\n使用下限值 $\\epsilon_{\\alpha}=10^{-9}$ 和 $\\epsilon_{m}=10^{-12}\\,\\mathrm{kg/m^3}$。密度必须按 $\\rho_k^{n+1}=m_k^{n+1}/\\max(\\alpha_k^{n+1},\\epsilon_{\\alpha})$ 计算以避免除零，并且必须以 $\\mathrm{kg/m^3}$ 报告。布尔值必须为真，当且仅当 $0\\le \\alpha_g^{n+1}\\le 1$、$0\\le \\alpha_{\\ell}^{n+1}\\le 1$、$\\rho_g^{n+1}0$ 且 $\\rho_{\\ell}^{n+1}0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身是一个按 $[\\theta,\\alpha_g^{n+1},\\alpha_{\\ell}^{n+1},\\rho_g^{n+1},\\rho_{\\ell}^{n+1},\\mathrm{ok}]$ 顺序排列的列表。例如，最终输出必须看起来像\n$$\n\\big[\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,\\big],\n$$\n其中 $\\theta$、$\\alpha_g^{n+1}$、$\\alpha_{\\ell}^{n+1}$、$\\rho_g^{n+1}$ 和 $\\rho_{\\ell}^{n+1}$ 是浮点数（单位为 $\\mathrm{kg/m^3}$），而 $\\mathrm{ok}$ 是一个布尔值。",
            "solution": "该问题要求推导并实现一个用于一维可压缩双流体模型的保正限制器，该模型使用显式时间步进格式。目标是确保更新后的状态变量保持在物理可接受集 $\\mathcal{A}$ 内，该集合由相质量的下限和相体积分数的下/上限定义。\n\n新时间层 $n+1$ 的状态是通过使用单一标量因子 $\\theta \\in [0, 1]$ 缩放显式增量 $(\\Delta m_k, \\Delta \\alpha_g)$ 从旧时间层 $n$ 的状态构造的。更新后的状态由以下公式给出：\n$$\nm_k^{n+1} = m_k^{n} + \\theta\\,\\Delta m_k, \\quad k \\in \\{g, \\ell\\}\n$$\n$$\n\\alpha_g^{n+1} = \\alpha_g^{n} + \\theta\\,\\Delta \\alpha_g\n$$\n$$\n\\alpha_{\\ell}^{n+1} = 1-\\alpha_g^{n+1} = \\alpha_{\\ell}^{n} - \\theta\\,\\Delta \\alpha_g\n$$\n我们假设旧状态 $(m_g^n, m_\\ell^n, \\alpha_g^n)$ 位于可接受集 $\\mathcal{A}$ 中，意味着 $m_k^n \\ge \\epsilon_m$ 且 $\\epsilon_\\alpha \\le \\alpha_g^n \\le 1-\\epsilon_\\alpha$。我们的目标是找到最大的 $\\theta \\in [0, 1]$，使得新状态 $(m_g^{n+1}, m_\\ell^{n+1}, \\alpha_g^{n+1})$ 也位于 $\\mathcal{A}$ 中。这需要同时满足四个不等式约束。我们为每个约束分别推导 $\\theta$ 上的条件。\n\n**1. 气体质量下限：$m_g^{n+1} \\ge \\epsilon_{m}$**\n\n约束条件是 $m_g^{n} + \\theta\\,\\Delta m_g \\ge \\epsilon_{m}$。重新整理以求解 $\\theta$，我们得到 $\\theta\\,\\Delta m_g \\ge \\epsilon_{m} - m_g^{n}$。我们考虑增量 $\\Delta m_g$ 的两种情况：\n- 如果 $\\Delta m_g \\ge 0$，质量不减少。由于 $m_g^{n} \\ge \\epsilon_{m}$，对于所有 $\\theta \\ge 0$，该约束都得到满足。此约束不对 $\\theta$ 施加上限。\n- 如果 $\\Delta m_g  0$，质量减少。除以负的 $\\Delta m_g$ 会反转不等号：\n$$\n\\theta \\le \\frac{\\epsilon_{m} - m_g^{n}}{\\Delta m_g} = \\frac{m_g^{n} - \\epsilon_{m}}{-\\Delta m_g}\n$$\n由于 $m_g^{n} \\ge \\epsilon_{m}$，分子是非负的，并且由于 $-\\Delta m_g > 0$，该比率也是非负的。我们定义一个特定于约束的缩放因子 $\\theta_{m,g}$ 来表示这个上限：\n$$\n\\theta_{m,g} = \\begin{cases} \\frac{\\epsilon_{m} - m_g^{n}}{\\Delta m_g}  \\text{如果 } \\Delta m_g  0 \\\\ \\infty  \\text{如果 } \\Delta m_g \\ge 0 \\end{cases}\n$$\n使用 $\\infty$ 表示对于不减少的质量，该约束是无效的。\n\n**2. 液体质量下限：$m_{\\ell}^{n+1} \\ge \\epsilon_{m}$**\n\n推导过程与气相相同。约束条件是 $m_{\\ell}^{n} + \\theta\\,\\Delta m_{\\ell} \\ge \\epsilon_{m}$。这导致缩放因子 $\\theta_{m,\\ell}$：\n$$\n\\theta_{m,\\ell} = \\begin{cases} \\frac{\\epsilon_{m} - m_{\\ell}^{n}}{\\Delta m_{\\ell}}  \\text{如果 } \\Delta m_{\\ell}  0 \\\\ \\infty  \\text{如果 } \\Delta m_{\\ell} \\ge 0 \\end{cases}\n$$\n\n**3. 气体体积分数下限：$\\alpha_g^{n+1} \\ge \\epsilon_{\\alpha}$**\n\n约束条件是 $\\alpha_g^{n} + \\theta\\,\\Delta \\alpha_g \\ge \\epsilon_{\\alpha}$。分析过程与质量约束类似。\n- 如果 $\\Delta \\alpha_g \\ge 0$，由于 $\\alpha_g^{n} \\ge \\epsilon_{\\alpha}$，该约束得到满足。\n- 如果 $\\Delta \\alpha_g  0$，我们需要对 $\\theta$ 施加上限：\n$$\n\\theta \\le \\frac{\\epsilon_{\\alpha} - \\alpha_g^{n}}{\\Delta \\alpha_g}\n$$\n相应的缩放因子 $\\theta_{\\alpha,\\mathrm{low}}$ 为：\n$$\n\\theta_{\\alpha,\\mathrm{low}} = \\begin{cases} \\frac{\\epsilon_{\\alpha} - \\alpha_g^{n}}{\\Delta \\alpha_g}  \\text{如果 } \\Delta \\alpha_g  0 \\\\ \\infty  \\text{如果 } \\Delta \\alpha_g \\ge 0 \\end{cases}\n$$\n\n**4. 气体体积分数上限：$\\alpha_g^{n+1} \\le 1 - \\epsilon_{\\alpha}$**\n\n约束条件是 $\\alpha_g^{n} + \\theta\\,\\Delta \\alpha_g \\le 1 - \\epsilon_{\\alpha}$。重新整理得到 $\\theta\\,\\Delta \\alpha_g \\le 1 - \\epsilon_{\\alpha} - \\alpha_g^{n}$。这里，情况分析取决于 $\\Delta \\alpha_g$ 的符号，方式有所不同。\n- 如果 $\\Delta \\alpha_g \\le 0$，体积分数不增加。由于 $\\alpha_g^{n} \\le 1 - \\epsilon_{\\alpha}$，对于 $\\theta \\ge 0$，该约束总是满足的。\n- 如果 $\\Delta \\alpha_g > 0$，我们必须限制 $\\theta$：\n$$\n\\theta \\le \\frac{1 - \\epsilon_{\\alpha} - \\alpha_g^{n}}{\\Delta \\alpha_g}\n$$\n相应的缩放因子 $\\theta_{\\alpha,\\mathrm{up}}$ 为：\n$$\n\\theta_{\\alpha,\\mathrm{up}} = \\begin{cases} \\frac{1 - \\epsilon_{\\alpha} - \\alpha_g^{n}}{\\Delta \\alpha_g}  \\text{如果 } \\Delta \\alpha_g > 0 \\\\ \\infty  \\text{如果 } \\Delta \\alpha_g \\le 0 \\end{cases}\n$$\n\n**限制器的综合**\n\n为确保同时满足所有四个约束，$\\theta$ 必须小于或等于每个推导出的上限。我们还要求限制器不放大更新，因此 $\\theta \\le 1$。为了获得保持有效的最大可能更新，我们选择所有这些界限中最严格的（即最小的）一个。这证明了 $\\theta$ 的正确选择是：\n$$\n\\theta = \\min\\Big(1,\\ \\theta_{m,g},\\ \\theta_{m,\\ell},\\ \\theta_{\\alpha,\\mathrm{low}},\\ \\theta_{\\alpha,\\mathrm{up}}\\Big)\n$$\n这种形式明确地构造了限制器。集合 $\\mathcal{A}$ 由一组线性不等式定义，使其成为一个凸集。旧状态 $X^n = (m_g^n, m_\\ell^n, \\alpha_g^n)$ 位于 $\\mathcal{A}$ 中，而受限的新状态 $X^{n+1}$ 是 $X^n$ 和限制前状态 $X^\\star$ 的凸组合，即 $X^{n+1} = (1-\\theta)X^n + \\theta X^\\star$。我们对 $\\theta$ 的构造找到了 $[0,1]$ 中的最大值，使得 $X^{n+1}$ 位于 $X^n$ 和 $X^\\star$ 之间的线段上，并且仍然在 $\\mathcal{A}$ 内部。\n\n**密度的正性**\n\n限制器的应用保证了新状态位于 $\\mathcal{A}$ 内。具体来说：\n- 对于 $k\\in\\{g, \\ell\\}$，$m_k^{n+1} \\ge \\epsilon_m > 0$。\n- $\\epsilon_\\alpha \\le \\alpha_g^{n+1} \\le 1-\\epsilon_\\alpha$。这意味着 $\\alpha_g^{n+1} > 0$ 并且 $\\alpha_\\ell^{n+1} = 1 - \\alpha_g^{n+1} \\ge \\epsilon_\\alpha > 0$。\n\n相密度恢复为 $\\rho_k^{n+1} = m_k^{n+1} / \\alpha_k^{n+1}$。由于分子 ($m_k^{n+1}$) 和分母 ($\\alpha_k^{n+1}$) 都保证是严格为正的，因此得到的密度 $\\rho_k^{n+1}$ 也是严格为正的。问题指定将密度计算为 $\\rho_k^{n+1}=m_k^{n+1}/\\max(\\alpha_k^{n+1},\\epsilon_{\\alpha})$，这加强了这一结论，因为分母被明确地阻止为零或负，并且其下界为 $\\epsilon_\\alpha > 0$。",
            "answer": "[[1.0,0.38,0.62,5.0,919.5161290322581,true],[0.7999999999996667,0.26000000000001665,0.7399999999999833,3.846153846153846e-12,949.9324324324325,true],[0.62499999875,0.999999999,1e-09,1.1000000011000002,899.8888876666667,true],[0.000999,1.0000000000000002e-09,0.999999999,7.9001e-07,1010.080007999992,true],[0.0,0.999999999,1e-09,10.0,1000.0,true]]"
        }
    ]
}