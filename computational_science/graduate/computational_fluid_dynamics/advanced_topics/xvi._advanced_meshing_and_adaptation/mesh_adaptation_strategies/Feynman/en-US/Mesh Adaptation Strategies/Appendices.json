{
    "hands_on_practices": [
        {
            "introduction": "The fundamental goal of mesh adaptation is to distribute computational resources efficiently by placing more grid points where the solution changes most rapidly. This exercise grounds this idea in the one-dimensional equidistribution principle, where a \"monitor function\" quantifies the solution's local importance. By deriving the analytical mesh-mapping function for a given scenario, you will gain a first-principles understanding of how solution features directly control the mesh density in an adaptive grid .",
            "id": "3344448",
            "problem": "Consider a one-dimensional mesh adaptation problem arising in computational fluid dynamics (CFD) for a scalar field governed by partial differential equations (PDEs) on a fixed domain. Let the physical coordinate be $x \\in [0,1]$ and the computational coordinate be $\\xi \\in [0,1]$. Suppose the mesh is adapted by equidistributing a monitor function motivated by interpolation error, specifically $m(x) = |u''(x)|^{1/3}$, where $u(x)$ is a sufficiently smooth scalar solution. Starting from the equidistribution principle that defines an $x(\\xi)$ mapping by equalizing the cumulative monitor measure across computational cells, derive the closed-form expression for the mapping $x(\\xi)$ for the specific choice $u(x) = \\exp(3x)$ on $[0,1]$. Then, using this mapping, compute the resulting node locations $x_i$ on $[0,1]$ for a uniform computational mesh with $N=6$ (i.e., $\\xi_i = i/6$ for $i=0,1,\\dots,6$). Provide both the closed-form mapping $x(\\xi)$ and the exact analytic expressions for the seven node locations $x_i$. Express your answers as exact analytic expressions; do not round.",
            "solution": "The problem requires the derivation of a one-dimensional mesh coordinate transformation $x(\\xi)$ and the corresponding node locations for a specific scalar field and monitor function. The foundation for this derivation is the equidistribution principle.\n\nThe equidistribution principle states that the product of the monitor function $m(x)$ and the infinitesimal physical cell size $dx$ is held constant across the computational domain. In continuous form, this can be expressed as an integral relation between the physical coordinate $x$ and the computational coordinate $\\xi$. For a domain normalized to $[0,1]$ for both $x$ and $\\xi$, the principle is given by the equation:\n$$\n\\int_0^{x(\\xi)} m(s) \\, ds = \\xi \\int_0^1 m(s) \\, ds\n$$\nThis equation ensures that the cumulative measure of the monitor function up to a physical point $x$ is proportional to the corresponding computational coordinate $\\xi$. The constant of proportionality is the total measure of the monitor function over the entire domain $[0,1]$.\n\nThe problem provides the scalar field $u(x)$ and the definition of the monitor function $m(x)$.\nFirst, we are given $u(x) = \\exp(3x)$. We need to compute its second derivative, $u''(x)$.\nThe first derivative is:\n$$\nu'(x) = \\frac{d}{dx}(\\exp(3x)) = 3\\exp(3x)\n$$\nThe second derivative is:\n$$\nu''(x) = \\frac{d}{dx}(3\\exp(3x)) = 9\\exp(3x)\n$$\nThe monitor function is defined as $m(x) = |u''(x)|^{1/3}$. Substituting the expression for $u''(x)$:\n$$\nm(x) = |9\\exp(3x)|^{1/3}\n$$\nSince $x \\in [0,1]$, $\\exp(3x)$ is strictly positive, so the absolute value is redundant.\n$$\nm(x) = (9\\exp(3x))^{1/3} = 9^{1/3} (\\exp(3x))^{1/3} = (3^2)^{1/3} \\exp\\left(3x \\cdot \\frac{1}{3}\\right) = 3^{2/3}\\exp(x)\n$$\nNext, we evaluate the two integrals in the equidistribution principle equation. The left-hand side (LHS) integral is:\n$$\n\\int_0^x m(s) \\, ds = \\int_0^x 3^{2/3}\\exp(s) \\, ds = 3^{2/3} \\left[\\exp(s)\\right]_0^x = 3^{2/3}(\\exp(x) - \\exp(0)) = 3^{2/3}(\\exp(x) - 1)\n$$\nThe integral on the right-hand side (RHS), representing the total measure of the monitor function, is:\n$$\n\\int_0^1 m(s) \\, ds = \\int_0^1 3^{2/3}\\exp(s) \\, ds = 3^{2/3} \\left[\\exp(s)\\right]_0^1 = 3^{2/3}(\\exp(1) - \\exp(0)) = 3^{2/3}(e - 1)\n$$\nNow, we substitute these integral results back into the equidistribution principle equation:\n$$\n3^{2/3}(\\exp(x) - 1) = \\xi \\left[3^{2/3}(e - 1)\\right]\n$$\nThe constant factor $3^{2/3}$ cancels from both sides, simplifying the equation to:\n$$\n\\exp(x) - 1 = \\xi(e - 1)\n$$\nTo find the closed-form expression for the mapping $x(\\xi)$, we solve for $x$:\n$$\n\\exp(x) = 1 + \\xi(e - 1)\n$$\nTaking the natural logarithm of both sides yields the mapping function:\n$$\nx(\\xi) = \\ln(1 + (e - 1)\\xi)\n$$\nThis is the first required result.\n\nThe second part of the problem asks for the physical node locations $x_i$ corresponding to a uniform computational mesh with $N=6$ cells. This implies $N+1=7$ nodes, with coordinates $\\xi_i = i/N = i/6$ for $i = 0, 1, 2, 3, 4, 5, 6$. We substitute each $\\xi_i$ into the derived mapping $x(\\xi)$.\n\nFor $i=0$:\n$$x_0 = \\ln\\left(1 + (e-1)\\frac{0}{6}\\right) = \\ln(1) = 0$$\nFor $i=1$:\n$$x_1 = \\ln\\left(1 + (e-1)\\frac{1}{6}\\right) = \\ln\\left(\\frac{6 + e - 1}{6}\\right) = \\ln\\left(\\frac{e+5}{6}\\right)$$\nFor $i=2$:\n$$x_2 = \\ln\\left(1 + (e-1)\\frac{2}{6}\\right) = \\ln\\left(1 + \\frac{e-1}{3}\\right) = \\ln\\left(\\frac{3 + e - 1}{3}\\right) = \\ln\\left(\\frac{e+2}{3}\\right)$$\nFor $i=3$:\n$$x_3 = \\ln\\left(1 + (e-1)\\frac{3}{6}\\right) = \\ln\\left(1 + \\frac{e-1}{2}\\right) = \\ln\\left(\\frac{2 + e - 1}{2}\\right) = \\ln\\left(\\frac{e+1}{2}\\right)$$\nFor $i=4$:\n$$x_4 = \\ln\\left(1 + (e-1)\\frac{4}{6}\\right) = \\ln\\left(1 + \\frac{2(e-1)}{3}\\right) = \\ln\\left(\\frac{3 + 2e - 2}{3}\\right) = \\ln\\left(\\frac{2e+1}{3}\\right)$$\nFor $i=5$:\n$$x_5 = \\ln\\left(1 + (e-1)\\frac{5}{6}\\right) = \\ln\\left(\\frac{6 + 5e - 5}{6}\\right) = \\ln\\left(\\frac{5e+1}{6}\\right)$$\nFor $i=6$:\n$$x_6 = \\ln\\left(1 + (e-1)\\frac{6}{6}\\right) = \\ln(1 + e - 1) = \\ln(e) = 1$$\n\nThe boundary nodes $x_0=0$ and $x_6=1$ correctly map to the domain boundaries, as expected. The derived mapping and the resulting node locations are the required solution.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\ln(1 + (e-1)\\xi) & 0 & \\ln\\left(\\frac{e+5}{6}\\right) & \\ln\\left(\\frac{e+2}{3}\\right) & \\ln\\left(\\frac{e+1}{2}\\right) & \\ln\\left(\\frac{2e+1}{3}\\right) & \\ln\\left(\\frac{5e+1}{6}\\right) & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Moving beyond simple mesh density, effective adaptation in higher dimensions requires controlling the shape and orientation of mesh elements. This is especially true for anisotropic phenomena like boundary layers or shocks, which have strong directional features. This practice delves into the theory of interpolation error, using the Hessian matrix of the solution to determine the locally optimal element aspect ratio and alignment that minimizes this error, providing a rigorous justification for the power of anisotropic meshing .",
            "id": "3344473",
            "problem": "Consider a smooth scalar field $u(\\boldsymbol{x})$ defined on $\\mathbb{R}^{2}$ with a locally constant symmetric positive definite Hessian $H \\in \\mathbb{R}^{2 \\times 2}$ at a point of interest, with ordered eigenpairs $\\{(\\lambda_{1},\\boldsymbol{v}_{1}),(\\lambda_{2},\\boldsymbol{v}_{2})\\}$ and $\\lambda_{1} \\ge \\lambda_{2} > 0$. In a mesh adaptation context for computational fluid dynamics, we approximate $u$ locally using bilinear finite element interpolation on a single rectangular element of fixed area $A_{e}$ whose sides have lengths $a$ and $b$ and can be arbitrarily oriented.\n\nUsing only fundamental facts and definitions:\n- Taylorâ€™s theorem to second order for $u$ in a local orthonormal coordinate system aligned with $\\{\\boldsymbol{v}_{1},\\boldsymbol{v}_{2}\\}$,\n- The definition of nodal bilinear interpolation on a rectangle,\n- The constraint that the element area satisfies $ab = A_{e}$,\n\nderive from first principles the element orientation and aspect ratio that minimize the maximum pointwise interpolation error over the element. Then, among all isotropic elements (rectangles with $a=b$) of the same area $A_{e}$, determine the maximum pointwise interpolation error and compare it with the optimal anisotropic error you derived.\n\nReport as your final answer the ratio of the isotropic error to the optimal anisotropic error, expressed solely in terms of $\\lambda_{1}$ and $\\lambda_{2}$. Do not round; give an exact analytic expression. No units are required.",
            "solution": "This solution finds the ratio of the maximum pointwise interpolation error for an isotropic element to that of an optimally-shaped anisotropic element, both of the same area, for a given scalar field.\n\n### Local Function Representation\nLet the point of interest be the origin $\\boldsymbol{x}_{0}=\\boldsymbol{0}$. We define a local orthonormal coordinate system $(\\xi_1, \\xi_2)$ such that the axes are aligned with the eigenvectors $\\boldsymbol{v}_{1}$ and $\\boldsymbol{v}_{2}$ of the Hessian $H$. In this coordinate system, the Hessian $H_{\\xi}$ is a diagonal matrix of the eigenvalues:\n$$H_{\\xi} = \\begin{pmatrix} \\lambda_1 & 0 \\\\ 0 & \\lambda_2 \\end{pmatrix}$$\nSince bilinear interpolation is exact for linear functions, the interpolation error is determined by the quadratic part of the Taylor expansion of $u$. Without loss of generality, we can analyze the error by considering the quadratic function $u_{quad}(\\xi_1, \\xi_2) = \\frac{1}{2}(\\lambda_1 \\xi_1^2 + \\lambda_2 \\xi_2^2)$.\n\n### Interpolation Error and Optimal Anisotropic Element\nTo minimize the interpolation error, we align a rectangular element of sides $a$ and $b$ with the $\\xi_1$ and $\\xi_2$ axes, respectively. The nodal values of $u_{quad}$ at the four vertices $(\\pm a/2, \\pm b/2)$ are identical:\n$$u_{quad}\\left(\\pm \\frac{a}{2}, \\pm \\frac{b}{2}\\right) = \\frac{1}{8}(\\lambda_1 a^2 + \\lambda_2 b^2) = C$$\nThe bilinear interpolant $\\Pi u_{quad}$ over the rectangle is the constant function $\\Pi u_{quad}(\\xi_1, \\xi_2) = C$. The pointwise interpolation error is $E(\\xi_1, \\xi_2) = u_{quad}(\\xi_1, \\xi_2) - C$. This error has its maximum magnitude at the center of the element $(\\xi_1, \\xi_2) = (0,0)$:\n$$E_{max\\_err} = |E(0,0)| = \\left|-\\frac{1}{8}(\\lambda_1 a^2 + \\lambda_2 b^2)\\right| = \\frac{1}{8}(\\lambda_1 a^2 + \\lambda_2 b^2)$$\nWe must minimize this error subject to the constraint $ab = A_e$, which implies $b=A_e/a$.\n$$E_{max\\_err}(a) = \\frac{1}{8}\\left(\\lambda_1 a^2 + \\lambda_2 \\frac{A_e^2}{a^2}\\right)$$\nTo find the minimum, we set the derivative with respect to $a$ to zero:\n$$\\frac{dE_{max\\_err}}{da} = \\frac{1}{8}\\left(2\\lambda_1 a - 2\\lambda_2 \\frac{A_e^2}{a^3}\\right) = 0 \\implies \\lambda_1 a^4 = \\lambda_2 A_e^2$$\nThis gives the optimal squared side lengths:\n$$a_{opt}^2 = A_e \\sqrt{\\frac{\\lambda_2}{\\lambda_1}} \\quad \\text{and} \\quad b_{opt}^2 = A_e\\sqrt{\\frac{\\lambda_1}{\\lambda_2}}$$\nThe optimal aspect ratio is $a_{opt}/b_{opt} = \\sqrt{\\lambda_2/\\lambda_1}$. The element is stretched in the direction of smaller curvature. The minimal, or optimal, error $E_{opt}$ is found by substituting these values back into the error expression:\n$$E_{opt} = \\frac{1}{8}\\left(\\lambda_1 a_{opt}^2 + \\lambda_2 b_{opt}^2\\right) = \\frac{1}{8}\\left(\\lambda_1 A_e \\sqrt{\\frac{\\lambda_2}{\\lambda_1}} + \\lambda_2 A_e \\sqrt{\\frac{\\lambda_1}{\\lambda_2}}\\right)$$\n$$E_{opt} = \\frac{A_e}{8}\\left(\\sqrt{\\lambda_1\\lambda_2} + \\sqrt{\\lambda_1\\lambda_2}\\right) = \\frac{A_e}{4}\\sqrt{\\lambda_1\\lambda_2}$$\n\n### Interpolation Error for an Isotropic Element\nAn isotropic element is a square, so $a=b$. The area constraint $ab = A_e$ gives $a = b = \\sqrt{A_e}$. The maximum pointwise error for a rectangular element aligned with the principal axes is $\\frac{1}{8}(\\lambda_1 a^2 + \\lambda_2 b^2)$. For the isotropic element, this becomes:\n$$E_{iso} = \\frac{1}{8}(\\lambda_1 A_e + \\lambda_2 A_e) = \\frac{A_e}{8}(\\lambda_1 + \\lambda_2)$$\nIt can be shown that the orientation of the isotropic element does not change this maximum pointwise error value.\n\n### Ratio of Errors\nThe ratio of the isotropic error to the optimal anisotropic error is:\n$$\\text{Ratio} = \\frac{E_{iso}}{E_{opt}} = \\frac{\\frac{A_e}{8}(\\lambda_1 + \\lambda_2)}{\\frac{A_e}{4}\\sqrt{\\lambda_1\\lambda_2}}$$\n$$\\text{Ratio} = \\frac{\\lambda_1 + \\lambda_2}{2\\sqrt{\\lambda_1\\lambda_2}}$$\nThis is the final expression for the ratio, solely in terms of $\\lambda_1$ and $\\lambda_2$.",
            "answer": "$$\\boxed{\\frac{\\lambda_{1} + \\lambda_{2}}{2\\sqrt{\\lambda_{1}\\lambda_{2}}}}$$"
        },
        {
            "introduction": "Real-world simulations often involve multiple, disparate physical features, each demanding different mesh characteristics. This hands-on problem addresses the practical challenge of merging these competing requirements into a single, coherent mesh specification through the elegant concept of metric intersection. You will not only derive the formula for combining two metric fields but also implement the crucial step of enforcing global constraints on element size, bridging the gap between adaptation theory and robust, practical implementation in a CFD workflow .",
            "id": "3344463",
            "problem": "You are implementing an anisotropic mesh adaptation operator in Computational Fluid Dynamics (CFD). In the Riemannian metric framework for anisotropic adaptation, a symmetric positive definite (SPD) metric tensor $M \\in \\mathbb{R}^{d \\times d}$ induces the squared Riemannian length $L^{2}(v;M) = v^{\\top} M v$ for any vector $v \\in \\mathbb{R}^{d}$. When two independent goal functionals are present (for example, one goal for shock resolution and another for boundary layer resolution), their adaptation requirements can be encoded as two SPD metrics $M_{1}$ and $M_{2}$. The combined anisotropic requirement is defined as the unique SPD matrix $M^{\\star}$ such that, for all $v \\in \\mathbb{R}^{d}$,\n$$\nv^{\\top} M^{\\star} v \\;=\\; \\min\\limits_{v_{1} + v_{2} = v} \\left( v_{1}^{\\top} M_{1} v_{1} + v_{2}^{\\top} M_{2} v_{2} \\right),\n$$\nthat is, the effective quadratic form equals the minimum of the sum of the two quadratic forms over all decompositions $v = v_{1} + v_{2}$. This operator is sometimes called the metric intersection of $M_{1}$ and $M_{2}$.\n\nIn addition to combining goals, mesh conformity imposes size-scale constraints on the metric field. In this problem, the conformity constraint is specified as a bound on the determinant of the combined metric $M^{\\star}$:\n$$\n\\det(M_{\\min}) \\;\\le\\; \\det(M^{\\star}) \\;\\le\\; \\det(M_{\\max}).\n$$\nWhen $\\det(M^{\\star})$ violates these bounds, isotropic scaling by a positive scalar $s$ must be used to enforce them; the scaled metric $s M^{\\star}$ must satisfy the determinant bounds. Recall the determinant scaling property for any $d \\times d$ matrix and scalar $s &gt; 0$: $\\det(s M) = s^{d} \\det(M)$.\n\nTasks:\n- Starting only from the above definitions and the properties of SPD matrices and determinants, derive an explicit computational procedure to obtain $M^{\\star}$ and to enforce the determinant bounds by isotropic scaling $s$.\n- Implement a program that, for each test case below, computes the raw combined metric $M^{\\star}$, checks the determinant bounds, applies isotropic scaling $s$ only if needed, and then reports specific numerical outputs.\n\nAngle unit specification:\n- All angles are given in radians.\n\nTest suite:\nFor each test case, you are given the dimension $d$, two SPD matrices $M_{1}, M_{2}$, and determinant bounds $(\\underline{\\Delta}, \\overline{\\Delta})$ to be enforced on $\\det(M^{\\star})$. Use the following test cases:\n\n- Case A (anisotropic, rotated in $d = 2$):\n  - $d = 2$.\n  - $M_{1} = R(\\theta) \\,\\mathrm{diag}(100, 1)\\, R(\\theta)^{\\top}$ with $\\theta = \\pi/6$, where $R(\\theta) = \\begin{bmatrix}\\cos\\theta &amp; -\\sin\\theta\\\\ \\sin\\theta &amp; \\cos\\theta\\end{bmatrix}$.\n  - $M_{2} = \\mathrm{diag}(0.5, 400)$.\n  - Bounds $(\\underline{\\Delta}, \\overline{\\Delta}) = (10^{-3}, 10^{6})$.\n- Case B (lower bound activation in $d = 2$):\n  - $d = 2$.\n  - $M_{1} = \\mathrm{diag}(10^{-3}, 10^{-3})$, $M_{2} = \\mathrm{diag}(10^{-3}, 10^{-3})$.\n  - Bounds $(\\underline{\\Delta}, \\overline{\\Delta}) = (10^{-2}, 10^{2})$.\n- Case C (upper bound activation in $d = 2$):\n  - $d = 2$.\n  - $M_{1} = \\mathrm{diag}(10^{3}, 10^{3})$, $M_{2} = \\mathrm{diag}(10^{3}, 10^{3})$.\n  - Bounds $(\\underline{\\Delta}, \\overline{\\Delta}) = (10^{-3}, 10^{4})$.\n- Case D (boundary equality in $d = 2$):\n  - $d = 2$.\n  - $M_{1} = \\mathrm{diag}(4, 4)$, $M_{2} = \\mathrm{diag}(4, 4)$.\n  - Bounds $(\\underline{\\Delta}, \\overline{\\Delta}) = (4, 4)$.\n- Case E (three-dimensional, mixed anisotropy, $d = 3$):\n  - $d = 3$.\n  - $M_{1} = \\mathrm{diag}(100, 1, 10)$, $M_{2} = \\mathrm{diag}(1, 50, 0.5)$.\n  - Bounds $(\\underline{\\Delta}, \\overline{\\Delta}) = (0.1, 0.5)$.\n\nOutput requirements:\n- For each test case, compute:\n  1. The raw determinant $\\det(M^{\\star})$ before any scaling.\n  2. The clamped determinant after enforcing bounds (by isotropic scaling if needed).\n  3. A boolean indicating whether scaling was applied.\n  4. The final clamped metric matrix entries in row-major order.\n- All floating-point numbers must be rounded to six decimal places.\n- The program must produce a single line of output containing a list of per-case results. Each per-case result is a list in the form\n  $[d, \\det(M^{\\star})_{\\text{rounded}}, \\det(M^{\\star}_{\\text{clamped}})_{\\text{rounded}}, \\text{scaled\\_flag}, [\\text{row-major entries of } M^{\\star}_{\\text{clamped}} \\text{ rounded}]]$.\n- The single line must be a comma-separated list enclosed in square brackets, containing the results for Cases A through E in order, with no spaces anywhere. For example, an output with two hypothetical cases would look like $[[2,1.234000,1.234000,False,[\\dots]],[3,0.456000,0.400000,True,[\\dots]]]$.\n\nYour program must hard-code the above test suite and produce exactly one line in the specified format. No external input is permitted. No physical units are involved; all quantities are nondimensional. Angles are in radians as stated above. All matrices are to be treated as SPD and computations should use standard linear algebra operations for SPD matrices in $\\mathbb{R}^{d \\times d}$.",
            "solution": "The solution is derived in two main parts: first, the derivation of the explicit formula for the combined metric tensor $M^{\\star}$, and second, the procedure for enforcing determinant bounds via isotropic scaling.\n\n### Part 1: Derivation of the Combined Anisotropic Metric $M^{\\star}$\n\nThe combined metric $M^{\\star}$ is defined by the quadratic form that results from a minimization problem. For any vector $v \\in \\mathbb{R}^{d}$, its squared Riemannian length with respect to $M^{\\star}$ is given by:\n$$\nv^{\\top} M^{\\star} v = \\min_{v_{1} + v_{2} = v} \\left( v_{1}^{\\top} M_{1} v_{1} + v_{2}^{\\top} M_{2} v_{2} \\right)\n$$\nwhere $M_1$ and $M_2$ are symmetric positive definite (SPD) matrices. This is a constrained optimization problem. We use the method of Lagrange multipliers. The Lagrangian function $\\mathcal{L}$ is constructed with a vector of Lagrange multipliers $\\lambda \\in \\mathbb{R}^d$:\n$$\n\\mathcal{L}(v_1, v_2, \\lambda) = v_{1}^{\\top} M_{1} v_{1} + v_{2}^{\\top} M_{2} v_{2} - \\lambda^{\\top} (v_1 + v_2 - v)\n$$\nThe first-order necessary conditions are found by setting the gradients of $\\mathcal{L}$ with respect to $v_1$ and $v_2$ to the zero vector.\n$$\n\\nabla_{v_1} \\mathcal{L} = 2 M_1 v_1 - \\lambda = 0 \\implies v_1 = \\frac{1}{2} M_1^{-1} \\lambda\n$$\n$$\n\\nabla_{v_2} \\mathcal{L} = 2 M_2 v_2 - \\lambda = 0 \\implies v_2 = \\frac{1}{2} M_2^{-1} \\lambda\n$$\nApplying the constraint $v_1 + v_2 = v$:\n$$\n\\frac{1}{2} (M_1^{-1} + M_2^{-1}) \\lambda = v \\implies \\lambda = 2 (M_1^{-1} + M_2^{-1})^{-1} v\n$$\nThe minimum value of the objective function is $v^{\\top} M^{\\star} v = v^{\\top} (M_1^{-1} + M_2^{-1})^{-1} v$. Since this must hold for all $v$, we identify the matrix $M^{\\star}$ directly:\n$$\nM^{\\star} = (M_1^{-1} + M_2^{-1})^{-1}\n$$\nThis provides an explicit computational procedure for $M^{\\star}$:\n1. Compute the inverses $M_1^{-1}$ and $M_2^{-1}$.\n2. Sum the inverses: $S = M_1^{-1} + M_2^{-1}$.\n3. Invert the sum to obtain $M^{\\star} = S^{-1}$.\n\n### Part 2: Isotropic Scaling for Determinant Bounds Enforcement\n\nThe problem requires that the final metric, $M^{\\star}_{\\text{clamped}}$, satisfies $\\underline{\\Delta} \\le \\det(M^{\\star}_{\\text{clamped}}) \\le \\overline{\\Delta}$. If the raw combined metric $M^{\\star}$ does not satisfy these bounds, it must be isotropically scaled by a factor $s>0$.\n\nLet $\\Delta^{\\star} = \\det(M^{\\star})$. The scaled metric is $M^{\\star}_{\\text{clamped}} = s M^{\\star}$. The determinant of the scaled metric is $\\det(M^{\\star}_{\\text{clamped}}) = s^d \\Delta^{\\star}$. The procedure is:\n\n1.  **Check Bounds**: Calculate $\\Delta^{\\star} = \\det(M^{\\star})$.\n\n2.  **Determine Scaling Factor $s$**:\n    - **No scaling:** If $\\underline{\\Delta} \\le \\Delta^{\\star} \\le \\overline{\\Delta}$, set $s=1$.\n    - **Lower bound violated:** If $\\Delta^{\\star} < \\underline{\\Delta}$, we scale up to meet the minimum:\n      $$\n      s^d \\Delta^{\\star} = \\underline{\\Delta} \\implies s = \\left( \\frac{\\underline{\\Delta}}{\\Delta^{\\star}} \\right)^{1/d}\n      $$\n    - **Upper bound violated:** If $\\Delta^{\\star} > \\overline{\\Delta}$, we scale down to meet the maximum:\n      $$\n      s^d \\Delta^{\\star} = \\overline{\\Delta} \\implies s = \\left( \\frac{\\overline{\\Delta}}{\\Delta^{\\star}} \\right)^{1/d}\n      $$\n\n3.  **Compute Final Metric**: The final, clamped metric is $M^{\\star}_{\\text{clamped}} = s M^{\\star}$.",
            "answer": "[[2,22.285744,22.285744,False,[0.998492,0.859667,0.859667,399.001508]],[2,0.000000,0.010000,True,[0.100000,0.000000,0.000000,0.100000]],[2,250000.000000,10000.000000,True,[100.000000,0.000000,0.000000,100.000000]],[2,4.000000,4.000000,False,[2.000000,0.000000,0.000000,2.000000]],[3,0.462225,0.462225,False,[0.990099,0.000000,0.000000,0.000000,0.980392,0.000000,0.000000,0.000000,0.476190]]]"
        }
    ]
}