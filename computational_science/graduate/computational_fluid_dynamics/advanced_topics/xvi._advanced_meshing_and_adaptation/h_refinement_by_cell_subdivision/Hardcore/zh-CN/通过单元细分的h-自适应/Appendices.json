{
    "hands_on_practices": [
        {
            "introduction": "h-自适应通过剖分网格单元来提升模拟精度，是一项基础技术。第一个实践将定量地审视均匀自适应的直接后果。通过计算单元数量的增长以及二阶格式下理论误差的相应减小，我们将具体理解计算成本与求解精度之间的权衡关系。",
            "id": "3328224",
            "problem": "考虑线性平流方程 $\\partial_{t} u + \\boldsymbol{a} \\cdot \\nabla u = 0$，定义在单位正方形 $\\Omega = [0,1] \\times [0,1]$ 上，其中平流速度 $\\boldsymbol{a} \\in \\mathbb{R}^{2}$ 为常数，且 $u$ 是光滑的。空间离散化采用基于结构化四边形网格的单元中心二阶有限体积(FV)方法。假设在 $\\partial \\Omega$ 的流入部分施加狄利克雷(Dirichlet)边界条件，并且唯一的全局耦合主未知量是每个单元的单元平均值 $u_{i}$；二阶精度通过使用从相邻单元平均值计算出的最小二乘梯度进行线性重构来实现。忽略时间离散误差和任何稳定化参数；仅关注空间离散属性。\n\n初始网格是均匀的，在 $x$ 方向上有 $N_{x} = 37$ 个单元，在 $y$ 方向上有 $N_{y} = 23$ 个单元，正好覆盖 $\\Omega$。通过在每个级别将每个四边形单元细分为四个全等的四边形（每个级别在每个坐标方向上二等分一次），执行两级均匀 $h$-自适应。令 $N_{0}$ 表示初始单元数，令 $N_{2}$ 表示两级自适应后的单元数。令 $\\text{DOF}_{2}$ 表示两级自适应后的全局耦合主自由度数。\n\n对于误差估计，将特征网格尺寸定义为 $h = \\max(\\Delta x, \\Delta y)$，其中在任何自适应级别，$\\Delta x = 1/N_{x}$ 且 $\\Delta y = 1/N_{y}$。对于应用于线性平流光滑解的二阶FV空间离散，假设全局范数 $E(h)$ 中的主阶空间离散误差服从渐近关系 $E(h) \\propto h^{2}$，且在渐近区域内，比例常数与自适应无关。使用 $h$ 的此定义和所述的自适应过程，确定：\n\n1. $N_{2}$，两级均匀 $h$-自适应后的总单元数，\n2. $\\text{DOF}_{2}$，两级自适应后的全局耦合主自由度数，\n3. 自适应后网格（两级后）与初始网格之间的误差减小因子 $R = E(h_{2})/E(h_{0})$，表示为精确分数。\n\n以单行矩阵 $\\begin{pmatrix} N_{2}  \\text{DOF}_{2}  R \\end{pmatrix}$ 的形式给出最终答案，不带单位。无需四舍五入；将 $R$ 表示为精确分数。",
            "solution": "该问题涉及均匀 $h$-自适应下的单元计数、单元中心方法的相应全局耦合自由度数，以及二阶有限体积(FV)格式下空间离散误差随网格尺寸的渐近标度关系。\n\n首先，考虑初始网格。域 $\\Omega = [0,1] \\times [0,1]$ 被一个结构化四边形网格覆盖，该网格在 $x$ 方向上有 $N_{x} = 37$ 个单元，在 $y$ 方向上有 $N_{y} = 23$ 个单元。因此，初始单元数为\n$$\nN_{0} = N_{x} N_{y} = 37 \\times 23 = 851.\n$$\n现在分析均匀 $h$-自适应的效果，即每个自适应级别将每个四边形单元细分为四个全等的四边形。将每个四边形细分为四个是通过在每个坐标方向上进行一次二等分来实现的，这使得 $x$ 和 $y$ 方向的分辨率都加倍。对于每个自适应级别：\n- 单元数增加 $4$ 倍（因为每个原始单元变成四个），\n- 每个方向的单元数加倍，即 $N_{x} \\mapsto 2 N_{x}$ 和 $N_{y} \\mapsto 2 N_{y}$。\n\n经过两级自适应后，单元数的总乘法因子为\n$$\n4 \\times 4 = 4^{2} = 16.\n$$\n因此，\n$$\nN_{2} = 16 N_{0} = 16 \\times 851 = 13{,}616.\n$$\n由于该格式是单元中心的，并且唯一的全局耦合主未知量是单元平均值 $u_{i}$，因此自由度数等于单元数。在所述的公式中，没有针对面或节点的额外全局耦合未知量，并且狄利克雷(Dirichlet)边界条件不会引入额外的自由度。因此，\n$$\n\\text{DOF}_{2} = N_{2} = 13{,}616.\n$$\n\n接下来，考虑网格尺寸和误差标度。对于均匀结构化网格，将特征网格尺寸定义为\n$$\nh = \\max(\\Delta x, \\Delta y), \\quad \\Delta x = \\frac{1}{N_{x}}, \\quad \\Delta y = \\frac{1}{N_{y}}.\n$$\n在一级均匀自适应下，$N_{x}$ 和 $N_{y}$ 各自加倍，因此 $\\Delta x$ 和 $\\Delta y$ 各自减半。因此 $h$ 减半。经过两级后，$N_{x}$ 和 $N_{y}$ 乘以 $4$，所以 $\\Delta x$ 和 $\\Delta y$ 都除以 $4$，因此\n$$\n\\frac{h_{2}}{h_{0}} = \\frac{1}{4}.\n$$\n对于应用于线性平流光滑解的二阶FV空间离散，主阶空间离散误差的标度关系为\n$$\nE(h) \\propto h^{2}.\n$$\n这种标度关系源于对带线性重构的通量进行泰勒级数分析，其中主截断误差项涉及 $u$ 的二阶导数乘以 $h^{2}$。因此，两级自适应后的误差减小因子为\n$$\nR = \\frac{E(h_{2})}{E(h_{0})} = \\left( \\frac{h_{2}}{h_{0}} \\right)^{2} = \\left( \\frac{1}{4} \\right)^{2} = \\frac{1}{16}.\n$$\n\n汇总结果，我们有\n$$\nN_{2} = 13{,}616, \\quad \\text{DOF}_{2} = 13{,}616, \\quad R = \\frac{1}{16}.\n$$\n这些可以作为所要求的行矩阵报告。",
            "answer": "$$\\boxed{\\begin{pmatrix}13616  13616  \\frac{1}{16}\\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然均匀自适应在计算上可能代价高昂，但仅在需要处进行选择性自适应似乎更为高效。然而，对于显式时间推进格式，这会引入一个与稳定性相关的关键挑战。本实践将探讨局部 h-自适应如何通过 Courant–Friedrichs–Lewy (CFL) 条件影响全局时间步长，从而揭示自适应网格加密 (AMR) 中的一个根本性权衡。",
            "id": "3328188",
            "problem": "考虑一个由欧拉方程控制的一维可压缩流，该流在长度为 $L$ 的区域上使用有限体积法在均匀网格上进行离散。求解器使用单一的全局时间步长进行时间推进，该步长受 Courant–Friedrichs–Lewy (CFL) 数控制的稳定性要求约束。假设使用的全局 Courant–Friedrichs–Lewy (CFL) 数为 $0.8$。\n\n区域长度为 $L=10\\,\\mathrm{m}$，初始网格有 $N=200$ 个均匀单元，每个单元的尺寸为 $h=L/N$。局部最大一维特征速度（等于与双曲系统相关的最大信号速度）在空间上是变化的：在一个包含 $0.05$ 比例单元（即 $0.05N$ 个单元）的连续区域中，速度达到其最大值 $a_{\\max}=1200\\,\\mathrm{m/s}$；在其他所有地方，速度为 $a_{\\mathrm{bulk}}=800\\,\\mathrm{m/s}$。仅在高速区域通过单元细分进行网格 h-自适应：这 $0.05N$ 个单元中的每一个都被分裂成两个相等的子单元，使得该处的局部单元尺寸减半，而所有其他单元保持不变。假设特征速度 $a_{\\max}$ 和 $a_{\\mathrm{bulk}}$ 在一个时间步长内保持不变，并且求解器使用一个受所有单元中最严格的局部时间步长约束的单一全局时间步长。\n\n根据双曲守恒律显式稳定性的第一性原理，确定在这次通过单元细分的 h-自适应之后新的全局时间步长 $\\Delta t$。以秒为单位表示最终的 $\\Delta t$，并将答案四舍五入到四位有效数字。",
            "solution": "正如题目所要求的，解答过程从应用于双曲守恒律的显式有限体积法的稳定性第一性原理出发。当使用单一全局时间步长 $\\Delta t$ 时，这种格式的稳定性由 Courant–Friedrichs–Lewy (CFL) 条件控制，该条件必须对计算网格中的每个单元 $i$ 都满足。对于一维问题，该条件由下式给出：\n$$C_i = \\frac{S_i \\Delta t}{h_i} \\le C$$\n其中 $h_i$ 是单元 $i$ 的尺寸，$S_i$ 是该单元内的局部最大信号速度（特征速度），$C$ 是最大允许 Courant 数，在此作为全局 CFL 数给出，即 $C = 0.8$。\n\n由于时间步长 $\\Delta t$ 是全局的（对所有单元都相同），因此必须选择它以满足最严格的局部条件。也就是说，$\\Delta t$ 受到要求最小稳定时间步长的单元的限制。这对应于比值 $\\frac{h_i}{S_i}$ 具有最小值的单元。因此，全局时间步长的计算公式为：\n$$\\Delta t = C \\min_{i} \\left( \\frac{h_i}{S_i} \\right)$$\n我们的任务是确定在指定的 h-自适应*之后*的网格的 $\\Delta t$。\n\n首先，我们描述自适应前网格的特性。区域长度为 $L=10\\,\\mathrm{m}$，被离散为 $N=200$ 个均匀单元。初始单元尺寸 $h$ 为：\n$$h = \\frac{L}{N} = \\frac{10\\,\\mathrm{m}}{200} = 0.05\\,\\mathrm{m}$$\n\n接下来，我们分析 h-自适应*之后*的网格。自适应是非均匀的。\n单元被分为两个区域：\n1. 一个高速区域，其特征速度为 $a_{\\max}=1200\\,\\mathrm{m/s}$。该区域最初包含 $f_{\\text{high}} = 0.05$ 比例的单元，即 $0.05 \\times 200 = 10$ 个单元。这些单元中的每一个都被分裂成两个，因此它们的尺寸减半。这个自适应区域的新单元尺寸 $h_{\\text{ref}}$ 为：\n$$h_{\\text{ref}} = \\frac{h}{2} = \\frac{0.05\\,\\mathrm{m}}{2} = 0.025\\,\\mathrm{m}$$\n\n2. 一个主体区域，即区域的其余部分。此处的特征速度为 $a_{\\mathrm{bulk}}=800\\,\\mathrm{m/s}$。该区域的单元未被自适应。它们的尺寸 $h_{\\text{bulk}}$ 与初始单元尺寸相同：\n$$h_{\\text{bulk}} = h = 0.05\\,\\mathrm{m}$$\n\n现在，我们为修改后网格中每种类型的单元计算比值 $\\frac{h_i}{S_i}$，以找到最小值。\n对于未自适应的主体区域中的一个单元：\n$$\\frac{h_{\\text{bulk}}}{a_{\\mathrm{bulk}}} = \\frac{0.05\\,\\mathrm{m}}{800\\,\\mathrm{m/s}} = 6.25 \\times 10^{-5}\\,\\mathrm{s}$$\n对于自适应的高速区域中的一个单元：\n$$\\frac{h_{\\text{ref}}}{a_{\\max}} = \\frac{0.025\\,\\mathrm{m}}{1200\\,\\mathrm{m/s}} = \\frac{0.025}{1.2 \\times 10^3}\\,\\mathrm{s} \\approx 2.0833... \\times 10^{-5}\\,\\mathrm{s}$$\n\n我们必须找到这两个值中的最小值来确定全局时间步长的约束：\n$$\\min_{i} \\left( \\frac{h_i}{S_i} \\right) = \\min \\left( \\frac{h_{\\text{bulk}}}{a_{\\mathrm{bulk}}}, \\frac{h_{\\text{ref}}}{a_{\\max}} \\right) = \\min(6.25 \\times 10^{-5}\\,\\mathrm{s}, 2.0833... \\times 10^{-5}\\,\\mathrm{s})$$\n最小值由自适应的高速区域中的单元决定：\n$$\\min_{i} \\left( \\frac{h_i}{S_i} \\right) = \\frac{h_{\\text{ref}}}{a_{\\max}} = \\frac{0.025\\,\\mathrm{m}}{1200\\,\\mathrm{m/s}}$$\n\n最后，我们使用给定的 CFL 数 $C = 0.8$ 来计算新的全局时间步长 $\\Delta t$。\n$$\\Delta t = C \\left( \\frac{h_{\\text{ref}}}{a_{\\max}} \\right) = 0.8 \\times \\frac{0.025\\,\\mathrm{m}}{1200\\,\\mathrm{m/s}}$$\n我们来计算精确值：\n$$\\Delta t = \\frac{4}{5} \\times \\frac{0.025}{1200} = \\frac{4}{5} \\times \\frac{25 \\times 10^{-3}}{1200} = \\frac{100 \\times 10^{-3}}{6000} = \\frac{10^{-1}}{6000} = \\frac{1}{60000}\\,\\mathrm{s} \\approx 1.666... \\times 10^{-5}\\,\\mathrm{s}$$\n题目要求答案四舍五入到四位有效数字。\n$$\\Delta t \\approx 1.667 \\times 10^{-5}\\,\\mathrm{s}$$",
            "answer": "$$\\boxed{1.667 \\times 10^{-5}}$$"
        },
        {
            "introduction": "当一个单元被剖分时，新生成的子单元必须被赋予物理上和数值上都一致的初值。这个被称为“延拓”（prolongation）的过程是 AMR 算法的基石。本实践将演示如何从父单元的状态（平均值和梯度）推导子单元的初始值，并确保在自适应操作前后，守恒量得以精确保持。",
            "id": "3328211",
            "problem": "考虑在均匀笛卡尔网格上对标量守恒量 $u(x,y)$ 进行的二维有限体积离散化。一个边长为 $\\Delta x$ 和 $\\Delta y$ 的粗矩形父单元，其形心位于 $(x_{c},y_{c})$，单元平均值为 $\\bar{u}$，并在该单元内估计出一个重构的常数梯度向量 $\\boldsymbol{g}=(g_{x},g_{y})$。在自适应网格加密 (AMR) 过程中，通过将该父单元细分为四个相等的子单元来执行 h-自适应。假设坐标轴的定向为 x 轴向东增加，y 轴向北增加。四个子单元的形心分别位于 $(x_{c}\\pm \\Delta x/4,\\,y_{c}\\pm \\Delta y/4)$，对应于东北、西北、西南和东南子单元。\n\n使用与粗单元重构一致的线性延拓，并根据单元平均值的有限体积定义，推导四个子单元平均值 $u^{\\text{child}}$ 的表达式，以保持父单元上的质量守恒。将最终答案表示为一个单行矩阵，按顺序包含东北、西北、西南和东南子单元的平均值。无需进行数值四舍五入，并用 $\\bar{u}$、$g_{x}$、$g_{y}$、$\\Delta x$ 和 $\\Delta y$ 以符号形式表示你的答案。",
            "solution": "在父单元内，标量场 $u(x,y)$ 的线性重构由以下平面函数给出，该父单元中心位于 $(x_c, y_c)$，单元平均值为 $\\bar{u}$，常数梯度为 $\\boldsymbol{g}=(g_x, g_y)$：\n$$\nu(x,y) = \\bar{u} + g_x (x - x_c) + g_y (y - y_c)\n$$\n此重构是一致的，意味着其在父单元上的平均值为 $\\bar{u}$。父单元覆盖的区域为 $[x_c - \\frac{\\Delta x}{2}, x_c + \\frac{\\Delta x}{2}] \\times [y_c - \\frac{\\Delta y}{2}, y_c + \\frac{\\Delta y}{2}]$。在此对称区域上，$(x-x_c)$ 和 $(y-y_c)$ 的积分均为零，从而证实了一致性。\n\n任何量 $f(x,y)$ 在面积为 $A$ 的单元 $\\Omega$ 上的单元平均值定义为：\n$$\n\\bar{f} = \\frac{1}{A} \\iint_{\\Omega} f(x,y) \\,dx\\,dy\n$$\n对于形式为 $f(x,y) = a + b_1 x + b_2 y$ 的线性函数，在矩形区域 $\\Omega = [x_1, x_2] \\times [y_1, y_2]$ 上积分，其平均值等于该函数在矩形形心 $(\\frac{x_1+x_2}{2}, \\frac{y_1+y_2}{2})$ 处的值。\n我们重构的函数 $u(x,y)$ 是线性的。子单元是矩形的。因此，每个子单元的平均值 $\\bar{u}_{\\text{child}}$ 就是重构函数 $u(x,y)$ 在该子单元形心处的值。\n\n父单元被分为四个相等的子单元，每个子单元的尺寸为 $\\frac{\\Delta x}{2} \\times \\frac{\\Delta y}{2}$。问题给出了四个子单元相对于父单元形心 $(x_c, y_c)$ 的形心位置。我们将使用这些形心来计算每个子单元的平均值。\n\n**东北 (NE) 子单元：**\n形心位于 $(x_{\\text{NE}}, y_{\\text{NE}}) = (x_{c} + \\frac{\\Delta x}{4}, y_{c} + \\frac{\\Delta y}{4})$。\n$$\n\\bar{u}_{\\text{NE}} = u(x_{\\text{NE}}, y_{\\text{NE}}) = \\bar{u} + g_x \\left( \\left(x_c + \\frac{\\Delta x}{4}\\right) - x_c \\right) + g_y \\left( \\left(y_c + \\frac{\\Delta y}{4}\\right) - y_c \\right)\n$$\n$$\n\\bar{u}_{\\text{NE}} = \\bar{u} + g_x \\frac{\\Delta x}{4} + g_y \\frac{\\Delta y}{4}\n$$\n\n**西北 (NW) 子单元：**\n形心位于 $(x_{\\text{NW}}, y_{\\text{NW}}) = (x_{c} - \\frac{\\Delta x}{4}, y_{c} + \\frac{\\Delta y}{4})$。\n$$\n\\bar{u}_{\\text{NW}} = u(x_{\\text{NW}}, y_{\\text{NW}}) = \\bar{u} + g_x \\left( \\left(x_c - \\frac{\\Delta x}{4}\\right) - x_c \\right) + g_y \\left( \\left(y_c + \\frac{\\Delta y}{4}\\right) - y_c \\right)\n$$\n$$\n\\bar{u}_{\\text{NW}} = \\bar{u} - g_x \\frac{\\Delta x}{4} + g_y \\frac{\\Delta y}{4}\n$$\n\n**西南 (SW) 子单元：**\n形心位于 $(x_{\\text{SW}}, y_{\\text{SW}}) = (x_{c} - \\frac{\\Delta x}{4}, y_{c} - \\frac{\\Delta y}{4})$。\n$$\n\\bar{u}_{\\text{SW}} = u(x_{\\text{SW}}, y_{\\text{SW}}) = \\bar{u} + g_x \\left( \\left(x_c - \\frac{\\Delta x}{4}\\right) - x_c \\right) + g_y \\left( \\left(y_c - \\frac{\\Delta y}{4}\\right) - y_c \\right)\n$$\n$$\n\\bar{u}_{\\text{SW}} = \\bar{u} - g_x \\frac{\\Delta x}{4} - g_y \\frac{\\Delta y}{4}\n$$\n\n**东南 (SE) 子单元：**\n形心位于 $(x_{\\text{SE}}, y_{\\text{SE}}) = (x_{c} + \\frac{\\Delta x}{4}, y_{c} - \\frac{\\Delta y}{4})$。\n$$\n\\bar{u}_{\\text{SE}} = u(x_{\\text{SE}}, y_{\\text{SE}}) = \\bar{u} + g_x \\left( \\left(x_c + \\frac{\\Delta x}{4}\\right) - x_c \\right) + g_y \\left( \\left(y_c - \\frac{\\Delta y}{4}\\right) - y_c \\right)\n$$\n$$\n\\bar{u}_{\\text{SE}} = \\bar{u} + g_x \\frac{\\Delta x}{4} - g_y \\frac{\\Delta y}{4}\n$$\n\n**守恒性检验：**\n为了验证此延拓方案是守恒的，四个子单元值的平均值必须等于父单元的平均值 $\\bar{u}$。由于子单元面积相等，我们取其算术平均值：\n$$\n\\frac{1}{4}(\\bar{u}_{\\text{NE}} + \\bar{u}_{\\text{NW}} + \\bar{u}_{\\text{SW}} + \\bar{u}_{\\text{SE}}) = \\frac{1}{4} \\left[ \\left(\\bar{u} + \\frac{g_x\\Delta x}{4} + \\frac{g_y\\Delta y}{4}\\right) + \\left(\\bar{u} - \\frac{g_x\\Delta x}{4} + \\frac{g_y\\Delta y}{4}\\right) + \\left(\\bar{u} - \\frac{g_x\\Delta x}{4} - \\frac{g_y\\Delta y}{4}\\right) + \\left(\\bar{u} + \\frac{g_x\\Delta x}{4} - \\frac{g_y\\Delta y}{4}\\right) \\right]\n$$\n将方括号内的项相加：\n$\\bar{u}$ 项的总和为 $4\\bar{u}$。\n$g_x$ 项的总和为 $\\frac{g_x\\Delta x}{4}(1 - 1 - 1 + 1) = 0$。\n$g_y$ 项的总和为 $\\frac{g_y\\Delta y}{4}(1 + 1 - 1 - 1) = 0$。\n总和为 $4\\bar{u}$。平均值为 $\\frac{1}{4}(4\\bar{u}) = \\bar{u}$。\n守恒性得以保持。\n\n最终答案是这四个值按指定顺序（东北、西北、西南、东南）组成的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\bar{u} + \\frac{g_x \\Delta x}{4} + \\frac{g_y \\Delta y}{4} & \\bar{u} - \\frac{g_x \\Delta x}{4} + \\frac{g_y \\Delta y}{4} & \\bar{u} - \\frac{g_x \\Delta x}{4} - \\frac{g_y \\Delta y}{4} & \\bar{u} + \\frac{g_x \\Delta x}{4} - \\frac{g_y \\Delta y}{4}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}