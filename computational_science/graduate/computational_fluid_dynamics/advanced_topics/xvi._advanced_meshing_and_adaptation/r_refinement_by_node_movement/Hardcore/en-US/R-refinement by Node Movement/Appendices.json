{
    "hands_on_practices": [
        {
            "introduction": "The core idea of r-refinement is to redistribute nodes such that a chosen \"monitor function,\" which tracks solution features like gradients, is spread evenly across the mesh. This practice challenges you to apply this equidistribution principle directly to a one-dimensional domain . By deriving and numerically solving the implicit equation for node positions, you will gain a concrete understanding of how a mathematical principle translates into a practical mesh adaptation strategy.",
            "id": "3355747",
            "problem": "Consider r-refinement by node movement in Computational Fluid Dynamics (CFD), where the physical domain $[0,1]$ is mapped from a uniform computational coordinate $s \\in [0,1]$ by a monotone function $x(s)$. Let the solution surrogate be $u(x) = \\tanh(\\beta(x - 0.5))$ for a given positive parameter $\\beta$, and define the monitor function $M(x) = 1 + \\alpha |u_x(x)|$, where $\\alpha \\ge 0$ is a given parameter and $u_x$ denotes the derivative of $u$ with respect to $x$. The goal of r-refinement is to move nodes $\\{x_i\\}_{i=0}^{N-1}$ to equidistribute the monitor $M$ so that each interval in the physical domain is allocated an equal amount of the monitor, while remaining consistent with the fixed endpoints $x_0 = 0$ and $x_{N-1} = 1$.\n\nStarting from the definition of equidistribution and the requirement that a uniform partition in the computational coordinate $s_i = i/(N-1)$ for $i = 0,1,\\dots,N-1$ maps to the physical nodes $\\{x_i\\}$ with equal monitor measure per interval, derive the implicit equation that the nodes $\\{x_i\\}$ must satisfy. Then, using that $u(x) = \\tanh(\\beta(x - 0.5))$, compute the nodes $\\{x_i\\}$ for $N = 10$ for each of the following test cases, expressed as lists of floating-point values:\n1. $\\alpha = 0$, $\\beta = 5$.\n2. $\\alpha = 2$, $\\beta = 10$.\n3. $\\alpha = 5$, $\\beta = 50$.\n4. $\\alpha = 10^{-6}$, $\\beta = 20$.\n5. $\\alpha = 3$, $\\beta = 0$.\n\nAll computations must be based on the equidistribution principle and the mathematical form of $M(x)$ given above. Your program must numerically solve the implicit equations when a closed-form inversion is not available, ensuring that nodes remain within the domain $[0,1]$ and are sorted in increasing order. The final node positions must be expressed as floating-point numbers rounded to eight decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists, where each inner list corresponds to the $N$ node positions for one test case, enclosed in square brackets. For example, the output format must be exactly like:\n$[ [x_{0}^{(1)}, x_{1}^{(1)}, \\dots, x_{9}^{(1)}], [x_{0}^{(2)}, \\dots, x_{9}^{(2)}], \\dots ]$\nbut printed without spaces after commas. The numeric domain has no physical units for this problem, and all angles, if any, are in radians; however, no angles are used here.\n\nAll answers must be computed numerically and returned in the required format with each node rounded to eight decimal places. The program must not read input; it must use the specified test suite internally and print the single-line result.",
            "solution": "The principle of r-refinement by node movement in Computational Fluid Dynamics (CFD) relies on mapping a uniform computational grid to a physical grid through a monotone function $x(s)$, where $s \\in [0,1]$ is the computational coordinate and $x \\in [0,1]$ is the physical coordinate. The equidistribution principle states that the monitor function $M(x)$, which measures local features of the solution such as gradients, should be equidistributed across each physical interval. This implies that the cumulative measure of $M$ between adjacent nodes is equal.\n\nLet $s_i = i/(N-1)$ be uniformly spaced computational nodes for $i = 0,1,\\dots,N-1$. The equidistribution requirement can be expressed by asserting that each physical interval receives an equal measure of the monitor function $M$. Define the cumulative monitor function\n$$\nF(x) = \\int_{0}^{x} M(\\xi)\\,\\mathrm{d}\\xi.\n$$\nThe equidistribution principle can then be written as the mapping\n$$\nF\\big(x(s)\\big) = s\\,F(1),\n$$\nwhich implies for the discrete nodes\n$$\nF(x_i) = s_i\\,F(1) = \\frac{i}{N-1}\\,F(1), \\quad i=0,1,\\dots,N-1.\n$$\nThis provides an implicit equation that the nodes $x_i$ must satisfy. Differentiating $F(x(s)) = s\\,F(1)$ with respect to $s$ yields\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}s} F\\big(x(s)\\big) = F(1) \\quad \\Rightarrow \\quad M\\big(x(s)\\big)\\,\\frac{\\mathrm{d}x}{\\mathrm{d}s} = F(1),\n$$\nwhich shows that the product $M(x)\\,x_s$ is a constant, aligning with the equidistribution of the monitor across the $s$-coordinate.\n\nFor the given $u(x) = \\tanh(\\beta(x - 0.5))$, its derivative is\n$$\nu_x(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\tanh(\\beta(x - 0.5)) = \\beta\\,\\operatorname{sech}^2(\\beta(x - 0.5)).\n$$\nSince $\\operatorname{sech}^2$ is nonnegative, $|u_x(x)| = \\beta\\,\\operatorname{sech}^2(\\beta(x - 0.5))$. Therefore, the monitor function is\n$$\nM(x) = 1 + \\alpha\\,\\beta\\,\\operatorname{sech}^2(\\beta(x - 0.5)).\n$$\nWe require the cumulative integral $F(x)$:\n$$\nF(x) = \\int_{0}^{x} \\left[1 + \\alpha\\,\\beta\\,\\operatorname{sech}^2(\\beta(\\xi - 0.5))\\right] \\mathrm{d}\\xi\n= \\int_{0}^{x} 1\\,\\mathrm{d}\\xi + \\alpha \\int_{0}^{x} \\beta\\,\\operatorname{sech}^2(\\beta(\\xi - 0.5)) \\mathrm{d}\\xi.\n$$\nUsing the identity $\\frac{\\mathrm{d}}{\\mathrm{d}\\xi} \\tanh(\\beta(\\xi - 0.5)) = \\beta\\,\\operatorname{sech}^2(\\beta(\\xi - 0.5))$, the integral evaluates as\n$$\nF(x) = x + \\alpha\\left[\\tanh(\\beta(x - 0.5)) - \\tanh(\\beta(0 - 0.5))\\right]\n= x + \\alpha\\left[\\tanh(\\beta(x - 0.5)) + \\tanh(\\beta/2)\\right],\n$$\nbecause $\\tanh(-z) = -\\tanh(z)$. The total cumulative measure is\n$$\nF(1) = 1 + \\alpha\\left[\\tanh(\\beta(1 - 0.5)) - \\tanh(\\beta(0 - 0.5))\\right]\n= 1 + \\alpha\\left[\\tanh(\\beta/2) - \\big(-\\tanh(\\beta/2)\\big)\\right]\n= 1 + 2\\alpha\\,\\tanh(\\beta/2).\n$$\n\nTherefore, the implicit equation for the nodes is\n$$\nF(x_i) = \\frac{i}{N-1}\\,F(1),\n$$\nnamely,\n$$\nx_i + \\alpha\\left[\\tanh(\\beta(x_i - 0.5)) + \\tanh(\\beta/2)\\right] = \\frac{i}{N-1}\\left[1 + 2\\alpha\\,\\tanh(\\beta/2)\\right], \\quad i = 0,1,\\dots,N-1.\n$$\nThis equation must be solved for each $x_i$. The function $F(x)$ is strictly increasing on $[0,1]$ because $M(x) > 0$ for $\\alpha \\ge 0$ and $\\beta \\ge 0$, so $F$ is invertible. For $i=0$, we have $F(x_0) = 0$, which gives $x_0 = 0$. For $i = N-1$, we have $F(x_{N-1}) = F(1)$, which gives $x_{N-1} = 1$. For the interior nodes $i = 1,2,\\dots,N-2$, one may solve $F(x_i) = \\tau_i$ with target values\n$$\n\\tau_i = \\frac{i}{N-1} F(1) = \\frac{i}{N-1}\\left(1 + 2\\alpha\\,\\tanh(\\beta/2)\\right).\n$$\nSince $F$ is monotone, standard numerical root-finding methods such as the bisection method can be used to solve $F(x_i) - \\tau_i = 0$ on the interval $[0,1]$. The bisection method is robust for monotone functions and ensures that the solution $x_i$ lies within $[0,1]$. The computational procedure is:\n1. Compute $F(1) = 1 + 2\\alpha\\,\\tanh(\\beta/2)$.\n2. For each $i$, set $\\tau_i = \\frac{i}{N-1} F(1)$.\n3. For $i=0$ and $i=N-1$, set $x_0 = 0$ and $x_{N-1} = 1$ directly.\n4. For $i=1,2,\\dots,N-2$, solve $F(x) - \\tau_i = 0$ for $x \\in [0,1]$ using bisection:\n   - Initialize $a=0$, $b=1$, compute $G(a) = F(a) - \\tau_i$, $G(b) = F(b) - \\tau_i$; these have opposite signs or $G(a) \\le 0 \\le G(b)$.\n   - Iterate until convergence: $m = (a+b)/2$, compute $G(m)$, and replace $a$ or $b$ by $m$ depending on the sign of $G(m)$.\n   - Stop when the interval width or residual is below a tolerance and take $x_i \\approx m$.\n\nThis procedure yields the node positions $\\{x_i\\}_{i=0}^{N-1}$ that equidistribute the monitor $M$. For the five test cases with $N = 10$, the program computes and prints the node lists in the specified single-line format, rounding each node to eight decimal places. The cases include uniform grids (for $\\alpha = 0$ or $\\beta = 0$), nearly uniform grids (for very small $\\alpha$), and strongly graded grids near $x=0.5$ for large $\\beta$ and moderate-to-large $\\alpha$, thereby testing both the happy path and edge behaviors of the algorithm.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cumulative_F(x: float, alpha: float, beta: float) -> float:\n    \"\"\"\n    Cumulative integral F(x) = ∫_0^x M(ξ) dξ with\n    M(x) = 1 + alpha * beta * sech^2(beta * (x - 0.5)).\n    Using analytical integration:\n    F(x) = x + alpha * [tanh(beta*(x - 0.5)) + tanh(beta/2)]\n    \"\"\"\n    return x + alpha * (np.tanh(beta * (x - 0.5)) + np.tanh(beta / 2.0))\n\ndef total_F1(alpha: float, beta: float) -> float:\n    \"\"\"\n    F(1) = ∫_0^1 M(ξ) dξ = 1 + 2*alpha*tanh(beta/2)\n    \"\"\"\n    return 1.0 + 2.0 * alpha * np.tanh(beta / 2.0)\n\ndef equidistributed_nodes(alpha: float, beta: float, N: int) -> list:\n    \"\"\"\n    Compute N nodes x_i in [0,1] that equidistribute M(x) = 1 + alpha*|u_x|,\n    with u_x = beta * sech^2(beta*(x-0.5)).\n    Nodes satisfy F(x_i) = (i/(N-1)) * F(1), with F cumulative monitor.\n    Uses bisection to invert F for interior nodes. Returns list of floats.\n    \"\"\"\n    # Ensure parameters are nonnegative to keep M positive\n    if alpha < 0 or beta < 0:\n        raise ValueError(\"alpha and beta must be nonnegative.\")\n\n    nodes = [0.0] * N\n    F1 = total_F1(alpha, beta)\n\n    # Endpoints\n    nodes[0] = 0.0\n    nodes[-1] = 1.0\n\n    # Tolerance settings for bisection\n    tol = 1e-12\n    max_iter = 200\n\n    # Compute interior nodes\n    for i in range(1, N - 1):\n        tau_i = (i / (N - 1)) * F1\n\n        # Bisection bracket [a,b] = [0,1]\n        a, b = 0.0, 1.0\n        Fa = cumulative_F(a, alpha, beta) - tau_i\n        Fb = cumulative_F(b, alpha, beta) - tau_i\n\n        # Handle trivial cases if tau_i is at endpoints due to numerical round-off\n        if abs(Fa) < tol:\n            nodes[i] = a\n            continue\n        if abs(Fb) < tol:\n            nodes[i] = b\n            continue\n\n        # Ensure valid bracket: Fa <= 0 <= Fb\n        # Due to monotonicity of F, this should hold.\n        # If not, adjust slightly (robustness).\n        if Fa > 0 and Fb > 0:\n            # Both positive: move a left slightly (not possible in [0,1]); fallback to a\n            nodes[i] = a\n            continue\n        if Fa < 0 and Fb < 0:\n            # Both negative: move b right slightly (not possible); fallback to b\n            nodes[i] = b\n            continue\n\n        # Bisection loop\n        for _ in range(max_iter):\n            m = 0.5 * (a + b)\n            Fm = cumulative_F(m, alpha, beta) - tau_i\n\n            # Check convergence\n            if abs(Fm) < tol or (b - a) < tol:\n                nodes[i] = m\n                break\n\n            # Update bracket\n            if Fm < 0:\n                a = m\n                Fa = Fm\n            else:\n                b = m\n                Fb = Fm\n        else:\n            # If max_iter exhausted, take midpoint\n            nodes[i] = 0.5 * (a + b)\n\n    return nodes\n\ndef format_nested_lists(nested_lists, decimals=8):\n    \"\"\"\n    Format a list of lists of floats into a single-line string with:\n    - Outer brackets and inner brackets preserved\n    - Commas with no spaces\n    - Floats rounded to the specified number of decimals\n    Example: [[0.0,0.1],[0.2,0.3]]\n    \"\"\"\n    def fmt_float(x):\n        # Round and format ensuring fixed decimal places\n        return f\"{round(x, decimals):.{decimals}f}\"\n    inner_strs = []\n    for lst in nested_lists:\n        nums = [fmt_float(v) for v in lst]\n        inner = \"[\" + \",\".join(nums) + \"]\"\n        inner_strs.append(inner)\n    return \"[\" + \",\".join(inner_strs) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple: (alpha, beta, N)\n    test_cases = [\n        (0.0, 5.0, 10),         # Uniform due to alpha=0\n        (2.0, 10.0, 10),        # Strong clustering near x=0.5\n        (5.0, 50.0, 10),        # Extreme clustering near x=0.5\n        (1e-6, 20.0, 10),       # Nearly uniform\n        (3.0, 0.0, 10),         # Uniform due to beta=0\n    ]\n\n    results = []\n    for alpha, beta, N in test_cases:\n        nodes = equidistributed_nodes(alpha, beta, N)\n        results.append(nodes)\n\n    # Final print statement in the exact required format.\n    print(format_nested_lists(results, decimals=8))\n\nsolve()\n```"
        },
        {
            "introduction": "A mesh adaptation scheme is only practical if it preserves the integrity of the mesh, preventing elements from tangling or inverting. This exercise focuses on this crucial constraint by analyzing the motion of a single triangular element . You will derive a conservative bound on the node movement step size that guarantees the element's Jacobian, and thus its signed area, remains positive, a fundamental building block for robust r-refinement algorithms.",
            "id": "3355703",
            "problem": "In Computational Fluid Dynamics (CFD), $r$-refinement by node movement must maintain mesh validity, which is defined by the positivity of the local Jacobian determinant $J_e$ for every element. Consider a single two-dimensional triangular finite element with vertices at positions $\\mathbf{x}_1$, $\\mathbf{x}_2$, and $\\mathbf{x}_3$ in $\\mathbb{R}^2$, and a linear isoparametric mapping from a reference triangle. The mapping is characterized by the Jacobian matrix $\\mathbf{F} = \\nabla_{\\boldsymbol{\\xi}} \\mathbf{x}(\\boldsymbol{\\xi})$ and its determinant $J_e = \\det(\\mathbf{F})$, which is constant over the element for linear shape functions. The signed area criterion for validity requires $J_e > 0$, which is equivalent to the element having positive signed area and preserving orientation.\n\nSuppose the element nodes move according to $\\mathbf{x}_i(\\alpha) = \\mathbf{x}_i + \\alpha \\mathbf{w}_i$, where $\\alpha \\ge 0$ is a dimensionless step size and $\\mathbf{w}_i$ are prescribed node velocities associated with $r$-refinement. Starting from the fundamental definition of the Jacobian determinant for a linear triangular element and the signed area formula, derive a sufficient condition on the node movements, expressed as a conservative bound on $\\alpha$, that guarantees $J_e(\\alpha) > 0$ for the updated element.\n\nThen, for the specific triangle with nodes\n$\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (1, 0)$, and $\\mathbf{x}_3 = (0.3, 0.8)$,\nand node velocities\n$\\mathbf{w}_1 = (0, 0)$, $\\mathbf{w}_2 = (0.4, -0.6)$, and $\\mathbf{w}_3 = (-0.1, -0.1)$,\ncompute the largest conservative bound $\\alpha_{\\max}$ that ensures $J_e(\\alpha) > 0$ based on your derived sufficient condition. Round your final $\\alpha_{\\max}$ to four significant figures. Express the final answer as a dimensionless quantity.",
            "solution": "The validity of a two-dimensional linear triangular element is maintained if its signed area remains positive. For a linear isoparametric mapping, the Jacobian determinant, $J_e$, is constant throughout the element and is directly proportional to this signed area. We can express $J_e$ as the determinant of a matrix formed by two edge vectors of the triangle emanating from a common vertex. Let the vertices be $\\mathbf{x}_1$, $\\mathbf{x}_2$, and $\\mathbf{x}_3$. We define the edge vectors $\\mathbf{e}_{12} = \\mathbf{x}_2 - \\mathbf{x}_1$ and $\\mathbf{e}_{13} = \\mathbf{x}_3 - \\mathbf{x}_1$. The Jacobian determinant is then given by:\n$$J_e = \\det(\\mathbf{e}_{12}, \\mathbf{e}_{13})$$\nwhere $\\mathbf{e}_{12}$ and $\\mathbf{e}_{13}$ are treated as column vectors. The mesh validity criterion is $J_e > 0$.\n\nThe node positions are updated according to the rule $\\mathbf{x}_i(\\alpha) = \\mathbf{x}_i + \\alpha \\mathbf{w}_i$ for a non-negative step size $\\alpha \\ge 0$. The new edge vectors as a function of $\\alpha$ are:\n$$ \\mathbf{e}_{12}(\\alpha) = \\mathbf{x}_2(\\alpha) - \\mathbf{x}_1(\\alpha) = (\\mathbf{x}_2 + \\alpha \\mathbf{w}_2) - (\\mathbf{x}_1 + \\alpha \\mathbf{w}_1) = (\\mathbf{x}_2 - \\mathbf{x}_1) + \\alpha (\\mathbf{w}_2 - \\mathbf{w}_1) = \\mathbf{e}_{12} + \\alpha \\Delta\\mathbf{w}_{12} $$\n$$ \\mathbf{e}_{13}(\\alpha) = \\mathbf{x}_3(\\alpha) - \\mathbf{x}_1(\\alpha) = (\\mathbf{x}_3 + \\alpha \\mathbf{w}_3) - (\\mathbf{x}_1 + \\alpha \\mathbf{w}_1) = (\\mathbf{x}_3 - \\mathbf{x}_1) + \\alpha (\\mathbf{w}_3 - \\mathbf{w}_1) = \\mathbf{e}_{13} + \\alpha \\Delta\\mathbf{w}_{13} $$\nwhere $\\Delta\\mathbf{w}_{ij} = \\mathbf{w}_j - \\mathbf{w}_i$.\n\nThe Jacobian determinant for the updated element, $J_e(\\alpha)$, is:\n$$ J_e(\\alpha) = \\det(\\mathbf{e}_{12}(\\alpha), \\mathbf{e}_{13}(\\alpha)) = \\det(\\mathbf{e}_{12} + \\alpha \\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13} + \\alpha \\Delta\\mathbf{w}_{13}) $$\nUsing the bilinearity property of the determinant, we can expand this expression:\n$$ J_e(\\alpha) = \\det(\\mathbf{e}_{12}, \\mathbf{e}_{13}) + \\alpha \\det(\\mathbf{e}_{12}, \\Delta\\mathbf{w}_{13}) + \\alpha \\det(\\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13}) + \\alpha^2 \\det(\\Delta\\mathbf{w}_{12}, \\Delta\\mathbf{w}_{13}) $$\nThis reveals that $J_e(\\alpha)$ is a quadratic polynomial in $\\alpha$:\n$$ J_e(\\alpha) = A_2 \\alpha^2 + A_1 \\alpha + A_0 $$\nwhere the coefficients are:\n$$ A_0 = J_e(0) = \\det(\\mathbf{e}_{12}, \\mathbf{e}_{13}) $$\n$$ A_1 = \\det(\\mathbf{e}_{12}, \\Delta\\mathbf{w}_{13}) + \\det(\\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13}) $$\n$$ A_2 = \\det(\\Delta\\mathbf{w}_{12}, \\Delta\\mathbf{w}_{13}) $$\nFor an initially valid element, $A_0 > 0$. We need to find a bound on $\\alpha$ that guarantees $J_e(\\alpha) > 0$. This is equivalent to ensuring the change in the Jacobian, $\\Delta J_e(\\alpha) = J_e(\\alpha) - J_e(0) = A_1 \\alpha + A_2 \\alpha^2$, does not become too negative:\n$$ A_1 \\alpha + A_2 \\alpha^2 > -A_0 $$\nTo derive a sufficient condition that is always conservative, we can bound the magnitude of the change. A robust sufficient condition is to require that the absolute value of the change is less than the initial value $A_0$:\n$$ |\\Delta J_e(\\alpha)| < A_0 \\implies |A_1 \\alpha + A_2 \\alpha^2| < A_0 $$\nUsing the triangle inequality on the left side provides a more stringent, and therefore more conservative, condition:\n$$ |A_1 \\alpha + A_2 \\alpha^2| \\le |A_1|\\alpha + |A_2|\\alpha^2 $$\nThus, we enforce the sufficient condition:\n$$ |A_1|\\alpha + |A_2|\\alpha^2 < A_0 $$\nThis inequality defines a conservative range for $\\alpha$. The maximum allowable step size under this condition, $\\alpha_{\\max}$, is the positive root of the quadratic equation:\n$$ |A_2|\\alpha^2 + |A_1|\\alpha - A_0 = 0 $$\nSolving for $\\alpha > 0$ using the quadratic formula yields:\n$$ \\alpha_{\\max} = \\frac{-|A_1| + \\sqrt{|A_1|^2 - 4(|A_2|)(-A_0)}}{2|A_2|} = \\frac{-|A_1| + \\sqrt{A_1^2 + 4|A_2|A_0}}{2|A_2|} $$\nThis is the general expression for the conservative bound on $\\alpha$.\n\nNow, we apply this to the specific case provided.\nThe initial node positions are $\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (1, 0)$, and $\\mathbf{x}_3 = (0.3, 0.8)$.\nThe node velocities are $\\mathbf{w}_1 = (0, 0)$, $\\mathbf{w}_2 = (0.4, -0.6)$, and $\\mathbf{w}_3 = (-0.1, -0.1)$.\n\nFirst, we calculate the initial edge vectors and the velocity difference vectors:\n$$ \\mathbf{e}_{12} = \\mathbf{x}_2 - \\mathbf{x}_1 = (1, 0) - (0, 0) = (1, 0) $$\n$$ \\mathbf{e}_{13} = \\mathbf{x}_3 - \\mathbf{x}_1 = (0.3, 0.8) - (0, 0) = (0.3, 0.8) $$\n$$ \\Delta\\mathbf{w}_{12} = \\mathbf{w}_2 - \\mathbf{w}_1 = (0.4, -0.6) - (0, 0) = (0.4, -0.6) $$\n$$ \\Delta\\mathbf{w}_{13} = \\mathbf{w}_3 - \\mathbf{w}_1 = (-0.1, -0.1) - (0, 0) = (-0.1, -0.1) $$\nNext, we compute the coefficients $A_0$, $A_1$, and $A_2$ using the 2D determinant formula $\\det((u_x, u_y), (v_x, v_y)) = u_x v_y - u_y v_x$.\n$$ A_0 = \\det(\\mathbf{e}_{12}, \\mathbf{e}_{13}) = \\det\\begin{pmatrix} 1 & 0.3 \\\\ 0 & 0.8 \\end{pmatrix} = (1)(0.8) - (0)(0.3) = 0.8 $$\nThe initial element is valid as $A_0 > 0$.\n$$ A_1 = \\det(\\mathbf{e}_{12}, \\Delta\\mathbf{w}_{13}) + \\det(\\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13}) $$\n$$ \\det(\\mathbf{e}_{12}, \\Delta\\mathbf{w}_{13}) = \\det\\begin{pmatrix} 1 & -0.1 \\\\ 0 & -0.1 \\end{pmatrix} = (1)(-0.1) - (0)(-0.1) = -0.1 $$\n$$ \\det(\\Delta\\mathbf{w}_{12}, \\mathbf{e}_{13}) = \\det\\begin{pmatrix} 0.4 & 0.3 \\\\ -0.6 & 0.8 \\end{pmatrix} = (0.4)(0.8) - (-0.6)(0.3) = 0.32 + 0.18 = 0.5 $$\n$$ A_1 = -0.1 + 0.5 = 0.4 $$\n$$ A_2 = \\det(\\Delta\\mathbf{w}_{12}, \\Delta\\mathbf{w}_{13}) = \\det\\begin{pmatrix} 0.4 & -0.1 \\\\ -0.6 & -0.1 \\end{pmatrix} = (0.4)(-0.1) - (-0.6)(-0.1) = -0.04 - 0.06 = -0.1 $$\nWe have the values $A_0 = 0.8$, $A_1 = 0.4$, and $A_2 = -0.1$.\nNow we find their absolute values for the sufficient condition: $|A_1| = 0.4$ and $|A_2| = 0.1$.\nWe must solve the equation $|A_2|\\alpha^2 + |A_1|\\alpha - A_0 = 0$:\n$$ 0.1\\alpha^2 + 0.4\\alpha - 0.8 = 0 $$\nMultiplying by $10$ to simplify:\n$$ \\alpha^2 + 4\\alpha - 8 = 0 $$\nThe positive root gives $\\alpha_{\\max}$:\n$$ \\alpha_{\\max} = \\frac{-4 + \\sqrt{4^2 - 4(1)(-8)}}{2(1)} = \\frac{-4 + \\sqrt{16 + 32}}{2} = \\frac{-4 + \\sqrt{48}}{2} $$\nSimplifying the square root: $\\sqrt{48} = \\sqrt{16 \\times 3} = 4\\sqrt{3}$.\n$$ \\alpha_{\\max} = \\frac{-4 + 4\\sqrt{3}}{2} = -2 + 2\\sqrt{3} = 2(\\sqrt{3} - 1) $$\nTo obtain the numerical value, we use $\\sqrt{3} \\approx 1.7320508...$:\n$$ \\alpha_{\\max} = 2(1.7320508... - 1) = 2(0.7320508...) = 1.4641016... $$\nRounding to four significant figures, we get $\\alpha_{\\max} = 1.464$.",
            "answer": "$$\\boxed{1.464}$$"
        },
        {
            "introduction": "One of the most robust and widely used methods for r-refinement is to model the mesh as a pseudo-elastic solid. By modulating the material's \"stiffness\" across the domain, we can control how the mesh stretches and compresses, thereby clustering nodes in regions of interest. This problem asks you to explore this powerful analogy by deriving an analytical solution for mesh displacement in a simplified one-dimensional setting, revealing the direct link between the specified stiffness and the resulting node distribution .",
            "id": "3355764",
            "problem": "Consider a mesh motion problem in Computational Fluid Dynamics (CFD) formulated using the pseudo-solid linear elasticity approach for $r$-refinement by node movement. The computational domain is the unit square $\\Omega = [0,1] \\times [0,1]$ with Cartesian coordinates $(x,y)$. The mesh is modeled as a homogeneous, isotropic linear elastic solid in plane strain, with spatially varying Lamé parameters $\\lambda(x)$ and $\\mu(x)$ given by\n$$\n\\mu(x) = \\mu_{0} \\left(1 + \\alpha x \\right), \\quad \\lambda(x) = \\kappa \\, \\mu(x),\n$$\nwhere $\\mu_{0} > 0$, $\\alpha > -1$, and $\\kappa > 0$ are constants.\n\nThere are no body forces, and the left boundary is displaced uniformly in the $x$-direction by a known function that is constant in $y$:\n$$\nu_{x}(0,y) = U_{0}, \\quad u_{y}(0,y) = 0,\n$$\nwith $U_{0} > 0$ constant. The right boundary is fixed:\n$$\nu_{x}(1,y) = 0, \\quad u_{y}(1,y) = 0,\n$$\nand the top and bottom boundaries are constrained with no vertical motion:\n$$\nu_{y}(x,0) = 0, \\quad u_{y}(x,1) = 0.\n$$\nAssume a one-dimensional reduction consistent with these boundary conditions and symmetry, namely $u_{x}(x,y) = u(x)$ independent of $y$ and $u_{y}(x,y) = 0$.\n\nStarting from the fundamental equations of static equilibrium in linear elasticity and appropriate constitutive laws, derive an ordinary differential equation for $u(x)$ and solve it analytically to obtain a closed-form expression for the interior node displacement profile $u(x)$ on $x \\in [0,1]$. Provide the final answer as a single closed-form analytic expression for $u(x)$.\n\nAdditionally, briefly describe how the displacement profile qualitatively distributes interior node movement as a function of $x$ for $\\alpha > 0$, and comment on the limiting behavior of your expression as $\\alpha \\to 0^{+}$.\n\nYour final answer must be a single closed-form analytic expression for $u(x)$ (no units required). No rounding is needed.",
            "solution": "The governing equations for static equilibrium in the absence of body forces are given by the divergence of the Cauchy stress tensor $\\boldsymbol{\\sigma}$ being zero:\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}\n$$\nFor a homogeneous, isotropic linear elastic material, the stress tensor is related to the strain tensor $\\boldsymbol{\\varepsilon}$ by the constitutive law (Hooke's Law):\n$$\n\\boldsymbol{\\sigma} = \\lambda (\\text{tr}(\\boldsymbol{\\varepsilon})) \\mathbf{I} + 2\\mu \\boldsymbol{\\varepsilon}\n$$\nwhere $\\mathbf{u} = (u_x, u_y)$ is the displacement vector, $\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$ is the infinitesimal strain tensor, $\\mathbf{I}$ is the identity tensor, and $\\lambda$ and $\\mu$ are the Lamé parameters.\n\nWe apply the simplifying assumption that the displacement field is one-dimensional: $u_{x}(x,y) = u(x)$ and $u_{y}(x,y) = 0$. The components of the strain tensor are:\n$$\n\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\frac{du}{dx} = u'(x)\n$$\n$$\n\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = 0\n$$\n$$\n\\varepsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{1}{2}(0 + 0) = 0\n$$\nThe problem is specified as plane strain, for which the in-plane components of the stress tensor are:\n$$\n\\sigma_{xx} = (\\lambda + 2\\mu) \\varepsilon_{xx} + \\lambda \\varepsilon_{yy} = (\\lambda(x) + 2\\mu(x)) u'(x)\n$$\n$$\n\\sigma_{yy} = \\lambda \\varepsilon_{xx} + (\\lambda + 2\\mu) \\varepsilon_{yy} = \\lambda(x) u'(x)\n$$\n$$\n\\sigma_{xy} = 2\\mu \\varepsilon_{xy} = 0\n$$\nThe static equilibrium equations in Cartesian coordinates are:\n$$\n\\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} = 0\n$$\n$$\n\\frac{\\partial \\sigma_{xy}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} = 0\n$$\nSubstituting the stress components, the second equation is identically satisfied:\n$$\n\\frac{\\partial (0)}{\\partial x} + \\frac{\\partial}{\\partial y} [\\lambda(x) u'(x)] = 0 + 0 = 0\n$$\nThe first equation yields the governing ordinary differential equation (ODE) for $u(x)$:\n$$\n\\frac{d}{dx} \\left[ (\\lambda(x) + 2\\mu(x)) u'(x) \\right] + \\frac{\\partial (0)}{\\partial y} = 0\n$$\n$$\n\\frac{d}{dx} \\left[ (\\lambda(x) + 2\\mu(x)) u'(x) \\right] = 0\n$$\nIntegrating this equation once with respect to $x$ gives:\n$$\n(\\lambda(x) + 2\\mu(x)) u'(x) = C_1\n$$\nwhere $C_1$ is a constant of integration. We are given the spatially varying Lamé parameters:\n$$\n\\mu(x) = \\mu_{0} (1 + \\alpha x), \\quad \\lambda(x) = \\kappa \\mu(x) = \\kappa \\mu_{0} (1 + \\alpha x)\n$$\nSubstituting these into the integrated equation:\n$$\n(\\kappa \\mu_0 (1 + \\alpha x) + 2\\mu_0 (1 + \\alpha x)) u'(x) = C_1\n$$\n$$\n(\\kappa + 2) \\mu_0 (1 + \\alpha x) u'(x) = C_1\n$$\nSolving for $u'(x)$:\n$$\nu'(x) = \\frac{C_1}{(\\kappa + 2) \\mu_0 (1 + \\alpha x)}\n$$\nTo find $u(x)$, we integrate with respect to $x$. We must consider the cases where $\\alpha \\neq 0$ and $\\alpha = 0$. The problem asks for the solution and the limit as $\\alpha \\to 0^+$, so we proceed with $\\alpha \\neq 0$.\n$$\nu(x) = \\int \\frac{C_1}{(\\kappa + 2) \\mu_0 (1 + \\alpha x)} \\, dx\n$$\n$$\nu(x) = \\frac{C_1}{(\\kappa + 2) \\mu_0} \\int \\frac{1}{1 + \\alpha x} \\, dx\n$$\nThe integral evaluates to $\\frac{1}{\\alpha}\\ln(1 + \\alpha x)$, since for $x \\in [0,1]$ and $\\alpha > -1$, the argument of the logarithm is always positive.\n$$\nu(x) = \\frac{C_1}{\\alpha (\\kappa + 2) \\mu_0} \\ln(1 + \\alpha x) + C_2\n$$\nwhere $C_2$ is the second integration constant. Let's combine the constants in front of the logarithm into a single constant $A = \\frac{C_1}{\\alpha (\\kappa + 2) \\mu_0}$.\n$$\nu(x) = A \\ln(1 + \\alpha x) + C_2\n$$\nWe now apply the boundary conditions to determine $A$ and $C_2$.\nThe boundary conditions on the displacement field $u(x)$ are:\n$$\nu(0) = U_0, \\quad u(1) = 0\n$$\nApplying the first condition at $x=0$:\n$$\nu(0) = A \\ln(1 + \\alpha \\cdot 0) + C_2 = A \\ln(1) + C_2 = 0 + C_2 = U_0\n$$\nThis gives $C_2 = U_0$.\nApplying the second condition at $x=1$:\n$$\nu(1) = A \\ln(1 + \\alpha) + C_2 = A \\ln(1 + \\alpha) + U_0 = 0\n$$\nSolving for $A$ (for $\\alpha \\neq 0$):\n$$\nA = -\\frac{U_0}{\\ln(1 + \\alpha)}\n$$\nSubstituting the constants $A$ and $C_2$ back into the expression for $u(x)$:\n$$\nu(x) = -\\frac{U_0}{\\ln(1 + \\alpha)} \\ln(1 + \\alpha x) + U_0\n$$\nFactoring out $U_0$ gives the final closed-form expression for the displacement profile:\n$$\nu(x) = U_0 \\left( 1 - \\frac{\\ln(1 + \\alpha x)}{\\ln(1 + \\alpha)} \\right)\n$$\nFor $\\alpha > 0$, the stiffness, proportional to $(1 + \\alpha x)$, increases from left to right. The strain, $u'(x) = -\\frac{U_0 \\alpha}{\\ln(1+\\alpha)}\\frac{1}{1+\\alpha x}$, has its largest magnitude at $x=0$ and smallest at $x=1$. This means the material is compressed more where it is \"softer\" (lower stiffness). For mesh motion, the initial node spacing $\\Delta X$ is deformed to a new spacing $\\Delta x \\approx \\Delta X (1 + u'(x))$. Since $u'(x)$ is negative and its magnitude is largest at $x=0$, the node spacing will be smallest at $x=0$. Thus, for $\\alpha > 0$, the mesh nodes will cluster near the left boundary ($x=0$) and become progressively more spread out towards the right boundary ($x=1$), which is a common strategy to increase resolution in regions of low specified stiffness.\n\nTo analyze the limiting behavior as $\\alpha \\to 0^+$, we evaluate the limit of the fraction in the solution. This is an indeterminate form $0/0$:\n$$\n\\lim_{\\alpha \\to 0^+} \\frac{\\ln(1 + \\alpha x)}{\\ln(1 + \\alpha)}\n$$\nUsing L'Hôpital's rule, we differentiate the numerator and denominator with respect to $\\alpha$:\n$$\n\\lim_{\\alpha \\to 0^+} \\frac{\\frac{d}{d\\alpha} \\ln(1 + \\alpha x)}{\\frac{d}{d\\alpha} \\ln(1 + \\alpha)} = \\lim_{\\alpha \\to 0^+} \\frac{\\frac{x}{1 + \\alpha x}}{\\frac{1}{1 + \\alpha}} = \\frac{x/1}{1/1} = x\n$$\nTherefore, the displacement profile in the limit is:\n$$\n\\lim_{\\alpha \\to 0^+} u(x) = U_0 (1 - x)\n$$\nThis is a linear displacement profile, which corresponds to uniform strain. This result is correct, as $\\alpha = 0$ corresponds to constant Lamé parameters, leading to the ODE $u''(x)=0$ with the given boundary conditions, whose solution is indeed $u(x) = U_0(1-x)$.",
            "answer": "$$\n\\boxed{U_0 \\left( 1 - \\frac{\\ln(1+\\alpha x)}{\\ln(1+\\alpha)} \\right)}\n$$"
        }
    ]
}