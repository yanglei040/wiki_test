{
    "hands_on_practices": [
        {
            "introduction": "在我们学习如何*减少*方差之前，我们必须首先理解*为何*控制方差是至关重要的。这个练习是一个警示性的例子，它展示了重要性抽样的一个典型失效模式：一个看似合理的提议分布选择，却导致估计量具有无穷大的方差，使其完全失效。通过这个具体例子 ，我们将揭示一个核心原则，即确保提议分布的“尾部”至少与目标分布一样“重”是何等关键。",
            "id": "3241960",
            "problem": "考虑使用重要性采样 (IS) 估计目标期望 $I = \\mathbb{E}_{\\pi}[f(X)]$ 的任务，其中权重函数为 $w(x) = \\frac{\\pi(x)}{q(x)}$，样本从提议分布 $q(x)$ 中抽取。从概率密度函数 (PDF) 下期望和方差的基本定义出发：对于任意可测函数 $g$，$\\mathbb{E}_{p}[g(X)] = \\int_{\\mathbb{R}} g(x)\\,p(x)\\,dx$，且 $\\operatorname{Var}_{p}(Y) = \\mathbb{E}_{p}[Y^{2}] - \\left(\\mathbb{E}_{p}[Y]\\right)^{2}$。在重要性采样中，基于从 $q$ 中抽取的样本对 $I$ 的估计量是 $w(X)f(X)$ 的平均值，其在 $q$ 下的方差为 $\\operatorname{Var}_{q}\\!\\left[w(X)f(X)\\right]$。\n\n构造一个一维示例，其中提议分布 $q$ 对目标分布 $\\pi$ 的尾部覆盖不足，导致即使目标期望 $I$ 是有限的，方差 $\\operatorname{Var}_{q}\\!\\left[w(X)f(X)\\right]$ 也是无穷大。具体来说，取目标 PDF 为标准柯西分布\n$$\n\\pi(x) = \\frac{1}{\\pi\\,(1+x^{2})}, \\quad x \\in \\mathbb{R},\n$$\n提议 PDF 为标准正态分布\n$$\nq(x) = \\frac{1}{\\sqrt{2\\pi}}\\,\\exp\\!\\left(-\\frac{x^{2}}{2}\\right), \\quad x \\in \\mathbb{R},\n$$\n被积函数为有界函数\n$$\nf(x) = 1, \\quad x \\in \\mathbb{R}.\n$$\n仅使用上述核心定义，执行以下操作：\n\n1. 精确计算目标期望 $I = \\int_{\\mathbb{R}} f(x)\\,\\pi(x)\\,dx$。\n2. 推导二阶矩 $\\mathbb{E}_{q}\\!\\left[(w(X)f(X))^{2}\\right]$ 的显式积分表达式，并通过基于给定 PDF 的尾部比较论证，证明该积分发散到 $+\\infty$。得出结论：$\\operatorname{Var}_{q}\\!\\left[w(X)f(X)\\right]$ 是无穷大，而 $I$ 是有限的。\n\n精确给出 $I$ 的最终数值答案。无需四舍五入，无单位。",
            "solution": "该问题在数值方法领域，特别是在重要性采样方面，提出了一个提法明确的问题。所有给定的函数——目标分布 $\\pi(x)$、提议分布 $q(x)$ 和被积函数 $f(x)$——都是标准的、定义明确的数学对象。该问题具有科学依据且自洽，可以进行严谨的分析。我们着手完成两个要求的任务。\n\n问题要求我们研究一个重要性采样场景，其中目标期望是有限的，但估计量的方差是无穷大。各组成部分定义如下：\n目标概率密度函数 (PDF)：标准柯西分布，$\\pi(x) = \\frac{1}{\\pi(1+x^2)}$。\n提议 PDF：标准正态分布，$q(x) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-\\frac{x^2}{2})$。\n被积函数：$f(x) = 1$。\n目标是估计目标期望 $I = \\mathbb{E}_{\\pi}[f(X)]$。重要性采样权重为 $w(x) = \\frac{\\pi(x)}{q(x)}$。\n\n**1. 计算目标期望 $I$**\n\n目标期望定义为 $I = \\int_{\\mathbb{R}} f(x)\\pi(x)dx$。代入给定的 $f(x)$ 和 $\\pi(x)$ 表达式：\n$$\nI = \\int_{-\\infty}^{\\infty} 1 \\cdot \\frac{1}{\\pi(1+x^2)} dx = \\frac{1}{\\pi} \\int_{-\\infty}^{\\infty} \\frac{1}{1+x^2} dx\n$$\n根据概率密度函数的定义，$\\pi(x)$ 在其支撑集 $\\mathbb{R}$ 上的积分必须等于 $1$。我们可以直接验证这一点。$\\frac{1}{1+x^2}$ 的反导数是 $\\arctan(x)$。因此，我们可以计算这个定积分：\n$$\nI = \\frac{1}{\\pi} \\left[ \\arctan(x) \\right]_{-\\infty}^{\\infty} = \\frac{1}{\\pi} \\left( \\lim_{b \\to \\infty} \\arctan(b) - \\lim_{a \\to -\\infty} \\arctan(a) \\right)\n$$\n使用反正切函数的已知极限，$\\lim_{b \\to \\infty} \\arctan(b) = \\frac{\\pi}{2}$ 和 $\\lim_{a \\to -\\infty} \\arctan(a) = -\\frac{\\pi}{2}$，我们得到：\n$$\nI = \\frac{1}{\\pi} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{1}{\\pi} \\left( \\frac{\\pi}{2} + \\frac{\\pi}{2} \\right) = \\frac{1}{\\pi}(\\pi) = 1\n$$\n目标期望 $I$ 是有限的，等于 $1$。\n\n**2. 重要性采样估计量方差的分析**\n\n$I$ 的重要性采样估计量的方差由 $\\operatorname{Var}_{q}[w(X)f(X)]$ 给出。使用方差的定义 $\\operatorname{Var}_{p}(Y) = \\mathbb{E}_{p}[Y^2] - (\\mathbb{E}_{p}[Y])^2$，我们有：\n$$\n\\operatorname{Var}_{q}[w(X)f(X)] = \\mathbb{E}_{q}\\left[(w(X)f(X))^2\\right] - \\left( \\mathbb{E}_{q}[w(X)f(X)] \\right)^2\n$$\n首先，我们计算估计量的期望 $\\mathbb{E}_{q}[w(X)f(X)]$：\n$$\n\\mathbb{E}_{q}[w(X)f(X)] = \\int_{-\\infty}^{\\infty} w(x)f(x)q(x)dx = \\int_{-\\infty}^{\\infty} \\frac{\\pi(x)}{q(x)} \\cdot 1 \\cdot q(x)dx = \\int_{-\\infty}^{\\infty} \\pi(x)dx = I = 1\n$$\n这证实了重要性采样估计量对于 $I$ 是无偏的，因此 $(\\mathbb{E}_{q}[w(X)f(X)])^2 = 1^2 = 1$。因此，方差为无穷大的充要条件是二阶矩 $\\mathbb{E}_{q}\\left[(w(X)f(X))^2\\right]$ 为无穷大。\n\n接下来，我们推导二阶矩的显式积分：\n$$\n\\mathbb{E}_{q}\\left[(w(X)f(X))^2\\right] = \\int_{-\\infty}^{\\infty} (w(x)f(x))^2 q(x) dx\n$$\n代入 $f(x)=1$ 和 $w(x) = \\frac{\\pi(x)}{q(x)}$：\n$$\n\\mathbb{E}_{q}\\left[(w(X)f(X))^2\\right] = \\int_{-\\infty}^{\\infty} \\left(\\frac{\\pi(x)}{q(x)}\\right)^2 q(x) dx = \\int_{-\\infty}^{\\infty} \\frac{\\pi(x)^2}{q(x)} dx\n$$\n现在，我们代入 PDF $\\pi(x)$ 和 $q(x)$ 的表达式：\n$$\n\\frac{\\pi(x)^2}{q(x)} = \\frac{\\left(\\frac{1}{\\pi(1+x^2)}\\right)^2}{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^2}{2}\\right)} = \\frac{\\frac{1}{\\pi^2(1+x^2)^2}}{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^2}{2}\\right)} = \\frac{\\sqrt{2\\pi}}{\\pi^2} \\frac{\\exp\\left(\\frac{x^2}{2}\\right)}{(1+x^2)^2}\n$$\n二阶矩是该表达式的积分：\n$$\n\\mathbb{E}_{q}\\left[(w(X)f(X))^2\\right] = \\frac{\\sqrt{2\\pi}}{\\pi^2} \\int_{-\\infty}^{\\infty} \\frac{\\exp\\left(\\frac{x^2}{2}\\right)}{(1+x^2)^2} dx\n$$\n为了证明这个积分发散，我们进行尾部比较论证。被积函数是一个正函数。瑕积分 $\\int_{-\\infty}^{\\infty} g(x) dx$ 收敛的一个必要条件是 $\\lim_{|x| \\to \\infty} g(x) = 0$。让我们检验我们被积函数的这个极限：\n$$\n\\lim_{|x| \\to \\infty} \\frac{\\exp\\left(\\frac{x^2}{2}\\right)}{(1+x^2)^2}\n$$\n分子 $\\exp\\left(\\frac{x^2}{2}\\right)$ 表现为指数增长。分母 $(1+x^2)^2$ 表现为多项式增长（渐近于 $x^4$）。指数增长快于任何多项式增长是微积分的一个基本结论。因此：\n$$\n\\lim_{|x| \\to \\infty} \\frac{\\exp\\left(\\frac{x^2}{2}\\right)}{(1+x^2)^2} = +\\infty\n$$\n由于被积函数当 $|x| \\to \\infty$ 时的极限不为 $0$，不满足收敛的必要条件。因为被积函数是严格为正的，该积分必定发散到 $+\\infty$。\n$$\n\\mathbb{E}_{q}\\left[(w(X)f(X))^2\\right] = +\\infty\n$$\n出现这种情况是因为提议分布 $q(x)$（标准正态分布）的尾部衰减到零的速度（$\\exp(-x^2/2)$）远快于目标分布 $\\pi(x)$（柯西分布，其衰减速度为 $1/x^2$）的尾部。这是尾部覆盖不足的一个典型例子。权重函数 $w(x)$ 在尾部变得极大，导致方差爆炸。\n\n最后，我们对方差得出结论：\n$$\n\\operatorname{Var}_{q}[w(X)f(X)] = \\mathbb{E}_{q}\\left[(w(X)f(X))^2\\right] - \\left( \\mathbb{E}_{q}[w(X)f(X)] \\right)^2 = +\\infty - 1 = +\\infty\n$$\n我们成功地展示了一个例子，其中目标期望 $I$ 是有限的（$I=1$），而重要性采样估计量的方差是无穷大。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "既然我们理解了其中的风险，现在让我们探讨如何主动地最小化方差。这个练习提供了一个清晰且易于处理的例子，来展示如何优化提议分布。通过在高斯分布的框架下进行分析 ，我们可以推导出方差的闭合表达式，并利用微积分找到使其最小化的最优参数，从而直接阐明理想提议分布应与目标分布紧密匹配的原则。",
            "id": "3360244",
            "problem": "设 $p(x)$ 是 $\\mathbb{R}$ 上标准正态分布 $\\mathcal{N}(0,1)$ 的概率密度函数。考虑使用重要性采样（IS）方法估计目标期望 $I = \\mathbb{E}_{p}[f(X)]$，其中 $f(x)=x$。重要性采样基于一个高斯提议分布族 $\\{q_{\\theta}: \\theta \\in \\mathbb{R}\\}$，其中 $q_{\\theta}(x)$ 是 $\\mathcal{N}(\\theta,1)$ 的密度。重要性权重定义为 $w_{\\theta}(x) = p(x)/q_{\\theta}(x)$，单次抽样的重要性采样求和项为 $Y_{\\theta} = w_{\\theta}(X) f(X)$，其中 $X \\sim q_{\\theta}$。具有 $n$ 次独立同分布抽样的标准蒙特卡洛（MC）重要性采样估计量为 $\\widehat{I}_{n}(\\theta) = \\frac{1}{n} \\sum_{i=1}^{n} Y_{\\theta,i}$。\n\n从重要性采样和方差的定义出发，并仅使用高斯指数族的熟知公式（例如，正态随机变量的矩生成函数），推导方差\n$$\nV(\\theta) \\equiv \\operatorname{Var}_{q_{\\theta}}\\!\\left(Y_{\\theta}\\right),\n$$\n的闭式表达式，使其成为参数 $\\theta$ 的一个显式函数。然后，确定函数 $\\theta \\mapsto V(\\theta)$ 的所有驻点，并对它们进行分类。\n\n你的最终答案必须以一个使用 $\\LaTeX$ $\\pmatrix$ 环境的双元素行向量形式给出，其中第一个元素是 $V(\\theta)$ 的闭式表达式，第二个元素是驻点的集合。答案的任何部分都不需要数值近似，也不涉及任何单位。如果有多个驻点，请在第二个元素中将它们全部列出，并用逗号分隔，置于同一个行向量内。",
            "solution": "目标是推导方差 $V(\\theta) = \\operatorname{Var}_{q_{\\theta}}(Y_{\\theta})$ 的闭式表达式，并找到和分类 $V(\\theta)$ 的驻点。方差的定义为 $V(\\theta) = \\mathbb{E}_{q_{\\theta}}[Y_{\\theta}^2] - (\\mathbb{E}_{q_{\\theta}}[Y_{\\theta}])^2$。\n\n首先，我们计算重要性采样求和项的期望值 $\\mathbb{E}_{q_{\\theta}}[Y_{\\theta}]$。\n求和项为 $Y_{\\theta} = w_{\\theta}(X) f(X)$，其中 $X \\sim q_{\\theta}$。重要性权重为 $w_{\\theta}(x) = p(x)/q_{\\theta}(x)$。\n其期望为：\n$$\n\\mathbb{E}_{q_{\\theta}}[Y_{\\theta}] = \\mathbb{E}_{q_{\\theta}}\\left[\\frac{p(X)}{q_{\\theta}(X)} f(X)\\right] = \\int_{-\\infty}^{\\infty} \\frac{p(x)}{q_{\\theta}(x)} f(x) q_{\\theta}(x) \\,dx = \\int_{-\\infty}^{\\infty} f(x) p(x) \\,dx = \\mathbb{E}_{p}[f(X)]\n$$\n这就是目标量 $I$。在这个问题中，$p(x)$ 是标准正态分布 $\\mathcal{N}(0,1)$ 的概率密度函数（PDF），并且 $f(x) = x$。\n因此，该期望是标准正态分布的均值：\n$$\n\\mathbb{E}_{q_{\\theta}}[Y_{\\theta}] = I = \\mathbb{E}_{p}[X] = 0\n$$\n由于 $Y_{\\theta}$ 的均值为 $0$，方差化简为二阶矩：\n$$\nV(\\theta) = \\mathbb{E}_{q_{\\theta}}[Y_{\\theta}^2] - (0)^2 = \\mathbb{E}_{q_{\\theta}}[Y_{\\theta}^2]\n$$\n\n接下来，我们推导这个二阶矩的表达式。求和项的平方为 $Y_{\\theta}^2 = (w_{\\theta}(X) f(X))^2$。\n我们首先求出权重 $w_{\\theta}(x)$ 的显式形式。$p(x)$ 的PDF为 $\\frac{1}{\\sqrt{2\\pi}}\\exp(-x^2/2)$ 而 $q_{\\theta}(x)$ 的PDF为 $\\frac{1}{\\sqrt{2\\pi}}\\exp(-(x-\\theta)^2/2)$。\n$$\nw_{\\theta}(x) = \\frac{p(x)}{q_{\\theta}(x)} = \\frac{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{x^2}{2}\\right)}{\\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{(x-\\theta)^2}{2}\\right)} = \\exp\\left(-\\frac{x^2}{2} + \\frac{(x-\\theta)^2}{2}\\right)\n$$\n指数部分化简为：\n$$\n-\\frac{x^2}{2} + \\frac{x^2 - 2\\theta x + \\theta^2}{2} = \\frac{-x^2 + x^2 - 2\\theta x + \\theta^2}{2} = -\\theta x + \\frac{\\theta^2}{2}\n$$\n所以，权重为 $w_{\\theta}(x) = \\exp(-\\theta x + \\theta^2/2)$。\n求和项为 $Y_{\\theta} = f(X) w_{\\theta}(X) = X \\exp(-\\theta X + \\theta^2/2)$，其中 $X \\sim q_{\\theta}$，即 $X \\sim \\mathcal{N}(\\theta, 1)$。\n求和项的平方为 $Y_{\\theta}^2 = X^2 \\exp(-2\\theta X + \\theta^2)$。\n现在我们计算其在 $q_{\\theta}$ 下的期望：\n$$\nV(\\theta) = \\mathbb{E}_{q_{\\theta}}[Y_{\\theta}^2] = \\mathbb{E}_{q_{\\theta}}\\left[X^2 \\exp(-2\\theta X + \\theta^2)\\right] = \\exp(\\theta^2) \\mathbb{E}_{q_{\\theta}}\\left[X^2 \\exp(-2\\theta X)\\right]\n$$\n为了计算该期望，我们使用 $X \\sim \\mathcal{N}(\\theta, 1)$ 的矩生成函数（MGF）。一个一般正态随机变量 $Z \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 的MGF是 $M_Z(t) = \\exp(\\mu t + \\sigma^2 t^2/2)$。对于 $X \\sim \\mathcal{N}(\\theta, 1)$，我们有 $\\mu = \\theta$ 和 $\\sigma^2 = 1$，所以其MGF为：\n$$\nM_X(t) = \\mathbb{E}_{q_{\\theta}}[\\exp(tX)] = \\exp(\\theta t + t^2/2)\n$$\n我们使用性质 $\\mathbb{E}_{q_{\\theta}}[X^2 \\exp(tX)] = \\frac{d^2}{dt^2} M_X(t)$。\n一阶导数：\n$$\n\\frac{d}{dt} M_X(t) = \\frac{d}{dt} \\exp(\\theta t + t^2/2) = (\\theta + t) \\exp(\\theta t + t^2/2)\n$$\n二阶导数（使用乘法法则）：\n$$\n\\frac{d^2}{dt^2} M_X(t) = \\frac{d}{dt} \\left[(\\theta + t) \\exp(\\theta t + t^2/2)\\right] = (1)\\exp(\\theta t + t^2/2) + (\\theta + t)(\\theta + t)\\exp(\\theta t + t^2/2) = \\left[1 + (\\theta + t)^2\\right] \\exp(\\theta t + t^2/2)\n$$\n我们需要计算 $\\mathbb{E}_{q_{\\theta}}[X^2 \\exp(-2\\theta X)]$，这对应于在MGF二阶导数的表达式中令 $t = -2\\theta$：\n\\begin{align*}\n\\mathbb{E}_{q_{\\theta}}\\left[X^2 \\exp(-2\\theta X)\\right] = \\left[1 + (\\theta + (-2\\theta))^2\\right] \\exp\\left(\\theta(-2\\theta) + \\frac{(-2\\theta)^2}{2}\\right) \\\\\n= \\left[1 + (-\\theta)^2\\right] \\exp\\left(-2\\theta^2 + \\frac{4\\theta^2}{2}\\right) \\\\\n= (1 + \\theta^2) \\exp(-2\\theta^2 + 2\\theta^2) \\\\\n= (1 + \\theta^2) \\exp(0) = 1 + \\theta^2\n\\end{align*}\n将此结果代回到 $V(\\theta)$ 的表达式中：\n$$\nV(\\theta) = \\exp(\\theta^2) \\cdot (1 + \\theta^2)\n$$\n所以，方差的闭式表达式为 $V(\\theta) = (1 + \\theta^2)\\exp(\\theta^2)$。\n\n接下来，我们寻找并分类 $V(\\theta)$ 的驻点。驻点出现在一阶导数 $V'(\\theta) = \\frac{dV}{d\\theta}$ 为零的地方。我们使用乘法法则对 $V(\\theta)$ 求导：\n$$\nV'(\\theta) = \\frac{d}{d\\theta}\\left[(1 + \\theta^2)\\exp(\\theta^2)\\right] = \\left(\\frac{d}{d\\theta}(1+\\theta^2)\\right)\\exp(\\theta^2) + (1+\\theta^2)\\left(\\frac{d}{d\\theta}\\exp(\\theta^2)\\right)\n$$\n$$\nV'(\\theta) = (2\\theta)\\exp(\\theta^2) + (1+\\theta^2)(2\\theta\\exp(\\theta^2)) = 2\\theta\\exp(\\theta^2) [1 + (1+\\theta^2)] = 2\\theta(2+\\theta^2)\\exp(\\theta^2)\n$$\n为了找到驻点，我们令 $V'(\\theta) = 0$：\n$$\n2\\theta(2+\\theta^2)\\exp(\\theta^2) = 0\n$$\n对于任何实数 $\\theta$，$\\exp(\\theta^2)  0$ 且 $2+\\theta^2 \\ge 2  0$。因此，该乘积为零的唯一可能是 $2\\theta = 0$，这意味着 $\\theta = 0$。\n在 $\\theta = 0$ 处有一个唯一的驻点。\n\n为了对此驻点进行分类，我们使用二阶导数检验法。我们计算 $V''(\\theta) = \\frac{d^2V}{d\\theta^2}$。\n让我们对 $V'(\\theta) = (4\\theta+2\\theta^3)\\exp(\\theta^2)$ 求导：\n$$\nV''(\\theta) = \\frac{d}{d\\theta}\\left[(4\\theta+2\\theta^3)\\exp(\\theta^2)\\right] = (4+6\\theta^2)\\exp(\\theta^2) + (4\\theta+2\\theta^3)(2\\theta\\exp(\\theta^2))\n$$\n$$\nV''(\\theta) = \\exp(\\theta^2) \\left[ (4+6\\theta^2) + 2\\theta(4\\theta+2\\theta^3) \\right] = \\exp(\\theta^2) \\left[ 4+6\\theta^2+8\\theta^2+4\\theta^4 \\right]\n$$\n$$\nV''(\\theta) = (4\\theta^4 + 14\\theta^2 + 4)\\exp(\\theta^2)\n$$\n现在，我们在驻点 $\\theta = 0$ 处计算二阶导数的值：\n$$\nV''(0) = (4(0)^4 + 14(0)^2 + 4)\\exp(0) = (4)(1) = 4\n$$\n由于 $V''(0) = 4  0$，驻点 $\\theta=0$ 对应一个局部最小值。\n此外，对于任何实数 $\\theta$，$V(\\theta) = (1+\\theta^2)\\exp(\\theta^2) \\ge (1)\\exp(0) = 1$，且 $V(0) = 1$。因此，$\\theta=0$ 是一个全局最小值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} (1+\\theta^2)\\exp(\\theta^2)  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在方差优化原则的基础上，本练习将处理一个更高级且更具实际意义的应用：估计罕见事件的概率。这类问题对于标准的蒙特卡洛方法来说是出了名的困难。本练习  将演示如何结合使用重要性抽样和优化的提议分布（一种称为指数倾斜的技术），在这种充满挑战的情境下显著提高估计效率。",
            "id": "3360206",
            "problem": "令 $p(x)$ 为 $\\mathbb{R}$ 上的标准正态密度 $p(x)=\\varphi(x)=(2\\pi)^{-1/2}\\exp(-x^{2}/2)$，并令 $f(x)=\\mathbb{I}\\{xa\\}$，其中 $a0$ 是一个固定的阈值。我们希望使用重要性抽样 (IS) 来估计稀有事件概率 $\\theta=\\mathbb{P}_{p}(Xa)$，其中提议分布取自典范指数倾斜族 $q_{\\mu}(x)=\\varphi(x-\\mu)$，即 $q_{\\mu}$ 是均值为 $\\mu\\in\\mathbb{R}$、方差为 $1$ 的正态密度。重要性权重为 $W(x)=p(x)/q_{\\mu}(x)$。基于从 $q_{\\mu}$ 单次抽样的 $\\theta$ 的 IS 估计量是 $f(X)W(X)$，其在 $q_{\\mu}$ 下的方差是 $\\operatorname{Var}_{q_{\\mu}}(fW)$。\n\n从期望和方差的定义出发，用高斯生存函数 $\\bar{\\Phi}(x)=\\int_{x}^{\\infty}\\varphi(t)\\,\\mathrm{d}t$ 精确表示 $\\operatorname{Var}_{q_{\\mu}}(fW)$。然后，利用高斯尾部的米尔斯比率的渐近形式，即当 $x\\to\\infty$ 时 $\\bar{\\Phi}(x)\\sim \\varphi(x)/x$，推导当 $a\\to\\infty$ 且 $\\mu$ 固定时 $\\operatorname{Var}_{q_{\\mu}}(fW)$ 的领头阶渐近。最后，在典范指数倾斜族 $\\{q_{\\mu}:\\mu\\in\\mathbb{R}\\}$ 内，确定使领头阶渐近最小化的 $\\mu$ 的选择，并给出当 $a\\to\\infty$ 时 $\\operatorname{Var}_{q_{\\mu}}(fW)$ 的最小领头阶渐近表达式。\n\n将你的最终答案表示为关于 $a$ 和普适常数的单个闭式解析表达式。无需数值取整。在首字母缩略词首次出现时展开，例如，重要性抽样 (IS) 和蒙特卡洛 (MC)。",
            "solution": "该问题要求分析用于稀有事件概率的重要性抽样 (IS) 估计量的方差。我们必须首先推导该方差的精确表达式，然后找出其领头阶渐近行为，最后在提议分布族内确定使该渐近方差最小化的最优参数选择，并给出最终的最小表达式。\n\n令目标概率分布为标准正态密度 $p(x)=\\varphi(x)=(2\\pi)^{-1/2}\\exp(-x^{2}/2)$，提议分布为 $q_{\\mu}(x)=\\varphi(x-\\mu)$，一个均值为 $\\mu$、方差为 $1$ 的正态密度。我们想要估计 $\\theta=\\mathbb{P}_{p}(Xa)=\\int_{a}^{\\infty}p(x)\\,\\mathrm{d}x = \\bar{\\Phi}(a)$，其中 $f(x)=\\mathbb{I}\\{xa\\}$ 是该事件的指示函数，$\\bar{\\Phi}(x)$ 是高斯生存函数。\n\n基于单一样本 $X \\sim q_{\\mu}$ 的 IS 估计量是 $Z = f(X)W(X)$，其中重要性权重为 $W(x) = p(x)/q_{\\mu}(x)$。该估计量在提议分布 $q_{\\mu}$ 下的方差由下式给出：\n$$\n\\operatorname{Var}_{q_{\\mu}}(fW) = \\mathbb{E}_{q_{\\mu}}[(fW)^{2}] - (\\mathbb{E}_{q_{\\mu}}[fW])^{2}\n$$\n\n首先，我们计算估计量的期望。这是 IS 的一个基本性质，应得到我们试图估计的量 $\\theta$。\n$$\n\\mathbb{E}_{q_{\\mu}}[f(X)W(X)] = \\int_{-\\infty}^{\\infty} f(x) \\frac{p(x)}{q_{\\mu}(x)} q_{\\mu}(x) \\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} f(x) p(x) \\,\\mathrm{d}x = \\mathbb{E}_{p}[f(X)] = \\theta\n$$\n由于 $f(x)=\\mathbb{I}\\{xa\\}$ 且 $p(x) = \\varphi(x)$，我们有 $\\theta = \\int_{a}^{\\infty} \\varphi(x)\\,\\mathrm{d}x = \\bar{\\Phi}(a)$。因此，方差表达式中的第二项是 $(\\mathbb{E}_{q_{\\mu}}[fW])^{2} = (\\bar{\\Phi}(a))^{2}$。\n\n接下来，我们计算二阶矩 $\\mathbb{E}_{q_{\\mu}}[(fW)^{2}]$。\n$$\n\\mathbb{E}_{q_{\\mu}}[(fW)^{2}] = \\int_{-\\infty}^{\\infty} (f(x)W(x))^{2} q_{\\mu}(x) \\,\\mathrm{d}x\n$$\n由于 $f(x) = \\mathbb{I}\\{xa\\}$，其平方为 $f(x)^{2}=f(x)$。积分仅在 $xa$ 时非零。\n$$\n\\mathbb{E}_{q_{\\mu}}[(fW)^{2}] = \\int_{a}^{\\infty} \\left(\\frac{p(x)}{q_{\\mu}(x)}\\right)^{2} q_{\\mu}(x) \\,\\mathrm{d}x = \\int_{a}^{\\infty} \\frac{p(x)^{2}}{q_{\\mu}(x)} \\,\\mathrm{d}x\n$$\n我们来分析被积函数。密度函数为 $p(x) = (2\\pi)^{-1/2}\\exp(-x^{2}/2)$ 和 $q_{\\mu}(x) = (2\\pi)^{-1/2}\\exp(-(x-\\mu)^{2}/2)$。\n\\begin{align*}\n\\frac{p(x)^{2}}{q_{\\mu}(x)} = \\frac{ (2\\pi)^{-1}\\exp(-x^{2}) }{ (2\\pi)^{-1/2}\\exp(-(x-\\mu)^{2}/2) } \\\\\n= (2\\pi)^{-1/2} \\exp\\left(-x^{2} + \\frac{(x-\\mu)^{2}}{2}\\right) \\\\\n= (2\\pi)^{-1/2} \\exp\\left(\\frac{-2x^{2} + x^{2}-2\\mu x+\\mu^{2}}{2}\\right) \\\\\n= (2\\pi)^{-1/2} \\exp\\left(\\frac{-x^{2}-2\\mu x+\\mu^{2}}{2}\\right)\n\\end{align*}\n为简化指数部分，我们对含 $x$ 的项进行配方：$-x^{2}-2\\mu x = -(x^{2}+2\\mu x) = -((x+\\mu)^{2}-\\mu^{2}) = -(x+\\mu)^{2}+\\mu^{2}$。\n指数中的表达式变为 $\\frac{-(x+\\mu)^{2}+\\mu^{2}+\\mu^{2}}{2} = -\\frac{(x+\\mu)^{2}}{2} + \\mu^{2}$。\n所以，被积函数是：\n$$\n\\frac{p(x)^{2}}{q_{\\mu}(x)} = (2\\pi)^{-1/2} \\exp\\left(-\\frac{(x+\\mu)^{2}}{2} + \\mu^{2}\\right) = \\exp(\\mu^{2}) \\varphi(x+\\mu)\n$$\n因此，二阶矩为：\n$$\n\\mathbb{E}_{q_{\\mu}}[(fW)^{2}] = \\int_{a}^{\\infty} \\exp(\\mu^{2}) \\varphi(x+\\mu) \\,\\mathrm{d}x = \\exp(\\mu^{2}) \\int_{a}^{\\infty} \\varphi(x+\\mu) \\,\\mathrm{d}x\n$$\n通过换元 $t=x+\\mu$, $\\mathrm{d}t=\\mathrm{d}x$，积分变为 $\\int_{a+\\mu}^{\\infty} \\varphi(t)\\,\\mathrm{d}t = \\bar{\\Phi}(a+\\mu)$。\n因此，$\\mathbb{E}_{q_{\\mu}}[(fW)^{2}] = \\exp(\\mu^{2}) \\bar{\\Phi}(a+\\mu)$。\n\n合并各项，方差的精确表达式为：\n$$\n\\operatorname{Var}_{q_{\\mu}}(fW) = \\exp(\\mu^{2}) \\bar{\\Phi}(a+\\mu) - (\\bar{\\Phi}(a))^{2}\n$$\n\n现在，我们推导当 $a\\to\\infty$ 时该方差的领头阶渐近。我们使用给定的米尔斯比率渐近式：当 $x\\to\\infty$ 时 $\\bar{\\Phi}(x) \\sim \\varphi(x)/x$。\n第一项的行为如下：\n$$\n\\exp(\\mu^{2}) \\bar{\\Phi}(a+\\mu) \\sim \\exp(\\mu^{2}) \\frac{\\varphi(a+\\mu)}{a+\\mu} = \\exp(\\mu^{2}) \\frac{(2\\pi)^{-1/2}\\exp(-(a+\\mu)^{2}/2)}{a+\\mu}\n$$\n第二项的行为如下：\n$$\n(\\bar{\\Phi}(a))^{2} \\sim \\left(\\frac{\\varphi(a)}{a}\\right)^{2} = \\frac{(2\\pi)^{-1}\\exp(-a^{2})}{a^{2}}\n$$\n第一项的指数部分是 $\\exp(\\mu^{2})\\exp(-(a+\\mu)^{2}/2) = \\exp(\\mu^{2} - (a^{2}+2a\\mu+\\mu^{2})/2) = \\exp(-a^{2}/2 - a\\mu + \\mu^{2}/2)$。第二项的指数部分是 $\\exp(-a^{2})$。当 $a \\to \\infty$ 时，$\\exp(-a^{2})$ 比 $\\exp(-a^{2}/2)$ 衰减得快得多。因此，第二项是更小阶的项，方差的领头阶渐近由第一项决定：\n$$\n\\operatorname{Var}_{q_{\\mu}}(fW) \\sim \\exp(\\mu^{2}) \\bar{\\Phi}(a+\\mu)\n$$\n再次使用米尔斯比率近似得到：\n\\begin{align*}\n\\operatorname{Var}_{q_{\\mu}}(fW) \\sim \\exp(\\mu^{2}) \\frac{\\varphi(a+\\mu)}{a+\\mu} \\\\\n\\sim \\frac{\\exp(\\mu^{2})}{\\sqrt{2\\pi}(a+\\mu)} \\exp\\left(-\\frac{(a+\\mu)^{2}}{2}\\right) \\\\\n= \\frac{1}{\\sqrt{2\\pi}(a+\\mu)} \\exp\\left(\\mu^{2} - \\frac{a^{2}+2a\\mu+\\mu^{2}}{2}\\right) \\\\\n= \\frac{1}{\\sqrt{2\\pi}(a+\\mu)} \\exp\\left(-\\frac{a^{2}}{2} - a\\mu + \\frac{\\mu^{2}}{2}\\right)\n\\end{align*}\n让我们将此领头阶渐近表达式记为 $V_{\\text{asym}}(\\mu)$。\n\n最后，我们找出使 $V_{\\text{asym}}(\\mu)$ 最小化的 $\\mu$ 的选择。最小化 $V_{\\text{asym}}(\\mu)$ 等价于最小化其关于 $\\mu$ 的自然对数：\n$$\nL(\\mu) = \\ln(V_{\\text{asym}}(\\mu)) = -\\ln(\\sqrt{2\\pi}) - \\ln(a+\\mu) - \\frac{a^{2}}{2} - a\\mu + \\frac{\\mu^{2}}{2}\n$$\n对 $\\mu$ 求导并令其为零以求最小值：\n$$\n\\frac{\\mathrm{d}L}{\\mathrm{d}\\mu} = -\\frac{1}{a+\\mu} - a + \\mu = 0\n$$\n这意味着 $\\mu - a = \\frac{1}{a+\\mu}$，从而得到 $(\\mu-a)(a+\\mu)=1$，或 $\\mu^{2}-a^{2}=1$。由于我们正在估计 $a0$ 的右尾概率，提议分布的均值 $\\mu$ 应该是正的。因此，最优的 $\\mu$ 是 $\\mu_{\\text{opt}} = \\sqrt{a^{2}+1}$。\n\n现在我们确定最终的最小领头阶渐近表达式。我们将 $\\mu_{\\text{opt}}$ 代入 $V_{\\text{asym}}(\\mu)$ 并找出当 $a\\to\\infty$ 时其渐近行为。\n当 $a\\to\\infty$ 时，我们有 $\\mu_{\\text{opt}} = \\sqrt{a^{2}+1} = a\\sqrt{1+1/a^{2}} \\sim a(1+\\frac{1}{2a^{2}}) = a+\\frac{1}{2a}$。\n所以，当 $a\\to\\infty$ 时，$\\mu_{\\text{opt}} \\to a$。\n我们来分析当 $a\\to\\infty$ 时 $V_{\\text{asym}}(\\mu_{\\text{opt}})$ 中的各项：\n前置因子的分母：$a+\\mu_{\\text{opt}} = a+\\sqrt{a^{2}+1} \\sim a+a = 2a$。\n指数部分：$-\\frac{a^{2}}{2} - a\\mu_{\\text{opt}} + \\frac{\\mu_{\\text{opt}}^{2}}{2} = -\\frac{a^{2}}{2} - a\\sqrt{a^{2}+1} + \\frac{a^{2}+1}{2} = - a\\sqrt{a^{2}+1} + \\frac{1}{2}$。\n使用展开式 $\\sqrt{a^{2}+1} \\sim a+\\frac{1}{2a}$：\n$$\n-a\\left(a+\\frac{1}{2a}\\right) + \\frac{1}{2} = -a^{2}-\\frac{1}{2}+\\frac{1}{2} = -a^{2}\n$$\n更正式地，指数部分是 $-a\\sqrt{a^2+1} + 1/2 = -a^2\\sqrt{1+1/a^2} + 1/2 = -a^2(1+1/(2a^2)-O(a^{-4})) + 1/2 = -a^2-1/2+O(a^{-2}) + 1/2 = -a^2 + O(a^{-2})$。\n当 $a\\to\\infty$ 时，指数趋向于 $-a^{2}$。\n\n结合这些结果，最小领头阶渐近方差是：\n$$\nV_{\\text{asym}}(\\mu_{\\text{opt}}) \\sim \\frac{1}{\\sqrt{2\\pi}(2a)} \\exp(-a^{2}) = \\frac{\\exp(-a^{2})}{2a\\sqrt{2\\pi}}\n$$\n这就是方差的最小领头阶渐近表达式。",
            "answer": "$$\\boxed{\\frac{\\exp(-a^{2})}{2a\\sqrt{2\\pi}}}$$"
        }
    ]
}