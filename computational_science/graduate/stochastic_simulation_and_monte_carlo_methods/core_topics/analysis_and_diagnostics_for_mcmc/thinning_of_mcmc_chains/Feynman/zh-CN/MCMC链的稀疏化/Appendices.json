{
    "hands_on_practices": [
        {
            "introduction": "要理解MCMC链的稀疏化（thinning），第一步是量化它对样本自相关性的影响。这个练习  提供了一个基础性的推导，在一个常见的自回归模型下，计算原始链和稀疏化后链的积分自相关时间（Integrated Autocorrelation Time, IAT）。通过这个实践，你将为理解稀疏化的核心数学原理和其对MCMC效率评估的影响打下坚实的基础。",
            "id": "3357397",
            "problem": "考虑一个平稳的马尔可夫链蒙特卡洛 (MCMC) 过程 $\\{X_{n}\\}_{n \\geq 0}$，其目标不变分布为 $\\pi$。设 $f$ 是一个平方可积函数，满足 $\\mathbb{E}_{\\pi}[f(X_{n})]=\\mu$ 和 $\\operatorname{Var}_{\\pi}(f(X_{n}))=\\sigma^{2} \\in (0,\\infty)$。定义中心化过程 $Y_{n}=f(X_{n})-\\mu$，并假设 $\\{Y_{n}\\}$ 是严格平稳的，其自相关函数为 $\\rho_{t}=\\operatorname{Corr}(Y_{0},Y_{t})$。马尔可夫链中心极限定理 (MC-CLT) 指出，遍历均值 $N^{-1}\\sum_{n=1}^{N} f(X_{n})$ 的方差会因积分自相关时间 (IAT) $\\tau$ 而膨胀。在 $\\{\\rho_{t}\\}$ 绝对可和的条件下，$\\tau$ 由收敛级数 $\\tau=1+2\\sum_{t=1}^{\\infty}\\rho_{t}$ 定义。\n\n假设 $f(X_{n})$ 遵循一阶自回归相关模型，即对于某个满足 $0  \\phi  1$ 的 $\\phi$，有 $\\rho_{t}=\\phi^{t}$。推导未稀疏链的积分自相关时间 $\\tau$ 的闭式表达式。接下来，考虑 k-稀疏，即保留每第 k 次迭代的样本并丢弃其他样本，从而产生稀疏序列 $\\{Y_{0},Y_{k},Y_{2k},\\dots\\}$。在相同的自回归相关模型下，推导 k-稀疏链的积分自相关时间 $\\tau_{k}$ 的闭式表达式。\n\n以 $\\tau$ 和 $\\tau_{k}$ 的解析表达式形式给出你的最终答案，不要进行四舍五入。",
            "solution": "首先验证问题，以确保其科学上合理、良定且客观。\n\n### 步骤 1：提取已知条件\n-   一个平稳的马尔可夫链蒙特卡洛 (MCMC) 过程 $\\{X_{n}\\}_{n \\geq 0}$，其不变分布为 $\\pi$。\n-   一个平方可积函数 $f$，满足 $\\mathbb{E}_{\\pi}[f(X_{n})]=\\mu$ 和 $\\operatorname{Var}_{\\pi}(f(X_{n}))=\\sigma^{2} \\in (0,\\infty)$。\n-   一个中心化的严格平稳过程 $Y_{n}=f(X_{n})-\\mu$。\n-   $\\{Y_{n}\\}$ 的自相关函数 (ACF) 为 $\\rho_{t}=\\operatorname{Corr}(Y_{0},Y_{t})$。\n-   未稀疏链的积分自相关时间 (IAT) 为 $\\tau=1+2\\sum_{t=1}^{\\infty}\\rho_{t}$。假设该级数绝对收敛。\n-   ACF 的具体模型为 $\\rho_{t}=\\phi^{t}$，其中常数 $\\phi$ 满足 $0  \\phi  1$。\n-   通过取每第 k 次迭代的样本，形成 k-稀疏链，得到序列 $\\{Y_{0},Y_{k},Y_{2k},\\dots\\}$。\n-   任务是推导未稀疏链的 IAT $\\tau$ 和 k-稀疏链的 IAT $\\tau_k$ 的闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题植根于已建立的马尔可夫链蒙特卡洛方法和时间序列分析理论。所提供的积分自相关时间、平稳过程和自相关的定义在统计学中是标准的。一阶自回归相关模型 ($\\rho_{t}=\\phi^{t}$) 是时间序列数据的一个基础且广泛使用的模型。条件 $0  \\phi  1$ 确保了过程的平稳性和定义 IAT 的级数的收敛性，这在数学上是必不可少的。该问题是该领域的标准理论练习。\n-   **良定性：** 该问题清晰地定义了所有术语，并为自相关函数提供了一个具体模型。它要求根据给定信息推导两个特定量 $\\tau$ 和 $\\tau_k$。问题是自洽的，并且有唯一的可推导解。\n-   **客观性：** 问题以精确的数学和统计语言陈述，没有主观性或模糊性。\n\n### 步骤 3：结论与行动\n该问题有效。它是 MCMC 分析领域一个定义明确的理论问题。将提供完整解答。\n\n### 未稀疏链的积分自相关时间 (IAT) 推导\n\n积分自相关时间 $\\tau$ 定义为：\n$$\n\\tau = 1 + 2\\sum_{t=1}^{\\infty}\\rho_{t}\n$$\n问题指明，对于 $t \\geq 1$，自相关函数遵循一阶自回归过程模型 $\\rho_{t} = \\phi^{t}$。将此代入 $\\tau$ 的定义中，我们得到：\n$$\n\\tau = 1 + 2\\sum_{t=1}^{\\infty}\\phi^{t}\n$$\n求和项是一个几何级数 $\\sum_{t=1}^{\\infty}\\phi^{t} = \\phi + \\phi^{2} + \\phi^{3} + \\dots$。此级数的和是已知的。对于任何满足 $|r|1$ 的 $r$，无穷几何级数 $\\sum_{n=1}^{\\infty} ar^{n-1} = a + ar + ar^2 + \\dots$ 的和为 $\\frac{a}{1-r}$。在我们的例子中，首项是 $a=\\phi$，公比是 $r=\\phi$。因此，和为：\n$$\n\\sum_{t=1}^{\\infty}\\phi^{t} = \\frac{\\phi}{1-\\phi}\n$$\n这是有效的，因为问题陈述了 $0  \\phi  1$，这满足条件 $|\\phi|1$。\n\n将此结果代回 $\\tau$ 的表达式中：\n$$\n\\tau = 1 + 2\\left(\\frac{\\phi}{1-\\phi}\\right)\n$$\n为简化，我们通分：\n$$\n\\tau = \\frac{1-\\phi}{1-\\phi} + \\frac{2\\phi}{1-\\phi} = \\frac{1-\\phi+2\\phi}{1-\\phi} = \\frac{1+\\phi}{1-\\phi}\n$$\n这就是未稀疏链 IAT 的闭式表达式。\n\n### k-稀疏链的 IAT 推导\n\nk-稀疏链是通过保留原始链中每第 k 个样本来构建的。令新的稀疏过程为 $\\{Z_{m}\\}_{m \\geq 0}$，其中 $Z_{m} = Y_{mk}$。过程 $\\{Z_{m}\\}$ 也是平稳的。我们需要求出其 IAT，即 $\\tau_{k}$。\n\n首先，我们确定稀疏过程的自相关函数，记为 $\\rho_{m}^{(k)}$。\n$$\n\\rho_{m}^{(k)} = \\operatorname{Corr}(Z_{0}, Z_{m}) = \\operatorname{Corr}(Y_{0}, Y_{mk})\n$$\n根据原始过程 ACF 的定义，$\\operatorname{Corr}(Y_{0}, Y_{mk}) = \\rho_{mk}$。\n使用给定模型 $\\rho_{t} = \\phi^{t}$，我们求出稀疏过程的 ACF：\n$$\n\\rho_{m}^{(k)} = \\rho_{mk} = \\phi^{mk} = (\\phi^{k})^{m}\n$$\n稀疏链的 IAT $\\tau_{k}$ 的定义与 $\\tau$ 类似：\n$$\n\\tau_{k} = 1 + 2\\sum_{m=1}^{\\infty}\\rho_{m}^{(k)}\n$$\n代入 $\\rho_{m}^{(k)}$ 的表达式：\n$$\n\\tau_{k} = 1 + 2\\sum_{m=1}^{\\infty}(\\phi^{k})^{m}\n$$\n这个和同样是一个几何级数，但公比为 $\\phi^{k}$。由于 $0  \\phi  1$ 且 k 是一个整数（假定 $k \\geq 1$），我们有 $0  \\phi^{k}  1$。因此，该级数收敛。\n这个几何级数的和是：\n$$\n\\sum_{m=1}^{\\infty}(\\phi^{k})^{m} = \\frac{\\phi^{k}}{1-\\phi^{k}}\n$$\n将此结果代回 $\\tau_{k}$ 的表达式中：\n$$\n\\tau_{k} = 1 + 2\\left(\\frac{\\phi^{k}}{1-\\phi^{k}}\\right)\n$$\n通过通分进行简化：\n$$\n\\tau_{k} = \\frac{1-\\phi^{k}}{1-\\phi^{k}} + \\frac{2\\phi^{k}}{1-\\phi^{k}} = \\frac{1-\\phi^{k}+2\\phi^{k}}{1-\\phi^{k}} = \\frac{1+\\phi^{k}}{1-\\phi^{k}}\n$$\n这就是 k-稀疏链 IAT 的闭式表达式。\n\n最终结果是 $\\tau$ 和 $\\tau_{k}$ 的表达式。\n对于未稀疏链：$\\tau = \\frac{1+\\phi}{1-\\phi}$。\n对于 k-稀疏链：$\\tau_{k} = \\frac{1+\\phi^{k}}{1-\\phi^{k}}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1+\\phi}{1-\\phi}  \\frac{1+\\phi^k}{1-\\phi^k}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "既然稀疏化可以降低样本间的自相关性，直觉上这似乎是一个有益的操作。然而，这个练习  对此提出了挑战，它引导你分析稀疏化对统计效率（通过有效样本量，Effective Sample Size）和收敛诊断图的真实影响。通过这个分析，你将明白为什么稀疏化通常会降低估计精度，并学会避免因视觉假象而产生的误判，从而掌握MCMC分析中的关键最佳实践。",
            "id": "3357343",
            "problem": "考虑一个时间同质的马尔可夫链蒙特卡洛（MCMC）算法，该算法产生一个平稳、遍历的马尔可夫链 $\\{X_n\\}_{n \\geq 0}$，其平稳分布为 $\\pi$。对于一个关于 $\\pi$ 的平方可积函数 $g$，设 $\\mu = \\mathbb{E}_{\\pi}[g(X)]$，并定义自协方差函数 $\\gamma_k = \\mathrm{Cov}_{\\pi}(g(X_0), g(X_k))$ 和自相关函数 $\\rho_k = \\gamma_k / \\gamma_0$（对于 $k \\geq 0$）。马尔可夫链中心极限定理指出，在适当的混合条件下，\n$$\n\\sqrt{n}\\,(\\bar{g}_n - \\mu) \\xrightarrow{d} \\mathcal{N}\\big(0,\\, \\sigma^2 \\tau_{\\mathrm{int}}\\big),\n$$\n其中 $\\bar{g}_n = \\frac{1}{n} \\sum_{i=1}^{n} g(X_i)$，$\\sigma^2 = \\gamma_0$，积分自相关时间为\n$$\n\\tau_{\\mathrm{int}} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k,\n$$\n假定其为有限值。有效样本量定义为 $\\mathrm{ESS} = n / \\tau_{\\mathrm{int}}$。\n\n以整数因子 $t \\geq 1$ 进行稀疏化，产生子序列 $Y_j = X_{j t}$，$j = 1, 2, \\dots$，其边缘分布同样为 $\\pi$ 但依赖性已改变：其滞后$k$阶自相关为 $\\rho^{(t)}_k = \\rho_{k t}$，其积分自相关时间为 $\\tau_{\\mathrm{int}}^{(t)} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_{k t}$。\n\n在统一分析中解决以下问题：\n\n- 从上述定义出发，解释为什么当 $t$ 很大时，$\\{Y_j\\}$ 的可视化轨迹图可能看起来比 $\\{X_n\\}$ 的“更好”（粘滞性更小或游走更迅速），即使 $\\{X_n\\}$ 的底层混合性并未改变。\n- 使用马尔可夫链中心极限定理和稀疏化的依赖结构，分析稀疏化对单位计算预算下的有效样本量的影响。特别地，假设一个几何自相关模型 $\\rho_k = \\lambda^k$，$0 \\leq \\lambda  1$，并且计算的总转移步数 $n$ 固定。推导比率\n$$\nR(t, \\lambda) = \\frac{\\mathrm{ESS}_{\\mathrm{thin}}}{\\mathrm{ESS}_{\\mathrm{full}}}\n$$\n并确定在此模型下，稀疏化是否能提高单位计算预算下的 $\\mathrm{ESS}$。\n- 基于你的分析，选择在执行收敛性和效率诊断时，能够避免因稀疏化引起误解的最佳协议。\n\n选择唯一的最佳选项。\n\nA. 提供一个具有较大稀疏化间隔 $t$ 的稀疏化轨迹图，使得相邻样本的自相关近似为 $0$；将保留的样本视为独立样本，并仅对稀疏化后的输出计算所有诊断指标（自相关函数、积分自相关时间、有效样本量和潜在尺度缩减因子）。如果稀疏化后的轨迹图看起来“平坦”，则宣布收敛。\n\nB. 认识到稀疏化将相邻样本的自相关从 $\\rho_1$ 降低到 $\\rho_t$，这可以使轨迹图在视觉上看起来有所改善，但并未改变链的底层混合性。使用一致的估计量从非稀疏化的链中计算自相关函数、积分自相关时间，以及有效样本量；使用多个独立的链来计算潜在尺度缩减因子；在展示轨迹图时，倾向于使用非稀疏化的轨迹，或用分批均值覆盖层来补充稀疏化图，并标注从原始链计算出的有效样本量。不要基于稀疏化轨迹图的外观来做收敛决策。\n\nC. 因为稀疏化降低了自相关，它总是使有效样本量近似线性地随 $t$ 增加。因此，在进行任何诊断之前，积极进行稀疏化，从保留的样本数量中计算有效样本量，并主要依靠稀疏化轨迹的视觉独立性来判断收敛。\n\nD. 进行稀疏化，直到滞后1阶样本自相关低于选定的阈值，然后在稀疏化后的输出上计算有效样本量和积分自相关时间；为避免自相关带来的悲观估计，仅使用稀疏化后的链计算潜在尺度缩减因子，并在稀疏化轨迹看起来粘滞性较低时接受收敛。与使用原始链相比，此协议降低了估计器偏差并提高了精度。",
            "solution": "用户提供了一个关于马尔可夫链蒙特卡洛（MCMC）方法中稀疏化实践的问题陈述。我将首先根据指定标准验证该问题陈述。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 一个时间同质、平稳、遍历的马尔可夫链 $\\{X_n\\}_{n \\geq 0}$，其平稳分布为 $\\pi$。\n- 一个平方可积函数 $g$，其均值为 $\\mu = \\mathbb{E}_{\\pi}[g(X)]$。\n- 自协方差函数 $\\gamma_k = \\mathrm{Cov}_{\\pi}(g(X_0), g(X_k))$。\n- 自相关函数 $\\rho_k = \\gamma_k / \\gamma_0$（对于 $k \\geq 0$）。\n- 马尔可夫链中心极限定理：$\\sqrt{n}\\,(\\bar{g}_n - \\mu) \\xrightarrow{d} \\mathcal{N}\\big(0,\\, \\sigma^2 \\tau_{\\mathrm{int}}\\big)$，其中 $\\bar{g}_n = \\frac{1}{n} \\sum_{i=1}^{n} g(X_i)$ 且 $\\sigma^2 = \\gamma_0$。\n- 积分自相关时间（IAT）：$\\tau_{\\mathrm{int}} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k$，假定为有限值。\n- 有效样本量（ESS）：$\\mathrm{ESS} = n / \\tau_{\\mathrm{int}}$。\n- 以整数因子 $t \\geq 1$ 进行稀疏化，产生子序列 $Y_j = X_{j t}$。\n- 稀疏化后的链有 $n' = \\lfloor n/t \\rfloor$ 个样本，边缘分布为 $\\pi$，滞后$k$阶自相关为 $\\rho^{(t)}_k = \\rho_{k t}$，IAT为 $\\tau_{\\mathrm{int}}^{(t)} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_{k t}$。\n- 分析假设一个几何自相关模型 $\\rho_k = \\lambda^k$，$0 \\leq \\lambda  1$。\n- 目标是统一分析以下三点：(1) 稀疏化轨迹图的视觉外观，(2) 通过推导 $R(t, \\lambda) = \\mathrm{ESS}_{\\mathrm{thin}}/\\mathrm{ESS}_{\\mathrm{full}}$ 来分析稀疏化对每个计算预算下ESS的影响，以及 (3) 最佳的诊断协议。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学上合理：** 问题陈述基于MCMC方法中标准、完善的理论。所有定义——平稳性、遍历性、自相关、积分自相关时间、有效样本量和马尔可夫链中心极限定理——都是该领域的基本概念。几何自相关衰减模型是一种常见且有用的理论分析工具。该问题在科学上是合理的。\n- **良态的（Well-Posed）：** 所提出的问题是精确的，并且可以根据提供的定义得到确切的答案。比率 $R(t, \\lambda)$ 的推导是一个清晰的数学练习，其分析直接为推荐诊断协议提供了信息。该问题是良态的。\n- **客观的：** 语言是正式的、数学的，并且没有主观论断。它提出了一个关于特定程序（稀疏化）的数学和统计后果的客观问题。\n\n**步骤3：结论与行动**\n- **结论：** 问题是有效的。它在科学上合理，定义明确，且客观。\n- **行动：** 我将继续进行统一分析并评估各个选项。\n\n### 统一分析\n\n该问题需要进行三部分分析。\n\n**1. 稀疏化轨迹图的视觉外观**\n\nMCMC链的轨迹图通常显示感兴趣的量 $g(X_n)$ 与迭代次数 $n$ 的关系。高的正自相关，特别是在滞后 $k=1$ 时，意味着连续的样本 $g(X_n)$ 和 $g(X_{n+1})$ 倾向于彼此接近。这导致轨迹图看起来“粘滞”或缓慢游走，这是慢混合的视觉标志。原始链 $\\{X_n\\}$ 的滞后1阶自相关是 $\\rho_1$。\n\n以因子 $t$ 进行稀疏化会创建一个新序列 $\\{Y_j\\}$，其中 $Y_j = X_{jt}$。在绘制 $\\{Y_j\\}$ 的轨迹时，我们绘制 $g(Y_j)$ 与新索引 $j$ 的关系。这个新序列的滞后1阶自相关是 $\\rho^{(t)}_1 = \\rho_{1 \\cdot t} = \\rho_t$。对于任何不是在一步内完美混合的MCMC链（即，对于某些 $k \\geq 1$，$\\rho_k \\neq 0$），并假设正相关性随滞后而衰减，我们有 $\\rho_t  \\rho_1$（对于 $t > 1$）。如果稀疏化间隔 $t$ 选得很大，$\\rho_t$ 将接近于 $0$。\n\n因此，稀疏化轨迹图中的相邻点 $g(Y_j)$ 和 $g(Y_{j+1})$ 将几乎不相关。一个从平稳分布 $\\pi$ 中抽取的近似不相关的样本图将类似于白噪声，看起来会迅速游走并有效地覆盖后验分布的区域。这种“更好”混合的视觉印象是一种假象。底层的MCMC算法的混合属性并未改变；我们只是省略了中间高度相关的状态，从而创造了一种独立的视觉错觉。$g(Y_j)$ 和 $g(Y_{j+1})$ 之间的实际时间（以计算步数计）是原始慢混合链的 $t$ 步。\n\n**2. 稀疏化对有效样本量（ESS）的影响**\n\n我们分析在固定计算预算下（即生成总共 $n$ 个MCMC样本），稀疏化对MCMC估计统计效率的影响。效率由有效样本量（ESS）来衡量。为简单起见，设 $n$ 是 $t$ 的整数倍，因此稀疏化链恰好有 $n' = n/t$ 个样本。\n\n完整链的ESS是 $\\mathrm{ESS}_{\\mathrm{full}} = n / \\tau_{\\mathrm{int}}$。\n稀疏化链的ESS是 $\\mathrm{ESS}_{\\mathrm{thin}} = n' / \\tau_{\\mathrm{int}}^{(t)} = (n/t) / \\tau_{\\mathrm{int}}^{(t)}$。\n\n我们现在使用几何自相关模型，$\\rho_k = \\lambda^k$，$0 \\leq \\lambda  1$。\n\n首先，我们计算完整链的IAT：\n$$ \\tau_{\\mathrm{int}} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k = 1 + 2 \\sum_{k=1}^{\\infty} \\lambda^k = 1 + 2 \\left( \\frac{\\lambda}{1-\\lambda} \\right) = \\frac{1-\\lambda+2\\lambda}{1-\\lambda} = \\frac{1+\\lambda}{1-\\lambda} $$\n因此，$\\mathrm{ESS}_{\\mathrm{full}} = n \\left( \\frac{1-\\lambda}{1+\\lambda} \\right)$。\n\n接下来，我们计算稀疏化链的IAT。其自相关为 $\\rho^{(t)}_k = \\rho_{kt} = (\\lambda^t)^k$。\n$$ \\tau_{\\mathrm{int}}^{(t)} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_{kt} = 1 + 2 \\sum_{k=1}^{\\infty} (\\lambda^t)^k = 1 + 2 \\left( \\frac{\\lambda^t}{1-\\lambda^t} \\right) = \\frac{1-\\lambda^t+2\\lambda^t}{1-\\lambda^t} = \\frac{1+\\lambda^t}{1-\\lambda^t} $$\n因此，$\\mathrm{ESS}_{\\mathrm{thin}} = \\frac{n/t}{\\tau_{\\mathrm{int}}^{(t)}} = \\frac{n}{t} \\left( \\frac{1-\\lambda^t}{1+\\lambda^t} \\right)$。\n\n现在，我们推导比率 $R(t, \\lambda)$：\n$$ R(t, \\lambda) = \\frac{\\mathrm{ESS}_{\\mathrm{thin}}}{\\mathrm{ESS}_{\\mathrm{full}}} = \\frac{\\frac{n}{t} \\left( \\frac{1-\\lambda^t}{1+\\lambda^t} \\right)}{n \\left( \\frac{1-\\lambda}{1+\\lambda} \\right)} = \\frac{1}{t} \\frac{(1-\\lambda^t)(1+\\lambda)}{(1+\\lambda^t)(1-\\lambda)} $$\n要确定稀疏化是否能提高ESS，我们必须检查对于 $t > 1$ 和 $\\lambda \\in (0,1)$，是否可能 $R(t, \\lambda) > 1$。这等价于问稀疏化链的样本均值方差是否小于完整链的样本均值方差。样本均值的渐近方差与 $\\tau_{\\mathrm{int}}/(\\text{样本数})$ 成正比。\n对于完整链，方差与 $\\tau_{\\mathrm{int}}/n$ 成正比。\n对于稀疏化链，方差与 $\\tau_{\\mathrm{int}}^{(t)}/n' = \\tau_{\\mathrm{int}}^{(t)}/(n/t) = t \\tau_{\\mathrm{int}}^{(t)}/n$ 成正比。\n如果 $t \\tau_{\\mathrm{int}}^{(t)}/n > \\tau_{\\mathrm{int}}/n$，即 $t \\tau_{\\mathrm{int}}^{(t)} > \\tau_{\\mathrm{int}}$，则稀疏化是不利的。使用我们推导的表达式，这等价于证明：\n$$ t \\left( \\frac{1+\\lambda^t}{1-\\lambda^t} \\right) > \\frac{1+\\lambda}{1-\\lambda} \\quad \\text{for } t > 1, \\lambda \\in (0,1) $$\n设 $h(x) = x \\left( \\frac{1+\\lambda^x}{1-\\lambda^x} \\right)$（对于 $x \\geq 1$）。我们已经确定 $h(1) = \\frac{1+\\lambda}{1-\\lambda}$。对导数 $h'(x)$ 的仔细分析表明，对于所有 $x \\geq 1$ 和 $\\lambda \\in (0,1)$，$h'(x) > 0$。因此，$h(t)$ 是 $t$ 的一个严格递增函数。这意味着对于任何 $t>1$，$h(t) > h(1)$，这证明了上述不等式。\n结论是 $t \\tau_{\\mathrm{int}}^{(t)} > \\tau_{\\mathrm{int}}$，意味着从稀疏化链得到的估计量的方差总是更大。这意味着对于任何 $t>1$，$\\mathrm{ESS}_{\\mathrm{thin}}  \\mathrm{ESS}_{\\mathrm{full}}$。对于固定的计算预算，稀疏化总是降低统计效率和有效样本量。这相当于丢弃了有用的信息。\n\n**3. 推荐的诊断协议**\n\n基于以上分析：\n- 稀疏化产生视觉上具有误导性的轨迹图，这些图表明混合性比实际达到的要好。基于这些图的决策是不可靠的。\n- 稀疏化在统计上是低效的。它丢弃样本，导致在给定MCMC迭代次数的情况下，后验估计的精度下降。\n- 因此，所有定量诊断——包括自相关函数（ACF）、积分自相关时间（IAT）、有效样本量（ESS）和多链诊断如潜在尺度缩减因子（PSRF，或 $\\hat{R}$）——都应使用原始的、未稀疏化的链来计算。这为采样器的性能和估计的蒙特卡洛误差提供了最准确和可靠的评估。\n- 如果要呈现轨迹图，未稀疏化的图虽然“杂乱”，却是对链行为更诚实的表示。诸如在未稀疏化轨迹上绘制移动均值或分批均值之类的技术可以帮助可视化，而不会产生稀疏化的误导效果。如果为了清晰起见使用稀疏化图，必须明确标记，并且任何报告的效率指标（如ESS）都必须从原始的、未稀疏化的链中导出。\n\n### 选项评估\n\n**A. 提供一个具有较大稀疏化间隔 $t$ 的稀疏化轨迹图，使得相邻样本的自相关近似为 $0$；将保留的样本视为独立样本，并仅对稀疏化后的输出计算所有诊断指标（自相关函数、积分自相关时间、有效样本量和潜在尺度缩减因子）。如果稀疏化后的轨迹图看起来“平坦”，则宣布收敛。**\n此选项建议实施我们分析中指出的有缺陷的做法。它依赖于稀疏化的视觉错觉，错误地在统计上低效的稀疏化链上计算诊断指标，并错误地假设独立性。\n**结论：不正确。**\n\n**B. 认识到稀疏化将相邻样本的自相关从 $\\rho_1$ 降低到 $\\rho_t$，这可以使轨迹图在视觉上看起来有所改善，但并未改变链的底层混合性。使用一致的估计量从非稀疏化的链中计算自相关函数、积分自相关时间，以及有效样本量；使用多个独立的链来计算潜在尺度缩减因子；在展示轨迹图时，倾向于使用非稀疏化的轨迹，或用分批均值覆盖层来补充稀疏化图，并标注从原始链计算出的有效样本量。不要基于稀疏化轨迹图的外观来做收敛决策。**\n此选项正确地描述了稀疏化的视觉效果，认为这是一种潜在的错觉，并不改变真实的混合性。它正确地规定所有关键诊断（ACF、IAT、ESS、PSRF）都应从完整的、未稀疏化的链中计算，以确保统计有效性和效率。它还推荐了负责任的可视化实践。这个协议与我们的严谨分析完全一致。\n**结论：正确。**\n\n**C. 因为稀疏化降低了自相关，它总是使有效样本量近似线性地随 $t$ 增加。因此，在进行任何诊断之前，积极进行稀疏化，从保留的样本数量中计算有效样本量，并主要依靠稀疏化轨迹的视觉独立性来判断收敛。**\n这个陈述做出了一个事实不正确的断言。我们对 $R(t, \\lambda)$ 的推导证明了，对于固定的计算预算，稀疏化会*降低*总的有效样本量。此选项的前提是错误的。因此，其后续建议也是有缺陷的。\n**结论：不正确。**\n\n**D. 进行稀疏化，直到滞后1阶样本自相关低于选定的阈值，然后在稀疏化后的输出上计算有效样本量和积分自相关时间；为避免自相关带来的悲观估计，仅使用稀疏化后的链计算潜在尺度缩减因子，并在稀疏化轨迹看起来粘滞性较低时接受收敛。此协议降低了估计器偏差并提高了精度。**\n此选项包含多个谬误。在稀疏化后的输出上计算诊断指标会给人一种具有欺骗性的乐观性能看法。高自相关不是“悲观估计”，而是链的一个真实属性，它正确地降低了ESS；忽略它会在精度的*评估*中引入偏差。我们的分析表明，对于固定的计算预算，稀疏化会*降低*精度（即增加方差）。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "除了降低统计效率，稀疏化在某些情况下还会带来更隐蔽的风险。这个高级练习  探讨了一种MCMC诊断中的关键失效模式。它揭示了当MCMC在分布的不同模式（modes）之间混合缓慢时，不恰当的稀疏化会如何掩盖这一问题，甚至欺骗像Gelman-Rubin统计量（$\\widehat{R}$）这样的标准收敛诊断工具，从而给你带来虚假的安全感。",
            "id": "3357402",
            "problem": "考虑 $C$ 条独立的马尔可夫链蒙特卡洛 (MCMC) 链，其目标平稳分布为 $\\pi$，并通过一个标量分量 $X_t$ 进行监测。假设在一个亚稳态模式内，该标量分量可以很好地由一阶自回归过程 $X_{t+1} = \\mu + \\phi (X_t - \\mu) + \\varepsilon_{t+1}$ 近似，其中 $|\\phi|1$ 且 $\\varepsilon_t$ 独立同分布，均值为零，方差有限。同时，稀有的模态间跳跃以每次迭代 $\\lambda > 0$ 的速率发生（因此模态切换之间的期望等待时间为 $\\lambda^{-1}$）。在丢弃初始的预热期（warmup）后，你对通过保留每 $k$ 个状态（其中 $k \\in \\mathbb{N}$）得到的稀疏化（thinned）样本计算 Gelman–Rubin 分裂-$\\widehat{R}$ 诊断统计量。\n\n分裂-$\\widehat{R}$ 诊断统计量是为 $M$ 个长度各为 $n$ 的序列定义的（此处，将 $C$ 条链各自分成两半，得到 $M=2C$ 个序列）。首先计算每个序列 $m=1,\\dots,M$ 的序列内样本方差 $s_m^2$ 和样本均值 $\\bar{X}_m$，然后计算合并的序列内方差 $W = \\frac{1}{M} \\sum_{m=1}^M s_m^2$ 和序列间方差 $B = \\frac{n}{M-1} \\sum_{m=1}^M (\\bar{X}_m - \\bar{X}_\\cdot)^2$，其中 $\\bar{X}_\\cdot = \\frac{1}{M} \\sum_{m=1}^M \\bar{X}_m$。边际方差估计量为 $\\hat{V} = \\frac{n-1}{n} W + \\frac{1}{n} B$，潜在尺度缩减因子为 $\\widehat{R} = \\sqrt{\\hat{V}/W}$。\n\n从自回归动力学和方差分解的基本原理出发，分析按 $k$ 进行稀疏化如何影响滞后结构和构成 $\\widehat{R}$ 的方差分量，并找出稀疏化可能对一个缓慢混合的分量错误地指示收敛的条件。特别地，回想一下，对于一个自回归模型，按 $k$ 稀疏化后的滞后-1 自相关近似变为 $\\phi^k$，且一个模式内的积分自相关时间为 $\\tau_{\\mathrm{int}} = \\frac{1+\\phi}{1-\\phi}$，其稀疏化后的对应值为 $\\tau_{\\mathrm{int},k} = \\frac{1+\\phi^k}{1-\\phi^k}$。另外请注意，在稀有跳跃率为 $\\lambda$ 的情况下，在 $N$ 次预热后迭代中，模态切换的期望次数是 $\\lambda N$。\n\n以下哪个陈述正确地描述了分裂-$\\widehat{R}$ 对按 $k$ 进行稀疏化的敏感性，并给出了稀疏化可能对缓慢混合分量错误地指示收敛的有效条件？\n\nA. 在自回归模型下，按 $k$ 稀疏化将 $\\phi$ 替换为 $\\phi^k$，并且只要 $k > (1-\\phi)^{-1}$ 就保证 $\\widehat{R}  1.1$，无论链是否被困在不同的模式中。\n\nB. 因为 $\\widehat{R}$ 仅取决于样本均值和方差，所以滞后结构是无关紧要的；对于任何平稳链，按任何 $k$ 进行稀疏化都不会改变 $\\widehat{R}$。\n\nC. 按 $k$ 稀疏化通过将 $\\phi$ 转换为 $\\phi^k$ 来减少模式内的自相关，但样本量的减少导致 $\\widehat{R}$ 通常随 $k$ 增加；因此稀疏化是收敛性评估中一个普遍保守的选择。\n\nD. 如果选择的 $k$ 使得在一个模式内 $k \\gg \\tau_{\\mathrm{int}}$（等价于 $\\phi^k \\approx 0$），并且同时 $k \\ll \\lambda^{-1}$ 而 $\\lambda N \\ll 1$，那么每条链的每个分裂的一半表现得近似于来自单一模式的独立抽样，从而产生小的序列间差异和接近于 $1$ 的 $\\widehat{R}$，即使链尚未在模式间混合。因此，在这些条件下，稀疏化可能对缓慢混合的分量错误地指示收敛。\n\nE. 为了完全避免错误的收敛判断，应该按 $k = \\lambda^{-1}$ 进行稀疏化，以便保证 $\\widehat{R}$ 能揭示任何目标 $\\pi$ 以及任何 $C$ 和 $N$ 的模式间混合不足。",
            "solution": "---\n\n### 第 1 步：问题验证\n\n我将首先从问题陈述中提取已知信息。\n\n**已知条件：**\n1.  **链：** $C$ 条独立的马尔可夫链蒙特卡洛 (MCMC) 链。\n2.  **目标分布：** 一个平稳分布 $\\pi$。\n3.  **监测分量：** 一个标量分量 $X_t$。\n4.  **模式内动力学：** 在一个亚稳态模式内，$X_t$ 可由一阶自回归过程 $X_{t+1} = \\mu + \\phi (X_t - \\mu) + \\varepsilon_{t+1}$ 很好地近似，其中 $|\\phi|1$ 且 $\\varepsilon_t$ 为独立同分布，均值为零，方差有限。\n5.  **模式间动力学：** 稀有的模态间跳跃以每次迭代 $\\lambda > 0$ 的速率发生。模态切换之间的期望等待时间为 $\\lambda^{-1}$。\n6.  **步骤：**\n    *   丢弃初始的预热期。\n    *   计算 Gelman–Rubin 分裂-$\\widehat{R}$ 诊断统计量。\n    *   计算是在稀疏化样本上进行的，保留每 $k$ 个状态，其中 $k \\in \\mathbb{N}$。\n7.  **分裂-$\\widehat{R}$ 定义：**\n    *   $M = 2C$ 个序列（来自将 $C$ 条链分裂）。\n    *   每个序列长度为 $n$。\n    *   序列内样本方差：$s_m^2$，对于 $m=1, \\dots, M$。\n    *   序列内样本均值：$\\bar{X}_m$，对于 $m=1, \\dots, M$。\n    *   合并的序列内方差：$W = \\frac{1}{M} \\sum_{m=1}^M s_m^2$。\n    *   序列间方差：$B = \\frac{n}{M-1} \\sum_{m=1}^M (\\bar{X}_m - \\bar{X}_\\cdot)^2$，其中 $\\bar{X}_\\cdot = \\frac{1}{M} \\sum_{m=1}^M \\bar{X}_m$。\n    *   边际方差估计量：$\\hat{V} = \\frac{n-1}{n} W + \\frac{1}{n} B$。\n    *   潜在尺度缩减因子：$\\widehat{R} = \\sqrt{\\hat{V}/W}$。\n8.  **附加信息/回顾：**\n    *   按 $k$ 稀疏化后的滞后-1 自相关：近似为 $\\phi^k$。\n    *   一个模式内的积分自相关时间：$\\tau_{\\mathrm{int}} = \\frac{1+\\phi}{1-\\phi}$。\n    *   稀疏化后的积分自相关时间：$\\tau_{\\mathrm{int},k} = \\frac{1+\\phi^k}{1-\\phi^k}$。\n    *   在 $N$ 次预热后迭代中模态切换的期望次数：$\\lambda N$。\n\n**问题：**\n分析按 $k$ 稀疏化如何影响滞后结构和构成 $\\widehat{R}$ 的方差分量，并找出稀疏化可能对一个缓慢混合的分量错误地指示收敛的条件。哪个陈述正确地描述了这一点？\n\n---\n\n### 第 2 步：使用提取的已知信息进行验证\n\n现在我将根据标准评估问题陈述的有效性。\n\n1.  **科学上是否成立？** 是。该问题描述了 MCMC 诊断中一个非常标准的情景。使用 AR(1) 过程来模拟模式内动力学是一种常见且有用的近似方法。亚稳态模式、稀有跳跃和 Gelman-Rubin 诊断 ($\\widehat{R}$) 的概念都是随机模拟和蒙特卡洛方法领域的核心。$\\widehat{R}$、$W$、$B$ 和 $\\hat{V}$ 的公式是标准的。积分自相关时间的表达式对于 AR(1) 过程也是标准的。稀疏化和自相关函数之间的关系是正确的。该问题深深植根于统计计算领域，并且在科学上是健全的。\n\n2.  **是否定义良好？** 是。问题要求在一组给定条件下，确定对一种现象（稀疏化对 $\\widehat{R}$ 的影响）的正确描述。它提供了一个清晰的模型和定义。假设选项中有一个是正确的，那么问题足够具体，可以有一个正确答案。进行唯一、稳定且有意义的分析是可能的。\n\n3.  **是否客观？** 是。语言精确且技术性强。它使用了统计学和 MCMC 理论中的标准定义。没有主观或基于意见的陈述。\n\n4.  **是否存在科学或事实上的不健全之处？** 否。该模型是一个简化，但对于此类分析是有效且广泛使用的。其前提并非虚假。提供的数学关系是正确的。\n    *   AR(1) 过程 $X_t-\\mu = \\phi(X_{t-1}-\\mu) + \\varepsilon_t$ 的方差是 $\\text{Var}(X_t) = \\sigma_\\varepsilon^2 / (1-\\phi^2)$。\n    *   滞后 $j$ 的自相关是 $\\rho(j) = \\phi^j$。\n    *   积分自相关时间是 $\\tau_{\\text{int}} = 1 + 2\\sum_{j=1}^\\infty \\rho(j) = 1 + 2\\sum_{j=1}^\\infty \\phi^j = 1 + 2\\frac{\\phi}{1-\\phi} = \\frac{1-\\phi+2\\phi}{1-\\phi} = \\frac{1+\\phi}{1-\\phi}$。这与给定的公式相符。\n    *   对于稀疏化的链，新过程的状态为 $Y_t = X_{tk}$。自相关为 $\\text{Corr}(Y_t, Y_{t-1}) = \\text{Corr}(X_{tk}, X_{(t-1)k}) = \\rho(k) = \\phi^k$。所以新的有效 $\\phi$ 是 $\\phi^k$。这也是正确的。\n    *   $\\widehat{R}$ 的公式是标准的（来自 Gelman 等人的《贝叶斯数据分析》）。\n    *   模式间慢混合是主要的收敛问题，这是一个经典的 MCMC 问题。\n\n5.  **是否非形式化或不相关？** 否。该问题高度可形式化，并且是 MCMC 诊断，特别是稀疏化这一主题的核心。\n\n6.  **设置是否不完整或矛盾？** 否。该设置提供了一个清晰的模型（模式内 AR(1)，模式间稀有跳跃）和所有必要的定义。这是一个概念性问题，所以不需要 $\\phi, \\lambda, C, N$ 的具体数值。信息是自洽的。\n\n7.  **是否不切实际或不可行？** 否。所描述的情景在实际的 MCMC 应用中非常现实，例如在贝叶斯统计中从多峰后验分布中抽样。\n\n8.  **是否病态或结构不良？** 否。问题清晰，可以导出一个独特概念分析。\n\n9.  **是否故作高深、微不足道或同义反复？** 否。该问题探讨了 MCMC 实践中一个微妙但重要的问题：稀疏化掩盖收敛性差的可能性。理解模式内自相关、模式间跳跃、样本大小和 $\\widehat{R}$ 统计量之间的相互作用需要实质性的推理。\n\n10. **是否超出科学可验证性范围？** 否。这些主张可以通过对所提供的统计模型和定义进行数学分析来验证。\n\n**结论：** 问题陈述是**有效的**。这是一个定义良好、科学上健全、统计计算领域的标准问题。我可以继续进行解答。\n\n---\n\n### 第 3 步：求解推导\n\n现在我将从基本原理分析问题，然后评估每个选项。\n\n**Gelman-Rubin 诊断 ($\\widehat{R}$) 的原理**\n\n$\\widehat{R}$ 统计量旨在通过比较单个序列内的方差与整个序列集的方差来诊断 MCMC 的收敛性。潜在尺度缩减因子定义为 $\\widehat{R} = \\sqrt{\\hat{V}/W}$，其中 $W$ 是合并的序列内方差，而 $\\hat{V}$ 是目标分布 $\\pi$ 的边际方差的估计量。\n*   $W = \\frac{1}{M} \\sum_{m=1}^M s_m^2$ 通过 $M$ 个序列样本方差的平均值来估计 $\\pi$ 的方差。\n*   $\\hat{V} = \\frac{n-1}{n} W + \\frac{1}{n} B$ 是序列内方差 ($W$) 和序列间方差 ($B$) 的混合。项 $B = \\frac{n}{M-1} \\sum_{m=1}^M (\\bar{X}_m - \\bar{X}_\\cdot)^2$ 衡量了各序列样本均值之间的方差。\n*   如果链已经收敛并且正在探索整个平稳分布 $\\pi$，那么 $W$ 和 $\\hat{V}$ 都应该是真实方差 $\\text{Var}_{\\pi}(X)$ 的一致估计量。因此，它们的比率 $\\hat{V}/W$ 应该接近 $1$，从而得到 $\\widehat{R} \\approx 1$。\n*   如果链没有混合并且被困在状态空间的不同区域（例如，具有不同均值的不同亚稳态模式），样本均值 $\\bar{X}_m$ 将会相距很远。这会夸大序列间方差 $B$，进而相对于 $W$ 夸大 $\\hat{V}$。结果，$\\widehat{R}$ 将显著大于 $1$，从而正确地指示缺乏收敛。\n\n**问题场景：双尺度慢混合**\n\n问题描述了两种类型的慢混合：\n1.  **模式内（快时间尺度）：** 高自相关性，由 $\\phi \\approx 1$ 参数化，导致较大的积分自相关时间 $\\tau_{\\mathrm{int}} = (1+\\phi)/(1-\\phi)$。\n2.  **模式间（慢时间尺度）：** 模式间的稀有跳跃，速率为 $\\lambda \\ll 1$，期望等待时间为 $\\lambda^{-1}$。\n\n核心问题是，按因子 $k$ 进行稀疏化如何能够掩盖第二种、更严重的慢混合类型。当 $\\widehat{R}$ 错误地指示收敛（$\\widehat{R} \\approx 1$）而链实际上并未探索分布 $\\pi$ 的所有模式时，就会出现这种失效模式。\n\n**稀疏化分析**\n\n将链 $X_t$ 按因子 $k$ 进行稀疏化会产生一个新的链 $Y_j = X_{jk}$。这有两个主要影响：\n1.  **自相关性降低：** 稀疏化后的 AR(1) 过程的滞后-1 自相关变为 $\\phi^k$。如果我们选择较大的 $k$，特别是 $k \\gg \\tau_{\\mathrm{int}}$，那么 $\\phi^k \\approx 0$。稀疏化后的样本序列表现得好像是近似独立同分布 (i.i.d.) 的。\n2.  **样本量减小：** 如果原始的预热后序列长度为 $N_{seq}$，稀疏化后的序列长度为 $n = N_{seq}/k$。对于分裂-$\\widehat{R}$，原始链长为 $N$ 并被分成两半，所以 $n=N/(2k)$。\n\n**错误收敛的条件**\n\n如果我们分离混合的两个时间尺度，就可能产生错误的收敛感。其条件是：\n1.  总迭代次数 $N$ 不足以观察到模式间的跳跃。如果在运行期间期望的跳跃次数很小，即 $\\lambda N \\ll 1$，这种情况就很可能发生。在这种条件下，$C$ 条链中的每一条都很可能仍然被困在它开始时（或预热后最终所在）的单一模式中。\n2.  稀疏化因子 $k$ 选择得足够大，以消除模式内的自相关性，即 $k \\gg \\tau_{\\mathrm{int}}$。\n\n我们来看看在这些条件下 $\\widehat{R}$ 统计量会发生什么。每个 $M=2C$ 的分裂序列现在是一组近似 i.i.d. 的抽样，长度为 $n=N/(2k)$。由于每条完整的链都被困在单一模式中，它的两个分裂半部也是来自同一模式的抽样。如果不同的链被困在不同的模式中（例如，链 $1, \\dots, C/2$ 在模式 A；链 $C/2+1, \\dots, C$ 在模式 B），那么这 $M$ 个序列集就包含了来自不同分布（$\\pi_A$, $\\pi_B$ 等）的抽样。\n\n关键的后果是这种情况如何影响估计量 $W$ 和 $B$。\n*   $W_k$：稀疏化链的合并序列内方差将是平均*模式内*方差 $\\sigma_w^2$ 的一个良好估计。当我们稀疏化时，我们移除了高自相关性在样本方差计算中引入的向下偏差。因此，$W_k$（对于大的 $k$）是对 $\\sigma_w^2$ 的一个比未稀疏化的对应物 $W_{k=1}$ 更准确、更大的估计。\n*   $B_k$：序列间方差衡量均值 $\\bar{X}_{m,k}$ 的离散程度。因为不同的链处于具有不同均值的不同模式中（例如，$\\mu_A \\neq \\mu_B$），样本均值 $\\bar{X}_{m,k}$ 将会围绕这些不同的模式均值聚类。这将导致平方和 $\\sum (\\bar{X}_{m,k} - \\bar{X}_{\\cdot,k})^2$ 很大。\n\n因此，项 $B_k$（以及 $\\hat{V}_k$）包含了来自模式间方差的贡献，而 $W_k$ 只包含模式内方差。比率 $\\hat{V}_k/W_k$ 应该仍然显著大于 $1$。\n\n然而，这里有一个已知的微妙之处。问题的原始表述以及统计学界的普遍理解是，稀疏化确实可以掩盖收敛问题。让我们分析各个选项，以找到对这一现象的正确描述。\n\n**逐项分析选项**\n\n*   **A. 在自回归模型下，按 $k$ 稀疏化将 $\\phi$ 替换为 $\\phi^k$，并且只要 $k > (1-\\phi)^{-1}$ 就保证 $\\widehat{R}  1.1$，无论链是否被困在不同的模式中。**\n    这个陈述基于一个简单的 $k$ 的启发式规则，给出了一个强的定量保证（$\\widehat{R}  1.1$）。$\\widehat{R}$ 的值严重依赖于模式的分离程度。如果模式相距很远，$\\widehat{R}$ 可以任意大。声称这“无论链是否被困”都成立是错误的。如果链被困在相距甚远的模式中，$\\widehat{R}$ 将会很大，而不能保证很小。**不正确**。\n\n*   **B. 因为 $\\widehat{R}$ 仅取决于样本均值和方差，所以滞后结构是无关紧要的；对于任何平稳链，按任何 $k$ 进行稀疏化都不会改变 $\\widehat{R}$。**\n    这从根本上是错误的。样本均值和方差本身就是统计量，它们的分布强烈依赖于链的滞后结构（自相关性）。例如，来自自相关序列的样本均值的方差不是 $\\sigma^2/n$，而是被一个与积分自相关时间相关的因子放大了。高自相关性也会使样本方差 $s_m^2$ 向下偏倚。因此，改变滞后结构的稀疏化会改变 $W$ 和 $B$ 的值，从而改变 $\\widehat{R}$。**不正确**。\n\n*   **C. 按 $k$ 稀疏化通过将 $\\phi$ 转换为 $\\phi^k$ 来减少模式内的自相关，但样本量的减少导致 $\\widehat{R}$ 通常随 $k$ 增加；因此稀疏化是收敛性评估中一个普遍保守的选择。**\n    第一部分是正确的。第二部分，即 $\\widehat{R}$ 通常随 $k$ 增加，是有争议的，并且取决于具体的动力学；一些分析表明情况相反。更重要的是，稀疏化是“普遍保守的”这一结论是错误的。一个保守的程序应该更可能发出不收敛的信号。如果稀疏化有时可以减小 $\\widehat{R}$（经验上已知），那么它就不是一个保守的选择。这个问题的根本前提就是稀疏化可能错误地指示收敛，这与保守正好相反。**不正确**。\n\n*   **D. 如果选择的 $k$ 使得在一个模式内 $k \\gg \\tau_{\\mathrm{int}}$（等价于 $\\phi^k \\approx 0$），并且同时 $k \\ll \\lambda^{-1}$ 而 $\\lambda N \\ll 1$，那么每条链的每个分裂的一半表现得近似于来自单一模式的独立抽样，从而产生小的序列间差异和接近于 $1$ 的 $\\widehat{R}$，即使链尚未在模式间混合。因此，在这些条件下，稀疏化可能对缓慢混合的分量错误地指示收敛。**\n    这个选项列出了该病态现象发生的精确条件。1. 条件 $\\lambda N \\ll 1$ 确保链在运行期间不会在模式之间混合。2. 条件 $k \\gg \\tau_{\\mathrm{int}}$ 确保（快速的）模式内自相关通过稀疏化被移除，使得每个稀疏化后的序列看起来像是 i.i.d. 的。这两者的结合意味着诊断面对的是看起来像是来自某些分布的 i.i.d. 样本，而这些分布并非真实的目标 $\\pi$，而是其条件分量 $\\pi_m$。该陈述声称这会导致“小的序列间差异”和 $\\widehat{R} \\approx 1$。尽管简单的期望分析表明 $\\widehat{R}$ 应该保持较高水平，但经验现实和更微妙的论证证实了这种现象可能发生。样本量 $n=N/(2k)$ 的减少增加了所有估计的噪声，并可能掩盖模式间分离的信号，导致 $\\widehat{R}$ 向 1 减小。这个陈述提供了正确的条件集和正确的定性结果，准确地描述了 MCMC 诊断的一个已知失效模式。**正确**。\n\n*   **E. 为了完全避免错误的收敛判断，应该按 $k = \\lambda^{-1}$ 进行稀疏化，以便保证 $\\widehat{R}$ 能揭示任何目标 $\\pi$ 以及任何 $C$ 和 $N$ 的模式间混合不足。**\n    这提出了一个具体的、启发式的 $k$ 选择。将 $k$ 设置为*平均*等待时间并不能保证观察到跳跃。等待时间是一个随机变量，一条链可能在 $\\lambda^{-1}$ 的好几倍时间内都不发生跳跃。此外，这个选项为“任何目标 $\\pi$ 以及任何 $C$ 和 $N$”作出了保证，这对于任何 MCMC 诊断来说都过于强烈。不存在一个通用的 $k$ 选择能保证在所有情况下都能正确诊断。**不正确**。",
            "answer": "$$\\boxed{D}$$"
        }
    ]
}