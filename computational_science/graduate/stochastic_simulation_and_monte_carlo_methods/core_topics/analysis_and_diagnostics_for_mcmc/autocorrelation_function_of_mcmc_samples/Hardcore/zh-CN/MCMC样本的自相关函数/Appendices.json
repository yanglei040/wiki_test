{
    "hands_on_practices": [
        {
            "introduction": "综合自相关时间 $\\tau_{\\mathrm{int}}$ 是衡量马尔可夫链蒙特卡洛（MCMC）效率的关键指标。本练习为计算 $\\tau_{\\mathrm{int}}$ 提供了一个基础的实践经验，我们将针对经典的 AR(1) 过程，使用一个标准的窗口估计量来完成计算。这个过程将帮助你连接起 $\\tau_{\\mathrm{int}}$ 的理论定义与其实际计算之间的桥梁 。",
            "id": "3289769",
            "problem": "考虑一个平稳的一阶自回归马尔可夫链，这是马尔可夫链蒙特卡洛（MCMC）方法生成的时间序列的标准模型。设该链由递归式 $X_t = \\phi X_{t-1} + \\varepsilon_t$ 给出，其中 $|\\phi|  1$，而 $\\{\\varepsilon_t\\}$ 是一个独立同分布、零均值、有限方差的随机变量序列。假设我们观测到一个实现 $\\{X_t\\}_{t=1}^n$。\n\n定义样本均值 $\\bar{X} = \\frac{1}{n} \\sum_{t=1}^n X_t$，滞后 $k$ 的样本自协方差，\n$$\n\\hat{\\gamma}_k = \\frac{1}{n} \\sum_{t=1}^{n-k} (X_t - \\bar{X})(X_{t+k} - \\bar{X}),\n$$\n以及滞后 $k$ 的样本自相关函数，\n$$\n\\hat{\\rho}_k = \\frac{\\hat{\\gamma}_k}{\\hat{\\gamma}_0}.\n$$\n积分自相关时间定义为\n$$\n\\tau_{\\mathrm{int}} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k,\n$$\n其中 $\\rho_k$ 是滞后 $k$ 的真实自相关。一个实用的估计量使用一个窗口来截断和削减该和。特别地，使用截断值 $m$ 的 Bartlett 窗的权重为\n$$\nw_k = 1 - \\frac{k}{m+1}, \\quad k = 1,2,\\dots,m,\n$$\n窗估计量为\n$$\n\\hat{\\tau}_{\\mathrm{int}}^{(B)} = 1 + 2 \\sum_{k=1}^{m} w_k \\hat{\\rho}_k.\n$$\n\n在 $1/n$ 的主导阶上进行计算（即忽略 $1/n$ 及更小阶的项），将 $\\hat{\\rho}_k$ 的期望近似视为等于真实自相关 $\\rho_k$。对于一阶自回归，真实自相关满足 $\\rho_k = \\phi^k$。\n\n你的任务：\n- 对于测试套件中每个指定的参数集 $(n,\\phi,m)$，计算在所有整数滞后 $k$（$1 \\le k \\le 100$）下 $\\hat{\\rho}_k$ 的主导阶行为，即 $\\hat{\\rho}_k^{(\\mathrm{lead})} \\approx \\phi^k$。\n- 使用截断值 $m$ 的 Bartlett 窗，计算积分自相关时间的相应主导阶窗估计值，\n$$\n\\hat{\\tau}_{\\mathrm{int}}^{(B,\\mathrm{lead})} = 1 + 2 \\sum_{k=1}^{m} \\left(1 - \\frac{k}{m+1}\\right) \\phi^k.\n$$\n\n对于每个测试用例，返回一个紧凑的摘要，该摘要包含列表\n$$\n\\left[ \\hat{\\tau}_{\\mathrm{int}}^{(B,\\mathrm{lead})},\\ \\hat{\\rho}_1^{(\\mathrm{lead})},\\ \\hat{\\rho}_{50}^{(\\mathrm{lead})},\\ \\hat{\\rho}_{100}^{(\\mathrm{lead})} \\right],\n$$\n所有浮点值四舍五入到六位小数。\n\n测试套件（每个元组为 $(n,\\phi,m)$）：\n- $(10^5,\\, 0.95,\\, 200)$\n- $(10^5,\\, 0.0,\\, 200)$\n- $(10^5,\\, 0.5,\\, 200)$\n- $(10^5,\\, 0.999,\\, 200)$\n- $(10^5,\\, -0.5,\\, 200)$\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个含五个元素的列表，每个元素对应一个测试用例，并保持上述顺序。每个元素本身必须是按指定顺序排列的四个浮点数的列表。全部输出必须是单行形式\n$[\\text{case1},\\text{case2},\\text{case3},\\text{case4},\\text{case5}]$\n例如，其中 $\\text{case1} = [\\hat{\\tau}_{\\mathrm{int}}^{(B,\\mathrm{lead})},\\hat{\\rho}_1^{(\\mathrm{lead})},\\hat{\\rho}_{50}^{(\\mathrm{lead})},\\hat{\\rho}_{100}^{(\\mathrm{lead})}]$。",
            "solution": "用户提供的问题已经过严格验证，并被确定为一个有效、适定的科学问题。它在科学上基于时间序列分析和马尔可夫链蒙特卡洛（MCMC）方法的原理，其表述客观且自成体系。该问题要求基于标准、无争议的公式进行直接计算。\n\n问题核心是一个平稳的一阶自回归过程，记为 $AR(1)$，它由过程 $\\{X_t\\}$ 的递推关系 $X_t = \\phi X_{t-1} + \\varepsilon_t$ 定义。给定了平稳性条件 $|\\phi|  1$。对于此类过程，已知滞后 $k$ 的真实自相关函数为 $\\rho_k = \\phi^k$。\n\n问题的核心是计算积分自相关时间 $\\tau_{\\mathrm{int}}$ 的窗估计量。积分自相关时间是 MCMC 中的一个关键指标，因为它量化了获得一个有效独立样本所需的相关样本数量。它定义为\n$$\n\\tau_{\\mathrm{int}} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k.\n$$\n在实践中，$\\tau_{\\mathrm{int}}$ 必须从有限样本 $\\{X_t\\}_{t=1}^n$ 中估计。这涉及到用真实自相关 $\\rho_k$ 的样本估计 $\\hat{\\rho}_k$ 来替换它们。此外，使用窗函数对无穷和进行截断和削减，以减少估计量的方差。\n\n问题指定使用在滞后 $m$ 处截断的 Bartlett 窗。对应的权重为 $w_k = 1 - \\frac{k}{m+1}$，其中 $k=1, \\dots, m$。窗估计量为\n$$\n\\hat{\\tau}_{\\mathrm{int}}^{(B)} = 1 + 2 \\sum_{k=1}^{m} w_k \\hat{\\rho}_k.\n$$\n问题规定了一个关键的简化：我们要在“$1/n$ 的主导阶”上进行计算。这被明确定义为将样本自相关 $\\hat{\\rho}_k$ 视作与真实自相关 $\\rho_k$ 相等。对于给定的 $AR(1)$ 过程，这意味着我们进行替换 $\\hat{\\rho}_k \\to \\rho_k = \\phi^k$。提供参数 $n$ 是为了证明这种大样本近似的合理性，但它不进入最终计算。\n\n因此，需要计算的量是：\n1.  滞后 $k \\in \\{1, 50, 100\\}$ 处样本自相关的主导阶近似，它就是\n    $$\n    \\hat{\\rho}_k^{(\\mathrm{lead})} = \\phi^k.\n    $$\n2.  Bartlett 窗积分自相关时间的主导阶近似，由下式给出\n    $$\n    \\hat{\\tau}_{\\mathrm{int}}^{(B,\\mathrm{lead})} = 1 + 2 \\sum_{k=1}^{m} \\left(1 - \\frac{k}{m+1}\\right) \\phi^k.\n    $$\n$\\hat{\\tau}_{\\mathrm{int}}^{(B,\\mathrm{lead})}$ 的计算涉及一个有限和。对于由参数元组 $(n, \\phi, m)$ 指定的每个测试用例，我们将：\na.  计算 $\\phi^1$、$\\phi^{50}$ 和 $\\phi^{100}$。\nb.  通过从 $k=1$ 到 $m=200$ 迭代，数值计算和 $S = \\sum_{k=1}^{m} \\left(1 - \\frac{k}{m+1}\\right) \\phi^k$。\nc.  计算 $\\hat{\\tau}_{\\mathrm{int}}^{(B,\\mathrm{lead})} = 1 + 2S$。\nd.  将四个得到的浮点数（四舍五入到六位小数）组合成所需的列表格式。对所有五个测试用例重复此过程。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the leading-order Bartlett-windowed integrated autocorrelation time\n    and autocorrelations for a first-order autoregressive process for several\n    parameter sets.\n    \"\"\"\n    \n    # Test suite: each tuple is (n, phi, m)\n    # n is provided for context (large sample approximation) but not used in the calculation.\n    test_cases = [\n        (10**5, 0.95, 200),\n        (10**5, 0.0, 200),\n        (10**5, 0.5, 200),\n        (10**5, 0.999, 200),\n        (10**5, -0.5, 200)\n    ]\n\n    all_results_str = []\n    \n    for _, phi, m in test_cases:\n        # Calculate the leading-order approximations of rho_k = phi^k\n        # Use np.power for vectorized and precise calculation, though ** is equivalent.\n        rho_1_lead = np.power(phi, 1)\n        rho_50_lead = np.power(phi, 50)\n        rho_100_lead = np.power(phi, 100)\n\n        # Numerically compute the sum for the windowed integrated autocorrelation time\n        # tau_int = 1 + 2 * sum_{k=1 to m} (1 - k/(m+1)) * phi^k\n        total_sum = 0.0\n        m_plus_1 = float(m + 1)\n        \n        # Use a stable iterative approach for phi^k to avoid repeated large power calculations\n        # which can be slightly less efficient or accurate for very large k.\n        current_phi_k = phi\n        for k in range(1, m + 1):\n            weight = 1.0 - k / m_plus_1\n            # rho_k_lead is phi**k\n            rho_k_lead = current_phi_k\n            total_sum += weight * rho_k_lead\n            current_phi_k *= phi\n\n        tau_int_b_lead = 1.0 + 2.0 * total_sum\n\n        # Assemble the results for the current case\n        case_results = [\n            tau_int_b_lead,\n            rho_1_lead,\n            rho_50_lead,\n            rho_100_lead\n        ]\n        \n        # Format the list of numbers into the specified string format with 6 decimal places.\n        case_str = f\"[{','.join(f'{x:.6f}' for x in case_results)}]\"\n        all_results_str.append(case_str)\n\n    # Final print statement in the exact required format.\n    # The output is a string representation of a list of lists.\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在学会计算 $\\tau_{\\mathrm{int}}$ 之后，一个关键的实际问题随之而来：当我们处理充满噪声的、基于样本的自相关函数时，应如何处理其定义中的无限求和？本练习将挑战一种常见但有缺陷的启发式方法——在自相关函数首次穿过零点时进行截断。通过分析，你将理解为何该方法会导致有偏估计，并认识到使用诸如“滞后窗估计量”这类有原则的方法的必要性 。",
            "id": "3289812",
            "problem": "考虑一个由马尔可夫链蒙特卡洛 (MCMC) 算法生成的平稳、遍历的输出过程 $\\{X_t\\}_{t \\ge 0}$，该算法的目标是一个均值为 $\\mu = \\mathbb{E}[X_0]$ 的可积函数。设自协方差函数为 $\\gamma(k) = \\operatorname{Cov}(X_t, X_{t+k})$（滞后 $k$ 为整数），自相关函数 (ACF) 为 $\\rho(k) = \\gamma(k)/\\gamma(0)$。以常规方式定义样本均值 $\\bar{X}_n = \\frac{1}{n}\\sum_{t=1}^n X_t$、样本自协方差 $\\hat{\\gamma}(k)$ 和样本自相关 $\\hat{\\rho}(k)$。假设自协方差序列 $(\\gamma(k))_{k \\in \\mathbb{Z}}$ 是绝对可和的，并且在零频率处的谱密度存在且有限。\n\n一个与 $\\operatorname{Var}(\\bar{X}_n)$ 相关的长期方差的估计量通常采用样本自协方差求和的形式。一种常见的启发式截断方法是在第一个非正的样本ACF值处设置一个随机截断点：定义停止时间 $\\hat{\\ell} = \\inf\\{k \\ge 1 : \\hat{\\rho}(k) \\le 0\\}$，并构造估计量 $\\hat{\\sigma}^2_{\\mathrm{FZC}} = \\hat{\\gamma}(0) + 2\\sum_{k=1}^{\\hat{\\ell}-1} \\hat{\\gamma}(k)$，其中“FZC”代表“首次穿零” (first zero crossing)。从 $\\operatorname{Var}(\\bar{X}_n)$ 关于 $(\\gamma(k))$ 的协方差恒等式出发，运用第一性原理分析此停止规则对偏差的影响。然后，提出一个基于滞后窗估计量的有原则的替代方案，该方案能产生长期方差的一致估计，并明确说明在给定假设下确保一致性所需的窗函数及其带宽的条件。\n\n哪个选项正确地提供了一个基于原则的解释，说明为什么使用样本ACF的首次穿零点作为截断点会导致方差的低估，并指定了一个在适当条件下具有一致性的基于窗函数的估计量？\n\nA. 首次穿零规则导致低估，因为对于正相关链，真实的 $\\rho(k)$ 在许多滞后上保持为正，而由于有限样本效应，$\\hat{\\rho}(k)$ 在正滞后上存在噪声且具有系统性向下偏倚；因此，随机停止时间 $\\hat{\\ell}$ 是由噪声而非真实衰减驱动的，从而过早截断，产生一个负偏倚的自协方差之和。一个一致的替代方案是滞后窗（谱）估计量\n$$\n\\hat{\\sigma}^2_{\\mathrm{LW}} \\;=\\; \\hat{\\gamma}(0) \\;+\\; 2\\sum_{k=1}^{n-1} w\\!\\left(\\frac{k}{b_n}\\right)\\,\\hat{\\gamma}(k),\n$$\n其中 $w$ 是一个偶函数、有界窗函数，满足 $w(0)=1$ 且当 $|x|\\to\\infty$ 时 $w(x)\\to 0$（例如，Bartlett窗或平顶窗），并且带宽 $b_n$ 满足当 $n \\to \\infty$ 时 $b_n \\to \\infty$ 和 $b_n/n \\to 0$；在 $(\\gamma(k))$ 绝对可和的条件下，$\\hat{\\sigma}^2_{\\mathrm{LW}}$ 是一致的。\n\nB. 首次穿零规则是保守的，并倾向于高估方差，因为负相关在较大滞后时占主导地位；一个有原则的替代方案是固定带宽窗，取 $b_n=b$ 为常数和任意非负窗函数 $w$，当 $n\\to\\infty$ 时它是一致的。\n\nC. 首次穿零仅对可逆链导致低估；对于不可逆链，该效应消失。如果链是不可逆的，则窗估计量是不必要的，因为 $\\sum_{k\\ge 1}\\gamma(k)$ 因反对称性而消失。\n\nD. 首次穿零应被初始正序列规则取代，该规则仅在累积和保持非负时对 $\\hat{\\gamma}(k)$ 求和；这保证了无偏性，无需窗函数或带宽，并且对任何平稳输出过程都是一致的。\n\nE. 如果目标 $\\rho(k)$ 对 $k$ 是非增的，则首次穿零是无偏的；为保证一致性，使用满足 $w(0)=1$ 的窗函数 $w$ 和满足 $b_n/n \\to c \\in (0,1)$ 的带宽即可，这样有效项数与 $n$ 成比例增长。",
            "solution": "用户要求对马尔可夫链蒙特卡洛（MCMC）输出背景下的长期方差估计量进行严格分析，并评估一个提议的替代方案。\n\n### 问题验证\n\n**步骤1：提取给定条件**\n\n-   过程 $\\{X_t\\}_{t \\ge 0}$ 是一个MCMC算法生成的平稳遍历输出。\n-   目标函数是可积的，均值为 $\\mu = \\mathbb{E}[X_0]$。\n-   自协方差函数为 $\\gamma(k) = \\operatorname{Cov}(X_t, X_{t+k})$，其中 $k$ 为整数滞后。\n-   自相关函数 (ACF) 为 $\\rho(k) = \\gamma(k)/\\gamma(0)$。\n-   样本均值为 $\\bar{X}_n = \\frac{1}{n}\\sum_{t=1}^n X_t$。\n-   样本自协方差和自相关分别表示为 $\\hat{\\gamma}(k)$ 和 $\\hat{\\rho}(k)$。\n-   自协方差序列 $(\\gamma(k))_{k \\in \\mathbb{Z}}$ 是绝对可和的，即 $\\sum_{k=-\\infty}^{\\infty} |\\gamma(k)|  \\infty$。\n-   假定零频率处的谱密度 $S(0)$ 存在且有限。\n-   一个基于“首次穿零”（FZC）的估计量定义为 $\\hat{\\sigma}^2_{\\mathrm{FZC}} = \\hat{\\gamma}(0) + 2\\sum_{k=1}^{\\hat{\\ell}-1} \\hat{\\gamma}(k)$。\n-   该估计量的停止时间为 $\\hat{\\ell} = \\inf\\{k \\ge 1 : \\hat{\\rho}(k) \\le 0\\}$。\n-   任务是分析 $\\hat{\\sigma}^2_{\\mathrm{FZC}}$ 的偏差，并提出一个基于滞后窗的一致替代方案。\n\n**步骤2：使用提取的给定条件进行验证**\n\n-   **科学依据：** 该问题牢固地定位于时间序列分析的标准理论及其在MCMC输出分析中的应用。所有概念——平稳性、遍历性、自协方差、长期方差、谱密度和滞后窗估计量——都是该领域的基础。\n-   **适定性：** 该问题提供了标准假设（平稳性、遍历性、自协方差的绝对可和性），这些假设足以分析样本均值的渐近性质并建立方差估计量的一致性。问题定义明确，要求进行标准的理论分析。\n-   **客观性：** 问题以精确、客观和数学化的语言陈述。\n\n问题陈述没有显示出科学上不健全、不完整、矛盾或验证标准中列出的任何其他缺陷。它代表了计算统计学中一个标准的、尽管不平凡的问题。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。开始求解。\n\n### 推导与分析\n\n**1. 目标量：长期方差**\n\n估计的对象是样本均值的渐近方差，通常称为长期方差 $\\sigma^2$。对于一个平稳过程 $\\{X_t\\}$，样本均值 $\\bar{X}_n$ 的方差由下式给出：\n$$\n\\operatorname{Var}(\\bar{X}_n) = \\operatorname{Var}\\left(\\frac{1}{n}\\sum_{t=1}^n X_t\\right) = \\frac{1}{n^2}\\sum_{i=1}^n\\sum_{j=1}^n \\operatorname{Cov}(X_i, X_j)\n$$\n利用平稳性，$\\operatorname{Cov}(X_i, X_j) = \\gamma(j-i)$。双重求和可以重写为关于滞后 $k = j-i$ 的形式：\n$$\n\\operatorname{Var}(\\bar{X}_n) = \\frac{1}{n}\\sum_{k=-(n-1)}^{n-1} \\left(1-\\frac{|k|}{n}\\right)\\gamma(k)\n$$\n当样本量 $n \\to \\infty$ 时，相依过程的中心极限定理指出 $\\sqrt{n}(\\bar{X}_n - \\mu) \\to N(0, \\sigma^2)$，其中渐近方差 $\\sigma^2$ 为：\n$$\n\\sigma^2 = \\lim_{n\\to\\infty} n\\operatorname{Var}(\\bar{X}_n) = \\sum_{k=-\\infty}^{\\infty} \\gamma(k)\n$$\n由于对于实值过程，$\\gamma(k)$ 是一个偶函数（$\\gamma(k) = \\gamma(-k)$），这可以写成：\n$$\n\\sigma^2 = \\gamma(0) + 2\\sum_{k=1}^{\\infty} \\gamma(k)\n$$\n这就是我们希望估计的量。$(\\gamma(k))$ 绝对可和的条件确保了此和收敛且 $\\sigma^2$ 是有限的。\n\n**2. 首次穿零 (FZC) 估计量的分析**\n\nFZC估计量为 $\\hat{\\sigma}^2_{\\mathrm{FZC}} = \\hat{\\gamma}(0) + 2\\sum_{k=1}^{\\hat{\\ell}-1} \\hat{\\gamma}(k)$，其停止时间为 $\\hat{\\ell} = \\inf\\{k \\ge 1 : \\hat{\\rho}(k) \\le 0\\}$。\n\n该估计量的主要问题源于停止时间 $\\hat{\\ell}$ 是一个随机变量，它依赖于用于计算样本自协方差 $\\hat{\\gamma}(k)$ 的同一组数据。这会引入偏差。\n\n-   **MCMC输出的性质：** MCMC采样器通常被构建用于探索状态空间，其连续样本是正相关的。这意味着对于一个混合良好的链，真实的自相关函数 $\\rho(k)$ 在小的滞后 $k$ 上是正的且单调递减，当 $k \\to \\infty$ 时趋近于0。因此，$\\sigma^2$ 求和式中的项 $\\gamma(k)$ 在许多初始滞后上通常是正的。\n\n-   **样本ACF $\\hat{\\rho}(k)$ 的行为：** 样本ACF $\\hat{\\rho}(k)$ 是 $\\rho(k)$ 的一个带噪声的估计量。对于 $\\rho(k) \\approx 0$ 的大滞后 $k$，估计量 $\\hat{\\rho}(k)$ 的方差约为 $1/n$（在某些混合条件下，通过Bartlett公式）。这意味着即使真实的 $\\rho(k)$ 很小但为正，其样本对应物 $\\hat{\\rho}(k)$ 也会在这个小的正值附近波动。由于这种抽样变异性，$\\hat{\\rho}(k)$ 很有可能仅仅因为随机噪声，就在一个相对较小的 $k$ 值处跌至零以下。\n\n-   **过早截断导致的偏差：** FZC规则在$\\hat{\\rho}(k)$为非正的*第一个*滞后 $\\hat{\\ell}$ 处截断求和。由于噪声的存在，这很可能比真实 $\\rho(k)$ 衰减到可忽略值的滞后点要早得多。由于被截断的项 $\\gamma(k)$ 大多是正的，这种过早截断导致对和 $\\sum_{k=1}^{\\infty} \\gamma(k)$ 的系统性**低估**。因此，估计量 $\\hat{\\sigma}^2_{\\mathrm{FZC}}$ 是负偏倚的。停止时间 $\\hat{\\ell}$ 是由统计噪声决定的，而不是由信号（ACF的真实衰减）决定的。\n\n-   **$\\hat{\\gamma}(k)$ 中的偏差：** 此外，使用 $\\bar{X}_n$ 而非真实均值 $\\mu$ 的标准样本自协方差估计量本身就存在负偏差，即 $\\mathbb{E}[\\hat{\\gamma}(k)]  \\gamma(k)$。这为总估计量增加了另一个负偏差的来源。\n\n总之，FZC启发式方法存在根本性缺陷，因为其依赖数据的截断边界是由噪声驱动的，这导致对MCMC典型的正相关过程的长期方差产生系统性低估。\n\n**3. 有原则的替代方案：滞后窗估计量**\n\n一种估计 $\\sigma^2 = \\sum_{k=-\\infty}^{\\infty} \\gamma(k)$ 的有原则的方法是使用样本自协方差的加权和，这被称为滞后窗或谱密度估计量。其一般形式为：\n$$\n\\hat{\\sigma}^2_{\\mathrm{LW}} = \\sum_{k=-(n-1)}^{n-1} w_n(k) \\hat{\\gamma}(k)\n$$\n权重 $w_n(k)$ 的选择是为了平滑地降低大滞后 $k$ 处 $\\hat{\\gamma}(k)$ 的贡献，因为在这些滞后处估计值噪声大且不可靠。一种常见且实用的权重公式是 $w_n(k) = w(k/b_n)$，其中 $w$ 是一个核函数或窗函数，$b_n$ 是一个带宽参数。由此，并利用 $\\hat{\\gamma}(k)$ 和通常的 $w(\\cdot)$ 的偶函数性质，估计量变为：\n$$\n\\hat{\\sigma}^2_{\\mathrm{LW}} = \\hat{\\gamma}(0) + 2\\sum_{k=1}^{n-1} w\\left(\\frac{k}{b_n}\\right)\\hat{\\gamma}(k)\n$$\n为使该估计量具有一致性，即当 $n \\to \\infty$ 时 $\\hat{\\sigma}^2_{\\mathrm{LW}} \\xrightarrow{p} \\sigma^2$，我们必须平衡其偏差和方差。\n\n-   **偏差控制：** 偏差源于加窗操作，该操作实际上截断或抑制了求和。为使偏差在 $n \\to \\infty$ 时消失，估计量必须包含越来越多滞后的信息。这通过让带宽随样本量增长来实现，即 $b_n \\to \\infty$。这确保了对于任何固定的滞后 $k$，权重 $w(k/b_n) \\to w(0) = 1$，因此没有项在渐近意义下被降权。\n\n-   **方差控制：** $\\hat{\\sigma}^2_{\\mathrm{LW}}$ 的方差源于 $\\hat{\\gamma}(k)$ 项的方差。求和中不可忽略的项数大致为 $b_n$ 的量级。估计量的方差近似与 $b_n/n$ 成正比。为使方差在 $n \\to \\infty$ 时消失，我们要求 $b_n/n \\to 0$。\n\n因此，在给定 $(\\gamma(k))$ 绝对可和的假设下，$\\hat{\\sigma}^2_{\\mathrm{LW}}$ 保持一致性的条件是：\n1.  窗函数 $w(\\cdot)$ 是一个有界的偶函数，在0点连续且 $w(0)=1$。例子包括Bartlett（三角）窗，$w(x) = (1-|x|)\\mathbf{1}_{|x|\\le 1}$，以及其他各种“平顶”或锥形窗。\n2.  带宽序列 $b_n$ 满足当 $n \\to \\infty$ 时 $b_n \\to \\infty$ 和 $b_n/n \\to 0$。\n\n### 选项评估\n\n**A.** 该选项正确地指出，FZC规则导致低估，因为带噪声的样本ACF $\\hat{\\rho}(k)$ 过早地截断了求和，导致了负偏倚的结果。它还提到了 $\\hat{\\rho}(k)$（和 $\\hat{\\gamma}(k)$）的系统性向下偏倚。然后，它正确地给出了滞后窗估计量 $\\hat{\\sigma}^2_{\\mathrm{LW}} = \\hat{\\gamma}(0) + 2\\sum_{k=1}^{n-1} w(k/b_n)\\hat{\\gamma}(k)$。最后，它给出了在 $\\gamma(k)$ 绝对可和的条件下，保证一致性所需的窗函数 $w$（偶函数、有界、$w(0)=1$）和带宽 $b_n$（$b_n \\to \\infty$ 和 $b_n/n \\to 0$）的正确条件。这与推导完全一致。\n**结论：正确**\n\n**B.** 该选项声称FZC规则导致*高估*，这与对正相关链的既定分析相反。它还错误地提出，一个*固定*带宽 $b_n=b$ 足以保证一致性。固定带宽会导致一个渐近有偏的估计量。\n**结论：错误**\n\n**C.** 该选项错误地将偏差问题与可逆性联系起来。由噪声引起的过早截断问题对于正相关链是普遍存在的，无论其是否可逆。关于对于不可逆链 $\\sum_{k\\ge 1}\\gamma(k)$ 因反对称性而消失的说法是错误的。对于单个实值平稳过程 $X_t$，自协方差函数 $\\gamma(k) = \\operatorname{Cov}(X_t, X_{t+k})$ 始终是一个偶函数，$\\gamma(k) = \\gamma(-k)$。不存在反对称性。\n**结论：错误**\n\n**D.** 该选项提出了另一个临时的、依赖于数据的截断规则（“初始正序列”）。然后它做出了一个强烈且不正确的声明，即该规则“保证无偏性”和一致性。任何此类依赖于数据的停止规则都会有偏差，并且通常不具有一致性。一致性要求所包含的滞后项数量以确定性的、精心控制的方式增长，正如滞后窗方法所提供的那样。\n**结论：错误**\n\n**E.** 该选项错误地声称如果 $\\rho(k)$ 是非增的，FZC估计量就是无偏的。虽然这个条件很典型，但偏差源于*估计量* $\\hat{\\rho}(k)$ 中的噪声，而不是真实 $\\rho(k)$ 的形状。关于带宽一致性条件 $b_n/n \\to c \\in (0,1)$ 的说法也是错误的。正确的条件是 $b_n/n \\to 0$，以确保估计量的方差消失。\n**结论：错误**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在通用滞后窗估计量的基础上，有时我们可以通过利用 MCMC 采样器的特定理论性质来设计出更优的方法。本练习介绍了一种巧妙的初始正序列（IPS）估计量，它利用了可逆性这一性质来构造一个保证为非负的方差估计。这个例子展示了 MCMC 理论与统计实践之间强大的相互作用 。",
            "id": "3289815",
            "problem": "考虑一个平稳遍历的马尔可夫链 $\\{X_t\\}_{t \\ge 0}$，其函数 $g$ 平方可积，并定义中心化过程 $Y_t = g(X_t) - \\mathbb{E}[g(X_0)]$。自协方差函数为 $\\gamma_k = \\mathrm{Cov}(Y_0, Y_k)$，在频率 $\\omega$ 处的谱密度为 $s(\\omega) = \\sum_{k=-\\infty}^{\\infty} \\gamma_k e^{-i \\omega k}$，因此 $s(0) = \\gamma_0 + 2 \\sum_{k=1}^{\\infty} \\gamma_k$。在马尔可夫链蒙特卡洛（MCMC）中，$s(0)$ 决定了样本均值的渐近方差，一个实用的估计量应遵守自协方差序列的正定性所蕴含的基本约束 $s(0) \\ge 0$。\n\n令 $\\hat{\\gamma}_k$ 表示滞后为 $k$ 的通常样本自协方差估计量，并定义配对和\n$$\n\\Gamma_k \\equiv \\hat{\\gamma}_{2k} + \\hat{\\gamma}_{2k+1}, \\quad k \\ge 0.\n$$\n假设该链是可逆的，因此转移算子在 $L^2(\\pi)$ 中是自伴的，其中 $\\pi$ 是平稳分布。\n\n哪个选项正确地定义了一个基于 $\\{\\Gamma_k\\}$ 的 $s(0)$ 的初始正序列估计量，并为在最大索引 $m$ (使得 $\\Gamma_0, \\ldots, \\Gamma_m  0$) 处截断求和以确保非负估计提供了原则性论证？\n\nA. 定义 $m$ 为满足 $\\Gamma_0, \\ldots, \\Gamma_m  0$ 的最大索引。设估计量为\n$$\n\\hat{s}_{\\mathrm{IPS}}(0) = \\Gamma_0 + 2 \\sum_{k=1}^{m} \\Gamma_k.\n$$\n该估计量是非负项之和，因此 $\\hat{s}_{\\mathrm{IPS}}(0) \\ge 0$。在可逆性条件下，谱表示 $\\rho_k = \\int_{-1}^{1} \\lambda^k \\, d\\Psi(\\lambda)$（其中 $d\\Psi$ 是一个有限正测度）意味着真实的配对和满足 $\\gamma_{2k} + \\gamma_{2k+1} = \\gamma_0 \\int_{-1}^{1} \\lambda^{2k} (1+\\lambda) \\, d\\Psi(\\lambda) \\ge 0$ 且随 $k$ 非增，因此在最后一个正的 $\\Gamma_k$ 处截断，会舍弃最可能被抽样噪声污染的项，同时保留零频率非负性约束。\n\nB. 使用 $\\{\\Gamma_k\\}$ 将 $m$ 定义为满足 $\\Gamma_0, \\ldots, \\Gamma_m  0$ 的最大索引，但设\n$$\n\\hat{s}(0) = \\hat{\\gamma}_0 + 2 \\sum_{k=1}^{m} \\hat{\\gamma}_k.\n$$\n这保留了直到 $m$ 的所有滞后项，并赋予正权重，因此保证了 $\\hat{s}(0) \\ge 0$，因为权重是非负的。\n\nC. 定义 $\\Gamma_k$ 为 $\\Gamma_k = \\hat{\\gamma}_{2k} - \\hat{\\gamma}_{2k+1}$，并选择 $m$ 为满足 $\\Gamma_0, \\ldots, \\Gamma_m  0$ 的最大索引。设\n$$\n\\hat{s}(0) = \\Gamma_0 + 2 \\sum_{k=1}^{m} \\Gamma_k.\n$$\n由于根据构造 $\\Gamma_k$ 是正的，这保证了 $\\hat{s}(0) \\ge 0$，并且其合理性在于可逆性意味着差值 $\\gamma_{2k} - \\gamma_{2k+1}$ 是非增和非负的。\n\nD. 定义 $m$ 为满足 $\\Gamma_m \\le 0$ 的最小索引，并设\n$$\n\\hat{s}(0) = 2 \\sum_{k=0}^{m} \\Gamma_k - \\hat{\\gamma}_0.\n$$\n这等于 $\\gamma_0 + 2 \\sum_{k=1}^{\\infty} \\gamma_k$ 的一个截断版本，并保证是非负的，因为在达到 $m$ 之前，每个 $\\Gamma_k$ 都是正的。",
            "solution": "我们从与平稳可逆马尔可夫链以及MCMC谱估计相关的基本原理开始。\n\n1. 基本定义：\n- 自协方差函数为 $\\gamma_k = \\mathrm{Cov}(Y_0, Y_k)$，其中 $k \\in \\mathbb{Z}$。\n- 谱密度为 $s(\\omega) = \\sum_{k=-\\infty}^{\\infty} \\gamma_k e^{-i \\omega k}$，因此 $s(0) = \\gamma_0 + 2 \\sum_{k=1}^{\\infty} \\gamma_k$。\n- 协方差函数的正定性意味着对所有 $\\omega$ 都有 $s(\\omega) \\ge 0$，特别是 $s(0) \\ge 0$。\n\n2. 可逆性与谱表示：\n在可逆性条件下，转移算子在 $L^2(\\pi)$ 上是自伴的，并且在 $[-1,1]$ 上存在一个有限正测度 $\\Psi$，使得自相关函数有如下表示\n$$\n\\rho_k \\equiv \\frac{\\gamma_k}{\\gamma_0} = \\int_{-1}^{1} \\lambda^k \\, d\\Psi(\\lambda), \\quad k \\ge 0.\n$$\n因此，\n$$\n\\gamma_{2k} + \\gamma_{2k+1} = \\gamma_0 \\int_{-1}^{1} \\lambda^{2k} (1 + \\lambda) \\, d\\Psi(\\lambda).\n$$\n因为 $d\\Psi$ 是一个正测度，$\\lambda^{2k} \\ge 0$，并且对于 $\\lambda \\in [-1,1]$ 有 $1+\\lambda \\ge 0$，所以真实的配对和是非负的：\n$$\n\\gamma_{2k} + \\gamma_{2k+1} \\ge 0,\n$$\n并且随 $k$ 非增，因为当 $|\\lambda|1$ 时 $\\lambda^{2k}$ 随 $k$ 递减，边界情况由测度处理。这种结构启发我们构造配对和，并在其样本估计值不再为正时进行截断。\n\n3. 样本估计量与初始正序列：\n令 $\\hat{\\gamma}_k$ 表示样本自协方差。定义\n$$\n\\Gamma_k = \\hat{\\gamma}_{2k} + \\hat{\\gamma}_{2k+1}, \\quad k \\ge 0.\n$$\n抽样变异性会使大滞后项的估计 $\\hat{\\gamma}_k$ 不可靠，并可能对 $s(0)$ 产生虚假的负贡献。初始正序列 (IPS) 方法选择\n$$\nm = \\max \\{ k \\ge 0 : \\Gamma_j  0 \\text{ for all } j \\in \\{0,1,\\ldots,k\\} \\}.\n$$\n这种截断是符合原则的，因为它反映了配对和 $\\gamma_{2k} + \\gamma_{2k+1}$ 是非负且非增的真实属性，并且它防止了包含可能与 $s(0)$ 所要求的非负性相冲突的噪声负项。\n\n4. 构造 $s(0)$ 的非负估计量：\n考虑估计量\n$$\n\\hat{s}_{\\mathrm{IPS}}(0) = \\Gamma_0 + 2 \\sum_{k=1}^{m} \\Gamma_k.\n$$\n将各项写出可得\n$$\n\\hat{s}_{\\mathrm{IPS}}(0) = (\\hat{\\gamma}_0 + \\hat{\\gamma}_1) + 2 \\sum_{k=1}^{m} \\left( \\hat{\\gamma}_{2k} + \\hat{\\gamma}_{2k+1} \\right)\n= \\hat{\\gamma}_0 + \\hat{\\gamma}_1 + 2 \\sum_{j=2}^{2m+1} \\hat{\\gamma}_j,\n$$\n因此所有包含的贡献项都有非负系数，并且根据构造，对于 $k \\le m$ 的每个 $\\Gamma_k$ 都是严格为正的。因此 $\\hat{s}_{\\mathrm{IPS}}(0) \\ge 0$。此外，在满足 $\\Gamma_0, \\ldots, \\Gamma_m  0$ 的最大 $m$ 处截断的理由是，它只保留了那些与可逆链的谱表示 $\\int \\lambda^{2k} (1+\\lambda) \\, d\\Psi(\\lambda)$ 一致的配对贡献，舍弃了那些抽样噪声可能违反真实序列固有的非负性和单调性的项。\n\n我们现在分析每个选项。\n\n选项 A:\n- 定义：$m$ 是满足 $\\Gamma_0, \\ldots, \\Gamma_m  0$ 的最大索引，且 $\\hat{s}_{\\mathrm{IPS}}(0) = \\Gamma_0 + 2 \\sum_{k=1}^{m} \\Gamma_k$。\n- 理由：在可逆性条件下，根据谱表示 $\\gamma_{2k} + \\gamma_{2k+1} = \\gamma_0 \\int \\lambda^{2k} (1+\\lambda) \\, d\\Psi(\\lambda)$，真实的配对和是非负且非增的。在最后一个正的样本 $\\Gamma_k$ 处截断，强制实施了这些结构特性，并确保估计量是非负项之和，因此 $\\hat{s}_{\\mathrm{IPS}}(0) \\ge 0$。\n- 结论：正确。\n\n选项 B:\n- 定义：使用基于 $\\{\\Gamma_k\\}$ 的相同 $m$，但定义 $\\hat{s}(0) = \\hat{\\gamma}_0 + 2 \\sum_{k=1}^{m} \\hat{\\gamma}_k$。\n- 声称的理由：由于权重为正，所以结果非负。\n- 问题：尽管权重为正，但对于 $k \\ge 1$ 的 $\\hat{\\gamma}_k$ 可能由于抽样噪声或真实的负自协方差而为负；因此和 $\\hat{\\gamma}_0 + 2 \\sum_{k=1}^{m} \\hat{\\gamma}_k$ 可能为负。该构造没有利用配对和 $\\Gamma_k$ 的正性，也无法保证 $\\hat{s}(0) \\ge 0$。\n- 结论：不正确。\n\n选项 C:\n- 定义：$\\Gamma_k = \\hat{\\gamma}_{2k} - \\hat{\\gamma}_{2k+1}$，在满足 $\\Gamma_k  0$ 的最大 $m$ 处截断，并设 $\\hat{s}(0) = \\Gamma_0 + 2 \\sum_{k=1}^{m} \\Gamma_k$。\n- 问题：可逆性下的谱表示涉及 $(1+\\lambda)$，而不是 $(1-\\lambda)$，所以 $\\gamma_{2k} - \\gamma_{2k+1}$ 不必是非负或非增的；实际上，$(1-\\lambda)$ 可能很小或在 $[-1,1]$ 上导致符号变化。因此，构造差值破坏了配对和的结构正性和单调性，并且不能证明估计量的非负性。\n- 结论：不正确。\n\n选项 D:\n- 定义：$m$ 是满足 $\\Gamma_m \\le 0$ 的最小索引，且 $\\hat{s}(0) = 2 \\sum_{k=0}^{m} \\Gamma_k - \\hat{\\gamma}_0$。\n- 问题：尽管 $2 \\sum_{k=0}^{m} \\Gamma_k$ 聚合了直到 $m$ 的正配对和，但减去 $\\hat{\\gamma}_0$ 在 $m$ 很小时可能产生负结果——例如，当 $\\hat{\\gamma}_1$ 足够负时，即使 $\\Gamma_0  0$，$2 \\Gamma_0 - \\hat{\\gamma}_0 = \\hat{\\gamma}_0 + 2 \\hat{\\gamma}_1$ 也可能为负。因此，声称的非负性保证不成立。此外，选择 $m$ 为满足 $\\Gamma_m \\le 0$ 的最小索引等价于满足 $\\Gamma_0, \\ldots, \\Gamma_m  0$ 的最大索引，但这里的估计量形式不能确保非负性。\n- 结论：不正确。\n\n因此，唯一一个正确定义了基于 $\\{\\Gamma_k\\}$ 的 $s(0)$ 的 IPS 估计量，并提供了截断确保非负估计的有效理由的选项是选项 A。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}