{
    "hands_on_practices": [
        {
            "introduction": "随机过程的研究常常始于理解其基本构建模块。指数分布是模拟连续时间中事件等待时间的核心，例如放射性衰变或顾客到达服务台的间隔。本练习将通过一个具体实例，引导你从第一性原理出发，推导指数分布的关键特性，包括其归一化常数、期望和方差，为后续理解泊松过程等更复杂的随机模型奠定坚实的数学基础。",
            "id": "3314043",
            "problem": "考虑一个在随机模拟中常用的连续时间跨度模型，其中非负随机变量 $X$ 代表事件之间的等待时间。假设 $X$ 的概率密度函数 (PDF) $f(x)$ 在 $[0,\\infty)$ 上有定义，其形式为 $f(x)=c\\exp(-x)$ (当 $x\\geq 0$ 时)。请确定使 $f$ 成为有效概率密度函数的归一化常数 $c$，然后使用适用于随机过程、随机模拟和蒙特卡洛方法入门背景下的第一性原理定义，计算期望 $\\mathbb{E}[X]$ 和方差 $\\operatorname{Var}(X)$。最终结果请以精确值表示，无需四舍五入。",
            "solution": "题目陈述需要经过验证。\n\n### 第 1 步：提取已知条件\n- 随机变量 $X$ 代表连续时间跨度模型中事件之间的等待时间。\n- $X$ 是一个非负随机变量。\n- $X$ 的概率密度函数 (PDF) 的支撑集是 $[0,\\infty)$。\n- PDF 的形式为 $f(x)=c\\exp(-x)$ (当 $x \\geq 0$ 时)，其中 $c$ 是一个常数。\n- 任务是确定归一化常数 $c$、期望 $\\mathbb{E}[X]$ 和方差 $\\operatorname{Var}(X)$。\n- 背景是随机过程入门。\n- 最终结果必须是精确值。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它描述了指数分布，其速率参数未指定（将被确定），这是随机过程的基石，尤其是在模拟泊松过程中的到达时间方面。该表述是概率论中一个标准的、基础的练习。所有必要信息均已提供，不存在内部矛盾，语言精确，且该问题有唯一、可验证的数学解。\n\n### 第 3 步：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n分析过程首先确定归一化常数 $c$，然后使用得到的有效 PDF，根据其第一性原理定义计算期望和方差。\n\n**1. 确定归一化常数 $c$**\n\n要使 $f(x)$ 成为一个有效的概率密度函数，其在整个支撑集上的积分必须等于 $1$。已知 $X$ 的支撑集为 $[0, \\infty)$。因此，我们必须满足以下条件：\n$$ \\int_{0}^{\\infty} f(x) \\, dx = 1 $$\n代入给定的 $f(x)=c\\exp(-x)$ 形式：\n$$ \\int_{0}^{\\infty} c\\exp(-x) \\, dx = 1 $$\n常数 $c$ 可以从积分中提出：\n$$ c \\int_{0}^{\\infty} \\exp(-x) \\, dx = 1 $$\n我们计算这个定积分：\n$$ \\int_{0}^{\\infty} \\exp(-x) \\, dx = \\left[-\\exp(-x)\\right]_{0}^{\\infty} = \\left(-\\lim_{b \\to \\infty} \\exp(-b)\\right) - (-\\exp(-0)) = (0) - (-1) = 1 $$\n将此结果代回归一化方程：\n$$ c \\cdot 1 = 1 $$\n这得出了归一化常数的值：\n$$ c = 1 $$\n因此，随机变量 $X$ 的有效 PDF 是 $f(x) = \\exp(-x)$ (当 $x \\ge 0$ 时)。这是一个速率参数 $\\lambda=1$ 的指数分布的 PDF。\n\n**2. 计算期望 $\\mathbb{E}[X]$**\n\n对于支撑集为 $[0, \\infty)$、PDF 为 $f(x)$ 的连续随机变量 $X$，其期望（或均值）定义为：\n$$ \\mathbb{E}[X] = \\int_{0}^{\\infty} x f(x) \\, dx $$\n代入已验证的 PDF $f(x) = \\exp(-x)$：\n$$ \\mathbb{E}[X] = \\int_{0}^{\\infty} x \\exp(-x) \\, dx $$\n这个积分可以使用分部积分法求解，其中 $\\int u \\, dv = uv - \\int v \\, du$。令 $u = x$ 且 $dv = \\exp(-x) \\, dx$。这意味着 $du = dx$ 且 $v = -\\exp(-x)$。\n$$ \\mathbb{E}[X] = \\left[x(-\\exp(-x))\\right]_{0}^{\\infty} - \\int_{0}^{\\infty} (-\\exp(-x)) \\, dx $$\n第一项在极限处求值：\n$$ \\left[-x\\exp(-x)\\right]_{0}^{\\infty} = \\left(-\\lim_{b \\to \\infty} b\\exp(-b)\\right) - (-0 \\cdot \\exp(-0)) $$\n极限 $\\lim_{b \\to \\infty} b\\exp(-b)$ 是一个 $\\infty \\cdot 0$ 的不定式。将其重写为 $\\lim_{b \\to \\infty} \\frac{b}{\\exp(b)}$ 得到 $\\frac{\\infty}{\\infty}$ 形式，可以应用洛必达法则 (L'Hôpital's rule)：$\\lim_{b \\to \\infty} \\frac{1}{\\exp(b)} = 0$。因此，第一项的计算结果为 $0 - 0 = 0$。\n第二项变为：\n$$ \\int_{0}^{\\infty} \\exp(-x) \\, dx $$\n如在归一化过程中所确定的，该积分等于 $1$。\n合并各项，期望为：\n$$ \\mathbb{E}[X] = 0 - (-1) = 1 $$\n\n**3. 计算方差 $\\operatorname{Var}(X)$**\n\n随机变量 $X$ 的方差定义为 $\\operatorname{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2$。我们已经求得 $\\mathbb{E}[X]=1$。现在需要计算二阶矩 $\\mathbb{E}[X^2]$。\n$$ \\mathbb{E}[X^2] = \\int_{0}^{\\infty} x^2 f(x) \\, dx = \\int_{0}^{\\infty} x^2 \\exp(-x) \\, dx $$\n我们再次使用分部积分法。令 $u = x^2$ 且 $dv = \\exp(-x) \\, dx$。这意味着 $du = 2x \\, dx$ 且 $v = -\\exp(-x)$。\n$$ \\mathbb{E}[X^2] = \\left[x^2(-\\exp(-x))\\right]_{0}^{\\infty} - \\int_{0}^{\\infty} (-\\exp(-x))(2x) \\, dx $$\n第一项 $\\left[-x^2\\exp(-x)\\right]_{0}^{\\infty}$，通过两次类似地应用洛必达法则 (L'Hôpital's rule)，其值为 $0$。\n积分项简化为：\n$$ 2 \\int_{0}^{\\infty} x \\exp(-x) \\, dx $$\n我们认出积分 $\\int_{0}^{\\infty} x \\exp(-x) \\, dx$ 即为 $\\mathbb{E}[X]$ 的定义，我们已计算出其值为 $1$。\n因此，二阶矩为：\n$$ \\mathbb{E}[X^2] = 0 - (-2 \\cdot 1) = 2 $$\n最后，我们使用其定义计算方差：\n$$ \\operatorname{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = 2 - (1)^2 = 2 - 1 = 1 $$\n\n所求的量为归一化常数 $c$、期望 $\\mathbb{E}[X]$ 和方差 $\\operatorname{Var}(X)$。最终答案将以一个行矩阵的形式呈现，按此顺序包含这三个值。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  1  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从静态的随机变量转向动态的演化过程，马尔可夫链为我们提供了一个强大的框架来模拟无记忆性的状态转移。本练习聚焦于一个离散时间马尔可夫链，通过运用线性代数中的谱分解理论，你将能够精确地推导出系统在任意$n$步后的状态分布。这不仅是一个计算练习，更是一次深入理解马尔可夫链动态演化及其趋向稳态分布背后数学原理的实践。",
            "id": "3314063",
            "problem": "考虑一个在有限状态空间 $\\{1,2,3\\}$ 上的时间齐次离散时间马尔可夫链，它在蒙特卡洛（MC）过程中用作混合核。其转移机制由 $3 \\times 3$ 的转移矩阵 $P$ 定义，其元素满足：对于所有 $i \\in \\{1,2,3\\}$，$P_{ii} = \\frac{5}{9}$；对于所有 $i \\neq j$，$P_{ij} = \\frac{2}{9}$。设初始分布为行向量 $\\mu = \\left(\\frac{1}{2}, \\frac{1}{4}, \\frac{1}{4}\\right)$。\n\n仅从核心定义（即 $n$ 步法则是 $\\mu P^{n}$）以及随机矩阵的基本线性代数性质出发，推导出 $P^{n}$ 和 $n$ 步分布 $\\mu P^{n}$ 的精确闭式表达式，并根据这些原则论证每一步。然后，明确确定从给定的初始分布 $\\mu$ 出发，经过 $n$ 步后链处于状态 $2$ 的概率。\n\n请以关于 $n$ 的单一闭式解析表达式给出经过 $n$ 步后处于状态 $2$ 的最终概率。不要近似；无需四舍五入。",
            "solution": "该问题提法恰当，且在随机过程理论中有坚实的科学基础。它提供了一套完整且一致的给定条件，从而可以得到一个唯一且有意义的解。因此，我们可以进行推导。\n\n该离散时间马尔可夫链的状态空间为 $S = \\{1, 2, 3\\}$。转移矩阵 $P$ 由其元素 $P_{ii} = \\frac{5}{9}$ 和 $P_{ij} = \\frac{2}{9}$（当 $i \\neq j$ 时）给出。该矩阵明确表示为：\n$$ P = \\begin{pmatrix} 5/9  2/9  2/9 \\\\ 2/9  5/9  2/9 \\\\ 2/9  2/9  5/9 \\end{pmatrix} $$\n初始概率分布为行向量 $\\mu = \\left(\\frac{1}{2}, \\frac{1}{4}, \\frac{1}{4}\\right)$。我们的任务是找到 $P^n$ 和 $n$ 步分布 $\\mu P^n$ 的精确闭式表达式，并由此求出经过 $n$ 步后链处于状态 $2$ 的概率。推导将基于基本的线性代数性质。\n\n矩阵 $P$ 是一个实对称矩阵。线性代数中的一个基本结果，即谱定理，指出任何实对称矩阵都可以通过其特征向量的一组标准正交基进行对角化。这个性质使得矩阵的幂 $P^n$ 的计算变得直接。\n\n首先，我们求出 $P$ 的特征值和特征向量。\n矩阵 $P$可以写成单位矩阵 $I$ 和全一矩阵 $J$ 的线性组合：\n$$ P = \\frac{1}{3}I + \\frac{2}{9}J $$\n其中 $I = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$ 且 $J = \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix}$。\n$J$ 的特征值是众所周知的。由于 $J$ 的秩为 $1$，其零空间的维度为 $3-1 = 2$。零空间中的任何向量 $\\mathbf{v}$ 都满足 $J\\mathbf{v} = 0\\mathbf{v}$，因此 $\\lambda=0$ 是一个几何重数为 $2$ 的特征值。向量 $\\mathbf{1} = (1, 1, 1)^T$ 是一个特征向量，其特征值为 $3$，因为 $J\\mathbf{1} = (3, 3, 3)^T = 3 \\cdot \\mathbf{1}$。\n$P = aI + bJ$ 的特征值为 $a + b\\lambda_J$，其中 $\\lambda_J$ 是 $J$ 的特征值。因此，$P$ 的特征值为：\n$\\lambda_1 = \\frac{1}{3} + \\frac{2}{9}(3) = \\frac{1}{3} + \\frac{2}{3} = 1$。\n$\\lambda_{2,3} = \\frac{1}{3} + \\frac{2}{9}(0) = \\frac{1}{3}$。\n所以，$P$ 的特征值为 $1$（重数为 $1$）和 $\\frac{1}{3}$（重数为 $2$）。\n\n对应于 $\\lambda_1=1$ 的特征空间由特征向量 $\\mathbf{v}_1 = (1, 1, 1)^T$ 张成。相应的归一化左特征向量是平稳分布 $\\pi$。由于 $P$ 是对称的，它也是双随机的，因此平稳分布是均匀分布：$\\pi = (\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$。\n对应于 $\\lambda_2 = \\frac{1}{3}$ 的特征空间是 $P - \\frac{1}{3}I = \\frac{2}{9}J$ 的零空间。这是所有满足 $x_1+x_2+x_3=0$ 的向量 $\\mathbf{x} = (x_1, x_2, x_3)^T$ 的集合。这个二维空间是对应于 $\\lambda_1=1$ 的特征空间的正交补。\n\n使用谱分解，$P$可以表示为 $P = \\sum_{k=1}^3 \\lambda_k \\mathbf{u}_k \\mathbf{u}_k^T$，其中 $\\{\\mathbf{u}_k\\}$ 是一组标准正交的特征向量基。然后我们可以求得 $P^n$ 为：\n$$ P^n = \\lambda_1^n \\mathbf{u}_1 \\mathbf{u}_1^T + \\lambda_2^n \\mathbf{u}_2 \\mathbf{u}_2^T + \\lambda_3^n \\mathbf{u}_3 \\mathbf{u}_3^T $$\n令 $\\Pi = \\mathbf{u}_1 \\mathbf{u}_1^T$ 为到特征值 $\\lambda_1=1$ 对应特征空间上的投影矩阵。由于 $\\mathbf{u}_1 = \\frac{1}{\\sqrt{3}}(1, 1, 1)^T$，我们有 $\\Pi = \\frac{1}{3}J$。到特征值 $\\lambda_2 = \\lambda_3 = \\frac{1}{3}$ 对应的正交特征空间上的投影算子之和为 $I - \\Pi = I - \\frac{1}{3}J$。\n$$ P^n = 1^n \\Pi + (\\frac{1}{3})^n (I - \\Pi) = \\Pi + (\\frac{1}{3})^n (I - \\Pi) $$\n代入 $\\Pi = \\frac{1}{3}J$：\n$$ P^n = \\frac{1}{3}J + (\\frac{1}{3})^n (I - \\frac{1}{3}J) = (\\frac{1}{3})^n I + \\left(\\frac{1}{3} - \\frac{1}{3}(\\frac{1}{3})^n\\right)J = (\\frac{1}{3})^n I + \\frac{1}{3}(1 - (\\frac{1}{3})^n)J $$\n这就是 $P^n$ 的闭式表达式。\n\n接下来，我们求 $n$ 步分布 $\\mu^{(n)} = \\mu P^n$。我们可以利用相同的特征分解。初始分布 $\\mu$可以分解为一个沿着平稳分布 $\\pi$ 的分量和一个在正交空间（即特征值 $\\lambda=1/3$ 对应的特征空间）中的分量。\n$$ \\mu = \\pi + (\\mu - \\pi) $$\n向量 $\\pi$ 是对应于 $\\lambda_1=1$ 的左特征向量，所以 $\\pi P^n = \\pi$。\n向量 $\\delta = \\mu - \\pi$ 的分量之和为零：$\\sum_i (\\mu_i - \\pi_i) = \\sum_i \\mu_i - \\sum_i \\pi_i = 1 - 1 = 0$。因此，$\\delta$ 是对应于特征值 $\\frac{1}{3}$ 的左特征向量的线性组合。所以，$\\delta P^n = (\\frac{1}{3})^n \\delta$。\n将 $P^n$ 应用于 $\\mu$ 的分解：\n$$ \\mu P^n = (\\pi + \\delta)P^n = \\pi P^n + \\delta P^n = \\pi + (\\frac{1}{3})^n \\delta $$\n代入 $\\delta = \\mu - \\pi$，我们得到 $n$ 步分布的闭式表达式：\n$$ \\mu P^n = \\pi + (\\frac{1}{3})^n (\\mu - \\pi) $$\n这个结果表明，当 $n \\to \\infty$ 时，分布收敛于平稳分布 $\\pi$。\n\n现在，我们代入给定的值：\n$\\mu = \\left(\\frac{1}{2}, \\frac{1}{4}, \\frac{1}{4}\\right)$\n$\\pi = \\left(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}\\right)$\n$\\mu - \\pi = \\left(\\frac{1}{2} - \\frac{1}{3}, \\frac{1}{4} - \\frac{1}{3}, \\frac{1}{4} - \\frac{1}{3}\\right) = \\left(\\frac{1}{6}, -\\frac{1}{12}, -\\frac{1}{12}\\right)$\n\n$n$ 步分布向量为：\n$$ \\mu P^n = \\left(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}\\right) + (\\frac{1}{3})^n \\left(\\frac{1}{6}, -\\frac{1}{12}, -\\frac{1}{12}\\right) $$\n经过 $n$ 步后链处于状态 $2$ 的概率是该向量的第二个分量，记为 $(\\mu P^n)_2$：\n$$ (\\mu P^n)_2 = \\frac{1}{3} + (\\frac{1}{3})^n \\left(-\\frac{1}{12}\\right) = \\frac{1}{3} - \\frac{1}{12}(\\frac{1}{3})^n $$\n此表达式可以简化为：\n$$ \\frac{1}{3} - \\frac{1}{12 \\cdot 3^n} = \\frac{1}{3} - \\frac{1}{4 \\cdot 3 \\cdot 3^n} = \\frac{1}{3} - \\frac{1}{4 \\cdot 3^{n+1}} $$\n这就是所求概率的最终、精确的闭式表达式。",
            "answer": "$$\n\\boxed{\\frac{1}{3} - \\frac{1}{4 \\cdot 3^{n+1}}}\n$$"
        },
        {
            "introduction": "许多复杂的连续随机过程，其根源可以追溯到简单的离散步骤累积效应。布朗运动，作为随机过程理论的基石，正是简单随机游走在特定标度变换下的极限。本练习将引导你通过编程实践，构建一个标度的随机游走模型来近似布朗运动，并使用柯尔莫哥洛夫-斯米尔诺夫距离来量化这种近似的收敛性，从而亲手验证从离散到连续这一深刻的理论飞跃。",
            "id": "3314093",
            "problem": "令 $\\{W_t\\}_{t \\ge 0}$ 表示一个标准布朗运动，它被定义为一个具有平稳独立增量的高斯过程，其中 $W_0 = 0$ 且对于每个固定的 $t \\ge 0$ 都有 $W_t \\sim \\mathcal{N}(0,t)$。考虑如下构造的标度化简单随机游走近似 $\\{X^\\Delta(t)\\}_{t \\ge 0}$：固定一个时间步长 $\\Delta t  0$，令 $n = t / \\Delta t \\in \\mathbb{N}$，并定义 $X^\\Delta(t) = \\sum_{k=1}^{n} \\xi_k \\sqrt{\\Delta t}$，其中 $\\{\\xi_k\\}_{k=1}^n$ 是独立同分布的 Rademacher 随机变量，以相等的概率取值 $+1$ 和 $-1$。经典的中心极限定理为我们提供了一条途径，来理解为何对于每个固定的 $t$，当 $\\Delta t \\to 0$ 时（等价于在 $n \\Delta t = t$ 固定的情况下 $n \\to \\infty$），$X^\\Delta(t)$ 的分布会逼近 $W_t$ 的分布。在本问题中，您将通过计算 $X^\\Delta(t)$ 的经验分布与 $W_t$ 的精确分布之间的 Kolmogorov 距离的数值估计，来量化在固定时间点上的分布收敛性。\n\n仅从上述标准布朗运动和标度化简单随机游走的核心定义出发，推导出一个算法来计算以下两者之间的 Kolmogorov–Smirnov 距离 $D_{\\mathrm{KS}}(t,\\Delta t,M)$：\n- $M$ 个 $X^\\Delta(t)$ 独立样本的经验累积分布函数 $F_M(x)$，以及\n- 正态分布 $\\mathcal{N}(0,t)$ 的精确累积分布函数 $\\Phi_t(x)$。\n\n形式上，对于固定的 $t$ 和 $\\Delta t$（其中 $n=t/\\Delta t \\in \\mathbb{N}$）以及给定的 $M \\in \\mathbb{N}$，定义\n$$\nD_{\\mathrm{KS}}(t,\\Delta t,M) = \\sup_{x \\in \\mathbb{R}} \\left| F_M(x) - \\Phi_t(x) \\right|。\n$$\n您的任务是实现一个完整、可运行的程序，该程序：\n- 通过模拟 $n$ 个由 $\\sqrt{\\Delta t}$ 标度化的独立 Rademacher 增量并求和，生成 $M$ 个 $X^\\Delta(t)$ 的独立样本。\n- 利用经验累积分布函数的性质，即 Kolmogorov 距离中的上确界必在样本点及其左极限处取得，从而根据这些样本精确计算 $D_{\\mathrm{KS}}(t,\\Delta t,M)$。具体来说，如果 $x_{(1)} \\le x_{(2)} \\le \\cdots \\le x_{(M)}$ 是排序后的样本，则\n$$\nD_{\\mathrm{KS}}(t,\\Delta t,M) = \\max\\left\\{ \\max_{1 \\le i \\le M} \\left(\\frac{i}{M} - \\Phi_t(x_{(i)})\\right), \\ \\max_{1 \\le i \\le M} \\left(\\Phi_t(x_{(i)}) - \\frac{i-1}{M}\\right) \\right\\}。\n$$\n- 使用固定的随机数生成器种子 $123456$ 来确保可复现性。\n- 使用误差函数计算 $\\mathcal{N}(0,t)$ 对于 $t0$ 的精确正态累积分布函数 $\\Phi_t(x)$：$\\Phi_t(x) = \\frac{1}{2}\\left(1 + \\operatorname{erf}\\left(\\frac{x}{\\sqrt{2t}}\\right)\\right)$。\n- 假设在所有测试用例中 $t/\\Delta t \\in \\mathbb{N}$。本问题不涉及任何物理单位或角度单位。\n\n测试套件：\n为以下参数集计算 $D_{\\mathrm{KS}}(t,\\Delta t,M)$，这些参数集涵盖了从粗到细的时间离散化，包括类边界的粗略情况：\n- $(t,\\Delta t,M) = (1.0, 1.0, 40000)$\n- $(t,\\Delta t,M) = (1.0, 0.25, 40000)$\n- $(t,\\Delta t,M) = (1.0, 0.10, 40000)$\n- $(t,\\Delta t,M) = (1.0, 0.01, 40000)$\n- $(t,\\Delta t,M) = (2.0, 0.02, 40000)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含五个计算出的 Kolmogorov 距离，以逗号分隔列表的形式置于方括号内，顺序与上述测试套件相同。例如，输出应类似于 $[d_1,d_2,d_3,d_4,d_5]$，其中每个 $d_i$ 是一个浮点数。",
            "solution": "该问题要求计算一个标度化简单随机游走的经验分布与一个标准布朗运动在固定时间点上的理论分布之间的 Kolmogorov-Smirnov 距离。这可以作为随机游走向布朗运动分布收敛性的一种数值验证，该结果由泛函中心极限定理支持。\n\n首先，我们形式化所涉及的两个随机过程。\n目标过程是标准布朗运动，记为 $\\{W_t\\}_{t \\ge 0}$。对于任意固定的时间 $t  0$，随机变量 $W_t$ 服从均值为 $0$、方差为 $t$ 的正态分布，记作 $W_t \\sim \\mathcal{N}(0,t)$。其累积分布函数 (CDF) $\\Phi_t(x) = P(W_t \\le x)$ 由经过中心化和标度化的标准正态 CDF 给出。这可以用误差函数 $\\operatorname{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z e^{-u^2} du$ 表示为：\n$$\n\\Phi_t(x) = \\frac{1}{2}\\left(1 + \\operatorname{erf}\\left(\\frac{x}{\\sqrt{2t}}\\right)\\right)\n$$\n\n近似过程是标度化简单随机游走 $\\{X^\\Delta(t)\\}_{t \\ge 0}$。对于固定的时间 $t$ 和时间步长 $\\Delta t  0$，我们将步数定义为 $n = t/\\Delta t$，在所有考虑的情况下它都是一个整数。游走在时间 $t$ 的位置由 $n$ 个标度化的独立步长的总和给出：\n$$\nX^\\Delta(t) = \\sum_{k=1}^{n} \\xi_k \\sqrt{\\Delta t}\n$$\n这里，$\\{\\xi_k\\}_{k=1}^n$ 是独立同分布 (i.i.d.) 的 Rademacher 随机变量，以相等的概率取值 $+1$ 和 $-1$：$P(\\xi_k = 1) = P(\\xi_k = -1) = 1/2$。每个 $\\xi_k$ 的均值和方差分别为 $\\mathbb{E}[\\xi_k] = 0$ 和 $\\operatorname{Var}(\\xi_k) = \\mathbb{E}[\\xi_k^2] - (\\mathbb{E}[\\xi_k])^2 = 1^2 - 0^2 = 1$。因此，$X^\\Delta(t)$ 的均值和方差为：\n$$\n\\mathbb{E}[X^\\Delta(t)] = \\mathbb{E}\\left[\\sum_{k=1}^{n} \\xi_k \\sqrt{\\Delta t}\\right] = \\sqrt{\\Delta t} \\sum_{k=1}^{n} \\mathbb{E}[\\xi_k] = 0\n$$\n$$\n\\operatorname{Var}(X^\\Delta(t)) = \\operatorname{Var}\\left(\\sum_{k=1}^{n} \\xi_k \\sqrt{\\Delta t}\\right) = (\\sqrt{\\Delta t})^2 \\sum_{k=1}^{n} \\operatorname{Var}(\\xi_k) = \\Delta t \\cdot n \\cdot 1 = \\Delta t \\cdot \\frac{t}{\\Delta t} = t\n$$\n$X^\\Delta(t)$ 的均值和方差与 $W_t$ 的相匹配。中心极限定理表明，随着 $n \\to \\infty$（或者等价地，在 $t$ 固定的情况下 $\\Delta t \\to 0$），和 $X^\\Delta(t)$ 的分布收敛于具有相同均值和方差的正态分布，即 $\\mathcal{N}(0,t)$。\n\n为了量化这种收敛性，我们使用 Kolmogorov-Smirnov (KS) 距离。给定 $M$ 个 $X^\\Delta(t)$ 的独立样本，我们首先构造经验累积分布函数 (ECDF)，记为 $F_M(x)$。如果 $x_{(1)} \\le x_{(2)} \\le \\cdots \\le x_{(M)}$ 是按非降序排列的样本，ECDF 是一个阶梯函数，定义为 $F_M(x) = \\frac{1}{M} \\times (\\text{样本数 } \\le x)$。KS 距离是 ECDF 和理论 CDF 之间绝对差值的上确界：\n$$\nD_{\\mathrm{KS}}(t,\\Delta t,M) = \\sup_{x \\in \\mathbb{R}} \\left| F_M(x) - \\Phi_t(x) \\right|\n$$\n由于 $\\Phi_t(x)$ 是连续的，而 $F_M(x)$ 是一个阶梯函数，上确界必定在某个样本点 $x_{(i)}$ 处取得。具体来说，必须在 ECDF 的每个跳跃点之前和跳跃点处评估差值。这导出了广为接受的计算公式：\n$$\nD_{\\mathrm{KS}}(t,\\Delta t,M) = \\max\\left\\{ \\max_{1 \\le i \\le M} \\left(\\frac{i}{M} - \\Phi_t(x_{(i)})\\right), \\ \\max_{1 \\le i \\le M} \\left(\\Phi_t(x_{(i)}) - \\frac{i-1}{M}\\right) \\right\\}\n$$\n外部 $\\max$ 中的第一项对应于 ECDF 在样本点 $x_{(i)}$ 处高于理论 CDF 的最大正偏差。第二项对应于理论 CDF 在样本点左侧（此处 ECDF 的值为 $\\frac{i-1}{M}$）高于 ECDF 的最大正偏差。\n\n对于给定的参数集 $(t, \\Delta t, M)$，计算 $D_{\\mathrm{KS}}(t,\\Delta t,M)$ 的算法如下：\n1.  **为保证可复现性设置种子**：使用固定种子 ($123456$) 初始化伪随机数生成器，以确保每次执行的模拟结果相同。\n2.  **生成样本**：\n    a. 计算步数 $n = t/\\Delta t$。\n    b. 生成一个 $M \\times n$ 的随机整数矩阵，其中每个元素以等概率为 $1$ 或 $-1$。这代表了所有 $M$ 次模拟中 $\\xi_k$ 变量的结果。\n    c. 对 $M$ 行中的每一行沿轴求和，以获得 $M$ 个未标度化的和 $\\sum_{k=1}^n \\xi_k$ 的实现。\n    d. 将每个和乘以标度因子 $\\sqrt{\\Delta t}$，以生成最终的 $M$ 个 $X^\\Delta(t)$ 样本。\n3.  **计算 KS 距离**：\n    a. 将生成的 $M$ 个样本按升序排序，以获得有序统计量 $x_{(1)}, x_{(2)}, \\dots, x_{(M)}$。\n    b. 对于每个 $x_{(i)}$，使用包含误差函数的公式计算相应的理论 CDF 值 $\\Phi_t(x_{(i)})$。\n    c. 创建两个数组来表示 ECDF 的值：一个用于每一步的上界，$v_i = i/M$ for $i=1, \\dots, M$；另一个用于下界，$u_i = (i-1)/M$。\n    d. 计算 KS 公式所需的两个最大差值：\n       $D^+ = \\max_{i} (v_i - \\Phi_t(x_{(i)}))$\n       $D^- = \\max_{i} (\\Phi_t(x_{(i)}) - u_i)$\n    e. 结果是这两个值的最大值：$D_{\\mathrm{KS}} = \\max(D^+, D^-)$。\n\n对测试套件中的每组参数重复此过程。我们预期会观察到，对于固定的 $t$ 和 $M$，随着时间步长 $\\Delta t$ 变小，计算出的距离 $D_{\\mathrm{KS}}$ 会减小，这说明了离散随机游走模型向连续布朗运动模型的收敛。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes the Kolmogorov-Smirnov distance between the empirical CDF of a\n    scaled random walk and the exact CDF of a Brownian motion for several\n    parameter sets.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (t, delta_t, M)\n        (1.0, 1.0, 40000),\n        (1.0, 0.25, 40000),\n        (1.0, 0.10, 40000),\n        (1.0, 0.01, 40000),\n        (2.0, 0.02, 40000)\n    ]\n\n    # Fixed seed for reproducibility.\n    seed = 123456\n    rng = np.random.default_rng(seed)\n\n    results = []\n    for t, delta_t, M in test_cases:\n        # Step 1: Parameter calculation\n        # n is the number of steps in the random walk.\n        # The problem guarantees t/delta_t is an integer.\n        n = int(t / delta_t)\n\n        # Step 2: Sample Generation\n        # Generate M x n matrix of Rademacher random variables (+1 or -1)\n        # 2 * rng.integers(0, 2, size=(M, n)) - 1 is an efficient way to get -1, 1\n        xi_k_matrix = 2 * rng.integers(0, 2, size=(M, n), dtype=np.int8) - 1\n        \n        # Sum the increments for each of the M paths\n        sum_of_increments = np.sum(xi_k_matrix, axis=1)\n\n        # Scale the sums to get M samples of X_delta(t)\n        samples = sum_of_increments * np.sqrt(delta_t)\n        \n        # Step 3: Kolmogorov-Smirnov distance calculation\n        # Sort the samples in ascending order\n        sorted_samples = np.sort(samples)\n\n        # Calculate the theoretical CDF Phi_t(x) for each sorted sample\n        # Phi_t(x) = 0.5 * (1 + erf(x / sqrt(2*t)))\n        arg_erf = sorted_samples / np.sqrt(2 * t)\n        phi_t_values = 0.5 * (1.0 + erf(arg_erf))\n        \n        # ECDF values: (i-1)/M and i/M for i=1,...,M\n        i_values = np.arange(1, M + 1)\n        ecdf_upper = i_values / M\n        ecdf_lower = (i_values - 1) / M\n        \n        # Calculate the two components of the KS distance\n        d_plus = np.max(ecdf_upper - phi_t_values)\n        d_minus = np.max(phi_t_values - ecdf_lower)\n        \n        # The KS distance is the max of the two\n        ks_dist = np.max([d_plus, d_minus])\n        \n        results.append(ks_dist)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}