{
    "hands_on_practices": [
        {
            "introduction": "在实践中，评估蒙特卡洛估计的误差至关重要，而遍历均值的方差正是衡量这种误差的关键指标。本练习将引导你推导一个著名公式，它将估计量的方差与可观测量的方差及积分自相关时间联系起来 。理解这一关系对于评估马尔可夫链蒙特卡洛（MCMC）模拟的精度和比较不同采样器的效率至关重要。",
            "id": "3305623",
            "problem": "考虑一个在可测状态空间上的时间齐次、不可约、正常返的马尔可夫链 $\\,\\{X_t\\}_{t \\geq 0}\\,$，其具有唯一的平稳分布 $\\,\\pi\\,$。假设该链从平稳状态开始，因此 $\\,X_0 \\sim \\pi\\,$ 且 $\\,\\{X_t\\}\\,$ 是严平穩的。设函数 $\\,f:\\text{state space}\\to\\mathbb{R}\\,$ 在 $\\,\\pi\\,$ 下是可积的且方差有限，记为 $\\,\\operatorname{Var}_{\\pi}(f) = \\sigma_f^2 \\in (0,\\infty)\\,$。定义遍历均值\n$$\n\\hat{\\pi}_n(f) \\;=\\; \\frac{1}{n}\\sum_{t=1}^{n} f(X_t).\n$$\n令自协方差函数为 $\\,\\gamma_k = \\operatorname{Cov}_{\\pi}(f(X_0), f(X_k))\\,$，自相关函数为 $\\,\\rho_k = \\gamma_k/\\gamma_0\\,$，其中 $\\,\\gamma_0 = \\sigma_f^2\\,$。假设 $\\,\\sum_{k=1}^{\\infty} |\\rho_k|  \\infty\\,$。\n\n1) 从第一性原理以及方差和协方差的定义出发，用自协方差 $\\,\\gamma_k\\,$ 的有限样本和来精确表示 $\\,\\operatorname{Var}(\\hat{\\pi}_n(f))\\,$。然后，在给定的可和性假设下，当 $\\,n \\to \\infty\\,$ 时，提取以 $\\,\\rho_k\\,$ 和 $\\,\\sigma_f^2\\,$ 的无穷级数表示的 $\\,1/n\\,$ 主项。\n\n2) 引入积分自相关时间 $\\,\\tau_{\\mathrm{int}}\\,$ 作为自相关序列的泛函，并用 $\\,\\sigma_f^2\\,$, $\\,\\tau_{\\mathrm{int}}\\,$ 和 $\\,n\\,$ 简洁地重写你得到的 $\\,\\operatorname{Var}(\\hat{\\pi}_n(f))\\,$ 的主阶表达式。\n\n3) 现在特化为一阶自回归相关结构 $\\,\\rho_k = \\alpha^{k}\\,$（对于 $\\,k \\geq 1\\,$ 且 $\\,|\\alpha|1\\,$）。令 $\\,\\alpha = \\tfrac{1}{2}\\,$, $\\,\\sigma_f^2 = 2\\,$ 及 $\\,n = 10^{4}\\,$。使用你从第 2 部分得到的表达式，计算 $\\,\\operatorname{Var}(\\hat{\\pi}_n(f))\\,$ 的近似值。将你的最终数值答案四舍五入到四位有效数字。",
            "solution": "这个问题分为三个部分。我们将依次解答。\n\n第1部分：遍历均值的精确方差和渐近方差的推导。\n\n遍历均值定义为 $\\hat{\\pi}_n(f) = \\frac{1}{n}\\sum_{t=1}^{n} f(X_t)$。我们从方差的定义开始：\n$$\n\\operatorname{Var}(\\hat{\\pi}_n(f)) = \\operatorname{Var}\\left(\\frac{1}{n}\\sum_{t=1}^{n} f(X_t)\\right)\n$$\n利用常数 $c$ 的性质 $\\operatorname{Var}(cY) = c^2\\operatorname{Var}(Y)$，我们可以提出因子 $\\frac{1}{n^2}$：\n$$\n\\operatorname{Var}(\\hat{\\pi}_n(f)) = \\frac{1}{n^2} \\operatorname{Var}\\left(\\sum_{t=1}^{n} f(X_t)\\right)\n$$\n一组随机变量之和的方差是其协方差矩阵中所有元素的总和：\n$$\n\\operatorname{Var}\\left(\\sum_{t=1}^{n} f(X_t)\\right) = \\sum_{s=1}^{n} \\sum_{t=1}^{n} \\operatorname{Cov}(f(X_s), f(X_t))\n$$\n问题指出马尔可夫链 $\\{X_t\\}_{t \\geq 0}$ 是严平穩的。这意味着 $f(X_s)$ 和 $f(X_t)$ 之间的协方差仅取决于时间差 $|t-s|$。令 $\\gamma_k = \\operatorname{Cov}_{\\pi}(f(X_0), f(X_k))$ 为滞后 $k$ 的自协方差。那么，根据平稳性：\n$$\n\\operatorname{Cov}(f(X_s), f(X_t)) = \\operatorname{Cov}(f(X_0), f(X_{|t-s|})) = \\gamma_{|t-s|}\n$$\n将此代入双重求和中，我们得到：\n$$\n\\operatorname{Var}(\\hat{\\pi}_n(f)) = \\frac{1}{n^2} \\sum_{s=1}^{n} \\sum_{t=1}^{n} \\gamma_{|t-s|}\n$$\n为了计算这个和，我们按滞后 $k = t-s$ 重新索引。滞后 $k$ 的范围从 $-(n-1)$ 到 $n-1$。对于给定的滞后 $k$，在和中（其中 $1 \\leq s,t \\leq n$）有 $n-|k|$ 对索引 $(s,t)$ 使得 $t-s=k$。因此，该和可以写为：\n$$\n\\sum_{s=1}^{n} \\sum_{t=1}^{n} \\gamma_{|t-s|} = \\sum_{k=-(n-1)}^{n-1} (n-|k|) \\gamma_{|k|}\n$$\n自协方差函数是偶函数，即 $\\gamma_k = \\gamma_{-k}$，所以对于任意整数 $k$，$\\gamma_{|k|}$ 就是 $\\gamma_k$。我们可以拆分这个和：\n$$\n\\sum_{k=-(n-1)}^{n-1} (n-|k|) \\gamma_k = (n-0)\\gamma_0 + \\sum_{k=1}^{n-1} (n-k)\\gamma_k + \\sum_{k=-(n-1)}^{-1} (n-|k|)\\gamma_k\n$$\n在最后一项中令 $j = -k$，它变为 $\\sum_{j=1}^{n-1} (n-j)\\gamma_{-j} = \\sum_{j=1}^{n-1} (n-j)\\gamma_j$。因此，总和为：\n$$\nn\\gamma_0 + 2\\sum_{k=1}^{n-1} (n-k)\\gamma_k\n$$\n将此代回方差的表达式，得到精确表达式：\n$$\n\\operatorname{Var}(\\hat{\\pi}_n(f)) = \\frac{1}{n^2} \\left[ n\\gamma_0 + 2\\sum_{k=1}^{n-1} (n-k)\\gamma_k \\right] = \\frac{\\gamma_0}{n} + \\frac{2}{n}\\sum_{k=1}^{n-1}\\left(1 - \\frac{k}{n}\\right)\\gamma_k\n$$\n现在，我们求当 $n \\to \\infty$ 时的主项。使用定义 $\\gamma_0 = \\sigma_f^2$ 和 $\\rho_k = \\gamma_k/\\gamma_0$，我们将方差重写为：\n$$\n\\operatorname{Var}(\\hat{\\pi}_n(f)) = \\frac{\\sigma_f^2}{n} \\left[ 1 + 2\\sum_{k=1}^{n-1}\\left(1 - \\frac{k}{n}\\right)\\rho_k \\right]\n$$\n对于大的 $n$，对于任意固定的 $k$，项 $(1 - k/n)$ 趋近于 $1$，且和的上限趋于无穷。问题指出 $\\sum_{k=1}^{\\infty} |\\rho_k|  \\infty$，这意味着级数 $\\sum \\rho_k$ 绝对收敛。这允许我们交换极限和求和的顺序（通过级数的控制收敛定理，因为 $|(1-k/n)\\rho_k| \\le |\\rho_k|$ 且 $\\sum|\\rho_k|$ 是一个收敛的控制级数）。\n$$\n\\lim_{n\\to\\infty} \\sum_{k=1}^{n-1}\\left(1 - \\frac{k}{n}\\right)\\rho_k = \\sum_{k=1}^{\\infty} \\rho_k\n$$\n因此，对于大的 $n$，我们有 $n \\operatorname{Var}(\\hat{\\pi}_n(f)) \\to \\sigma_f^2 (1 + 2\\sum_{k=1}^{\\infty} \\rho_k)$。关于 $1/n$ 的主阶项是：\n$$\n\\operatorname{Var}(\\hat{\\pi}_n(f)) \\approx \\frac{\\sigma_f^2}{n} \\left( 1 + 2\\sum_{k=1}^{\\infty} \\rho_k \\right)\n$$\n\n第2部分：引入积分自相关时间。\n\n积分自相关时间 $\\tau_{\\mathrm{int}}$ 定义为自相关函数在所有滞后上的和：\n$$\n\\tau_{\\mathrm{int}} = \\sum_{k=-\\infty}^{\\infty} \\rho_k\n$$\n根据定义，$\\rho_0 = \\gamma_0/\\gamma_0 = 1$。自相关函数也是一个偶函数，$\\rho_k = \\rho_{-k}$。因此，我们可以将 $\\tau_{\\mathrm{int}}$ 写为：\n$$\n\\tau_{\\mathrm{int}} = \\rho_0 + \\sum_{k=1}^{\\infty} \\rho_k + \\sum_{k=-\\infty}^{-1} \\rho_k = 1 + 2\\sum_{k=1}^{\\infty} \\rho_k\n$$\n这恰好是方差的渐近表达式中出现的因子。条件 $\\sum_{k=1}^{\\infty} |\\rho_k|  \\infty$ 确保了 $\\tau_{\\mathrm{int}}$ 是有限的。将此定义代入我们从第1部分得到的结果，我们得到了简洁的表达式：\n$$\n\\operatorname{Var}(\\hat{\\pi}_n(f)) \\approx \\frac{\\sigma_f^2 \\tau_{\\mathrm{int}}}{n}\n$$\n\n第3部分：特化为AR(1)相关结构并进行数值计算。\n\n给定一个一阶自回归相关结构，$\\rho_k = \\alpha^k$ 对于 $k \\geq 1$，且 $|\\alpha|  1$。我们首先使用第2部分的定义计算这种结构的 $\\tau_{\\mathrm{int}}$：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2\\sum_{k=1}^{\\infty} \\rho_k = 1 + 2\\sum_{k=1}^{\\infty} \\alpha^k\n$$\n这个和是一个标准的几何级数：$\\sum_{k=1}^{\\infty} \\alpha^k = \\frac{\\alpha}{1-\\alpha}$。将此代入 $\\tau_{\\mathrm{int}}$ 的表达式中：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2\\left(\\frac{\\alpha}{1-\\alpha}\\right) = \\frac{1-\\alpha+2\\alpha}{1-\\alpha} = \\frac{1+\\alpha}{1-\\alpha}\n$$\n问题给出的值为 $\\alpha = \\frac{1}{2}$，$\\sigma_f^2 = 2$ 和 $n = 10^4$。我们首先用 $\\alpha = \\frac{1}{2}$ 计算 $\\tau_{\\mathrm{int}}$：\n$$\n\\tau_{\\mathrm{int}} = \\frac{1+\\frac{1}{2}}{1-\\frac{1}{2}} = \\frac{\\frac{3}{2}}{\\frac{1}{2}} = 3\n$$\n现在，我们使用给定的数值对方差的近似公式进行计算：\n$$\n\\operatorname{Var}(\\hat{\\pi}_n(f)) \\approx \\frac{\\sigma_f^2 \\tau_{\\mathrm{int}}}{n} = \\frac{2 \\times 3}{10^4} = \\frac{6}{10000} = 0.0006\n$$\n问题要求最终答案四舍五入到四位有效数字。我们将 $0.0006$ 用科学记数法表示，以明确显示有效数字：$6.000 \\times 10^{-4}$。",
            "answer": "$$ \\boxed{6.000 \\times 10^{-4}} $$"
        },
        {
            "introduction": "前一个练习介绍了对自相关函数求和的思想，但其理论依据是什么？我们又如何确保该级数收敛？本练习将针对广泛使用的一阶自回归（AR(1))过程来探讨这些问题 。你将证明其相关性呈指数衰减，并以此为基础为遍历均值建立中心极限定理（CLT）。这个过程将加深你对为何CLT适用于相关序列的理论理解，并让你亲手计算渐近方差这一时间序列分析中的基本量。",
            "id": "3305618",
            "problem": "考虑由 $X_{k+1}=\\phi X_{k}+\\epsilon_{k+1}$ 定义的一阶自回归过程，其中 $(\\epsilon_{k})_{k\\geq 1}$ 是独立同分布的实值随机变量，且 $\\mathbb{E}[\\epsilon_{1}]=0$ 和 $\\mathrm{Var}(\\epsilon_{1})=\\sigma_{\\epsilon}^{2}\\in(0,\\infty)$，并且 $|\\phi|1$。假设初始状态 $X_{0}$ 服从该链唯一的平稳分布。强混合（也称 $\\alpha$-混合）系数定义为 $\\alpha(n)=\\sup_{k\\geq 0}\\sup_{A\\in\\mathcal{F}_{-\\infty}^{k},\\,B\\in\\mathcal{F}_{k+n}^{\\infty}}|\\mathbb{P}(A\\cap B)-\\mathbb{P}(A)\\mathbb{P}(B)|$，其中 $\\mathcal{F}_{a}^{b}$ 表示由 $\\{X_{t}:a\\leq t\\leq b\\}$ 生成的 $\\sigma$-代数。\n\n你只能使用以下内容作为基础出发点：\n- 马尔可夫链、平稳性、强混合系数、全变差范数的定义，以及在混合系数可和且二阶矩有限的条件下，适用于平稳强混合序列的中心极限定理（CLT）。\n- 关于 $|\\phi|1$ 的一阶自回归过程的标准事实，包括平穩分布的存在性和唯一性，以及一阶高斯自回归过程的平稳自协方差函数形式为 $\\gamma(h)=\\gamma(0)\\phi^{|h|}$。\n\n任务：\n- 首先，从马尔可夫性质和仿射递归的收缩性出发，证明 $\\alpha$-混合系数 $\\alpha(n)$ 以 $n$ 的指数速率衰减。\n- 其次，仅利用 $\\alpha$-混合的指数衰减和 $f$ 的有界性，为任意有界可测函数 $f$ 的遍历平均 $\\frac{1}{n}\\sum_{k=1}^{n}f(X_{k})$ 推导中心极限定理，并将渐近方差的形式确定为协方差级数。\n- 最后，将问题特化到 $\\epsilon_{k}\\sim\\mathcal{N}(0,\\sigma_{\\epsilon}^{2})$ 和 $f(x)=x$ 的情况，并计算 $\\sqrt{n}\\big(\\frac{1}{n}\\sum_{k=1}^{n}X_{k}-\\mathbb{E}[X_{0}]\\big)$ 的中心极限定理中渐近方差的精确闭式表达式。\n\n你的最终答案必须是该渐近方差关于 $\\phi$ 和 $\\sigma_{\\epsilon}^{2}$ 的单个闭式解析表达式。不需要数值近似。",
            "solution": "按要求，该问题分三部分进行分析。首先，我们证明强混合系数的指数衰减。其次，我们利用此结果推导遍历平均的中心极限定理（CLT）。第三，我们计算一个特定情况下的显式渐近方差。\n\n第一部分：$\\alpha$-混合系数的指数衰减\n\n该过程由一阶自回归（AR($1$)）方程 $X_{k+1}=\\phi X_{k}+\\epsilon_{k+1}$ 定义，其中 $|\\phi|1$。这是一个时间齐次马尔可夫过程。问题要求从马尔可夫性质和递归的收缩性出发，证明 $\\alpha$-混合系数 $\\alpha(n)$ 的指数衰减。\n\n考虑该过程的两个实现，$(X_k^x)$ 和 $(X_k^y)$，它们从两个不同的初始状态 $X_0=x$ 和 $X_0=y$ 开始，但由相同的创新序列 $(\\epsilon_k)_{k\\geq 1}$ 驱动。通过迭代递归，我们可以将时间 $k$ 的状态表示为：\n$$X_k^x = \\phi^k x + \\sum_{j=1}^{k} \\phi^{k-j}\\epsilon_j$$\n$$X_k^y = \\phi^k y + \\sum_{j=1}^{k} \\phi^{k-j}\\epsilon_j$$\n在时间 $k$ 时，这两条路径之间的差异是：\n$$X_k^x - X_k^y = \\phi^k (x - y)$$\n取绝对值，我们观察到收缩性质：\n$$|X_k^x - X_k^y| = |\\phi|^k |x - y|$$\n由于 $|\\phi|1$，两条路径之间的距离以指数速率收缩到零。这个性质是证明几何遍历性的基础。\n\n对于一个平稳马尔可夫过程，强混合系数 $\\alpha(n)$ 定义为 $\\alpha(n)=\\sup_{k\\geq 0}\\sup_{A\\in\\mathcal{F}_{-\\infty}^{k},\\,B\\in\\mathcal{F}_{k+n}^{\\infty}}|\\mathbb{P}(A\\cap B)-\\mathbb{P}(A)\\mathbb{P}(B)|$。由于平稳性和马尔可夫性质，$\\alpha(n)$ 的衰减率由 $n$-步转移概率分布 $P^n(x, \\cdot) = \\mathbb{P}(X_n \\in \\cdot | X_0=x)$ 收敛到唯一平稳分布 $\\pi(\\cdot)$ 的速率决定。\n\n马尔可夫链理论中的一个标准定理指出，如果一个过程是几何遍历的，即 $n$-步转移分布与平稳分布之间的全变差距离呈指数衰减，即存在 $M>0$ 和 $r \\in (0,1)$ 使得 $\\sup_x \\|P^n(x, \\cdot) - \\pi(\\cdot) \\|_{TV} \\le M r^n$，那么它的 $\\alpha$-混合系数也呈指数衰减。上面展示的收缩性是此类模型几何遍历性的一个充分条件。这种联系通过耦合论证来形式化。因此，我们可以得出结论，存在常数 $C>0$ 和 $\\rho \\in (0,1)$，使得对于所有 $n \\ge 1$：\n$$\\alpha(n) \\le C \\rho^n$$\n这就证明了 $\\alpha$-混合系数以指数速率衰减。\n\n第二部分：遍历平均的中心极限定理\n\n我们被要求为有界可测函数 $f$ 的形式为 $\\frac{1}{n}\\sum_{k=1}^{n}f(X_{k})$ 的遍历平均推导一个中心极限定理。令 $Y_k = f(X_k)$。\n适用于平稳强混合序列的基础CLT指出，如果 $(Y_k)$ 是一个平稳序列，其均值为 $\\mu = \\mathbb{E}[Y_k]$，具有有限二阶矩 $\\mathbb{E}[Y_k^2]  \\infty$，且强混合系数 $\\alpha_Y(n)$ 可和，即 $\\sum_{n=1}^\\infty \\alpha_Y(n)  \\infty$，那么\n$$ \\sqrt{n}\\left(\\frac{1}{n}\\sum_{k=1}^{n}Y_k - \\mu\\right) \\xrightarrow{d} \\mathcal{N}(0, \\sigma^2) $$\n其中 $\\xrightarrow{d}$ 表示依分布收敛，渐近方差 $\\sigma^2$ 由下式给出\n$$ \\sigma^2 = \\sum_{h=-\\infty}^{\\infty} \\mathrm{Cov}(Y_0, Y_h) = \\mathrm{Var}(Y_0) + 2\\sum_{h=1}^{\\infty}\\mathrm{Cov}(Y_0, Y_h) $$\n我们必须验证序列 $Y_k = f(X_k)$ 的条件。\n1.  **平稳性：** 由于过程 $(X_k)$ 假设是平稳的，变换后的过程 $(Y_k = f(X_k))$ 也是平稳的。\n2.  **有限二阶矩：** 函数 $f$ 是有界的，因此存在一个常数 $M$ 使得对所有 $x$ 都有 $|f(x)| \\le M$。因此，$\\mathbb{E}[Y_k^2] = \\mathbb{E}[f(X_k)^2] \\le M^2  \\infty$。\n3.  **可和的混合系数：** 序列 $(Y_k)$ 的混合系数，我们称之为 $\\alpha_Y(n)$，受原始序列 $(X_k)$ 的混合系数的限制，即 $\\alpha_Y(n) \\le \\alpha_X(n)$。从第一部分，我们证明了对于 $\\rho \\in (0,1)$，有 $\\alpha_X(n) \\le C \\rho^n$。几何级数 $\\sum_{n=1}^\\infty C\\rho^n$ 收敛，所以 $\\sum_{n=1}^\\infty \\alpha_X(n)  \\infty$，这意味着 $\\sum_{n=1}^\\infty \\alpha_Y(n)  \\infty$。\n\n所有条件都满足。因此，CLT对 $\\frac{1}{n}\\sum_{k=1}^{n}f(X_{k})$ 成立。渐近方差，记为 $\\sigma_f^2$，具有协方差级数的形式：\n$$ \\sigma_f^2 = \\mathrm{Var}(f(X_0)) + 2\\sum_{k=1}^{\\infty}\\mathrm{Cov}(f(X_0), f(X_k)) $$\n\n第三部分：渐近方差的计算\n\n我们现在特化到 $\\epsilon_k \\sim \\mathcal{N}(0, \\sigma_\\epsilon^2)$ 且函数为 $f(x)=x$ 的情况。问题要求 $\\sqrt{n}\\big(\\frac{1}{n}\\sum_{k=1}^{n}X_{k}-\\mathbb{E}[X_{0}]\\big)$ 的CLT中的渐近方差。渐近方差 $\\sigma^2$ 的通用公式是：\n$$ \\sigma^2 = \\mathrm{Var}(X_0) + 2\\sum_{k=1}^{\\infty}\\mathrm{Cov}(X_0, X_k) $$\n令 $\\gamma(h) = \\mathrm{Cov}(X_0, X_h)$ 为自协方差函数。公式为 $\\sigma^2 = \\gamma(0) + 2\\sum_{k=1}^{\\infty}\\gamma(k)$。\n\n我们首先求平稳过程的均值和方差。对平稳状态下的AR($1$)方程取期望可得 $\\mathbb{E}[X_k] = \\phi \\mathbb{E}[X_{k-1}] + \\mathbb{E}[\\epsilon_k]$。由于 $\\mathbb{E}[\\epsilon_k]=0$ 且 $\\mathbb{E}[X_k]=\\mathbb{E}[X_{k-1}]=\\mu_X$，我们得到 $\\mu_X = \\phi \\mu_X$，这意味着 $(1-\\phi)\\mu_X=0$。由于 $|\\phi|1$，我们必须有 $\\mu_X=0$。所以，对所有 $k$ 都有 $\\mathbb{E}[X_k]=0$。\n\n接下来，我们求方差 $\\gamma(0) = \\mathrm{Var}(X_k)$。\n$ \\mathrm{Var}(X_k) = \\mathrm{Var}(\\phi X_{k-1} + \\epsilon_k) $。由于 $X_{k-1}$ 由截至时间 $k-1$ 的创新决定，它与 $\\epsilon_k$ 无关。因此，\n$ \\mathrm{Var}(X_k) = \\phi^2 \\mathrm{Var}(X_{k-1}) + \\mathrm{Var}(\\epsilon_k) $。在平稳状态下，$\\mathrm{Var}(X_k)=\\mathrm{Var}(X_{k-1})=\\gamma(0)$ 且 $\\mathrm{Var}(\\epsilon_k)=\\sigma_\\epsilon^2$。\n$ \\gamma(0) = \\phi^2 \\gamma(0) + \\sigma_\\epsilon^2 \\implies \\gamma(0)(1-\\phi^2) = \\sigma_\\epsilon^2 \\implies \\gamma(0) = \\frac{\\sigma_\\epsilon^2}{1-\\phi^2} $。\n\n现在我们求 $k>0$ 时的自协方差 $\\gamma(k) = \\mathrm{Cov}(X_0, X_k) = \\mathbb{E}[X_0 X_k]$。我们使用给定的事实，即对于平稳高斯AR($1$)过程，$\\gamma(h) = \\gamma(0)\\phi^{|h|}$。所以对于 $k \\ge 1$，$\\gamma(k) = \\gamma(0)\\phi^k$。\n\n我们将这些代入渐近方差的公式中：\n$$ \\sigma^2 = \\gamma(0) + 2\\sum_{k=1}^{\\infty} \\gamma(0)\\phi^k = \\gamma(0) \\left(1 + 2\\sum_{k=1}^{\\infty}\\phi^k\\right) $$\n该和是一个几何级数：$\\sum_{k=1}^{\\infty}\\phi^k = \\frac{\\phi}{1-\\phi}$，因为 $|\\phi|1$ 所以它收敛。\n代入这个和：\n$$ \\sigma^2 = \\gamma(0) \\left(1 + 2\\frac{\\phi}{1-\\phi}\\right) = \\gamma(0) \\left(\\frac{1-\\phi+2\\phi}{1-\\phi}\\right) = \\gamma(0) \\left(\\frac{1+\\phi}{1-\\phi}\\right) $$\n最后，代入 $\\gamma(0)$ 的表达式：\n$$ \\sigma^2 = \\left(\\frac{\\sigma_\\epsilon^2}{1-\\phi^2}\\right) \\left(\\frac{1+\\phi}{1-\\phi}\\right) $$\n使用因式分解 $1-\\phi^2 = (1-\\phi)(1+\\phi)$：\n$$ \\sigma^2 = \\frac{\\sigma_\\epsilon^2}{(1-\\phi)(1+\\phi)} \\frac{1+\\phi}{1-\\phi} = \\frac{\\sigma_\\epsilon^2}{(1-\\phi)^2} $$\n这就是渐近方差的闭式表达式。",
            "answer": "$$\\boxed{\\frac{\\sigma_{\\epsilon}^{2}}{(1-\\phi)^{2}}}$$"
        },
        {
            "introduction": "到目前为止，我们都假设所处理的过程是“遍历”的。但如果这个假设不成立，会发生什么？本练习通过一个简单的两状态马尔可夫链来说明周期性如何破坏遍历性 。你将亲眼看到时间均值如何无法收敛到平稳期望，并学习如何通过对整个周期进行平均来修正这个问题。这个例子经典地揭示了非周期性为何是标准遍历定理的关键条件，并指出了分析马尔可夫链时的一个常见陷阱。",
            "id": "3305645",
            "problem": "考虑一个离散时间马尔可夫链 $\\{X_{t}\\}_{t \\geq 0}$，其状态空间为 $\\{0,1\\}$，转移核 $P$ 定义如下\n$$\nP(0,1)=1, \\quad P(1,0)=1, \\quad P(0,0)=0, \\quad P(1,1)=0.\n$$\n令 $\\pi$ 为 $P$ 的一个不变分布，并令 $f:\\{0,1\\}\\to\\mathbb{R}$ 为一个有界函数，$f(0)=\\alpha$ 且 $f(1)=\\beta$，其中 $\\alpha,\\beta\\in\\mathbb{R}$。假设 $X_{0}$ 的初始分布是任意的。\n\n仅使用马尔可夫链、不变分布、周期性和遍历均值的基本定义，执行以下步骤：\n\n- 构造 $\\pi$ 并验证它确实在 $P$ 下是不变的。\n- 确定该链的周期并描述轨迹 $\\{X_{t}\\}_{t\\geq 0}$ 的结构。\n- 定义剩余类遍历均值，对于剩余类 $r\\in\\{0,1\\}$，其定义为\n$$\nA_{n}^{(r)} \\equiv \\frac{1}{n}\\sum_{t=0}^{n-1} f\\big(X_{2t+r}\\big).\n$$\n证明对于每个固定的 $r\\in\\{0,1\\}$，序列 $\\{A_{n}^{(r)}\\}_{n\\geq 1}$ 几乎必然收敛，确定其几乎必然极限，并解释当 $\\alpha\\neq\\beta$ 时，为什么这些极限不必重合，也不必等于 $\\sum_{x\\in\\{0,1\\}}\\pi(x)f(x)$。总结为什么“不对整个周期进行平均”的剩余类平均法不会产生等于平稳期望的确定性几乎必然极限。\n- 现在进行“对整个周期进行平均”，定义周期平均的遍历均值\n$$\n\\overline{A}_{n} \\equiv \\frac{1}{2}\\sum_{r=0}^{1}\\left(\\frac{1}{n}\\sum_{t=0}^{n-1} f\\big(X_{2t+r}\\big)\\right).\n$$\n推导 $\\overline{A}_{n}$ 的几乎必然极限，并将其与 $\\pi$ 和 $f$ 联系起来。\n\n答案规格：\n- 你的最终答案必须是 $\\lim_{n\\to\\infty}\\overline{A}_{n}$ 的闭式表达式，用 $\\alpha$ 和 $\\beta$ 表示。\n- 不需要进行数值舍入。",
            "solution": "该问题要求对一个周期性马尔可夫链的遍历均值进行分析。我们按照指定的步骤进行。\n\n首先，我们为给定的转移核 $P$ 构造不变分布 $\\pi$。状态空间为 $S=\\{0,1\\}$。转移核定义为 $P(0,1)=1$，$P(1,0)=1$，$P(0,0)=P(1,1)=0$。对应的转移矩阵是\n$$\nP = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}.\n$$\n一个不变分布 $\\pi = (\\pi(0), \\pi(1))$ 必须满足平稳性条件 $\\pi P = \\pi$ 以及归一化条件 $\\sum_{x\\in S} \\pi(x) = 1$。该矩阵方程为\n$$\n(\\pi(0), \\pi(1)) \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = (\\pi(0), \\pi(1)).\n$$\n这得到向量方程 $(\\pi(1), \\pi(0)) = (\\pi(0), \\pi(1))$，这意味着 $\\pi(0) = \\pi(1)$。\n将其与归一化条件 $\\pi(0) + \\pi(1) = 1$ 结合，我们解这个方程组：\n$$\n\\begin{cases}\n\\pi(0) = \\pi(1) \\\\\n\\pi(0) + \\pi(1) = 1\n\\end{cases}\n\\implies 2\\pi(0) = 1 \\implies \\pi(0) = \\frac{1}{2}.\n$$\n因此，$\\pi(1) = \\frac{1}{2}$。唯一的不变分布是 $\\pi = (\\frac{1}{2}, \\frac{1}{2})$。\n我们验证其不变性：$\\pi P = (\\frac{1}{2}, \\frac{1}{2}) \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = (\\frac{1}{2}, \\frac{1}{2}) = \\pi$。\n\n接下来，我们确定该链的周期。状态 $i$ 的周期是所有可能的返回时间集合 $\\{n \\geq 1 : P^n(i, i)  0\\}$ 的最大公约数 (GCD)。我们计算 $P$ 的幂：\n$$\nP^2 = P \\cdot P = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I.\n$$\n由此可知，当 $n$ 为奇数时 $P^n = P$，当 $n$ 为偶数时 $P^n = I$。\n对于状态 $0$，返回时间的集合是 $\\{n \\geq 1 : P^n(0,0)  0\\} = \\{2, 4, 6, \\dots\\}$。该集合的最大公约数是 $2$。\n对于状态 $1$，返回时间的集合是 $\\{n \\geq 1 : P^n(1,1)  0\\} = \\{2, 4, 6, \\dots\\}$。该集合的最大公约数也是 $2$。\n由于可以在任意两个状态之间转移，该链是不可约的。因此，所有状态具有相同的周期，该链的周期为 $d=2$。\n给定初始状态 $X_0$，链的轨迹 $\\{X_t\\}_{t\\geq 0}$ 是确定性的。以概率 $1$，$X_{t+1}=1$ 如果 $X_t=0$，且 $X_{t+1}=0$ 如果 $X_t=1$。状态在每一步都会翻转。这意味着对于任何源于 $X_0$ 的实现，其轨迹由 $X_t = (X_0 + t) \\pmod 2$ 给出。\n\n现在，我们分析剩余类遍历均值 $A_{n}^{(r)} = \\frac{1}{n}\\sum_{t=0}^{n-1} f(X_{2t+r})$，其中 $r \\in \\{0,1\\}$，$f(0)=\\alpha$ 且 $f(1)=\\beta$。\n对于从 $X_0$ 开始的给定轨迹，在时间 $2t+r$ 的状态是\n$$\nX_{2t+r} = (X_0 + (2t+r)) \\pmod 2 = (X_0 + r) \\pmod 2.\n$$\n这个值对于所有 $t \\geq 0$ 都是恒定的，且仅取决于初始状态 $X_0$ 和剩余类 $r$。我们将这个恒定状态称为 $x^*(X_0, r) = (X_0 + r) \\pmod 2$。\n那么对于给定的路径，均值 $A_{n}^{(r)}$ 为\n$$\nA_{n}^{(r)} = \\frac{1}{n} \\sum_{t=0}^{n-1} f(x^*(X_0, r)) = f(x^*(X_0, r)).\n$$\n对于任何特定轨迹，序列 $\\{A_n^{(r)}\\}_{n \\geq 1}$ 是恒定的。因此，它几乎必然收敛到该恒定值。几乎必然极限是：\n$$\n\\lim_{n\\to\\infty} A_{n}^{(r)} = f((X_0+r) \\pmod 2).\n$$\n这个极限是一个随机变量，取决于随机的初始状态 $X_0$：\n对于 $r=0$：$\\lim_{n\\to\\infty} A_n^{(0)} = f(X_0)$。如果 $X_0=0$，则为 $\\alpha$；如果 $X_0=1$，则为 $\\beta$。\n对于 $r=1$：$\\lim_{n\\to\\infty} A_n^{(1)} = f((X_0+1) \\pmod 2)$。如果 $X_0=0$，则为 $f(1)=\\beta$；如果 $X_0=1$，则为 $f(0)=\\alpha$。\n如果 $\\alpha \\neq \\beta$，这些极限不重合。此外，平稳期望为 $\\mathbb{E}_{\\pi}[f] = \\sum_{x \\in \\{0,1\\}} \\pi(x)f(x) = \\frac{1}{2}f(0) + \\frac{1}{2}f(1) = \\frac{\\alpha+\\beta}{2}$。极限 $\\alpha$ 和 $\\beta$ 不等于 $\\frac{\\alpha+\\beta}{2}$（除非 $\\alpha=\\beta$）。这种未能收敛到等于平稳期望的确定性极限是周期性链的标志。剩余类采样仅在循环置换的状态集之一上观察过程，导致有偏的、路径依赖的结果。\n\n最后，我们分析周期平均的遍历均值 $\\overline{A}_{n} = \\frac{1}{2}\\sum_{r=0}^{1} A_{n}^{(r)}$。我们寻求其几乎必然极限。利用极限的线性性质：\n$$\n\\lim_{n\\to\\infty} \\overline{A}_{n} = \\text{a.s.-}\\lim_{n\\to\\infty} \\frac{1}{2}(A_n^{(0)} + A_n^{(1)}) = \\frac{1}{2} \\left( \\text{a.s.-}\\lim_{n\\to\\infty} A_n^{(0)} + \\text{a.s.-}\\lim_{n\\to\\infty} A_n^{(1)} \\right).\n$$\n我们根据初始状态 $X_0$ 来评估此极限。\n如果 $X_0=0$：$A_n^{(0)}$ 和 $A_n^{(1)}$ 的极限分别为 $\\alpha$ 和 $\\beta$。因此，$\\lim_{n\\to\\infty} \\overline{A}_{n} = \\frac{1}{2}(\\alpha + \\beta)$。\n如果 $X_0=1$：$A_n^{(0)}$ 和 $A_n^{(1)}$ 的极限分别为 $\\beta$ 和 $\\alpha$。因此，$\\lim_{n\\to\\infty} \\overline{A}_{n} = \\frac{1}{2}(\\beta + \\alpha)$。\n在这两种情况下，极限是相同的。因此，$\\overline{A}_{n}$ 的几乎必然极限是确定性的，由 $\\frac{\\alpha+\\beta}{2}$ 给出，而与初始分布无关。这个极限等于平稳期望 $\\mathbb{E}_{\\pi}[f]$。通过对整个周期进行平均，我们正确地恢复了遍历性。注意，$\\overline{A}_n$ 可以表示为标准时间平均：\n$$\n\\overline{A}_{n} = \\frac{1}{2n} \\left(\\sum_{t=0}^{n-1} f(X_{2t}) + \\sum_{t=0}^{n-1} f(X_{2t+1})\\right) = \\frac{1}{2n} \\sum_{k=0}^{2n-1} f(X_k).\n$$\n这表明即使对于这个周期性链，标准遍历均值也收敛于平稳期望。\n该极限的闭式表达式为 $\\frac{\\alpha+\\beta}{2}$。",
            "answer": "$$\n\\boxed{\\frac{\\alpha+\\beta}{2}}\n$$"
        }
    ]
}