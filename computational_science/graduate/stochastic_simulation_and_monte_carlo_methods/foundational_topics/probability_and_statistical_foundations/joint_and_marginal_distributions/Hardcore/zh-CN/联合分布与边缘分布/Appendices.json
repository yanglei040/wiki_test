{
    "hands_on_practices": [
        {
            "introduction": "在随机模拟中，我们常常需要从一个已知的分布中生成随机变量，然后通过函数变换得到我们真正感兴趣的变量。这个练习将带你实践核心的变量变换技术 。通过计算雅可比行列式并确定新变量的支撑集，你将推导出变换后变量的联合与边缘密度，这是随机变量函数分布理论中的一项基本功。",
            "id": "3315512",
            "problem": "设 $(U,V)$ 为一对随机变量，其联合概率密度函数为 $f_{U,V}(u,v)=2\\,\\mathbf{1}\\{0\\le v\\le u\\le 1\\}$。考虑由 $X=U$ 和 $Y=U\\,V$ 定义的到 $(X,Y)$ 的变换。仅使用光滑双射变换下的联合密度定义以及通过积分进行边缘化的定义，推导联合密度 $f_{X,Y}(x,y)$，包括其精确的支撑集。然后通过对 $x$ 积分来计算边缘密度 $f_Y(y)$。请将您的最终答案表示为 $f_Y(y)$ 的单个简化后的闭式解析表达式。最终答案中不要提供中间结果。无需四舍五入。",
            "solution": "首先验证问题以确保其是适定且科学上合理的。\n\n问题给出了两个随机变量 $(U,V)$ 的联合概率密度函数 (PDF)，为 $f_{U,V}(u,v) = 2\\,\\mathbf{1}\\{0\\le v\\le u\\le 1\\}$。符号 $\\mathbf{1}\\{\\cdot\\}$ 表示指示函数。该分布的支撑集是三角形区域 $\\mathcal{S}_{U,V} = \\{(u,v) \\in \\mathbb{R}^2 \\mid 0 \\le v \\le u \\le 1\\}$。\n要成为一个有效的 PDF，函数必须是非负的，并且其在支撑集上的积分必须等于 $1$。\n函数 $f_{U,V}(u,v)$ 在其支撑集上为 $2$，在其他地方为 $0$，因此它是非负的。\n积分为：\n$$ \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} f_{U,V}(u,v) \\,dv\\,du = \\int_0^1 \\int_0^u 2 \\,dv\\,du $$\n$$ = \\int_0^1 [2v]_{v=0}^{v=u} \\,du = \\int_0^1 2u \\,du = [u^2]_0^1 = 1^2 - 0^2 = 1 $$\n该 PDF 是有效的。问题陈述是自洽的、无歧义的，并且提出了概率论中的一个标准问题。因此，该问题是有效的，我们可以继续进行求解。\n\n任务是求随机变量 $Y = UV$ 的边缘密度 $f_Y(y)$，其中变换从 $(U,V)$ 到 $(X,Y)$ 定义为 $X=U$ 和 $Y=UV$。这将分两步完成：首先，使用变量替换法求出联合 PDF $f_{X,Y}(x,y)$；其次，通过对 $x$ 积分 $f_{X,Y}(x,y)$ 来求出边缘 PDF $f_Y(y)$。\n\n**步骤 1：推导联合密度 $f_{X,Y}(x,y)$**\n\n从 $(U,V)$ 到 $(X,Y)$ 的变换由以下函数给出：\n$x = g_1(u,v) = u$\n$y = g_2(u,v) = uv$\n\n为了使用变量替换公式，我们首先需要找到逆变换，该变换将 $(u,v)$ 表示为 $(x,y)$ 的函数。\n从 $x=u$，我们立即得到 $u=x$。\n将此代入第二个方程 $y = xv$，得到 $v = y/x$。\n所以，逆变换为：\n$u = h_1(x,y) = x$\n$v = h_2(x,y) = y/x$\n\n接下来，我们计算这个逆变换的雅可比行列式。雅可比矩阵是：\n$$ J = \\begin{pmatrix} \\frac{\\partial u}{\\partial x}  \\frac{\\partial u}{\\partial y} \\\\ \\frac{\\partial v}{\\partial x}  \\frac{\\partial v}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(x)  \\frac{\\partial}{\\partial y}(x) \\\\ \\frac{\\partial}{\\partial x}(y/x)  \\frac{\\partial}{\\partial y}(y/x) \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ -y/x^2  1/x \\end{pmatrix} $$\n雅可比矩阵的行列式是：\n$$ \\det(J) = (1)\\left(\\frac{1}{x}\\right) - (0)\\left(-\\frac{y}{x^2}\\right) = \\frac{1}{x} $$\n雅可比行列式的绝对值为 $|\\det(J)| = |1/x|$。\n\n现在，我们确定新变量 $(X,Y)$ 的支撑集，记为 $\\mathcal{S}_{X,Y}$。该区域是支撑集 $\\mathcal{S}_{U,V}$ 在该变换下的像。$\\mathcal{S}_{U,V}$ 的约束条件是 $0 \\le v \\le u \\le 1$。我们代入 $u$ 和 $v$ 的逆变换表达式：\n$1$. $u \\le 1 \\implies x \\le 1$\n$2$. $v \\le u \\implies y/x \\le x \\implies y \\le x^2$ (假设 $x  0$)\n$3$. $v \\ge 0 \\implies y/x \\ge 0 \\implies y \\ge 0$ (假设 $x  0$)\n条件 $u \\ge 0$ 意味着 $x \\ge 0$。与 $x \\le 1$ 结合，我们得到 $0 \\le x \\le 1$。\n由于 $x=u$ 且 $u \\ge v \\ge 0$，$x$ 必须是非负的。在支撑集的内部，$u0$，因此 $x0$，所以乘以 $x$ 的操作是有效的。$x=0$ 的情况对应于 $u=0$，这意味着 $v=0$，因此 $y=0$。这是一个单点 $(0,0)$，其概率质量为零。因此，为了计算密度，我们可以安全地假设 $x0$，这使得 $|\\det(J)| = 1/x$。\n\n因此 $(X,Y)$ 的支撑集由不等式定义：$0 \\le x \\le 1$ 和 $0 \\le y \\le x^2$。这可以紧凑地写为 $\\mathcal{S}_{X,Y} = \\{(x,y) \\in \\mathbb{R}^2 \\mid 0 \\le y \\le x^2 \\le 1\\}$。\n\n联合 PDF 的变量替换公式是：\n$$ f_{X,Y}(x,y) = f_{U,V}(u(x,y), v(x,y)) |\\det(J)| $$\n代入 $u,v$ 的表达式、$f_{U,V}$ 的值（在其支撑集上为 $2$）以及 $|\\det(J)|$：\n$$ f_{X,Y}(x,y) = 2 \\cdot \\frac{1}{x} = \\frac{2}{x} $$\n此表达式对于 $(x,y) \\in \\mathcal{S}_{X,Y}$ 有效。所以，$(X,Y)$ 的完整联合 PDF 是：\n$$ f_{X,Y}(x,y) = \\frac{2}{x} \\mathbf{1}\\{0 \\le y \\le x^2 \\le 1\\} $$\n\n**步骤 2：推导边缘密度 $f_Y(y)$**\n\n$Y$ 的边缘 PDF 是通过对联合 PDF $f_{X,Y}(x,y)$ 的所有可能 $x$ 值进行积分得到的：\n$$ f_Y(y) = \\int_{-\\infty}^{\\infty} f_{X,Y}(x,y) \\,dx $$\n为了执行这个积分，我们需要对于固定的 $y$ 值确定 $x$ 的积分限。从支撑集 $\\mathcal{S}_{X,Y}$ 可知，不等式为 $0 \\le y \\le x^2$ 和 $x \\le 1$。\n第一个不等式 $y \\le x^2$ 意味着 $x \\ge \\sqrt{y}$ (因为 $x \\ge 0$)。\n第二个不等式是 $x \\le 1$。\n所以，对于固定的 $y$，$x$ 的范围是从 $\\sqrt{y}$ 到 $1$。\n$y$ 的可能范围也可以从支撑集中确定。由于 $y \\ge 0$ 且 $y \\le x^2 \\le 1^2=1$，我们得到 $0 \\le y \\le 1$。\n\n对于任何 $y \\in [0,1]$，积分为：\n$$ f_Y(y) = \\int_{\\sqrt{y}}^{1} \\frac{2}{x} \\,dx $$\n这是一个标准积分：\n$$ f_Y(y) = [2 \\ln|x|]_{\\sqrt{y}}^{1} $$\n由于 $x$ 在区间 $[\\sqrt{y}, 1]$ 上积分，其中 $y \\in [0,1]$，$x$ 总是正的，所以 $|x|=x$。\n$$ f_Y(y) = 2 (\\ln(1) - \\ln(\\sqrt{y})) $$\n使用对数性质 $\\ln(1)=0$ 和 $\\ln(\\sqrt{y}) = \\ln(y^{1/2}) = \\frac{1}{2}\\ln(y)$：\n$$ f_Y(y) = 2 \\left(0 - \\frac{1}{2}\\ln(y)\\right) = -\\ln(y) $$\n这个表达式对 $y \\in (0,1]$ 有效。对于 $y \\le 0$ 或 $y  1$，$f_Y(y)=0$。问题要求的是解析表达式，即 $-\\ln(y)$。\n作为检验，我们可以验证 $\\int_0^1 f_Y(y) \\,dy = 1$：\n$$ \\int_0^1 -\\ln(y) \\,dy $$\n使用分部积分法，设 $u = -\\ln(y)$ 和 $dv = dy$，所以 $du = -1/y \\,dy$ 且 $v=y$：\n$$ \\int_0^1 -\\ln(y) \\,dy = [-y\\ln(y)]_0^1 - \\int_0^1 y\\left(-\\frac{1}{y}\\right) \\,dy $$\n$$ = [-y\\ln(y)]_0^1 + \\int_0^1 1 \\,dy $$\n极限 $\\lim_{y \\to 0^+} y\\ln(y) = 0$。在 $y=1$ 处，$-1\\ln(1)=0$。所以第一项的值为 $0$。第二项是 $[y]_0^1=1$。总和是 $0+1=1$，这证实了边缘密度是正确的。\n\n$f_Y(y)$ 的最终简化闭式解析表达式是 $-\\ln(y)$。",
            "answer": "$$\\boxed{-\\ln(y)}$$"
        },
        {
            "introduction": "通常我们认为随机变量间的相关性或依赖性可以用联合概率密度函数来刻画，但这个练习将挑战这一直观想法。本题构建了一个随机向量，其分量之间存在着完全的函数依赖关系，但其联合分布却不存在关于二维勒贝格测度的密度函数 。这个看似矛盾的例子旨在深化你对分布、密度和支撑集之间关系的理解，揭示随机变量依赖性的更深层本质。",
            "id": "3315509",
            "problem": "设 $X$ 是一个实值随机变量，其概率密度函数 (PDF) $f_{X}(x)$ 为均值为 $1$、方差为 $1$ 的正态密度，即 $f_{X}(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\!\\big(-\\frac{(x-1)^{2}}{2}\\big)$。定义可测映射 $T:\\mathbb{R}\\to\\mathbb{R}^{2}$ 为 $T(x) = (x,x^{2})$，并设 $(X,Y) := T(X) = (X, X^{2})$。用 $\\mu$ 表示 $(X,Y)$ 在 $\\mathbb{R}^{2}$ 上的联合律，即 $\\mu = \\mathbb{P}\\circ T^{-1}$。设 $\\lambda_{1}$ 和 $\\lambda_{2}$ 分别表示一维和二维勒贝格测度。\n\n任务：\n- 仅使用基础的测度论定义（前推测度、绝对连续性和奇异性），构造 $(X,Y)$ 的联合分布 $\\mu$，并证明 $\\mu$ 的支撑集为集合 $\\{(x,y)\\in\\mathbb{R}^{2}: y = x^{2}\\}$，其关于 $\\lambda_{2}$ 没有联合密度，但关于 $\\lambda_{1}$ 却有良定义的边缘分布。\n- 从累积分布函数 (CDF) 的定义和微分链式法则出发，推导当 $y0$ 时 $Y$ 的概率密度函数 (PDF)。\n- 将得到的 $Y$ 的边缘密度在 $y=1$ 处的值表示为闭式表达式。请以单个解析表达式的形式提供最终答案。不要进行近似；无需四舍五入。",
            "solution": "该问题提法良好，具有科学依据，并提供了推导唯一且有意义解所需的所有信息。这些任务要求严格应用测度论、概率论和微积分。\n\n该问题要求三项内容：对联合分布进行测度论分析，推导边缘概率密度函数 (PDF)，以及在特定点计算此 PDF 的值。我们将按顺序解决这些问题。\n\n设 $X$ 是一个随机变量，服从均值为 $\\mu_X = 1$、方差为 $\\sigma_X^2 = 1$ 的正态分布。其 PDF 由 $f_{X}(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-1)^{2}}{2}\\right)$ 给出。设 $P_X$ 为 $X$ 的律，它是 $(\\mathbb{R}, \\mathcal{B}(\\mathbb{R}))$ 上的一个测度。对于任何博雷尔集 $B \\subseteq \\mathbb{R}$，$P_X(B) = \\mathbb{P}(X \\in B) = \\int_B f_X(x) \\, d\\lambda_1(x)$，其中 $\\lambda_1$ 是一维勒贝格测度。这表明 $P_X$ 关于 $\\lambda_1$ 是绝对连续的。\n\n随机向量 $(X,Y)$ 由可测变换 $T:\\mathbb{R} \\to \\mathbb{R}^2$，$T(x) = (x, x^2)$ 定义，使得 $(X,Y) = T(X)$。$(X,Y)$ 的联合分布 $\\mu$ 是 $P_X$ 在 $T$ 下的前推测度。\n\n_任务1：联合分布 $\\mu$ 的测度论分析_\n\n- **$\\mu$ 的构造**：\n根据前推测度的定义，对于任何博雷尔集 $A \\subseteq \\mathbb{R}^2$，测度 $\\mu(A)$ 由下式给出：\n$$ \\mu(A) = P_X(T^{-1}(A)) $$\n其中 $T^{-1}(A) = \\{x \\in \\mathbb{R} \\mid T(x) \\in A\\} = \\{x \\in \\mathbb{R} \\mid (x, x^2) \\in A\\}$。\n由于 $P_X$ 相对于 $\\lambda_1$ 存在密度 $f_X$，我们可以将 $\\mu(A)$ 写成积分形式：\n$$ \\mu(A) = \\int_{T^{-1}(A)} f_X(x) \\, d\\lambda_1(x) $$\n这个积分表达式就是联合分布 $\\mu$ 的构造。\n\n- **$\\mu$ 的支撑集**：\n一个测度的支撑集是满足 $\\mu(\\mathbb{R}^2 \\setminus S) = 0$ 的最小闭集 $S$。令 $C$ 为由 $C = \\{(x,y) \\in \\mathbb{R}^2 \\mid y=x^2\\}$ 定义的抛物线。集合 $C$ 是 $\\mathbb{R}^2$ 中的一个闭集。根据定义，随机向量 $(X,Y)=(X,X^2)$ 总是位于这条抛物线上。因此，$\\mu$ 的全部概率质量都集中在 $C$ 上。我们可以正式地证明这一点：\n$$ \\mu(C) = \\mathbb{P}((X,Y) \\in C) = \\mathbb{P}((X, X^2) \\in C) = \\mathbb{P}(\\text{true}) = 1 $$\n由于 $\\mu(C)=1$，$\\mu$ 的支撑集必定是 $C$ 的子集。为了证明支撑集恰好是 $C$，我们必须证明对于任何点 $p \\in C$ 和 $p$ 的任何开邻域 $U$，都有 $\\mu(U)  0$。设 $p = (x_0, x_0^2) \\in C$，并设 $U$ 是包含 $p$ 的一个开集。函数 $T(x)=(x, x^2)$ 是连续的，所以原像 $T^{-1}(U)$ 是 $\\mathbb{R}$ 中的一个开集。因为 $(x_0, x_0^2) \\in U$，我们有 $x_0 \\in T^{-1}(U)$，所以 $T^{-1}(U)$ 非空。$\\mathbb{R}$ 中任何非空开集的勒贝格测度都为正，即 $\\lambda_1(T^{-1}(U))  0$。密度函数 $f_X(x)$ 对所有 $x \\in \\mathbb{R}$ 都是严格为正的。因此，\n$$ \\mu(U) = \\int_{T^{-1}(U)} f_X(x) \\, d\\lambda_1(x)  0 $$\n这证实了 $\\mu$ 的支撑集正是抛物线 $C = \\{(x,y) \\in \\mathbb{R}^2 \\mid y=x^2\\}$。\n\n- **关于 $\\lambda_2$ 不存在联合密度**：\n$\\mathbb{R}^2$ 上的测度 $\\mu$ 存在关于二维勒贝格测度 $\\lambda_2$ 的密度的充要条件是 $\\mu$ 关于 $\\lambda_2$ 绝对连续 ($\\mu \\ll \\lambda_2$)。这意味着对于任何博雷尔集 $A \\subseteq \\mathbb{R}^2$，如果 $\\lambda_2(A)=0$，那么 $\\mu(A)=0$。\n考虑集合 $C$，即 $\\mu$ 的支撑集。作为连续函数的图像，$C$ 是 $\\mathbb{R}^2$ 中的一条曲线，其 $\\lambda_2$-测度为零，即 $\\lambda_2(C)=0$。然而，如上所示，$\\mu(C)=1$。\n因为我们找到了一个集合 $C$，使得 $\\lambda_2(C)=0$ 但 $\\mu(C)=1 \\neq 0$，所以绝对连续性的条件被违反了。因此，根据拉东-尼科迪姆定理，测度 $\\mu$ 不存在关于 $\\lambda_2$ 的密度。$(X,Y)$ 的分布相对于二维勒贝格测度是奇异的。\n\n- **良定义的边缘分布**：\n$X$ 的边缘分布，记为 $\\mu_X$，对于博雷尔集 $B \\subseteq \\mathbb{R}$，由 $\\mu_X(B) = \\mu(B \\times \\mathbb{R})$ 给出。\n$$ \\mu_X(B) = \\mathbb{P}((X,Y) \\in B \\times \\mathbb{R}) = \\mathbb{P}(X \\in B) = P_X(B) $$\n根据题意，$P_X$ 存在关于 $\\lambda_1$ 的密度 $f_X(x)$。因此，$X$ 的边缘分布是良定义的，并且关于 $\\lambda_1$ 是绝对连续的。\n\n$Y$ 的边缘分布，记为 $\\mu_Y$，对于博雷尔集 $A \\subseteq \\mathbb{R}$，由 $\\mu_Y(A) = \\mu(\\mathbb{R} \\times A)$ 给出。\n$$ \\mu_Y(A) = \\mathbb{P}((X,Y) \\in \\mathbb{R} \\times A) = \\mathbb{P}(Y \\in A) $$\n在下一个任务中，我们将推导 $Y$ 的 PDF $f_Y(y)$。这个 PDF 的存在表明 $\\mu_Y$ 也关于 $\\lambda_1$ 绝对连续。因此，两个边缘分布都是良定义的，并且都存在关于 $\\lambda_1$ 的密度。\n\n_任务2：推导当 $y0$ 时 $Y$ 的 PDF_\n\n我们使用累积分布函数 (CDF) 法来推导 $Y=X^2$ 的 PDF。设 $F_Y(y)$ 为 $Y$ 的 CDF。\n$$ F_Y(y) = \\mathbb{P}(Y \\le y) $$\n由于 $Y=X^2$，$Y$ 是非负的，因此当 $y  0$ 时 $F_Y(y) = 0$。题目要求我们求 $y0$ 时的 PDF。\n对于 $y  0$：\n$$ F_Y(y) = \\mathbb{P}(X^2 \\le y) = \\mathbb{P}(-\\sqrt{y} \\le X \\le \\sqrt{y}) $$\n这个概率可以表示为 $X$ 的 PDF 的积分：\n$$ F_Y(y) = \\int_{-\\sqrt{y}}^{\\sqrt{y}} f_X(x) \\, dx $$\nPDF $f_Y(y)$ 是 CDF 的导数，即 $f_Y(y) = \\frac{d}{dy}F_Y(y)$。我们使用莱布尼茨积分法则，这是按要求应用的微积分基本定理和链式法则：\n$$ f_Y(y) = \\frac{d}{dy} \\int_{-\\sqrt{y}}^{\\sqrt{y}} f_X(x) \\, dx = f_X(\\sqrt{y}) \\cdot \\frac{d}{dy}(\\sqrt{y}) - f_X(-\\sqrt{y}) \\cdot \\frac{d}{dy}(-\\sqrt{y}) $$\n积分限的导数为 $\\frac{d}{dy}(\\sqrt{y}) = \\frac{1}{2\\sqrt{y}}$ 和 $\\frac{d}{dy}(-\\sqrt{y}) = -\\frac{1}{2\\sqrt{y}}$。\n将这些代入 $f_Y(y)$ 的表达式中：\n$$ f_Y(y) = f_X(\\sqrt{y}) \\left(\\frac{1}{2\\sqrt{y}}\\right) - f_X(-\\sqrt{y}) \\left(-\\frac{1}{2\\sqrt{y}}\\right) = \\frac{1}{2\\sqrt{y}} \\left[ f_X(\\sqrt{y}) + f_X(-\\sqrt{y}) \\right] $$\n现在，我们代入 $X$ 的具体 PDF，$f_X(x) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(x-1)^2}{2}\\right)$：\n$$ f_X(\\sqrt{y}) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\sqrt{y}-1)^2}{2}\\right) $$\n$$ f_X(-\\sqrt{y}) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(-\\sqrt{y}-1)^2}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(\\sqrt{y}+1)^2}{2}\\right) $$\n将它们合并得到：\n$$ f_Y(y) = \\frac{1}{2\\sqrt{y}} \\frac{1}{\\sqrt{2\\pi}} \\left[ \\exp\\left(-\\frac{y-2\\sqrt{y}+1}{2}\\right) + \\exp\\left(-\\frac{y+2\\sqrt{y}+1}{2}\\right) \\right] $$\n$$ f_Y(y) = \\frac{1}{2\\sqrt{2\\pi y}} \\exp\\left(-\\frac{y+1}{2}\\right) \\left[ \\exp\\left(\\sqrt{y}\\right) + \\exp\\left(-\\sqrt{y}\\right) \\right] $$\n使用恒等式 $\\cosh(z) = \\frac{\\exp(z)+\\exp(-z)}{2}$，我们有 $2\\cosh(\\sqrt{y}) = \\exp(\\sqrt{y}) + \\exp(-\\sqrt{y})$。\n$$ f_Y(y) = \\frac{1}{2\\sqrt{2\\pi y}} \\exp\\left(-\\frac{y+1}{2}\\right) [2\\cosh(\\sqrt{y})] $$\n$$ f_Y(y) = \\frac{1}{\\sqrt{2\\pi y}} \\exp\\left(-\\frac{y+1}{2}\\right) \\cosh(\\sqrt{y}) $$\n这是当 $y0$ 时 $Y$ 的 PDF。这对应于自由度为1、非中心参数为 $\\lambda=1$ 的非中心卡方分布。\n\n_任务3：在 $y=1$ 处计算 $Y$ 的边缘密度_\n\n我们需要在 $y=1$ 处计算 $f_Y(y)$ 的值。\n$$ f_Y(1) = \\frac{1}{\\sqrt{2\\pi(1)}} \\exp\\left(-\\frac{1+1}{2}\\right) \\cosh(\\sqrt{1}) $$\n$$ f_Y(1) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-1) \\cosh(1) $$\n为了得到用初等指数函数表示的闭式表达式，我们使用双曲余弦函数的定义：$\\cosh(1) = \\frac{\\exp(1) + \\exp(-1)}{2}$。\n$$ f_Y(1) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-1) \\left( \\frac{\\exp(1) + \\exp(-1)}{2} \\right) $$\n$$ f_Y(1) = \\frac{1}{2\\sqrt{2\\pi}} \\left( \\exp(-1)\\exp(1) + \\exp(-1)\\exp(-1) \\right) $$\n$$ f_Y(1) = \\frac{1}{2\\sqrt{2\\pi}} \\left( \\exp(0) + \\exp(-2) \\right) $$\n$$ f_Y(1) = \\frac{1 + \\exp(-2)}{2\\sqrt{2\\pi}} $$\n这是最终的解析表达式。",
            "answer": "$$\\boxed{\\frac{1 + \\exp(-2)}{2\\sqrt{2\\pi}}}$$"
        },
        {
            "introduction": "联合分布与边缘分布是构建复杂统计模型的基石，高斯混合模型（GMM）便是一个绝佳范例。这个练习将指导你如何通过引入一个离散的隐变量来构建一个能够描述多峰数据的灵活模型 。你需要从第一性原理出发，推导观测数据与隐变量的联合分布，然后通过对隐变量进行边缘化（在此为求和），得到我们实际观测到的数据的边缘分布，即混合密度。",
            "id": "3315548",
            "problem": "考虑一个用于随机模拟和蒙特卡洛方法中潜变量抽样的混合模型。设 $X \\in \\mathbb{R}^{d}$ 为一个连续随机向量，$Z \\in \\{1,2,\\dots,K\\}$ 为一个分类潜变量。假设 $P(Z=k)=\\pi_{k}$，其中 $\\pi_{k}0$ 且 $\\sum_{k=1}^{K}\\pi_{k}=1$。条件地，$X \\mid Z=k$ 服从多元正态分布，其均值为 $\\mu_{k} \\in \\mathbb{R}^{d}$，协方差矩阵为 $\\Sigma_{k} \\in \\mathbb{R}^{d \\times d}$，且对每个 $k$ 都是对称正定的。请构建 $(X,Z)$ 关于 $d$ 维勒贝格测度与集合 $\\{1,\\dots,K\\}$ 上计数测度的乘积测度的联合分布，并推导其联合概率密度函数 (PDF) $f_{X,Z}(x,k)$ 以及 $X$ 的边缘概率密度函数 $f_{X}(x)$。推导过程应从联合分布和边缘分布的形式化定义以及全概率定律出发，并明确指出混合离散-连续变量的支配测度。除了基本定义和经过验证的公式外，您的推导不应假设任何快捷恒等式。最终答案必须以闭式解析表达式的形式给出。不需要进行数值近似或四舍五入。",
            "solution": "该问题陈述是一个形式良好且具有科学依据的请求，旨在推导高斯混合模型的联合与边缘概率密度函数。所有给定的条件都是标准的、完备的且一致的。因此，该问题是有效的。\n\n该问题考虑了一个混合随机变量 $(X, Z)$，其中 $X$ 是 $\\mathbb{R}^{d}$ 中的一个连续随机向量，$Z$ 是一个在集合 $\\{1, 2, \\dots, K\\}$ 中取值的离散（分类）随机变量。\n\n首先，我们必须定义联合变量 $(X,Z)$ 的样本空间，即乘积空间 $\\mathbb{R}^{d} \\times \\{1, 2, \\dots, K\\}$。要为此类混合型变量定义密度函数，我们必须指定一个支配测度。按照要求，我们使用乘积测度 $\\lambda^{d} \\otimes \\nu$，其中 $\\lambda^{d}$ 是 $\\mathbb{R}^{d}$ 上的 $d$ 维勒贝格测度，$\\nu$ 是有限集 $\\{1, 2, \\dots, K\\}$ 上的计数测度。联合概率密度函数 (PDF) $f_{X,Z}(x,k)$ 是关于此乘积测度定义的。对于任何可测集 $A \\subseteq \\mathbb{R}^{d}$ 和任何子集 $B \\subseteq \\{1, 2, \\dots, K\\}$，其概率由下式给出：\n$$\nP(X \\in A, Z \\in B) = \\sum_{k \\in B} \\int_{A} f_{X,Z}(x,k) \\, d\\lambda^{d}(x)\n$$\n\n联合概率密度函数 $f_{X,Z}(x,k)$ 的推导遵循概率密度的链式法则，该法则指出，联合密度是一个变量的边缘密度与另一个变量的条件密度的乘积。\n$$\nf_{X,Z}(x,k) = f_{X|Z}(x|k) p_{Z}(k)\n$$\n此处，$p_{Z}(k)$ 是离散变量 $Z$ 的概率质量函数 (PMF)，而 $f_{X|Z}(x|k)$ 是在 $Z=k$ 的条件下 $X$ 的条件概率密度函数。\n\n根据问题陈述，我们有以下已知条件：\n$1$. $Z$ 的概率质量函数为 $p_{Z}(k) = P(Z=k) = \\pi_{k}$，其中对于所有 $k \\in \\{1, 2, \\dots, K\\}$ 都有 $\\pi_{k}  0$，且 $\\sum_{k=1}^{K} \\pi_{k} = 1$。\n$2$. 在 $Z=k$ 的条件下，$X$ 的条件分布是多元正态分布，$X \\mid (Z=k) \\sim \\mathcal{N}(\\mu_{k}, \\Sigma_{k})$。该分布的概率密度函数为：\n$$\nf_{X|Z}(x|k) = \\frac{1}{(2\\pi)^{d/2} \\sqrt{\\det(\\Sigma_{k})}} \\exp\\left(-\\frac{1}{2}(x-\\mu_{k})^{T}\\Sigma_{k}^{-1}(x-\\mu_{k})\\right)\n$$\n其中 $\\mu_{k} \\in \\mathbb{R}^{d}$ 是均值向量，$\\Sigma_{k} \\in \\mathbb{R}^{d \\times d}$ 是对称正定协方差矩阵。项 $\\det(\\Sigma_{k})$ 表示协方差矩阵的行列式。由于 $\\Sigma_k$ 是正定的，其行列式为严格正数。\n\n通过将这两个部分代入链式法则公式，我们得到联合概率密度函数 $f_{X,Z}(x,k)$ 的表达式：\n$$\nf_{X,Z}(x,k) = \\pi_{k} \\frac{1}{(2\\pi)^{d/2} \\sqrt{\\det(\\Sigma_{k})}} \\exp\\left(-\\frac{1}{2}(x-\\mu_{k})^{T}\\Sigma_{k}^{-1}(x-\\mu_{k})\\right)\n$$\n此函数是 $(X,Z)$ 关于勒贝格测度与计数测度之乘积测度的联合分布的密度。\n\n接下来，我们推导连续随机向量 $X$ 的边缘概率密度函数，记为 $f_{X}(x)$。根据全概率定律，边缘密度是通过对联合密度函数就另一个（或多个）变量的所有可能取值进行积分（对于离散变量，则是求和）得到的。对于我们的混合型分布，这涉及将 $f_{X,Z}(x,k)$ 对 $k$ 从 $1$ 到 $K$ 的所有可能值求和。\n$$\nf_{X}(x) = \\sum_{k=1}^{K} f_{X,Z}(x,k)\n$$\n当处理一个关于勒贝格测度与计数测度之乘积测度定义的密度时，此操作是边缘化掉离散变量 $Z$ 的正确方法。\n\n将我们刚刚推导出的联合概率密度函数 $f_{X,Z}(x,k)$ 的表达式代入求和式中，我们得到：\n$$\nf_{X}(x) = \\sum_{k=1}^{K} \\left( \\pi_{k} \\frac{1}{(2\\pi)^{d/2} \\sqrt{\\det(\\Sigma_{k})}} \\exp\\left(-\\frac{1}{2}(x-\\mu_{k})^{T}\\Sigma_{k}^{-1}(x-\\mu_{k})\\right) \\right)\n$$\n该表达式表示 $X$ 的边缘概率密度函数。它是 $K$ 个不同多元正态密度的加权和，其中权重是潜变量 $Z$ 的先验概率 $\\pi_{k}$。这是高斯混合模型（GMM）的定义方程。和式中的每一项对应于混合模型的一个分量。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nf_{X,Z}(x,k) = \\pi_{k} \\frac{1}{(2\\pi)^{d/2} \\sqrt{\\det(\\Sigma_{k})}} \\exp\\left(-\\frac{1}{2}(x-\\mu_{k})^{T}\\Sigma_{k}^{-1}(x-\\mu_{k})\\right) \\\\\nf_{X}(x) = \\sum_{k=1}^{K} \\pi_{k} \\frac{1}{(2\\pi)^{d/2} \\sqrt{\\det(\\Sigma_{k})}} \\exp\\left(-\\frac{1}{2}(x-\\mu_{k})^{T}\\Sigma_{k}^{-1}(x-\\mu_{k})\\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}