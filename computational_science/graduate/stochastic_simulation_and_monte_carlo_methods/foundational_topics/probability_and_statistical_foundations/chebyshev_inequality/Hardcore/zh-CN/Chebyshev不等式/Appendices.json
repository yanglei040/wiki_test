{
    "hands_on_practices": [
        {
            "introduction": "切比雪夫不等式因其普适性而非常强大，但它也常常因其界限过于宽松而受到批评。本练习提供了一种具体的方法来量化这种“宽松性”，通过将切比雪夫界与高斯分布的精确尾部概率进行比较——由于中心极限定理，高斯分布在统计学中无处不在。这项实践将帮助你建立直觉，理解该不等式在何种情况下有用，以及何时可能过于悲观。",
            "id": "3294065",
            "problem": "考虑一个实值随机变量 $X$，它服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯（正态）分布，记为 $X \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。在随机模拟和蒙特卡洛（MC）方法中，尾部边界用于控制估计量发生大偏差的概率。对于有界方差的随机变量，一个基本的不等式是 Chebyshev 不等式，它指出对于任何 $k>0$，\n$$\n\\mathbb{P}\\!\\left(|X-\\mu|\\geq k\\,\\sigma\\right)\\leq \\frac{1}{k^{2}}.\n$$\n请从第一性原理出发，计算高斯分布的实际双边尾部概率，然后将其与 Chebyshev 界进行比较。具体要求如下：\n- 从正态分布的概率密度函数出发，\n$$\nf_{X}(x)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right),\n$$\n并根据累积分布函数（CDF）的定义，推导对于任意 $k>0$ 的 $\\mathbb{P}(|X-\\mu|\\geq k\\,\\sigma)$ 的精确表达式。\n- 对阈值集合 $\\{k=1,\\,k=2,\\,k=3\\}$，计算这个精确的尾部概率。\n- 通过定义集合 $\\{1,2,3\\}$ 上的几何平均保守性指数来量化 Chebyshev 不等式的保守性，该指数定义为\n$$\nC:=\\left(\\prod_{k\\in\\{1,2,3\\}}\\frac{\\frac{1}{k^{2}}}{\\mathbb{P}\\!\\left(|X-\\mu|\\geq k\\,\\sigma\\right)}\\right)^{\\frac{1}{3}}.\n$$\n根据您推导出的尾部概率，精确计算 $C$。\n\n解释为什么在蒙特卡洛（MC）误差分析中，该指数能够捕捉 Chebyshev 界对于亚高斯分布尾部的典型乘性高估，并将此计算与高斯分布尾部的结构联系起来，除了核心定义和关于高斯积分的公认事实外，不使用任何快捷公式。\n\n将您最终的 $C$ 数值四舍五入到四位有效数字。答案无需单位。",
            "solution": "该问题是有效的，因为它在科学上基于概率论，问题设定良好，目标明确，数据充分，并且没有任何主观或模糊的陈述。\n\n该问题要求推导高斯随机变量的精确尾部概率，将此概率与 Chebyshev 不等式提供的界进行比较，并计算一个量化此差异的“保守性指数”。\n\n设 $X$ 是一个服从均值为 $\\mu$、方差为 $\\sigma^2$ 的高斯（正态）分布的随机变量，记为 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$。其概率密度函数（PDF）由下式给出\n$$f_{X}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)$$\n\n首先，我们推导对于某个常数 $k>0$ 的双边尾部概率 $\\mathbb{P}(|X-\\mu| \\geq k\\sigma)$ 的精确表达式。不等式 $|X - \\mu| \\geq k\\sigma$ 等价于两个不相交事件的并集：$(X - \\mu) \\geq k\\sigma$ 或 $(X - \\mu) \\leq -k\\sigma$。\n因此，该概率是这两个事件概率之和：\n$$\\mathbb{P}(|X - \\mu| \\geq k\\sigma) = \\mathbb{P}(X \\geq \\mu + k\\sigma) + \\mathbb{P}(X \\leq \\mu - k\\sigma)$$\n为简化计算，我们对随机变量 $X$ 进行标准化。令 $Z = \\frac{X - \\mu}{\\sigma}$。随机变量 $Z$ 服从标准正态分布 $Z \\sim \\mathcal{N}(0, 1)$，其概率密度函数为 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$。不等式 $|X - \\mu| \\geq k\\sigma$ 可以用 $Z$ 重写为：\n$$\\left|\\frac{X - \\mu}{\\sigma}\\right| \\geq k \\implies |Z| \\geq k$$\n概率变为\n$$\\mathbb{P}(|Z| \\geq k) = \\mathbb{P}(Z \\geq k) + \\mathbb{P}(Z \\leq -k)$$\n由于标准正态分布关于 $z=0$ 对称，我们有 $\\mathbb{P}(Z \\leq -k) = \\mathbb{P}(Z \\geq k)$。因此，\n$$\\mathbb{P}(|Z| \\geq k) = 2 \\, \\mathbb{P}(Z \\geq k)$$\n这个概率可以表示为标准正态 PDF 的积分：\n$$\\mathbb{P}(|Z| \\geq k) = 2 \\int_{k}^{\\infty} \\phi(z) \\, dz = 2 \\int_{k}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) dz$$\n该积分定义了标准正态分布的尾部概率。它通常用互补误差函数 $\\text{erfc}(x)$ 来表示，其定义为\n$$\\text{erfc}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_{x}^{\\infty} \\exp(-t^2) dt$$\n为了将我们的积分与此定义联系起来，我们在积分中进行变量替换。令 $t = z/\\sqrt{2}$。则 $z = \\sqrt{2}t$ 且 $dz = \\sqrt{2}dt$。积分下限 $z=k$ 变为 $t=k/\\sqrt{2}$。积分上限仍为无穷大。\n\\begin{align*} \\mathbb{P}(|X-\\mu| \\geq k\\sigma) &= 2 \\int_{k}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) dz \\\\ &= \\frac{2}{\\sqrt{2\\pi}} \\int_{k/\\sqrt{2}}^{\\infty} \\exp(-t^2) (\\sqrt{2}dt) \\\\ &= \\frac{2\\sqrt{2}}{\\sqrt{2\\pi}} \\int_{k/\\sqrt{2}}^{\\infty} \\exp(-t^2) dt \\\\ &= \\frac{2}{\\sqrt{\\pi}} \\int_{k/\\sqrt{2}}^{\\infty} \\exp(-t^2) dt \\end{align*}\n根据互补误差函数的定义，这恰好是 $\\text{erfc}(k/\\sqrt{2})$。\n因此，尾部概率的精确表达式为\n$$\\mathbb{P}(|X-\\mu| \\geq k\\sigma) = \\text{erfc}\\left(\\frac{k}{\\sqrt{2}}\\right)$$\n\n接下来，我们计算当 $k \\in \\{1, 2, 3\\}$ 时这个精确的概率。我们将这些概率记为 $P_k = \\mathbb{P}(|X-\\mu| \\geq k\\sigma)$。\n对于 $k=1$：\n$$P_1 = \\text{erfc}\\left(\\frac{1}{\\sqrt{2}}\\right) \\approx 0.3173105$$\n对于 $k=2$：\n$$P_2 = \\text{erfc}\\left(\\frac{2}{\\sqrt{2}}\\right) = \\text{erfc}(\\sqrt{2}) \\approx 0.0455003$$\n对于 $k=3$：\n$$P_3 = \\text{erfc}\\left(\\frac{3}{\\sqrt{2}}\\right) \\approx 0.0026998$$\n相应的 Chebyshev 界为 $1/k^2$：对于 $k=1$，界为 $1$；对于 $k=2$，界为 $1/4 = 0.25$；对于 $k=3$，界为 $1/9 \\approx 0.1111$。\n\n现在，我们计算几何平均保守性指数 $C$。\n$$C = \\left(\\prod_{k\\in\\{1,2,3\\}} \\frac{1/k^2}{P_k}\\right)^{1/3} = \\left( \\frac{1/1^2}{P_1} \\cdot \\frac{1/2^2}{P_2} \\cdot \\frac{1/3^2}{P_3} \\right)^{1/3}$$\n让我们计算各个比率，它们代表 Chebyshev 不等式高估真实概率的因子：\n对于 $k=1$ 的比率：$R_1 = \\frac{1}{P_1} = \\frac{1}{0.3173105} \\approx 3.15147$\n对于 $k=2$ 的比率：$R_2 = \\frac{1/4}{P_2} = \\frac{0.25}{0.0455003} \\approx 5.49448$\n对于 $k=3$ 的比率：$R_3 = \\frac{1/9}{P_3} = \\frac{1/9}{0.0026998} \\approx 41.1565$\n这些比率的乘积是\n$$R_1 \\cdot R_2 \\cdot R_3 \\approx 3.15147 \\times 5.49448 \\times 41.1565 \\approx 712.56$$\n指数 $C$ 是此乘积的立方根：\n$$C = (712.56)^{1/3} \\approx 8.93208$$\n四舍五入到四位有效数字，我们得到 $C \\approx 8.932$。\n\n保守性指数 $C$ 量化了 Chebyshev 不等式为高斯分布提供一个宽松界的程度。乘积中的每一项 $\\frac{1/k^2}{P_k}$ 都是 Chebyshev 界超过实际尾部概率的乘性因子。几何平均数是这些因子的合适平均值，因为它能反映在所选尺度 $k \\in \\{1, 2, 3\\}$ 上典型的过高估计程度。$C \\approx 8.932$ 的值表明，对于这些较小的 $k$ 值，平均而言，Chebyshev 界比真实的高斯尾部概率大将近一个数量级。\n\n这种显著差异的产生是因为 Chebyshev 不等式是普适的。它适用于任何具有有限方差的随机变量，而没有对其分布形状做任何进一步的假设。该界仅对将概率质量集中在远离均值、恰好在 $\\pm k\\sigma$ 边界上的“最坏情况”分布是“紧”的。高斯分布则根本不同；它是一种“亚高斯”分布，意味着其尾部以指数级快速衰减（具体为 $\\exp(-z^2/2)$）。这比 Chebyshev 界的代数衰减 $1/k^2$ 快得多。随着 $k$ 的增加，高估因子迅速增长，从 $R_1 \\approx 3.15$ 跳升至 $R_3 \\approx 41.16$ 即可见一斑。在蒙特卡洛（MC）误差分析的背景下，估计量通常是许多随机变量的总和，根据中心极限定理，它们的分布近似为高斯分布。使用 Chebyshev 不等式来界定大估计误差的概率将是极其悲观的。此计算表明，利用关于（近似）分布形状的知识可以得到更紧、更现实的误差界，这对于评估 MC 模拟的可靠性和效率至关重要。",
            "answer": "$$\n\\boxed{8.932}\n$$"
        },
        {
            "introduction": "应用切比雪夫不等式的一个主要挑战是它需要方差，而方差通常是未知的。本练习将解决蒙特卡洛方法中一个常见的情景：随机变量的取值范围是已知的有界区间。你将推导出一个强大的结果（Popoviciu 不等式）来确定最坏情况下的方差，并用它为均值构建一个有保证的置信区间，这是模拟分析中的一项基本任务。",
            "id": "3294078",
            "problem": "在一个蒙特卡洛估计场景中，设 $X$ 是一个标量随机变量，其分布未知，但支撑集为一个已知区间 $[a,b]$，其中 $a  b$。您的任务是为真实均值 $\\mu = \\mathbb{E}[X]$ 构建一个基于切比雪夫不等式的置信区间。您将通过对独立同分布（i.i.d.）样本 $X_1, \\dots, X_n$ 的样本均值 $\\overline{X}_{n} = \\frac{1}{n}\\sum_{i=1}^{n} X_i$ 进行中心化来构建该区间。\n\n从第一性原理出发，推导随机变量 $X$ 的方差 $\\sigma^2 = \\mathbb{V}\\mathrm{ar}(X)$ 的一个仅依赖于 $a$ 和 $b$ 的最紧上界。然后，将此上界与应用于样本均值 $\\overline{X}_n$ 的切比雪夫不等式结合起来，以确定一个双边对称置信区间 $[\\overline{X}_{n} - h, \\overline{X}_{n} + h]$ 的最小确定性半宽度 $h$。该区间必须确保真实均值 $\\mu$ 的覆盖概率至少为 $1-\\delta$，其中 $\\delta \\in (0, 1)$ 是预定的风险水平。\n\n您的最终答案应该是半宽度 $h(a,b,n,\\delta)$ 的解析表达式。",
            "solution": "用户要求我找到一个双边对称、基于切比雪夫不等式的随机变量 $X$ 均值 $\\mu$ 的置信区间的最小确定性半宽度 $h(a,b,n,\\delta)$。该区间的形式为 $[\\overline{X}_{n} - h, \\overline{X}_{n} + h]$，且其覆盖概率必须至少为 $1-\\delta$。随机变量 $X$ 的分布未知，但已知其支撑集在有限区间 $[a, b]$ 上。\n\n这个过程包括两个主要步骤：\n1.  推导方差 $\\sigma^2 = \\mathbb{V}\\mathrm{ar}(X)$ 的一个上界，该上界仅依赖于已知的区间端点 $a$ 和 $b$。\n2.  在应用于样本均值 $\\overline{X}_{n}$ 的切比雪夫不等式中使用此方差上界，以确定半宽度 $h$。\n\n首先，我们来推导 $\\sigma^2$ 的上界。$X$ 的方差定义为 $\\sigma^2 = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = \\mathbb{E}[X^2] - \\mu^2$。由于 $X$ 的支撑集是 $[a, b]$，可以保证 $a \\le X \\le b$。这意味着 $(X-a) \\ge 0$ 且 $(X-b) \\le 0$。因此，这两项的乘积必须是非正的：\n$$ (X-a)(X-b) \\le 0 $$\n展开不等式左侧，得到：\n$$ X^2 - (a+b)X + ab \\le 0 $$\n根据期望的线性性质，我们可以对这个不等式的两边取期望：\n$$ \\mathbb{E}[X^2 - (a+b)X + ab] \\le 0 $$\n$$ \\mathbb{E}[X^2] - (a+b)\\mathbb{E}[X] + ab \\le 0 $$\n代入 $\\mu = \\mathbb{E}[X]$，我们得到 $\\mathbb{E}[X^2]$ 的一个上界：\n$$ \\mathbb{E}[X^2] \\le (a+b)\\mu - ab $$\n现在，我们可以将这个上界代入方差的表达式中：\n$$ \\sigma^2 = \\mathbb{E}[X^2] - \\mu^2 \\le (a+b)\\mu - ab - \\mu^2 $$\n我们定义一个函数 $f(\\mu) = -\\mu^2 + (a+b)\\mu - ab$。为了找到 $\\sigma^2$ 最紧的上界，我们需要找到 $f(\\mu)$ 的最大值。函数 $f(\\mu)$ 是一个关于 $\\mu$ 的二次函数，表示一个开口向下的抛物线。其最大值出现在顶点处。顶点的 $\\mu$ 坐标是：\n$$ \\mu_{\\text{vertex}} = -\\frac{(a+b)}{2(-1)} = \\frac{a+b}{2} $$\n由于 $X$ 的支撑集在 $[a, b]$ 上，其均值 $\\mu$ 也必须位于这个区间内，即 $a \\le \\mu \\le b$。顶点 $\\mu = \\frac{a+b}{2}$ 是 $[a, b]$ 的中点，因此是均值的一个有效可能值。$f(\\mu)$ 的最大值在该顶点处取得：\n$$ \\max_{\\mu} f(\\mu) = f\\left(\\frac{a+b}{2}\\right) = -\\left(\\frac{a+b}{2}\\right)^2 + (a+b)\\left(\\frac{a+b}{2}\\right) - ab $$\n$$ = -\\frac{(a+b)^2}{4} + \\frac{2(a+b)^2}{4} - \\frac{4ab}{4} = \\frac{(a+b)^2 - 4ab}{4} = \\frac{a^2 + 2ab + b^2 - 4ab}{4} = \\frac{a^2 - 2ab + b^2}{4} = \\frac{(b-a)^2}{4} $$\n因此，我们得到了方差的上界，这被称为关于方差的波波维奇不等式 (Popoviciu's inequality on variances)：\n$$ \\sigma^2 \\le \\frac{(b-a)^2}{4} $$\n\n接下来，我们构建置信区间。给定 $n$ 个独立同分布的样本 $X_1, \\dots, X_n$ 和样本均值 $\\overline{X}_n = \\frac{1}{n}\\sum_{i=1}^{n} X_i$。样本均值的均值为 $\\mathbb{E}[\\overline{X}_n] = \\mu$，其方差为 $\\mathbb{V}\\mathrm{ar}(\\overline{X}_n) = \\frac{\\sigma^2}{n}$。\n\n切比雪夫不等式指出，对于一个均值为 $\\mathbb{E}[Y]$、方差为 $\\mathbb{V}\\mathrm{ar}(Y)$ 的随机变量 $Y$，以及任意常数 $k  0$：\n$$ P(|Y - \\mathbb{E}[Y]| \\ge k) \\le \\frac{\\mathbb{V}\\mathrm{ar}(Y)}{k^2} $$\n我们将此不等式应用于随机变量 $Y = \\overline{X}_n$，并将常数 $k$ 设为所需的半宽度 $h$：\n$$ P(|\\overline{X}_n - \\mu| \\ge h) \\le \\frac{\\mathbb{V}\\mathrm{ar}(\\overline{X}_n)}{h^2} = \\frac{\\sigma^2}{nh^2} $$\n置信区间为 $[\\overline{X}_n - h, \\overline{X}_n + h]$。要求是覆盖概率（即该区间包含真实均值 $\\mu$ 的概率）至少为 $1-\\delta$。这个条件表示为：\n$$ P(\\mu \\in [\\overline{X}_n - h, \\overline{X}_n + h]) \\ge 1-\\delta $$\n这等价于 $P(|\\overline{X}_n - \\mu| \\le h) \\ge 1-\\delta$。其互补事件（或称失败事件）是 $\\mu$ 不在该区间内，即 $|\\overline{X}_n - \\mu|  h$。这个失败事件的概率必须至多为 $\\delta$：\n$$ P(|\\overline{X}_n - \\mu|  h) \\le \\delta $$\n根据概率的性质，$P(|\\overline{X}_n - \\mu|  h) \\le P(|\\overline{X}_n - \\mu| \\ge h)$。因此，为保证失败概率至多为 $\\delta$，我们只需强制执行更强的条件 $P(|\\overline{X}_n - \\mu| \\ge h) \\le \\delta$。\n使用切比雪夫不等式得到的界，我们要求：\n$$ \\frac{\\sigma^2}{nh^2} \\le \\delta $$\n这个不等式仍然包含未知的方差 $\\sigma^2$。为了确保该条件对 $[a, b]$ 上的任何有效分布都成立，我们必须使用 $\\sigma^2$ 的最坏情况，即其最大可能值。我们代入之前推导出的上界 $\\sigma^2 \\le \\frac{(b-a)^2}{4}$：\n$$ \\frac{(b-a)^2 / 4}{nh^2} \\le \\delta $$\n现在我们来解出 $h$。因为 $h$ 是一个宽度，它必须是正数。整理不等式得到：\n$$ \\frac{(b-a)^2}{4n\\delta} \\le h^2 $$\n对两边取正平方根，我们得到：\n$$ h \\ge \\sqrt{\\frac{(b-a)^2}{4n\\delta}} = \\frac{b-a}{2\\sqrt{n\\delta}} $$\n题目要求的是能够保证覆盖率的最小确定性半宽度 $h$。这对应于为 $h$ 选择可能的最小值，也就是下界本身。因此，$h(a,b,n,\\delta)$ 的表达式为：\n$$ h(a,b,n,\\delta) = \\frac{b-a}{2\\sqrt{n\\delta}} $$\n这个表达式只依赖于给定的量 $a$、$b$、$n$ 和 $\\delta$，符合题目要求。",
            "answer": "$$\\boxed{\\frac{b-a}{2\\sqrt{n\\delta}}}$$"
        },
        {
            "introduction": "在方差定界的思想基础上，本练习将重点转向实验设计。你将不再是为给定样本量寻找置信区间，而是要确定达到期望精度和置信水平所需的最小样本量。这是规划高效蒙特卡洛模拟的关键技能，本练习将指导你完成从理论推导到计算实现的整个过程。",
            "id": "3294111",
            "problem": "考虑一个对未知实值随机变量 $X$ 均值进行估计的蒙特卡洛估计量，该估计量使用独立同分布 (i.i.d.) 抽样。您仅被告知 $X$ 的支撑集位于一个已知的闭区间 $[a,b]$ 内（其中 $a \\le b$），并且除了从该支撑集约束中可以推断出的信息外，您不能使用任何关于方差的其他信息。令 $\\mu = \\mathbb{E}[X]$ 表示真实均值，并根据 $n$ 次 i.i.d. 抽样定义样本均值为 $\\bar{X}_n = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。\n\n您的任务是从第一性原理出发，设计一个保守的样本量界，以确保蒙特卡洛估计量满足以下偏差控制要求：对于给定的容差 $\\varepsilon  0$ 和以小数（而非百分比）表示的风险水平 $\\delta \\in (0,1)$，样本均值与真实均值之间的偏差超过 $\\varepsilon$ 的概率至多为 $\\delta$，即 $\\mathbb{P}\\left(|\\bar{X}_n - \\mu| \\ge \\varepsilon\\right) \\le \\delta$。您在推导此界时必须仅使用：\n- 期望 $\\mathbb{E}[\\,\\cdot\\,]$ 和方差 $\\mathrm{Var}(\\cdot)$ 的定义，\n- i.i.d. 抽样的独立性，\n- 平方的非负性，\n- 以及针对非负随机变量的马尔可夫不等式，其表述如下：对于任意非负随机变量 $Y$ 和任意阈值 $t  0$，有 $\\mathbb{P}(Y \\ge t) \\le \\frac{\\mathbb{E}[Y]}{t}$。\n\n不得使用任何其他集中不等式或特定于分布的信息。特别地，除了从 $X \\in [a,b]$ 几乎必然这一条件可以推断出的信息外，不得假定已知方差 $\\mathrm{Var}(X)$。\n\n基于这些原理，推导一个仅依赖于 $a$ 和 $b$ 的 $\\mathrm{Var}(X)$ 的通用上界，然后用它构造一个关于整数样本量 $n$ 的保守充分条件，以保证 $\\mathbb{P}\\left(|\\bar{X}_n - \\mu| \\ge \\varepsilon\\right) \\le \\delta$。在 $a = b$ 的退化情况下，请指明与偏差控制要求一致的最小整数 $n$。\n\n将此界实现为一个函数，该函数在给定实数 $a$、$b$、$\\varepsilon$ 和 $\\delta$ 的情况下，返回满足您所推导的保守充分条件的最小整数样本量 $n$。\n\n测试套件：\n计算以下各参数集的最小整数 $n$，所有数值均按无单位的数学意义解释：\n- 情况 1：$a = 0$, $b = 1$, $\\varepsilon = 0.05$, $\\delta = 0.1$。\n- 情况 2：$a = -10$, $b = 10$, $\\varepsilon = 0.5$, $\\delta = 0.05$。\n- 情况 3：$a = 2$, $b = 2$, $\\varepsilon = 0.1$, $\\delta = 0.01$。\n- 情况 4：$a = 0$, $b = 1$, $\\varepsilon = 0.01$, $\\delta = 0.001$。\n- 情况 5：$a = -1$, $b = 3$, $\\varepsilon = 0.02$, $\\delta = 0.05$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果按上述情况的顺序列出。例如，输出行必须类似于 $[n_1,n_2,n_3,n_4,n_5]$，其中每个 $n_i$ 都是一个整数。",
            "solution": "该问题要求从第一性原理出发，推导蒙特卡洛估计量的保守样本量界。推导过程必须遵循一套指定的工具：期望和方差的定义、i.i.d. 随机变量的性质、平方的非负性以及马尔可夫不等式。\n\n目标是找到最小的整数样本量 $n$，以保证 $\\mathbb{P}\\left(|\\bar{X}_n - \\mu| \\ge \\varepsilon\\right) \\le \\delta$。其中，$\\varepsilon  0$ 和 $\\delta \\in (0,1)$ 是给定常数，$\\bar{X}_n = \\frac{1}{n} \\sum_{i=1}^{n} X_i$ 是随机变量 $X$ 的样本均值，其真实均值为 $\\mu = \\mathbb{E}[X]$，支撑集在已知区间 $[a,b]$ 内。\n\n推导过程分几步进行。首先，我们使用马尔可夫不等式建立偏差概率与估计量方差之间的一般关系。此步骤实质上是重新推导了切比雪夫不等式。\n\n让我们关注的随机变量是样本均值与真实均值之间的绝对偏差 $|\\bar{X}_n - \\mu|$。马尔可夫不等式适用于非负随机变量。虽然 $|\\bar{X}_n - \\mu|$ 是非负的，但其期望不易计算。一个更易于处理的方法是考虑平方偏差 $(\\bar{X}_n - \\mu)^2$。由于实数的平方是非负的，且函数 $x \\mapsto x^2$ 对非负参数是单调递增的，因此在 $\\varepsilon  0$ 的条件下，事件 $|\\bar{X}_n - \\mu| \\ge \\varepsilon$ 等价于事件 $(\\bar{X}_n - \\mu)^2 \\ge \\varepsilon^2$。\n\n令 $Y = (\\bar{X}_n - \\mu)^2$。这是一个非负随机变量。令阈值 $t = \\varepsilon^2$。由于 $\\varepsilon  0$，我们有 $t  0$。现在我们可以应用马尔可夫不等式 $\\mathbb{P}(Y \\ge t) \\le \\frac{\\mathbb{E}[Y]}{t}$：\n$$\n\\mathbb{P}\\left((\\bar{X}_n - \\mu)^2 \\ge \\varepsilon^2\\right) \\le \\frac{\\mathbb{E}\\left[(\\bar{X}_n - \\mu)^2\\right]}{\\varepsilon^2}\n$$\n分子中的表达式 $\\mathbb{E}\\left[(\\bar{X}_n - \\mu)^2\\right]$ 是样本均值方差 $\\mathrm{Var}(\\bar{X}_n)$ 的定义。代入此定义和事件的等价性，可得：\n$$\n\\mathbb{P}\\left(|\\bar{X}_n - \\mu| \\ge \\varepsilon\\right) \\le \\frac{\\mathrm{Var}(\\bar{X}_n)}{\\varepsilon^2}\n$$\n这就是应用于样本均值的 Chebyshev 不等式。\n\n接下来，我们将 $\\mathrm{Var}(\\bar{X}_n)$ 与基础随机变量的方差 $\\mathrm{Var}(X)$ 联系起来。抽样 $X_i$ 是独立同分布 (i.i.d.) 的。\n$$\n\\mathrm{Var}(\\bar{X}_n) = \\mathrm{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} X_i\\right)\n$$\n使用方差性质 $\\mathrm{Var}(cZ) = c^2\\mathrm{Var}(Z)$，其中 $c = 1/n$：\n$$\n\\mathrm{Var}(\\bar{X}_n) = \\frac{1}{n^2} \\mathrm{Var}\\left(\\sum_{i=1}^{n} X_i\\right)\n$$\n因为 $X_i$ 是独立的，所以它们和的方差等于它们方差的和：\n$$\n\\mathrm{Var}(\\bar{X}_n) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\mathrm{Var}(X_i)\n$$\n因为 $X_i$ 是同分布的，所以它们都具有相同的方差 $\\mathrm{Var}(X)$。因此：\n$$\n\\mathrm{Var}(\\bar{X}_n) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\mathrm{Var}(X) = \\frac{1}{n^2} (n \\cdot \\mathrm{Var}(X)) = \\frac{\\mathrm{Var}(X)}{n}\n$$\n将此结果代回我们的不等式，得到：\n$$\n\\mathbb{P}\\left(|\\bar{X}_n - \\mu| \\ge \\varepsilon\\right) \\le \\frac{\\mathrm{Var}(X)}{n \\varepsilon^2}\n$$\n\n问题陈述我们除了从 $X$ 的支撑集为 $[a,b]$ 这一事实可以推断出的信息外，没有关于 $\\mathrm{Var}(X)$ 的其他信息。为了创建一个对 $[a,b]$ 上的任何分布都有效的保守界，我们必须找到一个仅依赖于 $a$ 和 $b$ 的 $\\mathrm{Var}(X)$ 的上界。这被称为关于方差的 Popoviciu 不等式，我们现在来推导它。\n\n对于任何支撑集在 $[a,b]$ 内的随机变量 $X$，几乎必然有 $(X-a)(X-b) \\le 0$。展开此式可得 $X^2 - (a+b)X + ab \\le 0$，可重排为 $X^2 \\le (a+b)X - ab$。\n对两边取期望（该操作保持不等式方向）：\n$$\n\\mathbb{E}[X^2] \\le \\mathbb{E}[(a+b)X - ab] = (a+b)\\mathbb{E}[X] - ab = (a+b)\\mu - ab\n$$\n方差定义为 $\\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = \\mathbb{E}[X^2] - \\mu^2$。代入 $\\mathbb{E}[X^2]$ 的不等式：\n$$\n\\mathrm{Var}(X) \\le ((a+b)\\mu - ab) - \\mu^2 = -\\mu^2 + (a+b)\\mu - ab\n$$\n右侧是关于 $\\mu$ 的一个开口向下的二次函数。其最大值在顶点处取得，即 $\\mu = -\\frac{a+b}{2(-1)} = \\frac{a+b}{2}$。由于 $X$ 的支撑集在 $[a,b]$ 上，其均值 $\\mu$ 必在 $[a,b]$ 内，而顶点 $\\frac{a+b}{2}$ 正在此范围内。该二次函数的最大值为：\n$$\n-\\left(\\frac{a+b}{2}\\right)^2 + (a+b)\\left(\\frac{a+b}{2}\\right) - ab = \\frac{(a+b)^2}{4} - ab = \\frac{a^2+2ab+b^2 - 4ab}{4} = \\frac{a^2-2ab+b^2}{4} = \\frac{(b-a)^2}{4}\n$$\n因此，对于任何支撑集在 $[a,b]$ 上的随机变量 $X$，其方差有界，$\\mathrm{Var}(X) \\le \\frac{(b-a)^2}{4}$。当一个分布在 $a$ 和 $b$ 处的概率质量均为 $1/2$ 时，方差达到这个最大值。\n\n为了保证我们的概率约束对 $[a,b]$ 上的任何可能分布都成立，我们将这个最坏情况下的方差代入不等式中：\n$$\n\\mathbb{P}\\left(|\\bar{X}_n - \\mu| \\ge \\varepsilon\\right) \\le \\frac{\\mathrm{Var}(X)}{n \\varepsilon^2} \\le \\frac{(b-a)^2 / 4}{n \\varepsilon^2} = \\frac{(b-a)^2}{4 n \\varepsilon^2}\n$$\n我们要求这个界至多为 $\\delta$：\n$$\n\\frac{(b-a)^2}{4 n \\varepsilon^2} \\le \\delta\n$$\n求解 $n$ 得到充分条件：\n$$\nn \\ge \\frac{(b-a)^2}{4 \\delta \\varepsilon^2}\n$$\n由于样本量 $n$ 必须是整数，我们对该表达式取上整，以找到在 $a \\ne b$ 的一般情况下满足条件的最小整数 $n$：\n$$\nn = \\left\\lceil \\frac{(b-a)^2}{4 \\delta \\varepsilon^2} \\right\\rceil\n$$\n\n最后，我们考虑 $a=b$ 的退化情况。在这种情况下，随机变量 $X$ 是一个常数，以概率 1 等于 $a$。因此，其均值为 $\\mu = a$，方差为 $\\mathrm{Var}(X) = 0$。每次抽样 $X_i$ 都将等于 $a$，所以无论 $n$ 是多少，样本均值 $\\bar{X}_n$ 也将精确地等于 $a$。偏差 $|\\bar{X}_n - \\mu| = |a-a| = 0$。概率陈述变为 $\\mathbb{P}(0 \\ge \\varepsilon) \\le \\delta$。由于给定 $\\varepsilon  0$，事件 $0 \\ge \\varepsilon$ 是不可能的，其概率为 0。不等式 $0 \\le \\delta$ 总是成立的，因为 $\\delta \\in (0,1)$。这对任何样本量 $n \\ge 1$ 都成立。因此，所需的最小整数样本量是 $n=1$。\n\n总结来说，最小整数样本量 $n$ 由以下公式给出：\n- 如果 $a=b$，则 $n=1$。\n- 如果 $a \\ne b$，则 $n = \\lceil \\frac{(b-a)^2}{4 \\delta \\varepsilon^2} \\rceil$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Calculates the minimal integer sample size n based on a derived conservative bound\n    using Chebyshev's inequality and a variance upper bound for a random variable\n    with support on a known interval.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: a = 0, b = 1, ε = 0.05, δ = 0.1\n        (0.0, 1.0, 0.05, 0.1),\n        # Case 2: a = -10, b = 10, ε = 0.5, δ = 0.05\n        (-10.0, 10.0, 0.5, 0.05),\n        # Case 3: a = 2, b = 2, ε = 0.1, δ = 0.01\n        (2.0, 2.0, 0.1, 0.01),\n        # Case 4: a = 0, b = 1, ε = 0.01, δ = 0.001\n        (0.0, 1.0, 0.01, 0.001),\n        # Case 5: a = -1, b = 3, ε = 0.02, δ = 0.05\n        (-1.0, 3.0, 0.02, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, b, epsilon, delta = case\n        \n        # Validate inputs, although problem statement guarantees ε>0, δ∈(0,1).\n        if a > b or epsilon = 0 or not (0  delta  1):\n             # This case should not be reached with the given test suite.\n             # Handle error gracefully if it were a general-purpose function.\n            raise ValueError(\"Invalid input parameters.\")\n\n        # Handle the degenerate case where the random variable is a constant.\n        # The deviation is always 0, so a single sample is sufficient.\n        if a == b:\n            n = 1\n        else:\n            # For the non-degenerate case, apply the derived formula:\n            # n >= (b-a)^2 / (4 * δ * ε^2)\n            # We must find the smallest integer n satisfying this.\n            numerator = (b - a)**2\n            denominator = 4 * delta * epsilon**2\n            \n            # Since n must be an integer, we take the ceiling.\n            # Using math.ceil from the standard library.\n            # np.ceil also works and is imported.\n            n_float = numerator / denominator\n            n = math.ceil(n_float)\n            \n        results.append(int(n))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}