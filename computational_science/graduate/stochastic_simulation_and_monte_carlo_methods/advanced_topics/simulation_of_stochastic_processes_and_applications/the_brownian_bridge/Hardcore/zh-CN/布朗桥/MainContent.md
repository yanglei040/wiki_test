## 引言
[布朗桥](@entry_id:265208)，作为一种在起点和终点被“钉住”的特殊[随机过程](@entry_id:159502)，是[随机过程](@entry_id:159502)理论中的一个基本且优美的对象。然而，它远不止是一个理论上的构造；它是在众多科学与工程领域中模拟受约束随机现象和优化计算方法的强大工具。许多学习者在掌握了[布朗桥](@entry_id:265208)的数学定义后，往往难以将其与金融定价、[统计推断](@entry_id:172747)或高效[算法设计](@entry_id:634229)等实际问题联系起来，这构成了理论与应用之间的知识鸿沟。

本文旨在系统性地跨越这一鸿沟。我们首先将在“原理与机制”一章中，从第一性原理出发，深入剖析[布朗桥](@entry_id:265208)的数学构造、统计特性、随机微分方程（SDE）表示及其[谱分解](@entry_id:173707)，为您构建坚实的理论基础。接着，在“应用与跨学科联系”一章中，我们将展示[布朗桥](@entry_id:265208)如何作为一种核心方法，在计算金融、贝叶斯统计、信号处理和[数学物理](@entry_id:265403)等前沿领域中发挥关键作用。最后，通过“动手实践”一章提供的编程练习，您将有机会将理论知识转化为解决实际问题的能力。通过这一结构化的学习路径，读者将全面掌握[布朗桥](@entry_id:265208)的理论精髓与实践价值。

## 原理与机制

本章深入探讨[布朗桥](@entry_id:265208)的数学原理和随机机制。我们将从其定义和基本统计特性出发，推导其随机微分方程 (SDE) 表示，探索其[谱表示](@entry_id:153219)（即 Karhunen-Loève 展开），并研究其在离散化、计算模拟和[蒙特卡洛方法](@entry_id:136978)中的具体应用。

### [布朗桥](@entry_id:265208)的定义与构造

在最基本的层面上，[布朗桥](@entry_id:265208)是一个被“钉住”在起点和终点的[标准布朗运动](@entry_id:197332)。更正式地说，一个在时间区间 $[0, T]$ 上，从 $a$ 到 $b$ 的**[布朗桥](@entry_id:265208) (Brownian bridge)** 过程 $\{B_t\}_{t \in [0,T]}$，是[标准布朗运动](@entry_id:197332) $\{W_t\}_{t \in [0,T]}$ 在给定 $W_0 = a$ 和 $W_T = b$ 条件下的[条件概率分布](@entry_id:163069)。为简化讨论，我们首先关注**标准[布朗桥](@entry_id:265208)**，其定义在 $[0,1]$ 上，并满足边界条件 $B_0=0$ 和 $B_1=0$。

#### 基本统计特性

作为[高斯过程](@entry_id:182192)（布朗运动）的条件分布，[布朗桥](@entry_id:265208)本身也是一个高斯过程。它的统计特性完全由其[均值函数](@entry_id:264860)和[协方差函数](@entry_id:265031)确定。我们可以利用高斯[随机变量](@entry_id:195330)的条件期望公式来推导这些特性。

考虑两个[联合高斯](@entry_id:636452)[随机变量](@entry_id:195330) $X$ 和 $Y$，给定 $Y=y$ 时 $X$ 的[条件分布](@entry_id:138367)也是高斯的，其[条件期望](@entry_id:159140)和[条件方差](@entry_id:183803)为：
$$ \mathbb{E}[X \mid Y=y] = \mathbb{E}[X] + \frac{\mathrm{Cov}(X,Y)}{\mathrm{Var}(Y)}(y - \mathbb{E}[Y]) $$
$$ \mathrm{Var}(X \mid Y=y) = \mathrm{Var}(X) - \frac{(\mathrm{Cov}(X,Y))^2}{\mathrm{Var}(Y)} $$

为了推导标准[布朗桥](@entry_id:265208)在任意时刻 $t \in [0,1]$ 的均值和[方差](@entry_id:200758)，我们将标准布朗运动中的 $W_t$ 视为 $X$，将终点值 $W_1$ 视为 $Y$，并设条件值 $y=0$。对于标准布朗运动，我们有 $\mathbb{E}[W_t] = 0$，$\mathrm{Var}(W_t) = t$，以及 $\mathrm{Cov}(W_t, W_1) = \min(t,1) = t$。

代入上述公式，我们得到[布朗桥](@entry_id:265208)的条件期望 ：
$$ \mathbb{E}[B_t] = \mathbb{E}[W_t \mid W_1=0] = \mathbb{E}[W_t] + \frac{\mathrm{Cov}(W_t, W_1)}{\mathrm{Var}(W_1)}(0 - \mathbb{E}[W_1]) = 0 + \frac{t}{1}(0 - 0) = 0 $$
这意味着标准[布朗桥](@entry_id:265208)在任何时刻的[期望值](@entry_id:153208)都是零。

同样，我们可以计算其[条件方差](@entry_id:183803) ：
$$ \mathrm{Var}(B_t) = \mathrm{Var}(W_t \mid W_1=0) = \mathrm{Var}(W_t) - \frac{(\mathrm{Cov}(W_t, W_1))^2}{\mathrm{Var}(W_1)} = t - \frac{t^2}{1} = t(1-t) $$
这个结果非常直观：[方差](@entry_id:200758)在起点 ($t=0$) 和终点 ($t=1$) 处为零，因为过程在这些点上的值是确定的。[方差](@entry_id:200758)在区间中点 $t=1/2$ 处达到最大值 $1/4$，这是不确定性最大的地方。

通过类似但更复杂的计算（例如使用协[方差](@entry_id:200758)的[极化恒等式](@entry_id:271819)），可以推导出对于 $0 \le s \le t \le 1$ 的[协方差函数](@entry_id:265031)：
$$ \mathrm{Cov}(B_s, B_t) = \mathbb{E}[B_s B_t] = s(1-t) $$
这个结果可以推广到任意 $s, t \in [0,1]$，其形式为 $\mathrm{Cov}(B_s, B_t) = \min(s,t) - st$。这是[布朗桥](@entry_id:265208)最核心的特征之一。

#### 一种直接的构造方法

除了通过条件化来定义，[布朗桥](@entry_id:265208)还可以通过一个简单的变换从标准布朗运动直接构造出来。考虑如下过程  ：
$$ B_t = W_t - t W_1, \quad t \in [0,1] $$
其中 $\{W_t\}$ 是一个[标准布朗运动](@entry_id:197332)。首先，我们验证它是否满足[布朗桥](@entry_id:265208)的边界条件：
- 当 $t=0$ 时，$B_0 = W_0 - 0 \cdot W_1 = 0$。
- 当 $t=1$ 时，$B_1 = W_1 - 1 \cdot W_1 = 0$。

接下来，我们验证它的均值和[协方差函数](@entry_id:265031)。其均值为：
$$ \mathbb{E}[B_t] = \mathbb{E}[W_t - tW_1] = \mathbb{E}[W_t] - t\mathbb{E}[W_1] = 0 - t \cdot 0 = 0 $$
其[协方差函数](@entry_id:265031)为：
$$ \mathrm{Cov}(B_s, B_t) = \mathbb{E}[(W_s - sW_1)(W_t - tW_1)] $$
$$ = \mathbb{E}[W_s W_t] - t\mathbb{E}[W_s W_1] - s\mathbb{E}[W_t W_1] + st\mathbb{E}[W_1^2] $$
利用 $\mathbb{E}[W_u W_v] = \min(u,v)$，我们得到：
$$ \mathrm{Cov}(B_s, B_t) = \min(s,t) - t \cdot s - s \cdot t + st \cdot 1 = \min(s,t) - st $$
这与我们之前通过条件化得到的结果完全一致。因此，表达式 $W_t - tW_1$ 提供了一种从任意[布朗运动路径](@entry_id:274361)构造标准[布朗桥](@entry_id:265208)路径的显式方法。

对于从 $(t_0, a)$ 到 $(t_n, b)$ 的一般[布朗桥](@entry_id:265208)，其构造和性质可以相应地推广。例如，其[均值函数](@entry_id:264860)是连接起点和终点的直线：
$$ \mathbb{E}[B_t] = a + \frac{t - t_0}{t_n - t_0}(b - a) $$

### 作为[扩散过程](@entry_id:170696)的[布朗桥](@entry_id:265208)：SDE 表示

我们已经看到，[布朗桥](@entry_id:265208)的[方差](@entry_id:200758) $t(1-t)$ 随时间变化，这表明它不是一个时间平稳的过程。这种[非平稳性](@entry_id:180513)源于终点约束。为了维持在 $t=1$ 时回到 $0$ 的特性，过程必须根据其当前位置和剩余时间调整其行为。这种调整表现为一个随时间变化的“漂移”，将过程拉向其终点。我们可以通过推导[布朗桥](@entry_id:265208)的随机微分方程 (SDE) 来精确描述这一机制 。

一个[随机过程](@entry_id:159502) $\{X_t\}$ 的 SDE 描述了其无穷小的演化。对于[布朗桥](@entry_id:265208) $B_t$，其 SDE 形式为 $dB_t = d\widetilde{W}_t + b(t, B_t)dt$，其中 $\widetilde{W}_t$ 是某个新的布朗运动，而 $b(t, x)$ 是漂移项。这个漂移项可以被看作是过程在时刻 $t$ 位于 $x$ 时，其期望的[瞬时变化率](@entry_id:141382)：
$$ b(t, x) = \lim_{\delta t \downarrow 0} \frac{1}{\delta t} \mathbb{E}[B_{t+\delta t} - B_t \mid B_t = x] $$

利用高斯过程的[条件期望](@entry_id:159140)公式，我们可以计算 $\mathbb{E}[B_{t+\delta t} \mid B_t=x]$。已知[布朗桥](@entry_id:265208)的均值为零，协[方差](@entry_id:200758)为 $\min(u,v) - uv$，我们有：
$$ \mathbb{E}[B_{t+\delta t} \mid B_t=x] = \frac{\mathrm{Cov}(B_t, B_{t+\delta t})}{\mathrm{Var}(B_t)} x = \frac{t(1-(t+\delta t))}{t(1-t)} x = \left(1 - \frac{\delta t}{1-t}\right) x $$
代入漂移的定义中：
$$ b(t,x) = \lim_{\delta t \downarrow 0} \frac{1}{\delta t} \left[ \left(1 - \frac{\delta t}{1-t}\right) x - x \right] = \lim_{\delta t \downarrow 0} \frac{1}{\delta t} \left( -\frac{x \delta t}{1-t} \right) = -\frac{x}{1-t} $$
因此，标准[布朗桥](@entry_id:265208)的 SDE 为：
$$ dB_t = d\widetilde{W}_t - \frac{B_t}{1-t} dt, \quad t \in [0,1) $$
这个方程揭示了一个关键机制：漂移项 $-B_t/(1-t)$ 总是将过程拉向 $0$。如果 $B_t>0$，漂移为负；如果 $B_t<0$，漂移为正。此外，随着时间 $t$ 接近终点 $1$，分母 $(1-t)$ 变小，[拉回](@entry_id:160816)的“力”变得越来越强，以确保过程能在 $t=1$ 时精确地到达 $0$。

另一种更深刻的推导方法是使用 **Doob $h$-变换**。这种方法将条件化问题转化为对原过程生成元的变换。对于布朗运动，其生成元为 $\mathcal{L} = \frac{1}{2} \frac{\partial^2}{\partial x^2}$。条件化于事件 $\{W_1=0\}$ 对应的调和函数是布朗运动的转移概率密度（即[热核](@entry_id:172041)）：
$$ h(t,x) = p(1-t, x, 0) = \frac{1}{\sqrt{2\pi(1-t)}} \exp\left(-\frac{x^2}{2(1-t)}\right) $$
根据 Doob $h$-变换理论，变换后过程的漂移由 $b(t,x) = \frac{\partial}{\partial x} \ln(h(t,x))$ 给出。计算可得：
$$ \ln(h(t,x)) = -\frac{1}{2}\ln(2\pi(1-t)) - \frac{x^2}{2(1-t)} $$
$$ b(t,x) = \frac{\partial}{\partial x} \left( -\frac{x^2}{2(1-t)} \right) = -\frac{x}{1-t} $$
这再次证实了我们之前的结果，并将其置于一个更广泛的[随机过程](@entry_id:159502)变换理论框架中 。

### [谱表示](@entry_id:153219)：Karhunen-Loève 展开

Karhunen-Loève (KL) 展开提供了一种将[随机过程分解](@entry_id:637354)为一组确定性[基函数](@entry_id:170178)和不相关的随机系数乘积的方法。这类似于[傅里叶级数](@entry_id:139455)，但[基函数](@entry_id:170178)是为特定过程“量身定做”的，由其协[方差](@entry_id:200758)算子的[特征函数](@entry_id:186820)给出。

对于标准[布朗桥](@entry_id:265208)，其协[方差](@entry_id:200758)算子 $K$ 的作用是：
$$ (K\phi)(t) = \int_0^1 K(s,t) \phi(s) ds = \int_0^1 (\min(s,t)-st) \phi(s) ds $$
我们需要求解特征值问题 $K\phi = \lambda \phi$。通过对该积分方程进行两[次微分](@entry_id:175641)，可以将其转化为一个[二阶常微分方程](@entry_id:204212)（ODE） ：
$$ \lambda \phi''(t) = -\phi(t), \quad \text{即} \quad \phi''(t) + \frac{1}{\lambda}\phi(t) = 0 $$
同时，在 $t=0$ 和 $t=1$ 处求值可以得到边界条件 $\phi(0)=0$ 和 $\phi(1)=0$。这个边值问题的解是众所周知的：
- [特征函数](@entry_id:186820)：$\phi_k(t) = \sqrt{2} \sin(\pi k t)$
- [特征值](@entry_id:154894)：$\lambda_k = \frac{1}{(\pi k)^2}$
其中 $k=1, 2, \dots$。这些[特征函数](@entry_id:186820)构成了 $L^2([0,1])$ 空间的一个[标准正交基](@entry_id:147779)。

根据 KL 定理，[布朗桥](@entry_id:265208)可以表示为：
$$ B_t = \sum_{k=1}^{\infty} Z_k \sqrt{\lambda_k} \phi_k(t) = \sum_{k=1}^{\infty} Z_k \frac{\sqrt{2}}{\pi k} \sin(\pi k t) $$
其中 $\{Z_k\}$ 是一系列[独立同分布](@entry_id:169067)的标准正态[随机变量](@entry_id:195330)。这个展开式揭示了[布朗桥](@entry_id:265208)的内在结构：它是由一系列具有递减振幅的[正弦波](@entry_id:274998)随机叠加而成。高频分量（大的 $k$）的贡献迅速减小，这反映了[布朗桥](@entry_id:265208)路径的连续性和某种程度的“平滑性”（相比于普通布朗运动）。

KL 展开的一个直接应用是计算路径泛函的期望。例如，我们可以计算路径的[平均能量](@entry_id:145892)或期望的二次变差 ：
$$ \mathbb{E}\left[\int_0^1 B_t^2 dt\right] $$
利用 KL 展开和基[函数的正交性](@entry_id:160337)（$\int_0^1 \phi_k(t)\phi_j(t)dt = \delta_{kj}$），我们得到：
$$ \mathbb{E}\left[\int_0^1 \left(\sum_{k=1}^{\infty} Z_k \sqrt{\lambda_k} \phi_k(t)\right)^2 dt\right] = \mathbb{E}\left[\sum_{k=1}^{\infty} Z_k^2 \lambda_k\right] = \sum_{k=1}^{\infty} \lambda_k \mathbb{E}[Z_k^2] = \sum_{k=1}^{\infty} \lambda_k $$
代入我们求得的[特征值](@entry_id:154894)：
$$ \sum_{k=1}^{\infty} \frac{1}{(\pi k)^2} = \frac{1}{\pi^2} \sum_{k=1}^{\infty} \frac{1}{k^2} = \frac{1}{\pi^2} \cdot \frac{\pi^2}{6} = \frac{1}{6} $$
我们还可以通过直接积分验证这个结果：
$$ \mathbb{E}\left[\int_0^1 B_t^2 dt\right] = \int_0^1 \mathbb{E}[B_t^2] dt = \int_0^1 \mathrm{Var}(B_t) dt = \int_0^1 (t-t^2) dt = \left[\frac{t^2}{2} - \frac{t^3}{3}\right]_0^1 = \frac{1}{2} - \frac{1}{3} = \frac{1}{6} $$
两种方法得到了一致的结果，展示了 KL 展开的强大功能和[布朗桥](@entry_id:265208)统计特性的一致性。

### 离散化与模拟

在实际应用中，我们通常处理的是在离散时间点上观测或模拟的[布朗桥](@entry_id:265208)。设时间网格为 $0 = t_0 < t_1 < \dots < t_n = T$。

#### 高斯马尔可夫性与[精度矩阵](@entry_id:264481)

在离散时间网格上，[布朗桥](@entry_id:265208)路径的内部点向量 $\mathbf{x} = (B_{t_1}, \dots, B_{t_{n-1}})^\top$ 服从一个多元高斯分布。一个关键性质是，[布朗桥](@entry_id:265208)是一个**高斯[马尔可夫过程](@entry_id:160396)**。这意味着给定其相邻点的值，任何一点的值都与其他所有点条件独立。这种马尔可夫性在多元高斯分布中表现为一个稀疏的**[精度矩阵](@entry_id:264481)**（即协方差矩阵的逆，$Q = \Sigma^{-1}$）。具体来说，[布朗桥](@entry_id:265208)的[精度矩阵](@entry_id:264481)是**三对角的 (tridiagonal)**  。

对于在 $[0,T]$ 上从 $a$ 到 $b$ 的[布朗桥](@entry_id:265208)，在时间间隔为 $\Delta_i = t_i - t_{i-1}$ 的网格上，其内部点向量 $\mathbf{x}$ 的均值为[线性插值](@entry_id:137092) $\mathbf{m}$，其分量为 $m_k = a + \frac{t_k}{T}(b-a)$。其 $(n-1) \times (n-1)$ [精度矩阵](@entry_id:264481) $Q$ 的元素为：
$$
Q_{kk} = \frac{1}{\Delta_k} + \frac{1}{\Delta_{k+1}}, \quad \text{for } k=1, \dots, n-1
$$
$$
Q_{k, k+1} = Q_{k+1, k} = -\frac{1}{\Delta_{k+1}}, \quad \text{for } k=1, \dots, n-2
$$
所有其他非对角[线元](@entry_id:196833)素均为零。

这个三对角结构是进行高效计算的基石。基于这个结构，$\mathbf{x}$ 的[联合高斯](@entry_id:636452)[似然函数](@entry_id:141927)可以写成紧凑的二次型形式 ：
$$ L(\mathbf{x} \mid a,b) \propto \exp\left(-\frac{1}{2} (\mathbf{x}-\mathbf{m})^{\top} Q (\mathbf{x}-\mathbf{m})\right) $$
这个表达式对于贝叶斯推断（例如，在使用[布朗桥](@entry_id:265208)作为模型先验时）至关重要。

#### 从离散到连续

[布朗桥](@entry_id:265208)不仅是布朗运动的条件化，它也是离散[随机游走桥](@entry_id:264676)的缩放极限。考虑一个在格点上进行的简单[对称随机游走](@entry_id:273558)，它在 $n$ 步后返回起点。如果我们适当地缩放时间和空间，这个离散的[随机游走桥](@entry_id:264676)的协[方差](@entry_id:200758)结构会收敛到连续[布朗桥](@entry_id:265208)的协[方差](@entry_id:200758)结构。具体来说，离散桥的归一化协[方差](@entry_id:200758)为 $\frac{n}{n-1}(\min(s,t)-st)$，当 $n \to \infty$ 时，其与连续桥的协[方差](@entry_id:200758) $\min(s,t)-st$ 之间的差异以 $O(1/n)$ 的速率消失 。这为使用离散模型来理解和逼近连续过程提供了理论依据。

### [计算模拟](@entry_id:146373)算法

生成[布朗桥](@entry_id:265208)路径的样本是许多蒙特卡洛应用中的一个基本任务。有多种算法可以实现这一点，它们在计算复杂度、内存需求和灵活性方面各有不同 。

1.  **稠密协方差矩阵法**：
    这是最直接但效率最低的方法。首先构造 $(n-1) \times (n-1)$ 的稠密[协方差矩阵](@entry_id:139155) $\Sigma$，其元素为 $\Sigma_{ij} = \min(t_i, t_j) - \frac{t_i t_j}{T}$。然后，对 $\Sigma$ 进行 Cholesky 分解得到 $\Sigma = LL^\top$，这需要 $O(n^3)$ 的计算和 $O(n^2)$ 的内存。最后，通过计算 $\mathbf{x} = \mathbf{m} + L\mathbf{z}$（其中 $\mathbf{z}$ 是标准正态随机向量）生成一个样本，此步需要 $O(n^2)$ 的计算。由于其高昂的计算成本，此方法仅适用于 $n$ 非常小的情况。

2.  **桥递归法**：
    该方法利用马尔可夫性，按时间顺序逐点生成样本。首先生成 $B_{t_1}$，其条件分布是给定 $B_{t_0}=a$ 和 $B_{t_n}=b$ 的[高斯分布](@entry_id:154414)。然后，生成 $B_{t_2}$，其条件是已生成的 $B_{t_1}$ 和终点 $B_{t_n}=b$。这个过程一直持续到 $B_{t_{n-1}}$。每一步都是一个 $O(1)$ 的计算，因此生成整个路径的复杂度为 $O(n)$，内存也为 $O(n)$。这是一个精确且高效的方法。

3.  **[稀疏精度矩阵](@entry_id:755118)法**：
    这是最强大和灵活的方法之一。它利用了我们前面讨论过的[精度矩阵](@entry_id:264481) $Q$ 的三对角结构 。
    - **采样**：要生成一个样本 $\mathbf{x} \sim \mathcal{N}(\mathbf{m}, Q^{-1})$，我们首先对[稀疏矩阵](@entry_id:138197) $Q$ 进行 Cholesky 分解 $Q = LL^\top$。因为 $Q$ 是三对角的，其 Cholesky 因子 $L$ 是下双对角的 (lower bidiagonal)。这个分解仅需 $O(n)$ 的时间和 $O(n)$ 的内存。然后，我们生成一个标准正态向量 $\mathbf{z}$，并通过求解下三角系统 $L\mathbf{y} = \mathbf{z}$ 和[上三角系统](@entry_id:635483) $L^\top(\mathbf{x}-\mathbf{m}) = \mathbf{y}$ 来得到样本 $\mathbf{x}$。由于 $L$ 是稀疏的，这两个三角系统的求解（通过前向和后向替换）也只需要 $O(n)$ 的时间。
    - **[似然](@entry_id:167119)评估**：该方法还能以 $O(n)$ 的时间评估[对数似然函数](@entry_id:168593)。二次型项 $(\mathbf{x}-\mathbf{m})^\top Q (\mathbf{x}-\mathbf{m})$ 可以通过计算 $\|L^\top(\mathbf{x}-\mathbf{m})\|^2$ 在 $O(n)$ 时间内完成。[对数行列式](@entry_id:751430)项 $\ln \det(Q)$ 可以通过 $2\sum \ln(L_{ii})$ 在 $O(n)$ 时间内得到。

[稀疏精度矩阵](@entry_id:755118)法与桥递归法具有相同的渐进复杂度，但它在处理更复杂的问题时显示出更大的优势。例如，如果[布朗桥](@entry_id:265208)路径还受到其他线性观测（如带噪声的内部点测量）的约束，这些额外信息可以在贝叶斯框架下直接作为对[精度矩阵](@entry_id:264481) $Q$ 的低秩更新来处理，而 $Q$ 的[稀疏结构](@entry_id:755138)（以及计算效率）在很大程度上得以保留 。

4.  **基于 FFT 的方法**：
    对于平稳[高斯过程](@entry_id:182192)，基于[快速傅里叶变换 (FFT)](@entry_id:146372) 的**循环嵌入 (circulant embedding)** 方法是一种非常高效的模拟技术。然而，[布朗桥](@entry_id:265208)不是一个[平稳过程](@entry_id:196130)，其协方差矩阵不是托普利茨 (Toeplitz) 矩阵，因此该方法不能直接应用。但存在一种巧妙的解决方法 ：我们可以模拟一个相关的[平稳过程](@entry_id:196130)——布朗运动的**增量**，并对其施加约束。在周期性假设下，一个[标准布朗运动](@entry_id:197332)的增量，在被约束总和为零时，构成一个[平稳过程](@entry_id:196130)，其协方差矩阵是循环的。因此，我们可以使用 FFT 高效地生成这些受约束的增量，然后通过累积求和来重构出[布朗桥](@entry_id:265208)路径。

### 深入探讨：[测度论](@entry_id:139744)视角

最后，我们从更抽象的[测度论](@entry_id:139744)角度来审视[布朗桥](@entry_id:265208)，这有助于澄清其与布朗运动的根本关系。

令 $\mathbb{P}_0$ 为从 $0$ 开始的标准布朗运动（维纳过程）在路径空间 $C([0,1])$ 上的[维纳测度](@entry_id:189476)，令 $\mathbb{P}^{\mathrm{br}}$ 为标准[布朗桥](@entry_id:265208)的测度。

#### [绝对连续性](@entry_id:144513)与奇异性

一个核心问题是：这两个测度之间的关系是怎样的？它们是等价的（相互绝对连续），还是奇异的（互不相容）？答案取决于我们考虑的 $\sigma$-代数 。
- 对于任何 $t  1$，如果我们只考虑直到时刻 $t$ 的[路径信息](@entry_id:169683)（即在 $\sigma$-代数 $\mathcal{F}_t$ 上），那么 $\mathbb{P}^{\mathrm{br}}$ 和 $\mathbb{P}_0$ 是**相互绝对连续的**。这意味着它们看到的“可能性”是相同的，只是概率权重不同。其间的 Radon-Nikodym 导数（或密度函数）$L_t = d\mathbb{P}^{\mathrm{br}}/d\mathbb{P}_0|_{\mathcal{F}_t}$ 是一个正的、有限的[鞅](@entry_id:267779)。
- 然而，当我们考虑整个路径直到时刻 $t=1$（即在 $\sigma$-代数 $\mathcal{F}_1$ 上）时，情况发生了根本性变化。这两个测度变得**相互奇异**。这是因为集合 $A = \{\omega \in C([0,1]) : \omega(1)=0\}$ 对于两个测度有截然不同的概率：$\mathbb{P}^{\mathrm{br}}(A)=1$ (根据定义)，而 $\mathbb{P}_0(A)=0$ (因为连续型[随机变量](@entry_id:195330)取特定值的概率为零)。这意味着[布朗桥](@entry_id:265208)测度完全集中在[维纳测度](@entry_id:189476)下的一个零测集上，这是奇异性的标志。

这种从绝对连续到奇异的转变，是由于在终点施加了一个“硬”约束。在 $t=1$ 之前，任何[布朗运动路径](@entry_id:274361)都“可能”最终到达 $0$；但在 $t=1$ 那一刻，这个可能性变成了确定性，从而将桥路径与绝大多数[布朗运动路径](@entry_id:274361)区分开来。

#### 基于重加权的[蒙特卡洛估计](@entry_id:637986)

测度间的绝对连续关系在蒙特卡洛方法中有重要的实际应用。假设我们想计算某个泛函 $F(B)$ 在[布朗桥](@entry_id:265208)测度下的期望 $\mathbb{E}^{\mathrm{br}}[F(B)]$。利用 Radon-Nikodym 导数，我们可以将其转化为在更易于模拟的[维纳测度](@entry_id:189476)下的期望 ：
$$ \mathbb{E}^{\mathrm{br}}[F(B_s)] = \mathbb{E}_0\left[F(W_s) \frac{d\mathbb{P}^{\mathrm{br}}}{d\mathbb{P}_0}\bigg|_{\mathcal{F}_s}\right] = \mathbb{E}_0\left[F(W_s) L_s\right] $$
其中 $L_s$ 是我们之前通过 Doob $h$-变换找到的密度过程。这个公式意味着，我们可以通过模拟大量的标准布朗运动路径 $\{W^{(i)}\}$，然后计算加权平均值来估计 $\mathbb{E}^{\mathrm{br}}[F(B)]$：
$$ \mathbb{E}^{\mathrm{br}}[F(B_s)] \approx \frac{1}{N} \sum_{i=1}^N F(W_s^{(i)}) L_s(W^{(i)}) $$
这是一种**重要性采样**。然而，这种方法的效率取决于重加权因子 $L_s$ 的[方差](@entry_id:200758)。如果 $L_s$ 的[方差](@entry_id:200758)很大，那么少数几个样本可能占据主导地位，导致[估计量方差](@entry_id:263211)过高，收敛缓慢。计算表明，该[估计量的方差](@entry_id:167223)强烈依赖于泛函 $F$ 和时间 $s$，这在设计有效的蒙特卡洛方案时必须予以考虑 。