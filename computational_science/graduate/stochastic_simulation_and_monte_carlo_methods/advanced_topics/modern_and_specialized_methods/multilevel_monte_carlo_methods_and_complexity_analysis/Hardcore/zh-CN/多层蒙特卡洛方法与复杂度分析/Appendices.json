{
    "hands_on_practices": [
        {
            "introduction": "多层蒙特卡罗方法的核心优势在于其能够以最优的方式平衡计算精度与成本。本练习将指导您推导著名的MLMC复杂度定理，这是设计高效MLMC模拟的基石。您将学习如何通过策略性地分配各层级的样本数量，从而在满足预设误差容忍度 $\\varepsilon$ 的前提下，最小化总计算功 。",
            "id": "3322273",
            "problem": "考虑一个用于标量关注量 $Q$ 的多层蒙特卡洛（MLMC）估计量，其中在网格尺寸 $h_{\\ell}$ 上的离散化 $Q(h_{\\ell})$ 被组织在层级 $\\ell = 0,1,\\dots,L$ 上。假设存在几何加密 $h_{\\ell} = h_{0} m^{-\\ell}$（其中 $m  1$），并定义层级差分 $\\Delta_{\\ell} = Q(h_{\\ell}) - Q(h_{\\ell-1})$，约定 $Q(h_{-1}) \\equiv 0$。MLMC 估计量被构造为 $\\Delta_{\\ell}$ 的样本均值的伸缩和。假设以下广泛使用的标度假设成立：\n- 偏差（离散误差）满足 $\\left|\\mathbb{E}[Q(h_{L})] - \\mathbb{E}[Q]\\right| \\leq c_{b} h_{L}^{\\alpha}$，其中 $c_{b}  0$ 和 $\\alpha  0$ 为常数。\n- 层级差分的方差满足 $\\mathrm{Var}(\\Delta_{\\ell}) \\asymp c_{v} h_{\\ell}^{\\beta}$，其中 $c_{v}  0$ 和 $\\beta  0$ 为常数。\n- $\\Delta_{\\ell}$ 的每个独立样本的计算成本满足 $C_{\\ell} \\asymp c_{c} h_{\\ell}^{-\\gamma}$，其中 $c_{c}  0$ 和 $\\gamma  0$ 为常数。\n\n令 $N_{\\ell}$ 表示在层级 $\\ell$ 上使用的独立样本数，因此 MLMC 估计量使用的总计算功为 $W = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell}$，其均方误差为 $\\mathrm{MSE} = \\left(\\text{偏差}\\right)^{2} + \\sum_{\\ell=0}^{L} \\mathrm{Var}(\\Delta_{\\ell})/N_{\\ell}$。目标是选择层级 $L(\\varepsilon)$ 和样本分配 $\\{N_{\\ell}(\\varepsilon)\\}$，使得在 $\\varepsilon \\to 0$ 时，$\\mathrm{MSE} \\leq \\varepsilon^{2}$，同时最小化计算功 $W$。\n\n关于 $L(\\varepsilon)$ 的最优选择、跨层级的最优方差分配以及最终的渐近功复杂度（包括任何对数因子）的以下陈述中，哪一个是正确的？\n\nA. 选择 $L(\\varepsilon)$ 为最小整数，使得 $c_{b} h_{L}^{\\alpha} \\leq \\varepsilon/\\sqrt{2}$；通过最优方差分配 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})/C_{\\ell}}$ 来选择样本量。那么，如果 $\\beta  \\gamma$，最小功的标度为 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$；如果 $\\beta = \\gamma$，为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\left(\\log \\varepsilon^{-1}\\right)^{2}\\right)$；如果 $\\beta  \\gamma$，为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2 - (\\gamma - \\beta)/\\alpha}\\right)$。\n\nB. 选择 $L(\\varepsilon)$ 为最小整数，使得 $c_{b} h_{L}^{\\alpha} \\leq \\varepsilon^{2}$；分配样本为 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$。那么对于 $\\beta$ 和 $\\gamma$ 之间的所有关系，最小功的标度均为 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$，且没有对数因子。\n\nC. 选择 $L(\\varepsilon)$ 使得 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$；分配样本为 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})\\,C_{\\ell}}$。那么当 $\\beta = \\gamma$ 时，最小功的标度为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\log \\varepsilon^{-1}\\right)$；当 $\\beta  \\gamma$ 时，为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2 - (\\gamma - \\beta)/(2\\alpha)}\\right)$。\n\nD. 选择 $L(\\varepsilon)$ 使得 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$；分配样本以均衡每层的方差贡献，即 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$。那么，如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$；如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-3})$。\n\nE. 在临界情况 $\\beta = \\gamma$下，如果使用最优分配 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})/C_{\\ell}}$，最小功的标度为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\log \\varepsilon^{-1}\\right)$，其中对数因子仅仅是因为 $L(\\varepsilon)$ 的增长方式类似于 $\\log \\varepsilon^{-1}$ 而产生。",
            "solution": "问题陈述描述了多层蒙特卡洛（MLMC）方法复杂度分析的标准设置。所有给出的定义、假设和目标都与关于该主题的已有文献（例如，Giles, M. B. \"Multilevel Monte Carlo path simulation.\" Operations Research 56.3 (2008): 607-617）一致。该问题具有科学依据、是适定的、客观的，并包含足够的信息来获得关于渐近复杂度的唯一解。因此，问题陈述是有效的。\n\n我们接下来推导 MLMC 估计量的最优功复杂度。\n目标是在均方误差 $\\mathrm{MSE}$ 小于或等于给定容差 $\\varepsilon^2$ 的约束下，最小化总计算功 $W$。\n$W = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell}$\n$\\mathrm{MSE} = \\left(\\mathbb{E}[Q(h_{L})] - \\mathbb{E}[Q]\\right)^{2} + \\sum_{\\ell=0}^{L} \\frac{\\mathrm{Var}(\\Delta_{\\ell})}{N_{\\ell}} \\leq \\varepsilon^{2}$\n\n标度假设为：\n1.  偏差：$|\\mathbb{E}[Q(h_{L})] - \\mathbb{E}[Q]| \\leq c_{b} h_{L}^{\\alpha}$\n2.  层级方差：$\\mathrm{Var}(\\Delta_{\\ell}) \\asymp c_{v} h_{\\ell}^{\\beta}$，我们将其视为 $\\mathrm{Var}(\\Delta_{\\ell}) \\approx K_v h_{\\ell}^{\\beta}$，其中常数 $K_v  0$。\n3.  层级成本：$C_{\\ell} \\asymp c_{c} h_{\\ell}^{-\\gamma}$，我们将其视为 $C_{\\ell} \\approx K_c h_{\\ell}^{-\\gamma}$，其中常数 $K_c  0$。\n\n满足 MSE 约束的一个最优策略是平衡来自偏差平方和总方差的贡献。一个标准的选择是要求每一项都以 $\\varepsilon^2/2$ 为界：\na) $(\\text{偏差})^2 \\leq \\varepsilon^2/2 \\implies |\\mathbb{E}[Q(h_{L})] - \\mathbb{E}[Q]| \\leq \\varepsilon/\\sqrt{2}$。\nb) $\\sum_{\\ell=0}^{L} \\mathrm{Var}(\\Delta_{\\ell})/N_{\\ell} \\leq \\varepsilon^2/2$。\n\n根据约束(a)和偏差假设，我们必须选择最精细的层级 $L$ 使得：\n$c_{b} h_{L}^{\\alpha} \\leq \\varepsilon/\\sqrt{2}$\n由于 $h_{L} = h_{0} m^{-L}$，这个不等式决定了 $L$ 所需的最小值。对于 $\\varepsilon \\to 0$，渐近地，这意味着 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$。这又得到 $h_0 m^{-L} \\asymp \\varepsilon^{1/\\alpha}$，从而导致 $-L \\log m \\asymp (1/\\alpha) \\log \\varepsilon$，所以 $L \\asymp \\frac{1}{\\alpha \\log m} \\log(\\varepsilon^{-1})$。因此，$L$ 随 $\\varepsilon^{-1}$ 对数增长。\n\n接下来，我们在方差约束(b)下最小化功 $W$。为了使功最小，不等式变为等式：$\\sum_{\\ell=0}^{L} \\mathrm{Var}(\\Delta_{\\ell})/N_{\\ell} = \\varepsilon^2/2$。令 $V_{\\ell} = \\mathrm{Var}(\\Delta_{\\ell})$。我们在约束 $\\sum_{\\ell=0}^{L} V_{\\ell}/N_{\\ell} = \\varepsilon^2/2$ 下最小化 $W = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell}$。我们使用拉格朗日乘子法。\n拉格朗日函数是 $\\mathcal{L}(\\{N_{\\ell}\\}, \\lambda) = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell} + \\lambda \\left(\\sum_{\\ell=0}^{L} \\frac{V_{\\ell}}{N_{\\ell}} - \\frac{\\varepsilon^2}{2}\\right)$。\n将关于 $N_k$ 的偏导数设为零：\n$\\frac{\\partial \\mathcal{L}}{\\partial N_k} = C_k - \\lambda \\frac{V_k}{N_k^2} = 0 \\implies N_k^2 = \\lambda \\frac{V_k}{C_k} \\implies N_k = \\sqrt{\\lambda} \\sqrt{V_k/C_k}$。\n这表明在层级 $\\ell$ 上的最优样本数与 $\\sqrt{V_{\\ell}/C_{\\ell}}$ 成正比。\n\n为了找到比例常数 $\\sqrt{\\lambda}$，我们将 $N_{\\ell}$ 代回到方差约束中：\n$\\sum_{\\ell=0}^{L} \\frac{V_{\\ell}}{\\sqrt{\\lambda} \\sqrt{V_{\\ell}/C_{\\ell}}} = \\frac{1}{\\sqrt{\\lambda}} \\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}} = \\frac{\\varepsilon^2}{2}$。\n因此，$\\sqrt{\\lambda} = \\frac{2}{\\varepsilon^2} \\sum_{k=0}^{L} \\sqrt{V_k C_k}$。\n最优样本量为 $N_{\\ell} = \\frac{2}{\\varepsilon^2} \\left(\\sum_{k=0}^{L} \\sqrt{V_k C_k}\\right) \\sqrt{\\frac{V_{\\ell}}{C_{\\ell}}}$。\n\n那么最小总功为：\n$W = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell} = \\sum_{\\ell=0}^{L} \\left[ \\frac{2}{\\varepsilon^2} \\left(\\sum_{k=0}^{L} \\sqrt{V_k C_k}\\right) \\sqrt{\\frac{V_{\\ell}}{C_{\\ell}}} \\right] C_{\\ell} = \\frac{2}{\\varepsilon^2} \\left(\\sum_{k=0}^{L} \\sqrt{V_k C_k}\\right) \\left(\\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}}\\right)$。\n$W = \\frac{2}{\\varepsilon^2} \\left(\\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}}\\right)^2$。\n\n现在我们通过检查和 $\\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}}$ 来分析渐近复杂度。\n使用标度假设，$\\sqrt{V_{\\ell}C_{\\ell}} \\asymp \\sqrt{h_{\\ell}^{\\beta} h_{\\ell}^{-\\gamma}} = h_{\\ell}^{(\\beta-\\gamma)/2}$。\n利用 $h_{\\ell} = h_{0} m^{-\\ell}$，我们有 $h_{\\ell}^{(\\beta-\\gamma)/2} = (h_0 m^{-\\ell})^{(\\beta-\\gamma)/2} = h_0^{(\\beta-\\gamma)/2} (m^{-(\\beta-\\gamma)/2})^{\\ell}$。\n这个和是一个几何级数：$\\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}} \\asymp \\sum_{\\ell=0}^{L} (m^{-(\\beta-\\gamma)/2})^{\\ell}$。\n令比率为 $r = m^{-(\\beta-\\gamma)/2}$。其行为取决于 $r$。\n\n情况1：$\\beta > \\gamma$。\n那么 $\\beta - \\gamma > 0$，所以指数 $-(\\beta-\\gamma)/2$ 为负。由于 $m>1$，比率 $r = m^{-(\\beta-\\gamma)/2}$ 满足 $0  r  1$。当 $L \\to \\infty$ 时，几何级数收敛到一个常数：$\\sum_{\\ell=0}^{\\infty} r^{\\ell} = \\frac{1}{1-r}$。\n和为 $\\mathcal{O}(1)$。\n功为 $W \\asymp \\varepsilon^{-2} (\\mathcal{O}(1))^2 = \\mathcal{O}(\\varepsilon^{-2})$。\n\n情况2：$\\beta = \\gamma$。\n那么 $\\beta - \\gamma = 0$，所以比率 $r = m^0 = 1$。和变为：\n$\\sum_{\\ell=0}^{L} 1 = L+1$。\n由于 $L \\asymp \\log(\\varepsilon^{-1})$，和为 $\\mathcal{O}(\\log \\varepsilon^{-1})$。\n功为 $W \\asymp \\varepsilon^{-2} (\\mathcal{O}(\\log \\varepsilon^{-1}))^2 = \\mathcal{O}(\\varepsilon^{-2}(\\log \\varepsilon^{-1})^2)$。\n\n情况3：$\\beta  \\gamma$。\n那么 $\\beta - \\gamma  0$，所以指数 $-(\\beta-\\gamma)/2$ 为正。比率 $r = m^{(\\gamma-\\beta)/2}$ 大于1。几何级数由其最后一项主导：\n$\\sum_{\\ell=0}^{L} r^{\\ell} = \\frac{r^{L+1}-1}{r-1} \\asymp r^L$。\n和为 $\\asymp (m^{(\\gamma-\\beta)/2})^L = (m^L)^{(\\gamma-\\beta)/2}$。\n从 $h_L \\asymp \\varepsilon^{1/\\alpha}$，我们有 $h_0 m^{-L} \\asymp \\varepsilon^{1/\\alpha}$，所以 $m^L \\asymp \\varepsilon^{-1/\\alpha}$。\n和为 $\\asymp (\\varepsilon^{-1/\\alpha})^{(\\gamma-\\beta)/2} = \\varepsilon^{-(\\gamma-\\beta)/(2\\alpha)}$。\n功为 $W \\asymp \\varepsilon^{-2} \\left( \\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}} \\right)^2 \\asymp \\varepsilon^{-2} \\left( \\varepsilon^{-(\\gamma-\\beta)/(2\\alpha)} \\right)^2 = \\varepsilon^{-2} \\varepsilon^{-(\\gamma-\\beta)/\\alpha} = \\varepsilon^{-2 - (\\gamma-\\beta)/\\alpha}$。\n\n推导出的复杂度总结：\n- 如果 $\\beta > \\gamma$：$W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$。\n- 如果 $\\beta = \\gamma$：$W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2} (\\log \\varepsilon^{-1})^2)$。\n- 如果 $\\beta  \\gamma$：$W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2 - (\\gamma - \\beta)/\\alpha})$。\n\n现在我们评估给定的选项。\n\nA. 选择 $L(\\varepsilon)$ 为最小整数，使得 $c_{b} h_{L}^{\\alpha} \\leq \\varepsilon/\\sqrt{2}$；通过最优方差分配 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})/C_{\\ell}}$ 来选择样本量。那么，如果 $\\beta > \\gamma$，最小功的标度为 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$；如果 $\\beta = \\gamma$，为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\left(\\log \\varepsilon^{-1}\\right)^{2}\\right)$；如果 $\\beta  \\gamma$，为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2 - (\\gamma - \\beta)/\\alpha}\\right)$。\n这个陈述准确地描述了 $L$ 的最优选择（通过正确平衡偏差和方差误差）、样本 $N_{\\ell}$ 的最优分配（从拉格朗日乘子法推导得出）以及所有三种情况下的最终功复杂度。这些结果与我们的推导完全匹配。\n结论：**正确**。\n\nB. 选择 $L(\\varepsilon)$ 为最小整数，使得 $c_{b} h_{L}^{\\alpha} \\leq \\varepsilon^{2}$；分配样本为 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$。那么对于 $\\beta$ 和 $\\gamma$ 之间的所有关系，最小功的标度均为 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$，且没有对数因子。\n$L$ 的选择对应于 $\\mathcal{O}(\\varepsilon^4)$ 的偏差平方，这是一个效率低下的误差划分。分配 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$ 不是最优的。所声称的复杂度是不正确的，因为它忽略了对 $\\beta$ 和 $\\gamma$ 的依赖性。\n结论：**错误**。\n\nC. 选择 $L(\\varepsilon)$ 使得 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$；分配样本为 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})\\,C_{\\ell}}$。那么当 $\\beta = \\gamma$ 时，最小功的标度为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\log \\varepsilon^{-1}\\right)$；当 $\\beta  \\gamma$ 时，为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2 - (\\gamma - \\beta)/(2\\alpha)}\\right)$。\n$L$ 的选择是正确的。然而，样本分配 $N_{\\ell} \\propto \\sqrt{V_{\\ell}C_{\\ell}}$ 是不正确的；最优分配是 $N_{\\ell} \\propto \\sqrt{V_{\\ell}/C_{\\ell}}$。所断言的复杂度也是不正确的：对于 $\\beta=\\gamma$，对数因子是平方的，而不是1次方；对于 $\\beta\\gamma$，$\\varepsilon$ 的指数中分母是 $2\\alpha$，这是不正确的（应该是 $\\alpha$）。\n结论：**错误**。\n\nD. 选择 $L(\\varepsilon)$ 使得 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$；分配样本以均衡每层的方差贡献，即 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$。那么，如果 $\\beta > \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$；如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-3})$。\n$L$ 的选择是正确的。“均衡每层的方差贡献”的分配规则意味着 $V_{\\ell}/N_{\\ell} = \\text{常数}$，这暗示了 $N_{\\ell} \\propto V_{\\ell}$。这不是成本最优的分配。最终的功复杂度也被错误地陈述了。对于 $\\beta > \\gamma$，这种次优分配会导致 $W \\asymp \\varepsilon^{-2} \\log \\varepsilon^{-1}$，而不是 $\\varepsilon^{-2}$。对于 $\\beta  \\gamma$ 的断言通常也不成立。\n结论：**错误**。\n\nE. 在临界情况 $\\beta = \\gamma$下，如果使用最优分配 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})/C_{\\ell}}$，最小功的标度为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\log \\varepsilon^{-1}\\right)$，其中对数因子仅仅是因为 $L(\\varepsilon)$ 的增长方式类似于 $\\log \\varepsilon^{-1}$ 而产生。\n这个选项针对 $\\beta=\\gamma$ 的特定情况，并正确地指出了最优分配。然而，它将复杂度陈述为 $\\mathcal{O}(\\varepsilon^{-2} \\log \\varepsilon^{-1})$，这是不正确的。如推导所示，复杂度是 $\\mathcal{O}(\\varepsilon^{-2} (\\log \\varepsilon^{-1})^2)$，因为功与一个像 $L+1$ 增长的和的平方成正比。\n结论：**错误**。\n\n唯一完全正确的陈述是 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在完成一次MLMC模拟后，我们得到的是一个点估计值，但这本身并不完整。本练习将展示如何通过系统地结合统计误差（源于抽样）和离散化误差（偏差），为我们真正关心的期望值构建一个置信区间。通过这项实践，您将学会如何将原始的模拟输出转化为一个严谨的、量化了不确定性的统计结论 。",
            "id": "3322294",
            "problem": "考虑一个用于随机过程实值泛函 $P$ 期望的多层蒙特卡洛 (MLMC) 估计量，该估计量通过层级修正 $Y_{l} = P_{l} - P_{l-1}$（其中 $P_{-1} \\equiv 0$）的伸缩求和构建。在层级 $L$ 上，截断期望 $\\mathbb{E}[P_{L}]$ 的 MLMC 估计量形式为 $\\widehat{P}_{\\mathrm{ML}} = \\sum_{l=0}^{L} \\widehat{Y}_{l}$，其中 $\\widehat{Y}_{l}$ 是 $Y_{l}$ 的 $N_{l}$ 个独立同分布样本的样本均值。假设各层级之间相互独立，并且在每个层级 $l$ 上，样本方差 $s_{l}^{2}$ 是从 $N_{l}$ 个样本中计算得出的。\n\n假设给定以下条件：\n- 层级数 $L = 3$。\n- 样本量 $(N_{0}, N_{1}, N_{2}, N_{3}) = (1000, 800, 400, 200)$。\n- 样本方差 $(s_{0}^{2}, s_{1}^{2}, s_{2}^{2}, s_{3}^{2}) = (0.80, 0.40, 0.10, 0.025)$。\n- MLMC 点估计值 $\\widehat{P}_{\\mathrm{ML}} = 1.234$。\n- 一个基于弱阶 $\\alpha = 1$、常数 $C_{b} = 0.12$ 和二元细化因子 $2$ 的弱误差（偏差）界，使得截断偏差满足 $|\\mathbb{E}[P] - \\mathbb{E}[P_{L}]| \\leq C_{b} \\, 2^{-\\alpha L}$。\n- 置信水平参数 $\\delta = 0.05$。\n\n使用中心极限定理 (CLT) 处理 MLMC 估计量和方差估计量\n$$\\widehat{\\sigma}^{2} = \\sum_{l=0}^{L} \\frac{s_{l}^{2}}{N_{l}}$$\n来为 $\\mathbb{E}[P]$ 构建一个保守的双边 $(1-\\delta)$ 置信区间，该区间需要同时考虑抽样方差和截断偏差。您的构建必须基于第一性原理：伸缩表示、独立零均值项求和的中心极限定理以及偏差界。然后，使用给定数据计算区间的数值端点。将最终的区间端点四舍五入到四位有效数字。将最终答案表示为端点的有序对 $\\bigl[\\text{lower}, \\text{upper}\\bigr]$。",
            "solution": "该问题要求使用多层蒙特卡洛 (MLMC) 估计量，为目标量的真实期望 $\\mathbb{E}[P]$ 构建一个双边 $(1-\\delta)$ 置信区间。MLMC 点估计值 $\\widehat{P}_{\\mathrm{ML}}$ 相对于真实期望 $\\mathbb{E}[P]$ 的总误差可以分解为两个部分：统计误差和截断误差（偏差）。\n\n总误差由下式给出：\n$$\n\\mathbb{E}[P] - \\widehat{P}_{\\mathrm{ML}} = \\underbrace{(\\mathbb{E}[P] - \\mathbb{E}[P_{L}])}_{\\text{Bias}} + \\underbrace{(\\mathbb{E}[P_{L}] - \\widehat{P}_{\\mathrm{ML}})}_{\\text{Statistical Error}}\n$$\n此处，$\\mathbb{E}[P_{L}]$ 是在最精细层级 $L$ 上近似的目标量的期望。\n\n第一项，即偏差，是未知的，但我们得到了其大小的一个界：\n$$\n|\\mathbb{E}[P] - \\mathbb{E}[P_{L}]| \\leq B_{L}\n$$\n其中 $B_{L} = C_{b} \\, 2^{-\\alpha L}$。给定的参数是弱收敛阶 $\\alpha=1$、常数 $C_b=0.12$ 和层级数 $L=3$。我们可以计算这个界：\n$$\nB_{3} = C_{b} \\, 2^{-\\alpha L} = 0.12 \\times 2^{-1 \\times 3} = 0.12 \\times 2^{-3} = 0.12 \\times \\frac{1}{8} = 0.015\n$$\n\n第二项，即统计误差，是一个随机变量。MLMC 估计量定义为 $\\widehat{P}_{\\mathrm{ML}} = \\sum_{l=0}^{L} \\widehat{Y}_{l}$，其中 $\\widehat{Y}_{l}$ 是层级修正 $Y_l$ 的 $N_l$ 个实现的样本均值。MLMC 估计量的期望是 $\\mathbb{E}[\\widehat{P}_{\\mathrm{ML}}] = \\mathbb{E}[P_L]$，这意味着它是截断期望的一个无偏估计量。假设各层级之间相互独立，MLMC 估计量的方差是各层级估计量方差之和：\n$$\n\\mathbb{V}[\\widehat{P}_{\\mathrm{ML}}] = \\sum_{l=0}^{L} \\mathbb{V}[\\widehat{Y}_{l}] = \\sum_{l=0}^{L} \\frac{\\mathbb{V}[Y_{l}]}{N_{l}} = \\sum_{l=0}^{L} \\frac{\\sigma_{l}^{2}}{N_{l}}\n$$\n我们得到了一个基于样本方差 $s_{l}^{2}$ 的该方差的估计量：\n$$\n\\widehat{\\sigma}^{2} = \\sum_{l=0}^{L} \\frac{s_{l}^{2}}{N_{l}}\n$$\n使用 $L=3$ 的给定数据：\n- 样本量 $(N_{0}, N_{1}, N_{2}, N_{3}) = (1000, 800, 400, 200)$\n- 样本方差 $(s_{0}^{2}, s_{1}^{2}, s_{2}^{2}, s_{3}^{2}) = (0.80, 0.40, 0.10, 0.025)$\n我们计算估计方差：\n$$\n\\widehat{\\sigma}^{2} = \\frac{0.80}{1000} + \\frac{0.40}{800} + \\frac{0.10}{400} + \\frac{0.025}{200}\n$$\n$$\n\\widehat{\\sigma}^{2} = 0.0008 + 0.0005 + 0.00025 + 0.000125 = 0.001675\n$$\n估计标准差为 $\\widehat{\\sigma} = \\sqrt{0.001675}$。\n\n根据中心极限定理，统计误差经其标准差归一化后，其分布近似为标准正态分布。这使我们能够为截断期望 $\\mathbb{E}[P_{L}]$ 构建一个置信区间：\n$$\n\\mathbb{P}\\left(|\\widehat{P}_{\\mathrm{ML}} - \\mathbb{E}[P_{L}]| \\leq z_{1-\\delta/2} \\widehat{\\sigma}\\right) \\approx 1-\\delta\n$$\n其中 $z_{1-\\delta/2}$ 是标准正态分布的 $(1-\\delta/2)$-分位数。对于给定的置信参数 $\\delta = 0.05$，我们需要一个 $(1-0.05) = 0.95$ 的置信水平，这对应于 $z_{1-0.05/2} = z_{0.975} \\approx 1.96$。\n\n为了构建真实期望 $\\mathbb{E}[P]$ 的置信区间，我们必须同时考虑统计不确定性和偏差。一种保守的方法是将偏差界加到统计误差范围上。总误差的界为：\n$$\n|\\mathbb{E}[P] - \\widehat{P}_{\\mathrm{ML}}| \\leq |\\mathbb{E}[P] - \\mathbb{E}[P_L]| + |\\mathbb{E}[P_L] - \\widehat{P}_{\\mathrm{ML}}|\n$$\n这导出了 $\\mathbb{E}[P]$ 的一个形式为 $\\widehat{P}_{\\mathrm{ML}} \\pm E$ 的置信区间，其中总误差范围 $E$ 是统计半宽和偏差界之和：\n$$\nE = z_{1-\\delta/2} \\widehat{\\sigma} + B_{3}\n$$\n我们继续计算 $E$：\n$$\nE = 1.96 \\times \\sqrt{0.001675} + 0.015\n$$\n$$\nE \\approx 1.96 \\times 0.04092676 + 0.015 \\approx 0.08021645 + 0.015 = 0.09521645\n$$\n$\\mathbb{E}[P]$ 的置信区间由 $[\\text{下端点}, \\text{上端点}]$ 给出，其中：\n- 下端点：$\\widehat{P}_{\\mathrm{ML}} - E = 1.234 - 0.09521645 = 1.13878355$\n- 上端点：$\\widehat{P}_{\\mathrm{ML}} + E = 1.234 + 0.09521645 = 1.32921645$\n\n问题要求将最终的区间端点四舍五入到四位有效数字。\n- 下端点：$1.13878355 \\approx 1.139$\n- 上端点：$1.32921645 \\approx 1.329$\n\n最终得到的置信区间是 $[1.139, 1.329]$。",
            "answer": "$$\n\\boxed{[1.139, 1.329]}\n$$"
        },
        {
            "introduction": "MLMC方法的卓越效率依赖于两个精妙但至关重要的实施细节：确保不同层级计算间的独立性，以及在计算层级修正项时保持强相关性（耦合）。本练习旨在探讨这些规则背后的“为什么”。您将分析违反这些假设会如何影响估计量的偏差和方差，从而揭示MLMC方法的理论支柱，并帮助您避免常见的实施陷阱 。",
            "id": "3322274",
            "problem": "考虑一个通过随机模型（例如，一个随机微分方程的终端泛函）在概率空间上定义的目标量 $P$。令 $\\{P_l\\}_{l=0}^L$ 为一个由层级 $l$ 索引的、分辨率递增的离散近似层级，其中 $P_L$ 是所使用的最精细的近似。将多层蒙特卡洛（Multilevel Monte Carlo, MLMC）估计量定义为\n$$\n\\widehat{P}_L \\;=\\; \\frac{1}{N_0}\\sum_{i=1}^{N_0} P_0^{(i)} \\;+\\; \\sum_{l=1}^{L} \\frac{1}{N_l}\\sum_{i=1}^{N_l} \\Big(P_l^{(i)} - P_{l-1}^{(i)}\\Big),\n$$\n其中，对于每个层级 $l\\ge 1$，使用一种耦合方法生成配对 $\\big(P_l^{(i)},P_{l-1}^{(i)}\\big)$，该方法在配对内部共享随机性，以减小层级差分的方差。对于不同的层级 $l\\neq k$，标准的 MLMC 设计采用独立的随机数流，从而使各层级的平均值相互独立。在实践中，两个实现选择至关重要：\n\n- 每个层级平均值使用独立的随机流：用于构成不同层级平均值的随机输入是独立的。\n- 耦合配对 $\\big(P_l,P_{l-1}\\big)$ 内部的可复现共享随机性：该构造在每个配对内部使用一种从精细层级随机输入到粗糙层级输入的一致映射（例如，将精细网格上的布朗增量相加得到粗糙增量），从而使耦合稳定且可复制。\n\n从期望的线性性质、独立性下的方差可加性以及和的方差的协方差分解等基本原理出发，解释为什么标准的 MLMC 复杂度论证需要这两个实现选择。然后分析跨层级意外相关（例如，由于跨层级重用全局随机数生成器状态而未重置各层级种子）对 $\\widehat{P}_L$ 的偏差和方差的具体影响。你可以假设对于每个层级 $l$，$N_l$ 个样本 $\\{(P_l^{(i)},P_{l-1}^{(i)})\\}_{i=1}^{N_l}$ 是同分布的，并且它们的边际分布对于该层级的离散化是正确的。\n\n哪个陈述最能概括上述要求和后果？\n\nA. 跨层级平均值的独立性是不必要的，因为跨层级的意外相关性不会改变 $\\widehat{P}_L$ 的方差，而配对内部的可复现共享随机性通过破坏伸缩恒等式在 $\\mathbb{E}[\\widehat{P}_L]$ 中引入了偏差。\n\nB. 跨层级平均值的独立性对于标准的 MLMC 复杂度分析是必要的，因为它能得出 $\\operatorname{Var}[\\widehat{P}_L] = \\sum_{l=0}^L \\operatorname{Var}(Y_l)$，其中 $Y_0=\\frac{1}{N_0}\\sum_{i=1}^{N_0}P_0^{(i)}$ 且 $Y_l=\\frac{1}{N_l}\\sum_{i=1}^{N_l}(P_l^{(i)}-P_{l-1}^{(i)})$，并且每个耦合配对内的可复现共享随机性通过正的 $\\operatorname{Cov}(P_l,P_{l-1})$ 来最小化 $\\operatorname{Var}(P_l - P_{l-1})$。跨层级的意外相关性不改变 $\\mathbb{E}[\\widehat{P}_L]$，但会引入协方差项 $2\\sum_{0 \\le k  l \\le L} \\operatorname{Cov}(Y_k, Y_l)$，从而使标准的复杂度分析失效。\n\nC. 配对内部的可复现共享随机性对于确保 $\\widehat{P}_L$ 的无偏性是必要的，而跨层级平均值的独立性对于减小总方差是必要的，因为正的协方差项总会增加方差。\n\nD. 跨层级平均值的独立性对于使 $\\operatorname{Var}[P_l-P_{l-1}]$ 随 $l$ 衰减是必要的，而耦合对于通过确保 $\\operatorname{Cov}(Y_k, Y_l) > 0$ 来减小总方差是必要的。",
            "solution": "该问题探讨了多层蒙特卡洛（MLMC）方法中两个关键实现选择的理论依据：(1) 各层级平均值之间的独立性，以及 (2) 每个层级修正项内部的耦合。我们将从偏差和方差的角度分析这些选择。\n\n**偏差分析 (Analysis of Bias)**\nMLMC 估计量为 $\\widehat{P}_L = \\sum_{l=0}^{L} \\widehat{Y}_l$，其中 $\\widehat{Y}_0 = \\frac{1}{N_0}\\sum_{i=1}^{N_0} P_0^{(i)}$ 且 $\\widehat{Y}_l = \\frac{1}{N_l}\\sum_{i=1}^{N_l} (P_l^{(i)} - P_{l-1}^{(i)})$。\n利用期望的线性性质，我们可以计算 $\\widehat{P}_L$ 的期望值：\n$$ \\mathbb{E}[\\widehat{P}_L] = \\mathbb{E}\\left[\\sum_{l=0}^{L} \\widehat{Y}_l\\right] = \\sum_{l=0}^{L} \\mathbb{E}[\\widehat{Y}_l] $$\n对于每个层级 $l$，由于样本是同分布的，我们有：\n$$ \\mathbb{E}[\\widehat{Y}_0] = \\mathbb{E}[P_0] $$\n$$ \\mathbb{E}[\\widehat{Y}_l] = \\mathbb{E}[P_l - P_{l-1}] = \\mathbb{E}[P_l] - \\mathbb{E}[P_{l-1}] \\quad \\text{for } l \\ge 1 $$\n将这些代入，我们得到一个伸缩和（telescoping sum）：\n$$ \\mathbb{E}[\\widehat{P}_L] = \\mathbb{E}[P_0] + \\sum_{l=1}^{L} (\\mathbb{E}[P_l] - \\mathbb{E}[P_{l-1}]) = \\mathbb{E}[P_L] $$\n这个推导只依赖于期望的线性性质。它不要求各层级 $\\widehat{Y}_l$ 之间相互独立，也不受层级内部 $P_l$ 和 $P_{l-1}$ 之间是否存在耦合的影响。因此，**跨层级的意外相关性不会改变估计量的期望，即 $\\widehat{P}_L$ 仍然是 $\\mathbb{E}[P_L]$ 的一个无偏估计量。** 同样，**层级内部的耦合也不会引入偏差**。\n\n**方差分析 (Analysis of Variance)**\n$\\widehat{P}_L$ 的方差是：\n$$ \\operatorname{Var}[\\widehat{P}_L] = \\operatorname{Var}\\left[\\sum_{l=0}^{L} \\widehat{Y}_l\\right] = \\sum_{l=0}^{L} \\operatorname{Var}[\\widehat{Y}_l] + 2\\sum_{0 \\le k  l \\le L} \\operatorname{Cov}(\\widehat{Y}_k, \\widehat{Y}_l) $$\n\n1.  **跨层级独立性的作用**：\n    标准的 MLMC 假设各层级 $\\widehat{Y}_l$ 是相互独立的。在这种情况下，所有的协方差项 $\\operatorname{Cov}(\\widehat{Y}_k, \\widehat{Y}_l)$ 均为零。方差公式简化为：\n    $$ \\operatorname{Var}[\\widehat{P}_L] = \\sum_{l=0}^{L} \\operatorname{Var}[\\widehat{Y}_l] = \\sum_{l=0}^{L} \\frac{\\operatorname{Var}(Y_l)}{N_l} $$\n    其中 $Y_l$ 是单个修正项样本。这个简化的方差公式是标准 MLMC 复杂度理论的基石。它允许我们通过拉格朗日乘子法独立地优化每个 $N_l$ 来最小化总成本。如果存在**跨层级的意外相关性**，协方差项就不会消失，**标准的方差公式和复杂度分析将不再成立**。\n\n2.  **层级内部耦合的作用**：\n    耦合的目的是减小每个层级方差项 $\\operatorname{Var}[\\widehat{Y}_l] = \\operatorname{Var}[P_l - P_{l-1}]/N_l$ 的分子。利用方差的性质：\n    $$ \\operatorname{Var}[P_l - P_{l-1}] = \\operatorname{Var}[P_l] + \\operatorname{Var}[P_{l-1}] - 2\\operatorname{Cov}(P_l, P_{l-1}) $$\n    耦合通过在计算 $P_l$ 和 $P_{l-1}$ 时使用共同的随机数，旨在使它们强正相关，即**最大化正的协方差 $\\operatorname{Cov}(P_l, P_{l-1})$**。这会显著减小差值的方差 $\\operatorname{Var}[P_l - P_{l-1}]$，使其随着 $l$ 的增加而衰减。这是 MLMC 方法效率的核心。\n\n**评估选项**\n\n*   A. 错误。跨层级相关性会改变方差。耦合不会引入偏差。\n*   B. **正确**。它准确地描述了两个选择的作用：(1) 跨层级独立性是标准方差公式和复杂度分析的必要条件；(2) 层级内耦合通过产生正的 $\\operatorname{Cov}(P_l,P_{l-1})$ 来减小修正项的方差。它也正确地指出了违反跨层级独立性的后果：不改变期望，但引入协方差项，从而使标准分析失效。\n*   C. 错误。“耦合对于无偏性是必要的”是错误的。无偏性来自期望的线性性。\n*   D. 错误。“跨层级独立性对于使 $\\operatorname{Var}[P_l-P_{l-1}]$ 衰减是必要的”是错误的。该方差的衰减来自层级内部的耦合。此外，“耦合对于通过确保 $\\operatorname{Cov}(Y_k, Y_l) > 0$ 来减小总方差是必要的”也是错误的，耦合是关于 $\\operatorname{Cov}(P_l, P_{l-1})$，而不是跨层级的 $\\operatorname{Cov}(Y_k, Y_l)$。\n\n因此，选项 B 是对问题最完整和最准确的概括。",
            "answer": "$$\n\\boxed{B}\n$$"
        }
    ]
}