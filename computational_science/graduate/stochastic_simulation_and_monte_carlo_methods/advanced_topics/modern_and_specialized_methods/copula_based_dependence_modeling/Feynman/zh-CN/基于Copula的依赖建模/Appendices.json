{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握 copula，必须从其根本定义开始。这个练习将带您回到第一原理，通过分析 Farlie-Gumbel-Morgenstern (FGM) copula 来巩固您的基础知识。您将通过直接积分验证一个函数是否满足作为一个有效 copula 的所有条件——即边界条件、均匀边缘分布和至关重要的 2-单增性，后者确保了概率的非负性。此外，本练习要求您从肯德尔秩相关系数 (Kendall's tau) 的基本概率定义出发，推导出它与 copula 参数之间的关系，从而将抽象的依赖结构与具体的、可度量的关联性联系起来 。",
            "id": "3300458",
            "problem": "考虑单位平方上的一个二元函数，其密度由 Farlie–Gumbel–Morgenstern (FGM) copula 候选给出：\n$$\nc(u,v) \\;=\\; 1 + \\theta\\,(1 - 2u)(1 - 2v), \\quad (u,v)\\in[0,1]^2,\\quad \\theta\\in\\mathbb{R}.\n$$\n你只被告知，一个二元 copula 是在 $[0,1]^2$ 上具有均匀边缘分布的分布函数，并且一个函数 $C:[0,1]^2\\to[0,1]$ 是一个 copula 当且仅当它是根植的、具有均匀边缘分布且是 $2$-递增的，其中 $2$-递增性意味着对于任意轴对齐的矩形 $R=[u_1,u_2]\\times[v_1,v_2]\\subset[0,1]^2$（其中 $u_1\\le u_2$ 且 $v_1\\le v_2$），其体积\n$$\nV_C(R)\\;=\\; C(u_2,v_2)-C(u_2,v_1)-C(u_1,v_2)+C(u_1,v_1)\n$$\n是非负的。\n\n(a) 从这些定义出发，推导与给定的 $c(u,v)$ 对应的分布函数 $C(u,v)$，并确定对于哪些实数 $\\theta$ 值，函数 $C$ 是一个有效的 copula。你的验证必须明确地处理根植性、均匀边缘分布和 $2$-递增性。\n\n(b) 仅使用 Kendall's tau 作为连续二元分布一致性度量的定义，\n$$\n\\tau \\;=\\; \\mathbb{P}\\big((X-X')(Y-Y')>0\\big)\\;-\\;\\mathbb{P}\\big((X-X')(Y-Y')0\\big),\n$$\n其中 $(X,Y)$ 和 $(X',Y')$ 是独立同分布的，为你\n在 (a) 部分中得到的 copula 推导出一个关于 $\\theta$ 的 Kendall's tau 的闭式表达式。不要假设任何关于 Kendall's tau 的特殊公式；通过变换到均匀边缘分布并将其表示为一个可求值的积分，从第一性原理出发进行推导。\n\n以 $\\theta$ 的单个闭式解析表达式的形式提供你的最终答案。不需要数值近似。不要包含任何单位。如果你发现有效性的参数限制，在报告 Kendall's tau 时可以假设 $\\theta$ 满足这些限制。",
            "solution": "该问题分为两部分。部分 (a) 要求从给定的密度候选 $c(u,v)$ 推导分布函数 $C(u,v)$，并确定使 $C(u,v)$ 成为有效 copula 的参数 $\\theta$ 的范围。部分 (b) 要求为此 copula 族从第一性原理推导 Kendall's tau $\\tau$。\n\n### 部分 (a)：FGM Copula 的验证\n\n首先，我们通过对矩形 $[0,u]\\times[0,v]$ 上的密度 $c(s,t)$ 进行积分，来推导二元分布函数 $C(u,v)$。\n$$\nC(u,v) = \\int_0^u \\int_0^v \\left[1 + \\theta(1 - 2s)(1 - 2t)\\right] \\, dt \\, ds\n$$\n先对 $t$ 积分：\n$$\n\\int_0^v \\left[1 + \\theta(1 - 2s)(1 - 2t)\\right] \\, dt = \\left[t + \\theta(1 - 2s)(t - t^2)\\right]_{t=0}^{t=v} = v + \\theta(1 - 2s)(v - v^2)\n$$\n再对 $s$ 积分：\n$$\nC(u,v) = \\int_0^u \\left[v + \\theta(v - v^2)(1 - 2s)\\right] \\, ds = \\left[vs + \\theta(v - v^2)(s - s^2)\\right]_{s=0}^{s=u}\n$$\n$$\nC(u,v) = uv + \\theta(u - u^2)(v - v^2) = uv + \\theta u(1-u)v(1-v)\n$$\n这是 copula 分布函数的候选。现在，我们验证它成为有效 copula 的三个条件。\n\n1.  **根植性**：对于所有 $u, v \\in [0,1]$，必须有 $C(u,0) = 0$ 和 $C(0,v) = 0$。\n    $C(u,0) = u(0) + \\theta u(1-u)(0)(1-0) = 0$\n    $C(0,v) = (0)v + \\theta (0)(1-0)v(1-v) = 0$\n    该函数对于任何 $\\theta$ 值都是根植的。\n\n2.  **均匀边缘分布**：对于所有 $u, v \\in [0,1]$，必须有 $C(u,1) = u$ 和 $C(1,v) = v$。\n    $C(u,1) = u(1) + \\theta u(1-u)(1)(1-1) = u$\n    $C(1,v) = (1)v + \\theta (1)(1-1)v(1-v) = v$\n    该函数对于任何 $\\theta$ 值都具有均匀边缘分布。\n\n3.  **$2$-递增性**：由于密度 $c(u,v)$ 存在，此条件等价于要求密度在其定义域上处处非负，即对于所有 $(u,v) \\in [0,1]^2$ 都有 $c(u,v) \\ge 0$。\n    $$\n    1 + \\theta\\,(1 - 2u)(1 - 2v) \\ge 0\n    $$\n    项 $(1-2u)(1-2v)$ 的值域是 $[-1,1]$。\n    - 如果 $\\theta > 0$，为保证不等式成立，我们需要 $1 + \\theta \\cdot (\\min\\text{值}) \\ge 0 \\Rightarrow 1 + \\theta(-1) \\ge 0 \\Rightarrow \\theta \\le 1$。\n    - 如果 $\\theta  0$，为保证不等式成立，我们需要 $1 + \\theta \\cdot (\\max\\text{值}) \\ge 0 \\Rightarrow 1 + \\theta(1) \\ge 0 \\Rightarrow \\theta \\ge -1$。\n    结合这两种情况，函数 $C(u,v)$ 是一个有效的 copula 当且仅当 $\\theta \\in [-1, 1]$。\n\n### 部分 (b)：Kendall's Tau 的推导\n\nKendall's tau $\\tau$ 定义为从同一分布中抽取的两对独立随机变量 $(X,Y)$ 和 $(X',Y')$ 的一致性概率与不一致性概率之差。\n$$\n\\tau = \\mathbb{P}\\big((X-X')(Y-Y')>0\\big) - \\mathbb{P}\\big((X-X')(Y-Y')0\\big)\n$$\n一个基础的 copula 理论结果将 $\\tau$ 与 copula $C$ 及其密度 $c$ 联系起来：\n$$\n\\tau = 4 \\int_0^1 \\int_0^1 C(u,v)c(u,v) \\,du\\,dv - 1\n$$\n我们需要计算积分 $\\int_0^1 \\int_0^1 \\left(uv + \\theta u(1-u)v(1-v)\\right) \\left(1 + \\theta(1-2u)(1-2v)\\right) \\,du\\,dv$。\n我们使用以下辅助积分：\n- $\\int_0^1 u\\,du = 1/2$\n- $\\int_0^1 u(1-u)\\,du = 1/6$\n- $\\int_0^1 u(1-2u)\\,du = -1/6$\n- $\\int_0^1 u(1-u)(1-2u)\\,du = 0$\n\n展开被积函数并逐项积分：\n1.  $\\int\\int uv \\cdot 1 \\,dudv = (\\int u\\,du)(\\int v\\,dv) = (1/2)(1/2) = 1/4$\n2.  $\\int\\int uv \\cdot \\theta(1-2u)(1-2v) \\,dudv = \\theta (\\int u(1-2u)du)(\\int v(1-2v)dv) = \\theta(-1/6)(-1/6) = \\theta/36$\n3.  $\\int\\int \\theta u(1-u)v(1-v) \\cdot 1 \\,dudv = \\theta (\\int u(1-u)du)(\\int v(1-v)dv) = \\theta(1/6)(1/6) = \\theta/36$\n4.  $\\int\\int \\theta u(1-u)v(1-v) \\cdot \\theta(1-2u)(1-2v) \\,dudv = \\theta^2 (\\int u(1-u)(1-2u)du)(\\int v(1-v)(1-2v)dv) = \\theta^2(0)(0) = 0$\n\n将各项加总，得到积分值为 $1/4 + \\theta/36 + \\theta/36 + 0 = 1/4 + 2\\theta/36 = 1/4 + \\theta/18$。\n最后，代入 $\\tau$ 的公式：\n$$\n\\tau = 4 \\left( \\frac{1}{4} + \\frac{\\theta}{18} \\right) - 1 = 1 + \\frac{4\\theta}{18} - 1 = \\frac{2\\theta}{9}\n$$",
            "answer": "$$\\boxed{\\frac{2\\theta}{9}}$$"
        },
        {
            "introduction": "在实际应用中，我们常常需要根据观测到的数据依赖性来校准 copula 模型。这个练习聚焦于一个应用广泛的 copula 族——阿基米德 copula，以其中的 Clayton copula 为例。您将利用阿基米德 copula 生成函数的优美性质，推导其参数 $ \\theta $ 与肯德尔秩相关系数 $ \\tau $ 之间的解析关系。完成这个练习不仅能让您掌握一种重要的推导技巧，更能让您理解如何将一个经验上可估计的依赖度量（如 $ \\tau $）转化为一个可以直接用于模拟的 copula 模型参数 $ \\theta $，这是连接理论与实践的关键一步 。",
            "id": "3300435",
            "problem": "在为蒙特卡罗抽样校准一个二元相依模型时，您打算使用一个单参数阿基米德copula来捕捉正相依性，同时保持边缘设定分离。考虑参数为$\\theta0$的Clayton copula，其对$(u,v)\\in[0,1]^{2}$的定义为\n$$\nC(u,v) \\;=\\; \\left(u^{-\\theta} + v^{-\\theta} - 1\\right)^{-1/\\theta}.\n$$\n设$\\tau$表示其copula为$C$的二元分布的Kendall's tau。请仅使用copula和Kendall's tau的基本定义，推导出解析表达式$\\tau=\\tau(\\theta)$，然后将其反解以将$\\theta$表示为$\\tau$的函数。作为您的最终答案，请报告$\\theta$关于$\\tau$的闭式表达式。无需进行数值四舍五入，也不涉及任何物理单位。",
            "solution": "Kendall等级相关系数$\\tau$的基本定义是，从同一二元分布中抽取的两对独立随机变量$(X_1, Y_1)$和$(X_2, Y_2)$的一致性概率与不一致性概率之差。对于连续分布，即为$\\tau = P((X_1-X_2)(Y_1-Y_2)0) - P((X_1-X_2)(Y_1-Y_2)0)$。\n\nCopula理论中的一个基石性成果指出，对于任何具有copula $C$的二元分布，Kendall's tau仅取决于$C$。对于特定类别的阿基米德copula，其结构为$C(u,v) = \\phi^{-1}(\\phi(u) + \\phi(v))$（其中$\\phi$为合适的生成元函数），$\\tau$与生成元$\\phi$之间存在一个直接关系。该关系由以下恒等式给出：\n$$\n\\tau = 1 + 4 \\int_0^1 \\frac{\\phi(t)}{\\phi'(t)} \\, dt\n$$\n我们将使用这个基本关系来解决问题。\n\n首先，我们必须确定所提供的Clayton copula的生成元函数$\\phi(t)$：\n$$\nC(u,v) = \\left(u^{-\\theta} + v^{-\\theta} - 1\\right)^{-1/\\theta}\n$$\n参数为$\\theta  0$的Clayton族生成元是：\n$$\n\\phi(t) = \\frac{1}{\\theta} \\left(t^{-\\theta} - 1\\right)\n$$\n对于$\\theta  0$，此函数满足阿基米德生成元的必要属性：$\\phi(1) = \\frac{1}{\\theta}(1-1) = 0$，并且对于$t \\in (0, 1]$，$\\phi(t)$是一个非负、严格递减且凸的函数。\n\n接下来，我们计算生成元的导数$\\phi'(t)$：\n$$\n\\phi'(t) = \\frac{d}{dt} \\left[ \\frac{1}{\\theta} \\left(t^{-\\theta} - 1\\right) \\right] = \\frac{1}{\\theta} \\left(-\\theta t^{-\\theta-1}\\right) = -t^{-\\theta-1}\n$$\n\n现在，我们构建用于$\\tau$积分的比率$\\frac{\\phi(t)}{\\phi'(t)}$：\n$$\n\\frac{\\phi(t)}{\\phi'(t)} = \\frac{\\frac{1}{\\theta}\\left(t^{-\\theta} - 1\\right)}{-t^{-\\theta-1}} = -\\frac{1}{\\theta}\\left(t^{-\\theta} - 1\\right)t^{\\theta+1} = -\\frac{1}{\\theta}\\left(t^{-\\theta}t^{\\theta+1} - t^{\\theta+1}\\right) = -\\frac{1}{\\theta}\\left(t - t^{\\theta+1}\\right)\n$$\n\n我们现在计算$\\tau$公式中的定积分。由于$\\theta  0$，该积分是收敛的。\n$$\n\\int_0^1 \\frac{\\phi(t)}{\\phi'(t)} \\, dt = \\int_0^1 -\\frac{1}{\\theta}\\left(t - t^{\\theta+1}\\right) \\, dt\n$$\n$$\n= -\\frac{1}{\\theta} \\left[ \\frac{t^2}{2} - \\frac{t^{\\theta+2}}{\\theta+2} \\right]_0^1\n$$\n$$\n= -\\frac{1}{\\theta} \\left( \\left(\\frac{1^2}{2} - \\frac{1^{\\theta+2}}{\\theta+2}\\right) - \\left(\\frac{0^2}{2} - \\frac{0^{\\theta+2}}{\\theta+2}\\right) \\right)\n$$\n$$\n= -\\frac{1}{\\theta} \\left( \\frac{1}{2} - \\frac{1}{\\theta+2} \\right) = -\\frac{1}{\\theta} \\left( \\frac{(\\theta+2) - 2}{2(\\theta+2)} \\right) = -\\frac{1}{\\theta} \\left( \\frac{\\theta}{2(\\theta+2)} \\right)\n$$\n$$\n= -\\frac{1}{2(\\theta+2)}\n$$\n\n将此结果代回$\\tau$的公式：\n$$\n\\tau = 1 + 4 \\left( -\\frac{1}{2(\\theta+2)} \\right) = 1 - \\frac{2}{\\theta+2}\n$$\n$$\n\\tau = \\frac{(\\theta+2) - 2}{\\theta+2} = \\frac{\\theta}{\\theta+2}\n$$\n这给出了显式关系$\\tau = \\tau(\\theta)$。\n\n任务的最后一部分是反解此表达式，以求得$\\theta$作为$\\tau$的函数。我们从推导出的关系开始：\n$$\n\\tau = \\frac{\\theta}{\\theta+2}\n$$\n我们求解$\\theta$：\n$$\n\\tau (\\theta+2) = \\theta\n$$\n$$\n\\tau\\theta + 2\\tau = \\theta\n$$\n$$\n2\\tau = \\theta - \\tau\\theta\n$$\n$$\n2\\tau = \\theta(1 - \\tau)\n$$\n$$\n\\theta = \\frac{2\\tau}{1-\\tau}\n$$\n这是Clayton copula参数$\\theta$关于Kendall's tau $\\tau$的闭式表达式。条件$\\theta  0$对应于正相依结构，这意味着$0  \\tau  1$，在此条件下该表达式是良定义的。",
            "answer": "$$\n\\boxed{\\frac{2\\tau}{1-\\tau}}\n$$"
        },
        {
            "introduction": "在风险管理等领域，变量在极端情况下（即分布的“尾部”）同时出现异常波动的可能性至关重要，这一特性被称为尾部依赖。这个高级练习将探讨能够捕捉这种现象的 Student-t copula。您将推导其上、下尾部依赖系数 $ \\lambda_U $ 和 $ \\lambda_L $ 的精确表达式，并分析当自由度 $ \\nu $ 趋于无穷时（此时 Student-t copula 退化为高斯 copula）其极限行为。通过这个练习，您将深刻理解为什么 Student-t copula 是金融建模中的重要工具，以及它是如何与没有尾部依赖的高斯 copula 区别开来的 。",
            "id": "3300430",
            "problem": "考虑一个由自由度为 $\\nu \\in (2,\\infty)$、相关系数为 $\\rho \\in (-1,1)$ 的双变量学生t(Student-$t$)分布的椭圆尺度混合表示所构造的双变量学生t copula。设 $(X,Y)$ 是一个相关系数为 $\\rho$、共同自由度为 $\\nu$ 的双变量学生t随机向量，并定义copula变量 $U = t_{\\nu}(X)$ 和 $V = t_{\\nu}(Y)$，其中 $t_{\\nu}$ 表示自由度为 $\\nu$ 的标准单变量学生t分布的累积分布函数（CDF）。该copula的上尾部和下尾部依赖系数定义为\n$$\n\\lambda_{U} \\equiv \\lim_{u \\to 1^{-}} \\mathbb{P}\\!\\left(U  u \\mid V  u\\right), \n\\qquad\n\\lambda_{L} \\equiv \\lim_{u \\to 0^{+}} \\mathbb{P}\\!\\left(U \\leq u \\mid V \\leq u\\right).\n$$\n仅从copula尾部依赖的核心定义、双变量学生t定律的尺度混合构造，以及一个学生t分量在给定另一个分量下的精确条件分布出发，推导 $\\lambda_U$ 和 $\\lambda_L$ 的闭式表达式，该表达式以自由度为 $\\nu+1$ 的标准单变量学生t分布的CDF $t_{\\nu+1}$ 表示。然后，分析在固定 $\\rho \\in (-1,1)$ 的情况下，当 $\\nu \\to \\infty$ 时这些系数的极限值。你的最终答案必须是 $\\lambda_U=\\lambda_L$ 的单一闭式解析表达式及其当 $\\nu \\to \\infty$ 时的极限，并以行矩阵的形式呈现。不需要进行数值近似或四舍五入。",
            "solution": "该问题要求推导双变量学生t copula的上、下尾部依赖系数 $\\lambda_U$ 和 $\\lambda_L$，以及当自由度 $\\nu \\to \\infty$ 时它们的极限值。\n\n### 尾部依赖的对称性\n双变量学生t分布是椭圆分布，因此是中心对称的。这意味着随机向量 $(-X, -Y)$ 与 $(X,Y)$ 具有相同的分布。其关联的 copula $C(u,v)$ 具有径向对称性，即 $C(u,v) = u+v-1+C(1-u, 1-v)$。这个性质保证了上尾部和下尾部依赖系数相等。\n\n下尾部依赖系数为 $\\lambda_L = \\lim_{u \\to 0^+} \\frac{C(u,u)}{u}$。\n上尾部依赖系数为 $\\lambda_U = \\lim_{u \\to 1^-} \\frac{1 - 2u + C(u,u)}{1-u}$。\n令 $s = 1-u$，当 $u \\to 1^-$ 时，$s \\to 0^+$。\n$$\n\\lambda_U = \\lim_{s \\to 0^+} \\frac{1 - 2(1-s) + C(1-s, 1-s)}{s} = \\lim_{s \\to 0^+} \\frac{-1+2s+C(1-s, 1-s)}{s}\n$$\n使用径向对称性 $C(1-s, 1-s) = 1-2s+C(s,s)$，我们得到：\n$$\n\\lambda_U = \\lim_{s \\to 0^+} \\frac{-1+2s + (1-2s+C(s,s))}{s} = \\lim_{s \\to 0^+} \\frac{C(s,s)}{s} = \\lambda_L\n$$\n因此，$\\lambda_U = \\lambda_L$。我们用 $\\lambda$ 表示这个共同的值。\n\n### $\\lambda$ 的推导\n对于对称的 copula，尾部依赖系数也可以通过以下极限计算：\n$$\n\\lambda = 2 \\lim_{u \\to 1^-} \\mathbb{P}(V > u \\mid U=u)\n$$\n我们将这个概率极限转换回原始的 $X, Y$ 变量。令 $x_u = t_\\nu^{-1}(u)$。当 $u \\to 1^-$ 时，$x_u \\to \\infty$。\n$$\n\\lambda = 2 \\lim_{x_u \\to \\infty} \\mathbb{P}(Y > x_u \\mid X=x_u)\n$$\n根据问题中给出的条件分布性质，给定 $X=x$ 时，随机变量\n$$\nT = \\frac{Y - \\rho x}{\\sqrt{\\frac{\\nu+x^2}{\\nu+1}(1-\\rho^2)}}\n$$\n服从自由度为 $\\nu+1$ 的标准学生t分布（我们用 $T_{\\nu+1}$ 表示）。\n因此，条件概率可以表示为：\n$$\n\\mathbb{P}(Y > x \\mid X=x) = \\mathbb{P}\\left(T_{\\nu+1} > \\frac{x(1 - \\rho)}{\\sqrt{\\frac{\\nu+x^2}{\\nu+1}(1-\\rho^2)}} \\right)\n$$\n我们计算当 $x \\to \\infty$ 时，不等式右侧的极限：\n$$\n\\lim_{x \\to \\infty} \\frac{x(1 - \\rho)}{\\sqrt{\\frac{x^2(1+\\nu/x^2)}{\\nu+1}(1-\\rho^2)}} = \\frac{1 - \\rho}{\\sqrt{\\frac{1-\\rho^2}{\\nu+1}}} = \\frac{\\sqrt{1-\\rho}^2}{\\frac{\\sqrt{(1-\\rho)(1+\\rho)}}{\\sqrt{\\nu+1}}} = \\sqrt{\\frac{(\\nu+1)(1-\\rho)}{1+\\rho}}\n$$\n因此，极限概率为：\n$$\n\\lim_{x \\to \\infty} \\mathbb{P}(Y > x \\mid X=x) = \\mathbb{P}\\left(T_{\\nu+1} > \\sqrt{\\frac{(\\nu+1)(1-\\rho)}{1+\\rho}}\\right)\n$$\n使用 $T_{\\nu+1}$ 的累积分布函数 $t_{\\nu+1}$ 及其对称性 $\\mathbb{P}(T > z) = 1 - t_{\\nu+1}(z) = t_{\\nu+1}(-z)$，我们得到：\n$$\n\\lim_{x \\to \\infty} \\mathbb{P}(Y > x \\mid X=x) = t_{\\nu+1}\\left(-\\sqrt{\\frac{(\\nu+1)(1-\\rho)}{1+\\rho}}\\right)\n$$\n代入 $\\lambda$ 的表达式，得到最终结果：\n$$\n\\lambda = 2 t_{\\nu+1}\\left(-\\sqrt{\\frac{(\\nu+1)(1-\\rho)}{1+\\rho}}\\right)\n$$\n\n### 当 $\\nu \\to \\infty$ 时的极限行为\n我们分析当 $\\nu \\to \\infty$ 时 $\\lambda$ 的极限。\n当 $\\nu \\to \\infty$ 时，自由度为 $\\nu+1$ 的学生t分布 $t_{\\nu+1}$ 依分布收敛于标准正态分布，其CDF记为 $\\Phi(z)$。\nCDF的自变量 $A_\\nu = -\\sqrt{\\frac{(\\nu+1)(1-\\rho)}{1+\\rho}}$。由于 $\\rho \\in (-1,1)$，当 $\\nu \\to \\infty$ 时，$A_\\nu \\to -\\infty$。\n因此，尾部依赖系数的极限为：\n$$\n\\lim_{\\nu \\to \\infty} \\lambda = \\lim_{\\nu \\to \\infty} 2 t_{\\nu+1}\\left(A_\\nu\\right) = 2 \\lim_{A_\\nu \\to -\\infty} \\Phi(A_\\nu) = 2 \\times 0 = 0\n$$\n这个结果与以下事实相符：当 $\\nu \\to \\infty$ 时，学生t copula收敛于高斯copula，而已知对于任何相关系数 $\\rho \\in (-1,1)$，高斯copula的尾部依赖为零。\n\n最终答案包括 $\\lambda$ 的通用表达式及其在 $\\nu \\to \\infty$ 时的极限。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 t_{\\nu+1}\\left(-\\sqrt{\\frac{(\\nu+1)(1-\\rho)}{1+\\rho}}\\right)  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}