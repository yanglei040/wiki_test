{
    "hands_on_practices": [
        {
            "introduction": "Simulating wave phenomena in open regions requires artificially truncating the computational domain, a fundamental challenge in FDTD. This practice explores the foundational technique for achieving this: the Absorbing Boundary Condition (ABC). By deriving the first-order Mur ABC from the wave equation and analyzing its performance, you will gain a deep understanding of how these boundaries work and uncover their inherent limitations, particularly their sensitivity to the wave's angle of incidence .",
            "id": "3353919",
            "problem": "A three-dimensional Finite-Difference Time-Domain (FDTD) method on the Yee grid is used to simulate electromagnetic wave propagation in free space with speed of light $c$. The computational domain is bounded on one planar face by an absorbing boundary that is intended to minimize reflections. Consider a single tangential electric field component $E_{t}(x,y,z,t)$ at a planar boundary whose outward normal is along the $+x$ direction. The spatial steps are $\\Delta x$, $\\Delta y$, and $\\Delta z$, and the time step is $\\Delta t$, chosen to satisfy the Courant-Friedrichs-Lewy (CFL) stability condition. \n\n(a) Starting from the one-dimensional lossless wave equation for $E_{t}(x,t)$ in free space near that boundary, factor it into one-way wave equations and, by retaining only the component corresponding to an outgoing wave that leaves the domain across the boundary, derive a first-order local absorbing boundary condition (ABC) expressed as a first-order relation between temporal and normal spatial derivatives of $E_{t}$ on the boundary. Then, using first-order accurate one-sided finite differences consistent with the Yee staggering in the normal direction and forward time stepping, derive the explicit boundary update that relates the samples at the first two grid points adjacent to the boundary plane. Express your result in terms of the Courant number $S_{x} = c \\Delta t / \\Delta x$.\n\n(b) Generalize the result of part (a) to the full three-dimensional boundary face by applying the same one-dimensional update pointwise for each pair of tangential indices $(j,k)$ on the boundary plane, using one-sided differences in the normal direction and preserving the Yee stagger for the tangential electric field component.\n\n(c) Now consider a time-harmonic plane wave in free space with angular frequency $\\omega$ incident from within the computational domain onto the boundary plane at a polar angle $\\theta$ with respect to the boundary normal (the $x$-axis), with arbitrary azimuth. Under the continuous-plane approximation in which the field locally has the form $\\exp\\!\\big(i(k_{x} x + k_{y} y + k_{z} z - \\omega t)\\big)$ with $k = \\omega/c$, apply the first-order ABC derived in part (a) to the superposition of the incident and reflected waves at the boundary. Solve for the complex reflection coefficient as a function of $\\theta$. \n\nProvide your final answer as a single closed-form analytic expression for the magnitude of the reflection coefficient as a function of the incidence polar angle $\\theta$ (in radians), containing no other variables or parameters. Do not perform any numerical rounding.",
            "solution": "The problem is evaluated to be valid as it is scientifically grounded in computational electromagnetics, well-posed, and objective. It presents a standard, multi-part exercise on the derivation and analysis of absorbing boundary conditions for the finite-difference time-domain method. The problem is self-contained and provides a clear path to a unique solution.\n\n(a) Derivation of the First-Order Absorbing Boundary Condition and its Discretization\n\nWe begin with the one-dimensional lossless wave equation for a tangential electric field component $E_t(x,t)$ propagating in free space:\n$$ \\frac{\\partial^2 E_t}{\\partial x^2} - \\frac{1}{c^2} \\frac{\\partial^2 E_t}{\\partial t^2} = 0 $$\nwhere $c$ is the speed of light. The differential operator can be factored as:\n$$ \\left( \\frac{\\partial}{\\partial x} - \\frac{1}{c} \\frac{\\partial}{\\partial t} \\right) \\left( \\frac{\\partial}{\\partial x} + \\frac{1}{c} \\frac{\\partial}{\\partial t} \\right) E_t = 0 $$\nThis factorization separates the wave equation into two first-order one-way wave equations. The term $\\left( \\frac{\\partial}{\\partial x} + \\frac{1}{c} \\frac{\\partial}{\\partial t} \\right) E_t = 0$ corresponds to waves of the form $f(x-ct)$, which propagate in the $+x$ direction. The term $\\left( \\frac{\\partial}{\\partial x} - \\frac{1}{c} \\frac{\\partial}{\\partial t} \\right) E_t = 0$ corresponds to waves of the form $g(x+ct)$, which propagate in the $-x$ direction.\n\nThe computational domain is terminated by a boundary plane whose outward normal is in the $+x$ direction. To absorb waves leaving the domain, we must prevent reflections. An ideal absorbing boundary condition (ABC) should be transparent to outgoing waves. The outgoing wave is the one propagating in the $+x$ direction. Therefore, we enforce the condition that the field at the boundary must satisfy the one-way wave equation for a purely outgoing wave:\n$$ \\frac{\\partial E_t}{\\partial x} + \\frac{1}{c} \\frac{\\partial E_t}{\\partial t} = 0 $$\nThis is the first-order local absorbing boundary condition.\n\nTo derive an explicit update rule, we discretize this equation on the FDTD grid. Let the grid points in the $x$-direction be indexed by $i$, such that $x = i \\Delta x$. Let the discrete time steps be indexed by $n$, such that $t = n \\Delta t$. The tangential field component is denoted as $E_t(i\\Delta x, n\\Delta t) \\equiv E_t^n[i]$.\nLet the boundary be located at the grid index $i=I_{\\text{max}}$. We need to find the value of the field at this boundary point at the next time step, $E_t^{n+1}[I_{\\text{max}}]$.\n\nWe approximate the derivatives using first-order accurate finite differences, as specified. We use a forward difference for the time derivative and a one-sided backward difference for the spatial derivative, both evaluated at the boundary location $(x=I_{\\text{max}}\\Delta x, t=n\\Delta t)$:\n$$ \\frac{\\partial E_t}{\\partial t} \\approx \\frac{E_t^{n+1}[I_{\\text{max}}] - E_t^n[I_{\\text{max}}]}{\\Delta t} $$\n$$ \\frac{\\partial E_t}{\\partial x} \\approx \\frac{E_t^n[I_{\\text{max}}] - E_t^n[I_{\\text{max}}-1]}{\\Delta x} $$\nSubstituting these approximations into the ABC gives:\n$$ \\frac{E_t^n[I_{\\text{max}}] - E_t^n[I_{\\text{max}}-1]}{\\Delta x} + \\frac{1}{c} \\left( \\frac{E_t^{n+1}[I_{\\text{max}}] - E_t^n[I_{\\text{max}}]}{\\Delta t} \\right) = 0 $$\nThis scheme is explicit because the spatial derivative is evaluated at time step $n$, where all field values are known. Solving for $E_t^{n+1}[I_{\\text{max}}]$:\n$$ \\frac{E_t^{n+1}[I_{\\text{max}}] - E_t^n[I_{\\text{max}}]}{\\Delta t} = -c \\frac{E_t^n[I_{\\text{max}}] - E_t^n[I_{\\text{max}}-1]}{\\Delta x} $$\n$$ E_t^{n+1}[I_{\\text{max}}] = E_t^n[I_{\\text{max}}] - \\frac{c \\Delta t}{\\Delta x} \\left( E_t^n[I_{\\text{max}}] - E_t^n[I_{\\text{max}}-1] \\right) $$\nUsing the definition of the Courant number in the $x$-direction, $S_x = c \\Delta t / \\Delta x$, the update equation becomes:\n$$ E_t^{n+1}[I_{\\text{max}}] = E_t^n[I_{\\text{max}}] - S_x \\left( E_t^n[I_{\\text{max}}] - E_t^n[I_{\\text{max}}-1] \\right) $$\nThis can be rewritten as:\n$$ E_t^{n+1}[I_{\\text{max}}] = (1 - S_x) E_t^n[I_{\\text{max}}] + S_x E_t^n[I_{\\text{max}}-1] $$\nThis explicit update rule computes the field value at the boundary grid point $I_{\\text{max}}$ at the future time step $n+1$ using the field values at the current time step $n$ at the boundary point $I_{\\text{max}}$ and the adjacent interior point $I_{\\text{max}}-1$.\n\n(b) Generalization to Three Dimensions\n\nThe generalization of this one-dimensional ABC to a three-dimensional boundary face is achieved by applying the same update rule independently at each point on the boundary plane. The tangential electric field components, such as $E_y$ and $E_z$, are located at discrete points $(j,k)$ on the $y$-$z$ plane defined by $x = I_{\\text{max}}\\Delta x$. The update rule is applied pointwise for each tangential location.\nLet the discrete tangential field be denoted $E_t^n[i, j, k]$. For the boundary at $i=I_{\\text{max}}$, the update rule is:\n$$ E_t^{n+1}[I_{\\text{max}}, j, k] = (1 - S_x) E_t^n[I_{\\text{max}}, j, k] + S_x E_t^n[I_{\\text{max}}-1, j, k] $$\nThis equation is applied for all relevant indices $j$ and $k$ on the boundary plane, and for each tangential field component defined on that plane ($E_y$ and $E_z$), respecting the spatial staggering of the Yee grid.\n\n(c) Reflection Coefficient Analysis\n\nTo analyze the performance of the boundary condition, we apply the continuous form of the ABC from part (a) to a time-harmonic plane wave. For analytical convenience, let the boundary be located at the plane $x=0$, with the computational domain in the region $x<0$. The ABC is:\n$$ \\left. \\left( \\frac{\\partial E_t}{\\partial x} + \\frac{1}{c} \\frac{\\partial E_t}{\\partial t} \\right) \\right|_{x=0} = 0 $$\nA plane wave with angular frequency $\\omega$ is incident from within the domain ($x<0$) onto the boundary. The wave vector $\\mathbf{k}$ has magnitude $k = \\omega/c$. The polar angle of incidence $\\theta$ is the angle between $\\mathbf{k}$ and the normal to the boundary (the $x$-axis). The components of the wave vector are $k_x = k \\cos\\theta$, $k_y = k \\sin\\theta \\cos\\phi$, and $k_z = k \\sin\\theta \\sin\\phi$, where $\\phi$ is the azimuthal angle. The analysis is independent of $\\phi$. The incident wave, propagating towards positive $x$, is:\n$$ E_{\\text{inc}} = E_0 \\exp\\big(i(k_x x + k_y y + k_z z - \\omega t)\\big) $$\nThis wave is partially reflected at the boundary. The reflected wave propagates back into the domain (negative $x$ direction). By phase-matching conditions at the boundary, the reflected wave has the same frequency $\\omega$ and tangential wave vector components $k_y, k_z$. Its normal wave vector component must be $k'_x = -k_x = -k\\cos\\theta$. Let $R$ be the complex reflection coefficient. The reflected wave is:\n$$ E_{\\text{refl}} = R E_0 \\exp\\big(i(-k_x x + k_y y + k_z z - \\omega t)\\big) $$\nThe total field $E_t$ is the superposition of the incident and reflected fields:\n$$ E_t(x,y,z,t) = E_0 \\left( \\exp(ik_x x) + R \\exp(-ik_x x) \\right) \\exp\\big(i(k_y y + k_z z - \\omega t)\\big) $$\nWe now compute the derivatives required for the ABC.\n$$ \\frac{\\partial E_t}{\\partial x} = E_0 \\left( ik_x \\exp(ik_x x) - ik_x R \\exp(-ik_x x) \\right) \\exp\\big(i(k_y y + k_z z - \\omega t)\\big) $$\n$$ \\frac{\\partial E_t}{\\partial t} = E_0 \\left( \\exp(ik_x x) + R \\exp(-ik_x x) \\right) (-i\\omega) \\exp\\big(i(k_y y + k_z z - \\omega t)\\big) $$\nEvaluating these derivatives at the boundary $x=0$ and substituting into the ABC:\n$$ ik_x E_0 (1-R) + \\frac{1}{c} \\left( -i\\omega E_0 (1+R) \\right) = 0 $$\nAssuming $E_0 \\neq 0$ and $\\omega \\neq 0$, we can cancel the common factor $iE_0$:\n$$ k_x (1-R) - \\frac{\\omega}{c} (1+R) = 0 $$\nSubstituting $k_x = k \\cos\\theta$ and $k = \\omega/c$:\n$$ k \\cos\\theta (1-R) - k (1+R) = 0 $$\n$$ \\cos\\theta (1-R) - (1+R) = 0 $$\nNow, we solve for the reflection coefficient $R$:\n$$ \\cos\\theta - R \\cos\\theta - 1 - R = 0 $$\n$$ \\cos\\theta - 1 = R(1 + \\cos\\theta) $$\n$$ R(\\theta) = \\frac{\\cos\\theta - 1}{\\cos\\theta + 1} $$\nThe problem asks for the magnitude of the reflection coefficient, $|R|$. Since the angle of incidence $\\theta$ is in the range $[0, \\pi/2)$, $\\cos\\theta$ is a real number such that $0 < \\cos\\theta \\le 1$. Thus, $R$ is real. The numerator $\\cos\\theta - 1$ is non-positive, and the denominator $\\cos\\theta + 1$ is positive. Therefore, the magnitude is:\n$$ |R(\\theta)| = \\left| \\frac{\\cos\\theta - 1}{\\cos\\theta + 1} \\right| = \\frac{-(\\cos\\theta - 1)}{\\cos\\theta + 1} = \\frac{1 - \\cos\\theta}{1 + \\cos\\theta} $$\nUsing the trigonometric half-angle identities $1 - \\cos\\theta = 2 \\sin^2(\\theta/2)$ and $1 + \\cos\\theta = 2 \\cos^2(\\theta/2)$, this can be simplified to:\n$$ |R(\\theta)| = \\frac{2\\sin^2(\\theta/2)}{2\\cos^2(\\theta/2)} = \\tan^2\\left(\\frac{\\theta}{2}\\right) $$\nThis expression gives the reflection coefficient's magnitude purely as a function of the incidence angle $\\theta$.",
            "answer": "$$\\boxed{\\frac{1 - \\cos\\theta}{1 + \\cos\\theta}}$$"
        },
        {
            "introduction": "A key skill in computational science is quantifying the accuracy of different numerical methods. This exercise provides a framework for comparing the performance of a simple, local boundary condition with that of a modern, highly effective alternative. You will calculate the reflected energy from a first-order Mur ABC and contrast it with an ideal Perfectly Matched Layer (PML), offering a clear, quantitative demonstration of why PMLs are indispensable for accurate, wide-angle simulations .",
            "id": "3353911",
            "problem": "A two-dimensional electromagnetic plane wave propagates in free space and exits a finite computational window. The numerical method is the Finite-Difference Time-Domain (FDTD) method on the Yee scheme in two spatial dimensions, using the transverse magnetic polarization with nonzero components $E_z$, $H_x$, and $H_y$. The outward boundary of the window is terminated either by a local absorbing boundary condition (ABC) of first order due to Mur or by an ideal Perfectly Matched Layer (PML). Consider a pulsed plane wave with a Gaussian temporal envelope and a harmonic carrier. Your task is to derive from first principles the angular dependence of the reflection produced by the first-order Mur ABC and then compute the reflected energy fraction for a set of angles and carrier frequencies, contrasting it to the ideal PML case. All results must be reported as dimensionless decimals.\n\nStart from the fundamental Maxwell curl equations in free space and the Yee scheme discretization concept. Derive the one-way wave equation that underlies the first-order Mur ABC and determine the complex reflection coefficient $R(\\theta)$ for an obliquely incident time-harmonic plane wave at angle $\\theta$ with respect to the outward normal of the boundary. Explain how the angular sensitivity arises for such local ABCs. Then consider a pulsed plane wave with Gaussian spectrum $S(\\omega)$ centered at angular frequency $\\omega_0$ with standard deviation $\\sigma_\\omega$ and compute the reflected energy fraction\n$$\n\\mathcal{E}_{\\mathrm{ref}}(\\theta,\\omega_0,\\sigma_\\omega) \\;=\\; \\frac{\\int_{0}^{\\infty} \\left|R(\\theta)\\right|^2 \\left|S(\\omega)\\right|^2 \\,\\mathrm{d}\\omega}{\\int_{0}^{\\infty} \\left|S(\\omega)\\right|^2 \\,\\mathrm{d}\\omega}.\n$$\nUse the ideal continuous-theory limit for the PML, in which the reflection coefficient is zero for all incidence angles and frequencies.\n\nAssume free space speed of light $c = 299{,}792{,}458\\,\\mathrm{m/s}$. The Gaussian spectrum is defined by\n$$\nS(\\omega) \\;=\\; \\exp\\!\\left(-\\frac{(\\omega-\\omega_0)^2}{2\\sigma_\\omega^2}\\right),\n$$\nwith $\\sigma_\\omega = 0.2\\pi f_0$, where $f_0 = \\omega_0/(2\\pi)$ is the carrier frequency. Angles are provided in degrees and must be converted to radians for calculations. Frequencies are provided in hertz (Hz). The final outputs are dimensionless reflected energy fractions.\n\nUse the following test suite of angle-frequency pairs:\n- $(\\theta, f_0) = (0^\\circ, 2\\times 10^9\\,\\mathrm{Hz})$,\n- $(\\theta, f_0) = (30^\\circ, 2\\times 10^9\\,\\mathrm{Hz})$,\n- $(\\theta, f_0) = (60^\\circ, 2\\times 10^9\\,\\mathrm{Hz})$,\n- $(\\theta, f_0) = (80^\\circ, 2\\times 10^9\\,\\mathrm{Hz})$,\n- $(\\theta, f_0) = (30^\\circ, 10\\times 10^9\\,\\mathrm{Hz})$,\n- $(\\theta, f_0) = (60^\\circ, 10\\times 10^9\\,\\mathrm{Hz})$.\n\nFor each test case, compute two numbers: the Mur ABC reflected energy fraction and the ideal PML reflected energy fraction. Your program should produce a single line of output containing the results as a comma-separated list of pairs enclosed in square brackets, in the order given above. Each pair must be a list of two floats rounded to six decimal places, representing $[\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}}, \\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{PML}}]$. For example, your final output format must look like:\n\"[[mur1,pml1],[mur2,pml2],...]\" with no additional text.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in the principles of computational electromagnetics, is well-posed with all necessary data provided, and is formulated objectively. We may therefore proceed with a solution.\n\n**1. Maxwell's Equations and the 2D Wave Equation**\n\nWe begin from Maxwell's curl equations in a source-free, lossless medium (free space, with permittivity $\\epsilon_0$ and permeability $\\mu_0$):\n$$ \\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} $$\nFor a two-dimensional ($2\\text{D}$) transverse magnetic (TM) wave, the fields are constrained to $\\mathbf{E} = E_z(x, y, t)\\hat{\\mathbf{z}}$ and $\\mathbf{H} = H_x(x, y, t)\\hat{\\mathbf{x}} + H_y(x, y, t)\\hat{\\mathbf{y}}$. The scalar components of the curl equations are:\n$$ \\frac{\\partial E_z}{\\partial y} = -\\mu_0 \\frac{\\partial H_x}{\\partial t} \\quad (1) $$\n$$ -\\frac{\\partial E_z}{\\partial x} = -\\mu_0 \\frac{\\partial H_y}{\\partial t} \\quad (2) $$\n$$ \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y} = \\epsilon_0 \\frac{\\partial E_z}{\\partial t} \\quad (3) $$\nTo obtain a wave equation for $E_z$, we differentiate equation ($2$) with respect to $x$ and equation ($1$) with respect to $y$, and substitute into the time derivative of equation ($3$):\n$$ \\frac{\\partial}{\\partial t}\\left(\\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\\right) = \\epsilon_0 \\frac{\\partial^2 E_z}{\\partial t^2} $$\n$$ \\frac{1}{\\mu_0}\\frac{\\partial^2 E_z}{\\partial x^2} + \\frac{1}{\\mu_0}\\frac{\\partial^2 E_z}{\\partial y^2} = \\epsilon_0 \\frac{\\partial^2 E_z}{\\partial t^2} $$\nUsing the free space speed of light $c = 1/\\sqrt{\\mu_0 \\epsilon_0}$, we arrive at the $2\\text{D}$ scalar wave equation:\n$$ \\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}\\right)E_z - \\frac{1}{c^2}\\frac{\\partial^2 E_z}{\\partial t^2} = 0 $$\nThe Yee scheme provides a staggered-grid, finite-difference discretization of these first-order curl equations, but the theoretical analysis of the ABC's reflection properties is most clearly performed on the continuous partial differential equations.\n\n**2. First-Order Mur Absorbing Boundary Condition (ABC)**\n\nThe principle behind local ABCs is to approximate the full wave equation with a \"one-way\" wave equation that permits waves to travel only out of the computational domain. In one dimension, the wave operator factors perfectly:\n$$ \\frac{\\partial^2}{\\partial x^2} - \\frac{1}{c^2}\\frac{\\partial^2}{\\partial t^2} = \\left(\\frac{\\partial}{\\partial x} - \\frac{1}{c}\\frac{\\partial}{\\partial t}\\right)\\left(\\frac{\\partial}{\\partial x} + \\frac{1}{c}\\frac{\\partial}{\\partial t}\\right) $$\nThe operators on the right describe waves traveling purely in the $-x$ and $+x$ directions, respectively. The first-order Mur ABC for a boundary at the edge of the domain (e.g., at $x=x_{\\text{max}}$) designed to absorb outgoing waves (propagating in the $+x$ direction) is simply:\n$$ \\left(\\frac{\\partial}{\\partial x} + \\frac{1}{c}\\frac{\\partial}{\\partial t}\\right) E_z = 0 $$\nThis equation is exact only for a plane wave propagating at normal incidence to the boundary (i.e., purely in the $x$-direction).\n\n**3. Derivation of the Reflection Coefficient $R(\\theta)$**\n\nConsider a time-harmonic plane wave $E_z \\propto e^{-i\\omega t}$ incident on an absorbing boundary located at the plane $x=0$. The computational domain is $x<0$. The wave propagates from within the domain towards the boundary, at an angle $\\theta$ with respect to the outward normal (the $+x$ axis). The wave vector of this incident wave is $\\mathbf{k} = (k_x, k_y)$, where $k_x = k \\cos\\theta$, $k_y = k \\sin\\theta$, and $k = \\omega/c$ is the free-space wavenumber.\n\nThe total field near the boundary is the superposition of the incident (outgoing from the domain) wave and a spuriously reflected wave:\n$$ E_z(x,y) = E_{\\text{inc}} e^{i(k_x x + k_y y)} + E_{\\text{ref}} e^{i(-k_x x + k_y y)} $$\nThe reflection coefficient is defined as $R = E_{\\text{ref}}/E_{\\text{inc}}$ evaluated at the boundary $x=0$. The Mur ABC for a time-harmonic field becomes:\n$$ \\left(\\frac{\\partial}{\\partial x} - i\\frac{\\omega}{c}\\right) E_z = 0 \\quad \\implies \\quad \\left(\\frac{\\partial}{\\partial x} - ik\\right) E_z = 0 $$\nWe apply this condition to the total field at the boundary $x=0$:\n$$ \\frac{\\partial E_z}{\\partial x}\\bigg|_{x=0} = ik_x E_{\\text{inc}} e^{ik_y y} - ik_x E_{\\text{ref}} e^{ik_y y} $$\n$$ E_z\\big|_{x=0} = (E_{\\text{inc}} + E_{\\text{ref}})e^{ik_y y} $$\nSubstituting these into the boundary condition operator:\n$$ (ik_x E_{\\text{inc}} - ik_x E_{\\text{ref}}) - ik(E_{\\text{inc}} + E_{\\text{ref}}) = 0 $$\n$$ E_{\\text{inc}}(ik_x - ik) - E_{\\text{ref}}(ik_x + ik) = 0 $$\n$$ E_{\\text{ref}}(k_x + k) = E_{\\text{inc}}(k_x - k) $$\nSolving for the reflection coefficient $R(\\theta) = E_{\\text{ref}}/E_{\\text{inc}}$:\n$$ R(\\theta) = \\frac{k_x - k}{k_x + k} $$\nSubstituting $k_x = k \\cos\\theta$:\n$$ R(\\theta) = \\frac{k \\cos\\theta - k}{k \\cos\\theta + k} = \\frac{\\cos\\theta - 1}{\\cos\\theta + 1} $$\nThis expression is independent of frequency $\\omega$, a characteristic of the continuous form of the first-order Mur ABC.\n\n**4. Angular Sensitivity and Reflected Energy Fraction**\n\nThe angular sensitivity arises because the Mur ABC is derived from a one-way wave operator that is exact only for normal incidence ($\\theta=0$). At normal incidence, $\\cos(0)=1$, $k_x=k$, and $R(0)=0$, indicating perfect absorption. As the angle of incidence $\\theta$ increases, the wave's propagation direction deviates from the boundary normal. The operator $(\\frac{\\partial}{\\partial x} + \\frac{1}{c}\\frac{\\partial}{\\partial t})$ becomes an increasingly poor approximation for annihilating the wave, leading to a non-zero reflection coefficient. For grazing incidence ($\\theta \\to \\pi/2$), $\\cos(\\theta)\\to 0$, and $R(\\theta)\\to -1$, indicating total reflection.\n\nThe reflected energy fraction for a pulse is given by a weighted average of the power reflection coefficient $|R|^2$ over the pulse's power spectrum $|S(\\omega)|^2$:\n$$ \\mathcal{E}_{\\mathrm{ref}}(\\theta,\\omega_0,\\sigma_\\omega) = \\frac{\\int_{0}^{\\infty} |R(\\theta,\\omega)|^2 |S(\\omega)|^2 \\,\\mathrm{d}\\omega}{\\int_{0}^{\\infty} |S(\\omega)|^2 \\,\\mathrm{d}\\omega} $$\nFor the first-order Mur ABC, we found $R$ is independent of $\\omega$. Therefore, $|R(\\theta)|^2$ is a constant with respect to the integration variable $\\omega$:\n$$ \\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}} = \\frac{|R(\\theta)|^2 \\int_{0}^{\\infty} |S(\\omega)|^2 \\,\\mathrm{d}\\omega}{\\int_{0}^{\\infty} |S(\\omega)|^2 \\,\\mathrm{d}\\omega} = |R(\\theta)|^2 $$\nThus, the reflected energy fraction is simply the squared magnitude of the reflection coefficient:\n$$ \\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}}(\\theta) = \\left(\\frac{\\cos\\theta - 1}{\\cos\\theta + 1}\\right)^2 = \\left(\\frac{1 - \\cos\\theta}{1 + \\cos\\theta}\\right)^2 $$\nThe specific form of the Gaussian spectrum $S(\\omega)$ and the parameters $\\omega_0$ and $\\sigma_\\omega$ are not needed for this calculation, as they cancel out.\n\n**5. Ideal Perfectly Matched Layer (PML)**\n\nThe problem states that for an ideal PML in the continuous limit, the reflection coefficient is zero for all angles and frequencies: $R_{\\mathrm{PML}}(\\theta, \\omega) = 0$. Consequently, the reflected energy fraction is always zero:\n$$ \\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{PML}} = \\frac{\\int_{0}^{\\infty} 0 \\cdot |S(\\omega)|^2 \\,\\mathrm{d}\\omega}{\\int_{0}^{\\infty} |S(\\omega)|^2 \\,\\mathrm{d}\\omega} = 0 $$\nThis holds for all test cases.\n\n**6. Final Calculations**\n\nWe now compute $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}}$ and $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{PML}}$ for the given test suite. Note that the carrier frequency $f_0$ does not affect the result in either case.\n\n- **Case 1**: $(\\theta, f_0) = (0^{\\circ}, 2 \\times 10^9\\,\\mathrm{Hz})$\n$\\theta = 0\\,\\mathrm{rad}$. $\\cos(0) = 1$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}} = (\\frac{1-1}{1+1})^2 = 0$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{PML}} = 0$.\n\n- **Case 2**: $(\\theta, f_0) = (30^{\\circ}, 2 \\times 10^9\\,\\mathrm{Hz})$\n$\\theta = \\pi/6\\,\\mathrm{rad}$. $\\cos(\\pi/6) = \\sqrt{3}/2$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}} = (\\frac{1-\\sqrt{3}/2}{1+\\sqrt{3}/2})^2 \\approx 0.005155$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{PML}} = 0$.\n\n- **Case 3**: $(\\theta, f_0) = (60^{\\circ}, 2 \\times 10^9\\,\\mathrm{Hz})$\n$\\theta = \\pi/3\\,\\mathrm{rad}$. $\\cos(\\pi/3) = 1/2$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}} = (\\frac{1-1/2}{1+1/2})^2 = (1/3)^2 \\approx 0.111111$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{PML}} = 0$.\n\n- **Case 4**: $(\\theta, f_0) = (80^{\\circ}, 2 \\times 10^9\\,\\mathrm{Hz})$\n$\\theta = 4\\pi/9\\,\\mathrm{rad}$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}} = (\\frac{1-\\cos(4\\pi/9)}{1+\\cos(4\\pi/9)})^2 \\approx 0.495700$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{PML}} = 0$.\n\n- **Case 5**: $(\\theta, f_0) = (30^{\\circ}, 10 \\times 10^9\\,\\mathrm{Hz})$\nResult is identical to Case 2: $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}} \\approx 0.005155$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{PML}} = 0$.\n\n- **Case 6**: $(\\theta, f_0) = (60^{\\circ}, 10 \\times 10^9\\,\\mathrm{Hz})$\nResult is identical to Case 3: $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{Mur}} \\approx 0.111111$. $\\mathcal{E}_{\\mathrm{ref}}^{\\mathrm{PML}} = 0$.\n\nThese results will be computed and formatted in the program below.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reflected energy fraction for a first-order Mur ABC\n    and an ideal PML for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (angle_in_degrees, frequency_in_Hz).\n    # The frequency is not used in the calculation, as the reflection\n    # coefficient for the continuous Mur ABC is frequency-independent,\n    # and the ideal PML has zero reflection by definition.\n    test_cases = [\n        (0.0, 2.0e9),\n        (30.0, 2.0e9),\n        (60.0, 2.0e9),\n        (80.0, 2.0e9),\n        (30.0, 10.0e9),\n        (60.0, 10.0e9),\n    ]\n\n    results = []\n    for case in test_cases:\n        theta_deg, f0 = case\n        \n        # Convert angle from degrees to radians for trigonometric functions.\n        theta_rad = np.deg2rad(theta_deg)\n        \n        # --- Mur ABC Calculation ---\n        # The reflected energy fraction for the continuous first-order Mur ABC is |R(theta)|^2.\n        # R(theta) = (cos(theta) - 1) / (cos(theta) + 1).\n        # So, E_ref = ((1 - cos(theta)) / (1 + cos(theta)))^2.\n        \n        cos_theta = np.cos(theta_rad)\n        \n        # The denominator is 1 + cos(theta). It is zero only if theta = 180 degrees,\n        # which is not in the test suite. For theta = 0, the numerator is zero.\n        if np.isclose(cos_theta, -1.0):\n            # This case corresponds to theta = 180 degrees, leading to infinite reflection.\n            # It's a theoretical singularity not relevant for waves exiting a domain.\n            mur_ref_e = np.inf\n        else:\n            mur_ref_e = ((1.0 - cos_theta) / (1.0 + cos_theta))**2\n            \n        # --- Ideal PML Calculation ---\n        # For an ideal PML, the reflection is zero for all angles and frequencies.\n        pml_ref_e = 0.0\n        \n        # Append the pair of results, rounded to six decimal places.\n        results.append([round(mur_ref_e, 6), round(pml_ref_e, 6)])\n\n    # Final print statement in the exact required format.\n    # The format is [[mur1,pml1],[mur2,pml2],...], which requires a custom\n    # string-building process to avoid spaces introduced by str().\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "The practical utility of the FDTD method depends not only on its physical accuracy but also on its computational efficiency. This exercise bridges theory and high-performance computing by building a complete error budget that includes both algorithmic (dispersion) and floating-point errors. Furthermore, it delves into the critical topic of memory layout optimization for modern GPUs, showing how data structures directly impact performance through memory coalescing .",
            "id": "3353975",
            "problem": "You are to design, analyze, and implement a computational experiment that connects Graphics Processing Unit (GPU) coalesced memory access in a Yee finite-difference time-domain (FDTD) kernel with numerical dispersion and floating-point precision. Your task is to proceed from fundamental electromagnetic laws to concrete, testable predictions about phase errors and memory efficiency under simplified but scientifically consistent models.\n\nStart from the source-free macroscopic Maxwell equations in one spatial dimension for linear, isotropic, homogeneous media with relative permittivity and permeability equal to one, using nondimensionalized units such that the speed of light is $c = 1$:\n- $\\nabla \\times \\mathbf{E} = -\\dfrac{\\partial \\mathbf{H}}{\\partial t}$,\n- $\\nabla \\times \\mathbf{H} = \\dfrac{\\partial \\mathbf{E}}{\\partial t}$,\n- $\\nabla \\cdot \\mathbf{E} = 0$,\n- $\\nabla \\cdot \\mathbf{H} = 0$.\n\nUse the Yee finite-difference time-domain (FDTD) scheme (Yee scheme) in one spatial dimension with a staggered grid, grid spacing $\\Delta x$, and time step $\\Delta t$, with the Courant number $S = c \\,\\Delta t / \\Delta x$, and in the nondimensionalization fix $c = 1$ and $\\Delta x = 1$, so that $S = \\Delta t$. Derive the discrete dispersion relation for the Yee scheme and define a phase error measure as follows. For a plane wave with wavenumber $k$ (nondimensionalized $k$), define the continuum angular frequency $\\omega_{\\mathrm{exact}}(k) = k$. Derive the numerical angular frequency $\\omega_{\\mathrm{num}}(k, S)$ from the Yee update. Over a propagation time $T_{\\mathrm{prop}} = N_{\\mathrm{steps}} \\,\\Delta t$, define the dispersion-induced phase error as $\\phi_{\\mathrm{disp}}(k; S, N_{\\mathrm{steps}}) = \\left|\\left(\\omega_{\\mathrm{num}}(k, S) - \\omega_{\\mathrm{exact}}(k)\\right) T_{\\mathrm{prop}}\\right|$. For a wavenumber band $k \\in [k_{\\min}, k_{\\max}]$, define the worst-case dispersion error as $\\max_{k \\in [k_{\\min}, k_{\\max}]} \\phi_{\\mathrm{disp}}(k; S, N_{\\mathrm{steps}})$.\n\nNext, formulate a floating-point rounding error budget for the Yee update. Assume binary floating-point with unit roundoff $u_{32} = 2^{-24}$ for $32$-bit single precision and $u_{64} = 2^{-53}$ for $64$-bit double precision. Consider two computational modes:\n- Single precision: all arithmetic and storage use $32$-bit single precision. Assume a canonical one-dimensional Yee update introduces $r_{\\mathrm{single}} = 6$ unit roundoff contributions per time step per spatial location that can coherently add to phase error in the worst case.\n- Mixed precision: arithmetic is performed in $64$-bit double precision while storage is in $32$-bit single precision, so that only the stores round to single precision. Assume this introduces $r_{\\mathrm{mixed}} = 2$ unit roundoff contributions per time step per spatial location that can coherently add to phase error in the worst case.\n\nUnder a worst-case coherent accumulation model, bound the rounding-induced phase error after $N_{\\mathrm{steps}}$ Yee updates by $\\phi_{\\mathrm{round}} \\le N_{\\mathrm{steps}} \\, r \\, u$, where $r$ and $u$ are chosen according to the computational mode. Define the total worst-case phase error over a band by the sum of dispersion and rounding bounds: $\\phi_{\\mathrm{total,wc}}([k_{\\min}, k_{\\max}]; S, N_{\\mathrm{steps}}, r, u) = \\max_{k \\in [k_{\\min}, k_{\\max}]} \\phi_{\\mathrm{disp}}(k; S, N_{\\mathrm{steps}}) + N_{\\mathrm{steps}} \\, r \\, u$. All phases and phase errors must be expressed in radians.\n\nFinally, analyze GPU memory coalescing for a Yee kernel that reads a single field component at a time. Consider a warp of $W = 32$ concurrent threads, each loading one element from global memory. Assume the hardware memory transaction segment size is $128$ bytes. Model coalescing efficiency as follows. A warp issues $m$ memory transactions equal to the number of distinct $128$-byte segments touched by the $W$ loads. Define the coalescing efficiency as $\\eta = 1/m$. Assume base addresses are $128$-byte aligned. Consider two memory layouts:\n- Structure of Arrays (SoA): six separate arrays for $E_x, E_y, E_z, H_x, H_y, H_z$. Reading $E_x$ along the $x$-direction at fixed $y, z$, consecutive threads read consecutive $E_x$ elements.\n- Array of Structures (AoS): one array of structures per cell with interleaved components in the order $(E_x, E_y, E_z, H_x, H_y, H_z)$.\n\nAssume elements are either $32$-bit ($4$ bytes) or $64$-bit ($8$ bytes). Threads in a warp are numbered $t = 0, 1, \\dots, 31$ and read addresses $a_t = a_0 + t \\cdot s \\cdot b$, where $b$ is the element size in bytes and $s$ is the stride in elements. For SoA when reading a single field component along $x$, take $s = 1$. For AoS when reading a single field component, take $s = 6$ because of interleaving.\n\nYour program must:\n- Derive and implement the Yee scheme dispersion relation and compute $\\phi_{\\mathrm{disp}}$ over a band by numerical evaluation over a sufficiently dense uniform sampling in $k \\in [k_{\\min}, k_{\\max}]$.\n- Implement the rounding error bound and compute $\\phi_{\\mathrm{total,wc}}$ for both single precision and mixed precision.\n- Implement the coalescing efficiency model to compute $\\eta$ given $(b, s)$ and the fixed warp and segment parameters.\n\nAngle units must be in radians. No physical units other than the dimensionless definitions above are used.\n\nTest Suite and Required Outputs:\nImplement the following ten test cases and aggregate the outputs into a single line as a comma-separated Python list literal.\n\nMemory coalescing tests (outputs are floats $\\eta$):\n- T$1$: AoS layout, single precision element size $b = 4$ bytes, stride $s = 6$.\n- T$2$: SoA layout, single precision element size $b = 4$ bytes, stride $s = 1$.\n- T$3$: SoA layout, double precision element size $b = 8$ bytes, stride $s = 1$.\n- T$4$: Hypothetical misaligned stride read, single precision element size $b = 4$ bytes, stride $s = 17$.\n\nPhase error budget tests (outputs are booleans indicating whether the worst-case total phase error is less than or equal to the threshold):\n- T$5$: Single precision over $k \\in [0.1\\pi, 0.5\\pi]$, Courant number $S = 0.9$, steps $N_{\\mathrm{steps}} = 50$, threshold $\\phi_{\\mathrm{thr}} = 1.5$ radians.\n- T$6$: Mixed precision for the same band and parameters as T$5$.\n- T$7$: Single precision over $k \\in [0.1\\pi, 0.3\\pi]$, Courant number $S = 1.0$, steps $N_{\\mathrm{steps}} = 2000$, threshold $\\phi_{\\mathrm{thr}} = 3 \\times 10^{-4}$ radians.\n- T$8$: Mixed precision for the same band and parameters as T$7$.\n- T$9$: Single precision over $k \\in [0.8\\pi, 0.95\\pi]$, Courant number $S = 0.9$, steps $N_{\\mathrm{steps}} = 50$, threshold $\\phi_{\\mathrm{thr}} = 5.0$ radians.\n- T$10$: Mixed precision for the same band and parameters as T$9$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\").",
            "solution": "The problem requires an analysis connecting numerical dispersion, floating-point error, and GPU memory access patterns within the context of the one-dimensional Finite-Difference Time-Domain (FDTD) method. I will first derive the necessary theoretical models and then apply them to the specified test cases.\n\nFirst, we derive the FDTD update equations and the numerical dispersion relation. The problem starts with the source-free Maxwell's equations in a linear, isotropic, homogeneous medium, with nondimensionalized units where the speed of light $c=1$, permittivity $\\epsilon=1$, and permeability $\\mu=1$. For a one-dimensional problem with fields propagating along the x-axis, the curl equations reduce to a pair like:\n$$\n\\frac{\\partial E_y}{\\partial x} = -\\frac{\\partial H_z}{\\partial t}\n$$\n$$\n\\frac{\\partial H_z}{\\partial x} = -\\frac{\\partial E_y}{\\partial t}\n$$\nThe problem statement uses $x$ as the spatial dimension, so we have $E_y(x,t)$ and $H_z(x,t)$ (or any transverse pair). The specific component choice is arbitrary.\n\nThe Yee scheme discretizes these equations on a staggered grid. Let $E_y$ be evaluated at spatial locations $i \\Delta x$ and time steps $n \\Delta t$, denoted $E_y^n[i]$. Let $H_z$ be evaluated at spatial locations $(i+1/2) \\Delta x$ and time steps $(n+1/2) \\Delta t$, denoted $H_z^{n+1/2}[i+1/2]$. Using central differences, the update equations are:\n$$\n\\frac{E_y^n[i+1] - E_y^n[i]}{\\Delta x} = -\\frac{H_z^{n+1/2}[i+1/2] - H_z^{n-1/2}[i+1/2]}{\\Delta t}\n$$\n$$\n\\frac{H_z^{n+1/2}[i+1/2] - H_z^{n+1/2}[i-1/2]}{\\Delta x} = -\\frac{E_y^{n+1}[i] - E_y^n[i]}{\\Delta t}\n$$\nWe assume a plane wave solution of the form $E_y^n[i] = E_0 e^{i(k i \\Delta x - \\omega_{\\mathrm{num}} n \\Delta t)}$ and $H_z^{n+1/2}[i+1/2] = H_0 e^{i(k (i+1/2) \\Delta x - \\omega_{\\mathrm{num}} (n+1/2) \\Delta t)}$, where $k$ is the wavenumber and $\\omega_{\\mathrm{num}}$ is the numerical angular frequency. Substituting these into the two update equations yields a system of two algebraic equations. Combining them to eliminate the amplitudes $E_0$ and $H_0$ gives the numerical dispersion relation:\n$$\n\\sin\\left(\\frac{\\omega_{\\mathrm{num}} \\Delta t}{2}\\right) = \\frac{c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nUsing the problem's nondimensionalization ($c=1$, $\\Delta x=1$) and definition of the Courant number $S = c \\Delta t / \\Delta x = \\Delta t$, the relation simplifies to:\n$$\n\\sin\\left(\\frac{\\omega_{\\mathrm{num}} S}{2}\\right) = S \\sin\\left(\\frac{k}{2}\\right)\n$$\nSolving for $\\omega_{\\mathrm{num}}$ gives:\n$$\n\\omega_{\\mathrm{num}}(k, S) = \\frac{2}{S} \\arcsin\\left( S \\sin\\left(\\frac{k}{2}\\right) \\right)\n$$\nThis relation is valid under the Courant-Friedrichs-Lewy (CFL) stability condition $S \\le 1$, which ensures the argument of the arcsin function does not exceed $1$ in magnitude. The exact continuum dispersion relation is $\\omega_{\\mathrm{exact}}(k) = ck = k$. The dispersion-induced phase error over a propagation time $T_{\\mathrm{prop}} = N_{\\mathrm{steps}} \\Delta t = N_{\\mathrm{steps}} S$ is:\n$$\n\\phi_{\\mathrm{disp}}(k; S, N_{\\mathrm{steps}}) = |\\left(\\omega_{\\mathrm{num}}(k, S) - k\\right) T_{\\mathrm{prop}}| = \\left|\\left(\\frac{2}{S} \\arcsin\\left( S \\sin\\left(\\frac{k}{2}\\right) \\right) - k\\right) N_{\\mathrm{steps}} S\\right|\n$$\nTo find the worst-case error over a wavenumber band $[k_{\\min}, k_{\\max}]$, we must maximize this function. The error function $E(k) = k - \\omega_{\\mathrm{num}}(k, S)$ is monotonically increasing with $k$ for $S < 1$. Its derivative is $E'(k) = 1 - \\cos(k/2) / \\sqrt{1 - S^2 \\sin^2(k/2)}$, which is positive for $S<1$ and $k \\in (0, \\pi]$. Therefore, the maximum error occurs at $k = k_{\\max}$. For the special case $S=1$, $\\omega_{\\mathrm{num}}(k, 1) = 2 \\arcsin(\\sin(k/2)) = k$ for $|k| \\le \\pi$, meaning the dispersion error is zero.\n\nNext, we formulate the total phase error budget. The rounding-induced phase error is bounded by $\\phi_{\\mathrm{round}} = N_{\\mathrm{steps}} \\, r \\, u$. According to the problem, for single precision, we use $r = r_{\\mathrm{single}} = 6$ and for mixed precision, $r = r_{\\mathrm{mixed}} = 2$. In both cases, the error source is related to 32-bit representation (either through arithmetic or storage), so the relevant unit roundoff is for single precision, $u = u_{32} = 2^{-24}$.\nThe total worst-case phase error is the sum of the maximum dispersion error and the rounding error bound:\n$$\n\\phi_{\\mathrm{total,wc}} = \\phi_{\\mathrm{disp}}(k_{\\max}; S, N_{\\mathrm{steps}}) + N_{\\mathrm{steps}} \\, r \\, u\n$$\n\nFinally, we model the GPU memory coalescing efficiency. A warp of $W=32$ threads performs simultaneous memory accesses. The hardware services these requests using 128-byte memory transactions. The efficiency $\\eta$ is the inverse of the number of transactions, $m$. Thread $t \\in [0, 31]$ accesses address $a_t = a_0 + t \\cdot s \\cdot b$, where $a_0$ is the base address (assumed 128-byte aligned), $s$ is the stride in elements, and $b$ is the element size in bytes. The number of transactions, $m$, is the number of distinct 128-byte memory segments touched by the warp. The segment index for thread $t$ is $\\lfloor a_t / 128 \\rfloor$. Since $a_0$ is a multiple of $128$, this simplifies to $q + \\lfloor (t \\cdot s \\cdot b) / 128 \\rfloor$ for some integer $q$. We need to find the number of unique integer values generated by $\\lfloor (t \\cdot s \\cdot b) / 128 \\rfloor$ for $t \\in [0, 31]$. This can be computed by generating the set of these indices and finding its cardinality.\n$$\nm = \\left| \\left\\{ \\left\\lfloor \\frac{t \\cdot s \\cdot b}{128} \\right\\rfloor \\mid t = 0, 1, \\dots, 31 \\right\\} \\right|\n$$\nThe efficiency is then $\\eta = 1/m$.\n\nThese models are implemented to solve the ten test cases. For tests T1-T4, we calculate $\\eta$. For tests T5-T10, we calculate $\\phi_{\\mathrm{total,wc}}$ and compare it to the given threshold $\\phi_{\\mathrm{thr}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a multi-part problem involving GPU memory coalescing, FDTD numerical dispersion,\n    and floating-point error analysis.\n    \"\"\"\n\n    # Constants from the problem statement.\n    W = 32  # Warp size\n    SEGMENT_SIZE = 128  # Bytes\n    U_32 = 2**-24  # Unit roundoff for 32-bit single precision\n    R_SINGLE = 6\n    R_MIXED = 2\n\n    def compute_coalescing_efficiency(b, s):\n        \"\"\"\n        Computes the memory coalescing efficiency.\n\n        Args:\n            b (int): Element size in bytes.\n            s (int): Stride in elements.\n\n        Returns:\n            float: The coalescing efficiency eta.\n        \"\"\"\n        stride_in_bytes = s * b\n        segment_indices = set()\n        for t in range(W):\n            offset = t * stride_in_bytes\n            segment_index = offset // SEGMENT_SIZE\n            segment_indices.add(segment_index)\n        \n        m = len(segment_indices)\n        return 1.0 / m\n\n    def compute_total_phase_error(k_min, k_max, S, N_steps, r, u):\n        \"\"\"\n        Computes the total worst-case phase error.\n\n        Args:\n            k_min (float): Minimum wavenumber of the band.\n            k_max (float): Maximum wavenumber of the band.\n            S (float): Courant number.\n            N_steps (int): Number of time steps.\n            r (int): Number of unit roundoff contributions per step.\n            u (float): Unit roundoff value.\n\n        Returns:\n            float: The total worst-case phase error.\n        \"\"\"\n        # Dispersion error is monotonic with k, so the max is at k_max.\n        # Handle the special case S=1 (magic time step) where dispersion is zero\n        # for k in the principal Brillouin zone.\n        if S == 1.0 and k_max <= np.pi:\n            max_phi_disp = 0.0\n        else:\n            # Argument for arcsin\n            arg = S * np.sin(k_max / 2.0)\n            if abs(arg) > 1.0:\n                # This would violate the CFL condition.\n                # The problem statement's cases are stable.\n                # Return infinity for unstable cases.\n                return float('inf')\n\n            omega_num = (2.0 / S) * np.arcsin(arg)\n            T_prop = N_steps * S\n            max_phi_disp = np.abs(omega_num - k_max) * T_prop\n\n        phi_round = N_steps * r * u\n        phi_total_wc = max_phi_disp + phi_round\n        \n        return phi_total_wc\n\n    test_cases = [\n        # T1: AoS, single precision\n        {'type': 'coalescing', 'b': 4, 's': 6},\n        # T2: SoA, single precision\n        {'type': 'coalescing', 'b': 4, 's': 1},\n        # T3: SoA, double precision\n        {'type': 'coalescing', 'b': 8, 's': 1},\n        # T4: Hypothetical misaligned stride\n        {'type': 'coalescing', 'b': 4, 's': 17},\n        # T5: Single precision, S=0.9\n        {'type': 'phase_error', 'k_min': 0.1 * np.pi, 'k_max': 0.5 * np.pi,\n         'S': 0.9, 'N_steps': 50, 'r': R_SINGLE, 'u': U_32, 'thr': 1.5},\n        # T6: Mixed precision, S=0.9\n        {'type': 'phase_error', 'k_min': 0.1 * np.pi, 'k_max': 0.5 * np.pi,\n         'S': 0.9, 'N_steps': 50, 'r': R_MIXED, 'u': U_32, 'thr': 1.5},\n        # T7: Single precision, S=1.0\n        {'type': 'phase_error', 'k_min': 0.1 * np.pi, 'k_max': 0.3 * np.pi,\n         'S': 1.0, 'N_steps': 2000, 'r': R_SINGLE, 'u': U_32, 'thr': 3e-4},\n        # T8: Mixed precision, S=1.0\n        {'type': 'phase_error', 'k_min': 0.1 * np.pi, 'k_max': 0.3 * np.pi,\n         'S': 1.0, 'N_steps': 2000, 'r': R_MIXED, 'u': U_32, 'thr': 3e-4},\n        # T9: Single precision, high-k\n        {'type': 'phase_error', 'k_min': 0.8 * np.pi, 'k_max': 0.95 * np.pi,\n         'S': 0.9, 'N_steps': 50, 'r': R_SINGLE, 'u': U_32, 'thr': 5.0},\n        # T10: Mixed precision, high-k\n        {'type': 'phase_error', 'k_min': 0.8 * np.pi, 'k_max': 0.95 * np.pi,\n         'S': 0.9, 'N_steps': 50, 'r': R_MIXED, 'u': U_32, 'thr': 5.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'coalescing':\n            result = compute_coalescing_efficiency(case['b'], case['s'])\n        elif case['type'] == 'phase_error':\n            total_error = compute_total_phase_error(\n                case['k_min'], case['k_max'], case['S'],\n                case['N_steps'], case['r'], case['u']\n            )\n            result = total_error <= case['thr']\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}