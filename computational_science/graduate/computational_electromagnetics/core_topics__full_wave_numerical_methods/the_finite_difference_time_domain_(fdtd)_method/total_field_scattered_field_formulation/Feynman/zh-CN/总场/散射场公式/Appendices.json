{
    "hands_on_practices": [
        {
            "introduction": "在FDTD网格中实现总场/散射场（TF/SF）边界的第一步，是准确识别哪些场分量需要施加校正项。本练习  将指导你完成这一基本过程，涵盖二维 $\\mathrm{TM}_z$ 和 $\\mathrm{TE}_z$ 两种极化情况。通过分析麦克斯韦旋度方程及其在Yee元胞上的离散化形式，你将学会如何确定哪些场分量与TF/SF边界相切，这是正确应用TF/SF更新方程的关键。",
            "id": "3318268",
            "problem": "在二维空间中，使用均匀的笛卡尔 Yee 网格来实现一个矩形的“全场/散射场 (Total-Field/Scattered-Field, TFSF)”边界。考虑两种典型的二维偏振：$2$D $\\mathrm{TM}_z$ 模式，其非零分量为 $(E_z,H_x,H_y)$；以及 $2$D $\\mathrm{TE}_z$ 模式，其非零分量为 $(H_z,E_x,E_y)$。TFSF 边界是一个与 $x$ 和 $y$ 轴对齐的矩形，它将空间划分为一个全场区和一个散射场区。在时域有限差分方法中，场的更新是麦克斯韦旋度方程的离散化，Yee 格式的环路/面积对应关系意味着，在穿过矩形某个给定面的离散旋度中，只会出现该面的切向场分量。\n\n从 $\\mathrm{TM}_z$ 的二维旋度方程出发，\n$$\n\\frac{\\partial E_z}{\\partial t}=\\frac{1}{\\epsilon}\\left(\\frac{\\partial H_y}{\\partial x}-\\frac{\\partial H_x}{\\partial y}\\right),\\quad\n\\frac{\\partial H_x}{\\partial t}=-\\frac{1}{\\mu}\\frac{\\partial E_z}{\\partial y},\\quad\n\\frac{\\partial H_y}{\\partial t}=\\frac{1}{\\mu}\\frac{\\partial E_z}{\\partial x},\n$$\n以及 $\\mathrm{TE}_z$ 的旋度方程，\n$$\n\\frac{\\partial H_z}{\\partial t}=-\\frac{1}{\\mu}\\left(\\frac{\\partial E_y}{\\partial x}-\\frac{\\partial E_x}{\\partial y}\\right),\\quad\n\\frac{\\partial E_x}{\\partial t}=\\frac{1}{\\epsilon}\\frac{\\partial H_z}{\\partial y},\\quad\n\\frac{\\partial E_y}{\\partial t}=-\\frac{1}{\\epsilon}\\frac{\\partial H_z}{\\partial x},\n$$\n论证哪些场分量是切向于矩形 TFSF 边界的每个面（西、东、南、北）并因此与之相交，即它们的离散旋度差分会穿过该面，从而在 TFSF 实现中需要校正项。选择一个选项，该选项为每种偏振正确地列出了位于每个面上、因而必须在该面上进行校正的场分量对：\n\nA. 对于 $\\mathrm{TM}_z$：西/东面使用 $(E_z,H_y)$；南/北面使用 $(E_z,H_x)$。对于 $\\mathrm{TE}_z$：西/东面使用 $(H_z,E_y)$；南/北面使用 $(H_z,E_x)$。\n\nB. 对于 $\\mathrm{TM}_z$：西/东面使用 $(E_z,H_x)$；南/北面使用 $(E_z,H_y)$。对于 $\\mathrm{TE}_z$：西/东面使用 $(H_z,E_y)$；南/北面使用 $(H_z,E_x)$。\n\nC. 对于 $\\mathrm{TM}_z$：西/东面使用 $(E_z,H_y)$；南/北面使用 $(E_z,H_x)$。对于 $\\mathrm{TE}_z$：西/东面使用 $(H_z,E_x)$；南/北面使用 $(H_z,E_y)$。\n\nD. 对于 $\\mathrm{TM}_z$：所有面仅使用 $(H_x,H_y)$；$E_z$ 不与任何面相交。对于 $\\mathrm{TE}_z$：所有面仅使用 $(E_x,E_y)$；$H_z$ 不与任何面相交。",
            "solution": "用户希望我扮演一位严谨的 STEM 教授，解决在时域有限差分 (FDTD) 方法背景下关于全场/散射场 (TFSF) 边界实现的问题。\n\n### 第 1 步：提取已知条件\n\n-   **计算网格**：在二维空间 ($x, y$) 中使用均匀的笛卡尔 Yee 网格。\n-   **边界条件**：一个与 $x$ 和 $y$ 轴对齐的矩形全场/散射场 (TFSF) 边界。\n-   **偏振模式**：\n    -   $2\\mathrm{D}\\ \\mathrm{TM}_z$，非零场分量为 $(E_z, H_x, H_y)$。\n    -   $2\\mathrm{D}\\ \\mathrm{TE}_z$，非零场分量为 $(H_z, E_x, E_y)$。\n-   **$\\mathrm{TM}_z$ 的控制方程**：\n    -   $\\frac{\\partial E_z}{\\partial t}=\\frac{1}{\\epsilon}\\left(\\frac{\\partial H_y}{\\partial x}-\\frac{\\partial H_x}{\\partial y}\\right)$\n    -   $\\frac{\\partial H_x}{\\partial t}=-\\frac{1}{\\mu}\\frac{\\partial E_z}{\\partial y}$\n    -   $\\frac{\\partial H_y}{\\partial t}=\\frac{1}{\\mu}\\frac{\\partial E_z}{\\partial x}$\n-   **$\\mathrm{TE}_z$ 的控制方程**：\n    -   $\\frac{\\partial H_z}{\\partial t}=-\\frac{1}{\\mu}\\left(\\frac{\\partial E_y}{\\partial x}-\\frac{\\partial E_x}{\\partial y}\\right)$\n    -   $\\frac{\\partial E_x}{\\partial t}=\\frac{1}{\\epsilon}\\frac{\\partial H_z}{\\partial y}$\n    -   $\\frac{\\partial E_y}{\\partial t}=-\\frac{1}{\\epsilon}\\frac{\\partial H_z}{\\partial x}$\n-   **关键原理**：问题陈述“在穿过矩形某个给定面的离散旋度中，只会出现该面的切向场分量……因此需要校正项”。这意味着我们需要识别出矩形边界每个面的切向场分量。\n\n### 第 2 步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题基于标准的 FDTD 方法和 TFSF 边界条件，这些是计算电磁学中的基本概念。所提供的 $2\\mathrm{D}\\ \\mathrm{TM}_z$ 和 $\\mathrm{TE}_z$ 偏振的麦克斯韦方程组是正确的。关于 Yee 网格以及离散旋度与切向场之间对应关系的描述是准确的。\n-   **适定性**：问题陈述清晰，提供了确定答案所需的所有必要信息（控制方程、场分量、边界几何形状）。问题很具体，要求确定在每个边界面上需要校正的场分量对。可以从这些原理中推导出唯一、确定的解。\n-   **客观性**：语言技术性强且精确，没有任何主观性或歧义。所用术语均为电磁学领域的标准术语。\n\n问题陈述中未发现任何缺陷。它在科学上是合理的、适定的和客观的。\n\n### 第 3 步：结论与行动\n\n问题陈述有效。我现在将开始推导解答。\n\n### 基于原理的推导\n\n全场/散射场 (TFSF) 方法涉及将计算域划分为一个全场区（包含入射场和散射场）和一个散射场区（仅包含散射场）。这些区域之间的边界需要特殊的更新方程来引入入射波。\n\nFDTD 方法在交错的 Yee 网格上离散麦克斯韦旋度方程。如果某个场分量的更新方程涉及跨越 TFSF 边界的空间有限差分，则该分量需要校正。正如问题正确指出的那样，这涉及到与边界面相切的分量。\n\n矩形边界由四个面组成：西面和东面（$x$ 恒定的表面）以及南面和北面（$y$ 恒定的表面）。\n\n**对 $2\\mathrm{D}\\ \\mathrm{TM}_z$ 偏振的分析**\n\n非零分量为 $(E_z, H_x, H_y)$。电场 $\\vec{E} = E_z \\hat{z}$ 垂直于 $xy$ 平面。磁场 $\\vec{H} = H_x \\hat{x} + H_y \\hat{y}$ 位于 $xy$ 平面内。\n\n1.  **西/东面（$x$ 恒定）**：\n    -   这些面的法向量在 $\\hat{x}$ 方向。\n    -   如果一个场在 $\\hat{x}$ 方向上的分量为零，则该场与此面相切。\n    -   对于 $\\vec{E} = E_z \\hat{z}$，沿 $\\hat{x}$ 的分量为零。因此，$E_z$ 是切向的。\n    -   对于 $\\vec{H} = H_x \\hat{x} + H_y \\hat{y}$，与该面相切的分量是 $H_y \\hat{y}$。因此，$H_y$ 是切向磁场分量。\n    -   FDTD 更新方程耦合了这些切向分量。$H_y$ 的更新涉及 $\\frac{\\partial E_z}{\\partial x}$，而 $E_z$ 的更新涉及 $\\frac{\\partial H_y}{\\partial x}$。当通过有限差分计算这些导数并跨越 TFSF 边界的一个 $x$ 恒定面时，必须应用入射场 ($E_z^{inc}, H_y^{inc}$) 的校正项。\n    -   因此，对于西面和东面，需要校正的场分量是 $(E_z, H_y)$。\n\n2.  **南/北面（$y$ 恒定）**：\n    -   这些面的法向量在 $\\hat{y}$ 方向。\n    -   如果一个场在 $\\hat{y}$ 方向上的分量为零，则该场与此面相切。\n    -   对于 $\\vec{E} = E_z \\hat{z}$，沿 $\\hat{y}$ 的分量为零。因此，$E_z$ 是切向的。\n    -   对于 $\\vec{H} = H_x \\hat{x} + H_y \\hat{y}$，与该面相切的分量是 $H_x \\hat{x}$。因此，$H_x$ 是切向磁场分量。\n    -   $H_x$ 的 FDTD 更新依赖于 $\\frac{\\partial E_z}{\\partial y}$，$E_z$ 的更新依赖于 $\\frac{\\partial H_x}{\\partial y}$。跨越 TFSF 边界的一个 $y$ 恒定面进行有限差分计算时，需要涉及 $(E_z^{inc}, H_x^{inc})$ 的校正项。\n    -   因此，对于南面和北面，需要校正的场分量是 $(E_z, H_x)$。\n\n**对 $2\\mathrm{D}\\ \\mathrm{TE}_z$ 偏振的分析**\n\n非零分量为 $(H_z, E_x, E_y)$。磁场 $\\vec{H} = H_z \\hat{z}$ 垂直于 $xy$ 平面。电场 $\\vec{E} = E_x \\hat{x} + E_y \\hat{y}$ 位于 $xy$ 平面内。\n\n1.  **西/东面（$x$ 恒定）**：\n    -   法向量是 $\\hat{x}$。\n    -   对于 $\\vec{H} = H_z \\hat{z}$，沿 $\\hat{x}$ 的分量为零。因此，$H_z$ 是切向的。\n    -   对于 $\\vec{E} = E_x \\hat{x} + E_y \\hat{y}$，与该面相切的分量是 $E_y \\hat{y}$。因此，$E_y$ 是切向电场分量。\n    -   $E_y$ 的 FDTD 更新依赖于 $\\frac{\\partial H_z}{\\partial x}$，$H_z$ 的更新依赖于 $\\frac{\\partial E_y}{\\partial x}$。跨越一个 $x$ 恒定面进行有限差分计算时，需要涉及 $(H_z^{inc}, E_y^{inc})$ 的校正项。\n    -   因此，对于西面和东面，需要校正的场分量是 $(H_z, E_y)$。\n\n2.  **南/北面（$y$ 恒定）**：\n    -   法向量是 $\\hat{y}$。\n    -   对于 $\\vec{H} = H_z \\hat{z}$，沿 $\\hat{y}$ 的分量为零。因此，$H_z$ 是切向的。\n    -   对于 $\\vec{E} = E_x \\hat{x} + E_y \\hat{y}$，与该面相切的分量是 $E_x \\hat{x}$。因此，$E_x$ 是切向电场分量。\n    -   $E_x$ 的 FDTD 更新依赖于 $\\frac{\\partial H_z}{\\partial y}$，$H_z$ 的更新依赖于 $\\frac{\\partial E_x}{\\partial y}$。跨越一个 $y$ 恒定面进行有限差分计算时，需要涉及 $(H_z^{inc}, E_x^{inc})$ 的校正项。\n    -   因此，对于南面和北面，需要校正的场分量是 $(H_z, E_x)$。\n\n**结果总结**\n-   对于 $\\mathrm{TM}_z$ 偏振：\n    -   西/东面（$x$ 恒定）：$(E_z, H_y)$\n    -   南/北面（$y$ 恒定）：$(E_z, H_x)$\n-   对于 $\\mathrm{TE}_z$ 偏振：\n    -   西/东面（$x$ 恒定）：$(H_z, E_y)$\n    -   南/北面（$y$ 恒定）：$(H_z, E_x)$\n\n### 逐项分析\n\n现在我将根据推导出的结果评估每个选项。\n\n-   **A. 对于 $\\mathrm{TM}_z$：西/东面使用 $(E_z,H_y)$；南/北面使用 $(E_z,H_x)$。对于 $\\mathrm{TE}_z$：西/东面使用 $(H_z,E_y)$；南/北面使用 $(H_z,E_x)$。**\n    -   该选项与两种偏振模式 $\\mathrm{TM}_z$ 和 $\\mathrm{TE}_z$ 的推导结果完全匹配。\n    -   结论：**正确**。\n\n-   **B. 对于 $\\mathrm{TM}_z$：西/东面使用 $(E_z,H_x)$；南/北面使用 $(E_z,H_y)$。对于 $\\mathrm{TE}_z$：西/东面使用 $(H_z,E_y)$；南/北面使用 $(H_z,E_x)$。**\n    -   $\\mathrm{TM}_z$ 的分配不正确。$H_x$ 与 $y$ 恒定面相切，而不是 $x$ 恒定面。$H_y$ 与 $x$ 恒定面相切，而不是 $y$ 恒定面。$H_x$ 和 $H_y$ 的角色互换了。\n    -   结论：**不正确**。\n\n-   **C. 对于 $\\mathrm{TM}_z$：西/东面使用 $(E_z,H_y)$；南/北面使用 $(E_z,H_x)$。对于 $\\mathrm{TE}_z$：西/东面使用 $(H_z,E_x)$；南/北面使用 $(H_z,E_y)$。**\n    -   $\\mathrm{TE}_z$ 的分配不正确。$E_x$ 与 $y$ 恒定面相切，而不是 $x$ 恒定面。$E_y$ 与 $x$ 恒定面相切，而不是 $y$ 恒定面。$E_x$ 和 $E_y$ 的角色互换了。\n    -   结论：**不正确**。\n\n-   **D. 对于 $\\mathrm{TM}_z$：所有面仅使用 $(H_x,H_y)$；$E_z$ 不与任何面相交。对于 $\\mathrm{TE}_z$：所有面仅使用 $(E_x,E_y)$；$H_z$ 不与任何面相交。**\n    -   这个选项有根本性错误。分量 $E_z$（对于 $\\mathrm{TM}_z$）和 $H_z$（对于 $\\mathrm{TE}_z$）总是与 $xy$ 平面内的任何面相切，并且在更新方程中起着关键作用。它还错误地将 $(H_x,H_y)$ 和 $(E_x,E_y)$ 对用于所有面。\n    -   结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在确定了需要校正的场分量之后，接下来的问题是如何构建这些校正项。本练习  深入探讨了TF/SF方法的核心理论基础——场等效原理。你将推导一个三维立方体边界上等效电面电流密度 $\\mathbf{J}_{s}$ 和等效磁面电流密度 $\\mathbf{M}_{s}$ 的符号约定，从而巩固对这些等效源如何产生入射场的理解。",
            "id": "3318213",
            "problem": "一个立方体的全场/散射场 (TFSF) 边界在一个均匀、各向同性、无源介质的三维时域有限差分 (FDTD) 模拟中，将全场区与散射场区分隔开。该介质的介电常数为 $\\varepsilon$，磁导率为 $\\mu$，波阻抗为 $\\eta=\\sqrt{\\mu/\\varepsilon}$，相速度为 $v=\\frac{1}{\\sqrt{\\mu \\varepsilon}}$。该立方体与笛卡尔坐标轴对齐，其各面位于 $x=x_{\\min}$、$x=x_{\\max}$、$y=y_{\\min}$、$y=y_{\\max}$、$z=z_{\\min}$ 和 $z=z_{\\max}$。每个面上的单位法向量 $\\hat{\\mathbf{n}}$ 从全场区向外指向散射场区。\n\n该介质中的一个入射平面波由波矢 $\\mathbf{k}=k\\,\\hat{\\mathbf{k}}$（其中 $k=\\omega/v$）、满足 $\\hat{\\mathbf{p}}\\cdot \\hat{\\mathbf{k}}=0$ 的单位极化矢量 $\\hat{\\mathbf{p}}$ 以及振幅为 $E_{0}$ 的标量波形 $g(\\cdot)$ 指定。其时域场为\n$$\n\\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t)=E_{0}\\,\\hat{\\mathbf{p}}\\,g\\!\\left(t-\\frac{\\hat{\\mathbf{k}}\\cdot \\mathbf{r}}{v}\\right), \\qquad\n\\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r},t)=\\frac{1}{\\eta}\\,\\hat{\\mathbf{k}}\\times \\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t).\n$$\n\n从麦克斯韦方程组和场等效原理出发，推导在 TFSF 界面上产生内部全场和外部仅散射场所需的等效表面电和磁流密度。然后，对于这 6 个面中的每一个，写出施加在该面上的校正表达式，用在该面上求值的 $\\mathbf{E}^{\\mathrm{inc}}$ 和 $\\mathbf{H}^{\\mathrm{inc}}$ 表示。采用以下约定：具有外向法向量 $\\hat{\\mathbf{n}}$ 的面上的等效表面电流为\n$$\n\\mathbf{J}_{s}(\\mathbf{r},t)=\\hat{\\mathbf{n}} \\times \\mathbf{H}^{\\mathrm{inc}}(\\mathbf{r},t), \\qquad\n\\mathbf{M}_{s}(\\mathbf{r},t)=-\\hat{\\mathbf{n}} \\times \\mathbf{E}^{\\mathrm{inc}}(\\mathbf{r},t).\n$$\n对于六个与坐标轴对齐的面，令 $\\hat{\\mathbf{a}}_{x}=\\hat{\\mathbf{x}}$、$\\hat{\\mathbf{a}}_{y}=\\hat{\\mathbf{y}}$ 和 $\\hat{\\mathbf{a}}_{z}=\\hat{\\mathbf{z}}$。通过 $\\hat{\\mathbf{n}}_{i}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}$ 为面 $i$ 定义符号 $s_{i}\\in\\{-1,+1\\}$，其中 $\\alpha(i)\\in\\{x,y,z\\}$ 选择垂直于面 $i$ 的轴，对于 $x_{\\min}$、$y_{\\min}$、$z_{\\min}$ 面，$s_{i}=-1$，对于 $x_{\\max}$、$y_{\\max}$、$z_{\\max}$ 面，$s_{i}=+1$。将每个面的校正表示为以下形式：\n$$\n\\mathbf{J}_{s}^{(i)}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{H}^{\\mathrm{inc}}, \\qquad\n\\mathbf{M}_{s}^{(i)}=-s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{E}^{\\mathrm{inc}}.\n$$\n\n最后，计算有序面列表 $\\left[x_{\\min},x_{\\max},y_{\\min},y_{\\max},z_{\\min},z_{\\max}\\right]$ 上对 $\\left(s_{J}^{(i)},s_{M}^{(i)}\\right)$ 的 12 项符号模式，其中 $s_{J}^{(i)}$ 和 $s_{M}^{(i)}$ 定义为\n$$\n\\mathbf{J}_{s}^{(i)}=s_{J}^{(i)}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{H}^{\\mathrm{inc}}, \\qquad\n\\mathbf{M}_{s}^{(i)}=s_{M}^{(i)}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}\\times \\mathbf{E}^{\\mathrm{inc}}.\n$$\n将最终的符号模式报告为单个 $1\\times 12$ 行矩阵，顺序为 $\\left[s_{J}^{(x_{\\min})},s_{M}^{(x_{\\min})},s_{J}^{(x_{\\max})},s_{M}^{(x_{\\max})},s_{J}^{(y_{\\min})},s_{M}^{(y_{\\min})},s_{J}^{(y_{\\max})},s_{M}^{(y_{\\max})},s_{J}^{(z_{\\min})},s_{M}^{(z_{\\min})},s_{J}^{(z_{\\max})},s_{M}^{(z_{\\max})}\\right]$。不需要数值舍入。最终答案中不要包含单位。",
            "solution": "问题陈述经过了仔细验证，被确定为计算电磁学中一个适定的、科学上合理的、内部一致的问题。它要求在时域有限差分 (FDTD) 算法的背景下，将场等效原理应用于全场/散射场 (TFSF) 方法。\n\nTFSF 公式将计算域划分为由闭合边界 $\\mathcal{S}$ 分隔的两个区域。$\\mathcal{S}$ 内部是全场区，其中的场是入射分量和散射分量的和：$\\mathbf{E}^{\\mathrm{tot}} = \\mathbf{E}^{\\mathrm{inc}} + \\mathbf{E}^{\\mathrm{scat}}$ 和 $\\mathbf{H}^{\\mathrm{tot}} = \\mathbf{H}^{\\mathrm{inc}} + \\mathbf{H}^{\\mathrm{scat}}$。$\\mathcal{S}$ 外部是散射场区，其中只计算散射场 $(\\mathbf{E}^{\\mathrm{scat}}, \\mathbf{H}^{\\mathrm{scat}})$。\n\n这种划分是通过在 $\\mathcal{S}$ 上引入作为源的等效表面电流来实现的。这些源被设计成在全场区内部产生入射场 $(\\mathbf{E}^{\\mathrm{inc}}, \\mathbf{H}^{\\mathrm{inc}})$，并在外部产生零场。当这些生成的场叠加到散射场模拟上（根据线性性质，该模拟延伸到整个域），其结果就是在 $\\mathcal{S}$ 内部得到全场，在外部得到散射场，正如所期望的。\n\n根据场等效原理，在闭合曲面 $\\mathcal{S}$ 上，能够在其内部产生场 $(\\mathbf{E}, \\mathbf{H})$ 并在外部产生零场的表面电流密度 $\\mathbf{J}_s$ 和表面磁流密度 $\\mathbf{M}_s$ 由下式给出：\n$$\n\\mathbf{J}_{s}(\\mathbf{r},t) = \\hat{\\mathbf{n}} \\times \\mathbf{H}(\\mathbf{r},t)\n$$\n$$\n\\mathbf{M}_{s}(\\mathbf{r},t) = -\\hat{\\mathbf{n}} \\times \\mathbf{E}(\\mathbf{r},t)\n$$\n其中 $\\hat{\\mathbf{n}}$ 是从 $\\mathcal{S}$ 包围的体积向外指的单位法向量。在我们的情况下，要生成的场是入射场 $(\\mathbf{E}^{\\mathrm{inc}}, \\mathbf{H}^{\\mathrm{inc}})$，体积是全场区。问题陈述提供了这些确切的定义，我们在推导中采用它们。\n\n问题要求为与立方体 TFSF 边界的六个面上的这些电流相关的校正项提供一个符号模式。设面 $i$ 是六个面之一。该面的外向单位法向量记为 $\\hat{\\mathbf{n}}_i$。问题定义了关系 $\\hat{\\mathbf{n}}_{i}=s_{i}\\,\\hat{\\mathbf{a}}_{\\alpha(i)}$，其中 $\\hat{\\mathbf{a}}_{\\alpha(i)}$ 是沿垂直于该面的轴（$\\hat{\\mathbf{x}}$、$\\hat{\\mathbf{y}}$ 或 $\\hat{\\mathbf{z}}$）的笛卡尔单位矢量，而 $s_i$ 是一个符号。对于位于最小坐标（$x_{\\min}$、$y_{\\min}$、$z_{\\min}$）的面，外向法向量指向负轴方向，所以 $s_i = -1$。对于位于最大坐标（$x_{\\max}$、$y_{\\max}$、$z_{\\max}$）的面，外向法向量指向正轴方向，所以 $s_i = +1$。\n\n我们的任务是通过比较电流的基本定义与问题中给出的目标形式来确定符号 $s_J^{(i)}$ 和 $s_M^{(i)}$。\n\n首先，让我们分析表面电流 $\\mathbf{J}_s^{(i)}$。\n应用于面 $i$ 的基本定义是：\n$$\n\\mathbf{J}_{s}^{(i)} = \\hat{\\mathbf{n}}_i \\times \\mathbf{H}^{\\mathrm{inc}}\n$$\n代入 $\\hat{\\mathbf{n}}_i = s_i \\hat{\\mathbf{a}}_{\\alpha(i)}$：\n$$\n\\mathbf{J}_{s}^{(i)} = (s_i \\hat{\\mathbf{a}}_{\\alpha(i)}) \\times \\mathbf{H}^{\\mathrm{inc}} = s_i (\\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{H}^{\\mathrm{inc}})\n$$\n问题指定的目标形式是：\n$$\n\\mathbf{J}_{s}^{(i)} = s_{J}^{(i)} \\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{H}^{\\mathrm{inc}}\n$$\n通过直接比较这两个表达式，我们推断出：\n$$\ns_{J}^{(i)} = s_i\n$$\n\n接下来，我们分析表面磁流 $\\mathbf{M}_s^{(i)}$。\n应用于面 $i$ 的基本定义是：\n$$\n\\mathbf{M}_{s}^{(i)} = -\\hat{\\mathbf{n}}_i \\times \\mathbf{E}^{\\mathrm{inc}}\n$$\n代入 $\\hat{\\mathbf{n}}_i = s_i \\hat{\\mathbf{a}}_{\\alpha(i)}$：\n$$\n\\mathbf{M}_{s}^{(i)} = -(s_i \\hat{\\mathbf{a}}_{\\alpha(i)}) \\times \\mathbf{E}^{\\mathrm{inc}} = -s_i (\\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{E}^{\\mathrm{inc}})\n$$\n问题指定的目标形式是：\n$$\n\\mathbf{M}_{s}^{(i)} = s_{M}^{(i)} \\hat{\\mathbf{a}}_{\\alpha(i)} \\times \\mathbf{E}^{\\mathrm{inc}}\n$$\n通过比较这两个表达式，我们推断出：\n$$\ns_{M}^{(i)} = -s_i\n$$\n\n我们现在得到了任意面 $i$ 上符号对的一般关系：$(s_{J}^{(i)}, s_{M}^{(i)}) = (s_i, -s_i)$。我们现在可以将其应用于指定顺序的六个面中的每一个。\n\n1.  $x_{\\min}$ 面：法向量为 $\\hat{\\mathbf{n}}_{x_{\\min}} = -\\hat{\\mathbf{x}}$。因此，$\\alpha(i)=x$ 且 $s_{x_{\\min}} = -1$。\n    符号对为 $(s_{J}^{(x_{\\min})}, s_{M}^{(x_{\\min})}) = (s_{x_{\\min}}, -s_{x_{\\min}}) = (-1, -(-1)) = (-1, 1)$。\n\n2.  $x_{\\max}$ 面：法向量为 $\\hat{\\mathbf{n}}_{x_{\\max}} = +\\hat{\\mathbf{x}}$。因此，$\\alpha(i)=x$ 且 $s_{x_{\\max}} = +1$。\n    符号对为 $(s_{J}^{(x_{\\max})}, s_{M}^{(x_{\\max})}) = (s_{x_{\\max}}, -s_{x_{\\max}}) = (1, -1)$。\n\n3.  $y_{\\min}$ 面：法向量为 $\\hat{\\mathbf{n}}_{y_{\\min}} = -\\hat{\\mathbf{y}}$。因此，$\\alpha(i)=y$ 且 $s_{y_{\\min}} = -1$。\n    符号对为 $(s_{J}^{(y_{\\min})}, s_{M}^{(y_{\\min})}) = (s_{y_{\\min}}, -s_{y_{\\min}}) = (-1, -(-1)) = (-1, 1)$。\n\n4.  $y_{\\max}$ 面：法向量为 $\\hat{\\mathbf{n}}_{y_{\\max}} = +\\hat{\\mathbf{y}}$。因此，$\\alpha(i)=y$ 且 $s_{y_{\\max}} = +1$。\n    符号对为 $(s_{J}^{(y_{\\max})}, s_{M}^{(y_{\\max})}) = (s_{y_{\\max}}, -s_{y_{\\max}}) = (1, -1)$。\n\n5.  $z_{\\min}$ 面：法向量为 $\\hat{\\mathbf{n}}_{z_{\\min}} = -\\hat{\\mathbf{z}}$。因此，$\\alpha(i)=z$ 且 $s_{z_{\\min}} = -1$。\n    符号对为 $(s_{J}^{(z_{\\min})}, s_{M}^{(z_{\\min})}) = (s_{z_{\\min}}, -s_{z_{\\min}}) = (-1, -(-1)) = (-1, 1)$。\n\n6.  $z_{\\max}$ 面：法向量为 $\\hat{\\mathbf{n}}_{z_{\\max}} = +\\hat{\\mathbf{z}}$。因此，$\\alpha(i)=z$ 且 $s_{z_{\\max}} = +1$。\n    符号对为 $(s_{J}^{(z_{\\max})}, s_{M}^{(z_{\\max})}) = (s_{z_{\\max}}, -s_{z_{\\max}}) = (1, -1)$。\n\n最后，我们按照指定的顺序连接这些符号对，以组合成 12 项的符号模式：\n$\\left[s_{J}^{(x_{\\min})},s_{M}^{(x_{\\min})},s_{J}^{(x_{\\max})},s_{M}^{(x_{\\max})},s_{J}^{(y_{\\min})},s_{M}^{(y_{\\min})},s_{J}^{(y_{\\max})},s_{M}^{(y_{\\max})},s_{J}^{(z_{\\min})},s_{M}^{(z_{\\min})},s_{J}^{(z_{\\max})},s_{M}^{(z_{\\max})}\\right]$\n代入我们计算出的值：\n$\\left[-1, 1, 1, -1, -1, 1, 1, -1, -1, 1, 1, -1\\right]$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1  1  1  -1  -1  1  1  -1  -1  1  1  -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "最后的这项实践将理论与编程实现融为一体，构成一个完整的计算实验。你将构建一个一维FDTD仿真程序，使用TF/SF方法将一个啁啾波包注入到色散的Debye介质中 。通过将数值测量的群延迟与解析预测进行比较，本练习展示了TF/SF在模拟和分析真实材料中复杂的波与物质相互作用现象方面的实用价值。",
            "id": "3356772",
            "problem": "您需要设计并实现一个一维平面波模拟，该模拟使用时域有限差分 (FDTD) 方法中的总场/散射场 (TF/SF) 公式，以注入一个瞬时（啁啾）角频率随时间变化的右行高斯包络波包。模拟域在 TF 区域外为真空，在区域内为色散介质，该介质由单极点德拜本构关系描述。您的程序必须评估测得的跨 TF 区域的群延迟是否与基于色散介质中群速度的解析预测相匹配。\n\n此任务的基础必须从麦克斯韦方程组的微分形式（一维、非磁性介质）、德拜材料中电位移和极化的定义以及场的 TF/SF 分解开始。使用这些基本定律和定义来推导和实现更新方程和 TF/SF 注入修正，并构建一个解析的群延迟预测器。\n\n形式上，对于依赖于位置 $x$ 和时间 $t$ 的一维场，且场被极化以至于 $E(x,t)$ 和 $H(x,t)$ 非零（横电磁平面波），请使用以下基本定律：\n\n- 麦克斯韦-法拉第定律：$$\\frac{\\partial H}{\\partial t} = -\\frac{1}{\\mu_0}\\frac{\\partial E}{\\partial x}.$$\n- 麦克斯韦-安培定律：$$\\frac{\\partial D}{\\partial t} = \\frac{\\partial H}{\\partial x}.$$\n- 电位移：$$D = \\varepsilon_0 \\varepsilon_\\infty E + P.$$\n- 德拜极化动力学：$$\\tau \\frac{\\mathrm{d}P}{\\mathrm{d}t} + P = \\varepsilon_0 (\\varepsilon_s - \\varepsilon_\\infty) E.$$\n\n此处，$\\mu_0$ 是真空磁导率，$\\varepsilon_0$ 是真空介电常数，$\\varepsilon_\\infty$ 是高频相对介电常数，$\\varepsilon_s$ 是静态相对介电常数，$\\tau$ 是弛豫时间。TF/SF 分解将 TF 区域中的总场写为 $E^{\\mathrm{t}} = E^{\\mathrm{s}} + E^{\\mathrm{i}}$ 和 $H^{\\mathrm{t}} = H^{\\mathrm{s}} + H^{\\mathrm{i}}$，其中上标 $\\mathrm{s}$ 和 $\\mathrm{i}$ 分别表示散射场和入射场。TF/SF 边界必须强制规定，在 TF 区域之外只有散射场传播；在区域内部，则为总场。根据麦克斯韦方程组所蕴含的跳变条件，在 TF/SF 界面处使用适当的等效场修正项。\n\n要注入的入射波是一个在真空中右行的平面波，具有高斯包络和线性啁啾的瞬时角频率。设推迟时间变量为 $s = t - x/c_0$，其中 $c_0 = 1/\\sqrt{\\mu_0 \\varepsilon_0}$ 是真空光速。将入射电场定义为\n$$E^{\\mathrm{i}}(x,t) = A(s)\\cos\\phi(s),$$\n其包络为\n$$A(s) = \\exp\\!\\left(-\\frac{(s - t_0)^2}{2\\sigma^2}\\right),$$\n相位为\n$$\\phi(s) = \\omega_0 (s - t_0) + \\frac{1}{2}\\alpha (s - t_0)^2,$$\n因此瞬时角频率为\n$$\\omega(s) = \\frac{\\mathrm{d}\\phi}{\\mathrm{d}s} = \\omega_0 + \\alpha (s - t_0).$$\n真空中相应的入射磁场由 $$H^{\\mathrm{i}}(x,t) = \\frac{E^{\\mathrm{i}}(x,t)}{\\eta_0}$$ 给出，其中 $\\eta_0 = \\sqrt{\\mu_0/\\varepsilon_0}$。\n\n在 TF 区域内部，材料是德拜色散介质。使用能保持稳定性和准确性的辅助微分方程 (ADE) 离散化方法。在 TF 区域外部，使用真空（$\\varepsilon_s = \\varepsilon_\\infty = 1$ 且 $P = 0$）。在左侧和右侧 TF 界面实施 TF/SF 修正项，以确保入射场和散射场的正确分离。数值记录 TF 区域内部左右 TF 界面处的电场 $E(x,t)$，并通过解析信号变换计算包络，以估计每个界面处的到达时间（包络峰值）。\n\n解析上，假设在与左侧 TF 边界处包络峰值相关的发射时间点，啁啾是缓变的。通过使用非磁性介质中具有德拜介电常数的频率相关群速度，预测跨越厚度为 $L$ 的平板的群延迟。德拜介质的复相对介电常数为\n$$\\varepsilon(\\omega) = \\varepsilon_\\infty + \\frac{(\\varepsilon_s - \\varepsilon_\\infty)}{1 + \\mathrm{i}\\omega \\tau}.$$\n对于无损近似，使用实部：\n$$\\varepsilon'(\\omega) = \\varepsilon_\\infty + \\frac{(\\varepsilon_s - \\varepsilon_\\infty)}{1 + (\\omega \\tau)^2}.$$\n将折射率定义为 $$n(\\omega) = \\sqrt{\\varepsilon'(\\omega)}.$$ 在非磁性介质中，群折射率为\n$$n_g(\\omega) = n(\\omega) + \\omega \\frac{\\mathrm{d}n}{\\mathrm{d}\\omega},$$\n群速度为 $$v_g(\\omega) = \\frac{c_0}{n_g(\\omega)}.$$ 通过以下公式预测跨越厚度为 $L$ 的 TF 区域的群延迟\n$$\\Delta t_{\\mathrm{pred}} = \\frac{L}{v_g(\\omega_\\mathrm{emit})},$$\n其中 $\\omega_\\mathrm{emit}$ 是对应于左侧 TF 边界处包络峰值的发射时间的瞬时角频率（即，对于此啁啾模型，$s \\approx t_0$，因此 $\\omega_\\mathrm{emit} \\approx \\omega_0$）。将此 $\\Delta t_{\\mathrm{pred}}$ 与在左侧和右侧 TF 边界处测得的包络峰值之间的时间延迟进行比较。\n\n物理和数值约束：\n- 使用国际单位制 (SI)。时间量以秒表示。\n- 选择满足一维 Courant 稳定性条件的空间步长 $\\Delta x$ 和时间步长 $\\Delta t$：$$\\Delta t \\leq \\frac{\\Delta x}{c_0}.$$ 所有角频率明确使用弧度/秒，啁啾率使用弧度/秒平方。角度不直接用于答案；如果出现，请使用弧度。\n- 确保模拟域足够大，以便在包络峰值穿过右侧 TF 边界之前，来自两端的虚假反射不会污染测量结果。您可以通过选择足够大的模拟域并提前停止模拟来假设远离 TF 区域的边界是完美匹配的。\n\n您的程序必须：\n- 在 TF 区域内实现用于德拜介质的一维 FDTD 与 ADE，区域外为真空。\n- 使用上面定义的解析 $E^{\\mathrm{i}}$ 和 $H^{\\mathrm{i}}$，通过 TF/SF 边界修正注入入射场。\n- 记录 TF 区域内左右 TF 边界处的 $E$ 的时间历史，计算它们的包络，检测每个包络的峰值时间，计算测量的群延迟，并与基于 $v_g(\\omega_\\mathrm{emit})$ 的解析预测进行比较。\n- 对于每个测试用例，输出测量延迟和预测延迟之间的绝对差值（以秒为单位），作为浮点数。\n\n测试套件：\n提供以下参数集。在所有情况下，使用具有宽度参数 $\\sigma$ 和中心时间 $t_0$ 的高斯包络，如上定义。使用这些材料和啁啾参数；所有量均采用 SI 单位。\n\n- 情况1（标准情况）：$L = 0.40$ m, $\\varepsilon_s = 4.0$, $\\varepsilon_\\infty = 2.25$, $\\tau = 5.0\\times 10^{-11}$ s, $\\omega_0 = 2\\pi \\times 3.0\\times 10^9$ rad/s, $\\alpha = 0.0$ rad/s$^2$, $\\sigma = 5.0\\times 10^{-10}$ s, $t_0 = 6\\sigma$.\n- 情况2（正啁啾）：$L = 0.40$ m, $\\varepsilon_s = 4.0$, $\\varepsilon_\\infty = 2.25$, $\\tau = 5.0\\times 10^{-11}$ s, $\\omega_0 = 2\\pi \\times 3.0\\times 10^9$ rad/s, $\\alpha = +1.0\\times 10^{19}$ rad/s$^2$, $\\sigma = 5.0\\times 10^{-10}$ s, $t_0 = 6\\sigma$.\n- 情况3（负啁啾）：$L = 0.40$ m, $\\varepsilon_s = 4.0$, $\\varepsilon_\\infty = 2.25$, $\\tau = 5.0\\times 10^{-11}$ s, $\\omega_0 = 2\\pi \\times 3.0\\times 10^9$ rad/s, $\\alpha = -1.0\\times 10^{19}$ rad/s$^2$, $\\sigma = 5.0\\times 10^{-10}$ s, $t_0 = 6\\sigma$.\n- 情况4（短板，弱色散边缘情况）：$L = 0.05$ m, $\\varepsilon_s = 2.5$, $\\varepsilon_\\infty = 2.25$, $\\tau = 1.0\\times 10^{-10}$ s, $\\omega_0 = 2\\pi \\times 3.0\\times 10^9$ rad/s, $\\alpha = 0.0$ rad/s$^2$, $\\sigma = 5.0\\times 10^{-10}$ s, $t_0 = 6\\sigma$.\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，每个条目等于相应测试用例的测量群延迟与预测群延迟之间的绝对差值（以秒为单位），顺序与上述相同（例如，$[\\delta_1,\\delta_2,\\delta_3,\\delta_4]$）。每个 $\\delta_k$ 必须是秒为单位的浮点数。",
            "solution": "任务是使用时域有限差分 (FDTD) 方法模拟一维平面波通过色散德拜介质的传播，并将数值测量的群延迟与解析预测进行比较。这需要推导和实现色散介质的 FDTD 更新方程、用于注入入射平面波的总场/散射场 (TF/SF) 公式，以及群速度的解析模型。\n\n在一维、非磁性、无源区域中的基本控制方程是麦克斯韦方程组：\n$$ \\frac{\\partial H_y}{\\partial t} = -\\frac{1}{\\mu_0}\\frac{\\partial E_z}{\\partial x} $$\n$$ \\frac{\\partial D_z}{\\partial t} = -\\frac{\\partial H_y}{\\partial x} $$\n在单极点德拜介质中，电位移 $D_z$ 与电场 $E_z$ 和极化强度 $P_z$ 的关系为：\n$$ D_z = \\varepsilon_0 \\varepsilon_\\infty E_z + P_z $$\n极化动力学由辅助微分方程 (ADE) 描述：\n$$ \\tau \\frac{\\mathrm{d}P_z}{\\mathrm{d}t} + P_z = \\varepsilon_0 (\\varepsilon_s - \\varepsilon_\\infty) E_z $$\n这里，$\\varepsilon_0$ 是真空介电常数，$\\mu_0$ 是真空磁导率，$\\varepsilon_s$ 是静态相对介电常数，$\\varepsilon_\\infty$ 是高频相对介电常数，$\\tau$ 是弛豫时间。\n\n我们在 Yee 网格上离散化这些方程，其中 $E_z$ 在整数空间索引 $k$ 和整数时间步长 $n$ 处计算，而 $H_y$ 在半整数空间索引 $k+1/2$ 和半整数时间步长 $n+1/2$ 处计算。设 $\\Delta x$ 为空间步长，$\\Delta t$ 为时间步长。\n\n非磁性介质中磁场的标准 FDTD 更新是通过对法拉第定律进行中心差分推导的：\n$$ H_y\\Big|_{k+1/2}^{n+1/2} = H_y\\Big|_{k+1/2}^{n-1/2} - \\frac{\\Delta t}{\\mu_0 \\Delta x} \\left( E_z\\Big|_k^{n} - E_z\\Big|_{k-1}^{n} \\right) $$\n\n对于德拜介质内的电场更新，我们结合安培定律和本构关系。我们使用中心差分近似导数，并对区间 $[n\\Delta t, (n+1)\\Delta t]$ 上的场取平均值来离散化 ADE：\n$$ \\tau \\frac{P_z\\Big|_k^{n+1} - P_z\\Big|_k^n}{\\Delta t} + \\frac{P_z\\Big|_k^{n+1} + P_z\\Big|_k^n}{2} = \\varepsilon_0(\\varepsilon_s - \\varepsilon_\\infty) \\frac{E_z\\Big|_k^{n+1} + E_z\\Big|_k^n}{2} $$\n类似地，我们离散化安培定律与 $D_z$ 定义的组合：\n$$ \\varepsilon_0 \\varepsilon_\\infty \\frac{E_z\\Big|_k^{n+1} - E_z\\Big|_k^n}{\\Delta t} + \\frac{P_z\\Big|_k^{n+1} - P_z\\Big|_k^n}{\\Delta t} = \\frac{H_y\\Big|_{k+1/2}^{n+1/2} - H_y\\Big|_{k-1/2}^{n+1/2}}{\\Delta x} $$\n这两个离散方程构成了一个关于 $E_z\\Big|_k^{n+1}$ 和 $P_z\\Big|_k^{n+1}$ 的隐式系统。通过在第一个方程中求解 $P_z\\Big|_k^{n+1}$ 并代入第二个方程，我们可以推导出一个完全显式的更新方案。这产生了一组与位置相关的系数，用于在每个时间步更新 $E_z$ 和 $P_z$。更新过程如下：\n1. 使用时间 $n$ 的 $E_z$ 更新时间 $n+1/2$ 的 $H_y$。\n2. 使用时间 $n+1/2$ 的 $H_y$ 以及时间 $n$ 的 $E_z$、$P_z$ 更新时间 $n+1$ 的 $E_z$。\n3. 使用新计算的 $E_z\\Big|^{n+1}$ 和 $E_z\\Big|^n$、$P_z\\Big|^n$ 更新时间 $n+1$ 的 $P_z$。\n在真空区域，其中 $\\varepsilon_s=\\varepsilon_\\infty=1$，极化强度 $P_z$ 为零，对 $E_z$ 的更新简化为标准的真空 FDTD 方程。\n\nTF/SF 公式用于注入入射波。模拟域被划分为一个中心的总场 (TF) 区域和周围的散射场 (SF) 区域。在 TF 区域，FDTD 算法更新总场 ($E^t, H^t$)，而在 SF 区域，它更新散射场 ($E^s, H^s$)。解析定义的入射波 ($E^i, H^i$) 在概念上无处不在。总场是散射场和入射场之和：$E^t = E^s + E^i$。\n注入是通过在 TF 和 SF 区域之间的边界上添加校正源项来实现的。这些校正确保了入射场在边界处生成并传播到 TF 区域，同时在 SF 区域中被抵消。对于向右传播的入射波，左边界 ($k=k_{\\text{start}}$) 处的校正项为：\n$$ H_y\\Big|_{k_{\\text{start}}-1/2}^{n+1/2} \\mathrel{-}= \\frac{\\Delta t}{\\mu_0 \\Delta x} E_z^i(x_{k_{\\text{start}}}, n\\Delta t) $$\n$$ E_z\\Big|_{k_{\\text{start}}}^{n+1} \\mathrel{+}= C_{E, \\text{curl}} H_y^i(x_{k_{\\text{start}}-1/2}, (n+1/2)\\Delta t) $$\n在右边界 ($k=k_{\\text{end}}$)，符号相反，以抵消入射波并防止其重新进入 TF 区域。$C_{E, \\text{curl}}$ 项是在 $E_z$ 更新方程中乘以 $H$ 的旋度的系数。\n\n为了评估群延迟，在色散板的左边界和右边界（而不是 TF/SF 界面）记录场 $E_z(t)$。使用涉及希尔伯特变换的解析信号方法计算每个记录信号的包络。识别每个包络峰值的时间，其差值给出测量的群延迟 $\\Delta t_{\\text{meas}}$。\n\n这与解析预测进行比较。对于德拜介质，频率相关的相对介电常数 $\\varepsilon(\\omega)$ 的实部为：\n$$ \\varepsilon'(\\omega) = \\varepsilon_\\infty + \\frac{\\varepsilon_s - \\varepsilon_\\infty}{1 + (\\omega\\tau)^2} $$\n折射率是 $n(\\omega) = \\sqrt{\\varepsilon'(\\omega)}$。群折射率 $n_g(\\omega)$ 由下式给出：\n$$ n_g(\\omega) = n(\\omega) + \\omega\\frac{\\mathrm{d}n}{\\mathrm{d}\\omega} = n(\\omega) - \\frac{\\omega^2\\tau^2(\\varepsilon_s - \\varepsilon_\\infty)}{n(\\omega)[1 + (\\omega\\tau)^2]^2} $$\n群速度为 $v_g(\\omega) = c_0/n_g(\\omega)$，其中 $c_0$ 是真空中的光速。跨越长度为 $L$ 的板的预测群延迟则为：\n$$ \\Delta t_{\\text{pred}} = \\frac{L}{v_g(\\omega_{\\text{emit}})} $$\n根据规定，我们用脉冲的中心角频率 $\\omega_0$ 来近似发射频率 $\\omega_{\\text{emit}}$。\n问题要求计算每个测试用例的 $|\\Delta t_{\\text{meas}} - \\Delta t_{\\text{pred}}|$ 的绝对差值。",
            "answer": "```python\nimport numpy as np\nfrom scipy.signal import hilbert\nfrom scipy.constants import c as c0, epsilon_0 as eps0, mu_0 as mu0\n\ndef solve():\n    \"\"\"\n    Solves the 1D FDTD TF/SF problem for a dispersive Debye medium.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path)\n        {'L': 0.40, 'eps_s': 4.0, 'eps_inf': 2.25, 'tau': 5.0e-11,\n         'w0': 2 * np.pi * 3.0e9, 'alpha': 0.0, 'sigma': 5.0e-10, 't0': 6 * 5.0e-10},\n        # Case 2 (positive chirp)\n        {'L': 0.40, 'eps_s': 4.0, 'eps_inf': 2.25, 'tau': 5.0e-11,\n         'w0': 2 * np.pi * 3.0e9, 'alpha': 1.0e19, 'sigma': 5.0e-10, 't0': 6 * 5.0e-10},\n        # Case 3 (negative chirp)\n        {'L': 0.40, 'eps_s': 4.0, 'eps_inf': 2.25, 'tau': 5.0e-11,\n         'w0': 2 * np.pi * 3.0e9, 'alpha': -1.0e19, 'sigma': 5.0e-10, 't0': 6 * 5.0e-10},\n        # Case 4 (short slab, weak dispersion edge case)\n        {'L': 0.05, 'eps_s': 2.5, 'eps_inf': 2.25, 'tau': 1.0e-10,\n         'w0': 2 * np.pi * 3.0e9, 'alpha': 0.0, 'sigma': 5.0e-10, 't0': 6 * 5.0e-10},\n    ]\n\n    results = []\n    eta0 = np.sqrt(mu0 / eps0)\n\n    for params in test_cases:\n        L = params['L']\n        eps_s = params['eps_s']\n        eps_inf = params['eps_inf']\n        tau = params['tau']\n        w0 = params['w0']\n        alpha = params['alpha']\n        sigma_pulse = params['sigma']\n        t0_pulse = params['t0']\n\n        # --- FDTD Simulation Setup ---\n        dx = 0.001\n        dt = dx / c0\n        domain_size = 3.0\n        Nx = int(domain_size / dx)\n        \n        estimated_n_g = np.sqrt(eps_s)\n        t_sim = t0_pulse + (L * estimated_n_g / c0) * 1.5 + 8 * sigma_pulse\n        Nt = int(t_sim / dt)\n\n        slab_start_pos = 1.0\n        slab_end_pos = slab_start_pos + L\n        slab_start_idx = int(slab_start_pos / dx)\n        slab_end_idx = int(slab_end_pos / dx)\n\n        tf_buffer = 0.2\n        tf_start_pos = slab_start_pos - tf_buffer\n        tf_end_pos = slab_end_pos + tf_buffer\n        tf_start_idx = int(tf_start_pos / dx)\n        tf_end_idx = int(tf_end_pos / dx)\n\n        Ez = np.zeros(Nx)\n        Hy = np.zeros(Nx - 1)\n        Pz = np.zeros(Nx)\n\n        eps_s_vec = np.ones(Nx)\n        eps_inf_vec = np.ones(Nx)\n        tau_vec = np.ones(Nx) * 1e-16 # Avoid division by zero in vacuum\n\n        eps_s_vec[slab_start_idx:slab_end_idx] = eps_s\n        eps_inf_vec[slab_start_idx:slab_end_idx] = eps_inf\n        tau_vec[slab_start_idx:slab_end_idx] = tau\n        \n        # ADE Coefficients based on explicit update scheme derivation\n        C_e_prime = eps0 * (eps_s_vec - eps_inf_vec) / (2 * tau_vec / dt + 1)\n        C_d = (2 * tau_vec / dt - 1) / (2 * tau_vec / dt + 1)\n        \n        denom_E = eps0 * eps_inf_vec + C_e_prime\n        C_E1 = (eps0 * eps_inf_vec - C_e_prime) / denom_E\n        C_E2 = dt / (denom_E * dx)\n        C_E3 = (1 - C_d) / denom_E\n        C_P1 = C_d\n        C_P2 = C_e_prime\n        \n        # Incident wave functions\n        def E_inc(x, t):\n            s = t - x / c0\n            envelope = np.exp(-(s - t0_pulse)**2 / (2 * sigma_pulse**2))\n            phase = w0 * (s - t0_pulse) + 0.5 * alpha * (s - t0_pulse)**2\n            return envelope * np.cos(phase)\n        \n        def H_inc(x, t):\n            return E_inc(x, t) / eta0\n\n        probe_L_idx = slab_start_idx\n        probe_R_idx = slab_end_idx - 1 # Ensure probe is inside\n        Ez_L_history = np.zeros(Nt)\n        Ez_R_history = np.zeros(Nt)\n        \n        x_Ez = dx * np.arange(Nx)\n        x_Hy = dx * (np.arange(Nx - 1) + 0.5)\n\n        CHy = dt / (mu0 * dx)\n\n        for n in range(Nt):\n            t_ez = (n + 1) * dt\n            t_hy = (n + 0.5) * dt\n            \n            # --- FDTD Update Loop ---\n            Ez_old = Ez.copy()\n\n            # Update H field\n            Hy[0:-1] += -CHy * (Ez[1:-1] - Ez[0:-2])\n            \n            # Update P field (part one, using old E)\n            Pz = C_P1 * Pz + C_P2 * Ez_old\n\n            # Update E field\n            curl_H = (Hy[1:] - Hy[:-1])\n            Ez[1:-1] = C_E1[1:-1] * Ez_old[1:-1] + C_E2[1:-1] * curl_H - C_E3[1:-1] * Pz[1:-1]\n\n            # Update P field (part two, using new E)\n            Pz += C_P2 * Ez\n            \n            # TF/SF Corrections\n            # Left boundary\n            Ez[tf_start_idx] += C_E2[tf_start_idx] * dx * H_inc(x_Hy[tf_start_idx-1], t_hy)\n            Hy[tf_start_idx-1] -= CHy * E_inc(x_Ez[tf_start_idx], t_ez)\n\n            # Right boundary\n            Ez[tf_end_idx] -= C_E2[tf_end_idx] * dx * H_inc(x_Hy[tf_end_idx], t_hy)\n            Hy[tf_end_idx] += CHy * E_inc(x_Ez[tf_end_idx], t_ez)\n\n            Ez_L_history[n] = Ez[probe_L_idx]\n            Ez_R_history[n] = Ez[probe_R_idx]\n\n        # --- Post-processing ---\n        envelope_L = np.abs(hilbert(Ez_L_history))\n        envelope_R = np.abs(hilbert(Ez_R_history))\n        \n        peak_idx_L = np.argmax(envelope_L)\n        peak_idx_R = np.argmax(envelope_R)\n        \n        t_peak_L = peak_idx_L * dt\n        t_peak_R = peak_idx_R * dt\n        \n        delta_t_meas = t_peak_R - t_peak_L\n\n        # --- Analytical Prediction ---\n        w_eff = w0\n        \n        eps_prime = eps_inf + (eps_s - eps_inf) / (1 + (w_eff * tau)**2)\n        n = np.sqrt(eps_prime)\n        \n        deps_prime_dw = -2 * w_eff * tau**2 * (eps_s - eps_inf) / (1 + (w_eff * tau)**2)**2\n        dn_dw = (1 / (2 * n)) * deps_prime_dw\n        \n        n_g = n + w_eff * dn_dw\n        v_g = c0 / n_g\n        \n        delta_t_pred = L / v_g\n\n        results.append(abs(delta_t_meas - delta_t_pred))\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}