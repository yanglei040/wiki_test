{
    "hands_on_practices": [
        {
            "introduction": "To master the intricacies of the Finite-Difference Time-Domain (FDTD) method, one must first understand its most fundamental artifact: numerical dispersion. This exercise provides a foundational practice by guiding you through the derivation of the 3D FDTD dispersion relation directly from Maxwell's equations. By analyzing this relation, you will quantify how the numerical phase velocity (expressed here as slowness, its reciprocal) changes with the direction of wave propagation relative to the grid axes, revealing the inherent anisotropy of the Yee lattice .",
            "id": "3335203",
            "problem": "A lossless, homogeneous, isotropic medium with speed of light $c$ is discretized by the three-dimensional Finite-Difference Time-Domain (FDTD) method of the Yee scheme using equal spatial steps $\\Delta x=\\Delta y=\\Delta z=\\Delta$ and a uniform time step $\\Delta t$. Consider source-free propagation governed by Maxwell’s curl equations, discretized on the staggered grid, and analyze plane-wave solutions of the form $E,H \\propto \\exp\\!\\big(i(k_x x + k_y y + k_z z - \\omega t)\\big)$ restricted to the discrete spacetime lattice. Let the non-dimensional frequency be fixed at $\\Omega \\equiv \\omega \\Delta t = \\frac{3\\pi}{5}$ (radians), and define the Courant number $S \\equiv \\frac{c\\,\\Delta t}{\\Delta}$. Let the direction of propagation be specified by the unit vector $\\hat{\\boldsymbol{n}}=(n_x,n_y,n_z)$ with $n_x^2+n_y^2+n_z^2=1$. Define the dimensionless slowness (normalized to $1/c$) by $\\sigma(\\hat{\\boldsymbol{n}})\\equiv \\frac{c}{v_p(\\hat{\\boldsymbol{n}})}=\\frac{c\\,k_{\\text{num}}(\\hat{\\boldsymbol{n}})}{\\omega}$, where $k_{\\text{num}}(\\hat{\\boldsymbol{n}})$ is the numerical wavenumber magnitude consistent with the discrete dispersion relation along direction $\\hat{\\boldsymbol{n}}$.\n\nStarting only from the source-free Maxwell curl equations and the Yee-scheme discrete updates on a uniform grid, derive the fully discrete plane-wave dispersion relation. Use it to obtain a closed-form expression for $\\sigma(\\hat{\\boldsymbol{n}})$ in terms of $\\Omega$ and $S$ for propagation constrained to each of the following symmetry directions:\n- $\\langle 100\\rangle$: $\\hat{\\boldsymbol{n}}=(1,0,0)$,\n- $\\langle 110\\rangle$: $\\hat{\\boldsymbol{n}}=\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}},0\\right)$,\n- $\\langle 111\\rangle$: $\\hat{\\boldsymbol{n}}=\\left(\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}}\\right)$.\n\nYour result must be expressed as a single row matrix $\\big[\\sigma_{\\langle 100\\rangle}\\;\\;\\sigma_{\\langle 110\\rangle}\\;\\;\\sigma_{\\langle 111\\rangle}\\big]$ in closed form, using only $\\Omega=\\frac{3\\pi}{5}$, $S$, and standard constants and functions. Do not introduce any numerical rounding. State all angles in radians and express the slowness as dimensionless quantities (no units).",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The givens are a lossless, homogeneous, isotropic medium with speed of light $c$, discretized by the three-dimensional Finite-Difference Time-Domain (FDTD) method using a uniform Yee grid with spatial step $\\Delta$ and time step $\\Delta t$. We are to analyze source-free plane-wave propagation. Key definitions include the non-dimensional frequency $\\Omega \\equiv \\omega \\Delta t = \\frac{3\\pi}{5}$, the Courant number $S \\equiv \\frac{c\\,\\Delta t}{\\Delta}$, the propagation direction unit vector $\\hat{\\boldsymbol{n}}$, and the dimensionless slowness $\\sigma(\\hat{\\boldsymbol{n}})\\equiv \\frac{c}{v_p(\\hat{\\boldsymbol{n}})}=\\frac{c\\,k_{\\text{num}}(\\hat{\\boldsymbol{n}})}{\\omega}$. The problem asks for the derivation of the fully discrete dispersion relation and its use to find $\\sigma$ for the $\\langle 100\\rangle$, $\\langle 110\\rangle$, and $\\langle 111\\rangle$ directions.\n\nThe problem is valid. It is a standard and fundamental exercise in computational electromagnetics, grounded in Maxwell's equations and the principles of finite difference methods. All terms are precisely defined, and the required information is self-contained. The problem is objective and formalizable. We may proceed with the solution.\n\nThe derivation begins with the source-free Maxwell's curl equations in a lossless, homogeneous, isotropic medium characterized by permittivity $\\epsilon$ and permeability $\\mu$:\n$$ \\nabla \\times \\boldsymbol{E} = -\\mu \\frac{\\partial \\boldsymbol{H}}{\\partial t} $$\n$$ \\nabla \\times \\boldsymbol{H} = \\epsilon \\frac{\\partial \\boldsymbol{E}}{\\partial t} $$\nThe speed of light in this medium is $c = \\frac{1}{\\sqrt{\\epsilon\\mu}}$.\n\nThe Yee FDTD scheme discretizes these equations using central-difference approximations for both spatial and temporal derivatives on a staggered grid. For a plane-wave solution of the form $\\boldsymbol{F}(\\boldsymbol{r}, t) = \\boldsymbol{F}_0 \\exp(i(\\boldsymbol{k}_{\\text{num}}\\cdot\\boldsymbol{r} - \\omega t))$, where $\\boldsymbol{F}$ is any field component ($\\boldsymbol{E}$ or $\\boldsymbol{H}$) and $\\boldsymbol{k}_{\\text{num}} = (k_x, k_y, k_z)$ is the numerical wavevector, the action of the discrete operators can be found.\n\nThe central difference in time, staggered by $\\Delta t/2$, on a field component $F$ becomes:\n$$ \\frac{F^{n+1/2} - F^{n-1/2}}{\\Delta t} \\rightarrow \\frac{\\exp(-i\\omega(t_n+\\Delta t/2)) - \\exp(-i\\omega(t_n-\\Delta t/2))}{\\Delta t} F_0 \\exp(i\\boldsymbol{k}_{\\text{num}}\\cdot\\boldsymbol{r}) = \\frac{-2i}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) F $$\nThus, the operator $\\frac{\\partial}{\\partial t}$ is replaced by a multiplicative factor in the Fourier domain:\n$$ \\frac{\\partial}{\\partial t} \\rightarrow \\frac{-2i}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\nSimilarly, the central difference in a spatial dimension, e.g., $x$, staggered by $\\Delta/2$:\n$$ \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta} \\rightarrow \\frac{\\exp(ik_x(x_i+\\Delta/2)) - \\exp(ik_x(x_i-\\Delta/2))}{\\Delta} F_0 \\exp(i(k_y y+k_z z - \\omega t)) = \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x\\Delta}{2}\\right) F $$\nThus, the spatial derivative operators are replaced as:\n$$ \\frac{\\partial}{\\partial x_j} \\rightarrow \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\nSubstituting these into Maxwell's equations yields the discretized equations in the Fourier domain:\n$$ i\\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{E} = - \\mu \\left( \\frac{-i\\omega_{\\text{num}}}{\\mu} \\boldsymbol{H} \\right) \\implies \\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{E} = \\omega_{\\text{num}} \\boldsymbol{H} $$\n$$ i\\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{H} = \\epsilon \\left( \\frac{-i\\omega_{\\text{num}}}{\\epsilon} \\boldsymbol{E} \\right) \\implies \\boldsymbol{K}_{\\text{num}} \\times \\boldsymbol{H} = -\\omega_{\\text{num}} \\boldsymbol{E} $$\nwhere we have defined effective wavenumber vector components $K_j$ and effective frequency $\\omega_{\\text{eff}}$ for clarity, but it's simpler to directly substitute the full expressions. Let's define the discrete operators acting on the wave as:\n$$ \\omega_d \\equiv \\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n$$ K_j \\equiv \\frac{2}{\\Delta}\\sin\\left(\\frac{k_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\nThe system of equations becomes:\n$$ \\boldsymbol{K} \\times \\boldsymbol{E} = \\mu \\omega_d \\boldsymbol{H} $$\n$$ \\boldsymbol{K} \\times \\boldsymbol{H} = -\\epsilon \\omega_d \\boldsymbol{E} $$\nwhere $\\boldsymbol{K} = (K_x, K_y, K_z)$. Taking the curl of the first equation and substituting the second:\n$$ \\boldsymbol{K} \\times (\\boldsymbol{K} \\times \\boldsymbol{E}) = \\mu \\omega_d (\\boldsymbol{K} \\times \\boldsymbol{H}) = \\mu \\omega_d (-\\epsilon \\omega_d \\boldsymbol{E}) = -\\mu\\epsilon \\omega_d^2 \\boldsymbol{E} $$\nUsing the vector identity $\\boldsymbol{A} \\times (\\boldsymbol{B} \\times \\boldsymbol{C}) = \\boldsymbol{B}(\\boldsymbol{A} \\cdot \\boldsymbol{C}) - \\boldsymbol{C}(\\boldsymbol{A} \\cdot \\boldsymbol{B})$ and assuming a transverse wave for which $\\boldsymbol{K} \\cdot \\boldsymbol{E} = 0$:\n$$ -\\boldsymbol{E}(\\boldsymbol{K} \\cdot \\boldsymbol{K}) = -\\mu\\epsilon \\omega_d^2 \\boldsymbol{E} $$\nThis gives the algebraic relation $|\\boldsymbol{K}|^2 = \\mu\\epsilon \\omega_d^2$. Substituting the definitions of $\\omega_d$ and $K_j$, and $\\mu\\epsilon = 1/c^2$:\n$$ \\left(\\frac{2}{\\Delta}\\right)^2 \\left[ \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) \\right] = \\frac{1}{c^2} \\left(\\frac{2}{\\Delta t}\\right)^2 \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\nSimplifying by dividing by $4$ and rearranging terms, we get the FDTD numerical dispersion relation:\n$$ \\frac{1}{(c\\Delta t)^2} \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{1}{\\Delta^2} \\left[ \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) \\right] $$\nUsing the dimensionless Courant number $S = \\frac{c\\Delta t}{\\Delta}$ and non-dimensional frequency $\\Omega = \\omega \\Delta t$:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) $$\nNow, we introduce the dimensionless slowness $\\sigma = \\frac{ck_{\\text{num}}}{\\omega}$. The components of the numerical wavevector are $k_j = k_{\\text{num}}n_j$, where $\\hat{\\boldsymbol{n}}=(n_x,n_y,n_z)$ is the direction of propagation. The argument of the sine functions on the right-hand side can be re-expressed in terms of $\\sigma$, $S$, and $\\Omega$:\n$$ \\frac{k_j\\Delta}{2} = \\frac{(k_{\\text{num}}n_j)\\Delta}{2} = \\frac{(\\omega\\sigma/c)n_j\\Delta}{2} = \\frac{\\omega\\Delta t}{2} \\frac{\\sigma n_j}{c\\Delta t/\\Delta} = \\frac{(\\Omega/2)\\sigma n_j}{S} = \\frac{n_j\\Omega\\sigma}{2S} $$\nSubstituting this into the dispersion relation gives a general equation for $\\sigma(\\hat{\\boldsymbol{n}})$:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sum_{j \\in \\{x,y,z\\}} \\sin^2\\left(\\frac{n_j\\Omega\\sigma}{2S}\\right) $$\nWe are given $\\Omega = \\frac{3\\pi}{5}$, so $\\frac{\\Omega}{2} = \\frac{3\\pi}{10}$. We now solve for $\\sigma$ along the three specified symmetry directions.\n\nCase 1: Axial propagation, $\\langle 100\\rangle$ direction.\nHere, $\\hat{\\boldsymbol{n}} = (1, 0, 0)$. The equation for $\\sigma_{\\langle 100\\rangle}$ becomes:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 100\\rangle}}{2S}\\right) + 0 + 0 $$\nTaking the positive square root:\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sin\\left(\\frac{\\Omega\\sigma_{\\langle 100\\rangle}}{2S}\\right) $$\nSolving for $\\sigma_{\\langle 100\\rangle}$:\n$$ \\sigma_{\\langle 100\\rangle} = \\frac{2S}{\\Omega} \\arcsin\\left(\\frac{1}{S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{2S}{3\\pi/5} \\arcsin\\left(\\frac{1}{S}\\sin\\left(\\frac{3\\pi}{10}\\right)\\right) = \\frac{10S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{S}\\right) $$\n\nCase 2: Planar-diagonal propagation, $\\langle 110\\rangle$ direction.\nHere, $\\hat{\\boldsymbol{n}} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0\\right)$. The equation for $\\sigma_{\\langle 110\\rangle}$ becomes:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) + \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) + 0 = 2\\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) $$\nTaking the positive square root:\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sqrt{2}\\sin\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) $$\n$$ \\sigma_{\\langle 110\\rangle} = \\frac{2\\sqrt{2}S}{\\Omega} \\arcsin\\left(\\frac{1}{\\sqrt{2}S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{10\\sqrt{2}S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{\\sqrt{2}S}\\right) $$\n\nCase 3: Space-diagonal propagation, $\\langle 111\\rangle$ direction.\nHere, $\\hat{\\boldsymbol{n}} = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$. The equation for $\\sigma_{\\langle 111\\rangle}$ becomes:\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = 3\\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 111\\rangle}}{2\\sqrt{3}S}\\right) $$\nTaking the positive square root:\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sqrt{3}\\sin\\left(\\frac{\\Omega\\sigma_{\\langle 111\\rangle}}{2\\sqrt{3}S}\\right) $$\n$$ \\sigma_{\\langle 111\\rangle} = \\frac{2\\sqrt{3}S}{\\Omega} \\arcsin\\left(\\frac{1}{\\sqrt{3}S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{10\\sqrt{3}S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{\\sqrt{3}S}\\right) $$\n\nThese three closed-form expressions constitute the final answer. They are assembled into a single row matrix as required.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{10S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{S}\\right) & \\frac{10\\sqrt{2}S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{\\sqrt{2}S}\\right) & \\frac{10\\sqrt{3}S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{\\sqrt{3}S}\\right) \\end{pmatrix} } $$"
        },
        {
            "introduction": "Understanding that numerical anisotropy exists is the first step; controlling it is the mark of an expert practitioner. For any FDTD simulation to be credible, its numerical errors must be bounded. This practice transitions from theory to engineering design by using an asymptotic analysis to derive a practical constraint on the grid resolution, $\\Delta/\\lambda$, required to keep the directional phase velocity error below a specified tolerance . Completing this exercise equips you with the analytical tools to design simulations that meet stringent accuracy requirements.",
            "id": "3335173",
            "problem": "A plane-wave numerical dispersion analysis is performed for the three-dimensional Finite-Difference Time-Domain (FDTD) method, where Finite-Difference Time-Domain (FDTD) denotes the standard Yee staggered-grid scheme in vacuum. Consider a uniform cubic spatial grid with spacing $\\Delta$ in all three directions and a time step $\\Delta t$. Define the Courant number as $S = c\\,\\Delta t/\\Delta$, where $c$ is the speed of light in vacuum. Let the continuous-wave frequency be $f$ with wavelength $\\lambda = c/f$ and wavenumber magnitude $k = 2\\pi/\\lambda$. For a plane wave with propagation direction $\\hat{\\mathbf{k}} = (\\mu_x,\\mu_y,\\mu_z)$ satisfying $\\mu_x^2+\\mu_y^2+\\mu_z^2=1$, denote by $v_p(\\hat{\\mathbf{k}})$ the numerical phase velocity supported by the discrete scheme at fixed $k$.\n\nStarting from Maxwell’s equations in vacuum and the Yee finite-difference discretization, derive the discrete dispersion relation and use a small-parameter asymptotic expansion in $k\\Delta$ (retain terms sufficient to resolve angular dependence) to obtain the leading-order angular dependence of $v_p(\\hat{\\mathbf{k}})$. Define the angular anisotropy at fixed $k$ as\n$$\n\\mathcal{A} \\equiv \\frac{\\max_{\\hat{\\mathbf{k}}} v_p(\\hat{\\mathbf{k}}) - \\min_{\\hat{\\mathbf{k}}} v_p(\\hat{\\mathbf{k}})}{c}.\n$$\nImpose a target tolerance $\\mathcal{A} \\le \\epsilon$ with $\\epsilon = 0.01$ at the given frequency $f$. By bounding the variation of $v_p(\\hat{\\mathbf{k}})$ over all directions, derive a constraint on $\\Delta/\\lambda$ and $S$ that guarantees $\\mathcal{A} \\le \\epsilon$ to leading order in $k\\Delta$. Using your result, determine the maximal allowable ratio $\\Delta/\\lambda$ such that the target is met for some admissible Courant number $S$ in three dimensions. Round your final numerical answer for the maximal $\\Delta/\\lambda$ to four significant figures. Express the final number as a dimensionless quantity with no units.",
            "solution": "The starting point for the analysis is Maxwell's curl equations in a source-free vacuum:\n$$ \\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} $$\nwhere $\\mathbf{E}$ is the electric field, $\\mathbf{H}$ is the magnetic field, and $\\mu_0$ and $\\epsilon_0$ are the permeability and permittivity of vacuum, respectively, satisfying $\\mu_0\\epsilon_0 = 1/c^2$, with $c$ being the speed of light.\n\nFor the standard Yee FDTD scheme on a uniform cubic grid with spacing $\\Delta$, the central-difference approximations for the spatial and temporal derivatives are used. We assume a discrete plane-wave solution (ansatz) for the fields, sampled at the grid points $(i\\Delta, j\\Delta, k\\Delta)$ and time steps $n\\Delta t$:\n$$ \\mathbf{F}(i\\Delta, j\\Delta, k\\Delta, n\\Delta t) = \\mathbf{F}_0 \\exp\\left[i\\left(\\tilde{k}_x i\\Delta + \\tilde{k}_y j\\Delta + \\tilde{k}_z k\\Delta - \\tilde{\\omega} n\\Delta t\\right)\\right] $$\nwhere $\\mathbf{F}$ represents either $\\mathbf{E}$ or $\\mathbf{H}$, $\\tilde{\\mathbf{k}}=(\\tilde{k}_x, \\tilde{k}_y, \\tilde{k}_z)$ is the numerical wave vector, and $\\tilde{\\omega}$ is the numerical angular frequency.\n\nSubstituting this ansatz into the Yee-discretized Maxwell's equations transforms the differential operators into algebraic factors. A spatial difference, e.g., $\\frac{f(x+\\Delta/2) - f(x-\\Delta/2)}{\\Delta}$, acting on $\\exp(i\\tilde{k}_x x)$ becomes $\\frac{2i}{\\Delta}\\sin(\\frac{\\tilde{k}_x\\Delta}{2})\\exp(i\\tilde{k}_x x)$. Similarly, the temporal difference operator becomes $\\frac{-2i}{\\Delta t}\\sin(\\frac{\\tilde{\\omega}\\Delta t}{2})\\exp(-i\\tilde{\\omega}t)$.\n\nThis procedure leads to a system of algebraic equations that can be compactly written by replacing the continuous operators $(\\nabla, \\frac{\\partial}{\\partial t})$ with their effective numerical counterparts. The system is equivalent to the continuous-wave equations with the substitutions:\n$$ k_j \\rightarrow \\tilde{k}'_j = \\frac{2}{\\Delta} \\sin\\left(\\frac{\\tilde{k}_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\n$$ \\omega \\rightarrow \\tilde{\\omega}' = \\frac{2}{\\Delta t} \\sin\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\nThe continuous-wave dispersion relation in vacuum is $|\\mathbf{k}|^2 = (\\omega/c)^2$. Its numerical counterpart is therefore:\n$$ (\\tilde{k}'_x)^2 + (\\tilde{k}'_y)^2 + (\\tilde{k}'_z)^2 = \\left(\\frac{\\tilde{\\omega}'}{c}\\right)^2 $$\nSubstituting the expressions for $\\tilde{k}'_j$ and $\\tilde{\\omega}'$:\n$$ \\left(\\frac{2}{\\Delta}\\right)^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_z\\Delta}{2}\\right) \\right] = \\frac{1}{c^2} \\left(\\frac{2}{\\Delta t}\\right)^2 \\sin^2\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\nMultiplying by $\\frac{c^2(\\Delta t)^2}{4}$ and using the Courant number definition $S = c\\Delta t/\\Delta$:\n$$ S^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_z\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\nThis is the numerical dispersion relation for the 3D Yee FDTD scheme.\n\nWe are analyzing a continuous wave of a fixed frequency $f$, so we set the numerical frequency to the continuous frequency: $\\tilde{\\omega} = \\omega = 2\\pi f = ck$. The numerical wave vector is $\\tilde{\\mathbf{k}} = \\tilde{k}\\hat{\\mathbf{k}} = \\tilde{k}(\\mu_x, \\mu_y, \\mu_z)$. The dispersion relation becomes:\n$$ S^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}\\mu_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}\\mu_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}\\mu_z\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\nTo find the phase velocity $v_p = \\tilde{\\omega}/\\tilde{k} = \\omega/\\tilde{k}$, we perform an asymptotic expansion for small $k\\Delta$. This implies that $\\lambda \\gg \\Delta$, and thus arguments of the sine functions are small. We use the Taylor series $\\sin(x) = x - x^3/6 + O(x^5)$, which gives $\\sin^2(x) = x^2 - x^4/3 + O(x^6)$.\n\nThe right-hand side (RHS) of the dispersion relation becomes:\n$$ \\text{RHS} = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\sin^2\\left(\\frac{ck\\Delta t}{2}\\right) = \\sin^2\\left(\\frac{k\\Delta S}{2}\\right) \\approx \\left(\\frac{k\\Delta S}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{k\\Delta S}{2}\\right)^4 = \\frac{S^2(k\\Delta)^2}{4} - \\frac{S^4(k\\Delta)^4}{48} $$\nThe left-hand side (LHS) becomes:\n$$ \\text{LHS} = S^2 \\sum_{j \\in \\{x,y,z\\}} \\sin^2\\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right) \\approx S^2 \\sum_j \\left[ \\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right)^4 \\right] $$\n$$ \\text{LHS} \\approx S^2 \\left[ \\frac{(\\tilde{k}\\Delta)^2}{4}\\sum_j\\mu_j^2 - \\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 \\right] $$\nSince $\\sum_j\\mu_j^2 = 1$:\n$$ \\text{LHS} \\approx S^2\\frac{(\\tilde{k}\\Delta)^2}{4} - S^2\\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 $$\nEquating the expanded LHS and RHS:\n$$ S^2\\frac{(\\tilde{k}\\Delta)^2}{4} - S^2\\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 \\approx \\frac{S^2(k\\Delta)^2}{4} - \\frac{S^4(k\\Delta)^4}{48} $$\nDividing by $S^2(\\Delta^2/4)$:\n$$ \\tilde{k}^2 - \\frac{\\tilde{k}^4\\Delta^2}{12}\\sum_j\\mu_j^4 \\approx k^2 - \\frac{S^2k^4\\Delta^2}{12} $$\nTo solve for $\\tilde{k}$, we use a perturbative approach. To leading order, $\\tilde{k} \\approx k$. We substitute this into the higher-order terms:\n$$ \\tilde{k}^2 \\approx k^2 - \\frac{S^2k^4\\Delta^2}{12} + \\frac{k^4\\Delta^2}{12}\\sum_j\\mu_j^4 = k^2\\left[1 - \\frac{(k\\Delta)^2}{12}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right] $$\n$$ \\tilde{k} \\approx k\\left[1 - \\frac{(k\\Delta)^2}{12}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right]^{1/2} \\approx k\\left[1 - \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right] $$\nThe normalized numerical phase velocity is $v_p/c = (\\omega/\\tilde{k})/c = k/\\tilde{k}$:\n$$ \\frac{v_p(\\hat{\\mathbf{k}})}{c} = \\frac{k}{\\tilde{k}} \\approx \\left[1 - \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right]^{-1} \\approx 1 + \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right) $$\nThe anisotropy $\\mathcal{A}$ depends on the variation of $v_p$ with the direction $\\hat{\\mathbf{k}}$. This variation is governed by the term $F(\\hat{\\mathbf{k}}) = \\sum_j\\mu_j^4 = \\mu_x^4+\\mu_y^4+\\mu_z^4$. We need to find the minimum and maximum of $F$ subject to the constraint $\\mu_x^2+\\mu_y^2+\\mu_z^2=1$.\nLet $x=\\mu_x^2, y=\\mu_y^2, z=\\mu_z^2$. We seek to extremize $x^2+y^2+z^2$ subject to $x+y+z=1$ and $x,y,z \\ge 0$.\nThe maximum value occurs at the vertices of the constraint domain, e.g., $(x,y,z)=(1,0,0)$. This corresponds to propagation along a grid axis, e.g., $\\hat{\\mathbf{k}} = (1,0,0)$.\n$$ F_{\\max} = 1^4+0^4+0^4 = 1 $$\nThe minimum value occurs when $x=y=z=1/3$. This corresponds to propagation along a space diagonal, e.g., $\\hat{\\mathbf{k}} = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$.\n$$ F_{\\min} = 3 \\times (1/\\sqrt{3})^4 = 3 \\times (1/9) = 1/3 $$\nThe phase velocity is maximized when $\\sum_j \\mu_j^4$ is minimized and minimized when it is maximized, due to the negative sign in its formula:\n$$ \\frac{v_{p,\\max}}{c} \\approx 1 + \\frac{(k\\Delta)^2}{24}(S^2 - F_{\\min}) = 1 + \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\frac{1}{3}\\right) $$\n$$ \\frac{v_{p,\\min}}{c} \\approx 1 + \\frac{(k\\Delta)^2}{24}(S^2 - F_{\\max}) = 1 + \\frac{(k\\Delta)^2}{24}(S^2 - 1) $$\nThe anisotropy is defined as $\\mathcal{A} \\equiv (\\max v_p - \\min v_p)/c$:\n$$ \\mathcal{A} = \\frac{v_{p,\\max}}{c} - \\frac{v_{p,\\min}}{c} \\approx \\frac{(k\\Delta)^2}{24}\\left[\\left(S^2 - \\frac{1}{3}\\right) - (S^2 - 1)\\right] = \\frac{(k\\Delta)^2}{24}\\left(1 - \\frac{1}{3}\\right) = \\frac{(k\\Delta)^2}{24}\\left(\\frac{2}{3}\\right) $$\n$$ \\mathcal{A} \\approx \\frac{(k\\Delta)^2}{36} $$\nThis leading-order result for anisotropy is independent of the Courant number $S$. The problem requires this to be satisfied for *some* admissible $S$. For the 3D Yee scheme, the stability condition is $S \\le 1/\\sqrt{3}$. Since our result for $\\mathcal{A}$ is independent of $S$, any stable $S$ can be chosen without affecting the anisotropy constraint.\n\nWe are given the tolerance $\\mathcal{A} \\le \\epsilon$, where $\\epsilon=0.01$. Substituting $k = 2\\pi/\\lambda$:\n$$ \\frac{((2\\pi/\\lambda)\\Delta)^2}{36} \\le \\epsilon $$\n$$ \\frac{4\\pi^2(\\Delta/\\lambda)^2}{36} \\le \\epsilon $$\n$$ \\frac{\\pi^2}{9}\\left(\\frac{\\Delta}{\\lambda}\\right)^2 \\le \\epsilon $$\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)^2 \\le \\frac{9\\epsilon}{\\pi^2} $$\nThe maximal allowable ratio $\\Delta/\\lambda$ is therefore:\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} = \\sqrt{\\frac{9\\epsilon}{\\pi^2}} = \\frac{3\\sqrt{\\epsilon}}{\\pi} $$\nSubstituting $\\epsilon = 0.01$:\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} = \\frac{3\\sqrt{0.01}}{\\pi} = \\frac{3 \\times 0.1}{\\pi} = \\frac{0.3}{\\pi} $$\nNow, we compute the numerical value and round to four significant figures:\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} \\approx \\frac{0.3}{3.14159265...} \\approx 0.0954929658... $$\nRounding to four significant figures gives $0.09549$.",
            "answer": "$$\\boxed{0.09549}$$"
        },
        {
            "introduction": "The behavior of waves on a discrete grid can sometimes be counter-intuitive, with certain parameter choices leading to surprisingly ideal outcomes. This problem delves into one such \"magic time step\" scenario in a 2D simulation, where numerical dispersion errors can be completely eliminated for a wave propagating along a specific diagonal direction. Working through this case provides deep insight into the interplay between spatial and temporal discretization and also introduces the important practical issue of how sources can excite spurious aliased modes on the grid .",
            "id": "3335193",
            "problem": "Consider a two-dimensional Finite-Difference Time-Domain (FDTD) simulation in free space on a uniform Yee grid with equal spacings $\\Delta x = \\Delta y = \\Delta$ and time step $\\Delta t$. The Courant number is defined as $S \\equiv c\\,\\Delta t/\\Delta$, where $c$ is the speed of light in vacuum. A time-harmonic distributed line source located along the line $x=0$ is phased (in continuous space) to generate a single oblique plane wave of free-space wavelength $\\lambda = 2\\Delta$ at an angle $\\theta = 45^\\circ$ measured from the $+x$-axis toward $+y$. The source is implemented by sampling the continuous plane-wave field along the grid and driving the sampled values at the grid nodes on the source line.\n\nStarting from the curl equations of Maxwell’s equations in free space and their standard second-order Yee staggered-grid discretization (no shortcuts or pre-quoted dispersion formulas are allowed within your reasoning), perform the following:\n\n1) Determine the discrete spatial Fourier spectrum along the source line (treated as a one-dimensional sampling along $y$) of the sampled plane wave. Identify the set of discrete transverse wavenumbers $k_y^{(m)}$ that are injected due to spatial sampling, and determine which of these correspond to propagating orders in the underlying continuous medium for the given $\\lambda$ and $\\theta$. Then argue, using the periodicity properties that arise from the staggered-grid sampling, whether any of these orders correspond to distinct propagating directions inside the discrete FDTD medium.\n\n2) Specialize to the Courant number $S = 1/\\sqrt{2}$. Using the dispersion relation implied by the Yee scheme that you derive from first principles, and taking the continuous drive frequency $\\omega = 2\\pi c/\\lambda$, determine the $x$-component of the numerical wavevector $k_x$ that the FDTD domain supports for the injected transverse component $k_y$. From this, compute the magnitude $|\\mathbf{k}|$ and hence the numerical phase velocity $v_p = \\omega/|\\mathbf{k}|$ of the actually propagating plane-wave order.\n\nYour final task: Report the normalized numerical phase velocity $v_p/c$ as a single exact number. No rounding is required. Angles, where present in your reasoning, may be in degrees or radians, but your final answer must be unitless. If no spurious aliased propagating orders exist at the stated parameters, state that fact in your reasoning; you do not need to report anything about them in the final answer.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n- Simulation: Two-dimensional Finite-Difference Time-Domain (FDTD).\n- Medium: Free space, permittivity $\\epsilon_0$, permeability $\\mu_0$. Speed of light $c = 1/\\sqrt{\\epsilon_0 \\mu_0}$.\n- Grid: Uniform Yee grid with $\\Delta x = \\Delta y = \\Delta$.\n- Time step: $\\Delta t$.\n- Courant number: $S \\equiv c\\,\\Delta t/\\Delta$.\n- Source: A time-harmonic distributed line source at $x=0$, phased to generate a single oblique plane wave.\n- Plane wave parameters: Free-space wavelength $\\lambda = 2\\Delta$, propagation angle $\\theta = 45^\\circ$ from the $+x$-axis toward the $+y$-axis.\n- Part 2 specific condition: $S = 1/\\sqrt{2}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on Maxwell's equations and the standard Yee FDTD algorithm, which are fundamental concepts in computational electromagnetics. All principles involved are well-established.\n- **Well-Posed:** The problem provides a complete set of parameters ($\\lambda$, $\\theta$, $S$, grid geometry) and asks for specific, derivable quantities (injected wavenumbers, numerical phase velocity). The path to the solution is clearly defined by requiring derivation from first principles.\n- **Objective:** The problem is stated using precise, unambiguous technical language. There are no subjective or opinion-based elements.\n- **Other criteria:** The problem is formalizable, relevant to the topic of numerical dispersion, contains no internal contradictions, uses physically plausible (though idealized for analysis) parameters, and is not trivial as it requires a full derivation of the FDTD dispersion relation.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe solution is developed in two parts as requested by the problem statement.\n\n#### Part 1: Analysis of the Injected Spatial Spectrum\n\nA continuous, time-harmonic plane wave propagating in the direction specified by the angle $\\theta$ has a spatial dependence of the form $\\exp(-j\\mathbf{k} \\cdot \\mathbf{r})$, where $\\mathbf{k}$ is the continuous-space wavevector and $\\mathbf{r} = x\\hat{x} + y\\hat{y}$. The magnitude of the wavevector is $k = \\omega/c = 2\\pi/\\lambda$. Given $\\lambda = 2\\Delta$, we have $k = 2\\pi/(2\\Delta) = \\pi/\\Delta$.\n\nThe components of the wavevector are:\n$$k_x = k \\cos\\theta = (\\pi/\\Delta)\\cos(45^\\circ) = \\frac{\\pi}{\\sqrt{2}\\Delta}$$\n$$k_y = k \\sin\\theta = (\\pi/\\Delta)\\sin(45^\\circ) = \\frac{\\pi}{\\sqrt{2}\\Delta}$$\n\nThe source is located along the line $x=0$ and is implemented by sampling the continuous plane-wave field. The field variation along this line is given by setting $x=0$: $\\exp(-j(k_x \\cdot 0 + k_y y)) = \\exp(-j k_y y)$.\n\nThis continuous field is sampled at the grid locations $y_j = j\\Delta$, where $j$ is an integer. The sampled values driving the grid nodes are proportional to $\\exp(-j k_y j\\Delta)$.\nThe process of sampling in the spatial domain leads to aliasing in the spatial frequency (wavenumber) domain. A continuous transverse wavenumber $k_y$ is indistinguishable from any wavenumber $k_y^{(m)}$ that satisfies:\n$$k_y^{(m)} = k_y + \\frac{2\\pi m}{\\Delta}$$\nfor any integer $m$. These are the discrete transverse wavenumbers injected into the grid due to sampling. Substituting the value of $k_y$:\n$$k_y^{(m)} = \\frac{\\pi}{\\sqrt{2}\\Delta} + \\frac{2\\pi m}{\\Delta} = \\frac{\\pi}{\\Delta} \\left(\\frac{1}{\\sqrt{2}} + 2m\\right)$$\nThis is the set of discrete transverse wavenumbers potentially excited by the source.\n\nNext, we determine which of these orders correspond to propagating waves in the underlying continuous medium. A plane wave with wavevector $\\mathbf{k}^{(m)} = (k_x^{(m)}, k_y^{(m)})$ is propagating in free space if its magnitude is real and equal to $k = \\omega/c$. That is, $(k_x^{(m)})^2 + (k_y^{(m)})^2 = k^2$. For a real-valued $k_x^{(m)}$ to exist, we must have $(k_x^{(m)})^2 \\ge 0$, which implies $k^2 - (k_y^{(m)})^2 \\ge 0$, or $|k_y^{(m)}| \\le k$.\nGiven $k = \\pi/\\Delta$, the condition is $|k_y^{(m)}| \\le \\pi/\\Delta$. Let's test this for different integer values of $m$:\n- For $m=0$: $k_y^{(0)} = \\frac{\\pi}{\\sqrt{2}\\Delta} \\approx 0.707 \\frac{\\pi}{\\Delta}$. Since $|k_y^{(0)}|  \\pi/\\Delta$, this order is propagating in the continuous medium. This is the intended fundamental order.\n- For $m=1$: $k_y^{(1)} = \\frac{\\pi}{\\Delta}(\\frac{1}{\\sqrt{2}} + 2) \\approx 2.707 \\frac{\\pi}{\\Delta}$. Since $|k_y^{(1)}| > \\pi/\\Delta$, this order would be evanescent in the continuous medium.\n- For $m=-1$: $k_y^{(-1)} = \\frac{\\pi}{\\Delta}(\\frac{1}{\\sqrt{2}} - 2) \\approx -1.293 \\frac{\\pi}{\\Delta}$. Since $|k_y^{(-1)}| > \\pi/\\Delta$, this order would also be evanescent.\nFor all other $|m| \\ge 1$, $|k_y^{(m)}|$ will be even larger. Thus, only the $m=0$ order corresponds to a propagating wave in the continuous medium.\n\nFinally, we argue whether these orders correspond to distinct propagating directions inside the discrete FDTD medium. A numerical plane wave propagating on the grid has field values at grid points $(i\\Delta, j\\Delta)$ proportional to $\\exp(-j(\\tilde{k}_x i\\Delta + \\tilde{k}_y j\\Delta))$. The source at $x=0$ imposes the transverse variation. For an aliased wavenumber $k_y^{(m)}$, the phase variation along the $y$-axis grid points is:\n$$\\exp(-j k_y^{(m)} j\\Delta) = \\exp\\left(-j \\left(k_y + \\frac{2\\pi m}{\\Delta}\\right) j\\Delta\\right) = \\exp(-j k_y j\\Delta) \\exp(-j 2\\pi mj)$$\nSince $m$ and $j$ are integers, $\\exp(-j 2\\pi mj) = 1$. Therefore, $\\exp(-j k_y^{(m)} j\\Delta) = \\exp(-j k_y j\\Delta)$ for all $m$.\nThis demonstrates that all aliased transverse wavenumbers $k_y^{(m)}$ produce the exact same set of sampled values at the grid nodes. The discrete grid cannot distinguish between them. All aliases \"fold\" into the first Brillouin zone of the grid, effectively exciting only a single numerical transverse wavenumber $\\tilde{k}_y$ that matches the phase progression of the fundamental component. Thus, none of the aliased orders correspond to distinct propagating directions inside the FDTD medium. The grid supports only one wave corresponding to the fundamental transverse wavenumber $k_y^{(0)}$.\n\n#### Part 2: Numerical Phase Velocity Calculation\n\nWe begin by deriving the numerical dispersion relation from Maxwell's curl equations in free space for a 2D $\\text{TM}_z$ mode ($E_z, H_x, H_y$).\n$$ \\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t} \\implies \\frac{\\partial E_z}{\\partial y} = -\\mu_0 \\frac{\\partial H_x}{\\partial t} \\quad \\text{and} \\quad \\frac{\\partial E_z}{\\partial x} = \\mu_0 \\frac{\\partial H_y}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} \\implies \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y} = \\epsilon_0 \\frac{\\partial E_z}{\\partial t} $$\nApplying standard second-order central differences on the Yee grid ($\\Delta x=\\Delta y=\\Delta$) where $E_z$ is at $(i\\Delta, j\\Delta, n\\Delta t)$, $H_x$ is at $(i\\Delta, (j+1/2)\\Delta, (n+1/2)\\Delta t)$, and $H_y$ is at $((i+1/2)\\Delta, j\\Delta, (n+1/2)\\Delta t)$:\n$$ \\frac{E_{z,i,j+1}^n - E_{z,i,j}^n}{\\Delta} = -\\mu_0 \\frac{H_{x,i,j+1/2}^{n+1/2} - H_{x,i,j+1/2}^{n-1/2}}{\\Delta t} $$\n$$ \\frac{E_{z,i+1,j}^n - E_{z,i,j}^n}{\\Delta} = \\mu_0 \\frac{H_{y,i+1/2,j}^{n+1/2} - H_{y,i+1/2,j}^{n-1/2}}{\\Delta t} $$\n$$ \\frac{H_{y,i+1/2,j}^{n+1/2} - H_{y,i-1/2,j}^{n+1/2}}{\\Delta} - \\frac{H_{x,i,j+1/2}^{n+1/2} - H_{x,i,j-1/2}^{n+1/2}}{\\Delta} = \\epsilon_0 \\frac{E_{z,i,j}^{n+1} - E_{z,i,j}^{n}}{\\Delta t} $$\nWe assume a numerical plane-wave solution of the form:\n$$F^n_{i,j} = F_0 \\exp[j(\\omega n\\Delta t - \\tilde{k}_x i\\Delta - \\tilde{k}_y j\\Delta)]$$\nwhere $F$ is any field component, with $F_0$ its complex amplitude, and the spatial and temporal locations are adjusted according to the staggered grid. Substituting this ansatz into the three finite-difference equations yields a system of linear equations for the amplitudes $E_{z0}, H_{x0}, H_{y0}$.\nFrom the $H_x$ update equation:\n$$E_{z0} \\frac{e^{-j\\tilde{k}_y\\Delta} - 1}{\\Delta} = -\\mu_0 H_{x0} \\frac{e^{j\\omega\\Delta t/2} - e^{-j\\omega\\Delta t/2}}{\\Delta t} e^{j\\omega\\Delta t/2} e^{j\\tilde{k}_y\\Delta/2}$$\nThis simplifies to $\\frac{-2j \\sin(\\tilde{k}_y\\Delta/2)}{\\Delta} E_{z0} = -\\mu_0 \\frac{2j \\sin(\\omega\\Delta t/2)}{\\Delta t} H_{x0}$, which gives $H_{x0} = \\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(\\tilde{k}_y\\Delta/2)}{\\sin(\\omega\\Delta t/2)} E_{z0}$.\nFrom the $H_y$ update equation:\n$$E_{z0} \\frac{e^{-j\\tilde{k}_x\\Delta} - 1}{\\Delta} = \\mu_0 H_{y0} \\frac{e^{j\\omega\\Delta t/2} - e^{-j\\omega\\Delta t/2}}{\\Delta t} e^{j\\omega\\Delta t/2} e^{j\\tilde{k}_x\\Delta/2}$$\nThis simplifies to $\\frac{-2j \\sin(\\tilde{k}_x\\Delta/2)}{\\Delta} E_{z0} = \\mu_0 \\frac{2j \\sin(\\omega\\Delta t/2)}{\\Delta t} H_{y0}$, which gives $H_{y0} = -\\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(\\tilde{k}_x\\Delta/2)}{\\sin(\\omega\\Delta t/2)} E_{z0}$.\nSubstituting these expressions for $H_{x0}$ and $H_{y0}$ into the equation derived from the $E_z$ update:\n$$ H_{y0}\\frac{-2j\\sin(\\tilde{k}_x\\Delta/2)}{\\Delta} - H_{x0}\\frac{-2j\\sin(\\tilde{k}_y\\Delta/2)}{\\Delta} = \\epsilon_0 E_{z0} \\frac{2j\\sin(\\omega\\Delta t/2)}{\\Delta t} $$\nThis gives:\n$$ \\left( -\\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(\\tilde{k}_x\\Delta/2)}{\\sin(\\omega\\Delta t/2)} \\right) \\frac{-\\sin(\\tilde{k}_x\\Delta/2)}{\\Delta} + \\left( \\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(\\tilde{k}_y\\Delta/2)}{\\sin(\\omega\\Delta t/2)} \\right) \\frac{\\sin(\\tilde{k}_y\\Delta/2)}{\\Delta} = \\frac{\\epsilon_0}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\nMultiplying through and simplifying, using $c^2 = 1/(\\mu_0\\epsilon_0)$ and $S=c\\Delta t/\\Delta$:\n$$ \\frac{\\Delta t}{\\mu_0\\Delta^2\\sin(\\omega\\Delta t/2)} \\left( \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) \\right) = \\frac{\\epsilon_0}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n$$ (\\Delta t)^2 \\left( \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) \\right) = \\mu_0\\epsilon_0 \\Delta^2 \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n$$ \\left(\\frac{c\\Delta t}{\\Delta}\\right)^2 \\left( \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) \\right) = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\nFinally, the numerical dispersion relation is:\n$$ S^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\nNow, we specialize to the given parameters:\n- $S = 1/\\sqrt{2}$, so $S^2 = 1/2$.\n- The continuous drive frequency is $\\omega = ck = c(\\pi/\\Delta)$.\n- The phase advance per time step is $\\omega\\Delta t = (c\\pi/\\Delta)\\Delta t = \\pi (c\\Delta t/\\Delta) = \\pi S = \\pi/\\sqrt{2}$.\n- From Part 1, the injected numerical transverse wavenumber is $\\tilde{k}_y = k_y = \\pi/(\\sqrt{2}\\Delta)$.\n- The phase advance per spatial step in $y$ is $\\tilde{k}_y\\Delta = \\pi/\\sqrt{2}$.\n\nSubstituting these into the dispersion relation to solve for the numerical wavenumber component $\\tilde{k}_x$:\n$$ \\frac{1}{2} \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{(\\pi/\\sqrt{2}\\Delta)\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\pi/\\sqrt{2}}{2}\\right) $$\n$$ \\frac{1}{2} \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\pi}{2\\sqrt{2}}\\right) \\right] = \\sin^2\\left(\\frac{\\pi}{2\\sqrt{2}}\\right) $$\n$$ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\pi}{2\\sqrt{2}}\\right) = 2\\sin^2\\left(\\frac{\\pi}{2\\sqrt{2}}\\right) $$\n$$ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) = \\sin^2\\left(\\frac{\\pi}{2\\sqrt{2}}\\right) $$\nAssuming the wave propagates in the $+x$ direction, we take the positive root, yielding $\\sin(\\tilde{k}_x\\Delta/2) = \\sin(\\pi/(2\\sqrt{2}))$. The principal solution is $\\tilde{k}_x\\Delta/2 = \\pi/(2\\sqrt{2})$, which gives $\\tilde{k}_x = \\pi/(\\sqrt{2}\\Delta)$.\n\nNow we compute the magnitude of the numerical wavevector, $|\\mathbf{\\tilde{k}}|$:\n$$ |\\mathbf{\\tilde{k}}| = \\sqrt{\\tilde{k}_x^2 + \\tilde{k}_y^2} = \\sqrt{\\left(\\frac{\\pi}{\\sqrt{2}\\Delta}\\right)^2 + \\left(\\frac{\\pi}{\\sqrt{2}\\Delta}\\right)^2} = \\sqrt{\\frac{\\pi^2}{2\\Delta^2} + \\frac{\\pi^2}{2\\Delta^2}} = \\sqrt{\\frac{2\\pi^2}{2\\Delta^2}} = \\frac{\\pi}{\\Delta} $$\nThe numerical phase velocity $v_p$ is defined as $v_p = \\omega/|\\mathbf{\\tilde{k}}|$.\n$$ v_p = \\frac{\\omega}{|\\mathbf{\\tilde{k}}|} = \\frac{c\\pi/\\Delta}{\\pi/\\Delta} = c $$\nThe normalized numerical phase velocity is therefore:\n$$ \\frac{v_p}{c} = 1 $$",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}