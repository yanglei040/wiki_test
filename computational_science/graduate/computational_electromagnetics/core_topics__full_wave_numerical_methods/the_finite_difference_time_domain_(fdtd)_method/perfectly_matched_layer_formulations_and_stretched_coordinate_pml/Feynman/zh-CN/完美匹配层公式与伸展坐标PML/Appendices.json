{
    "hands_on_practices": [
        {
            "introduction": "本练习将 stretched-coordinate PML (SC-PML) 的连续理论与其在计算中的离散实现直接联系起来。通过计算电磁波穿过一个分级PML的每个离散单元时所经历的衰减，您将对吸收层如何逐步吸收能量获得一个具体而直观的理解。这是在任何仿真中构建和验证PML的一项基本技能。",
            "id": "3339137",
            "problem": "考虑一个由拉伸坐标完美匹配层 (Stretched-Coordinate Perfectly Matched Layer, SC-PML) 在自由空间中实现的一维吸收边界。一个法向入射的平面波沿 $x$ 轴传播，进入占据 $0 \\le x \\le L$ 的 SC-PML 区域。沿 $x$ 方向的坐标拉伸由 $s_x(x)$ 定义，其中 $\\kappa_x=1$ 且无低频阻尼参数，因此唯一可变的剖面是电导率 $\\sigma(x)$。要实现的 SC-PML 剖面按 $\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m$ 进行分级，其中 $x \\in [0,L]$ 且阶数 $m \\ge 0$ 为整数。自由空间参数为 $\\mu_0$ 和 $\\varepsilon_0$。\n\n从频域中的麦克斯韦方程组和 SC-PML 复坐标拉伸出发，推导一个法向入射的均匀平面波在穿过 SC-PML 内一个厚度为 $\\Delta x$ 的离散单元时所经历的衰减因子幅度表达式。然后，使用该表达式，在一个包含 $N$ 个宽度为 $\\Delta x = L/N$ 的均匀单元的离散方案中实现分级剖面，其中第 $i$ 个单元的范围为 $\\left[x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}\\right] = \\left[\\left(i-1\\right)\\Delta x, i\\,\\Delta x\\right]$，对于 $i=1,2,\\dots,N$。您的程序必须为每个单元计算波幅在穿过该单元时所经历的衰减因子幅度（一个介于 $0$ 和 $1$ 之间的无量纲数），并以浮点数形式表示。假设处处为法向入射和自由空间。\n\n您在推导中必须使用的基本依据：\n- 无源、线性、均匀介质中频域的麦克斯韦方程组，以及 SC-PML 复坐标拉伸的定义。\n- 均匀介质中的平面波解及其在复坐标拉伸下的修正。\n\n要使用和报告的物理常数和单位：\n- 使用 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H/m}$ 和 $\\varepsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$。\n- 频率 $f$ 以 $\\mathrm{Hz}$ 为单位；角频率为 $\\omega = 2\\pi f$。\n- 长度 $L$ 和 $\\Delta x$ 以 $\\mathrm{m}$ 为单位。\n- 电导率 $\\sigma_{\\max}$ 以 $\\mathrm{S/m}$ 为单位。\n- 衰减因子幅度是无单位的浮点数。\n\n实现离散分级剖面 $\\sigma(x)=\\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m$ 并为以下测试套件计算每个单元的衰减因子幅度。对于每个测试用例，计算一个长度为 $N$ 的列表，其中按顺序包含单元 $i=1,2,\\dots,N$ 的衰减因子幅度。\n\n测试套件参数集 $(f, L, N, \\sigma_{\\max}, m)$:\n1. $(f = 2\\times 10^9, L = 2.0\\times 10^{-2}, N = 8, \\sigma_{\\max} = 9.781, m = 3)$\n2. $(f = 1.0\\times 10^9, L = 5.0\\times 10^{-3}, N = 1, \\sigma_{\\max} = 100.0, m = 1)$\n3. $(f = 5.0\\times 10^9, L = 1.0\\times 10^{-2}, N = 5, \\sigma_{\\max} = 50.0, m = 2)$\n4. $(f = 5.0\\times 10^8, L = 1.0\\times 10^{-2}, N = 5, \\sigma_{\\max} = 50.0, m = 2)$\n5. $(f = 3.0\\times 10^9, L = 1.0\\times 10^{-2}, N = 4, \\sigma_{\\max} = 25.0, m = 0)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身都是对应一个测试用例的浮点数列表，例如 $[[a_{1},a_{2},\\dots,a_{N_1}],[b_{1},\\dots],[\\dots]]$ 的形式，不要求有空格。最终输出必须是只包含此括号表示法的单行。角度单位不适用。任何地方都不得使用百分比；所有报告的量均为浮点数或浮点数列表。",
            "solution": "该问题要求推导并实现平面波在穿过拉伸坐标完美匹配层 (SC-PML) 内一个离散单元时的衰减因子。推导从无源、线性、均匀介质中的频域麦克斯韦方程组开始，假设时谐约定为 $e^{j\\omega t}$：\n$$ \\nabla \\times \\vec{E} = -j\\omega\\mu_0 \\vec{H} $$\n$$ \\nabla \\times \\vec{H} = j\\omega\\varepsilon_0 \\vec{E} $$\n\n对于一个偏振为 $\\vec{E} = E_y(x)\\hat{y}$ 和 $\\vec{H} = H_z(x)\\hat{z}$、沿 $x$ 轴传播的平面波，这些方程简化为：\n$$ \\frac{\\partial E_y}{\\partial x} = -j\\omega\\mu_0 H_z $$\n$$ \\frac{\\partial H_z}{\\partial x} = -j\\omega\\varepsilon_0 E_y $$\n\nSC-PML 是通过在传播方向上的复坐标拉伸引入的。在频域中，算子 $\\frac{\\partial}{\\partial x}$ 被替换为 $\\frac{1}{s_x(x)}\\frac{\\partial}{\\partial x}$。根据问题陈述，拉伸因子 $s_x(x)$ 定义为：\n$$ s_x(x) = \\kappa_x + \\frac{\\sigma(x)}{j\\omega\\varepsilon_0} $$\n根据给定的参数 $\\kappa_x=1$ 和电导率剖面 $\\sigma(x)$，这变为：\n$$ s_x(x) = 1 + \\frac{\\sigma(x)}{j\\omega\\varepsilon_0} $$\n\n将此变换应用于麦克斯韦方程组，得到 PML 内部的修正方程：\n$$ \\frac{1}{s_x(x)} \\frac{\\partial E_y}{\\partial x} = -j\\omega\\mu_0 H_z \\implies \\frac{\\partial E_y}{\\partial x} = -j\\omega\\mu_0 s_x(x) H_z $$\n$$ \\frac{1}{s_x(x)} \\frac{\\partial H_z}{\\partial x} = -j\\omega\\varepsilon_0 E_y \\implies \\frac{\\partial H_z}{\\partial x} = -j\\omega\\varepsilon_0 s_x(x) E_y $$\n这些方程等效于波在具有有效介电常数 $\\varepsilon_{\\text{eff}}(x) = \\varepsilon_0 s_x(x)$ 和有效磁导率 $\\mu_{\\text{eff}}(x) = \\mu_0 s_x(x)$ 的介质中的传播。局部波阻抗为 $Z(x) = \\sqrt{\\frac{\\mu_{\\text{eff}}(x)}{\\varepsilon_{\\text{eff}}(x)}} = \\sqrt{\\frac{\\mu_0 s_x(x)}{\\varepsilon_0 s_x(x)}} = \\sqrt{\\frac{\\mu_0}{\\varepsilon_0}} = \\eta_0$，即自由空间的本征阻抗。对于 $\\sigma(0)=0$ 的连续剖面，这种阻抗匹配确保了在 PML 界面处没有反射。\n\nPML 介质中的局部波数由下式给出：\n$$ k_{\\text{pml}}(x) = \\omega \\sqrt{\\mu_{\\text{eff}}(x) \\varepsilon_{\\text{eff}}(x)} = \\omega \\sqrt{(\\mu_0 s_x(x))(\\varepsilon_0 s_x(x))} = \\omega\\sqrt{\\mu_0\\varepsilon_0} s_x(x) = k_0 s_x(x) $$\n其中 $k_0 = \\omega\\sqrt{\\mu_0\\varepsilon_0}$ 是自由空间波数。\n\n一个从 $x_1$ 传播到 $x_2$ 的平面波累积的相位因子为 $\\exp\\left(-j \\int_{x_1}^{x_2} k_{\\text{pml}}(x') dx'\\right)$。指数的参数是：\n$$ -j \\int_{x_1}^{x_2} k_0 s_x(x') dx' = -j \\int_{x_1}^{x_2} k_0 \\left(1 + \\frac{\\sigma(x')}{j\\omega\\varepsilon_0}\\right) dx' $$\n$$ = -j k_0 \\int_{x_1}^{x_2} dx' - \\frac{k_0}{\\omega\\varepsilon_0} \\int_{x_1}^{x_2} \\sigma(x') dx' $$\n第一项 $-j k_0 (x_2-x_1)$ 是纯虚数，代表相位旋转。第二项是纯实数，代表衰减。传播因子的幅度由这个实数项决定。我们来计算常数因子：\n$$ \\frac{k_0}{\\omega\\varepsilon_0} = \\frac{\\omega\\sqrt{\\mu_0\\varepsilon_0}}{\\omega\\varepsilon_0} = \\sqrt{\\frac{\\mu_0}{\\varepsilon_0}} = \\eta_0 $$\n因此，波穿过区域从 $x_1$ 到 $x_2$ 的衰减因子幅度 $A$ 为：\n$$ A = \\exp\\left(-\\eta_0 \\int_{x_1}^{x_2} \\sigma(x') dx'\\right) $$\n值得注意的是，这个表达式与波的频率 $f$ 无关。\n\n问题要求计算每个离散单元 $i$ 的这个因子，其范围为 $[(i-1)\\Delta x, i\\Delta x]$，其中 $\\Delta x = L/N$。单元 $i$ 的衰减因子记为 $A_i$：\n$$ A_i = \\exp\\left(-\\eta_0 \\int_{(i-1)\\Delta x}^{i\\Delta x} \\sigma(x') dx'\\right) $$\n电导率剖面为 $\\sigma(x) = \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m$。我们现在必须计算第 $i$ 个单元的积分。\n$$ \\int_{(i-1)\\Delta x}^{i\\Delta x} \\sigma_{\\max}\\left(\\frac{x'}{L}\\right)^m dx' = \\frac{\\sigma_{\\max}}{L^m} \\int_{(i-1)\\Delta x}^{i\\Delta x} (x')^m dx' $$\n对于 $m \\ge 0$，积分为：\n$$ \\frac{\\sigma_{\\max}}{L^m} \\left[\\frac{(x')^{m+1}}{m+1}\\right]_{(i-1)\\Delta x}^{i\\Delta x} = \\frac{\\sigma_{\\max}}{L^m(m+1)} \\left[ (i\\Delta x)^{m+1} - ((i-1)\\Delta x)^{m+1} \\right] $$\n代入 $\\Delta x = L/N$，我们得到：\n$$ \\frac{\\sigma_{\\max}}{L^m(m+1)} \\frac{L^{m+1}}{N^{m+1}} \\left[ i^{m+1} - (i-1)^{m+1} \\right] = \\frac{\\sigma_{\\max} L}{(m+1)N^{m+1}} \\left[ i^{m+1} - (i-1)^{m+1} \\right] $$\n这个表达式表示了单元 $i$ 上的积分电导率。我们称这个积分为 $I_i$。\n单元 $i$ 的衰减因子幅度的最终表达式为：\n$$ A_i = \\exp\\left(-\\eta_0 I_i\\right) = \\exp\\left(-\\eta_0 \\frac{\\sigma_{\\max} L}{(m+1)N^{m+1}} \\left( i^{m+1} - (i-1)^{m+1} \\right)\\right) $$\n这是要为每个单元 $i=1, 2, \\dots, N$ 实现的公式。对于 $m=0$ 的特殊情况，剖面是常数 $\\sigma(x) = \\sigma_{\\max}$，积分简化为 $I_i = \\sigma_{\\max}\\Delta x = \\sigma_{\\max}L/N$。我们的通用公式对于 $m=0$ 得出：$I_i = \\frac{\\sigma_{\\max}L}{(1)N^1}(i^1 - (i-1)^1) = \\frac{\\sigma_{\\max}L}{N}$，这是一致的。\n实现将为每个测试用例中的每个单元计算这个值 $A_i$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the per-cell attenuation factor magnitude for a plane wave in an SC-PML.\n    \"\"\"\n    # Define physical constants\n    MU_0 = 4 * np.pi * 1e-7  # Permeability of free space (H/m)\n    EPSILON_0 = 8.854187817e-12  # Permittivity of free space (F/m)\n    ETA_0 = np.sqrt(MU_0 / EPSILON_0)  # Intrinsic impedance of free space (Ohms)\n\n    # Test suite parameter sets: (f, L, N, sigma_max, m)\n    test_cases = [\n        (2e9, 2.0e-2, 8, 9.781, 3),\n        (1.0e9, 5.0e-3, 1, 100.0, 1),\n        (5.0e9, 1.0e-2, 5, 50.0, 2),\n        (5.0e8, 1.0e-2, 5, 50.0, 2),\n        (3.0e9, 1.0e-2, 4, 25.0, 0),\n    ]\n\n    all_results = []\n    \n    for _, L, N, sigma_max, m in test_cases:\n        case_results = []\n        m_plus_1 = m + 1\n        \n        # Pre-compute the constant factor for the conductivity integral.\n        # The integral over cell i is: factor * (i^(m+1) - (i-1)^(m+1))\n        # Note: per the problem, m >= 0, so m+1 is always >= 1.\n        integral_const_factor = (sigma_max * L) / (m_plus_1 * (N ** m_plus_1))\n\n        for i in range(1, N + 1):\n            # Calculate the integrated conductivity over the i-th cell\n            integral_sigma = integral_const_factor * (i**m_plus_1 - (i - 1)**m_plus_1)\n            \n            # Calculate the attenuation factor magnitude\n            # A_i = exp(-eta_0 * integral_sigma)\n            attenuation_factor = np.exp(-ETA_0 * integral_sigma)\n            case_results.append(attenuation_factor)\n            \n        all_results.append(case_results)\n\n    # Format the output string to be a dense list of lists of floats.\n    # e.g., [[0.1,0.2],[0.3,0.4]]\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "理想的PML能够完美吸收电磁波，但其数值实现有时却可能导致非物理性的能量增长，这种现象被称为“后期不稳定性”(late-time instability)。本练习将深入探讨这一关键问题，分析网格的各向异性如何触发不稳定性，并探索如何通过特定的数值技术（如交错拉伸采样或频谱滤波）来恢复稳定性。掌握这种分析对于开发稳健可靠的FDTD代码至关重要。",
            "id": "3339149",
            "problem": "考虑一个二维横电（$\\mathrm{TE}_z$）极化的麦克斯韦真空系统，该系统在均匀的Yee网格上离散化，空间步长为 $\\,\\Delta x\\,$ 和 $\\,\\Delta y\\,$，时间步长为 $\\,\\Delta t\\,$。令介电常数和磁导率归一化为 $\\,\\varepsilon = 1\\,$ 和 $\\,\\mu = 1\\,$，因此在这些单位中光速为 $\\,c = 1\\,$。使用拉伸坐标法应用完美匹配层，其中每个空间方向的坐标拉伸由复数拉伸系数 $\\,s_x\\,$ 和 $\\,s_y\\,$ 表示。包含拉伸坐标完美匹配层（SC-PML）耦合的 $\\mathrm{TE}_z$ 方程的半离散形式（无显式物理电导率项）按蛙跳格式构建如下：磁场分量 $\\,H_x\\,$ 和 $\\,H_y\\,$ 在半整数时间步长上通过与整数时间步长上的电场 $\\,E_z\\,$ 耦合进行更新，而电场则由随后的半步长上的磁场更新。\n\n定义平面波模式的离散波数为\n$$S_x(\\theta_x) = \\frac{2}{\\Delta x} \\sin(\\theta_x), \\qquad S_y(\\theta_y) = \\frac{2}{\\Delta y} \\sin(\\theta_y),$$\n其中 $\\,\\theta_x \\in [0,\\pi]\\,$ 和 $\\,\\theta_y \\in [0,\\pi]\\,$ 代表冯·诺伊曼模态分析的布里渊区参数。一个时间步长 $\\,\\Delta t\\,$ 的显式蛙跳更新可以写成一个线性映射\n$$\\mathbf{u}^{n+1} = \\mathbf{U}(\\theta_x,\\theta_y)\\,\\mathbf{u}^{n},$$\n其中 $\\,\\mathbf{u}^{n} = \\big[H_x^{n-\\frac{1}{2}},\\,H_y^{n-\\frac{1}{2}},\\,E_z^{n}\\big]^\\top\\,$，而 $\\,\\mathbf{U}(\\theta_x,\\theta_y)\\,$ 取决于拉伸系数在交错网格上的采样方式。在“朴素”采样中，处处使用相同的 $\\,s_x\\,$ 和 $\\,s_y\\,$。在“交错拉伸”采样中，电场更新使用有效的耦合，其中包含考虑空间交错的因子，因此 $\\,E_z\\,$ 更新使用\n$$\\frac{S_x(\\theta_x)}{s_x}\\cos\\left(\\theta_y\\right) \\quad \\text{and} \\quad \\frac{S_y(\\theta_y)}{s_y}\\cos\\left(\\theta_x\\right)$$\n来代替 $\\,S_x(\\theta_x)/s_x\\,$ 和 $\\,S_y(\\theta_y)/s_y\\,$。最后，考虑一个可选的谱高频滤波器，它将模态更新乘以一个标量因子\n$$g(\\theta_x,\\theta_y) = 1 - \\beta\\left[\\sin^4\\left(\\theta_x\\right) + \\sin^4\\left(\\theta_y\\right)\\right],$$\n其中 $\\,\\beta \\ge 0\\,$，该因子均匀地应用于更新后的状态，以阻尼网格尺度的各向异性模式。\n\n从麦克斯韦方程组和Yee网格蛙跳离散化出发，为真空中有SC-PML耦合的$\\mathrm{TE}_z$模式构建显式的 $\\,3\\times 3\\,$ 更新矩阵 $\\,\\mathbf{U}(\\theta_x,\\theta_y)\\,$，同时涵盖朴素采样和交错拉伸采样两种情况。使用离散的冯·诺伊曼分析，定义模态谱半径\n$$\\rho_{\\max} = \\max_{\\theta_x \\in [0,\\pi],\\,\\theta_y \\in [0,\\pi]} \\rho\\left(\\mathbf{U}(\\theta_x,\\theta_y)\\right),$$\n其中 $\\,\\rho(\\cdot)\\,$ 表示谱半径（特征值的最大绝对值）。对于滤波情况，有效的更新矩阵为 $\\,\\mathbf{U}_\\mathrm{filt}(\\theta_x,\\theta_y) = g(\\theta_x,\\theta_y)\\,\\mathbf{U}(\\theta_x,\\theta_y)\\,$，其谱半径的计算方式类似。如果 $\\rho_{\\max} > 1$，则认为该方案存在数值不稳定性。\n\n您的任务是：\n\n- 从第一性原理出发，从麦克斯韦旋度方程和Yee蛙跳格式开始，推导 $\\,\\mathbf{U}(\\theta_x,\\theta_y)\\,$ 的显式形式，展示 $\\,S_x(\\theta_x)\\,$、$\\,S_y(\\theta_y)\\,$ 和 $\\,s_x, s_y\\,$ 如何进入耦合项。\n- 解释对于朴素采样，在固定的 $\\,\\Delta t\\,$ 下，网格各向异性（即 $\\,\\Delta x \\ne \\Delta y\\,$）如何导致 $\\,\\rho_{\\max} \\ge 1\\,$，以及交错拉伸采样或谱滤波器如何能恢复 $\\,\\rho_{\\max}  1\\,$。\n\n我们在整个过程中采用归一化的无量纲单位（输出中不需要物理单位）。实现一个程序，通过在 $[0,\\pi]$ 上扫描 $\\,\\theta_x\\,$ 和 $\\,\\theta_y\\,$ 值的均匀网格，为以下每个测试用例计算 $\\,\\rho_{\\max}\\,$：\n\n- 测试用例1（理想情况）：各向同性网格，朴素SC-PML采样。参数：$\\,\\Delta x = 1\\,$, $\\,\\Delta y = 1\\,$, $\\,\\Delta t = 0.5\\,$, $\\,s_x = 1 + 0.1\\,\\mathrm{i}\\,$, $\\,s_y = 1 + 0.1\\,\\mathrm{i}\\,$, 无滤波器（$\\,\\beta = 0\\,$）。\n- 测试用例2（各向异性压力）：各向异性网格，朴素SC-PML采样。参数：$\\,\\Delta x = 0.2\\,$, $\\,\\Delta y = 1\\,$, $\\,\\Delta t = 0.5\\,$, $\\,s_x = 1 + 0.1\\,\\mathrm{i}\\,$, $\\,s_y = 1 + 0.1\\,\\mathrm{i}\\,$, 无滤波器（$\\,\\beta = 0\\,$）。\n- 测试用例3（交错拉伸补救）：各向异性网格，采用交错拉伸SC-PML采样。参数：与测试用例2相同，但在 $\\,E_z\\,$ 更新中使用如上所述的交错拉伸耦合，无滤波器（$\\,\\beta = 0\\,$）。\n- 测试用例4（谱滤波器补救）：各向异性网格，朴素SC-PML采样，带滤波器。参数：与测试用例2相同，但应用谱滤波器，$\\,\\beta = 0.9\\,$。\n\n对于每个测试用例，将 $\\,\\rho_{\\max}\\,$ 计算为浮点数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4]”），每个结果是按上述顺序列出的测试用例对应的 $\\,\\rho_{\\max}\\,$。不需要外部输入，程序必须是自包含的，并且可以直接运行。解决方案必须仅依赖于指定的运行时环境和库。",
            "solution": "用户希望分析带有拉伸坐标完美匹配层（SC-PML）的二维FDTD方案对TEz波的稳定性。这包括：\n1. 从第一性原理推导 $3 \\times 3$ 的模态更新矩阵 $\\mathbf{U}(\\theta_x, \\theta_y)$。\n2. 解释数值不稳定性的来源以及所提出的补救措施的机理。\n3. 实现一个程序，为四个特定的测试用例计算最大谱半径 $\\rho_{\\max}$。\n\n### 第一部分：更新矩阵的推导\n\n我们从二维无源介质中横电（$\\mathrm{TE}_z$）波的麦克斯韦方程组开始，并结合拉伸坐标PML公式。场分量为 $E_z$、$H_x$ 和 $H_y$。控制方程为：\n$$\n\\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu s_y} \\frac{\\partial E_z}{\\partial y}\n$$\n$$\n\\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu s_x} \\frac{\\partial E_z}{\\partial x}\n$$\n$$\n\\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon s_x} \\frac{\\partial H_y}{\\partial x} - \\frac{1}{\\varepsilon s_y} \\frac{\\partial H_x}{\\partial y}\n$$\n在问题中，我们使用归一化单位，其中 $\\varepsilon=1$ 和 $\\mu=1$。复数拉伸系数为 $s_x$ 和 $s_y$。我们使用时间步长为 $\\Delta t$ 的Yee网格上的蛙跳时间步进方案对这些方程进行离散化：\n$$\n\\frac{H_x^{n+1/2} - H_x^{n-1/2}}{\\Delta t} = - \\frac{1}{s_y} \\left( \\frac{\\partial E_z}{\\partial y} \\right)^n\n$$\n$$\n\\frac{H_y^{n+1/2} - H_y^{n-1/2}}{\\Delta t} = \\frac{1}{s_x} \\left( \\frac{\\partial E_z}{\\partial x} \\right)^n\n$$\n$$\n\\frac{E_z^{n+1} - E_z^n}{\\Delta t} = \\frac{1}{s_x} \\left( \\frac{\\partial H_y}{\\partial x} \\right)^{n+1/2} - \\frac{1}{s_y} \\left( \\frac{\\partial H_x}{\\partial y} \\right)^{n+1/2}\n$$\n为了进行冯·诺伊曼稳定性分析，我们假设平面波解的形式为 $F(j\\Delta x, l\\Delta y, n\\Delta t) = \\tilde{F} e^{i(k_x j \\Delta x + k_y l \\Delta y)}$，其中 $\\tilde{F}$ 是模态振幅。空间导数算子作用于这些模式时，会变成与复数因子的乘法。问题将这些因子的大小定义为 $S_x(\\theta_x) = \\frac{2}{\\Delta x} \\sin(\\theta_x)$ 和 $S_y(\\theta_y) = \\frac{2}{\\Delta y} \\sin(\\theta_y)$，其中 $\\theta_x = k_x \\Delta x$ 和 $\\theta_y = k_y \\Delta y$。Yee网格上的中心有限差分算子对应于乘以 $iS_x$ 和 $iS_y$。请注意，$S_x$ 和 $S_y$ 的这些定义对于Yee网格FDTD来说是非标准的（通常会涉及 $\\sin(\\theta/2)$），但我们必须遵循问题陈述。\n\n模态（傅里叶）域中的离散化方程变为：\n$$\n\\tilde{H}_x^{n+1/2} = \\tilde{H}_x^{n-1/2} - \\frac{i \\Delta t S_y}{s_y} \\tilde{E}_z^n\n$$\n$$\n\\tilde{H}_y^{n+1/2} = \\tilde{H}_y^{n-1/2} + \\frac{i \\Delta t S_x}{s_x} \\tilde{E}_z^n\n$$\n$$\n\\tilde{E}_z^{n+1} = \\tilde{E}_z^n + \\frac{i \\Delta t S_x}{s_x} \\tilde{H}_y^{n+1/2} - \\frac{i \\Delta t S_y}{s_y} \\tilde{H}_x^{n+1/2}\n$$\n状态向量定义为 $\\mathbf{u}^n = [\\tilde{H}_x^{n-1/2}, \\tilde{H}_y^{n-1/2}, \\tilde{E}_z^n]^\\top$。我们寻求更新矩阵 $\\mathbf{U}$，使得 $\\mathbf{u}^{n+1} = \\mathbf{U} \\mathbf{u}^n$，其中 $\\mathbf{u}^{n+1} = [\\tilde{H}_x^{n+1/2}, \\tilde{H}_y^{n+1/2}, \\tilde{E}_z^{n+1}]^\\top$。\n\n$\\mathbf{U}$ 的前两行可以直接从 $H$ 场更新中写出。对于第三行，我们将 $\\tilde{H}_x^{n+1/2}$ 和 $\\tilde{H}_y^{n+1/2}$ 的表达式代入 $\\tilde{E}_z$ 更新方程：\n$$\n\\tilde{E}_z^{n+1} = \\tilde{E}_z^n + \\frac{i \\Delta t S_x}{s_x} \\left(\\tilde{H}_y^{n-1/2} + \\frac{i \\Delta t S_x}{s_x} \\tilde{E}_z^n\\right) - \\frac{i \\Delta t S_y}{s_y} \\left(\\tilde{H}_x^{n-1/2} - \\frac{i \\Delta t S_y}{s_y} \\tilde{E}_z^n\\right)\n$$\n按 $\\mathbf{u}^n$ 的分量对各项进行分组：\n$$\n\\tilde{E}_z^{n+1} = \\left(-\\frac{i \\Delta t S_y}{s_y}\\right) \\tilde{H}_x^{n-1/2} + \\left(\\frac{i \\Delta t S_x}{s_x}\\right) \\tilde{H}_y^{n-1/2} + \\left(1 - (\\Delta t)^2\\left[\\frac{S_x^2}{s_x^2} + \\frac{S_y^2}{s_y^2}\\right]\\right) \\tilde{E}_z^n\n$$\n\n#### 朴素采样\n对于朴素采样，上述推导直接成立。更新矩阵 $\\mathbf{U}_{\\text{naive}}$ 为：\n$$\n\\mathbf{U}_{\\text{naive}} = \n\\begin{pmatrix}\n1  0  -\\frac{i \\Delta t S_y}{s_y} \\\\\n0  1  \\frac{i \\Delta t S_x}{s_x} \\\\\n-\\frac{i \\Delta t S_y}{s_y}  \\frac{i \\Delta t S_x}{s_x}  1 - (\\Delta t)^2\\left(\\frac{S_x^2}{s_x^2} + \\frac{S_y^2}{s_y^2}\\right)\n\\end{pmatrix}\n$$\n该矩阵是对称的。\n\n#### 交错拉伸采样\n在此方案中，$H$ 场更新保持不变，但 $E_z$ 更新的耦合项按指定方式修改：$\\frac{S_x}{s_x} \\to \\frac{S_x \\cos(\\theta_y)}{s_x}$ 和 $\\frac{S_y}{s_y} \\to \\frac{S_y \\cos(\\theta_x)}{s_y}$。仅将这些替换应用于初始的 $E_z$ 更新方程：\n$$\n\\tilde{E}_z^{n+1} = \\tilde{E}_z^n + \\frac{i \\Delta t S_x \\cos(\\theta_y)}{s_x} \\tilde{H}_y^{n+1/2} - \\frac{i \\Delta t S_y \\cos(\\theta_x)}{s_y} \\tilde{H}_x^{n+1/2}\n$$\n我们将未修改的 $H$ 场更新代入这个修改后的 $E_z$ 更新中：\n$$\n\\tilde{E}_z^{n+1} = \\tilde{E}_z^n + \\frac{i \\Delta t S_x \\cos(\\theta_y)}{s_x} \\left(\\tilde{H}_y^{n-1/2} + \\frac{i \\Delta t S_x}{s_x} \\tilde{E}_z^n\\right) - \\frac{i \\Delta t S_y \\cos(\\theta_x)}{s_y} \\left(\\tilde{H}_x^{n-1/2} - \\frac{i \\Delta t S_y}{s_y} \\tilde{E}_z^n\\right)\n$$\n$\\tilde{E}_z^n$ 的系数变为 $1 - (\\Delta t)^2\\left(\\frac{S_x^2 \\cos(\\theta_y)}{s_x^2} + \\frac{S_y^2 \\cos(\\theta_x)}{s_y^2}\\right)$。$H$ 场的系数也发生变化。得到的更新矩阵 $\\mathbf{U}_{\\text{stag}}$ 为：\n$$\n\\mathbf{U}_{\\text{stag}} = \n\\begin{pmatrix}\n1  0  -\\frac{i \\Delta t S_y}{s_y} \\\\\n0  1  \\frac{i \\Delta t S_x}{s_x} \\\\\n-\\frac{i \\Delta t S_y \\cos(\\theta_x)}{s_y}  \\frac{i \\Delta t S_x \\cos(\\theta_y)}{s_x}  1 - (\\Delta t)^2\\left(\\frac{S_x^2 \\cos(\\theta_y)}{s_x^2} + \\frac{S_y^2 \\cos(\\theta_x)}{s_y^2}\\right)\n\\end{pmatrix}\n$$\n由于 $\\cos(\\theta_x)$ 和 $\\cos(\\theta_y)$ 因子仅出现在第三行，该矩阵不是对称的。\n\n### 第二部分：不稳定性与补救措施\n\n该方案的稳定性由更新矩阵的谱半径 $\\rho(\\mathbf{U}) = \\max_i |\\lambda_i|$ 决定。如果对于任何模式 $(\\theta_x, \\theta_y)$ 有 $\\rho(\\mathbf{U})  1$，则该方案不稳定。$\\mathbf{U}_{\\text{naive}}$ 的特征值 $\\lambda$ 是特征多项式的根。一个特征值总是 $\\lambda=1$，对应于静电场模式。另外两个特征值是二次方程的根：\n$$\n\\lambda^2 - (2 - \\Omega^2)\\lambda + 1 = 0, \\quad \\text{where} \\quad \\Omega^2 = (\\Delta t)^2 \\left(\\frac{S_x^2}{s_x^2} + \\frac{S_y^2}{s_y^2}\\right)\n$$\n在没有PML（$s_x=s_y=1$）的情况下，$\\Omega^2$ 是实数且为正，稳定性条件（$|\\lambda|\\le 1$）简化为Courant-Friedrichs-Lewy（CFL）条件，$|\\Omega| \\le 2$。\n\n**各向异性引起的不稳定性**：当在各向异性网格（$\\Delta x \\neq \\Delta y$）上引入PML（$s_x, s_y$ 为复数）时，$\\Omega^2$ 项变为复数。空间各向异性意味着 $S_x \\propto 1/\\Delta x$ 和 $S_y \\propto 1/\\Delta y$ 的最大值可能非常不同。对于以特定角度传播的模式，特别是 $S_x$ 或 $S_y$ 较大的高频模式，离散化和PML之间的相互作用可能导致违反无源性，从而引起 $|\\lambda|1$。已知朴素采样方案容易受到此类不稳定性的影响，因为它没有在交错离散网格上正确模拟连续无源PML介质的行为。当一个波数分量大而另一个分量小时，不稳定性最为显著，这种情况会因网格各向异性而加剧。\n\n**交错拉伸补救措施**：规定的交错拉伸方案修改了 $E_z$ 更新中的耦合项。因子 $\\cos(\\theta_x)$ 和 $\\cos(\\theta_y)$ 起到阻尼作用。例如，考虑一个具有大 $\\theta_x \\approx \\pi/2$（$x$ 方向的高频分量）和小 $\\theta_y \\approx 0$（$y$ 方向的低频分量）的模式。朴素方案在这里可能不稳定。交错方案将 $S_y$ 项乘以 $\\cos(\\theta_x) \\approx 0$，并将 $S_x$ 项乘以 $\\cos(\\theta_y) \\approx 1$。这会有选择地阻尼某些相互作用，并可能通过改变问题模式的更新矩阵的特征值来恢复稳定性。尽管给出的公式不对应于标准的可证明稳定的方法（如CPML），但它旨在减轻大波数分量的影响。\n\n**谱滤波器补救措施**：该滤波器将一个乘法因子 $g(\\theta_x, \\theta_y) = 1 - \\beta(\\sin^4\\theta_x + \\sin^4\\theta_y)$ 应用于整个更新后的状态向量。有效谱半径变为 $\\rho_{\\text{filt}} = |g(\\theta_x,\\theta_y)|\\,\\rho(\\mathbf{U})$。当 $\\rho(\\mathbf{U})  1$ 时会发生不稳定性。如果在这些区域中 $|g|$ 足够小以迫使 $|g|\\rho(\\mathbf{U})  1$，则滤波器可以恢复稳定性。朴素PML中的不稳定性通常发生在高频模式。指定的滤波器在 $\\theta_x=\\pi/2$ 和 $\\theta_y=\\pi/2$ 处施加最大阻尼，此时 $\\sin\\theta_x, \\sin\\theta_y$ 最大，相应地 $S_x, S_y$ 也最大。通过减小这些问题模式的特征值的幅度，滤波器可以抑制数值增长并确保 $\\rho_{\\max} \\le 1$。",
            "answer": "```python\nimport numpy as np\n\ndef compute_rho_max(dx, dy, dt, sx, sy, beta, sampling_type):\n    \"\"\"\n    Computes the maximum spectral radius of the FDTD update matrix.\n\n    Args:\n        dx (float): Grid spacing in x.\n        dy (float): Grid spacing in y.\n        dt (float): Time step.\n        sx (complex): PML stretch coefficient in x.\n        sy (complex): PML stretch coefficient in y.\n        beta (float): Spectral filter coefficient.\n        sampling_type (str): 'naive' or 'staggered'.\n\n    Returns:\n        float: The maximum spectral radius over the Brillouin zone.\n    \"\"\"\n    # Create a grid for the Brillouin zone parameters theta_x, theta_y\n    # A 201x201 grid is a reasonable balance of accuracy and speed.\n    n_points = 201\n    theta_vals = np.linspace(0, np.pi, n_points)\n    thx_grid, thy_grid = np.meshgrid(theta_vals, theta_vals)\n\n    # Calculate discrete wavenumber magnitudes S_x and S_y\n    # Using the non-standard definition from the problem statement.\n    Sx = (2.0 / dx) * np.sin(thx_grid)\n    Sy = (2.0 / dy) * np.sin(thy_grid)\n\n    # Initialize the update matrix U\n    U = np.zeros((n_points, n_points, 3, 3), dtype=np.complex128)\n\n    # Fill the first two rows, common to both sampling schemes\n    U[:, :, 0, 0] = 1.0\n    U[:, :, 1, 1] = 1.0\n    U[:, :, 0, 2] = -1j * dt * Sy / sy\n    U[:, :, 1, 2] = 1j * dt * Sx / sx\n\n    # Fill the third row based on the sampling type\n    if sampling_type == 'naive':\n        U[:, :, 2, 0] = -1j * dt * Sy / sy\n        U[:, :, 2, 1] = 1j * dt * Sx / sx\n        U[:, :, 2, 2] = 1.0 - dt**2 * (Sx**2 / sx**2 + Sy**2 / sy**2)\n    elif sampling_type == 'staggered':\n        cos_thx = np.cos(thx_grid)\n        cos_thy = np.cos(thy_grid)\n        U[:, :, 2, 0] = -1j * dt * Sy * cos_thx / sy\n        U[:, :, 2, 1] = 1j * dt * Sx * cos_thy / sx\n        U[:, :, 2, 2] = 1.0 - dt**2 * (Sx**2 * cos_thy / sx**2 + Sy**2 * cos_thx / sy**2)\n\n    # Calculate eigenvalues for each point in the theta grid\n    # The numpy stacking and linalg.eigvals is vectorized for efficiency.\n    # U is (N, N, 3, 3), we reshape to (N*N, 3, 3) and then transpose\n    # for eigvals which expects the last two dimensions to be the matrices.\n    eigvals = np.linalg.eigvals(U.reshape(-1, 3, 3))\n\n    # Calculate the spectral radius for each mode\n    rho_grid = np.max(np.abs(eigvals), axis=1).reshape(n_points, n_points)\n\n    # Apply the spectral filter if beta  0\n    if beta  0:\n        g = 1.0 - beta * (np.sin(thx_grid)**4 + np.sin(thy_grid)**4)\n        rho_grid *= np.abs(g)\n\n    # Find the maximum spectral radius over all modes\n    max_rho = np.max(rho_grid)\n    \n    return max_rho\n\ndef solve():\n    \"\"\"\n    Solves the problem for the four specified test cases.\n    \"\"\"\n    test_cases = [\n        # TC1: Isotropic, naive\n        {'dx': 1.0, 'dy': 1.0, 'dt': 0.5, 'sx': 1 + 0.1j, 'sy': 1 + 0.1j, 'beta': 0.0, 'sampling_type': 'naive'},\n        # TC2: Anisotropic, naive\n        {'dx': 0.2, 'dy': 1.0, 'dt': 0.5, 'sx': 1 + 0.1j, 'sy': 1 + 0.1j, 'beta': 0.0, 'sampling_type': 'naive'},\n        # TC3: Anisotropic, staggered-stretch\n        {'dx': 0.2, 'dy': 1.0, 'dt': 0.5, 'sx': 1 + 0.1j, 'sy': 1 + 0.1j, 'beta': 0.0, 'sampling_type': 'staggered'},\n        # TC4: Anisotropic, naive, with filter\n        {'dx': 0.2, 'dy': 1.0, 'dt': 0.5, 'sx': 1 + 0.1j, 'sy': 1 + 0.1j, 'beta': 0.9, 'sampling_type': 'naive'}\n    ]\n\n    results = []\n    for case in test_cases:\n        rho_max = compute_rho_max(**case)\n        results.append(rho_max)\n    \n    # Format the final output as specified\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "PML的时域实现，即卷积PML (CPML)，涉及计算成本高昂的卷积运算，这会消耗大量的内存和计算时间。本练习探索了一种旨在提高计算效率的高级技术：用一个简单的递归滤波器来近似复杂的卷积核。您将运用最小二乘法优化来寻找最佳的单极点近似，从而深入理解现代FDTD方法中，在计算精度与效率之间进行权衡的艺术。",
            "id": "3339157",
            "problem": "在一个电容率为 $\\varepsilon$、磁导率为 $\\mu$ 的均匀、各向同性介质中，使用时域有限差分 (FDTD) 方案模拟了一维横电磁平面波。在 $x$ 边界上使用拉伸坐标 PML 实现了一个完美匹配层 (PML)，其中沿 $x$ 方向的本构导数通过复坐标拉伸 $s_x(\\omega) = \\kappa_x + \\frac{\\sigma_x}{\\alpha_x + j \\omega}$ 进行修改，其中 $\\kappa_x  0$，$\\sigma_x \\ge 0$ 和 $\\alpha_x \\ge 0$ 为常数。在时域中，这产生了一个卷积完美匹配层 (CPML) 校正，可以写成一个因果脉冲响应 $h(t)$ 与相关场导数的卷积。\n\n为减少内存占用，CPML 卷积被一个形式为 $h_{\\text{RC}}(t) = c \\exp(-b t)$，$t \\ge 0$ 的单极点递归卷积 (RC) 滤波器近似，其参数为 $b  0$ 和 $c  0$。在此配置中，由拉伸坐标及其离散化产生的频域目标响应由一个双极点实有理函数表示，其时域脉冲响应为\n$$\nh(t) = A \\exp(-\\alpha t) + B \\exp(-\\beta t),\n$$\n其中 $A  0$，$B  0$，$\\alpha  0$ 和 $\\beta  0$ 由 PML 分布和数字离散化确定。近似质量由 $[0,\\infty)$ 上脉冲响应误差的平方 $L_2$ 范数量化，\n$$\nJ(c,b) = \\int_{0}^{\\infty} \\left( c \\exp(-b t) - h(t) \\right)^{2} \\, dt,\n$$\n设计目标是选择 $b$（以及相关的最优 $c$）以最小化 $J$。\n\n从麦克斯韦方程组和拉伸坐标公式出发，证明上述卷积形式和 $h(t)$ 的有理近似的合理性。然后，使用 $L_2([0,\\infty))$ 中最小二乘近似的第一性原理，推导当为给定的 $b$ 选择 $c$ 以最小化 $J$ 时，最优衰减率 $b^{\\star}$ 的平稳性条件。最后，对于特定的 PML 参数\n$$\nA = 1.5, \\quad B = 0.5, \\quad \\alpha = 1.0 \\;\\text{s}^{-1}, \\quad \\beta = 4.0 \\;\\text{s}^{-1},\n$$\n计算最小化 $J$ 的最优衰减率 $b^{\\star}$ 并给出其值。您的最终答案以 $\\text{s}^{-1}$ 为单位，并四舍五入到四位有效数字。",
            "solution": "该问题要求完成三个主要任务：第一，证明完美匹配层 (PML) 的卷积形式及其脉冲响应的有理近似的合理性；第二，推导用于近似 PML 核的单极点递归滤波器最优衰减率 $b^{\\star}$ 的平稳性条件；第三，为一组特定参数计算 $b^{\\star}$ 的值。\n\n**第一部分：卷积形式和有理近似的合理性证明**\n\n让我们从无源、均匀、各向同性介质中的麦克斯韦方程组开始。对于沿 $x$ 轴传播、电场在 $z$ 方向 ($E_z$)、磁场在 $y$ 方向 ($H_y$) 的一维横电磁 (TEM) 波，相关方程为：\n$$\n\\varepsilon \\frac{\\partial E_z}{\\partial t} = \\frac{\\partial H_y}{\\partial x}\n$$\n$$\n\\mu \\frac{\\partial H_y}{\\partial t} = \\frac{\\partial E_z}{\\partial x}\n$$\n在频域中，采用时谐约定 $e^{j \\omega t}$，这些方程变为：\n$$\nj \\omega \\varepsilon E_z(\\omega) = \\frac{d H_y(\\omega)}{d x}\n$$\n$$\nj \\omega \\mu H_y(\\omega) = \\frac{d E_z(\\omega)}{d x}\n$$\n拉伸坐标 PML 公式在 PML 区域修改了空间导数算子 $\\frac{\\partial}{\\partial x}$。该算子被替换为 $\\frac{1}{s_x(\\omega)} \\frac{\\partial}{\\partial x}$，其中 $s_x(\\omega)$ 是复拉伸因子。问题指明该因子为：\n$$\ns_x(\\omega) = \\kappa_x + \\frac{\\sigma_x}{\\alpha_x + j \\omega}\n$$\n此处，$\\kappa_x \\ge 1$ 是一个实数拉伸因子，$\\sigma_x \\ge 0$ 提供损耗，$\\alpha_x \\ge 0$ 是一个控制损耗频率依赖性的参数。将此变换应用于第一个麦克斯韦方程可得：\n$$\nj \\omega \\varepsilon E_z(\\omega) = \\frac{1}{s_x(\\omega)} \\frac{d H_y(\\omega)}{d x}\n$$\n该方程建立了卷积关系。在时域中，频域的乘法变成了卷积。令 $f(t) = \\frac{\\partial H_y(t)}{\\partial x}$ 和 $S(\\omega) = \\frac{1}{s_x(\\omega)}$。那么时域方程为：\n$$\n\\varepsilon \\frac{\\partial E_z(t)}{\\partial t} = \\mathcal{F}^{-1}\\{S(\\omega)\\} * f(t) = s(t) * f(t)\n$$\n其中 $*$ 表示卷积，$s(t)$ 是 $S(\\omega)$ 的傅里叶逆变换。这就证明了卷积形式的合理性。\n\n通常，为了便于在时域中进行递归实现（称为递归卷积或 RC），该项被拆分。我们可以将 $S(\\omega) = \\frac{1}{s_x(\\omega)}$ 写成：\n$$\nS(\\omega) = \\frac{1}{\\kappa_x + \\frac{\\sigma_x}{\\alpha_x + j \\omega}} = \\frac{1}{\\kappa_x} \\left( \\frac{1}{1 + \\frac{\\sigma_x/\\kappa_x}{\\alpha_x+j\\omega}} \\right)\n$$\n在实现上，通常使用由这种结构产生的辅助微分方程 (ADE) 方法。然而，问题陈述指出，“CPML 校正”的目标脉冲响应 $h(t)$ 源于连续时间拉伸坐标及其在 FDTD 方案中的离散化。离散化过程，特别是时间导数和积分的近似方式（例如，对 ADE 使用半隐式方案），将单极点连续时间响应转换为更复杂的离散时间响应。当这个离散时间响应为了分析和设计而被映射回等效的连续时间形式时，它可以被一个多极点有理函数精确表示。问题指出，这个有效核可以很好地被一个双极点系统近似，其脉冲响应是两个实指数之和：\n$$\nh(t) = A \\exp(-\\alpha t) + B \\exp(-\\beta t)\n$$\n这种形式是基于 FDTD 的 CPML 实现的高级分析中的一个标准且合理的假设。\n\n**第二部分：$b^{\\star}$ 的平稳性条件的推导**\n\n目标是找到近似函数 $h_{\\text{RC}}(t) = c \\exp(-b t)$ 的参数 $c  0$ 和 $b  0$，以最小化平方 $L_2$ 误差范数：\n$$\nJ(c,b) = \\int_{0}^{\\infty} \\left( c \\exp(-b t) - h(t) \\right)^{2} \\, dt\n$$\n首先，对于一个固定的 $b$ 值，我们通过将 $J$ 对 $c$ 的偏导数设为零来找到最优的 $c$：\n$$\n\\frac{\\partial J}{\\partial c} = \\int_{0}^{\\infty} 2 \\left( c \\exp(-b t) - h(t) \\right) \\exp(-b t) \\, dt = 0\n$$\n$$\nc \\int_{0}^{\\infty} \\exp(-2b t) \\, dt = \\int_{0}^{\\infty} h(t) \\exp(-b t) \\, dt\n$$\n左边的积分是 $\\int_{0}^{\\infty} \\exp(-2b t) \\, dt = \\left[ -\\frac{1}{2b} \\exp(-2bt) \\right]_0^\\infty = \\frac{1}{2b}$ (对于 $b0$)。右边的积分是 $h(t)$ 在 $s=b$ 处的拉普拉斯变换，我们将其记为 $\\hat{h}(b)$。\n$$\nc \\left( \\frac{1}{2b} \\right) = \\hat{h}(b) \\implies c(b) = 2b \\, \\hat{h}(b)\n$$\n这给出了作为 $b$ 的函数的最优 $c$。我们将其代回到 $J$ 的表达式中，以获得一个仅关于 $b$ 的函数：\n$$\nJ(b) = \\int_{0}^{\\infty} \\left( (2b \\, \\hat{h}(b)) \\exp(-b t) - h(t) \\right)^{2} \\, dt\n$$\n展开平方项：\n$$\nJ(b) = (2b \\, \\hat{h}(b))^2 \\int_{0}^{\\infty} \\exp(-2bt) dt - 2(2b \\, \\hat{h}(b)) \\int_{0}^{\\infty} h(t) \\exp(-bt) dt + \\int_{0}^{\\infty} h(t)^2 dt\n$$\n$$\nJ(b) = (4b^2 \\hat{h}(b)^2) \\left(\\frac{1}{2b}\\right) - 4b \\, \\hat{h}(b) (\\hat{h}(b)) + \\int_{0}^{\\infty} h(t)^2 dt\n$$\n$$\nJ(b) = 2b \\, \\hat{h}(b)^2 - 4b \\, \\hat{h}(b)^2 + \\int_{0}^{\\infty} h(t)^2 dt = -2b \\, \\hat{h}(b)^2 + \\int_{0}^{\\infty} h(t)^2 dt\n$$\n为了最小化 $J(b)$，我们需要最大化 $b \\, \\hat{h}(b)^2$ 项（因为第二项相对于 $b$ 是一个常数）。我们通过将关于 $b$ 的导数设为零来找到驻点：\n$$\n\\frac{dJ}{db} = -2\\frac{d}{db} \\left[ b \\, (\\hat{h}(b))^2 \\right] = 0\n$$\n使用乘法法则：\n$$\n\\frac{d}{db} \\left[ b \\, (\\hat{h}(b))^2 \\right] = 1 \\cdot (\\hat{h}(b))^2 + b \\cdot \\left[ 2 \\hat{h}(b) \\frac{d\\hat{h}(b)}{db} \\right] = 0\n$$\n假设一个非平凡的近似，其中 $\\hat{h}(b) \\neq 0$，我们可以除以 $\\hat{h}(b)$：\n$$\n\\hat{h}(b) + 2b \\, \\frac{d\\hat{h}(b)}{db} = 0\n$$\n令 $\\hat{h}'(b) = \\frac{d\\hat{h}(b)}{db}$，最优衰减率 $b^{\\star}$ 的平稳性条件是：\n$$\n\\hat{h}(b^{\\star}) + 2b^{\\star} \\hat{h}'(b^{\\star}) = 0\n$$\n\n**第三部分：最优衰减率 $b^{\\star}$ 的计算**\n\n我们已知目标脉冲响应：\n$$\nh(t) = A \\exp(-\\alpha t) + B \\exp(-\\beta t)\n$$\n参数为 $A = 1.5$，$B = 0.5$，$\\alpha = 1.0 \\;\\text{s}^{-1}$，以及 $\\beta = 4.0 \\;\\text{s}^{-1}$。首先，我们计算它的拉普拉斯变换 $\\hat{h}(b)$：\n$$\n\\hat{h}(b) = \\int_0^\\infty (A e^{-\\alpha t} + B e^{-\\beta t}) e^{-bt} dt = A \\int_0^\\infty e^{-(\\alpha+b)t} dt + B \\int_0^\\infty e^{-(\\beta+b)t} dt \n$$\n$$\n\\hat{h}(b) = \\frac{A}{\\alpha+b} + \\frac{B}{\\beta+b}\n$$\n接下来，我们计算它关于 $b$ 的导数：\n$$\n\\hat{h}'(b) = -\\frac{A}{(\\alpha+b)^2} - \\frac{B}{(\\beta+b)^2}\n$$\n将这些代入平稳性条件：\n$$\n\\left( \\frac{A}{\\alpha+b} + \\frac{B}{\\beta+b} \\right) + 2b \\left( -\\frac{A}{(\\alpha+b)^2} - \\frac{B}{(\\beta+b)^2} \\right) = 0\n$$\n按 $A$ 和 $B$ 分组各项：\n$$\nA \\left( \\frac{1}{\\alpha+b} - \\frac{2b}{(\\alpha+b)^2} \\right) + B \\left( \\frac{1}{\\beta+b} - \\frac{2b}{(\\beta+b)^2} \\right) = 0\n$$\n$$\nA \\left( \\frac{(\\alpha+b)-2b}{(\\alpha+b)^2} \\right) + B \\left( \\frac{(\\beta+b)-2b}{(\\beta+b)^2} \\right) = 0\n$$\n$$\nA \\frac{\\alpha-b}{(\\alpha+b)^2} + B \\frac{\\beta-b}{(\\beta+b)^2} = 0\n$$\n现在，我们代入给定的数值：\n$$\n1.5 \\frac{1.0-b}{(1.0+b)^2} + 0.5 \\frac{4.0-b}{(4.0+b)^2} = 0\n$$\n为简化起见，我们将方程乘以 $2$：\n$$\n3 \\frac{1-b}{(1+b)^2} + \\frac{4-b}{(4+b)^2} = 0\n$$\n为了解出 $b$，我们消去分母：\n$$\n3(1-b)(4+b)^2 + (4-b)(1+b)^2 = 0\n$$\n展开平方项：$(4+b)^2 = 16+8b+b^2$ 和 $(1+b)^2 = 1+2b+b^2$。\n$$\n3(1-b)(16+8b+b^2) + (4-b)(1+2b+b^2) = 0\n$$\n$$\n3(16+8b+b^2-16b-8b^2-b^3) + (4+8b+4b^2-b-2b^2-b^3) = 0\n$$\n$$\n3(16-8b-7b^2-b^3) + (4+7b+2b^2-b^3) = 0\n$$\n$$\n48 - 24b - 21b^2 - 3b^3 + 4 + 7b + 2b^2 - b^3 = 0\n$$\n合并同类项得到一个关于 $b$ 的三次方程：\n$$\n-4b^3 - 19b^2 - 17b + 52 = 0\n$$\n或者，乘以 $-1$：\n$$\n4b^3 + 19b^2 + 17b - 52 = 0\n$$\n我们寻求此多项式的正实根。令 $F(b) = 4b^3 + 19b^2 + 17b - 52$。在整数点求值：\n$F(1) = 4(1)^3 + 19(1)^2 + 17(1) - 52 = 4+19+17-52 = -12$。\n$F(2) = 4(2)^3 + 19(2)^2 + 17(2) - 52 = 32+76+34-52 = 90$。\n由于 $F(1)  0$ 且 $F(2)  0$，因此在区间 $(1, 2)$ 内存在一个根 $b^{\\star}$。我们可以使用诸如牛顿法之类的数值方法来找到这个根。\n让我们从 $b_0 = 1.2$ 开始迭代：\n$F(1.2) = 4(1.728) + 19(1.44) + 17(1.2) - 52 = 6.912 + 27.36 + 20.4 - 52 = 54.672 - 52 = 2.672$。\n此处的计算在原始草稿中是正确的。让我们使用牛顿法对 $4b^3 + 19b^2 + 17b - 52 = 0$ 进行求解。\n$F'(b) = 12b^2 + 38b + 17$。\n从 $b_0 = 1.2$ 开始：\n$F(1.2) = 2.672$。\n$F'(1.2) = 12(1.44) + 38(1.2) + 17 = 17.28 + 45.6 + 17 = 79.88$。\n$b_1 = b_0 - \\frac{F(b_0)}{F'(b_0)} = 1.2 - \\frac{2.672}{79.88} \\approx 1.2 - 0.03345 = 1.16655$。\n让我们用 $b_1 = 1.166$ 进行另一次迭代：\n$F(1.166) = 4(1.166)^3 + 19(1.166)^2 + 17(1.166) - 52 \\approx 6.3410 + 25.8316 + 19.822 - 52 \\approx -0.0054$。\n$F'(1.166) = 12(1.166)^2 + 38(1.166) + 17 \\approx 16.3147 + 44.308 + 17 \\approx 77.6227$。\n$b_2 = 1.166 - \\frac{-0.0054}{77.6227} \\approx 1.166 + 0.00006957 \\approx 1.16607$。\n该值已收敛。四舍五入到四位有效数字得到 $b^{\\star} = 1.166$。单位继承自 $\\alpha$ 和 $\\beta$，即 $\\text{s}^{-1}$。",
            "answer": "$$\\boxed{1.166}$$"
        }
    ]
}