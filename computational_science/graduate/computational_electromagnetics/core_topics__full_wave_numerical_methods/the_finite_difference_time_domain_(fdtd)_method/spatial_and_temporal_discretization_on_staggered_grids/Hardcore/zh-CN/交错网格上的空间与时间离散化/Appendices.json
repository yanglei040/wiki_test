{
    "hands_on_practices": [
        {
            "introduction": "在计算电磁学中，将连续的麦克斯韦方程离散化是核心步骤。Yee元胞上的交错网格结构要求我们重新思考如何表示散度等微分算子。本练习将指导您从高斯定律的积分形式出发，为一个Yee元胞推导离散散度算子，这是理解场分量如何在空间中交错排布以及如何精确地表示物理守恒律的第一步。",
            "id": "3349279",
            "problem": "考虑一个三维均匀笛卡尔网格，其间距分别为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$，电磁场分量采用交错网格（Yee网格）布局。电通量密度分量 $D_x$、$D_y$ 和 $D_z$ 分别配置在垂直于 $x$、$y$ 和 $z$ 方向的面上，因此 $D_x$ 定义在面心位置 $(i+\\tfrac{1}{2},j,k)$，$D_y$ 在 $(i,j+\\tfrac{1}{2},k)$，$D_z$ 在 $(i,j,k+\\tfrac{1}{2})$，其中 $(i,j,k)$ 是网格单元的索引。对于一个人为构造的面心场，假设\n$$\nD_x\\bigl(i+\\tfrac{1}{2},j,k\\bigr) = \\alpha\\, i\\, \\Delta x, \\qquad D_y\\bigl(i,j+\\tfrac{1}{2},k\\bigr)=0,\\qquad D_z\\bigl(i,j,k+\\tfrac{1}{2}\\bigr)=0,\n$$\n其中 $\\alpha$ 为实常数，$i\\in\\mathbb{Z}$ 表示沿 $x$ 方向的单元索引。假设为内部单元，以便所有需要的面值均可用，并忽略边界效应。\n\n从电通量密度的高斯定律积分形式 $\\displaystyle \\iiint_{V}\\nabla\\cdot \\mathbf{D}\\, \\mathrm{d}V=\\iint_{\\partial V} \\mathbf{D}\\cdot \\mathbf{\\hat{n}}\\, \\mathrm{d}A$ 出发，推导位于单元中心 $(i,j,k)$ 的离散散度算子，用交错网格上的面心值表示。然后，将其应用于上述人为构造的场，以获得离散电荷密度 $\\rho(i,j,k)$，使得在 $(i,j,k)$ 处 $\\nabla\\cdot \\mathbf{D}=\\rho$。将最终的电荷密度以库仑/立方米（C/m$^3$）为单位，表示为含 $\\alpha$ 的单一符号表达式。无需四舍五入。",
            "solution": "该问题要求在交错笛卡尔网格（Yee网格）上推导电通量密度 $\\mathbf{D}$ 的离散散度算子，并将其应用于给定的人为构造的场，以求出相应的电荷密度 $\\rho$。\n\n验证过程证实了该问题具有科学依据、提法恰当、客观，且无致命缺陷。这是计算电磁学中的一个标准问题。因此，我们可以着手求解。\n\n推导从电通量密度 $\\mathbf{D}$ 的高斯定律积分形式开始：\n$$\n\\iiint_{V} (\\nabla \\cdot \\mathbf{D}) \\, \\mathrm{d}V = \\iint_{\\partial V} \\mathbf{D} \\cdot \\mathbf{\\hat{n}} \\, \\mathrm{d}A\n$$\n其中 $V$ 是一个控制体，$\\partial V$ 是其边界曲面，$\\mathbf{\\hat{n}}$ 是向外的单位法向量。\n\n在Yee网格的背景下，我们将此定律应用于单个网格单元。为方便表示，我们设该单元索引为 $(i,j,k)$，并以坐标原点为中心，但结果是普适的。控制体 $V$ 是一个由空间范围 $x \\in [-\\frac{\\Delta x}{2}, \\frac{\\Delta x}{2}]$、$y \\in [-\\frac{\\Delta y}{2}, \\frac{\\Delta y}{2}]$ 和 $z \\in [-\\frac{\\Delta z}{2}, \\frac{\\Delta z}{2}]$ 定义的矩形棱柱。该单元的体积为 $\\Delta V = \\Delta x \\Delta y \\Delta z$。电荷密度 $\\rho$ 和散度 $\\nabla \\cdot \\mathbf{D}$ 在单元中心 $(i,j,k)$ 处求值。\n\n高斯定律的左侧通过假设 $\\nabla \\cdot \\mathbf{D}$ 在小体积 $\\Delta V$ 上为常数来近似：\n$$\n\\iiint_{V} (\\nabla \\cdot \\mathbf{D}) \\, \\mathrm{d}V \\approx \\left. (\\nabla \\cdot \\mathbf{D}) \\right|_{(i,j,k)} \\Delta V = \\rho(i,j,k) \\Delta x \\Delta y \\Delta z\n$$\n\n右侧是流出该单元的总通量，为其六个面通量之和。在交错网格上，垂直于每个面的场分量定义在该面的中心。\n1. 通过垂直于 $x$ 轴的面的通量：\n位于 $x = \\frac{\\Delta x}{2}$ 的面（“右”侧面，对应网格索引 $i+\\frac{1}{2}$）面积为 $\\Delta A_x = \\Delta y \\Delta z$，向外法向量为 $\\mathbf{\\hat{n}} = \\mathbf{\\hat{x}}$。通量近似为 $D_x(i+\\frac{1}{2},j,k) \\Delta y \\Delta z$。\n位于 $x = -\\frac{\\Delta x}{2}$ 的面（“左”侧面，对应网格索引 $i-\\frac{1}{2}$）面积为 $\\Delta A_x = \\Delta y \\Delta z$，向外法向量为 $\\mathbf{\\hat{n}} = -\\mathbf{\\hat{x}}$。通量近似为 $-D_x(i-\\frac{1}{2},j,k) \\Delta y \\Delta z$。\n$x$ 方向的净通量为 $\\left[ D_x(i+\\frac{1}{2},j,k) - D_x(i-\\frac{1}{2},j,k) \\right] \\Delta y \\Delta z$。\n\n2. 通过垂直于 $y$ 轴的面的通量：\n通过类似的推理，$y$ 方向的净通量为 $\\left[ D_y(i,j+\\frac{1}{2},k) - D_y(i,j-\\frac{1}{2},k) \\right] \\Delta x \\Delta z$。\n\n3. 通过垂直于 $z$ 轴的面的通量：\n$z$ 方向的净通量为 $\\left[ D_z(i,j,k+\\frac{1}{2}) - D_z(i,j,k-\\frac{1}{2}) \\right] \\Delta x \\Delta y$。\n\n将所有六个面的通量相加，得到总通量：\n$$\n\\iint_{\\partial V} \\mathbf{D} \\cdot \\mathbf{\\hat{n}} \\, \\mathrm{d}A \\approx \\left[ D_x(i+\\tfrac{1}{2},j,k) - D_x(i-\\tfrac{1}{2},j,k) \\right] \\Delta y \\Delta z + \\left[ D_y(i,j+\\tfrac{1}{2},k) - D_y(i,j-\\tfrac{1}{2},k) \\right] \\Delta x \\Delta z + \\left[ D_z(i,j,k+\\tfrac{1}{2}) - D_z(i,j,k-\\tfrac{1}{2}) \\right] \\Delta x \\Delta y\n$$\n\n令高斯定律离散化后的左右两边相等，可得：\n$$\n\\left. (\\nabla \\cdot \\mathbf{D}) \\right|_{(i,j,k)} \\Delta x \\Delta y \\Delta z \\approx \\left[ D_x(i+\\tfrac{1}{2},j,k) - D_x(i-\\tfrac{1}{2},j,k) \\right] \\Delta y \\Delta z + \\dots\n$$\n除以单元体积 $\\Delta V = \\Delta x \\Delta y \\Delta z$，我们得到单元 $(i,j,k)$ 处的离散散度算子：\n$$\n\\left. (\\nabla \\cdot \\mathbf{D}) \\right|_{(i,j,k)} = \\frac{D_x(i+\\frac{1}{2},j,k) - D_x(i-\\frac{1}{2},j,k)}{\\Delta x} + \\frac{D_y(i,j+\\frac{1}{2},k) - D_y(i,j-\\frac{1}{2},k)}{\\Delta y} + \\frac{D_z(i,j,k+\\frac{1}{2}) - D_z(i,j,k-\\frac{1}{2})}{\\Delta z}\n$$\n此表达式是交错网格上散度算子的二阶精确中心差分近似。\n\n接下来，我们将此算子应用于给定的人为构造的场：\n$$\nD_x\\bigl(i+\\tfrac{1}{2},j,k\\bigr) = \\alpha\\, i\\, \\Delta x, \\qquad D_y\\bigl(i,j+\\tfrac{1}{2},k\\bigr)=0,\\qquad D_z\\bigl(i,j,k+\\tfrac{1}{2}\\bigr)=0\n$$\n我们计算离散散度的每一项。\n\n对于 $x$ 项，我们需要 $(i+\\frac{1}{2},j,k)$ 和 $(i-\\frac{1}{2},j,k)$ 处的 $D_x$。\n$(i+\\frac{1}{2},j,k)$ 处的值是直接给出的：$D_x(i+\\frac{1}{2},j,k) = \\alpha\\, i\\, \\Delta x$。\n为求出 $(i-\\frac{1}{2},j,k)$ 处的值，我们注意到该网格位置可以写为 $((i-1)+\\frac{1}{2},j,k)$。我们将索引 $(i-1)$ 代入 $D_x$ 的公式：\n$D_x(i-\\frac{1}{2},j,k) = D_x((i-1)+\\frac{1}{2},j,k) = \\alpha (i-1) \\Delta x$。\n因此，离散散度的 $x$ 分量为：\n$$\n\\frac{D_x(i+\\frac{1}{2},j,k) - D_x(i-\\frac{1}{2},j,k)}{\\Delta x} = \\frac{\\alpha\\, i\\, \\Delta x - \\alpha (i-1) \\Delta x}{\\Delta x} = \\frac{\\alpha\\, i\\, \\Delta x - \\alpha\\, i\\, \\Delta x + \\alpha\\, \\Delta x}{\\Delta x} = \\frac{\\alpha\\, \\Delta x}{\\Delta x} = \\alpha\n$$\n\n对于 $y$ 项，给定场为 $D_y(i,j+\\frac{1}{2},k)=0$。这对所有索引都成立。因此，$D_y(i,j-\\frac{1}{2},k)=0$ 也成立。\n离散散度的 $y$ 分量为：\n$$\n\\frac{D_y(i,j+\\frac{1}{2},k) - D_y(i,j-\\frac{1}{2},k)}{\\Delta y} = \\frac{0 - 0}{\\Delta y} = 0\n$$\n\n对于 $z$ 项，同样地，$D_z(i,j,k+\\frac{1}{2})=0$ 且 $D_z(i,j,k-\\frac{1}{2})=0$。\n离散散度的 $z$ 分量为：\n$$\n\\frac{D_z(i,j,k+\\frac{1}{2}) - D_z(i,j,k-\\frac{1}{2})}{\\Delta z} = \\frac{0-0}{\\Delta z} = 0\n$$\n\n单元 $(i,j,k)$ 处的总离散散度是这些分量之和：\n$$\n\\left. (\\nabla \\cdot \\mathbf{D}) \\right|_{(i,j,k)} = \\alpha + 0 + 0 = \\alpha\n$$\n根据麦克斯韦方程组，$\\nabla \\cdot \\mathbf{D} = \\rho$。因此，离散电荷密度 $\\rho(i,j,k)$ 为：\n$$\n\\rho(i,j,k) = \\alpha\n$$\n电荷密度在所有单元中是恒定的，与索引 $(i,j,k)$ 无关。量纲一致性得到验证，因为给定表达式 $D_x = \\alpha\\, i\\, \\Delta x$ 要求 $\\alpha$ 的单位是 $\\text{C}/\\text{m}^3$ 才能使 $D_x$ 的单位为 $\\text{C}/\\text{m}^2$。",
            "answer": "$$\\boxed{\\alpha}$$"
        },
        {
            "introduction": "在建立了静态场的离散散度之后，我们进一步探讨动态情况：电荷的运动。电荷守恒是电磁学的基本定律，任何可靠的数值方案都必须在离散层面精确地满足它。通过这个思想实验，您将看到电荷密度（定义在元胞中心）和电流密度（定义在元胞边缘）的交错排布如何自然地导出一个精确满足离散电荷守恒方程的更新方案。",
            "id": "3349287",
            "problem": "一个电荷量为 $q$ 的带电粒子在用于时域有限差分 (FDTD) 计算电磁学的均匀笛卡尔Yee交错网格中运动。网格间距为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$。电荷密度 $\\rho$ 存储在整数时间层 $n$ 的单元中心，而电流密度分量 $J_x$、$J_y$ 和 $J_z$ 存储在半时间层 $n+\\tfrac{1}{2}$ 上与相应坐标轴对齐的棱的中心。考虑应用于每个单元控制体的、此交错网格上的离散连续性方程的有限体积形式：\n$$\n\\frac{\\rho^{n+1}_{i,j,k}-\\rho^{n}_{i,j,k}}{\\Delta t}\n+\\frac{J^{n+1/2}_{x,i+1/2,j,k}-J^{n+1/2}_{x,i-1/2,j,k}}{\\Delta x}\n+\\frac{J^{n+1/2}_{y,i,j+1/2,k}-J^{n+1/2}_{y,i,j-1/2,k}}{\\Delta y}\n+\\frac{J^{n+1/2}_{z,i,j,k+1/2}-J^{n+1/2}_{z,i,j,k-1/2}}{\\Delta z}\n=0.\n$$\n在时间 $n$，粒子恰好位于单元 $(i,j,k)$ 的中心，在时间 $n+1$，它恰好位于单元 $(i+1,j,k)$ 的中心，在一个时间步长 $\\Delta t$ 内，沿 $+x$ 方向纯粹移动了距离 $\\Delta x$。域内没有其他粒子或源。使用最近单元中心（零阶）形函数进行电荷沉积，这样在时间 $n$，单元中心的密度为 $\\rho^n_{i,j,k}=q/(\\Delta x\\,\\Delta y\\,\\Delta z)$，其他地方为零，而在时间 $n+1$，密度为 $\\rho^{n+1}_{i+1,j,k}=q/(\\Delta x\\,\\Delta y\\,\\Delta z)$，其他地方为零。假设唯一的非零电流分量源于此穿越事件，与 $x$ 轴对齐，并且只沉积在两个单元之间唯一的、以 $x$ 棱为中心的位置，即 $J^{n+1/2}_{x,i+1/2,j,k}$；假定所有其他分量和棱位置上的值为零。从上述有限体积离散连续性方程和电荷守恒出发，推导出所需的棱电流 $J^{n+1/2}_{x,i+1/2,j,k}$ 的唯一值以及更新后的单元中心密度 $\\rho^{n+1}_{i,j,k}$ 和 $\\rho^{n+1}_{i+1,j,k}$，使得离散连续性方程在两个相邻单元中都得到精确满足。\n\n以单行矩阵的形式提供你的最终答案，顺序为 $\\big[J^{n+1/2}_{x,i+1/2,j,k},\\ \\rho^{n+1}_{i,j,k},\\ \\rho^{n+1}_{i+1,j,k}\\big]$。将 $J_x$ 以 $\\mathrm{A\\,m^{-2}}$ 为单位表示，$\\rho$ 以 $\\mathrm{C\\,m^{-3}}$ 为单位表示。不需要进行数值四舍五入；给出以 $q$、$\\Delta x$、$\\Delta y$、$\\Delta z$ 和 $\\Delta t$ 表示的闭式符号表达式。",
            "solution": "问题要求推导电流密度 $J^{n+1/2}_{x,i+1/2,j,k}$ 和更新后的电荷密度 $\\rho^{n+1}_{i,j,k}$ 及 $\\rho^{n+1}_{i+1,j,k}$，以确保对于在Yee网格上两个相邻单元之间移动的粒子，离散连续性方程得以满足。\n\n首先，我们必须根据问题陈述，将初始时间步 $n$ 和最终时间步 $n+1$ 的电荷密度形式化。问题指定了用于电荷沉积的零阶（最近单元中心）形函数。网格单元的体积为 $V_{cell} = \\Delta x \\Delta y \\Delta z$。\n\n在时间 $t=n\\Delta t$，电荷量为 $q$ 的粒子位于单元 $(i,j,k)$ 的中心。根据沉积方案，全部电荷被分配给该单元中心的密度。因此，电荷密度为：\n$$\n\\rho^{n}_{i,j,k} = \\frac{q}{V_{cell}} = \\frac{q}{\\Delta x \\Delta y \\Delta z}\n$$\n由于粒子不在任何其他单元中，其他各处的电荷密度均为零。具体来说，对于相邻的单元 $(i+1,j,k)$：\n$$\n\\rho^{n}_{i+1,j,k} = 0\n$$\n\n在时间 $t=(n+1)\\Delta t$，粒子已移动到单元 $(i+1,j,k)$ 的中心。应用相同的沉积规则，电荷现在被分配到这个新单元的中心。这得出了更新后的电荷密度，这是从物理描述中待求解的解的一部分：\n$$\n\\rho^{n+1}_{i+1,j,k} = \\frac{q}{V_{cell}} = \\frac{q}{\\Delta x \\Delta y \\Delta z}\n$$\n粒子已经离开了单元 $(i,j,k)$，所以那里的更新密度为：\n$$\n\\rho^{n+1}_{i,j,k} = 0\n$$\n\n接下来，我们将给定的有限体积离散连续性方程应用于此事件涉及的两个单元：单元 $(i,j,k)$ 和单元 $(i+1,j,k)$。问题陈述，唯一的非零电流分量是 $J^{n+1/2}_{x,i+1/2,j,k}$，它位于这两个单元之间的界面上。\n\n让我们分析单元 $(i,j,k)$。通用的离散连续性方程是：\n$$\n\\frac{\\rho^{n+1}_{i,j,k}-\\rho^{n}_{i,j,k}}{\\Delta t}\n+\\frac{J^{n+1/2}_{x,i+1/2,j,k}-J^{n+1/2}_{x,i-1/2,j,k}}{\\Delta x}\n+\\frac{J^{n+1/2}_{y,i,j+1/2,k}-J^{n+1/2}_{y,i,j-1/2,k}}{\\Delta y}\n+\\frac{J^{n+1/2}_{z,i,j,k+1/2}-J^{n+1/2}_{z,i,j,k-1/2}}{\\Delta z}\n=0\n$$\n根据问题陈述，除了 $J^{n+1/2}_{x,i+1/2,j,k}$ 之外，所有电流密度分量都为零。因此，$J^{n+1/2}_{x,i-1/2,j,k}=0$，并且所有的 $J_y$ 和 $J_z$ 项都为零。单元 $(i,j,k)$ 的方程简化为：\n$$\n\\frac{\\rho^{n+1}_{i,j,k}-\\rho^{n}_{i,j,k}}{\\Delta t} + \\frac{J^{n+1/2}_{x,i+1/2,j,k} - 0}{\\Delta x} = 0\n$$\n代入我们确定的电荷密度值：\n$$\n\\frac{0 - \\frac{q}{\\Delta x \\Delta y \\Delta z}}{\\Delta t} + \\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\n$$\n-\\frac{q}{\\Delta t \\Delta x \\Delta y \\Delta z} + \\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\n求解未知的电流密度 $J^{n+1/2}_{x,i+1/2,j,k}$：\n$$\n\\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = \\frac{q}{\\Delta t \\Delta x \\Delta y \\Delta z}\n$$\n$$\nJ^{n+1/2}_{x,i+1/2,j,k} = \\frac{q \\Delta x}{\\Delta t \\Delta x \\Delta y \\Delta z} = \\frac{q}{\\Delta t \\Delta y \\Delta z}\n$$\n\n现在，我们对单元 $(i+1,j,k)$ 执行相同的分析以验证一致性。应用于此单元的通用方程是：\n$$\n\\frac{\\rho^{n+1}_{i+1,j,k}-\\rho^{n}_{i+1,j,k}}{\\Delta t}\n+\\frac{J^{n+1/2}_{x,i+3/2,j,k}-J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x}\n+\\frac{J^{n+1/2}_{y,i+1,j+1/2,k}-J^{n+1/2}_{y,i+1,j-1/2,k}}{\\Delta y}\n+\\frac{J^{n+1/2}_{z,i+1,j,k+1/2}-J^{n+1/2}_{z,i+1,j,k-1/2}}{\\Delta z}\n=0\n$$\n同样，除了 $J^{n+1/2}_{x,i+1/2,j,k}$ 外，所有电流分量都为零。特别是，$J^{n+1/2}_{x,i+3/2,j,k}=0$。方程简化为：\n$$\n\\frac{\\rho^{n+1}_{i+1,j,k}-\\rho^{n}_{i+1,j,k}}{\\Delta t} + \\frac{0 - J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\n代入电荷密度值：\n$$\n\\frac{\\frac{q}{\\Delta x \\Delta y \\Delta z} - 0}{\\Delta t} - \\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\n$$\n\\frac{q}{\\Delta t \\Delta x \\Delta y \\Delta z} - \\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = 0\n$$\n求解 $J^{n+1/2}_{x,i+1/2,j,k}$：\n$$\n\\frac{J^{n+1/2}_{x,i+1/2,j,k}}{\\Delta x} = \\frac{q}{\\Delta t \\Delta x \\Delta y \\Delta z}\n$$\n$$\nJ^{n+1/2}_{x,i+1/2,j,k} = \\frac{q \\Delta x}{\\Delta t \\Delta x \\Delta y \\Delta z} = \\frac{q}{\\Delta t \\Delta y \\Delta z}\n$$\n两次计算都得出了相同的电流密度表达式。这证实了该方案是一致的，并且电荷是离散守恒的。离开单元 $(i,j,k)$ 的总电荷等于进入单元 $(i+1,j,k)$ 的总电荷，这是通过共享面上的电流来调节的。\n\n推导出的量是：\n1. 电流密度：$J^{n+1/2}_{x,i+1/2,j,k} = \\frac{q}{\\Delta t \\Delta y \\Delta z}$\n2. 初始单元中的更新密度：$\\rho^{n+1}_{i,j,k} = 0$\n3. 最终单元中的更新密度：$\\rho^{n+1}_{i+1,j,k} = \\frac{q}{\\Delta x \\Delta y \\Delta z}$\n\n这些是在给定条件下满足离散连续性方程的唯一值。\n最终答案必须以单行矩阵的形式提供，顺序为 $\\big[J^{n+1/2}_{x,i+1/2,j,k},\\ \\rho^{n+1}_{i,j,k},\\ \\rho^{n+1}_{i+1,j,k}\\big]$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{q}{\\Delta t \\Delta y \\Delta z}  0  \\frac{q}{\\Delta x \\Delta y \\Delta z}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理解了散度算子和电荷守恒后，我们将注意力转向波动现象。离散化不仅影响静态场的计算，更深刻地改变了波在网格上的传播方式，这通过麦克斯韦旋度方程来描述。本练习的核心是研究数值色散——由于离散化，不同频率的波在网格上以不同速度传播的现象。通过推导数值色散关系并计算群速度，您将亲身体验到数值模拟的非理想特性，并理解其对仿真精度的重要影响。",
            "id": "3349258",
            "problem": "考虑在真空中传播的电磁波，其行为由麦克斯韦方程组描述，本构关系为 $\\mathbf{D}=\\varepsilon_{0}\\mathbf{E}$ 和 $\\mathbf{B}=\\mu_{0}\\mathbf{H}$，因此 $c=1/\\sqrt{\\mu_{0}\\varepsilon_{0}}$。场量在均匀笛卡尔网格上采用时域有限差分（FDTD）方法的标准三维交错Yee网格进行离散化（电场分量位于单元棱边，磁场分量位于单元面心，时间上采用半个时间步长的蛙跳格式交错），网格在所有方向上的间距均为 $h$，时间步长为 $\\Delta t$。库朗数指定为 $S=c\\,\\Delta t/h=1/2$，该值低于三维稳定性极限。\n\n假设一个单色平面波，其波矢 $\\mathbf{k}=(k_{x},0,0)$ 与 $x$ 轴对齐，并考虑分量 $k_{x}=\\pi/(3h)$。从麦克斯韦方程组和Yee FDTD离散更新方程出发，推导该波在这种交错网格上的离散数值色散关系。根据该色散关系，计算沿传播方向的群速度，定义为 $v_{g}=\\partial\\omega/\\partial k_{x}$，并在 $k_{x}=\\pi/(3h)$ 处求值。\n\n通过报告相对偏差 $\\delta=(v_{g}/c)-1$ 来量化 $v_{g}$ 与连续介质中光速 $c$ 的偏差。将最终答案表示为精确的解析表达式。无需进行数值四舍五入，最终报告值中不应包含任何物理单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取给定条件**\n- 控制方程：真空中电磁波传播的麦克斯韦方程组。\n- 本构关系：$\\mathbf{D}=\\varepsilon_{0}\\mathbf{E}$ 和 $\\mathbf{B}=\\mu_{0}\\mathbf{H}$。\n- 真空中光速：$c=1/\\sqrt{\\mu_{0}\\varepsilon_{0}}$。\n- 离散化方法：时域有限差分（FDTD）方法的标准三维交错Yee网格，电场分量位于单元棱边，磁场分量位于单元面心。时间积分采用蛙跳格式，时间交错量为 $\\Delta t/2$。\n- 网格参数：均匀笛卡尔网格，三维方向上的间距均为 $h$。\n- 时间步长：$\\Delta t$。\n- 库朗数：$S=c\\,\\Delta t/h=1/2$。\n- 波类型：单色平面波。\n- 波矢：$\\mathbf{k}=(k_{x},0,0)$，与 $x$ 轴对齐。\n- 特定波数分量：$k_{x}=\\pi/(3h)$。\n- 待求量：群速度与光速的相对偏差 $\\delta=(v_{g}/c)-1$，其中 $v_{g}=\\partial\\omega/\\partial k_{x}$ 在给定的 $k_x$ 处计算。\n\n**步骤 2：使用提取的给定条件进行验证**\n- **科学性：**该问题基于麦克斯韦方程组和 FDTD 方法，这些是经典电磁学和计算物理学的基石原理。数值色散分析是该领域的标准和关键课题。\n- **适定性：**该问题提供了一套完整的参数，并要求一个具体、可推导的量。存在唯一解。\n- **客观性：**问题陈述是定量的，没有主观或含糊不清的语言。\n- **一致性与完整性：**提供了所有必要信息。给定的库朗数 $S=1/2$ 小于三维均匀立方网格的稳定性极限 $S_{\\text{max}}=1/\\sqrt{3} \\approx 0.577$，因此如陈述所述，数值格式是稳定的。该问题是自洽且一致的。\n\n**步骤 3：结论与行动**\n问题被判定为**有效**。将提供完整解答。\n\n### 求解推导\n\n无源真空中电磁波的传播由麦克斯韦旋度方程描述：\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t} = \\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} $$\n\n问题指定了一个沿 $x$ 轴传播的平面波，其波矢为 $\\mathbf{k}=(k_{x},0,0)$。这意味着场在 $y$ 和 $z$ 方向上没有空间变化，即 $\\partial/\\partial y = 0$ 和 $\\partial/\\partial z = 0$。对于横电磁（TEM）波，我们可以不失一般性地将场对齐，使得 $\\mathbf{E} = E_y(x,t)\\hat{\\mathbf{y}}$ 和 $\\mathbf{H} = H_z(x,t)\\hat{\\mathbf{z}}$。在这些条件下，旋度方程简化为一维系统：\n$$ \\frac{\\partial E_y}{\\partial x} = -\\mu_0 \\frac{\\partial H_z}{\\partial t} $$\n$$ \\frac{\\partial H_z}{\\partial x} = -\\varepsilon_0 \\frac{\\partial E_y}{\\partial t} $$\n\n在采用Yee网格的FDTD方法中，这些方程在空间和时间上都使用中心差分进行离散化。电场分量 $E_y$ 和磁场分量 $H_z$ 是交错的。设空间网格索引为 $i$，时间索引为 $n$。我们可以在空间位置 $(i+1/2)h$ 和时间步 $(n+1/2)\\Delta t$ 定义 $E_y$，在空间位置 $ih$ 和时间步 $n\\Delta t$ 定义 $H_z$。更新方程为：\n$$ \\frac{E_y^{n+1/2}(i+1/2) - E_y^{n+1/2}(i-1/2)}{h} = -\\mu_0 \\frac{H_z^{n+1}(i) - H_z^n(i)}{\\Delta t} $$\n$$ \\frac{H_z^n(i+1) - H_z^n(i)}{h} = -\\varepsilon_0 \\frac{E_y^{n+1/2}(i+1/2) - E_y^{n-1/2}(i+1/2)}{\\Delta t} $$\n\n为了找到数值色散关系，我们代入一个离散平面波解，其形式为：\n$$ E_y^{n+1/2}(i+1/2) = E_{y0} \\exp[j(\\omega(n+1/2)\\Delta t - k_x(i+1/2)h)] $$\n$$ H_z^n(i) = H_{z0} \\exp[j(\\omega n\\Delta t - k_x i h)] $$\n其中 $\\omega$ 是数值角频率，$k_x$ 是波数。\n\n将这些代入第二个更新方程：\n$$ \\frac{H_{z0} \\exp[j(\\omega n\\Delta t - k_x(i+1)h)] - H_{z0} \\exp[j(\\omega n\\Delta t - k_x i h)]}{h} = -\\varepsilon_0 \\frac{E_{y0} \\exp[j(\\omega(n+1/2)\\Delta t - k_x(i+1/2)h)] - E_{y0} \\exp[j(\\omega(n-1/2)\\Delta t - k_x(i+1/2)h)]}{\\Delta t} $$\n除以公因子 $\\exp[j(\\omega n\\Delta t - k_x(i+1/2)h)]$：\n$$ \\frac{H_{z0}}{h} (\\exp[-jk_xh/2] - \\exp[+jk_xh/2]) = -\\frac{\\varepsilon_0 E_{y0}}{\\Delta t} (\\exp[+j\\omega\\Delta t/2] - \\exp[-j\\omega\\Delta t/2]) $$\n使用欧拉公式 $2j\\sin\\theta = \\exp(j\\theta) - \\exp(-j\\theta)$：\n$$ \\frac{H_{z0}}{h}(-2j\\sin(\\frac{k_x h}{2})) = -\\frac{\\varepsilon_0 E_{y0}}{\\Delta t}(2j\\sin(\\frac{\\omega\\Delta t}{2})) $$\n$$ \\frac{H_{z0}}{h}\\sin(\\frac{k_x h}{2}) = \\frac{\\varepsilon_0 E_{y0}}{\\Delta t}\\sin(\\frac{\\omega\\Delta t}{2}) \\quad (1) $$\n\n类似地，代入第一个更新方程可得：\n$$ \\frac{E_{y0}}{h}\\sin(\\frac{k_x h}{2}) = \\frac{\\mu_0 H_{z0}}{\\Delta t}\\sin(\\frac{\\omega\\Delta t}{2}) \\quad (2) $$\n注意符号变化来自方程 $\\frac{\\partial E_y}{\\partial x} = -\\mu_0 \\frac{\\partial H_z}{\\partial t}$。让我们重新验证第一个方程：$\\frac{E_{y0} \\exp(...(i+1/2)...) - E_{y0} \\exp(...(i-1/2)...)}{h}$。这变成了 $\\frac{E_{y0}}{h}(\\exp(jk_xh/2)-\\exp(-jk_xh/2)) \\exp(...) = \\frac{E_{y0}}{h}(2j\\sin(k_xh/2))\\exp(...)$。右侧是 $-\\mu_0 \\frac{H_{z0}\\exp(...n+1...) - H_{z0}\\exp(...n...)}{\\Delta t}$，即 $-\\mu_0 \\frac{H_{z0}}{\\Delta t}(\\exp(j\\omega\\Delta t)-1)\\exp(...) = -\\mu_0 \\frac{H_{z0}}{\\Delta t}\\exp(j\\omega\\Delta t/2)(2j\\sin(\\omega\\Delta t/2))\\exp(...)$。通过匹配时间和空间相位，项的放置需要很小心。一个更直接的方法是将(1)和(2)组合成关于 $(E_{y0}, H_{z0})$ 的线性系统。\n从 (1) 式可得: $H_{z0} \\frac{\\sin(k_x h / 2)}{h} - E_{y0} \\frac{\\varepsilon_0 \\sin(\\omega \\Delta t / 2)}{\\Delta t} = 0$\n从 (2) 式可得: $H_{z0} \\frac{\\mu_0 \\sin(\\omega \\Delta t / 2)}{\\Delta t} - E_{y0} \\frac{\\sin(k_x h / 2)}{h} = 0$\n为了得到非平凡解，系数矩阵的行列式必须为零：\n$$ \\left( \\frac{\\sin(k_x h / 2)}{h} \\right)^2 - \\left( \\frac{\\varepsilon_0 \\sin(\\omega \\Delta t / 2)}{\\Delta t} \\right) \\left( \\frac{\\mu_0 \\sin(\\omega \\Delta t / 2)}{\\Delta t} \\right) = 0 $$\n$$ \\frac{1}{h^2}\\sin^2(\\frac{k_x h}{2}) = \\frac{\\mu_0\\varepsilon_0}{(\\Delta t)^2}\\sin^2(\\frac{\\omega\\Delta t}{2}) $$\n使用 $c=1/\\sqrt{\\mu_0\\varepsilon_0}$，上式变为：\n$$ \\frac{1}{h^2}\\sin^2(\\frac{k_x h}{2}) = \\frac{1}{c^2(\\Delta t)^2}\\sin^2(\\frac{\\omega\\Delta t}{2}) $$\n重新排列并引入库朗数 $S = c\\Delta t/h$：\n$$ \\sin^2(\\frac{\\omega\\Delta t}{2}) = \\left(\\frac{c\\Delta t}{h}\\right)^2 \\sin^2(\\frac{k_x h}{2}) = S^2 \\sin^2(\\frac{k_x h}{2}) $$\n对于前向传播的波，取正平方根，得到沿网格轴传播的数值色散关系：\n$$ \\sin(\\frac{\\omega\\Delta t}{2}) = S \\sin(\\frac{k_x h}{2}) $$\n此结果与将通用的三维FDTD色散关系特化到 $\\mathbf{k}=(k_x, 0, 0)$ 的情况相一致。\n\n群速度 $v_g$ 定义为 $v_g = \\partial\\omega/\\partial k_x$。我们对色散关系关于 $k_x$ 进行隐式微分：\n$$ \\frac{\\partial}{\\partial k_x} \\left[ \\sin(\\frac{\\omega\\Delta t}{2}) \\right] = \\frac{\\partial}{\\partial k_x} \\left[ S \\sin(\\frac{k_x h}{2}) \\right] $$\n$$ \\cos(\\frac{\\omega\\Delta t}{2}) \\cdot \\frac{\\Delta t}{2} \\cdot \\frac{\\partial\\omega}{\\partial k_x} = S \\cdot \\cos(\\frac{k_x h}{2}) \\cdot \\frac{h}{2} $$\n$$ v_g = \\frac{\\partial\\omega}{\\partial k_x} = \\frac{S h}{\\Delta t} \\frac{\\cos(k_x h / 2)}{\\cos(\\omega\\Delta t / 2)} $$\n因为 $S=c\\Delta t/h$，我们有 $Sh/\\Delta t = c$。因此：\n$$ v_g = c \\frac{\\cos(k_x h / 2)}{\\cos(\\omega\\Delta t / 2)} $$\n为了只用 $k_x$ 表示 $v_g$，我们使用恒等式 $\\cos\\theta = \\sqrt{1-\\sin^2\\theta}$ 并将色散关系代入分母：\n$$ \\cos(\\frac{\\omega\\Delta t}{2}) = \\sqrt{1 - \\sin^2(\\frac{\\omega\\Delta t}{2})} = \\sqrt{1 - S^2 \\sin^2(\\frac{k_x h}{2})} $$\n所以，群速度为：\n$$ v_g(k_x) = c \\frac{\\cos(k_x h / 2)}{\\sqrt{1 - S^2 \\sin^2(k_x h / 2)}} $$\n\n现在我们代入给定值 $S=1/2$ 和 $k_x = \\pi/(3h)$ 来计算此表达式。\n三角函数的自变量为：\n$$ \\frac{k_x h}{2} = \\frac{(\\pi / (3h)) \\cdot h}{2} = \\frac{\\pi}{6} $$\n我们有：\n$$ \\cos(\\frac{\\pi}{6}) = \\frac{\\sqrt{3}}{2} $$\n$$ \\sin(\\frac{\\pi}{6}) = \\frac{1}{2} $$\n将这些值代入 $v_g$ 的表达式中：\n$$ v_g = c \\frac{\\cos(\\pi/6)}{\\sqrt{1 - S^2 \\sin^2(\\pi/6)}} = c \\frac{\\sqrt{3}/2}{\\sqrt{1 - (1/2)^2 (1/2)^2}} $$\n$$ v_g = c \\frac{\\sqrt{3}/2}{\\sqrt{1 - (1/4)(1/4)}} = c \\frac{\\sqrt{3}/2}{\\sqrt{1 - 1/16}} = c \\frac{\\sqrt{3}/2}{\\sqrt{15/16}} $$\n$$ v_g = c \\frac{\\sqrt{3}/2}{\\sqrt{15}/4} = c \\left( \\frac{\\sqrt{3}}{2} \\cdot \\frac{4}{\\sqrt{15}} \\right) = c \\frac{2\\sqrt{3}}{\\sqrt{15}} $$\n化简分数：\n$$ v_g = c \\frac{2\\sqrt{3}}{\\sqrt{3}\\sqrt{5}} = c \\frac{2}{\\sqrt{5}} $$\n\n最后一步是计算相对偏差 $\\delta = (v_g/c) - 1$：\n$$ \\frac{v_g}{c} = \\frac{2}{\\sqrt{5}} $$\n$$ \\delta = \\frac{2}{\\sqrt{5}} - 1 $$\n为了将其写成单个分数：\n$$ \\delta = \\frac{2 - \\sqrt{5}}{\\sqrt{5}} $$",
            "answer": "$$\\boxed{\\frac{2 - \\sqrt{5}}{\\sqrt{5}}}$$"
        }
    ]
}