{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of von Neumann analysis is the derivation of the numerical dispersion relation, which governs how plane waves propagate on a discrete grid. This first exercise  guides you through this fundamental derivation for the 3D Yee FDTD scheme, starting from Maxwell's equations. By establishing the link between the numerical frequency $\\omega$ and wave vector $\\mathbf{k}$, you will see how the Courant-Friedrichs-Lewy (CFL) stability condition arises naturally from the requirement that the numerical frequency remains real, ensuring the amplification factor's magnitude $|G| \\le 1$. The problem concludes by applying this principle to the practical case of an anisotropic grid, a common scenario in modeling complex geometries.",
            "id": "3360079",
            "problem": "Consider the homogeneous, source-free Maxwell curl equations in vacuum,\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t}=-\\nabla\\times\\mathbf{E},\\qquad \\frac{\\partial \\mathbf{D}}{\\partial t}=\\nabla\\times\\mathbf{H},\n$$\ntogether with the constitutive relations in vacuum, $\\mathbf{D}=\\varepsilon_{0}\\mathbf{E}$ and $\\mathbf{B}=\\mu_{0}\\mathbf{H}$, where $c=1/\\sqrt{\\mu_{0}\\varepsilon_{0}}$ is the speed of light. Discretize these equations using the canonical second-order centered Yee finite-difference time-domain (FDTD) scheme on a three-dimensional rectilinear grid with spacings $\\Delta x$, $\\Delta y$, and $\\Delta z$ and leapfrog time step $\\Delta t$, with electric and magnetic fields staggered in both space and time in the standard Yee arrangement.\n\n1) By applying a discrete plane-wave ansatz of the form\n$$\n\\mathbf{E}^{n}(\\mathbf{r}_{\\mathbf{m}})=\\mathbf{E}_{0}\\,G^{n}\\,\\exp\\!\\big(i(m_{x}\\theta_{x}+m_{y}\\theta_{y}+m_{z}\\theta_{z})\\big),\\qquad\n\\mathbf{H}^{n+\\frac{1}{2}}(\\mathbf{r}_{\\mathbf{m}+\\frac{1}{2}})=\\mathbf{H}_{0}\\,G^{n+\\frac{1}{2}}\\,\\exp\\!\\big(i(m_{x}\\theta_{x}+m_{y}\\theta_{y}+m_{z}\\theta_{z})\\big),\n$$\nwith $\\theta_{x}=k_{x}\\Delta x$, $\\theta_{y}=k_{y}\\Delta y$, $\\theta_{z}=k_{z}\\Delta z$, derive the discrete numerical dispersion relation linking the discrete angular frequency $\\omega$ and wave numbers $k_{x}$, $k_{y}$, $k_{z}$ through the identification $G=\\exp(-i\\omega\\Delta t)$. Your derivation must start from the Maxwell curl equations and the Yee centered-difference approximations, and proceed through the von Neumann analysis that eliminates the field amplitudes in favor of a scalar relation between $\\omega$, $k_{x}$, $k_{y}$, $k_{z}$, and the spacings.\n\n2) Explain how the obtained numerical dispersion relation implies a stability constraint on the time step in terms of the requirement that the amplification factor have magnitude less than or equal to unity for all resolvable spatial frequencies.\n\n3) Specialize your result to the case of a mesh with $\\Delta x=\\Delta$, $\\Delta y=2\\Delta$, and $\\Delta z=3\\Delta$, and define the Courant number $\\sigma=c\\,\\Delta t/\\Delta$. What is the maximal admissible Courant number $\\sigma_{\\max}$ ensuring stability for all discrete wave numbers? Provide your final answer as a single exact value without units. Do not provide an inequality.",
            "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information to derive a unique solution. It represents a standard and fundamental analysis in computational electromagnetics. We may therefore proceed with the solution.\n\nThe solution is divided into three parts as requested by the problem statement.\n\n1) Derivation of the numerical dispersion relation.\n\nWe begin with the source-free Maxwell's curl equations in a vacuum:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t}=-\\nabla\\times\\mathbf{E}\n$$\n$$\n\\frac{\\partial \\mathbf{D}}{\\partial t}=\\nabla\\times\\mathbf{H}\n$$\nUsing the constitutive relations $\\mathbf{D}=\\varepsilon_{0}\\mathbf{E}$ and $\\mathbf{B}=\\mu_{0}\\mathbf{H}$, these become:\n$$\n\\mu_{0}\\frac{\\partial \\mathbf{H}}{\\partial t}=-\\nabla\\times\\mathbf{E}\n$$\n$$\n\\varepsilon_{0}\\frac{\\partial \\mathbf{E}}{\\partial t}=\\nabla\\times\\mathbf{H}\n$$\nThe Yee FDTD scheme discretizes these equations on a staggered grid. The leapfrog scheme updates the electric and magnetic fields at alternating half-time steps. The centered finite-difference update equations are:\n$$\n\\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^{n}}{\\Delta t} = \\frac{1}{\\varepsilon_{0}} \\hat{\\nabla} \\times \\mathbf{H}^{n+\\frac{1}{2}}\n$$\n$$\n\\frac{\\mathbf{H}^{n+\\frac{1}{2}} - \\mathbf{H}^{n-\\frac{1}{2}}}{\\Delta t} = -\\frac{1}{\\mu_{0}} \\hat{\\nabla} \\times \\mathbf{E}^{n}\n$$\nwhere $\\hat{\\nabla}\\times$ is the discrete curl operator, and the fields are evaluated at their respective staggered locations in space and time.\n\nTo perform the von Neumann stability analysis, we substitute the discrete plane-wave ansatz given in the problem:\n$$\n\\mathbf{E}^{n}(\\mathbf{r}_{\\mathbf{m}}) = \\mathbf{E}_{0}\\,G^{n}\\,\\exp\\!\\big(i(m_{x}k_{x}\\Delta x+m_{y}k_{y}\\Delta y+m_{z}k_{z}\\Delta z)\\big)\n$$\n$$\n\\mathbf{H}^{n+\\frac{1}{2}}(\\mathbf{r}_{\\mathbf{m}+\\frac{1}{2}}) = \\mathbf{H}_{0}\\,G^{n+\\frac{1}{2}}\\,\\exp\\!\\big(i(m_{x}k_{x}\\Delta x+m_{y}k_{y}\\Delta y+m_{z}k_{z}\\Delta z)\\big)\n$$\nThe action of the centered spatial difference operators on this ansatz transforms them into multiplication by complex exponential factors. For example, for the $x$-component of the curl operator acting on the $E_z$ field component to update $H_y$:\n$$\n(\\hat{\\nabla}\\times\\mathbf{E})_y \\propto \\frac{E_x|_{k+1/2}-E_x|_{k-1/2}}{\\Delta z} - \\frac{E_z|_{i+1/2}-E_z|_{i-1/2}}{\\Delta x}\n$$\nSubstituting the ansatz for $E_z$ into the second term gives:\n$$\n\\frac{E_{0,z} G^n e^{i k_x (i+1/2)\\Delta x} \\dots - E_{0,z} G^n e^{i k_x (i-1/2)\\Delta x} \\dots}{\\Delta x} = \\frac{E_z^n}{\\Delta x} \\left( e^{i k_x \\Delta x / 2} - e^{-i k_x \\Delta x / 2} \\right) = \\frac{2i}{\\Delta x}\\sin\\left(\\frac{k_x\\Delta x}{2}\\right)E_z^n\n$$\nThus, the discrete curl operator $\\hat{\\nabla}\\times$ acting on the plane-wave ansatz is equivalent to multiplication by the vector operator $i\\mathbf{k}_{\\text{eff}}$, where $\\mathbf{k}_{\\text{eff}}$ is the effective numerical wave vector with components:\n$$\nk_{\\text{eff},x} = \\frac{2}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right), \\quad k_{\\text{eff},y} = \\frac{2}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right), \\quad k_{\\text{eff},z} = \\frac{2}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\n$$\nThe action of the time-stepping operators on the ansatz is:\n$$\n\\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^{n}}{\\Delta t} \\rightarrow \\frac{G^{n+1}\\mathbf{E}_0 - G^{n}\\mathbf{E}_0}{\\Delta t} \\dots = \\frac{G-1}{\\Delta t} \\mathbf{E}^n\n$$\n$$\n\\frac{\\mathbf{H}^{n+1/2} - \\mathbf{H}^{n-\\frac{1}{2}}}{\\Delta t} \\rightarrow \\frac{G^{n+1/2}\\mathbf{H}_0 - G^{n-1/2}\\mathbf{H}_0}{\\Delta t} \\dots = \\frac{G^{1/2}-G^{-1/2}}{G^{-n+1/2}\\Delta t} \\mathbf{H}^{n-1/2}\n$$\nA more direct approach is to substitute the ansatz into the full update equations. For the electric field update:\n$$\n\\frac{\\mathbf{E}_{0}G^{n+1} - \\mathbf{E}_{0}G^{n}}{\\Delta t} = \\frac{1}{\\varepsilon_{0}} (i\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0}) G^{n+\\frac{1}{2}}\n$$\nDividing by $G^{n}$ and common spatial terms:\n$$\n\\frac{\\mathbf{E}_{0}(G - 1)}{\\Delta t} = \\frac{i}{\\varepsilon_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0}) G^{\\frac{1}{2}} \\implies \\mathbf{E}_{0}(G^{\\frac{1}{2}} - G^{-\\frac{1}{2}}) = \\frac{i\\Delta t}{\\varepsilon_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0})\n$$\nFor the magnetic field update:\n$$\n\\frac{\\mathbf{H}_{0}G^{n+\\frac{1}{2}} - \\mathbf{H}_{0}G^{n-\\frac{1}{2}}}{\\Delta t} = -\\frac{1}{\\mu_{0}} (i\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) G^{n}\n$$\nDividing by $G^{n-1/2}$:\n$$\n\\frac{\\mathbf{H}_{0}(G - 1)}{\\Delta t} = -\\frac{i}{\\mu_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) G^{\\frac{1}{2}} \\implies \\mathbf{H}_{0}(G^{\\frac{1}{2}} - G^{-\\frac{1}{2}}) = -\\frac{i\\Delta t}{\\mu_{0}} (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0})\n$$\nLet the term $(G^{\\frac{1}{2}} - G^{-\\frac{1}{2}})$ be denoted by $A$. We have a system of two algebraic vector equations:\n$$\n(1) \\quad \\varepsilon_{0} A \\mathbf{E}_{0} = i\\Delta t (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{H}_{0})\n$$\n$$\n(2) \\quad \\mu_{0} A \\mathbf{H}_{0} = -i\\Delta t (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0})\n$$\nWe eliminate $\\mathbf{H}_{0}$ by substituting from $(2)$ into $(1)$. From $(2)$, $\\mathbf{H}_{0} = -\\frac{i\\Delta t}{\\mu_{0}A}(\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0})$.\n$$\n\\varepsilon_{0} A \\mathbf{E}_{0} = i\\Delta t \\left( \\mathbf{k}_{\\text{eff}} \\times \\left( -\\frac{i\\Delta t}{\\mu_{0}A}(\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) \\right) \\right) = \\frac{(\\Delta t)^2}{\\mu_0 A} \\left( \\mathbf{k}_{\\text{eff}} \\times (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) \\right)\n$$\nUsing the vector identity $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = \\mathbf{b}(\\mathbf{a} \\cdot \\mathbf{c}) - \\mathbf{c}(\\mathbf{a} \\cdot \\mathbf{b})$ and the fact that for a transverse wave $\\mathbf{k}_{\\text{eff}} \\cdot \\mathbf{E}_{0} = 0$, we have $\\mathbf{k}_{\\text{eff}} \\times (\\mathbf{k}_{\\text{eff}} \\times \\mathbf{E}_{0}) = -k_{\\text{eff}}^2 \\mathbf{E}_{0}$.\n$$\n\\varepsilon_{0} A \\mathbf{E}_{0} = -\\frac{(\\Delta t)^2 k_{\\text{eff}}^2}{\\mu_0 A} \\mathbf{E}_{0}\n$$\nSince $\\mathbf{E}_0$ is non-zero, we can cancel it:\n$$\n\\mu_0 \\varepsilon_0 A^2 = -(\\Delta t)^2 k_{\\text{eff}}^2 \\implies \\frac{A^2}{c^2} = -(\\Delta t)^2 k_{\\text{eff}}^2\n$$\nNow, substitute $G = \\exp(-i\\omega\\Delta t)$. The term $A = G^{\\frac{1}{2}} - G^{-\\frac{1}{2}} = \\exp(-i\\omega\\Delta t/2) - \\exp(i\\omega\\Delta t/2) = -2i\\sin(\\omega\\Delta t/2)$.\nSo, $A^2 = -4\\sin^2(\\omega\\Delta t/2)$.\n$$\n\\frac{-4\\sin^2(\\omega\\Delta t/2)}{c^2} = -(\\Delta t)^2 k_{\\text{eff}}^2\n$$\n$$\n\\left(\\frac{2}{c \\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)\\right)^2 = k_{\\text{eff}}^2 = \\left(\\frac{2}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{2}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{2}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right)^2\n$$\nSimplifying, we obtain the numerical dispersion relation:\n$$\n\\left(\\frac{1}{c \\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)\\right)^2 = \\left(\\frac{1}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right)^2\n$$\n\n2) Implication for the stability constraint.\n\nFor the numerical scheme to be stable, the magnitude of the amplification factor $G$ must be less than or equal to one, i.e., $|G| \\le 1$, for all possible modes. If $|G|>1$, any numerical error or field component will grow exponentially in time, rendering the simulation useless.\nThe relation $G=\\exp(-i\\omega\\Delta t)$ connects $G$ to the numerical frequency $\\omega$. If $\\omega$ is purely real, then $|G|=|\\exp(-i\\omega\\Delta t)|=1$. If $\\omega$ has an imaginary part, $\\omega = \\omega_R + i\\omega_I$, then $|G|=|\\exp(-i(\\omega_R+i\\omega_I)\\Delta t)| = |\\exp(\\omega_I \\Delta t)\\exp(-i\\omega_R \\Delta t)| = \\exp(\\omega_I \\Delta t)$. For stability ($|G|\\le 1$), we must have $\\omega_I \\le 0$. A solution with $\\omega_I < 0$ is a decaying, non-physical mode, but it is stable. An exponentially growing mode ($\\omega_I > 0$) corresponds to instability.\n\nThe dispersion relation can be rearranged to solve for $\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)$:\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\pm c\\Delta t \\sqrt{\\left(\\frac{1}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{1}{\\Delta z}\\sin\\left(\\frac{k_z \\Delta z}{2}\\right)\\right)^2}\n$$\nFor $\\omega$ to be real, the term $\\sin(\\omega\\Delta t/2)$ must be a real number with a magnitude less than or equal to $1$. The RHS of the equation is always real. Therefore, the stability condition reduces to:\n$$\n\\left| \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\right| \\le 1\n$$\nThis implies:\n$$\nc\\Delta t \\sqrt{\\left(\\frac{\\sin(k_x \\Delta x/2)}{\\Delta x}\\right)^2 + \\left(\\frac{\\sin(k_y \\Delta y/2)}{\\Delta y}\\right)^2 + \\left(\\frac{\\sin(k_z \\Delta z/2)}{\\Delta z}\\right)^2} \\le 1\n$$\nThis inequality must hold for all spatial frequencies $(k_x, k_y, k_z)$ that the grid can resolve. To ensure this, we must check the \"worst case\" that maximizes the left-hand side. The sine terms are maximized and equal to $1$ at the Nyquist frequencies, where $k_j \\Delta j = \\pi$ for $j \\in \\{x,y,z\\}$. Substituting $\\sin(k_j\\Delta j/2) = \\sin(\\pi/2)=1$ for all components yields the most restrictive condition:\n$$\nc\\Delta t \\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^2 + \\left(\\frac{1}{\\Delta y}\\right)^2 + \\left(\\frac{1}{\\Delta z}\\right)^2} \\le 1\n$$\nThis is the well-known Courant-Friedrichs-Lewy (CFL) stability condition for the 3D FDTD method.\n\n3) Maximal Courant number for the specified mesh.\n\nWe are given the mesh spacings $\\Delta x = \\Delta$, $\\Delta y = 2\\Delta$, and $\\Delta z = 3\\Delta$, and the Courant number is defined as $\\sigma = c\\Delta t/\\Delta$. We substitute these into the general stability condition derived in part 2):\n$$\nc\\Delta t \\sqrt{\\frac{1}{(\\Delta)^2} + \\frac{1}{(2\\Delta)^2} + \\frac{1}{(3\\Delta)^2}} \\le 1\n$$\nFactor out $1/\\Delta$ from the square root:\n$$\n\\frac{c\\Delta t}{\\Delta} \\sqrt{1 + \\frac{1}{4} + \\frac{1}{9}} \\le 1\n$$\nSubstitute the definition of the Courant number $\\sigma$:\n$$\n\\sigma \\sqrt{1 + \\frac{1}{4} + \\frac{1}{9}} \\le 1\n$$\nNow, we simplify the expression under the square root:\n$$\n1 + \\frac{1}{4} + \\frac{1}{9} = \\frac{36}{36} + \\frac{9}{36} + \\frac{4}{36} = \\frac{49}{36}\n$$\nThe inequality becomes:\n$$\n\\sigma \\sqrt{\\frac{49}{36}} \\le 1 \\implies \\sigma \\frac{7}{6} \\le 1\n$$\nThis gives the stability constraint on $\\sigma$:\n$$\n\\sigma \\le \\frac{6}{7}\n$$\nThe maximal admissible Courant number, $\\sigma_{\\max}$, is the value at the boundary of this inequality. Therefore,\n$$\n\\sigma_{\\max} = \\frac{6}{7}\n$$",
            "answer": "$$\\boxed{\\frac{6}{7}}$$"
        },
        {
            "introduction": "Having established the stability boundary, we now venture into the unstable regime to understand the consequences of violating it. This practice  investigates the behavior of the 1D FDTD scheme when the Courant number exceeds the CFL limit, leading to an amplification factor $|G| \\gt 1$. You will derive the temporal growth rate of the instability, which quantifies the exponential amplification of numerical errors. This exercise provides a concrete understanding of why instability is catastrophic for a simulation and reveals which wave modes are most susceptible to this rapid, non-physical growth.",
            "id": "3360162",
            "problem": "Consider the one-dimensional free-space Maxwell equations for a transverse electromagnetic wave, with electric field component $E_{y}$ and magnetic field component $H_{z}$, discretized using the standard staggered Yee scheme of the Finite-Difference Time-Domain (FDTD) method. Let the spatial grid spacing be $\\Delta x$, the time step be $\\Delta t$, the permittivity be $\\epsilon$, the permeability be $\\mu$, and the speed of light be $c = 1/\\sqrt{\\epsilon \\mu}$. The leapfrog updates are\n$$\nH_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) = H_{z}^{n-\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\left[E_{y}^{n}(m+1) - E_{y}^{n}(m)\\right],\n$$\n$$\nE_{y}^{n+1}(m) = E_{y}^{n}(m) - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\left[H_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) - H_{z}^{n+\\frac{1}{2}}\\!\\left(m-\\frac{1}{2}\\right)\\right].\n$$\nPerform a von Neumann (Fourier) stability analysis by assuming discrete plane-wave solutions of the form\n$$\nE_{y}^{n}(m) = \\tilde{E}\\,\\exp\\!\\left(i\\,m\\,\\kappa\\right)\\exp\\!\\left(i\\,n\\,\\Omega\\right),\\qquad\nH_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) = \\tilde{H}\\,\\exp\\!\\left(i\\left(m+\\tfrac{1}{2}\\right)\\kappa\\right)\\exp\\!\\left(i\\left(n+\\tfrac{1}{2}\\right)\\Omega\\right),\n$$\nwhere $\\kappa = k\\,\\Delta x$ is the dimensionless wavenumber and $\\Omega = \\omega\\,\\Delta t$ is the dimensionless angular frequency. Let the Courant-Friedrichs-Lewy (CFL) number be $S = c\\,\\Delta t/\\Delta x$. Suppose the time step slightly violates the CFL bound, so that\n$$\n\\Delta t = (1+\\delta)\\frac{\\Delta x}{c},\\quad \\delta > 0,\n$$\ni.e., $S = 1+\\delta > 1$. Define the temporal instability growth rate $\\gamma$ as the real number such that the unstable mode amplitude scales as $\\exp(\\gamma\\,t)$ in continuous time $t = n\\,\\Delta t$.\n\nOver all discrete spatial wavenumbers $\\kappa \\in [0,\\pi]$, determine the maximum temporal instability growth rate $\\gamma_{\\max}$ for this one-dimensional Yee scheme in free space, expressed as a closed-form analytic expression in terms of $c$, $\\Delta x$, and $\\delta$. Express your final answer in $\\mathrm{s}^{-1}$.",
            "solution": "The problem asks for the maximum temporal instability growth rate, $\\gamma_{\\max}$, for the one-dimensional Yee FDTD scheme when the Courant-Friedrichs-Lewy (CFL) stability condition is violated. The analysis will be performed using the von Neumann (Fourier) method.\n\nThe starting point is the set of finite-difference time-domain (FDTD) update equations for the transverse electric field component $E_{y}$ and magnetic field component $H_{z}$:\n$$\nH_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) = H_{z}^{n-\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\left[E_{y}^{n}(m+1) - E_{y}^{n}(m)\\right]\n$$\n$$\nE_{y}^{n+1}(m) = E_{y}^{n}(m) - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\left[H_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) - H_{z}^{n+\\frac{1}{2}}\\!\\left(m-\\frac{1}{2}\\right)\\right]\n$$\nHere, $m$ is the spatial index and $n$ is the temporal index. $\\Delta x$ is the spatial step, $\\Delta t$ is the time step, $\\epsilon$ is the permittivity, and $\\mu$ is the permeability.\n\nWe assume discrete plane-wave solutions (a single Fourier mode) of the form provided:\n$$\nE_{y}^{n}(m) = \\tilde{E}\\,\\exp\\!\\left(i\\,m\\,\\kappa\\right)\\exp\\!\\left(i\\,n\\,\\Omega\\right)\n$$\n$$\nH_{z}^{n+\\frac{1}{2}}\\!\\left(m+\\frac{1}{2}\\right) = \\tilde{H}\\,\\exp\\!\\left(i\\left(m+\\tfrac{1}{2}\\right)\\kappa\\right)\\exp\\!\\left(i\\left(n+\\tfrac{1}{2}\\right)\\Omega\\right)\n$$\nwhere $\\tilde{E}$ and $\\tilde{H}$ are complex amplitudes, $\\kappa = k\\,\\Delta x$ is the dimensionless wavenumber, and $\\Omega = \\omega\\,\\Delta t$ is the dimensionless frequency.\n\nSubstituting these ansatz forms into the FDTD update equations allows us to transform the difference equations into algebraic equations.\n\nFor the $H_z$ update equation, after substituting the plane-wave forms and dividing by the common factor $\\exp(i\\,m\\,\\kappa)\\exp(i\\,n\\,\\Omega)$, we get:\n$$\n\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\exp\\!\\left(i\\frac{\\Omega}{2}\\right) = \\tilde{H}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\exp\\!\\left(-i\\frac{\\Omega}{2}\\right) - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\tilde{E}\\left[\\exp(i\\kappa) - 1\\right]\n$$\nRearranging terms:\n$$\n\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\left( \\exp\\!\\left(i\\frac{\\Omega}{2}\\right) - \\exp\\!\\left(-i\\frac{\\Omega}{2}\\right) \\right) = - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\tilde{E}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\left( \\exp\\!\\left(i\\frac{\\kappa}{2}\\right) - \\exp\\!\\left(-i\\frac{\\kappa}{2}\\right) \\right)\n$$\nUsing Euler's formula, $\\sin(x) = (e^{ix}-e^{-ix})/(2i)$:\n$$\n\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\left( 2i\\sin\\!\\left(\\frac{\\Omega}{2}\\right) \\right) = - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\tilde{E}\\,\\exp\\!\\left(i\\frac{\\kappa}{2}\\right)\\left( 2i\\sin\\!\\left(\\frac{\\kappa}{2}\\right) \\right)\n$$\nThis simplifies to a linear equation relating $\\tilde{E}$ and $\\tilde{H}$:\n$$\n\\sin\\!\\left(\\frac{\\Omega}{2}\\right)\\tilde{H} = - \\frac{\\Delta t}{\\mu\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\tilde{E}\n$$\n\nSimilarly, for the $E_y$ update equation, substituting the plane-wave forms yields:\n$$\n\\tilde{E}\\,\\exp(i\\Omega) = \\tilde{E} - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\Omega}{2}\\right)\\left[\\exp\\!\\left(i\\frac{\\kappa}{2}\\right) - \\exp\\!\\left(-i\\frac{\\kappa}{2}\\right)\\right]\n$$\nRearranging and using Euler's formula:\n$$\n\\tilde{E}\\left(\\exp(i\\Omega) - 1\\right) = - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\Omega}{2}\\right)\\left(2i\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\n$$\n\\tilde{E}\\,\\exp\\!\\left(i\\frac{\\Omega}{2}\\right)\\left(\\exp\\!\\left(i\\frac{\\Omega}{2}\\right) - \\exp\\!\\left(-i\\frac{\\Omega}{2}\\right)\\right) = - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\tilde{H}\\,\\exp\\!\\left(i\\frac{\\Omega}{2}\\right)\\left(2i\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\nThis simplifies to the second linear equation:\n$$\n\\sin\\!\\left(\\frac{\\Omega}{2}\\right)\\tilde{E} = - \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\tilde{H}\n$$\n\nWe now have a system of two homogeneous linear equations for $\\tilde{E}$ and $\\tilde{H}$. For a non-trivial solution to exist, the determinant of the coefficient matrix must be zero:\n$$\n\\begin{vmatrix} \\frac{\\Delta t}{\\mu\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right) & \\sin\\!\\left(\\frac{\\Omega}{2}\\right) \\\\ \\sin\\!\\left(\\frac{\\Omega}{2}\\right) & \\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right) \\end{vmatrix} = 0\n$$\n$$\n\\left(\\frac{\\Delta t}{\\mu\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right)\\left(\\frac{\\Delta t}{\\epsilon\\,\\Delta x}\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right) - \\sin^2\\!\\left(\\frac{\\Omega}{2}\\right) = 0\n$$\nUsing the relation for the speed of light $c = 1/\\sqrt{\\epsilon\\mu}$ and the definition of the Courant-Friedrichs-Lewy (CFL) number $S = c\\,\\Delta t/\\Delta x$, this simplifies to the numerical dispersion relation for the 1D Yee scheme:\n$$\n\\sin^2\\!\\left(\\frac{\\Omega}{2}\\right) = \\frac{c^2(\\Delta t)^2}{(\\Delta x)^2}\\sin^2\\!\\left(\\frac{\\kappa}{2}\\right) = S^2\\sin^2\\!\\left(\\frac{\\kappa}{2}\\right)\n$$\nThe amplification factor per time step is $G = \\exp(i\\Omega)$. For stability, we require $|G| \\le 1$. Let $X = \\exp(i\\Omega/2)$, so that $G = X^2$. The dispersion relation gives $\\sin(\\Omega/2) = \\pm S\\sin(\\kappa/2)$. Using $\\sin(\\theta) = (e^{i\\theta}-e^{-i\\theta})/(2i)$, we can write:\n$$\n\\frac{X - X^{-1}}{2i} = \\pm S\\sin\\!\\left(\\frac{\\kappa}{2}\\right) \\implies X^2 - \\left(\\pm 2iS\\sin\\!\\left(\\frac{\\kappa}{2}\\right)\\right)X - 1 = 0\n$$\nThis is a quadratic equation for $X$, with solutions:\n$$\nX = \\pm iS\\sin\\!\\left(\\frac{\\kappa}{2}\\right) \\pm \\sqrt{1 - S^2\\sin^2\\!\\left(\\frac{\\kappa}{2}\\right)}\n$$\nFor the scheme to be stable, all solutions for $X$ must have magnitude $|X| \\le 1$. If $S^2\\sin^2(\\kappa/2) \\le 1$, the term under the square root is non-negative, and $|X|^2 = (S\\sin(\\kappa/2))^2 + (1 - S^2\\sin^2(\\kappa/2)) = 1$. The scheme is stable (and non-dissipative). This must hold for all $\\kappa \\in [0, \\pi]$. Since $\\max_{\\kappa \\in [0, \\pi]} \\sin^2(\\kappa/2) = 1$ (at $\\kappa=\\pi$), the stability condition is $S \\le 1$.\n\nThe problem states that this condition is violated, with $S=1+\\delta > 1$. In this case, there exists a range of wavenumbers $\\kappa$ for which $S^2\\sin^2(\\kappa/2) > 1$. For these wavenumbers, the term under the square root is negative, leading to an unstable mode. Let $A = S\\sin(\\kappa/2)$. For $A>1$:\n$$\nX = \\pm iA \\pm i\\sqrt{A^2 - 1} = i\\left(\\pm A \\pm \\sqrt{A^2-1}\\right)\n$$\nThe solutions for $X$ are purely imaginary. The unstable mode corresponds to the solution with magnitude greater than $1$. The four solutions for $X$ have magnitudes $|A \\pm \\sqrt{A^2-1}|$. The two unstable solutions have magnitude $|X| = A + \\sqrt{A^2-1}$.\nThe magnitude of the amplification factor per full time step, $|G|$, is $|X|^2$:\n$$\n|G| = \\left(A + \\sqrt{A^2-1}\\right)^2\n$$\nThe amplitude of an unstable mode grows as $|G|^n$ over $n$ time steps. We relate this to the continuous-time growth rate $\\gamma$ through the amplitude scaling $\\exp(\\gamma t) = \\exp(\\gamma n \\Delta t)$.\n$$\n\\exp(\\gamma n \\Delta t) = (|G|)^n \\implies \\exp(\\gamma \\Delta t) = |G|\n$$\nTaking the natural logarithm, we find $\\gamma$:\n$$\n\\gamma \\Delta t = \\ln|G| = \\ln\\left[\\left(A + \\sqrt{A^2-1}\\right)^2\\right] = 2\\ln\\left(A + \\sqrt{A^2-1}\\right)\n$$\nUsing the identity $\\arccosh(x) = \\ln(x+\\sqrt{x^2-1})$ for $x \\ge 1$:\n$$\n\\gamma \\Delta t = 2\\,\\arccosh(A) \\implies \\gamma = \\frac{2}{\\Delta t}\\arccosh\\left(S\\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\nThis expression gives the growth rate as a function of the discrete wavenumber $\\kappa$. To find the maximum growth rate, $\\gamma_{\\max}$, we must maximize this expression over all possible wavenumbers, $\\kappa \\in [0, \\pi]$. The function $\\arccosh(x)$ is monotonically increasing for $x \\ge 1$. Therefore, we need to maximize its argument, $S\\sin(\\kappa/2)$. This occurs when $\\sin(\\kappa/2)$ is maximum, which is at $\\kappa=\\pi$, where $\\sin(\\pi/2)=1$.\nAt this wavenumber, the argument is $S$. The maximum growth rate is thus:\n$$\n\\gamma_{\\max} = \\frac{2}{\\Delta t}\\arccosh(S)\n$$\nFinally, we express this in terms of the given parameters $c$, $\\Delta x$, and $\\delta$. We are given $S=1+\\delta$ and $\\Delta t = (1+\\delta) \\frac{\\Delta x}{c}$. Substituting these into the expression for $\\gamma_{\\max}$:\n$$\n\\gamma_{\\max} = \\frac{2}{(1+\\delta)\\frac{\\Delta x}{c}}\\arccosh(1+\\delta)\n$$\n$$\n\\gamma_{\\max} = \\frac{2c}{(1+\\delta)\\Delta x}\\arccosh(1+\\delta)\n$$\nThe units are inverse seconds, as required.",
            "answer": "$$\\boxed{\\frac{2c}{(1+\\delta)\\Delta x}\\arccosh(1+\\delta)}$$"
        },
        {
            "introduction": "Our final practice moves beyond merely satisfying the stability condition to actively using it as a constraint in numerical scheme design. This exercise  explores the trade-off between stability and numerical accuracy, specifically focusing on the numerical phase error caused by dispersion. You will analyze how the Courant number $S$ affects the phase velocity of simulated waves and determine an optimal value, $S^{\\star}$, that minimizes the peak dispersion error across the Brillouin zone. This advanced problem illustrates how a deep understanding of stability analysis is crucial for designing FDTD simulations that are not only stable but also highly accurate.",
            "id": "3360115",
            "problem": "Consider the standard Yee staggered Finite-Difference Time-Domain (FDTD) scheme for the transverse electric polarization with nonzero $E_{z}$, $H_{x}$, and $H_{y}$ fields in vacuum in two spatial dimensions on a uniform square grid of spacing $h$ and time step $\\Delta t$. Let the material parameters be permittivity $\\varepsilon$, permeability $\\mu$, and wave speed $c = 1/\\sqrt{\\mu \\varepsilon}$. Define the Courant number $S = c\\,\\Delta t / h$. Adopt the von Neumann plane-wave ansatz for the fields with wavevector $\\mathbf{k} = (k_{x}, k_{y})$ and angular frequency $\\omega$, and define the amplification factor $G(\\mathbf{k}; S)$ by the time advance of the field phasor.\n\nUsing a von Neumann stability and dispersion analysis starting from Maxwellâ€™s equations in vacuum and their second-order central-difference Yee discretization, do the following:\n\n- Derive the discrete dispersion relation that connects $\\omega$, $k_{x}$, and $k_{y}$ for the Yee scheme, and use it to express $|G(\\mathbf{k}; S)|$.\n- Impose the stability constraint $|G(\\mathbf{k}; S)| \\le 1$ for all $\\mathbf{k}$ in the first Brillouin zone.\n- With $\\alpha = k_{x} h/2$ and $\\beta = k_{y} h/2$, define the numerical phase velocity $v_{p,\\mathrm{num}}(\\alpha,\\beta; S) = \\omega/\\|\\mathbf{k}\\|$ and the corresponding relative phase error\n$$\n\\mathcal{E}(\\alpha,\\beta; S) \\equiv \\frac{v_{p,\\mathrm{num}}(\\alpha,\\beta; S)}{c} - 1,\n$$\nfor $(\\alpha,\\beta)$ ranging over the Brillouin zone $\\alpha, \\beta \\in [0, \\pi/2]$, excluding the origin where $\\|\\mathbf{k}\\| = 0$.\n- Design the Courant number $S^{\\star}$ that minimizes the peak numerical phase error magnitude\n$$\n\\Phi(S) \\equiv \\sup_{(\\alpha,\\beta)\\in (0,\\pi/2]^{2}} \\left| \\mathcal{E}(\\alpha,\\beta; S) \\right|\n$$\nsubject to the stability constraint you obtained.\n\nProvide your final answer as a single closed-form expression for $S^{\\star}$ (dimensionless). Do not include units. No numerical rounding is required.",
            "solution": "The user wants to find the optimal Courant number $S^{\\star}$ for the 2D Transverse Electric (TE) Finite-Difference Time-Domain (FDTD) method that minimizes the peak numerical phase error.\n\nThe problem will be solved in the following steps:\n1.  Discretize Maxwell's equations for the 2D TE case using the Yee scheme.\n2.  Apply the von Neumann plane-wave ansatz to derive the numerical dispersion relation.\n3.  From the dispersion relation, determine the stability condition for the Courant number $S$.\n4.  Express the numerical phase velocity $v_{p,\\text{num}}$ and the relative phase error $\\mathcal{E}$.\n5.  Formulate the optimization problem for minimizing the peak phase error magnitude $\\Phi(S)$.\n6.  Solve the optimization problem to find the optimal Courant number $S^{\\star}$.\n\n**Step 1: FDTD Discretization of Maxwell's Equations**\n\nFor a 2D TE polarization with field components $E_z(x,y,t)$, $H_x(x,y,t)$, and $H_y(x,y,t)$ in a vacuum with permittivity $\\varepsilon$ and permeability $\\mu$, Maxwell's curl equations are:\n$$ \\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon} \\left( \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y} \\right) $$\n$$ \\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu} \\frac{\\partial E_z}{\\partial y} $$\n$$ \\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu} \\frac{\\partial E_z}{\\partial x} $$\n\nUsing the Yee staggered grid with uniform spacing $h$ in both $x$ and $y$ directions and a time step $\\Delta t$, the fields are located at discrete points $(i, j, n)$ corresponding to $(ih, jh, n\\Delta t)$. The second-order central difference discretization is:\n$$ \\frac{E_z^{n+1}_{i,j} - E_z^n_{i,j}}{\\Delta t} = \\frac{1}{\\varepsilon} \\left( \\frac{H_y^{n+1/2}_{i+1/2,j} - H_y^{n+1/2}_{i-1/2,j}}{h} - \\frac{H_x^{n+1/2}_{i,j+1/2} - H_x^{n+1/2}_{i,j-1/2}}{h} \\right) $$\n$$ \\frac{H_x^{n+1/2}_{i,j+1/2} - H_x^{n-1/2}_{i,j+1/2}}{\\Delta t} = -\\frac{1}{\\mu} \\frac{E_z^n_{i,j+1} - E_z^n_{i,j}}{h} $$\n$$ \\frac{H_y^{n+1/2}_{i+1/2,j} - H_y^{n-1/2}_{i+1/2,j}}{\\Delta t} = \\frac{1}{\\mu} \\frac{E_z^n_{i+1,j} - E_z^n_{i,j}}{h} $$\n\n**Step 2: Numerical Dispersion Relation and Amplification Factor**\n\nWe apply the von Neumann ansatz, assuming a plane-wave solution of the form:\n$$ F^{n}_{i,j} = \\tilde{F} \\exp(i(\\omega n \\Delta t - k_x i h - k_y j h)) $$\nwhere $F$ represents any field component $E_z$, $H_x$, or $H_y$, and $\\tilde{F}$ is its complex amplitude. Substituting this ansatz into the FDTD equations and canceling common terms leads to a system of equations for the amplitudes $(\\tilde{E}_z, \\tilde{H}_x, \\tilde{H}_y)$.\n\nFor the $H_x$ equation:\n$$ \\tilde{H}_x \\frac{\\exp(i\\omega\\Delta t/2) - \\exp(-i\\omega\\Delta t/2)}{\\Delta t} = -\\frac{\\tilde{E}_z}{\\mu h} (\\exp(-ik_y h) - 1) $$\nUsing the central difference operator on the staggered grid, this simplifies to:\n$$ (1) \\quad \\tilde{H}_x \\sin(\\omega\\Delta t/2) = \\frac{\\Delta t}{\\mu h} \\tilde{E}_z \\sin(k_y h/2) $$\n\nFor the $H_y$ equation, a similar process yields:\n$$ (2) \\quad \\tilde{H}_y \\sin(\\omega\\Delta t/2) = -\\frac{\\Delta t}{\\mu h} \\tilde{E}_z \\sin(k_x h/2) $$\n\nFor the $E_z$ equation, we have:\n$$ \\tilde{E}_z \\frac{\\exp(i\\omega\\Delta t/2) - \\exp(-i\\omega\\Delta t/2)}{\\Delta t} = \\frac{1}{\\varepsilon h} ( \\tilde{H}_y (\\exp(-ik_x h/2) - \\exp(ik_x h/2)) - \\tilde{H}_x (\\exp(-ik_y h/2) - \\exp(ik_y h/2)) ) $$\n$$ (3) \\quad \\tilde{E}_z \\sin(\\omega\\Delta t/2) = \\frac{\\Delta t}{\\varepsilon h} (\\tilde{H}_x \\sin(k_y h/2) - \\tilde{H}_y \\sin(k_x h/2)) $$\n\nSubstituting (1) and (2) into (3) yields the numerical dispersion relation:\n$$ \\sin^2(\\omega \\Delta t / 2) = \\frac{(\\Delta t)^2}{\\mu\\varepsilon h^2} \\left( \\sin^2(k_x h/2) + \\sin^2(k_y h/2) \\right) $$\nUsing the definitions $c=1/\\sqrt{\\mu\\varepsilon}$ and Courant number $S=c\\Delta t/h$, this becomes:\n$$ \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) = S^2 \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right] $$\nThe amplification factor $G$ is defined by the time-advance factor $G=\\exp(i\\omega\\Delta t)$. For the scheme to be stable, $\\omega$ must be real, which makes $|G|=1$. This requires the right-hand side of the dispersion relation to be less than or equal to $1$. If it is greater than $1$, $\\omega$ becomes complex, leading to an amplification factor with magnitude $|G|>1$ and thus instability. Thus, for stable operation, $|G(\\mathbf{k}; S)|=1$.\n\n**Step 3: Stability Condition**\n\nFor stability, we require $|G| \\le 1$, which implies $\\omega$ must be real. This requires that the argument of the $\\arcsin$ function derived from the dispersion relation is real and has a magnitude no greater than $1$:\n$$ S^2 \\left[ \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right) \\right] \\le 1 $$\nThis inequality must hold for all possible wavevectors $\\mathbf{k}=(k_x, k_y)$. The term in the brackets is maximized when $k_x h/2 = \\pi/2$ and $k_y h/2 = \\pi/2$, which correspond to the highest frequency waves resolvable on the grid (the Nyquist limit). At this point, $\\sin^2(k_x h/2) = 1$ and $\\sin^2(k_y h/2) = 1$. The maximum value of the bracketed term is $1^2+1^2=2$.\nTherefore, the stability condition is:\n$$ S^2 \\cdot 2 \\le 1 \\implies S \\le \\frac{1}{\\sqrt{2}} $$\n\n**Step 4: Numerical Phase Velocity and Error**\n\nThe numerical angular frequency $\\omega$ is obtained from the dispersion relation:\n$$ \\omega = \\frac{2}{\\Delta t} \\arcsin\\left( S \\sqrt{\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)} \\right) $$\nThe magnitude of the wavevector is $\\|\\mathbf{k}\\| = \\sqrt{k_x^2 + k_y^2}$. The numerical phase velocity is $v_{p,\\text{num}} = \\omega / \\|\\mathbf{k}\\|$.\nUsing the normalized wave numbers $\\alpha = k_x h/2$ and $\\beta = k_y h/2$, we have $\\|\\mathbf{k}\\| = \\frac{2}{h}\\sqrt{\\alpha^2+\\beta^2}$.\nThe velocity ratio is:\n$$ \\frac{v_{p,\\text{num}}}{c} = \\frac{\\omega}{c \\|\\mathbf{k}\\|} = \\frac{1}{c \\frac{2}{h}\\sqrt{\\alpha^2+\\beta^2}} \\frac{2}{\\Delta t} \\arcsin\\left(S \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}\\right) $$\n$$ \\frac{v_{p,\\text{num}}}{c} = \\frac{h}{c\\Delta t} \\frac{\\arcsin\\left(S \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}\\right)}{\\sqrt{\\alpha^2 + \\beta^2}} = \\frac{1}{S} \\frac{\\arcsin\\left(S \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}\\right)}{\\sqrt{\\alpha^2 + \\beta^2}} $$\nLet $F(\\alpha, \\beta; S) = v_{p,\\text{num}}/c$. The relative phase error is $\\mathcal{E}(\\alpha, \\beta; S) = F(\\alpha, \\beta; S) - 1$.\nA known property of the 2D Yee scheme is that the numerical phase velocity is always less than or equal to the speed of light $c$ in the stable regime. Thus, $F(\\alpha, \\beta; S) \\le 1$, and the error $\\mathcal{E}$ is always non-positive. This can be proven by showing that $\\arcsin(SA) \\le SB$, where $A=\\sqrt{\\sin^2\\alpha+\\sin^2\\beta}$ and $B=\\sqrt{\\alpha^2+\\beta^2}$. Since $\\mathcal{E} \\le 0$, the error magnitude is $|\\mathcal{E}| = -\\mathcal{E} = 1 - F(\\alpha, \\beta; S)$.\n\n**Step 5 & 6: Optimization Problem and Solution**\n\nWe want to find $S^{\\star}$ that minimizes the peak error magnitude $\\Phi(S)$:\n$$ S^{\\star} = \\arg \\min_{0 < S \\le 1/\\sqrt{2}} \\Phi(S) = \\arg \\min_{0 < S \\le 1/\\sqrt{2}} \\left( \\sup_{(\\alpha,\\beta)\\in (0,\\pi/2]^{2}} |\\mathcal{E}(\\alpha,\\beta; S)| \\right) $$\nSince $|\\mathcal{E}| = 1 - F(\\alpha, \\beta; S)$, this is equivalent to:\n$$ S^{\\star} = \\arg \\min_{S} \\left( \\sup_{\\alpha, \\beta} (1 - F(\\alpha, \\beta; S)) \\right) = \\arg \\min_{S} \\left( 1 - \\inf_{\\alpha, \\beta} F(\\alpha, \\beta; S) \\right) $$\nMinimizing this expression is equivalent to maximizing the minimum value of the velocity ratio $F$:\n$$ S^{\\star} = \\arg \\max_{0 < S \\le 1/\\sqrt{2}} \\left( \\inf_{(\\alpha, \\beta) \\in (0, \\pi/2]^2} F(\\alpha, \\beta; S) \\right) $$\nLet's analyze the dependence of $F(\\alpha, \\beta; S)$ on $S$. We compute the partial derivative of $F$ with respect to $S$:\n$$ \\frac{\\partial F}{\\partial S} = \\frac{\\partial}{\\partial S} \\left( \\frac{\\arcsin\\left(S \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}\\right)}{S \\sqrt{\\alpha^2 + \\beta^2}} \\right) $$\nLet $A = \\sqrt{\\sin^2\\alpha + \\sin^2\\beta}$ and $B = \\sqrt{\\alpha^2 + \\beta^2}$.\n$$ \\frac{\\partial F}{\\partial S} = \\frac{1}{B} \\frac{\\partial}{\\partial S} \\left( \\frac{\\arcsin(SA)}{S} \\right) = \\frac{1}{B} \\left[ \\frac{\\frac{A}{\\sqrt{1-S^2A^2}} S - \\arcsin(SA)}{S^2} \\right] $$\n$$ \\frac{\\partial F}{\\partial S} = \\frac{1}{B S^2} \\left[ \\frac{SA}{\\sqrt{1-S^2A^2}} - \\arcsin(SA) \\right] $$\nConsider the function $g(u) = u/\\sqrt{1-u^2} - \\arcsin(u)$. Its derivative is $g'(u) = (1-u^2)^{-3/2} - (1-u^2)^{-1/2} = u^2(1-u^2)^{-3/2}$. Since $g'(u) > 0$ for $u \\in (0,1)$ and $g(0)=0$, we have $g(u) > 0$ for $u>0$.\nThe term in the brackets is $g(SA)$, which is positive for $S>0$ and $A>0$. Since $B>0$, it follows that:\n$$ \\frac{\\partial F(\\alpha, \\beta; S)}{\\partial S} > 0 $$\nfor any fixed $(\\alpha, \\beta) \\in (0, \\pi/2]^2$ and $S$ in the stable range.\n\nThis means that for any given direction and wavelength, the numerical phase velocity increases as $S$ increases. Consequently, the minimum value of the phase velocity over all directions and wavelengths, $m(S) = \\inf_{\\alpha, \\beta} F(\\alpha, \\beta; S)$, must be a non-decreasing function of $S$.\nTo maximize $m(S)$, we must choose the largest permissible value of $S$. The stability condition dictates that the maximum value is $S=1/\\sqrt{2}$.\n\nTherefore, the Courant number $S^{\\star}$ that minimizes the peak numerical phase error is the one at the stability limit.\n$$ S^{\\star} = \\frac{1}{\\sqrt{2}} $$",
            "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$"
        }
    ]
}