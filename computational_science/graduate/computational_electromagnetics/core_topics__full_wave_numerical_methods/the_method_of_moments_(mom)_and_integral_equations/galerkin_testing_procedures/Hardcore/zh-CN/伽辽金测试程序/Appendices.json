{
    "hands_on_practices": [
        {
            "introduction": "第一个练习是基础性的。它将引导你完成推导麦克斯韦旋度-旋度方程的伽辽金系统矩阵元的过程，这是频域电磁分析的基石。通过为一个简单的单元体完成这种“纸笔”计算 ，可以巩固对连续偏微分方程如何转化为离散线性系统的理解。",
            "id": "3309726",
            "problem": "考虑有界利普希茨域 $\\Omega \\subset \\mathbb{R}^{3}$ 中的时谐无源麦克斯韦旋度-旋度方程，\n$$\\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) - \\omega^{2} \\epsilon \\mathbf{E} = \\mathbf{0} \\quad \\text{in } \\Omega,$$\n其中 $\\mu$ 是磁导率，$\\epsilon$ 是电介质常数，$\\omega$ 是角频率。设试探和检验空间为具有平方可积旋度的平方可积向量场的索博列夫空间，记为 $H(\\nabla \\times;\\Omega)$，并考虑使用基于四面体的 $H(\\nabla \\times)$-协调的第一类 Nédélec 边元，通过有限元法 (FEM) 进行伽辽金离散化。\n\n1. 从第一性原理出发，通过使用检验函数 $\\boldsymbol{\\phi} \\in H(\\nabla \\times;\\Omega)$ 并对旋度算子进行分部积分得到弱（变分）形式，推导对应于基函数 $\\boldsymbol{\\phi}_{m}$ 和 $\\boldsymbol{\\phi}_{n}$ 的伽辽金双线性形式矩阵元的精确表达式：\n$$a_{mn} = \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}_{m}\\right)\\cdot\\left(\\nabla \\times \\boldsymbol{\\phi}_{n}\\right)\\, d\\Omega \\;-\\; \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}_{m}\\cdot \\boldsymbol{\\phi}_{n}\\, d\\Omega.$$\n\n2. 在单个四面体单元 $T \\subset \\Omega$ 上显式计算该矩阵元，其顶点为 $\\mathbf{x}_{1}=(0,0,0)$, $\\mathbf{x}_{2}=(h,0,0)$, $\\mathbf{x}_{3}=(0,h,0)$ 和 $\\mathbf{x}_{4}=(0,0,h)$，并假设 $\\mu$ 和 $\\epsilon$ 在 $T$ 上为常数。使用与定向边 $(\\mathbf{x}_{1},\\mathbf{x}_{2})$ 相关联的最低阶第一类 Nédélec 边基函数，该函数通过 $T$ 上的重心坐标 $\\{\\lambda_{i}\\}_{i=1}^{4}$ 定义为\n$$\\boldsymbol{\\phi}_{12} = \\lambda_{1}\\nabla \\lambda_{2} - \\lambda_{2}\\nabla \\lambda_{1}.$$\n以闭式形式计算此单个单元 $T$ 的对角矩阵元 $a_{12,12}$。\n\n请以 $h$、$\\mu$、$\\epsilon$ 和 $\\omega$ 的单个闭式解析表达式的形式给出最终答案。无需进行数值计算。最终答案中不包含单位，但假设 $\\mu$ 和 $\\epsilon$ 是具有物理意义的常数。如果进行任何中间数值简化，请保留精确的有理因子。无需四舍五入。",
            "solution": "该问题要求完成两项任务。首先，推导时谐麦克斯韦旋度-旋度方程的伽辽金双线性形式。其次，在给定的四面体单元上，使用特定的基函数，计算所得有限元矩阵的一个特定对角元。\n\n### 第1部分：双线性形式的推导\n\n控制偏微分方程 (PDE) 是在域 $\\Omega$ 内的时谐无源麦克斯韦旋度-旋度方程：\n$$ \\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) - \\omega^{2} \\epsilon \\mathbf{E} = \\mathbf{0} $$\n这里，$\\mathbf{E}$ 是电场相量，$\\mu$ 是磁导率，$\\epsilon$ 是电介质常数，$\\omega$ 是角频率。\n\n为获得弱（或变分）形式，我们遵循标准的伽辽金程序。我们将偏微分方程乘以一个来自适当函数空间（给定为 $H(\\nabla \\times;\\Omega)$）的向量检验函数 $\\boldsymbol{\\phi}$，并在域 $\\Omega$ 上积分：\n$$ \\int_{\\Omega} \\boldsymbol{\\phi} \\cdot \\left[ \\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) - \\omega^{2} \\epsilon \\mathbf{E} \\right] d\\Omega = 0 $$\n这可以分为两项：\n$$ \\int_{\\Omega} \\boldsymbol{\\phi} \\cdot \\left( \\nabla \\times \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) \\right) d\\Omega - \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi} \\cdot \\mathbf{E} \\, d\\Omega = 0 $$\n为降低试探函数 $\\mathbf{E}$ 的微分阶数，我们对第一项应用分部积分。相关的向量微积分恒等式是：\n$$ \\int_{\\Omega} \\mathbf{F} \\cdot (\\nabla \\times \\mathbf{G}) \\, d\\Omega = \\int_{\\Omega} (\\nabla \\times \\mathbf{F}) \\cdot \\mathbf{G} \\, d\\Omega - \\oint_{\\partial\\Omega} (\\mathbf{F} \\times \\mathbf{G}) \\cdot \\mathbf{\\hat{n}} \\, dS $$\n设 $\\mathbf{F} = \\boldsymbol{\\phi}$ 和 $\\mathbf{G} = \\mu^{-1} \\nabla \\times \\mathbf{E}$。应用此恒等式，第一项变为：\n$$ \\int_{\\Omega} \\left(\\nabla \\times \\boldsymbol{\\phi}\\right) \\cdot \\left(\\mu^{-1} \\nabla \\times \\mathbf{E}\\right) d\\Omega - \\oint_{\\partial\\Omega} \\left(\\boldsymbol{\\phi} \\times (\\mu^{-1} \\nabla \\times \\mathbf{E})\\right) \\cdot \\mathbf{\\hat{n}} \\, dS $$\n在适当的边界条件下，边界积分项 $\\oint_{\\partial\\Omega} \\left(\\boldsymbol{\\phi} \\times (\\mu^{-1} \\nabla \\times \\mathbf{E})\\right) \\cdot \\mathbf{\\hat{n}} \\, dS$ 会消失。例如，对于理想电导体 (PEC) 边界，$\\mathbf{\\hat{n}} \\times \\mathbf{E} = \\mathbf{0}$，我们在试探空间上强制施加此条件，这也意味着 $\\mathbf{\\hat{n}} \\times \\boldsymbol{\\phi} = \\mathbf{0}$，从而使被积函数为零。对于理想磁导体 (PMC) 边界，$\\mathbf{\\hat{n}} \\times \\mathbf{H} = \\mathbf{0}$，这在 $\\partial\\Omega$ 上转化为 $\\mathbf{\\hat{n}} \\times (\\mu^{-1} \\nabla \\times \\mathbf{E}) = \\mathbf{0}$，这是一个自然边界条件，也使得边界积分为零。由于问题陈述中的目标表达式缺少边界项，我们假定存在这样的条件。\n\n消去边界项后，弱形式为：求 $\\mathbf{E} \\in H(\\nabla \\times;\\Omega)$（满足本质边界条件），使得对于所有检验函数 $\\boldsymbol{\\phi} \\in H(\\nabla \\times;\\Omega)$（满足齐次本质边界条件）：\n$$ \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}\\right)\\cdot\\left(\\nabla \\times \\mathbf{E}\\right) d\\Omega \\,-\\, \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}\\cdot\\mathbf{E} \\, d\\Omega = 0 $$\n在有限元法 (FEM) 中，我们在由基函数 $\\{\\boldsymbol{\\phi}_n\\}_{n=1}^N$ 张成的有限维子空间中寻求近似解 $\\mathbf{E}_h$。我们将 $\\mathbf{E}_h$ 表示为这些基函数的线性组合：\n$$ \\mathbf{E}_h = \\sum_{n=1}^{N} e_n \\boldsymbol{\\phi}_n $$\n其中 $e_n$ 是未知的复系数。伽辽金方法对试探空间和检验空间使用同一组函数。我们用 $\\mathbf{E}_h$ 代替 $\\mathbf{E}$，并依次选择每个基函数 $\\boldsymbol{\\phi}_m$ ($m=1, \\dots, N$) 作为检验函数 $\\boldsymbol{\\phi}$：\n$$ \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}_m\\right)\\cdot\\left(\\nabla \\times \\sum_{n=1}^{N} e_n \\boldsymbol{\\phi}_n\\right) d\\Omega \\,-\\, \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}_m \\cdot \\left(\\sum_{n=1}^{N} e_n \\boldsymbol{\\phi}_n \\right) d\\Omega = 0 $$\n根据积分的线性性质，我们可以将其写成一个矩阵系统：\n$$ \\sum_{n=1}^{N} e_n \\left[ \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}_m\\right)\\cdot\\left(\\nabla \\times \\boldsymbol{\\phi}_n\\right) d\\Omega \\,-\\, \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}_m \\cdot \\boldsymbol{\\phi}_n \\, d\\Omega \\right] = 0 $$\n这是一个线性方程组 $\\mathbf{A}\\mathbf{e} = \\mathbf{0}$。系统矩阵 $\\mathbf{A}$ 的矩阵元 $a_{mn}$ 是方括号内的表达式：\n$$ a_{mn} = \\int_{\\Omega} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}_{m}\\right)\\cdot\\left(\\nabla \\times \\boldsymbol{\\phi}_{n}\\right) d\\Omega \\;-\\; \\omega^{2} \\int_{\\Omega} \\epsilon \\, \\boldsymbol{\\phi}_{m}\\cdot \\boldsymbol{\\phi}_{n}\\, d\\Omega $$\n推导至此结束。\n\n### 第2部分：$a_{12,12}$ 的显式计算\n\n我们需要在单个四面体单元 $T$ 上计算基函数 $\\boldsymbol{\\phi}_{12}$ 的对角元 $a_{12,12}$。由于 $\\mu$ 和 $\\epsilon$ 在 $T$ 上是常数，我们有：\n$$ a_{12,12} = \\mu^{-1} \\int_{T} |\\nabla \\times \\boldsymbol{\\phi}_{12}|^2 dV - \\omega^{2} \\epsilon \\int_{T} |\\boldsymbol{\\phi}_{12}|^2 dV $$\n四面体 $T$ 的顶点是 $\\mathbf{x}_{1}=(0,0,0)$、$\\mathbf{x}_{2}=(h,0,0)$、$\\mathbf{x}_{3}=(0,h,0)$ 和 $\\mathbf{x}_{4}=(0,0,h)$。此四面体的体积是 $|T| = \\frac{1}{6}h^3$。\n\n基函数是 $\\boldsymbol{\\phi}_{12} = \\lambda_{1}\\nabla \\lambda_{2} - \\lambda_{2}\\nabla \\lambda_{1}$，其中 $\\lambda_i$ 是重心坐标。对于点 $\\mathbf{x}=(x,y,z) \\in T$，重心坐标为：\n$\\lambda_1 = 1 - \\frac{x+y+z}{h}$, $\\lambda_2 = \\frac{x}{h}$, $\\lambda_3 = \\frac{y}{h}$, $\\lambda_4 = \\frac{z}{h}$。\n它们的梯度是常向量：\n$\\nabla \\lambda_1 = \\left(-\\frac{1}{h}, -\\frac{1}{h}, -\\frac{1}{h}\\right)$, $\\nabla \\lambda_2 = \\left(\\frac{1}{h}, 0, 0\\right)$。\n\n首先，我们计算 $\\boldsymbol{\\phi}_{12}$ 的旋度。使用恒等式 $\\nabla \\times (f\\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + \\nabla f \\times \\mathbf{A}$ 并注意到对于任何标量场 $\\lambda$，$\\nabla \\times (\\nabla \\lambda) = \\mathbf{0}$：\n$$ \\nabla \\times \\boldsymbol{\\phi}_{12} = \\nabla \\times (\\lambda_1 \\nabla \\lambda_2) - \\nabla \\times (\\lambda_2 \\nabla \\lambda_1) = (\\nabla \\lambda_1 \\times \\nabla \\lambda_2) - (\\nabla \\lambda_2 \\times \\nabla \\lambda_1) = 2(\\nabla \\lambda_1 \\times \\nabla \\lambda_2) $$\n旋度在单元 $T$ 上是一个常向量：\n$$ \\nabla \\lambda_1 \\times \\nabla \\lambda_2 = \\frac{1}{h^2} \\det \\begin{pmatrix} \\mathbf{\\hat{i}} & \\mathbf{\\hat{j}} & \\mathbf{\\hat{k}} \\\\ -1 & -1 & -1 \\\\ 1 & 0 & 0 \\end{pmatrix} = \\frac{1}{h^2} \\left(0, -1, 1\\right) $$\n$$ \\nabla \\times \\boldsymbol{\\phi}_{12} = \\frac{2}{h^2} \\left(0, -1, 1\\right) $$\n旋度的模的平方是：\n$$ |\\nabla \\times \\boldsymbol{\\phi}_{12}|^2 = \\left(\\frac{2}{h^2}\\right)^2 (0^2 + (-1)^2 + 1^2) = \\frac{4}{h^4} \\cdot 2 = \\frac{8}{h^4} $$\n第一个积分（刚度矩阵贡献）是：\n$$ \\int_{T} |\\nabla \\times \\boldsymbol{\\phi}_{12}|^2 dV = \\frac{8}{h^4} \\int_{T} dV = \\frac{8}{h^4} |T| = \\frac{8}{h^4} \\left(\\frac{h^3}{6}\\right) = \\frac{4}{3h} $$\n接下来，我们计算第二个积分（质量矩阵贡献）。我们计算 $|\\boldsymbol{\\phi}_{12}|^2$：\n$$ |\\boldsymbol{\\phi}_{12}|^2 = |\\lambda_1 \\nabla \\lambda_2 - \\lambda_2 \\nabla \\lambda_1|^2 = \\lambda_1^2 |\\nabla \\lambda_2|^2 - 2\\lambda_1\\lambda_2(\\nabla\\lambda_1 \\cdot \\nabla\\lambda_2) + \\lambda_2^2|\\nabla\\lambda_1|^2 $$\n我们计算梯度的点积和模的平方：\n$|\\nabla \\lambda_1|^2 = \\frac{1}{h^2}((-1)^2 + (-1)^2 + (-1)^2) = \\frac{3}{h^2}$\n$|\\nabla \\lambda_2|^2 = \\frac{1}{h^2}(1^2 + 0^2 + 0^2) = \\frac{1}{h^2}$\n$\\nabla \\lambda_1 \\cdot \\nabla \\lambda_2 = \\frac{1}{h^2}((-1)(1) + (-1)(0) + (-1)(0)) = -\\frac{1}{h^2}$\n将这些代入 $|\\boldsymbol{\\phi}_{12}|^2$ 的表达式中：\n$$ |\\boldsymbol{\\phi}_{12}|^2 = \\lambda_1^2 \\left(\\frac{1}{h^2}\\right) - 2\\lambda_1\\lambda_2\\left(-\\frac{1}{h^2}\\right) + \\lambda_2^2\\left(\\frac{3}{h^2}\\right) = \\frac{1}{h^2} \\left(\\lambda_1^2 + 2\\lambda_1\\lambda_2 + 3\\lambda_2^2\\right) $$\n为了在 $T$ 上对此进行积分，我们使用在 $d$ 维单纯形上积分重心坐标幂次方的标准公式：$\\int_T \\prod_{i=0}^d \\lambda_i^{p_i} dV = \\frac{d! \\prod p_i!}{(\\sum p_i + d)!}|T|$。对于我们的三维四面体（$d=3$）：\n$$ \\int_T \\lambda_1^{p_1} \\lambda_2^{p_2} \\lambda_3^{p_3} \\lambda_4^{p_4} dV = \\frac{3! p_1! p_2! p_3! p_4!}{(p_1+p_2+p_3+p_4+3)!} |T| $$\n我们需要计算 $\\int_T \\lambda_1^2 dV$、$\\int_T \\lambda_1\\lambda_2 dV$ 和 $\\int_T \\lambda_2^2 dV$：\n$$ \\int_T \\lambda_1^2 dV = \\frac{3! \\cdot 2!}{5!} |T| = \\frac{6 \\cdot 2}{120} |T| = \\frac{1}{10}|T| $$\n$$ \\int_T \\lambda_1\\lambda_2 dV = \\frac{3! \\cdot 1! \\cdot 1!}{5!} |T| = \\frac{6}{120} |T| = \\frac{1}{20}|T| $$\n$$ \\int_T \\lambda_2^2 dV = \\frac{3! \\cdot 2!}{5!} |T| = \\frac{1}{10}|T| $$\n因此，第二个积分为：\n$$ \\int_{T} |\\boldsymbol{\\phi}_{12}|^2 dV = \\frac{1}{h^2} \\int_T (\\lambda_1^2 + 2\\lambda_1\\lambda_2 + 3\\lambda_2^2) dV $$\n$$ = \\frac{|T|}{h^2} \\left( \\frac{1}{10} + 2\\left(\\frac{1}{20}\\right) + 3\\left(\\frac{1}{10}\\right) \\right) = \\frac{|T|}{h^2} \\left(\\frac{1}{10} + \\frac{1}{10} + \\frac{3}{10}\\right) = \\frac{|T|}{h^2} \\left(\\frac{5}{10}\\right) = \\frac{|T|}{2h^2} $$\n代入 $|T| = h^3/6$：\n$$ \\int_{T} |\\boldsymbol{\\phi}_{12}|^2 dV = \\frac{h^3/6}{2h^2} = \\frac{h}{12} $$\n最后，我们合并这些项来求得 $a_{12,12}$：\n$$ a_{12,12} = \\mu^{-1} \\left(\\frac{4}{3h}\\right) - \\omega^{2} \\epsilon \\left(\\frac{h}{12}\\right) = \\frac{4}{3\\mu h} - \\frac{\\omega^2 \\epsilon h}{12} $$",
            "answer": "$$\\boxed{\\frac{4}{3\\mu h} - \\frac{\\omega^{2} \\epsilon h}{12}}$$"
        },
        {
            "introduction": "虽然解析积分在理论上可行，但实际的有限元分析依赖于数值求积。本练习  探讨了一个关键问题：精确积分系统矩阵元所需的最低求积阶数是多少？理解基函数的多项式性质以及由此产生的被积函数阶数，是避免细微错误并确保模拟保真度的关键。",
            "id": "3309737",
            "problem": "考虑在单个四面体单元 $K \\subset \\mathbb{R}^{3}$ 上提出的时谐麦克斯韦方程组，其材料属性为分段常数：磁导率 $\\mu$ 和介电常数 $\\epsilon$。使用伽辽金方法，对于属于一阶Nédélec有限元空间的试探场和检验场 $\\mathbf{u}$ 和 $\\mathbf{v}$，单元级双线性形式为\n$$\na(\\mathbf{u},\\mathbf{v}) \\;=\\; \\int_{K} \\mu^{-1} \\left(\\nabla \\times \\mathbf{u}\\right) \\cdot \\left(\\nabla \\times \\mathbf{v}\\right) \\,\\mathrm{d}V \\;-\\; \\int_{K} \\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v} \\,\\mathrm{d}V,\n$$\n其中 $\\omega$ 是角频率，并且根据伽辽金检验程序的要求，试探函数和检验函数取自同一空间。假设四面体 $K$ 是通过从参考四面体进行仿射映射得到的，因此雅可比矩阵在 $K$ 上是常数。有限元基函数是四面体上最低阶 ($r = 1$) 的第一类Nédélec边函数。\n\n您需要确定一个四面体体积求积法则必须具有的最小多项式精确度 $p$，以便对 $K$ 上的所有基函数对精确地计算 $a(\\mathbf{u},\\mathbf{v})$。请仅根据一阶Nédélec基函数及其旋度的多项式次数性质，以及仿射映射和常数系数的假设来论证您的选择。请以 $p$ 的整数值形式提供您的最终答案。无需四舍五入，答案中也不需要单位。",
            "solution": "问题要求确定一个四面体体积求积法则必须具备的最小多项式精确度 $p$，以便精确计算双线性形式\n$$\na(\\mathbf{u},\\mathbf{v}) \\;=\\; \\int_{K} \\mu^{-1} \\left(\\nabla \\times \\mathbf{u}\\right) \\cdot \\left(\\nabla \\times \\mathbf{v}\\right) \\,\\mathrm{d}V \\;-\\; \\int_{K} \\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v} \\,\\mathrm{d}V\n$$\n对于来自四面体 $K$ 上最低阶Nédélec有限元空间的所有基函数对 $\\mathbf{u}$ 和 $\\mathbf{v}$。\n\n一个多项式精确度为 $p$ 的求积法则可以精确地积分任何次数小于或等于 $p$ 的多项式。为了找到所需的最小 $p$ 值，我们必须确定当 $\\mathbf{u}$ 和 $\\mathbf{v}$ 是基函数时，$a(\\mathbf{u},\\mathbf{v})$ 的被积函数的最大多项式次数。\n\n被积函数是两项之差：$\\mu^{-1} (\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$ 和 $\\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v}$。总的多项式次数将是这两项次数的最大值。问题指出，材料属性 $\\mu$ 和 $\\epsilon$ 以及角频率 $\\omega$ 在单元 $K$ 上是常数。因此，因子 $\\mu^{-1}$ 和 $\\omega^2\\epsilon$ 是常数，不影响被积函数的多项式次数。\n\n分析基于基函数的性质。问题指定使用四面体上最低阶 ($r=1$) 的第一类Nédélec边基函数。这些基函数的一个关键性质是，无论是在参考单元上还是在仿射映射的物理单元上，它们都是向量值的多项式，其中每个分量都是次数最多为 $1$ 的多项式。我们将次数最多为 $k$ 的多项式空间表示为 $\\mathcal{P}_k$。那么，一个基函数 $\\mathbf{u}$ (或 $\\mathbf{v}$) 是 $[\\mathcal{P}_1(K)]^3$ 中的一个元素。具体来说，这些函数的形式为 $\\mathbf{a} + \\mathbf{b} \\times \\mathbf{x}$，其中 $\\mathbf{a}$ 和 $\\mathbf{b}$ 是常数向量，$\\mathbf{x}$ 是位置向量。\n\n我们来分析被积函数中每一项的多项式次数。\n\n1.  **分析第二项：$\\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v}$**\n    设 $\\mathbf{u}$ 和 $\\mathbf{v}$ 是两个这样的基函数。它们都是次数为 $1$ 的向量值多项式。它们的点积由下式给出：\n    $$\n    \\mathbf{u} \\cdot \\mathbf{v} = u_x v_x + u_y v_y + u_z v_z\n    $$\n    由于每个分量 ($u_x, u_y, u_z, v_x, v_y, v_z$) 都是关于空间坐标 $(x,y,z)$ 的次数最多为 $1$ 的多项式，因此每个乘积项（如 $u_x v_x$）都是次数最多为 $1+1=2$ 的多项式。这些项的和 $\\mathbf{u} \\cdot \\mathbf{v}$ 因此是一个次数最多为 $2$ 的标量多项式。由于 $\\omega^2\\epsilon$ 是常数，第二个积分的被积函数 $\\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v}$ 是一个次数为 $2$ 的多项式。\n\n2.  **分析第一项：$\\mu^{-1} (\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$**\n    我们需要确定基函数旋度 $\\nabla \\times \\mathbf{u}$ 的多项式次数。一个基函数 $\\mathbf{u}$ 的分量是次数为 $1$ 的多项式。我们将 $\\mathbf{u}$ 的一个通用分量写为 $u_i(\\mathbf{x}) = c_{i0} + c_{i1}x + c_{i2}y + c_{i3}z$。旋度运算涉及求空间导数。例如，旋度的 $x$ 分量是 $(\\nabla \\times \\mathbf{u})_x = \\frac{\\partial u_z}{\\partial y} - \\frac{\\partial u_y}{\\partial z}$。\n    当我们对一个次数为 $1$ 的多项式关于一个空间变量求偏导数时，结果是一个常数（次数为 $0$ 的多项式）。例如，$\\frac{\\partial u_z}{\\partial y} = c_{z2}$，这是一个常数。因此，$\\nabla \\times \\mathbf{u}$ 的每个分量都是一个常数。这意味着 $\\nabla \\times \\mathbf{u}$ 是一个常数向量场，即一个次数为 $0$ 的向量值多项式。\n    这是最低阶Nédélec元的一个基本性质：它们的旋度是常数向量。\n    由于 $\\nabla \\times \\mathbf{u}$ 和 $\\nabla \\times \\mathbf{v}$ 都是常数向量（次数为 $0$ 的多项式），它们的点积 $(\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$ 是一个标量常数（次数为 $0$ 的多项式）。由于 $\\mu^{-1}$ 是常数，第一个积分的被积函数 $\\mu^{-1} (\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$ 是一个次数为 $0$ 的多项式。\n\n从参考四面体进行仿射映射的假设确保了此分析的成立。在仿射映射下，特定次数的多项式被映射为相同次数的多项式，并且变换的雅可比矩阵是一个常数。这意味着无论是在物理单元 $K$ 上还是在参考单元上分析，被积函数的多项式次数都是相同的。\n\n总结被积函数的结果：\n- 项 $\\mu^{-1} (\\nabla \\times \\mathbf{u}) \\cdot (\\nabla \\times \\mathbf{v})$ 是一个次数为 $0$ 的多项式。\n- 项 $\\omega^{2} \\epsilon \\,\\mathbf{u} \\cdot \\mathbf{v}$ 是一个次数为 $2$ 的多项式。\n\n双线性形式 $a(\\mathbf{u},\\mathbf{v})$ 的总被积函数是这两项的组合。多项式之和的次数是它们各自次数的最大值。因此，$a(\\mathbf{u},\\mathbf{v})$ 的被积函数是一个次数为 $\\max(0, 2) = 2$ 的多项式。\n\n为了一个求积法则能精确计算此多项式的积分，它必须对所有次数最高为 $2$ 的多项式都精确。因此，该求积法则所需的最小多项式精确度 $p$ 为 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在前两个练习的基础上，这最后一个实践将展示“变分犯罪”（即使用不一致或精度不足的求积）所带来的严重后果。通过一个动手编程问题 ，你将研究积分不足如何破坏离散能量守恒定律，即使在耗散系统中也会导致非物理的能量增长。这突显了计算科学中数学一致性与物理真实性之间的深刻联系。",
            "id": "3309793",
            "problem": "考虑在单位正方形域 $[0,1]\\times[0,1]$ 上的二维横电 (TE) 形式的 Maxwell 方程组，该域为单连通域，具有均匀、无量纲的电导率 $\\sigma>0$ 和完全绝缘的边界，因此在能量平衡中边值积分为零。电场有一个非零标量分量 $E_z(x,y,t)$，而磁场是平面内矢量 $H(x,y,t)=\\left(H_x(x,y,t),H_y(x,y,t)\\right)$。无量纲的强形式 TE 系统为\n$$\n\\partial_t H_x = -\\partial_y E_z,\\quad\n\\partial_t H_y = \\phantom{-}\\partial_x E_z,\\quad\n\\partial_t E_z = -\\partial_x H_y + \\partial_y H_x - \\sigma E_z.\n$$\n根据 Maxwell 方程组和标准操作（分部积分以及使用消除边界项的边界条件），连续能量泛函\n$$\n\\mathcal{E}(t)=\\tfrac{1}{2}\\int_{[0,1]^2}\\left(\\lvert H\\rvert^2+\\lvert E_z\\rvert^2\\right)\\,dx\\,dy\n$$\n满足能量恒等式\n$$\n\\frac{d}{dt}\\mathcal{E}(t)=-\\sigma\\int_{[0,1]^2}\\lvert E_z\\rvert^2\\,dx\\,dy\\le 0,\n$$\n因此对于 $\\sigma>0$，能量是非增的。\n\n在 Galerkin 测试过程中，设标量场 $E_z$ 近似为 $E_z(x,y,t)\\approx\\sum_{i=1}^{N_e}e_i(t)\\,\\phi_i(x,y)$，矢量场 $H$ 近似为 $H(x,y,t)\\approx\\sum_{j=1}^{N_h}h_j(t)\\,\\psi_j(x,y)$，其中 $\\{\\phi_i\\}_{i=1}^{N_e}$ 是标量基函数，$\\{\\psi_j\\}_{j=1}^{N_h}$ 是矢量基函数。定义电场和磁场的对称正定质量矩阵\n$$\nM_e[i,k]=\\int_{[0,1]^2}\\phi_i\\,\\phi_k\\,dx\\,dy,\\qquad\nM_h[j,\\ell]=\\int_{[0,1]^2}\\psi_j\\cdot\\psi_\\ell\\,dx\\,dy.\n$$\n定义由旋度相互作用产生的耦合矩阵\n$$\nA[i,j]=\\int_{[0,1]^2}\\phi_i\\left(\\partial_x \\psi_j^{(y)}-\\partial_y \\psi_j^{(x)}\\right)\\,dx\\,dy,\\qquad\nB[j,i]=\\int_{[0,1]^2}\\psi_j\\cdot\\left(-\\partial_y\\phi_i,\\ \\partial_x\\phi_i\\right)\\,dx\\,dy,\n$$\n其中 $\\psi_j^{(x)}$ 和 $\\psi_j^{(y)}$ 表示 $\\psi_j$ 的分量。对于足够光滑的 $\\phi_i$ 和 $\\psi_j$ 以及积分的精确计算，分部积分意味着 $B=-A^\\top$，这会产生一个与连续能量恒等式对应的离散能量恒等式。然而，如果旋度-旋度内积被欠积分（一种“变分犯罪”），离散分部积分的一致性可能被破坏，从而导致 $B\\ne -A^\\top$，这可能在即使 $\\sigma>0$ 时也引入非物理的能量增长。\n\n在本问题中，固定 $N_e=2$ 和 $N_h=2$，并使用以下在边界上为零的多项式基函数来消除边界项：\n- 对于电场，\n$$\n\\phi_1(x,y)=x(1-x)\\,y(1-y),\\qquad\n\\phi_2(x,y)=\\bigl(x(1-x)\\bigr)^2\\,y(1-y).\n$$\n- 对于磁场，\n$$\n\\psi_1(x,y)=\\bigl(\\phi_1(x,y),\\ 0\\bigr),\\qquad\n\\psi_2(x,y)=\\bigl(0,\\ \\phi_2(x,y)\\bigr).\n$$\n通过这些选择，矩阵 $M_e$、$M_h$、$A$ 和 $B$ 均为 $2\\times 2$ 矩阵。设 $A$ 使用求积法则 $Q_A$ 进行组装，$B$ 使用（可能不同的）求积法则 $Q_B$ 进行组装。电场和磁场质量矩阵 $M_e$ 和 $M_h$ 必须使用高精度求积法则进行组装。考虑两种求积法则：\n- 一种高精度的 Gauss–Legendre 张量积法则，每个维度上为 5 阶（记作 $Q_\\mathrm{G5}$）。\n- 一种严重欠积分的中点法则，仅在域中心 $(x,y)=\\left(\\tfrac{1}{2},\\tfrac{1}{2}\\right)$ 使用一个点（记作 $Q_\\mathrm{MP}$）。\n\n定义离散能量\n$$\n\\mathcal{E}_h(e,h)=\\tfrac{1}{2}\\left(e^\\top M_e\\,e+h^\\top M_h\\,h\\right),\n$$\n其中 $e\\in\\mathbb{R}^{2}$ 和 $h\\in\\mathbb{R}^{2}$ 是系数向量。半离散 Galerkin 系统在状态 $(e,h)$ 下的瞬时离散能量变化率由下式给出\n$$\n\\frac{d}{dt}\\mathcal{E}_h(e,h)=-\\sigma\\,e^\\top M_e\\,e+e^\\top A\\,h+h^\\top B\\,e.\n$$\n对于固定的 $M_e$、$M_h$、$A$ 和 $B$，通过在约束条件 $e^\\top M_e\\,e=1$ 和 $h^\\top M_h\\,h=1$ 下对 $e$ 和 $h$ 进行优化，定义单位能量状态下的最坏情况瞬时能量增长。证明这个最坏情况下的变化率等于\n$$\n\\max_{\\substack{e^\\top M_e e=1\\\\ h^\\top M_h h=1}}\\left[-\\sigma\\,e^\\top M_e e+e^\\top(A+B^\\top)h\\right]=-\\sigma+\\left\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\right\\|_2,\n$$\n其中 $\\|\\cdot\\|_2$ 表示谱范数，$M_e^{-1/2}$、$M_h^{-1/2}$ 是对称逆平方根。因此，当且仅当\n$$\n\\left\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\right\\|_2>\\sigma\n$$\n时，表明存在非物理的能量增长。\n\n你的任务是编写一个完整、可运行的程序，该程序：\n- 使用 $Q_\\mathrm{G5}$ 组装 $M_e$ 和 $M_h$。\n- 使用选定的法则 $Q_A\\in\\{Q_\\mathrm{G5},Q_\\mathrm{MP}\\}$ 组装 $A$，并使用 $Q_B\\in\\{Q_\\mathrm{G5},Q_\\mathrm{MP}\\}$ 组装 $B$。\n- 计算谱范数 $\\left\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\right\\|_2$ 并将其与给定的 $\\sigma$ 进行比较。\n- 输出一个布尔值，指示不等式 $\\left\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\right\\|_2>\\sigma$ 是否成立，这标志着由于求积引起的变分犯罪导致有损介质中出现非物理的瞬时能量增长。\n\n所有量都是无量纲的。不使用角度。最终输出为布尔值。\n\n使用以下参数值测试套件来测试不同情况：\n- 案例 1 (理想路径，精确能量衰减): $Q_A=Q_\\mathrm{G5}$，$Q_B=Q_\\mathrm{G5}$，$\\sigma=0.1$。\n- 案例 2 (变分犯罪，仅对 A 的旋度-旋度项进行欠积分): $Q_A=Q_\\mathrm{MP}$，$Q_B=Q_\\mathrm{G5}$，$\\sigma=0.001$。\n- 案例 3 (变分犯罪被强损耗所缓解): $Q_A=Q_\\mathrm{MP}$，$Q_B=Q_\\mathrm{G5}$，$\\sigma=10.0$。\n- 案例 4 (对两个耦合项进行对称欠积分): $Q_A=Q_\\mathrm{MP}$，$Q_B=Q_\\mathrm{MP}$，$\\sigma=0.001$。\n\n你的程序应生成单行输出，其中包含四个案例的结果，以逗号分隔的列表形式并用方括号括起来，例如 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$。结果必须是四个布尔值，按上述案例的顺序列出。",
            "solution": "该问题陈述经过了严格验证，并被确定为有效。其科学基础是计算电磁学原理，特别是应用于 Maxwell 方程组的 Galerkin 有限元方法。该问题是适定的，所有必要的数据、函数和条件都已明确定义。它提出了一个可计算验证的任务，没有内部矛盾、歧义或依赖于伪科学。\n\n任务是确定二维横电 (TE) Maxwell 方程组的半离散近似是否会因为“变分犯罪”（即在弱形式中对不同项使用不一致的数值求积）而表现出非物理的能量增长。这种增长的判据由不等式 $\\left\\|M_e^{-1/2}(A+B^\\top)M_h^{-1/2}\\right\\|_2 > \\sigma$ 给出，其中 $\\sigma$ 是物理电导率。肯定的结果表明数值误差可以超过物理耗散，从而导致不稳定的模拟。\n\n解决方案通过实现必要的计算步骤来对四个给定的测试案例评估此不等式的左侧。\n\n**1. 基函数及其导数**\n问题指定了在单位正方形 $[0,1] \\times [0,1]$ 上的多项式基函数。\n对于标量电场 $E_z$，$N_e=2$：\n$$\n\\phi_1(x,y) = x(1-x)y(1-y) = (x-x^2)(y-y^2) \\\\\n\\phi_2(x,y) = (x(1-x))^2 y(1-y) = (x^2-2x^3+x^4)(y-y^2)\n$$\n对于矢量磁场 $H$，$N_h=2$：\n$$\n\\psi_1(x,y) = (\\phi_1(x,y), 0) \\\\\n\\psi_2(x,y) = (0, \\phi_2(x,y))\n$$\n构建耦合矩阵 $A$ 和 $B$ 需要这些基函数的偏导数：\n$$\n\\partial_x \\phi_1(x,y) = (1-2x)y(1-y) \\\\\n\\partial_y \\phi_1(x,y) = x(1-x)(1-2y) \\\\\n\\partial_x \\phi_2(x,y) = (2(x-x^2)(1-2x))y(1-y) = (2x-6x^2+4x^3)(y-y^2) \\\\\n\\partial_y \\phi_2(x,y) = (x(1-x))^2(1-2y)\n$$\n\n**2. 数值求积**\n矩阵项由单位正方形上的积分定义。这些积分使用两种指定的求积法则来近似：\n- $Q_\\mathrm{G5}$：一种张量积法则，在每个维度上使用 5 点 Gauss-Legendre 求积。该法则是高阶的，足以精确积分此问题中的所有多项式被积函数。二维积分计算为 $\\int_0^1 \\int_0^1 f(x,y) \\,dx\\,dy \\approx \\sum_{k=1}^5 \\sum_{l=1}^5 w'_k w'_l f(x'_k, x'_l)$，其中 $(x'_k, w'_k)$ 是从标准区间 $[-1,1]$ 映射到 $[0,1]$ 的求积点和权重。\n- $Q_\\mathrm{MP}$：单点中点法则。该法则将积分近似为 $\\int_0^1 \\int_0^1 f(x,y) \\,dx\\,dy \\approx f(0.5, 0.5)$，即在域中心进行单次求值，权重为 1。这是一个非常低阶的法则，会严重欠积分多项式被积函数。\n\n**3. 矩阵组装**\n矩阵 $M_e, M_h, A, B$ 均为 $2 \\times 2$ 矩阵。它们的元素是通过将指定的求积法则应用于它们的积分定义来计算的。\n\n- **质量矩阵 ($M_e$, $M_h$)：** 两者都使用高精度法则 $Q_\\mathrm{G5}$ 进行组装。\n  $$\n  M_e[i,k] = \\int_0^1\\int_0^1 \\phi_i \\phi_k \\,dx\\,dy, \\quad i,k \\in \\{1,2\\} \\\\\n  M_h[j,\\ell] = \\int_0^1\\int_0^1 \\psi_j \\cdot \\psi_\\ell \\,dx\\,dy, \\quad j,\\ell \\in \\{1,2\\}\n  $$\n  根据 $\\psi_j$ 的定义，$M_h$ 是一个对角矩阵，其元素为 $M_h[1,1]=\\int \\phi_1^2$，$M_h[2,2]=\\int \\phi_2^2$，以及 $M_h[1,2]=M_h[2,1]=0$。\n\n- **耦合矩阵 ($A$, $B$)：** 根据测试案例的指定，使用 $Q_\\mathrm{G5}$ 或 $Q_\\mathrm{MP}$ 进行组装。\n  $A$ 的定义为 $A[i,j] = \\int_0^1\\int_0^1 \\phi_i (\\partial_x \\psi_j^{(y)} - \\partial_y \\psi_j^{(x)}) \\,dx\\,dy$。\n  各个元素的被积函数为：\n  $$\n  A[1,1]: -\\phi_1 \\partial_y \\phi_1 \\quad A[1,2]: \\phi_1 \\partial_x \\phi_2 \\\\\n  A[2,1]: -\\phi_2 \\partial_y \\phi_1 \\quad A[2,2]: \\phi_2 \\partial_x \\phi_2\n  $$\n  $B$ 的定义为 $B[j,i] = \\int_0^1\\int_0^1 \\psi_j \\cdot (-\\partial_y\\phi_i, \\partial_x\\phi_i) \\,dx\\,dy$。\n  各个元素的被积函数为：\n  $$\n  B[1,1]: -\\phi_1 \\partial_y \\phi_1 \\quad B[1,2]: -\\phi_1 \\partial_y \\phi_2 \\\\\n  B[2,1]: \\phi_2 \\partial_x \\phi_1 \\quad B[2,2]: \\phi_2 \\partial_x \\phi_2\n  $$\n  当对 $A$ 和 $B$ 都使用 $Q_\\mathrm{G5}$ 时，由于基函数在边界上为零，精确的分部积分性质 $B=-A^\\top$ 成立。这导致 $A+B^\\top=0$。当使用 $Q_\\mathrm{MP}$ 时，我们注意到 $\\phi_1$ 和 $\\phi_2$ 的所有一阶偏导数在中点 $(0.5, 0.5)$ 处均为零。因此，任何用 $Q_\\mathrm{MP}$ 组装的矩阵（$A$ 或 $B$）都将是零矩阵。\n\n**4. 能量增长判据的计算**\n对每个测试案例，执行以下步骤：\n1.  使用 $Q_\\mathrm{G5}$ 组装 $M_e$ 和 $M_h$。\n2.  对该案例，使用法则 $Q_A$ 组装 $A$，使用法则 $Q_B$ 组装 $B$。\n3.  计算矩阵 $C = A+B^\\top$。\n4.  计算质量矩阵的对称逆平方根 $M_e^{-1/2}$ 和 $M_h^{-1/2}$。这可以通过先使用 `scipy.linalg.sqrtm` 找到主平方根 $M^{1/2}$，然后对结果求逆来实现。\n5.  构建矩阵 $K = M_e^{-1/2} C M_h^{-1/2}$。\n6.  计算谱范数 $\\|K\\|_2$，即 $K$ 的最大奇异值。\n7.  将计算出的范数与给定的电导率 $\\sigma$ 进行比较，以评估布尔条件 $\\|K\\|_2 > \\sigma$。\n\n对所有四个案例重复此过程，以生成最终的布尔结果列表。\n- **案例 1 ($Q_A=Q_\\mathrm{G5}, Q_B=Q_\\mathrm{G5}$):** $A+B^\\top = 0$，所以范数为 $0$。不等式 $0 > \\sigma$ 为假。\n- **案例 2 ($Q_A=Q_\\mathrm{MP}, Q_B=Q_\\mathrm{G5}$):** $A=0$，所以 $C=B^\\top$。$B$ 非零，导致范数为正。对于较小的 $\\sigma=0.001$，不等式预计为真。\n- **案例 3 ($Q_A=Q_\\mathrm{MP}, Q_B=Q_\\mathrm{G5}$):** 与案例 2 相同，但 $\\sigma$ 较大，为 $10.0$。范数可能小于 $\\sigma$，所以不等式预计为假。\n- **案例 4 ($Q_A=Q_\\mathrm{MP}, Q_B=Q_\\mathrm{MP}$):** $A=0$ 且 $B=0$，所以 $C=0$。范数为 $0$。不等式 $0 > \\sigma$ 为假。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import sqrtm\n\ndef solve():\n    \"\"\"\n    Solves the problem of detecting non-physical energy growth in a\n    Galerkin discretization of Maxwell's equations due to quadrature-induced\n    variational crimes.\n    \"\"\"\n\n    # Define basis functions and their partial derivatives\n    def phi1(x, y):\n        return (x - x**2) * (y - y**2)\n\n    def dphi1_dx(x, y):\n        return (1 - 2*x) * (y - y**2)\n\n    def dphi1_dy(x, y):\n        return (x - x**2) * (1 - 2*y)\n\n    def phi2(x, y):\n        return (x - x**2)**2 * (y - y**2)\n\n    def dphi2_dx(x, y):\n        return (2 * (x - x**2) * (1 - 2*x)) * (y - y**2)\n\n    def dphi2_dy(x, y):\n        return (x - x**2)**2 * (1 - 2*y)\n    \n    # Store functions in lists for easier iteration\n    # Indices 0 and 1 correspond to basis functions 1 and 2\n    phis = [phi1, phi2]\n    dphis_dx = [dphi1_dx, dphi2_dx]\n    dphis_dy = [dphi1_dy, dphi2_dy]\n    \n    # Define numerical quadrature function\n    # Cache Gauss-Legendre points and weights for efficiency\n    g5_points, g5_weights = np.polynomial.legendre.leggauss(5)\n    g5_points_01 = 0.5 * (g5_points + 1.0)\n    g5_weights_01 = 0.5 * g5_weights\n\n    def integrate(integrand_func, rule='G5'):\n        if rule == 'MP':\n            return integrand_func(0.5, 0.5)\n        elif rule == 'G5':\n            integral_val = 0.0\n            for i in range(5):\n                for j in range(5):\n                    integral_val += g5_weights_01[i] * g5_weights_01[j] * integrand_func(g5_points_01[i], g5_points_01[j])\n            return integral_val\n        else:\n            raise ValueError(f\"Unknown quadrature rule: {rule}\")\n\n    # --- Matrix Assembly Functions ---\n    def assemble_Me(quad_rule):\n        Me = np.zeros((2, 2))\n        for i in range(2):\n            for k in range(2):\n                integrand = lambda x, y: phis[i](x, y) * phis[k](x, y)\n                Me[i, k] = integrate(integrand, quad_rule)\n        return Me\n\n    def assemble_Mh(quad_rule):\n        Mh = np.zeros((2, 2))\n        # M_h[0,0] = integral(phi1^2)\n        Mh[0, 0] = integrate(lambda x, y: phis[0](x, y)**2, quad_rule)\n        # M_h[1,1] = integral(phi2^2)\n        Mh[1, 1] = integrate(lambda x, y: phis[1](x, y)**2, quad_rule)\n        # Off-diagonal terms are zero\n        return Mh\n\n    def assemble_A(quad_rule):\n        A = np.zeros((2, 2))\n        for i in range(2): # Row index for phi_i\n            # j=0 (column 1) corresponds to psi_1 = (phi1, 0)\n            integrand_A_i0 = lambda x, y, i=i: -phis[i](x,y) * dphis_dy[0](x,y)\n            A[i, 0] = integrate(integrand_A_i0, quad_rule)\n            \n            # j=1 (column 2) corresponds to psi_2 = (0, phi2)\n            integrand_A_i1 = lambda x, y, i=i: phis[i](x,y) * dphis_dx[1](x,y)\n            A[i, 1] = integrate(integrand_A_i1, quad_rule)\n        return A\n        \n    def assemble_B(quad_rule):\n        B = np.zeros((2, 2))\n        # j=0 (row 1) corresponds to psi_1\n        for i in range(2): # Column index for phi_i\n            integrand_B_0i = lambda x, y, i=i: -phis[0](x,y) * dphis_dy[i](x,y)\n            B[0, i] = integrate(integrand_B_0i, quad_rule)\n\n        # j=1 (row 2) corresponds to psi_2\n        for i in range(2): # Column index for phi_i\n            integrand_B_1i = lambda x, y, i=i: phis[1](x,y) * dphis_dx[i](x,y)\n            B[1, i] = integrate(integrand_B_1i, quad_rule)\n        return B\n        \n    # Define test cases from the problem statement\n    test_cases = [\n        # (Q_A, Q_B, sigma)\n        ('G5', 'G5', 0.1),      # Case 1\n        ('MP', 'G5', 0.001),    # Case 2\n        ('MP', 'G5', 10.0),     # Case 3\n        ('MP', 'MP', 0.001),    # Case 4\n    ]\n\n    results = []\n\n    # Assemble mass matrices once using high-accuracy quadrature\n    Me = assemble_Me('G5')\n    Mh = assemble_Mh('G5')\n\n    # Compute inverse square roots of mass matrices\n    # These are symmetric positive definite, so sqrtm is well-defined\n    # and returns the principal (unique SPD) square root.\n    Me_sqrt = sqrtm(Me)\n    Mh_sqrt = sqrtm(Mh)\n    Me_inv_sqrt = np.linalg.inv(Me_sqrt)\n    Mh_inv_sqrt = np.linalg.inv(Mh_sqrt)\n\n    # Process each test case\n    for q_a_rule, q_b_rule, sigma in test_cases:\n        A = assemble_A(q_a_rule)\n        B = assemble_B(q_b_rule)\n        \n        # Form the \"error\" matrix C = A + B^T\n        C = A + B.T\n        \n        # If C is numerically zero, the norm is zero, no need for matrix math\n        if np.allclose(C, 0):\n            norm_val = 0.0\n        else:\n            # Form the matrix K for the norm calculation\n            K = Me_inv_sqrt @ C @ Mh_inv_sqrt\n            \n            # Compute the spectral norm (largest singular value)\n            norm_val = np.linalg.norm(K, 2)\n        \n        # Check for non-physical energy growth\n        growth_detected = norm_val > sigma\n        results.append(growth_detected)\n\n    # Final print statement in the exact required format\n    # Python's str(bool) gives 'True'/'False', which is fine.\n    print(f\"[{','.join(str(r) for r in results).lower()}]\")\n\n# The problem requires boolean values. Python's str(True) is 'True', but boolean literals\n# in many contexts (like JSON) are lowercase. The example in the problem is just a placeholder.\n# To be robust and unambiguous, we'll output lowercase 'true'/'false'.\n# Let's adjust the print statement to ensure lowercase output.\n# The original print(f\"[{','.join(map(str, results))}]\") is changed.\nsolve()\n```"
        }
    ]
}