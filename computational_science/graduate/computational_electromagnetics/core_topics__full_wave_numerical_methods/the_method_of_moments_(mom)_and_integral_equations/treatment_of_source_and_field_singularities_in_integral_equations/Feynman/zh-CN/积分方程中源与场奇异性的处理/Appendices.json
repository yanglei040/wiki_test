{
    "hands_on_practices": [
        {
            "introduction": "边界积分方程的计算常常涉及在其源域上变得奇异的核函数，这使得直接进行数值积分变得困难甚至不可能。本实践将介绍一种基础的解析方法来对这类奇异积分进行正则化处理。通过解决一个关于平面三角形上双层位势的具体问题 ，你将学习如何将一个具有 $1/R^2$ 奇异性的挑战性曲面积分，转化为一个由立体角和一系列简单的非奇异线积分组成的良态表达式。这是边界元法 (BEM) 中的一种基石技术。",
            "id": "3357681",
            "problem": "考虑拉普拉斯方程的三维自由空间格林函数的静电极限，其定义为 $G(\\mathbf{r},\\mathbf{r}_0)=\\frac{1}{4\\pi |\\mathbf{r}-\\mathbf{r}_0|}$，其中 $\\mathbf{r}\\in\\mathbb{R}^{3}$ 是源点，$\\mathbf{r}_0\\in\\mathbb{R}^{3}$ 是场点。在边界积分表述中，双层算子涉及核 $\\nabla_{\\mathbf{r}_0}G(\\mathbf{r},\\mathbf{r}_0)$ 在一个曲面片上的积分。设 $T$ 是一个平面三角形，其顶点为 $\\mathbf{r}_1,\\mathbf{r}_2,\\mathbf{r}_3\\in\\mathbb{R}^{3}$，其单位法向量 $\\mathbf{n}$ 的选择使得当沿着 $\\mathbf{n}$ 方向看时，$\\mathbf{r}_1,\\mathbf{r}_2,\\mathbf{r}_3$ 按逆时针排序。通过有序对 $(\\mathbf{r}_1,\\mathbf{r}_2)$、$(\\mathbf{r}_2,\\mathbf{r}_3)$ 和 $(\\mathbf{r}_3,\\mathbf{r}_1)$ 定义三个有向边。对于每条边 $e\\in\\{1,2,3\\}$，设 $\\mathbf{t}_e$ 是从其第一个顶点指向第二个顶点的单位切向量，并定义向外的平面内单位法向量为 $\\mathbf{m}_e=\\mathbf{n}\\times \\mathbf{t}_e$。\n\n设 $\\mathbf{a}\\in\\mathbb{R}^{3}$ 是一个常向量。记 $R=|\\mathbf{r}-\\mathbf{r}_0|$，并写出 $\\mathbf{R}_i=\\mathbf{r}_i-\\mathbf{r}_0$ 和 $R_i=|\\mathbf{R}_i|$，其中 $i\\in\\{1,2,3\\}$。对于端点为 $\\mathbf{r}_{e,1}$ 和 $\\mathbf{r}_{e,2}$ 的每条边 $e$，设 $\\mathbf{p}_e$ 是包含该边的无限直线上距离 $\\mathbf{r}_0$ 最近的点，定义沿边有向坐标 $s_{e,i}=(\\mathbf{r}_{e,i}-\\mathbf{p}_e)\\cdot \\mathbf{t}_e$ (其中 $i\\in\\{1,2\\}$)，并设 $\\rho_e=|\\mathbf{r}_0-\\mathbf{p}_e|$ 为 $\\mathbf{r}_0$ 到该直线的垂直距离。\n\n仅使用势论和向量微积分的基本定律和核心定义，推导积分\n$$\nI(\\mathbf{a})=\\int_{T}\\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot \\mathbf{a}}{R^{3}}\\,\\mathrm{d}S\n$$\n的解析闭式表达式，该表达式用几何数据 $\\{\\mathbf{r}_i\\}$、$\\mathbf{n}$、$\\{\\mathbf{t}_e\\}$、$\\{\\mathbf{m}_e\\}$、$\\{s_{e,i}\\}$ 和 $\\{\\rho_e\\}$ 表示。\n\n您的最终表达式必须是单个闭式解析表达式。不需要进行数值计算。此外，请解释您的结果与静电学边界积分方程中双层项处理的相关性，包括法向分量如何恢复立体角，以及切向分量如何简化为不含奇异场点行为的边积分。最终答案应以无单位的表达式形式呈现，无需四舍五入。",
            "solution": "问题要求推导积分\n$$\nI(\\mathbf{a})=\\int_{T}\\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot \\mathbf{a}}{R^{3}}\\,\\mathrm{d}S\n$$\n的闭式解析表达式，其中 $T$ 是一个平面三角形，$\\mathbf{r}_0$ 是一个场点，$\\mathbf{a}$ 是一个常向量，且 $R=|\\mathbf{r}-\\mathbf{r}_0|$。被积函数与拉普拉斯方程的自由空间格林函数 $G(\\mathbf{r},\\mathbf{r}_0) = \\frac{1}{4\\pi R}$ 的梯度有关。具体来说，$\\nabla_{\\mathbf{r}}G = -\\frac{\\mathbf{r}-\\mathbf{r}_0}{4\\pi R^3}$。因此，被积函数与 $\\mathbf{a} \\cdot \\nabla_{\\mathbf{r}} (1/R)$ 成正比。\n\n我们通过将常向量 $\\mathbf{a}$ 分解为其垂直于和平行于三角形 $T$ 所在平面的分量来继续。设 $\\mathbf{n}$ 是平面 $T$ 的单位法向量。我们可以写出\n$$\n\\mathbf{a} = (\\mathbf{a}\\cdot\\mathbf{n})\\mathbf{n} + (\\mathbf{a} - (\\mathbf{a}\\cdot\\mathbf{n})\\mathbf{n}) = \\mathbf{a}_n + \\mathbf{a}_t,\n$$\n其中 $\\mathbf{a}_n = (\\mathbf{a}\\cdot\\mathbf{n})\\mathbf{n}$ 是法向分量，$\\mathbf{a}_t$ 是切向分量，它位于 $T$ 的平面内。\n将此分解代入积分，得到两个部分：\n$$\nI(\\mathbf{a}) = \\int_{T}\\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot \\mathbf{a}_n}{R^{3}}\\,\\mathrm{d}S + \\int_{T}\\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot \\mathbf{a}_t}{R^{3}}\\,\\mathrm{d}S = I_n + I_t.\n$$\n\n首先，我们计算法向分量积分 $I_n$：\n$$\nI_n = \\int_{T}\\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot ((\\mathbf{a}\\cdot\\mathbf{n})\\mathbf{n})}{R^{3}}\\,\\mathrm{d}S = (\\mathbf{a}\\cdot\\mathbf{n}) \\int_{T}\\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot \\mathbf{n}}{R^{3}}\\,\\mathrm{d}S.\n$$\n根据定义，该积分项是在场点 $\\mathbf{r}_0$ 处由三角形 $T$ 所张的立体角 $\\Omega(T)$ 的负值。\n$$\n\\Omega(T) \\equiv -\\int_{T}\\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot \\mathbf{n}}{R^{3}}\\,\\mathrm{d}S.\n$$\n因此，来自 $\\mathbf{a}$ 的法向分量的贡献为\n$$\nI_n = -(\\mathbf{a}\\cdot\\mathbf{n})\\Omega(T).\n$$\n立体角 $\\Omega(T)$ 是一个标准的几何量，它取决于三角形的顶点 $\\{\\mathbf{r}_1, \\mathbf{r}_2, \\mathbf{r}_3\\}$ 和场点 $\\mathbf{r}_0$。\n\n接下来，我们计算切向分量积分 $I_t$：\n$$\nI_t = \\int_{T}\\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot \\mathbf{a}_t}{R^{3}}\\,\\mathrm{d}S.\n$$\n我们认识到 $\\frac{\\mathbf{r}-\\mathbf{r}_0}{R^3} = -\\nabla_{\\mathbf{r}}\\left(\\frac{1}{R}\\right)$。由于 $\\mathbf{a}_t$ 位于三角形平面内，与梯度的点积可以用曲面梯度算子 $\\nabla_S$ 来表示：\n$$\n(\\mathbf{r}-\\mathbf{r}_0)\\cdot \\mathbf{a}_t / R^3 = -\\left(\\nabla_{\\mathbf{r}}\\frac{1}{R}\\right)\\cdot\\mathbf{a}_t = -\\left(\\nabla_S\\frac{1}{R}\\right)\\cdot\\mathbf{a}_t.\n$$\n我们使用曲面散度的向量恒等式：$\\nabla_S \\cdot (\\phi \\mathbf{V}) = (\\nabla_S \\phi) \\cdot \\mathbf{V} + \\phi (\\nabla_S \\cdot \\mathbf{V})$。令 $\\phi = 1/R$ 和 $\\mathbf{V} = \\mathbf{a}_t$。由于 $\\mathbf{a}_t$ 是一个常向量，其曲面散度为零，即 $\\nabla_S \\cdot \\mathbf{a}_t = 0$。因此，\n$$\n\\nabla_S \\cdot \\left(\\frac{\\mathbf{a}_t}{R}\\right) = \\left(\\nabla_S \\frac{1}{R}\\right) \\cdot \\mathbf{a}_t.\n$$\n因此，$I_t$ 的被积函数是 $-\\nabla_S \\cdot \\left(\\frac{\\mathbf{a}_t}{R}\\right)$。我们现在可以将二维散度定理（格林定理的一种变体）应用于平面 $T$：\n$$\n\\int_T (\\nabla_S \\cdot \\mathbf{W}) \\,\\mathrm{d}S = \\oint_{\\partial T} \\mathbf{W} \\cdot \\mathbf{m} \\,\\mathrm{d}l,\n$$\n其中 $\\partial T$ 是三角形的边界（由其三条边组成），$\\mathbf{m}$ 是指向边界边外部的平面内单位法向量。问题将此向量定义为每条边 $e$ 的 $\\mathbf{m}_e$。\n将此定理应用于 $I_t$：\n$$\nI_t = - \\int_T \\nabla_S \\cdot \\left(\\frac{\\mathbf{a}_t}{R}\\right) \\,\\mathrm{d}S = - \\oint_{\\partial T} \\frac{\\mathbf{a}_t}{R} \\cdot \\mathbf{m} \\,\\mathrm{d}l.\n$$\n边界积分由三角形三条边的积分之和组成，我们将其标记为 $e \\in \\{1,2,3\\}$：\n$$\nI_t = - \\sum_{e=1}^3 \\int_{e} \\frac{\\mathbf{a}_t \\cdot \\mathbf{m}_e}{R} \\,\\mathrm{d}l.\n$$\n对于给定的边 $e$，向量 $\\mathbf{a}_t$ 和 $\\mathbf{m}_e$ 是常数。我们可以将它们从积分中提出来：\n$$\nI_t = - \\sum_{e=1}^3 (\\mathbf{a}_t \\cdot \\mathbf{m}_e) \\int_{e} \\frac{\\mathrm{d}l}{R}.\n$$\n项 $\\mathbf{a}_t \\cdot \\mathbf{m}_e = (\\mathbf{a} - (\\mathbf{a}\\cdot\\mathbf{n})\\mathbf{n}) \\cdot \\mathbf{m}_e$。由于 $\\mathbf{m}_e = \\mathbf{n} \\times \\mathbf{t}_e$，$\\mathbf{m}_e$ 与 $\\mathbf{n}$ 正交。因此，$\\mathbf{n} \\cdot \\mathbf{m}_e = 0$，表达式简化为 $\\mathbf{a}_t \\cdot \\mathbf{m}_e = \\mathbf{a} \\cdot \\mathbf{m}_e$。\n\n现在，我们必须计算每条边的线积分 $\\int_e \\frac{\\mathrm{d}l}{R}$。对于一条边 $e$，设包含它的直线由坐标 $s$ 参数化，表示沿单位切向量 $\\mathbf{t}_e$ 从点 $\\mathbf{p}_e$（直线上离 $\\mathbf{r}_0$ 最近的点）的有向距离。从 $\\mathbf{r}_0$ 到该直线上一点 $\\mathbf{r}$ 的距离 $R$ 为 $R = \\sqrt{s^2 + \\rho_e^2}$，其中 $\\rho_e = |\\mathbf{r}_0 - \\mathbf{p}_e|$ 是 $\\mathbf{r}_0$ 到该直线的恒定垂直距离。设该边的起点对应坐标 $s_{e,1}$，终点对应 $s_{e,2}$。线积分变为：\n$$\n\\int_e \\frac{\\mathrm{d}l}{R} = \\int_{s_{e,1}}^{s_{e,2}} \\frac{\\mathrm{d}s}{\\sqrt{s^2 + \\rho_e^2}}.\n$$\n这是一个标准积分，其原函数为 $\\ln(s + \\sqrt{s^2 + \\rho_e^2})$。在积分上下限处求值得到：\n$$\n\\int_e \\frac{\\mathrm{d}l}{R} = \\left[ \\ln(s + \\sqrt{s^2 + \\rho_e^2}) \\right]_{s_{e,1}}^{s_{e,2}} = \\ln(s_{e,2} + \\sqrt{s_{e,2}^2 + \\rho_e^2}) - \\ln(s_{e,1} + \\sqrt{s_{e,1}^2 + \\rho_e^2}).\n$$\n这可以紧凑地写成单个对数：\n$$\n\\int_e \\frac{\\mathrm{d}l}{R} = \\ln \\left( \\frac{s_{e,2} + \\sqrt{s_{e,2}^2+\\rho_e^2}}{s_{e,1} + \\sqrt{s_{e,1}^2+\\rho_e^2}} \\right).\n$$\n将其代回 $I_t$ 的表达式中：\n$$\nI_t = - \\sum_{e=1}^3 (\\mathbf{a} \\cdot \\mathbf{m}_e) \\ln \\left( \\frac{s_{e,2} + \\sqrt{s_{e,2}^2+\\rho_e^2}}{s_{e,1} + \\sqrt{s_{e,1}^2+\\rho_e^2}} \\right).\n$$\n结合法向和切向部分，我们得到积分 $I(\\mathbf{a})$ 的最终表达式：\n$$\nI(\\mathbf{a}) = -(\\mathbf{a} \\cdot \\mathbf{n})\\Omega(T) - \\sum_{e=1}^3 (\\mathbf{a} \\cdot \\mathbf{m}_e) \\ln \\left( \\frac{s_{e,2} + \\sqrt{s_{e,2}^2+\\rho_e^2}}{s_{e,1} + \\sqrt{s_{e,1}^2+\\rho_e^2}} \\right).\n$$\n\n该结果与使用边界元法 (BEM) 数值求解静电学中的边界积分方程 (BIEs) 高度相关。\n1.  **双层项与立体角：** 双层势算子核为 $\\frac{\\partial G}{\\partial n} = -\\frac{1}{4\\pi}\\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot\\mathbf{n}}{R^3}$。在离散化 BIE 时，必须计算此核在三角形板上的积分。我们对 $\\mathbf{a}=\\mathbf{n}$ 的结果表明，$\\int_T \\frac{(\\mathbf{r}-\\mathbf{r}_0)\\cdot\\mathbf{n}}{R^3} \\mathrm{d}S = -(\\mathbf{n}\\cdot\\mathbf{n})\\Omega(T) - \\sum (\\mathbf{n}\\cdot\\mathbf{m}_e)\\ln(\\dots) = -\\Omega(T)$，因为 $\\mathbf{n}\\cdot\\mathbf{n}=1$ 且 $\\mathbf{n}\\cdot\\mathbf{m}_e = 0$。这解析地证实了双层核在平坦板上的积分恰好是该板在场点所张立体角的负值。这对于评估 BEM 矩阵的对角线元素至关重要，因为在这些元素上奇点变得最为尖锐。\n\n2.  **奇异性的正则化：** 原始积分的被积函数量级为 $O(1/R^2)$。当场点 $\\mathbf{r}_0$ 非常接近三角形 $T$ 时，该被积函数变化迅速，使得数值积分困难且不准确。我们推导的公式将这个具有挑战性的二维积分转化为一个立体角项和三个涉及对数的一维边贡献之和。这是一种正则化形式。“奇异行为”被解析地捕捉和分离出来。所得表达式是良态的，即使对于靠近源三角形的场点（只要 $\\mathbf{r}_0$ 不直接在边上，此时对数项的参数需要小心处理），也可以准确高效地计算。这种解析处理对于 BEM 实现的稳定性和准确性至关重要。积分的切向部分（可能出现在更复杂的物理问题中，例如矢量势的表述）被简化为边项的简单求和，完全避免了对奇异核的二维积分。",
            "answer": "$$\n\\boxed{-(\\mathbf{a} \\cdot \\mathbf{n})\\Omega(T) - \\sum_{e=1}^3 (\\mathbf{a} \\cdot \\mathbf{m}_e) \\ln \\left( \\frac{s_{e,2} + \\sqrt{s_{e,2}^{2}+\\rho_e^{2}}}{s_{e,1} + \\sqrt{s_{e,1}^{2}+\\rho_e^{2}}} \\right)}\n$$"
        },
        {
            "introduction": "在掌握了如何正确处理奇异性的解析方法之后，理解若未能妥善处理将会带来何种严重后果，对于编写稳健的数值代码至关重要。这个动手编程练习将让你深入探究在矩量法 (MoM) 框架下，不当处理奇异和近奇异积分所引发的数值问题 。通过在一个简化的细线天线模型中人为地引入自作用项（奇异项）的误差，你将能够直接诊断并量化由此导致的物理互易性的破坏以及矩阵条件数的恶化，从而深刻体会为何精细的奇异性处理是不可或缺的。",
            "id": "3357690",
            "problem": "您的任务是设计并实现一种数值诊断方法，用以评估奇异自相互作用计算中的不精确性如何改变由电场积分方程 (EFIE) 产生的矩阵的谱特性和条件数，并提出基于对称性和互易性的测试来检测此类问题。您的实现必须是一个完整、可运行的程序。背景设定为一个简化的、但科学上一致的一维离散化模型，该模型用于模拟一根细直的理想电导体 (PEC) 线，采用矩量法 (MoM)，并使用脉冲 (分段常数) 基函数和分段中点配置法。\n\n从以下基本原理开始：\n\n- 频域中的麦克斯韦方程组表明，由表面电流产生的散射场可以通过一个包含自由空间格林函数的积分来表示。对于理想电导体 (PEC)，电场积分方程 (EFIE) 强制散射体表面的总切向电场为零，从而导出一个其核函数为自由空间格林函数的积分算子。\n- 三维亥姆霍兹方程的自由空间格林函数为 $G(\\mathbf{r},\\mathbf{r}') = \\dfrac{e^{\\mathrm{i} k \\lVert \\mathbf{r} - \\mathbf{r}' \\rVert}}{4\\pi \\lVert \\mathbf{r} - \\mathbf{r}' \\rVert}$，其中 $k$ 是以米分之一 ($\\mathrm{m}^{-1}$) 为单位的波数。由 $G$ 构建的积分算子在 $\\mathbf{r} = \\mathbf{r}'$ 处表现出源点奇异性，并在源-观察点几乎重合时表现出场点奇异性；在离散化过程中必须仔细处理这些奇异性，以保持物理互易性和理想的数值条件数。\n\n您的任务是：\n\n1. 为一根沿 $x$ 轴放置、长度为 $L$ 的细直导线建立离散 EFIE 系统的数学公式。该导线被划分为 $N$ 个等长分段，每段长度为 $\\Delta = L/N$。设分段中点为 $x_i = \\left(i + \\tfrac{1}{2}\\right)\\Delta$，其中 $i \\in \\{0,1,\\dots,N-1\\}$。使用脉冲基函数/测试函数 (中点配置法)。通过自由空间格林函数的双重积分的中点近似来定义矩阵元素 $A_{ij}$：\n   - 对于 $i \\neq j$，定义 $A_{ij} = \\Delta^2 \\, \\dfrac{e^{\\mathrm{i} k \\lvert x_i - x_j \\rvert}}{4\\pi \\lvert x_i - x_j \\rvert}$。\n   - 对于 $i = j$，通过与有限导线半径 $a$ (单位：米) 一致的细线正则化来替换奇异项，使用一个物理上合理的等效自作用项 $A_{ii}^{\\text{true}} = \\Delta^2 \\, \\dfrac{1}{4\\pi a}$。然后引入一个不精确的自作用项模型 $A_{ii}^{\\text{inacc}} = A_{ii}^{\\text{true}} \\, (1 + \\varepsilon)$，其中 $\\varepsilon$ 是一个无量纲的相对误差参数。这模拟了在处理对角线上的源点奇异性时出现的误差。\n   - 为了模拟可能破坏互易性的近奇异场相互作用中的不精确性 (同时保持相同的测试函数和基函数)，允许对相邻相互作用添加可选的非对称扰动：对于 $\\lvert i - j \\rvert = 1$ 和 $i  j$，仅向 $A_{ij}$ 添加一个偏斜项 $\\delta_{ij} = \\eta \\, \\operatorname{Re}(A_{ij})$ (不添加到 $A_{ji}$)，其中 $\\eta$ 是一个无量纲的偏斜参数。这模拟了对弱奇异性或非对称求积的不一致处理。\n\n2. 提出并实现基于对称性和互易性的诊断方法：\n   - 对称性残差：$s = \\dfrac{\\lVert A - A^{\\mathsf{T}} \\rVert_{\\mathrm{F}}}{\\lVert A \\rVert_{\\mathrm{F}}}$，其中 $\\lVert \\cdot \\rVert_{\\mathrm{F}}$ 表示弗罗贝尼乌斯范数，$(\\cdot)^{\\mathsf{T}}$ 表示转置。在具有对称核的互易伽辽金离散化中，矩阵应为复对称矩阵 ($A = A^{\\mathsf{T}}$)，因此 $s$ 可以诊断破坏互易性的非对称性。\n   - 互易性最大相对差异：$r = \\max_{i  j} \\dfrac{\\lvert A_{ij} - A_{ji} \\rvert}{\\max(\\lvert A_{ij} \\rvert, \\lvert A_{ji} \\rvert, \\tau)}$，其中 $\\tau$ 是一个小的正常数阈值，以避免除以零。该指标通过关注最差的一对元素，使对称性残差的诊断更加敏锐。\n   - 谱特性与条件数：计算 $A$ 的奇异值 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_N \\ge 0$，并定义条件数 $\\kappa = \\dfrac{\\sigma_{\\max}}{\\sigma_{\\min}^{+}}$，其中 $\\sigma_{\\max} = \\sigma_1$，$\\sigma_{\\min}^{+}$ 是超过数值阈值 $\\tau_\\sigma$ 的最小奇异值。同时计算谱半径 $\\rho = \\max_j \\lvert \\lambda_j \\rvert$，其中 $\\lambda_j$ 是 $A$ 的特征值。这些度量标准量化了不精确的自作用项计算对谱和条件数的影响。\n\n3. 将上述内容以代码形式实现为一个独立的程序，该程序能根据给定的参数 $(N, L, a, k, \\varepsilon, \\eta)$ 构建矩阵 $A$，计算 $(s, r, \\kappa, \\rho)$ 并输出它们。所有输出都应为无量纲数。使用以下测试套件来涵盖不同方面：\n   - 情况1 (理想情况，精确且互易)：$N = 16$, $L = 1.0\\,\\mathrm{m}$, $a = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $k = 10.0\\,\\mathrm{m}^{-1}$, $\\varepsilon = 0.0$, $\\eta = 0.0$。\n   - 情况2 (中等对角线误差，仍保持互易)：$N = 16$, $L = 1.0\\,\\mathrm{m}$, $a = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $k = 10.0\\,\\mathrm{m}^{-1}$, $\\varepsilon = 0.1$, $\\eta = 0.0$。\n   - 情况3 (低估的对角线，近对角线处互易性被破坏)：$N = 16$, $L = 1.0\\,\\mathrm{m}$, $a = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $k = 10.0\\,\\mathrm{m}^{-1}$, $\\varepsilon = -0.1$, $\\eta = 0.05$。\n   - 情况4 (低频边界，强对角线误差)：$N = 32$, $L = 1.0\\,\\mathrm{m}$, $a = 1.0 \\times 10^{-3}\\,\\mathrm{m}$, $k = 1.0 \\times 10^{-3}\\,\\mathrm{m}^{-1}$, $\\varepsilon = 0.5$, $\\eta = 0.0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例对应一个子列表，并按给定顺序排列。每个子列表的格式为 $[s, r, \\kappa, \\rho]$。例如，输出格式必须与 $[[s_1,r_1,\\kappa_1,\\rho_1],[s_2,r_2,\\kappa_2,\\rho_2],[s_3,r_3,\\kappa_3,\\rho_3],[s_4,r_4,\\kappa_4,\\rho_4]]$ 完全一致。不应打印任何其他文本。",
            "solution": "任务是设计并实现一种数值诊断方法，用以评估在细线电场积分方程 (EFIE) 的矩量法 (MoM) 离散化中，不精确性所带来的影响。该诊断方法将重点关注在计算奇异和近奇异相互作用时产生的误差如何影响最终 MoM 矩阵的对称性、互易性、谱特性以及条件数。\n\n### 1. MoM 矩阵的数学公式\n\n我们考虑一根长度为 $L$、半径为 $a$ 的细直理想电导体 (PEC) 线，其中心位于 $x$ 轴上。该导线被离散为 $N$ 个等长分段，每段长度为 $\\Delta = L/N$。导线上的电流使用分段常数 (脉冲) 基函数进行近似，每个分段对应一个基函数。EFIE 在每个分段的中点处强制执行 (配置法或点匹配法)。该过程最终导出一个形如 $A \\mathbf{I} = \\mathbf{V}$ 的线性方程组，其中 $A$ 是 $N \\times N$ 的 MoM 矩阵 (常被称为阻抗矩阵)，$\\mathbf{I}$ 是基函数的未知系数向量 (电流幅值)，$\\mathbf{V}$ 是由入射电场导出的激励向量。\n\n矩阵元素 $A_{ij}$ 表示由分段 $j$ (源分段，中心为 $x_j$) 上的单位幅值电流基函数在分段 $i$ (观察点，中心为 $x_i$) 的中心处产生的切向电场。各中点位于 $x_m = (m + 1/2)\\Delta$，其中 $m \\in \\{0, 1, \\dots, N-1\\}$。\n\n问题使用中点近似法定义了相互作用积分的矩阵元素，该方法基于亥姆霍兹方程的自由空间格林函数 $G(\\mathbf{r}, \\mathbf{r}') = \\frac{e^{\\mathrm{i}k \\lVert \\mathbf{r} - \\mathbf{r}' \\rVert}}{4\\pi \\lVert \\mathbf{r} - \\mathbf{r}' \\rVert}$，其中 $k$ 是波数。问题陈述中省略了物理常数 (例如 $\\mathrm{i}\\omega\\mu_0$)，这些常数会使 $A$ 具有阻抗的单位；按照当前定义，$A$ 的元素单位为长度。这对于一个数值诊断任务来说是可以接受的，因为其主要关注的是对称性、条件数以及谱半径的相对变化等性质。\n\n**非对角元素 ($i \\neq j$)：**\n对于不同的源分段和观察分段，相互作用通过计算分段中点之间的格林函数，并乘以分段长度的乘积 $\\Delta^2$ 来近似。中点之间的距离为 $\\lvert x_i - x_j \\rvert = \\lvert i - j \\rvert \\Delta$。\n$$\nA_{ij} = \\Delta^2 \\, \\frac{e^{\\mathrm{i} k \\lvert x_i - x_j \\rvert}}{4\\pi \\lvert x_i - x_j \\rvert} = \\Delta \\, \\frac{e^{\\mathrm{i} k \\lvert i - j \\rvert \\Delta}}{4\\pi \\lvert i - j \\rvert} \\quad \\text{对于 } i \\neq j\n$$\n\n**对角元素 ($i = j$)：**\n当源点和观察点重合 ($i=j$) 时，格林函数是奇异的，需要进行正则化处理。标准的细线近似将奇异核替换为一个依赖于导线半径 $a$ 的正则化值。问题指定了一个“真实”的、物理上合理的自作用项：\n$$\nA_{ii}^{\\text{true}} = \\Delta^2 \\, \\frac{1}{4\\pi a}\n$$\n为了模拟在计算这种自相互作用时的不精确性，引入了一个相对误差参数 $\\varepsilon$：\n$$\nA_{ii} = A_{ii}^{\\text{inacc}} = A_{ii}^{\\text{true}} (1 + \\varepsilon) = \\frac{\\Delta^2}{4\\pi a} (1 + \\varepsilon)\n$$\n\n**非对称扰动：**\n数值求积误差或对近奇异相互作用的不一致建模可能违反互易性原理，这表现为一个非对称矩阵 ($A \\neq A^{\\mathsf{T}}$)。通过向近对角元素添加一个偏斜项来模拟这种情况。对于 $|i - j| = 1$ 且 $i  j$ 的相邻分段 (即，在上第一副对角线上)，添加一个扰动：\n$$\nA_{ij} \\to A_{ij} + \\delta_{ij} \\quad \\text{对于 } j = i+1\n$$\n其中 $\\delta_{ij} = \\eta \\, \\operatorname{Re}(A_{ij})$，$\\eta$ 是一个无量纲的偏斜参数。相应的下副对角线元素 $A_{ji}$ 不被修改，从而破坏了矩阵的对称性。\n\n### 2. 用于矩阵分析的诊断度量\n\n为了量化这些不精确性的影响，我们采用四种诊断度量：\n\n**对称性残差 ($s$)：**\n在电磁学中，如果使用相同的基函数和测试函数 (即伽辽金方案)，并且几何结构和介质是互易的，那么互易性意味着 MoM 矩阵应该是对称的 ($A_{ij} = A_{ji}$)。在我们的配置法方案中，由于格林函数 $G(\\mathbf{r}, \\mathbf{r}') = G(\\mathbf{r}', \\mathbf{r})$ 的对称性，矩阵仍然应该是对称的 ($A=A^{\\mathsf{T}}$)。对称性残差在弗罗贝尼乌斯范数下衡量了对这一性质的偏离程度：\n$$\ns = \\frac{\\lVert A - A^{\\mathsf{T}} \\rVert_{\\mathrm{F}}}{\\lVert A \\rVert_{\\mathrm{F}}}\n$$\n一个接近于零的 $s$ 值表示一个数值上互易的系统。\n\n**互易性最大相对差异 ($r$)：**\n该度量提供了一种最坏情况下的非对称性度量，它能精确定位违反互易性最严重的元素对。\n$$\nr = \\max_{i  j} \\frac{\\lvert A_{ij} - A_{ji} \\rvert}{\\max(\\lvert A_{ij} \\rvert, \\lvert A_{ji} \\rvert, \\tau)}\n$$\n此处，$\\tau$ 是一个小的阈值，用于防止被小数除。与 $s$ 相比，该度量对局部误差更为敏感。\n\n**条件数 ($\\kappa$)：**\n矩阵的条件数衡量了线性系统 $A\\mathbf{I}=\\mathbf{V}$ 的解对 $A$ 或 $\\mathbf{V}$ 中扰动的敏感度。一个大的条件数意味着系统是病态的，此时小的数值误差可能导致计算出的电流 $\\mathbf{I}$ 出现大的误差。它使用 $A$ 的奇异值 ($\\sigma_j$) 来定义：\n$$\n\\kappa = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}^{+}}\n$$\n其中 $\\sigma_{\\max}$ 是最大的奇异值，而 $\\sigma_{\\min}^{+}$ 是大于机器精度阈值 $\\tau_\\sigma$ 的最小奇异值。自作用项中的误差 ($\\varepsilon \\neq 0$) 会显著改变奇异值谱，从而影响条件数。\n\n**谱半径 ($\\rho$)：**\n谱半径是矩阵特征值 ($\\lambda_j$) 的最大模：\n$$\n\\rho = \\max_j \\lvert \\lambda_j \\rvert\n$$\n它是一个基本量，控制着像 GMRES 或 BiCGSTAB 这类迭代求解器的收敛速度，这些求解器常用于大规模 MoM 问题。由数值误差引起的 $\\rho$ 变化会影响求解器的性能和稳定性。\n\n### 3. 实现与分析\n\n实现过程包括根据上述规则，为每一组参数 $(N, L, a, k, \\varepsilon, \\eta)$ 构建矩阵 $A$。一旦 $A$ 组装完毕，就使用标准的数值线性代数程序计算四个诊断度量。\n\n对于每个测试用例，算法按以下步骤进行：\n1.  计算离散化长度 $\\Delta = L/N$。\n2.  初始化一个 $N \\times N$ 的复数矩阵 $A$。\n3.  使用格林函数公式填充非对角元素 $A_{ij}$ ($i \\neq j$)。\n4.  使用正则化且受扰动的自作用项公式填充对角元素 $A_{ii}$。\n5.  如果 $\\eta \\neq 0$，将非对称扰动 $\\delta_{i,i+1}$ 添加到元素 $A_{i,i+1}$ 上 ($i \\in \\{0, \\dots, N-2\\}$)。\n6.  根据 $A$ 及其转置 $A^{\\mathsf{T}}$ 计算对称性残差 $s$。\n7.  通过遍历 $A$ 的上三角部分计算最大相对互易性误差 $r$。\n8.  计算 $A$ 的奇异值以求得条件数 $\\kappa$。\n9.  计算 $A$ 的特征值以求得谱半径 $\\rho$。\n10. 存储结果元组 $(s, r, \\kappa, \\rho)$。\n\n这个过程允许系统地研究特定的、模型化的数值误差是如何破坏矩量法矩阵的理想性质的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_and_analyze(N, L, a, k, eps, eta):\n    \"\"\"\n    Builds the MoM matrix for a 1D wire and computes diagnostic metrics.\n\n    Args:\n        N (int): Number of segments.\n        L (float): Length of the wire in meters.\n        a (float): Radius of the wire in meters.\n        k (float): Wavenumber in 1/meters.\n        eps (float): Relative error on diagonal terms.\n        eta (float): Skew parameter for near-diagonal asymmetry.\n\n    Returns:\n        tuple: A tuple containing (s, r, kappa, rho).\n    \"\"\"\n    \n    # Define numerical thresholds\n    tau = 1e-16  # Threshold for reciprocity discrepancy denominator\n    tau_sigma = 1e-16 # Threshold for singular values\n\n    # 1. Discretization and Matrix Construction\n    delta = L / N\n    A = np.zeros((N, N), dtype=np.complex128)\n\n    # Generate indices for vectorized computation\n    i_coords = np.arange(N).reshape(N, 1)\n    j_coords = np.arange(N).reshape(1, N)\n    \n    # Off-diagonal entries\n    dist_ij = np.abs(i_coords - j_coords)\n    off_diag_mask = (dist_ij != 0)\n    \n    R = dist_ij[off_diag_mask] * delta\n    \n    # Pre-factor for off-diagonal terms\n    # A_ij = Delta^2 * G(xi, xj) where G is the Green's function\n    # A_ij = Delta^2 * exp(i*k*R) / (4*pi*R)\n    c_off_diag = delta**2 / (4.0 * np.pi)\n    A[off_diag_mask] = c_off_diag * np.exp(1j * k * R) / R\n\n    # Diagonal entries\n    # A_ii = Delta^2 / (4*pi*a) * (1 + eps)\n    A_ii_true = (delta**2) / (4.0 * np.pi * a)\n    A_ii_inacc = A_ii_true * (1.0 + eps)\n    np.fill_diagonal(A, A_ii_inacc)\n\n    # Asymmetric perturbations\n    if eta != 0.0:\n        for i in range(N - 1):\n            j = i + 1\n            # For j > i and |i-j|=1, add skew term\n            A[i, j] += eta * np.real(A[i, j])\n\n    # 2. Compute Diagnostic Metrics\n    \n    # Symmetry residual (s)\n    norm_A = np.linalg.norm(A, 'fro')\n    if norm_A == 0:\n        s = 0.0\n    else:\n        norm_A_minus_AT = np.linalg.norm(A - A.T, 'fro')\n        s = norm_A_minus_AT / norm_A\n\n    # Reciprocity maximum relative discrepancy (r)\n    max_rel_disc = 0.0\n    # Iterate through upper triangle\n    for i in range(N):\n        for j in range(i + 1, N):\n            num = np.abs(A[i, j] - A[j, i])\n            den = np.max([np.abs(A[i, j]), np.abs(A[j, i]), tau])\n            rel_disc = num / den\n            if rel_disc > max_rel_disc:\n                max_rel_disc = rel_disc\n    r = max_rel_disc\n    \n    # Condition number (kappa)\n    singular_values = np.linalg.svd(A, compute_uv=False)\n    sigma_max = singular_values[0] if len(singular_values) > 0 else 0.0\n    \n    positive_sv = singular_values[singular_values > tau_sigma]\n    if len(positive_sv) == 0:\n        kappa = np.inf\n    else:\n        sigma_min_plus = np.min(positive_sv)\n        if sigma_min_plus == 0:\n             kappa = np.inf\n        else:\n             kappa = sigma_max / sigma_min_plus\n\n    # Spectral radius (rho)\n    if N > 0:\n        eigenvalues = np.linalg.eigvals(A)\n        rho = np.max(np.abs(eigenvalues))\n    else:\n        rho = 0.0\n\n    return s, r, kappa, rho\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # (N, L, a, k, eps, eta)\n    test_cases = [\n        (16, 1.0, 1.0e-3, 10.0, 0.0, 0.0),      # Case 1\n        (16, 1.0, 1.0e-3, 10.0, 0.1, 0.0),      # Case 2\n        (16, 1.0, 1.0e-3, 10.0, -0.1, 0.05),    # Case 3\n        (32, 1.0, 1.0e-3, 1.0e-3, 0.5, 0.0),      # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        N, L, a, k, eps, eta = case\n        s, r, kappa, rho = build_and_analyze(N, L, a, k, eps, eta)\n        results.append([s, r, kappa, rho])\n    \n    # Format the final output string exactly as required\n    # e.g., [[s1,r1,k1,rho1],[s2,r2,k2,rho2],...]\n    output_str = \"[\" + \",\".join(\n        \"[\" + \",\".join(map(str, sublist)) + \"]\" for sublist in results\n    ) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "从理想化的平面过渡到实际的曲面几何，是奇异性处理所面临的一个重要挑战。这个高级实践将探讨一种被广泛应用的策略——局部平坦化，即为了进行奇异性提取，将曲面单元局部地用其切平面来近似 。在本练习中，你不仅需要为弱奇异积分实现这一技术，还需推导出一个与表面曲率相关的显式误差界。这将帮助你深入理解这类近似的精度，并掌握其在复杂真实世界问题中的应用，从而架起平坦单元理论与实际工程应用之间的桥梁。",
            "id": "3357731",
            "problem": "考虑三维空间中一个局部参数化的曲面元，在源点附近由一个 Monge 贴片表示，其形式为 $\\mathbf{r}(u,v) = \\big(u, v, z(u,v)\\big)$，其中 $z(u,v)$ 二次可微且满足 $z(0,0) = 0$，$\\partial z/\\partial u(0,0) = 0$ 和 $\\partial z/\\partial v(0,0) = 0$。设原点处的主曲率为 $\\kappa_1$ 和 $\\kappa_2$，因此 $z(u,v)$ 的主阶近似可表示为 $z(u,v) \\approx \\tfrac{1}{2} \\big(\\kappa_1 u^2 + \\kappa_2 v^2\\big)$。\n\n从基于麦克斯韦方程组和三维标量亥姆霍兹方程的自由空间格林函数的电磁场边界积分表示中，会遇到具有弱奇异核（在静态极限下）的积分，其形式为 $G(\\mathbf{r},\\mathbf{r}_0) = \\tfrac{1}{4\\pi R}$，其中 $R = \\|\\mathbf{r} - \\mathbf{r}_0\\|$ 且 $\\mathbf{r}_0$ 是曲面上的一个源点。在静态极限 $k = 0$ 下，可以考虑曲面元上的标量积分\n$$\nI_{\\text{curved}} = \\int_{\\mathcal{E}} \\frac{1}{4\\pi \\, R(u,v)} \\, \\mathrm{d}S,\n$$\n其中曲面元满足 $\\mathrm{d}S = \\sqrt{1 + z_u^2 + z_v^2}\\,\\mathrm{d}u\\,\\mathrm{d}v$，且 $z_u = \\partial z/\\partial u$ 和 $z_v = \\partial z/\\partial v$。\n\n计算电磁学中一个经典的奇异性提取策略是将曲面几何替换为其在 $\\mathbf{r}_0$ 处的局部平坦切平面，并减去相应的解析奇异贡献，留下一个光滑且可数值积分的余项。在切平面的极坐标中，$(u,v) = (\\rho\\cos\\theta, \\rho\\sin\\theta)$，对于 $\\rho \\in [0,a]$ 和 $\\theta \\in [0,2\\pi)$，其中 $a$ 表示单元的面内半径，一个自然的平面参考积分是\n$$\nI_{\\text{flat}} = \\int_0^{2\\pi}\\int_0^a \\frac{1}{4\\pi \\, \\rho} \\, \\rho\\, \\mathrm{d}\\rho\\,\\mathrm{d}\\theta.\n$$\n奇异性提取后的余项则为\n$$\nE = I_{\\text{curved}} - I_{\\text{flat}} = \\frac{1}{4\\pi}\\int_0^{2\\pi}\\int_0^a \\left[ \\frac{\\rho}{R(\\rho,\\theta)} \\sqrt{1 + S(\\rho,\\theta)} - 1 \\right] \\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta,\n$$\n其中 $S(\\rho,\\theta) = z_u^2 + z_v^2$ 且 $R(\\rho,\\theta) = \\sqrt{\\rho^2 + z(\\rho,\\theta)^2}$。\n\n你的任务是：\n- 从基本定律（麦克斯韦方程组）和自由空间格林函数出发，解释当源点位于单元上时，为何核函数呈现出弱 $1/R$ 奇异性，以及为何通过局部平坦化几何的奇异性提取方法能够分离出一个可解析积分的奇异部分。\n- 专用于 $z(u,v) \\approx \\tfrac{1}{2}(\\kappa_1 u^2 + \\kappa_2 v^2)$ 的 Monge 贴片，在一个面内半径为 $a$ 的圆盘上，推导一个用单元尺寸 $a$ 和曲率 $\\kappa_1$、$\\kappa_2$ 来表示的、关于曲率引起的余项 $|E|$ 大小的显式、可计算上界。该界必须通过对 $R(\\rho,\\theta)$ 和 $\\sqrt{1+S(\\rho,\\theta)}$ 应用不等式来获得，并且必须对 $\\kappa_1$ 和 $\\kappa_2$ 的任意符号都有效。\n- 设计一个算法，该算法使用极坐标参数化 $(\\rho,\\theta)$ 在半径为 $a$ 的圆盘上对 $E$ 进行数值计算，确保被积函数在 $\\rho = 0$ 处是正则的且数值积分是稳定的。然后计算推导出的上界，并验证数值计算的 $|E|$ 小于或等于该界。\n\n所有长度必须以米表示，曲率以米分之一表示。角度 $\\theta$ 必须以弧度表示。\n\n测试套件和输出规范：\n- 使用以下测试用例，每个用例由 $(\\kappa_1, \\kappa_2, a)$ 指定，其中 $\\kappa_1$ 和 $\\kappa_2$ 的单位是 $\\text{m}^{-1}$， $a$ 的单位是 $\\text{m}$：\n    1. $(0.2, 0.1, 0.05)$\n    2. $(0, 0, 0.05)$\n    3. $(2.0, -1.5, 0.02)$\n    4. $(0.3, 0.25, 0.10)$\n    5. $(1.0, 0.0, 0.03)$\n- 对于每个测试用例，你的程序必须计算一个布尔值，该值指示数值计算的 $|E|$ 是否小于或等于推导出的界限（使用一个小的绝对容差来适应数值积分误差）。\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[b_1,b_2,b_3,b_4,b_5]$，其中每个 $b_i$ 为 $\\text{True}$ 或 $\\text{False}$。\n\n覆盖性设计：\n- 第一个测试用例是具有中等曲率和小单元尺寸的通用“正常路径”。\n- 第二个测试用例是一个边界条件（完全平坦的单元），其中余项和界限都应为零。\n- 第三个测试用例在一个小单元上包含符号不同且量级相对较高的曲率，以检验界限对曲率量级的依赖性。\n- 第四个测试用例在具有中等曲率的情况下增大了单元尺寸，以探究界限随 $a$ 的缩放关系。\n- 第五个测试用例是一个各向异性情况，其中一个主曲率为零，另一个非零。\n\n你的最终答案必须是一个完整的、可运行的程序，该程序执行上述操作并打印指定的输出格式。",
            "solution": "该问题有效。这是一个在计算电磁学领域内适定且有科学依据的问题，涉及边界元方法中出现的奇异积分的数值处理。所有必要的信息均已提供，任务也已明确定义。\n\n### 1. 理论框架与奇异性提取\n\n计算由曲面上的源产生的势或场是物理学和工程学（包括电磁学）许多领域的核心问题。在静态或低频状态下，麦克斯韦方程组简化为椭圆型偏微分方程，例如标量势 $\\phi$ 的拉普拉斯方程或泊松方程。解可以通过边界积分方程公式来表示。这涉及到在域边界 $\\partial \\Omega$ 上对加权源分布进行积分。权重函数是控制微分算子的自由空间格林函数或基本解。\n\n对于三维标量亥姆霍兹方程 $(\\nabla^2 + k^2)\\phi = f$，格林函数为 $G(\\mathbf{r}, \\mathbf{r}_0) = \\frac{e^{-ikR}}{4\\pi R}$，其中 $R = \\|\\mathbf{r} - \\mathbf{r}_0\\|$。在静态极限下，波数 $k \\to 0$，控制方程变为拉普拉斯/泊松方程 $\\nabla^2\\phi = f$，格林函数简化为 $G(\\mathbf{r}, \\mathbf{r}_0) = \\frac{1}{4\\pi R}$。该核是势论的特征。\n\n在求解边界积分方程时，必须计算形式为 $\\int_{\\mathcal{S}} G(\\mathbf{r}, \\mathbf{r}_0) \\sigma(\\mathbf{r}_0) \\mathrm{d}S_0$ 的积分，其中 $\\sigma$ 是曲面 $\\mathcal{S}$ 上的源密度。如果观察点 $\\mathbf{r}$ 位于积分曲面 $\\mathcal{S}$ 上，当积分变量 $\\mathbf{r}_0$ 接近 $\\mathbf{r}$ 时，核函数 $G(\\mathbf{r}, \\mathbf{r}_0)$ 会变得奇异，因为 $R \\to 0$。这被称为“源点奇异性”。$1/R$ 奇异性是“弱奇异”的，这意味着积分是良定义且收敛的，但它使得依赖于光滑被积函数的标准数值积分方法（如高斯积分法）失效。\n\n为了克服这个问题，采用了奇异性提取技术。该技术的原理是加上并减去一个与原被积函数具有相同奇异行为但又足够简单以至于可以解析积分的项。原始项与减去项之间的差是一个正则（非奇异）函数，可以使用标准数值积分方法精确积分。\n\n问题描述了这样一个过程。我们感兴趣的积分是在曲面元 $\\mathcal{E}$ 上的 $I_{\\text{curved}} = \\int_{\\mathcal{E}} \\frac{1}{4\\pi R} \\mathrm{d}S$。奇异性发生在 $R=0$ 处。奇异点附近的曲面局部几何由其切平面近似。在这个平面上，与原点的距离 $R$ 变成了平面径向距离 $\\rho$。可解析积分的奇异部分被构造为一个在半径为 $a$ 的平坦圆盘上的积分，即 $I_{\\text{flat}}$。在切平面上的极坐标 $(\\rho, \\theta)$ 中，微分面积元为 $\\mathrm{d}A = \\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta$。积分 $I_{\\text{flat}}$ 定义为：\n$$\nI_{\\text{flat}} = \\int_0^{2\\pi} \\int_0^a \\frac{1}{4\\pi \\rho} \\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta = \\frac{1}{4\\pi} \\int_0^{2\\pi} \\mathrm{d}\\theta \\int_0^a \\mathrm{d}\\rho = \\frac{1}{4\\pi} (2\\pi)(a) = \\frac{a}{2}\n$$\n这个积分是解析的，并且捕捉了原始积分的奇异行为。因此，“余项” $E = I_{\\text{curved}} - I_{\\text{flat}}$ 是一个正则函数的积分，适合进行数值计算。$E$ 的被积函数量化了用平坦贴片局部近似曲面贴片所产生的误差。\n\n### 2. 余项上界的推导\n\n余项由下式给出\n$$\nE = \\frac{1}{4\\pi}\\int_0^{2\\pi}\\int_0^a \\left[ \\frac{\\rho}{R(\\rho,\\theta)} \\sqrt{1 + S(\\rho,\\theta)} - 1 \\right] \\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta\n$$\n令被积函数为 $f(\\rho, \\theta) = \\frac{\\rho \\sqrt{1 + S}}{R} - 1$。使用 $R = \\sqrt{\\rho^2 + z^2}$，我们可以将其重写为：\n$$\nf(\\rho, \\theta) = \\frac{\\rho \\sqrt{1 + S}}{\\rho \\sqrt{1 + z^2/\\rho^2}} - 1 = \\frac{\\sqrt{1 + S}}{\\sqrt{1 + z^2/\\rho^2}} - 1\n$$\n我们使用为 Monge 贴片提供的近似。以源点为原点，u,v 平面为切平面，曲面为 $z(u,v) \\approx \\frac{1}{2}(\\kappa_1 u^2 + \\kappa_2 v^2)$。在极坐标 $u=\\rho\\cos\\theta, v=\\rho\\sin\\theta$ 中：\n$$\nz(\\rho, \\theta) \\approx \\frac{1}{2}\\rho^2(\\kappa_1 \\cos^2\\theta + \\kappa_2 \\sin^2\\theta) = \\frac{1}{2}\\rho^2 K(\\theta)\n$$\n其中 $K(\\theta) = \\kappa_1 \\cos^2\\theta + \\kappa_2 \\sin^2\\theta$。\n项 $S$ 是 $S = z_u^2 + z_v^2$。利用 $z_u = \\partial z/\\partial u \\approx \\kappa_1 u = \\kappa_1 \\rho\\cos\\theta$ 和 $z_v = \\partial z/\\partial v \\approx \\kappa_2 v = \\kappa_2 \\rho\\sin\\theta$，我们得到：\n$$\nS(\\rho, \\theta) \\approx \\rho^2(\\kappa_1^2 \\cos^2\\theta + \\kappa_2^2 \\sin^2\\theta) = \\rho^2 K_2(\\theta)\n$$\n其中 $K_2(\\theta) = \\kappa_1^2 \\cos^2\\theta + \\kappa_2^2 \\sin^2\\theta$。\n$S$ 和 $z^2/\\rho^2$ 都是非负的。我们可以使用不等式 $\\sqrt{1+x} \\le 1 + x/2$（对于 $x\\ge 0$）和 $1/\\sqrt{1+y} \\le 1$（对于 $y \\ge 0$）来限定 $f(\\rho, \\theta)$。\n$$\nf(\\rho, \\theta) = \\frac{\\sqrt{1 + \\rho^2 K_2(\\theta)}}{\\sqrt{1 + \\frac{1}{4}\\rho^2 K(\\theta)^2}} - 1 \\le \\sqrt{1 + \\rho^2 K_2(\\theta)} - 1 \\le \\left(1 + \\frac{1}{2}\\rho^2 K_2(\\theta)\\right) - 1 = \\frac{1}{2}\\rho^2 K_2(\\theta)\n$$\n对于下界，我们使用 $\\sqrt{1+x} \\ge 1$ 和 $1/\\sqrt{1+y} \\ge 1-y/2$（对于 $y \\ge0$）。\n$$\nf(\\rho, \\theta) \\ge 1 \\cdot \\left(1 - \\frac{1}{2} \\cdot \\frac{1}{4}\\rho^2 K(\\theta)^2\\right) - 1 = -\\frac{1}{8}\\rho^2 K(\\theta)^2\n$$\n结合这些，我们得到被积函数大小的一个界：\n$$\n|f(\\rho, \\theta)| \\le \\max\\left( \\frac{1}{2}\\rho^2 K_2(\\theta), \\frac{1}{8}\\rho^2 K(\\theta)^2 \\right) = \\frac{1}{2}\\rho^2 \\max\\left( K_2(\\theta), \\frac{1}{4} K(\\theta)^2 \\right)\n$$\n为了获得一个与 $\\theta$ 无关的界，我们求出 $K_2(\\theta)$ 和 $K(\\theta)^2$ 的最大值。令 $\\kappa_{\\max} = \\max(|\\kappa_1|, |\\kappa_2|)$。\n$K_2(\\theta) = \\kappa_1^2 \\cos^2\\theta + \\kappa_2^2 \\sin^2\\theta \\le \\kappa_{\\max}^2 \\cos^2\\theta + \\kappa_{\\max}^2 \\sin^2\\theta = \\kappa_{\\max}^2$。\n$|K(\\theta)| = |\\kappa_1 \\cos^2\\theta + \\kappa_2 \\sin^2\\theta| \\le |\\kappa_1|\\cos^2\\theta + |\\kappa_2|\\sin^2\\theta \\le \\kappa_{\\max}(\\cos^2\\theta+\\sin^2\\theta) = \\kappa_{\\max}$。因此，$K(\\theta)^2 \\le \\kappa_{\\max}^2$。\n这得到：\n$$\n|f(\\rho, \\theta)| \\le \\frac{1}{2}\\rho^2 \\max\\left(\\kappa_{\\max}^2, \\frac{1}{4}\\kappa_{\\max}^2\\right) = \\frac{1}{2}\\rho^2 \\kappa_{\\max}^2\n$$\n现在，我们对这个界进行积分，以求出 $|E|$ 的上界：\n$$\n|E| = \\left|\\frac{1}{4\\pi}\\int_0^{2\\pi}\\int_0^a f(\\rho,\\theta) \\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta\\right| \\le \\frac{1}{4\\pi}\\int_0^{2\\pi}\\int_0^a |f(\\rho,\\theta)| \\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta\n$$\n$$\n|E| \\le \\frac{1}{4\\pi}\\int_0^{2\\pi}\\int_0^a \\left(\\frac{1}{2}\\rho^2 \\kappa_{\\max}^2\\right) \\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta = \\frac{\\kappa_{\\max}^2}{8\\pi} \\int_0^{2\\pi} \\left[\\frac{\\rho^3}{3}\\right]_0^a \\,\\mathrm{d}\\theta = \\frac{\\kappa_{\\max}^2 a^3}{24\\pi} \\int_0^{2\\pi} \\mathrm{d}\\theta\n$$\n$$\n|E| \\le \\frac{\\kappa_{\\max}^2 a^3}{24\\pi} (2\\pi) = \\frac{1}{12} a^3 \\kappa_{\\max}^2\n$$\n这就是所期望的、用单元半径 $a$ 和最大主曲率大小 $\\kappa_{\\max}$ 表示的 $|E|$ 的可计算上界。\n\n### 3. 数值算法设计\n\n为了验证该界，我们需要数值计算 $E$ 并将其大小与推导出的界进行比较。算法如下：\n\n1.  对于每个测试用例 $(\\kappa_1, \\kappa_2, a)$：\n2.  计算上界 $B = \\frac{1}{12} a^3 (\\max(|\\kappa_1|,|\\kappa_2|))^2$。\n3.  对 $E$ 进行二维积分的数值计算：\n    $$\n    E = \\frac{1}{4\\pi} \\int_0^{2\\pi} \\int_0^a \\left( \\frac{\\rho \\sqrt{1 + \\rho^2(\\kappa_1^2 \\cos^2\\theta + \\kappa_2^2 \\sin^2\\theta)}}{\\sqrt{\\rho^2 + \\frac{1}{4}\\rho^4(\\kappa_1 \\cos^2\\theta + \\kappa_2 \\sin^2\\theta)^2}} - 1 \\right) \\mathrm{d}\\rho\\,\\mathrm{d}\\theta\n    $$\n    这个积分可以使用数值积分库（如 `scipy.integrate.dblquad`）来计算。被积函数在 $\\rho=0$ 处是正则的，其行为如同 $O(\\rho^2)$，这确保了标准积分程序的稳定性和准确性。用于积分程序的被积函数以 $\\rho$ 和 $\\theta$ 为参数，并计算方括号内的值。在 $\\rho=0$ 处必须特别小心，因为表达式的形式是 $0/0$。当 $\\rho \\to 0$ 时，项 $\\rho/R$ 的极限是 $1$，整个被积函数的极限是 $0$。\n4.  将数值计算出的余项的绝对值 $|E_{\\text{num}}|$ 与界 $B$进行比较。验证条件是 $|E_{\\text{num}}| \\le B$。为了考虑数值积分误差，给界加上一个小的绝对容差。\n5.  对每个测试用例，存储比较的结果（一个布尔值）。\n\n$\\kappa_1=\\kappa_2=0$ 的情况作为一个关键的合理性检查。此时，曲面是平的，$z=0, S=0$，所以被积函数恒为零，导致 $E=0$。界 $B$ 也为 $0$，因此条件 $0 \\le 0$ 成立。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the problem by numerically evaluating the remainder integral E,\n    computing the derived analytical bound, and comparing them for several\n    test cases.\n    \"\"\"\n    \n    # Test cases as tuples of (kappa_1, kappa_2, a)\n    # kappa in m^-1, a in m\n    test_cases = [\n        (0.2, 0.1, 0.05),\n        (0.0, 0.0, 0.05),\n        (2.0, -1.5, 0.02),\n        (0.3, 0.25, 0.10),\n        (1.0, 0.0, 0.03),\n    ]\n\n    results = []\n    # Tolerance for comparing numerical result with the bound.\n    tolerance = 1e-9\n\n    for k1, k2, a in test_cases:\n        \n        # --- Part 1: Calculate the derived upper bound ---\n        kappa_max = max(abs(k1), abs(k2))\n        bound = (1/12) * a**3 * kappa_max**2\n\n        # --- Part 2: Numerically evaluate the remainder E ---\n        \n        # Define the integrand for the remainder integral E.\n        # The integrand is: rho/R * sqrt(1+S) - 1\n        def integrand(rho, theta, kappa_1, kappa_2):\n            if rho == 0.0:\n                # The limit of the integrand as rho -> 0 is 0.\n                return 0.0\n            \n            cos_theta = np.cos(theta)\n            sin_theta = np.sin(theta)\n            cos_sq_theta = cos_theta**2\n            sin_sq_theta = sin_theta**2\n            \n            # z(u,v) = 1/2 * (k1*u^2 + k2*v^2)\n            # In polar: z(rho, theta) = 1/2 * rho^2 * (k1*c^2 + k2*s^2)\n            k_theta = kappa_1 * cos_sq_theta + kappa_2 * sin_sq_theta\n            z_val = 0.5 * rho**2 * k_theta\n            \n            # R = sqrt(rho^2 + z^2)\n            R_val = np.sqrt(rho**2 + z_val**2)\n            \n            # S = z_u^2 + z_v^2 = (k1*u)^2 + (k2*v)^2\n            # In polar: S = (k1*rho*c)^2 + (k2*rho*s)^2\n            S_val = (kappa_1 * rho * cos_theta)**2 + (kappa_2 * rho * sin_theta)**2\n            \n            # The integrand is regular at rho=0\n            term = (rho / R_val) * np.sqrt(1.0 + S_val) - 1.0\n            return term\n\n        # Use dblquad for numerical 2D integration.\n        # The integral is over theta in [0, 2*pi] and rho in [0, a].\n        integral_val, _ = integrate.dblquad(\n            integrand, 0, 2*np.pi, lambda t: 0, lambda t: a,\n            args=(k1, k2)\n        )\n        \n        # The remainder E is the integral divided by 4*pi.\n        E_numerical = integral_val / (4.0 * np.pi)\n\n        # --- Part 3: Verify the bound ---\n        # Check if the magnitude of the numerical result is within the bound,\n        # allowing for a small numerical tolerance.\n        is_within_bound = abs(E_numerical) = bound + tolerance\n        results.append(is_within_bound)\n\n    # Convert boolean results to string 'True' or 'False'\n    # and format the output as a comma-separated list in brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n\n```"
        }
    ]
}