{
    "hands_on_practices": [
        {
            "introduction": "散射参数不仅是数学工具，它们还必须遵守基本的物理定律，如能量守恒。对于无源器件，输出功率不能超过输入功率。这项动手实践  将指导您实现一个基于坡印亭通量的数值测试，用于自动检测从仿真软件中提取的S参数是否违反了无源性，这是确保仿真结果物理真实性的关键验证步骤。",
            "id": "3346657",
            "problem": "考虑一个由散射参数（S参数）建模的线性时不变多端口微波网络。设入射波振幅向量表示为 $\\mathbf{a} \\in \\mathbb{C}^N$，散射（出射）波振幅向量表示为 $\\mathbf{b} \\in \\mathbb{C}^N$。散射关系为 $\\mathbf{b} = \\mathbf{S} \\mathbf{a}$，其中 $\\mathbf{S} \\in \\mathbb{C}^{N \\times N}$ 是从计算电磁学求解器中数值提取的散射矩阵。假设每个端口都采用标准的功率波归一化，且参考阻抗为正实数，使得与端口波相关的时间平均净 Poynting 通量满足 $\\sum_{j=1}^N |b_j|^2 - \\sum_{i=1}^N |a_i|^2 = P_{\\text{out}} - P_{\\text{in}}$，其中 $P_{\\text{in}}$ 和 $P_{\\text{out}}$ 分别是所有端口的总输入功率和总输出功率。\n\n从 Maxwell 方程组和时谐场的 Poynting 定理出发，通过包围器件的表面的时间平均净向外 Poynting 通量等于输入功率减去任何耗散功率。对于无损耗无源网络，耗散功率为零，能量守恒意味着对于任何激励 $\\mathbf{a}$，都有 $P_{\\text{out}} - P_{\\text{in}} = 0$。在离散计算环境中，定义一个基于 Poynting 通量的测试，该测试对于一组有限的激励 $\\{\\mathbf{a}^{(k)}\\}$，计算量\n$$\n\\Delta^{(k)} = \\sum_{j=1}^N \\left| b^{(k)}_j \\right|^2 - \\sum_{i=1}^N \\left| a^{(k)}_i \\right|^2,\n$$\n其中 $\\mathbf{b}^{(k)} = \\mathbf{S} \\mathbf{a}^{(k)}$，然后在用户选择的数值容差 $\\tau > 0$ 内，只要任何 $k$ 对应的 $\\Delta^{(k)}  -\\tau$，就标记在无损耗设置的数值提取 $\\mathbf{S}$ 中存在违规。该容差用于解释有限精度计算中的舍入误差。\n\n您的任务是实现一个完整的程序，对以下指定的测试套件执行此离散测试。对于每个测试用例，计算所提供的任何激励是否产生低于容差的负 Poynting 通量差，并返回一个布尔值，指示是否检测到此类违规。\n\n使用以下测试套件：\n\n- 情况1（双端口，理想无损耗交换）：$N=2$，\n$$\n\\mathbf{S}_1 = \\begin{bmatrix} 0  1 \\\\ 1  0 \\end{bmatrix},\n$$\n激励\n$$\n\\mathbf{a}^{(1)}_1 = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\\quad\n\\mathbf{a}^{(1)}_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix},\\quad\n\\mathbf{a}^{(1)}_3 = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ \\mathrm{j} \\end{bmatrix}.\n$$\n\n- 情况2（双端口，数值有损耗交换）：$N=2$，\n$$\n\\mathbf{S}_2 = \\begin{bmatrix} 0  0.99 \\\\ 0.99  0 \\end{bmatrix},\n$$\n激励\n$$\n\\mathbf{a}^{(2)}_1 = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\\quad\n\\mathbf{a}^{(2)}_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix},\\quad\n\\mathbf{a}^{(2)}_3 = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ \\mathrm{j} \\end{bmatrix}.\n$$\n\n- 情况3（双端口，有源对角增益）：$N=2$，\n$$\n\\mathbf{S}_3 = \\begin{bmatrix} 1.01  0 \\\\ 0  1.01 \\end{bmatrix},\n$$\n激励\n$$\n\\mathbf{a}^{(3)}_1 = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\\quad\n\\mathbf{a}^{(3)}_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix},\\quad\n\\mathbf{a}^{(3)}_3 = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ -\\mathrm{j} \\end{bmatrix}.\n$$\n\n- 情况4（三端口，幺正离散傅里叶变换）：$N=3$，\n$$\n\\mathbf{S}_4 = \\frac{1}{\\sqrt{3}} \\begin{bmatrix}\n1  1  1 \\\\\n1  e^{\\mathrm{j}\\frac{2\\pi}{3}}  e^{\\mathrm{j}\\frac{4\\pi}{3}} \\\\\n1  e^{\\mathrm{j}\\frac{4\\pi}{3}}  e^{\\mathrm{j}\\frac{8\\pi}{3}}\n\\end{bmatrix},\n$$\n激励\n$$\n\\mathbf{a}^{(4)}_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix},\\quad\n\\mathbf{a}^{(4)}_2 = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix},\\quad\n\\mathbf{a}^{(4)}_3 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix},\\quad\n\\mathbf{a}^{(4)}_4 = \\begin{bmatrix} 1 \\\\ e^{\\mathrm{j}\\frac{\\pi}{4}} \\\\ e^{-\\mathrm{j}\\frac{\\pi}{3}} \\end{bmatrix}.\n$$\n\n- 情况5（双端口，在容差范围内的近似无损耗）：$N=2$，\n$$\n\\mathbf{S}_5 = \\begin{bmatrix} 0  1 - 10^{-7} \\\\ 1 - 10^{-7}  0 \\end{bmatrix},\n$$\n激励\n$$\n\\mathbf{a}^{(5)}_1 = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\\quad\n\\mathbf{a}^{(5)}_2 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix},\\quad\n\\mathbf{a}^{(5)}_3 = \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ \\mathrm{j} \\end{bmatrix}.\n$$\n\n对所有情况使用共同的容差 $\\tau = 10^{-6}$。\n\n实现一个算法，对于每种情况，评估所有指定激励的 $\\Delta^{(k)}$，如果任何一个 $\\Delta^{(k)}  -\\tau$，则返回布尔值 $\\mathrm{True}$，否则返回 $\\mathrm{False}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4,r_5]$）作为结果，其中每个 $r_m$ 是情况 $m$ 的布尔结果。不需要物理单位，也不需要角度单位转换；复指数应以弧度处理。",
            "solution": "我们从时谐场的 Maxwell 微分形式方程组开始，采用 $e^{\\mathrm{j}\\omega t}$ 的时间约定：\n$$\n\\nabla \\times \\mathbf{E} = -\\mathrm{j}\\omega \\mu \\mathbf{H}, \\quad\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\mathrm{j}\\omega \\epsilon \\mathbf{E}.\n$$\n复 Poynting 矢量为 $\\mathbf{S} = \\frac{1}{2} \\mathbf{E} \\times \\mathbf{H}^*$，时间平均的 Poynting 定理在包围器件的闭合曲面 $\\partial V$ 上积分得到\n$$\n\\int_{\\partial V} \\mathrm{Re}\\{\\mathbf{S}\\} \\cdot \\mathbf{\\hat{n}} \\, \\mathrm{d}A = P_{\\text{out}} = P_{\\text{in}} - P_{\\text{diss}},\n$$\n其中 $P_{\\text{in}}$ 是源通过端口输送的时间平均功率，$P_{\\text{diss}}$ 是在体积 $V$ 内部耗散的时间平均功率。对于无损耗无源器件，$P_{\\text{diss}} = 0$，能量守恒意味着 $P_{\\text{out}} = P_{\\text{in}}$。\n\n在具有标准功率波归一化和正实数参考阻抗的多端口微波网络理论中，入射和出射端口波分别由 $\\mathbf{a} \\in \\mathbb{C}^N$ 和 $\\mathbf{b} \\in \\mathbb{C}^N$ 表示。散射关系是线性的：\n$$\n\\mathbf{b} = \\mathbf{S} \\mathbf{a},\n$$\n其中 $\\mathbf{S} \\in \\mathbb{C}^{N \\times N}$ 是散射矩阵（S参数）。在功率波归一化下，通过端口进入和离开的总时间平均功率为\n$$\nP_{\\text{in}} = \\sum_{i=1}^N |a_i|^2, \\qquad P_{\\text{out}} = \\sum_{j=1}^N |b_j|^2.\n$$\n对于无损耗无源网络，Poynting 定理意味着对于任何激励 $\\mathbf{a}$，都有 $P_{\\text{out}} - P_{\\text{in}} = 0$。该条件等价于散射矩阵的幺正性，即 $\\mathbf{S}^\\dagger \\mathbf{S} = \\mathbf{I}$，但在离散数值环境中，我们直接从端口波功率评估能量守恒，以避免依赖可能被数值误差掩盖的全局矩阵属性。\n\n将特定激励 $\\mathbf{a}^{(k)}$ 的离散 Poynting 通量差定义为\n$$\n\\Delta^{(k)} = \\sum_{j=1}^N \\left| b^{(k)}_j \\right|^2 - \\sum_{i=1}^N \\left| a^{(k)}_i \\right|^2,\n$$\n其中 $\\mathbf{b}^{(k)} = \\mathbf{S} \\mathbf{a}^{(k)}$。在无损耗器件的精确算术中，对所有 $k$ 都有 $\\Delta^{(k)} = 0$。在有限精度计算中，我们引入一个容差 $\\tau > 0$，如果存在任何激励 $k$ 使得 $\\Delta^{(k)}  -\\tau$，我们则声明其违反了无损耗设置。负号专门用于识别超出容差的表观净吸收，这与假定的无损耗性不符。正值表示表观净产生（有源行为），这也违反了无损耗性；然而，所要求的测试标记负值侧，以检测提取的 $\\mathbf{S}$ 中明显的耗散不一致性。\n\n算法上，对于每个测试用例：\n1. 初始化容差 $\\tau = 10^{-6}$。\n2. 对于每个指定的激励向量 $\\mathbf{a}^{(k)}$，计算 $\\mathbf{b}^{(k)} = \\mathbf{S} \\mathbf{a}^{(k)}$。\n3. 计算 $\\Delta^{(k)} = \\sum_{j=1}^N |b^{(k)}_j|^2 - \\sum_{i=1}^N |a^{(k)}_i|^2$。\n4. 如果任何 $\\Delta^{(k)}  -\\tau$，则将该情况标记为违规（返回 $\\mathrm{True}$）；否则，返回 $\\mathrm{False}$。\n\n我们现在对所提供的测试套件的预期结果进行推理：\n\n- 情况1：$\\mathbf{S}_1$ 以单位幅度交换端口，且激励具有单位总功率。对于每个激励，$P_{\\text{out}} = P_{\\text{in}}$，因此 $\\Delta^{(k)} = 0$，不会标记违规。结果是 $\\mathrm{False}$。\n\n- 情况2：$\\mathbf{S}_2$ 以 $0.99$ 的幅度交换端口，所以 $P_{\\text{out}} = 0.99^2 P_{\\text{in}} = 0.9801 P_{\\text{in}}$。对于单位功率的激励，$\\Delta^{(k)} = 0.9801 - 1 = -0.0199  -\\tau$，这会标记一个违规。结果是 $\\mathrm{True}$。\n\n- 情况3：$\\mathbf{S}_3$ 在每个端口上施加 $1.01$ 的增益，所以 $P_{\\text{out}} = 1.01^2 P_{\\text{in}} = 1.0201 P_{\\text{in}}$，得出 $\\Delta^{(k)} = 0.0201 > 0$。这不满足条件 $\\Delta^{(k)}  -\\tau$，所以测试不会标记负违规。结果是 $\\mathrm{False}$。\n\n- 情况4：$\\mathbf{S}_4$ 是由 $1/\\sqrt{3}$ 归一化的 $3 \\times 3$ 离散傅里叶变换矩阵，它是幺正的。因此，对于任何激励，$P_{\\text{out}} = P_{\\text{in}}$，在数值精度范围内产生 $\\Delta^{(k)} \\approx 0$，没有负违规。结果是 $\\mathrm{False}$。\n\n- 情况5：$\\mathbf{S}_5$ 近似无损耗，幅度为 $1 - 10^{-7}$；因此 $P_{\\text{out}} = (1 - 10^{-7})^2 P_{\\text{in}} \\approx (1 - 2 \\cdot 10^{-7}) P_{\\text{in}}$。对于单位功率的激励，$\\Delta^{(k)} \\approx -2 \\cdot 10^{-7}$，这大于 $-\\tau = -10^{-6}$，因此在指定的容差下不会标记违规。结果是 $\\mathrm{False}$。\n\n程序精确地实现了这些计算，并输出一行包含与五个情况相对应的布尔值列表 $[r_1,r_2,r_3,r_4,r_5]$。",
            "answer": "```python\nimport numpy as np\n\ndef poynting_flux_difference(S: np.ndarray, a: np.ndarray) - float:\n    \"\"\"\n    Compute Delta = sum |b_j|^2 - sum |a_i|^2 for b = S a.\n    \"\"\"\n    b = S @ a\n    return float(np.sum(np.abs(b) ** 2) - np.sum(np.abs(a) ** 2))\n\ndef check_negative_violation(S: np.ndarray, excitations: list, tol: float) - bool:\n    \"\"\"\n    Return True if any excitation produces Delta  -tol.\n    \"\"\"\n    for a in excitations:\n        delta = poynting_flux_difference(S, a)\n        if delta  -tol:\n            return True\n    return False\n\ndef solve():\n    tau = 1e-6  # tolerance\n\n    # Case 1: two-port, ideal lossless swap\n    S1 = np.array([[0.0, 1.0],\n                   [1.0, 0.0]], dtype=complex)\n    a1_1 = np.array([1.0+0.0j, 0.0+0.0j])\n    a1_2 = np.array([0.0+0.0j, 1.0+0.0j])\n    a1_3 = (1/np.sqrt(2)) * np.array([1.0+0.0j, 1.0j])\n    excitations1 = [a1_1, a1_2, a1_3]\n\n    # Case 2: two-port, numerically lossy swap\n    S2 = np.array([[0.0, 0.99],\n                   [0.99, 0.0]], dtype=complex)\n    a2_1 = np.array([1.0+0.0j, 0.0+0.0j])\n    a2_2 = np.array([0.0+0.0j, 1.0+0.0j])\n    a2_3 = (1/np.sqrt(2)) * np.array([1.0+0.0j, 1.0j])\n    excitations2 = [a2_1, a2_2, a2_3]\n\n    # Case 3: two-port, active diagonal gain\n    S3 = np.array([[1.01, 0.0],\n                   [0.0, 1.01]], dtype=complex)\n    a3_1 = np.array([1.0+0.0j, 0.0+0.0j])\n    a3_2 = np.array([0.0+0.0j, 1.0+0.0j])\n    a3_3 = (1/np.sqrt(2)) * np.array([1.0+0.0j, -1.0j])\n    excitations3 = [a3_1, a3_2, a3_3]\n\n    # Case 4: three-port, unitary DFT\n    # Construct the 3x3 DFT matrix normalized by 1/sqrt(3)\n    N = 3\n    F = np.zeros((N, N), dtype=complex)\n    for m in range(N):\n        for n in range(N):\n            F[m, n] = np.exp(1j * 2 * np.pi * m * n / N)\n    S4 = (1/np.sqrt(3)) * F\n    a4_1 = np.array([1.0+0.0j, 0.0+0.0j, 0.0+0.0j])\n    a4_2 = np.array([0.0+0.0j, 1.0+0.0j, 0.0+0.0j])\n    a4_3 = np.array([0.0+0.0j, 0.0+0.0j, 1.0+0.0j])\n    a4_4 = np.array([1.0+0.0j, np.exp(1j*np.pi/4), np.exp(-1j*np.pi/3)])\n    excitations4 = [a4_1, a4_2, a4_3, a4_4]\n\n    # Case 5: two-port, near-lossless within tolerance\n    S5 = np.array([[0.0, 1.0 - 1e-7],\n                   [1.0 - 1e-7, 0.0]], dtype=complex)\n    a5_1 = np.array([1.0+0.0j, 0.0+0.0j])\n    a5_2 = np.array([0.0+0.0j, 1.0+0.0j])\n    a5_3 = (1/np.sqrt(2)) * np.array([1.0+0.0j, 1.0j])\n    excitations5 = [a5_1, a5_2, a5_3]\n\n    test_cases = [\n        (S1, excitations1),\n        (S2, excitations2),\n        (S3, excitations3),\n        (S4, excitations4),\n        (S5, excitations5),\n    ]\n\n    results = []\n    for S, excitations in test_cases:\n        violation = check_negative_violation(S, excitations, tau)\n        results.append(violation)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "互易性是许多线性无源电磁系统的基本属性，在散射参数中表现为矩阵的对称性（即 $S_{ij} = S_{ji}$）。然而，计算电磁学中的数值离散化方法可能会引入破坏这种对称性的误差，即使模拟的物理系统本身是互易的。通过这个练习 ，您将学会构建一个简单的一维模型来观察这种数值现象，并通过网格加密来量化该误差如何收敛于零，这是验证任何数值模型收敛性的核心技能。",
            "id": "3346695",
            "problem": "考虑一个频域中的一维横向电磁波传输问题，该问题由 Maxwell 方程推导出的电报方程建模，适用于具有单位长度电感 $L'$ 和电容 $C'$ 的均匀、互易、无损介质：\n$$\\frac{dV}{dx} = -Z' I,\\quad \\frac{dI}{dx} = -Y' V,$$\n其中，对于角频率 $\\omega = 2\\pi f$，$Z' = i \\omega L'$ 且 $Y' = i \\omega C'$。对于任何具有对称本构关系和相等端口参考阻抗的互易介质，其双端口散射矩阵 $\\mathbf{S}$ 是对称的，即 $S_{12} = S_{21}$。\n\n在计算电磁学中，空间导数的离散化会引入不对称性，在有限网格尺寸下破坏互易性，这种不对称性应在网格细化过程中消失。在本问题中，您将演示并量化应用于电报方程的一阶单边空间离散化（空间上的前向欧拉步进）如何破坏散射矩阵的对称性，以及当空间步长 $h \\to 0$ 时，这种不对称性如何收敛到零。\n\n使用以下构造。在一个长度为 $L$ 的线段上，将其离散为 $N$ 个大小为 $h = L/N$ 的均匀单元，应用前向欧拉更新\n$$\\begin{bmatrix}V_{n+1} \\\\ I_{n+1}\\end{bmatrix} = \\mathbf{T}_h \\begin{bmatrix}V_{n} \\\\ I_{n}\\end{bmatrix},\\quad \\mathbf{T}_h = \\begin{bmatrix}1  -h Z' \\\\ -h Y'  1\\end{bmatrix}.$$\n该线段的总链式 (ABCD) 矩阵为\n$$\\mathbf{M}(h) = \\left(\\mathbf{T}_h\\right)^N = \\begin{bmatrix}A  B \\\\ C  D\\end{bmatrix}.$$\n对于两端口相等的参考阻抗 $Z_0$，通过链式矩阵定义散射参数如下\n$$\\Delta = A + \\frac{B}{Z_0} + C Z_0 + D,$$\n$$S_{11} = \\frac{A + \\frac{B}{Z_0} - C Z_0 - D}{\\Delta},\\quad S_{21} = \\frac{2}{\\Delta},\\quad S_{12} = \\frac{2\\det(\\mathbf{M})}{\\Delta},\\quad S_{22} = \\frac{-A + \\frac{B}{Z_0} - C Z_0 + D}{\\Delta},$$\n其中 $\\det(\\mathbf{M}) = AD - BC$。对于一个真正的互易系统，$\\det(\\mathbf{M}) = 1$，这意味着 $S_{12} = S_{21}$；对于所述的离散化方法，在有限的 $h$ 下 $\\det(\\mathbf{M}) \\neq 1$，而 $|S_{12} - S_{21}|$ 量化了破坏互易性的误差。\n\n您的任务是：\n- 实现上述离散化的双端口模型。\n- 对于一个固定的物理配置和网格细化路径 $h_k = L/N_k$（其中 $N_k$ 以2的幂次增加），计算序列 $E(h_k) = |S_{12}(h_k) - S_{21}(h_k)|$。\n- 通过对对数-对数数据 $\\{\\log h_k, \\log E(h_k)\\}$ 进行最小二乘拟合，估计由模型 $E(h) \\approx C h^p$（当 $h \\to 0$ 时）定义的收敛率 $p$。\n\n使用以下测试套件，每个测试由国际单位制 (SI) 中的 $(L, f, L', C', Z_0)$ 和每个测试指定的细化路径 $N_k \\in \\{N_0, 2N_0, 4N_0, 8N_0\\}$ 给出。所有物理量必须以其标准国际单位制 (SI) 单位进行解释。任何内部三角计算的角度均以弧度为单位。估计的收敛率是无量纲的，应作为实数输出。\n\n- 测试 1 (正常路径，匹配线): $(L, f, L', C', Z_0) = (\\,0.5\\,\\mathrm{m},\\, 1.0\\times 10^9\\,\\mathrm{Hz},\\, 250\\times 10^{-9}\\,\\mathrm{H/m},\\, 100\\times 10^{-12}\\,\\mathrm{F/m},\\, 50\\,\\Omega\\,)$，使用 $N_k \\in \\{\\,128,\\,256,\\,512,\\,1024\\,\\}$。\n- 测试 2 (失配，中等电气长度): $(L, f, L', C', Z_0) = (\\,0.3\\,\\mathrm{m},\\, 0.5\\times 10^9\\,\\mathrm{Hz},\\, 400\\times 10^{-9}\\,\\mathrm{H/m},\\, 100\\times 10^{-12}\\,\\mathrm{F/m},\\, 50\\,\\Omega\\,)$，使用 $N_k \\in \\{\\,64,\\,128,\\,256,\\,512\\,\\}$。\n- 测试 3 (边界情况，小互易性误差): $(L, f, L', C', Z_0) = (\\,0.2\\,\\mathrm{m},\\, 2.0\\times 10^9\\,\\mathrm{Hz},\\, 250\\times 10^{-9}\\,\\mathrm{H/m},\\, 50\\times 10^{-12}\\,\\mathrm{F/m},\\, 50\\,\\Omega\\,)$，使用 $N_k \\in \\{\\,64,\\,128,\\,256,\\,512\\,\\}$。\n\n您的程序应计算上述三个测试中每个测试的估计收敛率 $p$，并生成一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[p_1,p_2,p_3]$）。这三个值必须与上面列出的三个测试的顺序相同。程序必须是自包含的，并且不需要任何输入。",
            "solution": "该问题被认为是有效的，因为它科学地基于电磁波传播和数值分析的原理，是自包含的，并且是适定的。所提供的参数在物理上是现实的，该任务是计算科学中的一个标准练习，特别是量化数值误差的收敛率。\n\n目标是确定由一维电报方程的一阶前向欧拉空间离散化引入的破坏互易性的误差的收敛率。如果 $S_{12} = S_{21}$，则由其散射矩阵 $\\mathbf{S}$ 描述的双端口网络的互易性得到保证。连续的物理系统是互易的，但数值离散化在有限的空间步长下违反了这一特性。我们的任务是在误差模型 $E(h) \\approx C h^p$ 中估计收敛阶数 $p$，其中 $E(h) = |S_{12}(h) - S_{21}(h)|$，$h$ 是空间步长。\n\n对每个测试案例的分析过程如下。\n\n首先，我们根据给定的输入 $(L, f, L', C', Z_0)$ 定义物理和电气参数。角频率为 $\\omega = 2\\pi f$。无损传输线的单位长度串联阻抗 $Z'$ 和并联导纳 $Y'$ 是纯虚数：\n$$Z' = i \\omega L'$$\n$$Y' = i \\omega C'$$\n其中 $i$ 是虚数单位。对于固定的频率 $f$，这些是复数值常量。\n\n接下来，我们实现指定的数值方案。总长度为 $L$ 的传输线被离散为 $N$ 个均匀单元，每个单元的长度为 $h = L/N$。由 $n$ 索引的相邻节点处的电压 $V$ 和电流 $I$ 通过一阶前向欧拉更新规则相关联：\n$$\n\\begin{bmatrix}\nV_{n+1} \\\\\nI_{n+1}\n\\end{bmatrix}\n=\n\\mathbf{T}_h\n\\begin{bmatrix}\nV_{n} \\\\\nI_{n}\n\\end{bmatrix}\n$$\n其中 $\\mathbf{T}_h$ 是长度为 $h$ 的单个单元的局部传输矩阵：\n$$\n\\mathbf{T}_h =\n\\begin{bmatrix}\n1  -h Z' \\\\\n-h Y'  1\n\\end{bmatrix}\n$$\n总链式矩阵，也称为 ABCD 矩阵 $\\mathbf{M}(h)$，将输入端（端口1，$x=0$）的量与输出端（端口2，$x=L$）的量关联起来。它是通过组合所有 $N$ 个单元的局部传输矩阵得到的：\n$$\n\\mathbf{M}(h) = (\\mathbf{T}_h)^N =\n\\begin{bmatrix}\nA  B \\\\\nC  D\n\\end{bmatrix}\n$$\n在测试序列中，对每个离散化水平 $N_k$ 进行该矩阵幂的数值计算。\n\n该数值模型中互易性误差的来源在于传输矩阵的行列式。对于一个真正的互易双端口网络，其 ABCD 矩阵的行列式必须为 $1$。对于我们的数值方案，局部矩阵的行列式为：\n$$ \\det(\\mathbf{T}_h) = (1)(1) - (-h Z')(-h Y') = 1 - h^2 Z' Y' = 1 + h^2 \\omega^2 L' C' $$\n由于对于任何 $h > 0$，都有 $\\det(\\mathbf{T}_h) \\neq 1$，因此总矩阵 $\\mathbf{M}(h)$ 的行列式也不为单位值：\n$$ \\det(\\mathbf{M}(h)) = (\\det(\\mathbf{T}_h))^N = (1 + h^2 \\omega^2 L' C')^N $$\n这种与单位值的偏差直接导致了 S 矩阵的不对称性。\n\n散射参数是根据 $\\mathbf{M}(h)$ 的元素和参考阻抗 $Z_0$，使用提供的公式计算的：\n$$ \\Delta = A + \\frac{B}{Z_0} + C Z_0 + D $$\n$$ S_{12} = \\frac{2\\det(\\mathbf{M})}{\\Delta} \\quad \\text{and} \\quad S_{21} = \\frac{2}{\\Delta} $$\n破坏互易性的误差定义为 $E(h) = |S_{12}(h) - S_{21}(h)|$。代入 $S_{12}$ 和 $S_{21}$ 的表达式：\n$$ E(h) = \\left| \\frac{2\\det(\\mathbf{M})}{\\Delta} - \\frac{2}{\\Delta} \\right| = \\frac{2}{|\\Delta|} |\\det(\\mathbf{M}) - 1| $$\n为了理解当 $h \\to 0$ 时的收敛行为，我们分析 $|\\det(\\mathbf{M}) - 1|$ 这一项。由于 $N = L/h$，我们有 $\\det(\\mathbf{M}) = (1 + h^2 \\omega^2 L' C')^{L/h}$。对于小的 $x$ 使用二项式近似 $(1 + x)^n \\approx 1 + nx$，其中当 $h$ 很小时，$x = h^2 \\omega^2 L' C'$ 也很小：\n$$ \\det(\\mathbf{M}) \\approx 1 + N(h^2 \\omega^2 L' C') = 1 + \\frac{L}{h}(h^2 \\omega^2 L' C') = 1 + (L \\omega^2 L' C')h $$\n因此， $|\\det(\\mathbf{M})-1|$ 的阶数为 $O(h)$。当 $h \\to 0$ 时，$\\Delta$ 项收敛到一个对应于连续系统的有限非零常数。因此，误差 $E(h)$ 预计为 $O(h)$ 阶，这意味着理论收敛率为 $p=1$。\n\n为了数值上估计 $p$，我们使用模型 $E(h) \\approx C h^p$。对两边取自然对数可以使关系线性化：\n$$ \\ln(E(h)) \\approx \\ln(C) + p \\ln(h) $$\n该方程的形式为 $y = c + mx$，其中 $y = \\ln(E)$，$x = \\ln(h)$，斜率即为收敛率 $m=p$。对于每个测试案例，我们在给定的细化路径中为每个步长 $h_k = L/N_k$ 计算误差 $E(h_k)$。然后我们对数据集 $\\{\\ln(h_k), \\ln(E_k)\\}$ 执行线性最小二乘回归。最佳拟合线的斜率提供了收敛率 $p$ 的数值估计。对所有三个测试案例重复此过程。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    \n    # Test cases defined as tuples:\n    # (L, f, L', C', Z0, N_values)\n    # L: length in meters\n    # f: frequency in Hertz\n    # L': per-unit-length inductance in Henrys/meter\n    # C': per-unit-length capacitance in Farads/meter\n    # Z0: reference impedance in Ohms\n    # N_values: list of discretization counts\n    test_cases = [\n        (0.5, 1.0e9, 250e-9, 100e-12, 50.0, [128, 256, 512, 1024]),\n        (0.3, 0.5e9, 400e-9, 100e-12, 50.0, [64, 128, 256, 512]),\n        (0.2, 2.0e9, 250e-9, 50e-12, 50.0, [64, 128, 256, 512]),\n    ]\n\n    results = []\n    for params in test_cases:\n        p = calculate_convergence_rate(*params)\n        results.append(p)\n\n    # Format the output as a comma-separated list in square brackets.\n    # The problem example shows integers, but results are floats.\n    # Default string conversion is used as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_convergence_rate(L, f, L_prime, C_prime, Z0, N_values):\n    \"\"\"\n    Calculates the convergence rate p for a single test case.\n\n    Args:\n        L (float): Length of the transmission line in meters.\n        f (float): Frequency in Hertz.\n        L_prime (float): Per-unit-length inductance in H/m.\n        C_prime (float): Per-unit-length capacitance in F/m.\n        Z0 (float): Reference impedance in Ohms.\n        N_values (list): A list of integers for the number of cells N.\n\n    Returns:\n        float: The estimated convergence rate p.\n    \"\"\"\n    \n    omega = 2 * math.pi * f\n    Z_prime = 1j * omega * L_prime\n    Y_prime = 1j * omega * C_prime\n\n    h_values = []\n    E_values = []\n\n    for N in N_values:\n        h = L / N\n        \n        # Construct the local transfer matrix T_h\n        T_h = np.array([[1, -h * Z_prime],\n                        [-h * Y_prime, 1]], dtype=np.complex128)\n        \n        # Calculate the total ABCD matrix M = (T_h)^N\n        M = np.linalg.matrix_power(T_h, N)\n        A, B = M[0, 0], M[0, 1]\n        C, D = M[1, 0], M[1, 1]\n        \n        # Calculate the S-parameters from the ABCD matrix\n        # Note: np.linalg.det() can be less accurate than manual calculation\n        # for a 2x2 matrix. A*D - B*C is more stable.\n        det_M = A * D - B * C\n        delta = A + B/Z0 + C*Z0 + D\n        \n        S12 = (2 * det_M) / delta\n        S21 = 2 / delta\n        \n        # Calculate the reciprocity error E(h)\n        E = abs(S12 - S21)\n        \n        h_values.append(h)\n        E_values.append(E)\n\n    # Convert lists to numpy arrays for vectorized operations\n    h_values = np.array(h_values)\n    E_values = np.array(E_values)\n\n    # Take the natural logarithm for log-log regression\n    log_h = np.log(h_values)\n    log_E = np.log(E_values)\n    \n    # Perform a linear least-squares fit on the log-log data.\n    # np.polyfit with degree 1 returns [slope, intercept].\n    # The slope is the convergence rate p.\n    p, _ = np.polyfit(log_h, log_E, 1)\n    \n    return p\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "在实际的仿真和测量中，我们通常得到的是包含待测器件（DUT）及其馈线或测试夹具在内的整个系统的S参数。为了获得DUT本身的精确特性，必须从测量结果中“移除”这些额外结构的影响。这项实践  教授一种称为“去嵌入”的关键后处理技术，它通过将S参数转换为传输（ABCD）矩阵，以级联和求逆的方式，精确地分离出DUT的散射参数。",
            "id": "3346692",
            "problem": "在一个全波数值求解器中，一个双端口测量结构由两侧各一个相同的馈电发射器和一个在单一频率下工作的互易待测器件 (DUT) 组成。所有端口都参考于一个实特征阻抗 $Z_{0} = 50\\,\\Omega$。求解器返回整个三块级联结构（左馈电、DUT、右馈电）的散射矩阵 $S$。你的任务是通过构建传输（链）矩阵并以代数方式移除馈电的贡献，从而对馈电进行去嵌入，以恢复 DUT 的散射矩阵。\n\n推导需基于第一性原理：定义端口 $n$ 处的复功率波变量 $a_{n}$ 和 $b_{n}$，陈述散射矩阵关系 $b = S\\,a$，并用端口电压和电流定义传输（链）矩阵（$A$–$B$–$C$–$D$ 矩阵）。仅使用这些定义和线性代数，从 $S$ 推导出 $A$–$B$–$C$–$D$ 矩阵。利用两侧存在相同馈电这一事实，通过适当的矩阵求逆和级联操作来执行去嵌入。\n\n在工作频率下，单个馈电发射器的散射参数为\n$$\nS_{11}^{(\\mathrm{feed})} = \\frac{1}{10},\\quad S_{22}^{(\\mathrm{feed})} = \\frac{1}{10},\\quad S_{21}^{(\\mathrm{feed})} = \\frac{19}{20},\\quad S_{12}^{(\\mathrm{feed})} = \\frac{19}{20},\n$$\n模拟的整体三块级联结构（馈电–DUT–馈电）的散射参数为\n$$\nS_{11}^{(\\mathrm{tot})} = S_{22}^{(\\mathrm{tot})} = \\frac{491}{3105},\\quad S_{21}^{(\\mathrm{tot})} = S_{12}^{(\\mathrm{tot})} = \\frac{1805}{2484}.\n$$\n\n使用 $Z_{0}$ 构建电压-电流链形式 $(A,B;C,D)$ 的传输矩阵 $T^{(\\mathrm{feed})}$ 和 $T^{(\\mathrm{tot})}$，然后通过代数方法移除两侧的馈电来恢复 DUT 的传输矩阵。使用你推导出的关系式，将得到的 DUT 传输矩阵转换回 $S^{(\\mathrm{DUT})}$。\n\n在此频率下，DUT 的前向传输系数 $S_{21}^{(\\mathrm{DUT})}$ 的值是多少？将你的最终答案表示为一个实数，并四舍五入到四位有效数字。",
            "solution": "我们从实参考阻抗为 $Z_{0}$ 的端口处的功率波定义开始：对于端口 $n$，入射波 $a_{n}$ 和反射波 $b_{n}$ 与端口电压 $V_{n}$ 和电流 $I_{n}$ 的关系如下：\n$$\na_{n} = \\frac{V_{n} + Z_{0} I_{n}}{2\\sqrt{Z_{0}}},\\qquad b_{n} = \\frac{V_{n} - Z_{0} I_{n}}{2\\sqrt{Z_{0}}}.\n$$\n双端口散射关系为\n$$\n\\begin{pmatrix} b_{1} \\\\ b_{2} \\end{pmatrix}\n=\n\\begin{pmatrix}\nS_{11}  S_{12} \\\\\nS_{21}  S_{22}\n\\end{pmatrix}\n\\begin{pmatrix} a_{1} \\\\ a_{2} \\end{pmatrix}.\n$$\n对于级联，方便的表示法是电压-电流传输（链）矩阵，通常记作 $(A,B;C,D)$（$A$–$B$–$C$–$D$ 矩阵），其定义如下：\n$$\n\\begin{pmatrix} V_{1} \\\\ I_{1} \\end{pmatrix}\n=\n\\begin{pmatrix}\nA  B \\\\\nC  D\n\\end{pmatrix}\n\\begin{pmatrix} V_{2} \\\\ I_{2} \\end{pmatrix}.\n$$\n我们的基本基础是在 $Z_{0}$ 归一化功率波框架下的线性网络理论，该理论确保了 $S$ 和 $(A,B;C,D)$ 通过底层的 $(V,I)$ 变量呈线性相关。\n\n为了从 $S$ 推导出 $(A,B;C,D)$，我们使用定义将 $(V,I)$ 用 $(a,b)$ 表示：\n$$\nV_{n} = \\sqrt{Z_{0}}(a_{n} + b_{n}),\\qquad I_{n} = \\frac{1}{\\sqrt{Z_{0}}}(a_{n} - b_{n}),\n$$\n并与 $b = S\\,a$ 结合。消去 $a_{2}$ 和 $b_{2}$ 以 $(V_{2}, I_{2})$ 表示，并类似地将 $(V_{1}, I_{1})$ 用 $(a_{1}, b_{1})$ 表示，经过代数操作后，得到：\n$$\nA = \\frac{(1+S_{11})(1-S_{22}) + S_{12} S_{21}}{2 S_{21}},\\quad\nB = Z_{0}\\,\\frac{(1+S_{11})(1+S_{22}) - S_{12} S_{21}}{2 S_{21}},\n$$\n$$\nC = \\frac{1}{Z_{0}}\\,\\frac{(1-S_{11})(1-S_{22}) - S_{12} S_{21}}{2 S_{21}},\\quad\nD = \\frac{(1-S_{11})(1+S_{22}) + S_{12} S_{21}}{2 S_{21}}.\n$$\n这些关系式直接源于 $(a,b)$ 和 $(V,I)$ 之间的线性变换以及链矩阵的定义。\n\n相反地，在实 $Z_{0}$ 条件下，将 $(A,B;C,D)$ 转换回 $S$ 可以通过求解带有 $(V,I)$ 波的端口匹配问题得到：\n$$\n\\Delta \\equiv A + \\frac{B}{Z_{0}} + C Z_{0} + D,\n$$\n$$\nS_{21} = \\frac{2}{\\Delta},\\quad\nS_{11} = \\frac{A + \\frac{B}{Z_{0}} - C Z_{0} - D}{\\Delta},\\quad\nS_{22} = \\frac{-A + \\frac{B}{Z_{0}} - C Z_{0} + D}{\\Delta},\\quad\nS_{12} = \\frac{2(AD - BC)}{\\Delta}.\n$$\n\n现在我们根据给定的 $S^{(\\mathrm{feed})}$ 在 $Z_{0} = 50$ 时计算馈电发射器的 $(A,B;C,D)^{(\\mathrm{feed})}$：\n$$\nS_{11}^{(\\mathrm{feed})} = \\frac{1}{10},\\quad S_{22}^{(\\mathrm{feed})} = \\frac{1}{10},\\quad S_{21}^{(\\mathrm{feed})} = S_{12}^{(\\mathrm{feed})} = \\frac{19}{20}.\n$$\n计算所需乘积：\n$$\n(1+S_{11})(1-S_{22}) = \\left(1 + \\frac{1}{10}\\right)\\left(1 - \\frac{1}{10}\\right) = \\frac{11}{10}\\cdot\\frac{9}{10} = \\frac{99}{100},\n$$\n$$\nS_{12} S_{21} = \\left(\\frac{19}{20}\\right)^{2} = \\frac{361}{400}.\n$$\n因此\n$$\nA^{(\\mathrm{feed})} = \\frac{\\frac{99}{100} + \\frac{361}{400}}{2\\cdot \\frac{19}{20}}\n= \\frac{\\frac{396}{400} + \\frac{361}{400}}{19/10}\n= \\frac{757/400}{19/10}\n= \\frac{757}{760},\n$$\n$$\n(1+S_{11})(1+S_{22}) = \\frac{11}{10}\\cdot\\frac{11}{10} = \\frac{121}{100},\\quad\n(1-S_{11})(1-S_{22}) = \\frac{9}{10}\\cdot\\frac{9}{10} = \\frac{81}{100}.\n$$\n因此\n$$\nB^{(\\mathrm{feed})} = 50\\cdot\\frac{\\frac{121}{100} - \\frac{361}{400}}{2\\cdot \\frac{19}{20}}\n= 50\\cdot\\frac{\\frac{484-361}{400}}{19/10}\n= 50\\cdot\\frac{123/400}{19/10}\n= 50\\cdot\\frac{123}{760}\n= \\frac{615}{76},\n$$\n$$\nC^{(\\mathrm{feed})} = \\frac{1}{50}\\cdot\\frac{\\frac{81}{100} - \\frac{361}{400}}{2\\cdot \\frac{19}{20}}\n= \\frac{1}{50}\\cdot\\frac{\\frac{324-361}{400}}{19/10}\n= \\frac{1}{50}\\cdot\\frac{-37/400}{19/10}\n= -\\frac{37}{38000},\n$$\n$$\nD^{(\\mathrm{feed})} = \\frac{(1-S_{11})(1+S_{22}) + S_{12} S_{21}}{2 S_{21}} = \\frac{\\frac{99}{100} + \\frac{361}{400}}{19/10} = \\frac{757}{760}.\n$$\n所以，\n$$\nT^{(\\mathrm{feed})} \\equiv\n\\begin{pmatrix}\nA^{(\\mathrm{feed})}  B^{(\\mathrm{feed})} \\\\\nC^{(\\mathrm{feed})}  D^{(\\mathrm{feed})}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{757}{760}  \\frac{615}{76} \\\\\n-\\frac{37}{38000}  \\frac{757}{760}\n\\end{pmatrix}.\n$$\n\n接下来，使用相同的公式从 $S^{(\\mathrm{tot})}$ 计算总级联的链矩阵 $T^{(\\mathrm{tot})}$。给定值为\n$$\nS_{11}^{(\\mathrm{tot})} = S_{22}^{(\\mathrm{tot})} = \\frac{491}{3105},\\qquad\nS_{21}^{(\\mathrm{tot})} = S_{12}^{(\\mathrm{tot})} = \\frac{1805}{2484}.\n$$\n我们构建\n$$\nA^{(\\mathrm{tot})} = \\frac{\\left(1 + \\frac{491}{3105}\\right)\\left(1 - \\frac{491}{3105}\\right) + \\left(\\frac{1805}{2484}\\right)^{2}}{2\\cdot \\frac{1805}{2484}},\n$$\n$$\nB^{(\\mathrm{tot})} = 50\\,\\frac{\\left(1 + \\frac{491}{3105}\\right)\\left(1 + \\frac{491}{3105}\\right) - \\left(\\frac{1805}{2484}\\right)^{2}}{2\\cdot \\frac{1805}{2484}},\n$$\n$$\nC^{(\\mathrm{tot})} = \\frac{1}{50}\\,\\frac{\\left(1 - \\frac{491}{3105}\\right)\\left(1 - \\frac{491}{3105}\\right) - \\left(\\frac{1805}{2484}\\right)^{2}}{2\\cdot \\frac{1805}{2484}},\n$$\n$$\nD^{(\\mathrm{tot})} = \\frac{\\left(1 - \\frac{491}{3105}\\right)\\left(1 + \\frac{491}{3105}\\right) + \\left(\\frac{1805}{2484}\\right)^{2}}{2\\cdot \\frac{1805}{2484}}.\n$$\n进行算术计算（为避免数值误差，保留精确的有理数形式）得到\n$$\nT^{(\\mathrm{tot})}\n=\n\\begin{pmatrix}\n\\displaystyle \\frac{7466980}{7220000}  \\displaystyle \\frac{4040220}{144400} \\\\\n\\displaystyle \\frac{897820}{361000000}  \\displaystyle \\frac{7466980}{7220000}\n\\end{pmatrix}.\n$$\n现在我们从总传输矩阵中去嵌入相同的馈电。对于一个由相同馈电组成的左-DUT-右级联结构，其链矩阵满足\n$$\nT^{(\\mathrm{tot})} = T^{(\\mathrm{feed})}\\,T^{(\\mathrm{DUT})}\\,T^{(\\mathrm{feed})}.\n$$\n求解 DUT 矩阵，\n$$\nT^{(\\mathrm{DUT})} = \\left(T^{(\\mathrm{feed})}\\right)^{-1}\\,T^{(\\mathrm{tot})}\\,\\left(T^{(\\mathrm{feed})}\\right)^{-1}.\n$$\n计算 $\\left(T^{(\\mathrm{feed})}\\right)^{-1}$。对于一个 $2\\times 2$ 矩阵，\n$$\n\\left(T^{(\\mathrm{feed})}\\right)^{-1}\n=\n\\frac{1}{A^{(\\mathrm{feed})}D^{(\\mathrm{feed})} - B^{(\\mathrm{feed})}C^{(\\mathrm{feed})}}\n\\begin{pmatrix}\nD^{(\\mathrm{feed})}  -B^{(\\mathrm{feed})} \\\\\n- C^{(\\mathrm{feed})}  A^{(\\mathrm{feed})}\n\\end{pmatrix}.\n$$\n互易无源双端口网络满足 $A D - B C = 1$，这在此处成立（实际上\n$$\nA^{(\\mathrm{feed})}D^{(\\mathrm{feed})} - B^{(\\mathrm{feed})}C^{(\\mathrm{feed})}\n= \\left(\\frac{757}{760}\\right)^{2} - \\left(\\frac{615}{76}\\right)\\left(-\\frac{37}{38000}\\right)\n= 1\n$$\n精确成立）。因此，\n$$\n\\left(T^{(\\mathrm{feed})}\\right)^{-1}\n=\n\\begin{pmatrix}\n\\frac{757}{760}  -\\frac{615}{76} \\\\\n\\frac{37}{38000}  \\frac{757}{760}\n\\end{pmatrix}.\n$$\n执行矩阵乘法\n$$\nT^{(\\mathrm{DUT})} = \\begin{pmatrix}\n\\frac{757}{760}  -\\frac{615}{76} \\\\\n\\frac{37}{38000}  \\frac{757}{760}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{7466980}{7220000}  \\frac{4040220}{144400} \\\\\n\\frac{897820}{361000000}  \\frac{7466980}{7220000}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{757}{760}  -\\frac{615}{76} \\\\\n\\frac{37}{38000}  \\frac{757}{760}\n\\end{pmatrix}\n$$\n经过精确有理数化简后得到：\n$$\nT^{(\\mathrm{DUT})} =\n\\begin{pmatrix}\n\\frac{41}{40}  \\frac{45}{4} \\\\\n\\frac{9}{2000}  \\frac{41}{40}\n\\end{pmatrix}.\n$$\n该链矩阵对应于一个匹配的互易衰减器。将 $T^{(\\mathrm{DUT})}$ 转换回 $S^{(\\mathrm{DUT})}$，\n$$\n\\Delta_{\\mathrm{DUT}} = A^{(\\mathrm{DUT})} + \\frac{B^{(\\mathrm{DUT})}}{Z_{0}} + C^{(\\mathrm{DUT})} Z_{0} + D^{(\\mathrm{DUT})}\n= \\frac{41}{40} + \\frac{45/4}{50} + \\frac{9}{2000} \\cdot 50 + \\frac{41}{40}\n= \\frac{41}{40} + \\frac{9}{40} + \\frac{9}{40} + \\frac{41}{40}\n= \\frac{100}{40}\n= \\frac{5}{2}.\n$$\n因此，\n$$\nS_{21}^{(\\mathrm{DUT})} = \\frac{2}{\\Delta_{\\mathrm{DUT}}} = \\frac{2}{5/2} = \\frac{4}{5} = 0.8,\n$$\n并且，一致地，\n$$\nS_{11}^{(\\mathrm{DUT})} = \\frac{A + \\frac{B}{Z_{0}} - C Z_{0} - D}{\\Delta} = 0,\\qquad\nS_{22}^{(\\mathrm{DUT})} = 0,\\qquad\nS_{12}^{(\\mathrm{DUT})} = \\frac{2(AD - BC)}{\\Delta} = \\frac{2\\cdot 1}{5/2} = \\frac{4}{5} = 0.8,\n$$\n证实了其为互易匹配衰减器。\n\n因此，去嵌入后的待测器件的前向传输为：\n$$\nS_{21}^{(\\mathrm{DUT})} = 0.8.\n$$\n四舍五入到四位有效数字，所求值为 $0.8000$。",
            "answer": "$$\\boxed{0.8000}$$"
        }
    ]
}