{
    "hands_on_practices": [
        {
            "introduction": "时域有限差分法（FDTD）是计算电磁学的基石之一，尤其适用于在时域中模拟波的传播。然而，一个显式的时间步进方案要获得有物理意义的结果，其数值稳定性至关重要。这个练习  将引导你通过冯·诺依曼稳定性分析，推导出著名的Courant-Friedrichs-Lewy（CFL）条件。这个推导将揭示离散网格的空间步长和时间步长之间的深刻联系，这是设计任何成功的FDTD模拟必须掌握的核心原则。",
            "id": "3294391",
            "problem": "考虑由麦克斯韦方程组控制的真空中电磁波的传播，\n$$\n\\frac{\\partial \\mathbf{E}}{\\partial t}=\\frac{1}{\\varepsilon_{0}}\\nabla\\times\\mathbf{H},\\qquad \\frac{\\partial \\mathbf{H}}{\\partial t}=-\\frac{1}{\\mu_{0}}\\nabla\\times\\mathbf{E},\n$$\n其中光速由 $c=\\frac{1}{\\sqrt{\\varepsilon_{0}\\mu_{0}}}$ 给出。使用Yee时域有限差分方法（Finite-Difference Time-Domain (FDTD)）的标准三维交错网格，在一个具有均匀间距 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的直角网格上对这些方程进行离散化，并采用时间步长为 $\\Delta t$ 的蛙跳法进行时间步进。假设一个无界周期性晶格，从而适用冯·诺依曼平面波分析。\n\n从第一性原理以及Yee交错网格和旋度算子的中心差分离散化的定义出发，对离散更新方程进行冯·诺依曼（傅里叶）稳定性分析。要求对于网格上可以表示的所有空间波数，放大因子都具有单位幅度，并推导约束 $\\Delta t$ 与 $c$、$\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 关系的Courant-Friedrichs-Lewy (CFL) 稳定性条件。\n\n将您的最终结果表示为最大允许时间步长 $\\Delta t_{\\text{max}}$ 作为 $c$、$\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 函数的单个闭式解析表达式。以秒为单位给出 $\\Delta t_{\\text{max}}$。无需四舍五入。",
            "solution": "起点是真空中的麦克斯韦旋度方程，\n$$\n\\frac{\\partial \\mathbf{E}}{\\partial t}=\\frac{1}{\\varepsilon_{0}}\\nabla\\times\\mathbf{H},\\qquad \\frac{\\partial \\mathbf{H}}{\\partial t}=-\\frac{1}{\\mu_{0}}\\nabla\\times\\mathbf{E},\n$$\n其中 $c=\\frac{1}{\\sqrt{\\varepsilon_{0}\\mu_{0}}}$。Yee时域有限差分方法（Finite-Difference Time-Domain (FDTD)）将 $\\mathbf{E}$ 和 $\\mathbf{H}$ 的分量放置在交错的矩形网格上：例如，$E_{x}$ 位于 $(i+\\tfrac{1}{2},j,k)$，$E_{y}$ 位于 $(i,j+\\tfrac{1}{2},k)$，$E_{z}$ 位于 $(i,j,k+\\tfrac{1}{2})$，$\\mathbf{H}$ 的分量也类似分布。时间上也是交错的，使得 $\\mathbf{E}$ 在整数时间索引 $n\\Delta t$ 处已知，而 $\\mathbf{H}$ 在半整数时间索引 $(n+\\tfrac{1}{2})\\Delta t$ 处已知。在空间和时间上半离散的Yee更新方程的分量形式为，例如：\n$$\nH_{x}^{n+\\tfrac{1}{2}}=H_{x}^{n-\\tfrac{1}{2}}-\\frac{\\Delta t}{\\mu_{0}}\\left(\\frac{E_{z}^{n}(i,j+1,k)-E_{z}^{n}(i,j,k)}{\\Delta y}-\\frac{E_{y}^{n}(i,j,k+1)-E_{y}^{n}(i,j,k)}{\\Delta z}\\right),\n$$\n$$\nE_{x}^{n+1}=E_{x}^{n}+\\frac{\\Delta t}{\\varepsilon_{0}}\\left(\\frac{H_{z}^{n+\\tfrac{1}{2}}(i,j,k)-H_{z}^{n+\\tfrac{1}{2}}(i,j-1,k)}{\\Delta y}-\\frac{H_{y}^{n+\\tfrac{1}{2}}(i,j,k)-H_{y}^{n+\\tfrac{1}{2}}(i,j,k-1)}{\\Delta z}\\right),\n$$\n以及对 $x,y,z$ 的循环置换。这些是与交错网格布置相一致的空间中心差分。\n\n为了通过冯·诺依曼（傅里叶）分析来研究稳定性，假设解是离散的平面波。对每个分量，采用以下拟设（ansatz）：\n$$\nE_{m}^{n}(\\mathbf{r}_{E_{m}})=\\widehat{E}_{m}\\,g^{n}\\exp\\!\\big(i(k_{x}i\\Delta x+k_{y}j\\Delta y+k_{z}k\\Delta z)\\big)\\,\\exp\\!\\big(i\\phi_{E_{m}}\\big),\n$$\n$$\nH_{m}^{n+\\tfrac{1}{2}}(\\mathbf{r}_{H_{m}})=\\widehat{H}_{m}\\,g^{n+\\tfrac{1}{2}}\\exp\\!\\big(i(k_{x}i\\Delta x+k_{y}j\\Delta y+k_{z}k\\Delta z)\\big)\\,\\exp\\!\\big(i\\phi_{H_{m}}\\big),\n$$\n其中 $m\\in\\{x,y,z\\}$，$g$ 是每个完整时间步长的放大因子，而 $\\phi_{E_{m}}$、$\\phi_{H_{m}}$ 解释了半单元空间交错：例如，对于位于 $(i+\\tfrac{1}{2},j,k)$ 的 $E_x$，$\\phi_{E_{x}}=\\tfrac{1}{2}k_{x}\\Delta x$；对于位于 $(i,j+\\tfrac{1}{2},k)$ 的 $E_y$，$\\phi_{E_{y}}=\\tfrac{1}{2}k_{y}\\Delta y$，等等，$\\mathbf{H}$ 也类似。\n\n将离散差分应用于这些平面波会产生三角函数因子。例如，\n$$\n\\frac{E_{z}(i,j+1,k)-E_{z}(i,j,k)}{\\Delta y}=\\frac{\\exp\\!\\big(i k_{y}\\Delta y\\big)-1}{\\Delta y}\\,E_{z}(i,j,k)=\\frac{2i}{\\Delta y}\\sin\\!\\left(\\frac{k_{y}\\Delta y}{2}\\right)\\exp\\!\\left(i\\frac{k_{y}\\Delta y}{2}\\right)E_{z}(i,j,k),\n$$\n沿 $x$ 和 $z$ 方向也类似。在每个方向上，离散导数符号的共同幅度为\n$$\nS_{x}=\\frac{1}{\\Delta x}\\sin\\!\\left(\\frac{k_{x}\\Delta x}{2}\\right),\\quad S_{y}=\\frac{1}{\\Delta y}\\sin\\!\\left(\\frac{k_{y}\\Delta y}{2}\\right),\\quad S_{z}=\\frac{1}{\\Delta z}\\sin\\!\\left(\\frac{k_{z}\\Delta z}{2}\\right).\n$$\n由于Yee网格的一致性交错，与 $\\exp(i\\phi)$ 相关的相位因子在离散旋度组合中被恰当地抵消，从而产生一个以 $g$ 为特征值参数的关于 $(\\widehat{\\mathbf{E}},\\widehat{\\mathbf{H}})$ 的封闭系统。\n\n一个标准的消元过程是通过构建关于 $\\mathbf{E}^{n}$ 的二阶差分方程来进行的。将时刻 $n$ 的 $E$ 更新方程从时刻 $n+1$ 的方程中减去，并代入 $H$ 更新方程的差值，得到\n$$\n\\mathbf{E}^{n+1}-2\\mathbf{E}^{n}+\\mathbf{E}^{n-1}=\\frac{\\Delta t}{\\varepsilon_{0}}\\nabla_{d}\\times\\left(\\mathbf{H}^{n+\\tfrac{1}{2}}-\\mathbf{H}^{n-\\tfrac{1}{2}}\\right)=-\\frac{\\Delta t^{2}}{\\varepsilon_{0}\\mu_{0}}\\nabla_{d}\\times\\left(\\nabla_{d}\\times\\mathbf{E}^{n}\\right),\n$$\n其中 $\\nabla_{d}\\times$ 表示离散旋度算子。对于一个离散无散的平面波，离散旋度-旋度算子对极化方向的作用是对角化的，并得到\n$$\n\\nabla_{d}\\times\\left(\\nabla_{d}\\times\\mathbf{E}^{n}\\right)=-4\\left(S_{x}^{2}+S_{y}^{2}+S_{z}^{2}\\right)\\mathbf{E}^{n}.\n$$\n因此，每个分量的标量放大关系简化为\n$$\n\\mathbf{E}^{n+1}-2\\mathbf{E}^{n}+\\mathbf{E}^{n-1}=-c^{2}\\Delta t^{2}\\cdot 4\\left(S_{x}^{2}+S_{y}^{2}+S_{z}^{2}\\right)\\mathbf{E}^{n}.\n$$\n设 $g$ 是放大因子，使得 $\\mathbf{E}^{n+1}=g\\,\\mathbf{E}^{n}$ 且 $\\mathbf{E}^{n-1}=g^{-1}\\mathbf{E}^{n}$。左边变为 $(g-2+g^{-1})\\mathbf{E}^{n}$。记 $g=\\exp(i\\omega\\Delta t)$，我们有 $g+g^{-1}=2\\cos(\\omega\\Delta t)$ 以及\n$$\ng-2+g^{-1}=-4\\sin^{2}\\!\\left(\\frac{\\omega\\Delta t}{2}\\right).\n$$\n因此，离散色散关系为\n$$\n\\sin^{2}\\!\\left(\\frac{\\omega\\Delta t}{2}\\right)=c^{2}\\Delta t^{2}\\left(S_{x}^{2}+S_{y}^{2}+S_{z}^{2}\\right)=c^{2}\\Delta t^{2}\\left[\\frac{\\sin^{2}\\!\\left(\\frac{k_{x}\\Delta x}{2}\\right)}{(\\Delta x)^{2}}+\\frac{\\sin^{2}\\!\\left(\\frac{k_{y}\\Delta y}{2}\\right)}{(\\Delta y)^{2}}+\\frac{\\sin^{2}\\!\\left(\\frac{k_{z}\\Delta z}{2}\\right)}{(\\Delta z)^{2}}\\right].\n$$\n为保证稳定性，放大因子必须具有单位幅度，这对应于对于所有可分辨的波数 $(k_{x},k_{y},k_{z})$，$\\omega$ 都为实数。由于左边满足 $0\\leq \\sin^{2}(\\cdot)\\leq 1$，我们要求对于第一布里渊区中的所有 $(k_{x},k_{y},k_{z})$，\n$$\nc^{2}\\Delta t^{2}\\left[\\frac{\\sin^{2}\\!\\left(\\frac{k_{x}\\Delta x}{2}\\right)}{(\\Delta x)^{2}}+\\frac{\\sin^{2}\\!\\left(\\frac{k_{y}\\Delta y}{2}\\right)}{(\\Delta y)^{2}}+\\frac{\\sin^{2}\\!\\left(\\frac{k_{z}\\Delta z}{2}\\right)}{(\\Delta z)^{2}}\\right]\\leq 1.\n$$\n当每个 $\\sin^{2}\\!\\left(\\frac{k_{m}\\Delta m}{2}\\right)=1$ 时，即在奈奎斯特边界 $k_{m}\\Delta m=\\pi$ 处，右边达到最大值。因此，最强的稳定性限制是\n$$\nc^{2}\\Delta t^{2}\\left[\\frac{1}{(\\Delta x)^{2}}+\\frac{1}{(\\Delta y)^{2}}+\\frac{1}{(\\Delta z)^{2}}\\right]\\leq 1,\n$$\n这给出了Courant-Friedrichs-Lewy时间步长界限\n$$\n\\Delta t_{\\text{max}}=\\frac{1}{c}\\left[\\frac{1}{(\\Delta x)^{2}}+\\frac{1}{(\\Delta y)^{2}}+\\frac{1}{(\\Delta z)^{2}}\\right]^{-\\frac{1}{2}}.\n$$\n当 $c$ 以米/秒表示，$\\Delta x$、$\\Delta y$、$\\Delta z$ 以米表示时，此表达式给出了以秒为单位的最大允许时间步长。",
            "answer": "$$\\boxed{\\frac{1}{c}\\left(\\frac{1}{(\\Delta x)^{2}}+\\frac{1}{(\\Delta y)^{2}}+\\frac{1}{(\\Delta z)^{2}}\\right)^{-\\frac{1}{2}}}$$"
        },
        {
            "introduction": "与在结构化网格上运行的FDTD不同，有限元法（FEM）为处理复杂几何形状提供了无与伦比的灵活性。FEM的核心思想是将复杂的全局问题分解为在简单、标准的“单元”（如三角形或四面体）上定义的局部问题，然后将它们组装起来。这个练习  让你亲手构建这样一个基本构件：一个四面体单元上的刚度矩阵。通过使用专为电磁场设计的Nédélec矢量基函数，你将深入了解FEM如何在非结构化网格上表示矢量场并离散化麦克斯韦方程中的旋度算子。",
            "id": "3294432",
            "problem": "考虑一个单连通域中时谐麦克斯韦方程组弱形式所产生的旋度-旋度双线性形式，其在单元层面产生单元刚度矩阵，其元素为 $a_{ij,kl} = \\int_{K} (\\nabla \\times \\mathbf{w}_{ij}) \\cdot (\\nabla \\times \\mathbf{w}_{kl}) \\, dV$，其中 $\\{\\mathbf{w}_{ij}\\}$ 是四面体单元 $K$ 上的一阶（第一类）Nédélec 边基函数。设 $K$ 是一个顶点为 $\\mathbf{v}_1 = (0,0,0)$、$\\mathbf{v}_2 = (1,0,0)$、$\\mathbf{v}_3 = (0,1,0)$ 和 $\\mathbf{v}_4 = (0,0,1)$ 的四面体。在 $K$ 上使用与有向边 $(1,2)$、$(1,3)$、$(1,4)$、$(2,3)$、$(2,4)$ 和 $(3,4)$ 相关联的标准一阶 Nédélec 基，其中与边 $(i,j)$ 相关联的每个基函数由 $\\mathbf{w}_{ij} = \\lambda_i \\nabla \\lambda_j - \\lambda_j \\nabla \\lambda_i$ 定义，此定义以 $K$ 的重心坐标 $\\{\\lambda_i\\}_{i=1}^{4}$ 表示。\n\n从 $K$ 上的重心坐标定义、上述边基函数定义以及矢量微积分恒等式出发，推导单元刚度矩阵元素的精确表达式。然后，使用精确求积，计算所得 $6 \\times 6$ 单元刚度矩阵的迹的精确值\n$$\n\\mathrm{tr}(\\mathbf{K}) = \\sum_{\\text{edges }(i,j)} \\int_{K} \\left|\\nabla \\times \\mathbf{w}_{ij}\\right|^{2} \\, dV,\n$$\n其中求和遍及上面列出的六条有向边。将最终答案以单个实数形式给出。将最终答案表示为无量纲量。无需四舍五入。",
            "solution": "本题要求使用一阶 Nédélec 边基函数，计算特定四面体单元 $K$ 的单元刚度矩阵 $\\mathbf{K}$ 的迹。迹由刚度矩阵的对角元之和给出：\n$$\n\\mathrm{tr}(\\mathbf{K}) = \\sum_{\\text{edges }(i,j)} \\int_{K} \\left|\\nabla \\times \\mathbf{w}_{ij}\\right|^{2} \\, dV\n$$\n其中求和遍及四面体的六条有向边。连接顶点 $\\mathbf{v}_i$ 和 $\\mathbf{v}_j$ 的边的基函数定义为 $\\mathbf{w}_{ij} = \\lambda_i \\nabla \\lambda_j - \\lambda_j \\nabla \\lambda_i$，其中 $\\lambda_k$ 是重心坐标。\n\n我们的步骤如下：\n1.  定义指定四面体的重心坐标并计算其梯度。\n2.  推导基函数旋度 $\\nabla \\times \\mathbf{w}_{ij}$ 的简化表达式。\n3.  使用此表达式求被积函数 $|\\nabla \\times \\mathbf{w}_{ij}|^2$。\n4.  计算四面体的体积以计算积分。\n5.  计算六条边中每一条边的积分，并将结果相加以获得迹。\n\n_步骤 1：重心坐标及其梯度_\n\n四面体 $K$ 的顶点为 $\\mathbf{v}_1 = (0,0,0)$、$\\mathbf{v}_2 = (1,0,0)$、$\\mathbf{v}_3 = (0,1,0)$ 和 $\\mathbf{v}_4 = (0,0,1)$。$K$ 内的任意点 $\\mathbf{x} = (x,y,z)$ 都可以表示为顶点的线性组合：\n$$\n\\mathbf{x} = \\sum_{k=1}^{4} \\lambda_k(\\mathbf{x}) \\mathbf{v}_k\n$$\n满足约束条件 $\\sum_{k=1}^{4} \\lambda_k = 1$ 和 $\\lambda_k \\ge 0$。\n代入顶点坐标，我们有：\n$$\n(x,y,z) = \\lambda_1(0,0,0) + \\lambda_2(1,0,0) + \\lambda_3(0,1,0) + \\lambda_4(0,0,1) = (\\lambda_2, \\lambda_3, \\lambda_4)\n$$\n这直接给出了 $\\lambda_2 = x$、$\\lambda_3 = y$ 和 $\\lambda_4 = z$。根据求和约束，我们求得 $\\lambda_1$：\n$$\n\\lambda_1 = 1 - \\lambda_2 - \\lambda_3 - \\lambda_4 = 1 - x - y - z\n$$\n重心坐标是笛卡尔坐标 $(x,y,z)$ 的线性函数。它们的梯度是常矢量：\n$$\n\\nabla \\lambda_1 = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\nabla \\lambda_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla \\lambda_3 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla \\lambda_4 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n\n_步骤 2：基函数的旋度_\n\n我们计算基函数 $\\mathbf{w}_{ij} = \\lambda_i \\nabla \\lambda_j - \\lambda_j \\nabla \\lambda_i$ 的旋度。我们使用矢量微积分恒等式 $\\nabla \\times (f\\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + \\nabla f \\times \\mathbf{A}$。由于梯度 $\\nabla \\lambda_k$ 是常矢量，它们的旋度为零：$\\nabla \\times (\\nabla \\lambda_k) = \\mathbf{0}$。\n将此应用于 $\\mathbf{w}_{ij}$ 中的两项：\n$$\n\\nabla \\times (\\lambda_i \\nabla \\lambda_j) = \\lambda_i (\\nabla \\times \\nabla \\lambda_j) + \\nabla \\lambda_i \\times \\nabla \\lambda_j = \\mathbf{0} + \\nabla \\lambda_i \\times \\nabla \\lambda_j = \\nabla \\lambda_i \\times \\nabla \\lambda_j\n$$\n$$\n\\nabla \\times (\\lambda_j \\nabla \\lambda_i) = \\lambda_j (\\nabla \\times \\nabla \\lambda_i) + \\nabla \\lambda_j \\times \\nabla \\lambda_i = \\mathbf{0} + \\nabla \\lambda_j \\times \\nabla \\lambda_i = \\nabla \\lambda_j \\times \\nabla \\lambda_i\n$$\n因此，$\\mathbf{w}_{ij}$ 的旋度为：\n$$\n\\nabla \\times \\mathbf{w}_{ij} = \\nabla \\times (\\lambda_i \\nabla \\lambda_j) - \\nabla \\times (\\lambda_j \\nabla \\lambda_i) = (\\nabla \\lambda_i \\times \\nabla \\lambda_j) - (\\nabla \\lambda_j \\times \\nabla \\lambda_i)\n$$\n使用叉积的反交换律 $\\mathbf{A} \\times \\mathbf{B} = -\\mathbf{B} \\times \\mathbf{A}$，我们得到：\n$$\n\\nabla \\times \\mathbf{w}_{ij} = (\\nabla \\lambda_i \\times \\nabla \\lambda_j) + (\\nabla \\lambda_i \\times \\nabla \\lambda_j) = 2(\\nabla \\lambda_i \\times \\nabla \\lambda_j)\n$$\n由于 $\\nabla \\lambda_i$ 和 $\\nabla \\lambda_j$ 是常矢量，它们的叉积也是一个常矢量。\n\n_步骤 3：计算被积函数_\n\n迹计算中的被积函数是该旋度的模的平方：\n$$\n|\\nabla \\times \\mathbf{w}_{ij}|^2 = |2(\\nabla \\lambda_i \\times \\nabla \\lambda_j)|^2 = 4|\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2\n$$\n对于每条边 $(i,j)$，这是一个常数。\n\n_步骤 4：积分计算_\n\n一个常数在四面体 $K$ 的体积上的积分就是该常数乘以体积 $|K|$：\n$$\n\\int_K |\\nabla \\times \\mathbf{w}_{ij}|^2 \\, dV = 4|\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2 \\int_K dV = 4|K||\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2\n$$\n一个顶点在原点，其他顶点在 $\\mathbf{a}、\\mathbf{b}、\\mathbf{c}$ 的四面体的体积是 $|K| = \\frac{1}{6}|\\mathbf{a} \\cdot (\\mathbf{b} \\times \\mathbf{c})|$。对于我们的四面体，从顶点 $\\mathbf{v}_1$ 出发的向量是 $\\mathbf{v}_2-\\mathbf{v}_1 = (1,0,0)$、$\\mathbf{v}_3-\\mathbf{v}_1 = (0,1,0)$ 和 $\\mathbf{v}_4-\\mathbf{v}_1 = (0,0,1)$。\n$$\n|K| = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right| = \\frac{1}{6}\n$$\n\n_步骤 5：对角项求和_\n\n我们现在计算指定的六条边 $(1,2)$、$(1,3)$、$(1,4)$、$(2,3)$、$(2,4)$ 和 $(3,4)$ 中每一条边的 $|\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2$。\n\n对于边 $(1,2)$:\n$\\nabla \\lambda_1 \\times \\nabla \\lambda_2 = (-1,-1,-1) \\times (1,0,0) = (0,-1,1)$。\n$|\\nabla \\lambda_1 \\times \\nabla \\lambda_2|^2 = 0^2 + (-1)^2 + 1^2 = 2$。\n\n对于边 $(1,3)$:\n$\\nabla \\lambda_1 \\times \\nabla \\lambda_3 = (-1,-1,-1) \\times (0,1,0) = (1,0,-1)$。\n$|\\nabla \\lambda_1 \\times \\nabla \\lambda_3|^2 = 1^2 + 0^2 + (-1)^2 = 2$。\n\n对于边 $(1,4)$:\n$\\nabla \\lambda_1 \\times \\nabla \\lambda_4 = (-1,-1,-1) \\times (0,0,1) = (-1,1,0)$。\n$|\\nabla \\lambda_1 \\times \\nabla \\lambda_4|^2 = (-1)^2 + 1^2 + 0^2 = 2$。\n\n对于边 $(2,3)$:\n$\\nabla \\lambda_2 \\times \\nabla \\lambda_3 = (1,0,0) \\times (0,1,0) = (0,0,1)$。\n$|\\nabla \\lambda_2 \\times \\nabla \\lambda_3|^2 = 0^2 + 0^2 + 1^2 = 1$。\n\n对于边 $(2,4)$:\n$\\nabla \\lambda_2 \\times \\nabla \\lambda_4 = (1,0,0) \\times (0,0,1) = (0,-1,0)$。\n$|\\nabla \\lambda_2 \\times \\nabla \\lambda_4|^2 = 0^2 + (-1)^2 + 0^2 = 1$。\n\n对于边 $(3,4)$:\n$\\nabla \\lambda_3 \\times \\nabla \\lambda_4 = (0,1,0) \\times (0,0,1) = (1,0,0)$。\n$|\\nabla \\lambda_3 \\times \\nabla \\lambda_4|^2 = 1^2 + 0^2 + 0^2 = 1$。\n\n迹是对角元 $K_{ij,ij} = \\int_{K} |\\nabla \\times \\mathbf{w}_{ij}|^2 \\, dV$ 的和：\n$$\n\\mathrm{tr}(\\mathbf{K}) = \\sum_{(i,j)} 4|K||\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2 = 4|K| \\sum_{(i,j)} |\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2\n$$\n代入计算出的值：\n$$\n\\sum_{(i,j)} |\\nabla \\lambda_i \\times \\nabla \\lambda_j|^2 = 2 + 2 + 2 + 1 + 1 + 1 = 9\n$$\n现在，我们使用 $|K| = 1/6$ 计算迹：\n$$\n\\mathrm{tr}(\\mathbf{K}) = 4 \\left(\\frac{1}{6}\\right) (9) = \\frac{36}{6} = 6\n$$\n单元刚度矩阵的迹恰好为 $6$。",
            "answer": "$$\n\\boxed{6}\n$$"
        },
        {
            "introduction": "一个优秀的数值方案不仅应逼近控制方程的解，还应在离散层面严格遵守其内含的物理守恒律，例如电荷守恒。这种“保结构”或“模拟”离散化的思想是现代计算科学的前沿。这个练习  提供了一个精妙的实例，展示了当离散算子与投影操作不满足特定的代数关系（交换性）时，看似合理的数值更新步骤如何导致电荷不守恒。通过在简单的三角网格上构建一个反例，你将体会到离散化方案的代数结构对于保证模拟结果物理真实性的决定性作用。",
            "id": "3294451",
            "problem": "假设一个二维时域电磁仿真是基于一个非结构化三角网格，并使用离散外微分 (DEC) 的框架来构建的。其基本依据是连续性方程，即电荷守恒的局域表述：$ \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0 $，其中 $ \\rho $ 是电荷密度，$ \\mathbf{J} $ 是电流密度。在一个单纯复形上的离散设置中，将节点电荷表示为离散 $0$-形式，将边电流表示为离散 $1$-形式。令 $ D \\in \\mathbb{R}^{N_0 \\times N_1} $ 表示节点-边关联矩阵（即将边量映射到节点量的离散散度算子）。如果不应用其他变换，一个能够精确保持离散连续性方程的前向欧拉时间更新为 $ \\rho^{n+1} = \\rho^{n} - \\Delta t \\, D \\, J^{n} $。\n\n在许多算法中，会引入不相容函数空间之间的投影。令 $ P_1 \\in \\mathbb{R}^{N_1 \\times N_1} $ 是应用于边电流的投影（例如，到降维子空间的 $L^2$ 投影），令 $ P_0 \\in \\mathbb{R}^{N_0 \\times N_0} $ 是应用于节点电荷的投影。在此类投影下，精确离散电荷守恒的一个充分条件是图交换，即 $ D \\, P_1 = P_0 \\, D $。如果 $ D \\, P_1 \\neq P_0 \\, D $，离散连续性可能被破坏。\n\n在一个最小的非结构化网格上构造一个具体的反例。考虑位于坐标 $ (0,0) $、$ (1,0) $ 和 $ (0.2,0.9) $ 的三个顶点，它们构成一个单独的三角形。将边定向为 $ e_0 : (0,0) \\to (1,0) $、$ e_1 : (1,0) \\to (0.2,0.9) $ 和 $ e_2 : (0.2,0.9) \\to (0,0) $。相应的节点-边关联矩阵 $ D \\in \\mathbb{R}^{3 \\times 3} $ 定义为：如果节点 $ i $ 是边 $ j $ 的源点，则 $ D_{i,j} = -1 $；如果节点 $ i $ 是边 $ j $ 的目标点，则 $ D_{i,j} = +1 $；否则 $ D_{i,j} = 0 $。定义一个对角边质量矩阵 $ M_e \\in \\mathbb{R}^{3 \\times 3} $，其元素等于边的长度，即 $ M_e = \\mathrm{diag}(\\ell_0, \\ell_1, \\ell_2) $，其中 $ \\ell_0 $、$ \\ell_1 $ 和 $ \\ell_2 $ 分别是边 $ e_0 $、$ e_1 $ 和 $ e_2 $ 的欧几里得长度。定义一个到由 $ S \\in \\mathbb{R}^{3 \\times k} $ 的列向量张成的边子空间的加权 $L^2$ 投影为\n$$\nP_1 = S \\left( S^\\top M_e \\, S \\right)^{-1} S^\\top M_e,\n$$\n除非另有说明，否则取 $ P_0 = I $（节点电荷上的单位算子）。那么，单步投影更新可写为 $ \\rho^{n+1} = P_0 \\left( \\rho^{n} - \\Delta t \\, D \\, P_1 \\, J^{n} \\right) $。单步的离散连续性残差为\n$$\nr = \\rho^{n+1} - \\rho^{n} + \\Delta t \\, D \\, J^{n} = \\Delta t \\left( D \\, J^{n} - P_0 \\, D \\, P_1 \\, J^{n} \\right),\n$$\n当且仅当 $ D \\, P_1 = P_0 \\, D $ 时，该残差对所有 $ J^{n} $ 均为零。非零残差表明精确电荷守恒的丧失。\n\n实现一个程序，为以下测试套件计算残差的欧几里得范数 $ \\| r \\|_2 $。在所有情况下，网格和定向均如上所述。对于投影，使用由边长导出的 $ M_e $ 的加权定义。除非另有说明，否则使用 $ P_0 = I $。\n\n测试套件：\n- 情况1（非结构化网格上的反例）：$ S = [1, 0, 0]^\\top $（投影到由边 $ e_0 $ 张成的子空间），$ \\Delta t = 0.5 $，以及 $ J^{n} = [0, 1, 0]^\\top $。\n- 情况2（通过单位算子交换）：$ P_1 = I $，$ \\Delta t = 1.0 $，以及 $ J^{n} = [0.3, -0.3, 0.0]^\\top $。\n- 情况3（电流在投影子空间内）：$ S = [1, 0, 0]^\\top $，$ \\Delta t = 0.75 $，以及 $ J^{n} = [2.0, 0.0, 0.0]^\\top $。\n- 情况4（零电流）：$ S = [1, 0, 0]^\\top $，$ \\Delta t = 2.0 $，以及 $ J^{n} = [0.0, 0.0, 0.0]^\\top $。\n- 情况5（在非交换投影上的非平凡混合）：$ S = [1, 0, 0]^\\top $，$ \\Delta t = 1.25 $，以及 $ J^{n} = [1.0, 1.0, -2.0]^\\top $。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中每个 $ r_i $ 是相应情况下 $ \\| r \\|_2 $ 的浮点值。无需物理单位；报告原始的无量纲值。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于应用于电磁学的离散外微分原理，问题阐述清晰，提供了所有必要信息，并且其表述是客观的。任务是针对指定三角网格上的不同场景，计算离散电荷守恒破坏程度的数值度量。\n\n问题的核心在于离散连续性方程及其如何受投影算子影响。离散连续性方程由 $\\frac{\\partial \\rho}{\\partial t} + D J = 0$ 给出，其中 $\\rho$ 是节点电荷向量（$0$-形式），$J$ 是边电流向量（$1$-形式），$D$ 是表示离散散度算子的节点-边关联矩阵。前向欧拉时间更新为 $\\rho^{n+1} = \\rho^n - \\Delta t D J^n$。\n\n当引入投影 $P_0$（在节点上）和 $P_1$（在边上）时，更新法则变为 $\\rho^{n+1} = P_0 ( \\rho^n - \\Delta t D P_1 J^n )$。量化单步电荷守恒误差的残差为 $r = \\rho^{n+1} - \\rho^n + \\Delta t D J^n$。对于本问题，给定 $P_0 = I$（单位矩阵），因此更新简化为 $\\rho^{n+1} = \\rho^n - \\Delta t D P_1 J^n$。残差则为 $r = (\\rho^n - \\Delta t D P_1 J^n) - \\rho^n + \\Delta t D J^n = \\Delta t (D J^n - D P_1 J^n)$。问题要求计算几个测试用例的欧几里得范数 $\\|r\\|_2$。\n\n首先，我们为单个三角形单元建立几何和代数设置。\n\n三个顶点位于坐标 $v_0 = (0,0)$，$v_1 = (1,0)$ 和 $v_2 = (0.2, 0.9)$。边的定向为 $e_0: v_0 \\to v_1$，$e_1: v_1 \\to v_2$ 和 $e_2: v_2 \\to v_0$。\n\n节点-边关联矩阵 $D \\in \\mathbb{R}^{3 \\times 3}$ 基于这些定向构建。行对应于节点 $(v_0, v_1, v_2)$，列对应于边 $(e_0, e_1, e_2)$。\n如果节点 $i$ 是边 $j$ 的源点，则 $D_{i,j} = -1$；如果节点 $i$ 是目标点，则 $D_{i,j} = +1$；否则为 $0$。\n对于 $e_0 (v_0 \\to v_1)$：第 $0$ 列为 $[-1, 1, 0]^\\top$。\n对于 $e_1 (v_1 \\to v_2)$：第 $1$ 列为 $[0, -1, 1]^\\top$。\n对于 $e_2 (v_2 \\to v_0)$：第 $2$ 列为 $[1, 0, -1]^\\top$。\n因此，关联矩阵为：\n$$\nD = \\begin{pmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix}\n$$\n\n边长 $\\ell_i$ 使用欧几里得距离公式计算：\n$\\ell_0 = \\|v_1 - v_0\\|_2 = \\|(1,0) - (0,0)\\|_2 = 1$。\n$\\ell_1 = \\|v_2 - v_1\\|_2 = \\|(0.2-1, 0.9-0)\\|_2 = \\|(-0.8, 0.9)\\|_2 = \\sqrt{(-0.8)^2 + 0.9^2} = \\sqrt{0.64 + 0.81} = \\sqrt{1.45}$。\n$\\ell_2 = \\|v_0 - v_2\\|_2 = \\|(0-0.2, 0-0.9)\\|_2 = \\|(-0.2, -0.9)\\|_2 = \\sqrt{(-0.2)^2 + (-0.9)^2} = \\sqrt{0.04 + 0.81} = \\sqrt{0.85}$。\n\n边质量矩阵 $M_e = \\mathrm{diag}(\\ell_0, \\ell_1, \\ell_2)$ 为：\n$$\nM_e = \\begin{pmatrix} 1  0  0 \\\\ 0  \\sqrt{1.45}  0 \\\\ 0  0  \\sqrt{0.85} \\end{pmatrix}\n$$\n\n节点空间上的投影是单位矩阵，$P_0 = I \\in \\mathbb{R}^{3 \\times 3}$。对于涉及非平凡边投影 $P_1$ 的情况，它被定义为 $P_1 = S ( S^\\top M_e S )^{-1} S^\\top M_e$。在相关情况下，子空间由 $S = [1, 0, 0]^\\top$ 张成。\n我们为这个 $S$ 计算 $P_1$ 的分量：\n$S^\\top M_e S = [1, 0, 0] \\begin{pmatrix} 1  0  0 \\\\ 0  \\sqrt{1.45}  0 \\\\ 0  0  \\sqrt{0.85} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1$。\n$(S^\\top M_e S)^{-1} = 1^{-1} = 1$。\n$S^\\top M_e = [1, 0, 0] \\begin{pmatrix} 1  0  0 \\\\ 0  \\sqrt{1.45}  0 \\\\ 0  0  \\sqrt{0.85} \\end{pmatrix} = [1, 0, 0]$。\n$P_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} (1) [1, 0, 0] = \\begin{pmatrix} 1  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}$。\n这个 $P_1$ 将任何边电流向量投影到边 $e_0$ 的子空间上。\n\n在所有矩阵都定义好之后，我们现在评估每个测试用例。\n\n**情况 1：** $S = [1, 0, 0]^\\top$，$\\Delta t = 0.5$，$J^{n} = [0, 1, 0]^\\top$。\n$P_1$ 是上面导出的投影矩阵。\n$r = \\Delta t (D J^n - D P_1 J^n)$。\n$J^n = [0, 1, 0]^\\top$。\n$D J^n = \\begin{pmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}$。\n$P_1 J^n = \\begin{pmatrix} 1  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$D P_1 J^n = D [0, 0, 0]^\\top = [0, 0, 0]^\\top$。\n$r = 0.5 \\left( \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right) = \\begin{pmatrix} 0 \\\\ -0.5 \\\\ 0.5 \\end{pmatrix}$。\n$\\|r\\|_2 = \\sqrt{0^2 + (-0.5)^2 + 0.5^2} = \\sqrt{0.25 + 0.25} = \\sqrt{0.5}$。\n\n**情况 2：** $P_1 = I$，$\\Delta t = 1.0$，$J^{n} = [0.3, -0.3, 0.0]^\\top$。\n这里，$P_1$ 是单位矩阵，因此交换性条件 $D P_1 = P_0 D$ 得到满足，因为 $D I = I D$，即 $D=D$。\n残差必须为零：\n$r = \\Delta t (D J^n - D I J^n) = \\Delta t (D J^n - D J^n) = 0$。\n$\\|r\\|_2 = 0$。\n\n**情况 3：** $S = [1, 0, 0]^\\top$，$\\Delta t = 0.75$，$J^{n} = [2.0, 0.0, 0.0]^\\top$。\n$P_1$ 与情况 1 相同。电流向量 $J^n$ 完全位于 $P_1$ 投影到的子空间内。\n因此，$P_1 J^n = J^n$。\n残差为：\n$r = \\Delta t (D J^n - D P_1 J^n) = \\Delta t (D J^n - D J^n) = 0$。\n$\\|r\\|_2 = 0$。\n\n**情况 4：** $S = [1, 0, 0]^\\top$，$\\Delta t = 2.0$，$J^{n} = [0.0, 0.0, 0.0]^\\top$。\n电流为零，因此 $J^n = 0$。残差显然为零：\n$r = \\Delta t (D \\cdot 0 - D P_1 \\cdot 0) = 0$。\n$\\|r\\|_2 = 0$。\n\n**情况 5：** $S = [1, 0, 0]^\\top$，$\\Delta t = 1.25$，$J^{n} = [1.0, 1.0, -2.0]^\\top$。\n$P_1$ 与情况 1 相同。\n$r = \\Delta t (D J^n - D P_1 J^n)$。\n$J^n = [1.0, 1.0, -2.0]^\\top$。\n$D J^n = \\begin{pmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1 - 2 \\\\ 1 - 1 \\\\ 1 - (-2) \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix}$。\n$P_1 J^n = \\begin{pmatrix} 1  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$D P_1 J^n = \\begin{pmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n$r = 1.25 \\left( \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right) = 1.25 \\begin{pmatrix} -2 \\\\ -1 \\\\ 3 \\end{pmatrix}$。\n$\\|r\\|_2 = 1.25 \\times \\sqrt{(-2)^2 + (-1)^2 + 3^2} = 1.25 \\times \\sqrt{4 + 1 + 9} = 1.25 \\sqrt{14}$。\n\n结果摘要：\n情况 1：$\\sqrt{0.5} \\approx 0.70710678$\n情况 2：$0.0$\n情况 3：$0.0$\n情况 4：$0.0$\n情况 5：$1.25\\sqrt{14} \\approx 4.67707195$\n\n这些值将在最终程序中进行数值计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the discrete continuity residual norm for a series of test cases\n    on a single triangular mesh within a Discrete Exterior Calculus framework.\n    \"\"\"\n    # Define mesh geometry and constant matrices\n    # Vertices: v0=(0,0), v1=(1,0), v2=(0.2,0.9)\n    v = np.array([\n        [0.0, 0.0],  # v0\n        [1.0, 0.0],  # v1\n        [0.2, 0.9]   # v2\n    ])\n\n    # Edge orientations: e0: v0->v1, e1: v1->v2, e2: v2->v0\n    # Node-edge incidence matrix D (discrete divergence)\n    D = np.array([\n        [-1, 0, 1],\n        [1, -1, 0],\n        [0, 1, -1]\n    ], dtype=float)\n\n    # Nodal projection matrix P0 (identity)\n    P0 = np.identity(3)\n\n    # Calculate edge lengths\n    l0 = np.linalg.norm(v[1] - v[0])  # edge e0\n    l1 = np.linalg.norm(v[2] - v[1])  # edge e1\n    l2 = np.linalg.norm(v[0] - v[2])  # edge e2\n\n    # Edge mass matrix Me\n    Me = np.diag([l0, l1, l2])\n\n    test_cases = [\n        # Case 1: counterexample on unstructured mesh\n        {'case_id': 1, 'S_def': np.array([[1], [0], [0]], dtype=float), 'P1_def': None, 'dt': 0.5, 'Jn': np.array([0, 1, 0], dtype=float)},\n        # Case 2: commuting via identity\n        {'case_id': 2, 'S_def': None, 'P1_def': np.identity(3), 'dt': 1.0, 'Jn': np.array([0.3, -0.3, 0.0], dtype=float)},\n        # Case 3: current in the projected subspace\n        {'case_id': 3, 'S_def': np.array([[1], [0], [0]], dtype=float), 'P1_def': None, 'dt': 0.75, 'Jn': np.array([2.0, 0.0, 0.0], dtype=float)},\n        # Case 4: zero current\n        {'case_id': 4, 'S_def': np.array([[1], [0], [0]], dtype=float), 'P1_def': None, 'dt': 2.0, 'Jn': np.array([0.0, 0.0, 0.0], dtype=float)},\n        # Case 5: nontrivial mixture on non-commuting projection\n        {'case_id': 5, 'S_def': np.array([[1], [0], [0]], dtype=float), 'P1_def': None, 'dt': 1.25, 'Jn': np.array([1.0, 1.0, -2.0], dtype=float)},\n    ]\n\n    results = []\n    for case in test_cases:\n        dt = case['dt']\n        Jn = case['Jn']\n\n        if case['P1_def'] is not None:\n            P1 = case['P1_def']\n        else:\n            S = case['S_def']\n            # Formula for weighted L2 projection: P1 = S * (S.T * Me * S)^-1 * S.T * Me\n            St_Me_S = S.T @ Me @ S\n            # St_Me_S is a 1x1 matrix for the given cases.\n            if np.abs(St_Me_S[0,0])  1e-15:\n                # To handle cases where the inverse might not exist, though not for these tests.\n                # In this case S.T * M_e * S is just the squared weighted norm of S.\n                # Projecting onto the zero vector results in a zero projection matrix.\n                P1 = np.zeros((3,3))\n            else:\n                St_Me_S_inv = np.linalg.inv(St_Me_S)\n                St_Me = S.T @ Me\n                P1 = S @ St_Me_S_inv @ St_Me\n        \n        # Residual formula: r = dt * (D*Jn - P0*D*P1*Jn)\n        # Since P0 is identity, r = dt * (D*Jn - D*P1*Jn)\n        r = dt * (D @ Jn - D @ P1 @ Jn)\n        \n        # Calculate the Euclidean norm of the residual\n        r_norm = np.linalg.norm(r)\n        results.append(r_norm)\n\n    # Print the final results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}