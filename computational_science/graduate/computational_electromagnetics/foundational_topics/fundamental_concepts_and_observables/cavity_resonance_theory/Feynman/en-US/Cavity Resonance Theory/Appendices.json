{
    "hands_on_practices": [
        {
            "introduction": "In physical systems, geometric symmetries often give rise to profound consequences. For resonant cavities, this principle manifests as mode degeneracy, where distinct field distributions (modes) can share the same resonant frequency. This exercise  will guide you through a first-principles derivation of this phenomenon in a rectangular cavity with a square cross-section, providing a concrete understanding of how symmetry impacts the electromagnetic spectrum.",
            "id": "3291968",
            "problem": "A rectangular perfect electric conductor (PEC) cavity of interior dimensions $a$, $b$, and $d$ is filled with a homogeneous, isotropic, lossless medium with permittivity $\\varepsilon$ and permeability $\\mu$. Consider source-free, time-harmonic electromagnetic fields with angular frequency $\\omega$, and let the wave number be $k=\\omega\\sqrt{\\mu\\varepsilon}$. The PEC boundary condition enforces that the tangential component of the electric field vanishes on each conducting wall. Starting from Maxwell’s equations and the PEC boundary condition, the electromagnetic resonance problem reduces to a vector Helmholtz eigenvalue problem on the cavity volume. Using a separation-of-variables approach consistent with the PEC boundary condition, the eigenfields can be expanded in products of sinusoidal functions along the $x$, $y$, and $z$ coordinates, with integer indices that enforce the boundary conditions at $x=0$, $x=a$, $y=0$, $y=b$, $z=0$, and $z=d$. Restrict attention to the family of standing-wave cavity modes whose separable scalar factors vanish at all six walls, so that the corresponding three integer indices satisfy $m\\in\\mathbb{N}$, $n\\in\\mathbb{N}$, and $p\\in\\mathbb{N}$.\n\nDerive, from the stated fundamental laws and boundary conditions, the resonance eigenvalue relation for the allowed wave numbers and show how the resonance frequencies depend on the triple $(m,n,p)$. Then, impose the geometric symmetry condition $a=b$ and rigorously explain, in terms of the spectrum of the Laplacian with PEC boundary conditions, why exchanging the indices $m$ and $n$ does or does not change the resonance frequency. Based on that reasoning, quantify the degeneracy multiplicity $g(m,n,p)$ arising solely from the $a=b$ symmetry for the specified family of modes. Your final answer must be a single closed-form analytic expression for $g(m,n,p)$ in terms of $m$ and $n$ only. No rounding is required, and no units are to be included in the final expression.",
            "solution": "The problem requires the derivation of the resonance frequency relation for a rectangular perfect electric conductor (PEC) cavity and the analysis of a specific mode degeneracy under a geometric symmetry condition.\n\nFirst, we derive the resonance frequency relation from fundamental principles. In a source-free ($\\vec{J}=\\vec{0}$, $\\rho=0$), homogeneous, isotropic, and lossless medium, Maxwell's equations for time-harmonic fields with angular frequency $\\omega$ are:\n$$ \\nabla \\times \\vec{E} = -i\\omega\\mu\\vec{H} $$\n$$ \\nabla \\times \\vec{H} = i\\omega\\varepsilon\\vec{E} $$\n$$ \\nabla \\cdot \\vec{E} = 0 $$\n$$ \\nabla \\cdot \\vec{H} = 0 $$\nBy taking the curl of the first equation and substituting the second, we obtain the vector Helmholtz equation for the electric field $\\vec{E}$:\n$$ \\nabla \\times (\\nabla \\times \\vec{E}) = \\nabla(\\nabla \\cdot \\vec{E}) - \\nabla^2\\vec{E} = -i\\omega\\mu(\\nabla \\times \\vec{H}) = \\omega^2\\mu\\varepsilon\\vec{E} $$\nGiven that $\\nabla \\cdot \\vec{E} = 0$, the equation simplifies to:\n$$ \\nabla^2\\vec{E} + k^2\\vec{E} = \\vec{0} $$\nwhere $k^2 = \\omega^2\\mu\\varepsilon$ is the squared wave number. Each Cartesian component of the electric field, e.g., $E_x$, must satisfy the scalar Helmholtz equation:\n$$ (\\nabla^2 + k^2)\\psi = 0 $$\nwhere $\\psi$ could represent any of the field components. The problem states that the eigenfields can be expanded in products of sinusoidal functions, and we are to consider modes whose separable scalar factors vanish at all six walls of the cavity defined by $x \\in [0, a]$, $y \\in [0, b]$, and $z \\in [0, d]$. This is equivalent to solving the scalar Helmholtz equation with homogeneous Dirichlet boundary conditions on the cavity walls.\n\nWe use the method of separation of variables, assuming a solution of the form $\\psi(x, y, z) = X(x)Y(y)Z(z)$. Substituting this into the scalar Helmholtz equation and dividing by $\\psi$ yields:\n$$ \\frac{1}{X(x)}\\frac{d^2X}{dx^2} + \\frac{1}{Y(y)}\\frac{d^2Y}{dy^2} + \\frac{1}{Z(z)}\\frac{d^2Z}{dz^2} = -k^2 $$\nEach term must be a constant, so we define separation constants $-k_x^2$, $-k_y^2$, and $-k_z^2$:\n$$ \\frac{d^2X}{dx^2} = -k_x^2 X(x), \\quad \\frac{d^2Y}{dy^2} = -k_y^2 Y(y), \\quad \\frac{d^2Z}{dz^2} = -k_z^2 Z(z) $$\nwith the constraint $k_x^2 + k_y^2 + k_z^2 = k^2$.\n\nThe boundary condition that the scalar factor vanishes at the walls implies:\n$X(0) = X(a) = 0$, $Y(0) = Y(b) = 0$, and $Z(0) = Z(d) = 0$.\nThe general solution for $X(x)$ is $X(x) = C_1 \\cos(k_x x) + C_2 \\sin(k_x x)$. The condition $X(0)=0$ implies $C_1=0$. The condition $X(a)=0$ for a non-trivial solution ($C_2 \\neq 0$) requires $\\sin(k_x a) = 0$, which means $k_x a = m\\pi$ for some integer $m$. The problem specifies $m \\in \\mathbb{N} = \\{1, 2, 3, \\dots\\}$, which ensures a non-trivial sinusoidal shape. Thus, the allowed values for $k_x$ are $k_x = \\frac{m\\pi}{a}$.\nBy analogy, applying the boundary conditions in the $y$ and $z$ directions yields:\n$k_y = \\frac{n\\pi}{b}$ for $n \\in \\mathbb{N}$.\n$k_z = \\frac{p\\pi}{d}$ for $p \\in \\mathbb{N}$.\n\nSubstituting these quantized wave numbers into the separation constraint gives the resonance eigenvalue relation for the allowed squared wave numbers, $k_{mnp}^2$:\n$$ k_{mnp}^2 = \\left(\\frac{m\\pi}{a}\\right)^2 + \\left(\\frac{n\\pi}{b}\\right)^2 + \\left(\\frac{p\\pi}{d}\\right)^2 = \\pi^2 \\left( \\frac{m^2}{a^2} + \\frac{n^2}{b^2} + \\frac{p^2}{d^2} \\right) $$\nThe resonance angular frequency is $\\omega_{mnp} = k_{mnp}/\\sqrt{\\mu\\varepsilon}$. The corresponding resonance frequency $f_{mnp} = \\omega_{mnp}/(2\\pi)$ is:\n$$ f_{mnp} = \\frac{1}{2\\sqrt{\\mu\\varepsilon}} \\sqrt{ \\left(\\frac{m}{a}\\right)^2 + \\left(\\frac{n}{b}\\right)^2 + \\left(\\frac{p}{d}\\right)^2 } $$\nThis expression shows the dependency of the resonance frequencies on the mode index triple $(m, n, p)$ and the cavity dimensions.\n\nNext, we impose the geometric symmetry condition $a=b$. The frequency expression becomes:\n$$ f_{mnp} = \\frac{1}{2\\sqrt{\\mu\\varepsilon}} \\sqrt{ \\frac{m^2+n^2}{a^2} + \\frac{p^2}{d^2} } $$\nTo determine if exchanging indices $m$ and $n$ changes the resonance frequency, we evaluate $f_{nmp}$:\n$$ f_{nmp} = \\frac{1}{2\\sqrt{\\mu\\varepsilon}} \\sqrt{ \\frac{n^2+m^2}{a^2} + \\frac{p^2}{d^2} } $$\nSince $m^2+n^2 = n^2+m^2$, it is evident that $f_{mnp} = f_{nmp}$. Therefore, exchanging the indices $m$ and $n$ does not change the resonance frequency when $a=b$.\n\nThis phenomenon is a direct consequence of the symmetry of the Laplacian operator's spectrum. The resonance frequencies are determined by the eigenvalues of the negative Laplacian operator, $-\\nabla^2$, with Dirichlet boundary conditions. The eigenvalues are $\\lambda_{mnp} = k_{mnp}^2$. When $a=b$, the operator's domain (the cavity) is symmetric with respect to an exchange of the $x$ and $y$ coordinates. This geometric symmetry implies that the operator's spectrum must also be invariant under this exchange. The eigenvalues for modes $(m,n,p)$ and $(n,m,p)$ are $\\lambda_{mnp} = \\pi^2(\\frac{m^2+n^2}{a^2} + \\frac{p^2}{d^2})$ and $\\lambda_{nmp} = \\pi^2(\\frac{n^2+m^2}{a^2} + \\frac{p^2}{d^2})$, which are identical. If $m \\neq n$, the corresponding eigenfunctions (e.g., $\\sin(\\frac{m\\pi x}{a})\\sin(\\frac{n\\pi y}{a})\\sin(\\frac{p\\pi z}{d})$ and $\\sin(\\frac{n\\pi x}{a})\\sin(\\frac{m\\pi y}{a})\\sin(\\frac{p\\pi z}{d})$) are distinct. The existence of multiple distinct eigenfunctions for the same eigenvalue is known as degeneracy.\n\nFinally, we quantify the degeneracy multiplicity $g(m,n,p)$ arising solely from this $a=b$ symmetry. This multiplicity depends only on the indices $m$ and $n$, as the index $p$ is unaffected by the $x \\leftrightarrow y$ symmetry. We consider two cases for a given mode $(m, n, p)$:\n1. If $m \\neq n$: The mode indices $(m, n, p)$ and $(n, m, p)$ are distinct, corresponding to two different eigenfunctions. Since $f_{mnp} = f_{nmp}$, these two modes are degenerate. The multiplicity of the degenerate state is $2$.\n2. If $m = n$: The mode indices are $(m, m, p)$. Exchanging the first two indices results in the same triplet $(m, m, p)$. There is only one distinct mode. This state is non-degenerate with respect to this symmetry. The multiplicity is $1$.\n\nTo express this as a single closed-form analytic expression, we use the Kronecker delta function, $\\delta_{mn}$, defined as $\\delta_{mn} = 1$ if $m=n$ and $\\delta_{mn} = 0$ if $m \\neq n$. The multiplicity $g(m,n)$ can be written as:\nIf $m \\neq n$, $g(m,n) = 2$.\nIf $m = n$, $g(m,n) = 1$.\nThe function $2 - \\delta_{mn}$ satisfies these conditions:\nFor $m \\neq n$, $g(m,n) = 2 - \\delta_{mn} = 2 - 0 = 2$.\nFor $m=n$, $g(m,n) = 2 - \\delta_{nn} = 2 - 1 = 1$.\nThis expression correctly quantifies the number of modes in the degenerate set $\\{(m,n,p), (n,m,p)\\}$ for any given pair of positive integers $m$ and $n$.",
            "answer": "$$ \\boxed{2 - \\delta_{mn}} $$"
        },
        {
            "introduction": "Building on the concept of resonant modes, we now explore how these modes respond to imperfections. In practical applications, the ideal geometry of a resonant cavity is never perfectly realized due to manufacturing tolerances. This practice  investigates the sensitivity of a cavity's resonant frequency to small geometric perturbations, allowing you to quantify the impact of such changes and appreciate the principles of perturbation analysis in electromagnetic design.",
            "id": "3292008",
            "problem": "A source-free vacuum rectangular cavity with perfectly electrically conducting (PEC) walls has side lengths $a$, $b$, and $d$ along the $x$-, $y$-, and $z$-axes, respectively. The electromagnetic fields are time-harmonic with angular frequency $\\omega$ and satisfy Maxwell’s equations in vacuum, the constitutive relations $ \\mathbf{D} = \\epsilon_{0} \\mathbf{E}$ and $ \\mathbf{B} = \\mu_{0} \\mathbf{H}$, and the boundary condition that the tangential component of the electric field vanishes on the PEC walls. Consider the Transverse Electric (TE) mode with indices $\\mathrm{TE}_{101}$.\n\nStarting from Maxwell’s equations and the PEC boundary conditions, the resonance of the cavity can be formulated as an eigenvalue problem for the fields. Using that formulation, derive the parametric dependence of the resonance frequency on the geometric parameters $(a,b,d)$, and then determine, to first order in a small geometric perturbation, the relative frequency change $\\Delta f / f$ resulting from increasing only the $x$-dimension $a$ by $0.1\\%$ while keeping $b$ and $d$ fixed. The cavity dimensions are $a = 0.20\\,\\mathrm{m}$, $b = 0.15\\,\\mathrm{m}$, and $d = 0.30\\,\\mathrm{m}$, and the cavity is in vacuum.\n\nDefine the relative frequency change as $\\Delta f / f = (f_{\\text{new}} - f_{\\text{old}})/f_{\\text{old}}$ and assume the perturbation is sufficiently small for first-order sensitivity analysis to be valid. Express your final answer as a dimensionless decimal, and round your answer to six significant figures.",
            "solution": "The problem asks for two things: first, to derive the parametric dependence of the resonance frequency of a rectangular cavity for the $\\mathrm{TE}_{101}$ mode, and second, to calculate the first-order relative frequency change when one of the dimensions is slightly increased.\n\nWe begin with Maxwell's equations in a source-free vacuum:\n$$ \\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t} $$\n$$ \\nabla \\cdot \\mathbf{D} = 0 $$\n$$ \\nabla \\cdot \\mathbf{B} = 0 $$\nUsing the constitutive relations $\\mathbf{D} = \\epsilon_{0} \\mathbf{E}$ and $\\mathbf{B} = \\mu_{0} \\mathbf{H}$, and assuming time-harmonic fields of the form $\\mathbf{E}(\\mathbf{r}, t) = \\mathbf{E}(\\mathbf{r}) e^{j\\omega t}$ and $\\mathbf{H}(\\mathbf{r}, t) = \\mathbf{H}(\\mathbf{r}) e^{j\\omega t}$, Maxwell's equations become:\n$$ \\nabla \\times \\mathbf{E} = -j\\omega\\mu_0 \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega\\epsilon_0 \\mathbf{E} $$\n$$ \\nabla \\cdot \\mathbf{E} = 0 $$\n$$ \\nabla \\cdot \\mathbf{H} = 0 $$\nBy taking the curl of the first equation and substituting the second, we derive the vector Helmholtz wave equation for the electric field:\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) = -j\\omega\\mu_0 (\\nabla \\times \\mathbf{H}) = -j\\omega\\mu_0(j\\omega\\epsilon_0 \\mathbf{E}) = \\omega^2\\mu_0\\epsilon_0\\mathbf{E} $$\nUsing the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E}$ and the condition $\\nabla \\cdot \\mathbf{E} = 0$, we get:\n$$ \\nabla^2 \\mathbf{E} + k^2 \\mathbf{E} = 0 $$\nwhere $k^2 = \\omega^2\\mu_0\\epsilon_0$. A similar equation holds for the magnetic field, $\\nabla^2 \\mathbf{H} + k^2 \\mathbf{H} = 0$.\n\nThe cavity is a rectangular box defined by $0 \\le x \\le a$, $0 \\le y \\le b$, and $0 \\le z \\le d$. The walls are perfectly electrically conducting (PEC), which imposes the boundary condition that the tangential component of the electric field $\\mathbf{E}$ must be zero on all walls.\n$$ \\mathbf{\\hat{n}} \\times \\mathbf{E} = 0 \\quad \\text{on the walls} $$\nThis translates to the following conditions for the components of $\\mathbf{E}$:\n1.  $E_y = 0$ and $E_z = 0$ on the walls at $x=0$ and $x=a$.\n2.  $E_x = 0$ and $E_z = 0$ on the walls at $y=0$ and $y=b$.\n3.  $E_x = 0$ and $E_y = 0$ on the walls at $z=0$ and $z=d$.\n\nA general solution for the fields inside the cavity that satisfies these boundary conditions can be found by separation of variables. The solution leads to a quantization of the wave vector components:\n$$ k_x = \\frac{m\\pi}{a}, \\quad k_y = \\frac{n\\pi}{b}, \\quad k_z = \\frac{p\\pi}{d} $$\nwhere $m, n, p$ are integers. These components must satisfy the Helmholtz equation, which means their squares sum to the total wavenumber squared:\n$$ k_{mnp}^2 = k_x^2 + k_y^2 + k_z^2 = \\left(\\frac{m\\pi}{a}\\right)^2 + \\left(\\frac{n\\pi}{b}\\right)^2 + \\left(\\frac{p\\pi}{d}\\right)^2 $$\nThe resonant angular frequency $\\omega_{mnp}$ is related to $k_{mnp}$ by $\\omega_{mnp} = c k_{mnp}$, where $c = 1/\\sqrt{\\mu_0\\epsilon_0}$ is the speed of light in vacuum. The resonant frequency $f_{mnp} = \\omega_{mnp}/(2\\pi)$. Thus, the general formula for the resonance frequency is:\n$$ f_{mnp} = \\frac{c k_{mnp}}{2\\pi} = \\frac{c}{2} \\sqrt{\\left(\\frac{m}{a}\\right)^2 + \\left(\\frac{n}{b}\\right)^2 + \\left(\\frac{p}{d}\\right)^2} $$\nThe problem specifies the Transverse Electric mode $\\mathrm{TE}_{101}$. For TE modes, the electric field is transverse to a chosen axis (by convention, the $z$-axis), meaning $E_z=0$. For a non-trivial TE mode to exist, we must have integers $m, n \\ge 0$ (not both zero) and $p \\ge 1$. For the $\\mathrm{TE}_{101}$ mode, the indices are $m=1$, $n=0$, and $p=1$.\n\nSubstituting these indices into the general frequency formula gives the parametric dependence for the $\\mathrm{TE}_{101}$ mode:\n$$ f_{101}(a,b,d) = \\frac{c}{2} \\sqrt{\\left(\\frac{1}{a}\\right)^2 + \\left(\\frac{0}{b}\\right)^2 + \\left(\\frac{1}{d}\\right)^2} $$\n$$ f(a,d) = \\frac{c}{2} \\sqrt{\\frac{1}{a^2} + \\frac{1}{d^2}} $$\nNote that for the $\\mathrm{TE}_{101}$ mode, the resonance frequency is independent of the dimension $b$.\n\nNext, we determine the relative frequency change $\\Delta f / f$ when the dimension $a$ is increased by $0.1\\%$. The new dimension is $a' = a + \\Delta a$, where $\\Delta a / a = 0.001$. For a small perturbation, the change in frequency can be approximated to first order using the total differential. Since only $a$ changes, we have:\n$$ \\Delta f \\approx \\frac{\\partial f}{\\partial a} \\Delta a $$\nThe relative frequency change is therefore:\n$$ \\frac{\\Delta f}{f} \\approx \\frac{1}{f} \\frac{\\partial f}{\\partial a} \\Delta a $$\nWe calculate the partial derivative of $f(a,d) = \\frac{c}{2}(a^{-2} + d^{-2})^{1/2}$ with respect to $a$:\n$$ \\frac{\\partial f}{\\partial a} = \\frac{c}{2} \\cdot \\frac{1}{2}(a^{-2} + d^{-2})^{-1/2} \\cdot (-2a^{-3}) = -\\frac{c}{2} a^{-3} (a^{-2} + d^{-2})^{-1/2} $$\nNow, we construct the expression for the relative change:\n$$ \\frac{\\Delta f}{f} \\approx \\frac{1}{\\frac{c}{2}(a^{-2} + d^{-2})^{1/2}} \\left[-\\frac{c}{2} a^{-3} (a^{-2} + d^{-2})^{-1/2}\\right] \\Delta a $$\n$$ \\frac{\\Delta f}{f} \\approx -\\frac{a^{-3}}{a^{-2} + d^{-2}} \\Delta a $$\nThis can be simplified for better interpretation:\n$$ \\frac{\\Delta f}{f} \\approx -\\frac{1/a^3}{1/a^2 + 1/d^2} \\Delta a = -\\frac{1/a^3}{(d^2+a^2)/(a^2 d^2)} \\Delta a = -\\frac{a^2 d^2}{a^3(a^2+d^2)} \\Delta a = -\\frac{d^2}{a(a^2+d^2)} \\Delta a $$\nWe can express this in terms of the relative change in $a$, $\\Delta a/a$:\n$$ \\frac{\\Delta f}{f} \\approx \\left(-\\frac{d^2}{a(a^2+d^2)}\\right) (a \\frac{\\Delta a}{a}) = -\\frac{a d^2}{a(a^2+d^2)} \\frac{\\Delta a}{a} = -\\frac{d^2}{a^2+d^2} \\frac{\\Delta a}{a} $$\nNow we substitute the given numerical values: $a = 0.20\\,\\mathrm{m}$, $d = 0.30\\,\\mathrm{m}$, and $\\Delta a / a = 0.1\\% = 0.001$.\n$$ \\frac{\\Delta f}{f} \\approx -\\frac{(0.30)^2}{(0.20)^2 + (0.30)^2} \\times 0.001 $$\n$$ \\frac{\\Delta f}{f} \\approx -\\frac{0.09}{0.04 + 0.09} \\times 0.001 $$\n$$ \\frac{\\Delta f}{f} \\approx -\\frac{0.09}{0.13} \\times 0.001 $$\n$$ \\frac{\\Delta f}{f} \\approx -\\frac{9}{13} \\times 0.001 $$\nCalculating the numerical value:\n$$ \\frac{9}{13} \\approx 0.6923076923... $$\n$$ \\frac{\\Delta f}{f} \\approx -0.6923076923... \\times 0.001 = -0.0006923076923... $$\nThe problem requires the answer to be rounded to six significant figures. The first six significant digits are $6, 9, 2, 3, 0, 7$. The seventh significant digit is $6$, so we round up the last digit.\n$$ \\frac{\\Delta f}{f} \\approx -0.000692308 $$\nThis is the final dimensionless decimal value for the relative frequency change.",
            "answer": "$$\\boxed{-0.000692308}$$"
        },
        {
            "introduction": "We now extend our study of symmetry from closed cavities to open systems, where resonators can lose energy by radiating to the surrounding environment. This practice  introduces the cutting-edge concept of a symmetry-protected bound state in the continuum (BIC), a special mode that is perfectly confined despite having access to radiation channels. By modeling the transition from a perfect BIC to a 'quasi-BIC' upon breaking the symmetry, you will explore how these principles are used to engineer resonances with exceptionally high quality factors, a cornerstone of modern photonics.",
            "id": "3291857",
            "problem": "Consider a one-dimensional, mirror-symmetric, open electromagnetic cavity embedded in a homogeneous background medium with permittivity $\\epsilon$ and permeability $\\mu$. Let the cavity support a single time-harmonic resonant mode with angular frequency $\\omega_0$ and complex electric and magnetic fields $\\mathbf{E}(\\mathbf{r},t) = \\Re\\{\\mathbf{E}(\\mathbf{r}) e^{-i \\omega t}\\}$ and $\\mathbf{H}(\\mathbf{r},t) = \\Re\\{\\mathbf{H}(\\mathbf{r}) e^{-i \\omega t}\\}$ satisfying Maxwell's equations, namely $ \\nabla \\times \\mathbf{E} = - \\mu \\, \\partial \\mathbf{H}/\\partial t $ and $ \\nabla \\times \\mathbf{H} = \\epsilon \\, \\partial \\mathbf{E}/\\partial t $, with outgoing radiation boundary conditions at infinity. Assume the resonant mode has odd parity with respect to the cavity's mid-plane, so that in the perfectly mirror-symmetric case its coupling amplitudes to the two radiation channels (left and right propagating plane-wave continua) are equal in magnitude and opposite in sign.\n\nUnder Temporal Coupled-Mode Theory (TCMT), define the complex amplitude $a(t)$ of the resonant mode such that the stored electromagnetic energy is $U = |a|^2$. In the absence of external driving, the mode's dynamics are governed by $ \\mathrm{d} a/\\mathrm{d}t = (i \\omega_0 - \\gamma_{\\mathrm{rad}}) a $, where $\\gamma_{\\mathrm{rad}}$ is the radiative decay rate arising from coupling to the continuum. Let the continuum coupling be represented by complex amplitudes $g_{\\mathrm{L}}$ and $g_{\\mathrm{R}}$ into the left and right radiation channels, respectively. For an odd-parity mode in a perfectly symmetric cavity, $g_{\\mathrm{L}} = g$ and $g_{\\mathrm{R}} = - g$ with $g \\in \\mathbb{C}$, so the far-field amplitudes interfere destructively and the radiative loss vanishes, yielding a symmetry-protected bound state in the continuum.\n\nNow introduce a controlled mirror-symmetry breaking parameter $\\delta \\in \\mathbb{R}$, modeled to first order by perturbing the channel couplings as $g_{\\mathrm{L}}(\\delta) = g (1 + \\delta)$ and $g_{\\mathrm{R}}(\\delta) = - g (1 - \\delta)$. The time-averaged radiated power into the continuum, $P_{\\mathrm{rad}}$, can be expressed as a quadratic form in the net outgoing amplitudes, which are linear in $g_{\\mathrm{L}}(\\delta)$ and $g_{\\mathrm{R}}(\\delta)$ times $a$. Define a real, positive normalization constant $\\Gamma$ that absorbs the continuum normalization and the mapping from outgoing amplitudes to power per unit $|a|^2$, so that the radiative decay rate is $\\gamma_{\\mathrm{rad}} = P_{\\mathrm{rad}}/(2 U)$.\n\nTasks:\n- Starting from the above physical model and the fundamental laws, derive the dependence of the radiative decay rate $\\gamma_{\\mathrm{rad}}$ on the symmetry-breaking parameter $\\delta$, showing the leading-order scaling with $\\delta$ that follows from the interference of $g_{\\mathrm{L}}(\\delta)$ and $g_{\\mathrm{R}}(\\delta)$ and the energy–flux balance. Then derive the quality factor $Q = \\omega_0 / (2 \\gamma_{\\mathrm{rad}})$ of the resulting quasi-bound state in the continuum (quasi-BIC).\n- Implement a program that computes $Q$ for a given set of parameters. Use the following fixed numerical values for all test cases: angular frequency $\\omega_0 = 2 \\pi \\times 10^{10}$ in $\\mathrm{rad/s}$ and $\\Gamma = 10^{6}$ in $\\mathrm{s}^{-1}$. Treat the coupling amplitude $g$ as absorbed into $\\Gamma$ by definition of $\\Gamma$. Neglect non-radiative losses so that the total decay rate equals the radiative decay rate. All computed values of $Q$ are dimensionless and must be returned as floating-point numbers.\n- Using your derived relationship, compute $Q$ for the symmetry-breaking parameters in the test suite:\n  1. $\\delta = 0$\n  2. $\\delta = 10^{-3}$\n  3. $\\delta = 5 \\times 10^{-3}$\n  4. $\\delta = - 10^{-2}$\n  5. $\\delta = 10^{-1}$\n- Additionally, for the nonzero $\\delta$ cases, estimate the scaling exponent $p$ in the empirical relationship $Q \\propto |\\delta|^{-p}$ by performing a linear fit in logarithmic variables. Specifically, compute $p$ as the negative of the slope obtained from a least-squares fit of $\\log Q$ versus $\\log |\\delta|$ over the nonzero test cases. Return $p$ as a floating-point number.\n\nUnits and formatting:\n- Express $\\omega_0$ in $\\mathrm{rad/s}$ and $\\Gamma$ in $\\mathrm{s}^{-1}$. The quantity $Q$ is dimensionless. Angles are not used and need not be specified.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the entries ordered as $[Q(\\delta=0), Q(10^{-3}), Q(5 \\times 10^{-3}), Q(-10^{-2}), Q(10^{-1}), p]$. If $Q$ diverges for any test case, represent it by the floating-point infinity value.",
            "solution": "**Part 1: Derivation of Radiative Decay Rate ($\\gamma_{\\mathrm{rad}}$) and Quality Factor ($Q$)**\n\nThe problem requires us to derive the dependence of the radiative decay rate $\\gamma_{\\mathrm{rad}}$ and the quality factor $Q$ on the symmetry-breaking parameter $\\delta$.\n\nThe fundamental relationship between stored energy $U$, radiated power $P_{\\mathrm{rad}}$, and the radiative decay rate $\\gamma_{\\mathrm{rad}}$ is given as:\n$$\n\\gamma_{\\mathrm{rad}} = \\frac{P_{\\mathrm{rad}}}{2U}\n$$\nThe stored energy in the resonant mode is defined in terms of the mode amplitude $a(t)$ as $U = |a|^2$. Therefore:\n$$\n\\gamma_{\\mathrm{rad}} = \\frac{P_{\\mathrm{rad}}}{2|a|^2}\n$$\nThe problem specifies a one-dimensional, mirror-symmetric cavity with an odd-parity resonant mode. In the perfectly symmetric case ($\\delta=0$), the coupling amplitudes to the left ($g_{\\mathrm{L}}$) and right ($g_{\\mathrm{R}}$) radiation channels are $g_{\\mathrm{L}} = g$ and $g_{\\mathrm{R}} = -g$. The problem crucially states that for this symmetric case, \"the far-field amplitudes interfere destructively and the radiative loss vanishes.\" This indicates that the total radiated power is not the incoherent sum of powers from each channel (which would be proportional to $|g_{\\mathrm{L}}|^2 + |g_{\\mathrm{R}}|^2$), but rather results from the coherent superposition of the fields radiated into the continuum.\n\nThe net amplitude of the radiated field is therefore proportional to the sum of the individual channel coupling amplitudes. Let this net coupling amplitude be $g_{\\mathrm{net}}$. The time-averaged radiated power $P_{\\mathrm{rad}}$ is proportional to the squared magnitude of this net amplitude and the squared magnitude of the mode amplitude $|a|^2$.\n$$\nP_{\\mathrm{rad}} \\propto |g_{\\mathrm{net}}|^2 |a|^2\n$$\nThe net coupling amplitude $g_{\\mathrm{net}}$ is the sum of the perturbed coupling amplitudes $g_{\\mathrm{L}}(\\delta)$ and $g_{\\mathrm{R}}(\\delta)$:\n$$\ng_{\\mathrm{net}}(\\delta) = g_{\\mathrm{L}}(\\delta) + g_{\\mathrm{R}}(\\delta)\n$$\nSubstituting the given expressions for the perturbed couplings, $g_{\\mathrm{L}}(\\delta) = g(1 + \\delta)$ and $g_{\\mathrm{R}}(\\delta) = -g(1 - \\delta)$:\n$$\ng_{\\mathrm{net}}(\\delta) = g(1 + \\delta) + (-g(1 - \\delta)) = g(1 + \\delta - 1 + \\delta) = 2g\\delta\n$$\nThe radiated power is thus proportional to $|2g\\delta|^2$:\n$$\nP_{\\mathrm{rad}} \\propto |2g\\delta|^2 |a|^2 = 4 |g|^2 \\delta^2 |a|^2\n$$\nThe problem introduces a real, positive constant $\\Gamma$ which \"absorbs the continuum normalization and the mapping from outgoing amplitudes to power per unit $|a|^2$,\" and further states to \"Treat the coupling amplitude $g$ as absorbed into $\\Gamma$\". This implies that we can set the proportionality constant, along with $|g|^2$ and any other factors (like the factor of $4$), to be encapsulated by a single constant that defines the decay rate's scale. The most direct and consistent interpretation is to define the relationship for $\\gamma_{\\mathrm{rad}}$ as:\n$$\n\\gamma_{\\mathrm{rad}}(\\delta) = \\Gamma \\delta^2\n$$\nThis expression shows that for $\\delta=0$, $\\gamma_{\\mathrm{rad}}(0) = 0$, which correctly describes the symmetry-protected bound state in the continuum (a mode with infinite lifetime, or zero decay rate). As the symmetry is broken ($\\delta \\neq 0$), a radiative loss channel opens, with the decay rate scaling quadratically with the perturbation parameter $\\delta$. This $\\delta^2$ dependence is a hallmark of quasi-BICs arising from broken symmetry.\n\nNext, we derive the quality factor $Q$. The definition is given as:\n$$\nQ = \\frac{\\omega_0}{2 \\gamma_{\\mathrm{rad}}}\n$$\nSubstituting our derived expression for $\\gamma_{\\mathrm{rad}}(\\delta)$:\n$$\nQ(\\delta) = \\frac{\\omega_0}{2 (\\Gamma \\delta^2)} = \\frac{\\omega_0}{2\\Gamma\\delta^2}\n$$\nThis is the final expression for the quality factor of the quasi-BIC as a function of the symmetry-breaking parameter $\\delta$.\n\n**Part 2: Calculation of the Scaling Exponent ($p$)**\n\nThe problem asks to find the scaling exponent $p$ in the relationship $Q \\propto |\\delta|^{-p}$. From our derived formula,\n$$\nQ(\\delta) = \\left(\\frac{\\omega_0}{2\\Gamma}\\right) \\frac{1}{\\delta^2} = \\left(\\frac{\\omega_0}{2\\Gamma}\\right) |\\delta|^{-2}\n$$\nBy direct comparison, we can see that the theoretical scaling exponent is $p=2$.\n\nTo confirm this numerically as requested, a linear fit is performed on the logarithmic variables. Taking the logarithm of the expression for $Q$:\n$$\n\\log(Q) = \\log\\left(\\frac{\\omega_0}{2\\Gamma}\\right) + \\log(|\\delta|^{-2})\n$$\n$$\n\\log(Q) = \\log\\left(\\frac{\\omega_0}{2\\Gamma}\\right) - 2\\log(|\\delta|)\n$$\nThis is a linear equation of the form $y = c + mx$, where $y = \\log(Q)$, $x = \\log(|\\delta|)$, the intercept is $c = \\log(\\omega_0/(2\\Gamma))$, and the slope is $m = -2$. The problem defines $p$ as the negative of the slope of $\\log(Q)$ versus $\\log(|\\delta|)$. Therefore, $p = -m = -(-2) = 2$. As the provided data points will perfectly fit this theoretical model, a numerical least-squares fit will yield an exponent $p$ of exactly $2$.\n\n**Part 3: Numerical Computations**\n\nWe use the given values:\n- $\\omega_0 = 2 \\pi \\times 10^{10} \\, \\mathrm{rad/s}$\n- $\\Gamma = 10^6 \\, \\mathrm{s}^{-1}$\n\nThe formula for $Q$ is:\n$$\nQ(\\delta) = \\frac{2 \\pi \\times 10^{10}}{2 \\times 10^6 \\times \\delta^2} = \\frac{\\pi \\times 10^{10}}{10^6 \\times \\delta^2} = \\frac{\\pi \\times 10^4}{\\delta^2}\n$$\nWe compute $Q$ for each specified value of $\\delta$:\n1.  $\\delta = 0$: $Q(0) = \\frac{\\pi \\times 10^4}{0^2} \\rightarrow \\infty$.\n2.  $\\delta = 10^{-3}$: $Q(10^{-3}) = \\frac{\\pi \\times 10^4}{(10^{-3})^2} = \\frac{\\pi \\times 10^4}{10^{-6}} = \\pi \\times 10^{10}$.\n3.  $\\delta = 5 \\times 10^{-3}$: $Q(5 \\times 10^{-3}) = \\frac{\\pi \\times 10^4}{(5 \\times 10^{-3})^2} = \\frac{\\pi \\times 10^4}{25 \\times 10^{-6}} = \\frac{\\pi}{25} \\times 10^{10} = 4\\pi \\times 10^8$.\n4.  $\\delta = -10^{-2}$: $Q(-10^{-2}) = \\frac{\\pi \\times 10^4}{(-10^{-2})^2} = \\frac{\\pi \\times 10^4}{10^{-4}} = \\pi \\times 10^8$.\n5.  $\\delta = 10^{-1}$: $Q(10^{-1}) = \\frac{\\pi \\times 10^4}{(10^{-1})^2} = \\frac{\\pi \\times 10^4}{10^{-2}} = \\pi \\times 10^6$.\n\nThe scaling exponent $p$, as derived analytically and to be confirmed by a numerical fit over the non-zero $\\delta$ cases, is $p=2$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the quality factor Q of a quasi-BIC and its scaling exponent.\n    \n    The solution is based on the derived relationship Q = omega_0 / (2 * Gamma * delta^2),\n    which arises from the coherent destructive interference of radiation channels being\n    perturbed by a symmetry-breaking parameter delta.\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    # Angular frequency in rad/s\n    omega_0 = 2 * np.pi * 1e10\n    # Normalization constant for decay rate in s^-1\n    Gamma = 1e6\n\n    # Define the test cases for the symmetry-breaking parameter delta.\n    deltas = [0.0, 1e-3, 5e-3, -1e-2, 1e-1]\n\n    q_values = []\n    \n    # Calculate Q for each delta\n    for delta in deltas:\n        if delta == 0:\n            # For the perfect BIC case (delta=0), the decay rate is zero,\n            # so the quality factor Q is infinite.\n            q_values.append(np.inf)\n        else:\n            # The radiative decay rate is gamma_rad = Gamma * delta^2\n            gamma_rad = Gamma * delta**2\n            # The quality factor is Q = omega_0 / (2 * gamma_rad)\n            q_val = omega_0 / (2 * gamma_rad)\n            q_values.append(q_val)\n            \n    # --- Estimate the scaling exponent p ---\n    # The relationship is Q proportional to |delta|^-p.\n    # In log-log scale, log(Q) = C - p * log(|delta|).\n    # The exponent p is the negative of the slope of log(Q) vs log(|delta|).\n    \n    # Filter for non-zero deltas and their corresponding Q values.\n    non_zero_deltas = [d for d in deltas if d != 0]\n    non_zero_q_values = [q for d, q in zip(deltas, q_values) if d != 0]\n\n    # Prepare data for linear regression in log-space.\n    log_abs_deltas = np.log(np.abs(non_zero_deltas))\n    log_q_values = np.log(non_zero_q_values)\n    \n    # Perform a linear least-squares fit (degree 1 polynomial).\n    # polyfit returns [slope, intercept].\n    slope, intercept = np.polyfit(log_abs_deltas, log_q_values, 1)\n    \n    # The scaling exponent p is the negative of the slope.\n    p = -slope\n\n    # Combine all results into a single list for output.\n    # The order must be [Q(delta=0), Q(delta=1e-3), ..., p]\n    results = q_values + [p]\n\n    # Print the final result in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}