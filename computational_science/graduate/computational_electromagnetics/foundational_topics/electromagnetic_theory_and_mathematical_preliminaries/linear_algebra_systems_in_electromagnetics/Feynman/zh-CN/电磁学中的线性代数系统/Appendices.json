{
    "hands_on_practices": [
        {
            "introduction": "在计算电磁学中，大规模问题的求解始于对基本单元的理解。本练习将引导你从第一性原理出发，在一个标准的四面体单元上，亲手计算构成电磁场有限元系统的核心——质量矩阵 $\\mathbf{M}$ 和刚度矩阵 $\\mathbf{K}$ 。通过这个过程，你不仅能加深对 Maxwell 方程组变分形式的理解，还能清晰地看到抽象的 Whitney 形式如何具体化为离散的代数对象，为后续更复杂的分析奠定坚实基础。",
            "id": "3324064",
            "problem": "考虑一个标准参考四面体，其顶点为 $\\mathbf{v}_{0}=(0,0,0)$、$\\mathbf{v}_{1}=(1,0,0)$、$\\mathbf{v}_{2}=(0,1,0)$ 和 $\\mathbf{v}_{3}=(0,0,1)$。设重心坐标为 $\\lambda_{0}=1-x-y-z$、$\\lambda_{1}=x$、$\\lambda_{2}=y$ 和 $\\lambda_{3}=z$。在计算电磁学中，四面体上的边（Whitney $1$-阶微分形式）基函数是为有向边 $(i,j)$ 定义的，其形式如下：\n$$\n\\mathbf{N}_{ij}=\\lambda_{i}\\nabla\\lambda_{j}-\\lambda_{j}\\nabla\\lambda_{i}.\n$$\n假设材料参数为常数且为正值：介电常数 $\\epsilon>0$，磁导率 $\\mu>0$。局部质量矩阵 $\\mathbf{M}$（来自边基函数的 $L^{2}$ 内积）和局部旋度-旋度刚度矩阵 $\\mathbf{K}$（来自 $\\mathbf{H}(\\mathrm{curl})$ 双线性形式）定义如下：\n$$\nM_{(ij),(kl)}=\\int_{T}\\epsilon\\,\\mathbf{N}_{ij}\\cdot\\mathbf{N}_{kl}\\,dV,\\qquad\nK_{(ij),(kl)}=\\int_{T}\\mu^{-1}\\left(\\nabla\\times\\mathbf{N}_{ij}\\right)\\cdot\\left(\\nabla\\times\\mathbf{N}_{kl}\\right)\\,dV,\n$$\n其中 $T$ 表示四面体域。仅使用基本定律和核心定义（麦克斯韦方程组的变分形式、矢量微积分恒等式以及重心坐标的性质），并且不调用任何快捷公式，在单个四面体单元 $T$ 上执行以下操作：\n\n1.  对于 $i\\in\\{0,1,2,3\\}$，推导梯度 $\\nabla\\lambda_{i}$，并用它们构建与有向边 $(0,1)$、$(0,2)$、$(0,3)$、$(1,2)$、$(1,3)$ 和 $(2,3)$ 相关联的六个 Whitney $1$-阶微分形式。\n2.  按照上述边的顺序，显式计算局部质量矩阵 $\\mathbf{M}$ 的所有项。\n3.  按照上述边的顺序，显式计算局部旋度-旋度刚度矩阵 $\\mathbf{K}$ 的所有项。\n4.  从第一性原理出发，验证 $\\mathbf{M}$ 和 $\\mathbf{K}$ 的对称性，并确定它们在此单元上的秩。\n\n将 $\\mathbf{M}$ 和 $\\mathbf{K}$ 的秩作为最终答案，以行矩阵 $\\begin{pmatrix}\\mathrm{rank}(\\mathbf{M}) & \\mathrm{rank}(\\mathbf{K})\\end{pmatrix}$ 的形式报告。无需四舍五入。最终答案中不应包含单位。你的其余工作应从给定的定义和经过验证的事实中得到充分论证，并且所有数学实体必须用 LaTeX 表示。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤1：提取给定条件\n-   **参考四面体 $T$ 的顶点**：$\\mathbf{v}_{0}=(0,0,0)$、$\\mathbf{v}_{1}=(1,0,0)$、$\\mathbf{v}_{2}=(0,1,0)$ 和 $\\mathbf{v}_{3}=(0,0,1)$。\n-   **重心坐标**：$\\lambda_{0}=1-x-y-z$、$\\lambda_{1}=x$、$\\lambda_{2}=y$ 和 $\\lambda_{3}=z$。\n-   **对于有向边 $(i,j)$ 的边基函数定义（Whitney $1$-阶微分形式）**：$\\mathbf{N}_{ij}=\\lambda_{i}\\nabla\\lambda_{j}-\\lambda_{j}\\nabla\\lambda_{i}$。\n-   **材料参数**：常数、正值的介电常数 $\\epsilon>0$ 和磁导率 $\\mu>0$。\n-   **局部质量矩阵定义**：$M_{(ij),(kl)}=\\int_{T}\\epsilon\\,\\mathbf{N}_{ij}\\cdot\\mathbf{N}_{kl}\\,dV$。\n-   **局部旋度-旋度刚度矩阵定义**：$K_{(ij),(kl)}=\\int_{T}\\mu^{-1}\\left(\\nabla\\times\\mathbf{N}_{ij}\\right)\\cdot\\left(\\nabla\\times\\mathbf{N}_{kl}\\right)\\,dV$。\n-   **任务**：\n    1.  推导梯度 $\\nabla\\lambda_{i}$ 并为边 $(0,1)$、$(0,2)$、$(0,3)$、$(1,2)$、$(1,3)$ 和 $(2,3)$ 构建六个 Whitney $1$-阶微分形式。\n    2.  计算局部质量矩阵 $\\mathbf{M}$ 的所有项。\n    3.  计算局部旋度-旋度刚度矩阵 $\\mathbf{K}$ 的所有项。\n    4.  验证对称性并确定 $\\mathbf{M}$ 和 $\\mathbf{K}$ 的秩。\n-   **要求的最终答案**：一个行矩阵 $\\begin{pmatrix}\\mathrm{rank}(\\mathbf{M}) & \\mathrm{rank}(\\mathbf{K})\\end{pmatrix}$。\n\n### 步骤2：使用提取的给定条件进行验证\n根据验证标准对问题进行分析。\n-   **科学基础**：该问题是计算电磁学中有限元法（FEM）的一个标准练习。参考四面体、重心坐标、Whitney 形式以及相关的质量和刚度矩阵的定义是该领域的基本概念。所有定义和原理在科学上都是合理的。\n-   **适定性**：该问题是适定的。域和所有函数都有明确定义。任务是具体的，并能通过直接计算得出一个唯一的、有意义的解。\n-   **客观性**：该问题使用精确、无歧义的数学和工程术语陈述。它不含主观或基于意见的内容。\n\n该问题没有表现出任何诸如科学不合理、不完整、矛盾或模棱两可的缺陷。在其指定的领域内，这是一个可形式化且具有实质内容的问题。\n\n### 步骤3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解\n\n#### 1. 梯度与 Whitney 1-阶微分形式\n\n首先，我们计算重心坐标 $\\lambda_i$ 的梯度。令 $\\mathbf{g}_i = \\nabla\\lambda_i$。\n$$ \\lambda_0 = 1-x-y-z \\implies \\mathbf{g}_0 = \\nabla\\lambda_0 = -\\mathbf{\\hat{x}} - \\mathbf{\\hat{y}} - \\mathbf{\\hat{z}} = \\begin{pmatrix} -1 \\\\ -1 \\\\ -1 \\end{pmatrix} $$\n$$ \\lambda_1 = x \\implies \\mathbf{g}_1 = \\nabla\\lambda_1 = \\mathbf{\\hat{x}} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n$$ \\lambda_2 = y \\implies \\mathbf{g}_2 = \\nabla\\lambda_2 = \\mathbf{\\hat{y}} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n$$ \\lambda_3 = z \\implies \\mathbf{g}_3 = \\nabla\\lambda_3 = \\mathbf{\\hat{z}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n注意 $\\sum_{i=0}^{3} \\mathbf{g}_i = \\mathbf{0}$，这与 $\\sum_{i=0}^{3} \\lambda_i = 1$ 一致。\n\n根据定义 $\\mathbf{N}_{ij} = \\lambda_i \\mathbf{g}_j - \\lambda_j \\mathbf{g}_i$，为指定的边构建六个 Whitney $1$-阶微分形式：\n-   $\\mathbf{N}_{01} = \\lambda_0 \\mathbf{g}_1 - \\lambda_1 \\mathbf{g}_0 = (1-x-y-z)\\mathbf{\\hat{x}} - x(-\\mathbf{\\hat{x}}-\\mathbf{\\hat{y}}-\\mathbf{\\hat{z}}) = (1-y-z)\\mathbf{\\hat{x}} + x\\mathbf{\\hat{y}} + x\\mathbf{\\hat{z}}$\n-   $\\mathbf{N}_{02} = \\lambda_0 \\mathbf{g}_2 - \\lambda_2 \\mathbf{g}_0 = (1-x-y-z)\\mathbf{\\hat{y}} - y(-\\mathbf{\\hat{x}}-\\mathbf{\\hat{y}}-\\mathbf{\\hat{z}}) = y\\mathbf{\\hat{x}} + (1-x-z)\\mathbf{\\hat{y}} + y\\mathbf{\\hat{z}}$\n-   $\\mathbf{N}_{03} = \\lambda_0 \\mathbf{g}_3 - \\lambda_3 \\mathbf{g}_0 = (1-x-y-z)\\mathbf{\\hat{z}} - z(-\\mathbf{\\hat{x}}-\\mathbf{\\hat{y}}-\\mathbf{\\hat{z}}) = z\\mathbf{\\hat{x}} + z\\mathbf{\\hat{y}} + (1-x-y)\\mathbf{\\hat{z}}$\n-   $\\mathbf{N}_{12} = \\lambda_1 \\mathbf{g}_2 - \\lambda_2 \\mathbf{g}_1 = x\\mathbf{\\hat{y}} - y\\mathbf{\\hat{x}}$\n-   $\\mathbf{N}_{13} = \\lambda_1 \\mathbf{g}_3 - \\lambda_3 \\mathbf{g}_1 = x\\mathbf{\\hat{z}} - z\\mathbf{\\hat{x}}$\n-   $\\mathbf{N}_{23} = \\lambda_2 \\mathbf{g}_3 - \\lambda_3 \\mathbf{g}_2 = y\\mathbf{\\hat{z}} - z\\mathbf{\\hat{y}}$\n\n#### 2. 局部质量矩阵 $\\mathbf{M}$\n\n项 $M_{(ij),(kl)}$ 由 $M_{(ij),(kl)} = \\epsilon \\int_T \\mathbf{N}_{ij} \\cdot \\mathbf{N}_{kl} dV$ 给出。代入定义：\n$$ M_{(ij),(kl)} = \\epsilon \\int_T (\\lambda_i \\mathbf{g}_j - \\lambda_j \\mathbf{g}_i) \\cdot (\\lambda_k \\mathbf{g}_l - \\lambda_l \\mathbf{g}_k) dV $$\n$$ M_{(ij),(kl)} = \\epsilon \\left[ (\\mathbf{g}_j \\cdot \\mathbf{g}_l) \\int_T \\lambda_i \\lambda_k dV - (\\mathbf{g}_j \\cdot \\mathbf{g}_k) \\int_T \\lambda_i \\lambda_l dV - (\\mathbf{g}_i \\cdot \\mathbf{g}_l) \\int_T \\lambda_j \\lambda_k dV + (\\mathbf{g}_i \\cdot \\mathbf{g}_k) \\int_T \\lambda_j \\lambda_l dV \\right] $$\n我们使用体积为 $V_T$ 的四面体上的重心坐标的标准积分公式：$\\int_T \\lambda_0^a \\lambda_1^b \\lambda_2^c \\lambda_3^d dV = \\frac{a!b!c!d!}{(a+b+c+d+n)!} n! V_T$，其中 $n=3$ 是维度。我们的参考四面体的体积是 $V_T=1/6$。所以，$\\int_T \\lambda_0^a \\lambda_1^b \\lambda_2^c \\lambda_3^d dV = \\frac{a!b!c!d! \\cdot 6}{(a+b+c+d+3)!} \\cdot \\frac{1}{6} = \\frac{a!b!c!d!}{(a+b+c+d+3)!}$。\n我们需要的具体积分为：\n-   $\\int_T \\lambda_i^2 dV = \\frac{2!}{(2+3)!} = \\frac{2}{120} = \\frac{1}{60}$\n-   $\\int_T \\lambda_i \\lambda_j dV = \\frac{1!1!}{(1+1+3)!} = \\frac{1}{120}$ 对于 $i \\neq j$。\n\n我们还需要梯度的点积：\n$\\mathbf{g}_0 \\cdot \\mathbf{g}_0=3$，$\\mathbf{g}_1 \\cdot \\mathbf{g}_1=1$，$\\mathbf{g}_2 \\cdot \\mathbf{g}_2=1$，$\\mathbf{g}_3 \\cdot \\mathbf{g}_3=1$。\n$\\mathbf{g}_0 \\cdot \\mathbf{g}_1=-1$，$\\mathbf{g}_0 \\cdot \\mathbf{g}_2=-1$，$\\mathbf{g}_0 \\cdot \\mathbf{g}_3=-1$。\n$\\mathbf{g}_1 \\cdot \\mathbf{g}_2=0$，$\\mathbf{g}_1 \\cdot \\mathbf{g}_3=0$，$\\mathbf{g}_2 \\cdot \\mathbf{g}_3=0$。\n\n让我们计算一些代表性的项：\n-   $M_{(01),(01)} = \\epsilon \\left[ (\\mathbf{g}_1 \\cdot \\mathbf{g}_1)\\int_T\\lambda_0^2dV - 2(\\mathbf{g}_0 \\cdot \\mathbf{g}_1)\\int_T\\lambda_0\\lambda_1dV + (\\mathbf{g}_0 \\cdot \\mathbf{g}_0)\\int_T\\lambda_1^2dV \\right] = \\epsilon \\left[ (1)\\frac{1}{60} - 2(-1)\\frac{1}{120} + (3)\\frac{1}{60} \\right] = \\epsilon \\left( \\frac{1}{60} + \\frac{2}{120} + \\frac{3}{60} \\right) = \\frac{10\\epsilon}{120} = \\frac{\\epsilon}{12}$。\n-   $M_{(12),(12)} = \\epsilon \\left[ (\\mathbf{g}_2 \\cdot \\mathbf{g}_2)\\int_T\\lambda_1^2dV - 2(\\mathbf{g}_1 \\cdot \\mathbf{g}_2)\\int_T\\lambda_1\\lambda_2dV + (\\mathbf{g}_1 \\cdot \\mathbf{g}_1)\\int_T\\lambda_2^2dV \\right] = \\epsilon \\left[ (1)\\frac{1}{60} - 2(0)\\frac{1}{120} + (1)\\frac{1}{60} \\right] = \\frac{2\\epsilon}{60} = \\frac{\\epsilon}{30}$。\n-   $M_{(01),(02)} = \\epsilon \\left[ (\\mathbf{g}_1 \\cdot \\mathbf{g}_2)\\int\\lambda_0^2 - (\\mathbf{g}_1 \\cdot \\mathbf{g}_0)\\int\\lambda_0\\lambda_2 - (\\mathbf{g}_0 \\cdot \\mathbf{g}_2)\\int\\lambda_1\\lambda_0 + (\\mathbf{g}_0 \\cdot \\mathbf{g}_0)\\int\\lambda_1\\lambda_2 \\right] = \\epsilon \\left[ 0 - (-1)\\frac{1}{120} - (-1)\\frac{1}{120} + 3\\frac{1}{120} \\right] = \\frac{5\\epsilon}{120} = \\frac{\\epsilon}{24}$。\n-   $M_{(12),(13)} = \\epsilon \\left[ (\\mathbf{g}_2 \\cdot \\mathbf{g}_3)\\int\\lambda_1^2 - (\\mathbf{g}_2 \\cdot \\mathbf{g}_1)\\int\\lambda_1\\lambda_3 - (\\mathbf{g}_1 \\cdot \\mathbf{g}_3)\\int\\lambda_2\\lambda_1 + (\\mathbf{g}_1 \\cdot \\mathbf{g}_1)\\int\\lambda_2\\lambda_3 \\right] = \\epsilon \\left[ 0 - 0 - 0 + (1)\\frac{1}{120} \\right] = \\frac{\\epsilon}{120}$。\n-   $M_{(01),(12)} = \\epsilon \\left[ (\\mathbf{g}_1 \\cdot \\mathbf{g}_2)\\int\\lambda_0\\lambda_1 - (\\mathbf{g}_1 \\cdot \\mathbf{g}_1)\\int\\lambda_0\\lambda_2 - (\\mathbf{g}_0 \\cdot \\mathbf{g}_2)\\int\\lambda_1^2 + (\\mathbf{g}_0 \\cdot \\mathbf{g}_1)\\int\\lambda_1\\lambda_2 \\right] = \\epsilon \\left[ 0 - (1)\\frac{1}{120} - (-1)\\frac{1}{60} + (-1)\\frac{1}{120} \\right] = \\epsilon \\left( -\\frac{1}{120} + \\frac{2}{120} - \\frac{1}{120} \\right) = 0$。\n\n系统计算揭示了指定边顺序下的块对角结构。边的集合可以划分为 $E_0 = \\{(0,1), (0,2), (0,3)\\}$ 和 $E_f = \\{(1,2), (1,3), (2,3)\\}$。矩阵具有 $\\mathbf{M} = \\begin{pmatrix} \\mathbf{M}_0 & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{M}_f \\end{pmatrix}$ 的形式。\n$$ \\mathbf{M}_0 = \\frac{\\epsilon}{24} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix}, \\quad \\mathbf{M}_f = \\frac{\\epsilon}{120} \\begin{pmatrix} 4 & 1 & -1 \\\\ 1 & 4 & 1 \\\\ -1 & 1 & 4 \\end{pmatrix} $$\n完整的 $6 \\times 6$ 矩阵为：\n$$ \\mathbf{M} = \\frac{\\epsilon}{120} \\begin{pmatrix} 10 & 5 & 5 & 0 & 0 & 0 \\\\ 5 & 10 & 5 & 0 & 0 & 0 \\\\ 5 & 5 & 10 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 4 & 1 & -1 \\\\ 0 & 0 & 0 & 1 & 4 & 1 \\\\ 0 & 0 & 0 & -1 & 1 & 4 \\end{pmatrix} $$\n\n#### 3. 局部旋度-旋度刚度矩阵 $\\mathbf{K}$\n\n首先，我们计算基函数 $\\mathbf{N}_{ij}$ 的旋度。使用矢量恒等式 $\\nabla \\times (f\\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + \\nabla f \\times \\mathbf{A}$ 并注意到梯度 $\\mathbf{g}_j=\\nabla\\lambda_j$ 是常矢量，其旋度为零 ($\\nabla \\times \\mathbf{g}_j = \\mathbf{0}$)。\n$$ \\nabla \\times \\mathbf{N}_{ij} = \\nabla \\times (\\lambda_i \\mathbf{g}_j - \\lambda_j \\mathbf{g}_i) = (\\nabla \\lambda_i \\times \\mathbf{g}_j) - (\\nabla \\lambda_j \\times \\mathbf{g}_i) = (\\mathbf{g}_i \\times \\mathbf{g}_j) - (\\mathbf{g}_j \\times \\mathbf{g}_i) = 2(\\mathbf{g}_i \\times \\mathbf{g}_j) $$\n每个基函数的旋度都是一个常矢量。令 $\\mathbf{c}_{ij} = \\mathbf{g}_i \\times \\mathbf{g}_j$。\n刚度矩阵的项为：\n$$ K_{(ij),(kl)} = \\frac{1}{\\mu} \\int_T (2\\mathbf{c}_{ij}) \\cdot (2\\mathbf{c}_{kl}) dV = \\frac{4}{\\mu} (\\mathbf{c}_{ij} \\cdot \\mathbf{c}_{kl}) \\int_T dV = \\frac{4 V_T}{\\mu} (\\mathbf{c}_{ij} \\cdot \\mathbf{c}_{kl}) $$\n由于 $V_T=1/6$，所以 $K_{(ij),(kl)} = \\frac{2}{3\\mu}(\\mathbf{c}_{ij} \\cdot \\mathbf{c}_{kl})$。\n所需的叉积为：\n-   $\\mathbf{c}_{01} = \\mathbf{g}_0 \\times \\mathbf{g}_1 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}$\n-   $\\mathbf{c}_{02} = \\mathbf{g}_0 \\times \\mathbf{g}_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$\n-   $\\mathbf{c}_{03} = \\mathbf{g}_0 \\times \\mathbf{g}_3 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n-   $\\mathbf{c}_{12} = \\mathbf{g}_1 \\times \\mathbf{g}_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$\n-   $\\mathbf{c}_{13} = \\mathbf{g}_1 \\times \\mathbf{g}_3 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\end{pmatrix}$\n-   $\\mathbf{c}_{23} = \\mathbf{g}_2 \\times \\mathbf{g}_3 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n\n我们计算点积 $\\mathbf{c}_{ij} \\cdot \\mathbf{c}_{kl}$ 并组装矩阵。例如：\n-   $K_{(01),(01)} = \\frac{2}{3\\mu} \\mathbf{c}_{01} \\cdot \\mathbf{c}_{01} = \\frac{2}{3\\mu} (0^2 + (-1)^2 + 1^2) = \\frac{4}{3\\mu}$。\n-   $K_{(01),(02)} = \\frac{2}{3\\mu} \\mathbf{c}_{01} \\cdot \\mathbf{c}_{02} = \\frac{2}{3\\mu} ((0)(1) + (-1)(0) + (1)(-1)) = -\\frac{2}{3\\mu}$。\n-   $K_{(01),(12)} = \\frac{2}{3\\mu} \\mathbf{c}_{01} \\cdot \\mathbf{c}_{12} = \\frac{2}{3\\mu} ((0)(0) + (-1)(0) + (1)(1)) = \\frac{2}{3\\mu}$。\n\n对所有对重复此过程，我们得到矩阵 $\\mathbf{K}$：\n$$ \\mathbf{K} = \\frac{2}{3\\mu} \\begin{pmatrix}\n 2 & -1 & -1 &  1 &  1 &  0 \\\\\n-1 &  2 & -1 & -1 &  0 &  1 \\\\\n-1 & -1 &  2 &  0 & -1 & -1 \\\\\n 1 & -1 &  0 &  1 &  0 &  0 \\\\\n 1 &  0 & -1 &  0 &  1 &  0 \\\\\n 0 &  1 & -1 &  0 &  0 &  1\n\\end{pmatrix} $$\n\n#### 4. 对称性与秩的验证\n\n**对称性**：\n-   对于质量矩阵，$M_{(ij),(kl)} = \\epsilon \\int_T \\mathbf{N}_{ij} \\cdot \\mathbf{N}_{kl} dV$。由于标量积是可交换的，$\\mathbf{N}_{ij} \\cdot \\mathbf{N}_{kl} = \\mathbf{N}_{kl} \\cdot \\mathbf{N}_{ij}$，因此 $M_{(ij),(kl)} = M_{(kl),(ij)}$。所以 $\\mathbf{M}$ 是对称的。我们计算出的矩阵确实是对称的。\n-   对于刚度矩阵，$K_{(ij),(kl)} = \\frac{2}{3\\mu} (\\mathbf{g}_i \\times \\mathbf{g}_j) \\cdot (\\mathbf{g}_k \\times \\mathbf{g}_l)$。标量积的可交换性意味着 $K_{(ij),(kl)} = K_{(kl),(ij)}$，因此 $\\mathbf{K}$ 也是对称的。我们计算出的矩阵是对称的。\n\n**$\\mathbf{M}$ 的秩**：\n矩阵 $\\mathbf{M}$ 是块对角矩阵。其秩是其对角块的秩之和。\n-   对于 $\\mathbf{M}_0 = \\frac{\\epsilon}{24} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix}$，行列式与 $2(4-1) - 1(2-1) + 1(1-2) = 6-1-1 = 4 \\neq 0$ 成正比。因此，$\\mathrm{rank}(\\mathbf{M}_0)=3$。\n-   对于 $\\mathbf{M}_f = \\frac{\\epsilon}{120} \\begin{pmatrix} 4 & 1 & -1 \\\\ 1 & 4 & 1 \\\\ -1 & 1 & 4 \\end{pmatrix}$，行列式与 $4(16-1) - 1(4-(-1)) - 1(1-(-4)) = 60-5-5=50 \\neq 0$ 成正比。因此，$\\mathrm{rank}(\\mathbf{M}_f)=3$。\n总秩为 $\\mathrm{rank}(\\mathbf{M}) = \\mathrm{rank}(\\mathbf{M}_0) + \\mathrm{rank}(\\mathbf{M}_f) = 3+3=6$。质量矩阵是满秩的，这是预料之中的，因为六个基函数 $\\mathbf{N}_{ij}$ 在域 $T$ 上是线性无关的。\n\n**$\\mathbf{K}$ 的秩**：\n$\\mathbf{K}$ 的秩是由常数旋度向量 $\\{2\\mathbf{c}_{ij}\\}$ 张成的空间的维度。这等价于向量集 $\\{\\mathbf{c}_{ij}\\}_{ij \\in E}$ 的秩，其中 $E$ 是六条边的集合。这些向量是：\n$\\mathbf{c}_{12} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$，$\\mathbf{c}_{13} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\end{pmatrix}$，$\\mathbf{c}_{23} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n这三个向量对应于原点对面的面上的边，并构成 $\\mathbb{R}^3$ 的一个正交基。剩下的三个向量可以使用关系式 $\\mathbf{g}_0 = -\\mathbf{g}_1 - \\mathbf{g}_2 - \\mathbf{g}_3$ 表示为它们的线性组合：\n-   $\\mathbf{c}_{01} = \\mathbf{g}_0 \\times \\mathbf{g}_1 = (-\\mathbf{g}_2 - \\mathbf{g}_3) \\times \\mathbf{g}_1 = \\mathbf{g}_1 \\times \\mathbf{g}_2 + \\mathbf{g}_1 \\times \\mathbf{g}_3 = \\mathbf{c}_{12} + \\mathbf{c}_{13}$。\n-   $\\mathbf{c}_{02} = \\mathbf{g}_0 \\times \\mathbf{g}_2 = (-\\mathbf{g}_1 - \\mathbf{g}_3) \\times \\mathbf{g}_2 = \\mathbf{g}_2 \\times \\mathbf{g}_1 + \\mathbf{g}_2 \\times \\mathbf{g}_3 = -\\mathbf{c}_{12} + \\mathbf{c}_{23}$。\n-   $\\mathbf{c}_{03} = \\mathbf{g}_0 \\times \\mathbf{g}_3 = (-\\mathbf{g}_1 - \\mathbf{g}_2) \\times \\mathbf{g}_3 = \\mathbf{g}_3 \\times \\mathbf{g}_1 + \\mathbf{g}_3 \\times \\mathbf{g}_2 = -\\mathbf{c}_{13} - \\mathbf{c}_{23}$。\n由于所有六个向量 $\\{\\mathbf{c}_{ij}\\}$ 都可以写成三个线性无关向量 $\\{\\mathbf{c}_{12}, \\mathbf{c}_{13}, \\mathbf{c}_{23}\\}$ 的线性组合，因此由所有六个向量张成的空间的维度是 3。\n格拉姆矩阵 $\\mathbf{K}$ 的秩等于生成向量所张成的向量空间的维度。因此，$\\mathrm{rank}(\\mathbf{K})=3$。\n$\\mathbf{K}$ 的零空间的维度是 $6 - 3 = 3$。这对应于这样一个事实，即存在 $4-1=3$ 个与四面体节点相关的无旋（梯度）场，它们被旋度算子消去。\n\n矩阵的秩为 $\\mathrm{rank}(\\mathbf{M})=6$ 和 $\\mathrm{rank}(\\mathbf{K})=3$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n6 & 3\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个优秀的数值离散格式应当在代数层面反映其背后连续系统的基本物理定律。本练习的核心是探索离散化的 Maxwell 方程组如何保持能量守恒，即离散的 Poynting 定理 。你将推导保证能量守恒的矩阵代数条件，并通过数值实验研究一种常见的简化技术——质量集中（mass lumping）——如何影响系统的谱特性，即其固有的谐振频率。",
            "id": "3324091",
            "problem": "考虑以分块形式写出的半离散、无源一阶麦克斯韦系统，它是一个关于混合变量 $\\,\\mathbf{u}(t)\\in\\mathbb{R}^{n}\\,$ 的线性时不变常微分方程：\n$$\n\\mathbf{M}\\,\\dot{\\mathbf{u}}(t)=\\mathbf{K}\\,\\mathbf{u}(t),\n$$\n其中 $\\,\\mathbf{M}\\in\\mathbb{R}^{n\\times n}\\,$ 是离散质量算子，$\\,\\mathbf{K}\\in\\mathbb{R}^{n\\times n}\\,$ 是离散旋度耦合算子。在一阶麦克斯韦方程组的相容有限元或时域有限差分设置中，其分块结构通常具有以下形式：\n$$\n\\mathbf{u}=\\begin{bmatrix}\\mathbf{e}\\\\ \\mathbf{h}\\end{bmatrix},\\quad \n\\mathbf{M}=\\begin{bmatrix}\\mathbf{M}_{e} & \\mathbf{0}\\\\ \\mathbf{0} & \\mathbf{M}_{h}\\end{bmatrix},\\quad\n\\mathbf{K}=\\begin{bmatrix}\\mathbf{0} & \\mathbf{C}\\\\ -\\mathbf{C}^{\\top} & \\mathbf{0}\\end{bmatrix},\n$$\n其中 $\\,\\mathbf{M}_{e},\\mathbf{M}_{h}\\in\\mathbb{R}^{m\\times m}\\,$ 且 $\\,\\mathbf{C}\\in\\mathbb{R}^{m\\times m}\\,$，对于 $\\,n=2m\\,$。假设一个长度为 $\\,L>0\\,$ 的周期性、均匀的一维晶格，每个场有 $\\,N\\in\\mathbb{N}\\,$ 个自由度，并为每个场选择一个与周期性环上的线性有限元相对应的一致、对称正定离散质量算子。具体来说，设网格间距为 $\\,h=L/N\\,$，并定义一致一维质量矩阵 $\\,\\mathbf{M}_{\\mathrm{fe}}\\in\\mathbb{R}^{N\\times N}\\,$ 如下：\n$$\n\\left(\\mathbf{M}_{\\mathrm{fe}}\\right)_{ii}=\\tfrac{2h}{3},\\quad\n\\left(\\mathbf{M}_{\\mathrm{fe}}\\right)_{i,i\\pm 1}=\\tfrac{h}{6}\\quad\\text{具有周期性环绕,}\n$$\n其他位置为零。设 $\\,\\mathbf{M}_{e}=\\mathbf{M}_{h}=\\mathbf{M}_{\\mathrm{fe}}\\,$。定义离散一阶差分算子 $\\,\\mathbf{D}\\in\\mathbb{R}^{N\\times N}\\,$ 如下：\n$$\n\\left(\\mathbf{D}\\right)_{ii}=-1,\\quad \\left(\\mathbf{D}\\right)_{i,i-1}=1\\quad\\text{具有周期性环绕,}\n$$\n其他位置为零，并令 $\\,\\mathbf{C}=\\frac{1}{h}\\mathbf{D}\\,$。因此，$\\,\\mathbf{M}\\,$ 和 $\\,\\mathbf{K}\\,$ 由上述的 $\\,\\mathbf{M}_{\\mathrm{fe}}\\,$ 和 $\\,\\mathbf{C}\\,$ 确定。\n\n您必须从电磁学基本定律（麦克斯韦方程组）及其能量平衡（坡印亭定理），以及实矩阵在内积下的基本性质出发：\n\n1. 推导在何种关于 $\\,\\mathbf{M}\\,$ 和 $\\,\\mathbf{K}\\,$ 的代数约束下，对于无源半离散系统 $\\,\\mathbf{M}\\dot{\\mathbf{u}}=\\mathbf{K}\\mathbf{u}\\,$，由 $\\,\\mathbf{M}\\,$ 导出的二次型所定义的离散电磁能随时间守恒。您的推导应从离散能量作为基于内积的二次泛函的定义开始，并仅使用线性代数和实矩阵的性质，通过直接求导和代数变换进行。\n\n2. 在存在一个仅作用于电场的代表欧姆损耗的耗散机制时，通过在电场方程中添加一个对称半正定分块算子 $\\,\\mathbf{R}_{e}=\\sigma\\,\\mathbf{M}_{e}\\,$（其中 $\\,\\sigma>0\\,$）来模拟损耗，得到修正后的系统：\n$$\n\\mathbf{M}\\,\\dot{\\mathbf{u}}=\\left(\\mathbf{K}-\\mathbf{R}\\right)\\mathbf{u},\\qquad\n\\mathbf{R}=\\begin{bmatrix}\\mathbf{R}_{e} & \\mathbf{0}\\\\ \\mathbf{0} & \\mathbf{0}\\end{bmatrix}.\n$$\n推导此系统的离散能量平衡不等式，并陈述保证能量不增的代数条件。\n\n3. 通过将一致质量 $\\,\\mathbf{M}\\,$ 替换为一个集中对角近似 $\\,\\widetilde{\\mathbf{M}}\\,$（其对角线元素为 $\\,\\mathbf{M}\\,$ 的行和），研究对角质量集中对谱特性的影响。比较广义特征值问题\n$$\n\\mathbf{K}\\mathbf{v}=\\lambda\\,\\mathbf{M}\\mathbf{v}\\quad\\text{和}\\quad \\mathbf{K}\\mathbf{v}=\\lambda\\,\\widetilde{\\mathbf{M}}\\mathbf{v},\n$$\n的谱，就其纯虚数性质和模态频率的相对偏移进行比较。\n\n您必须实现一个程序，构建上述矩阵，并在以下参数值的测试套件上对推导出的性质进行数值验证：\n\n- 测试用例 A (无损耗，能量守恒和纯虚谱):\n  - $\\,N=8\\,$, $\\,L=1.0\\,$.\n  - 按规定构建 $\\,\\mathbf{M}\\,$ 和 $\\,\\mathbf{K}\\,$。\n  - 通过检查所需的对称性以及 $\\,\\mathbf{K}\\mathbf{v}=\\lambda\\,\\mathbf{M}\\mathbf{v}\\,$ 的所有广义特征值 $\\,\\lambda\\,$ 的实部在 $\\,10^{-9}\\,$ 的容差内数值上等于零，来验证第 1 项中推导的能量守恒约束。\n  - 对于几个随机非零 $\\,\\mathbf{u}\\,$，还需验证作为二次型 $\\,\\mathbf{u}^{\\top}\\mathbf{K}\\mathbf{u}\\,$ 计算的瞬时离散能量产生率在数值上为零（在 $\\,10^{-9}\\,$ 内）。\n\n- 测试用例 B (质量集中谱偏移):\n  - 使用相同的 $\\,N\\,$ 和 $\\,L\\,$。\n  - 通过对 $\\,\\mathbf{M}\\,$ 进行对角行和集中，形成集中质量 $\\,\\widetilde{\\mathbf{M}}\\,$。\n  - 从两个广义特征值问题中计算非零模态频率 $\\,\\omega=\\lvert\\operatorname{Im}(\\lambda)\\rvert\\,$，将小于 $\\,10^{-8}\\,$ 的频率作为数值零丢弃，将它们按升序排序，并报告按索引匹配的频率集之间的最大绝对相对偏差：\n  $$\n  \\max_{j}\\frac{\\lvert \\omega_{j}^{\\text{lumped}}-\\omega_{j}^{\\text{consistent}}\\rvert}{\\max\\{\\omega_{j}^{\\text{consistent}},\\,10^{-12}\\}}.\n  $$\n\n- 测试用例 C (含欧姆损耗的耗散情况):\n  - 使用相同的 $\\,N\\,$ 和 $\\,L\\,$，并设置 $\\,\\sigma=0.2\\,$.\n  - 如上形成 $\\,\\mathbf{R}_{e}=\\sigma\\,\\mathbf{M}_{e}\\,$ 和 $\\,\\mathbf{R}\\,$，并定义 $\\,\\mathbf{K}_{\\text{loss}}=\\mathbf{K}-\\mathbf{R}\\,$。\n  - 通过检查对于几个随机非零 $\\,\\mathbf{u}\\,$，$\\,\\mathbf{u}^{\\top}\\mathbf{K}_{\\text{loss}}\\mathbf{u}\\le 10^{-10}\\,$ 是否成立，来验证第 2 项中的能量不增条件。\n  - 计算 $\\,\\mathbf{K}_{\\text{loss}}\\mathbf{v}=\\lambda\\,\\mathbf{M}\\mathbf{v}\\,$ 的广义特征值，并报告最大实部。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，其顺序和类型如下：\n- 第一项 (布尔值): 测试用例 A 的总体通过结果，其中所有必需的对称性和谱检查以及瞬时能量产生率检查同时成立。\n- 第二项 (浮点数): 测试用例 B 中如上定义的最大频率绝对相对偏差。\n- 第三项 (布尔值): 测试用例 C 中能量不增验证的结果。\n- 第四项 (浮点数): 测试用例 C 中广义特征值的最大实部。\n\n程序必须无输入，不使用文件，并且必须确定性地执行。不涉及角度，输出中不需要物理单位。您的程序应精确地生成一行格式，例如 $[\\text{True},0.0123,\\text{True},-0.0456]$。",
            "solution": "经分析，问题陈述是有效的。它在科学上基于计算电磁学的原理，特别是针对麦克斯韦方程组的有限元或时域有限差分方法。问题是适定的、客观的，并包含推导所需理论结果和执行数值验证所需的所有必要信息。\n\n解答分为三部分，对应问题描述中的各项。\n\n### 1. 离散能量守恒条件的推导\n\n离散电磁能 $E(t)$ 由离散质量算子 $\\mathbf{M}$ 导出的二次型定义。为了物理解释，我们将其定义为：\n$$\nE(t) = \\frac{1}{2} \\mathbf{u}(t)^{\\top} \\mathbf{M} \\mathbf{u}(t)\n$$\n此处，$\\mathbf{u}(t)$ 是电场和磁场自由度的状态向量。为使此能量泛函成为一个有效的能量度量，它对于任何非平凡状态都必须为正，这意味着矩阵 $\\mathbf{M}$ 必须是对称正定 (SPD) 的。问题指定 $\\mathbf{M}_{e}=\\mathbf{M}_{h}=\\mathbf{M}_{\\mathrm{fe}}$，其中 $\\mathbf{M}_{\\mathrm{fe}}$ 是线性有限元的一致质量矩阵。众所周知该矩阵是 SPD 的，因此分块对角矩阵 $\\mathbf{M}$ 也是 SPD 的。\n\n为了推导能量守恒的条件，我们计算 $E(t)$ 的时间导数：\n$$\n\\frac{dE}{dt} = \\frac{d}{dt} \\left( \\frac{1}{2} \\mathbf{u}^{\\top} \\mathbf{M} \\mathbf{u} \\right)\n$$\n使用微分的乘法法则，并注意到 $\\mathbf{u}$ 是时间 $t$ 的函数：\n$$\n\\frac{dE}{dt} = \\frac{1}{2} \\left( \\dot{\\mathbf{u}}^{\\top} \\mathbf{M} \\mathbf{u} + \\mathbf{u}^{\\top} \\mathbf{M} \\dot{\\mathbf{u}} \\right)\n$$\n由于 $\\mathbf{M}$ 是一个实对称矩阵 ($\\mathbf{M} = \\mathbf{M}^{\\top}$)，括号中的两项是相等的标量：$\\dot{\\mathbf{u}}^{\\top} \\mathbf{M} \\mathbf{u} = (\\mathbf{u}^{\\top} \\mathbf{M}^{\\top} \\dot{\\mathbf{u}})^{\\top} = (\\mathbf{u}^{\\top} \\mathbf{M} \\dot{\\mathbf{u}})$。因此，表达式简化为：\n$$\n\\frac{dE}{dt} = \\mathbf{u}^{\\top} \\mathbf{M} \\dot{\\mathbf{u}}\n$$\n我们现在代入控制性的半离散麦克斯韦系统 $\\mathbf{M}\\dot{\\mathbf{u}}=\\mathbf{K}\\mathbf{u}$：\n$$\n\\frac{dE}{dt} = \\mathbf{u}^{\\top} (\\mathbf{K} \\mathbf{u}) = \\mathbf{u}^{\\top} \\mathbf{K} \\mathbf{u}\n$$\n如果能量的时间导数对于任何可能的状态 $\\mathbf{u}(t)$ 都为零，则能量守恒。这要求二次型 $\\mathbf{u}^{\\top} \\mathbf{K} \\mathbf{u}$ 对于所有向量 $\\mathbf{u} \\in \\mathbb{R}^{n}$ 恒为零。线性代数中的一个基本结果表明，对于实矩阵 $\\mathbf{A}$，二次型 $\\mathbf{x}^{\\top}\\mathbf{A}\\mathbf{x} = 0$ 对所有实向量 $\\mathbf{x}$ 成立，当且仅当 $\\mathbf{A}$ 是斜对称的，即 $\\mathbf{A}^{\\top} = -\\mathbf{A}$。\n\n因此，对于离散能量守恒，$\\mathbf{K}$ 的代数约束是 $\\mathbf{K}$ 必须是一个斜对称矩阵。问题定义 $\\mathbf{K}=\\begin{bsmallmatrix}\\mathbf{0} & \\mathbf{C}\\\\ -\\mathbf{C}^{\\top} & \\mathbf{0}\\end{bsmallmatrix}$，其转置为 $\\mathbf{K}^{\\top}=\\begin{bsmallmatrix}\\mathbf{0} & -\\mathbf{C}\\\\ \\mathbf{C}^{\\top} & \\mathbf{0}\\end{bsmallmatrix} = -\\mathbf{K}$。这种结构是麦克斯韦方程组相容离散化所固有的，从数学上保证了离散能量守恒。\n\n总之，代数约束是：\n1.  $\\mathbf{M}$ 必须是对称正定的。\n2.  $\\mathbf{K}$ 必须是斜对称的 ($\\mathbf{K}^{\\top} = -\\mathbf{K}$)。\n\n### 2. 含欧姆损耗的离散能量平衡\n\n在存在欧姆损耗的情况下，系统被修改为 $\\mathbf{M}\\,\\dot{\\mathbf{u}}=\\left(\\mathbf{K}-\\mathbf{R}\\right)\\mathbf{u}$。能量的定义 $E(t) = \\frac{1}{2} \\mathbf{u}^{\\top} \\mathbf{M} \\mathbf{u}$ 保持不变，因为它代表存储在场中的能量。能量的变化率通过与第 1 部分相同的步骤求得，但代入的是修正后的系统方程：\n$$\n\\frac{dE}{dt} = \\mathbf{u}^{\\top} \\mathbf{M} \\dot{\\mathbf{u}} = \\mathbf{u}^{\\top} \\left(\\mathbf{K}-\\mathbf{R}\\right) \\mathbf{u} = \\mathbf{u}^{\\top}\\mathbf{K}\\mathbf{u} - \\mathbf{u}^{\\top}\\mathbf{R}\\mathbf{u}\n$$\n从第 1 部分我们知道，对于一个能量守恒的离散化，$\\mathbf{u}^{\\top}\\mathbf{K}\\mathbf{u} = 0$。这就得到了离散能量平衡方程（一个半离散的坡印亭定理）：\n$$\n\\frac{dE}{dt} = -\\mathbf{u}^{\\top}\\mathbf{R}\\mathbf{u}\n$$\n这个方程表明，存储能量的变化率等于耗散功率的负值，耗散功率由二次型 $\\mathbf{u}^{\\top}\\mathbf{R}\\mathbf{u}$ 表示。\n\n为了使总能量不增加，对于任何状态 $\\mathbf{u}$，我们必须有 $\\frac{dE}{dt} \\le 0$。这意味着：\n$$\n-\\mathbf{u}^{\\top}\\mathbf{R}\\mathbf{u} \\le 0 \\quad \\implies \\quad \\mathbf{u}^{\\top}\\mathbf{R}\\mathbf{u} \\ge 0\n$$\n二次型 $\\mathbf{x}^{\\top}\\mathbf{A}\\mathbf{x}$ 对于所有实向量 $\\mathbf{x}$ 非负的代数条件是矩阵 $\\mathbf{A}$ 必须是对称半正定 (SPSD) 的。\n\n问题指定 $\\mathbf{R}=\\begin{bsmallmatrix}\\mathbf{R}_{e} & \\mathbf{0}\\\\ \\mathbf{0} & \\mathbf{0}\\end{bsmallmatrix}$，其中 $\\mathbf{R}_{e}=\\sigma\\,\\mathbf{M}_{e}$，$\\sigma>0$ 且 $\\mathbf{M}_{e}=\\mathbf{M}_{\\mathrm{fe}}$ 是对称正定的。由于 $\\sigma$ 是一个正标量，$\\mathbf{R}_{e}$ 也是对称正定的。矩阵 $\\mathbf{R}$ 是对称的。相应的二次型是 $\\mathbf{u}^{\\top}\\mathbf{R}\\mathbf{u} = \\mathbf{e}^{\\top}\\mathbf{R}_{e}\\mathbf{e} + \\mathbf{h}^{\\top}\\mathbf{0}\\mathbf{h} = \\mathbf{e}^{\\top}\\mathbf{R}_{e}\\mathbf{e}$。由于 $\\mathbf{R}_{e}$ 是对称正定的，$\\mathbf{e}^{\\top}\\mathbf{R}_{e}\\mathbf{e} \\ge 0$，等号仅在 $\\mathbf{e}=\\mathbf{0}$ 时成立。因此，$\\mathbf{R}$ 是对称半正定的，能量不增的条件通过其构造得到满足。\n\n### 3. 谱特性与质量集中\n\n我们分析广义特征值问题 $\\mathbf{K}\\mathbf{v}=\\lambda\\,\\mathbf{M}\\mathbf{v}$，它控制着无损耗系统的模态行为。设 $(\\lambda, \\mathbf{v})$ 为一个特征对，其中 $\\lambda \\in \\mathbb{C}$ 且 $\\mathbf{v} \\in \\mathbb{C}^{n}$ 是一个非零特征向量。\n用特征向量的共轭转置 $\\mathbf{v}^{\\dagger}$ 左乘，得到：\n$$\n\\mathbf{v}^{\\dagger}\\mathbf{K}\\mathbf{v} = \\lambda\\,\\mathbf{v}^{\\dagger}\\mathbf{M}\\mathbf{v}\n$$\n对整个方程取共轭转置，得到：\n$$\n(\\mathbf{v}^{\\dagger}\\mathbf{K}\\mathbf{v})^{\\dagger} = (\\lambda\\,\\mathbf{v}^{\\dagger}\\mathbf{M}\\mathbf{v})^{\\dagger} \\implies \\mathbf{v}^{\\dagger}\\mathbf{K}^{\\dagger}\\mathbf{v} = \\lambda^{*}\\,\\mathbf{v}^{\\dagger}\\mathbf{M}^{\\dagger}\\mathbf{v}\n$$\n由于 $\\mathbf{K}$ 和 $\\mathbf{M}$ 是实矩阵，$\\mathbf{K}^{\\dagger}=\\mathbf{K}^{\\top}$ 且 $\\mathbf{M}^{\\dagger}=\\mathbf{M}^{\\top}$。使用已确立的性质——$\\mathbf{M}$ 是对称的 ($\\mathbf{M}^{\\top}=\\mathbf{M}$) 且 $\\mathbf{K}$ 是斜对称的 ($\\mathbf{K}^{\\top}=-\\mathbf{K}$)，这变成：\n$$\n-\\mathbf{v}^{\\dagger}\\mathbf{K}\\mathbf{v} = \\lambda^{*}\\,\\mathbf{v}^{\\dagger}\\mathbf{M}\\mathbf{v}\n$$\n从第一个方程代入 $\\mathbf{v}^{\\dagger}\\mathbf{K}\\mathbf{v}$：\n$$\n-\\lambda\\,\\mathbf{v}^{\\dagger}\\mathbf{M}\\mathbf{v} = \\lambda^{*}\\,\\mathbf{v}^{\\dagger}\\mathbf{M}\\mathbf{v} \\implies (\\lambda + \\lambda^{*})\\,\\mathbf{v}^{\\dagger}\\mathbf{M}\\mathbf{v} = 0\n$$\n由于 $\\mathbf{M}$ 是对称正定且 $\\mathbf{v}$ 是一个特征向量，项 $\\mathbf{v}^{\\dagger}\\mathbf{M}\\mathbf{v}$ 是一个正实数。因此，我们必须有 $\\lambda + \\lambda^{*} = 0$，这等价于 $2\\operatorname{Re}(\\lambda) = 0$。这证明了无损耗系统的所有特征值 $\\lambda$ 都是纯虚数。\n\n同样的推导适用于质量集中系统 $\\mathbf{K}\\mathbf{v}=\\lambda\\,\\widetilde{\\mathbf{M}}\\mathbf{v}$。集中质量矩阵 $\\widetilde{\\mathbf{M}}$ 是通过将 $\\mathbf{M}$ 的行相加并将总和放在对角线上得到的。由于 $\\mathbf{M}$ 具有正元素且其行和为正 ($h$)，$\\widetilde{\\mathbf{M}}$ 是一个具有正对角元素的对角矩阵，使其成为对称正定矩阵。由于纯虚数特征值的论证仅要求质量矩阵是 SPD 且 $\\mathbf{K}$ 是斜对称的，因此质量集中系统的谱也是纯虚的。\n\n质量集中改变了质量分布，这反过来又影响了模态频率 $\\omega = |\\operatorname{Im}(\\lambda)|$。众所周知，与一致质量公式相比，质量集中对高频模态的影响更显著，并且通常会导致对固有频率的高估。B 部分的数值测试将量化这种谱偏移。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eig, block_diag\n\ndef solve():\n    \"\"\"\n    Constructs matrices for a 1D periodic semi-discrete Maxwell system and\n    verifies properties related to energy conservation, dissipation, and\n    mass lumping, as specified in the problem statement.\n    \"\"\"\n    # Define problem parameters for the test suite\n    N = 8\n    L = 1.0\n    sigma = 0.2\n    h = L / N\n    \n    # --- Matrix Construction Functions---\n    def create_M_fe(n, cell_size):\n        \"\"\"Creates the consistent finite element mass matrix for a 1D periodic domain.\"\"\"\n        mat = np.zeros((n, n))\n        for i in range(n):\n            mat[i, i] = 2.0 * cell_size / 3.0\n            mat[i, (i + 1) % n] = cell_size / 6.0\n            mat[i, (i - 1 + n) % n] = cell_size / 6.0\n        return mat\n\n    def create_D(n):\n        \"\"\"Creates the first-difference matrix with periodic boundary conditions.\"\"\"\n        mat = np.zeros((n, n))\n        for i in range(n):\n            mat[i, i] = -1.0\n            mat[i, (i - 1 + n) % n] = 1.0\n        return mat\n\n    # --- Build Core Matrices ---\n    M_fe = create_M_fe(N, h)\n    D = create_D(N)\n    C = (1.0 / h) * D\n    \n    M_e = M_fe\n    M_h = M_fe\n    \n    M = block_diag(M_e, M_h)\n    \n    Z = np.zeros((N, N))\n    K = np.block([[Z, C], [-C.T, Z]])\n\n    # Use a fixed seed for reproducible random vectors\n    rng = np.random.default_rng(0)\n    \n    # --- Test Case A: Lossless System Verification ---\n    # 1. Verify matrix symmetries\n    check1_M_symmetry = np.allclose(M, M.T, atol=1e-12, rtol=1e-12)\n    check2_K_skew_symmetry = np.allclose(K, -K.T, atol=1e-12, rtol=1e-12)\n    \n    # 2. Verify eigenvalues are purely imaginary\n    lambdas_A, _ = eig(K, M)\n    check3_imaginary_spectrum = np.all(np.abs(np.real(lambdas_A)) < 1e-9)\n    \n    # 3. Verify instantaneous energy production rate is zero\n    check4_energy_production = True\n    for _ in range(5):\n        u = rng.random(2 * N)\n        energy_prod_rate = u.T @ K @ u\n        if abs(energy_prod_rate) > 1e-9:\n            check4_energy_production = False\n            break\n            \n    result_A = all([check1_M_symmetry, check2_K_skew_symmetry, check3_imaginary_spectrum, check4_energy_production])\n\n    # --- Test Case B: Mass Lumping Spectral Shift ---\n    M_lump = np.diag(M.sum(axis=1))\n    \n    lambdas_consistent, _ = eig(K, M)\n    lambdas_lumped, _ = eig(K, M_lump)\n    \n    omega_consistent = np.abs(np.imag(lambdas_consistent))\n    omega_lumped = np.abs(np.imag(lambdas_lumped))\n    \n    # Filter out near-zero frequencies\n    freq_threshold = 1e-8\n    omega_consistent_nz = omega_consistent[omega_consistent > freq_threshold]\n    omega_lumped_nz = omega_lumped[omega_lumped > freq_threshold]\n    \n    # Sort frequencies to match modes by magnitude\n    omega_consistent_nz.sort()\n    omega_lumped_nz.sort()\n    \n    if len(omega_consistent_nz) == len(omega_lumped_nz) and len(omega_consistent_nz) > 0:\n        rel_devs = np.abs(omega_lumped_nz - omega_consistent_nz) / np.maximum(omega_consistent_nz, 1e-12)\n        result_B = np.max(rel_devs)\n    else:\n        # This case should not be reached for a valid problem setup\n        result_B = np.nan\n\n    # --- Test Case C: Dissipative System Verification ---\n    R_e = sigma * M_e\n    R = block_diag(R_e, np.zeros((N, N)))\n    K_loss = K - R\n    \n    # 1. Verify non-increasing energy condition\n    check5_non_increasing_energy = True\n    for _ in range(5):\n        u = rng.random(2 * N)\n        dissipation_rate = u.T @ K_loss @ u\n        # Check that energy does not increase (within numerical tolerance)\n        if dissipation_rate > 1e-10:\n            check5_non_increasing_energy = False\n            break\n\n    result_C = check5_non_increasing_energy\n    \n    # 2. Compute the maximum real part of the eigenvalues\n    lambdas_C, _ = eig(K_loss, M)\n    result_D = np.max(np.real(lambdas_C))\n    \n    # --- Final Output ---\n    final_results = [result_A, result_B, result_C, result_D]\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在处理具有复杂拓扑结构（例如，含有孔洞）的区域时，离散的微分算子往往会产生由“谐波场”构成的非平凡零空间，导致线性系统奇异。本练习将引导你应用离散霍奇分解这一强大工具，来精确识别并分离出这个由拓扑决定的零空间 。通过构建一个正交投影算子来移除谐波分量，你将学会如何设计一种高效的预条件子，从而将一个奇异问题转化为良态的可解问题。",
            "id": "3324090",
            "problem": "考虑一个在二维结构化网格上的计算电磁学离散设置，其中基于边的场近似电场，基于节点的标量近似电势。设边空间为一个有限维实向量空间，记为 $\\mathcal{E} = \\mathbb{R}^m$，节点空间为 $\\mathbb{R}^n$，面空间为 $\\mathbb{R}^f$。定义关联矩阵 $\\,\\mathbf{G} \\in \\mathbb{R}^{m \\times n}\\,$ 和 $\\,\\mathbf{C} \\in \\mathbb{R}^{f \\times m}\\,$，使得 $\\,\\mathbf{G}\\,$ 将基于节点的标量映射到基于边的梯度（离散梯度），而 $\\,\\mathbf{C}\\,$ 将基于边的场映射到基于面的环流（离散旋度）。对于此问题，使用欧几里得内积，因此离散散度算子为 $\\,\\mathbf{D} = \\mathbf{G}^\\top \\in \\mathbb{R}^{n \\times m}\\,$. 基本矢量微积分恒等式 $\\,\\nabla \\times \\nabla \\phi = \\mathbf{0}\\,$ 和 $\\,\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = 0\\,$ 的离散表示分别为 $\\,\\mathbf{C}\\mathbf{G} = \\mathbf{0}\\,$ 和 $\\,\\mathbf{D}\\mathbf{C}^\\top = \\mathbf{0}\\,$。在多连通几何中，边空间允许一个离散霍奇分解\n$$\n\\mathcal{E} = \\mathrm{range}(\\mathbf{G}) \\oplus \\mathrm{range}(\\mathbf{C}^\\top) \\oplus \\mathcal{H},\n$$\n其中调和子空间 $\\,\\mathcal{H}\\,$ 满足 $\\,\\mathcal{H} = \\ker(\\mathbf{C}) \\cap \\ker(\\mathbf{D})\\,$，其维度等于拓扑孔洞的数量（第一 Betti 数）。\n\n考虑对称半正定矩阵\n$$\n\\mathbf{A} = \\mathbf{C}^\\top \\mathbf{C} + \\gamma\\, \\mathbf{G}\\mathbf{G}^\\top \\in \\mathbb{R}^{m \\times m},\n$$\n其中 $\\,\\gamma > 0\\,$ 是一个实数参数。这个离散算子类似于作用在边场上的矢量拉普拉斯算子，其中 $\\,\\mathbf{C}^\\top \\mathbf{C}\\,$ 惩罚无散分量，而 $\\,\\gamma\\,\\mathbf{G}\\mathbf{G}^\\top\\,$ 惩罚余恰当分量。调和子空间 $\\,\\mathcal{H}\\,$ 位于 $\\,\\mathbf{A}\\,$ 的零空间中，因为对于所有 $\\,\\mathbf{h} \\in \\mathcal{H}\\,$，都有 $\\,\\mathbf{C}\\mathbf{h} = \\mathbf{0}\\,$ 和 $\\,\\mathbf{G}^\\top \\mathbf{h} = \\mathbf{0}\\,$。\n\n您的任务是设计一个预条件子，通过投影出 $\\,\\mathcal{H}\\,$ 来显式地移除调和子空间，并研究此投影对 $\\,\\mathbf{A}\\,$ 谱的影响。具体来说，您必须：\n\n- 为大小为 $\\,n_x \\times n_y\\,$ 个面的结构化网格构建 $\\,\\mathbf{G}\\,$ 和 $\\,\\mathbf{C}\\,$，该网格可能带有内部孔洞（特意移除的面），并使用一致的方向：边沿正坐标方向定向，面沿逆时针方向定向。令 $\\,\\mathbf{D} = \\mathbf{G}^\\top\\,$.\n- 通过找到分块矩阵\n$$\n\\mathbf{B} = \\begin{bmatrix} \\mathbf{C} \\\\ \\mathbf{D} \\end{bmatrix}.\n$$\n的零空间，为调和子空间 $\\,\\mathcal{H} = \\ker(\\mathbf{C}) \\cap \\ker(\\mathbf{D})\\,$ 计算一个标准正交基 $\\,\\mathbf{H}\\,$。\n- 构造到调和子空间上的正交投影算子 $\\,\\Pi_{\\mathcal{H}} = \\mathbf{H}\\mathbf{H}^\\top\\,$ 和移除调和分量的互补投影算子 $\\,\\mathbf{R} = \\mathbf{I}_m - \\Pi_{\\mathcal{H}}\\,$。\n- 通过计算 $\\,\\mathbf{A}\\,$ 的特征值以及 $\\,\\mathbf{A}\\,$ 在 $\\,\\mathrm{range}(\\mathbf{R})\\,$ 上的限制的特征值，来研究移除 $\\,\\mathcal{H}\\,$ 的谱效应。为获得受限谱，为 $\\,\\mathrm{range}(\\mathbf{R})\\,$ 构建一个标准正交基 $\\,\\mathbf{Q}\\,$，并计算 $\\,\\mathbf{Q}^\\top \\mathbf{A}\\mathbf{Q}\\,$ 的特征值。量化以下内容：\n  1. $\\,\\mathcal{H}\\,$ 的维度。\n  2. $\\,\\mathbf{A}\\,$ 的数值上为零的特征值数量（在容差范围内）。\n  3. $\\,\\mathbf{A}\\,$ 的最小正特征值。\n  4. 受限算子 $\\,\\mathbf{Q}^\\top \\mathbf{A}\\mathbf{Q}\\,$ 的最小特征值。\n  5. 受限算子的条件数，定义为最大特征值与最小特征值之比。\n  6. 一个验证离散霍奇分解维度恒等式的布尔值\n     $$ m = \\mathrm{rank}(\\mathbf{G}) + \\mathrm{rank}(\\mathbf{C}^\\top) + \\dim(\\mathcal{H}). $$\n\n使用以下几何形状和参数值的测试集，以覆盖不同的连通性方案：\n\n- 情况 1（单连通）：$\\,n_x = 2,\\, n_y = 2\\,$，无孔洞，$\\,\\gamma = 1.0\\,$.\n- 情况 2（一个孔洞）：$\\,n_x = 3,\\, n_y = 3\\,$，移除索引为 $\\, (i,j) = (1,1)\\,$ （从零开始的索引）的内部面，$\\,\\gamma = 1.0\\,$.\n- 情况 3（两个孔洞）：$\\,n_x = 4,\\, n_y = 4\\,$，移除索引为 $\\, (i,j) = (1,1)\\,$ 和 $\\, (2,2)\\,$ 的两个内部面，$\\,\\gamma = 1.0\\,$.\n\n您的程序必须为每种情况计算上面列出的量。角度不会出现，也不需要物理单位；将所有量视为无量纲。使用数值容差 $\\,10^{-10}\\,$ 来判断一个特征值是否数值上为零。\n\n最终输出规范：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身是一个列表，顺序如下\n$$\n[\\dim(\\mathcal{H}),\\ \\text{zero\\_count}(\\mathbf{A}),\\ \\lambda_{\\min}^+(\\mathbf{A}),\\ \\lambda_{\\min}(\\mathbf{Q}^\\top \\mathbf{A}\\mathbf{Q}),\\ \\kappa(\\mathbf{Q}^\\top \\mathbf{A}\\mathbf{Q}),\\ \\text{decomp\\_valid}],\n$$\n其中 $\\,\\lambda_{\\min}^+(\\mathbf{A})\\,$ 是 $\\,\\mathbf{A}\\,$ 的最小正特征值，$\\,\\kappa(\\cdot)\\,$ 是受限算子的条件数。例如，单行输出必须看起来像\n$$\n[[\\cdots],[\\cdots],[\\cdots]].\n$$",
            "solution": "用户提供的问题是有效的。其科学基础是离散外微分（或模拟有限差分）的原理在计算电磁学中的应用。所有术语在数学上都是良定义的，目标清晰且可量化，问题是自洽的。没有矛盾、歧义或伪科学论断。我们可以进行形式化的求解。\n\n核心任务是分析一个离散矢量拉普拉斯算子 $\\mathbf{A}$ 的谱特性，并理解其奇异性如何通过投影来移除，这种奇异性源于域的非平凡拓扑（孔洞）。调和子空间 $\\mathcal{H}$ 的维度等于孔洞的数量，它构成了 $\\mathbf{A}$ 的零空间。通过投影掉这个子空间，我们得到一个正定且因此可逆的受限算子，这是求解形如 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 的线性系统的关键步骤。\n\n我们的方法如下：\n1.  **离散化与算子构建**：我们在一个结构化网格上对二维域进行建模。基本实体是节点（0-胞腔）、边（1-胞腔）和面（2-胞腔）。我们为每种实体类型建立一个一致的行主序编号方案。\n    -   一个拥有 $n_y \\times n_x$ 个面的网格有 $(n_y+1) \\times (n_x+1)$ 个节点， $m_h = (n_y+1) n_x$ 条水平边，以及 $m_v = n_y (n_x+1)$ 条垂直边，总共有 $m = m_h + m_v$ 条边。\n    -   离散梯度算子 $\\mathbf{G} \\in \\mathbb{R}^{m \\times n}$ 被构造为将节点映射到边的关联矩阵。每一行对应一条边，在其头节点和尾节点对应的列上分别有 $+1$ 和 $-1$ 的条目，反映了电势差。\n    -   离散旋度算子 $\\mathbf{C} \\in \\mathbb{R}^{f \\times m}$ 被构造为将边映射到面的关联矩阵。每一行对应一个面，有四个非零条目 $(\\pm 1)$，表示其四条边界边上场的有向和（环流）。使用逆时针方向。\n    -   通过简单地从 $\\mathbf{C}$ 矩阵中省略相应的行来引入孔洞，从而减少总面数 $f$。\n    -   离散散度算子定义为梯度的转置，$\\mathbf{D} = \\mathbf{G}^\\top$。\n\n2.  **调和子空间基**：调和子空间 $\\mathcal{H}$ 由既无旋又无散的边场组成，即 $\\mathcal{H} = \\ker(\\mathbf{C}) \\cap \\ker(\\mathbf{D})$。我们通过计算组合矩阵 $\\mathbf{B} = \\begin{bmatrix} \\mathbf{C} \\\\ \\mathbf{D} \\end{bmatrix}$ 的零空间，来找到该子空间的一个标准正交基 $\\mathbf{H}$。$\\mathcal{H}$ 的维度，记为 $\\dim(\\mathcal{H})$，就是 $\\mathbf{H}$ 中基向量（列）的数量。这是要计算的第一个量。\n\n3.  **A 的谱分析**：算子 $\\mathbf{A} = \\mathbf{C}^\\top \\mathbf{C} + \\gamma\\, \\mathbf{G}\\mathbf{G}^\\top$ 是一个对称半正定矩阵。它的零空间恰好是调和子空间 $\\mathcal{H}$。我们使用一个标准的对称矩阵特征求解器来计算 $\\mathbf{A}$ 的特征值。\n    -   使用 $10^{-10}$ 的容差确定的数值零特征值数量，应等于 $\\dim(\\mathcal{H})$。这是第二个量。\n    -   最小严格正特征值 $\\lambda_{\\min}^+(\\mathbf{A})$，通过滤除零特征值并取剩余集合的最小值得到。这是第三个量。\n\n4.  **投影与受限算子**：为了移除零空间，我们定义一个正交投影算子 $\\mathbf{R} = \\mathbf{I}_m - \\mathbf{H}\\mathbf{H}^\\top$，其中 $\\mathbf{I}_m$ 是大小为 $m \\times m$ 的单位矩阵。该算子将边空间 $\\mathcal{E}$ 中的任何向量投影到 $\\mathcal{H}$ 的正交补上。$\\mathbf{R}$ 的值域是空间 $\\mathrm{range}(\\mathbf{G}) \\oplus \\mathrm{range}(\\mathbf{C}^\\top)$。\n    -   我们为 $\\mathbf{R}$ 的值域构造一个标准正交基 $\\mathbf{Q}$。一个鲁棒的数值方法是计算 $\\mathbf{R}$ 的奇异值分解（SVD），并取其值域空间的一个基。\n    -   然后将 $\\mathbf{A}$ 的作用限制在该子空间上，通过构造矩阵 $\\mathbf{Q}^\\top \\mathbf{A} \\mathbf{Q}$ 来实现。根据构造，这个受限算子是对称且正定的。\n    -   我们计算受限算子的特征值。其最小特征值 $\\lambda_{\\min}(\\mathbf{Q}^\\top\\mathbf{A}\\mathbf{Q})$ 理论上应等于 $\\lambda_{\\min}^+(\\mathbf{A})$。这是第四个量。\n    -   受限算子的条件数 $\\kappa(\\mathbf{Q}^\\top\\mathbf{A}\\mathbf{Q})$ 计算为其最大特征值与最小特征值之比。这是第五个量。\n\n5.  **分解验证**：作为最终的合理性检查，我们验证离散霍奇分解恒等式 $m = \\mathrm{rank}(\\mathbf{G}) + \\mathrm{rank}(\\mathbf{C}^\\top) + \\dim(\\mathcal{H})$。矩阵的秩是数值计算得出的。这个布尔结果是每个测试用例的第六个也是最后一个量。\n\n以下 Python 代码为指定的测试用例实现了此过程。",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import null_space\n\ndef solve():\n    \"\"\"\n    Computes spectral properties of a discrete vector Laplacian on 2D grids\n    with and without topological holes, demonstrating the effect of projecting\n    out the harmonic subspace.\n    \"\"\"\n\n    def _compute_case(nx, ny, holes, gamma, tol=1e-10):\n        \"\"\"\n        Performs all computations for a single test case configuration.\n        \n        Args:\n            nx (int): Number of faces in the x-direction.\n            ny (int): Number of faces in the y-direction.\n            holes (list): A list of (row, col) tuples for removed faces.\n            gamma (float): The penalty parameter for the gradient term.\n            tol (float): Numerical tolerance for zero-checking.\n\n        Returns:\n            list: A list containing the six required analysis quantities.\n        \"\"\"\n        # 1. Grid dimensions and numbering schemes\n        # We consistently use (row, col) indexing.\n        n_nodes_y, n_nodes_x = ny + 1, nx + 1\n        n_nodes = n_nodes_y * n_nodes_x\n        \n        num_h_edges = (ny + 1) * nx\n        num_v_edges = ny * (nx + 1)\n        m = num_h_edges + num_v_edges\n        \n        def node_idx(r, c):   return r * n_nodes_x + c\n        def hedge_idx(r, c):  return r * nx + c\n        def vedge_idx(r, c):  return num_h_edges + r * (nx + 1) + c\n\n        # 2. Construct G (discrete gradient) matrix\n        G = np.zeros((m, n_nodes))\n        for r in range(ny + 1):\n            for c in range(nx):\n                G[hedge_idx(r, c), node_idx(r, c)] = -1\n                G[hedge_idx(r, c), node_idx(r, c + 1)] = 1\n        for r in range(ny):\n            for c in range(nx + 1):\n                G[vedge_idx(r, c), node_idx(r, c)] = -1\n                G[vedge_idx(r, c), node_idx(r + 1, c)] = 1\n\n        # 3. Construct C (discrete curl) matrix, accounting for holes\n        face_map = { (r, c): i for i, (r, c) in enumerate(\n            (r, c) for r in range(ny) for c in range(nx) if (r, c) not in holes\n        )}\n        f = len(face_map)\n        C = np.zeros((f, m))\n        \n        for (r_face, c_face), row_idx in face_map.items():\n            C[row_idx, hedge_idx(r_face, c_face)] = 1      # bottom\n            C[row_idx, vedge_idx(r_face, c_face + 1)] = 1  # right\n            C[row_idx, hedge_idx(r_face + 1, c_face)] = -1 # top\n            C[row_idx, vedge_idx(r_face, c_face)] = -1     # left\n    \n        # 4. Construct B and find orthonormal basis H for the harmonic subspace\n        D = G.T\n        B = np.vstack([C, D]) if C.size > 0 else D\n        H = null_space(B, rcond=tol)\n        dim_H = H.shape[1]\n\n        # 5. Construct A and compute its spectrum\n        A = C.T @ C + gamma * G @ G.T\n        eivals_A = np.linalg.eigh(A)[0]\n        \n        is_zero = np.abs(eivals_A) < tol\n        eivals_A[is_zero] = 0.0\n        \n        zero_count_A = np.sum(is_zero)\n        pos_eivals_A = eivals_A[eivals_A > 0.0]\n        lambda_min_pos_A = np.min(pos_eivals_A) if pos_eivals_A.size > 0 else np.nan\n        \n        # 6. Project out the harmonic subspace and analyze the restricted operator\n        R = np.eye(m) - H @ H.T\n        \n        U, s, _ = np.linalg.svd(R)\n        rank_R = np.sum(s > tol)\n        Q = U[:, :rank_R]\n        \n        A_res = Q.T @ A @ Q\n        # The eigenvalues should be real due to symmetry\n        eivals_res = np.linalg.eigh(A_res)[0]\n        \n        lambda_min_res = np.min(eivals_res) if eivals_res.size > 0 else np.nan\n        lambda_max_res = np.max(eivals_res) if eivals_res.size > 0 else np.nan\n        \n        if lambda_min_res > tol:\n            kappa_res = lambda_max_res / lambda_min_res\n        elif eivals_res.size > 0:\n            kappa_res = np.inf\n        else: \n            kappa_res = np.nan\n\n        # 7. Verify Hodge decomposition dimension identity\n        rank_G = np.linalg.matrix_rank(G, tol=tol)\n        rank_C_T = np.linalg.matrix_rank(C.T, tol=tol)\n        decomp_valid = (m == rank_G + rank_C_T + dim_H)\n\n        # Return the 6 required quantities\n        return [dim_H, zero_count_A, lambda_min_pos_A, lambda_min_res, kappa_res, decomp_valid]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (nx, ny, holes, gamma)\n        (2, 2, [], 1.0),\n        # Case 2: Remove face at (row=1, col=1)\n        (3, 3, [(1, 1)], 1.0),\n        # Case 3: Remove faces at (row=1, col=1) and (row=2, col=2)\n        (4, 4, [(1, 1), (2, 2)], 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        nx, ny, holes, gamma = case\n        result = _compute_case(nx, ny, holes, gamma)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}