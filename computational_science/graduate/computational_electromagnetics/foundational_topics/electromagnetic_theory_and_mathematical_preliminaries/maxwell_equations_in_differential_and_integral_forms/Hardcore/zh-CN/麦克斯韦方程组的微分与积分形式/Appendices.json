{
    "hands_on_practices": [
        {
            "introduction": "这项实践将挑战你如何调和安培定律与电荷守恒，从而引出位移电流的概念。通过分析连接到电容器的导线周围的磁场，并使用两个不同的积分曲面，你将直面引导麦克斯韦完善其方程组并统一电磁学的经典佯谬。本练习旨在巩固 $\\partial\\mathbf{D}/\\partial t$ 项的物理意义和数学必要性。",
            "id": "3329572",
            "problem": "一根无限长、笔直的理想导电圆柱形导线沿自由空间中的 $z$ 轴放置，载有简谐电流 $I(t)=I_{0}\\exp(j \\omega t)$，其中 $I_{0}$ 是一个实正常数，$j$ 表示虚数单位，满足 $j^{2}=-1$。考虑一个半径为 $r$ 的闭合圆形路径 $C$，该路径以导线为中心且与导线共轴。您需要计算磁场强度沿该路径的环流，并检验当存在电容器时，计算结果对曲面选择的一致性。\n\n仅使用经典电磁学的基本定律，包括微分形式和积分形式的麦克斯韦方程组，以及标准的矢量微积分定理，完成以下任务：从第一性原理出发，推导在时刻 $t$ 的围线积分 $\\oint_{C}\\mathbf{H}\\cdot d\\mathbf{l}$ 的表达式。然后，考虑导线是串联电路的一部分，该电路在其他位置包含一个平行板电容器，其极板面积为 $A$，极板间距为 $d$，介电常数为 $\\varepsilon$。通过选择共享同一边界 $C$ 的两个不同开放曲面——一个与导线相交的平坦圆盘，另一个是凸起并穿过电容器间隙的曲面——从第一性原理出发，解释为什么 $\\oint_{C}\\mathbf{H}\\cdot d\\mathbf{l}$ 的值与所选曲面无关，并指出确保这种一致性的物理机制。\n\n您的最终结果必须是用 $I_{0}$、$\\omega$ 和 $t$ 表示的单个解析表达式。结果以安培为单位表示。在最终的方框表达式中不要包含单位。",
            "solution": "目标是确定磁场强度 $\\oint_{C}\\mathbf{H}\\cdot d\\mathbf{l}$ 围绕一条载有简谐电流的无限长直导线的圆形路径 $C$ 的环流，并解释当积分曲面穿过电容器时，位移电流在维持曲面无关性中的作用。\n\n合适的出发点是安培-麦克斯韦定律的积分形式，它是麦克斯韦方程组之一。对于任意以 $C=\\partial S$ 为边界的开放曲面 $S$，该积分定律表述为\n$$\n\\oint_{C}\\mathbf{H}\\cdot d\\mathbf{l}\n=\n\\iint_{S}\\left(\\mathbf{J}+\\frac{\\partial \\mathbf{D}}{\\partial t}\\right)\\cdot d\\mathbf{S},\n$$\n其中 $\\mathbf{J}$ 是自由（传导）电流密度，$\\mathbf{D}$ 是电通量密度。根据斯托克斯定理，上述积分形式等价于其微分形式\n$$\n\\nabla\\times \\mathbf{H}=\\mathbf{J}+\\frac{\\partial \\mathbf{D}}{\\partial t}.\n$$\n只要总电流密度 $\\mathbf{J}+\\partial \\mathbf{D}/\\partial t$ 是无散度的，该积分就只依赖于边界 $C$，而与张成该边界的曲面 $S$ 的选择无关：\n$$\n\\nabla\\cdot\\left(\\mathbf{J}+\\frac{\\partial \\mathbf{D}}{\\partial t}\\right)\n=\n\\nabla\\cdot \\mathbf{J}+\\frac{\\partial}{\\partial t}\\left(\\nabla\\cdot \\mathbf{D}\\right)\n=\n-\\frac{\\partial \\rho_{\\text{free}}}{\\partial t}+\\frac{\\partial \\rho_{\\text{free}}}{\\partial t}=0,\n$$\n这里我们使用了电荷连续性方程 $\\nabla\\cdot \\mathbf{J}=-\\partial \\rho_{\\text{free}}/\\partial t$ 和电场高斯定律 $\\nabla\\cdot \\mathbf{D}=\\rho_{\\text{free}}$。\n\n现在我们对共享同一圆形边界 $C$ 的两个不同曲面计算环流。\n\n情况1：$S_{1}$ 是一个平坦的圆盘，其平面与导线正交并与导线横截面相交。对于理想的完美导线，其内部电场为零，因此在导体内部 $\\partial \\mathbf{D}/\\partial t=\\mathbf{0}$。我们还选择 $S_{1}$ 局限于导线横截面的一个小邻域内，这样对曲面积分的唯一不可忽略的贡献来自穿过导线的传导电流。于是\n$$\n\\oint_{C}\\mathbf{H}\\cdot d\\mathbf{l}\n=\n\\iint_{S_{1}}\\mathbf{J}\\cdot d\\mathbf{S}\n=\nI(t)\n=\nI_{0}\\exp(j\\omega t).\n$$\n这个结果与半径 $r$ 无关，正如从对称性以及围绕直线电流丝的磁场 $\\mathbf{H}$ 按 $1/r$ 的切向衰减所预期的那样。\n\n为完整起见，可以利用对称性推断局部场如下。根据圆柱对称性，$\\mathbf{H}$ 场是方位角的，其大小仅取决于 $r$，即 $\\mathbf{H}(r,t)=\\hat{\\boldsymbol{\\phi}}\\,H_{\\phi}(r,t)$。那么，沿半径为 $r$ 的路径 $C$ 的线积分为\n$$\n\\oint_{C}\\mathbf{H}\\cdot d\\mathbf{l}\n=\nH_{\\phi}(r,t)\\,(2\\pi r)\n=\nI_{0}\\exp(j\\omega t),\n$$\n这意味着\n$$\nH_{\\phi}(r,t)=\\frac{I_{0}\\exp(j\\omega t)}{2\\pi r}.\n$$\n虽然题目没有要求这个局部场的表达式，但它与上面计算出的环流是一致的。\n\n情况2：$S_{2}$ 是一个凸起的曲面，它穿过与导线串联（位于电路其他地方）的平行板电容器的两极板之间，但仍然具有相同的闭合边界 $C$。在极板之间的间隙（一个电介质区域）中，没有自由（传导）电流穿过 $S_{2}$，所以\n$$\n\\iint_{S_{2}}\\mathbf{J}\\cdot d\\mathbf{S}=0.\n$$\n然而，通常存在一个非零的位移电流贡献，\n$$\n\\iint_{S_{2}}\\frac{\\partial \\mathbf{D}}{\\partial t}\\cdot d\\mathbf{S}\n=\n\\frac{\\partial}{\\partial t}\n\\left(\n\\iint_{S_{2}} \\mathbf{D}\\cdot d\\mathbf{S}\n\\right).\n$$\n为了将其与源电流联系起来，我们对一个包围电容器一个极板的“药丸盒”（其平坦表面与极板平行）应用积分形式的高斯定律。穿过电介质的电通量等于极板上的自由电荷：\n$$\n\\iint_{S_{\\text{gap}}} \\mathbf{D}\\cdot d\\mathbf{S}=Q_{\\text{free}}(t).\n$$\n对时间求导，并利用串联电路的电荷守恒，可得\n$$\n\\frac{\\partial}{\\partial t}\n\\left(\n\\iint_{S_{\\text{gap}}} \\mathbf{D}\\cdot d\\mathbf{S}\n\\right)\n=\n\\frac{d Q_{\\text{free}}(t)}{dt}\n=\nI(t)\n=\nI_{0}\\exp(j\\omega t).\n$$\n因此，对于曲面 $S_{2}$，\n$$\n\\oint_{C}\\mathbf{H}\\cdot d\\mathbf{l}\n=\n\\iint_{S_{2}}\\left(\\mathbf{J}+\\frac{\\partial \\mathbf{D}}{\\partial t}\\right)\\cdot d\\mathbf{S}\n=\n0\n+\nI_{0}\\exp(j\\omega t)\n=\nI_{0}\\exp(j\\omega t).\n$$\n这个结果与从 $S_{1}$ 得到的结果相匹配，证明了麦克斯韦方程组所要求的曲面无关性，并通过将位移电流确定为确保总电流 $\\mathbf{J}+\\partial \\mathbf{D}/\\partial t$ 连续性的物理机制，解决了表面上的悖论。\n\n作为一个对平行板电容器（极板面积为 $A$，间距为 $d$，介电常数为 $\\varepsilon$）的显式检验，其间隙中的场近似均匀且垂直于极板，有 $D_{n}(t)=\\varepsilon E_{n}(t)=\\varepsilon V(t)/d$。电通量为 $\\iint_{S_{\\text{gap}}}\\mathbf{D}\\cdot d\\mathbf{S}=\\varepsilon A\\,V(t)/d$，所以\n$$\n\\iint_{S_{2}}\\frac{\\partial \\mathbf{D}}{\\partial t}\\cdot d\\mathbf{S}\n=\n\\frac{\\varepsilon A}{d}\\,\\frac{d V(t)}{dt}.\n$$\n在串联电路中，流过电容器的电流满足 $I(t)=(\\varepsilon A/d)\\,dV(t)/dt$，从而为环流再现了相同的值 $I_{0}\\exp(j\\omega t)$。因此，无论张成的曲面是穿过导线还是穿过电容器间隙，我们都得到相同的环流：\n$$\n\\oint_{C}\\mathbf{H}\\cdot d\\mathbf{l}=I_{0}\\exp(j\\omega t).\n$$\n按照要求，此表达式以安培为单位，并且是与麦克斯韦方程组和电流连续性相符的唯一值。",
            "answer": "$$\\boxed{I_{0}\\,\\exp(j\\omega t)}$$"
        },
        {
            "introduction": "在构建高等电磁问题时，从场到势的转换是关键一步，但这需要选择一种规范。本问题探讨了选择库仑规范所带来的深远影响，在此规范下，标量势 $\\phi$ 由一个“瞬时”的超距作用定律决定。你将推导其控制方程，并分析这种选择如何决定了时域数值求解器的基本架构，即形成一个混合的椭圆-双曲型系统。",
            "id": "3329621",
            "problem": "考虑一个单连通有界区域 $\\Omega \\subset \\mathbb{R}^3$ 中，存在时变源，其电荷密度为 $\\rho(\\mathbf{x},t)$，电流密度为 $\\mathbf{J}(\\mathbf{x},t)$。该区域具有足够光滑的边界 $\\partial \\Omega$，并满足电荷连续性方程 $\\partial \\rho/\\partial t + \\nabla \\cdot \\mathbf{J} = 0$。电磁场在自由空间中遵循微分形式的 Maxwell 方程组：$\\nabla \\cdot \\mathbf{E} = \\rho/\\varepsilon_0$，$\\nabla \\cdot \\mathbf{B} = 0$，$\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$，$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\partial \\mathbf{E}/\\partial t$。通过 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 和 $\\mathbf{E} = -\\nabla \\phi - \\partial \\mathbf{A}/\\partial t$ 引入电磁势，并施加库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$。仅使用这些定义和控制定律，确定在库仑规范下 $\\phi(\\mathbf{x},t)$ 和 $\\mathbf{A}(\\mathbf{x},t)$ 满足的偏微分方程，并用精确的术语解释为什么在此规范下 $\\phi$ 被认为是“瞬时”的。然后，分析这种规范选择对计算电磁学中时域数值求解器的影响，包括待求解算子的性质以及出现的任何约束或投影。\n\n选择所有关于库仑规范结构及其计算影响的正确陈述：\n\nA. 从 $\\nabla \\cdot \\mathbf{E} = \\rho/\\varepsilon_0$ 和 $\\nabla \\cdot \\mathbf{A} = 0$ 出发，可以得到在每个时刻都有 $\\nabla^2 \\phi = -\\rho/\\varepsilon_0$，因此 $\\phi$ 由瞬时的 $\\rho$ 通过一个椭圆型方程求解确定；在数值上，这意味着可以在每个时间步通过一次标量椭圆型求解来计算 $\\phi$，而该求解独立于 $\\mathbf{A}$。\n\nB. 在库仑规范中，$\\phi$ 和 $\\mathbf{A}$ 都满足特征速度为 $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$ 的双曲波方程，从而允许完全显式的时间步进，无需任何全局椭圆型求解。\n\nC. 因为在库仑规范中 $\\phi$ 是“瞬时”的，物理电场对源变化的响应是超光速的，所以该规范与因果律相矛盾，在模拟中应避免使用。\n\nD. 一种实用的时域离散化方法，使用边元 (Nédélec 元) 表示 $\\mathbf{A}$，节点元表示 $\\phi$，通过将 $\\mathbf{J}$ 投影到其无散度分量上，并求解一个标量泊松问题以消除纵向分量，来强制实施 $\\nabla \\cdot \\mathbf{A} = 0$；等效地，也可以使用一个 Lagrange 乘子来强制实施该散度约束。\n\nE. 在一个理想导电边界上，对于时变问题，库仑规范允许独立地施加 $\\phi = 0$ 和 $\\mathbf{A}$ 的切向分量为零，而不会产生矛盾，因为该规范完全解耦了 $\\phi$ 和 $\\mathbf{A}$ 的边界条件。",
            "solution": "问题陈述是经典电动力学及其数值处理方面一个适定且科学严谨的练习。它要求在库仑规范下推导标量势 $\\phi$ 和矢量势 $\\mathbf{A}$ 的控制方程，并分析这种规范选择的影响。所有的前提，包括 Maxwell 方程组、势的定义以及连续性方程，都是标准且正确的。因此，我将进行推导和分析。\n\n首先，我们推导在库仑规范 $\\nabla \\cdot \\mathbf{A} = 0$ 下，标量势 $\\phi(\\mathbf{x}, t)$ 和矢量势 $\\mathbf{A}(\\mathbf{x}, t)$ 的偏微分方程 (PDE)。\n\n对于标量势 $\\phi$，我们从高斯定律 $\\nabla \\cdot \\mathbf{E} = \\rho/\\varepsilon_0$ 开始。我们代入电场用势表示的定义 $\\mathbf{E} = -\\nabla \\phi - \\partial \\mathbf{A}/\\partial t$：\n$$ \\nabla \\cdot \\left(-\\nabla \\phi - \\frac{\\partial \\mathbf{A}}{\\partial t}\\right) = \\frac{\\rho}{\\varepsilon_0} $$\n应用散度算子得到：\n$$ -\\nabla \\cdot (\\nabla \\phi) - \\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{A}) = \\frac{\\rho}{\\varepsilon_0} $$\n$$ -\\nabla^2 \\phi - \\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{A}) = \\frac{\\rho}{\\varepsilon_0} $$\n施加库仑规范条件 $\\nabla \\cdot \\mathbf{A} = 0$，第二项消失：\n$$ \\nabla^2 \\phi(\\mathbf{x}, t) = -\\frac{\\rho(\\mathbf{x}, t)}{\\varepsilon_0} $$\n这就是泊松方程。它是一个椭圆型偏微分方程。值得注意的特点是，该方程不包含 $\\phi$ 的时间导数。在任何时刻 $t$，$\\phi$ 的解由该*同一*时刻 $t$ 的全局电荷分布 $\\rho$ 决定。对于无界区域，解的形式由积分 $\\phi(\\mathbf{x}, t) = \\frac{1}{4\\pi\\varepsilon_0} \\int \\frac{\\rho(\\mathbf{x}', t)}{|\\mathbf{x} - \\mathbf{x}'|} d^3x'$ 给出，这使得 $\\phi$ 对 $\\rho$ 的“瞬时”依赖性变得明显。这种非局域和瞬时特性是此规范下势的一个特点，而不是物理场的特点。\n\n对于矢量势 $\\mathbf{A}$，我们从安培-麦克斯韦定律 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\partial \\mathbf{E}/\\partial t$ 开始。我们代入定义 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 和 $\\mathbf{E} = -\\nabla \\phi - \\partial \\mathbf{A}/\\partial t$：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{A}) = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\frac{\\partial}{\\partial t}\\left(-\\nabla \\phi - \\frac{\\partial \\mathbf{A}}{\\partial t}\\right) $$\n使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$：\n$$ \\nabla(\\nabla \\cdot \\mathbf A) - \\nabla^2 \\mathbf{A} = \\mu_0 \\mathbf{J} - \\mu_0 \\varepsilon_0 \\nabla\\left(\\frac{\\partial \\phi}{\\partial t}\\right) - \\mu_0 \\varepsilon_0 \\frac{\\partial^2 \\mathbf{A}}{\\partial t^2} $$\n施加库仑规范条件 $\\nabla \\cdot \\mathbf{A} = 0$，左边第一项消失。整理余下的项，我们得到：\n$$ \\nabla^2 \\mathbf{A} - \\mu_0 \\varepsilon_0 \\frac{\\partial^2 \\mathbf{A}}{\\partial t^2} = -\\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\nabla\\left(\\frac{\\partial \\phi}{\\partial t}\\right) $$\n使用 $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$，这就是非齐次矢量波动方程：\n$$ \\nabla^2 \\mathbf{A} - \\frac{1}{c^2} \\frac{\\partial^2 \\mathbf{A}}{\\partial t^2} = -\\mu_0 \\mathbf{J} + \\frac{1}{c^2} \\nabla\\left(\\frac{\\partial \\phi}{\\partial t}\\right) $$\n这是一个双曲型偏微分方程。因此，在库仑规范中，$(\\phi, \\mathbf{A})$ 的方程组是一个耦合系统，由一个关于 $\\phi$ 的椭圆型方程和一个关于 $\\mathbf{A}$ 的双曲型方程组成。耦合的发生是因为 $\\mathbf{A}$ 方程的源项依赖于 $\\phi$。\n\n在计算上，这种结构意味着一个混合的椭圆-双曲求解过程。在数值模拟的每个时间步，必须首先在整个空间域上求解关于 $\\phi$ 的椭圆型泊松方程，这在计算上是昂贵的，因为它需要求解一个大型稀疏线性系统。只有这样，才能使用 $\\phi$ 的结果（及其必须近似计算的时间导数）将关于 $\\mathbf{A}$ 的双曲波方程推进一个时间步。此外，数值误差可能导致 $\\nabla \\cdot \\mathbf{A}$ 偏离 $0$，因此必须主动强制实施散度约束，例如通过投影方法。\n\n现在，我将评估每个选项。\n\nA. **从 $\\nabla \\cdot \\mathbf{E} = \\rho/\\varepsilon_0$ 和 $\\nabla \\cdot \\mathbf{A} = 0$ 出发，可以得到在每个时刻都有 $\\nabla^2 \\phi = -\\rho/\\varepsilon_0$，因此 $\\phi$ 由瞬时的 $\\rho$ 通过一个椭圆型方程求解确定；在数值上，这意味着可以在每个时间步通过一次标量椭圆型求解来计算 $\\phi$，而该求解独立于 $\\mathbf{A}$。**\n该陈述是正确的。$\\nabla^2 \\phi = -\\rho/\\varepsilon_0$ 的推导如上所示。这个方程确实是一个椭圆型偏微分方程（泊松方程）。它的源项是 $\\rho(\\mathbf{x},t)$，这意味着 $\\phi$ 依赖于瞬时的电荷分布。关于 $\\phi$ 的方程不显式包含 $\\mathbf{A}$，因此在每个时间步，可以先求解关于 $\\phi$ 的椭圆型问题，而这独立于该时间步的 $\\mathbf{A}$ 值。提及静电学是为了强调该方程的形式，它与静态问题中求解的方程相同。\n结论：**正确**。\n\nB. **在库仑规范中，$\\phi$ 和 $\\mathbf{A}$ 都满足特征速度为 $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$ 的双曲波方程，从而允许完全显式的时间步进，无需任何全局椭圆型求解。**\n该陈述是错误的。如推导所示，$\\phi$ 满足的是椭圆型泊松方程 $\\nabla^2 \\phi = -\\rho/\\varepsilon_0$，而不是双曲波方程。这个椭圆型方程的存在使得在每个时间步都需要进行全局求解，这是一个隐式操作，排除了对整个系统使用“完全显式”时间步进格式的可能性。该选项错误地描述了 $\\phi$ 方程的数学性质。是洛伦兹规范，而非库仑规范，会导致两个势都满足双曲波方程。\n结论：**错误**。\n\nC. **因为在库仑规范中 $\\phi$ 是“瞬时”的，物理电场对源变化的响应是超光速的，所以该规范与因果律相矛盾，在模拟中应避免使用。**\n该陈述是错误的。虽然在库仑规范中标量势 $\\phi$ 确实表现出瞬时传播，但 $\\phi$ 并非直接的物理可观测量。物理场是 $\\mathbf{E} = -\\nabla \\phi - \\partial \\mathbf{A}/\\partial t$。来自 $-\\nabla \\phi$ 的 $\\mathbf{E}$ 的“瞬时”部分恰好被场 $-\\partial \\mathbf{A}/\\partial t$ 的相应部分抵消，后者也包含一个非局域分量。总的物理场 $\\mathbf{E}$（以及 $\\mathbf{B}$）是因果传播的，即以等于或低于光速 $c$ 的速度传播。库仑规范是一种物理上有效且被广泛使用的规范选择。其计算上的缺点并非源于对因果律的违反。\n结论：**错误**。\n\nD. **一种实用的时域离散化方法，使用边元 (Nédélec 元) 表示 $\\mathbf{A}$，节点元表示 $\\phi$，通过将 $\\mathbf{J}$ 投影到其无散度分量上，并求解一个标量泊松问题以消除纵向分量，来强制实施 $\\nabla \\cdot \\mathbf{A} = 0$；等效地，也可以使用一个 Lagrange 乘子来强制实施该散度约束。**\n该陈述是正确的。它准确地描述了计算电磁学中的现代数值技术，特别是在有限元法 (FEM) 框架下的技术。\n1.  使用边元 (Nédélec 元) 表示 $\\mathbf{A}$，节点元 (Lagrange 元) 表示 $\\phi$ 是标准的混合元配对，它尊重 Maxwell 方程组的微分几何结构，并提供稳定的离散化。\n2.  $\\mathbf{A}$ 的波动方程由横向（无散度）电流 $\\mathbf{J}_T$ 驱动。为了从 $\\mathbf{J}$ 中获得 $\\mathbf{J}_T$，需要进行亥姆霍兹分解（$\\mathbf{J} = \\mathbf{J}_T + \\mathbf{J}_L$），这是一种投影。\n3.  求解关于 $\\phi$ 的泊松问题是必要的，以确定电场的纵向部分，该部分与纵向电流 $\\mathbf{J}_L$ 相关。\n4.  在偏微分方程系统中使用 Lagrange 乘子是强制实施诸如 $\\nabla \\cdot \\mathbf{A} = 0$ 等约束的一种标准且等效的变分技术。Lagrange 乘子场在数学上与 $\\phi$ 相关。\n该陈述正确地总结了实施库仑规范的数值策略。\n结论：**正确**。\n\nE. **在一个理想导电边界上，对于时变问题，库仑规范允许独立地施加 $\\phi = 0$ 和 $\\mathbf{A}$ 的切向分量为零，而不会产生矛盾，因为该规范完全解耦了 $\\phi$ 和 $\\mathbf{A}$ 的边界条件。**\n该陈述是错误的。在理想导体上，电场的切向分量必须为零：$\\mathbf{n} \\times \\mathbf{E} = \\mathbf{0}$。代入 $\\mathbf{E} = -\\nabla \\phi - \\partial \\mathbf{A}/\\partial t$，我们得到 $\\mathbf{n} \\times (-\\nabla \\phi - \\partial \\mathbf{A}/\\partial t) = \\mathbf{0}$，或 $\\mathbf{n} \\times \\nabla \\phi = -\\mathbf{n} \\times (\\partial \\mathbf{A}/\\partial t)$。这个方程在 $\\phi$ 和 $\\mathbf{A}$ 的边界行为之间建立了直接联系。例如，如果选择在边界上设置 $\\phi$ 为常数（例如 $\\phi=0$），那么 $\\mathbf{n} \\times \\nabla \\phi = \\mathbf{0}$，这将迫使 $\\mathbf{n} \\times (\\partial \\mathbf{A}/\\partial t) = \\mathbf{0}$。这意味着边界上 $\\mathbf{A}$ 的切向分量只能改变一个不随时间变化的矢量场。$\\phi$ 和 $\\mathbf{A}$ 的边界条件不是独立的；它们通过 $\\mathbf{E}$ 的物理边界条件耦合在一起。\n结论：**错误**。",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "本练习通过推导时域有限差分（FDTD）方法的基本算法，将麦克斯韦积分方程直接带入计算领域。通过将法拉第定律和安培定律应用于离散的Yee元胞，你将推导出FDTD的更新方程，并通过求解数值色散关系来分析其精度。这项练习让你从第一性原理出发，理解离散化如何引入数值赝像（例如人工双折射），而这在实际仿真中是至关重要的评估环节。",
            "id": "3329563",
            "problem": "考虑一个用于均匀、无源、单轴各向异性电介质中电磁波的二维时域有限差分 (FDTD) 方案，该方案建立在均匀 Yee 晶格上。光轴与 $z$ 轴对齐。介电常数张量为 $\\boldsymbol{\\varepsilon}=\\mathrm{diag}(\\varepsilon_{\\perp},\\varepsilon_{\\perp},\\varepsilon_{\\parallel})$，磁导率为各向同性的 $\\mu=\\mu_{0}$。Yee 网格间距在 $x$ 和 $y$ 方向上分别为 $\\Delta x$ 和 $\\Delta y$（单位：米）。时间步长为 $\\Delta t$（单位：秒）。假设电导率为零且无自由电荷。\n\n从麦克斯韦方程组的积分形式出发：\n$$\\oint_{\\partial S} \\mathbf{E}\\cdot d\\boldsymbol{\\ell} = -\\frac{d}{dt}\\int_{S}\\mathbf{B}\\cdot \\mathbf{\\hat{n}}\\, dS,$$\n$$\\oint_{\\partial S} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} = \\frac{d}{dt}\\int_{S}\\mathbf{D}\\cdot \\mathbf{\\hat{n}}\\, dS,$$\n将这些定律应用于一个矩形 Yee 元胞环路及相关的交错对偶环路/体积，以推导二维情况下两种解耦偏振的离散更新方程：\n- 横电 (TE) 模，其中 $E_{z}$ 非零，$H_{x},H_{y}$ 非零，由 $\\varepsilon_{zz}=\\varepsilon_{\\parallel}$ 控制本构关系 $D_{z}=\\varepsilon_{\\parallel} E_{z}$。\n- 横磁 (TM) 模，其中 $H_{z}$ 非零，$E_{x},E_{y}$ 非零，由 $\\varepsilon_{xx}=\\varepsilon_{yy}=\\varepsilon_{\\perp}$ 控制 $D_{x}=\\varepsilon_{\\perp} E_{x}$ 和 $D_{y}=\\varepsilon_{\\perp} E_{y}$。\n\n引入与离散交错一致的离散平面波拟设，其空间频率分量为 $k_{x}$ 和 $k_{y}$（单位：米分之一），角频率为 $\\omega$（单位：弧度每秒），并获得 TE 和 TM 偏振的数值色散关系。然后，从均匀、无源介质的微分形式麦克斯韦方程组中，获得相同介质中的连续平面波色散关系。\n\n将数值双折射度量定义为 TE 和 TM 模式的归一化离散相速度之差：\n$$\\mathrm{NB} = \\frac{v_{\\mathrm{TE,num}}}{v_{\\mathrm{TE,cont}}} - \\frac{v_{\\mathrm{TM,num}}}{v_{\\mathrm{TM,cont}}},$$\n其中 $v_{\\mathrm{TE,num}}=\\omega_{\\mathrm{TE}}/|\\mathbf{k}|$ 和 $v_{\\mathrm{TM,num}}=\\omega_{\\mathrm{TM}}/|\\mathbf{k}|$ 是从 FDTD 色散关系得到的离散相速度，$|\\mathbf{k}|=\\sqrt{k_{x}^{2}+k_{y}^{2}}$（单位：米分之一），而 $v_{\\mathrm{TE,cont}}$ 和 $v_{\\mathrm{TM,cont}}$ 是从各向异性介质的解析色散得到的相应连续相速度。度量 $\\mathrm{NB}$ 是无量纲的。\n\n您的程序必须实现这些推导，以计算指定测试套件的 $\\mathrm{NB}$。使用 Courant 稳定性因子 $s_{\\mathrm{CFL}}=0.90$，并将时间步长设置为\n$$\\Delta t=\\frac{s_{\\mathrm{CFL}}}{c_{\\max}\\,\\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^{2}+\\left(\\frac{1}{\\Delta y}\\right)^{2}}},$$\n其中 $c_{\\max}=\\max\\left(\\frac{1}{\\sqrt{\\mu_{0}\\varepsilon_{\\perp}}},\\frac{1}{\\sqrt{\\mu_{0}\\varepsilon_{\\parallel}}}\\right)$ 是介质中的最大相速度。\n\n角度必须以弧度为单位指定。所有长度必须以米表示，时间以秒表示，介电常数以法拉每米表示，磁导率以亨利每米表示，波数以米分之一表示。\n\n为以下四个测试用例实现计算，每个用例以元组 $(\\Delta x,\\Delta y,\\varepsilon_{\\perp},\\varepsilon_{\\parallel},|\\mathbf{k}|,\\theta,s_{\\mathrm{CFL}})$ 的形式提供，其中 $\\theta$ 是 $\\mathbf{k}$ 相对于 $x$ 轴的传播角：\n- 用例 1（常规成功路径）：($\\Delta x=1.0\\times 10^{-2}$, $\\Delta y=1.0\\times 10^{-2}$, $\\varepsilon_{\\perp}=2\\varepsilon_{0}$, $\\varepsilon_{\\parallel}=3\\varepsilon_{0}$, $|\\mathbf{k}|=200$, $\\theta=\\pi/4$, $s_{\\mathrm{CFL}}=0.90$)。\n- 用例 2（近奈奎斯特边界）：($\\Delta x=1.0\\times 10^{-2}$, $\\Delta y=1.0\\times 10^{-2}$, $\\varepsilon_{\\perp}=2\\varepsilon_{0}$, $\\varepsilon_{\\parallel}=3\\varepsilon_{0}$, $|\\mathbf{k}|=0.95\\pi/\\Delta x$, $\\theta=0$, $s_{\\mathrm{CFL}}=0.90$)。\n- 用例 3（各向同性边缘情况）：($\\Delta x=1.0\\times 10^{-2}$, $\\Delta y=1.0\\times 10^{-2}$, $\\varepsilon_{\\perp}=2.5\\varepsilon_{0}$, $\\varepsilon_{\\parallel}=2.5\\varepsilon_{0}$, $|\\mathbf{k}|=150$, $\\theta=\\pi/3$, $s_{\\mathrm{CFL}}=0.90$)。\n- 用例 4（弱各向异性）：($\\Delta x=1.0\\times 10^{-2}$, $\\Delta y=1.0\\times 10^{-2}$, $\\varepsilon_{\\perp}=2.0\\varepsilon_{0}$, $\\varepsilon_{\\parallel}=2.1\\varepsilon_{0}$, $|\\mathbf{k}|=250$, $\\theta=\\pi/6$, $s_{\\mathrm{CFL}}=0.90$)。\n\n对于每个用例，计算 $k_{x}=|\\mathbf{k}|\\cos\\theta$ 和 $k_{y}=|\\mathbf{k}|\\sin\\theta$，然后使用离散 FDTD 色散和连续平面波色散计算 $\\mathrm{NB}$。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，$\\left[\\,\\mathrm{NB}_{1},\\mathrm{NB}_{2},\\mathrm{NB}_{3},\\mathrm{NB}_{4}\\,\\right]$）。输出必须是无单位的实值浮点数。",
            "solution": "该问题要求在单轴各向异性介质中，针对二维 ($2$D) 时域有限差分 (FDTD) 方案，推导数值色散关系，并计算数值双折射度量。推导必须从麦克斯韦方程组的积分形式开始。\n\n该问题具有科学依据、适定，并提供了所有必要的参数。它代表了计算电磁学中的一项标准任务。因此，我们可以进行完整求解。\n\n其基本物理定律是麦克斯韦方程组。对于无源、非导电介质，其积分形式是法拉第电磁感应定律和安培定律：\n$$ \\oint_{\\partial S} \\mathbf{E}\\cdot d\\boldsymbol{\\ell} = -\\frac{d}{dt}\\int_{S}\\mathbf{B}\\cdot \\mathbf{\\hat{n}}\\, dS $$\n$$ \\oint_{\\partial S} \\mathbf{H}\\cdot d\\boldsymbol{\\ell} = \\frac{d}{dt}\\int_{S}\\mathbf{D}\\cdot \\mathbf{\\hat{n}}\\, dS $$\n在光轴沿 $z$ 轴的单轴介质中，本构关系为 $\\mathbf{D} = \\boldsymbol{\\varepsilon}\\mathbf{E}$ 和 $\\mathbf{B} = \\mu_0\\mathbf{H}$，其中 $\\boldsymbol{\\varepsilon}=\\mathrm{diag}(\\varepsilon_{\\perp},\\varepsilon_{\\perp},\\varepsilon_{\\parallel})$ 且 $\\mu = \\mu_0$。\n\n我们使用标准的 Yee 网格，其中场分量在空间和时间上交错排列。对于 $x-y$ 平面内的二维问题，我们假设所有场都与 $z$ 无关（即 $\\partial/\\partial z = 0$）。位于位置 $(x,y)=(i\\Delta x, j\\Delta y)$ 和时间 $t=n\\Delta t$ 的场分量 $F$ 表示为 $F^n_{i,j}$。\n\n### 第 1 部分：FDTD 更新方程的推导\n\n**横电 (TE) 模**\n非零场分量为 $E_z$、$H_x$ 和 $H_y$。相关的本构关系是 $D_z = \\varepsilon_\\parallel E_z$。场的交错方式如下：\n- $E_z$ 位于 $(i\\Delta x, j\\Delta y)$，时间为 $n\\Delta t$。\n- $H_x$ 位于 $(i\\Delta x, (j+1/2)\\Delta y)$，时间为 $(n+1/2)\\Delta t$。\n- $H_y$ 位于 $((i+1/2)\\Delta x, j\\Delta y)$，时间为 $(n+1/2)\\Delta t$。\n\n**$E_z$ 的更新**：我们将安培定律应用于 $x-y$ 平面中一个面积为 $\\Delta x \\Delta y$、中心在 $(i\\Delta x, j\\Delta y)$ 的矩形环路。\n右侧 (RHS) 变为：\n$$ \\frac{d}{dt}\\int_{S}\\mathbf{D}\\cdot \\mathbf{\\hat{n}}\\, dS \\approx \\frac{dD_z}{dt}\\bigg|_{i,j} \\Delta x \\Delta y = \\varepsilon_\\parallel \\frac{\\partial E_z}{\\partial t}\\bigg|_{i,j} \\Delta x \\Delta y $$\n左侧 (LHS) 是 $\\mathbf{H}$ 绕环路的线积分。用环路段上的场值近似该积分可得：\n$$ \\oint \\mathbf{H}\\cdot d\\boldsymbol{\\ell} \\approx H_y\\big|_{i+1/2,j}\\Delta x - H_y\\big|_{i-1/2,j}\\Delta x - H_x\\big|_{i,j+1/2}\\Delta y + H_x\\big|_{i,j-1/2}\\Delta y $$\n令两侧相等，并使用中心差分对时间导数进行离散化：\n$$ \\varepsilon_\\parallel \\frac{E^{n+1}_{z,i,j} - E^n_{z,i,j}}{\\Delta t} = \\frac{H^{n+1/2}_{y,i+1/2,j} - H^{n+1/2}_{y,i-1/2,j}}{\\Delta x} - \\frac{H^{n+1/2}_{x,i,j+1/2} - H^{n+1/2}_{x,i,j-1/2}}{\\Delta y} $$\n\n**$H_x$ 的更新**：我们将法拉第定律应用于 $y-z$ 平面中一个面积为 $\\Delta y \\Delta z_{u}$（其中 $\\Delta z_u$ 是不变方向上的单位长度）、中心在 $(i\\Delta x, (j+1/2)\\Delta y)$ 的矩形环路。表面法线为 $\\hat{x}$。\nRHS: $-\\frac{d}{dt}\\int_{S}\\mathbf{B}\\cdot \\mathbf{\\hat{n}}\\, dS \\approx -\\frac{dB_x}{dt}\\big|_{i, j+1/2} \\Delta y \\Delta z_u = -\\mu_0 \\frac{\\partial H_x}{\\partial t}\\big|_{i, j+1/2} \\Delta y \\Delta z_u$\nLHS: 唯一非零的电场是 $E_z$。该积分仅在环路沿 $z$ 方向的段上非零：\n$$ \\oint \\mathbf{E}\\cdot d\\boldsymbol{\\ell} = E_z\\big|_{i,j+1} \\Delta z_u - E_z\\big|_{i,j} \\Delta z_u $$\n令等式成立，$\\Delta z_u$ 项消去，我们对时间进行离散化：\n$$ -\\mu_0 \\frac{H^{n+1/2}_{x,i,j+1/2} - H^{n-1/2}_{x,i,j+1/2}}{\\Delta t} \\Delta y = E^n_{z,i,j+1} - E^n_{z,i,j} $$\n\n**$H_y$ 的更新**：类似地，对于一个在 $x-z$ 平面内、中心位于 $((i+1/2)\\Delta x, j\\Delta y)$ 的环路：\n$$ -\\mu_0 \\frac{H^{n+1/2}_{y,i+1/2,j} - H^{n-1/2}_{y,i+1/2,j}}{\\Delta t} \\Delta x = E^n_{z,i,j} - E^n_{z,i+1,j} $$\n\n**横磁 (TM) 模**\n非零场分量为 $H_z$、$E_x$ 和 $E_y$。本构关系为 $D_x = \\varepsilon_\\perp E_x$ 和 $D_y = \\varepsilon_\\perp E_y$。场的交错方式为：\n- $H_z$ 位于 $((i+1/2)\\Delta x, (j+1/2)\\Delta y)$，时间为 $(n+1/2)\\Delta t$。\n- $E_x$ 位于 $((i+1/2)\\Delta x, j\\Delta y)$，时间为 $n\\Delta t$。\n- $E_y$ 位于 $(i\\Delta x, (j+1/2)\\Delta y)$，时间为 $n\\Delta t$。\n推导过程与 TE 情况类似，只需交换 $\\mathbf{E}$ 和 $\\mathbf{H}$ 的角色并使用适当的常数（$\\mu_0 \\leftrightarrow \\varepsilon_\\perp$）。为简洁起见，我们直接给出离散化的微分方程：\n$$ \\frac{E^{n+1}_{x,i+1/2,j} - E^n_{x,i+1/2,j}}{\\Delta t} = \\frac{1}{\\varepsilon_\\perp} \\frac{H^{n+1/2}_{z,i+1/2,j+1/2} - H^{n+1/2}_{z,i+1/2,j-1/2}}{\\Delta y} $$\n$$ \\frac{E^{n+1}_{y,i,j+1/2} - E^n_{y,i,j+1/2}}{\\Delta t} = -\\frac{1}{\\varepsilon_\\perp} \\frac{H^{n+1/2}_{z,i+1/2,j+1/2} - H^{n+1/2}_{z,i-1/2,j+1/2}}{\\Delta x} $$\n$$ \\frac{H^{n+1/2}_{z,i+1/2,j+1/2} - H^{n-1/2}_{z,i+1/2,j+1/2}}{\\Delta t} = -\\frac{1}{\\mu_0}\\left( \\frac{E^n_{y,i+1,j+1/2} - E^n_{y,i,j+1/2}}{\\Delta x} - \\frac{E^n_{x,i+1/2,j+1} - E^n_{x,i+1/2,j}}{\\Delta y} \\right) $$\n\n### 第 2 部分：数值色散关系\n\n我们将形式为 $F(\\mathbf{r},t) = F_0 \\exp[i(\\omega t - \\mathbf{k}\\cdot\\mathbf{r})]$ 的离散平面波拟设代入更新方程，并考虑场的交错。这将有限差分算子转换为乘法因子：\n$$ \\frac{F^{n+1} - F^n}{\\Delta t} \\rightarrow i\\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right)F^{n+1/2} $$\n$$ \\frac{F_{i+1} - F_i}{\\Delta x} \\rightarrow -i\\frac{2}{\\Delta x}\\sin\\left(\\frac{k_x\\Delta x}{2}\\right)F_{i+1/2} $$\n将这些变换应用于方程组并消去场变量，即可得到数值色散关系。\n\n对于 **TE 模**，组合三个更新方程可得：\n$$ \\left( \\frac{1}{\\Delta t} \\sin\\left(\\frac{\\omega_{TE} \\Delta t}{2}\\right) \\right)^2 = \\frac{1}{\\mu_0 \\varepsilon_\\parallel} \\left[ \\left(\\frac{\\sin(k_x \\Delta x/2)}{\\Delta x}\\right)^2 + \\left(\\frac{\\sin(k_y \\Delta y/2)}{\\Delta y}\\right)^2 \\right] $$\n这给出了作为 $k_x$ 和 $k_y$ 函数的 $\\omega_{TE,num}$。\n\n对于 **TM 模**，同样的过程得到一个类似的关系式，只是 $\\varepsilon_\\parallel$ 被 $\\varepsilon_\\perp$ 替换：\n$$ \\left( \\frac{1}{\\Delta t} \\sin\\left(\\frac{\\omega_{TM} \\Delta t}{2}\\right) \\right)^2 = \\frac{1}{\\mu_0 \\varepsilon_\\perp} \\left[ \\left(\\frac{\\sin(k_x \\Delta x/2)}{\\Delta x}\\right)^2 + \\left(\\frac{\\sin(k_y \\Delta y/2)}{\\Delta y}\\right)^2 \\right] $$\n这给出了作为 $k_x$ 和 $k_y$ 函数的 $\\omega_{TM,num}$。\n\n### 第 3 部分：连续色散关系\n\n我们从时谐微分（旋度）形式的麦克斯韦方程组开始，$\\nabla \\times \\mathbf{E} = -i\\omega\\mu_0\\mathbf{H}$ 和 $\\nabla \\times \\mathbf{H} = i\\omega\\boldsymbol{\\varepsilon}\\mathbf{E}$。代入连续平面波解 $\\mathbf{E}(\\mathbf{r}) = \\mathbf{E}_0 e^{-i\\mathbf{k}\\cdot\\mathbf{r}}$（因此 $\\nabla \\to -i\\mathbf{k}$）可得到波动方程 $\\mathbf{k}\\times(\\mathbf{k}\\times\\mathbf{E}) = -\\omega^2\\mu_0\\boldsymbol{\\varepsilon}\\mathbf{E}$。\n\n对于 **TE 模**，$\\mathbf{E}=(0,0,E_z)$ 且 $\\mathbf{k}=(k_x, k_y, 0)$。波动方程简化为：\n$$ -|\\mathbf{k}|^2 E_z = -\\omega^2\\mu_0\\varepsilon_\\parallel E_z \\implies |\\mathbf{k}|^2 = \\omega^2\\mu_0\\varepsilon_\\parallel $$\n连续色散关系为 $\\omega_{\\mathrm{TE,cont}} = \\frac{|\\mathbf{k}|}{\\sqrt{\\mu_0\\varepsilon_\\parallel}} = |\\mathbf{k}| c_\\parallel$，其中 $c_\\parallel = 1/\\sqrt{\\mu_0\\varepsilon_\\parallel}$。\n\n对于 **TM 模**，$\\mathbf{H}=(0,0,H_z)$，所以 $\\mathbf{E}=(E_x,E_y,0)$。对于 $x-y$ 平面内的场，介质是各向同性的（$D_x=\\varepsilon_\\perp E_x$, $D_y=\\varepsilon_\\perp E_y$）。类似的推导得出：\n$$ |\\mathbf{k}|^2 = \\omega^2\\mu_0\\varepsilon_\\perp $$\n连续色散关系为 $\\omega_{\\mathrm{TM,cont}} = \\frac{|\\mathbf{k}|}{\\sqrt{\\mu_0\\varepsilon_\\perp}} = |\\mathbf{k}| c_\\perp$，其中 $c_\\perp = 1/\\sqrt{\\mu_0\\varepsilon_\\perp}$。\n\n### 第 4 部分：数值双折射计算\n\n数值双折射度量定义为：\n$$ \\mathrm{NB} = \\frac{v_{\\mathrm{TE,num}}}{v_{\\mathrm{TE,cont}}} - \\frac{v_{\\mathrm{TM,num}}}{v_{\\mathrm{TM,cont}}} $$\n由于相速度 $v = \\omega/|\\mathbf{k}|$，该度量简化为频率之比：\n$$ \\mathrm{NB} = \\frac{\\omega_{\\mathrm{TE,num}}}{\\omega_{\\mathrm{TE,cont}}} - \\frac{\\omega_{\\mathrm{TM,num}}}{\\omega_{\\mathrm{TM,cont}}} $$\n对于给定的一组参数 $(\\Delta x, \\Delta y, \\varepsilon_\\perp, \\varepsilon_\\parallel, |\\mathbf{k}|, \\theta, s_{CFL})$，我们首先计算波矢分量 $k_x=|\\mathbf{k}|\\cos\\theta$ 和 $k_y=|\\mathbf{k}|\\sin\\theta$。\n时间步长为 $\\Delta t = s_{\\mathrm{CFL}} / (c_{\\max} \\sqrt{(1/\\Delta x)^2 + (1/\\Delta y)^2})$，其中 $c_{\\max} = \\max(c_\\perp, c_\\parallel)$。\n然后我们求解数值色散关系，得到 $\\omega_{\\mathrm{TE,num}}$ 和 $\\omega_{\\mathrm{TM,num}}$：\n$$ \\omega_{\\mathrm{TE,num}} = \\frac{2}{\\Delta t} \\arcsin\\left( c_\\parallel \\Delta t \\sqrt{ \\left(\\frac{\\sin(k_x \\Delta x/2)}{\\Delta x}\\right)^2 + \\left(\\frac{\\sin(k_y \\Delta y/2)}{\\Delta y}\\right)^2 } \\right) $$\n$$ \\omega_{\\mathrm{TM,num}} = \\frac{2}{\\Delta t} \\arcsin\\left( c_\\perp \\Delta t \\sqrt{ \\left(\\frac{\\sin(k_x \\Delta x/2)}{\\Delta x}\\right)^2 + \\left(\\frac{\\sin(k_y \\Delta y/2)}{\\Delta y}\\right)^2 } \\right) $$\n连续频率是直接计算的。最后，我们计算 $\\mathrm{NB}$。$\\arcsin$ 函数的自变量保证小于或等于 $s_{CFL}$（本例中为 $0.9$），从而确保结果为实值。\n对于各向同性情况（$\\varepsilon_\\perp = \\varepsilon_\\parallel$），我们有 $c_\\perp = c_\\parallel$，这导致 $\\omega_{TE,num}=\\omega_{TM,num}$ 和 $\\omega_{TE,cont}=\\omega_{TM,cont}$。因此，$\\mathrm{NB}$ 必须恰好为零。\n以下程序为提供的测试用例实现了此计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import mu_0, epsilon_0\n\ndef solve():\n    \"\"\"\n    Computes the numerical birefringence (NB) for a 2D FDTD scheme\n    in a uniaxial anisotropic medium for a series of test cases.\n    \"\"\"\n\n    # Test cases: (dx, dy, eps_perp_rel, eps_par_rel, k_mag, theta_rad, s_cfl)\n    test_cases = [\n        # Case 1 (general happy path)\n        (1.0e-2, 1.0e-2, 2.0, 3.0, 200.0, np.pi/4, 0.90),\n        # Case 2 (near-Nyquist boundary)\n        (1.0e-2, 1.0e-2, 2.0, 3.0, 0.95 * np.pi / 1.0e-2, 0.0, 0.90),\n        # Case 3 (isotropic edge case)\n        (1.0e-2, 1.0e-2, 2.5, 2.5, 150.0, np.pi/3, 0.90),\n        # Case 4 (weak anisotropy)\n        (1.0e-2, 1.0e-2, 2.0, 2.1, 250.0, np.pi/6, 0.90),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        dx, dy, eps_perp_rel, eps_par_rel, k_mag, theta, s_cfl = case\n\n        # Absolute permittivities\n        eps_perp = eps_perp_rel * epsilon_0\n        eps_par = eps_par_rel * epsilon_0\n\n        # Phase velocities in the continuous medium\n        c_perp = 1.0 / np.sqrt(mu_0 * eps_perp)\n        c_par = 1.0 / np.sqrt(mu_0 * eps_par)\n\n        # Maximum phase velocity for CFL condition\n        c_max = max(c_perp, c_par)\n\n        # Time step from CFL condition\n        dt = s_cfl / (c_max * np.sqrt((1.0/dx)**2 + (1.0/dy)**2))\n\n        # Wavevector components\n        kx = k_mag * np.cos(theta)\n        ky = k_mag * np.sin(theta)\n\n        # --- Continuous Dispersion Calculation ---\n        omega_te_cont = k_mag * c_par\n        omega_tm_cont = k_mag * c_perp\n\n        # --- Numerical Dispersion Calculation ---\n        # Common term in the numerical dispersion relation argument\n        num_disp_sqrt_arg = np.sqrt(\n            (np.sin(kx * dx / 2.0) / dx)**2 + (np.sin(ky * dy / 2.0) / dy)**2\n        )\n\n        # Argument for arcsin for TE mode\n        arcsin_arg_te = dt * c_par * num_disp_sqrt_arg\n        # Argument for arcsin for TM mode\n        arcsin_arg_tm = dt * c_perp * num_disp_sqrt_arg\n        \n        # The stability condition ensures |arcsin_arg| = s_cfl  1.0\n        # This avoids domain errors for arcsin.\n        \n        # Numerical angular frequencies\n        omega_te_num = (2.0 / dt) * np.arcsin(arcsin_arg_te)\n        omega_tm_num = (2.0 / dt) * np.arcsin(arcsin_arg_tm)\n\n        # --- Numerical Birefringence (NB) Calculation ---\n        # NB = (v_te_num / v_te_cont) - (v_tm_num / v_tm_cont)\n        #    = (omega_te_num / omega_te_cont) - (omega_tm_num / omega_tm_cont)\n        \n        ratio_te = omega_te_num / omega_te_cont\n        ratio_tm = omega_tm_num / omega_tm_cont\n        \n        nb = ratio_te - ratio_tm\n        results.append(nb)\n\n    # Format the output as a comma-separated list of floats in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}