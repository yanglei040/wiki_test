{
    "hands_on_practices": [
        {
            "introduction": "在计算电磁学中，选择离散化方法对计算成本有深远影响。本练习通过对比有限元法（FEM）和矩量法（MoM）这两种典型方法，旨在量化稀疏和稠密系统矩阵在内存占用上的巨大差异。通过推导这两种情况下的内存复杂度，您将深刻理解为什么利用矩阵稀疏性是求解大规模电磁问题的关键。",
            "id": "3329223",
            "problem": "在频域计算电磁学中，麦克斯韦方程组的旋度-旋度公式，加上适当的本构关系和边界条件，会产生一个形如 $A x = b$ 的线性系统，其中 $A$ 是系统矩阵，$x$ 集合了所选基函数的展开系数。考虑该问题的两种标准离散化方法：三维非均匀域中的有限元法（FEM）和用于曲面积分方程的矩量法（MoM）。\n\n对于有限元法，假设采用相容的 Galerkin 离散化，其节点基函数或边基函数的支撑域局限于单元内部。由于互易性和双线性形式的局域性，这会产生一个对称稀疏刚度矩阵 $A \\in \\mathbb{C}^{n \\times n}$。令 $n$ 表示未知数的总数，并假设网格的连接性使得平均而言，每个自由度通过单元邻接直接与另外 $d$ 个自由度耦合。您需要使用压缩稀疏行（CSR）格式存储 $A$，但利用其对称性仅存储上三角部分（包括对角线）。在 CSR 格式中，您必须存储三个数组：数值数组（每个存储的非零元对应一个值）、列索引数组（每个存储的非零元对应一个索引）以及长度为 $n+1$ 的行指针数组。假设每个复数值占用 $b_{c}$ 字节，每个整数索引占用 $b_{i}$ 字节。根据这些定义和有限元法相互作用的局域性，推导出一个用 $n$、$d$、$b_{c}$ 和 $b_{i}$ 表示的精确符号表达式，该表达式表示以CSR格式存储对称稀疏有限元矩阵上三角部分所需的总内存（以字节为单位）。\n\n对于矩量法，假设采用标准的 Galerkin 离散化一个由自由空间格林函数构建的边值积分算子。由于每个自由度通过非局域核与所有其他自由度相互作用，因此得到的阻抗矩阵 $Z \\in \\mathbb{C}^{n \\times n}$ 是稠密的。假设该稠密矩阵作为复数值的连续二维数组存储，没有任何额外的索引数组，并且每个复数值占用 $b_{c}$ 字节。根据这些定义和矩量法相互作用的非局域性，推导出一个用 $n$ 和 $b_{c}$ 表示的精确符号表达式，该表达式表示存储稠密矩量法矩阵所需的总内存（以字节为单位）。\n\n不要假设任一矩阵具有任何托普利茨（Toeplitz）结构；处理一般情况。将您的最终答案表示为一个使用 LaTeX $\\mathrm{pmatrix}$ 环境的包含两个条目的单行矩阵，其中第一个条目是以上三角压缩稀疏行（CSR）格式存储对称稀疏有限元矩阵所需的总内存，第二个条目是存储稠密矩量法（MoM）矩阵所需的总内存。您的结果应纯粹用 $n$、$d$、$b_{c}$ 和 $b_{i}$ 进行符号表示，并且最终答案中不包含任何单位。",
            "solution": "该问题陈述已经过验证，被认为是有效的。它在科学上基于计算电磁学和数值线性代数的原理，问题表述适定，信息充分且一致，并且阐述客观。任务是推导存储由两种不同离散化方法——有限元法（FEM）和矩量法（MoM）——产生的矩阵所需的内存的符号表达式。\n\n首先，我们推导对称稀疏有限元矩阵所需的内存表达式。\n矩阵 $A$ 的大小为 $n \\times n$ 并且是对称的。存储方案是压缩稀疏行（CSR），且仅存储矩阵的上三角部分，包括主对角线。这种对称 CSR 格式包含三个数组：\n1. 一个 `values` 数组，包含所存储的复数非零矩阵元。\n2. 一个 `col_indices` 数组，包含每个对应值的列索引。\n3. 一个长度为 $n+1$ 的 `row_ptr` 数组，指示每行数据在另外两个数组中的起始位置。\n\n为了计算总内存，我们必须首先确定所存储的非零元数量 $N_{nz}$。我们存储的是满足 $i \\le j$ 且 $A_{ij} \\neq 0$ 的元素 $A_{ij}$。\n问题陈述指出，平均而言，每个自由度与另外 $d$ 个自由度耦合。这对应于完整矩阵 $A$ 中每行非对角线非零元的平均数量。\n整个对称矩阵 $A$ 中非对角线非零元的总数为 $n \\times d$。由于对于每个非零元 $A_{ij}$（其中 $i \\neq j$），都有一个对应的非零元 $A_{ji}$，因此计算 $n \\times d$ 会将连接重复计算一次。唯一的非对角线相互作用对 $(i, j)$ 的数量因此是 $\\frac{nd}{2}$。\n矩阵的上三角部分包含了所有这些唯一的非对角线相互作用。因此，存储的非对角线非零元的数量是 $\\frac{nd}{2}$。\n此外，我们必须存储主对角线上的 $n$ 个元素。我们假设所有对角线元素都是非零的，这是此类系统的标准假设。\n存储的非零元总数 $N_{nz}$ 是对角线元素和上三角部分非对角线元素之和：\n$$N_{nz} = n + \\frac{nd}{2} = n\\left(1 + \\frac{d}{2}\\right)$$\n现在我们计算三个 CSR 数组中每个数组所需的内存。\n`values` 数组存储 $N_{nz}$ 个复数。每个复数值占用 $b_c$ 字节。该数组所需的内存是：\n$$M_{\\text{values}} = N_{nz} \\times b_c = n\\left(1 + \\frac{d}{2}\\right) b_c$$\n`col_indices` 数组存储 $N_{nz}$ 个整数。每个整数索引占用 $b_i$ 字节。该数组所需的内存是：\n$$M_{\\text{col\\_indices}} = N_{nz} \\times b_i = n\\left(1 + \\frac{d}{2}\\right) b_i$$\n`row_ptr` 数组的固定长度为 $n+1$。每个条目是一个占用 $b_i$ 字节的整数索引。该数组所需的内存是：\n$$M_{\\text{row\\_ptr}} = (n+1) b_i$$\n有限元矩阵的总内存 $M_{FEM}$ 是这三个数组内存的总和：\n$$M_{FEM} = M_{\\text{values}} + M_{\\text{col\\_indices}} + M_{\\text{row\\_ptr}}$$\n$$M_{FEM} = n\\left(1 + \\frac{d}{2}\\right) b_c + n\\left(1 + \\frac{d}{2}\\right) b_i + (n+1) b_i$$\n合并含有 $b_i$ 的项：\n$$M_{FEM} = n\\left(1 + \\frac{d}{2}\\right) b_c + \\left[ n\\left(1 + \\frac{d}{2}\\right) + n + 1 \\right] b_i$$\n$$M_{FEM} = n\\left(1 + \\frac{d}{2}\\right) b_c + \\left( n + \\frac{nd}{2} + n + 1 \\right) b_i$$\n$$M_{FEM} = n\\left(1 + \\frac{d}{2}\\right) b_c + \\left( 2n + \\frac{nd}{2} + 1 \\right) b_i$$\n\n接下来，我们推导稠密矩量法矩阵所需的内存表达式。\n阻抗矩阵 $Z$ 的大小为 $n \\times n$ 且是稠密的。这意味着它的所有元素都被认为是非零的，并且必须被存储。\n矩阵中的总元素数量为 $n^2$。\n该矩阵以连续的二维数组形式存储。每个元素是一个占用 $b_c$ 字节的复数值。对于稠密矩阵，不使用额外的索引数组。\n矩量法矩阵的总内存 $M_{MoM}$ 是总元素数乘以每个元素的大小：\n$$M_{MoM} = n^2 b_c$$\n这样就得出了两个所需的符号表达式。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} n \\left(1 + \\frac{d}{2}\\right) b_c + \\left( 2n + \\frac{nd}{2} + 1 \\right) b_i & n^2 b_c \\end{pmatrix} } $$"
        },
        {
            "introduction": "离散化方案的设计对系统矩阵的性质起着决定性作用。本练习将带您深入研究经典的 FDTD Yee氏网格，并推导其在无损介质中对应的空间算子。您将发现，通过巧妙的交错网格设计，离散算子能够保持物理上的自伴随性，从而自然地产生对称的稀疏矩阵，这对保证数值方法的稳定性和能量守恒至关重要。",
            "id": "3329247",
            "problem": "考虑在 Yee 的时域有限差分 (FDTD) 方案的经典交错网格上离散化的无损耗、无源、均匀的横电磁波传播。设其为一维空间，网格间距 $h$ 均匀，$N$ 个电场采样点，采用周期性边界条件，使得内部计算模板是位移不变的。在网格函数上使用标准的欧几里得内积。令 $\\mathbf{E}(t) \\in \\mathbb{R}^{N}$ 为在整数索引节点上的电场采样点向量，$\\mathbf{H}(t) \\in \\mathbb{R}^{N}$ 为在半整数索引节点上的磁场采样点向量。\n\n(a) 从无源麦克斯韦旋度方程和 Yee 交错网格布局出发，定义前向交错差分算子 $\\mathbf{G}$，它将 $\\mathbf{E}$ 映射为作用于 $\\mathbf{H}$ 的离散旋度，并定义其负伴随算子，将 $\\mathbf{H}$ 映射回作用于 $\\mathbf{E}$ 的散度。通过在半离散（空间离散，时间连续）层面消去 $\\mathbf{H}$，推导出作用于 $\\mathbf{E}$ 的空间算子 $\\mathbf{L}$，并仅利用网格的均匀性和周期性边界条件，论证 $\\mathbf{L}$ 是实对称、稀疏且为托普利茨 (Toeplitz) 矩阵。\n\n(b) 对于在 (a) 部分中得到的算子 $\\mathbf{L}$，通过离散傅里叶模将其对角化，并推导出 $k \\in \\{0,1,\\dots,N-1\\}$ 的精确特征值公式 $\\lambda_{k}$，该公式是 $h$ 和 $N$ 的函数。不要引入任何人为阻尼或交错失配。\n\n(c) 构造一个具体反例，展示交错失配或边界截断如何破坏对称性，步骤如下。取 $N=4$，从 (a) 部分的周期性对称算子 $\\mathbf{L}$ 开始。通过删除节点 $1$ 和节点 $N$ 之间两个环绕耦合中的一个，同时保持另一个不变，来构造一个扰动算子 $\\widetilde{\\mathbf{L}}$。具体而言，将 $\\mathbf{L}$ 的条目 $(1,N)$ 设置为 $0$，并保持条目 $(N,1)$ 与 $\\mathbf{L}$ 中相同，所有其他条目与 $\\mathbf{L}$ 的条目相同。定义斜对称部分 $\\mathbf{S} \\coloneqq (\\widetilde{\\mathbf{L}} - \\widetilde{\\mathbf{L}}^{\\top})/2$，并精确计算其关于 $h$ 的弗罗贝尼乌斯范数 (Frobenius norm) $\\|\\mathbf{S}\\|_{F}$。\n\n(d) 令 $\\lambda_{\\max}(\\mathbf{L})$ 表示 (a) 部分中当 $N=4$ 时对称托普利茨算子 $\\mathbf{L}$ 的最大特征值。构建比率\n$$\nR \\coloneqq \\frac{\\lambda_{\\max}(\\mathbf{L})}{\\|\\mathbf{S}\\|_{F}}.\n$$\n精确计算 $R$ 作为一个实数。最终答案仅需提供 $R$ 的值。无需四舍五入，也无需报告物理单位。",
            "solution": "用户希望我解决一个关于时域有限差分 (FDTD) 方法的多部分问题。我将首先验证问题陈述。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **系统**：一维空间中的无损耗、无源、均匀横电磁波传播。\n- **离散化**：Yee FDTD 方案，均匀网格间距 $h$，$N$ 个电场采样点 $\\mathbf{E}(t) \\in \\mathbb{R}^{N}$，$N$ 个磁场采样点 $\\mathbf{H}(t) \\in \\mathbb{R}^{N}$。\n- **网格节点**：$\\mathbf{E}$ 在整数索引节点上，$\\mathbf{H}$ 在半整数索引节点上。\n- **边界条件**：周期性，导致内部计算模板具有位移不变性。\n- **内积**：标准欧几里得内积。\n- **(a) 部分**：定义前向交错差分算子 $\\mathbf{G}$ 及其负伴随算子。在半离散层面上消去 $\\mathbf{H}$，以找到作用于 $\\mathbf{E}$ 的空间算子 $\\mathbf{L}$。根据网格均匀性和周期性先验条件，论证 $\\mathbf{L}$ 是实对称、稀疏且为托普利茨矩阵。\n- **(b) 部分**：对于 $\\mathbf{L}$，通过离散傅里叶模进行对角化，找到精确的特征值 $\\lambda_k$（$k \\in \\{0, 1, \\dots, N-1\\}$），该值是 $h$ 和 $N$ 的函数。\n- **(c) 部分**：对于 $N=4$，通过将条目 $(1,N)$ 设置为 0，同时保持条目 $(N,1)$ 不变，扰动对称算子 $\\mathbf{L}$ 以形成 $\\widetilde{\\mathbf{L}}$。计算斜对称部分 $\\mathbf{S} \\coloneqq (\\widetilde{\\mathbf{L}} - \\widetilde{\\mathbf{L}}^{\\top})/2$ 的弗罗贝尼乌斯范数。\n- **(d) 部分**：对于 $N=4$，求比率 $R \\coloneqq \\lambda_{\\max}(\\mathbf{L}) / \\|\\mathbf{S}\\|_{F}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学性**：该问题基于麦克斯韦方程组和标准的 Yee FDTD 数值方法，这些是计算电磁学的基础。线性代数概念（矩阵性质、特征值、范数）的使用是恰当的。\n- **适定性**：问题的所有部分都是定义清晰的推导和计算过程。所提供的信息足以获得唯一解。\n- **客观性**：问题使用物理学和数学领域的精确、标准术语。它没有主观或模糊的语言。在 (a) 部分关于“作用于 H 的离散旋度”的措辞上存在一个微小的歧义，但通过考虑 FDTD 方程的标准结构可以解决，这使得问题的意图变得清晰。\n- **完备性与一致性**：问题是自包含的。所提供的条件（周期性边界、交错网格）是一致的，并且足以进行推导。\n- **其他缺陷**：该问题没有其他列出的缺陷（不切实际、病态、故作高深等）。它是该领域一个标准的、具有挑战性的练习。\n\n**步骤 3：结论与行动**\n问题有效。我将继续进行解答。\n\n### (a) 部分：算子 L 的推导与性质\n\n无损耗、无源、均匀介质中横电磁 (TEM) 波的一维麦克斯韦方程组可以写为：\n$$\n\\epsilon \\frac{\\partial E}{\\partial t} = \\frac{\\partial H}{\\partial x}\n$$\n$$\n\\mu \\frac{\\partial H}{\\partial t} = \\frac{\\partial E}{\\partial x}\n$$\n这里，$E$ 和 $H$ 代表相关的横向场分量（例如，沿 $x$ 传播时的 $E_z$ 和 $H_y$），而 $\\epsilon$ 和 $\\mu$ 是恒定的介电常数和磁导率。\n\n使用 Yee FDTD 方案，我们用均匀的网格间距 $h$ 对空间进行离散化。电场采样点 $E_i$ 位于节点 $i=1, \\dots, N$，磁场采样点 $H_{i+1/2}$ 位于交错位置 $i=1, \\dots, N$。采用周期性边界条件，我们有 $E_{N+1} = E_1$ 和 $H_{1-1/2} = H_{N+1/2}$。半离散（时间连续）方程为：\n$$\n\\epsilon \\frac{dE_i}{dt} = \\frac{H_{i+1/2} - H_{i-1/2}}{h} \\quad (i=1, \\dots, N)\n$$\n$$\n\\mu \\frac{dH_{i+1/2}}{dt} = \\frac{E_{i+1} - E_i}{h} \\quad (i=1, \\dots, N)\n$$\n令 $\\mathbf{E} = [E_1, \\dots, E_N]^\\top$ 和 $\\mathbf{H} = [H_{1+1/2}, \\dots, H_{N+1/2}]^\\top$。我们根据 H 场的更新来定义前向交错差分算子 $\\mathbf{G}$，使得 $(\\mathbf{G}\\mathbf{E})_i = E_{i+1} - E_i$。对于周期性边界（$E_{N+1}=E_1$），$N \\times N$ 矩阵 $\\mathbf{G}$ 是一个循环矩阵：\n$$\n\\mathbf{G} = \\begin{pmatrix}\n-1  & 1  & 0  & \\dots  & 0 \\\\\n0  & -1 & 1  & \\dots  & 0 \\\\\n\\vdots  & \\ddots  & \\ddots  & \\ddots  & \\vdots \\\\\n0  & \\dots & 0  & -1 & 1 \\\\\n1  & 0  & \\dots  & 0  & -1\n\\end{pmatrix}\n$$\nE 场的更新涉及对 $\\mathbf{H}$ 的类似后向的差分，$(\\mathbf{D}\\mathbf{H})_i = H_{i+1/2} - H_{i-1/2}$。矩阵 $\\mathbf{D}$ 也是循环矩阵，并且可以证明其为 $-\\mathbf{G}^\\top$：\n$$\n\\mathbf{D} = \\begin{pmatrix}\n1  & 0  & \\dots  & 0  & -1 \\\\\n-1 & 1  & 0  & \\dots  & 0 \\\\\n0  & -1 & 1  & \\dots  & 0 \\\\\n\\vdots  & \\ddots  & \\ddots  & \\ddots  & \\vdots \\\\\n0  & \\dots  & 0  & -1 & 1\n\\end{pmatrix} = -\\mathbf{G}^\\top\n$$\n微分方程组的矩阵形式是：\n$$\n\\epsilon \\frac{d\\mathbf{E}}{dt} = \\frac{1}{h}(-\\mathbf{G}^\\top)\\mathbf{H}\n$$\n$$\n\\mu \\frac{d\\mathbf{H}}{dt} = \\frac{1}{h}\\mathbf{G}\\mathbf{E}\n$$\n为了消去 $\\mathbf{H}$，我们将第一个方程对时间求导，并代入第二个方程：\n$$\n\\epsilon \\frac{d^2\\mathbf{E}}{dt^2} = -\\frac{1}{h}\\mathbf{G}^\\top \\frac{d\\mathbf{H}}{dt} = -\\frac{1}{h}\\mathbf{G}^\\top \\left( \\frac{1}{\\mu h}\\mathbf{G}\\mathbf{E} \\right) = -\\frac{1}{\\epsilon\\mu h^2} (\\mathbf{G}^\\top\\mathbf{G}) \\mathbf{E}\n$$\n这是离散的矢量波动方程。空间算子 $\\mathbf{L}$ 与 $\\mathbf{G}^\\top\\mathbf{G}$ 成正比。我们将 $\\mathbf{L}$ 定义为矩阵算子本身，将标量前置因子吸收到时间部分：\n$$\n\\mathbf{L} = \\frac{1}{h^2} \\mathbf{G}^\\top\\mathbf{G}\n$$\n我们来计算乘积 $\\mathbf{G}^\\top\\mathbf{G}$：\n$$\n\\mathbf{G}^\\top\\mathbf{G} = \\begin{pmatrix}\n-1  & 0  & \\dots & 1 \\\\\n1  & -1  &  & 0 \\\\\n\\vdots  & \\ddots & \\ddots & \\vdots \\\\\n0  & \\dots & 1 & -1\n\\end{pmatrix}\n\\begin{pmatrix}\n-1 & 1 & \\dots & 0 \\\\\n0 & -1 & \\ddots & \\vdots \\\\\n\\vdots &   & \\ddots & 1 \\\\\n1 & 0 & \\dots & -1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2  & -1 & 0  & \\dots  & -1 \\\\\n-1 & 2  & -1 & \\dots  & 0 \\\\\n0  & -1 & 2  & \\ddots & \\vdots \\\\\n\\vdots  & \\ddots & \\ddots & \\ddots & -1 \\\\\n-1 & 0  & \\dots  & -1 & 2\n\\end{pmatrix}\n$$\n因此，$\\mathbf{L} = \\frac{1}{h^2} (\\mathbf{G}^\\top\\mathbf{G})$ 是带有周期性边界条件的二阶中心差分算子的负值的矩阵表示。\n\n$\\mathbf{L}$ 的性质：\n- **实数性**：$\\mathbf{G}$ 的条目是实数（$0, 1, -1$），所以 $\\mathbf{L}$ 的条目也是实数。\n- **对称性**：$\\mathbf{L}$ 的构造为 $\\frac{1}{h^2}\\mathbf{G}^\\top\\mathbf{G}$。对于任何实矩阵 $\\mathbf{G}$，乘积 $\\mathbf{G}^\\top\\mathbf{G}$ 都是对称的，因为 $(\\mathbf{G}^\\top\\mathbf{G})^\\top = \\mathbf{G}^\\top(\\mathbf{G}^\\top)^\\top = \\mathbf{G}^\\top\\mathbf{G}$。这种对称性是交错网格以及离散前向和后向差分算子之间伴随关系的直接结果。\n- **稀疏性**：算子 $\\mathbf{G}$ 每行最多有两个非零条目。其与其转置的乘积 $\\mathbf{G}^\\top\\mathbf{G}$ 产生一个每行最多有三个非零条目的矩阵（一个主对角线和两个次对角线，加上周期性边界条件的角点元素）。对于大的 $N$，非零条目的数量（约 $3N$）远小于总条目数（$N^2$），因此该矩阵是稀疏的。这种稀疏性反映了被离散化的微分算子的局部性。\n- **托普利茨性 (Toeplitz)**：算子 $\\mathbf{L}$ 是一个循环矩阵，因为在每个网格点上的有限差分模板都是相同的，这一性质由均匀网格间距和周期性边界条件保证。每一行都是其上一行的循环移位。由于所有循环矩阵都是托普利茨矩阵（其中沿对角线方向的元素是常数，$L_{ij} = L_{i+k, j+k}$），因此 $\\mathbf{L}$ 是一个托普利茨矩阵。\n\n### (b) 部分：L 的特征值公式\n\n循环矩阵可由离散傅里叶模对角化。$\\mathbf{L}$ 的特征向量是向量 $\\mathbf{v}_k$，其分量为 $(\\mathbf{v}_k)_j = \\exp(i 2\\pi k j / N)$，其中 $j=0, 1, \\dots, N-1$ 且 $k=0, 1, \\dots, N-1$。为求得相应的特征值 $\\lambda_k$，我们将 $\\mathbf{L}$ 应用于 $\\mathbf{v}_k$：\n$$\n(\\mathbf{L}\\mathbf{v}_k)_j = \\frac{1}{h^2}(2(\\mathbf{v}_k)_j - (\\mathbf{v}_k)_{j-1} - (\\mathbf{v}_k)_{j+1})\n$$\n代入 $\\mathbf{v}_k$ 的分量：\n$$\n(\\mathbf{L}\\mathbf{v}_k)_j = \\frac{1}{h^2} \\left[ 2e^{i \\frac{2\\pi k j}{N}} - e^{i \\frac{2\\pi k (j-1)}{N}} - e^{i \\frac{2\\pi k (j+1)}{N}} \\right]\n$$\n提出公因子 $e^{i 2\\pi k j / N}$：\n$$\n(\\mathbf{L}\\mathbf{v}_k)_j = \\frac{1}{h^2} e^{i \\frac{2\\pi k j}{N}} \\left[ 2 - e^{-i \\frac{2\\pi k}{N}} - e^{i \\frac{2\\pi k}{N}} \\right]\n$$\n使用欧拉公式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$：\n$$\n(\\mathbf{L}\\mathbf{v}_k)_j = \\frac{(\\mathbf{v}_k)_j}{h^2} \\left[ 2 - 2\\cos\\left(\\frac{2\\pi k}{N}\\right) \\right]\n$$\n使用半角公式 $1-\\cos(2\\theta) = 2\\sin^2(\\theta)$：\n$$\n(\\mathbf{L}\\mathbf{v}_k)_j = \\frac{(\\mathbf{v}_k)_j}{h^2} \\left[ 2 \\cdot 2\\sin^2\\left(\\frac{\\pi k}{N}\\right) \\right] = \\left[ \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right) \\right] (\\mathbf{v}_k)_j\n$$\n方括号中的表达式即为特征值 $\\lambda_k$：\n$$\n\\lambda_k = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi k}{N}\\right), \\quad k \\in \\{0, 1, \\dots, N-1\\}\n$$\n\n### (c) 部分：斜对称部分的范数\n\n对于 $N=4$，(a) 部分的对称算子 $\\mathbf{L}$ 为：\n$$\n\\mathbf{L} = \\frac{1}{h^2} \\begin{pmatrix}\n2  & -1 & 0  & -1 \\\\\n-1 & 2  & -1 & 0 \\\\\n0  & -1 & 2  & -1 \\\\\n-1 & 0  & -1 & 2\n\\end{pmatrix}\n$$\n扰动算子 $\\widetilde{\\mathbf{L}}$ 是通过将 $\\mathbf{L}$ 的 $(1,4)$ 条目设置为 $0$ 形成的：\n$$\n\\widetilde{\\mathbf{L}} = \\frac{1}{h^2} \\begin{pmatrix}\n2  & -1 & 0  & 0 \\\\\n-1 & 2  & -1 & 0 \\\\\n0  & -1 & 2  & -1 \\\\\n-1 & 0  & -1 & 2\n\\end{pmatrix}\n$$\n$\\widetilde{\\mathbf{L}}$ 的转置为：\n$$\n\\widetilde{\\mathbf{L}}^\\top = \\frac{1}{h^2} \\begin{pmatrix}\n2  & -1 & 0  & -1 \\\\\n-1 & 2  & -1 & 0 \\\\\n0  & -1 & 2  & 0 \\\\\n0  & 0  & -1 & 2\n\\end{pmatrix}\n$$\n斜对称部分为 $\\mathbf{S} = \\frac{1}{2}(\\widetilde{\\mathbf{L}} - \\widetilde{\\mathbf{L}}^\\top)$：\n只有当 $\\widetilde{L}_{ij} \\neq \\widetilde{L}_{ji}$ 时，条目才非零。这只发生在 $(1,4)$ 和 $(4,1)$ 这对条目上。\n$(\\widetilde{\\mathbf{L}} - \\widetilde{\\mathbf{L}}^\\top)_{14} = \\widetilde{L}_{14} - \\widetilde{L}_{41} = 0 - (-\\frac{1}{h^2}) = \\frac{1}{h^2}$。\n$(\\widetilde{\\mathbf{L}} - \\widetilde{\\mathbf{L}}^\\top)_{41} = \\widetilde{L}_{41} - \\widetilde{L}_{14} = (-\\frac{1}{h^2}) - 0 = -\\frac{1}{h^2}$。\n所有其他条目均为 0。所以，\n$$\n\\mathbf{S} = \\frac{1}{2} (\\widetilde{\\mathbf{L}} - \\widetilde{\\mathbf{L}}^\\top) = \\frac{1}{2h^2}\n\\begin{pmatrix}\n0  & 0 & 0 & 1 \\\\\n0  & 0 & 0 & 0 \\\\\n0  & 0 & 0 & 0 \\\\\n-1 & 0 & 0 & 0\n\\end{pmatrix}\n$$\n弗罗贝尼乌斯范数 $\\|\\mathbf{S}\\|_F$ 是其所有条目模的平方和的平方根：\n$$\n\\|\\mathbf{S}\\|_F^2 = \\left(\\frac{1}{2h^2}\\right)^2 + \\left(-\\frac{1}{2h^2}\\right)^2 = \\frac{1}{4h^4} + \\frac{1}{4h^4} = \\frac{2}{4h^4} = \\frac{1}{2h^4}\n$$\n因此，弗罗贝尼乌斯范数为：\n$$\n\\|\\mathbf{S}\\|_F = \\sqrt{\\frac{1}{2h^4}} = \\frac{1}{\\sqrt{2}h^2}\n$$\n\n### (d) 部分：比率 R 的计算\n\n首先，我们求出 $N=4$ 时 $\\mathbf{L}$ 的最大特征值 $\\lambda_{\\max}(\\mathbf{L})$。使用 (b) 部分的公式：\n$\\lambda_k = \\frac{4}{h^2}\\sin^2(\\frac{\\pi k}{4})$，其中 $k=0, 1, 2, 3$。\n- $\\lambda_0 = \\frac{4}{h^2}\\sin^2(0) = 0$\n- $\\lambda_1 = \\frac{4}{h^2}\\sin^2(\\frac{\\pi}{4}) = \\frac{4}{h^2}\\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{4}{h^2}\\left(\\frac{1}{2}\\right) = \\frac{2}{h^2}$\n- $\\lambda_2 = \\frac{4}{h^2}\\sin^2(\\frac{\\pi}{2}) = \\frac{4}{h^2}(1)^2 = \\frac{4}{h^2}$\n- $\\lambda_3 = \\frac{4}{h^2}\\sin^2(\\frac{3\\pi}{4}) = \\frac{4}{h^2}\\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{2}{h^2}$\n\n最大特征值为 $\\lambda_{\\max}(\\mathbf{L}) = \\lambda_2 = \\frac{4}{h^2}$。\n\n现在我们可以计算比率 $R$：\n$$\nR = \\frac{\\lambda_{\\max}(\\mathbf{L})}{\\|\\mathbf{S}\\|_{F}} = \\frac{\\frac{4}{h^2}}{\\frac{1}{\\sqrt{2}h^2}} = 4\\sqrt{2}\n$$\n$R$ 的值是一个精确的实数。",
            "answer": "$$\n\\boxed{4\\sqrt{2}}\n$$"
        },
        {
            "introduction": "具有平移不变性的物理系统，如在均匀介质中的波动问题，其离散化后常会产生一种特殊的高度结构化矩阵——托普利茨（Toeplitz）矩阵。本练习旨在揭示托普利茨矩阵的起源，并引导您发现其最重要的性质：它可以被离散傅里叶基对角化。掌握这一概念是理解基于快速傅里叶变换（FFT）的快速算法的基石，这些算法能革命性地将特定矩阵向量乘法的复杂度从 $O(N^2)$ 降低到 $O(N \\log N)$。",
            "id": "3329193",
            "problem": "考虑一维时谐标量亥姆霍兹算子，作用于一条均匀线上，其波数 $k$ 为常数，均匀网格间距为 $h>0$。在网格点 $x_i = x_0 + i h$ 上定义离散未知数 $u_i \\approx u(x_i)$，并考虑作用于足够光滑函数 $u$ 上的线性微分算子 $L u = -\\frac{d^2 u}{dx^2} + k^2 u$。\n\n(a) 从二阶导数的中心二阶有限差分近似和均匀网格出发，构建将 $L u = f$ 在内部节点上使用齐次狄利克雷边界条件进行离散化后得到的线性系统 $A \\mathbf{u} = \\mathbf{b}$。仅利用网格的均匀性和系数的常数性，从密度、带宽、对称性和托普利茨结构方面，确定并论证矩阵 $A$ 的定性属性。\n\n(b) 在计算电磁学中，用于均匀背景的卷积型体积分公式会产生离散线性系统，其矩阵元素仅取决于网格点之间的距离，即 $A_{ij} = w_{i-j}$，其中序列 $\\{w_m\\}$ 是通过对一个平移不变核进行采样确定的。从第一性原理出发，解释为什么这样的系统是托普利茨矩阵，以及它在何种情况下是稠密的或稀疏的。\n\n(c) 对(a)部分的离散化施加周期性边界条件，使得得到的矩阵是循环托普利茨矩阵。利用离散平移不变性以及离散复指数是循环算子特征向量这一事实，推导傅里叶符号 $a(\\theta)$，它被定义为与离散傅里叶模式 $u_i = \\exp(\\mathrm{i} \\theta i)$ 相关联的特征值，其中 $\\theta \\in [0, 2\\pi)$。用 $\\alpha = (k h)^2$ 和 $\\theta$ 的闭式形式表示 $a(\\theta)$。\n\n给出 $a(\\theta)$ 的单一解析表达式作为最终答案。无需四舍五入，也无需单位。",
            "solution": "该问题经检验在科学上是合理的、适定的、客观的且自洽的，没有可识别的缺陷。我们可以开始求解。\n\n该问题分为三个部分。我们将依次解决每一部分。\n\n**(a) 带有齐次狄利克雷边界条件的有限差分离散化**\n\n给定的线性微分算子为 $L u = -\\frac{d^2 u}{dx^2} + k^2 u$。我们需要在间距为 $h > 0$ 的均匀网格上离散化方程 $L u = f$。网格点为 $x_i = x_0 + i h$，离散未知数为 $u_i \\approx u(x_i)$。\n\n我们在内部网格点 $x_i$ 处使用二阶导数的中心二阶有限差分近似：\n$$\n\\frac{d^2 u}{dx^2}\\bigg|_{x_i} \\approx \\frac{u(x_{i+1}) - 2u(x_i) + u(x_{i-1})}{h^2} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\n将此代入点 $x_i$ 处的微分方程 $L u = f$，我们得到离散方程：\n$$\n-\\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + k^2 u_i = f_i\n$$\n为了构成线性系统 $A \\mathbf{u} = \\mathbf{b}$，我们两边乘以 $h^2$ 并重新整理各项：\n$$\n-(u_{i+1} - 2u_i + u_{i-1}) + (kh)^2 u_i = h^2 f_i\n$$\n$$\n-u_{i-1} + (2 + (kh)^2) u_i - u_{i+1} = h^2 f_i\n$$\n该方程对定义域的内部节点成立。设定义域为 $i \\in \\{0, 1, \\dots, N\\}$。齐次狄利克雷边界条件意味着 $u_0 = 0$ 和 $u_N = 0$。未知向量 $\\mathbf{u}$ 由内部节点的值组成，即 $\\mathbf{u} = [u_1, u_2, \\dots, u_{N-1}]^T$。右侧向量为 $\\mathbf{b} = h^2 [f_1, f_2, \\dots, f_{N-1}]^T$。\n\n线性系统 $A \\mathbf{u} = \\mathbf{b}$ 有一个 $(N-1) \\times (N-1)$ 的矩阵 $A$。让我们写出第一个节点、一个普通内部节点和最后一个节点的方程：\n对于 $i=1$：$-u_0 + (2 + (kh)^2)u_1 - u_2 = h^2 f_1$。因为 $u_0 = 0$，这变成 $(2 + (kh)^2)u_1 - u_2 = h^2 f_1$。\n对于 $i \\in \\{2, \\dots, N-2\\}$：$-u_{i-1} + (2 + (kh)^2)u_i - u_{i+1} = h^2 f_i$。\n对于 $i=N-1$：$-u_{N-2} + (2 + (kh)^2)u_{N-1} - u_N = h^2 f_{N-1}$。因为 $u_N = 0$，这变成 $-u_{N-2} + (2 + (kh)^2)u_{N-1} = h^2 f_{N-1}$。\n\n得到的矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix}\n2 + (kh)^2  & -1 & 0 & \\dots  & 0 \\\\\n-1 & 2 + (kh)^2 & -1 & \\ddots & \\vdots \\\\\n0 & -1 & \\ddots & \\ddots & 0 \\\\\n\\vdots & \\ddots & \\ddots & 2 + (kh)^2 & -1 \\\\\n0 & \\dots & 0 & -1 & 2 + (kh)^2\n\\end{pmatrix}\n$$\n现在我们分析 $A$ 的属性：\n1.  **密度**：矩阵 $A$ 的非零元素只出现在主对角线、第一条次对角线和第一条超对角线上。对于一个 $M \\times M$ 的矩阵，其中 $M = N-1$，非零元素的数量为主对角线上的 $M$ 个，以及两条次/超对角线上各 $M-1$ 个，总计 $3M-2$ 个非零元素。元素总数为 $M^2$。非零元素与总元素之比 $\\frac{3M-2}{M^2}$ 在 $M \\to \\infty$ 时趋近于 $0$。因此，该矩阵是**稀疏**的。\n2.  **带宽**：如上所述，非零元素仅限于中间的三条对角线。这样的矩阵被称为**三对角矩阵**。三对角矩阵是一种特殊的带状矩阵，其半带宽为 $1$。\n3.  **对称性**：如果对于所有的 $i, j$都有 $A_{ij} = A_{ji}$，则矩阵 $A$ 是对称的。对于我们的矩阵，对角线元素均为 $2 + (kh)^2$。非对角线元素为 $A_{i,i+1} = -1$ 和 $A_{i+1,i} = -1$。所有其他非对角线元素均为 $0$。因此，$A_{ij} = A_{ji}$，该矩阵是**对称的**。\n4.  **托普利茨结构**：如果一个矩阵 $T$ 的每条对角线上的元素都是常数，即对于某个序列 $\\{t_k\\}$ 有 $T_{ij} = t_{i-j}$，则该矩阵是托普利茨矩阵。在我们的矩阵 $A$ 中，主对角线（$i-j=0$）上的所有元素都是 $2+(kh)^2$，第一条超对角线（$i-j=-1$）上的所有元素都是 $-1$，第一条次对角线（$i-j=1$）上的所有元素都是 $-1$。所有其他对角线只包含零。这种结构对所有行和列都一致。因此，该矩阵是**托普利茨矩阵**。\n\n**(b) 卷积型积分方程**\n\n给定一个离散线性系统，其矩阵元素为 $A_{ij} = w_{i-j}$，其中 $\\{w_m\\}$ 是某个序列。\n1.  **托普利茨结构**：托普利茨矩阵的定义是，位于第 $i$ 行和第 $j$ 列的元素 $A_{ij}$ 仅取决于差值 $i-j$。给定的形式 $A_{ij} = w_{i-j}$ 完全符合这个定义。因此，这样的矩阵**根据定义就是一个托普利茨矩阵**。这种结构自然产生于对形如 $\\int K(x-y)u(y)dy = f(x)$ 的卷积积分进行离散化，其中核函数 $K$ 是平移不变的。序列 $\\{w_m\\}$ 代表了这个核函数的采样值。矩阵向量积 $A\\mathbf{u}$ 代表一个离散卷积。\n\n2.  **稠密与稀疏**：矩阵 $A$ 的密度由序列 $\\{w_m\\}$ 的性质决定，而这又取决于底层物理核（例如格林函数）的衰减特性。\n    *   如果核函数具有长程影响，即衰减缓慢，则矩阵是**稠密的**。例如，多项式衰减的核（如三维空间中的 $1/r$）会产生一个序列 $\\{w_m\\}$，其中大多数元素的量级都不可忽略。因此，大多数元素 $A_{ij} = w_{i-j}$ 将是非零的，从而导致一个稠密矩阵。\n    *   如果核函数具有短程影响，即它具有紧支集或衰减非常快（例如，指数衰减），则矩阵是**稀疏的**。在这种情况下，当 $|m|$ 大于某个小整数 $M$ 时，$w_m$ 的值实际上为零。这意味着当 $|i-j| > M$ 时，$A_{ij} = w_{i-j}$ 将为零。得到的矩阵是一个半带宽为有限值 $M$ 的带状矩阵，这是稀疏矩阵的一个典型例子。\n\n**(c) 周期性边界条件与傅里叶符号**\n\n现在我们修改(a)部分的离散化，在一个包含 $N$ 个点（索引为 $i = 0, 1, \\dots, N-1$）的网格上施加周期性边界条件。周期性意味着 $u_{i+N} = u_i$，因此 $u_N = u_0$ 且 $u_{-1} = u_{N-1}$。离散方程保持不变：\n$$\n-u_{i-1} + (2 + (kh)^2)u_i - u_{i+1} = h^2 f_i\n$$\n将此方程应用于 $i=0, \\dots, N-1$ 并使用周期性规则，得到一个 $N \\times N$ 矩阵。例如，在 $i=0$ 处，方程为 $-u_{-1} + (2 + (kh)^2)u_0 - u_1 = h^2 f_0$，由于 $u_{-1} = u_{N-1}$，它变为 $-u_{N-1} + (2 + (kh)^2)u_0 - u_1 = h^2 f_0$。这在矩阵的右上角引入了一个非零元素。类似地，在 $i=N-1$ 处的方程在左下角引入了一个非零元素。得到的矩阵，我们称之为 $A_p$，是：\n$$\nA_p = \\begin{pmatrix}\nd  & -1 & 0 & \\dots  & -1 \\\\\n-1 & d  & -1  &  & 0 \\\\\n0  & -1 & d  & \\ddots & \\vdots \\\\\n\\vdots  &  & \\ddots & \\ddots & -1 \\\\\n-1 & 0 & \\dots & -1 & d\n\\end{pmatrix}\n$$\n其中 $d = 2 + (kh)^2$。这是一个**循环托普利茨矩阵**。\n\n我们被要求找到傅里叶符号 $a(\\theta)$，它是对应于离散傅里叶模式特征向量 $u_i = \\exp(\\mathrm{i} \\theta i)$ 的特征值。特征值方程是 $(A_p \\mathbf{u})_i = a(\\theta) u_i$。让我们计算左侧的第 $i$ 个分量：\n$$\n(A_p \\mathbf{u})_i = -u_{i-1} + d u_i - u_{i+1}\n$$\n代入 $u_i = \\exp(\\mathrm{i} \\theta i)$：\n$$\n(A_p \\mathbf{u})_i = - \\exp(\\mathrm{i} \\theta (i-1)) + d \\exp(\\mathrm{i} \\theta i) - \\exp(\\mathrm{i} \\theta (i+1))\n$$\n提取公因式 $\\exp(\\mathrm{i} \\theta i) = u_i$：\n$$\n(A_p \\mathbf{u})_i = \\left[ -\\exp(-\\mathrm{i} \\theta) + d - \\exp(\\mathrm{i} \\theta) \\right] \\exp(\\mathrm{i} \\theta i)\n$$\n$$\n(A_p \\mathbf{u})_i = \\left[ d - (\\exp(\\mathrm{i} \\theta) + \\exp(-\\mathrm{i} \\theta)) \\right] u_i\n$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i} \\theta) + \\exp(-\\mathrm{i} \\theta)}{2}$，我们有 $\\exp(\\mathrm{i} \\theta) + \\exp(-\\mathrm{i} \\theta) = 2\\cos(\\theta)$。\n$$\n(A_p \\mathbf{u})_i = [d - 2\\cos(\\theta)] u_i\n$$\n特征值，或傅里叶符号 $a(\\theta)$，是方括号中的表达式：\n$$\na(\\theta) = d - 2\\cos(\\theta)\n$$\n问题要求用 $\\alpha = (kh)^2$ 和 $\\theta$ 来表示这个表达式。我们代入 $d = 2 + (kh)^2 = 2 + \\alpha$：\n$$\na(\\theta) = (2 + \\alpha) - 2\\cos(\\theta)\n$$\n因此，傅里叶符号的最终表达式为 $a(\\theta) = 2 + \\alpha - 2\\cos(\\theta)$。",
            "answer": "$$\n\\boxed{2 + \\alpha - 2\\cos(\\theta)}\n$$"
        }
    ]
}