{
    "hands_on_practices": [
        {
            "introduction": "The fundamental behavior of electromagnetic waves within a guiding structure is dictated by the boundary conditions imposed by its walls. This practice delves into this core concept by analyzing a waveguide with a non-trivial combination of Perfect Electric Conductor (PEC) and Perfect Magnetic Conductor (PMC) surfaces . By deriving the dispersion relation from Maxwell’s equations, you will directly see how these idealized boundaries translate into mathematical constraints that select the allowed propagation modes, a foundational skill for the analysis and design of microwave circuits and components.",
            "id": "3338766",
            "problem": "A lossless, source-free, homogeneous, isotropic rectangular waveguide occupies the region $0 \\le x \\le a$, $0 \\le y \\le b$, and extends infinitely along $z$. The walls at $x=0$ and $y=0$ are Perfect Electric Conductor (PEC), and the opposite walls at $x=a$ and $y=b$ are Perfect Magnetic Conductor (PMC), forming four line junctions between PEC and PMC at the corners. Assume time-harmonic fields with phasor convention $\\exp(j \\omega t)$ and free-space material parameters $\\epsilon_0$ and $\\mu_0$. Consider transverse magnetic to $z$ (TM$_z$) modes, wherein $H_z=0$ and $E_z \\neq 0$.\n\nStarting from Maxwell’s equations and the PEC/PMC boundary conditions, derive the scalar boundary-value problem for $E_z(x,y)$ on the cross-section and show that the dispersion relation for TM$_z$ modes in this mixed-boundary waveguide has the form\n$$\\beta^2 \\;=\\; k^2 \\;-\\; \\lambda_x^2 \\;-\\; \\lambda_y^2,$$\nwith transverse separation constants $\\lambda_x$ and $\\lambda_y$ determined by the mixed Dirichlet–Neumann boundary conditions implied by the PEC/PMC walls. Then, for the lowest-order TM$_z$ mode corresponding to the smallest positive $\\lambda_x$ and $\\lambda_y$, compute the propagation constant $\\beta$ at frequency $f = 15.0 \\times 10^9$ Hz in vacuum when $a = 1.00 \\times 10^{-2}$ m and $b = 2.00 \\times 10^{-2}$ m. Express the final $\\beta$ in radians per meter and round your answer to four significant figures.",
            "solution": "The problem asks for the derivation of the dispersion relation for TM$_z$ modes in a rectangular waveguide with mixed Perfect Electric Conductor (PEC) and Perfect Magnetic Conductor (PMC) walls, and for the computation of the propagation constant $\\beta$ for the lowest-order mode under specific conditions.\n\nThe analysis begins with the time-harmonic Maxwell's equations in a source-free, homogeneous, and isotropic medium ($\\epsilon_0$, $\\mu_0$):\n$$ \\nabla \\times \\mathbf{E} = -j\\omega\\mu_0 \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = j\\omega\\epsilon_0 \\mathbf{E} $$\nFor wave propagation along the $z$-axis, the fields are assumed to have a phasor dependence of the form $\\exp(-j\\beta z)$, where $\\beta$ is the propagation constant. This implies that the partial derivative with respect to $z$ can be replaced by multiplication with $-j\\beta$.\n\nFor Transverse Magnetic to $z$ (TM$_z$) modes, the axial magnetic field component is zero, $H_z = 0$, while the axial electric field component $E_z$ is non-zero. The wave equation for the electric field is $(\\nabla^2 + k^2)\\mathbf{E} = 0$, where $k^2 = \\omega^2 \\mu_0 \\epsilon_0$. The $z$-component of this vector wave equation gives a scalar Helmholtz equation for $E_z$:\n$$ (\\nabla^2 + k^2) E_z = 0 $$\nExpanding the Laplacian operator $\\nabla^2 = \\nabla_t^2 + \\frac{\\partial^2}{\\partial z^2}$, where $\\nabla_t^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ is the transverse Laplacian, and using $\\frac{\\partial^2}{\\partial z^2} = (-j\\beta)^2 = -\\beta^2$, we obtain the governing partial differential equation (PDE) for $E_z(x,y)$ on the waveguide's cross-section:\n$$ \\frac{\\partial^2 E_z}{\\partial x^2} + \\frac{\\partial^2 E_z}{\\partial y^2} + (k^2 - \\beta^2) E_z = 0 $$\nThis is a 2D scalar Helmholtz equation. We solve it using the method of separation of variables, letting $E_z(x,y) = X(x)Y(y)$. Substituting this into the PDE yields:\n$$ Y(y)\\frac{d^2X}{dx^2} + X(x)\\frac{d^2Y}{dy^2} + (k^2 - \\beta^2)X(x)Y(y) = 0 $$\nDividing by $X(x)Y(y)$ allows separation of the variables:\n$$ \\frac{1}{X}\\frac{d^2X}{dx^2} + \\frac{1}{Y}\\frac{d^2Y}{dy^2} = -(k^2 - \\beta^2) $$\nThe left side consists of a term depending only on $x$ and a term depending only on $y$. For their sum to be constant, each term must be a constant. We define the separation constants $-\\lambda_x^2$ and $-\\lambda_y^2$:\n$$ \\frac{1}{X}\\frac{d^2X}{dx^2} = -\\lambda_x^2 \\implies \\frac{d^2X}{dx^2} + \\lambda_x^2 X = 0 $$\n$$ \\frac{1}{Y}\\frac{d^2Y}{dy^2} = -\\lambda_y^2 \\implies \\frac{d^2Y}{dy^2} + \\lambda_y^2 Y = 0 $$\nSubstituting these into the separated equation gives $-\\lambda_x^2 - \\lambda_y^2 = -(k^2 - \\beta^2)$. Rearranging, we obtain the dispersion relation:\n$$ \\beta^2 = k^2 - \\lambda_x^2 - \\lambda_y^2 $$\nThis confirms the first part of the problem statement. The values of $\\lambda_x$ and $\\lambda_y$ are determined by the boundary conditions.\n\nNext, we establish the boundary conditions for $E_z(x,y)$.\n1.  **PEC walls** ($x=0$, $y=0$): The tangential component of the electric field must vanish. The axial field $E_z$ is tangential to all four walls.\n    -   At $x=0$: $E_z(0, y) = 0$. This is a Dirichlet condition.\n    -   At $y=0$: $E_z(x, 0) = 0$. This is a Dirichlet condition.\n2.  **PMC walls** ($x=a$, $y=b$): The tangential component of the magnetic field must vanish. For TM$_z$ modes, the transverse fields can be expressed in terms of $E_z$:\n    $$ \\mathbf{E}_t = -\\frac{j\\beta}{k_c^2} \\nabla_t E_z $$\n    $$ \\mathbf{H}_t = -\\frac{j\\omega\\epsilon_0}{k_c^2} \\hat{z} \\times \\nabla_t E_z $$\n    where $k_c^2 = k^2 - \\beta^2 = \\lambda_x^2 + \\lambda_y^2$. Expanding $\\mathbf{H}_t = H_x\\hat{x} + H_y\\hat{y}$ and $\\nabla_t E_z = \\frac{\\partial E_z}{\\partial x}\\hat{x} + \\frac{\\partial E_z}{\\partial y}\\hat{y}$:\n    $$ \\mathbf{H}_t = -\\frac{j\\omega\\epsilon_0}{k_c^2} \\left( \\hat{z} \\times \\left( \\frac{\\partial E_z}{\\partial x}\\hat{x} + \\frac{\\partial E_z}{\\partial y}\\hat{y} \\right) \\right) = -\\frac{j\\omega\\epsilon_0}{k_c^2} \\left( \\frac{\\partial E_z}{\\partial x}\\hat{y} - \\frac{\\partial E_z}{\\partial y}\\hat{x} \\right) $$\n    -   At $x=a$: The tangential component of $\\mathbf{H}$ is $H_y$. The PMC condition is $H_y(a, y) = 0$. From the expression for $\\mathbf{H}_t$, this implies $\\frac{\\partial E_z}{\\partial x}(a, y) = 0$. This is a Neumann condition.\n    -   At $y=b$: The tangential component of $\\mathbf{H}$ is $H_x$. The PMC condition is $H_x(x, b) = 0$. This implies $\\frac{\\partial E_z}{\\partial y}(x, b) = 0$. This is a Neumann condition.\n\nNow, we solve the ODEs for $X(x)$ and $Y(y)$ with these mixed boundary conditions.\nFor $X(x)$: The general solution is $X(x) = C_1 \\cos(\\lambda_x x) + C_2 \\sin(\\lambda_x x)$.\n-   $X(0) = 0 \\implies C_1 = 0$, so $X(x) = C_2 \\sin(\\lambda_x x)$.\n-   $\\frac{dX}{dx}(a) = 0 \\implies C_2 \\lambda_x \\cos(\\lambda_x a) = 0$. For non-trivial solutions ($C_2 \\neq 0, \\lambda_x \\neq 0$), we must have $\\cos(\\lambda_x a) = 0$.\n-   This yields $\\lambda_x a = \\frac{(2m-1)\\pi}{2}$ for $m = 1, 2, 3, \\ldots$. Thus, $\\lambda_x = \\frac{(2m-1)\\pi}{2a}$.\n\nFor $Y(y)$: The general solution is $Y(y) = D_1 \\cos(\\lambda_y y) + D_2 \\sin(\\lambda_y y)$.\n-   $Y(0) = 0 \\implies D_1 = 0$, so $Y(y) = D_2 \\sin(\\lambda_y y)$.\n-   $\\frac{dY}{dy}(b) = 0 \\implies D_2 \\lambda_y \\cos(\\lambda_y b) = 0$. For non-trivial solutions ($D_2 \\neq 0, \\lambda_y \\neq 0$), we must have $\\cos(\\lambda_y b) = 0$.\n-   This yields $\\lambda_y b = \\frac{(2n-1)\\pi}{2}$ for $n = 1, 2, 3, \\ldots$. Thus, $\\lambda_y = \\frac{(2n-1)\\pi}{2b}$.\n\nThe lowest-order TM$_z$ mode corresponds to the smallest positive values for $\\lambda_x$ and $\\lambda_y$, which occurs for $m=1$ and $n=1$.\n$$ \\lambda_x = \\frac{\\pi}{2a} \\quad \\text{and} \\quad \\lambda_y = \\frac{\\pi}{2b} $$\nThe propagation constant $\\beta$ is given by:\n$$ \\beta = \\sqrt{k^2 - \\lambda_x^2 - \\lambda_y^2} = \\sqrt{\\left(\\frac{2\\pi f}{c_0}\\right)^2 - \\left(\\frac{\\pi}{2a}\\right)^2 - \\left(\\frac{\\pi}{2b}\\right)^2} $$\nwhere $c_0 = 1/\\sqrt{\\mu_0\\epsilon_0}$ is the speed of light in vacuum.\n\nNow, we compute the numerical value of $\\beta$ with the given parameters:\n-   Frequency $f = 15.0 \\times 10^9$ Hz\n-   Dimension $a = 1.00 \\times 10^{-2}$ m\n-   Dimension $b = 2.00 \\times 10^{-2}$ m\n-   Speed of light $c_0 = 299792458$ m/s\n\nFirst, we calculate the terms inside the square root:\n$$ k^2 = \\left(\\frac{2\\pi f}{c_0}\\right)^2 = \\left(\\frac{2\\pi \\times 15.0 \\times 10^9}{299792458}\\right)^2 \\approx 98822.9304 \\text{ rad}^2/\\text{m}^2 $$\n$$ \\lambda_x^2 = \\left(\\frac{\\pi}{2a}\\right)^2 = \\left(\\frac{\\pi}{2 \\times 1.00 \\times 10^{-2}}\\right)^2 = (50\\pi)^2 = 2500\\pi^2 \\approx 24674.0110 \\text{ rad}^2/\\text{m}^2 $$\n$$ \\lambda_y^2 = \\left(\\frac{\\pi}{2b}\\right)^2 = \\left(\\frac{\\pi}{2 \\times 2.00 \\times 10^{-2}}\\right)^2 = (25\\pi)^2 = 625\\pi^2 \\approx 6168.5027 \\text{ rad}^2/\\text{m}^2 $$\nThe squared cutoff wavenumber is $k_c^2 = \\lambda_x^2 + \\lambda_y^2 = 3125\\pi^2 \\approx 30842.5137 \\text{ rad}^2/\\text{m}^2$.\nSince $k^2 > k_c^2$, the mode is propagating.\n\nNow, we calculate $\\beta^2$:\n$$ \\beta^2 = k^2 - k_c^2 \\approx 98822.9304 - 30842.5137 = 67980.4167 \\text{ rad}^2/\\text{m}^2 $$\nFinally, we compute $\\beta$ by taking the square root:\n$$ \\beta = \\sqrt{67980.4167} \\approx 260.730856 \\text{ rad/m} $$\nRounding the result to four significant figures gives $260.7$.",
            "answer": "$$\\boxed{260.7}$$"
        },
        {
            "introduction": "Electromagnetic fields not only guide energy but also carry momentum, exerting forces on any object they interact with. This exercise bridges the gap between field theory and mechanics by tasking you with the calculation of radiation pressure using the Maxwell Stress Tensor, a key tool in electrodynamics . You will analyze the pressure exerted by a plane wave on both PEC and PMC surfaces, uncovering an elegant and unifying result that also provides deep insight into the principle of electromagnetic duality.",
            "id": "3338719",
            "problem": "Consider time-harmonic electromagnetic fields in vacuum governed by Maxwell's equations and the Maxwell stress tensor. Let the vacuum permittivity be $\\epsilon_0$, the vacuum permeability be $\\mu_0$, the speed of light be $c = 1/\\sqrt{\\mu_0 \\epsilon_0}$, and the intrinsic impedance of free space be $Z_0 = \\sqrt{\\mu_0/\\epsilon_0}$. The time-averaged Maxwell stress tensor (MST) is defined as\n$$\n\\langle \\mathbf{T} \\rangle = \\frac{1}{2} \\operatorname{Re}\\left\\{\\epsilon_0 \\left( \\mathbf{E}\\mathbf{E}^* - \\frac{1}{2} \\mathbf{I} \\, \\lvert \\mathbf{E} \\rvert^2 \\right) + \\mu_0 \\left( \\mathbf{H}\\mathbf{H}^* - \\frac{1}{2} \\mathbf{I} \\, \\lvert \\mathbf{H} \\rvert^2 \\right) \\right\\},\n$$\nwhere $\\mathbf{E}$ and $\\mathbf{H}$ are complex phasor representations of the electric and magnetic fields, $\\mathbf{I}$ is the identity dyadic, and $^*$ denotes complex conjugation. A perfectly planar boundary located at $z = 0$ separates vacuum ($z \\geq 0$) from a semi-infinite material occupying $z < 0$, which is either a Perfect Electric Conductor (PEC) or a Perfect Magnetic Conductor (PMC). An incident plane wave in the half-space $z > 0$ strikes the boundary from above, with unit propagation direction $\\hat{\\mathbf{s}}_{\\mathrm{i}} = (\\sin\\theta, 0, -\\cos\\theta)$, where $\\theta$ is the angle of incidence measured from the $+z$ axis. The reflected wave has unit propagation direction $\\hat{\\mathbf{s}}_{\\mathrm{r}} = (\\sin\\theta, 0, +\\cos\\theta)$. Assume the tangential phase variations along $x$ are common to the incident and reflected waves and focus on the fields evaluated at the surface $z=0$.\n\nTwo polarizations are considered:\n\n- Transverse Electric (TE, also called $s$-polarization): the incident electric field is $\\mathbf{E}_{\\mathrm{i}} = E_0 \\,\\hat{\\mathbf{y}}$, with real amplitude $E_0 > 0$. The corresponding incident magnetic field is $\\mathbf{H}_{\\mathrm{i}} = \\frac{E_0}{Z_0} \\, \\hat{\\mathbf{s}}_{\\mathrm{i}} \\times \\hat{\\mathbf{y}}$.\n\n- Transverse Magnetic (TM, also called $p$-polarization): the incident magnetic field is $\\mathbf{H}_{\\mathrm{i}} = H_0 \\,\\hat{\\mathbf{y}}$, with $H_0 = E_0/Z_0$, and the corresponding incident electric field is $\\mathbf{E}_{\\mathrm{i}} = Z_0 \\, \\hat{\\mathbf{s}}_{\\mathrm{i}} \\times \\mathbf{H}_{\\mathrm{i}}$.\n\nThe boundary conditions at the surface $z=0$ are:\n\n- For a Perfect Electric Conductor (PEC): the total tangential electric field satisfies $\\mathbf{E}_{\\mathrm{t}}(z=0) = \\mathbf{0}$.\n\n- For a Perfect Magnetic Conductor (PMC): the total tangential magnetic field satisfies $\\mathbf{H}_{\\mathrm{t}}(z=0) = \\mathbf{0}$.\n\nThe reflected fields must be chosen to satisfy these boundary conditions. Let $\\mathbf{E}_{\\mathrm{r}}$ and $\\mathbf{H}_{\\mathrm{r}}$ denote the reflected phasor fields at $z=0$, constrained by the plane-wave relations $\\mathbf{H} = \\frac{1}{Z_0} \\hat{\\mathbf{s}} \\times \\mathbf{E}$ and $\\mathbf{E} = Z_0 \\, \\hat{\\mathbf{s}} \\times \\mathbf{H}$ for the incident and reflected waves respectively.\n\nDefine the outward unit normal of the vacuum region at the surface as $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$. The electromagnetic traction acting on the surface from the vacuum side has scalar normal component $\\tau_n = \\hat{\\mathbf{n}} \\cdot \\langle \\mathbf{T} \\rangle \\cdot \\hat{\\mathbf{n}}$. The pressure exerted on the material (directed along $-\\hat{\\mathbf{n}}$ into the material) is defined as\n$$\nP = - \\tau_n = - \\hat{\\mathbf{n}} \\cdot \\langle \\mathbf{T} \\rangle \\cdot \\hat{\\mathbf{n}}.\n$$\n\nTask: Starting only from the fundamental definitions above and the boundary conditions, derive an algorithm to compute the time-averaged pressure $P$ at $z=0$ for the four combinations of polarization (TE/TM) and boundary type (PEC/PMC). Then use that algorithm to evaluate $P$ for the following test suite. All angles are given in radians, and the final pressure must be given in $\\mathrm{N/m^2}$.\n\nTest suite parameters $(E_0, \\theta, \\text{polarization}, \\text{boundary})$:\n\n1. $(2.0, 0.4, \\text{TE}, \\text{PEC})$\n2. $(2.0, 0.4, \\text{TE}, \\text{PMC})$\n3. $(2.0, 0.4, \\text{TM}, \\text{PEC})$\n4. $(2.0, 0.4, \\text{TM}, \\text{PMC})$\n5. $(1.0, 0.0, \\text{TE}, \\text{PEC})$\n6. $(1.0, \\tfrac{\\pi}{2} - 0.01, \\text{TM}, \\text{PMC})$\n\nIn addition, analyze how the sign and magnitude of $P$ change (or do not change) under the electromagnetic duality transformation in vacuum\n$$\n\\mathbf{E}' = Z_0 \\mathbf{H}, \\quad \\mathbf{H}' = -\\frac{\\mathbf{E}}{Z_0},\n$$\ntogether with the dual interchange of boundary types $\\text{PEC} \\leftrightarrow \\text{PMC}$ and sources $\\mathbf{J}_{\\mathrm{e}} \\leftrightarrow \\mathbf{J}_{\\mathrm{m}}$ that generate TE/TM waves. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots,r_6]$), where each $r_i$ is the computed pressure for the $i$-th test case in $\\mathrm{N/m^2}$.",
            "solution": "The primary task is to compute the time-averaged pressure $P$ exerted on a perfectly reflecting surface at $z=0$ by an incident plane wave. The pressure is defined as $P = - \\tau_n$, where $\\tau_n = \\hat{\\mathbf{n}} \\cdot \\langle \\mathbf{T} \\rangle \\cdot \\hat{\\mathbf{n}}$ is the normal component of the electromagnetic traction on the surface. The unit normal to the vacuum region ($z \\ge 0$) at the boundary is $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$. Therefore, the pressure is $P = - \\hat{\\mathbf{z}} \\cdot \\langle \\mathbf{T} \\rangle \\cdot \\hat{\\mathbf{z}} = - \\langle T_{zz} \\rangle$.\n\nThe time-averaged Maxwell Stress Tensor (MST) is given by:\n$$\n\\langle \\mathbf{T} \\rangle = \\frac{1}{2} \\operatorname{Re}\\left\\{\\epsilon_0 \\left( \\mathbf{E}\\mathbf{E}^* - \\frac{1}{2} \\mathbf{I} \\, \\lvert \\mathbf{E} \\rvert^2 \\right) + \\mu_0 \\left( \\mathbf{H}\\mathbf{H}^* - \\frac{1}{2} \\mathbf{I} \\, \\lvert \\mathbf{H} \\rvert^2 \\right) \\right\\}\n$$\nThe $zz$-component of the tensor is:\n$$\n\\langle T_{zz} \\rangle = \\hat{\\mathbf{z}} \\cdot \\langle \\mathbf{T} \\rangle \\cdot \\hat{\\mathbf{z}} = \\frac{1}{2} \\operatorname{Re}\\left\\{\\epsilon_0 \\left( |E_z|^2 - \\frac{1}{2} |\\mathbf{E}|^2 \\right) + \\mu_0 \\left( |H_z|^2 - \\frac{1}{2} |\\mathbf{H}|^2 \\right) \\right\\}\n$$\nwhere $|\\mathbf{E}|^2 = |E_x|^2 + |E_y|^2 + |E_z|^2 = |\\mathbf{E}_{\\mathrm{t}}|^2 + |E_z|^2$, and similarly for $\\mathbf{H}$. The total fields $\\mathbf{E}$ and $\\mathbf{H}$ are evaluated at the boundary $z=0$. Substituting the squared magnitudes, we get:\n$$\n\\langle T_{zz} \\rangle = \\frac{1}{4} \\operatorname{Re}\\left\\{\\epsilon_0 \\left( |E_z|^2 - |\\mathbf{E}_{\\mathrm{t}}|^2 \\right) + \\mu_0 \\left( |H_z|^2 - |\\mathbf{H}_{\\mathrm{t}}|^2 \\right) \\right\\}\n$$\nThe pressure is then:\n$$\nP = - \\langle T_{zz} \\rangle = \\frac{1}{4} \\operatorname{Re}\\left\\{\\epsilon_0 \\left( |\\mathbf{E}_{\\mathrm{t}}|^2 - |E_z|^2 \\right) + \\mu_0 \\left( |\\mathbf{H}_{\\mathrm{t}}|^2 - |H_z|^2 \\right) \\right\\}\n$$\nWe now determine the total fields at $z=0$ for each of the four specified cases. The total field is the sum of the incident ($\\mathbf{E}_{\\mathrm{i}}, \\mathbf{H}_{\\mathrm{i}}$) and reflected ($\\mathbf{E}_{\\mathrm{r}}, \\mathbf{H}_{\\mathrm{r}}$) fields. The common phase term $e^{-j k_x x}$ with $k_x = k_0 \\sin\\theta$ will be omitted, as it cancels in all $|\\cdot|^2$ operations.\n\n**Incident Wave Fields**\nThe incident propagation direction is $\\hat{\\mathbf{s}}_{\\mathrm{i}} = (\\sin\\theta, 0, -\\cos\\theta)$. The reflected is $\\hat{\\mathbf{s}}_{\\mathrm{r}} = (\\sin\\theta, 0, \\cos\\theta)$.\n\n**1. Transverse Electric (TE) Polarization**\nIncident fields: $\\mathbf{E}_{\\mathrm{i}} = E_0\\hat{\\mathbf{y}}$. Using $\\mathbf{H} = \\frac{1}{Z_0}\\hat{\\mathbf{s}}\\times\\mathbf{E}$, we find $\\mathbf{H}_{\\mathrm{i}} = \\frac{E_0}{Z_0} (\\cos\\theta\\hat{\\mathbf{x}} + \\sin\\theta\\hat{\\mathbf{z}})$.\nReflected fields: We assume a reflected wave of the same polarization, $\\mathbf{E}_{\\mathrm{r}} = \\Gamma_{\\mathrm{TE}}E_0\\hat{\\mathbf{y}}$. This gives $\\mathbf{H}_{\\mathrm{r}} = \\frac{\\Gamma_{\\mathrm{TE}}E_0}{Z_0} (-\\cos\\theta\\hat{\\mathbf{x}} + \\sin\\theta\\hat{\\mathbf{z}})$.\nTotal fields at $z=0$:\n$\\mathbf{E} = \\mathbf{E}_{\\mathrm{i}} + \\mathbf{E}_{\\mathrm{r}} = (1 + \\Gamma_{\\mathrm{TE}})E_0\\hat{\\mathbf{y}}$. This is purely tangential, so $\\mathbf{E}_{\\mathrm{t}} = (1 + \\Gamma_{\\mathrm{TE}})E_0\\hat{\\mathbf{y}}$ and $E_z = 0$.\n$\\mathbf{H} = \\mathbf{H}_{\\mathrm{i}} + \\mathbf{H}_{\\mathrm{r}} = \\frac{E_0}{Z_0}[(1 - \\Gamma_{\\mathrm{TE}})\\cos\\theta\\hat{\\mathbf{x}} + (1 + \\Gamma_{\\mathrm{TE}})\\sin\\theta\\hat{\\mathbf{z}}]$.\n\n**1a. TE on PEC:** The boundary condition is $\\mathbf{E}_{\\mathrm{t}}(z=0)=0$. This implies $(1 + \\Gamma_{\\mathrm{TE}})E_0 = 0$, so $\\Gamma_{\\mathrm{TE}} = -1$.\nThe total fields are $\\mathbf{E} = \\mathbf{0}$ and $\\mathbf{H} = \\frac{2E_0}{Z_0}\\cos\\theta\\hat{\\mathbf{x}}$.\nAt the boundary: $\\mathbf{E}_{\\mathrm{t}}=0, E_z=0, \\mathbf{H}_{\\mathrm{t}}=\\frac{2E_0}{Z_0}\\cos\\theta\\hat{\\mathbf{x}}, H_z=0$.\nPressure: $P = \\frac{1}{4} \\left( \\epsilon_0(0-0) + \\mu_0(|\\frac{2E_0}{Z_0}\\cos\\theta|^2 - 0) \\right) = \\frac{\\mu_0 E_0^2 \\cos^2\\theta}{Z_0^2}$. Since $Z_0^2 = \\mu_0/\\epsilon_0$, we get $P = \\epsilon_0 E_0^2 \\cos^2\\theta$.\n\n**1b. TE on PMC:** The boundary condition is $\\mathbf{H}_{\\mathrm{t}}(z=0)=0$. For $\\theta \\neq \\pi/2$, this implies $(1-\\Gamma_{\\mathrm{TE}})\\cos\\theta = 0$, so $\\Gamma_{\\mathrm{TE}} = 1$.\nThe total fields are $\\mathbf{E} = 2E_0\\hat{\\mathbf{y}}$ and $\\mathbf{H} = \\frac{2E_0}{Z_0}\\sin\\theta\\hat{\\mathbf{z}}$.\nAt the boundary: $\\mathbf{E}_{\\mathrm{t}}=2E_0\\hat{\\mathbf{y}}, E_z=0, \\mathbf{H}_{\\mathrm{t}}=0, H_z=\\frac{2E_0}{Z_0}\\sin\\theta$.\nPressure: $P = \\frac{1}{4} \\left( \\epsilon_0(|2E_0|^2 - 0) + \\mu_0(0 - |\\frac{2E_0}{Z_0}\\sin\\theta|^2) \\right) = \\epsilon_0 E_0^2 - \\frac{\\mu_0 E_0^2 \\sin^2\\theta}{Z_0^2} = \\epsilon_0 E_0^2(1-\\sin^2\\theta) = \\epsilon_0 E_0^2 \\cos^2\\theta$.\n\n**2. Transverse Magnetic (TM) Polarization**\nIncident fields: $\\mathbf{H}_{\\mathrm{i}} = (E_0/Z_0)\\hat{\\mathbf{y}}$. Using $\\mathbf{E} = -Z_0\\hat{\\mathbf{s}}\\times\\mathbf{H}$, we find $\\mathbf{E}_{\\mathrm{i}} = -E_0(\\cos\\theta\\hat{\\mathbf{x}} + \\sin\\theta\\hat{\\mathbf{z}})$.\nReflected fields: $\\mathbf{H}_{\\mathrm{r}} = \\Gamma_{\\mathrm{TM}}(E_0/Z_0)\\hat{\\mathbf{y}}$. This gives $\\mathbf{E}_{\\mathrm{r}} = \\Gamma_{\\mathrm{TM}}E_0(\\cos\\theta\\hat{\\mathbf{x}} - \\sin\\theta\\hat{\\mathbf{z}})$.\nTotal fields at $z=0$:\n$\\mathbf{H} = \\mathbf{H}_{\\mathrm{i}} + \\mathbf{H}_{\\mathrm{r}} = (1 + \\Gamma_{\\mathrm{TM}})\\frac{E_0}{Z_0}\\hat{\\mathbf{y}}$. This is purely tangential, so $\\mathbf{H}_{\\mathrm{t}} = (1 + \\Gamma_{\\mathrm{TM}})\\frac{E_0}{Z_0}\\hat{\\mathbf{y}}$ and $H_z = 0$.\n$\\mathbf{E} = \\mathbf{E}_{\\mathrm{i}} + \\mathbf{E}_{\\mathrm{r}} = E_0[(\\Gamma_{\\mathrm{TM}}-1)\\cos\\theta\\hat{\\mathbf{x}} - (1+\\Gamma_{\\mathrm{TM}})\\sin\\theta\\hat{\\mathbf{z}}]$.\n\n**2a. TM on PEC:** The boundary condition is $\\mathbf{E}_{\\mathrm{t}}(z=0)=0$. For $\\theta \\neq \\pi/2$, this implies $(\\Gamma_{\\mathrm{TM}}-1)\\cos\\theta = 0$, so $\\Gamma_{\\mathrm{TM}} = 1$.\nThe total fields are $\\mathbf{H} = \\frac{2E_0}{Z_0}\\hat{\\mathbf{y}}$ and $\\mathbf{E} = -2E_0\\sin\\theta\\hat{\\mathbf{z}}$.\nAt the boundary: $\\mathbf{E}_{\\mathrm{t}}=0, E_z=-2E_0\\sin\\theta, \\mathbf{H}_{\\mathrm{t}}=\\frac{2E_0}{Z_0}\\hat{\\mathbf{y}}, H_z=0$.\nPressure: $P = \\frac{1}{4} \\left( \\epsilon_0(0 - |-2E_0\\sin\\theta|^2) + \\mu_0(|\\frac{2E_0}{Z_0}|^2 - 0) \\right) = -\\epsilon_0 E_0^2 \\sin^2\\theta + \\frac{\\mu_0 E_0^2}{Z_0^2} = \\epsilon_0 E_0^2(1-\\sin^2\\theta) = \\epsilon_0 E_0^2 \\cos^2\\theta$.\n\n**2b. TM on PMC:** The boundary condition is $\\mathbf{H}_{\\mathrm{t}}(z=0)=0$. This implies $(1+\\Gamma_{\\mathrm{TM}})\\frac{E_0}{Z_0} = 0$, so $\\Gamma_{\\mathrm{TM}} = -1$.\nThe total fields are $\\mathbf{H} = \\mathbf{0}$ and $\\mathbf{E} = -2E_0\\cos\\theta\\hat{\\mathbf{x}}$.\nAt the boundary: $\\mathbf{E}_{\\mathrm{t}}=-2E_0\\cos\\theta\\hat{\\mathbf{x}}, E_z=0, \\mathbf{H}_{\\mathrm{t}}=0, H_z=0$.\nPressure: $P = \\frac{1}{4} \\left( \\epsilon_0(|-2E_0\\cos\\theta|^2 - 0) + \\mu_0(0-0) \\right) = \\epsilon_0 E_0^2 \\cos^2\\theta$.\n\n**Summary of Results and Duality**\nIn all four cases, the magnitude of the reflection coefficient is $|\\Gamma|=1$, signifying total reflection. The derived pressure is consistently given by the same expression:\n$$\nP = \\epsilon_0 E_0^2 \\cos^2\\theta\n$$\nThis result can be interpreted physically. The time-averaged energy density of the incident wave is $\\mathcal{U}_{\\mathrm{inc}} = \\frac{1}{4}\\operatorname{Re}(\\epsilon_0|\\mathbf{E}_{\\mathrm{i}}|^2 + \\mu_0|\\mathbf{H}_{\\mathrm{i}}|^2) = \\frac{1}{2}\\epsilon_0 E_0^2$. The pressure formula can thus be written as $P = 2\\mathcal{U}_{\\mathrm{inc}}\\cos^2\\theta$. This is a known general result for radiation pressure upon a perfectly reflecting surface. Our derivation from first principles confirms its validity for both PEC and PMC boundaries and both TE and TM polarizations.\n\nThe problem also asks for an analysis of electromagnetic duality. The duality transformation in vacuum is $\\mathbf{E}' = Z_0 \\mathbf{H}$ and $\\mathbf{H}' = -\\mathbf{E}/Z_0$. A PEC boundary condition $\\mathbf{E}_\\mathrm{t}=0$ transforms to $Z_0\\mathbf{H}_\\mathrm{t}=0 \\implies \\mathbf{H}_\\mathrm{t}=0$, which is the PMC boundary condition. A TE wave transforms into a TM wave. Thus, the duality transformation maps the (TE, PEC) problem to the (TM, PMC) problem, and the (TE, PMC) problem to the (TM, PEC) problem.\nUnder duality, the MST transforms as:\n$$\n\\langle \\mathbf{T}' \\rangle \\propto \\epsilon_0(\\mathbf{E}'\\mathbf{E}'^* - \\frac{1}{2}\\mathbf{I}|\\mathbf{E}'|^2) + \\mu_0(\\mathbf{H}'\\mathbf{H}'^* - \\frac{1}{2}\\mathbf{I}|\\mathbf{H}'|^2)\n= \\epsilon_0(Z_0^2\\mathbf{H}\\mathbf{H}^* - \\frac{1}{2}\\mathbf{I} Z_0^2|\\mathbf{H}|^2) + \\mu_0(\\frac{1}{Z_0^2}\\mathbf{E}\\mathbf{E}^* - \\frac{1}{2}\\mathbf{I}\\frac{1}{Z_0^2}|\\mathbf{E}|^2)\n$$\nUsing $Z_0^2=\\mu_0/\\epsilon_0$, this simplifies to $\\langle \\mathbf{T}' \\rangle = \\langle \\mathbf{T} \\rangle$. The MST is invariant under duality.\nAs a direct consequence, the pressure $P = -\\langle T_{zz} \\rangle$ must also be invariant. This implies $P(\\text{TE, PEC}) = P(\\text{TM, PMC})$ and $P(\\text{TE, PMC}) = P(\\text{TM, PEC})$. Our finding that the pressure is identical in all four cases is consistent with, and stronger than, the requirement imposed by duality.\n\nThe algorithm for all test cases is therefore to compute $P = \\epsilon_0 E_0^2 \\cos^2\\theta$.\nThe value of the vacuum permittivity is $\\epsilon_0 \\approx 8.8541878128 \\times 10^{-12} \\text{ F/m}$.\nWe can now implement this simple formula for the given test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Computes the radiation pressure on a perfect conductor for several test cases.\n    \"\"\"\n    # The derivation shows that for any case of total reflection (PEC or PMC)\n    # and any polarization (TE or TM), the pressure P is given by:\n    # P = epsilon_0 * E_0^2 * cos^2(theta)\n    # where epsilon_0 is the vacuum permittivity, E_0 is the incident electric\n    # field amplitude, and theta is the angle of incidence.\n\n    epsilon_0 = constants.epsilon_0\n\n    # Define the test cases from the problem statement.\n    # Format: (E_0 [V/m], theta [rad], polarization, boundary_type)\n    test_cases = [\n        (2.0, 0.4, 'TE', 'PEC'),\n        (2.0, 0.4, 'TE', 'PMC'),\n        (2.0, 0.4, 'TM', 'PEC'),\n        (2.0, 0.4, 'TM', 'PMC'),\n        (1.0, 0.0, 'TE', 'PEC'),\n        (1.0, np.pi/2 - 0.01, 'TM', 'PMC'),\n    ]\n\n    results = []\n    for E0, theta, polarization, boundary in test_cases:\n        # The formula is the same for all cases as derived in the solution.\n        # It only depends on E0 and theta.\n        pressure = epsilon_0 * (E0**2) * (np.cos(theta)**2)\n        results.append(f\"{pressure:.12e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Numerical simulation is an indispensable tool in modern computational electromagnetics, and the Finite-Difference Time-Domain (FDTD) method is one of its cornerstones. This hands-on simulation practice challenges you to implement an FDTD solver to model transient wave propagation in a one-dimensional cavity terminated by mixed PEC and PMC boundaries . A crucial part of this exercise involves validating your numerical results against the analytical predictions of image theory, reinforcing the vital connection between theoretical models and their computational implementation.",
            "id": "3338736",
            "problem": "Consider a one-dimensional time-domain electromagnetic propagation problem in a lossless, source-excited line segment along the spatial coordinate $x \\in [0,L]$, bounded on the left at $x=0$ by a perfect electric conductor (PEC) and on the right at $x=L$ by a perfect magnetic conductor (PMC). The medium is free space with permittivity $\\epsilon_0$ and permeability $\\mu_0$, so the phase velocity is $v = c_0 = 1/\\sqrt{\\epsilon_0 \\mu_0}$. Use the Finite-Difference Time-Domain (FDTD) method to advance the coupled fields for a transverse electromagnetic (TEM) configuration: an electric field component $E_y(x,t)$ and a magnetic field component $H_z(x,t)$ varying only in $x$ and $t$. Enforce the boundary conditions $E_y(0,t) = 0$ (PEC) and $H_z(L,t) = 0$ (PMC).\n\nStart from Maxwell’s equations in differential form for a source-free, linear, isotropic, homogeneous medium,\n$$\\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t}, \\quad \\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t},$$\nspecialized to the one-dimensional case with $E_y$ and $H_z$ nonzero and functions of $x$ and $t$, and derive a staggered-grid (Yee-type) update. Implement a soft source injection by adding a time-dependent excitation $s(t)$ to the electric field at a single grid location $x=x_s$ each time step. Let the excitation be the Ricker wavelet\n$$s(t) = \\left(1 - 2\\pi^2 f_0^2 (t - t_0)^2\\right) \\exp\\left(-\\pi^2 f_0^2 (t - t_0)^2\\right),$$\nwhere $f_0$ is the central frequency in $\\mathrm{Hz}$ and $t_0$ is the center time in $\\mathrm{s}$. Use a Courant-stable time step $ \\Delta t = S \\, \\Delta x / c_0$ with Courant factor $S \\in (0,1]$ and uniform spatial step $\\Delta x$.\n\nConnect the observed transient field patterns to virtual mirror sources via electromagnetic image theory. In one dimension with mixed PEC/PMC terminations, the set of virtual source positions is generated by mirroring the physical source $x_s$ across the boundaries repeatedly, resulting in the infinite set\n$$x_{\\text{img}} = 2 m L \\pm x_s, \\quad m \\in \\mathbb{Z},$$\nand the corresponding arrival times at an observation point $x=x_o$ are\n$$t_{\\text{arr}} = t_0 + \\frac{|x_o - x_{\\text{img}}|}{c_0}.$$\nAlthough the reflection signs at PEC and PMC alter amplitudes and polarities, arrivals in time are governed purely by path lengths in this one-dimensional setting.\n\nYour program must:\n- Construct the one-dimensional Yee lattice for $E_y$ and $H_z$, implement the FDTD time stepping consistent with Maxwell’s curl equations and the specified PEC and PMC boundary conditions, and inject $s(t)$ at $x=x_s$.\n- Record the electric field $E_y(x_o,t)$ at the observation coordinate $x_o$ over the full simulation.\n- Extract the first $K$ arrival times from the recorded trace as the earliest $K$ local maxima of $|E_y(x_o,t)|$ above a data-adaptive threshold, expressed in seconds.\n- Compute the analytical arrival times from image theory as the earliest $K$ values of $t_{\\text{arr}}$ that do not exceed the total simulated time window.\n\nFor comparison, declare the result for each test case to be a boolean computed as follows: it is true if and only if the number of detected arrivals is at least $K$ and the absolute difference between each simulated arrival time and its analytical counterpart (paired in ascending order) is less than a specified tolerance $\\delta_t$. Set the tolerance to $\\delta_t = 5 \\Delta t$. Express all computed times in seconds, and base all tolerances on seconds.\n\nImplement the program with free-space values $\\epsilon_0$ and $\\mu_0$, and use the following test suite of parameter sets. All spatial quantities must be in meters ($\\mathrm{m}$), times in seconds ($\\mathrm{s}$), and frequencies in hertz ($\\mathrm{Hz}$). For each case, use Courant factor $S = 0.99$.\n\n- Case A (general check): $L = 1.0\\,\\mathrm{m}$, $N = 401$ grid points for $E_y$, $x_s = 0.22\\,\\mathrm{m}$, $x_o = 0.77\\,\\mathrm{m}$, $f_0 = 1.2 \\times 10^8\\,\\mathrm{Hz}$, $t_0 = 5.0 \\times 10^{-9}\\,\\mathrm{s}$, total simulated time $T = 3.5 \\times 10^{-8}\\,\\mathrm{s}$, $K = 6$ arrivals.\n- Case B (shorter line, off-center observation): $L = 0.5\\,\\mathrm{m}$, $N = 401$, $x_s = 0.10\\,\\mathrm{m}$, $x_o = 0.45\\,\\mathrm{m}$, $f_0 = 8.0 \\times 10^7\\,\\mathrm{Hz}$, $t_0 = 3.0 \\times 10^{-9}\\,\\mathrm{s}$, $T = 2.5 \\times 10^{-8}\\,\\mathrm{s}$, $K = 6$.\n- Case C (moderate length, observation left of source): $L = 0.8\\,\\mathrm{m}$, $N = 301$, $x_s = 0.30\\,\\mathrm{m}$, $x_o = 0.20\\,\\mathrm{m}$, $f_0 = 1.0 \\times 10^8\\,\\mathrm{Hz}$, $t_0 = 4.0 \\times 10^{-9}\\,\\mathrm{s}$, $T = 3.0 \\times 10^{-8}\\,\\mathrm{s}$, $K = 5$.\n\nYour program should produce a single line of output containing the results for the three cases as a comma-separated list enclosed in square brackets, for example $[r_A,r_B,r_C]$ where each $r_\\cdot$ is a boolean indicating whether the simulation arrivals are consistent with the analytical arrivals under the stated tolerance. The final output must be exactly of the form $[result1,result2,result3]$.",
            "solution": "### FDTD Formulation\nThe simulation addresses a one-dimensional Transverse Electromagnetic (TEM) wave propagating along the $x$-axis, with field components $E_y(x,t)$ and $H_z(x,t)$. The governing Maxwell's equations in a source-free, lossless medium reduce to:\n$$ \\frac{\\partial E_y}{\\partial x} = -\\mu_0 \\frac{\\partial H_z}{\\partial t} $$\n$$ \\frac{\\partial H_z}{\\partial x} = -\\epsilon_0 \\frac{\\partial E_y}{\\partial t} $$\nWe employ the Yee-staggered grid, where $E_y$ and $H_z$ are offset in both space and time. Let the domain $x \\in [0,L]$ be discretized into cells of width $\\Delta x$.\n- The electric field $E_y$ is sampled at spatial locations $x_i = i \\Delta x$ for $i=0, 1, \\dots, N-1$, where $L=(N-1)\\Delta x$. It is sampled at integer time steps $t_n = n \\Delta t$. We denote this as $E_y^n[i]$.\n- The magnetic field $H_z$ is sampled at spatial locations $x_{i+1/2} = (i+0.5) \\Delta x$ for $i=0, 1, \\dots, N-2$. It is sampled at half-integer time steps $t_{n+1/2} = (n+0.5) \\Delta t$. We denote this as $H_z^{n+1/2}[i]$.\n\nApplying central-difference approximations to the derivatives yields the FDTD update equations:\n1.  **Magnetic Field ($H_z$) Update**:\n    $$ H_z^{n+1/2}[i] = H_z^{n-1/2}[i] - \\frac{\\Delta t}{\\mu_0 \\Delta x} \\left( E_y^n[i+1] - E_y^n[i] \\right) $$\n    This equation updates the $H_z$ field from time step $n-1/2$ to $n+1/2$ using the $E_y$ field at time step $n$. This is applied for all $H_z$ nodes, i.e., $i = 0, \\dots, N-2$.\n\n2.  **Electric Field ($E_y$) Update**:\n    $$ E_y^{n+1}[i] = E_y^n[i] - \\frac{\\Delta t}{\\epsilon_0 \\Delta x} \\left( H_z^{n+1/2}[i] - H_z^{n+1/2}[i-1] \\right) $$\n    This equation updates the $E_y$ field from time step $n$ to $n+1$ using the just-computed $H_z$ field at time step $n+1/2$. This is applied for the interior $E_y$ nodes, i.e., $i=1, \\dots, N-2$.\n\nThe stability of this scheme is ensured by the Courant-Friedrichs-Lewy (CFL) condition, $\\Delta t \\le \\frac{\\Delta x}{c_0}$. The problem specifies a Courant factor $S=0.99$, so $\\Delta t = S \\frac{\\Delta x}{c_0}$, which guarantees stability.\n\n### Boundary and Source Conditions\n1.  **Perfect Electric Conductor (PEC) at $x=0$**: The condition $E_y(0,t)=0$ is enforced by setting $E_y^n[0] = 0$ for all time steps $n$.\n\n2.  **Perfect Magnetic Conductor (PMC) at $x=L$**: The condition $H_z(L,t)=0$ is implemented by deriving an update rule for the boundary node $E_y[N-1]$ that respects this condition. From image theory, the magnetic field is anti-symmetric with respect to the PMC boundary. This implies a \"ghost\" magnetic field value $H_{z, \\text{ghost}}^{n+1/2}$ at $L+0.5\\Delta x$ is equal to $-H_z^{n+1/2}[N-2]$ (the value at $L-0.5\\Delta x$). The update for $E_y[N-1]$ becomes:\n    $$ E_y^{n+1}[N-1] = E_y^n[N-1] - \\frac{\\Delta t}{\\epsilon_0 \\Delta x} \\left( H_{z, \\text{ghost}}^{n+1/2} - H_z^{n+1/2}[N-2] \\right) = E_y^n[N-1] + \\frac{2 \\Delta t}{\\epsilon_0 \\Delta x} H_z^{n+1/2}[N-2] $$\n\n3.  **Soft Source Injection**: The Ricker wavelet $s(t)$ is added to the electric field at the grid location $k_s = \\mathrm{round}(x_s/\\Delta x)$ after the main $E_y$ update step at each time-step.\n    $$ E_y^{n+1}[k_s] \\leftarrow E_y^{n+1}[k_s] + s((n+1)\\Delta t) $$\n\n### Analytical Arrival Times and Validation\nThe analytical model uses image theory. For a cavity bounded by a PEC at $x=0$ and a PMC at $x=L$, the infinite set of image sources for a physical source at $x_s$ is located at positions $x_{\\text{img}} = 2 m L \\pm x_s$ for all integers $m \\in \\mathbb{Z}$. The arrival time of a pulse from an image source at an observer location $x_o$ is $t_{\\text{arr}} = t_0 + \\frac{|x_o - x_{\\text{img}}|}{c_0}$, where $t_0$ is the peak time of the source wavelet.\n\nThe validation procedure involves:\n1.  Running the FDTD simulation for the total time $T$ and recording $E_y$ at the observer node $k_o = \\mathrm{round}(x_o/\\Delta x)$.\n2.  Finding the first $K$ arrival times from the simulated signal by identifying the first $K$ local maxima in $|E_y(x_o,t)|$ that exceed a data-adaptive threshold. `scipy.signal.find_peaks` with a prominence threshold relative to the maximum signal amplitude is a robust method for this.\n3.  Calculating the first $K$ theoretical arrival times using the image theory formula, sorted in ascending order.\n4.  Comparing the two sets of times. The validation is `True` if at least $K$ arrivals are detected in the simulation and the absolute difference between each simulated arrival and its corresponding analytical counterpart is less than the tolerance $\\delta_t = 5 \\Delta t$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import constants\nfrom scipy.signal import find_peaks\n\ndef ricker_wavelet(t, t0, f0):\n    \"\"\"\n    Computes the Ricker wavelet s(t) at time t.\n\n    Args:\n        t (float or np.ndarray): Time(s) in seconds.\n        t0 (float): Center time of the wavelet in seconds.\n        f0 (float): Central frequency of the wavelet in Hz.\n\n    Returns:\n        float or np.ndarray: The value of the Ricker wavelet.\n    \"\"\"\n    arg = (np.pi**2) * (f0**2) * ((t - t0)**2)\n    return (1.0 - 2.0 * arg) * np.exp(-arg)\n\ndef calculate_analytical_arrivals(L, xs, xo, t0, c0, T_total, K):\n    \"\"\"\n    Calculates analytical arrival times using image theory for a PEC-PMC cavity.\n\n    Args:\n        L (float): Length of the cavity in meters.\n        xs (float): Source position in meters.\n        xo (float): Observer position in meters.\n        t0 (float): Center time of the source wavelet in seconds.\n        c0 (float): Speed of light in meters per second.\n        T_total (float): Total simulation time in seconds.\n        K (int): Number of arrivals to compute.\n\n    Returns:\n        list: A sorted list of the first K analytical arrival times.\n    \"\"\"\n    arrivals = []\n    # A sufficiently large range for m to find all arrivals within T_total\n    m_range = int(T_total * c0 / (2.0 * L)) + 5\n\n    for m in range(-m_range, m_range + 1):\n        # Image sources at 2*m*L +/- xs\n        x_img1 = 2.0 * m * L + xs\n        x_img2 = 2.0 * m * L - xs\n        \n        t_arr1 = t0 + np.abs(xo - x_img1) / c0\n        t_arr2 = t0 + np.abs(xo - x_img2) / c0\n        \n        if t_arr1 <= T_total:\n            arrivals.append(t_arr1)\n        if t_arr2 <= T_total:\n            arrivals.append(t_arr2)\n    \n    # Remove duplicates, sort, and take the first K\n    unique_arrivals = sorted(list(set(arrivals)))\n    return unique_arrivals[:K]\n\ndef run_fdtd_simulation(L, N, xs, xo, f0, t0, T, K):\n    \"\"\"\n    Runs a single 1D FDTD simulation case and validates the results against theory.\n    \"\"\"\n    # Physical constants\n    epsilon0 = constants.epsilon_0\n    mu0 = constants.mu_0\n    c0 = constants.c\n\n    # Grid parameters\n    S = 0.99  # Courant factor\n    dx = L / (N - 1)\n    dt = S * dx / c0\n    num_steps = int(np.ceil(T / dt))\n\n    # Field arrays\n    Ey = np.zeros(N, dtype=np.float64)\n    Hz = np.zeros(N - 1, dtype=np.float64)\n    \n    # Source and observer grid indices\n    ks = int(round(xs / dx))\n    ko = int(round(xo / dx))\n\n    # FDTD update coefficients\n    ce = dt / (epsilon0 * dx)\n    ch = dt / (mu0 * dx)\n\n    # Store observed field\n    Ey_observed = np.zeros(num_steps, dtype=np.float64)\n    time_vec = np.arange(num_steps) * dt\n\n    # FDTD time-stepping loop\n    for n in range(num_steps):\n        # Update H-field from E-field (indices 0 to N-2)\n        Hz[:] = Hz[:] - ch * (Ey[1:] - Ey[:-1])\n\n        # Update E-field from H-field (bulk nodes, indices 1 to N-2)\n        Ey[1:-1] = Ey[1:-1] - ce * (Hz[1:] - Hz[:-1])\n\n        # PEC boundary at x=0 (Ey[0]) is kept at 0\n        \n        # PMC boundary at x=L (Ey[N-1])\n        # H is anti-symmetric about the PMC boundary.\n        # The update for E_y[N-1] uses a ghost value for H, H_ghost = -H[N-2]\n        Ey[-1] = Ey[-1] + 2.0 * ce * Hz[-1]\n\n        # Inject source\n        t_current = (n + 1) * dt\n        source_val = ricker_wavelet(t_current, t0, f0)\n        Ey[ks] += source_val\n        \n        # Record field at observer\n        Ey_observed[n] = Ey[ko]\n\n    # Post-processing: Find simulated arrivals from recorded data\n    Ey_abs = np.abs(Ey_observed)\n    # Data-adaptive threshold for peak finding based on signal prominence.\n    max_amp = np.max(Ey_abs)\n    peak_prominence = 0.05 * max_amp if max_amp > 0 else 1.0\n\n    sim_peak_indices, _ = find_peaks(Ey_abs, prominence=peak_prominence)\n    sim_arrivals = sim_peak_indices * dt\n    \n    # Calculate analytical arrivals using the actual discretized grid positions\n    xs_actual = ks * dx\n    xo_actual = ko * dx\n    ana_arrivals = calculate_analytical_arrivals(L, xs_actual, xo_actual, t0, c0, T, K)\n\n    # Validation check\n    if len(sim_arrivals) < K or len(ana_arrivals) < K:\n        return False\n        \n    tolerance = 5.0 * dt\n    \n    for i in range(K):\n        if np.abs(sim_arrivals[i] - ana_arrivals[i]) > tolerance:\n            return False\n\n    return True\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {'L': 1.0, 'N': 401, 'xs': 0.22, 'xo': 0.77, 'f0': 1.2e8, 't0': 5.0e-9, 'T': 3.5e-8, 'K': 6},\n        # Case B\n        {'L': 0.5, 'N': 401, 'xs': 0.10, 'xo': 0.45, 'f0': 8.0e7, 't0': 3.0e-9, 'T': 2.5e-8, 'K': 6},\n        # Case C\n        {'L': 0.8, 'N': 301, 'xs': 0.30, 'xo': 0.20, 'f0': 1.0e8, 't0': 4.0e-9, 'T': 3.0e-8, 'K': 5},\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = run_fdtd_simulation(**case_params)\n        results.append(str(result).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}