{
    "hands_on_practices": [
        {
            "introduction": "本次练习旨在直接且具体地评估特征基函数方法（CBFM）的主要优势：计算资源的节省。通过一个真实（尽管是假设的）场景，你将计算未知量数量的减少以及随之而来的显著的内存存储节省。这项练习将CBFM的抽象概念建立在具体的、可量化的收益之上，突显其在处理大规模电磁仿真问题时的实际重要性。",
            "id": "3292505",
            "problem": "一个理想电导体散射体使用 Rao–Wilton–Glisson (RWG) 基函数通过矩量法 (MoM) 进行建模，产生一个稠密阻抗矩阵 $\\mathbf{Z}\\in\\mathbb{C}^{N\\times N}$，其中未知量数量为 $N=6.4\\times 10^{4}$。在稠密存储假设下，存储 $\\mathbf{Z}$ 所需的内存与其元素数量成正比。该散射体被划分为 $P=16$ 个连续子域，并通过在每个子域 $p\\in\\{1,\\dots,16\\}$ 上构建 $M_p$ 个特征基函数来应用特征基函数法 (CBFM)，其数量为\n$$\nM_1=160,\\;M_2=180,\\;M_3=190,\\;M_4=200,\\;M_5=210,\\;M_6=220,\\;M_7=190,\\;M_8=230,\\\\\nM_9=210,\\;M_{10}=170,\\;M_{11}=200,\\;M_{12}=180,\\;M_{13}=220,\\;M_{14}=210,\\;M_{15}=190,\\;M_{16}=240.\n$$\n令 $M=\\sum_{p=1}^{16} M_p$ 表示特征基函数的总数，因此降阶的 CBFM 耦合矩阵为 $\\mathbf{Z}_c\\in\\mathbb{C}^{M\\times M}$，并且也是稠密的。仅使用以下基本原理：(i) 大小为 $n\\times n$ 的稠密矩阵的存储量与 $n^2$ 成比例；(ii) CBFM 用总数为 $M$ 的降阶宏基函数集替换了原始的 RWG 基。计算缩减比 $r$（定义为特征基函数的总数除以原始未知量的数量），并估计在稠密存储假设下，通过存储 $\\mathbf{Z}_c$ 而非 $\\mathbf{Z}$ 所获得的内存节省分数。将这两个量表示为小数，并将您的答案四舍五入到四位有效数字。将您的最终结果以行矩阵 $\\begin{pmatrix} r  \\text{memory\\_savings} \\end{pmatrix}$ 的形式给出，不带单位。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上是合理的、适定的，并包含推导出唯一解所需的所有必要信息。其背景和参数与计算电磁学中关于矩量法 (MoM) 和特征基函数法 (CBFM) 应用的标准实践相符。\n\n第一步是计算特征基函数 (CBF) 的总数，记为 $M$。这是在 $P=16$ 个子域上构建的 CBF 的总和。\n$$\nM = \\sum_{p=1}^{16} M_p\n$$\n代入给定的 $M_p$ 值：\n$$\nM = 160 + 180 + 190 + 200 + 210 + 220 + 190 + 230 + 210 + 170 + 200 + 180 + 220 + 210 + 190 + 240\n$$\n将这些值相加得到：\n$$\nM = 3200\n$$\n问题将缩减比 $r$ 定义为特征基函数的总数除以原始未知量的数量。给定的原始未知量数量为 $N = 6.4 \\times 10^{4} = 64000$。\n$$\nr = \\frac{M}{N}\n$$\n代入 $M$ 和 $N$ 的值：\n$$\nr = \\frac{3200}{64000} = \\frac{32}{640} = \\frac{1}{20} = 0.05\n$$\n问题要求将此值表示为小数，并四舍五入到四位有效数字。\n$$\nr \\approx 0.05000\n$$\n接下来，我们估计内存节省分数。问题陈述，对于一个大小为 $n \\times n$ 的稠密矩阵，其存储所需内存与 $n^2$ 成比例。设存储一个稠密的 $k \\times k$ 复数矩阵所需的内存为 $C \\cdot k^2$，其中 $C$ 是一个与每个复数元素的存储成本相关的比例常数。\n\n存储原始稠密阻抗矩阵 $\\mathbf{Z} \\in \\mathbb{C}^{N \\times N}$ 所需的内存为：\n$$\n\\text{Mem}_{\\mathbf{Z}} = C \\cdot N^2\n$$\n存储降阶的稠密 CBFM 耦合矩阵 $\\mathbf{Z}_c \\in \\mathbb{C}^{M \\times M}$ 所需的内存为：\n$$\n\\text{Mem}_{\\mathbf{Z}_c} = C \\cdot M^2\n$$\n内存节省分数，我们记为 $S$，是内存减少量相对于原始内存需求的比例。\n$$\nS = \\frac{\\text{Mem}_{\\mathbf{Z}} - \\text{Mem}_{\\mathbf{Z}_c}}{\\text{Mem}_{\\mathbf{Z}}} = \\frac{C N^2 - C M^2}{C N^2} = 1 - \\frac{M^2}{N^2}\n$$\n这个表达式可以用缩减比 $r = \\frac{M}{N}$ 重写：\n$$\nS = 1 - \\left(\\frac{M}{N}\\right)^2 = 1 - r^2\n$$\n代入计算出的 $r=0.05$ 值：\n$$\nS = 1 - (0.05)^2 = 1 - 0.0025 = 0.9975\n$$\n这个值已经用四位有效数字表示。\n\n最终答案要求将缩减比 $r$ 和内存节省分数 $S$ 以行矩阵的形式呈现。所需的值为 $r \\approx 0.05000$ 和 $S = 0.9975$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.05000  0.9975 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在体会了CBFM带来的效率提升后，本次练习将深入探讨该方法的核心机制。你将探索如何将完整的大规模系统投影到由特征基函数定义的较小子空间上，这一过程在数学上由伽辽金投影 $Z_r = T^H Z T$ 描述。通过将此原理应用于一个规模小且定义明确的例子，你将亲手实践简化系统矩阵的构建过程，从而揭开CBFM核心代数运算的神秘面紗。",
            "id": "3292539",
            "problem": "一个完美导电表面被划分为两个相邻的子域，每个子域都用三个 Rao–Wilton–Glisson (RWG) 基函数进行网格划分。未知的表面电流密度在这六个 RWG 函数中展开，并在电场积分方程 (EFIE) 的矩量法 (MoM) 离散化中进行测试。通过将 EFIE 算子投影到每个子域一个的两个复合特征基函数上，使用特征基函数法 (CBFM) 形成一个降阶模型，从而得到一个降阶的伽辽金系统。\n\n从频域中的麦克斯韦方程组和完美电导体边界条件出发，使用带有自由空间并矢格林函数的标准 EFIE，描述 RWG 基中的 MoM 伽辽金过程，然后解释 CBFM 投影如何在这两个复合特征基函数的张成空间上构造一个降阶算子。根据这些原理，推导两个复合特征基函数之间的降阶伽辽金算子的表达式，该表达式为测试的 RWG 展开与应用于 RWG 展开的 EFIE 算子之间的内积，并组装降阶的 $2 \\times 2$ 系统。\n\n对于角频率为 $\\omega$ 的对称配置，其中完整的 MoM 阻抗算子由分块矩阵近似\n$$\nZ \\in \\mathbb{C}^{6 \\times 6}\n=\n\\begin{pmatrix}\nZ_{11}  Z_{12} \\\\\nZ_{21}  Z_{22}\n\\end{pmatrix},\n$$\n其中\n$$\nZ_{11} = (5 + \\mathrm{i}\\,2)\\, I_{3}, \\quad\nZ_{22} = (4 + \\mathrm{i}\\,1)\\, I_{3}, \\quad\nZ_{12} = Z_{21}^{\\top} = (0.6 + \\mathrm{i}\\,0.3)\\, \\mathbf{1}_{3 \\times 3},\n$$\n其中 $I_{3}$ 是 $3 \\times 3$ 单位矩阵，$\\mathbf{1}_{3 \\times 3}$ 是 $3 \\times 3$ 的全一矩阵，考虑由以下矩阵的列表示的 RWG 展开中的两个复合特征基函数\n$$\nT \\in \\mathbb{R}^{6 \\times 2} =\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{3}}  0 \\\\\n\\frac{1}{\\sqrt{3}}  0 \\\\\n\\frac{1}{\\sqrt{3}}  0 \\\\\n0  \\frac{1}{\\sqrt{3}} \\\\\n0  \\frac{1}{\\sqrt{3}} \\\\\n0  \\frac{1}{\\sqrt{3}}\n\\end{pmatrix},\n$$\n使得第一个复合基函数是子域 $1$ 上的均匀组合，第二个是子域 $2$ 上的均匀组合，每个都由 $\\sqrt{3}$ 归一化。\n\n使用从第一性原理推导出的 CBFM 投影和降阶组装，构建降阶的 $2 \\times 2$ 伽辽金算子，并计算其行列式的实部。用 $\\mathrm{\\Omega}^{2}$ 表示最终值，并将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求从基本原理出发，推导特征基函数法 (CBFM) 中的降阶伽辽金算子，然后针对给定的全阻抗矩阵和一组复合基函数进行具体计算。\n\n分析始于频域中的麦克斯韦方程组，假设时间谐波依赖形式为 $\\exp(\\mathrm{i}\\omega t)$：\n$$\n\\nabla \\times \\mathbf{E}(\\mathbf{r}) = -\\mathrm{i}\\omega\\mu\\mathbf{H}(\\mathbf{r})\n$$\n$$\n\\nabla \\times \\mathbf{H}(\\mathbf{r}) = \\mathbf{J}(\\mathbf{r}) + \\mathrm{i}\\omega\\epsilon\\mathbf{E}(\\mathbf{r})\n$$\n其中 $\\mathbf{E}$ 是电场，$\\mathbf{H}$ 是磁场，$\\mathbf{J}$ 是电流密度，$\\omega$ 是角频率，$\\mu$ 和 $\\epsilon$ 分别是介质的磁导率和介电常数。\n\n对于一个受入射电场 $\\mathbf{E}^i$ 照射的完美电导体 (PEC) 表面 $S$，会产生感应表面电流 $\\mathbf{J}_s$。该电流产生一个散射场 $\\mathbf{E}^s$。PEC 表面上的边界条件是总切向电场必须为零：\n$$\n[\\mathbf{E}^i(\\mathbf{r}) + \\mathbf{E}^s(\\mathbf{r})]_{\\text{tan}} = 0 \\quad \\text{for } \\mathbf{r} \\in S\n$$\n散射场 $\\mathbf{E}^s$ 可以通过磁矢量势 $\\mathbf{A}$ 和标量电势 $\\Phi$ 用感应电流 $\\mathbf{J}_s$ 来表示：\n$$\n\\mathbf{E}^s(\\mathbf{r}) = -\\mathrm{i}\\omega\\mathbf{A}(\\mathbf{r}) - \\nabla\\Phi(\\mathbf{r})\n$$\n这些势通过自由空间并矢格林函数 $G(\\mathbf{r}, \\mathbf{r}') = \\frac{\\exp(-\\mathrm{i}k|\\mathbf{r}-\\mathbf{r}'|)}{4\\pi|\\mathbf{r}-\\mathbf{r}'|}$ 与表面源（$\\mathbf{J}_s$ 和表面电荷密度 $\\rho_s$）相关，其中 $k = \\omega\\sqrt{\\mu\\epsilon}$ 是波数。\n$$\n\\mathbf{A}(\\mathbf{r}) = \\mu \\int_S G(\\mathbf{r}, \\mathbf{r}') \\mathbf{J}_s(\\mathbf{r}') dS'\n$$\n$$\n\\Phi(\\mathbf{r}) = \\frac{1}{\\epsilon} \\int_S G(\\mathbf{r}, \\mathbf{r}') \\rho_s(\\mathbf{r}') dS'\n$$\n使用连续性方程 $\\nabla_s \\cdot \\mathbf{J}_s = -\\mathrm{i}\\omega\\rho_s$，我们可以通过强制执行 PEC 边界条件来写出电场积分方程 (EFIE)：\n$$\n[\\mathrm{i}\\omega\\mu \\int_S G(\\mathbf{r}, \\mathbf{r}') \\mathbf{J}_s(\\mathbf{r}') dS' + \\frac{\\mathrm{i}}{\\omega\\epsilon} \\nabla \\int_S G(\\mathbf{r}, \\mathbf{r}') (\\nabla'_s \\cdot \\mathbf{J}_s(\\mathbf{r}')) dS']_{\\text{tan}} = [\\mathbf{E}^i(\\mathbf{r})]_{\\text{tan}}\n$$\n我们定义线性算子 $\\mathcal{L}$，使得 EFIE 可以紧凑地写为 $\\mathcal{L}(\\mathbf{J}_s) = \\mathbf{E}^i_{\\text{tan}}$。\n\n在矩量法 (MoM) 中，未知电流 $\\mathbf{J}_s$ 在一组 $N$ 个基函数 $\\{\\mathbf{f}_n(\\mathbf{r})\\}_{n=1}^N$ 中展开，在本问题中这些基函数是 Rao–Wilton–Glisson (RWG) 函数。\n$$\n\\mathbf{J}_s(\\mathbf{r}) \\approx \\sum_{n=1}^{N} I_n \\mathbf{f}_n(\\mathbf{r})\n$$\n其中 $I_n$ 是未知的复系数。将此展开式代入 EFIE 并应用伽辽金法，我们用每个基函数 $\\mathbf{f}_m$ 来测试该方程。这涉及到取内积，定义为 $\\langle \\mathbf{a}, \\mathbf{b} \\rangle = \\int_S \\mathbf{a}^*(\\mathbf{r}) \\cdot \\mathbf{b}(\\mathbf{r}) dS$。结果是一个线性方程组：\n$$\n\\sum_{n=1}^{N} I_n \\langle \\mathbf{f}_m, \\mathcal{L}(\\mathbf{f}_n) \\rangle = \\langle \\mathbf{f}_m, \\mathbf{E}^i_{\\text{tan}} \\rangle \\quad \\text{for } m=1, \\dots, N\n$$\n该系统以矩阵形式写作 $Z I = V$，其中 $Z$ 是 $N \\times N$ 的阻抗矩阵，其元素为 $Z_{mn} = \\langle \\mathbf{f}_m, \\mathcal{L}(\\mathbf{f}_n) \\rangle$，$I$ 是系数 $I_n$ 的列向量，$V$ 是激励向量，其元素为 $V_m = \\langle \\mathbf{f}_m, \\mathbf{E}^i_{\\text{tan}} \\rangle$。注意，对于使用实基函数的伽辽金测试，内积中 $\\mathbf{f}_m$ 上的复共轭对于空间部分是无关紧要的，但内积是半双线性的。MoM 矩阵项的标准定义是 $Z_{mn}=\\int_S \\mathbf{f}_m \\cdot \\mathcal{L}(\\mathbf{f}_n) dS$。\n\n特征基函数法 (CBFM) 是一种模型降阶技术。电流 $\\mathbf{J}_s$ 由少量复合基函数近似，称为特征基函数 (CBF)，$\\{\\mathbf{\\Psi}_k\\}_{k=1}^P$，其中 $P \\ll N$。每个 CBF 是原始 RWG 基函数的线性组合：\n$$\n\\mathbf{\\Psi}_k(\\mathbf{r}) = \\sum_{n=1}^{N} T_{nk} \\mathbf{f}_n(\\mathbf{r})\n$$\n系数 $T_{nk}$ 构成一个 $N \\times P$ 的变换矩阵 $T$。现在电流近似为：\n$$\n\\mathbf{J}_s(\\mathbf{r}) \\approx \\sum_{k=1}^{P} \\alpha_k \\mathbf{\\Psi}_k(\\mathbf{r}) = \\sum_{k=1}^{P} \\alpha_k \\sum_{n=1}^{N} T_{nk} \\mathbf{f}_n(\\mathbf{r})\n$$\n这意味着 RWG 系数向量 $I$ 近似为 $I \\approx T\\alpha$，其中 $\\alpha$ 是未知系数 $\\alpha_k$ 的 $P \\times 1$ 向量。\n\n为了求 $\\alpha$，我们将 $I = T\\alpha$ 代入完整的系统 $ZI=V$，得到 $ZT\\alpha = V$。然后我们对这个降基表示使用伽辽金法，用 CBF 本身进行测试。测试函数 $\\mathbf{\\Psi}_j$ 在 RWG 基中表示为 $\\sum_m T_{mj} \\mathbf{f}_m$。降阶系统为：\n$$\n\\langle \\mathbf{\\Psi}_j, \\mathcal{L}(\\sum_{k=1}^P \\alpha_k \\mathbf{\\Psi}_k) \\rangle = \\langle \\mathbf{\\Psi}_j, \\mathbf{E}^i_{\\text{tan}} \\rangle \\quad \\text{for } j=1, \\dots, P\n$$\n降阶系统为 $Z_r \\alpha = V_r$。降阶阻抗矩阵 $Z_r$ 的元素为：\n$$\n(Z_r)_{jk} = \\langle \\mathbf{\\Psi}_j, \\mathcal{L}(\\mathbf{\\Psi}_k) \\rangle = \\langle \\sum_{m=1}^N T_{mj} \\mathbf{f}_m, \\mathcal{L}(\\sum_{n=1}^N T_{nk} \\mathbf{f}_n) \\rangle\n$$\n利用内积的半双线性性质和 $\\mathcal{L}$ 的线性性质：\n$$\n(Z_r)_{jk} = \\sum_{m=1}^N \\sum_{n=1}^N T_{mj}^* T_{nk} \\langle \\mathbf{f}_m, \\mathcal{L}(\\mathbf{f}_n) \\rangle = \\sum_{m=1}^N \\sum_{n=1}^N T_{mj}^* Z_{mn} T_{nk}\n$$\n在矩阵表示法中，这是 $Z_r = T^H Z T$，其中 $T^H$ 是 $T$ 的共轭转置。由于问题指定 $T \\in \\mathbb{R}^{6 \\times 2}$，其共轭转置就是其转置，即 $T^H = T^\\top$。所以，$Z_r = T^\\top Z T$。\n\n现在，我们对具体问题进行计算。给定 $N=6, P=2$。全阻抗矩阵为 $Z \\in \\mathbb{C}^{6 \\times 6}$，其分块为：$Z_{11} = (5 + \\mathrm{i}\\,2)\\, I_{3}$，$Z_{22} = (4 + \\mathrm{i}\\,1)\\, I_{3}$，以及 $Z_{12} = Z_{21}^{\\top} = (0.6 + \\mathrm{i}\\,0.3)\\, \\mathbf{1}_{3 \\times 3}$。因为 $\\mathbf{1}_{3 \\times 3}$ 是对称矩阵，$Z_{21}^{\\top} = Z_{12}$ 意味着 $Z_{21} = Z_{12}$。\n变换矩阵为 $T \\in \\mathbb{R}^{6 \\times 2}$：\n$$\nT =\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{3}}  0 \\\\\n\\frac{1}{\\sqrt{3}}  0 \\\\\n\\frac{1}{\\sqrt{3}}  0 \\\\\n0  \\frac{1}{\\sqrt{3}} \\\\\n0  \\frac{1}{\\sqrt{3}} \\\\\n0  \\frac{1}{\\sqrt{3}}\n\\end{pmatrix}\n$$\n我们可以将 $T$ 分块为 $T = \\begin{pmatrix} T_1 \\\\ T_2 \\end{pmatrix}$，其中 $T_1 = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 1  0 \\end{pmatrix}$ 和 $T_2 = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 0  1 \\\\ 0  1 \\\\ 0  1 \\end{pmatrix}$。\n降阶阻抗矩阵 $Z_r$ 计算如下：\n$$\nZ_r = T^\\top Z T = \\begin{pmatrix} T_1^\\top  T_2^\\top \\end{pmatrix} \\begin{pmatrix} Z_{11}  Z_{12} \\\\ Z_{21}  Z_{22} \\end{pmatrix} \\begin{pmatrix} T_1 \\\\ T_2 \\end{pmatrix} = T_1^\\top Z_{11} T_1 + T_1^\\top Z_{12} T_2 + T_2^\\top Z_{21} T_1 + T_2^\\top Z_{22} T_2\n$$\n设 $T$ 的列为 $\\mathbf{t}_1, \\mathbf{t}_2$。则 $(Z_r)_{jk} = \\mathbf{t}_j^\\top Z \\mathbf{t}_k$。\n$\\mathbf{t}_1 = \\frac{1}{\\sqrt{3}}[1,1,1,0,0,0]^\\top$ 且 $\\mathbf{t}_2 = \\frac{1}{\\sqrt{3}}[0,0,0,1,1,1]^\\top$。令 $\\mathbf{u} = [1,1,1]^\\top$。\n\n$(Z_r)_{11} = \\mathbf{t}_1^\\top Z \\mathbf{t}_1 = \\frac{1}{3} \\begin{pmatrix} \\mathbf{u}^\\top  \\mathbf{0}^\\top \\end{pmatrix} \\begin{pmatrix} Z_{11}  Z_{12} \\\\ Z_{21}  Z_{22} \\end{pmatrix} \\begin{pmatrix} \\mathbf{u} \\\\ \\mathbf{0} \\end{pmatrix} = \\frac{1}{3} \\mathbf{u}^\\top Z_{11} \\mathbf{u}$。\n$Z_{11} = (5 + \\mathrm{i}\\,2)I_3$，所以 $\\mathbf{u}^\\top Z_{11} \\mathbf{u} = (5 + \\mathrm{i}\\,2) \\mathbf{u}^\\top I_3 \\mathbf{u} = (5 + \\mathrm{i}\\,2) \\|\\mathbf{u}\\|^2 = 3(5 + \\mathrm{i}\\,2)$。\n$(Z_r)_{11} = \\frac{1}{3} \\times 3(5 + \\mathrm{i}\\,2) = 5 + \\mathrm{i}\\,2$。\n\n$(Z_r)_{22} = \\mathbf{t}_2^\\top Z \\mathbf{t}_2 = \\frac{1}{3} \\begin{pmatrix} \\mathbf{0}^\\top  \\mathbf{u}^\\top \\end{pmatrix} Z \\begin{pmatrix} \\mathbf{0} \\\\ \\mathbf{u} \\end{pmatrix} = \\frac{1}{3} \\mathbf{u}^\\top Z_{22} \\mathbf{u}$。\n$Z_{22} = (4 + \\mathrm{i}\\,1)I_3$，所以 $\\mathbf{u}^\\top Z_{22} \\mathbf{u} = (4 + \\mathrm{i}\\,1) \\|\\mathbf{u}\\|^2 = 3(4 + \\mathrm{i}\\,1)$。\n$(Z_r)_{22} = \\frac{1}{3} \\times 3(4 + \\mathrm{i}\\,1) = 4 + \\mathrm{i}\\,1$。\n\n$(Z_r)_{12} = \\mathbf{t}_1^\\top Z \\mathbf{t}_2 = \\frac{1}{3} \\begin{pmatrix} \\mathbf{u}^\\top  \\mathbf{0}^\\top \\end{pmatrix} Z \\begin{pmatrix} \\mathbf{0} \\\\ \\mathbf{u} \\end{pmatrix} = \\frac{1}{3} \\mathbf{u}^\\top Z_{12} \\mathbf{u}$。\n$Z_{12} = (0.6 + \\mathrm{i}\\,0.3)\\mathbf{1}_{3\\times3}$，所以 $\\mathbf{u}^\\top Z_{12} \\mathbf{u} = (0.6 + \\mathrm{i}\\,0.3) \\mathbf{u}^\\top \\mathbf{1}_{3\\times3} \\mathbf{u}$。\n$\\mathbf{1}_{3\\times3} \\mathbf{u} = [3,3,3]^\\top$，因此 $\\mathbf{u}^\\top (\\mathbf{1}_{3\\times3} \\mathbf{u}) = [1,1,1][3,3,3]^\\top = 9$。\n$\\mathbf{u}^\\top Z_{12} \\mathbf{u} = 9(0.6 + \\mathrm{i}\\,0.3) = 5.4 + \\mathrm{i}\\,2.7$。\n$(Z_r)_{12} = \\frac{1}{3} (5.4 + \\mathrm{i}\\,2.7) = 1.8 + \\mathrm{i}\\,0.9$。\n\n$(Z_r)_{21} = \\mathbf{t}_2^\\top Z \\mathbf{t}_1 = \\frac{1}{3} \\mathbf{u}^\\top Z_{21} \\mathbf{u}$。因为 $Z_{21} = Z_{12}$，所以 $(Z_r)_{21} = (Z_r)_{12}$。\n降阶的 $2 \\times 2$ 伽辽金算子为：\n$$\nZ_r = \\begin{pmatrix}\n5 + \\mathrm{i}\\,2  1.8 + \\mathrm{i}\\,0.9 \\\\\n1.8 + \\mathrm{i}\\,0.9  4 + \\mathrm{i}\\,1\n\\end{pmatrix}\n$$\n$Z_r$ 的行列式为：\n$$\n\\det(Z_r) = (5 + \\mathrm{i}\\,2)(4 + \\mathrm{i}\\,1) - (1.8 + \\mathrm{i}\\,0.9)^2\n$$\n第一项是：\n$$\n(5 + \\mathrm{i}\\,2)(4 + \\mathrm{i}\\,1) = (5 \\times 4 - 2 \\times 1) + \\mathrm{i}(5 \\times 1 + 2 \\times 4) = (20 - 2) + \\mathrm{i}(5 + 8) = 18 + \\mathrm{i}\\,13\n$$\n第二项是：\n$$\n(1.8 + \\mathrm{i}\\,0.9)^2 = 1.8^2 + 2(\\mathrm{i})(1.8)(0.9) + (\\mathrm{i}\\,0.9)^2 = 3.24 + \\mathrm{i}\\,3.24 - 0.81 = 2.43 + \\mathrm{i}\\,3.24\n$$\n因此，行列式为：\n$$\n\\det(Z_r) = (18 + \\mathrm{i}\\,13) - (2.43 + \\mathrm{i}\\,3.24) = (18 - 2.43) + \\mathrm{i}(13 - 3.24) = 15.57 + \\mathrm{i}\\,9.76\n$$\n问题要求行列式的实部，即：\n$$\n\\mathrm{Re}(\\det(Z_r)) = 15.57\n$$\n单位是阻抗的平方，或 $\\mathrm{\\Omega}^2$。数值 $15.57$ 已经给出四位有效数字。",
            "answer": "$$\\boxed{15.57}$$"
        },
        {
            "introduction": "在理解了具体示例的基础上，本次练习将焦点转移到一种更通用、更强大的分析形式：渐进复杂度分析。你将推导CBFM的计算成本如何随着问题规模 $N$ 的增长而变化，并将其与传统矩量法的成本进行比较。这个理论练习对于理解CBFM的长期效率和可扩展性至关重要，它揭示了该方法在处理电大尺寸问题时表现出卓越性能的根本原因。",
            "id": "3292582",
            "problem": "考虑用于完美电导体（PEC）散射体的频域电场积分方程（EFIE），该散射体通过Rao-Wilton-Glisson（RWG）基函数进行离散化。矩量法（MoM）产生一个稠密的阻抗矩阵 $\\mathbf{Z} \\in \\mathbb{C}^{N \\times N}$，其元素由RWG函数与并矢格林函数之间的逐对双线性形式定义。假设计算每个矩阵元素需要有限且有界的数值积分操作次数，该次数独立于$N$，因此构建$\\mathbf{Z}$的计算复杂度与总元素数量成正比。\n\n特征基函数法（CBFM）将RWG基函数划分为$P$个不相交的簇 $\\{\\mathcal{C}_p\\}_{p=1}^{P}$，每个簇 $\\mathcal{C}_p$ 包含 $n_{\\text{loc}} = N/P$ 个RWG函数。在簇$p$内部，构建$M_p$个特征基函数（CBF）$\\{\\boldsymbol{\\psi}_{p,\\mu}\\}_{\\mu=1}^{M_p}$，每个特征基函数表示为局部RWG函数的线性组合，并组装降阶阻抗矩阵 $\\mathbf{Z}_c \\in \\mathbb{C}^{M_{\\text{tot}} \\times M_{\\text{tot}}}$，其中 $M_{\\text{tot}} = \\sum_{p=1}^{P} M_p$。假设：\n- 由于有界复杂度的积分和固定阶数的核函数求值，$\\mathbf{Z}$的每个元素和$\\mathbf{Z}_c$的每个元素都可以在独立于$N$的常数时间内求值。\n- 降阶矩阵$\\mathbf{Z}_c$在块级别上是稠密的，大小为$M_p \\times M_q$的块$(p,q)$表示簇$p$和簇$q$上的CBF之间的相互作用。\n\n从这些假设和EFIE-MoM的构建出发，根据第一性原理，推导出一个关于组装$\\mathbf{Z}_c$的计算复杂度的计数论证（用簇级CBF数量$M_p$表示），并明确地将其与组装完整MoM矩阵$\\mathbf{Z}$的复杂度联系起来。\n\n现在考虑一个渐进标度模型，其中簇的数量随$N$扩展为$P(N) = N^{\\alpha}$ (对于某个固定的$\\alpha$，满足 $0  \\alpha  1$)，并且每个簇的CBF数量扩展为$M_p \\equiv M(N) = c \\left(\\frac{N}{P(N)}\\right)^{\\beta}$ (对于常数 $c > 0$ 和 $0  \\beta  1$)，在所有簇中均相同。定义渐进相对成本\n$$\nR(N) \\equiv \\frac{\\text{组装}\\mathbf{Z}_c\\text{的成本}}{\\text{组装}\\mathbf{Z}\\text{的成本}}。\n$$\n在上述假设下，将$R(N)$表示为一个乘以常数因子的$N$的闭式幂律形式，用$\\alpha$、$\\beta$和$c$表示。\n\n最后，对特定值 $\\alpha = \\frac{3}{8}$、$\\beta = \\frac{1}{2}$ 和 $c=5$ 计算此闭式表达式。给出$R(N)$的最终答案，形式为单个解析表达式。无需四舍五入，也无物理单位适用。",
            "solution": "必须首先根据指定标准验证问题陈述。\n\n### 第一步：提取已知条件\n- **背景：** 用于完美电导体散射体的频域电场积分方程（EFIE）。\n- **离散化：** Rao-Wilton-Glisson（RWG）基函数，总数为$N$。\n- **矩量法（MoM）矩阵：** $\\mathbf{Z} \\in \\mathbb{C}^{N \\times N}$，稠密矩阵。\n- **$\\mathbf{Z}$的复杂度：** 组装$\\mathbf{Z}$的计算复杂度与总元素数量（$N^2$）成正比。每个矩阵元素的计算耗时有限且有界，独立于$N$。\n- **特征基函数法（CBFM）设置：**\n    - $N$个RWG基函数被划分为$P$个不相交的簇 $\\{\\mathcal{C}_p\\}_{p=1}^{P}$。\n    - 每个簇有 $n_{\\text{loc}} = N/P$ 个RWG函数。\n    - 簇$p$有$M_p$个特征基函数（CBF）。\n    - 降阶阻抗矩阵为 $\\mathbf{Z}_c \\in \\mathbb{C}^{M_{\\text{tot}} \\times M_{\\text{tot}}}$。\n    - CBF总数为 $M_{\\text{tot}} = \\sum_{p=1}^{P} M_p$。\n- **$\\mathbf{Z}_c$的复杂度：** $\\mathbf{Z}_c$的每个元素都可以在独立于$N$的常数时间内求值。降阶矩阵$\\mathbf{Z}_c$是稠密的。\n- **渐进标度定律：**\n    - 簇的数量：$P(N) = N^{\\alpha}$，对于常数$\\alpha$，$0  \\alpha  1$。\n    - 每个簇的CBF数量：对于所有$p$，$M_p \\equiv M(N) = c \\left(\\frac{N}{P(N)}\\right)^{\\beta}$，其中$c > 0$和$0  \\beta  1$是常数。\n- **目标：**\n    1.  推导组装$\\mathbf{Z}_c$的计算复杂度，并将其与组装$\\mathbf{Z}$的复杂度关联起来。\n    2.  定义渐进相对成本$R(N) \\equiv \\frac{\\text{组装}\\mathbf{Z}_c\\text{的成本}}{\\text{组装}\\mathbf{Z}\\text{的成本}}$。\n    3.  将$R(N)$表示为$N$的闭式幂律形式。\n    4.  对$\\alpha = \\frac{3}{8}$、$\\beta = \\frac{1}{2}$和$c = 5$计算该表达式。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学性：** 该问题设置在计算电磁学这一成熟领域。EFIE、MoM、RWG基函数和CBFM等概念都是标准的且描述正确。复杂度模型是此类分析的标准模型。该问题在科学上是合理的。\n- **良构性：** 所有必要的变量（$N, P, M_p, M_{\\text{tot}}$）、常数（$\\alpha, \\beta, c$）、定义（标度定律, $R(N)$）和假设（常数时间元素求值）都已提供。问题具体，并导向唯一的数学解。\n- **目标：** 问题使用精确的技术语言表述，没有任何主观性或歧义。\n\n问题陈述没有违反任何无效性标准。它具有科学依据、形式化陈述、自包含且良构。\n\n### 第三步：结论与行动\n该问题有效。将提供完整解答。\n\n问题的核心是基于待计算矩阵元素数量的计算复杂度计数论证。\n\n完整的MoM阻抗矩阵$\\mathbf{Z}$的维度为$N \\times N$。由于它是稠密的，它有$N^2$个元素。问题陈述指出，计算每个元素的成本是一个独立于$N$的常数。设这个常数成本为$K$。因此，组装$\\mathbf{Z}$的总成本是：\n$$\n\\text{Cost}(\\mathbf{Z}) = K N^2\n$$\n\nCBFM降阶阻抗矩阵$\\mathbf{Z}_c$的维度为$M_{\\text{tot}} \\times M_{\\text{tot}}$。问题陈述指出，这个矩阵也是稠密的，并且它的每个元素都可以在常数时间内求值。问题的“计数论证”性质意味着我们应将此常数成本视为相同的基本工作单位$K$。因此，组装$\\mathbf{Z}_c$的总成本是：\n$$\n\\text{Cost}(\\mathbf{Z}_c) = K (M_{\\text{tot}})^2\n$$\n\n渐进相对成本$R(N)$定义为这两个成本的比率：\n$$\nR(N) = \\frac{\\text{Cost}(\\mathbf{Z}_c)}{\\text{Cost}(\\mathbf{Z})} = \\frac{K (M_{\\text{tot}})^2}{K N^2} = \\frac{(M_{\\text{tot}})^2}{N^2}\n$$\n\n为了继续，我们必须将$M_{\\text{tot}}$表示为$N$的函数。CBF的总数$M_{\\text{tot}}$是每个簇的CBF数量之和。由于假设每个簇的CBF数量$M_p$对于所有$P$个簇都是相同的，我们有$M_p = M(N)$，对于所有$p=1, \\dots, P$。\n$$\nM_{\\text{tot}}(N) = \\sum_{p=1}^{P} M_p = P(N) \\cdot M(N)\n$$\n\n问题给出了$P(N)$和$M(N)$的渐进标度定律：\n1.  簇的数量：$P(N) = N^{\\alpha}$\n2.  每个簇的CBF数量：$M(N) = c \\left(\\frac{N}{P(N)}\\right)^{\\beta}$\n\n首先，我们将$P(N)$的表达式代入$M(N)$的表达式中：\n$$\nM(N) = c \\left(\\frac{N}{N^{\\alpha}}\\right)^{\\beta} = c (N^{1-\\alpha})^{\\beta} = c N^{\\beta(1-\\alpha)}\n$$\n\n接下来，我们将$P(N)$和$M(N)$的表达式代入$M_{\\text{tot}}(N)$的公式中：\n$$\nM_{\\text{tot}}(N) = P(N) \\cdot M(N) = (N^{\\alpha}) \\cdot (c N^{\\beta(1-\\alpha)}) = c N^{\\alpha + \\beta(1-\\alpha)} = c N^{\\alpha + \\beta - \\alpha\\beta}\n$$\n\n现在我们得到了$M_{\\text{tot}}$作为$N$的函数。我们可以将其代入相对成本$R(N)$的表达式中：\n$$\nR(N) = \\frac{(M_{\\text{tot}}(N))^2}{N^2} = \\frac{(c N^{\\alpha + \\beta - \\alpha\\beta})^2}{N^2} = \\frac{c^2 (N^{\\alpha + \\beta - \\alpha\\beta})^2}{N^2} = \\frac{c^2 N^{2(\\alpha + \\beta - \\alpha\\beta)}}{N^2}\n$$\n使用指数定律，我们合并包含$N$的项：\n$$\nR(N) = c^2 N^{2(\\alpha + \\beta - \\alpha\\beta) - 2}\n$$\n这就是所求的相对成本关于$\\alpha$、$\\beta$和$c$的闭式幂律表达式。\n\n最后，我们使用给定的具体值计算此表达式：$\\alpha = \\frac{3}{8}$，$\\beta = \\frac{1}{2}$，和$c = 5$。\n\n首先，我们计算指数$2(\\alpha + \\beta - \\alpha\\beta) - 2$：\n$$\n\\alpha + \\beta - \\alpha\\beta = \\frac{3}{8} + \\frac{1}{2} - \\left(\\frac{3}{8}\\right)\\left(\\frac{1}{2}\\right) = \\frac{3}{8} + \\frac{4}{8} - \\frac{3}{16} = \\frac{7}{8} - \\frac{3}{16} = \\frac{14}{16} - \\frac{3}{16} = \\frac{11}{16}\n$$\n完整的指数是：\n$$\n2\\left(\\frac{11}{16}\\right) - 2 = \\frac{11}{8} - 2 = \\frac{11}{8} - \\frac{16}{8} = -\\frac{5}{8}\n$$\n接下来，我们计算常数因子$c^2$：\n$$\nc^2 = 5^2 = 25\n$$\n结合这些结果，我们得到$R(N)$的最终表达式：\n$$\nR(N) = 25 N^{-5/8}\n$$",
            "answer": "$$\n\\boxed{25 N^{-\\frac{5}{8}}}\n$$"
        }
    ]
}