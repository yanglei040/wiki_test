{
    "hands_on_practices": [
        {
            "introduction": "Understanding higher-order basis functions begins with their construction. This exercise provides a concrete, step-by-step walkthrough of creating a $p=2$ Nedelec basis function on a reference tetrahedron, starting from the fundamental lowest-order Whitney form. By explicitly calculating the vector field and its curl, you will gain direct insight into the structure of these functions and why they are well-suited for discretizing Maxwell's equations. ",
            "id": "3313865",
            "problem": "Consider the reference tetrahedron $T$ used in computational electromagnetics finite element formulations, with vertices $v_{0}=(0,0,0)$, $v_{1}=(1,0,0)$, $v_{2}=(0,1,0)$, and $v_{3}=(0,0,1)$, and the oriented edge $[v_{0},v_{1}]$ taken from $v_{0}$ to $v_{1}$. Let $\\lambda_{0}$, $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$ denote the barycentric coordinates on $T$, and let $\\nabla\\lambda_{a}$ denote their gradients.\n\nIn higher-order curl-conforming finite elements used for solving Maxwell’s equations, the Nedelec first-kind (edge) shape functions are constructed from the Whitney $1$-forms associated with oriented edges and scalar polynomials. Using the fundamental definitions of barycentric coordinates and Whitney $1$-forms, and respecting the given edge orientation, perform the following:\n\n1. Construct two explicit $p=2$ Nedelec first-kind edge shape functions on $T$ associated with the oriented edge $[v_{0},v_{1}]$ by multiplying the Whitney $1$-form for $[v_{0},v_{1}]$ by each of the scalar linear polynomials $\\lambda_{0}$ and $\\lambda_{1}$. Write each shape function explicitly as a vector field in $(x,y,z)$-coordinates.\n\n2. Compute the curl of each of the two shape functions from part 1 explicitly.\n\n3. Compute the integral over $T$ of the squared magnitude of the curl of the shape function constructed with the scalar factor $\\lambda_{1}$, namely,\n$$\n\\int_{T} \\left\\| \\nabla \\times \\big(\\lambda_{1} \\, \\mathbf{w}_{01}\\big) \\right\\|^{2} \\, \\mathrm{d}V,\n$$\nand express the final result as an exact value (no rounding).\n\nYour final answer should be the single value of the integral in part 3, expressed in exact form without units.",
            "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n-   **Geometry**: Reference tetrahedron $T$ with vertices $v_{0}=(0,0,0)$, $v_{1}=(1,0,0)$, $v_{2}=(0,1,0)$, and $v_{3}=(0,0,1)$.\n-   **Edge**: Oriented edge $[v_{0},v_{1}]$.\n-   **Coordinates**: Barycentric coordinates $\\lambda_{0}$, $\\lambda_{1}$, $\\lambda_{2}$, $\\lambda_{3}$.\n-   **Context**: Higher-order ($p=2$) Nedelec first-kind (edge) curl-conforming finite elements.\n-   **Task 1**: Construct two shape functions by multiplying the Whitney 1-form for $[v_{0},v_{1}]$, denoted $\\mathbf{w}_{01}$, by the scalar linear polynomials $\\lambda_{0}$ and $\\lambda_{1}$.\n-   **Task 2**: Compute the curl of each of the two constructed shape functions.\n-   **Task 3**: Compute the integral $\\int_{T} \\left\\| \\nabla \\times \\big(\\lambda_{1} \\, \\mathbf{w}_{01}\\big) \\right\\|^{2} \\, \\mathrm{d}V$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is well-grounded in a standard area of applied mathematics and engineering, namely the finite element method for computational electromagnetics. The concepts of barycentric coordinates, Whitney forms (lowest-order Nedelec elements), and higher-order element construction are fundamental and correctly stated.\n-   **Well-Posedness**: The problem is well-posed. The geometry is explicitly defined, the functions to be constructed are specified by a standard procedure, and the final quantity to be computed is a well-defined definite integral. All information required for a unique solution is present.\n-   **Objectivity**: The problem is stated in objective, mathematical language, free from ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A complete solution will be provided.\n\n***\n\nThe solution proceeds by first defining the barycentric coordinates and their gradients for the specified reference tetrahedron. Then, the Whitney $1$-form for the edge $[v_{0},v_{1}]$ is constructed. Subsequently, the two requested higher-order shape functions and their curls are derived. Finally, the specified integral is computed.\n\nA point $\\mathbf{r} = (x,y,z)$ inside the tetrahedron $T$ can be expressed using barycentric coordinates $\\lambda_i$ as $\\mathbf{r} = \\sum_{i=0}^{3} \\lambda_i v_i$, with $\\sum_{i=0}^{3} \\lambda_i = 1$. Given the vertices $v_{0}=(0,0,0)$, $v_{1}=(1,0,0)$, $v_{2}=(0,1,0)$, and $v_3=(0,0,1)$, this becomes:\n$$\n(x,y,z) = \\lambda_0(0,0,0) + \\lambda_1(1,0,0) + \\lambda_2(0,1,0) + \\lambda_3(0,0,1) = (\\lambda_1, \\lambda_2, \\lambda_3).\n$$\nThus, we have $\\lambda_1 = x$, $\\lambda_2 = y$, and $\\lambda_3 = z$. The fourth coordinate is determined by the summation constraint: $\\lambda_0 = 1 - \\lambda_1 - \\lambda_2 - \\lambda_3 = 1-x-y-z$.\n\nThe gradients of the barycentric coordinates are constant vectors:\n$$\n\\nabla \\lambda_0 = (-1, -1, -1) \\\\\n\\nabla \\lambda_1 = (1, 0, 0) \\\\\n\\nabla \\lambda_2 = (0, 1, 0) \\\\\n\\nabla \\lambda_3 = (0, 0, 1)\n$$\n\nThe Whitney $1$-form, or lowest-order Nedelec edge function, associated with the oriented edge $[v_i, v_j]$ is given by $\\mathbf{w}_{ij} = \\lambda_i \\nabla \\lambda_j - \\lambda_j \\nabla \\lambda_i$. For the edge $[v_{0}, v_{1}]$, this is:\n$$\n\\mathbf{w}_{01} = \\lambda_0 \\nabla \\lambda_1 - \\lambda_1 \\nabla \\lambda_0 = (1-x-y-z)(1,0,0) - x(-1,-1,-1) = (1-x-y-z+x, x, x) = (1-y-z, x, x).\n$$\n\n**1. Construction of Higher-Order Shape Functions**\n\nThe two $p=2$ Nedelec shape functions associated with the edge $[v_{0},v_{1}]$ are formed by multiplying $\\mathbf{w}_{01}$ by $\\lambda_{0}$ and $\\lambda_{1}$. Let's denote them $\\mathbf{N}_A$ and $\\mathbf{N}_B$.\n\nFunction A (using $\\lambda_0$):\n$$\n\\mathbf{N}_A = \\lambda_0 \\mathbf{w}_{01} = (1-x-y-z)(1-y-z, x, x) = \\big( (1-y-z)^2 - x(1-y-z), x(1-x-y-z), x(1-x-y-z) \\big).\n$$\n\nFunction B (using $\\lambda_1$):\n$$\n\\mathbf{N}_B = \\lambda_1 \\mathbf{w}_{01} = x(1-y-z, x, x) = (x-xy-xz, x^2, x^2).\n$$\n\n**2. Computation of Curls**\n\nWe use the vector identity $\\nabla \\times (f \\mathbf{F}) = (\\nabla f) \\times \\mathbf{F} + f(\\nabla \\times \\mathbf{F})$.\nFirst, we compute the curl of the Whitney form $\\mathbf{w}_{01}$.\n$$\n\\nabla \\times \\mathbf{w}_{01} = \\nabla \\times (\\lambda_0 \\nabla \\lambda_1 - \\lambda_1 \\nabla \\lambda_0) = (\\nabla \\lambda_0 \\times \\nabla \\lambda_1) - (\\nabla \\lambda_1 \\times \\nabla \\lambda_0) = 2(\\nabla \\lambda_0 \\times \\nabla \\lambda_1).\n$$\nThe cross product of the gradients is:\n$$\n\\nabla \\lambda_0 \\times \\nabla \\lambda_1 = (-1, -1, -1) \\times (1, 0, 0) = \\begin{vmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ -1  -1  -1 \\\\ 1  0  0 \\end{vmatrix} = (0, -1, 1).\n$$\nThus, the curl of the Whitney form is a constant vector:\n$$\n\\nabla \\times \\mathbf{w}_{01} = 2(0, -1, 1) = (0, -2, 2).\n$$\nNow we compute the curls of $\\mathbf{N}_A$ and $\\mathbf{N}_B$.\n\nCurl of $\\mathbf{N}_A$:\n$$\n\\nabla \\times \\mathbf{N}_A = \\nabla \\times (\\lambda_0 \\mathbf{w}_{01}) = (\\nabla \\lambda_0) \\times \\mathbf{w}_{01} + \\lambda_0 (\\nabla \\times \\mathbf{w}_{01}).\n$$\nThe first term is:\n$$\n(\\nabla \\lambda_0) \\times \\mathbf{w}_{01} = (-1, -1, -1) \\times (1-y-z, x, x) = \\begin{vmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ -1  -1  -1 \\\\ 1-y-z  x  x \\end{vmatrix} = (0, x-1+y+z, 1-x-y-z) = (0, -\\lambda_0, \\lambda_0).\n$$\nCombining the terms:\n$$\n\\nabla \\times \\mathbf{N}_A = (0, -\\lambda_0, \\lambda_0) + \\lambda_0(0, -2, 2) = (0, -3\\lambda_0, 3\\lambda_0) = (0, 3x+3y+3z-3, 3-3x-3y-3z).\n$$\n\nCurl of $\\mathbf{N}_B$:\n$$\n\\nabla \\times \\mathbf{N}_B = \\nabla \\times (\\lambda_1 \\mathbf{w}_{01}) = (\\nabla \\lambda_1) \\times \\mathbf{w}_{01} + \\lambda_1 (\\nabla \\times \\mathbf{w}_{01}).\n$$\nThe first term is:\n$$\n(\\nabla \\lambda_1) \\times \\mathbf{w}_{01} = (1, 0, 0) \\times (1-y-z, x, x) = \\begin{vmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ 1  0  0 \\\\ 1-y-z  x  x \\end{vmatrix} = (0, -x, x).\n$$\nIn terms of barycentric coordinates, this is $(0, -\\lambda_1, \\lambda_1)$.\nCombining the terms:\n$$\n\\nabla \\times \\mathbf{N}_B = (0, -\\lambda_1, \\lambda_1) + \\lambda_1(0, -2, 2) = (0, -3\\lambda_1, 3\\lambda_1) = (0, -3x, 3x).\n$$\n\n**3. Computation of the Integral**\n\nThe problem asks for the evaluation of $I = \\int_{T} \\left\\| \\nabla \\times \\big(\\lambda_{1} \\, \\mathbf{w}_{01}\\big) \\right\\|^{2} \\, \\mathrm{d}V$.\nFrom the previous step, $\\nabla \\times (\\lambda_{1} \\, \\mathbf{w}_{01}) = (0, -3x, 3x)$.\nIts squared magnitude is:\n$$\n\\left\\| (0, -3x, 3x) \\right\\|^2 = (0)^2 + (-3x)^2 + (3x)^2 = 9x^2 + 9x^2 = 18x^2.\n$$\nThe integral becomes:\n$$\nI = \\int_T 18x^2 \\, \\mathrm{d}V.\n$$\nWe can evaluate this integral using the standard formula for integration of polynomials over a simplex, expressed in barycentric coordinates. The integrand in barycentric coordinates is $18\\lambda_1^2$. The formula is:\n$$\n\\int_T \\lambda_0^{a_0} \\lambda_1^{a_1} \\lambda_2^{a_2} \\lambda_3^{a_3} \\, \\mathrm{d}V = n! V_T \\frac{a_0! a_1! a_2! a_3!}{(a_0+a_1+a_2+a_3+n)!}\n$$\nwhere $n=3$ is the spatial dimension and $V_T$ is the volume of the tetrahedron. For the given vertices, the volume is $V_T = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right| = \\frac{1}{6}$.\nOur integral is $18 \\int_T \\lambda_1^2 \\, \\mathrm{d}V$, which corresponds to $a_1=2$ and $a_0=a_2=a_3=0$.\n$$\nI = 18 \\left( 3! \\cdot V_T \\cdot \\frac{0! \\, 2! \\, 0! \\, 0!}{(0+2+0+0+3)!} \\right) = 18 \\left( 6 \\cdot \\frac{1}{6} \\cdot \\frac{1 \\cdot 2 \\cdot 1 \\cdot 1}{5!} \\right) = 18 \\left( 1 \\cdot \\frac{2}{120} \\right) = 18 \\left( \\frac{1}{60} \\right).\n$$\n$$\nI = \\frac{18}{60} = \\frac{3}{10}.\n$$\n\nFor completeness, we can verify this result using direct integration in Cartesian coordinates. The domain of integration is $x \\in [0,1]$, $y \\in [0, 1-x]$, $z \\in [0, 1-x-y]$.\n$$\nI = \\int_0^1 \\int_0^{1-x} \\int_0^{1-x-y} 18x^2 \\, \\mathrm{d}z \\, \\mathrm{d}y \\, \\mathrm{d}x\n$$\n$$\nI = 18 \\int_0^1 x^2 \\int_0^{1-x} [z]_0^{1-x-y} \\, \\mathrm{d}y \\, \\mathrm{d}x = 18 \\int_0^1 x^2 \\int_0^{1-x} (1-x-y) \\, \\mathrm{d}y \\, \\mathrm{d}x\n$$\n$$\nI = 18 \\int_0^1 x^2 \\left[ (1-x)y - \\frac{y^2}{2} \\right]_0^{1-x} \\, \\mathrm{d}x = 18 \\int_0^1 x^2 \\left( (1-x)^2 - \\frac{(1-x)^2}{2} \\right) \\, \\mathrm{d}x\n$$\n$$\nI = 18 \\int_0^1 x^2 \\frac{(1-x)^2}{2} \\, \\mathrm{d}x = 9 \\int_0^1 x^2(1 - 2x + x^2) \\, \\mathrm{d}x = 9 \\int_0^1 (x^2 - 2x^3 + x^4) \\, \\mathrm{d}x\n$$\n$$\nI = 9 \\left[ \\frac{x^3}{3} - \\frac{2x^4}{4} + \\frac{x^5}{5} \\right]_0^1 = 9 \\left( \\frac{1}{3} - \\frac{1}{2} + \\frac{1}{5} \\right) = 9 \\left( \\frac{10 - 15 + 6}{30} \\right) = 9 \\left( \\frac{1}{30} \\right) = \\frac{9}{30} = \\frac{3}{10}.\n$$\nBoth methods yield the same result, confirming the calculation.",
            "answer": "$$\\boxed{\\frac{3}{10}}$$"
        },
        {
            "introduction": "After constructing individual basis functions, the next step is to understand how they form a complete set. This practice shifts focus from a single function to the entire hierarchical structure of the $H(\\mathrm{curl})$ space for a higher polynomial order, $p=4$. You will dissect this space by enumerating the distinct types of modes—edge, gradient-based interior, and rotational interior—to see how they collectively provide the necessary degrees of freedom. ",
            "id": "3313860",
            "problem": "Consider the reference triangle $T$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$, and let $\\lambda_{1}$, $\\lambda_{2}$, $\\lambda_{3}$ denote its barycentric coordinates. Let $\\mathcal{N}_{p}(T)$ denote the two-dimensional Nédélec first-kind $H(\\mathrm{curl})$ space of polynomial order $p$ on $T$, and consider a hierarchical construction of higher-order basis functions. For $p=4$, carry out the following tasks:\n- Enumerate the number of hierarchical edge modes associated to each of the $3$ edges, where an edge mode is characterized by a nonzero tangential trace and is associated with moments against edge polynomials of degree $\\leq p-1$.\n- Within the triangle interior (the face), partition the hierarchical modes into two disjoint families:\n  1. A gradient-type (irrotational) family obtained as $\\nabla \\varphi$ with $\\varphi$ a scalar hierarchical face polynomial whose tangential trace vanishes (i.e., the trace of $\\varphi$ is constant on each edge).\n  2. A complementary rotational bubble family of interior modes that have zero tangential trace but are not gradients of such scalars.\n- Using only well-tested identities for dimensions of polynomial spaces on triangles and the de Rham exact sequence for polynomial spaces, verify that the total number of modes equals the known dimension of $\\mathcal{N}_{p}(T)$ at $p=4$.\n\nState as your final answer the total number of $H(\\mathrm{curl})$ basis modes for $p=4$ on $T$. No rounding is required. Report a single integer with no units.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the theory of finite element methods for computational electromagnetics, is well-posed, objective, and internally consistent.\n\nThe problem asks for the enumeration and verification of hierarchical basis modes for the two-dimensional Nédélec first-kind space of order $p$, $\\mathcal{N}_p(T)$, on a reference triangle $T$, for the specific case where $p=4$. The total number of basis functions, or modes, corresponds to the dimension of the space, $\\dim(\\mathcal{N}_p(T))$.\n\nFirst, we establish the dimension of $\\mathcal{N}_p(T)$. The degrees of freedom (DoFs) that uniquely define a vector polynomial field $\\mathbf{u} \\in \\mathcal{N}_p(T)$ are given by:\n$1$. Moments of the tangential component along each of the $3$ edges against polynomials of degree up to $p-1$:\n$$ \\int_e (\\mathbf{u} \\cdot \\mathbf{t}) q \\, ds, \\quad \\forall q \\in \\mathcal{P}_{p-1}(e) $$\nThe dimension of the polynomial space $\\mathcal{P}_{k}(e)$ on an edge (a $1$-dimensional interval) is $k+1$. Thus, for each edge, we have $\\dim(\\mathcal{P}_{p-1}(e)) = (p-1)+1 = p$ DoFs. With $3$ edges, this accounts for $3p$ modes, which are termed edge modes.\n\n$2$. Moments of the vector field over the triangle interior (face) against vector polynomials of degree up to $p-2$:\n$$ \\int_T \\mathbf{u} \\cdot \\mathbf{v} \\, dA, \\quad \\forall \\mathbf{v} \\in (\\mathcal{P}_{p-2}(T))^2 $$\nThe dimension of the scalar polynomial space $\\mathcal{P}_k(T)$ on a triangle is $\\binom{k+2}{2}$. The dimension of the vector polynomial space $(\\mathcal{P}_{p-2}(T))^2$ is $2 \\times \\dim(\\mathcal{P}_{p-2}(T)) = 2 \\binom{(p-2)+2}{2} = 2\\binom{p}{2} = p(p-1)$. These are the interior or face modes.\n\nThe total dimension of $\\mathcal{N}_p(T)$ is the sum of these DoFs:\n$$ \\dim(\\mathcal{N}_p(T)) = 3p + p(p-1) = 3p + p^2 - p = p^2 + 2p $$\nFor the specified order $p=4$, the dimension is:\n$$ \\dim(\\mathcal{N}_4(T)) = 4^2 + 2(4) = 16 + 8 = 24 $$\n\nNow, we perform the tasks requested in the problem.\n\n**Task 1: Enumerate Edge Modes**\nThe hierarchical edge modes are associated with the DoFs on the edges of the triangle. As determined above, for each of the $3$ edges, the basis functions must be able to represent any tangential trace in the space $\\mathcal{P}_{p-1}(e)$. The dimension of this space is $p$. Therefore, for each edge, there are $p$ associated modes.\nFor $p=4$, the number of hierarchical edge modes associated with each of the $3$ edges is $4$. The total number of edge modes is $3 \\times 4 = 12$.\n\n**Task 2: Partition and Enumerate Interior Modes**\nThe interior modes correspond to basis functions whose tangential trace is zero on all $3$ edges of the triangle. The total number of interior modes is the total dimension minus the number of edge modes:\n$$ \\text{Number of interior modes} = (p^2+2p) - 3p = p(p-1) $$\nFor $p=4$, there are $4(4-1) = 12$ interior modes. These are partitioned into two families.\n\nFamily 1: Gradient-type (irrotational) modes.\nThese modes are of the form $\\nabla \\varphi$, where $\\varphi$ is a scalar hierarchical face polynomial. For the tangential trace of $\\nabla \\varphi$ to vanish, i.e., $\\mathbf{t} \\cdot \\nabla \\varphi = 0$ on $\\partial T$, the scalar potential $\\varphi$ must be constant on each edge. Since a hierarchical face function is by definition zero on the entire boundary $\\partial T$, this condition is satisfied. The space of such scalar polynomials $\\varphi$ that are of degree at most $p$ and vanish on $\\partial T$ is the space of bubble functions $\\mathcal{P}_p^0(T)$. This space can be characterized as:\n$$ \\mathcal{P}_p^0(T) = \\lambda_1 \\lambda_2 \\lambda_3 \\mathcal{P}_{p-3}(T) $$\nwhere $\\lambda_1, \\lambda_2, \\lambda_3$ are the barycentric coordinates of the triangle $T$. The dimension of this space is the dimension of $\\mathcal{P}_{p-3}(T)$.\n$$ \\dim(\\mathcal{P}_p^0(T)) = \\dim(\\mathcal{P}_{p-3}(T)) = \\binom{(p-3)+2}{2} = \\binom{p-1}{2} $$\nFor $p=4$, the number of gradient-type interior modes is:\n$$ \\dim(\\mathcal{P}_{4-3}(T)) = \\dim(\\mathcal{P}_1(T)) = \\binom{1+2}{2} = \\binom{3}{2} = 3 $$\nSo, there are $3$ gradient-type interior modes.\n\nFamily 2: Complementary rotational bubble modes.\nThese are the remaining interior modes. Their number is the total number of interior modes minus the number of gradient-type modes.\n$$ \\text{Number of rotational modes} = p(p-1) - \\binom{p-1}{2} $$\nFor $p=4$, this is:\n$$ 12 - 3 = 9 $$\nThus, there are $9$ rotational interior modes.\n\n**Task 3: Verification**\nWe sum the number of modes from all categories:\nTotal modes = (Edge modes) + (Gradient interior modes) + (Rotational interior modes)\n$$ \\text{Total for } p=4: \\quad 12 + 3 + 9 = 24 $$\nThis total of $24$ matches the dimension $\\dim(\\mathcal{N}_4(T)) = 24$ calculated earlier.\n\nWe can also verify this dimension using the polynomial de Rham exact sequence. For a two-dimensional contractible domain $T$, the sequence is:\n$$ 0 \\rightarrow \\mathbb{R} \\xrightarrow{\\subset} \\mathcal{P}_p(T) \\xrightarrow{\\nabla} \\mathcal{N}_p(T) \\xrightarrow{\\mathrm{curl}} \\mathcal{P}_{p-1}(T) \\rightarrow 0 $$\nThe alternating sum of the dimensions of the spaces in an exact sequence is zero:\n$$ \\dim(\\mathbb{R}) - \\dim(\\mathcal{P}_p(T)) + \\dim(\\mathcal{N}_p(T)) - \\dim(\\mathcal{P}_{p-1}(T)) = 0 $$\n$$ 1 - \\binom{p+2}{2} + \\dim(\\mathcal{N}_p(T)) - \\binom{(p-1)+2}{2} = 0 $$\nSolving for $\\dim(\\mathcal{N}_p(T))$:\n$$ \\dim(\\mathcal{N}_p(T)) = \\binom{p+2}{2} + \\binom{p+1}{2} - 1 $$\nFor $p=4$:\n$$ \\dim(\\mathcal{N}_4(T)) = \\binom{4+2}{2} + \\binom{4+1}{2} - 1 = \\binom{6}{2} + \\binom{5}{2} - 1 $$\n$$ \\dim(\\mathcal{N}_4(T)) = \\frac{6 \\cdot 5}{2} + \\frac{5 \\cdot 4}{2} - 1 = 15 + 10 - 1 = 24 $$\nThis confirms the result obtained by counting the hierarchical modes. The total number of $H(\\mathrm{curl})$ basis modes for $p=4$ on $T$ is $24$.",
            "answer": "$$\\boxed{24}$$"
        },
        {
            "introduction": "Bridging the gap between the abstract theory of basis functions and their practical implementation in a finite element code is a critical skill. This exercise addresses a key computational question: how do we accurately and efficiently compute the integrals that form the system matrices? By analyzing how basis functions and their curls transform under an affine mapping, you will determine the precise polynomial degree of the integrands, which in turn dictates the minimum required order for numerical quadrature. ",
            "id": "3313862",
            "problem": "Consider a frequency-domain computational electromagnetics formulation on a single three-dimensional tetrahedral element. Let the material coefficients be elementwise constant, with electric permittivity denoted by $\\varepsilon$ and magnetic permeability denoted by $\\mu$. The weak forms use trial and test functions from the Sobolev space of square-integrable vector fields with square-integrable curl, $H(\\mathrm{curl})$, discretized by first-family Nédélec $H(\\mathrm{curl})$ finite elements of polynomial order $p \\in \\mathbb{N}$. Assume an affine mapping $\\mathbf{x} = F(\\hat{\\mathbf{x}})$ from the reference tetrahedron $\\hat{T}$ to the physical tetrahedron $T$, with constant Jacobian matrix $\\mathbf{J} = \\frac{\\partial \\mathbf{x}}{\\partial \\hat{\\mathbf{x}}}$ and determinant $\\det(\\mathbf{J}) \\neq 0$. On the reference element, the components of the basis functions are polynomials of total degree at most $p$, and differentiation reduces polynomial degree by one.\n\nThe elementwise mass bilinear form is\n$$\nm(\\mathbf{E}, \\mathbf{F}) = \\int_{T} \\varepsilon \\, \\mathbf{E} \\cdot \\mathbf{F} \\, \\mathrm{d}\\mathbf{x},\n$$\nand the curl-curl bilinear form is\n$$\na(\\mathbf{E}, \\mathbf{F}) = \\int_{T} \\mu^{-1} \\, (\\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{F}) \\, \\mathrm{d}\\mathbf{x}.\n$$\n\nUnder the covariant $H(\\mathrm{curl})$ Piola transformation, the physical field satisfies $\\mathbf{E}(\\mathbf{x}) = \\mathbf{J}^{-T} \\hat{\\mathbf{E}}(\\hat{\\mathbf{x}})$, and the curl transforms as\n$$\n\\nabla \\times \\mathbf{E}(\\mathbf{x}) = \\det(\\mathbf{J})^{-1} \\, \\mathbf{J} \\, (\\hat{\\nabla} \\times \\hat{\\mathbf{E}})(\\hat{\\mathbf{x}}),\n$$\nwhere $\\hat{\\nabla}$ denotes differentiation with respect to the reference coordinates.\n\nDerive, on the reference element $\\hat{T}$, the maximal total polynomial degree of the integrands for both $m(\\mathbf{E}, \\mathbf{F})$ and $a(\\mathbf{E}, \\mathbf{F})$ after applying the affine mapping. Using these degrees, determine the minimal exact quadrature degree required on $\\hat{T}$ to integrate each bilinear form exactly. Express your final answer as a two-entry row matrix $\\big[$quadrature degree for $m$, quadrature degree for $a\\big]$ in terms of $p$. No numerical rounding is required, and no physical units are to be reported in the final answer.",
            "solution": "The derivation starts from the polynomial structure of the basis functions and their transformation under the affine map. On the reference tetrahedron $\\hat{T}$, the first-family Nédélec $H(\\mathrm{curl})$ basis functions of order $p$ are vector-valued polynomials whose components have total degree at most $p$. Differentiation reduces the total degree by one, so for any such reference field $\\hat{\\mathbf{E}}$, the reference curl $\\hat{\\nabla} \\times \\hat{\\mathbf{E}}$ has components of total degree at most $p-1$.\n\nUnder the covariant $H(\\mathrm{curl})$ Piola mapping for affine $F$, the physical field and its curl are related to the reference field by\n$$\n\\mathbf{E}(\\mathbf{x}) = \\mathbf{J}^{-T} \\hat{\\mathbf{E}}(\\hat{\\mathbf{x}}), \\quad \\nabla \\times \\mathbf{E}(\\mathbf{x}) = \\det(\\mathbf{J})^{-1} \\, \\mathbf{J} \\, (\\hat{\\nabla} \\times \\hat{\\mathbf{E}})(\\hat{\\mathbf{x}}),\n$$\nwith $\\mathbf{J}$ and $\\det(\\mathbf{J})$ constant. The elementwise integrals transform via $\\mathrm{d}\\mathbf{x} = \\det(\\mathbf{J}) \\, \\mathrm{d}\\hat{\\mathbf{x}}$.\n\nWe now consider each bilinear form.\n\nFor the mass bilinear form,\n$$\nm(\\mathbf{E}, \\mathbf{F}) = \\int_{T} \\varepsilon \\, \\mathbf{E} \\cdot \\mathbf{F} \\, \\mathrm{d}\\mathbf{x} = \\int_{\\hat{T}} \\varepsilon \\, \\big(\\mathbf{J}^{-T} \\hat{\\mathbf{E}}(\\hat{\\mathbf{x}})\\big) \\cdot \\big(\\mathbf{J}^{-T} \\hat{\\mathbf{F}}(\\hat{\\mathbf{x}})\\big) \\, \\det(\\mathbf{J}) \\, \\mathrm{d}\\hat{\\mathbf{x}}.\n$$\nSince $\\mathbf{J}^{-T}$ and $\\det(\\mathbf{J})$ are constant, they do not change the polynomial degree. The dot product of two vector polynomials whose components have degree at most $p$ yields a scalar polynomial of degree at most $2p$. Therefore, the maximal total polynomial degree of the mass-form integrand on $\\hat{T}$ is\n$$\n\\deg_{\\mathrm{mass}} = 2p.\n$$\nOn a tetrahedron, a quadrature rule of degree $q$ integrates exactly all polynomials of total degree up to $q$. Hence the minimal exact quadrature degree required for the mass bilinear form is\n$$\nq_{\\mathrm{mass}}^{\\min} = 2p.\n$$\n\nFor the curl-curl bilinear form,\n$$\na(\\mathbf{E}, \\mathbf{F}) = \\int_{T} \\mu^{-1} \\, (\\nabla \\times \\mathbf{E}) \\cdot (\\nabla \\times \\mathbf{F}) \\, \\mathrm{d}\\mathbf{x} = \\int_{\\hat{T}} \\mu^{-1} \\, \\Big(\\det(\\mathbf{J})^{-1} \\mathbf{J} (\\hat{\\nabla} \\times \\hat{\\mathbf{E}})\\Big) \\cdot \\Big(\\det(\\mathbf{J})^{-1} \\mathbf{J} (\\hat{\\nabla} \\times \\hat{\\mathbf{F}})\\Big) \\, \\det(\\mathbf{J}) \\, \\mathrm{d}\\hat{\\mathbf{x}}.\n$$\nCollecting constants,\n$$\na(\\mathbf{E}, \\mathbf{F}) = \\int_{\\hat{T}} \\mu^{-1} \\, \\det(\\mathbf{J})^{-1} \\, \\big(\\mathbf{J} (\\hat{\\nabla} \\times \\hat{\\mathbf{E}})\\big) \\cdot \\big(\\mathbf{J} (\\hat{\\nabla} \\times \\hat{\\mathbf{F}})\\big) \\, \\mathrm{d}\\hat{\\mathbf{x}}.\n$$\nAgain, the constant factors $\\mu^{-1}$, $\\det(\\mathbf{J})^{-1}$, and $\\mathbf{J}$ do not affect the polynomial degree. Each reference curl $\\hat{\\nabla} \\times \\hat{\\mathbf{E}}$ and $\\hat{\\nabla} \\times \\hat{\\mathbf{F}}$ has components of degree at most $p-1$, so their dot product is a scalar polynomial of maximal degree\n$$\n\\deg_{\\mathrm{curl\\text{-}curl}} = 2(p-1) = 2p - 2.\n$$\nTherefore, the minimal exact quadrature degree required for the curl-curl bilinear form on the tetrahedron is\n$$\nq_{\\mathrm{curl\\text{-}curl}}^{\\min} = 2p - 2.\n$$\n\nIn summary, the minimal exact quadrature degrees on the reference tetrahedron $\\hat{T}$ are $2p$ for the mass bilinear form and $2p - 2$ for the curl-curl bilinear form. These follow directly from the maximal polynomial degrees of their integrands under the affine mapping and the covariant $H(\\mathrm{curl})$ Piola transformation, combined with the fact that quadrature degree on simplices is defined by the maximal total degree integrated exactly.",
            "answer": "$$\\boxed{\\begin{pmatrix} 2p  2p - 2 \\end{pmatrix}}$$"
        }
    ]
}