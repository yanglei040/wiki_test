{
    "hands_on_practices": [
        {
            "introduction": "ADI-FDTD方法的核心在于其分步隐式更新机制。这项练习将指导您从麦克斯韦方程组出发，为经典的二维TM$_z$（z方向横磁）情况推导这一核心机制。通过这个过程，您将揭示该方法如何将一个复杂的多维问题分解为一系列更简单的一维三对角系统求解，这正是其高效性和稳定性的关键所在。",
            "id": "3289199",
            "problem": "考虑一个无损耗、均匀的二维电磁介质，其电容率为 $\\varepsilon$，磁导率为 $\\mu$，在具有空间步长 $\\Delta x$ 和 $\\Delta y$ 以及时间步长 $\\Delta t$ 的均匀Yee网格上进行离散化。重点关注z方向的横磁极化（TM$_z$），其中非零场分量为 $(E_z, H_x, H_y)$。仅从微分形式的麦克斯韦旋度方程和场分量的标准Yee交错排列出发，构建一个分为两个子步的交替方向隐式时域有限差分（ADI-FDTD）格式：第一个子步在 $x$ 方向上是隐式的，第二个子步在 $y$ 方向上是隐式的。使用 Peaceman–Rachford 式时间分裂，进行从 $t^n$ 到 $t^{n+1/2}$ 以及从 $t^{n+1/2}$ 到 $t^{n+1}$ 的半步更新。\n\n您的任务是：\n- 推导第一个子步（在 $x$ 方向隐式）的全离散更新关系式，该关系式使用与Yee网格交错方式一致的中心二阶差分算子，将 $(E_z, H_x, H_y)$ 从时间索引 $n$ 更新到 $n+\\tfrac{1}{2}$。清晰地指出在此子步中哪些空间导数是隐式处理的，哪些是显式处理的。\n- 推导第二个子步（在 $y$ 方向隐式）的全离散更新关系式，该关系式将 $(E_z, H_x, H_y)$ 从时间索引 $n+\\tfrac{1}{2}$ 更新到 $n+1$，同样指明空间导数的隐式与显式处理方式。\n- 对于每个子步，根据需要消除磁场未知量的隐式耦合，从而将 $E_z$ 的更新简化为沿隐式方向的一维三对角线性系统。用 $\\Delta t$、$\\varepsilon$、$\\mu$、$\\Delta x$ 和 $\\Delta y$ 明确写出每个子步中求解 $E_z$ 的三对角模板系数。同时，给出磁场更新中出现的显式有限差分模板系数。\n- 假设为内部点并忽略边界条件，以便标准中心差分处处适用。清晰地定义您所采用的离散导数算子和Yee交错方式。\n\n最后，从第一个子步（在 $x$ 方向隐式）中求解 $E_z$ 的三对角系统中，提取三对角算子的中心系数（即乘以沿 $x$ 方向当前网格线索引处的 $E_z$ 的系数），并以 $\\Delta t$、$\\varepsilon$、$\\mu$ 和 $\\Delta x$ 表示的闭式解析表达式的形式给出。将此中心系数作为您的最终答案报告。最终答案中不要包含单位。最终答案必须是单一的闭式解析表达式。",
            "solution": "该问题是有效的，因为它科学地基于麦克斯韦方程组和成熟的ADI-FDTD数值方法，并且是适定的、客观的和自洽的。我们将开始推导。\n\n出发点是在无源、无损耗、均匀介质中（电容率为 $\\varepsilon$，磁导率为 $\\mu$），z方向横磁（TM$_z$）极化的麦克斯韦旋度方程：\n$$\n\\varepsilon \\frac{\\partial E_z}{\\partial t} = \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\n$$\n$$\n\\mu \\frac{\\partial H_x}{\\partial t} = -\\frac{\\partial E_z}{\\partial y}\n$$\n$$\n\\mu \\frac{\\partial H_y}{\\partial t} = \\frac{\\partial E_z}{\\partial x}\n$$\n这些方程在二维Yee网格上离散化。一个网格点由对应于空间坐标 $(i\\Delta x, j\\Delta y)$ 的索引 $(i, j)$ 表示，一个时间步由对应于时间 $t^n = n\\Delta t$ 的索引 $n$ 表示。根据TM$_z$的标准Yee格式，场分量在空间和时间上交错排列：\n- $E_z$ 位于 $(i\\Delta x, j\\Delta y)$ 和整数时间步 $n\\Delta t$。我们将其表示为 $E_z|_{i,j}^n$。\n- $H_x$ 位于 $(i\\Delta x, (j+\\frac{1}{2})\\Delta y)$ 和半整数时间步 $(n+\\frac{1}{2})\\Delta t$。我们将其表示为 $H_x|_{i, j+1/2}^{n+1/2}$。\n- $H_y$ 位于 $((i+\\frac{1}{2})\\Delta x, j\\Delta y)$ 和半整数时间步 $(n+\\frac{1}{2})\\Delta t$。我们将其表示为 $H_y|_{i+1/2, j}^{n+1/2}$。\n\n然而，ADI-FDTD方法通常在算法内部将所有场分量置于相同的时间实例（$n, n+1/2, n+1$）。空间交错方式保持不变：\n- $E_z \\rightarrow E_z|_{i,j}$\n- $H_x \\rightarrow H_x|_{i, j+1/2}$\n- $H_y \\rightarrow H_y|_{i+1/2, j}$\n\n我们定义与这种交错方式一致的二阶中心空间差分算子：\n$$\n\\delta_x f|_{i} = \\frac{f|_{i+1/2} - f|_{i-1/2}}{\\Delta x}, \\quad \\delta_y f|_{j} = \\frac{f|_{j+1/2} - f|_{j-1/2}}{\\Delta y}\n$$\n$$\n\\delta_x f|_{i+1/2} = \\frac{f|_{i+1} - f|_{i}}{\\Delta x}, \\quad \\delta_y f|_{j+1/2} = \\frac{f|_{j+1} - f|_{j}}{\\Delta y}\n$$\n对于半个时间步长 $\\Delta t/2$ 上的时间导数，我们使用一阶前向差分，例如 $\\frac{\\partial F}{\\partial t} \\approx \\frac{F^{n+1/2} - F^n}{\\Delta t/2}$。\n\nPeaceman-Rachford 分裂格式将从时间 $n$ 到 $n+1$ 的更新分为两个子步。TM$_z$ 系统的右端算子被分裂为仅包含 $x$ 导数的算子（$A_x$）和仅包含 $y$ 导数的算子（$A_y$）。\n\n**子步 1：从 $t^n$ 更新到 $t^{n+1/2}$（x方向隐式）**\n\n在此子步中，$x$ 导数作隐式处理（在时间 $n+1/2$ 处取值），$y$ 导数作显式处理（在时间 $n$ 处取值）。半离散方程为：\n$$\n\\varepsilon \\frac{E_z^{n+1/2} - E_z^n}{\\Delta t/2} = \\frac{\\partial H_y^{n+1/2}}{\\partial x} - \\frac{\\partial H_x^n}{\\partial y}\n$$\n$$\n\\mu \\frac{H_x^{n+1/2} - H_x^n}{\\Delta t/2} = -\\frac{\\partial E_z^n}{\\partial y}\n$$\n$$\n\\mu \\frac{H_y^{n+1/2} - H_y^n}{\\Delta t/2} = \\frac{\\partial E_z^{n+1/2}}{\\partial x}\n$$\n应用已定义的离散算子，我们得到全离散更新关系式：\n\n1.  $E_z$ 更新方程，中心位于 $(i,j)$：\n    $$\n    \\varepsilon \\frac{E_z|_{i,j}^{n+1/2} - E_z|_{i,j}^n}{\\Delta t/2} = \\frac{H_y|_{i+1/2,j}^{n+1/2} - H_y|_{i-1/2,j}^{n+1/2}}{\\Delta x} - \\frac{H_x|_{i,j+1/2}^n - H_x|_{i,j-1/2}^n}{\\Delta y}\n    $$\n    此处，作用于 $H_y$ 的 $\\delta_x$ 算子是隐式的，而作用于 $H_x$ 的 $\\delta_y$ 算子是显式的。\n\n2.  $H_y$ 更新方程，中心位于 $(i+1/2,j)$：\n    $$\n    \\mu \\frac{H_y|_{i+1/2,j}^{n+1/2} - H_y|_{i+1/2,j}^n}{\\Delta t/2} = \\frac{E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2}}{\\Delta x}\n    $$\n    作用于 $E_z$ 的 $\\delta_x$ 算子是隐式的。\n\n3.  $H_x$ 更新方程，中心位于 $(i,j+1/2)$：\n    $$\n    \\mu \\frac{H_x|_{i,j+1/2}^{n+1/2} - H_x|_{i,j+1/2}^n}{\\Delta t/2} = -\\frac{E_z|_{i,j+1}^n - E_z|_{i,j}^n}{\\Delta y}\n    $$\n    作用于 $E_z$ 的 $\\delta_y$ 算子是显式的。此方程可以直接求解 $H_x|_{i,j+1/2}^{n+1/2}$：\n    $$\n    H_x|_{i,j+1/2}^{n+1/2} = H_x|_{i,j+1/2}^n - \\frac{\\Delta t}{2\\mu\\Delta y} \\left( E_z|_{i,j+1}^n - E_z|_{i,j}^n \\right)\n    $$\n    此显式 $H_x$ 更新的有限差分模板系数对于 $E_z|_{i,j}^n$ 是 $\\frac{\\Delta t}{2\\mu\\Delta y}$，对于 $E_z|_{i,j+1}^n$ 是 $-\\frac{\\Delta t}{2\\mu\\Delta y}$。\n\n为了获得 $E_z$ 的三对角系统，我们首先重新整理隐式的 $H_y$ 更新式，用 $E_z^{n+1/2}$ 和已知值来表示 $H_y^{n+1/2}$：\n$$\nH_y|_{i+1/2,j}^{n+1/2} = H_y|_{i+1/2,j}^n + \\frac{\\Delta t}{2\\mu\\Delta x} \\left( E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2} \\right)\n$$\n将此 $H_y|_{i+1/2,j}^{n+1/2}$ 的表达式以及一个类似的 $H_y|_{i-1/2,j}^{n+1/2}$ 表达式代入 $E_z$ 方程：\n$$\n\\varepsilon \\frac{E_z|_{i,j}^{n+1/2} - E_z|_{i,j}^n}{\\Delta t/2} = \\frac{1}{\\Delta x} \\left[ \\left( H_y|_{i+1/2,j}^n + \\frac{\\Delta t}{2\\mu\\Delta x} (E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2}) \\right) - \\left( H_y|_{i-1/2,j}^n + \\frac{\\Delta t}{2\\mu\\Delta x} (E_z|_{i,j}^{n+1/2} - E_z|_{i-1,j}^{n+1/2}) \\right) \\right] - \\delta_y H_x|_{i,j}^n\n$$\n整理项，将未知数（$E_z^{n+1/2}$）归到左侧（LHS），将已知数归到右侧（RHS）：\n$$\nE_z|_{i,j}^{n+1/2} - \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta x)^2} \\left[ E_z|_{i+1,j}^{n+1/2} - 2E_z|_{i,j}^{n+1/2} + E_z|_{i-1,j}^{n+1/2} \\right] = E_z|_{i,j}^n + \\frac{\\Delta t}{2\\varepsilon} \\left( \\delta_x H_y|_{i,j}^n - \\delta_y H_x|_{i,j}^n \\right)\n$$\n这是对每条水平线（$j$ 为常数）的一维三对角系统。方程的形式为 $a_i E_z|_{i-1,j}^{n+1/2} + b_i E_z|_{i,j}^{n+1/2} + c_i E_z|_{i+1,j}^{n+1/2} = d_i$。作用于 $E_z$ 的三对角算子的模板系数为：\n- 左系数（$a_i$）：$- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta x)^2}$\n- 中心系数（$b_i$）：$1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta x)^2}$\n- 右系数（$c_i$）：$- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta x)^2}$\n\n一旦求解出所有 $E_z|_{i,j}^{n+1/2}$ 的三对角系统，就可以使用现已知的 $E_z$ 值显式地完成 $H_y|_{i+1/2,j}^{n+1/2}$ 的更新。此 $H_y$ 更新的模板系数对于 $E_z|_{i+1,j}^{n+1/2}$ 是 $\\frac{\\Delta t}{2\\mu\\Delta x}$，对于 $E_z|_{i,j}^{n+1/2}$ 是 $-\\frac{\\Delta t}{2\\mu\\Delta x}$。\n\n**子步 2：从 $t^{n+1/2}$ 更新到 $t^{n+1}$（y方向隐式）**\n\n此子步与第一步对称。现在，$y$ 导数是隐式的（在 $t^{n+1}$ 处取值），而 $x$ 导数是显式的（在 $t^{n+1/2}$ 处取值）。\n$$\n\\varepsilon \\frac{E_z^{n+1} - E_z^{n+1/2}}{\\Delta t/2} = \\frac{\\partial H_y^{n+1/2}}{\\partial x} - \\frac{\\partial H_x^{n+1}}{\\partial y}\n$$\n$$\n\\mu \\frac{H_x^{n+1} - H_x^{n+1/2}}{\\Delta t/2} = -\\frac{\\partial E_z^{n+1}}{\\partial y}\n$$\n$$\n\\mu \\frac{H_y^{n+1} - H_y^{n+1/2}}{\\Delta t/2} = \\frac{\\partial E_z^{n+1/2}}{\\partial x}\n$$\n遵循与子步1类似的步骤：\n\n1.  $H_y$ 更新现在是显式的：\n    $$\n    H_y|_{i+1/2,j}^{n+1} = H_y|_{i+1/2,j}^{n+1/2} + \\frac{\\Delta t}{2\\mu\\Delta x} \\left( E_z|_{i+1,j}^{n+1/2} - E_z|_{i,j}^{n+1/2} \\right)\n    $$\n    模板系数在 $E_z^{n+1/2}$ 的值上分别为 $\\frac{\\Delta t}{2\\mu\\Delta x}$ 和 $-\\frac{\\Delta t}{2\\mu\\Delta x}$。\n\n2.  $E_z$ 和 $H_x$ 的更新是隐式耦合的。我们将 $H_x^{n+1}$ 的表达式代入 $E_z$ 更新方程。这会为每条垂直线（$i$ 为常数）产生一个三对角系统：\n    $$\n    - \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2} E_z|_{i,j-1}^{n+1} + \\left(1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta y)^2}\\right) E_z|_{i,j}^{n+1} - \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2} E_z|_{i,j+1}^{n+1} = \\text{RHS}\n    $$\n    其中RHS仅包含来自时间 $n+1/2$ 的已知值。\n    作用于 $E_z$ 的三对角算子的模板系数为：\n    - 底部系数：$- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2}$\n    - 中心系数：$1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta y)^2}$\n    - 顶部系数：$- \\frac{(\\Delta t)^2}{4\\varepsilon\\mu(\\Delta y)^2}$\n\n3.  在求解出 $E_z^{n+1}$ 后，显式地完成 $H_x$ 的更新：\n    $$\n    H_x|_{i,j+1/2}^{n+1} = H_x|_{i,j+1/2}^{n+1/2} - \\frac{\\Delta t}{2\\mu\\Delta y} \\left( E_z|_{i,j+1}^{n+1} - E_z|_{i,j}^{n+1} \\right)\n    $$\n    模板系数在 $E_z^{n+1}$ 的值上分别为 $\\frac{\\Delta t}{2\\mu\\Delta y}$ 和 $-\\frac{\\Delta t}{2\\mu\\Delta y}$。\n\n所要求的最终答案是在第一个子步（$x$方向隐式）中求解 $E_z$ 的三对角算子的中心系数。\n该系数在子步1的方程中被确定为 $b_i$。\n$$\n\\text{Center Coefficient} = 1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta x)^2}\n$$",
            "answer": "$$\n\\boxed{1 + \\frac{(\\Delta t)^2}{2\\varepsilon\\mu(\\Delta x)^2}}\n$$"
        },
        {
            "introduction": "在了解如何构建ADI-FDTD格式之后，下一个关键步骤是分析其数值行为。本练习使用冯·诺依曼分析法来研究该方法的两个基本特性：稳定性和数值色散。理解这些特性对于评估该方法的可靠性和准确性至关重要，特别是其著名的、能够克服显式FDTD方法中CFL条件限制的无条件稳定性。",
            "id": "3289170",
            "problem": "考虑在真空中传播的一维横电磁波，其由麦克斯韦方程组控制，在交错空间网格（Yee 网格）上离散化，并采用专用于一维空间的交替方向隐式时域有限差分法（ADI-FDTD）进行时间推进。在这种情况下，一阶麦克斯韦算子的梯形（Crank–Nicolson）时间离散化的交替方向隐式分裂，简化为应用于一维交错麦克斯韦系统的梯形法则，该方法是无条件稳定的，并且在空间和时间上都具有二阶精度。\n\n从真空中的无源一维麦克斯韦方程组和上述离散化假设出发，使用 ansatz $E_i^n = E_0 \\exp\\!\\big(i\\,(i\\,\\kappa - n\\,\\Omega)\\big)$ 和 $H_{i+1/2}^n = H_0 \\exp\\!\\big(i\\,( (i+1/2)\\,\\kappa - n\\,\\Omega)\\big)$（其中 $\\kappa = k\\,\\Delta x$ 和 $\\Omega = \\omega\\,\\Delta t$）进行 von Neumann 平面波分析，以推导离散色散关系和单步放大因子 $G$。然后：\n\n1）根据离散色散关系 $\\omega = \\omega(k)$，计算群速度 $v_g = \\partial \\omega/\\partial k$。\n\n2）计算放大因子 $\\lvert G \\rvert$ 的模。\n\n对以下参数集评估这两个量：\n- 真空波速 $c = 3.00 \\times 10^{8}\\,\\mathrm{m/s}$。\n- 空间步长 $\\Delta x = 1.00 \\times 10^{-2}\\,\\mathrm{m}$。\n- 时间步长 $\\Delta t = 3.00 \\times 10^{-11}\\,\\mathrm{s}$。\n- 波数满足 $k\\,\\Delta x = \\kappa = \\pi/2$。\n\n给出结果对于一个中心在给定波数的窄带波包的物理解释，讨论其传播速度和在多个时间步长后的振幅演化。将群速度的最终数值以 $\\mathrm{m/s}$ 为单位表示，并将放大因子模表示为无量纲数。将最终数值四舍五入至六位有效数字。假设所有相位和角量均以弧度为单位。",
            "solution": "题目要求推导和评估应用于麦克斯韦方程组的一维交替方向隐式时域有限差分法（ADI-FDTD）方案的群速度和放大因子。如题所述，该方法在一维情况下简化为在交错 Yee 网格上的 Crank-Nicolson（梯形法则）时间积分。\n\n我们从真空中的无源一维麦克斯韦旋度方程组开始，对于在 x 方向传播的横电磁波，其场分量 $E_y$ 和 $H_z$ 可以写为：\n$$ \\frac{\\partial E_y}{\\partial t} = -\\frac{1}{\\epsilon_0} \\frac{\\partial H_z}{\\partial x} $$\n$$ \\frac{\\partial H_z}{\\partial t} = -\\frac{1}{\\mu_0} \\frac{\\partial E_y}{\\partial x} $$\n此处，$\\epsilon_0$ 和 $\\mu_0$ 分别是真空的介电常数和磁导率，它们通过 $c = 1/\\sqrt{\\epsilon_0 \\mu_0}$ 与光速 $c$ 相关。\n\n题目指定了一个交错空间网格（Yee 网格），我们在整数网格点 $i$ 定义 $E_y$，在半整数网格点 $i+1/2$ 定义 $H_z$。空间导数由二阶中心差分近似：\n$$ \\frac{\\partial H_z}{\\partial x} \\bigg|_i \\approx \\frac{H_{z, i+1/2} - H_{z, i-1/2}}{\\Delta x} $$\n$$ \\frac{\\partial E_y}{\\partial x} \\bigg|_{i+1/2} \\approx \\frac{E_{y, i+1} - E_{y, i}}{\\Delta x} $$\n时间离散化使用梯形法则（Crank-Nicolson 方法），这涉及到在时间步长 $n$ 和 $n+1$ 上对方程右侧的空间导数进行平均。令 $E_i^n$ 表示 $E_y(i\\Delta x, n\\Delta t)$，令 $H_{i+1/2}^n$ 表示 $H_z((i+1/2)\\Delta x, n\\Delta t)$。离散化方程为：\n$$ \\frac{E_i^{n+1} - E_i^n}{\\Delta t} = -\\frac{1}{2\\epsilon_0 \\Delta x} \\left[ (H_{i+1/2}^{n+1} - H_{i-1/2}^{n+1}) + (H_{i+1/2}^n - H_{i-1/2}^n) \\right] $$\n$$ \\frac{H_{i+1/2}^{n+1} - H_{i+1/2}^n}{\\Delta t} = -\\frac{1}{2\\mu_0 \\Delta x} \\left[ (E_{i+1}^{n+1} - E_i^{n+1}) + (E_{i+1}^n - E_i^n) \\right] $$\n\n为了进行 von Neumann 稳定性分析，我们代入题目中提供的平面波 ansatz：\n$E_i^n = E_0 \\exp\\big(i(i\\kappa - n\\Omega)\\big)$\n$H_{i+1/2}^n = H_0 \\exp\\big(i((i+1/2)\\kappa - n\\Omega)\\big)$\n其中 $\\kappa = k\\Delta x$，$\\Omega = \\omega\\Delta t$，i 是虚数单位。放大因子为 $G = \\exp(-i\\Omega)$，使得 $E_i^{n+1} = G E_i^n$ 且 $H_{i+1/2}^{n+1} = G H_{i+1/2}^n$。\n\n将 ansatz 代入离散化方程，我们得到一个关于振幅 $E_0$ 和 $H_0$ 的二元线性代数方程组。\n\n对于第一个方程（$E_y$ 的更新式）：\n$E_i^n(G-1) = -\\frac{\\Delta t}{2\\epsilon_0 \\Delta x} \\left[ (G H_{i-1/2}^n(\\exp(i\\kappa)-1)) + (H_{i-1/2}^n(\\exp(i\\kappa)-1)) \\right]$\n$E_0 \\exp(i(i\\kappa-n\\Omega))(G-1) = -\\frac{\\Delta t}{2\\epsilon_0 \\Delta x} (G+1) H_0 \\exp(i((i-1/2)\\kappa-n\\Omega)) (\\exp(i\\kappa)-1)$\n消去公因子并使用 $\\exp(-i\\kappa/2)(\\exp(i\\kappa)-1) = \\exp(i\\kappa/2)-\\exp(-i\\kappa/2) = 2i\\sin(\\kappa/2)$：\n$E_0 (G-1) = -\\frac{\\Delta t}{2\\epsilon_0 \\Delta x} (G+1) H_0 \\exp(-i\\kappa/2) (\\exp(i\\kappa)-1)$\n$E_0 (G-1) = -\\frac{\\Delta t}{\\epsilon_0 \\Delta x} (G+1) H_0 (i\\sin(\\kappa/2))$\n$$ E_0 \\left(\\frac{G-1}{G+1}\\right) = -\\frac{i\\Delta t \\sin(\\kappa/2)}{\\epsilon_0 \\Delta x} H_0 \\quad (1)$$\n\n对于第二个方程（$H_z$ 的更新式）：\n$H_{i+1/2}^n(G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} \\left[ (G E_i^n(\\exp(i\\kappa)-1)) + (E_i^n(\\exp(i\\kappa)-1)) \\right]$\n$H_0 \\exp(i((i+1/2)\\kappa-n\\Omega))(G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} (G+1) E_0 \\exp(i(i\\kappa-n\\Omega))(\\exp(i\\kappa)-1)$\n$H_0 \\exp(i\\kappa/2)(G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} (G+1) E_0 (\\exp(i\\kappa)-1)$\n$H_0 (G-1) = -\\frac{\\Delta t}{2\\mu_0 \\Delta x} (G+1) E_0 \\exp(-i\\kappa/2)(\\exp(i\\kappa)-1)$\n$H_0 (G-1) = -\\frac{\\Delta t}{\\mu_0 \\Delta x} (G+1) E_0 (i\\sin(\\kappa/2))$\n$$ H_0 \\left(\\frac{G-1}{G+1}\\right) = -\\frac{i\\Delta t \\sin(\\kappa/2)}{\\mu_0 \\Delta x} E_0 \\quad (2)$$\n\n为了得到非平凡解 $(E_0, H_0)$，由方程(1)和(2)组成的方程组的行列式必须为零：\n$$ \\left(\\frac{G-1}{G+1}\\right)^2 - \\left(-\\frac{i\\Delta t \\sin(\\kappa/2)}{\\epsilon_0 \\Delta x}\\right) \\left(-\\frac{i\\Delta t \\sin(\\kappa/2)}{\\mu_0 \\Delta x}\\right) = 0 $$\n$$ \\left(\\frac{G-1}{G+1}\\right)^2 - (i^2) \\frac{(\\Delta t)^2 \\sin^2(\\kappa/2)}{\\epsilon_0 \\mu_0 (\\Delta x)^2} = 0 $$\n使用 $c=1/\\sqrt{\\epsilon_0\\mu_0}$ 和 Courant 数 $S = c\\Delta t/\\Delta x$：\n$$ \\left(\\frac{G-1}{G+1}\\right)^2 + S^2 \\sin^2\\left(\\frac{\\kappa}{2}\\right) = 0 $$\n$$ \\frac{G-1}{G+1} = \\pm i S \\sin\\left(\\frac{\\kappa}{2}\\right) $$\n对于前向传播的波，其中 $E_y = Z_0 H_z$ 且 $Z_0 = \\sqrt{\\mu_0/\\epsilon_0}$ 是自由空间的波阻抗，方程(1)意味着我们必须选择负号：\n$\\frac{G-1}{G+1} = -i S \\sin(\\kappa/2)$.\n我们来求解 $G$:\n$G-1 = -i S \\sin(\\kappa/2) (G+1) \\implies G(1 + i S \\sin(\\kappa/2)) = 1 - i S \\sin(\\kappa/2)$\n$$ G = \\frac{1 - i S \\sin(\\kappa/2)}{1 + i S \\sin(\\kappa/2)} $$\n\n放大因子 $|G|$ 的模计算如下：\n$$ |G| = \\left| \\frac{1 - i S \\sin(\\kappa/2)}{1 + i S \\sin(\\kappa/2)} \\right| = \\frac{|1 - i S \\sin(\\kappa/2)|}{|1 + i S \\sin(\\kappa/2)|} = \\frac{\\sqrt{1^2 + (-S \\sin(\\kappa/2))^2}}{\\sqrt{1^2 + (S \\sin(\\kappa/2))^2}} = 1 $$\n这证实了该数值格式是无条件稳定且非耗散的。对于任何有效的参数集，都有 $|G|=1$。精确到六位有效数字的值是 $1.00000$。\n\n为了找到离散色散关系，我们将 $G$ 与角频率 $\\omega$ 联系起来。\n$G = \\exp(-i\\Omega) = \\exp(-i\\omega\\Delta t)$。\n复数 $1 + i S \\sin(\\kappa/2)$ 的辐角是 $\\arctan(S \\sin(\\kappa/2))$。因此，$G$ 的辐角是 $-2\\arctan(S \\sin(\\kappa/2))$。\n$\\exp(-i\\omega\\Delta t) = \\exp(-2i \\arctan(S \\sin(\\kappa/2)))$。\n这给出了色散关系：\n$$ \\omega(k) = \\frac{2}{\\Delta t} \\arctan\\left(S \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) = \\frac{2}{\\Delta t} \\arctan\\left(\\frac{c\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) $$\n\n群速度 $v_g$ 是 $\\omega$ 对 $k$ 的导数：\n$$ v_g = \\frac{\\partial \\omega}{\\partial k} = \\frac{2}{\\Delta t} \\frac{\\partial}{\\partial k} \\left[ \\arctan\\left(\\frac{c\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right) \\right] $$\n使用链式法则，设 $u(k) = \\frac{c\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)$:\n$$ v_g = \\frac{2}{\\Delta t} \\cdot \\frac{1}{1 + \\left(\\frac{c\\Delta t}{\\Delta x}\\right)^2 \\sin^2\\left(\\frac{k\\Delta x}{2}\\right)} \\cdot \\frac{d u}{d k} $$\n$$ \\frac{d u}{d k} = \\frac{c\\Delta t}{\\Delta x} \\cos\\left(\\frac{k\\Delta x}{2}\\right) \\cdot \\frac{\\Delta x}{2} $$\n将此代回：\n$$ v_g = \\frac{2}{\\Delta t} \\cdot \\frac{1}{1 + S^2 \\sin^2\\left(\\frac{\\kappa}{2}\\right)} \\cdot \\frac{c\\Delta t}{2} \\cos\\left(\\frac{\\kappa}{2}\\right) $$\n$$ v_g = \\frac{c \\cos(\\kappa/2)}{1 + S^2 \\sin^2(\\kappa/2)} $$\n\n现在，我们用给定的参数来计算 $v_g$ 和 $|G|$：\n$c = 3.00 \\times 10^8\\,\\mathrm{m/s}$\n$\\Delta x = 1.00 \\times 10^{-2}\\,\\mathrm{m}$\n$\\Delta t = 3.00 \\times 10^{-11}\\,\\mathrm{s}$\n$\\kappa = k\\Delta x = \\pi/2$\n\n首先，计算 Courant 数 $S$：\n$S = \\frac{c\\Delta t}{\\Delta x} = \\frac{(3.00 \\times 10^8\\,\\mathrm{m/s})(3.00 \\times 10^{-11}\\,\\mathrm{s})}{1.00 \\times 10^{-2}\\,\\mathrm{m}} = \\frac{9.00 \\times 10^{-3}}{1.00 \\times 10^{-2}} = 0.900$\n\n对于群速度 $v_g$，我们使用 $\\kappa = \\pi/2$：\n$\\sin(\\kappa/2) = \\sin(\\pi/4) = \\frac{\\sqrt{2}}{2}$\n$\\cos(\\kappa/2) = \\cos(\\pi/4) = \\frac{\\sqrt{2}}{2}$\n$$ v_g = \\frac{(3.00 \\times 10^8) \\cos(\\pi/4)}{1 + (0.900)^2 \\sin^2(\\pi/4)} = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1 + (0.81) (\\frac{\\sqrt{2}}{2})^2} $$\n$$ v_g = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1 + (0.81) (\\frac{1}{2})} = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1 + 0.405} = \\frac{(3.00 \\times 10^8) (\\frac{\\sqrt{2}}{2})}{1.405} $$\n$$ v_g = \\frac{3.00 \\times \\sqrt{2}}{2 \\times 1.405} \\times 10^8 \\approx \\frac{3.00 \\times 1.41421356}{2.810} \\times 10^8 \\approx 1.50983654 \\times 10^8\\,\\mathrm{m/s} $$\n四舍五入到六位有效数字，$v_g = 1.50984 \\times 10^8\\,\\mathrm{m/s}$。\n\n放大因子的模 $|G|$ 恰好为 $1$。精确到六位有效数字，结果是 $1.00000$。\n\n物理解释：\n群速度 $v_g \\approx 1.51 \\times 10^8\\,\\mathrm{m/s}$ 是中心在给定波数（$k\\Delta x = \\pi/2$）的窄带波包的包络传播速度。这个速度大约只有真空中光速 $c$ 的一半。这种显著的偏差是数值色散的结果，是空间和时间离散化的人为产物。对于给定的参数，网格分辨率是每波长 $4$ 个单元（$\\lambda = 2\\pi/k = 2\\pi/(\\pi/(2\\Delta x)) = 4\\Delta x$），这是相当粗糙的，并导致显著的数值色散误差，使波包减速。\n\n放大因子的模 $|G|=1$ 意味着该数值格式是非耗散的（幺正的）。单个平面波模式的振幅随时间完美保持。对于一个波包，这意味着尽管其形状会因其组成频率分量（数值色散）的不同速度而扭曲和扩散，但它的总能量将在多个时间步长内守恒。\n\n最终答案是群速度的数值和放大因子的模。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.50984 \\times 10^8  1.00000 \\end{pmatrix} } $$"
        }
    ]
}