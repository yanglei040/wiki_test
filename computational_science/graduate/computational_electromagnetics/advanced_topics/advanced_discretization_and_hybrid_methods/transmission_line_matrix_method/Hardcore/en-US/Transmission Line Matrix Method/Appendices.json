{
    "hands_on_practices": [
        {
            "introduction": "The Transmission-Line Matrix (TLM) method deconstructs complex electromagnetic wave propagation into a sequence of simple, local events. This exercise  takes you to the heart of the method: the scattering process at a single 1D shunt node. By applying fundamental principles of voltage continuity and current conservation, you will derive the scattering parameters that govern how pulses interact at a junction, providing a direct link between the material properties of the medium and the numerical algorithm.",
            "id": "11289",
            "problem": "In the Transmission Line Matrix (TLM) numerical method, electromagnetic wave propagation is modeled by voltage and current pulses traveling on a mesh of transmission lines. The core of the simulation is a \"scatter-and-connect\" process. At each discrete time step, pulses incident on a junction (node) are scattered, and the resulting scattered pulses then propagate to adjacent nodes.\n\nConsider a fundamental 1-dimensional shunt node in a TLM model. This node connects two semi-infinite transmission lines, designated as Port 1 and Port 2, each having a characteristic impedance of $Z_0$. At the junction point, a shunt element with a general admittance $Y_s$ is connected between the transmission line and the ground. This shunt admittance models the local material properties.\n\nThe dynamics at the node are governed by two principles:\n1.  **Voltage Continuity:** The total voltage at the node, $V_n$, is the same when viewed from either port. The total voltage at a port is the sum of its incident and scattered pulses. For example, at Port 1, $V_n = V_1^i + V_1^s$.\n2.  **Current Conservation:** The sum of currents flowing into the node must equal the current flowing out through the shunt element (Kirchhoff's Current Law). The current on a transmission line is given by the difference between the incident and scattered voltage pulses, divided by the characteristic impedance. For example, at Port 1, the current flowing into the node is $I_1 = (V_1^i - V_1^s) / Z_0$. The current through the shunt is $I_s = V_n Y_s$.\n\nA single voltage pulse of amplitude $V_{inc}$ is launched from Port 1 and is incident upon the node. No pulse is incident from Port 2. Derive an expression for the amplitude of the pulse scattered back into Port 1, denoted $V_{refl}$. Your result should be expressed in terms of $V_{inc}$, $Z_0$, and $Y_s$.",
            "solution": "1. Relevant equations:  \nVoltage continuity:  \n$$V_n = V_1^i + V_1^s = V_2^i + V_2^s.$$  \nLine currents:  \n$$I_1 = \\frac{V_1^i - V_1^s}{Z_0},\\quad I_2 = \\frac{V_2^i - V_2^s}{Z_0},\\quad I_s = V_n Y_s.$$  \nKirchhoff’s law:  \n$$I_1 + I_2 = I_s.$$\n\n2. Apply boundary conditions and continuity:  \nSince $V_2^i=0$, we have $V_n=V_2^s$. Also $V_n=V_1^i+V_1^s$.  \n\n3. Substitute into current conservation:  \nFrom Kirchhoff's Current Law and the continuity relations ($V_n = V_2^s$):\n$$\\frac{V_1^i - V_1^s - V_n}{Z_0} = V_n Y_s$$  \nUse $V_n=V_1^i+V_1^s$:  \n$$\\frac{V_1^i - V_1^s - (V_1^i+V_1^s)}{Z_0} = (V_1^i+V_1^s)Y_s$$  \n$$-\\frac{2V_1^s}{Z_0} = (V_1^i+V_1^s)Y_s$$  \n\n4. Solve for $V_1^s$:  \nMultiply by $Z_0$:  \n$$-2V_1^s = Z_0Y_s(V_1^i + V_1^s)$$  \n$$-2V_1^s = Z_0Y_s V_1^i + Z_0Y_s V_1^s$$  \n$$-(2 + Z_0Y_s)V_1^s = Z_0Y_s V_1^i$$  \n$$V_1^s = -\\frac{Z_0Y_s}{2 + Z_0Y_s}\\,V_1^i.$$  \n\nSince the incident pulse $V_{inc}=V_1^i$, the reflected amplitude is  \n$$V_{refl} = -\\frac{Z_0 Y_s}{2 + Z_0 Y_s}\\,V_{inc}.$$",
            "answer": "$$\\boxed{-\\frac{Z_0 Y_s}{2 + Z_0 Y_s}\\,V_{inc}}$$"
        },
        {
            "introduction": "The power of numerical methods like TLM extends beyond simple simulation to the quantitative analysis of complex physical phenomena. This practice  delves into the challenging problem of field singularities at the sharp edge of a metallic wedge, a common feature in many electromagnetic devices. You will explore how the discrete, local update rules of the TLM method collectively approximate the continuous differential operator governing the fields, and by performing a numerical eigen-analysis, you will extract the field singularity exponent and compare it with the analytical solution.",
            "id": "3357537",
            "problem": "Consider a two-dimensional transverse magnetic configuration with the electric field polarized along the axial direction, modeled near a perfectly electrically conducting wedge of interior angle $\\alpha$ in radians. The wedge occupies $\\theta=0$ and $\\theta=\\alpha$, and the region of interest is the angular sector $\\theta \\in (0,\\alpha)$ and radial coordinate $r>0$. The goal is to analyze the corner singularity of the tangential electric field component $E_{\\phi}(r,\\theta)$ and verify the near-field behavior $E_{\\phi}(r,\\theta)\\propto r^{\\lambda-1}$, where $\\lambda$ depends on $\\alpha$. The analysis must use the Transmission Line Matrix (TLM) method (Transmission Line Matrix (TLM)) to construct the local angular update operator in the vicinity of the corner and then extract the singular exponent $\\lambda(\\alpha)$ through numerical eigen-analysis of this operator.\n\nStarting from first principles, use Maxwell’s equations in the frequency domain, the definition of perfect electric conductor boundary conditions, and separation of variables in polar coordinates to argue that the angular dependence of the field along a small annular ring at fixed $r$ is governed, in steady state, by a self-adjoint second-order differential operator in $\\theta$ subject to homogeneous Dirichlet boundary conditions at $\\theta=0$ and $\\theta=\\alpha$. Explain how, under the Transmission Line Matrix framework using symmetrical condensed nodes and enforcing energy conservation and reciprocity, the local angular update operator reduces to the standard second-difference discretization of the angular second derivative on a uniform grid that resolves $\\theta \\in (0,\\alpha)$ with $M$ interior angular nodes, and Dirichlet boundary conditions at the wedge faces.\n\nLet $\\Delta \\theta = \\alpha/(M+1)$ denote the uniform angular step, and let $\\mathbf{L}\\in\\mathbb{R}^{M\\times M}$ be the tridiagonal matrix representing the discrete angular operator\n$$\n\\mathbf{L} = \\frac{1}{\\Delta\\theta^2}\\begin{bmatrix}\n2 & -1 & 0 & \\cdots & 0 \\\\\n-1 & 2 & -1 & \\ddots & \\vdots \\\\\n0 & -1 & 2 & \\ddots & 0 \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & -1 \\\\\n0 & \\cdots & 0 & -1 & 2\n\\end{bmatrix}.\n$$\nShow that the eigenvalue problem for $\\mathbf{L}$ yields discrete angular eigenvalues $\\mu_k$ and eigenvectors that approximate the continuous angular eigenfunctions subject to the wedge boundary conditions, and that the singular exponent $\\lambda$ corresponding to the most singular mode is given by $\\lambda = \\sqrt{\\mu_{\\min}}$, where $\\mu_{\\min}$ is the smallest positive eigenvalue of $\\mathbf{L}$. Argue that the continuous reference exponent $\\lambda_{\\text{cont}}(\\alpha)$ arises from imposing homogeneous Dirichlet boundary conditions on the angular part of the separated solution and is obtained by enforcing that the angular function vanishes at $\\theta=0$ and $\\theta=\\alpha$, i.e., it is the smallest strictly positive solution to the scalar boundary condition equation for the angular function.\n\nYour task is to implement a complete program that:\n- Constructs $\\mathbf{L}$ for given $\\alpha$ and $M$.\n- Computes the smallest positive eigenvalue $\\mu_{\\min}$ and sets $\\lambda_{\\text{num}} = \\sqrt{\\mu_{\\min}}$.\n- Computes the continuous reference $\\lambda_{\\text{cont}}(\\alpha)$ by solving the homogeneous Dirichlet angular boundary condition for the smallest strictly positive $\\lambda$.\n- For each test case, returns the relative error $|\\lambda_{\\text{num}}-\\lambda_{\\text{cont}}|/\\lambda_{\\text{cont}}$ as a float.\n\nAngles must be treated in radians. No physical units other than the angular unit are needed. The program must output a single line consisting of a comma-separated list enclosed in square brackets with the relative errors for all test cases in order.\n\nUse the following test suite of $(\\alpha,M)$ pairs:\n- $(\\alpha, M) = \\left(\\frac{\\pi}{2}, 128\\right)$ as a general case.\n- $(\\alpha, M) = \\left(\\frac{\\pi}{3}, 128\\right)$ as an acute wedge case.\n- $(\\alpha, M) = \\left(\\frac{3\\pi}{4}, 128\\right)$ as an obtuse wedge case.\n- $(\\alpha, M) = \\left(0.95\\pi, 128\\right)$ as a near-flat boundary case.\n- $(\\alpha, M) = \\left(\\frac{\\pi}{2}, 8\\right)$ as a coarse discretization edge case.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4,r5]\").",
            "solution": "The problem is first validated to be scientifically sound, well-posed, and objective. It presents a standard problem in computational electromagnetics concerning field singularities at a sharp metallic corner, framed within the Transmission Line Matrix (TLM) method. The given information is complete and consistent for deriving a solution.\n\n### Theoretical Foundation and Continuous Model\n\nWe begin from first principles to derive the continuous reference model for the field behavior near the tip of a perfectly electrically conducting (PEC) wedge. The problem describes a two-dimensional transverse magnetic (TM) configuration where the electric field is polarized along the axial direction, which we take as the $\\hat{z}$-axis. In this TM$_z$ case, the electric field has only a $z$-component, $\\mathbf{E} = E_z(r, \\theta) \\hat{z}$, and the magnetic field is transverse, $\\mathbf{H} = H_r(r, \\theta) \\hat{r} + H_\\theta(r, \\theta) \\hat{\\theta}$. The problem statement refers to the tangential electric field component $E_{\\phi}(r,\\theta)$, which is inconsistent with a TM$_z$ polarization where $E_\\phi=0$. The analysis of corner singularities in this configuration correctly pertains to the axial component $E_z$, which is tangential to the PEC surfaces of the wedge. We shall proceed by assuming the analysis is for $E_z$, as all subsequent details in the problem (wave equation, boundary conditions, and the resulting operator) are consistent with this interpretation. The near-field behavior for the transverse magnetic field components is proportional to $r^{\\lambda-1}$ when $E_z \\propto r^\\lambda$, which may be the source of this notational inconsistency. The goal is to find the exponent $\\lambda$.\n\nIn the frequency domain, the time-harmonic electric field $E_z$ in a source-free, homogeneous medium of permittivity $\\epsilon$ and permeability $\\mu$ satisfies the Helmholtz equation:\n$$ \\nabla^2 E_z + k^2 E_z = 0 $$\nwhere $k^2 = \\omega^2 \\epsilon \\mu$ is the square of the wavenumber. In polar coordinates $(r, \\theta)$, the Laplacian operator is $\\nabla^2 = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2}{\\partial \\theta^2}$. The Helmholtz equation becomes:\n$$ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial E_z}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 E_z}{\\partial \\theta^2} + k^2 E_z = 0 $$\nWe seek a solution using the method of separation of variables, positing $E_z(r, \\theta) = R(r)\\Theta(\\theta)$. Substituting this into the wave equation and rearranging terms yields:\n$$ \\frac{r}{R(r)}\\frac{d}{dr}\\left(r\\frac{dR(r)}{dr}\\right) + k^2 r^2 = -\\frac{1}{\\Theta(\\theta)}\\frac{d^2\\Theta(\\theta)}{d\\theta^2} $$\nSince the left side depends only on $r$ and the right side only on $\\theta$, both must be equal to a separation constant, which we denote as $\\lambda^2$. This gives two ordinary differential equations:\n1.  Angular Equation: $\\frac{d^2\\Theta}{d\\theta^2} + \\lambda^2 \\Theta = 0$\n2.  Radial Equation: $r^2 \\frac{d^2 R}{dr^2} + r \\frac{dR}{dr} + (k^2 r^2 - \\lambda^2)R = 0$\n\nThe PEC wedge is defined by the surfaces $\\theta=0$ and $\\theta=\\alpha$. The boundary condition for a PEC is that the tangential component of the electric field must vanish on its surface. Here, $E_z$ is tangential to both surfaces. This imposes homogeneous Dirichlet boundary conditions on the solution:\n$$ E_z(r, 0) = 0 \\quad \\text{and} \\quad E_z(r, \\alpha) = 0 $$\nFor these conditions to hold for all $r>0$, they must be satisfied by the angular function $\\Theta(\\theta)$:\n$$ \\Theta(0) = 0 \\quad \\text{and} \\quad \\Theta(\\alpha) = 0 $$\nThe general solution to the angular equation is $\\Theta(\\theta) = A\\sin(\\lambda\\theta) + B\\cos(\\lambda\\theta)$. Applying $\\Theta(0)=0$ gives $B=0$. Applying $\\Theta(\\alpha)=0$ to the remaining solution $\\Theta(\\theta) = A\\sin(\\lambda\\theta)$ requires $\\sin(\\lambda\\alpha) = 0$ for a non-trivial solution ($A \\neq 0$). This is satisfied if $\\lambda\\alpha = n\\pi$ for any integer $n$. To ensure a valid angular dependence within the sector, we require $n \\geq 1$. The eigenvalues for the angular problem are thus $\\lambda_n = n\\pi/\\alpha$ for $n=1,2,3,\\dots$.\n\nNear the corner tip ($r \\to 0$), the term $k^2r^2$ in the radial equation (which is Bessel's equation) becomes negligible compared to the $\\lambda^2$ term. The equation simplifies to the Euler-Cauchy form:\n$$ r^2 \\frac{d^2 R}{dr^2} + r \\frac{dR}{dr} - \\lambda^2 R = 0 $$\nAssuming a solution of the form $R(r) = r^p$, we get $p(p-1) + p - \\lambda^2 = 0$, which simplifies to $p^2 = \\lambda^2$, so $p=\\pm\\lambda$. The general solution is $R(r) = C_1 r^\\lambda + C_2 r^{-\\lambda}$. For the field to be physically meaningful (i.e., finite energy in any small region around the origin), we must discard the singular term $r^{-\\lambda}$ and choose $p=\\lambda$. The field thus behaves as $E_z \\propto r^\\lambda$. The most singular (i.e., least smooth) behavior that dominates as $r \\to 0$ corresponds to the smallest positive value of $\\lambda$, which occurs for $n=1$. This gives the exact continuous singularity exponent:\n$$ \\lambda_{\\text{cont}} = \\frac{\\pi}{\\alpha} $$\n\n### Discretization and The TLM-based Numerical Model\n\nThe problem asserts that the local angular update operator within the Transmission Line Matrix (TLM) framework, using symmetrical condensed nodes, reduces to a finite-difference discretization of the second angular derivative. This connection is standard in the analysis of TLM, where in the low-frequency limit, the network equations become equivalent to a finite-difference scheme for the wave equation. Here, we analyze the discrete counterpart of the angular operator, $\\mathcal{L}_\\theta = -d^2/d\\theta^2$, which governs the field's steady-state angular variation.\n\nWe discretize the angular domain $\\theta \\in [0, \\alpha]$ into $M+1$ equal segments, creating $M$ interior nodes. The angular step is $\\Delta\\theta = \\alpha/(M+1)$. Let $\\Theta_i$ be the value of the angular function at node $\\theta_i = i\\Delta\\theta$ for $i=0, 1, \\dots, M+1$. The boundary conditions are $\\Theta_0 = 0$ and $\\Theta_{M+1} = 0$.\n\nThe continuous eigenvalue problem $-\\frac{d^2\\Theta}{d\\theta^2} = \\mu \\Theta$, with $\\mu=\\lambda^2$, is approximated at each interior node $i$ using the second-order central difference formula for the second derivative:\n$$ -\\frac{\\Theta_{i+1} - 2\\Theta_i + \\Theta_{i-1}}{(\\Delta\\theta)^2} = \\mu \\Theta_i $$\nThis can be rewritten as:\n$$ -\\Theta_{i-1} + 2\\Theta_i - \\Theta_{i+1} = \\mu (\\Delta\\theta)^2 \\Theta_i $$\nWriting this equation for each interior node $i=1, \\dots, M$ and incorporating the boundary conditions ($\\Theta_0=0$ for $i=1$, and $\\Theta_{M+1}=0$ for $i=M$) leads to a matrix eigenvalue problem $\\mathbf{L}\\vec{\\Theta} = \\mu\\vec{\\Theta}$. Here, $\\vec{\\Theta} = [\\Theta_1, \\dots, \\Theta_M]^T$ is the vector of field values at the interior nodes, and $\\mathbf{L}$ is the $M \\times M$ matrix:\n$$\n\\mathbf{L} = \\frac{1}{\\Delta\\theta^2}\\begin{bmatrix}\n2 & -1 & 0 & \\cdots & 0 \\\\\n-1 & 2 & -1 & \\ddots & \\vdots \\\\\n0 & -1 & 2 & \\ddots & 0 \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & -1 \\\\\n0 & \\cdots & 0 & -1 & 2\n\\end{bmatrix}\n$$\nThis is precisely the discrete angular operator given in the problem. The eigenvalues $\\mu_k$ of this matrix are the numerical approximations to the continuous eigenvalues $\\lambda^2 = (n\\pi/\\alpha)^2$. The smallest eigenvalue of $\\mathbf{L}$, denoted $\\mu_{\\min}$, will approximate the smallest continuous eigenvalue $\\lambda_{\\text{cont}}^2 = (\\pi/\\alpha)^2$. The numerical singularity exponent is therefore found by:\n$$ \\lambda_{\\text{num}} = \\sqrt{\\mu_{\\min}} $$\n\n### Implementation Strategy\n\nThe program will implement the numerical solution for each test case $(\\alpha, M)$.\n1.  Given $\\alpha$ and $M$, calculate the angular step $\\Delta\\theta = \\alpha / (M+1)$.\n2.  Construct the $M \\times M$ tridiagonal matrix $\\mathbf{L}$ by setting the main diagonal elements to $2/\\Delta\\theta^2$ and the first off-diagonal elements to $-1/\\Delta\\theta^2$.\n3.  Compute the eigenvalues of the real, symmetric matrix $\\mathbf{L}$. The smallest eigenvalue, $\\mu_{\\min}$, is the required value.\n4.  Calculate the numerical exponent $\\lambda_{\\text{num}} = \\sqrt{\\mu_{\\min}}$.\n5.  Calculate the exact continuous exponent $\\lambda_{\\text{cont}} = \\pi/\\alpha$.\n6.  Compute the relative error $|\\lambda_{\\text{num}} - \\lambda_{\\text{cont}}| / \\lambda_{\\text{cont}}$.\nThe results for all test cases are collected and printed in the specified format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative error between the numerical and continuous singularity\n    exponents for a PEC wedge.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (np.pi / 2, 128),    # General case\n        (np.pi / 3, 128),    # Acute wedge\n        (3 * np.pi / 4, 128),# Obtuse wedge\n        (0.95 * np.pi, 128), # Near-flat boundary\n        (np.pi / 2, 8),      # Coarse discretization\n    ]\n\n    results = []\n    for alpha, M in test_cases:\n        # Step 1: Calculate parameters\n        # M is the number of interior angular nodes.\n        # The total number of angular steps is M+1.\n        delta_theta = alpha / (M + 1)\n\n        # Step 2: Construct the discrete angular operator matrix L.\n        # L is a symmetric tridiagonal matrix representing the second-difference\n        # operator, scaled by 1/delta_theta^2.\n        \n        # Create the unscaled matrix with 2s on the main diagonal and -1s on\n        # the first off-diagonals.\n        main_diag = np.full(M, 2, dtype=float)\n        off_diag = np.full(M - 1, -1, dtype=float)\n        \n        # Assemble the unscaled matrix using numpy.diag.\n        L_unscaled = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n        \n        # Scale the matrix by 1/(delta_theta^2).\n        L = L_unscaled / (delta_theta**2)\n\n        # Step 3: Compute the eigenvalues of L.\n        # numpy.linalg.eigvalsh is used for real symmetric matrices. It is\n        # computationally efficient and returns eigenvalues in ascending order.\n        eigenvalues = np.linalg.eigvalsh(L)\n\n        # The smallest positive eigenvalue is the first element of the sorted array.\n        mu_min = eigenvalues[0]\n\n        # Step 4: Compute the numerical singularity exponent lambda_num.\n        # This is derived from the relation lambda = sqrt(mu).\n        lambda_num = np.sqrt(mu_min)\n\n        # Step 5: Compute the continuous reference exponent lambda_cont.\n        # This is the exact analytical solution for the lowest-order mode.\n        lambda_cont = np.pi / alpha\n\n        # Step 6: Calculate the relative error.\n        relative_error = np.abs(lambda_num - lambda_cont) / lambda_cont\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A crucial challenge in computational electromagnetics is modeling unbounded, open-region problems on a finite computational grid. This requires the use of Absorbing Boundary Conditions (ABCs) to prevent spurious reflections from the domain edges. This exercise  guides you through an analysis of the performance and limitations of several common ABCs, investigating how numerical dispersion on the TLM grid leads to modal mismatch at the boundary. You will quantify the reflection from these boundaries, particularly at challenging grazing angles of incidence, gaining practical insight into a fundamental aspect of real-world simulation design.",
            "id": "3357495",
            "problem": "Consider a two-dimensional Transmission Line Matrix (TLM) discrete model of electromagnetic wave propagation in a homogeneous, lossless medium characterized by vacuum permittivity $\\varepsilon_0$ and vacuum permeability $\\mu_0$, so that the speed of light is $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$. Assume a square TLM lattice with spatial step $\\Delta x = \\Delta y$ and time step $\\Delta t$ that satisfies the stability bound. Let $S = c \\Delta t / \\Delta x$ denote the Courant number on the square lattice. For a discrete plane wave of angular frequency $\\omega$ with wavenumber components $(k_x, k_y)$, the TLM discrete dispersion relation on the square lattice can be taken as the well-tested relation\n$$\n\\cos(\\omega \\Delta t) = 1 - 2 S^2 \\left[ \\sin^2\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) \\right].\n$$\nA monochromatic plane wave with continuous angular frequency $\\omega$ impinges on a computational boundary at incidence angle $\\theta$ (measured from the boundary normal), so that the continuous wavenumber magnitude is $k = \\omega/c$, and the continuous tangential component is $k_y = k \\sin\\theta$. In the discrete lattice, the wave must satisfy the discrete dispersion relation above; assume $k_y$ is imposed by the incidence geometry and the discrete $k_x$ is determined by the dispersion relation at that $\\omega$ and $k_y$.\n\nAt the boundary, one of three absorbing boundary constructions is applied:\n\n1. Mur first-order absorbing boundary condition (Mur ABC): Modeled as a one-way wave operator with normal phase speed equal to $c$, i.e. a boundary operator of the form $\\left( \\partial/\\partial t + c \\, \\partial/\\partial n \\right) u = 0$ acting on the total field $u$ at the boundary.\n\n2. Liao higher-order absorbing boundary condition (Liao ABC): Modeled as a truncated series approximation to the exact one-way operator that accounts for oblique incidence via the square-root operator in the continuous Helmholtz relation. When evaluated on a plane wave of angle $\\theta$, this produces an effective normal phase speed $v_b$ approximating $c \\cos\\theta$. Use the second-order truncation in the variable $u = \\sin^2\\theta$,\n$$\nv_b(\\theta) \\approx c \\left( 1 - \\frac{u}{2} - \\frac{u^2}{8} \\right), \\quad u = \\sin^2\\theta,\n$$\nas a model of the Liao ABC’s modal matching at the boundary.\n\n3. Perfectly Matched Layer (PML): Modeled as a finite-thickness, ideally matched, lossy layer of thickness $d$ with a linearly graded conductivity profile $\\sigma(x) = \\sigma_{\\max} \\, x/d$ for $0 \\le x \\le d$. In the continuum limit with ideal matching, the amplitude reflection at normal incidence is approximately $R \\approx \\exp(-2 \\alpha)$ with $\\alpha = \\sigma_{\\max} d /(4 Z_0)$, where $Z_0 = \\sqrt{\\mu_0/\\varepsilon_0}$ is the free-space impedance. Design $\\sigma_{\\max}$ to achieve a target normal-incidence reflection $R_0$; assume this ideal reflection magnitude applies for all angles and frequencies in this simplified quantification (i.e. ignore discretization-induced PML error for the purpose of computing $R(\\theta,f)$ in this problem).\n\nFor a TLM-discrete plane wave inside the lattice, model the reflection coefficient at the boundary by enforcing the boundary operator on the superposition of forward and backward normal-propagating components. Under the plane wave ansatz, this reduces to matching the operator acting on $e^{-j(\\omega t - k_x x - k_y y)}$ and $e^{-j(\\omega t + k_x x - k_y y)}$ at the boundary. This leads to a reflection coefficient magnitude of the generic form\n$$\nR(\\theta, f) = \\left| \\frac{\\omega - v_b(\\theta) \\, k_x^{\\mathrm{(d)}}(\\omega, k_y)}{\\omega + v_b(\\theta) \\, k_x^{\\mathrm{(d)}}(\\omega, k_y)} \\right|,\n$$\nwhere $v_b(\\theta)$ depends on the absorbing boundary construction and $k_x^{\\mathrm{(d)}}(\\omega, k_y)$ is obtained from the TLM discrete dispersion relation. For Mur ABC, take $v_b(\\theta) = c$. For Liao ABC, take $v_b(\\theta)$ as given above. For PML, take $R(\\theta,f) = R_0$ independent of $\\theta$ and $f$ under the idealized modeling assumption.\n\nIf the discrete dispersion relation yields no real $k_x^{\\mathrm{(d)}}$ (i.e. the computed $s_x^2$ would be negative or exceed unity), treat the mode as non-propagating in the boundary-normal direction and assign $R(\\theta, f) = 1$ for Mur and Liao ABCs (total reflection in the absence of a real propagating mode), while the PML’s $R(\\theta,f)$ remains the designed $R_0$.\n\nStarting from Maxwell’s equations in vacuum and the TLM discrete plane-wave model, derive the above reflection-coefficient construction and explain, for each ABC, how modal mismatch at the discrete boundary produces reflection at grazing incidence. In particular, show why the Mur ABC, which assumes $v_b(\\theta) = c$, incurs large reflection as $\\theta \\to 90^\\circ$, and why finite-order Liao ABC truncations can perform worse than Mur at very high obliquity due to poor approximation of $c \\cos\\theta$ when $\\sin^2\\theta \\approx 1$. Explain why, under the ideal matching assumption, the Perfectly Matched Layer remains robust with reflection $R_0$ independent of angle and frequency.\n\nImplement a program that computes $R(\\theta, f)$ for the three ABCs using the TLM discrete dispersion relation and the models specified above. Use the following physical and numerical parameters:\n- $c = 2.99792458 \\times 10^8$ m/s.\n- $Z_0 = 376.730313668$ $\\Omega$.\n- Spatial step $\\Delta x = 1.0 \\times 10^{-3}$ m.\n- Courant number $S = 1/\\sqrt{2}$.\n- Time step $\\Delta t = S \\Delta x / c$.\n- PML thickness $d = 8 \\Delta x$.\n- Designed normal-incidence reflection for PML $R_0 = 1.0 \\times 10^{-3}$, used to set $\\sigma_{\\max}$ via $\\alpha = \\frac{1}{2}\\ln(1/R_0)$ and $\\sigma_{\\max} = 4 Z_0 \\alpha / d$; then treat $R(\\theta, f) = R_0$ for PML in the output.\n\nYour program must evaluate the following test suite of incidence angles (in degrees) and frequencies (in Hz):\n- Case 1: $\\theta = 80^\\circ$, $f = 3.0 \\times 10^9$ Hz.\n- Case 2: $\\theta = 85^\\circ$, $f = 3.0 \\times 10^9$ Hz.\n- Case 3: $\\theta = 89^\\circ$, $f = 3.0 \\times 10^9$ Hz.\n- Case 4: $\\theta = 89.9^\\circ$, $f = 3.0 \\times 10^9$ Hz.\n- Case 5: $\\theta = 89^\\circ$, $f = 9.0 \\times 10^9$ Hz.\n\nFor each case, compute and return a list of three floats $[R_{\\mathrm{Mur}}, R_{\\mathrm{Liao}}, R_{\\mathrm{PML}}]$, where each float is the reflection coefficient magnitude rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list of these lists, enclosed in square brackets, in the order of the test suite. For example, a valid output format is\n$$\n[\\,[r_{11},r_{12},r_{13}],\\,[r_{21},r_{22},r_{23}],\\,\\dots\\,]\n$$\nAngles are specified in degrees, and the reflection coefficient is dimensionless; express each reflection coefficient as a decimal rounded to six decimal places.",
            "solution": "The problem requires an analysis and calculation of the reflection coefficient magnitude $R(\\theta, f)$ for plane waves in a two-dimensional Transmission Line Matrix (TLM) grid model, encountering one of three different absorbing boundary constructions: the first-order Mur Absorbing Boundary Condition (ABC), a second-order Liao ABC, and an idealized Perfectly Matched Layer (PML).\n\nFirst, we derive the generic reflection coefficient formula. Let the boundary be located at $x=0$, with the computational domain in the half-space $x<0$. A time-harmonic plane wave with angular frequency $\\omega$ is incident on this boundary. The total field $u(x,y,t)$ is a superposition of the incident wave and a reflected wave. We use the electrical engineering phasor convention $e^{-j\\omega t}$. The incident wave propagating towards $+x$ and the reflected wave propagating towards $-x$ are given by:\n$$\nu_i(x,y,t) = A \\, e^{-j(\\omega t - k_x^{\\mathrm{(d)}} x - k_y y)}\n$$\n$$\nu_r(x,y,t) = R A \\, e^{-j(\\omega t + k_x^{\\mathrm{(d)}} x - k_y y)}\n$$\nHere, $k_x^{\\mathrm{(d)}}$ is the magnitude of the discrete wavenumber component normal to the boundary, $k_y$ is the tangential wavenumber component, $A$ is the incident amplitude, and $R$ is the complex reflection coefficient. The total field is $u = u_i + u_r$.\n$$\nu(x,y,t) = A \\left( e^{j k_x^{\\mathrm{(d)}} x} + R e^{-j k_x^{\\mathrm{(d)}} x} \\right) e^{-j(\\omega t - k_y y)}\n$$\nThe absorbing boundary constructions are modeled by a one-way wave operator of the form $\\left( \\frac{\\partial}{\\partial t} + v_b(\\theta) \\frac{\\partial}{\\partial n} \\right) u = 0$, where $\\hat{n}=\\hat{x}$ is the outward normal and $v_b(\\theta)$ is an effective phase speed characterizing the boundary. Applying this operator to the total field $u$ at the boundary $x=0$:\n$$\n\\frac{\\partial u}{\\partial t} = -j\\omega u \\quad \\implies \\quad \\left.\\frac{\\partial u}{\\partial t}\\right|_{x=0} = -j\\omega A(1+R) e^{-j(\\omega t - k_y y)}\n$$\n$$\n\\frac{\\partial u}{\\partial x} = A \\left( j k_x^{\\mathrm{(d)}} e^{j k_x^{\\mathrm{(d)}} x} - j R k_x^{\\mathrm{(d)}} e^{-j k_x^{\\mathrm{(d)}} x} \\right) e^{-j(\\omega t - k_y y)} \\quad \\implies \\quad \\left.\\frac{\\partial u}{\\partial x}\\right|_{x=0} = j k_x^{\\mathrm{(d)}} A(1-R) e^{-j(\\omega t - k_y y)}\n$$\nSubstituting these into the boundary condition at $x=0$:\n$$\n-j\\omega A(1+R) + v_b(\\theta) \\left( j k_x^{\\mathrm{(d)}} A(1-R) \\right) = 0\n$$$$\n-\\omega(1+R) + v_b(\\theta) k_x^{\\mathrm{(d)}} (1-R) = 0\n$$$$\nv_b(\\theta) k_x^{\\mathrm{(d)}} - \\omega = R \\left( \\omega + v_b(\\theta) k_x^{\\mathrm{(d)}} \\right)\n$$$$\nR = \\frac{v_b(\\theta) k_x^{\\mathrm{(d)}} - \\omega}{v_b(\\theta) k_x^{\\mathrm{(d)}} + \\omega}\n$$\nThe magnitude of the reflection coefficient is therefore:\n$$\nR(\\theta, f) = |R| = \\left| \\frac{v_b(\\theta) k_x^{\\mathrm{(d)}} - \\omega}{v_b(\\theta) k_x^{\\mathrm{(d)}} + \\omega} \\right| = \\left| \\frac{\\omega - v_b(\\theta) k_x^{\\mathrm{(d)}}}{\\omega + v_b(\\theta) k_x^{\\mathrm{(d)}}} \\right|\n$$\nThis matches the formula provided in the problem statement. Perfect absorption ($R=0$) occurs when the boundary's effective velocity matches the wave's normal phase velocity on the grid, i.e., $v_b(\\theta) = \\omega / k_x^{\\mathrm{(d)}}$. Any mismatch results in reflection.\n\nThe discrete normal wavenumber $k_x^{\\mathrm{(d)}}$ is determined by the TLM grid's dispersion relation. Given the parameters $\\omega$, $\\Delta t$, $S=c\\Delta t/\\Delta x$, and $k_y = (\\omega/c)\\sin\\theta$, we solve for $k_x^{\\mathrm{(d)}}$:\n$$\n\\cos(\\omega \\Delta t) = 1 - 2 S^2 \\left[ \\sin^2\\left(\\frac{k_x^{\\mathrm{(d)}} \\Delta x}{2}\\right) + \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right) \\right]\n$$\nLet's denote $s_x = \\sin(k_x^{\\mathrm{(d)}} \\Delta x / 2)$ and $s_y = \\sin(k_y \\Delta x / 2)$. Rearranging gives:\n$$\ns_x^2 = \\sin^2\\left(\\frac{k_x^{\\mathrm{(d)}} \\Delta x}{2}\\right) = \\frac{1 - \\cos(\\omega \\Delta t)}{2 S^2} - \\sin^2\\left(\\frac{k_y \\Delta x}{2}\\right)\n$$\nFor a real propagating mode to exist in the $x$-direction, we must have a real solution for $k_x^{\\mathrm{(d)}}$, which requires $0 \\le s_x^2 \\le 1$. If $s_x^2 < 0$, the wavenumber $k_x^{\\mathrm{(d)}}$ becomes imaginary, representing an evanescent (non-propagating) wave. In this case, for a lossless boundary model like Mur or Liao, the wave is totally reflected, so $R=1$.\n\nWe now analyze each ABC:\n1.  **Mur First-Order ABC**: This simple ABC assumes waves impinge normally. It models the boundary with an effective speed $v_b(\\theta) = c$, independent of the angle of incidence $\\theta$. In the continuum, the normal phase velocity of a plane wave is $c_x = c/\\cos\\theta$. The Mur ABC thus provides a perfect match only for normal incidence ($\\theta=0$). As incidence becomes more grazing ($\\theta \\to 90^\\circ$), the continuous normal wavenumber $k_x = k \\cos\\theta$ approaches $0$, and the normal phase velocity $c/\\cos\\theta$ approaches infinity. The discrete normal wavenumber $k_x^{\\mathrm{(d)}}$, as calculated from the dispersion relation, also approaches $0$. The Mur ABC attempts to match this with a fixed velocity $v_b=c$. The mismatch between the wave's large normal phase velocity $\\omega/k_x^{\\mathrm{(d)}}$ and the boundary's fixed velocity $c$ becomes severe. In the reflection formula, as $k_x^{\\mathrm{(d)}} \\to 0$, the term $v_b k_x^{\\mathrm{(d)}}$ becomes small compared to $\\omega$, causing the ratio $|R|$ to approach $|\\omega/\\omega| = 1$. This explains the high reflection at grazing incidence.\n\n2.  **Liao Higher-Order ABC**: The Liao ABC attempts to improve upon Mur by accounting for oblique incidence. The problem provides a model for its effective velocity based on a second-order Taylor series approximation of $c \\cos\\theta$: $v_b(\\theta) \\approx c (1 - u/2 - u^2/8)$ with $u = \\sin^2\\theta$. This model choice in the problem is somewhat unusual, as the ideal operator should match the normal phase velocity $c/\\cos\\theta$, not $c \\cos\\theta$. However, adhering to the problem statement, we analyze this model. This approximation of $c \\cos\\theta$ is accurate for small $\\theta$ (small $u$) but degrades significantly as $\\theta \\to 90^\\circ$ (where $u \\to 1$). At $u=1$, the model gives $v_b = c(1-1/2-1/8) = 0.375c$, whereas the true value of $c\\cos\\theta$ goes to $0$. The Mur ABC uses $v_b=c$. Since $0.375c < c$, the Liao boundary velocity is smaller than Mur's at high angles. The reflection magnitude can be expressed as a function of the product $v_b k_x^{\\mathrm{(d)}}$. As $\\theta \\to 90^\\circ$, $k_x^{\\mathrm{(d)}} \\to 0$. For a small argument $z$, $|(1-z)/(1+z)| \\approx 1-2z$. Thus, $R \\approx 1 - 2v_b k_x^{\\mathrm{(d)}}/\\omega$. A smaller $v_b$ leads to a value of $R$ that is closer to $1$. Since $v_b^{\\text{Liao}} < v_b^{\\text{Mur}}$ at high angles, the Liao ABC, as modeled here, yields a higher reflection coefficient, performing worse than the simpler Mur ABC.\n\n3.  **Perfectly Matched Layer (PML)**: The PML is not a boundary condition in the same operator sense as Mur or Liao. It is a fictitious, lossy medium designed to be perfectly impedance-matched to the computational domain. In an ideal PML, a wave of any frequency and any non-grazing angle of incidence enters the layer without reflection at the interface. Once inside, the wave is attenuated by the layer's artificial conductivity $\\sigma$. The problem specifies an idealized model where these properties hold perfectly, ignoring discretization-induced reflections. The reflection $R_0$ that is calculated arises from the finite thickness $d$ of the layer; it represents the portion of the wave that travels through the layer, reflects off its back wall (assumed to be a perfect conductor), and travels back to the interface, being attenuated on both passes. The total attenuation factor for the amplitude is $e^{-\\alpha}$, so the round-trip reflection is modeled as $R_0 \\approx e^{-2\\alpha}$, assuming the front interface is perfectly matched. Thus, under this idealization, the reflection coefficient is constant at the designed value $R_0$, independent of angle and frequency.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reflection coefficient magnitude for Mur, Liao, and PML\n    absorbing boundaries in a 2D TLM grid model.\n    \"\"\"\n    # Physical and numerical parameters\n    c = 2.99792458e8  # Speed of light in vacuum (m/s)\n    delta_x = 1.0e-3    # Spatial step (m)\n    S = 1.0 / np.sqrt(2.0) # Courant number\n    delta_t = S * delta_x / c # Time step (s)\n    R0_pml = 1.0e-3 # Designed normal-incidence reflection for PML\n\n    # Test suite of incidence angles (degrees) and frequencies (Hz)\n    test_cases = [\n        (80.0, 3.0e9),\n        (85.0, 3.0e9),\n        (89.0, 3.0e9),\n        (89.9, 3.0e9),\n        (89.0, 9.0e9),\n    ]\n\n    all_results = []\n\n    for theta_deg, f in test_cases:\n        # Convert angle to radians\n        theta = np.deg2rad(theta_deg)\n        \n        # Calculate wave parameters\n        omega = 2.0 * np.pi * f  # Angular frequency (rad/s)\n        k = omega / c            # Continuous wavenumber (rad/m)\n        ky = k * np.sin(theta)   # Tangential wavenumber\n\n        # --- Calculate discrete normal wavenumber kx_d ---\n        \n        # Terms for the discrete dispersion relation\n        omega_dt = omega * delta_t\n        ky_dx = ky * delta_x\n        \n        cos_omega_dt = np.cos(omega_dt)\n        sy_sq = np.sin(ky_dx / 2.0)**2\n        \n        # Solve for sin^2(kx_d * delta_x / 2)\n        sx_sq = (1.0 - cos_omega_dt) / (2.0 * S**2) - sy_sq\n        \n        # --- Handle evanescent case ---\n        if sx_sq < 0 or sx_sq > 1:\n            R_mur = 1.0\n            R_liao = 1.0\n            R_pml = R0_pml\n        else:\n            # --- Propagating case: calculate kx_d ---\n            sx = np.sqrt(sx_sq)\n            # arcsin(sx) gives kx_d * delta_x / 2\n            kx_d = (2.0 / delta_x) * np.arcsin(sx)\n\n            # --- Calculate reflection coefficients ---\n            \n            # Mur ABC\n            vb_mur = c\n            num_mur = omega - vb_mur * kx_d\n            den_mur = omega + vb_mur * kx_d\n            R_mur = np.abs(num_mur / den_mur)\n            \n            # Liao ABC (2nd order approximation model)\n            u = np.sin(theta)**2\n            vb_liao = c * (1.0 - u / 2.0 - u**2 / 8.0)\n            num_liao = omega - vb_liao * kx_d\n            den_liao = omega + vb_liao * kx_d\n            R_liao = np.abs(num_liao / den_liao)\n            \n            # PML (idealized model)\n            R_pml = R0_pml\n\n        all_results.append([R_mur, R_liao, R_pml])\n\n    # Format the output string as specified\n    result_strings = []\n    for r_mur, r_liao, r_pml in all_results:\n        result_strings.append(f\"[{r_mur:.6f},{r_liao:.6f},{r_pml:.6f}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}