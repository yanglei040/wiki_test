{
    "hands_on_practices": [
        {
            "introduction": "At the heart of any finite-volume method lies the numerical flux, which approximates the flow of quantities between adjacent cells. This exercise  challenges you to derive the Godunov flux for an electromagnetic wave at a material interface by solving the exact Riemann problem. Mastering this practice provides deep insight into how modern, high-resolution FVTD schemes capture complex wave phenomena like reflection and transmission with high fidelity.",
            "id": "3307955",
            "problem": "Consider the one-dimensional transverse-electric configuration for Maxwell’s equations in a heterogeneous, lossless, source-free medium with a planar interface at $x=0$. The materials occupy half-spaces: medium $1$ for $x<0$ with permittivity $\\epsilon_1$ and permeability $\\mu_1$, and medium $2$ for $x>0$ with permittivity $\\epsilon_2$ and permeability $\\mu_2$. The tangential field components are $E_y(x,t)$ and $H_z(x,t)$. The governing equations are the Maxwell curl equations specialized to one dimension,\n$$\n\\frac{\\partial D_y}{\\partial t} + \\frac{\\partial H_z}{\\partial x} = 0, \n\\qquad\n\\frac{\\partial B_z}{\\partial t} + \\frac{\\partial E_y}{\\partial x} = 0,\n$$\ntogether with the constitutive relations $D_y=\\epsilon(x) E_y$ and $B_z=\\mu(x) H_z$, where $\\epsilon(x)=\\epsilon_1$ for $x<0$ and $\\epsilon(x)=\\epsilon_2$ for $x>0$, and similarly for $\\mu(x)$. Assume there are no free surface currents or charges at $x=0$, so the tangential fields are continuous at the interface.\n\nIn a finite-volume time-domain method, one can cast the system in conservation form for the conserved variables $\\boldsymbol{Q}=(D_y, B_z)^{\\top}$ with flux $\\boldsymbol{F}(\\boldsymbol{Q})=(H_z, E_y)^{\\top}$, and use the exact interfacial Riemann solution at $x=0$ to define the Godunov numerical flux $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$.\n\nAssume the left medium has parameters $\\epsilon_1=\\epsilon_0$, $\\mu_1=\\mu_0$ and the right medium has parameters $\\epsilon_2=4\\epsilon_0$, $\\mu_2=\\mu_0$. Let the initial data at $t=0^+$ be a right-going plane wave incident from the left with left state $(E_y,H_z)=(1, 1/Z_1)$ in medium $1$ and a quiescent right state $(E_y,H_z)=(0,0)$ in medium $2$, where the wave impedances are $Z_i=\\sqrt{\\mu_i/\\epsilon_i}$ and $Z_0=\\sqrt{\\mu_0/\\epsilon_0}$. \n\nStarting from Maxwell’s equations and the interfacial continuity of tangential fields, derive the exact interfacial Riemann solution in terms of the characteristic variables appropriate to each medium, and from it determine:\n- the Godunov numerical flux $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$ at $x=0$, and\n- the transmitted electric field amplitude $E_y$ into medium $2$.\n\nExpress your final answer as a single row vector whose entries are, in order, $H_z^{\\ast}$, $E_y^{\\ast}$, and the transmitted $E_y$ amplitude, as closed-form analytic expressions in terms of $Z_0$. Do not insert a numerical value for $Z_0$. Do not append units in your final answer; it is understood that the first entry has the units of $H_z$ and the second and third have the units of $E_y$. No rounding is required.",
            "solution": "The problem requires the determination of the Godunov numerical flux and the transmitted electric field amplitude at a planar interface between two dielectric media. This is a classic Riemann problem for a linear hyperbolic system of equations, namely the one-dimensional Maxwell's equations.\n\nThe governing equations in a homogeneous medium $i$ (with permittivity $\\epsilon_i$ and permeability $\\mu_i$) are:\n$$\n\\epsilon_i \\frac{\\partial E_y}{\\partial t} + \\frac{\\partial H_z}{\\partial x} = 0\n$$\n$$\n\\mu_i \\frac{\\partial H_z}{\\partial t} + \\frac{\\partial E_y}{\\partial x} = 0\n$$\nThis system can be written in matrix form as $\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\boldsymbol{A}_i \\frac{\\partial \\boldsymbol{U}}{\\partial x} = \\boldsymbol{0}$, where $\\boldsymbol{U} = (E_y, H_z)^{\\top}$ and the system matrix is $\\boldsymbol{A}_i = \\begin{pmatrix} 0 & 1/\\epsilon_i \\\\ 1/\\mu_i & 0 \\end{pmatrix}$.\n\nTo solve the Riemann problem, we perform a characteristic analysis. The eigenvalues of $\\boldsymbol{A}_i$ are found from $\\det(\\boldsymbol{A}_i - \\lambda\\boldsymbol{I}) = \\lambda^2 - 1/(\\epsilon_i\\mu_i) = 0$, which gives the characteristic speeds $\\lambda = \\pm v_i$, where $v_i = 1/\\sqrt{\\epsilon_i\\mu_i}$ is the speed of light in medium $i$.\n\nThe corresponding left eigenvectors $\\boldsymbol{l}$ are found by solving $\\boldsymbol{l}^{\\top}(\\boldsymbol{A}_i - \\lambda\\boldsymbol{I}) = \\boldsymbol{0}$.\nFor $\\lambda = +v_i$: $\\boldsymbol{l}_1^{\\top} = (1, Z_i)$, where $Z_i = \\sqrt{\\mu_i/\\epsilon_i}$ is the wave impedance of medium $i$.\nFor $\\lambda = -v_i$: $\\boldsymbol{l}_2^{\\top} = (1, -Z_i)$.\n\nThe characteristic variables (or Riemann invariants) are found by taking the dot product of the left eigenvectors with the state vector $\\boldsymbol{U}$.\n$1$. The quantity $w_1 = \\boldsymbol{l}_1^{\\top}\\boldsymbol{U} = E_y + Z_i H_z$ is constant along characteristics moving to the right, i.e., lines with slope $dx/dt = +v_i$.\n$2$. The quantity $w_2 = \\boldsymbol{l}_2^{\\top}\\boldsymbol{U} = E_y - Z_i H_z$ is constant along characteristics moving to the left, i.e., lines with slope $dx/dt = -v_i$.\n\nThe initial condition specifies a discontinuity at $x=0$ at time $t=0$, separating a left state $(E_{y,L}, H_{z,L})$ in medium $1$ from a right state $(E_{y,R}, H_{z,R})$ in medium $2$. For $t>0$, the solution at the interface $x=0$ is a constant state, the so-called star state, $(E_y^{\\ast}, H_z^{\\ast})$. This state is the solution to the Riemann problem at the interface and provides the values for the Godunov flux, $\\boldsymbol{F}^{\\ast}=(H_z^{\\ast}, E_y^{\\ast})^{\\top}$.\n\nThis star state must be connected to the initial states by waves propagating away from the interface.\n- The star state $(E_y^{\\ast}, H_z^{\\ast})$ is connected to the left state $(E_{y,L}, H_{z,L})$ by a left-propagating wave in medium $1$. Across this wave, the characteristic variable $E_y + Z_1 H_z$ is conserved.\n$$ E_y^{\\ast} + Z_1 H_z^{\\ast} = E_{y,L} + Z_1 H_{z,L} $$\n- The star state $(E_y^{\\ast}, H_z^{\\ast})$ is connected to the right state $(E_{y,R}, H_{z,R})$ by a right-propagating wave in medium $2$. Across this wave, the characteristic variable $E_y - Z_2 H_z$ is conserved.\n$$ E_y^{\\ast} - Z_2 H_z^{\\ast} = E_{y,R} - Z_2 H_{z,R} $$\n\nWe now substitute the specific parameters given in the problem.\nFor medium $1$ ($x<0$): $\\epsilon_1 = \\epsilon_0$, $\\mu_1 = \\mu_0$. The impedance is $Z_1 = \\sqrt{\\mu_1/\\epsilon_1} = \\sqrt{\\mu_0/\\epsilon_0} = Z_0$.\nFor medium $2$ ($x>0$): $\\epsilon_2 = 4\\epsilon_0$, $\\mu_2 = \\mu_0$. The impedance is $Z_2 = \\sqrt{\\mu_2/\\epsilon_2} = \\sqrt{\\mu_0/(4\\epsilon_0)} = \\frac{1}{2}\\sqrt{\\mu_0/\\epsilon_0} = \\frac{1}{2}Z_0$.\n\nThe initial states are:\n- Left state $(L)$: A right-going wave with $E_y=1$. For such a wave, $H_z = E_y/Z_1$. So, $(E_{y,L}, H_{z,L}) = (1, 1/Z_1) = (1, 1/Z_0)$.\n- Right state $(R)$: Quiescent medium. $(E_{y,R}, H_{z,R}) = (0, 0)$.\n\nSubstituting these into the two conservation equations for the characteristic variables:\nFrom the left-propagating wave in medium $1$:\n$$ E_y^{\\ast} + Z_0 H_z^{\\ast} = 1 + Z_0 \\left(\\frac{1}{Z_0}\\right) = 1+1=2 $$\nFrom the right-propagating wave in medium $2$:\n$$ E_y^{\\ast} - \\frac{1}{2}Z_0 H_z^{\\ast} = 0 - \\frac{1}{2}Z_0(0) = 0 $$\n\nWe have a system of two linear equations for $E_y^{\\ast}$ and $H_z^{\\ast}$:\n$1$. $E_y^{\\ast} + Z_0 H_z^{\\ast} = 2$\n$2$. $E_y^{\\ast} - \\frac{1}{2}Z_0 H_z^{\\ast} = 0$\n\nFrom equation $(2)$, we find $E_y^{\\ast} = \\frac{1}{2}Z_0 H_z^{\\ast}$.\nSubstituting this into equation $(1)$:\n$$ \\left(\\frac{1}{2}Z_0 H_z^{\\ast}\\right) + Z_0 H_z^{\\ast} = 2 $$\n$$ \\frac{3}{2}Z_0 H_z^{\\ast} = 2 $$\n$$ H_z^{\\ast} = \\frac{4}{3Z_0} $$\n\nNow, we find $E_y^{\\ast}$:\n$$ E_y^{\\ast} = \\frac{1}{2}Z_0 H_z^{\\ast} = \\frac{1}{2}Z_0 \\left(\\frac{4}{3Z_0}\\right) = \\frac{4}{6} = \\frac{2}{3} $$\n\nThe Godunov numerical flux at the interface is $\\boldsymbol{F}^{\\ast} = (H_z^{\\ast}, E_y^{\\ast})^{\\top}$. The components are:\n$$ H_z^{\\ast} = \\frac{4}{3Z_0} $$\n$$ E_y^{\\ast} = \\frac{2}{3} $$\n\nThe final quantity to determine is the transmitted electric field amplitude into medium $2$. The wave transmitted into medium $2$ is the right-propagating wave that connects the initial right state $(0,0)$ to the star state $(E_y^{\\ast}, H_z^{\\ast})$. The fields in the region $0 < x < v_2 t$ are constant and equal to $(E_y^{\\ast}, H_z^{\\ast})$. Therefore, the amplitude of the transmitted electric field is precisely $E_y^{\\ast}$.\n$$ E_{y, \\text{transmitted}} = E_y^{\\ast} = \\frac{2}{3} $$\n\nThe problem asks for the three values ($H_z^{\\ast}$, $E_y^{\\ast}$, and the transmitted $E_y$ amplitude) as a single row vector. These are, in order: $\\frac{4}{3Z_0}$, $\\frac{2}{3}$, and $\\frac{2}{3}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4}{3Z_0} & \\frac{2}{3} & \\frac{2}{3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The accuracy of an FVTD simulation depends critically on how we represent the fields within each cell and reconstruct their values at interfaces. This practice  guides you through a Fourier analysis to quantify the phase error introduced by first- and second-order spatial reconstructions. By completing this analysis, you will develop a crucial skill for evaluating and designing numerical schemes that minimize dispersion and accurately simulate wave propagation.",
            "id": "3307959",
            "problem": "Consider one-dimensional propagation of a Transverse Electric (TE) mode in free space governed by Maxwell’s equations. For fields varying only along the spatial coordinate $x$, the relevant components satisfy\n$$\n\\frac{\\partial E_{y}}{\\partial t} = -\\frac{1}{\\varepsilon_{0}}\\frac{\\partial H_{z}}{\\partial x}, \\quad \\frac{\\partial H_{z}}{\\partial t} = -\\frac{1}{\\mu_{0}}\\frac{\\partial E_{y}}{\\partial x},\n$$\nwhere $E_{y}(x,t)$ and $H_{z}(x,t)$ denote the transverse electric and magnetic fields, respectively, and $\\varepsilon_{0}$ and $\\mu_{0}$ are the permittivity and permeability of free space. Consider a monochromatic plane wave with sinusoidal spatial dependence at a fixed time $t$ so that the complex representation of the electric field is\n$$\nE_{y}(x) = E_{0}\\exp(i k x),\n$$\nwhere $E_{0}\\in\\mathbb{C}$ is a constant amplitude and $k>0$ is the real wavenumber.\n\nIn a Finite-Volume Time-Domain (FVTD) discretization on a uniform grid of spacing $\\Delta x$, the primary unknowns are cell averages. Let cell $i$ be centered at $x_{i}$ and bounded by faces at $x_{i\\pm\\frac{1}{2}} = x_{i} \\pm \\frac{\\Delta x}{2}$. The cell-average electric field is defined as\n$$\n\\overline{E}_{i} \\equiv \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} E_{y}(x)\\,dx.\n$$\nSuppose one reconstructs the pointwise field at the right face $x_{i+\\frac{1}{2}}$ from the cell averages by two spatial reconstructions:\n- First-order (piecewise constant) reconstruction:\n$$\nE_{i+\\frac{1}{2},L}^{(1)} = \\overline{E}_{i},\n$$\ni.e., the left state at the face is taken to be the cell-average in cell $i$.\n- Second-order (piecewise linear) reconstruction without limiting (MUSCL-type) using a centered slope from cell averages:\n$$\ns_{i} = \\frac{\\overline{E}_{i+1} - \\overline{E}_{i-1}}{2\\,\\Delta x}, \\quad E_{i+\\frac{1}{2},L}^{(2)} = \\overline{E}_{i} + \\frac{\\Delta x}{2}\\,s_{i}.\n$$\n\nDefine the phase error of the reconstruction at the face $x_{i+\\frac{1}{2}}$ as the argument (in radians) of the complex ratio of the reconstructed value to the exact field value at that face:\n$$\n\\phi^{(m)} \\equiv \\arg\\!\\left(\\frac{E_{i+\\frac{1}{2},L}^{(m)}}{E_{y}(x_{i+\\frac{1}{2}})}\\right), \\quad m\\in\\{1,2\\}.\n$$\nStarting from the above definitions and the sinusoidal field $E_{y}(x)=E_{0}\\exp(i k x)$, derive closed-form expressions for $\\phi^{(1)}$ and $\\phi^{(2)}$ as functions of $k$ and $\\Delta x$. Express the final phase errors in radians. The final answer must be the pair $\\phi^{(1)}$ and $\\phi^{(2)}$ written as a single row matrix using the LaTeX $pmatrix$ environment.",
            "solution": "The objective is to derive closed-form expressions for the phase errors, $\\phi^{(1)}$ and $\\phi^{(2)}$, associated with first-order and second-order spatial reconstructions of a sinusoidal electric field in a Finite-Volume Time-Domain (FVTD) context.\n\nFirst, we calculate the cell average $\\overline{E}_{i}$ for cell $i$. The cell $i$ is centered at $x_i$ and has width $\\Delta x$, covering the interval $[x_i - \\frac{\\Delta x}{2}, x_i + \\frac{\\Delta x}{2}]$. The electric field is given by its complex representation $E_y(x) = E_{0}\\exp(i k x)$.\n\nThe cell average $\\overline{E}_{i}$ is defined as:\n$$\n\\overline{E}_{i} = \\frac{1}{\\Delta x}\\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} E_{y}(x)\\,dx = \\frac{1}{\\Delta x}\\int_{x_{i} - \\frac{\\Delta x}{2}}^{x_{i} + \\frac{\\Delta x}{2}} E_{0}\\exp(i k x)\\,dx\n$$\nWe perform the integration:\n$$\n\\overline{E}_{i} = \\frac{E_{0}}{\\Delta x} \\left[ \\frac{\\exp(i k x)}{i k} \\right]_{x_{i} - \\frac{\\Delta x}{2}}^{x_{i} + \\frac{\\Delta x}{2}} = \\frac{E_{0}}{i k \\Delta x} \\left[ \\exp\\left(ik\\left(x_i + \\frac{\\Delta x}{2}\\right)\\right) - \\exp\\left(ik\\left(x_i - \\frac{\\Delta x}{2}\\right)\\right) \\right]\n$$\nFactoring out the term $\\exp(i k x_i)$:\n$$\n\\overline{E}_{i} = \\frac{E_{0}\\exp(i k x_i)}{i k \\Delta x} \\left[ \\exp\\left(i k\\frac{\\Delta x}{2}\\right) - \\exp\\left(-i k\\frac{\\Delta x}{2}\\right) \\right]\n$$\nUsing Euler's identity $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, the term in the brackets becomes $2i \\sin(k\\frac{\\Delta x}{2})$.\n$$\n\\overline{E}_{i} = \\frac{E_{0}\\exp(i k x_i)}{i k \\Delta x} \\left( 2i \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right) = E_{0}\\exp(i k x_i) \\frac{2\\sin(k \\Delta x / 2)}{k \\Delta x}\n$$\nTo simplify notation, we can write this as:\n$$\n\\overline{E}_{i} = E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\n\nNow, we derive the phase error for the first-order reconstruction, $\\phi^{(1)}$.\nThe first-order reconstruction at the left of the face $x_{i+\\frac{1}{2}}$ is given by $E_{i+\\frac{1}{2},L}^{(1)} = \\overline{E}_{i}$.\n$$\nE_{i+\\frac{1}{2},L}^{(1)} = E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\nThe exact value of the field at this face is:\n$$\nE_{y}(x_{i+\\frac{1}{2}}) = E_{y}\\left(x_i + \\frac{\\Delta x}{2}\\right) = E_{0}\\exp\\left(ik\\left(x_i + \\frac{\\Delta x}{2}\\right)\\right) = E_{0}\\exp(i k x_i)\\exp\\left(i\\frac{k \\Delta x}{2}\\right)\n$$\nThe phase error $\\phi^{(1)}$ is the argument of the ratio of the reconstructed value to the exact value:\n$$\n\\phi^{(1)} = \\arg\\left(\\frac{E_{i+\\frac{1}{2},L}^{(1)}}{E_{y}(x_{i+\\frac{1}{2}})}\\right) = \\arg\\left( \\frac{E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}}{E_{0}\\exp(i k x_i)\\exp(i k \\Delta x / 2)} \\right)\n$$\n$$\n\\phi^{(1)} = \\arg\\left( \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\exp\\left(-i\\frac{k \\Delta x}{2}\\right) \\right)\n$$\nFor a numerically well-resolved wave, the number of points per wavelength is greater than $2$, which implies $k \\Delta x < \\pi$. In this regime, $k\\Delta x/2 < \\pi/2$, and the term $\\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}$ is a positive real number. The argument of the complex ratio is therefore determined solely by the exponential term.\n$$\n\\phi^{(1)} = -\\frac{k \\Delta x}{2}\n$$\n\nNext, we derive the phase error for the second-order reconstruction, $\\phi^{(2)}$.\nThe reconstruction is $E_{i+\\frac{1}{2},L}^{(2)} = \\overline{E}_{i} + \\frac{\\Delta x}{2}s_{i}$, with the slope $s_{i} = \\frac{\\overline{E}_{i+1} - \\overline{E}_{i-1}}{2\\Delta x}$.\nFirst, we compute the slope $s_i$:\n$$\n\\overline{E}_{i\\pm 1} = E_{y}(x_{i\\pm 1}) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} = E_{y}(x_i)\\exp(\\pm i k \\Delta x) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\n$$\ns_i = \\frac{1}{2\\Delta x} \\left( \\overline{E}_{i+1} - \\overline{E}_{i-1} \\right) = \\frac{E_{y}(x_i)}{2\\Delta x} \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left[ \\exp(i k \\Delta x) - \\exp(-i k \\Delta x) \\right]\n$$\nUsing $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$, we get:\n$$\ns_i = \\frac{E_{y}(x_i)}{2\\Delta x} \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} [2i \\sin(k\\Delta x)] = \\frac{i \\sin(k\\Delta x)}{\\Delta x} E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}\n$$\nNow, substitute this into the expression for $E_{i+\\frac{1}{2},L}^{(2)}$:\n$$\nE_{i+\\frac{1}{2},L}^{(2)} = \\overline{E}_{i} + \\frac{\\Delta x}{2}s_{i} = E_{y}(x_i)\\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} + \\frac{\\Delta x}{2} \\left( \\frac{i \\sin(k\\Delta x)}{\\Delta x} E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\right)\n$$\nFactor out the common terms:\n$$\nE_{i+\\frac{1}{2},L}^{(2)} = E_{y}(x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right)\n$$\n$$\nE_{i+\\frac{1}{2},L}^{(2)} = E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right)\n$$\nWe form the ratio for $\\phi^{(2)}$:\n$$\n\\phi^{(2)} = \\arg\\left(\\frac{E_{i+\\frac{1}{2},L}^{(2)}}{E_{y}(x_{i+\\frac{1}{2}})}\\right) = \\arg\\left( \\frac{E_{0}\\exp(i k x_i) \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right)}{E_{0}\\exp(i k x_i)\\exp(i k \\Delta x / 2)} \\right)\n$$\n$$\n\\phi^{(2)} = \\arg\\left( \\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2} \\exp\\left(-i\\frac{k \\Delta x}{2}\\right) \\left( 1 + \\frac{i}{2}\\sin(k\\Delta x) \\right) \\right)\n$$\nThe argument of a product of complex numbers is the sum of their arguments. Let's analyze each term. As before, we assume $k\\Delta x < \\pi$, so $\\frac{\\sin(k \\Delta x / 2)}{k \\Delta x / 2}$ is a positive real number and its argument is $0$. The argument of $\\exp(-i k \\Delta x / 2)$ is $-k \\Delta x / 2$. The third term is $1 + \\frac{i}{2}\\sin(k\\Delta x)$; its real part is $1$ (positive), so its argument is $\\arctan(\\frac{1}{2}\\sin(k\\Delta x))$.\nSumming the arguments:\n$$\n\\phi^{(2)} = 0 - \\frac{k\\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k\\Delta x)\\right)\n$$\nSo, the second phase error is:\n$$\n\\phi^{(2)} = -\\frac{k\\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k \\Delta x)\\right)\n$$\n\nThe final closed-form expressions for the phase errors are:\n$\\phi^{(1)} = -\\frac{k \\Delta x}{2}$\n$\\phi^{(2)} = -\\frac{k \\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k \\Delta x)\\right)$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{k \\Delta x}{2} & -\\frac{k \\Delta x}{2} + \\arctan\\left(\\frac{1}{2}\\sin(k \\Delta x)\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While Maxwell's equations guarantee $\\nabla \\cdot \\mathbf{B} = 0$, numerical schemes can accumulate errors that violate this constraint, leading to unphysical results. This advanced practice  explores the powerful Generalized Lagrange Multiplier (GLM) method for divergence cleaning. You will derive the governing equation for the divergence error and determine optimal parameters to ensure it is efficiently suppressed, a vital technique for robust electromagnetic simulations.",
            "id": "3307998",
            "problem": "A uniform Cartesian grid with spacing $\\Delta$ in all spatial directions is used to solve Maxwell’s equations in vacuum with a Finite-Volume Time-Domain (FVTD) method. Assume an initially divergence-free magnetic induction field, $\\nabla \\cdot \\mathbf{B} = 0$, but allow that small divergence errors are introduced by truncation at later times. To construct a minimal divergence-cleaning step that is compatible with conservation in a finite-volume setting, consider augmenting Faraday’s law by a single scalar cleaning field $\\psi$ through a Generalized Lagrange Multiplier (GLM) hyperbolic cleaning.\n\nStarting from the differential-form Maxwell equations in vacuum, augment the system by adding a gradient of the scalar field $\\psi$ to Faraday’s law and prescribing a relaxation equation for $\\psi$ with two positive parameters $c_{h}$ (a characteristic hyperbolic cleaning speed) and $c_{p}$ (a parabolic damping parameter with units of inverse time). Derive, in the continuum limit, the closed evolution equation governing the divergence error $D \\equiv \\nabla \\cdot \\mathbf{B}$, and obtain the dispersion relation $s = s(\\mathbf{k})$ for a Fourier mode $D(\\mathbf{x},t) \\propto \\exp(s t + i \\mathbf{k}\\cdot \\mathbf{x})$ of wavenumber magnitude $k = |\\mathbf{k}|$.\n\nDefine a “minimal” parameter choice by demanding critical damping of the highest-resolvable grid mode $k_{\\max} = \\pi/\\Delta$, so that the divergence error of that mode decays as fast as possible without oscillation. Under this critical-damping choice, what is the asymptotic exponential decay rate (i.e., the real part of $s$) of the divergence error amplitude for the mode $k_{\\max}$? Provide your final answer as a single closed-form symbolic expression in terms of $c_{h}$ and $\\Delta$. Do not include units in your final boxed answer.",
            "solution": "The problem requires the derivation of the asymptotic exponential decay rate for divergence errors in a Finite-Volume Time-Domain (FVTD) scheme using the Generalized Lagrange Multiplier (GLM) hyperbolic cleaning method. We begin by formalizing the system of equations described.\n\nThe standard Maxwell's equations in vacuum are modified. Specifically, Faraday's law of induction is augmented with the gradient of a scalar cleaning field $\\psi$:\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} + \\nabla \\times \\mathbf{E} = -\\nabla \\psi\n$$\nA relaxation equation for $\\psi$ is introduced, which, based on the problem description and dimensional consistency, takes the form of a damped wave equation source. Let $c_h$ be the hyperbolic cleaning speed and $c_p$ be the parabolic damping rate (with units of inverse time). The equation for $\\psi$ that is consistent with these definitions and standard GLM formulations is:\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 (\\nabla \\cdot \\mathbf{B}) = -c_p \\psi\n$$\nThe divergence error is defined as $D \\equiv \\nabla \\cdot \\mathbf{B}$. Our goal is to derive a closed evolution equation for $D$.\n\nFirst, we take the divergence of the augmented Faraday's law. Assuming the fields are sufficiently smooth to allow the interchange of spatial and temporal derivatives, we get:\n$$\n\\nabla \\cdot \\left( \\frac{\\partial \\mathbf{B}}{\\partial t} \\right) + \\nabla \\cdot (\\nabla \\times \\mathbf{E}) = -\\nabla \\cdot (\\nabla \\psi)\n$$\nThe divergence of a curl is identically zero ($\\nabla \\cdot (\\nabla \\times \\mathbf{E}) = 0$). This yields:\n$$\n\\frac{\\partial}{\\partial t} (\\nabla \\cdot \\mathbf{B}) = -\\nabla^2 \\psi\n$$\nIn terms of the divergence error $D$, this is our first governing equation:\n$$\n\\frac{\\partial D}{\\partial t} = -\\nabla^2 \\psi \\quad (\\text{Eq. } 1)\n$$\nThe relaxation equation for $\\psi$ can be written in terms of $D$ as:\n$$\n\\frac{\\partial \\psi}{\\partial t} + c_h^2 D = -c_p \\psi \\quad (\\text{Eq. } 2)\n$$\nWe now have a coupled system of two linear partial differential equations for $D$ and $\\psi$. To obtain a single, closed-form equation for $D$, we can eliminate $\\psi$. We differentiate Eq. $1$ with respect to time $t$:\n$$\n\\frac{\\partial^2 D}{\\partial t^2} = -\\nabla^2 \\left( \\frac{\\partial \\psi}{\\partial t} \\right)\n$$\nFrom Eq. $2$, we can express $\\frac{\\partial \\psi}{\\partial t}$ as $\\frac{\\partial \\psi}{\\partial t} = -c_h^2 D - c_p \\psi$. Substituting this into the previous equation gives:\n$$\n\\frac{\\partial^2 D}{\\partial t^2} = -\\nabla^2 (-c_h^2 D - c_p \\psi) = c_h^2 \\nabla^2 D + c_p \\nabla^2 \\psi\n$$\nNow, we can substitute for $\\nabla^2 \\psi$ using Eq. $1$: $\\nabla^2 \\psi = -\\frac{\\partial D}{\\partial t}$. This leads to:\n$$\n\\frac{\\partial^2 D}{\\partial t^2} = c_h^2 \\nabla^2 D + c_p \\left( -\\frac{\\partial D}{\\partial t} \\right)\n$$\nRearranging the terms, we arrive at the closed evolution equation for the divergence error $D$:\n$$\n\\frac{\\partial^2 D}{\\partial t^2} + c_p \\frac{\\partial D}{\\partial t} - c_h^2 \\nabla^2 D = 0\n$$\nThis is a damped wave equation, where $c_h$ is the propagation speed of divergence waves and $c_p$ is the damping coefficient.\n\nNext, we derive the dispersion relation by considering a single Fourier mode of the form $D(\\mathbf{x}, t) = \\hat{D} \\exp(s t + i \\mathbf{k} \\cdot \\mathbf{x})$, where $\\hat{D}$ is a constant, $s$ is the complex frequency, and $\\mathbf{k}$ is the wavevector. The derivatives are:\n$$\n\\frac{\\partial D}{\\partial t} = s D, \\quad \\frac{\\partial^2 D}{\\partial t^2} = s^2 D, \\quad \\nabla^2 D = -|\\mathbf{k}|^2 D = -k^2 D\n$$\nSubstituting these into the evolution equation for $D$:\n$$\ns^2 D + c_p (s D) - c_h^2 (-k^2 D) = 0\n$$\nDividing by $D$ (which is non-zero for a non-trivial mode) yields the characteristic equation, which is the dispersion relation:\n$$\ns^2 + c_p s + c_h^2 k^2 = 0\n$$\nThis is a quadratic equation for $s$. The roots are given by the quadratic formula:\n$$\ns(k) = \\frac{-c_p \\pm \\sqrt{c_p^2 - 4 c_h^2 k^2}}{2}\n$$\nThe problem specifies a \"minimal\" parameter choice based on critical damping for the highest-resolvable grid mode. On a uniform Cartesian grid with spacing $\\Delta$, the highest resolvable wavenumber (Nyquist wavenumber) is:\n$$\nk_{\\max} = \\frac{\\pi}{\\Delta}\n$$\nCritical damping occurs when the discriminant of the quadratic equation for $s$ is zero. This ensures the fastest possible decay for that mode without any oscillation. We set the discriminant to zero for $k = k_{\\max}$:\n$$\nc_p^2 - 4 c_h^2 k_{\\max}^2 = 0\n$$\nSolving for $c_p$ (since $c_p$ and $c_h$ are positive parameters):\n$$\nc_p = 2 c_h k_{\\max} = 2 c_h \\frac{\\pi}{\\Delta}\n$$\nThis equation fixes the damping parameter $c_p$ in terms of the cleaning speed $c_h$ and the grid spacing $\\Delta$ for the specified critical damping condition.\n\nFinally, we need to find the asymptotic exponential decay rate, which is the real part of $s$, for the mode $k_{\\max}$ under this condition. For any critically damped mode, the solution for $s$ is the single repeated root of the characteristic equation, which occurs when the discriminant is zero. The value of this root is:\n$$\ns = \\frac{-c_p}{2}\n$$\nWe substitute the expression for $c_p$ that we just derived from the critical damping condition:\n$$\ns = -\\frac{1}{2} \\left( 2 c_h \\frac{\\pi}{\\Delta} \\right) = -\\frac{\\pi c_h}{\\Delta}\n$$\nThis value of $s$ is purely real. The problem asks for the real part of $s$, which is therefore the value itself. This is the exponential decay rate of the divergence error amplitude for the highest-resolvable mode under the critical damping condition.",
            "answer": "$$\\boxed{-\\frac{\\pi c_h}{\\Delta}}$$"
        }
    ]
}