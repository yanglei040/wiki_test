{
    "hands_on_practices": [
        {
            "introduction": "显式时域方法功能强大，但需要仔细选择时间步长 $\\Delta t$ 以确保数值稳定性。本练习将指导您通过基本的冯·诺依曼稳定性分析，为有限积分技术 (FIT) 方案推导出 Courant–Friedrichs–Lewy (CFL) 条件。理解此推导过程至关重要，因为它揭示了最大稳定时间步长、空间网格尺寸（$\\Delta x, \\Delta y, \\Delta z$）以及介质物理特性（$\\varepsilon, \\mu$）之间的直接关系。",
            "id": "3307640",
            "problem": "给定一个无源、均匀、各向同性的介质，其介电常数为 $\\varepsilon$，磁导率为 $\\mu$。该介质在空间上通过有限积分技术（FIT）在间距为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$ 的均匀笛卡尔主/对偶网格上进行离散。时间推进采用显式蛙跳格式进行，并假设采用周期性边界条件，从而可以使用离散傅里叶（von Neumann）分析。\n\n从麦克斯韦方程组的积分形式和将边积分电场未知量与面积分通量通过关联矩阵耦合起来的 FIT 核心拓扑定律出发，执行以下任务：\n\n- 对于无源、无损耗介质，推导以离散旋度的关联算子和由均匀笛卡尔网格导出的对角材料矩阵表示的半离散 FIT 系统。\n- 为电场和磁场的边未知量构建显式蛙跳时间步进格式，并使用空间和时间上可分离的平面波拟设进行 von Neumann 分析。利用此分析推导对时间步长 $\\Delta t$ 的稳定性要求（Courant–Friedrichs–Lewy (CFL) 条件），该要求保证对于所有可分辨的波矢量，离散时间模式都是纯振荡的。\n- 明确展示该界限如何依赖于 $\\varepsilon$、$\\mu$、$\\Delta x$、$\\Delta y$ 和 $\\Delta z$，并提取最大稳定时间步长 $\\Delta t_{\\max}$ 的闭合形式表达式。\n\n答案规范：以单个闭合形式解析表达式提供 $\\Delta t_{\\max}$。答案以秒为单位表示。请勿四舍五入。",
            "solution": "该问题要求推导在均匀笛卡尔网格上使用显式蛙跳时间步进格式的有限积分技术（FIT）应用于麦克斯韦方程组时的最大稳定时间步长 $\\Delta t_{\\max}$。推导过程首先建立半离散系统，然后应用 von Neumann 稳定性分析。\n\n### 步骤1：半离散 FIT 方程\n我们从无源、无损耗、均匀、各向同性介质的麦克斯韦方程组的积分形式开始：\n$$\n\\oint_{\\partial A} \\mathbf{E} \\cdot d\\mathbf{l} = -\\frac{d}{dt}\\iint_{A} \\mathbf{B} \\cdot d\\mathbf{S} \\quad (\\text{法拉第定律})\n$$\n$$\n\\oint_{\\partial \\tilde{A}} \\mathbf{H} \\cdot d\\tilde{\\mathbf{l}} = \\frac{d}{dt}\\iint_{\\tilde{A}} \\mathbf{D} \\cdot d\\tilde{\\mathbf{S}} \\quad (\\text{安培定律})\n$$\n在有限积分技术中，这些方程被投影到主网格及与其交错的对偶网格上。场量由这些网格单元上的积分值表示。设 $\\mathbf{e}$ 为电场的主边路径积分（电压）向量，$\\tilde{\\mathbf{h}}$ 为磁场的对偶边路径积分（磁动势）向量。离散旋度算子由拓扑关联矩阵 $\\mathbf{C}$（主网格）和 $\\tilde{\\mathbf{C}}$（对偶网格）表示，其中 $\\tilde{\\mathbf{C}} = -\\mathbf{C}^T$。法拉第定律和安培定律的半离散形式为：\n$$\n\\mathbf{C} \\mathbf{e} = -\\frac{d\\tilde{\\mathbf{b}}}{dt}\n$$\n$$\n\\tilde{\\mathbf{C}} \\tilde{\\mathbf{h}} = \\frac{d\\mathbf{d}}{dt}\n$$\n此处，$\\tilde{\\mathbf{b}}$ 是通过对偶面的磁通量向量，$\\mathbf{d}$ 是通过主面的电通量向量。本构关系 $\\mathbf{D} = \\varepsilon\\mathbf{E}$ 和 $\\mathbf{B} = \\mu\\mathbf{H}$ 使用对角材料矩阵 $\\mathbf{M}_{\\varepsilon}$ 和 $\\mathbf{M}_{\\mu}$ 进行离散化：\n$$\n\\mathbf{d} = \\mathbf{M}_{\\varepsilon} \\mathbf{e}\n$$\n$$\n\\tilde{\\mathbf{b}} = \\mathbf{M}_{\\mu} \\tilde{\\mathbf{h}}\n$$\n将这些代入离散麦克斯韦方程组，并使用 $\\tilde{\\mathbf{C}} = -\\mathbf{C}^T$，得出以 $\\mathbf{e}$ 和 $\\tilde{\\mathbf{h}}$ 表示的半离散系统：\n$$\n\\frac{d}{dt}(\\mathbf{M}_{\\mu} \\tilde{\\mathbf{h}}) = -\\mathbf{C} \\mathbf{e}\n$$\n$$\n\\frac{d}{dt}(\\mathbf{M}_{\\varepsilon} \\mathbf{e}) = \\mathbf{C}^T \\tilde{\\mathbf{h}}\n$$\n对于均匀介质，$\\varepsilon$ 和 $\\mu$ 是常数。材料矩阵是对角矩阵，其元素由网格几何形状确定。对于均匀笛卡尔（Yee）网格，材料矩阵中的这些几何因子和离散旋度算子以一种特殊方式组合，使得方程与标准 FDTD 方程完全相同。具体来说，系统简化为：\n$$\n\\mu \\frac{d\\mathbf{H}}{dt} = -\\nabla_d \\times \\mathbf{E}\n$$\n$$\n\\varepsilon \\frac{d\\mathbf{E}}{dt} = \\nabla_d \\times \\mathbf{H}\n$$\n其中 $\\mathbf{E}$ 和 $\\mathbf{H}$ 现在是各自 Yee 网格位置上场分量本身的向量，$\\nabla_d \\times$ 是相应的离散旋度算子。\n\n### 步骤2：蛙跳时间离散\n蛙跳格式以步长 $\\Delta t$ 离散时间，在整数时间步 $n$ 计算 $\\mathbf{E}$，在半整数时间步 $n+1/2$ 计算 $\\mathbf{H}$。时间导数通过中心差分进行近似：\n$$\n\\mu \\frac{\\mathbf{H}^{n+1/2} - \\mathbf{H}^{n-1/2}}{\\Delta t} = -\\nabla_d \\times \\mathbf{E}^n\n$$\n$$\n\\varepsilon \\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^n}{\\Delta t} = \\nabla_d \\times \\mathbf{H}^{n+1/2}\n$$\n我们可以消去 $\\mathbf{H}$，从而获得仅关于 $\\mathbf{E}$ 的二阶更新方程：\n$$\n\\mathbf{E}^{n+1} = \\mathbf{E}^n + \\frac{\\Delta t}{\\varepsilon} \\nabla_d \\times \\mathbf{H}^{n+1/2}\n$$\n代入 $\\mathbf{H}^{n+1/2} = \\mathbf{H}^{n-1/2} - \\frac{\\Delta t}{\\mu} \\nabla_d \\times \\mathbf{E}^n$ 的更新式：\n$$\n\\mathbf{E}^{n+1} = \\mathbf{E}^n + \\frac{\\Delta t}{\\varepsilon} \\nabla_d \\times \\left( \\mathbf{H}^{n-1/2} - \\frac{\\Delta t}{\\mu} \\nabla_d \\times \\mathbf{E}^n \\right)\n$$\n认识到根据前一个时间步的电场更新式有 $\\frac{\\Delta t}{\\varepsilon} \\nabla_d \\times \\mathbf{H}^{n-1/2} = \\mathbf{E}^n - \\mathbf{E}^{n-1}$，我们得到：\n$$\n\\mathbf{E}^{n+1} = \\mathbf{E}^n + (\\mathbf{E}^n - \\mathbf{E}^{n-1}) - \\frac{\\Delta t^2}{\\varepsilon\\mu} (\\nabla_d \\times \\nabla_d \\times \\mathbf{E}^n)\n$$\n重新整理得到离散电场的最终波动方程：\n$$\n\\frac{\\mathbf{E}^{n+1} - 2\\mathbf{E}^n + \\mathbf{E}^{n-1}}{\\Delta t^2} = \\frac{1}{\\varepsilon\\mu} \\nabla_d \\times \\nabla_d \\times \\mathbf{E}^n\n$$\n\n### 步骤3：Von Neumann 稳定性分析\n我们通过在网格上假设一个平面波解（拟设）来检验稳定性。由于存在周期性边界条件，我们可以分析单个空间傅里叶模式：\n$$\n\\mathbf{E}^n(\\mathbf{r}) = \\mathbf{E}_0 e^{i(\\mathbf{k} \\cdot \\mathbf{r})} (Z)^n\n$$\n其中 $\\mathbf{k} = (k_x, k_y, k_z)$ 是波矢量，$\\mathbf{r}$ 是位置矢量，$Z = e^{-i\\omega \\Delta t}$ 是每个时间步的放大因子。对于一个稳定的、非耗散的格式，我们要求 $|Z| = 1$。\n\n离散旋度算子对平面波的作用可以通过将空间导数替换为其有限差分对应项来找到。对于 Yee 网格，像 $\\frac{\\partial}{\\partial x}$ 这样的中心差分在傅里叶域中变为乘以 $i\\hat{k}_x$，其中：\n$$\n\\hat{k}_u = \\frac{2}{\\Delta u} \\sin\\left(\\frac{k_u \\Delta u}{2}\\right) \\quad \\text{ 对于 } u \\in \\{x,y,z\\}\n$$\n算子 $\\nabla_d \\times$ 变为乘以 $i\\mathbf{K} \\times$，其中 $\\mathbf{K} = (\\hat{k}_x, \\hat{k}_y, \\hat{k}_z)$。算子 $\\nabla_d \\times \\nabla_d \\times$ 变为乘以 $(i\\mathbf{K} \\times)(i\\mathbf{K} \\times) = -\\mathbf{K} \\times (\\mathbf{K} \\times \\cdot)$。\n将该拟设代入离散波动方程，得到：\n$$\n\\frac{Z - 2 + Z^{-1}}{\\Delta t^2} \\mathbf{E}_0 = \\frac{1}{\\varepsilon\\mu} \\left( -\\mathbf{K} \\times (\\mathbf{K} \\times \\mathbf{E}_0) \\right)\n$$\n使用矢量恒等式 $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A} \\cdot \\mathbf{C}) - \\mathbf{C}(\\mathbf{A} \\cdot \\mathbf{B})$：\n$$\n\\frac{Z^{-1}(Z-1)^2}{\\Delta t^2} \\mathbf{E}_0 = \\frac{1}{\\varepsilon\\mu} \\left( -\\mathbf{K}(\\mathbf{K} \\cdot \\mathbf{E}_0) + \\mathbf{E}_0 (\\mathbf{K} \\cdot \\mathbf{K}) \\right)\n$$\n对于横电磁波，$\\mathbf{K} \\cdot \\mathbf{E}_0 = 0$。方程简化为：\n$$\n\\frac{Z^{-1}(Z-1)^2}{\\Delta t^2} = \\frac{|\\mathbf{K}|^2}{\\varepsilon\\mu}\n$$\n其中 $|\\mathbf{K}|^2 = \\hat{k}_x^2 + \\hat{k}_y^2 + \\hat{k}_z^2$。令 $c = 1/\\sqrt{\\varepsilon\\mu}$ 为介质中的光速。\n$$\n(Z-1)^2 = - (c \\Delta t |\\mathbf{K}|)^2 Z\n$$\n$$\nZ^2 - 2Z + 1 = - (c \\Delta t |\\mathbf{K}|)^2 Z\n$$\n$$\nZ^2 + \\left( (c \\Delta t |\\mathbf{K}|)^2 - 2 \\right) Z + 1 = 0\n$$\n这是一个关于 $Z$ 的二次方程。其解位于单位圆上的充要条件是判别式为非正数：\n$$\n\\left( (c \\Delta t |\\mathbf{K}|)^2 - 2 \\right)^2 - 4 \\le 0\n$$\n$$\n-2 \\le (c \\Delta t |\\mathbf{K}|)^2 - 2 \\le 2\n$$\n$$\n0 \\le (c \\Delta t |\\mathbf{K}|)^2 \\le 4\n$$\n由于 $(c \\Delta t |\\mathbf{K}|)^2$ 总是非负的，稳定性条件是：\n$$\nc \\Delta t |\\mathbf{K}| \\le 2 \\implies \\Delta t \\le \\frac{2}{c |\\mathbf{K}|}\n$$\n此条件必须对所有可能的波矢量 $\\mathbf{k}$ 成立。因此，稳定性由 $|\\mathbf{K}|$ 的最大值决定。\n$$\n\\Delta t_{\\max} = \\frac{2}{c |\\mathbf{K}|_{\\max}}\n$$\n\n### 步骤4：推导最大稳定时间步长\n为了求得 $|\\mathbf{K}|_{\\max}$，我们必须求出 $|\\mathbf{K}|^2 = \\hat{k}_x^2 + \\hat{k}_y^2 + \\hat{k}_z^2$ 的最大值：\n$$\n|\\mathbf{K}|^2 = \\left(\\frac{2}{\\Delta x}\\sin\\left(\\frac{k_x\\Delta x}{2}\\right)\\right)^2 + \\left(\\frac{2}{\\Delta y}\\sin\\left(\\frac{k_y\\Delta y}{2}\\right)\\right)^2 + \\left(\\frac{2}{\\Delta z}\\sin\\left(\\frac{k_z\\Delta z}{2}\\right)\\right)^2\n$$\n正弦函数达到其最大值 1。这发生在网格可分辨的最高空间频率（奈奎斯特频率）处，即 $k_u \\Delta u = \\pi$。因此，当 $\\sin^2(\\frac{k_u\\Delta u}{2}) = 1$ 时，每一项都达到其最大值。\n$$\n|\\mathbf{K}|_{\\max}^2 = \\left(\\frac{2}{\\Delta x}\\right)^2 + \\left(\\frac{2}{\\Delta y}\\right)^2 + \\left(\\frac{2}{\\Delta z}\\right)^2 = 4\\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)\n$$\n取平方根：\n$$\n|\\mathbf{K}|_{\\max} = 2\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}\n$$\n将此代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n\\Delta t_{\\max} = \\frac{2}{c \\left(2\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}\\right)} = \\frac{1}{c\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}\n$$\n最后，代入 $c=1/\\sqrt{\\varepsilon\\mu}$，我们得到三维 FIT/FDTD 方法的 Courant–Friedrichs–Lewy (CFL) 条件：\n$$\n\\Delta t_{\\max} = \\frac{\\sqrt{\\varepsilon\\mu}}{\\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}} = \\sqrt{\\varepsilon\\mu} \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)^{-1/2}\n$$\n此表达式给出了显式蛙跳格式保持数值稳定时的最大时间步长 $\\Delta t$。",
            "answer": "$$\\boxed{\\sqrt{\\varepsilon\\mu} \\left(\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}\\right)^{-1/2}}$$"
        },
        {
            "introduction": "除了稳定性，数值模拟的精度也至关重要。离散化网格不可避免地会引入误差，导致波的数值传播速度与物理光速不同，这种效应被称为数值色散。本练习旨在推导 FIT 的数值色散关系，使您能够精确量化相速度和群速度误差，并理解波在网格上的传播如何变得具有各向异性（依赖于方向）。",
            "id": "3307682",
            "problem": "考虑在三维、均匀、正交真空中网格上对麦克斯韦方程组进行有限积分技术 (FIT) 半离散化，各笛卡尔方向上的网格间距为 $\\,\\Delta\\,$，时间步长为 $\\,\\Delta t\\,$。设真空介电常数为 $\\,\\varepsilon_{0}\\,$，真空磁导率为 $\\,\\mu_{0}\\,$，光速为 $\\,c = 1/\\sqrt{\\varepsilon_{0}\\mu_{0}}\\,$。电场自由度与主网格边相关联，磁场自由度与对偶网格边相关联，时间步进为蛙跳格式。假定波矢量与立方网格的体对角线对齐。具体而言，设物理波数量值为 $\\,k\\,$，其笛卡尔分量满足 $\\,k_{x} = k_{y} = k_{z} = k/\\sqrt{3}\\,$。假设空间和时间上存在平面波解。\n\n从法拉第定律和安培-麦克斯韦定律的积分形式以及 FIT 拓扑离散化出发，推导这些沿网格体对角线传播的平面波的数值色散关系。利用此色散关系，定义 Courant–Friedrichs–Lewy (CFL) 稳定性数 $\\,S = c\\,\\Delta t / \\Delta\\,$ 和无量纲波数 $\\,\\xi = k\\,\\Delta\\,$，并计算相对相速度误差\n$$\\delta_{p} = \\frac{v_{p}}{c} - 1$$\n和相对群速度误差\n$$\\delta_{g} = \\frac{v_{g}}{c} - 1,$$\n的闭式解析表达式，其中 $\\,v_{p} = \\omega/k\\,$ 和 $\\,v_{g} = \\mathrm{d}\\omega/\\mathrm{d}k\\,$ 是从推导出的色散关系中提取的数值相速度和群速度，$\\,\\omega\\,$ 是数值角频率。将所有三角函数的宗量视为弧度，并用 $\\,S\\,$ 和 $\\,\\xi\\,$ 的符号形式表示 $\\,\\delta_{p}\\,$ 和 $\\,\\delta_{g}\\,$。请将最终结果以包含 $\\,\\delta_{p}\\,$ 和 $\\,\\delta_{g}\\,$ 的单行矩阵形式给出。无需进行数值取整。",
            "solution": "该问题基于计算电磁学原理，提法恰当，陈述客观，因而有效。我们着手求解。\n\n均匀正交网格上的有限积分技术 (FIT) 等效于 Yee 网格上的时域有限差分 (FDTD) 方法。对于一个时间依赖性为 $\\exp(-i\\omega t)$、空间依赖性为 $\\exp(i\\vec{k} \\cdot \\vec{r})$ 的平面波，蛙跳时间步进格式和空间中心差分导致麦克斯韦方程组中的偏导数有以下算子代换：\n$$ \\frac{\\partial}{\\partial t} \\rightarrow \\frac{-2i}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n$$ \\nabla \\rightarrow i\\vec{K} $$\n其中 $\\vec{K}$ 是数值波矢量，其分量为\n$$ K_j = \\frac{2}{\\Delta} \\sin\\left(\\frac{k_j \\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x, y, z\\} $$\n这里，$\\omega$ 是数值角频率，$\\vec{k} = (k_x, k_y, k_z)$ 是物理波矢量，$\\Delta t$ 是时间步长，$\\Delta$ 是均匀网格间距。\n\n在无源真空（$\\vec{D}=\\varepsilon_0\\vec{E}$, $\\vec{B}=\\mu_0\\vec{H}$）中，麦克斯韦旋度方程为：\n$$ \\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t} \\quad \\implies \\quad \\nabla \\times \\vec{E} = -\\mu_0 \\frac{\\partial \\vec{H}}{\\partial t} $$\n$$ \\nabla \\times \\vec{H} = \\frac{\\partial \\vec{D}}{\\partial t} \\quad \\implies \\quad \\nabla \\times \\vec{H} = \\varepsilon_0 \\frac{\\partial \\vec{E}}{\\partial t} $$\n对平面波解（$\\vec{E}(\\vec{r},t) = \\vec{E}_0 e^{i(\\vec{k}\\cdot\\vec{r}-\\omega t)}$, $\\vec{H}(\\vec{r},t) = \\vec{H}_0 e^{i(\\vec{k}\\cdot\\vec{r}-\\omega t)}$）应用 FDTD/FIT 算子代换，得到以下代数方程组：\n$$ i\\vec{K} \\times \\vec{E}_0 = -\\mu_0 \\left( \\frac{-2i}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right) \\vec{H}_0 $$\n$$ i\\vec{K} \\times \\vec{H}_0 = \\varepsilon_0 \\left( \\frac{-2i}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right) \\vec{E}_0 $$\n化简可得：\n$$ \\vec{K} \\times \\vec{E}_0 = \\frac{2\\mu_0}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\vec{H}_0 $$\n$$ \\vec{K} \\times \\vec{H}_0 = -\\frac{2\\varepsilon_0}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\vec{E}_0 $$\n将第二个方程代入第一个方程的旋度中：\n$$ \\vec{K} \\times (\\vec{K} \\times \\vec{E}_0) = \\frac{2\\mu_0}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) (\\vec{K} \\times \\vec{H}_0) $$\n$$ \\vec{K}(\\vec{K} \\cdot \\vec{E}_0) - (\\vec{K} \\cdot \\vec{K})\\vec{E}_0 = \\frac{2\\mu_0}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\left(-\\frac{2\\varepsilon_0}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\vec{E}_0\\right) $$\n对于横电磁波，数值散度为零（$\\vec{K} \\cdot \\vec{E}_0 = 0$），可得：\n$$ -|\\vec{K}|^2 \\vec{E}_0 = -\\frac{4\\mu_0\\varepsilon_0}{(\\Delta t)^2} \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) \\vec{E}_0 $$\n使用真空中光速的关系式 $c = 1/\\sqrt{\\varepsilon_0\\mu_0}$，我们得到数值色散关系：\n$$ |\\vec{K}|^2 = \\frac{1}{c^2} \\left(\\frac{2}{\\Delta t}\\right)^2 \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n代入 $\\vec{K}$ 各分量的表达式：\n$$ \\left(\\frac{2}{\\Delta}\\right)^2 \\left( \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) \\right) = \\frac{4}{(c\\Delta t)^2} \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n问题指定波沿立方网格的体对角线传播，因此 $k_x = k_y = k_z = k/\\sqrt{3}$。该关系式变为：\n$$ \\frac{1}{\\Delta^2} \\left( 3 \\sin^2\\left(\\frac{(k/\\sqrt{3})\\Delta}{2}\\right) \\right) = \\frac{1}{(c\\Delta t)^2} \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n给定 Courant–Friedrichs–Lewy (CFL) 数 $S = c\\Delta t/\\Delta$ 和无量纲波数 $\\xi = k\\Delta$。代入这些定义：\n$$ \\frac{3}{\\Delta^2} \\sin^2\\left(\\frac{\\xi}{2\\sqrt{3}}\\right) = \\frac{1}{(S\\Delta)^2} \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n$$ 3 S^2 \\sin^2\\left(\\frac{\\xi}{2\\sqrt{3}}\\right) = \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n对前向传播波取正根，得到数值色散关系的最终形式：\n$$ \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) = \\sqrt{3} S \\sin\\left(\\frac{\\xi}{2\\sqrt{3}}\\right) $$\n由此，我们可以将数值角频率 $\\omega$ 表示为波数 $k$（或 $\\xi$）的函数：\n$$ \\omega(k) = \\frac{2}{\\Delta t} \\arcsin\\left(\\sqrt{3} S \\sin\\left(\\frac{k\\Delta}{2\\sqrt{3}}\\right)\\right) $$\n\n接下来，我们计算相对相速度误差 $\\delta_p = v_p/c - 1$。数值相速度为 $v_p = \\omega/k$。\n$$ \\frac{v_p}{c} = \\frac{\\omega}{kc} = \\frac{1}{kc} \\left[ \\frac{2}{\\Delta t} \\arcsin\\left(\\sqrt{3} S \\sin\\left(\\frac{k\\Delta}{2\\sqrt{3}}\\right)\\right) \\right] $$\n使用关系式 $S = c\\Delta t/\\Delta$ 和 $\\xi = k\\Delta$，我们可以写出 $kc = (k\\Delta) (c\\Delta t/\\Delta) / \\Delta t = \\xi S / \\Delta t$。\n$$ \\frac{v_p}{c} = \\frac{\\Delta t}{\\xi S} \\left[ \\frac{2}{\\Delta t} \\arcsin\\left(\\sqrt{3} S \\sin\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)\\right) \\right] = \\frac{2}{\\xi S} \\arcsin\\left(\\sqrt{3} S \\sin\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)\\right) $$\n因此，相对相速度误差为：\n$$ \\delta_p = \\frac{2}{\\xi S} \\arcsin\\left(\\sqrt{3} S \\sin\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)\\right) - 1 $$\n\n现在，我们计算相对群速度误差 $\\delta_g = v_g/c - 1$。数值群速度为 $v_g = \\mathrm{d}\\omega/\\mathrm{d}k$。我们可以通过对色散关系关于 $k$ 进行隐式微分来求得：\n$$ \\frac{d}{dk}\\left[\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right)\\right] = \\frac{d}{dk}\\left[\\sqrt{3} S \\sin\\left(\\frac{k\\Delta}{2\\sqrt{3}}\\right)\\right] $$\n$$ \\cos\\left(\\frac{\\omega \\Delta t}{2}\\right) \\cdot \\frac{\\Delta t}{2} \\cdot \\frac{d\\omega}{dk} = \\sqrt{3} S \\cos\\left(\\frac{k\\Delta}{2\\sqrt{3}}\\right) \\cdot \\frac{\\Delta}{2\\sqrt{3}} $$\n$$ \\cos\\left(\\frac{\\omega \\Delta t}{2}\\right) \\frac{\\Delta t}{2} v_g = S \\frac{\\Delta}{2} \\cos\\left(\\frac{k\\Delta}{2\\sqrt{3}}\\right) $$\n求解 $v_g$：\n$$ v_g = \\frac{S\\Delta}{\\Delta t} \\frac{\\cos\\left(\\frac{k\\Delta}{2\\sqrt{3}}\\right)}{\\cos\\left(\\frac{\\omega \\Delta t}{2}\\right)} $$\n因为 $c = S\\Delta/\\Delta t$，我们有 $v_g/c$：\n$$ \\frac{v_g}{c} = \\frac{\\cos\\left(\\frac{k\\Delta}{2\\sqrt{3}}\\right)}{\\cos\\left(\\frac{\\omega \\Delta t}{2}\\right)} = \\frac{\\cos\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)}{\\sqrt{1 - \\sin^2\\left(\\frac{\\omega \\Delta t}{2}\\right)}} $$\n使用色散关系 $\\sin(\\frac{\\omega \\Delta t}{2}) = \\sqrt{3} S \\sin(\\frac{\\xi}{2\\sqrt{3}})$：\n$$ \\frac{v_g}{c} = \\frac{\\cos\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)}{\\sqrt{1 - 3S^2 \\sin^2\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)}} $$\n因此，相对群速度误差为：\n$$ \\delta_g = \\frac{\\cos\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)}{\\sqrt{1 - 3S^2 \\sin^2\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)}} - 1 $$\n$\\delta_p$ 和 $\\delta_g$ 的最终结果按要求以 $S$ 和 $\\xi$ 的符号形式表示。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{\\xi S} \\arcsin\\left(\\sqrt{3} S \\sin\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)\\right) - 1 & \\frac{\\cos\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)}{\\sqrt{1 - 3S^2 \\sin^2\\left(\\frac{\\xi}{2\\sqrt{3}}\\right)}} - 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "有限积分技术 (FIT) 框架建立在物理学与代数拓扑学之间深刻的联系之上。本练习超越了标准的网格分析，探讨了计算域的拓扑结构本身如何影响离散旋度算子 $\\mathbf{C}$ 的性质。通过考虑一个带柄环的域（第一贝蒂数 $b_1=1$），您将揭示旋度算子零空间中存在一个“调和”分量，该分量会在模拟中产生伪零频模式，并揭示了拓扑规范的必要性。",
            "id": "3307648",
            "problem": "考虑一个为有限积分技术（FIT）离散化的连通三维单元复形，其定向的原始边、面和体构成一个与麦克斯韦积分形式方程相符的链复形。令离散梯度算子表示为 $\\mathbf{G}$，它将基于顶点的标量映射到基于边的环量；离散旋度算子表示为 $\\mathbf{C}$，它将基于边的环量映射到基于面的电动势；以及离散散度算子表示为 $\\mathbf{D}$，它将基于面的通量映射到基于体的源。这些算子满足拓扑恒等式 $\\mathbf{C}\\mathbf{G}=\\mathbf{0}$ 和 $\\mathbf{D}\\mathbf{C}=\\mathbf{0}$，这是斯托克斯定理和高斯定理的结果。假设该网格表示一个具有一个不可收缩环柄的区域（即第一贝蒂数 $b_1=1$），因此，在原始$1$-骨架中恰好存在一个不构成任何面集的边界的独立非平凡循环。\n\n从这个基本出发点，论证边空间上离散旋度零空间 $\\ker \\mathbf{C}$ 的结构。具体来说，为 $\\ker \\mathbf{C}$ 的调和部分构造一个循环基向量，并解释其对于由旋度-旋度算子控制的时谐麦克斯韦问题的FIT离散化中的规范自由度和伪模式的影响。你的论证应仅依赖于基本定律和上述链复形关系；不要假设任何快捷公式。\n\n下列哪个陈述正确地描述了在存在一个环柄的情况下为 $\\ker \\mathbf{C}$ 的调和子空间构造有效循环基的方法，及其对规范自由度和伪模式的影响？\n\nA. 建立一个覆盖所有顶点的原始生成树 $\\mathcal{T}$ 和一个覆盖对偶复形所有面的对偶生成树 $\\mathcal{T}^\\star$。当 $b_1=1$ 时，恰好有一条边既不在 $\\mathcal{T}$ 中，也不在与 $\\mathcal{T}^\\star$ 对偶的边集中；使用这条边以及 $\\mathcal{T}$ 中连接其端点的唯一路径，可以得到一个不可收缩的原始回路，其关联的边上链 $\\mathbf{h}$ 满足 $\\mathbf{C}\\mathbf{h}=\\mathbf{0}$ 但 $\\mathbf{h}\\notin \\operatorname{im}\\mathbf{G}$。因此，$\\ker \\mathbf{C}=\\operatorname{im}\\mathbf{G}\\oplus \\operatorname{span}\\{\\mathbf{h}\\}$，引入了一个标量规范自由度。在离散旋度-旋度本征问题中，这个调和自由度会产生一个伪零频模式，除非通过规范或约束（例如，树-余树规范或显式环路积分约束）将其移除。\n\nB. 仅构造一个对偶生成树 $\\mathcal{T}^\\star$，并取原始边空间中对应的割集作为循环基。由于单个腔体意味着 $b_1=0$，$\\ker \\mathbf{C}$ 只包含梯度，不存在规范自由度，并且旋度-旋度本征问题中没有伪模式。\n\nC. 仅使用一个原始生成树 $\\mathcal{T}$；由每条非树边生成的基本循环集构成了维数为 $m-n+1$（其中 $m$ 是边数，$n$ 是顶点数）的 $\\ker \\mathbf{C}$ 的一个完备基。一个腔体的存在会增加与 $m-n+1$ 成正比的伪非零频模式的数量，无论规范约束如何。\n\nD. 取环绕腔体的任意面环的边界；其边链是 $\\ker \\mathbf{C}$ 的一个有效生成元，因为它是一个面的边界，并且调和子空间的维数等于环中面的数量。由此产生的伪模式是物理上的非零频共振，不能通过规范约束移除。\n\n选择唯一的最佳选项。",
            "solution": "### 问题验证\n\n**第一步：提取已知条件**\n-   一个为有限积分技术（FIT）离散化的连通三维单元复形。\n-   定向的原始边、面和体构成一个链复形。\n-   离散梯度算子：$\\mathbf{G}$，将基于顶点的标量映射到基于边的环量。\n-   离散旋度算子：$\\mathbf{C}$，将基于边的环量映射到基于面的电动势。\n-   离散散度算子：$\\mathbf{D}$，将基于面的通量映射到基于体的源。\n-   拓扑恒等式：$\\mathbf{C}\\mathbf{G}=\\mathbf{0}$ 和 $\\mathbf{D}\\mathbf{C}=\\mathbf{0}$。\n-   区域具有一个不可收缩的环柄，对应于第一贝蒂数 $b_1=1$。\n-   在原始 1-骨架中，恰好存在一个不构成任何面集边界的独立非平凡循环。\n-   任务是描述离散旋度算子零空间 $\\ker \\mathbf{C}$ 的调和部分，及其对时谐旋度-旋度问题中伪模式的影响。\n\n**第二步：使用已知条件进行验证**\n该问题陈述在科学上是合理的、适定的和客观的。\n-   **科学基础**：该问题植根于代数拓扑在计算电磁学中应用的成熟领域，通常被称为“代数电磁学”或在离散化中使用微分形式（例如，FIT，一种离散外微分方法）。算子 $\\mathbf{G}$、$\\mathbf{C}$、$\\mathbf{D}$ 以及关系式 $\\mathbf{C}\\mathbf{G}=\\mathbf{0}$、$\\mathbf{D}\\mathbf{C}=\\mathbf{0}$ 是连续梯度、旋度和散度算子以及矢量恒等式 $\\nabla \\times (\\nabla f) = 0$ 和 $\\nabla \\cdot (\\nabla \\times \\mathbf{F}) = 0$ 的标准离散模拟。区域拓扑（贝蒂数）与麦克斯韦方程解空间结构之间的联系是一个基本概念。\n-   **适定性**：该问题清晰地定义了背景（$b_1=1$）并要求进行特定分析（描述 $\\ker \\mathbf{C}$ 及其后果）。所提供的信息足以且必要地根据该领域的原​​理推导出唯一正确的结论。\n-   **客观性**：语言技术性强且精确，没有歧义或主观性。\n\n**第三步：结论与行动**\n问题陈述有效。我将继续进行全面分析。\n\n### 求解推导\n\n该问题要求在一个具有非平凡拓扑（具体为第一贝蒂数 $b_1=1$）的区域中，分析离散旋度算子零空间 $\\ker \\mathbf{C}$。\n\n1.  **旋度零空间（$\\ker \\mathbf{C}$）的结构**：\n    边上链（`1-cochains`）的空间可以通过离散霍奇分解的视角来理解。算子 $\\mathbf{C}$ 将边上链（例如，离散电场环量 $\\mathbf{e}$）映射到面上链（例如，电动势）。条件 $\\mathbf{C}\\mathbf{e}=\\mathbf{0}$ 定义了无旋或不可旋转的边上链空间，即 $\\ker \\mathbf{C}$。\n    问题给出了恒等式 $\\mathbf{C}\\mathbf{G}=\\mathbf{0}$。这在数学上表明，任何作为标量势（一个`$0$-cochain` $\\boldsymbol{\\phi}$）的离散梯度的场也是无旋的。因此，梯度算子的像空间 $\\operatorname{im}\\mathbf{G}$ 是 $\\ker \\mathbf{C}$ 的一个子空间。\n    在代数拓扑中，复形的第一上同调群 $H^1$ 定义为商空间 $H^1 = \\ker \\mathbf{C} / \\operatorname{im} \\mathbf{G}$。根据定义，该群的维数是第一贝蒂数 $b_1$。\n    给定 $b_1 = 1$，我们有 $\\dim(H^1) = 1$。这意味着 $\\ker \\mathbf{C}$ 比 $\\operatorname{im} \\mathbf{G}$ “大”一个一维空间。这导致了旋度零空间的正交分解：\n    $$ \\ker \\mathbf{C} = \\operatorname{im}\\mathbf{G} \\oplus \\mathcal{H}^1 $$\n    其中 $\\mathcal{H}^1$ 是一维的调和 $1$-上链空间。$\\mathcal{H}^1$ 的一个基向量 $\\mathbf{h}$ 是一个无旋（$\\mathbf{C}\\mathbf{h}=\\mathbf{0}$）但不是梯度（$\\mathbf{h} \\notin \\operatorname{im}\\mathbf{G}$）的边上链。这样一个上链对应于沿一个不可收缩回路的环量——一个在该复形中不是任何面集（`2-chain`）边界的循环。问题陈述正确地指出，由于区域有一个环柄（$b_1=1$），所以存在这样一个循环。\n\n2.  **调和生成元 $\\mathbf{h}$ 的构造**：\n    一种系统地识别 $\\mathcal{H}^1$ 基的方法是网格的树-余树分解。这包括：\n    -   在原始图（顶点和边）上构建一个最大生成树 $\\mathcal{T}$。\n    -   在对偶图（体和面，或更抽象地说，对偶单元邻接关系）上构建一个最大生成树 $\\mathcal{T}^\\star$。与 $\\mathcal{T}^\\star$ 中的面对偶的原始边构成了“链接”的“余树”。\n    -   因此，所有原始边的集合被划分。对于一个具有 $b_1=1$ 和 $b_2$ 个腔体（第二贝蒂数）的区域，将有 $b_1=1$ 条剩余边，它既不属于原始树 $\\mathcal{T}$，也不属于与对偶树 $\\mathcal{T}^\\star$ 对偶的边集。\n    -   这条唯一的剩余边，当添加到原始树 $\\mathcal{T}$ 时，会完成一个唯一的循环。这个循环正是不可收缩的回路。代表这个循环的上链 $\\mathbf{h}$（例如，在循环边上的值为 $1$，其他地方为 $0$）是 $\\mathcal{H}^1$ 的生成元。\n\n3.  **对旋度-旋度本征问题的影响**：\n    时谐、无源的麦克斯韦方程导致矢量亥姆霍兹方程，在其对电场 $\\mathbf{e}$ 的 FIT 离散化中，变成一个广义本征值问题：\n    $$ \\mathbf{C}^\\top \\mathbf{M}_{\\mu^{-1}} \\mathbf{C} \\mathbf{e} = \\omega^2 \\mathbf{M}_{\\epsilon} \\mathbf{e} $$\n    这里，$\\mathbf{M}_{\\mu^{-1}}$ 和 $\\mathbf{M}_{\\epsilon}$ 是正定的材料矩阵（磁导率的倒数和介电常数）。\n    在这种情况下，“伪模式”通常指本征值 $\\omega^2=0$ 的解。这些是旋度-旋度算子 $\\mathbf{A} = \\mathbf{C}^\\top \\mathbf{M}_{\\mu^{-1}} \\mathbf{C}$ 的零空间中的元素。\n    由于 $\\mathbf{M}_{\\mu^{-1}}$ 是可逆且正定的，$\\mathbf{A}$ 的零空间与 $\\mathbf{C}$ 的零空间相同：\n    $$ \\ker(\\mathbf{A}) = \\ker(\\mathbf{C}^\\top \\mathbf{M}_{\\mu^{-1}} \\mathbf{C}) = \\ker(\\mathbf{C}) $$\n    我们已经确定了 $\\ker \\mathbf{C} = \\operatorname{im}\\mathbf{G} \\oplus \\mathcal{H}^1$。\n    -   $\\operatorname{im}\\mathbf{G}$ 部分对应于从标量势导出的非传播静态电场。它们构成了一个高维的伪零频模式子空间。这对应于电势的规范自由度。\n    -   $\\mathcal{H}^1$ 部分，由于 $b_1=1$ 而存在，为零空间增加了一个维度。这对应于一个无旋但非梯度的静态场构型，与区域的非平凡拓扑相关。这是另一个伪零频模式。\n    为了使本征问题适定并找到非零频率的共振模式，必须将这整个零空间投影出去。这需要施加约束（一种“规范”）。\n    -   梯度场通过例如对标量势施加树规范来移除。\n    -   调和场 $\\mathbf{h}$ 也必须通过一个额外的约束来移除，通常是通过强制解在不可收缩回路上的环量为零（即使解与 $\\mathbf{h}$ 正交）。\n\n### 逐项分析\n\n**A. 建立一个覆盖所有顶点的原始生成树 $\\mathcal{T}$ 和一个覆盖对偶复形所有面的对偶生成树 $\\mathcal{T}^\\star$。当 $b_1=1$ 时，恰好有一条边既不在 $\\mathcal{T}$ 中，也不在与 $\\mathcal{T}^\\star$ 对偶的边集中；使用这条边以及 $\\mathcal{T}$ 中连接其端点的唯一路径，可以得到一个不可收缩的原始回路，其关联的边上链 $\\mathbf{h}$ 满足 $\\mathbf{C}\\mathbf{h}=\\mathbf{0}$ 但 $\\mathbf{h}\\notin \\operatorname{im}\\mathbf{G}$。因此，$\\ker \\mathbf{C}=\\operatorname{im}\\mathbf{G}\\oplus \\operatorname{span}\\{\\mathbf{h}\\}$，引入了一个标量规范自由度。在离散旋度-旋度本征问题中，这个调和自由度会产生一个伪零频模式，除非通过规范或约束（例如，树-余树规范或显式环路积分约束）将其移除。**\n-   此选项正确描述了用于构造调和生成元 $\\mathbf{h}$ 的树-余树方法。\n-   它正确陈述了旋度零空间的分解：$\\ker \\mathbf{C}=\\operatorname{im}\\mathbf{G}\\oplus \\operatorname{span}\\{\\mathbf{h}\\}$。\n-   它正确指出了其后果：在旋度-旋度本征问题中增加了一个伪零频模式。\n-   它正确地指出，此模式可以也必须通过适当的规范或约束来移除。\n-   **结论：正确。**\n\n**B. 仅构造一个对偶生成树 $\\mathcal{T}^\\star$，并取原始边空间中对应的割集作为循环基。由于单个腔体意味着 $b_1=0$，$\\ker \\mathbf{C}$ 只包含梯度，不存在规范自由度，并且旋度-旋度本征问题中没有伪模式。**\n-   此选项犯了几个基本错误。首先，它指出“腔体”意味着 $b_1=0$。问题指定的是“环柄”，对应于 $b_1=1$。腔体对应于 $b_2 \\neq 0$。这与问题陈述相矛盾。由于它假设 $b_1=0$，其余的结论（“$\\ker \\mathbf{C}$ 只包含梯度”）对于给定的问题是不正确的。\n-   **结论：不正确。**\n\n**C. 仅使用一个原始生成树 $\\mathcal{T}$；由每条非树边生成的基本循环集构成了维数为 $m-n+1$（其中 $m$ 是边数，$n$ 是顶点数）的 $\\ker \\mathbf{C}$ 的一个完备基。一个腔体的存在会增加与 $m-n+1$ 成正比的伪非零频模式的数量，无论规范约束如何。**\n-   此选项错误地将图的循环空间基（对于连通图，维数为 $m-n+1$）等同于 $\\ker \\mathbf{C}$ 的基。虽然相关，但这种构造没有区分平凡（边界）循环和非平凡（调和）循环。更关键的是，它声称伪模式是*非零频率*的，这是错误的；它们是零频模式。它还错误地声称它们不能通过规范约束移除。最后，它使用了术语“腔体”而不是“环柄”。\n-   **结论：不正确。**\n\n**D. 取环绕腔体的任意面环的边界；其边链是 $\\ker \\mathbf{C}$ 的一个有效生成元，因为它是一个面的边界，并且调和子空间的维数等于环中面的数量。由此产生的伪模式是物理上的非零频共振，不能通过规范约束移除。**\n-   这个选项有严重缺陷。一个作为“任意...面的边界”的循环，根据定义，是一个平凡循环，而不是调和空间 $\\mathcal{H}^1$ 的生成元。$\\mathcal{H}^1$ 的生成元必须是一个*不是*边界的循环。调和子空间的维数是 $b_1=1$，而不是环中面的数量。它再次将伪模式错误地描述为非零频率和不可移除的，并且使用了“腔体”一词。\n-   **结论：不正确。**\n\n最终结论：选项 A 是唯一一个提出了正确的构造方法、正确的零空间分解以及对旋度-旋度本征问题影响的正确分析的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}