{
    "hands_on_practices": [
        {
            "introduction": "The origin of late-time instability can often be traced back to the fundamental choice of time-stepping algorithm. This first exercise provides a focused look at this issue by analyzing a simplified scalar model of a single, passive mode from a TDIE system. By comparing the stability of the explicit and implicit Euler methods , you will directly compute their amplification factors and see how an unconditionally stable scheme preserves the decaying nature of the physical solution, while a conditionally stable one can lead to unphysical growth.",
            "id": "3322786",
            "problem": "In computational electromagnetics, the Time-Domain Integral Equation (TDIE) for a perfectly electrically conducting scatterer can be formulated from Maxwell’s equations and the electric field boundary condition $\\,\\hat{\\mathbf{n}} \\times \\mathbf{E}^{\\text{tot}} = \\mathbf{0}\\,$ on the surface. After spatial Galerkin testing, the TDIE reduces to a semi-discrete linear system for the surface current expansion coefficients $\\,j(t)\\,$ of the form $\\,C \\,\\dot{j}(t) + K \\, j(t) = 0\\,$, where $\\,C\\,$ is a symmetric positive-definite mass-like matrix associated with the testing functions and $\\,K\\,$ is a symmetric positive-semidefinite operator that encodes the instantaneous part of the retarded interaction under a passive, causal discretization. Consider the scalar mode associated with a single eigenpair of the generalized operator satisfying $\\,C \\in \\mathbb{R}_{0}\\,$ and $\\,K \\in \\mathbb{R}_{\\ge 0}\\,$, yielding the ordinary differential equation $\\,C \\,\\dot{j}(t) + K \\, j(t) = 0\\,$. Assume $\\,C = 1\\,$ and $\\,K = 100\\,$.\n\nStarting from the fundamental laws of electromagnetics and the passive nature of the discretized TDIE, justify that the continuous solution $\\,j(t)\\,$ must be non-increasing in time for positive $\\,K/C\\,$ by reasoning with the energy functional $\\,\\mathcal{E}(t) = \\tfrac{1}{2} C |j(t)|^{2}\\,$. Then, analyze the discrete-time stability of two time-stepping schemes applied to this scalar semi-discrete TDIE mode:\n\n- Explicit Euler: $\\,j^{n+1} = j^{n} + \\Delta t \\,\\dot{j}^{n}\\,$.\n- Backward Euler: $\\,j^{n+1} = j^{n} + \\Delta t \\,\\dot{j}^{n+1}\\,$.\n\nFor a time step $\\,\\Delta t = 0.05\\,$, derive the one-step amplification factor $\\,g\\,$ for each method in terms of $\\,C\\,$, $\\,K\\,$, and $\\,\\Delta t\\,$, and then compute the numerical values using the given $\\,C\\,$, $\\,K\\,$, and $\\,\\Delta t\\,$. Use the criterion $\\,|g|  1\\,$ to decide which scheme avoids late-time blow-up for this passive TDIE mode. Express the amplification factors as exact, dimensionless real numbers without rounding. Provide your final answer as a row matrix containing the two amplification factors in the order explicit Euler first, backward Euler second.",
            "solution": "The Time-Domain Integral Equation (TDIE) formulation originates from Maxwell’s equations,\n$$\n\\nabla \\times \\mathbf{E} = -\\mu \\,\\frac{\\partial \\mathbf{H}}{\\partial t}, \\quad\n\\nabla \\times \\mathbf{H} = \\epsilon \\,\\frac{\\partial \\mathbf{E}}{\\partial t} + \\mathbf{J},\n$$\ntogether with the perfectly electrically conducting boundary condition $\\,\\hat{\\mathbf{n}} \\times \\mathbf{E}^{\\text{tot}} = \\mathbf{0}\\,$ on the conductor surface. When this boundary-value problem is cast into an integral equation and discretized using a Galerkin procedure in space with causal testing, the semi-discrete evolution for the current coefficients $\\,j(t)\\,$ assumes the linear form\n$$\nC \\,\\dot{j}(t) + K \\, j(t) = 0,\n$$\nwhere $\\,C > 0\\,$ and $\\,K \\ge 0\\,$ for passive, causal discretizations. Physically, $\\,K/C\\,$ acts as a nonnegative rate parameter indicating dissipative (non-increasing energy) dynamics.\n\nTo confirm non-increasing behavior in the continuous-time system, consider the energy functional\n$$\n\\mathcal{E}(t) = \\frac{1}{2} C |j(t)|^{2}.\n$$\nIts time derivative is\n$$\n\\frac{d\\mathcal{E}}{dt} = \\frac{1}{2} C \\,\\frac{d}{dt}\\big(|j|^{2}\\big) = C \\,j\\,\\dot{j}.\n$$\nUsing the semi-discrete equation $\\,C \\,\\dot{j} + K \\, j = 0\\,$, we obtain $\\,\\dot{j} = -\\frac{K}{C} j\\,$ and therefore\n$$\n\\frac{d\\mathcal{E}}{dt} = C \\,j \\left(-\\frac{K}{C} j\\right) = -K\\,|j|^{2} \\le 0.\n$$\nThis shows $\\,\\mathcal{E}(t)\\,$ is non-increasing, and the solution decays monotonically when $\\,K/C > 0\\,$. The exact continuous solution of the scalar equation is\n$$\n\\dot{j}(t) = -\\lambda \\, j(t), \\quad \\text{with} \\quad \\lambda \\equiv \\frac{K}{C} \\ge 0,\n$$\nyielding\n$$\nj(t) = j(0)\\,\\exp(-\\lambda t),\n$$\nwhich decays for $\\,\\lambda > 0\\,$.\n\nWe now study the discrete-time stability through the one-step amplification factor $\\,g\\,$, defined by $\\,j^{n+1} = g\\,j^{n}\\,$ for a numerical method applied to $\\,\\dot{j} = -\\lambda j\\,$ with step $\\,\\Delta t\\,$. Stability for passive modes requires $\\,|g|  1\\,$, ensuring that the discrete energy decreases analogously to the continuous system.\n\nFor explicit Euler,\n$$\nj^{n+1} = j^{n} + \\Delta t\\,\\dot{j}^{n} = j^{n} + \\Delta t \\left(-\\lambda j^{n}\\right) = \\left(1 - \\lambda \\Delta t\\right) j^{n}.\n$$\nThus, the amplification factor is\n$$\ng_{\\text{EE}} = 1 - \\lambda \\Delta t = 1 - \\frac{K}{C}\\,\\Delta t.\n$$\n\nFor backward Euler,\n$$\nj^{n+1} = j^{n} + \\Delta t\\,\\dot{j}^{n+1} = j^{n} + \\Delta t \\left(-\\lambda j^{n+1}\\right).\n$$\nRearranging,\n$$\n\\left(1 + \\lambda \\Delta t\\right) j^{n+1} = j^{n},\n$$\nhence the amplification factor is\n$$\ng_{\\text{BE}} = \\frac{1}{1 + \\lambda \\Delta t} = \\frac{1}{1 + \\frac{K}{C}\\,\\Delta t}.\n$$\n\nWith the given parameters $\\,C = 1\\,$, $\\,K = 100\\,$, and $\\,\\Delta t = 0.05\\,$, we compute\n$$\n\\lambda = \\frac{K}{C} = \\frac{100}{1} = 100, \\quad \\lambda \\Delta t = 100 \\times 0.05 = 5.\n$$\nTherefore,\n$$\ng_{\\text{EE}} = 1 - 5 = -4,\n$$\nand\n$$\ng_{\\text{BE}} = \\frac{1}{1 + 5} = \\frac{1}{6}.\n$$\n\nFinally, we evaluate the stability criterion $\\,|g|  1\\,$:\n- For explicit Euler, $\\,|g_{\\text{EE}}| = |-4| = 4 > 1\\,$, which implies instability and late-time blow-up due to oscillatory growth.\n- For backward Euler, $\\,|g_{\\text{BE}}| = \\left|\\frac{1}{6}\\right| = \\frac{1}{6}  1\\,$, which guarantees damping and suppresses late-time instability.\n\nThus, backward Euler avoids late-time blow-up for this passive TDIE mode, while explicit Euler does not. The requested dimensionless amplification factors, in the order explicit Euler first and backward Euler second, are $-4\\,$ and $\\,\\tfrac{1}{6}\\,$, respectively.",
            "answer": "$$\\boxed{\\begin{pmatrix}-4  \\frac{1}{6}\\end{pmatrix}}$$"
        },
        {
            "introduction": "While single-step methods are illustrative, practical TDIE solvers often employ multi-step recursions, making stability analysis more complex. This exercise introduces the powerful state-space representation, where a higher-order recursion is transformed into a first-order matrix system governed by a companion matrix. By constructing this matrix and finding its eigenvalues , you will learn a general technique to determine the stability of any linear, constant-coefficient Marching-on-in-Time (MOT) scheme by checking if its spectral radius is less than one.",
            "id": "3322790",
            "problem": "In time-domain integral equation (TDIE) solvers for computational electromagnetics, Marching-On-in-Time (MOT) discretizations of the Time-Domain Electric Field Integral Equation (TD-EFIE) often produce a linear, constant-coefficient, two-step recursion for the vector of expansion coefficients. Consider the modal recursion\n$$\n\\mathbf{x}_{n}=\\mathbf{A}_{1}\\,\\mathbf{x}_{n-1}+\\mathbf{A}_{2}\\,\\mathbf{x}_{n-2},\n$$\nwhere $\\mathbf{x}_{n}\\in\\mathbb{C}^{2}$ are the modal coefficients at discrete time index $n$, and $\\mathbf{A}_{1},\\mathbf{A}_{2}\\in\\mathbb{R}^{2\\times 2}$ are time-invariant update matrices resulting from spatial Galerkin testing and a two-step temporal integration scheme. A standard state augmentation yields the $4\\times 4$ block companion matrix\n$$\n\\mathbf{C}=\\begin{bmatrix}\\mathbf{A}_{1}\\mathbf{A}_{2}\\\\ \\mathbf{I}\\mathbf{0}\\end{bmatrix},\n$$\nwith $\\mathbf{I}\\in\\mathbb{R}^{2\\times 2}$ the identity and $\\mathbf{0}\\in\\mathbb{R}^{2\\times 2}$ the zero matrix, so that $\\begin{bmatrix}\\mathbf{x}_{n}\\\\ \\mathbf{x}_{n-1}\\end{bmatrix}=\\mathbf{C}\\begin{bmatrix}\\mathbf{x}_{n-1}\\\\ \\mathbf{x}_{n-2}\\end{bmatrix}$. Late-time stability of the MOT recursion is governed by the eigenvalues of $\\mathbf{C}$ through the asymptotic behavior of the linear time-invariant state transition.\n\nGiven\n$$\n\\mathbf{A}_{1}=\\begin{bmatrix}0.9  0\\\\ 0  0.95\\end{bmatrix},\\qquad\n\\mathbf{A}_{2}=\\begin{bmatrix}-0.1  0\\\\ 0  0.02\\end{bmatrix},\n$$\nperform the following:\n- Construct the $4\\times 4$ companion matrix $\\mathbf{C}$ from first principles.\n- Derive, from the eigenvalue equation for $\\mathbf{C}$ and fundamental properties of determinants and block matrices, the modal characteristic polynomials that determine the eigenvalues.\n- Compute the four eigenvalues analytically in exact form, and use the spectral radius criterion to conclude whether the recursion is asymptotically stable (all modes decay in the long term) or unstable.\n\nExpress your final answer as the four eigenvalues in exact analytical form; no rounding is required. No units are required. Any stability conclusion must be justified in your derivation, but only the eigenvalues should be reported as the final answer.",
            "solution": "The problem requires the analysis of a two-step linear recursion common in time-domain integral equation (TDIE) methods. The stability of this recursion is determined by the eigenvalues of its associated companion matrix.\n\nThe given recursion is:\n$$\n\\mathbf{x}_{n}=\\mathbf{A}_{1}\\,\\mathbf{x}_{n-1}+\\mathbf{A}_{2}\\,\\mathbf{x}_{n-2}\n$$\nwith matrices\n$$\n\\mathbf{A}_{1}=\\begin{bmatrix}0.90\\\\00.95\\end{bmatrix},\\qquad\n\\mathbf{A}_{2}=\\begin{bmatrix}-0.10\\\\00.02\\end{bmatrix}\n$$\nThe state-space representation is given by $\\begin{bmatrix}\\mathbf{x}_{n}\\\\ \\mathbf{x}_{n-1}\\end{bmatrix}=\\mathbf{C}\\begin{bmatrix}\\mathbf{x}_{n-1}\\\\ \\mathbf{x}_{n-2}\\end{bmatrix}$, where $\\mathbf{C}$ is the block companion matrix.\n\nFirst, we construct the $4\\times 4$ companion matrix $\\mathbf{C}$ using its definition:\n$$\n\\mathbf{C}=\\begin{bmatrix}\\mathbf{A}_{1}\\mathbf{A}_{2}\\\\ \\mathbf{I}\\mathbf{0}\\end{bmatrix}\n$$\nSubstituting the given $2\\times 2$ matrices $\\mathbf{A}_{1}$ and $\\mathbf{A}_{2}$, along with the $2\\times 2$ identity matrix $\\mathbf{I}$ and zero matrix $\\mathbf{0}$, we obtain:\n$$\n\\mathbf{C} = \\begin{bmatrix}\n0.9  0  -0.1  0 \\\\\n0  0.95  0  0.02 \\\\\n1  0  0  0 \\\\\n0  1  0  0\n\\end{bmatrix}\n$$\n\nNext, we derive the characteristic equation for the eigenvalues $\\lambda$ of $\\mathbf{C}$, which is given by $\\det(\\mathbf{C} - \\lambda\\mathbf{I}_{4}) = 0$, where $\\mathbf{I}_{4}$ is the $4\\times 4$ identity matrix. We write this in block matrix form:\n$$\n\\det\\begin{pmatrix}\n\\mathbf{A}_{1} - \\lambda\\mathbf{I}_{2}  \\mathbf{A}_{2} \\\\\n\\mathbf{I}_{2}  -\\lambda\\mathbf{I}_{2}\n\\end{pmatrix} = 0\n$$\nwhere $\\mathbf{I}_2$ is the $2\\times 2$ identity matrix. We use the formula for the determinant of a block matrix, $\\det\\begin{pmatrix} \\mathbf{P}  \\mathbf{Q} \\\\ \\mathbf{R}  \\mathbf{S} \\end{pmatrix} = \\det(\\mathbf{S}) \\det(\\mathbf{P} - \\mathbf{Q}\\mathbf{S}^{-1}\\mathbf{R})$, which is applicable for invertible $\\mathbf{S}$. Here, $\\mathbf{S} = -\\lambda\\mathbf{I}_{2}$, which is invertible for $\\lambda \\neq 0$. Its inverse is $\\mathbf{S}^{-1} = -\\frac{1}{\\lambda}\\mathbf{I}_{2}$. Applying the formula:\n$$\n\\det(-\\lambda\\mathbf{I}_{2}) \\det\\left( (\\mathbf{A}_{1} - \\lambda\\mathbf{I}_{2}) - \\mathbf{A}_{2} \\left(-\\frac{1}{\\lambda}\\mathbf{I}_{2}\\right) \\mathbf{I}_{2} \\right) = 0\n$$\n$$\n(-\\lambda)^{2} \\det\\left( \\mathbf{A}_{1} - \\lambda\\mathbf{I}_{2} + \\frac{1}{\\lambda}\\mathbf{A}_{2} \\right) = 0\n$$\n$$\n\\lambda^{2} \\det\\left( \\frac{1}{\\lambda} (\\lambda\\mathbf{A}_{1} - \\lambda^{2}\\mathbf{I}_{2} + \\mathbf{A}_{2}) \\right) = 0\n$$\nUsing the property $\\det(k\\mathbf{M}) = k^d \\det(\\mathbf{M})$ where $d$ is the dimension of the square matrix $\\mathbf{M}$ (here $d=2$):\n$$\n\\lambda^{2} \\left(\\frac{1}{\\lambda}\\right)^2 \\det(\\lambda\\mathbf{A}_{1} - \\lambda^{2}\\mathbf{I}_{2} + \\mathbf{A}_{2}) = 0\n$$\nThis simplifies to the general characteristic equation for this block companion matrix structure:\n$$\n\\det(\\lambda^{2}\\mathbf{I}_{2} - \\lambda\\mathbf{A}_{1} - \\mathbf{A}_{2}) = 0\n$$\nThis is a matrix polynomial whose determinant must be zero. Since $\\mathbf{A}_{1}$ and $\\mathbf{A}_{2}$ are diagonal matrices, the matrix polynomial itself is diagonal:\n$$\n\\lambda^{2}\\begin{bmatrix}10\\\\01\\end{bmatrix} - \\lambda\\begin{bmatrix}0.90\\\\00.95\\end{bmatrix} - \\begin{bmatrix}-0.10\\\\00.02\\end{bmatrix} = \\begin{bmatrix} \\lambda^2 - 0.9\\lambda + 0.1  0 \\\\ 0  \\lambda^2 - 0.95\\lambda - 0.02 \\end{bmatrix}\n$$\nThe determinant of a diagonal matrix is the product of its diagonal elements. Thus, the characteristic equation decouples into two independent modal characteristic polynomials:\n$$\n(\\lambda^2 - 0.9\\lambda + 0.1)(\\lambda^2 - 0.95\\lambda - 0.02) = 0\n$$\nThis gives two quadratic equations to solve.\n\nFor the first mode:\n$$\n\\lambda^2 - 0.9\\lambda + 0.1 = 0\n$$\nMultiplying by $10$ to work with integers gives $10\\lambda^2 - 9\\lambda + 1 = 0$. Using the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\n\\lambda_{1,2} = \\frac{9 \\pm \\sqrt{(-9)^2 - 4(10)(1)}}{2(10)} = \\frac{9 \\pm \\sqrt{81 - 40}}{20} = \\frac{9 \\pm \\sqrt{41}}{20}\n$$\nSo, the first two eigenvalues are $\\lambda_1 = \\frac{9 + \\sqrt{41}}{20}$ and $\\lambda_2 = \\frac{9 - \\sqrt{41}}{20}$.\n\nFor the second mode:\n$$\n\\lambda^2 - 0.95\\lambda - 0.02 = 0\n$$\nMultiplying by $100$ gives $100\\lambda^2 - 95\\lambda - 2 = 0$. Using the quadratic formula:\n$$\n\\lambda_{3,4} = \\frac{95 \\pm \\sqrt{(-95)^2 - 4(100)(-2)}}{2(100)} = \\frac{95 \\pm \\sqrt{9025 + 800}}{200} = \\frac{95 \\pm \\sqrt{9825}}{200}\n$$\nTo simplify the square root, we factor $9825 = 25 \\times 393$. Thus, $\\sqrt{9825} = \\sqrt{25}\\sqrt{393} = 5\\sqrt{393}$.\n$$\n\\lambda_{3,4} = \\frac{95 \\pm 5\\sqrt{393}}{200} = \\frac{5(19 \\pm \\sqrt{393})}{200} = \\frac{19 \\pm \\sqrt{393}}{40}\n$$\nSo, the other two eigenvalues are $\\lambda_3 = \\frac{19 + \\sqrt{393}}{40}$ and $\\lambda_4 = \\frac{19 - \\sqrt{393}}{40}$.\n\nFinally, we assess the stability. The recursion is asymptotically stable if and only if the spectral radius $\\rho(\\mathbf{C}) = \\max_i|\\lambda_i|$ is strictly less than $1$. We estimate the magnitudes:\n- $\\sqrt{41} \\approx 6.403$.\n  $\\lambda_1 \\approx \\frac{9+6.403}{20} \\approx \\frac{15.403}{20} \\approx 0.770$. $|\\lambda_1|1$.\n  $\\lambda_2 \\approx \\frac{9-6.403}{20} \\approx \\frac{2.597}{20} \\approx 0.130$. $|\\lambda_2|1$.\n- $\\sqrt{393} \\approx 19.824$.\n  $\\lambda_3 \\approx \\frac{19+19.824}{40} \\approx \\frac{38.824}{40} \\approx 0.971$. $|\\lambda_3|1$.\n  $\\lambda_4 \\approx \\frac{19-19.824}{40} \\approx \\frac{-0.824}{40} \\approx -0.021$. $|\\lambda_4|1$.\n\nAll four eigenvalues have magnitudes less than $1$. The largest in magnitude is $\\lambda_3 \\approx 0.971$. Since the spectral radius $\\rho(\\mathbf{C})  1$, the recursion is asymptotically stable. The problem, however, only asks for the analytical form of the eigenvalues.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{9 + \\sqrt{41}}{20}  \\frac{9 - \\sqrt{41}}{20}  \\frac{19 + \\sqrt{393}}{40}  \\frac{19 - \\sqrt{393}}{40} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Identifying an instability is only half the battle; the ultimate goal is to suppress it. This practice shifts our focus from analysis to correction by introducing the concept of targeted modal damping. You will work with a procedure to identify unstable or borderline modes by examining the eigenvalues of the system's propagation matrix and then systematically modify them to ensure stability . This hands-on exercise demonstrates a sophisticated and minimally invasive technique for creating robust, instability-free TDIE solvers.",
            "id": "3322817",
            "problem": "You are given a discrete-time propagation matrix that arises from marching-on-in-time discretizations of time-domain integral equations (TDIE) for electromagnetic scattering. Starting from Maxwell’s equations in free space, the time-domain Electric Field Integral Equation (EFIE) expresses the boundary fields as retarded potentials convolved in time with the surface current density. After spatio-temporal Galerkin testing and using causal basis functions, the discrete TDIE can be written as a lower-triangular discrete convolution in time for current coefficients. Introducing an augmented state that stacks a finite window of past current vectors produces a homogeneous linear recurrence of the form\n$$\n\\mathbf{x}^{n+1} = \\mathbf{M}\\,\\mathbf{x}^n,\n$$\nwhere $\\mathbf{x}^n$ is the augmented state at time step $n$, and $\\mathbf{M}$ is the discrete propagation matrix. Late-time stability is governed by the spectrum of $\\mathbf{M}$ since\n$$\n\\mathbf{x}^{n} = \\mathbf{M}^{n}\\,\\mathbf{x}^0,\n$$\nand thus the asymptotic growth is controlled by the spectral radius $\\rho(\\mathbf{M}) = \\max_i |\\lambda_i(\\mathbf{M})|$. If $\\rho(\\mathbf{M})  1$, solutions generically grow without bound. If $\\rho(\\mathbf{M}) = 1$ and there exist eigenvalues on the unit circle with nontrivial Jordan blocks or round-off driven energy inflow, late-time growth may still occur. If $\\rho(\\mathbf{M})  1$, trajectories decay. Therefore, correlating the proximity of eigenvalues to the unit circle with observed instability is a principled diagnostic.\n\nYour task is to implement the following steps from first principles of linear stability analysis:\n\n1) For each provided test matrix $\\mathbf{M}$, compute all eigenvalues $\\{\\lambda_i\\}$ and the spectral radius $\\rho(\\mathbf{M}) = \\max_i |\\lambda_i|$.\n\n2) Classify stability using a tolerance $\\varepsilon$ around the unit circle to account for numerical and modeling uncertainty: \n- If $\\rho(\\mathbf{M})  1 + \\varepsilon$, return the integer classification $+1$ (unstable).\n- If $|\\rho(\\mathbf{M}) - 1| \\le \\varepsilon$, return the integer classification $0$ (borderline).\n- If $\\rho(\\mathbf{M})  1 - \\varepsilon$, return the integer classification $-1$ (stable).\n\n3) Propose and apply a targeted modal damping strategy to suppress late-time instabilities without over-damping the entire system. In modal (eigen) coordinates, replace each problematic eigenvalue $\\lambda$ by a scaled eigenvalue $\\lambda'$ defined by\n$$\n\\lambda' = \n\\begin{cases}\n\\displaystyle \\frac{r_{\\mathrm{tgt}}}{|\\lambda|}\\,\\lambda,  \\text{if } ||\\lambda| - 1| \\le \\tau \\text{ or } |\\lambda|  1, \\\\\n\\lambda,  \\text{otherwise,}\n\\end{cases}\n$$\nwhere $r_{\\mathrm{tgt}} \\in (0,1)$ is the target radius strictly inside the unit circle, and $\\tau \\ge 0$ is a selection bandwidth that flags eigenvalues whose magnitudes are within a small band of the unit circle or outside it. This realizes a minimal, mode-selective damping that leaves well-damped modes untouched. Reconstruct a damped matrix $\\mathbf{M}_{\\mathrm{damped}}$ from the modified eigenvalues and the original eigenvectors. Report how many eigenvalues were modified. Finally, compute the spectral radius $\\rho(\\mathbf{M}_{\\mathrm{damped}})$ based on the modified eigenvalues.\n\nAll computations are dimensionless; no physical unit is required. Angles must be in radians. Round all floating results to six decimal places.\n\nTest Suite (four matrices probing different regimes):\n\n- Case A (stable rotating mode): \n$$\n\\mathbf{M}_A = r_A\n\\begin{bmatrix}\n\\cos\\theta_A  -\\sin\\theta_A\\\\\n\\sin\\theta_A  \\cos\\theta_A\n\\end{bmatrix},\n\\quad r_A = 0.95,\\ \\theta_A = 0.4.\n$$\n\n- Case B (slightly unstable rotating mode):\n$$\n\\mathbf{M}_B = r_B\n\\begin{bmatrix}\n\\cos\\theta_B  -\\sin\\theta_B\\\\\n\\sin\\theta_B  \\cos\\theta_B\n\\end{bmatrix},\n\\quad r_B = 1.003,\\ \\theta_B = 0.2.\n$$\n\n- Case C (borderline rotating mode, near the unit circle):\n$$\n\\mathbf{M}_C = r_C\n\\begin{bmatrix}\n\\cos\\theta_C  -\\sin\\theta_C\\\\\n\\sin\\theta_C  \\cos\\theta_C\n\\end{bmatrix},\n\\quad r_C = 0.9995,\\ \\theta_C = 1.2.\n$$\n\n- Case D (mixed modes: stable rotating block plus one unstable real mode):\n$$\n\\mathbf{M}_D = \n\\begin{bmatrix}\nr_D \\cos\\theta_D  -r_D \\sin\\theta_D  0\\\\\nr_D \\sin\\theta_D  \\phantom{-}r_D \\cos\\theta_D  0\\\\\n0  0  \\lambda_D\n\\end{bmatrix},\n\\quad r_D = 0.98,\\ \\theta_D = 0.5,\\ \\lambda_D = 1.02.\n$$\n\nUse the following parameters for classification and damping:\n- Classification tolerance: $\\varepsilon = 5\\times 10^{-4}$.\n- Selection bandwidth: $\\tau = 5\\times 10^{-4}$.\n- Target radius: $r_{\\mathrm{tgt}} = 0.995$.\n\nFor each case, compute:\n- The spectral radius before damping $\\rho(\\mathbf{M})$.\n- The integer classification.\n- The count of damped eigenvalues.\n- The spectral radius after damping $\\rho(\\mathbf{M}_{\\mathrm{damped}})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a four-element list corresponding to one test case in the order A, B, C, D:\n$$\n\\big[ [\\rho_A,\\ \\mathrm{class}_A,\\ N_{d,A},\\ \\rho_{A,\\mathrm{d}}],\\ [\\rho_B,\\ \\mathrm{class}_B,\\ N_{d,B},\\ \\rho_{B,\\mathrm{d}}],\\ [\\rho_C,\\ \\mathrm{class}_C,\\ N_{d,C},\\ \\rho_{C,\\mathrm{d}}],\\ [\\rho_D,\\ \\mathrm{class}_D,\\ N_{d,D},\\ \\rho_{D,\\mathrm{d}}] \\big].\n$$\nAll floating results must be rounded to six decimal places, and the classification and counts must be integers. No other text should be printed.",
            "solution": "The problem requires a stability analysis and modal damping of several discrete-time propagation matrices $\\mathbf{M}$, which model the time evolution of a system via the recurrence relation $\\mathbf{x}^{n+1} = \\mathbf{M}\\,\\mathbf{x}^n$. The long-term behavior of the state vector $\\mathbf{x}^n$ is determined by the spectral properties of $\\mathbf{M}$.\n\nThe fundamental principle is that the system is stable if and only if all trajectories $\\mathbf{x}^n = \\mathbf{M}^n \\mathbf{x}^0$ converge to zero for any initial state $\\mathbf{x}^0$. This is guaranteed if the spectral radius of the propagation matrix, $\\rho(\\mathbf{M}) = \\max_i |\\lambda_i(\\mathbf{M})|$, is strictly less than $1$. If $\\rho(\\mathbf{M})  1$, at least one mode grows exponentially, rendering the system unstable. If $\\rho(\\mathbf{M}) = 1$, the system is borderline and may exhibit instability due to effects not captured by simple magnitude analysis, such as non-trivial Jordan blocks or numerical error accumulation.\n\nThe solution proceeds in three stages as specified:\n1.  Eigenvalue analysis to determine the spectral radius $\\rho(\\mathbf{M})$.\n2.  Stability classification based on the proximity of $\\rho(\\mathbf{M})$ to $1$.\n3.  Application of a targeted modal damping strategy to stabilize the system by modifying unstable or borderline eigenvalues.\n\nThe parameters for this analysis are:\n-   Classification tolerance: $\\varepsilon = 5 \\times 10^{-4}$\n-   Damping selection bandwidth: $\\tau = 5 \\times 10^{-4}$\n-   Damping target radius: $r_{\\mathrm{tgt}} = 0.995$\n\nThe stability classification rules are:\n-   Unstable ($+1$): If $\\rho(\\mathbf{M})  1 + \\varepsilon = 1.0005$.\n-   Borderline ($0$): If $| \\rho(\\mathbf{M}) - 1 | \\le \\varepsilon$, which corresponds to $0.9995 \\le \\rho(\\mathbf{M}) \\le 1.0005$.\n-   Stable ($-1$): If $\\rho(\\mathbf{M})  1 - \\varepsilon = 0.9995$.\n\nThe modal damping strategy modifies any eigenvalue $\\lambda$ whose magnitude $|\\lambda|$ meets the condition $|\\,|\\lambda| - 1\\,| \\le \\tau$ or $|\\lambda|  1$. Combining these, the condition for modification simplifies to $|\\lambda| \\ge 1 - \\tau = 0.9995$. A selected eigenvalue $\\lambda$ is replaced by a new eigenvalue $\\lambda'$ that has the same phase but its magnitude is scaled to the target radius $r_{\\mathrm{tgt}}$:\n$$\n\\lambda' = \\frac{r_{\\mathrm{tgt}}}{|\\lambda|}\\,\\lambda\n$$\nThe magnitude of the modified eigenvalue is therefore $|\\lambda'| = r_{\\mathrm{tgt}} = 0.995$. The spectral radius of the damped matrix, $\\rho(\\mathbf{M}_{\\mathrm{damped}})$, is the maximum magnitude among all eigenvalues after this modification process.\n\nWe now analyze each test case.\n\n**Case A:**\nThe matrix is $\\mathbf{M}_A = r_A \\begin{pmatrix} \\cos\\theta_A  -\\sin\\theta_A \\\\ \\sin\\theta_A  \\cos\\theta_A \\end{pmatrix}$ with $r_A = 0.95$ and $\\theta_A = 0.4$. This is a scaled rotation matrix. Its eigenvalues are a complex conjugate pair $\\lambda_{1,2} = r_A e^{\\pm i\\theta_A} = 0.95 e^{\\pm i 0.4}$. The magnitudes are $|\\lambda_{1,2}| = 0.95$.\n1.  **Spectral Radius:** $\\rho(\\mathbf{M}_A) = 0.95$.\n2.  **Classification:** Since $0.95  0.9995$, the system is **stable** (classification: $-1$).\n3.  **Damping:** The eigenvalue magnitudes are $0.95$, which is less than the selection threshold of $0.9995$. Thus, no eigenvalues are modified. The count of damped eigenvalues is $N_{d,A} = 0$.\n4.  **Damped Spectral Radius:** As no modifications were made, $\\rho(\\mathbf{M}_{A,\\mathrm{damped}}) = \\rho(\\mathbf{M}_A) = 0.95$.\n\n**Case B:**\nThe matrix is $\\mathbf{M}_B$ with $r_B = 1.003$ and $\\theta_B = 0.2$. The eigenvalues are $\\lambda_{1,2} = 1.003 e^{\\pm i 0.2}$. The magnitudes are $|\\lambda_{1,2}| = 1.003$.\n1.  **Spectral Radius:** $\\rho(\\mathbf{M}_B) = 1.003$.\n2.  **Classification:** Since $1.003  1.0005$, the system is **unstable** (classification: $+1$).\n3.  **Damping:** The eigenvalue magnitudes of $1.003$ are greater than the selection threshold of $0.9995$. Therefore, both eigenvalues are selected for damping. The count of damped eigenvalues is $N_{d,B} = 2$.\n4.  **Damped Spectral Radius:** Both eigenvalues are modified to have a new magnitude of $r_{\\mathrm{tgt}} = 0.995$. The new spectral radius is $\\rho(\\mathbf{M}_{B,\\mathrm{damped}}) = 0.995$.\n\n**Case C:**\nThe matrix is $\\mathbf{M}_C$ with $r_C = 0.9995$ and $\\theta_C = 1.2$. The eigenvalues are $\\lambda_{1,2} = 0.9995 e^{\\pm i 1.2}$. The magnitudes are $|\\lambda_{1,2}| = 0.9995$.\n1.  **Spectral Radius:** $\\rho(\\mathbf{M}_C) = 0.9995$.\n2.  **Classification:** The spectral radius satisfies $0.9995 \\le \\rho(\\mathbf{M}_C) \\le 1.0005$. The system is classified as **borderline** (classification: $0$).\n3.  **Damping:** The eigenvalue magnitudes are $0.9995$, which equals the selection threshold. Thus, both eigenvalues are selected for damping. The count of damped eigenvalues is $N_{d,C} = 2$.\n4.  **Damped Spectral Radius:** Both eigenvalues are modified to have a new magnitude of $r_{\\mathrm{tgt}} = 0.995$. The new spectral radius is $\\rho(\\mathbf{M}_{C,\\mathrm{damped}}) = 0.995$.\n\n**Case D:**\nThe matrix $\\mathbf{M}_D$ is block-diagonal with a $2 \\times 2$ scaled rotation block and a $1 \\times 1$ block. The parameters are $r_D = 0.98$, $\\theta_D = 0.5$, and $\\lambda_D = 1.02$. The eigenvalues are the union of the eigenvalues of the blocks: $\\lambda_{1,2} = 0.98 e^{\\pm i 0.5}$ and $\\lambda_3 = 1.02$. The corresponding magnitudes are $|\\lambda_{1,2}| = 0.98$ and $|\\lambda_3| = 1.02$.\n1.  **Spectral Radius:** $\\rho(\\mathbf{M}_D) = \\max(0.98, 1.02) = 1.02$.\n2.  **Classification:** Since $1.02  1.0005$, the system is **unstable** (classification: $+1$).\n3.  **Damping:** We check each eigenvalue's magnitude against the threshold $0.9995$.\n    -   $|\\lambda_{1,2}| = 0.98  0.9995$. These are not modified.\n    -   $|\\lambda_3| = 1.02 \\ge 0.9995$. This eigenvalue is modified.\n    The count of damped eigenvalues is $N_{d,D} = 1$.\n4.  **Damped Spectral Radius:** The magnitudes of the unmodified eigenvalues remain $0.98$. The magnitude of the modified eigenvalue becomes $r_{\\mathrm{tgt}} = 0.995$. The set of magnitudes after damping is $\\{0.98, 0.98, 0.995\\}$. The new spectral radius is the maximum of these values: $\\rho(\\mathbf{M}_{D,\\mathrm{damped}}) = \\max(0.98, 0.995) = 0.995$.",
            "answer": "[[0.950000, -1, 0, 0.950000], [1.003000, 1, 2, 0.995000], [0.999500, 0, 2, 0.995000], [1.020000, 1, 1, 0.995000]]"
        }
    ]
}