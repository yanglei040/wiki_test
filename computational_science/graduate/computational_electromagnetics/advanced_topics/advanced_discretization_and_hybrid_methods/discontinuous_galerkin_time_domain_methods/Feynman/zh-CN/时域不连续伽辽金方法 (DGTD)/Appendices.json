{
    "hands_on_practices": [
        {
            "introduction": "显式间断伽辽金时域（DGTD）方法的计算效率在很大程度上取决于质量矩阵的结构。一个对角化的质量矩阵能将每个时间步中求解线性方程组的复杂过程简化为简单的标量乘法，从而极大地提升计算速度。本练习将引导你为四面体单元构建一组模态正交基函数，这是实现质量矩阵对角化的关键步骤 。通过这个实践，你将掌握在复杂几何单元上构建高效DGTD格式的基础技能。",
            "id": "3300621",
            "problem": "考虑在单个四面体单元上采用间断伽辽金 (DG) 方法的麦克斯韦方程组的半离散格式，特别是时域间断伽辽金 (DGTD) 格式。用于电场的半离散系统包含一个局部质量矩阵，该矩阵由基函数的体积内积定义。设参考四面体为 $\\widehat{T} = \\{(r,s,t) \\in \\mathbb{R}^{3} : r \\ge 0,\\ s \\ge 0,\\ t \\ge 0,\\ r+s+t \\le 1\\}$，并设 $K$ 是一个通过仿射映射从 $\\widehat{T}$ 得到的物理四面体单元。\n\n您的任务如下：\n\n1) 在 $\\widehat{T}$ 上定义一个总次数最高为 $p$ 的模式多项式基 $\\{\\widehat{\\psi}_{\\ell m n}\\}_{\\ell+m+n \\le p}$，该基相对于 $\\widehat{T}$ 上的 $L^{2}$ 内积是标准正交的。使用折叠坐标和雅可比多项式表示通用基元 $\\widehat{\\psi}_{\\ell m n}(r,s,t)$，并通过一个常数 $N_{\\ell m n}$ 进行归一化，使得\n$$\n\\int_{\\widehat{T}} \\widehat{\\psi}_{\\ell m n}(r,s,t)\\,\\widehat{\\psi}_{\\ell' m' n'}(r,s,t)\\,\\mathrm{d}V = \\delta_{\\ell\\ell'}\\,\\delta_{m m'}\\,\\delta_{n n'}.\n$$\n给出 $\\widehat{\\psi}_{\\ell m n}$ 以雅可比多项式表示的符号形式，并明确说明如何选择归一化常数 $N_{\\ell m n}$ 以实现标准正交性。\n\n2) 设物理四面体 $K$ 的顶点为 $(0,0,0)$、$(2,0,0)$、$(0,3,0)$、$(0,0,4)$。考虑由 $(x,y,z) = (2r,\\,3s,\\,4t)$ 给出的仿射映射 $\\Phi : \\widehat{T} \\to K$，并通过 $\\psi_{\\ell m n}(x,y,z) = \\widehat{\\psi}_{\\ell m n}(r,s,t)$（其中 $(r,s,t) = \\Phi^{-1}(x,y,z)$）定义 $K$ 上的拉回模式基。对于体质量矩阵\n$$\nM_{\\alpha\\beta} = \\int_{K} \\psi_{\\alpha}(x,y,z)\\,\\psi_{\\beta}(x,y,z)\\,\\mathrm{d}V,\n$$\n在精确积分下，计算其代表性矩阵元 $M_{(0,0,0),(0,0,0)}$ 和 $M_{(1,0,0),(0,0,0)}$。\n\n3) 假设为仿射映射，请陈述一个四面体体积求积法则需满足的精确条件，在此条件下，当使用最高次数为 $p$ 的标准正交模式基时，通过求积计算出的离散质量矩阵保持为对角矩阵。用求积法则相对于 $p$ 所需的多项式精确度来表达您的条件，并说明为什么这些条件能保证对角化。\n\n4) 提供物理单元 $K$ 的 $M_{(0,0,0),(0,0,0)}$ 的值，以单个实数表示。无需四舍五入，也无需单位。",
            "solution": "用户提供了一个关于四面体单元上时域间断伽辽金 (DGTD) 方法的多部分问题。该问题具有科学依据、适定且客观。它是计算电磁学和偏微分方程数值方法领域的标准练习。该问题有效。\n\n**1) 参考四面体上的标准正交模式基**\n\n一种标准方法是使用折叠坐标和雅可比多项式构造一个正交基，然后将其归一化。\n\n我们从笛卡尔坐标 $(r,s,t) \\in \\widehat{T}$ 定义一组折叠坐标 $(\\xi_1, \\xi_2, \\xi_3) \\in [-1,1]^3$：\n$$\n\\xi_1 = 2\\frac{r}{1-s-t}-1, \\quad \\xi_2 = 2\\frac{s}{1-t}-1, \\quad \\xi_3 = 2t-1.\n$$\n在 $\\widehat{T}$ 上，一个总多项式次数最高为 $p$ 的正交（但尚未标准正交）模式基 $\\{\\widehat{\\phi}_{\\ell m n}\\}_{\\ell+m+n \\le p}$ 被构造为雅可比多项式 $P_k^{(\\alpha,\\beta)}$ 与这些坐标的乘积：\n$$\n\\widehat{\\phi}_{\\ell m n}(r,s,t) = P_{\\ell}^{(0,0)}(\\xi_1) (1-s-t)^{\\ell} \\cdot P_{m}^{(2\\ell+1,0)}(\\xi_2) (1-t)^{m} \\cdot P_{n}^{(2\\ell+2m+2,0)}(\\xi_3).\n$$\n引入包含 $(1-s-t)$ 和 $(1-t)$ 的因子是为了使乘积的三个分量相对于 $\\widehat{T}$ 上的标准体积测度是正交的。\n\n为了找到归一化常数，我们计算这些基函数的 $L^2$ 范数的平方，$h_{\\ell m n}^2 = \\int_{\\widehat{T}} |\\widehat{\\phi}_{\\ell m n}(r,s,t)|^2\\,\\mathrm{d}V$。这个积分可以通过使用到 $(\\xi_1, \\xi_2, \\xi_3)$ 的变量替换，进行一系列一维积分来计算。体积元变换为 $\\mathrm{d}V = \\mathrm{d}r\\,\\mathrm{d}s\\,\\mathrm{d}t = \\frac{(1-t)^2(1-s)}{8}\\,\\mathrm{d}\\xi_1\\,\\mathrm{d}\\xi_2\\,\\mathrm{d}\\xi_3$。由于基函数的结构和雅可比多项式的性质，积分可以分离。范数的平方被计算为：\n$$\nh_{\\ell m n}^2 = \\frac{1}{(2\\ell+1) \\cdot 2(m+\\ell+1) \\cdot (2n+2\\ell+2m+3)}.\n$$\n标准正交基 $\\{\\widehat{\\psi}_{\\ell m n}\\}$ 则是通过对 $\\{\\widehat{\\phi}_{\\ell m n}\\}$进行归一化得到的：\n$$\n\\widehat{\\psi}_{\\ell m n} = \\frac{1}{h_{\\ell m n}} \\widehat{\\phi}_{\\ell m n} = N_{\\ell m n} \\widehat{\\phi}_{\\ell m n}.\n$$\n因此，归一化常数 $N_{\\ell m n}$ 是 $h_{\\ell m n}$ 的倒数：\n$$\nN_{\\ell m n} = \\sqrt{(2\\ell+1) \\cdot 2(m+\\ell+1) \\cdot (2n+2\\ell+2m+3)}.\n$$\n标准正交基函数的最终表达式为：\n$$\n\\widehat{\\psi}_{\\ell m n}(r,s,t) = N_{\\ell m n} \\cdot P_{\\ell}^{(0,0)}\\left(2\\frac{r}{1-s-t}-1\\right) (1-s-t)^{\\ell} \\cdot P_{m}^{(2\\ell+1,0)}\\left(2\\frac{s}{1-t}-1\\right) (1-t)^{m} \\cdot P_{n}^{(2\\ell+2m+2,0)}(2t-1).\n$$\n该基满足所需条件 $\\int_{\\widehat{T}} \\widehat{\\psi}_{\\ell m n}\\,\\widehat{\\psi}_{\\ell' m' n'}\\,\\mathrm{d}V = \\delta_{\\ell\\ell'}\\,\\delta_{m m'}\\,\\delta_{n n'}$。\n\n**2) 物理单元的质量矩阵元**\n\n物理单元 $K$ 上的质量矩阵由 $M_{\\alpha\\beta} = \\int_{K} \\psi_{\\alpha}\\psi_{\\beta}\\,\\mathrm{d}V$ 给出，其中 $\\alpha=(\\ell,m,n)$ 且 $\\beta=(\\ell',m',n')$。$K$ 上的基函数通过拉回参考基来定义，即 $\\psi_{\\alpha}(x,y,z) = \\widehat{\\psi}_{\\alpha}(\\Phi^{-1}(x,y,z))$。\n\n仿射映射为 $\\Phi: (r,s,t) \\mapsto (x,y,z) = (2r, 3s, 4t)$。该变换的雅可比矩阵是常数：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial r} & \\frac{\\partial x}{\\partial s} & \\frac{\\partial x}{\\partial t} \\\\ \\frac{\\partial y}{\\partial r} & \\frac{\\partial y}{\\partial s} & \\frac{\\partial y}{\\partial t} \\\\ \\frac{\\partial z}{\\partial r} & \\frac{\\partial z}{\\partial s} & \\frac{\\partial z}{\\partial t} \\end{pmatrix} = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix}.\n$$\n雅可比行列式为 $|J| = 2 \\cdot 3 \\cdot 4 = 24$。\n使用积分的变量替换公式，质量矩阵元为：\n$$\nM_{\\alpha\\beta} = \\int_{K} \\psi_{\\alpha}(\\mathbf{x})\\psi_{\\beta}(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x} = \\int_{\\widehat{T}} \\widehat{\\psi}_{\\alpha}(\\mathbf{r})\\widehat{\\psi}_{\\beta}(\\mathbf{r})\\,|J|\\,\\mathrm{d}\\mathbf{r} = |J| \\int_{\\widehat{T}} \\widehat{\\psi}_{\\alpha}(\\mathbf{r})\\widehat{\\psi}_{\\beta}(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r}.\n$$\n由于基 $\\{\\widehat{\\psi}_{\\alpha}\\}$ 在 $\\widehat{T}$ 上的标准正交性，该积分就是克罗内克 δ 函数 $\\delta_{\\alpha\\beta}$：\n$$\nM_{\\alpha\\beta} = |J|\\,\\delta_{\\alpha\\beta} = 24\\,\\delta_{\\ell\\ell'}\\,\\delta_{mm'}\\,\\delta_{nn'}.\n$$\n这表明对于仿射映射，质量矩阵是对角的，每个对角元都等于常数雅可比行列式 $|J|$。\n\n我们现在可以计算所要求的矩阵元：\n- 对于 $\\alpha = \\beta = (0,0,0)$:\n$$M_{(0,0,0),(0,0,0)} = 24\\,\\delta_{00}\\,\\delta_{00}\\,\\delta_{00} = 24 \\cdot 1 \\cdot 1 \\cdot 1 = 24.$$\n- 对于 $\\alpha = (1,0,0)$ 和 $\\beta = (0,0,0)$:\n$$M_{(1,0,0),(0,0,0)} = 24\\,\\delta_{10}\\,\\delta_{00}\\,\\delta_{00} = 24 \\cdot 0 \\cdot 1 \\cdot 1 = 0.$$\n\n**3) 基于求积的质量矩阵保持对角的条件**\n\n离散质量矩阵 $M^h$ 是使用物理单元 $K$ 上的数值求积法则组装的。其矩阵元为 $M^h_{\\alpha\\beta} = \\sum_{q=1}^{N_q} w_q \\psi_{\\alpha}(x_q)\\psi_{\\beta}(x_q)$，其中 $(x_q, w_q)$ 是 $K$ 上的求积点和权重。\n\n为了分析这个问题，我们将求积变换到参考单元 $\\widehat{T}$ 上。设 $(\\widehat{x}_q, \\widehat{w}_q)$ 为 $\\widehat{T}$ 上的求积法则。对于仿射映射 $\\Phi$，$K$ 上对应的法则是 $x_q = \\Phi(\\widehat{x}_q)$ 和 $w_q = |J|\\widehat{w}_q$。离散质量矩阵元变为：\n$$\nM^h_{\\alpha\\beta} = \\sum_{q=1}^{N_q} (|J|\\widehat{w}_q) \\widehat{\\psi}_{\\alpha}(\\widehat{x}_q)\\widehat{\\psi}_{\\beta}(\\widehat{x}_q) = |J| \\sum_{q=1}^{N_q} \\widehat{w}_q \\widehat{\\psi}_{\\alpha}(\\widehat{x}_q)\\widehat{\\psi}_{\\beta}(\\widehat{x}_q).\n$$\n为使该矩阵为对角矩阵，我们需要 $M^h_{\\alpha\\beta} = C \\delta_{\\alpha\\beta}$，其中 $C$ 为某个常数。与精确质量矩阵 $M_{\\alpha\\beta} = |J|\\delta_{\\alpha\\beta}$ 比较，我们可知必须满足：\n$$\n\\sum_{q=1}^{N_q} \\widehat{w}_q \\widehat{\\psi}_{\\alpha}(\\widehat{x}_q)\\widehat{\\psi}_{\\beta}(\\widehat{x}_q) = \\int_{\\widehat{T}} \\widehat{\\psi}_{\\alpha}(\\mathbf{r})\\widehat{\\psi}_{\\beta}(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r} = \\delta_{\\alpha\\beta}.\n$$\n这意味着参考单元上的求积法则必须能精确积分任意两个最高次数为 $p$ 的基函数 $\\widehat{\\psi}_{\\alpha}$ 和 $\\widehat{\\psi}_{\\beta}$ 的乘积。\n\n基函数 $\\widehat{\\psi}_{\\alpha} = \\widehat{\\psi}_{\\ell m n}$ 是一个总次数为 $\\ell+m+n$ 的多项式。由于 $\\ell+m+n \\le p$，$\\widehat{\\psi}_{\\alpha}$ 的次数最多为 $p$。因此，乘积 $\\widehat{\\psi}_{\\alpha}\\widehat{\\psi}_{\\beta}$ 是一个次数最多为 $p+p=2p$ 的多项式。\n\n因此，求积法则能保持质量矩阵对角性的条件是，参考四面体上的求积法则必须对所有总次数最高为 $2p$ 的多项式都精确。对于仿射映射，常数雅可比行列式不会增加所需的多项式次数。\n\n**4) $M_{(0,0,0),(0,0,0)}$ 的值**\n\n根据第 2 部分的计算，该质量矩阵元的值为：\n$$\nM_{(0,0,0),(0,0,0)} = 24.\n$$\n这也可以直接验证。基函数 $\\widehat{\\psi}_{000}$ 是一个常数。根据第 1 部分，$N_{000} = \\sqrt{1 \\cdot 2 \\cdot 3} = \\sqrt{6}$。由于 $P_0^{(...)} = 1$，$\\widehat{\\phi}_{000}=1$，所以 $\\widehat{\\psi}_{000} = \\sqrt{6}$。因此，在 $K$ 上 $\\psi_{000}(x,y,z) = \\sqrt{6}$。该矩阵元为：\n$$M_{(0,0,0),(0,0,0)} = \\int_K (\\sqrt{6})^2\\,\\mathrm{d}V = 6 \\int_K \\mathrm{d}V = 6 \\cdot \\text{Volume}(K).$$\n顶点为 $(0,0,0)$、$(2,0,0)$、$(0,3,0)$、$(0,0,4)$ 的四面体 $K$ 的体积是\n$$\\text{Volume}(K) = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} \\right| = \\frac{24}{6} = 4.$$\n因此，$M_{(0,0,0),(0,0,0)} = 6 \\cdot 4 = 24$。",
            "answer": "$$\\boxed{24}$$"
        },
        {
            "introduction": "为了精确模拟真实世界中带有曲面边界的电磁问题，我们通常使用能够灵活变形的弯曲单元。等参映射是一种强大的技术，它将简单的参考单元（如立方体）变换为物理空间中的弯曲单元，但这需要在计算中引入几何变换因子。本练习将带你深入了解这一过程，通过为一个具体的弯曲六面体单元计算雅可比矩阵、度量张量等关键几何因子，来组装质量矩阵和刚度矩阵 。掌握这些变换对于将 DGTD 方法应用于实际工程设计至关重要。",
            "id": "3300567",
            "problem": "考虑以旋度形式写成的三维无源麦克斯韦方程组作为基本定律，以及标准的间断伽辽金 (DG) 时域 (TD) 半离散格式，该格式产生单元体积质量和旋度-旋度刚度双线性形式。设计算单元为一单个曲边六面体，它是通过从参考立方体 $[\\xi,\\eta,\\zeta] \\in [-1,1]^3$ 到物理坐标 $[x,y,z] \\in \\mathbb{R}^3$ 的等参映射得到的，定义如下\n$$\nx(\\xi,\\eta,\\zeta) = a\\,\\xi + \\alpha\\,\\xi\\,\\eta,\\quad\ny(\\xi,\\eta,\\zeta) = b\\,\\eta,\\quad\nz(\\xi,\\eta,\\zeta) = c\\,\\zeta,\n$$\n其中 $a>0$、$b>0$、$c>0$ 以及 $0 < \\alpha < a$。令试验函数和测试函数为常数笛卡尔向量 $\\mathbf{u}=\\mathbf{v}=\\mathbf{e}_x = [1,0,0]$。\n\n您的任务如下：\n1. 计算映射的雅可比矩阵 $F$ 及其行列式 $|J|$。\n2. 计算与向量 $\\mathbf{u}=\\mathbf{e}_x$ 相关的质量矩阵元 $M_{xx} = \\int_K \\mathbf{u}\\cdot\\mathbf{u}\\,\\mathrm{d}V$。\n3. 计算与向量 $\\mathbf{u}=\\mathbf{e}_x$ 相关的旋度-旋度刚度矩阵元 $K_{xx} = \\int_K (\\nabla\\times\\mathbf{u})\\cdot(\\nabla\\times\\mathbf{u})\\,\\mathrm{d}V$。\n4. 提供刚度矩阵元 $K_{xx}$ 的最终值，以单个实数表示，无需四舍五入或单位。",
            "solution": "该问题在科学上是合理的、适定的和客观的。问题陈述清晰地定义了等参映射、在间断伽辽金时域 (DGTD) 方法背景下的质量和刚度矩阵的标准双线性形式，以及特定的试验函数和测试函数。控制方程为麦克斯韦方程组，所用方法涉及计算电磁学中标准的变量替换。对参数的约束 ($a>0$, $b>0$, $c>0$, $0 < \\alpha < a$) 确保了映射是非奇异的。\n\n**1. 雅可比矩阵和行列式**\n\n雅可比矩阵 $F$ 定义为 $F_{ij} = \\frac{\\partial x_i}{\\partial \\xi_j}$，其中 $\\mathbf{x}=(x,y,z)$ 和 $\\boldsymbol{\\xi}=(\\xi,\\eta,\\zeta)$。\n$$\nx = a\\xi + \\alpha\\xi\\eta, \\quad y = b\\eta, \\quad z = c\\zeta\n$$\n偏导数是：\n$\\frac{\\partial x}{\\partial \\xi} = a + \\alpha\\eta$, $\\frac{\\partial x}{\\partial \\eta} = \\alpha\\xi$, $\\frac{\\partial x}{\\partial \\zeta} = 0$\n$\\frac{\\partial y}{\\partial \\xi} = 0$, $\\frac{\\partial y}{\\partial \\eta} = b$, $\\frac{\\partial y}{\\partial \\zeta} = 0$\n$\\frac{\\partial z}{\\partial \\xi} = 0$, $\\frac{\\partial z}{\\partial \\eta} = 0$, $\\frac{\\partial z}{\\partial \\zeta} = c$\n\n因此，雅可比矩阵为：\n$$\nF = \\begin{pmatrix} a+\\alpha\\eta & \\alpha\\xi & 0 \\\\ 0 & b & 0 \\\\ 0 & 0 & c \\end{pmatrix}\n$$\n其行列式 $|J|$ 是对角线元素的乘积，因为 $F$ 是上三角矩阵：\n$$\n|J| = \\det(F) = (a+\\alpha\\eta) \\cdot b \\cdot c = bc(a+\\alpha\\eta)\n$$\n由于 $a>\\alpha\\ge 0$ 且 $\\eta \\in [-1,1]$，$a+\\alpha\\eta > 0$，所以 $|J|>0$，映射是有效的。\n\n**2. 质量矩阵元 $M_{xx}$**\n\n质量矩阵元由 $M_{xx} = \\int_K \\mathbf{u}\\cdot\\mathbf{u}\\,\\mathrm{d}V$ 定义。给定的试验函数和测试函数为常数笛卡尔向量 $\\mathbf{u} = \\mathbf{e}_x = [1,0,0]$。\n它们的点积是 $\\mathbf{u} \\cdot \\mathbf{u} = \\mathbf{e}_x \\cdot \\mathbf{e}_x = 1$。\n因此，质量矩阵元就是物理单元 $K$ 的体积：\n$$\nM_{xx} = \\int_K 1 \\cdot \\mathrm{d}V = \\text{Volume}(K)\n$$\n为了计算体积，我们对雅可比行列式在参考单元 $[-1,1]^3$ 上进行积分：\n$$\n\\text{Volume}(K) = \\int_{K} \\mathrm{d}V = \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 |J| \\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta\n$$\n代入 $|J|$ 的表达式：\n$$\n\\text{Volume}(K) = \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 bc(a+\\alpha\\eta) \\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta\n$$\n我们可以分离积分：\n$$\n\\text{Volume}(K) = bc \\left( \\int_{-1}^1 \\mathrm{d}\\xi \\right) \\left( \\int_{-1}^1 \\mathrm{d}\\zeta \\right) \\left( \\int_{-1}^1 (a+\\alpha\\eta) \\, \\mathrm{d}\\eta \\right)\n$$\n计算每个一维积分：\n$$\n\\int_{-1}^1 \\mathrm{d}\\xi = 2\n$$\n$$\n\\int_{-1}^1 \\mathrm{d}\\zeta = 2\n$$\n$$\n\\int_{-1}^1 (a+\\alpha\\eta) \\, \\mathrm{d}\\eta = \\left[ a\\eta + \\frac{\\alpha\\eta^2}{2} \\right]_{-1}^1 = \\left(a + \\frac{\\alpha}{2}\\right) - \\left(-a + \\frac{\\alpha}{2}\\right) = 2a\n$$\n将它们相乘得到体积：\n$$\n\\text{Volume}(K) = bc \\cdot 2 \\cdot 2 \\cdot (2a) = 8abc\n$$\n因此，质量矩阵元为 $M_{xx} = 8abc$。\n\n**3. 刚度矩阵元 $K_{xx}$**\n\n刚度矩阵元由 $K_{xx} = \\int_K (\\nabla\\times\\mathbf{u})\\cdot(\\nabla\\times\\mathbf{u})\\,\\mathrm{d}V$ 定义。\n试验函数和测试函数是常数向量场 $\\mathbf{u} = \\mathbf{e}_x = [1,0,0]$。\n一个常数向量场的旋度在定义上为零。我们可以明确地计算它：\n$$\n\\nabla \\times \\mathbf{u} = \\nabla \\times \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial}{\\partial y}(0) - \\frac{\\partial}{\\partial z}(0) \\\\ \\frac{\\partial}{\\partial z}(1) - \\frac{\\partial}{\\partial x}(0) \\\\ \\frac{\\partial}{\\partial x}(0) - \\frac{\\partial}{\\partial y}(1) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\mathbf{0}\n$$\n由于旋度为零向量，其与自身的点积也为零：\n$$\n(\\nabla\\times\\mathbf{u})\\cdot(\\nabla\\times\\mathbf{u}) = \\mathbf{0} \\cdot \\mathbf{0} = 0\n$$\n因此，刚度矩阵元的被积函数恒为零，导致积分结果为零：\n$$\nK_{xx} = \\int_K 0 \\, \\mathrm{d}V = 0\n$$\n\n**4. $K_{xx}$ 的最终值**\n\n根据上述推导，刚度矩阵元的值为0。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "麦克斯韦方程组不仅包含旋度方程，还包括描述电荷和磁场散度特性的高斯定律。然而，标准的间断伽辽金方法在离散旋度方程时，通常无法自动保证离散散度约束（如 $\\nabla \\cdot \\mathbf{D} = \\rho$）的严格满足，这可能导致非物理的数值结果累积。本练习旨在探讨这一核心问题，并引导你设计一种广义拉格朗日乘子（GLM）格式来主动控制和消除散度误差 。这项实践将让你从单元级的构建提升到系统级的物理保真性设计，是通往开发稳健可靠的电磁仿真工具的关键一步。",
            "id": "3300578",
            "problem": "考虑在介电常数为 $\\varepsilon$、磁导率为 $\\mu$ 的均匀介质中的线性、各向同性、有源麦克斯韦方程组，\n$$\n\\partial_{t}\\mathbf{D}=\\nabla\\times\\mathbf{H}-\\mathbf{J},\\quad\n\\partial_{t}\\mathbf{B}=-\\nabla\\times\\mathbf{E},\\quad\n\\nabla\\cdot\\mathbf{D}=\\rho,\\quad\n\\nabla\\cdot\\mathbf{B}=0,\n$$\n其中本构关系为 $\\mathbf{D}=\\varepsilon \\mathbf{E}$ 和 $\\mathbf{B}=\\mu \\mathbf{H}$，电荷守恒方程为\n$$\n\\partial_{t}\\rho+\\nabla\\cdot\\mathbf{J}=0.\n$$\n一种仅使用标准数值通量来近似旋度方程的时域不连续伽辽金(DGTD)半离散化方法，通常无法在离散层面强制满足散度约束。\n\n(a) 从上述方程和不连续伽辽金方法的结构出发，解释为什么仅对旋度方程进行离散化可能无法在离散意义上强制满足 $\\nabla\\cdot\\mathbf{D}=\\rho$。你的解释应涉及离散微分算子在间断多项式空间上缺乏精确交换性，以及与由数值通量和时间积分引起的离散守恒方程可能存在的不一致性。\n\n(b) 为了以一种与时域不连续伽辽金(DGTD)离散化兼容的方式恢复对散度误差的控制，使用一个针对电场的广义拉格朗日乘子(GLM)标量场 $\\psi$ 来增广麦克斯韦系统。通过在安培定律中添加一个梯度项，并为 $\\psi$ 引入一个与 $\\nabla\\cdot\\mathbf{D}$ 耦合且阻尼 $\\psi$ 的演化方程，来提出一个双曲-抛物线型GLM公式。当约束被满足时，该增广的连续系统应是线性的，并在稳态下与原始麦克斯韦方程组一致。请明确写出你提出的增广方程。\n\n(c) 令 $q=\\nabla\\cdot\\mathbf{D}-\\rho$ 表示电散度误差。仅使用(a)和(b)部分中的基本方程以及电荷守恒方程，推导一个控制 $q$ 的封闭偏微分方程，并刻画 $q$ 的传播和阻尼特性。然后，考虑一个空间周期性域和一个波数大小为 $k$ 的单个傅里叶模式，即假设 $q(\\mathbf{x},t)=\\widehat{q}\\exp(\\mathrm{i}\\mathbf{k}\\cdot\\mathbf{x}+s t)$ 和 $\\psi(\\mathbf{x},t)=\\widehat{\\psi}\\exp(\\mathrm{i}\\mathbf{k}\\cdot\\mathbf{x}+s t)$，其中 $|\\mathbf{k}|=k$。推导散度清理模式的色散关系，并以GLM波速参数 $\\alpha>0$、阻尼参数 $\\kappa\\ge 0$ 和波数大小 $k\\ge 0$ 的形式，给出两个时间特征值 $s_{\\pm}(k)$ 的闭合形式解。\n\n假设 $k$ 的单位为 $\\mathrm{rad}\\,\\mathrm{m}^{-1}$，$\\alpha$ 的单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$\\kappa$ 的单位为 $\\mathrm{s}^{-1}$，请将你的最终特征值表达式以 $\\mathrm{s}^{-1}$ 为单位表示。不需要进行数值计算，也不需要四舍五入。你的最终答案必须仅为这对时间特征值，作为一个单一的解析表达式。",
            "solution": "该问题提出了一个关于使用时域不连续伽辽金(DGTD)方法对麦克斯韦方程组进行数值求解的多部分问题，重点关注散度误差控制问题。该问题是有效的，因为它在经典电磁学和计算物理学方面有科学依据，是适定的、客观的，并包含一个完整且一致的设定。我们开始进行解答。\n\n(a) 离散散度误差的解释\n\n在连续情况下，如果散度约束在初始时被满足，麦克斯韦方程组会内在地保持这些约束。对安培定律 $\\partial_{t}\\mathbf{D}=\\nabla\\times\\mathbf{H}-\\mathbf{J}$ 取散度，得到：\n$$\n\\nabla\\cdot(\\partial_{t}\\mathbf{D}) = \\nabla\\cdot(\\nabla\\times\\mathbf{H}) - \\nabla\\cdot\\mathbf{J}\n$$\n对于任意矢量场 $\\mathbf{F}$，使用矢量微积分恒等式 $\\nabla\\cdot(\\nabla\\times\\mathbf{F})=0$，并交换左边的时间和空间导数，我们得到：\n$$\n\\partial_{t}(\\nabla\\cdot\\mathbf{D}) = -\\nabla\\cdot\\mathbf{J}\n$$\n电荷守恒方程为 $\\partial_{t}\\rho+\\nabla\\cdot\\mathbf{J}=0$，这意味着 $-\\nabla\\cdot\\mathbf{J} = \\partial_{t}\\rho$。将此代入前一个方程得到：\n$$\n\\partial_{t}(\\nabla\\cdot\\mathbf{D}) = \\partial_{t}\\rho \\quad \\implies \\quad \\partial_{t}(\\nabla\\cdot\\mathbf{D}-\\rho) = 0\n$$\n这个结果表明，量 $(\\nabla\\cdot\\mathbf{D}-\\rho)$（它代表了电场高斯定律的误差）不随时间变化。因此，如果高斯定律 ($\\nabla\\cdot\\mathbf{D}=\\rho$) 在初始时刻 $t=0$ 被满足，那么它在所有后续时间 $t>0$ 都将保持满足。\n\n在DGTD框架中，计算域被分解为单元网格，解在每个单元内由分片多项式近似，这些多项式在单元面之间是不连续的。微分算子 $\\nabla\\cdot$ 和 $\\nabla\\times$ 被它们的离散对应物（我们称之为 $\\mathcal{D}_h$ 和 $\\mathcal{C}_h$）所取代，这些算子作用于这个间断多项式空间上。这些离散算子通常通过弱形式定义，涉及单元上的体积分和面上的面积分，其中数值通量强制实现单元间的耦合。\n\n只关注旋度方程的安培定律的DGTD半离散化形式为：\n$$\n\\partial_{t}\\mathbf{D}_h = \\mathcal{C}_h\\mathbf{H}_h - \\mathbf{J}_h\n$$\n其中 $\\mathbf{D}_h$、$\\mathbf{H}_h$ 和 $\\mathbf{J}_h$ 是相应场的离散近似。将离散散度算子 $\\mathcal{D}_h$ 应用于此方程，得到：\n$$\n\\partial_{t}(\\mathcal{D}_h\\mathbf{D}_h) = \\mathcal{D}_h(\\mathcal{C}_h\\mathbf{H}_h) - \\mathcal{D}_h\\mathbf{J}_h\n$$\n根本问题在于，对于标准的DGTD方法，离散算子不保持连续矢量恒等式的结构。具体来说，离散散度和旋度算子的复合不恒为零：\n$$\n\\mathcal{D}_h\\mathcal{C}_h \\neq 0\n$$\n这种缺乏精确交换性的问题是包括使用标准通量的DGTD在内的许多在交错或非交错网格上的数值格式的一个众所周知的性质。因此，即使离散电荷守恒方程 $\\partial_{t}\\rho_h + \\mathcal{D}_h\\mathbf{J}_h = 0$ 被精确满足，离散散度误差 $q_h = \\mathcal{D}_h\\mathbf{D}_h-\\rho_h$ 的演化变为：\n$$\n\\partial_{t}q_h = \\partial_{t}(\\mathcal{D}_h\\mathbf{D}_h) - \\partial_{t}\\rho_h = (\\mathcal{D}_h\\mathcal{C}_h\\mathbf{H}_h - \\mathcal{D}_h\\mathbf{J}_h) - (- \\mathcal{D}_h\\mathbf{J}_h) = \\mathcal{D}_h\\mathcal{C}_h\\mathbf{H}_h\n$$\n由于 $\\mathcal{D}_h\\mathcal{C}_h\\mathbf{H}_h$ 通常非零，该项充当了散度误差的源项。即使离散高斯定律 $q_h=0$ 在 $t=0$ 时满足，数值误差和演化的场 $\\mathbf{H}_h$ 也会导致 $q_h$ 随时间增长，从而在离散层面违反散度约束。\n\n(b) 提出的增广GLM系统\n\n为了恢复对散度误差的控制，我们引入广义拉格朗日乘子(GLM)公式。这涉及用一个额外的标量场 $\\psi$ 来增广麦克斯韦方程组，并修改方程以创建一个能主动阻尼散度误差的机制。一个合适的双曲-抛物线型GLM公式提议如下。\n\n我们通过添加一个涉及 $\\psi$ 的梯度项来修改安培定律：\n$$\n\\partial_{t}\\mathbf{D}=\\nabla\\times\\mathbf{H}-\\mathbf{J} - \\nabla\\psi\n$$\n另一个旋度方程，即法拉第定律，保持不变：\n$$\n\\partial_{t}\\mathbf{B}=-\\nabla\\times\\mathbf{E}\n$$\n我们为标量场 $\\psi$ 引入一个新的演化方程。该方程将 $\\psi$ 与电散度误差 $(\\nabla\\cdot\\mathbf{D}-\\rho)$ 耦合，包含一个与 $\\psi$ 成正比的阻尼项，以及一个控制散度清理波传播速度的参数 $\\alpha$：\n$$\n\\frac{\\partial\\psi}{\\partial t} + \\alpha^2(\\nabla\\cdot\\mathbf{D}-\\rho) + \\kappa\\psi = 0\n$$\n这里，$\\alpha$ 是GLM波速参数，单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$，$\\kappa$ 是阻尼参数，单位为 $\\mathrm{s}^{-1}$。\n\n这个增广系统是线性的。它与原始麦克斯韦方程组是一致的，即如果约束 $\\nabla\\cdot\\mathbf{D}=\\rho$ 得到满足，并且我们处于所有时间导数都为零的稳态，那么GLM方程要求 $\\kappa\\psi=0$。对于 $\\kappa>0$，这意味着 $\\psi=0$，这又意味着 $\\nabla\\psi=0$。增广的安培定律随后简化为原始的稳态方程 $0=\\nabla\\times\\mathbf{H}-\\mathbf{J}$。\n\n(c) 散度误差偏微分方程与色散关系\n\n令 $q=\\nabla\\cdot\\mathbf{D}-\\rho$ 为电散度误差。我们将推导一个关于 $q$ 的封闭偏微分方程。首先，对(b)部分中的增广安培定律取散度：\n$$\n\\partial_{t}(\\nabla\\cdot\\mathbf{D}) = \\nabla\\cdot(\\nabla\\times\\mathbf{H}) - \\nabla\\cdot\\mathbf{J} - \\nabla\\cdot(\\nabla\\psi) = -\\nabla\\cdot\\mathbf{J} - \\nabla^2\\psi\n$$\n使用电荷守恒方程 $\\nabla\\cdot\\mathbf{J} = -\\partial_t\\rho$，我们得到：\n$$\n\\partial_{t}(\\nabla\\cdot\\mathbf{D}) = \\partial_{t}\\rho - \\nabla^2\\psi\n$$\n这给出了误差 $q$ 演化的第一个方程：\n$$\n\\partial_{t}q = \\partial_{t}(\\nabla\\cdot\\mathbf{D}-\\rho) = -\\nabla^2\\psi\n$$\n第二个方程是用 $q$ 表示的GLM演化方程：\n$$\n\\frac{\\partial\\psi}{\\partial t} + \\alpha^2 q + \\kappa\\psi = 0\n$$\n为了得到一个关于 $q$ 的单一封闭偏微分方程，我们消去 $\\psi$。对第一个推导的方程对时间求导，得到 $\\partial_t^2 q = -\\nabla^2(\\partial_t \\psi)$。\n从第二个方程，我们有 $\\partial_t\\psi = -\\alpha^2 q - \\kappa\\psi$。\n代入可得 $\\partial_t^2 q = -\\nabla^2(-\\alpha^2 q - \\kappa\\psi) = \\alpha^2 \\nabla^2 q + \\kappa \\nabla^2 \\psi$。\n最后，用第一个推导的方程中的关系 $\\nabla^2\\psi = -\\partial_t q$ 来替换最后一项：\n$$\n\\partial_t^2 q = \\alpha^2 \\nabla^2 q - \\kappa \\partial_t q\n$$\n重新整理各项，得到关于 $q$ 的封闭偏微分方程：\n$$\n\\frac{\\partial^2 q}{\\partial t^2} + \\kappa \\frac{\\partial q}{\\partial t} - \\alpha^2 \\nabla^2 q = 0\n$$\n这是一个阻尼波方程。它表明散度误差 $q$ 以速度 $\\alpha$ 传播，并以与 $\\kappa$ 相关的速率衰减。因此，任何初始的散度误差都会被主动传播开并被阻尼掉，而不是持续存在或增长。\n\n为了求出色散关系，我们假设一个形式为 $q(\\mathbf{x},t)=\\widehat{q}\\exp(\\mathrm{i}\\mathbf{k}\\cdot\\mathbf{x}+s t)$ 的单个傅里叶模式解，其中 $|\\mathbf{k}|=k$ 是波数大小， $s$ 是时间特征值。我们将这个拟设代入关于 $q$ 的偏微分方程。导数变为：\n- $\\frac{\\partial q}{\\partial t} = s q$\n- $\\frac{\\partial^2 q}{\\partial t^2} = s^2 q$\n- $\\nabla^2 q = -k^2 q$\n\n将这些代入偏微分方程得到：\n$$\ns^2 q + \\kappa(s q) - \\alpha^2(-k^2 q) = 0\n$$\n除以 $q$（假设存在非平凡解），我们得到色散关系：\n$$\ns^2 + \\kappa s + \\alpha^2 k^2 = 0\n$$\n这是一个关于 $s$ 的二次方程。我们使用二次方程求根公式来求解两个时间特征值 $s_{\\pm}(k)$：\n$$\ns_{\\pm}(k) = \\frac{-\\kappa \\pm \\sqrt{\\kappa^2 - 4(1)(\\alpha^2 k^2)}}{2}\n$$\n两个时间特征值的最终表达式是：\n$$\ns_{\\pm}(k) = \\frac{-\\kappa \\pm \\sqrt{\\kappa^2 - 4\\alpha^2 k^2}}{2}\n$$\n这些特征值刻画了波数为 $k$ 的散度误差模式的时间行为（阻尼和/或振荡）。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{-\\kappa + \\sqrt{\\kappa^{2} - 4\\alpha^{2}k^{2}}}{2}, & \\frac{-\\kappa - \\sqrt{\\kappa^{2} - 4\\alpha^{2}k^{2}}}{2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}