{
    "hands_on_practices": [
        {
            "introduction": "要构建有效的吸收边界条件，我们首先需要理解理想情况下的物理原理。理想的吸收边界应该完全“欺骗”出射波，使其感觉不到任何中断，仿佛它正在进入一个无限延伸的媒质。这个练习探讨了著名的 Silver-Müller 条件，它将完美吸收问题转化为一个阻抗匹配问题。通过推导正入射平面波在具有特定边界阻抗 $\\eta_{b}$ 的平面上的反射系数，您将亲手验证完美吸收（即零反射）的条件是边界阻抗与媒质的本征阻抗 $\\eta$ 完全匹配。",
            "id": "3324491",
            "problem": "考虑在均匀、各向同性、非色散介质中的时域麦克斯韦方程组，介质的介电常数为 $\\varepsilon$，磁导率为 $\\mu$，\n$$\n\\nabla \\times \\mathbf{E}(\\mathbf{r},t) = - \\mu \\, \\frac{\\partial \\mathbf{H}(\\mathbf{r},t)}{\\partial t}, \\qquad\n\\nabla \\times \\mathbf{H}(\\mathbf{r},t) = \\varepsilon \\, \\frac{\\partial \\mathbf{E}(\\mathbf{r},t)}{\\partial t},\n$$\n其中 $\\mathbf{E}$ 和 $\\mathbf{H}$ 分别是电场和磁场。该介质的本征阻抗为 $\\eta = \\sqrt{\\mu/\\varepsilon}$，波速为 $c = 1/\\sqrt{\\mu \\varepsilon}$。一个计算域被一个位于 $z = 0$ 的平面边界截断，其外向单位法向量为 $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$。在此边界上，应用了基于 Silver–Müller 的局部吸收边界条件 (ABC)，在时域中写作\n$$\n\\mathbf{E}_{t}(\\mathbf{r},t) = - \\eta_{b} \\, \\hat{\\mathbf{n}} \\times \\mathbf{H}_{t}(\\mathbf{r},t) \\quad \\text{for} \\quad z=0,\n$$\n其中 $\\eta_{b}>0$ 是一个给定的边界阻抗参数，下标 ${t}$ 表示场相对于边界的切向分量。\n\n一个角频率为 $\\omega$ 的线偏振平面波从计算域内部垂直入射到该边界上，沿 $+\\hat{\\mathbf{z}}$ 方向传播。其电场为\n$$\n\\mathbf{E}_{\\text{i}}(\\mathbf{r},t) = \\Re\\!\\left\\{\\mathbf{E}_{0} \\exp\\!\\big(-\\mathrm{i}\\omega t + \\mathrm{i} k z\\big)\\right\\}, \\quad \\mathbf{E}_{0} = E_{0}\\,\\hat{\\mathbf{x}}, \\quad k = \\frac{\\omega}{c},\n$$\n相应的磁场满足平面波关系 $\\mathbf{H}_{\\text{i}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}} \\times \\mathbf{E}_{\\text{i}}$，其中 $\\hat{\\mathbf{k}} = \\hat{\\mathbf{z}}$ 是单位传播方向。\n\n假设边界产生了一个镜面反射平面波，令 $\\Gamma$ 表示复反射系数（在 $z=0$ 处，反射电场相量振幅与入射电场相量振幅之比）。仅使用上述控制方程和边界条件，推导出一个关于 $\\eta$ 和 $\\eta_{b}$ 的 $\\Gamma$ 的闭式表达式。将最终的反射系数表示为一个无量纲的复振幅。不需要进行数值取整，最终答案中不应包含任何物理单位。",
            "solution": "该问题提法合理且科学上成立，基于电磁学的基本原理和计算电磁学的标准实践。我们可以开始求解。\n\n问题要求计算在由 Silver–Müller 型吸收边界条件 (ABC) 定义的边界上，垂直入射平面波的复反射系数 $\\Gamma$。此分析最好在频域中使用复相量进行。\n\n首先，我们将入射波和反射波表示为相量形式。时域场与其相量对应项 $\\tilde{\\mathbf{E}}(\\mathbf{r})$ 和 $\\tilde{\\mathbf{H}}(\\mathbf{r})$ 的关系为 $\\mathbf{E}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{E}}(\\mathbf{r}) \\exp(-\\mathrm{i}\\omega t)\\}$ 和 $\\mathbf{H}(\\mathbf{r}, t) = \\Re\\{\\tilde{\\mathbf{H}}(\\mathbf{r}) \\exp(-\\mathrm{i}\\omega t)\\}$，其中 $\\mathrm{i}$ 是虚数单位。\n\n沿 $+\\hat{\\mathbf{z}}$ 方向传播的入射电场相量由下式给出\n$$\n\\tilde{\\mathbf{E}}_{\\text{i}}(\\mathbf{r}) = \\mathbf{E}_{0} \\exp(\\mathrm{i} k z) = E_{0} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{x}}\n$$\n其中 $k = \\omega/c$ 是波数。相应的入射磁场相量可使用平面波关系 $\\tilde{\\mathbf{H}}_{\\text{i}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}} \\times \\tilde{\\mathbf{E}}_{\\text{i}}$ 求得，其中 $\\hat{\\mathbf{k}} = \\hat{\\mathbf{z}}$ 是传播方向，$\\eta = \\sqrt{\\mu/\\varepsilon}$ 是介质的本征阻抗。\n$$\n\\tilde{\\mathbf{H}}_{\\text{i}}(\\mathbf{r}) = \\frac{1}{\\eta} \\hat{\\mathbf{z}} \\times \\big( E_{0} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{x}} \\big) = \\frac{E_{0}}{\\eta} \\exp(\\mathrm{i} k z) (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = \\frac{E_{0}}{\\eta} \\exp(\\mathrm{i} k z) \\hat{\\mathbf{y}}\n$$\n\n接下来，我们定义反射波，假设它是一个镜面反射平面波。对于在 $z=0$ 的平面边界上的垂直入射，反射波沿 $-\\hat{\\mathbf{z}}$ 方向传播。反射系数 $\\Gamma$ 是在边界 $z=0$ 处反射电场相量振幅与入射电场相量振幅之比。因此，反射电场相量为\n$$\n\\tilde{\\mathbf{E}}_{\\text{r}}(\\mathbf{r}) = \\Gamma E_{0} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{x}}\n$$\n我们假设反射电场的偏振与入射电场相同，这对于这种各向同性边界条件是符合预期的。相应的反射磁场相量可使用沿 $\\hat{\\mathbf{k}}_\\text{r} = -\\hat{\\mathbf{z}}$ 方向传播的波的平面波关系求得：$\\tilde{\\mathbf{H}}_{\\text{r}} = \\frac{1}{\\eta} \\hat{\\mathbf{k}}_\\text{r} \\times \\tilde{\\mathbf{E}}_{\\text{r}}$。\n$$\n\\tilde{\\mathbf{H}}_{\\text{r}}(\\mathbf{r}) = \\frac{1}{\\eta} (-\\hat{\\mathbf{z}}) \\times \\big( \\Gamma E_{0} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{x}} \\big) = -\\frac{\\Gamma E_{0}}{\\eta} \\exp(-\\mathrm{i} k z) (\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{x}}) = -\\frac{\\Gamma E_{0}}{\\eta} \\exp(-\\mathrm{i} k z) \\hat{\\mathbf{y}}\n$$\n\n总电场和磁场是入射场和反射场的叠加：\n$$\n\\tilde{\\mathbf{E}}(\\mathbf{r}) = \\tilde{\\mathbf{E}}_{\\text{i}}(\\mathbf{r}) + \\tilde{\\mathbf{E}}_{\\text{r}}(\\mathbf{r}) = E_{0} \\big( \\exp(\\mathrm{i} k z) + \\Gamma \\exp(-\\mathrm{i} k z) \\big) \\hat{\\mathbf{x}}\n$$\n$$\n\\tilde{\\mathbf{H}}(\\mathbf{r}) = \\tilde{\\mathbf{H}}_{\\text{i}}(\\mathbf{r}) + \\tilde{\\mathbf{H}}_{\\text{r}}(\\mathbf{r}) = \\frac{E_{0}}{\\eta} \\big( \\exp(\\mathrm{i} k z) - \\Gamma \\exp(-\\mathrm{i} k z) \\big) \\hat{\\mathbf{y}}\n$$\n\n现在，我们在平面 $z=0$ 处应用吸收边界条件。该 ABC 在时域中表示为\n$$\n\\mathbf{E}_{t}(\\mathbf{r},t) = - \\eta_{b} \\hat{\\mathbf{n}} \\times \\mathbf{H}_{t}(\\mathbf{r},t) \\quad \\text{for} \\quad z=0\n$$\n其中下标 $t$ 表示与边界相切的分量。对于谐波时间依赖关系 $\\exp(-\\mathrm{i}\\omega t)$，该 ABC 直接变换到频域为\n$$\n\\tilde{\\mathbf{E}}_{t}(\\mathbf{r}) = - \\eta_{b} \\hat{\\mathbf{n}} \\times \\tilde{\\mathbf{H}}_{t}(\\mathbf{r}) \\quad \\text{for} \\quad z=0\n$$\n外向单位法向量是 $\\hat{\\mathbf{n}} = \\hat{\\mathbf{z}}$。在边界 $z=0$ 处，总场为\n$$\n\\tilde{\\mathbf{E}}(z=0) = E_{0} (1+\\Gamma) \\hat{\\mathbf{x}}\n$$\n$$\n\\tilde{\\mathbf{H}}(z=0) = \\frac{E_{0}}{\\eta} (1-\\Gamma) \\hat{\\mathbf{y}}\n$$\n由于 $\\tilde{\\mathbf{E}}(z=0)$ 和 $\\tilde{\\mathbf{H}}(z=0)$ 都完全位于 $xy$ 平面内，它们分别等于其切向分量 $\\tilde{\\mathbf{E}}_{t}(z=0)$ 和 $\\tilde{\\mathbf{H}}_{t}(z=0)$。\n\n将这些代入相量域的 ABC 中：\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = - \\eta_{b} \\, \\hat{\\mathbf{z}} \\times \\left( \\frac{E_{0}}{\\eta} (1-\\Gamma) \\hat{\\mathbf{y}} \\right)\n$$\n我们计算叉积：$\\hat{\\mathbf{z}} \\times \\hat{\\mathbf{y}} = -\\hat{\\mathbf{x}}$。\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = - \\eta_{b} \\frac{E_{0}}{\\eta} (1-\\Gamma) (-\\hat{\\mathbf{x}})\n$$\n$$\nE_{0} (1+\\Gamma) \\hat{\\mathbf{x}} = \\frac{\\eta_{b}}{\\eta} E_{0} (1-\\Gamma) \\hat{\\mathbf{x}}\n$$\n由于 $E_{0}$ 非零，我们可以消去两边的向量项 $E_{0}\\hat{\\mathbf{x}}$，得到关于 $\\Gamma$ 的标量方程：\n$$\n1+\\Gamma = \\frac{\\eta_{b}}{\\eta} (1-\\Gamma)\n$$\n我们现在求解 $\\Gamma$。两边乘以 $\\eta$：\n$$\n\\eta(1+\\Gamma) = \\eta_{b}(1-\\Gamma)\n$$\n$$\n\\eta + \\eta\\Gamma = \\eta_{b} - \\eta_{b}\\Gamma\n$$\n重新整理各项，将含 $\\Gamma$ 的项归类：\n$$\n\\eta\\Gamma + \\eta_{b}\\Gamma = \\eta_{b} - \\eta\n$$\n$$\n\\Gamma (\\eta + \\eta_{b}) = \\eta_{b} - \\eta\n$$\n最后，两边除以 $(\\eta + \\eta_{b})$，得到反射系数的闭式表达式：\n$$\n\\Gamma = \\frac{\\eta_{b} - \\eta}{\\eta_{b} + \\eta}\n$$\n该表达式是无量纲的，并用指定的参数 $\\eta$ 和 $\\eta_{b}$ 表示。这是在具有表面阻抗 $\\eta_b$ 的边界上反射的著名公式。为实现对垂直入射波的完美吸收，理想的 Silver-Müller ABC 会设置 $\\eta_b = \\eta$，从而得到 $\\Gamma=0$。",
            "answer": "$$\\boxed{\\frac{\\eta_{b} - \\eta}{\\eta_{b} + \\eta}}$$"
        },
        {
            "introduction": "在实践中，理想的 Silver-Müller 条件很难直接实现，因此我们转而使用近似方法，其中最基本的是基于单向波算子的方法。这个练习将引导您分析最简单的一阶吸收边界条件 $(\\partial_{t} - c\\partial_{x})u = 0$ 的性能。您将推导出一个斜入射平面波的反射系数 $R(\\theta)$，并发现其对入射角 $\\theta$ 的强烈依赖性，尤其是在掠射角（$\\theta \\to \\pi/2$）时反射接近于1。这个结果揭示了低阶局部 ABC 的一个根本局限性，并强调了开发对角度不敏感的高阶方法的必要性。",
            "id": "3324557",
            "problem": "考虑一个二维、均匀、各向同性、无源的电磁介质，其介电常数为 $\\varepsilon$，磁导率为 $\\mu$，因此波速为 $c = (\\varepsilon \\mu)^{-1/2}$。在这种介质中，电场的每个笛卡尔分量都满足标量波动方程 $u_{tt} = c^{2}(u_{xx} + u_{yy})$，其中 $u(x,y,t)$ 表示电场的一个分量。设计算域为半空间 $x \\ge 0$，在 $x = 0$ 处有一个平面人工边界，并考虑在边界上实施一个局部吸收边界条件（ABC），该条件强制执行单向算子，\n$$\n(\\partial_{t} - c\\,\\partial_{x})\\,u\\big|_{x=0} = 0.\n$$\n假设一个角频率为 $\\omega$ 的时谐平面波在内部向边界传播，其相量表示和时间依赖性为 $\\exp(-\\mathrm{i}\\,\\omega t)$，因此入射场为\n$$\nu_{i}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(k_{x}x + k_{y}y - \\omega t)\\big),\n$$\n其中色散关系 $k^{2} = k_{x}^{2} + k_{y}^{2} = (\\omega/c)^{2}$ 成立。设入射角 $\\theta \\in [0,\\pi/2)$ 以弧度为单位，相对于边界法线（$+x$ 轴）测量，因此 $k_{x} = -k\\cos\\theta$ 和 $k_{y} = k\\sin\\theta$，其中 $k = \\omega/c$。边界附近的总场是入射场和镜面反射场 $u_{r}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(+k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big)$ 的叠加 $u_{t} = u_{i} + R\\,u_{r}$，其中反射系数为 $R(\\theta)$。\n\n从波动方程和平面波色散关系出发，并仅使用在 $x=0$ 处的边界算子 $(\\partial_{t} - c\\,\\partial_{x})$，推导感应反射系数 $R(\\theta)$ 的精确闭式表达式，该表达式仅用 $\\sin\\theta$ 表示。然后，通过对你的结果进行渐近分析，确定在掠射极限 $\\theta \\to \\pi/2$ 下反射幅值的主阶标度，并解释为什么这种行为揭示了单向算子用于掠射局部吸收边界条件的一个局限性。\n\n请给出 $R(\\theta)$ 的最终答案，形式为一个仅依赖于 $\\sin\\theta$ 的单一闭式解析表达式。不需要数值近似。角度必须以弧度处理。",
            "solution": "在均匀各向同性介质中，电磁场分量满足麦克斯韦方程组。在无源且材料参数恒定的情况下，电场的每个笛卡尔分量都满足标量波动方程\n$$\nu_{tt} = c^{2}(u_{xx} + u_{yy}),\n$$\n其中 $c = (\\varepsilon \\mu)^{-1/2}$ 是波速。一个时谐平面波解的形式为\n$$\nu(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(k_{x}x + k_{y}y - \\omega t)\\big),\n$$\n其色散关系为\n$$\nk^{2} = k_{x}^{2} + k_{y}^{2} = \\left(\\frac{\\omega}{c}\\right)^{2}.\n$$\n设平面人工边界位于 $x=0$，计算域为 $x \\ge 0$。通过波动算子的单向算子分解得到的局部吸收边界条件（ABC）强制要求\n$$\n(\\partial_{t} - c\\,\\partial_{x})\\,u\\big|_{x=0} = 0.\n$$\n该算子会消除向 $x$ 减小方向传播的波（向左传播的波），并且对于垂直于边界的波是一阶精确的。为了检验斜入射的反射情况，考虑一个从域内接近边界的入射平面波。入射角 $\\theta \\in [0,\\pi/2)$ 是相对于边界法线（$+x$ 轴）定义的，波数分量为\n$$\nk_{x} = -k\\cos\\theta,\\quad k_{y} = k\\sin\\theta,\\quad k = \\frac{\\omega}{c}.\n$$\n入射场为\n$$\nu_{i}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(-k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big),\n$$\n根据镜面对称性，反射场为\n$$\nu_{r}(x,y,t) = \\exp\\!\\big(\\mathrm{i}\\,(+k\\cos\\theta\\,x + k\\sin\\theta\\,y - \\omega t)\\big).\n$$\n边界附近的总场是 $u_{t} = u_{i} + R\\,u_{r}$，其中 $R(\\theta)$ 是我们旨在计算的复反射系数。将边界算子应用于 $x=0$ 处的总场，得到\n$$\n\\left[(\\partial_{t} - c\\,\\partial_{x})(u_{i} + R\\,u_{r})\\right]_{x=0} = 0.\n$$\n我们计算导数。对于时间导数，\n$$\n\\partial_{t} u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i},\\qquad \\partial_{t} u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r}.\n$$\n对于沿 $x$ 的空间导数，\n$$\n\\partial_{x} u_{i} = \\mathrm{i}\\,(-k\\cos\\theta)\\,u_{i},\\qquad \\partial_{x} u_{r} = \\mathrm{i}\\,(+k\\cos\\theta)\\,u_{r}.\n$$\n因此，\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i} - c\\,\\mathrm{i}\\,(-k\\cos\\theta)\\,u_{i} = -\\mathrm{i}\\,\\omega\\,u_{i} + \\mathrm{i}\\,c\\,k\\cos\\theta\\,u_{i}.\n$$\n类似地，\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r} - c\\,\\mathrm{i}\\,(+k\\cos\\theta)\\,u_{r} = -\\mathrm{i}\\,\\omega\\,u_{r} - \\mathrm{i}\\,c\\,k\\cos\\theta\\,u_{r}.\n$$\n使用 $c\\,k = \\omega$，这些式子简化为\n$$\n(\\partial_{t} - c\\,\\partial_{x})u_{i} = -\\mathrm{i}\\,\\omega\\,(1 - \\cos\\theta)\\,u_{i},\\qquad\n(\\partial_{t} - c\\,\\partial_{x})u_{r} = -\\mathrm{i}\\,\\omega\\,(1 + \\cos\\theta)\\,u_{r}.\n$$\n在 $x=0$ 处，入射场和反射场在 $y$ 和 $t$ 上具有相同的相位因子，并且在 $x$ 方向上具有单位振幅，因为 $\\exp(\\mathrm{i}\\,(\\pm k\\cos\\theta\\,x))\\big|_{x=0} = 1$。记 $U_{0} = \\exp\\!\\big(\\mathrm{i}\\,(k\\sin\\theta\\,y - \\omega t)\\big)$，我们有 $u_{i}\\big|_{x=0} = U_{0}$ 和 $u_{r}\\big|_{x=0} = U_{0}$。边界条件变为\n$$\n-\\mathrm{i}\\,\\omega\\,(1 - \\cos\\theta)\\,U_{0} + R\\,\\big(-\\mathrm{i}\\,\\omega\\,(1 + \\cos\\theta)\\,U_{0}\\big) = 0.\n$$\n两边同除以 $-\\mathrm{i}\\,\\omega\\,U_{0}$，得到\n$$\n(1 - \\cos\\theta) + R\\,(1 + \\cos\\theta) = 0,\n$$\n所以反射系数为\n$$\nR(\\theta) = -\\,\\frac{1 - \\cos\\theta}{1 + \\cos\\theta}.\n$$\n为了仅用 $\\sin\\theta$ 表示 $R(\\theta)$，注意到对于 $\\theta \\in [0,\\pi/2)$，有 $\\cos\\theta = \\sqrt{1 - \\sin^{2}\\theta}$。代入这个恒等式，得到\n$$\nR(\\theta) = -\\,\\frac{1 - \\sqrt{1 - \\sin^{2}\\theta}}{1 + \\sqrt{1 - \\sin^{2}\\theta}}.\n$$\n这就是所要求的仅依赖于 $\\sin\\theta$ 的闭式解析表达式。\n\n对于掠射，$\\theta \\to \\pi/2$，所以 $\\sin\\theta \\to 1$，因此 $\\cos\\theta \\to 0$。根据精确公式，\n$$\nR(\\theta) \\xrightarrow[\\theta \\to \\pi/2]{} -\\,\\frac{1 - 0}{1 + 0} = -1,\n$$\n这表明在极限情况下发生全反射。与 $-1$ 的主阶偏差可以通过对小 $\\cos\\theta$ 的分子和分母进行展开得到，\n$$\n1 + R(\\theta) = \\frac{2\\,\\cos\\theta}{1 + \\cos\\theta} \\sim 2\\,\\cos\\theta \\quad \\text{当} \\quad \\cos\\theta \\to 0 \\text{时}.\n$$\n用 $\\sin\\theta$ 表示，使用 $\\cos\\theta = \\sqrt{1 - \\sin^{2}\\theta}$ 得到\n$$\n1 + R(\\theta) \\sim 2\\,\\sqrt{1 - \\sin^{2}\\theta} \\quad \\text{当} \\quad \\sin\\theta \\to 1 \\text{时}.\n$$\n因此，在掠射情况下，感应的反射趋于全反射，其与-1的偏差按 $1 - \\sin^{2}\\theta$ 的平方根进行标度。这揭示了局部单向算子吸收边界条件的一个局限性：它对于法向入射（$\\theta = 0$ 产生 $R = 0$）是精确的，但随着入射变为掠射，它会变得高度反射，这是低阶局部吸收边界条件在处理具有大切向波数的波时的一个已知缺陷。",
            "answer": "$$\\boxed{-\\frac{1 - \\sqrt{1 - \\sin^{2}\\theta}}{1 + \\sqrt{1 - \\sin^{2}\\theta}}}$$"
        },
        {
            "introduction": "理论分析揭示了低阶 ABC 的局限性，现在我们转向在实际的 FDTD 网格中量化和比较不同阶数的边界条件。这个计算实践要求您分析并比较广泛使用的一阶和二阶 Mur 吸收边界条件在二维 $\\mathrm{TM}_z$ FDTD 仿真中的性能。通过将离散平面波的解析形式代入边界更新方程，您将计算出斜入射波的数值反射系数，并直接比较不同 Courant 数 $S$ 下两种方法的吸收效果。这项练习将理论知识与数值实现紧密联系起来，让您亲身体验高阶近似如何显著改善大角度入射波的吸收精度。",
            "id": "3324495",
            "problem": "考虑一个用于z轴横磁（$\\mathrm{TM}_z$）极化的二维时域有限差分法（FDTD）公式，其中非零场分量为 $E_z$、$H_x$ 和 $H_y$。设 Yee 网格间距满足 $\\Delta x = \\Delta y$，并定义库朗数（Courant number）$S$ 为 $S = c \\Delta t / \\Delta x$，其中 $c$ 是光速。假设区域是离散均匀、各向同性且无损的。假设介质体内存在一个单色离散平面波解，其形式为 $E_z(m, j, n) = \\Re\\{ \\tilde{E} \\exp(j (n \\, \\omega \\Delta t - m \\, k_x \\Delta x - j \\, k_y \\Delta y)) \\}$，其中 $m, j, n$ 分别是 $x$、$y$ 和时间的整数索引，而 $k_x$、$k_y$ 和 $\\omega$ 分别表示离散波数分量和角频率。二维 Yee 格式中 $\\mathrm{TM}_z$ 极化的离散色散关系是一个经过充分检验的公式\n$$\n\\sin^2\\!\\left(\\frac{\\omega \\Delta t}{2}\\right) \\;=\\; S^2 \\left[ \\sin^2\\!\\left(\\frac{k_x \\Delta x}{2}\\right) + \\sin^2\\!\\left(\\frac{k_y \\Delta y}{2}\\right) \\right],\n$$\n您可以将其作为基本出发点。\n\n我们在平面 $m=0$ 处放置一个垂直于 $x$ 方向的局部吸收边界。一个入射角为 $\\theta$（定义为传播方向与边界法线，即$+x$轴，之间的夹角）的离散平面波，其相位方向由 $(k_x, k_y)$ 决定，我们定义无量纲相分量 $\\kappa_x = k_x \\Delta x$ 和 $\\kappa_y = k_y \\Delta y$。对于给定的角度 $\\theta$，选择一个无量纲总波数大小 $\\kappa$，并设置 $\\kappa_x = \\kappa \\cos \\theta$ 和 $\\kappa_y = \\kappa \\sin \\theta$。然后，离散角频率由色散关系确定：\n$$\n\\sin\\!\\left(\\frac{u}{2}\\right) \\;=\\; S \\,\\sqrt{ \\sin^2\\!\\left(\\frac{\\kappa_x}{2}\\right) + \\sin^2\\!\\left(\\frac{\\kappa_y}{2}\\right) }, \\quad \\text{其中 } u = \\omega \\Delta t,\n$$\n取主支 $u \\in [0,\\pi]$。\n\n我们考虑两种仅应用于 $m=0$ 处离散场 $E_z$ 的局部吸收边界条件 (ABC)：\n\n1) 一阶 Mur 吸收边界条件 (Mur-1)，其完全离散形式仅使用 $m=0$ 和 $m=1$ 处的场来表示：\n$$\nE_z^{n+1}(0,j) \\;=\\; E_z^{n}(1,j) \\;+\\; r \\left[ E_z^{n+1}(1,j) - E_z^{n}(0,j) \\right],\n$$\n其中 $r = \\dfrac{S - 1}{S + 1}$。\n\n2) 一种二阶局部 Mur 型吸收边界条件 (Mur-2)，通过对时域中精确单向算子进行二阶近似以及对切向曲率项进行梯形时间积分推导得出，得到以下显式边界更新：\n$$\n(1 - \\tfrac{S}{2}) \\, E_z^{n+1}(0,j) \\;+\\; \\tfrac{S}{2} \\, E_z^{n+1}(1,j) \\;=\\; \\left(\\tfrac{S^2}{2}\\right)\\!\\left[E_z^{n}(0,j+1) - 2 E_z^{n}(0,j) + E_z^{n}(0,j-1)\\right] \\;+\\; \\left(1 + \\tfrac{S}{2}\\right) E_z^{n}(0,j) \\;-\\; \\tfrac{S}{2} \\, E_z^{n}(1,j).\n$$\n此更新仅使用当前和紧邻前一时间步的场，以及边界上的最近切向邻近点。\n\n假设一个从内部向边界传播的斜入射离散平面波：\n$$\nE_{z,\\text{inc}}^{n}(m,j) = \\exp\\!\\left( j \\left[n u - m \\kappa_x - j \\kappa_y \\right] \\right),\n$$\n以及一个反射波：\n$$\nE_{z,\\text{ref}}^{n}(m,j) = R \\,\\exp\\!\\left( j \\left[n u + m \\kappa_x - j \\kappa_y \\right] \\right),\n$$\n其中 $R$ 是复反射系数。总场为 $E_z^n = E_{z,\\text{inc}}^n + E_{z,\\text{ref}}^n$。将此总场代入 $m=0$ 处的每个边界更新中，会得到一个关于 $R$ 的复线性方程，该方程对每个角频率 $u$ 和相分量 $(\\kappa_x,\\kappa_y)$ 成立。\n\n任务。对于入射角 $\\theta = 60$ 度（角度必须以度为单位），以及固定的无量纲空间波数大小 $\\kappa = \\pi/2$，在 $\\Delta x = \\Delta y$ 的约束下，计算 Mur-2 和 Mur-1 两种 ABC 在几个不同库朗数 $S$ 下的数值反射系数的模 $\\lvert R \\rvert$。使用上面给出的色散关系从 $(S,\\kappa_x,\\kappa_y)$ 确定 $u$。对于每个测试用例，报告一对浮点值 $[\\lvert R_{\\mathrm{Mur2}}\\rvert, \\lvert R_{\\mathrm{Mur1}}\\rvert]$。\n\n角度单位规范。使用度作为 $\\theta$ 的单位。\n\n单位。最终输出不需要物理单位；所有数值均报告为无单位的浮点值。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目是对应于一个测试用例的双元素列表，按下面给出的顺序排列，且不含空格。例如：“[[0.1,0.2],[0.3,0.4]]”。\n\n测试组。使用以下测试用例以确保覆盖与稳定性相关的库朗数：\n- 用例 1（标准情况）：$S = 0.5$，$\\theta = 60$ 度，$\\kappa = \\pi/2$。\n- 用例 2（接近稳定性边界）：$S = 0.7$，$\\theta = 60$ 度，$\\kappa = \\pi/2$。\n- 用例 3（小时间步长）：$S = 0.3$，$\\theta = 60$ 度，$\\kappa = \\pi/2$。\n\n答案规范。输出必须是包含三个条目的单个列表，每个条目是包含两个浮点数的列表，顺序为 $[\\lvert R_{\\mathrm{Mur2}}\\rvert, \\lvert R_{\\mathrm{Mur1}}\\rvert]$，对应于上面列出的三个用例。",
            "solution": "该问题经评估有效。其科学基础是计算电磁学的原理，特别是时域有限差分（FDTD）方法和吸收边界条件（ABC）的分析。该问题是适定的、自洽的、客观的，提供了所有必要的方程、参数和明确的任务。前提与既有理论一致，所需的计算虽然不简单，但在数学上是合理的。\n\n目标是当离散平面波入射到两种不同的局部吸收边界条件（Mur-1 和 Mur-2）上时，确定复反射系数 $\\lvert R \\rvert$ 的模。该分析通过将总场（入射波加反射波）的解析形式代入每种 ABC 的离散方程中来进行。此过程会产生一个关于 $R$ 的复线性方程，然后可以求解该方程。\n\n首先，我们为给定的测试用例定义参数：库朗数 $S$、入射角 $\\theta$ 和无量纲波数大小 $\\kappa$。\n角度 $\\theta$ 以度为单位给出，必须转换为弧度以用于三角函数：$\\theta_{\\text{rad}} = \\theta \\cdot \\pi / 180$。\n无量纲波数分量由 $\\kappa_x = \\kappa \\cos \\theta_{\\text{rad}}$ 和 $\\kappa_y = \\kappa \\sin \\theta_{\\text{rad}}$ 给出。\n无量纲角频率 $u = \\omega \\Delta t$ 由离散色散关系确定：\n$$\nu = 2 \\arcsin\\left( S \\sqrt{ \\sin^2\\left(\\frac{\\kappa_x}{2}\\right) + \\sin^2\\left(\\frac{\\kappa_y}{2}\\right) } \\right)\n$$\n\n总场 $E_z$ 是入射波和反射波的和：\n$$\nE_z^n(m, j) = E_{z,\\text{inc}}^{n}(m,j) + E_{z,\\text{ref}}^{n}(m,j) = \\exp\\left( j \\left[n u - m \\kappa_x - j \\kappa_y \\right] \\right) + R \\exp\\left( j \\left[n u + m \\kappa_x - j \\kappa_y \\right] \\right)\n$$\n我们可以提出公共的时间和切向相位项：\n$$\nE_z^n(m, j) = \\exp(j(nu - j\\kappa_y)) \\left[ \\exp(-jm\\kappa_x) + R \\exp(jm\\kappa_x) \\right]\n$$\n我们定义一个空间相关部分 $Z_m = \\exp(-jm\\kappa_x) + R \\exp(jm\\kappa_x)$。ABC 应用于边界 $m=0$，因此我们需要 $m=0$ 和 $m=1$ 处的场：\n$Z_0 = 1 + R$\n$Z_1 = \\exp(-j\\kappa_x) + R \\exp(j\\kappa_x)$\n\n以下关系将用于处理时间步和切向空间位移：\n$E_z^{n+1}(m, j) = E_z^n(m, j) \\exp(ju)$\n$E_z^{n}(m, j \\pm 1) = E_z^n(m, j) \\exp(\\mp j\\kappa_y)$\n\n**1. Mur-1 ABC 反射系数的推导**\n\n一阶 Mur ABC 由下式给出：\n$$\nE_z^{n+1}(0,j) = E_z^{n}(1,j) + r \\left[ E_z^{n+1}(1,j) - E_z^{n}(0,j) \\right], \\quad \\text{其中 } r = \\frac{S - 1}{S + 1}\n$$\n重新排列以获得更对称的形式：\n$$\n(S+1)E_z^{n+1}(0,j) + (S-1)E_z^{n}(0,j) = (S-1)E_z^{n+1}(1,j) + (S+1)E_z^{n}(1,j)\n$$\n代入平面波形式。在除以公共相位因子 $\\exp(j(nu - j\\kappa_y))$ 后，我们得到一个关于 $Z_0$ 和 $Z_1$ 的方程：\n$$\n(S+1)Z_0\\exp(ju) + (S-1)Z_0 = (S-1)Z_1\\exp(ju) + (S+1)Z_1\n$$\n$$\nZ_0 \\left[ (S+1)\\exp(ju) + (S-1) \\right] = Z_1 \\left[ (S-1)\\exp(ju) + (S+1) \\right]\n$$\n令 $A = (S+1)\\exp(ju) + (S-1)$ 和 $B = (S+1) + (S-1)\\exp(ju)$。方程为 $Z_0 A = Z_1 B$。\n代入 $Z_0$ 和 $Z_1$ 的表达式：\n$$\n(1+R)A = (\\exp(-j\\kappa_x) + R\\exp(j\\kappa_x)) B\n$$\n求解 $R$ 可得：\n$$\nA + RA = B\\exp(-j\\kappa_x) + RB\\exp(j\\kappa_x) \\implies R(A - B\\exp(j\\kappa_x)) = B\\exp(-j\\kappa_x) - A\n$$\n$$\nR_{\\text{Mur1}} = \\frac{B\\exp(-j\\kappa_x) - A}{A - B\\exp(j\\kappa_x)}\n$$\n\n**2. Mur-2 ABC 反射系数的推导**\n\n二阶 Mur 型 ABC 由下式给出：\n$$\n(1 - \\tfrac{S}{2}) E_z^{n+1}(0,j) + \\tfrac{S}{2} E_z^{n+1}(1,j) = \\left(\\tfrac{S^2}{2}\\right)\\!\\left[E_z^{n}(0,j+1) - 2 E_z^{n}(0,j) + E_z^{n}(0,j-1)\\right] + \\left(1 + \\tfrac{S}{2}\\right) E_z^{n}(0,j) - \\tfrac{S}{2} E_z^{n}(1,j)\n$$\n首先，简化切向有限差分项：\n$$\nE_z^{n}(0,j+1) - 2 E_z^{n}(0,j) + E_z^{n}(0,j-1) = E_z^n(0,j) (\\exp(-j\\kappa_y) - 2 + \\exp(j\\kappa_y)) = E_z^n(0,j) (2\\cos\\kappa_y - 2) = -4\\sin^2(\\kappa_y/2)E_z^n(0,j)\n$$\n将此式和平面波形式代入 ABC。在除以 $\\exp(j(nu-j\\kappa_y))$ 后，我们得到：\n$$\n(1 - \\tfrac{S}{2})Z_0\\exp(ju) + \\tfrac{S}{2}Z_1\\exp(ju) = \\left(\\tfrac{S^2}{2}\\right)Z_0(-4\\sin^2(\\kappa_y/2)) + \\left(1 + \\tfrac{S}{2}\\right)Z_0 - \\tfrac{S}{2}Z_1\n$$\n合并含 $Z_0$ 和 $Z_1$ 的项：\n$$\nZ_1 \\left( \\tfrac{S}{2}\\exp(ju) + \\tfrac{S}{2} \\right) = Z_0 \\left[ -2S^2\\sin^2(\\kappa_y/2) + \\left(1 + \\tfrac{S}{2}\\right) - \\left(1 - \\tfrac{S}{2}\\right)\\exp(ju) \\right]\n$$\n令 $C = \\tfrac{S}{2}(1 + \\exp(ju))$ 和 $D = -2S^2\\sin^2(\\kappa_y/2) + (1 + \\tfrac{S}{2}) - (1 - \\tfrac{S}{2})\\exp(ju)$。方程为 $Z_1 C = Z_0 D$。\n代入 $Z_0$ 和 $Z_1$ 的表达式：\n$$\n(\\exp(-j\\kappa_x) + R\\exp(j\\kappa_x)) C = (1+R) D\n$$\n求解 $R$ 可得：\n$$\nC\\exp(-j\\kappa_x) + RC\\exp(j\\kappa_x) = D + RD \\implies R(C\\exp(j\\kappa_x) - D) = D - C\\exp(-j\\kappa_x)\n$$\n$$\nR_{\\text{Mur2}} = \\frac{D - C\\exp(-j\\kappa_x)}{C\\exp(j\\kappa_x) - D}\n$$\n对于每个测试用例，使用参数 $S$、$\\theta$ 和 $\\kappa$ 计算 $\\kappa_x$、$\\kappa_y$ 和 $u$。然后将这些值代入 $R_{\\text{Mur1}}$ 和 $R_{\\text{Mur2}}$ 的表达式中，以求得复反射系数。最终结果是它们的模，即 $\\lvert R_{\\text{Mur1}} \\rvert$ 和 $\\lvert R_{\\text{Mur2}} \\rvert$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the reflection coefficient magnitudes for Mur-1 and Mur-2 ABCs\n    for specified test cases in a 2D FDTD TMz grid.\n    \"\"\"\n    # Test cases: (S, theta_deg, kappa)\n    test_cases = [\n        (0.5, 60.0, np.pi / 2.0),\n        (0.7, 60.0, np.pi / 2.0),\n        (0.3, 60.0, np.pi / 2.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        S, theta_deg, kappa = case\n        \n        # Convert angle to radians\n        theta_rad = np.deg2rad(theta_deg)\n        \n        # Calculate dimensionless wavenumber components\n        kappa_x = kappa * np.cos(theta_rad)\n        kappa_y = kappa * np.sin(theta_rad)\n        \n        # Calculate dimensionless angular frequency u from the dispersion relation\n        # Check for stability, although given cases are stable\n        arg_asin = S * np.sqrt(np.sin(kappa_x / 2.0)**2 + np.sin(kappa_y / 2.0)**2)\n        if arg_asin > 1.0:\n            # This should not happen for the given test cases\n            # which are within the FDTD stability limit S = 1/sqrt(2)\n            results.append([np.nan, np.nan]) # Indicate instability\n            continue\n        \n        u = 2.0 * np.arcsin(arg_asin)\n        \n        exp_ju = np.exp(1j * u)\n        exp_j_kx = np.exp(1j * kappa_x)\n        exp_mj_kx = np.exp(-1j * kappa_x)\n\n        # --- Calculate R_Mur1 ---\n        # A = (S+1)exp(ju) + (S-1)\n        # B = (S+1) + (S-1)exp(ju)\n        # R_Mur1 = (B * exp(-j*kappa_x) - A) / (A - B * exp(j*kappa_x))\n        A_mur1 = (S + 1.0) * exp_ju + (S - 1.0)\n        B_mur1 = (S + 1.0) + (S - 1.0) * exp_ju\n        \n        num_mur1 = B_mur1 * exp_mj_kx - A_mur1\n        den_mur1 = A_mur1 - B_mur1 * exp_j_kx\n        \n        R_mur1 = num_mur1 / den_mur1\n        R_mur1_mag = np.abs(R_mur1)\n        \n        # --- Calculate R_Mur2 ---\n        # C = S/2 * (1 + exp(ju))\n        # D = -2*S^2*sin^2(kappa_y/2) + (1 + S/2) - (1 - S/2)*exp(ju)\n        # R_Mur2 = (D - C * exp(-j*kappa_x)) / (C * exp(j*kappa_x) - D)\n        C_mur2 = (S / 2.0) * (1.0 + exp_ju)\n        D_mur2 = -2.0 * S**2 * np.sin(kappa_y / 2.0)**2 + (1.0 + S / 2.0) - (1.0 - S / 2.0) * exp_ju\n\n        num_mur2 = D_mur2 - C_mur2 * exp_mj_kx\n        den_mur2 = C_mur2 * exp_j_kx - D_mur2\n        \n        R_mur2 = num_mur2 / den_mur2\n        R_mur2_mag = np.abs(R_mur2)\n\n        # Append results in the specified order: [|R_Mur2|, |R_Mur1|]\n        results.append([R_mur2_mag, R_mur1_mag])\n\n    # Format the final output string as requested\n    # e.g., \"[[0.1,0.2],[0.3,0.4]]\"\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}