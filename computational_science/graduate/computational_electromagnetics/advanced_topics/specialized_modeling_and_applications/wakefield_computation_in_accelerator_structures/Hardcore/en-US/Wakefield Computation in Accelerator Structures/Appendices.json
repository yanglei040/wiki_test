{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will solidify a foundational concept: the distinction between energy storage and energy dissipation in wakefield-matter interaction. The longitudinal loss factor, $k$, quantifies the irreversible energy lost by a particle bunch to an accelerator structure. This exercise challenges you to derive the loss factor from first principles and apply it to a hypothetical structure with a purely inductive impedance, revealing the crucial role of the real (resistive) part of the impedance in energy dissipation. ",
            "id": "3360476",
            "problem": "Consider a single, rigid ultra-relativistic bunch traversing a linear, time-invariant accelerator structure. Let the bunch temporal current be described by a normalized Gaussian profile $i(t)$ of root-mean-square duration $\\sigma_{t}$, with total bunch charge $q$ so that $I(t)=q\\,i(t)$ and $\\int_{-\\infty}^{\\infty} i(t)\\,\\mathrm{d}t = 1$. The root-mean-square bunch length in space is $\\sigma_{z}=c\\,\\sigma_{t}$, where $c$ is the speed of light in vacuum. The longitudinal beam-coupling impedance $Z_{\\parallel}(\\omega)$ of the structure is defined in the frequency domain by the standard linear response relation between the beam current spectrum $I(\\omega)$ and the induced voltage spectrum $V(\\omega)$, namely $V(\\omega)=Z_{\\parallel}(\\omega)\\,I(\\omega)$. The energy dissipated in the structure by a single passage of the bunch is the integral of the instantaneous power $P(t)=I(t)\\,V(t)$ over time. The loss factor $k$ is defined as the dissipated energy per unit charge squared, $k \\equiv W_{\\mathrm{diss}}/q^{2}$, and serves as a measure of the irreversible energy loss experienced by the bunch due to the structure’s resistive response. Starting from these definitions, the Poynting theorem, and the property that only the resistive (real) part of the impedance contributes to net energy dissipation in a linear passive system, derive an expression for $k$ in terms of the bunch spectrum and the impedance. Then, for a structure with purely inductive longitudinal impedance $Z_{\\parallel}(\\omega)=i\\,L\\,\\omega$, where $L$ is a real, positive inductance parameter and $\\omega$ is the angular frequency, compute how $k$ scales with the bunch root-mean-square length $\\sigma_{z}$. Your final answer must be a single closed-form expression for $k$ as a function of $\\sigma_{z}$, and it must be expressed without units. No numerical evaluation is required. In addition, explain the physical origin of the scaling you obtain. If any rounding were required, round to four significant figures; otherwise, provide the exact expression. Express all mathematical entities in LaTeX.",
            "solution": "The problem asks for a derivation of the loss factor $k$ and its scaling with the bunch length $\\sigma_z$ for a specific case of a purely inductive longitudinal impedance. The solution will proceed in three stages: first, a general expression for the loss factor $k$ will be derived from the provided definitions; second, this expression will be evaluated for the given impedance model; third, the physical meaning of the result and its scaling will be explained.\n\nFirst, we derive the general expression for the loss factor, $k$. The total energy dissipated in the structure, $W_{\\mathrm{diss}}$, is given by the time integral of the instantaneous power, $P(t)=I(t)V(t)$:\n$$\nW_{\\mathrm{diss}} = \\int_{-\\infty}^{\\infty} P(t) \\, \\mathrm{d}t = \\int_{-\\infty}^{\\infty} I(t) V(t) \\, \\mathrm{d}t\n$$\nHere, $I(t)$ is the bunch current and $V(t)$ is the longitudinal voltage induced by this current. Both $I(t)$ and $V(t)$ are real-valued physical quantities. To analyze this in the frequency domain, we employ Parseval's theorem. Let $I(\\omega)$ and $V(\\omega)$ be the Fourier transforms of $I(t)$ and $V(t)$, respectively, using the convention $F(\\omega) = \\int_{-\\infty}^{\\infty} f(t) \\exp(-i\\omega t) \\, \\mathrm{d}t$. The corresponding inverse transform is $f(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} F(\\omega) \\exp(i\\omega t) \\, \\mathrm{d}\\omega$.\nUsing this convention, Parseval's theorem gives:\n$$\n\\int_{-\\infty}^{\\infty} I(t) V(t) \\, \\mathrm{d}t = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I(-\\omega) V(\\omega) \\, \\mathrm{d}\\omega\n$$\nSince $I(t)$ is a real function, its Fourier transform satisfies the property $I(-\\omega) = I^*(\\omega)$, where the asterisk denotes complex conjugation. Thus, the expression for dissipated energy becomes:\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I^*(\\omega) V(\\omega) \\, \\mathrm{d}\\omega\n$$\nThe problem provides the linear response relation in the frequency domain: $V(\\omega) = Z_{\\parallel}(\\omega) I(\\omega)$. Substituting this into the expression for $W_{\\mathrm{diss}}$ yields:\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I^*(\\omega) Z_{\\parallel}(\\omega) I(\\omega) \\, \\mathrm{d}\\omega = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} Z_{\\parallel}(\\omega) |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\nThe problem correctly states that only the resistive (real) part of the impedance contributes to net energy dissipation. We can demonstrate this mathematically. For a real valued wake function, the impedance must satisfy $Z_{\\parallel}(\\omega) = Z_{\\parallel}^*(-\\omega)$. This implies that the real part, $\\text{Re}[Z_{\\parallel}(\\omega)]$, is an even function of $\\omega$, and the imaginary part, $\\text{Im}[Z_{\\parallel}(\\omega)]$, is an odd function of $\\omega$. The term $|I(\\omega)|^2$ is necessarily real and even.\nWe can split the integral for $W_{\\mathrm{diss}}$:\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\left( \\text{Re}[Z_{\\parallel}(\\omega)] + i \\, \\text{Im}[Z_{\\parallel}(\\omega)] \\right) |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |I(\\omega)|^2 \\, \\mathrm{d}\\omega + \\frac{i}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Im}[Z_{\\parallel}(\\omega)] |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\nIn the second term, the integrand is the product of an odd function, $\\text{Im}[Z_{\\parallel}(\\omega)]$, and an even function, $|I(\\omega)|^2$. The resulting integrand is odd, and its integral over the symmetric interval $(-\\infty, \\infty)$ is zero. Thus, the dissipated energy is determined solely by the real part of the impedance:\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\nThe loss factor $k$ is defined as $k \\equiv W_{\\mathrm{diss}}/q^2$. The bunch current spectrum is $I(\\omega) = q \\, i(\\omega)$, where $i(\\omega)$ is the Fourier transform of the normalized current profile $i(t)$. Therefore, $|I(\\omega)|^2 = q^2 |i(\\omega)|^2$. Substituting this into the expression for $W_{\\mathrm{diss}}$ and dividing by $q^2$:\n$$\nk = \\frac{1}{q^2} \\left( \\frac{q^2}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |i(\\omega)|^2 \\, \\mathrm{d}\\omega \\right) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |i(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\nThis is the general expression for the loss factor in terms of the bunch spectrum and the impedance, as required.\n\nNext, we apply this result to the specific case of a purely inductive longitudinal impedance, $Z_{\\parallel}(\\omega) = i L \\omega$, where $L$ is a real, positive constant. The real part of this impedance is:\n$$\n\\text{Re}[Z_{\\parallel}(\\omega)] = \\text{Re}[i L \\omega] = 0 \\quad \\text{for all } \\omega\n$$\nSubstituting this into our derived expression for the loss factor $k$:\n$$\nk = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} (0) \\cdot |i(\\omega)|^2 \\, \\mathrm{d}\\omega = 0\n$$\nThe loss factor for a purely inductive impedance is identically zero.\n\nFinally, we address the question of how $k$ scales with the bunch root-mean-square length $\\sigma_z$. Since $k=0$, it is a constant and has no dependence on any bunch parameter, including $\\sigma_z$. The expression for $k$ as a function of $\\sigma_z$ is simply $k(\\sigma_z) = 0$.\n\nThe physical origin of this result lies in the definition of impedance and energy dissipation. The loss factor $k$ quantifies the irreversible energy loss of the bunch, which is energy dissipated as heat in the accelerator structure. In a linear, time-invariant system, such dissipation is exclusively associated with the resistive (real) part of the impedance. The given impedance, $Z_{\\parallel}(\\omega) = i L \\omega$, is purely imaginary, representing an ideal inductor. An ideal inductor is a reactive, not a resistive, component. It stores energy in its magnetic field when the current changes and returns this energy to the system perfectly. While there is an energy exchange between the bunch and the fields, there is no net energy dissipation. The energy lost by the front of the bunch in building up the fields is completely regained by the tail of the bunch as the fields collapse. Consequently, the total dissipated energy $W_{\\mathrm{diss}}$ is zero, and thus the loss factor $k$ is zero, regardless of the bunch's shape or duration $\\sigma_t$ (and thus its length $\\sigma_z$).",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "Building on our understanding of impedance, we now investigate how different types of impedance affect the beam's energy distribution. The interaction between the bunch's own frequency spectrum and the impedance profile of the structure determines the resulting energy spread, a key parameter for beam quality. This practice will sharpen your analytical skills as you derive and compare the scaling laws of wake-induced energy spread for two canonical models: a purely inductive impedance and a resistive-wall impedance, illustrating how bunch length, $\\sigma_z$, can be a critical tuning parameter. ",
            "id": "3360475",
            "problem": "An ultra-relativistic charged bunch of total charge $Q$ traverses a cylindrically symmetric, azimuthally smooth accelerator structure of length $L$. The wakefield induced by the bunch is characterized in the frequency domain by the longitudinal coupling impedance $Z_{\\parallel}(\\omega)$. The wake-induced energy deviation at longitudinal position $z$ within the bunch can be written in terms of the wake voltage $V_{\\text{wake}}(z)$ as $\\Delta \\mathcal{E}(z) = - e\\, V_{\\text{wake}}(z)$, where $e$ is the elementary charge. For ultra-relativistic motion, the wake voltage can be related to the impedance through the convolution in the frequency domain, $V_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} Z_{\\parallel}(\\omega)\\, \\tilde{I}(\\omega)\\, \\exp\\!\\left(i \\frac{\\omega z}{c}\\right)\\, d\\omega$, with $c$ the speed of light and $\\tilde{I}(\\omega)$ the Fourier transform of the bunch current profile $I(z) = Q c\\, \\lambda(z)$, where $\\lambda(z)$ is the line-density distribution normalized to $\\int \\lambda(z)\\, dz = 1$.\n\nAssume a Gaussian line-density $\\lambda(z) = \\frac{1}{\\sqrt{2\\pi}\\, \\sigma_{z}} \\exp\\!\\left(-\\frac{z^{2}}{2\\sigma_{z}^{2}}\\right)$ of root-mean-square length $\\sigma_{z}$, and use the standard Fourier transform $\\tilde{\\lambda}(\\omega) = \\int_{-\\infty}^{\\infty} \\lambda(z)\\, \\exp\\!\\left(- i \\frac{\\omega z}{c}\\right)\\, dz$. Consider two asymptotic impedance models over the frequency range that contributes dominantly to the bunch spectrum:\n\n1. A purely inductive impedance $Z_{\\parallel}(\\omega) = i L_{k}\\, \\omega$, where $L_{k}$ is a real constant that does not depend on $\\omega$ or $\\sigma_{z}$.\n\n2. A resistive-wall impedance with high-frequency scaling $Z_{\\parallel}(\\omega) = A\\, \\omega^{-1/2}$, where $A$ is a real, positive constant independent of $\\omega$ and $\\sigma_{z}$.\n\nStarting from the definitions above and without introducing any empirical shortcut formulas, determine the scaling of the peak wake-induced energy spread across the bunch, defined as $\\Delta \\mathcal{E}_{\\text{peak}} = \\max_{z} |\\Delta \\mathcal{E}(z) - \\langle \\Delta \\mathcal{E} \\rangle|$, with respect to $\\sigma_{z}$, for each impedance model. You may treat multiplicative constants that do not depend on $\\sigma_{z}$ (such as $Q$, $L$, $L_{k}$, $A$, and $c$) as overall prefactors and focus on the asymptotic power-law dependence on $\\sigma_{z}$. Provide the two scaling exponents $a_{\\text{ind}}$ and $a_{\\text{rw}}$ such that $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{ind}}}$ for the inductive case and $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{rw}}}$ for the resistive-wall case. Express your final answer as a row matrix containing the two exponents. No rounding is required, and no units should be included in the final answer.",
            "solution": "The problem asks for the scaling exponents of peak wake-induced energy spread with respect to the bunch length $\\sigma_{z}$ for two different impedance models.\n\n### Step 1: Extract Givens\n- Total bunch charge: $Q$\n- Accelerator structure length: $L$\n- Longitudinal coupling impedance: $Z_{\\parallel}(\\omega)$\n- Wake-induced energy deviation: $\\Delta \\mathcal{E}(z) = -e V_{\\text{wake}}(z)$, with $e$ as the elementary charge.\n- Wake voltage: $V_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} Z_{\\parallel}(\\omega) \\tilde{I}(\\omega) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega$, with $c$ as the speed of light.\n- Bunch current Fourier transform: $\\tilde{I}(\\omega)$\n- Bunch current profile: $I(z) = Q c \\lambda(z)$\n- Normalized line-density distribution: $\\lambda(z)$, with $\\int \\lambda(z) dz = 1$.\n- Specific line-density: Gaussian, $\\lambda(z) = \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{z^2}{2\\sigma_{z}^2}\\right)$, with RMS length $\\sigma_{z}$.\n- Fourier transform definition for the line density: $\\tilde{\\lambda}(\\omega) = \\int_{-\\infty}^{\\infty} \\lambda(z) \\exp\\left(-i \\frac{\\omega z}{c}\\right) dz$.\n- Impedance Model 1 (Inductive): $Z_{\\parallel}(\\omega) = i L_k \\omega$, with $L_k$ a real constant.\n- Impedance Model 2 (Resistive-Wall): $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$, with $A$ a real, positive constant.\n- Quantity to be determined: Peak wake-induced energy spread, $\\Delta \\mathcal{E}_{\\text{peak}} = \\max_{z} |\\Delta \\mathcal{E}(z) - \\langle \\Delta \\mathcal{E} \\rangle|$, where $\\langle \\Delta \\mathcal{E} \\rangle$ is the average over the bunch distribution.\n- Goal: Find the exponents $a_{\\text{ind}}$ and $a_{\\text{rw}}$ in the scaling relations $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{ind}}}$ and $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{rw}}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined within the context of accelerator physics and computational electromagnetics. It uses standard definitions for wake voltage, impedance, and bunch distributions. The Gaussian bunch profile and the inductive and resistive-wall impedance models are canonical examples used in the field. The provided formulas are internally consistent. The definition of the Fourier transform is explicitly given, removing ambiguity. The definition for the resistive-wall impedance, $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$, is a simplification of the full form, particularly concerning its behavior for $\\omega  0$. However, this is described as a high-frequency scaling, and the problem can be solved by focusing on the scaling properties rather than the exact functional form, which makes the simplification acceptable for the intended purpose. The problem is thus scientifically grounded, well-posed, and objective.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be developed.\n\n### Solution Derivation\n\nFirst, we determine the Fourier transform of the bunch current, $\\tilde{I}(\\omega)$. The current is $I(z) = Q c \\lambda(z)$, so its Fourier transform is $\\tilde{I}(\\omega) = Q c \\tilde{\\lambda}(\\omega)$.\nWe calculate $\\tilde{\\lambda}(\\omega)$ for the given Gaussian distribution:\n$$\n\\tilde{\\lambda}(\\omega) = \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{z'^2}{2\\sigma_{z}^2}\\right) \\exp\\left(-i \\frac{\\omega z'}{c}\\right) dz'\n$$\nThis is a standard Fourier transform of a Gaussian function. The integral of $\\exp(-ax^2)$ is $\\sqrt{\\pi/a}$. Completing the square in the exponent gives:\n$$\n-\\frac{z'^2}{2\\sigma_{z}^2} - i \\frac{\\omega z'}{c} = -\\frac{1}{2\\sigma_{z}^2}\\left(z'^2 + 2i \\frac{\\omega \\sigma_{z}^2}{c} z'\\right) = -\\frac{1}{2\\sigma_{z}^2}\\left(z' + i \\frac{\\omega \\sigma_{z}^2}{c}\\right)^2 - \\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\n$$\nThe integral becomes:\n$$\n\\tilde{\\lambda}(\\omega) = \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2\\sigma_{z}^2}\\left(z' + i \\frac{\\omega \\sigma_{z}^2}{c}\\right)^2\\right) dz'\n$$\nThe integral is over a shifted variable in the complex plane, but for a Gaussian, the value is invariant and equals $\\sqrt{2\\pi \\sigma_{z}^2} = \\sqrt{2\\pi}\\sigma_{z}$.\n$$\n\\tilde{\\lambda}(\\omega) = \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) (\\sqrt{2\\pi} \\sigma_{z}) = \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\n$$\nThus, the Fourier transform of the current is:\n$$\n\\tilde{I}(\\omega) = Q c \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\n$$\n\nNow we can calculate the wake voltage and energy spread for each case.\n\n#### Case 1: Inductive Impedance, $Z_{\\parallel}(\\omega) = i L_{k} \\omega$\n\nThe wake voltage is:\n$$\nV_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} (i L_{k} \\omega) \\left(Q c \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega\n$$\n$$\nV_{\\text{wake}}(z) = \\frac{i Q c L_{k}}{2\\pi} \\int_{-\\infty}^{\\infty} \\omega \\exp\\left(-\\frac{\\sigma_{z}^2}{2c^2}\\omega^2 + i \\frac{z}{c}\\omega \\right) d\\omega\n$$\nWe can evaluate this integral by noting the relationship between Fourier transforms and derivatives. The inverse Fourier transform is defined as $f(x) = \\frac{1}{2\\pi} \\int \\tilde{f}(k) e^{ikx} dk$. The transform of a derivative is $\\mathcal{F}\\{f'(x)\\} = ik\\tilde{f}(k)$. Here, $k \\leftrightarrow \\omega$ and $x \\leftrightarrow z/c$.\n$$\n\\omega \\exp\\left(i \\frac{\\omega z}{c}\\right) = -ic \\frac{\\partial}{\\partial z} \\exp\\left(i \\frac{\\omega z}{c}\\right)\n$$\nSubstituting this into the integral for $V_{\\text{wake}}(z)$:\n$$\nV_{\\text{wake}}(z) = \\frac{i Q c L_{k}}{2\\pi} \\int_{-\\infty}^{\\infty} \\left(-ic \\frac{\\partial}{\\partial z}\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) d\\omega\n$$\nWe can pull the derivative outside the integral:\n$$\nV_{\\text{wake}}(z) = \\frac{Q c^2 L_{k}}{2\\pi} \\frac{\\partial}{\\partial z} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega\n$$\nThe integral is the inverse Fourier transform of $\\tilde{I}(\\omega)/(Qc)$, which gives back the original charge distribution $I(z)/(Qc) = \\lambda(z)$, scaled by $2\\pi/c$. A direct calculation of the integral yields $\\frac{\\sqrt{2\\pi}c}{\\sigma_z}\\exp(-\\frac{z^2}{2\\sigma_z^2})$.\nSo, the expression inside the derivative is $\\frac{c}{Qc} \\cdot I(z) = \\lambda(z)$. No, that's not quite right.\nThe integral $\\frac{1}{2\\pi}\\int \\tilde{\\lambda}(\\omega) e^{i\\omega z/c} d\\omega$ is not $\\lambda(z)$. Let us do the integral directly.\nThe integral is $\\frac{\\sqrt{2\\pi} c}{\\sigma_z} \\exp(-\\frac{z^2}{2\\sigma_z^2})$.\n$$\nV_{\\text{wake}}(z) = \\frac{Q c^2 L_{k}}{2\\pi} \\frac{\\partial}{\\partial z} \\left( \\frac{\\sqrt{2\\pi} c}{\\sigma_z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) \\right)\n$$\n$$\nV_{\\text{wake}}(z) = \\frac{Q c^3 L_{k}}{\\sqrt{2\\pi}\\sigma_z} \\frac{\\partial}{\\partial z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) = \\frac{Q c^3 L_{k}}{\\sqrt{2\\pi}\\sigma_z} \\left(-\\frac{z}{\\sigma_z^2}\\right) \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right)\n$$\n$$\nV_{\\text{wake}}(z) = -\\frac{Q c^3 L_{k}}{\\sqrt{2\\pi}\\sigma_z^3} z \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right)\n$$\nThe energy deviation is $\\Delta\\mathcal{E}(z) = -e V_{\\text{wake}}(z)$.\nTo find $\\Delta\\mathcal{E}_{\\text{peak}}$, we first need $\\langle \\Delta\\mathcal{E} \\rangle = \\int_{-\\infty}^{\\infty} \\Delta\\mathcal{E}(z) \\lambda(z) dz$.\n$$\n\\langle \\Delta\\mathcal{E} \\rangle \\propto \\int_{-\\infty}^{\\infty} z \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) \\frac{1}{\\sigma_z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) dz \\propto \\int_{-\\infty}^{\\infty} z \\exp\\left(-\\frac{z^2}{\\sigma_z^2}\\right) dz\n$$\nThe integrand is an odd function of $z$, so the integral over a symmetric interval is zero. Thus, $\\langle \\Delta\\mathcal{E} \\rangle = 0$.\nThen $\\Delta\\mathcal{E}_{\\text{peak}} = \\max_z |\\Delta\\mathcal{E}(z)|$. We must find the maximum of $|z \\exp(-\\frac{z^2}{2\\sigma_z^2})|$.\nLet $f(z) = z \\exp(-\\frac{z^2}{2\\sigma_z^2})$. Differentiating with respect to $z$ and setting to zero:\n$$\n\\frac{df}{dz} = \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) + z \\left(-\\frac{z}{\\sigma_z^2}\\right) \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) = \\left(1 - \\frac{z^2}{\\sigma_z^2}\\right) \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) = 0\n$$\nThis gives $z_{max} = \\pm \\sigma_z$. The peak value of $|f(z)|$ is $|\\pm \\sigma_z \\exp(-(\\pm \\sigma_z)^2 / (2\\sigma_z^2))| = \\sigma_z \\exp(-1/2)$.\nSubstituting this into the expression for $|\\Delta\\mathcal{E}(z)|$:\n$$\n\\Delta\\mathcal{E}_{\\text{peak}} = \\left| -e \\left(-\\frac{Q c^3 L_{k}}{\\sqrt{2\\pi}\\sigma_z^3}\\right) (\\sigma_z \\exp(-1/2)) \\right| \\propto \\frac{\\sigma_z}{\\sigma_z^3} = \\frac{1}{\\sigma_z^2}\n$$\nSo, $\\Delta\\mathcal{E}_{\\text{peak}} \\sim \\sigma_z^{-2}$. This means $a_{\\text{ind}} = -2$.\n\n#### Case 2: Resistive-Wall Impedance, $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$\n\nFor the wake function to be a real-valued function of time/position, the impedance in the frequency domain must satisfy $Z_{\\parallel}(-\\omega) = Z_{\\parallel}^*(\\omega)$. The provided form $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$ is real for $\\omega0$. For the hermiticity condition to hold, $Z_{\\parallel}(\\omega)$ must be an even function, i.e., $Z_{\\parallel}(\\omega) = A|\\omega|^{-1/2}$. This form is singular at $\\omega = 0$, but the integral is regularized by the Gaussian spectrum of the bunch, which vanishes at $\\omega = 0$.\nThe wake voltage is:\n$$\nV_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} A |\\omega|^{-1/2} \\left(Q c \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega\n$$\nTo find the scaling with $\\sigma_z$, we perform a change of variables in the integral. Let $u = \\omega \\sigma_z / c$. Then $\\omega = u c / \\sigma_z$ and $d\\omega = (c/\\sigma_z) du$.\n$$\nV_{\\text{wake}}(z) = \\frac{A Q c}{2\\pi} \\int_{-\\infty}^{\\infty} \\left|\\frac{uc}{\\sigma_z}\\right|^{-1/2} \\exp\\left(-\\frac{u^2}{2}\\right) \\exp\\left(i u \\frac{z}{\\sigma_z}\\right) \\frac{c}{\\sigma_z} du\n$$\nWe group the terms dependent on $\\sigma_z$:\n$$\nV_{\\text{wake}}(z) = \\frac{A Q c}{2\\pi} \\left(\\frac{c}{\\sigma_z}\\right)^{-1/2} \\left(\\frac{c}{\\sigma_z}\\right) \\int_{-\\infty}^{\\infty} |u|^{-1/2} \\exp\\left(-\\frac{u^2}{2}\\right) \\exp\\left(i u \\frac{z}{\\sigma_z}\\right) du\n$$\n$$\nV_{\\text{wake}}(z) = \\frac{A Q c}{2\\pi} c^{1/2} \\sigma_z^{-1/2} \\int_{-\\infty}^{\\infty} |u|^{-1/2} \\exp\\left(-\\frac{u^2}{2}\\right) \\exp\\left(i u \\frac{z}{\\sigma_z}\\right) du\n$$\nThe integral is a function of the dimensionless variable $\\zeta = z/\\sigma_z$. Let's call it $G(\\zeta)$.\nSo, $V_{\\text{wake}}(z)$ has the form $V_{\\text{wake}}(z) = C_{\\text{rw}} \\sigma_z^{-1/2} G(z/\\sigma_z)$, where $C_{\\text{rw}}$ is a constant independent of $\\sigma_z$.\nThe energy deviation is $\\Delta\\mathcal{E}(z) = -e C_{\\text{rw}} \\sigma_z^{-1/2} G(z/\\sigma_z)$.\nNext, we compute the average energy deviation $\\langle\\Delta\\mathcal{E}\\rangle$:\n$$\n\\langle\\Delta\\mathcal{E}\\rangle = \\int_{-\\infty}^{\\infty} \\Delta\\mathcal{E}(z) \\lambda(z) dz = \\int_{-\\infty}^{\\infty} \\left(-e C_{\\text{rw}} \\sigma_z^{-1/2} G\\left(\\frac{z}{\\sigma_z}\\right)\\right) \\frac{1}{\\sqrt{2\\pi}\\sigma_z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) dz\n$$\nLet $y = z/\\sigma_z$, so $dz = \\sigma_z dy$.\n$$\n\\langle\\Delta\\mathcal{E}\\rangle = -e C_{\\text{rw}} \\sigma_z^{-1/2} \\int_{-\\infty}^{\\infty} G(y) \\frac{1}{\\sqrt{2\\pi}\\sigma_z} \\exp\\left(-\\frac{y^2}{2}\\right) \\sigma_z dy = -e C_{\\text{rw}} \\sigma_z^{-1/2} \\left( \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} G(y) e^{-y^2/2} dy \\right)\n$$\nThe integral in the parenthesis is a constant number, let's call it $\\langle G \\rangle$. So, $\\langle\\Delta\\mathcal{E}\\rangle \\propto \\sigma_z^{-1/2}$.\nThe peak energy spread is $\\Delta\\mathcal{E}_{\\text{peak}} = \\max_z |\\Delta\\mathcal{E}(z) - \\langle\\Delta\\mathcal{E}\\rangle|$.\n$$\n\\Delta\\mathcal{E}(z) - \\langle\\Delta\\mathcal{E}\\rangle = -e C_{\\text{rw}} \\sigma_z^{-1/2} G(z/\\sigma_z) - (-e C_{\\text{rw}} \\sigma_z^{-1/2} \\langle G \\rangle) = -e C_{\\text{rw}} \\sigma_z^{-1/2} \\left[ G(z/\\sigma_z) - \\langle G \\rangle \\right]\n$$\nThe peak value is found by maximizing the expression with respect to $z$:\n$$\n\\Delta\\mathcal{E}_{\\text{peak}} = \\left|-e C_{\\text{rw}} \\sigma_z^{-1/2}\\right| \\max_z \\left| G(z/\\sigma_z) - \\langle G \\rangle \\right|\n$$\nThe maximization is over the dimensionless variable $\\zeta = z/\\sigma_z$, so the result $\\max_\\zeta|G(\\zeta) - \\langle G \\rangle|$ is a constant number independent of $\\sigma_z$.\nTherefore, the scaling is determined entirely by the prefactor:\n$$\n\\Delta\\mathcal{E}_{\\text{peak}} \\sim \\sigma_z^{-1/2}\n$$\nThis gives the second exponent $a_{\\text{rw}} = -1/2$.\n\nThe two scaling exponents are $a_{\\text{ind}} = -2$ and $a_{\\text{rw}} = -1/2$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-2  -\\frac{1}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Our final practice extends the analysis from longitudinal effects to transverse wakefields, which are often the primary drivers of beam instabilities. In a perfectly symmetric structure, an on-axis beam does not generate these deflecting (dipole) wakes; they are driven by small machine imperfections like beam offset and tilt. This exercise demonstrates the power of linear response theory by having you derive the transverse wake to first order in misalignment parameters, verify it numerically, and apply the model to a practical engineering problem: the determination of machine alignment tolerances. ",
            "id": "3360436",
            "problem": "Consider a simplified but physically consistent eigenmode model for transverse wakefield computation in accelerator structures, formulated in normalized, dimensionless units. A perfectly conducting, cylindrically symmetric pillbox structure of radius $a$ and length $L$ supports transverse magnetic (TM) modes with azimuthal index $m$, radial index $n$, and axial index $p$. Work in a truncated eigenmode basis formed by the dipole family $m=1$, with radial wavenumbers $k_{r,n} = j_{1,n}/a$, where $j_{1,n}$ denotes the $n$-th positive root of the Bessel function of the first kind $J_1(\\cdot)$, and axial wavenumbers $k_{z,p} = p \\pi / L$ for integers $p \\ge 0$. The corresponding modal angular frequencies are $\\omega_{n,p} = \\sqrt{k_{r,n}^2 + k_{z,p}^2}$. Assume the speed of light is normalized to $c=1$, the structure radius is $a=1$, and an overall exponential damping factor $\\mathrm{e}^{-\\gamma s}$ with $\\gamma0$ models effective modal losses along the longitudinal separation $s \\ge 0$.\n\nAn ultra-relativistic point charge $q$ travels along a straight line within the structure with a small transverse misalignment in the $x$-direction parameterized by an offset $x_0$ and a small tilt angle $\\theta$ (in radians) so that the trajectory is $x(z) = x_0 + \\theta \\,(z - L/2)$ for $z \\in [0,L]$. The normalized, dimensionless transverse wake function $W_{\\perp}(s;x_0,\\theta)$ is defined here as the linear transverse kick per unit charge experienced at the structure axis by a trailing ultra-relativistic test particle at a longitudinal separation $s$. In this eigenmode model, take the exact, mode-truncated synthesis for $W_{\\perp}$ to be\n$$\nW_{\\perp}(s;x_0,\\theta) \\;=\\; \\sum_{n=1}^{N_r} \\sum_{p=0}^{N_z-1} \\; k_{r,n} \\,\\Bigg[ \\int_{0}^{L} J_1\\!\\big(k_{r,n}\\,x(z)\\big)\\,\\cos\\!\\big(k_{z,p}\\,z\\big)\\,dz \\Bigg] \\,\\cos\\!\\big(\\omega_{n,p}\\,s\\big)\\,\\mathrm{e}^{-\\gamma s},\n$$\nwith the normalization chosen for convenience so that an overall constant is unity, since the focus is on verifying first-order linearity with respect to $x_0$ and $\\theta$ rather than absolute calibration. This definition is sufficient to test the analytical first-order expansion and its numerical verification. All quantities are dimensionless; angles are in radians.\n\nTask 1 (First-order expansion from fundamentals): Starting from the linearity of Maxwell’s equations and the definition of the wake via mode orthogonality, use the small-argument expansion of $J_1(\\cdot)$ and the Panofsky–Wenzel relation $\\partial W_{\\perp}/\\partial s = \\nabla_{\\perp} W_{\\parallel}$ as the physical basis to justify that, for sufficiently small $x_0$ and $\\theta$, the transverse wake admits a first-order expansion\n$$\nW_{\\perp}(s;x_0,\\theta) \\;\\approx\\; x_0\\,K_0(s;L) \\;+\\; \\theta\\,K_1(s;L),\n$$\nwhere $K_0(s;L)$ and $K_1(s;L)$ are linear-response coefficients that depend on the geometry through $L$, the truncation parameters $N_r$ and $N_z$, and on $s$.\n\nTask 2 (Derive closed-form mode-sum expressions): Derive $K_0(s;L)$ and $K_1(s;L)$ explicitly in terms of the mode sums and the $z$-integrals of $\\cos(k_{z,p} z)$ and $(z - L/2)\\cos(k_{z,p} z)$ that arise at first order when expanding $J_1(k_{r,n} x(z))$ with $x(z)=x_0+\\theta\\,(z-L/2)$. Show how the axial integrals reduce to functions of $k_{z,p}$ and $L$ and identify which axial indices $p$ contribute to each coefficient.\n\nTask 3 (Numerical verification of linearity via perturbations): Implement a numerical procedure to compute $W_{\\perp}(s;x_0,\\theta)$ using the exact expression above (i.e., without small-argument approximation inside the integrand), with the $z$-integral evaluated numerically to high accuracy. Use central finite differences about $(x_0,\\theta)=(0,0)$ to approximate $\\partial W_{\\perp}/\\partial x_0$ and $\\partial W_{\\perp}/\\partial \\theta$, and verify that these match $K_0(s;L)$ and $K_1(s;L)$, respectively, to within a specified relative tolerance.\n\nTask 4 (Connecting to alignment tolerances): Given a maximum allowable magnitude of the normalized transverse wake $W_{\\max}$ at a chosen separation $s$, compute alignment tolerances by inverting the first-order model: with $\\theta=0$, compute the largest $|x_0|$ such that $|W_{\\perp}(s;x_0,0)| \\le W_{\\max}$, and with $x_0=0$, compute the largest $|\\theta|$ such that $|W_{\\perp}(s;0,\\theta)| \\le W_{\\max}$. Express both tolerances as dimensionless numbers (offset in the same normalized units as $x_0$, tilt in radians).\n\nNumerical specifications and test suite:\n- Use normalized parameters $a=1$, $c=1$, damping $\\gamma = 0.05$, radial mode count $N_r=6$, axial mode count $N_z=5$ (i.e., $p=0,1,2,3,4$).\n- Use central-difference perturbations $\\delta_x = 10^{-4}$ and $\\delta_{\\theta} = 10^{-4}$ (radians) to approximate derivatives numerically at $(x_0,\\theta)=(0,0)$.\n- Evaluate relative errors for each case as\n$$\n\\varepsilon_x \\;=\\; \\frac{\\big|K_0(s;L) - \\big(\\partial W_{\\perp}/\\partial x_0\\big)_{\\text{num}}\\big|}{\\max\\{10^{-14},\\,|K_0(s;L)|\\}},\\quad\n\\varepsilon_{\\theta} \\;=\\; \\frac{\\big|K_1(s;L) - \\big(\\partial W_{\\perp}/\\partial \\theta\\big)_{\\text{num}}\\big|}{\\max\\{10^{-14},\\,|K_1(s;L)|\\}}.\n$$\n- Declare the linearity check “pass” for a case if both $\\varepsilon_x$ and $\\varepsilon_{\\theta}$ are strictly less than $10^{-4}$.\n- Use the following test suite of $(L,s)$ pairs:\n  1. $(L,s)=(1,\\,0.2)$\n  2. $(L,s)=(1,\\,1)$\n  3. $(L,s)=(2,\\,1)$\n  4. $(L,s)=(1,\\,5)$\n- For the tolerance computation, set $W_{\\max} = 0.05$ and evaluate the tolerances at $(L,s)=(1,\\,1)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order:\n  - Four boolean values (one per test case) indicating whether the linearity check passed.\n  - The two alignment tolerances at $(L,s)=(1,\\,1)$: first the maximum $|x_0|$ when $\\theta=0$, then the maximum $|\\theta|$ when $x_0=0$.\n- For example, the output should look like $[{\\tt True},{\\tt True},{\\tt True},{\\tt True},x_{\\text{tol}},\\theta_{\\text{tol}}]$, where $x_{\\text{tol}}$ and $\\theta_{\\text{tol}}$ are decimal numbers. Angles are in radians; all other quantities are dimensionless in the normalized units defined above.",
            "solution": "The problem statement has been critically examined and is determined to be valid. It is scientifically grounded in the principles of computational electromagnetics and accelerator physics, self-contained with all necessary parameters provided, and well-posed, leading to a unique and verifiable solution. The tasks outlined are a logical progression from theoretical derivation to numerical verification and practical application.\n\nThe solution will proceed by addressing each of the four tasks sequentially.\n\n### Task 1: Justification of the First-Order Expansion\n\nThe transverse wake function $W_{\\perp}(s;x_0,\\theta)$ quantifies the transverse kick experienced by a test particle due to the fields generated by a source charge. These electromagnetic fields are governed by Maxwell's equations, which are linear. The source of these fields is the current distribution of the traversing charge, which moves along the trajectory $x(z) = x_0 + \\theta \\,(z - L/2)$. For small transverse offsets $x_0$ and small tilt angles $\\theta$, the source current can be expanded as a Taylor series around the central axis, $x=0$. Due to the linearity of the field equations, the resultant fields, and consequently the wake function, must also be expandable in a corresponding Taylor series with respect to the source coordinates $x_0$ and $\\theta$.\n\nFor a cylindrically symmetric structure, a charge moving perfectly along the axis ($x_0=0, \\theta=0$) cannot excite dipole ($m=1$) modes due to symmetry. Therefore, the dipole wake function must be zero for an on-axis source: $W_{\\perp}(s;0,0) = 0$. The Taylor expansion of $W_{\\perp}$ around $(x_0, \\theta)=(0,0)$ is thus given by:\n$$\nW_{\\perp}(s;x_0,\\theta) = W_{\\perp}(s;0,0) + x_0 \\frac{\\partial W_{\\perp}}{\\partial x_0}\\bigg|_{(0,0)} + \\theta \\frac{\\partial W_{\\perp}}{\\partial \\theta}\\bigg|_{(0,0)} + \\mathcal{O}(x_0^2, \\theta^2, x_0\\theta)\n$$\nSince $W_{\\perp}(s;0,0)=0$, for sufficiently small $x_0$ and $\\theta$, the wake is well-approximated by the first-order terms:\n$$\nW_{\\perp}(s;x_0,\\theta) \\approx x_0\\,K_0(s;L) + \\theta\\,K_1(s;L)\n$$\nwhere the linear-response coefficients are the partial derivatives evaluated at the origin:\n$$\nK_0(s;L) = \\frac{\\partial W_{\\perp}}{\\partial x_0}\\bigg|_{(0,0)} \\quad \\text{and} \\quad K_1(s;L) = \\frac{\\partial W_{\\perp}}{\\partial \\theta}\\bigg|_{(0,0)}\n$$\nThis linearity is a direct consequence of the physical principles embodied in linear field theory and is further supported by the Panofsky-Wenzel theorem, which relates the transverse wake to the gradient of the longitudinal wake.\n\nThis conclusion can also be reached directly from the provided mode-sum expression for $W_{\\perp}$. The dependence on the trajectory $x(z)$ is entirely contained within the argument of the Bessel function, $J_1(k_{r,n}x(z))$. For small arguments $u$, the Bessel function $J_1(u)$ has the leading-order expansion $J_1(u) \\approx u/2$. Given small $x_0$ and $\\theta$, the argument $k_{r,n}x(z)$ is small, and we can approximate:\n$$\nJ_1\\big(k_{r,n}\\,x(z)\\big) \\approx \\frac{1}{2} k_{r,n}\\,x(z) = \\frac{1}{2}k_{r,n}\\big(x_0 + \\theta(z-L/2)\\big)\n$$\nSubstituting this linear approximation into the integral for $W_{\\perp}$ directly yields an expression that is linear in $x_0$ and $\\theta$, confirming the structure $x_0\\,K_0(s;L) + \\theta\\,K_1(s;L)$.\n\n### Task 2: Derivation of Closed-Form Mode-Sum Expressions for $K_0$ and $K_1$\n\nUsing the first-order approximation $J_1(u) \\approx u/2$, we substitute it into the definition of $W_{\\perp}(s;x_0,\\theta)$:\n$$\nW_{\\perp} \\approx \\sum_{n=1}^{N_r} \\sum_{p=0}^{N_z-1} k_{r,n} \\left[ \\int_{0}^{L} \\frac{1}{2}k_{r,n}\\big(x_0 + \\theta(z-L/2)\\big) \\cos(k_{z,p}z) dz \\right] \\cos(\\omega_{n,p}s)e^{-\\gamma s}\n$$\nWe can separate the terms proportional to $x_0$ and $\\theta$:\n$$\nW_{\\perp} \\approx x_0 \\left( \\frac{e^{-\\gamma s}}{2} \\sum_{n,p} k_{r,n}^2 \\cos(\\omega_{n,p}s) \\int_0^L \\cos(k_{z,p}z) dz \\right) + \\theta \\left( \\frac{e^{-\\gamma s}}{2} \\sum_{n,p} k_{r,n}^2 \\cos(\\omega_{n,p}s) \\int_0^L (z-L/2)\\cos(k_{z,p}z) dz \\right)\n$$\nFrom this, we identify the expressions for $K_0(s;L)$ and $K_1(s;L)$ by evaluating the two axial integrals.\n\n**Integral for $K_0(s;L)$:**\nThe integral is $I_0(p,L) = \\int_0^L \\cos(k_{z,p}z)dz$, with $k_{z,p} = p\\pi/L$.\n- For $p=0$, $k_{z,0}=0$. The integrand is $\\cos(0)=1$, so $I_0(0,L) = \\int_0^L 1\\,dz = L$.\n- For $p  0$, the integral is $\\left[\\frac{\\sin(k_{z,p}z)}{k_{z,p}}\\right]_0^L = \\frac{\\sin(p\\pi)}{p\\pi/L} = 0$.\nThus, only the $p=0$ modes contribute to $K_0$. For $p=0$, the frequency is $\\omega_{n,0} = \\sqrt{k_{r,n}^2 + 0} = k_{r,n}$.\nSubstituting this into the expression for the coefficient of $x_0$:\n$$\nK_0(s;L) = \\frac{e^{-\\gamma s}}{2} \\sum_{n=1}^{N_r} k_{r,n}^2 \\cos(k_{r,n}s) \\cdot L = \\frac{L}{2}e^{-\\gamma s} \\sum_{n=1}^{N_r} k_{r,n}^2 \\cos(k_{r,n}s)\n$$\n\n**Integral for $K_1(s;L)$:**\nThe integral is $I_1(p,L) = \\int_0^L (z-L/2)\\cos(k_{z,p}z)dz$.\n- For $p=0$, $k_{z,0}=0$. The integrand is $(z-L/2)$, so $I_1(0,L) = \\int_0^L (z-L/2)dz = \\left[\\frac{z^2}{2} - \\frac{Lz}{2}\\right]_0^L = (\\frac{L^2}{2} - \\frac{L^2}{2}) - 0 = 0$.\n- For $p  0$, we integrate by parts with $u=z-L/2$ and $dv=\\cos(k_{z,p}z)dz$:\n$$\nI_1(p,L) = \\left[(z-L/2)\\frac{\\sin(k_{z,p}z)}{k_{z,p}}\\right]_0^L - \\int_0^L \\frac{\\sin(k_{z,p}z)}{k_{z,p}}dz\n$$\nThe boundary term is zero at both $z=0$ and $z=L$ (since $\\sin(0)=0$ and $\\sin(p\\pi)=0$). The remaining integral is:\n$$\n- \\frac{1}{k_{z,p}} \\left[-\\frac{\\cos(k_{z,p}z)}{k_{z,p}}\\right]_0^L = \\frac{1}{k_{z,p}^2} \\big(\\cos(p\\pi) - \\cos(0)\\big) = \\frac{(-1)^p - 1}{k_{z,p}^2}\n$$\nThis expression is zero for even $p  0$ and evaluates to $-2/k_{z,p}^2$ for odd $p$.\nTherefore, only odd axial modes ($p=1,3,5,...$) contribute to $K_1$.\nSubstituting this result into the expression for the coefficient of $\\theta$:\n$$\nK_1(s;L) = \\frac{e^{-\\gamma s}}{2} \\sum_{n=1}^{N_r} \\sum_{p=1,3,...}^{N_z-1} k_{r,n}^2 \\cos(\\omega_{n,p}s) \\left(\\frac{-2}{k_{z,p}^2}\\right)\n$$\n$$\nK_1(s;L) = -e^{-\\gamma s} \\sum_{n=1}^{N_r} \\sum_{p=1,3,...}^{N_z-1} \\frac{k_{r,n}^2}{k_{z,p}^2} \\cos(\\omega_{n,p}s)\n$$\n\n### Task 3: Numerical Verification of Linearity\n\nTo verify the derived analytical expressions for $K_0$ and $K_1$, we compare them against numerical derivatives of the full, non-approximated wake function $W_{\\perp}(s;x_0,\\theta)$. The numerical derivatives are computed using a second-order central finite difference scheme around the point $(x_0,\\theta)=(0,0)$:\n$$\n\\left(\\frac{\\partial W_{\\perp}}{\\partial x_0}\\right)_{\\text{num}} = \\frac{W_{\\perp}(s; \\delta_x, 0) - W_{\\perp}(s; -\\delta_x, 0)}{2\\delta_x}\n$$\n$$\n\\left(\\frac{\\partial W_{\\perp}}{\\partial \\theta}\\right)_{\\text{num}} = \\frac{W_{\\perp}(s; 0, \\delta_\\theta) - W_{\\perp}(s; 0, -\\delta_\\theta)}{2\\delta_\\theta}\n$$\nHere, $\\delta_x = 10^{-4}$ and $\\delta_\\theta = 10^{-4}$ are the small perturbations. The function $W_{\\perp}(s;x_0,\\theta)$ is computed by numerically integrating the exact expression provided in the problem statement for each mode $(n,p)$ and summing the contributions. High-accuracy numerical quadrature (such as `scipy.integrate.quad`) is used for the spatial integral over $z$.\n\nThe numerical derivatives are then compared to the analytical results $K_0(s;L)$ and $K_1(s;L)$ by calculating the relative errors $\\varepsilon_x$ and $\\varepsilon_{\\theta}$ as specified. The linearity check is successful (passes) if both relative errors are less than the tolerance of $10^{-4}$.\n\n### Task 4: Alignment Tolerance Calculation\n\nThe validated first-order model $W_{\\perp}(s;x_0,\\theta) \\approx x_0\\,K_0(s;L) + \\theta\\,K_1(s;L)$ can be inverted to determine alignment tolerances. Given a maximum tolerable wake magnitude $W_{\\max}$, we can find the maximum allowable offset $|x_0|$ (assuming zero tilt, $\\theta=0$) and the maximum allowable tilt $|\\theta|$ (assuming zero offset, $x_0=0$).\n\nFor the offset tolerance ($\\theta=0$):\n$$\n|W_{\\perp}(s;x_0,0)| \\le W_{\\max} \\implies |x_0 K_0(s;L)| \\le W_{\\max} \\implies |x_0| \\le \\frac{W_{\\max}}{|K_0(s;L)|}\n$$\nThe offset tolerance is $x_{\\text{tol}} = W_{\\max} / |K_0(s;L)|$.\n\nFor the tilt tolerance ($x_0=0$):\n$$\n|W_{\\perp}(s;0,\\theta)| \\le W_{\\max} \\implies |\\theta K_1(s;L)| \\le W_{\\max} \\implies |\\theta| \\le \\frac{W_{\\max}}{|K_1(s;L)|}\n$$\nThe tilt tolerance is $\\theta_{\\text{tol}} = W_{\\max} / |K_1(s;L)|$.\n\nThese calculations are performed for the specific case $(L,s)=(1,1)$ with $W_{\\max}=0.05$. The required values $K_0(1,1)$ and $K_1(1,1)$ are computed using the analytical formulas derived in Task 2.\n\nThe implementation details for all numerical computations are provided in the final answer code. This includes pre-computation of Bessel roots, calculation of mode parameters ($k_{r,n}, k_{z,p}, \\omega_{n,p}$), the numerical evaluation of $W_\\perp$, the computation of analytical coefficients, and the final tolerance calculation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import jn_zeros, j1\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the multi-part wakefield computation problem.\n    Task 1  2 are analytical derivations, implemented here.\n    Task 3 is numerical verification.\n    Task 4 is tolerance calculation.\n    \"\"\"\n\n    # Numerical specifications from the problem statement\n    a = 1.0\n    c = 1.0\n    gamma = 0.05\n    Nr = 6\n    Nz = 5\n    delta_x = 1e-4\n    delta_theta = 1e-4\n    rel_tol_threshold = 1e-4\n    W_max = 0.05\n\n    # Pre-compute Bessel roots and radial wavenumbers, which are geometry-independent\n    try:\n        # scipy.special.jn_zeros is the standard function for Bessel function roots\n        j1n_roots = jn_zeros(1, Nr)\n    except Exception as e:\n        # Fallback in case of environment issues, though unlikely.\n        # These are standard book values for J1(x)=0.\n        j1n_roots = np.array([3.83170597, 7.01558667, 10.17346814, 13.32369194, 16.47063005, 19.61585851])\n    \n    krn = j1n_roots / a\n    \n    # Use a class to manage L-dependent parameters to avoid recalculation\n    class PhysicsParameters:\n        def __init__(self, L):\n            self.L = L\n            self.p_indices = np.arange(Nz)\n            self.kzp = self.p_indices * np.pi / L\n            \n            # OMEGA_NP is a matrix of size (Nr, Nz)\n            self.omeganp = np.sqrt(np.add.outer(krn**2, self.kzp**2))\n\n    def compute_K0_analytical(s, L, params):\n        \"\"\"Computes the analytical coefficient K0 using the derived formula.\"\"\"\n        # Only p=0 mode contributes. For p=0, omeganp = krn.\n        omegan0 = params.omeganp[:, 0]\n        sum_terms = np.sum(krn**2 * np.cos(omegan0 * s))\n        K0 = (L / 2.0) * np.exp(-gamma * s) * sum_terms\n        return K0\n\n    def compute_K1_analytical(s, L, params):\n        \"\"\"Computes the analytical coefficient K1 using the derived formula.\"\"\"\n        K1 = 0.0\n        # Only odd p  0 modes contribute. For Nz=5, p can be 0,1,2,3,4.\n        p_odd_indices = [p for p in range(1, Nz) if p % 2 != 0] # p = 1, 3\n        \n        for p in p_odd_indices:\n            kzp_val = params.kzp[p]\n            omeganp_p_col = params.omeganp[:, p]\n            # Sum over n for the current odd p\n            sum_n = np.sum(krn**2 * np.cos(omeganp_p_col * s))\n            K1 += sum_n / kzp_val**2\n            \n        K1 *= -np.exp(-gamma * s)\n        return K1\n\n    def compute_W_perp(s, L, x0, theta, params):\n        \"\"\"Computes the full wake function W_perp via numerical integration.\"\"\"\n        total_wake = 0.0\n        \n        for n_idx in range(Nr):\n            for p_idx in range(Nz):\n                current_krn = krn[n_idx]\n                current_kzp = params.kzp[p_idx]\n                current_omeganp = params.omeganp[n_idx, p_idx]\n                \n                # Define the integrand for numerical quadrature\n                def integrand(z):\n                    x_of_z = x0 + theta * (z - L / 2.0)\n                    return j1(current_krn * x_of_z) * np.cos(current_kzp * z)\n                \n                integral_val, _ = quad(integrand, 0, L, epsabs=1e-12, epsrel=1e-12)\n                \n                mode_contribution = current_krn * integral_val * np.cos(current_omeganp * s)\n                total_wake += mode_contribution\n                \n        return total_wake * np.exp(-gamma * s)\n\n    # Main logic starts here\n    test_cases = [\n        (1.0, 0.2), # Case 1\n        (1.0, 1.0), # Case 2\n        (2.0, 1.0), # Case 3\n        (1.0, 5.0), # Case 4\n    ]\n    results = []\n    \n    # Task 3: Perform linearity check for all test cases\n    for L, s in test_cases:\n        params = PhysicsParameters(L)\n        \n        # Calculate analytical coefficients\n        K0_an = compute_K0_analytical(s, L, params)\n        K1_an = compute_K1_analytical(s, L, params)\n        \n        # Calculate numerical derivatives using central differences\n        W_plus_x = compute_W_perp(s, L, delta_x, 0.0, params)\n        W_minus_x = compute_W_perp(s, L, -delta_x, 0.0, params)\n        K0_num = (W_plus_x - W_minus_x) / (2 * delta_x)\n        \n        W_plus_theta = compute_W_perp(s, L, 0.0, delta_theta, params)\n        W_minus_theta = compute_W_perp(s, L, 0.0, -delta_theta, params)\n        K1_num = (W_plus_theta - W_minus_theta) / (2 * delta_theta)\n        \n        # Calculate relative errors as specified\n        err_x = abs(K0_an - K0_num) / max(1e-14, abs(K0_an))\n        err_theta = abs(K1_an - K1_num) / max(1e-14, abs(K1_an))\n        \n        # Check if both errors are below the threshold\n        passed = (err_x  rel_tol_threshold) and (err_theta  rel_tol_threshold)\n        results.append(passed)\n\n    # Task 4: Compute alignment tolerances at (L,s)=(1,1)\n    L_tol, s_tol = 1.0, 1.0\n    params_tol = PhysicsParameters(L_tol)\n    \n    # Calculate K0 and K1 at the specified point\n    K0_tol = compute_K0_analytical(s_tol, L_tol, params_tol)\n    K1_tol = compute_K1_analytical(s_tol, L_tol, params_tol)\n    \n    # Invert the linear model to find tolerances\n    x_tol = W_max / abs(K0_tol)\n    theta_tol = W_max / abs(K1_tol)\n    \n    results.append(x_tol)\n    results.append(theta_tol)\n\n    # Final print statement in the exact required format.\n    # str() converts booleans to 'True'/'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}