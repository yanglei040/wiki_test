## 引言
在现代[计算电磁学](@entry_id:265339)中，对复杂结构进行精确仿真往往需要求解由[麦克斯韦方程组](@entry_id:150940)离散化后产生的超大规模[线性系统](@entry_id:147850)。直接对这些[全阶模型](@entry_id:171001)进行分析，无论是[频域](@entry_id:160070)扫描还是[时域仿真](@entry_id:755983)，其计算成本都极为高昂，甚至常常超出工程实践所能承受的范围。因此，开发能够显著降低计算复杂度，同时保持高保真度的模型降阶（MOR）技术，已成为该领域的核心挑战之一。

在众多MOR方法中，Krylov[子空间方法](@entry_id:200957)因其高效性、精确性以及强大的理论基础而脱颖而出。它通过一种精巧的投影机制，从高维系统中提取出关键的动态信息，构建出一个维度极低的代理模型，从而将原本耗时数小时的仿真任务缩短至秒级甚至毫秒级。本文旨在系统性地介绍Krylov[子空间](@entry_id:150286)模型降阶技术，弥合其深奥理论与工程应用之间的鸿沟。

为实现这一目标，本文将分为三个核心部分展开。在**“原理与机制”**一章中，我们将深入剖析该方法的数学基础，揭示其如何通过[矩匹配](@entry_id:144382)实现精确逼近，并探讨如何保持模型的稳定性和无源性等物理属性。接下来，在**“应用与跨学科联系”**一章中，我们将通过丰富的实例，展示该技术在[频域分析](@entry_id:265642)、参数化设计、[时域仿真](@entry_id:755983)等领域的强大应用，并阐明其如何解决[趋肤效应](@entry_id:181505)建模、伪模抑制等实际工程难题。最后，**“动手实践”**部分将提供一系列指导性问题，引导读者亲手实现从误差评估到自适应模型构建的关键算法，将理论知识转化为实践能力。

## 原理与机制

在计算电磁学中，通过有限元等方法对[麦克斯韦方程组](@entry_id:150940)进行[空间离散化](@entry_id:172158)，通常会得到大规模的[线性时不变](@entry_id:276287)（LTI）系统。模型降阶（MOR）的目标是创建一个低维度的代理模型，该模型在计算上易于处理，同时能精确地再现原始系统在特定工作频率范围内的行为。Krylov[子空间方法](@entry_id:200957)是实现这一目标的一类强大而高效的工具。本章将深入探讨Krylov[子空间](@entry_id:150286)降阶的基本原理和核心机制，阐明其如何通过[矩匹配](@entry_id:144382)实现精确逼近，如何处理不同的系统结构，以及如何保证降阶模型的物理一致性。

### 投影框架与[矩匹配](@entry_id:144382)核心

模型降阶的根本思想是通过投影将高维状态空间压缩到低维[子空间](@entry_id:150286)。考虑一个由[微分代数方程](@entry_id:748394)（DAE）描述的[LTI系统](@entry_id:271946)：

$$
E \dot{x}(t) = A x(t) + B u(t) \\
y(t) = C x(t) + D u(t)
$$

其中，$x(t) \in \mathbb{C}^n$ 是状态向量，$n$ 可能非常大。$E, A \in \mathbb{C}^{n \times n}$ 是[系统矩阵](@entry_id:172230)，$B \in \mathbb{C}^{n \times p}$ 和 $C \in \mathbb{C}^{q \times n}$ 分别是输入和输出矩阵。该系统的频率响应由[传递函数](@entry_id:273897) $H(s) = C(A - sE)^{-1}B + D$ 描述。

投影降阶方法构建两个[投影矩阵](@entry_id:154479) $V, W \in \mathbb{C}^{n \times r}$（其中 $r \ll n$ 是降阶模型的维度），并定义降阶状态 $\hat{x}(t)$，使得原状态 $x(t) \approx V\hat{x}(t)$。通过要求残差 $E V \dot{\hat{x}}(t) - A V \hat{x}(t) - B u(t)$ 与测试[子空间](@entry_id:150286)（由 $W$ 的列[向量张成](@entry_id:152883)）正交，我们得到 **[Petrov-Galerkin](@entry_id:174072)** 投影框架下的降阶模型：

$$
\hat{E} \dot{\hat{x}}(t) = \hat{A} \hat{x}(t) + \hat{B} u(t) \\
\hat{y}(t) = \hat{C} \hat{x}(t) + \hat{D} u(t)
$$

其中，$\hat{E} = W^* E V$, $\hat{A} = W^* A V$, $\hat{B} = W^* B$, $\hat{C} = C V$, 以及 $\hat{D} = D$。其[传递函数](@entry_id:273897)为 $\hat{H}(s) = \hat{C}( \hat{A} - s\hat{E})^{-1}\hat{B} + \hat{D}$。当 $W=V$ 时，该投影称为 **Galerkin** 投影。

降阶模型质量的关键在于如何选择投影[子空间](@entry_id:150286)。一个高效的策略是确保降阶模型的[传递函数](@entry_id:273897) $\hat{H}(s)$ 在某个或某些感兴趣的频率点 $s_0$ 附近与原始模型的 $H(s)$ **行为**相匹配。这通过 **[矩匹配](@entry_id:144382)**（moment matching）实现。$H(s)$ 在 $s_0$ 处的 **矩** 是其关于 $(s-s_0)$ 的泰勒级数展开的系数。如果 $\hat{H}(s)$ 和 $H(s)$ 在 $s_0$ 处的前 $r$ 阶矩相同，即它们的[泰勒级数](@entry_id:147154)的前 $r$ 项相同，那么 $\hat{H}(s)$ 在 $s_0$ 附近是对 $H(s)$ 的一个高阶逼近。

为了理解矩与Krylov[子空间](@entry_id:150286)之间的联系，我们对 $H(s)$ 中的核心项，即 resolvent $(A - sE)^{-1}$，在 $s_0$ 处进行泰勒展开（假设 $A-s_0E$ 可逆）：

$$
(A - sE)^{-1} = \left( \sum_{k=0}^{\infty} (s-s_0)^k [(A-s_0E)^{-1}E]^k \right) (A-s_0E)^{-1}
$$

将此展开代入 $H(s)$ 的表达式，我们可以看到[传递函数](@entry_id:273897)的矩是由形如 $C [(A-s_0E)^{-1}E]^k (A-s_0E)^{-1} B$ 的项构成的。为了匹配前 $r$ 阶矩，投影[子空间](@entry_id:150286)（即 $V$ 的列空间）必须包含生成这些矩的向量。这些向量正是由矩阵 $M = (A-s_0E)^{-1}E$ 和起始向量（或块）$r_0 = (A-s_0E)^{-1}B$ 生成的Krylov序列。这便引出了 **有理Krylov[子空间](@entry_id:150286)** 的概念：

$$
\mathcal{K}_r(M, r_0) = \mathrm{span}\{r_0, M r_0, M^2 r_0, \dots, M^{r-1} r_0\}
$$

与此相对的是 **多项式Krylov[子空间](@entry_id:150286)**，它由矩阵 $M_p = A$（或 $E^{-1}A$）和向量 $r_p = B$ 生成。多项式Krylov[子空间](@entry_id:150286)本质上是在 $s=\infty$ 处进行[矩匹配](@entry_id:144382)。对于频率域分析，有理Krylov方法具有显著优势：它允许我们自由选择展开点 $s_0$，将模型的逼近能力集中在感兴趣的频率附近。此外，对于许多由麦克斯韦方程离散化得到的描述子系统，$E$ 矩阵可能是奇异的，这使得基于 $E^{-1}$ 的方法不可行。有理Krylov方法仅要求 $A-s_0E$ 可逆，从而优雅地绕开了这个问题。

### 逼近精度、收敛性与带宽

基于单点 $s_0$ 的[矩匹配](@entry_id:144382)本质上是一种泰勒逼近。根据[复分析](@entry_id:167282)的基本定理，函数在 $s_0$ 点的[泰勒级数](@entry_id:147154)仅在一个开放圆盘内收敛，该圆盘的半径由 $s_0$ 到函数最近的[奇点](@entry_id:137764)（对 $H(s)$ 而言即是极点）的距离决定。这意味着：

1.  **局部性**：[降阶模型](@entry_id:754172) $\hat{H}(s)$ 在展开点 $s_0$ 附近具有极高的精度。若匹配 $m$ 阶矩，则逼近误差满足 $H(s) - \hat{H}(s) = \mathcal{O}((s - s_0)^m)$。
2.  **收敛半径限制**：逼近质量会随着 $|s - s_0|$ 的增大而下降，并在接近[收敛圆盘](@entry_id:177284)边界时迅速恶化。

这个特性揭示了单点Krylov方法在宽带建模中的局限性。如果一个系统在很宽的频率范围内有多个重要的[谐振峰](@entry_id:271281)（对应于靠近虚轴的极点），那么在任何单一频率点 $s_0$ 展开都难以捕捉到远离该点的谐振行为。

为了克服这一限制，**多点Krylov方法** 应运而生。其策略是在感兴趣的频带内选择多个展开点（或称“插值点”、“位移”） $\{s_k\}_{k=1}^{m}$，然后在每个点匹配少量（例如 $r_k$ 阶）的矩，总阶数 $r = \sum r_k$ 保持不变。这种方法构建的是一个块有理Krylov[子空间](@entry_id:150286)，其[降阶模型](@entry_id:754172) $\hat{H}(s)$ 能够在整个频带内实现更均匀的逼近。

对比两种策略：
- **单点高阶**：将所有逼近能力（[高阶矩](@entry_id:266936)）集中于一点。适用于需要极高局部精度或系统响应平滑的场景。但随着阶数 $r$ 的增加，Krylov[基向量](@entry_id:199546)会变得越来越线性相关，导致数值不稳定。
- **多点低阶**：将逼近能力分散到频带内的多个关键点。对于具有多个分离[谐振峰](@entry_id:271281)的宽带系统，这种方法通常能以更低的阶数 $r$ 获得更小的全频带最大误差。通过在每个点使用较低的匹配阶数，[数值条件](@entry_id:136760)也更好。

在实践中，一种有效的策略是将位移 $s_k$ 放置在谐振峰附近。由于系统矩阵通常是实数，为了得到实值的降阶模型，非实数的位移必须以共轭对 $\{s_k, \overline{s_k}\}$ 的形式出现。

### 物理结构的保持

一个优秀的降阶模型不仅要精度高，还必须保持原系统的关键物理属性，如稳定性、[无源性](@entry_id:171773)和对称性。否则，仿真结果将是物理上无意义甚至错误的。

#### 稳定性的保持

系统的 **[渐近稳定性](@entry_id:149743)** 意味着其[传递函数](@entry_id:273897)的所有极点都在左半复平面，即对于任何初始扰动，系统状态最终会衰减至零。对于 $E \dot{x} = A x$ 形式的系统，稳定性由[矩阵束](@entry_id:751760) $(A, E)$ 的广义[特征值](@entry_id:154894)决定。

- **[Galerkin投影](@entry_id:145611)** ($W=V$) 在保持稳定性方面具有优越的性质。如果原始系统是耗散的（例如，$A$ 的对称部分 $A_S = (A+A^*)/2$ 是负定的），并且投影基于[能量内积](@entry_id:167297)（例如，使用 $E$-正交基），那么Galerkin降阶模型能自动继承稳定性。

- **[Petrov-Galerkin](@entry_id:174072)投影** ($W \neq V$) 则不具备这种固有保证。即使原始系统稳定，选择不当的测试[子空间](@entry_id:150286) $W$ 也可能导致[降阶模型](@entry_id:754172)不稳定。为了保证降阶模型的稳定性，必须满足一定的条件，即降阶后的[系统矩阵](@entry_id:172230)的对称部分 $\hat{A}_S = (\hat{A} + \hat{A}^*)/2$ 仍然是负定的。例如，考虑一个稳定的对角系统 $E = \mathrm{diag}(1, 2)$ 和 $A = \mathrm{diag}(-1, -3)$，如果选择试探基 $V = [1, 1]^T$ 和测试基 $W = [1, -2/5]^T$，计算得到的[降阶模型](@entry_id:754172)（一个标量系统）的[特征值](@entry_id:154894)为 $\hat{\lambda} = 1$，这是一个不稳定的结果。这警示我们，在使用非对称的[Petrov-Galerkin](@entry_id:174072)投影时必须格外小心。

#### [无源性](@entry_id:171773)的保持：PRIMA算法

**[无源性](@entry_id:171773)** 是指系统不会凭空产生能量。对于[LTI系统](@entry_id:271946)，这在[频域](@entry_id:160070)上等价于其[传递函数](@entry_id:273897) $H(s)$ 是一个 **正实** (Positive-Real, PR) 函数。正实函数的关键特性是它在右半复平面解析，并且其Hermitian部分 $H(s) + H(s)^*$ 在右半平面是半正定的。

许多物理系统，如[RLC电路](@entry_id:171534)网络，其控制方程具有特殊的结构，能天然保证[无源性](@entry_id:171773)。例如，通过修正[节点分析法](@entry_id:274889)(MNA)得到的RLC[网络模型](@entry_id:136956)中，矩阵 $E$ 是对称半正定的（包含电容和电感），而矩阵 $A$ 是对称半负定的（包含[电导](@entry_id:177131)）。

**无源降阶互联宏模型算法** (Passive Reduced-order Interconnect Macromodeling Algorithm, **PRIMA**) 是一种保证无源性得以保持的Krylov[子空间方法](@entry_id:200957)。其核心思想是采用一种特殊的[Galerkin投影](@entry_id:145611)，即 **[合同变换](@entry_id:154837)** (congruent transformation)，来构建降阶矩阵：

$$
\hat{E} = V^T E V, \quad \hat{A} = V^T A V
$$

当原始矩阵 $E$ 和 $A$ 分别为对称（半）正定和对称（半）负定时，[合同变换](@entry_id:154837)能保证降阶后的矩阵 $\hat{E}$ 和 $\hat{A}$ 也具有完全相同的对称性和（半）定性。因此，降阶模型继承了保证[无源性](@entry_id:171773)的[代数结构](@entry_id:137052)，从而其[传递函数](@entry_id:273897) $\hat{H}(s)$ 也必然是正实的。PRIMA的优雅之处在于它将物理属性的保持与数值降阶过程完美地结合在一起。

#### 对称性与互易性：Galerkin vs. [Petrov-Galerkin](@entry_id:174072)

除了稳定性和[无源性](@entry_id:171773)，**互易性**（reciprocity）也是电磁系统的一个重要属性。互易系统满足 $H(s)^T = H(s)$。在矩阵层面，这通常与系统算子的对称性相关。

- **结构化系统**：对于某些理想系统，如填充无损介质的PEC[谐振腔](@entry_id:274488)，其一阶离散形式为 $E\dot{x}=Ax$，其中 $E$ 是[对称正定](@entry_id:145886)的，而 $A$ 是 **斜对称** 的（$A^T = -A$）。这种结构导致系统的[特征值](@entry_id:154894)纯虚，代表了[能量守恒](@entry_id:140514)。在更一般的情况下，如果系统算子是关于[能量内积](@entry_id:167297) $E$ 自伴的（$A^T E = E A$）或斜伴的（$A^T E = -E A$），并且输入输出端口配对 ($C=B^T E$)，那么系统就具有对称结构。
- **[Galerkin投影](@entry_id:145611)的优势**：对于这类结构化系统，使用[Galerkin投影](@entry_id:145611)（$W=V$）能够有效保持其内在结构。例如，对于一个由[对称矩阵](@entry_id:143130) $E$ 和[斜对称矩阵](@entry_id:155998) $A$（即 $A^T=-A$）描述的无损系统，[Galerkin投影](@entry_id:145611)可以确保降阶后的矩阵 $\hat{A}=V^TAV$ 同样是斜对称的（$\hat{A}^T = (V^TAV)^T = V^T A^T V = V^T(-A)V = -\hat{A}$），从而在[降阶模型](@entry_id:754172)中保留[能量守恒](@entry_id:140514)特性。更一般地，对于关于特定[内积](@entry_id:158127)（如 $E$-[内积](@entry_id:158127)）具有自伴或斜伴结构的算子，选择合适的[Galerkin投影](@entry_id:145611)（如使用 $E$-正交基）是保持系统物理性质（如互易性）的关键。
- **[Petrov-Galerkin](@entry_id:174072)的必要性**：对于一般的非互易系统（例如，包含有损、各向异性或回旋材料），$A$ 不具备任何特殊对称性。此时，左右Krylov[子空间](@entry_id:150286)是完全不同的。为了同时匹配输入端和输出端的响应（即满足左右切向插值条件），必须分别构造试探[子空间](@entry_id:150286) $V$ 和测试[子空间](@entry_id:150286) $W$，即采用[Petrov-Galerkin](@entry_id:174072)投影。这种方法通常需要对[基向量](@entry_id:199546)进行双正交化（$W^T E V=I$），以确保[矩匹配](@entry_id:144382)性质。

### 算法实现与高级主题

#### [基向量](@entry_id:199546)的构造：短遞推 vs. 长遞推

构造Krylov[子空间](@entry_id:150286)标准基的算法核心是[正交化](@entry_id:149208)过程。一个**基本**的定理指出：
- 如果算子 $M$ 在某个[内积](@entry_id:158127)下是 **自伴** (self-adjoint, 或Hermitian) 的，那么就可以使用一个 **短遞推** 关系（如[Lanczos算法](@entry_id:148448)中的三项遞推）来生成一组正交基。
- 如果算子 $M$ 不是自伴的，则必须使用 **长遞推** 关系（如Arnoldi算法），即每个新生成的向量都需要与所有先前的[基向量](@entry_id:199546)进行正交化。

对于有理Krylov方法，算子为 $T_s = (A+sE)^{-1}E$。对于由[对称矩阵](@entry_id:143130) $A$ 和对称正定矩阵 $E$ 构成的系统，自然的[内积](@entry_id:158127)是 $E$-[内积](@entry_id:158127)，即 $\langle u, v \rangle_E = u^* E v$。在此[内积](@entry_id:158127)下，算子 $T_s$ 自伴的条件是 $s$ 为实数。

因此，当选择 **实数位移** $s \in \mathbb{R}$ 时，算子 $T_s$ 是 $E$-自伴的，可以使用高效的Lanczos型算法。当选择 **复数位移** $s \in \mathbb{C} \setminus \mathbb{R}$ 时，算子不再自伴，必须采用Arnoldi型算法，这会增加计算和存储成本。

#### 奇异描述子系统（DAEs）的处理

到目前为止，我们大多假设矩阵 $E$ 是可逆的，或者至少 $A-sE$ 对于我们关心的 $s$ 是可逆的。然而，在包含代数约束的系统中（例如， enforcing a divergence-free condition），$E$ 矩阵可能是 **奇异** 的。这类系统是[微分代数方程](@entry_id:748394)（DAEs），而不是[常微分方程](@entry_id:147024)（ODEs）。

处理DAEs的关键是理解其 **可解性指数** (tractability index)，记为 $\nu$。它表示需要对系统的[代数方程](@entry_id:272665)部分进行[微分](@entry_id:158718)多少次才能完全求解出所有[状态变量](@entry_id:138790)的导数。从代数上看，对于正则[矩阵束](@entry_id:751760) $(E,A)$，该指数等于其Weierstrass标准型中 nilpotent块 $N$ 的幂零指数。

Weierstrass标准型理论表明，通过等价变换，任何正则DAE系统都可以解耦为一个纯动态部分（ODE）和一个纯代数部分：
$$
\dot{z}_d(t) = J z_d(t) + \tilde{B}_d u(t) \quad \text{(动态部分)} \\
N \dot{z}_a(t) = z_a(t) + \tilde{B}_a u(t) \quad \text{(代数部分)}
$$
代数部分的状态变量 $z_a(t)$ 完全由输入 $u(t)$ 及其导数决定。

这对[模型降阶](@entry_id:171175)的意义在于，我们可以首先对系统进行 **“deflation”**，即分离出其动态核心。然后，Krylov[子空间方法](@entry_id:200957)仅应用于这个行为良好的、低维的ODE部分。例如，在求解有理Krylov[子空间的基](@entry_id:160685)向量时，我们只需要求解形如 $(\sigma I_d - J)v = \tilde{B}_d$ 的线性方程组，其中 $I_d, J, \tilde{B}_d$ 都是动态子系统的对应矩阵。这种方法为处理带有代数约束的复杂电磁系统提供了一条严谨且有效的途径。