{
    "hands_on_practices": [
        {
            "introduction": "The Born and Rytov approximations represent two distinct linearization strategies for the wave equation, each with its own domain of validity. In this first practice, we will construct a computational experiment to highlight a crucial difference in their performance, particularly in the presence of common measurement artifacts . You will design a scenario where a hypothetical, frequency-dependent calibration error causes the Born approximation to yield a non-physical result—negative absorption—while the Rytov approximation, when augmented by the physical principle of causality through the Kramers–Kronig relations, successfully diagnoses and corrects for this error, delivering a physically consistent reconstruction. This exercise demonstrates the robustness of phase-based methods and the power of enforcing fundamental physical constraints in inverse problems.",
            "id": "3290082",
            "problem": "Consider the scalar electromagnetic scattering of a monochromatic plane wave in a one-dimensional slab geometry governed by the scalar Helmholtz equation for the total field. Let the time-harmonic convention be $e^{-i\\omega t}$ and the scalar field be $u(x,\\omega)$ that satisfies\n$$\n\\frac{d^2 u}{dx^2} + k_0^2 n^2(\\omega)\\,u = 0,\n$$\nwhere $k_0 = \\omega/c$, $c$ is the speed of light in vacuum in $\\mathrm{m/s}$, and $n(\\omega)$ is the complex refractive index. Define a background refractive index $n_0 = \\sqrt{\\varepsilon_\\infty}$ with $\\varepsilon_\\infty > 0$ real, and a slab of thickness $L$ with causal, passive relative permittivity $\\varepsilon_r(\\omega)$ such that $\\operatorname{Im}\\{\\varepsilon_r(\\omega)\\} \\ge 0$ for all angular frequencies $\\omega$ in the band of interest (passivity). The complex refractive index is $n(\\omega) = \\sqrt{\\varepsilon_r(\\omega)}$ chosen on the principal branch with $\\operatorname{Im}\\{n(\\omega)\\} \\ge 0$. The incident field is a plane wave propagating in the $+x$ direction.\n\nDefine the transmitted field at $x=L$ normalized by the transmitted field through a background slab of the same thickness as\n$$\nd(\\omega) = \\exp\\big( i k_0 L\\,(n(\\omega) - n_0)\\big),\n$$\nwhich is the exact transmission ratio when internal reflections are negligible. In practice, instrumentation often introduces an unknown, frequency-dependent calibration gain $g(\\omega) > 0$ affecting the measured data, so the measured transmission ratio is\n$$\nd_{\\mathrm{meas}}(\\omega) = g(\\omega)\\,d(\\omega).\n$$\n\nWe wish to recover the complex contrast $\\Delta m(\\omega) = n(\\omega) - n_0 = \\Delta n(\\omega) + i\\,\\kappa(\\omega)$ from the measured data by linearized models. Two common linearizations are:\n\n1. The Born approximation (linearization of the field):\n$$\n\\Delta m_{\\mathrm{Born}}(\\omega) \\approx \\frac{d_{\\mathrm{meas}}(\\omega) - 1}{i\\,k_0\\,L}.\n$$\n\n2. The Rytov approximation (linearization of the complex logarithm of the field):\n$$\n\\psi(\\omega) = \\ln d_{\\mathrm{meas}}(\\omega), \\quad \\Delta m_{\\mathrm{Rytov}}(\\omega) \\approx \\frac{\\psi(\\omega)}{i\\,k_0\\,L}.\n$$\n\nDefine the absorption coefficient $\\alpha(\\omega)$ in units of $\\mathrm{m^{-1}}$ as\n$$\n\\alpha(\\omega) = 2\\,k_0\\,\\kappa(\\omega).\n$$\nPassivity requires $\\alpha(\\omega) \\ge 0$ for all $\\omega$.\n\nThe Kramers–Kronig relations (KK; named after Hendrik Anthony Kramers and Ralph Kronig) for minimum-phase transmission relate the phase $\\phi(\\omega) = \\arg d(\\omega)$ and the magnitude $A(\\omega) = |d(\\omega)|$ via a Hilbert transform. Under the assumptions of causality and minimum-phase, the following relation holds (up to an additive constant due to unknown absolute calibration gain):\n$$\n\\phi(\\omega) = -\\mathcal{H}\\left[\\ln A(\\omega)\\right](\\omega) + \\phi_0,\n$$\nwhere $\\mathcal{H}[\\cdot]$ denotes the Hilbert transform on the frequency axis, and $\\phi_0$ is a real constant. Equivalently,\n$$\n\\ln A(\\omega) = \\mathcal{H}\\left[\\phi(\\omega)\\right](\\omega) + \\ln A_0,\n$$\nwith a constant $\\ln A_0$ reflecting the unknown absolute gain.\n\nYou are to design a benchmark phantom (i.e., a frequency-dependent $\\varepsilon_r(\\omega)$ and measurement model with a calibration gain $g(\\omega)$) such that the Born approximation predicts non-physical negative absorption $\\alpha_{\\mathrm{Born}}(\\omega) < 0$ at some frequencies, while the Kramers–Kronig-consistent Rytov reconstruction does not. Use a physically-plausible Debye dispersion model for $\\varepsilon_r(\\omega)$:\n$$\n\\varepsilon_r(\\omega) = \\varepsilon_\\infty + \\frac{\\Delta\\varepsilon}{1 - i\\,\\omega\\,\\tau} + i\\,\\frac{\\sigma}{\\varepsilon_0\\,\\omega},\n$$\nwhere $\\varepsilon_0$ is the vacuum permittivity in $\\mathrm{F/m}$, $\\Delta\\varepsilon > 0$, $\\tau > 0$, and $\\sigma \\ge 0$. Choose parameters so that $\\operatorname{Im}\\{\\varepsilon_r(\\omega)\\} \\ge 0$ for all $\\omega$ in the band.\n\nTo stress the linearization, define a smooth, real calibration gain profile\n$$\ng(\\omega) = 1 + b\\,\\exp\\Big(-\\frac{(\\omega - \\omega_c)^2}{2\\,\\sigma_\\omega^2}\\Big),\n$$\nwith $b \\ge 0$, $\\omega_c$ in the band, and $\\sigma_\\omega > 0$. This calibration gain is not part of the physics and can lead to apparent violations of passivity under the Born linearization. The Rytov method should be used together with Kramers–Kronig consistency to diagnose and correct this calibration bias: reconstruct $\\ln A(\\omega)$ from the measured phase $\\phi_{\\mathrm{meas}}(\\omega) = \\arg d_{\\mathrm{meas}}(\\omega)$ using a discrete Hilbert transform on the sampled frequency axis, then choose the additive constant to enforce passivity, and form $\\psi(\\omega) = \\ln A_{\\mathrm{KK}}(\\omega) + i\\,\\phi_{\\mathrm{meas}}(\\omega)$ to obtain $\\Delta m_{\\mathrm{Rytov}}(\\omega)$ and hence $\\alpha_{\\mathrm{Rytov}}(\\omega)$.\n\nImplementation constraints:\n\n- Use angular frequency $\\omega$ in $\\mathrm{rad/s}$, slab thickness $L$ in $\\mathrm{m}$, and report absorption in $\\mathrm{m^{-1}}$.\n- Use angles in radians.\n- Construct a frequency grid that is uniformly sampled over a finite band $[\\omega_{\\min},\\omega_{\\max}]$. Apply a suitable windowing to the data before the discrete Hilbert transform to reduce edge artifacts, and account for the unknown additive constant in the Kramers–Kronig amplitude reconstruction by enforcing passivity $\\ln A(\\omega) \\le 0$.\n- Use $n(\\omega) = \\sqrt{\\varepsilon_r(\\omega)}$ with the principal branch of the complex square root.\n\nTest Suite:\n\nLet $c = 3.0\\times 10^8\\,\\mathrm{m/s}$, $\\varepsilon_\\infty = 2.25$, $\\Delta\\varepsilon = 0.75$, $\\tau = 1.0\\times 10^{-12}\\,\\mathrm{s}$, $\\sigma = 0$, $L = 0.01\\,\\mathrm{m}$, $\\omega_{\\min} = 1.0\\times 10^{13}\\,\\mathrm{rad/s}$, $\\omega_{\\max} = 3.0\\times 10^{14}\\,\\mathrm{rad/s}$, $\\omega_c = 1.5\\times 10^{14}\\,\\mathrm{rad/s}$, and $\\sigma_\\omega = 2.0\\times 10^{13}\\,\\mathrm{rad/s}$. Consider the following three calibration gains:\n- Case 1 (happy path): $b = 0.0$.\n- Case 2 (moderate bias): $b = 0.03$.\n- Case 3 (strong bias): $b = 0.08$.\n\nFor each case, compute\n$$\n\\alpha_{\\mathrm{Born}}(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\{\\Delta m_{\\mathrm{Born}}(\\omega)\\},\n\\quad\n\\alpha_{\\mathrm{Rytov}}(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\{\\Delta m_{\\mathrm{Rytov}}(\\omega)\\}.\n$$\nReturn, for each case, a boolean indicating whether there exists any $\\omega$ in the band such that $\\alpha_{\\mathrm{Born}}(\\omega) < 0$ and whether there exists any $\\omega$ such that $\\alpha_{\\mathrm{Rytov}}(\\omega) < 0$ after Kramers–Kronig amplitude reconstruction and passivity enforcement. Your program should produce a single line of output containing the six booleans for the three cases, in order and aggregated as a comma-separated list enclosed in square brackets (e.g., \"[b1,b2,b3,r1,r2,r3]\").",
            "solution": "The user has provided a valid, well-posed problem in computational electromagnetics. The task is to construct a numerical phantom to demonstrate a key difference between the Born and Rytov approximations for inverse scattering, particularly in the presence of measurement calibration errors. I will proceed with a full, reasoned solution.\n\nThe problem requires a comparison of two linearized models, the Born and Rytov approximations, for reconstructing the material properties of a slab from its transmission response. We are asked to design a scenario where the simpler Born approximation yields a non-physical result (negative absorption), while a more sophisticated approach combining the Rytov approximation with Kramers–Kronig (KK) consistency enforcement produces a physically valid result.\n\nThe solution proceeds in four main steps for each test case:\n1.  **Ground Truth Simulation**: We first compute the \"true\" physical quantities. The frequency-dependent relative permittivity $\\varepsilon_r(\\omega)$ is defined by the Debye model.\n    $$\n    \\varepsilon_r(\\omega) = \\varepsilon_\\infty + \\frac{\\Delta\\varepsilon}{1 - i\\,\\omega\\,\\tau}\n    $$\n    The term involving conductivity $\\sigma$ is omitted as $\\sigma=0$ is specified. The complex refractive index $n(\\omega)$ is then found using the principal branch of the square root, $n(\\omega) = \\sqrt{\\varepsilon_r(\\omega)}$, ensuring that the imaginary part is non-negative, $\\operatorname{Im}\\{n(\\omega)\\} \\ge 0$, which corresponds to a passive medium. The true single-pass transmission ratio $d(\\omega)$ through the slab of thickness $L$ is given by:\n    $$\n    d(\\omega) = \\exp\\big( i k_0 L\\,(n(\\omega) - n_0)\\big)\n    $$\n    where $k_0 = \\omega/c$ is the vacuum wavenumber and $n_0 = \\sqrt{\\varepsilon_\\infty}$ is the background refractive index.\n\n2.  **Measurement Model**: The simulated \"measured\" data, $d_{\\mathrm{meas}}(\\omega)$, includes a frequency-dependent real-valued calibration gain $g(\\omega) > 0$.\n    $$\n    g(\\omega) = 1 + b\\,\\exp\\Big(-\\frac{(\\omega - \\omega_c)^2}{2\\,\\sigma_\\omega^2}\\Big)\n    $$\n    $$\n    d_{\\mathrm{meas}}(\\omega) = g(\\omega)\\,d(\\omega)\n    $$\n    This gain corrupts the magnitude of the measurement, $|d_{\\mathrm{meas}}| = g(\\omega)|d(\\omega)|$, but leaves the phase unchanged, $\\arg(d_{\\mathrm{meas}}) = \\arg(d(\\omega))$, since $g(\\omega)$ is real and positive.\n\n3.  **Born Approximation Reconstruction**: The Born approximation linearizes the scattered field. The reconstructed material contrast $\\Delta m_{\\mathrm{Born}}(\\omega)$ and the corresponding absorption coefficient $\\alpha_{\\mathrm{Born}}(\\omega)$ are calculated from the measured data.\n    $$\n    \\Delta m_{\\mathrm{Born}}(\\omega) \\approx \\frac{d_{\\mathrm{meas}}(\\omega) - 1}{i\\,k_0\\,L}\n    $$\n    The absorption coefficient is $\\alpha(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\{\\Delta m(\\omega)\\}$. A careful derivation yields:\n    $$\n    \\alpha_{\\mathrm{Born}}(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\left\\{\\frac{d_{\\mathrm{meas}}(\\omega) - 1}{i\\,k_0\\,L}\\right\\} = \\frac{2}{L}\\left(1 - \\operatorname{Re}\\{d_{\\mathrm{meas}}(\\omega)\\}\\right) = \\frac{2}{L}\\left(1 - g(\\omega)\\operatorname{Re}\\{d(\\omega)\\}\\right)\n    $$\n    The term $\\operatorname{Re}\\{d(\\omega)\\}$ oscillates, and amplification by $g(\\omega) > 1$ can easily cause $g(\\omega)\\operatorname{Re}\\{d(\\omega)\\} > 1$, leading to the non-physical prediction of an active medium, $\\alpha_{\\mathrm{Born}}(\\omega) < 0$. This failure is exacerbated in this problem because the slab is electrically very thick (large $k_0 L$), which pushes the system far outside the regime of validity for the Born approximation.\n\n4.  **Kramers–Kronig-Consistent Rytov Reconstruction**: The Rytov approximation linearizes the complex phase (logarithm) of the field.\n    $$\n    \\Delta m_{\\mathrm{Rytov}}(\\omega) \\approx \\frac{\\ln d_{\\mathrm{meas}}(\\omega)}{i\\,k_0\\,L}\n    $$\n    The key insight is to not use $\\ln d_{\\mathrm{meas}}(\\omega)$ directly, as its real part, $\\ln|d_{\\mathrm{meas}}| = \\ln g(\\omega) + \\ln|d(\\omega)|$, is corrupted by the gain. Instead, we leverage the Kramers–Kronig relations, which connect the real and imaginary parts of the logarithm of a causal, minimum-phase function. The transmission function $d(\\omega)$ is such a function. Its phase, $\\phi(\\omega) = \\arg d(\\omega)$, is immune to the gain, i.e., $\\phi_{\\mathrm{meas}}(\\omega) = \\phi(\\omega)$. We can therefore reconstruct a physically consistent log-amplitude, $\\ln A_{\\mathrm{KK}}(\\omega)$, from the measured phase $\\phi_{\\mathrm{meas}}(\\omega)$ using the Hilbert transform:\n    $$\n    \\ln A_{\\mathrm{KK}}(\\omega) = \\mathcal{H}[\\phi_{\\mathrm{meas}}](\\omega) + C\n    $$\n    where $\\mathcal{H}[\\cdot]$ denotes the Hilbert transform and $C$ is a constant. The problem specifies numerically implementing the Hilbert transform on a finite frequency grid, for which we apply a Tukey window to $\\phi_{\\mathrm{meas}}$ to mitigate edge-effect artifacts. The constant $C$ is determined by enforcing the physical passivity constraint $\\alpha(\\omega) \\ge 0$. The Rytov-reconstructed absorption is:\n    $$\n    \\alpha_{\\mathrm{Rytov}}(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\left\\{\\frac{\\ln A_{\\mathrm{KK}}(\\omega) + i\\,\\phi_{\\mathrm{meas}}(\\omega)}{i\\,k_0\\,L}\\right\\} = -\\frac{2}{L}\\ln A_{\\mathrm{KK}}(\\omega)\n    $$\n    Passivity $\\alpha_{\\mathrm{Rytov}} \\ge 0$ implies $\\ln A_{\\mathrm{KK}}(\\omega) \\le 0$. We enforce this by setting the unknown constant $C$ such that the maximum value of the reconstructed log-amplitude is zero: $C = -\\max(\\mathcal{H}[\\phi_{\\mathrm{meas}}](\\omega))$. By this construction, $\\ln A_{\\mathrm{KK}}(\\omega) \\le 0$ for all $\\omega$, which guarantees that the reconstructed absorption coefficient $\\alpha_{\\mathrm{Rytov}}(\\omega)$ will be non-negative. This procedure diagnoses and corrects for the unknown frequency-dependent gain $g(\\omega)$, yielding a physically valid reconstruction.\n\nThe implementation will compute $\\alpha_{\\mathrm{Born}}(\\omega)$ and $\\alpha_{\\mathrm{Rytov}}(\\omega)$ for each test case and check if any values are negative. We expect the Born approximation to fail (predict $\\alpha < 0$) for all cases, while the KK-corrected Rytov method will succeed (maintain $\\alpha \\ge 0$) for all cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import hilbert\nfrom scipy.signal.windows import tukey\n\ndef solve():\n    \"\"\"\n    Solves the electromagnetics problem by comparing Born and Rytov approximations.\n\n    This function sets up a physical model of a dielectric slab, simulates a\n    \"measured\" transmission signal with a calibration gain, and then applies\n    two different reconstruction algorithms (Born and Rytov/Kramers-Kronig)\n    to recover the slab's absorption profile. It then checks each reconstruction\n    for a non-physical artifact (negative absorption).\n    \"\"\"\n\n    # Define physical constants and problem parameters from the statement.\n    c = 3.0e8  # Speed of light in vacuum, m/s\n    eps_inf = 2.25\n    delta_eps = 0.75\n    tau = 1.0e-12  # Debye relaxation time, s\n    sigma = 0.0  # Electrical conductivity, S/m\n    L = 0.01  # Slab thickness, m\n    w_min = 1.0e13  # Minimum angular frequency, rad/s\n    w_max = 3.0e14  # Maximum angular frequency, rad/s\n    w_c = 1.5e14  # Center frequency of gain profile, rad/s\n    sigma_w = 2.0e13  # Width of gain profile, rad/s\n\n    # Define the test cases for the calibration gain amplitude 'b'.\n    test_cases_b = [\n        0.0,   # Case 1: No calibration bias\n        0.03,  # Case 2: Moderate bias\n        0.08,  # Case 3: Strong bias\n    ]\n\n    # Set up the computational grid.\n    n0 = np.sqrt(eps_inf)\n    N = 4096  # Number of frequency points for high resolution.\n    omega = np.linspace(w_min, w_max, N)\n    k0 = omega / c\n\n    born_results = []\n    rytof_results = []\n\n    for b in test_cases_b:\n        # Step 1: Simulate the ground truth physics.\n        # Debye model for relative permittivity.\n        # The term with sigma is zero as per the problem statement.\n        eps_r = eps_inf + delta_eps / (1.0 - 1j * omega * tau)\n\n        # Complex refractive index (principal branch is default for np.sqrt).\n        n = np.sqrt(eps_r)\n\n        # Step 2: Simulate the measurement process.\n        # Ideal transmission ratio d(omega) neglecting internal reflections.\n        d = np.exp(1j * k0 * L * (n - n0))\n\n        # Frequency-dependent calibration gain g(omega).\n        g = 1.0 + b * np.exp(-((omega - w_c)**2) / (2.0 * sigma_w**2))\n\n        # \"Measured\" transmission ratio including the gain.\n        d_meas = g * d\n\n        # Step 3: Reconstruction using the Born approximation.\n        # The absorption coefficient from the Born model is alpha = (2/L)*(1 - Re{d_meas}).\n        alpha_born = (2.0 / L) * (1.0 - np.real(d_meas))\n        born_neg_alpha = np.any(alpha_born < 0)\n        born_results.append(born_neg_alpha)\n\n        # Step 4: Reconstruction using the Kramers-Kronig-consistent Rytov approximation.\n        # The measured phase is immune to the real-valued gain g > 0.\n        phi_meas = np.angle(d_meas)\n        \n        # Apply a Tukey window to the phase data to reduce spectral leakage artifacts\n        # in the discrete Hilbert transform (FFT-based).\n        win = tukey(N, alpha=0.25)\n        phi_windowed = phi_meas * win\n        \n        # Reconstruct log-amplitude via the discrete Hilbert transform of the phase.\n        # ln(A) = H[phi]. The imaginary part of scipy's hilbert() is the transform.\n        ln_A_KK_raw = np.imag(hilbert(phi_windowed))\n\n        # Enforce passivity (alpha >= 0, which implies ln(A) <= 0) by shifting\n        # the reconstructed log-amplitude so its maximum is 0.\n        ln_A_KK = ln_A_KK_raw - np.max(ln_A_KK_raw)\n        \n        # Calculate the Rytov absorption coefficient from the KK-reconstructed amplitude.\n        # alpha = -(2/L)*ln(A_KK).\n        alpha_rytof = (-2.0 / L) * ln_A_KK\n\n        # Check for non-physical negative absorption. By construction, we expect\n        # alpha_rytof >= 0, so this should be False barring numerical noise.\n        rytof_neg_alpha = np.any(alpha_rytof < 0)\n        rytof_results.append(rytof_neg_alpha)\n\n    # Aggregate results in the specified order: [b1, b2, b3, r1, r2, r3].\n    final_results = born_results + rytof_results\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "The first-order Born approximation simplifies the complex reality of wave propagation by considering only single scattering events. Its failure in many practical scenarios stems from neglecting multiple scattering—the process where a wave scatters sequentially off multiple parts of an object before reaching a detector. This exercise provides a clear and intuitive model to explore this phenomenon by analyzing the interaction between two simple point scatterers . You will derive and compute not only the first-order Born field but also the second-order cross-scattering term, which explicitly models the wave traveling from one scatterer to the other. By quantifying how this interaction term alters the final interference pattern, you will gain a concrete understanding of how multiple scattering leads to the breakdown of the Born approximation.",
            "id": "3290130",
            "problem": "You are to study multiple scattering and coherent interaction between two identical point scatterers in the scalar time-harmonic Helmholtz setting and quantify the onset of breakdown of the Born approximation observed via an interference pattern on a detector line. Start from the scalar Helmholtz equation in two spatial dimensions for the total field $E(\\mathbf{r})$,\n$$\n\\nabla^2 E(\\mathbf{r}) + k_0^2 \\bigl(1 + \\chi(\\mathbf{r})\\bigr) E(\\mathbf{r}) = 0,\n$$\nwhere $k_0 = 2\\pi/\\lambda$ is the free-space wavenumber for wavelength $\\lambda$, and $\\chi(\\mathbf{r})$ is a dimensionless scattering contrast. The associated Lippmann–Schwinger integral equation is\n$$\nE(\\mathbf{r}) = E_{\\mathrm{inc}}(\\mathbf{r}) + k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\chi(\\mathbf{r}') E(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}',\n$$\nwhere $E_{\\mathrm{inc}}(\\mathbf{r})$ is the incident field and $G(\\mathbf{r},\\mathbf{r}')$ is the two-dimensional free-space Green's function defined by\n$$\nG(\\mathbf{r},\\mathbf{r}') = \\frac{i}{4} H_0^{(1)}\\!\\big(k_0 \\lVert \\mathbf{r}-\\mathbf{r}' \\rVert\\big),\n$$\nwith $H_0^{(1)}$ the Hankel function of the first kind of order zero. Consider two identical point scatterers with contrast $\\chi_0$ located at $\\mathbf{r}_1 = (-d/2,0)$ and $\\mathbf{r}_2 = (d/2,0)$, so that the contrast distribution is\n$$\n\\chi(\\mathbf{r}) = \\chi_0 \\delta(\\mathbf{r}-\\mathbf{r}_1) + \\chi_0 \\delta(\\mathbf{r}-\\mathbf{r}_2).\n$$\nAssume a plane wave incident field propagating along the $x$-axis, $E_{\\mathrm{inc}}(\\mathbf{r}) = e^{i k_0 x}$. The first-order Born approximation replaces $E(\\mathbf{r}')$ by $E_{\\mathrm{inc}}(\\mathbf{r}')$ in the Lippmann–Schwinger integral. The second-order Born term arises when $E(\\mathbf{r}')$ is replaced in the integrand by its first-order Born field, producing a double integral term. Using the distributional representation of $\\chi(\\mathbf{r})$, the double integral simplifies to a discrete sum. In this setting, you must model coherent interaction between the two scatterers by retaining only the cross-scattering terms, that is, terms proportional to $G(\\mathbf{r}_1,\\mathbf{r}_2)$ or $G(\\mathbf{r}_2,\\mathbf{r}_1)$, and neglect self-interaction terms $G(\\mathbf{r}_j,\\mathbf{r}_j)$ to avoid singular self-terms in the point-scatterer model. This corresponds to the usual principal value interpretation that excludes self-energy in multiple scattering approximations.\n\nYour tasks are:\n- Derive expressions for the first-order Born scattered field $E^{(1)}(\\mathbf{r})$ and the second-order Born cross-scattering field $E^{(2)}_{\\mathrm{cross}}(\\mathbf{r})$ on a detector line at $y=L$ as functions of the observation coordinate $x$ and the separation $d$, using the two-dimensional Green's function defined above.\n- Show how the second-order Born cross term encodes coherent interaction through $G(\\mathbf{r}_1,\\mathbf{r}_2)$ as $d$ varies.\n- Design a quantitative, interference-based indicator that detects the onset of Born breakdown: define the detector intensity under the first-order Born model,\n$$\nI_1(x) = \\big\\lvert E^{(1)}(x,L)\\big\\rvert^2,\n$$\nand the intensity with first and second-order cross terms included,\n$$\nI_{12}(x) = \\big\\lvert E^{(1)}(x,L) + E^{(2)}_{\\mathrm{cross}}(x,L)\\big\\rvert^2.\n$$\nDefine the maximum fractional deviation\n$$\nR = \\frac{\\max_{x\\in[-X_{\\max},X_{\\max}]} \\big\\lvert I_{12}(x) - I_1(x)\\big\\rvert}{\\max_{x\\in[-X_{\\max},X_{\\max}]} I_1(x)},\n$$\nwhich is a unitless decimal. This indicator reflects the strength of coherent multiple scattering relative to the first-order Born prediction. You will compute $R$ for several parameter sets and thereby design an experiment that detects the onset of Born breakdown as $d$ varies and as $\\chi_0$ increases, using the criterion that larger $R$ indicates stronger departure from the first-order Born interference pattern.\n\nPhysical units and numerical conventions:\n- All lengths ($\\lambda$, $d$, $L$, $X_{\\max}$) are to be specified in meters (m).\n- The angle of incidence is measured in radians; here it is $0$ radians along the $x$-axis.\n- The output $R$ is unitless and must be expressed as a decimal.\n\nImplement a complete, runnable program that:\n- Uses the two-dimensional Green’s function $G(\\mathbf{r},\\mathbf{r}')$ as given above.\n- Computes $E^{(1)}(x,L)$ and $E^{(2)}_{\\mathrm{cross}}(x,L)$ for an array of detector points $x$ uniformly spanning $\\left[-X_{\\max},X_{\\max}\\right]$ with $N_x$ points.\n- Computes the indicator $R$ defined above for each test case listed below.\n- Produces a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\left[0.12345,0.06789\\right]$.\n\nTest suite:\n- Case $1$: $\\lambda = 0.5$ m, $\\chi_0 = 0.05$, $d = 0.05$ m, $L = 2.0$ m, $X_{\\max} = 1.0$ m, $N_x = 1001$.\n- Case $2$: $\\lambda = 0.5$ m, $\\chi_0 = 0.20$, $d = 0.05$ m, $L = 2.0$ m, $X_{\\max} = 1.0$ m, $N_x = 1001$.\n- Case $3$: $\\lambda = 0.5$ m, $\\chi_0 = 0.05$, $d = 0.5$ m, $L = 2.0$ m, $X_{\\max} = 1.0$ m, $N_x = 1001$.\n- Case $4$: $\\lambda = 0.5$ m, $\\chi_0 = 0.05$, $d = 5.0$ m, $L = 2.0$ m, $X_{\\max} = 1.0$ m, $N_x = 1001$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the cases listed above, for example, $\\left[r_1,r_2,r_3,r_4\\right]$, where each $r_j$ is the computed decimal value of $R$ for Case $j$.",
            "solution": "The problem requires an analysis of multiple scattering between two point scatterers in two dimensions using the Born series expansion of the Lippmann-Schwinger integral equation. The objective is to derive the first-order and second-order (cross-term only) scattered fields, and then use these to construct a quantitative indicator, $R$, that measures the deviation from the first-order Born approximation. This indicator will be computed for several parameter sets.\n\nThe analysis begins with the time-harmonic scalar Helmholtz equation for the total field $E(\\mathbf{r})$ in a medium with scattering contrast $\\chi(\\mathbf{r})$:\n$$\n\\nabla^2 E(\\mathbf{r}) + k_0^2 \\bigl(1 + \\chi(\\mathbf{r})\\bigr) E(\\mathbf{r}) = 0,\n$$\nwhere $k_0 = 2\\pi/\\lambda$ is the free-space wavenumber. This differential equation can be reformulated as the Lippmann-Schwinger integral equation:\n$$\nE(\\mathbf{r}) = E_{\\mathrm{inc}}(\\mathbf{r}) + k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\chi(\\mathbf{r}') E(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}',\n$$\nwhere $E_{\\mathrm{inc}}(\\mathbf{r})$ is the incident field and $G(\\mathbf{r},\\mathbf{r}')$ is the free-space Green's function. In two dimensions, $G(\\mathbf{r},\\mathbf{r}') = \\frac{i}{4} H_0^{(1)}\\!\\big(k_0 \\lVert \\mathbf{r}-\\mathbf{r}' \\rVert\\big)$, where $H_0^{(1)}$ is the Hankel function of the first kind of order zero.\n\nThe problem considers two identical point scatterers of strength $\\chi_0$ located at $\\mathbf{r}_1 = (-d/2, 0)$ and $\\mathbf{r}_2 = (d/2, 0)$. The scattering contrast is thus modeled by a sum of Dirac delta functions:\n$$\n\\chi(\\mathbf{r}) = \\chi_0 \\delta(\\mathbf{r}-\\mathbf{r}_1) + \\chi_0 \\delta(\\mathbf{r}-\\mathbf{r}_2).\n$$\nThe incident field is a plane wave propagating along the $x$-axis, $E_{\\mathrm{inc}}(\\mathbf{r}) = e^{i k_0 x}$.\n\n**Derivation of the First-Order Born Scattered Field, $E^{(1)}(\\mathbf{r})$**\n\nThe first-order Born approximation, $E^{(1)}(\\mathbf{r})$, is found by replacing the total field $E(\\mathbf{r}')$ inside the integral with the incident field $E_{\\mathrm{inc}}(\\mathbf{r}')$. This represents single scattering events.\n$$\nE^{(1)}(\\mathbf{r}) = k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\chi(\\mathbf{r}') E_{\\mathrm{inc}}(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}'.\n$$\nSubstituting the expression for $\\chi(\\mathbf{r}')$ and using the sifting property of the delta function, we get:\n$$\nE^{(1)}(\\mathbf{r}) = k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\left[ \\chi_0 \\delta(\\mathbf{r}'-\\mathbf{r}_1) + \\chi_0 \\delta(\\mathbf{r}'-\\mathbf{r}_2) \\right] E_{\\mathrm{inc}}(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}' \\\\\n= k_0^2 \\chi_0 \\left[ G(\\mathbf{r},\\mathbf{r}_1) E_{\\mathrm{inc}}(\\mathbf{r}_1) + G(\\mathbf{r},\\mathbf{r}_2) E_{\\mathrm{inc}}(\\mathbf{r}_2) \\right].\n$$\nThe incident field values at the scatterer locations are $E_{\\mathrm{inc}}(\\mathbf{r}_1) = e^{i k_0 (-d/2)} = e^{-i k_0 d/2}$ and $E_{\\mathrm{inc}}(\\mathbf{r}_2) = e^{i k_0 (d/2)} = e^{i k_0 d/2}$. Thus, the first-order scattered field is:\n$$\nE^{(1)}(\\mathbf{r}) = k_0^2 \\chi_0 \\left[ G(\\mathbf{r},\\mathbf{r}_1) e^{-i k_0 d/2} + G(\\mathbf{r},\\mathbf{r}_2) e^{i k_0 d/2} \\right].\n$$\n\n**Derivation of the Second-Order Born Cross-Scattering Field, $E^{(2)}_{\\mathrm{cross}}(\\mathbf{r})$**\n\nThe second-order Born term, $E^{(2)}(\\mathbf{r})$, is obtained by using the first-order scattered field $E^{(1)}(\\mathbf{r}')$ in the Lippmann-Schwinger integral. This accounts for double scattering events.\n$$\nE^{(2)}(\\mathbf{r}) = k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\chi(\\mathbf{r}') E^{(1)}(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}'.\n$$\nSubstituting the integral form of $E^{(1)}(\\mathbf{r}')$ gives a double integral:\n$$\nE^{(2)}(\\mathbf{r}) = (k_0^2)^2 \\iint G(\\mathbf{r}, \\mathbf{r}') \\chi(\\mathbf{r}') G(\\mathbf{r}',\\mathbf{r}'') \\chi(\\mathbf{r}'') E_{\\mathrm{inc}}(\\mathbf{r}'') \\,\\mathrm{d}\\mathbf{r}'' \\mathrm{d}\\mathbf{r}'.\n$$\nUsing the delta-function model for $\\chi$ resolves the integrals into a discrete sum over the scatterer indices $j,k \\in \\{1,2\\}$:\n$$\nE^{(2)}(\\mathbf{r}) = (k_0^2 \\chi_0)^2 \\sum_{j=1}^{2} \\sum_{k=1}^{2} G(\\mathbf{r},\\mathbf{r}_j) G(\\mathbf{r}_j,\\mathbf{r}_k) E_{\\mathrm{inc}}(\\mathbf{r}_k).\n$$\nThe problem specifies to retain only the cross-scattering terms, where $j \\neq k$. This is a standard procedure to avoid the non-physical singularities associated with a point scatterer's self-interaction (the $G(\\mathbf{r}_j,\\mathbf{r}_j)$ terms). This corresponds to wave propagation from scatterer $k$ to scatterer $j$ and then to the observer. The cross-scattering field is therefore:\n$$\nE^{(2)}_{\\mathrm{cross}}(\\mathbf{r}) = (k_0^2 \\chi_0)^2 \\left[ G(\\mathbf{r},\\mathbf{r}_1) G(\\mathbf{r}_1,\\mathbf{r}_2) E_{\\mathrm{inc}}(\\mathbf{r}_2) + G(\\mathbf{r},\\mathbf{r}_2) G(\\mathbf{r}_2,\\mathbf{r}_1) E_{\\mathrm{inc}}(\\mathbf{r}_1) \\right].\n$$\nUsing the reciprocity of the Green's function, $G(\\mathbf{r}_1,\\mathbf{r}_2) = G(\\mathbf{r}_2,\\mathbf{r}_1) = \\frac{i}{4} H_0^{(1)}(k_0 d)$, and the incident field values, we get:\n$$\nE^{(2)}_{\\mathrm{cross}}(\\mathbf{r}) = (k_0^2 \\chi_0)^2 G(\\mathbf{r}_1,\\mathbf{r}_2) \\left[ G(\\mathbf{r},\\mathbf{r}_1) e^{i k_0 d/2} + G(\\mathbf{r},\\mathbf{r}_2) e^{-i k_0 d/2} \\right].\n$$\nThis term explicitly contains the factor $G(\\mathbf{r}_1,\\mathbf{r}_2)$, which mediates the coherent interaction between the two scatterers. Its magnitude depends on the separation $d$.\n\n**Final Expressions and Quantitative Indicator**\n\nFor numerical computation, we evaluate the fields at an observation point $\\mathbf{r} = (x, L)$ on the detector line. Let $G_j(x,L) = G((x,L), \\mathbf{r}_j)$. The required fields are:\n$$\nE^{(1)}(x,L) = k_0^2 \\chi_0 \\left[ G_1(x,L) e^{-i k_0 d/2} + G_2(x,L) e^{i k_0 d/2} \\right]\n$$\n$$\nE^{(2)}_{\\mathrm{cross}}(x,L) = (k_0^2 \\chi_0)^2 G(\\mathbf{r}_1,\\mathbf{r}_2) \\left[ G_1(x,L) e^{i k_0 d/2} + G_2(x,L) e^{-i k_0 d/2} \\right]\n$$\nwhere\n$G_1(x,L) = \\frac{i}{4} H_0^{(1)}\\!\\left(k_0 \\sqrt{(x+d/2)^2 + L^2}\\right)$,\n$G_2(x,L) = \\frac{i}{4} H_0^{(1)}\\!\\left(k_0 \\sqrt{(x-d/2)^2 + L^2}\\right)$,\nand $G(\\mathbf{r}_1,\\mathbf{r}_2) = \\frac{i}{4} H_0^{(1)}(k_0 d)$.\n\nThe intensities are calculated as $I_1(x) = \\big\\lvert E^{(1)}(x,L)\\big\\rvert^2$ and $I_{12}(x) = \\big\\lvert E^{(1)}(x,L) + E^{(2)}_{\\mathrm{cross}}(x,L)\\big\\rvert^2$. The indicator $R$ measures the maximum fractional change in the intensity pattern due to the inclusion of the second-order multiple scattering term:\n$$\nR = \\frac{\\max_{x\\in[-X_{\\max},X_{\\max}]} \\big\\lvert I_{12}(x) - I_1(x)\\big\\rvert}{\\max_{x\\in[-X_{\\max},X_{\\max}]} I_1(x)}.\n$$\n\n**Numerical Strategy**\n\nThe computation proceeds by first defining the grid of $N_x$ points for $x$ in $[-X_{\\max}, X_{\\max}]$. Then, for each parameter set $(\\lambda, \\chi_0, d, L, X_{\\max})$:\n1.  Calculate the wavenumber $k_0 = 2\\pi/\\lambda$.\n2.  Compute the arguments of the Hankel functions for $G_1$, $G_2$, and $G(\\mathbf{r}_1,\\mathbf{r}_2)$ as NumPy arrays.\n3.  Evaluate the Green's functions using `scipy.special.hankel1`.\n4.  Assemble the complex-valued fields $E^{(1)}(x,L)$ and $E^{(2)}_{\\mathrm{cross}}(x,L)$ vectorially over the $x$-grid.\n5.  Calculate the intensities $I_1(x)$ and $I_{12}(x)$.\n6.  Find the maximum values required for the numerator and denominator of $R$ and compute their ratio.\nThis procedure is repeated for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import special\n\ndef solve():\n    \"\"\"\n    Computes the Born breakdown indicator R for a series of test cases\n    in a 2D scalar multiple scattering problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (lambda (m), chi_0, d (m), L (m), X_max (m), N_x)\n    test_cases = [\n        (0.5, 0.05, 0.05, 2.0, 1.0, 1001),\n        (0.5, 0.20, 0.05, 2.0, 1.0, 1001),\n        (0.5, 0.05, 0.5, 2.0, 1.0, 1001),\n        (0.5, 0.05, 5.0, 2.0, 1.0, 1001),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        lambda_val, chi_0, d, L, X_max, N_x = case\n\n        # --- Initial Setup ---\n        # Free-space wavenumber\n        k_0 = 2.0 * np.pi / lambda_val\n        \n        # Detector coordinates\n        x_coords = np.linspace(-X_max, X_max, N_x)\n\n        # --- Green's Function Components ---\n        # Distances from each scatterer to the detector points\n        dist_1 = np.sqrt((x_coords + d / 2.0)**2 + L**2)\n        dist_2 = np.sqrt((x_coords - d / 2.0)**2 + L**2)\n\n        # Green's functions from scatterers to detector points\n        # G_j(x, L) = (i/4) * H_0^(1) (k_0 * ||r - r_j||)\n        G_1 = (1j / 4.0) * special.hankel1(0, k_0 * dist_1)\n        G_2 = (1j / 4.0) * special.hankel1(0, k_0 * dist_2)\n\n        # --- Field Calculations ---\n        # Incident field phase factors at the scatterer locations\n        # E_inc(r_1) = exp(-i*k_0*d/2) and E_inc(r_2) = exp(i*k_0*d/2)\n        phase_inc_at_r1 = np.exp(-1j * k_0 * d / 2.0)\n        phase_inc_at_r2 = np.exp(1j * k_0 * d / 2.0)\n\n        # --- First-Order Born Scattered Field E^(1) ---\n        # E^(1) = k_0^2 * chi_0 * [G_1 * E_inc(r_1) + G_2 * E_inc(r_2)]\n        E1_field = (k_0**2 * chi_0) * (G_1 * phase_inc_at_r1 + G_2 * phase_inc_at_r2)\n\n        # --- Second-Order Cross-Scattering Field E^(2)_cross ---\n        # Green's function between scatterers G(r_1, r_2)\n        # The argument is k_0 * ||r_1 - r_2|| = k_0 * d\n        G_12 = (1j / 4.0) * special.hankel1(0, k_0 * d)\n        \n        # E^(2)_cross = (k_0^2 * chi_0)^2 * G_12 * [G_1 * E_inc(r_2) + G_2 * E_inc(r_1)]\n        # Note the swapped phase factors corresponding to the interaction path\n        E2_cross_field = ((k_0**2 * chi_0)**2) * G_12 * (G_1 * phase_inc_at_r2 + G_2 * phase_inc_at_r1)\n\n        # --- Intensity Calculations ---\n        # I_1 = |E^(1)|^2\n        I_1 = np.abs(E1_field)**2\n        # I_12 = |E^(1) + E^(2)_cross|^2\n        I_12 = np.abs(E1_field + E2_cross_field)**2\n\n        # --- Quantitative Indicator R ---\n        # R = max|I_12 - I_1| / max|I_1|\n        numerator = np.max(np.abs(I_12 - I_1))\n        denominator = np.max(I_1)\n        \n        if denominator == 0:\n            # This case is physically unexpected for this problem setup.\n            # If max I_1 is 0, the first-order field is null everywhere.\n            # Assign inf if numerator is non-zero, otherwise 0.\n            R = np.inf if numerator > 0 else 0.0\n        else:\n            R = numerator / denominator\n        \n        results.append(R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Having seen the limitations of the first-order Born approximation, a natural next step is to develop inversion strategies that can account for multiple scattering without resorting to fully nonlinear, computationally expensive methods. This practice introduces an elegant and powerful approach using a Padé approximant—a type of rational function—to create a surrogate forward model that more accurately captures the nonlinear relationship between the object and the scattered field . You will implement an iterative inversion scheme that freezes this improved model at a reference estimate, thereby preserving the efficiency of linear solvers. This exercise demonstrates a practical and widely applicable technique for extending the reach of linear inversion frameworks into moderately strong scattering regimes.",
            "id": "3290106",
            "problem": "Consider a discrete one-dimensional scattering model consistent with the Lippmann–Schwinger integral equation used in computational electromagnetics. Let there be $N$ spatial cells indexing the object region, and define the unknown complex-valued contrast vector $\\chi \\in \\mathbb{C}^N$. Denote the incident field by $E_{\\text{inc}} \\in \\mathbb{C}^N$, the internal propagation operator by $K \\in \\mathbb{C}^{N \\times N}$, and the measurement operator by $M \\in \\mathbb{C}^{N \\times N}$. The total field inside the object region is defined by the linear system\n$$\n\\left(I - K \\operatorname{diag}(\\chi)\\right) E_{\\text{tot}} = E_{\\text{inc}},\n$$\nwhere $I$ is the identity matrix and $\\operatorname{diag}(\\chi)$ denotes the diagonal matrix with the entries of $\\chi$. The measured scattered data are given by\n$$\ny = M \\operatorname{diag}(\\chi) E_{\\text{tot}} \\in \\mathbb{C}^N.\n$$\nThis model reduces to the first-order Born approximation when the contrast is sufficiently weak, namely $E_{\\text{tot}} \\approx E_{\\text{inc}}$, which yields the linear map\n$$\ny \\approx M \\operatorname{diag}(E_{\\text{inc}})\\, \\chi.\n$$\n\nFor moderate multiple scattering, a rational surrogate can be used to partially resum the Born series. Consider the Padé-like approximant of the forward operator\n$$\nA(\\chi) \\approx A_1 \\chi \\left(I - A_2 \\chi\\right)^{-1},\n$$\nwhere, in the discrete model here, $A_1$ and $A_2$ inherit structure from $M$, $K$, and $E_{\\text{inc}}$. To retain linear-inversion workflows, freeze the resolvent at a reference contrast $\\chi_{\\text{ref}}$ and use\n$$\nE_{\\text{ref}} = \\left(I - K \\operatorname{diag}(\\chi_{\\text{ref}})\\right)^{-1} E_{\\text{inc}},\n$$\nyielding the linearized rational surrogate\n$$\ny \\approx M \\operatorname{diag}(E_{\\text{ref}})\\, \\chi.\n$$\nThis can be solved by standard linear least squares with Tikhonov regularization. Specifically, given a linear operator $B \\in \\mathbb{C}^{N \\times N}$ and data $y \\in \\mathbb{C}^N$, the Tikhonov-regularized least squares estimate of $\\chi$ is\n$$\n\\hat{\\chi} = \\arg\\min_{\\chi \\in \\mathbb{C}^N} \\left\\| y - B \\chi \\right\\|_2^2 + \\lambda \\left\\| \\chi \\right\\|_2^2,\n$$\nwhose normal equations lead to\n$$\n\\hat{\\chi} = \\left(B^* B + \\lambda I\\right)^{-1} B^* y,\n$$\nwhere $(\\cdot)^*$ denotes the conjugate transpose.\n\nYour task is to implement this inversion pipeline and test whether the rational surrogate captures moderate multiple scattering while retaining linear-inversion workflows. Use a purely discrete, dimensionless setting:\n\n1. Spatial discretization: $N = 32$ cells, indexed by $i = 0,1,\\dots,31$.\n2. Incident field: a unit-magnitude complex plane wave $E_{\\text{inc}}[i] = \\exp\\left(\\mathrm{i}\\, k_0\\, i\\right)$, where $k_0$ is a real wavenumber. The angle argument of the complex exponential must be in radians.\n3. Internal propagation operator:\n$$\nK[i,j] = \\frac{\\exp\\left(\\mathrm{i}\\, k_0\\, |i - j|\\right) \\exp\\left(-\\alpha\\, |i - j|\\right)}{c_K},\n$$\nwith decay parameter $\\alpha > 0$ and scaling $c_K > 0$.\n4. Measurement operator:\n$$\nM[i,j] = \\frac{\\exp\\left(\\mathrm{i}\\, k_0\\, |i - j|\\right) \\exp\\left(-\\alpha\\, |i - j|\\right)}{c_M},\n$$\nwith the same $k_0$ and $\\alpha$, and scaling $c_M > 0$.\n5. True contrast: a real-valued Gaussian profile centered at $i_0 = 16$ with width $\\sigma = 4$ cells and amplitude $a$,\n$$\n\\chi_{\\text{true}}[i] = a \\cdot \\exp\\left(-\\frac{(i - i_0)^2}{2 \\sigma^2}\\right).\n$$\n\nDefine three test cases to probe different scattering regimes by varying only the amplitude $a$ while keeping the other parameters fixed:\n\n- Test case 1 (weak scattering): $a = 0.05$.\n- Test case 2 (moderate scattering): $a = 0.15$.\n- Test case 3 (stronger but stable scattering): $a = 0.25$.\n\nFixed parameters for all test cases:\n- Wavenumber $k_0 = 0.6$ radians.\n- Decay $\\alpha = 0.3$.\n- Internal scaling $c_K = 4.0$.\n- Measurement scaling $c_M = 5.0$.\n- Tikhonov regularization parameter $\\lambda = 10^{-3}$.\n\nAlgorithm to implement for each test case:\n1. Simulate the exact data by solving the discrete total field:\n   - Compute $E_{\\text{tot}}$ from $\\left(I - K \\operatorname{diag}(\\chi_{\\text{true}})\\right) E_{\\text{tot}} = E_{\\text{inc}}$.\n   - Compute $y_{\\text{true}} = M \\operatorname{diag}(\\chi_{\\text{true}}) E_{\\text{tot}}$.\n2. Born linear inversion:\n   - Define $B_0 = M \\operatorname{diag}(E_{\\text{inc}})$.\n   - Compute $\\hat{\\chi}_{\\text{Born}} = \\left(B_0^* B_0 + \\lambda I\\right)^{-1} B_0^* y_{\\text{true}}$.\n3. Padé-linear inversion using a frozen resolvent:\n   - Compute $E_{\\text{ref}} = \\left(I - K \\operatorname{diag}(\\hat{\\chi}_{\\text{Born}})\\right)^{-1} E_{\\text{inc}}$.\n   - Define $B_{\\text{ref}} = M \\operatorname{diag}(E_{\\text{ref}})$.\n   - Compute $\\hat{\\chi}_{\\text{Padé}} = \\left(B_{\\text{ref}}^* B_{\\text{ref}} + \\lambda I\\right)^{-1} B_{\\text{ref}}^* y_{\\text{true}}$.\n4. Evaluate forward consistency:\n   - Compute $y_{\\text{Born}}$ by simulating the exact forward model with $\\hat{\\chi}_{\\text{Born}}$.\n   - Compute $y_{\\text{Padé}}$ by simulating the exact forward model with $\\hat{\\chi}_{\\text{Padé}}$.\n   - Compute the ratio\n     $$\n     r = \\frac{\\left\\|y_{\\text{true}} - y_{\\text{Padé}}\\right\\|_2}{\\left\\|y_{\\text{true}} - y_{\\text{Born}}\\right\\|_2},\n     $$\n     which is a real-valued float. Values $r < 1$ indicate that the rational surrogate improved the match to the exact data compared to the pure Born inversion.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the three test cases, for example, \"[r1,r2,r3]\".\n- All numbers are dimensionless and angles must be treated in radians. Express each $r$ as a floating-point number; no percentage signs are permitted.",
            "solution": "The posed problem requires a comparison between two linear inversion techniques for a nonlinear scattering problem, modeled by a discrete Lippmann–Schwinger equation. The first technique is the standard first-order Born approximation, and the second is a Padé-like rational surrogate that is linearized by freezing the resolvent at a reference contrast. The goal is to quantify the improvement offered by the rational surrogate, particularly in moderate to strong scattering regimes.\n\n### 1. The Forward Model: Discrete Lippmann–Schwinger Equation\n\nThe physical system describes wave scattering. An incident field, $E_{\\text{inc}} \\in \\mathbb{C}^N$, illuminates an object defined by a complex-valued contrast, $\\chi \\in \\mathbb{C}^N$, discretized over $N$ spatial cells. The interaction of the field with the object induces secondary sources. The total field, $E_{\\text{tot}} \\in \\mathbb{C}^N$, within the object is the sum of the incident field and the field radiated by these induced sources. This self-consistent relationship is captured by the Lippmann–Schwinger equation, which in its discrete form is:\n$$\nE_{\\text{tot}} = E_{\\text{inc}} + K \\operatorname{diag}(\\chi) E_{\\text{tot}}\n$$\nHere, $K \\in \\mathbb{C}^{N \\times N}$ is the internal propagation operator (a discrete Green's function), and $\\operatorname{diag}(\\chi)$ is the diagonal matrix formed from the contrast vector $\\chi$. This equation can be rearranged to form a linear system for $E_{\\text{tot}}$:\n$$\n\\left(I - K \\operatorname{diag}(\\chi)\\right) E_{\\text{tot}} = E_{\\text{inc}}\n$$\nwhere $I$ is the identity matrix. The term $\\left(I - K \\operatorname{diag}(\\chi)\\right)^{-1}$ is the resolvent operator, which accounts for all orders of multiple scattering within the object.\n\nOnce the total internal field is known, the scattered field measured externally, $y \\in \\mathbb{C}^N$, is found by propagating the induced sources, $\\operatorname{diag}(\\chi) E_{\\text{tot}}$, to the measurement locations via a measurement operator $M \\in \\mathbb{C}^{N \\times N}$:\n$$\ny = M \\operatorname{diag}(\\chi) E_{\\text{tot}}\n$$\nThis complete forward model, mapping $\\chi \\to y$, is nonlinear because $E_{\\text{tot}}$ depends on $\\chi$. The core of the inverse problem is to estimate $\\chi$ given measurements $y$.\n\n### 2. Linear Inversion Strategies\n\nDirectly inverting the nonlinear model is computationally intensive. The problem explores two linear approximations.\n\n#### a. First-Order Born Approximation\nFor weak scatterers ($\\|\\chi\\| \\ll 1$), one can approximate the total field by the incident field, $E_{\\text{tot}} \\approx E_{\\text{inc}}$. This neglects multiple scattering. This approximation linearizes the forward model:\n$$\ny \\approx M \\operatorname{diag}(E_{\\text{inc}}) \\chi = B_0 \\chi\n$$\nThe operator $B_0 = M \\operatorname{diag}(E_{\\text{inc}})$ is the Born operator. The inverse problem is now a linear one.\n\n#### b. Linearized Rational Surrogate (Padé-Linear)\nThe Born approximation is the first term of an infinite series (the Born series). For stronger scattering, this approximation fails. A rational function, or Padé approximant, can often better represent the full series. To maintain a linear inversion workflow, the problem uses a \"frozen resolvent\" technique. This is a two-step iterative refinement:\n1.  Obtain an initial estimate of the contrast, $\\chi_{\\text{ref}}$. A natural choice is the result from the simpler Born inversion, $\\hat{\\chi}_{\\text{Born}}$.\n2.  Use this reference contrast to compute an improved estimate of the total field, $E_{\\text{ref}}$, which now includes multiple scattering effects attributable to $\\chi_{\\text{ref}}$:\n    $$\n    E_{\\text{ref}} = \\left(I - K \\operatorname{diag}(\\chi_{\\text{ref}})\\right)^{-1} E_{\\text{inc}}\n    $$\n3.  Linearize the forward model around this improved field, $E_{\\text{tot}} \\approx E_{\\text{ref}}$:\n    $$\n    y \\approx M \\operatorname{diag}(E_{\\text{ref}}) \\chi = B_{\\text{ref}} \\chi\n    $$\nThe updated linear operator is $B_{\\text{ref}} = M \\operatorname{diag}(E_{\\text{ref}})$. This new linear model is expected to be more accurate than the Born model, as $E_{\\text{ref}}$ is a better approximation to the true total field than $E_{\\text{inc}}$ is.\n\n### 3. Tikhonov-Regularized Inversion\n\nFor a given linear model $y \\approx B\\chi$, the inverse problem is typically ill-posed. Tikhonov regularization is employed to find a stable solution by penalizing the norm of the solution vector. The regularized least-squares problem is:\n$$\n\\hat{\\chi} = \\arg\\min_{\\chi \\in \\mathbb{C}^N} \\left\\| y - B \\chi \\right\\|_2^2 + \\lambda \\left\\| \\chi \\right\\|_2^2\n$$\nwhere $\\lambda > 0$ is the regularization parameter. The solution is found by solving the associated normal equations:\n$$\n\\hat{\\chi} = \\left(B^* B + \\lambda I\\right)^{-1} B^* y\n$$\nwhere $B^*$ is the conjugate transpose of $B$.\n\n### 4. Algorithmic Implementation and Evaluation\n\nFor each test case, defined by the contrast amplitude $a$, the following procedure is implemented:\n1.  **Construct Model Parameters:** The spatial grid, incident field $E_{\\text{inc}}$, operators $K$ and $M$, and the true contrast profile $\\chi_{\\text{true}}[i] = a \\cdot \\exp\\left(-\\frac{(i - i_0)^2}{2 \\sigma^2}\\right)$ are constructed using the given parameters: $N=32$, $k_0=0.6$, $\\alpha=0.3$, $c_K=4.0$, $c_M=5.0$, $i_0=16$, $\\sigma=4$.\n2.  **Simulate \"True\" Data:** The exact scattered data $y_{\\text{true}}$ are generated by solving the full nonlinear forward model for $\\chi_{\\text{true}}$. This involves solving the linear system $\\left(I - K \\operatorname{diag}(\\chi_{\\text{true}})\\right) E_{\\text{tot}} = E_{\\text{inc}}$ for $E_{\\text{tot}}$ and then computing $y_{\\text{true}} = M \\operatorname{diag}(\\chi_{\\text{true}}) E_{\\text{tot}}$.\n3.  **Perform Inversions:**\n    - **Born:** The estimate $\\hat{\\chi}_{\\text{Born}}$ is computed by solving the Tikhonov normal equations with the operator $B_0 = M \\operatorname{diag}(E_{\\text{inc}})$ and data $y_{\\text{true}}$.\n    - **Padé-Linear:** The estimate $\\hat{\\chi}_{\\text{Padé}}$ is computed by first calculating $E_{\\text{ref}}$ using $\\chi_{\\text{ref}} = \\hat{\\chi}_{\\text{Born}}$, then forming $B_{\\text{ref}} = M \\operatorname{diag}(E_{\\text{ref}})$, and solving the Tikhonov normal equations with this new operator.\n4.  **Evaluate Consistency:** The quality of each reconstruction is judged by its \"forward consistency.\" The data that would be produced by each estimate, $y_{\\text{Born}}$ (from $\\hat{\\chi}_{\\text{Born}}$) and $y_{\\text{Padé}}$ (from $\\hat{\\chi}_{\\text{Padé}}$), are simulated using the *exact nonlinear forward model*. The ratio of the L2-norm differences between these simulated data and the true data is then calculated:\n    $$\n    r = \\frac{\\left\\|y_{\\text{true}} - y_{\\text{Padé}}\\right\\|_2}{\\left\\|y_{\\text{true}} - y_{\\text{Born}}\\right\\|_2}\n    $$\n    A value of $r < 1$ signifies that the Padé-linear inversion yields a contrast estimate that is more consistent with the full physical model than the Born inversion estimate. This ratio is calculated for each of the three contrast amplitudes ($a = 0.05, 0.15, 0.25$).",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and compares Born and Padé-linear inversions for a 1D scattering problem.\n    \"\"\"\n\n    # --- Fixed Parameters ---\n    N = 32\n    k0 = 0.6\n    alpha = 0.3\n    cK = 4.0\n    cM = 5.0\n    lambda_reg = 1e-3\n    i0 = 16\n    sigma = 4\n\n    # --- Test cases for contrast amplitude 'a' ---\n    test_cases_a = [0.05, 0.15, 0.25]\n    results = []\n\n    # --- Construct shared operators and fields ---\n    i_grid = np.arange(N)\n    I = np.identity(N, dtype=np.complex128)\n    \n    # Incident field E_inc [vector of size N]\n    E_inc = np.exp(1j * k0 * i_grid)\n    \n    # Internal propagation (K) and measurement (M) operators [NxN matrices]\n    dist_matrix = np.abs(i_grid[:, np.newaxis] - i_grid)\n    common_term = np.exp(1j * k0 * dist_matrix) * np.exp(-alpha * dist_matrix)\n    K = common_term / cK\n    M = common_term / cM\n\n    def forward_model(chi_vec):\n        \"\"\"\n        Computes the scattered data 'y' for a given contrast 'chi'\n        using the full nonlinear model.\n        \"\"\"\n        # Element-wise product is equivalent to diag(chi) @ vector\n        # This check is for numerical stability, though not expected to fail here.\n        if np.linalg.norm(chi_vec) == 0:\n            return np.zeros(N, dtype=np.complex128)\n        \n        A_fwd = I - K @ np.diag(chi_vec)\n        E_tot_fwd = np.linalg.solve(A_fwd, E_inc)\n        y_fwd = M @ (chi_vec * E_tot_fwd)\n        return y_fwd\n\n    for a in test_cases_a:\n        # 1. Simulate Exact Data (y_true)\n        # True contrast chi_true [vector of size N]\n        chi_true = a * np.exp(-(i_grid - i0)**2 / (2 * sigma**2))\n        chi_true = chi_true.astype(np.complex128)\n        \n        y_true = forward_model(chi_true)\n\n        # 2. Born Linear Inversion\n        # B0 = M @ diag(E_inc). Broadcasting is more efficient: B0[i,j] = M[i,j] * E_inc[j]\n        B0 = M * E_inc\n        B0_H = B0.conj().T\n        \n        lhs_born = B0_H @ B0 + lambda_reg * I\n        rhs_born = B0_H @ y_true\n        chi_hat_born = np.linalg.solve(lhs_born, rhs_born)\n\n        # 3. Padé-Linear Inversion using a Frozen Resolvent\n        # Use chi_hat_born as the reference contrast\n        chi_ref = chi_hat_born\n        \n        # Compute the reference field E_ref\n        A_ref = I - K @ np.diag(chi_ref)\n        E_ref = np.linalg.solve(A_ref, E_inc)\n        \n        # Define the new operator B_ref and solve for chi_hat_pade\n        # B_ref = M @ diag(E_ref). Broadcasting: B_ref[i,j] = M[i,j] * E_ref[j]\n        B_ref = M * E_ref\n        B_ref_H = B_ref.conj().T\n        \n        lhs_pade = B_ref_H @ B_ref + lambda_reg * I\n        rhs_pade = B_ref_H @ y_true\n        chi_hat_pade = np.linalg.solve(lhs_pade, rhs_pade)\n\n        # 4. Evaluate Forward Consistency\n        # Simulate data from the reconstructed contrasts using the full model\n        y_born_fwd = forward_model(chi_hat_born)\n        y_pade_fwd = forward_model(chi_hat_pade)\n        \n        # Compute L2-norm of the residuals\n        err_born = np.linalg.norm(y_true - y_born_fwd)\n        err_pade = np.linalg.norm(y_true - y_pade_fwd)\n        \n        # Calculate the improvement ratio 'r'\n        # Handle potential division by zero\n        if err_born == 0:\n            ratio = 1.0 if err_pade == 0 else np.inf\n        else:\n            ratio = err_pade / err_born\n            \n        results.append(ratio)\n\n    # Final output formatting\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}