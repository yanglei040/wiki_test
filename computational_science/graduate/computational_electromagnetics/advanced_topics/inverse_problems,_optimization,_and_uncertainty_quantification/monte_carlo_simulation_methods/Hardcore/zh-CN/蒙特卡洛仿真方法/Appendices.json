{
    "hands_on_practices": [
        {
            "introduction": "我们通过探索蒙特卡洛模拟中样本数量与准确性之间的基本关系来开始我们的动手实践。理解这一原理对于估算达到所需精度所需的计算成本至关重要。本练习  将引导您从第一性原理出发，推导均方误差 $E[(I_N - I)^2]$ 如何与估计量的方差 $\\sigma^2$ 直接相关，并与样本数量 $N$ 成反比，这是蒙特卡洛理论的基石。",
            "id": "3332260",
            "problem": "在计算电磁学中，考虑一个支集在有界域 $\\Omega \\subset \\mathbb{R}^{3}$ 上的电流分布 $\\mathbf{J}(\\mathbf{r})$ 在一个固定观测点 $\\mathbf{r}_{0}$ 处产生的电场的频域表示。该电场可以写成一个体积分\n$$\nI \\equiv \\int_{\\Omega} \\mathbf{G}(\\mathbf{r}_{0},\\mathbf{r}) \\cdot \\mathbf{J}(\\mathbf{r}) \\,\\mathrm{d}\\mathbf{r},\n$$\n其中 $\\mathbf{G}(\\mathbf{r}_{0},\\mathbf{r})$ 是电磁并矢格林函数，$\\cdot$ 表示欧几里得内积。为了数值计算 $I$，您采用蒙特卡洛重要性采样方法，其概率密度 $p(\\mathbf{r})$ 在 $\\Omega$ 上严格为正，并且关于勒贝格测度是绝对连续的。定义随机变量\n$$\nW \\equiv \\frac{f(X)}{p(X)}, \\quad \\text{其中} \\quad f(\\mathbf{r}) \\equiv \\mathbf{G}(\\mathbf{r}_{0},\\mathbf{r}) \\cdot \\mathbf{J}(\\mathbf{r}), \\quad X \\sim p,\n$$\n并使用 $N$ 个独立同分布的样本 $\\{X_{i}\\}_{i=1}^{N}$ 来构建估计量\n$$\nI_{N} \\equiv \\frac{1}{N}\\sum_{i=1}^{N}\\frac{f(X_{i})}{p(X_{i})}.\n$$\n假设 $\\mathbb{E}[W^{2}]\\infty$，因此方差 $\\sigma^{2} \\equiv \\mathrm{Var}(W)$ 是有限的。从第一性原理出发，即蒙特卡洛估计量的无偏性定义以及独立同分布随机变量平均值的方差，推导 $I_{N}$ 的均方误差 $\\mathbb{E}\\!\\left[(I_{N}-I)^{2}\\right]$ 关于 $\\sigma^{2}$ 和 $N$ 的闭式表达式。然后，给定均方误差的目标容差 $\\varepsilon0$，确定保证 $\\mathbb{E}\\!\\left[(I_{N}-I)^{2}\\right]\\leq \\varepsilon^{2}$ 的最小 $N$ 值，并用 $\\sigma^{2}$ 和 $\\varepsilon$ 表示其闭式表达式。最后，给出这个最小 $N$ 的连续近似，并证明它简化为标准的蒙特卡洛复杂度标度。最终答案必须是 $N$ 的一个无单位的解析表达式。",
            "solution": "该问题要求推导蒙特卡洛估计量的均方误差（MSE），确定满足给定误差容差的最小样本量 $N$，并分析此样本量的连续近似。推导应从第一性原理出发。\n\n首先，我们分析估计量 $I_{N}$ 的性质。问题将目标积分定义为 $I \\equiv \\int_{\\Omega} f(\\mathbf{r}) \\,\\mathrm{d}\\mathbf{r}$，其中 $f(\\mathbf{r}) \\equiv \\mathbf{G}(\\mathbf{r}_{0},\\mathbf{r}) \\cdot \\mathbf{J}(\\mathbf{r})$。蒙特卡洛方法利用重要性采样和概率密度函数 (PDF) $p(\\mathbf{r})$ 来估计此积分。从该分布中抽取一个随机变量 $X \\sim p$。估计量由 $N$ 个独立同分布 (i.i.d.) 的样本 $\\{X_{i}\\}_{i=1}^{N}$ 构建。\n\n该方法的核心在于随机变量 $W \\equiv \\frac{f(X)}{p(X)}$。我们首先计算其期望值 $\\mathbb{E}[W]$。根据连续随机变量期望的定义，可得：\n$$\n\\mathbb{E}[W] = \\int_{\\Omega} \\frac{f(\\mathbf{r})}{p(\\mathbf{r})} p(\\mathbf{r}) \\,\\mathrm{d}\\mathbf{r} = \\int_{\\Omega} f(\\mathbf{r}) \\,\\mathrm{d}\\mathbf{r} = I.\n$$\n这表明单个加权样本的期望值就是我们希望计算的积分 $I$。\n\n接下来，我们证明估计量 $I_{N} \\equiv \\frac{1}{N}\\sum_{i=1}^{N} W_{i}$（其中 $W_{i} \\equiv \\frac{f(X_{i})}{p(X_{i})}$）是 $I$ 的一个无偏估计量。利用期望算子的线性性质：\n$$\n\\mathbb{E}[I_{N}] = \\mathbb{E}\\left[\\frac{1}{N}\\sum_{i=1}^{N} W_{i}\\right] = \\frac{1}{N}\\sum_{i=1}^{N}\\mathbb{E}[W_{i}].\n$$\n由于样本 $\\{X_{i}\\}$ 是同分布的，随机变量 $\\{W_{i}\\}$ 也是同分布的。因此，对于所有 $i \\in \\{1, 2, \\dots, N\\}$，都有 $\\mathbb{E}[W_{i}] = \\mathbb{E}[W] = I$。将此结果代入 $\\mathbb{E}[I_{N}]$ 的表达式中，得到：\n$$\n\\mathbb{E}[I_{N}] = \\frac{1}{N}\\sum_{i=1}^{N} I = \\frac{1}{N}(NI) = I.\n$$\n因此，估计量 $I_{N}$ 是无偏的。\n\n现在，我们来推导估计量的均方误差 (MSE)，其定义为 $\\mathbb{E}[(I_{N}-I)^{2}]$。由于 $I = \\mathbb{E}[I_{N}]$，均方误差等价于估计量 $I_{N}$ 的方差：\n$$\n\\mathbb{E}[(I_{N}-I)^{2}] = \\mathbb{E}[(I_{N}-\\mathbb{E}[I_{N}])^{2}] \\equiv \\mathrm{Var}(I_{N}).\n$$\n我们接下来计算 $\\mathrm{Var}(I_{N})$：\n$$\n\\mathrm{Var}(I_{N}) = \\mathrm{Var}\\left(\\frac{1}{N}\\sum_{i=1}^{N} W_{i}\\right).\n$$\n使用方差的性质 $\\mathrm{Var}(aY) = a^{2}\\mathrm{Var}(Y)$，并令 $a = 1/N$，我们得到：\n$$\n\\mathrm{Var}(I_{N}) = \\frac{1}{N^{2}}\\mathrm{Var}\\left(\\sum_{i=1}^{N} W_{i}\\right).\n$$\n问题说明样本 $\\{X_{i}\\}$ 是独立的。这意味着随机变量 $\\{W_{i}\\}$ 也是独立的。对于独立随机变量之和，和的方差等于方差的和：\n$$\n\\mathrm{Var}\\left(\\sum_{i=1}^{N} W_{i}\\right) = \\sum_{i=1}^{N}\\mathrm{Var}(W_{i}).\n$$\n由于 $\\{W_{i}\\}$ 也是同分布的，它们的方差相等。问题将这个公共方差定义为 $\\sigma^{2} \\equiv \\mathrm{Var}(W)$。注意，这个有限方差的存在性是由假设 $\\mathbb{E}[W^{2}]\\infty$ 保证的，因为 $\\mathrm{Var}(W) = \\mathbb{E}[W^{2}] - (\\mathbb{E}[W])^{2}$。因此，对于所有的 $i$，都有 $\\mathrm{Var}(W_{i}) = \\sigma^{2}$。\n$$\n\\sum_{i=1}^{N}\\mathrm{Var}(W_{i}) = \\sum_{i=1}^{N}\\sigma^{2} = N\\sigma^{2}.\n$$\n将此结果代回 $\\mathrm{Var}(I_{N})$ 的表达式，得到均方误差的闭式表达式：\n$$\n\\mathbb{E}[(I_{N}-I)^{2}] = \\mathrm{Var}(I_{N}) = \\frac{1}{N^{2}}(N\\sigma^{2}) = \\frac{\\sigma^{2}}{N}.\n$$\n\n第二个任务是找到最小的整数 $N$，以保证均方误差不大于指定的容差 $\\varepsilon^{2}$（其中 $\\varepsilon  0$）。该条件为：\n$$\n\\mathbb{E}[(I_{N}-I)^{2}] \\leq \\varepsilon^{2}.\n$$\n代入我们推导出的均方误差表达式：\n$$\n\\frac{\\sigma^{2}}{N} \\leq \\varepsilon^{2}.\n$$\n假设在 $\\sigma^{2}  0$ 的非平凡情况下，我们可以重新整理该不等式以解出 $N$：\n$$\nN \\geq \\frac{\\sigma^{2}}{\\varepsilon^{2}}.\n$$\n由于 $N$ 必须是表示样本数量的整数，满足此条件的最小 $N$ 值是大于或等于 $\\frac{\\sigma^{2}}{\\varepsilon^{2}}$ 的最小整数。这对应于上取整函数：\n$$\nN_{\\min} = \\left\\lceil \\frac{\\sigma^{2}}{\\varepsilon^{2}} \\right\\rceil.\n$$\n\n最后一个任务是给出这个最小 $N$ 的连续近似并分析其标度。对于大量的样本，一个数与其上取整之间的差异可以忽略不计。因此，我们可以通过去掉上取整函数来近似最小 $N$：\n$$\nN \\approx \\frac{\\sigma^{2}}{\\varepsilon^{2}}.\n$$\n这个表达式揭示了蒙特卡洛方法的标准复杂度标度。均方根误差 (RMSE)，即估计量的标准差，为 $\\sqrt{\\mathbb{E}[(I_{N}-I)^{2}]} = \\sqrt{\\frac{\\sigma^{2}}{N}} = \\frac{\\sigma}{\\sqrt{N}}$。如果我们将此 RMSE 设为我们的容差 $\\varepsilon$，则有 $\\varepsilon = \\frac{\\sigma}{\\sqrt{N}}$，整理后得到 $N = \\frac{\\sigma^{2}}{\\varepsilon^{2}}$。这表明，为达到期望的误差容差 $\\varepsilon$ 所需的样本数 $N$ 与 $\\varepsilon^{-2}$ 成正比，即 $N = \\mathcal{O}(\\varepsilon^{-2})$。等价地，误差收敛为 $\\varepsilon = \\mathcal{O}(N^{-1/2})$。这是标准蒙特卡洛积分的典型收敛率，我们的推导证实了该估计量遵循此特征标度律。",
            "answer": "$$\n\\boxed{\\frac{\\sigma^{2}}{\\varepsilon^{2}}}\n$$"
        },
        {
            "introduction": "蒙特卡洛方法功能强大，但在处理具有尖峰或奇异性的被积函数时，其效率会下降，而这在电磁学的边界元方法中是常见情景。本实践  演示了如何利用分层抽样技术来应对这一挑战，该技术将积分域划分为多个区域并对每个区域进行智能抽样。通过分析一个正确和一个错误的分层方案，您将对在处理奇异核函数时，抽样策略如何显著影响结果的准确性和偏差获得深刻的实践理解。",
            "id": "3332310",
            "problem": "给定一个计算电磁学背景，其中边界积分公式涉及奇异核，在 $\\mathbf{r}' = \\mathbf{r}$ 附近，其行为类似于 $1/\\lvert \\mathbf{r} - \\mathbf{r}' \\rvert$。考虑一个观测点 $\\mathbf{r}$ 附近的局部平面面片，该点位于边界边附近，因此积分区域是一个楔形扇区。在表面上使用极坐标 $(\\rho,\\theta)$，将奇异核局部地建模为标量函数 $f(\\rho,\\theta) = 1/\\rho$。设积分域为楔形环\n$$\n\\mathcal{D}(\\alpha,\\varepsilon,R) = \\left\\{ (\\rho,\\theta)\\,:\\, \\varepsilon \\le \\rho \\le R,\\; -\\frac{\\alpha}{2} \\le \\theta \\le \\frac{\\alpha}{2} \\right\\},\n$$\n其中 $\\varepsilon$ 是一个小的正排除半径（用于对奇点进行正则化），$R$ 是局部面片的外半径，$\\alpha$ 是楔形孔径角。角度以弧度为单位，所有长度以米为单位。我们感兴趣的积分是\n$$\nI(\\alpha,\\varepsilon,R) = \\iint_{\\mathcal{D}(\\alpha,\\varepsilon,R)} \\frac{1}{\\rho}\\,\\mathrm{d}A,\n$$\n其中 $\\mathrm{d}A = \\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta$。\n\n您的任务是构建并分析一种适用于 $I(\\alpha,\\varepsilon,R)$ 在奇点附近的蒙特卡洛（MC）估计量的分层抽样方案，并与均匀面积MC估计量进行比较。分析必须量化其在奇点处的偏差效应。从第一性原理出发，仅使用核心定义和经过验证的事实；不要假设任何预先推导的快捷公式。\n\n1. 从积分 $I(\\alpha,\\varepsilon,R)$ 的定义和面积元 $\\mathrm{d}A = \\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta$ 出发，推导 $I(\\alpha,\\varepsilon,R)$ 关于 $\\alpha$、$\\varepsilon$ 和 $R$ 的精确闭式表达式。最终结果以米为单位表示。\n\n2. 定义楔形环的总面积\n$$\nA_{\\text{tot}}(\\alpha,\\varepsilon,R) = \\frac{\\alpha}{2}\\left(R^2 - \\varepsilon^2\\right).\n$$\n描述一种正确的分层抽样方案，该方案将径向区间 $[\\varepsilon,R]$ 划分为 $K$ 个面积相等的层，并解释如何对各层的估计值进行加权以产生 $I(\\alpha,\\varepsilon,R)$ 的无偏估计量。然后，定义一种不正确的分层方案，该方案将径向区间划分为 $K$ 个等宽的箱，但在估计 $I(\\alpha,\\varepsilon,R)$ 时为每个箱的均值分配相等的权重，并解释为什么它在奇点附近是有偏的。\n\n3. 对于不正确的方案，考虑一个估计量，它将每箱均值的未加权平均值乘以 $A_{\\text{tot}}(\\alpha,\\varepsilon,R)$。计算该估计量的期望值并推导其相对于精确积分的偏差。您的推导应明确地用 $K$ 个箱的边界表示，并且必须揭示偏差如何依赖于 $\\varepsilon$ 和 $K$。偏差以米为单位表示。\n\n4. 使用确定性计算而非随机抽样，实现一个程序，为每个测试用例输出三种估计量的偏差：\n   - 均匀面积MC估计量，采用适当的面积加权（预期偏差需通过解析计算）。\n   - 正确的分层估计量，具有 $K$ 个等面积径向层和适当的面积加权。\n   - 不正确的分层估计量，具有 $K$ 个等宽径向层和每箱均值等权重，并按 $A_{\\text{tot}}(\\alpha,\\varepsilon,R)$ 缩放。\n\n使用以下参数值测试套件，该套件涵盖了内部点、边界边点和近角点行为：\n- 测试用例1：$\\alpha = 2\\pi$（全圆盘），$\\varepsilon = 10^{-3}\\,\\mathrm{m}$，$R = 1.0\\,\\mathrm{m}$，$K = 8$。\n- 测试用例2：$\\alpha = \\pi$（半圆盘），$\\varepsilon = 10^{-6}\\,\\mathrm{m}$，$R = 1.0\\,\\mathrm{m}$，$K = 16$。\n- 测试用例3：$\\alpha = \\pi/4$（窄楔形），$\\varepsilon = 10^{-8}\\,\\mathrm{m}$，$R = 0.2\\,\\mathrm{m}$，$K = 12$。\n- 测试用例4：$\\alpha = 2\\pi$（全圆盘），$\\varepsilon = 0.5\\,\\mathrm{m}$，$R = 1.0\\,\\mathrm{m}$，$K = 4$。\n\n每个测试用例应产生一个包含三个浮点数的列表（以米为单位）：$\\left[\\text{bias}_{\\text{uniform}}, \\text{bias}_{\\text{strat-correct}}, \\text{bias}_{\\text{strat-wrong}}\\right]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素本身就是对应一个测试用例的列表。例如，\n$$\n\\left[ [b_{1,1},\\,b_{1,2},\\,b_{1,3}],\\; [b_{2,1},\\,b_{2,2},\\,b_{2,3}],\\; [b_{3,1},\\,b_{3,2},\\,b_{3,3}],\\; [b_{4,1},\\,b_{4,2},\\,b_{4,3}] \\right].\n$$\n所有角度必须以弧度为单位，所有输出必须以米为单位表示为十进制数。",
            "solution": "该问题要求分析和比较针对计算电磁学中出现的奇异积分的不同蒙特卡洛（MC）积分方案。分析分四部分进行：首先，直接计算积分；其次，概念性地描述两种分层抽样方案；第三，定量推导其中一种方案的偏差；第四，对一系列测试用例，确定性地数值计算三种估计量的偏差。\n\n### 1. 积分的精确计算\n\n我们感兴趣的积分由下式给出\n$$\nI(\\alpha,\\varepsilon,R) = \\iint_{\\mathcal{D}(\\alpha,\\varepsilon,R)} \\frac{1}{\\rho}\\,\\mathrm{d}A\n$$\n积分域是楔形环 $\\mathcal{D}(\\alpha,\\varepsilon,R) = \\{ (\\rho,\\theta) \\mid \\varepsilon \\le \\rho \\le R, \\; -\\alpha/2 \\le \\theta \\le \\alpha/2 \\}$，其中 $\\rho$ 是径向坐标，$\\theta$ 是角坐标，$\\varepsilon$ 是内半径，$R$ 是外半径，$\\alpha$ 是总孔径角。极坐标下的微分面积元是 $\\mathrm{d}A = \\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta$。\n\n将面积元代入积分表达式，我们得到：\n$$\nI(\\alpha,\\varepsilon,R) = \\int_{-\\alpha/2}^{\\alpha/2} \\int_{\\varepsilon}^{R} \\frac{1}{\\rho} (\\rho\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta)\n$$\n来自面积元的项 $\\rho$ 与被积函数中的奇异项 $1/\\rho$ 相抵消，这个过程称为奇点消除，是这类极坐标下积分的一个关键特征。积分简化为：\n$$\nI(\\alpha,\\varepsilon,R) = \\int_{-\\alpha/2}^{\\alpha/2} \\int_{\\varepsilon}^{R} 1\\,\\mathrm{d}\\rho\\,\\mathrm{d}\\theta\n$$\n现在被积函数为常数，且积分关于变量 $\\rho$ 和 $\\theta$ 是可分离的。我们可以独立地计算这两个积分：\n$$\n\\int_{-\\alpha/2}^{\\alpha/2} \\mathrm{d}\\theta = \\left[\\theta\\right]_{-\\alpha/2}^{\\alpha/2} = \\frac{\\alpha}{2} - \\left(-\\frac{\\alpha}{2}\\right) = \\alpha\n$$\n$$\n\\int_{\\varepsilon}^{R} \\mathrm{d}\\rho = \\left[\\rho\\right]_{\\varepsilon}^{R} = R - \\varepsilon\n$$\n将这些结果相乘，得到积分的精确闭式表达式：\n$$\nI(\\alpha,\\varepsilon,R) = \\alpha(R - \\varepsilon)\n$$\n由于 $\\alpha$ 以弧度为单位（无量纲），而 $R$ 和 $\\varepsilon$ 都以米（$m$）为单位，因此 $I$ 的单位是米，符合要求。\n\n### 2. 分层抽样方案分析\n\n蒙特卡洛积分的基本原理是通过随机变量 $\\hat{I} = A_{\\text{tot}} \\cdot \\bar{f}$ 来估计积分 $I = \\int_{\\mathcal{D}} f(x) \\, \\mathrm{d}A$，其中 $\\bar{f}$ 是在从总面积为 $A_{\\text{tot}}$ 的域 $\\mathcal{D}$ 中均匀抽取的 $N$ 个点 $x_i$ 上求得的 $f(x_i)$ 的平均值。该估计量是无偏的，因为其期望值为 $E[\\hat{I}] = I$。\n\n分层抽样将域 $\\mathcal{D}$ 划分为 $K$ 个不相交的层 $\\mathcal{D}_k$，其面积为 $A_k$。计算每个层上的积分估计值 $I_k = \\int_{\\mathcal{D}_k} f(x)\\,\\mathrm{d}A$。总估计值是各层估计值之和，$\\hat{I}_{\\text{strat}} = \\sum_{k=1}^K \\hat{I}_k$。一个适当加权的估计量仍然是无偏的。此类估计量的期望值的确定性计算涉及使用函数在每层内的真实均值 $\\bar{f}_k = I_k/A_k$。\n\n**正确的分层方案（等面积分层）**\n该方案将域划分为 $K$ 个面积相等的层。由于半径 $\\rho_{k-1}$ 和 $\\rho_k$ 之间的层的面积为 $A_k = \\frac{\\alpha}{2}(\\rho_k^2 - \\rho_{k-1}^2)$，要使所有 $A_k$ 都等于 $A_{\\text{tot}}/K$，意味着 $\\rho_k^2 - \\rho_{k-1}^2$ 必须是常数。这导致径向边界为：\n$$\n\\rho_k = \\sqrt{\\varepsilon^2 + \\frac{k}{K}(R^2 - \\varepsilon^2)} \\quad \\text{for } k=0, 1, \\dots, K\n$$\n正确的的分层估计量按其面积对每层的贡献进行加权。该估计量的期望值（或其确定性等价物）是：\n$$\nE[\\hat{I}_{\\text{strat-correct}}] = \\sum_{k=1}^K I_k = \\sum_{k=1}^K \\iint_{\\mathcal{D}_k} f(\\rho,\\theta)\\,\\mathrm{d}A = I(\\alpha,\\varepsilon,R)\n$$\n由于其期望值等于积分的真实值，该估计量是无偏的。其偏差恰好为 $0$。\n\n**不正确的分层方案（等宽径向分箱，等权重）**\n该方案将径向区间 $[\\varepsilon, R]$ 划分为 $K$ 个等宽的箱，宽度为 $\\Delta\\rho = (R-\\varepsilon)/K$，边界为 $\\rho_k = \\varepsilon + k \\cdot \\Delta\\rho$。由此产生的各层面积 $A_k = \\frac{\\alpha}{2}(\\rho_k^2 - \\rho_{k-1}^2)$ 不相等；它们随 $k$ 的增加而增加。\n\n指定的不正确估计量形式如下：\n$$\n\\hat{I}_{\\text{strat-wrong}} = A_{\\text{tot}} \\left( \\frac{1}{K} \\sum_{k=1}^K \\bar{f}_k \\right)\n$$\n其中 $\\bar{f}_k = I_k/A_k$ 是函数 $f$ 在第 $k$ 层的真实均值。该估计量是有偏的，因为它计算了每层函数均值 $\\bar{f}_k$ 的未加权算术平均值。正确的总积分是各层积分之和，$I = \\sum I_k = \\sum A_k \\bar{f}_k$。相应的 $f$ 在整个域上的真实均值为 $\\bar{f} = I/A_{\\text{tot}} = \\sum (A_k/A_{\\text{tot}}) \\bar{f}_k$，这是一个加权平均。通过使用相等的权重（$1/K$）而不是正确的与面积成比例的权重（$A_k/A_{\\text{tot}}$），该估计量错误地表示了函数的整体平均值，从而导致偏差。在奇点附近（小 $\\rho$ 处），这种偏差尤其严重，因为在这里 $f = 1/\\rho$ 很大，但层的面积很小。不正确的方案给予这个小区域内的大函数均值与最大区域内的小函数均值相同的权重，导致系统性的高估。\n\n### 3. 不正确方案的偏差推导\n\n估计量 $\\hat{I}$ 的偏差定义为 $B = E[\\hat{I}] - I$。对于不正确的分层估计量，我们首先计算其期望值 $E[\\hat{I}_{\\text{strat-wrong}}]$。\n\n在第 $k$ 层 $\\mathcal{D}_k$（由半径 $\\rho_{k-1}$ 和 $\\rho_k$ 定义）中，$f(\\rho,\\theta) = 1/\\rho$ 的均值为：\n$$\n\\bar{f}_k = \\frac{\\int_{\\mathcal{D}_k} f(\\rho,\\theta)\\,\\mathrm{d}A}{\\int_{\\mathcal{D}_k} \\mathrm{d}A} = \\frac{I_k}{A_k} = \\frac{\\alpha(\\rho_k - \\rho_{k-1})}{\\frac{\\alpha}{2}(\\rho_k^2 - \\rho_{k-1}^2)} = \\frac{2(\\rho_k - \\rho_{k-1})}{(\\rho_k - \\rho_{k-1})(\\rho_k + \\rho_{k-1})} = \\frac{2}{\\rho_k + \\rho_{k-1}}\n$$\n等宽箱的边界为 $\\rho_k = \\varepsilon + k \\frac{R-\\varepsilon}{K}$，对于 $k=0, \\dots, K$。\n\n不正确估计量的期望值为：\n$$\nE[\\hat{I}_{\\text{strat-wrong}}] = A_{\\text{tot}} \\left( \\frac{1}{K} \\sum_{k=1}^K \\bar{f}_k \\right) = \\frac{A_{\\text{tot}}}{K} \\sum_{k=1}^K \\frac{2}{\\rho_k + \\rho_{k-1}}\n$$\n代入 $A_{\\text{tot}} = \\frac{\\alpha}{2}(R^2 - \\varepsilon^2)$，我们得到：\n$$\nE[\\hat{I}_{\\text{strat-wrong}}] = \\frac{\\alpha(R^2 - \\varepsilon^2)}{2K} \\sum_{k=1}^K \\frac{2}{\\varepsilon + k\\frac{R-\\varepsilon}{K} + \\varepsilon + (k-1)\\frac{R-\\varepsilon}{K}} = \\frac{\\alpha(R^2 - \\varepsilon^2)}{K} \\sum_{k=1}^K \\frac{1}{2\\varepsilon + (2k-1)\\frac{R-\\varepsilon}{K}}\n$$\n偏差是该期望值与真实积分值 $I = \\alpha(R - \\varepsilon)$ 之间的差值：\n$$\nB_{\\text{strat-wrong}} = E[\\hat{I}_{\\text{strat-wrong}}] - I = \\left( \\frac{\\alpha(R^2 - \\varepsilon^2)}{K} \\sum_{k=1}^K \\frac{1}{2\\varepsilon + (2k-1)\\frac{R-\\varepsilon}{K}} \\right) - \\alpha(R - \\varepsilon)\n$$\n这个表达式揭示了偏差是所有参数 $\\alpha, \\varepsilon, R, K$ 的函数。求和项受前几项（$k$ 较小）的严重影响，它量化了不正确的平均化如何过高地加权了来自 $\\rho = \\varepsilon$ 附近奇异区域的贡献。\n\n### 4. 偏差的确定性计算\n\n程序必须计算三种估计量的偏差。\n1.  **均匀面积MC估计量**：如前所述，一个从面积中均匀抽样的标准MC估计量是无偏的。因此，$E[\\hat{I}_{\\text{uniform}}] = I$，其偏差为 $B_{\\text{uniform}} = 0$。\n2.  **正确的分层估计量**：如前所述，一个适当加权的分层抽样方案是无偏的，无论分层策略如何（等面积或其他）。因此，$E[\\hat{I}_{\\text{strat-correct}}] = I$，其偏差为 $B_{\\text{strat-correct}} = 0$。\n3.  **不正确的分层估计量**：偏差 $B_{\\text{strat-wrong}}$ 使用上一节推导的公式计算。\n\n因此，实现将为每个测试用例计算 $[0.0, 0.0, B_{\\text{strat-wrong}}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by deterministically calculating the bias of three\n    Monte Carlo estimators for a singular integral in computational electromagnetics.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, epsilon, R, K)\n        (2 * np.pi, 1e-3, 1.0, 8),\n        (np.pi, 1e-6, 1.0, 16),\n        (np.pi / 4, 1e-8, 0.2, 12),\n        (2 * np.pi, 0.5, 1.0, 4),\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, epsilon, R, K = case\n\n        # 1. Uniform-area MC estimator bias\n        # The standard uniform-area MC estimator is unbiased by construction.\n        # Its expected value is the true integral value.\n        bias_uniform = 0.0\n\n        # 2. Correct stratified estimator bias\n        # A correctly weighted stratified sampling scheme is also unbiased by construction.\n        # Its expected value is the sum of the exact integrals over the strata.\n        bias_strat_correct = 0.0\n\n        # 3. Incorrect stratified estimator bias\n        \n        # Calculate the exact value of the integral\n        I_exact = alpha * (R - epsilon)\n\n        # Calculate the total area of the integration domain\n        A_tot = (alpha / 2.0) * (R**2 - epsilon**2)\n\n        # Calculate the expected value of the incorrect estimator\n        # This estimator uses equal-width radial bins and unweighted averaging of\n        # per-stratum function means.\n        \n        delta_rho = (R - epsilon) / K\n        sum_f_bar = 0.0\n        for k in range(1, K + 1):\n            rho_k_minus_1 = epsilon + (k - 1) * delta_rho\n            rho_k = epsilon + k * delta_rho\n            \n            # The mean value of f=1/rho in the k-th stratum is 2 / (rho_k + rho_{k-1})\n            f_bar_k = 2.0 / (rho_k + rho_k_minus_1)\n            sum_f_bar += f_bar_k\n            \n        # Expected value of the estimator\n        E_wrong = (A_tot / K) * sum_f_bar\n        \n        # Bias of the incorrect estimator\n        bias_strat_wrong = E_wrong - I_exact\n\n        results.append([bias_uniform, bias_strat_correct, bias_strat_wrong])\n\n    # Format the final output string according to the problem specification.\n    # The output should be a single line representing a list of lists.\n    outer_parts = []\n    for sublist in results:\n        # Use a high-precision format for the floating point numbers\n        inner_parts = [f\"{x:.15e}\" for x in sublist]\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n    final_string = f\"[{','.join(outer_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_string)\n\nsolve()\n```"
        },
        {
            "introduction": "除了空间奇异性，计算电磁学中的另一个主要障碍是评估高频问题中出现的高振荡积分。本练习  深入探讨了重要性抽样，这是一种强大的方差缩减技术，它将计算精力集中在被积函数最“重要”的区域。您将根据积分的振幅设计一个重要性抽样密度并分析其性能，从而发现一个关键的洞见：虽然这种方法能有效控制绝对误差，但快速振荡的相位可能导致相对误差急剧增加，这是蒙特卡洛方法中一个被称为“符号问题”的现象。",
            "id": "3332259",
            "problem": "考虑计算电磁学中出现的高振荡辐射积分，\n$$\nI(k) \\;=\\; \\int_{D} e^{i k \\,\\phi(x)}\\, a(x)\\,\\mathrm{d}x,\n$$\n其中 $D \\subset \\mathbb{R}^{d}$ 是一个有界域，$a:D\\to\\mathbb{C}$ 是一个幅值，满足 $a\\in L^{1}(D)\\cap L^{2}(D)$，而 $\\phi:D\\to\\mathbb{R}$ 是一个二次连续可微的相位函数，在 $D$ 中有有限个非退化驻点。我们希望通过蒙特卡罗（MC）重要性采样（IS）来近似 $I(k)$。设 $q$ 是 $D$ 上的一个概率密度，并用 $N$ 个独立样本 $x_{1},\\dots,x_{N}\\sim q$ 定义IS估计量，\n$$\n\\widehat{I}_{N}(k)\\;=\\;\\frac{1}{N}\\sum_{j=1}^{N}\\frac{a(x_{j})\\,e^{i k \\phi(x_{j})}}{q(x_{j})}.\n$$\n对于复值估计量，采用方差定义 $\\mathrm{Var}_{q}(\\widehat{I}_{N})=\\mathbb{E}_{q}\\!\\left[\\,\\left|\\widehat{I}_{N}-\\mathbb{E}_{q}[\\widehat{I}_{N}]\\right|^{2}\\right]$, 因此\n$$\n\\mathrm{Var}_{q}(\\widehat{I}_{N}(k))\\;=\\;\\frac{1}{N}\\left(\\mathbb{E}_{q}\\!\\left[\\left|\\frac{a(X)\\,e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right]-\\left|I(k)\\right|^{2}\\right),\n$$\n其中 $X\\sim q$。设计一个重要性密度 $q(x)$，它针对 $\\lvert a(x)\\rvert$ 较大的区域，而不在 $q$ 中直接使用相位 $e^{i k \\phi(x)}$，并从第一性原理出发，推断在稳相机制下，当 $k$ 增加时，相位振荡如何影响残余方差。哪个选项是正确的？\n\nA. 选择 $q^{\\star}(x)=\\dfrac{\\lvert a(x)\\rvert}{\\int_{D}\\lvert a(u)\\rvert\\,\\mathrm{d}u}$ 在所有与 $k$ 无关的密度中最小化了 $\\mathbb{E}_{q}\\!\\left[\\left|\\dfrac{a(X)e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right]$，得到\n$$\n\\mathbb{E}_{q^{\\star}}\\!\\left[\\left|\\frac{a(X)e^{i k \\phi(X)}}{q^{\\star}(X)}\\right|^{2}\\right]\n=\\left(\\int_{D}\\lvert a(u)\\rvert\\,\\mathrm{d}u\\right)^{2},\n$$\n该结果与 $k$ 无关。根据 $d$ 维非退化临界点的稳相法，当 $k\\to\\infty$ 时，$\\lvert I(k)\\rvert=\\mathcal{O}(k^{-d/2})$，因此绝对方差 $\\mathrm{Var}_{q^{\\star}}(\\widehat{I}_{N}(k))$ 在主阶上与 $k$ 无关，而相对方差的增长类似 $\\mathcal{O}(k^{d})$。\n\nB. 选择 $q(x)=\\dfrac{\\lvert a(x)\\rvert^{2}}{\\int_{D}\\lvert a(u)\\rvert^{2}\\,\\mathrm{d}u}$ 最小化了 $\\mathbb{E}_{q}\\!\\left[\\left|\\dfrac{a(X)e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right]$，而且 $e^{i k \\phi}$ 中的振荡迫使 $\\mathbb{E}_{q}\\!\\left[\\left|\\dfrac{a(X)e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right]$ 随 $k$ 衰减，因此绝对方差随着 $k$ 的增加而减小。\n\nC. 设置 $q(x)\\propto \\lvert a(x)e^{i k \\phi(x)}\\rvert$ 能恰当地考虑相位，并确保绝对方差和相对方差都保持有界且与 $k$ 无关。\n\nD. 如果允许 $q$ 依赖于 $k$，一个最优选择是 $q_{k}(x)\\propto \\lvert a(x)\\rvert$，这使得相对方差与 $k$ 无关；因此对于大的 $k$ 值，不需要在基于幅值的重要性采样之外进行额外的方差缩减。",
            "solution": "用户要求对问题陈述进行严格验证，然后给出详细的解决方案和对所提供选项的评估。\n\n### 第1步：提取已知条件\n- 需要近似的积分是 $I(k) = \\int_{D} e^{i k \\,\\phi(x)}\\, a(x)\\,\\mathrm{d}x$。\n- 域 $D \\subset \\mathbb{R}^{d}$ 是一个有界集。\n- 幅值函数 $a:D\\to\\mathbb{C}$ 满足 $a\\in L^{1}(D)\\cap L^{2}(D)$。\n- 相位函数 $\\phi:D\\to\\mathbb{R}$ 是二次连续可微的，并且在 $D$ 中有有限个非退化驻点。\n- 估计量是蒙特卡罗（MC）重要性采样（IS）估计量：$\\widehat{I}_{N}(k) = \\frac{1}{N}\\sum_{j=1}^{N}\\frac{a(x_{j})\\,e^{i k \\phi(x_{j})}}{q(x_{j})}$，其中 $N$ 个独立样本 $x_{1},\\dots,x_{N}$ 从概率密度函数 $q(x)$ 中抽取。\n- 复值估计量的方差定义为 $\\mathrm{Var}_{q}(\\widehat{I}_{N})=\\mathbb{E}_{q}\\!\\left[\\,\\left|\\widehat{I}_{N}-\\mathbb{E}_{q}[\\widehat{I}_{N}]\\right|^{2}\\right]$。\n- 该方差由公式 $\\mathrm{Var}_{q}(\\widehat{I}_{N}(k)) = \\frac{1}{N}\\left(\\mathbb{E}_{q}\\!\\left[\\left|\\frac{a(X)\\,e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right]-\\left|I(k)\\right|^{2}\\right)$ 给出，其中 $X\\sim q$。\n- 任务是设计一个不依赖于相位因子 $e^{i k \\phi(x)}$（因此也与 $k$ 无关）且基于幅值 $\\lvert a(x)\\rvert$ 的重要性密度 $q(x)$。然后，分析当波数 $k$ 变大时方差的行为。\n\n### 第2步：使用提取的已知条件进行验证\n问题陈述定义良好且科学上合理。\n- **科学依据：** 该问题描述了计算电磁学和波动物理学中的一个典型场景，涉及高振荡积分的数值计算。蒙特卡罗与重要性采样的使用、复方差的定义以及对稳相法的引用，都是数值分析和应用数学中的标准且正确的概念。\n- **问题定义良好：** 问题提供了进行分析所需的所有必要信息。对域 $D$、幅值 $a$ 和相位 $\\phi$ 的条件是标准的，确保了积分 $I(k)$ 定义良好，并且可以通过稳相法进行渐近分析。\n- **客观性：** 问题以精确的数学语言陈述，没有歧义或主观内容。\n\n问题陈述中未发现任何缺陷。这是一个有效且有意义的问题，旨在检验对重要性采样和振荡积分渐近行为的理解。\n\n### 第3步：结论与行动\n问题陈述是有效的。我们着手推导解决方案。\n\n### 推导\n目标是分析重要性采样估计量 $\\widehat{I}_{N}(k)$ 的方差。方差由下式给出：\n$$\n\\mathrm{Var}_{q}(\\widehat{I}_{N}(k)) = \\frac{1}{N} V_k(q)\n\\quad \\text{其中} \\quad\nV_k(q) = \\mathbb{E}_{q}\\!\\left[\\left|\\frac{a(X)\\,e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right] - \\left|I(k)\\right|^{2}.\n$$\n我们首先分析期望项，记为 $M_2(q, k)$：\n$$\nM_2(q, k) = \\mathbb{E}_{q}\\!\\left[\\left|\\frac{a(X)\\,e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right] = \\int_D \\left|\\frac{a(x)\\,e^{i k \\phi(x)}}{q(x)}\\right|^2 q(x) \\, \\mathrm{d}x.\n$$\n由于 $\\phi(x)$ 是实数，我们有 $\\lvert e^{i k \\phi(x)} \\rvert = 1$。被积函数简化为：\n$$\n\\left|\\frac{a(x)\\,e^{i k \\phi(x)}}{q(x)}\\right|^2 q(x) = \\frac{\\lvert a(x) \\rvert^2 \\lvert e^{i k \\phi(x)} \\rvert^2}{q(x)^2} q(x) = \\frac{\\lvert a(x) \\rvert^2}{q(x)}.\n$$\n因此，期望变为：\n$$\nM_2(q, k) = \\int_D \\frac{\\lvert a(x) \\rvert^2}{q(x)} \\, \\mathrm{d}x.\n$$\n问题要求一个与相位无关的重要性密度 $q(x)$，这意味着 $q(x)$ 与 $k$ 无关。因此，$M_2(q, k)$ 也与 $k$ 无关。我们将其记为 $M_2(q)$。\n\n最优的重要性采样密度 $q(x)$ 是使方差最小化的那一个。由于 $|I(k)|^2$ 与 $q$ 的选择无关，我们只需要最小化 $M_2(q)$。我们寻求最小化泛函 $M_2(q) = \\int_D \\frac{\\lvert a(x) \\rvert^2}{q(x)} \\, \\mathrm{d}x$，约束条件是 $q$ 是一个概率密度函数，即 $q(x) \\geq 0$ 且 $\\int_D q(x) \\, \\mathrm{d}x = 1$。\n\n我们可以应用柯西-施瓦茨不等式。令 $f_1(x) = \\frac{\\lvert a(x) \\rvert}{\\sqrt{q(x)}}$ 和 $f_2(x) = \\sqrt{q(x)}$。那么：\n$$\n\\left( \\int_D \\lvert a(x) \\rvert \\, \\mathrm{d}x \\right)^2 = \\left( \\int_D f_1(x) f_2(x) \\, \\mathrm{d}x \\right)^2 \\leq \\left( \\int_D f_1(x)^2 \\, \\mathrm{d}x \\right) \\left( \\int_D f_2(x)^2 \\, \\mathrm{d}x \\right)\n$$\n$$\n\\left( \\int_D \\lvert a(x) \\rvert \\, \\mathrm{d}x \\right)^2 \\leq \\left( \\int_D \\frac{\\lvert a(x) \\rvert^2}{q(x)} \\, \\mathrm{d}x \\right) \\left( \\int_D q(x) \\, \\mathrm{d}x \\right).\n$$\n由于 $\\int_D q(x) \\, \\mathrm{d}x = 1$，我们有：\n$$\nM_2(q) = \\int_D \\frac{\\lvert a(x) \\rvert^2}{q(x)} \\, \\mathrm{d}x \\geq \\left( \\int_D \\lvert a(x) \\rvert \\, \\mathrm{d}x \\right)^2.\n$$\n当 $f_1(x)$ 与 $f_2(x)$ 成正比时，即 $\\frac{\\lvert a(x) \\rvert}{\\sqrt{q(x)}} \\propto \\sqrt{q(x)}$，也即 $q(x) \\propto \\lvert a(x) \\rvert$ 时，达到最小值。将其归一化为概率密度，得到最优选择：\n$$\nq^{\\star}(x) = \\frac{\\lvert a(x) \\rvert}{\\int_D \\lvert a(u) \\rvert \\, \\mathrm{d}u}.\n$$\n对于这个最优密度 $q^{\\star}$，二阶矩的最小值为：\n$$\nM_2(q^{\\star}) = \\left( \\int_D \\lvert a(u) \\rvert \\, \\mathrm{d}u \\right)^2.\n$$\n这个量是一个与 $k$ 无关的常数。\n\n现在，我们来分析当 $k$ 很大时方差的行为。使用 $q=q^\\star$ 时的方差是：\n$$\n\\mathrm{Var}_{q^{\\star}}(\\widehat{I}_{N}(k)) = \\frac{1}{N} \\left[ \\left( \\int_D \\lvert a(u) \\rvert \\, \\mathrm{d}u \\right)^2 - \\lvert I(k) \\rvert^2 \\right].\n$$\n问题指明相位函数 $\\phi(x)$ 有有限个非退化驻点。根据稳相法，对于大的 $k$ 值，积分 $I(k)$ 会衰减。对于 $d$ 维域内部的非退化临界点，其渐近行为是：\n$$\n\\lvert I(k) \\rvert = \\mathcal{O}(k^{-d/2}) \\quad \\text{as } k \\to \\infty.\n$$\n因此，$\\lvert I(k) \\rvert^2 = \\mathcal{O}(k^{-d})$，当 $k \\to \\infty$ 时它趋于零。\n\n对于大的 $k$ 值，绝对方差趋近于一个常数值：\n$$\n\\lim_{k\\to\\infty} \\mathrm{Var}_{q^{\\star}}(\\widehat{I}_{N}(k)) = \\frac{1}{N} \\left( \\int_D \\lvert a(u) \\rvert \\, \\mathrm{d}u \\right)^2.\n$$\n因此，在主阶上，绝对方差与 $k$ 无关。\n\n相对方差定义为 $\\frac{\\mathrm{Var}_{q^{\\star}}(\\widehat{I}_{N}(k))}{\\lvert I(k) \\rvert^2}$。其渐近行为是：\n$$\n\\frac{\\mathrm{Var}_{q^{\\star}}(\\widehat{I}_{N}(k))}{\\lvert I(k) \\rvert^2} = \\frac{\\frac{1}{N} \\left[ \\left( \\int_D \\lvert a(u) \\rvert \\, \\mathrm{d}u \\right)^2 - \\lvert I(k) \\rvert^2 \\right]}{\\lvert I(k) \\rvert^2} \\sim \\frac{\\frac{1}{N}\\left( \\int_D \\lvert a(u) \\rvert \\, \\mathrm{d}u \\right)^2}{\\mathcal{O}(k^{-d})} = \\mathcal{O}(k^d).\n$$\n相对方差随 $k$ 以维度 $d$ 的幂次多项式增长。这表明这种标准的重要性采样方案对于高振荡积分是失败的。\n\n### 逐项分析\n\n**A. 选择 $q^{\\star}(x)=\\dfrac{\\lvert a(x)\\rvert}{\\int_{D}\\lvert a(u)\\rvert\\,\\mathrm{d}u}$ 在所有与 $k$ 无关的密度中最小化了 $\\mathbb{E}_{q}\\!\\left[\\left|\\dfrac{a(X)e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right]$，得到 $\\mathbb{E}_{q^{\\star}}\\!\\left[\\left|\\frac{a(X)e^{i k \\phi(X)}}{q^{\\star}(X)}\\right|^{2}\\right] =\\left(\\int_{D}\\lvert a(u)\\rvert\\,\\mathrm{d}u\\right)^{2}$，该结果与 $k$ 无关。根据 $d$ 维非退化临界点的稳相法，当 $k\\to\\infty$ 时，$\\lvert I(k)\\rvert=\\mathcal{O}(k^{-d/2})$，因此绝对方差 $\\mathrm{Var}_{q^{\\star}}(\\widehat{I}_{N}(k))$ 在主阶上与 $k$ 无关，而相对方差的增长类似 $\\mathcal{O}(k^{d})$。**\n- **分析**：该选项完全正确地总结了上述推导。它正确地指出了最优的与 $k$ 无关的密度 $q^{\\star}(x)$、得到的二阶矩的值、积分 $I(k)$ 的渐近衰减，以及由此产生的绝对方差和相对方差的渐近行为。\n- **结论**：**正确**。\n\n**B. 选择 $q(x)=\\dfrac{\\lvert a(x)\\rvert^{2}}{\\int_{D}\\lvert a(u)\\rvert^{2}\\,\\mathrm{d}u}$ 最小化了 $\\mathbb{E}_{q}\\!\\left[\\left|\\dfrac{a(X)e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right]$，而且 $e^{i k \\phi}$ 中的振荡迫使 $\\mathbb{E}_{q}\\!\\left[\\left|\\dfrac{a(X)e^{i k \\phi(X)}}{q(X)}\\right|^{2}\\right]$ 随 $k$ 衰减，因此绝对方差随着 $k$ 的增加而减小。**\n- **分析**：该选项包含两个基本错误。首先，最小化二阶矩项 $\\mathbb{E}_{q}[\\dots]$ 的密度是 $q(x) \\propto \\lvert a(x) \\rvert$，而不是 $q(x) \\propto \\lvert a(x) \\rvert^2$。其次，项 $\\mathbb{E}_{q}[\\dots]$ 等于 $\\int_D \\frac{\\lvert a(x) \\rvert^2}{q(x)} \\, \\mathrm{d}x$。由于所提议的 $q(x)$ 与 $k$ 无关，此项是一个常数，不会随 $k$ 衰减。由于模运算的存在，$e^{i k \\phi(x)}$ 的振荡对此项没有影响。\n- **结论**：**不正确**。\n\n**C. 设置 $q(x)\\propto \\lvert a(x)e^{i k \\phi(x)}\\rvert$ 能恰当地考虑相位，并确保绝对方差和相对方差都保持有界且与 $k$ 无关。**\n- **分析**：表达式 $\\lvert a(x)e^{i k \\phi(x)}\\rvert$ 简化为 $\\lvert a(x) \\rvert \\lvert e^{i k \\phi(x)} \\rvert = \\lvert a(x) \\rvert$。因此，该选项提出的密度与选项A中的相同，即 $q^{\\star}(x) \\propto \\lvert a(x) \\rvert$。这个选择并没有以任何有意义的方式“考虑相位”；它明确地忽略了相位。虽然绝对方差确实保持有界（它收敛到一个常数），但我们的推导表明，相对方差以 $\\mathcal{O}(k^d)$ 的速度增长，因此并非有界且与 $k$ 无关。\n- **结论**：**不正确**。\n\n**D. 如果允许 $q$ 依赖于 $k$，一个最优选择是 $q_{k}(x)\\propto \\lvert a(x)\\rvert$，这使得相对方差与 $k$ 无关；因此对于大的 $k$ 值，不需要在基于幅值的重要性采样之外进行额外的方差缩减。**\n- **分析**：该选项自相矛盾且事实错误。它建议允许 $q$ 依赖于 $k$，但随后提出的 $q(x) \\propto \\lvert a(x) \\rvert$ 却与 $k$ 无关。正如在主推导和对选项A的分析中所确立的，这种 $q$ 的选择导致相对方差以 $\\mathcal{O}(k^d)$ 的速度增长，这与 $k$ 并非无关。其结论认为不需要进一步的方差缩减是严重错误的，因为不断增长的相对方差正是为什么对于大的 $k$ 值需要更先进方法的原因。\n- **结论**：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}