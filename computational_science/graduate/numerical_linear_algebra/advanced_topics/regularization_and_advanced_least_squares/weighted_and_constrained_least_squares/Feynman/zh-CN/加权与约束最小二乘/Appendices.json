{
    "hands_on_practices": [
        {
            "introduction": "加权最小二乘（WLS）问题是数据科学中的基本工具，但直接求解其正规方程可能导致数值不稳定。本练习旨在通过奇异值分解（SVD）从第一性原理推导 WLS 的解，这种方法可以避免构造病态的 $A^T W A$ 矩阵。通过这个练习 ，您将深入理解 SVD 在求解最小二乘问题中的核心作用，并量化比较不同方法的数值稳定性。",
            "id": "3601195",
            "problem": "考虑一个加权最小二乘问题，其目标是关于对称正定权重矩阵 $W \\in \\mathbb{R}^{m \\times m}$ 最小化加权残差范数 $\\|A x - b\\|_{W}$。设 $W = L^{T} L$ 为一个Cholesky分解。众所周知，该问题等价于非加权最小二乘问题 $\\min_{x} \\|L(Ax - b)\\|_{2}$，此问题仅取决于矩阵 $L A$ 和 $L b$。给定可以直接使用的 $L A \\in \\mathbb{R}^{3 \\times 2}$ 和 $L b \\in \\mathbb{R}^{3}$：\n$$\nL A \\;=\\; \\begin{bmatrix}\n200  0 \\\\\n0  1 \\\\\n0  0\n\\end{bmatrix},\n\\qquad\nL b \\;=\\; \\begin{bmatrix}\n100 \\\\\n3 \\\\\n7\n\\end{bmatrix}.\n$$\n\n(a) 从最小二乘和奇异值分解 (SVD) 的基本定义出发，推导加权最小二乘问题的最小化解 $x^{\\star}$，过程中不构造 $A^{T} W A$。你的推导应通过将问题建模为 $\\min_{x} \\|C x - d\\|_{2}$（其中 $C = L A$，$d = L b$）来进行，然后使用 $C$ 的奇异值分解 (SVD) 来表示 $x^{\\star}$（用SVD因子表示）。不要假设任何预先给出的“捷径”公式；相反，应从SVD的正交性和最优性性质出发进行推理。\n\n(b) 使用你基于SVD的表达式，为给定的 $L A$ 和 $L b$ 计算 $x^{\\star}$ 的数值。\n\n(c) 为了进行数值稳定性比较，使用谱条件数 $\\kappa_{2}(\\cdot)$ 来量化正规方程法相对于基于SVD方法的敏感度。计算\n$$\nR \\;=\\; \\frac{\\kappa_{2}\\!\\left((L A)^{T} (L A)\\right)}{\\kappa_{2}(L A)}.\n$$\n解释为什么 $R$ 能够捕捉到由构造正规方程所引起的条件放大效应，并为给定数据计算 $R$ 的值。\n\n以行向量 $[\\,x_1^{\\star},\\, x_2^{\\star},\\, R\\,]$ 的形式提供你的最终数值摘要。本题无需四舍五入。",
            "solution": "所述问题是有效的。它在科学上基于数值线性代数的原理，是良态的且有唯一解，并且表述客观。求解所需的所有数据均已提供，且没有内部矛盾。\n\n任务是求解一个加权最小二乘问题，该问题可表述为一个等价的非加权最小二乘问题：\n$$\n\\min_{x \\in \\mathbb{R}^2} \\|C x - d\\|_{2}\n$$\n其中 $C = LA$ 且 $d = Lb$。给定的矩阵是：\n$$\nC \\;=\\; \\begin{bmatrix}\n200  0 \\\\\n0  1 \\\\\n0  0\n\\end{bmatrix},\n\\qquad\nd \\;=\\; \\begin{bmatrix}\n100 \\\\\n3 \\\\\n7\n\\end{bmatrix}\n$$\n\n(a) 基于SVD的最小化解 $x^{\\star}$ 的推导：\n\n我们希望找到最小化残差的欧几里得范数 $\\|Cx - d\\|_{2}$ 的向量 $x^{\\star}$。最小化范数等价于最小化其平方 $\\|Cx - d\\|_{2}^{2}$。\n\n设矩阵 $C \\in \\mathbb{R}^{m \\times n}$ 的奇异值分解 (SVD) 为 $C = U \\Sigma V^{T}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是包含奇异值 $\\sigma_i$ 的对角矩阵。\n将SVD代入平方范数表达式，我们得到：\n$$\n\\|Cx - d\\|_{2}^{2} = \\|U \\Sigma V^{T} x - d\\|_{2}^{2}\n$$\n由于欧几里得范数在正交变换下是不变的，我们可以在范数内的向量左侧乘以 $U^{T}$ 而不改变范数的值。这是因为 $\\|y\\|_2^2 = y^T y$，对于正交矩阵 $U$，有 $(U^T y)^T (U^T y) = y^T U U^T y = y^T I y = y^T y = \\|y\\|_2^2$。\n$$\n\\|Cx - d\\|_{2}^{2} = \\|U^{T}(U \\Sigma V^{T} x - d)\\|_{2}^{2} = \\|(U^{T}U) \\Sigma V^{T} x - U^{T} d\\|_{2}^{2} = \\|\\Sigma V^{T} x - U^{T} d\\|_{2}^{2}\n$$\n我们进行变量替换，令 $y = V^{T} x$。由于 $V$ 是正交的，所以 $V^T V = I$，我们可以通过 $x = V y$ 来恢复 $x$。这个变换将空间 $\\mathbb{R}^n$ 映射到其自身，因此对 $x$ 的最小化等价于对 $y$ 的最小化。令 $\\tilde{d} = U^{T} d$。问题现在转化为：\n$$\n\\min_{y \\in \\mathbb{R}^n} \\|\\Sigma y - \\tilde{d}\\|_{2}^{2}\n$$\n令 $r$ 为 $C$ 的秩。奇异值为 $\\sigma_1 \\geq \\sigma_2 \\geq \\dots \\geq \\sigma_r > 0$，且对于 $i > r$，$\\sigma_i = 0$。矩阵 $\\Sigma$ 具有分块结构 $\\Sigma = \\begin{pmatrix} \\Sigma_r  0 \\\\ 0  0 \\end{pmatrix}$，其中 $\\Sigma_r = \\mathrm{diag}(\\sigma_1, \\dots, \\sigma_r)$。我们相应地对向量 $y$ 和 $\\tilde{d}$ 进行分块：\n$$\ny = \\begin{pmatrix} y_r \\\\ y_{n-r} \\end{pmatrix}, \\quad \\tilde{d} = \\begin{pmatrix} \\tilde{d}_r \\\\ \\tilde{d}_{m-r} \\end{pmatrix}\n$$\n其中 $y_r, \\tilde{d}_r \\in \\mathbb{R}^r$。平方范数变为：\n$$\n\\|\\Sigma y - \\tilde{d}\\|_{2}^{2} = \\left\\| \\begin{pmatrix} \\Sigma_r  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} y_r \\\\ y_{n-r} \\end{pmatrix} - \\begin{pmatrix} \\tilde{d}_r \\\\ \\tilde{d}_{m-r} \\end{pmatrix} \\right\\|_{2}^{2} = \\left\\| \\begin{pmatrix} \\Sigma_r y_r - \\tilde{d}_r \\\\ - \\tilde{d}_{m-r} \\end{pmatrix} \\right\\|_{2}^{2} = \\|\\Sigma_r y_r - \\tilde{d}_r\\|_{2}^{2} + \\|\\tilde{d}_{m-r}\\|_{2}^{2}\n$$\n为了最小化此表达式，我们必须选择 $y_r$ 以最小化第一项 $\\|\\Sigma_r y_r - \\tilde{d}_r\\|_{2}^{2}$。第二项 $\\|\\tilde{d}_{m-r}\\|_{2}^{2}$ 是残差的平方范数，与 $y$ 无关。由于 $\\Sigma_r$ 是一个对角元素为正的对角矩阵，它是可逆的。第一项的最小值是 $0$，在 $\\Sigma_r y_r - \\tilde{d}_r = 0$ 时取得，这给出 $y_r = \\Sigma_r^{-1} \\tilde{d}_r$。\n\n$y$ 的分量 $y_{n-r}$ 不影响残差范数。为了得到唯一解，通常寻求 $x$ 的最小范数解，这对应于 $y$ 的最小范数解。这可以通过将自由分量设为零得到：$y_{n-r} = 0$。\n\n因此，$y$ 的解是 $y^{\\star}$，其前 $r$ 个分量由 $y_r = \\Sigma_r^{-1} \\tilde{d}_r$ 给出，其余 $n-r$ 个分量为 $0$。这可以使用 $\\Sigma$ 的伪逆（表示为 $\\Sigma^{\\dagger}$）紧凑地表示为 $y^{\\star} = \\Sigma^{\\dagger} \\tilde{d}$。\n\n最后，变换回原始变量 $x$，我们得到最小化解 $x^{\\star}$：\n$$\nx^{\\star} = V y^{\\star} = V \\Sigma^{\\dagger} \\tilde{d} = V \\Sigma^{\\dagger} (U^{T} d) = (V \\Sigma^{\\dagger} U^{T}) d\n$$\n表达式 $V \\Sigma^{\\dagger} U^{T}$ 是 $C$ 的Moore-Penrose伪逆的定义，表示为 $C^{\\dagger}$。因此，解是 $x^{\\star} = C^{\\dagger} d$。\n\n(b) $x^{\\star}$ 的数值计算：\n\n首先，我们求 $C = \\begin{bmatrix} 200  0 \\\\ 0  1 \\\\ 0  0 \\end{bmatrix}$ 的SVD。奇异值是 $C^T C$ 的特征值的平方根。\n$$\nC^{T}C = \\begin{bmatrix} 200  0  0 \\\\ 0  1  0 \\end{bmatrix} \\begin{bmatrix} 200  0 \\\\ 0  1 \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 40000  0 \\\\ 0  1 \\end{bmatrix}\n$$\n特征值为 $\\lambda_1 = 40000$ 和 $\\lambda_2 = 1$。奇异值为 $\\sigma_1 = \\sqrt{40000} = 200$ 和 $\\sigma_2 = \\sqrt{1} = 1$。由于 $C$ 是一个 $3 \\times 2$ 矩阵，$\\Sigma$ 的SVD形式为：\n$$\n\\Sigma = \\begin{bmatrix} 200  0 \\\\ 0  1 \\\\ 0  0 \\end{bmatrix}\n$$\n右奇异向量（$V$ 的列）是 $C^T C$ 的特征向量。由于 $C^T C$ 是对角矩阵，特征向量是标准基向量，所以 $V = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} = I_2$。\n左奇异向量（$U$ 的列）由 $u_i = \\frac{1}{\\sigma_i} C v_i$ 给出，对于 $i=1, 2$。\n$$\nu_1 = \\frac{1}{200} \\begin{bmatrix} 200  0 \\\\ 0  1 \\\\ 0  0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n$$\nu_2 = \\frac{1}{1} \\begin{bmatrix} 200  0 \\\\ 0  1 \\\\ 0  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}\n$$\n为了构成正交矩阵 $U \\in \\mathbb{R}^{3 \\times 3}$，我们需要第三个向量 $u_3$ 与 $u_1$ 和 $u_2$ 正交。一个明确的选择是 $u_3 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$。因此，$U = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} = I_3$。\n$C$ 的SVD为 $C = I_3 \\Sigma I_2^T$。\n\n现在我们计算 $x^{\\star} = V \\Sigma^{\\dagger} U^T d$。\n伪逆 $\\Sigma^{\\dagger} \\in \\mathbb{R}^{2 \\times 3}$ 是通过取非零奇异值的倒数然后转置所得矩阵得到的。\n$$\n\\Sigma^{\\dagger} = \\begin{bmatrix} 1/200  0  0 \\\\ 0  1/1  0 \\end{bmatrix} = \\begin{bmatrix} 1/200  0  0 \\\\ 0  1  0 \\end{bmatrix}\n$$\n使用 $V=I_2$ 和 $U=I_3$，$x^{\\star}$ 的表达式简化为：\n$$\nx^{\\star} = I_2 \\Sigma^{\\dagger} I_3^T d = \\Sigma^{\\dagger} d\n$$\n代入 $\\Sigma^{\\dagger}$ 和 $d$ 的值：\n$$\nx^{\\star} = \\begin{bmatrix} 1/200  0  0 \\\\ 0  1  0 \\end{bmatrix} \\begin{bmatrix} 100 \\\\ 3 \\\\ 7 \\end{bmatrix} = \\begin{bmatrix} (1/200) \\times 100 \\\\ 1 \\times 3 \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ 3 \\end{bmatrix}\n$$\n所以，$x_1^{\\star} = 1/2$ 且 $x_2^{\\star} = 3$。\n\n(c) 条件数分析：\n\n矩阵 $M$ 的谱条件数是 $\\kappa_2(M) = \\frac{\\sigma_{\\max}(M)}{\\sigma_{\\min}(M)}$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是 $M$ 的最大和最小奇异值。对于 $C=LA$，奇异值为 $\\sigma_1 = 200$ 和 $\\sigma_2 = 1$。因此，\n$$\n\\kappa_2(C) = \\frac{200}{1} = 200\n$$\n正规方程法需要求解 $(C^T C) x = C^T d$。该系统的敏感度由 $\\kappa_2(C^T C)$ 决定。对于像 $C^T C$ 这样的对称正定矩阵，其奇异值就是它的特征值，所以 $\\kappa_2(C^T C) = \\frac{\\lambda_{\\max}(C^T C)}{\\lambda_{\\min}(C^T C)}$。\n$C^T C$ 的特征值是 $C$ 的奇异值的平方。因此，$\\lambda_{\\max}(C^T C) = \\sigma_{\\max}(C)^2$ 且 $\\lambda_{\\min}(C^T C) = \\sigma_{\\min}(C)^2$。\n所以，$\\kappa_2(C^T C) = \\frac{\\sigma_{\\max}(C)^2}{\\sigma_{\\min}(C)^2} = \\left(\\frac{\\sigma_{\\max}(C)}{\\sigma_{\\min}(C)}\\right)^2 = (\\kappa_2(C))^2$。\n对于给定的矩阵 $C$，我们有：\n$$\n\\kappa_2(C^T C) = (200)^2 = 40000\n$$\n比率 $R$ 是：\n$$\nR = \\frac{\\kappa_{2}(C^{T} C)}{\\kappa_{2}(C)} = \\frac{(\\kappa_2(C))^2}{\\kappa_2(C)} = \\kappa_2(C)\n$$\n对于给定的数据，$R = 200$。\n\n量 $R$ 捕捉了条件数的放大效应，因为它是正规方程法中矩阵的条件数与SVD（或QR）方法中矩阵的条件数之比。正规方程法求解一个涉及 $C^T C$ 的线性系统，其条件数为 $\\kappa_2(C^T C)$。而直接处理 $C$ 的方法，如SVD或QR分解，面对的问题其数值敏感度由 $\\kappa_2(C)$ 控制。\n由于 $R = \\kappa_2(C)$，这个比率告诉我们 $\\kappa_2(C^T C) = R \\times \\kappa_2(C) = (\\kappa_2(C))^2$。条件数的这种平方现象是正规方程的一个标志性特征。如果 $C$ 是病态的（即 $\\kappa_2(C)$ 很大），构造 $C^T C$ 会导致一个病态程度显著增加的问题。这可能导致在求解系统时出现严重的数值精度损失，因为数据中相对误差的潜在放大与条件数成比例。在这种情况下，构造正规方程创建了一个对扰动比原始最小二乘问题矩阵所隐含的敏感度高200倍的系统。\n\n数值结果摘要：$x_1^{\\star} = 1/2$，$x_2^{\\star} = 3$，$R = 200$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & 3 & 200 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "当最小二乘问题附加等式约束时，我们需要在满足约束的条件下找到最优解。零空间法提供了一种优雅且稳健的解决思路：将解空间分解为一个满足约束的特解和约束矩阵的零空间。这个练习  将引导您一步步实现该方法，通过参数化可行集，将一个复杂的等式约束最小二乘（ECLS）问题转化为一个简单的无约束加权最小二乘问题。",
            "id": "3601196",
            "problem": "考虑在加权最小二乘 (WLS) 框架下的等式约束最小二乘 (ECLS) 问题：在线性等式约束条件下，最小化线性模型的加权残差范数。加权残差范数定义为残差左乘权重矩阵的平方根后的欧几里得范数。具体来说，设设计矩阵为 $A \\in \\mathbb{R}^{4 \\times 3}$，观测向量为 $b \\in \\mathbb{R}^{4}$，对称正定权重矩阵为 $W \\in \\mathbb{R}^{4 \\times 4}$。设等式约束由 $C \\in \\mathbb{R}^{2 \\times 3}$ 和 $d \\in \\mathbb{R}^{2}$ 给出。\n\n使用数据\n$$\nA=\\begin{pmatrix}\n2  0  1 \\\\\n0  1  1 \\\\\n1  1  0 \\\\\n0  2  3\n\\end{pmatrix},\\quad\nb=\\begin{pmatrix}\n3 \\\\ 1 \\\\ 2 \\\\ 5\n\\end{pmatrix},\\quad\nW=\\operatorname{diag}(1,2,3,1),\n$$\n以及约束条件\n$$\nC=\\begin{pmatrix}\n1  -1  0 \\\\\n1  1  1\n\\end{pmatrix},\\quad\nd=\\begin{pmatrix}\n0 \\\\ 1\n\\end{pmatrix}.\n$$\n\n从加权目标函数 $f(x)=\\|W^{1/2}(A x-b)\\|_{2}^{2}$ 和等式约束 $C x=d$ 的基本定义出发，执行以下步骤，不使用任何预先推导的快捷公式：为 $C$ 的零空间构建一组满足 $C Z=0$ 的基 $Z$，找到一个满足 $C x_{p}=d$ 的可行特解 $x_{p}$，对一个合适的参数 $y$ 将可行集参数化为 $x=x_{p}+Z y$，将约束问题简化为关于 $y$ 的无约束 WLS 问题，并求解唯一的最小化子 $y^{\\star}$。然后计算最小化的加权残差平方和\n$$\nJ^{\\star}=\\min_{C x=d}\\|W^{1/2}(A x-b)\\|_{2}^{2}.\n$$\n\n请将 $J^{\\star}$ 的最终答案表示为一个精确值。无需四舍五入。最终答案必须是一个实数。",
            "solution": "本题是求解一个等式约束最小二乘 (ECLS) 问题。具体来说，我们要找到解 $x \\in \\mathbb{R}^{3}$，使其在满足线性等式约束 $C x=d$ 的条件下，最小化加权目标函数 $J(x) = \\|W^{1/2}(A x-b)\\|_{2}^{2}$。\n\n### 步骤 1：提取已知条件\n提供的数据如下：\n- 设计矩阵：$A=\\begin{pmatrix} 2  0  1 \\\\ 0  1  1 \\\\ 1  1  0 \\\\ 0  2  3 \\end{pmatrix} \\in \\mathbb{R}^{4 \\times 3}$\n- 观测向量：$b=\\begin{pmatrix} 3 \\\\ 1 \\\\ 2 \\\\ 5 \\end{pmatrix} \\in \\mathbb{R}^{4}$\n- 权重矩阵：$W=\\operatorname{diag}(1, 2, 3, 1) \\in \\mathbb{R}^{4 \\times 4}$\n- 约束矩阵：$C=\\begin{pmatrix} 1  -1  0 \\\\ 1  1  1 \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 3}$\n- 约束向量：$d=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\in \\mathbb{R}^{2}$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是数值线性代数中一个定义明确的等式约束加权最小二乘问题的实例。\n- **科学依据**：该问题基于线性代数和优化的既定原理。权重矩阵 $W$ 是对角矩阵，且对角线元素均为正数，因此它是对称正定的，这是加权最小二乘问题的标准要求。\n- **适定性**：矩阵和向量的维度对于所涉及的运算是一致的。约束矩阵 $C$ 是一个 $2 \\times 3$ 矩阵。其行向量线性无关，因此其秩为 $2$。由于 $C$ 具有满行秩，约束系统 $Cx=d$ 是相容的，存在可行解。所述方法（零空间参数化）会导出一个唯一解，因为由此产生的无约束问题将有一个满列秩的矩阵 $AZ$。\n- **客观性**：问题陈述包含了精确的数学定义和数值数据，没有歧义或主观性。\n\n问题是有效的。\n\n### 步骤 3：执行\n问题是有效的，因此我将继续求解。解题过程将遵循问题陈述中指定的方法。总体目标是找到 $x^{\\star} = \\arg\\min_{Cx=d} (A x-b)^T W (A x-b)$，然后计算最小目标值 $J^{\\star}$。\n\n**1. 描述可行集**\n约束方程 $Cx=d$ 的所有解的集合可以写成 $x = x_p + z_h$，其中 $x_p$ 是 $Cx_p=d$ 的任意一个特解，而 $z_h$ 是 $C$ 的零空间中的任意向量（即 $Cz_h = 0$）。\n\n**1a. 找到 $C$ 的零空间的一组基 $Z$。**\n我们需要找到向量 $z = \\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\end{pmatrix}$ 使得 $Cz=0$。\n$$\n\\begin{pmatrix}\n1  -1  0 \\\\\n1  1  1\n\\end{pmatrix}\n\\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出了方程组：\n1. $z_1 - z_2 = 0 \\implies z_1 = z_2$\n2. $z_1 + z_2 + z_3 = 0$\n\n将第一个方程代入第二个方程得到 $z_1 + z_1 + z_3 = 0 \\implies 2z_1 + z_3 = 0 \\implies z_3 = -2z_1$。\n零空间中的任意向量形式为 $\\begin{pmatrix} s \\\\ s \\\\ -2s \\end{pmatrix}$，其中 $s \\in \\mathbb{R}$ 为某个标量。零空间是一维的。我们可以选择 $s=1$ 来构成一个基向量。\n$C$ 的零空间的一组基由矩阵 $Z$ 的列给出：\n$$\nZ = \\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix}\n$$\n\n**1b. 找到一个特解 $x_p$。**\n我们需要找到任意一个满足 $Cx_p=d$ 的向量 $x_p = \\begin{pmatrix} x_{p1} \\\\ x_{p2} \\\\ x_{p3} \\end{pmatrix}$。\n$$\n\\begin{pmatrix}\n1  -1  0 \\\\\n1  1  1\n\\end{pmatrix}\n\\begin{pmatrix} x_{p1} \\\\ x_{p2} \\\\ x_{p3} \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n这给出了方程组：\n1. $x_{p1} - x_{p2} = 0 \\implies x_{p1} = x_{p2}$\n2. $x_{p1} + x_{p2} + x_{p3} = 1$\n\n这是一个欠定系统。我们可以将一个变量设置为一个方便的值。设 $x_{p3}=0$。\n那么 $x_{p1} + x_{p2} = 1$。代入 $x_{p1} = x_{p2}$，我们得到 $2x_{p1} = 1 \\implies x_{p1} = \\frac{1}{2}$。\n因此，$x_{p1} = \\frac{1}{2}$ 且 $x_{p2} = \\frac{1}{2}$。一个特解是：\n$$\nx_p = \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 0 \\end{pmatrix}\n$$\n\n**2. 简化为无约束 WLS 问题**\n任何可行解 $x$ 都可以参数化为 $x = x_p + Zy$，其中 $y \\in \\mathbb{R}$（因为零空间是一维的，所以 $y$ 是一个标量）。我们将此代入目标函数：\n$$\nJ(y) = (A(x_p + Zy) - b)^T W (A(x_p + Zy)-b)\n$$\n整理各项，我们得到：\n$$\nJ(y) = (AZy - (b-Ax_p))^T W (AZy - (b-Ax_p))\n$$\n这是一个关于变量 $y$ 的无约束加权最小二乘问题。令 $A_y = AZ$ 和 $b_y = b-Ax_p$。问题变为最小化 $J(y) = \\|W^{1/2}(A_y y - b_y)\\|_2^2$。\n\n**3. 计算 $A_y$ 和 $b_y$。**\n首先，我们计算 $A_y = AZ$：\n$$\nA_y = \\begin{pmatrix} 2  0  1 \\\\ 0  1  1 \\\\ 1  1  0 \\\\ 0  2  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 2(1)+0(1)+1(-2) \\\\ 0(1)+1(1)+1(-2) \\\\ 1(1)+1(1)+0(-2) \\\\ 0(1)+2(1)+3(-2) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 2 \\\\ -4 \\end{pmatrix}\n$$\n接下来，我们计算 $b_y = b - Ax_p$。首先，求 $Ax_p$：\n$$\nAx_p = \\begin{pmatrix} 2  0  1 \\\\ 0  1  1 \\\\ 1  1  0 \\\\ 0  2  3 \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2(1/2)+0(1/2)+1(0) \\\\ 0(1/2)+1(1/2)+1(0) \\\\ 1(1/2)+1(1/2)+0(0) \\\\ 0(1/2)+2(1/2)+3(0) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1/2 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n现在，计算 $b_y$：\n$$\nb_y = b - Ax_p = \\begin{pmatrix} 3 \\\\ 1 \\\\ 2 \\\\ 5 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1/2 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1/2 \\\\ 1 \\\\ 4 \\end{pmatrix}\n$$\n\n**4. 求解最优参数 $y^{\\star}$。**\n关于 $y$ 的无约束 WLS 问题通过正规方程求解：\n$$\n(A_y^T W A_y) y = A_y^T W b_y\n$$\n让我们计算各项。\n标量项 $A_y^T W A_y$：\n$$\nA_y^T W A_y = \\begin{pmatrix} 0  -1  2  -4 \\end{pmatrix} \\begin{pmatrix} 1  0  0  0 \\\\ 0  2  0  0 \\\\ 0  0  3  0 \\\\ 0  0  0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\\\ 2 \\\\ -4 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 0  -2  6  -4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -1 \\\\ 2 \\\\ -4 \\end{pmatrix} = 0(0)+(-2)(-1)+6(2)+(-4)(-4) = 0+2+12+16 = 30\n$$\n标量项 $A_y^T W b_y$：\n$$\nA_y^T W b_y = \\begin{pmatrix} 0  -2  6  -4 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1/2 \\\\ 1 \\\\ 4 \\end{pmatrix} = 0(2)+(-2)(1/2)+6(1)+(-4)(4) = 0-1+6-16 = -11\n$$\n正规方程为 $30 y = -11$。最优参数是：\n$$\ny^{\\star} = -\\frac{11}{30}\n$$\n\n**5. 计算最小化的加权残差平方和 $J^{\\star}$。**\n目标函数的最小值为 $J^{\\star} = J(y^{\\star}) = \\|W^{1/2}(A_y y^{\\star} - b_y)\\|_2^2$。设无约束残差为 $r_y^{\\star} = A_y y^{\\star} - b_y$。\n$$\nr_y^{\\star} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 2 \\\\ -4 \\end{pmatrix} \\left(-\\frac{11}{30}\\right) - \\begin{pmatrix} 2 \\\\ 1/2 \\\\ 1 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 11/30 \\\\ -22/30 \\\\ 44/30 \\end{pmatrix} - \\begin{pmatrix} 60/30 \\\\ 15/30 \\\\ 30/30 \\\\ 120/30 \\end{pmatrix} = \\frac{1}{30} \\begin{pmatrix} -60 \\\\ -4 \\\\ -52 \\\\ -76 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -4/30 \\\\ -52/30 \\\\ -76/30 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -2/15 \\\\ -26/15 \\\\ -38/15 \\end{pmatrix}\n$$\n现在我们计算 $J^{\\star} = (r_y^{\\star})^T W r_y^{\\star}$：\n$$\nJ^{\\star} = \\begin{pmatrix} -2  -2/15  -26/15  -38/15 \\end{pmatrix} \\begin{pmatrix} 1  0  0  0 \\\\ 0  2  0  0 \\\\ 0  0  3  0 \\\\ 0  0  0  1 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ -2/15 \\\\ -26/15 \\\\ -38/15 \\end{pmatrix}\n$$\n$$\nJ^{\\star} = 1(-2)^2 + 2\\left(-\\frac{2}{15}\\right)^2 + 3\\left(-\\frac{26}{15}\\right)^2 + 1\\left(-\\frac{38}{15}\\right)^2\n$$\n$$\nJ^{\\star} = 4 + 2\\left(\\frac{4}{225}\\right) + 3\\left(\\frac{676}{225}\\right) + \\frac{1444}{225}\n$$\n$$\nJ^{\\star} = 4 + \\frac{8}{225} + \\frac{2028}{225} + \\frac{1444}{225}\n$$\n$$\nJ^{\\star} = \\frac{4 \\cdot 225}{225} + \\frac{8 + 2028 + 1444}{225} = \\frac{900}{225} + \\frac{3480}{225}\n$$\n$$\nJ^{\\star} = \\frac{900 + 3480}{225} = \\frac{4380}{225}\n$$\n为了化简分数，我们可以用分子和分母的最大公约数去除它们。两者都可以被 $5$ 整除：\n$$\n\\frac{4380 \\div 5}{225 \\div 5} = \\frac{876}{45}\n$$\n两者都可以被 $3$ 整除：\n$$\n\\frac{876 \\div 3}{45 \\div 3} = \\frac{292}{15}\n$$\n分子 $292 = 4 \\times 73$ 和分母 $15 = 3 \\times 5$ 没有共同因子。因此，该分数为最简形式。\n\n最小化的加权残差平方和是 $J^{\\star} = \\frac{292}{15}$。",
            "answer": "$$\n\\boxed{\\frac{292}{15}}\n$$"
        },
        {
            "introduction": "许多实际应用要求最小二乘解的元素满足非负性或和为一等不等式约束，例如在投资组合优化或概率分布拟合中。这些问题属于二次规划的范畴，其解由 Karush–Kuhn–Tucker (KKT) 条件决定。本练习  将带您探索在一个带单纯形约束的加权最小二乘问题中，如何运用 KKT 系统来分析解的结构，并理解权重参数如何影响哪些约束在最优点处被激活。",
            "id": "3601243",
            "problem": "考虑带单纯形约束的加权最小二乘问题：最小化二次目标函数，约束条件为非负性和各项和为一，\n$$\\min_{x \\in \\mathbb{R}^{3}} \\ (x - y)^{\\top} W (x - y) \\quad \\text{subject to} \\quad x \\ge 0, \\ \\mathbf{1}^{\\top} x = 1,$$\n其中 $y \\in \\mathbb{R}^{3}$ 是给定目标，$W \\in \\mathbb{R}^{3 \\times 3}$ 是一个对角正定矩阵。在本例中，取\n$$y = \\begin{pmatrix} \\frac{9}{10} \\\\ \\frac{3}{10} \\\\ \\frac{1}{2} \\end{pmatrix}, \\quad W = \\operatorname{diag}\\!\\left(2,\\ 1,\\ t\\right),$$\n其中 $t > 0$ 是一个标量参数。由于严格凸性，解 $x^{\\star}(t)$ 是唯一的，并且依赖于 Karush–Kuhn–Tucker (KKT) 系统，该系统的结构决定了 $x^{\\star}(t)$ 的哪些分量位于边界 $x_i^{\\star}(t) = 0$ 上。\n\n从约束凸优化的基本原理出发，\n- 推导出此问题的 KKT 系统，\n- 解释 $W$ 中的異方差对角权重如何导致在 $t$ 变化时不同的坐标变为激活状态（触及边界），\n- 并确定第三个坐标 $x_{3}^{\\star}(t)$ 在边界上变为激活状态，即 $x_{3}^{\\star}(t^{\\star}) = 0$ 同时满足其他 KKT 条件时的精确临界值 $t^{\\star} > 0$。\n\n给出 $t^{\\star}$ 的精确值作为最终答案。无需四舍五入。",
            "solution": "所述问题是一个约束二次优化问题，具体来说是在标准2-单纯形上的加权最小二乘最小化问题。该问题是适定的且有科学依据。目标函数是严格凸的，可行集是一个紧凸多胞体。因此，对于任何给定的参数 $t > 0$，都存在唯一的解。该问题是有效的。\n\n我们被要求找到参数 $t$ 的临界值，记为 $t^{\\star}$，在该值下最优解的第三个分量 $x_3^{\\star}(t)$ 变为零。这对应于约束 $x_3 \\ge 0$ 变为激活状态。\n\n该优化问题是：\n$$ \\min_{x \\in \\mathbb{R}^{3}} f(x) = (x - y)^{\\top} W (x - y) $$\n约束条件为：\n$$ \\sum_{i=1}^{3} x_i = 1 $$\n$$ x_i \\ge 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n给定数据为：\n$$ y = \\begin{pmatrix} \\frac{9}{10} \\\\ \\frac{3}{10} \\\\ \\frac{1}{2} \\end{pmatrix}, \\quad W = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  t \\end{pmatrix}, \\quad t > 0 $$\n\n为了解决这个约束优化问题，我们使用 Karush–Kuhn–Tucker (KKT) 条件。首先，我们构建拉格朗日函数 $L(x, \\lambda, \\mu)$，它包含了目标函数、非负性不等式约束 $g_i(x) = -x_i \\le 0$ 以及单纯形等式约束 $h(x) = \\mathbf{1}^{\\top} x - 1 = 0$。令 $\\lambda = (\\lambda_1, \\lambda_2, \\lambda_3)^{\\top}$ 为不等式约束的拉格朗日乘子，$\\mu$ 为等式约束的拉格朗日乘子。\n\n拉格朗日函数为：\n$$ L(x, \\lambda, \\mu) = (x - y)^{\\top} W (x - y) - \\sum_{i=1}^{3} \\lambda_i x_i + \\mu \\left( \\sum_{i=1}^{3} x_i - 1 \\right) $$\n\n最优解 $x^{\\star}$ 的 KKT 条件是：\n$1$. **平稳性**：拉格朗日函数关于 $x$ 的梯度在 $x=x^{\\star}$ 处必须为零。\n$$ \\nabla_x L(x^{\\star}, \\lambda, \\mu) = 2W(x^{\\star} - y) - \\lambda + \\mu\\mathbf{1} = 0 $$\n$2$. **原始可行性**：解 $x^{\\star}$ 必须满足所有约束。\n$$ \\sum_{i=1}^{3} x_i^{\\star} = 1 \\quad \\text{and} \\quad x^{\\star} \\ge 0 $$\n$3$. **对偶可行性**：不等式约束的乘子必须为非负。\n$$ \\lambda_i \\ge 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n$4$. **互补松弛性**：每个不等式乘子与其对应约束松弛量的乘积必须为零。\n$$ \\lambda_i x_i^{\\star} = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n平稳性条件按分量写出为：\n$$ 2w_i(x_i^{\\star} - y_i) - \\lambda_i + \\mu = 0 \\quad \\text{for } i \\in \\{1, 2, 3\\} $$\n\n矩阵 $W$ 中的对角权重 $w_i$ 代表对目标向量 $y$ 相应分量的置信度。较大的权重 $w_i$ 意味着对平方偏差 $|x_i - y_i|^2$ 有更高的惩罚，从而将最优解分量 $x_i^{\\star}$ 拉近 $y_i$。这是异方差模型的特征，其中观测值具有非均匀方差。参数 $t = w_3$ 控制对第三个分量的惩罚。随着 $t$ 的变化，解 $x^{\\star}(t)$ 在单纯形上描绘出一条路径。当其他分量和单纯形约束的相互竞争影响超过了朝向正值 $y_i$ 的拉力时，约束 $x_i \\ge 0$ 就会变为激活状态（即 $x_i^{\\star} = 0$）。\n\n我们正在寻找临界值 $t^{\\star}$，使得 $x_3^{\\star}(t^{\\star}) = 0$。在这样一个转换点，一个约束“刚好”变为激活状态。对于这种情况，一个一般性假设是相应的对偶变量为零。因此，我们将寻找一个满足 KKT 条件且 $x_3^{\\star}=0$ 和 $\\lambda_3=0$ 的解。此外，我们假设对于这个特定的临界点，其他分量不在其边界上，即 $x_1^{\\star} > 0$ 和 $x_2^{\\star} > 0$。\n\n在这些假设下，互补松弛性条件 $\\lambda_1 x_1^{\\star} = 0$ 和 $\\lambda_2 x_2^{\\star} = 0$ 意味着 $\\lambda_1 = 0$ 和 $\\lambda_2 = 0$。\n所以，在临界点 $t^{\\star}$，我们有以下一组条件：\n- $x_1^{\\star} + x_2^{\\star} = 1$ (因为 $x_3^{\\star}=0$)\n- $x_1^{\\star}>0, x_2^{\\star}>0$\n- $\\lambda_1 = 0, \\lambda_2 = 0, \\lambda_3 = 0$\n\n我们将这些代入平稳性方程：\n对于 $i=1$：$w_1=2, y_1=\\frac{9}{10}$。\n$$ 2(2)(x_1^{\\star} - \\frac{9}{10}) - 0 + \\mu = 0 \\implies 4x_1^{\\star} - \\frac{36}{10} + \\mu = 0 \\implies x_1^{\\star} = \\frac{1}{4}\\left(\\frac{18}{5} - \\mu\\right) $$\n对于 $i=2$：$w_2=1, y_2=\\frac{3}{10}$。\n$$ 2(1)(x_2^{\\star} - \\frac{3}{10}) - 0 + \\mu = 0 \\implies 2x_2^{\\star} - \\frac{6}{10} + \\mu = 0 \\implies x_2^{\\star} = \\frac{1}{2}\\left(\\frac{3}{5} - \\mu\\right) $$\n对于 $i=3$：$w_3=t, y_3=\\frac{1}{2}$。\n$$ 2(t)(x_3^{\\star} - \\frac{1}{2}) - 0 + \\mu = 0 $$\n根据我们的条件 $x_3^{\\star}=0$，这变为：\n$$ 2t(0 - \\frac{1}{2}) + \\mu = 0 \\implies -t + \\mu = 0 \\implies \\mu = t $$\n这给了我们在临界点 $t=t^{\\star}$ 时乘子 $\\mu$ 的值。现在我们将 $\\mu = t^{\\star}$ 代入 $x_1^{\\star}$ 和 $x_2^{\\star}$ 的表达式中：\n$$ x_1^{\\star} = \\frac{1}{4}\\left(\\frac{18}{5} - t^{\\star}\\right) $$\n$$ x_2^{\\star} = \\frac{1}{2}\\left(\\frac{3}{5} - t^{\\star}\\right) $$\n使用约束 $x_1^{\\star} + x_2^{\\star} = 1$：\n$$ \\frac{1}{4}\\left(\\frac{18}{5} - t^{\\star}\\right) + \\frac{1}{2}\\left(\\frac{3}{5} - t^{\\star}\\right) = 1 $$\n两边乘以 $4$ 以消去分母：\n$$ \\left(\\frac{18}{5} - t^{\\star}\\right) + 2\\left(\\frac{3}{5} - t^{\\star}\\right) = 4 $$\n$$ \\frac{18}{5} - t^{\\star} + \\frac{6}{5} - 2t^{\\star} = 4 $$\n$$ \\frac{24}{5} - 3t^{\\star} = 4 $$\n$$ 3t^{\\star} = \\frac{24}{5} - 4 = \\frac{24}{5} - \\frac{20}{5} = \\frac{4}{5} $$\n$$ t^{\\star} = \\frac{4}{15} $$\n我们必须验证对于这个 $t^{\\star}$ 值，我们的假设 $x_1^{\\star} > 0$ 和 $x_2^{\\star} > 0$ 是否成立。\n当 $t^{\\star} = \\frac{4}{15}$ 时：\n$$ \\mu = t^{\\star} = \\frac{4}{15} $$\n$$ x_1^{\\star} = \\frac{1}{4}\\left(\\frac{18}{5} - \\frac{4}{15}\\right) = \\frac{1}{4}\\left(\\frac{54-4}{15}\\right) = \\frac{1}{4}\\left(\\frac{50}{15}\\right) = \\frac{1}{4}\\left(\\frac{10}{3}\\right) = \\frac{5}{6} $$\n$$ x_2^{\\star} = \\frac{1}{2}\\left(\\frac{3}{5} - \\frac{4}{15}\\right) = \\frac{1}{2}\\left(\\frac{9-4}{15}\\right) = \\frac{1}{2}\\left(\\frac{5}{15}\\right) = \\frac{1}{2}\\left(\\frac{1}{3}\\right) = \\frac{1}{6} $$\n由于 $x_1^{\\star} = \\frac{5}{6} > 0$ 且 $x_2^{\\star} = \\frac{1}{6} > 0$，我们的假设是一致的。解为 $x^{\\star}(t^{\\star}) = (\\frac{5}{6}, \\frac{1}{6}, 0)^{\\top}$，它在 $\\lambda = (0,0,0)^{\\top}$ 和 $\\mu = \\frac{4}{15}$ 的情况下满足所有 KKT 条件。因此，$t$ 的临界值确实是 $\\frac{4}{15}$。对于 $t > t^{\\star}$，解 $x^{\\star}(t)$ 将会有 $x_3^{\\star}(t) > 0$。对于 $t  t^{\\star}$，解将被钉在边界上，此时 $x_3^{\\star}(t) = 0$ 且有相应的乘子 $\\lambda_3  0$。",
            "answer": "$$\\boxed{\\frac{4}{15}}$$"
        }
    ]
}