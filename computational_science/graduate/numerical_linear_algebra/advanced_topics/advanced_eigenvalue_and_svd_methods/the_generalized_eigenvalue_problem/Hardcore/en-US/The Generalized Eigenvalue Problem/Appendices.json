{
    "hands_on_practices": [
        {
            "introduction": "A natural first thought when faced with the generalized eigenvalue problem $A x = \\lambda B x$ is to simply compute $C = B^{-1}A$ and solve the standard problem for $C$. This exercise reveals the hidden numerical dangers of this seemingly straightforward approach. By analyzing a carefully constructed matrix pencil, you will derive the condition number of an eigenvalue and discover how it can become arbitrarily large even when the matrices $A$ and $B$ are perfectly well-conditioned, underscoring the critical need for numerically stable generalized eigensolvers .",
            "id": "3587876",
            "problem": "Let $n=2$ and let $\\varepsilon \\in (0,1)$ be a real parameter. Consider the generalized eigenvalue problem $A_{\\varepsilon} x = \\lambda B x$ with\n$$\nA_{\\varepsilon} \\;=\\; \\begin{pmatrix} 1  1 \\\\ \\varepsilon  1 \\end{pmatrix}, \n\\qquad\nB \\;=\\; I_{2}.\n$$\nBy definition, the generalized eigenvalues are the roots of $\\det(A_{\\varepsilon} - \\lambda B) = 0$, equivalently the eigenvalues of $B^{-1}A_{\\varepsilon} = A_{\\varepsilon}$. Work from first principles in numerical linear algebra: start from the definition of the generalized eigenvalue problem and the first-order perturbation model for $(A,B)$, and use norm-based reasoning to arrive at a condition number for a simple generalized eigenvalue in terms of its left and right eigenvectors.\n\nYour tasks are:\n\n- Justify, using only foundational definitions, that $B$ is well-conditioned in the matrix $2$-norm for every $\\varepsilon \\in (0,1)$, and that $A_{\\varepsilon}$ remains well-conditioned as $\\varepsilon \\to 0^{+}$ in the matrix $2$-norm. You may quantify the conditioning of $A_{\\varepsilon}$ by analyzing the eigenvalues of $A_{\\varepsilon}^{*}A_{\\varepsilon}$.\n\n- Let $\\lambda_{+}(\\varepsilon)$ denote the larger generalized eigenvalue of the pencil $(A_{\\varepsilon},B)$. Derive, from the perturbation model for $A x = \\lambda B x$, a closed-form expression for the eigenvalue condition number of $\\lambda_{+}(\\varepsilon)$ in the $2$-norm in terms of $\\varepsilon$, expressed using the left and right eigenvectors of the pencil $(A_{\\varepsilon},B)$.\n\nProvide as your final answer the exact analytic expression you obtain for this eigenvalue condition number as a function of $\\varepsilon$. No numerical rounding is required, and no units apply.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in numerical linear algebra, mathematically well-posed, objective, and contains all necessary information for a unique solution.\n\nThe problem consists of two main tasks. First, to analyze the conditioning of the matrices $B$ and $A_{\\varepsilon}$. Second, to derive the condition number for the larger eigenvalue of the pencil $(A_{\\varepsilon}, B)$.\n\n_**Part 1: Conditioning of Matrices $B$ and $A_{\\varepsilon}$**_\n\nThe condition number of an invertible matrix $M$ in the matrix $2$-norm is defined as $\\kappa_2(M) = \\|M\\|_2 \\|M^{-1}\\|_2$. A matrix is considered well-conditioned if its condition number is close to $1$.\n\n**Conditioning of $B$:**\nThe matrix $B$ is the $2 \\times 2$ identity matrix, $B = I_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$. The matrix $2$-norm, $\\|M\\|_2$, is the largest singular value of $M$, $\\sigma_{\\max}(M)$. The singular values are the square roots of the eigenvalues of $M^*M$.\nFor $B = I_2$, we have $B^*B = I_2^T I_2 = I_2$. The eigenvalues of $I_2$ are $\\lambda_1 = 1$ and $\\lambda_2 = 1$. The singular values of $B$ are thus $\\sigma_1 = \\sqrt{1} = 1$ and $\\sigma_2 = \\sqrt{1} = 1$.\nTherefore, $\\|B\\|_2 = \\sigma_{\\max}(B) = 1$.\nThe inverse of $B$ is $B^{-1} = I_2^{-1} = I_2$. Consequently, $\\|B^{-1}\\|_2 = \\|I_2\\|_2 = 1$.\nThe condition number of $B$ is $\\kappa_2(B) = \\|B\\|_2 \\|B^{-1}\\|_2 = 1 \\times 1 = 1$.\nA condition number of $1$ is the minimum possible value, which signifies that the matrix $B=I_2$ is perfectly well-conditioned. This holds for any value of the parameter $\\varepsilon$, as $B$ is constant.\n\n**Conditioning of $A_{\\varepsilon}$:**\nThe matrix $A_{\\varepsilon}$ is given by $A_{\\varepsilon} = \\begin{pmatrix} 1  1 \\\\ \\varepsilon  1 \\end{pmatrix}$. Its condition number is $\\kappa_2(A_{\\varepsilon}) = \\|A_{\\varepsilon}\\|_2 \\|A_{\\varepsilon}^{-1}\\|_2$. Since $A_\\varepsilon$ is invertible for $\\varepsilon \\in (0,1)$ ($\\det(A_\\varepsilon) = 1-\\varepsilon \\neq 0$), we can express the condition number as the ratio of the largest to the smallest singular value: $\\kappa_2(A_{\\varepsilon}) = \\frac{\\sigma_{\\max}(A_{\\varepsilon})}{\\sigma_{\\min}(A_{\\varepsilon})}$.\nThe singular values of $A_{\\varepsilon}$ are the square roots of the eigenvalues of $A_{\\varepsilon}^* A_{\\varepsilon} = A_{\\varepsilon}^T A_{\\varepsilon}$.\nWe compute $A_{\\varepsilon}^T A_{\\varepsilon}$:\n$$\nA_{\\varepsilon}^T A_{\\varepsilon} = \\begin{pmatrix} 1  \\varepsilon \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ \\varepsilon  1 \\end{pmatrix} = \\begin{pmatrix} 1+\\varepsilon^2  1+\\varepsilon \\\\ 1+\\varepsilon  2 \\end{pmatrix}\n$$\nLet $\\mu$ be an eigenvalue of $A_{\\varepsilon}^T A_{\\varepsilon}$. The eigenvalues are the roots of the characteristic equation $\\det(A_{\\varepsilon}^T A_{\\varepsilon} - \\mu I) = 0$:\n$$\n\\det \\begin{pmatrix} 1+\\varepsilon^2-\\mu  1+\\varepsilon \\\\ 1+\\varepsilon  2-\\mu \\end{pmatrix} = (1+\\varepsilon^2-\\mu)(2-\\mu) - (1+\\varepsilon)^2 = 0\n$$\nExpanding this gives:\n$$\n\\mu^2 - (3+\\varepsilon^2)\\mu + (2+2\\varepsilon^2) - (1+2\\varepsilon+\\varepsilon^2) = 0\n$$\n$$\n\\mu^2 - (3+\\varepsilon^2)\\mu + (1-2\\varepsilon+\\varepsilon^2) = 0\n$$\n$$\n\\mu^2 - (3+\\varepsilon^2)\\mu + (1-\\varepsilon)^2 = 0\n$$\nTo analyze the conditioning as $\\varepsilon \\to 0^{+}$, we examine the limit of the eigenvalues $\\mu$. As $\\varepsilon \\to 0^{+}$, the matrix $A_{\\varepsilon}$ approaches $A_0 = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$, and the characteristic equation for the eigenvalues of $A_0^T A_0$ becomes:\n$$\n\\mu^2 - 3\\mu + 1 = 0\n$$\nThe roots of this quadratic equation are $\\mu = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$. Both roots are positive and finite. Let them be $\\mu_{\\max,0} = \\frac{3+\\sqrt{5}}{2}$ and $\\mu_{\\min,0} = \\frac{3-\\sqrt{5}}{2}$.\nThe singular values of $A_0$ are $\\sigma_{\\max}(A_0) = \\sqrt{\\mu_{\\max,0}}$ and $\\sigma_{\\min}(A_0) = \\sqrt{\\mu_{\\min,0}}$.\nThe condition number of $A_0$ is:\n$$\n\\kappa_2(A_0) = \\frac{\\sigma_{\\max}(A_0)}{\\sigma_{\\min}(A_0)} = \\sqrt{\\frac{\\mu_{\\max,0}}{\\mu_{\\min,0}}} = \\sqrt{\\frac{3+\\sqrt{5}}{3-\\sqrt{5}}} = \\sqrt{\\frac{(3+\\sqrt{5})^2}{(3-\\sqrt{5})(3+\\sqrt{5})}} = \\sqrt{\\frac{9+6\\sqrt{5}+5}{9-5}} = \\sqrt{\\frac{14+6\\sqrt{5}}{4}} = \\frac{3+\\sqrt{5}}{2}\n$$\nSince the eigenvalues $\\mu$ of $A_{\\varepsilon}^T A_{\\varepsilon}$ are continuous functions of $\\varepsilon$, the condition number $\\kappa_2(A_{\\varepsilon})$ is also a continuous function of $\\varepsilon$. Therefore, as $\\varepsilon \\to 0^{+}$,\n$$\n\\lim_{\\varepsilon \\to 0^{+}} \\kappa_2(A_{\\varepsilon}) = \\kappa_2(A_0) = \\frac{3+\\sqrt{5}}{2} \\approx 2.618\n$$\nSince the condition number of $A_{\\varepsilon}$ approaches a small, finite value as $\\varepsilon \\to 0^{+}$, the matrix $A_{\\varepsilon}$ remains well-conditioned in this limit.\n\n_**Part 2: Eigenvalue Condition Number**_\n\nWe start from the first-order perturbation model for the generalized eigenvalue problem $Ax = \\lambda Bx$. Let $\\lambda$ be a simple eigenvalue with corresponding right eigenvector $x$ and left eigenvector $y$, where $y^*A = \\lambda y^*B$. Consider a small perturbation to the matrices, $A \\to A+\\delta A$ and $B \\to B+\\delta B$, which results in perturbations to the eigenvalue and eigenvector: $\\lambda \\to \\lambda+\\delta\\lambda$ and $x \\to x+\\delta x$.\nThe perturbed system is $(A+\\delta A)(x+\\delta x) = (\\lambda+\\delta\\lambda)(B+\\delta B)(x+\\delta x)$.\nExpanding this and retaining only first-order terms in $\\delta A, \\delta B, \\delta\\lambda, \\delta x$:\n$$\nAx + A\\delta x + \\delta A x \\approx \\lambda Bx + \\lambda B\\delta x + \\lambda\\delta Bx + \\delta\\lambda Bx\n$$\nUsing the unperturbed equation $Ax = \\lambda Bx$, we simplify to:\n$$\n(A-\\lambda B)\\delta x + (\\delta A - \\lambda\\delta B)x \\approx \\delta\\lambda Bx\n$$\nLeft-multiplying by $y^*$:\n$$\ny^*(A-\\lambda B)\\delta x + y^*(\\delta A - \\lambda\\delta B)x \\approx y^*(\\delta\\lambda Bx)\n$$\nSince $y^*$ is the left eigenvector, $y^*(A-\\lambda B) = y^*A - \\lambda y^*B = 0$. The first term vanishes.\n$$\ny^*(\\delta A - \\lambda\\delta B)x = \\delta\\lambda (y^*Bx)\n$$\nAssuming $\\lambda$ is a simple eigenvalue, it can be shown that $y^*Bx \\neq 0$. Thus, we can express the eigenvalue perturbation $\\delta \\lambda$ as:\n$$\n\\delta\\lambda = \\frac{y^*(\\delta A - \\lambda\\delta B)x}{y^*Bx}\n$$\nFrom this expression, we can define the absolute condition number of the eigenvalue $\\lambda$ as the quantity that bounds the magnitude of $\\delta\\lambda$ in terms of the magnitudes of the perturbations. Using the triangle inequality and properties of matrix and vector norms:\n$$\n|\\delta\\lambda| \\le \\frac{|y^*(\\delta A)x| + |\\lambda||y^*(\\delta B)x|}{|y^*Bx|} \\le \\frac{\\|\\delta A\\|_2 \\|y\\|_2 \\|x\\|_2 + |\\lambda|\\|\\delta B\\|_2 \\|y\\|_2 \\|x\\|_2}{|y^*Bx|}\n$$\nThe expression $k(\\lambda) = \\frac{\\|y\\|_2\\|x\\|_2}{|y^*Bx|}$ is the standard definition of the condition number for a simple generalized eigenvalue $\\lambda$ of the pencil $(A,B)$.\n\nNow, we apply this to the specific problem. Here, $A = A_{\\varepsilon} = \\begin{pmatrix} 1  1 \\\\ \\varepsilon  1 \\end{pmatrix}$ and $B = I_2$. The generalized eigenvalue problem is equivalent to the standard one, $A_{\\varepsilon}x = \\lambda x$. The eigenvalues are the roots of $\\det(A_{\\varepsilon} - \\lambda I) = 0$:\n$$\n(1-\\lambda)^2 - \\varepsilon = 0 \\implies \\lambda = 1 \\pm \\sqrt{\\varepsilon}\n$$\nWe are interested in the larger eigenvalue, $\\lambda_{+}(\\varepsilon) = 1 + \\sqrt{\\varepsilon}$.\n\n**Right eigenvector for $\\lambda_+$**: We solve $(A_{\\varepsilon} - \\lambda_+ I)x = 0$:\n$$\n\\begin{pmatrix} 1-(1+\\sqrt{\\varepsilon})  1 \\\\ \\varepsilon  1-(1+\\sqrt{\\varepsilon}) \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} -\\sqrt{\\varepsilon}  1 \\\\ \\varepsilon  -\\sqrt{\\varepsilon} \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThe first row implies $-\\sqrt{\\varepsilon}x_1 + x_2 = 0$, so $x_2 = \\sqrt{\\varepsilon} x_1$. We can choose the right eigenvector $x$ as:\n$$\nx = \\begin{pmatrix} 1 \\\\ \\sqrt{\\varepsilon} \\end{pmatrix}\n$$\nThe $2$-norm of $x$ is $\\|x\\|_2 = \\sqrt{1^2 + (\\sqrt{\\varepsilon})^2} = \\sqrt{1+\\varepsilon}$.\n\n**Left eigenvector for $\\lambda_+$**: We solve $y^*A_{\\varepsilon} = \\lambda_+ y^*$, which is equivalent to $A_{\\varepsilon}^T y = \\lambda_+ y$:\n$$\n\\left( \\begin{pmatrix} 1  \\varepsilon \\\\ 1  1 \\end{pmatrix} - (1+\\sqrt{\\varepsilon})I \\right) y = \\begin{pmatrix} -\\sqrt{\\varepsilon}  \\varepsilon \\\\ 1  -\\sqrt{\\varepsilon} \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThe second row implies $y_1 - \\sqrt{\\varepsilon}y_2 = 0$, so $y_1 = \\sqrt{\\varepsilon} y_2$. We can choose the left eigenvector $y$ as:\n$$\ny = \\begin{pmatrix} \\sqrt{\\varepsilon} \\\\ 1 \\end{pmatrix}\n$$\nThe $2$-norm of $y$ is $\\|y\\|_2 = \\sqrt{(\\sqrt{\\varepsilon})^2 + 1^2} = \\sqrt{1+\\varepsilon}$.\n\n**Denominator term**: We compute $y^* B x$. Since $B = I_2$ and the vectors are real, this is $y^T x$:\n$$\ny^T x = \\begin{pmatrix} \\sqrt{\\varepsilon}  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\sqrt{\\varepsilon} \\end{pmatrix} = (\\sqrt{\\varepsilon})(1) + (1)(\\sqrt{\\varepsilon}) = 2\\sqrt{\\varepsilon}\n$$\nSince $\\varepsilon \\in (0,1)$, this term is non-zero, as expected for a simple eigenvalue.\n\n**Condition number**: We substitute these components into the formula for $k(\\lambda_+)$:\n$$\nk(\\lambda_{+}) = \\frac{\\|y\\|_2\\|x\\|_2}{|y^* B x|} = \\frac{(\\sqrt{1+\\varepsilon})(\\sqrt{1+\\varepsilon})}{|2\\sqrt{\\varepsilon}|}\n$$\nSince $\\varepsilon  0$, $|2\\sqrt{\\varepsilon}| = 2\\sqrt{\\varepsilon}$.\n$$\nk(\\lambda_{+}) = \\frac{1+\\varepsilon}{2\\sqrt{\\varepsilon}}\n$$\nThis is the closed-form expression for the eigenvalue condition number of $\\lambda_{+}(\\varepsilon)$.",
            "answer": "$$\\boxed{\\frac{1+\\varepsilon}{2\\sqrt{\\varepsilon}}}$$"
        },
        {
            "introduction": "Beyond numerical stability, the generalized eigenvalue problem introduces a richer spectral structure than its standard counterpart, including the possibility of eigenvalues at infinity. This practice delves into the theoretical heart of matrix pencils through the Weierstrass canonical form, which provides a complete blueprint of a pencil's eigenstructure . By analyzing a specific pencil, you will learn to identify not only finite defective eigenvalues but also the structure associated with infinite eigenvalues, giving you a complete picture of the landscape that numerical algorithms must navigate.",
            "id": "3587871",
            "problem": "Let $A,B \\in \\mathbb{C}^{3\\times 3}$ define a regular matrix pencil $A - \\lambda B$ for the generalized eigenvalue problem $A x = \\lambda B x$. Starting only from the core definitions of generalized eigenvalues, Jordan chains, and the Weierstrass canonical form, analyze the following specific pair\n$$\nA \\;=\\; \\begin{pmatrix}\n2  1  0 \\\\\n0  2  0 \\\\\n0  0  1\n\\end{pmatrix},\n\\qquad\nB \\;=\\; \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  0\n\\end{pmatrix}.\n$$\nYour tasks are:\n- Verify that the pencil $A - \\lambda B$ is regular and exhibits both a finite defective eigenvalue and an eigenvalue at infinity, using first principles.\n- Determine the complete Weierstrass canonical form of the pencil by explicitly identifying the finite Jordan blocks and the nilpotent blocks associated with the eigenvalue at infinity, together with invertible transformations that realize this canonical form.\n- Identify and justify the size of each Jordan chain for the finite eigenvalue and the nilpotent index of the infinite part.\n\nAs the final calculation, report the monic characteristic polynomial of the finite part of the pencil in its Weierstrass canonical form, written as a single closed-form expression in the indeterminate $\\lambda$.",
            "solution": "The problem requires a detailed analysis of the generalized eigenvalue problem $A x = \\lambda B x$ for the specific $3 \\times 3$ matrices\n$$\nA \\;=\\; \\begin{pmatrix}\n2  1  0 \\\\\n0  2  0 \\\\\n0  0  1\n\\end{pmatrix},\n\\qquad\nB \\;=\\; \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  0\n\\end{pmatrix}.\n$$\nThe analysis will proceed from first principles, beginning with the validation of the pencil's regularity and the nature of its eigenvalues.\n\nFirst, we verify that the pencil $A - \\lambda B$ is regular. A pencil is regular if the determinant of $A - \\lambda B$ is not identically zero for all $\\lambda \\in \\mathbb{C}$. We form the matrix $A - \\lambda B$:\n$$\nA - \\lambda B = \\begin{pmatrix}\n2  1  0 \\\\\n0  2  0 \\\\\n0  0  1\n\\end{pmatrix} - \\lambda \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  0\n\\end{pmatrix} = \\begin{pmatrix}\n2 - \\lambda  1  0 \\\\\n0  2 - \\lambda  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\nThe determinant is given by\n$$\n\\det(A - \\lambda B) = (2 - \\lambda) \\det \\begin{pmatrix} 2 - \\lambda  0 \\\\ 0  1 \\end{pmatrix} - (1) \\det \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} + 0 = (2 - \\lambda)(2 - \\lambda - 0) = (2 - \\lambda)^2.\n$$\nSince $p(\\lambda) = \\det(A - \\lambda B) = (2 - \\lambda)^2$ is a non-zero polynomial, the pencil $A - \\lambda B$ is regular.\n\nThe finite eigenvalues are the roots of $p(\\lambda) = 0$. Setting $(2 - \\lambda)^2 = 0$ yields a single finite eigenvalue $\\lambda_1 = 2$ with algebraic multiplicity $2$. To determine if this eigenvalue is defective, we find its geometric multiplicity, which is the dimension of the null space of $A - \\lambda_1 B$.\nFor $\\lambda_1 = 2$, we have\n$$\nA - 2B = \\begin{pmatrix}\n0  1  0 \\\\\n0  0  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\nThe null space is found by solving $(A - 2B)x = 0$:\n$$\n\\begin{pmatrix}\n0  1  0 \\\\\n0  0  0 \\\\\n0  0  1\n\\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{cases} x_2 = 0 \\\\ x_3 = 0 \\end{cases}.\n$$\nThe solution is of the form $x = \\begin{pmatrix} x_1 \\\\ 0 \\\\ 0 \\end{pmatrix} = x_1 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$. The null space, $\\ker(A-2B)$, is spanned by the vector $\\begin{pmatrix} 1  0  0 \\end{pmatrix}^T$. Thus, the geometric multiplicity of $\\lambda_1 = 2$ is $\\dim(\\ker(A-2B)) = 1$. Since the geometric multiplicity ($1$) is less than the algebraic multiplicity ($2$), the finite eigenvalue $\\lambda_1 = 2$ is defective.\n\nAn eigenvalue at infinity exists if the matrix $B$ is singular. We compute its determinant:\n$$\n\\det(B) = \\det \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} = 0.\n$$\nSince $\\det(B) = 0$, there is an eigenvalue at infinity. The algebraic multiplicity of the infinite eigenvalue is given by $n - \\deg(p(\\lambda))$, where $n=3$ is the matrix dimension and $\\deg(p(\\lambda))=2$. So, the algebraic multiplicity is $3 - 2 = 1$. The geometric multiplicity of the infinite eigenvalue is $\\dim(\\ker(B))$.\n$$\nB x = 0 \\implies \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\implies \\begin{cases} x_1 = 0 \\\\ x_2 = 0 \\end{cases}.\n$$\nThe null space $\\ker(B)$ is spanned by $\\begin{pmatrix} 0  0  1 \\end{pmatrix}^T$, so its dimension is $1$. Since the algebraic and geometric multiplicities are both $1$, the infinite eigenvalue is not defective.\n\nNext, we determine the Weierstrass canonical form (WCF) of the pencil. The WCF of a regular pencil $A - \\lambda B$ consists of two block-diagonal matrices, $P A Q$ and $P B Q$, for some invertible matrices $P$ and $Q$. The form is $P A Q = \\begin{pmatrix} J  0 \\\\ 0  I \\end{pmatrix}$ and $P B Q = \\begin{pmatrix} I  0 \\\\ 0  N \\end{pmatrix}$, where $J$ contains the Jordan blocks for the finite eigenvalues and $N$ contains the nilpotent blocks for the infinite eigenvalue.\nOur analysis indicates:\n- A finite part of size $2 \\times 2$ corresponding to the defective eigenvalue $\\lambda=2$. This must be a single Jordan block $J_2(2)$.\n- An infinite part of size $1 \\times 1$. This corresponds to a non-defective infinite eigenvalue, so the nilpotent block is $N_1 = (0)$.\n\nThus, the canonical structure is given by $J = J_2(2) = \\begin{pmatrix} 2  1 \\\\ 0  2 \\end{pmatrix}$ and $N = (0)$. The full canonical matrices are:\n$$\nA' = \\begin{pmatrix} J  0 \\\\ 0  I_1 \\end{pmatrix} = \\begin{pmatrix} 2  1  0 \\\\ 0  2  0 \\\\ 0  0  1 \\end{pmatrix}, \\qquad B' = \\begin{pmatrix} I_2  0 \\\\ 0  N \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\nWe observe that $A' = A$ and $B' = B$. The given matrices are already in Weierstrass canonical form. This implies that the transformation matrices can be chosen as the identity matrices, $P = I$ and $Q = I$.\n\nTo confirm this, we must identify the Jordan chains, which form the columns of $Q$.\nFor the finite eigenvalue $\\lambda=2$, we require a Jordan chain of length $2$, $\\{q_1, q_2\\}$, satisfying:\n$(A-2B)q_1 = 0$ (eigenvector)\n$(A-2B)q_2 = Bq_1$ (generalized eigenvector)\nFrom our earlier calculation, we can choose $q_1 = \\begin{pmatrix} 1  0  0 \\end{pmatrix}^T = e_1$.\nThen, we must solve $(A-2B)q_2 = B e_1$.\n$B e_1 = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = e_1$.\nThe equation becomes:\n$$\n\\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix} q_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\nThis implies the components of $q_2$ satisfy $q_{2,2} = 1$ and $q_{2,3} = 0$. The component $q_{2,1}$ is arbitrary. We can choose the simplest solution, $q_2 = \\begin{pmatrix} 0  1  0 \\end{pmatrix}^T = e_2$.\nThus, the Jordan chain for $\\lambda=2$ is $\\{e_1, e_2\\}$, and its size is $2$.\n\nFor the eigenvalue at infinity, we need a chain of vectors $\\{q_3, \\dots\\}$ starting with $q_3$ such that $Bq_3=0$. From our earlier calculation, we can choose $q_3 = \\begin{pmatrix} 0  0  1 \\end{pmatrix}^T = e_3$. A chain for an infinite eigenvalue has length $k$ if there exist vectors $q_3, \\dots, q_{k+2}$ s.t. $B q_3=0, B q_4 = A q_3, \\dots, B q_{k+2}=A q_{k+1}$, and $A q_{k+2}$ is not in the range of $B$. Here we check if the chain can be extended to length $2$. This would require solving $B x = A q_3$.\n$A q_3 = A e_3 = \\begin{pmatrix} 2  1  0 \\\\ 0  2  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = e_3$.\nThe equation is $B x = e_3$:\n$$\n\\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\nThe last row gives the contradiction $0 = 1$. Thus, there is no solution, and the chain cannot be extended. The chain for the infinite eigenvalue is $\\{e_3\\}$, and its length is $1$. The nilpotent index of the infinite part is the size of the largest nilpotent block, which is $1 \\times 1$. The index is therefore $1$.\n\nThe matrix $Q$ is constructed from these chain vectors: $Q = [q_1, q_2, q_3] = [e_1, e_2, e_3] = I$. With $P=I$ and $Q=I$, we have $PAQ=A$ and $PBQ=B$, confirming that the original matrices are the canonical form.\n\nFinally, we are asked for the monic characteristic polynomial of the finite part of the pencil in its Weierstrass canonical form. The finite part of the pencil is described by the pair $(J, I_2)$, forming the pencil $J - \\lambda I_2$. The finite Jordan block is $J = \\begin{pmatrix} 2  1 \\\\ 0  2 \\end{pmatrix}$. The characteristic polynomial is:\n$$\n\\det(J - \\lambda I_2) = \\det \\begin{pmatrix} 2 - \\lambda  1 \\\\ 0  2 - \\lambda \\end{pmatrix} = (2 - \\lambda)^2.\n$$\nTo make this polynomial monic, we multiply by $(-1)^2 = 1$:\n$$\n(\\lambda - 2)^2 = \\lambda^2 - 4\\lambda + 4.\n$$\nThis is the required monic characteristic polynomial.",
            "answer": "$$\n\\boxed{(\\lambda-2)^2}\n$$"
        },
        {
            "introduction": "Having established the motivation and theoretical underpinnings, we now turn to a practical method for computing solutions. This exercise provides a hands-on application of the shift-and-invert power method, a powerful iterative technique for finding specific eigenpairs of a generalized problem . You will perform one full step of this algorithm, from setting up and solving the linear system to updating the Rayleigh quotient, solidifying your understanding of how these problems are tackled computationally.",
            "id": "3587872",
            "problem": "Consider the generalized eigenvalue problem $A x = \\lambda B x$ for real symmetric matrices $A \\in \\mathbb{R}^{3 \\times 3}$ and $B \\in \\mathbb{R}^{3 \\times 3}$, where $B$ is symmetric positive definite (SPD). The generalized Rayleigh quotient for a nonzero vector $x \\in \\mathbb{R}^{3}$ is defined as $R(x) = \\frac{x^{\\top} A x}{x^{\\top} B x}$. In shift-and-invert power iteration for the generalized eigenvalue problem, the shift-and-invert transformation at a real shift $\\sigma$ is defined by the linear operator $T(\\sigma) = (A - \\sigma B)^{-1} B$. Starting from an initial vector $x_{0}$, one step of the iteration forms $y = T(\\sigma) x_{0}$ and updates the iterate to a rescaled version of $y$; the Rayleigh quotient $R(y)$ is invariant under nonzero rescaling of $y$.\n\nLet\n$$\nA = \\begin{pmatrix}\n7  2  1 \\\\\n2  6  0 \\\\\n1  0  5\n\\end{pmatrix}, \n\\quad\nB = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  0 \\\\\n0  0  2\n\\end{pmatrix},\n\\quad\n\\sigma = 1,\n\\quad\nx_{0} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\nCarry out one step of shift-and-invert power iteration by forming $y$ from the linear system $(A - \\sigma B) y = B x_{0}$, and then compute the updated generalized Rayleigh quotient $R(y) = \\frac{y^{\\top} A y}{y^{\\top} B y}$. Express your final answer as an exact value. Do not round.",
            "solution": "The problem requires the execution of one step of the shift-and-invert power iteration for a generalized eigenvalue problem and the subsequent computation of the generalized Rayleigh quotient. The given problem is valid as it is mathematically sound, well-posed, and all necessary data and definitions are provided. The matrices $A$ and $B$ are symmetric, $B$ is specified (and verified) to be symmetric positive definite, and the operator $(A - \\sigma B)$ for the given shift $\\sigma$ is invertible, ensuring a unique solution exists for the intermediate vector.\n\nThe first step is to set up the linear system $(A - \\sigma B) y = B x_{0}$. We are given:\n$$\nA = \\begin{pmatrix}\n7  2  1 \\\\\n2  6  0 \\\\\n1  0  5\n\\end{pmatrix}, \n\\quad\nB = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  0 \\\\\n0  0  2\n\\end{pmatrix},\n\\quad\n\\sigma = 1,\n\\quad\nx_{0} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\nWe compute the matrix on the left-hand side, which we denote as $M$:\n$$\nM = A - \\sigma B = A - 1 \\cdot B = \\begin{pmatrix}\n7  2  1 \\\\\n2  6  0 \\\\\n1  0  5\n\\end{pmatrix} - \\begin{pmatrix}\n4  1  0 \\\\\n1  3  0 \\\\\n0  0  2\n\\end{pmatrix} = \\begin{pmatrix}\n3  1  1 \\\\\n1  3  0 \\\\\n1  0  3\n\\end{pmatrix}.\n$$\nNext, we compute the vector on the right-hand side, which we denote as $v$:\n$$\nv = B x_{0} = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  0 \\\\\n0  0  2\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ 1\n\\end{pmatrix}\n= \\begin{pmatrix}\n4(1) + 1(0) + 0(1) \\\\\n1(1) + 3(0) + 0(1) \\\\\n0(1) + 0(0) + 2(1)\n\\end{pmatrix}\n= \\begin{pmatrix}\n4 \\\\ 1 \\\\ 2\n\\end{pmatrix}.\n$$\nNow we must solve the linear system of equations $M y = v$ for the vector $y = (y_1, y_2, y_3)^{\\top}$:\n$$\n\\begin{pmatrix}\n3  1  1 \\\\\n1  3  0 \\\\\n1  0  3\n\\end{pmatrix}\n\\begin{pmatrix}\ny_1 \\\\ y_2 \\\\ y_3\n\\end{pmatrix}\n= \\begin{pmatrix}\n4 \\\\ 1 \\\\ 2\n\\end{pmatrix}.\n$$\nThis corresponds to the system of equations:\n$1) \\quad 3y_1 + y_2 + y_3 = 4$\n$2) \\quad y_1 + 3y_2 = 1$\n$3) \\quad y_1 + 3y_3 = 2$\n\nFrom equation $2)$, we express $y_1$ as $y_1 = 1 - 3y_2$.\nFrom equation $3)$, we express $y_3$ in terms of $y_1$ as $y_3 = \\frac{1}{3}(2 - y_1)$. Substituting the expression for $y_1$:\n$y_3 = \\frac{1}{3}(2 - (1 - 3y_2)) = \\frac{1}{3}(1 + 3y_2) = \\frac{1}{3} + y_2$.\nNow, we substitute the expressions for $y_1$ and $y_3$ into equation $1)$:\n$3(1 - 3y_2) + y_2 + (\\frac{1}{3} + y_2) = 4$\n$3 - 9y_2 + 2y_2 + \\frac{1}{3} = 4$\n$\\frac{10}{3} - 7y_2 = 4$\n$-7y_2 = 4 - \\frac{10}{3} = \\frac{12 - 10}{3} = \\frac{2}{3}$\n$y_2 = -\\frac{2}{21}$.\n\nWe can now find $y_1$ and $y_3$:\n$y_1 = 1 - 3y_2 = 1 - 3(-\\frac{2}{21}) = 1 + \\frac{6}{21} = 1 + \\frac{2}{7} = \\frac{9}{7}$.\n$y_3 = \\frac{1}{3} + y_2 = \\frac{1}{3} - \\frac{2}{21} = \\frac{7}{21} - \\frac{2}{21} = \\frac{5}{21}$.\nSo, the vector $y$ is:\n$$\ny = \\begin{pmatrix} 9/7 \\\\ -2/21 \\\\ 5/21 \\end{pmatrix}.\n$$\nTo compute the generalized Rayleigh quotient, $R(y) = \\frac{y^{\\top} A y}{y^{\\top} B y}$, we can use a scaled version of $y$ to simplify the arithmetic, since $R(y)$ is invariant under non-zero scaling. Let's define $y' = 21y$:\n$$\ny' = 21 \\begin{pmatrix} 9/7 \\\\ -2/21 \\\\ 5/21 \\end{pmatrix} = \\begin{pmatrix} 27 \\\\ -2 \\\\ 5 \\end{pmatrix}.\n$$\nWe will compute $R(y) = R(y') = \\frac{(y')^{\\top} A y'}{(y')^{\\top} B y'}$.\n\nFirst, we compute the numerator, $N = (y')^{\\top} A y'$.\nWe calculate the product $A y'$:\n$$\nA y' = \\begin{pmatrix}\n7  2  1 \\\\\n2  6  0 \\\\\n1  0  5\n\\end{pmatrix}\n\\begin{pmatrix}\n27 \\\\ -2 \\\\ 5\n\\end{pmatrix}\n= \\begin{pmatrix}\n7(27) + 2(-2) + 1(5) \\\\\n2(27) + 6(-2) + 0(5) \\\\\n1(27) + 0(-2) + 5(5)\n\\end{pmatrix}\n= \\begin{pmatrix}\n189 - 4 + 5 \\\\\n54 - 12 + 0 \\\\\n27 + 0 + 25\n\\end{pmatrix}\n= \\begin{pmatrix}\n190 \\\\ 42 \\\\ 52\n\\end{pmatrix}.\n$$\nThen we compute the dot product for the numerator:\n$$\nN = (y')^{\\top} (A y') = \\begin{pmatrix} 27  -2  5 \\end{pmatrix} \\begin{pmatrix}\n190 \\\\ 42 \\\\ 52\n\\end{pmatrix} = 27(190) - 2(42) + 5(52) = 5130 - 84 + 260 = 5306.\n$$\nNext, we compute the denominator, $D = (y')^{\\top} B y'$.\nWe calculate the product $B y'$:\n$$\nB y' = \\begin{pmatrix}\n4  1  0 \\\\\n1  3  0 \\\\\n0  0  2\n\\end{pmatrix}\n\\begin{pmatrix}\n27 \\\\ -2 \\\\ 5\n\\end{pmatrix}\n= \\begin{pmatrix}\n4(27) + 1(-2) + 0(5) \\\\\n1(27) + 3(-2) + 0(5) \\\\\n0(27) + 0(-2) + 2(5)\n\\end{pmatrix}\n= \\begin{pmatrix}\n108 - 2 + 0 \\\\\n27 - 6 + 0 \\\\\n0 + 0 + 10\n\\end{pmatrix}\n= \\begin{pmatrix}\n106 \\\\ 21 \\\\ 10\n\\end{pmatrix}.\n$$\nThen we compute the dot product for the denominator:\n$$\nD = (y')^{\\top} (B y') = \\begin{pmatrix} 27  -2  5 \\end{pmatrix} \\begin{pmatrix}\n106 \\\\ 21 \\\\ 10\n\\end{pmatrix} = 27(106) - 2(21) + 5(10) = 2862 - 42 + 50 = 2870.\n$$\nFinally, we compute the Rayleigh quotient as the ratio of $N$ to $D$:\n$$\nR(y) = \\frac{N}{D} = \\frac{5306}{2870}.\n$$\nWe simplify this fraction. Both numerator and denominator are divisible by $2$:\n$$\nR(y) = \\frac{5306 \\div 2}{2870 \\div 2} = \\frac{2653}{1435}.\n$$\nTo simplify further, we find the prime factors of the denominator: $1435 = 5 \\times 287 = 5 \\times 7 \\times 41$.\nWe check if the numerator $2653$ is divisible by any of these factors. It is not divisible by $5$.\nFor $7$: $2653 \\div 7 = 379$.\nThus, the fraction can be reduced:\n$$\nR(y) = \\frac{2653}{1435} = \\frac{7 \\times 379}{7 \\times 205} = \\frac{379}{205}.\n$$\nThe denominator is $205 = 5 \\times 41$. The numerator $379$ is not divisible by $5$ or $41$ ($379 = 9 \\times 41 + 10$). A check reveals that $379$ is a prime number. Therefore, the fraction is in its simplest form.",
            "answer": "$$\\boxed{\\frac{379}{205}}$$"
        }
    ]
}