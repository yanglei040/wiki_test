{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最好的巩固方式莫过于亲手实践。本节我们从一个基础但核心的练习开始，即对一个简单的非线性特征值问题执行一步残差逆迭代（Residual Inverse Iteration, RII）。通过这个具体的计算过程 ，你将清晰地看到该方法如何计算残差、求解线性系统、以及更新特征向量和特征值，从而对迭代法的内在机制建立起直观的理解。",
            "id": "3561644",
            "problem": "考虑一个由矩阵值函数 $T(\\lambda) \\in \\mathbb{C}^{2 \\times 2}$ 定义的解析非线性特征值问题 (NEP)，其中一个特征对 $(\\lambda, x)$ 满足 $T(\\lambda)x = 0$ 且 $x \\neq 0$。设 $T(\\lambda)$ 由下式给出\n$$\nT(\\lambda) = A + (\\lambda + \\lambda^{2})\\,B,\n$$\n其中\n$$\nA = \\begin{pmatrix} -3  1 \\\\ 1  1 \\end{pmatrix}, \\qquad B = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n将迭代值 $(\\lambda_{k}, x_{k})$ 的残差定义为 $r_{k} = T(\\lambda_{k})x_{k}$。考虑执行一步带位移 $\\sigma$ 的残差反迭代 (RII)，该步骤定义如下：求解线性系统\n$$\nT(\\sigma) s_{k} = -r_{k},\n$$\n形成更新 $\\hat{x}_{k+1} = x_{k} + s_{k}$，归一化 $x_{k+1} = \\hat{x}_{k+1} / \\| \\hat{x}_{k+1} \\|_{2}$，然后选择 $\\lambda_{k+1}$ 作为标量非线性瑞利函数方程\n$$\nx_{k+1}^{*} T(\\lambda) x_{k+1} = 0\n$$\n的一个实数解，并约定如果存在多个实数解，则选择最接近位移 $\\sigma$ 的那一个。\n\n使用初始数据\n$$\nx_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\qquad \\lambda_{0} = 0, \\qquad \\sigma = 1,\n$$\n应用一步残差反迭代得到 $(x_{1}, \\lambda_{1})$。精确计算更新后的向量 $x_{1}$ 和标量 $\\lambda_{1}$。将你的最终答案表示为一个单行，其中包含 $x_{1}$ 的两个分量，后跟 $\\lambda_{1}$。",
            "solution": "该问题要求对给定的非线性特征值问题 $T(\\lambda)x=0$ 执行一步残差反迭代 (RII)。矩阵值函数为 $T(\\lambda) = A + (\\lambda + \\lambda^{2})B$，其中\n$$\nA = \\begin{pmatrix} -3  1 \\\\ 1  1 \\end{pmatrix}, \\qquad B = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n代入 $A$ 和 $B$，我们得到\n$$\nT(\\lambda) = \\begin{pmatrix} -3  1 \\\\ 1  1 \\end{pmatrix} + (\\lambda + \\lambda^{2})\\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} -3 + \\lambda + \\lambda^{2}  1 \\\\ 1  1 \\end{pmatrix}.\n$$\n迭代（$k=0$）的初始数据为\n$$\nx_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\qquad \\lambda_{0} = 0, \\qquad \\sigma = 1.\n$$\n我们遵循为一次 RII 迭代定义的步骤来求解 $(\\lambda_{1}, x_{1})$。\n\n**第1步：计算残差 $r_{0}$。**\n残差 $r_{k}$ 定义为 $r_{k} = T(\\lambda_{k})x_{k}$。对于 $k=0$，我们有\n$$\nr_{0} = T(\\lambda_{0})x_{0} = T(0)x_{0}.\n$$\n在 $\\lambda=0$ 时， $T(0) = A = \\begin{pmatrix} -3  1 \\\\ 1  1 \\end{pmatrix}$。\n$$\nr_{0} = \\begin{pmatrix} -3  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -3(1) + 1(1) \\\\ 1(1) + 1(1) \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 2 \\end{pmatrix}.\n$$\n\n**第2步：求解线性系统 $T(\\sigma)s_{0} = -r_{0}$。**\n位移是 $\\sigma=1$。我们首先计算 $T(\\sigma)$。\n$$\nT(1) = \\begin{pmatrix} -3 + 1 + 1^{2}  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} -1  1 \\\\ 1  1 \\end{pmatrix}.\n$$\n为求解更新向量 $s_{0} = \\begin{pmatrix} s_{0,1} \\\\ s_{0,2} \\end{pmatrix}$ 的线性系统是 $T(1)s_{0} = -r_{0}$。\n$$\n\\begin{pmatrix} -1  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} s_{0,1} \\\\ s_{0,2} \\end{pmatrix} = -\\begin{pmatrix} -2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -2 \\end{pmatrix}.\n$$\n这对应于以下线性方程组：\n$$\n\\begin{cases} -s_{0,1} + s_{0,2} = 2 \\\\ s_{0,1} + s_{0,2} = -2 \\end{cases}\n$$\n将两个方程相加得到 $2s_{0,2} = 0$，所以 $s_{0,2} = 0$。\n将 $s_{0,2}=0$ 代入第二个方程得到 $s_{0,1} + 0 = -2$，所以 $s_{0,1} = -2$。\n因此，解是 $s_{0} = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix}$。\n\n**第3步：形成未归一化的更新向量 $\\hat{x}_{1}$。**\n更新后的向量是 $\\hat{x}_{1} = x_{0} + s_{0}$。\n$$\n\\hat{x}_{1} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}.\n$$\n\n**第4步：归一化以得到 $x_{1}$。**\n新的特征向量近似值 $x_{1}$ 是 $\\hat{x}_{1}$ 的归一化。\n$$\nx_{1} = \\frac{\\hat{x}_{1}}{\\| \\hat{x}_{1} \\|_{2}} = \\frac{1}{\\sqrt{(-1)^{2} + 1^{2}}} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1/\\sqrt{2} \\\\ 1/\\sqrt{2} \\end{pmatrix}.\n$$\n将分母有理化，我们得到 $x_{1} = \\begin{pmatrix} -\\frac{\\sqrt{2}}{2} \\\\ \\frac{\\sqrt{2}}{2} \\end{pmatrix}$。\n\n**第5步：求解标量非线性瑞利函数方程以得到 $\\lambda_1$。**\n新的特征值近似值 $\\lambda_{1}$ 是方程 $x_{1}^{*} T(\\lambda) x_{1} = 0$ 的一个实数解。注意，使用未归一化的向量 $\\hat{x}_{1}$ 可以简化计算，因为 $x_{1}^{*} T(\\lambda) x_{1} = \\frac{1}{\\| \\hat{x}_{1} \\|_{2}^{2}} \\hat{x}_{1}^{*} T(\\lambda) \\hat{x}_{1} = 0$ 等价于 $\\hat{x}_{1}^{*} T(\\lambda) \\hat{x}_{1} = 0$。\n我们有 $\\hat{x}_{1} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$，所以其共轭转置是 $\\hat{x}_{1}^{*} = \\begin{pmatrix} -1  1 \\end{pmatrix}$。\n方程变为：\n$$\n\\begin{pmatrix} -1  1 \\end{pmatrix} \\begin{pmatrix} -3 + \\lambda + \\lambda^{2}  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = 0.\n$$\n首先，我们计算乘积 $T(\\lambda)\\hat{x}_{1}$：\n$$\nT(\\lambda)\\hat{x}_{1} = \\begin{pmatrix} -3 + \\lambda + \\lambda^{2}  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -(-3 + \\lambda + \\lambda^{2}) + 1 \\\\ -1 + 1 \\end{pmatrix} = \\begin{pmatrix} 4 - \\lambda - \\lambda^{2} \\\\ 0 \\end{pmatrix}.\n$$\n现在，我们用 $\\hat{x}_{1}^{*}$ 左乘：\n$$\n\\hat{x}_{1}^{*} (T(\\lambda)\\hat{x}_{1}) = \\begin{pmatrix} -1  1 \\end{pmatrix} \\begin{pmatrix} 4 - \\lambda - \\lambda^{2} \\\\ 0 \\end{pmatrix} = (-1)(4 - \\lambda - \\lambda^{2}) + (1)(0) = -4 + \\lambda + \\lambda^{2}.\n$$\n将此表达式设为零，得到关于 $\\lambda$ 的二次方程：\n$$\n\\lambda^{2} + \\lambda - 4 = 0.\n$$\n我们使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$ 求根：\n$$\n\\lambda = \\frac{-1 \\pm \\sqrt{1^{2} - 4(1)(-4)}}{2(1)} = \\frac{-1 \\pm \\sqrt{1 + 16}}{2} = \\frac{-1 \\pm \\sqrt{17}}{2}.\n$$\n两个实数解是 $\\lambda_{A} = \\frac{-1 - \\sqrt{17}}{2}$ 和 $\\lambda_{B} = \\frac{-1 + \\sqrt{17}}{2}$。\n\n**第6步：根据与位移 $\\sigma$ 的接近程度选择 $\\lambda_{1}$。**\n问题规定，如果存在多个实数解，我们必须选择最接近位移 $\\sigma=1$ 的那一个。\n我们比较距离 $|\\lambda_{A} - 1|$ 和 $|\\lambda_{B} - 1|$。\n$$\n\\lambda_{A} - 1 = \\frac{-1 - \\sqrt{17}}{2} - 1 = \\frac{-1 - \\sqrt{17} - 2}{2} = \\frac{-3 - \\sqrt{17}}{2}.\n$$\n$$\n\\lambda_{B} - 1 = \\frac{-1 + \\sqrt{17}}{2} - 1 = \\frac{-1 + \\sqrt{17} - 2}{2} = \\frac{-3 + \\sqrt{17}}{2}.\n$$\n因为 $4  \\sqrt{17}  5$，我们有 $-3 + \\sqrt{17} > 0$。\n距离的平方是：\n$$\n|\\lambda_{A} - 1|^{2} = \\left(\\frac{-3 - \\sqrt{17}}{2}\\right)^{2} = \\frac{9 + 6\\sqrt{17} + 17}{4} = \\frac{26 + 6\\sqrt{17}}{4}.\n$$\n$$\n|\\lambda_{B} - 1|^{2} = \\left(\\frac{-3 + \\sqrt{17}}{2}\\right)^{2} = \\frac{9 - 6\\sqrt{17} + 17}{4} = \\frac{26 - 6\\sqrt{17}}{4}.\n$$\n因为 $6\\sqrt{17} > 0$，显然 $\\frac{26 - 6\\sqrt{17}}{4}  \\frac{26 + 6\\sqrt{17}}{4}$，这意味着 $|\\lambda_{B}-1|  |\\lambda_{A}-1|$。\n因此，更接近 $\\sigma=1$ 的解是 $\\lambda_{B}$。我们设 $\\lambda_{1} = \\lambda_{B} = \\frac{-1 + \\sqrt{17}}{2}$。\n\n一步 RII 的结果是特征对 $(x_{1}, \\lambda_{1})$，其中 $x_{1} = \\begin{pmatrix} -\\frac{\\sqrt{2}}{2} \\\\ \\frac{\\sqrt{2}}{2} \\end{pmatrix}$ 且 $\\lambda_{1} = \\frac{-1 + \\sqrt{17}}{2}$。最终答案是一个行矩阵，包含 $x_1$ 的分量，后跟 $\\lambda_1$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{\\sqrt{2}}{2}  \\frac{\\sqrt{2}}{2}  \\frac{-1 + \\sqrt{17}}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "标准的数值方法在面对带有奇点（如极点）的非线性特征值问题时，常常会表现出不稳定的行为甚至失效。这个练习旨在培养你分析并解决此类问题的能力 。我们将从一个包含 $\\tan(\\lambda)$ 项的标量问题入手，分析标准牛顿法为何会失败，然后通过巧妙的代数变换将其重构为一个等价且稳健的无奇点问题，最后将这一思想推广到矩阵情形。",
            "id": "3561653",
            "problem": "考虑一个由超越方程 $t(\\lambda)=a+b\\tan(\\lambda)=0$ 给出的标量非线性特征值问题（NEP），其中 $a\\in\\mathbb{R}$，$b\\in\\mathbb{R}\\setminus\\{0\\}$，且 $\\lambda\\in\\mathbb{R}$。函数 $t(\\lambda)$ 在 $\\lambda=\\frac{\\pi}{2}+k\\pi$（$k\\in\\mathbb{Z}$）处有一阶极点。您的目标是设计一种在这些极点附近保持鲁棒性的求根方法，并将这些概念推广到包含 $\\tan(\\lambda)$ 项的矩阵NEP。\n\n从基本定义和第一性原理推导所有结果，例如牛顿类方法的一阶泰勒展开、基本初等函数的导数以及标准线性代数恒等式。不要假设或引用特定问题的快捷公式。\n\n任务：\n- 使用 $t(\\lambda)$ 在一个迭代点附近的一阶泰勒展开，推导一个求解 $t(\\lambda)=0$ 的牛顿类迭代法，并分析当 $\\lambda$ 趋近于最近的极点 $\\lambda_{0}=\\frac{\\pi}{2}+k\\pi$ 时更新量的行为。具体来说，根据到极点的有符号距离 $d=\\lambda-\\lambda_{0}$，求出更新量大小的领头阶渐近表达式。\n- 提出一种变换，以消除标量方程中 $\\tan(\\lambda)$ 的极点，并在远离奇点处产生一个局部二次收敛的方案。证明其鲁棒性，并以闭合形式陈述最终的迭代映射，包括一个在迭代中保持分支连续性的显式规则。\n- 将此方法推广到矩阵NEP $T(\\lambda)=A_{0}+A_{1}\\tan(\\lambda)$，其中 $A_{0},A_{1}\\in\\mathbb{C}^{n\\times n}$。引入一个由近似的左、右特征向量构造的标量瑞利泛函 $\\varphi(\\lambda)$，并基于第一性原理推导出 $\\lambda$ 的牛顿校正量。陈述该标量校正量的显式代数表达式，并解释如何实施分支跟踪以避免跨越极点。\n- 最后，特化到标量问题，其中 $a=-\\frac{1}{3}$ 且 $b=2$。在区间 $\\left(0,\\frac{\\pi}{2}\\right)$ 上，以精确解析形式确定唯一解 $\\lambda^{\\star}$。答案以弧度表示，不要四舍五入。\n\n您最终报告的答案必须是 $\\lambda^{\\star}$ 的单个精确解析表达式（最终答案框中不带单位）。",
            "solution": "该问题按提示中指定分为四个部分进行处理。\n\n标量非线性特征值问题（NEP）由方程 $t(\\lambda)=0$ 定义，其中函数 $t(\\lambda)$ 由下式给出\n$$t(\\lambda) = a + b\\tan(\\lambda)$$\n其中 $a \\in \\mathbb{R}$ 且 $b \\in \\mathbb{R}\\setminus\\{0\\}$。\n\n任务1：推导并分析求解 $t(\\lambda)=0$ 的牛顿类迭代法。\n牛顿类迭代法是通过函数 $t(\\lambda)$ 在当前迭代点 $\\lambda_k$ 附近的一阶泰勒级数展开推导出来的。展开式为\n$$t(\\lambda) \\approx t(\\lambda_k) + t'(\\lambda_k)(\\lambda - \\lambda_k)$$\n为了找到下一个迭代点 $\\lambda_{k+1}$，我们在近似式中令 $t(\\lambda_{k+1}) = 0$，得到\n$$0 \\approx t(\\lambda_k) + t'(\\lambda_k)(\\lambda_{k+1} - \\lambda_k)$$\n求解更新步长 $\\Delta\\lambda_k = \\lambda_{k+1} - \\lambda_k$，我们得到 $\\Delta\\lambda_k = -\\frac{t(\\lambda_k)}{t'(\\lambda_k)}$。因此迭代格式为\n$$\\lambda_{k+1} = \\lambda_k - \\frac{t(\\lambda_k)}{t'(\\lambda_k)}$$\n为应用此方法，我们必须计算 $t(\\lambda)$ 的导数：\n$$t'(\\lambda) = \\frac{d}{d\\lambda}(a + b\\tan(\\lambda)) = b\\sec^2(\\lambda)$$\n因此，求解 $t(\\lambda)=0$ 的牛顿迭代法为\n$$\\lambda_{k+1} = \\lambda_k - \\frac{a + b\\tan(\\lambda_k)}{b\\sec^2(\\lambda_k)}$$\n我们分析此迭代在极点附近的行为。$t(\\lambda)$ 的极点出现在 $\\tan(\\lambda)$ 是奇异的地方，即 $\\lambda_0 = \\frac{\\pi}{2} + k\\pi$，其中 $k \\in \\mathbb{Z}$ 为任意整数。设 $\\lambda$ 是靠近极点 $\\lambda_0$ 的一个迭代点，并令 $d = \\lambda - \\lambda_0$ 为有符号距离，其中 $|d| \\ll 1$。\n更新量为 $\\Delta\\lambda = -\\frac{t(\\lambda)}{t'(\\lambda)}$。为了便于在极点附近进行分析，将分子和分母同乘以 $\\cos^2(\\lambda)$，得到一个更方便的形式：\n$$\\Delta\\lambda = -\\frac{(a + b\\tan(\\lambda))\\cos^2(\\lambda)}{b} = -\\frac{a\\cos^2(\\lambda) + b\\sin(\\lambda)\\cos(\\lambda)}{b}$$\n现在，我们代入 $\\lambda = \\lambda_0 + d = \\frac{\\pi}{2} + k\\pi + d$。我们使用以下恒等式：\n$$\\cos(\\lambda) = \\cos\\left(\\frac{\\pi}{2} + k\\pi + d\\right) = (-1)^{k+1}\\sin(d)$$\n$$\\sin(\\lambda) = \\sin\\left(\\frac{\\pi}{2} + k\\pi + d\\right) = (-1)^{k}\\cos(d)$$\n将这些代入 $\\Delta\\lambda$ 的表达式中：\n$$\\cos^2(\\lambda) = \\sin^2(d)$$\n$$\\sin(\\lambda)\\cos(\\lambda) = (-1)^{k}\\cos(d) \\cdot (-1)^{k+1}\\sin(d) = -\\sin(d)\\cos(d)$$\n所以，更新量变为\n$$\\Delta\\lambda = -\\frac{a\\sin^2(d) - b\\sin(d)\\cos(d)}{b} = \\sin(d)\\cos(d) - \\frac{a}{b}\\sin^2(d)$$\n对于小的 $d$，我们使用泰勒展开 $\\sin(d) = d - \\frac{d^3}{6} + O(d^5)$ 和 $\\cos(d) = 1 - \\frac{d^2}{2} + O(d^4)$。\n$$\\Delta\\lambda = \\left(d - \\frac{d^3}{6} + \\dots\\right)\\left(1 - \\frac{d^2}{2} + \\dots\\right) - \\frac{a}{b}\\left(d - \\frac{d^3}{6} + \\dots\\right)^2$$\n$$\\Delta\\lambda = \\left(d - \\frac{d^3}{2} - \\frac{d^3}{6} + \\dots\\right) - \\frac{a}{b}\\left(d^2 - \\frac{d^4}{3} + \\dots\\right)$$\n$$\\Delta\\lambda = d - \\frac{a}{b}d^2 - \\frac{2}{3}d^3 + O(d^4)$$\n更新量中的领头阶项是 $d$。因此，更新量大小的领头阶渐近表达式为\n$$|\\Delta\\lambda| \\approx |d|$$\n这表明在极点附近，牛顿步长的大小约等于到极点的距离。下一个迭代点将大约是 $\\lambda_{k+1} = \\lambda_k + \\Delta\\lambda_k \\approx (\\lambda_0 + d) + d = \\lambda_0 + 2d$，将迭代点推离极点，这是不希望出现的行为。\n\n任务2：变换为鲁棒的方案。\n为了消除极点，我们重新构造问题。方程 $a + b\\tan(\\lambda) = 0$ 等价于 $a + b\\frac{\\sin(\\lambda)}{\\cos(\\lambda)} = 0$。假设我们不在极点处（即 $\\cos(\\lambda) \\neq 0$），我们可以乘以 $\\cos(\\lambda)$ 以获得一个没有奇点的等价方程：\n$$g(\\lambda) = a\\cos(\\lambda) + b\\sin(\\lambda) = 0$$\n这个函数 $g(\\lambda)$ 对所有 $\\lambda \\in \\mathbb{R}$ 都是解析的。我们可以对 $g(\\lambda) = 0$ 应用牛顿法。其导数为\n$$g'(\\lambda) = -a\\sin(\\lambda) + b\\cos(\\lambda)$$\n得到的迭代映射为\n$$\\lambda_{k+1} = \\lambda_k - \\frac{g(\\lambda_k)}{g'(\\lambda_k)} = \\lambda_k - \\frac{a\\cos(\\lambda_k) + b\\sin(\\lambda_k)}{-a\\sin(\\lambda_k) + b\\cos(\\lambda_k)}$$\n该方案是鲁棒的，因为对于所有实数 $\\lambda$，$g(\\lambda)$ 和 $g'(\\lambda)$ 都是有界的、连续的且可微的。迭代式中的分母在原极点位置不会趋于零。具体来说，在极点 $\\lambda_0 = \\frac{\\pi}{2}+k\\pi$ 处，我们有 $\\cos(\\lambda_0)=0$ 和 $|\\sin(\\lambda_0)|=1$，所以 $g(\\lambda_0) = \\pm b \\neq 0$ 且 $g'(\\lambda_0) = \\mp a$。迭代是良定义的。对牛顿法的标准分析表明，它对单根是局部二次收敛的。如果根处的 $g'(\\lambda) \\neq 0$，则该根为单根。如果对于同一个 $\\lambda$，$g(\\lambda)=0$ 且 $g'(\\lambda)=0$，那么 $a\\cos\\lambda+b\\sin\\lambda=0$ 且 $-a\\sin\\lambda+b\\cos\\lambda=0$。这意味着 $\\tan\\lambda=-a/b$ 且 $\\tan\\lambda=b/a$。这将要求 $-a/b = b/a$，即 $a^2+b^2=0$，这对于 $a,b \\in \\mathbb{R}$ 是不可能的，除非 $a=b=0$，但题目已给出 $b\\neq 0$。因此，所有根都是单根，收敛是局部二次的。\n\n$\\tan(\\lambda)=-a/b$ 的解是以 $\\pi$ 为周期的。为保持分支连续性，我们必须确保迭代不会在相差 $\\pi$ 的整数倍的解之间伪跳。令 $\\Delta_k = -g(\\lambda_k)/g'(\\lambda_k)$ 为计算出的牛顿更新量。如果 $|\\Delta_k|$ 很大，新的迭代点 $\\lambda_k+\\Delta_k$ 可能更接近另一个根。在解的形式 $\\lambda_m = \\arctan(-a/b) + m\\pi$ 中，分支由整数 $m$ 索引。为停留在某个分支上，更新步长应尽可能小。一个强制执行此操作的显式规则是将更新量调整 $\\pi$ 的整数倍，使其大小小于或等于 $\\pi/2$。校正后的更新量 $\\Delta_k'$ 为：\n$$\\Delta_k' = \\Delta_k - \\pi \\cdot \\text{round}\\left(\\frac{\\Delta_k}{\\pi}\\right)$$\n其中 $\\text{round}(x)$ 给出最接近 $x$ 的整数。最终的迭代映射为：\n$$\\lambda_{k+1} = \\lambda_k + \\Delta_k'$$\n\n任务3：推广到矩阵NEP。\n矩阵NEP为 $T(\\lambda) = A_0 + A_1\\tan(\\lambda) = 0$，这表示寻找一个标量 $\\lambda$ 使得 $T(\\lambda)$ 是一个奇异矩阵。给定近似特征值 $\\lambda$ 的近似左、右特征向量 $y$ 和 $x$，可以构造一个标量瑞利泛函 $\\varphi(\\lambda) = y^H T(\\lambda) x$。通过对标量方程 $\\varphi(\\lambda)=0$ 应用牛顿法，可以推导出 $\\lambda$ 的牛顿校正量。\n更新量 $\\delta = \\lambda_{new}-\\lambda$ 由下式给出\n$$\\delta = -\\frac{\\varphi(\\lambda)}{\\varphi'(\\lambda)} = -\\frac{y^H T(\\lambda) x}{y^H T'(\\lambda) x}$$\n其中我们假设 $x$ 和 $y$ 在对 $\\lambda$ 求导时是常数。\n为了推广消除极点的方法，我们定义一个正则化的矩阵函数 $G(\\lambda) = T(\\lambda)\\cos(\\lambda)$：\n$$G(\\lambda) = (A_0 + A_1\\tan(\\lambda))\\cos(\\lambda) = A_0\\cos(\\lambda) + A_1\\sin(\\lambda)$$\n这个问题的特征值与原问题相同，因为 $\\det(G(\\lambda)) = \\cos^n(\\lambda)\\det(T(\\lambda))$，所以当 $\\cos(\\lambda) \\neq 0$ 时，$\\det(G(\\lambda))=0$ 当且仅当 $\\det(T(\\lambda))=0$。\n$G(\\lambda)$ 的导数是\n$$G'(\\lambda) = -A_0\\sin(\\lambda) + A_1\\cos(\\lambda)$$\n$\\lambda$ 的牛顿校正量基于 $G(\\lambda)$ 的瑞利泛函，即 $\\psi(\\lambda) = y^H G(\\lambda) x$。校正量 $\\delta$ 为：\n$$\\delta = -\\frac{\\psi(\\lambda)}{\\psi'(\\lambda)} = -\\frac{y^H G(\\lambda) x}{y^H G'(\\lambda) x}$$\n代入 $G(\\lambda)$ 和 $G'(\\lambda)$ 的表达式，我们得到标量校正量的显式代数表达式：\n$$\\delta = - \\frac{y^H(A_0\\cos(\\lambda) + A_1\\sin(\\lambda))x}{y^H(-A_0\\sin(\\lambda) + A_1\\cos(\\lambda))x}$$\n矩阵NEP $T(\\lambda)$ 的特征值也以 $\\pi$ 为周期。这是因为奇点条件 $\\det(A_0 + A_1\\tan\\lambda)=0$ 导致了一个关于 $\\tau = \\tan\\lambda$ 的多项式。对于该多项式的每个根 $\\tau_j$，$\\lambda$ 的特征值为 $\\lambda_{j,m} = \\arctan(\\tau_j) + m\\pi$。\n为实施分支跟踪并避免在给定模式 $j$ 的不同整数 $m$ 之间跳转，应用与标量情况相同的规则。计算出的校正量 $\\delta$ 被调整为：\n$$\\delta' = \\delta - \\pi \\cdot \\text{round}\\left(\\frac{\\delta}{\\pi}\\right)$$\n特征值的下一个迭代点是 $\\lambda_{new} = \\lambda + \\delta'$。\n\n任务4：特定的标量问题。\n给定 $a = -1/3$ 和 $b = 2$。方程为\n$$-\\frac{1}{3} + 2\\tan(\\lambda) = 0$$\n我们需要在区间 $\\left(0, \\frac{\\pi}{2}\\right)$ 内找到唯一解 $\\lambda^{\\star}$。\n重新整理方程以解出 $\\tan(\\lambda)$：\n$$2\\tan(\\lambda) = \\frac{1}{3}$$\n$$\\tan(\\lambda) = \\frac{1}{6}$$\n通过对两边取反正切得到 $\\lambda$ 的解：\n$$\\lambda = \\arctan\\left(\\frac{1}{6}\\right)$$\n$\\arctan$ 函数的主值范围是 $\\left(-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right)$。由于自变量 $\\frac{1}{6}$ 是正的，所得角度在第一象限，即 $\\lambda \\in \\left(0, \\frac{\\pi}{2}\\right)$。正切函数在此区间上是严格单调的，因此该解是唯一的。\n因此，在指定区间内的唯一解是 $\\lambda^{\\star} = \\arctan\\left(\\frac{1}{6}\\right)$。",
            "answer": "$$\\boxed{\\arctan\\left(\\frac{1}{6}\\right)}$$"
        },
        {
            "introduction": "在求解特征值问题之前，对问题进行预处理是提升数值稳定性和解算精度的关键一步。二次特征值问题（Quadratic Eigenvalue Problem, QEP）的缩放（scaling）就是一个典型的例子。本练习将引导你分析如何通过选择合适的缩放参数来“平衡”系数矩阵的范数，从而改善问题的条件数 。这不仅是一个计算练习，更重要的是培养一种在应用数值算法前，主动考虑并改善问题性质的思维习惯。",
            "id": "3561669",
            "problem": "考虑数值线性代数中的二次特征值问题 (QEP)，\n$$\nQ(\\lambda) x \\;=\\; \\big(\\lambda^{2} M + \\lambda C + K\\big) x \\;=\\; 0,\n$$\n其中系数矩阵为 $M, C, K \\in \\mathbb{C}^{n\\times n}$。全文使用矩阵 $2$-范数。$Q(\\lambda)$ 的一个标准一阶伴随线性化是如下的广义特征值问题\n$$\n\\big(\\lambda A - B\\big) \\begin{bmatrix} x \\\\ y \\end{bmatrix} \\;=\\; 0,\n\\quad\\text{其中}\\quad\nA \\;=\\; \\begin{bmatrix} I  0 \\\\ 0  M \\end{bmatrix},\n\\quad\nB \\;=\\; \\begin{bmatrix} 0  I \\\\ -K  -C \\end{bmatrix},\n$$\n并且 $y = \\lambda x$ 保证了其与 $Q(\\lambda)$ 的等价性。为减轻病态问题，可以应用变量缩放 $\\lambda = \\tau \\mu$（其中 $\\tau  0$）和标量归一化 $Q \\mapsto \\widehat{Q}$，定义如下\n$$\n\\widehat{Q}(\\mu) \\;=\\; \\beta\\, Q(\\tau \\mu) \\;=\\; \\mu^{2} \\widehat{M} + \\mu \\widehat{C} + \\widehat{K},\n\\quad \\text{其中}\\quad\n\\widehat{M} \\;=\\; \\beta \\tau^{2} M,\\;\\; \\widehat{C} \\;=\\; \\beta \\tau C,\\;\\; \\widehat{K} \\;=\\; \\beta K.\n$$\n设系数矩阵的范数为\n$$\n\\|M\\| \\;=\\; 2\\times 10^{-4}, \\qquad \\|C\\| \\;=\\; 30, \\qquad \\|K\\| \\;=\\; 8\\times 10^{4}.\n$$\n从第一性原理出发，分析缩放 $(\\tau,\\beta)$ 如何影响：\n- 以 $\\|\\widehat{M}\\|$, $\\|\\widehat{C}\\|$, $\\|\\widehat{K}\\|$ 和 $|\\mu|$ 表示的、针对残差 $\\|\\widehat{Q}(\\mu)x\\|$ 的范数意义下的后向误差代理，以及\n- 伴随线性化矩阵块 $\\widehat{A} = \\begin{bmatrix} I  0 \\\\ 0  \\widehat{M} \\end{bmatrix}$ 和 $\\widehat{B} = \\begin{bmatrix} 0  I \\\\ -\\widehat{K}  -\\widehat{C} \\end{bmatrix}$ 的范数。\n\n然后，基于此分析，选择实现以下平衡策略的缩放：选择 $\\tau$ 以最小化\n$$\ng(\\tau) \\;=\\; \\max\\big\\{\\, \\tau^{2}\\|M\\|,\\; \\tau \\|C\\|,\\; \\|K\\| \\,\\big\\},\n$$\n并设置 $\\beta = 1/g(\\tau)$，使得 $\\max\\{\\|\\widehat{M}\\|,\\|\\widehat{C}\\|,\\|\\widehat{K}\\|\\} = 1$。哪个选项能实现这一目标，并且因此最适合用于平衡 $\\|\\widehat{M}\\|$, $\\|\\widehat{C}\\|$ 和 $\\|\\widehat{K}\\|$，同时改善该线性化的条件数代理？\n\nA. 选择 $\\tau = \\sqrt{\\|K\\|/\\|M\\|}$ 且 $\\beta = 1/\\|K\\|$。\n\nB. 选择 $\\tau = \\|K\\|/\\|C\\|$ 且 $\\beta = 1/\\|K\\|$。\n\nC. 选择 $\\tau = \\|C\\|/\\|M\\|$ 且 $\\beta = 1/(\\tau \\|C\\|)$。\n\nD. 选择 $\\tau = 1$ 且 $\\beta = 1/\\|K\\|$。\n\n通过选择唯一最佳选项来回答。",
            "solution": "**最优缩放参数的推导**\n\n问题的核心是实施指定的平衡策略。这涉及在 $\\tau > 0$ 上最小化函数 $g(\\tau) = \\max\\{f_1(\\tau), f_2(\\tau), f_3(\\tau)\\}$，其中：\n- $f_1(\\tau) = \\tau^2 \\|M\\| = (2\\times 10^{-4})\\tau^2$\n- $f_2(\\tau) = \\tau \\|C\\| = 30\\tau$\n- $f_3(\\tau) = \\|K\\| = 8\\times 10^{4}$\n\n上包络函数 $g(\\tau)$ 的最小值必须出现在其导数为零的点或不可微点（“扭折点”）。扭折点出现在函数 $f_1, f_2, f_3$ 中两个或多个相交的地方。让我们找出这些关于 $\\tau$ 的交点：\n- $f_1(\\tau) = f_3(\\tau) \\implies \\tau^2 \\|M\\| = \\|K\\| \\implies \\tau = \\sqrt{\\frac{\\|K\\|}{\\|M\\|}}$。记此为 $\\tau_{13}$。\n  $\\tau_{13} = \\sqrt{\\frac{8\\times 10^{4}}{2\\times 10^{-4}}} = \\sqrt{4\\times 10^{8}} = 2\\times 10^{4}$。\n- $f_2(\\tau) = f_3(\\tau) \\implies \\tau \\|C\\| = \\|K\\| \\implies \\tau = \\frac{\\|K\\|}{\\|C\\|}}$。记此为 $\\tau_{23}$。\n  $\\tau_{23} = \\frac{8\\times 10^{4}}{30} = \\frac{8}{3}\\times 10^{3} \\approx 2666.67$。\n- $f_1(\\tau) = f_2(\\tau) \\implies \\tau^2 \\|M\\| = \\tau \\|C\\| \\implies \\tau = \\frac{\\|C\\|}{\\|M\\|}}$。记此为 $\\tau_{12}$。\n  $\\tau_{12} = \\frac{30}{2\\times 10^{-4}} = 15\\times 10^{4} = 1.5\\times 10^{5}$。\n\n我们观察到排序为 $\\tau_{23}  \\tau_{13}  \\tau_{12}$。现在我们分析 $g(\\tau)$ 在这些点定义的区间上的行为：\n1.  对于 $0  \\tau \\le \\tau_{23}$：\n    - $\\tau \\|C\\| \\le \\tau_{23} \\|C\\| = \\|K\\| = f_3(\\tau)$。\n    - $\\tau^2 \\|M\\| \\le \\tau_{23}^2 \\|M\\|  \\tau_{13}^2 \\|M\\| = \\|K\\| = f_3(\\tau)$。直接计算表明 $(\\|K\\|/\\|C\\|)^2\\|M\\| = \\frac{\\|K\\|^2\\|M\\|}{\\|C\\|^2} = \\frac{(8\\times 10^4)^2(2\\times 10^{-4})}{30^2} = \\frac{64 \\times 10^8 \\times 2 \\times 10^{-4}}{900} = \\frac{128 \\times 10^4}{900} \\approx 1422$，远小于 $\\|K\\|=80000$。\n    - 因此，在此区间内，$g(\\tau) = \\max\\{f_1(\\tau), f_2(\\tau), f_3(\\tau)\\} = f_3(\\tau) = \\|K\\|$。函数 $g(\\tau)$ 是一个常数。\n\n2.  对于 $\\tau > \\tau_{23}$：\n    - $\\tau \\|C\\| > \\tau_{23} \\|C\\| = \\|K\\|$。\n    - 因此，$g(\\tau) = \\max\\{\\tau^2\\|M\\|, \\tau\\|C\\|\\}$。$f_1(\\tau)$ 和 $f_2(\\tau)$ 对于 $\\tau>0$ 都是严格递增函数。两个严格递增函数的最大值也是严格递增的。\n    - 所以，对于 $\\tau > \\tau_{23}$，$g(\\tau)$ 是严格递增的。\n\n综合这些观察，函数 $g(\\tau)$ 在 $\\tau \\in (0, \\tau_{23}]$ 上是常数，在 $\\tau > \\tau_{23}$ 上是严格递增的。因此，$g(\\tau)$ 的最小值是 $\\|K\\|$，并且对于区间 $(0, \\tau_{23}]$ 中的任何 $\\tau$ 都能取到该最小值。\n\n问题要求选择唯一的“最合适”的缩放。这意味着必须使用一个次要准则从最小化子区间 $(0, \\tau_{23}]$ 中选择一个唯一的 $\\tau$。缩放的目标是使缩放后矩阵的范数 $\\|\\widehat{M}\\|, \\|\\widehat{C}\\|, \\|\\widehat{K}\\|$ 尽可能彼此接近，理想情况下为 1 的数量级。\n\n对于任何 $\\tau \\in (0, \\tau_{23}]$，最小化给出 $g(\\tau) = \\|K\\|$。该策略随后规定 $\\beta = 1/g(\\tau) = 1/\\|K\\|$。让我们用这个 $\\beta$ 来检查缩放后矩阵的范数：\n- $\\|\\widehat{K}\\| = \\beta \\|K\\| = \\frac{1}{\\|K\\|} \\|K\\| = 1$。\n- $\\|\\widehat{C}\\| = \\beta \\tau \\|C\\| = \\frac{\\tau \\|C\\|}{\\|K\\|}$。由于 $\\tau \\le \\tau_{23} = \\|K\\|/\\|C\\|$，我们有 $\\|\\widehat{C}\\| \\le 1$。\n- $\\|\\widehat{M}\\| = \\beta \\tau^2 \\|M\\| = \\frac{\\tau^2 \\|M\\|}{\\|K\\|}$。由于 $\\tau \\le \\tau_{23}  \\tau_{13} = \\sqrt{\\|K\\|/\\|M\\|}$，我们有 $\\tau^2  \\|K\\|/\\|M\\|$，这意味着 $\\|\\widehat{M}\\|  1$。\n\n为了在范数 $\\{ \\|\\widehat{M}\\|, \\|\\widehat{C}\\|, \\|\\widehat{K}\\| \\}$ 之间实现最佳平衡，我们希望它们尽可能彼此接近。我们已经有 $\\|\\widehat{K}\\|=1$，而 $\\|\\widehat{M}\\|1$ 和 $\\|\\widehat{C}\\|\\le 1$。为了使 $\\|\\widehat{C}\\|$ 和 $\\|\\widehat{M}\\|$ 尽可能大（从而更接近 1），我们应该在最小化子区间中选择可能的最大 $\\tau$ 值，即 $\\tau = \\tau_{23} = \\|K\\|/\\|C\\|$。\n\n通过这个选择，$\\tau = \\|K\\|/\\|C\\|$，我们得到：\n- 最优 $\\tau = \\|K\\|/\\|C\\|$。\n- $g(\\tau) = \\|K\\|$。\n- 最优 $\\beta = 1/\\|K\\|$。\n\n这个特定的选择导致了以下缩放后的范数：\n- $\\|\\widehat{K}\\| = \\beta\\|K\\| = 1$。\n- $\\|\\widehat{C}\\| = \\beta\\tau\\|C\\| = \\frac{1}{\\|K\\|} \\left(\\frac{\\|K\\|}{\\|C\\|}\\right) \\|C\\| = 1$。\n- $\\|\\widehat{M}\\| = \\beta\\tau^2\\|M\\| = \\frac{1}{\\|K\\|} \\left(\\frac{\\|K\\|}{\\|C\\|}\\right)^2 \\|M\\| = \\frac{\\|K\\|\\|M\\|}{\\|C\\|^2} = \\frac{(8\\times 10^4)(2\\times 10^{-4})}{30^2} = \\frac{16}{900} \\approx 0.0178$。\n\n得到的范数是 $\\{\\approx 0.0178, 1, 1\\}$，这是一个非常合理的平衡，三个范数中有两个恰好为 1。因此，这个 $\\tau$ 的选择是“最合适的”。\n\n**逐项分析**\n\nA. **选择 $\\tau = \\sqrt{\\|K\\|/\\|M\\|}$ 且 $\\beta = 1/\\|K\\|$。**\n这个选择对应于 $\\tau = \\tau_{13} = 2\\times 10^4$。如前所示，$\\tau_{13} > \\tau_{23}$，所以这个 $\\tau$ 值不会最小化 $g(\\tau)$。在这个 $\\tau$ 值下，$g(\\tau_{13}) = \\max\\{\\|K\\|, \\tau_{13}\\|C\\|, \\|K\\|\\} = \\tau_{13}\\|C\\| = (2\\times 10^4)(30) = 6\\times 10^5$，这大于最小值 $\\|K\\|=8\\times 10^4$。由于这个 $\\tau$ 没有实施策略的主要步骤，所以这个选项是**错误的**。\n\nB. **选择 $\\tau = \\|K\\|/\\|C\\|$ 且 $\\beta = 1/\\|K\\|$。**\n这个选择对应于 $\\tau = \\tau_{23} \\approx 2666.67$。该值位于区间 $(0, \\tau_{23}]$ 内，因此是 $g(\\tau)$ 的一个最小化子。最小值为 $g(\\tau_{23}) = \\|K\\|$。该策略随后规定 $\\beta = 1/g(\\tau_{23}) = 1/\\|K\\|$。这个选项与我们推导出的最优选择完全匹配，它通过在系数范数之间提供最佳平衡，唯一地解决了问题陈述中的模糊性。这个选项是**正确的**。\n\nC. **选择 $\\tau = \\|C\\|/\\|M\\|$ 且 $\\beta = 1/(\\tau \\|C\\|)$。**\n这个选择对应于 $\\tau = \\tau_{12} = 1.5\\times 10^5$。这个值大于 $\\tau_{23}$，所以它不会最小化 $g(\\tau)$。在这个 $\\tau$ 值下，$g(\\tau_{12}) = \\max\\{\\tau_{12}^2\\|M\\|, \\tau_{12}\\|C\\|, \\|K\\|\\} = \\max\\{\\tau_{12}\\|C\\|, \\tau_{12}\\|C\\|, \\|K\\|\\} = \\tau_{12}\\|C\\| = (1.5\\times 10^5)(30) = 4.5\\times 10^6$，远大于最小值。由于这个 $\\tau$ 没有实施该策略，所以这个选项是**错误的**。\n\nD. **选择 $\\tau = 1$ 且 $\\beta = 1/\\|K\\|$。**\n由于 $1  \\tau_{23} \\approx 2666.67$，选择 $\\tau=1$ 是 $g(\\tau)$ 的一个有效最小化子。对于 $\\tau=1$，$g(1) = \\max\\{\\|M\\|, \\|C\\|, \\|K\\|\\} = \\|K\\|$。该策略随后给出 $\\beta = 1/g(1) = 1/\\|K\\|$。所以，这个选项确实实施了指定的最小化策略。然而，我们必须评估它是否是“最合适的”。缩放后的范数将是：$\\|\\widehat{K}\\|=1$，$\\|\\widehat{C}\\|=\\|C\\|/\\|K\\| = 30/(8\\times 10^4) = 3.75\\times 10^{-4}$，以及 $\\|\\widehat{M}\\|=\\|M\\|/\\|K\\| = (2\\times 10^{-4})/(8\\times 10^4) = 2.5\\times 10^{-9}$。这些范数是 $\\{2.5\\times 10^{-9}, 3.75\\times 10^{-4}, 1\\}$，它们极其不均衡。与选项 B 实现的平衡相比，这种方式要差得多。因此，它不是“最合适”的选择。这个选项是**错误的**。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}