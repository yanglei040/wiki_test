{
    "hands_on_practices": [
        {
            "introduction": "隐式重启动 Lanczos 方法的核心是 Lanczos 过程，该过程通过迭代构建一个Krylov子空间，并将原始矩阵投影到一个三对角矩阵上。掌握这个迭代过程是理解任何Krylov子空间方法的第一步。本练习旨在通过一个具体的计算任务，帮助你亲手执行这一关键的三项递推关系，从而加深对算法力学的理解。",
            "id": "3590006",
            "problem": "考虑隐式重启 Lanczos 方法（IRLM）中使用的核心 Krylov 子空间构造，其中一个对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 被投影到一个标准正交基 $\\{v_1, v_2, \\dots\\}$ 上，通过一个源于对称性和正交性约束的三项递推关系，形成一个三对角矩阵 $T$。设 $A = \\mathrm{diag}(5,4,3,2,1) \\in \\mathbb{R}^{5 \\times 5}$，初始向量为 $v_1 = (1,1,1,1,1)^{\\top}$。使用标准的对称 Lanczos 过程，该过程强制基向量相互正交，并确保投影算子是三对角的。从将给定初始向量归一化到单位 $2$-范数得到的 $v_1$ 开始，并执行两步 Lanczos 过程，以确定三对角投影的前两个对角元素和第一个次对角元素（记为 $\\alpha_1$、$\\beta_1$ 和 $\\alpha_2$），以及相应的 Lanczos 基向量 $v_2$ 和 $v_3$。所有量均需使用根式和有理数精确表示，无需四舍五入。请将最终答案以单个行矩阵的形式给出，按顺序包含 $\\alpha_1$、$\\beta_1$、$\\alpha_2$、$v_2$ 的五个分量以及 $v_3$ 的五个分量。",
            "solution": "该问题被验证为自洽、科学严谨且定义明确。任务是针对给定的对称矩阵 $A$ 和指定的初始向量，执行两整步对称 Lanczos 算法。\n\n对称 Lanczos 算法是一种迭代方法，它为 Krylov 子空间 $\\mathcal{K}_k(A, v_1) = \\mathrm{span}\\{v_1, Av_1, \\dots, A^{k-1}v_1\\}$ 构建一个标准正交基 $\\{v_j\\}_{j=1}^k$，并生成一个实对称三对角矩阵 $T_k$。该算法的核心是通过考虑矩阵方程 $AV_k = V_k T_k + \\beta_k v_{k+1} e_k^\\top$ 得到的三项递推关系，其中 $V_k = [v_1, v_2, \\dots, v_k]$ 是标准正交 Lanczos 向量组成的矩阵，$T_k$ 是三对角矩阵。对于单个向量 $v_j$，这给出了递推关系：\n$$A v_j = \\beta_{j-1} v_{j-1} + \\alpha_j v_j + \\beta_j v_{j+1}$$\n系数 $\\alpha_j$ 和 $\\beta_j$ 是通过利用 Lanczos 向量的标准正交性（即 $v_i^\\top v_j = \\delta_{ij}$）来确定的。系数 $\\alpha_j$ 通过在递推关系左侧乘以 $v_j^\\top$ 来求得：\n$$\\alpha_j = v_j^\\top A v_j$$\n后续的向量 $v_{j+1}$ 和系数 $\\beta_j$ 通过首先计算未归一化的残差向量 $r_j$ 来找到：\n$$r_j = A v_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}$$\n然后，$\\beta_j$ 是该残差的 $2$-范数：\n$$\\beta_j = \\|r_j\\|_2$$\n如果 $\\beta_j \\neq 0$，则下一个 Lanczos 向量通过归一化得到：\n$$v_{j+1} = \\frac{r_j}{\\beta_j}$$\n该算法以单位范数的起始向量 $v_1$ 进行初始化，并按惯例设 $\\beta_0 = 0$ 且 $v_0$ 为零向量。给定矩阵 $A = \\mathrm{diag}(5,4,3,2,1)$ 和一个待归一化的初始向量。\n\n**第0步：初始化**\n未归一化的起始向量为 $u = (1,1,1,1,1)^\\top$。我们首先计算其欧几里得范数：\n$$\\|u\\|_2 = \\sqrt{1^2 + 1^2 + 1^2 + 1^2 + 1^2} = \\sqrt{5}$$\n第一个 Lanczos 向量 $v_1$ 通过归一化 $u$ 得到：\n$$v_1 = \\frac{u}{\\|u\\|_2} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n\n**第1步：第一次迭代 ($j=1$)**\n我们开始 Lanczos 过程的第一步。首先，计算乘积 $w_1 = A v_1$：\n$$w_1 = A v_1 = \\begin{pmatrix} 5  0  0  0  0 \\\\ 0  4  0  0  0 \\\\ 0  0  3  0  0 \\\\ 0  0  0  2  0 \\\\ 0  0  0  0  1 \\end{pmatrix} \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix}$$\n接下来，我们计算三对角矩阵 $T$ 的第一个对角元素 $\\alpha_1$：\n$$\\alpha_1 = v_1^\\top w_1 = v_1^\\top A v_1 = \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1  1  1  1  1 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{5}(5+4+3+2+1) = \\frac{15}{5} = 3$$\n现在我们计算未归一化的残差向量 $r_1$，回顾一下 $\\beta_0=0$：\n$$r_1 = w_1 - \\alpha_1 v_1 = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5 \\\\ 4 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix} - 3 \\cdot \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 5-3 \\\\ 4-3 \\\\ 3-3 \\\\ 2-3 \\\\ 1-3 \\end{pmatrix} = \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix}$$\n第一个次对角元素 $\\beta_1$ 是 $r_1$ 的 $2$-范数：\n$$\\beta_1 = \\|r_1\\|_2 = \\left\\| \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix} \\right\\|_2 = \\frac{1}{\\sqrt{5}} \\sqrt{2^2 + 1^2 + 0^2 + (-1)^2 + (-2)^2} = \\frac{1}{\\sqrt{5}} \\sqrt{4+1+0+1+4} = \\frac{\\sqrt{10}}{\\sqrt{5}} = \\sqrt{2}$$\n最后，我们通过归一化 $r_1$ 来计算第二个 Lanczos 向量 $v_2$：\n$$v_2 = \\frac{r_1}{\\beta_1} = \\frac{1}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix}$$\n\n**第2步：第二次迭代 ($j=2$)**\n我们进行第二步。首先，计算 $w_2 = A v_2$：\n$$w_2 = A v_2 = \\begin{pmatrix} 5  0  0  0  0 \\\\ 0  4  0  0  0 \\\\ 0  0  3  0  0 \\\\ 0  0  0  2  0 \\\\ 0  0  0  0  1 \\end{pmatrix} \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix} = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 10 \\\\ 4 \\\\ 0 \\\\ -2 \\\\ -2 \\end{pmatrix}$$\n接下来，我们计算第二个对角元素 $\\alpha_2$：\n$$\\alpha_2 = v_2^\\top w_2 = v_2^\\top A v_2 = \\left( \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2  1  0  -1  -2 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 10 \\\\ 4 \\\\ 0 \\\\ -2 \\\\ -2 \\end{pmatrix} \\right) = \\frac{1}{10}(20+4+0+2+4) = \\frac{30}{10} = 3$$\n现在我们计算未归一化的残差向量 $r_2 = w_2 - \\alpha_2 v_2 - \\beta_1 v_1$：\n$$r_2 = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 10 \\\\ 4 \\\\ 0 \\\\ -2 \\\\ -2 \\end{pmatrix} - 3 \\cdot \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ -2 \\end{pmatrix} - \\sqrt{2} \\cdot \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\n为了简化减法，我们将所有向量写成带有公因子 $\\frac{1}{\\sqrt{10}}$ 的形式。注意 $\\frac{\\sqrt{2}}{\\sqrt{5}} = \\frac{2}{\\sqrt{10}}$。\n$$r_2 = \\frac{1}{\\sqrt{10}} \\left( \\begin{pmatrix} 10 \\\\ 4 \\\\ 0 \\\\ -2 \\\\ -2 \\end{pmatrix} - \\begin{pmatrix} 6 \\\\ 3 \\\\ 0 \\\\ -3 \\\\ -6 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 2 \\\\ 2 \\\\ 2 \\\\ 2 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 10-6-2 \\\\ 4-3-2 \\\\ 0-0-2 \\\\ -2-(-3)-2 \\\\ -2-(-6)-2 \\end{pmatrix} = \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ -1 \\\\ -2 \\\\ -1 \\\\ 2 \\end{pmatrix}$$\n为了求 $v_3$，我们首先计算 $\\beta_2 = \\|r_2\\|_2$：\n$$\\beta_2 = \\|r_2\\|_2 = \\left\\| \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ -1 \\\\ -2 \\\\ -1 \\\\ 2 \\end{pmatrix} \\right\\|_2 = \\frac{1}{\\sqrt{10}} \\sqrt{2^2 + (-1)^2 + (-2)^2 + (-1)^2 + 2^2} = \\frac{1}{\\sqrt{10}} \\sqrt{4+1+4+1+4} = \\frac{\\sqrt{14}}{\\sqrt{10}}$$\n最后，我们通过归一化 $r_2$ 来计算第三个 Lanczos 向量 $v_3$：\n$$v_3 = \\frac{r_2}{\\beta_2} = \\frac{1}{\\frac{\\sqrt{14}}{\\sqrt{10}}} \\left( \\frac{1}{\\sqrt{10}} \\begin{pmatrix} 2 \\\\ -1 \\\\ -2 \\\\ -1 \\\\ 2 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{14}} \\begin{pmatrix} 2 \\\\ -1 \\\\ -2 \\\\ -1 \\\\ 2 \\end{pmatrix}$$\n\n所需的量是 $\\alpha_1$、$\\beta_1$、$\\alpha_2$ 以及 $v_2$ 和 $v_3$ 各自的五个分量。\n$\\alpha_1 = 3$\n$\\beta_1 = \\sqrt{2}$\n$\\alpha_2 = 3$\n$v_2$ 的五个分量是 $\\frac{2}{\\sqrt{10}}$、$\\frac{1}{\\sqrt{10}}$、$0$、$-\\frac{1}{\\sqrt{10}}$ 和 $-\\frac{2}{\\sqrt{10}}$。\n$v_3$ 的五个分量是 $\\frac{2}{\\sqrt{14}}$、$-\\frac{1}{\\sqrt{14}}$、$-\\frac{2}{\\sqrt{14}}$、$-\\frac{1}{\\sqrt{14}}$ 和 $\\frac{2}{\\sqrt{14}}$。\n将这些值组合成一个单行矩阵作为最终答案。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 3  \\sqrt{2}  3  \\frac{2}{\\sqrt{10}}  \\frac{1}{\\sqrt{10}}  0  -\\frac{1}{\\sqrt{10}}  -\\frac{2}{\\sqrt{10}}  \\frac{2}{\\sqrt{14}}  -\\frac{1}{\\sqrt{14}}  -\\frac{2}{\\sqrt{14}}  -\\frac{1}{\\sqrt{14}}  \\frac{2}{\\sqrt{14}} \\end{pmatrix} } $$"
        },
        {
            "introduction": "一旦通过 Lanczos 过程构建了三对角矩阵 $T_m$，下一步便是评估这个低维投影的质量。Ritz值（作为原矩阵特征值的近似）及其相关的残差范数是衡量近似精度的关键指标。本练习将引导你计算这些量，并通过一个“幸运中断”（lucky breakdown）的特殊情况，揭示Krylov子空间何时能完美捕获原矩阵的不变子空间。",
            "id": "3590016",
            "problem": "考虑隐式重启动Lanczos方法 (IRLM)，该方法首先构造一个维数为 $m$ 的短Lanczos分解，然后应用隐式位移。在精确算术中，对于一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，Lanczos过程从一个单位范数向量 $q_1$ 开始，生成一个标准正交基 $Q_m = [q_1,\\dots,q_m]$ 以及一个对称三对角投影 $T_m \\in \\mathbb{R}^{m \\times m}$。$T_m$ 的特征对被称为Ritz对，它们在原始空间中关联的Ritz向量为 $Q_m y$，其中 $y$ 是 $T_m$ 的一个特征向量。这些Ritz对的残差范数决定了对 $A$ 的特征对的近似质量。\n\n对于实对称矩阵 $A = \\mathrm{diag}(10,9,1,0) \\in \\mathbb{R}^{4 \\times 4}$、起始向量 $v_1 = (1,1,0,0)^{\\top}$ 和目标子空间维数 $m=2$ 的具体情况，请根据Lanczos过程的基本定义完成以下任务：\n\n1. 将 $v_1$ 归一化以获得 $q_1$，并执行两步Lanczos过程来构造三对角投影 $T_2$。\n2. 计算 $T_2$ 的Ritz值。\n3. 计算相应Ritz对在Lanczos投影意义下的残差范数。\n4. 基于这些计算，评估 $A$ 的哪些特征值被二维Lanczos子空间很好地近似。\n\n将最终答案表示为单个行矩阵，其中按顺序包含 $T_2$ 的四个元素（按行主序）、两个Ritz值和两个残差范数。不需要四舍五入。",
            "solution": "问题要求我们对给定的实对称矩阵 $A$ 和起始向量 $v_1$ 执行Lanczos过程的前两步，然后分析得到的二维Lanczos子空间。分析内容包括计算Ritz值及其对应的残差范数。\n\n对于对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和起始向量 $v_1$，Lanczos算法生成一个标准正交向量序列 $q_j$（Lanczos向量）和一个对称三对角矩阵 $T_m$。该过程由以下递推关系定义，起始条件为 $q_1 = v_1/\\|v_1\\|_2$，$\\beta_0=0$ 和 $q_0 = \\mathbf{0}$：\n对于 $j=1, 2, \\dots, m$：\n1. $w_j = A q_j$\n2. $\\alpha_j = q_j^{\\top} w_j$\n3. $\\hat{w}_j = w_j - \\alpha_j q_j - \\beta_{j-1} q_{j-1}$\n4. $\\beta_{j} = \\|\\hat{w}_j\\|_2$\n5. 如果 $\\beta_{j}=0$，算法终止。\n6. $q_{j+1} = \\hat{w}_j / \\beta_{j}$\n\n得到的三对角矩阵为 $T_m = \\begin{pmatrix} \\alpha_1  \\beta_1   \\\\ \\beta_1  \\alpha_2  \\ddots  \\\\  \\ddots  \\ddots  \\beta_{m-1} \\\\   \\beta_{m-1}  \\alpha_m \\end{pmatrix}$。\n\n给定的矩阵是 $A = \\mathrm{diag}(10,9,1,0)$，起始向量是 $v_1 = (1,1,0,0)^{\\top}$。目标维数是 $m=2$。\n\n**1. 构造三对角投影 $T_2$**\n\n首先，我们将起始向量 $v_1$ 归一化以得到 $q_1$。\n$v_1$ 的欧几里得范数是 $\\|v_1\\|_2 = \\sqrt{1^2 + 1^2 + 0^2 + 0^2} = \\sqrt{2}$。\n因此，第一个Lanczos向量是：\n$$q_1 = \\frac{v_1}{\\|v_1\\|_2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n\n现在，我们执行Lanczos算法的第一步 ($j=1$)。\n$$w_1 = A q_1 = \\begin{pmatrix} 10  0  0  0 \\\\ 0  9  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  0 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ 9 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n$T_2$ 的第一个对角元素是 $\\alpha_1$：\n$$\\alpha_1 = q_1^{\\top} w_1 = \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right)^{\\top} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ 9 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right) = \\frac{1}{2} (1 \\cdot 10 + 1 \\cdot 9) = \\frac{19}{2}$$\n接下来，我们计算未归一化的下一个Lanczos向量，其中 $\\beta_0=0$：\n$$\\hat{w}_1 = w_1 - \\alpha_1 q_1 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ 9 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{19}{2} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 - \\frac{19}{2} \\\\ 9 - \\frac{19}{2} \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n$T_2$ 的第一个非对角元素是 $\\beta_1$：\n$$\\beta_1 = \\|\\hat{w}_1\\|_2 = \\left\\| \\frac{1}{\\sqrt{2}} \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix} \\right\\|_2 = \\frac{1}{\\sqrt{2}} \\sqrt{\\left(\\frac{1}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2} = \\frac{1}{\\sqrt{2}} \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\frac{1}{\\sqrt{2}} \\sqrt{\\frac{1}{2}} = \\frac{1}{2}$$\n第二个Lanczos向量是：\n$$q_2 = \\frac{\\hat{w}_1}{\\beta_1} = \\frac{ \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1/2 \\\\ -1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} }{1/2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n现在，我们执行Lanczos算法的第二步 ($j=2$)。\n$$w_2 = A q_2 = \\begin{pmatrix} 10  0  0  0 \\\\ 0  9  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  0 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ -9 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n$T_2$ 的第二个对角元素是 $\\alpha_2$：\n$$\\alpha_2 = q_2^{\\top} w_2 = \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right)^{\\top} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ -9 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right) = \\frac{1}{2} (1 \\cdot 10 + (-1) \\cdot (-9)) = \\frac{1}{2}(10+9) = \\frac{19}{2}$$\n我们现在已经计算出 $T_2$ 的所有元素：\n$$T_2 = \\begin{pmatrix} \\alpha_1  \\beta_1 \\\\ \\beta_1  \\alpha_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{19}{2}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{19}{2} \\end{pmatrix}$$\n\n**2. 计算 $T_2$ 的Ritz值**\n\nRitz值是 $T_2$ 的特征值。我们通过求解特征方程 $\\det(T_2 - \\theta I) = 0$ 来找到它们。\n$$\\det \\begin{pmatrix} \\frac{19}{2} - \\theta  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{19}{2} - \\theta \\end{pmatrix} = 0$$\n$$\\left(\\frac{19}{2} - \\theta\\right)^2 - \\left(\\frac{1}{2}\\right)^2 = 0$$\n$$\\left(\\frac{19}{2} - \\theta - \\frac{1}{2}\\right) \\left(\\frac{19}{2} - \\theta + \\frac{1}{2}\\right) = 0$$\n$$\\left(\\frac{18}{2} - \\theta\\right) \\left(\\frac{20}{2} - \\theta\\right) = 0$$\n$$(9 - \\theta)(10 - \\theta) = 0$$\nRitz值为 $\\theta_1 = 10$ 和 $\\theta_2 = 9$。\n\n**3. 计算残差范数**\n\n对于一个给定的Ritz对 $(\\theta_k, y^{(k)})$，其中 $T_m y^{(k)} = \\theta_k y^{(k)}$ 且 $\\|y^{(k)}\\|=1$，其对应的Ritz向量 $x^{(k)} = Q_m y^{(k)}$ 的残差范数由 $\\|A x^{(k)} - \\theta_k x^{(k)}\\|_2 = |\\beta_m| |e_m^{\\top} y^{(k)}|$ 给出，其中 $e_m$ 是第 $m$ 个标准基向量。在我们的情况下，$m=2$，所以公式为 $\\|r_k\\|_2 = |\\beta_2| |e_2^{\\top} y^{(k)}| = |\\beta_2| |y_2^{(k)}|$。\n\n为了求出残差范数，我们必须计算 $\\beta_2 = \\|\\hat{w}_2\\|_2$。我们继续 $j=2$ 的Lanczos过程：\n$$\\hat{w}_2 = w_2 - \\alpha_2 q_2 - \\beta_1 q_1$$\n$$\\hat{w}_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 \\\\ -9 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{19}{2} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right) - \\frac{1}{2} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right)$$\n$$\\hat{w}_2 = \\frac{1}{\\sqrt{2}} \\left[ \\begin{pmatrix} 10 \\\\ -9 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 19/2 \\\\ -19/2 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right]$$\n$$\\hat{w}_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 - \\frac{19}{2} - \\frac{1}{2} \\\\ -9 + \\frac{19}{2} - \\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 - \\frac{20}{2} \\\\ -9 + \\frac{18}{2} \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 10 - 10 \\\\ -9 + 9 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n由于 $\\hat{w}_2$ 是零向量，其范数 $\\beta_2 = \\|\\hat{w}_2\\|_2 = 0$。\n\n这种情况被称为“幸运终止”（lucky breakdown）。这意味着Krylov子空间 $\\mathcal{K}_2(A, q_1) = \\mathrm{span}\\{q_1, q_2\\}$ 是 $A$ 的一个不变子空间。\n每个Ritz对的残差范数为 $\\|r_k\\|_2 = |\\beta_2| |y_2^{(k)}| = 0 \\cdot |y_2^{(k)}| = 0$。\n因此，两个Ritz对的残差范数都为 $0$。\n\n**4. 特征值近似的评估**\n\n$A$ 的特征值是 $10$、$9$、$1$ 和 $0$。计算出的Ritz值是 $10$ 和 $9$。一个Ritz对的残差范数为零，当且仅当该Ritz对是矩阵 $A$ 的一个精确特征对。由于两个残差范数都为 $0$，这个二维Lanczos子空间已经得到了精确的特征值 $10$ 和 $9$。这是起始向量 $v_1 = (1,1,0,0)^{\\top}$ 仅为与这两个特征值相对应的特征向量（即 $e_1=(1,0,0,0)^{\\top}$ 和 $e_2=(0,1,0,0)^{\\top}$）的线性组合的直接结果。\n\n最终要求的量为：\n- $T_2$ 的四个元素（按行主序）：$\\alpha_1=\\frac{19}{2}$，$\\beta_1=\\frac{1}{2}$，$\\beta_1=\\frac{1}{2}$，$\\alpha_2=\\frac{19}{2}$。\n- 两个Ritz值（降序排列）：$\\theta_1=10$，$\\theta_2=9$。\n- 两个对应的残差范数：$0$，$0$。\n将这些组合成一个单行矩阵。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{19}{2}  \\frac{1}{2}  \\frac{1}{2}  \\frac{19}{2}  10  9  0  0 \\end{pmatrix} } $$"
        },
        {
            "introduction": "隐式重启动 Lanczos 方法的精髓在于其“重启动”策略，它能够在不进行额外矩阵向量乘法的情况下，提纯起始向量，使其更接近于期望的特征向量。这种提纯是通过对Krylov子空间进行多项式滤波实现的。本练习将揭示这一过程背后的核心机制——滤波多项式，并让你亲手计算它如何放大或抑制不同的特征分量，从而深入理解隐式移位的威力。",
            "id": "3590045",
            "problem": "考虑一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，其特征分解为 $A = U \\Lambda U^{\\top}$，其中 $U$ 是正交矩阵，$\\Lambda = \\operatorname{diag}(\\lambda_{1}, \\dots, \\lambda_{n})$。Lanczos方法使用一个初始向量 $v_{1}$ 构建一个Krylov子空间 $\\mathcal{K}_{m}(A, v_{1})$，并生成一个三对角矩阵 $T_{m}$，满足Lanczos关系式 $A V_{m} = V_{m} T_{m} + \\beta_{m} v_{m+1} e_{m}^{\\top}$。其中，$V_{m}$ 的列是标准正交的，构成 $\\mathcal{K}_{m}(A, v_{1})$ 的一组基，$e_{m}$ 是第 $m$ 个标准基向量，且 $\\beta_{m} \\in \\mathbb{R}$。\n\n在隐式重启动Lanczos方法（IRLM）中，我们对 $T_{m}$ 应用一系列 $s$ 个带有位移 $\\{\\sigma_{j}\\}_{j=1}^{s}$ 的隐式位移正交变换（每个变换对应一个位移正交-三角或正交-相似步骤），然后进行截断，以用一个新的初始向量重新开始该过程。\n\n从正交相似的基本性质、特征值在相似变换下的不变性，以及每一步位移等价于在底层Krylov序列上（在相差一个正交因子的意义下）左乘 $(A - \\sigma_{j} I)$ 这一事实出发，推导出描述重启动的初始向量如何形成为 $p(A) v_{1}$ 的显式标量滤波多项式 $p(\\lambda)$，并解释为什么沿着特征向量 $u_{i}$ 的分量会被缩放 $p(\\lambda_{i})$ 倍。\n\n然后，对于一个假设的矩阵 $A$，其谱由以下十个特征值构成，\n$$\n\\lambda_{1} = -2,\\ \\lambda_{2} = -1,\\ \\lambda_{3} = 0,\\ \\lambda_{4} = \\frac{1}{2},\\ \\lambda_{5} = 1,\\ \\lambda_{6} = \\frac{3}{2},\\ \\lambda_{7} = 2,\\ \\lambda_{8} = \\frac{5}{2},\\ \\lambda_{9} = 3,\\ \\lambda_{10} = 4,\n$$\n对于一个使用三个位移的隐式重启动Lanczos扫描\n$$\n\\sigma_{1} = 1,\\ \\sigma_{2} = 2,\\ \\sigma_{3} = 3,\n$$\n计算 $i = 1, \\dots, 10$ 时 $|p(\\lambda_{i})|$ 的大小。\n\n将最终结果按上述特征值的顺序表示为单行矩阵。无需四舍五入；所有值都应精确表示为整数或有理数。",
            "solution": "该问题要求完成两项主要任务：首先，推导在隐式重启动Lanczos方法（IRLM）中使用的滤波多项式 $p(\\lambda)$，并解释其对初始向量在矩阵 $A$ 的特征基中的分量的影响；其次，根据给定的一组位移，计算该多项式在指定特征值处的大小。\n\n我们从推导开始。IRLM 是一种寻找大型矩阵 $A$ 的少数几个特征值和特征向量的迭代过程。它首先通过 Lanczos 算法构建一个维度为 $m$ 的Krylov子空间 $\\mathcal{K}_{m}(A, v_{1})$，该算法生成一组标准正交基 $V_{m} = [v_{1}, v_{2}, \\dots, v_{m}]$ 和一个实对称三对角矩阵 $T_{m} \\in \\mathbb{R}^{m \\times m}$，它们满足 Lanczos 关系式：\n$$A V_{m} = V_{m} T_{m} + \\beta_{m} v_{m+1} e_{m}^{\\top}$$\n这里，$V_{m}^{\\top} A V_{m} = T_{m}$，意味着 $T_{m}$ 是 $A$ 在Krylov子空间 $\\mathcal{K}_{m}(A, v_{1})$ 上的投影。\n\nIRLM 的“重启动”部分涉及提纯初始向量 $v_{1}$，以更好地逼近所需的特征子空间。这是通过对 $T_{m}$ 应用 $s  m$ 个隐式位移 $\\{\\sigma_{j}\\}_{j=1}^{s}$ 来完成的。每次位移的应用对应于“追逐凸起”QR算法的一步。\n\n考虑应用单个位移 $\\sigma_{1}$。对 $T_{m}$ 执行一个带有该位移的隐式QR步骤。\n首先，我们构造矩阵 $T_{m} - \\sigma_{1} I$ 并计算其 QR 分解：\n$$T_{m} - \\sigma_{1} I = Q_{1} R_{1}$$\n其中 $Q_{1}$ 是一个正交矩阵，$R_{1}$ 是一个上三角矩阵。\n然后对 $T_{m}$ 应用相似变换：\n$$T_{m}^{(+)} = Q_{1}^{\\top} T_{m} Q_{1}$$\n这个过程将基 $V_{m}$ 变换为一组新的标准正交基 $V_{m}^{(+)} = V_{m} Q_{1}$。重启动过程的新初始向量是这组新基的第一列，$v_{1}^{(+)}$。\n$$v_{1}^{(+)} = V_{m}^{(+)} e_{1} = (V_{m} Q_{1}) e_{1} = V_{m} q_{1}$$\n其中 $q_{1}$ 是 $Q_{1}$ 的第一列。\n\n要建立这种联系，关键在于利用 Lanczos 关系式 $A V_{m} = V_{m} T_{m} + \\beta_{m} v_{m+1} e_{m}^{\\top}$。当这个关系式作用于第一个基向量 $e_1$ 时，我们得到 $A V_m e_1 = V_m T_m e_1 + \\beta_m v_{m+1} e_m^\\top e_1$。因为 $V_m e_1 = v_1$，且对于 $m>1$，$e_m^\\top e_1=0$，这个等式简化为 $A v_1 = V_m T_m e_1$。\n同时，根据 QR 分解，$Q_{1} = (T_{m} - \\sigma_{1} I) R_{1}^{-1}$。它的第一列 $q_1$ 是 $q_1 = \\frac{1}{r_{11}}(T_m - \\sigma_1 I)e_1$，其中 $r_{11}$ 是 $R_1$ 的(1,1)元素。\n利用 $A v_1 = V_m T_m e_1$ 这一精确关系，我们可以将 $v_1^{(+)}$ 表示为：\n$$v_{1}^{(+)} = V_{m} q_{1} = \\frac{1}{r_{11}} V_{m} (T_{m} - \\sigma_{1} I) e_{1} = \\frac{1}{r_{11}} (V_{m}T_{m}e_1 - \\sigma_1 V_m e_1) = \\frac{1}{r_{11}} (A v_1 - \\sigma_1 v_1) = \\frac{1}{r_{11}} (A - \\sigma_1 I) v_1$$\n因此，$v_{1}^{(+)}$与 $(A - \\sigma_{1} I) v_{1}$ 成比例。\n\n当应用一系列 $s$ 个位移 $\\{\\sigma_{j}\\}_{j=1}^{s}$ 时，这个过程会重复。第二步产生一个与 $(A - \\sigma_{2} I) v_{1}^{(+)}$ 成比例的向量，而后者又与 $(A - \\sigma_{2} I)(A - \\sigma_{1} I) v_{1}$ 成比例。在应用所有 $s$ 个位移之后，截断和重启动之前的所得向量（我们称之为 $\\tilde{v}_{1}$）由下式给出：\n$$\\tilde{v}_{1} = c \\prod_{j=1}^{s} (A - \\sigma_{j} I) v_{1}$$\n其中 $c$ 是一个累积的归一化常数。\n这定义了一个多项式算子 $p(A) = \\prod_{j=1}^{s} (A - \\sigma_{j} I)$。相应的标量滤波多项式为：\n$$p(\\lambda) = \\prod_{j=1}^{s} (\\lambda - \\sigma_{j})$$\n重启动的初始向量是 $\\frac{p(A)v_{1}}{\\|p(A)v_{1}\\|}$。\n\n现在，我们解释为什么初始向量沿着特征向量 $u_{i}$ 的分量被缩放了 $p(\\lambda_{i})$ 倍。设初始向量 $v_{1}$ 在 $A$ 的标准正交特征基 $\\{u_{i}\\}_{i=1}^{n}$ 中展开为：\n$$v_{1} = \\sum_{i=1}^{n} \\alpha_{i} u_{i}$$\n其中 $\\alpha_{i} = u_{i}^{\\top} v_{1}$ 是沿着 $u_{i}$ 的分量的系数。\n将多项式算子 $p(A)$ 应用于 $v_{1}$：\n$$p(A) v_{1} = p(A) \\left( \\sum_{i=1}^{n} \\alpha_{i} u_{i} \\right) = \\sum_{i=1}^{n} \\alpha_{i} p(A) u_{i}$$\n由于 $u_{i}$ 是 $A$ 的一个特征向量，其特征值为 $\\lambda_{i}$（即 $A u_{i} = \\lambda_{i} u_{i}$），因此它也是 $A$ 的任何多项式的特征向量。具体来说：\n$$p(A) u_{i} = \\left( \\prod_{j=1}^{s} (A - \\sigma_{j} I) \\right) u_{i} = \\left( \\prod_{j=1}^{s} (\\lambda_{i} - \\sigma_{j}) \\right) u_{i} = p(\\lambda_{i}) u_{i}$$\n将此结果代回，我们得到：\n$$p(A) v_{1} = \\sum_{i=1}^{n} \\alpha_{i} (p(\\lambda_{i}) u_{i}) = \\sum_{i=1}^{n} (\\alpha_{i} p(\\lambda_{i})) u_{i}$$\n这表明 $v_{1}$ 沿着 $u_{i}$ 的原始分量 $\\alpha_{i} u_{i}$ 被变换为新的分量 $(\\alpha_{i} p(\\lambda_{i})) u_{i}$。因此，该分量被标量因子 $p(\\lambda_{i})$ 缩放。IRLM 的目的是选择与不想要的特征值相对应的位移 $\\sigma_{j}$，使得相应的 $|p(\\lambda_{i})|$ 值很小，从而有效地抑制这些分量，并使初始向量在期望的特征分量上富集。\n\n对于问题的第二部分，给定 $s=3$ 个位移：$\\sigma_{1} = 1$, $\\sigma_{2} = 2$, $\\sigma_{3} = 3$。滤波多项式为：\n$$p(\\lambda) = (\\lambda - 1)(\\lambda - 2)(\\lambda - 3)$$\n我们必须为给定的 10 个特征值计算 $|p(\\lambda_{i})|$。\n\n- 对于 $\\lambda_{1} = -2$：\n$p(-2) = (-2 - 1)(-2 - 2)(-2 - 3) = (-3)(-4)(-5) = -60$。所以，$|p(\\lambda_{1})| = 60$。\n\n- 对于 $\\lambda_{2} = -1$：\n$p(-1) = (-1 - 1)(-1 - 2)(-1 - 3) = (-2)(-3)(-4) = -24$。所以，$|p(\\lambda_{2})| = 24$。\n\n- 对于 $\\lambda_{3} = 0$：\n$p(0) = (0 - 1)(0 - 2)(0 - 3) = (-1)(-2)(-3) = -6$。所以，$|p(\\lambda_{3})| = 6$。\n\n- 对于 $\\lambda_{4} = \\frac{1}{2}$：\n$p(\\frac{1}{2}) = (\\frac{1}{2} - 1)(\\frac{1}{2} - 2)(\\frac{1}{2} - 3) = (-\\frac{1}{2})(-\\frac{3}{2})(-\\frac{5}{2}) = -\\frac{15}{8}$。所以，$|p(\\lambda_{4})| = \\frac{15}{8}$。\n\n- 对于 $\\lambda_{5} = 1$：\n$p(1) = (1 - 1)(1 - 2)(1 - 3) = (0)(-1)(-2) = 0$。所以，$|p(\\lambda_{5})| = 0$。\n\n- 对于 $\\lambda_{6} = \\frac{3}{2}$：\n$p(\\frac{3}{2}) = (\\frac{3}{2} - 1)(\\frac{3}{2} - 2)(\\frac{3}{2} - 3) = (\\frac{1}{2})(-\\frac{1}{2})(-\\frac{3}{2}) = \\frac{3}{8}$。所以，$|p(\\lambda_{6})| = \\frac{3}{8}$。\n\n- 对于 $\\lambda_{7} = 2$：\n$p(2) = (2 - 1)(2 - 2)(2 - 3) = (1)(0)(-1) = 0$。所以，$|p(\\lambda_{7})| = 0$。\n\n- 对于 $\\lambda_{8} = \\frac{5}{2}$：\n$p(\\frac{5}{2}) = (\\frac{5}{2} - 1)(\\frac{5}{2} - 2)(\\frac{5}{2} - 3) = (\\frac{3}{2})(\\frac{1}{2})(-\\frac{1}{2}) = -\\frac{3}{8}$。所以，$|p(\\lambda_{8})| = \\frac{3}{8}$。\n\n- 对于 $\\lambda_{9} = 3$：\n$p(3) = (3 - 1)(3 - 2)(3 - 3) = (2)(1)(0) = 0$。所以，$|p(\\lambda_{9})| = 0$。\n\n- 对于 $\\lambda_{10} = 4$：\n$p(4) = (4 - 1)(4 - 2)(4 - 3) = (3)(2)(1) = 6$。所以，$|p(\\lambda_{10})| = 6$。\n\n按顺序列出的最终大小为 $\\{60, 24, 6, \\frac{15}{8}, 0, \\frac{3}{8}, 0, \\frac{3}{8}, 0, 6\\}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n60  24  6  \\frac{15}{8}  0  \\frac{3}{8}  0  \\frac{3}{8}  0  6\n\\end{pmatrix}\n}\n$$"
        }
    ]
}