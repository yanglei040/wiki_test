## 引言
在科学与工程计算的众多领域，求解大型非对称[线性方程组](@entry_id:148943) $A x = b$ 是一个核心且普遍的挑战。[广义最小残差法](@entry_id:139566)（GMRES）作为一种强大的迭代方法，为此类问题提供了通用的解决方案。然而，当矩阵 $A$ 的[条件数](@entry_id:145150)较大或性质不佳时，GMRES的收敛速度会变得异常缓慢，甚至停滞，这严重制约了大规模模拟的效率和可行性。因此，如何系统性地加速GMRES的收敛，便成为[数值线性代数](@entry_id:144418)领域一个至关重要的问题。

本文旨在全面阐述解决这一挑战的关键技术——[预处理GMRES](@entry_id:753677)算法。通过引入一个“[预处理器](@entry_id:753679)”来变换原始问题，我们可以显著改善其数值特性，从而实现收敛的巨[大加速](@entry_id:198882)。为了系统地掌握这一方法，我们将分三个章节展开探讨。首先，在“原理与机制”一章中，我们将深入其数学核心，从Krylov[子空间](@entry_id:150286)和残差多项式出发，揭示[预处理](@entry_id:141204)如何影响收敛性，并探讨左[右预处理](@entry_id:173546)、灵活预处理（[FGMRES](@entry_id:749308)）等关键机制。接着，在“应用与跨学科连接”一章中，我们将理论与实践相结合，展示[预处理GMRES](@entry_id:753677)如何在计算流体力学、地球物理学和[计算电磁学](@entry_id:265339)等前沿领域中，根据问题的物理特性被巧妙地应用和定制。最后，“动手实践”部分将提供一系列精心设计的练习，帮助读者将理论知识转化为解决实际问题的能力。现在，让我们从[预处理GMRES](@entry_id:753677)的底层原理开始我们的探索之旅。

## 原理与机制

[广义最小残差法](@entry_id:139566)（GMRES）是一种功能强大的迭代方法，用于求解大型[非对称线性系统](@entry_id:164317) $A x = b$。其核心思想是在一个逐步扩大的[子空间](@entry_id:150286)（即Krylov[子空间](@entry_id:150286)）中寻找最优解。然而，对于病态或具有挑战性的系统，GMRES的[收敛速度](@entry_id:636873)可能非常缓慢。预处理技术通过将原始系统变换为一个更易于求解的等价系统，极大地加速了收敛。本章将深入探讨[预处理GMRES](@entry_id:753677)方法背后的核心原理与关键机制，从其数学基础到高级的实际考量。

### GMRES的核心思想：残差多项式

理解任何Krylov[子空间方法](@entry_id:200957)（包括GMRES）的起点是**残差多项式**的概念。给定初始猜测 $x_0$，初始残差为 $r_0 = b - A x_0$。GMRES在第 $k$ 步迭代中，在一个[仿射空间](@entry_id:152906) $x_0 + \mathcal{K}_k(A, r_0)$ 中寻找近似解 $x_k$，其中 $\mathcal{K}_k(A, r_0) = \mathrm{span}\{r_0, A r_0, \dots, A^{k-1} r_0\}$ 是 $k$ 阶Krylov[子空间](@entry_id:150286)。

$x_k$ 可以表示为 $x_k = x_0 + z_{k-1}$，其中 $z_{k-1} \in \mathcal{K}_k(A, r_0)$。由于 $z_{k-1}$ 是 $r_0, A r_0, \dots, A^{k-1} r_0$ 的线性组合，我们可以将其写为 $z_{k-1} = q_{k-1}(A) r_0$，其中 $q_{k-1}$ 是一个次数至多为 $k-1$ 的多项式。

由此，第 $k$ 步的残差 $r_k = b - A x_k$ 可以表示为：
$$
r_k = b - A(x_0 + q_{k-1}(A) r_0) = (b - A x_0) - A q_{k-1}(A) r_0 = r_0 - A q_{k-1}(A) r_0
$$
我们可以定义一个**残差多项式** $p_k(\lambda) = 1 - \lambda q_{k-1}(\lambda)$。这个多项式 $p_k$ 的次数至多为 $k$，并且满足一个至关重要的约束条件：$p_k(0) = 1$。于是，残差可以简洁地写为：
$$
r_k = p_k(A) r_0
$$
GMRES的本质是一个[优化问题](@entry_id:266749)：在所有次数至多为 $k$ 且在原点处取值为1的多项式中，寻找一个 $p_k$，使得残差的[欧几里得范数](@entry_id:172687) $\|r_k\|_2 = \|p_k(A) r_0\|_2$ 最小化 。这个约束条件 $p_k(0)=1$ 确保了 $x_k$ 的构造形式与仿射Krylov[子空间](@entry_id:150286)搜索是一致的 。

### GMRES的实现机制：[Arnoldi过程](@entry_id:166662)与最小二乘子问题

GMRES通过**[Arnoldi过程](@entry_id:166662)**巧妙地实现了上述最小化问题。[Arnoldi过程](@entry_id:166662)是一种修正的[Gram-Schmidt正交化](@entry_id:143035)方法，它为Krylov[子空间](@entry_id:150286) $\mathcal{K}_k(A, r_0)$ 构建一个[标准正交基](@entry_id:147779) $\{v_1, v_2, \dots, v_k\}$。这个过程从 $v_1 = r_0 / \|r_0\|_2$ 开始，并生成一个重要的矩阵关系，称为**[Arnoldi分解](@entry_id:746516)**：
$$
A V_k = V_{k+1} \bar{H}_k
$$
其中，$V_k = [v_1, \dots, v_k] \in \mathbb{C}^{n \times k}$ 的列是 $\mathcal{K}_k(A, r_0)$ 的[标准正交基](@entry_id:147779)，$V_{k+1} = [V_k, v_{k+1}] \in \mathbb{C}^{n \times (k+1)}$ 是扩展后的基矩阵，而 $\bar{H}_k \in \mathbb{C}^{(k+1) \times k}$ 是一个[上Hessenberg矩阵](@entry_id:756367)，其元素由正交化过程中的投影系数构成 。

利用这个分解，GMRES将高维的范数最小化问题转化为一个低维的**最小二乘子问题**。近似解 $x_k$ 表示为 $x_k = x_0 + V_k y$，其中 $y \in \mathbb{C}^k$ 是待定的[坐标向量](@entry_id:153319)。残差 $r_k$ 变为：
$$
r_k = r_0 - A V_k y = \|r_0\|_2 v_1 - V_{k+1} \bar{H}_k y
$$
令 $\beta = \|r_0\|_2$，并注意到 $v_1 = V_{k+1} e_1$（其中 $e_1$ 是 $\mathbb{C}^{k+1}$ 中的第一个[标准基向量](@entry_id:152417)），我们得到：
$$
r_k = V_{k+1} (\beta e_1 - \bar{H}_k y)
$$
由于 $V_{k+1}$ 的列是标准正交的，它是一个保范变换。因此，最小化 $\|r_k\|_2$ 等价于最小化 $\|\beta e_1 - \bar{H}_k y\|_2$。这引出了GMRES在每一步迭代中需要求解的核心子问题：
$$
\min_{y \in \mathbb{C}^k} \|\beta e_1 - \bar{H}_k y\|_2
$$
这个问题是一个 $(k+1) \times k$ 的最小二乘问题，其规模远小于原始系统，可以通过[QR分解](@entry_id:139154)等高效方法求解 。

### 预处理策略：[左预处理](@entry_id:165660)与[右预处理](@entry_id:173546)

预处理的核心思想是用一个[非奇异矩阵](@entry_id:171829) $M$ (预处理器)来变换原始系统 $A x = b$，使其“更容易”被GMRES求解。主要有两种策略：[左预处理](@entry_id:165660)和[右预处理](@entry_id:173546)。

**[左预处理](@entry_id:165660)** (Left Preconditioning) 求解变换后的系统：
$$
M^{-1} A x = M^{-1} b
$$
在这种情况下，GMRES直接应用于新的[系统矩阵](@entry_id:172230) $M^{-1} A$ 和新的右端项 $M^{-1} b$。这意味着：
-   GMRES探索的Krylov[子空间](@entry_id:150286)由算子 $M^{-1} A$ 和初始[预处理](@entry_id:141204)残差 $M^{-1} r_0$ 生成，即 $\mathcal{K}_k(M^{-1} A, M^{-1} r_0)$。
-   在每一步迭代中，GMRES最小化的是**预处理残差**的范数，即 $\|M^{-1} r_k\|_2 = \|M^{-1}(b - A x_k)\|_2$ 。

**[右预处理](@entry_id:173546)** (Right Preconditioning) 采用[变量替换](@entry_id:141386)。令 $x = M^{-1} y$，求解关于 $y$ 的系统：
$$
A M^{-1} y = b
$$
然后通过 $x = M^{-1} y$ 恢复原解。在这种情况下：
-   GMRES应用于算子 $A M^{-1}$。初始猜测 $y_0$ 通常取为 $M x_0$，这使得变换后系统的初始残差恰好是原始的初始残差 $r_0$。因此，Krylov[子空间](@entry_id:150286)为 $\mathcal{K}_k(A M^{-1}, r_0)$ 。
-   在每一步迭代中，GMRES最小化的是**真实残差**的范数，即 $\|b - (A M^{-1}) y_k\|_2 = \|b - A x_k\|_2 = \|r_k\|_2$ 。

一个重要的理论结果是，在精确算术中，[左预处理](@entry_id:165660)和[右预处理](@entry_id:173546)生成的解 $x_k$ 都位于同一个仿射搜索空间 $x_0 + \mathcal{K}_k(M^{-1}A, M^{-1}r_0)$（因为 $M^{-1}\mathcal{K}_k(AM^{-1}, r_0) = \mathcal{K}_k(M^{-1}A, M^{-1}r_0)$）。然而，由于它们最小化的[目标函数](@entry_id:267263)不同，最终得到的解 $x_k$ 通常也不同。

[右预处理](@entry_id:173546)的一个关键优势在于它直接最小化并监控真实残差的范数。因此，基于 $\|r_k\|_2 / \|r_0\|_2$ 的[收敛判据](@entry_id:158093)具有与非[预处理GMRES](@entry_id:753677)完全相同的物理解释。相比之下，[左预处理](@entry_id:165660)监控的是 $\|M^{-1}r_k\|_2$，其收敛行为可能与真实残差 $\|r_k\|_2$ 的收敛行为有很大差异，特别是当[预处理器](@entry_id:753679) $M$ 本身是病态的时候 。

### 预[处理器设计](@entry_id:753772)原理与收敛性理论

一个好的[预处理器](@entry_id:753679) $M$ 应该满足两个相互竞争的要求：(1) $M^{-1}$ 的作用应该易于计算；(2) [预处理](@entry_id:141204)后的[系统矩阵](@entry_id:172230)（$M^{-1} A$ 或 $A M^{-1}$）应具有“良好”的性质，以加速GMRES收敛。理想情况下，我们希望[预处理](@entry_id:141204)后的矩阵接近单位阵 $I$。

**1. 谱性质与收敛性**

GMRES的[收敛速度](@entry_id:636873)由预处理后算子（我们称之为 $B$）的性质决定。一个关键的发现是，[左预处理](@entry_id:165660)算子 $M^{-1}A$ 和[右预处理](@entry_id:173546)算子 $AM^{-1}$ 是相似的，因为 $M^{-1} A = M^{-1} (A M^{-1}) M$。因此，它们具有完全相同的**谱（[特征值](@entry_id:154894)集合）** 。

从残差多项式的角度看，GMRES的[收敛速度](@entry_id:636873)取决于是否存在一个低阶多项式 $p_k$（满足 $p_k(0)=1$），使其在算子 $B$ 的谱上取值很小。如果 $B$ 的[特征值](@entry_id:154894)聚集在远离原点的一个小区域内，那么构造这样的多项式就相对容易，从而实现快速收敛。

**2. [数值范围](@entry_id:752817)与非正态矩阵**

然而，许多实际问题（如计算流体力学中的[对流](@entry_id:141806)占优问题）产生的矩阵是高度**非正态**的（即 $B B^* \neq B^* B$）。对于这类矩阵，仅靠[谱分布](@entry_id:158779)不足以预测收敛行为。一个更有力的工具是**[数值范围](@entry_id:752817)**（或称为值域），定义为 $W(B) = \{ y^* B y : \|y\|_2=1 \}$。

[收敛理论](@entry_id:176137)表明，如果 $W(B)$ 包含在一个不包含原点的紧集中，GMRES就会收敛。例如，如果 $W(B)$ 位于一个以 $c$ 为中心、半径为 $\rho$ 的圆盘 $D(c, \rho)$ 内，且 $|c| > \rho$，则[收敛速度](@entry_id:636873)可以由比率 $\rho/|c|$ 来界定。一个好的预处理器 $M$ 的目标就是使[预处理](@entry_id:141204)后算子 $B=AM^{-1}$ 的[数值范围](@entry_id:752817)收缩到一个以 $1$ 为中心、半径 $\varepsilon \ll 1$ 的小圆盘内。如果 $\|AM^{-1} - I\|_2 \le \varepsilon$，那么可以证明 $W(AM^{-1})$ 包含在 $D(1, \varepsilon)$ 内。这将收敛因子从原始的 $\rho/|c|$ 改善为 $\varepsilon$，从而极大地加速收敛 [@problem_id:3594015, @problem_id:3593975]。

**3. 预处理器的来源：与[定常迭代法](@entry_id:144014)的联系**

许多经典[预处理器](@entry_id:753679)源于矩阵分裂 $A = M - N$，其中 $M$ 是一个易于求逆的矩阵（如对角阵或三角阵）。这种分裂直接导出[定常迭代法](@entry_id:144014) $x_{k+1} = M^{-1} N x_k + M^{-1} b$。该[迭代法](@entry_id:194857)的[迭代矩阵](@entry_id:637346)是 $G = M^{-1} N$。

有趣的是，将 $M$ 用作[左预处理](@entry_id:165660)器时，预处理算子 $M^{-1}A$ 与[迭代矩阵](@entry_id:637346) $G$ 之间存在一个简单的关系：
$$
M^{-1} A = M^{-1} (M - N) = I - M^{-1} N = I - G
$$
这个关系揭示了[定常迭代法](@entry_id:144014)和Krylov[子空间方法](@entry_id:200957)预处理之间的深刻联系。如果[定常迭代法](@entry_id:144014)收敛（即 $G$ 的[谱半径](@entry_id:138984) $\rho(G)  1$），那么[预处理](@entry_id:141204)算子 $M^{-1}A$ 的[特征值](@entry_id:154894) $\lambda(M^{-1}A) = 1 - \lambda(G)$ 将聚集在复平面上的点 $1$ 附近，这正是GMRES快速收敛所需要的理想特性 。

### 高级机制与实际考量

**1. 灵活与非精确预处理 ([FGMRES](@entry_id:749308))**

在许多应用中，[预处理器](@entry_id:753679) $M$ 本身可能是一个复杂的算子，其逆 $M^{-1}$ 的作用是通过另一个迭代过程（内迭代）来近似计算的。如果内迭代的执行方式或精度在GMRES的每一步（外迭代）都可能变化，那么[预处理器](@entry_id:753679)就变成了**可变[预处理器](@entry_id:753679)** $M_j$。

标准GMRES无法处理这种情况，因为它依赖于一个固定的算子来生成Krylov[子空间](@entry_id:150286)。**灵活GMRES ([FGMRES](@entry_id:749308))** 通过修改[Arnoldi过程](@entry_id:166662)来解决这个问题。在[FGMRES](@entry_id:749308)的第 $j$ 步，它首先用当前[预处理器](@entry_id:753679)作用于最新的[基向量](@entry_id:199546) $v_j$ 得到一个搜索方向 $z_j = M_j^{-1} v_j$，然后计算 $A z_j$ 并将其与之前的[基向量](@entry_id:199546)[正交化](@entry_id:149208)。这导致了一个Arnoldi-like关系：
$$
A Z_m = V_{m+1} \bar{H}_m
$$
其中 $Z_m = [z_1, \dots, z_m]$ 是由非正交的搜索方向构成的矩阵。为了构建最终解 $x_m = x_0 + Z_m y_m$，算法必须存储两组向量：用于[正交化](@entry_id:149208)和构建[最小二乘问题](@entry_id:164198)的标准正交基 $\{v_j\}$，以及用于更新解的搜索方向 $\{z_j\}$。这增加了内存需求，但提供了巨大的灵活性 。

**非精确[预处理](@entry_id:141204)**是[FGMRES](@entry_id:749308)的一个重要应用场景。在外迭代的第 $j$ 步，我们只需近似求解内系统 $M z_j = v_j$。一个关键问题是：内迭代需要多精确？一个高效的策略是采用自适应的**强制项（forcing term）**。内迭代的终止容差 $\eta_j$ 与当前外迭代的[残差范数](@entry_id:754273) $\|r_{j-1}\|_2$ 相联系，例如，要求内迭代产生的扰动 $e_j$ 满足 $\|e_j\|_2 \le \eta_j \|r_{j-1}\|_2$。这种策略确保了内迭代的计算量与外迭代的收敛进程相匹配，避免了不必要的计算，同时保证了整体的收敛性 。

**2. [有限精度效应](@entry_id:193932)与[数值稳定性](@entry_id:146550)**

在[浮点数](@entry_id:173316)运算中，[Arnoldi过程](@entry_id:166662)中的[Gram-Schmidt正交化](@entry_id:143035)会遭受舍入误差的影响，导致计算出的[基向量](@entry_id:199546) $V_k$ 逐渐失去其正交性。这种**正交性的损失**意味着GMRES在有限精度下实际上是在一个略微扰动的[子空间](@entry_id:150286)中求解一个略微扰动的最小二乘问题。

其后果是，计算得到的[残差范数](@entry_id:754273) $\|r_k^{\text{comp}}\|_2$ 可能大于理论上的最小[残差范数](@entry_id:754273) $\|r_k^{\text{min}}\|_2$，造成收敛延迟或停滞。摄动理论分析表明，这种次优性（sub-optimality）的程度不仅取决于正交性损失的程度（设为 $\delta$），还与预处理算子的[条件数](@entry_id:145150) $\kappa(A M^{-1})$ 成正比。一个近似的界为：
$$
\|r_k^{\text{comp}}\|_2 \le \left(1 + c \cdot \delta \cdot \kappa(A M^{-1})\right) \|r_k^{\text{min}}\|_2
$$
这个结果揭示了[预处理](@entry_id:141204)的又一个重要好处：一个好的预处理器不仅通过改善谱性质来加速理论收敛，还通过降低预处理算子的[条件数](@entry_id:145150) $\kappa(A M^{-1})$，使得算法对舍入误差的敏感性降低，从而提高了数值稳定性 。