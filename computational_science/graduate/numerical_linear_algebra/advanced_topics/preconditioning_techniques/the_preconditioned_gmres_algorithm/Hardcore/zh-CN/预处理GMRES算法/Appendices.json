{
    "hands_on_practices": [
        {
            "introduction": "理解预处理GMRES方法的第一步是掌握其探索的解空间结构。本练习将引导你通过一个具体的、分步的计算，为一个简单的预处理系统构建底层的克里洛夫子空间。这个过程将抽象的定义变得具体化，为深入理解算法的后续步骤奠定坚实的基础。",
            "id": "3593967",
            "problem": "考虑带有右预处理器 $M$ 的线性系统 $A x = b$，其中矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 是非对称的，矩阵 $M \\in \\mathbb{R}^{3 \\times 3}$ 是非奇异的。设\n$$\nA = \\begin{pmatrix}\n4  -1  0 \\\\\n2  3  1 \\\\\n0  -2  5\n\\end{pmatrix}, \\quad\nM = \\begin{pmatrix}\n2  0  0 \\\\\n0  1  1 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix}\n3 \\\\ 7 \\\\ -1\n\\end{pmatrix}, \\quad\nx_0 = \\begin{pmatrix}\n0 \\\\ 0 \\\\ 0\n\\end{pmatrix}.\n$$\n定义初始残差 $r_0 = b - A x_0$ 以及与右预处理相关的算子 $A M^{-1}$。仅使用克里洛夫子空间和广义最小残差 (GMRES) 算法的基本定义，显式地构造第二个克里洛夫子空间 $\\mathcal{K}_2(A M^{-1}, r_0)$，并描述右预处理 GMRES 算法在两次迭代内所探索的仿射解空间。您必须直接从上述数据导出子空间元素，而不使用任何预先推导的快捷公式。\n\n此外，确定 $\\mathcal{K}_2(A M^{-1}, r_0)$ 的维数，并将此维数作为您的最终答案。",
            "solution": "按如下方式验证问题。\n\n### 第1步：提取已知条件\n- 线性系统为 $A x = b$。\n- 右预处理器为 $M$。\n- 矩阵和向量如下所示：\n  - $A = \\begin{pmatrix} 4  -1  0 \\\\ 2  3  1 \\\\ 0  -2  5 \\end{pmatrix} \\in \\mathbb{R}^{3 \\times 3}$，非对称。\n  - $M = \\begin{pmatrix} 2  0  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix} \\in \\mathbb{R}^{3 \\times 3}$，非奇异。\n  - $b = \\begin{pmatrix} 3 \\\\ 7 \\\\ -1 \\end{pmatrix} \\in \\mathbb{R}^{3}$。\n- 初始猜测为 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} \\in \\mathbb{R}^{3}$。\n- 初始残差定义为 $r_0 = b - A x_0$。\n- 克里洛夫子空间的算子是 $A M^{-1}$。\n- 任务是构造第二个克里洛夫子空间 $\\mathcal{K}_2(A M^{-1}, r_0)$，描述右预处理 GMRES 算法在两次迭代后的仿射解空间，并求出 $\\mathcal{K}_2(A M^{-1}, r_0)$ 的维数。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题属于数值线性代数领域，涉及广义最小残差 (GMRES) 算法和克里洛夫子空间，这些都是标准的、完善的数学概念。\n- **适定性：** 所有必需的矩阵和向量都已提供。矩阵 $M$ 被说明为非奇异的。我们可以通过计算其行列式来验证这一点：$\\det(M) = 2 \\times (1 \\times 1 - 1 \\times 0) = 2 \\neq 0$。因此，其逆矩阵 $M^{-1}$ 存在。该问题是自洽的，其结构保证了有唯一且有意义的解。\n- **客观性：** 该问题使用精确的数学语言陈述，没有歧义或主观论断。\n\n问题提法没有违反任何无效性标准。它是科学合理的、适定的和客观的。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n右预处理 GMRES 算法通过求解修正后的系统 $(A M^{-1})y = b$，然后通过 $x = M^{-1}y$ 恢复解来解决线性系统 $A x = b$。$y$ 的近似解在由克里洛夫子空间构造的仿射空间中找到。\n\n第一步是计算初始残差 $r_0$。\n$$\nr_0 = b - A x_0 = \\begin{pmatrix} 3 \\\\ 7 \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 4  -1  0 \\\\ 2  3  1 \\\\ 0  -2  5 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 7 \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 7 \\\\ -1 \\end{pmatrix}\n$$\n这个向量 $r_0$ 是构建克里洛夫子空间的起始向量。\n\n接下来，我们需要克里洛夫子空间的算子，即 $A M^{-1}$。我们首先求 $M$ 的逆矩阵。\n$$\nM = \\begin{pmatrix} 2  0  0 \\\\ 0  1  1 \\\\ 0  0  1 \\end{pmatrix}\n$$\n逆矩阵 $M^{-1}$ 可以通过对增广矩阵 $[M|I]$ 进行高斯消元法求得：\n$$\n\\left[\\begin{array}{ccc|ccc} 2  0  0  1  0  0 \\\\ 0  1  1  0  1  0 \\\\ 0  0  1  0  0  1 \\end{array}\\right] \\xrightarrow{R_1 \\to \\frac{1}{2}R_1} \\left[\\begin{array}{ccc|ccc} 1  0  0  \\frac{1}{2}  0  0 \\\\ 0  1  1  0  1  0 \\\\ 0  0  1  0  0  1 \\end{array}\\right] \\xrightarrow{R_2 \\to R_2-R_3} \\left[\\begin{array}{ccc|ccc} 1  0  0  \\frac{1}{2}  0  0 \\\\ 0  1  0  0  1  -1 \\\\ 0  0  1  0  0  1 \\end{array}\\right]\n$$\n因此，逆矩阵为：\n$$\nM^{-1} = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  1  -1 \\\\ 0  0  1 \\end{pmatrix}\n$$\n现在，我们计算算子 $A M^{-1}$：\n$$\nA M^{-1} = \\begin{pmatrix} 4  -1  0 \\\\ 2  3  1 \\\\ 0  -2  5 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  1  -1 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 4(\\frac{1}{2})  -1(1)  -1(-1) \\\\ 2(\\frac{1}{2})  3(1)  3(-1)+1(1) \\\\ 0  -2(1)  -2(-1)+5(1) \\end{pmatrix} = \\begin{pmatrix} 2  -1  1 \\\\ 1  3  -2 \\\\ 0  -2  7 \\end{pmatrix}\n$$\n第二个克里洛夫子空间 $\\mathcal{K}_2(A M^{-1}, r_0)$ 由克里洛夫序列中的前两个向量的张成空间定义：\n$$\n\\mathcal{K}_2(A M^{-1}, r_0) = \\text{span}\\{r_0, (A M^{-1}) r_0 \\}\n$$\n第一个向量是 $r_0 = \\begin{pmatrix} 3 \\\\ 7 \\\\ -1 \\end{pmatrix}$。\n第二个向量通过将算子 $A M^{-1}$ 应用于 $r_0$ 获得：\n$$\n(A M^{-1}) r_0 = \\begin{pmatrix} 2  -1  1 \\\\ 1  3  -2 \\\\ 0  -2  7 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 7 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 2(3) - 1(7) + 1(-1) \\\\ 1(3) + 3(7) - 2(-1) \\\\ 0(3) - 2(7) + 7(-1) \\end{pmatrix} = \\begin{pmatrix} 6 - 7 - 1 \\\\ 3 + 21 + 2 \\\\ -14 - 7 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 26 \\\\ -21 \\end{pmatrix}\n$$\n所以，第二个克里洛夫子空间显式地构造为：\n$$\n\\mathcal{K}_2(A M^{-1}, r_0) = \\text{span}\\left\\{ \\begin{pmatrix} 3 \\\\ 7 \\\\ -1 \\end{pmatrix}, \\begin{pmatrix} -2 \\\\ 26 \\\\ -21 \\end{pmatrix} \\right\\}\n$$\nGMRES 算法在仿射空间 $x_0 + M^{-1}\\mathcal{K}_k(A M^{-1}, r_0)$ 中寻找近似解 $x_k$。对于 $k=2$，解 $x_2$ 位于空间：\n$$\nx_2 \\in x_0 + M^{-1}\\mathcal{K}_2(A M^{-1}, r_0)\n$$\n由于 $x_0 = 0$，这是一个线性子空间 $M^{-1}\\mathcal{K}_2(A M^{-1}, r_0)$。该子空间由 $\\mathcal{K}_2(A M^{-1}, r_0)$ 的基向量在变换 $M^{-1}$ 下的像所张成：\n$$\nM^{-1}\\mathcal{K}_2(A M^{-1}, r_0) = \\text{span}\\{ M^{-1}r_0, M^{-1}((A M^{-1})r_0) \\}\n$$\n让我们计算这两个张成向量：\n$$\nM^{-1}r_0 = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  1  -1 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 7 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} \\\\ 7 - (-1) \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} \\\\ 8 \\\\ -1 \\end{pmatrix}\n$$\n$$\nM^{-1}((A M^{-1})r_0) = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  1  -1 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 26 \\\\ -21 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 26 - (-21) \\\\ -21 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 47 \\\\ -21 \\end{pmatrix}\n$$\n因此，右预处理 GMRES 算法在两次迭代内所探索的仿射解空间是所有形如下式的向量 $x$ 的集合：\n$$\nx = c_1 \\begin{pmatrix} \\frac{3}{2} \\\\ 8 \\\\ -1 \\end{pmatrix} + c_2 \\begin{pmatrix} -1 \\\\ 47 \\\\ -21 \\end{pmatrix}\n$$\n其中 $c_1, c_2 \\in \\mathbb{R}$ 是任意标量。该集合是线性子空间 $\\text{span}\\left\\{ \\begin{pmatrix} \\frac{3}{2} \\\\ 8 \\\\ -1 \\end{pmatrix}, \\begin{pmatrix} -1 \\\\ 47 \\\\ -21 \\end{pmatrix} \\right\\}$。\n\n最后，我们确定 $\\mathcal{K}_2(A M^{-1}, r_0)$ 的维数。维数是其张成集 $\\{r_0, (A M^{-1})r_0\\}$ 中线性无关向量的数量。令 $v_1 = r_0$ 和 $v_2 = (A M^{-1})r_0$。这些向量是线性无关的，当且仅当其中一个不是另一个的标量倍。我们来检查是否存在一个标量 $c$ 使得 $v_2 = c v_1$：\n$$\n\\begin{pmatrix} -2 \\\\ 26 \\\\ -21 \\end{pmatrix} = c \\begin{pmatrix} 3 \\\\ 7 \\\\ -1 \\end{pmatrix}\n$$\n从第一个分量，我们得到 $-2 = 3c$，这意味着 $c = -\\frac{2}{3}$。\n从第二个分量，我们得到 $26 = 7c$，这意味着 $c = \\frac{26}{7}$。\n由于 $-\\frac{2}{3} \\neq \\frac{26}{7}$，不存在这样的标量 $c$。向量 $v_1$ 和 $v_2$ 是线性无关的。\n因此，子空间 $\\mathcal{K}_2(A M^{-1}, r_0)$ 的维数是 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在了解了克里洛夫子空间之后，下一步是理解GMRES如何有效地处理这个空间。本练习将深入探讨GMRES算法的核心引擎——Arnoldi过程。你将亲手执行这一过程，生成正交基和相应的Hessenberg矩阵，这是实现残差最小化的关键所在。",
            "id": "3593935",
            "problem": "考虑将带有右预处理的广义最小残差（GMRES）方法应用于线性系统 $A x = b$，其中预处理器 $M$ 是非奇异的。右预处理将算子变换为 $\\tilde{A} = A M^{-1}$，未知量变换为 $y = M x$，从而为作用于初始残差 $r_0 = b - A x_0$ 的算子 $\\tilde{A}$ 构建克里洛夫子空间。阿诺德过程为克里洛夫子空间 $\\mathcal{K}_k(\\tilde{A}, r_0)$ 构建一个标准正交基 $\\{v_1, v_2, \\dots\\}$，并生成一个上赫森伯格矩阵 $\\bar{H}_k \\in \\mathbb{R}^{(k+1) \\times k}$，该矩阵捕捉了 $\\tilde{A}$ 在所生成子空间上的投影。\n\n设\n$$\nA = \\begin{pmatrix}\n2  1  0 \\\\\n0  3  1 \\\\\n0  0  4\n\\end{pmatrix}, \\quad\nM = \\begin{pmatrix}\n1  0  0 \\\\\n0  2  0 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad\nx_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n从 $r_0 = b - A x_0$ 和 $v_1 = r_0 / \\|r_0\\|$ 开始，对右预处理算子 $\\tilde{A} = A M^{-1}$ 执行恰好两步阿诺德过程。计算标准正交基向量 $v_1$、$v_2$ 和 $v_3$，以及满足 $\\tilde{A} V_2 = V_3 \\bar{H}_2$ 的上赫森伯格矩阵\n$$\n\\bar{H}_2 = \\begin{pmatrix}\nh_{11}  h_{12} \\\\\nh_{21}  h_{22} \\\\\n0  h_{32}\n\\end{pmatrix}\n$$\n其中 $V_2 = [v_1 \\; v_2]$ 且 $V_3 = [v_1 \\; v_2 \\; v_3]$。\n\n报告次对角线系数 $h_{32}$ 的精确值作为你的最终答案。要求精确表达所报告的值，不允许进行四舍五入。",
            "solution": "用户提供的问题是数值线性代数中的一个适定问题，并被验证为合理且可解的。任务是为一个右预处理线性系统执行两步阿诺德过程，并确定得到的上赫森伯格矩阵中的一个特定元素 $h_{32}$。\n\n首先，我们定义问题的各个组成部分。线性系统为 $A x = b$，带有右预处理器 $M$。GMRES 算法将应用于等价系统 $\\tilde{A} y = b$，其中 $\\tilde{A} = A M^{-1}$ 且 $y = M x$。\n\n给定的矩阵和向量如下：\n$$\nA = \\begin{pmatrix}\n2  1  0 \\\\\n0  3  1 \\\\\n0  0  4\n\\end{pmatrix}, \\quad\nM = \\begin{pmatrix}\n1  0  0 \\\\\n0  2  0 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad\nx_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n预处理器 $M$ 是一个对角矩阵，因此其逆矩阵 $M^{-1}$ 可以通过取其对角元素的倒数得到：\n$$\nM^{-1} = \\begin{pmatrix}\n1^{-1}  0  0 \\\\\n0  2^{-1}  0 \\\\\n0  0  1^{-1}\n\\end{pmatrix} = \\begin{pmatrix}\n1  0  0 \\\\\n0  \\frac{1}{2}  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n现在，我们计算预处理矩阵 $\\tilde{A} = A M^{-1}$：\n$$\n\\tilde{A} = \\begin{pmatrix}\n2  1  0 \\\\\n0  3  1 \\\\\n0  0  4\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0  0 \\\\\n0  \\frac{1}{2}  0 \\\\\n0  0  1\n\\end{pmatrix} =\n\\begin{pmatrix}\n(2)(1)  (1)(\\frac{1}{2})  (0)(1) \\\\\n(0)(1)  (3)(\\frac{1}{2})  (1)(1) \\\\\n(0)(1)  (0)(\\frac{1}{2})  (4)(1)\n\\end{pmatrix} =\n\\begin{pmatrix}\n2  \\frac{1}{2}  0 \\\\\n0  \\frac{3}{2}  1 \\\\\n0  0  4\n\\end{pmatrix}\n$$\n阿诺德过程从初始残差 $r_0$ 开始。\n$$\nr_0 = b - A x_0 = b - A \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = b = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n第一个基向量 $v_1$ 是归一化后的初始残差。\n$$\n\\|r_0\\|_2 = \\sqrt{1^2 + 1^2 + 1^2} = \\sqrt{3}\n$$\n$$\nv_1 = \\frac{r_0}{\\|r_0\\|_2} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n阿诺德过程为克里洛夫子空间 $\\mathcal{K}_k(\\tilde{A}, r_0)$ 迭代地构建一个标准正交基 $\\{v_1, v_2, \\dots\\}$ 和一个赫森伯格矩阵 $\\bar{H}_k$。其关系式为 $\\tilde{A} V_k = V_{k+1} \\bar{H}_k$。\n\n**阿诺德过程第 1 步：**\n我们计算 $w = \\tilde{A} v_1$。\n$$\nw = \\begin{pmatrix}\n2  \\frac{1}{2}  0 \\\\\n0  \\frac{3}{2}  1 \\\\\n0  0  4\n\\end{pmatrix}\n\\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right)\n= \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 2 + \\frac{1}{2} \\\\ \\frac{3}{2} + 1 \\\\ 4 \\end{pmatrix}\n= \\frac{1}{\\sqrt{3}} \\begin{pmatrix} \\frac{5}{2} \\\\ \\frac{5}{2} \\\\ 4 \\end{pmatrix}\n$$\n接下来，我们将 $w$ 投影到已有的基向量 $v_1$ 上。系数为 $h_{11}$。\n$$\nh_{11} = v_1^T w = \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} \\frac{5}{2} \\\\ \\frac{5}{2} \\\\ 4 \\end{pmatrix} \\right)\n= \\frac{1}{3} \\left( \\frac{5}{2} + \\frac{5}{2} + 4 \\right) = \\frac{1}{3} (5 + 4) = \\frac{9}{3} = 3\n$$\n我们计算 $w$ 中与 $v_1$ 正交的分量。设其为 $\\hat{v}_2$。\n$$\n\\hat{v}_2 = w - h_{11} v_1 = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} \\frac{5}{2} \\\\ \\frac{5}{2} \\\\ 4 \\end{pmatrix} - 3 \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right)\n= \\frac{1}{\\sqrt{3}} \\left( \\begin{pmatrix} \\frac{5}{2} \\\\ \\frac{5}{2} \\\\ 4 \\end{pmatrix} - \\begin{pmatrix} 3 \\\\ 3 \\\\ 3 \\end{pmatrix} \\right)\n= \\frac{1}{\\sqrt{3}} \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{1}{2} \\\\ 1 \\end{pmatrix}\n$$\n赫森伯格矩阵的下一个元素是 $h_{21} = \\|\\hat{v}_2\\|_2$。\n$$\nh_{21} = \\left\\| \\frac{1}{\\sqrt{3}} \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{1}{2} \\\\ 1 \\end{pmatrix} \\right\\|_2\n= \\frac{1}{\\sqrt{3}} \\sqrt{\\left(-\\frac{1}{2}\\right)^2 + \\left(-\\frac{1}{2}\\right)^2 + 1^2}\n= \\frac{1}{\\sqrt{3}} \\sqrt{\\frac{1}{4} + \\frac{1}{4} + 1} = \\frac{1}{\\sqrt{3}} \\sqrt{\\frac{3}{2}} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}\n$$\n第二个基向量是 $v_2 = \\hat{v}_2 / h_{21}$。\n$$\nv_2 = \\frac{\\frac{1}{\\sqrt{3}} \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{1}{2} \\\\ 1 \\end{pmatrix}}{\\frac{1}{\\sqrt{2}}}\n= \\frac{\\sqrt{2}}{\\sqrt{3}} \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{1}{2} \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -1 \\\\ -1 \\\\ 2 \\end{pmatrix}\n$$\n\n**阿诺德过程第 2 步：**\n我们计算 $w = \\tilde{A} v_2$。\n$$\nw = \\begin{pmatrix}\n2  \\frac{1}{2}  0 \\\\\n0  \\frac{3}{2}  1 \\\\\n0  0  4\n\\end{pmatrix}\n\\left( \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -1 \\\\ -1 \\\\ 2 \\end{pmatrix} \\right)\n= \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -2 - \\frac{1}{2} \\\\ -\\frac{3}{2} + 2 \\\\ 8 \\end{pmatrix}\n= \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -\\frac{5}{2} \\\\ \\frac{1}{2} \\\\ 8 \\end{pmatrix}\n$$\n我们将 $w$ 投影到基 $\\{v_1, v_2\\}$ 上以求得 $h_{12}$ 和 $h_{22}$。\n$$\nh_{12} = v_1^T w = \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -\\frac{5}{2} \\\\ \\frac{1}{2} \\\\ 8 \\end{pmatrix} \\right)\n= \\frac{1}{\\sqrt{18}} \\left( -\\frac{5}{2} + \\frac{1}{2} + 8 \\right) = \\frac{1}{3\\sqrt{2}} (-2 + 8) = \\frac{6}{3\\sqrt{2}} = \\frac{2}{\\sqrt{2}} = \\sqrt{2}\n$$\n$$\nh_{22} = v_2^T w = \\left( \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -1  -1  2 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -\\frac{5}{2} \\\\ \\frac{1}{2} \\\\ 8 \\end{pmatrix} \\right)\n= \\frac{1}{6} \\left( (-1)(-\\frac{5}{2}) + (-1)(\\frac{1}{2}) + (2)(8) \\right)\n= \\frac{1}{6} \\left( \\frac{5}{2} - \\frac{1}{2} + 16 \\right) = \\frac{1}{6} (2 + 16) = \\frac{18}{6} = 3\n$$\n我们计算 $w$ 中与 $\\{v_1, v_2\\}$ 张成的空间正交的分量。设其为 $\\hat{v}_3$。\n$$\n\\hat{v}_3 = w - h_{12} v_1 - h_{22} v_2\n$$\n$$\n\\hat{v}_3 = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -\\frac{5}{2} \\\\ \\frac{1}{2} \\\\ 8 \\end{pmatrix} - \\sqrt{2} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) - 3 \\left( \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -1 \\\\ -1 \\\\ 2 \\end{pmatrix} \\right)\n$$\n为简化计算，我们将所有项写成以 $\\sqrt{6}$ 为公分母的形式。注意 $\\frac{\\sqrt{2}}{\\sqrt{3}} = \\frac{\\sqrt{2}\\sqrt{2}}{\\sqrt{3}\\sqrt{2}} = \\frac{2}{\\sqrt{6}}$。\n$$\n\\hat{v}_3 = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -\\frac{5}{2} \\\\ \\frac{1}{2} \\\\ 8 \\end{pmatrix} - \\frac{2}{\\sqrt{6}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\frac{3}{\\sqrt{6}} \\begin{pmatrix} -1 \\\\ -1 \\\\ 2 \\end{pmatrix}\n$$\n$$\n\\hat{v}_3 = \\frac{1}{\\sqrt{6}} \\left[ \\begin{pmatrix} -\\frac{5}{2} \\\\ \\frac{1}{2} \\\\ 8 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 2 \\\\ 2 \\end{pmatrix} - \\begin{pmatrix} -3 \\\\ -3 \\\\ 6 \\end{pmatrix} \\right]\n= \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -\\frac{5}{2} - 2 + 3 \\\\ \\frac{1}{2} - 2 + 3 \\\\ 8 - 2 - 6 \\end{pmatrix}\n= \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -\\frac{3}{2} \\\\ \\frac{3}{2} \\\\ 0 \\end{pmatrix}\n$$\n问题要求 $h_{32}$ 的值，即这个向量的范数。\n$$\nh_{32} = \\|\\hat{v}_3\\|_2 = \\left\\| \\frac{1}{\\sqrt{6}} \\begin{pmatrix} -\\frac{3}{2} \\\\ \\frac{3}{2} \\\\ 0 \\end{pmatrix} \\right\\|_2\n= \\frac{1}{\\sqrt{6}} \\sqrt{\\left(-\\frac{3}{2}\\right)^2 + \\left(\\frac{3}{2}\\right)^2 + 0^2}\n= \\frac{1}{\\sqrt{6}} \\sqrt{\\frac{9}{4} + \\frac{9}{4}}\n= \\frac{1}{\\sqrt{6}} \\sqrt{\\frac{18}{4}}\n= \\frac{1}{\\sqrt{6}} \\frac{\\sqrt{18}}{\\sqrt{4}}\n= \\frac{1}{\\sqrt{6}} \\frac{3\\sqrt{2}}{2}\n= \\frac{3\\sqrt{2}}{2\\sqrt{6}} = \\frac{3\\sqrt{2}}{2\\sqrt{2}\\sqrt{3}}\n= \\frac{3}{2\\sqrt{3}} = \\frac{3\\sqrt{3}}{2 \\cdot 3} = \\frac{\\sqrt{3}}{2}\n$$\n因此，次对角线系数 $h_{32}$ 为 $\\frac{\\sqrt{3}}{2}$。\n经过两步后，赫森伯格矩阵为\n$$\n\\bar{H}_2 = \\begin{pmatrix} h_{11}  h_{12} \\\\ h_{21}  h_{22} \\\\ 0  h_{32} \\end{pmatrix} = \\begin{pmatrix} 3  \\sqrt{2} \\\\ \\frac{1}{\\sqrt{2}}  3 \\\\ 0  \\frac{\\sqrt{3}}{2} \\end{pmatrix}\n$$\n问题特别要求 $h_{32}$ 的精确值。\n最终值：$h_{32} = \\frac{\\sqrt{3}}{2}$。",
            "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2}}$$"
        },
        {
            "introduction": "从算法力学转向更高级的概念，理论上，完全GMRES（不重启）保证收敛，但其实际应用中更常见的重启版本GMRES($m$)有时会遭遇“停滞”现象。本练习要求你构建并分析一个重启GMRES无法取得进展的实例。通过这个练习，你将对算法的几何特性以及重启参数$m$的重要性有更深刻的认识。",
            "id": "3593977",
            "problem": "您需要构建一个严格的示例，在该示例中，广义最小残差方法（GMRES）在重启动下表现出根本不同的行为。该任务涉及数值线性代数中的预处理GMRES算法。设预处理为左预处理，因此变换后的系统为 $M^{-1} A x = M^{-1} b$，算法最小化的残差为 $\\lVert M^{-1} (b - A x) \\rVert_2$。构建和分析必须从关于Krylov子空间和残差多项式的基本原理出发。\n\n基本定义和事实：\n- 广义最小残差方法（GMRES）构造迭代解 $x_k$，使得预处理残差满足 $r_k = p_k(M^{-1} A) r_0$，其中 $r_0 = b - A x_0$，$p_k$ 是一个次数至多为 $k$ 且满足 $p_k(0) = 1$ 的多项式，并且预处理残差的欧几里得范数在所有此类多项式上被最小化。\n- 由矩阵 $B$ 和向量 $v$ 生成的Krylov子空间为 $\\mathcal{K}_k(B, v) = \\operatorname{span}\\{v, B v, B^2 v, \\dots, B^{k-1} v\\}$。\n- 重启动的GMRES($m$)在连续的循环中应用一个 $m$ 次残差多项式，因此在 $j$ 次循环后，残差为 $r_{jm} = \\left(\\prod_{i=1}^j p_m^{(i)}(M^{-1} A)\\right) r_0$，其中每个 $p_m^{(i)}$ 是一个满足 $p_m^{(i)}(0) = 1$ 的 $m$ 次多项式，并在该循环中生成的相应Krylov子空间上最小化残差。\n\n问题：\n1. 构造一个具体的矩阵 $A \\in \\mathbb{R}^{n \\times n}$、一个左预处理器 $M \\in \\mathbb{R}^{n \\times n}$、一个右端项 $b \\in \\mathbb{R}^n$、一个初始猜测 $x_0 \\in \\mathbb{R}^n$ 和一个重启动长度 $m$，使得重启动的GMRES($m$)停滞（残差范数在循环中没有减小），而未重启动的GMRES在至多 $n$ 次迭代内收敛到解。使用残差多项式表征以及关于Krylov子空间和正交性的几何论证来证明此行为。\n2. 为了构建一个科学上合理且可测试的场景，请考虑使用维度 $n = 4$ 和左预处理的以下明确测试套件：\n   - 将 $A$ 定义为 $\\mathbb{R}^{4 \\times 4}$ 中的循环下移置换矩阵，即 $A e_1 = e_2$，$A e_2 = e_3$，$A e_3 = e_4$，$A e_4 = e_1$，其中 $(e_i)_{i=1}^4$ 是 $\\mathbb{R}^4$ 中的标准基向量。\n   - 定义左预处理器 $M = \\operatorname{diag}(1, 2, 3, 4)$。\n   - 定义 $b = e_1$ 和 $x_0 = 0$。\n   - 使用重启动长度 $m = 1$ 来演示停滞现象，使用未重启动的GMRES来演示收敛性。\n   - 同时测试 $m = 2$ 和 $m = 4$ 以探究中间和边界行为，并测试一个修改后的右端项 $b = e_1 + e_2$ 以打破导致停滞的正交性条件。\n3. 您的程序必须在变换后的系统 $M^{-1} A x = M^{-1} b$上实现左预处理的GMRES，并测量原始残差范数 $\\lVert b - A x \\rVert_2$ 用于报告。它必须为指定的测试套件计算以下可量化的输出：\n   - 测试1（停滞，重启动的GMRES($m=1$)）：使用 $m = 1$ 进行 $8$ 次重启动循环后，比率 $\\rho_1 = \\lVert r_{\\text{final}} \\rVert_2 / \\lVert r_{\\text{initial}} \\rVert_2$，其中 $r_{\\text{initial}} = b - A x_0$，$r_{\\text{final}}$ 是最终残差。这是一个浮点数（float）。\n   - 测试2（未重启动的GMRES收敛）：在不重启动的情况下，最多进行 $n$ 次迭代后的最终残差范数 $\\rho_2 = \\lVert r_{\\text{final}} \\rVert_2$。这是一个浮点数（float）。\n   - 测试3（$m = 2$ 时的进展）：一个布尔值（boolean），指示使用 $m = 2$ 的重启动GMRES在 $4$ 次重启动循环后是否减小了残差范数，即最终范数是否严格小于初始范数。\n   - 测试4（边界情况，$m = n$）：使用 $m = 4$ 的重启动GMRES在单次循环后的最终残差范数 $\\rho_4 = \\lVert r_{\\text{final}} \\rVert_2$。这是一个浮点数（float）。\n   - 测试5（通过改变 $b$ 打破停滞）：一个布尔值（boolean），指示对于修改后的右端项 $b = e_1 + e_2$，使用 $m = 1$ 的重启动GMRES在 $8$ 次循环后是否减小了残差范数。\n4. 角度单位和物理单位不适用于这个纯数学问题。所有范数都是 $\\mathbb{R}^n$ 中的欧几里得范数。矩阵和向量的元素是无单位的实数。\n5. 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4,result5]\"），其中result1和result2是浮点数，result3和result5是布尔值，result4是浮点数。\n\n您的解决方案必须使用残差多项式表征 $r_k = p_k(M^{-1} A) r_0$（其中 $p_k(0) = 1$）和Krylov子空间的几何性质来证明您的构造。代码必须是完整的，可以“按原样”运行，并为给定的测试套件生成指定的输出。",
            "solution": "该问题要求在数值线性代数中构造一个例子，其中重启动的广义最小残差方法（GMRES）停滞，而未重启动的GMRES收敛。分析必须基于Krylov子空间和残差多项式的基本原理。\n\nGMRES算法的核心在于从仿射子空间 $x_0 + \\mathcal{K}_k(B, \\tilde{r}_0)$ 中找到线性系统 $Bx=c$ 的一个近似解 $x_k$。其中 $x_0$ 是初始猜测，$\\mathcal{K}_k(B, \\tilde{r}_0) = \\operatorname{span}\\{\\tilde{r}_0, B\\tilde{r}_0, \\dots, B^{k-1}\\tilde{r}_0\\}$ 是由矩阵 $B$ 和初始残差 $\\tilde{r}_0 = c - Bx_0$ 生成的 $k$ 阶Krylov子空间。选择迭代解 $x_k$ 使其残差 $r_k = c - Bx_k$ 具有最小可能的欧几里得范数 $\\lVert r_k \\rVert_2$。对于一个左预处理系统 $M^{-1}Ax = M^{-1}b$，我们设置 $B = M^{-1}A$ 和 $c = M^{-1}b$。然后，GMRES最小化预处理残差的范数 $\\lVert M^{-1}(b-Ax_k) \\rVert_2$。\n\nGMRES的一个关键几何性质是，新的预处理残差 $\\tilde{r}_k = M^{-1}(b - Ax_k)$ 与子空间 $B \\mathcal{K}_k(B, \\tilde{r}_0)$ 正交，其中 $\\tilde{r}_0 = M^{-1}(b - Ax_0)$ 是初始预处理残差。重启动的GMRES($m$)中的停滞现象发生在算法从一个循环到下一个循环没有任何进展时。如果在一个循环结束时的预处理残差向量 $\\tilde{r}_m$ 与该循环开始时的向量 $\\tilde{r}_0$ 成比例，并且范数的减小为零或可忽略不计，就会发生这种情况。如果 $\\tilde{r}_m=\\tilde{r}_0$，则完全没有进展（零减小）。这种情况发生在一个特定条件下：如果初始预处理残差 $\\tilde{r}_0$ 已经与用于残差更新的搜索空间 $B\\mathcal{K}_m(B, \\tilde{r}_0)$ 正交。在这种情况下，最小性条件通过零更新得到满足，导致 $\\tilde{r}_m = \\tilde{r}_0$。\n\n我们使用指定的参数构造这样一个案例。\n设 $n=4$。系统矩阵是循环下移置换矩阵：\n$$A = \\begin{pmatrix} 0  0  0  1 \\\\ 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\end{pmatrix}$$\n左预处理器是一个对角矩阵：\n$$M = \\operatorname{diag}(1, 2, 3, 4) = \\begin{pmatrix} 1  0  0  0 \\\\ 0  2  0  0 \\\\ 0  0  3  0 \\\\ 0  0  0  4 \\end{pmatrix}$$\n右端项向量是 $b = e_1 = (1, 0, 0, 0)^T$，初始猜测是 $x_0 = 0$。\n\n预处理矩阵是 $B = M^{-1}A$：\n$$B = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1/2  0  0 \\\\ 0  0  1/3  0 \\\\ 0  0  0  1/4 \\end{pmatrix} \\begin{pmatrix} 0  0  0  1 \\\\ 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  1 \\\\ 1/2  0  0  0 \\\\ 0  1/3  0  0 \\\\ 0  0  1/4  0 \\end{pmatrix}$$\n初始残差是 $r_0 = b - Ax_0 = e_1$。初始预处理残差是 $\\tilde{r}_0 = M^{-1}r_0 = M^{-1}e_1 = e_1$。\n\n**1. 重启动的GMRES(m)停滞分析（$m  4$）**\n\n考虑重启动长度 $m  4$ 的GMRES($m$)。第一个循环从 $\\tilde{r}_0=e_1$ 开始。Krylov子空间是 $\\mathcal{K}_m(B, e_1)$。\n我们来计算基向量：\n$e_1$\n$B e_1 = (1/2)e_2$\n$B^2 e_1 = (1/6)e_3$\n$B^3 e_1 = (1/24)e_4$\nKrylov子空间是 $\\mathcal{K}_m(B, e_1) = \\operatorname{span}\\{e_1, e_2, \\dots, e_m\\}$。\n新残差必须与之正交的子空间是 $B \\mathcal{K}_m(B, e_1) = \\operatorname{span}\\{B e_1, \\dots, B e_m\\} = \\operatorname{span}\\{e_2, e_3, \\dots, e_{m+1}\\}$。\n\n对于任何 $m  4$，子空间 $\\mathcal{K}_m(B, e_1)$ 和 $B\\mathcal{K}_m(B, e_1)$ 关于标准内积是正交的，因为它们由不相交的标准基向量集合张成。例如，当 $m=1$ 时，$\\mathcal{K}_1(B, e_1) = \\operatorname{span}\\{e_1\\}$ 和 $B\\mathcal{K}_1(B, e_1) = \\operatorname{span}\\{e_2\\}$，它们是正交的。\n初始预处理残差 $\\tilde{r}_0 = e_1$ 位于 $\\mathcal{K}_m(B, e_1)$ 中，因此与 $B\\mathcal{K}_m(B, e_1)$ 中的每个向量都正交。\nGMRES条件要求新残差 $\\tilde{r}_m$ 与 $B\\mathcal{K}_m(B, e_1)$ 正交。由于 $\\tilde{r}_0$ 已经满足这个正交条件，算法发现最优选择是 $\\tilde{r}_m = \\tilde{r}_0$，这对应于零校正量 $x_m = x_0$。残差范数没有减小。这就是停滞。这个推理适用于任何重启动循环，以及任何重启动长度 $m=1, 2, 3$。\n从残差多项式的角度来看，算法寻找一个次数至多为 $m$ 且满足 $p_m(0)=1$ 的多项式 $p_m(z)$，以最小化 $\\lVert p_m(B) \\tilde{r}_0 \\rVert_2$。这个范数是 $\\lVert p_m(B) e_1 \\rVert_2$。因为向量 $e_1, Be_1, \\dots, B^m e_1$ 是相互正交的，对于 $p_m(z)=\\sum c_j z^j$，我们有 $\\lVert p_m(B) e_1 \\rVert_2^2 = \\sum_{j=0}^m c_j^2 \\lVert B^j e_1 \\rVert_2^2$。在 $c_0=p_m(0)=1$ 的条件下，当所有其他系数为零时，即 $p_m(z)=1$ 时，达到最小值。因此，$\\tilde{r}_m = p_m(B)\\tilde{r}_0 = \\tilde{r}_0$。\n\n**2. 未重启动的GMRES收敛性分析（$m=4$）**\n\n对于未重启动的GMRES，算法运行最多 $n=4$ 次迭代，构建子空间 $\\mathcal{K}_4(B, e_1) = \\operatorname{span}\\{e_1, (1/2)e_2, (1/6)e_3, (1/24)e_4\\} = \\operatorname{span}\\{e_1, e_2, e_3, e_4\\} = \\mathbb{R}^4$。由于Krylov子空间是整个解空间，GMRES保证能找到使残差为零的精确校正量 $z_4 = x_{exact} - x_0$。因此，未重启动的GMRES（等同于GMRES($4$)的一个循环）收敛到精确解，最终的残差范数，无论是预处理的还是原始的，都将为零（或机器精度）。\n\n**3. 打破停滞的分析（$b = e_1+e_2$）**\n\n我们把右端项改为 $b = e_1 + e_2$。初始残差是 $r_0 = e_1 + e_2$，预处理后的初始残差是 $\\tilde{r}_0 = M^{-1}(e_1 + e_2) = e_1 + (1/2)e_2$。\n现在考虑GMRES($1$)。Krylov子空间是 $\\mathcal{K}_1(B, \\tilde{r}_0) = \\operatorname{span}\\{e_1 + (1/2)e_2\\}$。\n用于残差更新的子空间是 $B\\mathcal{K}_1(B, \\tilde{r}_0) = \\operatorname{span}\\{B(e_1 + (1/2)e_2)\\}$。\n$B(e_1 + (1/2)e_2) = B e_1 + (1/2)B e_2 = (1/2)e_2 + (1/2)M^{-1}Ae_2 = (1/2)e_2 + (1/2)M^{-1}e_3 = (1/2)e_2 + (1/6)e_3$。\n关键的正交性条件通过内积来检验：\n$$ \\tilde{r}_0^T (B \\tilde{r}_0) = (e_1 + (1/2)e_2)^T ((1/2)e_2 + (1/6)e_3) = (1/2)(1/2) = 1/4 \\neq 0 $$\n由于 $\\tilde{r}_0$ 与 $B\\mathcal{K}_1(B, \\tilde{r}_0)$ 不正交，GMRES的更新量将非零。算法会将 $\\tilde{r}_0$ 投影到 $B\\mathcal{K}_1(B, \\tilde{r}_0)$ 的正交补上，从而得到一个新的残差 $\\tilde{r}_1$，其范数满足 $\\lVert\\tilde{r}_1\\rVert_2  \\lVert\\tilde{r}_0\\rVert_2$。因此，停滞被打破，GMRES($1$)将在每个循环中取得进展。\n\n这完成了对指定测试案例中观察到的行为的理论证明。所构造的例子巧妙地分离出了导致重启动GMRES停滞的几何条件。",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse.linalg import gmres\n\ndef solve():\n    \"\"\"\n    Constructs and solves the test cases for GMRES stagnation and convergence.\n    \"\"\"\n    n = 4\n    # Define standard basis vectors\n    e1 = np.zeros(n)\n    e1[0] = 1.0\n    e2 = np.zeros(n)\n    e2[1] = 1.0\n\n    # Define the matrix A as the cyclic down-shift permutation matrix\n    A = np.roll(np.eye(n), 1, axis=0)\n\n    # Define the diagonal preconditioner M\n    M = np.diag(np.arange(1, n + 1).astype(float))\n    \n    # Define the initial guess\n    x0 = np.zeros(n)\n    \n    # Define the inverse of the preconditioner\n    M_inv = np.linalg.inv(M)\n    \n    # Pre-compute the transformed matrix for the left-preconditioned system\n    A_tilde = M_inv @ A\n\n    results = []\n\n    # --- Test 1: Stagnation with m=1 ---\n    # b = e1, m=1, 8 restart cycles\n    b1 = e1\n    r_initial_norm_1 = np.linalg.norm(b1 - A @ x0)\n    b_tilde_1 = M_inv @ b1\n    # For m=1 and 8 cycles, restart=1 and maxiter=8\n    x_final_1, _ = gmres(A_tilde, b_tilde_1, x0=x0, restart=1, maxiter=8, atol=1e-12)\n    r_final_1 = b1 - A @ x_final_1\n    rho1 = np.linalg.norm(r_final_1) / r_initial_norm_1\n    results.append(rho1)\n\n    # --- Test 2: Unrestarted GMRES convergence ---\n    # b = e1, unrestarted (m=n=4), max n iterations\n    # For unrestarted GMRES with n=4, restart=4 and maxiter=4\n    x_final_2, _ = gmres(A_tilde, b_tilde_1, x0=x0, restart=4, maxiter=4, atol=1e-12)\n    r_final_2 = b1 - A @ x_final_2\n    rho2 = np.linalg.norm(r_final_2)\n    results.append(rho2)\n\n    # --- Test 3: Progress for m=2 ---\n    # b = e1, m=2, 4 restart cycles. Check for any reduction in norm.\n    r_initial_norm_3 = np.linalg.norm(b1 - A @ x0)\n    # For m=2 and 4 cycles, restart=2 and maxiter=8\n    x_final_3, _ = gmres(A_tilde, b_tilde_1, x0=x0, restart=2, maxiter=8, atol=1e-12)\n    r_final_norm_3 = np.linalg.norm(b1 - A @ x_final_3)\n    progress_3 = r_final_norm_3  r_initial_norm_3\n    results.append(progress_3)\n\n    # --- Test 4: Boundary case m=n ---\n    # b = e1, m=4, 1 cycle. This is identical to unrestarted GMRES.\n    # For m=4 and 1 cycle, restart=4 and maxiter=4\n    x_final_4, _ = gmres(A_tilde, b_tilde_1, x0=x0, restart=4, maxiter=4, atol=1e-12)\n    r_final_4 = b1 - A @ x_final_4\n    rho4 = np.linalg.norm(r_final_4)\n    results.append(rho4)\n\n    # --- Test 5: Breaking stagnation by changing b ---\n    # b = e1+e2, m=1, 8 cycles. Check for any reduction in norm.\n    b5 = e1 + e2\n    r_initial_norm_5 = np.linalg.norm(b5 - A @ x0)\n    b_tilde_5 = M_inv @ b5\n    # For m=1 and 8 cycles, restart=1 and maxiter=8\n    x_final_5, _ = gmres(A_tilde, b_tilde_5, x0=x0, restart=1, maxiter=8, atol=1e-12)\n    r_final_norm_5 = np.linalg.norm(b5 - A @ x_final_5)\n    progress_5 = r_final_norm_5  r_initial_norm_5\n    results.append(progress_5)\n\n    # Format the final output string exactly as specified\n    formatted_results = []\n    for res in results:\n        if isinstance(res, bool):\n            formatted_results.append(str(res).lower())\n        else:\n            formatted_results.append(f\"{res:.15e}\") # Use scientific notation for precision\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}