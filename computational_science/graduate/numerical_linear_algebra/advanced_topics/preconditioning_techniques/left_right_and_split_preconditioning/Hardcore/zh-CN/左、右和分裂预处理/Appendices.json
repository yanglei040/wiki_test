{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在揭示在实践中区分左、右和分裂预处理的核心。通过分析一个简单的 $2 \\times 2$ 系统，我们将探讨每种策略如何影响原始问题的真实残差与迭代求解器监控的预处理残差之间的关系。理解这种联系对于设置正确的停止准则和确保最终解满足所需的精度目标至关重要。",
            "id": "3555570",
            "problem": "考虑线性系统 $A x = b$，其中\n$$\nA = \\begin{bmatrix}4  1 \\\\ 2  3\\end{bmatrix}, \\quad b = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix},\n$$\n以及 $A$ 的一个经典三角分裂，将其分为对角、严格下三角和严格上三角部分，$A = D + L + U$，其中\n$$\nD = \\begin{bmatrix}4  0 \\\\ 0  3\\end{bmatrix}, \\quad L = \\begin{bmatrix}0  0 \\\\ 2  0\\end{bmatrix}, \\quad U = \\begin{bmatrix}0  1 \\\\ 0  0\\end{bmatrix}.\n$$\n定义分裂预处理器 $M_L = D + L = \\begin{bmatrix}4  0 \\\\ 2  3\\end{bmatrix}$ 和 $M_R = D + U = \\begin{bmatrix}4  1 \\\\ 0  3\\end{bmatrix}$。考虑求解 $A x = b$ 的三种预处理策略：\n(1) 使用 $M_L$ 进行左预处理，该策略使用系统 $M_L^{-1} A x = M_L^{-1} b$，\n(2) 使用 $M_R$ 进行右预处理，该策略使用系统 $A M_R^{-1} y = b$ 并令 $x = M_R^{-1} y$，\n以及 (3) 分裂预处理，该策略使用系统 $M_L^{-1} A M_R^{-1} z = M_L^{-1} b$ 并令 $x = M_R^{-1} z$。\n\n令 $\\|\\cdot\\|_{\\infty}$ 表示向量无穷范数和诱导矩阵无穷范数。假设在每种预处理方案下，我们运行一种 Krylov 子空间迭代法，例如广义最小残差（GMRES）方法。在左预处理和分裂预处理中，该方法内部监控的残差是预处理后系统的残差，而在右预处理中，它是相对于原始系统 $A x = b$ 的残差。考虑两个精度目标：\n(i) 一个绝对后向误差目标 $\\|r\\|_{\\infty} \\le \\tau$，其中 $\\tau = 10^{-6}$，$r = b - A x$ 是真实（未经预处理的）残差，\n以及\n(ii) 一个相对后向误差目标 $\\|r\\|_{\\infty} / \\|b\\|_{\\infty} \\le \\varepsilon$，其中 $\\varepsilon = 10^{-6}$。\n\n分析在每种策略中应如何选择内部监控残差的停止准则以实现这些目标，以及如何从预处理变量中正确恢复物理解 $x$。然后，选择下面所有对该测试问题和这些目标有效的陈述。\n\nA. 在使用 $M_R$ 进行右预处理时，方法的残差等于真实残差 $r = b - A x$，因此要求内部监控的 $\\|r\\|_{\\infty} \\le 10^{-6}$ 可直接强制实现绝对目标；此外，物理解通过 $x = M_R^{-1} y$ 恢复。\n\nB. 在使用 $M_L$ 进行左预处理时，确保内部监控的预处理残差 $\\|\\hat{r}\\|_{\\infty} \\le 10^{-6}$（其中 $\\hat{r} = M_L^{-1}(b - A x)$）可以保证 $\\|r\\|_{\\infty} \\le 10^{-6}$，因此不需要进行缩放即可满足绝对目标。\n\nC. 在分裂预处理中，对于系统 $M_L^{-1} A M_R^{-1} z = M_L^{-1} b$，内部监控的残差是 $\\hat{r} = M_L^{-1}(b - A x)$，并且为了确保 $\\|r\\|_{\\infty} \\le \\tau$，只需满足 $\\|\\hat{r}\\|_{\\infty} \\le \\tau / \\|M_L\\|_{\\infty}$ 即可；物理解被恢复为 $x = M_R^{-1} z$。\n\nD. 对于使用 $M_L$ 进行左预处理下的相对后向误差目标 $\\|r\\|_{\\infty} / \\|b\\|_{\\infty} \\le \\varepsilon$，如果方法监控 $\\|\\hat{r}\\|_{\\infty} / \\|\\hat{b}\\|_{\\infty}$（其中 $\\hat{b} = M_L^{-1} b$），那么当 $\\|\\hat{r}\\|_{\\infty} / \\|\\hat{b}\\|_{\\infty} \\le \\varepsilon / \\kappa_{\\infty}(M_L)$ 时应该停止，其中 $\\kappa_{\\infty}(M_L) = \\|M_L\\|_{\\infty} \\|M_L^{-1}\\|_{\\infty}$；对于这个测试问题，$\\kappa_{\\infty}(M_L) = 2.5$。\n\nE. 右预处理会破坏绝对后向误差的测量，因此当指定了绝对残差容差时不能使用。\n\nF. 在分裂预处理中，物理解必须通过 $x = M_L^{-1} z$ 而不是 $x = M_R^{-1} z$ 来恢复；这对于与监控的残差保持一致性至关重要。\n\n选择所有正确选项。",
            "solution": "用户要求对一个关于使用预处理迭代法求解线性系统的问题进行详细分析。主要任务是验证问题陈述的有效性，如果有效，则评估关于不同预处理策略的几个论断。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n问题提供了以下信息：\n- 线性系统为 $A x = b$。\n- 矩阵 $A$ 由 $A = \\begin{bmatrix}4  1 \\\\ 2  3\\end{bmatrix}$ 给出。\n- 向量 $b$ 由 $b = \\begin{bmatrix}1 \\\\ 1\\end{bmatrix}$ 给出。\n- $A$ 的一个三角分裂定义为 $A = D + L + U$，其中：\n  - $D = \\begin{bmatrix}4  0 \\\\ 0  3\\end{bmatrix}$ (对角部分)\n  - $L = \\begin{bmatrix}0  0 \\\\ 2  0\\end{bmatrix}$ (严格下三角部分)\n  - $U = \\begin{bmatrix}0  1 \\\\ 0  0\\end{bmatrix}$ (严格上三角部分)\n- 左预处理器为 $M_L = D + L = \\begin{bmatrix}4  0 \\\\ 2  3\\end{bmatrix}$。\n- 右预处理器为 $M_R = D + U = \\begin{bmatrix}4  1 \\\\ 0  3\\end{bmatrix}$。\n- 考虑了 Krylov 子空间方法的三种预处理策略：\n  1. **左预处理**：求解 $M_L^{-1} A x = M_L^{-1} b$。内部监控的残差是该预处理系统的残差。\n  2. **右预处理**：求解 $A M_R^{-1} y = b$ 并令 $x = M_R^{-1} y$。内部监控的残差是原始系统的残差 $r = b - A x$。\n  3. **分裂预处理**：求解 $M_L^{-1} A M_R^{-1} z = M_L^{-1} b$ 并令 $x = M_R^{-1} z$。内部监控的残差是该预处理系统的残差。\n- 使用的范数是无穷范数 $\\|\\cdot\\|_{\\infty}$。\n- 真实（未经预处理的）残差定义为 $r = b - A x$。\n- 考虑了真实残差的两个精度目标：\n  - (i) 绝对后向误差：$\\|r\\|_{\\infty} \\le \\tau$，其中 $\\tau = 10^{-6}$。\n  - (ii) 相对后向误差：$\\|r\\|_{\\infty} / \\|b\\|_{\\infty} \\le \\varepsilon$，其中 $\\varepsilon = 10^{-6}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n根据验证标准对问题陈述进行分析。\n- **科学基础**：该问题牢固地建立在数值线性代数的既定理论之上。左预处理、右预处理和分裂预处理是加速Krylov子空间方法（如GMRES）的标准技术。真实残差和预处理残差的概念，以及范数和条件数，都是该领域的基础。\n- **适定性**：该问题是适定的。矩阵 $A$、$M_L$ 和 $M_R$ 都是非奇异的。所提问题是关于不同量之间的形式关系，这些关系在数学上是可推导的。可以进行唯一且有意义的分析。\n- **客观性**：问题以精确、客观、无歧义的数学语言陈述。所有术语均为标准术语或有明确定义。\n- **缺陷分析**：\n  1. **科学/事实不健全**：无。矩阵分裂和定义都是正确的。\n  2. **非形式化/不相关**：问题是直接可形式化的，并且是预处理主题的核心。\n  3. **不完整/矛盾的设置**：设置是完整且内部一致的。它提供了所有必要的矩阵、定义和目标。\n  4. **不切实际/不可行**：问题使用了一个简单的 $2 \\times 2$ 系统，这是说明理论概念的常用且有效的方法。\n  5. **不适定/结构不良**：结构清晰且合乎逻辑，导向一个明确的分析任务。\n  6. **伪深刻/琐碎**：问题需要仔细应用范数不等式和预处理的定义，测试的是概念性理解，而非琐碎问题。\n  7. **超出科学可验证范围**：所有论断在数学上都是可验证的。\n\n**第 3 步：结论与行动**\n\n问题陈述是**有效的**。可以进行分析。\n\n### 推导与选项分析\n\n令 $x_k$ 为解的第 $k$ 次迭代。真实残差为 $r_k = b - A x_k$。我们分析每种策略下真实残差与监控残差之间的关系。\n\n**策略 1：左预处理**\n求解的系统是 $(M_L^{-1} A) x = M_L^{-1} b$。\n迭代方法生成迭代值 $x_k$ 和相应的监控（预处理）残差\n$$\n\\hat{r}_k = (M_L^{-1} b) - (M_L^{-1} A) x_k = M_L^{-1} (b - A x_k) = M_L^{-1} r_k.\n$$\n从这个关系中，我们有 $r_k = M_L \\hat{r}_k$。应用范数，我们得到界：\n$$\n\\|r_k\\|_{\\infty} = \\|M_L \\hat{r}_k\\|_{\\infty} \\le \\|M_L\\|_{\\infty} \\|\\hat{r}_k\\|_{\\infty}\n$$\n和\n$$\n\\|\\hat{r}_k\\|_{\\infty} = \\|M_L^{-1} r_k\\|_{\\infty} \\le \\|M_L^{-1}\\|_{\\infty} \\|r_k\\|_{\\infty}.\n$$\n\n**策略 2：右预处理**\n求解的系统是 $(A M_R^{-1}) y = b$。迭代方法生成迭代值 $y_k$。物理解的迭代值为 $x_k = M_R^{-1} y_k$。\n问题陈述，监控的残差是原始系统的残差。我们来验证这是否一致。转换后系统的残差是 $b - (A M_R^{-1}) y_k$。\n代入 $y_k = M_R x_k$，这变成 $b - (A M_R^{-1}) (M_R x_k) = b - A x_k = r_k$。\n因此，监控的残差确实是真实残差，$\\hat{r}_k = r_k$。这是右预处理的一个关键优势。解通过 $x = M_R^{-1} y$ 恢复。\n\n**策略 3：分裂预处理**\n求解的系统是 $(M_L^{-1} A M_R^{-1}) z = M_L^{-1} b$。迭代方法生成迭代值 $z_k$。物理解通过设置 $x_k = M_R^{-1} z_k$ 恢复。\n预处理残差是\n$$\n\\hat{r}_k = (M_L^{-1} b) - (M_L^{-1} A M_R^{-1}) z_k = M_L^{-1} (b - A (M_R^{-1} z_k)).\n$$\n代入 $x_k = M_R^{-1} z_k$，我们得到\n$$\n\\hat{r}_k = M_L^{-1} (b - A x_k) = M_L^{-1} r_k.\n$$\n这与左预处理中的关系相同：$r_k = M_L \\hat{r}_k$。\n\n在建立了这些原则之后，我们评估每个选项。\n\n**A. 在使用 $M_R$ 进行右预处理时，方法的残差等于真实残差 $r = b - A x$，因此要求内部监控的 $\\|r\\|_{\\infty} \\le 10^{-6}$ 可直接强制实现绝对目标；此外，物理解通过 $x = M_R^{-1} y$ 恢复。**\n我们对右预处理的分析表明，监控的残差与真实残差相同，$r = b - A x$。因此，基于监控残差的停止准则 $\\|\\hat{r}\\|_{\\infty} \\le \\tau$ 直接强制实现了对真实残差的目标 $\\|r\\|_{\\infty} \\le \\tau$。变量转换被正确地表述为 $x = M_R^{-1} y$。该陈述完全准确。\n**结论：正确。**\n\n**B. 在使用 $M_L$ 进行左预处理时，确保内部监控的预处理残差 $\\|\\hat{r}\\|_{\\infty} \\le 10^{-6}$（其中 $\\hat{r} = M_L^{-1}(b - A x)$）可以保证 $\\|r\\|_{\\infty} \\le 10^{-6}$，因此不需要进行缩放即可满足绝对目标。**\n真实残差和预处理残差之间的关系是 $r = M_L \\hat{r}$。取范数，$\\|r\\|_{\\infty} \\le \\|M_L\\|_{\\infty} \\|\\hat{r}\\|_{\\infty}$。该陈述意味着 $\\|M_L\\|_{\\infty} \\le 1$。让我们计算 $\\|M_L\\|_{\\infty}$。\n$$\nM_L = \\begin{bmatrix}4  0 \\\\ 2  3\\end{bmatrix}\n$$\n矩阵的无穷范数是最大绝对行和。\n- 第 1 行和：$|4| + |0| = 4$。\n- 第 2 行和：$|2| + |3| = 5$。\n因此，$\\|M_L\\|_{\\infty} = 5$。由于 $\\|M_L\\|_{\\infty} > 1$，条件 $\\|\\hat{r}\\|_{\\infty} \\le 10^{-6}$ 仅保证 $\\|r\\|_{\\infty} \\le 5 \\times 10^{-6}$。它不能保证 $\\|r\\|_{\\infty} \\le 10^{-6}$。事实上，真实残差可能比监控的残差大。需要进行缩放。\n**结论：错误。**\n\n**C. 在分裂预处理中，对于系统 $M_L^{-1} A M_R^{-1} z = M_L^{-1} b$，内部监控的残差是 $\\hat{r} = M_L^{-1}(b - A x)$，并且为了确保 $\\|r\\|_{\\infty} \\le \\tau$，只需满足 $\\|\\hat{r}\\|_{\\infty} \\le \\tau / \\|M_L\\|_{\\infty}$ 即可；物理解被恢复为 $x = M_R^{-1} z$。**\n这个陈述有三个部分。\n1. **物理解恢复**：求解的系统是 $A'z = b'$，其中 $A' = M_L^{-1} A M_R^{-1}$ 且 $b' = M_L^{-1} b$。左乘 $M_L$ 得到 $A M_R^{-1} z = b$。与原始系统 $Ax=b$ 比较，我们看到 $x=M_R^{-1}z$。这是正确的。\n2. **监控的残差**：如前面对分裂预处理的推导，监控的残差 $\\hat{r}$（对于以 $z$ 为变量的系统）与真实残差 $r = b - Ax$ 的关系为 $\\hat{r} = M_L^{-1} r$。陈述中将其表示为 $\\hat{r} = M_L^{-1}(b-Ax)$，这是正确的。\n3. **停止准则**：从 $r = M_L \\hat{r}$，我们有 $\\|r\\|_{\\infty} = \\|M_L \\hat{r}\\|_{\\infty} \\le \\|M_L\\|_{\\infty} \\|\\hat{r}\\|_{\\infty}$。为了确保 $\\|r\\|_{\\infty} \\le \\tau$，强制执行 $\\|M_L\\|_{\\infty} \\|\\hat{r}\\|_{\\infty} \\le \\tau$ 是充分的，这可以重新排列为 $\\|\\hat{r}\\|_{\\infty} \\le \\tau / \\|M_L\\|_{\\infty}$。这部分也是正确的。\n陈述的所有部分都是正确的。\n**结论：正确。**\n\n**D. 对于使用 $M_L$ 进行左预处理下的相对后向误差目标 $\\|r\\|_{\\infty} / \\|b\\|_{\\infty} \\le \\varepsilon$，如果方法监控 $\\|\\hat{r}\\|_{\\infty} / \\|\\hat{b}\\|_{\\infty}$（其中 $\\hat{b} = M_L^{-1} b$），那么当 $\\|\\hat{r}\\|_{\\infty} / \\|\\hat{b}\\|_{\\infty} \\le \\varepsilon / \\kappa_{\\infty}(M_L)$ 时应该停止，其中 $\\kappa_{\\infty}(M_L) = \\|M_L\\|_{\\infty} \\|M_L^{-1}\\|_{\\infty}$；对于这个测试问题，$\\kappa_{\\infty}(M_L) = 2.5$。**\n让我们分析相对误差的传播。真实相对残差是 $\\|r\\|_{\\infty} / \\|b\\|_{\\infty}$。监控的相对残差是 $\\|\\hat{r}\\|_{\\infty} / \\|\\hat{b}\\|_{\\infty}$。\n我们有关系式 $r = M_L \\hat{r}$ 和 $b = M_L \\hat{b}$。由此我们得到不等式：\n$\\|r\\|_{\\infty} \\le \\|M_L\\|_{\\infty} \\|\\hat{r}\\|_{\\infty}$\n$\\|\\hat{b}\\|_{\\infty} = \\|M_L^{-1} b\\|_{\\infty} \\le \\|M_L^{-1}\\|_{\\infty} \\|b\\|_{\\infty} \\implies \\|b\\|_{\\infty} \\ge \\frac{\\|\\hat{b}\\|_{\\infty}}{\\|M_L^{-1}\\|_{\\infty}}$。\n将这些结合起来以界定真实相对误差：\n$$\n\\frac{\\|r\\|_{\\infty}}{\\|b\\|_{\\infty}} \\le \\frac{\\|M_L\\|_{\\infty} \\|\\hat{r}\\|_{\\infty}}{\\|\\hat{b}\\|_{\\infty} / \\|M_L^{-1}\\|_{\\infty}} = \\left(\\|M_L\\|_{\\infty} \\|M_L^{-1}\\|_{\\infty}\\right) \\frac{\\|\\hat{r}\\|_{\\infty}}{\\|\\hat{b}\\|_{\\infty}} = \\kappa_{\\infty}(M_L) \\frac{\\|\\hat{r}\\|_{\\infty}}{\\|\\hat{b}\\|_{\\infty}}.\n$$\n为了保证 $\\|r\\|_{\\infty} / \\|b\\|_{\\infty} \\le \\varepsilon$，强制要求 $\\kappa_{\\infty}(M_L) \\frac{\\|\\hat{r}\\|_{\\infty}}{\\|\\hat{b}\\|_{\\infty}} \\le \\varepsilon$ 是充分的，这意味着对监控相对残差的停止准则应该是 $\\frac{\\|\\hat{r}\\|_{\\infty}}{\\|\\hat{b}\\|_{\\infty}} \\le \\frac{\\varepsilon}{\\kappa_{\\infty}(M_L)}$。这个逻辑是正确的。\n现在，我们计算 $\\kappa_{\\infty}(M_L) = \\|M_L\\|_{\\infty} \\|M_L^{-1}\\|_{\\infty}$。\n我们已经得到 $\\|M_L\\|_{\\infty} = 5$。我们需要 $M_L^{-1}$。\n行列式为 $\\det(M_L) = (4)(3) - (0)(2) = 12$。\n逆矩阵是 $M_L^{-1} = \\frac{1}{12}\\begin{bmatrix}3  0 \\\\ -2  4\\end{bmatrix} = \\begin{bmatrix}1/4  0 \\\\ -1/6  1/3\\end{bmatrix}$。\n逆矩阵的无穷范数是最大绝对行和：\n- 第 1 行和：$|1/4| + |0| = 1/4 = 0.25$。\n- 第 2 行和：$|-1/6| + |1/3| = 1/6 + 2/6 = 3/6 = 1/2 = 0.5$。\n所以，$\\|M_L^{-1}\\|_{\\infty} = 1/2$。\n条件数为 $\\kappa_{\\infty}(M_L) = \\|M_L\\|_{\\infty} \\|M_L^{-1}\\|_{\\infty} = 5 \\times (1/2) = 2.5$。\n计算出的值与陈述中给出的值相匹配。陈述的两个部分都是正确的。\n**结论：正确。**\n\n**E. 右预处理会破坏绝对后向误差的测量，因此当指定了绝对残差容差时不能使用。**\n这个陈述与事实相反。正如在选项 A 的分析中所确立的，右预处理中的监控残差**就是**真实残差。它提供了对后向误差的直接、无损的度量。在三种方法中，它是对真实残差强制施加特定容差最可靠的方法。\n**结论：错误。**\n\n**F. 在分裂预处理中，物理解必须通过 $x = M_L^{-1} z$ 而不是 $x = M_R^{-1} z$ 来恢复；这对于与监控的残差保持一致性至关重要。**\n如选项 C 的分析所推导的，求解的系统是 $M_L^{-1} A M_R^{-1} z = M_L^{-1} b$。乘以 $M_L$ 得到 $A (M_R^{-1} z) = b$。与原始系统 $Ax=b$ 比较，正确的转换是 $x = M_R^{-1} z$。该陈述建议 $x = M_L^{-1} z$，这是不正确的。\n**结论：错误。**",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "当与像 GMRES 这样的 Krylov 子空间方法结合使用时，预处理技术最为强大。本实践问题提供了一个定量比较，以展示这种协同效应，它使用了经典的一维拉普拉斯矩阵和一个简单的雅可比预处理器。通过计算和比较稳态雅可比方法和预处理 GMRES 的收敛速度，您将具体体会到改善矩阵的谱性质如何能显著加速收敛。",
            "id": "3555541",
            "problem": "考虑一个线性系统，其矩阵 $A \\in \\mathbb{R}^{n \\times n}$ ($n=7$) 源于在均匀网格上对一维狄利克雷拉普拉斯算子进行二阶中心有限差分离散化。因此，$A$ 是一个三对角托普利茨矩阵，其主对角线元素为 $2$，第一条次对角线和第一条超对角线元素为 $-1$。设雅可比分裂为 $A = D - (L + U)$，其中 $D$ 是 $A$ 的对角部分，$L$ 和 $U$ 分别是 $A$ 的严格下三角和严格上三角部分。\n\n将 $D$ 视为一个分裂预条件子。首先，确定谱半径 $\\rho(D^{-1}(L+U))$。接下来，考虑应用以 $D$ 进行左预处理的广义最小残差法 (GMRES)，得到预处理算子 $D^{-1}A$。设定常雅可比方法的迭代更新式为 $x^{(m+1)} = D^{-1}(L+U)x^{(m)} + D^{-1}b$，并定义雅可比方法的最坏情况下的每次迭代收缩因子为 $r_{J} := \\rho(D^{-1}(L+U))$。对于应用于对称正定(SPD)矩阵 $D^{-1}A$ 的左预处理GMRES方法，使用最优切比雪夫多项式模型，并定义其有效的每次迭代收缩因子为 $q := \\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}$，其中 $\\kappa$ 是 $D^{-1}A$ 的条件数。\n\n通过将残差范数减小一个因子 $10^{-6}$ 所需的迭代次数之比来量化预处理GMRES相对于定常雅可bi方法的改进效果，即\n$$\n\\text{Improvement} := \\frac{m_{J}}{m_{\\mathrm{GMRES}}},\n$$\n其中 $m_{J}$ 是满足 $r_{J}^{m_{J}} \\leq 10^{-6}$ 的最小整数，$m_{\\mathrm{GMRES}}$ 是满足 $q^{m_{\\mathrm{GMRES}}} \\leq 10^{-6}$ 的最小整数。请将此改进比率作为你的最终答案。",
            "solution": "该问题已经过验证，被认为是具有科学依据、良定且客观的。这是数值线性代数中一个关于比较求解线性系统的迭代方法的标准问题。\n\n问题要求计算对于特定的线性系统 $A\\mathbf{x} = \\mathbf{b}$，预处理GMRES方法相对于定常雅可比方法的改进比率。矩阵 $A \\in \\mathbb{R}^{n \\times n}$ ($n=7$) 是通过对一维狄利克雷拉普拉斯算子进行中心有限差分离散化得到的三对角托普利茨矩阵，其元素为 $A_{ii} = 2$ 和 $A_{i, i\\pm 1} = -1$。\n\n$A$ 的雅可比分裂为 $A = D - (L+U)$，其中 $D$ 是 $A$ 的对角部分，$L$ 和 $U$ 分别是 $A$ 的严格下三角和严格上三角部分。在本例中，$D=2I$，其中 $I$ 是 $n \\times n$ 的单位矩阵。雅可比迭代矩阵为 $T_J = D^{-1}(L+U) = I - D^{-1}A$。\n\n首先，我们确定雅可比方法的收敛因子 $r_J = \\rho(T_J)$，即 $T_J$ 的谱半径。矩阵 $A$ 的特征值已知为\n$$\n\\lambda_k(A) = 2 - 2\\cos\\left(\\frac{k\\pi}{n+1}\\right), \\quad k = 1, 2, \\ldots, n\n$$\n当 $n=7$ 时，我们有 $n+1=8$。$T_J = I - D^{-1}A = I - \\frac{1}{2}A$ 的特征值为\n$$\n\\mu_k(T_J) = 1 - \\frac{1}{2}\\lambda_k(A) = 1 - \\frac{1}{2}\\left(2 - 2\\cos\\left(\\frac{k\\pi}{8}\\right)\\right) = \\cos\\left(\\frac{k\\pi}{8}\\right)\n$$\n其中 $k = 1, 2, \\ldots, 7$。谱半径是这些特征值的最大绝对值。\n$$\nr_J = \\rho(T_J) = \\max_{k \\in \\{1, \\ldots, 7\\}} \\left|\\cos\\left(\\frac{k\\pi}{8}\\right)\\right| = \\cos\\left(\\frac{\\pi}{8}\\right)\n$$\n这是因为当 $x \\in [0, \\pi/2)$ 时，$\\cos(x)$ 是正的且递减的，并且 $|\\cos(x)| = |\\cos(\\pi-x)|$。最大绝对值在最小的自变量值 $k=1$ 及其对应的 $k=7$ 处取得，因为 $|\\cos(7\\pi/8)| = |-\\cos(\\pi/8)| = \\cos(\\pi/8)$。\n\n接下来，我们考虑用 $D=2I$ 进行左预处理的GMRES方法。预处理矩阵为 $M^{-1}A = D^{-1}A = \\frac{1}{2}A$。由于 $A$ 是对称正定(SPD)的，且 $D$ 是单位矩阵的标量倍，因此预处理矩阵 $D^{-1}A$ 也是对称正定的。其特征值为\n$$\n\\lambda_k(D^{-1}A) = \\frac{1}{2}\\lambda_k(A) = 1 - \\cos\\left(\\frac{k\\pi}{8}\\right), \\quad k=1, \\ldots, 7\n$$\n$D^{-1}A$ 的条件数 $\\kappa$ 是其最大特征值与最小特征值之比：\n$$\n\\lambda_{\\min}(D^{-1}A) = \\lambda_1 = 1 - \\cos\\left(\\frac{\\pi}{8}\\right)\n$$\n$$\n\\lambda_{\\max}(D^{-1}A) = \\lambda_7 = 1 - \\cos\\left(\\frac{7\\pi}{8}\\right) = 1 - \\cos\\left(\\pi - \\frac{\\pi}{8}\\right) = 1 + \\cos\\left(\\frac{\\pi}{8}\\right)\n$$\n因此，条件数为\n$$\n\\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{1 + \\cos(\\pi/8)}{1 - \\cos(\\pi/8)}\n$$\n预处理GMRES方法的有效每次迭代收缩因子由 $q = \\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}$ 给出。代入 $\\kappa$ 的表达式：\n$$\n\\sqrt{\\kappa} = \\sqrt{\\frac{1 + \\cos(\\pi/8)}{1 - \\cos(\\pi/8)}}\n$$\n使用半角三角恒等式 $\\cot(x/2) = \\sqrt{\\frac{1+\\cos(x)}{1-\\cos(x)}}$，我们得到\n$$\n\\sqrt{\\kappa} = \\cot\\left(\\frac{\\pi}{16}\\right)\n$$\n于是，收缩因子 $q$ 变为\n$$\nq = \\frac{\\cot(\\pi/16) - 1}{\\cot(\\pi/16) + 1}\n$$\n使用恒等式 $\\tan(\\pi/4 - x) = \\frac{1-\\tan(x)}{1+\\tan(x)} = \\frac{\\cot(x)-1}{\\cot(x)+1}$，我们发现\n$$\nq = \\tan\\left(\\frac{\\pi}{4} - \\frac{\\pi}{16}\\right) = \\tan\\left(\\frac{3\\pi}{16}\\right)\n$$\n现在我们必须计算每种方法将残差范数减小一个因子 $10^{-6}$ 所需的迭代次数。\n对于雅可比方法，我们需要找到满足 $r_J^{m_J} \\leq 10^{-6}$ 的最小整数 $m_J$。\n$$\nm_J \\ln(r_J) \\leq -6 \\ln(10) \\implies m_J \\geq \\frac{-6 \\ln(10)}{\\ln(r_J)}\n$$\n由于 $m_J$ 必須是整数，所以 $m_J = \\left\\lceil \\frac{-6 \\ln(10)}{\\ln(r_J)} \\right\\rceil = \\left\\lceil \\frac{-6 \\ln(10)}{\\ln(\\cos(\\pi/8))} \\right\\rceil$。\n在数值上，$\\ln(10) \\approx 2.302585$，所以 $-6 \\ln(10) \\approx -13.81551$。$\\cos(\\pi/8)$ 的值约为 $0.92388$，所以 $\\ln(\\cos(\\pi/8)) \\approx -0.079159$。\n$$\nm_J = \\left\\lceil \\frac{-13.81551}{-0.079159} \\right\\rceil = \\lceil 174.542 \\rceil = 175\n$$\n对于预处理GMRES方法，我们需要找到满足 $q^{m_{\\mathrm{GMRES}}} \\leq 10^{-6}$ 的最小整数 $m_{\\mathrm{GMRES}}$。\n$$\nm_{\\mathrm{GMRES}} = \\left\\lceil \\frac{-6 \\ln(10)}{\\ln(q)} \\right\\rceil = \\left\\lceil \\frac{-6 \\ln(10)}{\\ln(\\tan(3\\pi/16))} \\right\\rceil\n$$\n在数值上，$\\tan(3\\pi/16) \\approx 0.668179$，所以 $\\ln(\\tan(3\\pi/16)) \\approx -0.403205$。\n$$\nm_{\\mathrm{GMRES}} = \\left\\lceil \\frac{-13.81551}{-0.403205} \\right\\rceil = \\lceil 34.264 \\rceil = 35\n$$\n最后，改进比率是迭代次数之比：\n$$\n\\text{Improvement} = \\frac{m_J}{m_{\\mathrm{GMRES}}} = \\frac{175}{35} = 5\n$$",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "不完全 LU (ILU) 分解是一种流行且有效的预处理技术，但如果不加注意（例如进行主元选择），其构建过程可能会失败。本问题探讨了一个朴素 ILU(0) 分解失效的场景，并演示了行置換（主元选择）如何解决该问题。更重要的是，我们将分析这一操作对左、右预处理算子产生的不同代数后果，从而揭示预处理器构建与预处理策略选择之间更深层次的联系。",
            "id": "3555596",
            "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是稀疏矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  1\n\\end{pmatrix}.\n$$\n考虑在自然行序下不进行主元选择，对矩阵 $A$ 执行零填充的不完全 LU 分解（记作 $\\mathrm{ILU}(0)$）。因此，不完全因子 $L$ 和 $U$ 分别继承 $A$ 的严格下三角部分和上三角部分的稀疏模式，其中 $L$ 是单位下三角矩阵。定义预处理矩阵 $M$ 为 $M = L U$。\n\n任务：\n1. 仅使用因式分解和主元选择的基本定义，论证在不进行主元选择的情况下，对 $A$ 的 $\\mathrm{ILU}(0)$ 过程是否能保持 $M$ 的非奇异性，并通过分析第一个主元来证明你的结论。\n2. 设 $P \\in \\mathbb{R}^{3 \\times 3}$ 是交换第一行和第二行的置换矩阵。对置换后的矩阵 $P A$ 执行 $\\mathrm{ILU}(0)$ 分解，并构造出满足上述相同稀疏性约束的显式 $L$ 和 $U$，使得 $P A = L U$。定义相应的预处理器 $M := L U$。\n3. 仅使用左右预处理的定义，分析这种主元选择对预处理算子的影响。具体来说，定义左预处理算子 $T_{\\mathrm{left}} := M^{-1} A$ 和右预处理算子 $T_{\\mathrm{right}} := A M^{-1}$，并推导出它们用 $P$ 表示的精确形式。\n4. 计算左预处理算子 $T_{\\mathrm{left}}$ 的行列式。将你的最终答案表示为一个实数。不需要四舍五入。",
            "solution": "我们将按顺序完成所述的四个任务来解决这个问题。\n\n给定的稀疏矩阵是\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  1\n\\end{pmatrix} \\in \\mathbb{R}^{3 \\times 3}.\n$$\n\n任务1：分析在不进行主元选择的情况下对 $A$ 的 $\\mathrm{ILU}(0)$ 分解。\n\n$\\mathrm{ILU}(0)$ 分解构造了一个近似 $M=LU \\approx A$，其中 $L$ 是单位下三角矩阵， $U$ 是上三角矩阵。$L$ 的稀疏模式被约束为 $A$ 的严格下三角部分的稀疏模式，而 $U$ 的稀疏模式被约束为 $A$ 的上三角部分的稀疏模式。\n\n对于给定的矩阵 $A$，其严格下三角部分仅在位置 $(2,1)$ 有一个非零元。其上三角部分（包括对角线）在 $(1,2)$、$(2,1)$、$(2,3)$ 和 $(3,3)$ 处有非零元。不对，上三角部分当然是在 $(1,1), (1,2), (1,3), (2,2), (2,3), (3,3)$ 这些位置有元素。稀疏模式约束规定了 $L$ 和 $U$ 中的哪些元素可以为非零。\n基于 $A$ 的稀疏性：\n$$\nA = \\begin{pmatrix}\nA_{11}  A_{12}  0 \\\\\nA_{21}  A_{22}  A_{23} \\\\\n0  A_{32}  A_{33}\n\\end{pmatrix}\n$$\n$L$ 和 $U$ 因子必须具有以下形式：\n$$\nL = \\begin{pmatrix}\n1  0  0 \\\\\nl_{21}  1  0 \\\\\n0  l_{32}  1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\nu_{11}  u_{12}  0 \\\\\n0  u_{22}  u_{23} \\\\\n0  0  u_{33}\n\\end{pmatrix}\n$$\nILU 分解过程是高斯消去法的一个变体。第一步涉及主元 $A_{11}$。为了计算因子的元素，我们通常会设置 $u_{11} = A_{11}$。在这个问题中，$A_{11} = 0$。\n\n计算不完全分解的算法需要计算乘数 $l_{21}$ 为 $l_{21} = A_{21} / u_{11} = A_{21} / A_{11}$。由于 $A_{21}=1$ 且 $A_{11}=0$，此计算涉及除以零。因此，在不进行主元选择的情况下，对 $A$ 的 $\\mathrm{ILU}(0)$ 过程在第一步就失败了。\n\n如果分解可以继续进行，预处理器将是 $M = LU$。$M$ 的行列式是 $\\det(M) = \\det(L)\\det(U)$。由于 $L$ 是单位下三角矩阵，$\\det(L)=1$。$U$ 的行列式是其对角线元素的乘积，即 $\\det(U) = u_{11} u_{22} u_{33}$。如前所述，算法会设置 $u_{11} = A_{11} = 0$。因此，$\\det(U) = 0$，这意味着 $\\det(M) = 0$。\n奇异的预处理器 $M$ 在计算上是不可取的，因为它的逆 $M^{-1}$ 不存在，这使得求解预处理后的系统成为不可能。\n任务1的结论：在不进行主元选择的情况下，对 $A$ 的 $\\mathrm{ILU}(0)$ 过程由于在位置 $(1,1)$ 处出现零主元而失败。这一失败意味着无法形成非奇异的预处理器 $M$；如果形式上构造出来，它也将是奇异的，因为它的第一个对角元素 $u_{11}$ 将为零。\n\n任务2：对置换矩阵 $PA$ 进行 $\\mathrm{ILU}(0)$ 分解。\n\n交换第一行和第二行的置换矩阵 $P$ 是：\n$$\nP = \\begin{pmatrix}\n0  1  0 \\\\\n1  0  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n置换后的矩阵 $PA$ 是：\n$$\nPA = \\begin{pmatrix}\n0  1  0 \\\\\n1  0  0 \\\\\n0  0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  1\n\\end{pmatrix} =\n\\begin{pmatrix}\n1  0  1 \\\\\n0  1  0 \\\\\n0  1  1\n\\end{pmatrix}.\n$$\n我们将这个置换后的矩阵记为 $A' = PA$。我们对 $A'$ 执行 $\\mathrm{ILU}(0)$ 分解。$L$ 和 $U$ 的稀疏模式继承自 $A'$。\n矩阵 $A'$ 在其严格下三角部分仅在位置 $(3,2)$ 有非零元。其上三角部分在 $(1,1), (1,3), (2,2), (3,2), (3,3)$ 处有非零元。不对，上三角部分是位置 $(i,j)$ 满足 $i \\leq j$ 的部分。非零元位于 $(1,1), (1,3), (2,2), (3,3)$。另外，$A'_{32}=1$。\n$A'$ 的因子 $L$ 和 $U$ 将具有以下形式：\n$$\nL = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  l_{32}  1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\nu_{11}  0  u_{13} \\\\\n0  u_{22}  0 \\\\\n0  0  u_{33}\n\\end{pmatrix}\n$$\n因为 $A'_{21}=0, A'_{31}=0, A'_{12}=0, A'_{23}=0$。\n乘积 $LU$ 是：\n$$\nLU = \\begin{pmatrix}\nu_{11}  0  u_{13} \\\\\n0  u_{22}  0 \\\\\n0  l_{32}u_{22}  u_{33}\n\\end{pmatrix}.\n$$\n我们将 $LU$ 的非零元与 $A'$ 的相应元素相等：\n$$\n\\begin{pmatrix}\nu_{11}  0  u_{13} \\\\\n0  u_{22}  0 \\\\\n0  l_{32}u_{22}  u_{33}\n\\end{pmatrix} =\n\\begin{pmatrix}\n1  0  1 \\\\\n0  1  0 \\\\\n0  1  1\n\\end{pmatrix}.\n$$\n从这个等式中，我们找到系数：\n$u_{11} = 1$\n$u_{13} = 1$\n$u_{22} = 1$\n$l_{32}u_{22} = 1 \\implies l_{32}(1) = 1 \\implies l_{32} = 1$\n$u_{33} = 1$\n\n得到的因子是：\n$$\nL = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  1  1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n1  0  1 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n预处理器是 $M=LU$。我们来计算它：\n$$\nM = LU = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0  1 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix} =\n\\begin{pmatrix}\n1  0  1 \\\\\n0  1  0 \\\\\n0  1  1\n\\end{pmatrix}.\n$$\n我们观察到 $M=PA$。在这种情况下，置换矩阵 $PA$ 的 $\\mathrm{ILU}(0)$ 分解是精确的。\n\n任务3：分析预处理算子。\n\n我们有预处理器 $M = LU = PA$。预处理算子是 $T_{\\mathrm{left}} = M^{-1}A$ 和 $T_{\\mathrm{right}} = AM^{-1}$。\n\n对于右预处理算子 $T_{\\mathrm{right}}$：\n我们代入 $M=PA$：\n$T_{\\mathrm{right}} = A M^{-1} = A (PA)^{-1}$。\n使用性质 $(XY)^{-1} = Y^{-1}X^{-1}$，我们得到：\n$T_{\\mathrm{right}} = A (A^{-1}P^{-1}) = (AA^{-1})P^{-1} = I P^{-1} = P^{-1}$。\n置换矩阵 $P$ 是一个对合矩阵，意味着 $P^2=I$，所以 $P^{-1}=P$。\n因此，右预处理算子恰好是置换矩阵 $P$：\n$T_{\\mathrm{right}} = P^{-1} = P$。\n\n对于左预处理算子 $T_{\\mathrm{left}}$：\n我们代入 $M=PA$：\n$T_{\\mathrm{left}} = M^{-1}A = (PA)^{-1}A$。\n再次使用 $(XY)^{-1} = Y^{-1}X^{-1}$：\n$T_{\\mathrm{left}} = (A^{-1}P^{-1})A = A^{-1}P^{-1}A$。\n使用 $P^{-1}=P$，我们有：\n$T_{\\mathrm{left}} = A^{-1}PA$。\n这表明左预处理算子 $T_{\\mathrm{left}}$ 是置换矩阵 $P$ 的一个相似变换。\n用 $P$（和 $A$）表示的精确形式是 $T_{\\mathrm{right}} = P^{-1}$ 和 $T_{\\mathrm{left}} = A^{-1}P^{-1}A$。\n\n任务4：左预处理算子 $T_{\\mathrm{left}}$ 的行列式。\n\n我们使用推导出的形式 $T_{\\mathrm{left}} = A^{-1}P^{-1}A$。矩阵乘积的行列式是它们行列式的乘积：\n$$\n\\det(T_{\\mathrm{left}}) = \\det(A^{-1}P^{-1}A) = \\det(A^{-1}) \\det(P^{-1}) \\det(A).\n$$\n由于 $\\det(A^{-1}) = 1/\\det(A)$ 且 $\\det(P^{-1}) = 1/\\det(P)$，我们有：\n$$\n\\det(T_{\\mathrm{left}}) = \\frac{1}{\\det(A)} \\frac{1}{\\det(P)} \\det(A) = \\frac{1}{\\det(P)}.\n$$\n或者更简单地说，行列式在相似变换下是不变的：\n$$\n\\det(T_{\\mathrm{left}}) = \\det(A^{-1}(P^{-1})A) = \\det(P^{-1}).\n$$\n矩阵 $P$ 是通过交换单位矩阵 $I$ 的两行（第一行和第二行）得到的。单次行交换会使行列式变号。由于 $\\det(I)=1$， $P$ 的行列式是：\n$$\n\\det(P) = -1.\n$$\n因此，$\\det(P^{-1}) = 1/\\det(P) = 1/(-1) = -1$。\n所以，左预处理算子的行列式是：\n$$\n\\det(T_{\\mathrm{left}}) = -1.\n$$\n这个结果与矩阵 $A$ 无关，只要 $A$ 是可逆的，而它确实是可逆的（$\\det(A) = 0(..) - 1(1-0) + 0(..) = -1 \\neq 0$）。",
            "answer": "$$\n\\boxed{-1}\n$$"
        }
    ]
}