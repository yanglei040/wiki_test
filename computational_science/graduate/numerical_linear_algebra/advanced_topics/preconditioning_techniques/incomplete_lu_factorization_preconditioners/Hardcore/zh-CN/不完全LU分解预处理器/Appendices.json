{
    "hands_on_practices": [
        {
            "introduction": "不完全LU分解的核心在于对“填充”（fill-in）的控制，即在保持预处理效果的同时，尽可能地减少分解过程中产生的新非零元。为了精确地管理稀疏性与准确性之间的权衡，一种基于图论的“填充水平”（level-of-fill）概念应运而生。本练习将通过一个具体的计算任务，帮助你亲手实践并理解填充水平的定义和演化规则，从而揭示ILU(k)预处理技术背后的精妙机制。",
            "id": "3550532",
            "problem": "考虑一个稀疏矩阵在自然排序下不进行数值主元选取的不完全LU (ILU) 分解。一个对称稀疏模式的消去图以索引 $1,2,\\dots,n$ 为顶点，当结构模式中 $A_{ij}$ 或 $A_{ji}$ 可能非零时，就存在一条无向边 $\\{i,j\\}$（对角线元素在邻接关系中被忽略）。当高斯消去法消去主元 $p$ 时，尾随子矩阵中元素 $A_{ij}$ 的舒尔补更新遵循以下经过充分验证的代数恒等式\n$$\nA^{(p+1)}_{ij} \\;=\\; A^{(p)}_{ij} \\;-\\; \\frac{A^{(p)}_{ip}\\,A^{(p)}_{pj}}{A^{(p)}_{pp}},\n$$\n这意味着如果在 $p$ 的两个后续邻居 $i$ 和 $j$ 之间，$A^{(p)}_{ip}$ 和 $A^{(p)}_{pj}$ 结构上非零，则可能发生填充。在不完全LU (ILU) 分解预条件子中使用的填充水平框架中，每条结构上非零的边 $\\{i,j\\}$ 都带有一个整数“水平”，该水平量化了从原始模式开始，产生这条边需要多少次由消去引起的耦合。\n\n仅从上述定义和舒尔补更新出发，推导一个规则，该规则精确地描述了在消去 $p$ 时，新创建的填充边 $\\{i,j\\}$ 所附带的整数水平如何依赖于边 $\\{i,p\\}$ 和 $\\{p,j\\}$ 的水平，并解释为什么先前存在的边的水平不应因后续更新而增加。然后，将您的规则应用于以下小型对称邻接矩阵 $P$（表示 $n=5$ 时 $A$ 的结构模式），使用自然消去顺序 $1,2,3,4,5$：\n$$\nP \\;=\\; \\begin{pmatrix}\n0  1  0  0  1 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n1  0  0  1  0\n\\end{pmatrix}.\n$$\n假设 $P$ 中的每条原始边最初都被分配为水平 $0$，并且任何最初不存在的边都被视为空缺。在自然顺序下执行符号消去，并计算在处理完所有直到 $p=4$ 的消去后，分配给边 $\\{3,5\\}$ 的最终水平。将您的答案表示为单个整数；无需四舍五入。",
            "solution": "问题要求做两件事：首先，推导确定不完全LU (ILU) 分解中填充水平的规则；其次，将此规则应用于特定的矩阵模式，以找出特定填充边的水平。\n\n首先，我们推导填充水平的规则。矩阵图中边的水平是衡量其相对于原始稀疏模式的来源有多间接的度量。根据定义，原始矩阵中所有对应于非零项 $A_{ij}$ 的边 $\\{i,j\\}$ 都被分配为水平 $0$。\n\n在高斯消去的某个主元步骤 $p$ 中，对于索引 $i,j  p$，尾随子矩阵根据舒尔补公式进行更新：\n$$\nA^{(p+1)}_{ij} = A^{(p)}_{ij} - \\frac{A^{(p)}_{ip}\\,A^{(p)}_{pj}}{A^{(p)}_{pp}}\n$$\n如果在位置 $(i,j)$ 处 $A^{(p)}_{ij}$ 结构上为零，而更新项 $\\frac{A^{(p)}_{ip}\\,A^{(p)}_{pj}}{A^{(p)}_{pp}}$ 结构上非零，则会创建一个填充项。这种情况当且仅当 $A^{(p)}_{ip}$ 和 $A^{(p)}_{pj}$ 都结构上非零时发生。用消去图的语言来说，这意味着每当存在一条通过主元顶点 $p$ 的长度为二的路径 $i-p-j$ 时，就会创建一条新边 $\\{i,j\\}$（如果它尚不存在）。\n\n填充水平的定义是为了量化这种“消去引起的耦合”的数量。通过路径 $i-p-j$ 创建边 $\\{i,j\\}$ 就是这样一种耦合。该路径本身由边 $\\{i,p\\}$ 和 $\\{p,j\\}$ 组成，它们有各自的水平，分别表示为 $\\text{level}(i,p)$ 和 $\\text{level}(p,j)$。因此，创建新边 $\\{i,j\\}$ 的总“成本”或“长度”是构成该路径的边的成本之和，再加上新耦合本身的一个额外步骤。因此，由这条特定路径生成的水平是：\n$$\n\\text{level}_{\\text{path}}(i,j) = \\text{level}(i,p) + \\text{level}(p,j) + 1\n$$\n一条边 $\\{i,j\\}$ 可能通过不同主元的多条路径产生。边的水平由最“直接”的创建路径定义，即产生最小水平的路径。如果在消去主元 $p$ 之前，边 $\\{i,j\\}$ 不存在，其水平可视为无穷大。当考虑路径 $i-p-j$ 时，新边 $\\{i,j\\}$ 以如上计算的水平被创建。如果边 $\\{i,j\\}$ 已存在，其水平为 $\\text{level}_{\\text{old}}(i,j)$，可能会发现一条通过 $p$ 的新路径。那么，该边的水平将更新为现有水平与新路径产生的水平的最小值：\n$$\n\\text{level}_{\\text{new}}(i,j) = \\min(\\text{level}_{\\text{old}}(i,j), \\text{level}(i,p) + \\text{level}(p,j) + 1)\n$$\n这就解释了为什么先前存在的边的水平不应增加。水平代表了创建该边所需的最小耦合次数。后续发现的具有更高水平的创建路径是一条“更长”、更间接的路径，因此它不会重新定义该边存在的基本“成本”，该成本由迄今为止找到的“最短”路径决定。\n\n现在，我们将此规则应用于给定的大小为 $n=5$ 的矩阵的对称邻接矩阵 $P$。\n$$\nP = \\begin{pmatrix}\n0  1  0  0  1 \\\\\n1  0  1  0  0 \\\\\n0  1  0  1  0 \\\\\n0  0  1  0  1 \\\\\n1  0  0  1  0\n\\end{pmatrix}\n$$\n初始图 $G_0$ 有顶点 $\\{1,2,3,4,5\\}$ 和与 $P$ 中值为 $1$ 的项对应的边。所有初始边的 $\\text{level}=0$。\n初始边及其水平如下：\n$\\text{level}(1,2) = 0$\n$\\text{level}(1,5) = 0$\n$\\text{level}(2,3) = 0$\n$\\text{level}(3,4) = 0$\n$\\text{level}(4,5) = 0$\n所有其他非对角线元素的水平最初为 $\\infty$。消去按自然顺序 $p=1,2,3,4$ 进行。\n\n**步骤 1：消去主元 $p=1$。**\n主元 $p=1$ 的邻居是 $\\{2,5\\}$。我们考虑满足 $i,j  p$ 的邻居对 $(i,j)$。唯一的这样一对是 $(2,5)$。这对应于路径 $2-1-5$。\n边 $\\{2,5\\}$ 最初不存在。产生一个填充。\n新边 $\\{2,5\\}$ 的水平计算如下：\n$\\text{level}(2,5) = \\text{level}(2,1) + \\text{level}(1,5) + 1 = 0 + 0 + 1 = 1$。\n图结构被更新。我们现在有了一条边 $\\{2,5\\}$，其 $\\text{level}=1$。\n\n**步骤 2：消去主元 $p=2$。**\n在当前图中，主元 $p=2$ 的邻居是 $\\{1,3,5\\}$。我们考虑满足 $i,j  p=2$ 的邻居对 $(i,j)$。唯一的这样一对是 $(3,5)$。这对应于路径 $3-2-5$。\n在步骤 1 之后，图中不存在边 $\\{3,5\\}$。产生一个填充。\n新边 $\\{3,5\\}$ 的水平使用路径边 $\\{3,2\\}$ 和 $\\{2,5\\}$ 的水平进行计算：\n$\\text{level}(3,2) = 0$ (原始边)。\n$\\text{level}(2,5) = 1$ (来自步骤 1)。\n$\\text{level}(3,5) = \\text{level}(3,2) + \\text{level}(2,5) + 1 = 0 + 1 + 1 = 2$。\n图被更新，新边 $\\{3,5\\}$ 的 $\\text{level}=2$。\n\n**步骤 3：消去主元 $p=3$。**\n在当前图中，主元 $p=3$ 的邻居是 $\\{2,4,5\\}$。我们考虑满足 $i,j  p=3$ 的邻居对 $(i,j)$。唯一的这样一对是 $(4,5)$，对应于路径 $4-3-5$。\n边 $\\{4,5\\}$ 已经存在；它是一条原始边，其 $\\text{level}_{\\text{old}}(4,5)=0$。\n我们计算这条新路径将生成的水平：\n$\\text{level}_{\\text{path}}(4,5) = \\text{level}(4,3) + \\text{level}(3,5) + 1$。\n$\\text{level}(4,3)=0$ (原始边)。\n$\\text{level}(3,5)=2$ (来自步骤 2)。\n$\\text{level}_{\\text{path}}(4,5) = 0 + 2 + 1 = 3$。\n新的水平是旧水平和路径生成水平的最小值：\n$\\text{level}_{\\text{new}}(4,5) = \\min(\\text{level}_{\\text{old}}(4,5), \\text{level}_{\\text{path}}(4,5)) = \\min(0, 3) = 0$。\n边 $\\{4,5\\}$ 的水平保持为 $0$。水平结构没有发生变化。\n\n**步骤 4：消去主元 $p=4$。**\n在当前图中，主元 $p=4$ 的邻居是 $\\{3,5\\}$。我们需要寻找满足 $i,j  p=4$ 的邻居对 $(i,j)$。索引大于 4 的邻居只有 5。不存在索引大于 4 的 $p=4$ 的不同邻居对。因此，此步骤不产生填充。\n\n根据问题范围（直到 $p=4$）的消去过程已完成。边 $\\{3,5\\}$ 是在消去主元 $p=2$ 时创建的，水平为 $2$。后续步骤没有生成可以导致该边水平更低的路径。因此，分配给边 $\\{3,5\\}$ 的最终水平是 $2$。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "在掌握了如何控制稀疏性之后，下一个实际问题便是计算效率。本练习旨在量化每次迭代中应用不完全LU预处理器的计算开销。通过对一种常见的矩阵结构（五点差分格式）进行精确的浮点运算（flop）计数，我们可以深入理解预处理的效率，并将其与基本的矩阵向量乘法进行比较。",
            "id": "3550499",
            "problem": "考虑线性系统 $A x = b$。该系统由均匀 $m \\times m$ 网格上的负拉普拉斯算子经过标准 5 点有限差分格式离散化得到，采用狄利克雷边界条件和自然字典序，因此 $n = m^2$。矩阵 $A$ 以压缩稀疏行 (CSR) 格式存储。设 $M = L U$ 是矩阵 $A$ 在相同排序下计算的零填充不完全下上三角分解 (ILU($0$))，其中 $L$ 的对角线元素为 1，$U$ 的对角线元素非 1。将 $M^{-1}$ 应用于一个向量，包括一次使用 $L$ 的前向替换，然后一次使用 $U$ 的后向替换。\n\n采用以下基于稀疏线性代数标准惯例的运算计数模型：\n- 每次标量乘法、加法或减法计为 1 次浮点运算 (flop)。\n- 每次标量除法计为 1 次浮点运算 (flop)。\n- 对于 CSR 格式的稀疏矩阵向量乘积，每个存储的非零元计为 2 次浮点运算（一次乘法和一次加法）。\n- 对于 CSR 格式的单位对角线下三角矩阵的前向替换，每个严格下三角部分的非零元计为 2 次浮点运算（一次乘法和一次减法），不计除法。\n- 对于 CSR 格式的非单位对角线上三角矩阵的后向替换，每个严格上三角部分的非零元计为 2 次浮点运算，外加每行 1 次除法。\n\n仅利用 $m \\times m$ 网格上 5 点格式的结构特性和所述模型，从基本原理出发，推导应用 $M^{-1}$ 所需的精确浮点运算量，以及应用一次与 $A$ 的稀疏矩阵向量乘积所需的精确浮点运算量。然后，定义\n$$\nr(m) \\equiv \\frac{\\text{应用 } M^{-1} \\text{ 的浮点运算量}}{\\text{应用一次 } A\\text{-向量乘积的浮点运算量}}\n$$\n并计算 $r(m)$ 作为 $m$ 的函数的精确闭式表达式。以最简形式给出 $r(m)$ 作为您的最终答案。不需要数值近似或四舍五入。",
            "solution": "本题要求我们推导应用 ILU(0) 预条件子的浮点运算 (flop) 量与应用一次与矩阵 $A$ 的稀疏矩阵向量乘积的浮点运算量之比。矩阵 $A$ 源于在一个 $m \\times m$ 未知量网格上对负拉普拉斯算子进行 5 点离散化，得到一个 $n \\times n$ 矩阵，其中 $n=m^2$。\n\n首先，我们确定 $A$ 中非零元的数量，记为 $\\text{nnz}(A)$。5 点格式将每个网格点与其自身及其四个邻点（左、右、上、下）相连。矩阵 $A$ 是结构对称的。\n\n我们可以通过考虑连接来计算非零元的数量：\n1.  **对角元**：$n = m^2$ 个网格点中的每一个都对矩阵 $A$ 贡献一个对角元。这构成了 $m^2$ 个非零元。\n2.  **非对角元**：\n    *   **水平连接**：在网格的 $m$ 行中，每一行都有 $m-1$ 个相邻点之间的连接。这产生了 $m(m-1)$ 对连接。由于矩阵是结构对称的，每对连接对应两个非对角元（例如，$A_{k, k+1}$ 和 $A_{k+1, k}$）。这总计为 $2m(m-1)$ 个非零元。\n    *   **垂直连接**：在网格的 $m$ 列中，每一列都有 $m-1$ 个相邻点之间的连接。这产生了 $m(m-1)$ 对连接，对应于 $2m(m-1)$ 个非对角非零元（例如，$A_{k, k+m}$ 和 $A_{k+m, k}$）。\n\n$A$ 中的非零元总数是这些贡献的总和：\n$$\n\\text{nnz}(A) = (\\text{对角元}) + (\\text{非对角元})\n$$\n$$\n\\text{nnz}(A) = m^2 + 2m(m-1) + 2m(m-1) = m^2 + 4m(m-1) = m^2 + 4m^2 - 4m = 5m^2 - 4m\n$$\n\n现在，我们计算单次稀疏矩阵向量乘积 $Ax$ 的浮点运算量。根据给定的模型，每个存储的非零元需要 2 次浮点运算。\n$$\n\\text{flops}(A\\text{-向量乘积}) = 2 \\times \\text{nnz}(A) = 2(5m^2 - 4m) = 10m^2 - 8m\n$$\n\n接下来，我们分析预条件子 $M^{-1}$。将 $M^{-1}$ 应用于一个向量涉及通过 $L z = v$（前向替换）和 $U y = z$（后向替换）来求解 $M y = v$。该分解是 ILU($0$)，这意味着 $L$ 和 $U$ 的稀疏模式是 $A$ 的稀疏模式的子集。具体来说，对于 ILU($0$)，$L$ 和 $U$ 中非零元位置的并集恰好是 $A$ 中非零元位置的集合。\n矩阵 $L$ 是单位对角线的下三角矩阵，$U$ 是非单位对角线的上三角矩阵。\n$L$ 中严格下三角部分的非零元数量，记为 $\\text{nnz}_{}(L)$，等于 $A$ 中严格下三角部分的非零元数量。\n$U$ 中严格上三角部分的非零元数量，记为 $\\text{nnz}_{}(U)$，等于 $A$ 中严格上三角部分的非零元数量。\n由于 $A$ 是结构对称的，严格下三角部分的非零元数量等于严格上三角部分的非零元数量。非对角元的总数为 $\\text{nnz}(A) - n = (5m^2 - 4m) - m^2 = 4m^2 - 4m$。\n因此，\n$$\n\\text{nnz}_{}(L) = \\text{nnz}_{}(U) = \\frac{\\text{nnz}(A) - n}{2} = \\frac{4m^2 - 4m}{2} = 2m^2 - 2m\n$$\n\n现在我们计算应用 $M^{-1}$ 的浮点运算量。\n1.  **使用 $L$ 进行前向替换**：成本是每个严格下三角部分的非零元 2 次浮点运算。$L$ 的对角线元素为 1，因此不需要除法。\n    $$\n    \\text{flops}(L^{-1}) = 2 \\times \\text{nnz}_{}(L) = 2(2m^2 - 2m) = 4m^2 - 4m\n    $$\n2.  **使用 $U$ 进行后向替换**：成本是每个严格上三角部分的非零元 2 次浮点运算，外加 $n$ 行中每行 1 次除法（以处理非单位对角线）。\n    $$\n    \\text{flops}(U^{-1}) = (2 \\times \\text{nnz}_{}(U)) + n = (2(2m^2 - 2m)) + m^2 = 4m^2 - 4m + m^2 = 5m^2 - 4m\n    $$\n\n应用 $M^{-1}$ 的总浮点运算量是这两部分成本的总和：\n$$\n\\text{flops}(M^{-1}) = \\text{flops}(L^{-1}) + \\text{flops}(U^{-1}) = (4m^2 - 4m) + (5m^2 - 4m) = 9m^2 - 8m\n$$\n\n最后，我们计算比率 $r(m)$：\n$$\nr(m) = \\frac{\\text{应用 } M^{-1} \\text{ 的浮点运算量}}{\\text{应用一次 } A\\text{-向量乘积的浮点运算量}} = \\frac{9m^2 - 8m}{10m^2 - 8m}\n$$\n对于 $m \\ge 1$，我们可以通过从分子和分母中提取因子 $m$ 来简化此表达式：\n$$\nr(m) = \\frac{m(9m - 8)}{m(10m - 8)} = \\frac{9m - 8}{10m - 8}\n$$\n此表达式无法进一步简化。",
            "answer": "$$\n\\boxed{\\frac{9m - 8}{10m - 8}}\n$$"
        },
        {
            "introduction": "对于某些特定类型的矩阵，尤其是那些源于守恒律的矩阵，标准的不完全LU分解方法可能会遇到困难。修正不完全LU分解（MILU）是一种重要的变体，它通过保持关键的矩阵性质来增强算法的稳健性。本练习将引导你推导MILU的核心原理，即如何通过将分解过程中丢弃的项补偿到对角线上，来维持矩阵行和为零的性质。",
            "id": "3550477",
            "problem": "考虑一个稀疏矩阵 $A \\in \\mathbb{R}^{n \\times n}$，它来自于一个连通域上二阶椭圆算子的保守离散化，因此所有分量 $e_i=1$ 的常向量 $e \\in \\mathbb{R}^{n}$ 满足 $A e = 0$。我们执行一种零填充的不完全 $\\mathrm{LU}$ 分解，记为 $\\mathrm{ILU}(0)$，并遵循以下约定：不使用主元选择，下三角因子 $L$ 的对角线元素为1，对角线存储在上三角因子 $U$ 中，并且每行 $i$ 保留的稀疏模式等于 $A$ 在该行的原始非零模式与对角线元素的并集。\n\n在 $\\mathrm{ILU}(0)$ 的第 $i$ 行消元步骤中，舍弃前位置 $(i,j)$ 处更新后的元素为\n$$\na^{(i)}_{ij} \\;=\\; a_{ij} \\;-\\; \\sum_{k=1}^{i-1} \\ell_{ik}\\, u_{kj},\n$$\n其中 $\\ell_{ik}$ 是已计算出的乘子，$u_{kj}$ 是先前计算出的上三角元素。如果列索引 $j$ 不在第 $i$ 行的保留稀疏集 $S_{i}$ 中，则值 $a^{(i)}_{ij}$ 被舍弃。令 $R \\in \\mathbb{R}^{n \\times n}$ 表示在其原始位置收集所有这些被舍弃值的矩阵，因此 $\\mathrm{ILU}(0)$ 预条件子 $M = L U$ 满足 $M = A - R$。\n\n修正的不完全 $\\mathrm{LU}$ (MILU) 的定义是通过将舍弃的填充贡献重新定向到对角线上，以维持一种保守性质。具体来说，确定第 $i$ 行的对角线更新，即在对角线元素 $u_{ii}$ 上加上 $\\delta_{i}$，使得得到的 MILU 预条件子 $M^{\\mathrm{MILU}} = L (U + \\Delta)$（其中 $\\Delta = \\mathrm{diag}(\\delta_{1},\\dots,\\delta_{n})$）保持对常向量的保守作用，即 $M^{\\mathrm{MILU}} e = A e$。\n\n仅从上述定义和性质出发——即 $\\mathrm{LU}$ 更新恒等式、$\\mathrm{ILU}(0)$ 舍弃规则和保守性要求——推导在泛型行 $i$ 处所需对角线更新 $\\delta_i$ 的显式闭式表达式，该表达式用计算出的 $\\ell_{ik}$ 和 $u_{kj}$ 以及保留的稀疏集 $S_i$ 表示。最终答案必须是 $\\delta_i$ 的单个符号表达式，不得有任何近似。",
            "solution": "本题要求推导对角线修正项 $\\delta_i$ 的表达式，以确保修正不完全LU (MILU) 预条件子 $M^{\\mathrm{MILU}}$ 保持行和守恒的性质，即 $M^{\\mathrm{MILU}}e = Ae$。\n\n首先，根据题目给出的保守离散化性质，我们有 $Ae = 0$。因此，对 MILU 预条件子的要求简化为：\n$$ M^{\\mathrm{MILU}}e = 0 $$\n这个向量方程等价于说矩阵 $M^{\\mathrm{MILU}}$ 的每一行行和都为零。\n\n接下来，我们分析标准 ILU(0) 分解与 MILU 的关系。标准的 ILU(0) 预条件子 $M=LU$ 是 $A$ 的一个近似，其关系可以写为 $M = A - R$，其中 $R$ 是残差矩阵，包含了在分解过程中所有被舍弃的项。\n\nMILU 预条件子是在标准 ILU(0) 的基础上对对角线进行修正得到的，即 $M^{\\mathrm{MILU}} = M + \\Delta = LU + \\Delta$，其中 $\\Delta = \\mathrm{diag}(\\delta_1, \\dots, \\delta_n)$。\n\n我们将行和为零的条件应用到 $M^{\\mathrm{MILU}}$ 的第 $i$ 行：\n$$ \\sum_{j=1}^{n} (M^{\\mathrm{MILU}})_{ij} = 0 $$\n代入 $M^{\\mathrm{MILU}} = A - R + \\Delta$：\n$$ \\sum_{j=1}^{n} (A_{ij} - R_{ij} + \\Delta_{ij}) = 0 $$\n$$ \\sum_{j=1}^{n} A_{ij} - \\sum_{j=1}^{n} R_{ij} + \\sum_{j=1}^{n} \\Delta_{ij} = 0 $$\n我们已知第一项（$A$ 的行和）为零。第三项（$\\Delta$ 的行和）等于对角修正项 $\\delta_i$。因此，方程简化为：\n$$ -\\sum_{j=1}^{n} R_{ij} + \\delta_i = 0 $$\n由此我们得到 $\\delta_i$ 的一个关键表达式：\n$$ \\delta_i = \\sum_{j=1}^{n} R_{ij} $$\n这表明，对角线修正项 $\\delta_i$ 恰好等于第 $i$ 行所有被舍弃项的总和。\n\n现在，我们只需要明确写出被舍弃项 $R_{ij}$ 的表达式。根据 ILU(0) 的分解过程，在计算第 $i$ 行时，会生成中间元素 $a^{(i)}_{ij} = a_{ij} - \\sum_{k=1}^{i-1} \\ell_{ik} u_{kj}$。根据舍弃规则，如果位置 $(i,j)$ 不在预设的稀疏模式 $S_i$ 中，这个值就会被舍弃。这个被舍弃的值正是残差矩阵的对应元素，即 $R_{ij} = a^{(i)}_{ij}$ 当 $j \\notin S_i$ 时，否则 $R_{ij} = 0$。\n\n因此，将 $R_{ij}$ 的表达式代入，我们得到 $\\delta_i$ 的最终显式表达式：\n$$ \\delta_i = \\sum_{j \\notin S_i} a^{(i)}_{ij} = \\sum_{j \\notin S_i} \\left( a_{ij} - \\sum_{k=1}^{i-1} \\ell_{ik} u_{kj} \\right) $$\n这个公式精确地描述了如何通过将所有在第 $i$ 行分解中被舍弃的填充贡献累加到该行的对角线上，来强制保持行和守恒的性质。",
            "answer": "$$ \\boxed{\\delta_i = \\sum_{j \\notin S_i} \\left( a_{ij} - \\sum_{k=1}^{i-1} \\ell_{ik} u_{kj} \\right)} $$"
        }
    ]
}