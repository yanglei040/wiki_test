{
    "hands_on_practices": [
        {
            "introduction": "掌握CP分解的第一步是理解张量秩的基本定义。这个练习将通过一个具体的例子，引导你从第一性原理出发，构建一个张量的CP表示，并通过严谨的数学证明来确定其最小秩。通过这个过程，你将深化对秩-1张量和张量秩这些核心概念的理解 。",
            "id": "3586498",
            "problem": "考虑一个大小为 $2 \\times 2 \\times 2$ 的实数域上的三阶张量，记为 $\\mathcal{X} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$，并令 $e_1, e_2 \\in \\mathbb{R}^2$ 表示标准基向量。假设 $\\mathcal{X}$ 定义为\n$$\n\\mathcal{X} \\;=\\; e_1 \\otimes e_1 \\otimes e_1 \\;+\\; e_2 \\otimes e_2 \\otimes e_2,\n$$\n其中 $\\otimes$ 表示外积。从秩1张量和典范分解/平行因子分解 (CANonical DECOMPosition/PARAFAC, CP) 的基本定义出发，通过指定一个数 $R \\in \\mathbb{N}$、标量 $\\lambda_1,\\dots,\\lambda_R \\in \\mathbb{R}$ 以及因子向量 $a_r, b_r, c_r \\in \\mathbb{R}^2$（其中 $r = 1,\\dots,R$），构造 $\\mathcal{X}$ 的一个显式 CP 表示，使得\n$$\n\\mathcal{X} \\;=\\; \\sum_{r=1}^{R} \\lambda_r \\, a_r \\otimes b_r \\otimes c_r.\n$$\n仅使用秩1张量和张量秩的核心定义，通过证明您表示中 $R$ 的最小性来确定 $\\mathcal{X}$ 的 CP 秩（也称为张量秩）。将 CP 秩作为最终答案。不需要四舍五入，也不涉及单位。",
            "solution": "问题要求对一个给定的三阶张量 $\\mathcal{X} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$ 给出其典范分解/平行因子分解 (CP) 的显式表示，并通过证明该表示的最小性来确定其 CP 秩。\n\n首先，我们陈述基本定义。\n一个三阶张量 $\\mathcal{T} \\in \\mathbb{R}^{I \\times J \\times K}$ 如果可以写成三个向量 $a \\in \\mathbb{R}^I$、$b \\in \\mathbb{R}^J$ 和 $c \\in \\mathbb{R}^K$ 的外积，则称其为秩1张量。即 $\\mathcal{T} = a \\otimes b \\otimes c$，其元素为 $\\mathcal{T}_{ijk} = a_i b_j c_k$。\n\n张量 $\\mathcal{X}$ 的 CP 分解将其表示为秩1张量的和。问题陈述中给出的形式为：\n$$\n\\mathcal{X} = \\sum_{r=1}^{R} \\lambda_r \\, a_r \\otimes b_r \\otimes c_r\n$$\n其中 $R \\in \\mathbb{N}$ 是秩1分量的数量，$\\lambda_r \\in \\mathbb{R}$ 是标量，$a_r, b_r, c_r$ 是相应维度的向量。\n\n张量 $\\mathcal{X}$ 的 CP 秩，或简称为秩，记作 $\\text{rank}(\\mathcal{X})$，是存在这种分解的最小整数 $R$。\n\n所讨论的张量是 $\\mathcal{X} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$，定义为：\n$$\n\\mathcal{X} = e_1 \\otimes e_1 \\otimes e_1 + e_2 \\otimes e_2 \\otimes e_2\n$$\n其中 $e_1, e_2 \\in \\mathbb{R}^2$ 是标准基向量，$e_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 且 $e_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n我们首先为 $\\mathcal{X}$ 构造一个 CP 表示。$\\mathcal{X}$ 的给定定义已经是两个张量的和。我们来检查每一项：\n第一项是 $\\mathcal{T}_1 = e_1 \\otimes e_1 \\otimes e_1$。根据定义，这是一个秩1张量。\n第二项是 $\\mathcal{T}_2 = e_2 \\otimes e_2 \\otimes e_2$。根据定义，这也是一个秩1张量。\n\n因此，$\\mathcal{X}$ 的表达式是两个秩1张量的和。这自然地提供了一个 CP 表示。我们可以通过设置以下参数，将其与通用形式 $\\sum_{r=1}^{R} \\lambda_r \\, a_r \\otimes b_r \\otimes c_r$ 匹配：\n- $R = 2$\n- 对于 $r=1$：$\\lambda_1 = 1$，$a_1 = e_1$，$b_1 = e_1$，$c_1 = e_1$\n- 对于 $r=2$：$\\lambda_2 = 1$，$a_2 = e_2$，$b_2 = e_2$，$c_2 = e_2$\n\n这就得到了分解 $\\mathcal{X} = 1 \\cdot (e_1 \\otimes e_1 \\otimes e_1) + 1 \\cdot (e_2 \\otimes e_2 \\otimes e_2)$，这正是 $\\mathcal{X}$ 的定义。由于我们找到了一个包含 $R=2$ 个分量的表示，我们已经确定了秩的一个上界：$\\text{rank}(\\mathcal{X}) \\leq 2$。\n\n接下来，为了确定确切的 CP 秩，我们必须证明这个表示是最小的。也就是说，我们必须证明 $\\mathcal{X}$ 不能用更少数量的秩1分量来表示。唯一更小的非平凡分量数是 $1$。我们将用反证法证明 $\\text{rank}(\\mathcal{X}) \\neq 1$。\n\n为了进行反证，假设 $\\text{rank}(\\mathcal{X}) = 1$。如果这是真的，$\\mathcal{X}$ 就可以写成一个单一的秩1张量。使用题目要求的形式，这意味着存在一个标量 $\\lambda \\in \\mathbb{R}$ 和向量 $a, b, c \\in \\mathbb{R}^2$ 使得 $\\mathcal{X} = \\lambda \\, a \\otimes b \\otimes c$。我们可以不失一般性地将标量 $\\lambda$ 吸收到其中一个向量中（例如，令 $a' = \\lambda a$）。所以，这个假设等价于对于某些 $a, b, c \\in \\mathbb{R}^2$，有 $\\mathcal{X} = a \\otimes b \\otimes c$。\n\n我们来写出 $\\mathcal{X}$ 的分量。令 $\\mathcal{X}$ 的元素表示为 $\\mathcal{X}_{ijk}$，其中 $i,j,k \\in \\{1, 2\\}$。\n第一项 $e_1 \\otimes e_1 \\otimes e_1$ 的分量仅在 $(e_1 \\otimes e_1 \\otimes e_1)_{111} = (e_1)_1 (e_1)_1 (e_1)_1 = 1 \\cdot 1 \\cdot 1 = 1$ 时非零。\n第二项 $e_2 \\otimes e_2 \\otimes e_2$ 的分量仅在 $(e_2 \\otimes e_2 \\otimes e_2)_{222} = (e_2)_2 (e_2)_2 (e_2)_2 = 1 \\cdot 1 \\cdot 1 = 1$ 时非零。\n因此，张量 $\\mathcal{X}$ 恰好有两个非零元素：\n$$\n\\mathcal{X}_{111} = 1 \\quad \\text{和} \\quad \\mathcal{X}_{222} = 1\n$$\n所有其他元素 $\\mathcal{X}_{ijk}$ 均为 $0$。\n\n现在，让我们将这些分量与我们的秩1假设等同起来。令 $a = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix}$，$b = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$ 和 $c = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$。假设的秩1张量的元素是 $\\mathcal{X}_{ijk} = a_i b_j c_k$。\n从非零元素，我们有：\n1. $\\mathcal{X}_{111} = a_1 b_1 c_1 = 1$。这意味着 $a_1 \\neq 0$，$b_1 \\neq 0$ 且 $c_1 \\neq 0$。\n2. $\\mathcal{X}_{222} = a_2 b_2 c_2 = 1$。这意味着 $a_2 \\neq 0$，$b_2 \\neq 0$ 且 $c_2 \\neq 0$。\n\n现在，我们考虑一个零元素，例如 $\\mathcal{X}_{112} = 0$。\n根据我们的秩1假设，$\\mathcal{X}_{112} = a_1 b_1 c_2$。\n所以，我们必须有 $a_1 b_1 c_2 = 0$。\n根据上面的推论（1），我们知道 $a_1 \\neq 0$ 和 $b_1 \\neq 0$。要使乘积 $a_1 b_1 c_2$ 为零，必须有 $c_2 = 0$。\n\n然而，上面的推论（2）指出 $c_2 \\neq 0$。这是一个直接的矛盾。陈述 $c_2 = 0$ 和 $c_2 \\neq 0$ 不能同时为真。\n因此，最初的假设 $\\text{rank}(\\mathcal{X}) = 1$ 必定是错误的。\n\n我们已经确定了两个事实：\n- $\\text{rank}(\\mathcal{X}) \\leq 2$（来自显式构造）\n- $\\text{rank}(\\mathcal{X}) > 1$（来自反证法）\n\n由于秩必须是一个整数，$\\mathcal{X}$ 的秩唯一可能的值是 $2$。\n\n$\\mathcal{X}$ 的 CP 秩是使得 $\\mathcal{X} = \\sum_{r=1}^{R} \\lambda_r \\, a_r \\otimes b_r \\otimes c_r$ 的最小 $R$。我们已经证明了 $R=2$ 是一个可能的值，而 $R=1$ 不是。因此，$R$ 的最小可能值为 $2$。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "找到一个张量的CP分解后，一个自然而然的问题是：这个分解是唯一的吗？本练习探讨了CP分解的非唯一性，展示了一个不满足著名的Kruskal唯一性条件的案例，并为同一个张量构造了一族无穷多的替代分解。这个实践凸显了在实际应用中理解唯一性条件的重要性 。",
            "id": "3586512",
            "problem": "设 $\\mathcal{T} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$ 是一个三阶张量，其典范分解/平行因子 (CANDECOMP/PARAFAC (CP)) 秩为 $R = 2$，由以下因子矩阵指定：\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}.\n$$\nCP 模型为 $\\mathcal{T} = \\sum_{r=1}^{2} a_r \\otimes b_r \\otimes c_r$，其中 $a_r$、$b_r$ 和 $c_r$ 分别表示 $A$、$B$ 和 $C$ 的第 $r$ 列，$\\otimes$ 表示外积。矩阵 $X$ 的 $k$-秩（也称为 Kruskal 秩）是最大整数 $k_X$，使得 $X$ 的任意 $k_X$ 列组成的子集都是线性无关的。\n\n任务：\n- 仅使用 CP 分解、$k$-秩的定义，以及对于列维度匹配的矩阵 $U$ 和 $V$ 有 $U V^{\\top} = \\sum_{r}$ column$_r(U)$ column$_r(V)^{\\top}$ 这一事实，从基本原理出发，论证 Kruskal 唯一性充分条件对此特定 $\\mathcal{T}$ 是否成立。\n- 然后，推导一个 $\\mathcal{T}$ 的单参数备选 CP 分解族，其形式为 $(A',B',C')$，定义如下：\n$$\nA' = A R(t), \\quad B' = B \\big(R(t)^{-T}\\big), \\quad C' = C,\n$$\n其中 $R(t) \\in \\mathbb{R}^{2 \\times 2}$ 是上三角矩阵\n$$\nR(t) = \\begin{pmatrix} 1  t \\\\ 0  1 \\end{pmatrix},\n$$\n$t \\in \\mathbb{R}$ 是一个标量参数。根据 CP 定义，证明为什么对于所有使 $R(t)$ 可逆的 $t$，$\\mathcal{T} = \\sum_{r=1}^{2} a'_r \\otimes b'_r \\otimes c'_r$ 仍然成立。\n- 施加归一化约束，即 $B' = B \\big(R(t)^{-T}\\big)$ 的第一列的第一个元素等于 $0$，并确定满足此约束的 $t$ 的精确值。\n\n你的最终答案应该是 $t$ 的精确值（无单位）。不要在最终答案中提供中间步骤。",
            "solution": "问题陈述已经过验证，被认为是自洽的、有科学依据且适定的。它是在典范分解/平行因子 (CANDECOMP/PARAFAC (CP)) 张量分解研究中的一个标准练习。\n\n该问题分为三个部分。首先，我们使用 Kruskal 充分条件评估给定 CP 分解的唯一性。其次，我们证明存在一族备选分解。第三，我们找到满足给定归一化约束的特定参数值。\n\n第一部分：Kruskal 唯一性充分条件\n\nKruskal 定理为由因子矩阵 $A$、$B$ 和 $C$ 定义的秩为 $R$ 的 CP 分解的本质唯一性提供了一个充分条件。该条件由以下不等式给出：\n$$k_A + k_B + k_C \\ge 2R + 2$$\n其中 $k_X$ 是矩阵 $X$ 的 $k$-秩（或 Kruskal 秩）。$k$-秩是使得 $X$ 的任意 $k$ 列组成的集合都线性无关的最大整数 $k$。张量的秩给定为 $R=2$。我们必须计算给定因子矩阵 $A, B, C$ 的 $k$-秩。\n\n因子矩阵为：\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}.\n$$\n\n- 对于矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$：其列为 $a_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $a_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。任意单列非零，因此构成一个线性无关集。两列组成的集合是线性无关的，因为 $\\det(A) = 1(1) - 0(0) = 1 \\ne 0$。因此，可以选择构成线性无关集的最大列数为 $2$。$k$-秩为 $k_A = 2$。\n\n- 对于矩阵 $B \\in \\mathbb{R}^{2 \\times 2}$：其列为 $b_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $b_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。任意单列非零。两列组成的集合是线性无关的，因为 $\\det(B) = 1(-1) - 1(1) = -2 \\ne 0$。因此，$k$-秩为 $k_B = 2$。\n\n- 对于矩阵 $C \\in \\mathbb{R}^{2 \\times 2}$：其列为 $c_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $c_2 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。任意单列非零，因此大小为 $1$ 的任意子集都是线性无关的。然而，由于 $c_1 = c_2$，这两列组成的集合是线性相关的。因此，可以选择构成线性无关集的最大列数为 $1$。$k$-秩为 $k_C = 1$。\n\n现在我们用 $R=2$, $k_A=2$, $k_B=2$, 和 $k_C=1$ 来检验 Kruskal 条件：\n$$k_A + k_B + k_C \\ge 2R + 2$$\n$$2 + 2 + 1 \\ge 2(2) + 2$$\n$$5 \\ge 6$$\n此不等式不成立。因此，对于此分解，Kruskal 唯一性充分条件不满足。这意味着该分解不保证是唯一的，可能存在其他备选分解。\n\n第二部分：备选分解的证明\n\n我们需要证明张量 $\\mathcal{T}$ 也可以由一组新的因子矩阵 $(A', B', C')$ 表示，定义如下：\n$$\nA' = A R(t), \\quad B' = B \\big(R(t)^{-T}\\big), \\quad C' = C\n$$\n其中 $R(t) = \\begin{pmatrix} 1  t \\\\ 0  1 \\end{pmatrix}$。\nCP 分解按元素定义为 $\\mathcal{T}_{ijk} = \\sum_{r=1}^{R} A_{ir} B_{jr} C_{kr}$。设 $\\mathcal{T'}$ 是由新因子生成的张量。其元素由下式给出：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{r=1}^{R} A'_{ir} B'_{jr} C'_{kr}\n$$\n新因子矩阵的列是旧因子矩阵列的线性组合。让我们将 $A'$、$B'$ 和 $C'$ 的定义代入 $\\mathcal{T}'_{ijk}$ 的公式中。令 $R$ 表示 $R(t)$。\n$$A'_{ir} = (AR)_{ir} = \\sum_{s=1}^{R} A_{is} R_{sr}$$\n$$B'_{jr} = (BR^{-T})_{jr} = \\sum_{p=1}^{R} B_{jp} (R^{-T})_{pr} = \\sum_{p=1}^{R} B_{jp} (R^{-1})_{rp}$$\n$$C'_{kr} = C_{kr} \\quad (\\text{因为 } C' = C)$$\n将这些代入 $\\mathcal{T}'_{ijk}$ 的表达式中：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{r=1}^{R} \\left(\\sum_{s=1}^{R} A_{is} R_{sr}\\right) \\left(\\sum_{p=1}^{R} B_{jp} (R^{-1})_{rp}\\right) C_{kr}\n$$\n我们可以重新排列求和顺序：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{s=1}^{R} \\sum_{p=1}^{R} A_{is} B_{jp} \\left( \\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp} C_{kr} \\right)\n$$\n让我们分析括号中的项。由于矩阵 $C$ 的一个特殊性质，这个恒等式成立。$C$ 的行是 $(1,1)$ 和 $(1,1)$。这意味着对于一个固定的行索引 $k$，$C_{kr}$ 的值对于所有列索引 $r$ 都是恒定的。我们用 $c_k^*$ 表示这个常数值。在这个问题中，$C_{11}=C_{12}=1$ 所以 $c_1^*=1$，并且 $C_{21}=C_{22}=1$ 所以 $c_2^*=1$。\n我们可以将 $C_{kr} = c_k^*$ 从关于 $r$ 的最内层求和中提出来：\n$$\n\\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp} C_{kr} = c_k^* \\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp}\n$$\n求和 $\\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp}$ 是矩阵乘积 $RR^{-1}$ 的第 $(s,p)$ 个元素，而 $RR^{-1}$ 是单位矩阵 $I$。因此，$\\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp} = \\delta_{sp}$，其中 $\\delta_{sp}$ 是克罗内克 δ。\n括号中的表达式简化为 $c_k^* \\delta_{sp}$。将其代回：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{s=1}^{R} \\sum_{p=1}^{R} A_{is} B_{jp} (c_k^* \\delta_{sp})\n$$\n克罗内克 δ $\\delta_{sp}$ 在 $s \\neq p$ 时为零，因此关于 $p$ 的求和会消去：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{s=1}^{R} A_{is} B_{js} c_k^*\n$$\n由于 $c_k^*$ 是 $C$ 的第 $k$ 行的常数值，我们有 $c_k^* = C_{ks}$ 对任意 $s$ 成立。所以，我们可以写成：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{s=1}^{R} A_{is} B_{js} C_{ks} = \\mathcal{T}_{ijk}\n$$\n这对所有的 $i,j,k$ 都成立，证明了 $\\mathcal{T}' = \\mathcal{T}$。这对任何使 $R(t)$ 可逆的 $t$ 都有效。由于对所有 $t \\in \\mathbb{R}$ 都有 $\\det(R(t)) = 1 \\ne 0$，这族备选分解总是有效的。\n\n第三部分：参数 t 的确定\n\n我们需要找到满足归一化约束（即 $B'$ 的第一列的第一个元素等于 $0$）的 $t$ 的值。首先，我们计算矩阵 $B' = B(R(t)^{-T})$。\n\n矩阵 $R(t)$ 及其逆矩阵为：\n$$\nR(t) = \\begin{pmatrix} 1  t \\\\ 0  1 \\end{pmatrix}, \\quad R(t)^{-1} = \\begin{pmatrix} 1  -t \\\\ 0  1 \\end{pmatrix}\n$$\n所需的矩阵 $R(t)^{-T}$ 是逆矩阵的转置：\n$$\nR(t)^{-T} = (R(t)^{-1})^T = \\begin{pmatrix} 1  0 \\\\ -t  1 \\end{pmatrix}\n$$\n现在，我们通过将 $B$ 右乘 $R(t)^{-T}$ 来计算 $B'$：\n$$\nB' = B R(t)^{-T} = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ -t  1 \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\nB' = \\begin{pmatrix} 1(1) + 1(-t)  1(0) + 1(1) \\\\ 1(1) + (-1)(-t)  1(0) + (-1)(1) \\end{pmatrix} = \\begin{pmatrix} 1-t  1 \\\\ 1+t  -1 \\end{pmatrix}\n$$\n$B'$ 的第一列是 $\\begin{pmatrix} 1-t \\\\ 1+t \\end{pmatrix}$。该列的第一个元素是 $1-t$。归一化约束要求此元素为 $0$：\n$$\n1-t = 0\n$$\n解出 $t$，我们得到：\n$$\nt = 1\n$$\n因此，满足归一化约束的参数特定值为 $t=1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "张量的秩概念比矩阵的秩要微妙得多，其中一个关键区别在于闭包性质。本练习深入探讨了CP秩与边界秩（border rank）之间的区别，这是一个核心的高级主题。你将构造一个秩-2张量序列，其极限是一个秩-3张量，从而揭示低秩张量集不是闭集，以及最佳低秩逼近问题可能无解的现象 。",
            "id": "3586501",
            "problem": "设 $X \\in \\mathbb{R}^{I \\times J \\times K}$ 是一个三阶张量。$X$ 的一个秩为 $R$ 的典范分解/平行因子 (CANonical DECOMPosition/PARAllel FACtors, CP) 分解是形如 $X = \\sum_{r=1}^{R} \\lambda_{r} \\, a_{r} \\otimes b_{r} \\otimes c_{r}$ 的表示，其中 $a_{r} \\in \\mathbb{R}^{I}$，$b_{r} \\in \\mathbb{R}^{J}$，$c_{r} \\in \\mathbb{R}^{K}$ 且 $\\lambda_{r} \\in \\mathbb{R}$。$X$ 的 CP 秩是存在这种表示的最小 $R$。$X$ 的边界秩是最小的 $R$，使得 $X$ 是一系列 CP 秩至多为 $R$ 的张量的极限（在弗罗贝尼乌斯范数下）。弗罗贝尼乌斯范数 $\\|X\\|_{F}$ 是 $X$ 所有元素平方和的平方根。\n\n在 $\\mathbb{R}$ 上进行研究，并考虑标准基向量 $e_{1}, e_{2} \\in \\mathbb{R}^{2}$。通过其非零元素 $X_{2,1,1} = 1$、$X_{1,2,1} = 1$ 和 $X_{1,1,2} = 1$ 隐式定义目标张量 $X_{0} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$，即 $X_{0} = e_{2} \\otimes e_{1} \\otimes e_{1} + e_{1} \\otimes e_{2} \\otimes e_{1} + e_{1} \\otimes e_{1} \\otimes e_{2}$。\n\n仅使用上述基本定义和外积的基本性质，完成以下任务：\n\n- 显式构造一个单参数族 $\\{X_{\\epsilon}\\}_{\\epsilon > 0} \\subset \\mathbb{R}^{2 \\times 2 \\times 2}$，对于每个 $\\epsilon > 0$，其 CP 秩至多为 $2$，使得当 $\\epsilon \\to 0$ 时，每个 $X_{\\epsilon}$ 的 CP 表示中的因子在范数上必然发散，但 $X_{\\epsilon}$ 在弗罗贝尼乌斯范数下收敛于 $X_{0}$。您的构造必须通过归一化的选择明确指出发散发生在哪里（例如，在标量权重中或在因子向量中），并且您必须验证收敛性 $X_{\\epsilon} \\to X_{0}$。\n- 证明 $X_{0}$ 的 CP 秩严格大于 $2$，因此 $X_{0}$ 在弗罗贝尼乌斯范数下的最佳秩-2 近似问题无解，尽管下确界误差为 $0$。\n\n最后，计算弗罗贝尼乌斯范数 $\\|X_{0}\\|_{F}$。以单个精确表达式的形式提供您的最终答案。无需四舍五入。",
            "solution": "首先验证问题以确保其是适定的、有科学依据的，并包含所有必要信息。\n\n给定的信息是：\n- 一个三阶张量 $X \\in \\mathbb{R}^{I \\times J \\times K}$。\n- 一个秩为 $R$ 的 CP 分解是 $X = \\sum_{r=1}^{R} \\lambda_{r} \\, a_{r} \\otimes b_{r} \\otimes c_{r}$，其中 $a_{r} \\in \\mathbb{R}^{I}$，$b_{r} \\in \\mathbb{R}^{J}$，$c_{r} \\in \\mathbb{R}^{K}$ 且 $\\lambda_{r} \\in \\mathbb{R}$。\n- CP 秩是存在这种分解的最小 $R$。\n- 边界秩是最小的 $R$，使得 $X$ 是一系列 CP 秩至多为 $R$ 的张量的极限。\n- 范数是弗罗贝尼乌斯范数 $\\|X\\|_{F} = \\sqrt{\\sum_{i,j,k} X_{i,j,k}^2}$。\n- 背景设定在 $\\mathbb{R}$ 上，基向量为 $e_{1}, e_{2} \\in \\mathbb{R}^{2}$。\n- 目标张量是 $X_{0} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$，其非零元素为 $X_{2,1,1} = 1$，$X_{1,2,1} = 1$ 和 $X_{1,1,2} = 1$。这可以写成 $X_{0} = e_{2} \\otimes e_{1} \\otimes e_{1} + e_{1} \\otimes e_{2} \\otimes e_{1} + e_{1} \\otimes e_{1} \\otimes e_{2}$。\n\n该问题在科学上是合理的，因为它涉及多线性代数中的标准基本概念，特别是 CP 秩和边界秩之间的区别，这是张量分解的一个已知且重要的特征。任务在数学上是精确的，并且提供了所有需要的定义和数据。该问题是该领域中使用的经典示例。因此，该问题被认为是有效的。\n\n我们继续进行解答，根据要求分为三个部分。\n\n首先，我们构造一个 CP 秩至多为 $2$ 且收敛于 $X_{0}$ 的单参数张量族 $\\{X_{\\epsilon}\\}_{\\epsilon > 0}$。\n让我们将族 $\\{X_{\\epsilon}\\}$（对于 $\\epsilon > 0$）定义为两个秩-1 张量的和。一个合适的构造受到导数的有限差分近似的启发。考虑两个秩-1 张量 $T_1(\\epsilon) = (e_1 + \\epsilon e_2) \\otimes (e_1 + \\epsilon e_2) \\otimes (e_1 + \\epsilon e_2)$ 和 $T_2 = e_1 \\otimes e_1 \\otimes e_1$。\n我们将 $X_{\\epsilon}$ 定义为：\n$$\nX_{\\epsilon} = \\frac{1}{\\epsilon} \\left( T_1(\\epsilon) - T_2 \\right) = \\frac{1}{\\epsilon} \\left( (e_1 + \\epsilon e_2) \\otimes (e_1 + \\epsilon e_2) \\otimes (e_1 + \\epsilon e_2) - e_1 \\otimes e_1 \\otimes e_1 \\right)\n$$\n根据构造，对于任何 $\\epsilon > 0$，$X_{\\epsilon}$ 是两个秩-1 张量的和（系数为 $\\frac{1}{\\epsilon}$ 和 $-\\frac{1}{\\epsilon}$）。因此，$X_{\\epsilon}$ 的 CP 秩至多为 $2$。我们注意到，对于 $\\epsilon > 0$，这两个秩-1 张量是线性无关的，所以秩恰好为 $2$。\n这可以写成形式 $X_\\epsilon = \\lambda_1 a_1 \\otimes b_1 \\otimes c_1 + \\lambda_2 a_2 \\otimes b_2 \\otimes c_2$，其中：\n$\\lambda_1 = \\frac{1}{\\epsilon}$, $a_1 = b_1 = c_1 = e_1 + \\epsilon e_2$\n$\\lambda_2 = -\\frac{1}{\\epsilon}$, $a_2 = b_2 = c_2 = e_1$\n显然，当 $\\epsilon \\to 0$ 时，标量权重 $\\lambda_1$ 和 $\\lambda_2$ 发散。\n\n现在，我们验证当 $\\epsilon \\to 0$ 时 $X_{\\epsilon} \\to X_{0}$。我们使用分配律展开 $T_1(\\epsilon)$ 中的外积：\n\\begin{align*} T_1(\\epsilon) = e_1\\otimes e_1\\otimes e_1 \\\\ + \\epsilon (e_2\\otimes e_1\\otimes e_1 + e_1\\otimes e_2\\otimes e_1 + e_1\\otimes e_1\\otimes e_2) \\\\ + \\epsilon^2 (e_2\\otimes e_2\\otimes e_1 + e_2\\otimes e_1\\otimes e_2 + e_1\\otimes e_2\\otimes e_2) \\\\ + \\epsilon^3 (e_2\\otimes e_2\\otimes e_2) \\end{align*}\n将此代入 $X_{\\epsilon}$ 的表达式中，并回顾 $X_0$ 的定义：\n\\begin{align*} X_{\\epsilon} = \\frac{1}{\\epsilon} \\left( T_1(\\epsilon) - e_1\\otimes e_1\\otimes e_1 \\right) \\\\ = (e_2\\otimes e_1\\otimes e_1 + e_1\\otimes e_2\\otimes e_1 + e_1\\otimes e_1\\otimes e_2) \\\\ + \\epsilon (e_2\\otimes e_2\\otimes e_1 + e_2\\otimes e_1\\otimes e_2 + e_1\\otimes e_2\\otimes e_2) \\\\ + \\epsilon^2 (e_2\\otimes e_2\\otimes e_2) \\\\ = X_0 + \\epsilon (e_2\\otimes e_2\\otimes e_1 + e_2\\otimes e_1\\otimes e_2 + e_1\\otimes e_2\\otimes e_2) + \\epsilon^2 (e_2\\otimes e_2\\otimes e_2)\\end{align*}\n差值为 $E_{\\epsilon} = X_{\\epsilon} - X_0 = \\epsilon (e_2\\otimes e_2\\otimes e_1 + e_2\\otimes e_1\\otimes e_2 + e_1\\otimes e_2\\otimes e_2) + \\epsilon^2 (e_2\\otimes e_2\\otimes e_2)$。\n基本张量 $e_i \\otimes e_j \\otimes e_k$ 构成了张量空间关于弗罗贝尼乌斯内积的一组标准正交基。因此，弗罗贝尼乌斯范数的平方是这些基张量系数的平方和。\n$$\n\\| E_{\\epsilon} \\|_F^2 = \\epsilon^2 (1^2 + 1^2 + 1^2) + (\\epsilon^2)^2 (1^2) = 3\\epsilon^2 + \\epsilon^4\n$$\n当 $\\epsilon \\to 0$ 时，$\\| E_{\\epsilon} \\|_F^2 \\to 0$，这意味着 $\\|X_{\\epsilon} - X_0\\|_F \\to 0$。这证实了收敛性。因此我们证明了 $X_0$ 的边界秩至多为 $2$。\n\n其次，我们证明 $X_{0}$ 的 CP 秩严格大于 $2$。\n我们用反证法。假设 $X_0$ 的 CP 秩为 2。那么，存在向量 $u_1, u_2, v_1, v_2, w_1, w_2 \\in \\mathbb{R}^2$ 使得\n$$\nX_0 = u_1 \\otimes v_1 \\otimes w_1 + u_2 \\otimes v_2 \\otimes w_2\n$$\n$X_0$ 的元素由 $(X_0)_{ijk} = (u_1)_i(v_1)_j(w_1)_k + (u_2)_i(v_2)_j(w_2)_k$ 给出。\n一个三阶张量可以看作是矩阵“切片”的集合。令 $M_k = X_0(:,:,k)$ 为第 $k$ 个正面切片。\n对于 $k=1$，我们有 $M_1 = \\begin{pmatrix} (X_0)_{111}  (X_0)_{121} \\\\ (X_0)_{211}  (X_0)_{221} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$。\n对于 $k=2$，我们有 $M_2 = \\begin{pmatrix} (X_0)_{112}  (X_0)_{122} \\\\ (X_0)_{212}  (X_0)_{222} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$。\n从秩-2 分解中，切片由下式给出\n$$\nM_k = (w_1)_k (u_1 v_1^T) + (w_2)_k (u_2 v_2^T)\n$$\n令 $A_1 = u_1 v_1^T$ 和 $A_2 = u_2 v_2^T$。$A_1$ 和 $A_2$ 都是秩-1 矩阵（或者是零矩阵，这是一个我们可以排除的平凡情况）。\n这意味着 $M_1$ 和 $M_2$ 都在由 $A_1$ 和 $A_2$ 张成的二维矩阵向量空间中。设这个空间为 $\\mathcal{S} = \\text{span}\\{A_1, A_2\\}$。\n矩阵 $M_1$ 和 $M_2$ 是线性无关的，因为如果 $c_1 M_1 + c_2 M_2 = 0$，那么 $\\begin{pmatrix} c_2  c_1 \\\\ c_1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$，这意味着 $c_1=c_2=0$。因此，$\\{M_1, M_2\\}$ 构成了 $\\mathcal{S}$ 的一组基。\n这意味着 $A_1$ 和 $A_2$ 本身也必须在 $\\mathcal{S}$ 中，并且可以表示为 $M_1$ 和 $M_2$ 的线性组合。由于 $A_1$ 和 $A_2$ 是秩-1 矩阵，所以空间 $\\mathcal{S}$ 必须包含秩-1 矩阵。\n我们来找出 $\\mathcal{S}$ 中所有秩至多为 $1$ 的矩阵。$\\mathcal{S}$ 中的一个通用矩阵具有形式 $M = c_1 M_1 + c_2 M_2 = \\begin{pmatrix} c_2  c_1 \\\\ c_1  0 \\end{pmatrix}$，其中 $c_1, c_2 \\in \\mathbb{R}$ 是标量。\n$M$ 的秩至多为 $1$ 当且仅当其行列式为零。\n$$\n\\det(M) = (c_2)(0) - (c_1)(c_1) = -c_1^2\n$$\n要使 $\\det(M) = 0$，我们必须有 $c_1=0$。这意味着 $\\mathcal{S}$ 中秩至多为 $1$ 的矩阵只能是 $c_2 M_2 = \\begin{pmatrix} c_2  0 \\\\ 0  0 \\end{pmatrix}$ 的形式。这是 $\\mathcal{S}$ 的一个一维子空间。\n由于 $A_1$ 和 $A_2$ 必须是 $\\mathcal{S}$ 中的秩-1 矩阵，它们都必须属于这个子空间。因此，对于某些标量 $k_1, k_2$，有 $A_1 = k_1 M_2$ 和 $A_2 = k_2 M_2$。\n这意味着 $A_1$ 和 $A_2$ 是线性相关的。\n如果 $A_1$ 和 $A_2$ 是线性相关的，那么它们张成的空间 $\\mathcal{S}$ 最多是一维的。\n但我们已经确定 $\\mathcal{S}$ 是二维的，因为它是由线性无关的矩阵 $M_1$ 和 $M_2$ 张成的。\n这是一个矛盾。因此，最初关于 $X_0$ 的 CP 秩为 $2$ 的假设必定是错误的。因此，$\\text{rank}(X_0) > 2$。\n根据其定义，$X_0$ 是三个秩-1 张量的和，所以其秩至多为 $3$。因此，$\\text{rank}(X_0) = 3$。\n\n其结果是，$X_0$ 的最佳秩-2 近似问题无解。该问题是寻找 $\\min_{\\text{rank}(Y) \\le 2} \\|X_0 - Y\\|_F$。\n我们已经证明 $X_0 = \\lim_{\\epsilon \\to 0} X_{\\epsilon}$，其中 $\\text{rank}(X_{\\epsilon}) = 2$。这意味着误差的下确界为零：\n$$\n\\inf_{\\text{rank}(Y) \\le 2} \\|X_0 - Y\\|_F \\le \\lim_{\\epsilon \\to 0} \\|X_0 - X_{\\epsilon}\\|_F = 0\n$$\n由于范数是非负的，下确界必须恰好为 $0$。如果这个最小值可以达到，那么将存在一个张量 $Y_0$ 且 $\\text{rank}(Y_0) \\le 2$，使得 $\\|X_0 - Y_0\\|_F = 0$。这意味着 $X_0 = Y_0$，因此 $\\text{rank}(X_0) \\le 2$。这与我们发现的 $\\text{rank}(X_0) = 3$ 相矛盾。因此，这个最小值是无法达到的。\n\n最后，我们计算 $X_{0}$ 的弗罗贝尼乌斯范数。\n张量 $X_0$ 有三个非零元素，都等于 $1$：$X_{2,1,1}=1$、$X_{1,2,1}=1$ 和 $X_{1,1,2}=1$。所有其他 $2^3 - 3 = 5$ 个元素都为零。\n根据定义，弗罗贝尼乌斯范数的平方是所有元素平方的和。\n$$\n\\|X_0\\|_F^2 = \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^2 (X_0)_{ijk}^2 = (X_{2,1,1})^2 + (X_{1,2,1})^2 + (X_{1,1,2})^2 = 1^2 + 1^2 + 1^2 = 1+1+1 = 3\n$$\n弗罗贝尼乌斯范数是这个值的平方根。\n$$\n\\|X_0\\|_F = \\sqrt{3}\n$$\n这就是所要求的最终数值。",
            "answer": "$$\\boxed{\\sqrt{3}}$$"
        }
    ]
}