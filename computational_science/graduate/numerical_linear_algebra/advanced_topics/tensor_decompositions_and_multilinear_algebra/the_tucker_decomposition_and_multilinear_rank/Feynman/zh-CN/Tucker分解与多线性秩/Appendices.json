{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将通过一个具体实例，引导你分步构建一个塔克(Tucker)分解近似。通过为一个小型张量  手动计算模-$n$展开、因子矩阵和核心张量，你将建立起对这些组件如何协同工作的基本、直观的理解。这个实践旨在将抽象的定义具体化，为后续更高级的主题奠定坚实的基础。",
            "id": "3598139",
            "problem": "考虑以下由其模式-3 切片指定的实值三阶张量 $\\mathcal{X} \\in \\mathbb{R}^{2 \\times 3 \\times 2}$。当 $k=1$ 时，\n$$\n\\mathcal{X}(:,:,1) \\;=\\; \\begin{pmatrix}\n\\sqrt{3}  \\sqrt{3}  \\sqrt{3} \\\\\n0  0  0\n\\end{pmatrix},\n$$\n当 $k=2$ 时，\n$$\n\\mathcal{X}(:,:,2) \\;=\\; \\begin{pmatrix}\n0  0  0 \\\\\n\\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  0\n\\end{pmatrix}.\n$$\n任务是计算 $\\mathcal{X}$ 的多线性秩为 $(1,2,1)$ 的截断高阶奇异值分解（tHOSVD, truncated Higher-Order Singular Value Decomposition）近似，然后评估近似误差的弗罗贝尼乌斯范数。\n\n从模式-$n$ 展开、奇异值分解（SVD）、塔克分解（Tucker decomposition）和多线性秩的定义开始。通过以下步骤构建 tHOSVD 近似：\n- 计算每个模式-$n$ 展开的前 $r_n$ 个左奇异向量（其中 $r_1=1, r_2=2, r_3=1$），\n- 构成因子矩阵，\n- 通过正交投影计算塔克核张量，\n- 重构近似张量。\n\n最后，计算误差的弗罗贝尼乌斯范数 $\\|\\mathcal{X}-\\widehat{\\mathcal{X}}\\|_F$。提供 $\\|\\mathcal{X}-\\widehat{\\mathcal{X}}\\|_F$ 的精确值（不进行四舍五入）。",
            "solution": "该问题要求计算给定张量 $\\mathcal{X} \\in \\mathbb{R}^{2 \\times 3 \\times 2}$ 在指定多线性秩为 $(1,2,1)$ 的情况下，其截断高阶奇异值分解（tHOSVD）近似的误差的弗罗贝尼乌斯范数。\n\n首先，我们陈述必要的定义。\n一个 $N$ 阶张量 $\\mathcal{X} \\in \\mathbb{R}^{I_1 \\times I_2 \\times \\dots \\times I_N}$ 是一个 $N$ 维数组。\n$\\mathcal{X}$ 的模式-$n$ 展开，记作 $X_{(n)}$，是一个大小为 $I_n \\times (I_1 \\dots I_{n-1} I_{n+1} \\dots I_N)$ 的矩阵，其列是 $\\mathcal{X}$ 的所有模式-$n$ 纤维。模式-$n$ 纤维是通过固定除第 $n$ 个索引外的所有索引得到的。\n张量 $\\mathcal{X}$ 的弗罗贝尼乌斯范数定义为其所有元素平方和的平方根：$\\|\\mathcal{X}\\|_F = \\sqrt{\\sum_{i_1,\\dots,i_N} x_{i_1\\dots i_N}^2}$。任何模式-$n$ 展开的弗罗贝尼乌斯范数的平方都等于张量本身的范数平方：$\\|X_{(n)}\\|_F^2 = \\|\\mathcal{X}\\|_F^2$。\n塔克分解（Tucker decomposition）将一个张量 $\\mathcal{X}$ 表示为一个核心张量 $\\mathcal{G}$ 与每个模式上的一个矩阵相乘（在张量-矩阵乘积的意义上）：\n$$ \\mathcal{X} = \\mathcal{G} \\times_1 U^{(1)} \\times_2 U^{(2)} \\times_3 \\dots \\times_N U^{(N)} $$\ntHOSVD 是一种用于近似的特殊类型的塔克分解。对于目标多线性秩 $(r_1, r_2, \\dots, r_N)$，因子矩阵 $U^{(n)} \\in \\mathbb{R}^{I_n \\times r_n}$ 由模式-$n$ 展开 $X_{(n)}$ 的前 $r_n$ 个左奇异向量构成。这些奇异向量通过对 $X_{(n)} = U_n \\Sigma_n V_n^T$ 进行奇异值分解（SVD）得到。然后，通过将原始张量 $\\mathcal{X}$ 投影到由因子矩阵张成的空间上，计算出核心张量 $\\mathcal{G} \\in \\mathbb{R}^{r_1 \\times r_2 \\times \\dots \\times r_N}$：\n$$ \\mathcal{G} = \\mathcal{X} \\times_1 (U^{(1)})^T \\times_2 (U^{(2)})^T \\dots \\times_N (U^{(N)})^T $$\ntHOSVD 近似 $\\widehat{\\mathcal{X}}$ 则重构为 $\\widehat{\\mathcal{X}} = \\mathcal{G} \\times_1 U^{(1)} \\times_2 U^{(2)} \\dots \\times_N U^{(N)}$。\n由于因子矩阵 $U^{(n)}$ 具有标准正交列，弗罗贝尼乌斯范数在此变换下保持不变，即 $\\|\\widehat{\\mathcal{X}}\\|_F = \\|\\mathcal{G}\\|_F$。近似误差为 $\\mathcal{E} = \\mathcal{X} - \\widehat{\\mathcal{X}}$。误差的弗罗贝尼乌斯范数平方由下式给出：$\\|\\mathcal{X} - \\widehat{\\mathcal{X}}\\|_F^2 = \\|\\mathcal{X}\\|_F^2 - \\|\\widehat{\\mathcal{X}}\\|_F^2 = \\|\\mathcal{X}\\|_F^2 - \\|\\mathcal{G}\\|_F^2$。\n\n我们开始计算。给定的张量 $\\mathcal{X} \\in \\mathbb{R}^{2 \\times 3 \\times 2}$ 由其切片定义：\n当 $k=1$ 时：$\\mathcal{X}(:,:,1) = \\begin{pmatrix} \\sqrt{3}  \\sqrt{3}  \\sqrt{3} \\\\ 0  0  0 \\end{pmatrix}$。\n当 $k=2$ 时：$\\mathcal{X}(:,:,2) = \\begin{pmatrix} 0  0  0 \\\\ \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  0 \\end{pmatrix}$。\n目标多线性秩为 $(r_1, r_2, r_3) = (1, 2, 1)$。\n\n首先，我们计算 $\\mathcal{X}$ 的弗罗贝尼乌斯范数的平方：\n$$ \\|\\mathcal{X}\\|_F^2 = \\sum_{i,j,k} x_{ijk}^2 = (\\sqrt{3})^2 \\times 3 + (\\frac{1}{\\sqrt{2}})^2 + (-\\frac{1}{\\sqrt{2}})^2 = 9 + \\frac{1}{2} + \\frac{1}{2} = 10 $$\n\n接下来，我们构造模式-$n$ 展开。\n模式-1 展开 $X_{(1)} \\in \\mathbb{R}^{2 \\times 6}$ 为：\n$$ X_{(1)} = \\begin{pmatrix} \\sqrt{3}  \\sqrt{3}  \\sqrt{3}  0  0  0 \\\\ 0  0  0  \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  0 \\end{pmatrix} $$\n为了找到 $X_{(1)}$ 的左奇异向量，我们计算 $X_{(1)}X_{(1)}^T$：\n$$ X_{(1)}X_{(1)}^T = \\begin{pmatrix} (\\sqrt{3})^2 \\times 3  0 \\\\ 0  (\\frac{1}{\\sqrt{2}})^2 + (-\\frac{1}{\\sqrt{2}})^2 \\end{pmatrix} = \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix} $$\n该矩阵的特征值为 $\\lambda_1 = 9$ 和 $\\lambda_2 = 1$。对应的特征向量（即 $X_{(1)}$ 的左奇异向量）为 $u_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $u_2^{(1)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n由于 $r_1=1$，我们选择第一个左奇异向量来构成因子矩阵 $U^{(1)}$：\n$$ U^{(1)} = u_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n\n模式-2 展开 $X_{(2)} \\in \\mathbb{R}^{3 \\times 4}$ 为：\n$$ X_{(2)} = \\begin{pmatrix} \\sqrt{3}  0  0  \\frac{1}{\\sqrt{2}} \\\\ \\sqrt{3}  0  0  -\\frac{1}{\\sqrt{2}} \\\\ \\sqrt{3}  0  0  0 \\end{pmatrix} $$\n我们计算 $X_{(2)}X_{(2)}^T$：\n$$ X_{(2)}X_{(2)}^T = \\begin{pmatrix} 3+\\frac{1}{2}  3-\\frac{1}{2}  3 \\\\ 3-\\frac{1}{2}  3+\\frac{1}{2}  3 \\\\ 3  3  3 \\end{pmatrix} = \\begin{pmatrix} \\frac{7}{2}  \\frac{5}{2}  3 \\\\ \\frac{5}{2}  \\frac{7}{2}  3 \\\\ 3  3  3 \\end{pmatrix} $$\n该矩阵的特征值为 $\\lambda_1=9$、$\\lambda_2=1$ 和 $\\lambda_3=0$。相应的归一化特征向量为：\n对于 $\\lambda_1=9$，$u_1^{(2)} = \\frac{1}{\\sqrt{3}}\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n对于 $\\lambda_2=1$，$u_2^{(2)} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix}$。\n对于 $\\lambda_3=0$，$u_3^{(2)} = \\frac{1}{\\sqrt{6}}\\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix}$。\n由于 $r_2=2$，我们选择前两个左奇异向量来构成 $U^{(2)}$：\n$$ U^{(2)} = \\begin{pmatrix} u_1^{(2)}  u_2^{(2)} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{3}}  -\\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{3}}  0 \\end{pmatrix} $$\n\n模式-3 展开 $X_{(3)} \\in \\mathbb{R}^{2 \\times 6}$ 为：\n$$ X_{(3)} = \\begin{pmatrix} \\sqrt{3}  \\sqrt{3}  \\sqrt{3}  0  0  0 \\\\ 0  0  0  \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  0 \\end{pmatrix} $$\n这与 $X_{(1)}$ 相同。因此，$X_{(3)}X_{(3)}^T = \\begin{pmatrix} 9  0 \\\\ 0  1 \\end{pmatrix}$，左奇异向量为 $u_1^{(3)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $u_2^{(3)} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n由于 $r_3=1$，我们选择第一个左奇异向量：\n$$ U^{(3)} = u_1^{(3)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n\n现在，我们计算核心张量 $\\mathcal{G} \\in \\mathbb{R}^{1 \\times 2 \\times 1}$。其元素 $g_{j_1 j_2 j_3}$ 由以下公式给出：\n$$ g_{j_1 j_2 j_3} = \\sum_{i_1=1}^2 \\sum_{i_2=1}^3 \\sum_{i_3=1}^2 x_{i_1 i_2 i_3} (U^{(1)})_{i_1 j_1} (U^{(2)})_{i_2 j_2} (U^{(3)})_{i_3 j_3} $$\n$\\mathcal{G}$ 的索引为 $j_1 \\in \\{1\\}$，$j_2 \\in \\{1, 2\\}$，$j_3 \\in \\{1\\}$。我们需要求解 $g_{111}$ 和 $g_{121}$。\n\n对于 $g_{111}$：\n求和式中唯一的非零项在 $i_1=1$（因为 $(U^{(1)})_{21}=0$）和 $i_3=1$（因为 $(U^{(3)})_{21}=0$）时出现。\n$$ g_{111} = \\sum_{i_2=1}^3 x_{1 i_2 1} (U^{(1)})_{11} (U^{(2)})_{i_2 1} (U^{(3)})_{11} $$\n$$ g_{111} = \\sum_{i_2=1}^3 x_{1 i_2 1} (1) (\\frac{1}{\\sqrt{3}}) (1) = \\frac{1}{\\sqrt{3}}(x_{111} + x_{121} + x_{131}) $$\n从 $\\mathcal{X}(:,:,1)$，我们有 $x_{111}=x_{121}=x_{131}=\\sqrt{3}$。\n$$ g_{111} = \\frac{1}{\\sqrt{3}}(\\sqrt{3} + \\sqrt{3} + \\sqrt{3}) = \\frac{3\\sqrt{3}}{\\sqrt{3}} = 3 $$\n\n对于 $g_{121}$：\n同样，只有 $i_1=1$ 和 $i_3=1$ 的项有贡献。\n$$ g_{121} = \\sum_{i_2=1}^3 x_{1 i_2 1} (U^{(1)})_{11} (U^{(2)})_{i_2 2} (U^{(3)})_{11} $$\n$$ g_{121} = \\sum_{i_2=1}^3 x_{1 i_2 1} (1) ((U^{(2)})_{i_2 2}) (1) $$\n使用来自 $U^{(2)}$ 的值：$(U^{(2)})_{12}=\\frac{1}{\\sqrt{2}}$，$(U^{(2)})_{22}=-\\frac{1}{\\sqrt{2}}$，$(U^{(2)})_{32}=0$。\n$$ g_{121} = x_{111} (\\frac{1}{\\sqrt{2}}) + x_{121} (-\\frac{1}{\\sqrt{2}}) + x_{131} (0) = \\sqrt{3}(\\frac{1}{\\sqrt{2}}) + \\sqrt{3}(-\\frac{1}{\\sqrt{2}}) = 0 $$\n核心张量 $\\mathcal{G}$ 的元素为 $g_{111}=3$ 和 $g_{121}=0$。$\\mathcal{G}$ 的弗罗贝尼乌斯范数的平方是：\n$$ \\|\\mathcal{G}\\|_F^2 = g_{111}^2 + g_{121}^2 = 3^2 + 0^2 = 9 $$\n\n最后，近似误差的弗罗贝尼乌斯范数的平方是：\n$$ \\|\\mathcal{X} - \\widehat{\\mathcal{X}}\\|_F^2 = \\|\\mathcal{X}\\|_F^2 - \\|\\mathcal{G}\\|_F^2 = 10 - 9 = 1 $$\n因此，误差的弗罗贝尼乌斯范数是：\n$$ \\|\\mathcal{X} - \\widehat{\\mathcal{X}}\\|_F = \\sqrt{1} = 1 $$",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "虽然高阶奇异值分解(HOSVD)提供了一个有价值的初始近似，但它通常不是最小二乘意义下的最优解。下一个练习将介绍高阶正交迭代(HOOI)算法，这是一种标准的迭代方法，用于优化因子矩阵以找到最佳的塔克分解近似 。通过亲手执行一轮完整的算法迭代，你将深入了解大多数实用塔克分解软件背后的优化过程。",
            "id": "3598137",
            "problem": "考虑一个实三阶张量 $\\mathcal{X} \\in \\mathbb{R}^{I_1 \\times I_2 \\times I_3}$ 及其多线性秩为 $(r_1, r_2, r_3)$ 的Tucker分解，定义为 $\\mathcal{X} \\approx \\mathcal{G} \\times_1 U^{(1)} \\times_2 U^{(2)} \\times_3 U^{(3)}$，其中 $\\mathcal{G} \\in \\mathbb{R}^{r_1 \\times r_2 \\times r_3}$ 是核张量，$U^{(n)} \\in \\mathbb{R}^{I_n \\times r_n}$ 具有标准正交列。高阶正交迭代（HOOI）算法的一次完整扫描，对于每个模态 $n$，通过计算沿其他模态投影后的张量的模$n$展开的主左奇异向量来更新因子 $U^{(n)}$，从当前因子开始。模$n$乘积 $\\mathcal{X} \\times_n U$ 的元素定义为 $(\\mathcal{X} \\times_n U)_{i_1,\\dots,i_{n-1},j,i_{n+1},\\dots,i_3} = \\sum_{i_n=1}^{I_n} \\mathcal{X}_{i_1,\\dots,i_n,\\dots,i_3} U_{j,i_n}$，而模$n$展开 $X_{(n)}$ 将 $\\mathcal{X}$ 重排成一个矩阵，其列是模$n$纤维。\n\n令 $I_1 = 3$，$I_2 = 2$，$I_3 = 2$，目标多线性秩为 $(r_1,r_2,r_3) = (1,1,1)$。张量 $\\mathcal{X}$ 由其正面切片指定：\n$$\nX(:,:,1) = \\begin{pmatrix}\n1  2 \\\\\n0  1 \\\\\n1  0\n\\end{pmatrix},\n\\qquad\nX(:,:,2) = \\begin{pmatrix}\n0  1 \\\\\n2  0 \\\\\n1  1\n\\end{pmatrix}.\n$$\n初始因子矩阵是单位范数列向量：\n$$\nU^{(1)}_{0} = \\begin{pmatrix}\n\\frac{1}{\\sqrt{3}} \\\\\n\\frac{1}{\\sqrt{3}} \\\\\n\\frac{1}{\\sqrt{3}}\n\\end{pmatrix},\\quad\nU^{(2)}_{0} = \\begin{pmatrix}\n\\frac{3}{5} \\\\\n\\frac{4}{5}\n\\end{pmatrix},\\quad\nU^{(3)}_{0} = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{2}}\n\\end{pmatrix}.\n$$\n\n执行一次完整的HOOI扫描，依次更新 $U^{(1)}$、$U^{(2)}$ 和 $U^{(3)}$，通过以下步骤：\n- 对于模态 $n$，构建部分投影张量 $\\mathcal{Y}^{(n)} = \\mathcal{X} \\times_{m \\neq n} \\left(U^{(m)}\\right)^{\\top}$，取其模$n$展开 $Y^{(n)}_{(n)}$，并计算奇异值分解（SVD）$Y^{(n)}_{(n)} = W^{(n)} \\Sigma^{(n)} \\left(V^{(n)}\\right)^{\\top}$。\n- 将 $U^{(n)}$ 更新为 $W^{(n)}$ 的前 $r_n$ 列。\n\n明确写出此轮扫描中使用的每个SVD以及更新后的核张量 $\\mathcal{G} = \\mathcal{X} \\times_1 \\left(U^{(1)}\\right)^{\\top} \\times_2 \\left(U^{(2)}\\right)^{\\top} \\times_3 \\left(U^{(3)}\\right)^{\\top}$。因为 $(r_1,r_2,r_3)=(1,1,1)$，核张量是一个标量。请以精确的封闭形式给出此标量值作为最终答案。不要四舍五入；将最终答案表示为单个无单位的封闭形式解析表达式。",
            "solution": "问题要求执行一轮完整的高阶正交迭代（HOOI）算法，为一个给定的三阶张量 $\\mathcal{X} \\in \\mathbb{R}^{3 \\times 2 \\times 2}$ 找到一个近似的秩-$(1,1,1)$ Tucker分解。在扫描之后，必须计算更新后的核张量 $\\mathcal{G}$，对于指定的秩，它是一个标量。\n\n给定的张量 $\\mathcal{X}$ 的维度为 $I_1 = 3$，$I_2 = 2$，$I_3 = 2$，其正面切片为：\n$$\nX(:,:,1) = \\begin{pmatrix}\n1  2 \\\\\n0  1 \\\\\n1  0\n\\end{pmatrix},\n\\qquad\nX(:,:,2) = \\begin{pmatrix}\n0  1 \\\\\n2  0 \\\\\n1  1\n\\end{pmatrix}\n$$\n目标多线性秩为 $(r_1, r_2, r_3) = (1, 1, 1)$。初始因子矩阵如下：\n$$\nU^{(1)}_{0} = \\frac{1}{\\sqrt{3}}\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix},\\quad\nU^{(2)}_{0} = \\frac{1}{5}\\begin{pmatrix} 3 \\\\ 4 \\end{pmatrix},\\quad\nU^{(3)}_{0} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n一轮完整的扫描包括更新 $U^{(1)}$，然后 $U^{(2)}$，最后 $U^{(3)}$。对于每个模态 $n$，更新规则是计算张量 $\\mathcal{Y}^{(n)} = \\mathcal{X} \\times_{m \\neq n} (U^{(m)})^{\\top}$ 的模$n$展开的前导 $r_n$ 个左奇异向量。\n\n**第一步：更新模1因子 $U^{(1)}$**\n\n我们首先计算张量 $\\mathcal{Y}^{(1)} = \\mathcal{X} \\times_2 (U^{(2)}_0)^{\\top} \\times_3 (U^{(3)}_0)^{\\top}$。由于 $r_2=1$ 和 $r_3=1$，$\\mathcal{Y}^{(1)}$ 是一个大小为 $3 \\times 1 \\times 1$ 的张量，等价于 $\\mathbb{R}^3$ 中的一个向量。设此向量为 $y^{(1)}$。$y^{(1)}$ 的元素由下式给出：\n$$\n(y^{(1)})_{i_1} = \\sum_{i_2=1}^{2} \\sum_{i_3=1}^{2} \\mathcal{X}_{i_1, i_2, i_3} (U^{(2)}_0)_{i_2, 1} (U^{(3)}_0)_{i_3, 1}\n$$\n对于 $i_1=1$:\n$(y^{(1)})_1 = \\mathcal{X}_{111} U^{(2)}_{11} U^{(3)}_{11} + \\mathcal{X}_{112} U^{(2)}_{11} U^{(3)}_{21} + \\mathcal{X}_{121} U^{(2)}_{21} U^{(3)}_{11} + \\mathcal{X}_{122} U^{(2)}_{21} U^{(3)}_{21}$\n$= 1 \\cdot \\frac{3}{5} \\cdot \\frac{1}{\\sqrt{2}} + 0 \\cdot \\frac{3}{5} \\cdot \\frac{1}{\\sqrt{2}} + 2 \\cdot \\frac{4}{5} \\cdot \\frac{1}{\\sqrt{2}} + 1 \\cdot \\frac{4}{5} \\cdot \\frac{1}{\\sqrt{2}} = \\frac{1}{5\\sqrt{2}}(3 + 0 + 8 + 4) = \\frac{15}{5\\sqrt{2}} = \\frac{3}{\\sqrt{2}}$。\n\n对于 $i_1=2$:\n$(y^{(1)})_2 = 0 \\cdot \\frac{3}{5} \\cdot \\frac{1}{\\sqrt{2}} + 2 \\cdot \\frac{3}{5} \\cdot \\frac{1}{\\sqrt{2}} + 1 \\cdot \\frac{4}{5} \\cdot \\frac{1}{\\sqrt{2}} + 0 \\cdot \\frac{4}{5} \\cdot \\frac{1}{\\sqrt{2}} = \\frac{1}{5\\sqrt{2}}(0 + 6 + 4 + 0) = \\frac{10}{5\\sqrt{2}} = \\frac{2}{\\sqrt{2}}$。\n\n对于 $i_1=3$:\n$(y^{(1)})_3 = 1 \\cdot \\frac{3}{5} \\cdot \\frac{1}{\\sqrt{2}} + 1 \\cdot \\frac{3}{5} \\cdot \\frac{1}{\\sqrt{2}} + 0 \\cdot \\frac{4}{5} \\cdot \\frac{1}{\\sqrt{2}} + 1 \\cdot \\frac{4}{5} \\cdot \\frac{1}{\\sqrt{2}} = \\frac{1}{5\\sqrt{2}}(3 + 3 + 0 + 4) = \\frac{10}{5\\sqrt{2}} = \\frac{2}{\\sqrt{2}}$。\n\n模1展开 $Y^{(1)}_{(1)}$ 是列向量 $y^{(1)} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 3 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n$Y^{(1)}_{(1)}$ 的SVD为 $Y^{(1)}_{(1)} = W^{(1)} \\Sigma^{(1)} (V^{(1)})^{\\top}$。因为它是一个向量，$W^{(1)}$ 是其归一化版本，$\\Sigma^{(1)}$ 是其范数，而 $V^{(1)}$ 是标量 $1$。\n范数为 $\\|y^{(1)}\\| = \\sqrt{(\\frac{3}{\\sqrt{2}})^2 + (\\frac{2}{\\sqrt{2}})^2 + (\\frac{2}{\\sqrt{2}})^2} = \\sqrt{\\frac{9+4+4}{2}} = \\sqrt{\\frac{17}{2}}$。\nSVD为：\n$$\n\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 3 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 3/\\sqrt{17} \\\\ 2/\\sqrt{17} \\\\ 2/\\sqrt{17} \\end{pmatrix} \\begin{pmatrix} \\sqrt{\\frac{17}{2}} \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix}^{\\top}\n$$\n更新后的因子 $U^{(1)}_1$ 是 $W^{(1)}$ 的第一列（也是唯一一列）：\n$$\nU^{(1)}_1 = \\frac{1}{\\sqrt{17}}\\begin{pmatrix} 3 \\\\ 2 \\\\ 2 \\end{pmatrix}\n$$\n\n**第二步：更新模2因子 $U^{(2)}$**\n\n接下来，我们使用新的 $U^{(1)}_1$ 和初始的 $U^{(3)}_0$ 来更新 $U^{(2)}$。我们计算 $\\mathcal{Y}^{(2)} = \\mathcal{X} \\times_1 (U^{(1)}_1)^{\\top} \\times_3 (U^{(3)}_0)^{\\top}$，这是一个 $1 \\times 2 \\times 1$ 的张量。其模2展开 $Y^{(2)}_{(2)}$ 是一个向量 $y^{(2)} \\in \\mathbb{R}^2$。\n$$\n(y^{(2)})_{i_2} = \\sum_{i_1=1}^{3} \\sum_{i_3=1}^{2} \\mathcal{X}_{i_1, i_2, i_3} (U^{(1)}_1)_{i_1, 1} (U^{(3)}_0)_{i_3, 1}\n$$\n对于 $i_2=1$:\n$(y^{(2)})_1 = \\frac{1}{\\sqrt{17}\\sqrt{2}} \\sum_{i_1=1}^3 (\\mathcal{X}_{i_1,1,1} + \\mathcal{X}_{i_1,1,2}) (U^{(1)}_1 \\text{ unnormalized})_{i_1} = \\frac{1}{\\sqrt{34}} \\left( (1+0)\\cdot 3 + (0+2)\\cdot 2 + (1+1)\\cdot 2 \\right) = \\frac{1}{\\sqrt{34}}(3+4+4) = \\frac{11}{\\sqrt{34}}$。\n\n对于 $i_2=2$:\n$(y^{(2)})_2 = \\frac{1}{\\sqrt{34}} \\sum_{i_1=1}^3 (\\mathcal{X}_{i_1,2,1} + \\mathcal{X}_{i_1,2,2}) (U^{(1)}_1 \\text{ unnormalized})_{i_1} = \\frac{1}{\\sqrt{34}} \\left( (2+1)\\cdot 3 + (1+0)\\cdot 2 + (0+1)\\cdot 2 \\right) = \\frac{1}{\\sqrt{34}}(9+2+2) = \\frac{13}{\\sqrt{34}}$。\n\n所以，$Y^{(2)}_{(2)} = y^{(2)} = \\frac{1}{\\sqrt{34}}\\begin{pmatrix} 11 \\\\ 13 \\end{pmatrix}$。范数为 $\\|y^{(2)}\\| = \\sqrt{\\frac{11^2+13^2}{34}} = \\sqrt{\\frac{121+169}{34}} = \\sqrt{\\frac{290}{34}} = \\sqrt{\\frac{145}{17}}$。\nSVD为：\n$$\n\\frac{1}{\\sqrt{34}}\\begin{pmatrix} 11 \\\\ 13 \\end{pmatrix} = \\begin{pmatrix} 11/\\sqrt{290} \\\\ 13/\\sqrt{290} \\end{pmatrix} \\begin{pmatrix} \\sqrt{\\frac{145}{17}} \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix}^{\\top}\n$$\n更新后的因子 $U^{(2)}_1$ 是 $W^{(2)}$ 的第一列：\n$$\nU^{(2)}_1 = \\frac{1}{\\sqrt{290}}\\begin{pmatrix} 11 \\\\ 13 \\end{pmatrix}\n$$\n\n**第三步：更新模3因子 $U^{(3)}$**\n\n最后，我们使用新的 $U^{(1)}_1$ 和 $U^{(2)}_1$ 来更新 $U^{(3)}$。我们计算 $\\mathcal{Y}^{(3)} = \\mathcal{X} \\times_1 (U^{(1)}_1)^{\\top} \\times_2 (U^{(2)}_1)^{\\top}$，这是一个 $1 \\times 1 \\times 2$ 的张量。其模3展开 $Y^{(3)}_{(3)}$ 是一个向量 $y^{(3)} \\in \\mathbb{R}^2$。\n$$\n(y^{(3)})_{i_3} = \\sum_{i_1=1}^{3} \\sum_{i_2=1}^{2} \\mathcal{X}_{i_1, i_2, i_3} (U^{(1)}_1)_{i_1, 1} (U^{(2)}_1)_{i_2, 1}\n$$\n对于 $i_3=1$:\n$(y^{(3)})_1 = \\frac{1}{\\sqrt{17}\\sqrt{290}} \\sum_{i_1,i_2} \\mathcal{X}_{i_1, i_2, 1} \\cdot (\\text{unnormalized } U^{(1)}_1)_{i_1} \\cdot (\\text{unnormalized } U^{(2)}_1)_{i_2}$。\n设 $u^{(1)}=[3,2,2]^\\top$ 和 $u^{(2)}=[11,13]^\\top$。该和为 $(X(:,:,1) u^{(2)}) \\cdot u^{(1)}$。\n$X(:,:,1) u^{(2)} = \\begin{pmatrix} 1  2 \\\\ 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 11 \\\\ 13 \\end{pmatrix} = \\begin{pmatrix} 11+26 \\\\ 13 \\\\ 11 \\end{pmatrix} = \\begin{pmatrix} 37 \\\\ 13 \\\\ 11 \\end{pmatrix}$。\n$(37, 13, 11) \\cdot (3, 2, 2) = 37 \\cdot 3 + 13 \\cdot 2 + 11 \\cdot 2 = 111+26+22 = 159$。\n所以 $(y^{(3)})_1 = \\frac{159}{\\sqrt{17 \\cdot 290}} = \\frac{159}{\\sqrt{4930}}$。\n\n对于 $i_3=2$:\n设 $v = X(:,:,2) u^{(2)} = \\begin{pmatrix} 0  1 \\\\ 2  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 11 \\\\ 13 \\end{pmatrix} = \\begin{pmatrix} 13 \\\\ 22 \\\\ 11+13 \\end{pmatrix} = \\begin{pmatrix} 13 \\\\ 22 \\\\ 24 \\end{pmatrix}$。\n$v \\cdot u^{(1)} = (13, 22, 24) \\cdot (3, 2, 2) = 13 \\cdot 3 + 22 \\cdot 2 + 24 \\cdot 2 = 39+44+48 = 131$。\n所以 $(y^{(3)})_2 = \\frac{131}{\\sqrt{4930}}$。\n\n向量为 $Y^{(3)}_{(3)} = y^{(3)} = \\frac{1}{\\sqrt{4930}}\\begin{pmatrix} 159 \\\\ 131 \\end{pmatrix}$。\n范数为 $\\|y^{(3)}\\| = \\sqrt{\\frac{159^2+131^2}{4930}} = \\sqrt{\\frac{25281+17161}{4930}} = \\sqrt{\\frac{42442}{4930}} = \\sqrt{\\frac{21221}{2465}}$。\nSVD为 $Y^{(3)}_{(3)} = W^{(3)}\\Sigma^{(3)}(V^{(3)})^\\top$:\n$$\n\\frac{1}{\\sqrt{4930}}\\begin{pmatrix} 159 \\\\ 131 \\end{pmatrix} = \\frac{1}{\\sqrt{42442}}\\begin{pmatrix} 159 \\\\ 131 \\end{pmatrix} \\begin{pmatrix} \\sqrt{\\frac{21221}{2465}} \\end{pmatrix} \\begin{pmatrix} 1 \\end{pmatrix}^{\\top}\n$$\n更新后的因子是 $U^{(3)}_1 = W^{(3)} = \\frac{1}{\\sqrt{42442}}\\begin{pmatrix} 159 \\\\ 131 \\end{pmatrix}$。\n\n**第四步：计算核张量**\n\n经过一轮完整的扫描后，更新后的因子为 $U^{(1)}_1$，$U^{(2)}_1$ 和 $U^{(3)}_1$。核张量 $\\mathcal{G}$ 是一个标量 $g$，由下式给出：\n$$\ng = \\mathcal{G}_{111} = \\mathcal{X} \\times_1 (U^{(1)}_1)^{\\top} \\times_2 (U^{(2)}_1)^{\\top} \\times_3 (U^{(3)}_1)^{\\top}\n$$\n这可以计算为：\n$$\ng = \\sum_{i_1=1}^3 \\sum_{i_2=1}^2 \\sum_{i_3=1}^2 \\mathcal{X}_{i_1, i_2, i_3} (U^{(1)}_1)_{i_1, 1} (U^{(2)}_1)_{i_2, 1} (U^{(3)}_1)_{i_3, 1}\n$$\n我们可以对各项进行分组：\n$$\ng = \\sum_{i_3=1}^2 \\left( \\sum_{i_1=1}^3 \\sum_{i_2=1}^2 \\mathcal{X}_{i_1,i_2,i_3} (U^{(1)}_1)_{i_1,1} (U^{(2)}_1)_{i_2,1} \\right) (U^{(3)}_1)_{i_3,1}\n$$\n括号中的项正是 $(y^{(3)})_{i_3}$。因此 $g$ 的表达式是 $y^{(3)}$ 和 $U^{(3)}_1$ 的点积。根据更新规则，$U^{(3)}_1 = y^{(3)}/\\|y^{(3)}\\|$。\n$$\ng = y^{(3)} \\cdot U^{(3)}_1 = y^{(3)} \\cdot \\frac{y^{(3)}}{\\|y^{(3)}\\|} = \\frac{\\|y^{(3)}\\|^2}{\\|y^{(3)}\\|} = \\|y^{(3)}\\|\n$$\n核标量的值是在最后更新步骤中计算的向量的范数，也就是 $Y^{(3)}_{(3)}$ 的SVD中的主奇异值 $\\sigma_1$。\n$$\ng = \\|y^{(3)}\\| = \\sqrt{\\frac{21221}{2465}}\n$$\n这个值是平方根下的一个不可约分数，因为 $21221$ 不能被 $2465$ 的质因数 $5$、$17$ 和 $29$ 整除。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{21221}{2465}}}\n$$"
        },
        {
            "introduction": "当我们从矩阵推广到张量时，“秩”的概念变得更加微妙和丰富。这最后一个练习将挑战你探索塔克分解中使用的多线性秩(multilinear rank)与正则分解/多项分解(CP)秩之间的关键区别 。通过构建一个多线性秩很小但CP秩很大的张量，你将亲眼看到这两种衡量复杂度的指标可能存在巨大差异，这对于正确应用和解释张量方法至关重要。",
            "id": "3598153",
            "problem": "考虑三个维数相等的子空间 $U \\subset \\mathbb{C}^{n}$，$V \\subset \\mathbb{C}^{n}$ 和 $W \\subset \\mathbb{C}^{n}$，其维数为 $r$，其中 $n$ 和 $r$ 满足 $n \\geq r$ 且 $r \\geq 3$。令 $Q_{U} \\in \\mathbb{C}^{n \\times r}$，$Q_{V} \\in \\mathbb{C}^{n \\times r}$ 和 $Q_{W} \\in \\mathbb{C}^{n \\times r}$ 为满列秩矩阵，其列分别构成 $U$，$V$ 和 $W$ 的基。令 $G \\in \\mathbb{C}^{r \\times r \\times r}$ 为一个核心张量，其元素是代数上一般的（例如，从一个连续分布中独立抽取）。定义三阶张量\n$$\n\\mathcal{X} \\;=\\; G \\times_{1} Q_{U} \\times_{2} Q_{V} \\times_{3} Q_{W} \\;\\in\\; \\mathbb{C}^{n \\times n \\times n},\n$$\n其中 $\\times_{k}$ 表示模-$k$ 张量-矩阵乘积。\n\n你需要通过分析 $\\mathcal{X}$ 来展示 Tucker 多线性秩和典范多项分解秩之间的具体差异。仅使用数值线性代数和代数几何中标准且经过充分检验的基本定义和维数计数原理。特别地：\n\n- 回顾张量的 Tucker 多线性秩是其模-$k$ 展开矩阵的秩组成的元组。\n- 回顾张量的典范多项分解（CP）秩是能将该张量写成 $R$ 个秩-1 外积之和的最小整数 $R$。\n\n在复数域 $\\mathbb{C}$ 上进行计算。假设 $r = 7$，$n$ 是任何满足 $n \\geq 7$ 的固定整数。\n\n任务：\n1. 从模-$k$ 展开和模-$k$ 乘积的核心定义出发，仅使用矩阵乘积和 Kronecker 积的秩性质，推导 $\\mathcal{X}$ 的 Tucker 多线性秩。\n2. 在不使用未经证明的捷径的情况下，论证 $\\mathcal{X}$ 的 CP 秩等于一个 $7 \\times 7 \\times 7$ 复张量的一般 CP 秩，并通过对 Segre 嵌入的割线簇进行维数计数论证来精确计算该整数（解释为什么例外的亏格情况不适用于 $7 \\times 7 \\times 7$）。\n\n将计算出的 $\\mathcal{X}$ 的 CP 秩作为一个单独的整数作为你的最终答案。无需四舍五入，不涉及单位。以整数形式表达你的最终答案。",
            "solution": "用户提供了一个数值线性代数和代数几何领域中有效且定义明确的问题。我们将按要求分两部分进行解答。\n\n问题要求我们分析一个特定张量 $\\mathcal{X} \\in \\mathbb{C}^{n \\times n \\times n}$ 的 Tucker 多线性秩和典范多项分解（CP）秩，该张量定义为 $\\mathcal{X} = G \\times_{1} Q_{U} \\times_{2} Q_{V} \\times_{3} Q_{W}$。参数设置为 $r=7$ 和一个满足 $n \\geq 7$ 的整数 $n$。矩阵 $Q_{U}, Q_{V}, Q_{W} \\in \\mathbb{C}^{n \\times r}$ 是满列秩 $r$，核心张量 $G \\in \\mathbb{C}^{r \\times r \\times r}$ 具有代数上一般的元素。\n\n### 第 1 部分：$\\mathcal{X}$ 的 Tucker 多线性秩\n\n张量的 Tucker 多线性秩是其模-$k$ 矩阵化（或展开）的秩组成的元组。令 $\\mathcal{T} \\in \\mathbb{C}^{I_1 \\times I_2 \\times I_3}$ 为一个三阶张量。其模-1 展开记为 $T_{(1)}$，是一个 $\\mathbb{C}^{I_1 \\times (I_2 I_3)}$ 中的矩阵，其列是 $\\mathcal{T}$ 的模-1 纤维。具体来说，元素 $(\\mathcal{T})_{i_1, i_2, i_3}$ 映射到矩阵元素 $(T_{(1)})_{i_1, j}$，其中 $j$ 是 $(i_2, i_3)$ 的函数，通常为 $j = (i_2-1)I_3 + i_3$。展开 $T_{(2)}$ 和 $T_{(3)}$ 的定义类似。\n\n张量 $\\mathcal{A} \\in \\mathbb{C}^{J_1 \\times \\dots \\times J_N}$ 与矩阵 $U \\in \\mathbb{C}^{I_k \\times J_k}$ 的模-$k$ 乘积，记为 $\\mathcal{A} \\times_k U$，产生一个张量 $\\mathcal{B} \\in \\mathbb{C}^{J_1 \\times \\dots \\times I_k \\times \\dots \\times J_N}$，其元素为 $(\\mathcal{B})_{j_1 \\dots i_k \\dots j_N} = \\sum_{j_k=1}^{J_k} a_{j_1 \\dots j_k \\dots j_N} u_{i_k j_k}$。\n\n对于三阶张量 $\\mathcal{X} = G \\times_1 A \\times_2 B \\times_3 C$，连接展开和模积的一个基本性质由以下公式给出：\n$$X_{(1)} = A G_{(1)} (C \\otimes B)^T$$\n$$X_{(2)} = B G_{(2)} (C \\otimes A)^T$$\n$$X_{(3)} = C G_{(3)} (B \\otimes A)^T$$\n其中 $\\otimes$ 表示 Kronecker 积。Kronecker 积中矩阵的具体顺序取决于用于索引展开矩阵列的约定，但秩的性质在这种选择下是不变的。\n\n在我们的问题中，张量是 $\\mathcal{X} = G \\times_1 Q_U \\times_2 Q_V \\times_3 Q_W$。这里的核心张量是 $G \\in \\mathbb{C}^{r \\times r \\times r}$，因子矩阵是 $Q_U, Q_V, Q_W \\in \\mathbb{C}^{n \\times r}$。\n$\\mathcal{X}$ 的维数是 $n \\times n \\times n$。\n$\\mathcal{X}$ 的展开由以下公式给出：\n$$X_{(1)} = Q_{U} G_{(1)} (Q_{W} \\otimes Q_{V})^T \\in \\mathbb{C}^{n \\times n^2}$$\n$$X_{(2)} = Q_{V} G_{(2)} (Q_{W} \\otimes Q_{U})^T \\in \\mathbb{C}^{n \\times n^2}$$\n$$X_{(3)} = Q_{W} G_{(3)} (Q_{V} \\otimes Q_{U})^T \\in \\mathbb{C}^{n \\times n^2}$$\n\n我们现在确定每个展开的秩。让我们分析 $\\text{rank}(X_{(1)})$。\n矩阵 $X_{(1)}$ 是三个矩阵的乘积：$Q_U$，$G_{(1)}$ 和 $(Q_W \\otimes Q_V)^T$。\n1.  给定 $Q_U \\in \\mathbb{C}^{n \\times r}$ 是满列秩。因为 $n \\geq r$，这意味着 $\\text{rank}(Q_U) = r$。这表明左乘 $Q_U$ 是从 $\\mathbb{C}^r$ 到 $\\mathbb{C}^n$ 的一个单射线性映射。\n2.  $G \\in \\mathbb{C}^{r \\times r \\times r}$ 是一个一般张量。其模-1 展开 $G_{(1)}$ 是一个大小为 $r \\times r^2$ 的矩阵。对于一般张量，其展开具有最大可能的秩。因此，$\\text{rank}(G_{(1)}) = \\min(r, r^2) = r$。这意味着 $G_{(1)}$ 是满行秩。\n3.  因子矩阵 $Q_V, Q_W \\in \\mathbb{C}^{n \\times r}$ 的秩为 $r$。Kronecker 积 $Q_W \\otimes Q_V$ 是一个大小为 $n^2 \\times r^2$ 的矩阵。其秩是各秩的乘积：$\\text{rank}(Q_W \\otimes Q_V) = \\text{rank}(Q_W) \\cdot \\text{rank}(Q_V) = r \\cdot r = r^2$。转置 $(Q_W \\otimes Q_V)^T$ 的大小为 $r^2 \\times n^2$，秩也为 $r^2$。这是一个满秩矩阵（因为 $r \\le n$ 意味着 $r^2 \\le n^2$，所以是满行秩）。\n\n让我们计算乘积的秩：\n$\\text{rank}(X_{(1)}) = \\text{rank}(Q_U [G_{(1)} (Q_W \\otimes Q_V)^T])$。\n令 $M = G_{(1)} (Q_W \\otimes Q_V)^T$。这是一个 $r \\times r^2$ 矩阵（满行秩 $r$）和一个 $r^2 \\times n^2$ 矩阵（满行秩 $r^2$）的乘积。\n由于 $G_{(1)}$ 是一个一般的 $r \\times r^2$ 矩阵，其核空间 $\\text{ker}(G_{(1)})$ 是 $\\mathbb{C}^{r^2}$ 的一个维数为 $r^2 - r$ 的子空间。矩阵 $(Q_W \\otimes Q_V)^T$ 的值域是 $\\mathbb{C}^{n^2}$ 的一个子空间，但重要的是它在 $G_{(1)}$ 定义域上的作用。矩阵 $(Q_W \\otimes Q_V)^T$ 作为一个到 $\\mathbb{C}^{r^2}$ 的映射，其像的维数为 $r^2$。更简单地说，由于 $G_{(1)}$ 是满行秩，左乘 $G_{(1)}$ 将 $\\mathbb{C}^{r^2}$ 映射到 $\\mathbb{C}^r$ 上。由于 $(Q_W \\otimes Q_V)^T$ 的秩为 $r^2$，其行张成 $\\mathbb{C}^{r^2}$。乘积 $G_{(1)} (Q_W \\otimes Q_V)^T$ 的秩将等于 $G_{(1)}$ 的秩，即 $r$，除非 $(Q_W \\otimes Q_V)$ 的列与 $G_{(1)}$ 的核空间病态地对齐，但 $G$ 的一般性排除了这种情况。因此，$\\text{rank}(M) = r$。\n现在我们有 $X_{(1)} = Q_U M$，其中 $Q_U$ 是一个秩为 $r$ 的 $n \\times r$ 矩阵，$M$ 是一个秩为 $r$ 的 $r \\times n^2$ 矩阵。由于 $Q_U$ 是满列秩，它是一个单射映射。因此，$\\text{rank}(Q_U M) = \\text{rank}(M)$。\n所以，$\\text{rank}(X_{(1)}) = r$。\n\n根据对称性，完全相同的论证也适用于 $X_{(2)}$ 和 $X_{(3)}$。\n$\\text{rank}(X_{(2)}) = \\text{rank}(Q_V G_{(2)} (Q_W \\otimes Q_U)^T) = r$。\n$\\text{rank}(X_{(3)}) = \\text{rank}(Q_W G_{(3)} (Q_V \\otimes Q_U)^T) = r$。\n\n给定值 $r=7$，$\\mathcal{X}$ 的 Tucker 多线性秩是 $(7, 7, 7)$。\n\n### 第 2 部分：$\\mathcal{X}$ 的典范多项分解 (CP) 秩\n\n张量 $\\mathcal{T}$ 的 CP 秩，记为 $\\text{rank}_{CP}(\\mathcal{T})$，是能将 $\\mathcal{T}$ 写成 $R$ 个秩-1 张量之和的最小整数 $R$。一个秩-1 张量是向量的外积，例如，$u \\otimes v \\otimes w$。\n\n张量 $\\mathcal{X}$ 是通过将线性变换 $Q_U, Q_V, Q_W$ 应用于 $G$ 的相应模而形成的。由于这些矩阵是满列秩的，这些变换是单射的。由 $T(G) = G \\times_1 Q_U \\times_2 Q_V \\times_3 Q_W$ 定义的变换 $T: \\mathbb{C}^{r \\times r \\times r} \\to \\mathbb{C}^{n \\times n \\times n}$ 是从 $r \\times r \\times r$ 张量空间到其像（即模-$k$ 纤维位于 $Q_k$ 列空间的 $n \\times n \\times n$ 张量子空间）的线性同构。\n映射 $T$ 保持秩-1 结构：如果 $g = a \\otimes b \\otimes c$ 是 $\\mathbb{C}^{r \\times r \\times r}$ 中的一个秩-1 张量，那么 $T(g) = (Q_U a) \\otimes (Q_V b) \\otimes (Q_W c)$，这是 $\\mathbb{C}^{n \\times n \\times n}$ 中的一个秩-1 张量。\n设 $G$ 的 CP 分解为 $G = \\sum_{i=1}^R \\lambda_i (a_i \\otimes b_i \\otimes c_i)$，其中 $R = \\text{rank}_{CP}(G)$ 是最小的。应用映射 $T$ 并利用其线性性质，我们得到：\n$\\mathcal{X} = T(G) = \\sum_{i=1}^R \\lambda_i T(a_i \\otimes b_i \\otimes c_i) = \\sum_{i=1}^R \\lambda_i (Q_U a_i) \\otimes (Q_V b_i) \\otimes (Q_W c_i)$。\n这将 $\\mathcal{X}$ 表示为 $R$ 个秩-1 张量的和，因此 $\\text{rank}_{CP}(\\mathcal{X}) \\leq R = \\text{rank}_{CP}(G)$。由于映射 $T$ 是到其像上的一个同构，并且它将其定义域中的秩-1 张量集合单射地映射到其陪域（像空间）中的秩-1 张量集合，因此它保持了将张量表示为秩-1 张量之和所需的最少项数。因此，$\\text{rank}_{CP}(\\mathcal{X}) = \\text{rank}_{CP}(G)$。\n\n问题现在简化为求一个一般张量 $G \\in \\mathbb{C}^{7 \\times 7 \\times 7}$ 的 CP 秩。这是一个关于该尺寸张量的一般秩的问题。在代数几何中，秩至多为 $R$ 的张量集合由 Segre 簇 $S = \\text{Seg}(\\mathbb{P}^{d_1-1} \\times \\dots \\times \\mathbb{P}^{d_N-1})$ 的第 $R$ 个割线簇 $\\sigma_R(S)$ 来描述，该 Segre 簇参数化了秩-1 张量。\n对于一个 $\\mathbb{C}^{d_1 \\times d_2 \\times d_3}$ 张量，其环境空间的维数是 $d_1 d_2 d_3$。由于尺度的不确定性，$R$ 个秩-1 张量之和的参数空间的维数是 $R(d_1+d_2+d_3-2)$。使得该参数计数等于或超过环境维数的最小 $R$ 值是期望的一般秩。如果割线簇的维数等于这个期望值，则称其为非亏格的。一般秩 $R_{gen}$ 则是使 $\\sigma_R(S)$ 充满整个空间的最小 $R$。\n$\\sigma_R(S)$ 的期望维数 = $\\min(d_1 d_2 d_3, R(d_1+d_2+d_3-2))$。\n我们需要这个维数是 $d_1 d_2 d_3$。所以我们需要 $R(d_1+d_2+d_3-2) \\geq d_1 d_2 d_3$。因此，如果情况不是亏格的，一般秩为 $R_{gen} = \\lceil \\frac{d_1 d_2 d_3}{d_1+d_2+d_3-2} \\rceil$。\n\n在我们的例子中，$d_1=d_2=d_3=r=7$。\n环境空间的维数是 $7 \\times 7 \\times 7 = 343$。\n分解的参数计数是 $R(7+7+7-2) = 19R$。\n一般秩是 $R_{gen} = \\lceil \\frac{343}{19} \\rceil$。\n计算：$19 \\times 18 = 342$。所以，$\\frac{343}{19} = 18 + \\frac{1}{19} \\approx 18.05$。\n$R_{gen} = \\lceil 18.05\\dots \\rceil = 19$。\n\n我们必须证明这个公式是适用的，即 $7 \\times 7 \\times 7$ 张量的情况不是亏格的。亏格割线簇的研究是代数几何中的一个经典课题。著名的 Alexander-Hirschowitz 定理对对称张量（Veronese 嵌入）的所有亏格割线簇进行了分类。对于 Segre 嵌入，存在类似但更复杂的结果。对于大小为 $d_1 \\times d_2 \\times d_3$ 的三因子张量，Catalisano、Geramita、Gimigliano 以及 Abo、Ottaviani、Peterson 等人的工作为亏格情况提供了分类。已知这些情况很少。值得注意的是，对于大小为 $d \\times d \\times d$ 的平衡张量，亏格性发生在 $d=2$ 和 $d=3$ 时，但对于 $d \\geq 4$ 则不发生。\n\n由于我们的例子是 $d=7$，它不在已知例外的列表中。因此，$\\text{Seg}(\\mathbb{P}^6 \\times \\mathbb{P}^6 \\times \\mathbb{P}^6)$ 的割线簇不是亏格的，维数计数公式是精确的。\n\n一般张量 $G \\in \\mathbb{C}^{7 \\times 7 \\times 7}$ 的 CP 秩是 19。\n因此，$\\mathcal{X}$ 的 CP 秩也是 19。\n\n此分析展示了一个显著的差异：Tucker 多线性秩是 $(7, 7, 7)$，表明展开矩阵的列空间维数为 7，而 CP 秩为 19，这是一个大得多的数字，反映了张量的内在复杂性。",
            "answer": "$$\n\\boxed{19}\n$$"
        }
    ]
}