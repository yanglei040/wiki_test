{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，首要任务是通过具体计算来巩固理解。本练习提供了一个矩阵的奇异值分解（SVD），旨在引导您从第一性原理出发，一步步构建最小二乘问题的最小范数解。通过这个实践，您将熟练掌握如何利用SVD处理秩亏问题，这对于理解SVD在解决最小二乘问题中的核心作用至关重要。",
            "id": "3583009",
            "problem": "考虑一个实矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，其奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{3 \\times 3}$ 和 $V \\in \\mathbb{R}^{3 \\times 3}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{3 \\times 3}$ 是一个对角元为非负数的对角矩阵。设\n$$\nU = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n-\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\n\\Sigma = \\begin{pmatrix}\n4  0  0 \\\\\n0  1  0 \\\\\n0  0  0\n\\end{pmatrix}, \\quad\nV = \\begin{pmatrix}\n0  1  0 \\\\\n1  0  0 \\\\\n0  0  -1\n\\end{pmatrix}.\n$$\n设给定 $b \\in \\mathbb{R}^{3}$ 为 $b = \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}$，给定 $w \\in \\mathbb{R}^{3}$ 为 $w = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\end{pmatrix}$。仅使用最小二乘问题 $\\min_{x \\in \\mathbb{R}^{3}} \\|A x - b\\|_{2}$ 和奇异值分解的核心定义，通过将问题转换到奇异向量坐标系，将对应于零奇异值的零空间中的坐标设置为零，并通过非零奇异值求解其余坐标，来显式地构造最小范数最小二乘解 $x^{\\star}$。\n\n计算标量 $w^{\\top} x^{\\star}$，并将您的最终答案表示为单个闭式解析表达式。无需进行四舍五入。",
            "solution": "问题是要求解问题 $\\min_{x \\in \\mathbb{R}^{3}} \\|Ax - b\\|_{2}$ 的最小范数最小二乘解 $x^{\\star} \\in \\mathbb{R}^{3}$，然后计算标量 $w^{\\top} x^{\\star}$。矩阵 $A$ 由其奇异值分解 (SVD) 给出，$A = U \\Sigma V^{\\top}$，其中\n$$\nU = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}   \\frac{1}{\\sqrt{2}}   0 \\\\\n-\\frac{1}{\\sqrt{2}}   \\frac{1}{\\sqrt{2}}   0 \\\\\n0   0   1\n\\end{pmatrix}, \\quad\n\\Sigma = \\begin{pmatrix}\n4   0   0 \\\\\n0   1   0 \\\\\n0   0   0\n\\end{pmatrix}, \\quad\nV = \\begin{pmatrix}\n0   1   0 \\\\\n1   0   0 \\\\\n0   0   -1\n\\end{pmatrix}.\n$$\n向量 $b$ 和 $w$ 如下\n$$\nb = \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}, \\quad\nw = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\end{pmatrix}.\n$$\n目标是最小化残差的欧几里得范数 $\\|Ax - b\\|_{2}$。我们将 $A$ 的 SVD 代入此表达式中：\n$$\n\\|Ax - b\\|_{2} = \\|U \\Sigma V^{\\top} x - b\\|_{2}.\n$$\n由于 $U$ 是一个正交矩阵，其转置 $U^{\\top}$ 也是正交的。乘以一个正交矩阵会保持欧几里得范数不变，所以我们可以将范数内的项乘以 $U^{\\top}$ 而不改变范数的值：\n$$\n\\|U \\Sigma V^{\\top} x - b\\|_{2} = \\|U^{\\top}(U \\Sigma V^{\\top} x - b)\\|_{2} = \\|(U^{\\top}U) \\Sigma V^{\\top} x - U^{\\top}b\\|_{2}.\n$$\n由于 $U^{\\top}U = I$（单位矩阵），上式简化为：\n$$\n\\|\\Sigma V^{\\top} x - U^{\\top}b\\|_{2}.\n$$\n为了进一步简化此表达式，我们进行变量替换。令 $y = V^{\\top}x$。由于 $V$ 是一个正交矩阵，我们可以将 $x$ 表示为 $x = Vy$。这个变换是一个等距变换，意味着 $\\|x\\|_{2} = \\|Vy\\|_{2} = \\|y\\|_{2}$。因此，找到最小范数解 $x^{\\star}$ 等价于为变换后的问题找到最小范数解 $y^{\\star}$。问题现在变为找到 $y \\in \\mathbb{R}^{3}$ 以最小化 $\\|\\Sigma y - U^{\\top}b\\|_{2}$。\n\n首先，我们计算向量 $c = U^{\\top}b$：\n$$\nc = U^{\\top}b = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}   -\\frac{1}{\\sqrt{2}}   0 \\\\ \\frac{1}{\\sqrt{2}}   \\frac{1}{\\sqrt{2}}   0 \\\\ 0   0   1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}(1) - \\frac{1}{\\sqrt{2}}(-2) \\\\ \\frac{1}{\\sqrt{2}}(1) + \\frac{1}{\\sqrt{2}}(-2) \\\\ 1(3) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ 3 \\end{pmatrix}.\n$$\n现在我们用 $y = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix}$ 的分量来表示最小化问题。我们希望最小化范数的平方 $\\|\\Sigma y - c\\|_{2}^{2}$：\n$$\n\\|\\Sigma y - c\\|_{2}^{2} = \\left\\| \\begin{pmatrix} 4   0   0 \\\\ 0   1   0 \\\\ 0   0   0 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} - \\begin{pmatrix} \\frac{3}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ 3 \\end{pmatrix} \\right\\|_{2}^{2} = \\left\\| \\begin{pmatrix} 4y_1 - \\frac{3}{\\sqrt{2}} \\\\ y_2 - (-\\frac{1}{\\sqrt{2}}) \\\\ 0 \\cdot y_3 - 3 \\end{pmatrix} \\right\\|_{2}^{2}.\n$$\n这个范数的平方是各分量平方的和：\n$$\n(4y_1 - \\frac{3}{\\sqrt{2}})^2 + (y_2 + \\frac{1}{\\sqrt{2}})^2 + (-3)^2.\n$$\n为了最小化这个表达式，我们必须选择 $y_1$ 和 $y_2$ 使前两项为零，因为它们是非负的。\n对于第一项：$4y_1 - \\frac{3}{\\sqrt{2}} = 0 \\implies y_1 = \\frac{3}{4\\sqrt{2}}$。\n对于第二项：$y_2 + \\frac{1}{\\sqrt{2}} = 0 \\implies y_2 = -\\frac{1}{\\sqrt{2}}$。\n第三项 $(-3)^2=9$ 是一个常数，代表了可能的最小平方误差。$y_3$ 的选择不影响平方误差的值，所以任何 $y_3 \\in \\mathbb{R}$ 都能给出一个有效的最小二乘解。$y$ 的所有最小二乘解的集合由形如 $\\begin{pmatrix} \\frac{3}{4\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ k \\end{pmatrix}$ 的向量给出，其中 $k \\in \\mathbb{R}$ 为任意实数。\n\n为了找到唯一的最小范数解 $x^{\\star}$，我们必须首先找到最小范数解 $y^{\\star}$。$y$ 的范数平方为 $\\|y\\|_{2}^{2} = y_1^2 + y_2^2 + y_3^2$：\n$$\n\\|y\\|_{2}^{2} = \\left(\\frac{3}{4\\sqrt{2}}\\right)^2 + \\left(-\\frac{1}{\\sqrt{2}}\\right)^2 + y_3^2.\n$$\n为了最小化这个范数，我们必须选择分量 $y_3$ 为零，即 $y_3=0$。这对应于将与零奇异值相关联的奇异向量方向上的坐标设置为 $0$。因此，最小范数解 $y^{\\star}$ 为：\n$$\ny^{\\star} = \\begin{pmatrix} \\frac{3}{4\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}.\n$$\n现在我们变换回原始坐标以求得 $x^{\\star} = Vy^{\\star}$：\n$$\nx^{\\star} = \\begin{pmatrix} 0   1   0 \\\\ 1   0   0 \\\\ 0   0   -1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{4\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (0)(\\frac{3}{4\\sqrt{2}}) + (1)(-\\frac{1}{\\sqrt{2}}) + (0)(0) \\\\ (1)(\\frac{3}{4\\sqrt{2}}) + (0)(-\\frac{1}{\\sqrt{2}}) + (0)(0) \\\\ (0)(\\frac{3}{4\\sqrt{2}}) + (0)(-\\frac{1}{\\sqrt{2}}) + (-1)(0) \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\sqrt{2}} \\\\ \\frac{3}{4\\sqrt{2}} \\\\ 0 \\end{pmatrix}.\n$$\n最后，我们计算所需的标量 $w^{\\top}x^{\\star}$：\n$$\nw^{\\top}x^{\\star} = \\begin{pmatrix} 2   -1   0 \\end{pmatrix} \\begin{pmatrix} -\\frac{1}{\\sqrt{2}} \\\\ \\frac{3}{4\\sqrt{2}} \\\\ 0 \\end{pmatrix} = (2)\\left(-\\frac{1}{\\sqrt{2}}\\right) + (-1)\\left(\\frac{3}{4\\sqrt{2}}\\right) + (0)(0).\n$$\n$$\nw^{\\top}x^{\\star} = -\\frac{2}{\\sqrt{2}} - \\frac{3}{4\\sqrt{2}} = -\\frac{8}{4\\sqrt{2}} - \\frac{3}{4\\sqrt{2}} = -\\frac{11}{4\\sqrt{2}}.\n$$\n为了将答案写成标准的闭式形式，我们将分母有理化：\n$$\nw^{\\top}x^{\\star} = -\\frac{11}{4\\sqrt{2}} \\cdot \\frac{\\sqrt{2}}{\\sqrt{2}} = -\\frac{11\\sqrt{2}}{4 \\cdot 2} = -\\frac{11\\sqrt{2}}{8}.\n$$",
            "answer": "$$ \\boxed{-\\frac{11\\sqrt{2}}{8}} $$"
        },
        {
            "introduction": "对于秩亏的最小二乘问题，最小化残差的解并非唯一。这个练习将引导您探索整个解集的结构。您将亲自构建一个不同于最小范数解的替代解，并验证它们虽然都能最小化残差，但其自身的范数却不相同，从而深刻理解Moore-Penrose伪逆给出的解在所有可能解中的特殊地位。",
            "id": "3583032",
            "problem": "考虑由下式给出的实 $m \\times n$ 矩阵 $A$ 和向量 $b$：\n$$\nA = \\begin{pmatrix}\n1   2 \\\\\n2   4 \\\\\n3   6\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}\n3 \\\\ 1 \\\\ 3\n\\end{pmatrix}.\n$$\n仅使用奇异值分解 (SVD) 和最小二乘极小化子的基本定义，以及到子空间的正交投影的性质，执行以下步骤。\n\n1. 计算 $A$ 的一个显式奇异值分解，即找到正交矩阵 $U \\in \\mathbb{R}^{3 \\times 3}$ 和 $V \\in \\mathbb{R}^{2 \\times 2}$，以及一个对角线元素为非负的对角矩阵 $\\Sigma \\in \\mathbb{R}^{3 \\times 2}$，使得 $A = U \\Sigma V^{\\top}$。找出非零奇异值及其对应的奇异向量，并验证 $A$ 的秩亏性。\n\n2. 使用 SVD 和 Moore–Penrose 伪逆，计算 $\\min_{x \\in \\mathbb{R}^{2}} \\|A x - b\\|_{2}$ 的最小范数最小二乘解 $x^{\\dagger}$。\n\n3. 令 $v_{2}$ 表示您所作SVD中与 $A$ 的零奇异值相关联的右奇异向量。通过设置\n$$\nx_{\\mathrm{alt}} = x^{\\dagger} + \\frac{\\sqrt{5}}{5} \\, v_{2}.\n$$\n来构造一个替代的最小二乘极小化子。解释为什么 $x_{\\mathrm{alt}}$ 也是一个最小二乘极小化子，以及为什么对于这个 $A$，所有的最小二乘极小化子都具有相同的残差向量。\n\n4. 计算残差向量 $r = b - A x^{\\dagger}$ 及其2-范数的平方 $\\|r\\|_{2}^{2}$。计算 $\\|x^{\\dagger}\\|_{2}^{2}$ 和 $\\|x_{\\mathrm{alt}}\\|_{2}^{2}$ 的2-范数的平方，并确认残差相同而解的范数不同。\n\n最后，定义标量\n$$\nS \\;=\\; \\|r\\|_{2}^{2} \\;+\\; \\frac{\\|x_{\\mathrm{alt}}\\|_{2}^{2}}{\\|x^{\\dagger}\\|_{2}^{2}}.\n$$\n将最终量 $S$ 表示为一个精确值。不需要四舍五入。",
            "solution": "该问题是适定的，并包含完整求解所需的所有信息。我们按照列举的步骤进行。\n\n首先，我们计算矩阵 $A = \\begin{pmatrix} 1   2 \\\\ 2   4 \\\\ 3   6 \\end{pmatrix}$ 的奇异值分解 (SVD)。SVD 定义为 $A = U \\Sigma V^{\\top}$。为了求出奇异值和右奇异向量（$V$的列），我们分析矩阵 $A^{\\top}A$。\n$$ A^{\\top}A = \\begin{pmatrix} 1   2   3 \\\\ 2   4   6 \\end{pmatrix} \\begin{pmatrix} 1   2 \\\\ 2   4 \\\\ 3   6 \\end{pmatrix} = \\begin{pmatrix} 1+4+9   2+8+18 \\\\ 2+8+18   4+16+36 \\end{pmatrix} = \\begin{pmatrix} 14   28 \\\\ 28   56 \\end{pmatrix} $$\n$A^{\\top}A$ 的特征值 $\\lambda$ 可通过特征方程 $\\det(A^{\\top}A - \\lambda I) = 0$ 求得：\n$$ (14-\\lambda)(56-\\lambda) - 28^2 = \\lambda^2 - 70\\lambda + 784 - 784 = \\lambda(\\lambda - 70) = 0 $$\n特征值为 $\\lambda_1 = 70$ 和 $\\lambda_2 = 0$。奇异值是它们的平方根，即 $\\sigma_1 = \\sqrt{70}$ 和 $\\sigma_2 = 0$。由于只有一个非零奇异值，$A$ 的秩为 $1$，这证实了其秩亏性。\n\n右奇异向量 $v_1$ 和 $v_2$ 是 $A^{\\top}A$ 的单位化特征向量。\n对于 $\\lambda_1 = 70$，我们选择特征向量 $\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。单位化后得到 $v_1 = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n对于 $\\lambda_2 = 0$，我们选择 $\\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix}$。单位化后得到 $v_2 = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix}$。\n正交矩阵 $V$ 为 $V = \\begin{pmatrix} v_1   v_2 \\end{pmatrix} = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1   -2 \\\\ 2   1 \\end{pmatrix}$。\n\n接下来求左奇异向量（$U$ 的列）。对于非零奇异值，有 $u_i = \\frac{1}{\\sigma_i}Av_i$。\n$$ u_1 = \\frac{1}{\\sqrt{70}} A v_1 = \\frac{1}{\\sqrt{70}} \\begin{pmatrix} 1   2 \\\\ 2   4 \\\\ 3   6 \\end{pmatrix} \\frac{1}{\\sqrt{5}} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\frac{1}{\\sqrt{350}} \\begin{pmatrix} 5 \\\\ 10 \\\\ 15 \\end{pmatrix} = \\frac{1}{\\sqrt{14}}\\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} $$\n$U$ 的其余列 $u_2$ 和 $u_3$ 必须构成 $A$ 的左零空间（$A^{\\top}$ 的零空间）的一个标准正交基。该零空间由 $x+2y+3z=0$ 定义。我们可以选择两个正交向量 $\\begin{pmatrix} -2 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 和 $\\begin{pmatrix} 3 \\\\ 6 \\\\ -5 \\end{pmatrix}$，并将它们单位化得到 $u_2 = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} -2 \\\\ 1 \\\\ 0 \\end{pmatrix}$ 和 $u_3 = \\frac{1}{\\sqrt{70}}\\begin{pmatrix} 3 \\\\ 6 \\\\ -5 \\end{pmatrix}$。\n完整的 SVD 为：\n$A = U \\Sigma V^{\\top}$，其中 $U = \\begin{pmatrix} \\frac{1}{\\sqrt{14}}   \\frac{-2}{\\sqrt{5}}   \\frac{3}{\\sqrt{70}} \\\\ \\frac{2}{\\sqrt{14}}   \\frac{1}{\\sqrt{5}}   \\frac{6}{\\sqrt{70}} \\\\ \\frac{3}{\\sqrt{14}}   0   \\frac{-5}{\\sqrt{70}} \\end{pmatrix}$，$\\Sigma = \\begin{pmatrix} \\sqrt{70}   0 \\\\ 0   0 \\\\ 0   0 \\end{pmatrix}$，$V = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1   -2 \\\\ 2   1 \\end{pmatrix}$。\n\n其次，我们计算最小范数最小二乘解 $x^{\\dagger} = A^{\\dagger}b$，其中 $A^{\\dagger} = V \\Sigma^{\\dagger} U^{\\top}$。\n$\\Sigma$ 的伪逆是 $\\Sigma^{\\dagger} = \\begin{pmatrix} 1/\\sqrt{70}   0   0 \\\\ 0   0   0 \\end{pmatrix}$。\n$x^{\\dagger} = V \\Sigma^{\\dagger} U^{\\top}b = \\sum_{i=1}^{r} \\frac{u_i^\\top b}{\\sigma_i} v_i = \\frac{u_1^\\top b}{\\sigma_1} v_1$。\n$u_1^\\top b = \\frac{1}{\\sqrt{14}}(1 \\cdot 3 + 2 \\cdot 1 + 3 \\cdot 3) = \\frac{14}{\\sqrt{14}} = \\sqrt{14}$。\n$x^{\\dagger} = \\frac{\\sqrt{14}}{\\sqrt{70}} v_1 = \\frac{1}{\\sqrt{5}} \\left( \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} \\right) = \\frac{1}{5}\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1/5 \\\\ 2/5 \\end{pmatrix}$。\n\n第三，我们构造替代解 $x_{\\mathrm{alt}} = x^{\\dagger} + \\frac{\\sqrt{5}}{5} \\, v_{2}$。令 $c = \\frac{\\sqrt{5}}{5} = \\frac{1}{\\sqrt{5}}$，我们有：\n$$ x_{\\mathrm{alt}} = \\begin{pmatrix} 1/5 \\\\ 2/5 \\end{pmatrix} + \\frac{1}{\\sqrt{5}} \\left( \\frac{1}{\\sqrt{5}}\\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix} \\right) = \\begin{pmatrix} 1/5 \\\\ 2/5 \\end{pmatrix} + \\frac{1}{5}\\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1/5 \\\\ 3/5 \\end{pmatrix} $$\n$\\min_{x} \\|Ax-b\\|_2$ 的所有最小二乘解的集合由仿射子空间 $x^{\\dagger} + \\mathcal{N}(A)$ 给出，其中 $\\mathcal{N}(A)$ 是 $A$ 的零空间。与零奇异值对应的右奇异向量构成了 $\\mathcal{N}(A)$ 的一个标准正交基。此处，$\\mathcal{N}(A) = \\text{span}\\{v_2\\}$。因此，$x_{\\mathrm{alt}}$ 是一个有效的最小二乘解。其残差为 $A x_{\\mathrm{alt}} - b = A(x^{\\dagger} + c v_2) - b = (A x^{\\dagger} - b) + c(A v_2)$。由于 $v_2 \\in \\mathcal{N}(A)$，$A v_2 = 0$，所以 $x_{\\mathrm{alt}}$ 的残差与 $x^{\\dagger}$ 的残差相同。对于任何最小二乘解 $x_{LS}$，其残差向量为 $r = b - A x_{LS}$。向量 $A x_{LS}$ 是 $b$ 到 $A$ 的列空间 $\\mathcal{C}(A)$ 上的正交投影，这个投影是唯一的。因此，所有最小二乘极小化子的残差向量 $r$ 都相同。\n\n第四，我们计算所需的量。$x^{\\dagger}$ 的残差向量为：\n$$ r = b - Ax^{\\dagger} = \\begin{pmatrix} 3 \\\\ 1 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1   2 \\\\ 2   4 \\\\ 3   6 \\end{pmatrix} \\begin{pmatrix} 1/5 \\\\ 2/5 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 1 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\end{pmatrix} $$\n其2-范数的平方为 $\\|r\\|_2^2 = 2^2 + (-1)^2 + 0^2 = 5$。\n$x^{\\dagger}$ 的2-范数的平方为 $\\|x^{\\dagger}\\|_2^2 = (1/5)^2 + (2/5)^2 = 1/25 + 4/25 = 5/25 = 1/5$。\n$x_{\\mathrm{alt}}$ 的2-范数的平方为 $\\|x_{\\mathrm{alt}}\\|_2^2 = (-1/5)^2 + (3/5)^2 = 1/25 + 9/25 = 10/25 = 2/5$。\n解的范数不同，且 $\\|x_{\\mathrm{alt}}\\|_2^2  \\|x^{\\dagger}\\|_2^2$，这与 $x^{\\dagger}$ 是最小范数解的结论一致。\n\n最后，我们计算标量 $S$：\n$$ S = \\|r\\|_{2}^{2} + \\frac{\\|x_{\\mathrm{alt}}\\|_{2}^{2}}{\\|x^{\\dagger}\\|_{2}^{2}} = 5 + \\frac{2/5}{1/5} = 5 + 2 = 7 $$\n$S$ 的精确值为 $7$。",
            "answer": "$$\n\\boxed{7}\n$$"
        },
        {
            "introduction": "在数值计算中，选择正确的算法与理解理论同样重要。为什么在实践中我们倾向于使用计算成本更高的SVD方法，而非看似更直接的正规方程法？这个练习通过一个精心设计的病态问题，让您直面这两种方法的数值稳定性差异。通过计算和比较各自的条件数与误差界，您将量化地揭示正规方程法中“条件数平方”效应所带来的精度灾难，从而体会到SVD方法在保证计算结果可靠性方面的巨大优势。",
            "id": "3583055",
            "problem": "考虑由矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 和右侧项 $b \\in \\mathbb{R}^{2}$ 构成的超定最小二乘问题，其定义如下：\n$$\nA \\;=\\; \\begin{pmatrix}\n1   1 \\\\\n0   \\varepsilon\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n1 \\\\ \\varepsilon/2\n\\end{pmatrix},\n\\qquad\n\\varepsilon \\;=\\; 10^{-8}.\n$$\n您将分析求解最小二乘问题 $\\min_{x \\in \\mathbb{R}^{2}} \\|Ax-b\\|_{2}$ 的两种算法，并量化由条件效应和舍入误差引起的精度差异。\n\n使用以下基本概念，从第一性原理出发进行分析：\n- 奇异值分解（SVD），作为一种揭示实矩阵奇异值的矩阵分解方法。\n- 对于可逆矩阵 $A$，谱（二范数）条件数 $\\kappa_{2}(A) \\equiv \\|A\\|_{2}\\,\\|A^{-1}\\|_{2}$ 的定义，以及 $\\|A\\|_{2}$ 是最大奇异值。\n- 标准浮点模型，其中单位舍入误差 $u$ 定义为 $fl(a \\,\\mathrm{op}\\, b) = (a \\,\\mathrm{op}\\, b)(1+\\delta)$，且 $|\\delta| \\le u$，对于 IEEE 754 双精度，$u = 2^{-53}$。\n\n任务：\n1. 论证对于给定的数据，为什么最小二乘解与 $Ax=b$ 的精确解重合，并确定精确解 $x_{\\star}$。\n2. 通过分析 $A^{T}A$ 的特征值来计算 $A$ 的奇异值，并由此以 $\\varepsilon$ 的函数形式计算谱条件数 $\\kappa_{2}(A)$ 的精确符号形式。然后在 $\\varepsilon = 10^{-8}$ 时进行数值计算。\n3. 根据 $A^{T}A$ 的谱特性，确定正规方程矩阵 $A^{T}A$ 的谱条件数（用 $\\kappa_{2}(A)$ 表示），并证明您的结论。\n4. 在标准浮点模型和适用于以下方法的范数后向稳定性假设下，使用一阶扰动分析：\n   - 基于奇异值分解（SVD）的求解器，\n   - 构建正规方程然后使用后向稳定 Cholesky 分解的求解器，\n推导出计算解的前导阶相对前向误差界，用 $\\kappa_{2}(A)$、$\\kappa_{2}(A^{T}A)$ 和 $u$ 表示。\n5. 对于给定的 $A$、$\\varepsilon = 10^{-8}$ 和 $u = 2^{-53}$，对这些界进行数值计算。作为最终答案，报告基于正规方程方法预测的前导阶相对前向误差界的数值。将您的最终数值答案四舍五入到三位有效数字。",
            "solution": "该问题要求分析求解最小二乘问题 $\\min_{x \\in \\mathbb{R}^{2}} \\|Ax-b\\|_{2}$ 的两种方法。\n\n**任务1：论证为什么最小二乘解与 $Ax=b$ 的精确解重合，并确定此解。**\n给定矩阵 $A = \\begin{pmatrix} 1  1 \\\\ 0  \\varepsilon \\end{pmatrix}$ 是一个 $2 \\times 2$ 的方阵。其行列式为 $\\det(A) = (1)(\\varepsilon) - (1)(0) = \\varepsilon$。因为 $\\varepsilon = 10^{-8} \\neq 0$，矩阵 $A$ 是可逆的。对于一个可逆矩阵 $A$，线性系统 $Ax=b$ 有一个唯一解 $x_{\\star} = A^{-1}b$。将此解代入最小二乘问题的目标函数，我们得到 $\\|Ax_{\\star}-b\\|_{2} = 0$。由于范数总是非负的，这个值为零的解就是最小二乘问题的唯一解。\n我们通过回代法求解上三角系统 $Ax=b$：\n$$\n\\begin{pmatrix}\n1  1 \\\\\n0  \\varepsilon\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\\nx_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n\\varepsilon/2\n\\end{pmatrix}\n$$\n从第二行，我们有 $\\varepsilon x_2 = \\varepsilon/2$，这意味着 $x_2 = 1/2$。将此代入第一行方程 $x_1 + x_2 = 1$，我们得到 $x_1 = 1/2$。因此，精确解是 $x_{\\star} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix}$。\n\n**任务2：计算奇异值和谱条件数 $\\kappa_{2}(A)$。**\n$A$ 的奇异值 $\\sigma_i$ 是矩阵 $A^{T}A$ 特征值的平方根。\n$$\nA^T A = \\begin{pmatrix} 1  0 \\\\ 1  \\varepsilon \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1+\\varepsilon^2 \\end{pmatrix}\n$$\n其特征方程为 $\\det(A^T A - \\lambda I) = (1-\\lambda)(1+\\varepsilon^2-\\lambda) - 1 = \\lambda^2 - (2+\\varepsilon^2)\\lambda + \\varepsilon^2 = 0$。\n解得特征值为 $\\lambda = \\frac{2+\\varepsilon^2 \\pm \\sqrt{4+\\varepsilon^4}}{2}$。\n谱条件数 $\\kappa_2(A) = \\frac{\\sigma_1}{\\sigma_2} = \\sqrt{\\frac{\\lambda_1}{\\lambda_2}}$。化简可得其精确符号形式：\n$$\n\\kappa_2(A) = \\frac{2+\\varepsilon^2 + \\sqrt{4+\\varepsilon^4}}{2\\varepsilon}\n$$\n对于 $\\varepsilon = 10^{-8}$，$\\varepsilon^2$ 和 $\\varepsilon^4$ 的项可以忽略不计，因此 $\\kappa_2(A) \\approx \\frac{2+\\sqrt{4}}{2\\varepsilon} = \\frac{2}{\\varepsilon} = 2 \\times 10^8$。\n\n**任务3：确定 $A^T A$ 的谱条件数。**\n$A^T A$ 的特征值是 $A$ 的奇异值的平方，即 $\\sigma_1^2$ 和 $\\sigma_2^2$。因此，$A^T A$ 的谱条件数为：\n$$\n\\kappa_2(A^T A) = \\frac{\\lambda_{\\max}(A^T A)}{\\lambda_{\\min}(A^T A)} = \\frac{\\sigma_1^2}{\\sigma_2^2} = \\left(\\frac{\\sigma_1}{\\sigma_2}\\right)^2 = (\\kappa_2(A))^2\n$$\n\n**任务4：推导前导阶相对前向误差界。**\n设 $u$ 为单位舍入误差。\n- **基于SVD的求解器**：这是一种后向稳定的方法。计算解 $\\hat{x}_{SVD}$ 的前向误差由 $\\kappa_2(A)$ 控制。其前导阶相对前向误差界为：\n  $$\n  \\frac{\\|\\hat{x}_{SVD}-x_{\\star}\\|_2}{\\|x_{\\star}\\|_2} \\lesssim C_{SVD} \\, u \\kappa_2(A)\n  $$\n  其中 $C_{SVD}$ 是一个量级为 $O(1)$ 的常数。\n- **正规方程求解器**：此方法先计算 $A^T A$，再求解。该过程的数值稳定性由 $\\kappa_2(A^T A)$ 控制。其前导阶相对前向误差界为：\n  $$\n  \\frac{\\|\\hat{x}_{NE}-x_{\\star}\\|_2}{\\|x_{\\star}\\|_2} \\lesssim C_{NE} \\, u \\kappa_2(A^T A) = C_{NE} \\, u \\kappa_2(A)^2\n  $$\n  其中 $C_{NE}$ 也是一个量级为 $O(1)$ 的常数。\n\n**任务5：对误差界进行数值计算。**\n给定 $\\varepsilon = 10^{-8}$ 和 $u = 2^{-53} \\approx 1.1102 \\times 10^{-16}$。\n我们有 $\\kappa_2(A) \\approx 2 \\times 10^8$ 和 $\\kappa_2(A^T A) \\approx (2 \\times 10^8)^2 = 4 \\times 10^{16}$。\n正规方程方法预测的前导阶相对前向误差界为（假设 $C_{NE} \\approx 1$）：\n$$\n\\text{Error}_{NE} \\approx u \\kappa_2(A^T A) \\approx (1.1102 \\times 10^{-16}) \\times (4 \\times 10^{16}) = 4.4408\n$$\n四舍五入到三位有效数字，该值为 $4.44$。",
            "answer": "$$\n\\boxed{4.44}\n$$"
        }
    ]
}