{
    "hands_on_practices": [
        {
            "introduction": "Eckart-Young-Mirsky (EYM) 定理不仅是一个深刻的理论结果，它还为我们提供了计算给定矩阵最佳低秩逼近误差的精确公式。这项实践将引导你直接应用这些核心公式。通过处理一组给定的奇异值，你将亲手计算在弗罗贝尼乌斯范数 (${\\|\\cdot\\|}_{F}$) 和谱范数 (${\\|\\cdot\\|}_{2}$) 下的最小逼近误差，从而加深对定理实际应用的理解 。",
            "id": "3587148",
            "problem": "考虑一个秩为 $r$ 的实矩阵 $A \\in \\mathbb{R}^{m \\times n}$，并回顾奇异值分解（SVD）的定义 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是一个对角矩阵，其非负对角元为 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\dots \\geq \\sigma_{r}  0$，其余元素为零。Frobenius 范数 $\\| \\cdot \\|_{F}$ 定义为 $\\|X\\|_{F}^{2} = \\sum_{i=1}^{m} \\sum_{j=1}^{n} x_{ij}^{2}$，谱范数 $\\| \\cdot \\|_{2}$ 定义为 $\\|X\\|_{2} = \\max_{\\|y\\|_{2} = 1} \\|X y\\|_{2}$，它等于 $X$ 的最大奇异值。如果对于所有正交矩阵 $Q_{1}, Q_{2}$ 和所有矩阵 $X$ 都有 $\\|Q_{1} X Q_{2}\\| = \\|X\\|$，则范数 $\\|\\cdot\\|$ 称为酉不变范数。\n\n你将从第一性原理出发，利用 SVD、上述定义以及 $\\|\\cdot\\|_{F}$ 和 $\\|\\cdot\\|_{2}$ 都是酉不变范数这一事实，来分析矩阵 $A$ 的最佳秩 $k$ 近似。设矩阵 $A$ 的秩 $r = 8$，其奇异值为\n$$\n\\sigma_{1} = 14,\\ \\sigma_{2} = 10,\\ \\sigma_{3} = 7,\\ \\sigma_{4} = 5,\\ \\sigma_{5} = 3,\\ \\sigma_{6} = 2,\\ \\sigma_{7} = 1,\\ \\sigma_{8} = 0.5.\n$$\n对于目标秩 $k = 4$，计算任何秩为 $4$ 的矩阵对 $A$ 进行近似所能达到的最小 Frobenius 误差和最小谱误差。然后，对于给定的容差 $\\varepsilon = 3.5$，确定满足存在一个秩为 $k$ 的矩阵 $\\tilde{A}_{k}$ 使得 $\\|A - \\tilde{A}_{k}\\|_{F} \\leq \\varepsilon$ 的最小整数 $k$；并独立地确定满足存在一个秩为 $k$ 的矩阵 $A_{k}$ 使得 $\\|A - A_{k}\\|_{2} \\leq \\varepsilon$ 的最小整数 $k$。\n\n请精确表示 $k=4$ 时的两个最小误差（不要四舍五入），并将两个最小秩报告为整数。你的最终答案必须是一个单行矩阵，包含四个条目，顺序为：$k=4$ 时的最小 Frobenius 误差，$k=4$ 时的最小谱误差，满足 Frobenius 容差 $\\varepsilon$ 的最小 $k$ 值，满足谱容差 $\\varepsilon$ 的最小 $k$ 值。",
            "solution": "我们从奇异值分解 $A = U \\Sigma V^{\\top}$ 以及 Frobenius 范数和谱范数的定义开始。$\\|\\cdot\\|_{F}$ 和 $\\|\\cdot\\|_{2}$ 都是酉不变范数，因此对于任何候选的秩 $k$ 近似矩阵 $X$，误差 $\\|A - X\\|$ 仅取决于 $A - X$ 的奇异值，并且可以在对角的 SVD 坐标系中进行分析。\n\n一个秩为 $k$ 的矩阵 $X$ 可以写成 $X = U Y V^{\\top}$ 的形式，其中 $Y$ 的秩最多为 $k$。因为 $U$ 和 $V$ 是正交的，且所用范数是酉不变的，所以对于 $\\|\\cdot\\|_{F}$ 和 $\\|\\cdot\\|_{2}$ 两种范数，都有 $\\|A - X\\| = \\|\\Sigma - Y\\|$。因此，问题简化为用一个秩为 $k$ 的矩阵 $Y$ 来近似对角矩阵 $\\Sigma$，以最小化所选范数下的 $\\|\\Sigma - Y\\|$。\n\n对于 Frobenius 范数，其平方范数在正交方向上可加性分解：如果 $\\Sigma = \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{r},0,\\dots)$ 且 $Y$ 的奇异值为 $\\tau_{1},\\dots,\\tau_{k}$ 并排列在对角线上（所有其他对角元为零），那么\n$$\n\\|\\Sigma - Y\\|_{F}^{2} = \\sum_{i=1}^{m} \\sum_{j=1}^{n} (\\Sigma - Y)_{ij}^{2} = \\sum_{j=1}^{r} (\\sigma_{j} - \\tau_{j})^{2} + \\sum_{jr} 0,\n$$\n当 $Y$ 在相同基下选择为对角矩阵时。在 $\\tau_{j} \\geq 0$ 和最多 $k$ 个非零元的约束下，对秩最多为 $k$ 的对角矩阵 $Y$ 进行最小化，是通过匹配 $k$ 个最大的对角元并将剩余的对角元设为零来实现的，因为 Frobenius 范数在对角坐标系下简化为欧几里得距离，并且对于 $j \\leq k$，任何偏离 $\\sigma_{j}$ 的值都会增加平方和。因此，最优选择是 $Y = \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{k},0,\\dots)$，最小 Frobenius 误差为\n$$\n\\min_{\\operatorname{rank}(X) \\leq k} \\|A - X\\|_{F} = \\|\\Sigma - \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{k},0,\\dots)\\|_{F} = \\left(\\sum_{j=k+1}^{r} \\sigma_{j}^{2}\\right)^{1/2}.\n$$\n这个结论是正交不变性和 Frobenius 范数在 SVD 基下的毕达哥拉斯分解的直接推论。\n\n对于谱范数，$\\|A - X\\|_{2}$ 等于 $A - X$ 的最大奇异值。在 SVD 坐标系中，选择对角的 $Y$ 并保留 $\\Sigma$ 的前 $k$ 个奇异值，得到 $A - X = U(\\Sigma - \\Sigma_{k})V^{\\top}$，其中 $\\Sigma_{k} = \\operatorname{diag}(\\sigma_{1},\\dots,\\sigma_{k},0,\\dots)$。矩阵 $\\Sigma - \\Sigma_{k}$ 是对角矩阵，其对角元为 $\\sigma_{k+1},\\dots,\\sigma_{r}$（其余为零），因此其最大奇异值为 $\\sigma_{k+1}$。一个关于酉不变范数（可视为奇异值的对称规范函数）的标准优势化(majorization)论证表明，对于任何其他秩为 $k$ 的 $Y$ 的选择，都不可能在不将秩增加到 $k$ 以上的情况下，将最大奇异值减小到 $\\sigma_{k+1}$ 以下。这是因为移除或减弱前 $k$ 个奇异方向中的任何一个，都会在残差中留下一个至少与 $\\sigma_{k+1}$ 一样大的奇异值。因此，\n$$\n\\min_{\\operatorname{rank}(X) \\leq k} \\|A - X\\|_{2} = \\sigma_{k+1}.\n$$\n现在我们将这些一般性结论应用于给定的数据。奇异值为\n$$\n\\sigma_{1} = 14,\\ \\sigma_{2} = 10,\\ \\sigma_{3} = 7,\\ \\sigma_{4} = 5,\\ \\sigma_{5} = 3,\\ \\sigma_{6} = 2,\\ \\sigma_{7} = 1,\\ \\sigma_{8} = 0.5,\n$$\n且 $k = 4$。\n\n1. $k = 4$ 时的最小 Frobenius 误差：\n$$\n\\left(\\sum_{j=5}^{8} \\sigma_{j}^{2}\\right)^{1/2} = \\left(3^{2} + 2^{2} + 1^{2} + 0.5^{2}\\right)^{1/2} = \\left(9 + 4 + 1 + 0.25\\right)^{1/2} = \\left(\\frac{57}{4}\\right)^{1/2} = \\frac{\\sqrt{57}}{2}.\n$$\n\n2. $k = 4$ 时的最小谱误差：\n$$\n\\sigma_{5} = 3.\n$$\n\n3. 达到 Frobenius 容差 $\\varepsilon = 3.5$ 的最小 $k$ 值：\n我们需要\n$$\n\\left(\\sum_{j=k+1}^{8} \\sigma_{j}^{2}\\right)^{1/2} \\leq 3.5 \\quad \\Longleftrightarrow \\quad \\sum_{j=k+1}^{8} \\sigma_{j}^{2} \\leq 12.25.\n$$\n计算尾部和：\n- 对于 $k = 4$，$\\sum_{j=5}^{8} \\sigma_{j}^{2} = 9 + 4 + 1 + 0.25 = 14.25  12.25$。\n- 对于 $k = 5$，$\\sum_{j=6}^{8} \\sigma_{j}^{2} = 4 + 1 + 0.25 = 5.25 \\leq 12.25$。\n因此最小的 $k$ 是 $k = 5$。\n\n4. 达到谱容差 $\\varepsilon = 3.5$ 的最小 $k$ 值：\n我们需要\n$$\n\\sigma_{k+1} \\leq 3.5.\n$$\n检查该序列，$\\sigma_{4} = 5  3.5$ 而 $\\sigma_{5} = 3 \\leq 3.5$，所以最小的 $k$ 是 $k = 4$。\n\n按指定顺序收集这四个所求的量，得到最终的行矩阵\n$$\n\\left( \\frac{\\sqrt{57}}{2},\\ 3,\\ 5,\\ 4 \\right).\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\sqrt{57}}{2}  3  5  4\\end{pmatrix}}$$"
        },
        {
            "introduction": "EYM 定理的普适性严格依赖于一个关键前提：范数必须是酉不变的。这项练习旨在挑战你探索当此条件不满足时会发生什么。通过为逐元 ${\\ell}_{\\infty}$ 范数（一种非酉不变范数）构建一个具体的反例 ，你将发现为何SVD截断不再能保证最佳逼近，并深刻体会到酉不变性在低秩逼近理论中的核心地位。",
            "id": "3587141",
            "problem": "考虑在 $\\mathbb{R}^{m \\times n}$ 上定义的逐项 $\\ell_{\\infty}$ 范数 $\\|E\\|_{\\infty} = \\max_{i,j} |E_{i j}|$。回顾一下，矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 的奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵（在复数情况下是酉矩阵），$\\Sigma$ 是对角矩阵，其对角线上的元素为非负值（即奇异值）。如果对于所有正交（酉）矩阵 $U$ 和 $V$ 都有 $\\|U A V^{\\top}\\| = \\|A\\|$，那么矩阵上的范数 $\\|\\cdot\\|$ 就被称为酉不变范数。Eckart-Young-Mirsky 定理断言，对于任何酉不变范数，将 $A$ 的奇异值分解截断到秩 $k$ 会得到 $A$ 的一个最佳秩-$k$ 近似。\n\n你的任务是：\n\n- 构建一个具体的反例，以表明在逐项 $\\ell_{\\infty}$ 范数下，截断可能不是最优的。具体来说，令 $A \\in \\mathbb{R}^{2 \\times 2}$ 为单位矩阵 $A = I_{2}$，并固定其 SVD 为 $A = U \\Sigma V^{\\top}$，其中 $U = I_{2}$，$V = I_{2}$，且 $\\Sigma = I_{2}$。令 $A_{1}$ 表示在该固定 SVD 下只保留主奇异分量的秩-1 截断。\n\n- 计算 $\\|A - A_{1}\\|_{\\infty}$ 的值。\n\n- 确定在所有秩-1 矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$ 上 $\\|A - X\\|_{\\infty}$ 的可能最小值，并给出一个达到此最小值的秩-1 矩阵。\n\n- 报告数值差距\n$$\n\\Delta \\;=\\; \\|A - A_{1}\\|_{\\infty} \\;-\\; \\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty}.\n$$\n\n- 最后，从上述定义出发，不引用任何预先陈述的定理，解释为什么酉不变性在 Eckart-Young-Mirsky 定理的结论中是至关重要的，以及为什么该结论不能推广到逐项 $\\ell_{\\infty}$ 范数。你的解释应从第一性原理出发，论述正交基变换如何影响逐项范数与酉不变范数。\n\n提供 $\\Delta$ 的值作为你的最终答案。无需四舍五入。",
            "solution": "首先验证问题以确保其有科学依据、是良定的和客观的。\n\n### 第 1 步：提取已知条件\n- 范数是 $\\mathbb{R}^{m \\times n}$ 上的逐项 $\\ell_{\\infty}$ 范数：$\\|E\\|_{\\infty} = \\max_{i,j} |E_{i j}|$。\n- 如果对于所有正交矩阵 $U, V$ 都有 $\\|U A V^{\\top}\\| = \\|A\\|$，则范数 $\\|\\cdot\\|$ 是酉不变的。\n- Eckart-Young-Mirsky (EYM) 定理指出，对于酉不变范数，将矩阵 $A$ 的奇异值分解 (SVD) 截断到秩-$k$ 会得到一个最佳秩-$k$ 近似。\n- 具体矩阵是 $A = I_{2} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n- $A$ 的固定 SVD 为 $A = U \\Sigma V^{\\top}$，其中 $U = I_{2}$，$\\Sigma = I_{2}$，且 $V = I_{2}$。\n- $A_{1}$ 是此 SVD 的秩-1 截断。\n- 任务是计算 $\\|A - A_{1}\\|_{\\infty}$，找到 $\\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty}$，计算差距 $\\Delta = \\|A - A_{1}\\|_{\\infty} - \\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty}$，并解释酉不变性的作用。\n\n### 第 2 步：使用提取的已知条件进行验证\n问题是有效的。\n- **科学依据**：该问题是数值线性代数中的一个标准练习，基于广为接受的 Eckart-Young-Mirsky 定理和标准矩阵范数。所有定义都是正确的。\n- **良定性**：问题陈述清晰，要求具体的、可计算的量和一个概念性解释。它有一个唯一且稳定的解。\n- **客观性**：语言精确且数学化，没有歧义或主观论断。\n所有其他验证标准均已满足。该问题是一个精心构建的反例，用以说明一个重要定理的关键条件。\n\n### 第 3 步：结论与行动\n问题是有效的。我们继续进行求解。\n\n### 第 1 部分：计算 $\\|A - A_{1}\\|_{\\infty}$\n矩阵是 $A = I_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。给定的 SVD 是 $A = U \\Sigma V^{\\top}$，其中 $U=I_2$，$V=I_2$，且 $\\Sigma=I_2$。奇异值为 $\\sigma_1=1$ 和 $\\sigma_2=1$。奇异向量是 $u_1 = v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $u_2 = v_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n完整的 SVD 展开式为 $A = \\sigma_1 u_1 v_1^{\\top} + \\sigma_2 u_2 v_2^{\\top}$。\n秩-1 SVD 截断 $A_1$ 是通过只保留首项得到的：\n$$\nA_1 = \\sigma_1 u_1 v_1^{\\top} = 1 \\cdot \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n近似误差是矩阵 $A - A_1$：\n$$\nA - A_1 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}\n$$\n这个误差的逐项 $\\ell_{\\infty}$ 范数是其元素绝对值的最大值：\n$$\n\\|A - A_1\\|_{\\infty} = \\max \\{|0|, |0|, |0|, |1|\\} = 1\n$$\n\n### 第 2 部分：确定 $\\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty}$\n我们寻求在所有秩-1 矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$ 上找到 $\\|I_2 - X\\|_{\\infty}$ 的最小值。\n一个秩-1 矩阵 $X$ 的行列式必须为零。令 $E = I_2 - X$ 为误差矩阵。那么 $X = I_2 - E$。$X$ 的秩为 1（或 0）的条件是 $\\det(X) = 0$。\n$$\n\\det(I_2 - E) = 0\n$$\n令 $E = \\begin{pmatrix} e_{11}  e_{12} \\\\ e_{21}  e_{22} \\end{pmatrix}$。该条件变为：\n$$\n\\det \\begin{pmatrix} 1-e_{11}  -e_{12} \\\\ -e_{21}  1-e_{22} \\end{pmatrix} = (1-e_{11})(1-e_{22}) - (-e_{12})(-e_{21}) = 0\n$$\n$$\n1 - e_{11} - e_{22} + e_{11}e_{22} - e_{12}e_{21} = 0\n$$\n我们想要在此约束条件下最小化 $\\epsilon = \\|E\\|_{\\infty} = \\max_{i,j} |e_{ij}|$。\n这意味着对于所有的 $i,j \\in \\{1,2\\}$，都有 $|e_{ij}| \\le \\epsilon$。\n条件 $\\det(X) = 0$ 可以重写为 $x_{11}x_{22} - x_{12}x_{21} = 0$，对于 $X = \\begin{pmatrix} x_{11}  x_{12} \\\\ x_{21}  x_{22} \\end{pmatrix}$。\n$X$ 的元素通过 $x_{ij} = (\\delta_{ij} - e_{ij})$ 与误差元素相关，其中 $\\delta_{ij}$ 是克罗内克 δ 符号。\n所以 $x_{11} = 1-e_{11}$，$x_{22} = 1-e_{22}$，$x_{12} = -e_{12}$，$x_{21} = -e_{21}$。\n条件是 $(1-e_{11})(1-e_{22}) - (-e_{12})(-e_{21}) = 0$。\n这和之前的方程是一样的。现在我们来使用界限。\n$|e_{12}| \\le \\epsilon$ 和 $|e_{21}| \\le \\epsilon$，所以 $|e_{12}e_{21}| \\le \\epsilon^2$。\n$|1-e_{11}| \\le \\epsilon \\implies 1-\\epsilon \\le e_{11} \\le 1+\\epsilon$。\n$|1-e_{22}| \\le \\epsilon \\implies 1-\\epsilon \\le e_{22} \\le 1+\\epsilon$。\n如果 $\\epsilon  1$，那么 $1-\\epsilon  0$，所以 $e_{11}$ 和 $e_{22}$ 必须是正数。\n从行列式条件可知：\n$$\n(1-e_{11})(1-e_{22}) = e_{12}e_{21}\n$$\n取绝对值：\n$$\n|(1-e_{11})(1-e_{22})| = |e_{12}e_{21}| \\le \\epsilon^2\n$$\n左边可以从下方定界。由于 $|1-e_{11}| \\le \\epsilon$，我们有 $|1-e_{11}| \\ge 0$。\n啊，这不是正确的方法。让我们直接使用 $X$。\n令 $\\epsilon = \\min_{\\operatorname{rank}(X)=1} \\|I_2 - X\\|_{\\infty}$。那么对于一个最优的 $X$，我们有：\n$|1-x_{11}| \\le \\epsilon$， $|-x_{12}| \\le \\epsilon$， $|-x_{21}| \\le \\epsilon$， $|1-x_{22}| \\le \\epsilon$。\n这意味着 $|x_{12}| \\le \\epsilon$ 和 $|x_{21}| \\le \\epsilon$。\n同时，$1-\\epsilon \\le x_{11} \\le 1+\\epsilon$ 和 $1-\\epsilon \\le x_{22} \\le 1+\\epsilon$。\n最小的 $\\epsilon$ 必须小于 1（根据我们的 SVD 结果），所以我们可以假设 $\\epsilon  1$。这意味着 $1-\\epsilon0$，所以 $x_{11}$ 和 $x_{22}$ 必须是正数。\n秩-1 条件是 $x_{11}x_{22} = x_{12}x_{21}$。\n取模并使用界限，我们得到：\n$$\nx_{11}x_{22} = |x_{12}x_{21}| = |x_{12}| |x_{21}| \\le \\epsilon \\cdot \\epsilon = \\epsilon^2\n$$\n使用 $x_{11}$ 和 $x_{22}$ 的下界：\n$$\nx_{11}x_{22} \\ge (1-\\epsilon)(1-\\epsilon) = (1-\\epsilon)^2\n$$\n结合这两个不等式：\n$$\n(1-\\epsilon)^2 \\le x_{11}x_{22} \\le \\epsilon^2\n$$\n这要求 $(1-\\epsilon)^2 \\le \\epsilon^2$。因为 $1-\\epsilon  0$ 且 $\\epsilon \\ge 0$，我们可以开平方根：\n$$\n1 - \\epsilon \\le \\epsilon \\implies 1 \\le 2\\epsilon \\implies \\epsilon \\ge \\frac{1}{2}\n$$\n所以可能的最小误差至少是 $1/2$。我们可以证明这个最小值是可达到的。让我们构建一个秩-1 矩阵 $X$ 使得 $\\|I_2 - X\\|_{\\infty} = 1/2$。\n考虑 $X = \\begin{pmatrix} 1/2  1/2 \\\\ 1/2  1/2 \\end{pmatrix}$。这个矩阵的秩为 1，因为它的行是相同的。\n误差矩阵是：\n$$\nI_2 - X = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1/2  1/2 \\\\ 1/2  1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2  -1/2 \\\\ -1/2  1/2 \\end{pmatrix}\n$$\n这个误差的 $\\ell_{\\infty}$ 范数是 $\\|I_2 - X\\|_{\\infty} = \\max\\{|1/2|, |-1/2|\\} = 1/2$。\n因为我们证明了下界是 $1/2$ 并找到了一个达到该下界的矩阵，所以最小值恰好是 $1/2$。\n$$\n\\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty} = \\frac{1}{2}\n$$\n\n### 第 3 部分：计算差距 $\\Delta$\n差距是 SVD 截断的误差与真实最小误差之间的差值。\n$$\n\\Delta = \\|A - A_{1}\\|_{\\infty} - \\min_{\\operatorname{rank}(X) = 1} \\|A - X\\|_{\\infty} = 1 - \\frac{1}{2} = \\frac{1}{2}\n$$\n\n### 第 4 部分：关于酉不变性的解释\nEckart-Young-Mirsky 定理的结论从根本上依赖于范数的酉不变性。如果一个范数 $\\|\\cdot\\|$ 在正交基变换下保持不变，即对于所有正交矩阵 $U$ 和 $V$ 都有 $\\|UAV^\\top\\| = \\|A\\|$，那么它就是酉不变的。像弗罗贝尼乌斯范数 $\\|\\cdot\\|_F$ 和谱范数 $\\|\\cdot\\|_2$ 这样的范数只依赖于矩阵的奇异值，而不依赖于奇异向量。\n\nEYM 定理的证明利用了这一性质。对于矩阵 $A = U\\Sigma V^\\top$，通过酉不变性，将秩-$k$ 矩阵 $X$ 上最小化 $\\|A-X\\|$ 的问题变换为：\n$$\n\\|A-X\\| = \\|U\\Sigma V^\\top - X\\| = \\|U^\\top(U\\Sigma V^\\top - X)V\\| = \\|\\Sigma - U^\\top XV\\|\n$$\n由于 $X$ 是任意秩-$k$ 矩阵，$Y = U^\\top XV$ 也是任意秩-$k$ 矩阵。问题被简化为寻找对角矩阵 $\\Sigma$ 的最佳秩-$k$ 近似。对于一个对角矩阵，直观上最佳近似是保留 $k$ 个最大的元素并将其他元素清零。这对应于 $Y$ 是一个对角矩阵，其对角线上是前 $k$ 个奇异值，这又意味着 $X=A_k$，即 $A$ 的截断 SVD。\n\n逐项 $\\ell_{\\infty}$ 范数不是酉不变的。它测量矩阵中的最大元素 $|A_{ij}| = |e_i^\\top A e_j|$，这明确地依赖于标准基 $\\{e_i\\}$。正交变换会混合矩阵的元素，并可能改变它们的最大幅值。例如，令 $A = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$，则 $\\|A\\|_\\infty = 1$。令 $U=V=\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix}$（一个旋转矩阵）。那么 $B = UAV^\\top = \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$，且 $\\|B\\|_\\infty = 1/2$。由于 $\\|A\\|_\\infty \\neq \\|B\\|_\\infty$，该范数不是酉不变的。\n\n这种不变性的失效意味着我们不能通过将其变换到奇异向量基来简化最小化问题。最小化 $\\|A-X\\|_\\infty$ 的问题必须在原始的标准基中解决。\n\n我们使用 $A = I_2$ 的反例完美地说明了这一点。\n- SVD 截断 $A_1 = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$ 产生的误差矩阵为 $A-A_1 = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}$。误差完全集中在单个元素中，导致最大误差为 $\\|A-A_1\\|_\\infty = 1$。\n- 最优的秩-1 近似是 $X = \\frac{1}{2}\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}$，这导致的误差矩阵为 $A-X = \\begin{pmatrix} 1/2  -1/2 \\\\ -1/2  1/2 \\end{pmatrix}$。在这里，总误差被“分散”到所有元素中。因为 $\\ell_\\infty$ 范数只关注单个最大元素，所以这种分散策略是有效的，将误差的范数减小到 $1/2$。\n\n本质上，SVD 在与基无关的意义上提供了最优的低秩近似。那些不具有基无关性（酉不变性）的范数“看不到”这种最优性。对于 $\\ell_\\infty$ 范数，找到一个用小误差污染所有元素的近似，要比一个能将某些分量完美清零但却在别处留下大的、集中的误差的近似更好。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "在理论数学的理想世界与实际计算的现实之间架起一座桥梁至关重要。现实世界中的SVD计算会受到浮点舍入误差的影响，这可能会影响理论最优性。这项高级练习将指导你进行一次后向误差分析 ，以量化这些计算扰动如何影响EYM定理提供的逼近误差，并确保计算出的低秩逼近仍然是可靠的。",
            "id": "3587135",
            "problem": "设 $A \\in \\mathbb{R}^{m \\times n}$ 且 $m \\geq n$，考虑在单位舍入误差为 $u$ 的浮点运算中计算其奇异值分解（singular value decomposition, SVD）。假设计算出的 SVD 满足后向稳定性模型：存在一个扰动 $\\Delta A$，使得计算出的因子 $(\\widehat{U}, \\widehat{\\Sigma}, \\widehat{V})$ 是 $A + \\Delta A$ 的精确 SVD，并且扰动满足 $\\|\\Delta A\\|_{2} \\leq \\gamma_{mn}\\, u\\, \\|A\\|_{2}$，其中 $\\gamma_{mn}$ 是一个给定的适中常数。定义计算出的秩-$k$ 截断为 $\\widehat{A}_{k} \\coloneqq \\widehat{U}_{:,1:k}\\,\\widehat{\\Sigma}_{1:k,1:k}\\,\\widehat{V}_{:,1:k}^{\\top}$。设 $\\|\\cdot\\|_{g}$ 是任意酉不变范数。\n\n仅使用酉不变范数的基本性质（酉不变性和三角不等式）、最佳秩-$k$ 近似误差的变分刻画以及奇异值的标准扰动界，解决以下问题：\n\n1) 推导双边加性界，将计算出的截断误差 $\\|A - \\widehat{A}_{k}\\|_{g}$ 与 $A$ 在相同范数下的最佳秩-$k$ 误差联系起来。你的界应明确指出 $\\|\\Delta A\\|_{g}$ 是如何引入的。\n\n2) 将你的界特化到谱范数 $\\|\\cdot\\|_{2}$ 上，以获得关于比率 $\\rho \\coloneqq \\dfrac{\\|A - \\widehat{A}_{k}\\|_{2}}{\\sigma_{k+1}(A)}$ 的显式界，该界用 $\\|\\Delta A\\|_{2}$ 和 $\\sigma_{k+1}(A)$ 表示，其中 $\\sigma_{k+1}(A)$ 是 $A$ 的第 $(k+1)$ 个奇异值。\n\n3) 对于具体数据 $m = n = 100$, $\\gamma_{mn} = 10 n$, $u = 2^{-53}$, $\\|A\\|_{2} = 10$ 和 $\\sigma_{k+1}(A) = 5.5 \\times 10^{-11}$，计算由第 2) 部分的界所隐含的 $\\rho$ 的最大可能值。将你的答案四舍五入到四位有效数字。只报告 $\\rho$ 的数值，不带单位。",
            "solution": "该问题是有效的，因为它基于数值线性代数，提法严谨且客观。它提出了一个关于在存在后向误差时截断 SVD 精度的标准但非平凡的问题。\n\n设 $A \\in \\mathbb{R}^{m \\times n}$ 且 $m \\geq n$。计算出的奇异值分解（SVD）$(\\widehat{U}, \\widehat{\\Sigma}, \\widehat{V})$ 是一个扰动矩阵 $A + \\Delta A$ 的精确 SVD，其中扰动有界 $\\|\\Delta A\\|_{2} \\leq \\gamma_{mn}\\, u\\, \\|A\\|_{2}$。计算出的秩-$k$ 截断为 $\\widehat{A}_{k} \\coloneqq \\widehat{U}_{:,1:k}\\,\\widehat{\\Sigma}_{1:k,1:k}\\,\\widehat{V}_{:,1:k}^{\\top}$。根据 Eckart-Young-Mirsky 定理，在任何酉不变范数 $\\|\\cdot\\|_{g}$ 下，$\\widehat{A}_{k}$ 是 $A + \\Delta A$ 的最佳秩-$k$ 近似。\n\n设 $E_k(M)$ 表示在范数 $\\|\\cdot\\|_g$ 下对矩阵 $M$ 的最佳秩-$k$ 近似的误差。即，$E_k(M) \\coloneqq \\min_{\\text{rank}(B)=k} \\|M - B\\|_g$。用这个记号，$\\widehat{A}_k$ 是 $A+\\Delta A$ 的最佳秩-$k$ 近似这一事实可以表示为 $\\|(A+\\Delta A) - \\widehat{A}_k\\|_g = E_k(A+\\Delta A)$。原始矩阵 $A$ 的最佳秩-$k$ 误差是 $E_k(A)$。\n\n**1) 双边加性界的推导**\n\n首先，我们为最佳近似误差 $E_k(\\cdot)$ 建立一个扰动界。对于任意秩-$k$ 矩阵 $B_k$，三角不等式给出\n$$ E_k(A+\\Delta A) = \\min_{\\text{rank}(B)=k} \\|(A+\\Delta A) - B\\|_g \\leq \\|(A+\\Delta A) - B_k\\|_g \\leq \\|A-B_k\\|_g + \\|\\Delta A\\|_g. $$\n由于这对任何秩-$k$ 矩阵 $B_k$ 都成立，因此它也必须对使 $\\|A-B_k\\|_g$ 最小化的那个矩阵成立。因此，\n$$ E_k(A+\\Delta A) \\leq E_k(A) + \\|\\Delta A\\|_g. $$\n通过一个对称的论证，交换 $A$ 和 $A+\\Delta A$ 的角色（并使用 $-\\Delta A$ 作为扰动），我们有\n$$ E_k(A) \\leq E_k(A+\\Delta A) + \\|-\\Delta A\\|_g = E_k(A+\\Delta A) + \\|\\Delta A\\|_g. $$\n这意味着 $E_k(A+\\Delta A) \\geq E_k(A) - \\|\\Delta A\\|_g$。结合这两个不等式，得到最佳秩-$k$ 近似误差的扰动结果：\n$$ |E_k(A+\\Delta A) - E_k(A)| \\leq \\|\\Delta A\\|_g. $$\n现在我们来界定计算出的截断误差 $\\|A - \\widehat{A}_k\\|_g$。我们对表达式 $A - \\widehat{A}_k = ((A+\\Delta A) - \\widehat{A}_k) - \\Delta A$ 使用三角不等式。\n\n对于上界：\n$$ \\|A - \\widehat{A}_k\\|_g \\leq \\|(A+\\Delta A) - \\widehat{A}_k\\|_g + \\|\\Delta A\\|_g $$\n$$ \\|A - \\widehat{A}_k\\|_g \\leq E_k(A+\\Delta A) + \\|\\Delta A\\|_g. $$\n使用扰动结果 $E_k(A+\\Delta A) \\leq E_k(A) + \\|\\Delta A\\|_g$，我们得到：\n$$ \\|A - \\widehat{A}_k\\|_g \\leq (E_k(A) + \\|\\Delta A\\|_g) + \\|\\Delta A\\|_g = E_k(A) + 2\\|\\Delta A\\|_g. $$\n对于下界，我们使用反向三角不等式：\n$$ \\|A - \\widehat{A}_k\\|_g \\geq \\|(A+\\Delta A) - \\widehat{A}_k\\|_g - \\|\\Delta A\\|_g $$\n$$ \\|A - \\widehat{A}_k\\|_g \\geq E_k(A+\\Delta A) - \\|\\Delta A\\|_g. $$\n使用扰动结果 $E_k(A+\\Delta A) \\geq E_k(A) - \\|\\Delta A\\|_g$，我们得到：\n$$ \\|A - \\widehat{A}_k\\|_g \\geq (E_k(A) - \\|\\Delta A\\|_g) - \\|\\Delta A\\|_g = E_k(A) - 2\\|\\Delta A\\|_g. $$\n结合这些结果，得到连接计算截断误差与最佳秩-$k$ 误差的双边加性界：\n$$ E_k(A) - 2\\|\\Delta A\\|_g \\leq \\|A - \\widehat{A}_k\\|_g \\leq E_k(A) + 2\\|\\Delta A\\|_g. $$\n\n**2) 特化到谱范数**\n\n对于谱范数 $\\|\\cdot\\|_g = \\|\\cdot\\|_2$，Eckart-Young-Mirsky 定理指出最佳秩-$k$ 近似误差是第 $(k+1)$ 个奇异值。因此，$E_k(A) = \\sigma_{k+1}(A)$。\n将此代入第 1 部分的界中，得到：\n$$ \\sigma_{k+1}(A) - 2\\|\\Delta A\\|_2 \\leq \\|A - \\widehat{A}_k\\|_2 \\leq \\sigma_{k+1}(A) + 2\\|\\Delta A\\|_2. $$\n问题定义了比率 $\\rho \\coloneqq \\dfrac{\\|A - \\widehat{A}_{k}\\|_{2}}{\\sigma_{k+1}(A)}$。假设 $\\sigma_{k+1}(A)  0$，我们可以用 $\\sigma_{k+1}(A)$ 除以该不等式：\n$$ \\frac{\\sigma_{k+1}(A) - 2\\|\\Delta A\\|_2}{\\sigma_{k+1}(A)} \\leq \\rho \\leq \\frac{\\sigma_{k+1}(A) + 2\\|\\Delta A\\|_2}{\\sigma_{k+1}(A)}. $$\n这可以简化为关于 $\\rho$ 的显式界：\n$$ 1 - \\frac{2\\|\\Delta A\\|_2}{\\sigma_{k+1}(A)} \\leq \\rho \\leq 1 + \\frac{2\\|\\Delta A\\|_2}{\\sigma_{k+1}(A)}. $$\n\n**3) $\\rho$ 的最大可能值的计算**\n\n从第 2 部分推导出的界，$\\rho$ 的最大可能值由上界给出：\n$$ \\rho_{\\max} = 1 + \\frac{2\\|\\Delta A\\|_2}{\\sigma_{k+1}(A)}. $$\n为了找到该界所隐含的 $\\rho$ 的最大值，我们必须使用后向稳定性模型给出的 $\\|\\Delta A\\|_2$ 的最大可能值：\n$$ \\|\\Delta A\\|_2 \\leq \\gamma_{mn}\\, u\\, \\|A\\|_{2}. $$\n因此，$\\rho$ 的界的最大值为：\n$$ \\rho_{\\max} \\leq 1 + \\frac{2\\, \\gamma_{mn}\\, u\\, \\|A\\|_2}{\\sigma_{k+1}(A)}. $$\n我们有以下给定数据：\n$m = 100$, $n = 100$。\n$\\gamma_{mn} = 10n = 10 \\times 100 = 1000$。\n$u = 2^{-53}$。\n$\\|A\\|_2 = 10$。\n$\\sigma_{k+1}(A) = 5.5 \\times 10^{-11}$。\n\n将这些值代入 $\\rho$ 的最大值表达式中：\n$$ \\rho_{\\max} \\leq 1 + \\frac{2 \\times 1000 \\times 2^{-53} \\times 10}{5.5 \\times 10^{-11}} $$\n$$ \\rho_{\\max} \\leq 1 + \\frac{2 \\times 10^4 \\times 2^{-53}}{5.5 \\times 10^{-11}}. $$\n我们计算分式项的值。单位舍入误差 $u = 2^{-53}$ 约等于 $1.110223 \\times 10^{-16}$。\n$$ \\frac{2 \\times 10^4 \\times (1.110223 \\times 10^{-16})}{5.5 \\times 10^{-11}} = \\frac{2.220446 \\times 10^{-12}}{5.5 \\times 10^{-11}} = \\frac{2.220446}{55} \\approx 0.0403717. $$\n因此，该界所隐含的 $\\rho$ 的最大值为：\n$$ \\rho_{\\max} \\approx 1 + 0.0403717 = 1.0403717. $$\n将此结果四舍五入到四位有效数字，得到 $1.040$。",
            "answer": "$$\n\\boxed{1.040}\n$$"
        }
    ]
}