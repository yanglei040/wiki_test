{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握高斯消元法的效率，我们不能仅仅满足于它是一个 $O(n^3)$ 算法的结论。这个首个练习邀请您从底层算法结构出发，推导其所需浮点运算的确切数量，为后续的算法分析和比较打下坚实的基础。通过完成这项练习 ，您将精确地理解 LU 分解过程中的主要计算工作量究竟源于何处。",
            "id": "3562232",
            "problem": "考虑将经典的无主元高斯消元法应用于一个稠密的 $n \\times n$ 实数矩阵，以计算其下三角-上三角 (LU) 分解。采用如下的运算计数约定：一次浮点乘法计为 $1$ flop，一次浮点加法或减法计为 $1$ flop，浮点除法单独计数（不计入 flop 总数）。从消去算法的结构出发，推导出完成消去阶段所需的 flop 总数（仅计算加法和乘法）的精确封闭形式表达式，然后计算当 $n=1000$ 时该表达式的值。将您的最终答案表示为一个无舍入的精确整数。您可以在推导过程中单独说明除法次数，但最终要求的答案是排除除法后的 flop 总数。",
            "solution": "该问题要求推导对一个稠密 $n \\times n$ 矩阵进行高斯消元法消去阶段所需的浮点运算（flops）的精确数量，并计算当 $n=1000$ 时该数量的值。一个 flop 定义为一次乘法或一次加法/减法。除法被单独计数，并从最终的 flop 总数中排除。\n\n高斯消元法通过在主对角线下方引入零，将矩阵 $A$ 转换为一个上三角矩阵 $U$。这个过程分 $n-1$ 个阶段进行。令 $A^{(k)}$ 表示第 $k-1$ 阶段结束时的矩阵，其中 $A^{(1)} = A$。\n\n在第 $k$ 阶段（$k=1, 2, \\dots, n-1$），目标是消除第 $k$ 列中主元元素 $a_{kk}^{(k)}$下方的非零项。这是通过对从 $k+1$ 到 $n$ 的每一行 $i$ 执行行操作来实现的。\n\n对于每一行 $i$（其中 $i \\in \\{k+1, \\dots, n\\}$）：\n1.  计算一个乘数 $m_{ik}$。这个乘数将被存储在下三角矩阵 $L$ 的 $(i, k)$ 位置上。\n    $$ m_{ik} = \\frac{a_{ik}^{(k)}}{a_{kk}^{(k)}} $$\n    这个操作构成 $1$ 次除法。由于这是对从 $k+1$ 到 $n$ 的每一行 $i$ 进行的，所以在第 $k$ 阶段有 $n-k$ 次除法。\n\n2.  通过减去 $m_{ik}$ 乘以第 $k$ 行来更新第 $i$ 行。第 $i$ 行元素的更新规则是：\n    $$ a_{ij}^{(k+1)} = a_{ij}^{(k)} - m_{ik} \\cdot a_{kj}^{(k)} $$\n    根据构造，元素 $a_{ik}^{(k+1)}$ 变为 $0$，不需要计算。实际的计算是针对列 $j=k+1, \\dots, n$ 中的元素。这些列的数量是 $n - (k+1) + 1 = n-k$。\n    对于每个被更新的元素 $a_{ij}^{(k+1)}$，操作 $a_{ij}^{(k)} - m_{ik} \\cdot a_{kj}^{(k)}$ 涉及 $1$ 次乘法和 $1$ 次减法，总共是 $2$ flops。\n    因此，更新单一行 $i$ 需要 $2(n-k)$ flops。\n\n由于在第 $k$ 阶段有 $n-k$ 行需要更新（从 $i=k+1$ 到 $n$），所以第 $k$ 阶段的 flop 总数是：\n$$ \\text{Flops}_k = (n-k) \\times 2(n-k) = 2(n-k)^2 $$\n\n为了找到整个消去过程的 flop 总数 $F_n$，我们将从阶段 $k=1$ 到 $k=n-1$ 的 flop 数相加：\n$$ F_n = \\sum_{k=1}^{n-1} \\text{Flops}_k = \\sum_{k=1}^{n-1} 2(n-k)^2 $$\n我们可以通过改变求和指标来简化这个求和。令 $j = n-k$。当 $k$ 从 $1$ 变为 $n-1$ 时，$j$ 从 $n-1$ 递减到 $1$。\n$$ F_n = 2 \\sum_{j=1}^{n-1} j^2 $$\n使用著名的前 $m$ 个平方和公式 $\\sum_{j=1}^{m} j^2 = \\frac{m(m+1)(2m+1)}{6}$，其中 $m=n-1$：\n$$ F_n = 2 \\left( \\frac{(n-1)((n-1)+1)(2(n-1)+1)}{6} \\right) $$\n$$ F_n = 2 \\left( \\frac{(n-1)n(2n-1)}{6} \\right) $$\n$$ F_n = \\frac{n(n-1)(2n-1)}{3} $$\n展开此表达式可得多项式形式：\n$$ F_n = \\frac{n(2n^2 - 3n + 1)}{3} = \\frac{2}{3}n^3 - n^2 + \\frac{1}{3}n $$\n这就是 flop 总数（乘法和加法/减法）的精确封闭形式表达式。\n\n为了完整起见，总除法次数 $D_n$ 是每个阶段除法次数的总和：\n$$ D_n = \\sum_{k=1}^{n-1} (n-k) = \\sum_{j=1}^{n-1} j = \\frac{(n-1)n}{2} = \\frac{1}{2}n^2 - \\frac{1}{2}n $$\n\n问题要求计算当 $n=1000$ 时 $F_n$ 的值。将 $n=1000$ 代入推导出的公式：\n$$ F_{1000} = \\frac{1000(1000-1)(2 \\cdot 1000 - 1)}{3} $$\n$$ F_{1000} = \\frac{1000 \\cdot 999 \\cdot 1999}{3} $$\n由于 $999 = 3 \\cdot 333$，我们可以简化表达式：\n$$ F_{1000} = 1000 \\cdot \\frac{999}{3} \\cdot 1999 = 1000 \\cdot 333 \\cdot 1999 $$\n为了计算最终的整数值：\n$$ F_{1000} = 333000 \\cdot 1999 $$\n$$ F_{1000} = 333000 \\cdot (2000 - 1) $$\n$$ F_{1000} = 333000 \\cdot 2000 - 333000 \\cdot 1 $$\n$$ F_{1000} = 666000000 - 333000 $$\n$$ F_{1000} = 665667000 $$\n这就是当 $n=1000$ 时 flop 总数的精确整数值。",
            "answer": "$$\n\\boxed{665667000}\n$$"
        },
        {
            "introduction": "虽然我们最初的分析给出了核心算术成本，但实际应用中的高斯消元法必须包含主元选择（pivoting）策略以保证数值稳定性。一个关键的问题随之而来：这种为确保结果可靠性而引入的必要修改，是否会带来高昂的计算代价？本练习  将指导您量化部分主元选择所需的比较操作成本，从而揭示其对算法总体复杂度的影响。",
            "id": "2160709",
            "problem": "一名数值分析课程的学生需要求解一个稠密方阵线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中 $A$ 是一个 $n \\times n$ 的可逆矩阵。标准的高斯消元法，在不进行任何主元选择的情况下，其计算成本已知主要由前向消元阶段决定，对于较大的 $n$，该阶段大约需要 $\\frac{2}{3}n^3$ 次浮点运算（flops）。\n\n为了提高算法的数值稳定性，该学生采用了部分主元法。这一修改在 $n-1$ 步前向消元的每一步开始时都增加了一个额外的过程。具体来说，对于从 $1$ 到 $n-1$ 的每一步 $k$，在对第 $k$ 列进行消元之前，算法必须在当前主元列中，从对角线元素开始向下，找到绝对值最大的元素。也就是说，它必须找到 $\\{|a_{k,k}|, |a_{k+1,k}|, \\dots, |a_{n,k}|\\}$ 中的最大值。然后，包含该最大元素的行与当前主元行（第 $k$ 行）进行交换。\n\n假设行交换的计算成本可以忽略不计，请确定在整个前向消元过程中实施此部分主元策略所需的比较操作的总次数 $C(n)$。请用 $n$ 的封闭形式表达式给出你的答案。",
            "solution": "在前向消元的第 $k$ 步，算法必须在 $n-k+1$ 个值 $\\{|a_{k,k}|,|a_{k+1,k}|,\\dots,|a_{n,k}|\\}$ 中找到最大值。要确定 $m$ 个数的最大值，正好需要 $m-1$ 次比较。因此，在第 $k$ 步，比较的次数是\n$$\n(n-k+1)-1=n-k.\n$$\n对所有步骤 $k=1,2,\\dots,n-1$ 求和，总的比较次数为\n$$\nC(n)=\\sum_{k=1}^{n-1}(n-k)=\\sum_{j=1}^{n-1}j=\\frac{n(n-1)}{2}.\n$$\n假设行交换的成本可以忽略不计，且不增加比较次数，计算绝对值也不计为比较操作。因此，这就是确切的总次数。",
            "answer": "$$\\boxed{\\frac{n(n-1)}{2}}$$"
        },
        {
            "introduction": "操作计数不仅仅是一项理论推导，它更深刻地影响着科学计算中的实际决策。这个练习  将您置于一个经典场景：求解具有相同系数矩阵但不同右端项的多个线性方程组。您将分析 LU 分解的一次性成本与多次求解的累积成本之间的权衡关系，从而确定一个“交叉点”，即当求解次数达到多少时，预先计算并存储矩阵的 LU 分解将成为更高效的策略。",
            "id": "3562285",
            "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个稠密的非奇异矩阵，并且假设您必须求解 $A x^{(j)} = b^{(j)}$，其中 $j = 1, \\dots, k$，$k = k(n)$ 随 $n$ 缩放。您将进行一次带部分主元的高斯消元，以获得单位下三角和上三角分解 $A = P L U$（其中 $P$ 是一个置换矩阵），然后对每个右端项进行前向和后向代换。从高斯消元和三角求解的算法定义出发，并使用浮点运算 (flop) 次数，其中乘法和加法分开计数，请执行以下操作：\n\n- 推导一次性分解的主阶浮点运算次数，用 $n$ 表示。\n- 推导对 $k$ 个右端项执行所有前向和后向代换的主阶浮点运算次数，用 $n$ 和 $k$ 表示。\n\n假设稠密数据存取并忽略低阶项。使用您推导的表达式，分析 $n \\to \\infty$ 且 $k = k(n)$ 随 $n$ 缩放的渐近状态，并确定交叉点 $k^{\\star}(n)$，在该点累计求解成本首次与一次性分解成本相等。将您的最终答案表示为 $k^{\\star}(n)$ 关于 $n$ 的闭式解析表达式。不需要四舍五入，也不涉及单位。您的最终答案必须是单个表达式。",
            "solution": "该问题要求推导交叉点，记为 $k^{\\star}(n)$，在该点，通过一次性 LU 分解和随后的代换求解 $k$ 个线性系统的计算成本等于分解本身的成本。我们在矩阵大小 $n \\to \\infty$ 的渐近状态下分析此问题。该分析依赖于计算浮点运算 (flop) 次数，并且按规定将乘法和加法分开计数。\n\n首先，我们推导使用高斯消元法对一个稠密的 $n \\times n$ 矩阵 $A$ 进行 LU 分解的主阶浮点运算次数。该过程包括 $n-1$ 个步骤。在步骤 $i$（$i=1, 2, \\dots, n-1$），我们消去第 $i$ 列对角线以下的非零元素。这是通过对行 $j=i+1, \\dots, n$ 执行行操作来实现的。\n\n对于主元行 $i$ 下方的每一行 $j$，过程如下：\n1.  计算乘数 $L_{ji} = A_{ji}^{(i-1)} / A_{ii}^{(i-1)}$。这需要 $1$ 次除法。我们将除法和乘法一起计数。\n2.  对所有列 $k = i+1, \\dots, n$ 更新行 $j$。更新规则为 $A_{jk}^{(i)} \\leftarrow A_{jk}^{(i-1)} - L_{ji} A_{ik}^{(i-1)}$。对于每一列 $k$，这需要 $1$ 次乘法和 $1$ 次加法（或减法）。\n\n在步骤 $i$，我们处理的是一个 $(n-i+1) \\times (n-i+1)$ 的子矩阵。\n-   需要计算的乘数数量：主元行下方有 $n-i$ 行，因此我们计算 $n-i$ 个乘数。这贡献了 $n-i$ 次除法。\n-   行更新次数：对于 $n-i$ 行中的每一行，我们更新第 $i+1$ 列到第 $n$ 列的元素。共有 $n-i$ 列。每个元素的更新需要 $1$ 次乘法和 $1$ 次加法。因此，对于 $n-i$ 行中的每一行，更新成本是 $(n-i)$ 次乘法和 $(n-i)$ 次加法。\n-   步骤 $i$ 的总运算次数：\n    -   乘法/除法：$(n-i) + (n-i)(n-i) = (n-i) + (n-i)^2$。\n    -   加法/减法：$(n-i)(n-i) = (n-i)^2$。\n\n为了求出分解的总成本，我们将所有步骤 $i = 1, \\dots, n-1$ 的运算次数相加：\n-   总乘法/除法次数：$C_{\\text{mult}} = \\sum_{i=1}^{n-1} ((n-i) + (n-i)^2)$。\n-   总加法/减法次数：$C_{\\text{add}} = \\sum_{i=1}^{n-1} (n-i)^2$。\n\n我们关心的是 $n \\to \\infty$ 时的主阶项。在两个和中，主导项都是包含 $(n-i)^2$ 的项。令 $j = n-i$。当 $i$ 从 $1$ 到 $n-1$ 变化时，$j$ 从 $n-1$ 到 $1$ 变化。乘法和加法的主阶成本都由和 $\\sum_{j=1}^{n-1} j^2$ 决定。\n使用平方和公式 $\\sum_{j=1}^{m} j^2 = \\frac{m(m+1)(2m+1)}{6}$：\n$$ \\sum_{j=1}^{n-1} j^2 = \\frac{(n-1)(n)(2(n-1)+1)}{6} = \\frac{(n-1)n(2n-1)}{6} = \\frac{2n^3 - 3n^2 + n}{6} $$\n当 $n \\to \\infty$ 时，此和的主阶项是 $\\frac{2n^3}{6} = \\frac{n^3}{3}$。\n因此，主阶成本为：\n-   $C_{\\text{mult, fact}} \\approx \\frac{n^3}{3}$\n-   $C_{\\text{add, fact}} \\approx \\frac{n^3}{3}$\n分解的总主阶浮点运算次数为 $C_{\\text{fact}} \\approx \\frac{n^3}{3} + \\frac{n^3}{3} = \\frac{2}{3}n^3$。\n\n接下来，我们推导求解单个右端向量 $b$ 的系统所需的成本。在获得分解 $A=PLU$ 后，求解 $Ax = b$ 变为求解 $LUx = P^T b$。这是一个两步过程。首先，定义 $y = Ux$ 并通过前向代换求解下三角系统 $Ly=P^T b$。其次，通过后向代换求解上三角系统 $Ux=y$。置换 $P^T b$ 是元素的重新排序，成本为 $0$ 次浮点运算。\n\n1.  **前向代换：** 我们求解 $Ly=P^T b$。由于 $L$ 是单位下三角矩阵（$L_{ii}=1$），$y$ 的每个分量的公式为：\n    $$ y_i = (P^T b)_i - \\sum_{j=1}^{i-1} L_{ij} y_j, \\quad \\text{for } i = 1, \\dots, n $$\n    对于每个 $i$，计算 $y_i$ 需要 $i-1$ 次乘法和 $i-1$ 次加法。\n    总成本为：\n    -   $C_{\\text{mult, fwd}} = \\sum_{i=1}^{n} (i-1) = \\frac{(n-1)n}{2} = \\frac{n^2}{2} - \\frac{n}{2}$。\n    -   $C_{\\text{add, fwd}} = \\sum_{i=1}^{n} (i-1) = \\frac{(n-1)n}{2} = \\frac{n^2}{2} - \\frac{n}{2}$。\n    前向代换的主阶成本是 $\\frac{n^2}{2}$ 次乘法和 $\\frac{n^2}{2}$ 次加法。\n\n2.  **后向代换：** 我们求解 $Ux=y$。$x$ 的每个分量的公式为：\n    $$ x_i = \\frac{1}{U_{ii}} \\left( y_i - \\sum_{j=i+1}^{n} U_{ij} x_j \\right), \\quad \\text{for } i = n, \\dots, 1 $$\n    对于每个 $i$，计算 $x_i$ 需要 $(n-i)$ 次乘法、$(n-i)$ 次加法和 $1$ 次除法。\n    总成本为：\n    -   $C_{\\text{mult/div, bwd}} = \\sum_{i=1}^{n} ((n-i) + 1) = \\left(\\sum_{j=0}^{n-1} j\\right) + n = \\frac{(n-1)n}{2} + n = \\frac{n^2-n+2n}{2} = \\frac{n^2}{2} + \\frac{n}{2}$。\n    -   $C_{\\text{add, bwd}} = \\sum_{i=1}^{n} (n-i) = \\sum_{j=0}^{n-1} j = \\frac{(n-1)n}{2} = \\frac{n^2}{2} - \\frac{n}{2}$。\n    后向代换的主阶成本是 $\\frac{n^2}{2}$ 次乘法/除法和 $\\frac{n^2}{2}$ 次加法。\n\n单次求解的总成本（$C_{\\text{solve}}$）是前向和后向代换成本之和。\n-   每次求解的总乘法/除法次数：$C_{\\text{mult, solve}} \\approx \\frac{n^2}{2} + \\frac{n^2}{2} = n^2$。\n-   每次求解的总加法/减法次数：$C_{\\text{add, solve}} \\approx \\frac{n^2}{2} + \\frac{n^2}{2} = n^2$。\n单次求解的总主阶浮点运算次数为 $C_{\\text{solve}} \\approx n^2 + n^2 = 2n^2$。\n\n求解 $k$ 个右端项的总成本是 $C_{\\text{solves}} = k \\cdot C_{\\text{solve}}$。在渐近极限下，这大约是 $C_{\\text{solves}} \\approx k(2n^2)$。\n\n交叉点 $k^{\\star}(n)$ 是累计求解成本与一次性分解成本相等时的 $k$ 值。我们将这些成本的主阶表达式设为相等：\n$$ C_{\\text{fact}} = C_{\\text{solves}} $$\n$$ \\frac{2}{3}n^3 = k^{\\star}(n) \\cdot (2n^2) $$\n求解 $k^{\\star}(n)$：\n$$ k^{\\star}(n) = \\frac{\\frac{2}{3}n^3}{2n^2} = \\frac{2n^3}{6n^2} = \\frac{n}{3} $$\n因此，求解次数必须约为矩阵维度的三分之一，求解的总成本才能与初始分解的成本相匹配。",
            "answer": "$$\\boxed{\\frac{n}{3}}$$"
        }
    ]
}