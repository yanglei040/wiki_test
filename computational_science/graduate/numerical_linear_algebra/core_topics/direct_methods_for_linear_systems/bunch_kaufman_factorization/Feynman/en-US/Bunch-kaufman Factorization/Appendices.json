{
    "hands_on_practices": [
        {
            "introduction": "To truly understand an algorithm, there is no substitute for working through it by hand. This first practice is a foundational exercise designed to build your mechanical fluency with the Bunch-Kaufman factorization. By applying the diagonal pivoting strategy to a small but representative symmetric indefinite matrix, you will solidify your grasp of the decision-making process for selecting both $1 \\times 1$ and $2 \\times 2$ pivots and executing the corresponding block elimination steps .",
            "id": "3535826",
            "problem": "Consider the symmetric indefinite matrix $A \\in \\mathbb{R}^{4 \\times 4}$ given by\n$$\nA \\;=\\; \\begin{pmatrix}\n0  2  0  0 \\\\\n2  1  1  0 \\\\\n0  1  3  1 \\\\\n0  0  1  2\n\\end{pmatrix}.\n$$\nUsing the Bunch–Kaufman (BK) diagonal pivoting method with the standard threshold parameter $\\alpha \\,=\\, \\dfrac{1+\\sqrt{17}}{8}$, perform by hand a symmetric indefinite factorization of $A$ of the form\n$$\nA \\;=\\; P^{\\top} \\, L \\, D \\, L^{\\top} \\, P,\n$$\nwhere $P$ is a permutation matrix, $L$ is unit lower triangular (with possible $2 \\times 2$ pivot coupling reflected in subdiagonal block columns), and $D$ is block diagonal with $1 \\times 1$ and $2 \\times 2$ symmetric blocks. Present $P$, $L$, and $D$ explicitly. Then, using only your factorization (without direct expansion of $\\det(A)$ by other means), compute the determinant of $A$ as a single exact scalar. Express the final answer as an exact integer. Do not round.",
            "solution": "The user wants to find the Bunch-Kaufman factorization of the matrix $A$ and then compute its determinant.\n\n### Problem Validation\nThe given problem is a well-defined exercise in numerical linear algebra.\n- **Givens**:\n    - The matrix $A = \\begin{pmatrix} 0  2  0  0 \\\\ 2  1  1  0 \\\\ 0  1  3  1 \\\\ 0  0  1  2 \\end{pmatrix}$.\n    - The algorithm is the Bunch-Kaufman diagonal pivoting method.\n    - The threshold parameter is $\\alpha = \\frac{1+\\sqrt{17}}{8}$.\n    - The factorization form is $A = P^{\\top} L D L^{\\top} P$.\n- **Validation**:\n    - The problem is scientifically grounded, using a standard algorithm from numerical linear algebra.\n    - It is well-posed, with all necessary information provided to derive a unique solution based on the deterministic steps of the algorithm.\n    - The problem is objective and free from ambiguity.\n    - All premises are factually correct; $A$ is symmetric as required, and $\\alpha$ is a valid parameter choice since $0  \\alpha  1$.\nThe problem is valid and can be solved.\n\n### Solution\nThe Bunch-Kaufman factorization is performed iteratively. We seek to find $P$, $L$, and $D$ such that $P A P^{\\top} = L D L^{\\top}$. Initially, we set $P=I$, $L=I$, and the matrix to be factored is $A^{(1)} = A$.\n\n**Step 1: First pivot selection (k=1)**\n\nWe are working on the first column of the matrix $A^{(1)} = A$.\n$$\nA^{(1)} \\;=\\; \\begin{pmatrix}\n0  2  0  0 \\\\\n2  1  1  0 \\\\\n0  1  3  1 \\\\\n0  0  1  2\n\\end{pmatrix}\n$$\nThe diagonal element is $a_{11}^{(1)} = 0$. We find the largest magnitude off-diagonal element in the first column:\n$$\n\\lambda_1 \\;=\\; \\max_{j1} |a_{j1}^{(1)}| \\;=\\; \\max(|2|, |0|, |0|) \\;=\\; 2\n$$\nThis maximum occurs at row $r=2$.\n\nThe Bunch-Kaufman pivoting strategy requires comparing $|a_{11}^{(1)}|$ with $\\alpha \\lambda_1$:\n$$\n|a_{11}^{(1)}| \\;=\\; 0 \\quad \\text{and} \\quad \\alpha \\lambda_1 \\;=\\; \\frac{1+\\sqrt{17}}{8} \\cdot 2 \\;=\\; \\frac{1+\\sqrt{17}}{4}\n$$\nSince $\\sqrt{17}  1$, we have $1+\\sqrt{17}  2$, so $\\frac{1+\\sqrt{17}}{4}  \\frac{1}{2}$. Clearly, $0  \\frac{1+\\sqrt{17}}{4}$, so the condition $|a_{11}^{(1)}| \\ge \\alpha \\lambda_1$ is false. We must consider either a row/column interchange or a $2 \\times 2$ pivot.\n\nNext, we find the largest off-diagonal element in column $r=2$ (excluding the row $r=2$ element itself):\n$$\n\\sigma_2 \\;=\\; \\max_{j \\ge 1, j \\ne 2} |a_{j2}^{(1)}| \\;=\\; \\max(|a_{12}^{(1)}|, |a_{32}^{(1)}|, |a_{42}^{(1)}|) \\;=\\; \\max(|2|, |1|, |0|) \\;=\\; 2\n$$\nThe second test is $|a_{11}^{(1)}| \\sigma_2 \\ge \\alpha \\lambda_1^2$:\n$$\n|0| \\cdot 2 \\;\\ge\\; \\frac{1+\\sqrt{17}}{8} \\cdot 2^2 \\;\\implies\\; 0 \\;\\ge\\; \\frac{1+\\sqrt{17}}{2}\n$$\nThis is false.\n\nThe third test is $|a_{rr}^{(1)}| \\ge \\alpha \\sigma_r$, which is $|a_{22}^{(1)}| \\ge \\alpha \\sigma_2$:\n$$\n|1| \\;\\ge\\; \\frac{1+\\sqrt{17}}{8} \\cdot 2 \\;\\implies\\; 1 \\;\\ge\\; \\frac{1+\\sqrt{17}}{4}\n$$\nThis is equivalent to $4 \\ge 1+\\sqrt{17}$, or $3 \\ge \\sqrt{17}$. Since $3^2=9$ and $(\\sqrt{17})^2=17$, we have $9 \\not\\ge 17$. The condition is false.\n\nSince all three tests fail, we must use a $2 \\times 2$ pivot. The pivot is the submatrix formed by rows and columns $k=1$ and $r=2$. The permutation matrix would involve swapping row $k+1=2$ with row $r=2$, which means no actual permutation is performed. Thus, $P$ remains the identity matrix $I_4$.\nThe first pivot block for $D$ is:\n$$\nD_1 \\;=\\; \\begin{pmatrix} a_{11}^{(1)}  a_{12}^{(1)} \\\\ a_{21}^{(1)}  a_{22}^{(1)} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix}\n$$\nNow, we perform a block elimination. We need to find the multipliers that will zero out the elements $a_{31}, a_{32}, a_{41}, a_{42}$ after the transformation. These multipliers form the subdiagonal entries of $L$.\nThe multipliers $(l_{31}, l_{32})$ are determined by solving:\n$$\n\\begin{pmatrix} l_{31}  l_{32} \\end{pmatrix} \\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix} = \\begin{pmatrix} a_{31}  a_{32} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\end{pmatrix}\n$$\nThis gives the system:\n$2l_{32} = 0 \\implies l_{32}=0$.\n$2l_{31} + l_{32} = 1 \\implies 2l_{31} + 0 = 1 \\implies l_{31}=1/2$.\n\nFor the multipliers $(l_{41}, l_{42})$:\n$$\n\\begin{pmatrix} l_{41}  l_{42} \\end{pmatrix} \\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix} = \\begin{pmatrix} a_{41}  a_{42} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\end{pmatrix}\n$$\nThis gives $l_{41}=0$ and $l_{42}=0$.\n\nThe Schur complement $S$ is the remaining submatrix to be factored. It is updated via the formula $S_{new} = S_{old} - W D_1^{-1} W^T$. This computation yields:\n$$ S = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} $$\nThe matrix after this stage is $A^{(2)} = \\begin{pmatrix} 0  2  0  0 \\\\ 2  1  0  0 \\\\ 0  0  3  1 \\\\ 0  0  1  2 \\end{pmatrix}$.\n\n**Step 2: Second pivot selection (k=3)**\n\nWe now work on the submatrix $S = \\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix}$, which corresponds to rows and columns $3$ and $4$.\nThe diagonal element is $s_{11}=3$. The largest off-diagonal element in the first column of $S$ is $|s_{21}| = 1$. Let's call this $\\lambda_3=1$.\nWe check the condition $|s_{11}| \\ge \\alpha \\lambda_3$:\n$$\n|3| \\;\\ge\\; \\frac{1+\\sqrt{17}}{8} \\cdot 1 \\;\\implies\\; 24 \\;\\ge\\; 1+\\sqrt{17} \\;\\implies\\; 23 \\;\\ge\\; \\sqrt{17}\n$$\nSince $23^2 = 529$ and $(\\sqrt{17})^2 = 17$, the condition $529 \\ge 17$ is true.\nThus, we use a $1 \\times 1$ pivot, $d_3 = s_{11}=3$. No permutation is needed.\n\nWe perform Gaussian elimination on $S$. The multiplier is $l = s_{21} / d_3 = 1/3$. This will be the element $l_{43}$ in the full $L$ matrix.\nThe updated element $s'_{22}$ is $s_{22} - l \\cdot s_{12} = 2 - (1/3) \\cdot 1 = 5/3$.\nThis is our final pivot, $d_4 = 5/3$.\n\n**Final Factorization Matrices**\n\nThe permutation matrix $P$ is the identity matrix as no interchanges were performed.\n$$\nP \\;=\\; \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix}\n$$\nThe matrix $D$ is block diagonal with the pivots we found:\n$$\nD \\;=\\; \\begin{pmatrix}\n0  2  0  0 \\\\\n2  1  0  0 \\\\\n0  0  3  0 \\\\\n0  0  0  5/3\n\\end{pmatrix}\n$$\nThe unit lower triangular matrix $L$ is constructed from the multipliers. The $2 \\times 2$ pivot couples columns $1$ and $2$.\n$$\nL \\;=\\; \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\nl_{31}  l_{32}  1  0 \\\\\nl_{41}  l_{42}  l_{43}  1\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n1/2  0  1  0 \\\\\n0  0  1/3  1\n\\end{pmatrix}\n$$\nThe factorization is $A = L D L^{\\top}$.\n\n**Determinant Calculation**\nThe determinant of $A$ can be computed from the factorization $A = P^{\\top} L D L^{\\top} P$:\n$$\n\\det(A) \\;=\\; \\det(P^{\\top}) \\det(L) \\det(D) \\det(L^{\\top}) \\det(P)\n$$\n- $\\det(P) = \\det(I_4) = 1$, so $\\det(P^T)=1$.\n- $L$ and $L^{\\top}$ are unit triangular matrices, so their determinants are the product of their diagonal elements, which is $1$.\n- Therefore, $\\det(A) = \\det(D)$.\n\nThe determinant of the block diagonal matrix $D$ is the product of the determinants of its diagonal blocks:\n$$\n\\det(D) \\;=\\; \\det\\begin{pmatrix} 0  2 \\\\ 2  1 \\end{pmatrix} \\cdot \\det\\begin{pmatrix} 3  0 \\\\ 0  5/3 \\end{pmatrix}\n$$\n$$\n\\det(D) \\;=\\; \\left((0)(1) - (2)(2)\\right) \\cdot \\left((3)(5/3)\\right) \\;=\\; (-4) \\cdot (5) \\;=\\; -20\n$$\nSo, the determinant of $A$ is $-20$.\n\nFinal Explicit Matrices:\n$P = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix}$\n$L = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 1/2  0  1  0 \\\\ 0  0  1/3  1 \\end{pmatrix}$\n$D = \\begin{pmatrix} 0  2  0  0 \\\\ 2  1  0  0 \\\\ 0  0  3  0 \\\\ 0  0  0  5/3 \\end{pmatrix}$\nThe determinant is $-20$.",
            "answer": "$$\\boxed{-20}$$"
        },
        {
            "introduction": "Now that you are familiar with the mechanics of the algorithm, we explore its primary motivation: numerical stability. This practice presents a thought experiment using a matrix with parameters designed to challenge a naive elimination approach . By comparing the catastrophic element growth from a simple pivot choice with the controlled growth achieved by the Bunch-Kaufman $2 \\times 2$ pivoting strategy, you will gain a crucial insight into why this method is essential for robust scientific computing.",
            "id": "3535905",
            "problem": "Let $A \\in \\mathbb{R}^{4 \\times 4}$ be the symmetric indefinite matrix\n$$\nA(\\delta,M,t) \\;=\\;\n\\begin{pmatrix}\n\\delta  M  0  0 \\\\\nM  \\delta  t  t \\\\\n0  t  \\delta  t \\\\\n0  t  t  \\delta\n\\end{pmatrix},\n$$\nwhere $\\delta  0$ is small, $M  0$ is large, and $t  0$ is of order $1$. Consider two first-step symmetric eliminations of $A$:\n\n1. Naive symmetric Gaussian elimination without pivoting that uses the $1 \\times 1$ pivot $a_{11} = \\delta$.\n\n2. The Bunch–Kaufman (BK) factorization that uses the $2 \\times 2$ pivot on indices $\\{1,2\\}$, i.e., the leading block\n$$\nB \\;=\\; \\begin{pmatrix} \\delta  M \\\\ M  \\delta \\end{pmatrix},\n$$\nand forms the trailing Schur complement after eliminating the first two rows and columns.\n\nDefine the following element-growth measures for the first elimination step:\n\n- The naive growth factor\n$$\n\\gamma_{\\mathrm{naive}} \\;=\\; \\frac{\\max\\{\\,|a_{ij}^{(1)}| \\text{ created in the first Schur complement update}\\,\\}}{\\max_{i,j} |a_{ij}|},\n$$\nwhere $a_{ij}^{(1)}$ denotes entries created in the first Schur complement.\n\n- The Bunch–Kaufman growth factor\n$$\n\\gamma_{\\mathrm{BK}} \\;=\\; \\frac{\\max\\{\\,|s_{ij}| \\text{ in the first trailing Schur complement}\\,\\}}{\\max_{i,j} |a_{ij}|},\n$$\nwhere $S = (s_{ij})$ is the first trailing Schur complement obtained by eliminating the $2 \\times 2$ pivot $B$.\n\nUsing only the fundamental definitions of Gaussian elimination, Schur complements, and block elimination for symmetric matrices, derive explicit expressions for $\\gamma_{\\mathrm{naive}}$ and $\\gamma_{\\mathrm{BK}}$ in terms of $\\delta$, $M$, and $t$. Then, for the concrete parameters $\\delta = 10^{-8}$, $M = 10^{4}$, and $t = 1$, compute the ratio\n$$\nG \\;=\\; \\frac{\\gamma_{\\mathrm{naive}}}{\\gamma_{\\mathrm{BK}}}.\n$$\nRound your final numerical value of $G$ to four significant figures. Express the final answer as a pure number (no units).",
            "solution": "The user wants me to analyze the first step of two different symmetric elimination methods on a given matrix $A$, derive the element growth factors, and compute their ratio for specific parameter values.\n\n### Step 1: Extract Givens\n- The matrix is $A \\in \\mathbb{R}^{4 \\times 4}$, symmetric and indefinite:\n$$\nA(\\delta,M,t) =\n\\begin{pmatrix}\n\\delta  M  0  0 \\\\\nM  \\delta  t  t \\\\\n0  t  \\delta  t \\\\\n0  t  t  \\delta\n\\end{pmatrix}\n$$\n- The parameters are $\\delta  0$ (small), $M  0$ (large), and $t  0$ (order $1$).\n- Specific parameter values for calculation: $\\delta = 10^{-8}$, $M = 10^{4}$, and $t = 1$.\n- Method 1 (Naive): Symmetric Gaussian elimination using the $1 \\times 1$ pivot $a_{11} = \\delta$.\n- Method 2 (Bunch-Kaufman): Symmetric elimination using the $2 \\times 2$ pivot $B = \\begin{pmatrix} \\delta  M \\\\ M  \\delta \\end{pmatrix}$.\n- Naive growth factor definition:\n$$\n\\gamma_{\\mathrm{naive}} = \\frac{\\max\\{\\,|a_{ij}^{(1)}| \\text{ in the first Schur complement}\\,\\}}{\\max_{i,j} |a_{ij}|}\n$$\n- Bunch-Kaufman growth factor definition:\n$$\n\\gamma_{\\mathrm{BK}} = \\frac{\\max\\{\\,|s_{ij}| \\text{ in the first trailing Schur complement}\\,\\}}{\\max_{i,j} |a_{ij}|}\n$$\n- The final task is to compute the ratio $G = \\frac{\\gamma_{\\mathrm{naive}}}{\\gamma_{\\mathrm{BK}}}$ and round it to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n1.  **Scientific Soundness**: The problem is sourced from numerical linear algebra, dealing with standard, well-established concepts like Gaussian elimination, Bunch-Kaufman factorization, Schur complements, and numerical stability (element growth). All definitions and procedures are standard.\n2.  **Well-Posedness**: The matrix and all parameters are clearly defined. The tasks—deriving expressions and computing a ratio—are unambiguous and lead to a unique, meaningful solution.\n3.  **Objectivity**: The problem is stated in precise mathematical language, free of any subjectivity or ambiguity. The conditions on the parameters ($\\delta$ small, $M$ large, $t$ of order $1$) are typical for analyzing the behavior of numerical algorithms in challenging scenarios.\n\nThe problem is valid.\n\n### Step 3: Derivation and Solution\n\nThe process will be to first derive the analytical expressions for $\\gamma_{\\mathrm{naive}}$ and $\\gamma_{\\mathrm{BK}}$, then derive the expression for their ratio $G$, and finally compute the numerical value of $G$.\n\nThe maximum absolute value of the entries in the original matrix $A$ is required for the denominator of both growth factors. Given that $M$ is large, $\\delta$ is small, and $t$ is of order $1$:\n$$\n\\max_{i,j} |a_{ij}| = \\max\\{|\\delta|, |M|, |0|, |t|\\} = M\n$$\n\n**1. Naive Symmetric Elimination Growth Factor ($\\gamma_{\\mathrm{naive}}$)**\n\nWe perform one step of symmetric Gaussian elimination using the $1 \\times 1$ pivot $a_{11} = \\delta$. The matrix $A$ is partitioned as:\n$$\nA = \\begin{pmatrix} a_{11}  v^T \\\\ v  A_{22} \\end{pmatrix} = \\begin{pmatrix} \\delta  \\begin{pmatrix} M  0  0 \\end{pmatrix} \\\\ \\begin{pmatrix} M \\\\ 0 \\\\ 0 \\end{pmatrix}  \\begin{pmatrix} \\delta  t  t \\\\ t  \\delta  t \\\\ t  t  \\delta \\end{pmatrix} \\end{pmatrix}\n$$\nThe first Schur complement $A^{(1)}$ is given by:\n$$\nA^{(1)} = A_{22} - \\frac{1}{a_{11}} v v^T = \\begin{pmatrix} \\delta  t  t \\\\ t  \\delta  t \\\\ t  t  \\delta \\end{pmatrix} - \\frac{1}{\\delta} \\begin{pmatrix} M \\\\ 0 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} M  0  0 \\end{pmatrix}\n$$\n$$\nA^{(1)} = \\begin{pmatrix} \\delta  t  t \\\\ t  \\delta  t \\\\ t  t  \\delta \\end{pmatrix} - \\frac{1}{\\delta} \\begin{pmatrix} M^2  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\delta - \\frac{M^2}{\\delta}  t  t \\\\ t  \\delta  t \\\\ t  t  \\delta \\end{pmatrix}\n$$\nThe maximum absolute value of the entries in this Schur complement is:\n$$\n\\max |a_{ij}^{(1)}| = \\max \\left\\{ \\left|\\delta - \\frac{M^2}{\\delta}\\right|, |t|, |\\delta| \\right\\}\n$$\nSince $\\delta  0$ is small and $M  0$ is large, $M^2/\\delta \\gg \\delta$ and $M^2/\\delta \\gg t$. Therefore:\n$$\n\\max |a_{ij}^{(1)}| = \\left|\\delta - \\frac{M^2}{\\delta}\\right| = \\frac{M^2}{\\delta} - \\delta\n$$\nThe naive growth factor is:\n$$\n\\gamma_{\\mathrm{naive}} = \\frac{\\max |a_{ij}^{(1)}|}{\\max |a_{ij}|} = \\frac{\\frac{M^2}{\\delta} - \\delta}{M} = \\frac{M}{\\delta} - \\frac{\\delta}{M}\n$$\n\n**2. Bunch-Kaufman Growth Factor ($\\gamma_{\\mathrm{BK}}$)**\n\nWe use the $2 \\times 2$ block pivot $B = \\begin{pmatrix} \\delta  M \\\\ M  \\delta \\end{pmatrix}$. The matrix $A$ is partitioned as:\n$$\nA = \\begin{pmatrix} B  C^T \\\\ C  D \\end{pmatrix} = \\begin{pmatrix} \\begin{pmatrix} \\delta  M \\\\ M  \\delta \\end{pmatrix}  \\begin{pmatrix} 0  0 \\\\ t  t \\end{pmatrix} \\\\ \\begin{pmatrix} 0  t \\\\ 0  t \\end{pmatrix}  \\begin{pmatrix} \\delta  t \\\\ t  \\delta \\end{pmatrix} \\end{pmatrix}\n$$\nThe trailing Schur complement $S$ is given by $S = D - C B^{-1} C^T$. First, we compute the inverse of $B$:\n$$\nB^{-1} = \\frac{1}{\\det(B)} \\begin{pmatrix} \\delta  -M \\\\ -M  \\delta \\end{pmatrix} = \\frac{1}{\\delta^2 - M^2} \\begin{pmatrix} \\delta  -M \\\\ -M  \\delta \\end{pmatrix}\n$$\nNow, we compute the product $C B^{-1} C^T$:\n$$\nC B^{-1} C^T = \\begin{pmatrix} 0  t \\\\ 0  t \\end{pmatrix} \\left( \\frac{1}{\\delta^2 - M^2} \\begin{pmatrix} \\delta  -M \\\\ -M  \\delta \\end{pmatrix} \\right) \\begin{pmatrix} 0  0 \\\\ t  t \\end{pmatrix}\n$$\n$$\n= \\frac{1}{\\delta^2 - M^2} \\begin{pmatrix} -Mt  \\delta t \\\\ -Mt  \\delta t \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ t  t \\end{pmatrix} = \\frac{1}{\\delta^2 - M^2} \\begin{pmatrix} \\delta t^2  \\delta t^2 \\\\ \\delta t^2  \\delta t^2 \\end{pmatrix}\n$$\nThe Schur complement $S = (s_{ij})$ is:\n$$\nS = \\begin{pmatrix} \\delta  t \\\\ t  \\delta \\end{pmatrix} - \\frac{\\delta t^2}{\\delta^2 - M^2} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} \\delta - \\frac{\\delta t^2}{\\delta^2-M^2}  t - \\frac{\\delta t^2}{\\delta^2-M^2} \\\\ t - \\frac{\\delta t^2}{\\delta^2-M^2}  \\delta - \\frac{\\delta t^2}{\\delta^2-M^2} \\end{pmatrix}\n$$\nThe maximum absolute value of the entries in $S$ is $\\max|s_{ij}|$. Since $\\delta^2 - M^2  0$, we can write $s_{12} = t + \\frac{\\delta t^2}{M^2 - \\delta^2}$. As $\\delta, t  0$ and $M  \\delta$, the second term is a small positive quantity. The largest entry in magnitude will be $|s_{12}| = |s_{21}|$ as $t$ is of order $1$ while $\\delta$ is small.\n$$\n\\max |s_{ij}| = \\left| t - \\frac{\\delta t^2}{\\delta^2 - M^2} \\right| = \\left| t + \\frac{\\delta t^2}{M^2 - \\delta^2} \\right| = t + \\frac{\\delta t^2}{M^2 - \\delta^2}\n$$\nThe Bunch-Kaufman growth factor is:\n$$\n\\gamma_{\\mathrm{BK}} = \\frac{\\max |s_{ij}|}{\\max |a_{ij}|} = \\frac{t + \\frac{\\delta t^2}{M^2 - \\delta^2}}{M} = \\frac{t}{M} + \\frac{\\delta t^2}{M(M^2 - \\delta^2)}\n$$\n\n**3. Ratio $G$**\n\nWe compute the ratio $G = \\frac{\\gamma_{\\mathrm{naive}}}{\\gamma_{\\mathrm{BK}}}$.\n$$\nG = \\frac{\\frac{M}{\\delta} - \\frac{\\delta}{M}}{\\frac{t}{M} + \\frac{\\delta t^2}{M(M^2 - \\delta^2)}} = \\frac{\\frac{M^2 - \\delta^2}{M\\delta}}{\\frac{t(M^2-\\delta^2) + \\delta t^2}{M(M^2 - \\delta^2)}}\n$$\n$$\nG = \\frac{M^2 - \\delta^2}{M\\delta} \\cdot \\frac{M(M^2 - \\delta^2)}{t(M^2 - \\delta^2) + \\delta t^2} = \\frac{(M^2 - \\delta^2)^2}{\\delta \\left( t(M^2 - \\delta^2) + \\delta t^2 \\right)}\n$$\nThis is the final analytical expression for $G$.\n\n**4. Numerical Computation**\n\nWe substitute the given values: $\\delta = 10^{-8}$, $M = 10^{4}$, and $t = 1$.\nFirst, let's evaluate the key components:\n- $M^2 = (10^4)^2 = 10^8$\n- $\\delta^2 = (10^{-8})^2 = 10^{-16}$\n- $M^2 - \\delta^2 = 10^8 - 10^{-16}$\n\nNow substitute into the expression for $G$:\n$$\nG = \\frac{(10^8 - 10^{-16})^2}{10^{-8} \\left( 1 \\cdot (10^8 - 10^{-16}) + 1^2 \\cdot 10^{-8} \\right)}\n$$\n$$\nG = \\frac{(10^8 - 10^{-16})^2}{10^{-8} (10^8 - 10^{-16} + 10^{-8})} = \\frac{(10^8 - 10^{-16})^2}{1 - 10^{-24} + 10^{-16}}\n$$\nGiven the parameter sizes, we can approximate:\n$$\nG \\approx \\frac{(M^2)^2}{\\delta(t M^2)} = \\frac{M^2}{t \\delta} = \\frac{(10^4)^2}{1 \\cdot 10^{-8}} = \\frac{10^8}{10^{-8}} = 10^{16}\n$$\nA more precise calculation shows the value is extremely close to $10^{16}$.\n$G = 9.9999999999999989... \\times 10^{15}$.\nRounding to four significant figures gives $10.00 \\times 10^{15}$, which is best written in standard scientific notation as $1.000 \\times 10^{16}$.",
            "answer": "$$ \\boxed{1.000 \\times 10^{16}} $$"
        },
        {
            "introduction": "The Bunch-Kaufman factorization is not just a method for solving linear systems; it is a powerful analytical tool that reveals the fundamental structure of a matrix. This final exercise demonstrates how the factorization can be used to analyze a singular matrix . By performing the factorization and interpreting the resulting zero pivot, you will learn how to efficiently compute a basis for the matrix's null space—a common and vital task in many areas of mathematics and engineering.",
            "id": "3535898",
            "problem": "Consider the symmetric matrix $A \\in \\mathbb{R}^{4 \\times 4}$ defined by\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n0  0  1  1 \\\\\n1  1  1  3\n\\end{pmatrix}.\n$$\nStart from the fundamental facts that a symmetric matrix admits a Bunch–Kaufman factorization, also called the Lower–Diagonal–Lower–Transpose (LDL$^{\\top}$) factorization with symmetric pivoting, namely $A = P^{\\top} L D L^{\\top} P$, where $P$ is a permutation matrix, $L$ is unit lower triangular, and $D$ is block diagonal with $1 \\times 1$ and $2 \\times 2$ blocks. The Bunch–Kaufman pivot selection criterion uses a threshold parameter $\\alpha$ (classically $\\alpha = \\frac{1 + \\sqrt{17}}{8}$) to decide between a $1 \\times 1$ pivot and a $2 \\times 2$ pivot, with the $1 \\times 1$ pivot accepted at step $k$ if $|a_{kk}| \\ge \\alpha \\max_{i  k} |a_{ik}|$ in the current active submatrix; otherwise it proceeds to test for a $2 \\times 2$ pivot. Assume arithmetic is exact.\n\nApply the Bunch–Kaufman criterion step-by-step to $A$ to determine the sequence of pivots (including whether symmetric permutations are needed), and perform the LDL$^{\\top}$ factorization accordingly. Using the completed factorization, derive a nonzero vector $x \\in \\mathbb{R}^{4}$ such that $A x = 0$ by exploiting the structure $A = P^{\\top} L D L^{\\top} P$. Express your final vector $x$ with exact integer components. No rounding is required. Your final answer must be a single row vector.",
            "solution": "The problem requires performing a Bunch-Kaufman ($LDL^{\\top}$) factorization on the given symmetric matrix $A$ and then using the factorization to find a non-zero vector $x \\in \\mathbb{R}^{4}$ in the null space of $A$.\n\nThe given matrix $A$ is:\n$$\nA = A^{(1)} = \\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n0  0  1  1 \\\\\n1  1  1  3\n\\end{pmatrix}\n$$\nThe Bunch-Kaufman algorithm proceeds by iteratively choosing either a $1 \\times 1$ or a $2 \\times 2$ pivot and updating the trailing submatrix. The choice is governed by a threshold parameter $\\alpha = \\frac{1 + \\sqrt{17}}{8}$. A $1 \\times 1$ pivot from the diagonal element $a_{kk}$ of the current active submatrix is chosen if $|a_{kk}| \\ge \\alpha \\max_{i  k} |a_{ik}|$. Since $4^2 = 16$ and $5^2 = 25$, we have $4  \\sqrt{17}  5$. Thus, $\\frac{1+4}{8}  \\alpha  \\frac{1+5}{8}$, which means $0.625  \\alpha  0.75$. The condition $1 \\ge \\alpha$ is therefore satisfied.\n\nThe factorization is $A = P^{\\top}L D L^{\\top}P$. We initialize with $P=I_{4}$, $L=I_{4}$.\n\n**Step 1: Factorization of $A$**\n\n**Iteration $k=1$:**\nThe active matrix is $A^{(1)} = A$. We consider the first column and the diagonal element $a_{11}^{(1)} = 1$.\nThe largest off-diagonal element in the first column is $\\lambda_1 = \\max_{i1} |a_{i1}^{(1)}| = \\max(|0|, |0|, |1|) = 1$.\nWe check the condition for a $1 \\times 1$ pivot:\n$$\n|a_{11}^{(1)}| \\ge \\alpha \\lambda_1 \\implies |1| \\ge \\alpha \\cdot 1\n$$\nSince $1 \\ge \\alpha$, the condition is met. We choose a $1 \\times 1$ pivot, $d_1 = a_{11}^{(1)} = 1$. No permutation is required, so $P$ remains the identity matrix.\n\nThe multipliers for the first column of $L$ are computed as $l_{i1} = a_{i1}^{(1)}/d_1$ for $i1$:\n$l_{21} = 0/1 = 0$\n$l_{31} = 0/1 = 0$\n$l_{41} = 1/1 = 1$\nThe first column of $L$, below the diagonal, is $(0, 0, 1)^{\\top}$.\n\nThe trailing submatrix is updated using the Schur complement. Let $v_1 = (a_{21}, a_{31}, a_{41})^{\\top} = (0, 0, 1)^{\\top}$.\n$$\nA^{(2)} = A_{2:4,2:4}^{(1)} - \\frac{1}{d_1} v_1 v_1^{\\top} = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 1  1  3 \\end{pmatrix} - \\frac{1}{1} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\end{pmatrix}\n$$\n$$\nA^{(2)} = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 1  1  3 \\end{pmatrix} - \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0  1 \\\\ 0  1  1 \\\\ 1  1  2 \\end{pmatrix}\n$$\n\n**Iteration $k=2$:**\nThe active matrix is $A^{(2)}$, with indices $\\{2, 3, 4\\}$. We consider its first column and the element $a_{22}^{(2)} = 1$.\nThe largest off-diagonal element in this column is $\\lambda_2 = \\max_{i2} |a_{i2}^{(2)}| = \\max(|0|, |1|) = 1$.\nWe check the condition for a $1 \\times 1$ pivot:\n$$\n|a_{22}^{(2)}| \\ge \\alpha \\lambda_2 \\implies |1| \\ge \\alpha \\cdot 1\n$$\nThis condition is also met. We choose a $1 \\times 1$ pivot, $d_2 = a_{22}^{(2)} = 1$. No permutation is needed.\n\nThe multipliers for the second column of $L$ are $l_{i2} = a_{i2}^{(2)}/d_2$ for $i2$:\n$l_{32} = 0/1 = 0$\n$l_{42} = 1/1 = 1$\nThe second column of $L$, below the diagonal, is $(0, 1)^{\\top}$.\n\nThe trailing submatrix is updated. Let $v_2 = (a_{32}^{(2)}, a_{42}^{(2)})^{\\top} = (0, 1)^{\\top}$.\n$$\nA^{(3)} = A_{3:4,3:4}^{(2)} - \\frac{1}{d_2} v_2 v_2^{\\top} = \\begin{pmatrix} 1  1 \\\\ 1  2 \\end{pmatrix} - \\frac{1}{1} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\end{pmatrix}\n$$\n$$\nA^{(3)} = \\begin{pmatrix} 1  1 \\\\ 1  2 \\end{pmatrix} - \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n\n**Iteration $k=3$:**\nThe active matrix is $A^{(3)}$, with indices $\\{3, 4\\}$. We consider $a_{33}^{(3)} = 1$.\nThe largest (and only) off-diagonal element is $\\lambda_3 = |a_{43}^{(3)}| = |1| = 1$.\nWe check the condition for a $1 \\times 1$ pivot:\n$$\n|a_{33}^{(3)}| \\ge \\alpha \\lambda_3 \\implies |1| \\ge \\alpha \\cdot 1\n$$\nThe condition is met. The pivot is $d_3 = a_{33}^{(3)} = 1$. No permutation is needed.\n\nThe multiplier for the third column of $L$ is $l_{43} = a_{43}^{(3)}/d_3 = 1/1 = 1$.\n\nThe final $1 \\times 1$ submatrix is updated. Let $v_3 = (a_{43}^{(3)}) = (1)$.\n$$\nA^{(4)} = (a_{44}^{(3)}) - \\frac{1}{d_3} v_3 v_3^{\\top} = (1) - \\frac{1}{1} (1)(1) = 1 - 1 = 0\n$$\nThe last pivot is $d_4 = A^{(4)} = 0$.\n\n**Factorization Results:**\nNo permutations were performed, thus $P=I_4$. The factorization is $A = LDL^{\\top}$.\nThe block diagonal matrix $D$ consists of the pivots we found:\n$$\nD = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  0\n\\end{pmatrix}\n$$\nThe unit lower triangular matrix $L$ is constructed from the multipliers:\n$$\nL = \\begin{pmatrix}\n1  0  0  0 \\\\\nl_{21}  1  0  0 \\\\\nl_{31}  l_{32}  1  0 \\\\\nl_{41}  l_{42}  l_{43}  1\n\\end{pmatrix} = \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n1  1  1  1\n\\end{pmatrix}\n$$\nThe singularity of $A$ is confirmed by the zero pivot $d_4=0$.\n\n**Step 2: Find a non-zero vector $x$ such that $Ax=0$**\n\nWe need to solve $Ax = 0$. Using the factorization, this is $LDL^{\\top}x = 0$.\nLet $z = L^{\\top}x$. The equation becomes $LDz = 0$. Since $L$ is invertible (it is unit lower triangular), this is equivalent to $Dz=0$.\nWe need to find a non-zero vector $z$ that satisfies $Dz=0$:\n$$\n\\begin{pmatrix}\n1  0  0  0 \\\\\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  0\n\\end{pmatrix}\n\\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\\\ z_4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThis yields $z_1=0$, $z_2=0$, $z_3=0$, and $0 \\cdot z_4 = 0$. The last equation is true for any $z_4$. To find a non-zero vector $z$, we can choose any non-zero value for $z_4$. Let's choose $z_4=1$.\nSo, a suitable vector is $z = (0, 0, 0, 1)^{\\top}$.\n\nNow, we solve for $x$ from $L^{\\top}x = z$:\n$$\nL^{\\top} = \\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n0  0  1  1 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\nThe system of equations is:\n$$\n\\begin{pmatrix}\n1  0  0  1 \\\\\n0  1  0  1 \\\\\n0  0  1  1 \\\\\n0  0  0  1\n\\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nWe solve this upper triangular system by back substitution:\nFrom the last row: $x_4 = 1$.\nFrom the third row: $x_3 + x_4 = 0 \\implies x_3 + 1 = 0 \\implies x_3 = -1$.\nFrom the second row: $x_2 + x_4 = 0 \\implies x_2 + 1 = 0 \\implies x_2 = -1$.\nFrom the first row: $x_1 + x_4 = 0 \\implies x_1 + 1 = 0 \\implies x_1 = -1$.\nThus, a non-zero vector in the null space of $A$ is $x = (-1, -1, -1, 1)^{\\top}$. The components are integers as required.\n\nFinal answer should be a row vector.\n$x^{\\top} = \\begin{pmatrix} -1  -1  -1  1 \\end{pmatrix}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1  -1  -1  1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}