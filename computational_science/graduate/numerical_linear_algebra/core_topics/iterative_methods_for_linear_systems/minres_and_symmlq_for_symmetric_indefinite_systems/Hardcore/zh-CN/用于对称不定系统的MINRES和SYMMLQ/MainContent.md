## 引言
求解大规模线性方程组 $A x = b$ 是科学与工程计算的核心任务。当系数矩阵 $A$ 对称且正定时，[共轭梯度法](@entry_id:143436)（CG）是公认的高效选择。然而，在优化、[流体力学](@entry_id:136788)和数据科学等众多前沿领域，问题往往导向对称但**不定**的线性系统，即矩阵 $A$ 同时具有正负[特征值](@entry_id:154894)。在这种情况下，[共轭梯度法](@entry_id:143436)的理论基础和[数值稳定性](@entry_id:146550)均告失效，为求解这类关键问题带来了重大挑战。

本文旨在填补这一空白，系统地介绍两种专门为[对称不定系统](@entry_id:755718)设计的经典迭代方法：最小残量法（[MINRES](@entry_id:752003)）和对称LQ方法（SYMMLQ）。这两种方法虽然都源于高效的[Lanczos过程](@entry_id:751124)，但采用了截然不同的优化策略，从而在收敛性、鲁棒性和应用场景上各具特色。通过学习本文，读者将能够深刻理解这两种方法的内在机制，并掌握在不同应用背景下选择和使用它们的关键考量。

为实现这一目标，本文将分为三个部分。首先，在“**原理与机制**”一章中，我们将深入剖析[MINRES](@entry_id:752003)和SYMMLQ的数学原理，阐明它们如何巧妙地绕开[共轭梯度法](@entry_id:143436)遇到的障碍。接着，在“**应用与跨学科联系**”一章中，我们将展示这些算法如何在[优化问题](@entry_id:266749)、[数据拟合](@entry_id:149007)和工程仿真等实际场景中发挥关键作用。最后，通过“**动手实践**”部分提供的一系列计算练习，读者将有机会亲手实现并验证这些算法，将理论知识转化为实践能力。

## 原理与机制

在求解大型线性方程组 $A x = b$ 时，如果矩阵 $A$ 是[对称正定](@entry_id:145886)的（Symmetric Positive Definite, SPD），[共轭梯度法](@entry_id:143436)（Conjugate Gradient, CG）无疑是首选的迭代方法。然而，在科学与工程的众多领域，如[流体力学](@entry_id:136788)中的[斯托克斯方程](@entry_id:196346)、[结构力学](@entry_id:276699)以及[优化问题](@entry_id:266749)中，我们常常会遇到矩阵 $A$ 虽然对称但却是**不定**的（Symmetric Indefinite）情形。这意味着 $A$ 同时拥有正[特征值](@entry_id:154894)和负[特征值](@entry_id:154894)。在这种情况下，[共轭梯度法](@entry_id:143436)的理论基础和数值稳定性都将不复存在，我们需要更通用的方法。

本章将深入探讨两种专门为求解对称（但不必是正定）线性系统而设计的经典 [Krylov 子空间方法](@entry_id:144111)：最小残量法（[MINRES](@entry_id:752003)）和对称 LQ 方法（SYMMLQ）。这两种方法均由 Christopher Paige 和 Michael Saunders 于 1975 年提出，它们都基于对称 Lanczos 过程，但采用了截然不同的优化准则，从而导致了它们在收敛行为、[数值稳定性](@entry_id:146550)及实现细节上的显著差异。我们将从基本原理出发，系统地剖析这两种方法的内在机制，并探讨它们在实际应用中的关键考量。

### [对称不定系统](@entry_id:755718)带来的挑战：为何[共轭梯度法](@entry_id:143436)会失效？

要理解 [MINRES](@entry_id:752003) 和 SYMMLQ 的设计动机，我们必须首先明确为何标准共轭梯度法不适用于[对称不定系统](@entry_id:755718)。CG 方法的推导与一个[优化问题](@entry_id:266749)紧密相连：求解 $A x = b$ 等价于最小化二次泛函：

$$
\phi(x) = \frac{1}{2} x^\top A x - x^\top b
$$

该泛函的梯度是 $\nabla \phi(x) = A x - b$，即系统的残量 $r(x)$。其 Hessian 矩阵为 $A$。当 $A$ 是 SPD 矩阵时，$\phi(x)$ 是一个严格的[凸函数](@entry_id:143075)，它具有碗状的几何形态和唯一的[全局最小值](@entry_id:165977)点，该点恰好是 $A x = b$ 的解。CG 方法通过构造一组 $A$-共轭的搜索方向，保证了在[能量范数](@entry_id:274966) $\|e_k\|_A = \sqrt{(x-x_k)^\top A (x-x_k)}$（其中 $e_k = x - x_k$ 是误差）意义下的单调收敛。

然而，当 $A$ 是不定的，这一切都改变了 。

1.  **非凸的优化目标**：如果 $A$ 含有负[特征值](@entry_id:154894)，二次型 $x^\top A x$ 可以取负值。此时，$\phi(x)$ 不再是[凸函数](@entry_id:143075)，其几何形态变为一个**鞍面**。CG 作为一种为[凸优化](@entry_id:137441)设计的下降算法，在鞍面上可能会迷失方向，无法保证收敛到作为[鞍点](@entry_id:142576)的解。

2.  **[内积](@entry_id:158127)的失效**：$A$-共轭性的概念依赖于双线性形式 $\langle u, v \rangle_A = u^\top A v$ 是一个[内积](@entry_id:158127)。这要求 $\langle u, u \rangle_A = u^\top A u > 0$ 对所有非[零向量](@entry_id:156189) $u$ 成立，这正是 $A$ 正定的定义。如果 $A$ 不定，$\langle \cdot, \cdot \rangle_A$ 不再是[内积](@entry_id:158127)，因为对于与负[特征值](@entry_id:154894)相关的[特征向量](@entry_id:151813) $v$，我们有 $v^\top A v = \lambda v^\top v  0$。

3.  **算法的崩溃**：在 CG 算法的迭代过程中，计算步长的分母包含项 $p_k^\top A p_k$。当 $A$ 不定时，这一项可能为零（导致除零错误，称为**[支点](@entry_id:166575)崩溃 (pivot breakdown)**）或为负（导致步长符号错误和迭代不稳定）。

因此，对于[对称不定系统](@entry_id:755718)，我们需要不依赖于 $A$ 的[正定性](@entry_id:149643)，并且在更通用的范数（如标准的欧几里得范数）下具有可靠收敛保证的方法。[MINRES](@entry_id:752003) 和 SYMMLQ 正是为此而生。

### Lanczos 过程：共同的基石

[MINRES](@entry_id:752003) 和 SYMMLQ 都建立在**对称 Lanczos 过程**之上。该过程是为[对称矩阵](@entry_id:143130) $A$ 生成 [Krylov 子空间](@entry_id:751067) $\mathcal{K}_k(A, r_0) = \mathrm{span}\{r_0, A r_0, \dots, A^{k-1} r_0\}$ 的[标准正交基](@entry_id:147779) $V_k = [v_1, \dots, v_k]$ 的一种极其高效的算法。其核心是一个**[三项递推关系](@entry_id:176845)**：

$$
\beta_{j+1} v_{j+1} = A v_j - \alpha_j v_j - \beta_j v_{j-1}
$$

其中 $\alpha_j = v_j^\top A v_j$ 和 $\beta_j$ 是确保 $v_j$ 相互正交和归一化的系数。这个[递推关系](@entry_id:189264)意味着，在任意步骤 $j$，计算下一个 Lanczos 向量 $v_{j+1}$ 仅需要前两个向量 $v_j$ 和 $v_{j-1}$。这一特性使得基于 Lanczos 过程的算法（如 [MINRES](@entry_id:752003) 和 SYMMLQ）可以实现**短递推**，从而避免了存储整个 Krylov 基 $V_k$，极大地节省了内存。

用矩阵形式表示，Lanczos 过程给出了如下关系：

$$
A V_k = V_k T_k + \beta_{k+1} v_{k+1} e_k^\top
$$

或者等价地

$$
A V_k = V_{k+1} \underline{T}_k
$$

这里，$T_k$ 是一个 $k \times k$ 的[对称三对角矩阵](@entry_id:755732)，其元素由递推系数 $\alpha_j$ 和 $\beta_j$ 构成。$\underline{T}_k$ 是一个 $(k+1) \times k$ 的[三对角矩阵](@entry_id:138829)，它是在 $T_k$ 的下方增加一行，该行仅在第 $k$ 列有非零元素 $\beta_{k+1}$。这个关系将原 $n \times n$ 的大系统 $A x = b$ 投影到了 $k \times k$ 的三对角小系统上，这是所有 Lanczos 类方法的核心思想。

### [MINRES](@entry_id:752003): 最小残量原理

[MINRES](@entry_id:752003) 的设计哲学非常直观：在每一步迭代中，寻找一个近似解 $x_k$，使得该解在当前搜索空间内的残量**[欧几里得范数](@entry_id:172687)** $\|r_k\|_2$ 达到最小   。

**核心原理**:
在第 $k$ 步，[MINRES](@entry_id:752003) 寻找 $x_k \in x_0 + \mathcal{K}_k(A, r_0)$ 使得

$$
\|r_k\|_2 = \|b - A x_k\|_2 = \min_{x \in x_0 + \mathcal{K}_k(A, r_0)} \|b - A x\|_2
$$

**实现机制**:
设近似解为 $x_k = x_0 + V_k y_k$，其中 $y_k \in \mathbb{R}^k$ 是待定系数向量。残量可以表示为：

$$
r_k = b - A(x_0 + V_k y_k) = r_0 - A V_k y_k
$$

利用 Lanczos 关系 $r_0 = \|r_0\|_2 v_1 = \|r_0\|_2 V_{k+1} e_1$ 和 $A V_k = V_{k+1} \underline{T}_k$，我们得到：

$$
r_k = \|r_0\|_2 V_{k+1} e_1 - V_{k+1} \underline{T}_k y_k = V_{k+1} (\|r_0\|_2 e_1 - \underline{T}_k y_k)
$$

由于 $V_{k+1}$ 的列是标准正交的，它是一个保范变换。因此，最小化 $\|r_k\|_2$ 等价于最小化 $\|\|r_0\|_2 e_1 - \underline{T}_k y_k\|_2$。这转化为了一个 $(k+1) \times k$ 的三对角**线性[最小二乘问题](@entry_id:164198)**。该问题总是良定的，并且可以通过 QR 分解（通常使用 Givens 旋转进行高效的步进更新）稳定地求解，无论 $A$ 或 $T_k$ 是否定。

**特性与优势**:
1.  **单调收敛的残量**: 由于每一步都最小化残量范数，[MINRES](@entry_id:752003) 生成的残量范数序列 $\{\|r_k\|_2\}$ 保证是单调不增的。这提供了平滑且可预测的收敛过程。
2.  **对不定性鲁棒**: [MINRES](@entry_id:752003) 的核心计算是一个[最小二乘问题](@entry_id:164198)，该问题不依赖于 $T_k$ 的[正定性](@entry_id:149643)，甚至在 $T_k$ 奇异时也能稳定求解。这使得 [MINRES](@entry_id:752003) 对于[对称不定系统](@entry_id:755718)非常**鲁棒** 。

### SYMMLQ: Galerkin 条件与投影原理

与 [MINRES](@entry_id:752003) 不同，SYMMLQ 并不直接最小化残量范数。相反，它采用了一种**Galerkin 方法**，即将原方程 $A x = b$ 投影到 [Krylov 子空间](@entry_id:751067)上求解   。

**核心原理**:
在第 $k$ 步，SYMMLQ 寻找 $x_k \in x_0 + \mathcal{K}_k(A, r_0)$ 使得其残量 $r_k$ 与当前的 Krylov 子空间 $\mathcal{K}_k(A, r_0)$ **正交**，即：

$$
r_k \perp \mathcal{K}_k(A, r_0) \quad \text{或} \quad V_k^\top r_k = 0
$$

**实现机制**:
将 $r_k = r_0 - A V_k y_k$ 代入 Galerkin 条件：

$$
V_k^\top (r_0 - A V_k y_k) = 0 \implies (V_k^\top A V_k) y_k = V_k^\top r_0
$$

利用 Lanczos 关系 $T_k = V_k^\top A V_k$ 和 $r_0 = \|r_0\|_2 v_1$，我们得到 $V_k^\top r_0 = \|r_0\|_2 e_1$。于是，Galerkin 条件转化为一个 $k \times k$ 的对称三对角[线性方程组](@entry_id:148943)：

$$
T_k y_k = \|r_0\|_2 e_1
$$

SYMMLQ 的名称来源于它使用一种基于 LQ 分解的稳定算法来求解这个[三对角系统](@entry_id:635799)。

**特性与讨论**:
1.  **与 CG 的联系**: 当 $A$ 是 SPD 矩阵时，Galerkin 条件 $r_k \perp \mathcal{K}_k(A, r_0)$ 与 CG 的能量范数最小化 $\|x - x_k\|_A$ 是等价的。在这种情况下，SYMMLQ 和 CG 在理论上生成相同的迭代点。

2.  **[不定系统](@entry_id:750604)下的行为**:
    *   **无范数最小化保证**：当 $A$ 不定时，$e^\top A e$ 不再是范数，其值可正可负。最小化一个可以为负的量是没有意义的。SYMMLQ 并不最小化任何标[准范数](@entry_id:753960)下的误差或残量。我们可以通过一个简单的例子来说明，最小化残量范数（[MINRES](@entry_id:752003) 的策略）与最小化 $e^\top A e$ 是截然不同的 。考虑 $A=\mathrm{diag}(2, -1)$, $b=(2, 1)^\top$, 从 $x_0=0$ 出发沿方向 $r_0=b$ 搜索。最小化 $\|r(tb)\|_2$ 得到的步长 $t_r = 7/17$，而最小化 $e(tb)^\top A e(tb)$ 得到的步长是 $t_A=5/7$。两者并不相等，表明这两种优化目标在不定情况下是矛盾的。
    *   **非单调的残量**: 由于 SYMMLQ 不最小化残量范数，其残量范数 $\|r_k\|_2$ 不保证单调下降，可能会出现震荡。
    *   **对奇异性的敏感性**: SYMMLQ 的核心是求解 $T_k y_k = \|r_0\|_2 e_1$。如果 $A$ 是不定的，[投影矩阵](@entry_id:154479) $T_k$ 也可能是不定的，甚至可能在某一步 $k$ 变得**奇异或接近奇异**。此时，求解该[方程组](@entry_id:193238)会变得非常不稳定，甚至导致算法失败。这使得 SYMMLQ 在鲁棒性上不如 [MINRES](@entry_id:752003) 。

### 实际应用中的考量

除了核心原理的差异，[MINRES](@entry_id:752003) 和 SYMMLQ 在实际实现和使用中还有一些重要的区别。

#### 存储需求

由于 [MINRES](@entry_id:752003) 和 SYMMLQ 都基于[三项递推](@entry_id:755957)的 Lanczos 过程，它们都属于**短递推**方法，内存开销远小于需要存储整个 Krylov 基的 GMRES 等方法。然而，它们之间仍有细微差别。分析其更新公式可以发现，为了更新解向量 $x_k$，SYMMLQ 的[方向向量](@entry_id:169562)仅需一个两项递推，而 [MINRES](@entry_id:752003) 的[方向向量](@entry_id:169562)则需要一个[三项递推](@entry_id:755957)。

具体来说，在一次典型的迭代中，两种方法的峰值内存需求（以长度为 $n$ 的向量为单位）如下 ：
*   **SYMMLQ**: 需要存储当前解 $x_k$、两个最新的 Lanczos 向量 $v_{k-1}, v_k$、一个 SYMMLQ 方向向量 $w_{k-1}$，以及一个用于计算[矩阵向量积](@entry_id:151002)的临时工作向量。总计 $4+1 = 5$ 个向量。
*   **[MINRES](@entry_id:752003)**: 需要存储当前解 $x_k$、两个最新的 Lanczos 向量 $v_{k-1}, v_k$、两个 [MINRES](@entry_id:752003) [方向向量](@entry_id:169562) $p_{k-1}, p_{k-2}$，以及一个工作向量。总计 $5+1 = 6$ 个向量。

因此，[MINRES](@entry_id:752003) 通常比 SYMMLQ 多需要一个向量的存储空间。这个比率是 $\frac{6}{5}$。在内存极其受限的情况下，这可能是一个需要考虑的因素，但通常这个差异并不显著。

#### 鲁棒的[停止准则](@entry_id:136282)

为迭代方法设计一个可靠的[停止准则](@entry_id:136282)是至关重要的。一个好的准则应该基于**范数[后向误差](@entry_id:746645)**（normwise backward error），并且对问题的缩放不敏感。其通用形式为：

$$
\frac{\|b - A x_k\|_2}{\|A\|_2 \|x_k\|_2 + \|b\|_2} \le \tau
$$

其中 $\tau$ 是用户设定的容差。分母中的 $\|A\|_2$ 和 $\|x_k\|_2$ 使得该准则对系统 $A x = b$ 的一致缩放（例如，变为 $(\gamma A) x = (\gamma b)$）具有[不变性](@entry_id:140168)。

挑战在于，迭代过程中我们并没有直接计算 $\|r_k\|_2 = \|b-Ax_k\|_2$，因为这需要额外的[矩阵向量积](@entry_id:151002)。幸运的是，我们可以从算法内部的量廉价地计算出它。对于 SYMMLQ，虽然它不最小化 $\|r_k\|_2$，但我们可以精确地追踪它。通过分析 Lanczos 关系，可以推导出 SYMMLQ 残量范数的精确表达式 ：

$$
\|r_k\|_2 = \sqrt{\|\rho_k\|_2^2 + (\beta_{k+1} \zeta_k)^2}
$$

其中 $\rho_k = \|r_0\|_2 e_1 - T_k y_k$ 是投影系统 $T_k y_k = \|r_0\|_2 e_1$ 的残量，$\beta_{k+1}$ 是下一个 Lanczos 系数，而 $\zeta_k$ 是 $y_k$ 的最后一个分量。这些量在 SYMMLQ 迭代中都是已知的。将这个精确的残量范数代入[后向误差](@entry_id:746645)公式，就得到了 SYMMLQ 的一个鲁棒且可计算的[停止准则](@entry_id:136282)。

#### 数值稳定性与算法崩溃

##### 1. [矩阵范数](@entry_id:139520)的估计

在实现上述[停止准则](@entry_id:136282)时，我们需要 $\|A\|_2$ 的值，但它通常是未知的。我们可以利用 Lanczos 过程在迭代中对其进行估计。由于 $T_k = V_k^\top A V_k$，根据 Courant-Fischer 定理，$\|T_k\|_2 \le \|A\|_2$。在 [MINRES](@entry_id:752003) 中，通过对 $\underline{T}_k$ 进行 QR 分解得到上三角矩阵 $R_k$。可以证明，在精确算术下，$\eta_k = \max_i |(R_k)_{ii}|$ 是 $\|T_k\|_2$ 的一个下界，因此也是 $\|A\|_2$ 的一个下界 。

然而，在有限精度计算中，Lanczos 向量的**正交性会逐渐丧失**。这可能导致计算出的 $T_k$ 的[特征值](@entry_id:154894)（Ritz 值）漂移到 $A$ 真实谱范围之外。结果是，计算出的 $\|T_k\|_2$ 及其估计值 $\eta_k$ 可能偶尔会**超过** $\|A\|_2$。因此，在实践中，这个估计值应被视为一个通常相当准确但并非绝对可靠的**[启发式](@entry_id:261307)估计**。

##### 2. SYMMLQ 的不稳定性

如前所述，SYMMLQ 在求解 $T_k y_k = \|r_0\|_2 e_1$ 时可能面临困难。其 LQ 分解 $T_k = L_k Q_k$ 会产生一个下双[对角矩阵](@entry_id:637782) $L_k$。如果 $T_k$ 接近奇异，那么 $L_k$ 的某个对角元素 $\ell_{k,k}$ 就会非常小。在求解三角系统时，这会导致解的**[前向误差](@entry_id:168661)**被 $L_k$ 的[条件数](@entry_id:145150) $\kappa_2(L_k)$ 放大，而 $\kappa_2(L_k)$ 又反比于最小的 $|\ell_{j,j}|$。

为了防止这种数值不稳定导致的精度损失，可以设置一个切换准则。当检测到潜在的不稳定时，切换到一个更稳健的变体。一个合理的无量纲准则是在 $|\ell_{k,k}| / \|T_k\|_2$ 小于某个阈值时触发切换。一个理论上合理的阈值是 $\sqrt{u}$，其中 $u$ 是机器精度。这样可以确保[前向误差](@entry_id:168661)的增长被控制在可接受的范围内 。

$$
\text{切换准则}: \quad \frac{|\ell_{k,k}|}{\|T_k\|_2} \le \sqrt{u}
$$

相比之下，[MINRES](@entry_id:752003) 对此种不稳定性不敏感，因为它的最小二乘子问题即使在 $T_k$ 奇异时也保持良定。

##### 3. Lanczos 过程的崩溃与 Look-Ahead 策略

两种方法都面临着 Lanczos 过程本身的崩溃风险，即当某个系数 $\beta_j$ 变得非常小时。天真地继续计算会导致除以一个很小的数，从而引发数值不稳定。

一个先进的补救措施是**look-ahead Lanczos**（前瞻 Lanczos）策略 。其思想是，当检测到一个小的 $\beta_j$ 时，不立即停止或认为算法失败，而是“前瞻”几步，继续生成 Lanczos 向量，直到找到一个足够大的 $\beta_{j+\ell}$。这相当于将这 $\ell+1$ 个“坏”步骤**组合**成一个“超级块”。

在 [MINRES](@entry_id:752003) 中，这会导致[三对角矩阵](@entry_id:138829) $T_k$ 中出现一个 $(\ell+1) \times (\ell+1)$ 的小块。为了不破坏算法的短递推特性，可以对这个小块进行局部的 QR 分解，然后将产生的 Givens 旋转“折叠”到主 QR 分解过程中。这样，解向量的更新仍然可以表示为少数几个[方向向量](@entry_id:169562)的短递推，从而在不牺牲内存效率的前提下，极大地增强了算法对 Lanczos 崩溃的鲁棒性。

### 结论：[MINRES](@entry_id:752003) vs. SYMMLQ

| 特性 | [MINRES](@entry_id:752003) (最小残量法) | SYMMLQ (对称 LQ 方法) |
| :--- | :--- | :--- |
| **核心原理** | 最小化残量范数 $\|r_k\|_2$ | 施加 Galerkin 条件 $r_k \perp \mathcal{K}_k(A, r_0)$ |
| **子问题** | $(k+1) \times k$ [最小二乘问题](@entry_id:164198) | $k \times k$ 对称[三对角系统](@entry_id:635799) |
| **收敛行为** | $\|r_k\|_2$ **单调不增**，收敛平滑 | $\|r_k\|_2$ 可能震荡 |
| **对不定性鲁棒性** | **高**。最小二乘问题总是良定的。 | **中等**。当 $T_k$ 奇异或近奇异时可能不稳定。 |
| **存储需求** | 略高（约 6 个 $n$-维向量） | 略低（约 5 个 $n$-维向量） |
| **与 CG 关系** | 无直接关系 | 在 $A$ 为 SPD 时与 CG 等价 |

综上所述，[MINRES](@entry_id:752003) 和 SYMMLQ 都是处理大型稀疏[对称线性系统](@entry_id:755721)的强大工具，它们成功地将适用范围从正定矩阵扩展到了[不定矩阵](@entry_id:634961)。[MINRES](@entry_id:752003) 以其无与伦比的鲁棒性和平滑的收敛曲线为代价，牺牲了微不足道的额外内存。SYMMLQ 在 SPD 情形下继承了 CG 的优良特性，但在不定情形下则需警惕其潜在的[数值不稳定性](@entry_id:137058)。在大多数对称不定问题的应用中，[MINRES](@entry_id:752003) 通常被认为是更安全、更可靠的选择。