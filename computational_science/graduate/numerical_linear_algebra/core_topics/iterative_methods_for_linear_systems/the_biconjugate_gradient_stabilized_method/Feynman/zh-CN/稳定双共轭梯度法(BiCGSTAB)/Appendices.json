{
    "hands_on_practices": [
        {
            "introduction": "掌握任何迭代方法的第一步都是要透彻理解其核心迭代过程。本练习将引导你手动完成 BiCGSTAB 方法的完整一轮迭代 。通过为一个具体的 $2 \\times 2$ 线性系统计算每一步的标量和向量，你将亲身体验从双共轭梯度（BiCG）投影到局部极小残差（MR）稳定化步骤的完整流程，从而牢固掌握算法各部分的数学意义和相互作用。",
            "id": "3585874",
            "problem": "考虑线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是非奇异矩阵。Krylov子空间方法通过根据Petrov–Galerkin条件和在低维子空间中进行残差最小化等原则，对残差 $r_{k} = b - A x_{k}$ 进行投影来构造近似解 $x_{k}$。双共轭梯度稳定(BiCGSTAB)方法是通过将双共轭梯度(BiCG)方法的双正交投影特性与局部最小残差稳定化步骤相结合而得到的。\n\n从以下经过充分检验的原则出发：\n- 欧几里得内积为 $\\langle u, v \\rangle = u^{\\top} v$，欧几里得（二-）范数为 $\\|u\\|_{2} = \\sqrt{\\langle u, u \\rangle}$。\n- 对于通过搜索方向更新得到的中间残差，使用固定的非零“影子残差”$\\tilde r$ 的Petrov–Galerkin投影强制要求 $\\langle \\tilde r, r_{k+1} \\rangle = 0$。\n- 给定一个非零的中间残差 $s_{k}$，使得 $\\|s_{k} - \\omega A s_{k}\\|_{2}$ 在 $\\omega \\in \\mathbb{R}$ 上最小化的标量 $\\omega_{k}$ 由最小二乘问题产生的正规方程确定。\n\n使用这些原则，对以下特定数据执行一次完整的双共轭梯度稳定(BiCGSTAB)方法迭代：\n$$\nA = \\begin{bmatrix}2  -1 \\\\ 1  3\\end{bmatrix}, \\quad\nb = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix}, \\quad\nx_{0} = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}, \\quad\n\\tilde r = r_{0},\n$$\n使用标准初始化 $r_{0} = b - A x_{0}$ 和 $p_{0} = r_{0}$。数值计算标量和向量\n$$\n\\rho_{0}, \\ \\alpha_{0}, \\ s_{0}, \\ \\omega_{0}, \\ x_{1}, \\ r_{1}, \\ p_{1}.\n$$\n\n答案要求：\n- 使用标准欧几里得内积 $\\langle u, v \\rangle = u^{\\top} v$。\n- 作为最终报告的量，请提供单一标量值 $\\|r_{1}\\|_{2}^{2}$，形式为最简精确有理数。\n- 不要四舍五入；由于要求精确有理数答案，因此不需要有效数字说明。",
            "solution": "问题陈述经评估有效。它在科学上基于数值线性代数的既定原则，特别是双共轭梯度稳定(BiCGSTAB)方法。该问题是适定的，为算法的一次完整迭代提供了所有必要的数据。数据和目标是客观陈述的，没有矛盾或含糊之处。因此，我将开始解答。\n\n任务是为给定的线性系统 $A x = b$ 执行一次完整的BiCGSTAB方法迭代。该算法由一系列明确定义的步骤组成。我们从索引 $k=0$ 开始。\n\n**步骤 0：初始化**\n\n解的初始猜测值为 $x_{0} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n初始残差 $r_{0}$ 计算为 $r_{0} = b - A x_{0}$。\n给定 $A = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix}$ 和 $b = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$：\n$A x_{0} = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n因此， $r_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n\n问题指定初始“影子残差”为 $\\tilde{r}_{0} = r_{0}$，所以 $\\tilde{r}_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n初始搜索方向为 $p_{0} = r_{0}$，所以 $p_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n\n**迭代 $k=0$**\n\n1.  **计算 $\\rho_{0}$：**\n    标量 $\\rho_{0}$ 由内积 $\\rho_{0} = \\langle \\tilde{r}_{0}, r_{0} \\rangle$ 定义。\n    使用欧几里得内积 $\\langle u, v \\rangle = u^{\\top} v$：\n    $\\rho_{0} = r_{0}^{\\top} r_{0} = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = (1)(1) + (0)(0) = 1$。\n\n2.  **计算 $v_{0} = A p_{0}$：**\n    $v_{0} = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} (2)(1) + (-1)(0) \\\\ (1)(1) + (3)(0) \\end{bmatrix} = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n\n3.  **计算 $\\alpha_{0}$：**\n    标量 $\\alpha_{0}$ 是从中间更新的Petrov-Galerkin条件推导出来的，即 $\\alpha_{0} = \\frac{\\rho_{0}}{\\langle \\tilde{r}_{0}, v_{0} \\rangle}$。\n    分母中的内积为：\n    $\\langle \\tilde{r}_{0}, v_{0} \\rangle = \\tilde{r}_{0}^{\\top} v_{0} = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = (1)(2) + (0)(1) = 2$。\n    因此，$\\alpha_{0} = \\frac{1}{2}$。\n\n4.  **计算中间残差 $s_{0}$：**\n    $s_{0} = r_{0} - \\alpha_{0} v_{0}$。\n    $s_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\frac{1}{2} \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 1/2 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix}$。\n\n5.  **计算 $t_{0} = A s_{0}$：**\n    $t_{0} = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix} = \\begin{bmatrix} (2)(0) + (-1)(-1/2) \\\\ (1)(0) + (3)(-1/2) \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix}$。\n\n6.  **计算 $\\omega_{0}$：**\n    选择标量 $\\omega_{0}$ 以最小化 $\\|s_{0} - \\omega A s_{0}\\|_{2}$，这等价于最小化 $\\|s_{0} - \\omega t_{0}\\|_{2}$。这个最小二乘问题的解由正规方程给出，得到 $\\omega_{0} = \\frac{\\langle s_{0}, t_{0} \\rangle}{\\langle t_{0}, t_{0} \\rangle}$。\n    首先，我们计算必要的内积：\n    $\\langle s_{0}, t_{0} \\rangle = s_{0}^{\\top} t_{0} = \\begin{bmatrix} 0  -1/2 \\end{bmatrix} \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix} = (0)(1/2) + (-1/2)(-3/2) = \\frac{3}{4}$。\n    $\\langle t_{0}, t_{0} \\rangle = t_{0}^{\\top} t_{0} = \\begin{bmatrix} 1/2  -3/2 \\end{bmatrix} \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix} = (\\frac{1}{2})^{2} + (-\\frac{3}{2})^{2} = \\frac{1}{4} + \\frac{9}{4} = \\frac{10}{4} = \\frac{5}{2}$。\n    因此，$\\omega_{0} = \\frac{3/4}{5/2} = \\frac{3}{4} \\cdot \\frac{2}{5} = \\frac{6}{20} = \\frac{3}{10}$。\n\n7.  **更新解以得到 $x_{1}$：**\n    $x_{1} = x_{0} + \\alpha_{0} p_{0} + \\omega_{0} s_{0}$。\n    $x_{1} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + \\frac{1}{2} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + \\frac{3}{10} \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ -3/20 \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ -3/20 \\end{bmatrix}$。\n\n8.  **更新残差以得到 $r_{1}$：**\n    $r_{1} = s_{0} - \\omega_{0} t_{0}$。\n    $r_{1} = \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix} - \\frac{3}{10} \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -5/10 \\end{bmatrix} - \\begin{bmatrix} 3/20 \\\\ -9/20 \\end{bmatrix} = \\begin{bmatrix} 0 - 3/20 \\\\ -10/20 - (-9/20) \\end{bmatrix} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix}$。\n\n9.  **更新搜索方向以得到 $p_{1}$：**\n    这需要计算 $\\rho_{1}$ 和 $\\beta_{0}$。\n    $\\rho_{1} = \\langle \\tilde{r}_{0}, r_{1} \\rangle = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix} = -\\frac{3}{20}$。\n    $\\beta_{0} = \\frac{\\rho_{1}}{\\rho_{0}} \\frac{\\alpha_{0}}{\\omega_{0}} = \\frac{-3/20}{1} \\frac{1/2}{3/10} = -\\frac{3}{20} \\cdot \\frac{1}{2} \\cdot \\frac{10}{3} = -\\frac{30}{120} = -\\frac{1}{4}$。\n    搜索方向更新为 $p_{1} = r_{1} + \\beta_{0} (p_{0} - \\omega_{0} v_{0})$。\n    首先，计算括号中的项：\n    $p_{0} - \\omega_{0} v_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\frac{3}{10} \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 6/10 \\\\ 3/10 \\end{bmatrix} = \\begin{bmatrix} 4/10 \\\\ -3/10 \\end{bmatrix} = \\begin{bmatrix} 2/5 \\\\ -3/10 \\end{bmatrix}$。\n    现在，计算 $p_{1}$：\n    $p_{1} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix} + (-\\frac{1}{4}) \\begin{bmatrix} 2/5 \\\\ -3/10 \\end{bmatrix} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix} - \\begin{bmatrix} 2/20 \\\\ -3/40 \\end{bmatrix} = \\begin{bmatrix} -5/20 \\\\ -2/40 + 3/40 \\end{bmatrix} = \\begin{bmatrix} -1/4 \\\\ 1/40 \\end{bmatrix}$。\n\n第一次完整迭代计算出的量是：\n$\\rho_{0} = 1$, $\\alpha_{0} = \\frac{1}{2}$, $s_{0} = \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix}$, $\\omega_{0} = \\frac{3}{10}$, $x_{1} = \\begin{bmatrix} 1/2 \\\\ -3/20 \\end{bmatrix}$, $r_{1} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix}$, $p_{1} = \\begin{bmatrix} -1/4 \\\\ 1/40 \\end{bmatrix}$。\n\n**最终计算**\n\n问题要求计算 $\\|r_{1}\\|_{2}^{2}$。\n$\\|r_{1}\\|_{2}^{2} = \\langle r_{1}, r_{1} \\rangle = r_{1}^{\\top} r_{1} = \\begin{bmatrix} -3/20  -1/20 \\end{bmatrix} \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix}$。\n$\\|r_{1}\\|_{2}^{2} = (-\\frac{3}{20})^{2} + (-\\frac{1}{20})^{2} = \\frac{9}{400} + \\frac{1}{400} = \\frac{10}{400} = \\frac{1}{40}$。\n结果是所要求的精确有理数。",
            "answer": "$$\\boxed{\\frac{1}{40}}$$"
        },
        {
            "introduction": "一个强大的迭代求解器不仅需要高效的迭代核心，更需要智能的“刹车”机制。本练习探讨了为 BiCGSTAB 方法设计稳健停止准则的艺术，这在处理非正规矩阵时尤其重要，因为此时残差的收敛行为可能具有欺骗性 。通过辨析多种策略的优劣，你将学会如何构建一个综合性的判定策略，以有效规避伪收敛和残差漂移等实际应用中的常见陷阱。",
            "id": "3585850",
            "problem": "考虑使用双共轭梯度稳定方法（BiCGSTAB）求解一个非奇异线性系统 $A x = b$，其中矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是一个通用的非对称且可能高度非正规的矩阵。设 $x_k$ 是该算法产生的第 $k$ 次迭代解，真实残差为 $r_k = b - A x_k$。实践者必须确定在非正规性下鲁棒的实用停止准则。以下多项选择题提出了不同的停止策略及其理由。选择一个选项，该选项提供了一个合理的、可实现的策略，该策略整合了2-范数下的相对残差测试、范数后向误差估计和停滞检测，并且在存在非正规性的情况下是合理的。\n\nA. 一旦递推更新的残差满足 $\\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau$（其中 $\\tau$ 为用户容忍度），就宣布成功，而无需显式地重新计算 $r_k$ 或使用任何后向误差估计。不包括停滞检查，因为即使对于非正规矩阵 $A$，下降的残差也足以保证进展。\n\nB. 当一个先验前向误差界表明 $\\lVert x - x_k \\rVert_2 / \\lVert x \\rVert_2 \\le \\tau$ 时宣布成功，该界通过验证 $\\kappa_2(A)\\, \\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau$ 来估计，其中 $\\kappa_2(A)$ 是通过奇异值分解计算一次的矩阵 $A$ 的2-范数条件数。不需要停滞检查，因为条件数加权的残差完全捕捉了非正规性的影响。\n\nC. 如果范数后向误差估计 $\\widehat{\\eta}_k = \\lVert r_k \\rVert_2 / \\big(\\lVert A \\rVert_2 \\lVert x_k \\rVert_2\\big) \\le \\tau$ 成立，则宣布成功，其中为降低成本，使用弗罗贝尼乌斯范数 $\\lVert A \\rVert_F$ 近似 $\\lVert A \\rVert_2$，并为简化起见从分母中省略 $\\lVert b \\rVert_2$。如果在几个步骤中 $\\lVert x_{k+1} - x_k \\rVert_2 / \\lVert x_k \\rVert_2 \\le \\tau_\\text{step}$，则将停滞视为可接受的，因为小步长在非正规问题中表示收敛。\n\nD. 使用如下复合策略。成功：当显式重新计算的相对残差满足 $\\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau_\\text{rel}$ 或保守的范数后向误差界 $\\eta_k$ 满足 $\\eta_k \\le \\tau_\\text{be}$ 时接受，其中\n$$\n\\eta_k \\;\\equiv\\; \\frac{\\lVert r_k \\rVert_2}{L_k \\lVert x_k \\rVert_2 + \\lVert b \\rVert_2}, \n\\qquad L_k \\;\\le\\; \\lVert A \\rVert_2,\n$$\n并且 $L_k$ 是 $\\lVert A \\rVert_2$ 的任意可计算下界，例如 $L_k = \\lVert A u_k \\rVert_2 / \\lVert u_k \\rVert_2$，其中 $u_k$ 是迭代中已有的非零探测向量（例如搜索方向或偶尔刷新的随机向量）。通过至少每 $m$ 次迭代（对于某个小的 $m$）显式地重新计算 $r_k = b - A x_k$ 来验证残差，以控制递推残差和真实残差之间的漂移。停滞：如果在 $s$ 次连续迭代中，残差范数未能按预设的相对因子减小，即对于 $j = 1,\\dots,s$，有 $\\lVert r_{k+j} \\rVert_2 \\ge (1 - \\gamma)\\, \\lVert r_{k+j-1} \\rVert_2$，或者如果步长在数值上极小而没有伴随的残差下降，即 $\\lVert x_{k+1} - x_k \\rVert_2 / (\\lVert x_k \\rVert_2 + 1) \\le \\tau_\\text{step}$ 而 $\\lVert r_{k+1} \\rVert_2 \\ge (1 - c)\\, \\lVert r_k \\rVert_2$，则以停滞标志终止。理由：相对残差是一个廉价的进展指标；范数后向误差 $\\eta_k$ 量化了数据扰动 $(\\delta A,\\delta b)$ 的大小，对于这些扰动，$x_k$ 是 $(A + \\delta A) x_k = b + \\delta b$ 的精确解，并且即使当 $A$ 高度非正规时也仍然有意义；显式残差重算和停滞检查可以防止 BiCGSTAB 中的伪收敛和残差漂移。",
            "solution": "问题要求为使用双共轭梯度稳定（BiCGSTAB）方法求解非奇异线性系统 $A x = b$ 选择一个合理的、可实现的、鲁棒的停止策略，其中矩阵 $A$ 可能是非对称且高度非正规的。一个鲁棒的策略应该能正确处理潜在的问题，例如残差的非单调收敛、舍入误差的灾难性累积（残差漂移）以及误导性的收敛行为（伪收敛），这些问题对于非正规矩阵尤其突出。该策略应整合相对残差测试、范数后向误差估计和停滞检测。\n\n我们将根据数值线性代数中关于迭代求解器的既定原则来分析每个提议的选项。\n\n**A. 一旦递推更新的残差满足 $\\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau$（其中 $\\tau$ 为用户容忍度），就宣布成功，而无需显式地重新计算 $r_k$ 或使用任何后向误差估计。不包括停滞检查，因为即使对于非正规矩阵 $A$，下降的残差也足以保证进展。**\n\n这个选项由于几个原因存在根本性缺陷。\n1.  **递推残差与真实残差**：在 BiCGSTAB 中，与许多克雷洛夫子空间方法一样，残差 $r_k$ 通常通过短期递推关系进行更新以提高计算效率。由于多轮迭代中浮点舍入误差的累积，递推更新的残差可能会“漂移”，并与真实残差 $r_k^\\text{true} = b - A x_k$ 产生显著差异。仅仅依赖递推残差可能导致过早终止，即算法因为计算出的残差很小而停止，但真实残差仍然很大。这是一种被称为残差漂移的著名现象。一个鲁棒的算法必须周期性地重新计算真实残差以纠正这种漂移。\n2.  **停滞与非正规性**：理由“下降的残差足以保证进展”是不正确的。首先，BiCGSTAB 算法不保证残差范数单调下降，特别是对于非正规矩阵，其残差范数可能表现出不规则行为，出现平台期甚至短暂增加。其次，即使残差在下降，下降速度也可能非常慢，以至于算法实际上已经停滞，为微不足道的改进浪费计算资源。停滞检查对于检测这种情况至关重要。\n3.  **缺乏后向误差分析**：该策略完全忽略了任何形式的后向误差分析。对于病态或非正规问题，仅凭残差范数可能是解质量的一个很差的指标。小残差不保证小的前向误差 $\\lVert x - x_k \\rVert_2$。范数后向误差衡量了使得 $x_k$ 成为一个精确解的问题数据（$A$ 和 $b$）的扰动大小，它提供了更可靠的质量保证。\n\n结论：**不正确**。这个策略是幼稚的，并且忽略了迭代求解器关键的、有充分记录的失败模式。\n\n**B. 当一个先验前向误差界表明 $\\lVert x - x_k \\rVert_2 / \\lVert x \\rVert_2 \\le \\tau$ 时宣布成功，该界通过验证 $\\kappa_2(A)\\, \\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau$ 来估计，其中 $\\kappa_2(A)$ 是通过奇异值分解计算一次的矩阵 $A$ 的2-范数条件数。不需要停滞检查，因为条件数加权的残差完全捕捉了非正规性的影响。**\n\n这个选项既不切实际，在理论上也是错误的。\n1.  **计算成本**：该策略要求计算2-范数条件数 $\\kappa_2(A) = \\lVert A \\rVert_2 \\lVert A^{-1} \\rVert_2$。这通常需要对 $A$ 进行奇异值分解（SVD）。对于大型稀疏矩阵（这是像 BiCGSTAB 这样的迭代方法的主要目标），计算完整的 SVD 的成本高得令人望而却步，通常比求解线性系统本身要昂贵得多。\n2.  **悲观的界**：前向误差界 $\\frac{\\lVert x - x_k \\rVert_2}{\\lVert x \\rVert_2} \\le \\kappa_2(A) \\frac{\\lVert r_k \\rVert_2}{\\lVert b \\rVert_2}$ 对于高度非正规矩阵来说是众所周知的极其宽松（悲观）的。依赖它可能导致算法运行时间过长，或者即使已经找到了一个完全可接受的解（在后向误差的意义上）也无法终止。\n3.  **对非正规性的误解**：声称“条件数加权的残差完全捕捉了非正规性的影响”是错误的。条件数关系到解对扰动的敏感性，但它没有描述与非正规矩阵迭代相关的瞬态、非单调的收敛行为。伪谱分析提供了对非正规性更完整的描述，但这对于标准的停止准则来说过于复杂。\n4.  **无停滞检查**：此策略也忽略了停滞检查，如选项A中所解释的，这对于鲁棒性至关重要。\n\n结论：**不正确**。该策略对于大规模问题在计算上是不可行的，并且依赖于一个理论界，而这个界在实践中对于正在考虑的这类矩阵通常是无用的。\n\n**C. 如果范数后向误差估计 $\\widehat{\\eta}_k = \\lVert r_k \\rVert_2 / \\big(\\lVert A \\rVert_2 \\lVert x_k \\rVert_2\\big) \\le \\tau$ 成立，则宣布成功，其中为降低成本，使用弗罗贝尼乌斯范数 $\\lVert A \\rVert_F$ 近似 $\\lVert A \\rVert_2$，并为简化起见从分母中省略 $\\lVert b \\rVert_2$。如果在几个步骤中 $\\lVert x_{k+1} - x_k \\rVert_2 / \\lVert x_k \\rVert_2 \\le \\tau_\\text{step}$，则将停滞视为可接受的，因为小步长在非正规问题中表示收敛。**\n\n这个选项在其表述和理由上包含几个严重错误。\n1.  **错误的后向误差公式**：对于系统 $(A+\\Delta A)x_k = b+\\Delta b$，范数后向误差的标准、鲁棒的上界是 $\\eta_k = \\frac{\\lVert r_k \\rVert_2}{\\lVert A \\rVert \\lVert x_k \\rVert + \\lVert b \\rVert}$。提议的公式 $\\widehat{\\eta}_k$ 省略了 $\\lVert b \\rVert_2$ 项。这使得估计不可靠，特别是当 $\\lVert b \\rVert_2$ 相对于 $\\lVert A \\rVert_2 \\lVert x_k \\rVert_2$ 很大时。例如，如果解 $x$ 很小，$x_k$ 也可能很小，使得分母人为地变小，误差估计变得不稳定。\n2.  **错误的范数近似**：用 $\\lVert A \\rVert_F$ 近似 $\\lVert A \\rVert_2$ 的建议是一种启发式方法。我们知道 $\\lVert A \\rVert_2 \\le \\lVert A \\rVert_F$。在后向误差表达式的分母中使用 $\\lVert A \\rVert_F$ 会导致对真实后向误差界的低估（因为分母更大了），这是不安全的。一个保守的界需要 $\\lVert A \\rVert_2$ 的一个*下界*，而不是上界。\n3.  **对停滞的致命误解**：将停滞视为可接受的建议是极其错误和危险的。当步长 $\\lVert x_{k+1} - x_k \\rVert_2$ 变得非常小而残差仍然很大时，这是算法失败或“伪收敛”的经典迹象。这意味着该方法不再取得进展。这应该触发带有失败标志的终止，而不是被接受为收敛。\n\n结论：**不正确**。该选项显示了对后向误差分析和迭代方法实际行为的理解不足。\n\n**D. 使用如下复合策略。成功：当显式重新计算的相对残差满足 $\\lVert r_k \\rVert_2 / \\lVert b \\rVert_2 \\le \\tau_\\text{rel}$ 或保守的范数后向误差界 $\\eta_k$ 满足 $\\eta_k \\le \\tau_\\text{be}$ 时接受，其中\n$$\n\\eta_k \\;\\equiv\\; \\frac{\\lVert r_k \\rVert_2}{L_k \\lVert x_k \\rVert_2 + \\lVert b \\rVert_2}, \n\\qquad L_k \\;\\le\\; \\lVert A \\rVert_2,\n$$\n并且 $L_k$ 是 $\\lVert A \\rVert_2$ 的任意可计算下界，例如 $L_k = \\lVert A u_k \\rVert_2 / \\lVert u_k \\rVert_2$，其中 $u_k$ 是迭代中已有的非零探测向量（例如搜索方向或偶尔刷新的随机向量）。通过至少每 $m$ 次迭代（对于某个小的 $m$）显式地重新计算 $r_k = b - A x_k$ 来验证残差，以控制递推残差和真实残差之间的漂移。停滞：如果在 $s$ 次连续迭代中，残差范数未能按预设的相对因子减小，即对于 $j = 1,\\dots,s$，有 $\\lVert r_{k+j} \\rVert_2 \\ge (1 - \\gamma)\\, \\lVert r_{k+j-1} \\rVert_2$，或者如果步长在数值上极小而没有伴随的残差下降，即 $\\lVert x_{k+1} - x_k \\rVert_2 / (\\lVert x_k \\rVert_2 + 1) \\le \\tau_\\text{step}$ 而 $\\lVert r_{k+1} \\rVert_2 \\ge (1 - c)\\, \\lVert r_k \\rVert_2$，则以停滞标志终止。理由：相对残差是一个廉价的进展指标；范数后向误差 $\\eta_k$ 量化了数据扰动 $(\\delta A,\\delta b)$ 的大小，对于这些扰动，$x_k$ 是 $(A + \\delta A) x_k = b + \\delta b$ 的精确解，并且即使当 $A$ 高度非正规时也仍然有意义；显式残差重算和停滞检查可以防止 BiCGSTAB 中的伪收敛和残差漂移。**\n\n这个选项描述了一种最先进的、鲁棒的停止策略。\n1.  **复合准则**：将相对残差测试与后向误差测试相结合提供了灵活性。前者廉价且直观，而后者提供了一个严格的解质量度量，无论 $A$ 的条件数或非正规性如何，这个度量都有意义。\n2.  **正确的后向误差公式**：$\\eta_k$ 的公式使用了正确的分母结构，即 $\\text{某项}\\cdot\\lVert x_k \\rVert_2 + \\lVert b \\rVert_2$。使用*下界* $L_k \\le \\lVert A \\rVert_2$ 是正确的、保守的方法，可以在不付出精确计算 $\\lVert A \\rVert_2$ 的高昂代价的情况下，获得一个可靠的后向误差*上界*。使用一个现成的向量 $u_k$ 使得这个估计在计算上是廉价的。\n3.  **残差重算**：该策略明确包括了对真实残差 $r_k = b - A x_k$ 的周期性重算。这是防止基于一个具有欺骗性的小但不准确的递推更新残差而终止的标准且必要的技术。\n4.  **精密的停滞检测**：提议的停滞检查是全面的。它们正确地识别了两种关键的失败模式：(i) 残差范数停止取得有意义的进展，以及 (ii) 在残差仍然很大时，迭代解 $x_k$ 停止发生显著变化（伪收敛）。用 $(\\lVert x_k \\rVert_2+1)$ 对步长进行归一化是处理接近原点的迭代解的一种鲁棒方法。\n5.  **合理的理由**：所提供的理由完全正确，并简明地解释了策略中每个组成部分背后的基本原理，展示了对数值线性代数中实际挑战的深刻理解。\n\n结论：**正确**。该选项提出了一种理论上合理、实践中可实现，并且能有效应对与非正规系统迭代方法相关的已知困难的策略。",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "在高性能计算领域，算法的执行效率不仅取决于计算量，更关键在于如何优化数据通信。本练习将带你进入并行计算的世界，分析一种名为“流水线” (pipelining) 的高级优化技术如何提升 BiCGSTAB 的性能 。你将运用一个实际的性能模型，量化通过重叠通信与计算所带来的加速效果，从而建立起连接数值算法理论与并行计算机体系结构的桥梁。",
            "id": "3585841",
            "problem": "考虑在实现消息传递接口（MPI）的分布式内存并行计算机上，使用双共轭梯度稳定（BiCGSTAB）方法求解一个大型、稀疏、非对称线性系统 $A x = b$。单次 BiCGSTAB 迭代包含两次稀疏矩阵向量乘积和一组全局点积，其值通过 MPI all-reduce 集合通信获得。成本模型假设通信采用 Hockney 延迟-带宽形式，本地计算采用线性工作模型。具体假设如下：\n\n1.  在 $P$ 个进程中，一条 $w$ 字节消息的 MPI all-reduce 成本可以很好地用递归倍增树来近似，其时间为 $T_{\\mathrm{red}} = (\\alpha + \\beta w) \\log_{2}(P)$，其中 $\\alpha$ 是每级延迟，$\\beta$ 是每字节每级时间。\n2.  一次稀疏矩阵向量乘积的时间为 $T_{A} = \\gamma \\,\\mathrm{nnz}_{\\mathrm{local}}$，其中 $\\mathrm{nnz}_{\\mathrm{local}}$ 是一个进程上本地存储的非零元素数量，$\\gamma$ 是每个非零元素的时间。\n3.  每次迭代中，所有本地一级线性代数运算（向量更新和类 axpy 运算）的总时间为 $T_{v} = \\theta \\, n_{\\mathrm{local}}$，其中 $n_{\\mathrm{local}}$ 是本地存储的向量条目数，$\\theta$ 是每个元素的时间。\n\n标准的 BiCGSTAB 迭代需要四次全局点积。假设我们将迭代重构为流水线形式，为这些点积发出非阻塞 all-reduce 操作，并将其通信与两次稀疏矩阵向量乘积重叠，通过重新排列依赖关系来使这种重叠正确且完整。假设在依赖关系允许的任何地方都有完美的重叠，并且除了微不足道的本地并发之外，与 $T_{v}$ 没有额外的重叠。在这些假设下，每次迭代的时间模型如下：\n对于非流水线基线：\n$$\nT_{\\mathrm{np}} = 2 T_{A} + 4 T_{\\mathrm{red}} + T_{v}\n$$\n对于流水线变体：\n$$\nT_{\\mathrm{pl}} = 2 T_{A} + T_{v} + \\max\\!\\big(4 T_{\\mathrm{red}} - 2 T_{A},\\, 0\\big)\n$$\n这反映了在两次稀疏矩阵向量乘积背后可能的最大通信隐藏。\n\n给定以下参数：\n- $P = 64$，\n- $n = 2.56 \\times 10^{6}$，采用均匀块分布，因此 $n_{\\mathrm{local}} = n/P$，\n- 平均每行有 $z = 50$ 个非零元，因此全局非零元数量为 $n z$，并在进程间均匀分布，因此 $\\mathrm{nnz}_{\\mathrm{local}} = (n z)/P$，\n- 每个点积的消息大小 $w = 8$ 字节，\n- $\\alpha = 1.0 \\times 10^{-4}\\ \\mathrm{s}$ 每归约级，\n- $\\beta = 1.0 \\times 10^{-9}\\ \\mathrm{s/byte}$ 每归约级，\n- $\\gamma = 1.0 \\times 10^{-9}\\ \\mathrm{s}$ 每个非零元，\n- $\\theta = 2.75 \\times 10^{-8}\\ \\mathrm{s}$ 每个元素。\n\n使用上述性能模型和流水线假设，推导加速比 $S = T_{\\mathrm{np}}/T_{\\mathrm{pl}}$ 的表达式，并使用给定参数对其进行数值计算。将您的最终数值答案四舍五入到四位有效数字。将最终答案表示为无量纲数。",
            "solution": "该问题要求推导和评估 BiCGSTAB 算法的流水线实现相对于非流水线基线所获得的加速比 $S$。加速比定义为非流水线迭代时间 $T_{\\mathrm{np}}$ 与流水线迭代时间 $T_{\\mathrm{pl}}$ 的比值。\n\n首先，我们必须验证问题陈述。\n\n**步骤1：提取已知信息**\n-   线性系统：$A x = b$\n-   算法：在带有 MPI 的分布式内存并行计算机上使用 BiCGSTAB。\n-   MPI all-reduce 时间模型：$T_{\\mathrm{red}} = (\\alpha + \\beta w) \\log_{2}(P)$\n-   稀疏矩阵向量乘积时间：$T_{A} = \\gamma \\,\\mathrm{nnz}_{\\mathrm{local}}$\n-   本地向量操作时间：$T_{v} = \\theta \\, n_{\\mathrm{local}}$\n-   非流水线迭代时间：$T_{\\mathrm{np}} = 2 T_{A} + 4 T_{\\mathrm{red}} + T_{v}$\n-   流水线迭代时间：$T_{\\mathrm{pl}} = 2 T_{A} + T_{v} + \\max\\!\\big(4 T_{\\mathrm{red}} - 2 T_{A},\\, 0\\big)$\n-   进程数：$P = 64$\n-   全局向量大小：$n = 2.56 \\times 10^{6}$\n-   本地向量大小：$n_{\\mathrm{local}} = n/P$\n-   平均每行非零元数：$z = 50$\n-   本地非零元数：$\\mathrm{nnz}_{\\mathrm{local}} = (n z)/P$\n-   点积消息大小：$w = 8$ 字节\n-   每归约级延迟：$\\alpha = 1.0 \\times 10^{-4}\\ \\mathrm{s}$\n-   每字节每归约级时间：$\\beta = 1.0 \\times 10^{-9}\\ \\mathrm{s/byte}$\n-   每个非零元的时间 (SpMV)：$\\gamma = 1.0 \\times 10^{-9}\\ \\mathrm{s}$\n-   每个元素的时间（向量操作）：$\\theta = 2.75 \\times 10^{-8}\\ \\mathrm{s}$\n-   要求计算：加速比 $S = T_{\\mathrm{np}}/T_{\\mathrm{pl}}$\n-   四舍五入：最终答案保留四位有效数字。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题具有科学依据，因为它使用标准性能模型（Hockney 模型，线性工作模型）来分析一个著名的数值算法（BiCGSTAB）和一种常见的优化技术（流水线化以重叠通信和计算）。这些模型和参数与高性能计算领域一致。问题是适定的，为获得唯一解提供了所有必要的公式和数据。语言客观而精确。所有参数在物理上和计算上都是合理的。未发现任何缺陷。\n\n**步骤3：结论与行动**\n问题有效。我们将继续进行求解。\n\n目标是计算加速比 $S = T_{\\mathrm{np}}/T_{\\mathrm{pl}}$。加速比的表达式为：\n$$\nS = \\frac{T_{\\mathrm{np}}}{T_{\\mathrm{pl}}} = \\frac{2 T_{A} + 4 T_{\\mathrm{red}} + T_{v}}{2 T_{A} + T_{v} + \\max\\!\\big(4 T_{\\mathrm{red}} - 2 T_{A},\\, 0\\big)}\n$$\n为了评估此表达式，我们首先使用给定参数计算分量时间 $T_A$、$T_{\\mathrm{red}}$ 和 $T_v$ 的值。\n\n首先，我们确定本地问题的大小：\n每个进程的向量条目数是：\n$$\nn_{\\mathrm{local}} = \\frac{n}{P} = \\frac{2.56 \\times 10^{6}}{64} = \\frac{256 \\times 10^{4}}{64} = 4 \\times 10^{4}\n$$\n每个进程的非零元素数是：\n$$\n\\mathrm{nnz}_{\\mathrm{local}} = \\frac{n z}{P} = n_{\\mathrm{local}} \\cdot z = (4 \\times 10^{4}) \\times 50 = 200 \\times 10^{4} = 2 \\times 10^{6}\n$$\n\n接下来，我们计算分量时间：\n一次稀疏矩阵向量乘积的时间 $T_A$：\n$$\nT_{A} = \\gamma \\,\\mathrm{nnz}_{\\mathrm{local}} = (1.0 \\times 10^{-9}\\ \\mathrm{s}) \\times (2 \\times 10^{6}) = 2.0 \\times 10^{-3}\\ \\mathrm{s}\n$$\n本地向量操作的时间 $T_v$：\n$$\nT_{v} = \\theta \\, n_{\\mathrm{local}} = (2.75 \\times 10^{-8}\\ \\mathrm{s}) \\times (4 \\times 10^{4}) = 11.0 \\times 10^{-4}\\ \\mathrm{s} = 1.1 \\times 10^{-3}\\ \\mathrm{s}\n$$\n一次 all-reduce 集合通信的时间 $T_{\\mathrm{red}}$。级数为 $\\log_{2}(P) = \\log_{2}(64) = 6$。\n$$\nT_{\\mathrm{red}} = (\\alpha + \\beta w) \\log_{2}(P) = (1.0 \\times 10^{-4}\\ \\mathrm{s} + (1.0 \\times 10^{-9}\\ \\mathrm{s/byte}) \\times 8\\ \\mathrm{bytes}) \\times 6\n$$\n$$\nT_{\\mathrm{red}} = (1.0 \\times 10^{-4} + 8.0 \\times 10^{-9})\\ \\mathrm{s} \\times 6 = (1.0 \\times 10^{-4} + 0.008 \\times 10^{-6})\\ \\mathrm{s} \\times 6\n$$\n为了组合这些项，我们使用一个共同的指数：$1.0 \\times 10^{-4} + 0.00008 \\times 10^{-4} = 1.00008 \\times 10^{-4}$。\n$$\nT_{\\mathrm{red}} = (1.00008 \\times 10^{-4})\\ \\mathrm{s} \\times 6 = 6.00048 \\times 10^{-4}\\ \\mathrm{s}\n$$\n\n现在我们可以计算总迭代时间所需的各项：\n两次稀疏矩阵向量乘积的成本是：\n$$\n2 T_A = 2 \\times (2.0 \\times 10^{-3}\\ \\mathrm{s}) = 4.0 \\times 10^{-3}\\ \\mathrm{s}\n$$\n四次 all-reduce 集合通信的成本是：\n$$\n4 T_{\\mathrm{red}} = 4 \\times (6.00048 \\times 10^{-4}\\ \\mathrm{s}) = 24.00192 \\times 10^{-4}\\ \\mathrm{s} = 2.400192 \\times 10^{-3}\\ \\mathrm{s}\n$$\n\n接下来，我们评估非流水线版本的总迭代时间 $T_{\\mathrm{np}}$：\n$$\nT_{\\mathrm{np}} = 2 T_{A} + 4 T_{\\mathrm{red}} + T_{v} = (4.0 \\times 10^{-3} + 2.400192 \\times 10^{-3} + 1.1 \\times 10^{-3})\\ \\mathrm{s}\n$$\n$$\nT_{\\mathrm{np}} = 7.500192 \\times 10^{-3}\\ \\mathrm{s}\n$$\n对于流水线版本 $T_{\\mathrm{pl}}$，我们必须首先评估 $\\max$ 函数内的项，它代表了未被计算隐藏的通信成本部分：\n$$\n4 T_{\\mathrm{red}} - 2 T_{A} = 2.400192 \\times 10^{-3}\\ \\mathrm{s} - 4.0 \\times 10^{-3}\\ \\mathrm{s} = -1.599808 \\times 10^{-3}\\ \\mathrm{s}\n$$\n由于该值为负，通信时间小于可用于重叠的计算时间。因此，通信被完全隐藏。\n$$\n\\max\\!\\big(4 T_{\\mathrm{red}} - 2 T_{A},\\, 0\\big) = \\max\\!\\big(-1.599808 \\times 10^{-3},\\, 0\\big) = 0\n$$\n流水线版本的总迭代时间是：\n$$\nT_{\\mathrm{pl}} = 2 T_{A} + T_{v} + 0 = (4.0 \\times 10^{-3} + 1.1 \\times 10^{-3})\\ \\mathrm{s} = 5.1 \\times 10^{-3}\\ \\mathrm{s}\n$$\n\n最后，我们计算加速比 $S$：\n$$\nS = \\frac{T_{\\mathrm{np}}}{T_{\\mathrm{pl}}} = \\frac{7.500192 \\times 10^{-3}\\ \\mathrm{s}}{5.1 \\times 10^{-3}\\ \\mathrm{s}} = \\frac{7.500192}{5.1} \\approx 1.47062588\n$$\n将结果四舍五入到四位有效数字，我们得到 $1.471$。\n\n在 $4 T_{\\mathrm{red}} \\le 2 T_A$ 的条件下，推导出的加速比表达式是：\n$$\nS = \\frac{2 T_{A} + 4 T_{\\mathrm{red}} + T_{v}}{2 T_{A} + T_{v}} = 1 + \\frac{4 T_{\\mathrm{red}}}{2 T_{A} + T_{v}}\n$$\n将计算出的值代入这个简化形式可以验证结果：\n$$\nS = 1 + \\frac{2.400192 \\times 10^{-3}}{4.0 \\times 10^{-3} + 1.1 \\times 10^{-3}} = 1 + \\frac{2.400192 \\times 10^{-3}}{5.1 \\times 10^{-3}} = 1 + \\frac{2.400192}{5.1} \\approx 1 + 0.47062588 \\approx 1.47062588\n$$\n再次四舍五入到四位有效数字，得到 $1.471$。",
            "answer": "$$\\boxed{1.471}$$"
        }
    ]
}