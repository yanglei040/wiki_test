{
    "hands_on_practices": [
        {
            "introduction": "共轭梯度法（CG）是求解大型稀疏对称正定（SPD）线性系统的核心迭代方法。本练习将引导你手动完成一个简单 $2 \\times 2$ 系统的共轭梯度法计算，旨在揭示该方法的核心机制 。通过亲手计算，你将深入理解算法如何通过构建一组 $A$-共轭的搜索方向，在每一步迭代中最小化二次能量泛函，从而高效地逼近真实解。",
            "id": "3554232",
            "problem": "设 $A=\\begin{bmatrix}4  0\\\\0  1\\end{bmatrix}$，它是一个对称正定矩阵，并设 $b=\\begin{bmatrix}1\\\\1\\end{bmatrix}$。考虑使用共轭梯度（CG）法求解 $A x=b$，从初始猜测 $x_{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}$ 开始。仅使用基本原理：Krylov 子空间 $K_{k}(A,r_{0})=\\operatorname{span}\\{r_{0},A r_{0},\\dots,A^{k-1} r_{0}\\}$ 的定义，其中 $r_{0}=b-A x_{0}$，$A$ 的对称正定性，$A$-内积 $\\langle u,v\\rangle_{A}=u^{\\mathsf{T}} A v$，CG 搜索方向 $\\{p_{k}\\}$ 的 $A$-共轭特性，以及每次 CG 更新选择沿 $p_{k}$ 的步长，该步长在仿射子空间 $x_{k-1}+\\operatorname{span}\\{p_{k}\\}$ 上最小化二次能量 $q(x)=\\tfrac{1}{2}x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 的性质。\n\n按以下步骤进行：\n- 从 $x_{0}$ 构造前两个 CG 迭代结果 $x_{1}$ 和 $x_{2}$，通过强制执行所述的最优性和正交性条件，从选择 $p_{0}=r_{0}$ 开始，然后定义 $p_{1}$ 使其与 $p_{0}$ 是 $A$-共轭的。\n- 在每一步，明确确定沿当前搜索方向最小化 $q(x)$ 的步长。\n- 验证连续残差 $r_{0}$ 和 $r_{1}$ 的欧几里得正交性，并验证 $p_{0}$ 和 $p_{1}$ 的 $A$-共轭性。\n\n最后，报告 $p_{0}^{\\mathsf{T}} A p_{1}$ 的标量值。最终答案必须是一个实数。无需四舍五入。",
            "solution": "问题要求逐步构造共轭梯度（CG）法的前两次迭代，以求解特定的线性系统 $A x=b$。该过程必须基于该方法的基本原理，即能量二次型的最小化以及搜索方向的 $A$-共轭性。\n\n给定的系统是 $A x = b$，其中：\n$A = \\begin{bmatrix} 4  0 \\\\ 0  1 \\end{bmatrix}$，$b = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n矩阵 $A$ 是对称的，其特征值为 $4$ 和 $1$，均为正数。因此，$A$ 是对称正定（SPD）的，这是标准 CG 方法的一个先决条件。\n要最小化的能量二次型是 $q(x) = \\frac{1}{2}x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$。最小化 $q(x)$ 等价于求解 $A x=b$，因为 $q(x)$ 的梯度是 $\\nabla q(x) = A x - b$，在最小值处为零。\n初始猜测是 $x_{0} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n\nCG 方法生成一个迭代序列 $x_{k+1} = x_k + \\alpha_k p_k$，其中 $p_k$ 是搜索方向，$\\alpha_k$ 是步长。\n\n**步长最小化**\n选择步长 $\\alpha_k$ 以沿搜索方向 $p_k$ 最小化 $q(x_k + \\alpha_k p_k)$。令 $f(\\alpha) = q(x_k + \\alpha p_k)$。\n$$f(\\alpha) = \\frac{1}{2}(x_k + \\alpha p_k)^{\\mathsf{T}} A (x_k + \\alpha p_k) - b^{\\mathsf{T}}(x_k + \\alpha p_k)$$\n$$f(\\alpha) = \\frac{1}{2}(x_k^{\\mathsf{T}} A x_k + 2\\alpha p_k^{\\mathsf{T}} A x_k + \\alpha^2 p_k^{\\mathsf{T}} A p_k) - b^{\\mathsf{T}}x_k - \\alpha b^{\\mathsf{T}}p_k$$\n为了找到最小值，我们将关于 $\\alpha$ 的导数设为零：\n$$\\frac{df}{d\\alpha} = p_k^{\\mathsf{T}} A x_k + \\alpha p_k^{\\mathsf{T}} A p_k - b^{\\mathsf{T}}p_k = 0$$\n求解 $\\alpha$，我们得到：\n$$\\alpha (p_k^{\\mathsf{T}} A p_k) = b^{\\mathsf{T}}p_k - p_k^{\\mathsf{T}} A x_k = p_k^{\\mathsf{T}} (b - A x_k)$$\n定义残差为 $r_k = b - A x_k$，最优步长为：\n$$\\alpha_k = \\frac{p_k^{\\mathsf{T}} r_k}{p_k^{\\mathsf{T}} A p_k}$$\n\n**第0次迭代：初始化**\n从 $x_0$ 计算初始残差：\n$$r_0 = b - A x_0 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} - \\begin{bmatrix} 4  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$$\n第一个搜索方向设为初始残差：\n$$p_0 = r_0 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$$\n\n**第1次迭代：构造 $x_1$**\n我们首先计算步长 $\\alpha_0$。使用上面为 $k=0$ 推导的公式：\n$$\\alpha_0 = \\frac{p_0^{\\mathsf{T}} r_0}{p_0^{\\mathsf{T}} A p_0}$$\n由于 $p_0=r_0$，这可以简化为 $\\alpha_0 = \\frac{r_0^{\\mathsf{T}} r_0}{r_0^{\\mathsf{T}} A r_0}$。\n必要的组成部分是：\n$$r_0^{\\mathsf{T}} r_0 = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = 1 \\cdot 1 + 1 \\cdot 1 = 2$$\n$$A p_0 = A r_0 = \\begin{bmatrix} 4  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix}$$\n$$p_0^{\\mathsf{T}} A p_0 = r_0^{\\mathsf{T}} A r_0 = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix} = 1 \\cdot 4 + 1 \\cdot 1 = 5$$\n步长是：\n$$\\alpha_0 = \\frac{2}{5}$$\n第一次迭代的结果 $x_1$ 是：\n$$x_1 = x_0 + \\alpha_0 p_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + \\frac{2}{5} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} \\frac{2}{5} \\\\ \\frac{2}{5} \\end{bmatrix}$$\n新的残差 $r_1$ 是：\n$$r_1 = b - A x_1 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} - \\begin{bmatrix} 4  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} \\frac{2}{5} \\\\ \\frac{2}{5} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} - \\begin{bmatrix} \\frac{8}{5} \\\\ \\frac{2}{5} \\end{bmatrix} = \\begin{bmatrix} -\\frac{3}{5} \\\\ \\frac{3}{5} \\end{bmatrix}$$\n或者，我们可以使用更新公式 $r_1 = r_0 - \\alpha_0 A p_0$：\n$$r_1 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} - \\frac{2}{5} \\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 - \\frac{8}{5} \\\\ 1 - \\frac{2}{5} \\end{bmatrix} = \\begin{bmatrix} -\\frac{3}{5} \\\\ \\frac{3}{5} \\end{bmatrix}$$\n\n**残差正交性验证**\nCG 方法的一个关键性质是连续的残差在欧几里得内积下是正交的。我们对 $r_0$ 和 $r_1$ 进行验证：\n$$r_0^{\\mathsf{T}} r_1 = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} -\\frac{3}{5} \\\\ \\frac{3}{5} \\end{bmatrix} = -\\frac{3}{5} + \\frac{3}{5} = 0$$\n正交性得到验证。\n\n**第2次迭代：构造 $x_2$**\n下一个搜索方向 $p_1$ 必须与 $p_0$ 是 $A$-共轭的，即 $p_1^{\\mathsf{T}} A p_0 = 0$。我们使用类似于 Gram-Schmidt 的过程，根据 $A$-内积 $\\langle u,v \\rangle_A = u^{\\mathsf{T}}A v$ 从 $r_1$ 和 $p_0$ 构造 $p_1$。\n$$p_1 = r_1 + \\beta_0 p_0$$\n选择系数 $\\beta_0$ 以强制实现与 $p_0$ 的 $A$-共轭性：\n$$\\langle p_1, p_0 \\rangle_A = (r_1 + \\beta_0 p_0)^{\\mathsf{T}} A p_0 = r_1^{\\mathsf{T}} A p_0 + \\beta_0 p_0^{\\mathsf{T}} A p_0 = 0$$\n$$\\beta_0 = -\\frac{r_1^{\\mathsf{T}} A p_0}{p_0^{\\mathsf{T}} A p_0}$$\n我们来计算分子：\n$$r_1^{\\mathsf{T}} A p_0 = \\begin{bmatrix} -\\frac{3}{5}  \\frac{3}{5} \\end{bmatrix} \\begin{bmatrix} 4 \\\\ 1 \\end{bmatrix} = -\\frac{12}{5} + \\frac{3}{5} = -\\frac{9}{5}$$\n我们已经计算出分母 $p_0^{\\mathsf{T}} A p_0 = 5$。\n$$\\beta_0 = -\\frac{-9/5}{5} = \\frac{9}{25}$$\n这是 $\\beta_0$ 的 Polak-Ribière 公式。对于二次问题，一个等价的形式是 Fletcher-Reeves 公式：\n$$\\beta_0 = \\frac{r_1^{\\mathsf{T}} r_1}{r_0^{\\mathsf{T}} r_0} = \\frac{(-\\frac{3}{5})^2 + (\\frac{3}{5})^2}{2} = \\frac{\\frac{9}{25} + \\frac{9}{25}}{2} = \\frac{18/25}{2} = \\frac{9}{25}$$\n现在我们构造 $p_1$：\n$$p_1 = r_1 + \\beta_0 p_0 = \\begin{bmatrix} -\\frac{3}{5} \\\\ \\frac{3}{5} \\end{bmatrix} + \\frac{9}{25} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} -\\frac{15}{25} + \\frac{9}{25} \\\\ \\frac{15}{25} + \\frac{9}{25} \\end{bmatrix} = \\begin{bmatrix} -\\frac{6}{25} \\\\ \\frac{24}{25} \\end{bmatrix}$$\n\n**A-共轭性验证**\n根据问题要求，我们通过计算它们的 $A$-内积来验证 $p_0$ 和 $p_1$ 的 $A$-共轭性。这个计算的结果也是题目要求的最终答案。\n$$p_0^{\\mathsf{T}} A p_1 = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} 4  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} -\\frac{6}{25} \\\\ \\frac{24}{25} \\end{bmatrix} = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} -\\frac{24}{25} \\\\ \\frac{24}{25} \\end{bmatrix} = -\\frac{24}{25} + \\frac{24}{25} = 0$$\n$A$-共轭性得到验证。$p_0^{\\mathsf{T}} A p_1$ 的标量值为 $0$。\n\n我们现在继续求 $x_2$。步长 $\\alpha_1$ 由以下公式给出：\n$$\\alpha_1 = \\frac{p_1^{\\mathsf{T}} r_1}{p_1^{\\mathsf{T}} A p_1}$$\n由于残差的正交性，$p_1^{\\mathsf{T}} r_1 = (r_1 + \\beta_0 p_0)^{\\mathsf{T}} r_1 = r_1^{\\mathsf{T}} r_1 + \\beta_0 p_0^{\\mathsf{T}} r_1 = r_1^{\\mathsf{T}} r_1 + \\beta_0 r_0^{\\mathsf{T}} r_1$。我们已经证明了 $r_0^{\\mathsf{T}} r_1=0$。所以，$p_1^{\\mathsf{T}} r_1=r_1^{\\mathsf{T}} r_1$。\n$$\\alpha_1 = \\frac{r_1^{\\mathsf{T}} r_1}{p_1^{\\mathsf{T}} A p_1}$$\n我们有 $r_1^{\\mathsf{T}} r_1 = \\frac{18}{25}$。我们计算分母：\n$$A p_1 = \\begin{bmatrix} 4  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} -\\frac{6}{25} \\\\ \\frac{24}{25} \\end{bmatrix} = \\begin{bmatrix} -\\frac{24}{25} \\\\ \\frac{24}{25} \\end{bmatrix}$$\n$$p_1^{\\mathsf{T}} A p_1 = \\begin{bmatrix} -\\frac{6}{25}  \\frac{24}{25} \\end{bmatrix} \\begin{bmatrix} -\\frac{24}{25} \\\\ \\frac{24}{25} \\end{bmatrix} = \\frac{144}{625} + \\frac{576}{625} = \\frac{720}{625} = \\frac{144}{125}$$\n所以，步长是：\n$$\\alpha_1 = \\frac{18/25}{144/125} = \\frac{18}{25} \\cdot \\frac{125}{144} = \\frac{18 \\cdot 5}{144} = \\frac{90}{144} = \\frac{5}{8}$$\n第二次迭代的结果 $x_2$ 是：\n$$x_2 = x_1 + \\alpha_1 p_1 = \\begin{bmatrix} \\frac{2}{5} \\\\ \\frac{2}{5} \\end{bmatrix} + \\frac{5}{8} \\begin{bmatrix} -\\frac{6}{25} \\\\ \\frac{24}{25} \\end{bmatrix} = \\begin{bmatrix} \\frac{2}{5} - \\frac{30}{200} \\\\ \\frac{2}{5} + \\frac{120}{200} \\end{bmatrix} = \\begin{bmatrix} \\frac{2}{5} - \\frac{3}{20} \\\\ \\frac{2}{5} + \\frac{12}{20} \\end{bmatrix} = \\begin{bmatrix} \\frac{8-3}{20} \\\\ \\frac{8+12}{20} \\end{bmatrix} = \\begin{bmatrix} \\frac{5}{20} \\\\ \\frac{20}{20} \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{4} \\\\ 1 \\end{bmatrix}$$\n对于一个规模为 $N=2$ 的问题，CG 方法保证在最多 2 次迭代内找到精确解。我们来验证一下：\n精确解是 $x = A^{-1}b = \\begin{bmatrix} 1/4  0 \\\\ 0  1 \\end{bmatrix}\\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1/4 \\\\ 1 \\end{bmatrix}$。我们计算出的 $x_2$ 确实是精确解。\n\n问题要求 $p_0^{\\mathsf{T}} A p_1$ 的标量值。如上通过直接计算验证，这个值为零，这与 $A$-共轭搜索方向的定义一致。",
            "answer": "$$ \\boxed{0} $$"
        },
        {
            "introduction": "当我们从对称正定系统转向更广泛的非对称线性系统时，广义最小残差方法（GMRES）成为了首选。这个练习将带你实践GMRES算法的关键步骤：使用Arnoldi过程为克雷洛夫子空间构建标准正交基，并求解相应的最小二乘问题以更新解 。本题的特殊之处在于它展示了一个“提前终止”（early breakdown）的情形，让你直观地看到当初始残差恰好位于一个低维不变子空间中时，GMRES如何能够快速找到精确解。",
            "id": "3554249",
            "problem": "考虑矩阵 $A=\\begin{bmatrix}2  1\\\\0  1\\end{bmatrix}$，向量 $b=\\begin{bmatrix}1\\\\0\\end{bmatrix}$，以及初始猜测 $x_{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}$。使用广义最小残差 (GMRES) 方法，该方法对于初始残差 $r_{0}=b-Ax_{0}$，在 $m$ 步克雷洛夫子空间 $\\mathcal{K}_{m}(A,r_{0})=\\operatorname{span}\\{r_{0},Ar_{0},\\dots,A^{m-1}r_{0}\\}$ 中构建解，并采用 Arnoldi 过程来构建一个标准正交基 $V_{m+1}$ 和满足 $AV_{m}=V_{m+1}\\bar{H}_{m}$ 的 $(m+1)\\times m$ 上 Hessenberg 矩阵 $\\bar{H}_{m}$。从 $x_{0}$ 开始执行两步 GMRES（$m=2$）：\n\n- 构建 Arnoldi 基向量 $v_{1}$ 以及（如果可能）$v_{2}$，并形成 $(3\\times 2)$ 的上 Hessenberg 矩阵 $\\bar{H}_{2}$。如果在 Arnoldi 过程中发生崩溃，将已计算的量嵌入到一个 $(3\\times 2)$ 的补零矩阵 $\\bar{H}_{2}$ 中，以构建两步 GMRES 最小二乘问题。\n- 建立并求解 GMRES 最小二乘问题 $\\min_{y\\in\\mathbb{R}^{2}}\\|\\beta e_{1}-\\bar{H}_{2}y\\|_{2}$，其中 $\\beta=\\|r_{0}\\|_{2}$ 且 $e_{1}\\in\\mathbb{R}^{3}$ 是第一个标准基向量，以获得最小化向量 $y_{2}\\in\\mathbb{R}^{2}$。\n- 使用最小化向量 $y_{2}$，确定两步 GMRES 近似解 $x_{2}$ 并报告残差范数 $\\|r_{2}\\|_{2}=\\|b-Ax_{2}\\|_{2}$。\n\n将最终残差范数 $\\|r_{2}\\|_{2}$ 表示为精确值。无需四舍五入。",
            "solution": "用户提供了一个在数值线性代数领域中明确定义的问题。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n- 矩阵: $A=\\begin{bmatrix}2  1\\\\0  1\\end{bmatrix}$\n- 向量: $b=\\begin{bmatrix}1\\\\0\\end{bmatrix}$\n- 初始猜测: $x_{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}$\n- 方法: 两步（$m=2$）广义最小残差（GMRES）。\n- 克雷洛夫子空间: $\\mathcal{K}_{m}(A,r_{0})=\\operatorname{span}\\{r_{0},Ar_{0},\\dots,A^{m-1}r_{0}\\}$，对于初始残差 $r_{0}=b-Ax_{0}$。\n- Arnoldi 关系式: $AV_{m}=V_{m+1}\\bar{H}_{m}$，其中 $V_{m+1}$ 是一个标准正交基，$\\bar{H}_{m}$ 是一个 $(m+1)\\times m$ 的上 Hessenberg 矩阵。\n- 任务1: 对 $m=2$ 执行 Arnoldi 过程以找到 $V_2$ 和 $\\bar{H}_2$。在发生崩溃的情况下，对 $\\bar{H}_2$ 使用指定的补零过程。\n- 任务2: 求解最小二乘问题 $\\min_{y\\in\\mathbb{R}^{2}}\\|\\beta e_{1}-\\bar{H}_{2}y\\|_{2}$，其中 $\\beta=\\|r_{0}\\|_{2}$ 且 $e_{1}\\in\\mathbb{R}^{3}$ 是第一个标准基向量。\n- 任务3: 确定 GMRES 近似解 $x_{2}$ 并报告残差范数 $\\|r_{2}\\|_{2}=\\|b-Ax_{2}\\|_{2}$。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据:** 该问题是 GMRES 算法与 Arnoldi 过程的标准应用，是数值线性代数中的一个基本课题。所有概念都已成熟。\n- **适定性:** 矩阵 $A$ 是非奇异的（$\\det(A)=2-0=2 \\neq 0$），因此系统 $Ax=b$ 有唯一解。GMRES 算法是明确定义的，并且问题提供了清晰的步骤，包括处理提前崩溃的特殊情况。\n- **客观性:** 问题以精确的数学语言陈述，没有歧义或主观论断。\n- **完整性与一致性:** 所有必要的数据（$A$, $b$, $x_0$）和程序步骤都已提供。没有矛盾之处。\n\n**1.3. 结论与行动**\n问题有效。将继续求解过程。\n\n### 步骤2：求解推导\n\nGMRES 方法为系统 $Ax=b$ 生成一个形式为 $x_m = x_0 + z_m$ 的近似解 $x_m$，其中 $z_m \\in \\mathcal{K}_m(A, r_0)$ 的选择是为了最小化残差范数 $\\|r_m\\|_2 = \\|b-Ax_m\\|_2$。\n\n**2.1. Arnoldi 过程（$m=2$）**\n\n首先，我们计算初始残差 $r_0$。\n$$\nAx_{0} = \\begin{bmatrix}2  1\\\\0  1\\end{bmatrix}\\begin{bmatrix}0\\\\0\\end{bmatrix} = \\begin{bmatrix}0\\\\0\\end{bmatrix}\n$$\n$$\nr_{0} = b - Ax_{0} = \\begin{bmatrix}1\\\\0\\end{bmatrix} - \\begin{bmatrix}0\\\\0\\end{bmatrix} = \\begin{bmatrix}1\\\\0\\end{bmatrix}\n$$\n初始残差的范数是 $\\beta$。\n$$\n\\beta = \\|r_{0}\\|_{2} = \\sqrt{1^2 + 0^2} = 1\n$$\n第一个 Arnoldi 向量 $v_1$ 是归一化的初始残差。\n$$\nv_{1} = \\frac{r_{0}}{\\|r_{0}\\|_{2}} = \\frac{1}{1}\\begin{bmatrix}1\\\\0\\end{bmatrix} = \\begin{bmatrix}1\\\\0\\end{bmatrix}\n$$\n现在，我们执行 Arnoldi 过程的第一次迭代以找到 $v_2$。\n令 $w_1 = Av_1$。\n$$\nw_{1} = Av_{1} = \\begin{bmatrix}2  1\\\\0  1\\end{bmatrix}\\begin{bmatrix}1\\\\0\\end{bmatrix} = \\begin{bmatrix}2\\\\0\\end{bmatrix}\n$$\n我们计算 Hessenberg 矩阵 $\\bar{H}_2$ 的第一列元素。元素 $h_{11}$ 是 $w_1$ 在 $v_1$ 上的投影。\n$$\nh_{11} = v_{1}^{T}w_{1} = \\begin{bmatrix}1  0\\end{bmatrix}\\begin{bmatrix}2\\\\0\\end{bmatrix} = 2\n$$\n接下来，我们计算未归一化的向量 $\\tilde{v}_2$，它应该与 $v_1$ 正交。\n$$\n\\tilde{v}_{2} = w_{1} - h_{11}v_{1} = \\begin{bmatrix}2\\\\0\\end{bmatrix} - 2\\begin{bmatrix}1\\\\0\\end{bmatrix} = \\begin{bmatrix}0\\\\0\\end{bmatrix}\n$$\n这个向量的范数给出了次对角线元素 $h_{21}$。\n$$\nh_{21} = \\|\\tilde{v}_{2}\\|_{2} = 0\n$$\n由于 $h_{21}=0$，Arnoldi 过程在第一步就发生了崩溃。这意味着克雷洛夫子空间 $\\mathcal{K}_2(A, r_0)$ 的维数是 1 而不是 2，因为 $\\mathcal{K}_{2}(A, r_{0}) = \\operatorname{span}\\{r_0, Ar_0\\}=\\operatorname{span}\\{r_0, 2r_0\\}=\\operatorname{span}\\{r_0\\}$。向量 $v_1$ 是 $A$ 的一个特征向量，并且 $Ax=b$ 的精确解位于仿射子空间 $x_0 + \\mathcal{K}_1(A, r_0)$ 中。\n\n问题要求我们执行两步（$m=2$）GMRES 迭代。根据指示，我们必须通过嵌入已计算的量并对余下部分补零来构造 $3 \\times 2$ 矩阵 $\\bar{H}_2$。我们已经计算出 $\\bar{H}_2$ 的第一列为 $\\begin{bmatrix}h_{11} \\\\ h_{21}\\end{bmatrix} = \\begin{bmatrix}2\\\\0\\end{bmatrix}$。由于过程崩溃，我们无法计算第二列 $(h_{12}, h_{22}, h_{32})^T$。“补零”的指令意味着我们将这些未计算的元素设为零。\n$$\n\\bar{H}_{2} = \\begin{bmatrix} h_{11}  h_{12} \\\\ h_{21}  h_{22} \\\\ 0  h_{32} \\end{bmatrix} = \\begin{bmatrix} 2  0 \\\\ 0  0 \\\\ 0  0 \\end{bmatrix}\n$$\n\n**2.2. GMRES 最小二乘问题**\n\n下一步是找到解最小二乘问题的 $y_2 \\in \\mathbb{R}^2$：\n$$\n\\min_{y\\in\\mathbb{R}^{2}} \\|\\beta e_{1} - \\bar{H}_{2}y\\|_{2}\n$$\n其中 $\\beta=1$，$e_1 = \\begin{bmatrix}1\\\\0\\\\0\\end{bmatrix}$，以及 $y = \\begin{bmatrix}y_{(1)}\\\\y_{(2)}\\end{bmatrix}$。\n我们需要最小化以下向量的范数：\n$$\n\\beta e_{1} - \\bar{H}_{2}y = 1\\begin{bmatrix}1\\\\0\\\\0\\end{bmatrix} - \\begin{bmatrix}2  0\\\\0  0\\\\0  0\\end{bmatrix}\\begin{bmatrix}y_{(1)}\\\\y_{(2)}\\end{bmatrix} = \\begin{bmatrix}1\\\\0\\\\0\\end{bmatrix} - \\begin{bmatrix}2y_{(1)}\\\\0\\\\0\\end{bmatrix} = \\begin{bmatrix}1 - 2y_{(1)}\\\\0\\\\0\\end{bmatrix}\n$$\n其范数的平方为 $\\| \\begin{bmatrix}1 - 2y_{(1)}\\\\0\\\\0\\end{bmatrix} \\|_{2}^{2} = (1-2y_{(1)})^2$。\n当 $1-2y_{(1)}=0$ 时，该表达式最小化，这发生在 $y_{(1)}=1/2$ 处。$y_{(2)}$ 的值对最小值没有影响，因此按照惯例，我们选择 $y$ 的最小范数解，即 $y_{(2)}=0$。\n最小化向量是 $y_2 = \\begin{bmatrix}1/2\\\\0\\end{bmatrix}$。\n\n**2.3. 最终残差范数**\n\nGMRES 残差的范数 $\\|r_m\\|_2$ 等于最小二乘问题的最小值。对于 $m=2$，我们有：\n$$\n\\|r_{2}\\|_{2} = \\min_{y\\in\\mathbb{R}^{2}} \\|\\beta e_{1} - \\bar{H}_{2}y\\|_{2}\n$$\n将最小化值 $y_{(1)}=1/2$ 代入向量范数的表达式中，我们得到：\n$$\n\\|r_{2}\\|_{2} = \\left\\| \\begin{bmatrix}1 - 2(1/2)\\\\0\\\\0\\end{bmatrix} \\right\\|_{2} = \\left\\| \\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix} \\right\\|_{2} = 0\n$$\n因此，两步之后的残差范数为 $0$。这是预料之中的，因为在第 $k=1$ 步的崩溃表明 GMRES 在该步找到了精确解，并且后续的迭代不会改变解或残差。\n\n为了验证，我们可以计算解向量 $x_2$：\n$x_2 = x_0 + V_2 y_2$。矩阵 $V_2$ 应该是 $[v_1, v_2]$。我们只计算了 $v_1$，但由于 $y_2$ 的第二个分量是 $0$，所以不需要向量 $v_2$。\n$$\nx_2 = x_0 + [v_1, v_2]\\begin{bmatrix}1/2\\\\0\\end{bmatrix} = x_0 + \\frac{1}{2}v_1 = \\begin{bmatrix}0\\\\0\\end{bmatrix} + \\frac{1}{2}\\begin{bmatrix}1\\\\0\\end{bmatrix} = \\begin{bmatrix}1/2\\\\0\\end{bmatrix}\n$$\n现在我们计算残差 $r_2 = b - Ax_2$：\n$$\nr_2 = \\begin{bmatrix}1\\\\0\\end{bmatrix} - \\begin{bmatrix}2  1\\\\0  1\\end{bmatrix}\\begin{bmatrix}1/2\\\\0\\end{bmatrix} = \\begin{bmatrix}1\\\\0\\end{bmatrix} - \\begin{bmatrix}1\\\\0\\end{bmatrix} = \\begin{bmatrix}0\\\\0\\end{bmatrix}\n$$\n范数为 $\\|r_2\\|_2 = 0$，这证实了最小二乘问题的结果。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "掌握了GMRES的计算流程后，一个更深入的问题是：我们如何分析其收敛行为？这个高级练习将算法的执行与理论分析联系起来，重点探讨谐波里兹值（harmonic Ritz values）的概念 。你将推导并计算这些值，并理解它们是如何通过特定的Petrov-Galerkin条件与GMRES的残差最小化性质紧密相连的，这为理解和预测GMRES的收敛性提供了有力的工具。",
            "id": "3554247",
            "problem": "考虑一个方阵 $\\mathbf{A} \\in \\mathbb{C}^{n \\times n}$，一个初始残差向量 $\\mathbf{r}_0 \\neq \\mathbf{0}$，以及 Krylov 子空间 $\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0) = \\operatorname{span}\\{\\mathbf{r}_0, \\mathbf{A}\\mathbf{r}_0, \\dots, \\mathbf{A}^{k-1}\\mathbf{r}_0\\}$。令 $\\mathbf{V}_k \\in \\mathbb{C}^{n \\times k}$ 具有构成 $\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 基的标准正交列，并假设 Arnoldi 关系式成立：\n$$\n\\mathbf{A}\\mathbf{V}_k = \\mathbf{V}_k \\mathbf{H}_k + h_{k+1,k} \\mathbf{v}_{k+1} \\mathbf{e}_k^{\\top},\n$$\n其中 $\\mathbf{H}_k \\in \\mathbb{C}^{k \\times k}$ 为上 Hessenberg 矩阵，$\\mathbf{e}_k \\in \\mathbb{R}^k$ 为第 $k$ 个标准基向量，$h_{k+1,k} \\in \\mathbb{R}$，且 $\\mathbf{v}_{k+1} \\in \\mathbb{C}^n$ 与 $\\mathbf{V}_k$ 的列标准正交。相对于 $\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 的谐波 Ritz 对 $(\\theta, \\mathbf{u})$ 由 $\\mathbf{u} = \\mathbf{V}_k \\mathbf{y}$ 和 Petrov–Galerkin（测试空间）条件 $\\mathbf{A}\\mathbf{u} - \\theta \\mathbf{u} \\perp \\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 定义。\n\n仅使用 Arnoldi 关系式和上述正交性定义，推导出以 $\\mathbf{H}_k$ 和 $h_{k+1,k}$ 表示谐波 Ritz 值 $\\theta$ 的有限维广义特征值问题。然后，对于特定的 Arnoldi 数据\n$$\n\\mathbf{H}_3 = \\begin{bmatrix} 1  2  0 \\\\ 0  1  3 \\\\ 0  0  1 \\end{bmatrix}, \\qquad h_{4,3} = 0.1,\n$$\n计算谐波 Ritz 值。简要解释这些谐波 Ritz 值如何与广义最小残差 (GMRES) 方法的残差最小化性质相关联，并强调测试空间 $\\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 的作用。\n\n使用 LaTeX 的 $\\mathrm{pmatrix}$ 环境将最终的谐波 Ritz 值表示为一个行矩阵，并将您的数值四舍五入到六位有效数字。不涉及物理单位。",
            "solution": "用户希望我解决一个数值线性代数问题。\n\n我的计划如下：\n1.  **验证问题陈述**：这包括提取所有给定信息，并检查其科学合理性、完整性和客观性。\n2.  **推导广义特征值问题**：我将从 Petrov-Galerkin 条件出发，并按照指示使用 Arnoldi 关系式。\n3.  **计算谐波 Ritz 值**：我将把给定的数值数据代入推导出的特征值问题并求解。\n4.  **解释与 GMRES 的联系**：我将描述用于谐波 Ritz 值的测试空间如何与 GMRES 方法的最优性条件相关联。\n\n**问题验证**\n\n**第一步：提取给定信息**\n-   一个方阵 $\\mathbf{A} \\in \\mathbb{C}^{n \\times n}$。\n-   一个初始残差向量 $\\mathbf{r}_0 \\neq \\mathbf{0}$。\n-   Krylov 子空间 $\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0) = \\operatorname{span}\\{\\mathbf{r}_0, \\mathbf{A}\\mathbf{r}_0, \\dots, \\mathbf{A}^{k-1}\\mathbf{r}_0\\}$。\n-   一个矩阵 $\\mathbf{V}_k \\in \\mathbb{C}^{n \\times k}$，其标准正交列构成 $\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 的一个基。\n-   Arnoldi 关系式：$\\mathbf{A}\\mathbf{V}_k = \\mathbf{V}_k \\mathbf{H}_k + h_{k+1,k} \\mathbf{v}_{k+1} \\mathbf{e}_k^{\\top}$。\n-   $\\mathbf{H}_k \\in \\mathbb{C}^{k \\times k}$ 是一个上 Hessenberg 矩阵。\n-   $\\mathbf{e}_k \\in \\mathbb{R}^k$ 是第 $k$ 个标准基向量。\n-   $h_{k+1,k} \\in \\mathbb{R}$。\n-   $\\mathbf{v}_{k+1} \\in \\mathbb{C}^n$ 与 $\\mathbf{V}_k$ 的列标准正交，即 $\\mathbf{V}_k^{\\mathrm{H}}\\mathbf{v}_{k+1} = \\mathbf{0}$。\n-   一个谐波 Ritz 对 $(\\theta, \\mathbf{u})$ 定义为：\n    1.  $\\mathbf{u} = \\mathbf{V}_k \\mathbf{y}$，其中 $\\mathbf{y} \\in \\mathbb{C}^k$ 为某个非零向量。\n    2.  Petrov-Galerkin 条件：$\\mathbf{A}\\mathbf{u} - \\theta \\mathbf{u} \\perp \\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$。\n-   $k=3$ 时的特定 Arnoldi 数据：\n    $$ \\mathbf{H}_3 = \\begin{bmatrix} 1  2  0 \\\\ 0  1  3 \\\\ 0  0  1 \\end{bmatrix}, \\qquad h_{4,3} = 0.1 $$\n\n**第二步：使用提取的给定信息进行验证**\n-   **科学依据**：该问题是数值线性代数领域的标准问题，特别涉及 Arnoldi、GMRES 等迭代方法和特征值近似（Ritz 值）。所有定义和关系都是公认的。\n-   **良态性**：问题陈述清晰，要求进行推导和随后的计算。给定的信息足以推导出所需的广义特征值问题并计算特定值。对于给定的数据，存在一组唯一的谐波 Ritz 值。\n-   **客观性**：问题以精确的数学语言表述，没有任何主观或偏颇的陈述。\n\n所有其他验证标准均已满足。该问题并非不合理、不完整、矛盾、不切实际或微不足道。\n\n**第三步：结论与行动**\n问题有效。我将继续进行解答。\n\n**解答**\n\n根据问题陈述的要求，解答分为三个部分。\n\n**第一部分：广义特征值问题的推导**\n\n谐波 Ritz 对 $(\\theta, \\mathbf{u})$ 由搜索空间条件 $\\mathbf{u} \\in \\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 和残差 $\\mathbf{r}_{\\mathbf{u}} = \\mathbf{A}\\mathbf{u} - \\theta \\mathbf{u}$ 相对于测试空间 $\\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 的 Petrov-Galerkin 正交性条件定义。\n\n搜索空间条件意味着我们可以将近似特征向量 $\\mathbf{u}$ 写成 $\\mathcal{K}_k$ 基向量的线性组合。使用给定的标准正交基 $\\mathbf{V}_k$，我们有 $\\mathbf{u} = \\mathbf{V}_k \\mathbf{y}$，其中 $\\mathbf{y} \\in \\mathbb{C}^k$ 为某个非零系数向量。\n\n测试空间 $\\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 由矩阵 $\\mathbf{A}\\mathbf{V}_k$ 的列张成。因此，正交性条件 $\\mathbf{A}\\mathbf{u} - \\theta \\mathbf{u} \\perp \\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$可以表示为：\n$$ (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} (\\mathbf{A}\\mathbf{u} - \\theta \\mathbf{u}) = \\mathbf{0} $$\n将 $\\mathbf{u} = \\mathbf{V}_k \\mathbf{y}$ 代入此方程：\n$$ (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} (\\mathbf{A}(\\mathbf{V}_k \\mathbf{y}) - \\theta (\\mathbf{V}_k \\mathbf{y})) = \\mathbf{0} $$\n$$ (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} (\\mathbf{A}\\mathbf{V}_k) \\mathbf{y} - \\theta (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} (\\mathbf{V}_k) \\mathbf{y} = \\mathbf{0} $$\n这导出了 $k \\times k$ 维的广义特征值问题：\n$$ \\left( (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} \\mathbf{A}\\mathbf{V}_k \\right) \\mathbf{y} = \\theta \\left( (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} \\mathbf{V}_k \\right) \\mathbf{y} $$\n现在，我们使用 Arnoldi 关系式 $\\mathbf{A}\\mathbf{V}_k = \\mathbf{V}_k \\mathbf{H}_k + h_{k+1,k} \\mathbf{v}_{k+1} \\mathbf{e}_k^{\\top}$ 来用 $\\mathbf{H}_k$ 和 $h_{k+1,k}$ 表示这些矩阵。\n\n首先，考虑右侧的矩阵：$(\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} \\mathbf{V}_k$。\n$$ (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} \\mathbf{V}_k = (\\mathbf{V}_k \\mathbf{H}_k + h_{k+1,k} \\mathbf{v}_{k+1} \\mathbf{e}_k^{\\top})^{\\mathrm{H}} \\mathbf{V}_k = (\\mathbf{H}_k^{\\mathrm{H}} \\mathbf{V}_k^{\\mathrm{H}} + \\overline{h_{k+1,k}} \\mathbf{e}_k \\mathbf{v}_{k+1}^{\\mathrm{H}}) \\mathbf{V}_k $$\n由于 $h_{k+1,k} \\in \\mathbb{R}$，$\\overline{h_{k+1,k}} = h_{k+1,k}$。展开 $\\mathbf{V}_k$ 得：\n$$ \\mathbf{H}_k^{\\mathrm{H}} (\\mathbf{V}_k^{\\mathrm{H}} \\mathbf{V}_k) + h_{k+1,k} \\mathbf{e}_k (\\mathbf{v}_{k+1}^{\\mathrm{H}} \\mathbf{V}_k) $$\n根据 Arnoldi 过程的性质，$\\mathbf{V}_k$ 的列是标准正交的，所以 $\\mathbf{V}_k^{\\mathrm{H}} \\mathbf{V}_k = \\mathbf{I}_k$。同时，$\\mathbf{v}_{k+1}$ 与 $\\mathbf{V}_k$ 的列正交，所以 $\\mathbf{v}_{k+1}^{\\mathrm{H}} \\mathbf{V}_k = \\mathbf{0}^{\\top}$。代入这些结果：\n$$ (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} \\mathbf{V}_k = \\mathbf{H}_k^{\\mathrm{H}} \\mathbf{I}_k + h_{k+1,k} \\mathbf{e}_k \\mathbf{0}^{\\top} = \\mathbf{H}_k^{\\mathrm{H}} $$\n接下来，考虑左侧的矩阵：$(\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} \\mathbf{A}\\mathbf{V}_k$。\n$$ (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} \\mathbf{A}\\mathbf{V}_k = (\\mathbf{V}_k \\mathbf{H}_k + h_{k+1,k} \\mathbf{v}_{k+1} \\mathbf{e}_k^{\\top})^{\\mathrm{H}} (\\mathbf{V}_k \\mathbf{H}_k + h_{k+1,k} \\mathbf{v}_{k+1} \\mathbf{e}_k^{\\top}) $$\n$$ = (\\mathbf{H}_k^{\\mathrm{H}} \\mathbf{V}_k^{\\mathrm{H}} + h_{k+1,k} \\mathbf{e}_k \\mathbf{v}_{k+1}^{\\mathrm{H}}) (\\mathbf{V}_k \\mathbf{H}_k + h_{k+1,k} \\mathbf{v}_{k+1} \\mathbf{e}_k^{\\top}) $$\n展开乘积得到四项：\n1.  $\\mathbf{H}_k^{\\mathrm{H}} \\mathbf{V}_k^{\\mathrm{H}} \\mathbf{V}_k \\mathbf{H}_k = \\mathbf{H}_k^{\\mathrm{H}} \\mathbf{I}_k \\mathbf{H}_k = \\mathbf{H}_k^{\\mathrm{H}} \\mathbf{H}_k$\n2.  $\\mathbf{H}_k^{\\mathrm{H}} \\mathbf{V}_k^{\\mathrm{H}} (h_{k+1,k} \\mathbf{v}_{k+1} \\mathbf{e}_k^{\\top}) = h_{k+1,k} \\mathbf{H}_k^{\\mathrm{H}} (\\mathbf{V}_k^{\\mathrm{H}} \\mathbf{v}_{k+1}) \\mathbf{e}_k^{\\top} = h_{k+1,k} \\mathbf{H}_k^{\\mathrm{H}} \\mathbf{0} \\mathbf{e}_k^{\\top} = \\mathbf{O}$\n3.  $(h_{k+1,k} \\mathbf{e}_k \\mathbf{v}_{k+1}^{\\mathrm{H}}) \\mathbf{V}_k \\mathbf{H}_k = h_{k+1,k} \\mathbf{e}_k (\\mathbf{v}_{k+1}^{\\mathrm{H}} \\mathbf{V}_k) \\mathbf{H}_k = h_{k+1,k} \\mathbf{e}_k \\mathbf{0}^{\\top} \\mathbf{H}_k = \\mathbf{O}$\n4.  $(h_{k+1,k} \\mathbf{e}_k \\mathbf{v}_{k+1}^{\\mathrm{H}}) (h_{k+1,k} \\mathbf{v}_{k+1} \\mathbf{e}_k^{\\top}) = h_{k+1,k}^2 \\mathbf{e}_k (\\mathbf{v}_{k+1}^{\\mathrm{H}} \\mathbf{v}_{k+1}) \\mathbf{e}_k^{\\top} = h_{k+1,k}^2 \\mathbf{e}_k (1) \\mathbf{e}_k^{\\top} = h_{k+1,k}^2 \\mathbf{e}_k \\mathbf{e}_k^{\\top}$\n将这些项相加得到：\n$$ (\\mathbf{A}\\mathbf{V}_k)^{\\mathrm{H}} \\mathbf{A}\\mathbfV_k = \\mathbf{H}_k^{\\mathrm{H}} \\mathbf{H}_k + h_{k+1,k}^2 \\mathbf{e}_k \\mathbf{e}_k^{\\top} $$\n将这些表达式代回广义特征值问题，我们得到最终形式：\n$$ (\\mathbf{H}_k^{\\mathrm{H}} \\mathbf{H}_k + h_{k+1,k}^2 \\mathbf{e}_k \\mathbf{e}_k^{\\top}) \\mathbf{y} = \\theta (\\mathbf{H}_k^{\\mathrm{H}}) \\mathbf{y} $$\n谐波 Ritz 值 $\\theta$ 是矩阵束 $(\\mathbf{H}_k^{\\mathrm{H}} \\mathbf{H}_k + h_{k+1,k}^2 \\mathbf{e}_k \\mathbf{e}_k^{\\top}, \\mathbf{H}_k^{\\mathrm{H}})$ 的特征值。\n\n**第二部分：谐波 Ritz 值的计算**\n\n我们给定 $k=3$，$\\mathbf{H}_3 = \\begin{bmatrix} 1  2  0 \\\\ 0  1  3 \\\\ 0  0  1 \\end{bmatrix}$，以及 $h_{4,3} = 0.1$。\n令 $\\mathbf{M} = \\mathbf{H}_3^{\\mathrm{H}} \\mathbf{H}_3 + h_{4,3}^2 \\mathbf{e}_3 \\mathbf{e}_3^{\\top}$ 和 $\\mathbf{N} = \\mathbf{H}_3^{\\mathrm{H}}$。由于 $\\mathbf{H}_3$ 是实数矩阵，$\\mathbf{H}_3^{\\mathrm{H}} = \\mathbf{H}_3^{\\top}$。\n$$ \\mathbf{H}_3^{\\top} = \\begin{bmatrix} 1  0  0 \\\\ 2  1  0 \\\\ 0  3  1 \\end{bmatrix} $$\n我们计算 $\\mathbf{H}_3^{\\top} \\mathbf{H}_3$：\n$$ \\mathbf{H}_3^{\\top} \\mathbf{H}_3 = \\begin{bmatrix} 1  0  0 \\\\ 2  1  0 \\\\ 0  3  1 \\end{bmatrix} \\begin{bmatrix} 1  2  0 \\\\ 0  1  3 \\\\ 0  0  1 \\end{bmatrix} = \\begin{bmatrix} 1  2  0 \\\\ 2  5  3 \\\\ 0  3  10 \\end{bmatrix} $$\n接下来，我们计算 $\\mathbf{M}$ 的第二项：\n$$ h_{4,3}^2 \\mathbf{e}_3 \\mathbf{e}_3^{\\top} = (0.1)^2 \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} 0  0  1 \\end{bmatrix} = 0.01 \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{bmatrix} = \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0.01 \\end{bmatrix} $$\n所以，矩阵 $\\mathbf{M}$ 是：\n$$ \\mathbf{M} = \\begin{bmatrix} 1  2  0 \\\\ 2  5  3 \\\\ 0  3  10 \\end{bmatrix} + \\begin{bmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0.01 \\end{bmatrix} = \\begin{bmatrix} 1  2  0 \\\\ 2  5  3 \\\\ 0  3  10.01 \\end{bmatrix} $$\n谐波 Ritz 值 $\\theta$ 是 $\\det(\\mathbf{M} - \\theta \\mathbf{N}) = 0$ 的解。\n$$ \\mathbf{M} - \\theta \\mathbf{N} = \\begin{bmatrix} 1  2  0 \\\\ 2  5  3 \\\\ 0  3  10.01 \\end{bmatrix} - \\theta \\begin{bmatrix} 1  0  0 \\\\ 2  1  0 \\\\ 0  3  1 \\end{bmatrix} = \\begin{bmatrix} 1-\\theta  2  0 \\\\ 2-2\\theta  5-\\theta  3 \\\\ 0  3-3\\theta  10.01-\\theta \\end{bmatrix} $$\n我们计算行列式。让我们执行行变换 $R_2 \\to R_2 - 2R_1$。这不改变行列式的值。\n$$ \\det \\begin{pmatrix} 1-\\theta  2  0 \\\\ 2(1-\\theta) - 2(1-\\theta)  (5-\\theta) - 2(2)  3 - 2(0) \\\\ 0  3(1-\\theta)  10.01-\\theta \\end{pmatrix} = \\det \\begin{pmatrix} 1-\\theta  2  0 \\\\ 0  1-\\theta  3 \\\\ 0  3(1-\\theta)  10.01-\\theta \\end{pmatrix} $$\n沿第一列展开行列式：\n$$ (1-\\theta) \\det \\begin{pmatrix} 1-\\theta  3 \\\\ 3(1-\\theta)  10.01-\\theta \\end{pmatrix} $$\n这个 $2 \\times 2$ 行列式为：\n$$ (1-\\theta)(10.01-\\theta) - 3 \\cdot 3(1-\\theta) = (1-\\theta)[(10.01-\\theta) - 9] = (1-\\theta)(1.01-\\theta) $$\n所以，完整的特征多项式是 $(1-\\theta) \\cdot (1-\\theta)(1.01-\\theta) = (1-\\theta)^2(1.01-\\theta)$。\n令其为零，得到谐波 Ritz 值：$\\theta_1 = 1$ (代数重数为 2) 和 $\\theta_2 = 1.01$。三个谐波 Ritz 值为 1、1 和 1.01。\n\n**第三部分：与 GMRES 的联系**\n\n广义最小残差 (GMRES) 方法是一种用于求解大型线性系统 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 的迭代算法。从初始猜测 $\\mathbf{x}_0$ 开始，它计算一系列近似解 $\\mathbf{x}_k = \\mathbf{x}_0 + \\mathbf{z}_k$，其中校正量 $\\mathbf{z}_k$ 在 Krylov 子空间 $\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 中寻找，其中 $\\mathbf{r}_0 = \\mathbf{b} - \\mathbf{A}\\mathbf{x}_0$。\n\nGMRES 的定义属性是它找到唯一的校正量 $\\mathbf{z}_k$，使得相应残差向量 $\\mathbf{r}_k = \\mathbf{r}_0 - \\mathbf{A}\\mathbf{z}_k$ 的欧几里得范数最小化。这个线性最小二乘问题 $\\min_{\\mathbf{z}_k \\in \\mathcal{K}_k} \\|\\mathbf{r}_0 - \\mathbf{A}\\mathbf{z}_k\\|_2$ 的解由一个正交性条件来刻画：残差向量 $\\mathbf{r}_k$ 必须与子空间 $\\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$ 正交。\n$$ \\mathbf{r}_k \\perp \\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0) $$\n\n与谐波 Ritz 值的联系正在于这个确切的正交性条件。寻找谐波 Ritz 对 $(\\theta, \\mathbf{u})$ 的过程使用了一个 Petrov-Galerkin 条件，其中 Ritz 向量 $\\mathbf{u}$ 的搜索空间是 $\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$，而特征残差 $\\mathbf{A}\\mathbf{u} - \\theta \\mathbf{u}$ 的测试空间被特别选择为 $\\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0)$。\n$$ \\mathbf{A}\\mathbf{u} - \\theta \\mathbf{u} \\perp \\mathbf{A}\\mathcal{K}_k(\\mathbf{A}, \\mathbf{r}_0) $$\n\n因此，谐波 Ritz 值定义中测试空间 $\\mathbf{A}\\mathcal{K}_k$ 的选择，其直接动机来自于并等同于定义 GMRES 残差最优性的空间。这使得谐波 Ritz 值成为理解 GMRES 行为的有力工具。虽然标准 Ritz 值（$\\mathbf{H}_k$ 的特征值）与 GMRES 残差多项式的根有关，但谐波 Ritz 值特别擅长逼近 $\\mathbf{A}$ 在原点附近的特征值。GMRES 的缓慢收敛通常与小特征值的存在有关，而一个小的谐波 Ritz 值的出现可以预示并诊断此类收敛困难。从这个意义上说，谐波 Ritz 分析是针对 GMRES 方法自身特性进行“调整”的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.00000  1.00000  1.01000\n\\end{pmatrix}\n}\n$$"
        }
    ]
}