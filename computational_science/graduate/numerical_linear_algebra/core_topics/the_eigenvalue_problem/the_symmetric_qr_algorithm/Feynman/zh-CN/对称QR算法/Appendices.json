{
    "hands_on_practices": [
        {
            "introduction": "这个练习将带你深入对称 QR 算法的基础构件：QR 分解。我们将使用 Givens 旋转，这是一种旨在矩阵特定位置引入零元素的平面旋转。通过对一个简单的 $3 \\times 3$ 对称三对角矩阵应用一系列 Givens 旋转，你将亲手实践 QR 分解的过程 ，并理解三对角结构在这些变换下的特性，从而巩固该算法背后的几何直觉。",
            "id": "3597852",
            "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是一个实对称三对角矩阵\n$$\nA \\;=\\;\n\\begin{pmatrix}\n5  2  0 \\\\\n2  4  3 \\\\\n0  3  1\n\\end{pmatrix}.\n$$\n一个实矩阵 $A$ 的正交三角（QR）分解是一种表示形式 $A = Q R$，其中 $Q$ 是正交矩阵（即 $Q^{\\top} Q = I$），$R$ 是上三角矩阵。对于对称三对角矩阵，对称QR算法应用一系列平面吉文斯旋转来消去次对角线元素，在保持正交性的同时，维持变换后矩阵的上三角结构。\n\n从正交性和吉文斯旋转的基本定义出发，明确地构造一个由两个吉文斯旋转组成的序列，当它们左乘 $A$ 时，能够消去 $A$ 的第1列和第2列的次对角线元素。将这些旋转记为 $G_{1}$（作用于第1行和第2行）和 $G_{2}$（作用于第2行和第3行）。从第一性原理验证所得到的矩阵 $R = G_{2} G_{1} A$ 是上三角矩阵，并且正交因子满足 $Q = G_{1}^{\\top} G_{2}^{\\top}$。以符号形式给出所有中间量（不要用小数近似值替代），并且只使用由核心定义所证明的精确代数运算。\n\n你的最终任务是报告通过此过程得到的上三角因子 $R$ 的 (2,3) 元素的精确闭式解值。将最终答案表示为单个解析表达式。无需进行四舍五入。",
            "solution": "目标是计算矩阵 $R$ 的 (2,3) 元素，其中 $R = G_{2} G_{1} A$。该过程涉及使用吉文斯旋转进行的两步消元。\n\n一个通用的 $2 \\times 2$ 吉文斯旋转矩阵具有以下形式：\n$$\nG(\\theta) = \\begin{pmatrix} \\cos(\\theta)  -\\sin(\\theta) \\\\ \\sin(\\theta)  \\cos(\\theta) \\end{pmatrix} = \\begin{pmatrix} c  -s \\\\ s  c \\end{pmatrix}\n$$\n其中 $c^2 + s^2 = 1$。当将其应用于向量 $\\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 时，结果为 $\\begin{pmatrix} cx_1 - sx_2 \\\\ sx_1 + cx_2 \\end{pmatrix}$。为了消去第二个分量，我们需要 $sx_1 + cx_2 = 0$。一个满足此条件及 $c^2+s^2=1$ 的标准选择是 $c = \\frac{x_1}{\\sqrt{x_1^2 + x_2^2}}$ 和 $s = \\frac{-x_2}{\\sqrt{x_1^2 + x_2^2}}$。\n\n**步骤 1：消去 $A$ 的 $(2,1)$ 元素**\n\n我们对 $A$ 的第1行和第2行应用一个吉文斯旋转 $G_1$ 以消去元素 $A_{21}=2$。相关元素来自第一列：$x_1 = A_{11} = 5$ 和 $x_2 = A_{21} = 2$。\n\n该旋转的参数 $c_1$ 和 $s_1$ 计算如下：\n$$\nr_1 = \\sqrt{x_1^2 + x_2^2} = \\sqrt{5^2 + 2^2} = \\sqrt{25 + 4} = \\sqrt{29}\n$$\n$$\nc_1 = \\frac{x_1}{r_1} = \\frac{5}{\\sqrt{29}}, \\quad s_1 = \\frac{-x_2}{r_1} = \\frac{-2}{\\sqrt{29}}\n$$\n吉文斯旋转矩阵 $G_1$ 作用于第一和第二坐标构成的平面，在其他地方是单位矩阵。\n$$\nG_1 = \\begin{pmatrix} c_1  -s_1  0 \\\\ s_1  c_1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{\\sqrt{29}}  \\frac{2}{\\sqrt{29}}  0 \\\\ \\frac{-2}{\\sqrt{29}}  \\frac{5}{\\sqrt{29}}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n我们现在计算中间矩阵 $A' = G_1 A$：\n$$\nA' = \\begin{pmatrix} \\frac{5}{\\sqrt{29}}  \\frac{2}{\\sqrt{29}}  0 \\\\ \\frac{-2}{\\sqrt{29}}  \\frac{5}{\\sqrt{29}}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 5  2  0 \\\\ 2  4  3 \\\\ 0  3  1 \\end{pmatrix}\n$$\n$A'$ 的各行为：\n- 第1行：$(\\frac{5}{\\sqrt{29}})\\begin{pmatrix} 5  2  0 \\end{pmatrix} + (\\frac{2}{\\sqrt{29}})\\begin{pmatrix} 2  4  3 \\end{pmatrix} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 25+4  10+8  0+6 \\end{pmatrix} = \\begin{pmatrix} \\frac{29}{\\sqrt{29}}  \\frac{18}{\\sqrt{29}}  \\frac{6}{\\sqrt{29}} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{29}  \\frac{18}{\\sqrt{29}}  \\frac{6}{\\sqrt{29}} \\end{pmatrix}$\n- 第2行：$(\\frac{-2}{\\sqrt{29}})\\begin{pmatrix} 5  2  0 \\end{pmatrix} + (\\frac{5}{\\sqrt{29}})\\begin{pmatrix} 2  4  3 \\end{pmatrix} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} -10+10  -4+20  0+15 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{16}{\\sqrt{29}}  \\frac{15}{\\sqrt{29}} \\end{pmatrix}$\n- 第3行：此行不变：$\\begin{pmatrix} 0  3  1 \\end{pmatrix}$。\n\n所以，中间矩阵为：\n$$\nA' = \\begin{pmatrix} \\sqrt{29}  \\frac{18}{\\sqrt{29}}  \\frac{6}{\\sqrt{29}} \\\\ 0  \\frac{16}{\\sqrt{29}}  \\frac{15}{\\sqrt{29}} \\\\ 0  3  1 \\end{pmatrix}\n$$\n按要求，(2,1) 元素已被消去。\n\n**步骤 2：消去 $A'$ 的 $(3,2)$ 元素**\n\n接下来，我们对 $A'$ 的第2行和第3行应用一个吉文斯旋转 $G_2$，以消去元素 $A'_{32}=3$。相关元素来自 $A'$ 的第二列：$x_1' = A'_{22} = \\frac{16}{\\sqrt{29}}$ 和 $x_2' = A'_{32} = 3$。\n\n该旋转的参数 $c_2$ 和 $s_2$ 为：\n$$\nr_2 = \\sqrt{(x_1')^2 + (x_2')^2} = \\sqrt{\\left(\\frac{16}{\\sqrt{29}}\\right)^2 + 3^2} = \\sqrt{\\frac{256}{29} + 9} = \\sqrt{\\frac{256 + 9 \\cdot 29}{29}} = \\sqrt{\\frac{256 + 261}{29}} = \\sqrt{\\frac{517}{29}}\n$$\n$$\nc_2 = \\frac{x_1'}{r_2} = \\frac{16/\\sqrt{29}}{\\sqrt{517/29}} = \\frac{16}{\\sqrt{517}}, \\quad s_2 = \\frac{-x_2'}{r_2} = \\frac{-3}{\\sqrt{517/29}} = \\frac{-3\\sqrt{29}}{\\sqrt{517}}\n$$\n吉文斯旋转矩阵 $G_2$ 作用于第二和第三坐标构成的平面：\n$$\nG_2 = \\begin{pmatrix} 1  0  0 \\\\ 0  c_2  -s_2 \\\\ 0  s_2  c_2 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  \\frac{16}{\\sqrt{517}}  \\frac{3\\sqrt{29}}{\\sqrt{517}} \\\\ 0  \\frac{-3\\sqrt{29}}{\\sqrt{517}}  \\frac{16}{\\sqrt{517}} \\end{pmatrix}\n$$\n\n**步骤 3：计算 $R = G_2 A'$ 的 $(2,3)$ 元素**\n\n最终的上三角矩阵是 $R = G_2 A'$。我们需要求的是元素 $R_{23}$。该元素是 $G_2$ 的第二行与 $A'$ 的第三列的点积。\n$$\nR_{23} = (G_2)_{21}A'_{13} + (G_2)_{22}A'_{23} + (G_2)_{23}A'_{33}\n$$\n代入数值：\n$$\nR_{23} = (0)A'_{13} + (c_2)A'_{23} + (-s_2)A'_{33} = c_2 A'_{23} - s_2 A'_{33}\n$$\n我们有 $A'_{23} = \\frac{15}{\\sqrt{29}}$ 和 $A'_{33} = 1$。代入 $c_2$ 和 $s_2$ 的值：\n$$\nR_{23} = \\left(\\frac{16}{\\sqrt{517}}\\right) \\left(\\frac{15}{\\sqrt{29}}\\right) - \\left(\\frac{-3\\sqrt{29}}{\\sqrt{517}}\\right) (1)\n$$\n$$\nR_{23} = \\frac{16 \\cdot 15}{\\sqrt{517}\\sqrt{29}} + \\frac{3\\sqrt{29}}{\\sqrt{517}}\n$$\n为了合并这些项，我们找到公分母，即 $\\sqrt{517}\\sqrt{29} = \\sqrt{517 \\cdot 29} = \\sqrt{14993}$。\n$$\nR_{23} = \\frac{240}{\\sqrt{14993}} + \\frac{3\\sqrt{29} \\cdot \\sqrt{29}}{\\sqrt{517}\\sqrt{29}} = \\frac{240}{\\sqrt{14993}} + \\frac{3 \\cdot 29}{\\sqrt{14993}}\n$$\n$$\nR_{23} = \\frac{240 + 87}{\\sqrt{14993}} = \\frac{327}{\\sqrt{14993}}\n$$\n\n**性质验证**\n\n按要求，我们简要验证该分解的性质。\n1.  **$Q$ 的正交性**：正交因子是 $Q=G_1^\\top G_2^\\top$。由于吉文斯旋转是正交矩阵（$G_1^\\top G_1 = I$，$G_2^\\top G_2 = I$），它们的转置也是正交的。正交矩阵的乘积仍然是正交的。我们可以直接验证这一点：\n    $$\n    Q^\\top Q = (G_1^\\top G_2^\\top)^\\top (G_1^\\top G_2^\\top) = (G_2 G_1) (G_1^\\top G_2^\\top) = G_2 (G_1 G_1^\\top) G_2^\\top = G_2 I G_2^\\top = G_2 G_2^\\top = I\n    $$\n2.  **$R$ 的上三角结构**：矩阵 $R=G_2 G_1 A = G_2 A'$。\n    - $A'_{21}$ 和 $A'_{31}$ 均为零。应用 $G_2$ 不会改变这些值，因为 $G_2$ 只混合第2行和第3行。因此 $R_{21}=0$ 和 $R_{31}=0$。\n    - 元素 $R_{32}$ 由 $G_2$ 的第三行和 $A'$ 的第二列计算得出。\n      $$\n      R_{32} = s_2 A'_{22} + c_2 A'_{32} = (\\frac{-3\\sqrt{29}}{\\sqrt{517}})(\\frac{16}{\\sqrt{29}}) + (\\frac{16}{\\sqrt{517}})(3) = \\frac{-48}{\\sqrt{517}} + \\frac{48}{\\sqrt{517}} = 0\n      $$\n    这证实了 $R$ 确实是一个上三角矩阵。\n\n最终推导出的 $R_{23}$ 值是解析精确的，并且基于第一性原理。",
            "answer": "$$\\boxed{\\frac{327}{\\sqrt{14993}}}$$"
        },
        {
            "introduction": "在掌握了 Givens 旋转的基本操作后，下一个练习将探索现代 QR 算法的核心引擎：隐式位移 QR 迭代步。我们不再显式地构造位移矩阵 $T - \\mu I$ 再对其进行分解，而是巧妙地通过一个初始旋转在三对角结构之外制造一个“凸起”（bulge），然后用一系列后续旋转将这个凸起“追赶”下去，从而恢复矩阵的三对角形态。本练习将引导你完成这个“凸起追赶”过程的最初两步 ，让你领略隐式方法的精妙与高效。",
            "id": "3597848",
            "problem": "考虑对称三对角矩阵 $T \\in \\mathbb{R}^{5 \\times 5}$，其对角线元素为 $a_1=6$, $a_2=5$, $a_3=4$, $a_4=5$, $a_5=6$，非对角线元素为 $b_1=1$, $b_2=2$, $b_3=2$, $b_4=1$，即\n$$\nT \\;=\\;\n\\begin{pmatrix}\n6  1  0  0  0 \\\\\n1  5  2  0  0 \\\\\n0  2  4  2  0 \\\\\n0  0  2  5  1 \\\\\n0  0  0  1  6\n\\end{pmatrix}.\n$$\n使用位移 $\\mu=5$，执行一次带位移的隐式QR步的前两次追逐凸起的吉文斯旋转，如下所示：\n\n1. 构造一个作用于下标 $(1,2)$ 的吉文斯旋转 $G_1$，使得 $G_1^{\\top} (T - \\mu I) e_1$ 是 $e_1$ 的标量倍，并更新 $T^{(1)} = G_1^{\\top} T G_1$。\n\n2. 然后构造一个作用于下标 $(2,3)$ 的吉文斯旋转 $G_2$，使得左乘 $G_2^{\\top}$ 将 $T^{(1)}$ 的 $(3,1)$ 元素化为零，并更新 $T^{(2)} = G_2^{\\top} T^{(1)} G_2$。\n\n仅从正交相似、吉文斯旋转和隐式位移构造的定义出发，显式地执行这两次旋转，并计算前导 $3 \\times 3$ 子块中受影响的更新后的三对角元素。报告这两次旋转后第 $2$ 行和第 $3$ 行之间更新后的非对角线元素的实数值，即 $b_2^{(2)} = T^{(2)}_{2,3}$。请以精确的封闭形式给出答案，不要四舍五入。",
            "solution": "该过程包括使用吉文斯旋转进行相似变换的两个阶段。\n\n**阶段1：第一次吉文斯旋转以产生凸起**\n\n带位移 $\\mu$ 的隐式QR迭代的第一步是应用一个旋转 $G_1$。如果我们显式计算，这个旋转会在位移矩阵 $T - \\mu I$ 的第一列中引入一个零。$T - \\mu I$ 的第一列由下式给出：\n$$\nx = (T - \\mu I)e_1 = (T - 5I)e_1 =\n\\begin{pmatrix}\n6-5 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n我们需要找到一个作用于 $(1,2)$ 平面的吉文斯旋转 $G_1$，它将向量 $x$ 的第二个分量化为零。吉文斯旋转矩阵 $G(i,j,c,s)$ 通常被定义为其转置 $G(i,j,c,s)^{\\top}$ 旋转向量。设旋转由 $c = \\cos(\\theta)$ 和 $s = \\sin(\\theta)$ 定义。作用于 $(1,2)$ 平面的矩阵 $G_1^{\\top}$ 具有以下形式：\n$$\nG_1^{\\top} =\n\\begin{pmatrix}\nc  s  0  0  0 \\\\\n-s  c  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0 \\\\\n0  0  0  0  1\n\\end{pmatrix}\n$$\n为了将 $x=(1,1,0,0,0)^{\\top}$ 的第二个分量化为零，我们设 $c = \\frac{x_1}{r}$ 和 $s = \\frac{x_2}{r}$，其中 $r = \\sqrt{x_1^2 + x_2^2}$。当 $x_1=1$ 和 $x_2=1$ 时，为使 $-s x_1 + c x_2=0$ (即 $-s+c=0$)，我们取 $c=s$。由于 $c^2+s^2=1$，我们得到：\n$$\nc = \\frac{1}{\\sqrt{2}}, \\quad s = \\frac{1}{\\sqrt{2}}\n$$\n隐式QR方法通过相似变换将此旋转应用于矩阵 $T$ 本身：$T^{(1)} = G_1^{\\top} T G_1$。此变换只影响第 1 行和第 2 行以及第 1 列和第 2 列，并在位置 $(1,3)$ 和 $(3,1)$ 处产生一个非零项，即“凸起”。\n\n在第一步之后，$T^{(1)}$ 的相关元素计算如下：\n- $T^{(1)}_{21} = (c^2-s^2)T_{12} + cs(T_{22}-T_{11}) = 0 \\cdot 1 + \\frac{1}{2}(5-6) = -\\frac{1}{2}$。\n- $T^{(1)}_{31} = T_{32} \\cdot s = 2 \\cdot \\frac{1}{\\sqrt{2}} = \\sqrt{2}$。这就是凸起。\n- $T^{(1)}_{22} = s^2 T_{11} - 2cs T_{12} + c^2 T_{22} = (\\frac{1}{2})(6) - 2(\\frac{1}{2})(1) + (\\frac{1}{2})(5) = 3 - 1 + 2.5 = \\frac{9}{2}$。\n- $T^{(1)}_{33}$ 在此步中不受影响，$T^{(1)}_{33} = T_{33} = 4$。\n- $T^{(1)}_{23} = -s \\cdot T_{13} + c \\cdot T_{23} = -\\frac{1}{\\sqrt{2}}(0) + \\frac{1}{\\sqrt{2}}(2) = \\sqrt{2}$。\n\n**阶段2：第二次吉文斯旋转以追逐凸起**\n\n下一步是沿着对角线“追逐”凸起。我们应用第二次吉文斯旋转 $G_2$，作用于 $(2,3)$ 平面，以消除新的非零项 $T^{(1)}_{31} = \\sqrt{2}$。这是通过左乘 $G_2^\\top$ 来完成的，它旋转 $T^{(1)}$ 的第 2 行和第 3 行，从而将 $(3,1)$ 元素化为零。\n\n为此，我们需要旋转向量 $(T^{(1)}_{21}, T^{(1)}_{31}) = (-1/2, \\sqrt{2})$，使其第二个分量为零。设新的旋转参数为 $c'$ 和 $s'$。\n令 $x'_2 = -1/2$ 和 $x'_3 = \\sqrt{2}$。\n$r' = \\sqrt{(x'_2)^2 + (x'_3)^2} = \\sqrt{(-\\frac{1}{2})^2 + (\\sqrt{2})^2} = \\sqrt{\\frac{1}{4} + 2} = \\sqrt{\\frac{9}{4}} = \\frac{3}{2}$。\n我们使用 $G_2^\\top = \\begin{pmatrix} 1  0  0 \\\\ 0  c'  s' \\\\ 0  -s'  c' \\end{pmatrix}$ 形式的旋转，需要 $-s'x'_2 + c'x'_3 = 0$。\n这给出 $s'/c' = x'_3/x'_2 = \\sqrt{2}/(-1/2) = -2\\sqrt{2}$。\n我们选择 $c' = \\frac{x'_2}{r'} = \\frac{-1/2}{3/2} = -\\frac{1}{3}$ 和 $s' = \\frac{-x'_3}{r'} = \\frac{-\\sqrt{2}}{3/2} = -\\frac{2\\sqrt{2}}{3}$。\n这与 $s'/c'$ 的比率不符。\n正确的选择是 $c' = |x'_2|/r'$ 或 $c'=x'_2/r'$ 等，取决于旋转形式。让我们使用旨在将向量 $(a,b)^T$ 变为 $(r,0)^T$ 的标准旋转 $G^T=\\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix}$，其中 $c=a/r, s=b/r$。\n我们的向量是 $(T^{(1)}_{21}, T^{(1)}_{31})=(-1/2, \\sqrt{2})$。\n$c' = \\frac{-1/2}{3/2} = -1/3$。\n$s' = \\frac{\\sqrt{2}}{3/2} = \\frac{2\\sqrt{2}}{3}$。\n\n现在我们计算 $T^{(2)} = G_2^{\\top} T^{(1)} G_2$。我们关心的是元素 $T^{(2)}_{2,3}$。旋转 $G_2$ 作用于第 2 和第 3 行/列。我们可以通过考虑子矩阵 $A = T^{(1)}_{2:3, 2:3}$ 上的相似变换来找到元素 $T^{(2)}_{2,3}$。\n$A = T^{(1)}_{2:3, 2:3} = \\begin{pmatrix} T^{(1)}_{22}  T^{(1)}_{23} \\\\ T^{(1)}_{32}  T^{(1)}_{33} \\end{pmatrix} = \\begin{pmatrix} 9/2  \\sqrt{2} \\\\ \\sqrt{2}  4 \\end{pmatrix}$。\n更新后的子矩阵是 $A' = G'^{\\top} A G'$，其中 $G' = \\begin{pmatrix} c'  -s' \\\\ s'  c' \\end{pmatrix}$。\n$T^{(2)}_{2,3}$ 对应于 $A'_{12}$，使用公式 $A'_{12} = (c'^2 - s'^2)A_{12} + c's'(A_{22} - A_{11})$。\n我们有以下值：\n$c' = -1/3 \\implies c'^2 = 1/9$。\n$s' = 2\\sqrt{2}/3 \\implies s'^2 = 8/9$。\n$A_{11} = 9/2$, $A_{12} = \\sqrt{2}$, $A_{22} = 4$。\n\n将这些值代入公式中：\n$T^{(2)}_{2,3} = \\left(\\frac{1}{9} - \\frac{8}{9}\\right)(\\sqrt{2}) + \\left(-\\frac{1}{3}\\right)\\left(\\frac{2\\sqrt{2}}{3}\\right)\\left(4 - \\frac{9}{2}\\right)$。\n$T^{(2)}_{2,3} = \\left(-\\frac{7}{9}\\right)(\\sqrt{2}) + \\left(-\\frac{2\\sqrt{2}}{9}\\right)\\left(\\frac{8}{2} - \\frac{9}{2}\\right)$。\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\left(-\\frac{2\\sqrt{2}}{9}\\right)\\left(-\\frac{1}{2}\\right)$。\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\frac{2\\sqrt{2}}{18}$。\n$T^{(2)}_{2,3} = -\\frac{7\\sqrt{2}}{9} + \\frac{\\sqrt{2}}{9}$。\n$T^{(2)}_{2,3} = -\\frac{6\\sqrt{2}}{9} = -\\frac{2\\sqrt{2}}{3}$。\n\n更新后的非对角线元素 $b_2^{(2)}$ 的值是 $T^{(2)}_{2,3}$。",
            "answer": "$$\n\\boxed{-\\frac{2\\sqrt{2}}{3}}\n$$"
        },
        {
            "introduction": "一个迭代算法的实用性取决于它是否知道何时停止。最后的这个练习将探讨 QR 算法在实际应用中的一个关键环节：降维（deflation）。当一个次对角线元素变得足够小时，我们可以将其视为零，从而有效地将原问题“降维”成更小的、独立的子问题。本练习要求你应用一个基于后向误差分析的标准检验 ，来判断是否应对给定的矩阵进行降维操作，从而将抽象的算法与有限精度浮点运算的现实联系起来。",
            "id": "3597821",
            "problem": "考虑对称三对角矩阵 $T \\in \\mathbb{R}^{5 \\times 5}$，\n$$\nT \\;=\\;\n\\begin{pmatrix}\n4  0.8  0  0  0 \\\\\n0.8  6  0.3  0  0 \\\\\n0  0.3  5  0.4  0 \\\\\n0  0  0.4  7  1.0 \\times 10^{-16} \\\\\n0  0  0  1.0 \\times 10^{-16}  9\n\\end{pmatrix}.\n$$\n应用于对称三对角矩阵、带 Wilkinson 位移的正交三角（QR）算法的单步迭代会执行一个保持对称性和三对角结构的正交相似变换。在遵循标准舍入模型 $\\operatorname{fl}(x \\,\\circ\\, y) = (x \\,\\circ\\, y)(1 + \\delta)$ 且 $|\\delta| \\leq u$（其中 $u$ 是单位舍入）的浮点运算中，计算出的步骤是向后稳定的，即对于一个轻微扰动的矩阵，该步骤是精确的。假设机器模型为电气和电子工程师协会（IEEE）双精度，单位舍入为 $u = 2^{-53}$。\n\n从对称三对角矩阵的正交相似变换的向后误差观点以及特征值在正交相似性下的不变性出发，推导一个针对索引为 $k$ 的次对角线元素 $b_{k}$ 的、在实践中合理的降维测试（deflation test），以确保任何强制置零操作 $b_{k} \\leftarrow 0$ 都在计算出的 QR 步骤的向后误差范围之内。将你推导出的测试应用于 $T$ 的末尾次对角线元素，并决定是否应在该索引处执行降维。如果执行了降维，请写下将在后续迭代中使用的、最终得到的分块对角结构。你最终报告的量必须是发生分裂的降维索引 $k$。如果没有必要进行降维，则报告 $k = 0$。\n\n以单个整数形式提供你的最终答案。无需舍入。不涉及物理单位。",
            "solution": "本题要求推导一个用于对称 QR 算法的、在实践中合理的降维测试，并将其应用于一个特定的对称三对角矩阵 $T$。\n\n首先，我们推导降维测试。设 $T$ 是一个 $n \\times n$ 的对称三对角矩阵，其对角线元素为 $a_1, \\dots, a_n$，次对角线元素为 $b_1, \\dots, b_{n-1}$。\n$$\nT \\;=\\;\n\\begin{pmatrix}\na_1  b_1    \\\\\nb_1  a_2  b_2   \\\\\n  \\ddots  \\ddots  \\ddots  \\\\\n   b_{n-2}  a_{n-1}  b_{n-1} \\\\\n     b_{n-1}  a_n\n\\end{pmatrix}\n$$\nQR 算法的核心原理是生成一个正交相似矩阵序列 $T_s$，该序列收敛于一个由特征值组成的对角矩阵。由于浮点运算，计算出的迭代矩阵 $\\hat{T}_{s+1}$ 与前一个迭代矩阵 $T_s$ 并非完全正交相似。然而，由 J.H. Wilkinson 开创的向后误差分析表明，$\\hat{T}_{s+1}$ 与一个扰动矩阵 $T_s + E_s$ 完全正交相似，其中 $E_s$ 是一个对称扰动矩阵。$E_s$ 的元素很小，数量级为 $u \\|T_s\\|$，其中 $u$ 是单位舍入。\n\n降维（Deflation）是将一个足够小的次对角线元素 $b_k$ 置零的过程。这将矩阵解耦为两个更小的、独立的三对角块 $T(1:k, 1:k)$ 和 $T(k+1:n, k+1:n)$。整个特征值问题于是简化为两个更小的子问题。该策略对于算法的效率和收敛性至关重要。\n\n将 $b_k=0$ 的合理性来自于向后误差的观点。将 $b_k$ 置零会对矩阵 $T$ 引入一个扰动 $\\Delta T_k$，其中唯一的非零项是 $(\\Delta T_k)_{k, k+1} = (\\Delta T_k)_{k+1, k} = -b_k$。修改后矩阵 $T - \\Delta T_k$ 的特征值是两个所得分块的特征值的并集。根据针对对称矩阵的 Bauer-Fike 定理，特征值的扰动由变化的谱范数界定，即 $\\|\\Delta T_k\\|_2 = |b_k|$。\n\n关键步骤是确定何时该扰动 $|b_k|$ 是“可接受的小”。如果一个扰动与由于先前计算累积的舍入误差而导致的矩阵元素中的内在不确定性处于同一数量级，则该扰动是可接受的。计算出的对角线元素 $a_k$ 和 $a_{k+1}$ 并不精确；它们分别带有大约 $u|a_k|$ 和 $u|a_{k+1}|$ 的不确定性。\n\n一个实用且广泛使用的降维准则是，如果 $b_k$ 的量级相对于其相邻对角线元素的量级而言，处于机器精度的数量级，则可认为 $b_k$ 是可忽略的。这确保了将 $b_k$ 置零的影响消失在 $a_k$ 和 $a_{k+1}$ 的浮点表示的“噪声”中。具体的测试是：\n$$|b_k| \\le u (|a_k| + |a_{k+1}|)$$\n如果此条件成立，我们可以设置 $b_k \\leftarrow 0$，而不会引入超出 QR 算法单步迭代所固有的向后误差的显著误差。这就是我们将在实践中使用的合理降维测试。\n\n现在，我们将此测试应用于给定的矩阵 $T$。矩阵元素为：\n对角线元素：$a_1=4$, $a_2=6$, $a_3=5$, $a_4=7$, $a_5=9$。\n次对角线元素：$b_1=0.8$, $b_2=0.3$, $b_3=0.4$, $b_4=1.0 \\times 10^{-16}$。\n\n题目要求测试末尾的次对角线元素，即 $b_4$。因此，我们设 $k=4$。相关元素为：\n$b_4 = 1.0 \\times 10^{-16}$\n$a_4 = 7$\n$a_5 = 9$\n给定的单位舍入为 $u = 2^{-53}$。\n\n我们将这些值代入降维不等式：\n$$|b_4| \\le u (|a_4| + |a_5|)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} (|7| + |9|)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} (16)$$\n$$1.0 \\times 10^{-16} \\le 2^{-53} \\cdot 2^4$$\n$$1.0 \\times 10^{-16} \\le 2^{-49}$$\n为了在不使用计算器的情况下验证此不等式，我们可以使用近似值 $2^{10} = 1024 \\approx 10^3$。\n$2^{-49} = 2 \\cdot 2^{-50} = 2 \\cdot (2^{10})^{-5} \\approx 2 \\cdot (10^3)^{-5} = 2 \\times 10^{-15}$。\n不等式变为 $1.0 \\times 10^{-16} \\le 2 \\times 10^{-15}$。\n这是成立的，因为 $1.0 \\times 10^{-16} = 0.1 \\times 10^{-15}$，而 $0.1 \\times 10^{-15} \\le 2 \\times 10^{-15}$。\n\n由于条件 $|b_4| \\le u(|a_4| + |a_5|)$ 成立，应该通过将 $b_4$ 置零来执行降维。这意味着矩阵 $T$ 在第 4 行和第 5 行（以及第 4 列和第 5 列）之间被分裂。发生分裂的索引是 $k=4$。\n得到的矩阵具有分块对角结构：\n$$\nT' \\;=\\;\n\\begin{pmatrix}\n4  0.8  0  0  0 \\\\\n0.8  6  0.3  0  0 \\\\\n0  0.3  5  0.4  0 \\\\\n0  0  0.4  7  0 \\\\\n0  0  0  0  9\n\\end{pmatrix}\n$$\n现在问题被分解为求解首部的 $4 \\times 4$ 子矩阵和尾部的 $1 \\times 1$ 子矩阵的特征值。后者立即给出一个特征值 $\\lambda=9$。然后算法将继续处理 $4 \\times 4$ 的子问题。\n\n发生分裂的降维索引 $k$ 是被置零的次对角线元素的索引。在这种情况下，即为 $k=4$。",
            "answer": "$$\\boxed{4}$$"
        }
    ]
}