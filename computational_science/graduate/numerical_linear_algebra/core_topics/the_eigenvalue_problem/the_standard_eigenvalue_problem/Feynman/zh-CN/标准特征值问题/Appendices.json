{
    "hands_on_practices": [
        {
            "introduction": "标准特征值问题适用于所有方阵，但具有特殊结构的矩阵（如 Hermitian 矩阵）会展现出一些非常优美的性质。本练习将引导您通过第一性原理，为一个简单的实对称矩阵（Hermitian 矩阵的特例）计算其特征值和特征向量，并亲自验证其特征向量的正交性。这项实践不仅能巩固您对 Hermitian 矩阵谱理论的理解，也揭示了许多高效数值算法背后的基本原理。",
            "id": "3597596",
            "problem": "考虑厄米特矩阵 $A$ 的标准特征值问题，其中 $A$ 为\n$$\nA = \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix}.\n$$\n从特征对 $(\\lambda, v)$ 满足 $A v=\\lambda v$ (其中 $v\\neq 0$) 以及特征值 $\\lambda$ 满足 $\\det(A-\\lambda I)=0$ 的定义出发，从第一性原理完成以下任务：\n- 推导 $A$ 的特征多项式并计算所有特征值。\n- 对每个特征值，通过求解齐次线性方程组 $(A-\\lambda I)v=0$ 构造相应的特征向量，并将每个特征向量缩放至单位2-范数。\n- 使用欧几里得内积，验证这些归一化的特征向量是正交的，并解释为什么对于具有不同特征值的厄米特矩阵，这一性质成立。\n\n最后，确定关于矩阵二范数的光谱条件数，记为 $\\kappa_{2}(A)$，其定义为 $A$ 的最大奇异值与最小奇异值之比。将你的最终答案表示为单个精确的解析表达式，无需四舍五入。",
            "solution": "该问题定义明确且自成一体，是线性代数中的一个标准练习。给定矩阵是一个 $2 \\times 2$ 的实对称矩阵，这是厄米特矩阵的一个特例。我们将按指定顺序完成各项任务。\n\n给定矩阵为\n$$\nA = \\begin{pmatrix} 4   1 \\\\ 1   2 \\end{pmatrix}\n$$\n该矩阵是厄米特矩阵，因为 $A = A^T = A^H$，其中 $A^H$ 是 $A$ 的共轭转置。\n\n### 第一部分：特征多项式与特征值\n\n特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n首先，我们构造矩阵 $A - \\lambda I$：\n$$\nA - \\lambda I = \\begin{pmatrix} 4   1 \\\\ 1   2 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1   0 \\\\ 0   1 \\end{pmatrix} = \\begin{pmatrix} 4-\\lambda   1 \\\\ 1   2-\\lambda \\end{pmatrix}\n$$\n接下来，我们计算该矩阵的行列式以求得特征多项式 $p(\\lambda)$：\n$$\np(\\lambda) = \\det(A - \\lambda I) = (4-\\lambda)(2-\\lambda) - (1)(1)\n$$\n$$\np(\\lambda) = 8 - 4\\lambda - 2\\lambda + \\lambda^2 - 1\n$$\n$$\np(\\lambda) = \\lambda^2 - 6\\lambda + 7\n$$\n这就是 $A$ 的特征多项式。为了求出特征值，我们令 $p(\\lambda) = 0$ 并使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $\\lambda$：\n$$\n\\lambda = \\frac{-(-6) \\pm \\sqrt{(-6)^2 - 4(1)(7)}}{2(1)} = \\frac{6 \\pm \\sqrt{36 - 28}}{2} = \\frac{6 \\pm \\sqrt{8}}{2}\n$$\n因为 $\\sqrt{8} = \\sqrt{4 \\cdot 2} = 2\\sqrt{2}$，所以特征值为：\n$$\n\\lambda = \\frac{6 \\pm 2\\sqrt{2}}{2} = 3 \\pm \\sqrt{2}\n$$\n我们将较大的特征值记为 $\\lambda_1$，较小的记为 $\\lambda_2$：\n$$\n\\lambda_1 = 3 + \\sqrt{2}\n$$\n$$\n\\lambda_2 = 3 - \\sqrt{2}\n$$\n\n### 第二部分：特征向量与归一化\n\n对于每个特征值，我们通过求解齐次方程组 $(A - \\lambda I)v = 0$ 来找到相应的特征向量 $v$。\n\n对于 $\\lambda_1 = 3 + \\sqrt{2}$：\n方程组为 $(A - \\lambda_1 I)v_1 = 0$，其中 $v_1 = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$。\n$$\n\\left(\\begin{pmatrix} 4   1 \\\\ 1   2 \\end{pmatrix} - (3 + \\sqrt{2})\\begin{pmatrix} 1   0 \\\\ 0   1 \\end{pmatrix}\\right) \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} 1 - \\sqrt{2}   1 \\\\ 1   -1 - \\sqrt{2} \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n从第一行，我们得到方程 $(1 - \\sqrt{2})x + y = 0$，这意味着 $y = (\\sqrt{2} - 1)x$。选择 $x=1$ 得到一个非零特征向量 $v'_1 = \\begin{pmatrix} 1 \\\\ \\sqrt{2} - 1 \\end{pmatrix}$。\n为了归一化该向量，我们计算其2-范数：\n$$\n\\|v'_1\\|_2 = \\sqrt{1^2 + (\\sqrt{2} - 1)^2} = \\sqrt{1 + (2 - 2\\sqrt{2} + 1)} = \\sqrt{4 - 2\\sqrt{2}}\n$$\n归一化后的特征向量 $v_1$ 是：\n$$\nv_1 = \\frac{1}{\\|v'_1\\|_2} v'_1 = \\frac{1}{\\sqrt{4 - 2\\sqrt{2}}} \\begin{pmatrix} 1 \\\\ \\sqrt{2} - 1 \\end{pmatrix}\n$$\n\n对于 $\\lambda_2 = 3 - \\sqrt{2}$：\n方程组为 $(A - \\lambda_2 I)v_2 = 0$。\n$$\n\\left(\\begin{pmatrix} 4   1 \\\\ 1   2 \\end{pmatrix} - (3 - \\sqrt{2})\\begin{pmatrix} 1   0 \\\\ 0   1 \\end{pmatrix}\\right) \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} 1 + \\sqrt{2}   1 \\\\ 1   -1 + \\sqrt{2} \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n从第一行，我们得到 $(1 + \\sqrt{2})x + y = 0$，这意味着 $y = -(1 + \\sqrt{2})x$。选择 $x=1$ 得到一个非零特征向量 $v'_2 = \\begin{pmatrix} 1 \\\\ -(1 + \\sqrt{2}) \\end{pmatrix}$。\n为了归一化该向量，我们计算其2-范数：\n$$\n\\|v'_2\\|_2 = \\sqrt{1^2 + (-(1 + \\sqrt{2}))^2} = \\sqrt{1 + (1 + 2\\sqrt{2} + 2)} = \\sqrt{4 + 2\\sqrt{2}}\n$$\n归一化后的特征向量 $v_2$ 是：\n$$\nv_2 = \\frac{1}{\\|v'_2\\|_2} v'_2 = \\frac{1}{\\sqrt{4 + 2\\sqrt{2}}} \\begin{pmatrix} 1 \\\\ -(1 + \\sqrt{2}) \\end{pmatrix}\n$$\n\n### 第三部分：正交性验证与解释\n\n为了验证特征向量是正交的，我们计算它们的欧几里得内积（点积），$\\langle v_1, v_2 \\rangle = v_1^T v_2$。使用未归一化的特征向量 $v'_1$ 和 $v'_2$ 更简单，因为正交性与缩放无关。\n$$\n\\langle v'_1, v'_2 \\rangle = (1)(1) + (\\sqrt{2} - 1)(-(1 + \\sqrt{2})) = 1 - (\\sqrt{2} - 1)(\\sqrt{2} + 1)\n$$\n使用平方差公式 $(a-b)(a+b) = a^2 - b^2$：\n$$\n\\langle v'_1, v'_2 \\rangle = 1 - ((\\sqrt{2})^2 - 1^2) = 1 - (2 - 1) = 1 - 1 = 0\n$$\n由于内积为 $0$，特征向量是正交的。\n\n对于具有不同特征值的厄米特矩阵，这是一个普遍性质。设 $A$ 是一个厄米特矩阵（$A=A^H$）。设 $(\\lambda_1, v_1)$ 和 $(\\lambda_2, v_2)$ 是两个特征对，其中 $\\lambda_1 \\neq \\lambda_2$。\n从 $Av_1 = \\lambda_1 v_1$，我们与 $v_2$ 计算内积：$\\langle Av_1, v_2 \\rangle = \\langle \\lambda_1 v_1, v_2 \\rangle = \\lambda_1 \\langle v_1, v_2 \\rangle$。\n使用内积的伴随性质，$\\langle Av_1, v_2 \\rangle = v_2^H A v_1$。由于 $A$ 是厄米特矩阵，$A=A^H$，所以 $v_2^H A v_1 = (A^H v_2)^H v_1 = (A v_2)^H v_1$。\n从 $Av_2 = \\lambda_2 v_2$，我们有 $(A v_2)^H v_1 = (\\lambda_2 v_2)^H v_1 = \\overline{\\lambda_2} v_2^H v_1 = \\overline{\\lambda_2} \\langle v_1, v_2 \\rangle$。\n厄米特矩阵的特征值总是实数，所以 $\\overline{\\lambda_2} = \\lambda_2$。\n令 $\\langle Av_1, v_2 \\rangle$ 的两个表达式相等：\n$$\n\\lambda_1 \\langle v_1, v_2 \\rangle = \\lambda_2 \\langle v_1, v_2 \\rangle\n$$\n$$\n(\\lambda_1 - \\lambda_2) \\langle v_1, v_2 \\rangle = 0\n$$\n由于特征值是不同的，$\\lambda_1 - \\lambda_2 \\neq 0$。因此，我们必须有 $\\langle v_1, v_2 \\rangle = 0$，这证明了特征向量是正交的。我们的特征值 $\\lambda_1 = 3 + \\sqrt{2}$ 和 $\\lambda_2 = 3 - \\sqrt{2}$ 是不同的，这证实了该理论。\n\n### 第四部分：光谱条件数\n\n光谱条件数定义为 $\\kappa_2(A) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}}$，其中 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 分别是 $A$ 的最大和最小奇异值。$A$ 的奇异值是矩阵 $A^H A$ 的特征值的平方根。\n由于 $A$ 是厄米特矩阵（$A^H = A$），我们关心的是 $A^2$ 的特征值。如果 $\\lambda_i$ 是 $A$ 的特征值，那么 $\\lambda_i^2$ 就是 $A^2$ 的特征值。因此，奇异值为 $\\sigma_i = \\sqrt{\\lambda_i^2} = |\\lambda_i|$。\n在我们的例子中，$A$ 的特征值是 $\\lambda_1 = 3 + \\sqrt{2}$ 和 $\\lambda_2 = 3 - \\sqrt{2}$。两者都为正，因为 $3 = \\sqrt{9}$ 且 $\\sqrt{2}  \\sqrt{9}$。\n因此，$A$ 的奇异值等于其特征值：\n$$\n\\sigma_{\\max} = \\sigma_1 = |\\lambda_1| = \\lambda_1 = 3 + \\sqrt{2}\n$$\n$$\n\\sigma_{\\min} = \\sigma_2 = |\\lambda_2| = \\lambda_2 = 3 - \\sqrt{2}\n$$\n光谱条件数是这些值的比率：\n$$\n\\kappa_2(A) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{3 + \\sqrt{2}}{3 - \\sqrt{2}}\n$$\n为了将其表示为简化的解析形式，我们对分母进行有理化：\n$$\n\\kappa_2(A) = \\frac{3 + \\sqrt{2}}{3 - \\sqrt{2}} \\times \\frac{3 + \\sqrt{2}}{3 + \\sqrt{2}} = \\frac{(3 + \\sqrt{2})^2}{3^2 - (\\sqrt{2})^2} = \\frac{3^2 + 2(3)(\\sqrt{2}) + (\\sqrt{2})^2}{9 - 2}\n$$\n$$\n\\kappa_2(A) = \\frac{9 + 6\\sqrt{2} + 2}{7} = \\frac{11 + 6\\sqrt{2}}{7}\n$$\n这就是 $A$ 的光谱条件数的最终精确表达式。",
            "answer": "$$\n\\boxed{\\frac{11 + 6\\sqrt{2}}{7}}\n$$"
        },
        {
            "introduction": "在许多应用中，我们并不需要精确计算出所有特征值，而只需估计它们所在的范围。Gershgorin 圆盘定理为此提供了一个极为简洁而强大的工具，它能够在复平面上划定出包含所有特征值的区域。本练习将带您应用该定理，仅通过观察矩阵的元素，来确定其谱的边界。掌握这种定位技术对于分析矩阵性质和选择合适的数值算法至关重要。",
            "id": "3597642",
            "problem": "设 $A \\in \\mathbb{C}^{3 \\times 3}$ 为给定矩阵\n$$\nA=\\begin{pmatrix}\n5  -2  0\\\\\n1  4  1\\\\\n0  -1  3\n\\end{pmatrix}.\n$$\n仅从标准特征值问题 $A x = \\lambda x$（其中 $x \\neq 0$）的定义出发，并使用基本不等式，计算与 $A$ 相关的盖尔圆盘（Gershgorin discs）。然后，通过对这些圆盘的严格推理，推导出一个明确的标量界 $B \\in \\mathbb{R}$，使得 $A$ 的每个特征值 $\\lambda$ 都满足 $|\\lambda| \\leq B$。在所有可直接从基于行的 $A$ 的盖尔圆盘推导出的此类界中，确定最小的可能值 $B$。\n\n你最终报告的答案必须是这个单一的实数 $B$。无需四舍五入。",
            "solution": "该问题要求计算给定矩阵 $A$ 的基于行的盖尔圆盘，并随后确定其特征值模长的最小可能上界 $B$，该上界直接从这些圆盘推导得出。\n\n设 $A \\in \\mathbb{C}^{n \\times n}$ 是一个方阵。标准特征值问题由方程 $A x = \\lambda x$ 定义，其中 $\\lambda \\in \\mathbb{C}$ 是一个特征值，$x \\in \\mathbb{C}^{n}$ 是对应的非零特征向量，$x \\neq 0$。\n\n设 $(\\lambda, x)$ 是 $A$ 的一个特征对。矩阵向量方程 $A x = \\lambda x$ 对每一行 $i \\in \\{1, 2, \\dots, n\\}$ 可以分量形式写为：\n$$\n\\sum_{j=1}^{n} a_{ij} x_j = \\lambda x_i\n$$\n我们可以分离出包含对角元素 $a_{ii}$ 的项：\n$$\na_{ii} x_i + \\sum_{j \\neq i} a_{ij} x_j = \\lambda x_i\n$$\n整理各项可得：\n$$\n(\\lambda - a_{ii}) x_i = \\sum_{j \\neq i} a_{ij} x_j\n$$\n由于特征向量 $x$ 非零，它必须至少有一个非零分量。设 $k$ 是一个索引，使得分量 $x_k$ 具有最大绝对值，即 $|x_k| = \\max_{j} |x_j| = \\|x\\|_{\\infty}$。由于 $x \\neq 0$，我们必有 $|x_k|  0$。\n\n我们写出第 $k$ 行的方程：\n$$\n(\\lambda - a_{kk}) x_k = \\sum_{j \\neq k} a_{kj} x_j\n$$\n取两边的绝对值：\n$$\n|(\\lambda - a_{kk}) x_k| = \\left| \\sum_{j \\neq k} a_{kj} x_j \\right|\n$$\n$$\n|\\lambda - a_{kk}| |x_k| = \\left| \\sum_{j \\neq k} a_{kj} x_j \\right|\n$$\n对右侧应用三角不等式，我们得到：\n$$\n|\\lambda - a_{kk}| |x_k| \\leq \\sum_{j \\neq k} |a_{kj} x_j| = \\sum_{j \\neq k} |a_{kj}| |x_j|\n$$\n根据我们对 $k$ 的选择，对所有 $j$ 都有 $|x_j| \\leq |x_k|$。因此：\n$$\n\\sum_{j \\neq k} |a_{kj}| |x_j| \\leq \\sum_{j \\neq k} |a_{kj}| |x_k| = |x_k| \\left( \\sum_{j \\neq k} |a_{kj}| \\right)\n$$\n结合这些不等式：\n$$\n|\\lambda - a_{kk}| |x_k| \\leq |x_k| \\left( \\sum_{j \\neq k} |a_{kj}| \\right)\n$$\n由于 $|x_k|  0$，我们可以两边同除以 $|x_k|$ 得到：\n$$\n|\\lambda - a_{kk}| \\leq \\sum_{j \\neq k} |a_{kj}|\n$$\n这个不等式表明，对于任意给定的特征值 $\\lambda$，至少存在一个行索引 $k$，使得 $\\lambda$ 包含在复平面上的一个特定圆盘内。这引出了盖尔圆盘定理（Gershgorin Circle Theorem），该定理指出 $A$ 的所有特征值都位于盖尔圆盘 $D_i$（其中 $i=1, 2, \\dots, n$）的并集之内。每个圆盘 $D_i$ 定义为：\n$$\nD_i = \\left\\{ z \\in \\mathbb{C} : |z - a_{ii}| \\leq R_i \\right\\}, \\quad \\text{其中 } R_i = \\sum_{j \\neq i} |a_{ij}|\n$$\n圆盘 $D_i$ 的圆心是对角元素 $a_{ii}$，其半径 $R_i$ 是第 $i$ 行中非对角元素绝对值之和。\n\n给定的矩阵是：\n$$\nA=\\begin{pmatrix}\n5  -2  0\\\\\n1  4  1\\\\\n0  -1  3\n\\end{pmatrix}\n$$\n我们计算每一行的盖尔圆盘：\n\n对于第一行 ($i=1$)：\n圆心：$a_{11} = 5$\n半径：$R_1 = |a_{12}| + |a_{13}| = |-2| + |0| = 2 + 0 = 2$\n圆盘：$D_1 = \\{ z \\in \\mathbb{C} : |z - 5| \\leq 2 \\}$\n\n对于第二行 ($i=2$)：\n圆心：$a_{22} = 4$\n半径：$R_2 = |a_{21}| + |a_{23}| = |1| + |1| = 1 + 1 = 2$\n圆盘：$D_2 = \\{ z \\in \\mathbb{C} : |z - 4| \\leq 2 \\}$\n\n对于第三行 ($i=3$)：\n圆心：$a_{33} = 3$\n半径：$R_3 = |a_{31}| + |a_{32}| = |0| + |-1| = 0 + 1 = 1$\n圆盘：$D_3 = \\{ z \\in \\mathbb{C} : |z - 3| \\leq 1 \\}$\n\n$A$ 的所有特征值的集合，记为 $\\sigma(A)$，包含在这三个圆盘的并集中：$\\sigma(A) \\subseteq D_1 \\cup D_2 \\cup D_3$。\n\n我们需要找到一个标量界 $B$，使得对于 $A$ 的每一个特征值 $\\lambda$，都有 $|\\lambda| \\leq B$。这个界必须从计算出的圆盘推导出来。由于任何特征值 $\\lambda$ 都必须位于并集 $G = D_1 \\cup D_2 \\cup D_3$ 中，其模长 $|\\lambda|$ 必须小于或等于集合 $G$ 中任意点的最大可能模长。因此，从此信息可以保证的最小可能界 $B$ 是集合 $G$ 上的最大模长：\n$$\nB = \\sup_{z \\in G} |z| = \\max_{z \\in G} |z|\n$$\n（上确界是一个最大值，因为 $G$ 是一个闭合有界集）。圆盘并集上的最大模长是每个单独圆盘上的最大模长的最大值：\n$$\nB = \\max\\left( \\max_{z \\in D_1} |z|, \\max_{z \\in D_2} |z|, \\max_{z \\in D_3} |z| \\right)\n$$\n对于任何圆心为 $c_i = a_{ii}$、半径为 $R_i$ 的圆盘 $D_i$，点 $z \\in D_i$ 的最大模长可以通过三角不等式找到：\n$$\n|z| = |z - c_i + c_i| \\leq |z - c_i| + |c_i|\n$$\n由于对任何 $z \\in D_i$ 都有 $|z-c_i| \\leq R_i$，我们有：\n$$\n|z| \\leq R_i + |c_i|\n$$\n这个最大值在圆 $|z-c_i|=R_i$ 上、且位于穿过原点和圆心 $c_i$ 的直线上的点处取得。所以，$\\max_{z \\in D_i} |z| = |a_{ii}| + \\sum_{j \\neq i} |a_{ij}|$。\n\n我们为每个圆盘计算这个值：\n对于 $D_1$：$\\max_{z \\in D_1} |z| = |a_{11}| + R_1 = |5| + 2 = 7$\n对于 $D_2$：$\\max_{z \\in D_2} |z| = |a_{22}| + R_2 = |4| + 2 = 6$\n对于 $D_3$：$\\max_{z \\in D_3} |z| = |a_{33}| + R_3 = |3| + 1 = 4$\n\n基于行的盖尔圆盘，$A$ 的任何特征值模长的最小上界 $B$ 是这些值的最大值：\n$$\nB = \\max(7, 6, 4) = 7\n$$\n这个界等价于矩阵 $A$ 的无穷范数，$\\|A\\|_{\\infty} = \\max_i \\sum_j |a_{ij}|$。\n对于任何特征值 $\\lambda$，我们有 $|\\lambda| \\leq 7$。数字 $7$ 是仅能从基于行的盖尔圆盘提供的信息中确定的最小此类界，因为它代表了这些圆盘并集内任何点的最大可能模长，而该并集是保证包含所有特征值的区域。",
            "answer": "$$\n\\boxed{7}\n$$"
        },
        {
            "introduction": "理论分析之后，我们转向特征值问题的核心——计算。瑞利商迭代 (Rayleigh Quotient Iteration, RQI) 是一种用于求解对称矩阵特征对的强大算法，以其惊人的局部三次收敛速度而著称。本练习要求您亲手实现这一算法，并通过一系列精心设计的测试案例，观察其在不同情况下的实际表现，例如处理重特征值或密集特征值簇。这项实践将理论与数值计算紧密结合，是理解现代特征值算法性能的关键一步。",
            "id": "3597597",
            "problem": "实现一个完整的程序，对给定测试集中的每个矩阵，从初始向量 $x_0 = (1,1,1)^{\\top}$ 开始，执行恰好三步瑞利商迭代（RQI），以近似给定实对称矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 的最大特征值。三次迭代后，报告近似特征值和残差向量的欧几里得范数。\n\n使用以下基本原理：\n- 标准特征值问题寻求 $(\\lambda, x)$，其中 $x \\neq 0$，使得对于给定的实对称矩阵 $A$，有 $A x = \\lambda x$。\n- 非零向量 $x$ 相对于 $A$ 的瑞利商定义为\n$$\n\\rho_A(x) = \\frac{x^{\\top} A x}{x^{\\top} x}.\n$$\n- 对于对称矩阵 $A$，单位球面上 $\\rho_A(x)$ 的驻点是特征值方程 $A x = \\lambda x$ 的解，其中 $\\lambda = \\rho_A(x)$。\n\n你的程序必须：\n1. 对于每个测试矩阵 $A$，设置 $x_0 = (1,1,1)^{\\top}$ 并运行恰好 3 步瑞利商迭代。在每次迭代中，必须将迭代向量归一化为单位欧几里得范数。\n2. 完成 3 次迭代后，计算最终归一化向量 $x$ 的瑞利商 $\\rho_A(x)$ 作为近似特征值 $\\widehat{\\lambda}$，并计算残差向量 $r = A x - \\widehat{\\lambda} x$。\n3. 报告由 $\\widehat{\\lambda}$ 和 $\\|r\\|_2$ 组成的数对，其中 $\\|\\cdot\\|_2$ 表示欧几里得范数。\n\n测试集：\n- 情况 1（不同且分离良好的特征值）：\n$$\nA_1 = \\begin{bmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{bmatrix}.\n$$\n- 情况 2（最大特征值的重数为 2）：\n$$\nA_2 = \\begin{bmatrix}\n2  0  0 \\\\\n0  2  0 \\\\\n0  0  1\n\\end{bmatrix}.\n$$\n- 情况 3（主子块中有两个接近的主导特征值）：\n$$\nA_3 = \\begin{bmatrix}\n10  9  0 \\\\\n9  10  0 \\\\\n0  0  0.1\n\\end{bmatrix}.\n$$\n- 情况 4（尺度差异和一个小特征值）：\n$$\nA_4 = \\begin{bmatrix}\n10^{-6}  0  0 \\\\\n0  5  2 \\\\\n0  2  5\n\\end{bmatrix}.\n$$\n\n数值要求和定义：\n- 将 $x_0$ 视为实向量，并在每次求解后进行归一化，使得每次迭代中 $\\|x\\|_2 = 1$。\n- 对所有向量范数使用欧几里得范数 $\\|\\cdot\\|_2$。\n- 对于每种情况，在恰好 3 次迭代后，计算并报告：\n  - 最终向量 $x$ 的近似最大特征值估计 $\\widehat{\\lambda} = \\rho_A(x)$。\n  - 残差范数 $\\|A x - \\widehat{\\lambda} x\\|_2$。\n- 不涉及物理单位或角度单位。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，无空格。\n- 每种情况的结果必须是一个双元素列表 $[\\widehat{\\lambda}, \\|r\\|_2]$。\n- 将四种情况的结果按 $A_1, A_2, A_3, A_4$ 的顺序汇总为一个列表，生成类似\n$[\\![\\widehat{\\lambda}_1,\\|r_1\\|_2],[\\widehat{\\lambda}_2,\\|r_2\\|_2],[\\widehat{\\lambda}_3,\\|r_3\\|_2],[\\widehat{\\lambda}_4,\\|r_4\\|_2]\\!]$ 的单行\n其中每个浮点数四舍五入到恰好 10 位小数，并且打印时不带空格。",
            "solution": "我们从实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 的标准特征值问题开始：找到 $(\\lambda, x)$，其中 $x \\neq 0$，使得 $A x = \\lambda x$。对于任意非零向量 $x \\in \\mathbb{R}^n$，瑞利商定义为\n$$\n\\rho_A(x) = \\frac{x^{\\top} A x}{x^{\\top} x}.\n$$\n一个基本事实是，对于对称矩阵 $A$，约束在单位球面 $\\{x \\in \\mathbb{R}^n : x^{\\top} x = 1\\}$ 上的 $\\rho_A(x)$ 的驻点恰好对应于 $A$ 的特征向量，并且这些驻点处的瑞利商等于相应的特征值。具体来说，如果 $x$ 是一个驻点，那么为约束条件引入拉格朗日乘子 $\\lambda$ 会得到驻点条件\n$$\n\\nabla_x \\left(x^{\\top} A x - \\lambda (x^{\\top} x - 1)\\right) = 0\n\\quad \\Longrightarrow \\quad\n2 A x - 2 \\lambda x = 0 \\quad \\Longrightarrow \\quad (A - \\lambda I) x = 0,\n$$\n因此 $x$ 是一个特征向量且 $\\lambda = \\rho_A(x)$。\n\n瑞利商迭代（RQI）可以通过对非线性系统应用牛顿法导出\n$$\nF(x, \\lambda) = \\begin{bmatrix} (A - \\lambda I) x \\\\ \\tfrac{1}{2}(x^{\\top} x - 1) \\end{bmatrix} = 0,\n$$\n其中第二个分量强制执行单位范数约束。通过瑞利商 $\\lambda = \\rho_A(x)$ 消去拉格朗日乘子变量，可以得到一个实用的迭代方法：给定一个迭代向量 $x_k$（已归一化为 $\\|x_k\\|_2 = 1$），我们构造瑞利商\n$$\n\\mu_k = \\rho_A(x_k) = \\frac{x_k^{\\top} A x_k}{x_k^{\\top} x_k},\n$$\n然后在切线方向上对方程 $(A - \\mu_k I) x = 0$ 进行牛顿步，即求解\n$$\n(A - \\mu_k I) y_k = x_k,\n$$\n最后重新归一化 $x_{k+1} = \\frac{y_k}{\\|y_k\\|_2}$。更新后，可以重新计算 $\\mu_{k+1} = \\rho_A(x_{k+1})$。对于实对称矩阵 $A$，如果 $x_0$ 足够接近某个特征向量，RQI 对相应的特征对享有局部三阶收敛；此外，每一步的瑞利商都是一个更精确的特征值估计。\n\n在此任务中，我们被要求：\n- 从 $x_0 = (1,1,1)^{\\top}$ 开始。\n- 对每个测试矩阵 $A$ 执行恰好 3 次上述 RQI 方案的迭代。\n- 完成 3 次迭代后，计算最终归一化迭代向量 $x$ 处的近似特征值 $\\widehat{\\lambda} = \\rho_A(x)$，并计算残差向量 $r = A x - \\widehat{\\lambda} x$ 及其残差范数 $\\|r\\|_2$。\n\n针对一个矩阵 $A$ 的算法步骤：\n1. 初始化 $x \\leftarrow x_0 = (1,1,1)^{\\top}$ 并归一化 $x \\leftarrow \\frac{x}{\\|x\\|_2}$。\n2. 对于 $k = 1,2,3$：\n   - 计算瑞利商 $\\mu = \\frac{x^{\\top} A x}{x^{\\top} x}$。\n   - 求解移位的线性系统 $(A - \\mu I) y = x$ 得到 $y$。由于 $A$ 是对称的，并且在给定情况下，$\\mu$ 在有限精度下不应与特征值完全重合，因此该系统通常是非奇异的。如果它接近奇异，数值线性代数求解器仍将产生与浮点算术模型一致的解向量。\n   - 归一化更新 $x \\leftarrow \\frac{y}{\\|y\\|_2}$。\n3. 循环结束后，设置 $\\widehat{\\lambda} \\leftarrow \\frac{x^{\\top} A x}{x^{\\top} x}$ 并计算 $r \\leftarrow A x - \\widehat{\\lambda} x$。\n4. 报告 $\\widehat{\\lambda}$ 和 $\\|r\\|_2$。\n\n测试集理由与覆盖范围：\n- 情况 1 使用\n$$\nA_1 = \\begin{bmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{bmatrix},\n$$\n一个对称正定矩阵，其特征值不同且分离良好。这是一个标准的“理想路径”情况，RQI 应该会快速优化与 $x_0$ 的主导特征向量分量相对应的特征值。\n- 情况 2 使用\n$$\nA_2 = \\begin{bmatrix}\n2  0  0 \\\\\n0  2  0 \\\\\n0  0  1\n\\end{bmatrix},\n$$\n其最大特征值的重数为 2。这用于探究当顶层特征空间不是一维时的行为；RQI 仍然可以收敛到与最大特征值对应的不变子空间，并且瑞利商仍然是有效的特征值估计。\n- 情况 3 使用\n$$\nA_3 = \\begin{bmatrix}\n10  9  0 \\\\\n9  10  0 \\\\\n0  0  0.1\n\\end{bmatrix},\n$$\n其中前导 $2 \\times 2$ 块有两个接近的特征值，在谱的顶端产生了一个小的谱隙。这测试了 RQI 在面对具有挑战性的簇时的灵敏度和优化能力。\n- 情况 4 使用\n$$\nA_4 = \\begin{bmatrix}\n10^{-6}  0  0 \\\\\n0  5  2 \\\\\n0  2  5\n\\end{bmatrix},\n$$\n其尺度差异很大并包含一个非常小的特征值，用于探究移位求逆步骤的数值稳定性和条件数。\n\n数值输出：\n- 对于每种情况，在 3 次迭代后，按所述计算 $\\widehat{\\lambda}$ 和 $\\|r\\|_2$。\n- 取整和格式化：程序必须将每个浮点结果四舍五入到恰好 10 位小数，并输出形如\n$$\n[\\,[\\widehat{\\lambda}_1,\\|r_1\\|_2],[\\widehat{\\lambda}_2,\\|r_2\\|_2],[\\widehat{\\lambda}_3,\\|r_3\\|_2],[\\widehat{\\lambda}_4,\\|r_4\\|_2]\\,],\n$$\n的单行，不带空格。\n\n该算法基于瑞利商和特征值方程的核心定义，并通过瑞利商迭代固有的移位求逆牛顿步骤实现。残差范数 $\\|A x - \\widehat{\\lambda} x\\|_2$ 在指定迭代次数后量化了计算出的特征对的质量。",
            "answer": "```python\nimport numpy as np\n\ndef rayleigh_quotient(A, x):\n    return float(x.T @ A @ x) / float(x.T @ x)\n\ndef rqi_three_steps(A, x0):\n    # Normalize initial vector\n    x = x0.astype(float).copy()\n    x /= np.linalg.norm(x, 2)\n    # Perform exactly 3 iterations\n    for _ in range(3):\n        mu = rayleigh_quotient(A, x)\n        # Solve (A - mu I) y = x\n        M = A - mu * np.eye(A.shape[0])\n        try:\n            y = np.linalg.solve(M, x)\n        except np.linalg.LinAlgError:\n            # In the unlikely event of near singularity, use least squares fallback\n            y, *_ = np.linalg.lstsq(M, x, rcond=None)\n        # Normalize\n        x = y / np.linalg.norm(y, 2)\n    # Final Rayleigh quotient and residual\n    lam = rayleigh_quotient(A, x)\n    r = A @ x - lam * x\n    resid = np.linalg.norm(r, 2)\n    return lam, resid\n\ndef format_results(results, decimals=10):\n    # Format as a single list with inner lists, no spaces, fixed decimals\n    formatted_pairs = []\n    for lam, resid in results:\n        lam_str = f\"{lam:.{decimals}f}\"\n        resid_str = f\"{resid:.{decimals}f}\"\n        formatted_pairs.append(f\"[{lam_str},{resid_str}]\")\n    return \"[\" + \",\".join(formatted_pairs) + \"]\"\n\ndef solve():\n    # Define the test matrices\n    A1 = np.array([[4.0, 1.0, 0.0],\n                   [1.0, 3.0, 1.0],\n                   [0.0, 1.0, 2.0]])\n    A2 = np.array([[2.0, 0.0, 0.0],\n                   [0.0, 2.0, 0.0],\n                   [0.0, 0.0, 1.0]])\n    A3 = np.array([[10.0, 9.0, 0.0],\n                   [9.0, 10.0, 0.0],\n                   [0.0, 0.0, 0.1]])\n    A4 = np.array([[1e-6, 0.0, 0.0],\n                   [0.0, 5.0, 2.0],\n                   [0.0, 2.0, 5.0]])\n\n    test_matrices = [A1, A2, A3, A4]\n    x0 = np.array([1.0, 1.0, 1.0])\n\n    results = []\n    for A in test_matrices:\n        lam, resid = rqi_three_steps(A, x0)\n        results.append((lam, resid))\n\n    print(format_results(results, decimals=10))\n\nsolve()\n```"
        }
    ]
}