## 引言
在求解[矩阵特征值](@entry_id:156365)这一[数值线性代数](@entry_id:144418)的核心问题中，[QR算法](@entry_id:145597)占据着举足轻重的地位。然而，基础的[QR算法](@entry_id:145597)对于许多矩阵而言[收敛速度](@entry_id:636873)不尽人意，这催生了对高效加速策略的迫切需求。本文正是为了填补这一知识空白，将[焦点](@entry_id:174388)对准了其中最强大、最精妙的加速技术之一——[威尔金森位移](@entry_id:634015)（Wilkinson shift）。通过掌握这一概念，读者不仅能理解[对称特征值问题](@entry_id:755714)求解的现代方法，更能洞察[数值算法](@entry_id:752770)设计中蕴含的深刻思想。

本文将通过三个章节，系统地剖析[威尔金森位移](@entry_id:634015)。在“原理与机制”一章中，我们将深入其定义，揭示它为何能实现惊人的三次方收敛，并探讨其高效且稳定的隐式实现方法。接着，在“应用与跨学科联系”中，我们将视野拓宽，探索[威尔金森位移](@entry_id:634015)的思想如何被推广至非对称问题和奇异值分解，并与物理、控制论等领域产生有趣的联系。最后，“动手实践”部分将提供具体的计算问题，帮助读者将理论知识转化为实践技能。让我们首先进入第一章，从根本上理解[威尔金森位移](@entry_id:634015)的原理与机制。

## 原理与机制

在之前的章节中，我们介绍了用于计算[矩阵特征值](@entry_id:156365)的[QR算法](@entry_id:145597)。对于一般的矩阵，无位移的[QR算法](@entry_id:145597)收敛速度可能很慢，其收敛因子取决于[特征值](@entry_id:154894)[绝对值](@entry_id:147688)的比率。为了加速这一过程，特别是在求解[对称三对角矩阵](@entry_id:755732)的[特征值问题](@entry_id:142153)时，引入“位移(shift)”策略至关重要。本章将深入探讨这一领域中最重要和最有效的策略之一——**[Wilkinson位移](@entry_id:634015)**，阐明其定义、理论基础、实现机制以及在数值计算中的精妙之处。

### 加速收敛：位移[QR算法](@entry_id:145597)

[对称三对角矩阵](@entry_id:755732)的[QR算法](@entry_id:145597)旨在通过一系列正交[相似变换](@entry_id:152935)，迭代地将[矩阵化](@entry_id:751739)为[对角形式](@entry_id:264850)，从而揭示其[特征值](@entry_id:154894)。其核心目标是使某个次对角[线元](@entry_id:196833)素，通常是最后一个 $b_{n-1}$（即 $T_{n, n-1}$），收敛到零。一旦 $b_{n-1}$ 在数值上可忽略不计，矩阵的右下角元素 $a_n$（即 $T_{n, n}$）就近似于一个[特征值](@entry_id:154894)，整个问题可以**缩减（deflate）**为一个更小的 $(n-1) \times (n-1)$ 阶问题。

标准（无位移）的[QR算法](@entry_id:145597)收敛速度为线性，当[特征值](@entry_id:154894)大小接近时尤其缓慢。**[带位移的QR算法](@entry_id:149245)**通过在每一步从矩阵中减去一个标量 $\mu_k$ 来改变算法的动态特性，从而显著加速收敛。一个带位移的QR步骤包括：

1.  选择一个位移量 $\mu_k$。
2.  对位移后的矩阵进行[QR分解](@entry_id:139154)：$T_k - \mu_k I = Q_k R_k$。
3.  通过逆序相乘并加回位移来更新矩阵：$T_{k+1} = R_k Q_k + \mu_k I$。

由于 $R_k = Q_k^T (T_k - \mu_k I)$，我们得到 $T_{k+1} = Q_k^T (T_k - \mu_k I) Q_k + \mu_k I = Q_k^T T_k Q_k - \mu_k Q_k^T I Q_k + \mu_k I = Q_k^T T_k Q_k$。这表明 $T_{k+1}$ 与 $T_k$ 是正交相似的，因此它们的[特征值](@entry_id:154894)完全相同。然而，位移 $\mu_k$ 的选择深刻影响着迭代序列 $\{T_k\}$ 的收敛行为。一个好的位移策略应该能够使得 $|b_{n-1}|$ 超线性地趋近于零。

### [Wilkinson位移](@entry_id:634015)的定义

选择一个好的位移 $\mu_k$ 是算法效率的关键。一个简单而有效的策略是**瑞利商位移（Rayleigh quotient shift）**，它选择矩阵右下角的对角元素作为位移，即 $\mu_k = a_{n}^{(k)}$。这个值等于单位向量 $e_n$ 对 $T_k$ 的[瑞利商](@entry_id:137794)，即 $\rho(e_n) = \frac{e_n^T T_k e_n}{e_n^T e_n} = a_{n}^{(k)}$。当 $b_{n-1}$ 很小时，$e_n$ 是对应于某个[特征值](@entry_id:154894)的近似[特征向量](@entry_id:151813)，因此 $a_{n}^{(k)}$ 是该[特征值](@entry_id:154894)的一个良好近似。瑞利商位移通常能实现二次收敛 。

然而，存在一种更为强大和可靠的策略——**[Wilkinson位移](@entry_id:634015)**。该策略的构想是利用矩阵最可能“分离”的部分，即右下角的 $2 \times 2$ 子矩阵，来构造一个更精确的[特征值](@entry_id:154894)近似。

**定义**：对于一个实[对称三对角矩阵](@entry_id:755732) $T$，其 **[Wilkinson位移](@entry_id:634015)** $\mu$ 是 $T$ 的尾部 $2 \times 2$ [主子矩阵](@entry_id:201119)
$$
S = \begin{pmatrix} a_{n-1}  b_{n-1} \\ b_{n-1}  a_n \end{pmatrix}
$$
的两个[特征值](@entry_id:154894)中，与右下角元素 $a_n$ **更接近**的那个。 

这个定义的目的是利用一个局部谱信息（$S$ 的[特征值](@entry_id:154894)）来更好地近似全局谱信息（$T$ 的[特征值](@entry_id:154894)），从而引导迭代过程，使得最后一个次对角线元素 $b_{n-1}$ 迅速衰减至零，实现稳定的缩减。

**示例：计算[Wilkinson位移](@entry_id:634015)**

考虑以下 $2 \times 2$ 尾部子矩阵 ：
$$
M = \begin{pmatrix} 10  2 \\ 2  1 \end{pmatrix}
$$
这里，$a_{n-1}=10$, $b_{n-1}=2$, $a_n=1$。为了找到[Wilkinson位移](@entry_id:634015)，我们首先计算 $M$ 的[特征值](@entry_id:154894)。其特征方程为 $\det(M-\lambda I) = 0$，即 $(\lambda-10)(\lambda-1) - 2^2 = 0$，展开为 $\lambda^2 - 11\lambda + 6 = 0$。

使用二次公式，我们得到[特征值](@entry_id:154894)为：
$$
\lambda = \frac{11 \pm \sqrt{11^2 - 4(6)}}{2} = \frac{11 \pm \sqrt{121 - 24}}{2} = \frac{11 \pm \sqrt{97}}{2}
$$
两个[特征值](@entry_id:154894)是 $\lambda_+ = \frac{11 + \sqrt{97}}{2} \approx 10.424$ 和 $\lambda_- = \frac{11 - \sqrt{97}}{2} \approx 0.576$。

接下来，我们判断哪个[特征值](@entry_id:154894)更接近 $a_n=1$。
$$
|\lambda_+ - 1| = \left| \frac{11 + \sqrt{97}}{2} - 1 \right| = \frac{9 + \sqrt{97}}{2} \approx 9.424
$$
$$
|\lambda_- - 1| = \left| \frac{11 - \sqrt{97}}{2} - 1 \right| = \left| \frac{9 - \sqrt{97}}{2} \right| \approx |-0.424| = 0.424
$$
显然，$\lambda_-$ 更接近 $1$。因此，对于这个子矩阵，[Wilkinson位移](@entry_id:634015)为 $\mu = \frac{11 - \sqrt{97}}{2}$。

### 作用机制：为何[Wilkinson位移](@entry_id:634015)如此高效？

[Wilkinson位移](@entry_id:634015)的卓越性能源于其与**[反幂法](@entry_id:148185)（inverse iteration）**的深刻联系以及它对真实[特征值](@entry_id:154894)的极高逼近精度。

#### 与[反幂法](@entry_id:148185)的隐式联系

[带位移的QR算法](@entry_id:149245)在本质上是隐式地执行了一步[带位移的反幂法](@entry_id:637585)。回顾[反幂法](@entry_id:148185)的思想：对于矩阵 $A$ 和一个接近其某个[特征值](@entry_id:154894) $\lambda_j$ 的位移 $\mu$，矩阵 $(A-\mu I)^{-1}$ 的[特征值](@entry_id:154894)为 $(\lambda_i - \mu)^{-1}$。其中，[绝对值](@entry_id:147688)最大的[特征值](@entry_id:154894)是 $(\lambda_j - \mu)^{-1}$。因此，对 $(A-\mu I)^{-1}$ 应用[幂法](@entry_id:148021)会极快地收敛到对应的[特征向量](@entry_id:151813)，即 $A$ 的对应于 $\lambda_j$ 的[特征向量](@entry_id:151813)。

在[QR算法](@entry_id:145597)中，从 $T_k - \mu_k I = Q_k R_k$ 可得 $(T_k - \mu_k I)^{-1} e_n = R_k^{-1} Q_k^T e_n$。这表明，QR迭代的动力学偏向于放大与最接近位移 $\mu_k$ 的[特征值](@entry_id:154894)相关联的[特征向量](@entry_id:151813)分量。通过选择[Wilkinson位移](@entry_id:634015)，我们实际上是找到了一个对 $T_k$ 的某个[特征值](@entry_id:154894)（通常是 $\lambda_n$ 或 $\lambda_{n-1}$）的极佳近似。根据**[柯西交错定理](@entry_id:155328)（Cauchy's Interlacing Theorem）**和局部耦合效应，尾部 $2 \times 2$ 子矩阵的[特征值](@entry_id:154894)能够高度精确地逼近完整矩阵的[特征值](@entry_id:154894)。因此，将[Wilkinson位移](@entry_id:634015)代入这个隐式的[反幂法](@entry_id:148185)机制，就能导致次对角[线元](@entry_id:196833)素 $b_{n-1}$ 以惊人的速度衰减。

#### 立方收敛性

这种卓越的逼近精度直接转化为超快的[收敛速度](@entry_id:636873)。对于[特征值](@entry_id:154894)分离良好的[对称三对角矩阵](@entry_id:755732)，[Wilkinson位移](@entry_id:634015)策略可以实现**三次方收敛（cubic convergence）**。这意味着在每次迭代中，次对角线元素 $b_{n-1}$ 的误差大致上是前一次迭代误差的三次方：
$$
|b_{n-1}^{(k+1)}| \approx C |b_{n-1}^{(k)}|^3
$$
这与瑞利商位移的二次方收敛和无位移算法的[线性收敛](@entry_id:163614)形成了鲜明对比  。

更深入的[渐近分析](@entry_id:160416)揭示了[收敛速度](@entry_id:636873)与谱隙（spectral gap）之间的关系。设 $\gamma = \min_{i \neq n} |\lambda_n - \lambda_i|$ 为最大[特征值](@entry_id:154894)与其他[特征值](@entry_id:154894)之间的最小距离。可以证明，当 $b_{n-1}$ 趋于零时，次对角[线元](@entry_id:196833)素的衰减行为近似为 ：
$$
|b_{n-1}^{(k+1)}| \approx C \frac{(|b_{n-1}^{(k)}|)^3}{\gamma^2}
$$
这个关系式不仅确认了三次方收敛，还揭示了一个重要的事实：收敛常数与谱隙的平方成反比。这意味着当[特征值](@entry_id:154894)聚集（$\gamma$ 很小）时，即使是[Wilkinson位移](@entry_id:634015)，其收敛速度也会减慢。

### 实用实现：[隐式位移QR](@entry_id:177511)算法

在实际计算中，显式地构造矩阵 $T - \mu I$，然后计算其QR分解，最后再组装成 $T_{k+1}$，这种做法是低效且不稳定的。高性能的实现采用一种**隐式（implicit）**方法，它不直接计算 $Q$ 和 $R$，而是通过一系列[Givens旋转](@entry_id:167475)直接构造出与 $T_k$ 正交相似的 $T_{k+1}$。

这一过程的理论基石是**[隐式Q定理](@entry_id:750561)（Implicit Q Theorem）**。该定理指出，对于一个不可约的[对称三对角矩阵](@entry_id:755732) $T$（即所有次对角[线元](@entry_id:196833)素非零），任何能够将 $T$ 变换为另一个三对角矩阵的正交[相似变换](@entry_id:152935) $S^T T S$，其[变换矩阵](@entry_id:151616) $S$ 在很大程度上由其第一列唯一确定（相差一个对角符号矩阵）。 

[隐式QR算法](@entry_id:750559)巧妙地利用了这一定理，执行一个所谓的“**凸起追逐（bulge chasing）**”过程：

1.  **启动**：计算[Wilkinson位移](@entry_id:634015) $\mu$。注意，这个 $\mu$ **仅用于**确定我们期望得到的[正交矩阵](@entry_id:169220) $Q$ 的第一列。根据 $T-\mu I=QR$， $Q$ 的第一列 $q_1$ 与 $(T-\mu I)e_1$ 平行，即向量 $[(a_1-\mu), b_1, 0, \dots, 0]^T$。我们构造一个作用于第1和第2行的[Givens旋转](@entry_id:167475) $G_1$，使其第一列与期望的 $q_1$ 方向一致。

2.  **制造凸起**：执行[相似变换](@entry_id:152935) $T' = G_1^T T G_1$。由于 $G_1$ 混合了第1和第2行/列，这个操作会在原本为零的 $(1,3)$ 和 $(3,1)$ 位置引入非零元素，形成一个“凸起”。

3.  **追逐凸起**：接着，构造一系列[Givens旋转](@entry_id:167475) $G_2, G_3, \dots, G_{n-1}$。每个旋转 $G_i$ 作用于第 $i$ 和 $i+1$ 行/列，其目的是将凸起向下和向右“推”一个位置。例如，$G_2$ 会将 $(1,3)/(3,1)$ 的凸起移动到 $(2,4)/(4,2)$ 位置。

4.  **消除凸起**：这个追逐过程一直持续到最后一个旋转 $G_{n-1}$ 将凸起“推出”矩阵的右下角，从而恢[复矩阵](@entry_id:190650)的三对角结构。

最终得到的矩阵 $T_{k+1} = (G_{n-1}\dots G_1)^T T_k (G_1\dots G_{n-1})$。根据[隐式Q定理](@entry_id:750561)，由于这个过程的起始步骤（$G_1$）与显式QR步骤的 $Q$ 矩阵的第一列相匹配，并且最终也得到了一个三对角矩阵，那么这个 $T_{k+1}$ 与通过显式QR分解得到的矩阵本质上是相同的（最多相差一个对角符号相似变换）。 

如果矩阵在迭代过程中是可约的（即某个 $b_i=0$），那么特征值问题自然地分解为几个独立的子块。此时，凸起追逐的过程将完全限制在包含尾部 $2 \times 2$ 矩阵的那个不可约子块内，不会跨越零次对角线元素。

### 数值细节与稳健性

将优雅的理论转化为稳健的数值软件，还需要处理一些重要的实际问题。

#### 位移的稳定计算

直接使用二次公式计算 $2 \times 2$ 尾部子矩阵 $S = \begin{pmatrix} a  b \\ b  d \end{pmatrix}$ 的[特征值](@entry_id:154894)可能遭遇数值问题。其[特征值](@entry_id:154894)为：
$$
\lambda = \frac{a+d}{2} \pm \sqrt{\left(\frac{a-d}{2}\right)^2 + b^2}
$$
[Wilkinson位移](@entry_id:634015)是与 $d$ 更近的那个[特征值](@entry_id:154894)。令 $\tau = (a-d)/2$，则两个[特征值](@entry_id:154894)为 $\lambda_{1,2} = d + \tau \pm \sqrt{\tau^2 + b^2}$。与 $d$ 更近的那个[特征值](@entry_id:154894)可以表示为 $\mu = d + (\tau - \operatorname{sign}(\tau)\sqrt{\tau^2+b^2})$。当 $|b|$ 很小，即 $\tau^2 \gg b^2$ 时，$\sqrt{\tau^2+b^2} \approx |\tau|$，这会导致两个几乎相等的数相减，引发**灾难性抵消（catastrophic cancellation）**。

为了避免这种情况，我们可以对表达式进行有理化，得到一个数值上更稳定的公式 ：
$$
\mu = d + \frac{(\tau - \operatorname{sign}(\tau)\sqrt{\tau^2+b^2})(\tau + \operatorname{sign}(\tau)\sqrt{\tau^2+b^2})}{\tau + \operatorname{sign}(\tau)\sqrt{\tau^2+b^2}} = d + \frac{\tau^2 - (\tau^2+b^2)}{\tau + \operatorname{sign}(\tau)\sqrt{\tau^2+b^2}}
$$
最终得到稳定形式：
$$
\mu = d - \frac{b^2}{\tau + \operatorname{sign}(\tau)\sqrt{\tau^2+b^2}}
$$
在这个公式中，分母是两个同号的数相加，从而避免了相消误差。

#### 处理聚集[特征值](@entry_id:154894)

如前所述，当[特征值](@entry_id:154894)聚集时，谱隙 $\gamma$ 很小，[Wilkinson位移](@entry_id:634015)的收敛速度会减慢。更具体地说，当尾部的两个[特征值](@entry_id:154894) $\lambda_{n-1}$ 和 $\lambda_n$ 形成紧密簇时，通常意味着 $a_{n-1} \approx a_n$，即 $\tau = (a_{n-1}-a_n)/2$ 很小。此时，$S$ 的两个[特征值](@entry_id:154894) $\approx d \pm |b|$ 与 $d$ 的距离几乎相等。

在这种情况下，选择哪个[特征值](@entry_id:154894)作为位移变得模糊不清，对[浮点误差](@entry_id:173912)非常敏感。理论分析表明，在这种情况下，[Wilkinson位移](@entry_id:634015)的三次方收敛会退化为**二次方收敛**，与瑞利商位移的收敛阶数相同。尽管收敛阶数降低，但[Wilkinson位移](@entry_id:634015)通常仍然比[瑞利商](@entry_id:137794)位移更稳健。

#### 数值平局的处理

在[有限精度算术](@entry_id:142321)中，“更接近”的判断可能会出现**数值平局（numerical tie）**，即 $||\lambda_1 - a_n| - |\lambda_2 - a_n||$ 的值与[机器精度](@entry_id:756332)相当。这时，需要一个确定的**平局打破规则（tie-break rule）**来保证算法的确定性。例如，可以规定在出现平局时，总是选择较大的[特征值](@entry_id:154894)或总是选择较小的[特征值](@entry_id:154894)作为位移。不同的平局打破规则可能会对算法的单步[后向误差](@entry_id:746645)产生微小影响，这个误差可以通过[残差范数](@entry_id:754273) $\| T_{\text{new}} - Q^T T Q \|_F$ 来衡量。精心设计的数值库（如[LAPACK](@entry_id:751137)）会包含对此类情况的细致处理，以确保算法的整体稳健性和高精度。

综上所述，[Wilkinson位移](@entry_id:634015)不仅是一个巧妙的构造，其背后还蕴含着深刻的数学原理和精密的数值考量。它将局部谱信息、隐式[反幂法](@entry_id:148185)和高效的凸起追逐实现相结合，共同造就了[对称特征值问题](@entry_id:755714)求解中最高效、最可靠的算法之一。