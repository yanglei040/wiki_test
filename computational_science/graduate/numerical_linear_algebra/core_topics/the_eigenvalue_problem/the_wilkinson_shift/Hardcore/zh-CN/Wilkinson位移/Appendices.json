{
    "hands_on_practices": [
        {
            "introduction": "要掌握一个算法，最有效的方法之一就是通过具体计算来实践。本练习提供了一个直接的机会，将威尔金森位移的定义应用于一个简单的对称三对角矩阵。通过这个练习，你将熟悉计算威尔金森位移的两个关键步骤：首先识别矩阵的尾部 $2 \\times 2$ 子矩阵，然后根据邻近准则选择其两个特征值中的一个作为位移量 。",
            "id": "3598801",
            "problem": "考虑实对称三对角矩阵 $$T=\\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix}.$$ 在应用于实对称三对角矩阵的隐式位移正交三角分解（QR）算法中，一个称为Wilkinson位移的标准位移选择是从 $T$ 的尾部主 $2\\times 2$ 子矩阵获得的。从特征值是矩阵特征多项式根的定义出发，找出 $T$ 的尾部主 $2\\times 2$ 子矩阵，通过符号计算确定其特征值，然后根据与 $T$ 右下角对角线元素的常规邻近准则选择Wilkinson位移。请以单一闭式解析表达式的形式给出Wilkinson位移。无需四舍五入。",
            "solution": "用户提供了一个有效的问题。\n\n问题要求计算给定实对称三对角矩阵 $T$ 的Wilkinson位移。Wilkinson位移是QR算法中用于计算特征值的一种特定位移选择。它被定义为尾部（右下角）$2 \\times 2$ 主子矩阵的两个特征值之一。\n\n给定的矩阵是：\n$$T=\\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix}$$\n这是一个 $3 \\times 3$ 矩阵。我们将其元素记为 $T_{ij}$。尾部主 $2 \\times 2$ 子矩阵，我们称之为 $T_{sub}$，由 $T$ 的最后两行和最后两列构成。\n$$T_{sub} = \\begin{pmatrix} T_{22}  T_{23} \\\\ T_{32}  T_{33} \\end{pmatrix} = \\begin{pmatrix} 3  1 \\\\ 1  4 \\end{pmatrix}$$\n为了找到 $T_{sub}$ 的特征值，我们必须解特征方程 $\\det(T_{sub} - \\lambda I) = 0$，其中 $I$ 是 $2 \\times 2$ 单位矩阵，$\\lambda$ 代表特征值。\n$$T_{sub} - \\lambda I = \\begin{pmatrix} 3-\\lambda  1 \\\\ 1  4-\\lambda \\end{pmatrix}$$\n行列式为：\n$$\\det(T_{sub} - \\lambda I) = (3-\\lambda)(4-\\lambda) - (1)(1)$$\n将行列式设为零，得到特征多项式：\n$$(3-\\lambda)(4-\\lambda) - 1 = 0$$\n$$12 - 4\\lambda - 3\\lambda + \\lambda^2 - 1 = 0$$\n$$\\lambda^2 - 7\\lambda + 11 = 0$$\n我们使用二次公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $\\lambda$ 的二次方程，其中 $a=1$，$b=-7$，$c=11$。\n$$\\lambda = \\frac{-(-7) \\pm \\sqrt{(-7)^2 - 4(1)(11)}}{2(1)}$$\n$$\\lambda = \\frac{7 \\pm \\sqrt{49 - 44}}{2}$$\n$$\\lambda = \\frac{7 \\pm \\sqrt{5}}{2}$$\n子矩阵 $T_{sub}$ 的两个特征值是：\n$$\\lambda_1 = \\frac{7 - \\sqrt{5}}{2}$$\n$$\\lambda_2 = \\frac{7 + \\sqrt{5}}{2}$$\nWilkinson位移，记作 $\\mu$，被定义为 $T_{sub}$ 的特征值中更接近完整矩阵 $T$ 的右下角元素 $T_{33}$ 的那个。在本例中，$T_{33} = 4$。\n\n我们必须确定 $\\lambda_1$ 和 $\\lambda_2$ 中哪一个更接近 $4$。这等同于比较绝对差值 $|\\lambda_1 - 4|$ 和 $|\\lambda_2 - 4|$。\n\n首先，我们计算 $\\lambda_1$ 的距离：\n$$|\\lambda_1 - 4| = \\left| \\frac{7 - \\sqrt{5}}{2} - 4 \\right| = \\left| \\frac{7 - \\sqrt{5} - 8}{2} \\right| = \\left| \\frac{-1 - \\sqrt{5}}{2} \\right|$$\n由于 $1 + \\sqrt{5}$ 是正数，绝对值为：\n$$|\\lambda_1 - 4| = \\frac{1 + \\sqrt{5}}{2}$$\n接下来，我们计算 $\\lambda_2$ 的距离：\n$$|\\lambda_2 - 4| = \\left| \\frac{7 + \\sqrt{5}}{2} - 4 \\right| = \\left| \\frac{7 + \\sqrt{5} - 8}{2} \\right| = \\left| \\frac{\\sqrt{5} - 1}{2} \\right|$$\n由于 $\\sqrt{5} \\approx 2.236$，我们知道 $\\sqrt{5} - 1 > 0$。因此，绝对值为：\n$$|\\lambda_2 - 4| = \\frac{\\sqrt{5} - 1}{2}$$\n现在我们比较这两个距离，$\\frac{1 + \\sqrt{5}}{2}$ 和 $\\frac{\\sqrt{5} - 1}{2}$。\n由于 $\\sqrt{5}$ 是一个正常数，我们可以看到 $1 + \\sqrt{5} > \\sqrt{5} - 1$。因此：\n$$\\frac{1 + \\sqrt{5}}{2} > \\frac{\\sqrt{5} - 1}{2}$$\n这意味着 $|\\lambda_1 - 4| > |\\lambda_2 - 4|$，所以特征值 $\\lambda_2$ 更接近 $4$。\n\n根据常规邻近准则，Wilkinson位移 $\\mu$ 被选为更接近 $T_{33}$ 的特征值。\n$$\\mu = \\lambda_2 = \\frac{7 + \\sqrt{5}}{2}$$\n这就是所要求的Wilkinson位移的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{7 + \\sqrt{5}}{2}}$$"
        },
        {
            "introduction": "在数值计算中，一个公式的直接代数实现可能在浮点运算中导致严重的精度损失。本练习深入探讨了威尔金森位移计算中的一个关键问题——灾难性相消 (catastrophic cancellation)，并指导你推导出一个数值稳定的替代公式 。掌握这种分析和重构是设计高质量数值软件的核心技能。",
            "id": "3283423",
            "problem": "考虑在带位移的正交-三角 (QR) 算法中确定位移的尾部 $2 \\times 2$ 分块矩阵：\n$$\nB \\;=\\; \\begin{pmatrix} a  b \\\\ b  c \\end{pmatrix}.\n$$\nWilkinson 位移被定义为 $B$ 的特征值中，与右下角元素 $c$ 更接近（绝对差更小）的那一个。仅从特征多项式定义 $\\det(B - \\lambda I) = 0$ 和二次求根公式出发，完成以下任务：\n\n1) 推导 $B$ 的两个特征值（用 $a$、$b$ 和 $c$ 表示），并根据 $d = \\tfrac{a - c}{2}$ 的符号，确定哪个分支对应于更接近 $c$ 的特征值。解释为什么当 $|d| \\gg |b|$ 且 $d > 0$ 时，使用朴素的二次求根公式表达式直接计算更接近 $c$ 的特征值会出现灾难性抵消。\n\n2) 通过对特征方程及其蕴含的恒等式进行纯粹的代数操作，推导出一个数值稳定的、用于计算更接近 $c$ 的特征值的闭式表达式，该表达式避免了两个几乎相等的数相减。\n\n3) 使用你得到的稳定表达式，计算特定尾部块\n$$\nB \\;=\\; \\begin{pmatrix} 10^{8}  10^{-4} \\\\ 10^{-4}  10^{-8} \\end{pmatrix}.\n$$\n的 Wilkinson 位移。将你的最终数值以小数形式给出，并四舍五入到十位有效数字。\n\n你的最终答案必须是一个实数（无单位）。",
            "solution": "用户提出了一个关于在用于寻找对称矩阵特征值的 QR 算法中使用的 Wilkinson 位移的三部分问题。我将首先验证问题陈述，然后逐步进行求解。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   所讨论的矩阵是一个 $2 \\times 2$ 的对称分块：$B = \\begin{pmatrix} a  b \\\\ b  c \\end{pmatrix}$。\n-   Wilkinson 位移被定义为 $B$ 的特征值中更接近 $c$ 的那一个。\n-   定义了一个辅助变量：$d = \\frac{a - c}{2}$。\n-   推导必须从特征多项式 $\\det(B - \\lambda I) = 0$ 和二次求根公式开始。\n-   第 1 部分：推导 $B$ 的特征值，根据 $\\operatorname{sgn}(d)$ 的函数确定更接近 $c$ 的那个特征值，并解释当 $|d| \\gg |b|$ 且 $d > 0$ 时，朴素计算中发生的灾难性抵消。\n-   第 2 部分：为 Wilkinson 位移推导一个数值稳定的闭式表达式。\n-   第 3 部分：计算特定矩阵 $B = \\begin{pmatrix} 10^{8}  10^{-4} \\\\ 10^{-4}  10^{-8} \\end{pmatrix}$ 的 Wilkinson 位移，并提供四舍五入到十位有效数字的结果。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学上成立：** 该问题是数值线性代数中的一个标准、基础的课题。Wilkinson 位移、QR 算法以及数值稳定性分析（特别是灾难性抵消）都是已经成熟的概念。该矩阵是对称的，保证了特征值为实数，这与上下文一致。\n-   **问题适定：** 该问题陈述清晰，通过一系列逻辑任务导向一个唯一的数学推导和一个特定的数值结果。所有必要的定义和数据都已提供。\n-   **客观性：** 语言形式化、精确，没有任何主观或模糊的术语。\n\n**步骤 3：结论与行动**\n该问题是有效的。它是一个数值分析领域中适定的、科学上合理的问题。我现在将进行完整解答。\n\n### 第 1 部分：特征值推导与抵消分析\n\n矩阵 $B$ 的特征值 $\\lambda$ 是特征多项式的根，由 $\\det(B - \\lambda I) = 0$ 给出。\n$$\n\\det\\left(\\begin{pmatrix} a  b \\\\ b  c \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\\right) = \\det\\begin{pmatrix} a - \\lambda  b \\\\ b  c - \\lambda \\end{pmatrix} = 0\n$$\n展开行列式得到二次方程：\n$$\n(a - \\lambda)(c - \\lambda) - b^2 = 0\n$$\n$$\n\\lambda^2 - (a+c)\\lambda + (ac - b^2) = 0\n$$\n使用二次求根公式求解 $\\lambda$：\n$$\n\\lambda = \\frac{(a+c) \\pm \\sqrt{(a+c)^2 - 4(ac - b^2)}}{2}\n$$\n$$\n\\lambda = \\frac{(a+c) \\pm \\sqrt{a^2 + 2ac + c^2 - 4ac + 4b^2}}{2}\n$$\n$$\n\\lambda = \\frac{(a+c) \\pm \\sqrt{a^2 - 2ac + c^2 + 4b^2}}{2}\n$$\n$$\n\\lambda = \\frac{(a+c) \\pm \\sqrt{(a-c)^2 + 4b^2}}{2}\n$$\n引入给定变量 $d = \\frac{a-c}{2}$，我们有 $a-c = 2d$。我们还注意到 $\\frac{a+c}{2} = \\frac{(c+2d)+c}{2} = c+d$。将这些代入 $\\lambda$ 的表达式中：\n$$\n\\lambda = \\frac{a+c}{2} \\pm \\frac{\\sqrt{4d^2 + 4b^2}}{2} = (c+d) \\pm \\sqrt{d^2+b^2}\n$$\n两个特征值是 $\\lambda_1 = c+d+\\sqrt{d^2+b^2}$ 和 $\\lambda_2 = c+d-\\sqrt{d^2+b^2}$。\n\nWilkinson 位移是更接近 $c$ 的那个特征值。我们必须比较距离 $|\\lambda_1 - c|$ 和 $|\\lambda_2 - c|$。\n$$\n|\\lambda_1 - c| = |d + \\sqrt{d^2+b^2}|\n$$\n$$\n|\\lambda_2 - c| = |d - \\sqrt{d^2+b^2}|\n$$\n因为 $b^2 \\ge 0$，我们有 $\\sqrt{d^2+b^2} \\ge \\sqrt{d^2} = |d|$。较小的距离对应于 $d$ 和 $\\sqrt{d^2+b^2}$ 相减的表达式。这取决于 $d$ 的符号。\n-   如果 $d > 0$，那么 $|d - \\sqrt{d^2+b^2}| = \\sqrt{d^2+b^2}-d$ 小于 $|d + \\sqrt{d^2+b^2}| = d+\\sqrt{d^2+b^2}$。更接近的特征值是 $\\lambda_2$。\n-   如果 $d  0$，那么 $|d + \\sqrt{d^2+b^2}| = \\sqrt{d^2+b^2}-|d|$ 小于 $|d - \\sqrt{d^2+b^2}| = |d|+\\sqrt{d^2+b^2}$。更接近的特征值是 $\\lambda_1$。\n-   如果 $d = 0$，两个特征值与 $c$ 等距。按照惯例（例如，如 Wilkinson 的原始著作中所述），可以选择一个特定的分支。\n\n我们可以使用符号函数 $\\operatorname{sgn}(d)$ 来统一这个选择，其中我们定义 $\\operatorname{sgn}(0)=1$。绝对值较小的项总是 $d - \\operatorname{sgn}(d)\\sqrt{d^2+b^2}$。因此，Wilkinson 位移 $\\mu$ 由下式给出：\n$$\n\\mu = c + \\left(d - \\operatorname{sgn}(d)\\sqrt{d^2+b^2}\\right)\n$$\n\n现在，考虑 $|d| \\gg |b|$ 且 $d>0$ 的情况。Wilkinson 位移为 $\\mu = c+d-\\sqrt{d^2+b^2}$。\n在这种情况下，$\\sqrt{d^2+b^2} = d\\sqrt{1+(b/d)^2}$。由于 $(b/d)^2$ 非常小，使用二项式近似：\n$$\n\\sqrt{d^2+b^2} \\approx d\\left(1 + \\frac{1}{2}\\left(\\frac{b}{d}\\right)^2\\right) = d + \\frac{b^2}{2d}\n$$\n$\\sqrt{d^2+b^2}$ 的值非常接近 $d$。当在有限精度算术中计算表达式 $\\mu = c + (d - \\sqrt{d^2+b^2})$ 时，减法 $d - \\sqrt{d^2+b^2}$ 涉及两个几乎相等的数。这会导致结果中有效数字的大量损失，这种效应被称为灾难性抵消。计算出的位移结果的相对精度会非常低。\n\n### 第 2 部分：数值稳定表达式的推导\n\n为了避免 $d - \\operatorname{sgn}(d)\\sqrt{d^2+b^2}$ 中的灾难性抵消，我们可以使用一种基于“分子有理化”的代数操作。\n令导致不稳定的项为 $T = d - \\operatorname{sgn}(d)\\sqrt{d^2+b^2}$。我们将其乘以并除以其共轭项 $d + \\operatorname{sgn}(d)\\sqrt{d^2+b^2}$。\n$$\nT = \\frac{\\left(d - \\operatorname{sgn}(d)\\sqrt{d^2+b^2}\\right) \\left(d + \\operatorname{sgn}(d)\\sqrt{d^2+b^2}\\right)}{d + \\operatorname{sgn}(d)\\sqrt{d^2+b^2}}\n$$\n$$\nT = \\frac{d^2 - (\\operatorname{sgn}(d))^2(d^2+b^2)}{d + \\operatorname{sgn}(d)\\sqrt{d^2+b^2}}\n$$\n由于对于 $d \\neq 0$，$(\\operatorname{sgn}(d))^2=1$：\n$$\nT = \\frac{d^2 - (d^2+b^2)}{d + \\operatorname{sgn}(d)\\sqrt{d^2+b^2}} = \\frac{-b^2}{d + \\operatorname{sgn}(d)\\sqrt{d^2+b^2}}\n$$\n分母 $d + \\operatorname{sgn}(d)\\sqrt{d^2+b^2}$ 涉及两个同号项（$d$ 和 $\\operatorname{sgn}(d)\\sqrt{...}$）的相加，因此避免了抵消。\n将 $T$ 的这个稳定表达式代回位移公式 $\\mu = c+T$，我们得到数值稳定的形式：\n$$\n\\mu = c - \\frac{b^2}{d + \\operatorname{sgn}(d)\\sqrt{d^2+b^2}}\n$$\n\n### 第 3 部分：数值计算\n\n给定矩阵：\n$$\nB = \\begin{pmatrix} 10^{8}  10^{-4} \\\\ 10^{-4}  10^{-8} \\end{pmatrix}\n$$\n参数为 $a = 10^8$，$b = 10^{-4}$ 和 $c = 10^{-8}$。\n首先，我们计算 $d$。\n$$\nd = \\frac{a-c}{2} = \\frac{10^8 - 10^{-8}}{2} = 5 \\times 10^7 - 5 \\times 10^{-9}\n$$\n由于 $d > 0$，$\\operatorname{sgn}(d) = 1$。Wilkinson 位移 $\\mu$ 的稳定公式为：\n$$\n\\mu = c - \\frac{b^2}{d + \\sqrt{d^2+b^2}}\n$$\n我们有以下数值：\n$c = 10^{-8}$\n$b^2 = (10^{-4})^2 = 10^{-8}$\n\n问题现在是高精度地计算 $\\mu = 10^{-8} - \\frac{10^{-8}}{d + \\sqrt{d^2+10^{-8}}}$。\n让我们计算分母 $D = d + \\sqrt{d^2+b^2}$。\n$d = 49999999.999999995$\n$d^2 = (49999999.999999995)^2 \\approx 2.5 \\times 10^{15}$\n$b^2 = 10^{-8}$\n项 $\\sqrt{d^2+b^2}$ 非常接近 $d$。使用高精度计算器，我们发现：\n$d+\\sqrt{d^2+b^2} \\approx 99999999.99999999000000001...$\n这大约是 $10^8 - 10^{-8}$。让我们计算这个分数：\n$$\n\\frac{b^2}{d + \\sqrt{d^2+b^2}} = \\frac{10^{-8}}{99999999.999999990...} \\approx \\frac{10^{-8}}{10^8} = 10^{-16}\n$$\n所以，位移的初步近似是 $\\mu \\approx 10^{-8} - 10^{-16} = 0.0000000099999999$。\n为了达到所需的十位有效数字，需要进行更精确的计算。使用具有足够精度的计算工具（例如，设置 50 位精度的 Python 的 `Decimal` 库），我们可以计算该稳定表达式：\n$\\mu = c - \\frac{b^2}{d+\\sqrt{d^2+b^2}}$\n这得出值：\n$\\mu \\approx 0.000000009999999899999999...$\n用科学记数法表示，这是 $9.999999899999999... \\times 10^{-9}$。\n\n要将其四舍五入到十位有效数字，我们检查前十一位有效数字：$9.999999899$。第十一位数字是 $9$，它 $\\ge 5$，所以我们必须将第十位数字向上舍入。\n第十位有效数字是 $9$。将其向上舍入得到 $0$，并向第九位数字进位。\n第九位有效数字是 $8$。加上进位使其变为 $9$。\n四舍五入到十位有效数字的值是 $9.99999990 \\times 10^{-9}$。\n作为小数，这是 $0.00000000999999990$。",
            "answer": "$$\\boxed{0.00000000999999990}$$"
        },
        {
            "introduction": "威尔金森位移在QR算法中的主要目的是加速收敛。本练习探讨了迭代过程的终局：如何判断一个特征值已经收敛。它将“紧缩” (deflation) 过程建立在后向稳定性原则之上，展示了如何根据机器精度判断一个次对角线元素是否足够小，可以视为零，从而将问题分解 。",
            "id": "3598798",
            "problem": "考虑一个实对称三对角矩阵 $T \\in \\mathbb{R}^{5 \\times 5}$，其对角线元素为 $a_{1},a_{2},a_{3},a_{4},a_{5}$，次对角线元素为 $b_{1},b_{2},b_{3},b_{4}$，由下式给出\n$$\nT=\\begin{pmatrix}\n4.237  0.512  0  0  0 \\\\\n0.512  3.781  0.398  0  0 \\\\\n0  0.398  3.215  0.307  0 \\\\\n0  0  0.307  2.103  1.0\\times 10^{-12} \\\\\n0  0  0  1.0\\times 10^{-12}  2.050\n\\end{pmatrix}.\n$$\n使用 Wilkinson 位移执行一个隐式正交三角 (QR) 步，该位移定义为 $T$ 的末尾 $2\\times 2$ 主子矩阵的特征值中，更接近右下角对角线元素的那一个。假设机器 epsilon 为 $\\epsilon=2^{-52}$，与电气和电子工程师协会 (Institute of Electrical and Electronics Engineers, IEEE) 浮点算术标准 (IEEE 754) 的双精度一致。\n\n在经过 Wilkinson 位移的隐式 QR 步和凸起追逐后，更新后的三对角矩阵 $T^{(1)}$ 的最下面次对角线元素的测量值为\n$$\n|b_{4}^{(1)}|=4.2\\times 10^{-16},\n$$\n并且相邻对角线元素的大小满足\n$$\n|a_{4}^{(1)}|=2.103,\\quad |a_{5}^{(1)}|=2.050.\n$$\n\n从正交变换的基本向后稳定性原理和对称三对角相似性步骤的扰动行为出发，通过比较末尾次对角线元素的大小与相邻对角线元素的大小，推导出紧缩检验（deflation test）。然后，为上述数据计算标量\n$$\n\\delta \\;=\\; |b_{4}^{(1)}| \\;-\\; \\epsilon\\big(|a_{4}^{(1)}|+|a_{5}^{(1)}|\\big)\n$$\n。将 $\\delta$ 的最终数值四舍五入到四位有效数字。",
            "solution": "问题要求做两件事：首先，基于向后稳定性原理，在 QR 算法的背景下为对称三对角矩阵推导出紧缩检验；其次，根据这个检验为给定数据计算一个特定的值 $\\delta$。\n\n首先，我们来推导紧缩检验。用于寻找特征值的 QR 算法迭代地对矩阵 $T$ 应用正交相似变换，以生成一系列收敛到对角（或块对角）形式的矩阵 $T^{(k)}$。对于一个对称三对角矩阵 $T$，每一步都会产生一个新的对称三对角矩阵 $T^{(k+1)} = (Q^{(k)})^T T^{(k)} Q^{(k)}$。\n\n证明紧缩合理性的核心原理是向后稳定性。如果一个算法在有限精度算术中计算出的解是原始问题某个轻微扰动版本的精确解，那么该算法就被认为是向后稳定的。对于对称特征值问题，这意味着矩阵 $T$ 的计算特征值是某个矩阵 $T+E$ 的精确特征值，其中扰动 $E$ 是“小的”。\n\n一个单一的隐式 QR 步涉及一系列 Givens 旋转。由于浮点舍入误差，计算出的矩阵（我们称之为 $\\hat{T}^{(1)}$）与起始矩阵 $T$ 并非精确正交相似。然而，由 J.H. Wilkinson 开创的向后误差分析表明，$\\hat{T}^{(1)}$ 与一个扰动矩阵 $T+E$ 是精确正交相似的。也就是说，对于某个精确的正交矩阵 $\\hat{Q}$，有 $\\hat{T}^{(1)} = \\hat{Q}^T (T+E) \\hat{Q}$。向后误差矩阵 $E$ 的范数很小，通常其界限为 $\\|E\\|_2 \\approx c \\cdot n \\cdot \\epsilon \\cdot \\|T\\|_2$，其中 $n$ 是矩阵的维数，$\\epsilon$ 是机器 epsilon，$c$ 是一个小的常数。\n\n紧缩（Deflation）是在一个次对角线元素 $b_{k-1}$ 的大小被认为可以忽略不计时，将其设置为零的过程。这个操作将矩阵分裂成两个更小的、独立的三对角子问题，从而简化了整体计算。让我们考虑一步之后计算出的矩阵，为简单起见，我们将其表示为 $T^{(1)}$，其对角线元素为 $a_i^{(1)}$，次对角线元素为 $b_i^{(1)}$。将元素 $b_{k-1}^{(1)}$ 设置为零是对矩阵 $T^{(1)}$ 的一次有意扰动。如果我们将结果矩阵称为 $T'$，那么 $T' = T^{(1)} + F$，其中 $F$ 是一个扰动矩阵，只有两个非零项：$F_{k-1, k} = F_{k, k-1} = -b_{k-1}^{(1)}$。\n\n如果这个有意的扰动 $F$ 可以在概念上被吸收到 QR 步骤固有的向后误差 $E$ 中，那么它就是合理的。换句话说，我们通过将 $b_{k-1}^{(1)}$ 设置为零所引入的误差，不应该大于我们因浮点运算而已经产生的误差。这个扰动的大小由其范数来衡量，即 $\\|F\\|_2 = |b_{k-1}^{(1)}|$。\n\n因此，紧缩的条件是 $|b_{k-1}^{(1)}| \\le \\text{tol}$，其中 $\\text{tol}$ 是一个表示可接受误差范围的容差。虽然可以使用像 $\\epsilon \\|T^{(1)}\\|_2$ 这样的全局容差，但在高质量的数值库如 LAPACK 中，使用了一个更实用、局部且被广泛采纳的准则。该准则将 $|b_{k-1}^{(1)}|$ 与相邻对角线元素 $a_{k-1}^{(1)}$ 和 $a_k^{(1)}$ 的不确定性进行比较。在浮点运算中存储像 $a_k^{(1)}$ 这样的数的不确定性量级为 $\\epsilon |a_k^{(1)}|$。将两个相邻对角线元素的不确定性相加，可以得到一个合理的局部数值噪声尺度。\n\n因此，标准的紧缩检验是，如果次对角线元素 $b_{k-1}^{(1)}$ 的大小与机器精度乘以相邻对角线元素大小之和的量级相当或更小，则宣布其可以忽略。这可以正式表述为：\n$$\n|b_{k-1}^{(1)}| \\le \\epsilon \\left( |a_{k-1}^{(1)}| + |a_k^{(1)}| \\right)\n$$\n如果这个不等式成立，将 $b_{k-1}^{(1)}$ 设置为零就是一个向后稳定的操作，因为引入的误差在局部 $2 \\times 2$ 块表示的“噪声”范围内。\n\n接下来，我们为问题中提供的具体数据计算量 $\\delta$。问题设定在矩阵的末端，因此我们关心的是次对角线元素 $b_4^{(1)}$ 和相邻的对角线元素 $a_4^{(1)}$ 和 $a_5^{(1)}$。需要计算的量是：\n$$\n\\delta = |b_{4}^{(1)}| - \\epsilon\\big(|a_{4}^{(1)}|+|a_{5}^{(1)}|\\big)\n$$\n$\\delta$ 的符号直接表明是否满足紧缩准则（如果 $\\delta \\le 0$，则准则满足）。\n\n给定的值为：\n- $|b_{4}^{(1)}| = 4.2 \\times 10^{-16}$\n- $|a_{4}^{(1)}| = 2.103$\n- $|a_{5}^{(1)}| = 2.050$\n- $\\epsilon = 2^{-52}$\n\n首先，我们计算对角线元素大小的和：\n$$\n|a_{4}^{(1)}|+|a_{5}^{(1)}| = 2.103 + 2.050 = 4.153\n$$\n接下来，我们计算紧缩容差项 $\\epsilon(|a_{4}^{(1)}|+|a_{5}^{(1)}|)$：\n$$\n\\epsilon(|a_{4}^{(1)}|+|a_{5}^{(1)}|) = 2^{-52} \\times 4.153\n$$\nIEEE 754 双精度的机器 epsilon 值为 $\\epsilon = 2^{-52} \\approx 2.220446049250313 \\times 10^{-16}$。\n$$\n\\text{tol} = (2.220446049250313 \\times 10^{-16}) \\times 4.153 \\approx 9.22151325333190 \\times 10^{-16}\n$$\n现在，我们可以通过代入数值来计算 $\\delta$：\n$$\n\\delta = 4.2 \\times 10^{-16} - 9.22151325333190 \\times 10^{-16}\n$$\n$$\n\\delta = (4.2 - 9.22151325333190) \\times 10^{-16}\n$$\n$$\n\\delta = -5.02151325333190 \\times 10^{-16}\n$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$\n\\delta \\approx -5.022 \\times 10^{-16}\n$$\n$\\delta$ 的负值证实了紧缩准则 $|b_{4}^{(1)}| \\le \\epsilon(|a_{4}^{(1)}|+|a_{5}^{(1)}|)$ 是满足的，因此次对角线元素 $b_{4}^{(1)}$ 将被设置为零。",
            "answer": "$$\\boxed{-5.022 \\times 10^{-16}}$$"
        }
    ]
}