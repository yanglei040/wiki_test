{
    "hands_on_practices": [
        {
            "introduction": "解决最小二乘问题的核心思想是找到向量 $b$ 在矩阵 $A$ 列空间上的正交投影。本练习  将引导你亲手实践一种数值上稳健且几何意义清晰的方法：通过 Gram-Schmidt 正交化构造 QR 分解。你将从头推导并计算，将一个超定系统转化为一个易于求解的上三角系统，从而直观地掌握最小二乘解的本质。",
            "id": "3590957",
            "problem": "设 $A \\in \\mathbb{R}^{4 \\times 2}$ 和 $b \\in \\mathbb{R}^{4}$ 由下式给出\n$$\nA \\;=\\; \\begin{pmatrix}\n1  1\\\\\n1  0\\\\\n0  1\\\\\n0  0\n\\end{pmatrix}, \n\\qquad\nb \\;=\\; \\begin{pmatrix}\n2\\\\\n1\\\\\n0\\\\\n0\n\\end{pmatrix}.\n$$\n考虑最小化残差欧几里得范数的线性最小二乘 (LS) 问题，\n$$\n\\min_{x \\in \\mathbb{R}^{2}} \\; \\|\\,b - A x\\,\\|_{2}.\n$$\n从标准正交性和正交投影的定义出发，并且不调用任何预先给出的最小二乘公式，按以下步骤进行：\n- 计算 $A$ 的简约 $Q$–$R$ 分解 (QR)，即 $A = Q R$，其中 $Q \\in \\mathbb{R}^{4 \\times 2}$ 的列是标准正交的，$R \\in \\mathbb{R}^{2 \\times 2}$ 是对角线元素为正的上三角矩阵。\n- 仅使用欧几里得范数在正交投影乘法下的不变性以及与 $Q$ 相关的互补子空间的正交性，从第一性原理推导最小化子关于简约 $Q$–$R$ 分解产生的三角系统的刻画。\n- 然后，对于上面给定的 $A$ 和 $b$，使用你推导出的刻画来计算目标函数 $\\min_{x \\in \\mathbb{R}^{2}} \\|\\,b - A x\\,\\|_{2}^{2}$ 的最小值的精确值。\n\n你的最终答案必须是最小平方残差 $\\min_{x \\in \\mathbb{R}^{2}} \\|\\,b - A x\\,\\|_{2}^{2}$ 的精确值。不要四舍五入。",
            "solution": "我们从线性最小二乘 (LS) 问题开始\n$$\n\\min_{x \\in \\mathbb{R}^{2}} \\|\\,b - A x\\,\\|_{2}.\n$$\n设 $A = Q R$ 是一个简约 $Q$–$R$ 分解 (QR)，其中 $Q \\in \\mathbb{R}^{4 \\times 2}$ 的列是标准正交的，$R \\in \\mathbb{R}^{2 \\times 2}$ 是对角线元素为正的上三角矩阵。根据定义，$Q$ 的列是标准正交的，所以 $Q^{T} Q = I_{2}$，且矩阵 $P \\coloneqq Q Q^{T}$ 是到 $\\mathcal{R}(Q) = \\mathcal{R}(A)$ 上的正交投影算子。\n\n对于任意 $x \\in \\mathbb{R}^{2}$，使用 $\\mathbb{R}^{4}$ 到 $\\mathcal{R}(Q)$ 和 $\\mathcal{R}(Q)^{\\perp}$ 的正交分解来分解残差：\n$$\nb - A x \\;=\\; b - Q R x \\;=\\; (I - Q Q^{T}) b \\;+\\; Q \\bigl(Q^{T} b - R x\\bigr).\n$$\n右侧的两项位于正交子空间中：$(I - Q Q^{T}) b \\in \\mathcal{R}(Q)^{\\perp}$ 和 $Q \\bigl(Q^{T} b - R x\\bigr) \\in \\mathcal{R}(Q)$。因此，根据勾股定理，\n$$\n\\|\\,b - A x\\,\\|_{2}^{2} \\;=\\; \\|\\, (I - Q Q^{T}) b \\,\\|_{2}^{2} \\;+\\; \\|\\, Q \\bigl(Q^{T} b - R x\\bigr) \\,\\|_{2}^{2}.\n$$\n利用 $Q$ 的列是标准正交的这一事实，对于所有 $y \\in \\mathbb{R}^{2}$，我们有 $\\|\\,Q y\\,\\|_{2} = \\|\\,y\\,\\|_{2}$，所以\n$$\n\\|\\,b - A x\\,\\|_{2}^{2} \\;=\\; \\|\\, (I - Q Q^{T}) b \\,\\|_{2}^{2} \\;+\\; \\|\\, Q^{T} b - R x \\,\\|_{2}^{2}.\n$$\n第一项不依赖于 $x$，第二项当且仅当\n$$\nR x \\;=\\; Q^{T} b,\n$$\n被最小化时才被最小化，这是一个 $2 \\times 2$ 的上三角系统。当 $A$ 是列满秩时，$R$ 是可逆的，存在唯一的最小化子，它通过求解这个三角系统得到。在最小化子 $x_{\\star}$ 处，最小平方残差为\n$$\n\\|\\,b - A x_{\\star}\\,\\|_{2}^{2} \\;=\\; \\|\\, (I - Q Q^{T}) b \\,\\|_{2}^{2} \\;=\\; \\|\\,b\\,\\|_{2}^{2} - \\|\\,Q^{T} b\\,\\|_{2}^{2}.\n$$\n\n我们现在从定义出发，通过经典的 Gram–Schmidt 方法计算特定 $A$ 的简约 $Q$–$R$ 分解。\n\n设 $A$ 的列为 $a_{1} = \\begin{pmatrix}1\\\\1\\\\0\\\\0\\end{pmatrix}$ 和 $a_{2} = \\begin{pmatrix}1\\\\0\\\\1\\\\0\\end{pmatrix}$。\n- 计算 $r_{11} = \\|\\,a_{1}\\,\\|_{2} = \\sqrt{1^{2} + 1^{2}} = \\sqrt{2}$ 和 $q_{1} = a_{1} / r_{11} = \\begin{pmatrix}1/\\sqrt{2}\\\\1/\\sqrt{2}\\\\0\\\\0\\end{pmatrix}$。\n- 计算 $r_{12} = q_{1}^{T} a_{2} = \\begin{pmatrix}1/\\sqrt{2}  1/\\sqrt{2}  0  0\\end{pmatrix} \\begin{pmatrix}1\\\\0\\\\1\\\\0\\end{pmatrix} = \\tfrac{1}{\\sqrt{2}}$。\n- 构造 $u_{2} = a_{2} - r_{12} q_{1} = \\begin{pmatrix}1\\\\0\\\\1\\\\0\\end{pmatrix} - \\tfrac{1}{\\sqrt{2}} \\begin{pmatrix}1/\\sqrt{2}\\\\1/\\sqrt{2}\\\\0\\\\0\\end{pmatrix} = \\begin{pmatrix}1/2\\\\-1/2\\\\1\\\\0\\end{pmatrix}$。\n- 计算 $r_{22} = \\|\\,u_{2}\\,\\|_{2} = \\sqrt{(1/2)^{2} + (-1/2)^{2} + 1^{2}} = \\sqrt{\\tfrac{3}{2}} = \\tfrac{\\sqrt{3}}{\\sqrt{2}}$ 和 $q_{2} = u_{2} / r_{22}$。\n\n因此\n$$\nQ \\;=\\; \\begin{pmatrix} q_{1}  q_{2} \\end{pmatrix}, \n\\qquad\nR \\;=\\; \\begin{pmatrix}\nr_{11}  r_{12}\\\\\n0  r_{22}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\sqrt{2}  \\tfrac{1}{\\sqrt{2}}\\\\\n0  \\tfrac{\\sqrt{3}}{\\sqrt{2}}\n\\end{pmatrix}.\n$$\n\n接下来计算 $Q^{T} b$。首先，\n$$\nq_{1}^{T} b \\;=\\; \\begin{pmatrix}1/\\sqrt{2}  1/\\sqrt{2}  0  0\\end{pmatrix} \\begin{pmatrix}2\\\\1\\\\0\\\\0\\end{pmatrix} \\;=\\; \\tfrac{3}{\\sqrt{2}}.\n$$\n同样地，\n$$\nq_{2}^{T} b \\;=\\; \\frac{u_{2}^{T} b}{r_{22}} \\;=\\; \\frac{\\begin{pmatrix}1/2  -1/2  1  0\\end{pmatrix} \\begin{pmatrix}2\\\\1\\\\0\\\\0\\end{pmatrix}}{r_{22}} \\;=\\; \\frac{1 - \\tfrac{1}{2} + 0}{\\tfrac{\\sqrt{3}}{\\sqrt{2}}} \\;=\\; \\frac{\\tfrac{1}{2}}{\\tfrac{\\sqrt{3}}{\\sqrt{2}}} \\;=\\; \\frac{\\sqrt{2}}{2 \\sqrt{3}} \\;=\\; \\frac{1}{\\sqrt{6}}.\n$$\n因此，\n$$\nQ^{T} b \\;=\\; \\begin{pmatrix} \\frac{3}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{6}} \\end{pmatrix}.\n$$\n\n根据前面推导的刻画，最小化子 $x_{\\star}$ 满足 $R x_{\\star} = Q^{T} b$。求解该上三角系统，\n$$\n\\frac{\\sqrt{3}}{\\sqrt{2}} \\, x_{2} \\;=\\; \\frac{1}{\\sqrt{6}} \\;\\;\\Rightarrow\\;\\; x_{2} \\;=\\; \\frac{1}{3},\n$$\n和\n$$\n\\sqrt{2} \\, x_{1} \\;+\\; \\frac{1}{\\sqrt{2}} \\, x_{2} \\;=\\; \\frac{3}{\\sqrt{2}}\n\\;\\;\\Rightarrow\\;\\;\nx_{1} \\;=\\; \\frac{\\tfrac{3}{\\sqrt{2}} - \\tfrac{1}{\\sqrt{2}} \\cdot \\tfrac{1}{3}}{\\sqrt{2}} \n\\;=\\; \\frac{4}{3}.\n$$\n\n最后，最小平方残差为\n$$\n\\|\\,b - A x_{\\star}\\,\\|_{2}^{2} \\;=\\; \\|\\,b\\,\\|_{2}^{2} \\;-\\; \\|\\,Q^{T} b\\,\\|_{2}^{2} \\;=\\; \\left(2^{2} + 1^{2}\\right) \\;-\\; \\left(\\left(\\tfrac{3}{\\sqrt{2}}\\right)^{2} + \\left(\\tfrac{1}{\\sqrt{6}}\\right)^{2}\\right)\n\\;=\\; 5 \\;-\\; \\left(\\tfrac{9}{2} + \\tfrac{1}{6}\\right)\n\\;=\\; 5 \\;-\\; \\tfrac{14}{3}\n\\;=\\; \\tfrac{1}{3}.\n$$\n因此，目标函数 $\\min_{x \\in \\mathbb{R}^{2}} \\|\\,b - A x\\,\\|_{2}^{2}$ 的精确最小值为 $\\tfrac{1}{3}$。",
            "answer": "$$\\boxed{\\tfrac{1}{3}}$$"
        },
        {
            "introduction": "求出最小二乘解后，一个自然而关键的问题是：解是否唯一？答案取决于矩阵 $A$ 的秩，这直接关系到其列向量的线性相关性。本练习  将从正交性原理出发，引导你推导出著名的“正规方程”，并运用它来刻画整个解集。通过分析秩亏情况下解集的维度，你将深刻理解为何满秩是保证最小二乘解唯一的充要条件。",
            "id": "3590981",
            "problem": "设 $A \\in \\mathbb{R}^{n \\times m}$ 且 $b \\in \\mathbb{R}^{n}$。考虑最小化平方欧几里得范数 $x \\mapsto \\|A x - b\\|_{2}^{2}$（其中 $x \\in \\mathbb{R}^{m}$）的最小二乘问题。从最小二乘法的基本定义（即在 $A$ 的列空间中寻找一个与 $b$ 在欧几里得范数下最接近的点）以及有限维内积空间中子空间投影的正交性原理出发，完成以下任务：\n\n- 推导 $x^{\\star}$ 成为最小二乘最小化解的必要充分最优性条件，该条件用残差与 $A$ 的列空间的正交性来表示，并用它将整个最小化解集刻画为 $\\mathbb{R}^{m}$ 的一个仿射子空间。\n\n- 根据线性代数的基本原理，确定使最小二乘最小化解唯一的关于 $A$ 的必要充分秩条件。\n\n- 将你的刻画应用于 $A \\in \\mathbb{R}^{7 \\times 5}$ 且 $\\operatorname{rank}(A)=3$ 的特例，并计算对于任意 $b \\in \\mathbb{R}^{7}$，最小二乘最小化解集的维数。\n\n将你在特例中计算出的维数作为最终答案。无需四舍五入。最终答案应为一个实数。",
            "solution": "该问题要求推导最小二乘解集的性质、其唯一性的条件，并计算在特定情况下该解集的维数。我们将从概述的基本原理出发，依次解决每个部分。\n\n设 $A \\in \\mathbb{R}^{n \\times m}$ 且 $b \\in \\mathbb{R}^{n}$。最小二乘问题旨在找到一个向量 $x^{\\star} \\in \\mathbb{R}^{m}$，以最小化残差的平方欧几里得范数 $f(x) = \\|Ax - b\\|_{2}^{2}$。对于所有 $x \\in \\mathbb{R}^{m}$，形式为 $Ax$ 的向量集合构成了 $A$ 的列空间，记为 $\\operatorname{col}(A)$，它是 $\\mathbb{R}^{n}$ 的一个子空间。因此，该问题等价于在 $\\operatorname{col}(A)$ 中寻找一个在欧几里得距离下与 $b$ 最接近的向量 $p$。一旦找到这样的 $p$，任何满足 $Ax^{\\star} = p$ 的 $x^{\\star}$ 都是一个最小二乘最小化解。\n\n根据有限维内积空间中的正交性原理（也称为投影定理），一个向量 $p \\in \\operatorname{col}(A)$ 是与 $b$ 唯一的最近点，当且仅当误差向量 $b-p$ 与子空间 $\\operatorname{col}(A)$ 正交。\n\n**最优性条件与解集的刻画**\n\n设 $x^{\\star}$ 是一个最小二乘最小化解。那么向量 $p = Ax^{\\star}$ 是 $b$ 到 $\\operatorname{col}(A)$ 上的正交投影。正交性原理指出，残差向量 $r = b - Ax^{\\star}$ 必须与 $\\operatorname{col}(A)$ 中的每一个向量正交。这意味着 $r$ 与 $\\operatorname{col}(A)$ 中任意向量 $y$ 的内积必须为零。\n$A$ 的列向量 $a_1, a_2, \\ldots, a_m$ 构成了 $\\operatorname{col}(A)$ 的一个生成集。因此，$r$ 与 $\\operatorname{col}(A)$ 正交的条件等价于 $r$ 与 $A$ 的每一列正交：\n$$a_j^{T} (b - Ax^{\\star}) = 0 \\quad \\text{for all } j = 1, 2, \\ldots, m$$\n这 $m$ 个方程可以组合成一个单一的矩阵方程。$A^T$ 的行是 $A$ 的列的转置。因此，该方程组等价于：\n$$A^{T}(b - Ax^{\\star}) = 0$$\n整理这个方程可得到**正规方程** (normal equations)：\n$$A^{T}A x^{\\star} = A^{T}b$$\n这就是 $x^{\\star}$ 成为最小二乘最小化解的必要充分最优性条件。所有最小化解的集合恰好是这个线性方程组的解集。\n\n任何线性系统 $Kx=c$（这里 $K=A^TA$ 且 $c=A^Tb$）的解集是一个仿射子空间。如果存在一个特解 $x_p$，则通解由 $x = x_p + x_h$ 给出，其中 $x_h$ 是对应齐次系统 $Kx_h=0$ (即 $A^T A x_h = 0$) 的任意解。所有这些 $x_h$ 的集合构成了 $A^T A$ 的零空间，记为 $\\operatorname{null}(A^T A)$。\n\n线性代数中的一个基本结论是 $\\operatorname{null}(A^T A) = \\operatorname{null}(A)$。\n证明如下：\n1.  设 $x \\in \\operatorname{null}(A)$。则 $Ax=0$。左乘 $A^T$ 得到 $A^T(Ax) = A^T(0)$，这意味着 $A^T A x = 0$。因此 $x \\in \\operatorname{null}(A^T A)$。所以，$\\operatorname{null}(A) \\subseteq \\operatorname{null}(A^T A)$。\n2.  设 $x \\in \\operatorname{null}(A^T A)$。则 $A^T A x = 0$。左乘 $x^T$ 得到 $x^T A^T A x = 0$。这可以写成 $(Ax)^T(Ax) = \\|Ax\\|_{2}^{2} = 0$。一个向量的范数为零当且仅当该向量本身是零向量。因此，$Ax=0$，这意味着 $x \\in \\operatorname{null}(A)$。所以，$\\operatorname{null}(A^T A) \\subseteq \\operatorname{null}(A)$。\n结合两个包含关系，我们得到 $\\operatorname{null}(A^T A) = \\operatorname{null}(A)$。\n\n因此，所有最小二乘最小化解的集合是仿射子空间 $x_p + \\operatorname{null}(A)$，其中 $x_p$ 是正规方程 $A^T A x = A^T b$ 的任意一个特解。\n\n**唯一最小化解的条件**\n\n最小二乘最小化解是唯一的，当且仅当正规方程的解集只包含一个向量。根据我们上面的刻画，这发生当且仅当零空间 $\\operatorname{null}(A)$ 只包含零向量，即 $\\operatorname{null}(A) = \\{0\\}$。\n\n一个矩阵 $A \\in \\mathbb{R}^{n \\times m}$ 具有平凡零空间，当且仅当它的列是线性无关的。线性无关列的数量就是矩阵的秩。要使 $A$ 的 $m$ 个列线性无关，秩必须等于列数。\n因此，最小二乘最小化解唯一的必要充分条件是 $\\operatorname{rank}(A) = m$。这也被称为 $A$ 具有满列秩。\n\n**特例：维数计算**\n\n我们给定一个矩阵 $A \\in \\mathbb{R}^{7 \\times 5}$，其秩 $\\operatorname{rank}(A) = 3$。这里，行数 $n=7$，列数 $m=5$。\n所有最小二乘最小化解的集合是仿射子空间 $x_p + \\operatorname{null}(A)$。仿射子空间的维数定义为其关联向量子空间的维数，在本例中即为 $\\operatorname{null}(A)$ 的维数。所以，我们需要计算 $\\dim(\\operatorname{null}(A))$。\n\n对于一个矩阵 $A \\in \\mathbb{R}^{n \\times m}$，秩-零度定理表明：\n$$\\operatorname{rank}(A) + \\dim(\\operatorname{null}(A)) = m$$\n我们已知 $\\operatorname{rank}(A) = 3$ 且 $m=5$。将这些值代入定理中：\n$$3 + \\dim(\\operatorname{null}(A)) = 5$$\n求解零空间的维数：\n$$\\dim(\\operatorname{null}(A)) = 5 - 3 = 2$$\n因此，对于这个特定情况，最小二乘最小化解集的维数是 $2$。这意味着解在 $\\mathbb{R}^{5}$ 中构成一个二维平面。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在实际应用中，测量数据 $b$ 总是存在误差。理解这些微小扰动如何影响最小二乘问题的结果至关重要，这引出了“条件数”的概念。本练习  独辟蹊径，聚焦于残差向量 $r(b) = b - A x(b)$ 对 $b$ 中扰动的敏感性。你将推导出残差的绝对和相对条件数，并揭示其与向量 $b$ 和矩阵 $A$ 列空间之间夹角 $\\theta$ 的深刻几何联系，即 $\\kappa_{\\mathrm{rel}}(A,b) = 1/\\sin(\\theta)$。",
            "id": "3591010",
            "problem": "考虑超定线性系统，其矩阵为 $A \\in \\mathbb{R}^{m \\times n}$（$m  n$，满列秩），数据向量为 $b \\in \\mathbb{R}^{m}$。最小二乘解 $x(b)$ 满足一阶最优性条件 $A^{\\top}(A x(b) - b) = 0$，残差为 $r(b) = b - A x(b)$。将残差视为一个映射 $b \\mapsto r(b)$ 的输出，其中 $A$ 是固定的。\n\n1. 仅从最优性条件 $A^{\\top}(A x(b) - b) = 0$ 和正交投影算子的基本性质出发，推导用 $\\operatorname{range}(A)$ 上的正交投影算子表示的 $r(b)$ 表达式，并利用它得到由固定 $A$ 下的扰动 $\\Delta b$ 引起的 $\\|\\Delta r\\|_{2}$ 的紧界。你的界必须用 $\\|\\Delta b\\|_{2}$ 表示，并且必须指明使得等号成立的扰动 $\\Delta b$。\n\n2. 定义残差关于 $b$ 在 $(A,b)$ 处的绝对和相对条件数为\n$$\n\\kappa_{\\mathrm{abs}}(A,b) \\coloneqq \\left\\| D r(b) \\right\\|_{2}, \n\\quad \n\\kappa_{\\mathrm{rel}}(A,b) \\coloneqq \\lim_{\\varepsilon \\to 0^{+}} \\ \\sup_{\\|\\Delta b\\|_{2} \\le \\varepsilon \\|b\\|_{2}} \\ \\frac{\\|r(b + \\Delta b) - r(b)\\|_{2}/\\|r(b)\\|_{2}}{\\|\\Delta b\\|_{2}/\\|b\\|_{2}} ,\n$$\n其中 $D r(b)$ 表示残差映射在 $b$ 处的 Fréchet 导数。推导 $\\kappa_{\\mathrm{abs}}(A,b)$ 和 $\\kappa_{\\mathrm{rel}}(A,b)$ 的闭式表达式，并解释各自的几何意义。\n\n3. 计算最小二乘残差的三种标准算法是：\n   (a) 正规方程法：通过求解 $A^{\\top} A \\widehat{x}_{\\mathrm{N}} = A^{\\top} b$ 来计算 $\\widehat{x}_{\\mathrm{N}}$，然后形成 $r_{\\mathrm{N}} = b - A \\widehat{x}_{\\mathrm{N}}$。\n   (b) 正交三角（QR）分解法：计算一个瘦 QR 分解 $A = Q R$，其中 $Q \\in \\mathbb{R}^{m \\times n}$ 具有标准正交列，然后形成 $r_{\\mathrm{Q}} = (I - Q Q^{\\top}) b$。\n   (c) 奇异值分解（SVD）法：计算 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 是正交的，并形成 $r_{\\mathrm{S}} = U_{2} U_{2}^{\\top} b$，其中 $U_{2} \\in \\mathbb{R}^{m \\times (m-n)}$ 张成 $\\operatorname{range}(A)$ 的正交补。\n在精确算術下，解释第2部分中的残差条件数在这些算法之间如何比较，并證明你的结论。\n\n4. 对于给定的数据\n$$\nA = \\begin{pmatrix}\n\\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{3}}  -\\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{3}}  0\n\\end{pmatrix},\n\\qquad\nb = \\begin{pmatrix}\n1 \\\\\n1 \\\\\n0.9999995\n\\end{pmatrix},\n$$\n计算第3部分中公共的残差相对条件数 $\\kappa_{\\mathrm{rel}}(A,b)$ 的数值。将你的答案四舍五入到六位有效数字。不涉及物理单位。",
            "solution": "### 第1部分：残差和扰动界的推导\n\n最小二乘解 $x(b)$ 使得 $\\|Ax - b\\|_{2}$ 最小化。一阶最优性条件由正规方程给出：\n$$\nA^{\\top}(A x(b) - b) = 0\n$$\n由于 $A \\in \\mathbb{R}^{m \\times n}$ 具有满列秩（$n$），矩阵 $A^{\\top} A \\in \\mathbb{R}^{n \\times n}$ 是对称正定的，因此是可逆的。我们可以解出 $x(b)$：\n$$\nA^{\\top} A x(b) = A^{\\top} b \\implies x(b) = (A^{\\top} A)^{-1} A^{\\top} b\n$$\n表达式 $(A^{\\top} A)^{-1} A^{\\top}$ 是 $A$ 的 Moore-Penrose 伪逆，记作 $A^{\\dagger}$。\n\n残差向量 $r(b)$ 定义为 $r(b) = b - A x(b)$。代入 $x(b)$ 的表达式：\n$$\nr(b) = b - A \\left( (A^{\\top} A)^{-1} A^{\\top} \\right) b\n$$\n让我们定义矩阵 $P_A = A (A^{\\top} A)^{-1} A^{\\top}$。这个矩阵是到 $A$ 的列空间 $\\operatorname{range}(A)$ 上的正交投影算子。因此，残差可以表示为：\n$$\nr(b) = (I - P_A) b\n$$\n矩阵 $I - P_A$ 是到 $\\operatorname{range}(A)$ 的正交补空间上的正交投影算子，也就是 $A^{\\top}$ 的零空间，记作 $\\operatorname{null}(A^{\\top})$。映射 $b \\mapsto r(b)$ 是一个由矩阵 $I - P_A$ 定义的线性变换。\n\n现在，考虑数据向量 $b$ 中的一个扰动 $\\Delta b$。新的数据向量是 $b + \\Delta b$。相应的残差是 $r(b + \\Delta b)$。残差的变化量 $\\Delta r$ 是：\n$$\n\\Delta r = r(b + \\Delta b) - r(b) = (I - P_A)(b + \\Delta b) - (I - P_A)b\n$$\n由于映射的线性性，这可以简化为：\n$$\n\\Delta r = (I - P_A) \\Delta b\n$$\n为了找到 $\\|\\Delta r\\|_{2}$ 的界，我们取两边的向量 $2$-范数：\n$$\n\\|\\Delta r\\|_{2} = \\|(I - P_A) \\Delta b\\|_{2}\n$$\n根据诱导矩阵范数的定义，$\\|\\Delta r\\|_{2} \\le \\|I - P_A\\|_{2} \\|\\Delta b\\|_{2}$。矩阵 $I-P_A$ 是一个正交投影算子。任何非零正交投影算子的诱导 $2$-范数都是 $1$。由于 $m  n$，$\\operatorname{range}(A)$ 是 $\\mathbb{R}^m$ 的一个真子空间，所以 $I - P_A$ 不是零矩阵。因此，$\\|I - P_A\\|_{2} = 1$。这给出了上界：\n$$\n\\|\\Delta r\\|_{2} \\le \\|\\Delta b\\|_{2}\n$$\n等号 $\\|\\Delta r\\|_{2} = \\|\\Delta b\\|_{2}$ 成立当且仅当向量 $\\Delta b$ 完全位于 $I - P_A$ 投影到的子空间中。也就是说，当 $\\Delta b \\in \\operatorname{range}(I - P_A) = \\operatorname{null}(A^{\\top})$ 时。对于这样的 $\\Delta b$，我们有 $(I - P_A)\\Delta b = \\Delta b$。\n\n下界是 $\\|\\Delta r\\|_{2} \\ge 0$。等号 $\\|\\Delta r\\|_{2} = 0$ 成立当且仅当 $(I - P_A) \\Delta b = 0$。这发生在 $\\Delta b$ 位于投影算子 $I - P_A$ 的零空间中，即 $\\operatorname{null}(I - P_A) = \\operatorname{range}(A)$。\n\n总之，紧界是 $0 \\le \\|\\Delta r\\|_{2} \\le \\|\\Delta b\\|_{2}$。对于任何 $\\Delta b \\in \\operatorname{null}(A^{\\top})$，上界成立；对于任何 $\\Delta b \\in \\operatorname{range}(A)$，下界成立。\n\n### 第2部分：残差的条件数\n\n映射为 $r(b) = (I - P_A) b$。这是 $b$ 的一个线性函数。线性映射 $L(b) = M b$ 在任意点 $b$ 的 Fréchet 导数是矩阵 $M$ 本身。因此，残差映射 $r(b)$ 的导数是：\n$$\nD r(b) = I - P_A\n$$\n绝对条件数定义为 $\\kappa_{\\mathrm{abs}}(A,b) = \\| D r(b) \\|_{2}$。代入导数：\n$$\n\\kappa_{\\mathrm{abs}}(A,b) = \\|I - P_A\\|_{2} = 1\n$$\n$\\kappa_{\\mathrm{abs}}(A,b) = 1$ 的几何意义是残差映射是非扩张的。输入数据中大小为 $\\|\\Delta b\\|_2$ 的绝对扰动导致的残差绝对变化至多是相同的大小。这表明计算残差的问题在绝对意义上是良态的。\n\n相对条件数定义为：\n$$\n\\kappa_{\\mathrm{rel}}(A,b) \\coloneqq \\lim_{\\varepsilon \\to 0^{+}} \\ \\sup_{\\|\\Delta b\\|_{2} \\le \\varepsilon \\|b\\|_{2}} \\ \\frac{\\|r(b + \\Delta b) - r(b)\\|_{2}/\\|r(b)\\|_{2}}{\\|\\Delta b\\|_{2}/\\|b\\|_{2}}\n$$\n假设 $r(b) \\ne 0$。使用 $\\Delta r = r(b + \\Delta b) - r(b) = (I-P_A)\\Delta b$，我们可以将表达式重写为：\n$$\n\\kappa_{\\mathrm{rel}}(A,b) = \\frac{\\|b\\|_{2}}{\\|r(b)\\|_{2}} \\lim_{\\varepsilon \\to 0^{+}} \\ \\sup_{\\|\\Delta b\\|_{2} \\le \\varepsilon \\|b\\|_{2}} \\ \\frac{\\|(I - P_A)\\Delta b\\|_{2}}{\\|\\Delta b\\|_{2}}\n$$\n极限内的项是矩阵 $I-P_A$ 的诱导 $2$-范数的定义：\n$$\n\\sup_{\\Delta b \\ne 0} \\frac{\\|(I - P_A)\\Delta b\\|_{2}}{\\|\\Delta b\\|_{2}} = \\|I - P_A\\|_{2} = 1\n$$\n这个上确界与 $\\varepsilon$ 和 $\\|\\Delta b\\|_2$ 无关。因此，相对条件数的闭式表达式是：\n$$\n\\kappa_{\\mathrm{rel}}(A,b) = \\frac{\\|b\\|_{2}}{\\|r(b)\\|_{2}} = \\frac{\\|b\\|_{2}}{\\|(I - P_A) b\\|_{2}}\n$$\n至于几何意义，考虑向量 $b$ 与子空间 $\\operatorname{range}(A)$ 之間的夹角 $\\theta$。向量 $P_A b$ 是 $b$ 到 $\\operatorname{range}(A)$ 上的正交投影，而 $r(b) = b - P_A b$ 是 $b$ 正交于 $\\operatorname{range}(A)$ 的分量。在由 $b$、$P_A b$ 和 $r(b)$ 构成的直角三角形中，我们有：\n$$\n\\sin(\\theta) = \\frac{\\|r(b)\\|_{2}}{\\|b\\|_{2}}\n$$\n因此，相对条件数为：\n$$\n\\kappa_{\\mathrm{rel}}(A,b) = \\frac{1}{\\sin(\\theta)}\n$$\n这意味着相对条件数是数据向量 $b$ 与 $A$ 的列空间之间夹角的余割。如果 $b$ 几乎在 $\\operatorname{range}(A)$ 中，则夹角 $\\theta$ 很小，$\\sin(\\theta)$ 也很小，$\\kappa_{\\mathrm{rel}}(A,b)$ 就会变得非常大。这表明当残差本身与数据向量相比很小时，计算残差的问题在相对意义上是病态的。\n\n### 第3部分：精确算术下算法的比较\n\n问题要求在“精确算术”的约束下，比较三种不同算法的残差条件数。条件数 $\\kappa_{\\mathrm{abs}}(A,b)$ 和 $\\kappa_{\\mathrm{rel}}(A,b)$ 是数学映射 $b \\mapsto r(b)$ 的性质，而不是用于计算它的算法的性质。在精确算术中，所有有效的算法都必须计算出完全相同的数学结果。让我们对给定的三种方法进行验证。\n\n1.  **正规方程法 (N):** 解 $\\widehat{x}_{\\mathrm{N}}$ 从 $A^{\\top} A \\widehat{x}_{\\mathrm{N}} = A^{\\top} b$ 求得。这给出 $\\widehat{x}_{\\mathrm{N}} = (A^{\\top} A)^{-1} A^{\\top} b = A^{\\dagger} b$。残差为 $r_{\\mathrm{N}} = b - A \\widehat{x}_{\\mathrm{N}} = b - A A^{\\dagger} b = (I - P_A) b$。\n\n2.  **QR 分解法 (Q):** $A$ 的一个瘦 QR 分解给出 $A=QR$，其中 $Q \\in \\mathbb{R}^{m \\times n}$ 具有标准正交列，$R \\in \\mathbb{R}^{n \\times n}$ 是上三角矩阵。由于 $Q$ 的列构成了 $\\operatorname{range}(A)$ 的一个标准正交基，投影算子 $P_A$ 由 $P_A = Q Q^{\\top}$ 给出。残差计算为 $r_{\\mathrm{Q}} = (I - Q Q^{\\top}) b = (I - P_A) b$。\n\n3.  **奇异值分解法 (SVD):** $A$ 的完整 SVD 为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 是正交的。我们可以将 $U$ 分块为 $U = \\begin{pmatrix} U_1  U_2 \\end{pmatrix}$，其中 $U_1 \\in \\mathbb{R}^{m \\times n}$，$U_2 \\in \\mathbb{R}^{m \\times (m-n)}$。$U_1$ 的列构成了 $\\operatorname{range}(A)$ 的一个标准正交基，而 $U_2$ 的列构成了其正交补空间 $\\operatorname{null}(A^\\top)$ 的一个标准正交基。到 $\\operatorname{range}(A)$ 上的投影算子是 $P_A = U_1 U_1^{\\top}$，到 $\\operatorname{null}(A^\\top)$ 上的投影算子是 $I - P_A = U_2 U_2^{\\top}$。残差计算为 $r_{\\mathrm{S}} = U_{2} U_{2}^{\\top} b = (I - P_A) b$。\n\n由于在精确算术下，这三种算法都计算出数学上完全相同的残差向量 $r(b) = (I-P_A)b$，它们都代表了完全相同的从 $b$ 到 $r(b)$ 的映射。条件数是这个映射的內在属性。因此，残差条件数 $\\kappa_{\\mathrm{abs}}(A,b)$ 和 $\\kappa_{\\mathrm{rel}}(A,b)$ 对于这三种算法是相同的。必须注意，这个结论只在精确算术下成立；在浮点算术中，这些算法的稳定性和准确性有显著差异。\n\n### 第4部分：数值计算\n\n我们给定的数据是：\n$$\nA = \\begin{pmatrix}\n\\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{3}}  -\\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{3}}  0\n\\end{pmatrix},\n\\qquad\nb = \\begin{pmatrix}\n1 \\\\ 1 \\\\ 0.9999995\n\\end{pmatrix}\n$$\n我们需要计算 $\\kappa_{\\mathrm{rel}}(A,b) = \\frac{\\|b\\|_{2}}{\\|r(b)\\|_{2}}$。\n\n首先，我们分析矩阵 $A$。它的列是 $a_1 = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})^\\top$ 和 $a_2 = (1/\\sqrt{2}, -1/\\sqrt{2}, 0)^\\top$。\n我们计算它们的内积：$a_1^\\top a_2 = \\frac{1}{\\sqrt{6}}(1 - 1 + 0) = 0$。它们是正交的。\n我们计算它们的范数：$\\|a_1\\|_2^2 = \\frac{1}{3}(1+1+1)=1$ 和 $\\|a_2\\|_2^2 = \\frac{1}{2}(1+1+0)=1$。\n$A$ 的列是标准正交的。这意味着 $A$ 具有性质 $A^\\top A = I$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n到 $\\operatorname{range}(A)$ 上的投影算子简化为 $P_A = A(A^\\top A)^{-1} A^\\top = A I A^\\top = AA^\\top$。残差为 $r(b) = (I - P_A)b = (I - AA^\\top)b$。\n\n我们来计算 $r(b)$。使用几何解释更简单。$A$ 的列 $\\{a_1, a_2\\}$ 构成了 $\\operatorname{range}(A)$ 的一个标准正交基。与 $a_1, a_2$ 一起构成 $\\mathbb{R}^3$ 的标准正交基的第三个向量 $a_3$ 将张成 $\\operatorname{null}(A^\\top)$。我们可以通过叉积或观察找到 $a_3$。令 $u = (1,1,1)^\\top$ 和 $v = (1,-1,0)^\\top$。$u \\times v = (1, 1, -2)^\\top$。将此向量单位化得到 $a_3 = \\frac{1}{\\sqrt{6}}(1, 1, -2)^\\top$。\n到 $\\operatorname{null}(A^\\top)$ 上的投影算子是 $I-P_A = a_3 a_3^\\top$。因此，$r(b) = (a_3 a_3^\\top) b = a_3 (a_3^\\top b)$。\n\n令 $\\delta = 5 \\times 10^{-7}$，所以 $b = (1, 1, 1-\\delta)^\\top$。首先，计算投影标量 $a_3^\\top b$：\n$$\na_3^\\top b = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1  1  -2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1-\\delta \\end{pmatrix} = \\frac{1}{\\sqrt{6}}(1 + 1 - 2(1-\\delta)) = \\frac{1}{\\sqrt{6}}(2 - 2 + 2\\delta) = \\frac{2\\delta}{\\sqrt{6}}\n$$\n现在，计算残差向量 $r(b)$：\n$$\nr(b) = a_3 (a_3^\\top b) = \\frac{1}{\\sqrt{6}}\\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix} \\frac{2\\delta}{\\sqrt{6}} = \\frac{2\\delta}{6}\\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix} = \\frac{\\delta}{3}\\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix}\n$$\n接下来，计算范数 $\\|r(b)\\|_{2}$ 和 $\\|b\\|_{2}$。\n$$\n\\|r(b)\\|_{2} = \\left\\| \\frac{\\delta}{3}\\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix} \\right\\|_{2} = \\frac{\\delta}{3} \\sqrt{1^2 + 1^2 + (-2)^2} = \\frac{\\delta\\sqrt{6}}{3}\n$$\n$$\n\\|b\\|_{2}^2 = 1^2 + 1^2 + (1-\\delta)^2 = 2 + 1 - 2\\delta + \\delta^2 = 3 - 2\\delta + \\delta^2\n$$\n$$\n\\|b\\|_{2} = \\sqrt{3 - 2\\delta + \\delta^2}\n$$\n最后，计算相对条件数：\n$$\n\\kappa_{\\mathrm{rel}}(A,b) = \\frac{\\|b\\|_{2}}{\\|r(b)\\|_{2}} = \\frac{\\sqrt{3 - 2\\delta + \\delta^2}}{\\frac{\\delta\\sqrt{6}}{3}}\n$$\n代入 $\\delta = 5 \\times 10^{-7}$：\n$$\n\\|b\\|_2 = \\sqrt{3 - 2(5 \\times 10^{-7}) + (5 \\times 10^{-7})^2} = \\sqrt{2.99999900000025}\n$$\n$$\n\\|r(b)\\|_2 = \\frac{(5 \\times 10^{-7})\\sqrt{6}}{3}\n$$\n$$\n\\kappa_{\\mathrm{rel}}(A,b) = \\frac{\\sqrt{2.99999900000025}}{\\frac{5\\sqrt{6}}{3} \\times 10^{-7}}\n$$\n数值计算这个表达式：\n$\\|b\\|_2 \\approx 1.7320505200547$\n$\\|r(b)\\|_2 \\approx 4.0824829046386 \\times 10^{-7}$\n$$\n\\kappa_{\\mathrm{rel}}(A,b) \\approx \\frac{1.7320505200547}{4.0824829046386 \\times 10^{-7}} \\approx 4242639.9829\n$$\n四舍五入到六位有效数字，我们得到 $4.24264 \\times 10^6$。",
            "answer": "$$\n\\boxed{4.24264 \\times 10^{6}}\n$$"
        }
    ]
}