{
    "hands_on_practices": [
        {
            "introduction": "The core of the Householder QR algorithm is the sequential application of reflections. This first exercise focuses on the fundamental building block: constructing a single Householder reflector to introduce zeros into the first column of a matrix. By working through the construction for a specific vector , you will solidify your understanding of the geometry behind the reflection and the critical choice made to ensure numerical stability from the very first step.",
            "id": "3549693",
            "problem": "Consider the matrix $A \\in \\mathbb{R}^{3 \\times 3}$ given by\n$$\nA=\\begin{bmatrix}\n12  -51  4\\\\\n6  167  -68\\\\\n-4  24  -41\n\\end{bmatrix}.\n$$\nLet $a_{1} \\in \\mathbb{R}^{3}$ denote the first column of $A$. A Householder reflector is an orthogonal transformation that reflects vectors across a hyperplane, and in orthogonal-triangular (QR) factorization it is used to map a given nonzero vector to a scalar multiple of a coordinate basis vector. Starting only from the definition of an orthogonal reflector as a linear isometry that acts as the identity on a hyperplane and flips the orthogonal direction, construct the first Householder reflector $H \\in \\mathbb{R}^{3 \\times 3}$ that maps $a_{1}$ to a vector collinear with $e_{1} \\in \\mathbb{R}^{3}$ and produces zeros in the entries below the $(1,1)$ position upon left-multiplication of $A$. Choose the reflected length along $e_{1}$ to avoid catastrophic cancellation in the construction.\n\nRepresent your reflector in the compact form $H = I - \\tau v v^\\top$ with the convention $v_{1}=1$ and $v \\in \\mathbb{R}^{3}$. Determine:\n- the updated first column $H a_{1}$, and\n- the reflector parameters $\\tau$, $v_{2}$, and $v_{3}$\n\nin exact form. Provide your final answer as a single row vector\n$$\n\\begin{pmatrix}\n\\alpha  \\tau  v_{2}  v_{3}\n\\end{pmatrix},\n$$\nwhere $H a_{1} = \\begin{bmatrix}\\alpha \\\\ 0 \\\\ 0\\end{bmatrix}$. No rounding is required; report exact rational values where applicable.",
            "solution": "The problem is valid as it is a well-posed, scientifically grounded question within the domain of numerical linear algebra. It provides all necessary data and definitions for the construction of a specific Householder reflector, a standard and fundamental tool in numerical analysis.\n\nThe problem asks for the construction of a Householder reflector $H$ that transforms the first column of the given matrix $A$ into a vector aligned with the first standard basis vector $e_1$. Let $a_1$ be the first column of $A$.\nThe given matrix is\n$$\nA=\\begin{bmatrix}\n12  -51  4\\\\\n6  167  -68\\\\\n-4  24  -41\n\\end{bmatrix}.\n$$\nThe first column is the vector $a_1 = \\begin{bmatrix} 12 \\\\ 6 \\\\ -4 \\end{bmatrix}$.\n\nA Householder reflector is an orthogonal transformation, which means it is an isometry, preserving the Euclidean norm of vectors. The transformation maps $a_1$ to a vector $H a_1$ of the form $\\alpha e_1$, where $e_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$.\nDue to the isometry property, we must have $\\|H a_1\\|_2 = \\|a_1\\|_2$.\nCalculating the norm of $H a_1$:\n$$\n\\|H a_1\\|_2 = \\|\\alpha e_1\\|_2 = |\\alpha| \\|e_1\\|_2 = |\\alpha| \\sqrt{1^2 + 0^2 + 0^2} = |\\alpha|.\n$$\nCalculating the norm of $a_1$:\n$$\n\\|a_1\\|_2 = \\sqrt{12^2 + 6^2 + (-4)^2} = \\sqrt{144 + 36 + 16} = \\sqrt{196} = 14.\n$$\nThus, we must have $|\\alpha| = 14$, which implies $\\alpha = 14$ or $\\alpha = -14$.\n\nThe problem states that the choice of the reflected length should avoid catastrophic cancellation. This is a standard consideration in the numerical implementation of Householder transformations. The reflection vector, which we will denote as $u$, is constructed from the difference between the original vector $a_1$ and its image $\\alpha e_1$. Let the first component of $a_1$ be $a_{11} = 12$. The first component of $u$ would be $a_{11} - \\alpha$. To avoid the subtraction of nearly equal numbers, which would lead to a loss of precision, we choose the sign of $\\alpha$ to be opposite to the sign of $a_{11}$.\nSince $a_{11} = 12  0$, we choose $\\alpha  0$. Therefore, we select $\\alpha = -14$.\nThe updated first column is $H a_1 = -14 e_1 = \\begin{bmatrix} -14 \\\\ 0 \\\\ 0 \\end{bmatrix}$.\n\nThe Householder reflector $H$ that maps a vector $x$ to $y$ (where $\\|x\\|_2=\\|y\\|_2$) is given by $H = I - 2 \\frac{u u^{\\top}}{u^{\\top} u}$, where $u = x - y$. In our case, $x=a_1$ and $y=\\alpha e_1$.\nSo, the reflection vector $u$ is\n$$\nu = a_1 - \\alpha e_1 = \\begin{bmatrix} 12 \\\\ 6 \\\\ -4 \\end{bmatrix} - \\left(-14 \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}\\right) = \\begin{bmatrix} 12 \\\\ 6 \\\\ -4 \\end{bmatrix} + \\begin{bmatrix} 14 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 26 \\\\ 6 \\\\ -4 \\end{bmatrix}.\n$$\nThe problem specifies the reflector in the form $H = I - \\tau v v^{\\top}$ with the normalization convention $v_1=1$. The vector $v$ in this form must be proportional to the standard reflection vector $u$. Let $v = c u$ for some scalar $c$.\nThe first component of $u$ is $u_1 = 26$. To satisfy the condition $v_1=1$, we must have $c u_1 = 1$, which gives $c = \\frac{1}{u_1} = \\frac{1}{26}$.\nThus, the vector $v$ is\n$$\nv = \\frac{1}{26} u = \\frac{1}{26} \\begin{bmatrix} 26 \\\\ 6 \\\\ -4 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ \\frac{6}{26} \\\\ -\\frac{4}{26} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ \\frac{3}{13} \\\\ -\\frac{2}{13} \\end{bmatrix}.\n$$\nFrom this, we identify the components $v_2 = \\frac{3}{13}$ and $v_3 = -\\frac{2}{13}$.\n\nNow, we determine the parameter $\\tau$. Comparing the two forms of the reflector, $I - \\tau v v^{\\top} = I - 2 \\frac{u u^{\\top}}{u^{\\top}u}$, we find $\\tau v v^{\\top} = 2 \\frac{u u^{\\top}}{u^{\\top}u}$.\nSubstituting $u = \\frac{1}{c}v = 26v$, we get\n$$\n\\tau v v^{\\top} = 2 \\frac{(26v)(26v)^{\\top}}{(26v)^{\\top}(26v)} = 2 \\frac{26^2 v v^{\\top}}{26^2 v^{\\top}v} = \\frac{2 v v^{\\top}}{v^{\\top}v}.\n$$\nThis implies that $\\tau = \\frac{2}{v^{\\top}v} = \\frac{2}{\\|v\\|_2^2}$.\nLet's compute $\\|v\\|_2^2$:\n$$\n\\|v\\|_2^2 = v^{\\top}v = 1^2 + \\left(\\frac{3}{13}\\right)^2 + \\left(-\\frac{2}{13}\\right)^2 = 1 + \\frac{9}{169} + \\frac{4}{169} = 1 + \\frac{13}{169} = 1 + \\frac{1}{13} = \\frac{13}{13} + \\frac{1}{13} = \\frac{14}{13}.\n$$\nNow we can compute $\\tau$:\n$$\n\\tau = \\frac{2}{\\frac{14}{13}} = \\frac{2 \\cdot 13}{14} = \\frac{26}{14} = \\frac{13}{7}.\n$$\nThe required values are:\n$\\alpha = -14$\n$\\tau = \\frac{13}{7}$\n$v_2 = \\frac{3}{13}$\n$v_3 = -\\frac{2}{13}$\nThese are presented in the requested row vector format.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -14  \\frac{13}{7}  \\frac{3}{13}  -\\frac{2}{13} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A key to the efficiency of Householder QR factorization is that the reflector matrix $H$ is never explicitly formed. Instead, its compact representation $H = I - \\tau v v^{\\top}$ is used to apply the transformation via a computationally cheaper rank-1 update. This practice  provides hands-on experience with this crucial technique, contrasting the efficient method with the direct (and more costly) matrix multiplication to see the principle in action.",
            "id": "3549690",
            "problem": "Let $A \\in \\mathbb{R}^{3 \\times 2}$ be used in the construction of an orthogonal-triangular (QR) factorization via Householder reflectors. A Householder reflector is defined by $H = I - \\tau v v^\\top$ for a vector $v \\in \\mathbb{R}^{3}$ and a scalar $\\tau \\in \\mathbb{R}$ chosen so that $H$ is orthogonal and symmetric. Starting from this definition and basic properties of matrix multiplication, derive an expression for $HA$ in terms of $v$, $\\tau$, and $A$ that avoids explicitly forming $H$, and use it to compute $HA$ for \n$$\nv = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix}, \\quad \\tau = \\frac{2}{5}, \\quad A = \\begin{bmatrix}1  0 \\\\ 2  1 \\\\ 0  1\\end{bmatrix}.\n$$\nThen, independently form $H$ from $v$ and $\\tau$ and confirm that the explicit product $HA$ matches the previously obtained result. Finally, report the Frobenius norm $\\|HA\\|_{F}$ in exact form as your single final answer. No rounding is required, and no units are involved.",
            "solution": "The user wants me to solve a problem on the application of a Householder reflector.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- The matrix to be transformed is $A \\in \\mathbb{R}^{3 \\times 2}$.\n- A Householder reflector is defined as $H = I - \\tau v v^{\\top}$, where $I$ is the identity matrix, $v \\in \\mathbb{R}^{3}$ is a vector, and $\\tau \\in \\mathbb{R}$ is a scalar.\n- It is given that $H$ is orthogonal and symmetric.\n- The specific values for the parameters are:\n$$\nv = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix}, \\quad \\tau = \\frac{2}{5}, \\quad A = \\begin{bmatrix}1  0 \\\\ 2  1 \\\\ 0  1\\end{bmatrix}\n$$\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Groundedness:** The problem statement is based on standard, well-established concepts in numerical linear algebra, specifically the Householder transformation used in QR factorization. The definition of a Householder reflector is correct. The condition for orthogonality is that $\\tau = \\frac{2}{v^{\\top}v}$. For the given vector $v$, we have $v^{\\top}v = (1)^2 + (2)^2 + (0)^2 = 1+4=5$. Thus, the required value for $\\tau$ is $\\frac{2}{5}$, which matches the given value. The problem is internally consistent and scientifically sound.\n- **Well-Posedness:** The tasks are clear: derive an expression, compute a matrix product in two ways to confirm consistency, and then compute a norm. All quantities are well-defined, and a unique, stable solution exists.\n- **Objectivity:** The problem is stated in precise mathematical language with no subjective or ambiguous terms.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the detailed solution.\n\n### Solution\n\nThe problem is divided into several parts. First, we must derive an expression for the product $HA$ that avoids the explicit formation of the matrix $H$. Second, we apply this expression to compute $HA$ for the given data. Third, we explicitly form $H$ and compute $HA$ to verify the result. Finally, we compute the Frobenius norm of the resulting matrix.\n\n**Part 1: Derivation of the efficient application of a Householder reflector**\n\nWe are given the definition of a Householder reflector $H = I - \\tau v v^{\\top}$, where $I$ is the identity matrix of appropriate size (in this case, $3 \\times 3$), $v \\in \\mathbb{R}^3$, and $\\tau \\in \\mathbb{R}$. We want to compute the product $HA$ without first forming the matrix $H$.\n\nUsing the distributive property of matrix multiplication, we have:\n$$\nHA = (I - \\tau v v^{\\top})A = IA - (\\tau v v^{\\top})A\n$$\nSince $IA = A$ and $\\tau$ is a scalar, we can change the order of scalar multiplication:\n$$\nHA = A - \\tau (v v^{\\top})A\n$$\nUsing the associative property of matrix multiplication, we can group the terms as follows:\n$$\nHA = A - \\tau v (v^{\\top}A)\n$$\nThis is the desired expression. This form is computationally more efficient than forming the dense matrix $H$ and then performing a full matrix-matrix multiplication. The term $v^{\\top}A$ is a product of a $1 \\times 3$ matrix and a $3 \\times 2$ matrix, resulting in a $1 \\times 2$ row vector, let's call it $w^{\\top}$. The expression then becomes $HA = A - \\tau v w^{\\top}$, which is the original matrix $A$ updated by a rank-$1$ matrix.\n\n**Part 2: Computation of $HA$ using the derived expression**\n\nWe are given:\n$$\nv = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix}, \\quad \\tau = \\frac{2}{5}, \\quad A = \\begin{bmatrix}1  0 \\\\ 2  1 \\\\ 0  1\\end{bmatrix}\n$$\nFirst, we compute the row vector $w^{\\top} = v^{\\top}A$:\n$$\nw^{\\top} = \\begin{bmatrix}1  2  0\\end{bmatrix} \\begin{bmatrix}1  0 \\\\ 2  1 \\\\ 0  1\\end{bmatrix} = \\begin{bmatrix}(1)(1) + (2)(2) + (0)(0)  (1)(0) + (2)(1) + (0)(1)\\end{bmatrix}\n$$\n$$\nw^{\\top} = \\begin{bmatrix}1+4  0+2\\end{bmatrix} = \\begin{bmatrix}5  2\\end{bmatrix}\n$$\nNow we compute the outer product $v w^{\\top}$:\n$$\nv w^{\\top} = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix} \\begin{bmatrix}5  2\\end{bmatrix} = \\begin{bmatrix}(1)(5)  (1)(2) \\\\ (2)(5)  (2)(2) \\\\ (0)(5)  (0)(2)\\end{bmatrix} = \\begin{bmatrix}5  2 \\\\ 10  4 \\\\ 0  0\\end{bmatrix}\n$$\nFinally, we compute $HA = A - \\tau v w^{\\top}$:\n$$\nHA = \\begin{bmatrix}1  0 \\\\ 2  1 \\\\ 0  1\\end{bmatrix} - \\frac{2}{5} \\begin{bmatrix}5  2 \\\\ 10  4 \\\\ 0  0\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 2  1 \\\\ 0  1\\end{bmatrix} - \\begin{bmatrix}\\frac{10}{5}  \\frac{4}{5} \\\\ \\frac{20}{5}  \\frac{8}{5} \\\\ 0  0\\end{bmatrix}\n$$\n$$\nHA = \\begin{bmatrix}1  0 \\\\ 2  1 \\\\ 0  1\\end{bmatrix} - \\begin{bmatrix}2  \\frac{4}{5} \\\\ 4  \\frac{8}{5} \\\\ 0  0\\end{bmatrix} = \\begin{bmatrix}1 - 2  0 - \\frac{4}{5} \\\\ 2 - 4  1 - \\frac{8}{5} \\\\ 0 - 0  1 - 0\\end{bmatrix} = \\begin{bmatrix}-1  -\\frac{4}{5} \\\\ -2  -\\frac{3}{5} \\\\ 0  1\\end{bmatrix}\n$$\n\n**Part 3: Explicit computation of $HA$ for verification**\n\nFirst, we explicitly form the Householder matrix $H = I - \\tau v v^{\\top}$. We need the outer product $v v^{\\top}$:\n$$\nv v^{\\top} = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix} \\begin{bmatrix}1  2  0\\end{bmatrix} = \\begin{bmatrix}1  2  0 \\\\ 2  4  0 \\\\ 0  0  0\\end{bmatrix}\n$$\nNow we form $H$:\n$$\nH = I_3 - \\frac{2}{5} v v^{\\top} = \\begin{bmatrix}1  0  0 \\\\ 0  1  0 \\\\ 0  0  1\\end{bmatrix} - \\frac{2}{5} \\begin{bmatrix}1  2  0 \\\\ 2  4  0 \\\\ 0  0  0\\end{bmatrix}\n$$\n$$\nH = \\begin{bmatrix}1  0  0 \\\\ 0  1  0 \\\\ 0  0  1\\end{bmatrix} - \\begin{bmatrix}\\frac{2}{5}  \\frac{4}{5}  0 \\\\ \\frac{4}{5}  \\frac{8}{5}  0 \\\\ 0  0  0\\end{bmatrix} = \\begin{bmatrix}1 - \\frac{2}{5}  -\\frac{4}{5}  0 \\\\ -\\frac{4}{5}  1 - \\frac{8}{5}  0 \\\\ 0  0  1\\end{bmatrix} = \\begin{bmatrix}\\frac{3}{5}  -\\frac{4}{5}  0 \\\\ -\\frac{4}{5}  -\\frac{3}{5}  0 \\\\ 0  0  1\\end{bmatrix}\n$$\nNow we compute the product $HA$ directly:\n$$\nHA = \\begin{bmatrix}\\frac{3}{5}  -\\frac{4}{5}  0 \\\\ -\\frac{4}{5}  -\\frac{3}{5}  0 \\\\ 0  0  1\\end{bmatrix} \\begin{bmatrix}1  0 \\\\ 2  1 \\\\ 0  1\\end{bmatrix}\n$$\n$$\nHA = \\begin{bmatrix} (\\frac{3}{5})(1) + (-\\frac{4}{5})(2)  (\\frac{3}{5})(0) + (-\\frac{4}{5})(1) \\\\ (-\\frac{4}{5})(1) + (-\\frac{3}{5})(2)  (-\\frac{4}{5})(0) + (-\\frac{3}{5})(1) \\\\ (0)(1) + (0)(2) + (1)(0)  (0)(0) + (0)(1) + (1)(1) \\end{bmatrix}\n$$\n$$\nHA = \\begin{bmatrix} \\frac{3 - 8}{5}  -\\frac{4}{5} \\\\ \\frac{-4 - 6}{5}  -\\frac{3}{5} \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} \\frac{-5}{5}  -\\frac{4}{5} \\\\ \\frac{-10}{5}  -\\frac{3}{5} \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} -1  -\\frac{4}{5} \\\\ -2  -\\frac{3}{5} \\\\ 0  1\\end{bmatrix}\n$$\nThis result matches the one obtained using the efficient method, confirming our calculations.\n\n**Part 4: Calculation of the Frobenius norm $\\|HA\\|_{F}$**\n\nThe Frobenius norm of a matrix $B$ with elements $b_{ij}$ is defined as $\\|B\\|_{F} = \\sqrt{\\sum_{i} \\sum_{j} |b_{ij}|^2}$. For our resulting matrix $HA$, we have:\n$$\nHA = \\begin{bmatrix} -1  -\\frac{4}{5} \\\\ -2  -\\frac{3}{5} \\\\ 0  1\\end{bmatrix}\n$$\nThe square of the Frobenius norm is the sum of the squares of its entries:\n$$\n\\|HA\\|_{F}^2 = (-1)^2 + \\left(-\\frac{4}{5}\\right)^2 + (-2)^2 + \\left(-\\frac{3}{5}\\right)^2 + (0)^2 + (1)^2\n$$\n$$\n\\|HA\\|_{F}^2 = 1 + \\frac{16}{25} + 4 + \\frac{9}{25} + 0 + 1\n$$\n$$\n\\|HA\\|_{F}^2 = (1 + 4 + 1) + \\left(\\frac{16}{25} + \\frac{9}{25}\\right) = 6 + \\frac{25}{25} = 6 + 1 = 7\n$$\nTherefore, the Frobenius norm is:\n$$\n\\|HA\\|_{F} = \\sqrt{7}\n$$\nAs a check, since $H$ is an orthogonal matrix, the Frobenius norm is preserved under multiplication by $H$. Let's compute the Frobenius norm of $A$:\n$$\n\\|A\\|_{F}^2 = (1)^2 + (0)^2 + (2)^2 + (1)^2 + (0)^2 + (1)^2 = 1 + 0 + 4 + 1 + 0 + 1 = 7\n$$\nThus, $\\|A\\|_{F} = \\sqrt{7}$. The fact that $\\|HA\\|_{F} = \\|A\\|_{F}$ serves as an independent confirmation of our result. The problem required computing $\\|HA\\|_F$ directly from the obtained matrix, which we have done.",
            "answer": "$$\\boxed{\\sqrt{7}}$$"
        },
        {
            "introduction": "Numerical algorithms live and die by their stability in finite-precision arithmetic. A seemingly correct formula in exact arithmetic can fail spectacularly when implemented on a computer. This exercise  challenges you to analyze a \"pathological\" case where a naive sign choice in the Householder vector construction leads to catastrophic cancellation, revealing why the standard, robust implementation is essential for accurate results.",
            "id": "3549703",
            "problem": "Consider the Householder orthogonal-triangular factorization (QR) of a matrix in floating-point arithmetic, where the Householder transform is built from a vector $x \\in \\mathbb{R}^{m}$ via the construction $v = x(\\epsilon) \\pm \\|x(\\epsilon)\\|_{2} e_1$ and the reflector is $H = I - 2 \\frac{v v^{\\top}}{v^{\\top} v}$. Let the machine arithmetic obey the standard floating-point model for addition and multiplication: for any two real numbers $a$ and $b$, the computed sum $\\operatorname{fl}(a \\pm b)$ satisfies $\\operatorname{fl}(a \\pm b) = (a \\pm b) (1 + \\delta)$ with $|\\delta| \\leq u$, and the computed product $\\operatorname{fl}(ab) = ab(1 + \\delta)$ with $|\\delta| \\leq u$, where $u$ is the unit roundoff.\n\nDesign a family of matrices $A(\\epsilon) \\in \\mathbb{R}^{m \\times 2}$, with $m \\geq 2$ and a parameter $\\epsilon  0$, whose first column is \n$$\nx(\\epsilon) = \\begin{pmatrix} -1 \\\\ \\epsilon \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix},\n$$\nand whose second column is any fixed vector $y \\in \\mathbb{R}^{m}$ orthogonal to $e_{1}$ (for definiteness, take $y = e_{2}$). In exact arithmetic, the first Householder step transforms $x(\\epsilon)$ into a vector proportional to $e_{1}$, yielding the leading entry of the upper-triangular factor $R$ equal to $\\pm \\|x(\\epsilon)\\|_{2}$.\n\nUsing the definitions above and starting from first principles of the Householder construction and the floating-point error model:\n- Show that the sign choice $v = x(\\epsilon) + \\|x(\\epsilon)\\|_{2} e_1$ causes catastrophic cancellation in the first component $v_{1}$ as $\\epsilon \\to 0$, whereas the sign choice $v = x(\\epsilon) + \\operatorname{sign}(x_1(\\epsilon)) \\|x(\\epsilon)\\|_{2} e_1$ avoids it.\n- Define the cancellation amplification factor when forming $v_{1}$ by\n$$\n\\kappa(\\epsilon) := \\frac{|x_1(\\epsilon)| + \\|x(\\epsilon)\\|_{2}}{|x_1(\\epsilon) + \\|x(\\epsilon)\\|_{2}|} ,\n$$\nwhich measures the magnification of relative error due to subtraction of nearly equal magnitudes. Derive the leading-order asymptotic expression for $\\kappa(\\epsilon)$ as $\\epsilon \\to 0$ for the catastrophic sign choice $v = x(\\epsilon) + \\|x(\\epsilon)\\|_{2} e_1$. \n- Briefly justify how the recommended sign choice $v = x(\\epsilon) + \\operatorname{sign}(x_1(\\epsilon)) \\|x(\\epsilon)\\|_{2} e_1$ mitigates the loss of relative accuracy in the downstream formation of $R$ in floating-point arithmetic.\n\nYour final answer must be the single closed-form asymptotic expression for $\\kappa(\\epsilon)$ as $\\epsilon \\to 0$. No rounding is required.",
            "solution": "The problem statement is critically validated.\n\n### Step 1: Extract Givens\n- The Householder reflector is $H = I - 2 \\frac{v v^{\\top}}{v^{\\top} v}$.\n- The Householder vector is constructed from $x \\in \\mathbb{R}^{m}$ via $v = x \\pm \\|x\\|_{2} e_{1}$.\n- The floating-point arithmetic model for operations $\\oplus, \\ominus, \\otimes$ satisfies $\\operatorname{fl}(a \\operatorname{op} b) = (a \\operatorname{op} b)(1 + \\delta)$ with $|\\delta| \\leq u$, where $u$ is the unit roundoff.\n- The matrix is $A(\\epsilon) \\in \\mathbb{R}^{m \\times 2}$ with $m \\geq 2$.\n- The first column of $A(\\epsilon)$ is $x(\\epsilon) = \\begin{pmatrix} -1 \\\\ \\epsilon \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix}$.\n- The second column of $A(\\epsilon)$ is $y = e_{2}$.\n- The cancellation amplification factor is defined as $\\kappa(\\epsilon) := \\frac{|x_{1}(\\epsilon)| + \\|x(\\epsilon)\\|_{2}}{|x_{1}(\\epsilon) + \\|x(\\epsilon)\\|_{2}|}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on established principles of numerical linear algebra, specifically the Householder QR factorization and standard models of floating-point error analysis. The issue of catastrophic cancellation is a canonical topic in numerical analysis. The premises are factually sound.\n- **Well-Posed**: The problem is well-posed. It asks for a demonstration, a derivation of a well-defined quantity, and a justification, all based on a clearly specified setup. A unique, meaningful solution exists.\n- **Objective**: The problem is stated in precise, objective, and formal mathematical language. It is free of subjective or opinion-based claims.\n- **Completeness and Consistency**: The problem is self-contained and provides all necessary definitions and data. There are no contradictions in the setup.\n- **No other flaws** (unrealistic, ill-posed, trivial, etc.) are present. This is a standard and important example illustrating the numerical subtleties of implementing Householder transformations.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution Derivation\nThe problem concerns the numerical stability of constructing a Householder vector for the first step of a QR factorization. We are given the first column of the matrix $A(\\epsilon)$ as\n$$\nx(\\epsilon) = \\begin{pmatrix} -1 \\\\ \\epsilon \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix} \\in \\mathbb{R}^{m}\n$$\nThe first component is $x_1(\\epsilon) = -1$. The Euclidean norm of this vector is\n$$\n\\|x(\\epsilon)\\|_{2} = \\sqrt{(-1)^2 + \\epsilon^2 + 0^2 + \\dots} = \\sqrt{1 + \\epsilon^2}\n$$\nThe Householder vector $v$ is constructed to transform $x(\\epsilon)$ into a vector parallel to $e_1$. The general construction is $v = x(\\epsilon) - \\alpha e_1$, where $\\alpha = \\pm \\|x(\\epsilon)\\|_2$. The numerically sound choice for $\\alpha$ is $-\\operatorname{sign}(x_1(\\epsilon))\\|x(\\epsilon)\\|_2$, so that the first component of $v$, $v_1 = x_1(\\epsilon) - \\alpha = x_1(\\epsilon) + \\operatorname{sign}(x_1(\\epsilon))\\|x(\\epsilon)\\|_2$, is a sum of two numbers of the same sign, avoiding catastrophic cancellation. The problem asks us to analyze two specific sign choices.\n\n**Analysis of Sign Choices and Catastrophic Cancellation**\n\nThe first task is to analyze the formation of the first component of the vector $v$, denoted $v_1$, for two different sign choices as $\\epsilon \\to 0$.\n\n1.  **Numerically Unstable Choice: $v = x(\\epsilon) + \\|x(\\epsilon)\\|_{2} e_{1}$**\n    The first component of this vector is\n    $$\n    v_1 = x_1(\\epsilon) + \\|x(\\epsilon)\\|_{2} = -1 + \\sqrt{1 + \\epsilon^2}\n    $$\n    As $\\epsilon \\to 0$, the term $\\sqrt{1 + \\epsilon^2}$ approaches $1$. This expression involves the subtraction of two nearly equal numbers. To see this more clearly, we use the Taylor expansion for $\\sqrt{1+z}$ around $z=0$, which is $\\sqrt{1+z} = 1 + \\frac{1}{2}z - \\frac{1}{8}z^2 + O(z^3)$. Setting $z = \\epsilon^2$, we get\n    $$\n    v_1 = -1 + \\left(1 + \\frac{1}{2}\\epsilon^2 - \\frac{1}{8}\\epsilon^4 + O(\\epsilon^6)\\right) = \\frac{1}{2}\\epsilon^2 - \\frac{1}{8}\\epsilon^4 + O(\\epsilon^6)\n    $$\n    For small $\\epsilon$, we are calculating a very small number, $O(\\epsilon^2)$, by subtracting two numbers close to $1$. In floating-point arithmetic, $\\operatorname{fl}(\\sqrt{1+\\epsilon^2})$ will have some rounding error. When $\\operatorname{fl}(-1 + \\operatorname{fl}(\\sqrt{1+\\epsilon^2}))$ is computed, the leading digits cancel, leading to a result with a large relative error. This phenomenon is known as catastrophic cancellation.\n\n2.  **Numerically Stable Choice: $v = x(\\epsilon) + \\operatorname{sign}(x_1(\\epsilon)) \\|x(\\epsilon)\\|_{2} e_{1}$**\n    Since $x_1(\\epsilon) = -1$, we have $\\operatorname{sign}(x_1(\\epsilon)) = -1$. The sign choice becomes a subtraction:\n    $$\n    v = x(\\epsilon) - \\|x(\\epsilon)\\|_{2} e_{1}\n    $$\n    The first component of this vector is\n    $$\n    v_1 = x_1(\\epsilon) - \\|x(\\epsilon)\\|_{2} = -1 - \\sqrt{1 + \\epsilon^2}\n    $$\n    As $\\epsilon \\to 0$, $v_1$ approaches $-1 - 1 = -2$. This computation involves the addition of two numbers of the same sign (or subtraction of numbers of opposite sign). This operation is numerically benign. The relative error in the floating-point result $\\operatorname{fl}(-1 - \\sqrt{1+\\epsilon^2})$ is small, on the order of the unit roundoff $u$. Catastrophic cancellation is avoided.\n\n**Derivation of the Cancellation Amplification Factor $\\kappa(\\epsilon)$**\n\nThe problem defines the cancellation amplification factor for the unstable sign choice as\n$$\n\\kappa(\\epsilon) := \\frac{|x_1(\\epsilon)| + \\|x(\\epsilon)\\|_{2}}{|x_1(\\epsilon) + \\|x(\\epsilon)\\|_{2}|}\n$$\nWe substitute the known quantities: $x_1(\\epsilon) = -1$ and $\\|x(\\epsilon)\\|_2 = \\sqrt{1 + \\epsilon^2}$.\nThe numerator is $|-1| + \\sqrt{1 + \\epsilon^2} = 1 + \\sqrt{1 + \\epsilon^2}$.\nThe denominator is $|-1 + \\sqrt{1 + \\epsilon^2}|$. Since $\\epsilon  0$, $\\sqrt{1+\\epsilon^2}  1$, so the term inside the absolute value is positive. Thus, the denominator is $\\sqrt{1 + \\epsilon^2} - 1$.\nThe expression for $\\kappa(\\epsilon)$ becomes\n$$\n\\kappa(\\epsilon) = \\frac{1 + \\sqrt{1 + \\epsilon^2}}{\\sqrt{1 + \\epsilon^2} - 1}\n$$\nTo find the leading-order asymptotic expression as $\\epsilon \\to 0$, we again use the Taylor expansion $\\sqrt{1 + \\epsilon^2} = 1 + \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)$.\nSubstituting this into the expression for $\\kappa(\\epsilon)$:\nNumerator: $1 + \\left(1 + \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)\\right) = 2 + \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)$. As $\\epsilon \\to 0$, the numerator approaches $2$.\nDenominator: $\\left(1 + \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)\\right) - 1 = \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)$. As $\\epsilon \\to 0$, the denominator approaches $0$.\nTherefore, the asymptotic behavior is determined by the ratio of the leading terms:\n$$\n\\kappa(\\epsilon) \\approx \\frac{2}{\\frac{1}{2}\\epsilon^2} = \\frac{4}{\\epsilon^2}\n$$\nThis demonstrates that the relative error amplification factor grows quadratically as $\\epsilon^{-2}$, which confirms that the cancellation is indeed catastrophic as $\\epsilon$ becomes small.\n\n**Justification for the Recommended Sign Choice**\n\nThe final task is to briefly justify how the recommended sign choice, $v = x(\\epsilon) + \\operatorname{sign}(x_{1}(\\epsilon)) \\|x(\\epsilon)\\|_{2} e_{1}$, mitigates the loss of relative accuracy in the formation of the upper-triangular factor $R$.\n\nThe numerical stability of the entire Householder transformation step depends critically on the accurate computation of the Householder vector $v$. The reflector is given by $H = I - 2 \\frac{v v^\\top}{v^\\top v}$. If $v$ is computed inaccurately due to catastrophic cancellation (as with the unstable sign choice), the resulting computed reflector, $\\hat{H}$, will have significant errors. Specifically, $\\hat{H}$ may fail to be orthogonal, and its application to the matrix $A$ will not correctly introduce zeros below the diagonal of the first column. This means the resulting matrix $\\hat{Q}_1 A$ will not be properly upper-triangular, and the computed value of the first diagonal entry of $R$, $R_{11}$, will be inaccurate.\n\nBy using the recommended sign choice, catastrophic cancellation in the formation of $v$ is avoided. This ensures that $v$, and consequently its squared norm $v^\\top v = 2\\|x(\\epsilon)\\|_2 (\\|x(\\epsilon)\\|_2 - x_1(\\epsilon))$ (for the stable case), are calculated with high relative accuracy. This leads to a computed reflector $\\hat{H}$ that is close to a true orthogonal matrix. Its application to $A$ robustly produces the desired structure (zeros below the diagonal) and yields an accurate factor $R$. Thus, the stability of the entire first step of the QR factorization hinges on this initial sign choice.",
            "answer": "$$\\boxed{\\frac{4}{\\epsilon^2}}$$"
        }
    ]
}