{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握完全正交分解（COF），没有什么比从头开始构建一个更好的方法了。本练习将指导您从第一性原理（如Gram-Schmidt正交化）出发，为一个小的秩亏矩阵具体构建其COF。通过显式地构造正交因子 $U$ 和 $V$，您将亲身体会到它们如何为与矩阵相关的四个基本子空间提供标准正交基。",
            "id": "3538260",
            "problem": "考虑矩阵 $A \\in \\mathbb{R}^{3 \\times 4}$，其形式如下\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  0  2  2 \\\\\n0  3  3  3 \\\\\n0  0  0  0\n\\end{pmatrix}.\n$$\n已知 $A$ 的秩为 $2$。请仅使用以下基础事实和定义作为依据，构建 $A$ 的完全正交分解 (complete orthogonal factorization, COF)：\n- 正交矩阵 $Q$ 满足 $Q^{\\top} Q = I$。\n- Givens 旋转作用于一对坐标，将向量的一个分量置零，同时保持其欧几里得长度不变。\n- Gram-Schmidt 正交化过程为一个给定向量集合的生成空间生成一个标准正交基。\n- 矩阵的秩等于其列空间的维数；$A$ 的零空间是 $A$ 的行空间在 $\\mathbb{R}^{4}$ 中的正交补；$A^{\\top}$ 的零空间是 $A$ 的列空间在 $\\mathbb{R}^{3}$ 中的正交补。\n\n你的任务是：\n1. 明确构造一个正交矩阵 $U \\in \\mathbb{R}^{3 \\times 3}$、一个正交矩阵 $V \\in \\mathbb{R}^{4 \\times 4}$ 和一个上块矩阵 $R$，使得 $U^{\\top} A V$ 的前 $r$ 行（其中 $r = \\mathrm{rank}(A)$）在主导的 $r \\times r$ 块中呈上三角形式，且其余 $(3-r)$ 行全为零。特别地，主导的 $2 \\times 2$ 块 $R_{11}$ 必须是上三角矩阵。\n2. 验证以下子空间关系：列空间 $\\mathrm{Range}(A)$ 等于 $U$ 的前 $r$ 列的生成空间，零空间 $\\mathrm{Null}(A)$ 等于 $V$ 的后 $4-r$ 列的生成空间，行空间 $\\mathrm{Range}(A^{\\top})$ 等于 $V$ 的前 $r$ 列的生成空间，以及 $A^{\\top}$ 的零空间 $\\mathrm{Null}(A^{\\top})$ 等于 $U$ 的后 $3-r$ 列的生成空间。\n3. 作为你最终报告的量，计算主导块 $R_{11}$ 的行列式，即 $\\det(R_{11})$。用精确值表示你的最终答案，无需四舍五入。\n\n你的构建和验证过程必须是自洽的，从上面列出的事实出发，并且不得调用任何关于完全正交分解的预先给定的目标公式。最终答案必须是单个实数值 $\\det(R_{11})$。",
            "solution": "我们首先确定 $A$ 的结构及其秩。$A$ 的列向量为\n$$\nc_{1} = \\begin{pmatrix} 2 \\\\ 0 \\\\ 0 \\end{pmatrix},\\quad\nc_{2} = \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix},\\quad\nc_{3} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 0 \\end{pmatrix},\\quad\nc_{4} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 0 \\end{pmatrix}.\n$$\n我们观察到 $c_{3} = c_{1} + c_{2}$ 且 $c_{4} = c_{1} + c_{2}$。由于 $c_1$ 和 $c_2$ 线性无关，且所有列向量都位于它们的生成空间中，因此我们有 $\\mathrm{rank}(A) = 2$。在 $\\mathbb{R}^{3}$ 中，列空间 $\\mathrm{Range}(A)$ 是 $\\mathrm{span}\\{e_{1}, e_{2}\\}$（其中 $e_{i}$ 表示第 $i$ 个标准基向量），而 $\\mathrm{Null}(A^{\\top})$ 是其正交补 $\\mathrm{span}\\{e_{3}\\}$。\n\n我们将构造 $V$，使其前两列构成行空间 $\\mathrm{Range}(A^{\\top})$ 的一个标准正交基，后两列构成零空间 $\\mathrm{Null}(A)$ 的一个标准正交基。然后我们将构造 $U$，使得用 $U^{\\top}$ 左乘 $A V$ 会产生一个上三角形式的主导 $2 \\times 2$ 块。\n\n步骤 1：为 $\\mathbb{R}^{4}$ 中的行空间和零空间构建标准正交基。\n$A$ 的行向量为\n$$\nr_{1} = (2, 0, 2, 2),\\quad r_{2} = (0, 3, 3, 3),\\quad r_{3} = (0, 0, 0, 0).\n$$\n我们对 $\\{r_{1}, r_{2}\\}$ 应用 Gram-Schmidt 正交化，以获得 $\\mathbb{R}^{4}$ 中 $\\mathrm{Range}(A^{\\top})$ 的一个标准正交基 $\\{v_{1}, v_{2}\\}$。\n\n第一个向量：\n$$\n\\|r_{1}\\| = \\sqrt{2^{2} + 0^{2} + 2^{2} + 2^{2}} = \\sqrt{12} = 2\\sqrt{3},\\quad\nv_{1} = \\frac{r_{1}}{\\|r_{1}\\|} = \\left(\\frac{1}{\\sqrt{3}},\\, 0,\\, \\frac{1}{\\sqrt{3}},\\, \\frac{1}{\\sqrt{3}}\\right).\n$$\n第二个向量：\n$$\nr_{2} \\cdot v_{1} = 0 \\cdot \\frac{1}{\\sqrt{3}} + 3 \\cdot 0 + 3 \\cdot \\frac{1}{\\sqrt{3}} + 3 \\cdot \\frac{1}{\\sqrt{3}} = \\frac{6}{\\sqrt{3}} = 2\\sqrt{3},\n$$\n$$\nu_{2} = r_{2} - (r_{2} \\cdot v_{1})\\, v_{1} = (0, 3, 3, 3) - 2\\sqrt{3}\\left(\\frac{1}{\\sqrt{3}}, 0, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right) = (-2, 3, 1, 1),\n$$\n$$\n\\|u_{2}\\| = \\sqrt{(-2)^{2} + 3^{2} + 1^{2} + 1^{2}} = \\sqrt{15},\\quad\nv_{2} = \\frac{u_{2}}{\\|u_{2}\\|} = \\left(\\frac{-2}{\\sqrt{15}},\\, \\frac{3}{\\sqrt{15}},\\, \\frac{1}{\\sqrt{15}},\\, \\frac{1}{\\sqrt{15}}\\right).\n$$\n因此 $\\{v_{1}, v_{2}\\}$ 是 $\\mathrm{Range}(A^{\\top})$ 的一个标准正交基。\n\n接下来，为 $\\mathrm{Null}(A)$ 构建一个标准正交基。由于 $\\mathrm{Null}(A)$ 是行空间在 $\\mathbb{R}^{4}$ 中的正交补，我们可以从 $\\mathrm{Null}(A)$ 的任意一个基开始，并对其进行正交化。\n\n求解 $A x = 0$。记 $x = (x_{1}, x_{2}, x_{3}, x_{4})^{\\top}$，方程组为\n$$\n2 x_{1} + 2 x_{3} + 2 x_{4} = 0,\\quad 3 x_{2} + 3 x_{3} + 3 x_{4} = 0.\n$$\n一个方便的生成集是\n$$\nw_{3} = (-1, -1, 1, 0)^{\\top},\\quad w_{4} = (-1, -1, 0, 1)^{\\top}.\n$$\n应用 Gram-Schmidt：\n$$\nu_{3} = w_{3},\\quad \\|u_{3}\\| = \\sqrt{3},\\quad v_{3} = \\frac{u_{3}}{\\|u_{3}\\|} = \\left(\\frac{-1}{\\sqrt{3}},\\, \\frac{-1}{\\sqrt{3}},\\, \\frac{1}{\\sqrt{3}},\\, 0\\right)^{\\top}.\n$$\n将 $w_{4}$ 投影到 $v_{3}$ 上：\n$$\nw_{4} \\cdot v_{3} = \\frac{2}{\\sqrt{3}},\\quad\nu_{4} = w_{4} - (w_{4} \\cdot v_{3})\\, v_{3}\n= (-1, -1, 0, 1) - \\frac{2}{\\sqrt{3}}\\left(\\frac{-1}{\\sqrt{3}}, \\frac{-1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, 0\\right)\n= \\left(-\\frac{1}{3},\\, -\\frac{1}{3},\\, -\\frac{2}{3},\\, 1\\right)^{\\top},\n$$\n$$\n\\|u_{4}\\|^{2} = \\frac{1}{9} + \\frac{1}{9} + \\frac{4}{9} + 1 = \\frac{5}{3},\\quad \\|u_{4}\\| = \\frac{\\sqrt{5}}{\\sqrt{3}},\\quad\nv_{4} = \\frac{u_{4}}{\\|u_{4}\\|} = \\frac{\\sqrt{3}}{\\sqrt{5}}\\left(-\\frac{1}{3},\\, -\\frac{1}{3},\\, -\\frac{2}{3},\\, 1\\right)^{\\top}\n= \\left(\\frac{-\\sqrt{3}}{3\\sqrt{5}},\\, \\frac{-\\sqrt{3}}{3\\sqrt{5}},\\, \\frac{-2\\sqrt{3}}{3\\sqrt{5}},\\, \\frac{\\sqrt{3}}{\\sqrt{5}}\\right)^{\\top}.\n$$\n根据构造，$\\{v_{3}, v_{4}\\}$ 是 $\\mathrm{Null}(A)$ 的一个标准正交基，$\\{v_{1}, v_{2}, v_{3}, v_{4}\\}$ 是 $\\mathbb{R}^{4}$ 的一个标准正交基，因此将它们作为列向量组合起来可以得到一个正交矩阵\n$$\nV = \\begin{pmatrix} v_{1}  v_{2}  v_{3}  v_{4} \\end{pmatrix} \\in \\mathbb{R}^{4 \\times 4}.\n$$\n\n步骤 2：构造 $A V$ 并通过对行进行 Givens 旋转，将主导 $2 \\times 2$ 块三角化。\n我们首先用 $\\{c_{1}, c_{2}\\}$ 来计算 $A$ 对任意 $x \\in \\mathbb{R}^{4}$ 的作用。注意到 $c_{3} = c_{1} + c_{2}$ 且 $c_{4} = c_{1} + c_{2}$，我们有\n$$\nA x = x_{1} c_{1} + x_{2} c_{2} + x_{3}(c_{1} + c_{2}) + x_{4}(c_{1} + c_{2})\n= (x_{1} + x_{3} + x_{4}) c_{1} + (x_{2} + x_{3} + x_{4}) c_{2}.\n$$\n因此，对于 $V$ 的任意列向量 $v$，有 $A v = \\alpha c_{1} + \\beta c_{2}$，其中 $\\alpha = v_{1} + v_{3} + v_{4}$ 且 $\\beta = v_{2} + v_{3} + v_{4}$（下标表示 $v$ 的分量）。将此应用于 $v_{1}$ 和 $v_{2}$：\n- 对于 $v_{1} = \\left(\\frac{1}{\\sqrt{3}},\\, 0,\\, \\frac{1}{\\sqrt{3}},\\, \\frac{1}{\\sqrt{3}}\\right)$,\n$$\n\\alpha_{1} = \\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\sqrt{3},\\quad\n\\beta_{1} = 0 + \\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\frac{2}{\\sqrt{3}},\n$$\n$$\nA v_{1} = \\sqrt{3}\\, c_{1} + \\frac{2}{\\sqrt{3}}\\, c_{2} = \\begin{pmatrix} 2\\sqrt{3} \\\\ 2\\sqrt{3} \\\\ 0 \\end{pmatrix}.\n$$\n- 对于 $v_{2} = \\left(\\frac{-2}{\\sqrt{15}},\\, \\frac{3}{\\sqrt{15}},\\, \\frac{1}{\\sqrt{15}},\\, \\frac{1}{\\sqrt{15}}\\right)$,\n$$\n\\alpha_{2} = \\frac{-2}{\\sqrt{15}} + \\frac{1}{\\sqrt{15}} + \\frac{1}{\\sqrt{15}} = 0,\\quad\n\\beta_{2} = \\frac{3}{\\sqrt{15}} + \\frac{1}{\\sqrt{15}} + \\frac{1}{\\sqrt{15}} = \\frac{5}{\\sqrt{15}} = \\sqrt{\\frac{5}{3}},\n$$\n$$\nA v_{2} = 0 \\cdot c_{1} + \\sqrt{\\frac{5}{3}}\\, c_{2} = \\begin{pmatrix} 0 \\\\ \\sqrt{15} \\\\ 0 \\end{pmatrix}.\n$$\n对于 $v_{3}$ 和 $v_{4}$（它们位于 $\\mathrm{Null}(A)$ 中），我们有 $A v_{3} = 0$ 和 $A v_{4} = 0$。\n\n因此，$A V$ 的前两列是\n$$\nA v_{1} = \\begin{pmatrix} 2\\sqrt{3} \\\\ 2\\sqrt{3} \\\\ 0 \\end{pmatrix},\\quad\nA v_{2} = \\begin{pmatrix} 0 \\\\ \\sqrt{15} \\\\ 0 \\end{pmatrix},\n$$\n后两列是零。为了得到一个上三角形式的主导 $2 \\times 2$ 块，我们对前两行应用一个 Givens 旋转 $G \\in \\mathbb{R}^{2 \\times 2}$，当左乘主导的 $2 \\times 2$ 块时，该旋转会将 $(2,1)$ 位置的元素置零\n$$\nB = \\begin{pmatrix} 2\\sqrt{3}  0 \\\\ 2\\sqrt{3}  \\sqrt{15} \\end{pmatrix}.\n$$\n令 $a = \\begin{pmatrix} 2\\sqrt{3} \\\\ 2\\sqrt{3} \\end{pmatrix}$。选择 $c$ 和 $s$ 满足 $c^{2} + s^{2} = 1$，使得\n$$\n\\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix} \\begin{pmatrix} 2\\sqrt{3} \\\\ 2\\sqrt{3} \\end{pmatrix} = \\begin{pmatrix} \\rho \\\\ 0 \\end{pmatrix},\\quad \\rho = \\sqrt{(2\\sqrt{3})^{2} + (2\\sqrt{3})^{2}} = 2\\sqrt{6}.\n$$\n一个有效的选择是 $c = s = \\frac{1}{\\sqrt{2}}$。将此旋转应用于第二列得到\n$$\n\\begin{pmatrix} c  s \\\\ -s  c \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\sqrt{15} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{15}}{\\sqrt{2}} \\\\ \\frac{\\sqrt{15}}{\\sqrt{2}} \\end{pmatrix}.\n$$\n将这个 $2 \\times 2$ 旋转嵌入到一个 $U \\in \\mathbb{R}^{3 \\times 3}$ 矩阵中，该矩阵作用于前两行，并保持第三行不变：\n$$\nU = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  0 \\\\\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n这个 $U$ 是正交的，并且\n$$\nU^{\\top} A V = \\begin{pmatrix}\n2\\sqrt{6}  \\frac{\\sqrt{15}}{\\sqrt{2}}  0  0 \\\\\n0  \\frac{\\sqrt{15}}{\\sqrt{2}}  0  0 \\\\\n0  0  0  0\n\\end{pmatrix}\n\\;=:\\;\nR.\n$$\n主导的 $2 \\times 2$ 块是\n$$\nR_{11} = \\begin{pmatrix} 2\\sqrt{6}  \\frac{\\sqrt{15}}{\\sqrt{2}} \\\\ 0  \\frac{\\sqrt{15}}{\\sqrt{2}} \\end{pmatrix},\n$$\n它是上三角矩阵，且余下的一行为零，这符合完全正交分解的要求。\n\n步骤 3：验证子空间关系。\n- $\\mathrm{Range}(A)$ 等于 $U$ 的前 2 列的生成空间。$U$ 的前两列是 $\\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}$ 和 $\\begin{pmatrix} -\\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}$，它们显然与 $\\{e_{1}, e_{2}\\}$ 在 $\\mathbb{R}^{3}$ 中张成同一个平面，即 $\\mathrm{Range}(A)$。\n- $\\mathrm{Null}(A^{\\top})$ 等于 $U$ 的最后 1 列的生成空间。$U$ 的最后一列是 $e_{3}$，并且确实有 $\\mathrm{Null}(A^{\\top}) = \\mathrm{span}\\{e_{3}\\}$，因为 $A$ 的第三行为零，且前两行张成一个与 $e_{3}$ 正交的 2 维子空间。\n- $\\mathrm{Range}(A^{\\top})$ 等于 $V$ 的前 2 列的生成空间。根据构造，$v_{1}$ 和 $v_{2}$ 是通过对 $\\{r_{1}, r_{2}\\}$ 进行 Gram-Schmidt 正交化得到的，因此它们构成了 $A$ 的行空间的一个标准正交基。\n- $\\mathrm{Null}(A)$ 等于 $V$ 的后 2 列的生成空间。根据构造，$v_{3}$ 和 $v_{4}$ 是 $A$ 的零空间中的标准正交向量（因为它们是 $w_3$ 和 $w_4$ 的标准正交组合，而 $w_3$ 和 $w_4$ 都满足 $A w_{3} = 0$ 和 $A w_{4} = 0$），因此它们张成了 $\\mathrm{Null}(A)$。\n\n步骤 4：计算 $R_{11}$ 的行列式。\n由于 $R_{11}$ 是上三角矩阵，其行列式等于其对角线元素的乘积：\n$$\n\\det(R_{11}) = \\left(2\\sqrt{6}\\right)\\left(\\frac{\\sqrt{15}}{\\sqrt{2}}\\right) = 2 \\cdot \\frac{\\sqrt{6}\\sqrt{15}}{\\sqrt{2}} = 2 \\cdot \\sqrt{\\frac{90}{2}} = 2 \\cdot \\sqrt{45} = 6 \\sqrt{5}.\n$$\n这就是所要求的最终量。",
            "answer": "$$\\boxed{6\\sqrt{5}}$$"
        },
        {
            "introduction": "虽然带列主元的QR分解是进行秩估计的有力工具，但它并非万无一失。本练习提出了一个精心设计的反例，展示了CPQR在某些情况下可能会产生误导，即尽管奇异值存在明显间隙，它却未能产生一个范数很小的尾部块。通过将CPQR的结果与理想COF的结果进行对比，您将体会到为何双边正交变换对于稳健地揭示矩阵的数值秩至关重要。",
            "id": "3538195",
            "problem": "设 $m=2$ 且 $n=k+1$，其中 $k \\in \\mathbb{N}$，$k \\geq 2$。考虑两个标准正交向量 $u \\in \\mathbb{R}^{2}$ 和 $v \\in \\mathbb{R}^{2}$，其中 $u=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$ 且 $v=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$。通过拼接列来定义矩阵 $A(\\alpha,\\beta,k) \\in \\mathbb{R}^{2 \\times (k+1)}$\n$$\nA(\\alpha,\\beta,k) = \\big[\\, \\alpha v \\,,\\, \\underbrace{\\beta u \\,,\\, \\beta u \\,,\\, \\ldots \\,,\\, \\beta u}_{k \\text{ 个副本}} \\,\\big],\n$$\n其中参数 $\\alpha0$ 和 $\\beta0$ 满足 $\\alpha \\ll \\sqrt{k}\\beta$。设 $r=1$。\n\n从奇异值分解和矩阵谱范数的基本定义出发，并根据带列主元的贪心QR分解过程（通过最大剩余$2$-范数选择主元列）的定义，完成以下操作：\n\n1. 通过分析 $A(\\alpha,\\beta,k)A(\\alpha,\\beta,k)^{\\top}$ 推导奇异值 $\\sigma_{1}(A)$ 和 $\\sigma_{2}(A)$。\n\n2. 在条件 $\\alpha\\beta$ 下，对 $A(\\alpha,\\beta,k)$ 应用带列主元的QR分解的第一步（秩 $r=1$）。仅使用标准正交变换的定义和得到的上梯形结构，构成 $R$ 因子，并识别在 $r=1$ 处分块时的尾随块 $R_{22}$。计算 $\\|R_{22}\\|_{2}$。\n\n3. 使用完全正交分解（COF）的定义，解释如何选择对行和列（包括行主元选择）的额外正交变换，以获得一个正交矩阵 $U \\in \\mathbb{R}^{2 \\times 2}$ 和一个正交矩阵 $Z \\in \\mathbb{R}^{(k+1) \\times (k+1)}$，满足\n$$\nU^{\\top}A(\\alpha,\\beta,k)\\Pi Z = \\begin{pmatrix} R_{11}  R_{12} \\\\ 0  R_{22} \\end{pmatrix},\n$$\n其中 $\\Pi$ 是由初始带列主元的QR分解导出的列置换，且 $R_{11} \\in \\mathbb{R}^{1 \\times 1}$，$R_{22} \\in \\mathbb{R}^{1 \\times k}$。确定在此COF中的 $\\|R_{22}\\|_{2}$。\n\n4. 基于第2项和第3项，计算改进因子\n$$\nF \\;=\\; \\frac{\\|R_{22}\\|_{2}^{\\mathrm{(CPQR)}}}{\\|R_{22}\\|_{2}^{\\mathrm{(COF)}}}\n$$\n作为 $k$、$\\alpha$ 和 $\\beta$ 的闭式解析表达式。\n\n将您的最终答案表示为单个简化的符号表达式，不带单位。无需四舍五入。",
            "solution": "我们首先显式地构造矩阵 $A(\\alpha,\\beta,k)$。给定 $u=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$ 和 $v=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，我们有 $\\alpha v = \\begin{pmatrix}0 \\\\ \\alpha\\end{pmatrix}$ 和 $\\beta u = \\begin{pmatrix}\\beta \\\\ 0\\end{pmatrix}$。\n矩阵 $A \\in \\mathbb{R}^{2 \\times (k+1)}$ 是这些列的拼接：\n$$\nA = \\begin{pmatrix}\n0  \\beta  \\beta  \\cdots  \\beta \\\\\n\\alpha  0  0  \\cdots  0\n\\end{pmatrix}\n$$\n其中有 $k$ 列 $\\begin{pmatrix}\\beta \\\\ 0\\end{pmatrix}$。\n\n**1. 奇异值的推导**\n\n矩阵 $A$ 的奇异值 $\\sigma_i(A)$ 定义为矩阵 $A A^{\\top}$ 的特征值的平方根。我们计算这个 $2 \\times 2$ 的矩阵：\n$$\nA A^{\\top} = \\begin{pmatrix}\n0  \\beta  \\cdots  \\beta \\\\\n\\alpha  0  \\cdots  0\n\\end{pmatrix}\n\\begin{pmatrix}\n0  \\alpha \\\\\n\\beta  0 \\\\\n\\vdots  \\vdots \\\\\n\\beta  0\n\\end{pmatrix}\n$$\n$A A^{\\top}$ 的元素为：\n- $(1,1)$: $(0)(0) + k \\cdot (\\beta)(\\beta) = k\\beta^2$\n- $(1,2)$: $(0)(\\alpha) + k \\cdot (\\beta)(0) = 0$\n- $(2,1)$: $(\\alpha)(0) + k \\cdot (0)(\\beta) = 0$\n- $(2,2)$: $(\\alpha)(\\alpha) + k \\cdot (0)(0) = \\alpha^2$\n因此，得到的矩阵是对角矩阵：\n$$\nA A^{\\top} = \\begin{pmatrix}\nk\\beta^2  0 \\\\\n0  \\alpha^2\n\\end{pmatrix}\n$$\n对角矩阵的特征值就是其对角线上的元素，即 $\\alpha^2$ 和 $k\\beta^2$。按照惯例，$\\sigma_1 \\geq \\sigma_2$。为了按大小排序奇异值，我们比较 $\\alpha^2$ 和 $k\\beta^2$。根据题设条件 $\\alpha \\ll \\sqrt{k}\\beta$，两边平方可得 $\\alpha^2 \\ll k\\beta^2$。因此，较大的特征值是 $k\\beta^2$。\n$$\n\\sigma_1^2 = k\\beta^2 \\implies \\sigma_1(A) = \\sqrt{k\\beta^2} = \\beta\\sqrt{k}\n$$\n较小的特征值是 $\\alpha^2$。\n$$\n\\sigma_2^2 = \\alpha^2 \\implies \\sigma_2(A) = \\sqrt{\\alpha^2} = \\alpha\n$$\n\n**2. 带列主元的QR分解 (CPQR)**\n\n带列主元的贪心QR分解过程会选择余下矩阵中欧几里得$2$-范数最大的列。第一步，我们计算 $A$ 的所有列的范数。设 $a_j$ 是 $A$ 的第 $j$ 列。\n- $\\|a_1\\|_2 = \\left\\| \\begin{pmatrix} 0 \\\\ \\alpha \\end{pmatrix} \\right\\|_2 = \\sqrt{0^2 + \\alpha^2} = \\alpha$。\n- 对于 $j=2, \\ldots, k+1$，$\\|a_j\\|_2 = \\left\\| \\begin{pmatrix} \\beta \\\\ 0 \\end{pmatrix} \\right\\|_2 = \\sqrt{\\beta^2 + 0^2} = \\beta$。\n给定条件 $\\alpha  \\beta$。因此，第一列 $a_1$ 具有最大的范数。它被选为主元列。列置换矩阵 $\\Pi$ 是单位矩阵，$\\Pi=I$。\n\n接下来，我们找一个正交矩阵 $Q_1 \\in \\mathbb{R}^{2 \\times 2}$ 将 $A$ 转换为上梯形形式 $R$。我们需要 $Q_1^{\\top}A = R$，其中 $R$ 的第一列形式为 $\\begin{pmatrix} \\gamma \\\\ 0 \\end{pmatrix}$，且 $|\\gamma| = \\|a_1\\|_2 = \\alpha$。一个能实现这一点的简单正交矩阵是置换矩阵（Householder反射也能得到此结果）。我们选择 $Q_1 = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$。这个矩阵是正交的，因为 $Q_1 Q_1^{\\top} = I$。\n$$\nR = Q_1^{\\top} A = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix}\n0  \\beta  \\cdots  \\beta \\\\\n\\alpha  0  \\cdots  0\n\\end{pmatrix} = \\begin{pmatrix}\n\\alpha  0  \\cdots  0 \\\\\n0  \\beta  \\cdots  \\beta\n\\end{pmatrix}\n$$\n这个矩阵 $R$ 是上梯形的。我们在秩 $r=1$ 处对其进行分块：\n$$\nR = \\begin{pmatrix} R_{11}  R_{12} \\\\ 0  R_{22} \\end{pmatrix}\n$$\n其中 $R_{11} \\in \\mathbb{R}^{1 \\times 1}$，$R_{12} \\in \\mathbb{R}^{1 \\times k}$，以及 $R_{22} \\in \\mathbb{R}^{1 \\times k}$。\n从 $R$ 的结构可知：\n- $R_{11} = [\\alpha]$\n- $R_{12} = \\begin{pmatrix} 0  0  \\cdots  0 \\end{pmatrix}$\n- 次对角线块是 $0 \\in \\mathbb{R}^{1 \\times 1}$。\n- $R_{22} = \\begin{pmatrix} \\beta  \\beta  \\cdots  \\beta \\end{pmatrix}$\n我们现在计算行向量 $R_{22}$ 的 $2$-范数：\n$$\n\\|R_{22}\\|_{2}^{\\mathrm{(CPQR)}} = \\sqrt{\\sum_{i=1}^{k} \\beta^2} = \\sqrt{k\\beta^2} = \\beta\\sqrt{k}\n$$\n\n**3. 完全正交分解 (COF)**\n\n完全正交分解是一种揭示秩的分解。目标是找到正交矩阵 $U$ 和 $Z$ 以及一个置换 $\\Pi$，使得 $U^{\\top}A\\Pi Z$ 具有揭示有效秩的结构。理想的揭示秩的分解是SVD，它能分离出奇异值。问题要求一个分解 $U^{\\top}A\\Pi Z = R = \\begin{pmatrix} R_{11}  R_{12} \\\\ 0  R_{22} \\end{pmatrix}$，其中 $\\|R_{22}\\|_2$ 尽可能小。Eckart-Young-Mirsky定理表明，一个矩阵在秩-$r$近似后，“误差”或“剩余”部分的最小范数由第 $(r+1)$ 个奇异值给出。\n这里，$r=1$。因此，尾随块 $R_{22}$ 的最小可能 $2$-范数是 $\\sigma_{r+1}(A) = \\sigma_2(A)$。\n\n这种理想的分解通过SVD实现。设 $A = U_{svd}\\Sigma V_{svd}^{\\top}$ 是 $A$ 的SVD分解。那么我们可以选择 $U=U_{svd}$ 和 $\\Pi Z = V_{svd}^{\\top}$（因此 $Z = V_{svd}^{\\top}\\Pi^{\\top}$）。\n通过这些选择，矩阵 $R$ 变为 $\\Sigma$：\n$$\nU^{\\top}A(\\Pi Z) = U_{svd}^{\\top}(U_{svd}\\Sigma V_{svd}^{\\top})V_{svd} = \\Sigma\n$$\n使用在第1部分推导出的奇异值，我们有：\n$$\n\\Sigma = \\begin{pmatrix}\n\\sigma_1  0  \\cdots  0 \\\\\n0  \\sigma_2  \\cdots  0\n\\end{pmatrix} = \\begin{pmatrix}\n\\beta\\sqrt{k}  0  0  \\cdots  0 \\\\\n0  \\alpha  0  \\cdots  0\n\\end{pmatrix}\n$$\n这个矩阵 $\\Sigma$ 具有所需的上梯形结构。我们在 $r=1$ 处对其进行分块：\n- $R_{11} = [\\beta\\sqrt{k}]$\n- $R_{12} = \\begin{pmatrix} 0  0  \\cdots  0 \\end{pmatrix}$\n- $R_{22} = \\begin{pmatrix} \\alpha  0  \\cdots  0 \\end{pmatrix}$\n这个 $R_{22}$ 的 $2$-范数是：\n$$\n\\|R_{22}\\|_{2}^{\\mathrm{(COF)}} = \\sqrt{\\alpha^2 + 0^2 + \\cdots + 0^2} = \\alpha\n$$\n这等于 $\\sigma_2(A)$，正如理论所预测的那样。选择正交变换以实现 $R_{22}$ 的这个最小范数的过程，正是理想COF的定义。\n\n**4. 改进因子**\n\n改进因子 $F$ 是CPQR得到的尾随块范数与理想COF得到的尾随块范数之比。\n$$\nF = \\frac{\\|R_{22}\\|_{2}^{\\mathrm{(CPQR)}}}{\\|R_{22}\\|_{2}^{\\mathrm{(COF)}}}\n$$\n代入第2部分和第3部分的结果：\n$$\nF = \\frac{\\beta\\sqrt{k}}{\\alpha}\n$$\n问题的设计使得 $\\alpha \\ll \\beta\\sqrt{k}$，这意味着 $F \\gg 1$，凸显了对于这种特定矩阵结构，一个合适的揭示秩的分解相比于朴素的贪心CPQR所提供的显著改进。",
            "answer": "$$\n\\boxed{\\frac{\\beta\\sqrt{k}}{\\alpha}}\n$$"
        },
        {
            "introduction": "在理想的线性代数世界中，我们的矩阵是完美正交的。然而，在实际计算中，浮点运算会引入微小但重要的误差。本练习通过分析一个具有已知精确COF的矩阵族，来探究理论与现实之间的这种差距。您将推导舍入误差对一个因子的正交性的主阶影响，这是评估矩阵算法数值稳定性的基本技能。",
            "id": "3538202",
            "problem": "考虑一个实矩阵的完全正交分解（COF），其定义如下：对于任意秩为 $r$ 的矩阵 $A \\in \\mathbb{R}^{m \\times n}$，存在正交矩阵 $Q \\in \\mathbb{R}^{m \\times m}$ 和 $Z \\in \\mathbb{R}^{n \\times n}$，使得\n$$\nQ^{\\mathsf{T}} A Z \\;=\\; \\begin{pmatrix} R  0 \\\\ 0  0 \\end{pmatrix},\n$$\n其中 $R \\in \\mathbb{R}^{r \\times r}$ 是上三角矩阵。该分解通过两侧的正交变换揭示了矩阵的秩，并在非零部分上产生三角结构。要求您构造并分析一组具有已知精确COF的具体测试矩阵，并为一个因子的浮点失真度量推导一个闭式的前导项表达式。\n\n定义参数化的测试矩阵族\n$$\nA(\\sigma_{1},\\sigma_{2},\\theta,\\phi) \\;\\in\\; \\mathbb{R}^{3 \\times 3},\n$$\n其参数为 $\\sigma_{1}  \\sigma_{2}  0$，角度 $\\theta, \\phi \\in \\mathbb{R}$ 以弧度为单位，由下式给出：\n$$\nA(\\sigma_{1},\\sigma_{2},\\theta,\\phi) \\;=\\; Q_{0}(\\theta) \\begin{pmatrix} R_{0}  0 \\\\ 0  0 \\end{pmatrix} Z_{0}(\\phi)^{\\mathsf{T}},\n$$\n其中 $R_{0} \\in \\mathbb{R}^{2 \\times 2}$ 是上三角矩阵，由下式给出：\n$$\nR_{0} \\;=\\; \\begin{pmatrix} \\sigma_{1}  0 \\\\ 0  \\sigma_{2} \\end{pmatrix},\n$$\n且 $Q_{0}(\\theta), Z_{0}(\\phi) \\in \\mathbb{R}^{3 \\times 3}$ 是在 $\\left(1,2\\right)$ 平面内的吉文斯旋转矩阵：\n$$\nQ_{0}(\\theta) \\;=\\; \\begin{pmatrix} \\cos(\\theta)  \\sin(\\theta)  0 \\\\ -\\sin(\\theta)  \\cos(\\theta)  0 \\\\ 0  0  1 \\end{pmatrix}, \\qquad\nZ_{0}(\\phi) \\;=\\; \\begin{pmatrix} \\cos(\\phi)  \\sin(\\phi)  0 \\\\ -\\sin(\\phi)  \\cos(\\phi)  0 \\\\ 0  0  1 \\end{pmatrix}.\n$$\n该矩阵族 $A(\\sigma_{1},\\sigma_{2},\\theta,\\phi)$ 构成了一组秩为2的测试矩阵，其精确的COF可以以闭式形式推导出来。\n\n任务：\n- 仅使用COF的基本定义以及正交矩阵和三角块的标准性质，推导 $A(\\sigma_{1},\\sigma_{2},\\theta,\\phi)$ 的COF的精确闭式表达式，即正交因子 $Q$ 和 $Z$，以及上三角因子 $R$，用 $\\sigma_{1}$、$\\sigma_{2}$、$\\theta$ 和 $\\phi$ 表示。\n- 采用浮点运算的标准模型 $\\mathrm{fl}(x \\,\\operatorname{op}\\, y) \\;=\\; (x \\,\\operatorname{op}\\, y)(1+\\delta)$，其中 $|\\delta| \\leq u$，$u$ 是单位舍入。假设因子 $Q$ 是通过在浮点运算中计算 $\\cos(\\theta)$ 和 $\\sin(\\theta)$ 得到的，使得\n$$\n\\widehat{c} \\;=\\; \\mathrm{fl}(\\cos(\\theta)) \\;=\\; \\cos(\\theta)\\,(1+\\delta_{c}), \\qquad\n\\widehat{s} \\;=\\; \\mathrm{fl}(\\sin(\\theta)) \\;=\\; \\sin(\\theta)\\,(1+\\delta_{s}),\n$$\n其中 $|\\delta_{c}| \\leq u$ 且 $|\\delta_{s}| \\leq u$，然后组装计算出的旋转矩阵\n$$\n\\widehat{Q} \\;=\\; \\begin{pmatrix} \\widehat{c}  \\widehat{s}  0 \\\\ -\\widehat{s}  \\widehat{c}  0 \\\\ 0  0  1 \\end{pmatrix}.\n$$\n从第一性原理出发，推导正交性缺陷的弗罗贝尼乌斯范数\n$$\n\\left\\| \\widehat{Q}^{\\mathsf{T}} \\widehat{Q} - I \\right\\|_{F}\n$$\n的前导项闭式表达式，作为单位舍入 $u$ 的函数，在最坏情况下的扰动 $|\\delta_{c}| = u$ 和 $|\\delta_{s}| = u$ （对齐以最大化缺陷）下，并忽略 $u^{2}$ 及更高阶的项。您的最终答案必须是一个关于 $u$ 的单一闭式解析表达式。不需要进行舍入，也不涉及物理单位。角度以弧度为单位。",
            "solution": "问题分为两部分。第一部分要求为给定的矩阵族推导完全正交分解（COF）。第二部分要求对其中一个正交因子进行一阶浮点误差分析。\n\n第1部分：完全正交分解的推导\n\n问题定义了一个矩阵族 $A(\\sigma_{1},\\sigma_{2},\\theta,\\phi) \\in \\mathbb{R}^{3 \\times 3}$，其构造如下：\n$$\nA(\\sigma_{1},\\sigma_{2},\\theta,\\phi) \\;=\\; Q_{0}(\\theta) \\begin{pmatrix} R_{0}  0 \\\\ 0  0 \\end{pmatrix} Z_{0}(\\phi)^{\\mathsf{T}}\n$$\n其中 $\\sigma_{1}  \\sigma_{2}  0$，且矩阵 $Q_{0}(\\theta)$、$Z_{0}(\\phi)$ 和 $R_{0}$ 由下式给出：\n$$\nQ_{0}(\\theta) = \\begin{pmatrix} \\cos(\\theta)  \\sin(\\theta)  0 \\\\ -\\sin(\\theta)  \\cos(\\theta)  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad\nZ_{0}(\\phi) = \\begin{pmatrix} \\cos(\\phi)  \\sin(\\phi)  0 \\\\ -\\sin(\\phi)  \\cos(\\phi)  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad\nR_{0} = \\begin{pmatrix} \\sigma_{1}  0 \\\\ 0  \\sigma_{2} \\end{pmatrix}.\n$$\n对于秩为 $r$ 的矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其COF的定义是存在正交矩阵 $Q \\in \\mathbb{R}^{m \\times m}$ 和 $Z \\in \\mathbb{R}^{n \\times n}$，使得\n$$\nQ^{\\mathsf{T}} A Z \\;=\\; \\begin{pmatrix} R  0 \\\\ 0  0 \\end{pmatrix}\n$$\n其中 $R \\in \\mathbb{R}^{r \\times r}$ 是一个上三角矩阵。\n\n矩阵 $A$ 的构造强烈暗示了其COF的一组候选因子。我们提出以下因子：\n$Q = Q_{0}(\\theta)$，$Z = Z_{0}(\\phi)$，以及 $R = R_{0}$。\n\n我们必须验证这些提出的因子是否满足COF的所有条件。\n\n1.  $Q$ 和 $Z$ 的正交性：\n    矩阵 $Q_{0}(\\theta)$ 是一个吉文斯旋转矩阵。我们通过计算 $Q_{0}(\\theta)^{\\mathsf{T}} Q_{0}(\\theta)$ 来验证其正交性：\n    $$\n    Q_{0}(\\theta)^{\\mathsf{T}} Q_{0}(\\theta) = \\begin{pmatrix} \\cos(\\theta)  -\\sin(\\theta)  0 \\\\ \\sin(\\theta)  \\cos(\\theta)  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\cos(\\theta)  \\sin(\\theta)  0 \\\\ -\\sin(\\theta)  \\cos(\\theta)  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\cos^2(\\theta)+\\sin^2(\\theta)  0  0 \\\\ 0  \\sin^2(\\theta)+\\cos^2(\\theta)  0 \\\\ 0  0  1 \\end{pmatrix} = I_{3}\n    $$\n    其中 $I_3$ 是 $3 \\times 3$ 的单位矩阵。因此，$Q = Q_{0}(\\theta)$ 是 $\\mathbb{R}^{3 \\times 3}$ 中的一个正交矩阵。由于结构相同，$Z = Z_{0}(\\phi)$ 也是 $\\mathbb{R}^{3 \\times 3}$ 中的一个正交矩阵。\n\n2.  $R$ 的秩和结构：\n    $A$ 的秩由其构造中的块对角矩阵的秩决定，因为 $Q_{0}(\\theta)$ 和 $Z_{0}(\\phi)$ 是正交的，因此是可逆的。\n    $$\n    \\mathrm{rank}(A) = \\mathrm{rank}\\left(\\begin{pmatrix} R_{0}  0 \\\\ 0  0 \\end{pmatrix}\\right) = \\mathrm{rank}(R_{0})\n    $$\n    矩阵 $R_{0}$ 是对角矩阵，其对角元为 $\\sigma_{1}$ 和 $\\sigma_{2}$。由于 $\\sigma_{1}  0$ 且 $\\sigma_{2}  0$，$R_{0}$ 是可逆的，秩为2。因此，$A$ 的秩为 $r=2$。提出的因子 $R=R_{0}$ 是一个 $2 \\times 2$ 矩阵。此外，$R_{0}$ 是一个对角矩阵，这是上三角矩阵的一个特例。因此，$R=R_0$ 满足作为 $r \\times r$ 上三角矩阵的条件。\n\n3.  分解恒等式：\n    我们将提出的因子 $Q=Q_{0}(\\theta)$ 和 $Z=Z_{0}(\\phi)$，以及给定的 $A$ 的表达式，代入COF恒等式 $Q^{\\mathsf{T}} A Z$ 中：\n    $$\n    Q^{\\mathsf{T}} A Z = Q_{0}(\\theta)^{\\mathsf{T}} \\left( Q_{0}(\\theta) \\begin{pmatrix} R_{0}  0 \\\\ 0  0 \\end{pmatrix} Z_{0}(\\phi)^{\\mathsf{T}} \\right) Z_{0}(\\phi)\n    $$\n    利用矩阵乘法的结合律：\n    $$\n    = \\left(Q_{0}(\\theta)^{\\mathsf{T}} Q_{0}(\\theta)\\right) \\begin{pmatrix} R_{0}  0 \\\\ 0  0 \\end{pmatrix} \\left(Z_{0}(\\phi)^{\\mathsf{T}} Z_{0}(\\phi)\\right)\n    $$\n    由于 $Q_{0}(\\theta)$ 和 $Z_{0}(\\phi)$ 是正交的，所以 $Q_{0}(\\theta)^{\\mathsf{T}} Q_{0}(\\theta) = I_{3}$ 且 $Z_{0}(\\phi)^{\\mathsf{T}} Z_{0}(\\phi) = I_{3}$。表达式简化为：\n    $$\n    = I_{3} \\begin{pmatrix} R_{0}  0 \\\\ 0  0 \\end{pmatrix} I_{3} = \\begin{pmatrix} R_{0}  0 \\\\ 0  0 \\end{pmatrix}\n    $$\n    这与所需形式 $\\begin{pmatrix} R  0 \\\\ 0  0 \\end{pmatrix}$ 相匹配，其中 $R=R_{0}$。\n\n所有条件均已满足。因此，$A(\\sigma_{1},\\sigma_{2},\\theta,\\phi)$ 的COF因子为：\n$$\nQ = \\begin{pmatrix} \\cos(\\theta)  \\sin(\\theta)  0 \\\\ -\\sin(\\theta)  \\cos(\\theta)  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad Z = \\begin{pmatrix} \\cos(\\phi)  \\sin(\\phi)  0 \\\\ -\\sin(\\phi)  \\cos(\\phi)  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad R = \\begin{pmatrix} \\sigma_{1}  0 \\\\ 0  \\sigma_{2} \\end{pmatrix}.\n$$\n\n第2部分：浮点误差分析\n\n我们被要求为计算得到的矩阵 $\\widehat{Q}$ 找到其正交性缺陷的弗罗贝尼乌斯范数 $\\| \\widehat{Q}^{\\mathsf{T}} \\widehat{Q} - I \\|_{F}$ 的前导项表达式。\n计算得到的矩阵 $\\widehat{Q}$ 是通过对正弦和余弦进行浮点计算而形成的：\n$$\n\\widehat{c} = \\cos(\\theta)(1+\\delta_c), \\quad \\widehat{s} = \\sin(\\theta)(1+\\delta_s), \\quad |\\delta_c| \\leq u, \\quad |\\delta_s| \\leq u.\n$$\n计算得到的矩阵为\n$$\n\\widehat{Q} = \\begin{pmatrix} \\widehat{c}  \\widehat{s}  0 \\\\ -\\widehat{s}  \\widehat{c}  0 \\\\ 0  0  1 \\end{pmatrix}.\n$$\n首先，我们计算乘积 $\\widehat{Q}^{\\mathsf{T}} \\widehat{Q}$：\n$$\n\\widehat{Q}^{\\mathsf{T}} \\widehat{Q} = \\begin{pmatrix} \\widehat{c}  -\\widehat{s}  0 \\\\ \\widehat{s}  \\widehat{c}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\widehat{c}  \\widehat{s}  0 \\\\ -\\widehat{s}  \\widehat{c}  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\widehat{c}^2 + \\widehat{s}^2  \\widehat{c}\\widehat{s}-\\widehat{s}\\widehat{c}  0 \\\\ \\widehat{s}\\widehat{c}-\\widehat{c}\\widehat{s}  \\widehat{s}^2 + \\widehat{c}^2  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} \\widehat{c}^2 + \\widehat{s}^2  0  0 \\\\ 0  \\widehat{c}^2 + \\widehat{s}^2  0 \\\\ 0  0  1 \\end{pmatrix}.\n$$\n正交性缺陷矩阵为 $E = \\widehat{Q}^{\\mathsf{T}} \\widehat{Q} - I$：\n$$\nE = \\begin{pmatrix} \\widehat{c}^2 + \\widehat{s}^2 - 1  0  0 \\\\ 0  \\widehat{c}^2 + \\widehat{s}^2 - 1  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n$E$ 的弗罗贝尼乌斯范数由 $\\|E\\|_{F} = \\sqrt{\\sum_{i,j} |E_{ij}|^2}$ 给出：\n$$\n\\|E\\|_{F} = \\sqrt{(\\widehat{c}^2 + \\widehat{s}^2 - 1)^2 + (\\widehat{c}^2 + \\widehat{s}^2 - 1)^2} = \\sqrt{2(\\widehat{c}^2 + \\widehat{s}^2 - 1)^2} = \\sqrt{2} |\\widehat{c}^2 + \\widehat{s}^2 - 1|.\n$$\n现在我们用扰动 $\\delta_c$ 和 $\\delta_s$ 来表示项 $\\widehat{c}^2 + \\widehat{s}^2 - 1$。令 $c = \\cos(\\theta)$ 和 $s = \\sin(\\theta)$。\n$$\n\\widehat{c}^2 + \\widehat{s}^2 - 1 = \\left(c(1+\\delta_c)\\right)^2 + \\left(s(1+\\delta_s)\\right)^2 - 1 = c^2(1+2\\delta_c+\\delta_c^2) + s^2(1+2\\delta_s+\\delta_s^2) - 1.\n$$\n问题要求忽略 $u^2$ 及更高阶的项，所以我们舍弃 $\\delta_c^2$ 和 $\\delta_s^2$ 项。表达式变为：\n$$\n\\widehat{c}^2 + \\widehat{s}^2 - 1 \\approx c^2(1+2\\delta_c) + s^2(1+2\\delta_s) - 1 = c^2 + 2c^2\\delta_c + s^2 + 2s^2\\delta_s - 1.\n$$\n使用恒等式 $c^2+s^2 = \\cos^2(\\theta) + \\sin^2(\\theta) = 1$，我们得到：\n$$\n\\widehat{c}^2 + \\widehat{s}^2 - 1 \\approx (c^2+s^2-1) + 2c^2\\delta_c + 2s^2\\delta_s = 2(c^2\\delta_c + s^2\\delta_s) = 2(\\cos^2(\\theta)\\delta_c + \\sin^2(\\theta)\\delta_s).\n$$\n将此代入范数的表达式中，得到前导项近似：\n$$\n\\| \\widehat{Q}^{\\mathsf{T}} \\widehat{Q} - I \\|_{F} \\approx \\sqrt{2} |2(\\cos^2(\\theta)\\delta_c + \\sin^2(\\theta)\\delta_s)| = 2\\sqrt{2} |\\cos^2(\\theta)\\delta_c + \\sin^2(\\theta)\\delta_s|.\n$$\n最后一步是应用最坏情况条件：$|\\delta_c| = u$, $|\\delta_s| = u$，并选择符号以最大化缺陷。我们需要最大化表达式 $\\cos^2(\\theta)\\delta_c + \\sin^2(\\theta)\\delta_s$ 的绝对值。\n根据三角不等式：\n$$\n|\\cos^2(\\theta)\\delta_c + \\sin^2(\\theta)\\delta_s| \\leq |\\cos^2(\\theta)\\delta_c| + |\\sin^2(\\theta)\\delta_s| = \\cos^2(\\theta)|\\delta_c| + \\sin^2(\\theta)|\\delta_s|.\n$$\n由于 $\\cos^2(\\theta) \\geq 0$ 且 $\\sin^2(\\theta) \\geq 0$。为了最大化这个上界，我们设置 $|\\delta_c|=u$ 和 $|\\delta_s|=u$：\n$$\n\\cos^2(\\theta)u + \\sin^2(\\theta)u = u(\\cos^2(\\theta) + \\sin^2(\\theta)) = u.\n$$\n当 $\\cos^2(\\theta)\\delta_c$ 和 $\\sin^2(\\theta)\\delta_s$ 均为非负且达到边界时，取得该最大值。例如，当我们选择 $\\delta_c = u$ 和 $\\delta_s = u$ 时，就会发生这种情况。在这种情况下，表达式为 $\\cos^2(\\theta)u + \\sin^2(\\theta)u = u$。因此，$|\\cos^2(\\theta)\\delta_c + \\sin^2(\\theta)\\delta_s|$ 的最大值为 $u$。\n\n因此，在最坏情况扰动下，正交性缺陷的弗罗贝尼乌斯范数的前导项表达式为：\n$$\n\\left\\| \\widehat{Q}^{\\mathsf{T}} \\widehat{Q} - I \\right\\|_{F} \\approx 2\\sqrt{2} u.\n$$",
            "answer": "$$\n\\boxed{2\\sqrt{2}u}\n$$"
        }
    ]
}