{
    "hands_on_practices": [
        {
            "introduction": "掌握一个概念的最佳方式之一就是通过具体计算来加深理解。这个练习将引导你计算一个简单 $2 \\times 2$ 对称矩阵的条件数。通过这个过程，你不仅能练习谱范数条件数的定义 $\\kappa(A) = \\|A\\|_2 \\cdot \\|A^{-1}\\|_2 = \\sigma_{\\max}/\\sigma_{\\min}$，还能体会到对于对称矩阵，其奇异值与特征值之间的直接联系。",
            "id": "1049315",
            "problem": "考虑对称的 $2 \\times 2$ 矩阵 $A = \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix}$。关于谱范数（2-范数）的矩阵求逆的条件数定义为 $\\kappa(A) = \\|A\\|_2 \\cdot \\|A^{-1}\\|_2$，其中 $\\| \\cdot \\|_2$ 表示谱范数。这可以等价地用 $A$ 的奇异值 $\\sigma_{\\max}$ 和 $\\sigma_{\\min}$ 来表示。通过确定 $A$ 的奇异值来计算 $\\kappa(A)$。",
            "solution": "1. 对称正定矩阵的谱范数等于其最大特征值，其逆矩阵的谱范数等于其最小特征值的倒数。\n2. 计算 \n$$A=\\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix}$$ \n的特征值，通过求解 \n$$\\det(A-\\lambda I)=(2-\\lambda)^2-1=\\lambda^2-4\\lambda+3=0\\,. $$  \n3. 求解 $\\lambda^2-4\\lambda+3=0$ 得到 \n$$\\lambda=\\frac{4\\pm\\sqrt{16-12}}{2}=\\{3,1\\}\\,. $$  \n4. 因此奇异值为 $\\sigma_{\\max}=3$ 和 $\\sigma_{\\min}=1$，从而得到 \n$$\\kappa(A)=\\frac{\\sigma_{\\max}}{\\sigma_{\\min}}=\\frac{3}{1}=3\\,. $$",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "在理论模型与物理现实之间，微小的扰动是常态。这个练习模拟了一个近乎理想的系统（由单位矩阵表示）因制造缺陷而引入微小耦合项的情景。通过推导条件数作为扰动大小 $\\epsilon$ 的解析表达式，你将能从根本上理解矩阵的条件如何随扰动而变化，并量化解对系统变化的敏感性。",
            "id": "2210773",
            "problem": "考虑一个用于模拟二维物理过程的线性方程组 $A \\mathbf{x} = \\mathbf{b}$。在理想情况下，该系统的行为由 $2 \\times 2$ 单位矩阵 $I_2$ 描述。然而，由于一个微小的制造缺陷，引入了一个弱交叉耦合项。系统矩阵现在由 $A(\\epsilon) = I_2 + \\epsilon E_{12}$ 给出，其中 $\\epsilon$ 是一个代表缺陷大小的非负实数，而 $E_{12}$ 是一个在第一行第二列的元素为1，其余元素均为0的矩阵。\n\n解 $\\mathbf{x}$ 对向量 $\\mathbf{b}$ 中扰动的敏感性由矩阵 $A(\\epsilon)$ 的条件数来刻画。关于矩阵2-范数的条件数定义为 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。\n\n求出这个受扰矩阵的2-范数条件数 $\\kappa_2(A(\\epsilon))$。将你的答案表示为关于 $\\epsilon$ 的闭式解析表达式。",
            "solution": "给定 $A(\\epsilon) = I_{2} + \\epsilon E_{12} = \\begin{pmatrix} 1  \\epsilon \\\\ 0  1 \\end{pmatrix}$，其中 $\\epsilon \\geq 0$。2-范数条件数由 $\\kappa_{2}(A) = \\|A\\|_{2}\\,\\|A^{-1}\\|_{2}$ 定义。使用矩阵2-范数的奇异值表征，我们有 $\\|A\\|_{2} = \\sigma_{\\max}(A)$ 和 $\\|A^{-1}\\|_{2} = \\sigma_{\\max}(A^{-1}) = 1/\\sigma_{\\min}(A)$，所以\n$$\n\\kappa_{2}(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)} = \\sqrt{\\frac{\\lambda_{\\max}(A^{T}A)}{\\lambda_{\\min}(A^{T}A)}},\n$$\n其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 是 $A^{T}A$ 的最大和最小特征值。\n\n计算 $A^{T}A$：\n$$\nA^{T} = \\begin{pmatrix} 1  0 \\\\ \\epsilon  1 \\end{pmatrix}, \\quad\nA^{T}A = \\begin{pmatrix} 1  \\epsilon \\\\ \\epsilon  1 + \\epsilon^{2} \\end{pmatrix}.\n$$\n$A^{T}A$ 的特征值满足\n$$\n\\det\\!\\left(A^{T}A - \\lambda I\\right) = \\det\\!\\begin{pmatrix} 1 - \\lambda  \\epsilon \\\\ \\epsilon  1 + \\epsilon^{2} - \\lambda \\end{pmatrix} = (1 - \\lambda)(1 + \\epsilon^{2} - \\lambda) - \\epsilon^{2} = 0.\n$$\n展开得到\n$$\n(1 - \\lambda)(1 + \\epsilon^{2} - \\lambda) - \\epsilon^{2} = 1 - (2 + \\epsilon^{2})\\lambda + \\lambda^{2} = 0,\n$$\n所以特征值为\n$$\n\\lambda_{\\pm} = \\frac{(2 + \\epsilon^{2}) \\pm \\sqrt{(2 + \\epsilon^{2})^{2} - 4}}{2} = \\frac{(2 + \\epsilon^{2}) \\pm \\epsilon \\sqrt{\\epsilon^{2} + 4}}{2}.\n$$\n因此，\n$$\n\\kappa_{2}(A(\\epsilon)) = \\sqrt{\\frac{\\lambda_{+}}{\\lambda_{-}}}\n= \\sqrt{\\frac{(2 + \\epsilon^{2}) + \\epsilon \\sqrt{\\epsilon^{2} + 4}}{(2 + \\epsilon^{2}) - \\epsilon \\sqrt{\\epsilon^{2} + 4}}}.\n$$\n为了简化，注意到\n$$\n(2 + \\epsilon^{2}) \\pm \\epsilon \\sqrt{\\epsilon^{2} + 4} = \\frac{\\left(\\sqrt{\\epsilon^{2} + 4} \\pm \\epsilon\\right)^{2}}{2},\n$$\n所以\n$$\n\\kappa_{2}(A(\\epsilon)) = \\frac{\\sqrt{\\epsilon^{2} + 4} + \\epsilon}{\\sqrt{\\epsilon^{2} + 4} - \\epsilon} = \\frac{\\left(\\sqrt{\\epsilon^{2} + 4} + \\epsilon\\right)^{2}}{4} = 1 + \\frac{\\epsilon^{2}}{2} + \\frac{\\epsilon}{2}\\sqrt{\\epsilon^{2} + 4}.\n$$\n对于 $\\epsilon \\geq 0$，这些等价的闭式表达式都是有效的。",
            "answer": "$$\\boxed{1 + \\frac{\\epsilon^{2}}{2} + \\frac{\\epsilon}{2}\\sqrt{\\epsilon^{2} + 4}}$$"
        },
        {
            "introduction": "条件数不仅是衡量问题敏感性的指标，更是工程与科学设计中的一个关键考量。本练习将你带入实验设计的领域，探讨如何在有限的预算下构建一个“最优”的实验矩阵。通过对比两种不同的最优化准则（D-最优和A-最优），你将发现它们在提升统计效率和保证数值稳定性（即低条件数）之间存在着深刻的权衡。",
            "id": "3540105",
            "problem": "考虑具有两个回归量的线性最小二乘问题，其模型为 $y = X \\beta + \\varepsilon$，其中 $X \\in \\mathbb{R}^{2 \\times 2}$ 是设计矩阵，信息矩阵为 $M = X^{\\mathsf{T}} X$。假设 $X$ 的两列是正交的，并设列成本为 $c_1  c_2  0$。你有一个固定的设计预算 $B  0$，它通过 $c_1 \\|x_1\\|_2^2 + c_2 \\|x_2\\|_2^2 = B$ 约束了 $X$ 的列 $x_1$ 和 $x_2$ 的欧几里得范数的平方。采用最优实验设计中的标准定义：行列式最优性（D-最优性）是在约束条件下最大化 $\\det(M)$ 的 $X$ 的选择，而迹最优性（A-最优性）是在约束条件下最小化 $\\operatorname{tr}(M^{-1})$ 的 $X$ 的选择。$X$ 的 2-范数条件数为 $\\kappa_2(X) = \\sigma_{\\max}(X) / \\sigma_{\\min}(X)$，其中 $\\sigma_{\\max}(X)$ 和 $\\sigma_{\\min}(X)$ 分别是 $X$ 的最大和最小奇异值。\n\n(a) 构建满足列正交结构和预算约束的显式设计 $X_{\\mathrm{D}}$ 和 $X_{\\mathrm{A}}$，使其分别达到 D-最优性和 A-最优性。\n\n(b) 计算 $\\kappa_2(X_{\\mathrm{D}})$ 和 $\\kappa_2(X_{\\mathrm{A}})$，并解释行列式最优性和迹最优性在如何影响 $M$ 的谱和 $X$ 的条件数方面的权衡。\n\n作为你的最终答案，报告比率 $\\kappa_2(X_{\\mathrm{D}}) / \\kappa_2(X_{\\mathrm{A}})$ 关于 $c_1$ 和 $c_2$ 的闭式表达式。无需四舍五入。",
            "solution": "设矩阵 $X \\in \\mathbb{R}^{2 \\times 2}$ 的两个正交列记为 $x_1$ 和 $x_2$。正交条件为 $x_1^{\\mathsf{T}} x_2 = 0$。信息矩阵 $M$ 由下式给出：\n$$\nM = X^{\\mathsf{T}} X = \\begin{pmatrix} x_1^{\\mathsf{T}} \\\\ x_2^{\\mathsf{T}} \\end{pmatrix} [x_1, x_2] = \\begin{pmatrix} x_1^{\\mathsf{T}} x_1  x_1^{\\mathsf{T}} x_2 \\\\ x_2^{\\mathsf{T}} x_1  x_2^{\\mathsf{T}} x_2 \\end{pmatrix} = \\begin{pmatrix} \\|x_1\\|_2^2  0 \\\\ 0  \\|x_2\\|_2^2 \\end{pmatrix}\n$$\n我们定义 $\\lambda_1 = \\|x_1\\|_2^2$ 和 $\\lambda_2 = \\|x_2\\|_2^2$。这些量代表信息矩阵 $M$ 的特征值。问题要求 $\\lambda_1  0$ 和 $\\lambda_2  0$ 以使 $M$ 可逆。预算约束用这些特征值表示为：\n$$\nc_1 \\lambda_1 + c_2 \\lambda_2 = B\n$$\n其中 $c_1  c_2  0$ 且 $B  0$。我们的任务是找到满足指定最优性准则的 $\\lambda_1$ 和 $\\lambda_2$ 的值，然后构建相应的矩阵 $X$。\n\n(a) $X_{\\mathrm{D}}$ 和 $X_{\\mathrm{A}}$ 的构建\n\n**D-最优性**\n\nD-最优性准则要求在预算约束下最大化信息矩阵的行列式 $\\det(M)$。\n$$\n\\det(M) = \\det \\begin{pmatrix} \\lambda_1  0 \\\\ 0  \\lambda_2 \\end{pmatrix} = \\lambda_1 \\lambda_2\n$$\n我们需要在 $c_1 \\lambda_1 + c_2 \\lambda_2 = B$ 的约束下最大化函数 $f(\\lambda_1, \\lambda_2) = \\lambda_1 \\lambda_2$。我们可以从约束条件中用 $\\lambda_1$ 表示 $\\lambda_2$：$\\lambda_2 = (B - c_1 \\lambda_1) / c_2$。将此代入目标函数，得到一个关于 $\\lambda_1$ 的单变量函数：\n$$\nf(\\lambda_1) = \\lambda_1 \\left( \\frac{B - c_1 \\lambda_1}{c_2} \\right) = \\frac{1}{c_2} (B \\lambda_1 - c_1 \\lambda_1^2)\n$$\n这是一个关于 $\\lambda_1$ 的二次函数，表示一个开口向下的抛物线。最大值出现在其顶点处，可以通过将一阶导数设为零来找到：\n$$\n\\frac{df}{d\\lambda_1} = \\frac{1}{c_2} (B - 2c_1 \\lambda_1) = 0\n$$\n这得到 $B - 2c_1 \\lambda_1 = 0$，所以 $\\lambda_1$ 的 D-最优值为：\n$$\n\\lambda_{1, \\mathrm{D}} = \\frac{B}{2c_1}\n$$\n将此代回预算约束以求 $\\lambda_2$：\n$$\nc_1 \\left( \\frac{B}{2c_1} \\right) + c_2 \\lambda_{2, \\mathrm{D}} = B \\implies \\frac{B}{2} + c_2 \\lambda_{2, \\mathrm{D}} = B \\implies c_2 \\lambda_{2, \\mathrm{D}} = \\frac{B}{2}\n$$\n所以，$\\lambda_2$ 的 D-最优值为：\n$$\n\\lambda_{2, \\mathrm{D}} = \\frac{B}{2c_2}\n$$\n为了构建一个显式的设计矩阵 $X_{\\mathrm{D}}$，我们可以选择列为缩放后的标准基向量，它们是正交的。\n$$\nx_{1, \\mathrm{D}} = \\sqrt{\\lambda_{1, \\mathrm{D}}} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\sqrt{\\frac{B}{2c_1}} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\quad \\text{和} \\quad x_{2, \\mathrm{D}} = \\sqrt{\\lambda_{2, \\mathrm{D}}} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\sqrt{\\frac{B}{2c_2}} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n因此，D-最优设计矩阵为：\n$$\nX_{\\mathrm{D}} = \\begin{pmatrix} \\sqrt{\\frac{B}{2c_1}}  0 \\\\ 0  \\sqrt{\\frac{B}{2c_2}} \\end{pmatrix}\n$$\n\n**A-最优性**\n\nA-最优性准则要求在预算约束下最小化信息矩阵的逆的迹 $\\operatorname{tr}(M^{-1})$。\n$$\nM^{-1} = \\begin{pmatrix} 1/\\lambda_1  0 \\\\ 0  1/\\lambda_2 \\end{pmatrix} \\implies \\operatorname{tr}(M^{-1}) = \\frac{1}{\\lambda_1} + \\frac{1}{\\lambda_2}\n$$\n我们使用拉格朗日乘子法来最小化函数 $g(\\lambda_1, \\lambda_2) = \\frac{1}{\\lambda_1} + \\frac{1}{\\lambda_2}$，其约束条件为 $c_1 \\lambda_1 + c_2 \\lambda_2 = B$。拉格朗日函数为：\n$$\n\\mathcal{L}(\\lambda_1, \\lambda_2, \\mu) = \\frac{1}{\\lambda_1} + \\frac{1}{\\lambda_2} + \\mu(c_1 \\lambda_1 + c_2 \\lambda_2 - B)\n$$\n对 $\\lambda_1$ 和 $\\lambda_2$ 求偏导数并将其设为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda_1} = -\\frac{1}{\\lambda_1^2} + \\mu c_1 = 0 \\implies \\lambda_1^2 = \\frac{1}{\\mu c_1} \\implies \\lambda_1 = \\frac{1}{\\sqrt{\\mu c_1}}\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda_2} = -\\frac{1}{\\lambda_2^2} + \\mu c_2 = 0 \\implies \\lambda_2^2 = \\frac{1}{\\mu c_2} \\implies \\lambda_2 = \\frac{1}{\\sqrt{\\mu c_2}}\n$$\n从这两个方程中，我们得到比率：\n$$\n\\frac{\\lambda_1}{\\lambda_2} = \\frac{1/\\sqrt{\\mu c_1}}{1/\\sqrt{\\mu c_2}} = \\sqrt{\\frac{c_2}{c_1}} \\implies \\lambda_1 \\sqrt{c_1} = \\lambda_2 \\sqrt{c_2}\n$$\n现在，我们将此关系与预算约束一起使用。设 $\\lambda_1 = k/\\sqrt{c_1}$ 和 $\\lambda_2 = k/\\sqrt{c_2}$，其中 $k$ 是某个常数。代入预算约束：\n$$\nc_1 \\left( \\frac{k}{\\sqrt{c_1}} \\right) + c_2 \\left( \\frac{k}{\\sqrt{c_2}} \\right) = B \\implies k\\sqrt{c_1} + k\\sqrt{c_2} = B \\implies k(\\sqrt{c_1} + \\sqrt{c_2}) = B\n$$\n所以，$k = B / (\\sqrt{c_1} + \\sqrt{c_2})$。$\\lambda_1$ 和 $\\lambda_2$ 的 A-最优值为：\n$$\n\\lambda_{1, \\mathrm{A}} = \\frac{B}{\\sqrt{c_1}(\\sqrt{c_1} + \\sqrt{c_2})}\n$$\n$$\n\\lambda_{2, \\mathrm{A}} = \\frac{B}{\\sqrt{c_2}(\\sqrt{c_1} + \\sqrt{c_2})}\n$$\n一个显式的 A-最优设计矩阵 $X_{\\mathrm{A}}$ 可以类似地构建：\n$$\nX_{\\mathrm{A}} = \\begin{pmatrix} \\sqrt{\\frac{B}{\\sqrt{c_1}(\\sqrt{c_1} + \\sqrt{c_2})}}  0 \\\\ 0  \\sqrt{\\frac{B}{\\sqrt{c_2}(\\sqrt{c_1} + \\sqrt{c_2})}} \\end{pmatrix}\n$$\n\n(b) 条件数与权衡\n\n$X$ 的奇异值 $\\sigma_i(X)$ 与 $M = X^{\\mathsf{T}}X$ 的特征值通过 $\\sigma_i(X) = \\sqrt{\\lambda_i(M)}$ 相关。在我们的例子中，$X$ 的奇异值是 $\\sqrt{\\lambda_1}$ 和 $\\sqrt{\\lambda_2}$。$X$ 的 2-范数条件数是 $\\kappa_2(X) = \\frac{\\sigma_{\\max}(X)}{\\sigma_{\\min}(X)} = \\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}}$。\n给定 $c_1  c_2  0$。\n\n对于 D-最优设计：\n$\\lambda_{1, \\mathrm{D}} = \\frac{B}{2c_1}$ 且 $\\lambda_{2, \\mathrm{D}} = \\frac{B}{2c_2}$。由于 $c_1  c_2$，我们有 $\\lambda_{1, \\mathrm{D}}  \\lambda_{2, \\mathrm{D}}$。\n所以，$\\lambda_{\\min} = \\lambda_{1, \\mathrm{D}}$ 且 $\\lambda_{\\max} = \\lambda_{2, \\mathrm{D}}$。\n$$\n\\kappa_2(X_{\\mathrm{D}}) = \\sqrt{\\frac{\\lambda_{2, \\mathrm{D}}}{\\lambda_{1, \\mathrm{D}}}} = \\sqrt{\\frac{B/(2c_2)}{B/(2c_1)}} = \\sqrt{\\frac{c_1}{c_2}}\n$$\n\n对于 A-最优设计：\n$\\lambda_{1, \\mathrm{A}} = \\frac{B}{\\sqrt{c_1}(\\sqrt{c_1} + \\sqrt{c_2})}$ 且 $\\lambda_{2, \\mathrm{A}} = \\frac{B}{\\sqrt{c_2}(\\sqrt{c_1} + \\sqrt{c_2})}$。\n由于 $c_1  c_2$，我们有 $\\sqrt{c_1}  \\sqrt{c_2}$，这意味着 $\\sqrt{c_1}(\\sqrt{c_1} + \\sqrt{c_2})  \\sqrt{c_2}(\\sqrt{c_1} + \\sqrt{c_2})$。取倒数会反转不等式，所以 $\\lambda_{1, \\mathrm{A}}  \\lambda_{2, \\mathrm{A}}$。\n因此，$\\lambda_{\\min} = \\lambda_{1, \\mathrm{A}}$ 且 $\\lambda_{\\max} = \\lambda_{2, \\mathrm{A}}$。\n$$\n\\kappa_2(X_{\\mathrm{A}}) = \\sqrt{\\frac{\\lambda_{2, \\mathrm{A}}}{\\lambda_{1, \\mathrm{A}}}} = \\sqrt{\\frac{B/(\\sqrt{c_2}(\\sqrt{c_1}+\\sqrt{c_2}))}{B/(\\sqrt{c_1}(\\sqrt{c_1}+\\sqrt{c_2}))}} = \\sqrt{\\frac{\\sqrt{c_1}}{\\sqrt{c_2}}} = \\left(\\frac{c_1}{c_2}\\right)^{1/4}\n$$\n\n**权衡：**\n信息矩阵 $M$ 的谱由其特征值 $\\{\\lambda_1, \\lambda_2\\}$ 组成。$X$ 的条件由这些特征值的比率决定。\n- **谱：** 对于 D-最优性，特征值的比率为 $\\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{c_1}{c_2}$。对于 A-最优性，此比率为 $\\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\sqrt{\\frac{c_1}{c_2}}$。由于 $c_1  c_2$，我们有 $\\frac{c_1}{c_2}  \\sqrt{\\frac{c_1}{c_2}}  1$。这表明 A-最优设计产生的 $M$ 的特征值比 D-最优设计产生的特征值更接近（更平衡）。D-最优性分配预算，使得成本加权的范数相等（$c_1\\lambda_1 = c_2\\lambda_2 = B/2$），这将更多的“能量”（范数的平方）投入到成本较低（$c_2$）的列中。这使得特征值分散开。A-最优性试图避免非常小的特征值（因为 $1/\\lambda_i$ 会变得非常大），这迫使能量分布更均匀，并使特征值更接近。\n- **条件数：** 条件数反映了最小二乘解对扰动的敏感性。由于 $\\left(\\frac{c_1}{c_2}\\right)^{1/2}  \\left(\\frac{c_1}{c_2}\\right)^{1/4}$，我们有 $\\kappa_2(X_{\\mathrm{D}})  \\kappa_2(X_{\\mathrm{A}})$。A-最优设计比 D-最优设计产生了一个条件更好的矩阵 $X$。\n- **权衡：** D-最优性最大化 $\\det(M)$，这对应于最小化参数估计 $\\beta$ 的置信椭球的体积。它关注于整体的“信息体积”。相比之下，A-最优性最小化 $\\operatorname{tr}(M^{-1})$，这与参数估计的方差之和成正比。该准则对小特征值更敏感，因此导致设计更鲁棒、条件更好，但代价是与 D-最优设计相比，行列式（信息体积）更小。\n\n最后，我们计算所要求的条件数之比。\n$$\n\\frac{\\kappa_2(X_{\\mathrm{D}})}{\\kappa_2(X_{\\mathrm{A}})} = \\frac{\\sqrt{c_1/c_2}}{(c_1/c_2)^{1/4}} = \\frac{(c_1/c_2)^{1/2}}{(c_1/c_2)^{1/4}} = \\left(\\frac{c_1}{c_2}\\right)^{1/2 - 1/4} = \\left(\\frac{c_1}{c_2}\\right)^{1/4}\n$$",
            "answer": "$$\n\\boxed{\\left(\\frac{c_1}{c_2}\\right)^{1/4}}\n$$"
        }
    ]
}