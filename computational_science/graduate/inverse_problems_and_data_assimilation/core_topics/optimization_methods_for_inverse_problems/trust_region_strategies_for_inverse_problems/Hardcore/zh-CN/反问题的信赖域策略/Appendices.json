{
    "hands_on_practices": [
        {
            "introduction": "信赖域方法的核心在于其自适应的反馈机制。算法通过构建一个目标函数的局部模型来预测下降量，并将其与实际下降量进行比较，以此来评估模型的可靠性。本练习聚焦于这一关键决策步骤：计算实际下降与预测下降之比（即信赖域比率 $\\rho_k$），并根据该比率决定是否接受当前试探步，以及如何调整下一次迭代的信赖域半径 $\\Delta$。掌握这个反馈回路是理解信赖域方法稳健性的基础。",
            "id": "3428714",
            "problem": "考虑一个数据同化中的正则化非线性反问题，其目标函数 $J(x)$ 表示加权最小二乘失配加上 Tikhonov 型正则化。在高斯-牛顿（GN）信赖域方法的第 $k$ 次迭代中，构建一个二次模型 $m_{k}(s)$，并在信赖域约束 $\\|s\\| \\leq \\Delta_{k}$ 下计算步长 $s_{k}$。在标准信赖域框架中，步长的接受以及随后的信赖域半径更新由信赖域比率 $\\rho_{k}$、两个阈值 $\\eta_{1}$ 和 $\\eta_{2}$ 以及缩放参数共同决定。假设使用以下更新策略：\n- 若 $\\rho_{k}  \\eta_{1}$，则拒绝该步长，且 $\\Delta_{k+1} = \\gamma_{\\mathrm{dec}} \\,\\Delta_{k}$。\n- 若 $\\eta_{1} \\leq \\rho_{k} \\leq \\eta_{2}$，则接受该步长，且 $\\Delta_{k+1} = \\Delta_{k}$。\n- 若 $\\rho_{k}  \\eta_{2}$，则接受该步长，且 $\\Delta_{k+1} = \\min\\{\\gamma_{\\mathrm{inc}} \\,\\Delta_{k}, \\Delta_{\\max}\\}$。\n\n给定以下迭代数据：\n- 预测下降量 $m_{k}(0) - m_{k}(s_{k}) = 0.2$。\n- 实际下降量 $J(x_{k}) - J(x_{k} + s_{k}) = 0.15$。\n- 阈值 $\\eta_{1} = 0.25$ 和 $\\eta_{2} = 0.75$。\n- 当前信赖域半径 $\\Delta_{k} = 1.2$。\n- 缩放参数 $\\gamma_{\\mathrm{dec}} = 0.5$、$\\gamma_{\\mathrm{inc}} = 1.5$ 和最大半径 $\\Delta_{\\max} = 10$。\n\n使用信赖域比率 $\\rho_{k}$ 的标准定义和上述更新策略，计算 $\\rho_{k}$ 的值和更新后的信赖域半径 $\\Delta_{k+1}$。将最终结果表示为精确值，无需四舍五入。以一个包含 $\\rho_{k}$ 和 $\\Delta_{k+1}$（按此顺序）的二元行矩阵形式提供您的最终答案。",
            "solution": "用户提供了一个关于信赖域优化方法中信赖域半径更新的问题。我将首先验证问题陈述。\n\n### 步骤1：提取已知条件\n问题提供了在第 $k$ 次迭代中，信赖域方法的以下信息和定义：\n- 目标函数：$J(x)$\n- 目标函数变化的二次模型：$m_{k}(s)$\n- 第 $k$ 次迭代计算的步长：$s_{k}$\n- 信赖域约束：$\\|s\\| \\leq \\Delta_{k}$\n- 信赖域比率：$\\rho_{k}$\n- 阈值参数：$\\eta_{1}$ 和 $\\eta_{2}$\n- 半径缩放参数：$\\gamma_{\\mathrm{dec}}$, $\\gamma_{\\mathrm{inc}}$, $\\Delta_{\\max}$\n\n信赖域半径 $\\Delta_{k+1}$ 的更新策略如下：\n1.  若 $\\rho_{k}  \\eta_{1}$：拒绝步长，且 $\\Delta_{k+1} = \\gamma_{\\mathrm{dec}} \\,\\Delta_{k}$。\n2.  若 $\\eta_{1} \\leq \\rho_{k} \\leq \\eta_{2}$：接受步长，且 $\\Delta_{k+1} = \\Delta_{k}$。\n3.  若 $\\rho_{k}  \\eta_{2}$：接受步长，且 $\\Delta_{k+1} = \\min\\{\\gamma_{\\mathrm{inc}} \\,\\Delta_{k}, \\Delta_{\\max}\\}$。\n\n当前迭代 $k$ 的具体数值为：\n- 模型预测下降量：$m_{k}(0) - m_{k}(s_{k}) = 0.2$\n- 目标函数实际下降量：$J(x_{k}) - J(x_{k} + s_{k}) = 0.15$\n- 阈值：$\\eta_{1} = 0.25$ 和 $\\eta_{2} = 0.75$\n- 当前信赖域半径：$\\Delta_{k} = 1.2$\n- 缩放参数：$\\gamma_{\\mathrm{dec}} = 0.5$, $\\gamma_{\\mathrm{inc}} = 1.5$, 和 $\\Delta_{\\max} = 10$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是适定的，有科学依据，且内部一致。它描述了数值优化领域的一种标准算法，特别是信赖域方法，该方法广泛用于求解非线性最小二乘问题和反问题。所有计算所求量所需的数据和定义均已提供。这些数值在数值上是合理的。没有矛盾、歧义或违反科学原理之处。该问题是信赖域框架定义和规则的直接应用。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。我将继续进行求解。\n\n### 解答\n任务是根据所提供的数据和更新策略，计算信赖域比率 $\\rho_{k}$ 和更新后的信赖域半径 $\\Delta_{k+1}$。\n\n首先，我们计算信赖域比率 $\\rho_{k}$。该比率的标准定义是目标函数的实际下降量除以二次模型预测的下降量。\n$$\n\\rho_{k} = \\frac{\\text{实际下降量}}{\\text{预测下降量}} = \\frac{J(x_{k}) - J(x_{k} + s_{k})}{m_{k}(0) - m_{k}(s_{k})}\n$$\n使用给定的值：\n- 实际下降量 = $0.15$\n- 预测下降量 = $0.2$\n\n我们可以将这些值代入 $\\rho_{k}$ 的公式中：\n$$\n\\rho_{k} = \\frac{0.15}{0.2} = \\frac{15}{20} = \\frac{3}{4}\n$$\n因此，信赖域比率的值为 $\\rho_{k} = 0.75$。\n\n接下来，我们必须确定信赖域半径 $\\Delta_{k+1}$ 的更新规则。这需要将 $\\rho_{k}$ 与给定的阈值 $\\eta_{1} = 0.25$ 和 $\\eta_{2} = 0.75$ 进行比较。\n我们有 $\\rho_{k} = 0.75$。让我们检查更新策略的三种情况：\n1.  $\\rho_{k}  \\eta_{1}$ 是否成立？这对应于 $0.75  0.25$，不成立。\n2.  $\\eta_{1} \\leq \\rho_{k} \\leq \\eta_{2}$ 是否成立？这对应于 $0.25 \\leq 0.75 \\leq 0.75$。此陈述成立。\n3.  $\\rho_{k}  \\eta_{2}$ 是否成立？这对应于 $0.75  0.75$，不成立。\n\n由于第二个条件 ($\\eta_{1} \\leq \\rho_{k} \\leq \\eta_{2}$) 满足，因此应用相应的更新规则。根据问题陈述，在这种情况下，步长 $s_{k}$ 被接受，信赖域半径不变。\n$$\n\\Delta_{k+1} = \\Delta_{k}\n$$\n问题指明当前信赖域半径为 $\\Delta_{k} = 1.2$。因此，更新后的半径为：\n$$\n\\Delta_{k+1} = 1.2\n$$\n为将结果表示为精确分数，我们有 $\\rho_{k} = \\frac{3}{4}$ 和 $\\Delta_{k+1} = 1.2 = \\frac{12}{10} = \\frac{6}{5}$。\n\n计算出的两个值为 $\\rho_{k} = \\frac{3}{4}$ 和 $\\Delta_{k+1} = \\frac{6}{5}$。最终答案应以一个按顺序包含这些值的二元行矩阵形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{4}  \\frac{6}{5} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在理解了信赖域的更新逻辑之后，下一个自然的问题是如何生成一个有效的试探步长 $s_k$。对于二次或类二次的目标函数，最直接的策略是计算高斯-牛顿（Gauss-Newton）步长，即模型函数的无约束最优点。本练习将引导你计算这一步长，并处理信赖域方法中的一个基本挑战：当这个理想步长超出了当前信赖域的边界时该怎么办。我们将通过一个简单而有效的策略——将步长缩放回信赖域边界——来解决这个问题。",
            "id": "3428663",
            "problem": "考虑由二次目标函数 $J(x)=\\tfrac{1}{2}\\|A x - b\\|^{2}$（使用欧几里得范数）定义的线性逆问题，其中\n$$\nA=\\begin{pmatrix}3  1 \\\\ 1  2\\end{pmatrix}, \\quad b=\\begin{pmatrix}7 \\\\ 8\\end{pmatrix}.\n$$\n在当前迭代点 $x_{k}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 且信赖域半径 $\\Delta=1$（使用欧几里得范数）的情况下，计算用于最小化 $J(x)$ 的高斯-牛顿 (Gauss-Newton, GN) 步，检查其是否满足信赖域 (trust-region, TR) 约束 $\\|s\\|\\le \\Delta$，如果违反约束，则沿 GN 方向构造一个恰好位于信赖域边界上的缩放步长。将最终采纳的信赖域步长 $s_{\\mathrm{tr}}$ 以行向量形式报告。不要对答案进行四舍五入。最终答案无需单位。",
            "solution": "该问题要求为给定的线性逆问题计算一个信赖域步长。该过程首先涉及计算高斯-牛顿 (GN) 步，然后检查它是否位于信赖域内，如果不在，则将其缩放以使其位于信赖域边界上。\n\n需要最小化的目标函数是 $J(x) = \\frac{1}{2}\\|Ax - b\\|^2$，其中范数为欧几里得范数。给定的参数为：\n$$\nA=\\begin{pmatrix}3  1 \\\\ 1  2\\end{pmatrix}, \\quad b=\\begin{pmatrix}7 \\\\ 8\\end{pmatrix}\n$$\n当前迭代点为 $x_{k}=\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$，信赖域半径为 $\\Delta=1$。\n\n高斯-牛顿法用一个二次模型来近似 $x_k$ 处的目标函数：\n$$\nm_k(s) = J(x_k) + \\nabla J(x_k)^T s + \\frac{1}{2} s^T H_{gn} s\n$$\n其中 $s$ 是从 $x_k$ 开始的步长，$\\nabla J(x_k)$ 是 $J$ 在 $x_k$ 处的梯度，而 $H_{gn}$ 是海森矩阵的高斯-牛顿近似。\n\n$J(x)$ 的梯度由下式给出：\n$$\n\\nabla J(x) = A^T(Ax - b)\n$$\n$J(x)$ 的海森矩阵为：\n$$\n\\nabla^2 J(x) = A^T A\n$$\n对于线性最小二乘问题，海森矩阵的高斯-牛顿近似就是精确的海森矩阵，因此 $H_{gn} = A^T A$。\n\n在当前迭代点 $x_k = \\begin{pmatrix}0 \\\\ 0\\end{pmatrix}$ 处，梯度为：\n$$\n\\nabla J(x_k) = A^T(A \\cdot \\mathbf{0} - b) = -A^T b\n$$\n高斯-牛顿步长 $s_{gn}$ 是模型 $m_k(s)$ 的无约束最小化解。它通过求解线性系统 $H_{gn} s_{gn} = -\\nabla J(x_k)$ 得到：\n$$\n(A^T A) s_{gn} = -(-A^T b) = A^T b\n$$\n首先，我们计算矩阵 $A^T A$ 和向量 $A^T b$。由于 $A$ 是对称的，所以 $A^T=A$。\n$$\nA^T A = A^2 = \\begin{pmatrix}3  1 \\\\ 1  2\\end{pmatrix} \\begin{pmatrix}3  1 \\\\ 1  2\\end{pmatrix} = \\begin{pmatrix}3(3)+1(1)  3(1)+1(2) \\\\ 1(3)+2(1)  1(1)+2(2)\\end{pmatrix} = \\begin{pmatrix}10  5 \\\\ 5  5\\end{pmatrix}\n$$\n$$\nA^T b = A b = \\begin{pmatrix}3  1 \\\\ 1  2\\end{pmatrix} \\begin{pmatrix}7 \\\\ 8\\end{pmatrix} = \\begin{pmatrix}3(7)+1(8) \\\\ 1(7)+2(8)\\end{pmatrix} = \\begin{pmatrix}29 \\\\ 23\\end{pmatrix}\n$$\n现在我们求解方程组 $(A^T A) s_{gn} = A^T b$ 以得到 $s_{gn} = \\begin{pmatrix}s_1 \\\\ s_2\\end{pmatrix}$：\n$$\n\\begin{pmatrix}10  5 \\\\ 5  5\\end{pmatrix} \\begin{pmatrix}s_1 \\\\ s_2\\end{pmatrix} = \\begin{pmatrix}29 \\\\ 23\\end{pmatrix}\n$$\n这得到以下线性方程组：\n1. $10s_1 + 5s_2 = 29$\n2. $5s_1 + 5s_2 = 23$\n\n将第一个方程减去第二个方程得到：\n$5s_1 = 6 \\implies s_1 = \\frac{6}{5}$\n将 $s_1 = \\frac{6}{5}$ 代入第二个方程：\n$5\\left(\\frac{6}{5}\\right) + 5s_2 = 23 \\implies 6 + 5s_2 = 23 \\implies 5s_2 = 17 \\implies s_2 = \\frac{17}{5}$\n因此，高斯-牛顿步长为：\n$$\ns_{gn} = \\begin{pmatrix} \\frac{6}{5} \\\\ \\frac{17}{5} \\end{pmatrix}\n$$\n接下来，我们必须检查此步长是否满足信赖域约束 $\\|s\\| \\le \\Delta$，其中 $\\Delta=1$。我们计算 $s_{gn}$ 的欧几里得范数：\n$$\n\\|s_{gn}\\| = \\sqrt{\\left(\\frac{6}{5}\\right)^2 + \\left(\\frac{17}{5}\\right)^2} = \\sqrt{\\frac{36}{25} + \\frac{289}{25}} = \\sqrt{\\frac{325}{25}} = \\sqrt{13}\n$$\n由于 $\\sqrt{13} \\approx 3.6055$，我们有 $\\|s_{gn}\\| = \\sqrt{13}  1 = \\Delta$。高斯-牛顿步长违反了信赖域约束。\n\n题目要求我们“沿 GN 方向构造一个恰好位于信赖域边界上的缩放步长”。这意味着所采纳的信赖域步长 $s_{tr}$ 必须与 $s_{gn}$ 方向相同，但其大小等于信赖域半径 $\\Delta$。\n$s_{gn}$ 的方向由单位向量 $\\frac{s_{gn}}{\\|s_{gn}\\|}$ 给出。我们用 $\\Delta$ 缩放这个方向以获得 $s_{tr}$：\n$$\ns_{tr} = \\Delta \\frac{s_{gn}}{\\|s_{gn}\\|}\n$$\n代入已知值 $\\Delta=1$，$\\|s_{gn}\\|=\\sqrt{13}$ 和 $s_{gn} = \\begin{pmatrix} \\frac{6}{5} \\\\ \\frac{17}{5} \\end{pmatrix}$：\n$$\ns_{tr} = 1 \\cdot \\frac{1}{\\sqrt{13}} \\begin{pmatrix} \\frac{6}{5} \\\\ \\frac{17}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{6}{5\\sqrt{13}} \\\\ \\frac{17}{5\\sqrt{13}} \\end{pmatrix}\n$$\n为了标准化表示，对分母进行有理化：\n$$\ns_{tr} = \\begin{pmatrix} \\frac{6\\sqrt{13}}{5 \\cdot 13} \\\\ \\frac{17\\sqrt{13}}{5 \\cdot 13} \\end{pmatrix} = \\begin{pmatrix} \\frac{6\\sqrt{13}}{65} \\\\ \\frac{17\\sqrt{13}}{65} \\end{pmatrix}\n$$\n题目要求以行向量形式给出答案。因此，最终采纳的信赖域步长是该向量的转置。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{6\\sqrt{13}}{65}  \\frac{17\\sqrt{13}}{65}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然缩放高斯-牛顿步长是一种简单的策略，但更复杂的求解器通常能带来更好的收敛性能。本练习介绍了一种著名且高效的信赖域子问题求解算法——狗腿法（Dogleg Method）。我们将探索它如何巧妙地结合了稳健但缓慢的最速下降方向和高效但可能不稳定的高斯-牛顿方向，从而在求解不适定问题时生成一个更精确、更可靠的步长。此外，本练习中使用马氏范数（Mahalanobis norm）来定义信赖域，这也是一种根据问题统计特性调整几何空间的常用技巧，在数据同化领域尤其普遍。",
            "id": "3428678",
            "problem": "考虑一个非线性加权最小二乘反问题，其残差向量为 $\\mathbf{r} \\in \\mathbb{R}^{2}$，雅可比矩阵为 $\\mathbf{J} \\in \\mathbb{R}^{2 \\times 2}$。在当前迭代点，通过高斯-牛顿二次模型来近似目标函数\n$$m(\\mathbf{s}) \\;=\\; \\tfrac{1}{2}\\,\\|\\mathbf{r} + \\mathbf{J}\\,\\mathbf{s}\\|_{\\mathbf{C}^{-1}}^{2},$$\n其中 $\\|\\mathbf{v}\\|_{\\mathbf{C}^{-1}} := \\sqrt{\\mathbf{v}^{\\top}\\mathbf{C}^{-1}\\mathbf{v}}$ 是由对称正定 (SPD) 协方差矩阵 $\\mathbf{C} \\in \\mathbb{R}^{2 \\times 2}$ 导出的马氏范数。信赖域子问题是在马氏信赖域约束 $\\|\\mathbf{s}\\|_{\\mathbf{C}^{-1}} \\le \\Delta$ 下最小化 $m(\\mathbf{s})$。\n\n仅使用高斯-牛顿模型、其梯度和近似海森矩阵，以及二次型的最速下降（柯西）步的基本定义，来构建关于马氏范数的经典狗腿步。数据如下：\n$$\n\\mathbf{C} \\;=\\; \\begin{bmatrix} 1  0 \\\\ 4pt] 0  9 \\end{bmatrix}, \n\\quad \\mathbf{J} \\;=\\; \\begin{bmatrix} 1  0 \\\\ 4pt] 0  1 \\end{bmatrix}, \n\\quad \\mathbf{r} \\;=\\; \\begin{bmatrix} 2 \\\\ 4pt] 3 \\end{bmatrix}, \n\\quad \\Delta \\;=\\; 2.\n$$\n按以下步骤进行：\n- 从第一性原理出发，推导二次模型 $q(\\mathbf{s}) = \\tfrac{1}{2}\\mathbf{s}^{\\top}\\mathbf{B}\\,\\mathbf{s} + \\mathbf{g}^{\\top}\\mathbf{s}$ 的梯度 $\\mathbf{g}$ 和近似海森矩阵 $\\mathbf{B}$。\n- 通过在 $\\alpha \\ge 0$ 上最小化 $q(-\\alpha\\,\\mathbf{g})$ 来推导最速下降步（柯西点） $\\mathbf{s}_{\\mathrm{SD}}$。\n- 通过求解 $\\mathbf{B}\\,\\mathbf{s}_{\\mathrm{GN}} = -\\mathbf{g}$ 来计算高斯-牛顿步 $\\mathbf{s}_{\\mathrm{GN}}$。\n- 使用由 $\\mathbf{C}^{-1}$ 导出的马氏范数作为信赖域范数，确定适用哪种狗腿情况，并相应地计算狗腿步 $\\mathbf{s}_{\\mathrm{DL}}$。验证 $\\|\\mathbf{s}_{\\mathrm{DL}}\\|_{\\mathbf{C}^{-1}} \\le \\Delta$。\n\n将满足 $\\mathbf{s}_{\\mathrm{DL}} = -\\lambda\\,\\mathbf{g}$ 的精确标量 $\\lambda$ 作为你的最终答案。不需要进行数值取整，也不涉及任何单位。将最终答案表示为单个封闭形式的表达式。",
            "solution": "该问题是有效的，因为它是自洽的，在数值优化领域有科学依据，并且在数学上是适定的。所有必要的数据和定义都已提供。我将按照指定的步骤进行求解。\n\n目标函数的高斯-牛顿二次模型由下式给出\n$$m(\\mathbf{s}) = \\tfrac{1}{2}\\,\\|\\mathbf{r} + \\mathbf{J}\\,\\mathbf{s}\\|_{\\mathbf{C}^{-1}}^{2}$$\n其中 $\\|\\mathbf{v}\\|_{\\mathbf{C}^{-1}} = \\sqrt{\\mathbf{v}^{\\top}\\mathbf{C}^{-1}\\mathbf{v}}$。展开此表达式，我们得到：\n$$m(\\mathbf{s}) = \\tfrac{1}{2}\\,(\\mathbf{r} + \\mathbf{J}\\,\\mathbf{s})^{\\top}\\mathbf{C}^{-1}(\\mathbf{r} + \\mathbf{J}\\,\\mathbf{s}) = \\tfrac{1}{2}\\,(\\mathbf{r}^{\\top}\\mathbf{C}^{-1}\\mathbf{r} + 2\\mathbf{r}^{\\top}\\mathbf{C}^{-1}\\mathbf{J}\\,\\mathbf{s} + \\mathbf{s}^{\\top}\\mathbf{J}^{\\top}\\mathbf{C}^{-1}\\mathbf{J}\\,\\mathbf{s})$$\n该模型由一般二次型 $q(\\mathbf{s}) = \\frac{1}{2}\\mathbf{s}^{\\top}\\mathbf{B}\\,\\mathbf{s} + \\mathbf{g}^{\\top}\\mathbf{s} + \\text{常数项}$ 近似。\n\n### 步骤1：推导梯度 $\\mathbf{g}$ 和近似海森矩阵 $\\mathbf{B}$\n通过将 $m(\\mathbf{s})$ 的展开形式与一般二次型 $q(\\mathbf{s})$ 进行比较，我们确定在 $\\mathbf{s}=\\mathbf{0}$ 处的梯度 $\\mathbf{g}$ 和近似海森矩阵 $\\mathbf{B}$：\n$$\\mathbf{g} = \\nabla m(\\mathbf{s})|_{\\mathbf{s}=\\mathbf{0}} = \\mathbf{J}^{\\top}\\mathbf{C}^{-1}\\mathbf{r}$$\n$$\\mathbf{B} = \\nabla^2 m(\\mathbf{s})|_{\\mathbf{s}=\\mathbf{0}} = \\mathbf{J}^{\\top}\\mathbf{C}^{-1}\\mathbf{J}$$\n给定数据为：\n$$\n\\mathbf{C} = \\begin{bmatrix} 1  0 \\\\ 0  9 \\end{bmatrix}, \\quad \\mathbf{J} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}, \\quad \\mathbf{r} = \\begin{bmatrix} 2 \\\\ 3 \\end{bmatrix}\n$$\n协方差矩阵 $\\mathbf{C}$ 的逆矩阵是：\n$$\\mathbf{C}^{-1} = \\begin{bmatrix} 1  0 \\\\ 0  \\frac{1}{9} \\end{bmatrix}$$\n现在，我们计算 $\\mathbf{g}$ 和 $\\mathbf{B}$：\n$$\\mathbf{g} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}^{\\top} \\begin{bmatrix} 1  0 \\\\ 0  \\frac{1}{9} \\end{bmatrix} \\begin{bmatrix} 2 \\\\ 3 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  \\frac{1}{9} \\end{bmatrix} \\begin{bmatrix} 2 \\\\ 3 \\end{bmatrix} = \\begin{bmatrix} 2 \\\\ \\frac{1}{3} \\end{bmatrix}$$\n$$\\mathbf{B} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}^{\\top} \\begin{bmatrix} 1  0 \\\\ 0  \\frac{1}{9} \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  \\frac{1}{9} \\end{bmatrix}$$\n注意，在这个具体问题中，$\\mathbf{B} = \\mathbf{C}^{-1}$。\n\n### 步骤2：推导最速下降步（柯西点） $\\mathbf{s}_{\\mathrm{SD}}$\n问题将 $\\mathbf{s}_{\\mathrm{SD}}$ 定义为 $q(\\mathbf{s})$ 沿着最速下降方向 $-\\mathbf{g}$ 的无约束极小化子。我们设 $\\mathbf{s}(\\alpha) = -\\alpha\\mathbf{g}$（其中 $\\alpha \\ge 0$），并找到最小化 $q(\\mathbf{s}(\\alpha))$ 的 $\\alpha$：\n$$q(-\\alpha\\mathbf{g}) = \\tfrac{1}{2}(-\\alpha\\mathbf{g})^{\\top}\\mathbf{B}(-\\alpha\\mathbf{g}) + \\mathbf{g}^{\\top}(-\\alpha\\mathbf{g}) = \\tfrac{1}{2}\\alpha^2(\\mathbf{g}^{\\top}\\mathbf{B}\\mathbf{g}) - \\alpha(\\mathbf{g}^{\\top}\\mathbf{g})$$\n为求最小值，我们对 $\\alpha$ 求导并将结果设为零：\n$$\\frac{d}{d\\alpha}q(-\\alpha\\mathbf{g}) = \\alpha(\\mathbf{g}^{\\top}\\mathbf{B}\\mathbf{g}) - (\\mathbf{g}^{\\top}\\mathbf{g}) = 0$$\n最优步长为 $\\alpha^* = \\frac{\\mathbf{g}^{\\top}\\mathbf{g}}{\\mathbf{g}^{\\top}\\mathbf{B}\\mathbf{g}}$。\n我们来计算标量积：\n$$\\mathbf{g}^{\\top}\\mathbf{g} = \\begin{bmatrix} 2  \\frac{1}{3} \\end{bmatrix} \\begin{bmatrix} 2 \\\\ \\frac{1}{3} \\end{bmatrix} = 2^2 + (\\frac{1}{3})^2 = 4 + \\frac{1}{9} = \\frac{37}{9}$$\n$$\\mathbf{g}^{\\top}\\mathbf{B}\\mathbf{g} = \\begin{bmatrix} 2  \\frac{1}{3} \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  \\frac{1}{9} \\end{bmatrix} \\begin{bmatrix} 2 \\\\ \\frac{1}{3} \\end{bmatrix} = \\begin{bmatrix} 2  \\frac{1}{27} \\end{bmatrix} \\begin{bmatrix} 2 \\\\ \\frac{1}{3} \\end{bmatrix} = 4 + \\frac{1}{81} = \\frac{324+1}{81} = \\frac{325}{81}$$\n因此，步长为：\n$$\\alpha^* = \\frac{37/9}{325/81} = \\frac{37}{9} \\cdot \\frac{81}{325} = \\frac{37 \\cdot 9}{325} = \\frac{333}{325}$$\n无约束最速下降步为：\n$$\\mathbf{s}_{\\mathrm{SD}} = -\\alpha^*\\mathbf{g} = -\\frac{333}{325}\\begin{bmatrix} 2 \\\\ \\frac{1}{3} \\end{bmatrix}$$\n\n### 步骤3：计算高斯-牛顿步 $\\mathbf{s}_{\\mathrm{GN}}$\n高斯-牛顿步 $\\mathbf{s}_{\\mathrm{GN}}$ 无约束地最小化二次模型 $q(\\mathbf{s})$。它是线性方程组 $\\mathbf{B}\\mathbf{s}_{\\mathrm{GN}} = -\\mathbf{g}$ 的解。\n$$\\mathbf{s}_{\\mathrm{GN}} = -\\mathbf{B}^{-1}\\mathbf{g}$$\n$\\mathbf{B}$ 的逆是 $\\mathbf{B}^{-1} = (\\mathbf{C}^{-1})^{-1} = \\mathbf{C} = \\begin{bmatrix} 1  0 \\\\ 0  9 \\end{bmatrix}$。\n$$\\mathbf{s}_{\\mathrm{GN}} = - \\begin{bmatrix} 1  0 \\\\ 0  9 \\end{bmatrix} \\begin{bmatrix} 2 \\\\ \\frac{1}{3} \\end{bmatrix} = - \\begin{bmatrix} 2 \\\\ 3 \\end{bmatrix} = \\begin{bmatrix} -2 \\\\ -3 \\end{bmatrix}$$\n\n### 步骤4：确定狗腿步 $\\mathbf{s}_{\\mathrm{DL}}$\n经典狗腿路径连接原点、无约束最速下降步 $\\mathbf{s}_{\\mathrm{SD}}$ 和高斯-牛顿步 $\\mathbf{s}_{\\mathrm{GN}}$。狗腿步 $\\mathbf{s}_{\\mathrm{DL}}$ 是此路径上离原点最远但仍满足信赖域约束 $\\|\\mathbf{s}\\|_{\\mathbf{C}^{-1}} \\le \\Delta$（其中 $\\Delta=2$）的点。\n\n首先，我们检查 $\\mathbf{s}_{\\mathrm{GN}}$ 是否在信赖域内：\n$$\\|\\mathbf{s}_{\\mathrm{GN}}\\|_{\\mathbf{C}^{-1}}^2 = \\mathbf{s}_{\\mathrm{GN}}^{\\top}\\mathbf{C}^{-1}\\mathbf{s}_{\\mathrm{GN}} = \\begin{bmatrix} -2  -3 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  \\frac{1}{9} \\end{bmatrix} \\begin{bmatrix} -2 \\\\ -3 \\end{bmatrix} = (-2)^2 + (-3)\\left(-\\frac{3}{9}\\right) = 4 + 1 = 5$$\n$$\\|\\mathbf{s}_{\\mathrm{GN}}\\|_{\\mathbf{C}^{-1}} = \\sqrt{5}$$\n由于 $\\sqrt{5}  2$，$\\mathbf{s}_{\\mathrm{GN}}$ 在信赖域之外。\n\n接下来，我们检查 $\\mathbf{s}_{\\mathrm{SD}}$ 是否在信赖域内。其范数为 $\\|\\mathbf{s}_{\\mathrm{SD}}\\|_{\\mathbf{C}^{-1}} = \\alpha^*\\|\\mathbf{g}\\|_{\\mathbf{C}^{-1}}$。\n$$\\|\\mathbf{g}\\|_{\\mathbf{C}^{-1}}^2 = \\mathbf{g}^{\\top}\\mathbf{C}^{-1}\\mathbf{g} = \\mathbf{g}^{\\top}\\mathbf{B}\\mathbf{g} = \\frac{325}{81}$$\n$$\\|\\mathbf{g}\\|_{\\mathbf{C}^{-1}} = \\sqrt{\\frac{325}{81}} = \\frac{\\sqrt{25 \\cdot 13}}{9} = \\frac{5\\sqrt{13}}{9}$$\n$$\\|\\mathbf{s}_{\\mathrm{SD}}\\|_{\\mathbf{C}^{-1}} = \\alpha^*\\|\\mathbf{g}\\|_{\\mathbf{C}^{-1}} = \\frac{333}{325} \\cdot \\frac{5\\sqrt{13}}{9} = \\frac{37 \\cdot 9}{65 \\cdot 5} \\cdot \\frac{5\\sqrt{13}}{9} = \\frac{37\\sqrt{13}}{65}$$\n为了将其与 $\\Delta=2$ 比较，我们检查 $37\\sqrt{13}  65 \\cdot 2 = 130$ 是否成立。这等价于 $\\sqrt{13}  \\frac{130}{37} \\approx 3.51$。由于 $3.6^2 = 12.96$ 且 $3.7^2 = 13.69$，$\\sqrt{13}$ 约等于 $3.606$，大于 $3.51$。因此，$\\|\\mathbf{s}_{\\mathrm{SD}}\\|_{\\mathbf{C}^{-1}}  \\Delta$。\n\n由于无约束最速下降步 $\\mathbf{s}_{\\mathrm{SD}}$ 和高斯-牛顿步 $\\mathbf{s}_{\\mathrm{GN}}$ 都位于信赖域之外，狗腿路径在其第一段（从原点到 $\\mathbf{s}_{\\mathrm{SD}}$ 的线段）上与信赖域边界相交。因此，狗腿步 $\\mathbf{s}_{\\mathrm{DL}}$ 位于最速下降方向 $-\\mathbf{g}$ 上，并落在信赖域的边界上。\n这意味着 $\\mathbf{s}_{\\mathrm{DL}}$ 的形式为 $\\mathbf{s}_{\\mathrm{DL}} = -\\lambda\\mathbf{g}$（对于某个标量 $\\lambda  0$），并且它必须满足 $\\|\\mathbf{s}_{\\mathrm{DL}}\\|_{\\mathbf{C}^{-1}} = \\Delta$。\n$$\\|-\\lambda\\mathbf{g}\\|_{\\mathbf{C}^{-1}} = \\lambda\\|\\mathbf{g}\\|_{\\mathbf{C}^{-1}} = \\Delta$$\n求解 $\\lambda$：\n$$\\lambda = \\frac{\\Delta}{\\|\\mathbf{g}\\|_{\\mathbf{C}^{-1}}} = \\frac{2}{5\\sqrt{13}/9} = \\frac{18}{5\\sqrt{13}}$$\n这就是所求的标量 $\\lambda$。狗腿步为 $\\mathbf{s}_{\\mathrm{DL}} = -\\frac{18}{5\\sqrt{13}}\\mathbf{g}$。\n\n作为验证，根据构造，$\\|\\mathbf{s}_{\\mathrm{DL}}\\|_{\\mathbf{C}^{-1}} = \\lambda \\|\\mathbf{g}\\|_{\\mathbf{C}^{-1}} = \\frac{18}{5\\sqrt{13}} \\cdot \\frac{5\\sqrt{13}}{9} = \\frac{18}{9} = 2 = \\Delta$。约束得到满足。\n最终答案是 $\\lambda$ 的精确值。",
            "answer": "$$\n\\boxed{\\frac{18}{5\\sqrt{13}}}\n$$"
        }
    ]
}