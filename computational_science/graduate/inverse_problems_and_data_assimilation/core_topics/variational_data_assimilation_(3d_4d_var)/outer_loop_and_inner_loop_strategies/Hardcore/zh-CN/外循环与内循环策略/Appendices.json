{
    "hands_on_practices": [
        {
            "introduction": "增量变分方法的内循环旨在求解一个线性的二次代价函数。本练习将带你深入理解内循环的核心计算过程，即如何构建增量代价函数，计算其在初始点的梯度，并求解得到高斯-牛顿更新步长 。掌握这些基本计算是理解和实现更复杂的外循环/内循环策略的基础。",
            "id": "3409171",
            "problem": "考虑一个在内外循环策略中出现的、单观测的增量变分资料同化内循环。设观测算子是线性的，由行向量 $\\,\\mathbf{H} = [\\,1,\\,2\\,]\\,$ 给出，其将 $\\mathbb{R}^{2}$ 映射到 $\\mathbb{R}$。背景误差协方差为 $\\,\\mathbf{B}=\\mathrm{diag}(1,4)\\,$，观测误差方差为 $\\,\\mathbf{R}=0.5\\,$（一个标量）。假设当前外循环的线性化点为 $\\,\\mathbf{x}_{k}=\\begin{pmatrix}1\\\\-1\\end{pmatrix}\\,$，背景态为 $\\,\\mathbf{x}_{b}=\\begin{pmatrix}0\\\\0\\end{pmatrix}\\,$，观测值为 $\\,y=1\\,$。 \n\n定义增量内循环代价函数（在三维变分（3D-Var）设定中，对可能非线性的观测算子进行线性化后使用）为\n$$\nJ(\\delta \\mathbf{x}) \\;=\\; \\tfrac{1}{2}\\,(\\delta \\mathbf{x}-\\delta \\mathbf{x}_{b})^{\\top}\\,\\mathbf{B}^{-1}\\,(\\delta \\mathbf{x}-\\delta \\mathbf{x}_{b})\n\\;+\\;\\tfrac{1}{2}\\,\\bigl(\\mathbf{H}\\,\\delta \\mathbf{x}-\\mathbf{d}\\bigr)^{\\top}\\,\\mathbf{R}^{-1}\\,\\bigl(\\mathbf{H}\\,\\delta \\mathbf{x}-\\mathbf{d}\\bigr),\n$$\n其中 $\\,\\delta \\mathbf{x}=\\mathbf{x}-\\mathbf{x}_{k}\\,$，$\\,\\delta \\mathbf{x}_{b}=\\mathbf{x}_{b}-\\mathbf{x}_{k}\\,$，以及线性化点上的新息为 $\\,\\mathbf{d} = y - \\mathbf{H}\\,\\mathbf{x}_{k}\\,$。\n\n- 计算在初始内循环迭代点 $\\,\\delta \\mathbf{x}=\\mathbf{0}\\,$ 处的内循环梯度 $\\,\\nabla J(\\delta \\mathbf{x})\\,$。\n- 计算最小化 $\\,J(\\delta \\mathbf{x})\\,$ 的高斯-牛顿步长 $\\,\\delta \\mathbf{x}^{\\star}\\,$。\n\n将最终答案以单个行矩阵 $\\,\\begin{pmatrix} g_{1}  g_{2}  \\delta x_{1}^{\\star}  \\delta x_{2}^{\\star}\\end{pmatrix}\\,$ 的形式给出，其中包含在 $\\,\\delta \\mathbf{x}=\\mathbf{0}\\,$ 处的梯度的两个分量，以及其后的最小化步长的两个分量。所有值均需精确表示，无需四舍五入。",
            "solution": "问题要求计算与增量变分资料同化代价函数 $J(\\delta \\mathbf{x})$ 相关的两个量。首先，是在初始内循环迭代点 $\\delta \\mathbf{x} = \\mathbf{0}$ 处代价函数的梯度。其次，是最小化 $J(\\delta \\mathbf{x})$ 的高斯-牛顿步长 $\\delta \\mathbf{x}^{\\star}$。\n\n代价函数由下式给出\n$$\nJ(\\delta \\mathbf{x}) = \\frac{1}{2}(\\delta \\mathbf{x}-\\delta \\mathbf{x}_{b})^{\\top}\\mathbf{B}^{-1}(\\delta \\mathbf{x}-\\delta \\mathbf{x}_{b}) + \\frac{1}{2}(\\mathbf{H}\\delta \\mathbf{x}-\\mathbf{d})^{\\top}\\mathbf{R}^{-1}(\\mathbf{H}\\delta \\mathbf{x}-\\mathbf{d})\n$$\n给定的数据如下：\n- 观测算子：$\\mathbf{H} = \\begin{pmatrix} 1  2 \\end{pmatrix}$\n- 背景误差协方差：$\\mathbf{B} = \\begin{pmatrix} 1  0 \\\\ 0  4 \\end{pmatrix}$\n- 观测误差方差：$R = 0.5$\n- 外循环线性化点：$\\mathbf{x}_{k} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$\n- 背景态：$\\mathbf{x}_{b} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n- 观测值：$y = 1$\n\n首先，我们必须计算定义的增量 $\\delta \\mathbf{x}_{b}$ 和 $\\mathbf{d}$。\n背景增量为 $\\delta \\mathbf{x}_{b} = \\mathbf{x}_{b} - \\mathbf{x}_{k}$：\n$$\n\\delta \\mathbf{x}_{b} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\n$$\n线性化点上的新息 $\\mathbf{d}$ 定义为 $\\mathbf{d} = y - \\mathbf{H}\\mathbf{x}_{k}$。由于 $y$ 是一个标量，且 $\\mathbf{H}\\mathbf{x}_k$ 的结果也是一个标量，因此 $\\mathbf{d}$ 是一个标量。\n$$\n\\mathbf{H}\\mathbf{x}_{k} = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = (1)(1) + (2)(-1) = 1 - 2 = -1\n$$\n$$\n\\mathbf{d} = 1 - (-1) = 2\n$$\n\n接下来，我们计算代价函数的梯度 $\\nabla J(\\delta \\mathbf{x})$。根据二次型的矩阵微积分标准法则，梯度为：\n$$\n\\nabla J(\\delta \\mathbf{x}) = \\mathbf{B}^{-1}(\\delta \\mathbf{x} - \\delta \\mathbf{x}_{b}) + \\mathbf{H}^{\\top}\\mathbf{R}^{-1}(\\mathbf{H}\\delta \\mathbf{x} - \\mathbf{d})\n$$\n我们需要计算此梯度在 $\\delta \\mathbf{x} = \\mathbf{0}$ 处的值：\n$$\n\\nabla J(\\mathbf{0}) = \\mathbf{B}^{-1}(\\mathbf{0} - \\delta \\mathbf{x}_{b}) + \\mathbf{H}^{\\top}\\mathbf{R}^{-1}(\\mathbf{H}\\mathbf{0} - \\mathbf{d}) = -\\mathbf{B}^{-1}\\delta \\mathbf{x}_{b} - \\mathbf{H}^{\\top}\\mathbf{R}^{-1}\\mathbf{d}\n$$\n我们需要逆矩阵 $\\mathbf{B}^{-1}$ 和 $\\mathbf{R}^{-1}$。\n$$\n\\mathbf{B} = \\begin{pmatrix} 1  0 \\\\ 0  4 \\end{pmatrix} \\implies \\mathbf{B}^{-1} = \\begin{pmatrix} 1^{-1}  0 \\\\ 0  4^{-1} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{4} \\end{pmatrix}\n$$\n$$\nR = 0.5 = \\frac{1}{2} \\implies R^{-1} = 2\n$$\n现在，我们可以将这些值代入 $\\nabla J(\\mathbf{0})$ 的表达式中：\n$$\n\\nabla J(\\mathbf{0}) = - \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} (2) (2)\n$$\n$$\n\\nabla J(\\mathbf{0}) = - \\begin{pmatrix} -1 \\\\ \\frac{1}{4} \\end{pmatrix} - 4 \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -\\frac{1}{4} \\end{pmatrix} - \\begin{pmatrix} 4 \\\\ 8 \\end{pmatrix}\n$$\n$$\n\\nabla J(\\mathbf{0}) = \\begin{pmatrix} 1 - 4 \\\\ -\\frac{1}{4} - 8 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ -\\frac{1}{4} - \\frac{32}{4} \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ -\\frac{33}{4} \\end{pmatrix}\n$$\n在 $\\delta \\mathbf{x}=\\mathbf{0}$ 处梯度的分量为 $g_1 = -3$ 和 $g_2 = -\\frac{33}{4}$。\n\n为了找到最小值点 $\\delta \\mathbf{x}^{\\star}$，我们将梯度 $\\nabla J(\\delta \\mathbf{x})$ 设为零。\n$$\n\\nabla J(\\delta \\mathbf{x}^{\\star}) = \\mathbf{B}^{-1}(\\delta \\mathbf{x}^{\\star} - \\delta \\mathbf{x}_{b}) + \\mathbf{H}^{\\top}\\mathbf{R}^{-1}(\\mathbf{H}\\delta \\mathbf{x}^{\\star} - \\mathbf{d}) = \\mathbf{0}\n$$\n整理各项，得到关于 $\\delta \\mathbf{x}^{\\star}$ 的线性方程组：\n$$\n(\\mathbf{B}^{-1} + \\mathbf{H}^{\\top}\\mathbf{R}^{-1}\\mathbf{H})\\delta \\mathbf{x}^{\\star} = \\mathbf{B}^{-1}\\delta \\mathbf{x}_{b} + \\mathbf{H}^{\\top}\\mathbf{R}^{-1}\\mathbf{d}\n$$\n矩阵 $(\\mathbf{B}^{-1} + \\mathbf{H}^{\\top}\\mathbf{R}^{-1}\\mathbf{H})$ 是代价函数的Hessian矩阵 $\\nabla^2 J$。右侧项是 $-\\nabla J(\\mathbf{0})$。因此，该方程组为 $\\nabla^2 J \\, \\delta \\mathbf{x}^{\\star} = -\\nabla J(\\mathbf{0})$。\n\n我们来计算Hessian矩阵：\n$$\n\\mathbf{H}^{\\top}\\mathbf{R}^{-1}\\mathbf{H} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} (2) \\begin{pmatrix} 1  2 \\end{pmatrix} = 2 \\begin{pmatrix} (1)(1)  (1)(2) \\\\ (2)(1)  (2)(2) \\end{pmatrix} = 2 \\begin{pmatrix} 1  2 \\\\ 2  4 \\end{pmatrix} = \\begin{pmatrix} 2  4 \\\\ 4  8 \\end{pmatrix}\n$$\n$$\n\\nabla^2 J = \\mathbf{B}^{-1} + \\mathbf{H}^{\\top}\\mathbf{R}^{-1}\\mathbf{H} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{4} \\end{pmatrix} + \\begin{pmatrix} 2  4 \\\\ 4  8 \\end{pmatrix} = \\begin{pmatrix} 3  4 \\\\ 4  8+\\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} 3  4 \\\\ 4  \\frac{33}{4} \\end{pmatrix}\n$$\n右侧项为 $-\\nabla J(\\mathbf{0}) = -\\begin{pmatrix} -3 \\\\ -\\frac{33}{4} \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ \\frac{33}{4} \\end{pmatrix}$。\n求解 $\\delta \\mathbf{x}^{\\star} = \\begin{pmatrix} \\delta x_1^{\\star} \\\\ \\delta x_2^{\\star} \\end{pmatrix}$ 的线性方程组为：\n$$\n\\begin{pmatrix} 3  4 \\\\ 4  \\frac{33}{4} \\end{pmatrix} \\begin{pmatrix} \\delta x_1^{\\star} \\\\ \\delta x_2^{\\star} \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ \\frac{33}{4} \\end{pmatrix}\n$$\n这代表了两个联立方程：\n1) $3\\delta x_1^{\\star} + 4\\delta x_2^{\\star} = 3$\n2) $4\\delta x_1^{\\star} + \\frac{33}{4}\\delta x_2^{\\star} = \\frac{33}{4}$\n\n从方程(1)，我们可得 $\\delta x_1^{\\star}$ 的表达式：\n$$\n\\delta x_1^{\\star} = \\frac{3 - 4\\delta x_2^{\\star}}{3} = 1 - \\frac{4}{3}\\delta x_2^{\\star}\n$$\n将此代入方程(2)：\n$$\n4\\left(1 - \\frac{4}{3}\\delta x_2^{\\star}\\right) + \\frac{33}{4}\\delta x_2^{\\star} = \\frac{33}{4}\n$$\n$$\n4 - \\frac{16}{3}\\delta x_2^{\\star} + \\frac{33}{4}\\delta x_2^{\\star} = \\frac{33}{4}\n$$\n$$\n4 - \\frac{33}{4} = \\left(\\frac{16}{3} - \\frac{33}{4}\\right)\\delta x_2^{\\star}\n$$\n$$\n\\frac{16 - 33}{4} = \\left(\\frac{64 - 99}{12}\\right)\\delta x_2^{\\star}\n$$\n$$\n\\frac{-17}{4} = \\frac{-35}{12}\\delta x_2^{\\star}\n$$\n$$\n\\delta x_2^{\\star} = \\frac{-17}{4} \\cdot \\frac{12}{-35} = \\frac{17 \\cdot 3}{35} = \\frac{51}{35}\n$$\n现在，将 $\\delta x_2^{\\star}$ 代回以求得 $\\delta x_1^{\\star}$：\n$$\n\\delta x_1^{\\star} = 1 - \\frac{4}{3}\\left(\\frac{51}{35}\\right) = 1 - \\frac{4 \\cdot 17}{35} = 1 - \\frac{68}{35} = \\frac{35-68}{35} = -\\frac{33}{35}\n$$\n因此最小值点为 $\\delta \\mathbf{x}^{\\star} = \\begin{pmatrix} -\\frac{33}{35} \\\\ \\frac{51}{35} \\end{pmatrix}$。\n\n最终答案要求一个行矩阵，其中包含梯度的两个分量，以及其后的最小化步长的两个分量：$\\begin{pmatrix} g_1  g_2  \\delta x_1^{\\star}  \\delta x_2^{\\star} \\end{pmatrix}$。\n$$\n\\begin{pmatrix} -3  -\\frac{33}{4}  -\\frac{33}{35}  \\frac{51}{35} \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -3  -\\frac{33}{4}  -\\frac{33}{35}  \\frac{51}{35} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "当观测算子为非线性时，外循环/内循环策略的威力便显现出来。本练习通过一个简单的标量非线性问题，让你实践一次完整的外循环迭代：首先在当前估计点对非线性算子进行线性化，然后求解内循环问题得到状态增量，最后更新状态 。这个过程清晰地展示了如何通过一系列二次近似问题来迭代求解一个非线性反演问题。",
            "id": "3409194",
            "problem": "考虑一个标量变分数据同化问题，其中状态变量为 $x \\in \\mathbb{R}$，观测算子为非线性的，由 $\\mathcal{H}(x)=\\sin(x)$ 给出。标准的变分数据同化代价函数为\n$$\nJ(x) = \\frac{1}{2} (x - x_{b})^{\\top} B^{-1} (x - x_{b}) + \\frac{1}{2} \\big(y - \\mathcal{H}(x)\\big)^{\\top} R^{-1} \\big(y - \\mathcal{H}(x)\\big),\n$$\n其中 $x_{b}$ 是背景（先验）状态，$B$ 是背景误差协方差，$y$ 是观测值，$R$ 是观测误差协方差。在增量式外循环和内循环策略中，我们在当前的外循环线性化点 $x_{0}$ 处对观测算子进行线性化，记 $x = x_{0} + \\delta x$，然后在更新 $x$ 并重新线性化之前，求解关于增量 $\\delta x$ 的内循环二次问题。\n\n给定标量数据 $x_{b} = 0$，$B = 1$，$R = 0.1$，$y = 0.5$，从 $x_{0} = x_{b}$ 开始执行一个外循环步骤，如下所示：\n- 在 $x_{0}$ 处对 $\\mathcal{H}(x)$ 进行一阶泰勒线性化，构建关于增量 $\\delta x$ 的相应内循环二次代价函数，并通过解析最小化求得内循环解 $\\delta x$。\n- 应用外循环更新 $x_{1} = x_{0} + \\delta x$。\n\n如果可能，请将最终数值精确表示为分数。无需四舍五入。最终答案必须是 $\\delta x$ 和 $x_{1}$ 这对数值，写成一个单行矩阵。",
            "solution": "此问题要求我们执行增量变分同化策略的一个外循环步骤。该过程包括：1) 在当前状态估计 $x_0$ 处对非线性观测算子 $\\mathcal{H}(x)$ 进行线性化；2) 构建并最小化关于增量 $\\delta x$ 的内循环二次代价函数，以求解最优增量；3) 更新状态估计。\n\n**步骤 1：线性化观测算子**\n给定的非线性观测算子为 $\\mathcal{H}(x) = \\sin(x)$。我们需要在初始点 $x_0 = x_b = 0$ 处对其进行线性化。\n线性化近似为 $\\mathcal{H}(x_0 + \\delta x) \\approx \\mathcal{H}(x_0) + H \\delta x$，其中 $H$ 是 $\\mathcal{H}(x)$ 在 $x_0$ 处的导数（雅可比矩阵）。\n- 算子在 $x_0$ 处的值为：$\\mathcal{H}(x_0) = \\sin(0) = 0$。\n- 算子的导数为：$\\mathcal{H}'(x) = \\cos(x)$。\n- 在 $x_0=0$ 处的线性化算子（雅可比矩阵）为：$H = \\mathcal{H}'(0) = \\cos(0) = 1$。\n\n**步骤 2：构建并最小化内循环代价函数**\n增量内循环的二次代价函数 $J_{inner}(\\delta x)$ 是通过将线性化算子代入原始代价函数 $J(x)$ 中得到的：\n$$\nJ_{inner}(\\delta x) = \\frac{1}{2} \\frac{(x_{0} + \\delta x - x_{b})^{2}}{B} + \\frac{1}{2} \\frac{(y - (\\mathcal{H}(x_{0}) + H \\delta x))^{2}}{R}\n$$\n代入已知数值：$x_0=0$, $x_b=0$, $B=1$, $y=0.5$, $R=0.1$, $\\mathcal{H}(x_0)=0$, $H=1$。\n$$\nJ_{inner}(\\delta x) = \\frac{1}{2} \\frac{(0 + \\delta x - 0)^{2}}{1} + \\frac{1}{2} \\frac{(0.5 - (0 + 1 \\cdot \\delta x))^{2}}{0.1}\n$$\n$$\nJ_{inner}(\\delta x) = \\frac{1}{2} (\\delta x)^{2} + 5 (0.5 - \\delta x)^{2}\n$$\n为了找到使该函数最小的 $\\delta x$，我们计算其导数并令其为零：\n$$\n\\frac{d J_{inner}}{d (\\delta x)} = \\delta x + 5 \\cdot 2(0.5 - \\delta x) \\cdot (-1) = \\delta x - 5 + 10 \\delta x = 11 \\delta x - 5\n$$\n令导数为零：\n$$\n11 \\delta x - 5 = 0 \\implies \\delta x = \\frac{5}{11}\n$$\n这是一个最小值，因为二阶导数 $\\frac{d^2 J_{inner}}{d(\\delta x)^2} = 11 > 0$。\n\n**步骤 3：更新状态**\n外循环使用求得的增量来更新状态：\n$$\nx_1 = x_0 + \\delta x = 0 + \\frac{5}{11} = \\frac{5}{11}\n$$\n因此，最优增量是 $\\delta x = \\frac{5}{11}$，更新后的状态是 $x_1 = \\frac{5}{11}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{5}{11}  \\frac{5}{11} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "外循环/内循环策略不仅限于状态估计，它同样适用于更具挑战性的联合状态-参数估计问题。在此练习中，观测算子同时依赖于状态和模型参数，这在实际应用中非常常见 。通过求解这个问题，你将学习如何将该策略推广到更高维的控制变量空间，并处理更复杂的雅可比矩阵，从而加深对该方法通用性的理解。",
            "id": "3409148",
            "problem": "考虑对于单个标量观测的联合状态-参数变分数据同化，其观测算子定义为 $h(x,p)=p\\,x$。令增广控制向量为 $z=\\begin{pmatrix}x  p\\end{pmatrix}^{\\top}$。假设高斯先验为 $z\\sim\\mathcal{N}(z_{b},B)$，其中 $z_{b}=\\begin{pmatrix}x_{b}  p_{b}\\end{pmatrix}^{\\top}$ 且 $B=\\mathrm{diag}(1,1)$；并假设高斯似然为 $y\\mid z\\sim\\mathcal{N}(h(x,p),R)$，其中 $R=0.1$。最大后验（MAP）估计量通过最小化非线性贝叶斯目标函数得到：\n$$\nJ(z)=\\frac{1}{2}\\,(z-z_{b})^{\\top}B^{-1}(z-z_{b})+\\frac{1}{2}\\,\\big(y-h(x,p)\\big)^{\\top}R^{-1}\\big(y-h(x,p)\\big).\n$$\n采用外循环和内循环策略：在外循环索引 $k$ 处，观测算子在当前迭代点 $z^{k}$ 处被线性化，内循环精确求解增量 $\\delta z=z-z^{k}$ 的线性化高斯最小二乘问题（等价地，求解与线性化 Karush–Kuhn–Tucker 条件相关的内对称块系统）。从背景值 $x_{b}=1$ 和 $p_{b}=2$ 以及标量观测值 $y=3$ 开始，通过在 $z^{0}=z_{b}$ 处进行线性化并精确求解内问题来执行一次外循环更新，以获得 $z^{1}=z^{0}+\\delta z$。请用行矩阵表示法将您的最终答案表示为精确的数对 $\\begin{pmatrix}x^{1}  p^{1}\\end{pmatrix}$。无需四舍五入，且不涉及物理单位。",
            "solution": "该问题要求在联合状态-参数估计的背景下，执行一次外循环/内循环更新。我们从初始点 $z^0 = z_b$ 开始，线性化观测算子，构建并求解内循环的二次规划问题，以获得增量 $\\delta z$，最后更新状态 $z^1 = z^0 + \\delta z$。\n\n**步骤 1：准备工作与线性化**\n- **控制向量**：$z = \\begin{pmatrix} x \\\\ p \\end{pmatrix}$。\n- **初始点**：$z^0 = z_b = \\begin{pmatrix} x_b \\\\ p_b \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n- **观测算子**：$h(z) = h(x,p) = px$。\n- **其他参数**：$B = \\mathrm{diag}(1,1)$, $R = 0.1$, $y = 3$。\n\n首先，我们在 $z^0$ 处线性化观测算子 $h(z)$。线性化形式为 $h(z^0 + \\delta z) \\approx h(z^0) + G^0 \\delta z$。\n- **算子在 $z^0$ 处的值**：$h(z^0) = p^0 x^0 = 2 \\cdot 1 = 2$。\n- **新息向量**（departure）：$d^0 = y - h(z^0) = 3 - 2 = 1$。\n- **雅可比矩阵** $G = \\nabla h(z) = \\begin{pmatrix} \\frac{\\partial h}{\\partial x}  \\frac{\\partial h}{\\partial p} \\end{pmatrix} = \\begin{pmatrix} p  x \\end{pmatrix}$。\n- **在 $z^0$ 处的雅可比矩阵**：$G^0 = \\begin{pmatrix} p^0  x^0 \\end{pmatrix} = \\begin{pmatrix} 2  1 \\end{pmatrix}$。\n\n**步骤 2：构建并求解内循环问题**\n内循环的目标是求解一个关于增量 $\\delta z$ 的二次代价函数。由于初始点是背景值 ($z^0 = z_b$)，代价函数的背景项简化了，其梯度满足的正规方程为：\n$$\n\\left( B^{-1} + (G^0)^\\top R^{-1} G^0 \\right) \\delta z = (G^0)^\\top R^{-1} d^0\n$$\n我们计算该方程的各个组成部分：\n- **逆协方差矩阵**：$B^{-1} = \\mathrm{diag}(1,1)$，$R^{-1} = 1/0.1 = 10$。\n- **Hessian矩阵的观测部分**：\n$$\n(G^0)^\\top R^{-1} G^0 = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} (10) \\begin{pmatrix} 2  1 \\end{pmatrix} = 10 \\begin{pmatrix} 4  2 \\\\ 2  1 \\end{pmatrix} = \\begin{pmatrix} 40  20 \\\\ 20  10 \\end{pmatrix}\n$$\n- **总Hessian矩阵**（内循环问题）：\n$$\nM = B^{-1} + (G^0)^\\top R^{-1} G^0 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} 40  20 \\\\ 20  10 \\end{pmatrix} = \\begin{pmatrix} 41  20 \\\\ 20  11 \\end{pmatrix}\n$$\n- **右侧向量**：\n$$\nb = (G^0)^\\top R^{-1} d^0 = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} (10) (1) = \\begin{pmatrix} 20 \\\\ 10 \\end{pmatrix}\n$$\n现在我们求解线性系统 $M \\delta z = b$。\n- **Hessian的行列式**：$\\det(M) = 41 \\cdot 11 - 20 \\cdot 20 = 451 - 400 = 51$。\n- **Hessian的逆**：\n$$\nM^{-1} = \\frac{1}{51} \\begin{pmatrix} 11  -20 \\\\ -20  41 \\end{pmatrix}\n$$\n- **求解增量 $\\delta z$**：\n$$\n\\delta z = M^{-1} b = \\frac{1}{51} \\begin{pmatrix} 11  -20 \\\\ -20  41 \\end{pmatrix} \\begin{pmatrix} 20 \\\\ 10 \\end{pmatrix} = \\frac{1}{51} \\begin{pmatrix} 220 - 200 \\\\ -400 + 410 \\end{pmatrix} = \\frac{1}{51} \\begin{pmatrix} 20 \\\\ 10 \\end{pmatrix}\n$$\n因此，增量为 $\\delta x = 20/51$ 和 $\\delta p = 10/51$。\n\n**步骤 3：更新状态**\n最后，我们更新控制向量：\n$$\nz^1 = z^0 + \\delta z = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} + \\begin{pmatrix} 20/51 \\\\ 10/51 \\end{pmatrix} = \\begin{pmatrix} 1 + 20/51 \\\\ 2 + 10/51 \\end{pmatrix} = \\begin{pmatrix} 51/51 + 20/51 \\\\ 102/51 + 10/51 \\end{pmatrix} = \\begin{pmatrix} 71/51 \\\\ 112/51 \\end{pmatrix}\n$$\n最终的更新状态为 $x^1 = 71/51$ 和 $p^1 = 112/51$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{71}{51}  \\frac{112}{51}\\end{pmatrix}}$$"
        }
    ]
}