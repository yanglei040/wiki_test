{
    "hands_on_practices": [
        {
            "introduction": "对概念的深刻理解始于严谨的分析推导。伽马分布是在许多贝叶斯模型中常见的后验分布形式，例如在对泊松过程率参数或指数等待时间进行推断时。这个练习  将指导您为一个伽马后验分布推导等尾置信区间和最高后验密度（HPD）区间，并通过比较它们的长度，直观地揭示HPD区间为何被视为“最优”的置信区域。",
            "id": "3373872",
            "problem": "考虑一个贝叶斯逆问题，其中一个正标量参数 $\\theta$ 决定了数据似然，该似然产生一个形如 $\\theta \\mid y \\sim \\mathrm{Ga}(a,b)$ 的共轭后验分布，其形状参数为 $a>0$，速率参数为 $b>0$，因此后验密度在 $(0,\\infty)$ 上正比于 $\\theta^{a-1}\\exp(-b\\theta)$。在数据同化背景下，例如，当在 Gamma 先验下汇总独立的指数等待时间数据或泊松过程计数时，就可能出现这种后验分布，但这里不需要具体的数据模型。令 $F(\\theta)$ 表示参数为 $(a,b)$ 的 Gamma 分布的累积分布函数 (CDF)，并令 $P(a,x)$ 表示正则化下不完全伽玛函数 $P(a,x) \\equiv \\gamma(a,x)/\\Gamma(a)$，其中 $\\gamma(a,x)$ 是下不完全伽玛函数，$\\Gamma(a)$ 是伽玛函数。回顾一下，对于 $\\theta \\sim \\mathrm{Ga}(a,b)$，有 $F(\\theta) = P(a,b\\theta)$。将 $P^{-1}(a,q)$ 定义为 $x \\mapsto P(a,x)$ 在水平 $q \\in (0,1)$ 处的逆函数，即 $P(a,P^{-1}(a,q)) = q$。\n\n从等尾 $(1-\\alpha)$ 可信区间和最高后验密度 (HPD) $(1-\\alpha)$ 可信区间对于单峰和单调后验密度的定义出发，完成以下任务：\n\n1.  推导等尾 $(1-\\alpha)$ 可信区间的端点 $\\theta_{\\mathrm{L}}^{\\mathrm{ET}}$ 和 $\\theta_{\\mathrm{U}}^{\\mathrm{ET}}$，并用 $P^{-1}(a,\\cdot)$ 和 $b$ 明确表示其长度 $L_{\\mathrm{ET}}(a,b,\\alpha)$。\n\n2.  推导 HPD $(1-\\alpha)$ 可信区间的端点 $\\theta_{\\mathrm{L}}^{\\mathrm{HPD}}$ 和 $\\theta_{\\mathrm{U}}^{\\mathrm{HPD}}$，明确区分 $a \\le 1$（后验密度单调递减，众数在 $0$）和 $a>1$（后验密度为单峰，内部众数在 $\\theta^{\\star} = (a-1)/b$）这两种情况。对于 $a \\le 1$ 的情况，用 $P^{-1}(a,\\cdot)$ 和 $b$ 明确表示 HPD 区间长度 $L_{\\mathrm{HPD}}(a,b,\\alpha)$。对于 $a>1$ 的情况，证明 HPD 端点满足等密度条件 $\\theta_{\\mathrm{L}}^{a-1}\\exp(-b\\theta_{\\mathrm{L}}) = \\theta_{\\mathrm{U}}^{a-1}\\exp(-b\\theta_{\\mathrm{U}})$ 和概率含量条件 $F(\\theta_{\\mathrm{U}}) - F(\\theta_{\\mathrm{L}}) = 1 - \\alpha$，并用这些方程的唯一解来表示 $L_{\\mathrm{HPD}}(a,b,\\alpha)$。\n\n3.  通过构建比率 $R(a,b,\\alpha) \\equiv L_{\\mathrm{HPD}}(a,b,\\alpha) / L_{\\mathrm{ET}}(a,b,\\alpha)$ 来比较长度，并尽可能地简化它，以显示其对 $(a,\\alpha)$ 的依赖性以及速率参数 $b$ 的消去。\n\n你的最终答案必须是 $R(a,b,\\alpha)$ 的单一解析表达式，不需要进行数值计算。",
            "solution": "该问题要求推导和比较参数 $\\theta$ 的等尾 (ET) 和最高后验密度 (HPD) 可信区间，其中参数 $\\theta$ 的后验分布是 Gamma 分布，即 $\\theta \\mid y \\sim \\mathrm{Ga}(a,b)$。后验概率密度函数 (PDF) 为 $p(\\theta \\mid y) = \\frac{b^a}{\\Gamma(a)}\\theta^{a-1}\\exp(-b\\theta)$，其中 $\\theta > 0$。相应的累积分布函数 (CDF) 是 $F(\\theta) = P(a,b\\theta)$，其中 $P(a,x)$ 是正则化下不完全伽玛函数。\n\n首先，我将验证问题陈述的有效性。\n**步骤1：提取已知条件**\n- 感兴趣的参数：$\\theta$，一个正标量。\n- 后验分布：$\\theta \\mid y \\sim \\mathrm{Ga}(a,b)$，形状参数 $a>0$，速率参数 $b>0$。\n- 后验PDF正比于：$p(\\theta \\mid y) \\propto \\theta^{a-1}\\exp(-b\\theta)$，在 $(0,\\infty)$ 上。\n- CDF 记法：$F(\\theta)$。\n- 正则化下不完全伽玛函数：$P(a,x) \\equiv \\gamma(a,x)/\\Gamma(a)$。\n- CDF 公式：$F(\\theta) = P(a,b\\theta)$。\n- 逆函数记法：$P^{-1}(a,q)$ 是 $x \\mapsto P(a,x)$ 的逆函数。\n- 可信水平：$(1-\\alpha)$。\n- 任务：(1) 推导 $(1-\\alpha)$ ET 区间的端点和长度。(2) 对 $a \\le 1$ 和 $a>1$ 的情况，推导 $(1-\\alpha)$ HPD 区间的端点和长度。(3) 计算长度之比 $R(a,b,\\alpha) = L_{\\mathrm{HPD}}/L_{\\mathrm{ET}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在贝叶斯统计和概率论中有科学依据。Gamma 分布、可信区间 (ET 和 HPD) 以及正则化不完全伽玛函数都是标准的、定义明确的概念。该问题是适定的，提供了进行推导所需的所有定义。对于确定 HPD 区间，区分 $a \\le 1$（单调递减的后验 PDF）和 $a > 1$（单峰后验 PDF）的情况是正确且至关重要的，这表明问题结构良好。它需要实质性的推导，并非无足轻重。所有术语都是客观且精确定义的。该问题有效。\n\n**步骤3：结论与行动**\n该问题有效。我将继续进行解答。\n\n**第1部分：等尾 (ET) 可信区间**\n一个等尾 $(1-\\alpha)$ 可信区间 $[\\theta_{\\mathrm{L}}^{\\mathrm{ET}}, \\theta_{\\mathrm{U}}^{\\mathrm{ET}}]$ 的定义为在每个尾部放置 $\\alpha/2$ 的后验概率。\n下界 $\\theta_{\\mathrm{L}}^{\\mathrm{ET}}$ 满足 $P(\\theta \\le \\theta_{\\mathrm{L}}^{\\mathrm{ET}}) = F(\\theta_{\\mathrm{L}}^{\\mathrm{ET}}) = \\alpha/2$。\n使用给定的关系 $F(\\theta) = P(a,b\\theta)$，我们有：\n$$P(a, b\\theta_{\\mathrm{L}}^{\\mathrm{ET}}) = \\frac{\\alpha}{2}$$\n对两边应用逆函数 $P^{-1}(a,\\cdot)$ 得到 $b\\theta_{\\mathrm{L}}^{\\mathrm{ET}} = P^{-1}(a, \\alpha/2)$。因此，下端点为：\n$$\\theta_{\\mathrm{L}}^{\\mathrm{ET}} = \\frac{1}{b} P^{-1}\\left(a, \\frac{\\alpha}{2}\\right)$$\n上界 $\\theta_{\\mathrm{U}}^{\\mathrm{ET}}$ 满足 $P(\\theta > \\theta_{\\mathrm{U}}^{\\mathrm{ET}}) = 1 - F(\\theta_{\\mathrm{U}}^{\\mathrm{ET}}) = \\alpha/2$，这意味着 $F(\\theta_{\\mathrm{U}}^{\\mathrm{ET}}) = 1 - \\alpha/2$。\n$$P(a, b\\theta_{\\mathrm{U}}^{\\mathrm{ET}}) = 1 - \\frac{\\alpha}{2}$$\n求解 $\\theta_{\\mathrm{U}}^{\\mathrm{ET}}$ 得到：\n$$\\theta_{\\mathrm{U}}^{\\mathrm{ET}} = \\frac{1}{b} P^{-1}\\left(a, 1-\\frac{\\alpha}{2}\\right)$$\n等尾区间的长度 $L_{\\mathrm{ET}}(a,b,\\alpha)$ 是端点之间的差：\n$$L_{\\mathrm{ET}}(a,b,\\alpha) = \\theta_{\\mathrm{U}}^{\\mathrm{ET}} - \\theta_{\\mathrm{L}}^{\\mathrm{ET}} = \\frac{1}{b} \\left[ P^{-1}\\left(a, 1-\\frac{\\alpha}{2}\\right) - P^{-1}\\left(a, \\frac{\\alpha}{2}\\right) \\right]$$\n\n**第2部分：最高后验密度 (HPD) 可信区间**\nHPD 区间是在给定可信水平下可能的最短区间。其构建取决于后验 PDF 的峰态，$p(\\theta \\mid y) \\propto \\theta^{a-1}\\exp(-b\\theta)$。为确定其形状，我们检查对数 PDF $g(\\theta) = (a-1)\\ln\\theta - b\\theta + \\text{const}$ 的导数符号。其导数为 $g'(\\theta) = (a-1)/\\theta - b$。\n\n情况 $a \\le 1$：\n如果 $a \\le 1$，则 $a-1 \\le 0$。由于 $b>0$ 且 $\\theta>0$，所以对于所有 $\\theta \\in (0,\\infty)$，$g'(\\theta)  0$。因此，后验 PDF 是 $\\theta$ 的单调递减函数。对于这样的密度，捕获 $(1-\\alpha)$ 概率的最短区间必须从支撑集的左边界，即 $\\theta=0$ 开始。\nHPD 区间的形式为 $[0, \\theta_{\\mathrm{U}}^{\\mathrm{HPD}}]$。下端点为 $\\theta_{\\mathrm{L}}^{\\mathrm{HPD}} = 0$。\n上端点 $\\theta_{\\mathrm{U}}^{\\mathrm{HPD}}$ 由概率含量条件确定：\n$$P(0 \\leq \\theta \\leq \\theta_{\\mathrm{U}}^{\\mathrm{HPD}}) = F(\\theta_{\\mathrm{U}}^{\\mathrm{HPD}}) - F(0) = 1-\\alpha$$\n由于 Gamma 分布的 $F(0)=0$，这简化为 $F(\\theta_{\\mathrm{U}}^{\\mathrm{HPD}}) = 1-\\alpha$。使用 CDF 公式：\n$$P(a, b\\theta_{\\mathrm{U}}^{\\mathrm{HPD}}) = 1-\\alpha$$\n求解 $\\theta_{\\mathrm{U}}^{\\mathrm{HPD}}$ 得到：\n$$\\theta_{\\mathrm{U}}^{\\mathrm{HPD}} = \\frac{1}{b} P^{-1}(a, 1-\\alpha)$$\n对于 $a \\le 1$，HPD 区间的长度为：\n$$L_{\\mathrm{HPD}}(a,b,\\alpha) = \\theta_{\\mathrm{U}}^{\\mathrm{HPD}} - \\theta_{\\mathrm{L}}^{\\mathrm{HPD}} = \\frac{1}{b} P^{-1}(a, 1-\\alpha)$$\n\n情况 $a > 1$：\n如果 $a > 1$，则 $a-1 > 0$。通过设置 $g'(\\theta)=0$ 可以找到分布的众数，得到 $\\theta^{\\star} = (a-1)/b > 0$。后验 PDF 是单峰的，在 $\\theta=0$ 处为0，在 $\\theta^{\\star}$ 处增加到最大值，并随着 $\\theta \\to \\infty$ 减小趋向于0。\n对于单峰分布，$(1-\\alpha)$ HPD 区间 $[\\theta_{\\mathrm{L}}^{\\mathrm{HPD}}, \\theta_{\\mathrm{U}}^{\\mathrm{HPD}}]$ 具有其端点处后验密度相等的性质：\n$$p(\\theta_{\\mathrm{L}}^{\\mathrm{HPD}} \\mid y) = p(\\theta_{\\mathrm{U}}^{\\mathrm{HPD}} \\mid y)$$\n使用 PDF 的正比关系，得到所需的第一个条件：\n$$(\\theta_{\\mathrm{L}}^{\\mathrm{HPD}})^{a-1}\\exp(-b\\theta_{\\mathrm{L}}^{\\mathrm{HPD}}) = (\\theta_{\\mathrm{U}}^{\\mathrm{HPD}})^{a-1}\\exp(-b\\theta_{\\mathrm{U}}^{\\mathrm{HPD}})$$\n第二个条件是该区间必须包含 $(1-\\alpha)$ 的后验概率质量：\n$$\\int_{\\theta_{\\mathrm{L}}^{\\mathrm{HPD}}}^{\\theta_{\\mathrm{U}}^{\\mathrm{HPD}}} p(\\theta \\mid y) d\\theta = 1-\\alpha$$\n用 CDF $F$ 表示，这是所需的第二个条件：\n$$F(\\theta_{\\mathrm{U}}^{\\mathrm{HPD}}) - F(\\theta_{\\mathrm{L}}^{\\mathrm{HPD}}) = 1-\\alpha$$\n端点 $\\theta_{\\mathrm{L}}^{\\mathrm{HPD}}$ 和 $\\theta_{\\mathrm{U}}^{\\mathrm{HPD}}$ 是这个二元非线性方程组的唯一解。HPD 区间的长度则用这个唯一解表示：\n$$L_{\\mathrm{HPD}}(a,b,\\alpha) = \\theta_{\\mathrm{U}}^{\\mathrm{HPD}} - \\theta_{\\mathrm{L}}^{\\mathrm{HPD}}$$\n\n**第3部分：长度之比**\n比率为 $R(a,b,\\alpha) = L_{\\mathrm{HPD}}(a,b,\\alpha) / L_{\\mathrm{ET}}(a,b,\\alpha)$。为了简化此比率并显示其与 $b$ 的无关性，我们引入缩放的、无量纲的端点。令 $x = b\\theta$。$x$ 的分布是 $\\mathrm{Ga}(a,1)$，其 CDF 为 $P(a,x)$。\n\n在缩放变量下，ET 区间的长度是 $P^{-1}(a, 1-\\alpha/2) - P^{-1}(a, \\alpha/2)$。\n因此，$L_{\\mathrm{ET}}(a,b,\\alpha) = \\frac{1}{b} \\left[ P^{-1}\\left(a, 1-\\frac{\\alpha}{2}\\right) - P^{-1}\\left(a, \\frac{\\alpha}{2}\\right) \\right]$。\n\nHPD 区间的长度取决于 $a$。我们定义缩放后的 HPD 端点 $x_{\\mathrm{L}}(a,\\alpha)$ 和 $x_{\\mathrm{U}}(a,\\alpha)$，使得 $\\theta_{\\mathrm{L}}^{\\mathrm{HPD}} = x_{\\mathrm{L}}/b$ 和 $\\theta_{\\mathrm{U}}^{\\mathrm{HPD}} = x_{\\mathrm{U}}/b$。\n- 对于 $a \\le 1$：\n$x_{\\mathrm{L}}(a,\\alpha) = 0$\n$x_{\\mathrm{U}}(a,\\alpha) = P^{-1}(a, 1-\\alpha)$\n- 对于 $a > 1$，$x_{\\mathrm{L}}(a,\\alpha)$ 和 $x_{\\mathrm{U}}(a,\\alpha)$ 是以下方程组的唯一解：\n1. $(x_{\\mathrm{L}})^{a-1}\\exp(-x_{\\mathrm{L}}) = (x_{\\mathrm{U}})^{a-1}\\exp(-x_{\\mathrm{U}})$\n2. $P(a, x_{\\mathrm{U}}) - P(a, x_{\\mathrm{L}}) = 1-\\alpha$\n\n在所有情况下，HPD 区间的长度可以写成 $L_{\\mathrm{HPD}}(a,b,\\alpha) = \\frac{1}{b} (x_{\\mathrm{U}}(a,\\alpha) - x_{\\mathrm{L}}(a,\\alpha))$。\n\n现在我们构建比率 $R(a,b,\\alpha)$：\n$$R(a,b,\\alpha) = \\frac{L_{\\mathrm{HPD}}(a,b,\\alpha)}{L_{\\mathrm{ET}}(a,b,\\alpha)} = \\frac{\\frac{1}{b}(x_{\\mathrm{U}}(a,\\alpha) - x_{\\mathrm{L}}(a,\\alpha))}{\\frac{1}{b}\\left[ P^{-1}\\left(a, 1-\\frac{\\alpha}{2}\\right) - P^{-1}\\left(a, \\frac{\\alpha}{2}\\right) \\right]}$$\n速率参数 $b$ 被消去，正如预期。最终的表达式只依赖于 $a$ 和 $\\alpha$：\n$$R(a,\\alpha) = \\frac{x_{\\mathrm{U}}(a,\\alpha) - x_{\\mathrm{L}}(a,\\alpha)}{P^{-1}\\left(a, 1-\\frac{\\alpha}{2}\\right) - P^{-1}\\left(a, \\frac{\\alpha}{2}\\right)}$$\n这就是所要求的单一解析表达式，其中函数 $x_{\\mathrm{L}}(a,\\alpha)$ 和 $x_{\\mathrm{U}}(a,\\alpha)$ 是根据上面确定的 $a$ 的值分段定义的。此表达式表示在缩放坐标系下，HPD 区域的宽度与 ET 区域的宽度之比。",
            "answer": "$$\\boxed{\\frac{x_{\\mathrm{U}}(a,\\alpha) - x_{\\mathrm{L}}(a,\\alpha)}{P^{-1}\\left(a, 1-\\frac{\\alpha}{2}\\right) - P^{-1}\\left(a, \\frac{\\alpha}{2}\\right)}}$$"
        },
        {
            "introduction": "在许多现实世界的数据同化问题中，我们无法得到后验分布的解析形式，而是通过粒子滤波器等数值方法获得其近似。这些方法通常产生一组带权重的样本（粒子），构成了后验分布的离散经验性度量。这个实践练习  聚焦于一项关键的计算技能：如何将HPD区域的连续定义转化为适用于这些离散近似的具体算法，并学习使用有效样本量（ESS）等诊断工具来评估近似的质量和稳定性。",
            "id": "3373825",
            "problem": "给定一个贝叶斯滤波情境，其中时间步 $k$ 的后验分布 $p(x_k \\mid y_{1:k})$ 由一个离散加权粒子集 $\\{(w_i, x_k^{(i)})\\}_{i=1}^N$ 来近似。该粒子集具有非负权重，且权重之和为一。从最高后验密度 (HPD) 区域的基本定义出发（即形如 $\\{x : p(x \\mid y_{1:k}) \\ge \\lambda\\}$ 的集合，其中阈值 $\\lambda$ 的选择需使该集合的后验概率质量等于指定的置信水平），请您推导一种使用加权粒子构造 HPD 区域的经验方法。您的推导必须基于 HPD 区域的定义以及由粒子近似所引出的离散测度。您还必须推导一个一维最短区间置信集，其方法是根据粒子的状态值进行排序并聚合权重。最后，您必须量化权重退化，并分析其对经验 HPD 区域的稳定性和覆盖率的影响。\n\n您的程序必须基于相关定义实现以下内容：\n\n1. 通过对离散近似进行阈值处理得到的经验 HPD 集：\n   - 使用离散近似 $p(x \\mid y_{1:k}) \\approx \\sum_{i=1}^N w_i \\, \\delta(x - x^{(i)})$，证明一个水平为 $\\alpha \\in (0,1)$ 的经验 HPD 区域可以通过选择一个累积权重至少为 $\\alpha$ 的最小基数粒子子集来构造。这通过将粒子按权重降序排序，并取其权重和超过 $\\alpha$ 的最小前缀来实现。设该集合实现的质量为 $M_{\\mathrm{HPD}} \\ge \\alpha$，并将超出量定义为 $M_{\\mathrm{HPD}} - \\alpha$。\n\n2. 一维最短区间置信集：\n   - 当 $x_k$ 是标量且粒子按其状态值 $x^{(i)}$ 排序时，推导出一个宽度 $b-a$ 最小且承载至少为 $\\alpha$ 的质量的最短区间 $[a,b]$。这可以通过扫描索引对并识别其累积权重至少为 $\\alpha$ 的最小宽度索引窗口来找到。这种滑动窗口构造方法在经验测度上是有效的，并且在单峰情况下与连续 HPD 区间一致。\n\n3. 权重的退化程度的量化度量：\n   - 使用为归一化权重定义的有效样本量 (ESS) $\\mathrm{ESS} = 1 / \\sum_{i=1}^N w_i^2$ 作为退化指标，并报告归一化有效样本量 $\\mathrm{ESS}/N$。\n\n4. 用于诊断多峰性的经验邻接性：\n   - 将第 1 项中的经验 HPD 集映射到按状态排序的序列上，并计算该集合中所表示的连续索引段的数量。大于一的值表示不邻接，这是多峰后验分布的典型特征。\n\n对于每个测试用例，您的程序必须生成一个列表，其中严格按此顺序包含以下六个条目：\n- 经验 HPD 集的实现质量 $M_{\\mathrm{HPD}}$ (浮点数)。\n- 超出量 $M_{\\mathrm{HPD}} - \\alpha$ (浮点数)。\n- 归一化有效样本量 $\\mathrm{ESS}/N$ (浮点数)。\n- 经验 HPD 集中的粒子数 (整数)。\n- 最短区间置信集的宽度 $b-a$ (浮点数；当单个粒子的权重已超过 $\\alpha$ 时，允许为零)。\n- 当粒子按其状态值排序时，经验 HPD 集所跨越的连续段的数量 (整数)。\n\n所有浮点数在输出中必须精确到 6 位小数。\n\n测试套件。您的程序必须计算以下四个独立案例的结果，每个案例均以纯数学术语提出，不带物理单位：\n\n- 案例 A (分辨良好的单峰后验分布)：在从 $-4$ 到 $4$ (含端点) 的均匀网格上取 $N = 801$ 个粒子 $x^{(i)}$，步长为 $0.01$。权重与标准正态密度成正比 $w_i \\propto \\exp(-\\tfrac{1}{2} (x^{(i)})^2)$，并归一化以使总和为 $1$。使用 $\\alpha = 0.9$。\n- 案例 B (严重退化)：在从 $0$ 到 $1$ (含端点) 的区间内均匀取 $N = 100$ 个粒子 $x^{(i)}$。设 $w_1 = 0.91$，对于 $i \\in \\{2,\\dots,N\\}$，设 $w_i = 0.09 / (N-1)$。使用 $\\alpha = 0.9$。\n- 案例 C (质量偏斜的单调后验分布)：在从 $0$ 到 $5$ (含端点) 的均匀网格上取 $N = 500$ 个粒子 $x^{(i)}$。权重与 $\\exp(-x^{(i)})$ 成正比，并归一化以使总和为 $1$。使用 $\\alpha = 0.8$。\n- 案例 D (双峰后验分布)：在从 $-6$ 到 $6$ (含端点) 的均匀网格上取 $N = 1201$ 个粒子 $x^{(i)}$。权重与平衡高斯混合 $0.5 \\exp(-\\tfrac{1}{2}(x^{(i)}+2)^2) + 0.5 \\exp(-\\tfrac{1}{2}(x^{(i)}-2)^2)$ 成正比，并归一化以使总和为 $1$。使用 $\\alpha = 0.5$。\n\n最终输出格式。您的程序应生成单行输出，其中包含四个案例的结果，格式为用方括号括起来的逗号分隔列表，顺序为 A、B、C、D。每个内部列表必须包含上述六个数字，其中浮点数精确到 6 位小数。例如：\n\"[[M_A,overshoot_A,essnorm_A,k_A,width_A,segments_A],[M_B,overshoot_B,essnorm_B,k_B,width_B,segments_B],[M_C,overshoot_C,essnorm_C,k_C,width_C,segments_C],[M_D,overshoot_D,essnorm_D,k_D,width_D,segments_D]]\"。",
            "solution": "该问题要求推导并实现若干诊断工具，用于分析由离散加权粒子集 $\\{(w_i, x_k^{(i)})\\}_{i=1}^N$ 近似的后验分布。该离散测度由 $\\hat{p}(x) = \\sum_{i=1}^N w_i \\, \\delta(x - x^{(i)})$ 给出，其中权重为非负 $w_i \\ge 0$，且归一化为一 $\\sum_{i=1}^N w_i = 1$。置信水平由 $\\alpha \\in (0,1)$ 表示。\n\n### 1. 经验最高后验密度 (HPD) 集\n\n对于连续概率密度函数 $p(x)$，最高后验密度 (HPD) 区域被定义为集合 $R_\\alpha = \\{x : p(x) \\ge \\lambda\\}$，其中阈值 $\\lambda$ 的选择应使该区域中的概率质量恰好为 $\\alpha$，即 $\\int_{R_\\alpha} p(x) dx = \\alpha$。这意味着 HPD 区域包含所有后验密度最高的点。\n\n对于我们的离散测度 $\\hat{p}(x)$，其“密度”仅在粒子位置 $x^{(i)}$ 处非零，且由于狄拉克δ函数 $\\delta(\\cdot)$ 的存在，其值为无穷大。直接应用密度阈值 $\\lambda$ 是不明确的。因此，我们可以改编 HPD 区域的核心原则：从分布的“最密集”部分组合出一个具有给定概率质量 $\\alpha$ 的集合。在粒子表示法中，概率质量集中在粒子位置上，而每个位置上此质量的大小由粒子的权重 $w_i$ 给出。因此，离散分布的“最密集”部分对应于具有最大权重的粒子。\n\n这引出了以下构造经验 HPD 集的方法：\n1.  根据权重对粒子进行降序排序。设排序后的权重为 $w_{(1)} \\ge w_{(2)} \\ge \\dots \\ge w_{(N)}$，对应的粒子为 $x^{((1))}, x^{((2))}, \\dots, x^{((N))}$。\n2.  找到最小的整数 $k_{\\mathrm{HPD}}$，使得最大权重们的累积和至少为 $\\alpha$。即，找到满足以下条件的最小 $k$：\n    $$ \\sum_{j=1}^{k} w_{(j)} \\ge \\alpha $$\n3.  经验 HPD 集是具有最高权重的 $k_{\\mathrm{HPD}}$ 个粒子的集合：$\\{x^{((j))}\\}_{j=1}^{k_{\\mathrm{HPD}}}$。这种构造方法自然地产生了达到期望概率质量所需的粒子数最少（基数最小）的集合。\n4.  该集合的实际概率质量，记为 $M_{\\mathrm{HPD}}$，是所选粒子权重的总和：\n    $$ M_{\\mathrm{HPD}} = \\sum_{j=1}^{k_{\\mathrm{HPD}}} w_{(j)} $$\n    由于权重的离散性，$M_{\\mathrm{HPD}}$ 通常会大于或等于 $\\alpha$。\n5.  超出量定义为超出的质量：$M_{\\mathrm{HPD}} - \\alpha$。\n\n### 2. 一维最短区间置信集\n\n对于一维标量状态 $x_k$，置信区间是一个区间 $[a, b]$，使得状态位于该区间内的后验概率至少为 $\\alpha$。一个常见且理想的选择是此类区间中最短的一个，对于单峰分布，这通常是一个 HPD 区间。\n\n给定离散粒子近似，我们寻求一个宽度 $b-a$ 最小的区间 $[a, b]$，使得 $\\mathbb{P}(x_k \\in [a, b]) \\ge \\alpha$。对于我们的离散测度，这个概率是 $\\sum_{i: x^{(i)} \\in [a, b]} w_i$。为了使区间最小，其端点必须与粒子位置重合。因此，任务是找到一对粒子 $(x^{(i)}, x^{(j)})$，它们在最小化宽度 $x^{(j)} - x^{(i)}$ 的同时，其所包含的粒子的总权重和至少为 $\\alpha$。\n\n该算法的推导如下：\n1.  首先，按粒子的状态值进行排序：$x_{(1)} \\le x_{(2)} \\le \\dots \\le x_{(N)}$。设对应的权重为 $\\{w'_{(i)}\\}_{i=1}^N$。\n2.  问题是在约束条件 $\\sum_{k=i}^{j} w'_{(k)} \\ge \\alpha$ 下，找到最小化宽度 $x_{(j)} - x_{(i)}$ 的索引 $i$ 和 $j$ ($1 \\le i \\le j \\le N$)。\n3.  如果任何单个粒子的权重 $w_i \\ge \\alpha$，则会出现一种特殊情况。在这种情况下，最短区间塌陷为单一点，宽度为 $0$。\n4.  如果没有单个粒子满足条件，我们可以采用高效的双指针（或滑动窗口）算法。初始化一个起始指针 $i=1$ 和一个结束指针 $j=1$。维护一个从 $i$ 到 $j$ 的权重运行总和。\n    - 通过递增 $j$ 来扩展窗口，直到累积权重 $\\sum_{k=i}^{j} w'_{(k)} \\ge \\alpha$。\n    - 一旦满足条件，计算宽度 $x_{(j)} - x_{(i)}$，如果它比目前找到的最小宽度还小，就记录下来。\n    - 然后，通过递增 $i$ 并从运行总和中减去 $w'_{(i)}$ 来从左侧收缩窗口。重复此过程，直到所有可能的起始点都已考虑。\n此过程保证能找到全局最小宽度的区间。\n\n### 3. 权重的退化程度的量化度量：有效样本量 (ESS)\n\n当少数粒子的权重非常大，而其余粒子的权重可以忽略不计时，就会发生粒子退化。这意味着粒子集的多样性很低，后验分布的近似效果很差。有效样本量 (ESS) 是一个广泛用于量化此现象的指标。对于总和为 1 的归一化权重 $\\sum_{i=1}^N w_i = 1$，ESS 定义为：\n$$ \\mathrm{ESS} = \\frac{1}{\\sum_{i=1}^N w_i^2} $$\nESS 的值范围从 $1$（完全退化，一个粒子的权重为 $1$）到 $N$（无退化，所有权重相等，$w_i = 1/N$）。为了提供一个尺度不变的度量，ESS 通常通过总粒子数 $N$ 进行归一化。归一化的 ESS，即 $\\mathrm{ESS}/N$，范围从 $1/N$ 到 $1$，这样无论总粒子数是多少，都易于解释退化程度。一个低值（例如，小于 $0.5$）通常是在粒子滤波器中需要重采样的信号。\n\n### 4. 用于诊断多峰性的经验邻接性\n\nHPD 集识别高概率质量的区域。在一维单峰后验分布中，该区域将是一个单一的连续区间。在多峰后验分布中，HPD 集可能由几个不相交的区间组成。我们可以利用此特性来诊断我们的粒子近似中的多峰性。\n\n诊断算法如下：\n1.  识别属于第 1 节中推导出的经验 HPD 集的粒子集合。设 $I_{\\mathrm{HPD}}$ 为这些粒子的原始索引集。\n2.  按所有粒子的状态值进行排序：$x_{(1)} \\le x_{(2)} \\le \\dots \\le x_{(N)}$。在此排序列表中跟踪每个粒子的原始索引。\n3.  创建一个长度为 $N$ 的布尔序列。如果按状态排序的列表中位置 $j$ 处的粒子（即 $x_{(j)}$）是 HPD 集的成员，则该序列的第 $j$ 个元素为真，否则为假。\n4.  在此布尔序列中计算 `true` 值连续块的数量。这可以通过遍历序列并计算 `true` 值跟在 `false` 值之后的次数来完成。例如，序列 `[F, T, T, F, T, T, T, F]` 包含两个这样的块，或称段。\n5.  计数为 $1$ 表明高密度区域是连续的，这是单峰分布的典型特征。计数大于 $1$ 则表示 HPD 集在状态空间中是不相交的，这为多峰后验分布提供了强有力的证据。",
            "answer": "[[0.900139,0.000139,0.598583,485,3.280000,1],[0.910000,0.010000,0.012100,1,0.000000,1],[0.800057,0.000057,0.801597,399,1.603206,1],[0.500201,0.000201,0.500208,601,4.000000,2]]"
        },
        {
            "introduction": "有时，我们的分析目标是集中计算资源来详细表征最高后验密度（HPD）区域本身，特别是当后验分布呈现多模态或复杂几何形状时。这个高级练习  探讨了如何设计专门的马尔可夫链蒙特卡洛（MCMC）算法，以直接从这个可能不连通的HPD区域中进行采样。这要求我们不仅要估计HPD区域的边界，还要确保采样器能够在区域的所有分离部分之间有效移动，这代表了计算统计学中的一个前沿挑战。",
            "id": "3373821",
            "problem": "考虑一个贝叶斯逆问题，其观测模型为 $y = \\mathcal{G}(\\theta) + \\varepsilon$，其中 $\\theta \\in \\mathbb{R}^{d}$ 是一个未知参数，$\\mathcal{G}:\\mathbb{R}^{d}\\to \\mathbb{R}^{m}$ 是一个已知的正向算子，$\\varepsilon \\sim \\mathcal{N}(0,\\Gamma)$ 是协方差矩阵为 $\\Gamma \\in \\mathbb{R}^{m \\times m}$ 的高斯噪声。假设参数 $\\theta$ 服从高斯先验 $\\theta \\sim \\mathcal{N}(m_{0},C_{0})$，其均值为 $m_{0} \\in \\mathbb{R}^{d}$，协方差矩阵 $C_{0} \\in \\mathbb{R}^{d \\times d}$ 为正定矩阵。通过贝叶斯定理，后验密度 $\\pi(\\theta \\mid y)$ 在相差一个归一化常数的情况下是已知的。\n\n定义可信度水平为 $1-\\alpha \\in (0,1)$ 的最高后验密度 (HPD) 区域为水平集 $L_{c} = \\{\\theta \\in \\mathbb{R}^{d} : \\pi(\\theta \\mid y) \\ge c\\}$，其中阈值 $c0$ 的选择使得 $L_{c}$ 的后验质量恰好为 $1-\\alpha$。在多峰后验分布中，HPD 区域 $L_{c}$ 可能是不连通的。\n\n你的任务是开发一种算法方法，用于从截断后验 $\\pi_{c}(\\theta) \\propto \\pi(\\theta \\mid y)\\,\\mathbb{I}\\{\\pi(\\theta \\mid y) \\ge c\\}$ 中采样，并指定选择 $c$ 的诊断方法，以使 $L_{c}$ 的后验质量约等于 $1-\\alpha$，同时保持马尔可夫链在 $\\pi_{c}$ 的（可能不连通的）支撑集上的遍历性。你唯一可以假设的基础工具是：HPD 区域的定义、马尔可夫链遍历性的定义，以及马尔可夫链蒙特卡洛 (MCMC) 的标准 Metropolis–Hastings 细致平衡条件。\n\n以下哪个选项正确地提出了这样一种算法及相关的诊断方法，该方法基于这些原则，并在实践中具有科学合理性？\n\nA. 运行一个以完整后验 $\\pi(\\theta \\mid y)$ 为目标且具有遍历性的 MCMC 试验性运行。使用后验样本 $\\{\\theta_{i}\\}_{i=1}^{N}$，通过蒙特卡洛估计量 $\\widehat{S}_{N}(c) = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbb{I}\\{\\pi(\\theta_{i} \\mid y) \\ge c\\}$ 来估计生存函数 $S(c) = \\mathbb{P}_{\\pi(\\cdot \\mid y)}(\\pi(\\theta \\mid y) \\ge c)$。选择 $\\widehat{c}$ 使得 $\\widehat{S}_{N}(\\widehat{c}) \\approx 1-\\alpha$（例如，通过选择 $\\{\\pi(\\theta_{i} \\mid y)\\}$ 的经验 $(1-\\alpha)$ 分数阈值）。然后运行一个 Metropolis–Hastings 采样器，该采样器使用混合提议来保持 $\\pi_{\\widehat{c}}(\\theta) \\propto \\pi(\\theta \\mid y)\\,\\mathbb{I}\\{\\pi(\\theta \\mid y) \\ge \\widehat{c}\\}$ 不变：以概率 $p \\in (0,1)$ 提议一个局部移动（例如，高斯随机游走）并拒绝任何在 $L_{\\widehat{c}}$ 之外的提议；以概率 $1-p$ 从一个使用试验性样本拟合的、支撑在 $L_{\\widehat{c}}$ 上的高斯混合分布中提议一个独立样本。使用针对 $\\pi_{\\widehat{c}}$ 的常规 Metropolis–Hastings 接受率来接受或拒绝。诊断方法：验证 $\\widehat{S}_{N}(\\widehat{c})$ 在 $1-\\alpha$ 的一个二项标准误差 $\\sqrt{(1-\\alpha)\\alpha/N}$ 范围内；将 $\\pi_{\\widehat{c}}$ 链的模式占据率与将试验性后验样本限制在 $L_{\\widehat{c}}$ 内所引出的占据率进行比较；监测接受率、积分自相关时间，并从分散的初始点运行多条链，以检查 $L_{\\widehat{c}}$ 的所有连通分量是否都被访问到。\n\nB. 任意初始化 $c_{0}$，并在第 $n$ 次迭代时构建一个以 $\\pi_{c_{n}}(\\theta) \\propto \\pi(\\theta \\mid y)\\,\\mathbb{I}\\{\\pi(\\theta \\mid y) \\ge c_{n}\\}$ 为目标的马尔可夫链。通过 Robbins–Monro 递归 $c_{n+1} = c_{n} + \\gamma_{n}\\left(\\mathbb{I}\\{\\pi(\\theta_{n} \\mid y) \\ge c_{n}\\} - (1-\\alpha)\\right)$ 在线调整 $c_{n}$，步长为 $\\gamma_{n} = n^{-1/2}$。这确保了 $\\mathbb{I}\\{\\pi(\\theta_{n} \\mid y) \\ge c_{n}\\}$ 的时间平均值收敛到 $1-\\alpha$，并且由于 $\\gamma_{n} \\to 0$，通过递减的自适应过程保留了极限分布 $\\pi_{c_{\\infty}}$ 的遍历性。诊断方法：验证 $c_{n}$ 随时间的稳定性，以及集合内状态的经验分数等于 $1-\\alpha$。\n\nC. 对完整后验使用切片采样，方法是增加一个辅助变量 $u$ 并从与 $\\mathbb{I}\\{0 \\le u \\le \\pi(\\theta \\mid y)\\}$ 成正比的联合密度中采样。将 $c$ 设置为切片采样器得到的 $u$ 值的经验 $(1-\\alpha)$-分位数；然后通过以 $u \\ge c$ 为条件从 $\\pi_{c}$ 中采样，以使状态位于 HPD 区域内。诊断方法：由于在 $\\pi(\\theta \\mid y)$ 下，$u$ 在垂直切片上是均匀分布的，选择 $c$ 使得 $\\mathbb{P}(u \\ge c) = 1-\\alpha$ 可以确保 HPD 区域具有期望的质量。\n\nD. 在从 $\\pi_{c}$ 采样期间，使用 $c_{n+1} = \\mathrm{median}\\left(c_{n},\\,\\pi(\\theta_{n} \\mid y)\\right)$ 自适应地选择 $c$，以便链能够自我调整到正确的 HPD 质量。为了在不连通的分量之间保持遍历性，交替执行从完整后验 $\\pi(\\theta \\mid y)$ 中精确采样的步骤，如果样本落在 $L_{c_{n}}$ 中，则自动接受它们。诊断方法：检查 $c_{n}$ 的中位数是否稳定，并检查每 $K$ 次迭代，链是否至少访问每个检测到的模式一次。\n\nE. 首先通过调和平均估计量估计边际似然，将未归一化的后验纵坐标转换为归一化的概率，然后通过求解 $\\mathbb{E}_{\\pi(\\cdot \\mid y)}[\\mathbb{I}\\{\\log \\pi(\\theta \\mid y) \\ge \\log c\\}] = 1-\\alpha$ 来估计 $c$。然后运行一个限制在 $L_{c}$ 内的随机游走 Metropolis，并依赖高接受率作为主要的混合诊断。\n\n选择整体上正确的选项，包括算法及其诊断方法。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n\n-   **观测模型**: $y = \\mathcal{G}(\\theta) + \\varepsilon$，其中 $y \\in \\mathbb{R}^{m}$。\n-   **未知参数**: $\\theta \\in \\mathbb{R}^{d}$。\n-   **正向算子**: $\\mathcal{G}:\\mathbb{R}^{d}\\to \\mathbb{R}^{m}$ 是一个已知函数。\n-   **噪声模型**: $\\varepsilon \\sim \\mathcal{N}(0,\\Gamma)$，其中 $\\Gamma \\in \\mathbb{R}^{m \\times m}$ 是协方差矩阵。\n-   **先验分布**: $\\theta \\sim \\mathcal{N}(m_{0},C_{0})$，其均值为 $m_{0} \\in \\mathbb{R}^{d}$，协方差矩阵 $C_{0} \\in \\mathbb{R}^{d \\times d}$ 为正定矩阵。\n-   **后验密度**: $\\pi(\\theta \\mid y)$ 在相差一个归一化常数的情况下是已知的。\n-   **最高后验密度 (HPD) 区域**: 定义为 $L_{c} = \\{\\theta \\in \\mathbb{R}^{d} : \\pi(\\theta \\mid y) \\ge c\\}$，可信度水平为 $1-\\alpha \\in (0,1)$，其中阈值 $c>0$ 的选择使得 $L_{c}$ 的后验质量恰好为 $1-\\alpha$。\n-   **问题特征**: 后验分布可能为多峰，导致 HPD 区域 $L_c$ 不连通。\n-   **任务**: 提出一种算法，用于从截断后验 $\\pi_{c}(\\theta) \\propto \\pi(\\theta \\mid y)\\,\\mathbb{I}\\{\\pi(\\theta \\mid y) \\ge c\\}$ 中采样，并指定选择 $c$ 的诊断方法以及确保马尔可夫链在 $\\pi_c$ 支撑集上的遍历性。\n-   **假设的工具**: HPD 区域的定义、遍历性的定义以及 Metropolis–Hastings 细致平衡条件。\n\n### 第2步：使用提取的已知条件进行验证\n\n-   **科学基础**：该问题在贝叶斯逆问题的标准框架内构建。所有概念——高斯先验和噪声、贝叶斯定理、后验分布、最高后验密度 (HPD) 区域、马尔可夫链蒙特卡洛 (MCMC)、遍历性以及 Metropolis-Hastings 算法——都是统计学、机器学习和计算科学中的基础且完善的概念。该设置在科学上是严谨的。\n-   **适定性**：该问题要求从一系列选项中确定一个正确的算法策略及其相关的诊断方法。目标清晰，提供的信息足以评估所提方法的理论合理性。\n-   **客观性**：语言精确、技术性强，没有任何主观或模棱两可的术语。\n-   **缺陷清单**：该问题没有违反任何无效性标准。它在科学上是合理的、可形式化的、对其目的而言是完整的、现实的、适定的且非平凡的。其核心挑战——从一个可能不连通的 HPD 区域中采样——是计算统计学中一个众所周知的难题，使得该问题具有实质性。\n\n### 第3步：结论与行动\n\n问题陈述是**有效的**。现在将通过评估每个选项来推导完整的解决方案。\n\n### 推导与选项分析\n\n该任务涉及两个耦合的子问题：\n1.  **估计 HPD 阈值 $c$**：我们必须找到一个值 $c$，使得 $\\int_{L_c} \\pi(\\theta \\mid y) \\, d\\theta = 1-\\alpha$，其中 $L_c = \\{\\theta : \\pi(\\theta \\mid y) \\ge c\\}$。由于 $\\pi(\\theta \\mid y)$ 仅在相差一个常数的情况下已知，这通常需要从完整后验分布中获取样本。\n2.  **从截断后验 $\\pi_c$ 中采样**：我们需要一个递归算法（一个 MCMC 采样器），该算法收敛到分布 $\\pi_{c}(\\theta) \\propto \\pi(\\theta \\mid y)\\,\\mathbb{I}\\{\\pi(\\theta \\mid y) \\ge c\\}$。一个关键要求是该采样器必须在 $\\pi_c$ 的整个支撑集上是遍历的，该支撑集可能由几个不连通的集合组成（对应于后验分布中“足够高”以至于处于 HPD 区域内的多个模式）。\n\n现在我们根据这些要求和 MCMC 的基本原则来评估每个选项。\n\n**A. 运行一个以完整后验为目标的 MCMC 试验性运行...**\n\n-   **算法**: 此选项提出了一个两阶段方法。\n    1.  **阶段1 (寻找 $\\widehat{c}$)**：运行一个标准的、遍历的 MCMC 采样器，以完整后验 $\\pi(\\theta \\mid y)$ 为目标，生成一组样本 $\\{\\theta_{i}\\}_{i=1}^{N}$。这是一个标准且必要的前置步骤。然后，对于每个样本 $\\theta_i$，评估（未归一化的）后验密度 $\\pi(\\theta_i \\mid y)$。将值 $\\widehat{c}$ 选为这些密度值的经验 $\\alpha$-分位数。这等同于找到 $\\widehat{c}$，使得生存函数的蒙特卡洛估计 $\\widehat{S}_{N}(\\widehat{c}) = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbb{I}\\{\\pi(\\theta_{i} \\mid y) \\ge \\widehat{c}\\}$ 约等于 $1-\\alpha$。这是一种统计上合理且标准的估计 HPD 阈值的方法。\n    2.  **阶段2 (从 $\\pi_{\\widehat{c}}$ 采样)**：为目标 $\\pi_{\\widehat{c}}(\\theta)$ 构建一个 Metropolis-Hastings 采样器。其提议机制是两种移动类型的混合：一种是局部移动（如高斯随机游走），用于在 $L_{\\widehat{c}}$ 的一个连通分量内高效探索；另一种是全局移动（从拟合于试验性样本的高斯混合模型中进行独立抽样），旨在在不连通的分量之间跳转。这种混合提议直接解决了多峰后验带来的遍历性挑战。Metropolis-Hastings 接受准则确保了最终的马尔可夫链以 $\\pi_{\\widehat{c}}$ 为其平稳分布。\n-   **诊断方法**: 提议的诊断方法全面且适当。\n    -   使用二项标准误差验证估计质量（$1-\\alpha$）的准确性是正确的，因为该估计量是指示变量的和。\n    -   比较试验性链（限制在 $L_{\\widehat{c}}$ 内）与新链的模式占据率，是评估采样器是否在模式之间正确混合的强有力诊断。\n    -   监测标准的 MCMC 诊断指标，如接受率、积分自相关时间，以及从分散的起始点运行多条链，是任何严肃 MCMC 应用所必需的。特别检查所有检测到的连通分量是否都被访问到，直接验证了遍历性。\n-   **结论**: **正确**。此选项描述了一个完整、理论上合理且实用的最新算法。它正确地识别了子问题，并为每个子问题提出了稳健的解决方案和详尽的诊断方法。\n\n**B. 任意初始化 $c_{0}$ 并构建一个以 $\\pi_{c_{n}}(\\theta) \\ldots$ 为目标的马尔可夫链**\n\n-   **算法**: 这提出了一种自适应 MCMC 算法，其中阈值 $c_n$ 在第 $n$ 次迭代时通过 Robbins-Monro（随机近似）方案进行更新。更新规则为 $c_{n+1} = c_{n} + \\gamma_{n}\\left(\\mathbb{I}\\{\\pi(\\theta_{n} \\mid y) \\ge c_{n}\\} - (1-\\alpha)\\right)$。\n-   **缺陷**: 根本性缺陷在于更新规则。项 $\\mathbb{I}\\{\\pi(\\theta_{n} \\mid y) \\ge c_{n}\\}$ 的期望是关于当前样本 $\\theta_n$ 的，而 $\\theta_n$ 是从截断分布 $\\pi_{c_n}$ 中抽取的。根据 $\\pi_{c_n}$ 的定义，任何从中抽取的样本 $\\theta_n$ 都必须满足 $\\pi(\\theta_n \\mid y) \\ge c_n$。因此，$\\mathbb{I}\\{\\pi(\\theta_{n} \\mid y) \\ge c_{n}\\}$ 恒等于1。更新步骤变为 $c_{n+1} = c_{n} + \\gamma_{n}(1 - (1-\\alpha)) = c_{n} + \\gamma_{n}\\alpha$。由于 $\\gamma_n > 0$ 且 $\\alpha > 0$，$c_n$ 将单调增加并发散，而不是收敛到正确的阈值。该算法基于一个基本的逻辑错误。\n-   **结论**: **不正确**。\n\n**C. 对完整后验使用切片采样...**\n\n-   **算法**: 这提议对完整后验使用切片采样。切片采样通过在后验密度函数图下的区域 $\\{(\\theta, u) : 0 \\le u \\le \\pi(\\theta \\mid y)\\}$ 内均匀采样来工作。该方法提议将 $c$ 设置为辅助变量样本 $\\{u_i\\}$ 的经验 $(1-\\alpha)$-分位数。\n-   **缺陷**: 这种确定 $c$ 的方法是不正确的。目标是找到 $c$ 使得 $\\mathbb{P}_{\\pi(\\cdot \\mid y)}(\\pi(\\theta \\mid y) \\ge c) = 1-\\alpha$。该提议是找到 $c$ 使得 $\\mathbb{P}(u \\ge c) = 1-\\alpha$，其中 $u$ 是来自切片采样器的辅助变量。$u$ 的边际分布不是均匀的，并且其分布与 $\\pi(\\theta|y)$ 的分布之间没有所需的简单关系。概率 $\\mathbb{P}(u \\ge c)$ 由 $\\int \\mathbb{P}(u \\ge c \\mid \\theta) \\pi(\\theta \\mid y) d\\theta = \\int_{L_c} \\frac{\\pi(\\theta \\mid y) - c}{\\pi(\\theta \\mid y)} \\pi(\\theta \\mid y) d\\theta$ 给出。该积分不等于 $\\int_{L_c} \\pi(\\theta \\mid y) d\\theta$，后者才是 HPD 区域的实际质量。因此，寻找 $c$ 的方法是无效的。\n-   **结论**: **不正确**。\n\n**D. 在从 $\\pi_{c}$ 采样期间，使用 $c_{n+1} = \\mathrm{median}\\left(c_{n},\\,\\pi(\\theta_{n} \\mid y)\\right)$ 自适应地选择 $c \\ldots$**\n\n-   **算法**: 这提出了另一种自适应方案，其更新规则为 $c_{n+1} = \\mathrm{median}\\left(c_{n},\\,\\pi(\\theta_{n} \\mid y)\\right)$。\n-   **缺陷**: 这个更新规则是一个没有理论依据的特设启发式方法。它并非从旨在寻找特定分位数的有原则的框架（如随机近似）中导出。不清楚这个过程会收敛到什么（如果会收敛的话）。交替执行从完整后验 $\\pi(\\theta \\mid y)$ 中采样的步骤以改善混合是一个有效的想法（与并行退火有关），但“自动接受它们”的部分通常是错误的，并且会违反细致平衡，除非提议是以这里未描述的非常特定的方式构建的。选择 $c$ 的方法是不合理的。\n-   **结论**: **不正确**。\n\n**E. 首先通过调和平均估计量估计边际似然来估计 $c \\ldots$**\n\n-   **算法**: 此选项包含多个严重缺陷。\n    1.  **调和平均估计量**：它建议通过首先使用调和平均估计量估计边际似然（模型证据，$Z = \\int \\pi(y|\\theta)\\pi(\\theta) d\\theta$）来归一化后验密度值。调和平均估计量以其病态的差而闻名。它在许多情况下不一致，通常具有无穷方差，并且对先验的低概率区域中的样本高度敏感。依赖它来完成需要相当精度的任务是一个判断上的关键错误。\n    2.  **采样算法**：它提议一个简单的“限制在 $L_c$ 内的随机游走 Metropolis”。这意味着如果提议落在 $L_c$ 之外就会被拒绝。这种简单的机制没有为在 $L_c$ 的不连通分量之间跳转提供特殊规定。如果 HPD 区域是不连通的，这样的采样器不能保证是遍历的，并且几乎肯定会被困在单个分量中。这未能解决问题陈述中强调的一个关键挑战。\n    3.  **诊断方法**：它建议依赖“高接受率作为主要的混合诊断”。这是一个糟糕的建议。对于随机游走 Metropolis 采样器，高接受率（例如  50%）通常表明提议步长太小，导致状态空间探索非常缓慢（混合性差），而不是混合性好。\n-   **结论**: **不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}