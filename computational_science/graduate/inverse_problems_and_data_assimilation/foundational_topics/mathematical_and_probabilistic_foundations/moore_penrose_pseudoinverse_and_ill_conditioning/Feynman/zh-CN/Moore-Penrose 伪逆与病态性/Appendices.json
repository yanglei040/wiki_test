{
    "hands_on_practices": [
        {
            "introduction": "我们首先从第一性原理出发，构建在特定条件下的Moore-Penrose伪逆矩阵。这个练习将指导你为满秩矩阵（无论是行满秩还是列满秩）推导其伪逆的显式公式，从而巩固伪逆、最小二乘法和最小范数解之间的深刻联系。通过一个秩亏缺矩阵的反例，你将清楚地看到这些特定公式的局限性，并理解为何需要像奇异值分解（SVD）这样的通用方法。",
            "id": "3404346",
            "problem": "考虑一个源于数据同化的线性逆问题：从线性观测 $y \\in \\mathbb{R}^{m}$ 中恢复一个未知状态向量 $x \\in \\mathbb{R}^{n}$，它们之间的关系为 $y = A x + \\varepsilon$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 是一个已知的正演算子，$\\varepsilon$ 是建模为加性噪声的观测误差。我们寻求一个将 $y$ 映射到候选解 $x$ 的线性估计器，该估计器基于最小二乘和最小能量原理，且仅使用以下基础：欧几里得范数、最小二乘极小化子的正规方程表征，以及广义逆的四个 Moore-Penrose 定义条件。\n\n任务：\n1. 从正规方程和超定系统 $y = A x$（其中 $m \\geq n$ 且 $A$ 具有满列秩）的最小二乘解的定义出发，推导出从 $y$ 到最小二乘极小化子的唯一线性算子。然后，使用四个 Moore-Penrose 条件，证明该算子等于 $A$ 的 Moore-Penrose 伪逆。\n2. 对于欠定系统（其中 $m \\leq n$ 且 $A$ 具有满行秩），使用带有拉格朗日乘子的变分法推导出唯一的最小欧几里得范数解。然后，通过四个 Moore-Penrose 条件验证所得的线性算子等于 $A$ 的 Moore-Penrose 伪逆。\n3. 提供一个具体的反例，其中 $A$ 是秩亏的，并且上述推导失败，因为正规方程导致了一个奇异系统。具体来说，考虑矩阵\n$$\nA = \\begin{pmatrix}\n1  1 \\\\\n2  2 \\\\\n3  3\n\\end{pmatrix} \\in \\mathbb{R}^{3 \\times 2}.\n$$\n使用奇异值分解 (SVD) 计算此 $A$ 的 Moore-Penrose 伪逆 $A^{+}$，然后计算 $A^{+}$ 的弗罗贝尼乌斯范数。\n\n答案要求：\n- 只报告上述反例矩阵 $A$ 的 $A^{+}$ 的弗罗贝尼乌斯范数。\n- 以精确的解析表达式形式提供最终答案。无需四舍五入。",
            "solution": "所给问题是线性代数中一个适定的标准练习，具体涉及广义逆理论及其在线性最小二乘问题中的应用。该问题具有科学依据、客观且自洽，因此被认为是有效的。解题过程将按所给顺序处理这三个任务。\n\n矩阵 $A$ 的 Moore-Penrose 伪逆，记作 $A^{+}$，是满足以下四个 Moore-Penrose 条件的唯一矩阵：\n1. $AXA = A$\n2. $XAX = X$\n3. $(AX)^{T} = AX$ ($AX$ 是对称的)\n4. $(XA)^{T} = XA$ ($XA$ 是对称的)\n对于实矩阵，使用转置 $T$。对于复矩阵，则使用共轭转置。\n\n任务1：具有满列秩的超定系统。\n我们旨在找到一个线性算子，它将观测向量 $y \\in \\mathbb{R}^{m}$ 映射到系统 $y=Ax$ 的最小二乘解 $x_{LS}$。解 $x_{LS}$ 使残差的欧几里得范数的平方 $\\|y-Ax\\|_{2}^{2}$ 最小化。该问题是超定的，其中 $A \\in \\mathbb{R}^{m \\times n}$，$m \\geq n$，且 $A$ 具有满列秩，即 $\\mathrm{rank}(A) = n$。\n\n通过将 $\\|y-Ax\\|_{2}^{2} = (y-Ax)^{T}(y-Ax)$ 关于 $x$ 的梯度设为零，可以找到其极小化子。\n$$ \\nabla_{x} (y^{T}y - y^{T}Ax - x^{T}A^{T}y + x^{T}A^{T}Ax) = -2A^{T}y + 2A^{T}Ax = 0 $$\n这得到了正规方程：\n$$ A^{T}Ax = A^{T}y $$\n由于 $A$ 具有满列秩 $n$，因此 $n \\times n$ 矩阵 $A^{T}A$ 是可逆的。所以，存在唯一的最小二乘解，由下式给出：\n$$ x_{LS} = (A^{T}A)^{-1}A^{T}y $$\n将 $y$ 映射到 $x_{LS}$ 的线性算子是矩阵 $X = (A^{T}A)^{-1}A^{T}$。我们现在通过检验四个条件来验证该算子是 Moore-Penrose 伪逆 $A^{+}$。\n\n1.  $AXA = A((A^{T}A)^{-1}A^{T})A = A((A^{T}A)^{-1}(A^{T}A)) = A(I_{n}) = A$。此条件成立。\n2.  $XAX = ((A^{T}A)^{-1}A^{T})A((A^{T}A)^{-1}A^{T}) = ((A^{T}A)^{-1}(A^{T}A))((A^{T}A)^{-1}A^{T}) = I_{n}((A^{T}A)^{-1}A^{T}) = X$。此条件成立。\n3.  $AX = A(A^{T}A)^{-1}A^{T}$。我们检验其对称性： $(AX)^{T} = (A(A^{T}A)^{-1}A^{T})^{T} = (A^{T})^{T}((A^{T}A)^{-1})^{T}A^{T} = A((A^{T}A)^{T})^{-1}A^{T} = A(A^{T}(A^{T})^{T})^{-1}A^{T} = A(A^{T}A)^{-1}A^{T} = AX$。此条件成立。\n4.  $XA = (A^{T}A)^{-1}A^{T}A = I_{n}$。单位矩阵 $I_n$ 是对称的，所以 $(XA)^{T} = I_{n}^{T} = I_{n} = XA$。此条件成立。\n\n所有四个条件都得到满足，因此对于一个具有满列秩矩阵 $A$ 的超定系统，其伪逆确实是 $A^{+} = (A^{T}A)^{-1}A^{T}$。\n\n任务2：具有满行秩的欠定系统。\n我们寻求方程 $Ax=y$ 的具有最小欧几里得范数 $\\|x\\|_{2}$ 的唯一解。该系统是欠定的，其中 $A \\in \\mathbb{R}^{m \\times n}$，$m \\leq n$，且 $A$ 具有满行秩，即 $\\mathrm{rank}(A) = m$。\n这是一个约束优化问题：最小化 $\\frac{1}{2}\\|x\\|_{2}^{2}$，约束条件为 $Ax-y=0$。我们使用拉格朗日乘子法。拉格朗日函数是：\n$$ \\mathcal{L}(x, \\lambda) = \\frac{1}{2}x^{T}x + \\lambda^{T}(y - Ax) $$\n其中 $\\lambda \\in \\mathbb{R}^{m}$ 是拉格朗日乘子向量。将关于 $x$ 的梯度设为零，得到最优性条件：\n$$ \\nabla_{x}\\mathcal{L} = x - A^{T}\\lambda = 0 \\implies x = A^{T}\\lambda $$\n将此代入约束条件 $Ax=y$：\n$$ A(A^{T}\\lambda) = y \\implies (AA^{T})\\lambda = y $$\n由于 $A$ 具有满行秩 $m$，因此 $m \\times m$ 矩阵 $AA^{T}$ 是可逆的。我们可以解出 $\\lambda$：\n$$ \\lambda = (AA^{T})^{-1}y $$\n将此代回 $x$ 的表达式，我们得到最小范数解：\n$$ x_{MN} = A^{T}(AA^{T})^{-1}y $$\n线性算子是 $X = A^{T}(AA^{T})^{-1}$。我们通过检验四个条件来验证这就是 $A^{+}$。\n\n1.  $AXA = A(A^{T}(AA^{T})^{-1})A = (AA^{T})(AA^{T})^{-1}A = I_{m}A = A$。此条件成立。\n2.  $XAX = (A^{T}(AA^{T})^{-1})A(A^{T}(AA^{T})^{-1}) = A^{T}(AA^{T})^{-1}(AA^{T})(AA^{T})^{-1} = A^{T}I_{m}(AA^{T})^{-1} = A^{T}(AA^{T})^{-1} = X$。此条件成立。\n3.  $AX = A(A^{T}(AA^{T})^{-1}) = (AA^{T})(AA^{T})^{-1} = I_{m}$。单位矩阵 $I_m$ 是对称的，所以 $(AX)^{T} = I_{m}^{T} = I_{m} = AX$。此条件成立。\n4.  $XA = A^{T}(AA^{T})^{-1}A$。我们检验其对称性： $(XA)^{T} = (A^{T}(AA^{T})^{-1}A)^{T} = A^{T}((AA^{T})^{-1})^{T}(A^{T})^{T} = A^{T}((AA^{T})^{T})^{-1}A = A^{T}((A^{T})^{T}A^{T})^{-1}A = A^{T}(AA^{T})^{-1}A = XA$。此条件成立。\n\n所有四个条件都得到满足，因此对于一个具有满行秩矩阵 $A$ 的欠定系统，其伪逆确实是 $A^{+} = A^{T}(AA^{T})^{-1}$。\n\n任务3：秩亏反例。\n给定矩阵 $A = \\begin{pmatrix} 1  1 \\\\ 2  2 \\\\ 3  3 \\end{pmatrix}$。这是一个 $3 \\times 2$ 矩阵。它的列是线性相关的，所以其秩为 $1$，小于列数 ($n=2$)。因此，$A$ 是秩亏的，不具有满列秩。\n\n我们尝试使用任务1中的正规方程公式。我们计算 $A^{T}A$：\n$$ A^{T}A = \\begin{pmatrix} 1  2  3 \\\\ 1  2  3 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 2  2 \\\\ 3  3 \\end{pmatrix} = \\begin{pmatrix} 1+4+9  1+4+9 \\\\ 1+4+9  1+4+9 \\end{pmatrix} = \\begin{pmatrix} 14  14 \\\\ 14  14 \\end{pmatrix} $$\n该矩阵的行列式为 $\\det(A^{T}A) = 14 \\times 14 - 14 \\times 14 = 0$。由于行列式为零，$A^{T}A$ 是奇异的，其逆 $(A^{T}A)^{-1}$ 不存在。这表明任务1的推导对秩亏矩阵是失败的。\n\n为了计算这个秩亏矩阵的 Moore-Penrose 伪逆 $A^{+}$，我们使用奇异值分解 (SVD)。对于任何矩阵 $A = U\\Sigma V^{T}$，其伪逆为 $A^{+} = V\\Sigma^{+}U^{T}$，其中 $\\Sigma^{+}$ 是通过对 $\\Sigma$ 进行转置，然后取其非零元素的倒数得到的。\n\n$A^{+}$ 的弗罗贝尼乌斯范数可以直接从 $A$ 的奇异值计算。弗罗贝尼乌斯范数定义为 $\\|X\\|_{F} = \\sqrt{\\sum_{i,j} |x_{ij}|^2}$。它也可以表示为 $\\|X\\|_{F} = \\sqrt{\\mathrm{Tr}(X^{T}X)} = \\sqrt{\\sum_{k} \\sigma_{k}(X)^2}$，其中 $\\sigma_{k}(X)$ 是 $X$ 的奇异值。\n$A^{+}$ 的奇异值是 $A$ 的非零奇异值的倒数。设 $A$ 的奇异值为 $\\sigma_1, \\sigma_2, \\dots$。对于非零的 $\\sigma_i$，$A^{+}$ 的奇异值将是 $1/\\sigma_1, 1/\\sigma_2, \\dots$。\n\n$A$ 的奇异值是 $A^{T}A$ 的非零特征值的平方根。我们已经计算出 $A^{T}A = \\begin{pmatrix} 14  14 \\\\ 14  14 \\end{pmatrix}$。特征方程为 $\\det(A^{T}A - \\lambda I) = 0$：\n$$ (14-\\lambda)^{2} - 14^{2} = 0 \\implies (14-\\lambda-14)(14-\\lambda+14) = 0 \\implies (-\\lambda)(28-\\lambda) = 0 $$\n$A^T A$ 的特征值是 $\\lambda_1 = 28$ 和 $\\lambda_2 = 0$。\n$A$ 的非零奇异值是 $\\sigma_1 = \\sqrt{\\lambda_1} = \\sqrt{28} = 2\\sqrt{7}$。另一个奇异值是 $\\sigma_2 = \\sqrt{0} = 0$。\n$A$ 的秩是非零奇异值的数量，即 $1$。\n\n$A^{+}$ 的非零奇异值集合由 $A$ 的非零奇异值的倒数组成。在这种情况下，$A^{+}$ 只有一个非零奇异值 $\\sigma_1^{+}$：\n$$ \\sigma_1^{+} = \\frac{1}{\\sigma_1} = \\frac{1}{2\\sqrt{7}} $$\n$A^{+}$ 的弗罗贝尼乌斯范数是其奇异值平方和的平方根：\n$$ \\|A^{+}\\|_{F} = \\sqrt{(\\sigma_1^{+})^2 + (\\sigma_2^{+})^2 + \\dots} = \\sqrt{\\left(\\frac{1}{2\\sqrt{7}}\\right)^2} = \\frac{1}{2\\sqrt{7}} $$\n为了以有理化形式提供答案，我们将分子和分母同乘以 $\\sqrt{7}$：\n$$ \\|A^{+}\\|_{F} = \\frac{1}{2\\sqrt{7}} \\cdot \\frac{\\sqrt{7}}{\\sqrt{7}} = \\frac{\\sqrt{7}}{14} $$\n这就是所求的值。",
            "answer": "$$\\boxed{\\frac{\\sqrt{7}}{14}}$$"
        },
        {
            "introduction": "理解了如何计算伪逆解之后，我们来探讨为何病态性是一个关键问题。这个练习将引导你发现噪声放大的最坏情况，并将其直接与前向算子的奇异值谱联系起来。通过这个过程，你将揭示微小的观测误差如何通过与系统中最不可观测的状态分量（对应于最小的非零奇异值）耦合，从而导致解出现巨大误差的内在机制。",
            "id": "3404452",
            "problem": "考虑在变分数据同化（DA）背景下的一个线性化观测算子，由一个实矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 表示，其奇异值分解（SVD）为 $A = U \\Sigma V^{\\mathsf{T}}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是对角矩阵，其非负对角线元素为 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\cdots \\geq \\sigma_{r} > 0$ 且对于 $i > r$ 有 $\\sigma_{i} = 0$，其中 $r = \\operatorname{rank}(A) \\geq 1$。Moore–Penrose 伪逆为 $A^{\\dagger} = V \\Sigma^{\\dagger} U^{\\mathsf{T}}$，其中 $\\Sigma^{\\dagger}$ 是通过将非零奇异值取倒数并保持零值不变得到的。\n\n假设真实状态 $x_{\\star} \\in \\mathbb{R}^{n}$ 产生含噪声的观测值 $y = A x_{\\star} + \\eta$，其中观测误差 $\\eta \\in \\mathbb{R}^{m}$ 是确定性但未知的，并满足噪声预算 $\\|\\eta\\|_{2} = \\delta$，其中 $\\delta > 0$ 是已知的。数据同化重构器计算 $\\hat{x} = A^{\\dagger} y$。由观测误差引起的重构误差为 $e = \\hat{x} - A^{\\dagger} A x_{\\star} = A^{\\dagger} \\eta$。\n\n仅使用上述定义以及正交变换和欧几里得范数的基本性质，确定在所有满足 $\\|\\eta\\|_{2} = \\delta$ 的 $\\eta$ 中，$\\|e\\|_{2}$ 的确切最大可能值，并用 $\\delta$ 和 $A$ 的奇异值以闭式形式表示。除了给定的定义以及正交矩阵和欧几里得范数的标准性质外，您不应假设任何其他结果。在您的推理中，指出数据空间中的哪个方向和状态空间中的哪个方向实现了这个最大值，并解释其与最小正奇异值相关联的右奇异向量的关系。在数据同化的背景下，将最大化配置解释为最坏情况下的噪声诱导分析误差机制。\n\n您的最终答案必须是单一的闭式解析表达式。最终答案中不要包含任何单位。最终答案中不要提供最大化方向或任何解释性文本。",
            "solution": "该问题陈述已经过验证，被认为是有效的。这是一个在反问题和数据同化领域中适定的、有科学依据的问题。\n\n我们的目标是找到重构误差欧几里得范数 $\\|e\\|_{2}$ 的最大可能值，已知 $e = A^{\\dagger} \\eta$ 且观测误差 $\\eta$ 满足 $\\|\\eta\\|_{2} = \\delta$。矩阵 $A$ 的奇异值分解（SVD）为 $A = U \\Sigma V^{\\mathsf{T}}$，其 Moore-Penrose 伪逆为 $A^{\\dagger} = V \\Sigma^{\\dagger} U^{\\mathsf{T}}$。\n\n误差向量 $e$ 的范数由下式给出：\n$$\n\\|e\\|_{2} = \\|A^{\\dagger} \\eta\\|_{2}\n$$\n代入 $A^{\\dagger}$ 的 SVD 表达式，我们得到：\n$$\n\\|e\\|_{2} = \\|V \\Sigma^{\\dagger} U^{\\mathsf{T}} \\eta\\|_{2}\n$$\n问题陈述中指出 $V \\in \\mathbb{R}^{n \\times n}$ 是一个正交矩阵。正交变换的一个基本性质是它们保持欧几里得范数不变。也就是说，对于任何向量 $z \\in \\mathbb{R}^{n}$，$\\|Vz\\|_{2} = \\|z\\|_{2}$。应用这个性质，我们可以从范数计算中移除正交矩阵 $V$：\n$$\n\\|e\\|_{2} = \\|\\Sigma^{\\dagger} U^{\\mathsf{T}} \\eta\\|_{2}\n$$\n现在，我们定义一个新向量 $\\tilde{\\eta} \\in \\mathbb{R}^{m}$，作为噪声向量 $\\eta$ 在左奇异向量基（即 $U$ 的列）上的投影：\n$$\n\\tilde{\\eta} = U^{\\mathsf{T}} \\eta\n$$\n由于 $U \\in \\mathbb{R}^{m \\times m}$ 也是一个正交矩阵，其转置 $U^{\\mathsf{T}}$ 同样是正交的。因此，这个变换也保持欧几里得范数不变：\n$$\n\\|\\tilde{\\eta}\\|_{2} = \\|U^{\\mathsf{T}} \\eta\\|_{2} = \\|\\eta\\|_{2} = \\delta\n$$\n问题现在转化为在约束 $\\|\\tilde{\\eta}\\|_{2} = \\delta$ 下，求 $\\|\\Sigma^{\\dagger} \\tilde{\\eta}\\|_{2}$ 的最大值。\n\n我们来分析 $\\|\\Sigma^{\\dagger} \\tilde{\\eta}\\|_{2}$ 这一项。矩阵 $\\Sigma^{\\dagger}$ 是一个大小为 $n \\times m$ 的对角矩阵。它的前 $r$ 个对角线元素是 $A$ 的正奇异值的倒数，即 $1/\\sigma_1, 1/\\sigma_2, \\dots, 1/\\sigma_r$。所有其他元素都为零。设 $\\tilde{\\eta} = (\\tilde{\\eta}_1, \\tilde{\\eta}_2, \\dots, \\tilde{\\eta}_m)^{\\mathsf{T}}$。乘积 $\\Sigma^{\\dagger} \\tilde{\\eta}$ 是一个 $n$ 维向量：\n$$\n\\Sigma^{\\dagger} \\tilde{\\eta} = \\begin{pmatrix}\n1/\\sigma_1  0  \\dots  0  \\dots  0 \\\\\n0  1/\\sigma_2  \\dots  0  \\dots  0 \\\\\n\\vdots  \\vdots  \\ddots  \\vdots   \\vdots \\\\\n0  0  \\dots  1/\\sigma_r  \\dots  0 \\\\\n\\vdots  \\vdots   \\vdots  \\ddots  \\vdots \\\\\n0  0  \\dots  0  \\dots  0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\tilde{\\eta}_1 \\\\ \\tilde{\\eta}_2 \\\\ \\vdots \\\\ \\tilde{\\eta}_r \\\\ \\vdots \\\\ \\tilde{\\eta}_m\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\tilde{\\eta}_1 / \\sigma_1 \\\\\n\\tilde{\\eta}_2 / \\sigma_2 \\\\\n\\vdots \\\\\n\\tilde{\\eta}_r / \\sigma_r \\\\\n0 \\\\\n\\vdots \\\\\n0\n\\end{pmatrix}\n$$\n该向量的范数平方为：\n$$\n\\|e\\|_{2}^{2} = \\|\\Sigma^{\\dagger} \\tilde{\\eta}\\|_{2}^{2} = \\sum_{i=1}^{r} \\left(\\frac{\\tilde{\\eta}_i}{\\sigma_i}\\right)^2 = \\sum_{i=1}^{r} \\frac{1}{\\sigma_i^2} \\tilde{\\eta}_i^2\n$$\n我们的目标是在约束 $\\|\\tilde{\\eta}\\|_{2}^2 = \\sum_{i=1}^{m} \\tilde{\\eta}_i^2 = \\delta^2$ 下最大化这个量。由于 $\\|e\\|_2^2$ 的求和只涉及 $i=r$ 以前的分量，任何对于 $i > r$ 的分量 $\\tilde{\\eta}_i$ 对误差范数没有贡献。为了最大化该和，我们应设 $\\tilde{\\eta}_i = 0$ (对于 $i>r$)。约束变为 $\\sum_{i=1}^{r} \\tilde{\\eta}_i^2 = \\delta^2$。\n\n我们已知奇异值按 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\cdots \\geq \\sigma_{r} > 0$ 排序。因此，它们的平方倒数按以下顺序排序：\n$$\n0 < \\frac{1}{\\sigma_1^2} \\leq \\frac{1}{\\sigma_2^2} \\leq \\cdots \\leq \\frac{1}{\\sigma_r^2}\n$$\n为了在约束 $\\sum_{i=1}^{r} \\tilde{\\eta}_i^2 = \\delta^2$ 下最大化加权和 $\\sum_{i=1}^{r} (1/\\sigma_i^2) \\tilde{\\eta}_i^2$，我们必须将 $\\tilde{\\eta}$ 的全部“能量”$\\delta^2$ 分配给乘以最大系数的那个分量 $\\tilde{\\eta}_i$。最大的系数是 $1/\\sigma_r^2$。\n\n因此，通过选择 $\\tilde{\\eta}_r^2 = \\delta^2$ 且对所有 $i \\neq r$ 选择 $\\tilde{\\eta}_i^2 = 0$ 来达到最大值。这个配置满足约束条件。对于此选择，误差范数的平方为：\n$$\n\\|e\\|_{2, \\text{max}}^{2} = \\frac{1}{\\sigma_r^2} \\tilde{\\eta}_r^2 = \\frac{\\delta^2}{\\sigma_r^2}\n$$\n取平方根，我们得到误差范数的最大可能值：\n$$\n\\|e\\|_{2, \\text{max}} = \\frac{\\delta}{\\sigma_r}\n$$\n\n为了实现这个最大值，我们选择 $\\tilde{\\eta}$ 使得 $\\tilde{\\eta}_r = \\pm\\delta$ 且所有其他分量为零。让我们将在第 $i$ 个位置为 1 的 $\\mathbb{R}^m$ 中的标准基向量表示为 $e'_i$。那么，最大化的变换噪声向量是 $\\tilde{\\eta}_{\\text{max}} = \\delta e'_r$。\n原始数据空间中的噪声 $\\eta \\in \\mathbb{R}^m$ 通过逆变换求得：\n$$\n\\eta_{\\text{max}} = U \\tilde{\\eta}_{\\text{max}} = U (\\delta e'_r) = \\delta (U e'_r) = \\delta u_r\n$$\n其中 $u_r$ 是 $U$ 的第 $r$ 列，也就是对应于奇异值 $\\sigma_r$ 的 $A$ 的左奇异向量。因此，最坏情况下的噪声与对应于最小正奇异值 $\\sigma_r$ 的左奇异向量对齐。\n\n产生的重构误差向量 $e \\in \\mathbb{R}^n$ 是：\n$$\ne_{\\text{max}} = A^{\\dagger} \\eta_{\\text{max}} = V \\Sigma^{\\dagger} U^{\\mathsf{T}} (\\delta u_r)\n$$\n由于 $U$ 的列是标准正交的，所以 $U^{\\mathsf{T}} u_r = e'_r$。表达式变为：\n$$\ne_{\\text{max}} = V \\Sigma^{\\dagger} (\\delta e'_r) = \\delta (V (\\Sigma^{\\dagger} e'_r))\n$$\n向量 $\\Sigma^{\\dagger} e'_r$ 是 $\\mathbb{R}^n$ 中的一个向量，其第 $r$ 个分量等于 $1/\\sigma_r$，所有其他分量为零。我们称此向量为 $(1/\\sigma_r) e''_r$，其中 $e''_r$ 是 $\\mathbb{R}^n$ 中的第 $r$ 个标准基向量。\n$$\ne_{\\text{max}} = \\delta V \\left(\\frac{1}{\\sigma_r} e''_r\\right) = \\frac{\\delta}{\\sigma_r} (V e''_r) = \\frac{\\delta}{\\sigma_r} v_r\n$$\n其中 $v_r$ 是 $V$ 的第 $r$ 列，即对应于 $\\sigma_r$ 的 $A$ 的右奇异向量。\n这表明，最坏情况下的重构误差 $e_{\\text{max}}$ 与关联最小正奇异值 $\\sigma_r$ 的右奇异向量对齐。\n\n在数据同化的背景下，这个结果阐释了病态反问题中误差放大的机制。右奇异向量 $v_r$ 代表了状态空间中一个“最不可观测”的方向，因为其到观测空间的映射 $A v_r = \\sigma_r u_r$ 被小奇异值 $\\sigma_r$ 所缩放。最坏情况下的观测误差 $\\eta_{\\text{max}} = \\delta u_r$ 具有一种空间结构，它完美地模仿了这个观测不良的状态分量的微弱观测特征。涉及逆算子 $A^{\\dagger}$ 的重构过程将此噪声误解为 $v_r$ 方向上一个非常大的信号分量。幅度为 $\\delta$ 的噪声被因子 $1/\\sigma_r$ 放大，导致一个与状态空间方向 $v_r$ 对齐的、幅度为 $(\\delta/\\sigma_r)$ 的巨大重构误差。这个放大因子 $1/\\sigma_r$ 正是算子范数 $\\|A^{\\dagger}\\|_2$，它量化了解对数据扰动的敏感性。",
            "answer": "$$\n\\boxed{\\frac{\\delta}{\\sigma_{r}}}\n$$"
        },
        {
            "introduction": "Moore-Penrose伪逆在纯数学意义上提供了最优解（最小范数最小二乘解），但在许多科学应用中，解还必须满足物理定律，如非负性或守恒性。这个问题提供了一个真实情景：原始的伪逆解是非物理的。它将挑战你通过投影的方法来强制施加这些物理约束，从而得到一个在数学上近似且在物理上合理的解。",
            "id": "3404374",
            "problem": "考虑一个线性数据同化模型，其状态向量 $x \\in \\mathbb{R}^{3}$ 代表三种化学物质的混合分数。物理可行性要求对所有 $i$ 都有边界条件 $x_{i} \\ge 0$ 且满足守恒定律 $\\sum_{i=1}^{3} x_{i} = 1$。设前向算子为矩阵\n$A(\\varepsilon) \\;=\\; \\begin{pmatrix}\n1  1  1 \\\\\n0  \\varepsilon  2\\varepsilon\n\\end{pmatrix},$\n其中 $\\varepsilon > 0$ 是一个小参数（因此第二行比第一行弱得多），并假设我们同化观测向量\n$y \\;=\\; \\begin{pmatrix} a \\\\ b \\end{pmatrix},$\n其中 $a = \\frac{102}{100}$，$b = \\frac{1}{4000}$，且 $\\varepsilon = \\frac{1}{1000}$。从 Moore–Penrose 伪逆的定义性特征——唯一的最小欧几里得范数解出发，\n$$\nx^{\\dagger} \\;=\\; \\underset{x \\in \\mathbb{R}^{3}}{\\arg\\min}\\;\\|x\\|_{2} \\quad \\text{subject to} \\quad A(\\varepsilon)\\,x = y.\n$$\n仅使用此定义和第一性原理，精确推导出 $x^{\\dagger}$，并指出它违反了哪些物理约束（若有）。作为一种补救措施，通过欧几里得投影将 $x^{\\dagger}$ 投影到概率单纯形 $\\mathcal{S} = \\{x \\in \\mathbb{R}^{3} : x_{i} \\ge 0,\\; \\sum_{i=1}^{3} x_{i} = 1\\}$ 上来强制满足可行性，\n$$\nx^{\\mathrm{proj}} \\;=\\; \\underset{x \\in \\mathcal{S}}{\\arg\\min}\\;\\|x - x^{\\dagger}\\|_{2}.\n$$\n用精确算术计算平方欧几里得修正量的大小\n$$\n\\Delta^{2} \\;=\\; \\bigl\\|x^{\\dagger} - x^{\\mathrm{proj}}\\bigr\\|_{2}^{2}.\n$$\n请以单个精确数值的形式给出最终答案。不需要单位。如果选择近似计算，请将答案四舍五入到四位有效数字。",
            "solution": "在尝试求解之前，将根据指定标准对问题进行验证。\n\n### 问题验证\n\n**第一步：提取已知条件**\n- 状态向量：$x \\in \\mathbb{R}^{3}$。\n- 状态向量的物理约束：对于所有 $i \\in \\{1, 2, 3\\}$，$x_{i} \\ge 0$，且 $\\sum_{i=1}^{3} x_{i} = 1$。\n- 前向算子：$A(\\varepsilon) = \\begin{pmatrix} 1  1  1 \\\\ 0  \\varepsilon  2\\varepsilon \\end{pmatrix}$。\n- 小参数：$\\varepsilon > 0$，具体值为 $\\varepsilon = \\frac{1}{1000}$。\n- 观测向量：$y = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$，具体值为 $a = \\frac{102}{100}$ 和 $b = \\frac{1}{4000}$。\n- 最小范数解的定义：$x^{\\dagger} = \\underset{x \\in \\mathbb{R}^{3}}{\\arg\\min}\\;\\|x\\|_{2} \\quad \\text{subject to} \\quad A(\\varepsilon)\\,x = y$。\n- 投影可行解的定义：$x^{\\mathrm{proj}} = \\underset{x \\in \\mathcal{S}}{\\arg\\min}\\;\\|x - x^{\\dagger}\\|_{2}$，其中可行集是概率单纯形 $\\mathcal{S} = \\{x \\in \\mathbb{R}^{3} : x_{i} \\ge 0,\\; \\sum_{i=1}^{3} x_{i} = 1\\}$。\n- 待计算量：平方欧几里得修正量的大小，$\\Delta^{2} = \\bigl\\|x^{\\dagger} - x^{\\mathrm{proj}}\\bigr\\|_{2}^{2}$。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是线性反演理论和数据同化中的一个标准练习。它涉及使用线性前向模型从观测中寻找状态向量，识别无约束解的非物理性质，并将其投影到一个有物理意义的集合上。这些都是该领域的核心概念。\n- **适定性**：该问题在数学上是适定的。对于 $\\varepsilon > 0$，前向算子 $A(\\varepsilon)$ 是一个秩为 2（满行秩）的 $2 \\times 3$ 矩阵，这保证了最小欧几里得范数解 $x^{\\dagger}$ 的存在性和唯一性。概率单纯形 $\\mathcal{S}$ 是一个闭合的凸集，这保证了欧几里得投影 $x^{\\mathrm{proj}}$ 的存在性和唯一性。所有必要的参数都已指定。\n- **客观性**：问题使用精确的数学语言陈述，没有任何歧义或主观论断。\n\n**第三步：结论与行动**\n该问题是有效的。它具有科学性、适定性、客观性和完整性。将推导解答。\n\n### 解答推导\n\n第一步是计算满足线性系统 $A(\\varepsilon)x = y$ 的最小欧几里得范数解 $x^{\\dagger}$。这是一个约束优化问题：最小化 $f(x) = \\|x\\|_{2}^{2} = x^{T}x$，约束条件为 $A(\\varepsilon)x - y = 0$。我们使用拉格朗日乘数法。拉格朗日函数为：\n$$\n\\mathcal{L}(x, \\lambda) = x^{T}x + \\lambda^{T}(A(\\varepsilon)x - y)\n$$\n其中 $\\lambda \\in \\mathbb{R}^{2}$ 是拉格朗日乘数向量。为了找到最小值，我们将关于 $x$ 的梯度设为零：\n$$\n\\nabla_{x} \\mathcal{L} = 2x + A(\\varepsilon)^{T}\\lambda = 0 \\quad \\implies \\quad x = -\\frac{1}{2}A(\\varepsilon)^{T}\\lambda\n$$\n将此代入约束方程 $A(\\varepsilon)x = y$：\n$$\nA(\\varepsilon) \\left(-\\frac{1}{2}A(\\varepsilon)^{T}\\lambda\\right) = y \\quad \\implies \\quad -\\frac{1}{2}A(\\varepsilon)A(\\varepsilon)^{T}\\lambda = y\n$$\n由于当 $\\varepsilon > 0$ 时 $A(\\varepsilon)$ 具有满行秩，矩阵 $A(\\varepsilon)A(\\varepsilon)^{T}$ 是可逆的。我们可以解出 $\\lambda$：\n$$\n\\lambda = -2 \\left(A(\\varepsilon)A(\\varepsilon)^{T}\\right)^{-1}y\n$$\n将 $\\lambda$ 代回 $x$ 的表达式，得到解 $x^{\\dagger}$：\n$$\nx^{\\dagger} = -\\frac{1}{2}A(\\varepsilon)^{T} \\left(-2 \\left(A(\\varepsilon)A(\\varepsilon)^{T}\\right)^{-1}y\\right) = A(\\varepsilon)^{T}\\left(A(\\varepsilon)A(\\varepsilon)^{T}\\right)^{-1}y\n$$\n这是应用于 $y$ 的 Moore-Penrose 伪逆 $A(\\varepsilon)^{+}$ 的标准公式。我们来计算这些矩阵：\n$$\nA(\\varepsilon)A(\\varepsilon)^{T} = \\begin{pmatrix} 1  1  1 \\\\ 0  \\varepsilon  2\\varepsilon \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  \\varepsilon \\\\ 1  2\\varepsilon \\end{pmatrix} = \\begin{pmatrix} 3  3\\varepsilon \\\\ 3\\varepsilon  5\\varepsilon^{2} \\end{pmatrix}\n$$\n行列式为 $\\det(A(\\varepsilon)A(\\varepsilon)^{T}) = (3)(5\\varepsilon^{2}) - (3\\varepsilon)(3\\varepsilon) = 15\\varepsilon^{2} - 9\\varepsilon^{2} = 6\\varepsilon^{2}$。逆矩阵为：\n$$\n\\left(A(\\varepsilon)A(\\varepsilon)^{T}\\right)^{-1} = \\frac{1}{6\\varepsilon^{2}} \\begin{pmatrix} 5\\varepsilon^{2}  -3\\varepsilon \\\\ -3\\varepsilon  3 \\end{pmatrix}\n$$\n现在我们计算 $x^{\\dagger}$：\n$$\nx^{\\dagger} = \\begin{pmatrix} 1  0 \\\\ 1  \\varepsilon \\\\ 1  2\\varepsilon \\end{pmatrix} \\frac{1}{6\\varepsilon^{2}} \\begin{pmatrix} 5\\varepsilon^{2}  -3\\varepsilon \\\\ -3\\varepsilon  3 \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix}\n$$\n$$\nx^{\\dagger} = \\frac{1}{6\\varepsilon^{2}} \\begin{pmatrix} 1  0 \\\\ 1  \\varepsilon \\\\ 1  2\\varepsilon \\end{pmatrix} \\begin{pmatrix} 5\\varepsilon^{2}a - 3\\varepsilon b \\\\ -3\\varepsilon a + 3b \\end{pmatrix}\n$$\n$$\nx^{\\dagger} = \\frac{1}{6\\varepsilon^{2}} \\begin{pmatrix} 5\\varepsilon^{2}a - 3\\varepsilon b \\\\ (5\\varepsilon^{2}a - 3\\varepsilon b) + \\varepsilon(-3\\varepsilon a + 3b) \\\\ (5\\varepsilon^{2}a - 3\\varepsilon b) + 2\\varepsilon(-3\\varepsilon a + 3b) \\end{pmatrix} = \\frac{1}{6\\varepsilon^{2}} \\begin{pmatrix} 5\\varepsilon^{2}a - 3\\varepsilon b \\\\ 2\\varepsilon^{2}a \\\\ -\\varepsilon^{2}a + 3\\varepsilon b \\end{pmatrix}\n$$\n简化 $x^{\\dagger} = (x_{1}^{\\dagger}, x_{2}^{\\dagger}, x_{3}^{\\dagger})^{T}$ 的分量：\n$$\nx_{1}^{\\dagger} = \\frac{5}{6}a - \\frac{1}{2\\varepsilon}b, \\quad x_{2}^{\\dagger} = \\frac{1}{3}a, \\quad x_{3}^{\\dagger} = -\\frac{1}{6}a + \\frac{1}{2\\varepsilon}b\n$$\n我们代入给定值 $a = \\frac{102}{100}$，$b = \\frac{1}{4000}$，以及 $\\varepsilon = \\frac{1}{1000}$。\n注意 $\\frac{1}{2\\varepsilon} = \\frac{1}{2(1/1000)} = 500$。\n$$\nx_{1}^{\\dagger} = \\frac{5}{6}\\left(\\frac{102}{100}\\right) - 500\\left(\\frac{1}{4000}\\right) = \\frac{17}{20} - \\frac{1}{8} = \\frac{34}{40} - \\frac{5}{40} = \\frac{29}{40}\n$$\n$$\nx_{2}^{\\dagger} = \\frac{1}{3}\\left(\\frac{102}{100}\\right) = \\frac{34}{100} = \\frac{17}{50}\n$$\n$$\nx_{3}^{\\dagger} = -\\frac{1}{6}\\left(\\frac{102}{100}\\right) + 500\\left(\\frac{1}{4000}\\right) = -\\frac{17}{100} + \\frac{1}{8} = -\\frac{34}{200} + \\frac{25}{200} = -\\frac{9}{200}\n$$\n因此，无约束解为 $x^{\\dagger} = \\left(\\frac{29}{40}, \\frac{17}{50}, -\\frac{9}{200}\\right)^{T}$。\n\n接下来，我们根据物理约束检查该解。\n1. 非负性 ($x_{i} \\ge 0$)：$x_{1}^{\\dagger} = \\frac{29}{40} > 0$，$x_{2}^{\\dagger} = \\frac{17}{50} > 0$，但 $x_{3}^{\\dagger} = -\\frac{9}{200}  0$。第三个分量违反了非负性约束。\n2. 守恒性 ($\\sum x_i = 1$)：约束 $A(\\varepsilon)x=y$ 的第一行是 $\\sum x_{i} = a$。当 $a = \\frac{102}{100} = 1.02$ 时，我们有 $\\sum x_i^{\\dagger} = 1.02 \\neq 1$。守恒约束被违反。\n\n为了强制满足可行性，我们将 $x^{\\dagger}$ 投影到概率单纯形 $\\mathcal{S}$ 上。我们需要计算 $x^{\\mathrm{proj}} = \\underset{x \\in \\mathcal{S}}{\\arg\\min}\\;\\|x - x^{\\dagger}\\|_{2}$。此投影的标准算法包括对 $x^{\\dagger}$ 的分量进行排序并找到一个阈值 $\\tau$。\n$x^{\\dagger}$ 的分量为 $\\frac{29}{40} = 0.725$，$\\frac{17}{50} = 0.34$，以及 $-\\frac{9}{200} = -0.045$。\n令 $z = x^{\\dagger}$。按降序排列的分量为 $z_{(1)} = \\frac{29}{40}$，$z_{(2)} = \\frac{17}{50}$，$z_{(3)} = -\\frac{9}{200}$。\n我们寻找 $\\rho = \\max\\left\\{ j \\in \\{1, 2, 3\\} \\, \\Big| \\, z_{(j)} - \\frac{1}{j}\\left(\\sum_{k=1}^{j} z_{(k)} - 1\\right)  0 \\right\\}$。\n对于 $j=1$：$z_{(1)} - (z_{(1)} - 1) = 1  0$。\n对于 $j=2$：我们来计算这一项。\n$\\sum_{k=1}^{2} z_{(k)} = \\frac{29}{40} + \\frac{17}{50} = \\frac{145}{200} + \\frac{68}{200} = \\frac{213}{200}$。\n$z_{(2)} - \\frac{1}{2}\\left(\\frac{213}{200} - 1\\right) = \\frac{17}{50} - \\frac{1}{2}\\left(\\frac{13}{200}\\right) = \\frac{136}{400} - \\frac{13}{400} = \\frac{123}{400}  0$。\n对于 $j=3$：\n$\\sum_{k=1}^{3} z_{(k)} = \\sum_{i=1}^{3} x_{i}^{\\dagger} = a = \\frac{102}{100} = \\frac{204}{200}$。\n$z_{(3)} - \\frac{1}{3}\\left(\\frac{204}{200} - 1\\right) = -\\frac{9}{200} - \\frac{1}{3}\\left(\\frac{4}{200}\\right) = -\\frac{27}{600} - \\frac{4}{600} = -\\frac{31}{600}  0$。\n满足条件的最大 $j$ 是 $\\rho = 2$。\n阈值 $\\tau$ 由 $\\tau = \\frac{1}{\\rho}\\left(\\sum_{k=1}^{\\rho} z_{(k)} - 1\\right)$ 给出。\n$\\tau = \\frac{1}{2}\\left(\\frac{213}{200} - 1\\right) = \\frac{13}{400}$。\n投影解 $x^{\\mathrm{proj}}$ 的分量为 $x_{i}^{\\mathrm{proj}} = \\max(x_{i}^{\\dagger} - \\tau, 0)$。\n$x_{1}^{\\mathrm{proj}} = \\max\\left(\\frac{29}{40} - \\frac{13}{400}, 0\\right) = \\max\\left(\\frac{290-13}{400}, 0\\right) = \\frac{277}{400}$。\n$x_{2}^{\\mathrm{proj}} = \\max\\left(\\frac{17}{50} - \\frac{13}{400}, 0\\right) = \\max\\left(\\frac{136-13}{400}, 0\\right) = \\frac{123}{400}$。\n$x_{3}^{\\mathrm{proj}} = \\max\\left(-\\frac{9}{200} - \\frac{13}{400}, 0\\right) = \\max\\left(\\frac{-18-13}{400}, 0\\right) = \\max\\left(-\\frac{31}{400}, 0\\right) = 0$。\n投影解为 $x^{\\mathrm{proj}} = \\left(\\frac{277}{400}, \\frac{123}{400}, 0\\right)^{T}$。\n\n最后，我们计算平方欧几里得修正量的大小 $\\Delta^{2} = \\|x^{\\dagger} - x^{\\mathrm{proj}}\\|_{2}^{2}$。\n差向量为 $x^{\\dagger} - x^{\\mathrm{proj}}$：\n$$\nx^{\\dagger} - x^{\\mathrm{proj}} = \\begin{pmatrix} 29/40 \\\\ 17/50 \\\\ -9/200 \\end{pmatrix} - \\begin{pmatrix} 277/400 \\\\ 123/400 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 290/400 - 277/400 \\\\ 136/400 - 123/400 \\\\ -18/400 - 0 \\end{pmatrix} = \\begin{pmatrix} 13/400 \\\\ 13/400 \\\\ -18/400 \\end{pmatrix}\n$$\n该向量的平方范数为：\n$$\n\\Delta^{2} = \\left(\\frac{13}{400}\\right)^{2} + \\left(\\frac{13}{400}\\right)^{2} + \\left(-\\frac{18}{400}\\right)^{2}\n$$\n$$\n\\Delta^{2} = \\frac{13^{2} + 13^{2} + 18^{2}}{400^{2}} = \\frac{169 + 169 + 324}{160000} = \\frac{338 + 324}{160000} = \\frac{662}{160000}\n$$\n将分子和分母同除以 $2$ 来简化分数：\n$$\n\\Delta^{2} = \\frac{331}{80000}\n$$\n分子 331 是一个质数，所以这个分数是最简形式。这就是平方修正量的精确值。",
            "answer": "$$\\boxed{\\frac{331}{80000}}$$"
        }
    ]
}