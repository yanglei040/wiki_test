{
    "hands_on_practices": [
        {
            "introduction": "At its mathematical core, Proper Orthogonal Decomposition (POD) is an application of Singular Value Decomposition (SVD). This fundamental connection is key to understanding how POD identifies the most dominant patterns in a dataset. This first exercise provides a direct look at this relationship by having you construct a dataset with a predefined, low-rank structure and verify that POD precisely recovers the number of underlying modes, demonstrating that the number of non-zero singular values is equivalent to the rank of the snapshot matrix .",
            "id": "3265930",
            "problem": "Consider a snapshot matrix $X \\in \\mathbb{R}^{100 \\times 50}$ used in reduced-order modeling via Proper Orthogonal Decomposition (POD). Construct $X$ by selecting three orthonormal spatial vectors $u_1, u_2, u_3 \\in \\mathbb{R}^{100}$, three orthonormal temporal vectors $v_1, v_2, v_3 \\in \\mathbb{R}^{50}$, and three positive scalars $\\sigma_1, \\sigma_2, \\sigma_3$. Let the spatial vectors be the first three standard basis vectors, $u_1 = e_1$, $u_2 = e_2$, $u_3 = e_3$, where $e_i \\in \\mathbb{R}^{100}$ has a $1$ in the $i$-th position and $0$ elsewhere. Let the temporal vectors be the first three standard basis vectors, $v_1 = e_1$, $v_2 = e_2$, $v_3 = e_3$, where $e_i \\in \\mathbb{R}^{50}$ has a $1$ in the $i$-th position and $0$ elsewhere. Choose the singular values $\\sigma_1 = 6$, $\\sigma_2 = 3$, and $\\sigma_3 = 1$. Define the snapshot matrix as the rank-$3$ sum of outer products\n$$\nX \\;=\\; \\sigma_1 \\, u_1 v_1^{\\top} \\;+\\; \\sigma_2 \\, u_2 v_2^{\\top} \\;+\\; \\sigma_3 \\, u_3 v_3^{\\top}.\n$$\nUsing only the foundational definitions of singular value decomposition and matrix rank, determine the number of non-zero singular values recovered by Proper Orthogonal Decomposition (POD) applied to $X$. Express your final answer as a single integer.",
            "solution": "The problem requires determining the number of non-zero singular values of a given matrix $X$, which is constructed in a specific manner relevant to Proper Orthogonal Decomposition (POD).\n\nFirst, let us establish the foundational principles. For any real matrix $X \\in \\mathbb{R}^{m \\times n}$, the Singular Value Decomposition (SVD) provides a factorization of the form $X = U \\Sigma V^{\\top}$. Here, $U \\in \\mathbb{R}^{m \\times m}$ and $V \\in \\mathbb{R}^{n \\times n}$ are orthogonal matrices, and $\\Sigma \\in \\mathbb{R}^{m \\times n}$ is a rectangular diagonal matrix. The diagonal entries of $\\Sigma$, denoted by $\\sigma_i$, are the singular values of $X$. They are non-negative and conventionally ordered such that $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_p \\ge 0$, where $p = \\min(m, n)$.\n\nThe SVD can also be expressed as a sum of rank-$1$ outer products:\n$$\nX = \\sum_{i=1}^{r} \\sigma_i u_i v_i^{\\top}\n$$\nwhere $r$ is the rank of the matrix $X$. The vectors $u_i \\in \\mathbb{R}^m$ are the columns of $U$ (the left singular vectors) and form an orthonormal set, i.e., $u_i^{\\top} u_j = \\delta_{ij}$. The vectors $v_i \\in \\mathbb{R}^n$ are the columns of $V$ (the right singular vectors) and also form an orthonormal set, i.e., $v_i^{\\top} v_j = \\delta_{ij}$. The scalars $\\sigma_i > 0$ for $i=1, \\dots, r$ are the non-zero singular values of $X$. The number of non-zero singular values is, by definition, the rank of the matrix.\n\nThe problem states that Proper Orthogonal Decomposition (POD) is applied to the snapshot matrix $X$. Within the framework of numerical linear algebra, POD (specifically, using the method of snapshots) is mathematically equivalent to the SVD of the snapshot matrix. The process recovers the left singular vectors $u_i$ (the POD modes), the right singular vectors $v_i$ (the temporal modes), and the singular values $\\sigma_i$. The number of non-zero singular values recovered is therefore the rank of $X$.\n\nThe snapshot matrix $X \\in \\mathbb{R}^{100 \\times 50}$ is defined as:\n$$\nX = \\sigma_1 u_1 v_1^{\\top} + \\sigma_2 u_2 v_2^{\\top} + \\sigma_3 u_3 v_3^{\\top}\n$$\nWe are given the following definitions:\n1.  The scalars are $\\sigma_1 = 6$, $\\sigma_2 = 3$, and $\\sigma_3 = 1$. These are all positive.\n2.  The spatial vectors are $u_1 = e_1$, $u_2 = e_2$, $u_3 = e_3$, where $e_i \\in \\mathbb{R}^{100}$ are the standard basis vectors. The set $\\{u_1, u_2, u_3\\}$ is an orthonormal set, as $e_i^{\\top}e_j = \\delta_{ij}$ for $i, j \\in \\{1, 2, 3\\}$.\n3.  The temporal vectors are $v_1 = e_1$, $v_2 = e_2$, $v_3 = e_3$, where $e_i \\in \\mathbb{R}^{50}$ are the standard basis vectors. The set $\\{v_1, v_2, v_3\\}$ is also an orthonormal set.\n\nThe given expression for $X$ perfectly matches the structure of the SVD outer product expansion. We have a sum of three terms. Each term is the product of a positive scalar $\\sigma_i$, a unit vector $u_i$, and the transpose of a unit vector $v_i$. The sets of vectors $\\{u_1, u_2, u_3\\}$ and $\\{v_1, v_2, v_3\\}$ are both orthonormal.\n\nThis means that the provided expression is, in fact, the singular value decomposition of $X$. The non-zero singular values of $X$ are precisely the scalars given: $\\sigma_1 = 6$, $\\sigma_2 = 3$, and $\\sigma_3 = 1$. All other singular values, $\\sigma_i$ for $i > 3$, are zero.\n\nThe problem asks for the *number* of non-zero singular values recovered by applying POD to $X$. Based on our analysis, there are exactly three positive singular values. The number of non-zero singular values is therefore $3$. This is also the rank of the matrix $X$.\n\nThe question is a direct test of the foundational definition of singular value decomposition and its relation to matrix rank. The construction of the matrix $X$ is a deliberate formulation of a rank-$3$ matrix via its SVD expansion. No further computation is necessary. The number of terms in the sum, given that the scalars are non-zero and the vector sets are orthonormal, directly provides the answer.\nThe number of non-zero singular values is $3$.",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "In practical applications, we rarely retain the full set of POD modes. Instead, we perform model reduction by truncating the basis to a manageable size, $r$. This exercise explores the most common criterion for selecting $r$: capturing a desired percentage of the total \"energy\" or variance of the system, which is directly related to the squared singular values . Furthermore, it introduces the concept of a weighted inner product, defined by a mass matrix $M$, which is crucial for correctly handling data from numerical methods like the Finite Element Method on non-uniform meshes.",
            "id": "2593061",
            "problem": "Consider a family of linear, coercive, parameterized partial differential equations discretized by the Finite Element Method (FEM). Suppose the solution manifold is sampled at three parameter values $\\mu_{1}$, $\\mu_{2}$, and $\\mu_{3}$, yielding three snapshot vectors in $\\mathbb{R}^{3}$ collected as columns of the snapshot matrix $S \\in \\mathbb{R}^{3 \\times 3}$. Let the finite element mass matrix be the symmetric positive definite matrix $M \\in \\mathbb{R}^{3 \\times 3}$. You will compute a Proper Orthogonal Decomposition (POD) with respect to the $M$-inner product for these snapshots.\n\nUse the following data:\n- The mass matrix is \n$$\nM \\;=\\; \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & \\tfrac{1}{2}\n\\end{pmatrix}.\n$$\n- The snapshot matrix is \n$$\nS \\;=\\; \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n\nAdopt the $M$-inner product $\\langle u, v \\rangle_{M} \\equiv u^{\\top} M v$ and the corresponding $M$-norm $\\|u\\|_{M} \\equiv \\sqrt{u^{\\top} M u}$. Define the snapshot correlation matrix by the fundamental POD definition\n$$\nC \\;=\\; S^{\\top} M S \\;\\in\\; \\mathbb{R}^{3 \\times 3}.\n$$\nLet the eigenvalues of $C$ be denoted and ordered nonincreasingly as $\\lambda_{1} \\ge \\lambda_{2} \\ge \\lambda_{3} \\ge 0$. The POD energy captured by the first $r$ modes is defined as\n$$\n\\mathcal{E}(r) \\;=\\; \\frac{\\sum_{i=1}^{r} \\lambda_{i}}{\\sum_{i=1}^{3} \\lambda_{i}}.\n$$\n\nYour tasks are:\n1. Given the target energy threshold $\\eta = 0.85$, determine the minimal integer $r$ such that $\\mathcal{E}(r) \\ge \\eta$.\n2. Using the fundamental POD error identity for snapshots, estimate the total snapshot reconstruction truncation error in the $M$-norm when using $r$ modes, defined as\n$E_{\\text{trunc}} = \\sum_{i=r+1}^{3} \\lambda_{i}$.\n\nReport your final answer as a two-entry row matrix $\\begin{pmatrix} r & E_{\\text{trunc}} \\end{pmatrix}$. No rounding is required, and exact values are expected. No physical units are needed.",
            "solution": "The problem requires the computation of two quantities related to the Proper Orthogonal Decomposition of a given set of snapshots. The first is the minimal number of modes, $r$, required to capture a specified fraction of the total energy. The second is the corresponding truncation error. The computations are to be performed with respect to the inner product induced by the mass matrix $M$.\n\nThe core of the POD method, as described, is the eigenvalue problem for the snapshot correlation matrix $C$. We begin by computing this matrix. The definition provided is\n$$\nC \\;=\\; S^{\\top} M S\n$$\nThe snapshot matrix $S$ is given as the $3 \\times 3$ identity matrix, $S = I = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$. The transpose of the identity matrix is the identity matrix itself, $S^{\\top} = I^{\\top} = I$. Substituting these into the definition of $C$ yields:\n$$\nC \\;=\\; I^{\\top} M I \\;=\\; I M I \\;=\\; M\n$$\nTherefore, the correlation matrix $C$ is identical to the mass matrix $M$:\n$$\nC \\;=\\; M \\;=\\; \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & \\tfrac{1}{2}\n\\end{pmatrix}\n$$\nThe next step is to determine the eigenvalues of $C$. Since $C$ is a diagonal matrix, its eigenvalues are precisely its diagonal entries. The problem requires that these eigenvalues be ordered nonincreasingly: $\\lambda_{1} \\ge \\lambda_{2} \\ge \\lambda_{3}$. From the diagonal of $C$, we identify the eigenvalues as $2$, $1$, and $\\frac{1}{2}$. Ordering them gives:\n$$\n\\lambda_{1} = 2\n$$\n$$\n\\lambda_{2} = 1\n$$\n$$\n\\lambda_{3} = \\frac{1}{2}\n$$\nThese eigenvalues represent the squared singular values of the snapshot matrix scaled by the $M$-inner product, and their sum represents the total energy, or variance, contained in the snapshots. The total energy is the trace of the correlation matrix, $\\mathrm{Tr}(C)$:\n$$\n\\sum_{i=1}^{3} \\lambda_{i} = \\lambda_{1} + \\lambda_{2} + \\lambda_{3} = 2 + 1 + \\frac{1}{2} = 3.5 = \\frac{7}{2}\n$$\nNow, we address the first task: to find the minimal integer $r$ such that the captured energy $\\mathcal{E}(r)$ meets or exceeds the threshold $\\eta = 0.85$. The captured energy is defined as:\n$$\n\\mathcal{E}(r) \\;=\\; \\frac{\\sum_{i=1}^{r} \\lambda_{i}}{\\sum_{i=1}^{3} \\lambda_{i}}\n$$\nWe evaluate $\\mathcal{E}(r)$ for $r = 1, 2, \\dots$ until the condition $\\mathcal{E}(r) \\ge 0.85$ is met. The threshold is $\\eta = 0.85 = \\frac{85}{100} = \\frac{17}{20}$.\n\nFor $r=1$:\n$$\n\\mathcal{E}(1) = \\frac{\\lambda_{1}}{\\sum_{i=1}^{3} \\lambda_{i}} = \\frac{2}{\\frac{7}{2}} = \\frac{4}{7}\n$$\nWe compare this to the threshold. Is $\\frac{4}{7} \\ge \\frac{17}{20}$? By cross-multiplication, we compare $4 \\times 20 = 80$ and $7 \\times 17 = 119$. Since $80 < 119$, we have $\\frac{4}{7} < \\frac{17}{20}$. Thus, $\\mathcal{E}(1) < 0.85$. One mode is insufficient.\n\nFor $r=2$:\n$$\n\\mathcal{E}(2) = \\frac{\\lambda_{1} + \\lambda_{2}}{\\sum_{i=1}^{3} \\lambda_{i}} = \\frac{2 + 1}{\\frac{7}{2}} = \\frac{3}{\\frac{7}{2}} = \\frac{6}{7}\n$$\nWe compare this to the threshold. Is $\\frac{6}{7} \\ge \\frac{17}{20}$? By cross-multiplication, we compare $6 \\times 20 = 120$ and $7 \\times 17 = 119$. Since $120 > 119$, we have $\\frac{6}{7} > \\frac{17}{20}$. Thus, $\\mathcal{E}(2) > 0.85$. Two modes are sufficient.\n\nSince $r=1$ is insufficient and $r=2$ is sufficient, the minimal integer is $r=2$.\n\nThe second task is to compute the total snapshot reconstruction truncation error, $E_{\\text{trunc}}$, when using $r=2$ modes. The definition provided is:\n$$\nE_{\\text{trunc}} \\;=\\; \\sum_{i=r+1}^{3} \\lambda_{i}\n$$\nFor $r=2$, this sum becomes:\n$$\nE_{\\text{trunc}} \\;=\\; \\sum_{i=2+1}^{3} \\lambda_{i} \\;=\\; \\sum_{i=3}^{3} \\lambda_{i} \\;=\\; \\lambda_{3}\n$$\nSubstituting the value for $\\lambda_{3}$:\n$$\nE_{\\text{trunc}} = \\frac{1}{2}\n$$\nThis value represents the energy content of the modes that are truncated, which is exactly the portion of total energy not captured by the first $r$ modes.\n\nThe two required values are $r=2$ and $E_{\\text{trunc}} = \\frac{1}{2}$. The final answer must be reported as a two-entry row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2 & \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "This practice brings together all the core concepts to build and analyze a complete Reduced-Order Model (ROM). Starting with a parameterized advection-diffusion equation, you will implement the full workflow: discretizing the PDE, generating snapshot data, computing a POD basis, and constructing a predictive ROM via Galerkin projection . The exercise culminates in a parametric study, where you will test the ROM's accuracy with physical parameters different from those used for its training, revealing the power and limitations of non-intrusive parametric ROMs.",
            "id": "3265932",
            "problem": "Consider the one-dimensional linear advection-diffusion initial-boundary value problem on the spatial interval $x \\in (0,1)$ with homogeneous Dirichlet boundary conditions, governed by the partial differential equation\n$$\n\\frac{\\partial u}{\\partial t}(x,t;\\mu) \\;=\\; \\mu \\,\\frac{\\partial^2 u}{\\partial x^2}(x,t;\\mu) \\;-\\; a \\,\\frac{\\partial u}{\\partial x}(x,t;\\mu), \\quad u(0,t;\\mu) = 0,\\quad u(1,t;\\mu) = 0,\\quad u(x,0;\\mu) = u_0(x),\n$$\nwhere $\\mu > 0$ is the diffusion parameter and $a \\ge 0$ is the advection speed. The Reduced-Order Model (ROM) will be constructed using a Galerkin projection onto a basis obtained via Proper Orthogonal Decomposition (POD) of snapshots generated at a training parameter $\\mu_{\\text{train}}$, and then applied to test parameters $\\mu_{\\text{test}}$ of the same partial differential equation.\n\nStarting from fundamental definitions:\n- Use the method-of-lines to semi-discretize the spatial derivatives on $N$ interior grid points with uniform spacing $h$, where $h = \\frac{1}{N+1}$ and the interior nodes are $x_i = i h$ for $i = 1,2,\\dots,N$. Approximate $\\frac{\\partial^2 u}{\\partial x^2}$ using the standard second-order centered finite difference, and approximate $\\frac{\\partial u}{\\partial x}$ using the first-order upwind finite difference consistent with $a \\ge 0$. This yields a semi-discrete ordinary differential equation\n$$\n\\frac{d \\mathbf{u}}{dt}(t;\\mu) \\;=\\; A(\\mu)\\,\\mathbf{u}(t;\\mu),\n$$\nwhere $\\mathbf{u}(t;\\mu) \\in \\mathbb{R}^N$ and $A(\\mu) \\in \\mathbb{R}^{N \\times N}$ is the parameter-dependent spatial operator formed from the discretizations.\n- Advance the semi-discrete system in time using the implicit Euler method. With time step $\\Delta t$ and $t_k = k\\,\\Delta t$, the update satisfies\n$$\n\\left(I - \\Delta t\\,A(\\mu)\\right)\\,\\mathbf{u}^{k+1} \\;=\\; \\mathbf{u}^{k},\n$$\nwhere $\\mathbf{u}^k \\approx \\mathbf{u}(t_k;\\mu)$.\n- Generate a snapshot matrix $X \\in \\mathbb{R}^{N \\times (K+1)}$ at the training parameter $\\mu_{\\text{train}}$ by concatenating the state vectors $\\mathbf{u}^k$ over $k = 0,1,\\dots,K$ for final time $T = K\\,\\Delta t$. Compute the Proper Orthogonal Decomposition (POD) basis of rank $r$ using the Singular Value Decomposition (SVD), $X = U\\,\\Sigma\\,V^\\top$, and take the first $r$ columns of $U$ as the orthonormal basis $V \\in \\mathbb{R}^{N \\times r}$. Proper Orthogonal Decomposition (POD) is defined here as the computation of an orthonormal basis that maximizes captured energy (in the Euclidean inner product) from the snapshot ensemble via the Singular Value Decomposition (SVD).\n- Form the Galerkin-projected Reduced-Order Model (ROM) for a test parameter $\\mu_{\\text{test}}$ by projecting the full operator onto the POD basis, yielding\n$$\nA_r(\\mu_{\\text{test}}) \\;=\\; V^\\top A(\\mu_{\\text{test}}) V \\in \\mathbb{R}^{r \\times r},\n$$\nand evolve the reduced system with implicit Euler:\n$$\n\\left(I_r - \\Delta t\\,A_r(\\mu_{\\text{test}})\\right)\\,\\mathbf{y}^{k+1} \\;=\\; \\mathbf{y}^{k}, \\quad \\text{with} \\quad \\mathbf{y}^0 \\;=\\; V^\\top \\mathbf{u}^0, \\quad \\mathbf{u}_{\\text{ROM}}^{k} \\;=\\; V\\,\\mathbf{y}^{k}.\n$$\n\nYour program must implement the above using the following scientifically consistent and self-contained test suite and parameters:\n- Spatial discretization:\n  - $N = 64$ interior points.\n  - Domain length $L = 1$, grid spacing $h = \\frac{L}{N+1}$, interior nodes $x_i = i\\,h$ for $i=1,\\dots,N$.\n  - Homogeneous Dirichlet boundaries are enforced by the stencil construction on the interior unknowns.\n- Time discretization:\n  - Implicit Euler with $\\Delta t = 10^{-3}$.\n  - Final time $T = 0.2$, so $K = \\frac{T}{\\Delta t} = 200$ time steps.\n- PDE parameters:\n  - Advection speed $a = 1.0$.\n  - Training diffusion parameter $\\mu_{\\text{train}} = 0.01$.\n- Initial condition:\n  - $u_0(x) = \\sin(\\pi x) + \\tfrac{1}{2}\\,\\sin(2\\pi x)$, discretized on the interior nodes to form $\\mathbf{u}^0 \\in \\mathbb{R}^N$.\n- POD basis:\n  - Rank $r = 6$ constructed from snapshots at $\\mu_{\\text{train}}$ using the Singular Value Decomposition (SVD) of the snapshot matrix as described above.\n\nEvaluate the ROM at the following four test parameters to analyze the impact of generating the basis from a different parameter regime:\n- Case $1$: $\\mu_{\\text{test}} = \\mu_{\\text{train}}$.\n- Case $2$: $\\mu_{\\text{test}} = 1.2\\,\\mu_{\\text{train}}$.\n- Case $3$: $\\mu_{\\text{test}} = 5\\,\\mu_{\\text{train}}$.\n- Case $4$: $\\mu_{\\text{test}} = 10^{-4}$.\n\nFor each case, compute the final-time relative error between the full-order model (FOM) and ROM solutions,\n$$\ne_{\\text{final}} \\;=\\; \\frac{\\left\\|\\mathbf{u}^{K} - \\mathbf{u}_{\\text{ROM}}^{K}\\right\\|_2}{\\left\\|\\mathbf{u}^{K}\\right\\|_2},\n$$\nwhere $\\|\\cdot\\|_2$ is the Euclidean norm.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the four cases $[\\text{Case 1}, \\text{Case 2}, \\text{Case 3}, \\text{Case 4}]$, with each value printed as a decimal with eight digits after the decimal point (e.g., $[0.00123456,0.00234567,0.01234567,0.12345678]$). No physical units are involved, and all angles, if any, are implicitly in radians, though none are used here. The answers are pure real numbers in decimal form.",
            "solution": "### 1. Full-Order Model (FOM) Discretization\n\nThe partial differential equation is:\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; \\mu \\,\\frac{\\partial^2 u}{\\partial x^2} \\;-\\; a \\,\\frac{\\partial u}{\\partial x}\n$$\nWe discretize the spatial domain $x \\in (0,1)$ into $N=64$ interior points $x_i = i h$ for $i=1,\\dots,N$, with grid spacing $h = 1/(N+1)$. The state of the system is represented by the vector $\\mathbf{u}(t) \\in \\mathbb{R}^N$, where $(\\mathbf{u})_i = u(x_i, t)$.\n\nThe spatial derivatives are approximated using finite differences as specified:\n- **Diffusion Term (2nd-order centered)**:\n$$\n\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{x_i} \\approx \\frac{u(x_{i+1},t) - 2u(x_i,t) + u(x_{i-1},t)}{h^2} = \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2}\n$$\n- **Advection Term (1st-order upwind for $a \\ge 0$)**:\n$$\n\\frac{\\partial u}{\\partial x}\\bigg|_{x_i} \\approx \\frac{u(x_i,t) - u(x_{i-1},t)}{h} = \\frac{u_i - u_{i-1}}{h}\n$$\n\nSubstituting these approximations into the PDE for each interior node $x_i$ yields a system of ordinary differential equations (ODEs), $\\frac{d\\mathbf{u}}{dt} = A(\\mu)\\mathbf{u}$. The $i$-th equation is:\n$$\n\\frac{du_i}{dt} = \\mu \\left( \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} \\right) - a \\left( \\frac{u_i - u_{i-1}}{h} \\right)\n$$\nHomogeneous Dirichlet boundary conditions $u(0,t)=u_0=0$ and $u(1,t)=u_{N+1}=0$ are incorporated into the stencils at the boundaries ($i=1$ and $i=N$). Rearranging the terms for $u_{i-1}$, $u_i$, and $u_{i+1}$ reveals the structure of the system matrix $A(\\mu)$:\n$$\n\\frac{du_i}{dt} = \\left(\\frac{\\mu}{h^2} + \\frac{a}{h}\\right) u_{i-1} + \\left(-\\frac{2\\mu}{h^2} - \\frac{a}{h}\\right) u_i + \\left(\\frac{\\mu}{h^2}\\right) u_{i+1}\n$$\nThis defines a tridiagonal matrix $A(\\mu) \\in \\mathbb{R}^{N \\times N}$ with the following diagonals:\n- **Main diagonal**: $-\\frac{2\\mu}{h^2} - \\frac{a}{h}$\n- **Sub-diagonal (lower)**: $\\frac{\\mu}{h^2} + \\frac{a}{h}$\n- **Super-diagonal (upper)**: $\\frac{\\mu}{h^2}$\n\n### 2. Time Integration and Snapshot Generation\n\nThe semi-discrete system is advanced in time using the implicit Euler method with timestep $\\Delta t = 10^{-3}$:\n$$\n\\frac{\\mathbf{u}^{k+1} - \\mathbf{u}^{k}}{\\Delta t} = A(\\mu) \\mathbf{u}^{k+1} \\implies \\left(I - \\Delta t\\,A(\\mu)\\right)\\,\\mathbf{u}^{k+1} = \\mathbf{u}^{k}\n$$\nTo obtain the solution at step $k+1$, we solve a linear system at each time step.\n\nSnapshots are generated by solving the FOM for the training parameter $\\mu_{\\text{train}} = 0.01$. The initial condition is $\\mathbf{u}^0$, obtained by evaluating $u_0(x) = \\sin(\\pi x) + \\frac{1}{2}\\sin(2\\pi x)$ at the grid points $x_i$. The simulation runs up to time $T=0.2$, which corresponds to $K = T/\\Delta t = 200$ steps. The snapshot matrix $X \\in \\mathbb{R}^{N \\times (K+1)}$ is formed by collecting the state vectors:\n$$\nX = \\begin{bmatrix} | & | & & | \\\\ \\mathbf{u}^0 & \\mathbf{u}^1 & \\dots & \\mathbf{u}^K \\\\ | & | & & | \\end{bmatrix}\n$$\n\n### 3. POD Basis Construction\n\nThe POD basis is computed from the Singular Value Decomposition (SVD) of the snapshot matrix $X$:\n$$\nX = U \\Sigma V^\\top\n$$\nThe columns of the matrix $U \\in \\mathbb{R}^{N \\times (K+1)}$ are the left singular vectors, which are orthonormal and represent the spatial modes of the system's dynamics. The optimal rank-$r$ basis, in the sense of capturing the most energy, is formed by the first $r$ columns of $U$. We construct the basis matrix $V_{\\text{basis}} \\in \\mathbb{R}^{N \\times r}$ using $r=6$:\n$$\nV_{\\text{basis}} = U[:, 0:r]\n$$\n\n### 4. Reduced-Order Model (ROM) Formulation and Simulation\n\nThe ROM is constructed by projecting the governing FOM equations onto the low-dimensional subspace spanned by $V_{\\text{basis}}$. An approximate solution is sought in the form $\\mathbf{u}_{\\text{ROM}}(t) = V_{\\text{basis}}\\mathbf{y}(t)$, where $\\mathbf{y}(t) \\in \\mathbb{R}^r$ are the reduced coordinates.\nSubstituting this into the semi-discrete system and applying Galerkin projection (pre-multiplying by $V_{\\text{basis}}^\\top$) yields the ROM for a given test parameter $\\mu_{\\text{test}}$:\n$$\nV_{\\text{basis}}^\\top V_{\\text{basis}} \\frac{d\\mathbf{y}}{dt} = V_{\\text{basis}}^\\top A(\\mu_{\\text{test}}) V_{\\text{basis}} \\mathbf{y}\n$$\nSince $V_{\\text{basis}}$ is orthonormal ($V_{\\text{basis}}^\\top V_{\\text{basis}} = I_r$), this simplifies to:\n$$\n\\frac{d\\mathbf{y}}{dt} = A_r(\\mu_{\\text{test}}) \\mathbf{y}, \\quad \\text{where} \\quad A_r(\\mu_{\\text{test}}) = V_{\\text{basis}}^\\top A(\\mu_{\\text{test}}) V_{\\text{basis}}\n$$\nThe reduced operator $A_r \\in \\mathbb{R}^{r \\times r}$. The initial condition for the ROM is the projection of the full-order initial condition: $\\mathbf{y}^0 = V_{\\text{basis}}^\\top \\mathbf{u}^0$.\nThe ROM is time-stepped with implicit Euler, analogous to the FOM:\n$$\n\\left(I_r - \\Delta t\\,A_r(\\mu_{\\text{test}})\\right)\\,\\mathbf{y}^{k+1} = \\mathbf{y}^{k}\n$$\nAfter simulating to the final time $T$ to find $\\mathbf{y}^K$, the solution is reconstructed back to the full state space: $\\mathbf{u}_{\\text{ROM}}^K = V_{\\text{basis}}\\mathbf{y}^K$.\n\n### 5. Error Evaluation\n\nFor each test case $\\mu_{\\text{test}}$, we compute both the FOM solution $\\mathbf{u}^K$ and the ROM solution $\\mathbf{u}_{\\text{ROM}}^K$ at the final time $T=0.2$. The relative error is calculated as:\n$$\ne_{\\text{final}} = \\frac{\\|\\mathbf{u}^K - \\mathbf{u}_{\\text{ROM}}^K\\|_2}{\\|\\mathbf{u}^K\\|_2}\n$$\nThis procedure is repeated for all four specified values of $\\mu_{\\text{test}}$, and the resulting errors are reported.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a POD-Galerkin Reduced-Order Model for a 1D advection-diffusion\n    equation and evaluates its accuracy for several test parameters.\n    \"\"\"\n    # --------------------------------------------------------------------------\n    # 1. Define problem parameters and grid\n    # --------------------------------------------------------------------------\n    N = 64                  # Number of interior spatial points\n    L = 1.0                 # Domain length\n    a = 1.0                 # Advection speed\n    dt = 1.0e-3             # Time step\n    T = 0.2                 # Final time\n    r = 6                   # Rank of POD basis\n    mu_train = 0.01         # Training diffusion parameter\n\n    test_cases_mu = [\n        mu_train,\n        1.2 * mu_train,\n        5.0 * mu_train,\n        1.0e-4\n    ]\n\n    h = L / (N + 1)         # Grid spacing\n    K = int(T / dt)         # Number of time steps\n    x_grid = np.arange(1, N + 1) * h\n\n    # Initial condition\n    u0 = np.sin(np.pi * x_grid) + 0.5 * np.sin(2 * np.pi * x_grid)\n\n    # Memoization caches for efficiency\n    memo_A = {}\n    memo_fom_final_state = {}\n\n    # --------------------------------------------------------------------------\n    # 2. Helper functions for FOM and ROM\n    # --------------------------------------------------------------------------\n    def build_A(mu):\n        \"\"\"Constructs the FOM spatial discretization matrix A(mu).\"\"\"\n        if mu in memo_A:\n            return memo_A[mu]\n\n        h2 = h * h\n        diag_main = -2.0 * mu / h2 - a / h\n        diag_upper = mu / h2\n        diag_lower = mu / h2 + a / h\n        \n        A = np.zeros((N, N))\n        np.fill_diagonal(A, diag_main)\n        np.fill_diagonal(A[1:, :-1], diag_lower)\n        np.fill_diagonal(A[:-1, 1:], diag_upper)\n        \n        memo_A[mu] = A\n        return A\n\n    def run_fom(mu, collect_snapshots=False):\n        \"\"\"Simulates the Full-Order Model (FOM).\"\"\"\n        if not collect_snapshots and mu in memo_fom_final_state:\n            return memo_fom_final_state[mu], None\n\n        A = build_A(mu)\n        # Implicit Euler matrix: M * u^{k+1} = u^k\n        M = np.eye(N) - dt * A\n        u = u0.copy()\n\n        if collect_snapshots:\n            snapshots = np.zeros((N, K + 1))\n            snapshots[:, 0] = u\n            for k in range(K):\n                u = np.linalg.solve(M, u)\n                snapshots[:, k + 1] = u\n            return u, snapshots\n        else:\n            for k in range(K):\n                u = np.linalg.solve(M, u)\n            memo_fom_final_state[mu] = u\n            return u, None\n    \n    # --------------------------------------------------------------------------\n    # 3. Generate POD basis from training data\n    # --------------------------------------------------------------------------\n    _, X_train = run_fom(mu_train, collect_snapshots=True)\n    \n    # Compute SVD: X = U * S * Vh. The POD basis are the left singular vectors (columns of U).\n    # The problem description calls the basis 'V', but it's constructed from 'U'.\n    U, _, _ = np.linalg.svd(X_train, full_matrices=False)\n    V_basis = U[:, :r]\n\n    # --------------------------------------------------------------------------\n    # 4. Evaluate ROM for each test case\n    # --------------------------------------------------------------------------\n    results = []\n    \n    # Project initial condition onto the POD basis\n    y0 = V_basis.T @ u0\n    \n    for mu_test in test_cases_mu:\n        # Get the true FOM solution at the final time for comparison\n        u_fom_final, _ = run_fom(mu_test, collect_snapshots=False)\n\n        # Build and run the ROM\n        A_test = build_A(mu_test)\n        \n        # Project the FOM operator to get the ROM operator\n        A_r = V_basis.T @ A_test @ V_basis\n        \n        # Implicit Euler matrix for the ROM\n        M_r = np.eye(r) - dt * A_r\n        \n        y = y0.copy()\n        for _ in range(K):\n            y = np.linalg.solve(M_r, y)\n        \n        # Reconstruct the full-order solution from the ROM state\n        u_rom_final = V_basis @ y\n        \n        # Calculate final-time relative error\n        error_norm = np.linalg.norm(u_fom_final - u_rom_final)\n        fom_norm = np.linalg.norm(u_fom_final)\n        \n        if fom_norm == 0:\n            # Avoid division by zero, though unlikely for this problem\n            relative_error = error_norm\n        else:\n            relative_error = error_norm / fom_norm\n            \n        results.append(relative_error)\n        \n    # --------------------------------------------------------------------------\n    # 5. Format and print the final output\n    # --------------------------------------------------------------------------\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}