{
    "hands_on_practices": [
        {
            "introduction": "在我们应用这些先验之前，我们必须首先理解它们是如何被构建的。这个练习将探讨Karhunen–Loève (KL) 展开，它利用一个微分算子的本征基来表示随机场。这是随机偏微分方程（SPDE）方法的基础，对于理论分析和计算采样都至关重要。",
            "id": "3377262",
            "problem": "考虑一个有界开连通域 $\\mathcal{D} \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{1,2,3\\}$），其边界 $\\partial \\mathcal{D}$ 光滑。设 $L$ 是在 $L^{2}(\\mathcal{D})$ 上的一个二阶一致椭圆、自伴、正定微分算子，带有齐次狄利克雷边界条件。假设 $L$ 在 $L^{2}(\\mathcal{D})$ 上有一个紧逆算子，并具有一个完备标准正交特征基 $\\{\\phi_{k}\\}_{k=1}^{\\infty} \\subset L^{2}(\\mathcal{D})$ 和相应的特征值 $\\{\\lambda_{k}\\}_{k=1}^{\\infty}$，满足 $0 < \\lambda_{1} \\le \\lambda_{2} \\le \\cdots$ 且当 $k \\to \\infty$ 时 $\\lambda_{k} \\to \\infty$。考虑由高斯场 $u$ 定义的随机偏微分方程（SPDE）先验，该高斯场在分布意义下是方程 $L^{1/2} u = W$ 的解，其中 $W$ 是 $L^{2}(\\mathcal{D})$ 上的高斯白噪声。这个先验是离散不变的，即其法则是定义在函数空间上的，不依赖于任何特定的网格或基。\n\n从高斯白噪声的第一性原理、自伴算子的谱定理以及 $u$ 的协方差算子 $C = L^{-1}$ 的定义出发，推导 $u$ 在 $L$ 的特征基 $\\{\\phi_{k}\\}_{k=1}^{\\infty}$ 中的 Karhunen–Loève (KL) 展开。然后，对于 N 项截断 $u_{N} := \\sum_{k=1}^{N} \\lambda_{k}^{-1/2} \\xi_{k} \\phi_{k}$（其中 $\\{\\xi_{k}\\}_{k=1}^{\\infty}$ 是独立同分布的标准正态随机变量），将均方 $L^{2}(\\mathcal{D})$ 截断误差 $\\mathbb{E}\\left[\\|u - u_{N}\\|_{L^{2}(\\mathcal{D})}^{2}\\right]$ 量化为 $N$ 和特征值 $\\{\\lambda_{k}\\}_{k=1}^{\\infty}$ 的显式函数。\n\n你的最终答案应为 $\\mathbb{E}\\left[\\|u - u_{N}\\|_{L^{2}(\\mathcal{D})}^{2}\\right]$ 的一个单一闭式解析表达式，用 $\\{\\lambda_{k}\\}_{k=N+1}^{\\infty}$ 表示。不要报告渐近率或界；请给出精确表达式。不需要进行数值舍入。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n-   **域**：$\\mathcal{D} \\subset \\mathbb{R}^{d}$ 是一个有界开连通域，其中 $d \\in \\{1,2,3\\}$，边界 $\\partial \\mathcal{D}$ 光滑。\n-   **算子**：$L$ 是在 $L^{2}(\\mathcal{D})$ 上的一个二阶一致椭圆、自伴、正定微分算子，带有齐次狄利克雷边界条件。\n-   **逆算子**：$L^{-1}$ 在 $L^{2}(\\mathcal{D})$ 上是紧的。\n-   **谱性质**：$L$ 有一个完备标准正交特征基 $\\{\\phi_{k}\\}_{k=1}^{\\infty} \\subset L^{2}(\\mathcal{D})$ 和相应的实特征值 $\\{\\lambda_{k}\\}_{k=1}^{\\infty}$，满足 $0 < \\lambda_{1} \\le \\lambda_{2} \\le \\cdots$ 且当 $k \\to \\infty$ 时 $\\lambda_{k} \\to \\infty$。因此，$L\\phi_{k} = \\lambda_{k}\\phi_{k}$。\n-   **随机偏微分方程 (SPDE)**：高斯场 $u$ 被定义为 $L^{1/2} u = W$ 的解，其中 $W$ 是 $L^{2}(\\mathcal{D})$ 上的高斯白噪声。\n-   **协方差算子**：场 $u$ 的协方差算子是 $C = L^{-1}$。\n-   **截断展开**：$u_{N} := \\sum_{k=1}^{N} \\lambda_{k}^{-1/2} \\xi_{k} \\phi_{k}$，其中 $\\{\\xi_{k}\\}_{k=1}^{\\infty}$ 是独立同分布 (i.i.d.) 的标准正态随机变量，$\\xi_{k} \\sim \\mathcal{N}(0,1)$。\n-   **目标**：推导 $u$ 的 Karhunen–Loève (KL) 展开，并将均方 $L^{2}(\\mathcal{D})$ 截断误差 $\\mathbb{E}\\left[\\|u - u_{N}\\|_{L^{2}(\\mathcal{D})}^{2}\\right]$ 量化为 $N$ 和特征值 $\\{\\lambda_{k}\\}_{k=1}^{\\infty}$ 的显式函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据、是适定且客观的。它是贝叶斯反问题和不确定性量化领域的一个标准理论问题，具体涉及通过 SPDE 定义的高斯先验。所有术语都在泛函分析和概率论的背景下有明确定义。关于算子 $L$ 及其谱的假设对于这类问题是标准的。该问题是自洽的，包含一个基于已建立的数学原理的直接推导。清单中的缺陷均不存在。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n## 解答\n\n该问题要求推导一个由随机偏微分方程定义的高斯随机场的均方截断误差。推导过程从第一性原理出发。\n\n首先，我们在希尔伯特空间 $L^{2}(\\mathcal{D})$ 上，用算子 $L$ 的完备标准正交特征基 $\\{\\phi_{k}\\}_{k=1}^{\\infty}$ 来表示高斯白噪声 $W$。该表示由以下级数给出：\n$$\nW = \\sum_{k=1}^{\\infty} \\xi_{k} \\phi_{k}\n$$\n其中系数 $\\xi_{k} = \\langle W, \\phi_{k} \\rangle_{L^{2}(\\mathcal{D})}$ 是独立同分布 (i.i.d.) 的标准正态随机变量，即 $\\xi_{k} \\sim \\mathcal{N}(0, 1)$。这里，$\\langle \\cdot, \\cdot \\rangle_{L^{2}(\\mathcal{D})}$ 表示 $L^{2}(\\mathcal{D})$ 上的内积。\n\n高斯随机场 $u$ 被定义为 SPDE $L^{1/2} u = W$ 的解。为了求解 $u$，我们形式上将逆算子 $(L^{1/2})^{-1} = L^{-1/2}$ 作用于方程两侧：\n$$\nu = L^{-1/2} W\n$$\n$L^{-1/2}$ 对 $W$ 的作用由其对基元的作用决定，这由自伴算子的谱定理定义。对于任意特征函数 $\\phi_{k}$，算子 $L$ 的函数 $f(L)$ 的作用是 $f(L)\\phi_{k} = f(\\lambda_{k})\\phi_{k}$。在本例中，$f(L) = L^{-1/2}$，我们有 $L^{-1/2}\\phi_{k} = \\lambda_{k}^{-1/2}\\phi_{k}$。\n\n将 $W$ 的级数展开式代入，并逐项应用该算子，我们得到 $u$ 的 Karhunen-Loève (KL) 展开：\n$$\nu = L^{-1/2} \\left( \\sum_{k=1}^{\\infty} \\xi_{k} \\phi_{k} \\right) = \\sum_{k=1}^{\\infty} \\xi_{k} (L^{-1/2} \\phi_{k}) = \\sum_{k=1}^{\\infty} \\lambda_{k}^{-1/2} \\xi_{k} \\phi_{k}\n$$\n该展开式将随机场 $u$ 表示为确定性基函数 $\\phi_{k}$ 的线性组合，其系数为不相关的随机变量 $\\lambda_{k}^{-1/2}\\xi_{k}$。\n\n问题将此展开的 N 项截断定义为 $u_{N} = \\sum_{k=1}^{N} \\lambda_{k}^{-1/2} \\xi_{k} \\phi_{k}$。截断误差是完整场 $u$ 与其近似 $u_{N}$ 之间的差：\n$$\nu - u_{N} = \\left( \\sum_{k=1}^{\\infty} \\lambda_{k}^{-1/2} \\xi_{k} \\phi_{k} \\right) - \\left( \\sum_{k=1}^{N} \\lambda_{k}^{-1/2} \\xi_{k} \\phi_{k} \\right) = \\sum_{k=N+1}^{\\infty} \\lambda_{k}^{-1/2} \\xi_{k} \\phi_{k}\n$$\n我们需要找到均方截断误差，即该误差项的 $L^{2}(\\mathcal{D})$ 范数平方的期望值 $\\mathbb{E}\\left[\\|u - u_{N}\\|_{L^{2}(\\mathcal{D})}^{2}\\right]$。$L^{2}$ 范数的平方为 $\\|f\\|_{L^{2}(\\mathcal{D})}^{2} = \\langle f, f \\rangle_{L^{2}(\\mathcal{D})}$。\n对于误差项，我们有：\n$$\n\\|u - u_{N}\\|_{L^{2}(\\mathcal{D})}^{2} = \\left\\langle \\sum_{j=N+1}^{\\infty} \\lambda_{j}^{-1/2} \\xi_{j} \\phi_{j}, \\sum_{k=N+1}^{\\infty} \\lambda_{k}^{-1/2} \\xi_{k} \\phi_{k} \\right\\rangle_{L^{2}(\\mathcal{D})}\n$$\n根据内积的双线性和特征基 $\\{\\phi_{k}\\}_{k=1}^{\\infty}$ 的标准正交性（即 $\\langle \\phi_{j}, \\phi_{k} \\rangle_{L^{2}(\\mathcal{D})} = \\delta_{jk}$，其中 $\\delta_{jk}$ 是克罗内克 δ），该表达式根据帕塞瓦尔恒等式简化为：\n$$\n\\|u - u_{N}\\|_{L^{2}(\\mathcal{D})}^{2} = \\sum_{j=N+1}^{\\infty} \\sum_{k=N+1}^{\\infty} \\lambda_{j}^{-1/2} \\lambda_{k}^{-1/2} \\xi_{j} \\xi_{k} \\langle \\phi_{j}, \\phi_{k} \\rangle_{L^{2}(\\mathcal{D})} = \\sum_{k=N+1}^{\\infty} \\left( \\lambda_{k}^{-1/2} \\right)^{2} \\xi_{k}^{2} = \\sum_{k=N+1}^{\\infty} \\lambda_{k}^{-1} \\xi_{k}^{2}\n$$\n接下来，我们计算这个量的期望。利用期望算子 $\\mathbb{E}[\\cdot]$ 的线性性质，由于各项非负（例如，根据单调收敛定理），期望可以与无限求和交换顺序，我们得到：\n$$\n\\mathbb{E}\\left[\\|u - u_{N}\\|_{L^{2}(\\mathcal{D})}^{2}\\right] = \\mathbb{E}\\left[ \\sum_{k=N+1}^{\\infty} \\lambda_{k}^{-1} \\xi_{k}^{2} \\right] = \\sum_{k=N+1}^{\\infty} \\mathbb{E}\\left[ \\lambda_{k}^{-1} \\xi_{k}^{2} \\right]\n$$\n由于特征值 $\\lambda_{k}$ 是确定性常数，它们可以从期望中提出来：\n$$\n\\mathbb{E}\\left[\\|u - u_{N}\\|_{L^{2}(\\mathcal{D})}^{2}\\right] = \\sum_{k=N+1}^{\\infty} \\lambda_{k}^{-1} \\mathbb{E}\\left[ \\xi_{k}^{2} \\right]\n$$\n变量 $\\xi_{k}$ 是独立同分布的标准正态随机变量，$\\xi_{k} \\sim \\mathcal{N}(0, 1)$。对于这样的变量，其平方的期望等于其方差加上其均值的平方：\n$$\n\\mathbb{E}[\\xi_{k}^{2}] = \\mathrm{Var}(\\xi_{k}) + (\\mathbb{E}[\\xi_{k}])^{2} = 1 + 0^{2} = 1\n$$\n将此结果代回我们的均方误差表达式中，得到最终结果：\n$$\n\\mathbb{E}\\left[\\|u - u_{N}\\|_{L^{2}(\\mathcal{D})}^{2}\\right] = \\sum_{k=N+1}^{\\infty} \\lambda_{k}^{-1} \\cdot 1 = \\sum_{k=N+1}^{\\infty} \\lambda_{k}^{-1}\n$$\n这就是均方 $L^{2}(\\mathcal{D})$ 截断误差的精确表达式，表示为与从 KL 展开中截断的模态相对应的 $L$ 的特征值的倒数之和。",
            "answer": "$$\n\\boxed{\\sum_{k=N+1}^{\\infty} \\lambda_{k}^{-1}}\n$$"
        },
        {
            "introduction": "既然我们有了先验的表示方法，一个自然的问题是：它会产生什么样的函数？本练习将深入探讨先验的Cameron–Martin空间，并揭示其与Sobolev空间的直接联系。理解这种联系使我们能够控制我们试图推断的函数的正则性或光滑度。",
            "id": "3377254",
            "problem": "考虑一个有界连通域 $\\Omega \\subset \\mathbb{R}^{d}$，其边界为 $\\mathcal{C}^{\\infty}$，并令 $-\\Delta$ 表示在 $\\partial \\Omega$ 上具有齐次 Neumann 边界条件的负拉普拉斯算子。算子 $-\\Delta$ 在 $L^{2}(\\Omega)$ 上是自伴且非负的，具有一组完备的正交本征函数基 $\\{e_{j}\\}_{j=0}^{\\infty}$ 和相应的本征值 $\\{\\lambda_{j}\\}_{j=0}^{\\infty}$，满足 $0=\\lambda_{0}\\leq \\lambda_{1}\\leq \\lambda_{2}\\leq \\cdots$，其中 $e_{0}$ 在 $\\Omega$ 上是常数。固定 $\\kappa>0$ 和 $\\alpha>0$，并通过谱演算在 $L^{2}(\\Omega)$ 上定义正自伴算子 $(\\kappa^{2}-\\Delta)$，使得对于 $s \\in \\mathbb{R}$，\n$$\n(\\kappa^{2}-\\Delta)^{s} e_{j} = (\\kappa^{2}+\\lambda_{j})^{s} e_{j}, \\quad j=0,1,2,\\dots.\n$$\n考虑 $L^{2}(\\Omega)$ 上的中心化高斯先验，定义为随机偏微分方程 (SPDE) $(\\kappa^{2}-\\Delta)^{\\alpha/2} u = W$ 的解 $u$，其中 $W$ 是 $\\Omega$ 上的高斯白噪声（零均值，协方差由 $L^{2}(\\Omega)$ 上的单位算子给出）。该先验是一个 Matérn 型高斯场，其协方差算子为 $C=(\\kappa^{2}-\\Delta)^{-\\alpha}$。\n\n使用协方差算子为 $C$ 的中心化高斯测度的 Cameron–Martin 空间的定义——即 Cameron–Martin 空间是 $C^{1/2}$ 的值域，并赋有由 $C^{-1/2}$ 导出的内积——推导此先验的 Cameron–Martin 空间的显式形式，并将其与 Sobolev 空间 $H^{\\alpha}(\\Omega)$（也称为 $\\alpha$ 阶 Bessel 位势空间）联系起来。在您的推导中，请从第一性原理出发：\n- 使用 Neumann 拉普拉斯算子的谱分解以及自伴算子的泛函演算。\n- 使用希尔伯特空间上高斯测度的 Cameron–Martin 空间的定义及其范数。\n- 使用 Bessel 位势范数的等价性以及有界光滑边界域上 Sobolev 空间的光谱刻画。\n\n您的最终答案必须是关于 $L^{2}(\\Omega)$ 中元素 $u$ 的 Cameron–Martin 范数平方的单个闭式解析表达式，用 Neumann 本征对 $\\{(\\lambda_{j},e_{j})\\}$ 和展开系数 $u_{j}=\\langle u,e_{j}\\rangle_{L^{2}(\\Omega)}$ 表示。最终答案中不要包含任何方程或不等式；只提供表达式。无需进行数值四舍五入。如果您引入任何缩写，请在首次使用时定义它们（例如，随机偏微分方程 (SPDE)，再生核希尔伯特空间 (RKHS)）。",
            "solution": "问题陈述被认为是有效的，因为它具有科学依据、良定且客观。它在泛函分析和随机偏微分方程的既定数学框架内，为定义高斯先验提供了一个完整且一致的设置。\n\n目标是推导在 $L^{2}(\\Omega)$ 上的中心化高斯测度的 Cameron–Martin 范数，其协方差算子为 $C = (\\kappa^{2}-\\Delta)^{-\\alpha}$。这里，$-\\Delta$ 是在光滑、有界、连通域 $\\Omega \\subset \\mathbb{R}^{d}$ 上具有齐次 Neumann 边界条件的负拉普拉斯算子。参数 $\\kappa$ 和 $\\alpha$ 是严格正实数。\n\n设 $\\{e_{j}\\}_{j=0}^{\\infty}$ 是 $-\\Delta$ 在 $L^{2}(\\Omega)$ 中的完备正交本征函数基，其对应的本征值为 $0=\\lambda_{0}\\leq \\lambda_{1}\\leq \\lambda_{2}\\leq \\cdots$。\n问题陈述，对于任何 $s \\in \\mathbb{R}$，算子 $(\\kappa^{2}-\\Delta)^{s}$ 是通过其对本征函数的作用来定义的：\n$$\n(\\kappa^{2}-\\Delta)^{s} e_{j} = (\\kappa^{2}+\\lambda_{j})^{s} e_{j}\n$$\n协方差算子给定为 $C = (\\kappa^{2}-\\Delta)^{-\\alpha}$。它对本征函数的作用是：\n$$\nC e_{j} = (\\kappa^{2}+\\lambda_{j})^{-\\alpha} e_{j}\n$$\n根据问题的定义，我们记作 $\\mathcal{H}_{CM}$ 的 Cameron–Martin 空间是算子 $C^{1/2}$ 的值域。使用相同的泛函演算，算子 $C^{1/2}$ 由下式给出：\n$$\nC^{1/2} = \\left( (\\kappa^{2}-\\Delta)^{-\\alpha} \\right)^{1/2} = (\\kappa^{2}-\\Delta)^{-\\alpha/2}\n$$\n$C^{1/2}$ 对本征函数的作用是：\n$$\nC^{1/2} e_{j} = (\\kappa^{2}+\\lambda_{j})^{-\\alpha/2} e_{j}\n$$\n一个元素 $u \\in L^{2}(\\Omega)$ 属于 Cameron–Martin 空间 $\\mathcal{H}_{CM}$ 当且仅当它在 $C^{1/2}$ 的值域中。这意味着必须存在某个元素 $v \\in L^{2}(\\Omega)$ 使得 $u = C^{1/2}v$。\n\n让我们在特征基 $\\{e_{j}\\}$ 中展开 $u$ 和 $v$：\n$$\nu = \\sum_{j=0}^{\\infty} u_{j} e_{j}, \\quad \\text{其中 } u_{j} = \\langle u, e_{j} \\rangle_{L^{2}(\\Omega)}\n$$\n$$\nv = \\sum_{j=0}^{\\infty} v_{j} e_{j}, \\quad \\text{其中 } v_{j} = \\langle v, e_{j} \\rangle_{L^{2}(\\Omega)}\n$$\n将算子 $C^{1/2}$ 应用于 $v$ 得到：\n$$\nu = C^{1/2}v = C^{1/2}\\left(\\sum_{j=0}^{\\infty} v_{j} e_{j}\\right) = \\sum_{j=0}^{\\infty} v_{j} \\left(C^{1/2}e_{j}\\right) = \\sum_{j=0}^{\\infty} v_{j} (\\kappa^{2}+\\lambda_{j})^{-\\alpha/2} e_{j}\n$$\n通过比较 $u$ 的展开系数，我们找到了系数 $u_{j}$ 和 $v_{j}$ 之间的关系：\n$$\nu_{j} = v_{j} (\\kappa^{2}+\\lambda_{j})^{-\\alpha/2}\n$$\n这意味着对于给定的 $u$，原象 $v$ 的系数是 $v_{j} = u_{j} (\\kappa^{2}+\\lambda_{j})^{\\alpha/2}$。为了使 $u$ 在 $\\mathcal{H}_{CM}$ 中，对应的 $v$ 必须是 $L^{2}(\\Omega)$ 的一个元素。一个函数在 $L^{2}(\\Omega)$ 中当且仅当其傅里叶系数的平方和是有限的。因此，我们必须有 $\\|v\\|_{L^{2}(\\Omega)}^{2}  \\infty$，其中：\n$$\n\\|v\\|_{L^{2}(\\Omega)}^{2} = \\sum_{j=0}^{\\infty} v_{j}^{2} = \\sum_{j=0}^{\\infty} \\left(u_{j} (\\kappa^{2}+\\lambda_{j})^{\\alpha/2}\\right)^{2} = \\sum_{j=0}^{\\infty} u_{j}^{2} (\\kappa^{2}+\\lambda_{j})^{\\alpha}\n$$\n这个条件刻画了构成 Cameron–Martin 空间 $\\mathcal{H}_{CM}$ 的元素 $u$。\n\n问题还规定 Cameron–Martin 空间赋有内积 $\\langle u_1, u_2 \\rangle_{\\mathcal{H}_{CM}} = \\langle C^{-1/2}u_1, C^{-1/2}u_2 \\rangle_{L^{2}(\\Omega)}$。对于任何 $u \\in \\mathcal{H}_{CM}$，我们有 $u = C^{1/2}v$ 对于某个 $v \\in L^2(\\Omega)$，这意味着 $v = C^{-1/2}u$。那么 $u$ 的 Cameron–Martin 范数的平方是：\n$$\n\\|u\\|_{\\mathcal{H}_{CM}}^{2} = \\langle u, u \\rangle_{\\mathcal{H}_{CM}} = \\langle C^{-1/2}u, C^{-1/2}u \\rangle_{L^{2}(\\Omega)} = \\|C^{-1/2}u\\|_{L^{2}(\\Omega)}^{2} = \\|v\\|_{L^{2}(\\Omega)}^{2}\n$$\n使用我们之前推导的关于 $u$ 的系数的 $\\|v\\|_{L^{2}(\\Omega)}^{2}$ 表达式，我们得到了 Cameron–Martin 范数平方的显式形式：\n$$\n\\|u\\|_{\\mathcal{H}_{CM}}^{2} = \\sum_{j=0}^{\\infty} u_{j}^{2} (\\kappa^{2}+\\lambda_{j})^{\\alpha}\n$$\n这个空间等价于 Sobolev 空间 $H^{\\alpha}(\\Omega)$（也称为 Bessel 位势空间）。使用 Neumann 本征对对 $H^{\\alpha}(\\Omega)$ 上范数的一个标准刻画是：\n$$\n\\|u\\|_{H^{\\alpha}(\\Omega)}^{2} = \\sum_{j=0}^{\\infty} u_{j}^{2} (1+\\lambda_{j})^{\\alpha}\n$$\n由于 $\\kappa0$ 和 $\\lambda_j \\ge 0$，存在正常数 $c_{1}$ 和 $c_{2}$ 使得对于所有 $j \\geq 0$ 都有 $c_{1}(1+\\lambda_{j}) \\leq (\\kappa^{2}+\\lambda_{j}) \\leq c_{2}(1+\\lambda_{j})$。例如，可以选择 $c_{1} = \\min(1, \\kappa^{2})$ 和 $c_{2} = \\max(1, \\kappa^{2})$。这意味着范数 $\\|\\cdot\\|_{\\mathcal{H}_{CM}}$ 等价于 $H^{\\alpha}(\\Omega)$ 上的标准范数。因此，Cameron–Martin 空间，作为一个函数集合，与 Sobolev 空间 $H^{\\alpha}(\\Omega)$ 是相同的。推导出的表达式是这个空间上的范数平方，由 $\\kappa$ 和 $\\alpha$ 参数化。\n\n最终答案必须是 Cameron–Martin 范数平方的解析表达式。",
            "answer": "$$\n\\boxed{\\sum_{j=0}^{\\infty} (\\kappa^{2} + \\lambda_{j})^{\\alpha} u_{j}^{2}}\n$$"
        },
        {
            "introduction": "函数空间先验的理论优雅性可能会因不正确的数值实现而丧失。这个练习提供了一个至关重要的反例，展示了噪声模型的不当缩放如何破坏后验的离散化不变性，导致结果错误地依赖于网格分辨率。它突出了质量矩阵在连接连续和离散世界中的关键作用。",
            "id": "3377260",
            "problem": "考虑一维空间域 $[0,1]$，并将其均匀划分为 $n$ 个长度相等 $h = \\frac{1}{n}$ 的不重叠单元。令 $\\{\\psi_{j}\\}_{j=1}^{n}$表示分段常数基函数，其中 $\\psi_{j}(x)$ 在单元 $j$ 上为 1，在其他地方为 0。在此基下，有限维质量矩阵为 $M_{h} = h I_{n}$，其中 $I_{n}$ 是 $n \\times n$ 的单位矩阵。\n\n为逐单元常数场 $u_{h}(x) = \\sum_{j=1}^{n} c_{j} \\psi_{j}(x)$ 采用零阶随机偏微分方程(SPDE)高斯先验，方法是对系数向量 $c \\in \\mathbb{R}^{n}$ 施加高斯先验 $c \\sim \\mathcal{N}(0, Q_{h}^{-1})$，其先验精度为 $Q_{h} = \\kappa^{2} M_{h}$，其中 $\\kappa > 0$ 是固定的，且该先验在由 $M_{h}$ 导出的 $L^{2}$ 度量下是离散化不变的。\n\n假设在 $L^{2}$ 中有一个伽辽金投影观测模型：观测数据 $y_{h} \\in \\mathbb{R}^{n}$ 由下式给出\n$$\ny_{h} = H_{h} c + \\varepsilon_{h}, \\quad H_{h} = M_{h},\n$$\n并且观测噪声 $\\varepsilon_{h}$ 是振幅为 $\\sigma > 0$ 的 $L^{2}$ 白噪声的投影。在正确的离散化中，这会产生离散噪声协方差\n$$\n\\Gamma_{h} = \\sigma^{2} M_{h}.\n$$\n假设潜在真值为空间常数函数 $u^{\\star}(x) = 1$。那么其相对于 $\\{\\psi_{j}\\}$ 的系数向量是 $c^{\\star} = \\mathbf{1}$ (全为 1 的向量)，无噪声数据为 $y_{h} = M_{h} c^{\\star} = h \\mathbf{1}$。\n\n通过高斯线性反演定义后验均值为\n$$\nm_{h}(\\Gamma) = \\left(Q_{h} + H_{h}^{\\top} \\Gamma^{-1} H_{h}\\right)^{-1} H_{h}^{\\top} \\Gamma^{-1} y_{h}.\n$$\n\n考虑两种情况：\n- 不正确的噪声缩放：使用 $\\Gamma_{h}^{\\mathrm{wrong}} = \\sigma^{2} I_{n}$。\n- 正确的噪声缩放：使用 $\\Gamma_{h}^{\\mathrm{corr}} = \\sigma^{2} M_{h}$。\n\n从线性反问题中高斯条件化的基本原理和上述定义出发，推导 $m_{h}(\\Gamma_{h}^{\\mathrm{wrong}})$ 和 $m_{h}(\\Gamma_{h}^{\\mathrm{corr}})$ 的闭式表达式，并确定当网格细化时($h \\to 0$)后验均值场的极限。为具体起见，报告在每种情况下任意固定点 $x \\in (0,1)$ 处的后验均值，由于采用了分段常数参数化，该值等于相应的逐单元系数。\n\n你的最终答案必须是一个单行矩阵，其第一个条目是当 $h \\to 0$ 时，在任意 $x \\in (0,1)$ 处不正确缩放的后验均值的极限，其第二个条目是在任意 $x \\in (0,1)$ 处正确缩放的后验均值（该值与 $h$ 无关）。最终表达式不需要四舍五入，也不涉及单位。",
            "solution": "该问题要求在关于观测噪声协方差结构的两种不同假设下，推导高斯随机场的后验均值，并分析当离散化网格细化时该均值的行为。\n\n线性高斯反问题的贝叶斯后验均值由以下公式给出：\n$$\nm_{h}(\\Gamma) = \\left(Q_{h} + H_{h}^{\\top} \\Gamma^{-1} H_{h}\\right)^{-1} H_{h}^{\\top} \\Gamma^{-1} y_{h}\n$$\n该问题提供了以下与域 $[0,1]$ 上大小为 $h = \\frac{1}{n}$ 的均匀网格上的分段常数离散化相对应的有限维表示：\n- 先验精度矩阵：$Q_{h} = \\kappa^{2} M_{h} = \\kappa^{2} h I_{n}$\n- 观测算子：$H_{h} = M_{h} = h I_{n}$\n- 无噪声数据 (对于真值场 $u^{\\star}(x)=1$)：$y_{h} = M_{h} c^{\\star} = h \\mathbf{1}$，其中 $\\mathbf{1}$ 是全为 1 的 $n$ 维向量。\n\n我们将分析噪声协方差矩阵 $\\Gamma$ 的两种指定情况。\n\n### 情况 1：不正确的噪声缩放\n\n在这种情况下，假定噪声协方差为 $\\Gamma_{h}^{\\mathrm{wrong}} = \\sigma^{2} I_{n}$。我们将此矩阵以及其他给定矩阵代入后验均值公式。\n\n首先，我们计算噪声协方差的逆：\n$$\n\\left(\\Gamma_{h}^{\\mathrm{wrong}}\\right)^{-1} = \\left(\\sigma^{2} I_{n}\\right)^{-1} = \\frac{1}{\\sigma^{2}} I_{n}\n$$\n接下来，我们计算项 $H_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{wrong}}\\right)^{-1} H_{h}$，它代表了数据的精度：\n$$\nH_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{wrong}}\\right)^{-1} H_{h} = (h I_{n})^{\\top} \\left(\\frac{1}{\\sigma^{2}} I_{n}\\right) (h I_{n}) = h^{2} \\frac{1}{\\sigma^{2}} I_{n}^{\\top} I_{n} I_{n} = \\frac{h^{2}}{\\sigma^{2}} I_{n}\n$$\n总后验精度矩阵 $\\Lambda_{h}^{\\mathrm{wrong}}$ 是先验精度和数据精度的和：\n$$\n\\Lambda_{h}^{\\mathrm{wrong}} = Q_{h} + H_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{wrong}}\\right)^{-1} H_{h} = \\kappa^{2} h I_{n} + \\frac{h^{2}}{\\sigma^{2}} I_{n} = \\left(\\kappa^{2} h + \\frac{h^{2}}{\\sigma^{2}}\\right) I_{n}\n$$\n后验精度的逆是：\n$$\n\\left(\\Lambda_{h}^{\\mathrm{wrong}}\\right)^{-1} = \\frac{1}{\\kappa^{2} h + \\frac{h^{2}}{\\sigma^{2}}} I_{n}\n$$\n接下来，我们计算项 $H_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{wrong}}\\right)^{-1} y_{h}$：\n$$\nH_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{wrong}}\\right)^{-1} y_{h} = (h I_{n})^{\\top} \\left(\\frac{1}{\\sigma^{2}} I_{n}\\right) (h \\mathbf{1}) = \\frac{h^{2}}{\\sigma^{2}} I_{n} \\mathbf{1} = \\frac{h^{2}}{\\sigma^{2}} \\mathbf{1}\n$$\n最后，我们组装后验均值向量 $m_{h}(\\Gamma_{h}^{\\mathrm{wrong}})$：\n$$\nm_{h}(\\Gamma_{h}^{\\mathrm{wrong}}) = \\left(\\Lambda_{h}^{\\mathrm{wrong}}\\right)^{-1} \\left(H_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{wrong}}\\right)^{-1} y_{h}\\right) = \\left(\\frac{1}{\\kappa^{2} h + \\frac{h^{2}}{\\sigma^{2}}} I_{n}\\right) \\left(\\frac{h^{2}}{\\sigma^{2}} \\mathbf{1}\\right)\n$$\n$$\nm_{h}(\\Gamma_{h}^{\\mathrm{wrong}}) = \\frac{\\frac{h^{2}}{\\sigma^{2}}}{\\kappa^{2} h + \\frac{h^{2}}{\\sigma^{2}}} \\mathbf{1} = \\frac{h^{2}}{\\kappa^{2} h \\sigma^{2} + h^{2}} \\mathbf{1} = \\frac{h}{\\kappa^{2} \\sigma^{2} + h} \\mathbf{1}\n$$\n由于基函数是分段常数的，后验均值场在任意点 $x \\in (0,1)$ 的值由相应单元中的系数值给出。该值为 $\\frac{h}{\\kappa^{2} \\sigma^{2} + h}$。\n\n为了确定网格细化时的行为，我们取 $h \\to 0$ 的极限：\n$$\n\\lim_{h \\to 0} \\frac{h}{\\kappa^{2} \\sigma^{2} + h} = \\frac{0}{\\kappa^{2} \\sigma^{2} + 0} = 0\n$$\n在不正确的噪声缩放情况下，随着离散化变细，后验均值坍缩到先验均值($0$)。\n\n### 情况 2：正确的噪声缩放\n\n在这种情况下，噪声协方差为 $\\Gamma_{h}^{\\mathrm{corr}} = \\sigma^{2} M_{h} = \\sigma^{2} h I_{n}$。这对应于 $L^{2}$ 白噪声的一种离散化不变表示。\n\n首先，我们求噪声协方差的逆：\n$$\n\\left(\\Gamma_{h}^{\\mathrm{corr}}\\right)^{-1} = \\left(\\sigma^{2} h I_{n}\\right)^{-1} = \\frac{1}{\\sigma^{2} h} I_{n}\n$$\n接下来，我们计算数据精度项 $H_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{corr}}\\right)^{-1} H_{h}$：\n$$\nH_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{corr}}\\right)^{-1} H_{h} = (h I_{n})^{\\top} \\left(\\frac{1}{\\sigma^{2} h} I_{n}\\right) (h I_{n}) = h \\left(\\frac{1}{\\sigma^{2} h}\\right) h I_{n} = \\frac{h}{\\sigma^{2}} I_{n}\n$$\n后验精度矩阵 $\\Lambda_{h}^{\\mathrm{corr}}$ 为：\n$$\n\\Lambda_{h}^{\\mathrm{corr}} = Q_{h} + H_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{corr}}\\right)^{-1} H_{h} = \\kappa^{2} h I_{n} + \\frac{h}{\\sigma^{2}} I_{n} = h \\left(\\kappa^{2} + \\frac{1}{\\sigma^{2}}\\right) I_{n}\n$$\n后验精度的逆是：\n$$\n\\left(\\Lambda_{h}^{\\mathrm{corr}}\\right)^{-1} = \\frac{1}{h \\left(\\kappa^{2} + \\frac{1}{\\sigma^{2}}\\right)} I_{n}\n$$\n接下来，我们计算项 $H_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{corr}}\\right)^{-1} y_{h}$：\n$$\nH_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{corr}}\\right)^{-1} y_{h} = (h I_{n})^{\\top} \\left(\\frac{1}{\\sigma^{2} h} I_{n}\\right) (h \\mathbf{1}) = h \\left(\\frac{1}{\\sigma^{2} h}\\right) h \\mathbf{1} = \\frac{h}{\\sigma^{2}} \\mathbf{1}\n$$\n最后，我们组装后验均值向量 $m_{h}(\\Gamma_{h}^{\\mathrm{corr}})$：\n$$\nm_{h}(\\Gamma_{h}^{\\mathrm{corr}}) = \\left(\\Lambda_{h}^{\\mathrm{corr}}\\right)^{-1} \\left(H_{h}^{\\top} \\left(\\Gamma_{h}^{\\mathrm{corr}}\\right)^{-1} y_{h}\\right) = \\left(\\frac{1}{h \\left(\\kappa^{2} + \\frac{1}{\\sigma^{2}}\\right)} I_{n}\\right) \\left(\\frac{h}{\\sigma^{2}} \\mathbf{1}\\right)\n$$\n$$\nm_{h}(\\Gamma_{h}^{\\mathrm{corr}}) = \\frac{\\frac{h}{\\sigma^{2}}}{h \\left(\\kappa^{2} + \\frac{1}{\\sigma^{2}}\\right)} \\mathbf{1} = \\frac{\\frac{1}{\\sigma^{2}}}{\\kappa^{2} + \\frac{1}{\\sigma^{2}}} \\mathbf{1} = \\frac{1}{1 + \\kappa^{2} \\sigma^{2}} \\mathbf{1}\n$$\n后验均值场在任意点 $x \\in (0,1)$ 的值是常数系数 $\\frac{1}{1 + \\kappa^{2} \\sigma^{2}}$。\n该表达式与网格尺寸 $h$ 无关。因此，其当 $h \\to 0$ 时的极限就是其本身。这表明，正确缩放的（离散化不变的）先验和似然函数在连续极限下会得到一个有明确定义的后验。得到的后验均值 $\\frac{1}{1+\\kappa^{2}\\sigma^{2}}$ 是先验均值($0$)和数据所蕴含的值($1$)的精度加权平均。\n\n### 结果总结\n- 在 $x \\in (0,1)$ 处不正确缩放的后验均值：$\\lim_{h \\to 0} \\frac{h}{\\kappa^{2} \\sigma^{2} + h} = 0$。\n- 在 $x \\in (0,1)$ 处正确缩放的后验均值：$\\frac{1}{1 + \\kappa^{2} \\sigma^{2}}$，该值与 $h$ 无关。\n\n最终答案是包含这两个值的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{1}{1 + \\kappa^{2} \\sigma^{2}}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}