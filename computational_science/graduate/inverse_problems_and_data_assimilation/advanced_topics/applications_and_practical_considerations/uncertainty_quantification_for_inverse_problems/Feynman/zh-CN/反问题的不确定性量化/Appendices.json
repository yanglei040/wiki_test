{
    "hands_on_practices": [
        {
            "introduction": "本节的第一个实践是贝叶斯反问题中的一个基本练习。我们将从一个线性高斯模型入手，其中先验分布和观测噪声都遵循高斯分布。通过这个具体的计算任务，您将推导并计算后验均值和协方差，从而亲身体验数据是如何更新我们对未知参数的认识，并量化地减少不确定性。",
            "id": "3429478",
            "problem": "考虑一个线性反问题，其中未知参数向量 $x \\in \\mathbb{R}^{2}$ 和观测值 $y \\in \\mathbb{R}^{2}$ 由正向模型 $y = A x + \\eta$ 描述，$\\eta$ 是与 $x$ 无关的零均值噪声。假设 $x$ 服从高斯先验 $x \\sim \\mathcal{N}(m_{0}, C_{0})$，观测噪声 $\\eta$ 服从高斯分布 $\\eta \\sim \\mathcal{N}(0, \\Gamma)$。取以下具体数值\n$$\nA = \\begin{pmatrix}\n2  1 \\\\\n1  3\n\\end{pmatrix}, \\quad\nC_{0} = \\mathrm{diag}(1, 4), \\quad\n\\Gamma = 0.25\\, I_{2}, \\quad\nm_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\quad\ny = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix},\n$$\n其中 $I_{2}$ 表示 $2 \\times 2$ 的单位矩阵。\n\n从贝叶斯法则和多元高斯密度的定义出发，推导在给定 $y$ 的条件下 $x$ 的后验分布，并由此得到该线性高斯反问题的后验均值向量 $m^{y}$ 和后验协方差矩阵 $C^{y}$。对给定的数据，数值计算 $m^{y}$ 和 $C^{y}$。然后，通过比较先验和后验协方差，解释不确定性在哪些方向上减小得最多，并阐明测量算子 $A$ 和噪声统计特性是如何影响这些方向的。\n\n以精确形式（不进行四舍五入）表示 $m^{y}$ 和 $C^{y}$ 的最终数值。最终答案必须是一个单行矩阵，其中按顺序包含 $m^{y}$ 的两个元素，然后是按行逐一列出的 $C^{y}$ 的四个元素。",
            "solution": "根据贝叶斯法则，后验概率分布 $p(x|y)$ 正比于似然 $p(y|x)$ 和先验 $p(x)$ 的乘积。对于该线性高斯模型，先验和似然均为高斯分布，因此后验分布也为高斯分布 $x|y \\sim \\mathcal{N}(m^y, C^y)$。其概率密度函数的指数部分与以下项成正比：\n$$\nJ(x) = (y - Ax)^T \\Gamma^{-1} (y - Ax) + (x - m_0)^T C_0^{-1} (x - m_0)\n$$\n通过对 $x$ 展开并配方，我们可以将该二次型与标准高斯分布的指数项 $(x-m^y)^T(C^y)^{-1}(x-m^y)$ 进行比较，从而得到后验协方差 $C^y$ 和后验均值 $m^y$ 的解析表达式：\n$$\n\\begin{align*}\nC^y = (C_0^{-1} + A^T \\Gamma^{-1} A)^{-1} \\\\\nm^y = C^y (C_0^{-1} m_0 + A^T \\Gamma^{-1} y)\n\\end{align*}\n接下来，我们将给定的数值代入这些公式进行计算。\n\n首先计算后验协方差 $C^y$。根据给定值，$C_0^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  1/4 \\end{pmatrix}$ 且 $\\Gamma^{-1} = 4 I_2 = \\begin{pmatrix} 4  0 \\\\ 0  4 \\end{pmatrix}$。\n数据贡献的精度项为：\n$A^T \\Gamma^{-1} A = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} 4  0 \\\\ 0  4 \\end{pmatrix} \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix} = \\begin{pmatrix} 20  20 \\\\ 20  40 \\end{pmatrix}$。\n后验精度矩阵（协方差的逆）为：\n$(C^y)^{-1} = C_0^{-1} + A^T \\Gamma^{-1} A = \\begin{pmatrix} 1  0 \\\\ 0  1/4 \\end{pmatrix} + \\begin{pmatrix} 20  20 \\\\ 20  40 \\end{pmatrix} = \\begin{pmatrix} 21  20 \\\\ 20  161/4 \\end{pmatrix}$。\n求该矩阵的逆得到后验协方差 $C^y$：\n$\\det((C^y)^{-1}) = 21 \\times \\frac{161}{4} - 400 = \\frac{1781}{4}$。\n$C^y = \\frac{4}{1781} \\begin{pmatrix} 161/4  -20 \\\\ -20  21 \\end{pmatrix} = \\frac{1}{1781} \\begin{pmatrix} 161  -80 \\\\ -80  84 \\end{pmatrix}$。\n\n然后计算后验均值 $m^y$。由于先验均值 $m_0 = 0$，公式简化为 $m^y = C^y (A^T \\Gamma^{-1} y)$。\n$A^T \\Gamma^{-1} y = \\begin{pmatrix} 8  4 \\\\ 4  12 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ -8 \\end{pmatrix}$。\n$m^y = \\frac{1}{1781} \\begin{pmatrix} 161  -80 \\\\ -80  84 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ -8 \\end{pmatrix} = \\frac{1}{1781} \\begin{pmatrix} 644 + 640 \\\\ -320 - 672 \\end{pmatrix} = \\frac{1}{1781} \\begin{pmatrix} 1284 \\\\ -992 \\end{pmatrix}$。\n\n最后，比较先验和后验协方差。先验方差为 $\\text{Var}(x_1)=1$ 和 $\\text{Var}(x_2)=4$。后验方差为 $\\text{Var}(x_1|y) \\approx 0.09$ 和 $\\text{Var}(x_2|y) \\approx 0.047$。两个方向上的不确定性都显著减小，尤其是 $x_2$ 的不确定性。这是因为正向算子 $A$ 的第二列范数（$\\sqrt{10}$）大于第一列（$\\sqrt{5}$），表明观测对 $x_2$ 更敏感，从而提供了更强的约束。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{1284}{1781}  -\\frac{992}{1781}  \\frac{161}{1781}  -\\frac{80}{1781}  -\\frac{80}{1781}  \\frac{84}{1781} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "然而，反问题很少像理想化的线性高斯情况那样简单。这个实践探讨了一个核心挑战：正向模型的非唯一可识别性（non-identifiability）。通过一个简洁的非线性例子，我们将揭示这种结构性缺陷如何导致非高斯、多峰的后验分布，并探讨这与不适定问题中的解的唯一性和稳定性失效有何关联。",
            "id": "3382702",
            "problem": "考虑逆问题和数据同化中正向和反向不确定性量化范式下的一个标量贝叶斯逆问题。设正向映射为 $G(\\theta) = \\theta^{2}$，参数 $\\theta \\in \\mathbb{R}$。通过加性高斯噪声模型 $y = G(\\theta) + \\varepsilon$ 获得单个带噪观测 $y \\in \\mathbb{R}$，其中 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^{2})$ 且 $\\sigma  0$ 为已知。参数的先验分布为高斯分布 $\\theta \\sim \\mathcal{N}(0, \\tau^{2})$，其中 $\\tau  0$ 为已知。所有量均为标量。在整个过程中，使用贝叶斯法则和基于第一性原理的有原则的渐近近似方法；在可辨识性失效的地方，不要假设其成立。\n\n这种设置表现出不可辨识性，因为 $G(\\theta) = G(-\\theta)$，这可能导致不适定性，表现为后验多峰性和较大的后验方差。从第一性原理（贝叶斯法则、高斯分布的性质以及 Jacques Hadamard 意义下的适定性定义）出发，在后验分布为双峰的情况下，推导后验方差 $\\mathrm{Var}[\\theta \\mid y]$ 的一个显式的领头阶解析近似。在推导表达式时，请用 $y$、$\\sigma$ 和 $\\tau$ 来说明出现双峰性的条件，并讨论这种不可辨识性的稳定性影响（解的存在性、唯一性和对数据的连续依赖性）。\n\n你的最终答案必须是 $\\mathrm{Var}[\\theta \\mid y]$ 的领头阶近似的单个闭式解析表达式，该表达式是 $y$、$\\sigma$ 和 $\\tau$ 的函数。无需四舍五入，也不涉及单位。",
            "solution": "首先，我们使用贝叶斯法则构建后验概率密度函数 (PDF) $p(\\theta \\mid y)$：\n$$\np(\\theta \\mid y) \\propto p(y \\mid \\theta) p(\\theta)\n$$\n似然函数 $p(y \\mid \\theta)$ 源自噪声模型，给定一个 $\\theta$ 值，$y$ 服从 $\\mathcal{N}(\\theta^{2}, \\sigma^{2})$ 分布。先验概率密度函数 $p(\\theta)$ 是 $\\mathcal{N}(0, \\tau^{2})$。结合这两者，未归一化的后验概率密度函数为：\n$$\np(\\theta \\mid y) \\propto \\exp\\left( -\\left[ \\frac{(y - \\theta^{2})^{2}}{2\\sigma^{2}} + \\frac{\\theta^{2}}{2\\tau^{2}} \\right] \\right)\n$$\n为了找到后验分布的众数，我们找到负对数后验 $\\Phi(\\theta) = \\frac{(y - \\theta^{2})^{2}}{2\\sigma^{2}} + \\frac{\\theta^{2}}{2\\tau^{2}}$ 的极小值。通过将其一阶导数设为零来找到驻点：\n$$\n\\frac{d\\Phi}{d\\theta} = \\theta \\left( \\frac{2\\theta^{2} - 2y}{\\sigma^{2}} + \\frac{1}{\\tau^{2}} \\right) = 0\n$$\n解为 $\\theta_{0} = 0$ 以及 $\\theta_{\\pm} = \\pm \\sqrt{y - \\frac{\\sigma^{2}}{2\\tau^{2}}}$（仅当 $y  \\frac{\\sigma^{2}}{2\\tau^{2}}$ 时存在实数解）。\n\n为了确定这些点的性质，我们检查 $\\Phi(\\theta)$ 的二阶导数：\n$$\n\\frac{d^{2}\\Phi}{d\\theta^{2}} = \\frac{6\\theta^{2}}{\\sigma^{2}} - \\frac{2y}{\\sigma^{2}} + \\frac{1}{\\tau^{2}}\n$$\n在 $\\theta = 0$ 处，$\\frac{d^{2}\\Phi}{d\\theta^{2}} = \\frac{1}{\\tau^{2}} - \\frac{2y}{\\sigma^{2}}$。要使 $\\theta=0$ 成为一个众数（局部极大值），二阶导数需为正，即 $y  \\frac{\\sigma^{2}}{2\\tau^{2}}$。在这种情况下，后验是单峰的。如果 $y  \\frac{\\sigma^{2}}{2\\tau^{2}}$，二阶导数为负，$\\theta=0$ 成为一个反众数（局部极小值）。\n在 $\\theta_{\\pm}$ 处，二阶导数为 $\\left.\\frac{d^{2}\\Phi}{d\\theta^{2}}\\right|_{\\theta_{\\pm}} = 2\\left(\\frac{2y}{\\sigma^{2}} - \\frac{1}{\\tau^{2}}\\right)$。由于 $\\theta_{\\pm}$ 仅在 $y  \\frac{\\sigma^{2}}{2\\tau^{2}}$ 时存在，该二阶导数恒为正。这证实了当 $y  \\frac{\\sigma^{2}}{2\\tau^{2}}$ 时，后验分布是双峰的，在 $\\theta_{\\pm}$ 处有两个众数。\n\n在双峰情况下，我们将后验近似为两个对称高斯分布的混合：$p(\\theta \\mid y) \\approx \\frac{1}{2} \\mathcal{N}(\\mu_{+}, \\sigma_{L}^{2}) + \\frac{1}{2} \\mathcal{N}(\\mu_{-}, \\sigma_{L}^{2})$。众数位置为 $\\mu_{\\pm} = \\theta_{\\pm}$。每个高斯分量的局部方差 $\\sigma_{L}^{2}$ 是在众数处计算的Hessian矩阵的逆（即二阶导数的倒数）：\n$$\n\\sigma_{L}^{2} = \\left( \\left.\\frac{d^{2}\\Phi}{d\\theta^{2}}\\right|_{\\theta_{\\pm}} \\right)^{-1} = \\left( \\frac{4y\\tau^{2} - 2\\sigma^{2}}{\\sigma^{2}\\tau^{2}} \\right)^{-1} = \\frac{\\sigma^{2}\\tau^{2}}{4y\\tau^{2} - 2\\sigma^{2}}\n$$\n根据全方差定律，高斯混合模型的总方差为 $\\mathrm{Var}[\\theta \\mid y] = \\mathbb{E}[\\mathrm{Var}] + \\mathrm{Var}[\\mathbb{E}]$。由于对称性，$\\mathbb{E}[\\mathbb{E}] = 0$。因此，$\\mathrm{Var}[\\mathbb{E}] = \\mathbb{E}[(\\text{均值})^2] = \\frac{1}{2}\\mu_+^2 + \\frac{1}{2}\\mu_-^2 = \\mu_+^2$。第一项 $\\mathbb{E}[\\mathrm{Var}] = \\sigma_L^2$。\n总后验方差的近似值为：\n$$\n\\mathrm{Var}[\\theta \\mid y] \\approx \\mu_{+}^{2} + \\sigma_{L}^{2} = \\left(y - \\frac{\\sigma^{2}}{2\\tau^{2}}\\right) + \\frac{\\sigma^{2}\\tau^{2}}{4y\\tau^{2} - 2\\sigma^{2}}\n$$\n关于稳定性影响：\n1.  **存在性**：后验分布始终存在。\n2.  **唯一性**：在双峰情况下不成立，存在两个等可能的解（众数）。\n3.  **稳定性**：在临界数据值 $y_{c} = \\frac{\\sigma^{2}}{2\\tau^{2}}$ 附近，稳定性严重失效。当 $y \\to y_{c}^{+}$ 时，局部方差项 $\\sigma_{L}^{2}$ 的分母趋于零，导致方差发散。这表明后验分布对数据的微小扰动极为敏感，是不适定性的一个标志。",
            "answer": "$$\n\\boxed{y - \\frac{\\sigma^{2}}{2\\tau^{2}} + \\frac{\\sigma^{2}\\tau^{2}}{4y\\tau^{2} - 2\\sigma^{2}}}\n$$"
        },
        {
            "introduction": "在处理高维问题时，我们需要有效的计算工具来诊断后验不确定性的复杂结构。这个实践引入了一种关键的计算技术：通过对先验预处理算子进行奇异值分解（SVD）来分析后验分布。这项强大的技术使我们能够识别参数空间中不确定性较大的方向（即“后验脊”），这些方向对应于那些难以被数据有效约束的参数组合。",
            "id": "3429460",
            "problem": "考虑一个线性化贝叶斯逆问题，其参数向量为 $x \\in \\mathbb{R}^n$，线性正演映射为 $G \\in \\mathbb{R}^{m \\times n}$，加性测量噪声为 $\\eta \\in \\mathbb{R}^m$（建模为均值为零、协方差为 $C_n \\in \\mathbb{R}^{m \\times m}$ 的高斯分布），以及 $x$ 上的高斯先验，其均值为零，协方差为 $C_0 \\in \\mathbb{R}^{n \\times n}$。观测数据为 $y \\in \\mathbb{R}^m$，满足 $y = G x + \\eta$。假设 $C_0$ 和 $C_n$ 是对称正定矩阵。目标是通过使用线性化正演映射的奇异函数，分析沿零空间的可识别性，从而刻画后验不确定性脊。\n\n从高斯测度的贝叶斯法则和在参考点的线性化出发，$x$ 的后验分布是高斯分布，其协方差由先验精度 $C_0^{-1}$ 和数据失配曲率 $G^\\top C_n^{-1} G$ 之间的相互作用决定。定义先验预处理的正演算子 $A$ 为\n$$\nA = C_n^{-1/2} \\, G \\, C_0^{1/2},\n$$\n其中 $C_0^{1/2}$ 和 $C_n^{-1/2}$ 分别表示 $C_0$ 的唯一对称正定平方根和 $C_n$ 平方根的逆。设 $A$ 的奇异值分解通过其右奇异向量表示为对称矩阵的特征分解\n$$\nH = A^\\top A = C_0^{1/2} \\, G^\\top \\, C_n^{-1} \\, G \\, C_0^{1/2}.\n$$\n如果 $\\lambda_i$ 是 $H$ 的特征值，对应的标准正交特征向量为 $v_i \\in \\mathbb{R}^n$（即 $A$ 的右奇异向量），那么奇异值为 $s_i = \\sqrt{\\lambda_i}$。在由 $z = C_0^{-1/2} x$ 给出的先验坐标系中，后验协方差沿 $v_i$ 方向的特征值等于\n$$\n\\gamma_i = \\frac{1}{1 + s_i^2}.\n$$\n$s_i$ 较小的方向对应于弱数据信息和较大的后验方差因子 $\\gamma_i$，形成后验脊。精确的零空间方向具有 $s_i = 0$ 并产生 $\\gamma_i = 1$，表明相对于先验没有方差减小。\n\n你的任务是实现一个程序，对于给定的矩阵测试套件 $(G, C_0, C_n)$，计算：\n- 通过 $H = A^\\top A$ 的特征值计算出的 $A$ 的全套奇异值 $s_i$，\n- 沿右奇异向量 $v_i$ 的后验方差因子 $\\gamma_i = 1/(1 + s_i^2)$，\n- 每个方向的二元脊分类，定义为如果 $s_i \\le s_{\\text{thresh}}$ 则 $\\text{ridge}_i = \\text{True}$，否则 $\\text{ridge}_i = \\text{False}$，\n- 数值零空间的维度，定义为 $s_i \\le s_{\\text{zero}}$ 的计数。\n\n使用以下数值阈值：\n- $s_{\\text{thresh}} = 10^{-3}$ 用于脊分类，\n- $s_{\\text{zero}} = 10^{-12}$ 用于零空间维度。\n\n对于每个测试用例，输出一个列表，包含：\n- 整数形式的零空间维度，\n- 按降序排列的奇异值 $s_i$ 列表，每个值四舍五入到8位小数，\n- 按相同顺序排列的后验方差因子 $\\gamma_i$ 列表，每个值四舍五入到8位小数，\n- 按相同顺序排列的布尔类型的脊标志列表。\n\n构建并使用以下测试套件：\n- 测试用例1（秩亏，有明显的零空间）：$m = 2$, $n = 3$, $G = \\begin{bmatrix}1  0  0 \\\\ 0  0  0\\end{bmatrix}$, $C_0 = \\mathrm{diag}(1, 4, 9)$, $C_n = \\mathrm{diag}(0.01, 0.01)$.\n- 测试用例2（处于阈值的边界情况）：$m = 2$, $n = 3$, $G = \\begin{bmatrix}10^{-3}  0  0 \\\\ 0  0  10^{-3}\\end{bmatrix}$, $C_0 = \\mathrm{diag}(1, 1, 1)$, $C_n = \\mathrm{diag}(1, 1)$.\n- 测试用例3（满秩，强可识别）：$m = 3$, $n = 3$, $G = \\mathrm{diag}(5, 2, 1)$, $C_0 = I_{3 \\times 3}$, $C_n = \\mathrm{diag}(0.04, 0.04, 0.04)$.\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[ \\text{result1}, \\text{result2}, \\text{result3} ]$），其中每个 $\\text{result}$ 是如上所述的用于一个测试用例的列表。不涉及物理单位或角度单位。数值答案必须是所述的浮点数或整数，列表必须由这些类型或布尔值组成。",
            "solution": "该问题的求解需要根据给定的贝叶斯逆问题框架，对每个测试用例执行一系列矩阵计算来分析后验不确定性。算法遵循以下步骤：\n1.  **构建预处理海森矩阵**：根据定义 $H = C_0^{1/2} \\, G^\\top \\, C_n^{-1} \\, G \\, C_0^{1/2}$，计算该矩阵。其中 $C_0^{1/2}$ 是先验协方差 $C_0$ 的对称正定平方根，$C_n^{-1}$ 是噪声协方差 $C_n$ 的逆。\n2.  **特征值分解**：由于 $H$ 是对称正定矩阵，对其进行特征值分解，得到特征值 $\\lambda_i$。这些特征值与先验预处理算子 $A$ 的奇异值 $s_i$ 的平方相等，即 $\\lambda_i = s_i^2$。为保证计算稳定性，将数值计算得到的任何微小负特征值视为零。\n3.  **计算奇异值和方差因子**：通过取特征值的平方根得到奇异值 $s_i = \\sqrt{\\lambda_i}$，并按降序排列。随后，计算后验方差因子 $\\gamma_i = 1/(1 + s_i^2)$，它量化了数据在每个主方向上对方差的缩减程度。\n4.  **不确定性结构分析**：\n    *   **零空间维度**：统计满足 $s_i \\le s_{\\text{zero}} = 10^{-12}$ 的奇异值的数量，这代表数据完全无法提供信息的方向数量。\n    *   **后验脊**：根据阈值 $s_{\\text{thresh}} = 10^{-3}$ 对每个方向进行分类。如果 $s_i \\le s_{\\text{thresh}}$，则该方向被识别为“脊”（ridge），意味着数据约束很弱，后验不确定性较大。\n5.  **格式化输出**：将计算出的零空间维度、奇异值列表、方差因子列表和脊标志列表整理成指定的格式。\n\n对提供的三个测试用例实施此算法，即可得到最终结果。",
            "answer": "[[2, [10.0, 0.0, 0.0], [0.00990099, 1.0, 1.0], [False, True, True]],[1, [0.001, 0.001, 0.0], [0.999999, 0.999999, 1.0], [True, True, True]],[0, [25.0, 10.0, 5.0], [0.00159744, 0.00990099, 0.03846154], [False, False, False]]]"
        }
    ]
}