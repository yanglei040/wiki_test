{
    "hands_on_practices": [
        {
            "introduction": "任何大气输送模型的优劣都取决于其对物理世界的表述能力。这种表述的一个关键部分在于模型的边界，即大气与地球表面及外层相互作用的地方。本练习将探讨如何将地表排放、干沉降和大气交换等物理过程转化为数学上合理的边界条件。正确构建这些条件是确保模型质量守恒并准确模拟示踪物输送的基础，这也是任何可靠反演分析的先决条件 。",
            "id": "3365808",
            "problem": "考虑一种被动反应性大气示踪剂，其浓度场 $c(\\boldsymbol{x},t)$ 在一个代表对流层（位于地球表面 $\\Gamma_{s}$ 和模式大气层顶 $\\Gamma_{t}$ 之间）的三维域 $\\Omega \\subset \\mathbb{R}^{3}$ 上演变，其侧边界为 $\\Gamma_{\\ell}$，因此 $\\partial \\Omega = \\Gamma_{s} \\cup \\Gamma_{t} \\cup \\Gamma_{\\ell}$。该示踪剂由已知风场 $\\boldsymbol{u}(\\boldsymbol{x},t)$ 输送，并通过由对称正定扩散张量 $\\mathbf{K}(\\boldsymbol{x},t)$ 建模的湍流扩散进行混合。浓度满足平流-扩散-反应偏微分方程 (PDE)\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\left( \\boldsymbol{u}\\, c \\right) \\;=\\; \\nabla \\cdot \\left( \\mathbf{K} \\nabla c \\right) \\;-\\; \\lambda(\\boldsymbol{x},t)\\, c \\;+\\; q_{v}(\\boldsymbol{x},t)\\,, \\quad \\text{在 } \\Omega \\text{ 中},\n$$\n其中 $\\lambda(\\boldsymbol{x},t) \\ge 0$ 是一阶损失率，$q_{v}(\\boldsymbol{x},t)$ 是已知的体源项。令 $\\boldsymbol{n}$ 表示 $\\partial \\Omega$ 上的单位外法向量。在表面 $\\Gamma_{s}$，示踪剂通过以下方式与地面相互作用：\n- 一个给定的地表排放通量 $E(\\boldsymbol{x},t)$，单位为质量/面积/时间，\n- 通过沉降速度 $v_{d}(\\boldsymbol{x},t) \\ge 0$（单位为长度/时间）参数化的干沉降。\n在顶部 $\\Gamma_{t}$，对流层与一个已知浓度为 $c_{a}(\\boldsymbol{x},t)$ 的外部储库通过湍流夹带进行交换，其特征是传输速度 $k_{e}(\\boldsymbol{x},t) \\ge 0$（单位为长度/时间）。平流边界条件需在 $\\boldsymbol{n}\\cdot \\boldsymbol{u} < 0$ 的入流子集上指定。假设表面对解析的平流是不可渗透的，因此在 $\\Gamma_{s}$ 上 $\\boldsymbol{n}\\cdot \\boldsymbol{u} = 0$。考虑全局质量趋势\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c\\, \\mathrm{d}\\Omega\\,,\n$$\n该趋势必须由质量守恒和散度定理得出，并包括穿过 $\\partial \\Omega$ 的显式边界通量项。\n\n哪个选项给出了一组在 $\\Gamma_{s}$ 和 $\\Gamma_{t}$ 上物理上恰当且自洽的边界条件，解释了它们在排放、沉降和与上方储库交换方面的物理意义，并为 $\\displaystyle \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c\\, \\mathrm{d}\\Omega$ 提供了具有正确符号和入流-出流处理的正确全局质量平衡？\n\nA. 表面：$\\boldsymbol{n}\\cdot \\boldsymbol{u} = 0$ 和在 $\\Gamma_{s}$ 上的罗宾边界条件 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = v_{d}\\, c - E$。顶部：在 $\\Gamma_{t}$ 上应用罗宾扩散交换 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = k_{e}\\, (\\,c - c_{a}\\,)$，并且仅在入流子集 $\\Gamma_{t}^{-}=\\{\\boldsymbol{x}\\in \\Gamma_{t}: \\boldsymbol{n}\\cdot \\boldsymbol{u} < 0\\}$ 上施加狄利克雷入流条件 $c=c_{a}$；在出流 $\\Gamma_{t}^{+}=\\{\\boldsymbol{x}\\in \\Gamma_{t}: \\boldsymbol{n}\\cdot \\boldsymbol{u} > 0\\}$ 上无平流规定。在 $\\Gamma_{\\ell}$ 上扩散通量为零的情况下，全局质量平衡为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c\\, \\mathrm{d}\\Omega\n= - \\int_{\\Gamma_{\\ell} \\cup \\Gamma_{t}} \\boldsymbol{n}\\cdot (\\boldsymbol{u}\\, c)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Gamma_{s}} \\big( v_{d}\\, c - E \\big)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Gamma_{t}} k_{e}\\, (\\,c - c_{a}\\,)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Omega} \\lambda\\, c\\, \\mathrm{d}\\Omega\n\\;+\\; \\int_{\\Omega} q_{v}\\, \\mathrm{d}\\Omega.\n$$\n这意味着当 $c > c_{a}$ 时，沉降 $v_{d}\\,c$ 和夹带 $k_{e}(c-c_{a})$ 会移除质量，而排放 $E$ 会增加质量；平流在出流处输出质量，在入流处根据设定的入流值输入质量。\n\nB. 表面：$\\boldsymbol{n}\\cdot \\boldsymbol{u} = 0$ 和在 $\\Gamma_{s}$ 上的 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = E + v_{d}\\, c$，将排放和沉降都解释为向外的通量。顶部：与 A 相同。全局质量平衡：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c\\, \\mathrm{d}\\Omega\n= - \\int_{\\Gamma_{\\ell} \\cup \\Gamma_{t}} \\boldsymbol{n}\\cdot (\\boldsymbol{u}\\, c)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Gamma_{s}} \\big( E + v_{d}\\, c \\big)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Gamma_{t}} k_{e}\\, (\\,c - c_{a}\\,)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Omega} \\lambda\\, c\\, \\mathrm{d}\\Omega\n\\;+\\; \\int_{\\Omega} q_{v}\\, \\mathrm{d}\\Omega.\n$$\n因此，排放和沉降都减少了大气质量。\n\nC. 表面：与 A 相同。顶部：一个密封盖，在 $\\Gamma_{t}$ 上有 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = 0$ 和 $\\boldsymbol{n}\\cdot \\boldsymbol{u} = 0$。全局质量平衡：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c\\, \\mathrm{d}\\Omega\n= - \\int_{\\Gamma_{\\ell}} \\boldsymbol{n}\\cdot (\\boldsymbol{u}\\, c)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Gamma_{s}} \\big( v_{d}\\, c - E \\big)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Omega} \\lambda\\, c\\, \\mathrm{d}\\Omega\n\\;+\\; \\int_{\\Omega} q_{v}\\, \\mathrm{d}\\Omega.\n$$\n这模拟了与上层大气没有净交换。\n\nD. 表面：与 A 相同。顶部：在 $\\Gamma_{t}$ 上使用反号罗宾条件 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = k_{e}\\, (\\,c_{a} - c\\,)$，并在出流子集 $\\Gamma_{t}^{+}$ 上施加 $c=c_{a}$，而入流不受约束。全局质量平衡：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c\\, \\mathrm{d}\\Omega\n= - \\int_{\\Gamma_{\\ell} \\cup \\Gamma_{t}} \\boldsymbol{n}\\cdot (\\boldsymbol{u}\\, c)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Gamma_{s}} \\big( v_{d}\\, c - E \\big)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Gamma_{t}} k_{e}\\, (\\,c_{a} - c\\,)\\, \\mathrm{d}S\n\\;-\\; \\int_{\\Omega} \\lambda\\, c\\, \\mathrm{d}\\Omega\n\\;+\\; \\int_{\\Omega} q_{v}\\, \\mathrm{d}\\Omega.\n$$\n这意味着当 $c > c_{a}$ 时，质量从上方进入，并且它约束了出流值。\n\nE. 表面：通过在 $\\Gamma_{s}$ 上设置狄利克雷条件 $c=0$ 来模拟沉降，使 $c$ 在地面处消失；没有明确的通量条件。顶部：在整个 $\\Gamma_{t}$ 上对入流和出流都施加 $c=c_{a}$。全局质量平衡省略了边界通量，因为 $c$ 是给定的：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c\\, \\mathrm{d}\\Omega\n= - \\int_{\\Omega} \\lambda\\, c\\, \\mathrm{d}\\Omega\n\\;+\\; \\int_{\\Omega} q_{v}\\, \\mathrm{d}\\Omega.\n$$",
            "solution": "分析分两个阶段进行。首先，使用给定的偏微分方程（PDE）和散度定理从第一性原理推导全局质量平衡方程。其次，根据此推导和基本物理原理评估每个选项。\n\n**1. 全局质量平衡方程的推导**\n\n示踪剂浓度 $c(\\boldsymbol{x},t)$ 的控制性平流-扩散-反应方程如下：\n$$\n\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\left( \\boldsymbol{u}\\, c \\right) \\;=\\; \\nabla \\cdot \\left( \\mathbf{K} \\nabla c \\right) \\;-\\; \\lambda(\\boldsymbol{x},t)\\, c \\;+\\; q_{v}(\\boldsymbol{x},t)\n$$\n为了找到域 $\\Omega$ 中示踪剂总质量的时间变化率，我们在 $\\Omega$ 上对PDE进行积分：\n$$\n\\int_{\\Omega} \\frac{\\partial c}{\\partial t} \\, \\mathrm{d}\\Omega + \\int_{\\Omega} \\nabla \\cdot \\left( \\boldsymbol{u}\\, c \\right) \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\nabla \\cdot \\left( \\mathbf{K} \\nabla c \\right) \\, \\mathrm{d}\\Omega - \\int_{\\Omega} \\lambda c \\, \\mathrm{d}\\Omega + \\int_{\\Omega} q_{v} \\, \\mathrm{d}\\Omega\n$$\n假设域 $\\Omega$ 不随时间变化，时间导数的积分可以与微分算子互换：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c \\, \\mathrm{d}\\Omega + \\int_{\\Omega} \\nabla \\cdot \\left( \\boldsymbol{u}\\, c \\right) \\, \\mathrm{d}\\Omega = \\int_{\\Omega} \\nabla \\cdot \\left( \\mathbf{K} \\nabla c \\right) \\, \\mathrm{d}\\Omega - \\int_{\\Omega} \\lambda c \\, \\mathrm{d}\\Omega + \\int_{\\Omega} q_{v} \\, \\mathrm{d}\\Omega\n$$\n我们对两个散度项应用散度定理（高斯定理），将散度的体积分转换为穿过边界 $\\partial \\Omega$ 的通量的面积分：\n$$\n\\int_{\\Omega} \\nabla \\cdot \\mathbf{F} \\, \\mathrm{d}\\Omega = \\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot \\mathbf{F} \\, \\mathrm{d}S\n$$\n其中 $\\boldsymbol{n}$ 是单位外法向量。应用该定理得到：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c \\, \\mathrm{d}\\Omega + \\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot (\\boldsymbol{u}c) \\, \\mathrm{d}S = \\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) \\, \\mathrm{d}S - \\int_{\\Omega} \\lambda c \\, \\mathrm{d}\\Omega + \\int_{\\Omega} q_{v} \\, \\mathrm{d}\\Omega\n$$\n重新整理以分离出质量趋势，得到全局质量平衡的一般形式：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c \\, \\mathrm{d}\\Omega = - \\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot (\\boldsymbol{u}c) \\, \\mathrm{d}S + \\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) \\, \\mathrm{d}S - \\int_{\\Omega} \\lambda c \\, \\mathrm{d}\\Omega + \\int_{\\Omega} q_{v} \\, \\mathrm{d}\\Omega\n$$\n右侧的各项分别代表由于边界上的平流通量、边界上的扩散通量、内部化学损失和内部体源引起的质量净变化率。\n\n现在，我们必须根据所描述的物理过程来构建边界条件。\n\n**地表边界 $\\Gamma_{s}$:**\n地表的总非平流通量是排放和沉降之和。\n- 排放 $E(\\boldsymbol{x},t)$ 是大气的质量源。它代表*进入*域 $\\Omega$ 的通量。由于 $\\boldsymbol{n}$ 是外法向量，向内的通量对应于 $\\boldsymbol{n} \\cdot \\boldsymbol{F}_{\\text{flux}}$ 的负值。\n- 干沉降，由 $v_{d}(\\boldsymbol{x},t)c$ 参数化，是质量汇。它代表*流出*域 $\\Omega$ 的通量。这对应于 $\\boldsymbol{n} \\cdot \\boldsymbol{F}_{\\text{flux}}$ 的正值。\n\n流出域的总非平流（建模为扩散）通量是沉降通量（向外）和排放通量（向内，因此为负向外通量）之和。流出域的扩散通量由 $-\\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c)$ 给出。因此，边界条件必须是：\n$$\n-\\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) = v_d c - E\n$$\n这是一个罗宾型边界条件。\n\n**顶部边界 $\\Gamma_{t}$:**\n与浓度为 $c_a$ 的外部储库的交换由传输速度 $k_e$ 参数化。\n- 如果域内浓度 $c$ 大于外部浓度 $c_a$，应该有一个净通量*流出*域。这个向外通量的大小是 $k_e(c-c_a)$。\n- 如果 $c  c_a$，应该有一个净通量*进入*域。\n这可以通过将向外通量定义为 $k_e(c-c_a)$ 来实现。将此物理通量与流出域的扩散通量相等，得到边界条件：\n$$\n-\\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) = k_e(c-c_a)\n$$\n对于顶部边界的平流部分，在平流主导的系统中，必须在入流部分指定边界条件，因为外部信息从这里传播到域内。入流边界是 $\\boldsymbol{n} \\cdot \\boldsymbol{u}  0$ 的地方。将流入流体的浓度设置为外部储库的浓度是物理上合理的，即在 $\\Gamma_t^- = \\{\\boldsymbol{x}\\in \\Gamma_{t}: \\boldsymbol{n}\\cdot \\boldsymbol{u}  0\\}$ 上 $c=c_a$。在出流部分（$\\boldsymbol{n} \\cdot \\boldsymbol{u} > 0$）不应指定条件，因为那里的浓度由 $\\Omega$ 内的解决定。\n\n现在我们将这些边界条件代入一般的质量平衡方程。边界积分 $\\int_{\\partial \\Omega}$ 被分解为在 $\\Gamma_{s}$、$\\Gamma_{t}$ 和 $\\Gamma_{\\ell}$ 上的积分。\n项 $\\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) \\, \\mathrm{d}S$ 变为：\n$$\n\\int_{\\Gamma_s} \\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) \\, \\mathrm{d}S + \\int_{\\Gamma_t} \\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) \\, \\mathrm{d}S + \\int_{\\Gamma_\\ell} \\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) \\, \\mathrm{d}S\n$$\n使用边界条件：\n- 在 $\\Gamma_s$ 上：$\\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) = -(v_d c - E)$\n- 在 $\\Gamma_t$ 上：$\\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) = -k_e(c-c_a)$\n- 在 $\\Gamma_\\ell$ 上：对于远处的侧边界，一个常见且合理的假设是扩散通量为零，即 $\\boldsymbol{n} \\cdot (\\mathbf{K} \\nabla c) = 0$。\n\n平流通量项 $-\\int_{\\partial \\Omega} \\boldsymbol{n} \\cdot (\\boldsymbol{u}c) \\, \\mathrm{d}S$ 是：\n- 在 $\\Gamma_s$ 上：问题陈述 $\\boldsymbol{n} \\cdot \\boldsymbol{u} = 0$，所以积分为零。\n- 这剩下在 $\\Gamma_t \\cup \\Gamma_\\ell$ 上的积分。\n\n综合所有部分，最终的质量平衡方程是：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} c\\, \\mathrm{d}\\Omega = - \\int_{\\Gamma_{\\ell} \\cup \\Gamma_{t}} \\boldsymbol{n}\\cdot (\\boldsymbol{u}\\, c)\\, \\mathrm{d}S - \\int_{\\Gamma_{s}} \\big( v_{d}\\, c - E \\big)\\, \\mathrm{d}S - \\int_{\\Gamma_{t}} k_{e}\\, (\\,c - c_{a}\\,)\\, \\mathrm{d}S - \\int_{\\Omega} \\lambda\\, c\\, \\mathrm{d}\\Omega + \\int_{\\Omega} q_{v}\\, \\mathrm{d}\\Omega\n$$\n\n**2. 评估选项**\n\n**A. 表面：$\\boldsymbol{n}\\cdot \\boldsymbol{u} = 0$ 和在 $\\Gamma_{s}$ 上的罗宾边界条件 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = v_{d}\\, c - E$。顶部：在 $\\Gamma_{t}$ 上应用罗宾扩散交换 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = k_{e}\\, (\\,c - c_{a}\\,)$，并且仅在入流子集 $\\Gamma_{t}^{-}=\\{\\boldsymbol{x}\\in \\Gamma_{t}: \\boldsymbol{n}\\cdot \\boldsymbol{u}  0\\}$ 上施加狄利克雷入流条件 $c=c_{a}$；在出流 $\\Gamma_{t}^{+}=\\{\\boldsymbol{x}\\in \\Gamma_{t}: \\boldsymbol{n}\\cdot \\boldsymbol{u}  0\\}$ 上无平流规定。...**\n在 $\\Gamma_s$ 和 $\\Gamma_t$ 上为扩散和平流输运提出的边界条件与我们的推导完全匹配。它们在物理上是合理的，在数学上是适定的。由此产生的全局质量平衡方程也与使用这些边界条件从第一性原理推导出的方程完全一致。所提供的物理解释也是正确的：沉降 $v_{d}c$ 是一个损失项（对积分的负贡献）；排放 $E$ 是一个增益项（通过 $-(-E)$ 产生正贡献）；当 $c  c_a$ 时，夹带 $k_e(c-c_a)$ 是一个损失。\n**结论：正确。**\n\n**B. 表面：$\\boldsymbol{n}\\cdot \\boldsymbol{u} = 0$ 和在 $\\Gamma_{s}$ 上的 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = E + v_{d}\\, c$，将排放和沉降都解释为向外的通量。...**\n表面边界条件 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = E + v_{d}\\, c$ 在物理上是不正确的。它将排放 $E$ 视为与沉降 $v_d c$ 方向相同的通量，即从大气中移除质量的向外通量。排放是大气的一个源，必须是向内的通量。\n**结论：错误。**\n\n**C. 表面：与 A 相同。顶部：一个密封盖，在 $\\Gamma_{t}$ 上有 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = 0$ 和 $\\boldsymbol{n}\\cdot \\boldsymbol{u} = 0$。...**\n虽然密封盖对于某些情景是一个有效的物理模型，但它与问题陈述相矛盾，问题明确描述了与上覆储库的交换：“对流层与一个已知浓度为 $c_{a}(\\boldsymbol{x},t)$ 的外部储库通过湍流夹带进行交换，其特征是传输速度 $k_{e}(\\boldsymbol{x},t) \\ge 0$”。通过将通量设置为零，此选项未能模拟指定的物理过程。尽管推导出的质量平衡与所提出的（但不恰当的）边界条件是自洽的，但它没有正确地表示问题所述的情况。\n**结论：错误。**\n\n**D. 表面：与 A 相同。顶部：在 $\\Gamma_{t}$ 上使用反号罗宾条件 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = k_{e}\\, (\\,c_{a} - c\\,)$，并在出流子集 $\\Gamma_{t}^{+}$ 上施加 $c=c_{a}$，而入流不受约束。...**\n此选项至少包含两个关键错误。首先，罗宾条件 $-\\boldsymbol{n}\\cdot \\mathbf{K}\\nabla c = k_{e}\\,(c_{a} - c)$ 意味着当 $c  c_a$ 时，通量是向内的，而当 $c  c_a$ 时，通量是向外的。这是一个正反馈，会导致浓度差异的不符合物理的放大，而不是向平衡态松弛。其次，在出流边界 ($\\Gamma_t^+$) 上规定狄利克雷条件会过度约束问题，在物理上和数学上都是不适定的。信息在该边界流出域；其状态应由域内的解决定，而不是受外部强迫。\n**结论：错误。**\n\n**E. 表面：通过在 $\\Gamma_{s}$ 上设置狄利克雷条件 $c=0$ 来模拟沉降，使 $c$ 在地面处消失；没有明确的通量条件。顶部：在整个 $\\Gamma_{t}$ 上对入流和出流都施加 $c=c_{a}$。...**\n此选项在多个方面存在缺陷。表面条件 $c=0$ 代表一个完美汇，但完全忽略了给定的排放通量 $E(\\boldsymbol{x},t)$，与问题陈述相矛盾。如选项D中所解释，在整个边界 $\\Gamma_t$（包括出流）上施加顶部条件 $c=c_a$ 是一个不适定的过度约束。最后，所提出的省略所有边界通量的全局质量平衡是根本错误的。给定的浓度（狄利克雷条件）并不意味着通量为零；相反，通量必须调整以维持该浓度，并且必须在收支中加以考虑。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在建立了一个可靠的正向模型之后，反演的核心任务是调整其输入（如初始条件或排放）以匹配观测。对于具有数百万变量的复杂模型，如何高效地计算成本函数的梯度是主要挑战。本问题将引导你推导切线性模型和伴随模型，它们是四维变分（4D-Var）数据同化的“主力军”。通过完成这一推导，你将理解在不显式构造庞大而难以处理的雅可比矩阵的情况下，计算高维系统梯度的优雅且计算上不可或缺的方法 。",
            "id": "3365830",
            "problem": "考虑一个三维化学物种，其受一个时变输运-化学模型控制，该模型在空间上通过守恒有限体积格式离散，在时间上通过步长均匀（$\\Delta t  0$）的一阶前向欧拉法离散。令 $x_{k} \\in \\mathbb{R}^{n}$ 表示在离散时间 $t_{k} = k \\Delta t$（$k = 0, 1, \\dots, K$）的网格平均物种浓度向量。离散预报更新方程为\n$$\nx_{k+1} \\;=\\; T_{k} \\, x_{k} \\;+\\; \\Delta t \\; c(x_{k}) \\;+\\; s_{k},\n$$\n其中 $T_{k} \\in \\mathbb{R}^{n \\times n}$ 代表由时间 $t_{k}$ 的已知气象条件决定的线性输运-混合算子，$c: \\mathbb{R}^{n} \\to \\mathbb{R}^{n}$ 是一个非线性局地化学倾向项，假设其连续可微且其雅可比矩阵是Lipschitz连续的，$s_{k} \\in \\mathbb{R}^{n}$ 是一个已知的源项（例如，排放和边界通量）。在时间子集 $\\{t_{\\ell_{i}}\\}_{i=1}^{m}$（其中 $\\ell_{i} \\in \\{1,\\dots,K\\}$）通过线性观测算子 $H_{i} \\in \\mathbb{R}^{p_{i} \\times n}$ 收集观测数据，得到 $y_{i} = H_{i} x_{\\ell_{i}} + \\varepsilon_{i}$，其中 $\\varepsilon_{i}$ 是独立的、零均值的高斯误差，其协方差 $R_{i} \\in \\mathbb{R}^{p_{i} \\times p_{i}}$ 已知。\n\n您的任务是进行初始状态反演。设控制变量为初始条件 $x_{0}$，其具有高斯背景（先验）$x_{b}$ 和对称正定协方差 $B \\in \\mathbb{R}^{n \\times n}$。定义非线性观测映射\n$$\n\\mathcal{G}(x_{0}) \\;=\\; \\begin{pmatrix} H_{1} \\, x_{\\ell_{1}}(x_{0}) \\\\ \\vdots \\\\ H_{m} \\, x_{\\ell_{m}}(x_{0}) \\end{pmatrix} \\in \\mathbb{R}^{p}, \\quad p \\;=\\; \\sum_{i=1}^{m} p_{i},\n$$\n其中状态轨迹 $\\{x_{k}(x_{0})\\}_{k=0}^{K}$ 由上述离散模型以初始条件 $x_{0}$ 生成。弱约束四维变分数据同化（其中模式误差固定为已知的 $s_{k}$）的代价函数为\n$$\nJ(x_{0}) \\;=\\; \\tfrac{1}{2} \\, (x_{0} - x_{b})^{\\top} B^{-1} (x_{0} - x_{b}) \\;+\\; \\tfrac{1}{2} \\, \\big(\\mathcal{G}(x_{0}) - y\\big)^{\\top} R^{-1} \\big(\\mathcal{G}(x_{0}) - y\\big),\n$$\n其中 $y = (y_{1}^{\\top}, \\dots, y_{m}^{\\top})^{\\top}$ 且 $R = \\mathrm{diag}(R_{1}, \\dots, R_{m})$ 为块对角矩阵。\n\n从线性化（一阶泰勒展开）的第一性原理和应用于离散动力系统的链式法则出发，完成以下任务：\n\n1) 推导切线性模型，即围绕由当前迭代 $x_{0}$ 生成的给定参考轨迹 $\\{x_{k}\\}_{k=0}^{K}$ 的扰动 $\\delta x_{k}$ 的线性化动力学。\n\n2) 使用切线性模型，推导对于任意方向 $v \\in \\mathbb{R}^{n}$ 的雅可比-向量积 $\\mathrm{J}(x_{0}) \\, v$，其中 $\\mathrm{J}(x_{0})$ 是 $\\mathcal{G}$ 关于 $x_{0}$ 的雅可比矩阵，在参考轨迹上求值。您的结果应该是一个以 $\\{T_{k}\\}$、$\\{\\nabla c(x_{k})\\}$、$\\{H_{i}\\}$ 和矩阵乘积表示的闭式解析表达式。\n\n3) 在不显式构造完整雅可比矩阵的情况下，解释如何在迭代高斯-牛顿法中高效计算 $\\mathrm{J}(x_{0}) \\, v$，并简要描述无矩阵克雷洛夫求解器所需的相应转置-向量积 $\\mathrm{J}(x_{0})^{\\top} w$ 的高效计算方法。\n\n以 $\\mathrm{J}(x_{0}) \\, v$ 的单个解析表达式的形式提供最终答案。无需进行数值计算。以符号形式表达最终答案，且不包含任何单位。最终答案必须是单个闭式表达式。",
            "solution": "此问题要求围绕一个参考轨迹推导切线性模型，使用它来找到雅可比-向量积的表达式，并解释伴随方法如何用于高效计算。\n\n**1) 切线性模型的推导**\n\n切线性模型描述了状态轨迹 $\\{x_k\\}$ 对初始条件 $x_0$ 的微小扰动 $\\delta x_0$ 的一阶响应。我们从离散的非线性预报模型开始：\n$$\nx_{k+1} = T_k x_k + \\Delta t \\, c(x_k) + s_k\n$$\n我们考虑一个参考轨迹 $\\{x_k\\}$，由初始条件 $x_0$ 生成，以及一个由扰动初始条件 $x_0 + \\delta x_0$ 生成的扰动轨迹 $\\{x'_k\\}$。扰动为 $\\delta x_k = x'_k - x_k$。\n对于扰动轨迹，我们有：\n$$\nx'_{k+1} = T_k x'_k + \\Delta t \\, c(x'_k) + s_k\n$$\n用 $x_k + \\delta x_k$ 替换 $x'_k$：\n$$\nx_{k+1} + \\delta x_{k+1} = T_k (x_k + \\delta x_k) + \\Delta t \\, c(x_k + \\delta x_k) + s_k\n$$\n对非线性化学项 $c(x_k + \\delta x_k)$ 进行一阶泰勒展开：\n$$\nc(x_k + \\delta x_k) \\approx c(x_k) + \\nabla c(x_k) \\delta x_k\n$$\n其中 $\\nabla c(x_k)$ 是化学倾向函数 $c$ 在状态 $x_k$ 处的雅可比矩阵。\n将展开式代入扰动方程：\n$$\nx_{k+1} + \\delta x_{k+1} \\approx T_k (x_k + \\delta x_k) + \\Delta t (c(x_k) + \\nabla c(x_k) \\delta x_k) + s_k\n$$\n$$\nx_{k+1} + \\delta x_{k+1} \\approx (T_k x_k + \\Delta t c(x_k) + s_k) + (T_k + \\Delta t \\nabla c(x_k)) \\delta x_k\n$$\n注意到括号中的第一项正是参考轨迹的 $x_{k+1}$。减去参考轨迹方程后，我们得到了扰动 $\\delta x_k$ 的线性演化方程，即**切线性模型 (Tangent Linear Model, TLM)**：\n$$\n\\delta x_{k+1} = (T_k + \\Delta t \\nabla c(x_k)) \\delta x_k\n$$\n令切线性传播算子为 $M_k = T_k + \\Delta t \\nabla c(x_k)$。则 TLM 可以简洁地写为 $\\delta x_{k+1} = M_k \\delta x_k$。\n\n**2) 雅可比-向量积的推导**\n\n雅可比-向量积 $\\mathrm{J}(x_0)v$ 是非线性观测算子 $\\mathcal{G}(x_0)$ 在方向 $v$ 上的方向导数。它衡量了当初始条件 $x_0$ 沿方向 $v$ 扰动时，观测的响应。\n根据定义，$\\mathrm{J}(x_0)v$ 是 $\\mathcal{G}(x_0 + \\epsilon v)$ 对 $\\epsilon$ 在 $\\epsilon=0$ 处的导数。这等价于将初始扰动设为 $\\delta x_0 = v$，然后通过 TLM 将其向前传播，最后应用线性观测算子。\n\n从 $\\delta x_0 = v$ 开始，使用 TLM 递归地向前传播扰动：\n$$\n\\delta x_1 = M_0 \\delta x_0 = M_0 v\n$$\n$$\n\\delta x_2 = M_1 \\delta x_1 = M_1 M_0 v\n$$\n在任意时间 $t_k$，扰动为：\n$$\n\\delta x_k = M_{k-1} M_{k-2} \\cdots M_0 v = \\left( \\prod_{j=0}^{k-1} M_j \\right) v\n$$\n非线性观测算子 $\\mathcal{G}(x_0)$ 的线性化（即 $\\delta \\mathcal{G}$）是：\n$$\n\\delta \\mathcal{G} = \\begin{pmatrix} H_1 \\delta x_{\\ell_1} \\\\ \\vdots \\\\ H_m \\delta x_{\\ell_m} \\end{pmatrix}\n$$\n将 $\\delta x_k$ 的表达式代入，我们得到雅可比-向量积 $\\mathrm{J}(x_0)v = \\delta \\mathcal{G}$：\n$$\n\\mathrm{J}(x_0)v = \\begin{pmatrix} H_1 \\left( \\prod_{j=0}^{\\ell_1 - 1} M_j \\right) v \\\\ \\vdots \\\\ H_m \\left( \\prod_{j=0}^{\\ell_m - 1} M_j \\right) v \\end{pmatrix} = \\begin{pmatrix} H_1 \\left( \\prod_{j=0}^{\\ell_1 - 1} \\left[ T_j + \\Delta t \\nabla c(x_j) \\right] \\right) v \\\\ \\vdots \\\\ H_m \\left( \\prod_{j=0}^{\\ell_m - 1} \\left[ T_j + \\Delta t \\nabla c(x_j) \\right] \\right) v \\end{pmatrix}\n$$\n这就是所求的闭式解析表达式。\n\n**3) 高效计算**\n\n在迭代优化算法（如高斯-牛顿法）中，我们需要求解形如 $(B^{-1} + \\mathrm{J}^{\\top} R^{-1} \\mathrm{J}) \\delta x = -\\nabla J$ 的线性系统。对于大规模问题，显式构造雅可比矩阵 $\\mathrm{J}$ 是不可行的。无矩阵克雷洛夫子空间方法（如共轭梯度法）通过迭代计算矩阵-向量积来求解该系统，这里需要计算 $\\mathrm{J}v$ 和 $\\mathrm{J}^{\\top}w$。\n\n-   **计算 $\\mathrm{J}v$**：从上面的推导可以看出，计算 $\\mathrm{J}v$ 不需要构造 $\\mathrm{J}$。我们只需：\n    1.  设置初始扰动为 $\\delta x_0 = v$。\n    2.  使用切线性模型 $\\delta x_{k+1} = M_k \\delta x_k$ 将扰动向前积分到最终时间 $K$。\n    3.  在每个观测时间 $t_{\\ell_i}$，计算 $H_i \\delta x_{\\ell_i}$ 并将结果存储在向量的相应部分。\n    整个过程的计算成本约等于一次正向模型积分的成本。\n\n-   **计算 $\\mathrm{J}^{\\top}w$**：转置-向量积 $\\mathrm{J}^{\\top}w$ 可以通过运行**伴随模型 (Adjoint Model)** 来高效计算。伴随模型是切线性模型传播算子 $M_k$ 的转置（伴随）。\n    令 $w = (w_1^{\\top}, \\dots, w_m^{\\top})^{\\top}$，其中 $w_i \\in \\mathbb{R}^{p_i}$。我们希望计算 $z = \\mathrm{J}^{\\top}w$。通过拉格朗日乘子法可以推导出伴随方程。伴随变量 $\\lambda_k$ 从最终时间 $K$ **向后**积分到初始时间 0：\n    $$\n    \\lambda_{k} = M_k^{\\top} \\lambda_{k+1} + \\text{forcing at } t_k\n    $$\n    初始条件为 $\\lambda_{K+1} = 0$。在每个观测时间 $t_{\\ell_i}$，伴随变量受到来自观测的强迫（“注入”）：\n    $$\n    \\lambda_{\\ell_i} \\to \\lambda_{\\ell_i} + H_i^{\\top} w_i\n    $$\n    在向后积分后，最终在初始时间得到的伴随变量 $\\lambda_0$ 就是所求的转置-向量积：\n    $$\n    \\mathrm{J}(x_0)^{\\top}w = \\lambda_0\n    $$\n    这个过程的计算成本也约等于一次（向后）模型积分的成本。因此，通过一次 TLM 运行和一次伴随模型运行，我们可以在不构造 $\\mathrm{J}$ 的情况下有效地执行克雷洛夫子空间求解器的迭代。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nH_{1} \\left( \\prod_{j=0}^{\\ell_{1}-1} \\left[ T_{j} + \\Delta t \\nabla c(x_{j}) \\right] \\right) v \\\\\n\\vdots \\\\\nH_{m} \\left( \\prod_{j=0}^{\\ell_{m}-1} \\left[ T_{j} + \\Delta t \\nabla c(x_{j}) \\right] \\right) v\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "反演问题的数学解在物理上并非总是现实的。例如，无约束的优化可能会得出负排放量的结果，这在物理上是不可能的。因此，我们必须施加约束以确保我们的结果尊重物理定律。本练习介绍了两种来自约束优化的强大技术——对数障碍法和投影梯度法（通过KKT条件）——来强制执行非负性。通过将这些方法应用于一个简化的反演问题，你将学到确保估算量（如排放通量）保持物理意义的理论基础和实践方法 。",
            "id": "3365849",
            "problem": "考虑一个用于非负排放通量的单网格大气化学输运反演问题，其中观测算子是线性的。令 $x \\in \\mathbb{R}$ 表示网格单元的排放通量，令 $y \\in \\mathbb{R}$ 表示单个观测值，该观测值通过标量输运灵敏度 $h \\in \\mathbb{R}$ 线性地依赖于 $x$。假设存在方差为 $r  0$ 的加性高斯测量误差 $\\varepsilon$，即 $y = h\\,x + \\varepsilon$，并且 $x$ 的先验分布为高斯分布，均值为 $x_b$，方差为 $b  0$。需求解在物理不等式约束 $x \\ge 0$ 下的最大后验（MAP）估计。\n\n从贝叶斯定理和所述的高斯假设出发，推导出无约束的 MAP 目标函数，其形式为一个数据失配项和一个先验正则化项之和。然后，论证并推导两种施加不等式约束 $x \\ge 0$ 的方法：\n\n1. 对数障碍法，通过在目标函数中增加一个强制 $x  0$ 的障碍项。\n2. 使用 Karush–Kuhn–Tucker (KKT) 条件的投影梯度法，其中梯度被投影到可行集 $x \\ge 0$ 上。\n\n对于每种方法，推导适用于该约束问题的修正后的一阶最优性条件。解释这些条件对约束 MAP 解的平稳性和可行性意味着什么，以及它们如何与大气化学输运反演中非负排放的物理意义相关联。\n\n最后，对于对数障碍法，考虑以下具体的标量配置：\n- 输运灵敏度 $h = 0.6$，\n- 观测值 $y = 3.0$，\n- 测量误差方差 $r = 0.25$，\n- 先验均值 $x_b = 2.0$，\n- 先验方差 $b = 1.0$，\n- 对数障碍参数 $\\mu = 0.1$。\n\n使用推导出的障碍法一阶最优性条件，计算此配置下带障碍项的目标函数的唯一正平稳点 $x^\\star(\\mu)$。将排放通量的最终答案以 $\\mathrm{kmol\\ s^{-1}}$ 为单位表示，并将结果四舍五入到四位有效数字。",
            "solution": "该问题经确认为具有科学依据、适定且客观。它代表了大气科学中约束反演问题的一种标准（尽管简化了）的表述。所有求得唯一解所需的信息均已提供。\n\n目标是求解在非负约束 $x \\ge 0$ 条件下单网格排放通量 $x \\in \\mathbb{R}$ 的最大后验（MAP）估计。该估计基于线性观测模型、高斯误差统计以及通量的高斯先验。\n\n首先，我们从贝叶斯定理推导无约束的 MAP 目标函数。给定观测值 $y$ 时状态 $x$ 的后验概率分布由贝叶斯定理给出：\n$$\nP(x|y) \\propto P(y|x)P(x)\n$$\n其中 $P(y|x)$ 是似然函数，$P(x)$ 是先验概率分布。\n\n观测模型为 $y = hx + \\varepsilon$，其中测量误差 $\\varepsilon$ 服从均值为零、方差为 $r  0$ 的高斯分布，即 $\\varepsilon \\sim \\mathcal{N}(0, r)$。因此，给定状态 $x$ 时观测到 $y$ 的似然函数为：\n$$\nP(y|x) = \\frac{1}{\\sqrt{2\\pi r}} \\exp\\left(-\\frac{(y - hx)^2}{2r}\\right)\n$$\n排放通量 $x$ 的先验分布为均值为 $x_b$、方差为 $b  0$ 的高斯分布，即 $x \\sim \\mathcal{N}(x_b, b)$。先验概率分布为：\n$$\nP(x) = \\frac{1}{\\sqrt{2\\pi b}} \\exp\\left(-\\frac{(x - x_b)^2}{2b}\\right)\n$$\n将这些代入贝叶斯定理，后验分布为：\n$$\nP(x|y) \\propto \\exp\\left(-\\frac{(y - hx)^2}{2r}\\right) \\exp\\left(-\\frac{(x - x_b)^2}{2b}\\right) = \\exp\\left(-\\left[\\frac{(y - hx)^2}{2r} + \\frac{(x - x_b)^2}{2b}\\right]\\right)\n$$\n$x$ 的 MAP 估计是使后验概率 $P(x|y)$ 最大化的值。这等价于最小化后验概率的负对数。我们定义目标函数 $J(x)$ 为后验概率负对数的两倍，并舍去常数项：\n$$\nJ(x) = \\frac{(hx-y)^2}{r} + \\frac{(x-x_b)^2}{b}\n$$\n按照惯例，包含一个 $1/2$ 的因子，得到：\n$$\nJ(x) = \\frac{1}{2r}(hx - y)^2 + \\frac{1}{2b}(x - x_b)^2\n$$\n这就是无约束的 MAP 目标函数。第一项 $\\frac{1}{2r}(hx - y)^2$ 是数据失配项，它惩罚模型预测 $hx$ 与观测值 $y$ 之间的偏差，并由测量误差方差 $r$ 的倒数加权。第二项 $\\frac{1}{2b}(x - x_b)^2$ 是先验（或背景）正则化项，它惩罚解 $x$ 与先验估计 $x_b$ 之间的偏差，并由先验方差 $b$ 的倒数加权。\n\n接下来，我们使用两种不同的方法来施加物理约束 $x \\ge 0$。\n\n**1. 对数障碍法**\n\n此方法通过向目标函数添加一个障碍项来强制执行更严格的约束 $x  0$，该障碍项惩罚接近边界 $x=0$ 的解。增广目标函数 $J_\\mu(x)$ 包含障碍项 $-\\mu \\ln(x)$，其中 $\\mu  0$ 是障碍参数：\n$$\nJ_\\mu(x) = J(x) - \\mu \\ln(x) = \\frac{1}{2r}(hx - y)^2 + \\frac{(x-x_b)^2}{2b} - \\mu \\ln(x)\n$$\n该增广目标的平稳点是通过将其关于 $x$ 的一阶导数设为零来找到的。无约束目标函数 $J(x)$ 的导数为：\n$$\n\\frac{dJ}{dx} = \\frac{1}{r}(hx-y)h + \\frac{1}{b}(x-x_b) = \\left(\\frac{h^2}{r} + \\frac{1}{b}\\right)x - \\left(\\frac{hy}{r} + \\frac{x_b}{b}\\right)\n$$\n带障碍项问题的一阶最优性条件为 $\\frac{dJ_\\mu}{dx} = 0$：\n$$\n\\frac{dJ_\\mu}{dx} = \\frac{dJ}{dx} - \\frac{\\mu}{x} = 0\n$$\n代入 $\\frac{dJ}{dx}$ 的表达式，我们得到：\n$$\n\\left(\\frac{h^2}{r} + \\frac{1}{b}\\right)x - \\left(\\frac{hy}{r} + \\frac{x_b}{b}\\right) - \\frac{\\mu}{x} = 0\n$$\n这就是对数障碍法的修正后的一阶最优性条件。该方程的解 $x^\\star(\\mu)$ 保证为正，因为当 $x \\to 0^+$ 时，项 $-\\mu \\ln(x)$ 趋向于 $+\\infty$，在边界处有效地形成了一个无限高的势垒。在物理上，这个障碍充当一种排斥力，防止排放估算值变得非物理（零或负）。通过递减 $\\mu \\to 0^+$ 得到的一系列解可以用来逼近真实的约束最小值。\n\n**2. 使用 Karush–Kuhn–Tucker (KKT) 条件的投影梯度法**\n\n这种方法直接处理约束优化问题 $\\min J(x)$，约束条件为 $g(x) = -x \\le 0$。Karush–Kuhn–Tucker (KKT) 条件为最优性提供了必要条件。拉格朗日函数为 $\\mathcal{L}(x, \\lambda) = J(x) + \\lambda g(x) = J(x) - \\lambda x$，其中 $\\lambda$ 是拉格朗日乘子。对于解 $x^\\star$，KKT 条件如下：\n1.  **平稳性 (Stationarity)**：$\\nabla_x \\mathcal{L}(x^\\star, \\lambda) = \\frac{dJ}{dx}\\bigg|_{x=x^\\star} - \\lambda = 0 \\implies \\lambda = \\frac{dJ}{dx}\\bigg|_{x=x^\\star}$\n2.  **原始可行性 (Primal Feasibility)**：$x^\\star \\ge 0$\n3.  **对偶可行性 (Dual Feasibility)**：$\\lambda \\ge 0$\n4.  **互补松弛性 (Complementary Slackness)**：$\\lambda x^\\star = 0$\n\n结合这些条件，最优解 $x^\\star$ 存在两种不同的情况：\n-   情况 A：如果 $x^\\star  0$，互补松弛性要求 $\\lambda=0$。根据平稳性，这意味着 $\\frac{dJ}{dx}\\big|_{x=x^\\star} = 0$。这说明 $J(x)$ 的无约束最小值已经位于可行域内。\n-   情况 B：如果 $x^\\star = 0$，互补松弛性得到满足。原始可行性也满足。根据平稳性和对偶可行性，我们必须有 $\\lambda = \\frac{dJ}{dx}\\big|_{x=0} \\ge 0$。\n\n令 $x_{unc}$ 为无约束最小化子，通过求解 $\\frac{dJ}{dx} = 0$ 得到。从导数的表达式可知，$x_{unc} = \\left(\\frac{hy}{r} + \\frac{x_b}{b}\\right) / \\left(\\frac{h^2}{r} + \\frac{1}{b}\\right)$。KKT 条件可以总结为：\n$$\nx^\\star = \\begin{cases} x_{unc}  \\text{if } x_{unc} \\ge 0 \\\\ 0  \\text{if } x_{unc}  0 \\end{cases}\n$$\n这等价于将无约束解投影到可行集上，$x^\\star = \\max(0, x_{unc})$。投影梯度法迭代地使用这个思想。一阶最优性条件是解是投影算子的一个不动点，可以表述为 $x^\\star = P_{[0, \\infty)}(x^\\star - \\alpha \\nabla J(x^\\star))$，对于任意步长 $\\alpha0$，其中 $P_{[0, \\infty)}(z) = \\max(0, z)$。\n在物理上，这种方法有清晰的解释。如果观测证据和先验知识（$x_{unc}$）的结合指向一个物理上合理的正排放，那么该值被接受。如果它指向一个非物理的负排放，那么估计值将被截断为最合理的物理值，即零，这承认了一个硬性的物理限制。\n\n**对数障碍法的数值计算**\n\n给定以下配置：\n-   $h = 0.6$\n-   $y = 3.0$\n-   $r = 0.25$\n-   $x_b = 2.0$\n-   $b = 1.0$\n-   $\\mu = 0.1$\n\n假设数值采用一套一致的单位，使得最终的通量 $x$ 的单位为 $\\mathrm{kmol\\ s^{-1}}$。\n\n我们使用推导出的对数障碍法的一阶最优性条件：\n$$\n\\left(\\frac{h^2}{r} + \\frac{1}{b}\\right)x - \\left(\\frac{hy}{r} + \\frac{x_b}{b}\\right) - \\frac{\\mu}{x} = 0\n$$\n首先，我们计算系数：\n$$\n\\frac{h^2}{r} = \\frac{0.6^2}{0.25} = \\frac{0.36}{0.25} = 1.44\n$$\n$$\n\\frac{1}{b} = \\frac{1}{1.0} = 1.0\n$$\n$$\n\\frac{hy}{r} = \\frac{0.6 \\times 3.0}{0.25} = \\frac{1.8}{0.25} = 7.2\n$$\n$$\n\\frac{x_b}{b} = \\frac{2.0}{1.0} = 2.0\n$$\n将这些值以及 $\\mu=0.1$ 代入最优性条件，得到：\n$$\n(1.44 + 1.0)x - (7.2 + 2.0) - \\frac{0.1}{x} = 0\n$$\n$$\n2.44x - 9.2 - \\frac{0.1}{x} = 0\n$$\n为了找到正平稳点 $x^\\star(\\mu)$，我们乘以 $x$（因为 $x  0$）以获得一个二次方程：\n$$\n2.44x^2 - 9.2x - 0.1 = 0\n$$\n我们使用二次公式 $x = \\frac{-B \\pm \\sqrt{B^2 - 4AC}}{2A}$ 求解该方程，其中 $A = 2.44$，$B = -9.2$，$C = -0.1$。\n$$\nx = \\frac{9.2 \\pm \\sqrt{(-9.2)^2 - 4(2.44)(-0.1)}}{2(2.44)}\n$$\n$$\nx = \\frac{9.2 \\pm \\sqrt{84.64 + 0.976}}{4.88}\n$$\n$$\nx = \\frac{9.2 \\pm \\sqrt{85.616}}{4.88}\n$$\n$$\nx \\approx \\frac{9.2 \\pm 9.25289}{4.88}\n$$\n我们寻求一个正解（$x  0$），因此必须取正根：\n$$\nx^\\star(\\mu) \\approx \\frac{9.2 + 9.25289}{4.88} = \\frac{18.45289}{4.88} \\approx 3.78133\n$$\n题目要求将结果四舍五入到四位有效数字。\n$$\nx^\\star(\\mu) \\approx 3.781\n$$",
            "answer": "$$\\boxed{3.781}$$"
        }
    ]
}