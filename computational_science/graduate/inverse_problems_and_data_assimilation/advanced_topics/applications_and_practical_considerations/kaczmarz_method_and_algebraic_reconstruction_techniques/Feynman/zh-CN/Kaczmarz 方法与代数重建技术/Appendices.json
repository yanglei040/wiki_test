{
    "hands_on_practices": [
        {
            "introduction": "代数重建技术 (ART) 是 Kaczmarz 方法在计算机断层扫描 (CT) 中的直接应用。该方法通过迭代地将当前图像估计投影到由单个射线测量定义的超平面上来重建图像。这个练习提供了一个具体、分步的实践机会，让您亲手体验这一过程。通过手动计算最初的几次迭代，您将对每个投影如何调整像素值以更好地匹配测量数据有一个切实的理解 。",
            "id": "3393590",
            "problem": "考虑一个在 $3\\times 3$ 的单位正方形像素网格上的简单平行束计算机断层扫描 (CT) 离散化。设未知图像由一个行主序的向量 $x \\in \\mathbb{R}^{9}$ 表示，即 $x = (x_{1}, x_{2}, x_{3}, x_{4}, x_{5}, x_{6}, x_{7}, x_{8}, x_{9})$ 对应于从上到下、从左到右的行和列。正向模型是标准的线积分离散化：每个测量值是射线穿过每个像素的路径长度加权的像素值之和。测量值被建模为 $A x = b$，其中 $A$ 的每一行对应一条射线，而 $b$ 包含相应的记录线积分值。\n\n给定四条射线：\n- 射线 $R_{1}$：水平穿过中间行，穿过像素 $(x_{4}, x_{5}, x_{6})$，路径长度分别为 $1, 1, 1$。\n- 射线 $R_{2}$：垂直穿过中间列，穿过像素 $(x_{2}, x_{5}, x_{8})$，路径长度分别为 $1, 1, 1$。\n- 射线 $R_{3}$：沿从左上到右下的主对角线，穿过像素 $(x_{1}, x_{5}, x_{9})$，在每个穿过的像素中路径长度为 $\\sqrt{2}$。\n- 射线 $R_{4}$：沿从右上到左下的反对角线，穿过像素 $(x_{3}, x_{5}, x_{7})$，在每个穿过的像素中路径长度为 $\\sqrt{2}$。\n\n记录的测量值为\n$$\nb = \\big(4,\\ 6,\\ 4\\sqrt{2},\\ 5\\sqrt{2}\\big).\n$$\n\n任务：\n1. 根据所述几何结构，显式地构建系统矩阵 $A \\in \\mathbb{R}^{4\\times 9}$。\n2. 从初始猜测 $x^{(0)} = 0 \\in \\mathbb{R}^{9}$ 开始，使用 Kaczmarz 方法执行两轮连续的代数重建技术 (ART) 迭代，松弛参数等于 $1$，依次投影到由 $R_{1}$ 然后是 $R_{2}$ 定义的超平面上（即，在第一步中使用 $A$ 的第一行及其测量值，在第二步中使用第二行）。\n3. 将经过恰好两步 ART 迭代后更新的像素向量 $x^{(2)}$ 以单个行向量的形式报告。\n\n以精确形式表示您的最终答案，不要四舍五入。将答案以单个行矩阵的形式提供。",
            "solution": "我们从线积分断层扫描的标准线性正向模型开始：对于由 $i$ 索引的每条射线，测量值为 $b_{i} = \\sum_{j=1}^{9} a_{ij} x_{j}$，其中 $a_{ij}$ 是射线 $i$ 穿过像素 $j$ 的路径长度。构建 $A$ 需要确定每条射线与哪些像素相交，并将矩阵元素设置为相应的路径长度；所有其他元素均为零。\n\n根据给定的几何结构：\n- 对于射线 $R_{1}$（中间行），非零元素位于像素 $(x_{4}, x_{5}, x_{6})$ 处，路径长度为 $1, 1, 1$，因此第一行为\n$$\na_{1\\cdot} = (0,\\ 0,\\ 0,\\ 1,\\ 1,\\ 1,\\ 0,\\ 0,\\ 0).\n$$\n- 对于射线 $R_{2}$（中间列），非零元素位于像素 $(x_{2}, x_{5}, x_{8})$ 处，路径长度为 $1, 1, 1$，因此第二行为\n$$\na_{2\\cdot} = (0,\\ 1,\\ 0,\\ 0,\\ 1,\\ 0,\\ 0,\\ 1,\\ 0).\n$$\n- 对于射线 $R_{3}$（主对角线），非零元素位于像素 $(x_{1}, x_{5}, x_{9})$ 处，路径长度为 $\\sqrt{2}$，因此第三行为\n$$\na_{3\\cdot} = (\\sqrt{2},\\ 0,\\ 0,\\ 0,\\ \\sqrt{2},\\ 0,\\ 0,\\ 0,\\ \\sqrt{2}).\n$$\n- 对于射线 $R_{4}$（反对角线），非零元素位于像素 $(x_{3}, x_{5}, x_{7})$ 处，路径长度为 $\\sqrt{2}$，因此第四行为\n$$\na_{4\\cdot} = (0,\\ 0,\\ \\sqrt{2},\\ 0,\\ \\sqrt{2},\\ 0,\\ \\sqrt{2},\\ 0,\\ 0).\n$$\n\n因此，\n$$\nA = \n\\begin{pmatrix}\n0  0  0  1  1  1  0  0  0 \\\\\n0  1  0  0  1  0  0  1  0 \\\\\n\\sqrt{2}  0  0  0  \\sqrt{2}  0  0  0  \\sqrt{2} \\\\\n0  0  \\sqrt{2}  0  \\sqrt{2}  0  \\sqrt{2}  0  0\n\\end{pmatrix},\n\\quad\nb = \n\\begin{pmatrix}\n4 \\\\ 6 \\\\ 4\\sqrt{2} \\\\ 5\\sqrt{2}\n\\end{pmatrix}.\n$$\n\n接下来，我们应用代数重建技术 (ART)，它与 Kaczmarz 方法一致，可视为对超平面 $\\{x: a_{i\\cdot} x = b_{i}\\}$ 的顺序正交投影。对于单行 $a_{i\\cdot}$ 且松弛参数为 $1$ 的 Kaczmarz 更新推导如下。超平面 $\\mathcal{H}_{i} = \\{x \\in \\mathbb{R}^{9} : a_{i\\cdot} x = b_{i}\\}$ 的法向量为 $a_{i\\cdot}^{\\top}$。点 $x^{(k)}$ 到 $\\mathcal{H}_{i}$ 上的正交投影是\n$$\nx^{(k+1)} = x^{(k)} + \\frac{b_{i} - a_{i\\cdot} x^{(k)}}{\\|a_{i\\cdot}\\|^{2}}\\, a_{i\\cdot}^{\\top},\n$$\n这是通过从法线方向减去有符号距离，并按法向量范数平方的倒数进行缩放得到的，从而确保 $a_{i\\cdot} x^{(k+1)} = b_{i}$。\n\n根据指令，我们从 $x^{(0)} = 0$ 开始执行两轮连续迭代，首先使用第 1 行，然后使用第 2 行。\n\n步骤 $1$（使用 $i=1$）：\n- 计算范数的平方 $\\|a_{1\\cdot}\\|^{2}$。由于 $a_{1\\cdot}$ 有三个元素等于 $1$，其余为零，我们得到 $\\|a_{1\\cdot}\\|^{2} = 1^{2} + 1^{2} + 1^{2} = 3$。\n- 计算 $a_{1\\cdot} x^{(0)} = 0$，因为 $x^{(0)} = 0$。\n- 计算修正因子 $c_{1} = \\dfrac{b_{1} - a_{1\\cdot} x^{(0)}}{\\|a_{1\\cdot}\\|^{2}} = \\dfrac{4 - 0}{3} = \\dfrac{4}{3}$。\n- 更新：\n$$\nx^{(1)} = x^{(0)} + c_{1} a_{1\\cdot}^{\\top}.\n$$\n由于 $a_{1\\cdot}^{\\top}$ 在位置 $4, 5, 6$ 处为 1，其他位置为零，我们得到\n$$\nx^{(1)} = (0,\\ 0,\\ 0,\\ \\tfrac{4}{3},\\ \\tfrac{4}{3},\\ \\tfrac{4}{3},\\ 0,\\ 0,\\ 0).\n$$\n\n步骤 $2$（使用 $i=2$）：\n- 计算范数的平方 $\\|a_{2\\cdot}\\|^{2}$。同样，有三个元素等于 $1$，所以 $\\|a_{2\\cdot}\\|^{2} = 3$。\n- 计算 $a_{2\\cdot} x^{(1)} = x_{2}^{(1)} + x_{5}^{(1)} + x_{8}^{(1)} = 0 + \\tfrac{4}{3} + 0 = \\tfrac{4}{3}$。\n- 计算修正因子 $c_{2} = \\dfrac{b_{2} - a_{2\\cdot} x^{(1)}}{\\|a_{2\\cdot}\\|^{2}} = \\dfrac{6 - \\tfrac{4}{3}}{3} = \\dfrac{\\tfrac{18}{3} - \\tfrac{4}{3}}{3} = \\dfrac{\\tfrac{14}{3}}{3} = \\dfrac{14}{9}$。\n- 更新：\n$$\nx^{(2)} = x^{(1)} + c_{2} a_{2\\cdot}^{\\top}.\n$$\n由于 $a_{2\\cdot}^{\\top}$ 在位置 $2, 5, 8$ 处为 1，其他位置为零，我们得到\n$$\nx^{(2)} = (0,\\ \\tfrac{14}{9},\\ 0,\\ \\tfrac{4}{3},\\ \\tfrac{4}{3} + \\tfrac{14}{9},\\ \\tfrac{4}{3},\\ 0,\\ \\tfrac{14}{9},\\ 0).\n$$\n合并中间元素：\n$$\n\\tfrac{4}{3} + \\tfrac{14}{9} = \\tfrac{12}{9} + \\tfrac{14}{9} = \\tfrac{26}{9}.\n$$\n因此，\n$$\nx^{(2)} = \\left(0,\\ \\tfrac{14}{9},\\ 0,\\ \\tfrac{4}{3},\\ \\tfrac{26}{9},\\ \\tfrac{4}{3},\\ 0,\\ \\tfrac{14}{9},\\ 0\\right).\n$$\n\n这就是按指定顺序进行两步 ART 迭代后得到的精确更新像素向量。",
            "answer": "$$\\boxed{\\begin{pmatrix}0  \\tfrac{14}{9}  0  \\tfrac{4}{3}  \\tfrac{26}{9}  \\tfrac{4}{3}  0  \\tfrac{14}{9}  0\\end{pmatrix}}$$"
        },
        {
            "introduction": "在了解了 ART 的基本工作原理之后，一个自然的问题是如何使其更快地收敛。Kaczmarz 方法的收敛速度与系统超平面的几何排列有关，这种排列由相干性等属性来描述。本练习深入探讨了该理论，要求您推导出一个最优的松弛参数 $\\omega$，以保证最快的预期误差减小 。这项实践将带您从程序性计算转向理论分析，将正交投影和特征值等抽象数学概念与算法的实际性能联系起来。",
            "id": "3266569",
            "problem": "考虑一个在 $\\mathbb{R}^{2}$ 中的相容线性系统 $A x = b$，它有两行测量值 $a_{1}^{\\top} x = b_{1}$ 和 $a_{2}^{\\top} x = b_{2}$，其中 $a_{1}, a_{2} \\in \\mathbb{R}^{2}$ 满足 $\\|a_{1}\\| = \\|a_{2}\\| = 1$ 以及 $a_{1}^{\\top} a_{2} = \\mu$（$0 \\leq \\mu  1$）。令 $x^{\\star}$ 表示其精确解。Kaczmarz 方法，也称为代数重建技术（Algebraic Reconstruction Technique, ART），使用松弛参数 $\\omega \\in [0, 2]$，其更新形式如下：\n$$\nx_{k+1} = x_{k} + \\omega \\frac{b_{i} - a_{i}^{\\top} x_{k}}{\\|a_{i}\\|^{2}} a_{i},\n$$\n其中在第 $k$ 次迭代时，行索引 $i \\in \\{1, 2\\}$ 是被均匀随机选择的。令 $e_{k} = x_{k} - x^{\\star}$ 表示误差向量。\n\n从正交投影的基本定义及其性质（对称性和幂等性）出发，推导条件期望 $\\mathbb{E}\\left[\\|e_{k+1}\\|^{2} \\mid e_{k}\\right]$ 关于 $\\omega$、$\\mu$ 和 $\\|e_{k}\\|^{2}$ 的一个界。推导过程需要将平均投影能量 $\\frac{1}{2}\\sum_{i=1}^{2}\\|P_{i} e_{k}\\|^{2}$ 与算子 $\\sum_{i=1}^{2} P_{i}$ 的特征值显式地联系起来，其中 $P_{i}$ 是到 $\\text{span}(a_{i})$ 上的正交投影算子。使用相干参数 $\\mu$ 来界定该算子，并获得一个关于期望误差的保证的单步收缩界。\n\n然后，利用这个基于相干性的界，选择一个松弛参数 $\\omega \\in [0, 2]$ 来优化所保证的期望收敛（即，最小化 $\\mathbb{E}\\left[\\|e_{k+1}\\|^{2} \\mid e_{k}\\right]$ 的上界）。请将你最终选择的 $\\omega$ 以单一精确值的形式给出。无需四舍五入。",
            "solution": "用户希望通过首先推导期望误差减少量的一个界，来为应用于一个特定 $2 \\times 2$ 线性系统的 Kaczmarz 方法找到最优松弛参数 $\\omega$。\n\n### 第 1 步：问题验证\n\n问题陈述根据指定标准进行验证。\n\n**1. 提取已知条件：**\n- 线性系统：一个在 $\\mathbb{R}^{2}$ 中的相容系统 $A x = b$。\n- 系统行：$a_{1}^{\\top} x = b_{1}$ 和 $a_{2}^{\\top} x = b_{2}$。\n- 行向量：$a_{1}, a_{2} \\in \\mathbb{R}^{2}$。\n- 向量范数：$\\|a_{1}\\| = 1$ 和 $\\|a_{2}\\| = 1$。\n- 相干参数：$a_{1}^{\\top} a_{2} = \\mu$，其中 $0 \\leq \\mu  1$。\n- 精确解：$x^{\\star}$。\n- Kaczmarz 更新规则：$x_{k+1} = x_{k} + \\omega \\frac{b_{i} - a_{i}^{\\top} x_{k}}{\\|a_{i}\\|^{2}} a_{i}$。\n- 松弛参数范围：$\\omega \\in [0, 2]$。\n- 行选择：在每次迭代 $k$ 中，索引 $i \\in \\{1, 2\\}$ 被均匀随机地选择。\n- 误差向量：$e_{k} = x_{k} - x^{\\star}$。\n- 正交投影算子：$P_{i}$ 是到 $\\text{span}(a_{i})$ 上的正交投影算子。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学上成立：** 该问题描述了随机 Kaczmarz 方法，这是数值线性代数中一个成熟的迭代算法。分析涉及正交投影、矩阵特征值和条件期望等标准概念。整个设置完全基于已建立的数学原理。\n- **适定的：** 该问题提供了所有必要信息，并要求进行特定的推导以优化一个参数。对 $\\mu$ 和 $\\omega$ 的约束是标准的，确保了分析有意义。期望得到最优 $\\omega$ 的唯一解。\n- **客观的：** 问题以精确、形式化的数学语言陈述，没有任何主观性或模糊性。\n\n**3. 结论与行动：**\n问题被判定为**有效**。可以进行完整求解分析。\n\n### 第 2 步：推导与求解\n\n问题的核心是分析误差向量 $e_{k} = x_{k} - x^{\\star}$ 的演化。\n\n首先，我们用误差来表示更新规则。给定 $\\|a_{i}\\| = 1$，更新规则简化为：\n$$\nx_{k+1} = x_{k} + \\omega (b_{i} - a_{i}^{\\top} x_{k}) a_{i}\n$$\n由于 $x^{\\star}$ 是精确解，我们有 $a_{i}^{\\top} x^{\\star} = b_{i}$。将此代入更新规则得到：\n$$\nx_{k+1} = x_{k} + \\omega (a_{i}^{\\top} x^{\\star} - a_{i}^{\\top} x_{k}) a_{i} = x_{k} - \\omega (a_{i}^{\\top} (x_{k} - x^{\\star})) a_{i}\n$$\n两边同时减去 $x^{\\star}$，得到关于 $e_{k+1} = x_{k+1} - x^{\\star}$ 的误差更新方程：\n$$\ne_{k+1} = e_{k} - \\omega (a_{i}^{\\top} e_{k}) a_{i}\n$$\n到单位向量 $a_{i}$ 的生成空间上的正交投影算子 $P_{i}$ 由外积 $P_{i} = a_{i}a_{i}^{\\top}$ 给出。将该算子应用于误差向量 $e_{k}$ 得到 $P_{i} e_{k} = (a_{i}a_{i}^{\\top})e_{k} = a_{i}(a_{i}^{\\top} e_{k}) = (a_{i}^{\\top} e_{k})a_{i}$。因此，误差更新可以紧凑地写为：\n$$\ne_{k+1} = e_{k} - \\omega P_{i} e_{k} = (I - \\omega P_{i}) e_{k}\n$$\n其中 $I$ 是单位算子。\n\n接下来，我们分析误差向量的平方范数 $\\|e_{k+1}\\|^{2}$。\n$$\n\\|e_{k+1}\\|^{2} = \\langle (I - \\omega P_{i}) e_{k}, (I - \\omega P_{i}) e_{k} \\rangle\n$$\n正交投影算子是对称的（$P_{i}^{\\top} = P_{i}$）和幂等的（$P_{i}^{2} = P_{i}$）。使用这些性质：\n$$\n\\|e_{k+1}\\|^{2} = \\langle e_{k}, (I - \\omega P_{i})^{\\top}(I - \\omega P_{i}) e_{k} \\rangle = \\langle e_{k}, (I - \\omega P_{i})(I - \\omega P_{i}) e_{k} \\rangle\n$$\n$$\n\\|e_{k+1}\\|^{2} = \\langle e_{k}, (I - 2\\omega P_{i} + \\omega^{2} P_{i}^{2}) e_{k} \\rangle = \\langle e_{k}, (I - (2\\omega - \\omega^{2}) P_{i}) e_{k} \\rangle\n$$\n$$\n\\|e_{k+1}\\|^{2} = \\langle e_{k}, e_{k} \\rangle - (2\\omega - \\omega^{2}) \\langle e_{k}, P_{i} e_{k} \\rangle = \\|e_{k}\\|^{2} - (2\\omega - \\omega^{2}) \\|P_{i} e_{k}\\|^{2}\n$$\n最后一步是根据 $\\langle e_{k}, P_{i} e_{k} \\rangle = \\langle e_{k}, P_{i}^{\\top}P_{i} e_{k} \\rangle = \\langle P_{i} e_{k}, P_{i} e_{k} \\rangle = \\|P_{i} e_{k}\\|^{2}$ 得到的。\n\n现在，我们计算给定 $e_{k}$ 时 $\\|e_{k+1}\\|^{2}$ 的条件期望。索引 $i$ 是从 $\\{1, 2\\}$ 中均匀随机选择的，因此选择任一索引的概率为 $1/2$。\n$$\n\\mathbb{E}\\left[\\|e_{k+1}\\|^{2} \\mid e_{k}\\right] = \\frac{1}{2} \\sum_{i=1}^{2} \\left( \\|e_{k}\\|^{2} - (2\\omega - \\omega^{2})\\|P_{i} e_{k}\\|^{2} \\right)\n$$\n$$\n\\mathbb{E}\\left[\\|e_{k+1}\\|^{2} \\mid e_{k}\\right] = \\|e_{k}\\|^{2} - \\frac{1}{2}(2\\omega - \\omega^{2}) \\sum_{i=1}^{2} \\|P_{i} e_{k}\\|^{2}\n$$\n问题要求我们将“平均投影能量”项与算子 $S = \\sum_{i=1}^{2} P_{i}$ 的特征值联系起来。让我们用 $S$ 来表示投影范数平方和：\n$$\n\\sum_{i=1}^{2} \\|P_{i} e_{k}\\|^{2} = \\sum_{i=1}^{2} \\langle P_{i} e_{k}, P_{i} e_{k} \\rangle = \\sum_{i=1}^{2} \\langle e_{k}, P_{i}^{\\top}P_{i} e_{k} \\rangle = \\sum_{i=1}^{2} \\langle e_{k}, P_{i} e_{k} \\rangle = \\left\\langle e_{k}, \\left(\\sum_{i=1}^{2} P_{i}\\right) e_{k} \\right\\rangle = \\langle e_{k}, S e_{k} \\rangle\n$$\n将此代回期望方程：\n$$\n\\mathbb{E}\\left[\\|e_{k+1}\\|^{2} \\mid e_{k}\\right] = \\|e_{k}\\|^{2} - \\frac{1}{2}(2\\omega - \\omega^{2}) \\langle e_{k}, S e_{k} \\rangle\n$$\n为了获得一个保证的收敛界（期望误差的一个上界），我们需要找到被减去项的一个下界。对于 $\\omega \\in [0, 2]$，项 $2\\omega - \\omega^{2} = \\omega(2-\\omega)$ 是非负的。对称算子 $S$ 的瑞利-里兹商（Rayleigh-Ritz quotient）表明 $\\langle v, S v \\rangle / \\|v\\|^{2} \\geq \\lambda_{\\min}(S)$，其中 $\\lambda_{\\min}(S)$ 是 $S$ 的最小特征值。因此，$\\langle e_{k}, S e_{k} \\rangle \\geq \\lambda_{\\min}(S) \\|e_{k}\\|^{2}$。\n这给出了所期望的上界：\n$$\n\\mathbb{E}\\left[\\|e_{k+1}\\|^{2} \\mid e_{k}\\right] \\leq \\|e_{k}\\|^{2} - \\frac{1}{2}(2\\omega - \\omega^{2}) \\lambda_{\\min}(S) \\|e_{k}\\|^{2}\n$$\n$$\n\\mathbb{E}\\left[\\|e_{k+1}\\|^{2} \\mid e_{k}\\right] \\leq \\left( 1 - \\frac{1}{2}(2\\omega - \\omega^{2}) \\lambda_{\\min}(S) \\right) \\|e_{k}\\|^{2}\n$$\n为了继续，我们必须求出 $S = P_{1} + P_{2} = a_{1}a_{1}^{\\top} + a_{2}a_{2}^{\\top}$ 的特征值。这个 $2 \\times 2$ 矩阵的特征值 $\\lambda$ 可以从特征方程求得，该方程可以用 $S$ 的迹和行列式来构建：\n$$\n\\lambda^{2} - \\text{Tr}(S)\\lambda + \\det(S) = 0\n$$\n迹是 $\\text{Tr}(S) = \\text{Tr}(a_{1}a_{1}^{\\top}) + \\text{Tr}(a_{2}a_{2}^{\\top}) = \\|a_{1}\\|^{2} + \\|a_{2}\\|^{2} = 1 + 1 = 2$。\n行列式可以使用矩阵行列式引理或通过构造矩阵 $A = [a_{1} \\quad a_{2}]$ 来找到。那么 $S = AA^{\\top}$。\n$\\det(S) = \\det(AA^{\\top}) = \\det(A)\\det(A^{\\top}) = (\\det(A))^{2}$。\n我们也知道 $\\det(A^{\\top}A) = (\\det(A))^{2}$。矩阵 $A^{\\top}A$ 是向量 $a_{1}, a_{2}$ 的格拉姆矩阵（Gram matrix）：\n$$\nA^{\\top}A = \\begin{pmatrix} a_{1}^{\\top}a_{1}  a_{1}^{\\top}a_{2} \\\\ a_{2}^{\\top}a_{1}  a_{2}^{\\top}a_{2} \\end{pmatrix} = \\begin{pmatrix} \\|a_{1}\\|^{2}  \\mu \\\\ \\mu  \\|a_{2}\\|^{2} \\end{pmatrix} = \\begin{pmatrix} 1  \\mu \\\\ \\mu  1 \\end{pmatrix}\n$$\n因此，$\\det(S) = \\det(A^{\\top}A) = 1 \\cdot 1 - \\mu \\cdot \\mu = 1 - \\mu^{2}$。\n$S$ 的特征值的特征方程是：\n$$\n\\lambda^{2} - 2\\lambda + (1 - \\mu^{2}) = 0\n$$\n使用二次公式求解：\n$$\n\\lambda = \\frac{2 \\pm \\sqrt{4 - 4(1 - \\mu^{2})}}{2} = \\frac{2 \\pm \\sqrt{4\\mu^{2}}}{2} = \\frac{2 \\pm 2|\\mu|}{2} = 1 \\pm |\\mu|\n$$\n由于 $0 \\leq \\mu  1$，所以 $|\\mu|=\\mu$。特征值为 $\\lambda_{1} = 1 + \\mu$ 和 $\\lambda_{2} = 1 - \\mu$。\n最小特征值是 $\\lambda_{\\min}(S) = 1 - \\mu$。\n\n保证的收敛界由收缩因子给出：\n$$\nC(\\omega) = 1 - \\frac{1}{2}(2\\omega - \\omega^{2})(1 - \\mu)\n$$\n为了优化保证的收敛速率，我们必须通过选择 $\\omega \\in [0, 2]$ 来最小化这个收缩因子 $C(\\omega)$。这等价于最大化被减去的项。由于 $1-\\mu > 0$（因为 $\\mu  1$），我们需要在区间 $[0, 2]$ 上最大化函数 $f(\\omega) = 2\\omega - \\omega^{2}$。\n函数 $f(\\omega)$ 描述了一个开口向下的抛物线。其最大值出现在顶点处。$f(\\omega) = -\\omega^{2} + 2\\omega$ 的顶点位于 $\\omega = -2/(2(-1)) = 1$。\n这个值 $\\omega = 1$ 位于指定区间 $[0, 2]$ 内。端点处的值为 $f(0) = 0$ 和 $f(2) = 4 - 4 = 0$，而顶点处的值为 $f(1) = 2 - 1 = 1$。\n因此，$f(\\omega)$ 在 $[0, 2]$ 上的最大值在 $\\omega = 1$ 处取得。\n\n这个 $\\omega$ 的选择最小化了导出的期望误差上界，从而优化了保证的收敛速率。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在许多现实世界的应用中，我们通常拥有关于图像的先验知识，例如像素值的非负性或上下界。这可以通过将解投影到一个约束集上来实现。本练习探讨了 ART 投影与附加的凸约束集投影之间的相互作用 。它展示了一种场景，在这种场景下，如果不小心处理，这种组合可能会阻止收敛并导致循环。这个问题是迭代方法中一个至关重要的教训：它表明，简单地组合各个“正确”的步骤并不能保证算法收敛，并强调了松弛参数在更复杂、更现实的环境中稳定过程的作用。",
            "id": "3393618",
            "problem": "考虑一个用于代数重建技术 (ART) 的二维线性化层析成像玩具模型，其中重建向量为 $x \\in \\mathbb{R}^{2}$。传感射线产生两个仿射超平面 $H_{1}$ 和 $H_{2}$，由 $a^{\\top} x = b_{i}$ 定义，其中 $a = (1, 1)^{\\top}$，$b_{1} = 2 + d$，$b_{2} = -d$，对于一个固定参数 $d > 0$。容许的先验约束集是轴对齐的方盒 $\\mathcal{C} = [0,1]^{2}$。ART 更新步骤交替进行：使用松弛 Kaczmarz 步投影到 $H_{i}$ 上，然后通过投影到 $\\mathcal{C}$ 上来施加约束。具体来说，对于索引 $i \\in \\{1, 2\\}$，带有松弛参数 $\\alpha \\in (0,2)$ 的 Kaczmarz 更新为\n$$\nx^{+} = x + \\alpha \\frac{b_{i} - a^{\\top} x}{\\|a\\|^{2}} a,\n$$\n约束施加为 $x \\leftarrow P_{\\mathcal{C}}(x)$，其中 $P_{\\mathcal{C}}$ 表示到 $\\mathcal{C}$ 上的欧几里得投影算子。\n\n从 $x_{0} = (1,1)^{\\top}$ 开始迭代，并循环交替索引 $(i=2)$ 然后 $(i=1)$，每次应用松弛 Kaczmarz 步，随后投影到 $\\mathcal{C}$ 上。你的任务是：\n\n1. 仅使用上述定义（到仿射超平面上的正交投影、带松弛的 Kaczmarz 更新、到闭凸集上的欧几里得投影），为 $\\alpha = 1$ 的选择构造一个反例，表明当 $d > 0$ 时，序列在不同的点之间循环。\n\n2. 从第一性原理推导出一个关于 $d$ 的函数的紧上界 $\\alpha_{\\max}$，使得对于任何 $\\alpha \\in (0,\\alpha_{\\max}]$，从 $x_{0}$ 开始的两步复合操作“投影到 $H_{2}$，投影到 $\\mathcal{C}$，然后投影到 $H_{1}$，投影到 $\\mathcal{C}$”所产生的迭代点保持在 $\\mathcal{C}$ 内，而不激活边界处的裁剪，从而防止循环，并沿对称轴 $x_{1} = x_{2}$ 产生线性收缩。\n\n为使数值具体，设 $d = \\sqrt{7}$。提供 $\\alpha_{\\max}$ 关于 $d$ 的精确闭式表达式，并在 $d = \\sqrt{7}$ 处对其求值。将你的最终答案表示为单个精确表达式。无需四舍五入，不涉及单位。",
            "solution": "按照要求，问题分两部分进行分析。首先，我们展示标准 Kaczmarz 方法 ($\\alpha=1$) 的循环行为。其次，我们推导松弛参数 $\\alpha$ 的紧上界，该上界通过避免给定迭代过程中边界投影的激活来防止这种循环。\n\n问题在 $\\mathbb{R}^2$ 中定义了两个平行的仿射超平面 $H_1$ 和 $H_2$：\n$$H_1: x_1 + x_2 = 2+d$$\n$$H_2: x_1 + x_2 = -d$$\n其中 $x = (x_1, x_2)^{\\top}$。这些方程可以写成 $a^{\\top}x = b_i$ 的形式，其中 $a = (1,1)^{\\top}$，$b_1 = 2+d$，$b_2 = -d$。$a$ 的范数平方为 $\\|a\\|^2 = 1^2 + 1^2 = 2$。\n\nART 迭代涉及两个算子：\n1.  对超平面 $H_i$ 的松弛 Kaczmarz 步：\n    $$K_i(x) = x + \\alpha \\frac{b_i - a^{\\top}x}{\\|a\\|^2}a$$\n2.  到约束集 $\\mathcal{C}=[0,1]^2$ 上的欧几里得投影：\n    $$P_{\\mathcal{C}}(y) = (\\max(0, \\min(1, y_1)), \\max(0, \\min(1, y_2)))^{\\top}$$\n\n单步的完整算子是 $T_i(x) = P_{\\mathcal{C}}(K_i(x))$。迭代序列由 $x_{k+1} = T_{i_k}(x_k)$ 定义，初始点为 $x_0 = (1,1)^{\\top}$，索引循环为 $i_k \\in \\{2, 1, 2, 1, \\dots\\}$。\n\n**第一部分：$\\alpha=1$ 的反例**\n\n当 $\\alpha=1$ 时，Kaczmarz 步成为到超平面上的正交投影，$P_{H_i}(x)$。我们从 $x_0 = (1,1)^{\\top}$ 开始。\n\n**迭代 1 (k=0, i=2):**\n首先，我们对 $H_2$ 应用 Kaczmarz 步。\n$$x_{0.5} = K_2(x_0) = x_0 + \\frac{b_2 - a^{\\top}x_0}{\\|a\\|^2}a$$\n其中 $a^{\\top}x_0 = 1+1=2$，$b_2=-d$，以及 $\\|a\\|^2=2$：\n$$x_{0.5} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\frac{-d - 2}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{d+2}{2} \\\\ 1 - \\frac{d+2}{2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{d}{2} \\\\ -\\frac{d}{2} \\end{pmatrix}$$\n接下来，我们投影到 $\\mathcal{C}=[0,1]^2$ 上。由于 $d>0$，我们有 $-d/2  0$。\n$$x_1 = T_2(x_0) = P_{\\mathcal{C}}(x_{0.5}) = P_{\\mathcal{C}}\\left(\\begin{pmatrix} -d/2 \\\\ -d/2 \\end{pmatrix}\\right) = \\begin{pmatrix} \\max(0, \\min(1, -d/2)) \\\\ \\max(0, \\min(1, -d/2)) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n\n**迭代 2 (k=1, i=1):**\n现在我们从 $x_1=(0,0)^{\\top}$ 开始应用这些算子。Kaczmarz 步是针对 $H_1$ 的。\n$$x_{1.5} = K_1(x_1) = x_1 + \\frac{b_1 - a^{\\top}x_1}{\\|a\\|^2}a$$\n其中 $a^{\\top}x_1 = 0+0=0$ 且 $b_1=2+d$：\n$$x_{1.5} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\frac{2+d - 0}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 + \\frac{d}{2} \\\\ 1 + \\frac{d}{2} \\end{pmatrix}$$\n接下来，我们投影到 $\\mathcal{C}$ 上。由于 $d>0$，我们有 $1+d/2 > 1$。\n$$x_2 = T_1(x_1) = P_{\\mathcal{C}}(x_{1.5}) = P_{\\mathcal{C}}\\left(\\begin{pmatrix} 1+d/2 \\\\ 1+d/2 \\end{pmatrix}\\right) = \\begin{pmatrix} \\max(0, \\min(1, 1+d/2)) \\\\ \\max(0, \\min(1, 1+d/2)) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n我们发现 $x_2=x_0$。继续这个过程将得到 $x_3=x_1=(0,0)^{\\top}$，$x_4=x_2=(1,1)^{\\top}$，依此类推。序列在两个不同的点 $(1,1)^{\\top}$ 和 $(0,0)^{\\top}$ 之间循环。这提供了所需反例。循环是由投影算子 $P_{\\mathcal{C}}$ 的裁剪作用引起的。\n\n**第二部分：$\\alpha_{\\max}(d)$ 的推导**\n\n我们被要求找到 $\\alpha$ 的紧上界 $\\alpha_{\\max}$，使得从 $x_0=(1,1)^{\\top}$ 开始的迭代序列 $x_{k+1} = T_1(T_2(x_k))$ 保持在 $\\mathcal{C}$ 内而不激活裁剪。这意味着在每一步，Kaczmarz 算子 $K_i$ 的输出必须已经位于 $\\mathcal{C}$ 内。\n\n设 $x_k = (\\xi_k, \\xi_k)^{\\top}$。问题的对称性和 $x_0$ 的选择确保了只要不发生裁剪，所有迭代点都位于直线 $x_1=x_2$ 上。我们分析标量序列 $\\xi_k$。\n\n不带裁剪的两步复合操作是：\n1.  $x_{k+0.5} = K_2(x_k) = x_k + \\alpha \\frac{-d - a^{\\top}x_k}{\\|a\\|^2}a$。标量分量是 $\\xi_{k+0.5} = \\xi_k + \\alpha \\frac{-d - 2\\xi_k}{2} = (1-\\alpha)\\xi_k - \\frac{\\alpha d}{2}$。\n2.  $x_{k+1} = K_1(x_{k+0.5}) = x_{k+0.5} + \\alpha \\frac{2+d - a^{\\top}x_{k+0.5}}{\\|a\\|^2}a$。标量分量是 $\\xi_{k+1} = \\xi_{k+0.5} + \\alpha \\frac{2+d - 2\\xi_{k+0.5}}{2} = (1-\\alpha)\\xi_{k+0.5} + \\alpha(1+\\frac{d}{2})$。\n\n结合这些，我们得到 $\\xi_k$ 的递推关系：\n$$\\xi_{k+1} = (1-\\alpha)\\left((1-\\alpha)\\xi_k - \\frac{\\alpha d}{2}\\right) + \\alpha\\left(1+\\frac{d}{2}\\right)$$\n$$\\xi_{k+1} = (1-\\alpha)^2 \\xi_k - \\frac{\\alpha d(1-\\alpha)}{2} + \\alpha\\left(1+\\frac{d}{2}\\right)$$\n$$\\xi_{k+1} = (1-\\alpha)^2 \\xi_k + \\alpha\\left(1+\\frac{d}{2} - \\frac{d(1-\\alpha)}{2}\\right) = (1-\\alpha)^2 \\xi_k + \\alpha\\left(1+\\frac{\\alpha d}{2}\\right)$$\n\n这是一个形式为 $\\xi_{k+1} = A\\xi_k+B$ 的线性递推，其中 $A=(1-\\alpha)^2$ 且 $B=\\alpha(1+\\alpha d/2)$。对于 $\\alpha \\in (0,2)$，有 $|A|1$，因此序列收敛到一个满足 $\\xi^* = A\\xi^*+B$ 的不动点 $\\xi^*$：\n$$\\xi^*(1 - (1-\\alpha)^2) = \\alpha(1+\\alpha d/2) \\implies \\xi^*\\alpha(2-\\alpha) = \\alpha(1+\\alpha d/2)$$\n$$\\xi^* = \\frac{1+\\alpha d/2}{2-\\alpha}$$\n\n“无裁剪”约束意味着对于任何 $\\xi_k \\in [0,1]$ 的迭代点 $x_k=(\\xi_k,\\xi_k)^{\\top}$，中间点 $x_{k+0.5}$ 和下一个迭代点 $x_{k+1}$ 都必须位于 $\\mathcal{C}$ 内。\n这些点的分量必须在 $[0,1]$ 区间内。\n序列从 $\\xi_0=1$ 开始。不动点 $\\xi^*$ 必须在 $[0,1]$ 内，序列才可能保持在区间 $[0,1]$ 内。对于 $\\alpha \\in(0,2)$ 和 $d>0$，$\\xi^* > 0$ 总是成立的。条件 $\\xi^* \\le 1$ 给出：\n$$\\frac{1+\\alpha d/2}{2-\\alpha} \\le 1 \\implies 1+\\frac{\\alpha d}{2} \\le 2-\\alpha \\implies \\alpha\\left(1+\\frac{d}{2}\\right) \\le 1 \\implies \\alpha \\le \\frac{2}{d+2}$$\n这为 $\\alpha$ 提供了一个必要条件。我们称之为 $\\alpha_{max,1} = \\frac{2}{d+2}$。对于 $\\alpha \\le \\alpha_{max,1}$，序列 $\\xi_k$ 从 $\\xi_0=1$ 开始，并单调递减地收敛到 $\\xi^* \\in [0,1]$。因此，所有的 $\\xi_k \\in [\\xi^*, 1] \\subset [0,1]$。\n\n现在我们必须验证，对于任何 $\\xi \\in [\\xi^*, 1]$，一个完整步骤的中间点和终点的分量都在 $[0,1]$ 内。\n1.  $K_2(x)$ 的分量：$\\xi_{k+0.5} = (1-\\alpha)\\xi_k - \\alpha d/2$。我们需要 $0 \\le \\xi_{k+0.5} \\le 1$。\n    -   $\\xi_{k+0.5} \\le (1-\\alpha) \\cdot 1 - \\alpha d/2 = 1 - \\alpha(1+d/2) = 1-\\alpha\\frac{d+2}{2}$。对于 $\\alpha \\le \\frac{2}{d+2}$，这是非负的。但我们需要证明 $\\xi_{k+0.5} \\le 1$。对于 $\\xi_k \\in [0,1]$ 和 $\\alpha  1$，$(1-\\alpha)\\xi_k \\le 1-\\alpha$。所以 $\\xi_{k+0.5} \\le 1-\\alpha-\\alpha d/2  1$。所以上界是满足的。\n    -   关键的约束是 $0 \\le \\xi_{k+0.5}$。函数 $(1-\\alpha)\\xi - \\alpha d/2$ 对于 $\\alpha1$ (当 $d>0$ 时，如果 $\\alpha \\le \\frac{2}{d+2}$，则该条件成立) 是关于 $\\xi$ 递增的。最小值在 $\\xi = \\xi^*$ 处取到。\n    $$0 \\le (1-\\alpha)\\xi^* - \\frac{\\alpha d}{2} = (1-\\alpha)\\frac{1+\\alpha d/2}{2-\\alpha} - \\frac{\\alpha d}{2}$$\n    $$0 \\le \\frac{(1-\\alpha)(1+\\alpha d/2) - \\alpha d/2(2-\\alpha)}{2-\\alpha} = \\frac{1-\\alpha -\\alpha d/2}{2-\\alpha}$$\n    由于 $2-\\alpha>0$，这意味着 $1-\\alpha - \\alpha d/2 \\ge 0$，即 $1 \\ge \\alpha(1+d/2)$，或者 $\\alpha \\le \\frac{2}{d+2}$。这正是我们之前找到的条件。\n\n2.  $K_1(K_2(x))$ 的分量：这正是 $\\xi_{k+1}$。我们需要 $0 \\le \\xi_{k+1} \\le 1$。\n    由于映射 $\\xi_k \\to \\xi_{k+1}$ 将区间 $[\\xi^*, 1]$ 映射到 $[\\xi^*, \\xi_1]$，我们只需确认这个值域在 $[0,1]$ 内。我们已经确定 $\\xi^* \\ge 0$。我们还需要 $\\xi_1 \\le 1$。\n    $\\xi_1 = (1-\\alpha)^2 \\xi_0 + \\alpha(1+\\alpha d/2)$，其中 $\\xi_0=1$。\n    $\\xi_1 = (1-\\alpha)^2 + \\alpha(1+\\alpha d/2) = 1 - 2\\alpha + \\alpha^2 + \\alpha + \\alpha^2 d/2 = 1 - \\alpha + \\alpha^2(1+d/2)$。\n    条件 $\\xi_1 \\le 1$ 给出 $-\\alpha + \\alpha^2(1+d/2) \\le 0$。由于 $\\alpha>0$，我们可以用它来除：$-1+\\alpha(1+d/2) \\le 0$，这意味着 $\\alpha \\le \\frac{1}{1+d/2} = \\frac{2}{d+2}$。\n\n两个条件都导向同一个约束：$\\alpha \\le \\frac{2}{d+2}$。这个界是紧的，因为如果 $\\alpha = \\frac{2}{d+2} + \\epsilon$ (对于某个小的 $\\epsilon>0$)，那么第一步就会是：\n$x_{0.5}$ 的分量为 $1 - \\alpha \\frac{d+2}{2} = 1 - (\\frac{2}{d+2}+\\epsilon)\\frac{d+2}{2} = 1-(1+\\epsilon\\frac{d+2}{2})  0$。这将激活边界上的裁剪。因此，紧上界是：\n$$\\alpha_{\\max} = \\frac{2}{d+2}$$\n\n最后，我们计算当 $d=\\sqrt{7}$ 时此表达式的值。\n$$\\alpha_{\\max} = \\frac{2}{2+\\sqrt{7}} = \\frac{2(2-\\sqrt{7})}{(2+\\sqrt{7})(2-\\sqrt{7})} = \\frac{2(2-\\sqrt{7})}{4-7} = \\frac{2(2-\\sqrt{7})}{-3} = \\frac{2(\\sqrt{7}-2)}{3}$$",
            "answer": "$$\\boxed{\\frac{2(\\sqrt{7}-2)}{3}}$$"
        }
    ]
}