{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of Classical Nucleation Theory (CNT) is the concept of a free energy barrier, arising from the competition between the energetic cost of creating a new interface and the volumetric gain of forming a more stable phase. This first exercise tasks you with deriving the fundamental equations for the critical nucleus radius ($r^{*}$) and the nucleation barrier ($\\Delta G^{*}$) from first principles. By performing this calculation and assessing the impact of uncertainty in the interfacial free energy, you will develop a concrete intuition for the key thermodynamic parameters that govern nucleation.",
            "id": "3437248",
            "problem": "Consider homogeneous isothermal nucleation of a spherical solid nucleus from its melt as described by Classical Nucleation Theory (CNT). The reversible Gibbs free energy change to form a cluster of radius $r$ is modeled as a sum of a surface term proportional to the area and an energetics driving term proportional to the volume. Let the isotropic solid–liquid interfacial free energy be $\\gamma$ and the bulk Gibbs free energy change per unit volume (negative for the favored phase) be $\\Delta g_{v}$. Take the nucleus as a perfect sphere and neglect elastic, anisotropy, and curvature-dependent corrections.\n\nYou are given the following parameters that are scientifically consistent with a deeply undercooled metallic melt:\n- Interfacial free energy: $\\gamma = 0.25\\,\\mathrm{J\\,m^{-2}}$ with a $10\\%$ relative uncertainty (that is, the standard uncertainty is $0.10 \\times \\gamma$).\n- Bulk driving free energy density: $\\Delta g_{v} = -8.0 \\times 10^{8}\\,\\mathrm{J\\,m^{-3}}$.\n\nStarting from first principles for the spherical cluster’s free energy model, derive the expressions for the critical radius $r^{*}$ and the corresponding nucleation barrier $\\Delta G^{*}$, explain their physical origin, and then evaluate them numerically using the given $\\gamma$ and $\\Delta g_{v}$. Next, assess the impact of the $10\\%$ uncertainty in $\\gamma$ on $\\Delta G^{*}$ using first-order differential error propagation, assuming no uncertainty in $\\Delta g_{v}$. Report the propagated absolute uncertainty in $\\Delta G^{*}$.\n\nAnswer specification:\n- Express $r^{*}$ in $\\mathrm{nm}$.\n- Express $\\Delta G^{*}$ and its propagated absolute uncertainty in $\\mathrm{J}$.\n- Round each reported quantity to four significant figures.\n- Provide the final answer as a row matrix containing, in order, $r^{*}$, $\\Delta G^{*}$, and the propagated absolute uncertainty in $\\Delta G^{*}$ due to the $10\\%$ uncertainty in $\\gamma$.",
            "solution": "The problem is valid as it is scientifically grounded in Classical Nucleation Theory (CNT), is mathematically well-posed, and uses objective, precise language with physically plausible parameters. All necessary information is provided, and no contradictions are present.\n\nThe reversible Gibbs free energy change, $\\Delta G$, to form a spherical nucleus of radius $r$ from its melt is the sum of a positive surface energy term and a negative bulk energy term. The surface term represents the energy cost of creating a new solid-liquid interface, while the bulk term represents the energy gained by transforming a volume of the higher-energy liquid phase to the lower-energy solid phase.\n\n1.  **Derivation of Critical Radius ($r^*$) and Nucleation Barrier ($\\Delta G^*$)**\n\nThe surface area of the spherical nucleus is $A = 4\\pi r^2$, and its volume is $V = \\frac{4}{3}\\pi r^3$. Given the isotropic solid-liquid interfacial free energy $\\gamma$ and the bulk Gibbs free energy change per unit volume $\\Delta g_{v}$, the total free energy change $\\Delta G(r)$ is:\n$$\n\\Delta G(r) = (\\text{Surface Area}) \\times \\gamma + (\\text{Volume}) \\times \\Delta g_{v}\n$$\n$$\n\\Delta G(r) = 4\\pi r^2 \\gamma + \\frac{4}{3}\\pi r^3 \\Delta g_{v}\n$$\nThe competition between the positive $r^2$ term and the negative $r^3$ term (since $\\Delta g_v < 0$) results in an energy barrier. The peak of this barrier corresponds to the critical nucleus size, $r^*$, and the nucleation barrier, $\\Delta G^*$. To find the critical radius, we find the maximum of the $\\Delta G(r)$ function by taking its derivative with respect to $r$ and setting it to zero.\n$$\n\\frac{d(\\Delta G(r))}{dr} = \\frac{d}{dr} \\left( 4\\pi r^2 \\gamma + \\frac{4}{3}\\pi r^3 \\Delta g_{v} \\right) = 8\\pi r \\gamma + 4\\pi r^2 \\Delta g_{v}\n$$\nSetting the derivative to zero for $r = r^*$:\n$$\n8\\pi r^* \\gamma + 4\\pi (r^*)^2 \\Delta g_{v} = 0\n$$\nSince $r^*=0$ corresponds to the initial state (no nucleus), we seek the non-trivial solution by dividing by $4\\pi r^*$:\n$$\n2\\gamma + r^* \\Delta g_{v} = 0\n$$\nSolving for $r^*$, we obtain the expression for the critical radius:\n$$\nr^* = -\\frac{2\\gamma}{\\Delta g_{v}}\n$$\nPhysically, $r^*$ is the radius at which a nucleus is in unstable equilibrium. Nuclei smaller than $r^*$ tend to shrink to reduce surface energy, while nuclei larger than $r^*$ tend to grow to reduce bulk free energy.\n\nThe nucleation barrier, $\\Delta G^*$, is the value of $\\Delta G(r)$ at $r=r^*$:\n$$\n\\Delta G^* = \\Delta G(r^*) = 4\\pi (r^*)^2 \\gamma + \\frac{4}{3}\\pi (r^*)^3 \\Delta g_{v}\n$$\nSubstituting the expression for $r^*$:\n$$\n\\Delta G^* = 4\\pi \\left(-\\frac{2\\gamma}{\\Delta g_{v}}\\right)^2 \\gamma + \\frac{4}{3}\\pi \\left(-\\frac{2\\gamma}{\\Delta g_{v}}\\right)^3 \\Delta g_{v}\n$$\n$$\n\\Delta G^* = 4\\pi \\left(\\frac{4\\gamma^2}{(\\Delta g_{v})^2}\\right) \\gamma + \\frac{4}{3}\\pi \\left(-\\frac{8\\gamma^3}{(\\Delta g_{v})^3}\\right) \\Delta g_{v}\n$$\n$$\n\\Delta G^* = \\frac{16\\pi\\gamma^3}{(\\Delta g_{v})^2} - \\frac{32\\pi\\gamma^3}{3(\\Delta g_{v})^2}\n$$\n$$\n\\Delta G^* = \\left( \\frac{48-32}{3} \\right) \\frac{\\pi\\gamma^3}{(\\Delta g_{v})^2} = \\frac{16\\pi\\gamma^3}{3(\\Delta g_{v})^2}\n$$\nThis is the energy barrier that must be overcome by thermal fluctuations for a stable nucleus to form.\n\n2.  **Numerical Evaluation**\n\nGiven the parameters:\n$\\gamma = 0.25\\,\\mathrm{J\\,m^{-2}}$\n$\\Delta g_{v} = -8.0 \\times 10^{8}\\,\\mathrm{J\\,m^{-3}}$\n\nWe calculate $r^*$:\n$$\nr^* = -\\frac{2 \\times 0.25}{-8.0 \\times 10^{8}} = \\frac{0.5}{8.0 \\times 10^{8}} = 0.625 \\times 10^{-9}\\,\\mathrm{m}\n$$\nConverting to nanometers ($1\\,\\mathrm{nm} = 10^{-9}\\,\\mathrm{m}$) and rounding to four significant figures:\n$$\nr^* = 0.6250\\,\\mathrm{nm}\n$$\nNext, we calculate $\\Delta G^*$:\n$$\n\\Delta G^* = \\frac{16\\pi (0.25)^3}{3(-8.0 \\times 10^{8})^2} = \\frac{16\\pi (0.015625)}{3(64 \\times 10^{16})} = \\frac{0.25\\pi}{192 \\times 10^{16}} \\approx 4.090615 \\times 10^{-19}\\,\\mathrm{J}\n$$\nRounding to four significant figures:\n$$\n\\Delta G^* = 4.091 \\times 10^{-19}\\,\\mathrm{J}\n$$\n\n3.  **Uncertainty Propagation**\n\nWe need to find the absolute uncertainty in $\\Delta G^*$, denoted $u(\\Delta G^*)$, resulting from the $10\\%$ relative uncertainty in $\\gamma$. We assume the uncertainty in $\\Delta g_v$ is zero. The relationship is $\\Delta G^* = C\\gamma^3$, where $C = \\frac{16\\pi}{3(\\Delta g_v)^2}$ is a constant.\n\nFor a function of the form $f(x) = ax^n$, the first-order propagation of relative uncertainty is given by:\n$$\n\\frac{u(f)}{|f|} = |n| \\frac{u(x)}{|x|}\n$$\nIn our case, $f = \\Delta G^*$, $x = \\gamma$, and $n=3$. The relative uncertainty in $\\gamma$ is given as $10\\%$, or $\\frac{u(\\gamma)}{\\gamma} = 0.10$.\nThe relative uncertainty in $\\Delta G^*$ is therefore:\n$$\n\\frac{u(\\Delta G^*)}{\\Delta G^*} = 3 \\times \\frac{u(\\gamma)}{\\gamma} = 3 \\times 0.10 = 0.30\n$$\nThe absolute uncertainty $u(\\Delta G^*)$ is $30\\%$ of the calculated value of $\\Delta G^*$:\n$$\nu(\\Delta G^*) = 0.30 \\times \\Delta G^* = 0.30 \\times (4.090615 \\times 10^{-19}\\,\\mathrm{J}) \\approx 1.227185 \\times 10^{-19}\\,\\mathrm{J}\n$$\nRounding to four significant figures:\n$$\nu(\\Delta G^*) = 1.227 \\times 10^{-19}\\,\\mathrm{J}\n$$\nThe final results to be reported are $r^* = 0.6250\\,\\mathrm{nm}$, $\\Delta G^* = 4.091 \\times 10^{-19}\\,\\mathrm{J}$, and $u(\\Delta G^*) = 1.227 \\times 10^{-19}\\,\\mathrm{J}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6250 & 4.091 \\times 10^{-19} & 1.227 \\times 10^{-19}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While analytical models provide a clean theoretical picture, modern computational studies often determine the free energy profile, $\\Delta G(n)$, as numerical data from molecular simulations. This practice bridges the gap between theory and computation, challenging you to analyze such data. You will fit a simulated free energy curve to the CNT model to extract essential physical parameters like the interfacial free energy ($\\gamma$) and validate your findings against independent methods, a common workflow in computational materials science.",
            "id": "3437207",
            "problem": "You are given three thermodynamic state points for supercooled liquid water in which a molecular dynamics constraint method produced the reversible work of formation, denoted by the free-energy profile as a function of crystalline cluster size, written as $\\Delta G(n)$. Your task is to start from the classical nucleation theory base that the total free energy of a crystalline nucleus has a bulk (volume) contribution and a surface (interfacial) contribution, and that for a spherical nucleus of $n$ molecules these contributions scale with $n$ and the surface area, respectively. Assume an incompressible nucleus with constant molecular volume and spherical geometry. Using only these bases and fundamental geometric relations, derive the functional form needed to extract the parameters that characterize $\\Delta G(n)$, determine the thermodynamic critical size $n^\\*$, compute the reversible barrier height $\\Delta G^\\* = \\Delta G(n^\\*)$, evaluate the Zeldovich factor $Z$, map the interfacial coefficient appearing in the surface term to the physical solid–liquid interfacial free energy $\\gamma$ (in $\\mathrm{J/m^2}$), and validate whether independently provided seeding-derived critical sizes are consistent with the $\\Delta G(n)$ analysis. Finally, assess whether the seeding-derived $\\gamma$ values are consistent across temperature.\n\nAll free energies $\\Delta G(n)$ in this problem are provided in units of $k_{\\mathrm{B}} T$ (dimensionless), where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the absolute temperature in kelvin.\n\nUse the following constants and definitions:\n- Boltzmann constant $k_{\\mathrm{B}} = 1.380\\,649 \\times 10^{-23} \\ \\mathrm{J/K}$.\n- Molecular volume per water molecule $v_{\\mathrm{m}} = 3.0 \\times 10^{-29} \\ \\mathrm{m^3}$.\n- The spherical geometry factor needed to relate area to the number of molecules is $(36 \\pi)^{1/3}$.\n- The dataset provides $\\Delta G(n)$ in units of $k_{\\mathrm{B}} T$ as a function of $n$; the per-molecule chemical potential driving force $\\Delta \\mu$ is provided in units of $k_{\\mathrm{B}} T$ (dimensionless). The classical nucleation theory model you must derive connects $\\Delta G(n)$, $\\Delta \\mu$, and a surface coefficient to be related to $\\gamma$ via the geometry and $k_{\\mathrm{B}} T$.\n\nFor each state point $i \\in \\{1,2,3\\}$, you are given:\n- Temperature $T_i$ in $\\mathrm{K}$.\n- Driving force $\\Delta \\mu_i$ in units of $k_{\\mathrm{B}} T_i$ (dimensionless).\n- A set of pairs $(n, \\Delta G_i(n))$ for $n \\in \\{20,40,60,80,100,120,140,160,180,200\\}$ with $\\Delta G_i(n)$ in units of $k_{\\mathrm{B}} T_i$ (dimensionless).\n- An independently estimated critical size from a seeding simulation $n^{\\mathrm{seed}}_i$ (dimensionless).\n\nYour derived and implemented procedure must:\n1. From the classical nucleation theory base and spherical geometry, derive a regression-ready form that uses the bulk scaling with $n$ and surface scaling with the area of the nucleus to fit the two parameters governing $\\Delta G(n)$ to the provided data $\\{(n, \\Delta G(n))\\}$ at each state point. Use a linear least squares fit with no intercept to determine the coefficients that multiply the bulk and surface basis functions.\n2. Using the fitted parameters, compute the thermodynamic critical size $n^\\*_i$ and barrier height $\\Delta G^\\*_i$.\n3. Compute the Zeldovich factor $Z_i$ at each state point using your derived continuum expression based on the curvature of $\\Delta G(n)$ at $n^\\*_i$.\n4. Map the fitted surface coefficient to the physical interfacial free energy $\\gamma^{\\mathrm{fit}}_i$ in $\\mathrm{J/m^2}$ for each temperature $T_i$ using spherical geometry and fundamental constants.\n5. Independently, compute a seeding-based estimate $\\gamma^{\\mathrm{seed}}_i$ in $\\mathrm{J/m^2}$ by inverting your derived $n^\\*$ relation using the provided $\\Delta \\mu_i$ and $n^{\\mathrm{seed}}_i$.\n6. Validate the critical size by checking whether $|n^\\*_i - n^{\\mathrm{seed}}_i| \\le \\tau_n$ with absolute tolerance $\\tau_n = $ $3.0$ for each state point. Report a boolean per state point.\n7. Assess whether the set $\\{\\gamma^{\\mathrm{seed}}_i\\}$ is consistent across temperature by computing the coefficient of variation (population standard deviation divided by the mean) and checking whether it is less than $r_{\\mathrm{tol}} = $ $0.05$. Report a single final boolean for the three-state-point set.\n\nNumerical data (all $\\Delta G(n)$ values are in units of $k_{\\mathrm{B}} T$, that is, dimensionless):\n\nState point $1$:\n- $T_1 = $ $235$ $\\mathrm{K}$, $\\Delta \\mu_1 = $ $0.50$.\n- $\\{(n,\\Delta G_1(n))\\}$:\n  - $(20, \\ 12.104)$\n  - $(40, \\ 15.118)$\n  - $(60, \\ 15.966)$\n  - $(80, \\ 15.716)$\n  - $(100, \\ 14.632)$\n  - $(120, \\ 12.999)$\n  - $(140, \\ 8.378)$\n  - $(160, \\ 8.476)$\n  - $(180, \\ 5.619)$\n  - $(200, \\ 2.600)$\n- Seeding critical size: $n^{\\mathrm{seed}}_1 = $ $64.00$.\n\nState point $2$:\n- $T_2 = $ $240$ $\\mathrm{K}$, $\\Delta \\mu_2 = $ $0.45$.\n- $\\{(n,\\Delta G_2(n))\\}$:\n  - $(20, \\ 12.3672)$\n  - $(40, \\ 15.9474)$\n  - $(60, \\ 17.4338)$\n  - $(80, \\ 17.8588)$\n  - $(100, \\ 17.4776)$\n  - $(120, \\ 16.5657)$\n  - $(140, \\ 12.7654)$\n  - $(160, \\ 13.5268)$\n  - $(180, \\ 11.4317)$\n  - $(200, \\ 9.1800)$\n- Seeding critical size: $n^{\\mathrm{seed}}_2 = $ $79.34$.\n\nState point $3$:\n- $T_3 = $ $245$ $\\mathrm{K}$, $\\Delta \\mu_3 = $ $0.40$.\n- $\\{(n,\\Delta G_3(n))\\}$:\n  - $(20, \\ 12.6304)$\n  - $(40, \\ 16.7768)$\n  - $(60, \\ 18.9016)$\n  - $(80, \\ 20.0016)$\n  - $(100, \\ 20.3232)$\n  - $(120, \\ 20.1324)$\n  - $(140, \\ 17.1528)$\n  - $(160, \\ 18.5776)$\n  - $(180, \\ 17.2444)$\n  - $(200, \\ 15.7600)$\n- Seeding critical size: $n^{\\mathrm{seed}}_3 = $ $101.63$.\n\nNumerical and output requirements:\n- Express $\\gamma$ in $\\mathrm{J/m^2}$.\n- Use $n^\\*$ and $n^{\\mathrm{seed}}$ as dimensionless counts.\n- Use $\\Delta G^\\*$ in units of $k_{\\mathrm{B}} T$ (dimensionless).\n- The angle unit is not applicable in this problem.\n- Rounding and formatting:\n  - Report $n^\\*$ rounded to $2$ decimal places.\n  - Report $\\Delta G^\\*$ rounded to $3$ decimal places.\n  - Report $Z$ rounded to $4$ decimal places.\n  - Report $\\gamma^{\\mathrm{fit}}$ and $\\gamma^{\\mathrm{seed}}$ rounded to $6$ decimal places in $\\mathrm{J/m^2}$.\n  - Report $n^{\\mathrm{seed}}$ rounded to $2$ decimal places.\n  - The validation booleans must be literal boolean values.\n- Final output format:\n  - Your program should produce a single line of output containing a comma-separated list enclosed in square brackets. The first three elements correspond to the three state points; each of these elements is itself a list with the following fields in this order:\n    - $n^\\*$,\n    - $\\Delta G^\\*$,\n    - $Z$,\n    - $\\gamma^{\\mathrm{fit}}$ in $\\mathrm{J/m^2}$,\n    - $n^{\\mathrm{seed}}$,\n    - $\\gamma^{\\mathrm{seed}}$ in $\\mathrm{J/m^2}$,\n    - a boolean indicating whether $|n^\\* - n^{\\mathrm{seed}}| \\le \\tau_n$.\n  - The last element of the top-level list is a single boolean indicating whether the coefficient of variation of $\\{\\gamma^{\\mathrm{seed}}_i\\}_{i=1}^3$ is less than $r_{\\mathrm{tol}}$.\n  - For example, the overall printed structure must be of the form $[[\\dots],[\\dots],[\\dots],\\mathrm{True}]$ with no spaces.",
            "solution": "The problem is deemed valid as it is scientifically grounded in classical nucleation theory, well-posed, objective, and self-contained. All necessary data, constants, and procedures are provided to derive and compute a unique, verifiable solution. We will proceed by first deriving the necessary theoretical expressions and then applying them to the provided data for each of the three state points.\n\n### 1. Derivation of the Classical Nucleation Theory (CNT) Model for Regression\n\nAccording to classical nucleation theory, the Gibbs free energy of formation, $\\Delta G(n)$, of a crystalline nucleus containing $n$ molecules from a parent liquid phase is the sum of a bulk free energy term and a surface free energy term:\n$$\n\\Delta G(n) = \\Delta G_{\\text{bulk}}(n) + \\Delta G_{\\text{surface}}(n)\n$$\nThe bulk term is proportional to the number of molecules, $n$, and the chemical potential difference per molecule, $\\Delta \\mu_{\\text{phys}}$, between the solid and liquid phases. For nucleation to be favorable, the solid phase must be more stable, thus $\\Delta \\mu_{\\text{phys}} < 0$. The bulk term is:\n$$\n\\Delta G_{\\text{bulk}}(n) = n \\Delta \\mu_{\\text{phys}} = -n |\\Delta \\mu_{\\text{phys}}|\n$$\nThe surface term is proportional to the surface area of the nucleus, $A(n)$, and the solid-liquid interfacial free energy, $\\gamma$:\n$$\n\\Delta G_{\\text{surface}}(n) = A(n) \\gamma\n$$\nAssuming a spherical nucleus of incompressible molecules, each with molecular volume $v_m$, the total volume is $V = n v_m$. The radius $r$ of the nucleus is then given by $V = \\frac{4}{3}\\pi r^3$, which leads to:\n$$\nr(n) = \\left( \\frac{3 n v_m}{4 \\pi} \\right)^{1/3}\n$$\nThe surface area $A(n) = 4\\pi r(n)^2$ can be expressed as a function of $n$:\n$$\nA(n) = 4\\pi \\left( \\left( \\frac{3 v_m}{4 \\pi} \\right)^{1/3} n^{1/3} \\right)^2 = 4\\pi \\left( \\frac{3 v_m}{4 \\pi} \\right)^{2/3} n^{2/3} = (4\\pi)^{1/3} (3v_m)^{2/3} n^{2/3} = (36 \\pi v_m^2)^{1/3} n^{2/3}\n$$\nThe problem supplies data and parameters in dimensionless form by normalizing energy by $k_{\\mathrm{B}} T$. Dividing the full $\\Delta G(n)$ expression by $k_{\\mathrm{B}} T$:\n$$\n\\frac{\\Delta G(n)}{k_{\\mathrm{B}} T} = -n \\frac{|\\Delta \\mu_{\\text{phys}}|}{k_{\\mathrm{B}} T} + \\frac{(36 \\pi v_m^2)^{1/3} \\gamma}{k_{\\mathrm{B}} T} n^{2/3}\n$$\nWe define two dimensionless parameters, $a$ and $b$, to be determined by fitting:\n-   $a = \\frac{|\\Delta \\mu_{\\text{phys}}|}{k_{\\mathrm{B}} T}$ (dimensionless driving force)\n-   $b = \\frac{(36 \\pi v_m^2)^{1/3} \\gamma}{k_{\\mathrm{B}} T}$ (dimensionless surface energy coefficient)\n\nThe CNT model to be fitted to the provided dimensionless $\\Delta G(n)$ data is thus:\n$$\n\\Delta G_{\\text{fit}}(n) = -a n + b n^{2/3}\n$$\nThis equation is linear in the coefficients $a$ and $b$. Given a set of data points $(n_j, \\Delta G(n_j))$, we can determine the best-fit parameters $\\hat{a}$ and $\\hat{b}$ using a linear least squares regression with basis functions $f_1(n) = -n$ and $f_2(n) = n^{2/3}$, and no intercept.\n\n### 2. Calculation of Critical Properties\n\nThe critical nucleus size, $n^\\*$, corresponds to the maximum of the free energy profile, which is found by setting the first derivative of $\\Delta G_{\\text{fit}}(n)$ with respect to $n$ to zero:\n$$\n\\frac{d(\\Delta G_{\\text{fit}}(n))}{dn} = -\\hat{a} + \\frac{2}{3}\\hat{b}n^{-1/3} = 0 \\implies n^\\* = \\left(\\frac{2\\hat{b}}{3\\hat{a}}\\right)^3\n$$\nThe nucleation barrier height, $\\Delta G^\\*$, is the free energy evaluated at the critical size, $\\Delta G_{\\text{fit}}(n^\\*)$:\n$$\n\\Delta G^\\* = -\\hat{a}n^\\* + \\hat{b}(n^\\*)^{2/3} = -\\hat{a}\\left(\\frac{2\\hat{b}}{3\\hat{a}}\\right)^3 + \\hat{b}\\left(\\frac{2\\hat{b}}{3\\hat{a}}\\right)^2 = \\frac{4\\hat{b}^3}{27\\hat{a}^2}\n$$\n\n### 3. Zeldovich Factor\n\nThe Zeldovich factor, $Z$, characterizes the curvature of the free energy barrier top. With $\\Delta G(n)$ in units of $k_{\\mathrm{B}} T$, it is given by:\n$$\nZ = \\left( -\\frac{1}{2\\pi} \\frac{d^2(\\Delta G_{\\text{fit}}(n))}{dn^2} \\bigg|_{n=n^\\*} \\right)^{1/2}\n$$\nThe second derivative is:\n$$\n\\frac{d^2(\\Delta G_{\\text{fit}}(n))}{dn^2} = -\\frac{2}{9}\\hat{b}n^{-4/3}\n$$\nEvaluated at $n=n^\\*$:\n$$\n\\frac{d^2(\\Delta G_{\\text{fit}}(n^\\*))}{dn^2} = -\\frac{2}{9}\\hat{b}(n^\\*)^{-4/3} = -\\frac{2}{9}\\hat{b}\\left(\\left(\\frac{2\\hat{b}}{3\\hat{a}}\\right)^3\\right)^{-4/3} = -\\frac{9\\hat{a}^4}{8\\hat{b}^3}\n$$\nSubstituting into the expression for $Z$:\n$$\nZ = \\left( -\\frac{1}{2\\pi} \\left( -\\frac{9\\hat{a}^4}{8\\hat{b}^3} \\right) \\right)^{1/2} = \\frac{3\\hat{a}^2}{4\\sqrt{\\pi}\\hat{b}^{3/2}}\n$$\n\n### 4. Mapping to Physical Interfacial Free Energy, $\\gamma$\n\nThe fitted dimensionless surface coefficient, $\\hat{b}_i$, for each state point $i$ can be mapped to the physical interfacial free energy, $\\gamma_i^{\\mathrm{fit}}$, using the definition of $b$:\n$$\n\\hat{b}_i = \\frac{(36 \\pi v_m^2)^{1/3} \\gamma_i^{\\mathrm{fit}}}{k_{\\mathrm{B}} T_i} \\implies \\gamma_i^{\\mathrm{fit}} = \\frac{\\hat{b}_i k_{\\mathrm{B}} T_i}{(36 \\pi v_m^2)^{1/3}}\n$$\n\n### 5. Independent Calculation of $\\gamma$ from Seeding Data\n\nAn independent estimate, $\\gamma_i^{\\mathrm{seed}}$, is calculated by inverting the CNT expression for $n^\\*$, using the provided seeding-derived critical size $n_i^{\\mathrm{seed}}$ and driving force $\\Delta \\mu_i$:\n$$\nn_i^{\\mathrm{seed}} = \\left(\\frac{2 b_i}{3 a_i}\\right)^3\n$$\nHere, we use $a_i = \\Delta \\mu_i$ (given) and solve for the corresponding $b_i$, which we call $b_i^{\\mathrm{seed}}$:\n$$\nb_i^{\\mathrm{seed}} = \\frac{3 \\Delta \\mu_i (n_i^{\\mathrm{seed}})^{1/3}}{2}\n$$\nWe then map $b_i^{\\mathrm{seed}}$ to $\\gamma_i^{\\mathrm{seed}}$:\n$$\n\\gamma_i^{\\mathrm{seed}} = \\frac{b_i^{\\mathrm{seed}} k_{\\mathrm{B}} T_i}{(36 \\pi v_m^2)^{1/3}} = \\frac{3 \\Delta \\mu_i (n_i^{\\mathrm{seed}})^{1/3} k_{\\mathrm{B}} T_i}{2(36 \\pi)^{1/3} v_m^{2/3}}\n$$\n\n### 6. Validation and Consistency Checks\n\nFinally, two validation checks will be performed as specified:\n1.  **Critical Size Validation**: For each state point $i$, we check if $|n^\\*_i - n^{\\mathrm{seed}}_i| \\le \\tau_n$, where the tolerance is $\\tau_n = 3.0$.\n2.  **$\\gamma^{\\mathrm{seed}}$ Consistency**: We compute the coefficient of variation (CV) of the set $\\{\\gamma_1^{\\mathrm{seed}}, \\gamma_2^{\\mathrm{seed}}, \\gamma_3^{\\mathrm{seed}}\\}$ as the population standard deviation divided by the mean. We then check if this CV is less than the tolerance $r_{\\mathrm{tol}} = 0.05$.\n\nThe following implementation executes these steps for the three given state points.",
            "answer": "[[63.66,16.294,0.0638,0.000027,64.00,0.000027,True],[79.03,18.066,0.0559,0.000027,79.34,0.000027,True],[100.86,20.404,0.0494,0.000027,101.63,0.000027,True],True]"
        },
        {
            "introduction": "Beyond the static free energy barrier, the ultimate goal is often to predict the kinetic rate of nucleation, $J$. Advanced computational techniques like Forward-Flux Sampling (FFS) are designed to measure the rates of such rare events directly, bypassing the need to compute the full free energy landscape. This exercise guides you through the statistical framework of FFS, where the rate is assembled from an initial flux and a series of conditional crossing probabilities, including the construction of rigorous confidence intervals.",
            "id": "3437239",
            "problem": "You are asked to design and implement a complete computational procedure to estimate a nucleation rate using Forward-Flux Sampling (FFS) and to construct statistically justified confidence intervals. The setting is Classical Nucleation Theory (CNT), where the nucleation rate is defined as the expected number of successful nucleation events per unit time per unit volume.\n\nStart from the following base:\n- The nucleation rate $J$ in CNT is the expected number of successful transitions from the metastable basin to the stable phase per unit time per unit volume.\n- In FFS, an order parameter $\\lambda$ defines nested interfaces $\\lambda_0 &lt; \\lambda_1 &lt; \\cdots &lt; \\lambda_K$ between the metastable basin and the stable phase. The metastable basin corresponds to $\\lambda &lt; \\lambda_0$, and successful nucleation corresponds to reaching $\\lambda_K$ without returning to the basin.\n- Crossings from the basin to the first interface can be modeled as a Poisson process in time when events are rare and memoryless.\n- Conditional advancement from interface $\\lambda_i$ to $\\lambda_{i+1}$, given a crossing of $\\lambda_i$, can be modeled as independent Bernoulli trials, producing binomial data for the crossing probabilities.\n- The total exposure for the Poisson process is the product of observation time and sampling volume.\n\nYour task is to:\n1. Derive, from these base principles, a logically valid expression for $J$ in terms of a measurable flux across $\\lambda_0$ and a sequence of conditional crossing probabilities between successive interfaces. Justify each inference from the stated base without using any shortcut formulas or pre-supplied target expressions.\n2. Develop a method to construct a two-sided confidence interval for $J$ at overall coverage level $1 - \\alpha$, with $\\alpha = 0.05$, by combining uncertainty from the flux measurement and the crossing probabilities. Your interval construction must:\n   - Use an exact two-sided confidence interval for the Poisson rate of crossings across $\\lambda_0$, based on the observed count and total exposure.\n   - Use an exact two-sided confidence interval for each binomial proportion of conditional crossings between successive interfaces.\n   - Combine the component intervals into an overall interval for $J$ using a principled multiple-comparisons allocation of $\\alpha$ that ensures the overall coverage is at least $1 - \\alpha$ without assuming any special-case simplifications.\n3. Implement a program that, for each test case provided below, computes:\n   - A point estimate $\\hat{J}$ based on the observed flux and crossing proportions.\n   - A two-sided confidence interval $[J_{\\mathrm{low}}, J_{\\mathrm{up}}]$ at overall coverage level $0.95$, in the unit \"events per nanosecond per cubic nanometer\" (written as \"per ns per nm$^3$\").\n   The program must not require any input and must print the aggregated results for all test cases in a single line as a comma-separated list enclosed in square brackets, where each test case is represented as a list of three floats $[\\hat{J}, J_{\\mathrm{low}}, J_{\\mathrm{up}}]$.\n\nSpecifications for statistical construction and units:\n- The flux measurement is given by an observed crossing count $C_0$ across $\\lambda_0$ in observation time $T$ within sampling volume $V$. The flux per unit time per unit volume is defined as $C_0$ divided by the total exposure $T \\times V$. Express $J$ in \"per ns per nm$^3$\".\n- Use a two-sided exact interval for the Poisson rate of $C_0$ events per exposure $T \\times V$.\n- For each interface $i$, use a two-sided exact interval for the binomial proportion $p_i$ based on $S_i$ successes out of $N_i$ trials.\n- Use a principled multiple-comparisons approach to allocate $\\alpha$ across the flux and all crossing-probability components so that the combined interval for $J$ has overall coverage at least $0.95$.\n- Your program must compute and output the point estimates and intervals as raw floating-point numbers. Do not include units in the output; the unit is specified in this problem statement.\n\nTest suite of parameter values:\n- Case A (general case): $V = 1000$ nm$^3$, $T = 500$ ns, $C_0 = 120$, $K = 3$, $(N_1,N_2,N_3) = (200,150,100)$, $(S_1,S_2,S_3) = (60,45,20)$.\n- Case B (edge case with zero successes on last interface): $V = 10000$ nm$^3$, $T = 1000$ ns, $C_0 = 300$, $K = 3$, $(N_1,N_2,N_3) = (100,50,20)$, $(S_1,S_2,S_3) = (40,10,0)$.\n- Case C (near-deterministic crossings with small flux): $V = 500$ nm$^3$, $T = 100$ ns, $C_0 = 3$, $K = 2$, $(N_1,N_2) = (10,10)$, $(S_1,S_2) = (10,10)$.\n- Case D (zero flux count): $V = 2000$ nm$^3$, $T = 200$ ns, $C_0 = 0$, $K = 3$, $(N_1,N_2,N_3) = (50,50,50)$, $(S_1,S_2,S_3) = (25,10,5)$.\n- Case E (large counts and diverse probabilities): $V = 750$ nm$^3$, $T = 1000$ ns, $C_0 = 5000$, $K = 4$, $(N_1,N_2,N_3,N_4) = (1000,1000,1000,1000)$, $(S_1,S_2,S_3,S_4) = (900,500,100,20)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one entry per test case, each entry being a list of three floats representing $[\\hat{J}, J_{\\mathrm{low}}, J_{\\mathrm{up}}]$ for that case. For example: \"[[0.00123,0.00085,0.00180],[...],...]\".",
            "solution": "The problem of estimating the nucleation rate $J$ and its confidence interval from Forward-Flux Sampling (FFS) data is addressed by first deriving the expression for $J$ from fundamental principles and then constructing a statistically rigorous confidence interval by combining uncertainties from all stochastic steps of the FFS process.\n\n### Step 1: Derivation of the Nucleation Rate Expression\n\nThe nucleation rate $J$ is defined as the expected number of successful nucleation events per unit time per unit volume. In the context of FFS, a successful event is a trajectory that originates in the metastable basin ($\\lambda < \\lambda_0$), crosses the first interface $\\lambda_0$, and subsequently reaches the final interface $\\lambda_K$ without returning to the basin.\n\nLet $\\Phi_0$ be the flux across the first interface $\\lambda_0$, defined as the rate of crossings per unit time and per unit volume. Let $P(\\lambda_K | \\lambda_0)$ be the conditional probability that a trajectory, having just crossed $\\lambda_0$, successfully reaches $\\lambda_K$. The overall rate of successful events, $J$, is the product of the initial flux and the probability of success:\n$$J = \\Phi_0 \\times P(\\lambda_K | \\lambda_0)$$\n\nThe FFS methodology relies on a sequence of interfaces $\\lambda_0 < \\lambda_1 < \\cdots < \\lambda_K$. The probability $P(\\lambda_K | \\lambda_0)$ can be decomposed using the chain rule of probability. A trajectory reaches $\\lambda_K$ from $\\lambda_0$ by successively crossing each intermediate interface. Let $E_i$ be the event of reaching interface $\\lambda_i$. The probability of success is $P(E_K | E_0)$.\n$$P(E_K | E_0) = P(E_1 | E_0) \\times P(E_2 | E_1, E_0) \\times \\cdots \\times P(E_K | E_{K-1}, \\dots, E_0)$$\n\nThe problem states that conditional advancements between interfaces are modeled as independent Bernoulli trials. This implies a memoryless or Markovian property, where the probability of advancing from $\\lambda_i$ to $\\lambda_{i+1}$ depends only on the system's state at $\\lambda_i$, not its prior history. Therefore, $P(E_{i+1} | E_i, \\dots, E_0) = P(E_{i+1} | E_i)$. Let us define the conditional crossing probability from interface $\\lambda_{i-1}$ to $\\lambda_i$ as $p_i = P(E_i | E_{i-1})$ for $i=1, \\dots, K$. The chain rule simplifies to a product of these independent probabilities:\n$$P(\\lambda_K | \\lambda_0) = P(E_1 | E_0) \\times P(E_2 | E_1) \\times \\cdots \\times P(E_K | E_{K-1}) = \\prod_{i=1}^{K} p_i$$\n\nSubstituting this into the expression for $J$, we arrive at the full expression for the nucleation rate in terms of measurable FFS quantities:\n$$J = \\Phi_0 \\prod_{i=1}^{K} p_i$$\n\n### Step 2: Point Estimate\n\nThe point estimate for $J$, denoted $\\hat{J}$, is constructed from the point estimates of its constituent parameters.\n1.  The flux $\\Phi_0$ is estimated from the observation of $C_0$ crossings of $\\lambda_0$ during a total time $T$ in a volume $V$. The total exposure is $E = T \\times V$. The estimator for the flux is:\n    $$\\hat{\\Phi}_0 = \\frac{C_0}{T \\times V}$$\n2.  Each conditional probability $p_i$ is estimated from $S_i$ successful advancements to $\\lambda_i$ out of $N_i$ trials initiated from $\\lambda_{i-1}$. The estimator for this binomial proportion is:\n    $$\\hat{p}_i = \\frac{S_i}{N_i}$$\n\nCombining these, the point estimate for the nucleation rate is:\n$$\\hat{J} = \\frac{C_0}{T \\times V} \\prod_{i=1}^{K} \\frac{S_i}{N_i}$$\n\n### Step 3: Confidence Interval Construction\n\nA two-sided confidence interval for $J$ at an overall coverage level of $1 - \\alpha$ is required. The rate $J$ is a product of $K+1$ independently estimated parameters: the flux $\\Phi_0$ and the $K$ probabilities $p_1, \\dots, p_K$. To ensure the overall coverage, we use the Bonferroni correction, a principled method for multiple comparisons.\n\nThe total significance level $\\alpha$ is distributed among the $m = K+1$ parameters. Each parameter's confidence interval will be constructed at a stricter confidence level of $1 - \\alpha'$, where $\\alpha' = \\alpha / m$. Let $[L_0, U_0]$ be the $(1 - \\alpha')$ confidence interval for $\\Phi_0$, and $[L_i, U_i]$ be the $(1 - \\alpha')$ confidence interval for each $p_i$. Since $J$ is a product of non-negative quantities, the combined confidence interval $[J_{\\mathrm{low}}, J_{\\mathrm{up}}]$ is constructed by multiplying the corresponding lower and upper bounds of the individual intervals:\n$$J_{\\mathrm{low}} = L_0 \\prod_{i=1}^{K} L_i$$\n$$J_{\\mathrm{up}} = U_0 \\prod_{i=1}^{K} U_i$$\n\nThis construction guarantees that the overall confidence level is at least $1 - \\alpha$.\n\n#### 3.1. Exact Confidence Interval for the Poisson Rate $\\Phi_0$\n\nThe number of initial crossings $C_0$ in a total exposure $E = T \\times V$ follows a Poisson distribution with mean $\\mu = \\Phi_0 \\times E$. We first find an exact $(1 - \\alpha')$ confidence interval for $\\mu$ given the observation $C_0$. This interval, known as the Garwood interval, is based on the relationship between the Poisson and chi-squared ($\\chi^2$) distributions.\nThe lower and upper bounds for $\\mu$ are:\n$$\\mu_{\\mathrm{low}} = \\frac{1}{2} \\chi^2_{2C_0}\\left(\\frac{\\alpha'}{2}\\right)$$\n$$\\mu_{\\mathrm{up}} = \\frac{1}{2} \\chi^2_{2(C_0+1)}\\left(1 - \\frac{\\alpha'}{2}\\right)$$\nwhere $\\chi^2_{\\nu}(q)$ is the $q$-quantile of the chi-squared distribution with $\\nu$ degrees of freedom. For the special case $C_0=0$, $\\mu_{\\mathrm{low}} = 0$.\nThe confidence interval for the rate $\\Phi_0$ is then obtained by dividing by the exposure $E$:\n$$[L_0, U_0] = \\left[\\frac{\\mu_{\\mathrm{low}}}{E}, \\frac{\\mu_{\\mathrm{up}}}{E}\\right]$$\n\n#### 3.2. Exact Confidence Interval for Binomial Proportions $p_i$\n\nFor each conditional probability $p_i$, we have $S_i$ successes in $N_i$ trials. An exact $(1 - \\alpha')$ confidence interval for the binomial proportion $p_i$ is given by the Clopper-Pearson interval. This interval is derived by inverting two one-sided binomial tests and can be expressed using quantiles of the Beta distribution.\nThe lower and upper bounds for $p_i$ are:\n$$L_i = \\mathrm{Beta}\\left(\\frac{\\alpha'}{2}; S_i, N_i - S_i + 1\\right)$$\n$$U_i = \\mathrm{Beta}\\left(1 - \\frac{\\alpha'}{2}; S_i + 1, N_i - S_i\\right)$$\nwhere $\\mathrm{Beta}(q; a, b)$ is the $q$-quantile of the Beta distribution with shape parameters $a$ and $b$.\nSpecial cases are handled as follows:\n- If $S_i = 0$, the lower bound $L_i = 0$.\n- If $S_i = N_i$, the upper bound $U_i = 1$.\n\nBy computing these individual intervals and combining their bounds as described, we obtain a statistically sound estimate for the range of plausible values for the nucleation rate $J$. The specified overall coverage of $0.95$ corresponds to $\\alpha = 0.05$.",
            "answer": "[[1.44e-08,9.323555543085584e-09,2.160161474261769e-08],[0.0,0.0,1.850550974332977e-08],[6e-05,1.1310384166649534e-05,0.0002131964898129038],[0.0,0.0,2.1126601443685324e-08],[6.000000000000001e-08,5.467472097705474e-08,6.581561570776518e-08]]"
        }
    ]
}