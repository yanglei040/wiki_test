{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂的计算方案之前，首先必须熟练掌握动力学平均场理论中的核心代数关系。本练习旨在训练您直接操作杂质戴森方程，以隔离关键量——杂化函数 $\\Delta(i\\omega_n)$——并验证其必须满足的基本物理属性。掌握这项技能对于理论分析、模型推导以及调试代码都至关重要 。",
            "id": "3446486",
            "problem": "您正在研究动力学平均场理论 (DMFT) 框架下的一个单轨道关联晶格，该问题被映射为一个安德森杂质问题。其逆温度为 $\\beta$，费米子松原频率为 $i\\omega_n$，其中对于整数 $n$，$\\omega_n=(2n+1)\\pi/\\beta$。杂质戴森方程通过量子多体理论的基本恒等式（戴森方程和Weiss场定义）将局域格林函数 $G_{\\text{loc}}(i\\omega_n)$、自能 $\\Sigma(i\\omega_n)$、化学势 $\\mu$ 和杂化函数 $\\Delta(i\\omega_n)$ 联系起来：相互作用的杂质格林函数满足 $G_{\\text{loc}}^{-1}(i\\omega_n)=\\mathcal{G}_0^{-1}(i\\omega_n)-\\Sigma(i\\omega_n)$，其中 $\\mathcal{G}_0^{-1}(i\\omega_n)=i\\omega_n+\\mu-\\Delta(i\\omega_n)$。\n\n请仅从这些定义出发，首先推导 $\\Delta(i\\omega_n)$ 关于 $i\\omega_n$、$\\mu$、$\\Sigma(i\\omega_n)$ 和 $G_{\\text{loc}}(i\\omega_n)$ 的显式表达式。然后，对于 $\\mu=0$ 的特殊情况，且\n$$\n\\Sigma(i\\omega_n)=\\frac{U^2}{4\\,i\\omega_n},\\qquad\nG_{\\text{loc}}(i\\omega_n)=\\frac{1}{\\,i\\omega_n-\\Sigma(i\\omega_n)-\\dfrac{V^2}{i\\omega_n-\\epsilon_b}\\,},\n$$\n其中 $U0$、$V0$ 和 $\\epsilon_b\\in\\mathbb{R}$ 是参数，请计算由此得到的 $\\Delta(i\\omega_n)$ 的闭合形式表达式。利用您的结果，从第一性原理出发，验证对于所有 $n\\ge 0$ 都有 $\\operatorname{Im}\\Delta(i\\omega_n)\\le 0$，并验证其高频展开满足\n$$\n\\Delta(i\\omega_n)\\sim \\frac{C}{i\\omega_n}+\\mathcal{O}\\!\\left(\\frac{1}{\\omega_n^2}\\right)\n\\quad\\text{且}\\quad C=\\sum_{\\ell}V_{\\ell}^2,\n$$\n并根据给定参数确定 $C$。请将杂化函数 $\\Delta(i\\omega_n)$ 的最终答案表示为单个闭合形式的解析表达式。无需四舍五入。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于量子多体物理学的原理，特别是动力学平均场理论（DMFT），问题表述清晰，客观，并包含获得唯一解所需的所有必要信息。\n\n该问题要求基于 DMFT 中出现的安德森杂质问题的基本方程进行若干推导和验证。我们将逐步进行。\n\n**第一部分：杂化函数 $\\Delta(i\\omega_n)$ 的一般表达式**\n\n我们已知关于杂质问题的两个基本关系式：\n1.  联系局域相互作用格林函数 $G_{\\text{loc}}(i\\omega_n)$、Weiss 场（无相互作用格林函数）$\\mathcal{G}_0(i\\omega_n)$ 和自能 $\\Sigma(i\\omega_n)$ 的戴森方程：\n    $$G_{\\text{loc}}^{-1}(i\\omega_n) = \\mathcal{G}_0^{-1}(i\\omega_n) - \\Sigma(i\\omega_n)$$\n2.  以杂化函数 $\\Delta(i\\omega_n)$、化学势 $\\mu$ 和费米子松原频率 $i\\omega_n$ 定义的 Weiss 场：\n    $$\\mathcal{G}_0^{-1}(i\\omega_n) = i\\omega_n + \\mu - \\Delta(i\\omega_n)$$\n\n为了找到 $\\Delta(i\\omega_n)$ 的表达式，我们将第二个方程代入第一个方程：\n$$G_{\\text{loc}}^{-1}(i\\omega_n) = (i\\omega_n + \\mu - \\Delta(i\\omega_n)) - \\Sigma(i\\omega_n)$$\n现在，我们可以通过代数重排此方程来求解 $\\Delta(i\\omega_n)$：\n$$\\Delta(i\\omega_n) = i\\omega_n + \\mu - \\Sigma(i\\omega_n) - G_{\\text{loc}}^{-1}(i\\omega_n)$$\n这就是所要求的杂化函数的一般表达式。\n\n**第二部分：特定情况下 $\\Delta(i\\omega_n)$ 的计算**\n\n我们已知一个具有以下条件的特殊情况：\n-   化学势：$\\mu=0$。\n-   自能：$\\Sigma(i\\omega_n) = \\frac{U^2}{4\\,i\\omega_n}$。\n-   局域格林函数：$G_{\\text{loc}}(i\\omega_n) = \\frac{1}{\\,i\\omega_n - \\Sigma(i\\omega_n) - \\frac{V^2}{i\\omega_n - \\epsilon_b}\\,}$。\n\n首先，我们求出给定局域格林函数的逆：\n$$G_{\\text{loc}}^{-1}(i\\omega_n) = i\\omega_n - \\Sigma(i\\omega_n) - \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n现在，我们将此表达式以及 $\\mu=0$ 代入我们得到的 $\\Delta(i\\omega_n)$ 的一般公式中：\n$$\\Delta(i\\omega_n) = i\\omega_n + 0 - \\Sigma(i\\omega_n) - \\left( i\\omega_n - \\Sigma(i\\omega_n) - \\frac{V^2}{i\\omega_n - \\epsilon_b} \\right)$$\n$i\\omega_n$ 和 $\\Sigma(i\\omega_n)$ 项相互抵消：\n$$\\Delta(i\\omega_n) = (i\\omega_n - \\Sigma(i\\omega_n)) - (i\\omega_n - \\Sigma(i\\omega_n)) + \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n这简化为杂化函数的闭合形式表达式：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n请注意，此计算并不需要问题中提供的 $\\Sigma(i\\omega_n)$ 的具体形式，即 $\\Sigma(i\\omega_n) = \\frac{U^2}{4i\\omega_n}$，因为它被抵消了。该问题的结构旨在找出与给定局域格林函数形式相对应的杂化函数。\n\n**第三部分：虚部的验证**\n\n一个物理的杂化函数必须满足其对应的谱密度非负的条件。在虚频轴上，这转化为对于正的松原频率 $\\omega_n > 0$，条件为 $\\operatorname{Im}\\Delta(i\\omega_n) \\le 0$。问题定义了对于整数 $n$，$\\omega_n = (2n+1)\\pi/\\beta$。对于 $n \\ge 0$，我们有 $2n+1 \\ge 1$，并且由于 $\\beta > 0$，因此可得 $\\omega_n > 0$。\n\n让我们计算我们的结果 $\\Delta(i\\omega_n)$ 的虚部：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n我们通过将分子和分母同乘以分母的复共轭 $-i\\omega_n - \\epsilon_b$ 来使分母有理化：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{(i\\omega_n - \\epsilon_b)} \\frac{(-i\\omega_n - \\epsilon_b)}{(-i\\omega_n - \\epsilon_b)} = \\frac{V^2(-i\\omega_n - \\epsilon_b)}{-(i\\omega_n)^2 + \\epsilon_b^2} = \\frac{-V^2\\epsilon_b - iV^2\\omega_n}{\\omega_n^2 + \\epsilon_b^2}$$\n将其分离为实部和虚部：\n$$\\Delta(i\\omega_n) = \\left(-\\frac{V^2\\epsilon_b}{\\omega_n^2 + \\epsilon_b^2}\\right) + i \\left(-\\frac{V^2\\omega_n}{\\omega_n^2 + \\epsilon_b^2}\\right)$$\n因此，虚部为：\n$$\\operatorname{Im}\\Delta(i\\omega_n) = -\\frac{V^2\\omega_n}{\\omega_n^2 + \\epsilon_b^2}$$\n鉴于 $V>0$，我们有 $V^2>0$。如前所述，对于 $n \\ge 0$，$\\omega_n > 0$。分母 $\\omega_n^2 + \\epsilon_b^2$ 总是正的（因为 $\\omega_n \\neq 0$ 且 $\\epsilon_b$ 是实数）。因此，$\\operatorname{Im}\\Delta(i\\omega_n)$ 的整个表达式是一个正数的负值，这意味着它严格为负。\n$$\\operatorname{Im}\\Delta(i\\omega_n)  0 \\quad \\text{对于 } n \\ge 0$$\n这满足了所要求的条件 $\\operatorname{Im}\\Delta(i\\omega_n) \\le 0$。\n\n**第四部分：高频展开**\n\n我们被要求验证高频行为 $\\Delta(i\\omega_n) \\sim \\frac{C}{i\\omega_n} + \\mathcal{O}(\\frac{1}{\\omega_n^2})$ 并确定常数 $C$。我们从 $\\Delta(i\\omega_n)$ 的表达式开始，并针对大的 $\\omega_n$ 进行展开。\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n - \\epsilon_b}$$\n从分母中提出因子 $i\\omega_n$：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n\\left(1 - \\frac{\\epsilon_b}{i\\omega_n}\\right)} = \\frac{V^2}{i\\omega_n} \\left(1 - \\frac{\\epsilon_b}{i\\omega_n}\\right)^{-1}$$\n对于大的 $\\omega_n$，项 $|\\frac{\\epsilon_b}{i\\omega_n}|$ 远小于 $1$，所以我们可以使用几何级数展开 $(1-x)^{-1} = 1 + x + x^2 + \\dots$：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n} \\left(1 + \\frac{\\epsilon_b}{i\\omega_n} + \\mathcal{O}\\left(\\frac{1}{\\omega_n^2}\\right)\\right)$$\n分配前导项，我们得到展开式：\n$$\\Delta(i\\omega_n) = \\frac{V^2}{i\\omega_n} + \\frac{V^2\\epsilon_b}{(i\\omega_n)^2} + \\mathcal{O}\\left(\\frac{1}{\\omega_n^3}\\right) = \\frac{V^2}{i\\omega_n} - \\frac{V^2\\epsilon_b}{\\omega_n^2} + \\mathcal{O}\\left(\\frac{1}{\\omega_n^3}\\right)$$\n将此结果与指定的渐近形式 $\\Delta(i\\omega_n) \\sim \\frac{C}{i\\omega_n} + \\mathcal{O}(\\frac{1}{\\omega_n^2})$ 进行比较，我们可以清楚地看到展开式是匹配的。前导项是 $\\frac{V^2}{i\\omega_n}$，下一项的阶数为 $\\frac{1}{\\omega_n^2}$。\n通过直接比较，我们确定系数 $C$ 为：\n$$C = V^2$$\n这与由一组离散浴点产生的杂化函数的一般形式 $C = \\sum_{\\ell} V_{\\ell}^2$ 一致，在本例中，只有一个浴点，其耦合强度为 $V$。\n\n所要求的最终答案是 $\\Delta(i\\omega_n)$ 的闭合形式表达式。",
            "answer": "$$\n\\boxed{\\frac{V^2}{i\\omega_n - \\epsilon_b}}\n$$"
        },
        {
            "introduction": "Bethe 晶格是动力学平均场理论的基石，因为它在无限配位数极限下提供了一个极其简洁的自洽条件。这项编码练习为您提供了一个宝贵的动手实践机会，让您亲眼见证这一极限的实现过程 。您将通过实现通用的希尔伯特变换来计算局域格林函数，并数值验证有限配位晶格的结果如何收敛于著名的简化形式，从而在抽象公式和具体数值结果之间架起一座桥梁。",
            "id": "3446460",
            "problem": "考虑在半填充情况下的 Bethe 晶格的动力学平均场理论 (Dynamical Mean-Field Theory, DMFT) 自洽性，其中杂化函数 $\\Delta(i\\omega_n)$ 和局域格林函数 $G_{\\text{loc}}(i\\omega_n)$ 出现在杂质 Dyson 方程中。杂质 Dyson 方程为\n$$\nG_{\\text{loc}}(i\\omega_n)^{-1} = i\\omega_n + \\mu - \\Sigma(i\\omega_n) - \\Delta(i\\omega_n),\n$$\n其中 $i\\omega_n$ 是虚 Matsubara 频率，$\\mu$ 是化学势，$\\Sigma(i\\omega_n)$ 是局域自能。对于半填充，设 $\\mu = 0$。\n\n对于 Bethe 晶格，在无限连通性（配位数）$z \\to \\infty$ 的极限下，并采用跃迁振幅 $t \\mapsto t/\\sqrt{z}$ 的标准标度，无相互作用的态密度 (Density Of States, DOS) 变为半圆形，其半带宽为 $2t$，DMFT 自洽性简化为\n$$\n\\Delta(i\\omega_n) = t^2 \\, G_{\\text{loc}}(i\\omega_n).\n$$\n另外，局域格林函数也可以通过对晶格态密度 $D(\\epsilon)$ 进行 Hilbert 变换来计算\n$$\nG_{\\text{loc}}(i\\omega_n) = \\int_{-\\infty}^{+\\infty} d\\epsilon \\, \\frac{D(\\epsilon)}{i\\omega_n - \\Sigma(i\\omega_n) - \\epsilon}.\n$$\n在无限连通性极限下，半圆形 DOS 为\n$$\nD_{\\text{semi}}(\\epsilon) = \\frac{1}{2\\pi t^2}\\sqrt{4t^2 - \\epsilon^2}, \\quad |\\epsilon| \\le 2t, \\quad \\text{以及} \\quad D_{\\text{semi}}(\\epsilon)=0 \\text{ 在其他情况下}.\n$$\n对于有限连通性 $z \\ge 3$，一个实际的 Bethe 晶格 DOS 模型由适用于 $z$-正则随机图的 Kesten–McKay 分布给出，并经过标度以保持半带宽等于 $2t$：\n$$\nD_z(\\epsilon) = \\frac{z(z-1)}{2\\pi t} \\, \\frac{\\sqrt{4 - \\epsilon^2/t^2}}{z^2 - \\frac{(z-1)\\epsilon^2}{t^2}}, \\quad |\\epsilon| \\le 2t, \\quad \\text{以及} \\quad D_z(\\epsilon)=0 \\text{ 在其他情况下}.\n$$\n在所有情况下，通过 Dyson 方程得到的杂化函数为\n$$\n\\Delta_{\\text{Dyson}}(i\\omega_n) = i\\omega_n - \\Sigma(i\\omega_n) - \\left[G_{\\text{loc}}(i\\omega_n)\\right]^{-1}.\n$$\n\n你的任务是编写一个完整的程序，该程序：\n- 通过对态密度 $D(\\epsilon)$ 在 $\\epsilon \\in [-2t,2t]$ 上进行数值积分，来实现 $G_{\\text{loc}}(i\\omega_n)$ 的计算，其中使用上述半圆形 DOS $D_{\\text{semi}}(\\epsilon)$ 或有限连通性 Kesten–McKay DOS $D_z(\\epsilon)$ 的表达式。\n- 在虚轴上使用一个物理上合理的、由下式定义的实值局域自能：\n$$\n\\Sigma(i\\omega_n) = \\frac{U^2}{\\omega_n^2 + \\omega_0^2},\n$$\n其中 $U$ 和 $\\omega_0$ 是正参数。\n- 对于给定的一组 Matsubara 指数 $\\{n_j\\}$ 和逆温度 $\\beta$，使用费米子 Matsubara 频率：\n$$\n\\omega_{n_j} = \\frac{\\pi}{\\beta} \\left(2n_j + 1\\right).\n$$\n- 对于每个测试用例，计算在指定的 Matsubara 频率上，DMFT Bethe 晶格自洽性 $\\Delta(i\\omega_n) = t^2 G_{\\text{loc}}(i\\omega_n)$ 与通过 DOS 积分和 Dyson 方程构造的杂化函数 $\\Delta_{\\text{Dyson}}(i\\omega_n)$ 之间的最大绝对偏差。具体来说，计算\n$$\n\\delta_{\\max} = \\max_{n_j} \\left| \\Delta_{\\text{Dyson}}(i\\omega_{n_j}) - t^2 \\, G_{\\text{loc}}(i\\omega_{n_j}) \\right|.\n$$\n此问题中的所有量都是无量纲的，因此不需要物理单位。\n\n测试套件：\n- 案例 $1$ (通过 $D_{\\text{semi}}$ 的无限连通性基准)：使用半圆形 DOS；参数 $t = 1.0$，$\\beta = 50.0$，$U = 2.0$，$\\omega_0 = 1.5$，Matsubara 指数 $\\{0,1,2,10,50,200\\}$。\n- 案例 $2$ (中等有限 $z$)：使用 Kesten–McKay DOS，其中 $z = 6$；参数 $t = 1.0$，$\\beta = 50.0$，$U = 2.0$，$\\omega_0 = 1.5$，Matsubara 指数 $\\{0,1,2,10,50,200\\}$。\n- 案例 $3$ (较大有限 $z$)：使用 Kesten–McKay DOS，其中 $z = 20$；参数 $t = 1.0$，$\\beta = 50.0$，$U = 2.0$，$\\omega_0 = 1.5$，Matsubara 指数 $\\{0,1,2,10,50,200\\}$。\n- 案例 $4$ (非常大的有限 $z$)：使用 Kesten–McKay DOS，其中 $z = 1000$；参数 $t = 1.0$，$\\beta = 50.0$，$U = 2.0$，$\\omega_0 = 1.5$，Matsubara 指数 $\\{0,1,2,10,50,200\\}$。\n\n你的程序应产生单行输出，其中包含四个案例的结果，格式为方括号内用逗号分隔的列表，例如 $[\\delta_1,\\delta_2,\\delta_3,\\delta_4]$，其中每个 $\\delta_k$ 是对应案例计算出的 $\\delta_{\\max}$，表示为浮点数。",
            "solution": "问题陈述是凝聚态物理领域，特别是动力学平均场理论（Dynamical Mean-Field Theory, DMFT）框架下的一个有效计算练习。所有提供的方程、参数和定义都是科学上合理、一致且定义明确的。任务是计算一个具体、可验证的数值量，以阐释 DMFT 中的一个关键概念：Bethe 晶格的电子性质向其无限配位极限的收敛。我们将提供一个完整的解决方案。\n\n问题的核心是对于给定的局域自能 $\\Sigma(i\\omega_n)$，比较杂化函数 $\\Delta(i\\omega_n)$ 的两种不同表达式。第一个表达式 $\\Delta_{\\text{Bethe}}(i\\omega_n) = t^2 G_{\\text{loc}}(i\\omega_n)$，是在无限配位数 ($z \\to \\infty$) 极限下 Bethe 晶格的精确 DMFT 自洽条件，此时无相互作用的态密度 (DOS) 是半圆形的。第二个表达式 $\\Delta_{\\text{Dyson}}(i\\omega_n)$ 是从通用的杂质 Dyson 方程推导出来的，该方程对任何系统都成立：\n$$\n\\Delta_{\\text{Dyson}}(i\\omega_n) = i\\omega_n + \\mu - \\Sigma(i\\omega_n) - G_{\\text{loc}}(i\\omega_n)^{-1}\n$$\n在此问题中，我们处于半填充状态，因此化学势 $\\mu=0$。局域格林函数 $G_{\\text{loc}}(i\\omega_n)$ 是通过对给定的无相互作用 DOS $D(\\epsilon)$ 进行 Hilbert 变换计算得出的：\n$$\nG_{\\text{loc}}(i\\omega_n) = \\int_{-\\infty}^{+\\infty} d\\epsilon \\, \\frac{D(\\epsilon)}{i\\omega_n - \\Sigma(i\\omega_n) - \\epsilon}\n$$\n问题要求计算在几个案例中最大绝对偏差 $\\delta_{\\max} = \\max_{n_j} |\\Delta_{\\text{Dyson}}(i\\omega_{n_j}) - \\Delta_{\\text{Bethe}}(i\\omega_{n_j})|$。该偏差量化了当使用对应于有限配位晶格的 DOS 时，近似的无限配位自洽条件的成立程度。\n\n过程步骤如下：\n\n1.  **定义输入量**：对于每个测试用例，我们都给定了跃迁 ($t$)、逆温度 ($\\beta$)、自能 ($U, \\omega_0$) 的参数以及 DOS 的形式。我们首先为一组 Matsubara 指数 $\\{n_j\\}$ 计算必要的物理量。\n    -   费米子 Matsubara 频率由 $\\omega_n = \\frac{\\pi}{\\beta}(2n+1)$ 给出。\n    -   虚轴上的局域自能由实值函数 $\\Sigma(i\\omega_n) = \\frac{U^2}{\\omega_n^2 + \\omega_0^2}$ 给出。\n\n2.  **选择态密度 (DOS)**：使用两种形式的 DOS，两者都定义在区间 $\\epsilon \\in [-2t, 2t]$ 上。\n    -   对于无限配位极限 ($z \\to \\infty$)，半圆形 DOS 为：\n        $$\n        D_{\\text{semi}}(\\epsilon) = \\frac{1}{2\\pi t^2}\\sqrt{4t^2 - \\epsilon^2}\n        $$\n    -   对于有限配位数 $z$，Kesten–McKay DOS 为：\n        $$\n        D_z(\\epsilon) = \\frac{z(z-1)}{2\\pi t} \\, \\frac{\\sqrt{4 - \\epsilon^2/t^2}}{z^2 - \\frac{(z-1)\\epsilon^2}{t^2}}\n        $$\n\n3.  **计算局域格林函数**：对于每个 Matsubara 频率 $\\omega_n$，我们通过在能量支撑区间 $\\epsilon \\in [-2t, 2t]$ 上对复值被积函数进行数值积分来计算 $G_{\\text{loc}}(i\\omega_n)$。对于每个固定的 $n$，被积函数的分母是 $Z_n - \\epsilon$，其中 $Z_n = i\\omega_n - \\Sigma(i\\omega_n)$ 是一个复常数。\n    $$\n    G_{\\text{loc}}(i\\omega_n) = \\int_{-2t}^{2t} d\\epsilon \\, \\frac{D(\\epsilon)}{i\\omega_n - \\Sigma(i\\omega_n) - \\epsilon}\n    $$\n    该积分可以使用能够处理复值函数的标准数值求积程序高效地计算，例如 `scipy.integrate.quad`。\n\n4.  **计算偏差**：在获得给定 $\\omega_n$ 的 $G_{\\text{loc}}(i\\omega_n)$ 后，我们计算两种杂化函数：\n    -   $\\Delta_{\\text{Bethe}}(i\\omega_n) = t^2 G_{\\text{loc}}(i\\omega_n)$\n    -   $\\Delta_{\\text{Dyson}}(i\\omega_n) = i\\omega_n - \\Sigma(i\\omega_n) - G_{\\text{loc}}(i\\omega_n)^{-1}$\n    然后计算绝对差 $| \\Delta_{\\text{Dyson}}(i\\omega_n) - \\Delta_{\\text{Bethe}}(i\\omega_n) |$。\n\n5.  **确定最大偏差**：对所有指定的 Matsubara 指数 $\\{n_j\\}$ 重复上述步骤。计算出的绝对差中的最大值即为该测试用例的结果 $\\delta_{\\max}$。\n\n**预期的物理行为**：\n-   对于案例 1（半圆形 DOS），关系式 $\\Delta(i\\omega_n) = t^2 G_{\\text{loc}}(i\\omega_n)$ 由半圆形的 Hilbert 变换的解析性质内在地满足。因此，计算出的 $\\delta_{\\max}$ 应接近于零，仅受数值积分精度的限制。此案例可作为验证实现正确性的关键基准。\n-   对于案例 2、3 和 4，我们使用对应于有限 $z$ 的 Kesten–McKay DOS。随着 $z$ 的增加，$D_z(\\epsilon)$ 收敛于 $D_{\\text{semi}}(\\epsilon)$。因此，我们预期计算出的偏差 $\\delta_{\\max}$ 不为零，但会随着 $z$ 的增加而系统性地减小，并接近 $z \\to \\infty$ 案例的近零值。这一趋势展示了有限配位 Bethe 晶格向其平均场极限的收敛。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the maximum deviation between two forms of the hybridization function\n    in DMFT for different Bethe lattice DOS models.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'dos_type': 'semi', 't': 1.0, 'beta': 50.0, 'U': 2.0, 'w0': 1.5, 'n_indices': [0, 1, 2, 10, 50, 200]},\n        {'dos_type': 'km',   'z': 6,    't': 1.0, 'beta': 50.0, 'U': 2.0, 'w0': 1.5, 'n_indices': [0, 1, 2, 10, 50, 200]},\n        {'dos_type': 'km',   'z': 20,   't': 1.0, 'beta': 50.0, 'U': 2.0, 'w0': 1.5, 'n_indices': [0, 1, 2, 10, 50, 200]},\n        {'dos_type': 'km',   'z': 1000, 't': 1.0, 'beta': 50.0, 'U': 2.0, 'w0': 1.5, 'n_indices': [0, 1, 2, 10, 50, 200]},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        t = case['t']\n        beta = case['beta']\n        U = case['U']\n        w0 = case['w0']\n        n_indices = case['n_indices']\n        dos_type = case['dos_type']\n        \n        t2 = t * t\n\n        # Define the Density of States (DOS) function\n        if dos_type == 'semi':\n            def dos(eps):\n                if np.abs(eps) > 2 * t:\n                    return 0.0\n                return (1.0 / (2 * np.pi * t2)) * np.sqrt(4 * t2 - eps**2)\n        elif dos_type == 'km':\n            z = case['z']\n            def dos(eps):\n                if np.abs(eps) > 2 * t:\n                    return 0.0\n                eps2 = eps**2\n                term1 = np.sqrt(4.0 - eps2 / t2)\n                term2 = z**2 - (z - 1.0) * eps2 / t2\n                # The denominator is non-zero for z>=3 and |eps| = 2t\n                return (z * (z - 1.0) / (2 * np.pi * t)) * (term1 / term2)\n        \n        # Define the self-energy function\n        def self_energy(wn):\n            return U**2 / (wn**2 + w0**2)\n\n        deviations = []\n        for n in n_indices:\n            # Calculate Matsubara frequency\n            wn = (np.pi / beta) * (2 * n + 1)\n            \n            # Calculate self-energy for the current frequency\n            sigma = self_energy(wn)\n            \n            # Define the integrand for the Green's function calculation\n            # G_loc = integral( D(eps) / (i*wn - sigma - eps) d_eps )\n            integrand = lambda eps: dos(eps) / (1j * wn - sigma - eps)\n            \n            # Perform numerical integration to get the local Green's function\n            g_loc, _ = quad(integrand, -2 * t, 2 * t, complex_func=True)\n\n            # Calculate the two forms of the hybridization function\n            # 1. From the infinite-z Bethe lattice self-consistency condition\n            delta_bethe = t2 * g_loc\n            \n            # 2. From the general Dyson equation (mu=0)\n            delta_dyson = 1j * wn - sigma - 1.0 / g_loc\n            \n            # Calculate the absolute deviation\n            deviation = np.abs(delta_dyson - delta_bethe)\n            deviations.append(deviation)\n            \n        # Find the maximum deviation for the current test case\n        max_deviation = np.max(deviations)\n        results.append(max_deviation)\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现代动力学平均场理论严重依赖于如连续时间杂化展开 (CT-HYB) 这样的量子蒙特卡洛求解器，但其输出的数据存在统计噪声和自相关性。这项练习挑战您设计一套稳健的数据分析工作流程，涵盖了通过分箱（binning）处理自相关、估算完整的协方差矩阵以及利用物理约束提高精度等关键议题 。它突出了粗略分析与对于产出可靠科学结果至关重要的统计学严谨方法之间的区别。",
            "id": "3446426",
            "problem": "在动力学平均场理论（DMFT）中，杂质问题通常通过连续时间混合展开（CT-HYB）量子蒙特卡洛方法求解。该方法生成一个根据虚时作用量分布的混合构型的马尔可夫链。我们的目标是估计杂质格林函数 $G(\\tau)$、其松原频率表示 $G(i\\omega_n)$ 以及 $G$ 的高频矩，同时量化和控制统计误差与自相关。从轨道/自旋指标 $\\alpha,\\beta$ 的定义 $G_{\\alpha\\beta}(\\tau) = -\\langle T_\\tau c_\\alpha(\\tau)c_\\beta^\\dagger(0)\\rangle$ 出发，并基于针对相关样本的马尔可夫链蒙特卡洛（MCMC）原理（遍历性、平稳性、自相关和分块的定义），请确定一个用于 CT-HYB 的正确的估计量和误差分析工作流程设计。该设计应确保对 $G(\\tau)$ 及其高频矩的无偏性，并恰当地处理统计误差和自相关。考虑分箱策略、跨 $\\tau$ 或多项式基的协方差估计，以及使用短时/运动方程恒等式来计算矩。\n\n以下哪个选项是正确的？可能存在多个正确选项。\n\nA. 通过在每个具有 $k$ 个混合算符对的构型中，记录湮灭算符的时间 $\\{\\tau_i\\}$、产生算符的时间 $\\{\\tau_j'\\}$ 以及逆混合矩阵 $\\mathcal{M}$（由混合函数条目构建的 $k\\times k$ 矩阵的逆矩阵），来构建 $G_{\\alpha\\beta}(\\tau)$。使用构型层面的估计量\n$$\nG_{\\alpha\\beta}(\\tau) = -\\left\\langle \\frac{1}{\\beta}\\sum_{i,j=1}^{k} \\mathcal{M}_{j i}^{(\\alpha\\beta)}\\, \\delta\\big(\\tau - [\\tau_i - \\tau_j']_{\\beta}\\big) \\right\\rangle,\n$$\n其中 $[\\cdot]_{\\beta}$ 表示在 $[0,\\beta)$ 上的周期性包裹，尖括号表示马尔可夫链平均。将 $\\delta$ 事件直方图化到有限的 $\\tau$ 箱中，以形成具有受控箱宽的 $G(\\tau)$。通过运动方程对易子恒等式来估计高频矩，\n$$\nG(i\\omega_n) = \\frac{M_0}{i\\omega_n} + \\frac{M_1}{(i\\omega_n)^2} + \\frac{M_2}{(i\\omega_n)^3} + \\cdots,\\quad M_m = \\left\\langle \\big\\{ \\mathrm{ad}^m_{H_{\\mathrm{loc}}} c_\\alpha, c_\\alpha^\\dagger \\big\\} \\right\\rangle,\n$$\n其中 $\\mathrm{ad}_{H}(X) = [H,X]$ 且 $H_{\\mathrm{loc}}$ 是局域哈密顿量；对于密度-密度相互作用，这简化为等时关联函数，例如 $\\langle n_\\gamma\\rangle$ 和 $\\langle n_\\gamma n_{\\gamma'}\\rangle$。对马尔可夫链执行非重叠分块（binning），块长度 $b$ 的选择需满足 $b \\gg \\tau_{\\mathrm{int}}$（从一个慢弛豫观测量，如微扰阶数 $k$，估计出的积分自相关时间），并通过块平均值 $\\mathbf{g}_b$ 计算 $G(\\tau)$ 向量的完整协方差矩阵\n$$\n\\hat{\\Sigma} = \\frac{1}{N_b - 1} \\sum_{b=1}^{N_b} \\big(\\mathbf{g}_b - \\bar{\\mathbf{g}}\\big)\\big(\\mathbf{g}_b - \\bar{\\mathbf{g}}\\big)^\\top,\n$$\n其中 $N_b$ 是块的数量，$\\bar{\\mathbf{g}}$ 是块平均值的均值。使用刀切法（jackknife）或自助法（bootstrap）对块进行操作，以将误差传播到 $G(i\\omega_n)$，并强制执行精确的短时不连续性 $G(0^+) - G(0^-) = -1$ 以减少偏差。\n\nB. 将在每个蒙特卡洛步骤记录的 $G(\\tau)$ 进行平均，不进行任何分箱处理，并假设样本独立，将误差估计为 $\\sigma/\\sqrt{N}$，其中 $\\sigma$ 是样本标准差，N 是步骤数。通过将大 $n$ 处的 $G(i\\omega_n)$ 线性最小二乘拟合到尾部 $a_1/(i\\omega_n) + a_2/(i\\omega_n)^2 + \\cdots$ 来获得高频矩，忽略不同 $n$ 之间的协方差，并根据方便性而非自相关来设置箱大小。假设不同的 $\\tau$ 点是独立的，因此协方差矩阵是对角的。\n\nC. 仅在频率空间中，通过在每一步进行离散傅里叶变换来测量 $G(\\tau)$，并将 $G(i\\omega_n)$ 的协方差估计为对角矩阵，其对角元为 $1/N$。通过要求 Metropolis 接受率超过 0.5 来选择分箱，这保证了连续样本的独立性。直接从最大可用 $n$ 处的数值 $G(i\\omega_n)$ 计算高频矩，而不使用等时关联函数或运动方程关系式。\n\nD. 在 CT-HYB 中，完全依赖虫洞算法（worm-insertion）的变体来测量 $G(\\tau)$，因为移除混合线是有偏的。使用重叠分箱来增加统计量以估计协方差，并通过对 $G(\\tau)$ 本身使用指数模型来拟合自相关时间。通过带有符号重加权的连续时间团簇展开来确定高频矩，并且不使用等时对易子恒等式，因为它们在 CT-HYB 中不适用。\n\nE. 将 $G(\\tau)$ 在正交多项式基中展开，例如在 $[0,\\beta]$ 上的勒让德多项式，在 CT-HYB 运行期间直接测量系数 $G_\\ell$ 以减少噪声和箱间协方差。通过系数向量的线性变换重构 $G(\\tau)$ 和 $G(i\\omega_n)$，并根据从慢退关联观测量（如微扰阶数 $k$ 或占据数）估计的 $\\tau_{\\mathrm{int}}$ 来选择块大小 $b$，从非重叠块的平均值估计系数空间中的协方差矩阵。通过相应的线性映射将协方差传播到时间/频率空间。通过以 CT-HYB 中测量的等时关联函数（例如 $\\langle n_\\gamma\\rangle$、$\\langle n_\\gamma n_{\\gamma'}\\rangle$）表示的短时/运动方程恒等式来获得高频矩 $M_m$，而不是拟合噪声大的大 $n$ 尾部，并强制执行 $G(0^+) - G(0^-) = -1$ 来固定 $M_0$。\n\n选择所有正确的选项。",
            "solution": "问题要求为连续时间混合展开（CT-HYB）量子蒙特卡洛模拟确定一个正确且稳健的后验数据分析工作流程。这涉及估计杂质格林函数 $G(\\tau)$ 及其相关量，并恰当控制源于马尔可夫链蒙特卡洛（MCMC）样本相关性的统计误差。\n\n一个正确工作流程的核心原则是：\n1.  **无偏估计量**：物理量的估计量对于给定构型必须是形式上精确的，使得它们在无限长、完美采样的马尔可夫链上的平均值收敛到真实的量子统计平均值。\n2.  **正确的误差分析**：误差估计必须考虑 MCMC 中固有的自相关性。这通常通过块平均（分箱）实现，块大小需远大于积分自相关时间 $\\tau_{\\mathrm{int}}$。\n3.  **协方差处理**：像格林函数这样的物理量是函数，例如 $G(\\tau)$。它在不同点（$\\tau_i$, $\\tau_j$）或不同基表示（$G_\\ell$, $G_{\\ell'}$）的值在统计上是相关的。有效的误差分析必须计算并传播完整的协方差矩阵，而不仅仅是对角方差。\n4.  **稳健性与物理约束**：工作流程应利用精确的物理定律和恒等式来提高准确性并减少统计噪声。这包括从运动方程导出的高频矩关系和诸如正则反对易关系的和规则。\n\n我们现在将根据这些原则评估每个选项。\n\n### 选项 A 分析\n\n该选项提出了一个基于 $G(\\tau)$ 在直方图网格上的实空间表示的工作流程。\n- **$G(\\tau)$ 的估计量**：所提供的公式 $G_{\\alpha\\beta}(\\tau) = -\\left\\langle \\frac{1}{\\beta}\\sum_{i,j=1}^{k} \\mathcal{M}_{j i}^{(\\alpha\\beta)}\\, \\delta\\big(\\tau - [\\tau_i - \\tau_j']_{\\beta}\\big) \\right\\rangle$ 是 CT-HYB 中一个公认且精确的格林函数“改进估计量”。它是通过在由混合算符定义的固定构型内，对 $G(\\tau)$ 的表达式应用威克定理得出的。使用具有受控箱宽的直方图是标准的实际实现方式。这部分是正确的。\n- **高频矩**：提议使用运动方程恒等式，其中矩 $M_m$ 与等时对易子相关，$M_m = \\left\\langle \\big\\{ \\mathrm{ad}^m_{H_{\\mathrm{loc}}} c_\\alpha, c_\\alpha^\\dagger \\big\\} \\right\\rangle$，这是最先进的方法。对于涉及密度-密度相互作用的典型局域哈密顿量 $H_{\\mathrm{loc}}$，这些对易子可简化为等时关联函数（例如 $\\langle n_\\gamma \\rangle$, $\\langle n_\\gamma n_{\\gamma'} \\rangle$），这些函数可以在模拟中以高精度和低噪声进行测量。这远优于拟合 $G(i\\omega_n)$ 的高噪声高频尾部。这是正确的。\n- **误差分析**：提议的程序是严格 MCMC 误差分析的教科书标准。\n    - 使用长度为 $b \\gg \\tau_{\\mathrm{int}}$ 的非重叠块可确保块平均值近似独立。\n    - 从慢弛豫观测量（如微扰阶数 $k$）估计 $\\tau_{\\mathrm{int}}$ 是确定安全块大小的稳健方法。\n    - 从块平均值计算样本协方差矩阵 $\\hat{\\Sigma}$ 的公式是均值协方差的正确估计量。\n    - 使用如刀切法或自助法等重采样技术将此完整协方差矩阵传播到派生量（如 $G(i\\omega_n)$）在统计上是合理的。\n- **物理约束**：强制执行精确的短时不连续性 $G(0^+) - G(0^-) = -\\langle \\{ c, c^\\dagger \\} \\rangle = -1$ 是减少系统偏差和统计不确定性的关键步骤，特别是对于零阶矩 $M_0=1$。这是正确的。\n\n**结论**：选项 A 描述了一个完整、科学上合理且统计上严格的工作流程。它代表了 CT-HYB 计算的一套标准最佳实践。**正确**。\n\n### 选项 B 分析\n\n该选项提出了一个简化但有缺陷的工作流程。\n- **误差分析**：核心缺陷是提议“假设样本独立，将误差估计为 $\\sigma/\\sqrt{N}$”。MCMC 样本是相关的，忽略这一点（即忽略自相关时间 $\\tau_{\\mathrm{int}}$）会导致对真实统计误差的严重低估。这违反了 MCMC 数据分析的基本原则。\n- **协方差**：假设不同 $\\tau$ 点的协方差矩阵是对角的是不正确的。$G(\\tau)$ 估计量的统计波动在不同的 $\\tau$ 值之间是相关的。\n- **高频矩**：拟合 $G(i\\omega_n)$ 的高噪声高频尾部是众所周知的数值不稳定和不可靠的方法。在拟合过程中忽略不同频率 $i\\omega_n$ 之间的协方差是另一个使该过程无效的统计错误。\n- **分箱**：建议“根据方便性而非自相关来设置箱大小”直接违背了正确的 MCMC 程序。\n\n**结论**：选项 B 存在根本性缺陷，代表了一种幼稚且不正确的 MCMC 数据分析方法。**不正确**。\n\n### 选项 C 分析\n\n该选项建议在频率空间中进行测量，但包含几个错误。\n- **协方差估计**：它表明 $G(i\\omega_n)$ 的协方差是对角的，对角元为 $1/N$。这在两方面都是错误的：它假设不同频率之间没有相关性，并且忽略了 MCMC 时间序列中的自相关（缺少了因子 $2\\tau_{\\mathrm{int}}$）。\n- **分箱策略**：它提议根据 Metropolis 接受率来选择箱大小。接受率和自相关时间并非直接成正比。一个链可以有很高的接受率，但如果提议的步长很小，其自相关时间仍然可能很长。这是一个无效的启发式方法。\n- **高频矩**：它主张使用从数值 $G(i\\omega_n)$ 数据的高噪声尾部提取矩的不可靠方法，并明确拒绝了基于运动方程恒等式的更优方法。\n\n**结论**：选项 C 在统计方法和物理分析上犯了多个根本性错误，与选项 B 类似。**不正确**。\n\n### 选项 D 分析\n\n该选项包含关于 CT-HYB 方法本身的 factual 错误。\n- **方法偏差**：声称标准方法（基于移除/添加混合线，导致行列式结构）是“有偏的”是错误的。基于行列式的 CT-HYB 算法是一种精确采样方法。虫洞算法是另一种，通常更高效的精确采样方法，而不是对“有偏”方法的“修复”。\n- **运动方程的适用性**：声称等时对易子恒等式“在 CT-HYB 中不适用”是错误的。高频矩与涉及局域哈密顿量 $H_{\\mathrm{loc}}$ 的对易子有关，而由此产生的等时关联函数在 CT-HYB 框架（或任何其他对完整配分函数进行采样的方​​法）内是完全定义明确且可测量的。\n- **其他要点**：虽然使用重叠分箱是一种有效的技术，但上述两个关键的事实错误使整个选项无效。\n\n**结论**：选项 D 基于关于标准 CT-HYB 有效性和基本物理关系适用性的错误前提。**不正确**。\n\n### 选项 E 分析\n\n该选项提出了一个使用正交多项式基的先进工作流程。\n- **基展开**：使用像勒让德多项式这样的正交基来表示 $G(\\tau)$ 是一种强大而现代的技术。它起到数据压缩和正则化的作用，通常能得到一个更紧凑的表示，其协方差矩阵比精细的 $\\tau$ 网格更小且条件数更好。这是一个有效且通常有利的方法。测量系数 $G_\\ell$ 以及随后通过线性变换重构 $G(\\tau)$ 和 $G(i\\omega_n)$ 是此基下的标准程序。\n- **误差分析**：提议的误差分析——使用具有适当选择的块大小 $b \\gg \\tau_{\\mathrm{int}}$ 的非重叠块平均法来计算系数 $\\{G_\\ell\\}$ 的协方差矩阵——是正确的统计程序，与选项 A 中的程序完美类似，但应用于多项式基。通过相应的线性映射传播此协方差也是正确的。\n- **高频矩**：该选项正确地主张使用运动方程恒等式从直接测量的等时关联函数中计算矩，避免了拟合高噪声数据的陷阱。这与最佳实践一致。\n- **物理约束**：它正确地包括了强制执行 $M_0=1$ 的和规则，这在勒让德基中转化为对偶次系数的线性约束。\n\n**结论**：选项 E 描述了一个完整、统计上严格且高效的现代 CT-HYB 工作流程。每一步都是合理的。它代表了一个优秀的替代方案，并且在某些方面是对选项 A 中工作流程的改进。**正确**。",
            "answer": "$$\\boxed{AE}$$"
        }
    ]
}