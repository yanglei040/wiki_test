{
    "hands_on_practices": [
        {
            "introduction": "Before applying any computational tool, it is essential to understand its underlying structure. This exercise requires you to derive the total energy expression for a global hybrid functional from first principles. By explicitly writing out each component—from kinetic energy to the mix of exact and semilocal exchange—and analyzing its computational scaling, you will gain a foundational understanding of the anatomy of these powerful electronic structure methods .",
            "id": "3457641",
            "problem": "Consider a finite, spin-restricted closed-shell system in atomic units, described within Kohn–Sham Density Functional Theory (DFT). The system has occupied spatial orbitals $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{occ}}}$, each doubly occupied, with electron density $\\rho(\\mathbf{r}) = 2 \\sum_{i=1}^{N_{\\mathrm{occ}}} |\\phi_i(\\mathbf{r})|^{2}$. The total Kohn–Sham energy is decomposed into the noninteracting kinetic energy, the external potential energy, the classical electron–electron electrostatic (Hartree) energy, and the exchange–correlation energy. A global hybrid exchange–correlation functional mixes a fixed fraction $a \\in [0,1]$ of Hartree–Fock (HF) exchange with semi-local exchange, while keeping semi-local correlation.\n\nStarting only from these core definitions and the general properties of exchange and correlation in DFT and Hartree–Fock theory, do the following:\n\n- Derive the explicit orbital-integral expressions for every term entering the total energy of a global hybrid functional with mixing $a$, namely the noninteracting kinetic energy, external potential energy, Hartree energy, Hartree–Fock exchange energy, semi-local exchange energy, and semi-local correlation energy, all written in terms of $\\{\\phi_i\\}$ and $\\rho(\\mathbf{r})$.\n\n- For each term, state its leading-order scaling with the number of electrons $N = 2 N_{\\mathrm{occ}}$ in a sequence of size-increasing, neutral, closed-shell systems, and its leading-order computational-work scaling with the number of basis functions $M$ in a typical atom-centered Gaussian basis without auxiliary approximations (for example, without density fitting), identifying the dominant operation counts in the evaluation of that term.\n\n- Qualitatively assess how the completeness of the basis (increasing $M$ or, for plane waves, increasing the cutoff) affects the convergence of each energy term to its basis-set limit, highlighting which terms are most sensitive to basis completeness and why.\n\nYour final answer must be a single closed-form analytic expression that combines all terms to give the total energy of the global hybrid functional with mixing $a$ in terms of $\\{\\phi_i\\}$ and $\\rho(\\mathbf{r})$. No numerical evaluation is required. If you introduce any acronym, spell out its full name on first use. Use atomic units throughout.",
            "solution": "We begin from the foundational decomposition of the Kohn–Sham Density Functional Theory (DFT) total energy for a spin-restricted closed-shell system. The Kohn–Sham noninteracting kinetic energy arises from the single-particle orbitals, the external potential energy is the interaction of the density with the nuclear potential, the Hartree energy is the classical electrostatic energy of the density, and the exchange–correlation energy accounts for quantum exchange and correlation effects.\n\nWe use atomic units, where $\\hbar = 1$, electron mass $m_{e} = 1$, and the Coulomb constant is unity. For a spin-restricted closed-shell with occupied spatial orbitals $\\{\\phi_i\\}_{i=1}^{N_{\\mathrm{occ}}}$, the electron density is\n$$\n\\rho(\\mathbf{r}) = 2 \\sum_{i=1}^{N_{\\mathrm{occ}}} |\\phi_i(\\mathbf{r})|^{2}.\n$$\n\nThe Kohn–Sham noninteracting kinetic energy $T_{s}$ is the sum of single-particle kinetic energies for doubly occupied spatial orbitals. In atomic units, for each spatial orbital $\\phi_i(\\mathbf{r})$, the kinetic energy contribution per spin channel is $\\int \\frac{1}{2} |\\nabla \\phi_i(\\mathbf{r})|^{2} \\, d\\mathbf{r}$. Since the orbitals are doubly occupied, the total noninteracting kinetic energy can be written compactly as\n$$\nT_{s}[\\{\\phi_i\\}] = \\sum_{i=1}^{N_{\\mathrm{occ}}} \\int |\\nabla \\phi_i(\\mathbf{r})|^{2} \\, d\\mathbf{r}.\n$$\nThis uses the identity $2 \\times \\frac{1}{2} = 1$ per orbital in atomic units.\n\nThe external potential energy $V_{\\mathrm{ext}}$ is\n$$\nV_{\\mathrm{ext}}[\\rho] = \\int v_{\\mathrm{ext}}(\\mathbf{r}) \\, \\rho(\\mathbf{r}) \\, d\\mathbf{r},\n$$\nwhere $v_{\\mathrm{ext}}(\\mathbf{r})$ is the external (nuclear) potential.\n\nThe Hartree (classical Coulomb) energy of the density is\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\iint \\frac{\\rho(\\mathbf{r}) \\, \\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\, d\\mathbf{r} \\, d\\mathbf{r}'.\n$$\n\nThe Hartree–Fock (HF) exchange energy for a spin-restricted closed-shell, evaluated with the Kohn–Sham orbitals, can be expressed in terms of the occupied spatial orbitals as\n$$\nE_{x}^{\\mathrm{HF}}[\\{\\phi_i\\}] = - \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{j=1}^{N_{\\mathrm{occ}}} \\iint \\frac{\\phi_i(\\mathbf{r}) \\, \\phi_j(\\mathbf{r}) \\, \\phi_i(\\mathbf{r}') \\, \\phi_j(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\, d\\mathbf{r} \\, d\\mathbf{r}',\n$$\nwhere, for simplicity, we assume real orbitals; for complex orbitals, each $\\phi$ should be replaced by its complex conjugate where appropriate.\n\nThe semi-local exchange energy $E_{x}^{\\mathrm{sl}}[\\rho]$ and semi-local correlation energy $E_{c}^{\\mathrm{sl}}[\\rho]$ are functionals of the density (and possibly its gradients and other simple local descriptors). Without specifying a particular form (such as the Local Density Approximation (LDA) or Generalized Gradient Approximation (GGA)), we write them generically as spatial integrals of local energy densities:\n$$\nE_{x}^{\\mathrm{sl}}[\\rho] = \\int e_{x}^{\\mathrm{sl}}\\!\\left(\\rho(\\mathbf{r}), \\nabla \\rho(\\mathbf{r})\\right) \\, d\\mathbf{r},\n\\qquad\nE_{c}^{\\mathrm{sl}}[\\rho] = \\int e_{c}^{\\mathrm{sl}}\\!\\left(\\rho(\\mathbf{r}), \\nabla \\rho(\\mathbf{r})\\right) \\, d\\mathbf{r}.\n$$\n\nA global hybrid exchange–correlation functional mixes a fixed fraction $a \\in [0,1]$ of Hartree–Fock exchange with semi-local exchange and retains semi-local correlation. Therefore, the exchange–correlation energy in a global hybrid is\n$$\nE_{xc}^{\\mathrm{hyb}}[\\{\\phi_i\\},\\rho] = a \\, E_{x}^{\\mathrm{HF}}[\\{\\phi_i\\}] + (1 - a) \\, E_{x}^{\\mathrm{sl}}[\\rho] + E_{c}^{\\mathrm{sl}}[\\rho].\n$$\n\nCombining all terms, the total energy of the global hybrid functional with mixing $a$ is\n$$\nE^{\\mathrm{hyb}}[\\{\\phi_i\\},\\rho] = T_{s}[\\{\\phi_i\\}] + V_{\\mathrm{ext}}[\\rho] + E_{\\mathrm{H}}[\\rho] + a \\, E_{x}^{\\mathrm{HF}}[\\{\\phi_i\\}] + (1 - a) \\, E_{x}^{\\mathrm{sl}}[\\rho] + E_{c}^{\\mathrm{sl}}[\\rho].\n$$\nSubstituting the explicit forms above yields the final closed-form expression in terms of $\\{\\phi_i\\}$ and $\\rho(\\mathbf{r})$.\n\nWe now address the requested scaling analyses.\n\nLeading-order scaling with the number of electrons $N = 2 N_{\\mathrm{occ}}$ in neutral, finite, closed-shell systems:\n- $T_{s}[\\{\\phi_i\\}]$: As $N$ increases at fixed average density and chemical composition, the kinetic energy is extensive and scales as $\\mathcal{O}(N)$.\n- $V_{\\mathrm{ext}}[\\rho]$: For fixed nuclear charge distribution per electron, this scales as $\\mathcal{O}(N)$ (extensive).\n- $E_{\\mathrm{H}}[\\rho]$: The Hartree term counts electron–electron pairs and, in general, scales as $\\mathcal{O}(N^{2})$ in magnitude. For neutral finite systems, long-range cancellation in total energy may reduce net scaling in some contexts, but the bare Hartree contribution itself is pairwise and hence $\\mathcal{O}(N^{2})$.\n- $E_{x}^{\\mathrm{HF}}[\\{\\phi_i\\}]$: Exchange also counts same-spin electron pairs and scales as $\\mathcal{O}(N^{2})$ in magnitude for extended growth of similarly structured systems.\n- $E_{x}^{\\mathrm{sl}}[\\rho]$ and $E_{c}^{\\mathrm{sl}}[\\rho]$: Semi-local functionals integrate local energy densities and are extensive, scaling as $\\mathcal{O}(N)$.\n\nLeading-order computational-work scaling with the number of basis functions $M$ in a typical Gaussian atomic-orbital basis, using standard four-center integrals and no auxiliary approximations:\n- One-electron terms $T_{s}$ and $V_{\\mathrm{ext}}$: Constructing and contracting one-electron matrices with the density matrix scales as $\\mathcal{O}(M^{2})$ in energy evaluation (assuming integrals are precomputed or cheaply available).\n- $E_{\\mathrm{H}}$: Naively, four-center two-electron Coulomb integrals scale as $\\mathcal{O}(M^{4})$ to build, with energy evaluation and Fock-like contractions also $\\mathcal{O}(M^{4})$; with standard approximations (not assumed here), this can be reduced, but the leading naive scaling is $\\mathcal{O}(M^{4})$.\n- $E_{x}^{\\mathrm{HF}}$: The HF exchange energy involves the same class of four-center two-electron integrals and contractions and thus scales naively as $\\mathcal{O}(M^{4})$.\n- Semi-local $E_{x}^{\\mathrm{sl}}$ and $E_{c}^{\\mathrm{sl}}$: Evaluated on a numerical quadrature grid, the dominant cost is obtaining $\\rho(\\mathbf{r})$ and $\\nabla \\rho(\\mathbf{r})$ on the grid and performing grid integrations. If the grid size scales proportionally to $M$, typical contraction cost is between $\\mathcal{O}(M^{2})$ (density matrix to grid) and $\\mathcal{O}(M \\, N_{g})$ depending on implementation; the functional evaluation itself is $\\mathcal{O}(N_{g})$. In analytic AO approaches (less common for GGA), scaling can be kept near $\\mathcal{O}(M^{2})$.\n\nBasis completeness and convergence behavior:\n- $T_{s}$ and $V_{\\mathrm{ext}}$ depend on single-particle orbitals and their smoothness. In atom-centered Gaussian bases with systematically improvable sequences, energies converge rapidly (often near-exponential with increasing cardinality for bound states) as the orbitals are well represented. In plane-wave bases, convergence is controlled by the kinetic-energy cutoff; smooth orbitals yield relatively fast convergence in these terms.\n- $E_{\\mathrm{H}}$ depends on $\\rho(\\mathbf{r})$ and is comparatively less sensitive to subtle high-frequency components of the orbitals; with an accurate density, it converges steadily with basis set improvements or grid refinements. In plane waves, solving Poisson’s equation yields rapid and controllable convergence with cutoff.\n- $E_{x}^{\\mathrm{HF}}$ is nonlocal and depends on products of occupied orbitals at two points, $\\phi_i(\\mathbf{r}) \\phi_j(\\mathbf{r}')$, divided by $|\\mathbf{r}-\\mathbf{r}'|$. Accurate representation of these orbital products requires greater completeness in the underlying orbital product space. Consequently, $E_{x}^{\\mathrm{HF}}$ typically converges more slowly with basis size than the semi-local terms, and is sensitive to completeness in both angular and radial components (for Gaussian bases) or to high cutoff (for plane waves), reflecting its long-range, nonlocal character.\n- Semi-local $E_{x}^{\\mathrm{sl}}$ and $E_{c}^{\\mathrm{sl}}$ depend on $\\rho(\\mathbf{r})$ (and possibly $\\nabla \\rho(\\mathbf{r})$). Because the density is a sum of orbital squares, it is smoother than individual orbitals, and these terms generally converge more rapidly with basis improvements than $E_{x}^{\\mathrm{HF}}$. In plane-wave representations, gradients are well-controlled by the cutoff and converge systematically.\n\nFinally, assembling the explicit orbital-integral form for the total energy in a global hybrid with mixing $a$ yields the required analytic expression.",
            "answer": "$$\\boxed{\\sum_{i=1}^{N_{\\mathrm{occ}}} \\int |\\nabla \\phi_i(\\mathbf{r})|^{2} \\, d\\mathbf{r} \\;+\\; \\int v_{\\mathrm{ext}}(\\mathbf{r}) \\, \\rho(\\mathbf{r}) \\, d\\mathbf{r} \\;+\\; \\frac{1}{2} \\iint \\frac{\\rho(\\mathbf{r}) \\, \\rho(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\, d\\mathbf{r} \\, d\\mathbf{r}' \\;+\\; a \\left( - \\sum_{i=1}^{N_{\\mathrm{occ}}} \\sum_{j=1}^{N_{\\mathrm{occ}}} \\iint \\frac{\\phi_i(\\mathbf{r}) \\, \\phi_j(\\mathbf{r}) \\, \\phi_i(\\mathbf{r}') \\, \\phi_j(\\mathbf{r}')}{|\\mathbf{r} - \\mathbf{r}'|} \\, d\\mathbf{r} \\, d\\mathbf{r}' \\right) \\;+\\; (1 - a) \\int e_{x}^{\\mathrm{sl}}\\!\\left(\\rho(\\mathbf{r}), \\nabla \\rho(\\mathbf{r})\\right) \\, d\\mathbf{r} \\;+\\; \\int e_{c}^{\\mathrm{sl}}\\!\\left(\\rho(\\mathbf{r}), \\nabla \\rho(\\mathbf{r})\\right) \\, d\\mathbf{r}}$$"
        },
        {
            "introduction": "A primary motivation for developing hybrid functionals is their remarkable success in correcting the systematic underestimation of band gaps by semilocal functionals. This practice provides a hands-on opportunity to build an intuitive model that quantifies this band gap correction . By implementing a simplified first-order perturbation theory approach, you will explore how the inclusion of exact exchange widens the gap and how this effect is modulated by physical factors like dielectric screening and the orbital character of the band edges.",
            "id": "3457585",
            "problem": "You are asked to construct and implement a physically motivated, first-principles-inspired model that estimates the change in the fundamental band gap of a semiconductor upon introducing a hybrid exchange-correlation term with an exact-exchange mixing parameter $a = 0.25$. The model must be derived from the following foundational base: time-independent, non-degenerate first-order perturbation theory from quantum mechanics and the operator form of hybrid functionals in Kohn-Sham Density Functional Theory (DFT), where a fraction of Hartree-Fock (HF) exact exchange is mixed with a semilocal exchange potential from a Generalized Gradient Approximation (GGA). The goal is to reason from these principles to a computationally implementable expression for the band gap change and then quantify sensitivities to dielectric screening and the orbital character of band-edge states.\n\nStart from these well-tested principles and definitions:\n- In the Kohn-Sham framework of Density Functional Theory (DFT), the introduction of a hybrid exchange-correlation operator can be expressed as an additive perturbation to a reference Hamiltonian constructed with a semilocal functional (for example, a Generalized Gradient Approximation (GGA)). Denote the unperturbed Hamiltonian as $\\hat{H}_{0}$ and the hybrid Hamiltonian as $\\hat{H}(a)$, where $a$ is the fraction of exact exchange.\n- A screened hybrid may be modeled by scaling the exact-exchange perturbation by the high-frequency dielectric constant $\\epsilon_{\\infty}$ to emulate dielectric screening of nonlocal exchange in solids.\n- In time-independent, non-degenerate first-order perturbation theory, the first-order energy correction for a normalized eigenstate $\\lvert \\psi_{i} \\rangle$ of $\\hat{H}_{0}$ due to a perturbation $\\hat{W}$ is $\\Delta \\varepsilon_{i}^{(1)} = \\langle \\psi_{i} \\lvert \\hat{W} \\rvert \\psi_{i} \\rangle$.\n- The hybrid perturbation operator is the difference between the nonlocal Hartree-Fock exchange operator and the semilocal exchange potential, scaled by the mixing $a$ and the dielectric screening $\\epsilon_{\\infty}$.\n\nYou will translate these principles into a numerical model under the following scientifically standard and explicitly stated approximations:\n- The first-order change of the conduction-band minimum and valence-band maximum energies, denoted $\\Delta \\varepsilon_{c}$ and $\\Delta \\varepsilon_{v}$, is computed using first-order perturbation theory with the perturbation operator modeled as the screened exact-exchange-minus-semilocal-exchange difference.\n- The expectation value of this perturbation for a given band-edge state is approximated by an orbital-character-weighted sum over angular-momentum channels $\\ell \\in \\{ s, p, d \\}$:\n  $$\\langle \\psi_{i} \\lvert \\hat{W} \\rvert \\psi_{i} \\rangle \\approx \\sum_{\\ell \\in \\{s,p,d\\}} w_{i,\\ell} \\, M_{i}(\\ell),$$\n  where $w_{i,\\ell}$ are nonnegative weights that sum to unity, and $M_{i}(\\ell)$ are material- and edge-specific reference matrix elements (in electronvolts) tabulated for the unscreened, unit-mixing case ($a = 1$, $\\epsilon_{\\infty} = 1$).\n- For occupied valence states, the exact exchange typically lowers the energy relative to a semilocal reference, while for unoccupied conduction states it raises the energy, thereby opening the band gap. You will reflect this sign difference when forming the band gap change $\\Delta E_{g} = \\Delta \\varepsilon_{c} - \\Delta \\varepsilon_{v}$.\n\nYour program must, for each test case specified below, compute:\n- The band gap change $\\Delta E_{g}$ in electronvolts due to introducing $a = 0.25$ exact exchange with screening by $\\epsilon_{\\infty}$.\n- The sensitivity of the band gap change with respect to $\\epsilon_{\\infty}$, namely the derivative $\\frac{\\partial \\Delta E_{g}}{\\partial \\epsilon_{\\infty}}$, evaluated at the specified $\\epsilon_{\\infty}$.\n- The decomposition of $\\Delta E_{g}$ into contributions from each orbital channel for the conduction-band edge and the valence-band edge, defined as the positive additive terms that sum to $\\Delta E_{g}$:\n  $$C_{c,\\ell} \\;\\text{for}\\; \\ell \\in \\{s,p,d\\}, \\quad C_{v,\\ell} \\;\\text{for}\\; \\ell \\in \\{s,p,d\\}.$$\n\nAll energies must be reported in electronvolts (eV). The derivative $\\frac{\\partial \\Delta E_{g}}{\\partial \\epsilon_{\\infty}}$ must be reported in electronvolts per unit of $\\epsilon_{\\infty}$, where $\\epsilon_{\\infty}$ is dimensionless. Your program must round every reported floating-point number to $6$ decimals before printing.\n\nUse the following fixed parameters for the orbital-channel matrix elements $M_{i}(\\ell)$ (in eV), which represent reference unscreened, unit-mixing expectation values:\n- Conduction-band edge: $M_{c}(s) = 1.0$, $M_{c}(p) = 1.5$, $M_{c}(d) = 3.0$.\n- Valence-band edge: $M_{v}(s) = 1.2$, $M_{v}(p) = 2.0$, $M_{v}(d) = 3.5$.\n\nFor each test case, you are given $\\epsilon_{\\infty}$ and the orbital weight triplets for the conduction- and valence-band edges, $(w_{c,s}, w_{c,p}, w_{c,d})$ and $(w_{v,s}, w_{v,p}, w_{v,d})$. If a triplet does not sum to unity due to roundoff, normalize it so that $\\sum_{\\ell} w_{i,\\ell} = 1$.\n\nTest suite (each case supplies $\\epsilon_{\\infty}$ and the two weight triplets in the order $(w_{c,s}, w_{c,p}, w_{c,d})$ and $(w_{v,s}, w_{v,p}, w_{v,d})$):\n- Case $1$: $\\epsilon_{\\infty} = 4.0$, $(0.6, 0.4, 0.0)$, $(0.2, 0.8, 0.0)$.\n- Case $2$: $\\epsilon_{\\infty} = 15.0$, $(0.6, 0.4, 0.0)$, $(0.2, 0.8, 0.0)$.\n- Case $3$: $\\epsilon_{\\infty} = 1.0$, $(0.6, 0.4, 0.0)$, $(0.2, 0.8, 0.0)$.\n- Case $4$: $\\epsilon_{\\infty} = 5.0$, $(0.0, 0.2, 0.8)$, $(0.1, 0.1, 0.8)$.\n- Case $5$: $\\epsilon_{\\infty} = 7.0$, $(1.0, 0.0, 0.0)$, $(0.0, 1.0, 0.0)$.\n\nRequired output for each case, in this exact order:\n- $\\Delta E_{g}$,\n- $\\frac{\\partial \\Delta E_{g}}{\\partial \\epsilon_{\\infty}}$,\n- $C_{c,s}$, $C_{c,p}$, $C_{c,d}$,\n- $C_{v,s}$, $C_{v,p}$, $C_{v,d}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the values for Case $1$ first, followed by Case $2$, ..., through Case $5$. For example: \"[result1,result2,...,resultN]\". Every number must be rounded to $6$ decimals.",
            "solution": "The problem requires the construction of a model to estimate the change in a semiconductor's fundamental band gap, $\\Delta E_g$, upon the introduction of a hybrid exchange-correlation functional. The model must be derived from first-order perturbation theory and the operator form of hybrid functionals. We will systematically derive the expressions for the band gap change, its sensitivity to dielectric screening, and its decomposition into orbital-channel contributions.\n\nThe foundational principles are:\n1.  The hybrid Hamiltonian $\\hat{H}(a)$ is treated as a perturbation to a semilocal (GGA) Hamiltonian $\\hat{H}_0$. The perturbation operator, $\\hat{W}$, arises from mixing a fraction $a$ of Hartree-Fock (exact) exchange, scaled by the inverse of the high-frequency dielectric constant $1/\\epsilon_{\\infty}$, with the GGA functional.\n2.  The first-order energy correction to a non-degenerate eigenstate $\\lvert\\psi_i\\rangle$ of $\\hat{H}_0$ is given by the expectation value $\\Delta\\varepsilon_i = \\langle\\psi_i\\lvert\\hat{W}\\rvert\\psi_i\\rangle$.\n3.  This expectation value is approximated by a weighted sum over orbital characters $\\ell \\in \\{s, p, d\\}$.\n\nFirst, we formalize the perturbation operator $\\hat{W}$. The problem states that the perturbation involves replacing a fraction $a$ of the semilocal exchange potential, let's denote it $\\hat{V}_x^{\\text{GGA}}$, with the same fraction of the non-local Hartree-Fock (HF) exchange operator, $\\hat{V}_x^{\\text{HF}}$. This difference is then screened by the dielectric constant $\\epsilon_{\\infty}$. The resulting perturbation operator is:\n$$ \\hat{W} = \\frac{a}{\\epsilon_{\\infty}} \\left( \\hat{V}_x^{\\text{HF}} - \\hat{V}_x^{\\text{GGA}} \\right) $$\nThe first-order energy correction for an electronic state $\\lvert\\psi_i\\rangle$ (where $i$ denotes either the conduction band minimum, $c$, or the valence band maximum, $v$) is:\n$$ \\Delta\\varepsilon_i = \\langle\\psi_i\\lvert \\hat{W} \\rvert\\psi_i\\rangle = \\frac{a}{\\epsilon_{\\infty}} \\langle\\psi_i\\lvert \\hat{V}_x^{\\text{HF}} - \\hat{V}_x^{\\text{GGA}} \\rvert\\psi_i\\rangle $$\nThe problem provides a specific approximation for the expectation value, based on reference matrix elements $M_i(\\ell)$ which are defined for the unscreened ($ \\epsilon_{\\infty}=1 $) and unit-mixing ($ a=1 $) case. The expectation value for the unscreened, unit-mixing perturbation is given by:\n$$ \\langle\\psi_i\\lvert \\hat{V}_x^{\\text{HF}} - \\hat{V}_x^{\\text{GGA}} \\rvert\\psi_i\\rangle \\approx \\sum_{\\ell \\in \\{s,p,d\\}} w_{i,\\ell} M_i(\\ell) $$\nwhere $w_{i,\\ell}$ are the normalized orbital weights for state $i$ and channel $\\ell$. Let's define this orbitally-averaged matrix element as $M_i^{\\text{avg}} = \\sum_{\\ell} w_{i,\\ell} M_i(\\ell)$.\n\nThe energy correction $\\Delta\\varepsilon_i$ is thus:\n$$ \\Delta\\varepsilon_i \\approx \\frac{a}{\\epsilon_{\\infty}} M_i^{\\text{avg}} $$\nA crucial physical consideration is the sign of the correction. For an unoccupied conduction state ($i=c$), the introduction of exact exchange raises the energy, so $\\Delta\\varepsilon_c$ is positive. The given $M_c(\\ell)$ values are positive, so this is consistent. For an occupied valence state ($i=v$), exact exchange lowers the energy relative to the self-interaction-prone semilocal approximation, so $\\Delta\\varepsilon_v$ is negative. We must therefore introduce a sign explicitly.\n$$ \\Delta\\varepsilon_c = +\\frac{a}{\\epsilon_{\\infty}} M_c^{\\text{avg}} = +\\frac{a}{\\epsilon_{\\infty}} \\sum_{\\ell} w_{c,\\ell} M_c(\\ell) $$\n$$ \\Delta\\varepsilon_v = -\\frac{a}{\\epsilon_{\\infty}} M_v^{\\text{avg}} = -\\frac{a}{\\epsilon_{\\infty}} \\sum_{\\ell} w_{v,\\ell} M_v(\\ell) $$\nThe change in the band gap, $\\Delta E_g$, is the change in the conduction edge energy minus the change in the valence edge energy:\n$$ \\Delta E_g = \\Delta\\varepsilon_c - \\Delta\\varepsilon_v $$\nSubstituting the expressions for the energy corrections yields:\n$$ \\Delta E_g = \\left(\\frac{a}{\\epsilon_{\\infty}} M_c^{\\text{avg}}\\right) - \\left(-\\frac{a}{\\epsilon_{\\infty}} M_v^{\\text{avg}}\\right) = \\frac{a}{\\epsilon_{\\infty}} \\left( M_c^{\\text{avg}} + M_v^{\\text{avg}} \\right) $$\nThis expression elegantly shows that both the up-shift of the conduction band and the down-shift of the valence band contribute additively to opening the band gap.\n\nNext, we compute the sensitivity of the band gap change with respect to the dielectric constant, $\\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}}$. We differentiate the expression for $\\Delta E_g$ with respect to $\\epsilon_{\\infty}$, treating $a$, $w_{i,\\ell}$, and $M_i(\\ell)$ as constants:\n$$ \\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}} = \\frac{\\partial}{\\partial \\epsilon_{\\infty}} \\left[ \\frac{a}{\\epsilon_{\\infty}} \\left( M_c^{\\text{avg}} + M_v^{\\text{avg}} \\right) \\right] = a \\left( M_c^{\\text{avg}} + M_v^{\\text{avg}} \\right) \\frac{\\partial}{\\partial \\epsilon_{\\infty}} \\left( \\frac{1}{\\epsilon_{\\infty}} \\right) $$\n$$ \\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}} = - \\frac{a}{\\epsilon_{\\infty}^2} \\left( M_c^{\\text{avg}} + M_v^{\\text{avg}} \\right) $$\nBy comparing this with the expression for $\\Delta E_g$, we find the simple relationship:\n$$ \\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}} = -\\frac{\\Delta E_g}{\\epsilon_{\\infty}} $$\nFinally, we determine the orbital contributions, $C_{c,\\ell}$ and $C_{v,\\ell}$, defined as the positive additive terms that sum to $\\Delta E_g$. From our expression for $\\Delta E_g$:\n$$ \\Delta E_g = \\frac{a}{\\epsilon_{\\infty}} \\sum_{\\ell} w_{c,\\ell} M_c(\\ell) + \\frac{a}{\\epsilon_{\\infty}} \\sum_{\\ell} w_{v,\\ell} M_v(\\ell) $$\nThe decomposition is straightforward. The contribution from the conduction band edge channel $\\ell$ is:\n$$ C_{c,\\ell} = \\frac{a}{\\epsilon_{\\infty}} w_{c,\\ell} M_c(\\ell) $$\nAnd the contribution from the valence band edge channel $\\ell$ is:\n$$ C_{v,\\ell} = \\frac{a}{\\epsilon_{\\infty}} w_{v,\\ell} M_v(\\ell) $$\nBy construction, $\\sum_{\\ell} (C_{c,\\ell} + C_{v,\\ell}) = \\Delta E_g$.\n\nTo summarize, for each test case with given parameters $a = 0.25$, $\\epsilon_{\\infty}$, and orbital weights $(w_{c,s}, w_{c,p}, w_{c,d})$ and $(w_{v,s}, w_{v,p}, w_{v,d})$, and fixed reference matrix elements $M_c(\\ell)$ and $M_v(\\ell)$, the computational procedure is as follows:\n1.  Normalize the weight triplets $\\{w_{c,\\ell}\\}$ and $\\{w_{v,\\ell}\\}$ to ensure they each sum to $1$.\n2.  Compute the orbitally-averaged matrix elements $M_c^{\\text{avg}} = \\sum_{\\ell} w_{c,\\ell} M_c(\\ell)$ and $M_v^{\\text{avg}} = \\sum_{\\ell} w_{v,\\ell} M_v(\\ell)$.\n3.  Calculate the band gap change $\\Delta E_g = \\frac{a}{\\epsilon_{\\infty}} (M_c^{\\text{avg}} + M_v^{\\text{avg}})$.\n4.  Calculate the sensitivity $\\frac{\\partial \\Delta E_g}{\\partial \\epsilon_{\\infty}} = -\\frac{\\Delta E_g}{\\epsilon_{\\infty}}$.\n5.  Calculate the orbital contributions $C_{c,\\ell} = \\frac{a}{\\epsilon_{\\infty}} w_{c,\\ell} M_c(\\ell)$ and $C_{v,\\ell} = \\frac{a}{\\epsilon_{\\infty}} w_{v,\\ell} M_v(\\ell)$ for $\\ell \\in \\{s, p, d\\}$.\nAll numerical results are to be rounded to $6$ decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the change in a semiconductor's band gap based on a first-principles-inspired model.\n\n    The model uses first-order perturbation theory to estimate the energy shifts of the\n    conduction and valence band edges upon introducing a hybrid exchange-correlation functional.\n    The perturbation is scaled by an exact-exchange mixing fraction 'a' and a dielectric\n    screening constant 'epsilon_infinity'. The model further approximates the perturbation\n    matrix elements using an orbital-character-weighted sum over s, p, and d channels.\n    \"\"\"\n\n    # Fixed parameters from the problem statement\n    A_MIX = 0.25  # Exact-exchange mixing parameter\n    \n    # Reference unscreened, unit-mixing matrix elements M_i(l) in eV\n    # Index 0: s, 1: p, 2: d\n    M_C = np.array([1.0, 1.5, 3.0])  # Conduction-band edge\n    M_V = np.array([1.2, 2.0, 3.5])  # Valence-band edge\n\n    # Test suite: (epsilon_infinity, (wc_s, wc_p, wc_d), (wv_s, wv_p, wv_d))\n    test_cases = [\n        (4.0, (0.6, 0.4, 0.0), (0.2, 0.8, 0.0)),\n        (15.0, (0.6, 0.4, 0.0), (0.2, 0.8, 0.0)),\n        (1.0, (0.6, 0.4, 0.0), (0.2, 0.8, 0.0)),\n        (5.0, (0.0, 0.2, 0.8), (0.1, 0.1, 0.8)),\n        (7.0, (1.0, 0.0, 0.0), (0.0, 1.0, 0.0)),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        eps_inf, w_c_raw, w_v_raw = case\n        \n        # Convert weight tuples to numpy arrays for vector operations\n        w_c = np.array(w_c_raw, dtype=float)\n        w_v = np.array(w_v_raw, dtype=float)\n        \n        # Step 1: Normalize orbital weights if they do not sum to 1\n        sum_w_c = np.sum(w_c)\n        if sum_w_c > 0 and not np.isclose(sum_w_c, 1.0):\n            w_c /= sum_w_c\n            \n        sum_w_v = np.sum(w_v)\n        if sum_w_v > 0 and not np.isclose(sum_w_v, 1.0):\n            w_v /= sum_w_v\n\n        # Step 2: Compute orbitally-averaged matrix elements\n        m_c_avg = np.dot(w_c, M_C)\n        m_v_avg = np.dot(w_v, M_V)\n        \n        # Step 3: Calculate the band gap change\n        delta_eg = (A_MIX / eps_inf) * (m_c_avg + m_v_avg)\n        \n        # Step 4: Calculate the sensitivity derivative\n        d_delta_eg_d_eps = -delta_eg / eps_inf\n        \n        # Step 5: Calculate the decomposition into orbital contributions\n        scale_factor = A_MIX / eps_inf\n        c_c = scale_factor * w_c * M_C\n        c_v = scale_factor * w_v * M_V\n        \n        # Collect and round all results for the current case to 6 decimals\n        results_for_case = [\n            round(delta_eg, 6),\n            round(d_delta_eg_d_eps, 6),\n            round(c_c[0], 6), round(c_c[1], 6), round(c_c[2], 6), # C_c,s,p,d\n            round(c_v[0], 6), round(c_v[1], 6), round(c_v[2], 6), # C_v,s,p,d\n        ]\n        \n        all_results.extend(results_for_case)\n        \n    # Final print statement in the exact required format.\n    # The f-string formatting ensures that trailing zeros are printed,\n    # satisfying the visual representation of 6 decimal places.\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The performance of a hybrid functional critically depends on the choice of the exact exchange mixing fraction, $\\alpha$. While standard values work well for many systems, tailoring $\\alpha$ to a specific material can lead to significant improvements in accuracy. This advanced exercise guides you through a modern \"tuning\" procedure that minimizes self-interaction error by enforcing compliance with the Koopmans condition, bridging the gap between using off-the-shelf functionals and designing system-specific ones .",
            "id": "3457579",
            "problem": "You are given a principled diagnostic for self-interaction error in generalized Kohn–Sham hybrid calculations for molecular crystals, based on the delta Self-Consistent Field (Δ-SCF) ionization potential and the Koopmans condition. The delta Self-Consistent Field (Δ-SCF) ionization potential is defined as the difference of total energies between the neutral and cation systems at their respective self-consistent electron densities. The Highest Occupied Molecular Orbital (HOMO) eigenvalue is the topmost occupied Kohn–Sham eigenvalue. In a hybrid functional within the Generalized Kohn–Sham (GKS) framework, a fraction of exact Hartree–Fock exchange is mixed with semilocal exchange, controlled by a dimensionless mixing parameter $\\alpha \\in [0,1]$. For weakly screened systems such as organic molecular crystals, physical considerations also suggest a screening-informed target $\\alpha \\approx 1/\\varepsilon_{\\infty}$, where $\\varepsilon_{\\infty}$ is the electronic dielectric constant. The Koopmans condition states that the ionization potential $I$ should equal the negative of the HOMO eigenvalue, $I \\approx -\\varepsilon_{\\text{HOMO}}$, in the absence of self-interaction error. In practice, one can tune $\\alpha$ so that the deviation $I + \\varepsilon_{\\text{HOMO}}$ is minimized while also keeping $\\alpha$ consistent with the screening-informed target $1/\\varepsilon_{\\infty}$.\n\nStarting from the fundamental definitions above, consider the following abstracted mathematical task. For each test case below, you are given:\n- Discrete samples of the exchange fraction $\\alpha$ at values $\\{\\alpha_j\\}$,\n- The corresponding delta Self-Consistent Field (Δ-SCF) ionization potentials $\\{I(\\alpha_j)\\}$ in electronvolts,\n- The corresponding HOMO eigenvalues $\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\}$ in electronvolts,\n- The electronic dielectric constant $\\varepsilon_{\\infty}$ (dimensionless).\n\nYou must:\n1. For each test case, fit the relations $I(\\alpha)$ and $\\varepsilon_{\\text{HOMO}}(\\alpha)$ to affine (first-order) models in $\\alpha$ using least squares, i.e., $I(\\alpha) \\approx I_0 + s_I \\alpha$ and $\\varepsilon_{\\text{HOMO}}(\\alpha) \\approx \\varepsilon_0 + s_{\\varepsilon} \\alpha$, where $I_0$, $s_I$, $\\varepsilon_0$, and $s_{\\varepsilon}$ are real parameters determined by fitting.\n2. Define the scalar objective\n$$\nJ(\\alpha) \\equiv w_K \\left(I(\\alpha) + \\varepsilon_{\\text{HOMO}}(\\alpha)\\right)^2 + w_S \\left(\\alpha - \\frac{1}{\\varepsilon_{\\infty}}\\right)^2,\n$$\nwith weights $w_K = 1.0$ in units of $\\text{eV}^{-2}$ and $w_S = 0.2$ (dimensionless). Note that $J(\\alpha)$ is convex in $\\alpha$ under these conditions.\n3. Compute the value $\\alpha^\\star$ that minimizes $J(\\alpha)$ over the physically allowed interval $\\alpha \\in [0,1]$. If the unconstrained minimizer lies outside $[0,1]$, the constrained minimizer is obtained by restricting $\\alpha^\\star$ to the nearest endpoint of the interval.\n4. Express all energies in $\\text{eV}$. The final reported $\\alpha^\\star$ is dimensionless. Your program must produce each $\\alpha^\\star$ rounded to six digits after the decimal point.\n\nTest suite to implement and evaluate:\n- Case A (happy path, competing criteria): $\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$, $\\{I(\\alpha_j)\\} = \\{6.8, 7.0, 7.2\\}$ $\\text{eV}$, $\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-5.5, -6.25, -7.0\\}$ $\\text{eV}$, $\\varepsilon_{\\infty} = 3.5$.\n- Case B (near screening match): $\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$, $\\{I(\\alpha_j)\\} = \\{7.5, 7.625, 7.75\\}$ $\\text{eV}$, $\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-6.0, -6.8, -7.6\\}$ $\\text{eV}$, $\\varepsilon_{\\infty} = 2.0$.\n- Case C (flat Koopmans residual, screening-dominated): $\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$, $\\{I(\\alpha_j)\\} = \\{7.0, 7.05, 7.1\\}$ $\\text{eV}$, $\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-6.8, -6.85, -6.9\\}$ $\\text{eV}$, $\\varepsilon_{\\infty} = 4.0$.\n- Case D (unconstrained minimizer below zero, boundary clamp): $\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$, $\\{I(\\alpha_j)\\} = \\{6.0, 6.025, 6.05\\}$ $\\text{eV}$, $\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-6.5, -6.625, -6.75\\}$ $\\text{eV}$, $\\varepsilon_{\\infty} = 10.0$.\n- Case E (unconstrained minimizer above one, boundary clamp): $\\{\\alpha_j\\} = \\{0.0, 0.25, 0.5\\}$, $\\{I(\\alpha_j)\\} = \\{5.0, 5.025, 5.05\\}$ $\\text{eV}$, $\\{\\varepsilon_{\\text{HOMO}}(\\alpha_j)\\} = \\{-3.0, -3.05, -3.1\\}$ $\\text{eV}$, $\\varepsilon_{\\infty} = 1.5$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases listed above. Specifically, the output format must be:\n- A single Python list of the five optimal values $[\\alpha_A^\\star, \\alpha_B^\\star, \\alpha_C^\\star, \\alpha_D^\\star, \\alpha_E^\\star]$,\n- Each value rounded to exactly six digits after the decimal point,\n- No additional text. For example, an acceptable format is like $[\\dots]$ with entries such as $0.123456$.\n\nAngles are not involved in this problem. All physical quantities in the input data are given in electronvolts, and the only required outputs are the dimensionless optimal $\\alpha$ values per case, rounded to six digits after the decimal point, as specified above.",
            "solution": "The problem statement is reviewed and found to be valid. It is scientifically grounded in the principles of computational materials science, specifically concerning the application of hybrid exchange-correlation functionals within Density Functional Theory. The problem is well-posed, with a clearly defined objective function and constraints, ensuring a unique and computable solution exists for each test case. All provided data are consistent and sufficient for the task. We may therefore proceed with a formal solution.\n\nThe core of the problem is to find an optimal value for the exchange mixing parameter, $\\alpha$, by minimizing a composite objective function, $J(\\alpha)$. This function balances two physical desiderata: the satisfaction of the Koopmans condition and the adherence to a screening-informed target for $\\alpha$. The procedure involves three primary steps: ($1$) modeling the dependency of the ionization potential, $I$, and the HOMO eigenvalue, $\\varepsilon_{\\text{HOMO}}$, on $\\alpha$ using linear regression; ($2$) constructing the objective function $J(\\alpha)$ using these models; and ($3$) finding the value $\\alpha^\\star$ that minimizes $J(\\alpha)$ within the physically meaningful interval $[0,1]$.\n\n**Step $1$: Affine Modeling via Least Squares Regression**\n\nFor each test case, we are provided with discrete data points $(\\alpha_j, I(\\alpha_j))$ and $(\\alpha_j, \\varepsilon_{\\text{HOMO}}(\\alpha_j))$. We are instructed to fit these data to affine models:\n$$\nI(\\alpha) \\approx I_0 + s_I \\alpha\n$$\n$$\n\\varepsilon_{\\text{HOMO}}(\\alpha) \\approx \\varepsilon_0 + s_{\\varepsilon} \\alpha\n$$\nThe parameters $(I_0, s_I)$ and $(\\varepsilon_0, s_{\\varepsilon})$ are determined by the method of ordinary least squares. For a general set of points $(x_j, y_j)$, fitting to the model $y(x) = c + mx$ requires finding the parameters $(c, m)$ that minimize the sum of squared residuals. This is a standard linear algebra problem, the solution to which is given by solving the normal equations. Given a design matrix $\\mathbf{A}$ and a vector of observations $\\mathbf{y}$,\n$$\n\\mathbf{A} = \\begin{pmatrix} 1  x_1 \\\\ 1  x_2 \\\\ \\vdots  \\vdots \\\\ 1  x_n \\end{pmatrix}, \\quad \\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_n \\end{pmatrix},\n$$\nthe parameter vector $\\mathbf{p} = \\begin{pmatrix} c \\\\ m \\end{pmatrix}$ is found via the pseudo-inverse: $\\mathbf{p} = (\\mathbf{A}^T\\mathbf{A})^{-1}\\mathbf{A}^T\\mathbf{y}$. This calculation will be performed for both $I(\\alpha)$ and $\\varepsilon_{\\text{HOMO}}(\\alpha)$ for each test case.\n\n**Step $2$: Formulation of the Objective Function**\n\nThe objective function to be minimized is given as:\n$$\nJ(\\alpha) \\equiv w_K \\left(I(\\alpha) + \\varepsilon_{\\text{HOMO}}(\\alpha)\\right)^2 + w_S \\left(\\alpha - \\frac{1}{\\varepsilon_{\\infty}}\\right)^2\n$$\nwhere the weights are $w_K = 1.0 \\, \\text{eV}^{-2}$ and $w_S = 0.2$. The first term penalizes deviation from the Koopmans condition, $I + \\varepsilon_{\\text{HOMO}} = 0$, while the second term penalizes deviation from the screening-informed target, $\\alpha = 1/\\varepsilon_{\\infty}$.\n\nSubstituting our affine models into the first term, we define the Koopmans deviation term, $K(\\alpha)$, as:\n$$\nK(\\alpha) = I(\\alpha) + \\varepsilon_{\\text{HOMO}}(\\alpha) = (I_0 + s_I \\alpha) + (\\varepsilon_0 + s_{\\varepsilon} \\alpha) = (I_0 + \\varepsilon_0) + (s_I + s_{\\varepsilon})\\alpha\n$$\nLet us define $K_0 \\equiv I_0 + \\varepsilon_0$ and $s_K \\equiv s_I + s_{\\varepsilon}$. The objective function can then be written as a quadratic function of $\\alpha$:\n$$\nJ(\\alpha) = w_K (K_0 + s_K \\alpha)^2 + w_S \\left(\\alpha - \\frac{1}{\\varepsilon_{\\infty}}\\right)^2\n$$\n\n**Step $3$: Minimization and Constraint Application**\n\nTo find the unconstrained minimizer of $J(\\alpha)$, we compute its derivative with respect to $\\alpha$ and set it to zero:\n$$\n\\frac{dJ}{d\\alpha} = 2 w_K (K_0 + s_K \\alpha) s_K + 2 w_S \\left(\\alpha - \\frac{1}{\\varepsilon_{\\infty}}\\right) = 0\n$$\nSolving for $\\alpha$:\n$$\nw_K K_0 s_K + w_K s_K^2 \\alpha + w_S \\alpha - \\frac{w_S}{\\varepsilon_{\\infty}} = 0\n$$\n$$\n(w_K s_K^2 + w_S)\\alpha = \\frac{w_S}{\\varepsilon_{\\infty}} - w_K K_0 s_K\n$$\nThe unconstrained optimal value, $\\alpha_{\\text{unconstrained}}$, is therefore:\n$$\n\\alpha_{\\text{unconstrained}} = \\frac{\\frac{w_S}{\\varepsilon_{\\infty}} - w_K K_0 s_K}{w_K s_K^2 + w_S}\n$$\nThe second derivative, $\\frac{d^2J}{d\\alpha^2} = 2(w_K s_K^2 + w_S)$, is always positive since $w_K  0$, $w_S  0$, and $s_K^2 \\ge 0$. This confirms that $J(\\alpha)$ is a strictly convex function and our solution corresponds to a global minimum.\n\nFinally, the physically allowed range for the mixing parameter is $\\alpha \\in [0, 1]$. The constrained minimizer, $\\alpha^\\star$, is found by clamping the unconstrained solution to this interval:\n$$\n\\alpha^\\star = \\max(0, \\min(1, \\alpha_{\\text{unconstrained}}))\n$$\nThis procedure is applied systematically to each of the five test cases provided. The results are computed numerically and rounded to six decimal places as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the optimal exchange mixing parameter alpha* for a series of test cases.\n\n    The method involves:\n    1. Performing linear regression on I(alpha) and e_HOMO(alpha).\n    2. Constructing a quadratic objective function J(alpha).\n    3. Finding the analytical minimizer of J(alpha).\n    4. Constraining the solution to the interval [0, 1].\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'alpha': [0.0, 0.25, 0.5], 'I': [6.8, 7.0, 7.2], 'e_homo': [-5.5, -6.25, -7.0], 'eps_inf': 3.5},\n        # Case B\n        {'alpha': [0.0, 0.25, 0.5], 'I': [7.5, 7.625, 7.75], 'e_homo': [-6.0, -6.8, -7.6], 'eps_inf': 2.0},\n        # Case C\n        {'alpha': [0.0, 0.25, 0.5], 'I': [7.0, 7.05, 7.1], 'e_homo': [-6.8, -6.85, -6.9], 'eps_inf': 4.0},\n        # Case D\n        {'alpha': [0.0, 0.25, 0.5], 'I': [6.0, 6.025, 6.05], 'e_homo': [-6.5, -6.625, -6.75], 'eps_inf': 10.0},\n        # Case E\n        {'alpha': [0.0, 0.25, 0.5], 'I': [5.0, 5.025, 5.05], 'e_homo': [-3.0, -3.05, -3.1], 'eps_inf': 1.5},\n    ]\n\n    results = []\n    w_K = 1.0\n    w_S = 0.2\n\n    for case in test_cases:\n        alphas = np.array(case['alpha'])\n        Is = np.array(case['I'])\n        e_homos = np.array(case['e_homo'])\n        eps_inf = case['eps_inf']\n\n        # Step 1: Affine modeling via least squares regression.\n        # The design matrix A has a column of ones for the intercept and a column of alpha values for the slope.\n        A = np.vstack([np.ones_like(alphas), alphas]).T\n        \n        # Fit I(alpha) = I_0 + s_I * alpha\n        p_I, _, _, _ = np.linalg.lstsq(A, Is, rcond=None)\n        I_0, s_I = p_I[0], p_I[1]\n\n        # Fit e_HOMO(alpha) = eps_0 + s_eps * alpha\n        p_eps, _, _, _ = np.linalg.lstsq(A, e_homos, rcond=None)\n        eps_0, s_eps = p_eps[0], p_eps[1]\n\n        # Step 2: Formulate the objective function parameters.\n        # The Koopmans deviation is K(alpha) = K_0 + s_K * alpha\n        K_0 = I_0 + eps_0\n        s_K = s_I + s_eps\n        \n        # Step 3: Compute the unconstrained minimizer of J(alpha).\n        # alpha_unconstrained = ( (w_S / eps_inf) - w_K * K_0 * s_K ) / ( w_K * s_K**2 + w_S )\n        numerator = (w_S / eps_inf) - (w_K * K_0 * s_K)\n        denominator = (w_K * s_K**2) + w_S\n        alpha_unconstrained = numerator / denominator\n\n        # Step 4: Apply the physical constraint alpha in [0, 1].\n        alpha_star = np.clip(alpha_unconstrained, 0.0, 1.0)\n        \n        results.append(alpha_star)\n\n    # Format the final results for printing.\n    # Each value is rounded to exactly six digits after the decimal point.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}