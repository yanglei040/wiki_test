## 引言
在探索和设计新材料的征程中，精确求解多体薛定谔方程以预测材料性质是计算材料科学的核心挑战。虽然[密度泛函理论](@entry_id:139027)等方法取得了巨大成功，但准确描述电子强关联效应仍然是一大难题。[量子蒙特卡洛](@entry_id:144383)（QMC）方法作为一类基于随机抽样的高精度[第一性原理计算](@entry_id:198754)方法，为直接应对这一挑战提供了强大的工具，能够以极高的准确性计算量子系统的[基态](@entry_id:150928)性质。

本文旨在为读者提供一个关于[QMC方法](@entry_id:753887)的全面而深入的指南。我们将系统性地解决一个关键的知识缺口：如何将QMC从抽象的理论框架转化为解决实际科学问题的具体计算方案。为此，我们将首先在“原理与机制”一章中，揭示[QMC方法](@entry_id:753887)背后的数学原理，如虚时演化，并详细阐述其核心技术，包括变分和[扩散蒙特卡洛](@entry_id:145241)。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将通过丰富的实例展示QMC如何在物理、化学和[材料科学](@entry_id:152226)的前沿研究中发挥作用。最后，通过“动手实践”环节，读者将有机会将理论知识应用于具体编程练习，从而巩固所学。通过这三章的学习，读者将建立起对[QMC方法](@entry_id:753887)的坚实理解，并掌握其在科研中的应用之道。

## 原理与机制

本章旨在深入阐述[量子蒙特卡洛](@entry_id:144383)（QMC）方法的核心原理与内部机制。我们将从其数学基础——虚时演化——出发，探讨该方法为何能够找到量子系统的[基态](@entry_id:150928)。随后，我们将直面[费米子](@entry_id:146235)体系带来的核心挑战，即“[符号问题](@entry_id:155213)”，并以此为背景，系统地介绍两种主要的[QMC方法](@entry_id:753887)：变分[蒙特卡洛](@entry_id:144354)（VMC）和[扩散蒙特卡洛](@entry_id:145241)（DMC）。在此过程中，我们将详细剖析[试探波函数](@entry_id:142892)、局域能量、[固定节点近似](@entry_id:145482)等关键概念，并最终将这些理论应用于计算材料科学中的周期性固体，同时讨论结果的[统计误差](@entry_id:755391)分析。

### 核心原理：虚时演化投影

[量子蒙特卡洛方法](@entry_id:753887)的基础是一种强大的数学技术，即利用虚时演化将系统的[基态](@entry_id:150928)从任意初始状态中“投影”出来。让我们考虑一个由不[含时哈密顿量](@entry_id:136684) $H$ 描述的量子系统。其[定态](@entry_id:137260)薛定谔方程为 $H\psi_n = E_n\psi_n$，其中 $\{\psi_n\}$ 是一个完备正交的[本征函数](@entry_id:154705)集，对应的本征能量为 $\{E_n\}$。我们假定能量已排序，即 $E_0  E_1 \le E_2 \le \dots$。

现在，我们考虑一个形式上与薛定谔方程相似的方程，但将其中的实时间 $t$ 替换为[虚时间](@entry_id:138627) $\tau = it$。引入一个可调节的参考能量 $E_T$，该方程变为：
$$
-\frac{\partial \Phi(\mathbf{R}, \tau)}{\partial \tau} = (H - E_T) \Phi(\mathbf{R}, \tau)
$$
其中 $\mathbf{R}$ 代表系统中所有粒子的坐标。这是一个线性的[偏微分方程](@entry_id:141332)，其形式解为 $\Phi(\mathbf{R}, \tau) = \exp(-\tau(H - E_T)) \Phi_0(\mathbf{R})$，其中 $\Phi_0(\mathbf{R})$ 是任意给定的初始[波函数](@entry_id:147440)。

为了理解这个演化的效果，我们可以将初始函数 $\Phi_0$ 按[哈密顿量](@entry_id:172864)的本征态展开：$\Phi_0 = \sum_n c_n \psi_n$，其中 $c_n = \langle \psi_n | \Phi_0 \rangle$ 是展开系数。由于 $H$ 的线性，演化后的状态为：
$$
\Phi(\tau) = \sum_n c_n e^{-\tau(H - E_T)} \psi_n = \sum_n c_n e^{-\tau(E_n - E_T)} \psi_n
$$
我们可以将上式改写为：
$$
\Phi(\tau) = e^{-\tau(E_0 - E_T)} \left( c_0 \psi_0 + \sum_{n=1}^{\infty} c_n e^{-\tau(E_n - E_0)} \psi_n \right)
$$
由于 $E_n > E_0$ 对所有 $n \ge 1$ 成立，当虚时 $\tau \to \infty$ 时，指数项 $e^{-\tau(E_n - E_0)}$ 会迅速衰减至零。因此，只要初始状态与[基态](@entry_id:150928)存在非零交叠（即 $c_0 \ne 0$），在长[时间演化](@entry_id:153943)后，$\Phi(\tau)$ 将变得与[基态](@entry_id:150928)[波函数](@entry_id:147440) $\psi_0$ 成正比 。归一化后，我们便得到了系统的[基态](@entry_id:150928)。如果[基态](@entry_id:150928)是 $g$ 重简并的，此方法会投影出初始状态在整个简并[基态](@entry_id:150928)[子空间](@entry_id:150286)上的分量 。

参考能量 $E_T$ 并不改变最终投影出的状态，因为它只是统一地移动了所有能级的指数衰减速率。在实际的[随机模拟](@entry_id:168869)中，通过动态调整 $E_T$ 使其接近 $E_0$，可以用来控制模拟中“行走者”（walkers）的总数，使其保持稳定 。

### [费米子符号问题](@entry_id:144472)

尽管虚时投影在理论上非常优雅，但当应用于多[费米子](@entry_id:146235)体系（如电子）时，会遇到一个根本性的障碍——**[费米子符号问题](@entry_id:144472)**（fermion sign problem）。其根源在于[泡利不相容原理](@entry_id:141850)，该原理要求[多电子波函数](@entry_id:156344)在交换任意两个自旋相同的电子的[坐标时](@entry_id:263720)必须反对称。这意味着一个真实的[费米子](@entry_id:146235)[波函数](@entry_id:147440)在 $3N$ 维的[构型空间](@entry_id:149531)中必然有正值区域和负值区域，这些区域被一个称为**节点[超曲面](@entry_id:159491)**（nodal surface）的 $(3N-1)$ 维表面隔开，在该表面上[波函数](@entry_id:147440)值为零。

然而，虚时[演化算符](@entry_id:182628) $\exp(-\tau H)$ 的积分核（即[格林函数](@entry_id:147802)）在物理上对应于一个扩散过程，它是处处非负的。这意味着，如果我们用一个正的[分布](@entry_id:182848)（例如，一个[随机行走](@entry_id:142620)者集合）来表示初始[波函数](@entry_id:147440)，并让其自由演化，它会自然地趋向于系统的**[玻色子](@entry_id:138266)[基态](@entry_id:150928)**——一个对于所有[粒子交换](@entry_id:154910)都对称的[波函数](@entry_id:147440)。这个[玻色子](@entry_id:138266)[基态](@entry_id:150928)的能量 $E_B$ 总是低于或等于[费米子](@entry_id:146235)[基态](@entry_id:150928)的能量 $E_F$。

为了获得正确的[费米子](@entry_id:146235)[基态](@entry_id:150928)，我们必须引入负号。在所谓的“释放节点”（release-node）方法中，行走者被允许携带正负号。当一个行走者穿过节点时，其符号会翻转。[费米子](@entry_id:146235)[基态](@entry_id:150928)是通过大量正负行走者的几乎完全的相消得到的。问题在于，随着虚时 $\tau$ 的增长，[玻色子](@entry_id:138266)[基态](@entry_id:150928)成分会以 $e^{-\tau E_B}$ 的速率增长，而[费米子](@entry_id:146235)[基态](@entry_id:150928)成分以 $e^{-\tau E_F}$ 的速率衰减。由于 $E_F > E_B$，[玻色子](@entry_id:138266)“噪声”会指数级地淹没[费米子](@entry_id:146235)“信号”。

我们可以更定量地描述这个问题 。模拟的**平均符号** $\langle s(\tau) \rangle$ 定义为净权重（正权重之和减去负权重之和）与总权重（[绝对值](@entry_id:147688)之和）之比。它会随虚时指数衰减：
$$
\langle s(\tau) \rangle \propto e^{-\tau (E_F - E_B)}
$$
任何物理量的[统计误差](@entry_id:755391)都反比于平均符号。因此，一个能量[估计量的方差](@entry_id:167223)会指数增长：
$$
\mathrm{Var}[E(\tau)] \propto \frac{1}{\langle s(\tau) \rangle^2} \propto e^{2\tau (E_F - E_B)}
$$
这意味着，要达到固定的精度，所需的计算量随投影时间和体系大小[指数增长](@entry_id:141869)，使得直接模拟对大多数实际问题变得不可行。例如，对于一个包含 $N=8$ 个电子的小体系，能量差 $\Delta E = E_F - E_B$ 约为 $0.8$ Hartree，在典型的模拟参数下，有效的投影时间窗口可能只有约 $4.3 \ \mathrm{Ha}^{-1}$（约200个时间步），之后统计噪声就会完全淹没信号 。

### 变分[蒙特卡洛](@entry_id:144354)（VMC）：一个基础

在直接处理[符号问题](@entry_id:155213)之前，我们先介绍一个更简单的方法：**变分蒙特卡洛**（VMC）。VMC不使用虚时投影，而是基于量子力学的**[变分原理](@entry_id:198028)**。该原理指出，对于任意归一化的试探波函数 $\Psi_T$，其[哈密顿量](@entry_id:172864)的[期望值](@entry_id:153208)总是基态能量 $E_0$ 的一个[上界](@entry_id:274738)：
$$
E_V = \frac{\langle \Psi_T | H | \Psi_T \rangle}{\langle \Psi_T | \Psi_T \rangle} \ge E_0
$$
VMC的目标就是通过优化 $\Psi_T$ 中的参数来最小化这个变分能量 $E_V$ 。

为了计算 $E_V$，我们需要计算一个[高维积分](@entry_id:143557)。VMC的核心思想是使用[蒙特卡洛方法](@entry_id:136978)来完成这个积分。为此，我们引入一个关键量——**局域能量**（local energy）$E_L(\mathbf{R})$：
$$
E_L(\mathbf{R}) = \frac{H \Psi_T(\mathbf{R})}{\Psi_T(\mathbf{R})}
$$
变分能量 $E_V$ 就是局域能量在概率密度[分布](@entry_id:182848) $\pi(\mathbf{R}) = |\Psi_T(\mathbf{R})|^2 / \int |\Psi_T(\mathbf{R}')|^2 d\mathbf{R}'$ 下的[期望值](@entry_id:153208)。VMC通过生成一系列遵循此[分布](@entry_id:182848)的电子构型 $\{\mathbf{R}_k\}$，然后计算局域能量的平均值来估计 $E_V$：
$$
E_V \approx \frac{1}{M} \sum_{k=1}^M E_L(\mathbf{R}_k)
$$
局域能量的显式表达式可以通过将[哈密顿量](@entry_id:172864) $H = T+V$ 作用在 $\Psi_T$ 上得到。对于一个包含库仑相互作用的系统，其[哈密顿量](@entry_id:172864)为 $H = -\frac{1}{2}\sum_i \nabla_i^2 + V(\mathbf{R})$，局域能量为 ：
$$
E_L(\mathbf{R}) = \frac{-\frac{1}{2}\sum_i \nabla_i^2 \Psi_T(\mathbf{R})}{\Psi_T(\mathbf{R})} + V(\mathbf{R})
$$
为了生成遵循 $|\Psi_T|^2$ [分布](@entry_id:182848)的样本，VMC通常采用**[Metropolis-Hastings算法](@entry_id:146870)**。该算法从一个构型 $\mathbf{R}$ 出发，根据一个**[提议分布](@entry_id:144814)**（proposal distribution） $T(\mathbf{R}'|\mathbf{R})$ 生成一个新构型 $\mathbf{R}'$，然后以一定的**接受概率** $a(\mathbf{R} \to \mathbf{R}')$ 接受这个移动。为了提高[采样效率](@entry_id:754496)，通常使用一个非对称的[提议分布](@entry_id:144814)，例如包含一个“漂移”项的朗之万（Langevin）提议，该漂移项会将行走者推向[概率密度](@entry_id:175496)更高的区域。这个漂移力，也称为**量子力**（quantum force），由 $\mathbf{F}(\mathbf{R}) = \nabla_{\mathbf{R}} \ln |\Psi_T(\mathbf{R})|^2$ 给出。对于非[对称提议](@entry_id:755726)，正确的接受概率必须满足[细致平衡条件](@entry_id:265158)，其形式为 ：
$$
a(\mathbf{R}\to \mathbf{R}') = \min\left(1, \frac{|\Psi_T(\mathbf{R}')|^2 T(\mathbf{R}|\mathbf{R}')}{|\Psi_T(\mathbf{R})|^2 T(\mathbf{R}'|\mathbf{R})}\right)
$$
这个表达式确保了马尔可夫链的[稳态分布](@entry_id:149079)正是我们所期望的 $|\Psi_T|^2$。

### [试探波函数](@entry_id:142892)：[QMC方法](@entry_id:753887)的核心

无论是在VMC还是DMC中，试探波函数 $\Psi_T$ 的质量都至关重要。一个好的[试探波函数](@entry_id:142892)不仅能在VMC中给出更低的变分能量，也能在DMC中提供更精确的节点和更低的计算[方差](@entry_id:200758)。最常用的[试探波函数](@entry_id:142892)形式是**斯莱特-贾斯特罗（Slater-Jastrow）**形式 ：
$$
\Psi_T(\mathbf{R}) = D(\mathbf{R}) \exp(J(\mathbf{R}))
$$
- **斯莱特部分 ($D$)**：通常是一个（或一组线性组合的）斯莱特行列式，由单粒子[轨道](@entry_id:137151)构成。它的核心作用是赋予[波函数](@entry_id:147440)正确的[费米子反对称性](@entry_id:749292)。因此，[波函数](@entry_id:147440)的**节点[超曲面](@entry_id:159491)**（即 $\Psi_T=0$ 的位置）完全由斯莱特部分决定，因为指数形式的[贾斯特罗因子](@entry_id:158362)总是正的 。

- **贾斯特罗部分 ($\exp(J)$)**：$J(\mathbf{R})$ 是一个对[粒子交换](@entry_id:154910)对称的实函数，它明确地引入了粒子间的关联。例如，它可以包含电子-核（one-body）、电子-电子（two-body）甚至更高阶的关联项。它的主要作用有两个：首先，它能更真实地描述电子因库仑排斥而相互躲避的行为；其次，它可以被构造成满足**[尖点条件](@entry_id:190416)**（cusp conditions）。

**[尖点条件](@entry_id:190416)**是保证局域能量 $E_L(\mathbf{R})$ 在粒子汇聚处（即 $r_{ij} \to 0$ 或 $r_{iI} \to 0$）保持有限的数学约束 。在这些点，[库仑势能](@entry_id:263842)项会发散到正无穷或负无穷。为了使总的局域能量有限，动能项 $\frac{-\frac{1}{2}\nabla^2 \Psi_T}{\Psi_T}$ 必须产生一个大小相等、符号相反的发散来精确抵消它。这给[波函数](@entry_id:147440)在这些汇聚点的行为施加了严格的导数条件 ：
1.  **电子-核[尖点条件](@entry_id:190416)**：当电子 $i$ 趋近于[电荷](@entry_id:275494)为 $Z_I$ 的[原子核](@entry_id:167902) $I$ 时：
    $$
    \lim_{r_{iI}\to 0} \frac{1}{\bar{\Psi}_T} \frac{\partial \bar{\Psi}_T}{\partial r_{iI}} = -Z_I
    $$
2.  **电子-电子[尖点条件](@entry_id:190416)**：当电子 $i$ 和 $j$ 相互趋近时，条件取决于它们的自旋：
    $$
    \lim_{r_{ij}\to 0} \frac{1}{\bar{\Psi}_T} \frac{\partial \bar{\Psi}_T}{\partial r_{ij}} = \frac{1}{2(1+\delta_{\sigma_i \sigma_j})}
    $$
    对于自旋相反的电子对（$\delta_{\sigma_i \sigma_j}=0$），该值为 $1/2$；对于自旋相同的电子对（$\delta_{\sigma_i \sigma_j}=1$），该值为 $1/4$。

通过为[贾斯特罗因子](@entry_id:158362)选择合适的函数形式和参数，例如 $u_{ee}(r_{12}) = \frac{cr_{12}}{1+dr_{12}}$ 和 $u_{eN}(r) = -\frac{ar}{1+br}$，我们可以精确地满足这些条件。例如，对于一个核[电荷](@entry_id:275494)为 $Z$ 的二电子原子，通过分析局域能量的发散行为，可以确定参数 $a=Z$ 和 $c=1/2$ 。满足[尖点条件](@entry_id:190416)对于减小局域能量的[方差](@entry_id:200758)、提高QMC计算的效率和稳定性至关重要。

为了进一步提高[波函数](@entry_id:147440)的精度，特别是改善其[节点结构](@entry_id:151019)，可以使用更复杂的[波函数](@entry_id:147440)形式，例如**回流（backflow）**[波函数](@entry_id:147440)。回流变换将斯莱特行列式中的电子坐标 $\mathbf{r}_i$ 替换为依赖于所有其他电子位置的“[准粒子](@entry_id:136584)”坐标 $\mathbf{x}_i(\mathbf{R})$。这种多体变换能够移动[行列式](@entry_id:142978)的节点，从而有可能获得更接近真实节点的结构，并得到更低的能量 。

### [扩散蒙特卡洛](@entry_id:145241)（DMC）：有引导的投影

**[扩散蒙特卡洛](@entry_id:145241)**（DMC）结合了虚时投影的威力与[变分原理](@entry_id:198028)的洞察力，是目前精度最高的[QMC方法](@entry_id:753887)之一。它通过引入**[固定节点近似](@entry_id:145482)**（fixed-node approximation）来解决[费米子符号问题](@entry_id:144472)。

**[固定节点近似](@entry_id:145482)**的核心思想是，不允许演化中的[波函数](@entry_id:147440) $\Phi(\mathbf{R}, \tau)$ 发展自己的节点，而是强制其节点始终与给定的试探波函数 $\Psi_T(\mathbf{R})$ 的节点重合 。这相当于在[构型空间](@entry_id:149531)中由 $\Psi_T$ 的节点所定义的各个“口袋”（nodal pockets）内独立地求解薛定谔方程，并在这些口袋的边界上施加狄利克雷边界条件（Dirichlet boundary condition），即 $\Phi(\mathbf{R}, \tau) = 0$ 。由于在每个口袋内部，$\Psi_T$ 的符号是恒定的，所以 $\Phi(\mathbf{R}, \tau)$ 的符号也可以保持不变，从而避免了[符号问题](@entry_id:155213)。

这个近似的后果由**固定节点定理**（fixed-node theorem）描述：
1.  固定节点DMC计算出的能量 $E_{FN}$ 是真实[基态能量](@entry_id:263704) $E_0$ 的一个严格上界，即 $E_{FN} \ge E_0$ 。
2.  当且仅当试探波函数的节点与真实[基态](@entry_id:150928)[波函数](@entry_id:147440)的节点完全一致时，等号成立，即 $E_{FN} = E_0$ 。

这意味着DMC的精度完全取决于试探波函数 $\Psi_T$ [节点结构](@entry_id:151019)的质量。

在实践中，DMC通常采用**重要性采样**（importance sampling）来实现。我们模拟的不是[波函数](@entry_id:147440) $\Phi$ 本身，而是所谓的“[混合分布](@entry_id:276506)” $f(\mathbf{R}, \tau) = \Psi_T(\mathbf{R}) \Phi(\mathbf{R}, \tau)$。由于在[固定节点近似](@entry_id:145482)下，$\Psi_T$ 和 $\Phi$ 在每个节点口袋内符号相同，它们的乘积 $f$ 是处处非负的，可以被解释为[随机行走](@entry_id:142620)者的[概率密度](@entry_id:175496) 。这个[混合分布](@entry_id:276506)所遵循的[演化方程](@entry_id:268137)可以被模拟为一个**漂移-[扩散](@entry_id:141445)-分支**（drift-diffusion-branching）过程：
- **漂移**：行走者受到量子力 $\mathbf{F}(\mathbf{R})$ 的驱动，向[波函数](@entry_id:147440)数值更大的区域移动。
- **[扩散](@entry_id:141445)**：行走者经历随机的布朗运动。
- **分支**：每个行走者的权重（或其后代的数量）根据局域能量 $E_L(\mathbf{R})$ 进行调整。在离散时间步 $\Delta\tau$ 下，权重更新因子近似为 $\exp[-\Delta\tau (E_L(\mathbf{R}) - E_T)]$ 。如果一个行走者所在位置的局域能量低于参考能量 $E_T$，它的权重会增加（增殖）；反之则减少（消亡）。

通过动态调整参考能量 $E_T$ 来维持行走者总体的稳定，长时间运行后， $E_T$ 的平均值就会收敛到固定节点能量 $E_{FN}$。这个过程与[全组态相互作用量子蒙特卡洛](@entry_id:191944)（FCIQMC）中的“位移”（shift）参数扮演着类似的角色 。如果幸运地拥有了精确的试探波函数，即 $\Psi_T = \psi_0$，那么局域能量处处为常数 $E_L(\mathbf{R}) = E_0$。若此时设定 $E_T = E_0$，则权重更新因子恒为1，分支过程完全被抑制，模拟的[方差](@entry_id:200758)为零 。

### 在周期性固体中的应用及实践考量

将[QMC方法](@entry_id:753887)应用于[计算材料科学](@entry_id:145245)中的周期性固体时，需要对[哈密顿量](@entry_id:172864)进行特殊处理 。
- **长程[库仑相互作用](@entry_id:747947)**：对于周期性系统中的电子-电子、电子-离子和离子-离子相互作用，由于库仑力的长程性，直接求和是条件收敛的。必须采用**伊瓦尔德求和**（Ewald summation）等技术来正确计算这些[相互作用能](@entry_id:264333)。
- **赝势**：为了降低计算成本，通常会使用**[赝势](@entry_id:170389)**（pseudopotential）来替代[原子核](@entry_id:167902)和内层芯电子。这极大地减少了需要处理的电子数，并消除了局域能量中与[原子核](@entry_id:167902)相关的强奇异性。然而，必须认识到，使用赝势相当于修改了[哈密顿量](@entry_id:172864)，因此计算的目标是该赝[哈密顿量](@entry_id:172864)的[基态](@entry_id:150928)，其结果的准确性依赖于赝势的质量。[赝势](@entry_id:170389)的引入会改变[哈密顿量](@entry_id:172864)，因此也会影响固定节点误差 。
- **[有限尺寸效应](@entry_id:155681)**：在有限的模拟超[晶胞](@entry_id:143489)中对[电子-电子相互作用](@entry_id:139900)使用标准的伊瓦尔德求和会引入虚假的周期性伪影，导致总能量存在显著的**[有限尺寸效应](@entry_id:155681)**，其误差通常随电子数 $N_e$ 以 $O(1/N_e)$ 的速度缓慢收敛。这使得外推到[热力学极限](@entry_id:143061)变得困难。为了缓解这一问题，发展了**模型周期库仑（MPC）**相互作用等先进技术 。
- **能量差的计算**：许多材料性质，如**[内聚能](@entry_id:139323)**或**[生成焓](@entry_id:139204)**，都涉及到不同体系之间的总能量之差。在计算这些量时，必须包含所有的能量项。例如，离子-离子[相互作用能](@entry_id:264333)（Madelung能）虽然对于固定的晶格结构是一个常数，但在比较不同结构（如固体与其组分原子）的能量时，这个常数项是不同的，决不能被忽略 。

### [统计误差](@entry_id:755391)分析

作为一种随机方法，QMC的计算结果总是伴随着[统计不确定性](@entry_id:267672)。正确地评估这种不确定性是任何可信计算的必要环节。模拟过程中产生的局域能量序列 $\{E_L(t)\}$ 不是独立同分布的，而是存在**自相关**（autocorrelation），因为[马尔可夫链](@entry_id:150828)中的相邻构型是关联的。

直接使用标准差公式 $\sigma/\sqrt{N}$ 会严重低估真实的[统计误差](@entry_id:755391)。处理这个问题的标准方法是**[重整化](@entry_id:143501)**（reblocking）分析 。该方法将整个数据序列分成若干个数据块，计算每个[数据块](@entry_id:748187)的平均值，然后基于这些块平均值来估算总平均值的[标准误差](@entry_id:635378)。当块的长度 $m$ 足够大，远超数据的[自相关时间](@entry_id:140108) $\lambda$ 时，这些块平均值可以近似视为相互独立的。

对于一个自相关函数为 $\rho(k) = \exp(-|k|/\lambda)$ 的平稳时间序列，可以通过理论推导得到，总平均值的真实[方差](@entry_id:200758)为 ：
$$
\mathrm{Var}(\bar{E}_L) = \frac{\sigma^2}{N} \left( 1 + 2 \sum_{k=1}^{\infty} \rho(k) \right) = \frac{\sigma^2}{N} \coth\left(\frac{1}{2\lambda}\right)
$$
其中 $\sigma^2$ 是单一样本的[方差](@entry_id:200758)，$N$ 是总样本数。因此，标准误差为：
$$
SE(\bar{E}_L) = \frac{\sigma}{\sqrt{N}} \sqrt{\coth\left(\frac{1}{2\lambda}\right)}
$$
这个公式清晰地显示，由于存在相关性（$\lambda  0$），真实的[标准误差](@entry_id:635378)比[独立样本](@entry_id:177139)情况下的 $\sigma/\sqrt{N}$ 要大一个因子 $\sqrt{\coth(1/2\lambda)}$。例如，对于一个包含 $10^6$ 个样本，标准差为 $\sigma=0.15$ Hartree，[相关时间](@entry_id:176698)为 $\lambda=30$ 步的模拟，其[平均能量](@entry_id:145892)的[标准误差](@entry_id:635378)约为 $1.162 \times 10^{-3}$ Hartree，远大于忽略相关性时的估计值 。在实践中，通过观察重整化分析得到的误差随块大小的变化，可以确定一个“平台区”，从而得到可靠的[误差估计](@entry_id:141578)。