{
    "hands_on_practices": [
        {
            "introduction": "Understanding the origin of electron-phonon coupling begins with an analytical model. This exercise grounds your understanding in deformation potential theory, a fundamental framework for describing the interaction between electrons and long-wavelength acoustic phonons. By deriving the coupling matrix element $g(\\mathbf{k},\\mathbf{q})$ from first principles, you will see how material properties like the deformation potential constant $D$ and mass density $\\rho$ directly determine the interaction strength .",
            "id": "3447991",
            "problem": "Consider a three-dimensional, non-polar semiconductor with a single, isotropic parabolic conduction band minimum at crystal momentum $\\mathbf{k}=\\mathbf{0}$ described by an effective mass $m^{\\ast}$. Electrons couple to lattice vibrations through a scalar deformation potential constant $D$ in the long-wavelength limit. Assume:\n- The electron-phonon interaction in real space is given by the deformation potential Hamiltonian $H_{\\mathrm{ep}}(\\mathbf{r})=D\\,\\nabla\\cdot\\mathbf{u}(\\mathbf{r})$, where $\\mathbf{u}(\\mathbf{r})$ is the lattice displacement field.\n- The lattice displacement field is quantized in a periodic volume $V$ with mass density $\\rho$ as a superposition of normal modes.\n- Only the longitudinal acoustic phonon branch is relevant, with dispersion $\\omega_{\\mathbf{q}}=v_{s}\\,q$ and polarization vector $\\boldsymbol{\\xi}_{\\mathbf{q}}=\\mathbf{q}/q$.\n- Electron Bloch states near the band edge are well approximated by plane-wave envelopes, $\\psi_{\\mathbf{k}}(\\mathbf{r})=V^{-1/2}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})$, and Umklapp processes are negligible.\n\nStarting from these definitions and the second-quantized form of the lattice displacement field, derive the electron-phonon coupling matrix element associated with absorption of a longitudinal acoustic phonon of wavevector $\\mathbf{q}$, defined as the magnitude of the coefficient $g(\\mathbf{k},\\mathbf{q})$ multiplying the phonon annihilation operator in the matrix element $\\langle \\psi_{\\mathbf{k}+\\mathbf{q}}|H_{\\mathrm{ep}}|\\psi_{\\mathbf{k}}\\rangle$, i.e., report $|g(\\mathbf{k},\\mathbf{q})|$ (ignore any overall phase). Express your final result as a closed-form analytic function of $q=|\\mathbf{q}|$, $D$, $\\hbar$, $\\rho$, $V$, and $v_{s}$. No numerical substitution is required. Your final answer must be a single closed-form expression. Do not include units in your final answer.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Electron-phonon interaction Hamiltonian: $H_{\\mathrm{ep}}(\\mathbf{r})=D\\,\\nabla\\cdot\\mathbf{u}(\\mathbf{r})$\n- Scalar deformation potential constant: $D$\n- Electron Bloch states (plane-wave approximation): $\\psi_{\\mathbf{k}}(\\mathbf{r})=V^{-1/2}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})$\n- System volume: $V$\n- Lattice mass density: $\\rho$\n- Relevant phonon branch: Longitudinal acoustic (LA)\n- LA phonon dispersion relation: $\\omega_{\\mathbf{q}}=v_{s}\\,q$, where $q = |\\mathbf{q}|$\n- LA phonon polarization vector: $\\boldsymbol{\\xi}_{\\mathbf{q}}=\\mathbf{q}/q$\n- Target quantity: The magnitude of the electron-phonon coupling coefficient, $|g(\\mathbf{k},\\mathbf{q})|$, for the absorption of an LA phonon with wavevector $\\mathbf{q}$. The coefficient $g(\\mathbf{k},\\mathbf{q})$ is defined via the matrix element $\\langle \\psi_{\\mathbf{k}+\\mathbf{q}}|H_{\\mathrm{ep}}|\\psi_{\\mathbf{k}}\\rangle$, which contains a term $g(\\mathbf{k},\\mathbf{q}) a_{\\mathbf{q}}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard textbook derivation in computational materials science and solid-state physics.\n- **Scientifically Grounded:** Yes. The deformation potential theory for electron-acoustic phonon coupling is a fundamental and well-established model. All concepts used, such as parabolic bands, phonon quantization, and second quantization, are cornerstones of condensed matter physics.\n- **Well-Posed:** Yes. The problem provides all necessary physical quantities, definitions, and simplifying assumptions (e.g., plane-wave electrons, single LA branch) to derive a unique, closed-form analytical solution. The objective is clearly stated.\n- **Objective:** Yes. The problem is stated using precise, formal language, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. The derivation of the solution can proceed.\n\nThe derivation begins with the definition of the electron-phonon matrix element, $M_{\\mathbf{k}',\\mathbf{k}} = \\langle \\psi_{\\mathbf{k'}}|H_{\\mathrm{ep}}|\\psi_{\\mathbf{k}}\\rangle$. For the absorption of a phonon with wavevector $\\mathbf{q}$, momentum conservation dictates that the final electron state is $\\mathbf{k}'=\\mathbf{k}+\\mathbf{q}$ (neglecting Umklapp processes as specified). The matrix element is therefore $M_{\\mathbf{k}+\\mathbf{q},\\mathbf{k}} = \\langle \\psi_{\\mathbf{k}+\\mathbf{q}}|H_{\\mathrm{ep}}|\\psi_{\\mathbf{k}}\\rangle$.\n\nThe interaction Hamiltonian is $H_{\\mathrm{ep}}(\\mathbf{r})=D\\,\\nabla\\cdot\\mathbf{u}(\\mathbf{r})$. To evaluate its matrix element, we first need the second-quantized form of the lattice displacement field operator $\\mathbf{u}(\\mathbf{r})$. For a single phonon branch in a volume $V$, this is given by:\n$$\n\\mathbf{u}(\\mathbf{r}) = \\sum_{\\mathbf{q'}} \\sqrt{\\frac{\\hbar}{2\\rho V \\omega_{\\mathbf{q'}}}} \\boldsymbol{\\xi}_{\\mathbf{q'}} \\left( a_{\\mathbf{q'}} \\exp(i\\mathbf{q'}\\cdot\\mathbf{r}) + a_{\\mathbf{q'}}^{\\dagger} \\exp(-i\\mathbf{q'}\\cdot\\mathbf{r}) \\right)\n$$\nwhere $a_{\\mathbf{q'}}$ and $a_{\\mathbf{q'}}^{\\dagger}$ are the annihilation and creation operators for a phonon of wavevector $\\mathbf{q'}$.\n\nNext, we calculate the divergence of the displacement field, $\\nabla\\cdot\\mathbf{u}(\\mathbf{r})$:\n$$\n\\nabla\\cdot\\mathbf{u}(\\mathbf{r}) = \\sum_{\\mathbf{q'}} \\sqrt{\\frac{\\hbar}{2\\rho V \\omega_{\\mathbf{q'}}}} \\boldsymbol{\\xi}_{\\mathbf{q'}} \\cdot \\nabla \\left( a_{\\mathbf{q'}} \\exp(i\\mathbf{q'}\\cdot\\mathbf{r}) + a_{\\mathbf{q'}}^{\\dagger} \\exp(-i\\mathbf{q'}\\cdot\\mathbf{r}) \\right)\n$$\nThe gradient operations yield:\n$$\n\\nabla\\cdot\\mathbf{u}(\\mathbf{r}) = \\sum_{\\mathbf{q'}} \\sqrt{\\frac{\\hbar}{2\\rho V \\omega_{\\mathbf{q'}}}} \\left( a_{\\mathbf{q'}} (i\\mathbf{q'}\\cdot\\boldsymbol{\\xi}_{\\mathbf{q'}}) \\exp(i\\mathbf{q'}\\cdot\\mathbf{r}) + a_{\\mathbf{q'}}^{\\dagger} (-i\\mathbf{q'}\\cdot\\boldsymbol{\\xi}_{\\mathbf{q'}}) \\exp(-i\\mathbf{q'}\\cdot\\mathbf{r}) \\right)\n$$\nFor the specified longitudinal acoustic (LA) phonons, the polarization vector is parallel to the wavevector, $\\boldsymbol{\\xi}_{\\mathbf{q'}}=\\mathbf{q'}/q'$. The dot product is thus $\\mathbf{q'}\\cdot\\boldsymbol{\\xi}_{\\mathbf{q'}} = \\mathbf{q'}\\cdot(\\mathbf{q'}/q') = q'^{2}/q' = q'$. Substituting this gives:\n$$\n\\nabla\\cdot\\mathbf{u}(\\mathbf{r}) = i \\sum_{\\mathbf{q'}} \\sqrt{\\frac{\\hbar}{2\\rho V \\omega_{\\mathbf{q'}}}} q' \\left( a_{\\mathbf{q'}} \\exp(i\\mathbf{q'}\\cdot\\mathbf{r}) - a_{\\mathbf{q'}}^{\\dagger} \\exp(-i\\mathbf{q'}\\cdot\\mathbf{r}) \\right)\n$$\nNow we can write the full interaction Hamiltonian operator:\n$$\nH_{\\mathrm{ep}} = iD \\sum_{\\mathbf{q'}} \\sqrt{\\frac{\\hbar q'^{2}}{2\\rho V \\omega_{\\mathbf{q'}}}} \\left( a_{\\mathbf{q'}} \\exp(i\\mathbf{q'}\\cdot\\mathbf{r}) - a_{\\mathbf{q'}}^{\\dagger} \\exp(-i\\mathbf{q'}\\cdot\\mathbf{r}) \\right)\n$$\nThe matrix element is found by integrating over all space:\n$$\nM_{\\mathbf{k}+\\mathbf{q},\\mathbf{k}} = \\int_V \\psi_{\\mathbf{k}+\\mathbf{q}}^{*}(\\mathbf{r}) H_{\\mathrm{ep}}(\\mathbf{r}) \\psi_{\\mathbf{k}}(\\mathbf{r}) d^3\\mathbf{r}\n$$\nSubstituting the plane-wave forms for the electron states, $\\psi_{\\mathbf{k}}(\\mathbf{r})=V^{-1/2}\\exp(i\\mathbf{k}\\cdot\\mathbf{r})$, we get:\n$$\nM_{\\mathbf{k}+\\mathbf{q},\\mathbf{k}} = \\frac{1}{V} \\int_V \\exp(-i(\\mathbf{k}+\\mathbf{q})\\cdot\\mathbf{r}) \\left[ iD \\sum_{\\mathbf{q'}} \\sqrt{\\frac{\\hbar q'^{2}}{2\\rho V \\omega_{\\mathbf{q'}}}} \\left( a_{\\mathbf{q'}} e^{i\\mathbf{q'}\\cdot\\mathbf{r}} - a_{\\mathbf{q'}}^{\\dagger} e^{-i\\mathbf{q'}\\cdot\\mathbf{r}} \\right) \\right] \\exp(i\\mathbf{k}\\cdot\\mathbf{r}) d^3\\mathbf{r}\n$$\nWe can pull the sum and constants outside the integral:\n$$\nM_{\\mathbf{k}+\\mathbf{q},\\mathbf{k}} = \\frac{iD}{V} \\sum_{\\mathbf{q'}} \\sqrt{\\frac{\\hbar q'^{2}}{2\\rho V \\omega_{\\mathbf{q'}}}} \\left[ a_{\\mathbf{q'}} \\int_V \\! e^{i(\\mathbf{q'}-\\mathbf{q})\\cdot\\mathbf{r}} d^3\\mathbf{r} - a_{\\mathbf{q'}}^{\\dagger} \\int_V \\! e^{-i(\\mathbf{q'}+\\mathbf{q})\\cdot\\mathbf{r}} d^3\\mathbf{r} \\right]\n$$\nThe integrals over the periodic volume $V$ yield Kronecker deltas:\n$$\n\\int_V e^{i(\\mathbf{q'}-\\mathbf{q})\\cdot\\mathbf{r}} d^3\\mathbf{r} = V\\delta_{\\mathbf{q'},\\mathbf{q}} \\quad \\text{and} \\quad \\int_V e^{-i(\\mathbf{q'}+\\mathbf{q})\\cdot\\mathbf{r}} d^3\\mathbf{r} = V\\delta_{\\mathbf{q'},-\\mathbf{q}}\n$$\nThese deltas cause the sum over $\\mathbf{q'}$ to collapse to two terms. The first term (annihilation) survives only when $\\mathbf{q'}=\\mathbf{q}$, and the second term (creation) survives only when $\\mathbf{q'}=-\\mathbf{q}$.\n$$\nM_{\\mathbf{k}+\\mathbf{q},\\mathbf{k}} = \\frac{iD}{V} \\left[ \\sqrt{\\frac{\\hbar q^{2}}{2\\rho V \\omega_{\\mathbf{q}}}} a_{\\mathbf{q}} (V\\delta_{\\mathbf{q},\\mathbf{q}}) - \\sqrt{\\frac{\\hbar (-\\mathbf{q})^{2}}{2\\rho V \\omega_{-\\mathbf{q}}}} a_{-\\mathbf{q}}^{\\dagger} (V\\delta_{-\\mathbf{q},-\\mathbf{q}}) \\right]\n$$\nUsing the facts that $|\\mathbf{-q}|=q$ and the dispersion is isotropic, $\\omega_{-\\mathbf{q}}=\\omega_{\\mathbf{q}}$, simplifies the expression:\n$$\nM_{\\mathbf{k}+\\mathbf{q},\\mathbf{k}} = iD \\sqrt{\\frac{\\hbar q^{2}}{2\\rho V \\omega_{\\mathbf{q}}}} \\left( a_{\\mathbf{q}} - a_{-\\mathbf{q}}^{\\dagger} \\right)\n$$\nThis matrix element is an operator in the phonon Hilbert space. The first term, proportional to $a_{\\mathbf{q}}$, corresponds to the process of absorbing a phonon of wavevector $\\mathbf{q}$. The second term, proportional to $a_{-\\mathbf{q}}^{\\dagger}$, corresponds to emitting a phonon of wavevector $-\\mathbf{q}$.\n\nThe problem asks for the coefficient $g(\\mathbf{k},\\mathbf{q})$ associated with the absorption of a phonon with wavevector $\\mathbf{q}$. This is the coefficient multiplying the annihilation operator $a_{\\mathbf{q}}$:\n$$\ng(\\mathbf{k},\\mathbf{q}) = iD \\sqrt{\\frac{\\hbar q^{2}}{2\\rho V \\omega_{\\mathbf{q}}}}\n$$\nWe now substitute the given dispersion relation $\\omega_{\\mathbf{q}} = v_s q$:\n$$\ng(\\mathbf{k},\\mathbf{q}) = iD \\sqrt{\\frac{\\hbar q^{2}}{2\\rho V (v_s q)}} = iD \\sqrt{\\frac{\\hbar q}{2\\rho V v_s}}\n$$\nThe final step is to find the magnitude $|g(\\mathbf{k},\\mathbf{q})|$, as requested:\n$$\n|g(\\mathbf{k},\\mathbf{q})| = \\left| iD \\sqrt{\\frac{\\hbar q}{2\\rho V v_s}} \\right| = D \\sqrt{\\frac{\\hbar q}{2\\rho V v_s}}\n$$\nThis is the electron-phonon coupling strength for LA phonons within the deformation potential approximation. Note that due to the plane-wave approximation for the electronic states, the result is independent of the electron's initial crystal momentum $\\mathbf{k}$.",
            "answer": "$$\n\\boxed{D \\sqrt{\\frac{\\hbar q}{2 \\rho V v_{s}}}}\n$$"
        },
        {
            "introduction": "While analytical models provide crucial insight, modern computational practice relies on numerical methods to determine coupling strengths. The frozen-phonon approach is a direct and physically intuitive method for computing electron-phonon matrix elements from an electronic Hamiltonian. This practice guides you through implementing this technique within a tight-binding model, showing how to extract the coupling matrix element $g(\\mathbf{k},\\mathbf{q})$ by calculating the change in the Hamiltonian in response to a static lattice distortion .",
            "id": "3448027",
            "problem": "Consider a one-dimensional monatomic chain under the Born–Oppenheimer approximation, where the electronic problem is solved for fixed ionic positions and the electronic interaction with lattice vibrations is captured by the Kohn–Sham (KS) potential. The objective is to construct a frozen-phonon supercell representation of a phonon mode labeled by $(\\mathbf{q}\\nu)$ and to extract the electron–phonon coupling matrix element $g_{mn\\nu}(\\mathbf{k},\\mathbf{q})$ via finite differences of the KS potential. Assume a single electronic band with one orbital per site, and tight-binding dynamics for the electrons.\n\nFundamental base assumptions:\n- The Born–Oppenheimer approximation states that electrons adjust instantaneously to ionic positions; hence the KS potential $V_{\\mathrm{KS}}(\\{\\mathbf{R}_\\kappa\\})$ depends parametrically on the ionic coordinates.\n- For small displacements, the change in the KS potential (or the electronic Hamiltonian) due to a phonon normal mode can be approximated by a linear response, which is accessible via finite differences around zero displacement.\n- Bloch’s theorem applies for periodic systems, providing normalized states $|\\psi_{n\\mathbf{k}}\\rangle$ with components $\\psi_{n\\mathbf{k}}(j) = e^{i\\mathbf{k}\\cdot\\mathbf{R}_j}/\\sqrt{N}$ for a monatomic chain with $N$ sites at positions $\\mathbf{R}_j$.\n\nIn this problem, use a one-dimensional monatomic chain of $N$ sites with lattice constant $a$. The unperturbed tight-binding Hamiltonian is constructed with on-site energy $\\varepsilon_0$ and nearest-neighbor hopping $t_0$. The electron–lattice coupling arises from:\n- An on-site deformation potential contribution with strength $\\lambda$, which shifts the on-site energy by an amount proportional to the local displacement $u_j$.\n- A distance-dependent hopping with parameter $\\beta$ through $t(d) = t_0 \\exp\\left[-\\beta\\left(\\frac{d}{a} - 1\\right)\\right]$, where $d$ is the instantaneous distance between neighboring sites. When atoms are displaced by $u_j$, the distance between sites $j$ and $j+1$ becomes $a + (u_{j+1} - u_j)$, and thus the hopping changes accordingly.\n\nRepresent a phonon mode $(\\mathbf{q}\\nu)$ in this supercell by a real frozen-phonon displacement field\n$$\nu_j = A \\cos(\\mathbf{q}\\cdot \\mathbf{R}_j),\n$$\nwhere $A$ is a small amplitude and $\\mathbf{q}$ is commensurate with the supercell size, i.e., $\\mathbf{q} = \\frac{2\\pi m}{N a}$ for integer $m$. Construct two displaced Hamiltonians $H(+A)$ and $H(-A)$ and form the finite-difference perturbation\n$$\n\\Delta H = \\frac{H(+A) - H(-A)}{2A}.\n$$\nUse Bloch states of the unperturbed Hamiltonian $H(0)$ to define\n$$\ng_{mn\\nu}(\\mathbf{k},\\mathbf{q}) = \\langle \\psi_{m\\mathbf{k}} | \\Delta H | \\psi_{n,\\mathbf{k}+\\mathbf{q}} \\rangle,\n$$\nfor the single-band case $m=n$, where $|\\psi_{n\\mathbf{k}}\\rangle$ is the normalized Bloch state vector at wavevector $\\mathbf{k}$ and $|\\psi_{n,\\mathbf{k}+\\mathbf{q}}\\rangle$ is the corresponding state at $\\mathbf{k}+\\mathbf{q}$ (wrapped back into the Brillouin zone if needed). In this setup, compute the magnitude\n$$\n|g(\\mathbf{k},\\mathbf{q})| = \\left| \\langle \\psi_{\\mathbf{k}} | \\Delta H | \\psi_{\\mathbf{k}+\\mathbf{q}} \\rangle \\right|\n$$\nas a dimensionless energy quantity in the same units as the tight-binding energy scale. Use angles in radians, and use dimensionless units for all quantities; energies are unitless, lengths are unitless, and angles are in radians.\n\nAlgorithmic specifications to be implemented:\n1. Construct positions $\\mathbf{R}_j = j a$ for $j \\in \\{0,1,\\dots,N-1\\}$.\n2. Build $H(0)$ with on-site terms $\\varepsilon_0$ and nearest-neighbor hopping $t_0$ with periodic boundary conditions.\n3. For a given displacement field $u_j = A \\cos(\\mathbf{q} \\mathbf{R}_j)$, construct $H(+A)$ and $H(-A)$:\n   - On-site energy at site $j$: $\\varepsilon_j(\\pm A) = \\varepsilon_0 + \\lambda\\, u_j(\\pm A)$.\n   - Hopping between $j$ and $j+1$:\n     $$\n     t_{j,j+1}(\\pm A) = t_0 \\exp\\left[-\\beta\\left(\\frac{a + [u_{j+1}(\\pm A) - u_j(\\pm A)]}{a} - 1 \\right)\\right].\n     $$\n4. Compute $\\Delta H = [H(+A) - H(-A)]/(2A)$.\n5. For discrete wavevectors consistent with the supercell, define Bloch vectors $|\\psi_{\\mathbf{k}}\\rangle$ and $|\\psi_{\\mathbf{k}+\\mathbf{q}}\\rangle$ with components $\\psi_{\\mathbf{k}}(j) = e^{i\\mathbf{k}\\mathbf{R}_j}/\\sqrt{N}$ and compute $|g(\\mathbf{k},\\mathbf{q})|$.\n6. Ensure that $\\mathbf{k}$ and $\\mathbf{q}$ lie on the discrete grid $\\frac{2\\pi}{N a}\\mathbb{Z}$ so that $|\\psi_{\\mathbf{k}+\\mathbf{q}}\\rangle$ is also a valid Bloch state.\n\nTest suite:\nUse $N=8$ and $a=1$ for all cases, angles in radians, and dimensionless units for energy and length. For each test, compute and report the float value $|g(\\mathbf{k},\\mathbf{q})|$.\n\n- Test 1 (general case with both on-site and hopping coupling):\n  - $t_0 = -1.0$, $\\varepsilon_0 = 0.0$, $\\lambda = 0.5$, $\\beta = 2.0$,\n  - $A = 1\\times 10^{-4}$,\n  - $\\mathbf{k} = \\frac{2\\pi}{N a} \\cdot 1$, $\\mathbf{q} = \\frac{2\\pi}{N a} \\cdot 1$.\n\n- Test 2 (boundary case with $\\mathbf{q}=0$ and extremely small amplitude):\n  - $t_0 = -1.0$, $\\varepsilon_0 = 0.0$, $\\lambda = 0.5$, $\\beta = 2.0$,\n  - $A = 1\\times 10^{-6}$,\n  - $\\mathbf{k} = \\frac{2\\pi}{N a} \\cdot 0$, $\\mathbf{q} = \\frac{2\\pi}{N a} \\cdot 0$.\n\n- Test 3 (hopping-only coupling at zone boundary):\n  - $t_0 = -1.0$, $\\varepsilon_0 = 0.0$, $\\lambda = 0.0$, $\\beta = 3.0$,\n  - $A = 1\\times 10^{-4}$,\n  - $\\mathbf{k} = \\frac{2\\pi}{N a} \\cdot 2$, $\\mathbf{q} = \\frac{2\\pi}{N a} \\cdot 4$.\n\n- Test 4 (on-site-only coupling with larger $\\lambda$ and no hopping position dependence):\n  - $t_0 = -1.0$, $\\varepsilon_0 = 0.0$, $\\lambda = 1.0$, $\\beta = 0.0$,\n  - $A = 1\\times 10^{-4}$,\n  - $\\mathbf{k} = \\frac{2\\pi}{N a} \\cdot 3$, $\\mathbf{q} = \\frac{2\\pi}{N a} \\cdot 2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with the four float results placed in the order of the tests given above, for example, $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$. No other text should be printed.",
            "solution": "The problem presents a well-posed and scientifically sound task within the domain of computational materials science. It asks for the calculation of the electron-phonon coupling matrix element, $g(\\mathbf{k},\\mathbf{q})$, for a one-dimensional monatomic tight-binding model using the frozen-phonon method. The problem is self-contained, with all necessary physical parameters, model definitions, and a clear algorithmic specification. No internal contradictions, ambiguities, or violations of physical principles are present. Therefore, we proceed with the solution.\n\nThe solution is constructed by following the algorithmic steps outlined in the problem statement. This involves representing the electronic system and its interaction with a static lattice distortion (a \"frozen phonon\") via Hamiltonian matrices and then using these to compute the coupling matrix element between electronic Bloch states.\n\nFirst, we define the geometric and physical parameters of the system. The system is a one-dimensional chain of $N$ atoms with lattice constant $a$. The positions of the atoms in the unperturbed lattice are given by $R_j = j \\cdot a$ for $j \\in \\{0, 1, \\dots, N-1\\}$. All calculations will be performed for $N=8$ and $a=1$. The electronic structure is described by a single-orbital tight-binding model with on-site energy $\\varepsilon_0$ and nearest-neighbor hopping $t_0$.\n\nThe core of the frozen-phonon method is to calculate the change in the electronic Hamiltonian due to a specific pattern of atomic displacements. The chosen phonon mode, identified by its wavevector $\\mathbf{q}$, is represented by a static, sinusoidal displacement field $u_j = A \\cos(\\mathbf{q} R_j)$, where $A$ is a small amplitude.\n\nWe must construct the Hamiltonian matrices for the system with positive and negative displacements, denoted $H(+A)$ and $H(-A)$ respectively. These are $N \\times N$ matrices in the site basis $\\{|j\\rangle\\}$. The matrix elements are determined by the specified electron-lattice coupling mechanisms:\n\n1.  **On-site energy modulation**: The diagonal elements of the Hamiltonian, representing the on-site energies, are modified by the local atomic displacement. For a displacement field $u_j(\\pm A) = \\pm A \\cos(\\mathbf{q} R_j)$, the on-site energy at site $j$ becomes $\\varepsilon_j(\\pm A) = \\varepsilon_0 + \\lambda u_j(\\pm A)$. This corresponds to the diagonal matrix elements $H(\\pm A)_{jj} = \\varepsilon_0 \\pm \\lambda A \\cos(\\mathbf{q} R_j)$.\n\n2.  **Hopping parameter modulation**: The off-diagonal elements, representing the hopping integrals between adjacent sites, depend on the interatomic distance. The distance between sites $j$ and $j+1$ becomes $d_{j,j+1}(\\pm A) = a + u_{j+1}(\\pm A) - u_j(\\pm A)$. The corresponding hopping integral is given by $t_{j,j+1}(\\pm A) = t_0 \\exp\\left[-\\beta\\left(\\frac{d_{j,j+1}(\\pm A)}{a} - 1\\right)\\right]$. This simplifies to $t_{j,j+1}(\\pm A) = t_0 \\exp\\left[-\\frac{\\beta}{a} (u_{j+1}(\\pm A) - u_j(\\pm A))\\right]$. These values, along with periodic boundary conditions (connecting site $N-1$ to site $0$), define the nearest-neighbor off-diagonal elements $H(\\pm A)_{j, j+1}$ and $H(\\pm A)_{j+1, j}$.\n\nThe change in the Hamiltonian to first order in displacement is approximated using a central finite difference of the two constructed Hamiltonians:\n$$\n\\Delta H = \\frac{H(+A) - H(-A)}{2A}\n$$\nThis matrix, $\\Delta H$, represents the electron-phonon interaction potential, $\\partial H / \\partial u$, for the specific phonon mode $(\\mathbf{q}\\nu)$.\n\nThe coupling matrix element $g(\\mathbf{k},\\mathbf{q})$ quantifies the strength of scattering of an electron from a Bloch state $|\\psi_{\\mathbf{k}}\\rangle$ to a state $|\\psi_{\\mathbf{k}+\\mathbf{q}}\\rangle$ by this phonon. The states are the normalized Bloch states of the *unperturbed* system, whose components in the site basis are given by Bloch's theorem:\n$$\n\\psi_{\\mathbf{k}}(j) = \\langle j | \\psi_{\\mathbf{k}} \\rangle = \\frac{1}{\\sqrt{N}} e^{i\\mathbf{k}R_j}\n$$\nThe wavevectors $\\mathbf{k}$ and $\\mathbf{q}$ are defined on the discrete grid of the supercell, $\\frac{2\\pi}{Na}\\mathbb{Z}$, ensuring the periodicity of the Bloch functions.\n\nThe matrix element is then computed as the expectation value:\n$$\ng(\\mathbf{k},\\mathbf{q}) = \\langle \\psi_{\\mathbf{k}} | \\Delta H | \\psi_{\\mathbf{k}+\\mathbf{q}} \\rangle\n$$\nThis calculation is performed as a matrix-vector product. In numerical implementation, we construct the column vectors for $|\\psi_{\\mathbf{k}}\\rangle$ and $|\\psi_{\\mathbf{k}+\\mathbf{q}}\\rangle$ and compute the complex scalar value $g(\\mathbf{k},\\mathbf{q})$. Specifically, this is calculated as $\\mathbf{v}_{\\mathbf{k}}^\\dagger \\Delta H \\mathbf{v}_{\\mathbf{k}+\\mathbf{q}}$, where $\\mathbf{v}_{\\mathbf{k}}$ is the column vector representing state $|\\psi_{\\mathbf{k}}\\rangle$ and $\\dagger$ denotes the conjugate transpose.\n\nFinally, the problem asks for the magnitude of this complex quantity, $|g(\\mathbf{k},\\mathbf{q})|$. The following program implements this procedure for each of the four test cases provided.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_g(params):\n    \"\"\"\n    Computes the electron-phonon coupling matrix element |g(k,q)|.\n    \n    Args:\n        params (dict): A dictionary containing all physical and test case parameters.\n            - N (int): Number of sites in the chain.\n            - a (float): Lattice constant.\n            - t0 (float): Unperturbed nearest-neighbor hopping.\n            - eps0 (float): Unperturbed on-site energy.\n            - lam (float): On-site deformation potential strength (lambda).\n            - beta (float): Hopping distance-dependence parameter.\n            - A (float): Frozen-phonon amplitude.\n            - k_idx (int): Integer index for electron wavevector k.\n            - q_idx (int): Integer index for phonon wavevector q.\n\n    Returns:\n        float: The magnitude of the electron-phonon coupling matrix element, |g(k,q)|.\n    \"\"\"\n    # Unpack parameters\n    N = params['N']\n    a = params['a']\n    t0 = params['t0']\n    eps0 = params['eps0']\n    lam = params['lam']\n    beta = params['beta']\n    A = params['A']\n    k_idx = params['k_idx']\n    q_idx = params['q_idx']\n\n    # 1. Construct positions and wavevectors\n    positions = np.arange(N) * a\n    k = (2 * np.pi / (N * a)) * k_idx\n    q = (2 * np.pi / (N * a)) * q_idx\n\n    def build_hamiltonian(disp_factor):\n        \"\"\"\n        Builds the tight-binding Hamiltonian for a given displacement factor.\n        - disp_factor = 0 for unperturbed H(0).\n        - disp_factor = +1 for H(+A).\n        - disp_factor = -1 for H(-A).\n        \"\"\"\n        H = np.zeros((N, N), dtype=np.complex128)\n        \n        # Calculate displacements u_j for the given factor\n        displacements = disp_factor * A * np.cos(q * positions)\n        \n        for j in range(N):\n            # 3a. On-site energy\n            H[j, j] = eps0 + lam * displacements[j]\n            \n            # 3b. Hopping term\n            j_next = (j + 1) % N\n            \n            # Change in displacement between neighbors\n            du = displacements[j_next] - displacements[j]\n            \n            # Distance-dependent hopping term\n            hopping_term = t0 * np.exp(-beta * du / a)\n            \n            H[j, j_next] = hopping_term\n            H[j_next, j] = hopping_term\n            \n        return H\n\n    # 3. Construct H(+A) and H(-A)\n    H_plus_A = build_hamiltonian(1.0)\n    H_minus_A = build_hamiltonian(-1.0)\n\n    # 4. Compute the finite-difference perturbation Delta H\n    if A == 0:\n        # Avoid division by zero, although not expected in tests\n        Delta_H = np.zeros((N, N), dtype=np.complex128)\n    else:\n        Delta_H = (H_plus_A - H_minus_A) / (2 * A)\n\n    # 5. Define Bloch state vectors\n    psi_k = (1 / np.sqrt(N)) * np.exp(1j * k * positions)\n    psi_kq = (1 / np.sqrt(N)) * np.exp(1j * (k + q) * positions)\n\n    # 6. Compute the matrix element g(k,q) = <psi_k|Delta_H|psi_{k+q}>\n    g_kq = np.vdot(psi_k, Delta_H @ psi_kq)\n\n    # 7. Return the magnitude\n    return np.abs(g_kq)\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test 1: general case\n        {'N': 8, 'a': 1.0, 't0': -1.0, 'eps0': 0.0, 'lam': 0.5, 'beta': 2.0, 'A': 1e-4, 'k_idx': 1, 'q_idx': 1},\n        # Test 2: boundary case q=0\n        {'N': 8, 'a': 1.0, 't0': -1.0, 'eps0': 0.0, 'lam': 0.5, 'beta': 2.0, 'A': 1e-6, 'k_idx': 0, 'q_idx': 0},\n        # Test 3: hopping-only coupling\n        {'N': 8, 'a': 1.0, 't0': -1.0, 'eps0': 0.0, 'lam': 0.0, 'beta': 3.0, 'A': 1e-4, 'k_idx': 2, 'q_idx': 4},\n        # Test 4: on-site-only coupling\n        {'N': 8, 'a': 1.0, 't0': -1.0, 'eps0': 0.0, 'lam': 1.0, 'beta': 0.0, 'A': 1e-4, 'k_idx': 3, 'q_idx': 2},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_g(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Calculating macroscopic properties like the total electron-phonon coupling strength, $\\lambda$, requires integrating individual matrix elements over the entire Brillouin zone. This process can encounter numerical instabilities, most notably an infrared divergence for acoustic modes as $\\mathbf{q} \\to \\mathbf{0}$. This exercise focuses on this critical issue, tasking you with implementing and comparing different physically-grounded regularization schemes, such as static screening and the acoustic sum rule, to manage the divergence and obtain a meaningful physical result .",
            "id": "3447977",
            "problem": "You will construct and analyze a controlled, purely mathematical model of the dimensionless electron-phonon coupling parameter, focusing on the infrared behavior of soft long-wavelength acoustic modes and three regularization strategies grounded in standard physical principles. The goal is to demonstrate, in a simplified setting, that a naive long-wavelength treatment can yield a divergent dimensionless coupling as the phonon wavevector magnitude approaches zero, and then to regularize the divergence by incorporating three effects: static screening, finite-size momentum resolution, and the acoustic sum rule. Your program must compute the specified model quantities for a small test suite and print the results in the required format.\n\nBackground and model setup:\n- Consider an isotropic, single-band metal in a $2$-dimensional square Brillouin zone of side length $2\\pi$ (dimensionless units), sampled on an $N \\times N$ uniform grid in $\\mathbf{q}$-space with spacing $\\Delta q = 2\\pi/N$ in each direction, excluding the single $\\Gamma$-point at $\\mathbf{q} = \\mathbf{0}$.\n- Assume a single longitudinal acoustic branch with dispersion $ \\omega(\\mathbf{q}) = c \\, |\\mathbf{q}|$ with $c > 0$ (dimensionless).\n- Adopt a model functional for the long-wavelength contribution to the dimensionless coupling,\n$$\n\\lambda_{\\mathrm{model}} = C \\sum_{\\mathbf{q} \\neq \\mathbf{0}} \\frac{|g(\\mathbf{q})|^2}{\\omega(\\mathbf{q})^2} \\, (\\Delta q)^2,\n$$\nwhere $C = (2\\pi)^{-2}$, the sum runs over the discrete $\\mathbf{q}$-grid excluding $\\mathbf{q}=\\mathbf{0}$, and $g(\\mathbf{q})$ is a model electron-phonon matrix element specified below. This functional imitates the low-energy structure of the integrand arising from Fermi’s golden rule in metals at zero temperature, with all materials-specific prefactors absorbed into $g(\\mathbf{q})$ and $C$. All quantities are dimensionless.\n\nDefine four strategies for $g(\\mathbf{q})$:\n- Naive (unscreened, no sum rule): $g_{\\mathrm{naive}}(\\mathbf{q}) = g_0$, with $g_0 > 0$ constant.\n- Static screening: $g_{\\mathrm{scr}}(\\mathbf{q}) = \\dfrac{g_0}{1 + \\left(\\dfrac{q_s}{|\\mathbf{q}|}\\right)^2} = g_0 \\, \\dfrac{|\\mathbf{q}|^2}{|\\mathbf{q}|^2 + q_s^2}$, with screening wavevector $q_s > 0$.\n- Acoustic sum rule enforced: $g_{\\mathrm{asr}}(\\mathbf{q}) = g_0 \\, \\dfrac{|\\mathbf{q}|}{Q_0}$, with a fixed wavevector scale $Q_0 > 0$.\n- Combined screening and acoustic sum rule: $g_{\\mathrm{comb}}(\\mathbf{q}) = \\left[g_0 \\, \\dfrac{|\\mathbf{q}|}{Q_0}\\right] \\, \\dfrac{1}{1 + \\left(\\dfrac{q_s}{|\\mathbf{q}|}\\right)^2} = g_0 \\, \\dfrac{|\\mathbf{q}|^3}{Q_0 \\left(|\\mathbf{q}|^2 + q_s^2\\right)}$.\n\nComputational task:\n- Implement the discrete sum for $\\lambda_{\\mathrm{model}}$ exactly as defined above for each specified strategy and parameter set.\n- Use the square grid in $\\mathbf{q}$ with points $q_x, q_y \\in \\left\\{-\\pi + \\Delta q, -\\pi + 2\\Delta q, \\dots, \\pi\\right\\}$, ensuring that the single point with $|\\mathbf{q}| = 0$ is excluded from the sum to avoid division by zero.\n- Use $c = 1$, $g_0 = 1$, and $Q_0 = \\pi$ in all cases unless otherwise stated. All quantities are dimensionless.\n\nTest suite:\nCompute and report $\\lambda_{\\mathrm{model}}$ for the following parameter sets, each yielding one float:\n- Test $1$ (naive, coarse grid): $N = 32$, strategy $=$ naive.\n- Test $2$ (naive, fine grid): $N = 256$, strategy $=$ naive.\n- Test $3$ (screening only): $N = 256$, strategy $=$ static screening with $q_s = 0.2$.\n- Test $4$ (acoustic sum rule only): $N = 256$, strategy $=$ acoustic sum rule with $Q_0 = \\pi$.\n- Test $5$ (combined screening and acoustic sum rule): $N = 256$, strategy $=$ combined with $q_s = 0.2$ and $Q_0 = \\pi$.\n\nRequirements:\n- All reported $\\lambda_{\\mathrm{model}}$ values are dimensionless. Report each as a float rounded to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the exact order of Tests $1$–$5$, for example, $[x_1,x_2,x_3,x_4,x_5]$, where each $x_i$ is the rounded float result for Test $i$.\n\nScientific realism constraints:\n- Start conceptually from well-tested facts: long-wavelength acoustic dispersion $\\omega(\\mathbf{q}) \\propto |\\mathbf{q}|$, and translational invariance enforcing vanishing coupling to a uniform displacement (acoustic sum rule), while static electronic screening suppresses long-range coupling at small $|\\mathbf{q}|$.\n- Ensure that the naive constant coupling with acoustic $\\omega(\\mathbf{q})$ leads to an infrared divergent integrand as $|\\mathbf{q}| \\to 0$ in $2$ dimensions, which is cut off by finite grid resolution $N$ (finite-size effect), while the other strategies regularize the divergence intrinsically.\n\nFinal output format:\n- Your program must print exactly one line: a single Python list literal of $5$ floats rounded to $6$ decimal places, in the order of Tests $1$–$5$, with no extra text or whitespace beyond what is standard for list formatting in Python.",
            "solution": "The problem statement is evaluated to be valid. It is scientifically grounded, well-posed, and objective. It presents a simplified but conceptually sound mathematical model to investigate the infrared behavior of electron-phonon coupling and the effect of different regularization schemes. All parameters, equations, and computational tasks are defined unambiguously, allowing for a unique and verifiable solution.\n\nThe core task is to compute the dimensionless electron-phonon coupling parameter, $\\lambda_{\\mathrm{model}}$, defined as a discrete sum over a $2$-dimensional $\\mathbf{q}$-space grid:\n$$\n\\lambda_{\\mathrm{model}} = C \\sum_{\\mathbf{q} \\neq \\mathbf{0}} \\frac{|g(\\mathbf{q})|^2}{\\omega(\\mathbf{q})^2} \\, (\\Delta q)^2\n$$\nThe problem defines all components of this equation. The Brillouin zone is a square of side length $2\\pi$, sampled on an $N \\times N$ grid. This leads to a grid spacing of $\\Delta q = 2\\pi/N$. The wavevector components are $q_x, q_y \\in \\left\\{-\\pi + \\Delta q, -\\pi + 2\\Delta q, \\dots, \\pi\\right\\}$. The summation explicitly excludes the $\\Gamma$-point, $\\mathbf{q} = (0, 0)$.\n\nThe constant prefactor is $C = (2\\pi)^{-2}$. The model employs a linear dispersion for long-wavelength acoustic phonons, $\\omega(\\mathbf{q}) = c |\\mathbf{q}|$, with the speed of sound $c=1$ for all calculations. This gives a denominator of $\\omega(\\mathbf{q})^2 = |\\mathbf{q}|^2$.\n\nThe primary variation lies in the model for the electron-phonon matrix element, $g(\\mathbf{q})$. Four strategies are specified, with constants $g_0=1$ and $Q_0=\\pi$.\n\n1.  **Naive Model**: $g_{\\mathrm{naive}}(\\mathbf{q}) = g_0$.\n    The summand, the term inside the summation, becomes:\n    $$\n    \\frac{|g_{\\mathrm{naive}}(\\mathbf{q})|^2}{\\omega(\\mathbf{q})^2} = \\frac{g_0^2}{c^2 |\\mathbf{q}|^2}\n    $$\n    In the continuum limit ($N \\to \\infty$), the sum becomes an integral, $\\int \\frac{1}{|\\mathbf{q}|^2} d^2q$. In polar coordinates, this is proportional to $\\int \\frac{1}{q^2} q \\, dq = \\int \\frac{1}{q} dq$, which is logarithmically divergent as $|\\mathbf{q}| \\to 0$. In the discrete sum, the divergence is cut off by the smallest non-zero $|\\mathbf{q}|$, which is on the order of $\\Delta q \\propto 1/N$. Consequently, $\\lambda_{\\mathrm{model}}$ is expected to increase as $N$ increases.\n\n2.  **Static Screening Model**: $g_{\\mathrm{scr}}(\\mathbf{q}) = g_0 \\frac{|\\mathbf{q}|^2}{|\\mathbf{q}|^2 + q_s^2}$.\n    This model introduces a term that suppresses the coupling at small $|\\mathbf{q}|$. The summand is:\n    $$\n    \\frac{|g_{\\mathrm{scr}}(\\mathbf{q})|^2}{\\omega(\\mathbf{q})^2} = \\frac{1}{c^2 |\\mathbf{q}|^2} \\left( g_0 \\frac{|\\mathbf{q}|^2}{|\\mathbf{q}|^2 + q_s^2} \\right)^2 = \\frac{g_0^2}{c^2} \\frac{|\\mathbf{q}|^2}{(|\\mathbf{q}|^2 + q_s^2)^2}\n    $$\n    As $|\\mathbf{q}| \\to 0$, this term behaves as $\\frac{g_0^2}{c^2 q_s^4} |\\mathbf{q}|^2$, which goes to zero. This regularization removes the singularity at the origin, and $\\lambda_{\\mathrm{model}}$ is expected to converge to a finite value as $N \\to \\infty$.\n\n3.  **Acoustic Sum Rule (ASR) Model**: $g_{\\mathrm{asr}}(\\mathbf{q}) = g_0 \\frac{|\\mathbf{q}|}{Q_0}$.\n    This form is motivated by the physical principle that a uniform translation of the crystal ($\\mathbf{q}=\\mathbf{0}$ phonon) cannot scatter electrons, forcing the matrix element to vanish. The leading order behavior is linear in $|\\mathbf{q}|$. The summand becomes:\n    $$\n    \\frac{|g_{\\mathrm{asr}}(\\mathbf{q})|^2}{\\omega(\\mathbf{q})^2} = \\frac{1}{c^2 |\\mathbf{q}|^2} \\left( g_0 \\frac{|\\mathbf{q}|}{Q_0} \\right)^2 = \\frac{g_0^2}{c^2 Q_0^2}\n    $$\n    The summand is a constant, independent of $\\mathbf{q}$. The singularity is perfectly canceled. The value of $\\lambda_{\\mathrm{model}}$ is determined by the sum over a constant, which is simply the constant multiplied by the number of grid points ($N^2-1$). The result will be very weakly dependent on $N$, converging rapidly to a finite value.\n\n4.  **Combined Model**: $g_{\\mathrm{comb}}(\\mathbf{q}) = g_0 \\frac{|\\mathbf{q}|^3}{Q_0 (|\\mathbf{q}|^2 + q_s^2)}$.\n    This model incorporates both the ASR behavior ($\\propto |\\mathbf{q}|$) and static screening. The summand is:\n    $$\n    \\frac{|g_{\\mathrm{comb}}(\\mathbf{q})|^2}{\\omega(\\mathbf{q})^2} = \\frac{1}{c^2 |\\mathbf{q}|^2} \\left( g_0 \\frac{|\\mathbf{q}|^3}{Q_0 (|\\mathbf{q}|^2 + q_s^2)} \\right)^2 = \\frac{g_0^2}{c^2 Q_0^2} \\frac{|\\mathbf{q}|^4}{(|\\mathbf{q}|^2 + q_s^2)^2}\n    $$\n    As $|\\mathbf{q}| \\to 0$, this term behaves as $\\frac{g_0^2}{c^2 Q_0^2 q_s^4} |\\mathbf{q}|^4$, which vanishes even more strongly than the screening-only model. This provides a very effective regularization, leading to a rapidly convergent sum.\n\nThe computational procedure is as follows:\nFor each test case, we define the grid size $N$ and the relevant parameters. We construct the $N \\times N$ grid of $(q_x, q_y)$ vectors. For each point on the grid, we calculate $|\\mathbf{q}|^2$. We then compute the corresponding $|g(\\mathbf{q})|^2$ based on the chosen strategy. The summand is calculated as $|g(\\mathbf{q})|^2 / (c^2 |\\mathbf{q}|^2)$. To handle the exclusion of $\\mathbf{q}=\\mathbf{0}$ and prevent division-by-zero errors, the contribution from the grid point where $|\\mathbf{q}|^2 = 0$ is set to zero. The total sum is computed by summing the summand values over the entire grid. Finally, this sum is multiplied by the prefactors $C (\\Delta q)^2 = (2\\pi)^{-2} (2\\pi/N)^2 = 1/N^2$ to obtain $\\lambda_{\\mathrm{model}}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n\n    def calculate_lambda(N, strategy, qs=None):\n        \"\"\"\n        Calculates the dimensionless electron-phonon coupling parameter lambda_model.\n\n        Args:\n            N (int): The grid size (N x N).\n            strategy (str): The model for g(q). One of 'naive', 'static_screening',\n                            'acoustic_sum_rule', 'combined'.\n            qs (float, optional): The screening wavevector. Defaults to None.\n\n        Returns:\n            float: The calculated value of lambda_model.\n        \"\"\"\n        # Define constants from the problem statement\n        g0 = 1.0\n        c = 1.0\n        Q0 = np.pi\n        \n        # Grid parameters\n        delta_q = 2.0 * np.pi / N\n        C = 1.0 / (2.0 * np.pi)**2\n        \n        # Create the q-space grid\n        q_coords = -np.pi + np.arange(1, N + 1) * delta_q\n        qx, qy = np.meshgrid(q_coords, q_coords)\n        \n        # Calculate q^2 and omega^2 for each grid point\n        q_sq = qx**2 + qy**2\n        omega_sq = c**2 * q_sq\n        \n        # Calculate |g(q)|^2 based on the chosen strategy\n        if strategy == 'naive':\n            # g(q) = g0\n            g_sq = g0**2 * np.ones_like(q_sq)\n        elif strategy == 'static_screening':\n            # g(q) = g0 * |q|^2 / (|q|^2 + qs^2)\n            g_sq = (g0 * q_sq / (q_sq + qs**2))**2\n        elif strategy == 'acoustic_sum_rule':\n            # g(q) = g0 * |q| / Q0\n            g_sq = (g0**2 / Q0**2) * q_sq\n        elif strategy == 'combined':\n            # g(q) = g0 * |q|^3 / (Q0 * (|q|^2 + qs^2))\n            # |g(q)|^2 = (g0^2/Q0^2) * |q|^6 / (|q|^2 + qs^2)^2\n            # |g(q)|^2 = (g0^2/Q0^2) * q_sq^3 / (q_sq + qs^2)^2 (using q_sq = |q|^2)\n            g_sq = (g0**2 / Q0**2) * (q_sq**3) / (q_sq + qs**2)**2\n        else:\n            raise ValueError(\"Unknown strategy\")\n            \n        # The summand is |g(q)|^2 / omega(q)^2.\n        # We use np.divide to handle the q=0 case, where omega_sq is 0.\n        # The problem states to sum over q != 0, so the contribution at q=0 is 0.\n        summand = np.divide(g_sq, omega_sq, out=np.zeros_like(g_sq, dtype=float), where=(q_sq != 0))\n        \n        # Calculate lambda_model by summing and multiplying by prefactors.\n        # The prefactor C * (delta_q)^2 simplifies to 1/N^2\n        prefactor = C * delta_q**2\n        lambda_val = prefactor * np.sum(summand)\n        \n        return lambda_val\n\n    # Test suite from the problem statement\n    test_cases = [\n        {'N': 32, 'strategy': 'naive', 'params': {}},\n        {'N': 256, 'strategy': 'naive', 'params': {}},\n        {'N': 256, 'strategy': 'static_screening', 'params': {'qs': 0.2}},\n        {'N': 256, 'strategy': 'acoustic_sum_rule', 'params': {}},\n        {'N': 256, 'strategy': 'combined', 'params': {'qs': 0.2}},\n    ]\n\n    results = []\n    for case in test_cases:\n        lambda_result = calculate_lambda(case['N'], case['strategy'], **case['params'])\n        # Round the result to 6 decimal places as required\n        results.append(round(lambda_result, 6))\n\n    # Print the final output in the exact specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}