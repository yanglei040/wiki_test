{
    "hands_on_practices": [
        {
            "introduction": "为了建立坚实的理论基础，我们的第一个实践练习是从基本原理出发，推导热膨胀系数的表达式。这个练习  将引导您在经典高温极限下，建立微观格林艾森参数与宏观热力学性质之间的联系，从而掌握准谐近似的核心公式。",
            "id": "440973",
            "problem": "一个简单的各向同性晶体固体使用准谐近似进行建模。在该模型中，声子频率 $\\omega_i$ 取决于晶体体积 $V$。这种依赖关系由一个与模式无关的格林艾森参数 $\\gamma$ 来表征，定义为 $\\gamma = -\\frac{d(\\ln \\omega_i)}{d(\\ln V)}$。该晶体由体积 $V$ 中的 $N$ 个原子组成，其等温体弹模量为 $B_T$，并维持在足够高的温度 $T$ 下，使得经典杜隆-珀蒂定律对于热容是一个有效的近似。该晶体的行为由统计力学和热力学原理决定。该固体的线性热膨胀系数 $\\alpha_L$ 是多少？请用 $\\gamma$、$B_T$、原子数密度 $n=N/V$ 和玻尔兹曼常数 $k_B$ 表示你的答案。",
            "solution": "1. 3N 模式在经典极限下的振动自由能：\n$$F_{\\rm vib}=-k_BT\\sum_{i=1}^{3N}\\ln\\frac{k_BT}{\\hbar\\omega_i}.$$\n2. 热压强\n$$p_{\\rm th}=-\\Bigl(\\frac{\\partial F_{\\rm vib}}{\\partial V}\\Bigr)_T\n=-k_BT\\sum_i\\frac{\\partial\\ln\\omega_i}{\\partial V}.$$\n3. 使用 $\\gamma=-\\dfrac{d\\ln\\omega_i}{d\\ln V}=-V\\frac{d\\ln\\omega_i}{dV}$ 可得\n$$\\frac{\\partial\\ln\\omega_i}{\\partial V}=-\\frac{\\gamma}{V},$$\n因此\n$$p_{\\rm th}=-k_BT\\,(3N)\\Bigl(-\\frac{\\gamma}{V}\\Bigr)\n=\\frac{3N\\gamma k_BT}{V}.$$\n4. 体膨胀系数\n$$\\alpha_V=\\frac{1}{B_T}\\Bigl(\\frac{\\partial p_{\\rm th}}{\\partial T}\\Bigr)_V\n=\\frac{1}{B_T}\\frac{3N\\gamma k_B}{V}\n=\\frac{3\\gamma n k_B}{B_T},$$\n其中 $n=N/V$。\n5. 线性膨胀系数\n$$\\alpha_L=\\frac{\\alpha_V}{3}=\\frac{\\gamma n k_B}{B_T}.$$",
            "answer": "$$\\boxed{\\frac{\\gamma n k_B}{B_T}}$$"
        },
        {
            "introduction": "超越经典极限，我们现在将探索低温下至关重要的量子效应。这个计算实践  聚焦于零点能的影响，即使在绝对零度下，零点能也会引起晶格膨胀。您将实现一个计算流程，用以求解这个由量子效应引起的平衡体积修正，并确定热膨胀系数在低温下的特征行为。",
            "id": "3483269",
            "problem": "考虑一个在准谐近似 (QHA) 模型下的晶体固体，其中亥姆霍兹自由能 $F(V,T)$ 写为静态晶格贡献和振动贡献之和。基本依据是亥姆霍兹自由能的热力学定义 $F(V,T)=U(V,T)-T S(V,T)$，零外压下的平衡定义为在固定温度 $T$ 下最小化 $F$ 关于体积 $V$ 的条件，以及用于晶格振动的德拜模型。在德拜模型中，零点能 $E_{\\mathrm{ZP}}(V)$ 是振动能在 $T=0$ 时的极限，零点压定义为 $P_{\\mathrm{ZP}}(V)=-\\partial E_{\\mathrm{ZP}}(V)/\\partial V$。在 Grüneisen 近似中，德拜温度随体积的变化关系为 $\\theta_{\\mathrm{D}}(V)=\\theta_{\\mathrm{D},0}\\left(V/V_{\\mathrm{el},0}\\right)^{-\\gamma}$，其中 $\\gamma$ 是（与体积无关的）Grüneisen 参数，而 $V_{\\mathrm{el},0}$ 是在 $T=0$ 时忽略振动影响的静态晶格平衡体积。\n\n你需要实现一个计算程序，该程序：\n- 从第一性原理出发，通过求解平衡条件 $\\partial F(V,0)/\\partial V=0$（其中 $F(V,0)=E_{\\mathrm{el}}(V)+E_{\\mathrm{ZP}}(V)$），推导零点压对 $T=0$ 时平衡体积 $V_0$ 的影响。这里 $E_{\\mathrm{el}}(V)$ 是静态晶格能，在 $V_{\\mathrm{el},0}$ 附近近似为一个与体模量一致的二次形式。\n- 基于 QHA 和德拜低温渐近行为，确定当 $T\\to 0$ 时体积热膨胀 $\\alpha(T)$ 的低温主导系数。具体来说，定义一个系数 $A$ 使得当 $T\\to 0$ 时 $\\alpha(T)\\sim A\\,T^3$；在经零点能重整化的体积 $V_0$ 处计算 $A$。\n\n使用的模型假设和数据：\n1. 静态晶格能在其最小值附近近似为 $E_{\\mathrm{el}}(V)\\approx E_{\\mathrm{ref}}+\\dfrac{K_0}{2 V_{\\mathrm{el},0}}\\left(V-V_{\\mathrm{el},0}\\right)^2$，并以电子伏特/原子为单位进行计算，其中 $K_0$ 是 $T=0$ 时的等温体模量（在所考虑的狭窄体积范围内假定为常数）。为确保单位一致性，使用转换因子 $c_{\\mathrm{PV}\\to E}=$ $0.006241509074$ 电子伏特/原子 每 $\\mathrm{GPa}\\cdot\\text{\\AA}^3$，因此，单位为 $\\mathrm{GPa}\\cdot\\text{\\AA}^3$ 的压强-体积乘积可通过乘以 $c_{\\mathrm{PV}\\to E}$ 转换为电子伏特/原子。\n2. 在德拜模型中，每原子的零点能为 $E_{\\mathrm{ZP}}(V)=\\dfrac{9}{8} k_{\\mathrm{B}}\\,\\theta_{\\mathrm{D}}(V)$，其中 $k_{\\mathrm{B}}=$ $8.617333262\\times 10^{-5}$ 电子伏特/开尔文。\n3. Grüneisen 参数 $\\gamma$ 被视为与体积无关，德拜温度的变化关系为 $\\theta_{\\mathrm{D}}(V)=\\theta_{\\mathrm{D},0}\\left(V/V_{\\mathrm{el},0}\\right)^{-\\gamma}$。\n4. 在德拜模型中，当 $T\\to 0$ 时，每原子的定容比热的低温主导行为是 $C_V(T)\\sim \\dfrac{12\\pi^4}{5}\\,k_{\\mathrm{B}}\\left(\\dfrac{T}{\\theta_{\\mathrm{D}}(V)}\\right)^3$。\n\n对于每组参数集，你的程序必须执行以下步骤：\n- 使用上述指定的能量形式并确保单位一致性，通过求解方程 $\\partial E_{\\mathrm{el}}(V)/\\partial V+\\partial E_{\\mathrm{ZP}}(V)/\\partial V=0$ 来计算 $T=0$ 时的平衡体积 $V_0$。计算以每原子为单位，其中 $V$ 的单位是 $\\text{\\AA}^3$/原子， $E$ 的单位是电子伏特/原子，压强的单位是电子伏特/原子每 $\\text{\\AA}^3$。\n- 计算在 $T=0$ 时由零点压引起的体积分数变化 $\\Delta V/V_{\\mathrm{el},0}=\\left(V_0-V_{\\mathrm{el},0}\\right)/V_{\\mathrm{el},0}$。\n- 推导并计算低温系数 $A$（使得当 $T\\to 0$ 时 $\\alpha(T)\\sim A\\,T^3$），并以 $\\mathrm{K}^{-4}$ 为单位表示。使用热膨胀与热力学导数之间的 QHA 关系，结合德拜低温渐近行为，在经零点能重整化的 $V_0$ 和相应的 $\\theta_{\\mathrm{D}}(V_0)$ 处进行计算。系数中的等温体模量取为 $K_0$（单位 GPa），并通过 $K_0 V_0 c_{\\mathrm{PV}\\to E}$ 进行适当转换，以保持单位为电子伏特/原子。\n\n物理单位和输出要求：\n- 体积单位必须是 $\\text{\\AA}^3$/原子。\n- 系数 $A$ 必须以 $\\mathrm{K}^{-4}$ 为单位报告。\n- 分数变化 $\\Delta V/V_{\\mathrm{el},0}$ 是无量纲的，应以小数形式报告。\n- 将 $\\Delta V/V_{\\mathrm{el},0}$ 四舍五入到小数点后 $6$ 位，$V_0$ 四舍五入到小数点后 $6$ 位， $A$ 四舍五入到小数点后 $12$ 位。\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个测试用例对应一个形如 $[\\Delta V/V_{\\mathrm{el},0},V_0,A]$ 的子列表，且不含空格（例如：$[[0.001234,5.123456,1.234567890123e-12],[...]]$）。\n\n测试套件：\n使用以下四个参数集，涵盖与轻元素相关的不同区域和边界情况；所有值均为每原子的值：\n- 情况1（理想情况，类轻元素）：$\\theta_{\\mathrm{D},0}=$ $1000$ $\\mathrm{K}$，$\\gamma=$ $1.2$， $K_0=$ $70$ $\\mathrm{GPa}$，$V_{\\mathrm{el},0}=$ $5.0$ $\\text{\\AA}^3$。\n- 情况2（类重元素）：$\\theta_{\\mathrm{D},0}=$ $200$ $\\mathrm{K}$，$\\gamma=$ $1.5$，$K_0=$ $150$ $\\mathrm{GPa}$，$V_{\\mathrm{el},0}=$ $15.0$ $\\text{\\AA}^3$。\n- 情况3（边界条件 $\\gamma\\to 0$）：$\\theta_{\\mathrm{D},0}=$ $600$ $\\mathrm{K}$，$\\gamma=$ $0.05$，$K_0=$ $100$ $\\mathrm{GPa}$，$V_{\\mathrm{el},0}=$ $10.0$ $\\text{\\AA}^3$。\n- 情况4（非常硬，德拜温度非常高）：$\\theta_{\\mathrm{D},0}=$ $1200$ $\\mathrm{K}$，$\\gamma=$ $1.2$，$K_0=$ $300$ $\\mathrm{GPa}$，$V_{\\mathrm{el},0}=$ $5.0$ $\\text{\\AA}^3$。\n\n你的程序必须为每个情况数值求解平衡方程以得到 $V_0$，计算所要求的量，并以上述指定的精确格式打印结果。",
            "solution": "该问题要求推导并实现一个计算程序，用以在准谐近似 (QHA) 框架内分析零点能对晶体固体的平衡体积和低温热膨胀的影响。推导过程依据问题陈述中阐明的第一性原理进行。\n\n### 第一部分：$T=0$ 时平衡体积的推导\n\n晶体在零温（$T=0$）和零外压下的平衡态由每原子的总能量 $E(V)$ 相对于每原子体积 $V$ 的最小值确定。总能量是静态晶格电子能 $E_{\\mathrm{el}}(V)$ 和振动零点能 $E_{\\mathrm{ZP}}(V)$ 的和：\n$$\nF(V, T=0) = E(V) = E_{\\mathrm{el}}(V) + E_{\\mathrm{ZP}}(V)\n$$\n平衡条件是总压强 $P_{\\mathrm{tot}} = - \\partial E(V) / \\partial V$ 为零。这意味着：\n$$\n\\frac{\\partial E(V)}{\\partial V} = \\frac{\\partial E_{\\mathrm{el}}(V)}{\\partial V} + \\frac{\\partial E_{\\mathrm{ZP}}(V)}{\\partial V} = 0\n$$\n该方程可以表示为静态晶格压强 $P_{\\mathrm{el}}(V) = -\\partial E_{\\mathrm{el}}/\\partial V$ 与零点压强 $P_{\\mathrm{ZP}}(V) = -\\partial E_{\\mathrm{ZP}}/\\partial V$ 之间的平衡：\n$$\nP_{\\mathrm{el}}(V) + P_{\\mathrm{ZP}}(V) = 0\n$$\n我们根据所提供的模型推导这两个压强分量的表达式。\n\n**1. 静态晶格压强, $P_{\\mathrm{el}}(V)$**\n静态晶格能由其在 $V_{\\mathrm{el},0}$ 最小值附近的二次近似给出：\n$$\nE_{\\mathrm{el}}(V) \\approx E_{\\mathrm{ref}} + \\frac{K_0}{2 V_{\\mathrm{el},0}} (V-V_{\\mathrm{el},0})^2\n$$\n为了单位一致性，当能量单位为电子伏特 (eV)，体积单位为立方埃 ($\\text{\\AA}^3$)，体模量 $K_0$ 单位为吉帕斯卡 (GPa) 时，能量表达式必须包含转换因子 $c_{\\mathrm{PV}\\to E} = 0.006241509074 \\, \\text{eV}/(\\text{GPa}\\cdot\\text{\\AA}^3)$。$K_0 \\cdot \\text{volume}$ 项的单位是 GPa$\\cdot\\text{\\AA}^3$，这是一个压强-体积积。所提供的能量表达式的单位是 $\\text{GPa} \\cdot \\text{\\AA}^3$。要将其转换为每原子的 eV，我们必须乘以 $c_{\\mathrm{PV}\\to E}$：\n$$\nE_{\\mathrm{el}}(V) = E_{\\mathrm{ref}} + \\frac{K_0 c_{\\mathrm{PV}\\to E}}{2 V_{\\mathrm{el},0}} (V-V_{\\mathrm{el},0})^2\n$$\n静态晶格压强是该能量对体积的负导数：\n$$\nP_{\\mathrm{el}}(V) = -\\frac{\\partial E_{\\mathrm{el}}}{\\partial V} = -\\frac{K_0 c_{\\mathrm{PV}\\to E}}{V_{\\mathrm{el},0}}(V-V_{\\mathrm{el},0})\n$$\n该压强的单位是 $\\text{eV}/\\text{\\AA}^3$。\n\n**2. 零点压强, $P_{\\mathrm{ZP}}(V)$**\n在德拜模型中，每原子的零点能由下式给出：\n$$\nE_{\\mathrm{ZP}}(V) = \\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D}}(V)\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\theta_{\\mathrm{D}}(V)$ 是依赖于体积的德拜温度。使用 Grüneisen 近似，$\\theta_{\\mathrm{D}}(V)$ 由下式给出：\n$$\n\\theta_{\\mathrm{D}}(V) = \\theta_{\\mathrm{D},0} \\left(\\frac{V}{V_{\\mathrm{el},0}}\\right)^{-\\gamma}\n$$\n其中 $\\gamma$ 是 Grüneisen 参数。将此代入能量表达式：\n$$\nE_{\\mathrm{ZP}}(V) = \\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} \\left(\\frac{V}{V_{\\mathrm{el},0}}\\right)^{-\\gamma} = \\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma} V^{-\\gamma}\n$$\n于是，零点压强为：\n$$\nP_{\\mathrm{ZP}}(V) = -\\frac{\\partial E_{\\mathrm{ZP}}}{\\partial V} = -\\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma} \\frac{d}{dV}(V^{-\\gamma}) = -\\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma} (-\\gamma V^{-\\gamma-1})\n$$\n$$\nP_{\\mathrm{ZP}}(V) = \\frac{9 \\gamma k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma}}{8} V^{-\\gamma-1}\n$$\n此表达式也可以紧凑地写作 $P_{\\mathrm{ZP}}(V) = \\gamma E_{\\mathrm{ZP}}(V) / V$。\n\n**3. $V_0$ 的平衡方程**\n在 $T=0$ 时的平衡体积，记作 $V_0$，是方程 $P_{\\mathrm{el}}(V_0) + P_{\\mathrm{ZP}}(V_0) = 0$ 的解：\n$$\n-\\frac{K_0 c_{\\mathrm{PV}\\to E}}{V_{\\mathrm{el},0}}(V_0-V_{\\mathrm{el},0}) + \\frac{9 \\gamma k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma}}{8} V_0^{-\\gamma-1} = 0\n$$\n这是一个关于 $V_0$ 的非线性方程，必须进行数值求解。对于 $\\gamma>0$，零点压强项通常为正，它抵消了当 $V > V_{\\mathrm{el},0}$ 时的负静态压强，从而导致平衡体积 $V_0 > V_{\\mathrm{el},0}$。\n\n### 第二部分：低温热膨胀系数的推导\n\n体积热膨胀系数 $\\alpha(T)$ 定义为 $\\alpha(T) = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_P$。利用标准的麦克斯韦关系和热力学恒等式，它可以表示为：\n$$\n\\alpha(T) = \\frac{1}{K_T} \\left( \\frac{\\partial S}{\\partial V} \\right)_T\n$$\n其中 $K_T = -V(\\partial P/\\partial V)_T$ 是等温体模量，$S$ 是熵。在 QHA 框架内，振动熵 $S(V,T)$ 对体积的依赖关系仅通过声子频率的标度关系体现，这由 $\\theta_{\\mathrm{D}}(V)$ 概括。这种依赖关系导出以下普适关系：\n$$\n\\left( \\frac{\\partial S}{\\partial V} \\right)_T = \\frac{\\gamma C_V}{V}\n$$\n其中 $C_V = T(\\partial S/\\partial T)_V$ 是定容热容。将此代入 $\\alpha(T)$ 的表达式，得到 Grüneisen 状态方程：\n$$\n\\alpha(T) = \\frac{\\gamma C_V(V,T)}{V K_T(V,T)}\n$$\n我们关心的是低温极限 ($T \\to 0$)。在此极限下，德拜模型给出了每原子热容的渐近行为：\n$$\nC_V(T) \\sim \\frac{12\\pi^4}{5} k_{\\mathrm{B}} \\left( \\frac{T}{\\theta_{\\mathrm{D}}(V)} \\right)^3\n$$\n将此代入 $\\alpha(T)$ 的表达式，并在经零点能重整化的体积 $V_0$ 和相应的零温体模量 $K_0$ 处进行计算：\n$$\n\\alpha(T) \\sim \\frac{\\gamma}{V_0 K_0} \\left[ \\frac{12\\pi^4}{5} k_{\\mathrm{B}} \\left( \\frac{T}{\\theta_{\\mathrm{D}}(V_0)} \\right)^3 \\right] = \\left[ \\frac{\\gamma}{V_0 K_0} \\frac{12\\pi^4 k_{\\mathrm{B}}}{5 \\, \\theta_{\\mathrm{D}}(V_0)^3} \\right] T^3\n$$\n问题指定 $\\alpha(T) \\sim A T^3$。通过比较，系数 $A$ 为：\n$$\nA = \\frac{\\gamma}{V_0 K_0} \\frac{12\\pi^4 k_{\\mathrm{B}}}{5 \\, \\theta_{\\mathrm{D}}(V_0)^3}\n$$\n为确保 $A$ 的单位为正确的 $\\text{K}^{-4}$，分母项 $V_0 K_0$（其单位为能量）必须以 eV 表示。按照指示，这通过将其计算为 $K_0 V_0 c_{\\mathrm{PV}\\to E}$ 来实现，其中 $K_0$ 的单位是 GPa，$V_0$ 的单位是 $\\text{\\AA}^3$。\n$$\nA = \\frac{\\gamma}{K_0 V_0 c_{\\mathrm{PV}\\to E}} \\frac{12\\pi^4 k_{\\mathrm{B}}}{5 \\, \\theta_{\\mathrm{D}}(V_0)^3}\n$$\n在此表达式中，$\\theta_{\\mathrm{D}}(V_0)$ 是在先前计算出的平衡体积 $V_0$ 处计算的德拜温度：\n$$\n\\theta_{\\mathrm{D}}(V_0) = \\theta_{\\mathrm{D},0} \\left(\\frac{V_0}{V_{\\mathrm{el},0}}\\right)^{-\\gamma}\n$$\n计算程序将首先数值求解 $V_0$，然后将其代入推导出的 $A$ 的公式中。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the quasiharmonic approximation problem for several test cases.\n    \"\"\"\n    # Define physical constants\n    k_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    c_PV_to_E = 0.006241509074  # Conversion factor from GPa*A^3 to eV\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (theta_D_0 [K], gamma, K0 [GPa], V_el_0 [A^3/atom])\n        (1000.0, 1.2, 70.0, 5.0),   # Case 1\n        (200.0, 1.5, 150.0, 15.0),  # Case 2\n        (600.0, 0.05, 100.0, 10.0), # Case 3\n        (1200.0, 1.2, 300.0, 5.0),  # Case 4\n    ]\n\n    results = []\n    for params in test_cases:\n        theta_D_0, gamma, K0, V_el_0 = params\n\n        # Part 1: Compute the T=0 equilibrium volume V0\n        \n        # Define the function whose root we need to find.\n        # This function represents P_el(V) + P_zp(V) = 0\n        def total_pressure_equation(V):\n            # Static lattice pressure in eV/A^3\n            P_el = - (K0 * c_PV_to_E / V_el_0) * (V - V_el_0)\n\n            # Zero-point pressure in eV/A^3\n            if gamma == 0:\n                P_zp = 0.0\n            else:\n                # P_zp = gamma * E_zp / V\n                # E_zp = (9/8) * k_B * theta_D_0 * (V / V_el_0)^(-gamma)\n                P_zp_term1 = 9.0 / 8.0 * k_B * theta_D_0 * gamma\n                P_zp_term2 = (V / V_el_0)**(-gamma)\n                P_zp = P_zp_term1 * P_zp_term2 / V\n                \n                # Alternate formulation from derivation:\n                P_zp_alt = (9.0 * gamma * k_B * theta_D_0 * (V_el_0**gamma)) / (8.0 * V**(gamma + 1.0))\n                # Using the alternate formulation to avoid V/V issues numerically\n                # and to be explicit.\n                P_zp = P_zp_alt\n\n\n            return P_el + P_zp\n\n        # The root must be slightly larger than V_el_0 for gamma > 0.\n        # For gamma=0, V0 = V_el_0.\n        # We need a safe bracket for the root finder.\n        # At V=V_el_0, the function is negative (or zero if gamma=0).\n        # We need an upper bound where the function is positive.\n        v_low = V_el_0\n        v_high = V_el_0 * 1.5  # A large, safe upper bound\n\n        # Handle the edge case of gamma = 0, where V0 = V_el_0.\n        if gamma == 0.0:\n            V0 = V_el_0\n        else:\n            # Solve for V0 numerically\n            sol = optimize.root_scalar(total_pressure_equation, bracket=[v_low, v_high], method='brentq')\n            V0 = sol.root\n\n        # Part 2: Compute fractional volume change\n        dV_V = (V0 - V_el_0) / V_el_0\n\n        # Part 3: Compute low-temperature thermal expansion coefficient A\n\n        # Debye temperature at the new equilibrium volume V0\n        theta_D_V0 = theta_D_0 * (V0 / V_el_0)**(-gamma)\n        \n        # Denominator term K*V in units of eV\n        K_V_energy = K0 * V0 * c_PV_to_E\n\n        if gamma == 0.0 or K_V_energy == 0.0:\n            # If gamma is zero, thermal expansion is zero.\n            A = 0.0\n        else:\n            # Numerator constant part\n            num_consts = 12.0 * (np.pi**4) * k_B / 5.0\n            \n            # Combine to calculate A\n            A = (gamma / K_V_energy) * (num_consts / (theta_D_V0**3))\n\n        # Store the formatted results for this case.\n        # Rounding/formatting is done here as per output requirements.\n        sublist = [\n            f\"{dV_V:.6f}\",\n            f\"{V0:.6f}\",\n            f\"{A:.12e}\"\n        ]\n        results.append(f\"[{','.join(sublist)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实材料的振动模式呈现出复杂的光谱，每种模式对体积变化的响应各不相同。这个高级练习  将挑战使用单一平均格林艾森参数这一常见简化方法的局限性。通过模拟具有不同模式格林艾森参数分布的材料，您将量化此近似所引入的误差，并学会判断何时必须采用更严格的、区分具体模式的计算方法。",
            "id": "3483228",
            "problem": "您的任务是设计并实现一个完整的、可运行的程序，用于评估在计算材料科学中，准谐波近似 (QHA) 中用于计算热膨胀的单模 Grüneisen 参数近似在何种情况下会失效。目标是证明，当使用单一的平均 Grüneisen 参数来预测体热膨胀系数时，宽泛的模态 Grüneisen 参数分布会导致显著的误差。\n\n出发点和基本原理：\n- 考虑一个晶体固体，其被建模为一组在固定体积下的无相互作用的量子谐振子。声子的亥姆霍兹自由能由下式给出\n$$F_{\\mathrm{ph}}(V,T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_{i}(V) + k_{\\mathrm{B}} T \\ln\\left(1 - e^{-\\hbar \\omega_{i}(V)/(k_{\\mathrm{B}} T)}\\right) \\right),$$\n其中 $V$ 是体积，$T$ 是温度，$\\hbar$ 是约化普朗克常数，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\omega_{i}(V)$ 是在准谐波近似 (QHA) 中依赖于 $V$ 的振动模式频率。\n- 热压定义为 $$P_{\\mathrm{th}}(V,T) = -\\left(\\frac{\\partial F_{\\mathrm{ph}}}{\\partial V}\\right)_{T}。$$\n- 等温体弹模量 $B_{T}$ 在参考体积 $V_{0}$ 处定义为 $$B_{T} = -V \\left( \\frac{\\partial P}{\\partial V} \\right)_{T},$$ 在本问题中被视为常数。\n- 模态 Grüneisen 参数定义为 $$\\gamma_{i}(V) = - \\frac{V}{\\omega_{i}(V)} \\left( \\frac{\\partial \\omega_{i}}{\\partial V} \\right)_{T}。$$\n- 体热膨胀系数定义为 $$\\alpha(T) = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_{P}。$$\n- 单一 $\\bar{\\gamma}$ 近似用一个恒定的平均值 $\\bar{\\gamma}$ 来代替完整的 $\\{\\gamma_{i}\\}$ 分布，以估算 $\\alpha(T)$。\n\n要求：\n1. 从给定的基本定义和 QHA 框架出发，推导一个在固定体积 $V_{0}$ 下，用声子谱和模态 Grüneisen 参数表示的体热膨胀系数 $\\alpha(T)$ 的可计算表达式，并在代码中实现它。\n2. 通过将 $\\bar{\\gamma}$ 定义为在参考温度 $T_{\\mathrm{ref}}$ 下 $\\gamma_{i}$ 的热容加权平均值来构建单一 $\\bar{\\gamma}$ 近似，并使其在所有温度下保持恒定，然后实现相应的近似 $\\alpha(T)$。\n3. 通过计算每个温度 $T$ 下的相对误差来量化单一 $\\bar{\\gamma}$ 近似的误差，相对误差公式为 $$\\mathrm{err}(T) = \\frac{|\\alpha_{\\mathrm{full}}(T) - \\alpha_{\\mathrm{single}}(T)|}{|\\alpha_{\\mathrm{full}}(T)|}。$$\n4. 使用 $\\gamma_{i}$ 在 $T_{\\mathrm{ref}}$ 时的热容加权标准差来展示 $\\gamma_{i}$ 分布的宽度，该标准差由与模态热容 $c_{V,i}(T_{\\mathrm{ref}})$ 成正比的权重 $w_{i}(T_{\\mathrm{ref}})$ 定义，并报告此标准差。\n\n实现细节：\n- 使用爱因斯坦振子表达式计算固定体积下的定容模态热容，\n$$c_{V,i}(T) = k_{\\mathrm{B}} \\frac{x_{i}(T)^{2} e^{x_{i}(T)}}{(e^{x_{i}(T)} - 1)^{2}}, \\quad x_{i}(T) = \\frac{\\hbar \\omega_{i}(V_{0})}{k_{\\mathrm{B}} T}。$$\n- 使用以下常数：$\\hbar = 1.054571817 \\times 10^{-34}$ $\\mathrm{J \\cdot s}$，$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$，$B_{T} = 1.0 \\times 10^{11}$ $\\mathrm{Pa}$，以及 $V_{0} = 1.0 \\times 10^{-28}$ $\\mathrm{m^{3}}$。\n- 频率以太赫兹 (terahertz) 为单位给出，必须使用 $\\omega = 2\\pi f$（其中 $f$ 以赫兹为单位）转换为以弧度/秒为单位的角频率。\n- 温度以开尔文为单位。\n\n测试集：\n评估以下三种合成材料，这些材料在科学上是合理的，并被设计用来测试 $\\gamma_{i}$ 的宽分布和窄分布，以及模态权重的温度依赖性。\n\n- 材料 1（双峰 $\\gamma_{i}$ 分布；低频负 $\\gamma_{i}$ 和高频正 $\\gamma_{i}$）：\n  - 频率（太赫兹）：$[2.0, 2.5, 3.0, 1.5, 1.2, 0.8, 10.0, 12.0, 15.0, 18.0, 11.0, 13.0, 16.0, 20.0]$。\n  - 模态 Grüneisen 参数：$[-1.2, -1.1, -1.0, -0.8, -0.6, -0.5, 2.5, 2.6, 2.4, 2.7, 2.3, 2.8, 2.5, 2.6]$。\n\n- 材料 2（$\\gamma_{i}$ 集中在低频模态的重尾分布）：\n  - 频率（太赫兹）：$[0.7, 0.9, 1.0, 1.5, 2.0, 3.0, 5.0, 8.0, 12.0, 15.0, 18.0, 20.0]$。\n  - 模态 Grüneisen 参数：$[5.0, 4.5, 4.0, 3.0, 2.0, 1.5, 1.2, 1.1, 1.0, 0.9, 0.8, 0.7]$。\n\n- 材料 3（窄 $\\gamma_{i}$ 分布）：\n  - 频率（太赫兹）：$[2.0, 3.0, 4.0, 6.0, 8.0, 10.0, 12.0, 14.0]$。\n  - 模态 Grüneisen 参数：$[1.5, 1.6, 1.4, 1.5, 1.5, 1.6, 1.4, 1.5]$。\n\n待评估的温度：\n- $T$ 值：$[50, 300, 800]$ $\\mathrm{K}$。\n- 参考温度：$T_{\\mathrm{ref}} = 300$ $\\mathrm{K}$。\n\n输出规格：\n- 对每种材料，计算：\n  - 在 $T_{\\mathrm{ref}}$ 时 $\\gamma_{i}$ 的热容加权标准差（无量纲）。\n  - 在 $T = 50$ $\\mathrm{K}$、$300$ $\\mathrm{K}$ 和 $800$ $\\mathrm{K}$ 时的相对误差 $\\mathrm{err}(T)$（无量纲）。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表的结果，每种材料由一个包含四个浮点数的列表表示，顺序为 $[\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}}), \\mathrm{err}(50\\,\\mathrm{K}), \\mathrm{err}(300\\,\\mathrm{K}), \\mathrm{err}(800\\,\\mathrm{K})]$。例如，输出格式为\n$$[[a_{1},b_{1},c_{1},d_{1}],[a_{2},b_{2},c_{2},d_{2}],[a_{3},b_{3},c_{3},d_{3}]],$$\n打印的字符串中任何地方都没有空格。\n所有报告的量都是无量纲的，必须表示为十进制浮点数。",
            "solution": "所提供的问题被评估为科学上合理、定义明确、客观且完整。它在计算材料科学领域内，基于准谐波近似 (QHA) 的基本原理，提出了一个标准的、但富有洞察力的数值实验。所有提供的定义、常数和数据都是一致且物理上合理的。任务是推导并实现一个模型，以展示一个常用近似的关键局限性，这构成了一个有效的科学探究。因此，有必要提供一个完整的解法。\n\n该解法分为四个主要部分：\n1.  在 QHA 框架内推导精确的体热膨胀系数 $\\alpha_{\\mathrm{full}}(T)$。\n2.  构建单一平均 Grüneisen 参数近似 $\\alpha_{\\mathrm{single}}(T)$。\n3.  定义用于量化模态 Grüneisen 参数分布宽度和近似误差的度量标准。\n4.  描述实现计算的算法。\n\n在整个推导过程中，每个数学实体都按照指定的强制格式化规则使用 LaTeX 排版。\n\n问题要求分析体热膨胀系数 $\\alpha(T)$，其定义为：\n$$\n\\alpha(T) = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_{P}\n$$\n其中 $V$ 是体积，$T$ 是温度，$P$ 是压力。\n\n**1. 完整体热膨胀系数 $\\alpha_{\\mathrm{full}}(T)$ 的推导**\n\n为了推导 $\\alpha(T)$ 的可计算表达式，我们使用一个从三乘积规则导出的热力学恒等式：\n$$\n\\left( \\frac{\\partial V}{\\partial T} \\right)_{P} \\left( \\frac{\\partial T}{\\partial P} \\right)_{V} \\left( \\frac{\\partial P}{\\partial V} \\right)_{T} = -1\n$$\n重新整理以求解 $\\alpha(T)$ 定义中的项：\n$$\n\\left( \\frac{\\partial V}{\\partial T} \\right)_{P} = - \\left( \\frac{\\partial V}{\\partial P} \\right)_{T} \\left( \\frac{\\partial P}{\\partial T} \\right)_{V}\n$$\n将此代入 $\\alpha(T)$ 的定义，得到：\n$$\n\\alpha(T) = \\frac{1}{V} \\left[ - \\left( \\frac{\\partial V}{\\partial P} \\right)_{T} \\left( \\frac{\\partial P}{\\partial T} \\right)_{V} \\right]\n$$\n我们识别此表达式中的各项。等温体弹模量 $B_T$ 定义为 $B_T = -V \\left( \\frac{\\partial P}{\\partial V} \\right)_{T}$。其倒数给我们 $-\\left(\\frac{\\partial V}{\\partial P}\\right)_T = \\frac{V}{B_T}$。总压力 $P$ 是 0 K 时的静压和声子引起的热压之和，$P(V,T) = P_{0\\,\\mathrm{K}}(V) + P_{\\mathrm{th}}(V,T)$。由于 $P_{0\\,\\mathrm{K}}$ 不依赖于 $T$，我们有 $\\left(\\frac{\\partial P}{\\partial T}\\right)_V = \\left(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T}\\right)_V$。\n将这些代入 $\\alpha(T)$ 的方程，得到著名的 Grüneisen 关系式：\n$$\n\\alpha(T) = \\frac{1}{V} \\left[ \\frac{V}{B_T} \\left( \\frac{\\partial P_{\\mathrm{th}}}{\\partial T} \\right)_{V} \\right] = \\frac{1}{B_T} \\left( \\frac{\\partial P_{\\mathrm{th}}}{\\partial T} \\right)_{V}\n$$\n接下来，我们从声子亥姆霍兹自由能 $F_{\\mathrm{ph}}$ 推导热压 $P_{\\mathrm{th}}(V,T)$ 的表达式：\n$$\nF_{\\mathrm{ph}}(V,T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_{i}(V) + k_{\\mathrm{B}} T \\ln\\left(1 - e^{-\\hbar \\omega_{i}(V)/(k_{\\mathrm{B}} T)}\\right) \\right)\n$$\n热压为 $P_{\\mathrm{th}}(V,T) = -(\\frac{\\partial F_{\\mathrm{ph}}}{\\partial V})_T$。应用该导数并使用模态 Grüneisen 参数的定义 $\\gamma_{i} = -\\frac{V}{\\omega_{i}} \\frac{\\partial \\omega_{i}}{\\partial V}$，我们得到：\n$$\nP_{\\mathrm{th}}(V,T) = \\frac{1}{V} \\sum_{i} \\gamma_{i} \\left( \\frac{1}{2}\\hbar \\omega_{i} + \\frac{\\hbar \\omega_{i}}{e^{\\hbar \\omega_{i}/(k_{\\mathrm{B}}T)} - 1} \\right) = \\frac{1}{V} \\sum_{i} \\gamma_{i} E_{i}(T)\n$$\n其中 $E_{i}(T)$ 是第 $i$ 个振子的总平均能量。在热膨胀理论中，标准惯例考虑纯粹由热激发产生的压力。导数 $\\left(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T}\\right)_V$ 自动地分离出这一贡献：\n$$\n\\left(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T}\\right)_{V} = \\frac{\\partial}{\\partial T} \\left( \\frac{1}{V} \\sum_{i} \\gamma_{i} E_{i}(T) \\right) = \\frac{1}{V} \\sum_{i} \\gamma_{i} \\left(\\frac{\\partial E_{i}}{\\partial T}\\right)_{V}\n$$\n项 $\\left(\\frac{\\partial E_i}{\\partial T}\\right)_V$ 是定容模态热容 $c_{V,i}(T)$ 的定义。问题提供了其显式形式：\n$$\nc_{V,i}(T) = k_{\\mathrm{B}} \\frac{x_{i}(T)^{2} e^{x_{i}(T)}}{(e^{x_{i}(T)} - 1)^{2}}, \\quad \\text{其中 } x_{i}(T) = \\frac{\\hbar \\omega_{i}(V_{0})}{k_{\\mathrm{B}} T}\n$$\n因此，我们有 $\\left(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T}\\right)_V = \\frac{1}{V} \\sum_{i} \\gamma_{i} c_{V,i}(T)$。按照规定，在参考体积 $V_0$ 处计算的完整热膨胀系数的最终表达式为：\n$$\n\\alpha_{\\mathrm{full}}(T) = \\frac{1}{B_T V_0} \\sum_{i} \\gamma_{i} c_{V,i}(T)\n$$\n\n**2. 单一 $\\bar{\\gamma}$ 近似**\n\n该近似通过用一个单一的、有效的、与温度无关的值 $\\bar{\\gamma}_{\\mathrm{approx}}$ 来代替特定于模态的 $\\gamma_i$，从而简化了上述表达式。对于 $\\bar{\\gamma}_{\\mathrm{approx}}$，一个具有物理动机的选择是在单个参考温度 $T_{\\mathrm{ref}}$ 下计算的 $\\gamma_i$ 的热容加权平均值：\n$$\n\\bar{\\gamma}_{\\mathrm{approx}} \\equiv \\bar{\\gamma}(T_{\\mathrm{ref}}) = \\frac{\\sum_{i} \\gamma_{i} c_{V,i}(T_{\\mathrm{ref}})}{\\sum_{i} c_{V,i}(T_{\\mathrm{ref}})}\n$$\n使用这个恒定的 $\\bar{\\gamma}_{\\mathrm{approx}}$，任何温度 $T$ 下的热膨胀系数被近似为：\n$$\n\\alpha_{\\mathrm{single}}(T) = \\frac{1}{B_T V_0} \\sum_{i} \\bar{\\gamma}_{\\mathrm{approx}} c_{V,i}(T) = \\frac{\\bar{\\gamma}_{\\mathrm{approx}}}{B_T V_0} \\sum_{i} c_{V,i}(T) = \\frac{\\bar{\\gamma}_{\\mathrm{approx}} C_V(T)}{B_T V_0}\n$$\n其中 $C_V(T) = \\sum_i c_{V,i}(T)$ 是总的定容声子热容。该近似仅在所有 $\\gamma_i$ 都相等，或者 $c_{V,i}(T)$ 对总 $C_V(T)$ 的相对贡献与温度无关时才精确，而这通常不成立。\n\n**3. 分布宽度和近似误差的量化**\n\n为评估单一 $\\bar{\\gamma}$ 近似的有效性，我们必须量化两件事：底层 $\\gamma_i$ 分布的宽度和在 $\\alpha(T)$ 中产生的误差。\n\n$\\gamma_i$ 分布的宽度由其在参考温度 $T_{\\mathrm{ref}}$ 时的热容加权标准差来衡量。权重定义为 $w_i(T_{\\mathrm{ref}}) = c_{V,i}(T_{\\mathrm{ref}}) / C_V(T_{\\mathrm{ref}})$。加权标准差为：\n$$\n\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}}) = \\sqrt{\\sum_{i=1}^{N} w_i(T_{\\mathrm{ref}}) \\left(\\gamma_i - \\bar{\\gamma}(T_{\\mathrm{ref}})\\right)^2}\n$$\n在给定温度 $T$ 下，该近似的相对误差定义为：\n$$\n\\mathrm{err}(T) = \\frac{|\\alpha_{\\mathrm{full}}(T) - \\alpha_{\\mathrm{single}}(T)|}{|\\alpha_{\\mathrm{full}}(T)|}\n$$\n较大的 $\\mathrm{std}_{\\gamma}$ 值预计与较大的误差相关，尤其是在远离 $T_{\\mathrm{ref}}$ 的温度下，因为真实加权平均值 $\\bar{\\gamma}(T)$ 的温度依赖性在近似中被忽略了。\n\n**4. 算法实现**\n\n对每种合成材料的计算流程如下：\n1.  定义物理常数：$\\hbar = 1.054571817 \\times 10^{-34}$ $\\mathrm{J \\cdot s}$，$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$，$B_{T} = 1.0 \\times 10^{11}$ $\\mathrm{Pa}$，以及 $V_{0} = 1.0 \\times 10^{-28}$ $\\mathrm{m^{3}}$。\n2.  对于给定材料，取频率 $f_i$（单位 THz）和模态 Grüneisen 参数 $\\gamma_i$ 的数组。将频率转换为角频率：$\\omega_i = 2 \\pi f_i \\times 10^{12}$ rad/s。\n3.  实现一个函数，用于在温度 $T$ 下为频率数组 $\\omega_i$ 计算模态热容 $c_{V,i}(T)$。\n4.  在 $T = T_{\\mathrm{ref}} = 300$ K 时，计算模态热容数组 $c_{V,i}(T_{\\mathrm{ref}})$。\n5.  使用 $c_{V,i}(T_{\\mathrm{ref}})$ 计算权重 $w_i(T_{\\mathrm{ref}})$、平均值 $\\bar{\\gamma}_{\\mathrm{approx}} = \\bar{\\gamma}(T_{\\mathrm{ref}})$ 和标准差 $\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}})$。此标准差是该材料的第一个要求输出。\n6.  遍历评估温度 $T \\in [50, 300, 800]$ K。对于每个 $T$：\n    a. 计算模态热容 $c_{V,i}(T)$。\n    b. 计算 $\\alpha_{\\mathrm{full}}(T) = \\frac{1}{B_T V_0} \\sum_i \\gamma_i c_{V,i}(T)$。\n    c. 计算 $\\alpha_{\\mathrm{single}}(T) = \\frac{\\bar{\\gamma}_{\\mathrm{approx}}}{B_T V_0} \\sum_i c_{V,i}(T)$。\n    d. 计算相对误差 $\\mathrm{err}(T)$。如果 $\\alpha_{\\mathrm{full}}(T)$ 为零或数值上非常接近于零，相对误差可被视为无穷大或未定义；然而，所选的测试用例在评估点避免了这个问题。\n7.  收集该材料的四个输出值：$[\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}}), \\mathrm{err}(50 \\text{ K}), \\mathrm{err}(300 \\text{ K}), \\mathrm{err}(800 \\text{ K})]$。\n8.  对所有材料重复以上步骤，并按规定格式化最终结果。",
            "answer": "```python\nimport numpy as np\nfrom typing import List, Tuple\n\ndef solve():\n    \"\"\"\n    Computes the failure of the single-mode Grüneisen parameter approximation\n    in the Quasi-Harmonic Approximation (QHA) for thermal expansion.\n    \"\"\"\n    \n    # Define physical constants\n    HBAR = 1.054571817e-34  # J·s\n    KB = 1.380649e-23        # J/K\n    BT = 1.0e11               # Pa\n    V0 = 1.0e-28              # m^3\n    \n    # Pre-calculated constant factors\n    HBAR_OVER_KB = HBAR / KB  # K·s\n    PREFACTOR_ALPHA = 1.0 / (BT * V0) # 1/J\n\n    # Define the temperature points for evaluation\n    T_VALS = np.array([50.0, 300.0, 800.0])  # K\n    T_REF = 300.0  # K\n\n    # Test suite: Frequencies in THz, Grüneisen parameters are dimensionless\n    test_cases: List[Tuple[np.ndarray, np.ndarray]] = [\n        (  # Material 1: Bimodal distribution\n            np.array([2.0, 2.5, 3.0, 1.5, 1.2, 0.8, 10.0, 12.0, 15.0, 18.0, 11.0, 13.0, 16.0, 20.0]),\n            np.array([-1.2, -1.1, -1.0, -0.8, -0.6, -0.5, 2.5, 2.6, 2.4, 2.7, 2.3, 2.8, 2.5, 2.6])\n        ),\n        (  # Material 2: Heavy-tail distribution\n            np.array([0.7, 0.9, 1.0, 1.5, 2.0, 3.0, 5.0, 8.0, 12.0, 15.0, 18.0, 20.0]),\n            np.array([5.0, 4.5, 4.0, 3.0, 2.0, 1.5, 1.2, 1.1, 1.0, 0.9, 0.8, 0.7])\n        ),\n        (  # Material 3: Narrow distribution\n            np.array([2.0, 3.0, 4.0, 6.0, 8.0, 10.0, 12.0, 14.0]),\n            np.array([1.5, 1.6, 1.4, 1.5, 1.5, 1.6, 1.4, 1.5])\n        ),\n    ]\n\n    def calculate_c_V_i(T: float, omegas: np.ndarray) -> np.ndarray:\n        \"\"\"\n        Calculates the Einstein model heat capacity for each mode.\n        T: Temperature in Kelvin\n        omegas: Array of angular frequencies in rad/s\n        \"\"\"\n        if T == 0.0:\n            return np.zeros_like(omegas)\n        \n        x = HBAR_OVER_KB * omegas / T\n        \n        # Handle large x to avoid overflow in exp(x)\n        # For large x, c_V_i -> k_B * x**2 * exp(-x), which is numerically stable\n        # and tends to 0. A cutoff of x=100 is safe.\n        c_v = np.zeros_like(x)\n        \n        # Standard calculation for moderate x\n        mask_std = x  100\n        x_std = x[mask_std]\n        exp_x = np.exp(x_std)\n        # Using np.subtract(exp_x, 1, out=...) can be slightly more precise for small x_std,\n        # but here the formula is stable enough given standard float64 precision.\n        c_v[mask_std] = KB * x_std**2 * exp_x / (exp_x - 1)**2\n\n        # Approximation for large x\n        mask_large = ~mask_std\n        x_large = x[mask_large]\n        c_v[mask_large] = KB * x_large**2 * np.exp(-x_large)\n\n        return c_v\n\n    results = []\n    for freqs_thz, gammas in test_cases:\n        # 1. Convert frequencies to angular frequencies\n        omegas = 2 * np.pi * freqs_thz * 1e12  # rad/s\n\n        # 2. Calculate quantities at the reference temperature T_ref\n        c_v_i_ref = calculate_c_V_i(T_REF, omegas)\n        c_v_total_ref = np.sum(c_v_i_ref)\n\n        if c_v_total_ref == 0:\n            # Handle case where no modes are excited at T_ref\n            gamma_bar_approx = np.mean(gammas) # Fallback to simple average\n            std_gamma = np.std(gammas)\n        else:\n            weights_ref = c_v_i_ref / c_v_total_ref\n            # Heat-capacity-weighted average Grüneisen parameter at T_ref\n            gamma_bar_approx = np.sum(weights_ref * gammas)\n            # Heat-capacity-weighted standard deviation of Grüneisen parameters at T_ref\n            var_gamma = np.sum(weights_ref * (gammas - gamma_bar_approx)**2)\n            std_gamma = np.sqrt(var_gamma)\n        \n        errors = []\n        for T in T_VALS:\n            # 3. Calculate heat capacities at the evaluation temperature T\n            c_v_i_T = calculate_c_V_i(T, omegas)\n            c_v_total_T = np.sum(c_v_i_T)\n\n            # 4. Calculate alpha_full and alpha_single\n            alpha_full = PREFACTOR_ALPHA * np.sum(gammas * c_v_i_T)\n            alpha_single = PREFACTOR_ALPHA * gamma_bar_approx * c_v_total_T\n            \n            # 5. Calculate relative error\n            if np.isclose(alpha_full, 0.0):\n                # If the true alpha is zero, any non-zero approximation has infinite relative error.\n                # If the approximation is also zero, the error is zero.\n                if np.isclose(alpha_single, 0.0):\n                    err = 0.0\n                else:\n                    err = np.inf\n            else:\n                err = np.abs(alpha_full - alpha_single) / np.abs(alpha_full)\n            errors.append(err)\n            \n        material_results = [std_gamma] + errors\n        results.append(material_results)\n\n    # Format the final output string according to the specification\n    # e.g., [[val1,val2],[val3,val4]]\n    outer_parts = []\n    for res_list in results:\n        inner_str = ','.join(map(str, res_list))\n        outer_parts.append(f\"[{inner_str}]\")\n    \n    final_output = f\"[{','.join(outer_parts)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}