{
    "hands_on_practices": [
        {
            "introduction": "在经典弹性理论中，位错线的核心处存在一个非物理的应力奇点，这为数值模拟带来了挑战。离散位错动力学通过引入非奇异核来解决此问题，这是该方法的一个基本特征。本练习  将引导你直接比较奇异与非奇异应力场，并量化这一物理修正在哪个区域内起主导作用，从而加深对位错核正则化重要性的理解。",
            "id": "2878140",
            "problem": "考虑一个各向同性的线性弹性介质，剪切模量为 $\\mu$。介质中存在一个与 $z$ 轴对齐的无限长直螺旋位错，其柏氏矢量大小为 $b$，方向平行于 $z$ 轴。在经典的 Volterra 模型中，反平面位移是多值的，由此产生的环向剪切应力 $\\tau_{\\theta z}(r)$ 在径向距离 $r \\to 0$ 时会发散。在离散位错动力学中，通过引入一种非奇异核正则化方法，将拉普拉斯算子的奇异二维格林函数替换为一个径向平滑的版本（其特征为核心半宽 $a0$），从而在位错线上得到有限的场。\n\n使用各向同性反平面弹性和格林函数框架，分别推导经典 Volterra 模型和非奇异核模型对应的环向剪切应力场 $\\tau_{\\theta z}^{\\mathrm{Volterra}}(r)$ 和 $\\tau_{\\theta z}^{\\mathrm{ns}}(r)$ 的解析表达式，并由此计算比值\n$$\n\\rho(r,a) \\equiv \\frac{\\tau_{\\theta z}^{\\mathrm{ns}}(r)}{\\tau_{\\theta z}^{\\mathrm{Volterra}}(r)}.\n$$\n为了量化正则化在何时是显著的，定义相对偏差\n$$\n\\delta(r,a) \\equiv \\left|1 - \\rho(r,a)\\right|,\n$$\n并采用以下准则：当 $\\delta(r,a) \\ge \\delta_{0}$（其中 $\\delta_{0} = 0.1$）时，认为正则化是显著的。引入无量纲距离 $x \\equiv r/a$，并确定临界值 $x^{\\star}$，使得在 $x = x^{\\star}$ 时有 $\\delta(r,a) = \\delta_{0}$。\n\n请将您的最终答案以行向量的形式给出，其第一个元素是 $\\rho(r,a)$ 的闭式表达式，第二个元素是 $x^{\\star}$ 的精确值。不需要进行数值四舍五入，最终答案框内也不应报告单位。",
            "solution": "提交分析的问题陈述被认为是有效的。它在科学上基于线弹性理论和位错力学，问题设定良好，目标明确，信息充分，并使用了客观的技术语言。因此，我们可以进行推导和求解。\n\n该问题要求分析各向同性线性弹性介质中一个与 $z$ 轴对齐的直螺旋位错。这种情况属于反平面剪切，其中位移矢量 $\\mathbf{u}$ 唯一不为零的分量是 $u_z$，并且它仅是面内坐标 $(x,y)$ 的函数，即 $u_z = u_z(x,y)$。\n\n首先，我们推导经典的 Volterra 应力场。对于柏氏矢量为 $\\mathbf{b} = (0, 0, b)$ 的螺旋位错，其位移场是多值的，在柱坐标系 $(r, \\theta, z)$ 下由下式给出：\n$$\nu_z(r,\\theta) = \\frac{b}{2\\pi} \\theta\n$$\n在反平面剪切中，不为零的应变分量是 $\\epsilon_{rz}$ 和 $\\epsilon_{\\theta z}$。使用柱坐标系中的应变-位移关系：\n$$\n\\epsilon_{rz} = \\frac{1}{2} \\frac{\\partial u_z}{\\partial r} = \\frac{1}{2} \\frac{\\partial}{\\partial r} \\left(\\frac{b}{2\\pi}\\theta\\right) = 0\n$$\n$$\n\\epsilon_{\\theta z} = \\frac{1}{2} \\frac{1}{r} \\frac{\\partial u_z}{\\partial \\theta} = \\frac{1}{2r} \\frac{\\partial}{\\partial \\theta} \\left(\\frac{b}{2\\pi}\\theta\\right) = \\frac{b}{4\\pi r}\n$$\n对于各向同性的线性弹性材料，其剪切本构关系为 $\\tau_{ij} = 2\\mu\\epsilon_{ij}$，其中 $\\mu$ 是剪切模量。唯一不为零的应力分量是环向剪切应力 $\\tau_{\\theta z}$：\n$$\n\\tau_{\\theta z}^{\\mathrm{Volterra}}(r) = 2\\mu \\epsilon_{\\theta z} = 2\\mu \\left(\\frac{b}{4\\pi r}\\right) = \\frac{\\mu b}{2\\pi r}\n$$\n这就是经典的奇异应力场，它在 $r \\to 0$ 时发散。\n\n接下来，我们考虑非奇异核模型。问题陈述指出，该模型是通过平滑拉普拉斯算子的二维格林函数来实现的。在位错理论中，这通常通过一个应力函数 $\\phi(x,y)$ 来表述，使得 $\\tau_{xz} = \\partial \\phi / \\partial y$ 且 $\\tau_{yz} = -\\partial \\phi / \\partial x$。该应力函数满足泊松方程 $\\nabla^2 \\phi = -\\mu \\eta(x,y)$，其中 $\\eta(x,y)$ 是位错密度。\n对于奇异的 Volterra 情况，$\\eta(x,y) = b \\delta(x)\\delta(y)$，应力函数为 $\\phi_{\\mathrm{Volterra}} = -\\mu b G_{2D}(r)$，其中 $G_{2D}(r) = \\frac{1}{2\\pi} \\ln(r)$ 是奇异格林函数。\n正则化方法将此格林函数替换为一个平滑版本。在这种情况下，一个在原点处有限的正则化格林函数的典型选择是 $G_{\\mathrm{ns}}(r) = \\frac{1}{4\\pi} \\ln(r^2 + a^2)$，其中 $a$ 是核心半宽。\n相应的非奇异应力函数为：\n$$\n\\phi_{\\mathrm{ns}}(r) = -\\mu b G_{\\mathrm{ns}}(r) = -\\frac{\\mu b}{4\\pi} \\ln(r^2 + a^2)\n$$\n柱坐标系中的应力分量可以从应力函数导出，即 $\\tau_{rz} = \\frac{1}{r} \\frac{\\partial \\phi}{\\partial \\theta}$ 和 $\\tau_{\\theta z} = -\\frac{\\partial \\phi}{\\partial r}$。由于 $\\phi_{\\mathrm{ns}}$ 仅依赖于 $r$，所以 $\\tau_{rz}^{\\mathrm{ns}} = 0$。环向剪切应力为：\n$$\n\\tau_{\\theta z}^{\\mathrm{ns}}(r) = - \\frac{\\partial \\phi_{\\mathrm{ns}}}{\\partial r} = - \\frac{\\partial}{\\partial r} \\left(-\\frac{\\mu b}{4\\pi} \\ln(r^2+a^2)\\right) = \\frac{\\mu b}{4\\pi} \\frac{2r}{r^2+a^2} = \\frac{\\mu b}{2\\pi} \\frac{r}{r^2+a^2}\n$$\n该应力场在 $r=0$ 处是有限的，此时 $\\tau_{\\theta z}^{\\mathrm{ns}}(0) = 0$，并且当 $r \\gg a$ 时，它收敛于 Volterra 场。\n\n现在，我们计算比值 $\\rho(r,a)$：\n$$\n\\rho(r,a) \\equiv \\frac{\\tau_{\\theta z}^{\\mathrm{ns}}(r)}{\\tau_{\\theta z}^{\\mathrm{Volterra}}(r)} = \\frac{\\frac{\\mu b}{2\\pi} \\frac{r}{r^2+a^2}}{\\frac{\\mu b}{2\\pi r}} = \\frac{r}{r^2+a^2} \\cdot r = \\frac{r^2}{r^2+a^2}\n$$\n这是第一个要求的表达式。\n\n最后，我们确定临界值 $x^{\\star}$。相对偏差定义为 $\\delta(r,a) \\equiv |1 - \\rho(r,a)|$。由于对于 $a0$ 有 $r^2 \\le r^2+a^2$，比值 $\\rho(r,a) \\le 1$。因此，绝对值是不必要的：\n$$\n\\delta(r,a) = 1 - \\rho(r,a) = 1 - \\frac{r^2}{r^2+a^2} = \\frac{(r^2+a^2)-r^2}{r^2+a^2} = \\frac{a^2}{r^2+a^2}\n$$\n当 $\\delta(r,a) \\ge \\delta_0$（其中 $\\delta_0 = 0.1$）时，认为正则化是显著的。临界条件发生在边界上，即 $\\delta(r,a) = \\delta_0$。\n我们引入无量纲距离 $x \\equiv r/a$。将 $r = xa$ 代入 $\\delta$ 的表达式中：\n$$\n\\delta(x) = \\frac{a^2}{(xa)^2+a^2} = \\frac{a^2}{a^2(x^2+1)} = \\frac{1}{x^2+1}\n$$\n通过求解 $\\delta(x^{\\star}) = \\delta_0$ 来找到临界值 $x^{\\star}$：\n$$\n\\frac{1}{(x^{\\star})^2+1} = \\delta_0\n$$\n$$\n(x^{\\star})^2+1 = \\frac{1}{\\delta_0}\n$$\n$$\n(x^{\\star})^2 = \\frac{1}{\\delta_0} - 1\n$$\n因为 $x$ 代表距离之比，它必须是非负的，所以我们取正根：\n$$\nx^{\\star} = \\sqrt{\\frac{1}{\\delta_0} - 1}\n$$\n代入给定值 $\\delta_0 = 0.1 = \\frac{1}{10}$：\n$$\nx^{\\star} = \\sqrt{\\frac{1}{1/10} - 1} = \\sqrt{10 - 1} = \\sqrt{9} = 3\n$$\n临界无量纲距离为 $x^{\\star}=3$。这意味着，当与位错线的距离小于或等于核心半宽的3倍（$r \\le 3a$）时，与经典 Volterra 模型的偏差至少为 $10\\%$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{r^2}{r^2+a^2}  3\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在处理了位错核心之后，我们需要精确地表示位错线。离散位错动力学将弯曲的位错线近似为一系列直线段的连接。本练习  深入探讨了这种几何近似所引入的数值误差，并指导你推导出一个自适应网格重划分的准则，这是平衡计算精度与成本的关键技术。",
            "id": "2878150",
            "problem": "在离散位错动力学 (DDD) 中，一个闭合的位错环由一个具有 $N$ 个等长直线段的折线表示。线张力对 Peach–Koehler 力的贡献取决于局部曲率。对于由弧长 $s$ 参数化、切线角为 $\\phi(s)$ 的光滑曲线，曲率定义为 $ \\kappa = d\\phi/ds $。一个常用的节点 $i$ 处的离散曲率估计量连接两个相邻的直线段，并取 $ \\kappa_{i}^{(d)} = \\theta_{i} / \\bar{\\ell}_{i} $，其中 $ \\theta_{i} $ 是两个线段之间的转角，$ \\bar{\\ell}_{i} $ 是相邻线段的平均长度。假设分段是均匀的，因此对所有 $i$ 都有 $ \\bar{\\ell}_{i} = \\ell $。\n  \n考虑环的一个局部区域，其真实曲线可以很好地用半径为 $R$ 的圆来近似（因此真实曲率为 $ \\kappa = 1/R $）。对于内接正多边形近似，转角 $ \\theta $ 和弦长 $ \\ell $ 满足精确的几何关系 $ \\ell = 2 R \\sin(\\theta/2) $。从基本定义 $ \\kappa = d\\phi/ds $ 和给定的离散估计量 $ \\kappa^{(d)} = \\theta/\\ell $ 出发，使用小角度展开推导主阶离散化误差 $ \\Delta \\kappa = \\kappa^{(d)} - \\kappa $，作为 $ \\ell $ 和 $R$ 的函数。然后，利用这个主阶估计，提出一个网格重划分准则，以保证相对曲率误差满足 $ |\\Delta \\kappa|/\\kappa \\le \\varepsilon_{k} $，其中 $ \\varepsilon_{k} $ 是一个预设的容差（无量纲常数）。\n  \n请以 $ \\kappa $ 和 $ \\varepsilon_{k} $ 表示的最大允许线段长度 $ \\ell_{\\max} $ 的单个闭式表达式的形式提供您的最终答案。最终表达式中不要包含单位。如果您推导了中间表达式，则必须用 LaTeX 呈现所有数学实体。最终答案必须是单个解析表达式。",
            "solution": "首先对问题陈述进行验证。\n\n从陈述中提取的已知条件如下：\n- 光滑曲线的真实曲率由 $\\kappa = d\\phi/ds$ 定义，其中 $\\phi$ 是切线角，$s$ 是弧长。\n- 节点 $i$ 处的离散曲率估计量由 $\\kappa_{i}^{(d)} = \\theta_{i} / \\bar{\\ell}_{i}$ 给出，其中 $\\theta_i$ 是转角，$\\bar{\\ell}_i$ 是平均线段长度。\n- 对于均匀分段，$\\bar{\\ell}_{i} = \\ell$，所以估计量为 $\\kappa^{(d)} = \\theta / \\ell$。\n- 位错环的局部区域由半径为 $R$ 的圆弧近似，其真实曲率为 $\\kappa = 1/R$。\n- 离散化是一个内接正多边形，其弦长 $\\ell$ 和转角 $\\theta$ 通过 $\\ell = 2 R \\sin(\\theta/2)$ 相关联。\n- 目标是找到主阶离散化误差 $\\Delta \\kappa = \\kappa^{(d)} - \\kappa$。\n- 更进一步的目标是基于相对误差容差 $|\\Delta \\kappa|/\\kappa \\le \\varepsilon_{k}$ 推导出一个网格重划分准则。\n- 最终答案必须是最大允许线段长度 $\\ell_{\\max}$ 关于 $\\kappa$ 和 $\\varepsilon_{k}$ 的表达式。\n\n问题被认为是有效的。它在离散位错动力学领域有科学依据，并使用标准的数学技术进行数值误差分析。该问题是适定的、自洽的，并且所有术语都有客观而精确的定义。没有逻辑矛盾或事实错误。\n\n我们开始求解。任务是首先推导离散化误差，然后用它来建立一个网格重划分准则。\n\n首先，我们必须用几何参数 $R$ 和 $\\ell$ 来表示离散曲率估计量 $\\kappa^{(d)}$。我们已知关系式 $\\kappa^{(d)} = \\theta/\\ell$ 和 $\\ell = 2 R \\sin(\\theta/2)$。从第二个关系式中，我们求解转角 $\\theta$：\n$$\n\\frac{\\ell}{2R} = \\sin\\left(\\frac{\\theta}{2}\\right)\n$$\n$$\n\\theta = 2 \\arcsin\\left(\\frac{\\ell}{2R}\\right)\n$$\n这是有效的，因为弦长 $\\ell$ 必须小于或等于直径 $2R$。将这个 $\\theta$ 的表达式代入 $\\kappa^{(d)}$ 的公式中，得到：\n$$\n\\kappa^{(d)} = \\frac{2 \\arcsin\\left(\\frac{\\ell}{2R}\\right)}{\\ell}\n$$\n为了找到主阶误差，我们假设线段长度 $\\ell$ 与曲率半径 $R$ 相比很小。这对应于极限 $\\ell/R \\ll 1$，相当于一个小的转角 $\\theta$。我们使用反正弦函数 $\\arcsin(x)$ 在 $x=0$ 附近的泰勒级数展开：\n$$\n\\arcsin(x) = x + \\frac{1}{6}x^3 + O(x^5)\n$$\n令 $x = \\ell/(2R)$，展开式变为：\n$$\n\\arcsin\\left(\\frac{\\ell}{2R}\\right) = \\left(\\frac{\\ell}{2R}\\right) + \\frac{1}{6}\\left(\\frac{\\ell}{2R}\\right)^3 + O\\left(\\left(\\frac{\\ell}{R}\\right)^5\\right) = \\frac{\\ell}{2R} + \\frac{\\ell^3}{48R^3} + O(\\ell^5)\n$$\n现在，我们将这个级数代入 $\\kappa^{(d)}$ 的表达式中：\n$$\n\\kappa^{(d)} = \\frac{2}{\\ell} \\left[ \\frac{\\ell}{2R} + \\frac{\\ell^3}{48R^3} + O(\\ell^5) \\right]\n$$\n分配 $2/\\ell$ 项，我们得到离散曲率的展开式：\n$$\n\\kappa^{(d)} = \\frac{1}{R} + \\frac{\\ell^2}{24R^3} + O(\\ell^4)\n$$\n真实曲率由 $\\kappa = 1/R$ 给出。离散化误差 $\\Delta \\kappa$ 定义为 $\\kappa^{(d)} - \\kappa$。因此：\n$$\n\\Delta \\kappa = \\left( \\frac{1}{R} + \\frac{\\ell^2}{24R^3} + O(\\ell^4) \\right) - \\frac{1}{R} = \\frac{\\ell^2}{24R^3} + O(\\ell^4)\n$$\n主阶离散化误差为 $\\Delta \\kappa \\approx \\frac{\\ell^2}{24R^3}$。\n\n接下来，我们基于相对曲率误差 $|\\Delta \\kappa|/\\kappa \\le \\varepsilon_{k}$ 建立网格重划分准则。由于 $\\ell$ 和 $R$ 代表物理长度，它们是正的，这使得 $\\Delta \\kappa$ 为正。因此，$|\\Delta \\kappa| = \\Delta \\kappa$。相对误差为：\n$$\n\\frac{\\Delta \\kappa}{\\kappa} \\approx \\frac{\\frac{\\ell^2}{24R^3}}{\\frac{1}{R}} = \\frac{\\ell^2}{24R^2}\n$$\n因此，网格重划分准则是：\n$$\n\\frac{\\ell^2}{24R^2} \\le \\varepsilon_{k}\n$$\n我们现在必须求解最大允许线段长度 $\\ell_{\\max}$，并用 $\\kappa$ 和 $\\varepsilon_{k}$ 来表示它。我们使用关系式 $R = 1/\\kappa$。问题背景暗示了局部凸的曲线形状，所以我们取 $R  0$ 和 $\\kappa  0$。将 $R=1/\\kappa$ 代入不等式中：\n$$\n\\frac{\\ell^2}{24(1/\\kappa)^2} \\le \\varepsilon_{k}\n$$\n$$\n\\frac{\\ell^2 \\kappa^2}{24} \\le \\varepsilon_{k}\n$$\n求解 $\\ell^2$：\n$$\n\\ell^2 \\le \\frac{24\\varepsilon_{k}}{\\kappa^2}\n$$\n取平方根得到线段长度 $\\ell$ 的上限：\n$$\n\\ell \\le \\sqrt{\\frac{24\\varepsilon_{k}}{\\kappa^2}} = \\frac{\\sqrt{24\\varepsilon_{k}}}{\\kappa}\n$$\n化简根式项，$\\sqrt{24} = \\sqrt{4 \\cdot 6} = 2\\sqrt{6}$。\n$$\n\\ell \\le \\frac{2\\sqrt{6\\varepsilon_{k}}}{\\kappa}\n$$\n最大允许线段长度 $\\ell_{\\max}$ 对应于等式：\n$$\n\\ell_{\\max} = \\frac{2\\sqrt{6\\varepsilon_{k}}}{\\kappa}\n$$\n这个表达式提供了所需的网格重划分准则，将局部网格尺寸与局部曲率和预设的误差容差联系起来。",
            "answer": "$$\n\\boxed{\\frac{2\\sqrt{6\\varepsilon_{k}}}{\\kappa}}\n$$"
        },
        {
            "introduction": "现在，让我们将这些基本概念应用于模拟一个真实的材料现象。在体心立方（BCC）金属中，交滑移是塑性变形的一个关键机制，并受到非施密特应力的显著影响。本练习  提供了一个分步指南，用于构建一个计算交滑移速率的计算模型，将应力分析与热激活过程理论相结合，从而展示离散位错动力学的预测能力。",
            "id": "3445349",
            "problem": "考虑一个体心立方（BCC）晶体，其中包含一个直螺型位错，其柏氏矢量平行于晶体学方向 $[1\\,1\\,1]$。在离散位错动力学中，BCC螺位错的交滑移是热激活过程，并受到非施密特效应的强烈影响。请基于第一性原理，开发一个计算程序，用以评估两个候选交滑移面上的交滑移速率，并将其作为所施加单轴应力方向的函数。您的程序必须针对指定的测试套件产生数值输出，无需用户输入。\n\n从以下基本原理出发：\n\n- 作用在单位长度位错上的Peach–Koehler力由所施加的柯西应力张量 $\\boldsymbol{\\sigma}$、柏氏矢量 $\\mathbf{b}$ 和位错线方向 $\\boldsymbol{\\xi}$ 决定。\n- 在应力 $\\boldsymbol{\\sigma}$ 作用下，单位法向量为 $\\mathbf{n}$ 的平面上的牵引力矢量为 $\\mathbf{t} = \\boldsymbol{\\sigma}\\cdot\\mathbf{n}$。\n- 该平面内的分解剪切牵引力是 $\\mathbf{t}$ 的面内分量，可分解为一个平行于滑移方向的分量和一个与之正交的面内剪切分量。\n- 交滑移被建模为一个热激活过程，其尝试频率和激活自由能会因与激活体积相关的机械功而降低。最终的速率遵循经典的阿伦尼乌斯型关系。\n\n使用这些经过充分检验的事实来构建以下依赖于取向的、经非施密特效应增强的应力衡量标准和速率模型：\n\n- 将螺位错方向固定为单位矢量 $\\mathbf{s} = [1,1,1]/\\|\\,[1,1,1]\\,\\|$。\n- 考虑两个包含 $\\mathbf{s}$ 的候选 $\\{110\\}$ 平面，其单位法向量为\n  $\\mathbf{n}_1 = [1,-1,0]/\\|\\,[1,-1,0]\\,\\|$ 和 $\\mathbf{n}_2 = [1,0,-1]/\\|\\,[1,0,-1]\\,\\|$。\n- 定义一个大小为 $\\sigma_0$ 的单轴应力，沿单位矢量 $\\mathbf{u}(\\theta)$ 方向施加，其中取向角 $\\theta$ 以弧度为单位。通过在 $\\mathbf{s}$ 和一个单位矢量 $\\mathbf{p}_0$ 所张成的平面内旋转来构造 $\\mathbf{u}(\\theta)$，其中 $\\mathbf{p}_0$ 与 $\\mathbf{s}$ 正交且位于平面 $\\mathbf{n}_1$ 内，并选择 $\\mathbf{p}_0$ 指向 $\\mathbf{n}_1\\times\\mathbf{s}$ 的归一化方向。令\n  $\\mathbf{u}(\\theta) = \\big(\\cos\\theta\\big)\\,\\mathbf{s} + \\big(\\sin\\theta\\big)\\,\\mathbf{p}_0$，并归一化为单位长度。\n- 单轴应力张量为 $\\boldsymbol{\\sigma} = \\sigma_0\\,\\mathbf{u}(\\theta)\\otimes\\mathbf{u}(\\theta)$。\n- 对于每个法向量为 $\\mathbf{n}_j$ 的平面 $j\\in\\{1,2\\}$，计算牵引力矢量 $\\mathbf{t}_j=\\boldsymbol{\\sigma}\\cdot\\mathbf{n}_j$。将面内剪切牵引力 $\\boldsymbol{\\tau}_j = \\mathbf{t}_j - \\big(\\mathbf{n}_j\\cdot\\mathbf{t}_j\\big)\\mathbf{n}_j$ 分解为\n  (i) 沿螺位错方向的分量 $\\tau_j^{\\parallel} = \\mathbf{s}\\cdot\\boldsymbol{\\tau}_j$，以及\n  (ii) 沿与 $\\mathbf{s}$ 正交的面内单位方向的分量，该方向定义为 $\\mathbf{p}_j = \\big(\\mathbf{n}_j\\times\\mathbf{s}\\big)/\\|\\mathbf{n}_j\\times\\mathbf{s}\\|$，其分量为 $\\tau_j^{\\perp} = \\mathbf{p}_j\\cdot\\boldsymbol{\\tau}_j$。同时定义法向牵引力 $t_j^{n}=\\mathbf{n}_j\\cdot\\mathbf{t}_j$。\n- 计算最大分解剪应力（MRSS）为 $\\tau_{\\mathrm{MRSS}} = \\max\\big(|\\tau_1^{\\parallel}|,|\\tau_2^{\\parallel}|\\big)$。\n- 为每个平面构建一个增强的有效应力，\n  $\\tau^{\\mathrm{eff}}_j = \\tau_{\\mathrm{MRSS}} + k_1\\,\\tau_j^{\\perp} + k_2\\,t_j^{n}$，\n  其中 $k_1$ 和 $k_2$ 分别是捕捉平面上非滑移面内剪切应力和法向应力的非施密特权重的无量纲系数。\n- 将平面 $j$ 上交滑移的激活自由能建模为一个应力降低的能垒，\n  $\\Delta G_j = \\max\\big(\\Delta G_{\\min}, \\Delta G_0 - V\\,|\\tau^{\\mathrm{eff}}_j|\\big)$，\n  其中 $\\Delta G_0$ 是零应力激活自由能，$V$ 是激活体积，$\\Delta G_{\\min}$ 是一个防止无能垒发散的小的正下界。平面 $j$ 的交滑移速率则为\n  $R_j = \\nu_0\\,\\exp\\big(-\\Delta G_j/(k_{\\mathrm{B}}T)\\big)$，\n  其中 $\\nu_0$ 是尝试频率，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n在所有计算中采用以下物理上合理的常数和单位：\n- 柏氏矢量大小 $b = 2.48\\times 10^{-10}\\,\\mathrm{m}$。\n- 激活体积 $V = 5\\,b^3$ (单位 $\\mathrm{m}^3$)。\n- 零应力激活自由能 $\\Delta G_0 = 1.20\\,\\mathrm{eV}$ (转换为焦耳)，以及下界 $\\Delta G_{\\min} = 0.02\\,\\mathrm{eV}$ (转换为焦耳)。\n- 尝试频率 $\\nu_0 = 1.0\\times 10^{12}\\,\\mathrm{s}^{-1}$。\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n- 应力大小 $\\sigma_0$ 单位为帕斯卡，温度 $T$ 单位为开尔文，角度 $\\theta$ 单位为弧度。\n\n对于下面的测试套件，为每种情况计算无量纲的平面选择代理指标\n$r = R_1/(R_1+R_2)$，该指标位于区间 $[0,1]$ 内，表示由于取向和非施密特效应导致的选择平面1相对于平面2的偏好程度。$r$ 没有物理单位。\n\n测试套件（每种情况为 $(\\sigma_0,T,k_1,k_2,\\theta)$）：\n1. $(6.00\\times 10^{8}\\,\\mathrm{Pa},\\,300\\,\\mathrm{K},\\,0.20,\\,-0.05,\\,0.0\\,\\mathrm{rad})$。\n2. $(6.00\\times 10^{8}\\,\\mathrm{Pa},\\,300\\,\\mathrm{K},\\,0.20,\\,-0.05,\\,\\pi/6\\,\\mathrm{rad})$。\n3. $(6.00\\times 10^{8}\\,\\mathrm{Pa},\\,300\\,\\mathrm{K},\\,0.20,\\,-0.05,\\,\\pi/3\\,\\mathrm{rad})$。\n4. $(6.00\\times 10^{8}\\,\\mathrm{Pa},\\,300\\,\\mathrm{K},\\,0.20,\\,-0.05,\\,\\pi/2\\,\\mathrm{rad})$。\n5. $(0.0\\,\\mathrm{Pa},\\,300\\,\\mathrm{K},\\,0.20,\\,-0.05,\\,\\pi/4\\,\\mathrm{rad})$。\n6. $(6.00\\times 10^{8}\\,\\mathrm{Pa},\\,950\\,\\mathrm{K},\\,0.50,\\,0.30,\\,\\pi/6\\,\\mathrm{rad})$。\n7. $(6.00\\times 10^{8}\\,\\mathrm{Pa},\\,300\\,\\mathrm{K},\\,-0.30,\\,-0.20,\\,\\pi/6\\,\\mathrm{rad})$。\n\n您的程序应生成单行输出，其中包含七个结果，形式为方括号内以逗号分隔的列表，例如 $[\\text{结果}_1,\\text{结果}_2,\\dots,\\text{结果}_7]$。每个条目必须是代表相应测试用例的 $r$ 值的浮点数。角度输入以弧度为单位；应力以帕斯卡为单位；温度以开尔文为单位。输出值为无单位的无量纲浮点数。",
            "solution": "该问题要求开发一个计算程序，以确定在单轴应力作用下，体心立方（BCC）晶体中螺位错的交滑移平面选择。该选择通过一个代理指标 $r = R_1/(R_1+R_2)$ 来量化，其中 $R_1$ 和 $R_2$ 是到两个候选平面（平面1和平面2）上的热激活交滑移速率。计算必须考虑非施密特效应和所施加应力的取向。\n\n解决方案是根据问题陈述中指定的模型来制定的。这涉及一系列计算，从定义晶体几何结构和加载条件，到评估每个平面上的应力状态，最后计算激活能和速率。\n\n**1. 几何定义**\n几何结构由笛卡尔坐标系中的一组标准正交矢量定义。\n螺位错线方向沿着晶体学 $[1\\,1\\,1]$ 方向。相应的单位矢量 $\\mathbf{s}$ 为：\n$$\n\\mathbf{s} = \\frac{1}{\\| [1,1,1] \\|} [1,1,1] = \\frac{1}{\\sqrt{1^2+1^2+1^2}} [1,1,1] = \\frac{1}{\\sqrt{3}}[1,1,1]\n$$\n两个候选交滑移面属于 $\\{110\\}$ 类型，并包含螺位错线 $\\mathbf{s}$。它们的单位法向量 $\\mathbf{n}_1$ 和 $\\mathbf{n}_2$ 为：\n$$\n\\mathbf{n}_1 = \\frac{1}{\\| [1,-1,0] \\|} [1,-1,0] = \\frac{1}{\\sqrt{1^2+(-1)^2+0^2}} [1,-1,0] = \\frac{1}{\\sqrt{2}}[1,-1,0]\n$$\n$$\n\\mathbf{n}_2 = \\frac{1}{\\| [1,0,-1] \\|} [1,0,-1] = \\frac{1}{\\sqrt{1^2+0^2+(-1)^2}} [1,0,-1] = \\frac{1}{\\sqrt{2}}[1,0,-1]\n$$\n注意 $\\mathbf{s} \\cdot \\mathbf{n}_1 = 0$ 和 $\\mathbf{s} \\cdot \\mathbf{n}_2 = 0$，这证实了位错线位于这两个平面内。\n\n对于每个平面 $j \\in \\{1,2\\}$，一个与 $\\mathbf{s}$ 正交的面内方向由单位矢量 $\\mathbf{p}_j$ 定义：\n$$\n\\mathbf{p}_j = \\frac{\\mathbf{n}_j \\times \\mathbf{s}}{\\| \\mathbf{n}_j \\times \\mathbf{s} \\|}\n$$\n对于平面1：\n$$\n\\mathbf{n}_1 \\times \\mathbf{s} = \\frac{1}{\\sqrt{6}} \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ 1  -1  0 \\\\ 1  1  1 \\end{pmatrix} = \\frac{1}{\\sqrt{6}}[-1, -1, 2]\n$$\n其范数为 $\\| \\mathbf{n}_1 \\times \\mathbf{s} \\| = \\frac{1}{\\sqrt{6}}\\sqrt{(-1)^2+(-1)^2+2^2} = 1$。因此，$\\mathbf{p}_1 = \\frac{1}{\\sqrt{6}}[-1, -1, 2]$。\n对于平面2：\n$$\n\\mathbf{n}_2 \\times \\mathbf{s} = \\frac{1}{\\sqrt{6}} \\det \\begin{pmatrix} \\mathbf{i}  \\mathbf{j}  \\mathbf{k} \\\\ 1  0  -1 \\\\ 1  1  1 \\end{pmatrix} = \\frac{1}{\\sqrt{6}}[1, -2, 1]\n$$\n其范数为 $\\| \\mathbf{n}_2 \\times \\mathbf{s} \\| = \\frac{1}{\\sqrt{6}}\\sqrt{1^2+(-2)^2+1^2} = 1$。因此，$\\mathbf{p}_2 = \\frac{1}{\\sqrt{6}}[1, -2, 1]$。\n\n**2. 加载条件**\n一个大小为 $\\sigma_0$ 的单轴应力沿单位矢量 $\\mathbf{u}(\\theta)$ 的方向施加。该矢量是通过在由 $\\mathbf{s}$ 和一个特定的正交矢量 $\\mathbf{p}_0$ 所张成的平面内旋转而构造的。问题将 $\\mathbf{p}_0$ 定义为沿 $\\mathbf{n}_1 \\times \\mathbf{s}$ 的归一化方向，这恰好是 $\\mathbf{p}_1$。所以，$\\mathbf{p}_0 = \\mathbf{p}_1$。用于旋转的基矢量 $\\mathbf{s}$ 和 $\\mathbf{p}_0$ 是标准正交的。\n因此，加载方向为：\n$$\n\\mathbf{u}(\\theta) = (\\cos\\theta)\\,\\mathbf{s} + (\\sin\\theta)\\,\\mathbf{p}_0\n$$\n由于 $\\mathbf{s}$ 和 $\\mathbf{p}_0$ 是标准正交的，$\\| \\mathbf{u}(\\theta) \\|^2 = \\cos^2\\theta \\|\\mathbf{s}\\|^2 + \\sin^2\\theta \\|\\mathbf{p}_0\\|^2 = \\cos^2\\theta + \\sin^2\\theta = 1$，所以 $\\mathbf{u}(\\theta)$ 是一个单位矢量。应力张量由外积给出：\n$$\n\\boldsymbol{\\sigma} = \\sigma_0\\,\\mathbf{u}(\\theta)\\otimes\\mathbf{u}(\\theta)\n$$\n\n**3. 滑移面上的应力分析**\n在法向量为 $\\mathbf{n}_j$ 的平面 $j$ 上的牵引力矢量是 $\\mathbf{t}_j = \\boldsymbol{\\sigma}\\cdot\\mathbf{n}_j$。使用 $\\boldsymbol{\\sigma}$ 的表达式：\n$$\n\\mathbf{t}_j = \\sigma_0 (\\mathbf{u}(\\theta)\\otimes\\mathbf{u}(\\theta)) \\cdot \\mathbf{n}_j = \\sigma_0 \\mathbf{u}(\\theta) (\\mathbf{u}(\\theta) \\cdot \\mathbf{n}_j)\n$$\n应力分量——法向牵引力 $t_j^{n}$、平行剪切力 $\\tau_j^{\\parallel}$ 和垂直剪切力 $\\tau_j^{\\perp}$——是该牵引力的投影。\n$$\nt_j^{n} = \\mathbf{n}_j \\cdot \\mathbf{t}_j = \\sigma_0 (\\mathbf{u}(\\theta) \\cdot \\mathbf{n}_j)^2\n$$\n面内剪切牵引力为 $\\boldsymbol{\\tau}_j = \\mathbf{t}_j - t_j^n \\mathbf{n}_j$。其分量为：\n$$\n\\tau_j^{\\parallel} = \\mathbf{s} \\cdot \\boldsymbol{\\tau}_j = \\mathbf{s} \\cdot (\\mathbf{t}_j - t_j^n \\mathbf{n}_j) = \\sigma_0 (\\mathbf{u}(\\theta) \\cdot \\mathbf{n}_j) (\\mathbf{s} \\cdot \\mathbf{u}(\\theta)) - t_j^n (\\mathbf{s} \\cdot \\mathbf{n}_j)\n$$\n$$\n\\tau_j^{\\perp} = \\mathbf{p}_j \\cdot \\boldsymbol{\\tau}_j = \\mathbf{p}_j \\cdot (\\mathbf{t}_j - t_j^n \\mathbf{n}_j) = \\sigma_0 (\\mathbf{u}(\\theta) \\cdot \\mathbf{n}_j) (\\mathbf{p}_j \\cdot \\mathbf{u}(\\theta)) - t_j^n (\\mathbf{p}_j \\cdot \\mathbf{n}_j)\n$$\n由于根据构造有 $\\mathbf{s} \\cdot \\mathbf{n}_j = 0$ 和 $\\mathbf{p}_j \\cdot \\mathbf{n}_j = 0$，这些表达式可简化为：\n$$\n\\tau_j^{\\parallel} = \\sigma_0 (\\mathbf{u}(\\theta) \\cdot \\mathbf{n}_j) (\\mathbf{s} \\cdot \\mathbf{u}(\\theta))\n$$\n$$\n\\tau_j^{\\perp} = \\sigma_0 (\\mathbf{u}(\\theta) \\cdot \\mathbf{n}_j) (\\mathbf{p}_j \\cdot \\mathbf{u}(\\theta))\n$$\n涉及 $\\mathbf{u}(\\theta)$ 的点积使用其定义 $\\mathbf{u}(\\theta) = (\\cos\\theta)\\mathbf{s} + (\\sin\\theta)\\mathbf{p}_0$ 来计算：\n\\begin{itemize}\n    \\item $\\mathbf{u}(\\theta) \\cdot \\mathbf{n}_j = \\cos\\theta(\\mathbf{s}\\cdot\\mathbf{n}_j) + \\sin\\theta(\\mathbf{p}_0\\cdot\\mathbf{n}_j) = \\sin\\theta(\\mathbf{p}_0\\cdot\\mathbf{n}_j)$\n    \\item $\\mathbf{s} \\cdot \\mathbf{u}(\\theta) = \\cos\\theta(\\mathbf{s}\\cdot\\mathbf{s}) + \\sin\\theta(\\mathbf{s}\\cdot\\mathbf{p}_0) = \\cos\\theta$\n    \\item $\\mathbf{p}_j \\cdot \\mathbf{u}(\\theta) = \\cos\\theta(\\mathbf{p}_j\\cdot\\mathbf{s}) + \\sin\\theta(\\mathbf{p}_j\\cdot\\mathbf{p}_0) = \\sin\\theta(\\mathbf{p}_j\\cdot\\mathbf{p}_0)$\n\\end{itemize}\n将这些代入分量表达式中：\n$$\nt_j^n = \\sigma_0 \\sin^2\\theta (\\mathbf{p}_0 \\cdot \\mathbf{n}_j)^2\n$$\n$$\n\\tau_j^{\\parallel} = \\sigma_0 (\\sin\\theta (\\mathbf{p}_0 \\cdot \\mathbf{n}_j)) (\\cos\\theta) = \\frac{1}{2} \\sigma_0 \\sin(2\\theta) (\\mathbf{p}_0 \\cdot \\mathbf{n}_j)\n$$\n$$\n\\tau_j^{\\perp} = \\sigma_0 (\\sin\\theta (\\mathbf{p}_0 \\cdot \\mathbf{n}_j)) (\\sin\\theta (\\mathbf{p}_j \\cdot \\mathbf{p}_0)) = \\sigma_0 \\sin^2\\theta (\\mathbf{p}_0 \\cdot \\mathbf{n}_j) (\\mathbf{p}_j \\cdot \\mathbf{p}_0)\n$$\n所需的点积为：$\\mathbf{p}_0 \\cdot \\mathbf{n}_1 = 0$、$\\mathbf{p}_0 \\cdot \\mathbf{n}_2 = -3/\\sqrt{12} = -\\sqrt{3}/2$、$\\mathbf{p}_1 \\cdot \\mathbf{p}_0 = 1$ 和 $\\mathbf{p}_2 \\cdot \\mathbf{p}_0 = 1/2$。\n对于平面1（$j=1$），由于 $\\mathbf{p}_0 \\cdot \\mathbf{n}_1 = 0$，所有应力分量均为零：\n$$\nt_1^n = 0, \\quad \\tau_1^{\\parallel} = 0, \\quad \\tau_1^{\\perp} = 0\n$$\n对于平面2（$j=2$）：\n$$\nt_2^n = \\sigma_0 \\sin^2\\theta (-\\sqrt{3}/2)^2 = \\frac{3}{4} \\sigma_0 \\sin^2\\theta\n$$\n$$\n\\tau_2^{\\parallel} = \\frac{1}{2} \\sigma_0 \\sin(2\\theta) (-\\sqrt{3}/2) = -\\frac{\\sqrt{3}}{4} \\sigma_0 \\sin(2\\theta)\n$$\n$$\n\\tau_2^{\\perp} = \\sigma_0 \\sin^2\\theta (-\\sqrt{3}/2) (1/2) = -\\frac{\\sqrt{3}}{4} \\sigma_0 \\sin^2\\theta\n$$\n\n**4. 有效应力与激活能**\n最大分解剪应力（MRSS）为：\n$$\n\\tau_{\\mathrm{MRSS}} = \\max(|\\tau_1^{\\parallel}|, |\\tau_2^{\\parallel}|) = \\max(0, |-\\frac{\\sqrt{3}}{4} \\sigma_0 \\sin(2\\theta)|) = \\frac{\\sqrt{3}}{4} \\sigma_0 |\\sin(2\\theta)|\n$$\n每个平面的增强有效应力为 $\\tau^{\\mathrm{eff}}_j = \\tau_{\\mathrm{MRSS}} + k_1\\,\\tau_j^{\\perp} + k_2\\,t_j^{n}$。\n对于平面1：\n$$\n\\tau_1^{\\mathrm{eff}} = \\tau_{\\mathrm{MRSS}} + k_1(0) + k_2(0) = \\frac{\\sqrt{3}}{4} \\sigma_0 |\\sin(2\\theta)|\n$$\n对于平面2：\n$$\n\\tau_2^{\\mathrm{eff}} = \\tau_{\\mathrm{MRSS}} + k_1 \\tau_2^{\\perp} + k_2 t_2^n = \\frac{\\sqrt{3}}{4} \\sigma_0 |\\sin(2\\theta)| + k_1(-\\frac{\\sqrt{3}}{4} \\sigma_0 \\sin^2\\theta) + k_2(\\frac{3}{4} \\sigma_0 \\sin^2\\theta)\n$$\n$$\n\\tau_2^{\\mathrm{eff}} = \\frac{\\sigma_0}{4} \\left( \\sqrt{3} |\\sin(2\\theta)| + (3k_2 - \\sqrt{3}k_1) \\sin^2\\theta \\right)\n$$\n平面 $j$ 上交滑移的激活自由能由下式给出：\n$$\n\\Delta G_j = \\max(\\Delta G_{\\min}, \\Delta G_0 - V|\\tau_j^{\\mathrm{eff}}|)\n$$\n其中 $\\Delta G_0$ 是零应力能垒，$V$ 是激活体积，$\\Delta G_{\\min}$ 是一个下界。这些常数的数值在问题陈述中已提供。具体来说，$b = 2.48\\times 10^{-10}\\,\\mathrm{m}$，$V = 5b^3$，$\\Delta G_0 = 1.20\\,\\mathrm{eV}$，以及 $\\Delta G_{\\min} = 0.02\\,\\mathrm{eV}$。单位必须一致（国际单位制）。使用转换关系 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。\n\n**5. 交滑移速率与选择代理指标**\n交滑移速率遵循阿伦尼乌斯型定律：\n$$\nR_j = \\nu_0\\,\\exp\\left(-\\frac{\\Delta G_j}{k_{\\mathrm{B}}T}\\right)\n$$\n其中 $\\nu_0$ 是尝试频率，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。平面选择代理指标 $r$ 为：\n$$\nr = \\frac{R_1}{R_1+R_2} = \\frac{\\nu_0\\,\\exp(-\\Delta G_1/(k_{\\mathrm{B}}T))}{\\nu_0\\,\\exp(-\\Delta G_1/(k_{\\mathrm{B}}T)) + \\nu_0\\,\\exp(-\\Delta G_2/(k_{\\mathrm{B}}T))}\n$$\n这可以简化为能量差的逻辑斯蒂函数：\n$$\nr = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G_1 - \\Delta G_2}{k_{\\mathrm{B}}T}\\right)}\n$$\n如果 $\\sigma_0 = 0$，则 $\\tau_1^{\\mathrm{eff}}=\\tau_2^{\\mathrm{eff}}=0$，导致 $\\Delta G_1 = \\Delta G_2 = \\Delta G_0$，因此 $r = 1/(1+e^0) = 0.5$。\n\n对于每个测试用例 $(\\sigma_0, T, k_1, k_2, \\theta)$，其计算步骤是：使用上述公式计算 $\\tau_1^{\\mathrm{eff}}$ 和 $\\tau_2^{\\mathrm{eff}}$，然后计算 $\\Delta G_1$ 和 $\\Delta G_2$，最后计算 $r$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the cross-slip plane-selection proxy for a series of test cases.\n    \"\"\"\n\n    # Physical constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs, for eV to J conversion\n    B_MAG = 2.48e-10  # Burgers vector magnitude in m\n    V_ACT = 5 * B_MAG**3  # Activation volume in m^3\n    DG0 = 1.20 * E_CHARGE  # Zero-stress activation free energy in J\n    DG_MIN = 0.02 * E_CHARGE  # Minimum activation free energy in J\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Test suite: (sigma_0, T, k1, k2, theta)\n    test_cases = [\n        (6.00e8, 300, 0.20, -0.05, 0.0),            # Pa, K, dimensionless, dimensionless, rad\n        (6.00e8, 300, 0.20, -0.05, np.pi/6),\n        (6.00e8, 300, 0.20, -0.05, np.pi/3),\n        (6.00e8, 300, 0.20, -0.05, np.pi/2),\n        (0.0,    300, 0.20, -0.05, np.pi/4),\n        (6.00e8, 950, 0.50,  0.30, np.pi/6),\n        (6.00e8, 300, -0.30, -0.20, np.pi/6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        sigma_0, T, k1, k2, theta = case\n\n        # Handle the trivial case of zero applied stress\n        if sigma_0 == 0.0:\n            results.append(0.5)\n            continue\n\n        # Calculate trigonometric terms\n        sin_theta = np.sin(theta)\n        sin_2theta = np.sin(2 * theta)\n\n        # Calculate effective stresses for plane 1 and plane 2\n        # tau_eff_1 depends only on the Maximum Resolved Shear Stress (MRSS)\n        tau_eff_1 = (np.sqrt(3) / 4) * sigma_0 * np.abs(sin_2theta)\n\n        # tau_eff_2 has additional non-Schmid contributions\n        tau_mrss = tau_eff_1\n        non_schmid_term = (3 * k2 - np.sqrt(3) * k1) * sin_theta**2\n        tau_eff_2 = (sigma_0 / 4) * (np.sqrt(3) * np.abs(sin_2theta) + non_schmid_term)\n\n        # Calculate activation free energies for each plane\n        # Delta G = max(G_min, G0 - V * |tau_eff|)\n        delta_g1 = max(DG_MIN, DG0 - V_ACT * np.abs(tau_eff_1))\n        delta_g2 = max(DG_MIN, DG0 - V_ACT * np.abs(tau_eff_2))\n\n        # Calculate the plane-selection proxy r\n        # r = 1 / (1 + exp((G1 - G2) / (kT)))\n        kBT = KB * T\n        if kBT == 0:  # Avoid division by zero, although T is always positive here\n            #\n            # The limit depends on the sign of (delta_g1 - delta_g2).\n            # If G1  G2, exp - inf, r - 0.\n            # If G1  G2, exp - 0, r - 1.\n            # If G1 = G2, r - 0.5.\n            if delta_g1  delta_g2:\n                r = 0.0\n            elif delta_g1  delta_g2:\n                r = 1.0\n            else:\n                r = 0.5\n        else:\n            exponent = (delta_g1 - delta_g2) / kBT\n            # Guard against overflow in exp\n            if exponent  np.log(np.finfo(float).max):\n                 r = 0.0\n            else:\n                 r = 1.0 / (1.0 + np.exp(exponent))\n        \n        results.append(r)\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}