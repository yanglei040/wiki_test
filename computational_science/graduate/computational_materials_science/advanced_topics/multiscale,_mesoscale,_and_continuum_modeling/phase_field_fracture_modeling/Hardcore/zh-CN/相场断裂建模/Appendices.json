{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在对 Ambrosio-Tortorelli (AT2) 相场模型进行基础分析。通过解析求解一维稳态裂纹的平衡分布，您将具体理解该模型如何正则化一个尖锐裂纹，以及长度尺度参数 $\\ell$ 如何控制过渡区的宽度。该推导是理解相场断裂力学变分性质的基石。",
            "id": "3550298",
            "problem": "在断裂相场模拟的框架下，考虑一个中心位于 $x=0$ 的静态直裂纹，其所在区域为一维无限域 $\\mathbb{R}$。令 $d(x)$ 表示标量相场变量，其中 $d=1$ 代表完全断裂的材料， $d=0$ 代表完好材料。假设采用 Ambrosio-Tortorelli 2型 (AT2) 裂纹表面密度泛函，正则化长度尺度 $\\ell>0$，临界能量释放率 $G_c>0$，以及一个趋于零的残余刚度参数 $\\kappa \\to 0$，因此不存在弹性驱动能，唯一的能量贡献是断裂表面能。\n\n从最小势能原理和一维形式的AT2断裂表面泛函出发\n$$\n\\Psi[d] \\;=\\; \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{d(x)^{2}}{2\\,\\ell} \\;+\\; \\frac{\\ell}{2}\\left(\\frac{\\mathrm{d}d}{\\mathrm{d}x}\\right)^{2} \\right)\\,\\mathrm{d}x,\n$$\n通过求解相应的欧拉-拉格朗日方程，确定与静态直裂纹相对应的平衡相场分布 $d(x)$，该方程需满足具有物理意义的条件 $d(0)=1$ 以及当 $|x|\\to\\infty$ 时 $d(x)\\to 0$。然后，使用该分布，通过计算积分 $\\Psi[d]$ 来解析地验证单位裂纹面积上的总断裂表面能等于 $G_c$。\n\n您的最终答案必须提供：\n- 平衡分布 $d(x)$ 的闭式表达式，以及\n- 单位面积的断裂表面能的值，用 $G_c$ 符号表示。\n\n不要在最终的方框答案中代入任何数值，也不要包含单位。仅用 $G_c$ 符号表示能量。如果使用任何角度量，它们必须以弧度为单位；但是，本问题不需要进行四舍五入。",
            "solution": "用户希望解决一个相场断裂问题，以下是完成此任务的逐步流程。\n\n### 步骤1：问题验证\n\n问题陈述描述了断裂相场模拟中一个标准的、尽管是简化的情景。\n\n**提取的已知条件：**\n*   **域：** 一维无限域 $\\mathbb{R}$。\n*   **物理设置：** 位于 $x=0$ 的静态直裂纹。\n*   **相场变量：** $d(x)$，其中 $d=1$ 代表断裂材料， $d=0$ 代表完好材料。\n*   **断裂表面泛函 (AT2)：** $\\Psi[d] = \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{d(x)^{2}}{2\\,\\ell} + \\frac{\\ell}{2}\\left(\\frac{\\mathrm{d}d}{\\mathrm{d}x}\\right)^{2} \\right)\\,\\mathrm{d}x$。\n*   **参数：** 正则化长度尺度 $\\ell>0$ 和临界能量释放率 $G_c>0$。\n*   **假设：** 无弹性驱动能（等效于残余刚度 $\\kappa \\to 0$）。\n*   **边界条件：** $d(0)=1$ 且当 $|x|\\to\\infty$ 时 $d(x)\\to 0$。\n*   **目标1：** 通过求解泛函 $\\Psi[d]$ 的欧拉-拉格朗日方程，找到平衡相场分布 $d(x)$。\n*   **目标2：** 使用推导出的分布 $d(x)$，解析地验证总断裂表面能 $\\Psi[d]$ 的计算结果为 $G_c$。\n\n**验证结论：**\n该问题是 **有效的**。\n1.  **科学依据：** 该问题使用了 Ambrosio-Tortorelli (AT2) 泛函，这是变分断裂力学的一个基石。使用欧拉-拉格朗日方程通过最小化势能泛函来寻找平衡分布是物理学和力学中的一种标准方法。\n2.  **适定性：** 该问题是一个针对二阶常微分方程的定义良好的边值问题。给定的条件充分且一致，能够导出一个唯一、稳定且有意义的解。\n3.  **目标：** 语言正式且精确，所有术语都在计算地质力学和相场理论的背景下进行了定义。\n\n### 步骤2：求解推导\n\n平衡分布 $d(x)$ 是使势能泛函 $\\Psi[d]$ 最小化的函数。由于没有弹性势能，我们只需最小化断裂表面泛函。这是变分法中的一个经典问题。\n\n泛函的被积函数是拉格朗日量 $L$：\n$$\nL\\left(d, \\frac{\\mathrm{d}d}{\\mathrm{d}x}\\right) = G_c \\left( \\frac{d^{2}}{2\\,\\ell} + \\frac{\\ell}{2}\\left(\\frac{\\mathrm{d}d}{\\mathrm{d}x}\\right)^{2} \\right)\n$$\n最小化 $\\Psi[d]$ 的函数 $d(x)$ 必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial (\\mathrm{d}d/\\mathrm{d}x)}\\right) = 0\n$$\n首先，我们计算 $L$ 的偏导数：\n$$\n\\frac{\\partial L}{\\partial d} = G_c \\left(\\frac{2d}{2\\ell}\\right) = \\frac{G_c d}{\\ell}\n$$\n$$\n\\frac{\\partial L}{\\partial (\\mathrm{d}d/\\mathrm{d}x)} = G_c \\left(\\frac{\\ell}{2} \\cdot 2 \\frac{\\mathrm{d}d}{\\mathrm{d}x}\\right) = G_c \\ell \\frac{\\mathrm{d}d}{\\mathrm{d}x}\n$$\n将这些代入欧拉-拉格朗日方程，得到：\n$$\n\\frac{G_c d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(G_c \\ell \\frac{\\mathrm{d}d}{\\mathrm{d}x}\\right) = 0\n$$\n由于 $G_c$ 和 $\\ell$ 是非零常数，我们可以简化方程：\n$$\n\\frac{d}{\\ell} - \\ell \\frac{\\mathrm{d}^2 d}{\\mathrm{d}x^2} = 0\n$$\n$$\n\\frac{\\mathrm{d}^2 d}{\\mathrm{d}x^2} - \\frac{1}{\\ell^2} d = 0\n$$\n这是一个具有常系数的二阶线性齐次常微分方程。其特征方程为 $r^2 - 1/\\ell^2 = 0$，根为 $r_1 = 1/\\ell$ 和 $r_2 = -1/\\ell$。\n因此，通解为：\n$$\nd(x) = C_1 \\exp\\left(\\frac{x}{\\ell}\\right) + C_2 \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\n其中 $C_1$ 和 $C_2$ 是待定常数，由边界条件确定。\n\n边界条件为当 $|x| \\to \\infty$ 时 $d(x) \\to 0$ 以及 $d(0)=1$。\n1.  对于条件 $x \\to \\infty$ 时 $d(x) \\to 0$，项 $C_1 \\exp(x/\\ell)$ 将会无限增大，除非 $C_1=0$。因此，对于 $x>0$，我们必须有 $C_1=0$。\n2.  对于条件 $x \\to -\\infty$ 时 $d(x) \\to 0$，项 $C_2 \\exp(-x/\\ell)$ 将会无限增大，除非 $C_2=0$。因此，对于 $x<0$，我们必须有 $C_2=0$。\n\n这表明我们应该考虑分段解，或者更优雅地，使用绝对值函数来合并衰减条件，这也与问题在裂纹中心 $x=0$ 处的物理对称性相符。对于 $x \\to \\infty$ 和 $x \\to -\\infty$ 都衰减的解必须具有以下形式：\n$$\nd(x) = C \\exp\\left(-\\frac{|x|}{\\ell}\\right)\n$$\n现在，我们应用裂纹中心的条件 $d(0)=1$：\n$$\nd(0) = C \\exp\\left(-\\frac{|0|}{\\ell}\\right) = C \\exp(0) = C = 1\n$$\n因此，平衡相场分布为：\n$$\nd(x) = \\exp\\left(-\\frac{|x|}{\\ell}\\right)\n$$\n\n接下来，我们验证该分布的总断裂表面能 $\\Psi[d]$ 等于 $G_c$。我们将 $d(x)$ 及其导数代入泛函中。\n对于 $x \\neq 0$，$d(x)$ 的导数为：\n$$\n\\frac{\\mathrm{d}d}{\\mathrm{d}x} = -\\frac{\\mathrm{sgn}(x)}{\\ell} \\exp\\left(-\\frac{|x|}{\\ell}\\right)\n$$\n其中 $\\mathrm{sgn}(x)$ 是符号函数。\n导数的平方是：\n$$\n\\left(\\frac{\\mathrm{d}d}{\\mathrm{d}x}\\right)^2 = \\frac{1}{\\ell^2} \\exp\\left(-\\frac{2|x|}{\\ell}\\right)\n$$\n分布本身的平方是：\n$$\nd(x)^2 = \\exp\\left(-\\frac{2|x|}{\\ell}\\right)\n$$\n现在，将这些代入 $\\Psi[d]$ 的积分中：\n$$\n\\Psi[d] = \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{\\exp(-2|x|/\\ell)}{2\\ell} + \\frac{\\ell}{2} \\left(\\frac{1}{\\ell^2} \\exp(-2|x|/\\ell)\\right) \\right)\\,\\mathrm{d}x\n$$\n$$\n\\Psi[d] = \\int_{-\\infty}^{\\infty} G_c \\left( \\frac{\\exp(-2|x|/\\ell)}{2\\ell} + \\frac{\\exp(-2|x|/\\ell)}{2\\ell} \\right)\\,\\mathrm{d}x\n$$\n被积函数中的两项是相同的。对于这类变分问题，这是能量均分原理的一种体现。\n$$\n\\Psi[d] = \\int_{-\\infty}^{\\infty} G_c \\frac{\\exp(-2|x|/\\ell)}{\\ell} \\,\\mathrm{d}x = \\frac{G_c}{\\ell} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{2|x|}{\\ell}\\right) \\,\\mathrm{d}x\n$$\n被积函数是一个偶函数，所以我们可以将积分写成从 $0$到 $\\infty$ 积分的两倍：\n$$\n\\Psi[d] = \\frac{G_c}{\\ell} \\left( 2 \\int_{0}^{\\infty} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x \\right)\n$$\n我们现在计算该定积分：\n$$\n\\int_{0}^{\\infty} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x = \\left[ -\\frac{\\ell}{2} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\right]_{0}^{\\infty}\n$$\n$$\n= \\left( \\lim_{x\\to\\infty} -\\frac{\\ell}{2} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\right) - \\left( -\\frac{\\ell}{2} \\exp(0) \\right)\n$$\n$$\n= (0) - \\left(-\\frac{\\ell}{2}\\right) = \\frac{\\ell}{2}\n$$\n将此结果代回 $\\Psi[d]$ 的表达式中：\n$$\n\\Psi[d] = \\frac{G_c}{\\ell} \\left( 2 \\cdot \\frac{\\ell}{2} \\right) = \\frac{G_c}{\\ell} (\\ell) = G_c\n$$\n这解析地验证了正则化裂纹分布的单位面积总断裂表面能确实等于临界能量释放率 $G_c$，与理论要求一致。\n\n最终答案的两个部分是分布 $d(x)$ 和能量值 $\\Psi[d]$。\n1.  分布： $d(x) = \\exp(-|x|/\\ell)$\n2.  能量： $\\Psi = G_c$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\exp\\left(-\\frac{|x|}{\\ell}\\right)  G_c \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从纯理论走向实际应用，本练习旨在连接模型参数与物理测量。您将学习如何根据一个实验可观测量——断裂过程区宽度——来校准内部长度尺度参数 $\\ell$，这是实现预测性模拟的关键一步。此外，您还将研究至关重要的网格敏感性问题，探索数值预测的准确性如何与相场的网格分辨率根本地联系在一起。",
            "id": "3476013",
            "problem": "要求您构建一个完整、可运行的程序，该程序在相场断裂模型中，根据测量的过程区尺寸来标定内禀长度尺度参数，然后使用一个有科学依据的代理模型，检验三点弯曲试验中峰值载荷的网格依赖性。背景为计算材料科学，主题是针对脆性材料的相场断裂模拟，采用 Ambrosio–Tortorelli 正则化方法，具体为通常被称为 AT-2 的二次模型。\n\n出发点和基本依据：\n- 在脆性断裂的相场描述中，裂纹由一个标量损伤场 $d(x)$ 表示，该损伤场将尖锐裂纹正则化为一个有限宽度，此宽度由一个内禀长度尺度参数 $\\ell$ 控制。在 Ambrosio–Tortorelli 二次模型 (AT-2) 中，裂纹表面密度泛函定义为\n$$\n\\gamma(d,\\nabla d) \\equiv \\frac{d^2}{2\\ell} + \\frac{\\ell}{2} \\lVert \\nabla d \\rVert^2,\n$$\n因此，断裂表面能为 $G_c \\int \\gamma(d,\\nabla d) \\,\\mathrm{d}x$，其中 $G_c$ 是临界能量释放率（断裂韧性）。\n- 对于一维孤立裂纹，其损伤场的稳态剖面是通过最小化关于 $d(x)$ 的 $\\gamma$ 积分得到的，这会导出欧拉-拉格朗日常微分方程。$d(x)$ 由此产生的特征衰减规律决定了过程区的宽度，在该宽度范围内损伤场超过了用于定义可测量裂纹过程区宽度 $w_{\\mathrm{crack}}$ 的选定阈值 $d_{\\mathrm{th}}$。\n- 在单轴应力下，弹性应变能密度为 $\\psi_0 = \\sigma^2 / (2E)$，其中 $\\sigma$ 是应力，$E$ 是杨氏模量。对于正则化模型中的裂纹萌生，一个基本的能量平衡论证将过程区中释放的弹性能与形成弥散裂纹所消耗的断裂能 $G_c$ 等同起来。\n\n您的任务：\n1. 利用通过最小化 AT-2 断裂表面密度得到的一维稳态损伤剖面，根据直接测量的过程区宽度 $w_{\\mathrm{crack}}$ 和选定的阈值 $d_{\\mathrm{th}}$ 来标定内禀长度 $\\ell$。利用此剖面所蕴含的 $w_{\\mathrm{crack}}$ 与 $\\ell$ 之间的精确关系，为每个测试用例确定 $\\ell$。\n2. 使用第一性原理的能量平衡，推导出损伤起始时的临界应力 $\\sigma_c$ 与 $E$、$G_c$ 和 $w_{\\mathrm{crack}}$ 之间的标度关系。然后，应用简支矩形梁三点弯曲的经典梁理论，计算当最大纤维应力等于 $\\sigma_c$ 时的峰值载荷 $P_{\\mathrm{ref}}$。对于宽度为 $b$、厚度为 $t$ 的梁，在跨度 $L$ 中点承受载荷 $P$ 时，其边缘纤维的最大弯曲应力为 $\\sigma_{\\max} = (3 P L)/(2 b t^2)$，当 $\\sigma_{\\max} = \\sigma_c$ 时，损伤开始萌生。\n3. 采用一个受相场正则化分辨率要求启发的代理数值误差模型，来检验峰值载荷的网格依赖性。令 $n$ 表示贯穿过程区的单元数量，$n = w_{\\mathrm{crack}}/h$，其中 $h$ 是网格尺寸。对于线性有限元，假设峰值载荷存在一阶误差标度关系，模型为\n$$\nP_{\\mathrm{peak}}(h) = P_{\\mathrm{ref}} \\left( 1 + \\beta \\frac{h}{w_{\\mathrm{crack}}} \\right),\n$$\n其中网格偏置系数 $\\beta$ 捕捉了因梯度未被充分解析而高估峰值载荷的趋势。所有测试用例均使用 $\\beta = 0.25$。\n\n单位和输出：\n- 所有输入和计算都必须使用国际单位制 (SI)。具体来说，长度单位必须是米 ($\\mathrm{m}$)，杨氏模量单位是帕斯卡 ($\\mathrm{Pa}$)，断裂韧性单位是焦耳每平方米 ($\\mathrm{J}/\\mathrm{m}^2$ 或等效的 $\\mathrm{N}/\\mathrm{m}$)，载荷单位是牛顿 ($\\mathrm{N}$)。\n- 程序必须生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的汇总结果。对于每个测试用例，结果必须是列表 $[\\ell, P_{\\mathrm{peak}}(h_1), P_{\\mathrm{peak}}(h_2), P_{\\mathrm{peak}}(h_3)]$，使用下面指定的网格尺寸，因此最终输出是这些列表的列表，例如 $[[\\dots],[\\dots],[\\dots]]$，不含任何空格。\n\n测试套件：\n使用以下三个测试用例。对于每个用例，在计算出该用例的 $\\ell$ 后，必须将其网格尺寸定义为相对于标定 $\\ell$ 的值，即 $h_1 = \\ell/10$、$h_2 = \\ell/2$、$h_3 = 2\\ell$。\n\n- 测试用例 1（高刚度、高 E 材料）：\n  - 测量的过程区宽度：$w_{\\mathrm{crack}} = 0.002\\ \\mathrm{m}$。\n  - 损伤宽度定义的阈值：$d_{\\mathrm{th}} = 0.5$。\n  - 杨氏模量：$E = 210 \\times 10^9\\ \\mathrm{Pa}$。\n  - 断裂韧性：$G_c = 1000\\ \\mathrm{N}/\\mathrm{m}$。\n  - 梁宽度：$b = 0.01\\ \\mathrm{m}$。\n  - 梁厚度：$t = 0.005\\ \\mathrm{m}$。\n  - 跨度：$L = 0.1\\ \\mathrm{m}$。\n\n- 测试用例 2（中等刚度材料）：\n  - 测量的过程区宽度：$w_{\\mathrm{crack}} = 0.003\\ \\mathrm{m}$。\n  - 损伤宽度定义的阈值：$d_{\\mathrm{th}} = 0.5$。\n  - 杨氏模量：$E = 70 \\times 10^9\\ \\mathrm{Pa}$。\n  - 断裂韧性：$G_c = 300\\ \\mathrm{N}/\\mathrm{m}$。\n  - 梁宽度：$b = 0.02\\ \\mathrm{m}$。\n  - 梁厚度：$t = 0.004\\ \\mathrm{m}$。\n  - 跨度：$L = 0.12\\ \\mathrm{m}$。\n\n- 测试用例 3（低刚度、大过程区材料）：\n  - 测量的过程区宽度：$w_{\\mathrm{crack}} = 0.010\\ \\mathrm{m}$。\n  - 损伤宽度定义的阈值：$d_{\\mathrm{th}} = 0.5$。\n  - 杨氏模量：$E = 3 \\times 10^9\\ \\mathrm{Pa}$。\n  - 断裂韧性：$G_c = 1000\\ \\mathrm{N}/\\mathrm{m}$。\n  - 梁宽度：$b = 0.015\\ \\mathrm{m}$。\n  - 梁厚度：$t = 0.003\\ \\mathrm{m}$。\n  - 跨度：$L = 0.08\\ \\mathrm{m}$。\n\n要求的最终输出格式：\n- 您的程序应按测试用例的顺序生成单行输出，其中包含一个无空格的、由列表组成的逗号分隔列表，即\n$$\n\\left[ [\\ell_1,P_{\\mathrm{peak},1}(h_1),P_{\\mathrm{peak},1}(h_2),P_{\\mathrm{peak},1}(h_3)], [\\ell_2,P_{\\mathrm{peak},2}(h_1),P_{\\mathrm{peak},2}(h_2),P_{\\mathrm{peak},2}(h_3)], [\\ell_3,P_{\\mathrm{peak},3}(h_1),P_{\\mathrm{peak},3}(h_2),P_{\\mathrm{peak},3}(h_3)] \\right]\n$$\n数值采用国际单位制。元素必须是浮点数，且打印的单行必须与方括号、逗号分隔的精确格式完全匹配，不得包含任何额外文本。",
            "solution": "该问题要求标定一个相场断裂模型的参数，并随后分析峰值载荷预测的网格依赖性。解答遵循问题陈述，分三个连续部分推导。\n\n### 第 1 部分：内禀长度尺度 $\\ell$ 的标定\n\n该模型的基础是 Ambrosio–Tortorelli (AT-2) 裂纹表面密度泛函，由下式给出：\n$$\n\\gamma(d, \\nabla d) = \\frac{d^2}{2\\ell} + \\frac{\\ell}{2} \\lVert \\nabla d \\rVert^2\n$$\n这里，$d$ 是标量损伤场（$d=0$ 表示材料完好，$d=1$ 表示完全断裂），$\\ell$ 是内禀长度尺度参数，它将尖锐裂纹正则化为一个有限的宽度。总断裂能为 $W_f = \\int_V G_c \\gamma(d, \\nabla d) \\, \\mathrm{d}V$，其中 $G_c$ 是材料的断裂韧性。\n\n为了标定 $\\ell$，我们考虑一维环境下的孤立直裂纹。损伤场 $d(x)$ 仅在垂直于裂纹平面的 $x$ 方向上变化。$d(x)$ 的稳态剖面是通过最小化断裂能泛函得到的，这会导出欧拉-拉格朗日方程。拉格朗日密度为 $L(d, d') = G_c \\left( \\frac{d^2}{2\\ell} + \\frac{\\ell}{2}(d')^2 \\right)$，其中 $d' = \\mathrm{d}d/\\mathrm{d}x$。欧拉-拉格朗日方程为：\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\partial L}{\\partial d'} \\right) = 0\n$$\n$$\nG_c \\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( G_c \\ell d' \\right) = 0\n$$\n这可以简化为常微分方程：\n$$\nd(x) - \\ell^2 d''(x) = 0\n$$\n对于以 $x=0$ 为中心的孤立裂纹，物理上相关的边界条件是 $d(0)=1$（完全开裂）和当 $|x| \\to \\infty$ 时 $d(x) \\to 0$（远离裂纹的未损伤材料）。该边值问题的解为：\n$$\nd(x) = \\exp\\left(-\\frac{|x|}{\\ell}\\right)\n$$\n问题将过程区宽度 $w_{\\mathrm{crack}}$ 定义为损伤场超过指定阈值的区域，即 $d(x) \\ge d_{\\mathrm{th}}$。由于对称性，$w_{\\mathrm{crack}} = 2x_{\\mathrm{th}}$，其中 $x_{\\mathrm{th}}$ 是满足 $d(x_{\\mathrm{th}}) = d_{\\mathrm{th}}$ 的正坐标。\n$$\nd_{\\mathrm{th}} = \\exp\\left(-\\frac{x_{\\mathrm{th}}}{\\ell}\\right)\n$$\n求解 $x_{\\mathrm{th}}$ 可得：\n$$\nx_{\\mathrm{th}} = -\\ell \\ln(d_{\\mathrm{th}})\n$$\n由于 $d_{\\mathrm{th}}  1$，其对数为负，确保了 $x_{\\mathrm{th}}$ 为正值。因此，总的过程区宽度为：\n$$\nw_{\\mathrm{crack}} = 2x_{\\mathrm{th}} = -2\\ell \\ln(d_{\\mathrm{th}})\n$$\n该方程提供了模型参数 $\\ell$ 与可测量 $w_{\\mathrm{crack}}$ 之间的直接关系。通过反转此关系，我们可以标定 $\\ell$：\n$$\n\\ell = \\frac{w_{\\mathrm{crack}}}{-2 \\ln(d_{\\mathrm{th}})}\n$$\n此公式用于计算每个测试用例的 $\\ell$。\n\n### 第 2 部分：参考峰值载荷 $P_{\\mathrm{ref}}$ 的推导\n\n裂纹萌生的临界应力 $\\sigma_c$ 是通过一个简化的能量平衡论证来确定的。该原理指出，在断裂开始时，从“过程区”释放的弹性应变能必须足以提供形成裂纹所需的能量，即断裂韧性 $G_c$。\n\n在单轴应力 $\\sigma$ 下储存在材料中的弹性应变能密度为 $\\psi_0 = \\frac{\\sigma^2}{2E}$。释放此能量的材料体积由过程区宽度 $w_{\\mathrm{crack}}$ 来表征。单位裂纹面积上，释放的弹性能近似为长度为 $w_{\\mathrm{crack}}$ 的柱体中储存的能量：\n$$\nU_{\\mathrm{el}} = \\psi_0 \\cdot w_{\\mathrm{crack}} = \\frac{\\sigma_c^2}{2E} w_{\\mathrm{crack}}\n$$\n将其与单位面积消耗的断裂能 $G_c$ 等同，得到裂纹萌生的条件：\n$$\n\\frac{\\sigma_c^2}{2E} w_{\\mathrm{crack}} = G_c\n$$\n求解临界应力 $\\sigma_c$：\n$$\n\\sigma_c = \\sqrt{\\frac{2EG_c}{w_{\\mathrm{crack}}}}\n$$\n该临界应力对应于三点弯曲试验中失效起始瞬间的最大纤维应力。对于宽度为 $b$、厚度为 $t$ 的矩形梁，在跨度为 $L$ 的中点承受载荷 $P$ 时，其最大应力由下式给出：\n$$\n\\sigma_{\\max} = \\frac{3PL}{2bt^2}\n$$\n令 $\\sigma_{\\max} = \\sigma_c$ 且对应的载荷为参考峰值载荷 $P_{\\mathrm{ref}}$：\n$$\n\\sigma_c = \\frac{3P_{\\mathrm{ref}}L}{2bt^2}\n$$\n求解 $P_{\\mathrm{ref}}$ 可得：\n$$\nP_{\\mathrm{ref}} = \\frac{2bt^2}{3L} \\sigma_c = \\frac{2bt^2}{3L} \\sqrt{\\frac{2EG_c}{w_{\\mathrm{crack}}}}\n$$\n\n### 第 3 部分：与网格相关的峰值载荷 $P_{\\mathrm{peak}}(h)$\n\n相场断裂的数值模拟对网格尺寸 $h$ 很敏感，尤其是当网格过粗，无法解析 $w_{\\mathrm{crack}}$ 宽度内的损伤剖面时。问题提供了一个代理模型来表示这种网格依赖性，假设线性单元存在一阶误差标度关系：\n$$\nP_{\\mathrm{peak}}(h) = P_{\\mathrm{ref}} \\left( 1 + \\beta \\frac{h}{w_{\\mathrm{crack}}} \\right)\n$$\n这里，$P_{\\mathrm{ref}}$ 是上面推导出的理想峰值载荷，$h$ 是网格单元尺寸，$\\beta$ 是网格偏置系数，给定值为 $\\beta = 0.25$。该模型捕捉了常见的数值伪影，即未充分解析的模拟（大的 $h/w_{\\mathrm{crack}}$）会人为地使响应变刚并高估峰值载荷。\n\n分析是针对三种相对于标定长度尺度 $\\ell$ 定义的网格尺寸进行的：细网格 ($h_1 = \\ell/10$)、中等解析度网格 ($h_2 = \\ell/2$) 和粗糙的未解析网格 ($h_3 = 2\\ell$)。对于每个测试用例，我们首先计算 $\\ell$，然后计算 $P_{\\mathrm{ref}}$，最后计算这三种网格尺寸下的 $P_{\\mathrm{peak}}(h)$ 值。每个用例的最终结果是列表 $[\\ell, P_{\\mathrm{peak}}(h_1), P_{\\mathrm{peak}}(h_2), P_{\\mathrm{peak}}(h_3)]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the phase-field fracture modeling problem for all test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case 1 (stiff, high E)\",\n            \"w_crack\": 0.002,   # m\n            \"d_th\": 0.5,\n            \"E\": 210e9,         # Pa\n            \"Gc\": 1000,         # N/m\n            \"b\": 0.01,          # m\n            \"t\": 0.005,         # m\n            \"L\": 0.1,           # m\n        },\n        {\n            \"name\": \"Case 2 (moderate stiffness)\",\n            \"w_crack\": 0.003,   # m\n            \"d_th\": 0.5,\n            \"E\": 70e9,          # Pa\n            \"Gc\": 300,          # N/m\n            \"b\": 0.02,          # m\n            \"t\": 0.004,         # m\n            \"L\": 0.12,          # m\n        },\n        {\n            \"name\": \"Case 3 (low stiffness, large process zone)\",\n            \"w_crack\": 0.010,   # m\n            \"d_th\": 0.5,\n            \"E\": 3e9,           # Pa\n            \"Gc\": 1000,         # N/m\n            \"b\": 0.015,         # m\n            \"t\": 0.003,         # m\n            \"L\": 0.08,          # m\n        },\n    ]\n\n    # Fixed parameter for all cases\n    beta = 0.25\n\n    all_results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        w_crack = case[\"w_crack\"]\n        d_th = case[\"d_th\"]\n        E = case[\"E\"]\n        Gc = case[\"Gc\"]\n        b = case[\"b\"]\n        t = case[\"t\"]\n        L = case[\"L\"]\n\n        # 1. Calibrate the internal length scale parameter l\n        ell = w_crack / (-2 * np.log(d_th))\n\n        # 2. Calculate the reference peak load P_ref\n        # First, find the critical stress sigma_c from the energy balance\n        sigma_c = np.sqrt((2 * E * Gc) / w_crack)\n        \n        # Then, calculate P_ref from the beam bending formula\n        P_ref = (2 * b * t**2 * sigma_c) / (3 * L)\n\n        # 3. Examine mesh dependence of the peak load\n        # Define the mesh sizes relative to the calibrated ell\n        h1 = ell / 10\n        h2 = ell / 2\n        h3 = 2 * ell\n        mesh_sizes = [h1, h2, h3]\n        \n        peak_loads = []\n        for h in mesh_sizes:\n            # Apply the surrogate numerical error model\n            P_peak = P_ref * (1 + beta * (h / w_crack))\n            peak_loads.append(P_peak)\n            \n        # Assemble the results for the current case\n        case_results = [ell] + peak_loads\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format: [[...],[...],[...]]\n    # Using str().replace() is a robust way to meet the \"no spaces\" requirement.\n    print(str(all_results).replace(' ', ''))\n\nsolve()\n\n```"
        },
        {
            "introduction": "一个稳健的相场模型必须能正确捕捉材料在各种载荷条件下的行为，而不仅仅是在拉伸状态下。本练习旨在解决在简单模型中常见的、在压缩下出现的材料互穿这一非物理现象。通过对比使用和未使用张压能量分离的简单模型，您将理解为何这种分离对于防止非物理行为、确保闭合裂纹能够正常传递压应力至关重要。",
            "id": "3476034",
            "problem": "考虑一个承受单轴压缩的一维线弹性杆，其被分成两个串联部分，用以在相场断裂模型中表示一个开裂界面。左侧部分使用相场变量 $d \\in [0,1]$ 模拟损伤区，右侧部分模拟完好材料。设杆的两个部分具有相同的均匀横截面积 $A$ 和杨氏模量 $E$。左、右两部分的长度分别为 $L_L$ 和 $L_R$。对杆施加一个总的末端缩短位移 $\\Delta  0$（压缩），并且在串联系统中轴向力是均匀的。\n\n本构基础是用于单轴应变 $\\varepsilon$ 的小应变线弹性应变能密度 $W(\\varepsilon)$，以及相场断裂中使用的拉压分解：\n$$\nW(\\varepsilon) = \\tfrac{1}{2}E\\,\\varepsilon^2,\\quad\nW^+(\\varepsilon) = \\tfrac{1}{2}E\\,\\max(\\varepsilon,0)^2,\\quad\nW^-(\\varepsilon) = \\tfrac{1}{2}E\\,\\min(\\varepsilon,0)^2.\n$$\n一个考虑接触的公式通过退化函数 $g(d)$ 仅退化拉伸部分 $W^+(\\varepsilon)$，而保持压缩部分 $W^-(\\varepsilon)$ 不退化，以避免在压缩下发生互穿。退化函数包含一个残余刚度参数 $\\kappa  0$：\n$$\ng(d) = (1-d)^2 + \\kappa.\n$$\n在压缩载荷（$\\varepsilon  0$）下，考虑接触的公式使用未退化的压缩刚度，而一个退化总能量的朴素公式在拉伸和压缩中都使用退化后的刚度。\n\n您的任务是：\n- 基于上述本构基础，推导在压缩载荷下，两种公式中各部分的有效轴向刚度：\n    1. 朴素的总能量退化：左侧部分的刚度即使在压缩时也使用 $g(d)$。\n    2. 考虑接触的分解：左侧部分在压缩时的刚度不发生退化；通过 $W^-(\\varepsilon)$ 将压缩部分排除在退化之外。\n- 利用两个串联线弹性弹簧的平衡和协调条件，推导每种公式下施加的位移 $\\Delta$ 如何分配到左侧部分的压缩位移 $\\delta_L$ 和右侧部分的压缩位移 $\\delta_R$。\n- 将互穿放大因子定义为比率\n$$\n\\mathcal{A} := \\frac{\\lvert \\delta_L^{\\text{naive}} \\rvert}{\\lvert \\delta_L^{\\text{contact}} \\rvert},\n$$\n并评估对于所提供的测试套件，与考虑接触的公式相比，朴素公式是否会导致过度的互穿。\n- 使用无量纲阈值比 $\\tau$ 定义一个用于避免压缩下互穿的决策规则，该规则比较朴素公式的左侧部分压缩量与完好（考虑接触）的左侧部分压缩量。当 $\\mathcal{A}  \\tau$ 时，将朴素公式标记为易于互穿；当 $\\lvert \\delta_L^{\\text{contact}} \\rvert \\le \\tau \\,\\lvert \\delta_L^{\\text{intact}} \\rvert$ 时，将考虑接触的公式标记为避免互穿，其中 $\\delta_L^{\\text{intact}}$ 是在压缩中使用未退化刚度时的左侧部分压缩量。\n\n所有物理量均应使用以下单位表示：$E$ 的单位是帕斯卡（Pa），$A$ 的单位是平方米（$\\mathrm{m}^2$），长度的单位是米（$\\mathrm{m}$），施加的位移 $\\Delta$ 的单位是米（$\\mathrm{m}$）。角度单位不适用。将互穿放大因子 $\\mathcal{A}$ 报告为无量纲浮点数。将互穿避免决策报告为布尔值。\n\n测试套件：\n- 情况 1：$E = 70\\times 10^{9}\\ \\mathrm{Pa}$，$A = 1\\times 10^{-4}\\ \\mathrm{m}^2$，$L_L = 5\\times 10^{-3}\\ \\mathrm{m}$，$L_R = 9.5\\times 10^{-2}\\ \\mathrm{m}$，$d = 0.999$，$\\kappa = 1\\times 10^{-6}$，$\\Delta = -1\\times 10^{-4}\\ \\mathrm{m}$。\n- 情况 2：$E = 70\\times 10^{9}\\ \\mathrm{Pa}$，$A = 1\\times 10^{-4}\\ \\mathrm{m}^2$，$L_L = 5\\times 10^{-3}\\ \\mathrm{m}$，$L_R = 9.5\\times 10^{-2}\\ \\mathrm{m}$，$d = 0.0$，$\\kappa = 1\\times 10^{-6}$，$\\Delta = -1\\times 10^{-4}\\ \\mathrm{m}$。\n- 情况 3：$E = 210\\times 10^{9}\\ \\mathrm{Pa}$，$A = 5\\times 10^{-5}\\ \\mathrm{m}^2$，$L_L = 1\\times 10^{-2}\\ \\mathrm{m}$，$L_R = 9\\times 10^{-2}\\ \\mathrm{m}$，$d = 0.9999$，$\\kappa = 1\\times 10^{-8}$，$\\Delta = -5\\times 10^{-5}\\ \\mathrm{m}$。\n- 情况 4：$E = 30\\times 10^{9}\\ \\mathrm{Pa}$，$A = 2\\times 10^{-4}\\ \\mathrm{m}^2$，$L_L = 2\\times 10^{-2}\\ \\mathrm{m}$，$L_R = 8\\times 10^{-2}\\ \\mathrm{m}$，$d = 0.995$，$\\kappa = 1\\times 10^{-5}$，$\\Delta = -1\\times 10^{-6}\\ \\mathrm{m}$。\n\n使用阈值 $\\tau = 4.0$（无量纲）。对于每种情况，计算：\n- 互穿放大因子 $\\mathcal{A}$（浮点数）。\n- 朴素公式是否易于互穿的决策（布尔值）。\n- 考虑接触的公式是否避免互穿的决策（布尔值）。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$$\n[\\mathcal{A}_1, b^{\\text{naive}}_1, b^{\\text{contact}}_1, \\ \\mathcal{A}_2, b^{\\text{naive}}_2, b^{\\text{contact}}_2, \\ \\mathcal{A}_3, b^{\\text{naive}}_3, b^{\\text{contact}}_3, \\ \\mathcal{A}_4, b^{\\text{naive}}_4, b^{\\text{contact}}_4].\n$$\n每个 $\\mathcal{A}_i$ 必须是浮点数，每个 $b^{\\text{naive}}_i$、$b^{\\text{contact}}_i$ 必须是布尔值。",
            "solution": "该问题要求通过分析一个简化的一维杆模型中的位移分配，来验证两种不同的相场断裂公式在单轴压缩下的表现。该杆由两个串联的部分组成：一个长度为 $L_L$ 的左侧部分，代表由相场变量 $d$ 描述的潜在裂纹区；以及一个长度为 $L_R$ 的完好右侧部分。两个部分具有相同的杨氏模量 $E$ 和横截面积 $A$。施加了一个总的压缩位移 $\\Delta  0$。\n\n我们的分析将首先为每个部分在指定的加载条件下建立本构关系和相应的轴向刚度。然后，我们将使用串联系统的静力平衡和运动协调原理来确定总位移 $\\Delta$ 是如何分配的。最后，我们将推导并评估所要求的指标：互穿放大因子 $\\mathcal{A}$ 和关于是否易于互穿的布尔决策。\n\n### 1. 本构关系与轴向刚度\n\n一个长度为 $L$、面积为 $A$、有效杨氏模量为 $E'$ 的线弹性杆的轴向刚度 $k$ 由 $k = E'A/L$ 给出。有效模量 $E'$ 由应变能密度 $W$ 对应变 $\\varepsilon$ 的二阶导数确定，即 $E' = \\partial^2 W / \\partial \\varepsilon^2$。\n\n该问题设定在单轴压缩下，这意味着轴向应变 $\\varepsilon$ 为负（$\\varepsilon  0$）。这是评估能量表达式的一个关键观察点。\n\n**完好材料（右侧部分）：**\n对于完好的右侧部分，应变能密度为 $W(\\varepsilon) = \\frac{1}{2}E\\varepsilon^2$。有效模量为 $E' = E$。因此，右侧部分的刚度是恒定的：\n$$\nk_R = \\frac{EA}{L_R}\n$$\n\n**损伤材料（左侧部分）：**\n我们考虑左侧部分的两种公式。\n\n**a. 考虑接触的公式：**\n应变能密度为 $W_{\\text{contact}}(\\varepsilon) = g(d)W^+(\\varepsilon) + W^-(\\varepsilon)$，其中 $W^+(\\varepsilon) = \\frac{1}{2}E\\max(\\varepsilon,0)^2$ 且 $W^-(\\varepsilon) = \\frac{1}{2}E\\min(\\varepsilon,0)^2$。退化函数为 $g(d) = (1-d)^2 + \\kappa$。\n在压缩下，$\\varepsilon  0$，这意味着 $\\max(\\varepsilon,0)=0$ 且 $\\min(\\varepsilon,0)=\\varepsilon$。\n能量贡献为 $W^+(\\varepsilon) = 0$ 和 $W^-(\\varepsilon) = \\frac{1}{2}E\\varepsilon^2$。\n因此，对于压缩载荷，应变能密度变为：\n$$\nW_{\\text{contact}}(\\varepsilon  0) = g(d) \\cdot 0 + \\frac{1}{2}E\\varepsilon^2 = \\frac{1}{2}E\\varepsilon^2\n$$\n这与未退化的应变能相同。有效模量为 $E'_{\\text{contact}} = \\partial^2 W_{\\text{contact}} / \\partial \\varepsilon^2 = E$。\n在压缩下，考虑接触的公式中左侧部分的刚度为：\n$$\nk_L^{\\text{contact}} = \\frac{EA}{L_L}\n$$\n这个刚度与完好材料的刚度相同，正确地表示了闭合的裂纹应能在不损失刚度的情况下传递压应力。这也是我们在压缩情况下与“完好”一词相关联的刚度，因此 $k_L^{\\text{contact}} = k_L^{\\text{intact}}$。\n\n**b. 朴素公式：**\n该公式退化总应变能：$W_{\\text{naive}}(\\varepsilon) = g(d)W(\\varepsilon) = g(d)\\frac{1}{2}E\\varepsilon^2$。\n无论应变符号如何，都应用退化。\n有效模量为 $E'_{\\text{naive}} = \\partial^2 W_{\\text{naive}} / \\partial \\varepsilon^2 = g(d)E$。\n朴素公式中左侧部分的刚度为：\n$$\nk_L^{\\text{naive}} = \\frac{g(d)EA}{L_L} = \\frac{((1-d)^2 + \\kappa)EA}{L_L}\n$$\n对于高度损伤状态，其中 $d \\to 1$，$g(d) \\to \\kappa$。由于 $\\kappa$ 是一个小参数，朴素刚度即使在压缩时也变得极低，这在物理上是不正确的，因为它意味着材料互穿。\n\n### 2. 串联系统中的位移分配\n\n对于两个刚度分别为 $k_L$ 和 $k_R$ 的串联弹簧，总刚度为 $k_{\\text{tot}} = (1/k_L + 1/k_R)^{-1}$。力 $F$ 在整个系统中是均匀的，$F = k_{\\text{tot}}\\Delta$，各部分的位移为 $\\delta_L = F/k_L$ 和 $\\delta_R = F/k_R$。\n\n左侧部分的位移 $\\delta_L$ 可以表示为总位移 $\\Delta$ 的一个分数。根据协调条件 $\\Delta = \\delta_L + \\delta_R = \\delta_L + F/k_R = \\delta_L + (k_L\\delta_L)/k_R = \\delta_L(1 + k_L/k_R)$，我们推导出：\n$$\n\\delta_L = \\Delta \\left( \\frac{1}{1 + k_L/k_R} \\right) = \\Delta \\left( \\frac{k_R}{k_R + k_L} \\right)\n$$\n我们现在将这个通用结果应用于我们的两种公式。\n\n**a. 考虑接触的位移分配：**\n使用 $k_L = k_L^{\\text{contact}} = EA/L_L$ 和 $k_R = EA/L_R$：\n$$\n\\delta_L^{\\text{contact}} = \\Delta \\left( \\frac{EA/L_R}{EA/L_R + EA/L_L} \\right) = \\Delta \\left( \\frac{1/L_R}{1/L_R + 1/L_L} \\right) = \\Delta \\frac{L_L}{L_L + L_R}\n$$\n\n**b. 朴素的位移分配：**\n使用 $k_L = k_L^{\\text{naive}} = g(d)EA/L_L$ 和 $k_R = EA/L_R$：\n$$\n\\delta_L^{\\text{naive}} = \\Delta \\left( \\frac{EA/L_R}{EA/L_R + g(d)EA/L_L} \\right) = \\Delta \\left( \\frac{1/L_R}{1/L_R + g(d)/L_L} \\right) = \\Delta \\frac{L_L}{L_L + g(d)L_R}\n$$\n\n### 3. 互穿放大因子与决策规则\n\n互穿放大因子 $\\mathcal{A}$ 衡量了朴素模型预测的损伤区中的过度压缩量，相较于物理上正确的考虑接触的模型。\n$$\n\\mathcal{A} := \\frac{\\lvert \\delta_L^{\\text{naive}} \\rvert}{\\lvert \\delta_L^{\\text{contact}} \\rvert} = \\frac{-\\delta_L^{\\text{naive}}}{-\\delta_L^{\\text{contact}}} = \\frac{\\Delta \\frac{L_L}{L_L + g(d)L_R}}{\\Delta \\frac{L_L}{L_L + L_R}}\n$$\n项 $\\Delta$ 和 $L_L$ 消去，得到一个简化的表达式，值得注意的是，它不依赖于 $E$、$A$ 或 $\\Delta$：\n$$\n\\mathcal{A} = \\frac{L_L + L_R}{L_L + g(d)L_R} \\quad \\text{其中} \\quad g(d) = (1-d)^2 + \\kappa\n$$\n这就是我们将为每个测试用例评估的表达式。\n\n决策规则如下，阈值为 $\\tau = 4.0$：\n1.  **朴素公式是否易于互穿的决策 ($b^{\\text{naive}}$)：** 如果 $\\mathcal{A}  \\tau$，则为真。\n2.  **考虑接触的公式是否避免互穿的决策 ($b^{\\text{contact}}$)：** 如果 $\\lvert \\delta_L^{\\text{contact}} \\rvert \\le \\tau \\,\\lvert \\delta_L^{\\text{intact}} \\rvert$，则为真。如前所述，在压缩下，考虑接触的公式与完好材料的公式相同，因此 $\\delta_L^{\\text{contact}} = \\delta_L^{\\text{intact}}$。该条件简化为 $\\lvert \\delta_L^{\\text{intact}} \\rvert \\le \\tau \\,\\lvert \\delta_L^{\\text{intact}} \\rvert$。由于杆件承受非零压缩，$\\lvert \\delta_L^{\\text{intact}} \\rvert  0$，我们可以用它来除，得到 $1 \\le \\tau$。鉴于 $\\tau=4.0$，此条件始终满足。因此，对于所有测试用例，$b^{\\text{contact}}$ 都将为真。\n\n每个测试用例的计算涉及计算 $g(d)$，然后是 $\\mathcal{A}$，最后应用 $b^{\\text{naive}}$ 的决策规则。$b^{\\text{contact}}$ 的值总是为真。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the phase-field fracture interpenetration problem for the given test suite.\n    \"\"\"\n    \n    # Test suite parameters provided in the problem statement.\n    # Each case is a dictionary for clarity, using 'd' for the damage variable.\n    test_cases = [\n        # Case 1\n        {\"E\": 70e9, \"A\": 1e-4, \"L_L\": 5e-3, \"L_R\": 9.5e-2, \"d\": 0.999, \"kappa\": 1e-6, \"Delta\": -1e-4},\n        # Case 2\n        {\"E\": 70e9, \"A\": 1e-4, \"L_L\": 5e-3, \"L_R\": 9.5e-2, \"d\": 0.0, \"kappa\": 1e-6, \"Delta\": -1e-4},\n        # Case 3\n        {\"E\": 210e9, \"A\": 5e-5, \"L_L\": 1e-2, \"L_R\": 9e-2, \"d\": 0.9999, \"kappa\": 1e-8, \"Delta\": -5e-5},\n        # Case 4\n        {\"E\": 30e9, \"A\": 2e-4, \"L_L\": 2e-2, \"L_R\": 8e-2, \"d\": 0.995, \"kappa\": 1e-5, \"Delta\": -1e-6},\n    ]\n\n    # Interpenetration threshold\n    tau = 4.0\n\n    results = []\n\n    for case in test_cases:\n        # Extract relevant parameters for the calculation.\n        # Note that E, A, and Delta are not needed for the amplification factor A\n        # and the boolean decisions as they cancel out in the derivation.\n        L_L = case[\"L_L\"]\n        L_R = case[\"L_R\"]\n        d_val = case[\"d\"]\n        kappa = case[\"kappa\"]\n\n        # 1. Calculate the degradation function g(d)\n        g_d = (1.0 - d_val)**2 + kappa\n\n        # 2. Calculate the interpenetration amplification factor, A\n        # A = (L_L + L_R) / (L_L + g(d) * L_R)\n        amplification_factor = (L_L + L_R) / (L_L + g_d * L_R)\n\n        # 3. Apply the decision rules\n        # a. Naive formulation: interpenetration-prone if A > tau\n        b_naive = amplification_factor > tau\n\n        # b. Contact-aware formulation: avoids interpenetration if |delta_L_contact| = tau * |delta_L_intact|\n        # As derived in the solution, delta_L_contact = delta_L_intact for compression.\n        # The condition simplifies to 1 = tau, which is True since tau = 4.0.\n        b_contact = 1.0 = tau\n        \n        # Append the triplet of results for the current case\n        results.extend([amplification_factor, b_naive, b_contact])\n\n    # Format the final output string as a comma-separated list of values inside square brackets.\n    # str() of a boolean yields 'True' or 'False' with capital letters, which is standard.\n    results_str = [f\"{val:.12f}\" if isinstance(val, float) else str(val) for val in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}